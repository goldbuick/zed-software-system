const a10_0x4d80=['response','stopAgentsOnFailure','VERBOSE_LOGGING','next','project','../../../utilities/environment','__esModule','message','defineProperty','../../../utilities/metric-logger','Starting\x20a\x20distributed\x20execution','note','getBranch','map','parseCommand','Completing\x20run\x20group\x20with\x20an\x20error','data','completeRunGroupWithError','NX_CLOUD_DISTRIBUTED_EXECUTION_AGENT_COUNT','then','createMetricRecorder','enabled','dteStatus','dteStart','error','__awaiter','recordMetric','serializeOverrides','axiosException','status','error:\x20','axiosMultipleTries','post','../../../utilities/axios','mapRespToPerfEntry','completeRunGroup','configuration','parallel','maxParallel','NX_CLOUD_DISTRIBUTED_EXECUTION_STOP_AGENTS_ON_FAILURE','target','done','/nx-cloud/executions/status','apiAxiosInstance','/nx-cloud/executions/start','createApiAxiosInstance','start','createStartRequest','hash','DistributedExecutionApi'];(function(_0x168197,_0x4d80f3){const _0x13835e=function(_0x39d191){while(--_0x39d191){_0x168197['push'](_0x168197['shift']());}};_0x13835e(++_0x4d80f3);}(a10_0x4d80,0x69));const a10_0x1383=function(_0x168197,_0x4d80f3){_0x168197=_0x168197-0x0;let _0x13835e=a10_0x4d80[_0x168197];return _0x13835e;};'use strict';var __awaiter=this&&this[a10_0x1383('0x14')]||function(_0x2b5bdf,_0x4f0b75,_0x22073d,_0x47f8e6){function _0x1dd8c8(_0xad83eb){return _0xad83eb instanceof _0x22073d?_0xad83eb:new _0x22073d(function(_0x7df3ad){_0x7df3ad(_0xad83eb);});}return new(_0x22073d||(_0x22073d=Promise))(function(_0x1367d6,_0x377c9e){function _0x24e5f9(_0xe21f13){try{_0x5b242e(_0x47f8e6[a10_0x1383('0x30')](_0xe21f13));}catch(_0x258c0f){_0x377c9e(_0x258c0f);}}function _0x5b1cd0(_0x39f417){try{_0x5b242e(_0x47f8e6['throw'](_0x39f417));}catch(_0x3e262e){_0x377c9e(_0x3e262e);}}function _0x5b242e(_0x105691){_0x105691[a10_0x1383('0x24')]?_0x1367d6(_0x105691['value']):_0x1dd8c8(_0x105691['value'])[a10_0x1383('0xe')](_0x24e5f9,_0x5b1cd0);}_0x5b242e((_0x47f8e6=_0x47f8e6['apply'](_0x2b5bdf,_0x4f0b75||[]))[a10_0x1383('0x30')]());});};Object[a10_0x1383('0x3')](exports,a10_0x1383('0x1'),{'value':!![]});exports['createStartRequest']=exports[a10_0x1383('0x2c')]=void 0x0;const axios_1=require(a10_0x1383('0x1c'));const environment_1=require(a10_0x1383('0x0'));const metric_logger_1=require(a10_0x1383('0x4'));const serializer_overrides_1=require('../../../utilities/serializer-overrides');const {output}=require('../../../utilities/nx-imports');class DistributedExecutionApi{constructor(_0x52a36b){this[a10_0x1383('0x26')]=(0x0,axios_1[a10_0x1383('0x28')])(_0x52a36b);}[a10_0x1383('0x29')](_0x32abe8){var _0x5309e2;return __awaiter(this,void 0x0,void 0x0,function*(){const _0x31b460=(0x0,metric_logger_1[a10_0x1383('0xf')])(a10_0x1383('0x12'));let _0x28e818;if(environment_1[a10_0x1383('0x2f')]){output[a10_0x1383('0x6')]({'title':a10_0x1383('0x5'),'bodyLines':[JSON['stringify'](_0x32abe8,null,0x2)]});}try{_0x28e818=yield(0x0,axios_1[a10_0x1383('0x1a')])(()=>this[a10_0x1383('0x26')][a10_0x1383('0x1b')](a10_0x1383('0x27'),_0x32abe8));_0x31b460[a10_0x1383('0x15')]((0x0,metric_logger_1[a10_0x1383('0x1d')])(_0x28e818));}catch(_0x4d1789){_0x31b460['recordMetric'](((_0x5309e2=_0x4d1789===null||_0x4d1789===void 0x0?void 0x0:_0x4d1789[a10_0x1383('0x17')])===null||_0x5309e2===void 0x0?void 0x0:_0x5309e2['response'])?(0x0,metric_logger_1[a10_0x1383('0x1d')])(_0x4d1789['axiosException'][a10_0x1383('0x2d')]):metric_logger_1['RUNNER_FAILURE_PERF_ENTRY']);throw _0x4d1789;}if(!_0x28e818[a10_0x1383('0xb')][a10_0x1383('0x10')]){throw new Error('Workspace\x20is\x20disabled.\x20Cannot\x20perform\x20distributed\x20task\x20executions.');}if(_0x28e818[a10_0x1383('0xb')][a10_0x1383('0x13')]){throw new Error(_0x28e818[a10_0x1383('0xb')][a10_0x1383('0x13')]);}return _0x28e818[a10_0x1383('0xb')]['id'];});}[a10_0x1383('0x18')](_0x39b783){var _0x37b66a;return __awaiter(this,void 0x0,void 0x0,function*(){const _0x420872=(0x0,metric_logger_1['createMetricRecorder'])(a10_0x1383('0x11'));try{const _0x5d754c=yield(0x0,axios_1[a10_0x1383('0x1a')])(()=>this[a10_0x1383('0x26')][a10_0x1383('0x1b')](a10_0x1383('0x25'),{'id':_0x39b783}));_0x420872[a10_0x1383('0x15')]((0x0,metric_logger_1[a10_0x1383('0x1d')])(_0x5d754c));return _0x5d754c[a10_0x1383('0xb')];}catch(_0x4e6ddb){_0x420872[a10_0x1383('0x15')](((_0x37b66a=_0x4e6ddb===null||_0x4e6ddb===void 0x0?void 0x0:_0x4e6ddb[a10_0x1383('0x17')])===null||_0x37b66a===void 0x0?void 0x0:_0x37b66a['response'])?(0x0,metric_logger_1[a10_0x1383('0x1d')])(_0x4e6ddb[a10_0x1383('0x17')][a10_0x1383('0x2d')]):metric_logger_1['RUNNER_FAILURE_PERF_ENTRY']);output[a10_0x1383('0x13')]({'title':_0x4e6ddb[a10_0x1383('0x2')]});process['exit'](0x1);}});}[a10_0x1383('0xc')](_0x19c4fd,_0x3d040e){var _0x975a12;return __awaiter(this,void 0x0,void 0x0,function*(){const _0x1fd65a=(0x0,metric_logger_1['createMetricRecorder'])(a10_0x1383('0x1e'));if(environment_1[a10_0x1383('0x2f')]){output[a10_0x1383('0x6')]({'title':a10_0x1383('0xa'),'bodyLines':['runGroup:\x20'+_0x19c4fd,a10_0x1383('0x19')+_0x3d040e]});}try{const _0x37a664=yield(0x0,axios_1['axiosMultipleTries'])(()=>this['apiAxiosInstance'][a10_0x1383('0x1b')]('/nx-cloud/executions/complete-run-group',{'runGroup':_0x19c4fd,'criticalErrorMessage':_0x3d040e}),0x3);_0x1fd65a[a10_0x1383('0x15')]((0x0,metric_logger_1[a10_0x1383('0x1d')])(_0x37a664));}catch(_0x2ba8a6){_0x1fd65a['recordMetric'](((_0x975a12=_0x2ba8a6===null||_0x2ba8a6===void 0x0?void 0x0:_0x2ba8a6['axiosException'])===null||_0x975a12===void 0x0?void 0x0:_0x975a12[a10_0x1383('0x2d')])?(0x0,metric_logger_1[a10_0x1383('0x1d')])(_0x2ba8a6[a10_0x1383('0x17')][a10_0x1383('0x2d')]):metric_logger_1['RUNNER_FAILURE_PERF_ENTRY']);}});}}exports['DistributedExecutionApi']=DistributedExecutionApi;function createStartRequest(_0x232bd4,_0x567b77,_0x3fface){const _0x39e146=_0x567b77['map'](_0x17c578=>{return _0x17c578[a10_0x1383('0x8')](_0x7e0115=>{return{'taskId':_0x7e0115['id'],'hash':_0x7e0115[a10_0x1383('0x2b')],'projectName':_0x7e0115[a10_0x1383('0x23')][a10_0x1383('0x31')],'target':_0x7e0115[a10_0x1383('0x23')]['target'],'configuration':_0x7e0115[a10_0x1383('0x23')][a10_0x1383('0x1f')]||null,'params':(0x0,serializer_overrides_1[a10_0x1383('0x16')])(_0x7e0115)};});});const _0x526b9a={'command':(0x0,environment_1[a10_0x1383('0x9')])(),'branch':(0x0,environment_1[a10_0x1383('0x7')])(),'runGroup':_0x232bd4,'tasks':_0x39e146,'maxParallel':calculateMaxParallel(_0x3fface)};if(environment_1[a10_0x1383('0xd')]){_0x526b9a['agentCount']=environment_1['NX_CLOUD_DISTRIBUTED_EXECUTION_AGENT_COUNT'];}if(!environment_1[a10_0x1383('0x22')]){_0x526b9a[a10_0x1383('0x2e')]=![];}return _0x526b9a;}exports[a10_0x1383('0x2a')]=createStartRequest;function calculateMaxParallel(_0x503fc1){if(_0x503fc1[a10_0x1383('0x20')]==='false'||_0x503fc1[a10_0x1383('0x20')]===![]){return 0x1;}else if(_0x503fc1['parallel']==='true'||_0x503fc1[a10_0x1383('0x20')]===!![]){return Number(_0x503fc1[a10_0x1383('0x21')]||0x3);}else if(_0x503fc1[a10_0x1383('0x20')]===undefined){return _0x503fc1[a10_0x1383('0x21')]?Number(_0x503fc1[a10_0x1383('0x21')]):0x3;}else{return Number(_0x503fc1['parallel'])||0x3;}}