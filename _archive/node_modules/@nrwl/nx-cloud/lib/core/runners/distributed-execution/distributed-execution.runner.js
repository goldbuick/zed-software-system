const a11_0x43ac=['./process-tasks','DistributedExecutionApi','exit','ErrorReporterApi','then','lifeCycle','createStartRequest','Successfully\x20completed\x20running\x20the\x20command.','printRunGroupError','SIGINT','Starting\x20distributed\x20command\x20execution','runUrl','DteArtifactStorage','../../error/print-run-group-error','next','../../../utilities/dte-artifact-storage','SIGTERM','taskGraph','done','error','axiosException','./task-graph-creator','Command\x20execution\x20failed.','nxCloudDistributedTasksRunner','__esModule','skipNxCache','submitRunMetrics','Main\x20job\x20terminated\x20with\x20an\x20error:\x20\x22','__awaiter','./distributed-execution.api','tasks','splitTasksIntoStages','completeRunGroupWithError','getRunGroup','message','../../file-storage/e2e-encryption','VERBOSE_LOGGING','start','commandStatus','FileStorage','apply','../../../utilities/nx-imports','processTasks','note','getNxCacheDirectory','./split-task-graph-into-stages','encryptionKey','E2EEncryption','../../file-storage/file-storage','Main\x20job\x20was\x20terminated\x20via\x20SIGTERM','../../api/error-reporter.api','endTasks','--skip-nx-cache\x20is\x20ignored\x20when\x20using\x20distributed\x20tasks\x20execution\x20(DTE).','values','../../../utilities/environment','projectGraph','value'];(function(_0x885a8e,_0x43ace5){const _0x4fe161=function(_0x2b7317){while(--_0x2b7317){_0x885a8e['push'](_0x885a8e['shift']());}};_0x4fe161(++_0x43ace5);}(a11_0x43ac,0x87));const a11_0x4fe1=function(_0x885a8e,_0x43ace5){_0x885a8e=_0x885a8e-0x0;let _0x4fe161=a11_0x43ac[_0x885a8e];return _0x4fe161;};'use strict';var __awaiter=this&&this[a11_0x4fe1('0x7')]||function(_0x329d4f,_0x3086ec,_0x5d1acc,_0x406c52){function _0x369b6b(_0x110432){return _0x110432 instanceof _0x5d1acc?_0x110432:new _0x5d1acc(function(_0x30d574){_0x30d574(_0x110432);});}return new(_0x5d1acc||(_0x5d1acc=Promise))(function(_0x113e22,_0x55d4ae){function _0x385df6(_0x30fbc3){try{_0x362d95(_0x406c52['next'](_0x30fbc3));}catch(_0x2a3de2){_0x55d4ae(_0x2a3de2);}}function _0x49a654(_0x485b14){try{_0x362d95(_0x406c52['throw'](_0x485b14));}catch(_0x51254d){_0x55d4ae(_0x51254d);}}function _0x362d95(_0x32a0f4){_0x32a0f4[a11_0x4fe1('0x36')]?_0x113e22(_0x32a0f4['value']):_0x369b6b(_0x32a0f4[a11_0x4fe1('0x23')])[a11_0x4fe1('0x28')](_0x385df6,_0x49a654);}_0x362d95((_0x406c52=_0x406c52[a11_0x4fe1('0x13')](_0x329d4f,_0x3086ec||[]))[a11_0x4fe1('0x32')]());});};Object['defineProperty'](exports,a11_0x4fe1('0x3'),{'value':!![]});exports[a11_0x4fe1('0x2')]=void 0x0;const environment_1=require(a11_0x4fe1('0x21'));const metric_logger_1=require('../../../utilities/metric-logger');const error_reporter_api_1=require(a11_0x4fe1('0x1d'));const print_run_group_error_1=require(a11_0x4fe1('0x31'));const e2e_encryption_1=require(a11_0x4fe1('0xe'));const file_storage_1=require(a11_0x4fe1('0x1b'));const distributed_execution_api_1=require(a11_0x4fe1('0x8'));const split_task_graph_into_stages_1=require(a11_0x4fe1('0x18'));const task_graph_creator_1=require(a11_0x4fe1('0x0'));const process_tasks_1=require(a11_0x4fe1('0x24'));const dte_artifact_storage_1=require(a11_0x4fe1('0x33'));const {output}=require(a11_0x4fe1('0x14'));class NoopLifeCycle{['scheduleTask'](_0x14280a){}['startTask'](_0x17aec2){}[a11_0x4fe1('0x1e')](_0x268b7a){}}const nxCloudDistributedTasksRunner=(_0x52923d,_0x4f068a,_0x46d0d3)=>__awaiter(void 0x0,void 0x0,void 0x0,function*(){if(_0x4f068a[a11_0x4fe1('0x4')]){output['warn']({'title':a11_0x4fe1('0x1f'),'bodyLine':['DTE\x20needs\x20the\x20cache\x20to\x20share\x20files\x20between\x20agents.']});}if(environment_1[a11_0x4fe1('0xf')]){output[a11_0x4fe1('0x16')]({'title':a11_0x4fe1('0x2e')});}_0x4f068a[a11_0x4fe1('0x29')]=new NoopLifeCycle();const _0x4e9cfc=(0x0,environment_1[a11_0x4fe1('0xc')])();if(!_0x4e9cfc){(0x0,print_run_group_error_1[a11_0x4fe1('0x2c')])();return process[a11_0x4fe1('0x26')](0x1);}const _0x40cbf5=new e2e_encryption_1[(a11_0x4fe1('0x1a'))](environment_1['ENCRYPTION_KEY']||_0x4f068a[a11_0x4fe1('0x19')]);const _0x59c67f=new error_reporter_api_1[(a11_0x4fe1('0x27'))](_0x4f068a);const _0x4fbcc6=new dte_artifact_storage_1[(a11_0x4fe1('0x30'))](new file_storage_1[(a11_0x4fe1('0x12'))](_0x40cbf5,_0x59c67f),(0x0,environment_1[a11_0x4fe1('0x17')])(_0x4f068a));const _0x64d18b=new distributed_execution_api_1[(a11_0x4fe1('0x25'))](_0x4f068a);attachSignalListenersToCompleteRunGroupOnError(_0x64d18b,_0x4e9cfc);try{const _0xf76680=getTaskGraph(_0x46d0d3,_0x52923d,_0x4f068a);const _0x4078f4=yield runDistributedExecution(_0x64d18b,_0x4f068a,_0x4fbcc6,_0x4e9cfc,_0xf76680);if(_0x4078f4['commandStatus']===0x0){output['success']({'title':a11_0x4fe1('0x2b'),'bodyLines':['See\x20run\x20details\x20at\x20'+_0x4078f4[a11_0x4fe1('0x2f')]]});}else{output[a11_0x4fe1('0x37')]({'title':a11_0x4fe1('0x1'),'bodyLines':['See\x20run\x20details\x20at\x20'+_0x4078f4[a11_0x4fe1('0x2f')]]});}yield(0x0,metric_logger_1[a11_0x4fe1('0x5')])(_0x4f068a);process[a11_0x4fe1('0x26')](_0x4078f4[a11_0x4fe1('0x11')]);}catch(_0x194008){output[a11_0x4fe1('0x37')]({'title':'Unable\x20to\x20complete\x20a\x20run.','bodyLines':[_0x194008[a11_0x4fe1('0xd')]]});if(_0x194008['axiosException']){console['log'](_0x194008[a11_0x4fe1('0x38')]);}else{console['log'](_0x194008);}try{yield _0x64d18b[a11_0x4fe1('0xb')](_0x4e9cfc,a11_0x4fe1('0x6')+_0x194008[a11_0x4fe1('0xd')]+'\x22');}finally{process[a11_0x4fe1('0x26')](0x1);}}});exports[a11_0x4fe1('0x2')]=nxCloudDistributedTasksRunner;function getTaskGraph(_0x58ff02,_0x4644f0,_0xcf3ac9){if(_0x58ff02[a11_0x4fe1('0x35')]){return _0x58ff02[a11_0x4fe1('0x35')];}else{return(0x0,task_graph_creator_1['createTaskGraphCompat'])(_0xcf3ac9,_0x58ff02[a11_0x4fe1('0x22')],_0x4644f0);}}function attachSignalListenersToCompleteRunGroupOnError(_0x41a1ab,_0x298fd3){process['on'](a11_0x4fe1('0x2d'),()=>__awaiter(this,void 0x0,void 0x0,function*(){yield _0x41a1ab['completeRunGroupWithError'](_0x298fd3,'Main\x20job\x20was\x20terminated\x20via\x20SIGINT');process[a11_0x4fe1('0x26')](0x1);}));process['on'](a11_0x4fe1('0x34'),()=>__awaiter(this,void 0x0,void 0x0,function*(){yield _0x41a1ab['completeRunGroupWithError'](_0x298fd3,a11_0x4fe1('0x1c'));process['exit'](0x1);}));}function runDistributedExecution(_0x313625,_0xaaa0b4,_0x1ad6a7,_0x5947eb,_0x4e3e71){return __awaiter(this,void 0x0,void 0x0,function*(){const _0x55b117=yield _0x313625[a11_0x4fe1('0x10')]((0x0,distributed_execution_api_1[a11_0x4fe1('0x2a')])(_0x5947eb,(0x0,split_task_graph_into_stages_1[a11_0x4fe1('0xa')])(_0x4e3e71),_0xaaa0b4));return yield(0x0,process_tasks_1[a11_0x4fe1('0x15')])(_0x313625,_0x1ad6a7,_0x55b117,Object[a11_0x4fe1('0x20')](_0x4e3e71[a11_0x4fe1('0x9')]));});}