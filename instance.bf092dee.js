(()=>{let e;function t(e,t,r,n){Object.defineProperty(e,t,{get:r,set:n,enumerable:!0,configurable:!0})}var r,n,i,o,s,a,l,c,u,h,d,f,p,g,m,E,y,_,T,A,v,b,R,w,O,S,L,k,N,C,I,x,M,U,P,D,B,F,j,$,G,K,W,H,Y,V,z,q,J,X,Q,Z,ee,et,er,en=globalThis;function ei(e){return e&&e.__esModule?e.default:e}var eo={},es={},ea=en.parcelRequired92b;null==ea&&((ea=function(e){if(e in eo)return eo[e].exports;if(e in es){var t=es[e];delete es[e];var r={id:e,exports:{}};return eo[e]=r,t.call(r.exports,r,r.exports),r.exports}var n=Error("Cannot find module '"+e+"'");throw n.code="MODULE_NOT_FOUND",n}).register=function(e,t){es[e]=t},en.parcelRequired92b=ea);var el=ea.register;el("icQeI",function(e,t){e.exports="abcdefghijklmnopqrstuvwxyz"}),el("cTQZk",function(e,t){e.exports="ABCDEFGHIJKLMNOPQRSTUVWXYZ"}),el("7eCpL",function(e,t){e.exports="0123456789"}),el("8vhtC",function(e,t){e.exports="346789ABCDEFGHJKLMNPQRTUVWXYabcdefghijkmnpqrtwxyz"}),el("9rJTA",function(e,t){e.exports="6789BCDFGHJKLMNPQRTWbcdfghjkmnpqrtwz"}),el("h7ahP",function(e,t){var r=ea("7eCpL"),n=ea("icQeI"),i=ea("cTQZk");e.exports=r+n+i}),el("fsJ5t",function(e,r){t(e.exports,"default",()=>l);var n=ea("80qH2"),i=ea("8EI9A"),o=r&&!r.nodeType&&r,s=o&&e&&!e.nodeType&&e,a=s&&s.exports===o?n.default.Buffer:void 0,l=(a?a.isBuffer:void 0)||i.default}),el("80qH2",function(e,r){t(e.exports,"default",()=>o);var n=ea("bdjjZ"),i="object"==typeof self&&self&&self.Object===Object&&self,o=n.default||i||Function("return this")()}),el("bdjjZ",function(e,r){t(e.exports,"default",()=>n);var n="object"==typeof en&&en&&en.Object===Object&&en}),el("8EI9A",function(e,r){t(e.exports,"default",()=>n);var n=function(){return!1}}),el("i3t7k",function(e,r){t(e.exports,"default",()=>a);var n=ea("bdjjZ"),i=r&&!r.nodeType&&r,o=i&&e&&!e.nodeType&&e,s=o&&o.exports===i&&n.default.process,a=function(){try{var e=o&&o.require&&o.require("util").types;if(e)return e;return s&&s.binding&&s.binding("util")}catch(e){}}()}),el("h53Db",function(e,r){t(e.exports,"default",()=>l);var n=ea("80qH2"),i=r&&!r.nodeType&&r,o=i&&e&&!e.nodeType&&e,s=o&&o.exports===i?n.default.Buffer:void 0,a=s?s.allocUnsafe:void 0,l=function(e,t){if(t)return e.slice();var r=e.length,n=a?a(r):new e.constructor(r);return e.copy(n),n}}),el("22eJ0",function(e,t){var r;e.exports,r=function(){function e(e){return e.charAt(0).toUpperCase()+e.substring(1)}function t(e){return function(){return this[e]}}var r=["isConstructor","isEval","isNative","isToplevel"],n=["columnNumber","lineNumber"],i=["fileName","functionName","source"],o=r.concat(n,i,["args"],["evalOrigin"]);function s(t){if(t)for(var r=0;r<o.length;r++)void 0!==t[o[r]]&&this["set"+e(o[r])](t[o[r]])}s.prototype={getArgs:function(){return this.args},setArgs:function(e){if("[object Array]"!==Object.prototype.toString.call(e))throw TypeError("Args must be an Array");this.args=e},getEvalOrigin:function(){return this.evalOrigin},setEvalOrigin:function(e){if(e instanceof s)this.evalOrigin=e;else if(e instanceof Object)this.evalOrigin=new s(e);else throw TypeError("Eval Origin must be an Object or StackFrame")},toString:function(){var e=this.getFileName()||"",t=this.getLineNumber()||"",r=this.getColumnNumber()||"",n=this.getFunctionName()||"";return this.getIsEval()?e?"[eval] ("+e+":"+t+":"+r+")":"[eval]:"+t+":"+r:n?n+" ("+e+":"+t+":"+r+")":e+":"+t+":"+r}},s.fromString=function(e){var t=e.indexOf("("),r=e.lastIndexOf(")"),n=e.substring(0,t),i=e.substring(t+1,r).split(","),o=e.substring(r+1);if(0===o.indexOf("@"))var a=/@(.+?)(?::(\d+))?(?::(\d+))?$/.exec(o,""),l=a[1],c=a[2],u=a[3];return new s({functionName:n,args:i||void 0,fileName:l,lineNumber:c||void 0,columnNumber:u||void 0})};for(var a=0;a<r.length;a++)s.prototype["get"+e(r[a])]=t(r[a]),s.prototype["set"+e(r[a])]=function(e){return function(t){this[e]=!!t}}(r[a]);for(var l=0;l<n.length;l++)s.prototype["get"+e(n[l])]=t(n[l]),s.prototype["set"+e(n[l])]=function(e){return function(t){if(!(!isNaN(parseFloat(t))&&isFinite(t)))throw TypeError(e+" must be a Number");this[e]=Number(t)}}(n[l]);for(var c=0;c<i.length;c++)s.prototype["get"+e(i[c])]=t(i[c]),s.prototype["set"+e(i[c])]=function(e){return function(t){this[e]=String(t)}}(i[c]);return s},"function"==typeof define&&define.amd?define("stackframe",[],r):e.exports=r()}),el("33pli",function(e,r){t(e.exports,"SourceMapGenerator",()=>n,e=>n=e);var n,i=ea("jFfiB"),o=ea("cCMPy"),s=ea("gjXqb").ArraySet,a=ea("3Y2vJ").MappingList;class l{constructor(e){e||(e={}),this._file=o.getArg(e,"file",null),this._sourceRoot=o.getArg(e,"sourceRoot",null),this._skipValidation=o.getArg(e,"skipValidation",!1),this._sources=new s,this._names=new s,this._mappings=new a,this._sourcesContents=null}static fromSourceMap(e){let t=e.sourceRoot,r=new l({file:e.file,sourceRoot:t});return e.eachMapping(function(e){let n={generated:{line:e.generatedLine,column:e.generatedColumn}};null!=e.source&&(n.source=e.source,null!=t&&(n.source=o.relative(t,n.source)),n.original={line:e.originalLine,column:e.originalColumn},null!=e.name&&(n.name=e.name)),r.addMapping(n)}),e.sources.forEach(function(n){let i=n;null!==t&&(i=o.relative(t,n)),r._sources.has(i)||r._sources.add(i);let s=e.sourceContentFor(n);null!=s&&r.setSourceContent(n,s)}),r}addMapping(e){let t=o.getArg(e,"generated"),r=o.getArg(e,"original",null),n=o.getArg(e,"source",null),i=o.getArg(e,"name",null);this._skipValidation||this._validateMapping(t,r,n,i),null==n||(n=String(n),this._sources.has(n)||this._sources.add(n)),null==i||(i=String(i),this._names.has(i)||this._names.add(i)),this._mappings.add({generatedLine:t.line,generatedColumn:t.column,originalLine:null!=r&&r.line,originalColumn:null!=r&&r.column,source:n,name:i})}setSourceContent(e,t){let r=e;null!=this._sourceRoot&&(r=o.relative(this._sourceRoot,r)),null!=t?(this._sourcesContents||(this._sourcesContents=Object.create(null)),this._sourcesContents[o.toSetString(r)]=t):this._sourcesContents&&(delete this._sourcesContents[o.toSetString(r)],0===Object.keys(this._sourcesContents).length&&(this._sourcesContents=null))}applySourceMap(e,t,r){let n=t;if(null==t){if(null==e.file)throw Error('SourceMapGenerator.prototype.applySourceMap requires either an explicit source file, or the source map\'s "file" property. Both were omitted.');n=e.file}let i=this._sourceRoot;null!=i&&(n=o.relative(i,n));let a=this._mappings.toArray().length>0?new s:this._sources,l=new s;this._mappings.unsortedForEach(function(t){if(t.source===n&&null!=t.originalLine){let n=e.originalPositionFor({line:t.originalLine,column:t.originalColumn});null!=n.source&&(t.source=n.source,null!=r&&(t.source=o.join(r,t.source)),null!=i&&(t.source=o.relative(i,t.source)),t.originalLine=n.line,t.originalColumn=n.column,null!=n.name&&(t.name=n.name))}let s=t.source;null==s||a.has(s)||a.add(s);let c=t.name;null==c||l.has(c)||l.add(c)},this),this._sources=a,this._names=l,e.sources.forEach(function(t){let n=e.sourceContentFor(t);null!=n&&(null!=r&&(t=o.join(r,t)),null!=i&&(t=o.relative(i,t)),this.setSourceContent(t,n))},this)}_validateMapping(e,t,r,n){if(t&&"number"!=typeof t.line&&"number"!=typeof t.column)throw Error("original.line and original.column are not numbers -- you probably meant to omit the original mapping entirely and only map the generated position. If so, pass null for the original mapping instead of an object with empty or null values.");if(e&&"line"in e&&"column"in e&&e.line>0&&e.column>=0&&!t&&!r&&!n);else if(e&&"line"in e&&"column"in e&&t&&"line"in t&&"column"in t&&e.line>0&&e.column>=0&&t.line>0&&t.column>=0&&r);else throw Error("Invalid mapping: "+JSON.stringify({generated:e,source:r,original:t,name:n}))}_serializeMappings(){let e,t,r,n,s=0,a=1,l=0,c=0,u=0,h=0,d="",f=this._mappings.toArray();for(let p=0,g=f.length;p<g;p++){if(t=f[p],e="",t.generatedLine!==a)for(s=0;t.generatedLine!==a;)e+=";",a++;else if(p>0){if(!o.compareByGeneratedPositionsInflated(t,f[p-1]))continue;e+=","}e+=i.encode(t.generatedColumn-s),s=t.generatedColumn,null!=t.source&&(n=this._sources.indexOf(t.source),e+=i.encode(n-h),h=n,e+=i.encode(t.originalLine-1-c),c=t.originalLine-1,e+=i.encode(t.originalColumn-l),l=t.originalColumn,null!=t.name&&(r=this._names.indexOf(t.name),e+=i.encode(r-u),u=r)),d+=e}return d}_generateSourcesContent(e,t){return e.map(function(e){if(!this._sourcesContents)return null;null!=t&&(e=o.relative(t,e));let r=o.toSetString(e);return Object.prototype.hasOwnProperty.call(this._sourcesContents,r)?this._sourcesContents[r]:null},this)}toJSON(){let e={version:this._version,sources:this._sources.toArray(),names:this._names.toArray(),mappings:this._serializeMappings()};return null!=this._file&&(e.file=this._file),null!=this._sourceRoot&&(e.sourceRoot=this._sourceRoot),this._sourcesContents&&(e.sourcesContent=this._generateSourcesContent(e.sources,e.sourceRoot)),e}toString(){return JSON.stringify(this.toJSON())}}l.prototype._version=3,n=l}),el("jFfiB",function(e,r){t(e.exports,"encode",()=>n,e=>n=e);var n,i=ea("d89bl");n=function(e){let t,r="",n=e<0?(-e<<1)+1:(e<<1)+0;do t=31&n,(n>>>=5)>0&&(t|=32),r+=i.encode(t);while(n>0)return r}}),el("d89bl",function(e,r){var n;t(e.exports,"encode",()=>n,e=>n=e);let i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".split("");n=function(e){if(0<=e&&e<i.length)return i[e];throw TypeError("Must be between 0 and 63: "+e)}}),el("cCMPy",function(e,r){var n,i,o,s,a,l,c,u,h,d,f,p,g;t(e.exports,"getArg",()=>n,e=>n=e),t(e.exports,"urlParse",()=>i,e=>i=e),t(e.exports,"isAbsolute",()=>a,e=>a=e),t(e.exports,"normalize",()=>o,e=>o=e),t(e.exports,"join",()=>s,e=>s=e),t(e.exports,"relative",()=>l,e=>l=e),t(e.exports,"toSetString",()=>c,e=>c=e),t(e.exports,"fromSetString",()=>u,e=>u=e),t(e.exports,"compareByOriginalPositions",()=>h,e=>h=e),t(e.exports,"compareByGeneratedPositionsDeflated",()=>d,e=>d=e),t(e.exports,"compareByGeneratedPositionsInflated",()=>f,e=>f=e),t(e.exports,"parseSourceMapInput",()=>p,e=>p=e),t(e.exports,"computeSourceURL",()=>g,e=>g=e),n=function(e,t,r){if(t in e)return e[t];if(3==arguments.length)return r;throw Error('"'+t+'" is a required argument.')};let m=/^(?:([\w+\-.]+):)?\/\/(?:(\w+:\w+)@)?([\w.-]*)(?::(\d+))?(.*)$/,E=/^data:.+\,.+$/;function y(e){let t=e.match(m);return t?{scheme:t[1],auth:t[2],host:t[3],port:t[4],path:t[5]}:null}function _(e){let t="";return e.scheme&&(t+=e.scheme+":"),t+="//",e.auth&&(t+=e.auth+"@"),e.host&&(t+=e.host),e.port&&(t+=":"+e.port),e.path&&(t+=e.path),t}i=y;let T=function(e){let t=[];return function(r){for(let e=0;e<t.length;e++)if(t[e].input===r){let r=t[0];return t[0]=t[e],t[e]=r,t[0].result}let n=e(r);return t.unshift({input:r,result:n}),t.length>32&&t.pop(),n}}(function(e){let t=e,r=y(e);if(r){if(!r.path)return e;t=r.path}let n=a(t),i=[],o=0,s=0;for(;;){if(o=s,-1===(s=t.indexOf("/",o))){i.push(t.slice(o));break}for(i.push(t.slice(o,s));s<t.length&&"/"===t[s];)s++}let l=0;for(s=i.length-1;s>=0;s--){let e=i[s];"."===e?i.splice(s,1):".."===e?l++:l>0&&(""===e?(i.splice(s+1,l),l=0):(i.splice(s,2),l--))}return(""===(t=i.join("/"))&&(t=n?"/":"."),r)?(r.path=t,_(r)):t});function A(e,t){""===e&&(e="."),""===t&&(t=".");let r=y(t),n=y(e);if(n&&(e=n.path||"/"),r&&!r.scheme)return n&&(r.scheme=n.scheme),_(r);if(r||t.match(E))return t;if(n&&!n.host&&!n.path)return n.host=t,_(n);let i="/"===t.charAt(0)?t:T(e.replace(/\/+$/,"")+"/"+t);return n?(n.path=i,_(n)):i}o=T,s=A,a=function(e){return"/"===e.charAt(0)||m.test(e)},l=function(e,t){""===e&&(e="."),e=e.replace(/\/$/,"");let r=0;for(;0!==t.indexOf(e+"/");){let n=e.lastIndexOf("/");if(n<0||(e=e.slice(0,n)).match(/^([^\/]+:\/)?\/*$/))return t;++r}return Array(r+1).join("../")+t.substr(e.length+1)};let v=!("__proto__"in Object.create(null));function b(e){return e}function R(e){if(!e)return!1;let t=e.length;if(t<9||95!==e.charCodeAt(t-1)||95!==e.charCodeAt(t-2)||111!==e.charCodeAt(t-3)||116!==e.charCodeAt(t-4)||111!==e.charCodeAt(t-5)||114!==e.charCodeAt(t-6)||112!==e.charCodeAt(t-7)||95!==e.charCodeAt(t-8)||95!==e.charCodeAt(t-9))return!1;for(let r=t-10;r>=0;r--)if(36!==e.charCodeAt(r))return!1;return!0}function w(e,t){return e===t?0:null===e?1:null===t?-1:e>t?1:-1}c=v?b:function(e){return R(e)?"$"+e:e},u=v?b:function(e){return R(e)?e.slice(1):e},h=function(e,t,r){let n=w(e.source,t.source);return 0!==n||0!=(n=e.originalLine-t.originalLine)||0!=(n=e.originalColumn-t.originalColumn)||r||0!=(n=e.generatedColumn-t.generatedColumn)||0!=(n=e.generatedLine-t.generatedLine)?n:w(e.name,t.name)},d=function(e,t,r){let n=e.generatedLine-t.generatedLine;return 0!==n||0!=(n=e.generatedColumn-t.generatedColumn)||r||0!==(n=w(e.source,t.source))||0!=(n=e.originalLine-t.originalLine)||0!=(n=e.originalColumn-t.originalColumn)?n:w(e.name,t.name)},f=function(e,t){let r=e.generatedLine-t.generatedLine;return 0!==r||0!=(r=e.generatedColumn-t.generatedColumn)||0!==(r=w(e.source,t.source))||0!=(r=e.originalLine-t.originalLine)||0!=(r=e.originalColumn-t.originalColumn)?r:w(e.name,t.name)},p=function(e){return JSON.parse(e.replace(/^\)]}'[^\n]*\n/,""))},g=function(e,t,r){if(t=t||"",e&&("/"!==e[e.length-1]&&"/"!==t[0]&&(e+="/"),t=e+t),r){let e=y(r);if(!e)throw Error("sourceMapURL could not be parsed");if(e.path){let t=e.path.lastIndexOf("/");t>=0&&(e.path=e.path.substring(0,t+1))}t=A(_(e),t)}return T(t)}}),el("gjXqb",function(e,r){var n;t(e.exports,"ArraySet",()=>n,e=>n=e);class i{constructor(){this._array=[],this._set=new Map}static fromArray(e,t){let r=new i;for(let n=0,i=e.length;n<i;n++)r.add(e[n],t);return r}size(){return this._set.size}add(e,t){let r=this.has(e),n=this._array.length;(!r||t)&&this._array.push(e),r||this._set.set(e,n)}has(e){return this._set.has(e)}indexOf(e){let t=this._set.get(e);if(t>=0)return t;throw Error('"'+e+'" is not in the set.')}at(e){if(e>=0&&e<this._array.length)return this._array[e];throw Error("No element indexed by "+e)}toArray(){return this._array.slice()}}n=i}),el("3Y2vJ",function(e,r){t(e.exports,"MappingList",()=>n,e=>n=e);var n,i=ea("cCMPy");n=class{constructor(){this._array=[],this._sorted=!0,this._last={generatedLine:-1,generatedColumn:0}}unsortedForEach(e,t){this._array.forEach(e,t)}add(e){(function(e,t){let r=e.generatedLine,n=t.generatedLine,o=e.generatedColumn,s=t.generatedColumn;return n>r||n==r&&s>=o||0>=i.compareByGeneratedPositionsInflated(e,t)})(this._last,e)?this._last=e:this._sorted=!1,this._array.push(e)}toArray(){return this._sorted||(this._array.sort(i.compareByGeneratedPositionsInflated),this._sorted=!0),this._array}}}),el("gyTFe",function(e,r){t(e.exports,"SourceMapConsumer",()=>n,e=>n=e);var n,i=ea("cCMPy"),o=ea("8tvSO"),s=ea("gjXqb").ArraySet;ea("jFfiB");var a=ea("dSMnb"),l=ea("8wSbu");let c=Symbol("smcInternal");class u{constructor(e,t){let r;if(e==c)return Promise.resolve(this);return r=e,"string"==typeof e&&(r=i.parseSourceMapInput(e)),Promise.resolve(null!=r.sections?new d(r,t):new h(r,t))}static initialize(e){a.initialize(e["lib/mappings.wasm"])}static fromSourceMap(e,t){return h.fromSourceMap(e,t)}static async with(e,t,r){let n=await new u(e,t);try{return await r(n)}finally{n.destroy()}}_parseMappings(e,t){throw Error("Subclasses must implement _parseMappings")}eachMapping(e,t,r){throw Error("Subclasses must implement eachMapping")}allGeneratedPositionsFor(e){throw Error("Subclasses must implement allGeneratedPositionsFor")}destroy(){throw Error("Subclasses must implement destroy")}}u.prototype._version=3,u.GENERATED_ORDER=1,u.ORIGINAL_ORDER=2,u.GREATEST_LOWER_BOUND=1,u.LEAST_UPPER_BOUND=2,n=u;class h extends u{constructor(e,t){return super(c).then(r=>{let n=e;"string"==typeof e&&(n=i.parseSourceMapInput(e));let o=i.getArg(n,"version"),a=i.getArg(n,"sources"),c=i.getArg(n,"names",[]),u=i.getArg(n,"sourceRoot",null),h=i.getArg(n,"sourcesContent",null),d=i.getArg(n,"mappings"),f=i.getArg(n,"file",null);if(o!=r._version)throw Error("Unsupported version: "+o);return u&&(u=i.normalize(u)),a=a.map(String).map(i.normalize).map(function(e){return u&&i.isAbsolute(u)&&i.isAbsolute(e)?i.relative(u,e):e}),r._names=s.fromArray(c.map(String),!0),r._sources=s.fromArray(a,!0),r._absoluteSources=r._sources.toArray().map(function(e){return i.computeSourceURL(u,e,t)}),r.sourceRoot=u,r.sourcesContent=h,r._mappings=d,r._sourceMapURL=t,r.file=f,r._computedColumnSpans=!1,r._mappingsPtr=0,r._wasm=null,l().then(e=>(r._wasm=e,r))})}_findSourceIndex(e){let t=e;if(null!=this.sourceRoot&&(t=i.relative(this.sourceRoot,t)),this._sources.has(t))return this._sources.indexOf(t);for(let t=0;t<this._absoluteSources.length;++t)if(this._absoluteSources[t]==e)return t;return -1}static fromSourceMap(e,t){return new h(e.toString())}get sources(){return this._absoluteSources.slice()}_getMappingsPtr(){return 0===this._mappingsPtr&&this._parseMappings(this._mappings,this.sourceRoot),this._mappingsPtr}_parseMappings(e,t){let r=e.length,n=this._wasm.exports.allocate_mappings(r),i=new Uint8Array(this._wasm.exports.memory.buffer,n,r);for(let t=0;t<r;t++)i[t]=e.charCodeAt(t);let o=this._wasm.exports.parse_mappings(n);if(!o){let e=this._wasm.exports.get_last_error(),t=`Error parsing mappings (code ${e}): `;switch(e){case 1:t+="the mappings contained a negative line, column, source index, or name index";break;case 2:t+="the mappings contained a number larger than 2**32";break;case 3:t+="reached EOF while in the middle of parsing a VLQ";break;case 4:t+="invalid base 64 character while parsing a VLQ";break;default:t+="unknown error code"}throw Error(t)}this._mappingsPtr=o}eachMapping(e,t,r){let n=t||null,o=r||u.GENERATED_ORDER,s=this.sourceRoot;this._wasm.withMappingCallback(t=>{null!==t.source&&(t.source=this._sources.at(t.source),t.source=i.computeSourceURL(s,t.source,this._sourceMapURL),null!==t.name&&(t.name=this._names.at(t.name))),e.call(n,t)},()=>{switch(o){case u.GENERATED_ORDER:this._wasm.exports.by_generated_location(this._getMappingsPtr());break;case u.ORIGINAL_ORDER:this._wasm.exports.by_original_location(this._getMappingsPtr());break;default:throw Error("Unknown order of iteration.")}})}allGeneratedPositionsFor(e){let t=i.getArg(e,"source"),r=i.getArg(e,"line"),n=e.column||0;if((t=this._findSourceIndex(t))<0)return[];if(r<1)throw Error("Line numbers must be >= 1");if(n<0)throw Error("Column numbers must be >= 0");let o=[];return this._wasm.withMappingCallback(e=>{let t=e.lastGeneratedColumn;this._computedColumnSpans&&null===t&&(t=1/0),o.push({line:e.generatedLine,column:e.generatedColumn,lastColumn:t})},()=>{this._wasm.exports.all_generated_locations_for(this._getMappingsPtr(),t,r-1,"column"in e,n)}),o}destroy(){0!==this._mappingsPtr&&(this._wasm.exports.free_mappings(this._mappingsPtr),this._mappingsPtr=0)}computeColumnSpans(){this._computedColumnSpans||(this._wasm.exports.compute_column_spans(this._getMappingsPtr()),this._computedColumnSpans=!0)}originalPositionFor(e){let t;let r={generatedLine:i.getArg(e,"line"),generatedColumn:i.getArg(e,"column")};if(r.generatedLine<1)throw Error("Line numbers must be >= 1");if(r.generatedColumn<0)throw Error("Column numbers must be >= 0");let n=i.getArg(e,"bias",u.GREATEST_LOWER_BOUND);if(null==n&&(n=u.GREATEST_LOWER_BOUND),this._wasm.withMappingCallback(e=>t=e,()=>{this._wasm.exports.original_location_for(this._getMappingsPtr(),r.generatedLine-1,r.generatedColumn,n)}),t&&t.generatedLine===r.generatedLine){let e=i.getArg(t,"source",null);null!==e&&(e=this._sources.at(e),e=i.computeSourceURL(this.sourceRoot,e,this._sourceMapURL));let r=i.getArg(t,"name",null);return null!==r&&(r=this._names.at(r)),{source:e,line:i.getArg(t,"originalLine",null),column:i.getArg(t,"originalColumn",null),name:r}}return{source:null,line:null,column:null,name:null}}hasContentsOfAllSources(){return!!this.sourcesContent&&this.sourcesContent.length>=this._sources.size()&&!this.sourcesContent.some(function(e){return null==e})}sourceContentFor(e,t){let r;if(!this.sourcesContent)return null;let n=this._findSourceIndex(e);if(n>=0)return this.sourcesContent[n];let o=e;if(null!=this.sourceRoot&&(o=i.relative(this.sourceRoot,o)),null!=this.sourceRoot&&(r=i.urlParse(this.sourceRoot))){let e=o.replace(/^file:\/\//,"");if("file"==r.scheme&&this._sources.has(e))return this.sourcesContent[this._sources.indexOf(e)];if((!r.path||"/"==r.path)&&this._sources.has("/"+o))return this.sourcesContent[this._sources.indexOf("/"+o)]}if(t)return null;throw Error('"'+o+'" is not in the SourceMap.')}generatedPositionFor(e){let t,r=i.getArg(e,"source");if((r=this._findSourceIndex(r))<0)return{line:null,column:null,lastColumn:null};let n={source:r,originalLine:i.getArg(e,"line"),originalColumn:i.getArg(e,"column")};if(n.originalLine<1)throw Error("Line numbers must be >= 1");if(n.originalColumn<0)throw Error("Column numbers must be >= 0");let o=i.getArg(e,"bias",u.GREATEST_LOWER_BOUND);if(null==o&&(o=u.GREATEST_LOWER_BOUND),this._wasm.withMappingCallback(e=>t=e,()=>{this._wasm.exports.generated_location_for(this._getMappingsPtr(),n.source,n.originalLine-1,n.originalColumn,o)}),t&&t.source===n.source){let e=t.lastGeneratedColumn;return this._computedColumnSpans&&null===e&&(e=1/0),{line:i.getArg(t,"generatedLine",null),column:i.getArg(t,"generatedColumn",null),lastColumn:e}}return{line:null,column:null,lastColumn:null}}}h.prototype.consumer=u;class d extends u{constructor(e,t){return super(c).then(r=>{let n=e;"string"==typeof e&&(n=i.parseSourceMapInput(e));let o=i.getArg(n,"version"),a=i.getArg(n,"sections");if(o!=r._version)throw Error("Unsupported version: "+o);r._sources=new s,r._names=new s,r.__generatedMappings=null,r.__originalMappings=null,r.__generatedMappingsUnsorted=null,r.__originalMappingsUnsorted=null;let l={line:-1,column:0};return Promise.all(a.map(e=>{if(e.url)throw Error("Support for url field in sections not implemented.");let r=i.getArg(e,"offset"),n=i.getArg(r,"line"),o=i.getArg(r,"column");if(n<l.line||n===l.line&&o<l.column)throw Error("Section offsets must be ordered and non-overlapping.");return l=r,new u(i.getArg(e,"map"),t).then(e=>({generatedOffset:{generatedLine:n+1,generatedColumn:o+1},consumer:e}))})).then(e=>(r._sections=e,r))})}get _generatedMappings(){return this.__generatedMappings||this._sortGeneratedMappings(),this.__generatedMappings}get _originalMappings(){return this.__originalMappings||this._sortOriginalMappings(),this.__originalMappings}get _generatedMappingsUnsorted(){return this.__generatedMappingsUnsorted||this._parseMappings(this._mappings,this.sourceRoot),this.__generatedMappingsUnsorted}get _originalMappingsUnsorted(){return this.__originalMappingsUnsorted||this._parseMappings(this._mappings,this.sourceRoot),this.__originalMappingsUnsorted}_sortGeneratedMappings(){let e=this._generatedMappingsUnsorted;e.sort(i.compareByGeneratedPositionsDeflated),this.__generatedMappings=e}_sortOriginalMappings(){let e=this._originalMappingsUnsorted;e.sort(i.compareByOriginalPositions),this.__originalMappings=e}get sources(){let e=[];for(let t=0;t<this._sections.length;t++)for(let r=0;r<this._sections[t].consumer.sources.length;r++)e.push(this._sections[t].consumer.sources[r]);return e}originalPositionFor(e){let t={generatedLine:i.getArg(e,"line"),generatedColumn:i.getArg(e,"column")},r=o.search(t,this._sections,function(e,t){return e.generatedLine-t.generatedOffset.generatedLine||e.generatedColumn-t.generatedOffset.generatedColumn}),n=this._sections[r];return n?n.consumer.originalPositionFor({line:t.generatedLine-(n.generatedOffset.generatedLine-1),column:t.generatedColumn-(n.generatedOffset.generatedLine===t.generatedLine?n.generatedOffset.generatedColumn-1:0),bias:e.bias}):{source:null,line:null,column:null,name:null}}hasContentsOfAllSources(){return this._sections.every(function(e){return e.consumer.hasContentsOfAllSources()})}sourceContentFor(e,t){for(let t=0;t<this._sections.length;t++){let r=this._sections[t].consumer.sourceContentFor(e,!0);if(r)return r}if(t)return null;throw Error('"'+e+'" is not in the SourceMap.')}generatedPositionFor(e){for(let t=0;t<this._sections.length;t++){let r=this._sections[t];if(-1===r.consumer._findSourceIndex(i.getArg(e,"source")))continue;let n=r.consumer.generatedPositionFor(e);if(n)return{line:n.line+(r.generatedOffset.generatedLine-1),column:n.column+(r.generatedOffset.generatedLine===n.line?r.generatedOffset.generatedColumn-1:0)}}return{line:null,column:null}}_parseMappings(e,t){let r=this.__generatedMappingsUnsorted=[],n=this.__originalMappingsUnsorted=[];for(let e=0;e<this._sections.length;e++){let t=this._sections[e],o=[];t.consumer.eachMapping(e=>o.push(e));for(let e=0;e<o.length;e++){let s=o[e],a=i.computeSourceURL(t.consumer.sourceRoot,null,this._sourceMapURL);this._sources.add(a),a=this._sources.indexOf(a);let l=null;s.name&&(this._names.add(s.name),l=this._names.indexOf(s.name));let c={source:a,generatedLine:s.generatedLine+(t.generatedOffset.generatedLine-1),generatedColumn:s.generatedColumn+(t.generatedOffset.generatedLine===s.generatedLine?t.generatedOffset.generatedColumn-1:0),originalLine:s.originalLine,originalColumn:s.originalColumn,name:l};r.push(c),"number"==typeof c.originalLine&&n.push(c)}}}eachMapping(e,t,r){let n;switch(r||u.GENERATED_ORDER){case u.GENERATED_ORDER:n=this._generatedMappings;break;case u.ORIGINAL_ORDER:n=this._originalMappings;break;default:throw Error("Unknown order of iteration.")}let o=this.sourceRoot;n.map(function(e){let t=null;return null!==e.source&&(t=this._sources.at(e.source),t=i.computeSourceURL(o,t,this._sourceMapURL)),{source:t,generatedLine:e.generatedLine,generatedColumn:e.generatedColumn,originalLine:e.originalLine,originalColumn:e.originalColumn,name:null===e.name?null:this._names.at(e.name)}},this).forEach(e,t||null)}_findMapping(e,t,r,n,i,s){if(e[r]<=0)throw TypeError("Line must be greater than or equal to 1, got "+e[r]);if(e[n]<0)throw TypeError("Column must be greater than or equal to 0, got "+e[n]);return o.search(e,t,i,s)}allGeneratedPositionsFor(e){let t=i.getArg(e,"line"),r={source:i.getArg(e,"source"),originalLine:t,originalColumn:i.getArg(e,"column",0)};if(r.source=this._findSourceIndex(r.source),r.source<0)return[];if(r.originalLine<1)throw Error("Line numbers must be >= 1");if(r.originalColumn<0)throw Error("Column numbers must be >= 0");let n=[],s=this._findMapping(r,this._originalMappings,"originalLine","originalColumn",i.compareByOriginalPositions,o.LEAST_UPPER_BOUND);if(s>=0){let r=this._originalMappings[s];if(void 0===e.column){let e=r.originalLine;for(;r&&r.originalLine===e;){let e=r.lastGeneratedColumn;this._computedColumnSpans&&null===e&&(e=1/0),n.push({line:i.getArg(r,"generatedLine",null),column:i.getArg(r,"generatedColumn",null),lastColumn:e}),r=this._originalMappings[++s]}}else{let e=r.originalColumn;for(;r&&r.originalLine===t&&r.originalColumn==e;){let e=r.lastGeneratedColumn;this._computedColumnSpans&&null===e&&(e=1/0),n.push({line:i.getArg(r,"generatedLine",null),column:i.getArg(r,"generatedColumn",null),lastColumn:e}),r=this._originalMappings[++s]}}}return n}destroy(){for(let e=0;e<this._sections.length;e++)this._sections[e].consumer.destroy()}}}),el("8tvSO",function(e,r){var n,i,o;t(e.exports,"GREATEST_LOWER_BOUND",()=>n,e=>n=e),t(e.exports,"LEAST_UPPER_BOUND",()=>i,e=>i=e),t(e.exports,"search",()=>o,e=>o=e),n=1,i=2,o=function(e,t,r,o){if(0===t.length)return -1;let s=function e(t,r,n,o,s,a){let l=Math.floor((r-t)/2)+t,c=s(n,o[l],!0);return 0===c?l:c>0?r-l>1?e(l,r,n,o,s,a):a==i?r<o.length?r:-1:l:l-t>1?e(t,l,n,o,s,a):a==i?l:t<0?-1:t}(-1,t.length,e,t,r,o||n);if(s<0)return -1;for(;s-1>=0&&0===r(t[s],t[s-1],!0);)--s;return s}}),el("dSMnb",function(e,t){if((function(){return"undefined"!=typeof window&&this===window}).call()){let t=null;e.exports=function(){if("string"==typeof t)return fetch(t).then(e=>e.arrayBuffer());if(t instanceof ArrayBuffer)return Promise.resolve(t);throw Error("You must provide the string URL or ArrayBuffer contents of lib/mappings.wasm by calling SourceMapConsumer.initialize({ 'lib/mappings.wasm': ... }) before using SourceMapConsumer")},e.exports.initialize=e=>t=e}else{let t=ea("fW3lo"),r=ea("6oeIa");e.exports=function(){return new Promise((e,n)=>{let i=r.join("node_modules/source-map/lib","mappings.wasm");t.readFile(i,null,(t,r)=>{if(t){n(t);return}e(r.buffer)})})},e.exports.initialize=e=>{console.debug("SourceMapConsumer.initialize is a no-op when running in node.js")}}}),el("fW3lo",function(e,t){}),el("6oeIa",function(e,t){var r=ea("OJkA4");function n(e){if("string"!=typeof e)throw TypeError("Path must be a string. Received "+JSON.stringify(e))}function i(e,t){for(var r,n="",i=0,o=-1,s=0,a=0;a<=e.length;++a){if(a<e.length)r=e.charCodeAt(a);else if(47===r)break;else r=47;if(47===r){if(o===a-1||1===s);else if(o!==a-1&&2===s){if(n.length<2||2!==i||46!==n.charCodeAt(n.length-1)||46!==n.charCodeAt(n.length-2)){if(n.length>2){var l=n.lastIndexOf("/");if(l!==n.length-1){-1===l?(n="",i=0):i=(n=n.slice(0,l)).length-1-n.lastIndexOf("/"),o=a,s=0;continue}}else if(2===n.length||1===n.length){n="",i=0,o=a,s=0;continue}}t&&(n.length>0?n+="/..":n="..",i=2)}else n.length>0?n+="/"+e.slice(o+1,a):n=e.slice(o+1,a),i=a-o-1;o=a,s=0}else 46===r&&-1!==s?++s:s=-1}return n}var o={resolve:function(){for(var e,t,o="",s=!1,a=arguments.length-1;a>=-1&&!s;a--)a>=0?t=arguments[a]:(void 0===e&&(e=r.cwd()),t=e),n(t),0!==t.length&&(o=t+"/"+o,s=47===t.charCodeAt(0));return(o=i(o,!s),s)?o.length>0?"/"+o:"/":o.length>0?o:"."},normalize:function(e){if(n(e),0===e.length)return".";var t=47===e.charCodeAt(0),r=47===e.charCodeAt(e.length-1);return(0!==(e=i(e,!t)).length||t||(e="."),e.length>0&&r&&(e+="/"),t)?"/"+e:e},isAbsolute:function(e){return n(e),e.length>0&&47===e.charCodeAt(0)},join:function(){if(0==arguments.length)return".";for(var e,t=0;t<arguments.length;++t){var r=arguments[t];n(r),r.length>0&&(void 0===e?e=r:e+="/"+r)}return void 0===e?".":o.normalize(e)},relative:function(e,t){if(n(e),n(t),e===t||(e=o.resolve(e))===(t=o.resolve(t)))return"";for(var r=1;r<e.length&&47===e.charCodeAt(r);++r);for(var i=e.length,s=i-r,a=1;a<t.length&&47===t.charCodeAt(a);++a);for(var l=t.length-a,c=s<l?s:l,u=-1,h=0;h<=c;++h){if(h===c){if(l>c){if(47===t.charCodeAt(a+h))return t.slice(a+h+1);if(0===h)return t.slice(a+h)}else s>c&&(47===e.charCodeAt(r+h)?u=h:0===h&&(u=0));break}var d=e.charCodeAt(r+h);if(d!==t.charCodeAt(a+h))break;47===d&&(u=h)}var f="";for(h=r+u+1;h<=i;++h)(h===i||47===e.charCodeAt(h))&&(0===f.length?f+="..":f+="/..");return f.length>0?f+t.slice(a+u):(a+=u,47===t.charCodeAt(a)&&++a,t.slice(a))},_makeLong:function(e){return e},dirname:function(e){if(n(e),0===e.length)return".";for(var t=e.charCodeAt(0),r=47===t,i=-1,o=!0,s=e.length-1;s>=1;--s)if(47===(t=e.charCodeAt(s))){if(!o){i=s;break}}else o=!1;return -1===i?r?"/":".":r&&1===i?"//":e.slice(0,i)},basename:function(e,t){if(void 0!==t&&"string"!=typeof t)throw TypeError('"ext" argument must be a string');n(e);var r,i=0,o=-1,s=!0;if(void 0!==t&&t.length>0&&t.length<=e.length){if(t.length===e.length&&t===e)return"";var a=t.length-1,l=-1;for(r=e.length-1;r>=0;--r){var c=e.charCodeAt(r);if(47===c){if(!s){i=r+1;break}}else -1===l&&(s=!1,l=r+1),a>=0&&(c===t.charCodeAt(a)?-1==--a&&(o=r):(a=-1,o=l))}return i===o?o=l:-1===o&&(o=e.length),e.slice(i,o)}for(r=e.length-1;r>=0;--r)if(47===e.charCodeAt(r)){if(!s){i=r+1;break}}else -1===o&&(s=!1,o=r+1);return -1===o?"":e.slice(i,o)},extname:function(e){n(e);for(var t=-1,r=0,i=-1,o=!0,s=0,a=e.length-1;a>=0;--a){var l=e.charCodeAt(a);if(47===l){if(!o){r=a+1;break}continue}-1===i&&(o=!1,i=a+1),46===l?-1===t?t=a:1!==s&&(s=1):-1!==t&&(s=-1)}return -1===t||-1===i||0===s||1===s&&t===i-1&&t===r+1?"":e.slice(t,i)},format:function(e){var t,r;if(null===e||"object"!=typeof e)throw TypeError('The "pathObject" argument must be of type Object. Received type '+typeof e);return t=e.dir||e.root,r=e.base||(e.name||"")+(e.ext||""),t?t===e.root?t+r:t+"/"+r:r},parse:function(e){n(e);var t,r={root:"",dir:"",base:"",ext:"",name:""};if(0===e.length)return r;var i=e.charCodeAt(0),o=47===i;o?(r.root="/",t=1):t=0;for(var s=-1,a=0,l=-1,c=!0,u=e.length-1,h=0;u>=t;--u){if(47===(i=e.charCodeAt(u))){if(!c){a=u+1;break}continue}-1===l&&(c=!1,l=u+1),46===i?-1===s?s=u:1!==h&&(h=1):-1!==s&&(h=-1)}return -1===s||-1===l||0===h||1===h&&s===l-1&&s===a+1?-1!==l&&(0===a&&o?r.base=r.name=e.slice(1,l):r.base=r.name=e.slice(a,l)):(0===a&&o?(r.name=e.slice(1,s),r.base=e.slice(1,l)):(r.name=e.slice(a,s),r.base=e.slice(a,l)),r.ext=e.slice(s,l)),a>0?r.dir=e.slice(0,a-1):o&&(r.dir="/"),r},sep:"/",delimiter:":",win32:null,posix:null};o.posix=o,e.exports=o}),el("OJkA4",function(e,t){var r,n,i,o=e.exports={};function s(){throw Error("setTimeout has not been defined")}function a(){throw Error("clearTimeout has not been defined")}function l(e){if(r===setTimeout)return setTimeout(e,0);if((r===s||!r)&&setTimeout)return r=setTimeout,setTimeout(e,0);try{return r(e,0)}catch(t){try{return r.call(null,e,0)}catch(t){return r.call(this,e,0)}}}!function(){try{r="function"==typeof setTimeout?setTimeout:s}catch(e){r=s}try{n="function"==typeof clearTimeout?clearTimeout:a}catch(e){n=a}}();var c=[],u=!1,h=-1;function d(){u&&i&&(u=!1,i.length?c=i.concat(c):h=-1,c.length&&f())}function f(){if(!u){var e=l(d);u=!0;for(var t=c.length;t;){for(i=c,c=[];++h<t;)i&&i[h].run();h=-1,t=c.length}i=null,u=!1,function(e){if(n===clearTimeout)return clearTimeout(e);if((n===a||!n)&&clearTimeout)return n=clearTimeout,clearTimeout(e);try{n(e)}catch(t){try{return n.call(null,e)}catch(t){return n.call(this,e)}}}(e)}}function p(e,t){this.fun=e,this.array=t}function g(){}o.nextTick=function(e){var t=Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)t[r-1]=arguments[r];c.push(new p(e,t)),1!==c.length||u||l(f)},p.prototype.run=function(){this.fun.apply(null,this.array)},o.title="browser",o.browser=!0,o.env={},o.argv=[],o.version="",o.versions={},o.on=g,o.addListener=g,o.once=g,o.off=g,o.removeListener=g,o.removeAllListeners=g,o.emit=g,o.prependListener=g,o.prependOnceListener=g,o.listeners=function(e){return[]},o.binding=function(e){throw Error("process.binding is not supported")},o.cwd=function(){return"/"},o.chdir=function(e){throw Error("process.chdir is not supported")},o.umask=function(){return 0}}),el("8wSbu",function(e,t){var r=ea("dSMnb");function n(){this.generatedLine=0,this.generatedColumn=0,this.lastGeneratedColumn=null,this.source=null,this.originalLine=null,this.originalColumn=null,this.name=null}let i=null;e.exports=function(){if(i)return i;let e=[];return i=r().then(t=>WebAssembly.instantiate(t,{env:{mapping_callback(t,r,i,o,s,a,l,c,u,h){let d=new n;d.generatedLine=t+1,d.generatedColumn=r,i&&(d.lastGeneratedColumn=o-1),s&&(d.source=a,d.originalLine=l+1,d.originalColumn=c,u&&(d.name=h)),e[e.length-1](d)},start_all_generated_locations_for(){console.time("all_generated_locations_for")},end_all_generated_locations_for(){console.timeEnd("all_generated_locations_for")},start_compute_column_spans(){console.time("compute_column_spans")},end_compute_column_spans(){console.timeEnd("compute_column_spans")},start_generated_location_for(){console.time("generated_location_for")},end_generated_location_for(){console.timeEnd("generated_location_for")},start_original_location_for(){console.time("original_location_for")},end_original_location_for(){console.timeEnd("original_location_for")},start_parse_mappings(){console.time("parse_mappings")},end_parse_mappings(){console.timeEnd("parse_mappings")},start_sort_by_generated_location(){console.time("sort_by_generated_location")},end_sort_by_generated_location(){console.timeEnd("sort_by_generated_location")},start_sort_by_original_location(){console.time("sort_by_original_location")},end_sort_by_original_location(){console.timeEnd("sort_by_original_location")}}})).then(t=>({exports:t.instance.exports,withMappingCallback:(t,r)=>{e.push(t);try{r()}finally{e.pop()}}})).then(null,e=>{throw i=null,e})}}),el("8hfg7",function(e,r){t(e.exports,"SourceNode",()=>n,e=>n=e);var n,i=ea("33pli").SourceMapGenerator,o=ea("cCMPy");let s=/(\r?\n)/,a="$$$isSourceNode$$$";class l{constructor(e,t,r,n,i){this.children=[],this.sourceContents={},this.line=null==e?null:e,this.column=null==t?null:t,this.source=null==r?null:r,this.name=null==i?null:i,this[a]=!0,null!=n&&this.add(n)}static fromStringWithSourceMap(e,t,r){let n;let i=new l,a=e.split(s),c=0,u=function(){return e()+(e()||"");function e(){return c<a.length?a[c++]:void 0}},h=1,d=0,f=null;return t.eachMapping(function(e){if(null!==f){if(h<e.generatedLine)p(f,u()),h++,d=0;else{let t=(n=a[c]||"").substr(0,e.generatedColumn-d);a[c]=n.substr(e.generatedColumn-d),d=e.generatedColumn,p(f,t),f=e;return}}for(;h<e.generatedLine;)i.add(u()),h++;d<e.generatedColumn&&(n=a[c]||"",i.add(n.substr(0,e.generatedColumn)),a[c]=n.substr(e.generatedColumn),d=e.generatedColumn),f=e},this),c<a.length&&(f&&p(f,u()),i.add(a.splice(c).join(""))),t.sources.forEach(function(e){let n=t.sourceContentFor(e);null!=n&&(null!=r&&(e=o.join(r,e)),i.setSourceContent(e,n))}),i;function p(e,t){if(null===e||void 0===e.source)i.add(t);else{let n=r?o.join(r,e.source):e.source;i.add(new l(e.originalLine,e.originalColumn,n,t,e.name))}}}add(e){if(Array.isArray(e))e.forEach(function(e){this.add(e)},this);else if(e[a]||"string"==typeof e)e&&this.children.push(e);else throw TypeError("Expected a SourceNode, string, or an array of SourceNodes and strings. Got "+e);return this}prepend(e){if(Array.isArray(e))for(let t=e.length-1;t>=0;t--)this.prepend(e[t]);else if(e[a]||"string"==typeof e)this.children.unshift(e);else throw TypeError("Expected a SourceNode, string, or an array of SourceNodes and strings. Got "+e);return this}walk(e){let t;for(let r=0,n=this.children.length;r<n;r++)(t=this.children[r])[a]?t.walk(e):""!==t&&e(t,{source:this.source,line:this.line,column:this.column,name:this.name})}join(e){let t,r;let n=this.children.length;if(n>0){for(r=0,t=[];r<n-1;r++)t.push(this.children[r]),t.push(e);t.push(this.children[r]),this.children=t}return this}replaceRight(e,t){let r=this.children[this.children.length-1];return r[a]?r.replaceRight(e,t):"string"==typeof r?this.children[this.children.length-1]=r.replace(e,t):this.children.push("".replace(e,t)),this}setSourceContent(e,t){this.sourceContents[o.toSetString(e)]=t}walkSourceContents(e){for(let t=0,r=this.children.length;t<r;t++)this.children[t][a]&&this.children[t].walkSourceContents(e);let t=Object.keys(this.sourceContents);for(let r=0,n=t.length;r<n;r++)e(o.fromSetString(t[r]),this.sourceContents[t[r]])}toString(){let e="";return this.walk(function(t){e+=t}),e}toStringWithSourceMap(e){let t={code:"",line:1,column:0},r=new i(e),n=!1,o=null,s=null,a=null,l=null;return this.walk(function(e,i){t.code+=e,null!==i.source&&null!==i.line&&null!==i.column?((o!==i.source||s!==i.line||a!==i.column||l!==i.name)&&r.addMapping({source:i.source,original:{line:i.line,column:i.column},generated:{line:t.line,column:t.column},name:i.name}),o=i.source,s=i.line,a=i.column,l=i.name,n=!0):n&&(r.addMapping({generated:{line:t.line,column:t.column}}),o=null,n=!1);for(let s=0,a=e.length;s<a;s++)10===e.charCodeAt(s)?(t.line++,t.column=0,s+1===a?(o=null,n=!1):n&&r.addMapping({source:i.source,original:{line:i.line,column:i.column},generated:{line:t.line,column:t.column},name:i.name})):t.column++}),this.walkSourceContents(function(e,t){r.setSourceContent(e,t)}),{code:t.code,map:r}}}n=l}),el("ioQH2",function(e,r){t(e.exports,"Children",()=>n,e=>n=e),t(e.exports,"Component",()=>i,e=>i=e),t(e.exports,"Fragment",()=>o,e=>o=e),t(e.exports,"Profiler",()=>s,e=>s=e),t(e.exports,"PureComponent",()=>a,e=>a=e),t(e.exports,"StrictMode",()=>l,e=>l=e),t(e.exports,"Suspense",()=>c,e=>c=e),t(e.exports,"__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED",()=>u,e=>u=e),t(e.exports,"cloneElement",()=>h,e=>h=e),t(e.exports,"createContext",()=>d,e=>d=e),t(e.exports,"createElement",()=>f,e=>f=e),t(e.exports,"createFactory",()=>p,e=>p=e),t(e.exports,"createRef",()=>g,e=>g=e),t(e.exports,"forwardRef",()=>m,e=>m=e),t(e.exports,"isValidElement",()=>E,e=>E=e),t(e.exports,"lazy",()=>y,e=>y=e),t(e.exports,"memo",()=>_,e=>_=e),t(e.exports,"startTransition",()=>T,e=>T=e),t(e.exports,"unstable_act",()=>A,e=>A=e),t(e.exports,"useCallback",()=>v,e=>v=e),t(e.exports,"useContext",()=>b,e=>b=e),t(e.exports,"useDebugValue",()=>R,e=>R=e),t(e.exports,"useDeferredValue",()=>w,e=>w=e),t(e.exports,"useEffect",()=>O,e=>O=e),t(e.exports,"useId",()=>S,e=>S=e),t(e.exports,"useImperativeHandle",()=>L,e=>L=e),t(e.exports,"useInsertionEffect",()=>k,e=>k=e),t(e.exports,"useLayoutEffect",()=>N,e=>N=e),t(e.exports,"useMemo",()=>C,e=>C=e),t(e.exports,"useReducer",()=>I,e=>I=e),t(e.exports,"useRef",()=>x,e=>x=e),t(e.exports,"useState",()=>M,e=>M=e),t(e.exports,"useSyncExternalStore",()=>U,e=>U=e),t(e.exports,"useTransition",()=>P,e=>P=e),t(e.exports,"version",()=>D,e=>D=e);var n,i,o,s,a,l,c,u,h,d,f,p,g,m,E,y,_,T,A,v,b,R,w,O,S,L,k,N,C,I,x,M,U,P,D,B=Symbol.for("react.element"),F=Symbol.for("react.portal"),j=Symbol.for("react.fragment"),$=Symbol.for("react.strict_mode"),G=Symbol.for("react.profiler"),K=Symbol.for("react.provider"),W=Symbol.for("react.context"),H=Symbol.for("react.forward_ref"),Y=Symbol.for("react.suspense"),V=Symbol.for("react.memo"),z=Symbol.for("react.lazy"),q=Symbol.iterator,J={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},X=Object.assign,Q={};function Z(e,t,r){this.props=e,this.context=t,this.refs=Q,this.updater=r||J}function ee(){}function et(e,t,r){this.props=e,this.context=t,this.refs=Q,this.updater=r||J}Z.prototype.isReactComponent={},Z.prototype.setState=function(e,t){if("object"!=typeof e&&"function"!=typeof e&&null!=e)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")},Z.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},ee.prototype=Z.prototype;var er=et.prototype=new ee;er.constructor=et,X(er,Z.prototype),er.isPureReactComponent=!0;var en=Array.isArray,ei=Object.prototype.hasOwnProperty,eo={current:null},es={key:!0,ref:!0,__self:!0,__source:!0};function ea(e,t,r){var n,i={},o=null,s=null;if(null!=t)for(n in void 0!==t.ref&&(s=t.ref),void 0!==t.key&&(o=""+t.key),t)ei.call(t,n)&&!es.hasOwnProperty(n)&&(i[n]=t[n]);var a=arguments.length-2;if(1===a)i.children=r;else if(1<a){for(var l=Array(a),c=0;c<a;c++)l[c]=arguments[c+2];i.children=l}if(e&&e.defaultProps)for(n in a=e.defaultProps)void 0===i[n]&&(i[n]=a[n]);return{$$typeof:B,type:e,key:o,ref:s,props:i,_owner:eo.current}}function el(e){return"object"==typeof e&&null!==e&&e.$$typeof===B}var ec=/\/+/g;function eu(e,t){var r,n;return"object"==typeof e&&null!==e&&null!=e.key?(r=""+e.key,n={"=":"=0",":":"=2"},"$"+r.replace(/[=:]/g,function(e){return n[e]})):t.toString(36)}function eh(e,t,r){if(null==e)return e;var n=[],i=0;return function e(t,r,n,i,o){var s,a,l,c=typeof t;("undefined"===c||"boolean"===c)&&(t=null);var u=!1;if(null===t)u=!0;else switch(c){case"string":case"number":u=!0;break;case"object":switch(t.$$typeof){case B:case F:u=!0}}if(u)return o=o(u=t),t=""===i?"."+eu(u,0):i,en(o)?(n="",null!=t&&(n=t.replace(ec,"$&/")+"/"),e(o,r,n,"",function(e){return e})):null!=o&&(el(o)&&(s=o,a=n+(!o.key||u&&u.key===o.key?"":(""+o.key).replace(ec,"$&/")+"/")+t,o={$$typeof:B,type:s.type,key:a,ref:s.ref,props:s.props,_owner:s._owner}),r.push(o)),1;if(u=0,i=""===i?".":i+":",en(t))for(var h=0;h<t.length;h++){var d=i+eu(c=t[h],h);u+=e(c,r,n,d,o)}else if("function"==typeof(d=null===(l=t)||"object"!=typeof l?null:"function"==typeof(l=q&&l[q]||l["@@iterator"])?l:null))for(t=d.call(t),h=0;!(c=t.next()).done;)d=i+eu(c=c.value,h++),u+=e(c,r,n,d,o);else if("object"===c)throw Error("Objects are not valid as a React child (found: "+("[object Object]"===(r=String(t))?"object with keys {"+Object.keys(t).join(", ")+"}":r)+"). If you meant to render a collection of children, use an array instead.");return u}(e,n,"","",function(e){return t.call(r,e,i++)}),n}function ed(e){if(-1===e._status){var t=e._result;(t=t()).then(function(t){(0===e._status||-1===e._status)&&(e._status=1,e._result=t)},function(t){(0===e._status||-1===e._status)&&(e._status=2,e._result=t)}),-1===e._status&&(e._status=0,e._result=t)}if(1===e._status)return e._result.default;throw e._result}var ef={current:null},ep={transition:null};n={map:eh,forEach:function(e,t,r){eh(e,function(){t.apply(this,arguments)},r)},count:function(e){var t=0;return eh(e,function(){t++}),t},toArray:function(e){return eh(e,function(e){return e})||[]},only:function(e){if(!el(e))throw Error("React.Children.only expected to receive a single React element child.");return e}},i=Z,o=j,s=G,a=et,l=$,c=Y,u={ReactCurrentDispatcher:ef,ReactCurrentBatchConfig:ep,ReactCurrentOwner:eo},h=function(e,t,r){if(null==e)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var n=X({},e.props),i=e.key,o=e.ref,s=e._owner;if(null!=t){if(void 0!==t.ref&&(o=t.ref,s=eo.current),void 0!==t.key&&(i=""+t.key),e.type&&e.type.defaultProps)var a=e.type.defaultProps;for(l in t)ei.call(t,l)&&!es.hasOwnProperty(l)&&(n[l]=void 0===t[l]&&void 0!==a?a[l]:t[l])}var l=arguments.length-2;if(1===l)n.children=r;else if(1<l){a=Array(l);for(var c=0;c<l;c++)a[c]=arguments[c+2];n.children=a}return{$$typeof:B,type:e.type,key:i,ref:o,props:n,_owner:s}},d=function(e){return(e={$$typeof:W,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null}).Provider={$$typeof:K,_context:e},e.Consumer=e},f=ea,p=function(e){var t=ea.bind(null,e);return t.type=e,t},g=function(){return{current:null}},m=function(e){return{$$typeof:H,render:e}},E=el,y=function(e){return{$$typeof:z,_payload:{_status:-1,_result:e},_init:ed}},_=function(e,t){return{$$typeof:V,type:e,compare:void 0===t?null:t}},T=function(e){var t=ep.transition;ep.transition={};try{e()}finally{ep.transition=t}},A=function(){throw Error("act(...) is not supported in production builds of React.")},v=function(e,t){return ef.current.useCallback(e,t)},b=function(e){return ef.current.useContext(e)},R=function(){},w=function(e){return ef.current.useDeferredValue(e)},O=function(e,t){return ef.current.useEffect(e,t)},S=function(){return ef.current.useId()},L=function(e,t,r){return ef.current.useImperativeHandle(e,t,r)},k=function(e,t){return ef.current.useInsertionEffect(e,t)},N=function(e,t){return ef.current.useLayoutEffect(e,t)},C=function(e,t){return ef.current.useMemo(e,t)},I=function(e,t,r){return ef.current.useReducer(e,t,r)},x=function(e){return ef.current.useRef(e)},M=function(e){return ef.current.useState(e)},U=function(e,t,r){return ef.current.useSyncExternalStore(e,t,r)},P=function(){return ef.current.useTransition()},D="18.2.0"});let ec=new Set,eu={emit(e,t,r,n){eu.invoke({id:ep(),target:e,sender:t,data:r,player:n})},invoke(e){ec.forEach(t=>t.handle(e))},connect(e){ec.add(e)},disconnect(e){ec.delete(e)}},eh=e=>crypto.getRandomValues(new Uint8Array(e)),ed=(e,t,r)=>{let n=(2<<Math.log(e.length-1)/Math.LN2)-1,i=-~(1.6*n*t/e.length);return (o=t)=>{let s="";for(;;){let t=r(i),a=i;for(;a--;)if((s+=e[t[a]&n]||"").length===o)return s}}},ef=(e,t=21)=>ed(e,t,eh),ep=(e=21)=>crypto.getRandomValues(new Uint8Array(e)).reduce((e,t)=>((t&=63)<36?e+=t.toString(36):t<62?e+=(t-26).toString(36).toUpperCase():t>62?e+="-":e+="_",e),"");function eg(e){let[t,...r]=e.split(":");return{target:t,path:r.join(":")}}function em(e,t,r){let n=ep(),i=e.toLowerCase(),o=t.map(e=>e.toLowerCase()),s={id:()=>n,name:()=>e,tags:()=>t,emit(e,t,r){eu.emit(e,n,t,r)},reply(e,t,r,n){s.emit(`${e.sender}:${t}`,r,n)},handle(e){let{target:t,path:s}=eg(e.target),a=t.toLowerCase();-1!==o.findIndex(e=>"all"===e||e===a)&&r(e),(n===t||"all"===a||i===a)&&r({...e,target:s})}};return eu.connect(s),s}var eE={};eE={lowercase:ea("icQeI"),uppercase:ea("cTQZk"),numbers:ea("7eCpL"),nolookalikes:ea("8vhtC"),nolookalikesSafe:ea("9rJTA"),alphanumeric:ea("h7ahP")};var ey={};ey="@player\n\n' create content\n#book temp create\n\n' load content in edit frame\n#frame temp edit title\n\n' setup ui\n#gadget right 20\n \n $white   - - - - -\n $black$ongrey    ZED.CAFE    \n $white    - - - - -\n \n!hotkey plot space \" Space \";Plot\n!hotkey draw tab \"  Tab  \";Draw\n \n!hotkey menu_test m  ;Menu Test\n\n' main loop\n#cycle 1\n#set blink\n#set drawing white\n#set playermove idle\n\n:main\n#give blink\n\n#if blink < 19 do\n  #char 22\n  #color drawing\n#else if blink < 25 do\n  #char 219\n#else do\n  #clear blink\n#endif\n\n#if inputmove do\n  #set playermove inputmove\n  #if inputalt do\n    #if drawing is blue do\n      #repeat 10 do\n        ?playermove\n        #put edit idle pick wall wall2\n      #endrepeat\n    #else do\n      ?10 playermove\n    #endif\n  #else do \n    ?playermove\n    #if drawing is blue put edit idle pick wall wall2\n  #endif\n#else do\n  #idle\n#endif\n\n#main\n\n:plot\n#put edit idle pick wall wall2\n#main\n\n:draw\n#if drawing is white do\n  #set drawing blue\n  #put edit idle pick wall wall2\n#else do\n  #set drawing white\n#endif\n#main\n\n:menu_test\n$3 Here is some test text and yeah! $3\n----------------------------------\n!number          frank1 100         ;Number Value \n!rn              frank2             ;Slider \n!select          frank3 A BB CC 333 ;Enum \n!text            frank4             ;Text Value \n\n#idle\n#main\n";var e_={};function eT(e,t){return Array(e).fill(t)}e_="@spin\n#cycle pick range 1 10\n#color pick red white blue yellow dkblue dkred dkgreen\n:think\n#char pick range 1 22\n\n?u\n#if rnd ?u\n#put edit idle pick dirt dirt2\n\n?r\n#if rnd ?r\n#put edit idle pick dirt dirt2\n\n?d\n#if rnd ?d\n#put edit idle pick dirt dirt2\n\n?l\n#if rnd ?l\n#put edit idle pick dirt dirt2\n\n#think\n",(r=U||(U={}))[r.BLANK=0]="BLANK",r[r.TILES=1]="TILES",r[r.SPRITES=2]="SPRITES",r[r.DITHER=3]="DITHER",r[r.MEDIA=4]="MEDIA",r[r.CONTROL=5]="CONTROL",(n=P||(P={}))[n.START=0]="START",n[n.LEFT=1]="LEFT",n[n.RIGHT=2]="RIGHT",n[n.TOP=3]="TOP",n[n.BOTTOM=4]="BOTTOM",n[n.SCROLL=5]="SCROLL";let eA={start:0,left:1,right:2,top:3,bottom:4,scroll:5},ev={0:1,1:20,2:20,3:1,4:1,5:40};(i=D||(D={}))[i.NONE=0]="NONE",i[i.MOVE_UP=1]="MOVE_UP",i[i.MOVE_DOWN=2]="MOVE_DOWN",i[i.MOVE_LEFT=3]="MOVE_LEFT",i[i.MOVE_RIGHT=4]="MOVE_RIGHT",i[i.OK_BUTTON=5]="OK_BUTTON",i[i.CANCEL_BUTTON=6]="CANCEL_BUTTON",i[i.MENU_BUTTON=7]="MENU_BUTTON";let eb=ei(function(){return e.importState=function(t){var r=new e;return r.importState(t),r},e;function e(){return function(e){var t,r,n=0,i=0,o=0,s=1;0==e.length&&(e=[+new Date]);var a=(t=4022871197,(r=function(e){e=e.toString();for(var r=0;r<e.length;r++){var n=.02519603282416938*(t+=e.charCodeAt(r));t=n>>>0,n-=t,n*=t,t=n>>>0,n-=t,t+=4294967296*n}return(t>>>0)*23283064365386963e-26}).version="Mash 0.9",r);n=a(" "),i=a(" "),o=a(" ");for(var l=0;l<e.length;l++)(n-=a(e[l]))<0&&(n+=1),(i-=a(e[l]))<0&&(i+=1),(o-=a(e[l]))<0&&(o+=1);a=null;var c=function(){var e=2091639*n+23283064365386963e-26*s;return n=i,i=o,o=e-(s=0|e)};return c.next=c,c.uint32=function(){return 4294967296*c()},c.fract53=function(){return c()+(2097152*c()|0)*11102230246251565e-32},c.version="Alea 0.9",c.args=e,c.exportState=function(){return[n,i,o,s]},c.importState=function(e){n=+e[0]||0,i=+e[1]||0,o=+e[2]||0,s=+e[3]||0},c}(Array.prototype.slice.call(arguments))}}())("089fad0j9awfem09wavefc09uwaef");function eR(e,t,r){return Math.max(t,Math.min(r,e))}function ew(e,t){let r=Math.min(e,t);return r+Math.floor(eb()*(Math.max(e,t)-r+1))}/*!
 * https://github.com/Starcounter-Jack/JSON-Patch
 * (c) 2017-2022 Joachim Wester
 * MIT licensed
 */var eO=(o=function(e,t){return(o=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),eS=Object.prototype.hasOwnProperty;function eL(e,t){return eS.call(e,t)}function ek(e){if(Array.isArray(e)){for(var t=Array(e.length),r=0;r<t.length;r++)t[r]=""+r;return t}if(Object.keys)return Object.keys(e);var n=[];for(var i in e)eL(e,i)&&n.push(i);return n}function eN(e){switch(typeof e){case"object":return JSON.parse(JSON.stringify(e));case"undefined":return null;default:return e}}function eC(e){for(var t,r=0,n=e.length;r<n;){if((t=e.charCodeAt(r))>=48&&t<=57){r++;continue}return!1}return!0}function eI(e){return -1===e.indexOf("/")&&-1===e.indexOf("~")?e:e.replace(/~/g,"~0").replace(/\//g,"~1")}function ex(e){return e.replace(/~1/g,"/").replace(/~0/g,"~")}function eM(e,t){var r=[e];for(var n in t){var i="object"==typeof t[n]?JSON.stringify(t[n],null,2):t[n];void 0!==i&&r.push(n+": "+i)}return r.join("\n")}var eU=function(e){function t(t,r,n,i,o){var s=this.constructor,a=e.call(this,eM(t,{name:r,index:n,operation:i,tree:o}))||this;return a.name=r,a.index=n,a.operation=i,a.tree=o,Object.setPrototypeOf(a,s.prototype),a.message=eM(t,{name:r,index:n,operation:i,tree:o}),a}return eO(t,e),t}(Error),eP={add:function(e,t,r){return e[t]=this.value,{newDocument:r}},remove:function(e,t,r){var n=e[t];return delete e[t],{newDocument:r,removed:n}},replace:function(e,t,r){var n=e[t];return e[t]=this.value,{newDocument:r,removed:n}},move:function(e,t,r){var n=eB(r,this.path);n&&(n=eN(n));var i=eF(r,{op:"remove",path:this.from}).removed;return eF(r,{op:"add",path:this.path,value:i}),{newDocument:r,removed:n}},copy:function(e,t,r){var n=eB(r,this.from);return eF(r,{op:"add",path:this.path,value:eN(n)}),{newDocument:r}},test:function(e,t,r){return{newDocument:r,test:e$(e[t],this.value)}},_get:function(e,t,r){return this.value=e[t],{newDocument:r}}},eD={add:function(e,t,r){return eC(t)?e.splice(t,0,this.value):e[t]=this.value,{newDocument:r,index:t}},remove:function(e,t,r){return{newDocument:r,removed:e.splice(t,1)[0]}},replace:function(e,t,r){var n=e[t];return e[t]=this.value,{newDocument:r,removed:n}},move:eP.move,copy:eP.copy,test:eP.test,_get:eP._get};function eB(e,t){if(""==t)return e;var r={op:"_get",path:t};return eF(e,r),r.value}function eF(e,t,r,n,i,o){if(void 0===r&&(r=!1),void 0===n&&(n=!0),void 0===i&&(i=!0),void 0===o&&(o=0),r&&("function"==typeof r?r(t,0,e,t.path):ej(t,0)),""===t.path){var s={newDocument:e};if("add"===t.op)return s.newDocument=t.value,s;if("replace"===t.op)return s.newDocument=t.value,s.removed=e,s;if("move"===t.op||"copy"===t.op)return s.newDocument=eB(e,t.from),"move"===t.op&&(s.removed=e),s;if("test"===t.op){if(s.test=e$(e,t.value),!1===s.test)throw new eU("Test operation failed","TEST_OPERATION_FAILED",o,t,e);return s.newDocument=e,s}else{if("remove"===t.op)return s.removed=e,s.newDocument=null,s;if("_get"===t.op)return t.value=e,s;if(!r)return s;throw new eU("Operation `op` property is not one of operations defined in RFC-6902","OPERATION_OP_INVALID",o,t,e)}}n||(e=eN(e));var a=(t.path||"").split("/"),l=e,c=1,u=a.length,h=void 0,d=void 0,f=void 0;for(f="function"==typeof r?r:ej;;){if((d=a[c])&&-1!=d.indexOf("~")&&(d=ex(d)),i&&("__proto__"==d||"prototype"==d&&c>0&&"constructor"==a[c-1]))throw TypeError("JSON-Patch: modifying `__proto__` or `constructor/prototype` prop is banned for security reasons, if this was on purpose, please set `banPrototypeModifications` flag false and pass it to this function. More info in fast-json-patch README");if(r&&void 0===h&&(void 0===l[d]?h=a.slice(0,c).join("/"):c==u-1&&(h=t.path),void 0!==h&&f(t,0,e,h)),c++,Array.isArray(l)){if("-"===d)d=l.length;else{if(r&&!eC(d))throw new eU("Expected an unsigned base-10 integer value, making the new referenced value the array element with the zero-based index","OPERATION_PATH_ILLEGAL_ARRAY_INDEX",o,t,e);eC(d)&&(d=~~d)}if(c>=u){if(r&&"add"===t.op&&d>l.length)throw new eU("The specified index MUST NOT be greater than the number of elements in the array","OPERATION_VALUE_OUT_OF_BOUNDS",o,t,e);var s=eD[t.op].call(t,l,d,e);if(!1===s.test)throw new eU("Test operation failed","TEST_OPERATION_FAILED",o,t,e);return s}}else if(c>=u){var s=eP[t.op].call(t,l,d,e);if(!1===s.test)throw new eU("Test operation failed","TEST_OPERATION_FAILED",o,t,e);return s}if(l=l[d],r&&c<u&&(!l||"object"!=typeof l))throw new eU("Cannot perform operation at the desired path","OPERATION_PATH_UNRESOLVABLE",o,t,e)}}function ej(e,t,r,n){if("object"!=typeof e||null===e||Array.isArray(e))throw new eU("Operation is not an object","OPERATION_NOT_AN_OBJECT",t,e,r);if(eP[e.op]){if("string"!=typeof e.path)throw new eU("Operation `path` property is not a string","OPERATION_PATH_INVALID",t,e,r);if(0!==e.path.indexOf("/")&&e.path.length>0)throw new eU('Operation `path` property must start with "/"',"OPERATION_PATH_INVALID",t,e,r);if(("move"===e.op||"copy"===e.op)&&"string"!=typeof e.from)throw new eU("Operation `from` property is not present (applicable in `move` and `copy` operations)","OPERATION_FROM_REQUIRED",t,e,r);else if(("add"===e.op||"replace"===e.op||"test"===e.op)&&void 0===e.value)throw new eU("Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)","OPERATION_VALUE_REQUIRED",t,e,r);else if(("add"===e.op||"replace"===e.op||"test"===e.op)&&function e(t){if(void 0===t)return!0;if(t){if(Array.isArray(t)){for(var r=0,n=t.length;r<n;r++)if(e(t[r]))return!0}else if("object"==typeof t){for(var i=ek(t),o=i.length,s=0;s<o;s++)if(e(t[i[s]]))return!0}}return!1}(e.value))throw new eU("Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)","OPERATION_VALUE_CANNOT_CONTAIN_UNDEFINED",t,e,r);else if(r){if("add"==e.op){var i=e.path.split("/").length,o=n.split("/").length;if(i!==o+1&&i!==o)throw new eU("Cannot perform an `add` operation at the desired path","OPERATION_PATH_CANNOT_ADD",t,e,r)}else if("replace"===e.op||"remove"===e.op||"_get"===e.op){if(e.path!==n)throw new eU("Cannot perform the operation at a path that does not exist","OPERATION_PATH_UNRESOLVABLE",t,e,r)}else if("move"===e.op||"copy"===e.op){var s=function(e,t,r){try{if(!Array.isArray(e))throw new eU("Patch sequence must be an array","SEQUENCE_NOT_AN_ARRAY");if(t)!function(e,t,r,n,i){if(void 0===n&&(n=!0),void 0===i&&(i=!0),r&&!Array.isArray(t))throw new eU("Patch sequence must be an array","SEQUENCE_NOT_AN_ARRAY");n||(e=eN(e));for(var o=Array(t.length),s=0,a=t.length;s<a;s++)o[s]=eF(e,t[s],r,!0,i,s),e=o[s].newDocument;o.newDocument=e}(eN(t),eN(e),r||!0);else{r=r||ej;for(var n=0;n<e.length;n++)r(e[n],n,t,void 0)}}catch(e){if(e instanceof eU)return e;throw e}}([{op:"_get",path:e.from,value:void 0}],r);if(s&&"OPERATION_PATH_UNRESOLVABLE"===s.name)throw new eU("Cannot perform the operation from a path that does not exist","OPERATION_FROM_UNRESOLVABLE",t,e,r)}}}else throw new eU("Operation `op` property is not one of operations defined in RFC-6902","OPERATION_OP_INVALID",t,e,r)}function e$(e,t){if(e===t)return!0;if(e&&t&&"object"==typeof e&&"object"==typeof t){var r,n,i,o=Array.isArray(e),s=Array.isArray(t);if(o&&s){if((n=e.length)!=t.length)return!1;for(r=n;0!=r--;)if(!e$(e[r],t[r]))return!1;return!0}if(o!=s)return!1;var a=Object.keys(e);if((n=a.length)!==Object.keys(t).length)return!1;for(r=n;0!=r--;)if(!t.hasOwnProperty(a[r]))return!1;for(r=n;0!=r--;)if(!e$(e[i=a[r]],t[i]))return!1;return!0}return e!=e&&t!=t}function eG(e,t,r){void 0===r&&(r=!1);var n=[];return!function e(t,r,n,i,o){if(r!==t){"function"==typeof r.toJSON&&(r=r.toJSON());for(var s=ek(r),a=ek(t),l=!1,c=a.length-1;c>=0;c--){var u=a[c],h=t[u];if(eL(r,u)&&!(void 0===r[u]&&void 0!==h&&!1===Array.isArray(r))){var d=r[u];"object"==typeof h&&null!=h&&"object"==typeof d&&null!=d&&Array.isArray(h)===Array.isArray(d)?e(h,d,n,i+"/"+eI(u),o):h!==d&&(o&&n.push({op:"test",path:i+"/"+eI(u),value:eN(h)}),n.push({op:"replace",path:i+"/"+eI(u),value:eN(d)}))}else Array.isArray(t)===Array.isArray(r)?(o&&n.push({op:"test",path:i+"/"+eI(u),value:eN(h)}),n.push({op:"remove",path:i+"/"+eI(u)}),l=!0):(o&&n.push({op:"test",path:i,value:t}),n.push({op:"replace",path:i,value:r}))}if(l||s.length!=a.length)for(var c=0;c<s.length;c++){var u=s[c];eL(t,u)||void 0===r[u]||n.push({op:"add",path:i+"/"+eI(u),value:eN(r[u])})}}}(e,t,n,"",r),n}function eK(e){return void 0!==e}function eW(e){return null!=e}function eH(e){return"number"==typeof e}function eY(e){return"string"==typeof e}function eV(e){return"string"==typeof e||void 0===e}function ez(e){return Array.isArray(e)}function eq(e){return e}function eJ(e,t,r){"number"!=typeof e&&(e=0,t=0,r=1),"number"!=typeof t&&(t=e,e=0,r=1),"number"!=typeof r&&(r=1);let n=[],i=Math.min(e,t),o=Math.max(e,t);for(let e=i;e<=o;e+=r)n.push(e);return n}function eX(...e){var t;return(t=e.flat())[ew(0,t.length-1)]}new WeakMap,Object.assign({},$80aab5273334bb7a$import$5ecbb526cd5c0bbc,$80aab5273334bb7a$import$4f1f131d5e9c7574,{JsonPatchError:eU,deepClone:eN,escapePathComponent:eI,unescapePathComponent:ex}),Symbol();let eQ=Symbol(),eZ=Object.getPrototypeOf,e0=new WeakMap,e1=e=>e&&(e0.has(e)?e0.get(e):eZ(e)===Object.prototype||eZ(e)===Array.prototype),e2=e=>e1(e)&&e[eQ]||null,e6=(e,t=!0)=>{e0.set(e,t)};var e8=Object.assign(Object.create(null),{url:"file:///node_modules/valtio/esm/vanilla.mjs"});let e3=e=>"object"==typeof e&&null!==e,e5=new WeakMap,e4=new WeakSet,[e7]=((e=Object.is,t=(e,t)=>new Proxy(e,t),r=e=>e3(e)&&!e4.has(e)&&(Array.isArray(e)||!(Symbol.iterator in e))&&!(e instanceof WeakMap)&&!(e instanceof WeakSet)&&!(e instanceof Error)&&!(e instanceof Number)&&!(e instanceof Date)&&!(e instanceof String)&&!(e instanceof RegExp)&&!(e instanceof ArrayBuffer),n=e=>{switch(e.status){case"fulfilled":return e.value;case"rejected":throw e.reason;default:throw e}},i=new WeakMap,o=(e,t,r=n)=>{let s=i.get(e);if((null==s?void 0:s[0])===t)return s[1];let a=Array.isArray(e)?[]:Object.create(Object.getPrototypeOf(e));return e6(a,!0),i.set(e,[t,a]),Reflect.ownKeys(e).forEach(t=>{if(Object.getOwnPropertyDescriptor(a,t))return;let n=Reflect.get(e,t),{enumerable:i}=Reflect.getOwnPropertyDescriptor(e,t),s={value:n,enumerable:i,configurable:!0};if(e4.has(n))e6(n,!1);else if(n instanceof Promise)delete s.value,s.get=()=>r(n);else if(e5.has(n)){let[e,t]=e5.get(n);s.value=o(e,t(),r)}Object.defineProperty(a,t,s)}),Object.preventExtensions(a)},s=new WeakMap,a=[1,1],l=n=>{if(!e3(n))throw Error("object required");let i=s.get(n);if(i)return i;let c=a[0],u=new Set,h=(e,t=++a[0])=>{c!==t&&(c=t,u.forEach(r=>r(e,t)))},d=a[1],f=(e=++a[1])=>(d===e||u.size||(d=e,g.forEach(([t])=>{let r=t[1](e);r>c&&(c=r)})),c),p=e=>(t,r)=>{let n=[...t];n[1]=[e,...n[1]],h(n,r)},g=new Map,m=(e,t)=>{if((e8.env?e8.env.MODE:void 0)!=="production"&&g.has(e))throw Error("prop listener already exists");if(u.size){let r=t[3](p(e));g.set(e,[t,r])}else g.set(e,[t])},E=e=>{var t;let r=g.get(e);r&&(g.delete(e),null==(t=r[1])||t.call(r))},y=e=>{u.add(e),1===u.size&&g.forEach(([e,t],r)=>{if((e8.env?e8.env.MODE:void 0)!=="production"&&t)throw Error("remove already exists");let n=e[3](p(r));g.set(r,[e,n])});let t=()=>{u.delete(e),0===u.size&&g.forEach(([e,t],r)=>{t&&(t(),g.set(r,[e]))})};return t},_=Array.isArray(n)?[]:Object.create(Object.getPrototypeOf(n)),T={deleteProperty(e,t){let r=Reflect.get(e,t);E(t);let n=Reflect.deleteProperty(e,t);return n&&h(["delete",[t],r]),n},set(t,n,i,o){let a=Reflect.has(t,n),c=Reflect.get(t,n,o);if(a&&(e(c,i)||s.has(i)&&e(c,s.get(i))))return!0;E(n),e3(i)&&(i=e2(i)||i);let u=i;if(i instanceof Promise)i.then(e=>{i.status="fulfilled",i.value=e,h(["resolve",[n],e])}).catch(e=>{i.status="rejected",i.reason=e,h(["reject",[n],e])});else{!e5.has(i)&&r(i)&&(u=l(i));let e=!e4.has(u)&&e5.get(u);e&&m(n,e)}return Reflect.set(t,n,u,o),h(["set",[n],i,c]),!0}},A=t(_,T);s.set(n,A);let v=[_,f,o,y];return e5.set(A,v),Reflect.ownKeys(n).forEach(e=>{let t=Object.getOwnPropertyDescriptor(n,e);"value"in t&&(A[e]=n[e],delete t.value,delete t.writable),Object.defineProperty(_,e,t)}),A})=>[l,e5,e4,e,t,r,n,i,o,s,a])();var e9=function(e,t){return e===t||e!=e&&t!=t},te=function(e,t){for(var r=e.length;r--;)if(e9(e[r][0],t))return r;return -1},tt=Array.prototype.splice;function tr(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}tr.prototype.clear=function(){this.__data__=[],this.size=0},tr.prototype.delete=function(e){var t=this.__data__,r=te(t,e);return!(r<0)&&(r==t.length-1?t.pop():tt.call(t,r,1),--this.size,!0)},tr.prototype.get=function(e){var t=this.__data__,r=te(t,e);return r<0?void 0:t[r][1]},tr.prototype.has=function(e){return te(this.__data__,e)>-1},tr.prototype.set=function(e,t){var r=this.__data__,n=te(r,e);return n<0?(++this.size,r.push([e,t])):r[n][1]=t,this};var tn=ea("80qH2"),ti=tn.default.Symbol,to=Object.prototype,ts=to.hasOwnProperty,ta=to.toString,tl=ti?ti.toStringTag:void 0,tc=function(e){var t=ts.call(e,tl),r=e[tl];try{e[tl]=void 0;var n=!0}catch(e){}var i=ta.call(e);return n&&(t?e[tl]=r:delete e[tl]),i},tu=Object.prototype.toString,th=ti?ti.toStringTag:void 0,td=function(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":th&&th in Object(e)?tc(e):tu.call(e)},tf=function(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)},tp=function(e){if(!tf(e))return!1;var t=td(e);return"[object Function]"==t||"[object GeneratorFunction]"==t||"[object AsyncFunction]"==t||"[object Proxy]"==t},tn=ea("80qH2"),tg=tn.default["__core-js_shared__"],tm=(s=/[^.]+$/.exec(tg&&tg.keys&&tg.keys.IE_PROTO||""))?"Symbol(src)_1."+s:"",tE=Function.prototype.toString,ty=function(e){if(null!=e){try{return tE.call(e)}catch(e){}try{return e+""}catch(e){}}return""},t_=/^\[object .+?Constructor\]$/,tT=Object.prototype,tA=Function.prototype.toString,tv=tT.hasOwnProperty,tb=RegExp("^"+tA.call(tv).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),tR=function(e,t){var r,n=null==e?void 0:e[t];return tf(r=n)&&(!tm||!(tm in r))&&(tp(r)?tb:t_).test(ty(r))?n:void 0},tn=ea("80qH2"),tw=tR(tn.default,"Map"),tO=tR(Object,"create"),tS=Object.prototype.hasOwnProperty,tL=Object.prototype.hasOwnProperty;function tk(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}tk.prototype.clear=function(){this.__data__=tO?tO(null):{},this.size=0},tk.prototype.delete=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t},tk.prototype.get=function(e){var t=this.__data__;if(tO){var r=t[e];return"__lodash_hash_undefined__"===r?void 0:r}return tS.call(t,e)?t[e]:void 0},tk.prototype.has=function(e){var t=this.__data__;return tO?void 0!==t[e]:tL.call(t,e)},tk.prototype.set=function(e,t){var r=this.__data__;return this.size+=this.has(e)?0:1,r[e]=tO&&void 0===t?"__lodash_hash_undefined__":t,this};var tN=function(e){var t=typeof e;return"string"==t||"number"==t||"symbol"==t||"boolean"==t?"__proto__"!==e:null===e},tC=function(e,t){var r=e.__data__;return tN(t)?r["string"==typeof t?"string":"hash"]:r.map};function tI(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}function tx(e){var t=this.__data__=new tr(e);this.size=t.size}tI.prototype.clear=function(){this.size=0,this.__data__={hash:new tk,map:new(tw||tr),string:new tk}},tI.prototype.delete=function(e){var t=tC(this,e).delete(e);return this.size-=t?1:0,t},tI.prototype.get=function(e){return tC(this,e).get(e)},tI.prototype.has=function(e){return tC(this,e).has(e)},tI.prototype.set=function(e,t){var r=tC(this,e),n=r.size;return r.set(e,t),this.size+=r.size==n?0:1,this},tx.prototype.clear=function(){this.__data__=new tr,this.size=0},tx.prototype.delete=function(e){var t=this.__data__,r=t.delete(e);return this.size=t.size,r},tx.prototype.get=function(e){return this.__data__.get(e)},tx.prototype.has=function(e){return this.__data__.has(e)},tx.prototype.set=function(e,t){var r=this.__data__;if(r instanceof tr){var n=r.__data__;if(!tw||n.length<199)return n.push([e,t]),this.size=++r.size,this;r=this.__data__=new tI(n)}return r.set(e,t),this.size=r.size,this};var tM=function(e,t){for(var r=-1,n=null==e?0:e.length;++r<n&&!1!==t(e[r],r,e););return e},tU=function(){try{var e=tR(Object,"defineProperty");return e({},"",{}),e}catch(e){}}(),tP=function(e,t,r){"__proto__"==t&&tU?tU(e,t,{configurable:!0,enumerable:!0,value:r,writable:!0}):e[t]=r},tD=Object.prototype.hasOwnProperty,tB=function(e,t,r){var n=e[t];tD.call(e,t)&&e9(n,r)&&(void 0!==r||t in e)||tP(e,t,r)},tF=function(e,t,r,n){var i=!r;r||(r={});for(var o=-1,s=t.length;++o<s;){var a=t[o],l=n?n(r[a],e[a],a,r,e):void 0;void 0===l&&(l=e[a]),i?tP(r,a,l):tB(r,a,l)}return r},tj=function(e,t){for(var r=-1,n=Array(e);++r<e;)n[r]=t(r);return n},t$=function(e){return null!=e&&"object"==typeof e},tG=function(e){return t$(e)&&"[object Arguments]"==td(e)},tK=Object.prototype,tW=tK.hasOwnProperty,tH=tK.propertyIsEnumerable,tY=tG(function(){return arguments}())?tG:function(e){return t$(e)&&tW.call(e,"callee")&&!tH.call(e,"callee")},tV=Array.isArray,tz=ea("fsJ5t"),tq=/^(?:0|[1-9]\d*)$/,tJ=function(e,t){var r=typeof e;return!!(t=null==t?9007199254740991:t)&&("number"==r||"symbol"!=r&&tq.test(e))&&e>-1&&e%1==0&&e<t},tX=function(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=9007199254740991},tQ={};tQ["[object Float32Array]"]=tQ["[object Float64Array]"]=tQ["[object Int8Array]"]=tQ["[object Int16Array]"]=tQ["[object Int32Array]"]=tQ["[object Uint8Array]"]=tQ["[object Uint8ClampedArray]"]=tQ["[object Uint16Array]"]=tQ["[object Uint32Array]"]=!0,tQ["[object Arguments]"]=tQ["[object Array]"]=tQ["[object ArrayBuffer]"]=tQ["[object Boolean]"]=tQ["[object DataView]"]=tQ["[object Date]"]=tQ["[object Error]"]=tQ["[object Function]"]=tQ["[object Map]"]=tQ["[object Number]"]=tQ["[object Object]"]=tQ["[object RegExp]"]=tQ["[object Set]"]=tQ["[object String]"]=tQ["[object WeakMap]"]=!1;var tZ=function(e){return function(t){return e(t)}},t0=ea("i3t7k"),t1=t0.default&&t0.default.isTypedArray,t2=t1?tZ(t1):function(e){return t$(e)&&tX(e.length)&&!!tQ[td(e)]},t6=Object.prototype.hasOwnProperty,t8=function(e,t){var r=tV(e),n=!r&&tY(e),i=!r&&!n&&(0,tz.default)(e),o=!r&&!n&&!i&&t2(e),s=r||n||i||o,a=s?tj(e.length,String):[],l=a.length;for(var c in e)(t||t6.call(e,c))&&!(s&&("length"==c||i&&("offset"==c||"parent"==c)||o&&("buffer"==c||"byteLength"==c||"byteOffset"==c)||tJ(c,l)))&&a.push(c);return a},t3=Object.prototype,t5=function(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||t3)},t4=function(e,t){return function(r){return e(t(r))}},t7=t4(Object.keys,Object),t9=Object.prototype.hasOwnProperty,re=function(e){if(!t5(e))return t7(e);var t=[];for(var r in Object(e))t9.call(e,r)&&"constructor"!=r&&t.push(r);return t},rt=function(e){return null!=e&&tX(e.length)&&!tp(e)},rr=function(e){return rt(e)?t8(e):re(e)},rn=function(e){var t=[];if(null!=e)for(var r in Object(e))t.push(r);return t},ri=Object.prototype.hasOwnProperty,ro=function(e){if(!tf(e))return rn(e);var t=t5(e),r=[];for(var n in e)"constructor"==n&&(t||!ri.call(e,n))||r.push(n);return r},rs=function(e){return rt(e)?t8(e,!0):ro(e)},ra=ea("h53Db"),rl=function(e,t){var r=-1,n=e.length;for(t||(t=Array(n));++r<n;)t[r]=e[r];return t},rc=function(e,t){for(var r=-1,n=null==e?0:e.length,i=0,o=[];++r<n;){var s=e[r];t(s,r,e)&&(o[i++]=s)}return o},ru=function(){return[]},rh=Object.prototype.propertyIsEnumerable,rd=Object.getOwnPropertySymbols,rf=rd?function(e){return null==e?[]:rc(rd(e=Object(e)),function(t){return rh.call(e,t)})}:ru,rp=function(e,t){for(var r=-1,n=t.length,i=e.length;++r<n;)e[i+r]=t[r];return e},rg=t4(Object.getPrototypeOf,Object),rm=Object.getOwnPropertySymbols?function(e){for(var t=[];e;)rp(t,rf(e)),e=rg(e);return t}:ru,rE=function(e,t,r){var n=t(e);return tV(e)?n:rp(n,r(e))},ry=function(e){return rE(e,rr,rf)},r_=function(e){return rE(e,rs,rm)},tn=ea("80qH2"),rT=tR(tn.default,"DataView"),tn=ea("80qH2"),rA=tR(tn.default,"Promise"),tn=ea("80qH2"),rv=tR(tn.default,"Set"),tn=ea("80qH2"),rb=tR(tn.default,"WeakMap"),rR="[object Map]",rw="[object Promise]",rO="[object Set]",rS="[object WeakMap]",rL="[object DataView]",rk=ty(rT),rN=ty(tw),rC=ty(rA),rI=ty(rv),rx=ty(rb),rM=td;(rT&&rM(new rT(new ArrayBuffer(1)))!=rL||tw&&rM(new tw)!=rR||rA&&rM(rA.resolve())!=rw||rv&&rM(new rv)!=rO||rb&&rM(new rb)!=rS)&&(rM=function(e){var t=td(e),r="[object Object]"==t?e.constructor:void 0,n=r?ty(r):"";if(n)switch(n){case rk:return rL;case rN:return rR;case rC:return rw;case rI:return rO;case rx:return rS}return t});var rU=rM,rP=Object.prototype.hasOwnProperty,rD=function(e){var t=e.length,r=new e.constructor(t);return t&&"string"==typeof e[0]&&rP.call(e,"index")&&(r.index=e.index,r.input=e.input),r},tn=ea("80qH2"),rB=tn.default.Uint8Array,rF=function(e){var t=new e.constructor(e.byteLength);return new rB(t).set(new rB(e)),t},rj=function(e,t){var r=t?rF(e.buffer):e.buffer;return new e.constructor(r,e.byteOffset,e.byteLength)},r$=/\w*$/,rG=function(e){var t=new e.constructor(e.source,r$.exec(e));return t.lastIndex=e.lastIndex,t},rK=ti?ti.prototype:void 0,rW=rK?rK.valueOf:void 0,rH=function(e,t){var r=t?rF(e.buffer):e.buffer;return new e.constructor(r,e.byteOffset,e.length)},rY=function(e,t,r){var n=e.constructor;switch(t){case"[object ArrayBuffer]":return rF(e);case"[object Boolean]":case"[object Date]":return new n(+e);case"[object DataView]":return rj(e,r);case"[object Float32Array]":case"[object Float64Array]":case"[object Int8Array]":case"[object Int16Array]":case"[object Int32Array]":case"[object Uint8Array]":case"[object Uint8ClampedArray]":case"[object Uint16Array]":case"[object Uint32Array]":return rH(e,r);case"[object Map]":case"[object Set]":return new n;case"[object Number]":case"[object String]":return new n(e);case"[object RegExp]":return rG(e);case"[object Symbol]":return rW?Object(rW.call(e)):{}}},rV=Object.create,rz=function(){function e(){}return function(t){if(!tf(t))return{};if(rV)return rV(t);e.prototype=t;var r=new e;return e.prototype=void 0,r}}(),tz=ea("fsJ5t"),t0=ea("i3t7k"),rq=t0.default&&t0.default.isMap,rJ=rq?tZ(rq):function(e){return t$(e)&&"[object Map]"==rU(e)},t0=ea("i3t7k"),rX=t0.default&&t0.default.isSet,rQ=rX?tZ(rX):function(e){return t$(e)&&"[object Set]"==rU(e)},rZ="[object Arguments]",r0="[object Function]",r1="[object Object]",r2={};r2[rZ]=r2["[object Array]"]=r2["[object ArrayBuffer]"]=r2["[object DataView]"]=r2["[object Boolean]"]=r2["[object Date]"]=r2["[object Float32Array]"]=r2["[object Float64Array]"]=r2["[object Int8Array]"]=r2["[object Int16Array]"]=r2["[object Int32Array]"]=r2["[object Map]"]=r2["[object Number]"]=r2[r1]=r2["[object RegExp]"]=r2["[object Set]"]=r2["[object String]"]=r2["[object Symbol]"]=r2["[object Uint8Array]"]=r2["[object Uint8ClampedArray]"]=r2["[object Uint16Array]"]=r2["[object Uint32Array]"]=!0,r2["[object Error]"]=r2[r0]=r2["[object WeakMap]"]=!1;var r6=function e(t,r,n,i,o,s){var a,l=1&r,c=2&r,u=4&r;if(n&&(a=o?n(t,i,o,s):n(t)),void 0!==a)return a;if(!tf(t))return t;var h=tV(t);if(h){if(a=rD(t),!l)return rl(t,a)}else{var d,f,p,g,m=rU(t),E=m==r0||"[object GeneratorFunction]"==m;if((0,tz.default)(t))return(0,ra.default)(t,l);if(m==r1||m==rZ||E&&!o){if(a=c||E?{}:"function"!=typeof t.constructor||t5(t)?{}:rz(rg(t)),!l)return c?(f=(d=a)&&tF(t,rs(t),d),tF(t,rm(t),f)):(g=(p=a)&&tF(t,rr(t),p),tF(t,rf(t),g))}else{if(!r2[m])return o?t:{};a=rY(t,m,l)}}s||(s=new tx);var y=s.get(t);if(y)return y;s.set(t,a),rQ(t)?t.forEach(function(i){a.add(e(i,r,n,i,t,s))}):rJ(t)&&t.forEach(function(i,o){a.set(o,e(i,r,n,o,t,s))});var _=u?c?r_:ry:c?rs:rr,T=h?void 0:_(t);return tM(T||t,function(i,o){T&&(i=t[o=i]),tB(a,o,e(i,r,n,o,t,s))}),a},r8=function(e){return r6(e,4)},r3=function(e,t,r){for(var n=-1,i=Object(e),o=r(e),s=o.length;s--;){var a=o[++n];if(!1===t(i[a],a,i))break}return e},r5=function(e,t){if(null==e)return e;if(!rt(e))return e&&r3(e,t,rr);for(var r=e.length,n=a?r:-1,i=Object(e);(a?n--:++n<r)&&!1!==t(i[n],n,i););return e},r4=function(e){return e},r7=function(e,t){return(tV(e)?tM:r5)(e,"function"==typeof t?t:r4)},r9=Object.prototype.hasOwnProperty,ne=function(e,t){return null!=e&&r9.call(e,t)},nt=function(e){return"symbol"==typeof e||t$(e)&&"[object Symbol]"==td(e)},nr=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,nn=/^\w*$/,ni=function(e,t){if(tV(e))return!1;var r=typeof e;return!!("number"==r||"symbol"==r||"boolean"==r||null==e||nt(e))||nn.test(e)||!nr.test(e)||null!=t&&e in Object(t)};function no(e,t){if("function"!=typeof e||null!=t&&"function"!=typeof t)throw TypeError("Expected a function");var r=function(){var n=arguments,i=t?t.apply(this,n):n[0],o=r.cache;if(o.has(i))return o.get(i);var s=e.apply(this,n);return r.cache=o.set(i,s)||o,s};return r.cache=new(no.Cache||tI),r}no.Cache=tI;var ns=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,na=/\\(\\)?/g,nl=(c=(l=no(function(e){var t=[];return 46===e.charCodeAt(0)&&t.push(""),e.replace(ns,function(e,r,n,i){t.push(n?i.replace(na,"$1"):r||e)}),t},function(e){return 500===c.size&&c.clear(),e})).cache,l),nc=function(e,t){for(var r=-1,n=null==e?0:e.length,i=Array(n);++r<n;)i[r]=t(e[r],r,e);return i},nu=1/0,nh=ti?ti.prototype:void 0,nd=nh?nh.toString:void 0,nf=function e(t){if("string"==typeof t)return t;if(tV(t))return nc(t,e)+"";if(nt(t))return nd?nd.call(t):"";var r=t+"";return"0"==r&&1/t==-nu?"-0":r},np=function(e,t){return tV(e)?e:ni(e,t)?[e]:nl(null==e?"":nf(e))},ng=1/0,nm=function(e){if("string"==typeof e||nt(e))return e;var t=e+"";return"0"==t&&1/e==-ng?"-0":t},nE=function(e,t,r){t=np(t,e);for(var n=-1,i=t.length,o=!1;++n<i;){var s=nm(t[n]);if(!(o=null!=e&&r(e,s)))break;e=e[s]}return o||++n!=i?o:!!(i=null==e?0:e.length)&&tX(i)&&tJ(s,i)&&(tV(e)||tY(e))},ny=function(e,t){return null!=e&&nE(e,t,ne)},tz=ea("fsJ5t"),n_=Object.prototype.hasOwnProperty,nT=function(e){if(null==e)return!0;if(rt(e)&&(tV(e)||"string"==typeof e||"function"==typeof e.splice||(0,tz.default)(e)||t2(e)||tY(e)))return!e.length;var t=rU(e);if("[object Map]"==t||"[object Set]"==t)return!e.size;if(t5(e))return!re(e).length;for(var r in e)if(n_.call(e,r))return!1;return!0};function nA(e){var t=-1,r=null==e?0:e.length;for(this.__data__=new tI;++t<r;)this.add(e[t])}nA.prototype.add=nA.prototype.push=function(e){return this.__data__.set(e,"__lodash_hash_undefined__"),this},nA.prototype.has=function(e){return this.__data__.has(e)};var nv=function(e,t){for(var r=-1,n=null==e?0:e.length;++r<n;)if(t(e[r],r,e))return!0;return!1},nb=function(e,t){return e.has(t)},nR=function(e,t,r,n,i,o){var s=1&r,a=e.length,l=t.length;if(a!=l&&!(s&&l>a))return!1;var c=o.get(e),u=o.get(t);if(c&&u)return c==t&&u==e;var h=-1,d=!0,f=2&r?new nA:void 0;for(o.set(e,t),o.set(t,e);++h<a;){var p=e[h],g=t[h];if(n)var m=s?n(g,p,h,t,e,o):n(p,g,h,e,t,o);if(void 0!==m){if(m)continue;d=!1;break}if(f){if(!nv(t,function(e,t){if(!nb(f,t)&&(p===e||i(p,e,r,n,o)))return f.push(t)})){d=!1;break}}else if(!(p===g||i(p,g,r,n,o))){d=!1;break}}return o.delete(e),o.delete(t),d},nw=function(e){var t=-1,r=Array(e.size);return e.forEach(function(e,n){r[++t]=[n,e]}),r},nO=function(e){var t=-1,r=Array(e.size);return e.forEach(function(e){r[++t]=e}),r},nS=ti?ti.prototype:void 0,nL=nS?nS.valueOf:void 0,nk=function(e,t,r,n,i,o,s){switch(r){case"[object DataView]":if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)break;e=e.buffer,t=t.buffer;case"[object ArrayBuffer]":if(e.byteLength!=t.byteLength||!o(new rB(e),new rB(t)))break;return!0;case"[object Boolean]":case"[object Date]":case"[object Number]":return e9(+e,+t);case"[object Error]":return e.name==t.name&&e.message==t.message;case"[object RegExp]":case"[object String]":return e==t+"";case"[object Map]":var a=nw;case"[object Set]":var l=1&n;if(a||(a=nO),e.size!=t.size&&!l)break;var c=s.get(e);if(c)return c==t;n|=2,s.set(e,t);var u=nR(a(e),a(t),n,i,o,s);return s.delete(e),u;case"[object Symbol]":if(nL)return nL.call(e)==nL.call(t)}return!1},nN=Object.prototype.hasOwnProperty,nC=function(e,t,r,n,i,o){var s=1&r,a=ry(e),l=a.length;if(l!=ry(t).length&&!s)return!1;for(var c=l;c--;){var u=a[c];if(!(s?u in t:nN.call(t,u)))return!1}var h=o.get(e),d=o.get(t);if(h&&d)return h==t&&d==e;var f=!0;o.set(e,t),o.set(t,e);for(var p=s;++c<l;){var g=e[u=a[c]],m=t[u];if(n)var E=s?n(m,g,u,t,e,o):n(g,m,u,e,t,o);if(!(void 0===E?g===m||i(g,m,r,n,o):E)){f=!1;break}p||(p="constructor"==u)}if(f&&!p){var y=e.constructor,_=t.constructor;y!=_&&"constructor"in e&&"constructor"in t&&!("function"==typeof y&&y instanceof y&&"function"==typeof _&&_ instanceof _)&&(f=!1)}return o.delete(e),o.delete(t),f},tz=ea("fsJ5t"),nI="[object Arguments]",nx="[object Array]",nM="[object Object]",nU=Object.prototype.hasOwnProperty,nP=function(e,t,r,n,i,o){var s=tV(e),a=tV(t),l=s?nx:rU(e),c=a?nx:rU(t);l=l==nI?nM:l,c=c==nI?nM:c;var u=l==nM,h=c==nM,d=l==c;if(d&&(0,tz.default)(e)){if(!(0,tz.default)(t))return!1;s=!0,u=!1}if(d&&!u)return o||(o=new tx),s||t2(e)?nR(e,t,r,n,i,o):nk(e,t,l,r,n,i,o);if(!(1&r)){var f=u&&nU.call(e,"__wrapped__"),p=h&&nU.call(t,"__wrapped__");if(f||p){var g=f?e.value():e,m=p?t.value():t;return o||(o=new tx),i(g,m,r,n,o)}}return!!d&&(o||(o=new tx),nC(e,t,r,n,i,o))},nD=function e(t,r,n,i,o){return t===r||(null!=t&&null!=r&&(t$(t)||t$(r))?nP(t,r,n,i,e,o):t!=t&&r!=r)},nB=function(e,t,r,n){var i=r.length,o=i,s=!n;if(null==e)return!o;for(e=Object(e);i--;){var a=r[i];if(s&&a[2]?a[1]!==e[a[0]]:!(a[0]in e))return!1}for(;++i<o;){var l=(a=r[i])[0],c=e[l],u=a[1];if(s&&a[2]){if(void 0===c&&!(l in e))return!1}else{var h=new tx;if(n)var d=n(c,u,l,e,t,h);if(!(void 0===d?nD(u,c,3,n,h):d))return!1}}return!0},nF=function(e){return e==e&&!tf(e)},nj=function(e){for(var t=rr(e),r=t.length;r--;){var n=t[r],i=e[n];t[r]=[n,i,nF(i)]}return t},n$=function(e,t){return function(r){return null!=r&&r[e]===t&&(void 0!==t||e in Object(r))}},nG=function(e){var t=nj(e);return 1==t.length&&t[0][2]?n$(t[0][0],t[0][1]):function(r){return r===e||nB(r,e,t)}},nK=function(e,t){t=np(t,e);for(var r=0,n=t.length;null!=e&&r<n;)e=e[nm(t[r++])];return r&&r==n?e:void 0},nW=function(e,t,r){var n=null==e?void 0:nK(e,t);return void 0===n?r:n},nH=function(e,t){return null!=e&&t in Object(e)},nY=function(e){var t;return ni(e)?(t=nm(e),function(e){return null==e?void 0:e[t]}):function(t){return nK(t,e)}},nV=function(e){if("function"==typeof e)return e;if(null==e)return r4;if("object"==typeof e){var t,r;return tV(e)?(t=e[0],r=e[1],ni(t)&&nF(r)?n$(nm(t),r):function(e){var n=nW(e,t);return void 0===n&&n===r?null!=e&&nE(e,t,nH):nD(r,n,3)}):nG(e)}return nY(e)},nz=function(e,t){var r=-1,n=rt(e)?Array(e.length):[];return r5(e,function(e,i,o){n[++r]=t(e,i,o)}),n},nq=function(e,t){return(tV(e)?nc:nz)(e,nV(t,3))},nJ=function(e){return null==e?[]:nc(rr(e),function(t){return e[t]})};function nX(e){console&&console.error&&console.error(`Error: ${e}`)}function nQ(e){console&&console.warn&&console.warn(`Warning: ${e}`)}function nZ(e){let t=new Date().getTime(),r=e();return{time:new Date().getTime()-t,value:r}}function n0(e){function t(){}t.prototype=e;let r=new t;function n(){return typeof r.bar}return n(),n(),e}var n1=function(e,t,r){var n=-1,i=e.length;t<0&&(t=-t>i?0:i+t),(r=r>i?i:r)<0&&(r+=i),i=t>r?0:r-t>>>0,t>>>=0;for(var o=Array(i);++n<i;)o[n]=e[n+t];return o},n2=/\s/,n6=function(e){for(var t=e.length;t--&&n2.test(e.charAt(t)););return t},n8=/^\s+/,n3=0/0,n5=/^[-+]0x[0-9a-f]+$/i,n4=/^0b[01]+$/i,n7=/^0o[0-7]+$/i,n9=parseInt,ie=function(e){if("number"==typeof e)return e;if(nt(e))return n3;if(tf(e)){var t,r="function"==typeof e.valueOf?e.valueOf():e;e=tf(r)?r+"":r}if("string"!=typeof e)return 0===e?e:+e;e=(t=e)?t.slice(0,n6(t)+1).replace(n8,""):t;var n=n4.test(e);return n||n7.test(e)?n9(e.slice(2),n?2:8):n5.test(e)?n3:+e},it=1/0,ir=function(e){var t,r=(t=e)?(t=ie(t))===it||t===-it?(t<0?-1:1)*17976931348623157e292:t==t?t:0:0===t?t:0,n=r%1;return r==r?n?r-n:r:0},ii=function(e,t,r){var n=null==e?0:e.length;return n?n1(e,(t=r||void 0===t?1:ir(t))<0?0:t,n):[]},io=function(e,t,r){switch(r.length){case 0:return e.call(t);case 1:return e.call(t,r[0]);case 2:return e.call(t,r[0],r[1]);case 3:return e.call(t,r[0],r[1],r[2])}return e.apply(t,r)},is=Math.max,ia=Date.now,il=(u=tU?function(e,t){return tU(e,"toString",{configurable:!0,enumerable:!1,value:function(){return t},writable:!0})}:r4,h=0,d=0,function(){var e=ia(),t=16-(e-d);if(d=e,t>0){if(++h>=800)return arguments[0]}else h=0;return u.apply(void 0,arguments)}),ic=function(e,t){var r;return il((r=is(void 0===(r=t)?e.length-1:r,0),function(){for(var t=arguments,n=-1,i=is(t.length-r,0),o=Array(i);++n<i;)o[n]=t[r+n];n=-1;for(var s=Array(r+1);++n<r;)s[n]=t[n];return s[r]=r4(o),io(e,this,s)}),e+"")},iu=function(e,t,r){if(!tf(r))return!1;var n=typeof t;return("number"==n?!!(rt(r)&&tJ(t,r.length)):"string"==n&&t in r)&&e9(r[t],e)},ih=Object.prototype.hasOwnProperty,id=(f=function(e,t){if(t5(t)||rt(t)){tF(t,rr(t),e);return}for(var r in t)ih.call(t,r)&&tB(e,r,t[r])},ic(function(e,t){var r=-1,n=t.length,i=n>1?t[n-1]:void 0,o=n>2?t[2]:void 0;for(i=f.length>3&&"function"==typeof i?(n--,i):void 0,o&&iu(t[0],t[1],o)&&(i=n<3?void 0:i,n=1),e=Object(e);++r<n;){var s=t[r];s&&f(e,s,r,i)}return e})),t0=ea("i3t7k"),ip=t0.default&&t0.default.isRegExp,ig=ip?tZ(ip):function(e){return t$(e)&&"[object RegExp]"==td(e)},im=function(e){return"string"==typeof e||!tV(e)&&t$(e)&&"[object String]"==td(e)},iE=function(e,t,r,n){if(!tf(e))return e;t=np(t,e);for(var i=-1,o=t.length,s=o-1,a=e;null!=a&&++i<o;){var l=nm(t[i]),c=r;if("__proto__"===l||"constructor"===l||"prototype"===l)break;if(i!=s){var u=a[l];void 0===(c=n?n(u,l,a):void 0)&&(c=tf(u)?u:tJ(t[i+1])?[]:{})}tB(a,l,c),a=a[l]}return e},iy=function(e,t,r){for(var n=-1,i=t.length,o={};++n<i;){var s=t[n],a=nK(e,s);r(a,s)&&iE(o,np(s,e),a)}return o},i_=function(e,t){if(null==e)return{};var r=nc(r_(e),function(e){return[e]});return t=nV(t),iy(e,r,function(e,r){return t(e,r[0])})};class iT{get definition(){return this._definition}set definition(e){this._definition=e}constructor(e){this._definition=e}accept(e){e.visit(this),r7(this.definition,t=>{t.accept(e)})}}class iA extends iT{constructor(e){super([]),this.idx=1,id(this,i_(e,e=>void 0!==e))}set definition(e){}get definition(){return void 0!==this.referencedRule?this.referencedRule.definition:[]}accept(e){e.visit(this)}}class iv extends iT{constructor(e){super(e.definition),this.orgText="",id(this,i_(e,e=>void 0!==e))}}class ib extends iT{constructor(e){super(e.definition),this.ignoreAmbiguities=!1,id(this,i_(e,e=>void 0!==e))}}class iR extends iT{constructor(e){super(e.definition),this.idx=1,id(this,i_(e,e=>void 0!==e))}}class iw extends iT{constructor(e){super(e.definition),this.idx=1,id(this,i_(e,e=>void 0!==e))}}class iO extends iT{constructor(e){super(e.definition),this.idx=1,id(this,i_(e,e=>void 0!==e))}}class iS extends iT{constructor(e){super(e.definition),this.idx=1,id(this,i_(e,e=>void 0!==e))}}class iL extends iT{constructor(e){super(e.definition),this.idx=1,id(this,i_(e,e=>void 0!==e))}}class ik extends iT{get definition(){return this._definition}set definition(e){this._definition=e}constructor(e){super(e.definition),this.idx=1,this.ignoreAmbiguities=!1,this.hasPredicates=!1,id(this,i_(e,e=>void 0!==e))}}class iN{constructor(e){this.idx=1,id(this,i_(e,e=>void 0!==e))}accept(e){e.visit(this)}}class iC{visit(e){switch(e.constructor){case iA:return this.visitNonTerminal(e);case ib:return this.visitAlternative(e);case iR:return this.visitOption(e);case iw:return this.visitRepetitionMandatory(e);case iO:return this.visitRepetitionMandatoryWithSeparator(e);case iL:return this.visitRepetitionWithSeparator(e);case iS:return this.visitRepetition(e);case ik:return this.visitAlternation(e);case iN:return this.visitTerminal(e);case iv:return this.visitRule(e);default:throw Error("non exhaustive match")}}visitNonTerminal(e){}visitAlternative(e){}visitOption(e){}visitRepetition(e){}visitRepetitionMandatory(e){}visitRepetitionMandatoryWithSeparator(e){}visitRepetitionWithSeparator(e){}visitAlternation(e){}visitTerminal(e){}visitRule(e){}}var iI=function(e,t){for(var r=-1,n=null==e?0:e.length;++r<n;)if(!t(e[r],r,e))return!1;return!0},ix=function(e,t){var r=!0;return r5(e,function(e,n,i){return r=!!t(e,n,i)}),r},iM=function(e,t,r){var n=tV(e)?iI:ix;return r&&iu(e,t,r)&&(t=void 0),n(e,nV(t,3))},iU=function(e,t,r,n){for(var i=e.length,o=r+(n?1:-1);n?o--:++o<i;)if(t(e[o],o,e))return o;return -1},iP=function(e){return e!=e},iD=function(e,t,r){for(var n=r-1,i=e.length;++n<i;)if(e[n]===t)return n;return -1},iB=function(e,t,r){return t==t?iD(e,t,r):iU(e,iP,r)},iF=Math.max,ij=function(e,t,r,n){e=rt(e)?e:nJ(e),r=r&&!n?ir(r):0;var i=e.length;return r<0&&(r=iF(i+r,0)),im(e)?r<=i&&e.indexOf(t,r)>-1:!!i&&iB(e,t,r)>-1},i$=function(e,t){var r;return r5(e,function(e,n,i){return!(r=t(e,n,i))}),!!r},iG=function(e,t,r){var n=tV(e)?nv:i$;return r&&iu(e,t,r)&&(t=void 0),n(e,nV(t,3))};function iK(e,t=[]){return e instanceof iR||e instanceof iS||e instanceof iL||(e instanceof ik?iG(e.definition,e=>iK(e,t)):!(e instanceof iA&&ij(t,e))&&e instanceof iT&&(e instanceof iA&&t.push(e),iM(e.definition,e=>iK(e,t))))}function iW(e){if(e instanceof iA)return"SUBRULE";if(e instanceof iR)return"OPTION";if(e instanceof ik)return"OR";if(e instanceof iw)return"AT_LEAST_ONE";if(e instanceof iO)return"AT_LEAST_ONE_SEP";if(e instanceof iL)return"MANY_SEP";if(e instanceof iS)return"MANY";else if(e instanceof iN)return"CONSUME";else throw Error("non exhaustive match")}class iH{walk(e,t=[]){r7(e.definition,(r,n)=>{let i=ii(e.definition,n+1);if(r instanceof iA)this.walkProdRef(r,i,t);else if(r instanceof iN)this.walkTerminal(r,i,t);else if(r instanceof ib)this.walkFlat(r,i,t);else if(r instanceof iR)this.walkOption(r,i,t);else if(r instanceof iw)this.walkAtLeastOne(r,i,t);else if(r instanceof iO)this.walkAtLeastOneSep(r,i,t);else if(r instanceof iL)this.walkManySep(r,i,t);else if(r instanceof iS)this.walkMany(r,i,t);else if(r instanceof ik)this.walkOr(r,i,t);else throw Error("non exhaustive match")})}walkTerminal(e,t,r){}walkProdRef(e,t,r){}walkFlat(e,t,r){let n=t.concat(r);this.walk(e,n)}walkOption(e,t,r){let n=t.concat(r);this.walk(e,n)}walkAtLeastOne(e,t,r){let n=[new iR({definition:e.definition})].concat(t,r);this.walk(e,n)}walkAtLeastOneSep(e,t,r){let n=iY(e,t,r);this.walk(e,n)}walkMany(e,t,r){let n=[new iR({definition:e.definition})].concat(t,r);this.walk(e,n)}walkManySep(e,t,r){let n=iY(e,t,r);this.walk(e,n)}walkOr(e,t,r){let n=t.concat(r);r7(e.definition,e=>{let t=new ib({definition:[e]});this.walk(t,n)})}}function iY(e,t,r){return[new iR({definition:[new iN({terminalType:e.separator})].concat(e.definition)})].concat(t,r)}var iV=ti?ti.isConcatSpreadable:void 0,iz=function(e){return tV(e)||tY(e)||!!(iV&&e&&e[iV])},iq=function e(t,r,n,i,o){var s=-1,a=t.length;for(n||(n=iz),o||(o=[]);++s<a;){var l=t[s];r>0&&n(l)?r>1?e(l,r-1,n,i,o):rp(o,l):i||(o[o.length]=l)}return o},iJ=function(e){return(null==e?0:e.length)?iq(e,1):[]},iX=function(e,t){return!!(null==e?0:e.length)&&iB(e,t,0)>-1},iQ=function(e,t,r){for(var n=-1,i=null==e?0:e.length;++n<i;)if(r(t,e[n]))return!0;return!1},iZ=function(){},i0=rv&&1/nO(new rv([,-0]))[1]==1/0?function(e){return new rv(e)}:iZ,i1=function(e,t,r){var n=-1,i=iX,o=e.length,s=!0,a=[],l=a;if(r)s=!1,i=iQ;else if(o>=200){var c=t?null:i0(e);if(c)return nO(c);s=!1,i=nb,l=new nA}else l=t?[]:a;e:for(;++n<o;){var u=e[n],h=t?t(u):u;if(u=r||0!==u?u:0,s&&h==h){for(var d=l.length;d--;)if(l[d]===h)continue e;t&&l.push(h),a.push(u)}else i(l,h,r)||(l!==a&&l.push(h),a.push(u))}return a},i2=function(e){return e&&e.length?i1(e):[]};function i6(e){if(e instanceof iA)return i6(e.referencedRule);if(e instanceof iN)return[e.terminalType];if(e instanceof ib||e instanceof iR||e instanceof iS||e instanceof iw||e instanceof iO||e instanceof iL||e instanceof iN||e instanceof iv)return function(e){let t,r=[],n=e.definition,i=0,o=n.length>i,s=!0;for(;o&&s;)s=iK(t=n[i]),r=r.concat(i6(t)),i+=1,o=n.length>i;return i2(r)}(e);if(e instanceof ik)return i2(iJ(nq(e.definition,e=>i6(e))));throw Error("non exhaustive match")}let i8="_~IN~_";class i3 extends iH{constructor(e){super(),this.topProd=e,this.follows={}}startWalking(){return this.walk(this.topProd),this.follows}walkTerminal(e,t,r){}walkProdRef(e,t,r){var n,i;let o=(n=e.referencedRule,i=e.idx,n.name+i+i8+this.topProd.name),s=i6(new ib({definition:t.concat(r)}));this.follows[o]=s}}var i5=function(e){return void 0===e};function i4(e){return e.charCodeAt(0)}function i7(e,t){Array.isArray(e)?e.forEach(function(e){t.push(e)}):t.push(e)}function i9(e,t){if(!0===e[t])throw"duplicate flag "+t;e[t],e[t]=!0}function oe(e){if(void 0===e)throw Error("Internal Error - Should never get here!");return!0}function ot(){throw Error("Internal Error - Should never get here!")}function or(e){return"Character"===e.type}let on=[];for(let e=i4("0");e<=i4("9");e++)on.push(e);let oi=[i4("_")].concat(on);for(let e=i4("a");e<=i4("z");e++)oi.push(e);for(let e=i4("A");e<=i4("Z");e++)oi.push(e);let oo=[i4(" "),i4("\f"),i4("\n"),i4("\r"),i4("	"),i4("\v"),i4("	"),i4(""),i4(""),i4(""),i4(""),i4(""),i4(""),i4(""),i4(""),i4(""),i4(""),i4(""),i4(""),i4(""),i4("\u2028"),i4("\u2029"),i4(""),i4(""),i4(""),i4("\uFEFF")],os=/[0-9a-fA-F]/,oa=/[0-9]/,ol=/[1-9]/;class oc{visitChildren(e){for(let t in e){let r=e[t];e.hasOwnProperty(t)&&(void 0!==r.type?this.visit(r):Array.isArray(r)&&r.forEach(e=>{this.visit(e)},this))}}visit(e){switch(e.type){case"Pattern":this.visitPattern(e);break;case"Flags":this.visitFlags(e);break;case"Disjunction":this.visitDisjunction(e);break;case"Alternative":this.visitAlternative(e);break;case"StartAnchor":this.visitStartAnchor(e);break;case"EndAnchor":this.visitEndAnchor(e);break;case"WordBoundary":this.visitWordBoundary(e);break;case"NonWordBoundary":this.visitNonWordBoundary(e);break;case"Lookahead":this.visitLookahead(e);break;case"NegativeLookahead":this.visitNegativeLookahead(e);break;case"Character":this.visitCharacter(e);break;case"Set":this.visitSet(e);break;case"Group":this.visitGroup(e);break;case"GroupBackReference":this.visitGroupBackReference(e);break;case"Quantifier":this.visitQuantifier(e)}this.visitChildren(e)}visitPattern(e){}visitFlags(e){}visitDisjunction(e){}visitAlternative(e){}visitStartAnchor(e){}visitEndAnchor(e){}visitWordBoundary(e){}visitNonWordBoundary(e){}visitLookahead(e){}visitNegativeLookahead(e){}visitCharacter(e){}visitSet(e){}visitGroup(e){}visitGroupBackReference(e){}visitQuantifier(e){}}var ou=function(e){for(var t=-1,r=null==e?0:e.length,n=0,i=[];++t<r;){var o=e[t];o&&(i[n++]=o)}return i},oh=Object.prototype,od=oh.hasOwnProperty,of=ic(function(e,t){e=Object(e);var r=-1,n=t.length,i=n>2?t[2]:void 0;for(i&&iu(t[0],t[1],i)&&(n=1);++r<n;)for(var o=t[r],s=rs(o),a=-1,l=s.length;++a<l;){var c=s[a],u=e[c];(void 0===u||e9(u,oh[c])&&!od.call(e,c))&&(e[c]=o[c])}return e}),op=function(e,t,r,n){var i=-1,o=iX,s=!0,a=e.length,l=[],c=t.length;if(!a)return l;r&&(t=nc(t,tZ(r))),n?(o=iQ,s=!1):t.length>=200&&(o=nb,s=!1,t=new nA(t));e:for(;++i<a;){var u=e[i],h=null==r?u:r(u);if(u=n||0!==u?u:0,s&&h==h){for(var d=c;d--;)if(t[d]===h)continue e;l.push(u)}else o(t,h,n)||l.push(u)}return l},og=function(e){return t$(e)&&rt(e)},om=ic(function(e,t){return og(e)?op(e,iq(t,1,og,!0)):[]}),oE=function(e,t){var r=[];return r5(e,function(e,n,i){t(e,n,i)&&r.push(e)}),r},oy=function(e,t){return(tV(e)?rc:oE)(e,nV(t,3))},o_=Math.max,oT=(p=function(e,t,r){var n=null==e?0:e.length;if(!n)return -1;var i=null==r?0:ir(r);return i<0&&(i=o_(n+i,0)),iU(e,nV(t,3),i)},function(e,t,r){var n=Object(e);if(!rt(e)){var i=nV(t,3);e=rr(e),t=function(e){return i(n[e],e,n)}}var o=p(e,t,r);return o>-1?n[i?e[o]:o]:void 0}),oA=function(e){return e&&e.length?e[0]:void 0},ov=Math.max,ob=function(e,t,r){var n=null==e?0:e.length;if(!n)return -1;var i=null==r?0:ir(r);return i<0&&(i=ov(n+i,0)),iB(e,t,i)},oR=function(e,t,r,n){var i=-1,o=null==e?0:e.length;for(n&&o&&(r=e[++i]);++i<o;)r=t(r,e[i],i,e);return r},ow=function(e,t,r,n,i){return i(e,function(e,i,o){r=n?(n=!1,e):t(r,e,i,o)}),r},oO=function(e,t,r){var n=tV(e)?oR:ow,i=arguments.length<3;return n(e,nV(t,4),r,i,r5)},oS=function(e){if("function"!=typeof e)throw TypeError("Expected a function");return function(){var t=arguments;switch(t.length){case 0:return!e.call(this);case 1:return!e.call(this,t[0]);case 2:return!e.call(this,t[0],t[1]);case 3:return!e.call(this,t[0],t[1],t[2])}return!e.apply(this,t)}},oL=function(e,t){return(tV(e)?rc:oE)(e,oS(nV(t,3)))};let ok={},oN=new class{constructor(){this.idx=0,this.input="",this.groupIdx=0}saveState(){return{idx:this.idx,input:this.input,groupIdx:this.groupIdx}}restoreState(e){this.idx=e.idx,this.input=e.input,this.groupIdx=e.groupIdx}pattern(e){this.idx=0,this.input=e,this.groupIdx=0,this.consumeChar("/");let t=this.disjunction();this.consumeChar("/");let r={type:"Flags",loc:{begin:this.idx,end:e.length},global:!1,ignoreCase:!1,multiLine:!1,unicode:!1,sticky:!1};for(;this.isRegExpFlag();)switch(this.popChar()){case"g":i9(r,"global");break;case"i":i9(r,"ignoreCase");break;case"m":i9(r,"multiLine");break;case"u":i9(r,"unicode");break;case"y":i9(r,"sticky")}if(this.idx!==this.input.length)throw Error("Redundant input: "+this.input.substring(this.idx));return{type:"Pattern",flags:r,value:t,loc:this.loc(0)}}disjunction(){let e=[],t=this.idx;for(e.push(this.alternative());"|"===this.peekChar();)this.consumeChar("|"),e.push(this.alternative());return{type:"Disjunction",value:e,loc:this.loc(t)}}alternative(){let e=[],t=this.idx;for(;this.isTerm();)e.push(this.term());return{type:"Alternative",value:e,loc:this.loc(t)}}term(){return this.isAssertion()?this.assertion():this.atom()}assertion(){let e=this.idx;switch(this.popChar()){case"^":return{type:"StartAnchor",loc:this.loc(e)};case"$":return{type:"EndAnchor",loc:this.loc(e)};case"\\":switch(this.popChar()){case"b":return{type:"WordBoundary",loc:this.loc(e)};case"B":return{type:"NonWordBoundary",loc:this.loc(e)}}throw Error("Invalid Assertion Escape");case"(":let t;switch(this.consumeChar("?"),this.popChar()){case"=":t="Lookahead";break;case"!":t="NegativeLookahead"}oe(t);let r=this.disjunction();return this.consumeChar(")"),{type:t,value:r,loc:this.loc(e)}}return ot()}quantifier(e=!1){let t;let r=this.idx;switch(this.popChar()){case"*":t={atLeast:0,atMost:1/0};break;case"+":t={atLeast:1,atMost:1/0};break;case"?":t={atLeast:0,atMost:1};break;case"{":let n=this.integerIncludingZero();switch(this.popChar()){case"}":t={atLeast:n,atMost:n};break;case",":t=this.isDigit()?{atLeast:n,atMost:this.integerIncludingZero()}:{atLeast:n,atMost:1/0},this.consumeChar("}")}if(!0===e&&void 0===t)return;oe(t)}if((!0!==e||void 0!==t)&&oe(t))return"?"===this.peekChar(0)?(this.consumeChar("?"),t.greedy=!1):t.greedy=!0,t.type="Quantifier",t.loc=this.loc(r),t}atom(){let e;let t=this.idx;switch(this.peekChar()){case".":e=this.dotAll();break;case"\\":e=this.atomEscape();break;case"[":e=this.characterClass();break;case"(":e=this.group()}return(void 0===e&&this.isPatternCharacter()&&(e=this.patternCharacter()),oe(e))?(e.loc=this.loc(t),this.isQuantifier()&&(e.quantifier=this.quantifier()),e):ot()}dotAll(){return this.consumeChar("."),{type:"Set",complement:!0,value:[i4("\n"),i4("\r"),i4("\u2028"),i4("\u2029")]}}atomEscape(){switch(this.consumeChar("\\"),this.peekChar()){case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":return this.decimalEscapeAtom();case"d":case"D":case"s":case"S":case"w":case"W":return this.characterClassEscape();case"f":case"n":case"r":case"t":case"v":return this.controlEscapeAtom();case"c":return this.controlLetterEscapeAtom();case"0":return this.nulCharacterAtom();case"x":return this.hexEscapeSequenceAtom();case"u":return this.regExpUnicodeEscapeSequenceAtom();default:return this.identityEscapeAtom()}}decimalEscapeAtom(){return{type:"GroupBackReference",value:this.positiveInteger()}}characterClassEscape(){let e;let t=!1;switch(this.popChar()){case"d":e=on;break;case"D":e=on,t=!0;break;case"s":e=oo;break;case"S":e=oo,t=!0;break;case"w":e=oi;break;case"W":e=oi,t=!0}return oe(e)?{type:"Set",value:e,complement:t}:ot()}controlEscapeAtom(){let e;switch(this.popChar()){case"f":e=i4("\f");break;case"n":e=i4("\n");break;case"r":e=i4("\r");break;case"t":e=i4("	");break;case"v":e=i4("\v")}return oe(e)?{type:"Character",value:e}:ot()}controlLetterEscapeAtom(){this.consumeChar("c");let e=this.popChar();if(!1===/[a-zA-Z]/.test(e))throw Error("Invalid ");return{type:"Character",value:e.toUpperCase().charCodeAt(0)-64}}nulCharacterAtom(){return this.consumeChar("0"),{type:"Character",value:i4("\x00")}}hexEscapeSequenceAtom(){return this.consumeChar("x"),this.parseHexDigits(2)}regExpUnicodeEscapeSequenceAtom(){return this.consumeChar("u"),this.parseHexDigits(4)}identityEscapeAtom(){return{type:"Character",value:i4(this.popChar())}}classPatternCharacterAtom(){switch(this.peekChar()){case"\n":case"\r":case"\u2028":case"\u2029":case"\\":case"]":throw Error("TBD");default:return{type:"Character",value:i4(this.popChar())}}}characterClass(){let e=[],t=!1;for(this.consumeChar("["),"^"===this.peekChar(0)&&(this.consumeChar("^"),t=!0);this.isClassAtom();){let t=this.classAtom();if(t.type,or(t)&&this.isRangeDash()){this.consumeChar("-");let r=this.classAtom();if(r.type,or(r)){if(r.value<t.value)throw Error("Range out of order in character class");e.push({from:t.value,to:r.value})}else i7(t.value,e),e.push(i4("-")),i7(r.value,e)}else i7(t.value,e)}return this.consumeChar("]"),{type:"Set",complement:t,value:e}}classAtom(){switch(this.peekChar()){case"]":case"\n":case"\r":case"\u2028":case"\u2029":throw Error("TBD");case"\\":return this.classEscape();default:return this.classPatternCharacterAtom()}}classEscape(){switch(this.consumeChar("\\"),this.peekChar()){case"b":return this.consumeChar("b"),{type:"Character",value:i4("\b")};case"d":case"D":case"s":case"S":case"w":case"W":return this.characterClassEscape();case"f":case"n":case"r":case"t":case"v":return this.controlEscapeAtom();case"c":return this.controlLetterEscapeAtom();case"0":return this.nulCharacterAtom();case"x":return this.hexEscapeSequenceAtom();case"u":return this.regExpUnicodeEscapeSequenceAtom();default:return this.identityEscapeAtom()}}group(){let e=!0;(this.consumeChar("("),"?"===this.peekChar(0))?(this.consumeChar("?"),this.consumeChar(":"),e=!1):this.groupIdx++;let t=this.disjunction();this.consumeChar(")");let r={type:"Group",capturing:e,value:t};return e&&(r.idx=this.groupIdx),r}positiveInteger(){let e=this.popChar();if(!1===ol.test(e))throw Error("Expecting a positive integer");for(;oa.test(this.peekChar(0));)e+=this.popChar();return parseInt(e,10)}integerIncludingZero(){let e=this.popChar();if(!1===oa.test(e))throw Error("Expecting an integer");for(;oa.test(this.peekChar(0));)e+=this.popChar();return parseInt(e,10)}patternCharacter(){let e=this.popChar();switch(e){case"\n":case"\r":case"\u2028":case"\u2029":case"^":case"$":case"\\":case".":case"*":case"+":case"?":case"(":case")":case"[":case"|":throw Error("TBD");default:return{type:"Character",value:i4(e)}}}isRegExpFlag(){switch(this.peekChar(0)){case"g":case"i":case"m":case"u":case"y":return!0;default:return!1}}isRangeDash(){return"-"===this.peekChar()&&this.isClassAtom(1)}isDigit(){return oa.test(this.peekChar(0))}isClassAtom(e=0){switch(this.peekChar(e)){case"]":case"\n":case"\r":case"\u2028":case"\u2029":return!1;default:return!0}}isTerm(){return this.isAtom()||this.isAssertion()}isAtom(){if(this.isPatternCharacter())return!0;switch(this.peekChar(0)){case".":case"\\":case"[":case"(":return!0;default:return!1}}isAssertion(){switch(this.peekChar(0)){case"^":case"$":return!0;case"\\":switch(this.peekChar(1)){case"b":case"B":return!0;default:return!1}case"(":return"?"===this.peekChar(1)&&("="===this.peekChar(2)||"!"===this.peekChar(2));default:return!1}}isQuantifier(){let e=this.saveState();try{return void 0!==this.quantifier(!0)}catch(e){return!1}finally{this.restoreState(e)}}isPatternCharacter(){switch(this.peekChar()){case"^":case"$":case"\\":case".":case"*":case"+":case"?":case"(":case")":case"[":case"|":case"/":case"\n":case"\r":case"\u2028":case"\u2029":return!1;default:return!0}}parseHexDigits(e){let t="";for(let r=0;r<e;r++){let e=this.popChar();if(!1===os.test(e))throw Error("Expecting a HexDecimal digits");t+=e}return{type:"Character",value:parseInt(t,16)}}peekChar(e=0){return this.input[this.idx+e]}popChar(){let e=this.peekChar(0);return this.consumeChar(void 0),e}consumeChar(e){if(void 0!==e&&this.input[this.idx]!==e)throw Error("Expected: '"+e+"' but found: '"+this.input[this.idx]+"' at offset: "+this.idx);if(this.idx>=this.input.length)throw Error("Unexpected end of input");this.idx++}loc(e){return{begin:e,end:this.idx}}};function oC(e){let t=e.toString();if(ok.hasOwnProperty(t))return ok[t];{let e=oN.pattern(t);return ok[t]=e,e}}let oI="Complement Sets are not supported for first char optimization",ox='Unable to use "first char" lexer optimizations:\n';function oM(e,t,r){let n=oZ(e);t[n]=n,!0===r&&function(e,t){let r=String.fromCharCode(e),n=r.toUpperCase();if(n!==r){let e=oZ(n.charCodeAt(0));t[e]=e}else{let e=r.toLowerCase();if(e!==r){let r=oZ(e.charCodeAt(0));t[r]=r}}}(e,t)}function oU(e,t){return oT(e.value,e=>"number"==typeof e?ij(t,e):void 0!==oT(t,t=>e.from<=t&&t<=e.to))}class oP extends oc{constructor(e){super(),this.targetCharCodes=e,this.found=!1}visitChildren(e){if(!0!==this.found){switch(e.type){case"Lookahead":this.visitLookahead(e);return;case"NegativeLookahead":this.visitNegativeLookahead(e);return}super.visitChildren(e)}}visitCharacter(e){ij(this.targetCharCodes,e.value)&&(this.found=!0)}visitSet(e){e.complement?void 0===oU(e,this.targetCharCodes)&&(this.found=!0):void 0!==oU(e,this.targetCharCodes)&&(this.found=!0)}}function oD(e,t){if(!(t instanceof RegExp))return void 0!==oT(t,t=>ij(e,t.charCodeAt(0)));{let r=oC(t),n=new oP(e);return n.visit(r),n.found}}let oB="PATTERN",oF="defaultMode",oj="modes",o$="boolean"==typeof RegExp("(?:)").sticky,oG=/[^\\][$]/,oK=/[^\\[][\^]|^\^/;function oW(e){let t=e.ignoreCase?"i":"";return RegExp(`^(?:${e.source})`,t)}function oH(e){let t=e.ignoreCase?"iy":"y";return RegExp(`${e.source}`,t)}function oY(e){let t=e.PATTERN;if(ig(t))return!1;if(tp(t)||ny(t,"exec"))return!0;if(im(t))return!1;throw Error("non exhaustive match")}function oV(e){return!!im(e)&&1===e.length&&e.charCodeAt(0)}let oz={test:function(e){let t=e.length;for(let r=this.lastIndex;r<t;r++){let t=e.charCodeAt(r);if(10===t)return this.lastIndex=r+1,!0;if(13===t)return 10===e.charCodeAt(r+1)?this.lastIndex=r+2:this.lastIndex=r+1,!0}return!1},lastIndex:0};function oq(e,t){if(ny(e,"LINE_BREAKS"))return!1;if(ig(e.PATTERN)){try{oD(t,e.PATTERN)}catch(e){return{issue:B.IDENTIFY_TERMINATOR,errMsg:e.message}}return!1}if(im(e.PATTERN))return!1;if(oY(e))return{issue:B.CUSTOM_LINE_BREAK};throw Error("non exhaustive match")}function oJ(e){return nq(e,e=>im(e)?e.charCodeAt(0):e)}function oX(e,t,r){void 0===e[t]?e[t]=[r]:e[t].push(r)}let oQ=[];function oZ(e){return e<256?e:oQ[e]}var o0=function(e){var t=null==e?0:e.length;return t?e[t-1]:void 0};function o1(e,t){let r=e.tokenTypeIdx;return r===t.tokenTypeIdx||!0===t.isParent&&!0===t.categoryMatchesMap[r]}function o2(e,t){return e.tokenTypeIdx===t.tokenTypeIdx}let o6=1,o8={};function o3(e){let t=function(e){let t=r8(e),r=e,n=!0;for(;n;){let e=om(r=ou(iJ(nq(r,e=>e.CATEGORIES))),t);t=t.concat(e),nT(e)?n=!1:r=e}return t}(e);r7(t,e=>{o5(e)||(o8[o6]=e,e.tokenTypeIdx=o6++),o4(e)&&!tV(e.CATEGORIES)&&(e.CATEGORIES=[e.CATEGORIES]),o4(e)||(e.CATEGORIES=[]),ny(e,"categoryMatches")||(e.categoryMatches=[]),ny(e,"categoryMatchesMap")||(e.categoryMatchesMap={})}),r7(t,e=>{(function e(t,r){r7(t,e=>{r.categoryMatchesMap[e.tokenTypeIdx]=!0}),r7(r.CATEGORIES,n=>{let i=t.concat(r);ij(i,n)||e(i,n)})})([],e)}),r7(t,e=>{e.categoryMatches=[],r7(e.categoryMatchesMap,(t,r)=>{e.categoryMatches.push(o8[r].tokenTypeIdx)})}),r7(t,e=>{e.isParent=e.categoryMatches.length>0})}function o5(e){return ny(e,"tokenTypeIdx")}function o4(e){return ny(e,"CATEGORIES")}function o7(e){return ny(e,"tokenTypeIdx")}(g=B||(B={}))[g.MISSING_PATTERN=0]="MISSING_PATTERN",g[g.INVALID_PATTERN=1]="INVALID_PATTERN",g[g.EOI_ANCHOR_FOUND=2]="EOI_ANCHOR_FOUND",g[g.UNSUPPORTED_FLAGS_FOUND=3]="UNSUPPORTED_FLAGS_FOUND",g[g.DUPLICATE_PATTERNS_FOUND=4]="DUPLICATE_PATTERNS_FOUND",g[g.INVALID_GROUP_TYPE_FOUND=5]="INVALID_GROUP_TYPE_FOUND",g[g.PUSH_MODE_DOES_NOT_EXIST=6]="PUSH_MODE_DOES_NOT_EXIST",g[g.MULTI_MODE_LEXER_WITHOUT_DEFAULT_MODE=7]="MULTI_MODE_LEXER_WITHOUT_DEFAULT_MODE",g[g.MULTI_MODE_LEXER_WITHOUT_MODES_PROPERTY=8]="MULTI_MODE_LEXER_WITHOUT_MODES_PROPERTY",g[g.MULTI_MODE_LEXER_DEFAULT_MODE_VALUE_DOES_NOT_EXIST=9]="MULTI_MODE_LEXER_DEFAULT_MODE_VALUE_DOES_NOT_EXIST",g[g.LEXER_DEFINITION_CANNOT_CONTAIN_UNDEFINED=10]="LEXER_DEFINITION_CANNOT_CONTAIN_UNDEFINED",g[g.SOI_ANCHOR_FOUND=11]="SOI_ANCHOR_FOUND",g[g.EMPTY_MATCH_PATTERN=12]="EMPTY_MATCH_PATTERN",g[g.NO_LINE_BREAKS_FLAGS=13]="NO_LINE_BREAKS_FLAGS",g[g.UNREACHABLE_PATTERN=14]="UNREACHABLE_PATTERN",g[g.IDENTIFY_TERMINATOR=15]="IDENTIFY_TERMINATOR",g[g.CUSTOM_LINE_BREAK=16]="CUSTOM_LINE_BREAK",g[g.MULTI_MODE_LEXER_LONGER_ALT_NOT_IN_CURRENT_MODE=17]="MULTI_MODE_LEXER_LONGER_ALT_NOT_IN_CURRENT_MODE";let o9={deferDefinitionErrorsHandling:!1,positionTracking:"full",lineTerminatorsPattern:/\n|\r\n?/g,lineTerminatorCharacters:["\n","\r"],ensureOptimizations:!1,safeMode:!1,errorMessageProvider:{buildUnableToPopLexerModeMessage:e=>`Unable to pop Lexer Mode after encountering Token ->${e.image}<- The Mode Stack is empty`,buildUnexpectedCharactersMessage:(e,t,r,n,i)=>`unexpected character: ->${e.charAt(t)}<- at offset: ${t}, skipped ${r} characters.`},traceInitPerf:!1,skipValidations:!1,recoveryEnabled:!0};Object.freeze(o9);class se{constructor(e,t=o9){if(this.lexerDefinition=e,this.lexerDefinitionErrors=[],this.lexerDefinitionWarning=[],this.patternIdxToConfig={},this.charCodeToPatternIdxToConfig={},this.modes=[],this.emptyGroups={},this.trackStartLines=!0,this.trackEndLines=!0,this.hasCustom=!1,this.canModeBeOptimized={},this.TRACE_INIT=(e,t)=>{if(!0!==this.traceInitPerf)return t();{this.traceInitIndent++;let r=Array(this.traceInitIndent+1).join("	");this.traceInitIndent<this.traceInitMaxIdent&&console.log(`${r}--> <${e}>`);let{time:n,value:i}=nZ(t),o=n>10?console.warn:console.log;return this.traceInitIndent<this.traceInitMaxIdent&&o(`${r}<-- <${e}> time: ${n}ms`),this.traceInitIndent--,i}},"boolean"==typeof t)throw Error("The second argument to the Lexer constructor is now an ILexerConfig Object.\na boolean 2nd argument is no longer supported");this.config=id({},o9,t);let r=this.config.traceInitPerf;!0===r?(this.traceInitMaxIdent=1/0,this.traceInitPerf=!0):"number"==typeof r&&(this.traceInitMaxIdent=r,this.traceInitPerf=!0),this.traceInitIndent=-1,this.TRACE_INIT("Lexer Constructor",()=>{let r;let n=!0;this.TRACE_INIT("Lexer Config handling",()=>{if(this.config.lineTerminatorsPattern===o9.lineTerminatorsPattern)this.config.lineTerminatorsPattern=oz;else if(this.config.lineTerminatorCharacters===o9.lineTerminatorCharacters)throw Error("Error: Missing <lineTerminatorCharacters> property on the Lexer config.\n	For details See: https://chevrotain.io/docs/guide/resolving_lexer_errors.html#MISSING_LINE_TERM_CHARS");if(t.safeMode&&t.ensureOptimizations)throw Error('"safeMode" and "ensureOptimizations" flags are mutually exclusive.');this.trackStartLines=/full|onlyStart/i.test(this.config.positionTracking),this.trackEndLines=/full/i.test(this.config.positionTracking),tV(e)?r={modes:{defaultMode:r8(e)},defaultMode:oF}:(n=!1,r=r8(e))}),!1===this.config.skipValidations&&(this.TRACE_INIT("performRuntimeChecks",()=>{this.lexerDefinitionErrors=this.lexerDefinitionErrors.concat(function(e,t,r){let n=[];return ny(e,oF)||n.push({message:"A MultiMode Lexer cannot be initialized without a <"+oF+"> property in its definition\n",type:B.MULTI_MODE_LEXER_WITHOUT_DEFAULT_MODE}),ny(e,oj)||n.push({message:"A MultiMode Lexer cannot be initialized without a <"+oj+"> property in its definition\n",type:B.MULTI_MODE_LEXER_WITHOUT_MODES_PROPERTY}),ny(e,oj)&&ny(e,oF)&&!ny(e.modes,e.defaultMode)&&n.push({message:`A MultiMode Lexer cannot be initialized with a ${oF}: <${e.defaultMode}>which does not exist
`,type:B.MULTI_MODE_LEXER_DEFAULT_MODE_VALUE_DOES_NOT_EXIST}),ny(e,oj)&&r7(e.modes,(e,t)=>{r7(e,(r,i)=>{i5(r)?n.push({message:`A Lexer cannot be initialized using an undefined Token Type. Mode:<${t}> at index: <${i}>
`,type:B.LEXER_DEFINITION_CANNOT_CONTAIN_UNDEFINED}):ny(r,"LONGER_ALT")&&r7(tV(r.LONGER_ALT)?r.LONGER_ALT:[r.LONGER_ALT],i=>{i5(i)||ij(e,i)||n.push({message:`A MultiMode Lexer cannot be initialized with a longer_alt <${i.name}> on token <${r.name}> outside of mode <${t}>
`,type:B.MULTI_MODE_LEXER_LONGER_ALT_NOT_IN_CURRENT_MODE})})})}),n}(r,this.trackStartLines,this.config.lineTerminatorCharacters))}),this.TRACE_INIT("performWarningRuntimeChecks",()=>{this.lexerDefinitionWarning=this.lexerDefinitionWarning.concat(function(e,t,r){let n=[],i=!1,o=oL(ou(iJ(nJ(e.modes))),e=>e[oB]===se.NA),s=oJ(r);return t&&r7(o,e=>{let t=oq(e,s);if(!1!==t){let r={message:function(e,t){if(t.issue===B.IDENTIFY_TERMINATOR)return`Warning: unable to identify line terminator usage in pattern.
	The problem is in the <${e.name}> Token Type
	 Root cause: ${t.errMsg}.
	For details See: https://chevrotain.io/docs/guide/resolving_lexer_errors.html#IDENTIFY_TERMINATOR`;if(t.issue===B.CUSTOM_LINE_BREAK)return`Warning: A Custom Token Pattern should specify the <line_breaks> option.
	The problem is in the <${e.name}> Token Type
	For details See: https://chevrotain.io/docs/guide/resolving_lexer_errors.html#CUSTOM_LINE_BREAK`;throw Error("non exhaustive match")}(e,t),type:t.issue,tokenType:e};n.push(r)}else ny(e,"LINE_BREAKS")?!0===e.LINE_BREAKS&&(i=!0):oD(s,e.PATTERN)&&(i=!0)}),t&&!i&&n.push({message:"Warning: No LINE_BREAKS Found.\n	This Lexer has been defined to track line and column information,\n	But none of the Token Types can be identified as matching a line terminator.\n	See https://chevrotain.io/docs/guide/resolving_lexer_errors.html#LINE_BREAKS \n	for details.",type:B.NO_LINE_BREAKS_FLAGS}),n}(r,this.trackStartLines,this.config.lineTerminatorCharacters))})),r.modes=r.modes?r.modes:{},r7(r.modes,(e,t)=>{r.modes[t]=oL(e,e=>i5(e))});let i=rr(r.modes);if(r7(r.modes,(e,r)=>{this.TRACE_INIT(`Mode: <${r}> processing`,()=>{if(this.modes.push(r),!1===this.config.skipValidations&&this.TRACE_INIT("validatePatterns",()=>{this.lexerDefinitionErrors=this.lexerDefinitionErrors.concat(function(e,t){let r=[],n=function(e){let t=oy(e,e=>!ny(e,oB));return{errors:nq(t,e=>({message:"Token Type: ->"+e.name+"<- missing static 'PATTERN' property",type:B.MISSING_PATTERN,tokenTypes:[e]})),valid:om(e,t)}}(e);r=r.concat(n.errors);let i=function(e){let t=oy(e,e=>{let t=e[oB];return!ig(t)&&!tp(t)&&!ny(t,"exec")&&!im(t)});return{errors:nq(t,e=>({message:"Token Type: ->"+e.name+"<- static 'PATTERN' can only be a RegExp, a Function matching the {CustomPatternMatcherFunc} type or an Object matching the {ICustomPattern} interface.",type:B.INVALID_PATTERN,tokenTypes:[e]})),valid:om(e,t)}}(n.valid),o=i.valid;return(r=(r=(r=(r=r.concat(i.errors)).concat(function(e){let t=[],r=oy(e,e=>ig(e[oB]));return(t=(t=(t=(t=t.concat(function(e){class t extends oc{constructor(){super(...arguments),this.found=!1}visitEndAnchor(e){this.found=!0}}return nq(oy(e,e=>{let r=e.PATTERN;try{let e=oC(r),n=new t;return n.visit(e),n.found}catch(e){return oG.test(r.source)}}),e=>({message:"Unexpected RegExp Anchor Error:\n	Token Type: ->"+e.name+"<- static 'PATTERN' cannot contain end of input anchor '$'\n	See chevrotain.io/docs/guide/resolving_lexer_errors.html#ANCHORS	for details.",type:B.EOI_ANCHOR_FOUND,tokenTypes:[e]}))}(r))).concat(function(e){class t extends oc{constructor(){super(...arguments),this.found=!1}visitStartAnchor(e){this.found=!0}}return nq(oy(e,e=>{let r=e.PATTERN;try{let e=oC(r),n=new t;return n.visit(e),n.found}catch(e){return oK.test(r.source)}}),e=>({message:"Unexpected RegExp Anchor Error:\n	Token Type: ->"+e.name+"<- static 'PATTERN' cannot contain start of input anchor '^'\n	See https://chevrotain.io/docs/guide/resolving_lexer_errors.html#ANCHORS	for details.",type:B.SOI_ANCHOR_FOUND,tokenTypes:[e]}))}(r))).concat(nq(oy(r,e=>{let t=e[oB];return t instanceof RegExp&&(t.multiline||t.global)}),e=>({message:"Token Type: ->"+e.name+"<- static 'PATTERN' may NOT contain global('g') or multiline('m')",type:B.UNSUPPORTED_FLAGS_FOUND,tokenTypes:[e]})))).concat(function(e){let t=[],r=nq(e,r=>oO(e,(e,n)=>(r.PATTERN.source!==n.PATTERN.source||ij(t,n)||n.PATTERN===se.NA||(t.push(n),e.push(n)),e),[]));return nq(oy(r=ou(r),e=>e.length>1),e=>{let t=nq(e,e=>e.name),r=oA(e).PATTERN;return{message:`The same RegExp pattern ->${r}<-has been used in all of the following Token Types: ${t.join(", ")} <-`,type:B.DUPLICATE_PATTERNS_FOUND,tokenTypes:e}})}(r))).concat(nq(oy(r,e=>e.PATTERN.test("")),e=>({message:"Token Type: ->"+e.name+"<- static 'PATTERN' must not match an empty string",type:B.EMPTY_MATCH_PATTERN,tokenTypes:[e]})))}(o))).concat(nq(oy(o,e=>{if(!ny(e,"GROUP"))return!1;let t=e.GROUP;return t!==se.SKIPPED&&t!==se.NA&&!im(t)}),e=>({message:"Token Type: ->"+e.name+"<- static 'GROUP' can only be Lexer.SKIPPED/Lexer.NA/A String",type:B.INVALID_GROUP_TYPE_FOUND,tokenTypes:[e]})))).concat(nq(oy(o,e=>void 0!==e.PUSH_MODE&&!ij(t,e.PUSH_MODE)),e=>({message:`Token Type: ->${e.name}<- static 'PUSH_MODE' value cannot refer to a Lexer Mode ->${e.PUSH_MODE}<-which does not exist`,type:B.PUSH_MODE_DOES_NOT_EXIST,tokenTypes:[e]})))).concat(function(e){let t=[],r=oO(e,(e,t,r)=>{let n=t.PATTERN;return n===se.NA||(im(n)?e.push({str:n,idx:r,tokenType:t}):ig(n)&&void 0===oT([".","\\","[","]","|","^","$","(",")","?","*","+","{"],e=>-1!==n.source.indexOf(e))&&e.push({str:n.source,idx:r,tokenType:t})),e},[]);return r7(e,(e,n)=>{r7(r,({str:r,idx:i,tokenType:o})=>{if(n<i&&function(e,t){if(ig(t)){let r=t.exec(e);return null!==r&&0===r.index}if(tp(t))return t(e,0,[],{});if(ny(t,"exec"))return t.exec(e,0,[],{});if("string"==typeof t)return t===e;throw Error("non exhaustive match")}(r,e.PATTERN)){let r=`Token: ->${o.name}<- can never be matched.
Because it appears AFTER the Token Type ->${e.name}<-in the lexer's definition.
See https://chevrotain.io/docs/guide/resolving_lexer_errors.html#UNREACHABLE`;t.push({message:r,type:B.UNREACHABLE_PATTERN,tokenTypes:[e,o]})}})}),t}(o))}(e,i))}),nT(this.lexerDefinitionErrors)){let n;o3(e),this.TRACE_INIT("analyzeTokenTypes",()=>{n=function(e,t){let r,n,i,o,s,a,l,c,u,h,d,f;let p=(t=of(t,{useSticky:o$,debug:!1,safeMode:!1,positionTracking:"full",lineTerminatorCharacters:["\r","\n"],tracer:(e,t)=>t()})).tracer;p("initCharCodeToOptimizedIndexMap",()=>{(function(){if(nT(oQ)){oQ=Array(65536);for(let e=0;e<65536;e++)oQ[e]=e>255?255+~~(e/255):e}})()}),p("Reject Lexer.NA",()=>{r=oL(e,e=>e[oB]===se.NA)});let g=!1;p("Transform Patterns",()=>{g=!1,n=nq(r,e=>{let r=e[oB];if(ig(r)){let e=r.source;return 1!==e.length||"^"===e||"$"===e||"."===e||r.ignoreCase?2!==e.length||"\\"!==e[0]||ij(["d","D","s","S","t","r","n","t","0","c","b","B","f","v","w","W"],e[1])?t.useSticky?oH(r):oW(r):e[1]:e}if(tp(r))return g=!0,{exec:r};if("object"==typeof r)return g=!0,r;if("string"==typeof r){if(1===r.length)return r;{let e=new RegExp(r.replace(/[\\^$.*+?()[\]{}|]/g,"\\$&"));return t.useSticky?oH(e):oW(e)}}throw Error("non exhaustive match")})}),p("misc mapping",()=>{i=nq(r,e=>e.tokenTypeIdx),o=nq(r,e=>{let t=e.GROUP;if(t!==se.SKIPPED){if(im(t))return t;if(i5(t))return!1;throw Error("non exhaustive match")}}),s=nq(r,e=>{let t=e.LONGER_ALT;if(t)return tV(t)?nq(t,e=>ob(r,e)):[ob(r,t)]}),a=nq(r,e=>e.PUSH_MODE),l=nq(r,e=>ny(e,"POP_MODE"))}),p("Line Terminator Handling",()=>{let e=oJ(t.lineTerminatorCharacters);c=nq(r,e=>!1),"onlyOffset"!==t.positionTracking&&(c=nq(r,t=>ny(t,"LINE_BREAKS")?!!t.LINE_BREAKS:!1===oq(t,e)&&oD(e,t.PATTERN)))}),p("Misc Mapping #2",()=>{u=nq(r,oY),h=nq(n,oV),d=oO(r,(e,t)=>{let r=t.GROUP;return im(r)&&r!==se.SKIPPED&&(e[r]=[]),e},{}),f=nq(n,(e,t)=>({pattern:n[t],longerAlt:s[t],canLineTerminator:c[t],isCustom:u[t],short:h[t],group:o[t],push:a[t],pop:l[t],tokenTypeIdx:i[t],tokenType:r[t]}))});let m=!0,E=[];return t.safeMode||p("First Char Optimization",()=>{E=oO(r,(e,r,n)=>{if("string"==typeof r.PATTERN)oX(e,oZ(r.PATTERN.charCodeAt(0)),f[n]);else if(tV(r.START_CHARS_HINT)){let t;r7(r.START_CHARS_HINT,r=>{let i=oZ("string"==typeof r?r.charCodeAt(0):r);t!==i&&(t=i,oX(e,i,f[n]))})}else if(ig(r.PATTERN)){if(r.PATTERN.unicode)m=!1,t.ensureOptimizations&&nX(`${ox}	Unable to analyze < ${r.PATTERN.toString()} > pattern.
	The regexp unicode flag is not currently supported by the regexp-to-ast library.
	This will disable the lexer's first char optimizations.
	For details See: https://chevrotain.io/docs/guide/resolving_lexer_errors.html#UNICODE_OPTIMIZE`);else{let i=function(e,t=!1){try{let t=oC(e);return function e(t,r,n){switch(t.type){case"Disjunction":for(let i=0;i<t.value.length;i++)e(t.value[i],r,n);break;case"Alternative":let i=t.value;for(let t=0;t<i.length;t++){let o=i[t];switch(o.type){case"EndAnchor":case"GroupBackReference":case"Lookahead":case"NegativeLookahead":case"StartAnchor":case"WordBoundary":case"NonWordBoundary":continue}switch(o.type){case"Character":oM(o.value,r,n);break;case"Set":if(!0===o.complement)throw Error(oI);r7(o.value,e=>{if("number"==typeof e)oM(e,r,n);else if(!0===n)for(let t=e.from;t<=e.to;t++)oM(t,r,n);else{for(let t=e.from;t<=e.to&&t<256;t++)oM(t,r,n);if(e.to>=256){let t=e.from>=256?e.from:256,n=e.to,i=oZ(t),o=oZ(n);for(let e=i;e<=o;e++)r[e]=e}}});break;case"Group":e(o.value,r,n);break;default:throw Error("Non Exhaustive Match")}let s=void 0!==o.quantifier&&0===o.quantifier.atLeast;if("Group"===o.type&&!1===function e(t){let r=t.quantifier;return!!r&&0===r.atLeast||!!t.value&&(tV(t.value)?iM(t.value,e):e(t.value))}(o)||"Group"!==o.type&&!1===s)break}break;default:throw Error("non exhaustive match!")}return nJ(r)}(t.value,{},t.flags.ignoreCase)}catch(r){if(r.message===oI)t&&nQ(`${ox}	Unable to optimize: < ${e.toString()} >
	Complement Sets cannot be automatically optimized.
	This will disable the lexer's first char optimizations.
	See: https://chevrotain.io/docs/guide/resolving_lexer_errors.html#COMPLEMENT for details.`);else{let r="";t&&(r="\n	This will disable the lexer's first char optimizations.\n	See: https://chevrotain.io/docs/guide/resolving_lexer_errors.html#REGEXP_PARSING for details."),nX(`${ox}
	Failed parsing: < ${e.toString()} >
	Using the @chevrotain/regexp-to-ast library
	Please open an issue at: https://github.com/chevrotain/chevrotain/issues`+r)}}return[]}(r.PATTERN,t.ensureOptimizations);nT(i)&&(m=!1),r7(i,t=>{oX(e,t,f[n])})}}else t.ensureOptimizations&&nX(`${ox}	TokenType: <${r.name}> is using a custom token pattern without providing <start_chars_hint> parameter.
	This will disable the lexer's first char optimizations.
	For details See: https://chevrotain.io/docs/guide/resolving_lexer_errors.html#CUSTOM_OPTIMIZE`),m=!1;return e},[])}),{emptyGroups:d,patternIdxToConfig:f,charCodeToPatternIdxToConfig:E,hasCustom:g,canBeOptimized:m}}(e,{lineTerminatorCharacters:this.config.lineTerminatorCharacters,positionTracking:t.positionTracking,ensureOptimizations:t.ensureOptimizations,safeMode:t.safeMode,tracer:this.TRACE_INIT})}),this.patternIdxToConfig[r]=n.patternIdxToConfig,this.charCodeToPatternIdxToConfig[r]=n.charCodeToPatternIdxToConfig,this.emptyGroups=id({},this.emptyGroups,n.emptyGroups),this.hasCustom=n.hasCustom||this.hasCustom,this.canModeBeOptimized[r]=n.canBeOptimized}})}),this.defaultMode=r.defaultMode,!nT(this.lexerDefinitionErrors)&&!this.config.deferDefinitionErrorsHandling)throw Error("Errors detected in definition of Lexer:\n"+nq(this.lexerDefinitionErrors,e=>e.message).join("-----------------------\n"));r7(this.lexerDefinitionWarning,e=>{nQ(e.message)}),this.TRACE_INIT("Choosing sub-methods implementations",()=>{if(o$?(this.chopInput=r4,this.match=this.matchWithTest):(this.updateLastIndex=iZ,this.match=this.matchWithExec),n&&(this.handleModes=iZ),!1===this.trackStartLines&&(this.computeNewColumn=r4),!1===this.trackEndLines&&(this.updateTokenEndLineColumnLocation=iZ),/full/i.test(this.config.positionTracking))this.createTokenInstance=this.createFullToken;else if(/onlyStart/i.test(this.config.positionTracking))this.createTokenInstance=this.createStartOnlyToken;else if(/onlyOffset/i.test(this.config.positionTracking))this.createTokenInstance=this.createOffsetOnlyToken;else throw Error(`Invalid <positionTracking> config option: "${this.config.positionTracking}"`);this.hasCustom?(this.addToken=this.addTokenUsingPush,this.handlePayload=this.handlePayloadWithCustom):(this.addToken=this.addTokenUsingMemberAccess,this.handlePayload=this.handlePayloadNoCustom)}),this.TRACE_INIT("Failed Optimization Warnings",()=>{let e=oO(this.canModeBeOptimized,(e,t,r)=>(!1===t&&e.push(r),e),[]);if(t.ensureOptimizations&&!nT(e))throw Error(`Lexer Modes: < ${e.join(", ")} > cannot be optimized.
	 Disable the "ensureOptimizations" lexer config flag to silently ignore this and run the lexer in an un-optimized mode.
	 Or inspect the console log for details on how to resolve these issues.`)}),this.TRACE_INIT("clearRegExpParserCache",()=>{ok={}}),this.TRACE_INIT("toFastProperties",()=>{n0(this)})})}tokenize(e,t=this.defaultMode){if(!nT(this.lexerDefinitionErrors))throw Error("Unable to Tokenize because Errors detected in definition of Lexer:\n"+nq(this.lexerDefinitionErrors,e=>e.message).join("-----------------------\n"));return this.tokenizeInternal(e,t)}tokenizeInternal(e,t){let r,n,i,o,s,a,l,c,u,h,d,f,p,g,m,E,y;let _=e,T=_.length,A=0,v=0,b=Array(this.hasCustom?0:Math.floor(e.length/10)),R=[],w=this.trackStartLines?1:void 0,O=this.trackStartLines?1:void 0,S=function(e){let t={};return r7(rr(e),r=>{if(tV(e[r]))t[r]=[];else throw Error("non exhaustive match")}),t}(this.emptyGroups),L=this.trackStartLines,k=this.config.lineTerminatorsPattern,N=0,C=[],I=[],x=[],M=[];function U(){return C}function P(e){let t=I[oZ(e)];return void 0===t?M:t}Object.freeze(M);let D=e=>{if(1===x.length&&void 0===e.tokenType.PUSH_MODE){let t=this.config.errorMessageProvider.buildUnableToPopLexerModeMessage(e);R.push({offset:e.startOffset,line:e.startLine,column:e.startColumn,length:e.image.length,message:t})}else{x.pop();let e=o0(x);C=this.patternIdxToConfig[e],I=this.charCodeToPatternIdxToConfig[e],N=C.length;let t=this.canModeBeOptimized[e]&&!1===this.config.safeMode;E=I&&t?P:U}};function B(e){x.push(e),I=this.charCodeToPatternIdxToConfig[e],N=(C=this.patternIdxToConfig[e]).length,N=C.length;let t=this.canModeBeOptimized[e]&&!1===this.config.safeMode;E=I&&t?P:U}B.call(this,t);let F=this.config.recoveryEnabled;for(;A<T;){a=null;let t=_.charCodeAt(A),I=E(t),x=I.length;for(r=0;r<x;r++){let n=(y=I[r]).pattern;l=null;let u=y.short;if(!1!==u?t===u&&(a=n):!0===y.isCustom?null!==(m=n.exec(_,A,b,S))?(a=m[0],void 0!==m.payload&&(l=m.payload)):a=null:(this.updateLastIndex(n,A),a=this.match(n,e,A)),null!==a){if(void 0!==(s=y.longerAlt)){let t=s.length;for(i=0;i<t;i++){let t=C[s[i]],r=t.pattern;if(c=null,!0===t.isCustom?null!==(m=r.exec(_,A,b,S))?(o=m[0],void 0!==m.payload&&(c=m.payload)):o=null:(this.updateLastIndex(r,A),o=this.match(r,e,A)),o&&o.length>a.length){a=o,l=c,y=t;break}}}break}}if(null!==a){if(u=a.length,void 0!==(h=y.group)&&(d=y.tokenTypeIdx,f=this.createTokenInstance(a,A,d,y.tokenType,w,O,u),this.handlePayload(f,l),!1===h?v=this.addToken(b,v,f):S[h].push(f)),e=this.chopInput(e,u),A+=u,O=this.computeNewColumn(O,u),!0===L&&!0===y.canLineTerminator){let e,t,r=0;k.lastIndex=0;do!0===(e=k.test(a))&&(t=k.lastIndex-1,r++);while(!0===e)0!==r&&(w+=r,O=u-t,this.updateTokenEndLineColumnLocation(f,h,t,r,w,O,u))}this.handleModes(y,D,B,f)}else{let t=A,r=w,i=O,o=!1===F;for(;!1===o&&A<T;)for(e=this.chopInput(e,1),A++,n=0;n<N;n++){let t=C[n],r=t.pattern,i=t.short;if(!1!==i?_.charCodeAt(A)===i&&(o=!0):!0===t.isCustom?o=null!==r.exec(_,A,b,S):(this.updateLastIndex(r,A),o=null!==r.exec(e)),!0===o)break}if(p=A-t,O=this.computeNewColumn(O,p),g=this.config.errorMessageProvider.buildUnexpectedCharactersMessage(_,t,p,r,i),R.push({offset:t,line:r,column:i,length:p,message:g}),!1===F)break}}return this.hasCustom||(b.length=v),{tokens:b,groups:S,errors:R}}handleModes(e,t,r,n){if(!0===e.pop){let i=e.push;t(n),void 0!==i&&r.call(this,i)}else void 0!==e.push&&r.call(this,e.push)}chopInput(e,t){return e.substring(t)}updateLastIndex(e,t){e.lastIndex=t}updateTokenEndLineColumnLocation(e,t,r,n,i,o,s){let a,l;void 0===t||(l=(a=r===s-1)?-1:0,1===n&&!0===a||(e.endLine=i+l,e.endColumn=o-1+-l))}computeNewColumn(e,t){return e+t}createOffsetOnlyToken(e,t,r,n){return{image:e,startOffset:t,tokenTypeIdx:r,tokenType:n}}createStartOnlyToken(e,t,r,n,i,o){return{image:e,startOffset:t,startLine:i,startColumn:o,tokenTypeIdx:r,tokenType:n}}createFullToken(e,t,r,n,i,o,s){return{image:e,startOffset:t,endOffset:t+s-1,startLine:i,endLine:i,startColumn:o,endColumn:o+s-1,tokenTypeIdx:r,tokenType:n}}addTokenUsingPush(e,t,r){return e.push(r),t}addTokenUsingMemberAccess(e,t,r){return e[t]=r,++t}handlePayloadNoCustom(e,t){}handlePayloadWithCustom(e,t){null!==t&&(e.payload=t)}matchWithTest(e,t,r){return!0===e.test(t)?t.substring(r,e.lastIndex):null}matchWithExec(e,t){let r=e.exec(t);return null!==r?r[0]:null}}function st(e){return sr(e)?e.LABEL:e.name}function sr(e){return im(e.LABEL)&&""!==e.LABEL}se.SKIPPED="This marks a skipped Token pattern, this means each token identified by it willbe consumed and then thrown into oblivion, this can be used to for example to completely ignore whitespace.",se.NA=/NOT_APPLICABLE/;let sn="categories",si="label",so="group",ss="push_mode",sa="pop_mode",sl="longer_alt",sc="line_breaks",su="start_chars_hint";function sh(e){let t=e.pattern,r={};if(r.name=e.name,i5(t)||(r.PATTERN=t),ny(e,"parent"))throw"The parent property is no longer supported.\nSee: https://github.com/chevrotain/chevrotain/issues/564#issuecomment-349062346 for details.";return ny(e,sn)&&(r.CATEGORIES=e[sn]),o3([r]),ny(e,si)&&(r.LABEL=e[si]),ny(e,so)&&(r.GROUP=e[so]),ny(e,sa)&&(r.POP_MODE=e[sa]),ny(e,ss)&&(r.PUSH_MODE=e[ss]),ny(e,sl)&&(r.LONGER_ALT=e[sl]),ny(e,sc)&&(r.LINE_BREAKS=e[sc]),ny(e,su)&&(r.START_CHARS_HINT=e[su]),r}let sd=sh({name:"EOF",pattern:se.NA});function sf(e,t,r,n,i,o,s,a){return{image:t,startOffset:r,endOffset:n,startLine:i,endLine:o,startColumn:s,endColumn:a,tokenTypeIdx:e.tokenTypeIdx,tokenType:e}}o3([sd]);let sp={buildMismatchTokenMessage({expected:e,actual:t,previous:r,ruleName:n}){let i=sr(e)?`--> ${st(e)} <--`:`token of type --> ${e.name} <--`;return`Expecting ${i} but found --> '${t.image}' <--`},buildNotAllInputParsedMessage:({firstRedundant:e,ruleName:t})=>"Redundant input, expecting EOF but found: "+e.image,buildNoViableAltMessage({expectedPathsPerAlt:e,actual:t,previous:r,customUserDescription:n,ruleName:i}){let o="Expecting: ",s="\nbut found: '"+oA(t).image+"'";if(n)return o+n+s;{let t=nq(oO(e,(e,t)=>e.concat(t),[]),e=>`[${nq(e,e=>st(e)).join(", ")}]`),r=nq(t,(e,t)=>`  ${t+1}. ${e}`);return o+`one of these possible Token sequences:
${r.join("\n")}`+s}},buildEarlyExitMessage({expectedIterationPaths:e,actual:t,customUserDescription:r,ruleName:n}){let i="Expecting: ",o="\nbut found: '"+oA(t).image+"'";if(r)return i+r+o;{let t=nq(e,e=>`[${nq(e,e=>st(e)).join(",")}]`);return i+`expecting at least one iteration which starts with one of these possible Token sequences::
  <${t.join(" ,")}>`+o}}};Object.freeze(sp);let sg={buildRuleNotFoundError:(e,t)=>"Invalid grammar, reference to a rule which is not defined: ->"+t.nonTerminalName+"<-\ninside top level rule: ->"+e.name+"<-"},sm={buildDuplicateFoundError(e,t){let r=e.name,n=oA(t),i=n.idx,o=iW(n),s=n instanceof iN?n.terminalType.name:n instanceof iA?n.nonTerminalName:"",a=`->${o}${i>0?i:""}<- ${s?`with argument: ->${s}<-`:""}
                  appears more than once (${t.length} times) in the top level rule: ->${r}<-.                  
                  For further details see: https://chevrotain.io/docs/FAQ.html#NUMERICAL_SUFFIXES 
                  `;return(a=a.replace(/[ \t]+/g," ")).replace(/\s\s+/g,"\n")},buildNamespaceConflictError:e=>`Namespace conflict found in grammar.
The grammar has both a Terminal(Token) and a Non-Terminal(Rule) named: <${e.name}>.
To resolve this make sure each Terminal and Non-Terminal names are unique
This is easy to accomplish by using the convention that Terminal names start with an uppercase letter
and Non-Terminal names start with a lower case letter.`,buildAlternationPrefixAmbiguityError(e){let t=nq(e.prefixPath,e=>st(e)).join(", "),r=0===e.alternation.idx?"":e.alternation.idx;return`Ambiguous alternatives: <${e.ambiguityIndices.join(" ,")}> due to common lookahead prefix
in <OR${r}> inside <${e.topLevelRule.name}> Rule,
<${t}> may appears as a prefix path in all these alternatives.
See: https://chevrotain.io/docs/guide/resolving_grammar_errors.html#COMMON_PREFIX
For Further details.`},buildAlternationAmbiguityError(e){let t=nq(e.prefixPath,e=>st(e)).join(", "),r=0===e.alternation.idx?"":e.alternation.idx;return`Ambiguous Alternatives Detected: <${e.ambiguityIndices.join(" ,")}> in <OR${r}> inside <${e.topLevelRule.name}> Rule,
<${t}> may appears as a prefix path in all these alternatives.
See: https://chevrotain.io/docs/guide/resolving_grammar_errors.html#AMBIGUOUS_ALTERNATIVES
For Further details.`},buildEmptyRepetitionError(e){let t=iW(e.repetition);return 0!==e.repetition.idx&&(t+=e.repetition.idx),`The repetition <${t}> within Rule <${e.topLevelRule.name}> can never consume any tokens.
This could lead to an infinite loop.`},buildTokenNameError:e=>"deprecated",buildEmptyAlternationError:e=>`Ambiguous empty alternative: <${e.emptyChoiceIdx+1}> in <OR${e.alternation.idx}> inside <${e.topLevelRule.name}> Rule.
Only the last alternative may be an empty alternative.`,buildTooManyAlternativesError:e=>`An Alternation cannot have more than 256 alternatives:
<OR${e.alternation.idx}> inside <${e.topLevelRule.name}> Rule.
 has ${e.alternation.definition.length+1} alternatives.`,buildLeftRecursionError(e){let t=e.topLevelRule.name,r=nq(e.leftRecursionPath,e=>e.name),n=`${t} --> ${r.concat([t]).join(" --> ")}`;return`Left Recursion found in grammar.
rule: <${t}> can be invoked from itself (directly or indirectly)
without consuming any Tokens. The grammar path that causes this is: 
 ${n}
 To fix this refactor your grammar to remove the left recursion.
see: https://en.wikipedia.org/wiki/LL_parser#Left_factoring.`},buildInvalidRuleNameError:e=>"deprecated",buildDuplicateRuleNameError(e){let t;return t=e.topLevelRule instanceof iv?e.topLevelRule.name:e.topLevelRule,`Duplicate definition, rule: ->${t}<- is already defined in the grammar: ->${e.grammarName}<-`}};class sE extends iC{constructor(e,t){super(),this.nameToTopRule=e,this.errMsgProvider=t,this.errors=[]}resolveRefs(){r7(nJ(this.nameToTopRule),e=>{this.currTopLevel=e,e.accept(this)})}visitNonTerminal(e){let t=this.nameToTopRule[e.nonTerminalName];if(t)e.referencedRule=t;else{let t=this.errMsgProvider.buildRuleNotFoundError(this.currTopLevel,e);this.errors.push({message:t,type:$.UNRESOLVED_SUBRULE_REF,ruleName:this.currTopLevel.name,unresolvedRefName:e.nonTerminalName})}}}var sy=function(e,t,r){var n=null==e?0:e.length;return n?n1(e,0,(t=n-(t=r||void 0===t?1:ir(t)))<0?0:t):[]},s_=function(e,t){return iq(nq(e,t),1)},sT=function(e,t,r,n){for(var i=-1,o=null==e?0:e.length;++i<o;){var s=e[i];t(n,s,r(s),e)}return n},sA=function(e,t,r,n){return r5(e,function(e,i,o){t(n,e,r(e),o)}),n},sv=Object.prototype.hasOwnProperty,sb=(m=function(e,t,r){sv.call(e,r)?e[r].push(t):tP(e,r,[t])},function(e,t){var r=tV(e)?sT:sA,n=E?E():{};return r(e,m,nV(t,2),n)});class sR extends iH{constructor(e,t){super(),this.topProd=e,this.path=t,this.possibleTokTypes=[],this.nextProductionName="",this.nextProductionOccurrence=0,this.found=!1,this.isAtEndOfPath=!1}startWalking(){if(this.found=!1,this.path.ruleStack[0]!==this.topProd.name)throw Error("The path does not start with the walker's top Rule!");return this.ruleStack=r8(this.path.ruleStack).reverse(),this.occurrenceStack=r8(this.path.occurrenceStack).reverse(),this.ruleStack.pop(),this.occurrenceStack.pop(),this.updateExpectedNext(),this.walk(this.topProd),this.possibleTokTypes}walk(e,t=[]){this.found||super.walk(e,t)}walkProdRef(e,t,r){if(e.referencedRule.name===this.nextProductionName&&e.idx===this.nextProductionOccurrence){let n=t.concat(r);this.updateExpectedNext(),this.walk(e.referencedRule,n)}}updateExpectedNext(){nT(this.ruleStack)?(this.nextProductionName="",this.nextProductionOccurrence=0,this.isAtEndOfPath=!0):(this.nextProductionName=this.ruleStack.pop(),this.nextProductionOccurrence=this.occurrenceStack.pop())}}class sw extends sR{constructor(e,t){super(e,t),this.path=t,this.nextTerminalName="",this.nextTerminalOccurrence=0,this.nextTerminalName=this.path.lastTok.name,this.nextTerminalOccurrence=this.path.lastTokOccurrence}walkTerminal(e,t,r){if(this.isAtEndOfPath&&e.terminalType.name===this.nextTerminalName&&e.idx===this.nextTerminalOccurrence&&!this.found){let e=new ib({definition:t.concat(r)});this.possibleTokTypes=i6(e),this.found=!0}}}class sO extends iH{constructor(e,t){super(),this.topRule=e,this.occurrence=t,this.result={token:void 0,occurrence:void 0,isEndOfRule:void 0}}startWalking(){return this.walk(this.topRule),this.result}}class sS extends sO{walkMany(e,t,r){if(e.idx===this.occurrence){let e=oA(t.concat(r));this.result.isEndOfRule=void 0===e,e instanceof iN&&(this.result.token=e.terminalType,this.result.occurrence=e.idx)}else super.walkMany(e,t,r)}}class sL extends sO{walkManySep(e,t,r){if(e.idx===this.occurrence){let e=oA(t.concat(r));this.result.isEndOfRule=void 0===e,e instanceof iN&&(this.result.token=e.terminalType,this.result.occurrence=e.idx)}else super.walkManySep(e,t,r)}}class sk extends sO{walkAtLeastOne(e,t,r){if(e.idx===this.occurrence){let e=oA(t.concat(r));this.result.isEndOfRule=void 0===e,e instanceof iN&&(this.result.token=e.terminalType,this.result.occurrence=e.idx)}else super.walkAtLeastOne(e,t,r)}}class sN extends sO{walkAtLeastOneSep(e,t,r){if(e.idx===this.occurrence){let e=oA(t.concat(r));this.result.isEndOfRule=void 0===e,e instanceof iN&&(this.result.token=e.terminalType,this.result.occurrence=e.idx)}else super.walkAtLeastOneSep(e,t,r)}}function sC(e,t,r=[]){r=r8(r);let n=[],i=0;function o(o){let s=sC(o.concat(ii(e,i+1)),t,r);return n.concat(s)}for(;r.length<t&&i<e.length;){let t=e[i];if(t instanceof ib||t instanceof iA)return o(t.definition);if(t instanceof iR)n=o(t.definition);else if(t instanceof iw)return o(t.definition.concat([new iS({definition:t.definition})]));else if(t instanceof iO)return o([new ib({definition:t.definition}),new iS({definition:[new iN({terminalType:t.separator})].concat(t.definition)})]);else if(t instanceof iL)n=o(t.definition.concat([new iS({definition:[new iN({terminalType:t.separator})].concat(t.definition)})]));else if(t instanceof iS)n=o(t.definition.concat([new iS({definition:t.definition})]));else if(t instanceof ik)return r7(t.definition,e=>{!1===nT(e.definition)&&(n=o(e.definition))}),n;else if(t instanceof iN)r.push(t.terminalType);else throw Error("non exhaustive match");i++}return n.push({partialPath:r,suffixDef:ii(e,i)}),n}function sI(e,t,r,n){let i="EXIT_NONE_TERMINAL",o=[i],s="EXIT_ALTERNATIVE",a=!1,l=t.length,c=l-n-1,u=[],h=[];for(h.push({idx:-1,def:e,ruleStack:[],occurrenceStack:[]});!nT(h);){let e=h.pop();if(e===s){a&&o0(h).idx<=c&&h.pop();continue}let n=e.def,d=e.idx,f=e.ruleStack,p=e.occurrenceStack;if(nT(n))continue;let g=n[0];if(g===i){let e={idx:d,def:ii(n),ruleStack:sy(f),occurrenceStack:sy(p)};h.push(e)}else if(g instanceof iN){if(d<l-1){let e=d+1;if(r(t[e],g.terminalType)){let t={idx:e,def:ii(n),ruleStack:f,occurrenceStack:p};h.push(t)}}else if(d===l-1)u.push({nextTokenType:g.terminalType,nextTokenOccurrence:g.idx,ruleStack:f,occurrenceStack:p}),a=!0;else throw Error("non exhaustive match")}else if(g instanceof iA){let e=r8(f);e.push(g.nonTerminalName);let t=r8(p);t.push(g.idx);let r={idx:d,def:g.definition.concat(o,ii(n)),ruleStack:e,occurrenceStack:t};h.push(r)}else if(g instanceof iR){let e={idx:d,def:ii(n),ruleStack:f,occurrenceStack:p};h.push(e),h.push(s);let t={idx:d,def:g.definition.concat(ii(n)),ruleStack:f,occurrenceStack:p};h.push(t)}else if(g instanceof iw){let e=new iS({definition:g.definition,idx:g.idx}),t={idx:d,def:g.definition.concat([e],ii(n)),ruleStack:f,occurrenceStack:p};h.push(t)}else if(g instanceof iO){let e=new iS({definition:[new iN({terminalType:g.separator})].concat(g.definition),idx:g.idx}),t={idx:d,def:g.definition.concat([e],ii(n)),ruleStack:f,occurrenceStack:p};h.push(t)}else if(g instanceof iL){let e={idx:d,def:ii(n),ruleStack:f,occurrenceStack:p};h.push(e),h.push(s);let t=new iS({definition:[new iN({terminalType:g.separator})].concat(g.definition),idx:g.idx}),r={idx:d,def:g.definition.concat([t],ii(n)),ruleStack:f,occurrenceStack:p};h.push(r)}else if(g instanceof iS){let e={idx:d,def:ii(n),ruleStack:f,occurrenceStack:p};h.push(e),h.push(s);let t=new iS({definition:g.definition,idx:g.idx}),r={idx:d,def:g.definition.concat([t],ii(n)),ruleStack:f,occurrenceStack:p};h.push(r)}else if(g instanceof ik)for(let e=g.definition.length-1;e>=0;e--){let t={idx:d,def:g.definition[e].definition.concat(ii(n)),ruleStack:f,occurrenceStack:p};h.push(t),h.push(s)}else if(g instanceof ib)h.push({idx:d,def:g.definition.concat(ii(n)),ruleStack:f,occurrenceStack:p});else if(g instanceof iv)h.push(function(e,t,r,n){let i=r8(r);i.push(e.name);let o=r8(n);return o.push(1),{idx:t,def:e.definition,ruleStack:i,occurrenceStack:o}}(g,d,f,p));else throw Error("non exhaustive match")}return u}function sx(e){if(e instanceof iR||"Option"===e)return F.OPTION;if(e instanceof iS||"Repetition"===e)return F.REPETITION;if(e instanceof iw||"RepetitionMandatory"===e)return F.REPETITION_MANDATORY;if(e instanceof iO||"RepetitionMandatoryWithSeparator"===e)return F.REPETITION_MANDATORY_WITH_SEPARATOR;if(e instanceof iL||"RepetitionWithSeparator"===e)return F.REPETITION_WITH_SEPARATOR;if(e instanceof ik||"Alternation"===e)return F.ALTERNATION;throw Error("non exhaustive match")}function sM(e,t,r,n){let i=e.length,o=iM(e,e=>iM(e,e=>1===e.length));if(t)return function(t){let n=nq(t,e=>e.GATE);for(let t=0;t<i;t++){let i=e[t],o=i.length,s=n[t];if(void 0===s||!1!==s.call(this))t:for(let e=0;e<o;e++){let n=i[e],o=n.length;for(let e=0;e<o;e++)if(!1===r(this.LA(e+1),n[e]))continue t;return t}}};if(!o||n)return function(){for(let t=0;t<i;t++){let n=e[t],i=n.length;t:for(let e=0;e<i;e++){let i=n[e],o=i.length;for(let e=0;e<o;e++)if(!1===r(this.LA(e+1),i[e]))continue t;return t}}};{let t=oO(nq(e,e=>iJ(e)),(e,t,r)=>(r7(t,t=>{ny(e,t.tokenTypeIdx)||(e[t.tokenTypeIdx]=r),r7(t.categoryMatches,t=>{ny(e,t)||(e[t]=r)})}),e),{});return function(){return t[this.LA(1).tokenTypeIdx]}}}function sU(e,t,r){let n=iM(e,e=>1===e.length),i=e.length;if(!n||r)return function(){t:for(let r=0;r<i;r++){let n=e[r],i=n.length;for(let e=0;e<i;e++)if(!1===t(this.LA(e+1),n[e]))continue t;return!0}return!1};{let t=iJ(e);if(1===t.length&&nT(t[0].categoryMatches)){let e=t[0].tokenTypeIdx;return function(){return this.LA(1).tokenTypeIdx===e}}{let e=oO(t,(e,t,r)=>(e[t.tokenTypeIdx]=!0,r7(t.categoryMatches,t=>{e[t]=!0}),e),[]);return function(){return!0===e[this.LA(1).tokenTypeIdx]}}}}(y=F||(F={}))[y.OPTION=0]="OPTION",y[y.REPETITION=1]="REPETITION",y[y.REPETITION_MANDATORY=2]="REPETITION_MANDATORY",y[y.REPETITION_MANDATORY_WITH_SEPARATOR=3]="REPETITION_MANDATORY_WITH_SEPARATOR",y[y.REPETITION_WITH_SEPARATOR=4]="REPETITION_WITH_SEPARATOR",y[y.ALTERNATION=5]="ALTERNATION";class sP extends iH{constructor(e,t,r){super(),this.topProd=e,this.targetOccurrence=t,this.targetProdType=r}startWalking(){return this.walk(this.topProd),this.restDef}checkIsTarget(e,t,r,n){return e.idx===this.targetOccurrence&&this.targetProdType===t&&(this.restDef=r.concat(n),!0)}walkOption(e,t,r){this.checkIsTarget(e,F.OPTION,t,r)||super.walkOption(e,t,r)}walkAtLeastOne(e,t,r){this.checkIsTarget(e,F.REPETITION_MANDATORY,t,r)||super.walkOption(e,t,r)}walkAtLeastOneSep(e,t,r){this.checkIsTarget(e,F.REPETITION_MANDATORY_WITH_SEPARATOR,t,r)||super.walkOption(e,t,r)}walkMany(e,t,r){this.checkIsTarget(e,F.REPETITION,t,r)||super.walkOption(e,t,r)}walkManySep(e,t,r){this.checkIsTarget(e,F.REPETITION_WITH_SEPARATOR,t,r)||super.walkOption(e,t,r)}}class sD extends iC{constructor(e,t,r){super(),this.targetOccurrence=e,this.targetProdType=t,this.targetRef=r,this.result=[]}checkIsTarget(e,t){e.idx===this.targetOccurrence&&this.targetProdType===t&&(void 0===this.targetRef||e===this.targetRef)&&(this.result=e.definition)}visitOption(e){this.checkIsTarget(e,F.OPTION)}visitRepetition(e){this.checkIsTarget(e,F.REPETITION)}visitRepetitionMandatory(e){this.checkIsTarget(e,F.REPETITION_MANDATORY)}visitRepetitionMandatoryWithSeparator(e){this.checkIsTarget(e,F.REPETITION_MANDATORY_WITH_SEPARATOR)}visitRepetitionWithSeparator(e){this.checkIsTarget(e,F.REPETITION_WITH_SEPARATOR)}visitAlternation(e){this.checkIsTarget(e,F.ALTERNATION)}}function sB(e){let t=Array(e);for(let r=0;r<e;r++)t[r]=[];return t}function sF(e){let t=[""];for(let r=0;r<e.length;r++){let n=e[r],i=[];for(let e=0;e<t.length;e++){let r=t[e];i.push(r+"_"+n.tokenTypeIdx);for(let e=0;e<n.categoryMatches.length;e++){let t="_"+n.categoryMatches[e];i.push(r+t)}}t=i}return t}function sj(e,t){let r=nq(e,e=>sC([e],1)),n=sB(r.length),i=nq(r,e=>{let t={};return r7(e,e=>{r7(sF(e.partialPath),e=>{t[e]=!0})}),t}),o=r;for(let e=1;e<=t;e++){let r=o;o=sB(r.length);for(let s=0;s<r.length;s++){let a=r[s];for(let r=0;r<a.length;r++){let l=a[r].partialPath,c=a[r].suffixDef,u=sF(l);if(function(e,t,r){for(let n=0;n<e.length;n++){if(n===r)continue;let i=e[n];for(let e=0;e<t.length;e++)if(!0===i[t[e]])return!1}return!0}(i,u,s)||nT(c)||l.length===t){let e=n[s];if(!1===sK(e,l)){e.push(l);for(let e=0;e<u.length;e++){let t=u[e];i[s][t]=!0}}}else{let t=sC(c,e+1,l);o[s]=o[s].concat(t),r7(t,e=>{r7(sF(e.partialPath),e=>{i[s][e]=!0})})}}}}return n}function s$(e,t,r,n){let i=new sD(e,F.ALTERNATION,n);return t.accept(i),sj(i.result,r)}function sG(e,t,r,n){let i=new sD(e,r);t.accept(i);let o=i.result,s=new sP(t,e,r).startWalking();return sj([new ib({definition:o}),new ib({definition:s})],n)}function sK(e,t){r:for(let r=0;r<e.length;r++){let n=e[r];if(n.length===t.length){for(let e=0;e<n.length;e++){let r=t[e],i=n[e];if(!1==(r===i||void 0!==i.categoryMatchesMap[r.tokenTypeIdx]))continue r}return!0}}return!1}function sW(e){return iM(e,e=>iM(e,e=>iM(e,e=>nT(e.categoryMatches))))}function sH(e){return`${iW(e)}_#_${e.idx}_#_${sY(e)}`}function sY(e){return e instanceof iN?e.terminalType.name:e instanceof iA?e.nonTerminalName:""}class sV extends iC{constructor(){super(...arguments),this.allProductions=[]}visitNonTerminal(e){this.allProductions.push(e)}visitOption(e){this.allProductions.push(e)}visitRepetitionWithSeparator(e){this.allProductions.push(e)}visitRepetitionMandatory(e){this.allProductions.push(e)}visitRepetitionMandatoryWithSeparator(e){this.allProductions.push(e)}visitRepetition(e){this.allProductions.push(e)}visitAlternation(e){this.allProductions.push(e)}visitTerminal(e){this.allProductions.push(e)}}class sz extends iC{constructor(){super(...arguments),this.alternations=[]}visitAlternation(e){this.alternations.push(e)}}class sq extends iC{constructor(){super(...arguments),this.allProductions=[]}visitRepetitionWithSeparator(e){this.allProductions.push(e)}visitRepetitionMandatory(e){this.allProductions.push(e)}visitRepetitionMandatoryWithSeparator(e){this.allProductions.push(e)}visitRepetition(e){this.allProductions.push(e)}}let sJ="MismatchedTokenException",sX="NoViableAltException",sQ="EarlyExitException",sZ="NotAllInputParsedException",s0=[sJ,sX,sQ,sZ];function s1(e){return ij(s0,e.name)}Object.freeze(s0);class s2 extends Error{constructor(e,t){super(e),this.token=t,this.resyncedTokens=[],Object.setPrototypeOf(this,new.target.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor)}}class s6 extends s2{constructor(e,t,r){super(e,t),this.previousToken=r,this.name=sJ}}class s8 extends s2{constructor(e,t,r){super(e,t),this.previousToken=r,this.name=sX}}class s3 extends s2{constructor(e,t){super(e,t),this.name=sZ}}class s5 extends s2{constructor(e,t,r){super(e,t),this.previousToken=r,this.name=sQ}}let s4={},s7="InRuleRecoveryException";class s9 extends Error{constructor(e){super(e),this.name=s7}}function ae(e,t,r,n,i,o,s){let a=this.getKeyForAutomaticLookahead(n,i),l=this.firstAfterRepMap[a];if(void 0===l){let e=this.getCurrRuleFullName();l=new o(this.getGAstProductions()[e],i).startWalking(),this.firstAfterRepMap[a]=l}let c=l.token,u=l.occurrence,h=l.isEndOfRule;1===this.RULE_STACK.length&&h&&void 0===c&&(c=sd,u=1),void 0!==c&&void 0!==u&&this.shouldInRepetitionRecoveryBeTried(c,u,s)&&this.tryInRepetitionRecovery(e,t,r,c)}class at{constructor(e){var t;this.maxLookahead=null!==(t=null==e?void 0:e.maxLookahead)&&void 0!==t?t:am.maxLookahead}validate(e){let t=this.validateNoLeftRecursion(e.rules);return nT(t)?[...t,...this.validateEmptyOrAlternatives(e.rules),...this.validateAmbiguousAlternationAlternatives(e.rules,this.maxLookahead),...this.validateSomeNonEmptyLookaheadPath(e.rules,this.maxLookahead)]:t}validateNoLeftRecursion(e){return s_(e,e=>(function e(t,r,n,i=[]){let o=[],s=function e(t){let r=[];if(nT(t))return r;let n=oA(t);if(n instanceof iA)r.push(n.referencedRule);else if(n instanceof ib||n instanceof iR||n instanceof iw||n instanceof iO||n instanceof iL||n instanceof iS)r=r.concat(e(n.definition));else if(n instanceof ik)r=iJ(nq(n.definition,t=>e(t.definition)));else if(n instanceof iN);else throw Error("non exhaustive match");let i=iK(n),o=t.length>1;if(!i||!o)return r;{let n=ii(t);return r.concat(e(n))}}(r.definition);if(nT(s))return[];{let r=t.name;ij(s,t)&&o.push({message:n.buildLeftRecursionError({topLevelRule:t,leftRecursionPath:i}),type:$.LEFT_RECURSION,ruleName:r});let a=s_(om(s,i.concat([t])),r=>{let o=r8(i);return o.push(r),e(t,r,n,o)});return o.concat(a)}})(e,e,sm))}validateEmptyOrAlternatives(e){return s_(e,e=>(function(e,t){let r=new sz;return e.accept(r),s_(r.alternations,r=>s_(sy(r.definition),(n,i)=>nT(sI([n],[],o1,1))?[{message:t.buildEmptyAlternationError({topLevelRule:e,alternation:r,emptyChoiceIdx:i}),type:$.NONE_LAST_EMPTY_ALT,ruleName:e.name,occurrence:r.idx,alternative:i+1}]:[]))})(e,sm))}validateAmbiguousAlternationAlternatives(e,t){return s_(e,e=>(function(e,t,r){let n=new sz;e.accept(n);let i=n.alternations;return s_(i=oL(i,e=>!0===e.ignoreAmbiguities),n=>{let i=s$(n.idx,e,n.maxLookahead||t,n),o=function(e,t,r,n){let i=[];return nq(oO(e,(r,n,o)=>(!0===t.definition[o].ignoreAmbiguities||r7(n,n=>{let s=[o];r7(e,(e,r)=>{o!==r&&sK(e,n)&&!0!==t.definition[r].ignoreAmbiguities&&s.push(r)}),s.length>1&&!sK(i,n)&&(i.push(n),r.push({alts:s,path:n}))}),r),[]),e=>{let i=nq(e.alts,e=>e+1);return{message:n.buildAlternationAmbiguityError({topLevelRule:r,alternation:t,ambiguityIndices:i,prefixPath:e.path}),type:$.AMBIGUOUS_ALTS,ruleName:r.name,occurrence:t.idx,alternatives:e.alts}})}(i,n,e,r),s=function(e,t,r,n){let i=oO(e,(e,t,r)=>{let n=nq(t,e=>({idx:r,path:e}));return e.concat(n)},[]);return ou(s_(i,e=>{if(!0===t.definition[e.idx].ignoreAmbiguities)return[];let o=e.idx,s=e.path;return nq(oy(i,e=>{var r;return!0!==t.definition[e.idx].ignoreAmbiguities&&e.idx<o&&(r=e.path).length<s.length&&iM(r,(e,t)=>{let r=s[t];return e===r||r.categoryMatchesMap[e.tokenTypeIdx]})}),e=>{let i=[e.idx+1,o+1],s=0===t.idx?"":t.idx;return{message:n.buildAlternationPrefixAmbiguityError({topLevelRule:r,alternation:t,ambiguityIndices:i,prefixPath:e.path}),type:$.AMBIGUOUS_PREFIX_ALTS,ruleName:r.name,occurrence:s,alternatives:i}})}))}(i,n,e,r);return o.concat(s)})})(e,t,sm))}validateSomeNonEmptyLookaheadPath(e,t){return function(e,t,r){let n=[];return r7(e,e=>{let i=new sq;e.accept(i),r7(i.allProductions,i=>{let o=sx(i),s=i.maxLookahead||t;if(nT(iJ(sG(i.idx,e,o,s)[0]))){let t=r.buildEmptyRepetitionError({topLevelRule:e,repetition:i});n.push({message:t,type:$.NO_NON_EMPTY_LOOKAHEAD,ruleName:e.name})}})}),n}(e,t,sm)}buildLookaheadForAlternation(e){return function(e,t,r,n,i,o){let s=s$(e,t,r),a=sW(s)?o2:o1;return o(s,n,a,i)}(e.prodOccurrence,e.rule,e.maxLookahead,e.hasPredicates,e.dynamicTokensEnabled,sM)}buildLookaheadForOptional(e){return function(e,t,r,n,i,o){let s=sG(e,t,i,r),a=sW(s)?o2:o1;return o(s[0],a,n)}(e.prodOccurrence,e.rule,e.maxLookahead,e.dynamicTokensEnabled,sx(e.prodType),sU)}}let ar=new class extends iC{constructor(){super(...arguments),this.dslMethods={option:[],alternation:[],repetition:[],repetitionWithSeparator:[],repetitionMandatory:[],repetitionMandatoryWithSeparator:[]}}reset(){this.dslMethods={option:[],alternation:[],repetition:[],repetitionWithSeparator:[],repetitionMandatory:[],repetitionMandatoryWithSeparator:[]}}visitOption(e){this.dslMethods.option.push(e)}visitRepetitionWithSeparator(e){this.dslMethods.repetitionWithSeparator.push(e)}visitRepetitionMandatory(e){this.dslMethods.repetitionMandatory.push(e)}visitRepetitionMandatoryWithSeparator(e){this.dslMethods.repetitionMandatoryWithSeparator.push(e)}visitRepetition(e){this.dslMethods.repetition.push(e)}visitAlternation(e){this.dslMethods.alternation.push(e)}};function an(e,t){!0===isNaN(e.startOffset)?(e.startOffset=t.startOffset,e.endOffset=t.endOffset):e.endOffset<t.endOffset==!0&&(e.endOffset=t.endOffset)}function ai(e,t){!0===isNaN(e.startOffset)?(e.startOffset=t.startOffset,e.startColumn=t.startColumn,e.startLine=t.startLine,e.endOffset=t.endOffset,e.endColumn=t.endColumn,e.endLine=t.endLine):e.endOffset<t.endOffset==!0&&(e.endOffset=t.endOffset,e.endColumn=t.endColumn,e.endLine=t.endLine)}function ao(e,t){Object.defineProperty(e,"name",{enumerable:!1,configurable:!0,writable:!1,value:t})}function as(e,t){let r=rr(e),n=r.length;for(let i=0;i<n;i++){let n=e[r[i]],o=n.length;for(let e=0;e<o;e++){let r=n[e];void 0===r.tokenTypeIdx&&this[r.name](r.children,t)}}}(_=j||(j={}))[_.REDUNDANT_METHOD=0]="REDUNDANT_METHOD",_[_.MISSING_METHOD=1]="MISSING_METHOD";let aa={description:"This Object indicates the Parser is during Recording Phase"};Object.freeze(aa);let al=sh({name:"RECORDING_PHASE_TOKEN",pattern:se.NA});o3([al]);let ac=sf(al,"This IToken indicates the Parser is in Recording Phase\n	See: https://chevrotain.io/docs/guide/internals.html#grammar-recording for details",-1,-1,-1,-1,-1,-1);Object.freeze(ac);let au={name:"This CSTNode indicates the Parser is in Recording Phase\n	See: https://chevrotain.io/docs/guide/internals.html#grammar-recording for details",children:{}};function ah(e,t,r,n=!1){ap(r);let i=o0(this.recordingProdStack),o=tp(t)?t:t.DEF,s=new e({definition:[],idx:r});return n&&(s.separator=t.SEP),ny(t,"MAX_LOOKAHEAD")&&(s.maxLookahead=t.MAX_LOOKAHEAD),this.recordingProdStack.push(s),o.call(this),i.definition.push(s),this.recordingProdStack.pop(),aa}function ad(e,t){ap(t);let r=o0(this.recordingProdStack),n=!1===tV(e),i=!1===n?e:e.DEF,o=new ik({definition:[],idx:t,ignoreAmbiguities:n&&!0===e.IGNORE_AMBIGUITIES});ny(e,"MAX_LOOKAHEAD")&&(o.maxLookahead=e.MAX_LOOKAHEAD);let s=iG(i,e=>tp(e.GATE));return o.hasPredicates=s,r.definition.push(o),r7(i,e=>{let t=new ib({definition:[]});o.definition.push(t),ny(e,"IGNORE_AMBIGUITIES")?t.ignoreAmbiguities=e.IGNORE_AMBIGUITIES:ny(e,"GATE")&&(t.ignoreAmbiguities=!0),this.recordingProdStack.push(t),e.ALT.call(this),this.recordingProdStack.pop()}),aa}function af(e){return 0===e?"":`${e}`}function ap(e){if(e<0||e>255){let t=Error(`Invalid DSL Method idx value: <${e}>
	Idx value must be a none negative value smaller than 256`);throw t.KNOWN_RECORDER_ERROR=!0,t}}let ag=sf(sd,"",NaN,NaN,NaN,NaN,NaN,NaN);Object.freeze(ag);let am=Object.freeze({recoveryEnabled:!1,maxLookahead:3,dynamicTokensEnabled:!1,outputCst:!0,errorMessageProvider:sp,nodeLocationTracking:"none",traceInitPerf:!1,skipValidations:!1}),aE=Object.freeze({recoveryValueFunc:()=>void 0,resyncEnabled:!0});(T=$||($={}))[T.INVALID_RULE_NAME=0]="INVALID_RULE_NAME",T[T.DUPLICATE_RULE_NAME=1]="DUPLICATE_RULE_NAME",T[T.INVALID_RULE_OVERRIDE=2]="INVALID_RULE_OVERRIDE",T[T.DUPLICATE_PRODUCTIONS=3]="DUPLICATE_PRODUCTIONS",T[T.UNRESOLVED_SUBRULE_REF=4]="UNRESOLVED_SUBRULE_REF",T[T.LEFT_RECURSION=5]="LEFT_RECURSION",T[T.NONE_LAST_EMPTY_ALT=6]="NONE_LAST_EMPTY_ALT",T[T.AMBIGUOUS_ALTS=7]="AMBIGUOUS_ALTS",T[T.CONFLICT_TOKENS_RULES_NAMESPACE=8]="CONFLICT_TOKENS_RULES_NAMESPACE",T[T.INVALID_TOKEN_NAME=9]="INVALID_TOKEN_NAME",T[T.NO_NON_EMPTY_LOOKAHEAD=10]="NO_NON_EMPTY_LOOKAHEAD",T[T.AMBIGUOUS_PREFIX_ALTS=11]="AMBIGUOUS_PREFIX_ALTS",T[T.TOO_MANY_ALTS=12]="TOO_MANY_ALTS",T[T.CUSTOM_LOOKAHEAD_VALIDATION=13]="CUSTOM_LOOKAHEAD_VALIDATION";class ay{static performSelfAnalysis(e){throw Error("The **static** `performSelfAnalysis` method has been deprecated.	\nUse the **instance** method with the same name instead.")}performSelfAnalysis(){this.TRACE_INIT("performSelfAnalysis",()=>{let e;this.selfAnalysisDone=!0;let t=this.className;this.TRACE_INIT("toFastProps",()=>{n0(this)}),this.TRACE_INIT("Grammar Recording",()=>{try{this.enableRecording(),r7(this.definedRulesNames,e=>{let t;let r=this[e].originalGrammarAction;this.TRACE_INIT(`${e} Rule`,()=>{t=this.topLevelRuleRecord(e,r)}),this.gastProductionsCache[e]=t})}finally{this.disableRecording()}});let r=[];if(this.TRACE_INIT("Grammar Resolving",()=>{r=function(e){let t=of(e,{errMsgProvider:sg}),r={};return r7(e.rules,e=>{r[e.name]=e}),function(e,t){let r=new sE(e,t);return r.resolveRefs(),r.errors}(r,t.errMsgProvider)}({rules:nJ(this.gastProductionsCache)}),this.definitionErrors=this.definitionErrors.concat(r)}),this.TRACE_INIT("Grammar Validations",()=>{if(nT(r)&&!1===this.skipValidations){var e,n;let r=function(e,t,r,n){let i=s_(e,e=>(function(e,t){let r=new sV;return e.accept(r),nq(nJ(i_(sb(r.allProductions,sH),e=>e.length>1)),r=>{let n=oA(r),i=t.buildDuplicateFoundError(e,r),o=iW(n),s={message:i,type:$.DUPLICATE_PRODUCTIONS,ruleName:e.name,dslName:o,occurrence:n.idx},a=sY(n);return a&&(s.parameter=a),s})})(e,r)),o=function(e,t,r){let n=[],i=nq(t,e=>e.name);return r7(e,e=>{let t=e.name;if(ij(i,t)){let i=r.buildNamespaceConflictError(e);n.push({message:i,type:$.CONFLICT_TOKENS_RULES_NAMESPACE,ruleName:t})}}),n}(e,t,r),s=s_(e,e=>(function(e,t){let r=new sz;return e.accept(r),s_(r.alternations,r=>r.definition.length>255?[{message:t.buildTooManyAlternativesError({topLevelRule:e,alternation:r}),type:$.TOO_MANY_ALTS,ruleName:e.name,occurrence:r.idx}]:[])})(e,r)),a=s_(e,t=>(function(e,t,r,n){let i=[];if(oO(t,(t,r)=>r.name===e.name?t+1:t,0)>1){let t=n.buildDuplicateRuleNameError({topLevelRule:e,grammarName:r});i.push({message:t,type:$.DUPLICATE_RULE_NAME,ruleName:e.name})}return i})(t,e,n,r));return i.concat(o,s,a)}((e=of(e={rules:nJ(this.gastProductionsCache),tokenTypes:nJ(this.tokensMap),errMsgProvider:sm,grammarName:t},{errMsgProvider:sm})).rules,e.tokenTypes,e.errMsgProvider,e.grammarName),i=nq((n={lookaheadStrategy:this.lookaheadStrategy,rules:nJ(this.gastProductionsCache),tokenTypes:nJ(this.tokensMap),grammarName:t}).lookaheadStrategy.validate({rules:n.rules,tokenTypes:n.tokenTypes,grammarName:n.grammarName}),e=>Object.assign({type:$.CUSTOM_LOOKAHEAD_VALIDATION},e));this.definitionErrors=this.definitionErrors.concat(r,i)}}),nT(this.definitionErrors)&&(this.recoveryEnabled&&this.TRACE_INIT("computeAllProdsFollows",()=>{let e=function(e){let t={};return r7(e,e=>{id(t,new i3(e).startWalking())}),t}(nJ(this.gastProductionsCache));this.resyncFollows=e}),this.TRACE_INIT("ComputeLookaheadFunctions",()=>{var e,t;null===(t=(e=this.lookaheadStrategy).initialize)||void 0===t||t.call(e,{rules:nJ(this.gastProductionsCache)}),this.preComputeLookaheadFunctions(nJ(this.gastProductionsCache))})),!ay.DEFER_DEFINITION_ERRORS_HANDLING&&!nT(this.definitionErrors))throw e=nq(this.definitionErrors,e=>e.message),Error(`Parser Definition Errors detected:
 ${e.join("\n-------------------------------\n")}`)})}constructor(e,t){if(this.definitionErrors=[],this.selfAnalysisDone=!1,this.initErrorHandler(t),this.initLexerAdapter(),this.initLooksAhead(t),this.initRecognizerEngine(e,t),this.initRecoverable(t),this.initTreeBuilder(t),this.initContentAssist(),this.initGastRecorder(t),this.initPerformanceTracer(t),ny(t,"ignoredIssues"))throw Error("The <ignoredIssues> IParserConfig property has been deprecated.\n	Please use the <IGNORE_AMBIGUITIES> flag on the relevant DSL method instead.\n	See: https://chevrotain.io/docs/guide/resolving_grammar_errors.html#IGNORING_AMBIGUITIES\n	For further details.");this.skipValidations=ny(t,"skipValidations")?t.skipValidations:am.skipValidations}}ay.DEFER_DEFINITION_ERRORS_HANDLING=!1,function(e,t){t.forEach(t=>{let r=t.prototype;Object.getOwnPropertyNames(r).forEach(n=>{if("constructor"===n)return;let i=Object.getOwnPropertyDescriptor(r,n);i&&(i.get||i.set)?Object.defineProperty(e.prototype,n,i):e.prototype[n]=t.prototype[n]})})}(ay,[class{initRecoverable(e){this.firstAfterRepMap={},this.resyncFollows={},this.recoveryEnabled=ny(e,"recoveryEnabled")?e.recoveryEnabled:am.recoveryEnabled,this.recoveryEnabled&&(this.attemptInRepetitionRecovery=ae)}getTokenToInsert(e){let t=sf(e,"",NaN,NaN,NaN,NaN,NaN,NaN);return t.isInsertedInRecovery=!0,t}canTokenTypeBeInsertedInRecovery(e){return!0}canTokenTypeBeDeletedInRecovery(e){return!0}tryInRepetitionRecovery(e,t,r,n){let i=this.findReSyncTokenType(),o=this.exportLexerState(),s=[],a=!1,l=this.LA(1),c=this.LA(1),u=()=>{let e=this.LA(0),t=new s6(this.errorMessageProvider.buildMismatchTokenMessage({expected:n,actual:l,previous:e,ruleName:this.getCurrRuleFullName()}),l,this.LA(0));t.resyncedTokens=sy(s),this.SAVE_ERROR(t)};for(;!a;){if(this.tokenMatcher(c,n)){u();return}if(r.call(this)){u(),e.apply(this,t);return}this.tokenMatcher(c,i)?a=!0:(c=this.SKIP_TOKEN(),this.addToResyncTokens(c,s))}this.importLexerState(o)}shouldInRepetitionRecoveryBeTried(e,t,r){return!(!1===r||this.tokenMatcher(this.LA(1),e)||this.isBackTracking()||this.canPerformInRuleRecovery(e,this.getFollowsForInRuleRecovery(e,t)))}getFollowsForInRuleRecovery(e,t){let r=this.getCurrentGrammarPath(e,t);return this.getNextPossibleTokenTypes(r)}tryInRuleRecovery(e,t){if(this.canRecoverWithSingleTokenInsertion(e,t))return this.getTokenToInsert(e);if(this.canRecoverWithSingleTokenDeletion(e)){let e=this.SKIP_TOKEN();return this.consumeToken(),e}throw new s9("sad sad panda")}canPerformInRuleRecovery(e,t){return this.canRecoverWithSingleTokenInsertion(e,t)||this.canRecoverWithSingleTokenDeletion(e)}canRecoverWithSingleTokenInsertion(e,t){if(!this.canTokenTypeBeInsertedInRecovery(e)||nT(t))return!1;let r=this.LA(1);return void 0!==oT(t,e=>this.tokenMatcher(r,e))}canRecoverWithSingleTokenDeletion(e){return!!this.canTokenTypeBeDeletedInRecovery(e)&&this.tokenMatcher(this.LA(2),e)}isInCurrentRuleReSyncSet(e){let t=this.getCurrFollowKey();return ij(this.getFollowSetFromFollowKey(t),e)}findReSyncTokenType(){let e=this.flattenFollowSet(),t=this.LA(1),r=2;for(;;){let n=oT(e,e=>o1(t,e));if(void 0!==n)return n;t=this.LA(r),r++}}getCurrFollowKey(){if(1===this.RULE_STACK.length)return s4;let e=this.getLastExplicitRuleShortName(),t=this.getLastExplicitRuleOccurrenceIndex(),r=this.getPreviousExplicitRuleShortName();return{ruleName:this.shortRuleNameToFullName(e),idxInCallingRule:t,inRule:this.shortRuleNameToFullName(r)}}buildFullFollowKeyStack(){let e=this.RULE_STACK,t=this.RULE_OCCURRENCE_STACK;return nq(e,(r,n)=>0===n?s4:{ruleName:this.shortRuleNameToFullName(r),idxInCallingRule:t[n],inRule:this.shortRuleNameToFullName(e[n-1])})}flattenFollowSet(){return iJ(nq(this.buildFullFollowKeyStack(),e=>this.getFollowSetFromFollowKey(e)))}getFollowSetFromFollowKey(e){if(e===s4)return[sd];let t=e.ruleName+e.idxInCallingRule+i8+e.inRule;return this.resyncFollows[t]}addToResyncTokens(e,t){return this.tokenMatcher(e,sd)||t.push(e),t}reSyncTo(e){let t=[],r=this.LA(1);for(;!1===this.tokenMatcher(r,e);)r=this.SKIP_TOKEN(),this.addToResyncTokens(r,t);return sy(t)}attemptInRepetitionRecovery(e,t,r,n,i,o,s){}getCurrentGrammarPath(e,t){return{ruleStack:this.getHumanReadableRuleStack(),occurrenceStack:r8(this.RULE_OCCURRENCE_STACK),lastTok:e,lastTokOccurrence:t}}getHumanReadableRuleStack(){return nq(this.RULE_STACK,e=>this.shortRuleNameToFullName(e))}},class{initLooksAhead(e){this.dynamicTokensEnabled=ny(e,"dynamicTokensEnabled")?e.dynamicTokensEnabled:am.dynamicTokensEnabled,this.maxLookahead=ny(e,"maxLookahead")?e.maxLookahead:am.maxLookahead,this.lookaheadStrategy=ny(e,"lookaheadStrategy")?e.lookaheadStrategy:new at({maxLookahead:this.maxLookahead}),this.lookAheadFuncsCache=new Map}preComputeLookaheadFunctions(e){r7(e,e=>{this.TRACE_INIT(`${e.name} Rule Lookahead`,()=>{let{alternation:t,repetition:r,option:n,repetitionMandatory:i,repetitionMandatoryWithSeparator:o,repetitionWithSeparator:s}=function(e){ar.reset(),e.accept(ar);let t=ar.dslMethods;return ar.reset(),t}(e);r7(t,t=>{let r=0===t.idx?"":t.idx;this.TRACE_INIT(`${iW(t)}${r}`,()=>{var r;let n=this.lookaheadStrategy.buildLookaheadForAlternation({prodOccurrence:t.idx,rule:e,maxLookahead:t.maxLookahead||this.maxLookahead,hasPredicates:t.hasPredicates,dynamicTokensEnabled:this.dynamicTokensEnabled}),i=(r=this.fullRuleNameToShort[e.name],256|t.idx|r);this.setLaFuncCache(i,n)})}),r7(r,t=>{this.computeLookaheadFunc(e,t.idx,768,"Repetition",t.maxLookahead,iW(t))}),r7(n,t=>{this.computeLookaheadFunc(e,t.idx,512,"Option",t.maxLookahead,iW(t))}),r7(i,t=>{this.computeLookaheadFunc(e,t.idx,1024,"RepetitionMandatory",t.maxLookahead,iW(t))}),r7(o,t=>{this.computeLookaheadFunc(e,t.idx,1536,"RepetitionMandatoryWithSeparator",t.maxLookahead,iW(t))}),r7(s,t=>{this.computeLookaheadFunc(e,t.idx,1280,"RepetitionWithSeparator",t.maxLookahead,iW(t))})})})}computeLookaheadFunc(e,t,r,n,i,o){this.TRACE_INIT(`${o}${0===t?"":t}`,()=>{let o=this.lookaheadStrategy.buildLookaheadForOptional({prodOccurrence:t,rule:e,maxLookahead:i||this.maxLookahead,dynamicTokensEnabled:this.dynamicTokensEnabled,prodType:n}),s=t|r|this.fullRuleNameToShort[e.name];this.setLaFuncCache(s,o)})}getKeyForAutomaticLookahead(e,t){return t|e|this.getLastExplicitRuleShortName()}getLaFuncFromCache(e){return this.lookAheadFuncsCache.get(e)}setLaFuncCache(e,t){this.lookAheadFuncsCache.set(e,t)}},class{initTreeBuilder(e){if(this.CST_STACK=[],this.outputCst=e.outputCst,this.nodeLocationTracking=ny(e,"nodeLocationTracking")?e.nodeLocationTracking:am.nodeLocationTracking,this.outputCst){if(/full/i.test(this.nodeLocationTracking))this.recoveryEnabled?(this.setNodeLocationFromToken=ai,this.setNodeLocationFromNode=ai,this.cstPostRule=iZ,this.setInitialNodeLocation=this.setInitialNodeLocationFullRecovery):(this.setNodeLocationFromToken=iZ,this.setNodeLocationFromNode=iZ,this.cstPostRule=this.cstPostRuleFull,this.setInitialNodeLocation=this.setInitialNodeLocationFullRegular);else if(/onlyOffset/i.test(this.nodeLocationTracking))this.recoveryEnabled?(this.setNodeLocationFromToken=an,this.setNodeLocationFromNode=an,this.cstPostRule=iZ,this.setInitialNodeLocation=this.setInitialNodeLocationOnlyOffsetRecovery):(this.setNodeLocationFromToken=iZ,this.setNodeLocationFromNode=iZ,this.cstPostRule=this.cstPostRuleOnlyOffset,this.setInitialNodeLocation=this.setInitialNodeLocationOnlyOffsetRegular);else if(/none/i.test(this.nodeLocationTracking))this.setNodeLocationFromToken=iZ,this.setNodeLocationFromNode=iZ,this.cstPostRule=iZ,this.setInitialNodeLocation=iZ;else throw Error(`Invalid <nodeLocationTracking> config option: "${e.nodeLocationTracking}"`)}else this.cstInvocationStateUpdate=iZ,this.cstFinallyStateUpdate=iZ,this.cstPostTerminal=iZ,this.cstPostNonTerminal=iZ,this.cstPostRule=iZ}setInitialNodeLocationOnlyOffsetRecovery(e){e.location={startOffset:NaN,endOffset:NaN}}setInitialNodeLocationOnlyOffsetRegular(e){e.location={startOffset:this.LA(1).startOffset,endOffset:NaN}}setInitialNodeLocationFullRecovery(e){e.location={startOffset:NaN,startLine:NaN,startColumn:NaN,endOffset:NaN,endLine:NaN,endColumn:NaN}}setInitialNodeLocationFullRegular(e){let t=this.LA(1);e.location={startOffset:t.startOffset,startLine:t.startLine,startColumn:t.startColumn,endOffset:NaN,endLine:NaN,endColumn:NaN}}cstInvocationStateUpdate(e){let t={name:e,children:Object.create(null)};this.setInitialNodeLocation(t),this.CST_STACK.push(t)}cstFinallyStateUpdate(){this.CST_STACK.pop()}cstPostRuleFull(e){let t=this.LA(0),r=e.location;r.startOffset<=t.startOffset==!0?(r.endOffset=t.endOffset,r.endLine=t.endLine,r.endColumn=t.endColumn):(r.startOffset=NaN,r.startLine=NaN,r.startColumn=NaN)}cstPostRuleOnlyOffset(e){let t=this.LA(0),r=e.location;r.startOffset<=t.startOffset==!0?r.endOffset=t.endOffset:r.startOffset=NaN}cstPostTerminal(e,t){let r=this.CST_STACK[this.CST_STACK.length-1];void 0===r.children[e]?r.children[e]=[t]:r.children[e].push(t),this.setNodeLocationFromToken(r.location,t)}cstPostNonTerminal(e,t){let r=this.CST_STACK[this.CST_STACK.length-1];void 0===r.children[t]?r.children[t]=[e]:r.children[t].push(e),this.setNodeLocationFromNode(r.location,e.location)}getBaseCstVisitorConstructor(){if(i5(this.baseCstVisitorConstructor)){let e=function(e,t){let r=function(){};return ao(r,e+"BaseSemantics"),r.prototype={visit:function(e,t){if(tV(e)&&(e=e[0]),!i5(e))return this[e.name](e.children,t)},validateVisitor:function(){var e;let r=(e=this,ou(nq(oy(t,t=>!1===tp(e[t])),t=>({msg:`Missing visitor method: <${t}> on ${e.constructor.name} CST Visitor.`,type:j.MISSING_METHOD,methodName:t}))));if(!nT(r)){let e=nq(r,e=>e.msg);throw Error(`Errors Detected in CST Visitor <${this.constructor.name}>:
	${e.join("\n\n").replace(/\n/g,"\n	")}`)}}},r.prototype.constructor=r,r._RULE_NAMES=t,r}(this.className,rr(this.gastProductionsCache));return this.baseCstVisitorConstructor=e,e}return this.baseCstVisitorConstructor}getBaseCstVisitorConstructorWithDefaults(){if(i5(this.baseCstVisitorWithDefaultsConstructor)){let e=function(e,t,r){let n=function(){};ao(n,e+"BaseSemanticsWithDefaults");let i=Object.create(r.prototype);return r7(t,e=>{i[e]=as}),n.prototype=i,n.prototype.constructor=n,n}(this.className,rr(this.gastProductionsCache),this.getBaseCstVisitorConstructor());return this.baseCstVisitorWithDefaultsConstructor=e,e}return this.baseCstVisitorWithDefaultsConstructor}getLastExplicitRuleShortName(){let e=this.RULE_STACK;return e[e.length-1]}getPreviousExplicitRuleShortName(){let e=this.RULE_STACK;return e[e.length-2]}getLastExplicitRuleOccurrenceIndex(){let e=this.RULE_OCCURRENCE_STACK;return e[e.length-1]}},class{initLexerAdapter(){this.tokVector=[],this.tokVectorLength=0,this.currIdx=-1}set input(e){if(!0!==this.selfAnalysisDone)throw Error("Missing <performSelfAnalysis> invocation at the end of the Parser's constructor.");this.reset(),this.tokVector=e,this.tokVectorLength=e.length}get input(){return this.tokVector}SKIP_TOKEN(){return this.currIdx<=this.tokVector.length-2?(this.consumeToken(),this.LA(1)):ag}LA(e){let t=this.currIdx+e;return t<0||this.tokVectorLength<=t?ag:this.tokVector[t]}consumeToken(){this.currIdx++}exportLexerState(){return this.currIdx}importLexerState(e){this.currIdx=e}resetLexerState(){this.currIdx=-1}moveToTerminatedState(){this.currIdx=this.tokVector.length-1}getLexerPosition(){return this.exportLexerState()}},class{initRecognizerEngine(e,t){if(this.className=this.constructor.name,this.shortRuleNameToFull={},this.fullRuleNameToShort={},this.ruleShortNameIdx=256,this.tokenMatcher=o2,this.subruleIdx=0,this.definedRulesNames=[],this.tokensMap={},this.isBackTrackingStack=[],this.RULE_STACK=[],this.RULE_OCCURRENCE_STACK=[],this.gastProductionsCache={},ny(t,"serializedGrammar"))throw Error("The Parser's configuration can no longer contain a <serializedGrammar> property.\n	See: https://chevrotain.io/docs/changes/BREAKING_CHANGES.html#_6-0-0\n	For Further details.");if(tV(e)){if(nT(e))throw Error("A Token Vocabulary cannot be empty.\n	Note that the first argument for the parser constructor\n	is no longer a Token vector (since v4.0).");if("number"==typeof e[0].startOffset)throw Error("The Parser constructor no longer accepts a token vector as the first argument.\n	See: https://chevrotain.io/docs/changes/BREAKING_CHANGES.html#_4-0-0\n	For Further details.")}if(tV(e))this.tokensMap=oO(e,(e,t)=>(e[t.name]=t,e),{});else if(ny(e,"modes")&&iM(iJ(nJ(e.modes)),o7)){let t=i2(iJ(nJ(e.modes)));this.tokensMap=oO(t,(e,t)=>(e[t.name]=t,e),{})}else if(tf(e))this.tokensMap=r8(e);else throw Error("<tokensDictionary> argument must be An Array of Token constructors, A dictionary of Token constructors or an IMultiModeLexerDefinition");this.tokensMap.EOF=sd;let r=iM(ny(e,"modes")?iJ(nJ(e.modes)):nJ(e),e=>nT(e.categoryMatches));this.tokenMatcher=r?o2:o1,o3(nJ(this.tokensMap))}defineRule(e,t,r){if(this.selfAnalysisDone)throw Error(`Grammar rule <${e}> may not be defined after the 'performSelfAnalysis' method has been called'
Make sure that all grammar rule definitions are done before 'performSelfAnalysis' is called.`);let n=ny(r,"resyncEnabled")?r.resyncEnabled:aE.resyncEnabled,i=ny(r,"recoveryValueFunc")?r.recoveryValueFunc:aE.recoveryValueFunc,o=this.ruleShortNameIdx<<12;return this.ruleShortNameIdx++,this.shortRuleNameToFull[o]=e,this.fullRuleNameToShort[e]=o,Object.assign(!0===this.outputCst?function(...r){try{this.ruleInvocationStateUpdate(o,e,this.subruleIdx),t.apply(this,r);let n=this.CST_STACK[this.CST_STACK.length-1];return this.cstPostRule(n),n}catch(e){return this.invokeRuleCatch(e,n,i)}finally{this.ruleFinallyStateUpdate()}}:function(...r){try{return this.ruleInvocationStateUpdate(o,e,this.subruleIdx),t.apply(this,r)}catch(e){return this.invokeRuleCatch(e,n,i)}finally{this.ruleFinallyStateUpdate()}},{ruleName:e,originalGrammarAction:t})}invokeRuleCatch(e,t,r){let n=1===this.RULE_STACK.length,i=t&&!this.isBackTracking()&&this.recoveryEnabled;if(s1(e)){if(i){let t=this.findReSyncTokenType();if(this.isInCurrentRuleReSyncSet(t)){if(e.resyncedTokens=this.reSyncTo(t),!this.outputCst)return r(e);{let e=this.CST_STACK[this.CST_STACK.length-1];return e.recoveredNode=!0,e}}if(this.outputCst){let t=this.CST_STACK[this.CST_STACK.length-1];t.recoveredNode=!0,e.partialCstResult=t}throw e}if(n)return this.moveToTerminatedState(),r(e)}throw e}optionInternal(e,t){let r=this.getKeyForAutomaticLookahead(512,t);return this.optionInternalLogic(e,t,r)}optionInternalLogic(e,t,r){let n,i=this.getLaFuncFromCache(r);if("function"!=typeof e){n=e.DEF;let t=e.GATE;if(void 0!==t){let e=i;i=()=>t.call(this)&&e.call(this)}}else n=e;if(!0===i.call(this))return n.call(this)}atLeastOneInternal(e,t){let r=this.getKeyForAutomaticLookahead(1024,e);return this.atLeastOneInternalLogic(e,t,r)}atLeastOneInternalLogic(e,t,r){let n,i=this.getLaFuncFromCache(r);if("function"!=typeof t){n=t.DEF;let e=t.GATE;if(void 0!==e){let t=i;i=()=>e.call(this)&&t.call(this)}}else n=t;if(!0===i.call(this)){let e=this.doSingleRepetition(n);for(;!0===i.call(this)&&!0===e;)e=this.doSingleRepetition(n)}else throw this.raiseEarlyExitException(e,F.REPETITION_MANDATORY,t.ERR_MSG);this.attemptInRepetitionRecovery(this.atLeastOneInternal,[e,t],i,1024,e,sk)}atLeastOneSepFirstInternal(e,t){let r=this.getKeyForAutomaticLookahead(1536,e);this.atLeastOneSepFirstInternalLogic(e,t,r)}atLeastOneSepFirstInternalLogic(e,t,r){let n=t.DEF,i=t.SEP;if(!0===this.getLaFuncFromCache(r).call(this)){n.call(this);let t=()=>this.tokenMatcher(this.LA(1),i);for(;!0===this.tokenMatcher(this.LA(1),i);)this.CONSUME(i),n.call(this);this.attemptInRepetitionRecovery(this.repetitionSepSecondInternal,[e,i,t,n,sN],t,1536,e,sN)}else throw this.raiseEarlyExitException(e,F.REPETITION_MANDATORY_WITH_SEPARATOR,t.ERR_MSG)}manyInternal(e,t){let r=this.getKeyForAutomaticLookahead(768,e);return this.manyInternalLogic(e,t,r)}manyInternalLogic(e,t,r){let n,i=this.getLaFuncFromCache(r);if("function"!=typeof t){n=t.DEF;let e=t.GATE;if(void 0!==e){let t=i;i=()=>e.call(this)&&t.call(this)}}else n=t;let o=!0;for(;!0===i.call(this)&&!0===o;)o=this.doSingleRepetition(n);this.attemptInRepetitionRecovery(this.manyInternal,[e,t],i,768,e,sS,o)}manySepFirstInternal(e,t){let r=this.getKeyForAutomaticLookahead(1280,e);this.manySepFirstInternalLogic(e,t,r)}manySepFirstInternalLogic(e,t,r){let n=t.DEF,i=t.SEP;if(!0===this.getLaFuncFromCache(r).call(this)){n.call(this);let t=()=>this.tokenMatcher(this.LA(1),i);for(;!0===this.tokenMatcher(this.LA(1),i);)this.CONSUME(i),n.call(this);this.attemptInRepetitionRecovery(this.repetitionSepSecondInternal,[e,i,t,n,sL],t,1280,e,sL)}}repetitionSepSecondInternal(e,t,r,n,i){for(;r();)this.CONSUME(t),n.call(this);this.attemptInRepetitionRecovery(this.repetitionSepSecondInternal,[e,t,r,n,i],r,1536,e,i)}doSingleRepetition(e){let t=this.getLexerPosition();return e.call(this),this.getLexerPosition()>t}orInternal(e,t){let r=this.getKeyForAutomaticLookahead(256,t),n=tV(e)?e:e.DEF,i=this.getLaFuncFromCache(r).call(this,n);if(void 0!==i)return n[i].ALT.call(this);this.raiseNoAltException(t,e.ERR_MSG)}ruleFinallyStateUpdate(){if(this.RULE_STACK.pop(),this.RULE_OCCURRENCE_STACK.pop(),this.cstFinallyStateUpdate(),0===this.RULE_STACK.length&&!1===this.isAtEndOfInput()){let e=this.LA(1),t=this.errorMessageProvider.buildNotAllInputParsedMessage({firstRedundant:e,ruleName:this.getCurrRuleFullName()});this.SAVE_ERROR(new s3(t,e))}}subruleInternal(e,t,r){let n;try{let i=void 0!==r?r.ARGS:void 0;return this.subruleIdx=t,n=e.apply(this,i),this.cstPostNonTerminal(n,void 0!==r&&void 0!==r.LABEL?r.LABEL:e.ruleName),n}catch(t){throw this.subruleInternalError(t,r,e.ruleName)}}subruleInternalError(e,t,r){throw s1(e)&&void 0!==e.partialCstResult&&(this.cstPostNonTerminal(e.partialCstResult,void 0!==t&&void 0!==t.LABEL?t.LABEL:r),delete e.partialCstResult),e}consumeInternal(e,t,r){let n;try{let t=this.LA(1);!0===this.tokenMatcher(t,e)?(this.consumeToken(),n=t):this.consumeInternalError(e,t,r)}catch(r){n=this.consumeInternalRecovery(e,t,r)}return this.cstPostTerminal(void 0!==r&&void 0!==r.LABEL?r.LABEL:e.name,n),n}consumeInternalError(e,t,r){let n;let i=this.LA(0);throw n=void 0!==r&&r.ERR_MSG?r.ERR_MSG:this.errorMessageProvider.buildMismatchTokenMessage({expected:e,actual:t,previous:i,ruleName:this.getCurrRuleFullName()}),this.SAVE_ERROR(new s6(n,t,i))}consumeInternalRecovery(e,t,r){if(this.recoveryEnabled&&"MismatchedTokenException"===r.name&&!this.isBackTracking()){let n=this.getFollowsForInRuleRecovery(e,t);try{return this.tryInRuleRecovery(e,n)}catch(e){if(e.name===s7)throw r;throw e}}else throw r}saveRecogState(){let e=this.errors,t=r8(this.RULE_STACK);return{errors:e,lexerState:this.exportLexerState(),RULE_STACK:t,CST_STACK:this.CST_STACK}}reloadRecogState(e){this.errors=e.errors,this.importLexerState(e.lexerState),this.RULE_STACK=e.RULE_STACK}ruleInvocationStateUpdate(e,t,r){this.RULE_OCCURRENCE_STACK.push(r),this.RULE_STACK.push(e),this.cstInvocationStateUpdate(t)}isBackTracking(){return 0!==this.isBackTrackingStack.length}getCurrRuleFullName(){let e=this.getLastExplicitRuleShortName();return this.shortRuleNameToFull[e]}shortRuleNameToFullName(e){return this.shortRuleNameToFull[e]}isAtEndOfInput(){return this.tokenMatcher(this.LA(1),sd)}reset(){this.resetLexerState(),this.subruleIdx=0,this.isBackTrackingStack=[],this.errors=[],this.RULE_STACK=[],this.CST_STACK=[],this.RULE_OCCURRENCE_STACK=[]}},class{ACTION(e){return e.call(this)}consume(e,t,r){return this.consumeInternal(t,e,r)}subrule(e,t,r){return this.subruleInternal(t,e,r)}option(e,t){return this.optionInternal(t,e)}or(e,t){return this.orInternal(t,e)}many(e,t){return this.manyInternal(e,t)}atLeastOne(e,t){return this.atLeastOneInternal(e,t)}CONSUME(e,t){return this.consumeInternal(e,0,t)}CONSUME1(e,t){return this.consumeInternal(e,1,t)}CONSUME2(e,t){return this.consumeInternal(e,2,t)}CONSUME3(e,t){return this.consumeInternal(e,3,t)}CONSUME4(e,t){return this.consumeInternal(e,4,t)}CONSUME5(e,t){return this.consumeInternal(e,5,t)}CONSUME6(e,t){return this.consumeInternal(e,6,t)}CONSUME7(e,t){return this.consumeInternal(e,7,t)}CONSUME8(e,t){return this.consumeInternal(e,8,t)}CONSUME9(e,t){return this.consumeInternal(e,9,t)}SUBRULE(e,t){return this.subruleInternal(e,0,t)}SUBRULE1(e,t){return this.subruleInternal(e,1,t)}SUBRULE2(e,t){return this.subruleInternal(e,2,t)}SUBRULE3(e,t){return this.subruleInternal(e,3,t)}SUBRULE4(e,t){return this.subruleInternal(e,4,t)}SUBRULE5(e,t){return this.subruleInternal(e,5,t)}SUBRULE6(e,t){return this.subruleInternal(e,6,t)}SUBRULE7(e,t){return this.subruleInternal(e,7,t)}SUBRULE8(e,t){return this.subruleInternal(e,8,t)}SUBRULE9(e,t){return this.subruleInternal(e,9,t)}OPTION(e){return this.optionInternal(e,0)}OPTION1(e){return this.optionInternal(e,1)}OPTION2(e){return this.optionInternal(e,2)}OPTION3(e){return this.optionInternal(e,3)}OPTION4(e){return this.optionInternal(e,4)}OPTION5(e){return this.optionInternal(e,5)}OPTION6(e){return this.optionInternal(e,6)}OPTION7(e){return this.optionInternal(e,7)}OPTION8(e){return this.optionInternal(e,8)}OPTION9(e){return this.optionInternal(e,9)}OR(e){return this.orInternal(e,0)}OR1(e){return this.orInternal(e,1)}OR2(e){return this.orInternal(e,2)}OR3(e){return this.orInternal(e,3)}OR4(e){return this.orInternal(e,4)}OR5(e){return this.orInternal(e,5)}OR6(e){return this.orInternal(e,6)}OR7(e){return this.orInternal(e,7)}OR8(e){return this.orInternal(e,8)}OR9(e){return this.orInternal(e,9)}MANY(e){this.manyInternal(0,e)}MANY1(e){this.manyInternal(1,e)}MANY2(e){this.manyInternal(2,e)}MANY3(e){this.manyInternal(3,e)}MANY4(e){this.manyInternal(4,e)}MANY5(e){this.manyInternal(5,e)}MANY6(e){this.manyInternal(6,e)}MANY7(e){this.manyInternal(7,e)}MANY8(e){this.manyInternal(8,e)}MANY9(e){this.manyInternal(9,e)}MANY_SEP(e){this.manySepFirstInternal(0,e)}MANY_SEP1(e){this.manySepFirstInternal(1,e)}MANY_SEP2(e){this.manySepFirstInternal(2,e)}MANY_SEP3(e){this.manySepFirstInternal(3,e)}MANY_SEP4(e){this.manySepFirstInternal(4,e)}MANY_SEP5(e){this.manySepFirstInternal(5,e)}MANY_SEP6(e){this.manySepFirstInternal(6,e)}MANY_SEP7(e){this.manySepFirstInternal(7,e)}MANY_SEP8(e){this.manySepFirstInternal(8,e)}MANY_SEP9(e){this.manySepFirstInternal(9,e)}AT_LEAST_ONE(e){this.atLeastOneInternal(0,e)}AT_LEAST_ONE1(e){return this.atLeastOneInternal(1,e)}AT_LEAST_ONE2(e){this.atLeastOneInternal(2,e)}AT_LEAST_ONE3(e){this.atLeastOneInternal(3,e)}AT_LEAST_ONE4(e){this.atLeastOneInternal(4,e)}AT_LEAST_ONE5(e){this.atLeastOneInternal(5,e)}AT_LEAST_ONE6(e){this.atLeastOneInternal(6,e)}AT_LEAST_ONE7(e){this.atLeastOneInternal(7,e)}AT_LEAST_ONE8(e){this.atLeastOneInternal(8,e)}AT_LEAST_ONE9(e){this.atLeastOneInternal(9,e)}AT_LEAST_ONE_SEP(e){this.atLeastOneSepFirstInternal(0,e)}AT_LEAST_ONE_SEP1(e){this.atLeastOneSepFirstInternal(1,e)}AT_LEAST_ONE_SEP2(e){this.atLeastOneSepFirstInternal(2,e)}AT_LEAST_ONE_SEP3(e){this.atLeastOneSepFirstInternal(3,e)}AT_LEAST_ONE_SEP4(e){this.atLeastOneSepFirstInternal(4,e)}AT_LEAST_ONE_SEP5(e){this.atLeastOneSepFirstInternal(5,e)}AT_LEAST_ONE_SEP6(e){this.atLeastOneSepFirstInternal(6,e)}AT_LEAST_ONE_SEP7(e){this.atLeastOneSepFirstInternal(7,e)}AT_LEAST_ONE_SEP8(e){this.atLeastOneSepFirstInternal(8,e)}AT_LEAST_ONE_SEP9(e){this.atLeastOneSepFirstInternal(9,e)}RULE(e,t,r=aE){if(ij(this.definedRulesNames,e)){let t={message:sm.buildDuplicateRuleNameError({topLevelRule:e,grammarName:this.className}),type:$.DUPLICATE_RULE_NAME,ruleName:e};this.definitionErrors.push(t)}this.definedRulesNames.push(e);let n=this.defineRule(e,t,r);return this[e]=n,n}OVERRIDE_RULE(e,t,r=aE){let n=function(e,t,r){let n=[];return ij(t,e)||n.push({message:`Invalid rule override, rule: ->${e}<- cannot be overridden in the grammar: ->${r}<-as it is not defined in any of the super grammars `,type:$.INVALID_RULE_OVERRIDE,ruleName:e}),n}(e,this.definedRulesNames,this.className);this.definitionErrors=this.definitionErrors.concat(n);let i=this.defineRule(e,t,r);return this[e]=i,i}BACKTRACK(e,t){return function(){this.isBackTrackingStack.push(1);let r=this.saveRecogState();try{return e.apply(this,t),!0}catch(e){if(s1(e))return!1;throw e}finally{this.reloadRecogState(r),this.isBackTrackingStack.pop()}}}getGAstProductions(){return this.gastProductionsCache}getSerializedGastProductions(){return nq(nJ(this.gastProductionsCache),function e(t){function r(t){return nq(t,e)}if(t instanceof iA){let e={type:"NonTerminal",name:t.nonTerminalName,idx:t.idx};return im(t.label)&&(e.label=t.label),e}if(t instanceof ib)return{type:"Alternative",definition:r(t.definition)};if(t instanceof iR)return{type:"Option",idx:t.idx,definition:r(t.definition)};if(t instanceof iw)return{type:"RepetitionMandatory",idx:t.idx,definition:r(t.definition)};if(t instanceof iO)return{type:"RepetitionMandatoryWithSeparator",idx:t.idx,separator:e(new iN({terminalType:t.separator})),definition:r(t.definition)};if(t instanceof iL)return{type:"RepetitionWithSeparator",idx:t.idx,separator:e(new iN({terminalType:t.separator})),definition:r(t.definition)};if(t instanceof iS)return{type:"Repetition",idx:t.idx,definition:r(t.definition)};else if(t instanceof ik)return{type:"Alternation",idx:t.idx,definition:r(t.definition)};else if(t instanceof iN){var n,i;let e={type:"Terminal",name:t.terminalType.name,label:im((i=n=t.terminalType).LABEL)&&""!==i.LABEL?n.LABEL:n.name,idx:t.idx};im(t.label)&&(e.terminalLabel=t.label);let r=t.terminalType.PATTERN;return t.terminalType.PATTERN&&(e.pattern=ig(r)?r.source:r),e}else if(t instanceof iv)return{type:"Rule",name:t.name,orgText:t.orgText,definition:r(t.definition)};else throw Error("non exhaustive match")})}},class{initErrorHandler(e){this._errors=[],this.errorMessageProvider=ny(e,"errorMessageProvider")?e.errorMessageProvider:am.errorMessageProvider}SAVE_ERROR(e){if(s1(e))return e.context={ruleStack:this.getHumanReadableRuleStack(),ruleOccurrenceStack:r8(this.RULE_OCCURRENCE_STACK)},this._errors.push(e),e;throw Error("Trying to save an Error which is not a RecognitionException")}get errors(){return r8(this._errors)}set errors(e){this._errors=e}raiseEarlyExitException(e,t,r){let n=this.getCurrRuleFullName(),i=sG(e,this.getGAstProductions()[n],t,this.maxLookahead)[0],o=[];for(let e=1;e<=this.maxLookahead;e++)o.push(this.LA(e));let s=this.errorMessageProvider.buildEarlyExitMessage({expectedIterationPaths:i,actual:o,previous:this.LA(0),customUserDescription:r,ruleName:n});throw this.SAVE_ERROR(new s5(s,this.LA(1),this.LA(0)))}raiseNoAltException(e,t){let r=this.getCurrRuleFullName(),n=s$(e,this.getGAstProductions()[r],this.maxLookahead),i=[];for(let e=1;e<=this.maxLookahead;e++)i.push(this.LA(e));let o=this.LA(0),s=this.errorMessageProvider.buildNoViableAltMessage({expectedPathsPerAlt:n,actual:i,previous:o,customUserDescription:t,ruleName:this.getCurrRuleFullName()});throw this.SAVE_ERROR(new s8(s,this.LA(1),o))}},class{initContentAssist(){}computeContentAssist(e,t){let r=this.gastProductionsCache[e];if(i5(r))throw Error(`Rule ->${e}<- does not exist in this grammar.`);return sI([r],t,this.tokenMatcher,this.maxLookahead)}getNextPossibleTokenTypes(e){let t=oA(e.ruleStack);return new sw(this.getGAstProductions()[t],e).startWalking()}},class{initGastRecorder(e){this.recordingProdStack=[],this.RECORDING_PHASE=!1}enableRecording(){this.RECORDING_PHASE=!0,this.TRACE_INIT("Enable Recording",()=>{for(let e=0;e<10;e++){let t=e>0?e:"";this[`CONSUME${t}`]=function(t,r){return this.consumeInternalRecord(t,e,r)},this[`SUBRULE${t}`]=function(t,r){return this.subruleInternalRecord(t,e,r)},this[`OPTION${t}`]=function(t){return this.optionInternalRecord(t,e)},this[`OR${t}`]=function(t){return this.orInternalRecord(t,e)},this[`MANY${t}`]=function(t){this.manyInternalRecord(e,t)},this[`MANY_SEP${t}`]=function(t){this.manySepFirstInternalRecord(e,t)},this[`AT_LEAST_ONE${t}`]=function(t){this.atLeastOneInternalRecord(e,t)},this[`AT_LEAST_ONE_SEP${t}`]=function(t){this.atLeastOneSepFirstInternalRecord(e,t)}}this.consume=function(e,t,r){return this.consumeInternalRecord(t,e,r)},this.subrule=function(e,t,r){return this.subruleInternalRecord(t,e,r)},this.option=function(e,t){return this.optionInternalRecord(t,e)},this.or=function(e,t){return this.orInternalRecord(t,e)},this.many=function(e,t){this.manyInternalRecord(e,t)},this.atLeastOne=function(e,t){this.atLeastOneInternalRecord(e,t)},this.ACTION=this.ACTION_RECORD,this.BACKTRACK=this.BACKTRACK_RECORD,this.LA=this.LA_RECORD})}disableRecording(){this.RECORDING_PHASE=!1,this.TRACE_INIT("Deleting Recording methods",()=>{for(let e=0;e<10;e++){let t=e>0?e:"";delete this[`CONSUME${t}`],delete this[`SUBRULE${t}`],delete this[`OPTION${t}`],delete this[`OR${t}`],delete this[`MANY${t}`],delete this[`MANY_SEP${t}`],delete this[`AT_LEAST_ONE${t}`],delete this[`AT_LEAST_ONE_SEP${t}`]}delete this.consume,delete this.subrule,delete this.option,delete this.or,delete this.many,delete this.atLeastOne,delete this.ACTION,delete this.BACKTRACK,delete this.LA})}ACTION_RECORD(e){}BACKTRACK_RECORD(e,t){return()=>!0}LA_RECORD(e){return ag}topLevelRuleRecord(e,t){try{let r=new iv({definition:[],name:e});return r.name=e,this.recordingProdStack.push(r),t.call(this),this.recordingProdStack.pop(),r}catch(e){if(!0!==e.KNOWN_RECORDER_ERROR)try{e.message=e.message+'\n	 This error was thrown during the "grammar recording phase" For more info see:\n	https://chevrotain.io/docs/guide/internals.html#grammar-recording'}catch(t){throw e}throw e}}optionInternalRecord(e,t){return ah.call(this,iR,e,t)}atLeastOneInternalRecord(e,t){ah.call(this,iw,t,e)}atLeastOneSepFirstInternalRecord(e,t){ah.call(this,iO,t,e,!0)}manyInternalRecord(e,t){ah.call(this,iS,t,e)}manySepFirstInternalRecord(e,t){ah.call(this,iL,t,e,!0)}orInternalRecord(e,t){return ad.call(this,e,t)}subruleInternalRecord(e,t,r){if(ap(t),!e||!1===ny(e,"ruleName")){let r=Error(`<SUBRULE${af(t)}> argument is invalid expecting a Parser method reference but got: <${JSON.stringify(e)}>
 inside top level rule: <${this.recordingProdStack[0].name}>`);throw r.KNOWN_RECORDER_ERROR=!0,r}let n=o0(this.recordingProdStack),i=new iA({idx:t,nonTerminalName:e.ruleName,label:null==r?void 0:r.LABEL,referencedRule:void 0});return n.definition.push(i),this.outputCst?au:aa}consumeInternalRecord(e,t,r){if(ap(t),!o5(e)){let r=Error(`<CONSUME${af(t)}> argument is invalid expecting a TokenType reference but got: <${JSON.stringify(e)}>
 inside top level rule: <${this.recordingProdStack[0].name}>`);throw r.KNOWN_RECORDER_ERROR=!0,r}let n=o0(this.recordingProdStack),i=new iN({idx:t,terminalType:e,label:null==r?void 0:r.LABEL});return n.definition.push(i),ac}},class{initPerformanceTracer(e){if(ny(e,"traceInitPerf")){let t=e.traceInitPerf,r="number"==typeof t;this.traceInitMaxIdent=r?t:1/0,this.traceInitPerf=r?t>0:t}else this.traceInitMaxIdent=0,this.traceInitPerf=am.traceInitPerf;this.traceInitIndent=-1}TRACE_INIT(e,t){if(!0!==this.traceInitPerf)return t();{this.traceInitIndent++;let r=Array(this.traceInitIndent+1).join("	");this.traceInitIndent<this.traceInitMaxIdent&&console.log(`${r}--> <${e}>`);let{time:n,value:i}=nZ(t),o=n>10?console.warn:console.log;return this.traceInitIndent<this.traceInitMaxIdent&&o(`${r}<-- <${e}> time: ${n}ms`),this.traceInitIndent--,i}}}]);class a_ extends ay{constructor(e,t=am){let r=r8(t);r.outputCst=!0,super(e,r)}}RegExp("[\\u200d\ud800-\udfff\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff\\ufe0e\\ufe0f]");var aT="\ud800-\udfff",aA="[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]",av="\ud83c[\udffb-\udfff]",ab="[^"+aT+"]",aR="(?:\ud83c[\udde6-\uddff]){2}",aw="[\ud800-\udbff][\udc00-\udfff]",aO="(?:"+aA+"|"+av+")?",aS="[\\ufe0e\\ufe0f]?",aL="(?:\\u200d(?:"+[ab,aR,aw].join("|")+")"+aS+aO+")*";RegExp(av+"(?="+av+")|(?:"+[ab+aA+"?",aA,aR,aw,"["+aT+"]"].join("|")+")"+(aS+aO+aL),"g");let ak={},aN=!!ak.LANG_DEV;ak.STATS_DEV;let aC=!!ak.SHOW_CODE,aI=eJ(32,126).map(e=>String.fromCharCode(e)),ax=sh({name:"Newline",line_breaks:!0,start_chars_hint:["\n","\r"],pattern:/\n|\r\n?/}),aM=sh({name:"Whitespace",pattern:/ +/,group:se.SKIPPED}),aU=sh({name:"Whitespace",pattern:/\s+/,line_breaks:!0,group:se.SKIPPED}),aP=sh({name:"Stat",pattern:/@.*/,start_chars_hint:["@"]}),aD=sh({name:"Command",pattern:/#/,start_chars_hint:["#"]}),aB=!1,aF=sh({name:"Text",pattern:function(e,t,r){if(!aB)return null;let[n]=r.slice(-1);if(n&&n.tokenType!==ax)return null;let i=t;for(;" "===e[i];)i++;if("@#/?':!".includes(e[i]))return null;let o=t+1;for(;o<e.length&&"\n"!==e[o];)o++;return[e.substring(t,o)]},line_breaks:!1,start_chars_hint:aI.filter(e=>!1==="@#/?':!".includes(e))}),aj=sh({name:"Comment",pattern:/'.*/,start_chars_hint:["'"]}),a$=sh({name:"Label",pattern:/:[^;:\n]*/,start_chars_hint:[":"]}),aG=sh({name:"HyperLink",pattern:/!/,start_chars_hint:["!"]}),aK=sh({name:"HyperLinkText",pattern:/;[^;\n]*/,start_chars_hint:[";"]}),aW=sh({name:"StringLiteral",pattern:/[^-0-9"!;@#/?\s]+[^-"!;@#/?\s]*/,start_chars_hint:aI}),aH=sh({name:"StringLiteralDouble",pattern:/"(?:[^\\"]|\\(?:[^\n\r]|u[0-9a-fA-F]{4}))*"/}),aY=sh({name:"NumberLiteral",pattern:/-?(\d*\.)?\d+([eE][+-]?\d+)?[jJ]?[lL]?/});function aV(e){return sh({name:e,pattern:RegExp(e.toLowerCase(),"i"),longer_alt:aW})}let az=sh({name:"IsEq",pattern:/=|is|eq|equal/,longer_alt:aW}),aq=sh({name:"IsNotEq",pattern:/!=|not ?eq|not ?equal/,longer_alt:aW}),aJ=sh({name:"IsLessThan",pattern:/<|below/,longer_alt:aW}),aX=sh({name:"IsGreaterThan",pattern:/>|above/,longer_alt:aW}),aQ=sh({name:"IsLessThanOrEqual",pattern:/<=|below ?or ?eq|below ?or ?equal/,longer_alt:aW}),aZ=sh({name:"IsGreaterThanOrEqual",pattern:/>=|above ?or ?eq|above ?or ?equal/,longer_alt:aW}),a0=sh({name:"Or",pattern:/or/i,longer_alt:aW}),a1=sh({name:"Not",pattern:/not/i,longer_alt:aW}),a2=sh({name:"And",pattern:/and/i,longer_alt:aW}),a6=sh({name:"Plus",pattern:/\+/}),a8=sh({name:"Minus",pattern:/-/}),a3=sh({name:"Power",pattern:/\*\*/}),a5=sh({name:"Multiply",pattern:/\*/}),a4=sh({name:"FloorDivide",pattern:/\//}),a7=sh({name:"ModDivide",pattern:/%/}),a9=sh({name:"FloorDivide",pattern:/%%/}),le=sh({name:"Query",pattern:/\?/}),lt=sh({name:"LParen",pattern:/\(/,push_mode:"ignore_newlines"}),lr=sh({name:"RParen",pattern:/\)/,pop_mode:!0}),ln=sh({name:"play",pattern:/play .*/,start_chars_hint:aI,longer_alt:aW}),li=aV("if"),lo=aV("do"),ls=aV("else"),la=aV("endif"),ll=aV("while"),lc=aV("endwhile"),lu=aV("repeat"),lh=aV("endrepeat"),ld=aV("read"),lf=aV("endread"),lp=aV("break"),lg=aV("continue");function lm(e){return[...e,az,aq,aQ,aJ,aZ,aX,a0,a1,a2,a6,a8,a3,a5,a4,a9,a7,le,lt,lr,aH,aW,aY]}let lE=lm([aF,aP,ln,aD,aj,a$,aG,aK,ax,aM,li,lo,ls,la,ll,lc,lu,lh,ld,lf,lp,lg]),ly=new se({defaultMode:"use_newlines",modes:{use_newlines:lE,ignore_newlines:lm([aU])}},{skipValidations:!aN,ensureOptimizations:aN});function l_(e){aB=!0;let t=ly.tokenize(e||" \n"),[r]=(Array.isArray(t.tokens)?t.tokens:[]).slice(-1);return r&&"Newline"!==r.tokenType.name&&t.tokens.push(sf(ax,"\n",r.startOffset,r.endOffset??NaN,r.startLine??NaN,r.endLine??NaN,r.startColumn??NaN,r.endColumn??NaN)),t}function lT(e,t){return{id:ep(),code:e,...t}}function lA(e){if(!eK(e))return{};if(eK(e.stats?.type))return e.stats;e.stats={};let t=l_(e.code);for(let r=0;r<t.tokens.length;++r){let n=t.tokens[r];if(n.tokenType===aP){let[t,...r]=n.image.slice(1).split(" "),i=r.join(" ");switch(t.toLowerCase()){case"stat":{let t=l_(`!${i}`);t.tokens.length&&function(e,t){let[r,n,...i]=t;if(eK(e.stats)&&eK(r))switch(r.image.toLowerCase()){case"rn":case"range":case"sl":case"select":case"nm":case"number":case"tx":case"text":case"ln":case"link":if(eK(n)){let t=n.image.toLowerCase();e.stats[t]=(i??[]).map(e=>e.image)}}}(e,t.tokens);break}case"flags":e.stats.flags=i;break;case"func":e.stats.type=1,e.stats.name=i;break;case"board":e.stats.type=2,e.stats.name=i;break;case"object":e.stats.type=3,e.stats.name=i;break;case"terrain":e.stats.type=4,e.stats.name=i;break;case"charset":e.stats.type=5,e.stats.name=i;break;case"palette":e.stats.type=6,e.stats.name=i;break;default:e.stats.type=3,e.stats.name=[t,...r].join(" ")}}}return eK(e.stats.type)||(e.stats.type=3),e.stats}function lv(e,t){return{id:ep(),name:e,pages:t,flags:{},players:{}}}function lb(e,t,r){if(!eW(e))return;let n=r.toLowerCase();return e.pages.find(e=>(lA(e).type??0)===t&&(e.id===r||n===(lA(e).name??"").toLowerCase()))}function lR(e,t,r){let n=lb(e,t,r);if(n)switch(t){case G.ERROR:return n.error;case G.FUNC:return n.code;case G.BOARD:return n.board;case G.OBJECT:return n.object;case G.TERRAIN:return n.terrain;case G.CHARSET:return n.charset;case G.PALETTE:return n.palette}}function lw(e,t){let r=t??"",n=lb(e,G.OBJECT,r),i=lR(e,G.OBJECT,r);return eW(n)?{...i,name:r,code:n.code}:void 0}function lO(e,t){if(eK(t)&&eK(t.kind))return eK(t.kinddata)||(t.kinddata=lw(e,t.kind)),t.kinddata}function lS(e,t){let r=t??"",n=lb(e,G.TERRAIN,r),i=lR(e,G.TERRAIN,r);return eW(n)?{...i,name:r,code:n.code}:void 0}function lL(e,t){if(eK(t)&&eK(t.kind))return eK(t.kinddata)||(t.kinddata=lS(e,t.kind)),t.kinddata}function lk(e,t){return lR(e,G.BOARD,t)}function lN(e,t){if(e)return e.flags[t]=e.flags[t]??{},e.flags[t]}function lC(e,t){return lk(e,e?.players[t]??"")}(A=G||(G={}))[A.ERROR=0]="ERROR",A[A.FUNC=1]="FUNC",A[A.BOARD=2]="BOARD",A[A.OBJECT=3]="OBJECT",A[A.TERRAIN=4]="TERRAIN",A[A.CHARSET=5]="CHARSET",A[A.PALETTE=6]="PALETTE";let lI=Array(1500);function lx(e=eq){return e({id:ep(),x:0,y:0,width:60,height:25,terrain:lI.slice(0),objects:{}})}function lM(e,t){if(!eK(e)||!eK(t))return;let r={...t,id:t.id??ep()};return e.objects[r.id]=r,r}function lU(e,t){switch(t){case H.NORTH:--e.y;break;case H.SOUTH:++e.y;break;case H.WEST:--e.x;break;case H.EAST:++e.x}return e}function lP(e,t,r){let n=t?.x??0,i=t?.y??0,o={x:n,y:i},s={...o},a=lJ({x:t?.lx??o.x,y:t?.ly??o.y},o);for(let l=0;l<r.length&&o.x===n&&o.y===i;++l){let n=H[r[l]];switch(n){case H.IDLE:break;case H.NORTH:case H.SOUTH:case H.WEST:case H.EAST:lU(o,n);break;case H.BY:case H.AT:break;case H.FLOW:lU(o,a);break;case H.SEEK:{let r=lD(e,t);lq(r)&&lU(o,lJ(s,r));break}case H.RNDNS:lU(o,eX(H.NORTH,H.SOUTH));break;case H.RNDNE:lU(o,eX(H.NORTH,H.EAST));break;case H.RND:lU(o,eX(H.NORTH,H.SOUTH,H.WEST,H.EAST));break;case H.CW:case H.CCW:case H.OPP:lU(o,lJ(s,lP(e,t,r.slice(l+1))));break;case H.RNDP:switch(lJ(s,lP(e,t,r.slice(l+1)))){case H.NORTH:case H.SOUTH:o.x+=eX(-1,1);break;case H.WEST:case H.EAST:o.y+=eX(-1,1)}break;case H.EDIT:o.frame="edit"}}return o}function lD(e,t){if(!eK(e)||!eK(t))return;let r=t.stats?.player??"",n=e.objects[r];return eK(n)?n:lq(t)?function(e,t,r){let n,i=0;for(let e=0;e<r.length;++e){let o=r[e];if(o){let e=t.x-(o.x??0),r=t.y-(o.y??0),s=Math.sqrt(e*e+r*r);(void 0===n||s<i)&&(i=s,n=o)}}return n}(0,t,[...e?.named?.player?.values()??[]].map(t=>"string"==typeof t?e?.objects[t]:e?.terrain[t])):void 0}function lB(e){return{id:ep(),type:e}}function lF(e,t){let r=lB(0);return r.book=e,r.board=t,r}(v=K||(K={}))[v.VIEW=0]="VIEW",v[v.EDIT=1]="EDIT";let lj=function(e={}){return e7(e)}({defaultplayer:"",books:new Map,chips:new Map,frames:new Map});function l$(e){let t=[lF(void 0,void 0)];return lj.frames.set(e,t),t}function lG(e){return lj.frames.get(e)??l$(e)}function lK(e){let t=e.toLowerCase();return lj.books.get(e)||[...lj.books.values()].find(e=>e.name.toLowerCase()===t)}function lW(e){return lj.books.set(e.id,e),e.id}function lH(e){let t=lj.chips.get(e);return eK(t)||(t={book:void 0,board:void 0,target:void 0,inputqueue:new Set,inputmods:{[D.NONE]:0,[D.MOVE_UP]:0,[D.MOVE_DOWN]:0,[D.MOVE_LEFT]:0,[D.MOVE_RIGHT]:0,[D.OK_BUTTON]:0,[D.CANCEL_BUTTON]:0,[D.MENU_BUTTON]:0},inputcurrent:void 0},lj.chips.set(e,t)),t}let lY="player",lV="title";function lz(e){switch(e.type){case K.EDIT:return 1;case K.VIEW:return 2}return 0}function lq(e){return eK(e)&&eK(e.x)&&eK(e.y)}function lJ(e,t){let r=t.x-e.x,n=t.y-e.y;return r<0?3:r>0?4:n<0?1:n>0?2:void 0}(b=W||(W={}))[b.BLACK=0]="BLACK",b[b.DKBLUE=1]="DKBLUE",b[b.DKGREEN=2]="DKGREEN",b[b.DKCYAN=3]="DKCYAN",b[b.DKRED=4]="DKRED",b[b.DKPURPLE=5]="DKPURPLE",b[b.DKYELLOW=6]="DKYELLOW",b[b.LTGRAY=7]="LTGRAY",b[b.DKGRAY=8]="DKGRAY",b[b.BLUE=9]="BLUE",b[b.GREEN=10]="GREEN",b[b.CYAN=11]="CYAN",b[b.RED=12]="RED",b[b.PURPLE=13]="PURPLE",b[b.YELLOW=14]="YELLOW",b[b.WHITE=15]="WHITE",b[b.CLEAR=32]="CLEAR",b[b.SHADOW=33]="SHADOW",(R=H||(H={}))[R.IDLE=0]="IDLE",R[R.NORTH=1]="NORTH",R[R.SOUTH=2]="SOUTH",R[R.WEST=3]="WEST",R[R.EAST=4]="EAST",R[R.BY=5]="BY",R[R.AT=6]="AT",R[R.FLOW=7]="FLOW",R[R.SEEK=8]="SEEK",R[R.RNDNS=9]="RNDNS",R[R.RNDNE=10]="RNDNE",R[R.RND=11]="RND",R[R.CW=12]="CW",R[R.CCW=13]="CCW",R[R.OPP=14]="OPP",R[R.RNDP=15]="RNDP",R[R.EDIT=16]="EDIT",(w=Y||(Y={}))[w.SOLID=0]="SOLID",w[w.WALK=1]="WALK",w[w.SWIM=2]="SWIM",w[w.BULLET=3]="BULLET",(O=V||(V={}))[O.TERRAIN=0]="TERRAIN",O[O.OBJECT=1]="OBJECT";let lX={terrain:"TERRAIN",object:"OBJECT"};function lQ(e){return eK(V[e])&&eY(e)}function lZ(e){return ez(e)&&lQ(e[0])}function l0(e,t){let r=e.words[t];if(lZ(r))return[r,t+1];if("string"==typeof r){let n=e.chip.get(r);if(lZ(n))return[n,t+1];if(lQ(n))return[[n],t+1]}return[void 0,t]}let l1={solid:"SOLID",walk:"WALK",swim:"SWIM",bullet:"BULLET",walkable:"WALK",swimmable:"SWIM"};function l2(e){return eK(Y[e])&&eY(e)}function l6(e){return ez(e)&&l2(e[0])}let l8={black:"BLACK",dkblue:"DKBLUE",dkgreen:"DKGREEN",dkcyan:"DKCYAN",dkred:"DKRED",dkpurple:"DKPURPLE",dkyellow:"DKYELLOW",ltgray:"LTGRAY",dkgray:"DKGRAY",blue:"BLUE",green:"GREEN",cyan:"CYAN",red:"RED",purple:"PURPLE",yellow:"YELLOW",white:"WHITE",brown:"DKYELLOW",dkwhite:"LTGRAY",ltgrey:"LTGRAY",gray:"LTGRAY",grey:"LTGRAY",dkgrey:"DKGRAY",ltblack:"DKGRAY",onblack:"BLACK",ondkblue:"DKBLUE",ondkgreen:"DKGREEN",ondkcyan:"DKCYAN",ondkred:"DKRED",ondkpurple:"DKPURPLE",ondkyellow:"DKYELLOW",onltgray:"LTGRAY",ondkgray:"DKGRAY",onblue:"BLUE",ongreen:"GREEN",oncyan:"CYAN",onred:"RED",onpurple:"PURPLE",onyellow:"YELLOW",onwhite:"WHITE",clear:"CLEAR",shadow:"SHADOW",onbrown:"DKYELLOW",ondkwhite:"LTGRAY",onltgrey:"LTGRAY",ongray:"LTGRAY",ongrey:"LTGRAY",ondkgrey:"DKGRAY",onltblack:"DKGRAY"};function l3(e){return eK(W[e])&&eY(e)}function l5(e){return ez(e)&&l3(e[0])}function l4(e,t){let r=e.words[t];if(l5(r))return[r,t+1];if("string"==typeof r){let n=e.chip.get(r);if(l5(n))return[n,t+1];if(l3(n))return[[n],t+1]}return[void 0,t]}function l7(e){return ez(e)&&"string"==typeof e[0]}let l9={idle:"IDLE",up:"NORTH",down:"SOUTH",left:"WEST",right:"EAST",by:"BY",at:"AT",flow:"FLOW",seek:"SEEK",rndns:"RNDNS",rndne:"RNDNE",rnd:"RND",cw:"CW",ccw:"CCW",opp:"OPP",rndp:"RNDP",u:"NORTH",north:"NORTH",n:"NORTH",d:"SOUTH",south:"SOUTH",s:"SOUTH",l:"WEST",west:"WEST",w:"WEST",r:"EAST",east:"EAST",e:"EAST",edit:"EDIT"};function ce(e){return eK(H[e])&&eY(e)}function ct(e){return ez(e)&&ce(e[0])}function cr(e,t){let r=[],n=e.words[t];if(ct(n))return[n,t+1];if("string"==typeof n){let r=e.chip.get(n);if(ct(r))return[r,t+1]}for(let n=t;n<e.words.length;++n){let t=e.words[n];if("string"!=typeof t)break;let i=e.chip.get(t);if(ce(i))r.push(i);else break}return r.length?[r,t+r.length]:[void 0,t]}function cn(e,t){return{...lH(e.id()),chip:e,words:t}}function ci(e,t){let r=e.words[t],[n,i]=l0(e,t);if(eK(n))return[n,i];let[o,s]=function(e,t){let r=e.words[t];if(l6(r))return[r,t+1];if("string"==typeof r){let n=e.chip.get(r);if(l6(n))return[n,t+1];if(l2(n))return[[n],t+1]}return[void 0,t]}(e,t);if(eK(o))return[o,s];let[a,l]=l4(e,t);if(eK(a))return[a,l];if(eY(r)&&"rnd"===r.toLowerCase()){let[r,n]=ci(e,t+1),[i,o]=ci(e,n);return eH(r)&&eH(i)?[ew(r,i),o]:eH(r)?[ew(0,r),n]:[ew(0,1),t+1]}let[c,u]=cr(e,t);if(eK(c))return[c,u];if(!eK(r))return[void 0,t];if(lq(r)||eH(r)||ez(r))return[r,t+1];if(eY(r)){let n=r.toLowerCase(),i=e.chip.get(r);if(eK(i))return[i,t+1];switch(n){case"aligned":case"alligned":case"contact":case"blocked":case"any":break;case"abs":{let[r,n]=cs(e,t+1,[5]);return[Math.abs(r),n]}case"ceil":{let[r,n]=cs(e,t+1,[5]);return[Math.ceil(r),n]}case"floor":{let[r,n]=cs(e,t+1,[5]);return[Math.floor(r),n]}case"round":{let[r,n]=cs(e,t+1,[5]);return[Math.round(r),n]}case"min":{let r=[];for(let n=t+1;n<e.words.length;){let[t,i]=ci(e,n);if(ez(t)&&!lq(t)&&!ct(t)&&!lZ(t)&&!l6(t)&&!l5(t))return[eX(t),i];n=i,r.push(t)}return[Math.min(...r),e.words.length]}case"max":{let r=[];for(let n=t+1;n<e.words.length;){let[t,i]=ci(e,n);if(ez(t)&&!lq(t)&&!ct(t)&&!lZ(t)&&!l6(t)&&!l5(t))return[eX(t),i];n=i,r.push(t)}return[Math.max(...r),e.words.length]}case"clamp":{let[r,n,i,o]=cs(e,t+1,[5,5,5]);return[eR(r,n,i),o]}case"pick":{let r=[];for(let n=t+1;n<e.words.length;){let[t,i]=ci(e,n);if(ez(t)&&!lq(t)&&!ct(t)&&!lZ(t)&&!l6(t)&&!l5(t))return[eX(t),i];n=i,r.push(t)}return[eX(r),e.words.length]}case"range":{let[r,n,i,o]=cs(e,t+1,[5,13,13]);return[eJ(r,n,i),o]}}}return[r,t+1]}function co(e,t){throw Error(`Invalid arg, expected: ${e} but got ${JSON.stringify(t)}`)}function cs(e,t,r){let n=[],i=t;for(let t=0;t<r.length;++t)switch(r[t]){case 0:{let[t,r]=ci(e,i);lZ(t)||co("terrain or object",t),i=r,n.push(V[t[0]]);break}case 1:{let[t,r]=ci(e,i);l6(t)||co("solid, walk, swim, bullet, walkable or swimmable",t),i=r,n.push(Y[t[0]]);break}case 2:{let[t,r]=ci(e,i);l5(t)||co("color",t),i=r,n.push(W[t[0]]);break}case 3:{let[t,r]=function(e,t){let r=e.words[t];if(l7(r))return[r,t+1];let[n,i]=l4(e,t),[o,s]=ci(e,i);return"string"==typeof o?[[o,n],s]:[void 0,t]}(e,i);l7(t)?(i=r,n.push(t)):co("kind",t);break}case 4:{let[t,r]=cr(e,i);if(ct(t)){let o=e.board?lP(e.board,e.target,t):{x:0,y:0};i=r,n.push(o)}else co("direction",t);break}case 5:{let[t,r]=ci(e,i);eH(t)||co("number",t),i=r,n.push(t);break}case 6:{let r=e.words[t];eY(r)||co("string",r),i=t+1,n.push(r);break}case 7:{let r=e.words[t];eH(r)||eY(r)||co("number or string",r),i=t+1,n.push(r);break}case 8:{let[t,r]=l0(e,i);void 0!==t&&lZ(t)&&co("optional terrain or object",t),i=r,n.push(t);break}case 9:{let[t,r]=l0(e,i);void 0!==t&&l6(t)&&co("optional solid, walk, swim, bullet, walkable or swimmable",t),i=r,n.push(t);break}case 10:{let[t,r]=l4(e,i);void 0===t||l5(t)||co("optional color",t),i=r,n.push(t);break}case 11:let[o,s]=ci(e,i);void 0===o||ez(o)&&eY(o[0])&&eV(o[1])&&eV(o[2])||co("optional kind",o),i=s,n.push(o);break;case 12:{let[t,r]=cr(e,i);if(ct(t)){let o=e.board?lP(e.board,e.target,t):{x:0,y:0};i=r,n.push(o)}else void 0!==t&&co("optional direction",t);break}case 13:{let[t,r]=ci(e,i);void 0===t||eH(t)||co("optional number",t),i=r,n.push(t);break}case 14:{let r=e.words[t];void 0===r||eY(r)||co("optional string",r),i=t+1,n.push(r);break}case 15:{let r=e.words[t];void 0===r||eH(r)||eY(r)||co("optional number or string",r),i=t+1,n.push(r);break}case 16:{let[t,r]=ci(e,i);i=r,n.push(t)}}return[...n,i]}(S=z||(z={}))[S.CATEGORY=0]="CATEGORY",S[S.COLLISION=1]="COLLISION",S[S.COLOR=2]="COLOR",S[S.KIND=3]="KIND",S[S.DIR=4]="DIR",S[S.NUMBER=5]="NUMBER",S[S.STRING=6]="STRING",S[S.NUMBER_OR_STRING=7]="NUMBER_OR_STRING",S[S.MAYBE_CATEGORY=8]="MAYBE_CATEGORY",S[S.MAYBE_COLLISION=9]="MAYBE_COLLISION",S[S.MAYBE_COLOR=10]="MAYBE_COLOR",S[S.MAYBE_KIND=11]="MAYBE_KIND",S[S.MAYBE_DIR=12]="MAYBE_DIR",S[S.MAYBE_NUMBER=13]="MAYBE_NUMBER",S[S.MAYBE_STRING=14]="MAYBE_STRING",S[S.MAYBE_NUMBER_OR_STRING=15]="MAYBE_NUMBER_OR_STRING",S[S.ANY=16]="ANY";let ca=lv("BIOS",[lT("@board title",{board:lx(e=>{for(let t=0;t<32;t++)lM(e,{x:ew(0,e.width-1),y:ew(0,e.height-1),kind:"spin"});return e})}),lT(ei(ey),{object:{char:219,color:W.WHITE,bg:W.CLEAR}}),lT(ei(e_),{object:{char:1,color:W.WHITE,bg:W.CLEAR}}),lT("@terrain field",{terrain:{char:176,color:W.DKGRAY,collision:Y.WALK}}),lT("@terrain wall",{terrain:{char:219,color:W.CYAN,collision:Y.SOLID}})]);var cl={};L=function(e){var t=/(^|@)\S+:\d+/,r=/^\s*at .*(\S+:\d+|\(native\))/m,n=/^(eval@)?(\[native code])?$/;return{parse:function(e){if(void 0!==e.stacktrace||void 0!==e["opera#sourceloc"])return this.parseOpera(e);if(e.stack&&e.stack.match(r))return this.parseV8OrIE(e);if(e.stack)return this.parseFFOrSafari(e);throw Error("Cannot parse given Error object")},extractLocation:function(e){if(-1===e.indexOf(":"))return[e];var t=/(.+?)(?::(\d+))?(?::(\d+))?$/.exec(e.replace(/[()]/g,""));return[t[1],t[2]||void 0,t[3]||void 0]},parseV8OrIE:function(t){return t.stack.split("\n").filter(function(e){return!!e.match(r)},this).map(function(t){t.indexOf("(eval ")>-1&&(t=t.replace(/eval code/g,"eval").replace(/(\(eval at [^()]*)|(,.*$)/g,""));var r=t.replace(/^\s+/,"").replace(/\(eval code/g,"(").replace(/^.*?\s+/,""),n=r.match(/ (\(.+\)$)/);r=n?r.replace(n[0],""):r;var i=this.extractLocation(n?n[1]:r);return new e({functionName:n&&r||void 0,fileName:["eval","<anonymous>"].indexOf(i[0])>-1?void 0:i[0],lineNumber:i[1],columnNumber:i[2],source:t})},this)},parseFFOrSafari:function(t){return t.stack.split("\n").filter(function(e){return!e.match(n)},this).map(function(t){if(t.indexOf(" > eval")>-1&&(t=t.replace(/ line (\d+)(?: > eval line \d+)* > eval:\d+:\d+/g,":$1")),-1===t.indexOf("@")&&-1===t.indexOf(":"))return new e({functionName:t});var r=/((.*".+"[^@]*)?[^@]*)(?:@)/,n=t.match(r),i=n&&n[1]?n[1]:void 0,o=this.extractLocation(t.replace(r,""));return new e({functionName:i,fileName:o[0],lineNumber:o[1],columnNumber:o[2],source:t})},this)},parseOpera:function(e){return!e.stacktrace||e.message.indexOf("\n")>-1&&e.message.split("\n").length>e.stacktrace.split("\n").length?this.parseOpera9(e):e.stack?this.parseOpera11(e):this.parseOpera10(e)},parseOpera9:function(t){for(var r=/Line (\d+).*script (?:in )?(\S+)/i,n=t.message.split("\n"),i=[],o=2,s=n.length;o<s;o+=2){var a=r.exec(n[o]);a&&i.push(new e({fileName:a[2],lineNumber:a[1],source:n[o]}))}return i},parseOpera10:function(t){for(var r=/Line (\d+).*script (?:in )?(\S+)(?:: In function (\S+))?$/i,n=t.stacktrace.split("\n"),i=[],o=0,s=n.length;o<s;o+=2){var a=r.exec(n[o]);a&&i.push(new e({functionName:a[3]||void 0,fileName:a[2],lineNumber:a[1],source:n[o]}))}return i},parseOpera11:function(r){return r.stack.split("\n").filter(function(e){return!!e.match(t)&&!e.match(/^Error created at/)},this).map(function(t){var r,n=t.split("@"),i=this.extractLocation(n.pop()),o=n.shift()||"",s=o.replace(/<anonymous function(: (\w+))?>/,"$2").replace(/\([^)]*\)/g,"")||void 0;return o.match(/\(([^)]*)\)/)&&(r=o.replace(/^[^(]+\(([^)]*)\)$/,"$1")),new e({functionName:s,args:void 0===r||"[arguments not available]"===r?void 0:r.split(","),fileName:i[0],lineNumber:i[1],columnNumber:i[2],source:t})},this)}}},"function"==typeof define&&define.amd?define("error-stack-parser",["stackframe"],L):cl=L(ea("22eJ0")),ea("33pli").SourceMapGenerator,ea("gyTFe").SourceMapConsumer,q=ea("8hfg7").SourceNode;var cc={};cc=ea("ioQH2");let cu=eJ(32,126).map(e=>String.fromCharCode(e)),ch=sh({name:"Whitespace",pattern:/ +/}),cd=sh({name:"WhitespaceSkipped",pattern:/ +/,group:se.SKIPPED}),cf=sh({name:"StringLiteral",pattern:/[^ $]+/,start_chars_hint:cu}),cp=sh({name:"StringLiteralDouble",pattern:/"(?:[^\\"]|\\(?:[^\n\r]|u[0-9a-fA-F]{4}))*"/}),cg=sh({name:"MaybeFlag",pattern:/\$[^ $]+/}),cm=sh({name:"NumberLiteral",pattern:/\$-?(\d*\.)?\d+([eE][+-]?\d+)?[jJ]?[lL]?\+?/}),cE=sh({name:"ContinueLine",pattern:/\\/});function cy(e,t=""){return sh({name:t||e,pattern:RegExp(e.toLowerCase(),"i")})}let c_=[["blue"],["green"],["cyan"],["red"],["purple"],["yellow"],["white"],["dkblue"],["dkgreen"],["dkcyan"],["dkred"],["dkpurple"],["dkyellow|brown","brown"],["dkwhite|ltgray|ltgrey|gray|grey","gray"],["dkgray|dkgrey|ltblack","dkgray"],["black"]],cT=c_.map(([e,t])=>cy(`\\$(${e})`,t||e)),cA=[...c_.map(([e,t])=>cy(`\\$on(${e})`,`on${t||e}`)),cy("\\$on(empty)","onempty")],cv=new se([ch,cE,...cT,...cA,cp,cf,cm,cg],{skipValidations:!aN,ensureOptimizations:aN}),cb=new se([cd,cE,...cT,...cA,cp,cf,cm,cg],{skipValidations:!aN,ensureOptimizations:aN});(0,cc.createContext)({measureOnly:!1,resetCheck:!0,x:0,y:0,isEven:!0,resetColor:15,resetBg:1,activeColor:15,activeBg:1,width:1,height:1,leftEdge:void 0,rightEdge:void 0,bottomEdge:void 0,char:[],color:[],bg:[]});let cR=0,cw=0,cO=["Command","lines"],cS=new class extends a_{constructor(){super(lE,{traceInitPerf:aN,skipValidations:!aN,maxLookahead:2,recoveryEnabled:!0,nodeLocationTracking:"full"}),this.program=this.RULED("program",()=>{this.MANY(()=>this.SUBRULE(this.line))}),this.line=this.RULED("line",()=>{this.OPTION(()=>this.SUBRULE(this.stmt)),this.AT_LEAST_ONE(()=>this.CONSUME(ax))}),this.stmt=this.RULED("stmt",()=>{this.OR([{ALT:()=>this.SUBRULE(this.stat)},{ALT:()=>this.SUBRULE(this.text)},{ALT:()=>this.SUBRULE(this.label)},{ALT:()=>this.SUBRULE(this.comment)},{ALT:()=>this.SUBRULE(this.commands)}])}),this.stat=this.RULED("stat",()=>{this.CONSUME(aP)}),this.text=this.RULED("text",()=>{this.CONSUME(aF)}),this.label=this.RULED("label",()=>{this.CONSUME(a$)}),this.comment=this.RULED("comment",()=>{this.CONSUME(aj)}),this.commands=this.RULED("commands",()=>{this.OR([{ALT:()=>{this.CONSUME(aD),this.AT_LEAST_ONE(()=>this.SUBRULE(this.command))}},{ALT:()=>{this.AT_LEAST_ONE(()=>this.SUBRULE(this.command))}}])}),this.command=this.RULED("command",()=>{this.OR([{ALT:()=>this.SUBRULE(this.flat_cmd)},{ALT:()=>this.SUBRULE(this.structured_cmd)}])}),this.flat_cmd=this.RULED("flat_cmd",()=>{this.OR([{ALT:()=>this.SUBRULE(this.words)},{ALT:()=>this.SUBRULE(this.hyperlink)},{ALT:()=>this.SUBRULE(this.Short_go)},{ALT:()=>this.SUBRULE(this.Short_try)},{ALT:()=>this.SUBRULE(this.Command_play)}])}),this.structured_cmd=this.RULED("structured_cmd",()=>{this.OR([{ALT:()=>this.SUBRULE(this.Command_if)},{ALT:()=>this.SUBRULE(this.Command_read)},{ALT:()=>this.SUBRULE(this.Command_while)},{ALT:()=>this.SUBRULE(this.Command_repeat)},{ALT:()=>this.SUBRULE(this.Command_break)},{ALT:()=>this.SUBRULE(this.Command_continue)}])}),this.hyperlink=this.RULED("hyperlink",()=>{this.CONSUME(aG),this.SUBRULE(this.words),this.CONSUME(aK)}),this.Short_go=this.RULED("Short_go",()=>{this.CONSUME(a4),this.SUBRULE(this.words)}),this.Short_try=this.RULED("Short_try",()=>{this.CONSUME(le),this.SUBRULE(this.words)}),this.Command_play=this.RULED("Command_play",()=>{this.CONSUME(ln)}),this.do_line=this.RULED("do_line",()=>{this.OPTION(()=>this.SUBRULE(this.do_stmt)),this.AT_LEAST_ONE(()=>this.CONSUME(ax))}),this.do_stmt=this.RULED("do_stmt",()=>{this.OR([{ALT:()=>this.SUBRULE(this.text)},{ALT:()=>this.SUBRULE(this.comment)},{ALT:()=>this.SUBRULE(this.commands)}])}),this.Command_if=this.RULED("Command_if",()=>{this.CONSUME(li),this.SUBRULE(this.words),this.OPTION(()=>{this.OR([{ALT:()=>this.SUBRULE(this.command)},{ALT:()=>{this.CONSUME(lo),this.AT_LEAST_ONE(()=>this.SUBRULE(this.do_line)),this.OR2([{GATE:this.BACKTRACK(this.Command_else_if),ALT:()=>this.SUBRULE(this.Command_else_if)},{GATE:this.BACKTRACK(this.Command_else),ALT:()=>this.SUBRULE(this.Command_else)},{GATE:this.BACKTRACK(this.Command_endif),ALT:()=>this.SUBRULE(this.Command_endif)}])}}])})}),this.Command_else_if=this.RULED("Command_else_if",()=>{this.CONSUME(aD),this.CONSUME(ls),this.CONSUME(li),this.SUBRULE(this.words),this.OPTION(()=>{this.OR([{ALT:()=>this.SUBRULE(this.command)},{ALT:()=>{this.CONSUME(lo),this.AT_LEAST_ONE(()=>this.SUBRULE(this.do_line)),this.OR2([{GATE:this.BACKTRACK(this.Command_else_if),ALT:()=>this.SUBRULE(this.Command_else_if)},{GATE:this.BACKTRACK(this.Command_else),ALT:()=>this.SUBRULE(this.Command_else)},{GATE:this.BACKTRACK(this.Command_endif),ALT:()=>this.SUBRULE(this.Command_endif)}])}}])})}),this.Command_else=this.RULED("Command_else",()=>{this.CONSUME(aD),this.CONSUME(ls),this.OPTION(()=>{this.OR([{ALT:()=>this.SUBRULE(this.command)},{ALT:()=>{this.CONSUME(lo),this.AT_LEAST_ONE(()=>this.SUBRULE(this.do_line)),this.SUBRULE(this.Command_endif)}}])})}),this.Command_endif=this.RULED("Command_endif",()=>{this.CONSUME(aD),this.CONSUME(la)}),this.Command_while=this.RULED("Command_while",()=>{this.CONSUME(aD),this.CONSUME(ll),this.SUBRULE(this.words),this.OPTION(()=>{this.OR([{ALT:()=>this.SUBRULE(this.command)},{ALT:()=>{this.CONSUME(lo),this.AT_LEAST_ONE(()=>this.SUBRULE(this.do_line)),this.CONSUME4(aD),this.CONSUME4(lc)}}])})}),this.Command_repeat=this.RULED("Command_repeat",()=>{this.CONSUME(aD),this.CONSUME(lu),this.SUBRULE(this.words),this.OPTION(()=>{this.OR([{ALT:()=>this.SUBRULE(this.command)},{ALT:()=>{this.CONSUME(lo),this.AT_LEAST_ONE(()=>this.SUBRULE(this.do_line)),this.CONSUME4(aD),this.CONSUME4(lh)}}])})}),this.Command_read=this.RULED("Command_read",()=>{this.CONSUME(aD),this.CONSUME(ld),this.SUBRULE(this.words),this.OPTION(()=>{this.OR([{ALT:()=>this.SUBRULE(this.command)},{ALT:()=>{this.CONSUME(lo),this.AT_LEAST_ONE(()=>this.SUBRULE(this.do_line)),this.CONSUME4(aD),this.CONSUME4(lf)}}])})}),this.Command_break=this.RULED("Command_break",()=>{this.CONSUME(lp)}),this.Command_continue=this.RULED("Command_continue",()=>{this.CONSUME(lg)}),this.expr=this.RULED("expr",()=>{this.SUBRULE1(this.and_test),this.MANY(()=>{this.CONSUME(a0),this.SUBRULE2(this.and_test)})}),this.and_test=this.RULED("and_test",()=>{this.SUBRULE1(this.not_test),this.MANY(()=>{this.CONSUME(a2),this.SUBRULE2(this.not_test)})}),this.not_test=this.RULED("not_test",()=>{this.OR([{ALT:()=>{this.CONSUME(a1),this.SUBRULE1(this.not_test)}},{ALT:()=>this.SUBRULE2(this.comparison)}])}),this.comparison=this.RULED("comparison",()=>{this.SUBRULE1(this.arith_expr),this.MANY(()=>{this.SUBRULE(this.comp_op),this.SUBRULE2(this.arith_expr)})}),this.comp_op=this.RULED("comp_op",()=>{this.OR([{ALT:()=>this.CONSUME(az)},{ALT:()=>this.CONSUME(aq)},{ALT:()=>this.CONSUME(aJ)},{ALT:()=>this.CONSUME(aX)},{ALT:()=>this.CONSUME(aQ)},{ALT:()=>this.CONSUME(aZ)}])}),this.expr_value=this.RULED("expr_value",()=>{this.SUBRULE1(this.and_test_value),this.MANY(()=>{this.CONSUME(a0),this.SUBRULE2(this.and_test_value)})}),this.and_test_value=this.RULED("and_test_value",()=>{this.SUBRULE1(this.not_test_value),this.MANY(()=>{this.CONSUME(a2),this.SUBRULE2(this.not_test_value)})}),this.not_test_value=this.RULED("not_test_value",()=>{this.OR([{ALT:()=>{this.CONSUME(a1),this.SUBRULE1(this.not_test_value)}},{ALT:()=>this.SUBRULE2(this.arith_expr)}])}),this.arith_expr=this.RULED("arith_expr",()=>{this.SUBRULE1(this.term),this.MANY(()=>this.SUBRULE2(this.arith_expr_item))}),this.arith_expr_item=this.RULED("arith_expr_item",()=>{this.OR([{ALT:()=>this.CONSUME(a6)},{ALT:()=>this.CONSUME(a8)}]),this.SUBRULE(this.term)}),this.term=this.RULED("term",()=>{this.SUBRULE1(this.factor),this.MANY(()=>this.SUBRULE2(this.term_item))}),this.term_item=this.RULED("term_item",()=>{this.OR([{ALT:()=>this.CONSUME(a5)},{ALT:()=>this.CONSUME(a4)},{ALT:()=>this.CONSUME(a7)},{ALT:()=>this.CONSUME(a9)}]),this.SUBRULE(this.factor)}),this.factor=this.RULED("factor",()=>{this.OR1([{ALT:()=>{this.OR2([{ALT:()=>this.CONSUME(a6)},{ALT:()=>this.CONSUME(a8)}]),this.SUBRULE(this.factor)}},{ALT:()=>this.SUBRULE(this.power)}])}),this.power=this.RULED("power",()=>{this.SUBRULE(this.token),this.OPTION(()=>{this.CONSUME(a3),this.SUBRULE(this.factor)})}),this.words=this.RULED("words",()=>{this.AT_LEAST_ONE(()=>this.SUBRULE(this.expr))}),this.token=this.RULED("token",()=>{this.OR([{ALT:()=>this.CONSUME(aH)},{ALT:()=>this.CONSUME(aW)},{ALT:()=>this.CONSUME(aY)},{ALT:()=>{this.CONSUME(lt),this.SUBRULE(this.expr),this.CONSUME(lr)}}])}),this.performSelfAnalysis()}PEEK(e,t,...r){console.info(e,r.map(e=>[e.image,e.tokenType]),t)}RULED(e,t,r){let n=cO.some(t=>e.includes(t));return this.RULE(e,()=>{let r=cR++,i=cw++,o=i.toString().padStart(3),s=" ".repeat(i),a=n?"font-weight: bold;":"";if(aN&&!this.RECORDING_PHASE){let t=[this.LA(0),this.LA(1),this.LA(2)].map(e=>[`[${e.tokenType.name}]`,e.image.replaceAll("\n","\\n")]).flat();console.info(`${o}%c${s}> ${e} ${r} ${t.join(" ")}`,a)}t(),aN&&!this.RECORDING_PHASE&&console.info(`${o}%c${s}< ${e} ${r}`,a),cw--},r)}},cL=cS.getBaseCstVisitorConstructor();function ck(e,t){return(t?.map(t=>e.visit(t)).filter(e=>e)||[]).flat()}function cN(e){return e.image}function cC(e,t){return cI(e,{type:7,literal:1,value:t})}function cI(e,t){return{...t,...function(e){let t=Object.values(e).flat().filter(e=>!!e).map(e=>e&&e?.tokenType?{startLine:e.startLine,startColumn:e.startColumn,startOffset:e.startOffset,endLine:e.endLine,endColumn:e.endColumn,endOffset:e.endOffset}:e?.location?{...e.location}:{startLine:0,startColumn:0,startOffset:0,endLine:0,endColumn:0,endOffset:0}).filter(e=>0!==e.startLine&&0!==e.endLine);return{startLine:Math.min(...t.map(e=>e.startLine||1)),startColumn:Math.min(...t.map(e=>e.startColumn||1)),startOffset:Math.min(...t.map(e=>e.startOffset||1)),endLine:Math.max(...t.map(e=>e.endLine||1)),endColumn:Math.max(...t.map(e=>e.endColumn||1)),endOffset:Math.max(...t.map(e=>e.endOffset||1))}}(e)}}(k=J||(J={}))[k.PROGRAM=0]="PROGRAM",k[k.TEXT=1]="TEXT",k[k.LABEL=2]="LABEL",k[k.HYPERLINK=3]="HYPERLINK",k[k.STAT=4]="STAT",k[k.MOVE=5]="MOVE",k[k.COMMAND=6]="COMMAND",k[k.LITERAL=7]="LITERAL",k[k.IF=8]="IF",k[k.ELSE_IF=9]="ELSE_IF",k[k.ELSE=10]="ELSE",k[k.WHILE=11]="WHILE",k[k.BREAK=12]="BREAK",k[k.CONTINUE=13]="CONTINUE",k[k.REPEAT=14]="REPEAT",k[k.READ=15]="READ",k[k.OR=16]="OR",k[k.AND=17]="AND",k[k.NOT=18]="NOT",k[k.COMPARE=19]="COMPARE",k[k.OPERATOR=20]="OPERATOR",k[k.OPERATOR_ITEM=21]="OPERATOR_ITEM",k[k.EXPR=22]="EXPR",(N=X||(X={}))[N.IS_EQ=0]="IS_EQ",N[N.IS_NOT_EQ=1]="IS_NOT_EQ",N[N.IS_LESS_THAN=2]="IS_LESS_THAN",N[N.IS_GREATER_THAN=3]="IS_GREATER_THAN",N[N.IS_LESS_THAN_OR_EQ=4]="IS_LESS_THAN_OR_EQ",N[N.IS_GREATER_THAN_OR_EQ=5]="IS_GREATER_THAN_OR_EQ",(C=Q||(Q={}))[C.EMPTY=0]="EMPTY",C[C.PLUS=1]="PLUS",C[C.MINUS=2]="MINUS",C[C.POWER=3]="POWER",C[C.MULTIPLY=4]="MULTIPLY",C[C.DIVIDE=5]="DIVIDE",C[C.MOD_DIVIDE=6]="MOD_DIVIDE",C[C.FLOOR_DIVIDE=7]="FLOOR_DIVIDE",C[C.UNI_PLUS=8]="UNI_PLUS",C[C.UNI_MINUS=9]="UNI_MINUS",(I=Z||(Z={}))[I.NUMBER=0]="NUMBER",I[I.STRING=1]="STRING",I[I.TEMPLATE=2]="TEMPLATE";let cx=new class extends cL{constructor(){super(),aN&&this.validateVisitor()}program(e){return cI(e,{type:0,lines:ck(this,e.line)})}line(e){if(e.stmt)return this.visit(e.stmt)}stmt(e){return e.stat?this.visit(e.stat):e.text?this.visit(e.text):e.label?this.visit(e.label):e.comment?this.visit(e.comment):e.commands?this.visit(e.commands):void 0}stat(){}text(e){if(e.Text)return cI(e,{type:1,value:cN(e.Text[0])})}label(e){return cI(e,{type:2,active:!0,name:cN(e.Label?.[0]??":").slice(1).trim()})}comment(e){return cI(e,{type:2,active:!1,name:cN(e.Comment[0]).slice(1).trim()})}commands(e){return ck(this,e.command)}command(e){return e.flat_cmd?this.visit(e.flat_cmd):e.structured_cmd?this.visit(e.structured_cmd):void 0}flat_cmd(e){return e.words?cI(e,{type:6,words:ck(this,e.words).flat()}):e.hyperlink?this.visit(e.hyperlink):e.Short_go?this.visit(e.Short_go):e.Short_try?this.visit(e.Short_try):e.Command_play?this.visit(e.Command_play):void 0}structured_cmd(e){return e.Command_if?this.visit(e.Command_if):e.Command_read?this.visit(e.Command_read):e.Command_while?this.visit(e.Command_while):e.Command_repeat?this.visit(e.Command_repeat):e.Command_break?this.visit(e.Command_break):e.Command_continue?this.visit(e.Command_continue):void 0}hyperlink(e){return cI(e,{type:3,link:ck(this,e.words).flat(),text:cN(e.HyperLinkText?.[0]??";").slice(1)})}Short_go(e){if(e.Divide)return cI(e,{type:5,wait:!0,words:ck(this,e.words).flat()})}Short_try(e){if(e.Query)return cI(e,{type:5,wait:!1,words:ck(this,e.words).flat()})}Command_play(e){if(e.Command_play)return cI(e,{type:6,words:[cC(e,"play"),cC(e,cN(e.Command_play[0]).replace("#play","").trim())]})}do_line(e){return this.visit(e.do_stmt)}do_stmt(e){return e.text?this.visit(e.text):e.comment?this.visit(e.comment):e.commands?this.visit(e.commands):void 0}Command_if(e){let t=ck(this,e.words).flat(),r=[this.visit(e.command),...ck(this,e.do_line)].flat(),n=[this.visit(e.Command_else_if),this.visit(e.Command_else)].flat();return cI(e,{type:8,method:"if",words:t.filter(eW),lines:r.filter(eW),branches:n.filter(eW)})}Command_else_if(e){let t=ck(this,e.words).flat(),r=[this.visit(e.command),...ck(this,e.do_line)].flat(),n=ck(this,e.Command_else_if).flat();return[cI(e,{type:9,method:"if",words:t.filter(eW),lines:r.filter(eW)}),...n.filter(eW),this.visit(e.Command_else)]}Command_else(e){let t=ck(this,e.words).flat(),r=[this.visit(e.command),...ck(this,e.do_line)].flat();return cI(e,{type:10,method:"if",words:t.filter(eW),lines:r.filter(eW)})}Command_endif(){}Command_while(e){let t=ck(this,e.words).flat(),r=[this.visit(e.command),...ck(this,e.do_line)].flat();return cI(e,{type:11,words:t.filter(eW),lines:r.filter(eW)})}Command_repeat(e){let t=ck(this,e.words).flat(),r=[this.visit(e.command),...ck(this,e.do_line)].flat();return cI(e,{type:14,words:t.filter(eW),lines:r.filter(eW)})}Command_read(e){let t=ck(this,e.words).flat(),r=[this.visit(e.command),...ck(this,e.do_line)].flat();return cI(e,{type:15,words:t.filter(eW),lines:r.filter(eW)})}Command_break(e){return cI(e,{type:12})}Command_continue(e){return cI(e,{type:13})}expr(e){return 1===e.and_test.length?this.visit(e.and_test):cI(e,{type:16,items:this.visit(e.and_test)})}and_test(e){return 1===e.not_test.length?this.visit(e.not_test):cI(e,{type:17,items:this.visit(e.not_test)})}not_test(e){return e.comparison?this.visit(e.comparison):e.not_test?cI(e,{type:18,items:this.visit(e.not_test)}):void 0}comparison(e){return 1===e.arith_expr.length?this.visit(e.arith_expr):cI(e,{type:19,lhs:this.visit(e.arith_expr[0]),compare:this.visit(e.comp_op),rhs:this.visit(e.arith_expr[1])})}comp_op(e){return e.is||e.IsEq?0:e.IsNotEq?1:e.IsLessThan?2:e.IsGreaterThan?3:e.IsLessThanOrEqual?4:e.IsGreaterThanOrEqual?5:void 0}expr_value(e){return 1===e.and_test_value.length?this.visit(e.and_test_value):cI(e,{type:16,items:this.visit(e.and_test_value)})}and_test_value(e){return 1===e.not_test_value.length?this.visit(e.not_test_value):cI(e,{type:17,items:this.visit(e.not_test_value)})}not_test_value(e){return e.arith_expr?this.visit(e.arith_expr):e.not_test?cI(e,{type:18,items:this.visit(e.not_test)}):void 0}arith_expr(e){let t=this.visit(e.term);return e.arith_expr_item?cI(e,{type:20,lhs:t,items:this.visit(e.arith_expr_item)}):t}arith_expr_item(e){return cI(e,{type:21,operator:e.Plus?1:2,rhs:this.visit(e.term)})}term(e){return e.term_item?cI(e,{type:20,lhs:this.visit(e.factor),items:this.visit(e.term_item)}):this.visit(e.factor)}term_item(e){let t=0;return e.Multiply&&(t=4),e.Divide&&(t=5),e.ModDivide&&(t=6),e.FloorDivide&&(t=7),cI(e,{type:21,operator:t,rhs:this.visit(e.factor)})}factor(e){if(e.power)return this.visit(e.power);let t=0;return e.Plus&&(t=8),e.Minus&&(t=9),cI(e,{type:20,lhs:void 0,items:[cI(e,{type:21,operator:t,rhs:this.visit(e.factor)})]})}power(e){let t=this.visit(e.token);return e.factor?cI(e,{type:20,lhs:t,items:[cI(e,{type:21,operator:3,rhs:this.visit(e.factor)})]}):t}words(e){return ck(this,e.expr)}token(e){if(e.StringLiteralDouble){let t=cN(e.StringLiteralDouble[0]);return cI(e,{type:7,literal:2,value:t.substring(1,t.length-1)})}return e.StringLiteral?cI(e,{type:7,literal:1,value:cN(e.StringLiteral[0])}):e.NumberLiteral?cI(e,{type:7,literal:0,value:parseFloat(cN(e.NumberLiteral[0]))}):e.LParen?cI(e,{type:22,words:ck(this,e.expr).flat()}):void 0}},cM={internal:0,labels:{},labelIndex:0},cU="if (api.hm()) { continue zss; }",cP=`if (api.sy()) { yield 1; ${cU} };`,cD=`yield 1; ${cU}`,cB="zss.js";function cF(e,t){return new q(e.startLine||1,e.startColumn||1,cB,t)}function cj(e){return e.replace(/\\/g,"\\\\").replace(/'/g,"\\'")}function c$(e){if('"'===e[0])return c$(e.substring(1,e.length-1));let t=function(e,t=!1){return t?cb.tokenize(e):cv.tokenize(e)}(e);if(t.errors.length)return e;let r=t.tokens.map(e=>{if(e.tokenType===cg){let t=cj(e.image.substring(1));return`', api.group('${t}'), '`}return cj(e.image)});return`'${r.join("")}'`}function cG(e){return e.filter(e=>void 0!==e).map(cY)}function cK(e,t,r){return cF(e,[`api.${t}(`,...function(e,t){let r=[];return e.forEach(e=>{r.push(e,", ")}),r.pop(),r}(r,0),")"])}function cW(e,t,r,n){return t.prepend(`api.${r}(`),t.add([", ",cY(n),")"])}function cH(e,t,r,n){return t.prepend(`api.${r}(`),t.add([cY(n),")"])}function cY(e){switch(e.type){case J.PROGRAM:return cF(e,[`try { // first-line
`,`zss: while (true) {
`,`switch (api.getcase()) {
`,`default:
`,`case 1: 
`,...e.lines.map(e=>[cY(e),`
`]).flat(),`}
`,`api.endofprogram();
`,`while(true) { ${cD} }
`,`}
`,`} catch (e) {
`,`console.error(e);
`,`const source = api.stacktrace(e);
`,`const err = new Error(e.message);
`,`err.name = 'GameError';
`,`err.meta = { line: source.line, column: source.column };
`,`throw err;
`,`}
`,`//# sourceURL=${cB}`]);case J.LITERAL:switch(e.literal){case Z.NUMBER:return cF(e,`${e.value}`);case Z.STRING:var t;return cF(e,(t=e.value,`'${cj(t)}'`));case Z.TEMPLATE:return cF(e,c$(e.value))}return cF(e,"");case J.TEXT:return cK(e,"text",[c$(e.value)]);case J.STAT:return cK(e,"stat",cG(e.words));case J.LABEL:{let t=cM.labelIndex++;return cM.labels[e.name]||(cM.labels[e.name]=[]),cM.labels[e.name].push(e.active?t:-t),cF(e,`case ${t}: // ${e.name}`)}case J.HYPERLINK:return cK(e,"hyperlink",[c$(e.text),...cG(e.link)]);case J.MOVE:return cF(e,["while (",cK(e,"move",[e.wait?"true":"false",...cG(e.words)]),`) { ${cD} };
         ${cP} ${cU}`]);case J.COMMAND:return cF(e,["while (",cK(e,"command",cG(e.words)),`) { ${cD} };
         ${cP} ${cU}`]);case J.IF:{let t=cF(e,["if (",cK(e,`${e.method}`,cG(e.words)),`) {
`]);return e.lines&&e.lines.forEach(e=>t.add([cY(e),`
`])),e.branches&&e.branches.forEach(e=>t.add(cY(e))),t.add("}"),t}case J.ELSE_IF:{let t=cF(e,["} else if (",cK(e,e.method,cG(e.words)),`) {
`]);return e.lines&&e.lines.forEach(e=>t.add([cY(e),`
`])),t}case J.ELSE:{let t=cF(e,`} else {
`);return e.words.length&&t.add(["while (",cK(e,"command",cG(e.words)),`) { ${cD} };`]),e.lines&&e.lines.forEach(e=>t.add([cY(e),`
`])),t}case J.WHILE:{let t=cF(e,["while (",cK(e,"if",cG(e.words)),`) {
`]);return e.lines&&e.lines.forEach(e=>t.add([cY(e),"\n"])),t.add("}"),t}case J.REPEAT:{let t=cF(e,[cK(e,"repeatStart",[`${cM.internal}`,...cG(e.words)]),";\nwhile (",cK(e,"repeat",[`${cM.internal}`]),`) {
`]);return cM.internal+=1,e.lines&&e.lines.forEach(e=>t.add([cY(e),"\n"])),t.add("}"),t}case J.READ:{let[t,...r]=e.words,n=cF(e,[cK(e,"readStart",[`${cM.internal}`,cY(t)]),";\nwhile (",cK(e,"read",[`${cM.internal}`,...cG(r)]),`) {
`]);return cM.internal+=1,e.lines&&e.lines.forEach(e=>n.add([cY(e),"\n"])),n.add("}"),n}case J.BREAK:return cF(e,`break;
`);case J.CONTINUE:return cF(e,`continue;
`);case J.OR:return cK(e,"or",e.items.map(cY));case J.AND:return cK(e,"and",e.items.map(cY));case J.NOT:return cK(e,"not",e.items.map(cY));case J.COMPARE:return function(e){if(e.type===J.COMPARE)switch(e.compare){case X.IS_EQ:return cK(e,"isEq",[cY(e.lhs),cY(e.rhs)]);case X.IS_NOT_EQ:return cK(e,"isNotEq",[cY(e.lhs),cY(e.rhs)]);case X.IS_LESS_THAN:return cK(e,"isLessThan",[cY(e.lhs),cY(e.rhs)]);case X.IS_GREATER_THAN:return cK(e,"isGreaterThan",[cY(e.lhs),cY(e.rhs)]);case X.IS_LESS_THAN_OR_EQ:return cK(e,"isLessThanOrEq",[cY(e.lhs),cY(e.rhs)]);case X.IS_GREATER_THAN_OR_EQ:return cK(e,"isGreaterThanOrEq",[cY(e.lhs),cY(e.rhs)])}return cF(e,"")}(e);case J.OPERATOR:return function(e){if(e.type===J.OPERATOR){let t=e.lhs?cY(e.lhs):cF(e,"");return e.items.forEach(e=>(function(e,t){if(e.type===J.OPERATOR_ITEM)switch(e.operator){case Q.PLUS:return cW(e,t,"opPlus",e.rhs);case Q.MINUS:return cW(e,t,"opMinus",e.rhs);case Q.POWER:return cW(e,t,"opPower",e.rhs);case Q.MULTIPLY:return cW(e,t,"opMultiply",e.rhs);case Q.DIVIDE:return cW(e,t,"opDivide",e.rhs);case Q.MOD_DIVIDE:return cW(e,t,"opModDivide",e.rhs);case Q.FLOOR_DIVIDE:return cW(e,t,"opFloorDivide",e.rhs);case Q.UNI_PLUS:return cH(e,t,"opUniPlus",e.rhs);case Q.UNI_MINUS:return cH(e,t,"opUniMinus",e.rhs)}return cF(e,"")})(e,t)),t}return cF(e,"")}(e);case J.EXPR:return cK(e,"expr",e.words.map(cY));default:return console.error("<unsupported node>",e),cF(e,"")}}function cV(e){return`${e??""}`}function cz(e){let t={},r={...e,getcommand:e=>t[e],command:(e,n)=>(t[e]=n,r)};return r}let cq=cz({get:(e,t)=>[!1,void 0],set:(e,t,r)=>[!1,void 0],tick(e){},tock(e){}}).command("play",(e,t)=>0);var cJ={};/*! Case - v1.6.2 - 2020-03-24
* Copyright (c) 2020 Nathan Bubna; Licensed MIT, GPL */(function(){var e=function(e,t){return t=t||"",e.replace(/(^|-)/g,"$1\\u"+t).replace(/,/g,"\\u"+t)},t=e("20-26,28-2F,3A-40,5B-60,7B-7E,A0-BF,D7,F7","00"),r="a-z"+e("DF-F6,F8-FF","00"),n="A-Z"+e("C0-D6,D8-DE","00"),i=function(e,i,o,s){return e=e||t,i=i||r,o=o||n,s=s||"A|An|And|As|At|But|By|En|For|If|In|Of|On|Or|The|To|Vs?\\.?|Via",{capitalize:RegExp("(^|["+e+"])(["+i+"])","g"),pascal:RegExp("(^|["+e+"])+(["+i+o+"])","g"),fill:RegExp("["+e+"]+(.|$)","g"),sentence:RegExp('(^\\s*|[\\?\\!\\.]+"?\\s+"?|,\\s+")(['+i+"])","g"),improper:RegExp("\\b("+s+")\\b","g"),relax:RegExp("([^"+o+"])(["+o+"]*)(["+o+"])(?=[^"+o+"]|$)","g"),upper:RegExp("^[^"+i+"]+$"),hole:/[^\s]\s[^\s]/,apostrophe:/'/g,room:RegExp("["+e+"]")}},o=i(),s={re:o,unicodes:e,regexps:i,types:[],up:String.prototype.toUpperCase,low:String.prototype.toLowerCase,cap:function(e){return s.up.call(e.charAt(0))+e.slice(1)},decap:function(e){return s.low.call(e.charAt(0))+e.slice(1)},deapostrophe:function(e){return e.replace(o.apostrophe,"")},fill:function(e,t,r){return null!=t&&(e=e.replace(o.fill,function(e,r){return r?t+r:""})),r&&(e=s.deapostrophe(e)),e},prep:function(e,t,r,n){if(e=null==e?"":e+"",!n&&o.upper.test(e)&&(e=s.low.call(e)),!t&&!o.hole.test(e)){var i=s.fill(e," ");o.hole.test(i)&&(e=i)}return r||o.room.test(e)||(e=e.replace(o.relax,s.relax)),e},relax:function(e,t,r,n){return t+" "+(r?r+" ":"")+n}},a={_:s,of:function(e){for(var t=0,r=s.types.length;t<r;t++)if(a[s.types[t]].apply(a,arguments)===e)return s.types[t]},flip:function(e){return e.replace(/\w/g,function(e){return(e==s.up.call(e)?s.low:s.up).call(e)})},random:function(e){return e.replace(/\w/g,function(e){return(Math.round(Math.random())?s.up:s.low).call(e)})},type:function(e,t){a[e]=t,s.types.push(e)}},l={lower:function(e,t,r){return s.fill(s.low.call(s.prep(e,t)),t,r)},snake:function(e){return a.lower(e,"_",!0)},constant:function(e){return a.upper(e,"_",!0)},camel:function(e){return s.decap(a.pascal(e))},kebab:function(e){return a.lower(e,"-",!0)},upper:function(e,t,r){return s.fill(s.up.call(s.prep(e,t,!1,!0)),t,r)},capital:function(e,t,r){return s.fill(s.prep(e).replace(o.capitalize,function(e,t,r){return t+s.up.call(r)}),t,r)},header:function(e){return a.capital(e,"-",!0)},pascal:function(e){return s.fill(s.prep(e,!1,!0).replace(o.pascal,function(e,t,r){return s.up.call(r)}),"",!0)},title:function(e){return a.capital(e).replace(o.improper,function(e,t,r,n){return r>0&&r<n.lastIndexOf(" ")?s.low.call(e):e})},sentence:function(e,t,r){return e=a.lower(e).replace(o.sentence,function(e,t,r){return t+s.up.call(r)}),t&&t.forEach(function(t){e=e.replace(RegExp("\\b"+a.lower(t)+"\\b","g"),s.cap)}),r&&r.forEach(function(t){e=e.replace(RegExp("(\\b"+a.lower(t)+"\\. +)(\\w)"),function(e,t,r){return t+s.low.call(r)})}),e}};for(var c in l.squish=l.pascal,a.default=a,l)a.type(c,l[c]);("function"==typeof define1?define1:function(){})(cJ?cJ=a:this.Case=a)}).call(cJ);let cX=Math.floor,cQ=Math.abs,cZ=(e,t)=>e<t?e:t,c0=(e,t)=>e>t?e:t,c1=e=>0!==e?e<0:1/e<0,c2=Number.MAX_SAFE_INTEGER,c6=Number.isInteger||(e=>"number"==typeof e&&isFinite(e)&&cX(e)===e),c8=()=>new Set,c3=e=>e[e.length-1],c5=(e,t)=>{for(let r=0;r<t.length;r++)e.push(t[r])},c4=Array.from,c7=Array.isArray;(0,String.fromCharCode)(65535);let c9=e=>e.toLowerCase(),ue=/^\s*/g,ut=e=>e.replace(ue,""),ur=/([A-Z])/g,un=(e,t)=>ut(e.replace(ur,e=>`${t}${c9(e)}`)),ui="undefined"!=typeof TextEncoder?new TextEncoder:null,uo=ui?e=>ui.encode(e):e=>{let t=unescape(encodeURIComponent(e)),r=t.length,n=new Uint8Array(r);for(let e=0;e<r;e++)n[e]=t.codePointAt(e);return n},us="undefined"==typeof TextDecoder?null:new TextDecoder("utf-8",{fatal:!0,ignoreBOM:!0});us&&1===us.decode(new Uint8Array).length&&(us=null);let ua=e=>Error(e),ul=()=>{throw ua("Method unimplemented")},uc=()=>{throw ua("Unexpected case")};class uu{constructor(){this.cpos=0,this.cbuf=new Uint8Array(100),this.bufs=[]}}let uh=()=>new uu,ud=e=>{let t=e.cpos;for(let r=0;r<e.bufs.length;r++)t+=e.bufs[r].length;return t},uf=e=>{let t=new Uint8Array(ud(e)),r=0;for(let n=0;n<e.bufs.length;n++){let i=e.bufs[n];t.set(i,r),r+=i.length}return t.set(new Uint8Array(e.cbuf.buffer,0,e.cpos),r),t},up=(e,t)=>{let r=e.cbuf.length;r-e.cpos<t&&(e.bufs.push(new Uint8Array(e.cbuf.buffer,0,e.cpos)),e.cbuf=new Uint8Array(2*c0(r,t)),e.cpos=0)},ug=(e,t)=>{let r=e.cbuf.length;e.cpos===r&&(e.bufs.push(e.cbuf),e.cbuf=new Uint8Array(2*r),e.cpos=0),e.cbuf[e.cpos++]=t},um=(e,t)=>{for(;t>127;)ug(e,128|127&t),t=cX(t/128);ug(e,127&t)},uE=(e,t)=>{let r=c1(t);for(r&&(t=-t),ug(e,(t>63?128:0)|(r?64:0)|63&t),t=cX(t/64);t>0;)ug(e,(t>127?128:0)|127&t),t=cX(t/128)},uy=new Uint8Array(3e4),u_=uy.length/3,uT=ui&&ui.encodeInto?(e,t)=>{if(t.length<u_){let r=ui.encodeInto(t,uy).written||0;um(e,r);for(let t=0;t<r;t++)ug(e,uy[t])}else uv(e,uo(t))}:(e,t)=>{let r=unescape(encodeURIComponent(t)),n=r.length;um(e,n);for(let t=0;t<n;t++)ug(e,r.codePointAt(t))},uA=(e,t)=>{let r=e.cbuf.length,n=e.cpos,i=cZ(r-n,t.length),o=t.length-i;e.cbuf.set(t.subarray(0,i),n),e.cpos+=i,o>0&&(e.bufs.push(e.cbuf),e.cbuf=new Uint8Array(c0(2*r,o)),e.cbuf.set(t.subarray(i)),e.cpos=o)},uv=(e,t)=>{um(e,t.byteLength),uA(e,t)},ub=(e,t)=>{up(e,t);let r=new DataView(e.cbuf.buffer,e.cpos,t);return e.cpos+=t,r},uR=(e,t)=>ub(e,4).setFloat32(0,t,!1),uw=(e,t)=>ub(e,8).setFloat64(0,t,!1),uO=(e,t)=>ub(e,8).setBigInt64(0,t,!1),uS=new DataView(new ArrayBuffer(4)),uL=e=>(uS.setFloat32(0,e),uS.getFloat32(0)===e),uk=(e,t)=>{switch(typeof t){case"string":ug(e,119),uT(e,t);break;case"number":c6(t)&&2147483647>=cQ(t)?(ug(e,125),uE(e,t)):uL(t)?(ug(e,124),uR(e,t)):(ug(e,123),uw(e,t));break;case"bigint":ug(e,122),uO(e,t);break;case"object":if(null===t)ug(e,126);else if(c7(t)){ug(e,117),um(e,t.length);for(let r=0;r<t.length;r++)uk(e,t[r])}else if(t instanceof Uint8Array)ug(e,116),uv(e,t);else{ug(e,118);let r=Object.keys(t);um(e,r.length);for(let n=0;n<r.length;n++){let i=r[n];uT(e,i),uk(e,t[i])}}break;case"boolean":ug(e,t?120:121);break;default:ug(e,127)}};class uN extends uu{constructor(e){super(),this.w=e,this.s=null,this.count=0}write(e){this.s===e?this.count++:(this.count>0&&um(this,this.count-1),this.count=1,this.w(this,e),this.s=e)}}let uC=e=>{e.count>0&&(uE(e.encoder,1===e.count?e.s:-e.s),e.count>1&&um(e.encoder,e.count-2))};class uI{constructor(){this.encoder=new uu,this.s=0,this.count=0}write(e){this.s===e?this.count++:(uC(this),this.count=1,this.s=e)}toUint8Array(){return uC(this),uf(this.encoder)}}let ux=e=>{if(e.count>0){let t=2*e.diff+(1===e.count?0:1);uE(e.encoder,t),e.count>1&&um(e.encoder,e.count-2)}};class uM{constructor(){this.encoder=new uu,this.s=0,this.count=0,this.diff=0}write(e){this.diff===e-this.s?(this.s=e,this.count++):(ux(this),this.count=1,this.diff=e-this.s,this.s=e)}toUint8Array(){return ux(this),uf(this.encoder)}}class uU{constructor(){this.sarr=[],this.s="",this.lensE=new uI}write(e){this.s+=e,this.s.length>19&&(this.sarr.push(this.s),this.s=""),this.lensE.write(e.length)}toUint8Array(){let e=new uu;return this.sarr.push(this.s),this.s="",uT(e,this.sarr.join("")),uA(e,this.lensE.toUint8Array()),uf(e)}}let uP=ua("Unexpected end of array"),uD=ua("Integer out of Range");class uB{constructor(e){this.arr=e,this.pos=0}}let uF=e=>new uB(e),uj=e=>e.pos!==e.arr.length,u$=(e,t)=>{let r=new Uint8Array(e.arr.buffer,e.pos+e.arr.byteOffset,t);return e.pos+=t,r},uG=e=>u$(e,uW(e)),uK=e=>e.arr[e.pos++],uW=e=>{let t=0,r=1,n=e.arr.length;for(;e.pos<n;){let n=e.arr[e.pos++];if(t+=(127&n)*r,r*=128,n<128)return t;if(t>c2)throw uD}throw uP},uH=e=>{let t=e.arr[e.pos++],r=63&t,n=64,i=(64&t)>0?-1:1;if((128&t)==0)return i*r;let o=e.arr.length;for(;e.pos<o;){if(r+=(127&(t=e.arr[e.pos++]))*n,n*=128,t<128)return i*r;if(r>c2)throw uD}throw uP},uY=us?e=>us.decode(uG(e)):e=>{let t=uW(e);if(0===t)return"";{let r=String.fromCodePoint(uK(e));if(--t<100)for(;t--;)r+=String.fromCodePoint(uK(e));else for(;t>0;){let n=t<1e4?t:1e4,i=e.arr.subarray(e.pos,e.pos+n);e.pos+=n,r+=String.fromCodePoint.apply(null,i),t-=n}return decodeURIComponent(escape(r))}},uV=(e,t)=>{let r=new DataView(e.arr.buffer,e.arr.byteOffset+e.pos,t);return e.pos+=t,r},uz=[e=>void 0,e=>null,uH,e=>uV(e,4).getFloat32(0,!1),e=>uV(e,8).getFloat64(0,!1),e=>uV(e,8).getBigInt64(0,!1),e=>!1,e=>!0,uY,e=>{let t=uW(e),r={};for(let n=0;n<t;n++)r[uY(e)]=uq(e);return r},e=>{let t=uW(e),r=[];for(let n=0;n<t;n++)r.push(uq(e));return r},uG],uq=e=>uz[127-uK(e)](e);class uJ extends uB{constructor(e,t){super(e),this.reader=t,this.s=null,this.count=0}read(){return 0===this.count&&(this.s=this.reader(this),uj(this)?this.count=uW(this)+1:this.count=-1),this.count--,this.s}}class uX extends uB{constructor(e){super(e),this.s=0,this.count=0}read(){if(0===this.count){this.s=uH(this);let e=c1(this.s);this.count=1,e&&(this.s=-this.s,this.count=uW(this)+2)}return this.count--,this.s}}class uQ extends uB{constructor(e){super(e),this.s=0,this.count=0,this.diff=0}read(){if(0===this.count){let e=uH(this);this.diff=cX(e/2),this.count=1,1&e&&(this.count=uW(this)+2)}return this.s+=this.diff,this.count--,this.s}}class uZ{constructor(e){this.decoder=new uX(e),this.str=uY(this.decoder),this.spos=0}read(){let e=this.spos+this.decoder.read(),t=this.str.slice(this.spos,e);return this.spos=e,t}}let u0=()=>new Map,u1=e=>{let t=u0();return e.forEach((e,r)=>{t.set(r,e)}),t},u2=(e,t,r)=>{let n=e.get(t);return void 0===n&&e.set(t,n=r()),n},u6=(e,t)=>{let r=[];for(let[n,i]of e)r.push(t(i,n));return r},u8=(e,t)=>{for(let[r,n]of e)if(t(n,r))return!0;return!1};class u3{constructor(){this._observers=u0()}on(e,t){u2(this._observers,e,c8).add(t)}once(e,t){let r=(...n)=>{this.off(e,r),t(...n)};this.on(e,r)}off(e,t){let r=this._observers.get(e);void 0!==r&&(r.delete(t),0===r.size&&this._observers.delete(e))}emit(e,t){return c4((this._observers.get(e)||u0()).values()).forEach(e=>e(...t))}destroy(){this._observers=u0()}}crypto.subtle;let u5=crypto.getRandomValues.bind(crypto),u4=()=>u5(new Uint32Array(1))[0],u7=()=>"10000000-1000-4000-8000-100000000000".replace(/[018]/g,e=>(e^u4()&15>>e/4).toString(16)),u9=Date.now,he=e=>new Promise(e);Promise.all.bind(Promise);let ht=e=>void 0===e?null:e,hr=new class{constructor(){this.map=new Map}setItem(e,t){this.map.set(e,t)}getItem(e){return this.map.get(e)}};try{"undefined"!=typeof localStorage&&localStorage&&(hr=localStorage)}catch(e){}let hn=hr,hi=Object.assign,ho=Object.keys,hs=(e,t)=>{for(let r in e)t(e[r],r)},ha=e=>ho(e).length,hl=e=>{for(let t in e)return!1;return!0},hc=(e,t)=>{for(let r in e)if(!t(e[r],r))return!1;return!0},hu=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),hh=(e,t)=>e===t||ha(e)===ha(t)&&hc(e,(e,r)=>(void 0!==e||hu(t,r))&&t[r]===e),hd=(e,t,r=0)=>{try{for(;r<e.length;r++)e[r](...t)}finally{r<e.length&&hd(e,t,r+1)}},hf=e=>e;var hp=ea("OJkA4");let hg=void 0!==hp&&hp.release&&/node|io\.js/.test(hp.release.name)&&"[object process]"===Object.prototype.toString.call(void 0!==hp?hp:0);"undefined"!=typeof navigator&&/Mac/.test(navigator.platform);let hm=[],hE=()=>{if(void 0===e){if(hg){e=u0();let t=hp.argv,r=null;for(let n=0;n<t.length;n++){let i=t[n];"-"===i[0]?(null!==r&&e.set(r,""),r=i):null!==r?(e.set(r,i),r=null):hm.push(i)}null!==r&&e.set(r,"")}else"object"==typeof location?(e=u0(),(location.search||"?").slice(1).split("&").forEach(t=>{if(0!==t.length){let[r,n]=t.split("=");e.set(`--${un(r,"-")}`,n),e.set(`-${un(r,"-")}`,n)}})):e=u0()}return e},hy=e=>hE().has(e),h_=e=>hg?ht(hp.env[e.toUpperCase()]):ht(hn.getItem(e));hy("--"+(x="production"))||h_(x);let hT=hg&&["true","1","2"].includes(void 0),hA=!hy("no-colors")&&(!hg||hp.stdout.isTTY||hT)&&(!hg||hy("color")||hT||null!==h_("COLORTERM")||(h_("TERM")||"").includes("color"));ee=function(e){for(var t,r=e.length,n=r%3,i=[],o=0,s=r-n;o<s;o+=16383)i.push(function(e,t,r){for(var n,i=[],o=t;o<r;o+=3)i.push(hv[(n=(e[o]<<16&16711680)+(e[o+1]<<8&65280)+(255&e[o+2]))>>18&63]+hv[n>>12&63]+hv[n>>6&63]+hv[63&n]);return i.join("")}(e,o,o+16383>s?s:o+16383));return 1===n?i.push(hv[(t=e[r-1])>>2]+hv[t<<4&63]+"=="):2===n&&i.push(hv[(t=(e[r-2]<<8)+e[r-1])>>10]+hv[t>>4&63]+hv[t<<2&63]+"="),i.join("")};for(var hv=[],hb=[],hR="undefined"!=typeof Uint8Array?Uint8Array:Array,hw="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",hO=0,hS=hw.length;hO<hS;++hO)hv[hO]=hw[hO],hb[hw.charCodeAt(hO)]=hO;hb["-".charCodeAt(0)]=62,hb["_".charCodeAt(0)]=63,et=function(e,t,r,n,i){var o,s,a=8*i-n-1,l=(1<<a)-1,c=l>>1,u=-7,h=r?i-1:0,d=r?-1:1,f=e[t+h];for(h+=d,o=f&(1<<-u)-1,f>>=-u,u+=a;u>0;o=256*o+e[t+h],h+=d,u-=8);for(s=o&(1<<-u)-1,o>>=-u,u+=n;u>0;s=256*s+e[t+h],h+=d,u-=8);if(0===o)o=1-c;else{if(o===l)return s?NaN:1/0*(f?-1:1);s+=Math.pow(2,n),o-=c}return(f?-1:1)*s*Math.pow(2,o-n)},er=function(e,t,r,n,i,o){var s,a,l,c=8*o-i-1,u=(1<<c)-1,h=u>>1,d=23===i?5960464477539062e-23:0,f=n?0:o-1,p=n?1:-1,g=t<0||0===t&&1/t<0?1:0;for(isNaN(t=Math.abs(t))||t===1/0?(a=isNaN(t)?1:0,s=u):(s=Math.floor(Math.log(t)/Math.LN2),t*(l=Math.pow(2,-s))<1&&(s--,l*=2),s+h>=1?t+=d/l:t+=d*Math.pow(2,1-h),t*l>=2&&(s++,l/=2),s+h>=u?(a=0,s=u):s+h>=1?(a=(t*l-1)*Math.pow(2,i),s+=h):(a=t*Math.pow(2,h-1)*Math.pow(2,i),s=0));i>=8;e[r+f]=255&a,f+=p,a/=256,i-=8);for(s=s<<i|a,c+=i;c>0;e[r+f]=255&s,f+=p,s/=256,c-=8);e[r+f-p]|=128*g};let hL="function"==typeof Symbol&&"function"==typeof Symbol.for?Symbol.for("nodejs.util.inspect.custom"):null;function hk(e){if(e>2147483647)throw RangeError('The value "'+e+'" is invalid for option "size"');let t=new Uint8Array(e);return Object.setPrototypeOf(t,hN.prototype),t}function hN(e,t,r){if("number"==typeof e){if("string"==typeof t)throw TypeError('The "string" argument must be of type string. Received type number');return hx(e)}return hC(e,t,r)}function hC(e,t,r){if("string"==typeof e)return function(e,t){if(("string"!=typeof t||""===t)&&(t="utf8"),!hN.isEncoding(t))throw TypeError("Unknown encoding: "+t);let r=0|hD(e,t),n=hk(r),i=n.write(e,t);return i!==r&&(n=n.slice(0,i)),n}(e,t);if(ArrayBuffer.isView(e))return function(e){if(h5(e,Uint8Array)){let t=new Uint8Array(e);return hU(t.buffer,t.byteOffset,t.byteLength)}return hM(e)}(e);if(null==e)throw TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e);if(h5(e,ArrayBuffer)||e&&h5(e.buffer,ArrayBuffer)||"undefined"!=typeof SharedArrayBuffer&&(h5(e,SharedArrayBuffer)||e&&h5(e.buffer,SharedArrayBuffer)))return hU(e,t,r);if("number"==typeof e)throw TypeError('The "value" argument must not be of type number. Received type number');let n=e.valueOf&&e.valueOf();if(null!=n&&n!==e)return hN.from(n,t,r);let i=function(e){var t;if(hN.isBuffer(e)){let t=0|hP(e.length),r=hk(t);return 0===r.length||e.copy(r,0,0,t),r}return void 0!==e.length?"number"!=typeof e.length||(t=e.length)!=t?hk(0):hM(e):"Buffer"===e.type&&Array.isArray(e.data)?hM(e.data):void 0}(e);if(i)return i;if("undefined"!=typeof Symbol&&null!=Symbol.toPrimitive&&"function"==typeof e[Symbol.toPrimitive])return hN.from(e[Symbol.toPrimitive]("string"),t,r);throw TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e)}function hI(e){if("number"!=typeof e)throw TypeError('"size" argument must be of type number');if(e<0)throw RangeError('The value "'+e+'" is invalid for option "size"')}function hx(e){return hI(e),hk(e<0?0:0|hP(e))}function hM(e){let t=e.length<0?0:0|hP(e.length),r=hk(t);for(let n=0;n<t;n+=1)r[n]=255&e[n];return r}function hU(e,t,r){let n;if(t<0||e.byteLength<t)throw RangeError('"offset" is outside of buffer bounds');if(e.byteLength<t+(r||0))throw RangeError('"length" is outside of buffer bounds');return Object.setPrototypeOf(n=void 0===t&&void 0===r?new Uint8Array(e):void 0===r?new Uint8Array(e,t):new Uint8Array(e,t,r),hN.prototype),n}function hP(e){if(e>=2147483647)throw RangeError("Attempt to allocate Buffer larger than maximum size: 0x7fffffff bytes");return 0|e}function hD(e,t){if(hN.isBuffer(e))return e.length;if(ArrayBuffer.isView(e)||h5(e,ArrayBuffer))return e.byteLength;if("string"!=typeof e)throw TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof e);let r=e.length,n=arguments.length>2&&!0===arguments[2];if(!n&&0===r)return 0;let i=!1;for(;;)switch(t){case"ascii":case"latin1":case"binary":return r;case"utf8":case"utf-8":return h6(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*r;case"hex":return r>>>1;case"base64":return h8(e).length;default:if(i)return n?-1:h6(e).length;t=(""+t).toLowerCase(),i=!0}}function hB(e,t,r){let n=!1;if((void 0===t||t<0)&&(t=0),t>this.length||((void 0===r||r>this.length)&&(r=this.length),r<=0||(r>>>=0)<=(t>>>=0)))return"";for(e||(e="utf8");;)switch(e){case"hex":return function(e,t,r){let n=e.length;(!t||t<0)&&(t=0),(!r||r<0||r>n)&&(r=n);let i="";for(let n=t;n<r;++n)i+=h4[e[n]];return i}(this,t,r);case"utf8":case"utf-8":return hG(this,t,r);case"ascii":return function(e,t,r){let n="";r=Math.min(e.length,r);for(let i=t;i<r;++i)n+=String.fromCharCode(127&e[i]);return n}(this,t,r);case"latin1":case"binary":return function(e,t,r){let n="";r=Math.min(e.length,r);for(let i=t;i<r;++i)n+=String.fromCharCode(e[i]);return n}(this,t,r);case"base64":var i,o;return i=t,o=r,0===i&&o===this.length?ee(this):ee(this.slice(i,o));case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return function(e,t,r){let n=e.slice(t,r),i="";for(let e=0;e<n.length-1;e+=2)i+=String.fromCharCode(n[e]+256*n[e+1]);return i}(this,t,r);default:if(n)throw TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),n=!0}}function hF(e,t,r){let n=e[t];e[t]=e[r],e[r]=n}function hj(e,t,r,n,i){var o;if(0===e.length)return -1;if("string"==typeof r?(n=r,r=0):r>2147483647?r=2147483647:r<-2147483648&&(r=-2147483648),(o=r=+r)!=o&&(r=i?0:e.length-1),r<0&&(r=e.length+r),r>=e.length){if(i)return -1;r=e.length-1}else if(r<0){if(!i)return -1;r=0}if("string"==typeof t&&(t=hN.from(t,n)),hN.isBuffer(t))return 0===t.length?-1:h$(e,t,r,n,i);if("number"==typeof t)return(t&=255,"function"==typeof Uint8Array.prototype.indexOf)?i?Uint8Array.prototype.indexOf.call(e,t,r):Uint8Array.prototype.lastIndexOf.call(e,t,r):h$(e,[t],r,n,i);throw TypeError("val must be string, number or Buffer")}function h$(e,t,r,n,i){let o,s=1,a=e.length,l=t.length;if(void 0!==n&&("ucs2"===(n=String(n).toLowerCase())||"ucs-2"===n||"utf16le"===n||"utf-16le"===n)){if(e.length<2||t.length<2)return -1;s=2,a/=2,l/=2,r/=2}function c(e,t){return 1===s?e[t]:e.readUInt16BE(t*s)}if(i){let n=-1;for(o=r;o<a;o++)if(c(e,o)===c(t,-1===n?0:o-n)){if(-1===n&&(n=o),o-n+1===l)return n*s}else -1!==n&&(o-=o-n),n=-1}else for(r+l>a&&(r=a-l),o=r;o>=0;o--){let r=!0;for(let n=0;n<l;n++)if(c(e,o+n)!==c(t,n)){r=!1;break}if(r)return o}return -1}function hG(e,t,r){r=Math.min(e.length,r);let n=[],i=t;for(;i<r;){let t=e[i],o=null,s=t>239?4:t>223?3:t>191?2:1;if(i+s<=r){let r,n,a,l;switch(s){case 1:t<128&&(o=t);break;case 2:(192&(r=e[i+1]))==128&&(l=(31&t)<<6|63&r)>127&&(o=l);break;case 3:r=e[i+1],n=e[i+2],(192&r)==128&&(192&n)==128&&(l=(15&t)<<12|(63&r)<<6|63&n)>2047&&(l<55296||l>57343)&&(o=l);break;case 4:r=e[i+1],n=e[i+2],a=e[i+3],(192&r)==128&&(192&n)==128&&(192&a)==128&&(l=(15&t)<<18|(63&r)<<12|(63&n)<<6|63&a)>65535&&l<1114112&&(o=l)}}null===o?(o=65533,s=1):o>65535&&(o-=65536,n.push(o>>>10&1023|55296),o=56320|1023&o),n.push(o),i+=s}return function(e){let t=e.length;if(t<=4096)return String.fromCharCode.apply(String,e);let r="",n=0;for(;n<t;)r+=String.fromCharCode.apply(String,e.slice(n,n+=4096));return r}(n)}function hK(e,t,r){if(e%1!=0||e<0)throw RangeError("offset is not uint");if(e+t>r)throw RangeError("Trying to access beyond buffer length")}function hW(e,t,r,n,i,o){if(!hN.isBuffer(e))throw TypeError('"buffer" argument must be a Buffer instance');if(t>i||t<o)throw RangeError('"value" argument is out of bounds');if(r+n>e.length)throw RangeError("Index out of range")}function hH(e,t,r,n,i){hZ(t,n,i,e,r,7);let o=Number(t&BigInt(4294967295));e[r++]=o,o>>=8,e[r++]=o,o>>=8,e[r++]=o,o>>=8,e[r++]=o;let s=Number(t>>BigInt(32)&BigInt(4294967295));return e[r++]=s,s>>=8,e[r++]=s,s>>=8,e[r++]=s,s>>=8,e[r++]=s,r}function hY(e,t,r,n,i){hZ(t,n,i,e,r,7);let o=Number(t&BigInt(4294967295));e[r+7]=o,o>>=8,e[r+6]=o,o>>=8,e[r+5]=o,o>>=8,e[r+4]=o;let s=Number(t>>BigInt(32)&BigInt(4294967295));return e[r+3]=s,s>>=8,e[r+2]=s,s>>=8,e[r+1]=s,s>>=8,e[r]=s,r+8}function hV(e,t,r,n,i,o){if(r+n>e.length||r<0)throw RangeError("Index out of range")}function hz(e,t,r,n,i){return t=+t,r>>>=0,i||hV(e,t,r,4,34028234663852886e22,-34028234663852886e22),er(e,t,r,n,23,4),r+4}function hq(e,t,r,n,i){return t=+t,r>>>=0,i||hV(e,t,r,8,17976931348623157e292,-17976931348623157e292),er(e,t,r,n,52,8),r+8}hN.TYPED_ARRAY_SUPPORT=function(){try{let e=new Uint8Array(1),t={foo:function(){return 42}};return Object.setPrototypeOf(t,Uint8Array.prototype),Object.setPrototypeOf(e,t),42===e.foo()}catch(e){return!1}}(),hN.TYPED_ARRAY_SUPPORT||"undefined"==typeof console||"function"!=typeof console.error||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(hN.prototype,"parent",{enumerable:!0,get:function(){if(hN.isBuffer(this))return this.buffer}}),Object.defineProperty(hN.prototype,"offset",{enumerable:!0,get:function(){if(hN.isBuffer(this))return this.byteOffset}}),hN.poolSize=8192,hN.from=function(e,t,r){return hC(e,t,r)},Object.setPrototypeOf(hN.prototype,Uint8Array.prototype),Object.setPrototypeOf(hN,Uint8Array),hN.alloc=function(e,t,r){return(hI(e),e<=0)?hk(e):void 0!==t?"string"==typeof r?hk(e).fill(t,r):hk(e).fill(t):hk(e)},hN.allocUnsafe=function(e){return hx(e)},hN.allocUnsafeSlow=function(e){return hx(e)},hN.isBuffer=function(e){return null!=e&&!0===e._isBuffer&&e!==hN.prototype},hN.compare=function(e,t){if(h5(e,Uint8Array)&&(e=hN.from(e,e.offset,e.byteLength)),h5(t,Uint8Array)&&(t=hN.from(t,t.offset,t.byteLength)),!hN.isBuffer(e)||!hN.isBuffer(t))throw TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(e===t)return 0;let r=e.length,n=t.length;for(let i=0,o=Math.min(r,n);i<o;++i)if(e[i]!==t[i]){r=e[i],n=t[i];break}return r<n?-1:n<r?1:0},hN.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},hN.concat=function(e,t){let r;if(!Array.isArray(e))throw TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return hN.alloc(0);if(void 0===t)for(r=0,t=0;r<e.length;++r)t+=e[r].length;let n=hN.allocUnsafe(t),i=0;for(r=0;r<e.length;++r){let t=e[r];if(h5(t,Uint8Array))i+t.length>n.length?(hN.isBuffer(t)||(t=hN.from(t)),t.copy(n,i)):Uint8Array.prototype.set.call(n,t,i);else if(hN.isBuffer(t))t.copy(n,i);else throw TypeError('"list" argument must be an Array of Buffers');i+=t.length}return n},hN.byteLength=hD,hN.prototype._isBuffer=!0,hN.prototype.swap16=function(){let e=this.length;if(e%2!=0)throw RangeError("Buffer size must be a multiple of 16-bits");for(let t=0;t<e;t+=2)hF(this,t,t+1);return this},hN.prototype.swap32=function(){let e=this.length;if(e%4!=0)throw RangeError("Buffer size must be a multiple of 32-bits");for(let t=0;t<e;t+=4)hF(this,t,t+3),hF(this,t+1,t+2);return this},hN.prototype.swap64=function(){let e=this.length;if(e%8!=0)throw RangeError("Buffer size must be a multiple of 64-bits");for(let t=0;t<e;t+=8)hF(this,t,t+7),hF(this,t+1,t+6),hF(this,t+2,t+5),hF(this,t+3,t+4);return this},hN.prototype.toString=function(){let e=this.length;return 0===e?"":0==arguments.length?hG(this,0,e):hB.apply(this,arguments)},hN.prototype.toLocaleString=hN.prototype.toString,hN.prototype.equals=function(e){if(!hN.isBuffer(e))throw TypeError("Argument must be a Buffer");return this===e||0===hN.compare(this,e)},hN.prototype.inspect=function(){let e="";return e=this.toString("hex",0,50).replace(/(.{2})/g,"$1 ").trim(),this.length>50&&(e+=" ... "),"<Buffer "+e+">"},hL&&(hN.prototype[hL]=hN.prototype.inspect),hN.prototype.compare=function(e,t,r,n,i){if(h5(e,Uint8Array)&&(e=hN.from(e,e.offset,e.byteLength)),!hN.isBuffer(e))throw TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof e);if(void 0===t&&(t=0),void 0===r&&(r=e?e.length:0),void 0===n&&(n=0),void 0===i&&(i=this.length),t<0||r>e.length||n<0||i>this.length)throw RangeError("out of range index");if(n>=i&&t>=r)return 0;if(n>=i)return -1;if(t>=r)return 1;if(t>>>=0,r>>>=0,n>>>=0,i>>>=0,this===e)return 0;let o=i-n,s=r-t,a=Math.min(o,s),l=this.slice(n,i),c=e.slice(t,r);for(let e=0;e<a;++e)if(l[e]!==c[e]){o=l[e],s=c[e];break}return o<s?-1:s<o?1:0},hN.prototype.includes=function(e,t,r){return -1!==this.indexOf(e,t,r)},hN.prototype.indexOf=function(e,t,r){return hj(this,e,t,r,!0)},hN.prototype.lastIndexOf=function(e,t,r){return hj(this,e,t,r,!1)},hN.prototype.write=function(e,t,r,n){var i,o,s,a,l,c,u,h;if(void 0===t)n="utf8",r=this.length,t=0;else if(void 0===r&&"string"==typeof t)n=t,r=this.length,t=0;else if(isFinite(t))t>>>=0,isFinite(r)?(r>>>=0,void 0===n&&(n="utf8")):(n=r,r=void 0);else throw Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");let d=this.length-t;if((void 0===r||r>d)&&(r=d),e.length>0&&(r<0||t<0)||t>this.length)throw RangeError("Attempt to write outside buffer bounds");n||(n="utf8");let f=!1;for(;;)switch(n){case"hex":return function(e,t,r,n){let i;r=Number(r)||0;let o=e.length-r;n?(n=Number(n))>o&&(n=o):n=o;let s=t.length;for(n>s/2&&(n=s/2),i=0;i<n;++i){let n=parseInt(t.substr(2*i,2),16);if(n!=n)break;e[r+i]=n}return i}(this,e,t,r);case"utf8":case"utf-8":return i=t,o=r,h3(h6(e,this.length-i),this,i,o);case"ascii":case"latin1":case"binary":return s=t,a=r,h3(function(e){let t=[];for(let r=0;r<e.length;++r)t.push(255&e.charCodeAt(r));return t}(e),this,s,a);case"base64":return l=t,c=r,h3(h8(e),this,l,c);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return u=t,h=r,h3(function(e,t){let r,n;let i=[];for(let o=0;o<e.length&&!((t-=2)<0);++o)n=(r=e.charCodeAt(o))>>8,i.push(r%256),i.push(n);return i}(e,this.length-u),this,u,h);default:if(f)throw TypeError("Unknown encoding: "+n);n=(""+n).toLowerCase(),f=!0}},hN.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}},hN.prototype.slice=function(e,t){let r=this.length;e=~~e,t=void 0===t?r:~~t,e<0?(e+=r)<0&&(e=0):e>r&&(e=r),t<0?(t+=r)<0&&(t=0):t>r&&(t=r),t<e&&(t=e);let n=this.subarray(e,t);return Object.setPrototypeOf(n,hN.prototype),n},hN.prototype.readUintLE=hN.prototype.readUIntLE=function(e,t,r){e>>>=0,t>>>=0,r||hK(e,t,this.length);let n=this[e],i=1,o=0;for(;++o<t&&(i*=256);)n+=this[e+o]*i;return n},hN.prototype.readUintBE=hN.prototype.readUIntBE=function(e,t,r){e>>>=0,t>>>=0,r||hK(e,t,this.length);let n=this[e+--t],i=1;for(;t>0&&(i*=256);)n+=this[e+--t]*i;return n},hN.prototype.readUint8=hN.prototype.readUInt8=function(e,t){return e>>>=0,t||hK(e,1,this.length),this[e]},hN.prototype.readUint16LE=hN.prototype.readUInt16LE=function(e,t){return e>>>=0,t||hK(e,2,this.length),this[e]|this[e+1]<<8},hN.prototype.readUint16BE=hN.prototype.readUInt16BE=function(e,t){return e>>>=0,t||hK(e,2,this.length),this[e]<<8|this[e+1]},hN.prototype.readUint32LE=hN.prototype.readUInt32LE=function(e,t){return e>>>=0,t||hK(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},hN.prototype.readUint32BE=hN.prototype.readUInt32BE=function(e,t){return e>>>=0,t||hK(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},hN.prototype.readBigUInt64LE=h7(function(e){h0(e>>>=0,"offset");let t=this[e],r=this[e+7];(void 0===t||void 0===r)&&h1(e,this.length-8);let n=t+256*this[++e]+65536*this[++e]+16777216*this[++e],i=this[++e]+256*this[++e]+65536*this[++e]+16777216*r;return BigInt(n)+(BigInt(i)<<BigInt(32))}),hN.prototype.readBigUInt64BE=h7(function(e){h0(e>>>=0,"offset");let t=this[e],r=this[e+7];(void 0===t||void 0===r)&&h1(e,this.length-8);let n=16777216*t+65536*this[++e]+256*this[++e]+this[++e],i=16777216*this[++e]+65536*this[++e]+256*this[++e]+r;return(BigInt(n)<<BigInt(32))+BigInt(i)}),hN.prototype.readIntLE=function(e,t,r){e>>>=0,t>>>=0,r||hK(e,t,this.length);let n=this[e],i=1,o=0;for(;++o<t&&(i*=256);)n+=this[e+o]*i;return n>=(i*=128)&&(n-=Math.pow(2,8*t)),n},hN.prototype.readIntBE=function(e,t,r){e>>>=0,t>>>=0,r||hK(e,t,this.length);let n=t,i=1,o=this[e+--n];for(;n>0&&(i*=256);)o+=this[e+--n]*i;return o>=(i*=128)&&(o-=Math.pow(2,8*t)),o},hN.prototype.readInt8=function(e,t){return(e>>>=0,t||hK(e,1,this.length),128&this[e])?-((255-this[e]+1)*1):this[e]},hN.prototype.readInt16LE=function(e,t){e>>>=0,t||hK(e,2,this.length);let r=this[e]|this[e+1]<<8;return 32768&r?4294901760|r:r},hN.prototype.readInt16BE=function(e,t){e>>>=0,t||hK(e,2,this.length);let r=this[e+1]|this[e]<<8;return 32768&r?4294901760|r:r},hN.prototype.readInt32LE=function(e,t){return e>>>=0,t||hK(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},hN.prototype.readInt32BE=function(e,t){return e>>>=0,t||hK(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},hN.prototype.readBigInt64LE=h7(function(e){h0(e>>>=0,"offset");let t=this[e],r=this[e+7];return(void 0===t||void 0===r)&&h1(e,this.length-8),(BigInt(this[e+4]+256*this[e+5]+65536*this[e+6]+(r<<24))<<BigInt(32))+BigInt(t+256*this[++e]+65536*this[++e]+16777216*this[++e])}),hN.prototype.readBigInt64BE=h7(function(e){h0(e>>>=0,"offset");let t=this[e],r=this[e+7];return(void 0===t||void 0===r)&&h1(e,this.length-8),(BigInt((t<<24)+65536*this[++e]+256*this[++e]+this[++e])<<BigInt(32))+BigInt(16777216*this[++e]+65536*this[++e]+256*this[++e]+r)}),hN.prototype.readFloatLE=function(e,t){return e>>>=0,t||hK(e,4,this.length),et(this,e,!0,23,4)},hN.prototype.readFloatBE=function(e,t){return e>>>=0,t||hK(e,4,this.length),et(this,e,!1,23,4)},hN.prototype.readDoubleLE=function(e,t){return e>>>=0,t||hK(e,8,this.length),et(this,e,!0,52,8)},hN.prototype.readDoubleBE=function(e,t){return e>>>=0,t||hK(e,8,this.length),et(this,e,!1,52,8)},hN.prototype.writeUintLE=hN.prototype.writeUIntLE=function(e,t,r,n){if(e=+e,t>>>=0,r>>>=0,!n){let n=Math.pow(2,8*r)-1;hW(this,e,t,r,n,0)}let i=1,o=0;for(this[t]=255&e;++o<r&&(i*=256);)this[t+o]=e/i&255;return t+r},hN.prototype.writeUintBE=hN.prototype.writeUIntBE=function(e,t,r,n){if(e=+e,t>>>=0,r>>>=0,!n){let n=Math.pow(2,8*r)-1;hW(this,e,t,r,n,0)}let i=r-1,o=1;for(this[t+i]=255&e;--i>=0&&(o*=256);)this[t+i]=e/o&255;return t+r},hN.prototype.writeUint8=hN.prototype.writeUInt8=function(e,t,r){return e=+e,t>>>=0,r||hW(this,e,t,1,255,0),this[t]=255&e,t+1},hN.prototype.writeUint16LE=hN.prototype.writeUInt16LE=function(e,t,r){return e=+e,t>>>=0,r||hW(this,e,t,2,65535,0),this[t]=255&e,this[t+1]=e>>>8,t+2},hN.prototype.writeUint16BE=hN.prototype.writeUInt16BE=function(e,t,r){return e=+e,t>>>=0,r||hW(this,e,t,2,65535,0),this[t]=e>>>8,this[t+1]=255&e,t+2},hN.prototype.writeUint32LE=hN.prototype.writeUInt32LE=function(e,t,r){return e=+e,t>>>=0,r||hW(this,e,t,4,4294967295,0),this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e,t+4},hN.prototype.writeUint32BE=hN.prototype.writeUInt32BE=function(e,t,r){return e=+e,t>>>=0,r||hW(this,e,t,4,4294967295,0),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},hN.prototype.writeBigUInt64LE=h7(function(e,t=0){return hH(this,e,t,BigInt(0),BigInt("0xffffffffffffffff"))}),hN.prototype.writeBigUInt64BE=h7(function(e,t=0){return hY(this,e,t,BigInt(0),BigInt("0xffffffffffffffff"))}),hN.prototype.writeIntLE=function(e,t,r,n){if(e=+e,t>>>=0,!n){let n=Math.pow(2,8*r-1);hW(this,e,t,r,n-1,-n)}let i=0,o=1,s=0;for(this[t]=255&e;++i<r&&(o*=256);)e<0&&0===s&&0!==this[t+i-1]&&(s=1),this[t+i]=(e/o>>0)-s&255;return t+r},hN.prototype.writeIntBE=function(e,t,r,n){if(e=+e,t>>>=0,!n){let n=Math.pow(2,8*r-1);hW(this,e,t,r,n-1,-n)}let i=r-1,o=1,s=0;for(this[t+i]=255&e;--i>=0&&(o*=256);)e<0&&0===s&&0!==this[t+i+1]&&(s=1),this[t+i]=(e/o>>0)-s&255;return t+r},hN.prototype.writeInt8=function(e,t,r){return e=+e,t>>>=0,r||hW(this,e,t,1,127,-128),e<0&&(e=255+e+1),this[t]=255&e,t+1},hN.prototype.writeInt16LE=function(e,t,r){return e=+e,t>>>=0,r||hW(this,e,t,2,32767,-32768),this[t]=255&e,this[t+1]=e>>>8,t+2},hN.prototype.writeInt16BE=function(e,t,r){return e=+e,t>>>=0,r||hW(this,e,t,2,32767,-32768),this[t]=e>>>8,this[t+1]=255&e,t+2},hN.prototype.writeInt32LE=function(e,t,r){return e=+e,t>>>=0,r||hW(this,e,t,4,2147483647,-2147483648),this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24,t+4},hN.prototype.writeInt32BE=function(e,t,r){return e=+e,t>>>=0,r||hW(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},hN.prototype.writeBigInt64LE=h7(function(e,t=0){return hH(this,e,t,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))}),hN.prototype.writeBigInt64BE=h7(function(e,t=0){return hY(this,e,t,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))}),hN.prototype.writeFloatLE=function(e,t,r){return hz(this,e,t,!0,r)},hN.prototype.writeFloatBE=function(e,t,r){return hz(this,e,t,!1,r)},hN.prototype.writeDoubleLE=function(e,t,r){return hq(this,e,t,!0,r)},hN.prototype.writeDoubleBE=function(e,t,r){return hq(this,e,t,!1,r)},hN.prototype.copy=function(e,t,r,n){if(!hN.isBuffer(e))throw TypeError("argument should be a Buffer");if(r||(r=0),n||0===n||(n=this.length),t>=e.length&&(t=e.length),t||(t=0),n>0&&n<r&&(n=r),n===r||0===e.length||0===this.length)return 0;if(t<0)throw RangeError("targetStart out of bounds");if(r<0||r>=this.length)throw RangeError("Index out of range");if(n<0)throw RangeError("sourceEnd out of bounds");n>this.length&&(n=this.length),e.length-t<n-r&&(n=e.length-t+r);let i=n-r;return this===e&&"function"==typeof Uint8Array.prototype.copyWithin?this.copyWithin(t,r,n):Uint8Array.prototype.set.call(e,this.subarray(r,n),t),i},hN.prototype.fill=function(e,t,r,n){let i;if("string"==typeof e){if("string"==typeof t?(n=t,t=0,r=this.length):"string"==typeof r&&(n=r,r=this.length),void 0!==n&&"string"!=typeof n)throw TypeError("encoding must be a string");if("string"==typeof n&&!hN.isEncoding(n))throw TypeError("Unknown encoding: "+n);if(1===e.length){let t=e.charCodeAt(0);("utf8"===n&&t<128||"latin1"===n)&&(e=t)}}else"number"==typeof e?e&=255:"boolean"==typeof e&&(e=Number(e));if(t<0||this.length<t||this.length<r)throw RangeError("Out of range index");if(r<=t)return this;if(t>>>=0,r=void 0===r?this.length:r>>>0,e||(e=0),"number"==typeof e)for(i=t;i<r;++i)this[i]=e;else{let o=hN.isBuffer(e)?e:hN.from(e,n),s=o.length;if(0===s)throw TypeError('The value "'+e+'" is invalid for argument "value"');for(i=0;i<r-t;++i)this[i+t]=o[i%s]}return this};let hJ={};function hX(e,t,r){hJ[e]=class extends r{constructor(){super(),Object.defineProperty(this,"message",{value:t.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${e}]`,this.stack,delete this.name}get code(){return e}set code(e){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:e,writable:!0})}toString(){return`${this.name} [${e}]: ${this.message}`}}}function hQ(e){let t="",r=e.length,n="-"===e[0]?1:0;for(;r>=n+4;r-=3)t=`_${e.slice(r-3,r)}${t}`;return`${e.slice(0,r)}${t}`}function hZ(e,t,r,n,i,o){if(e>r||e<t){let n;let i="bigint"==typeof t?"n":"";throw n=o>3?0===t||t===BigInt(0)?`>= 0${i} and < 2${i} ** ${(o+1)*8}${i}`:`>= -(2${i} ** ${(o+1)*8-1}${i}) and < 2 ** ${(o+1)*8-1}${i}`:`>= ${t}${i} and <= ${r}${i}`,new hJ.ERR_OUT_OF_RANGE("value",n,e)}h0(i,"offset"),(void 0===n[i]||void 0===n[i+o])&&h1(i,n.length-(o+1))}function h0(e,t){if("number"!=typeof e)throw new hJ.ERR_INVALID_ARG_TYPE(t,"number",e)}function h1(e,t,r){if(Math.floor(e)!==e)throw h0(e,r),new hJ.ERR_OUT_OF_RANGE(r||"offset","an integer",e);if(t<0)throw new hJ.ERR_BUFFER_OUT_OF_BOUNDS;throw new hJ.ERR_OUT_OF_RANGE(r||"offset",`>= ${r?1:0} and <= ${t}`,e)}hX("ERR_BUFFER_OUT_OF_BOUNDS",function(e){return e?`${e} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"},RangeError),hX("ERR_INVALID_ARG_TYPE",function(e,t){return`The "${e}" argument must be of type number. Received type ${typeof t}`},TypeError),hX("ERR_OUT_OF_RANGE",function(e,t,r){let n=`The value of "${e}" is out of range.`,i=r;return Number.isInteger(r)&&Math.abs(r)>4294967296?i=hQ(String(r)):"bigint"==typeof r&&(i=String(r),(r>BigInt(2)**BigInt(32)||r<-(BigInt(2)**BigInt(32)))&&(i=hQ(i)),i+="n"),n+=` It must be ${t}. Received ${i}`},RangeError);let h2=/[^+/0-9A-Za-z-_]/g;function h6(e,t){let r;t=t||1/0;let n=e.length,i=null,o=[];for(let s=0;s<n;++s){if((r=e.charCodeAt(s))>55295&&r<57344){if(!i){if(r>56319||s+1===n){(t-=3)>-1&&o.push(239,191,189);continue}i=r;continue}if(r<56320){(t-=3)>-1&&o.push(239,191,189),i=r;continue}r=(i-55296<<10|r-56320)+65536}else i&&(t-=3)>-1&&o.push(239,191,189);if(i=null,r<128){if((t-=1)<0)break;o.push(r)}else if(r<2048){if((t-=2)<0)break;o.push(r>>6|192,63&r|128)}else if(r<65536){if((t-=3)<0)break;o.push(r>>12|224,r>>6&63|128,63&r|128)}else if(r<1114112){if((t-=4)<0)break;o.push(r>>18|240,r>>12&63|128,r>>6&63|128,63&r|128)}else throw Error("Invalid code point")}return o}function h8(e){return function(e){var t,r,n=function(e){var t=e.length;if(t%4>0)throw Error("Invalid string. Length must be a multiple of 4");var r=e.indexOf("=");-1===r&&(r=t);var n=r===t?0:4-r%4;return[r,n]}(e),i=n[0],o=n[1],s=new hR((i+o)*3/4-o),a=0,l=o>0?i-4:i;for(r=0;r<l;r+=4)t=hb[e.charCodeAt(r)]<<18|hb[e.charCodeAt(r+1)]<<12|hb[e.charCodeAt(r+2)]<<6|hb[e.charCodeAt(r+3)],s[a++]=t>>16&255,s[a++]=t>>8&255,s[a++]=255&t;return 2===o&&(t=hb[e.charCodeAt(r)]<<2|hb[e.charCodeAt(r+1)]>>4,s[a++]=255&t),1===o&&(t=hb[e.charCodeAt(r)]<<10|hb[e.charCodeAt(r+1)]<<4|hb[e.charCodeAt(r+2)]>>2,s[a++]=t>>8&255,s[a++]=255&t),s}(function(e){if((e=(e=e.split("=")[0]).trim().replace(h2,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e}(e))}function h3(e,t,r,n){let i;for(i=0;i<n&&!(i+r>=t.length)&&!(i>=e.length);++i)t[i+r]=e[i];return i}function h5(e,t){return e instanceof t||null!=e&&null!=e.constructor&&null!=e.constructor.name&&e.constructor.name===t.name}let h4=function(){let e="0123456789abcdef",t=Array(256);for(let r=0;r<16;++r){let n=16*r;for(let i=0;i<16;++i)t[n+i]=e[r]+e[i]}return t}();function h7(e){return"undefined"==typeof BigInt?h9:e}function h9(){throw Error("BigInt not supported")}let de=e=>new Uint8Array(e),dt=e=>{let t=de(e.byteLength);return t.set(e),t};class dr{constructor(e,t){this.left=e,this.right=t}}let dn=(e,t)=>new dr(e,t),di="undefined"!=typeof document?document:{};"undefined"!=typeof DOMParser&&new DOMParser;let ds=e=>u6(e,(e,t)=>`${t}:${e};`).join("");di.ELEMENT_NODE,di.TEXT_NODE,di.CDATA_SECTION_NODE,di.COMMENT_NODE,di.DOCUMENT_NODE,di.DOCUMENT_TYPE_NODE,di.DOCUMENT_FRAGMENT_NODE;let da=e=>class{constructor(e){this._=e}destroy(){e(this._)}};da(clearTimeout),da(clearInterval),da(e=>"undefined"!=typeof requestAnimationFrame&&cancelAnimationFrame(e)),da(e=>"undefined"!=typeof cancelIdleCallback&&cancelIdleCallback(e));let dl=Symbol,dc=dl(),du=dl(),dh=dl(),dd=dl(),df=dl(),dp=dl(),dg=dl(),dm=dl(),dE=dl();u9();let dy={[dc]:dn("font-weight","bold"),[du]:dn("font-weight","normal"),[dh]:dn("color","blue"),[df]:dn("color","green"),[dd]:dn("color","grey"),[dp]:dn("color","red"),[dg]:dn("color","purple"),[dm]:dn("color","orange"),[dE]:dn("color","black")},d_=hA?e=>{let t=[],r=[],n=u0(),i=[],o=0;for(;o<e.length;o++){let i=e[o],s=dy[i];if(void 0!==s)n.set(s.left,s.right);else if(i.constructor===String||i.constructor===Number){let e=ds(n);o>0||e.length>0?(t.push("%c"+i),r.push(e)):t.push(i)}else break}for(o>0&&(i=r).unshift(t.join(""));o<e.length;o++){let t=e[o];t instanceof Symbol||i.push(t)}return i}:e=>{let t=[],r=[],n=0;for(;n<e.length;n++){let i=e[n];i.constructor===String||i.constructor===Number?t.push(i):i.constructor===Object&&r.push(JSON.stringify(i))}return r},dT=(...e)=>{console.log(...d_(e)),dA.forEach(t=>t.print(e))},dA=c8(),dv=e=>({[Symbol.iterator](){return this},next:e}),db=(e,t)=>dv(()=>{let r;do r=e.next();while(!r.done&&!t(r.value))return r}),dR=(e,t)=>dv(()=>{let{done:r,value:n}=e.next();return{done:r,value:r?void 0:t(n)}});class dw{constructor(e,t){this.clock=e,this.len=t}}class dO{constructor(){this.clients=new Map}}let dS=(e,t,r)=>t.clients.forEach((t,n)=>{let i=e.doc.store.clients.get(n);for(let n=0;n<t.length;n++){let o=t[n];fA(e,i,o.clock,o.len,r)}}),dL=(e,t)=>{let r=0,n=e.length-1;for(;r<=n;){let i=cX((r+n)/2),o=e[i],s=o.clock;if(s<=t){if(t<s+o.len)return i;r=i+1}else n=i-1}return null},dk=(e,t)=>{let r=e.clients.get(t.client);return void 0!==r&&null!==dL(r,t.clock)},dN=e=>{e.clients.forEach(e=>{let t,r;for(e.sort((e,t)=>e.clock-t.clock),t=1,r=1;t<e.length;t++){let n=e[r-1],i=e[t];n.clock+n.len>=i.clock?n.len=c0(n.len,i.clock+i.len-n.clock):(r<t&&(e[r]=i),r++)}e.length=r})},dC=e=>{let t=new dO;for(let r=0;r<e.length;r++)e[r].clients.forEach((n,i)=>{if(!t.clients.has(i)){let o=n.slice();for(let t=r+1;t<e.length;t++)c5(o,e[t].clients.get(i)||[]);t.clients.set(i,o)}});return dN(t),t},dI=(e,t,r,n)=>{u2(e.clients,t,()=>[]).push(new dw(r,n))},dx=()=>new dO,dM=e=>{let t=dx();return e.clients.forEach((e,r)=>{let n=[];for(let t=0;t<e.length;t++){let r=e[t];if(r.deleted){let i=r.id.clock,o=r.length;if(t+1<e.length)for(let r=e[t+1];t+1<e.length&&r.deleted;r=e[++t+1])o+=r.length;n.push(new dw(i,o))}}n.length>0&&t.clients.set(r,n)}),t},dU=(e,t)=>{um(e.restEncoder,t.clients.size),c4(t.clients.entries()).sort((e,t)=>t[0]-e[0]).forEach(([t,r])=>{e.resetDsCurVal(),um(e.restEncoder,t);let n=r.length;um(e.restEncoder,n);for(let t=0;t<n;t++){let n=r[t];e.writeDsClock(n.clock),e.writeDsLen(n.len)}})},dP=e=>{let t=new dO,r=uW(e.restDecoder);for(let n=0;n<r;n++){e.resetDsCurVal();let r=uW(e.restDecoder),n=uW(e.restDecoder);if(n>0){let i=u2(t.clients,r,()=>[]);for(let t=0;t<n;t++)i.push(new dw(e.readDsClock(),e.readDsLen()))}}return t},dD=(e,t,r)=>{let n=new dO,i=uW(e.restDecoder);for(let o=0;o<i;o++){e.resetDsCurVal();let i=uW(e.restDecoder),o=uW(e.restDecoder),s=r.clients.get(i)||[],a=ff(r,i);for(let r=0;r<o;r++){let r=e.readDsClock(),o=r+e.readDsLen();if(r<a){a<o&&dI(n,i,a,o-a);let e=fg(s,r),l=s[e];for(!l.deleted&&l.id.clock<r&&(s.splice(e+1,0,p0(t,l,r-l.id.clock)),e++);e<s.length;)if((l=s[e++]).id.clock<o)l.deleted||(o<l.id.clock+l.length&&s.splice(e,0,p0(t,l,o-l.id.clock)),l.delete(t));else break}else dI(n,i,r,o-r)}}if(n.clients.size>0){let e=new dY;return um(e.restEncoder,0),dU(e,n),e.toUint8Array()}return null};class dB extends u3{constructor({guid:e=u7(),collectionid:t=null,gc:r=!0,gcFilter:n=()=>!0,meta:i=null,autoLoad:o=!1,shouldLoad:s=!0}={}){super(),this.gc=r,this.gcFilter=n,this.clientID=u4(),this.guid=e,this.collectionid=t,this.share=new Map,this.store=new fh,this._transaction=null,this._transactionCleanups=[],this.subdocs=new Set,this._item=null,this.shouldLoad=s,this.autoLoad=o,this.meta=i,this.isLoaded=!1,this.isSynced=!1,this.whenLoaded=he(e=>{this.on("load",()=>{this.isLoaded=!0,e(this)})});let a=()=>he(e=>{let t=r=>{(void 0===r||!0===r)&&(this.off("sync",t),e())};this.on("sync",t)});this.on("sync",e=>{!1===e&&this.isSynced&&(this.whenSynced=a()),this.isSynced=void 0===e||!0===e,this.isSynced&&!this.isLoaded&&this.emit("load",[])}),this.whenSynced=a()}load(){let e=this._item;null===e||this.shouldLoad||fk(e.parent.doc,e=>{e.subdocsLoaded.add(this)},null,!0),this.shouldLoad=!0}getSubdocs(){return this.subdocs}getSubdocGuids(){return new Set(c4(this.subdocs).map(e=>e.guid))}transact(e,t=null){return fk(this,e,t)}get(e,t=fQ){let r=u2(this.share,e,()=>{let e=new t;return e._integrate(this,null),e}),n=r.constructor;if(t!==fQ&&n!==t){if(n===fQ){let n=new t;n._map=r._map,r._map.forEach(e=>{for(;null!==e;e=e.left)e.parent=n}),n._start=r._start;for(let e=n._start;null!==e;e=e.right)e.parent=n;return n._length=r._length,this.share.set(e,n),n._integrate(this,null),n}throw Error(`Type with the name ${e} has already been defined with a different constructor`)}return r}getArray(e=""){return this.get(e,pl)}getText(e=""){return this.get(e,pS)}getMap(e=""){return this.get(e,pu)}getXmlFragment(e=""){return this.get(e,pk)}toJSON(){let e={};return this.share.forEach((t,r)=>{e[r]=t.toJSON()}),e}destroy(){c4(this.subdocs).forEach(e=>e.destroy());let e=this._item;if(null!==e){this._item=null;let t=e.content;t.doc=new dB({guid:this.guid,...t.opts,shouldLoad:!1}),t.doc._item=e,fk(e.parent.doc,r=>{let n=t.doc;e.deleted||r.subdocsAdded.add(n),r.subdocsRemoved.add(this)},null,!0)}this.emit("destroyed",[!0]),this.emit("destroy",[this]),super.destroy()}on(e,t){super.on(e,t)}off(e,t){super.off(e,t)}}class dF{constructor(e){this.restDecoder=e}resetDsCurVal(){}readDsClock(){return uW(this.restDecoder)}readDsLen(){return uW(this.restDecoder)}}class dj extends dF{readLeftID(){return fa(uW(this.restDecoder),uW(this.restDecoder))}readRightID(){return fa(uW(this.restDecoder),uW(this.restDecoder))}readClient(){return uW(this.restDecoder)}readInfo(){return uK(this.restDecoder)}readString(){return uY(this.restDecoder)}readParentInfo(){return 1===uW(this.restDecoder)}readTypeRef(){return uW(this.restDecoder)}readLen(){return uW(this.restDecoder)}readAny(){return uq(this.restDecoder)}readBuf(){return dt(uG(this.restDecoder))}readJSON(){return JSON.parse(uY(this.restDecoder))}readKey(){return uY(this.restDecoder)}}class d${constructor(e){this.dsCurrVal=0,this.restDecoder=e}resetDsCurVal(){this.dsCurrVal=0}readDsClock(){return this.dsCurrVal+=uW(this.restDecoder),this.dsCurrVal}readDsLen(){let e=uW(this.restDecoder)+1;return this.dsCurrVal+=e,e}}class dG extends d${constructor(e){super(e),this.keys=[],uW(e),this.keyClockDecoder=new uQ(uG(e)),this.clientDecoder=new uX(uG(e)),this.leftClockDecoder=new uQ(uG(e)),this.rightClockDecoder=new uQ(uG(e)),this.infoDecoder=new uJ(uG(e),uK),this.stringDecoder=new uZ(uG(e)),this.parentInfoDecoder=new uJ(uG(e),uK),this.typeRefDecoder=new uX(uG(e)),this.lenDecoder=new uX(uG(e))}readLeftID(){return new fo(this.clientDecoder.read(),this.leftClockDecoder.read())}readRightID(){return new fo(this.clientDecoder.read(),this.rightClockDecoder.read())}readClient(){return this.clientDecoder.read()}readInfo(){return this.infoDecoder.read()}readString(){return this.stringDecoder.read()}readParentInfo(){return 1===this.parentInfoDecoder.read()}readTypeRef(){return this.typeRefDecoder.read()}readLen(){return this.lenDecoder.read()}readAny(){return uq(this.restDecoder)}readBuf(){return uG(this.restDecoder)}readJSON(){return uq(this.restDecoder)}readKey(){let e=this.keyClockDecoder.read();if(e<this.keys.length)return this.keys[e];{let e=this.stringDecoder.read();return this.keys.push(e),e}}}class dK{constructor(){this.restEncoder=uh()}toUint8Array(){return uf(this.restEncoder)}resetDsCurVal(){}writeDsClock(e){um(this.restEncoder,e)}writeDsLen(e){um(this.restEncoder,e)}}class dW extends dK{writeLeftID(e){um(this.restEncoder,e.client),um(this.restEncoder,e.clock)}writeRightID(e){um(this.restEncoder,e.client),um(this.restEncoder,e.clock)}writeClient(e){um(this.restEncoder,e)}writeInfo(e){ug(this.restEncoder,e)}writeString(e){uT(this.restEncoder,e)}writeParentInfo(e){um(this.restEncoder,e?1:0)}writeTypeRef(e){um(this.restEncoder,e)}writeLen(e){um(this.restEncoder,e)}writeAny(e){uk(this.restEncoder,e)}writeBuf(e){uv(this.restEncoder,e)}writeJSON(e){uT(this.restEncoder,JSON.stringify(e))}writeKey(e){uT(this.restEncoder,e)}}class dH{constructor(){this.restEncoder=uh(),this.dsCurrVal=0}toUint8Array(){return uf(this.restEncoder)}resetDsCurVal(){this.dsCurrVal=0}writeDsClock(e){let t=e-this.dsCurrVal;this.dsCurrVal=e,um(this.restEncoder,t)}writeDsLen(e){0===e&&uc(),um(this.restEncoder,e-1),this.dsCurrVal+=e}}class dY extends dH{constructor(){super(),this.keyMap=new Map,this.keyClock=0,this.keyClockEncoder=new uM,this.clientEncoder=new uI,this.leftClockEncoder=new uM,this.rightClockEncoder=new uM,this.infoEncoder=new uN(ug),this.stringEncoder=new uU,this.parentInfoEncoder=new uN(ug),this.typeRefEncoder=new uI,this.lenEncoder=new uI}toUint8Array(){let e=uh();return um(e,0),uv(e,this.keyClockEncoder.toUint8Array()),uv(e,this.clientEncoder.toUint8Array()),uv(e,this.leftClockEncoder.toUint8Array()),uv(e,this.rightClockEncoder.toUint8Array()),uv(e,uf(this.infoEncoder)),uv(e,this.stringEncoder.toUint8Array()),uv(e,uf(this.parentInfoEncoder)),uv(e,this.typeRefEncoder.toUint8Array()),uv(e,this.lenEncoder.toUint8Array()),uA(e,uf(this.restEncoder)),uf(e)}writeLeftID(e){this.clientEncoder.write(e.client),this.leftClockEncoder.write(e.clock)}writeRightID(e){this.clientEncoder.write(e.client),this.rightClockEncoder.write(e.clock)}writeClient(e){this.clientEncoder.write(e)}writeInfo(e){this.infoEncoder.write(e)}writeString(e){this.stringEncoder.write(e)}writeParentInfo(e){this.parentInfoEncoder.write(e?1:0)}writeTypeRef(e){this.typeRefEncoder.write(e)}writeLen(e){this.lenEncoder.write(e)}writeAny(e){uk(this.restEncoder,e)}writeBuf(e){uv(this.restEncoder,e)}writeJSON(e){uk(this.restEncoder,e)}writeKey(e){let t=this.keyMap.get(e);void 0===t?(this.keyClockEncoder.write(this.keyClock++),this.stringEncoder.write(e)):this.keyClockEncoder.write(t)}}let dV=(e,t,r,n)=>{n=c0(n,t[0].id.clock);let i=fg(t,n);um(e.restEncoder,t.length-i),e.writeClient(r),um(e.restEncoder,n);let o=t[i];o.write(e,n-o.id.clock);for(let r=i+1;r<t.length;r++)t[r].write(e,0)},dz=(e,t,r)=>{let n=new Map;r.forEach((e,r)=>{ff(t,r)>e&&n.set(r,e)}),fd(t).forEach((e,t)=>{r.has(t)||n.set(t,0)}),um(e.restEncoder,n.size),c4(n.entries()).sort((e,t)=>t[0]-e[0]).forEach(([r,n])=>{dV(e,t.clients.get(r),r,n)})},dq=(e,t)=>{let r=u0(),n=uW(e.restDecoder);for(let i=0;i<n;i++){let n=uW(e.restDecoder),i=Array(n),o=e.readClient(),s=uW(e.restDecoder);r.set(o,{i:0,refs:i});for(let r=0;r<n;r++){let n=e.readInfo();switch(31&n){case 0:{let t=e.readLen();i[r]=new pU(fa(o,s),t),s+=t;break}case 10:{let t=uW(e.restDecoder);i[r]=new p8(fa(o,s),t),s+=t;break}default:{let a=(192&n)==0,l=new p1(fa(o,s),null,(128&n)==128?e.readLeftID():null,null,(64&n)==64?e.readRightID():null,a?e.readParentInfo()?t.get(e.readString()):e.readLeftID():null,a&&(32&n)==32?e.readString():null,p2(e,n));i[r]=l,s+=l.length}}}}return r},dJ=(e,t,r)=>{let n=[],i=c4(r.keys()).sort((e,t)=>e-t);if(0===i.length)return null;let o=()=>{if(0===i.length)return null;let e=r.get(i[i.length-1]);for(;e.refs.length===e.i;){if(i.pop(),!(i.length>0))return null;e=r.get(i[i.length-1])}return e},s=o();if(null===s)return null;let a=new fh,l=new Map,c=(e,t)=>{let r=l.get(e);(null==r||r>t)&&l.set(e,t)},u=s.refs[s.i++],h=new Map,d=()=>{for(let e of n){let t=e.id.client,n=r.get(t);n?(n.i--,a.clients.set(t,n.refs.slice(n.i)),r.delete(t),n.i=0,n.refs=[]):a.clients.set(t,[e]),i=i.filter(e=>e!==t)}n.length=0};for(;;){if(u.constructor!==p8){let i=u2(h,u.id.client,()=>ff(t,u.id.client))-u.id.clock;if(i<0)n.push(u),c(u.id.client,u.id.clock-1),d();else{let o=u.getMissing(e,t);if(null!==o){n.push(u);let e=r.get(o)||{refs:[],i:0};if(e.refs.length===e.i)c(o,ff(t,o)),d();else{u=e.refs[e.i++];continue}}else(0===i||i<u.length)&&(u.integrate(e,i),h.set(u.id.client,u.id.clock+u.length))}}if(n.length>0)u=n.pop();else if(null!==s&&s.i<s.refs.length)u=s.refs[s.i++];else{if(null===(s=o()))break;u=s.refs[s.i++]}}if(a.clients.size>0){let e=new dY;return dz(e,a,new Map),um(e.restEncoder,0),{missing:l,update:e.toUint8Array()}}return null},dX=(e,t)=>dz(e,t.doc.store,t.beforeState),dQ=(e,t,r,n=new dG(e))=>fk(t,e=>{e.local=!1;let t=!1,r=e.doc,i=r.store,o=dJ(e,i,dq(n,r)),s=i.pendingStructs;if(s){for(let[e,r]of s.missing)if(r<ff(i,e)){t=!0;break}if(o){for(let[e,t]of o.missing){let r=s.missing.get(e);(null==r||r>t)&&s.missing.set(e,t)}s.update=fM([s.update,o.update])}}else i.pendingStructs=o;let a=dD(n,e,i);if(i.pendingDs){let t=new dG(uF(i.pendingDs));uW(t.restDecoder);let r=dD(t,e,i);a&&r?i.pendingDs=fM([a,r]):i.pendingDs=a||r}else i.pendingDs=a;if(t){let t=i.pendingStructs.update;i.pendingStructs=null,dZ(e.doc,t)}},r,!1),dZ=(e,t,r,n=dG)=>{let i=uF(t);dQ(i,e,r,new n(i))},d0=(e,t,r)=>dZ(e,t,r,dj),d1=(e,t,r=new Map)=>{dz(e,t.store,r),dU(e,dM(t.store))},d2=(e,t=new Uint8Array([0]),r=new dY)=>{d1(r,e,d3(t));let n=[r.toUint8Array()];if(e.store.pendingDs&&n.push(e.store.pendingDs),e.store.pendingStructs&&n.push(fU(e.store.pendingStructs.update,t)),n.length>1){if(r.constructor===dW)return fI(n.map((e,t)=>0===t?e:fj(e)));if(r.constructor===dY)return fM(n)}return n[0]},d6=(e,t)=>d2(e,t,new dW),d8=e=>{let t=new Map,r=uW(e.restDecoder);for(let n=0;n<r;n++){let r=uW(e.restDecoder),n=uW(e.restDecoder);t.set(r,n)}return t},d3=e=>d8(new dF(uF(e))),d5=(e,t)=>(um(e.restEncoder,t.size),c4(t.entries()).sort((e,t)=>t[0]-e[0]).forEach(([t,r])=>{um(e.restEncoder,t),um(e.restEncoder,r)}),e),d4=(e,t)=>d5(e,fd(t.store)),d7=(e,t=new dH)=>(e instanceof Map?d5(t,e):d4(t,e),t.toUint8Array()),d9=e=>d7(e,new dK);class fe{constructor(){this.l=[]}}let ft=()=>new fe,fr=(e,t)=>e.l.push(t),fn=(e,t)=>{let r=e.l,n=r.length;e.l=r.filter(e=>t!==e),n===e.l.length&&console.error("[yjs] Tried to remove event handler that doesn't exist.")},fi=(e,t,r)=>hd(e.l,[t,r]);class fo{constructor(e,t){this.client=e,this.clock=t}}let fs=(e,t)=>e===t||null!==e&&null!==t&&e.client===t.client&&e.clock===t.clock,fa=(e,t)=>new fo(e,t),fl=e=>{for(let[t,r]of e.doc.share.entries())if(r===e)return t;throw uc()};M=dx(),new class{constructor(e,t){this.ds=e,this.sv=t}}(M,new Map);let fc=(e,t)=>void 0===t?!e.deleted:t.sv.has(e.id.client)&&(t.sv.get(e.id.client)||0)>e.id.clock&&!dk(t.ds,e.id),fu=(e,t)=>{let r=u2(e.meta,fu,c8),n=e.doc.store;r.has(t)||(t.sv.forEach((t,r)=>{t<ff(n,r)&&fy(e,fa(r,t))}),dS(e,t.ds,e=>{}),r.add(t))};class fh{constructor(){this.clients=new Map,this.pendingStructs=null,this.pendingDs=null}}let fd=e=>{let t=new Map;return e.clients.forEach((e,r)=>{let n=e[e.length-1];t.set(r,n.id.clock+n.length)}),t},ff=(e,t)=>{let r=e.clients.get(t);if(void 0===r)return 0;let n=r[r.length-1];return n.id.clock+n.length},fp=(e,t)=>{let r=e.clients.get(t.id.client);if(void 0===r)r=[],e.clients.set(t.id.client,r);else{let e=r[r.length-1];if(e.id.clock+e.length!==t.id.clock)throw uc()}r.push(t)},fg=(e,t)=>{let r=0,n=e.length-1,i=e[n],o=i.id.clock;if(o===t)return n;let s=cX(t/(o+i.length-1)*n);for(;r<=n;){if((o=(i=e[s]).id.clock)<=t){if(t<o+i.length)return s;r=s+1}else n=s-1;s=cX((r+n)/2)}throw uc()},fm=(e,t)=>{let r=e.clients.get(t.client);return r[fg(r,t.clock)]},fE=(e,t,r)=>{let n=fg(t,r),i=t[n];return i.id.clock<r&&i instanceof p1?(t.splice(n+1,0,p0(e,i,r-i.id.clock)),n+1):n},fy=(e,t)=>{let r=e.doc.store.clients.get(t.client);return r[fE(e,r,t.clock)]},f_=(e,t,r)=>{let n=t.clients.get(r.client),i=fg(n,r.clock),o=n[i];return r.clock!==o.id.clock+o.length-1&&o.constructor!==pU&&n.splice(i+1,0,p0(e,o,r.clock-o.id.clock+1)),o},fT=(e,t,r)=>{let n=e.clients.get(t.id.client);n[fg(n,t.id.clock)]=r},fA=(e,t,r,n,i)=>{let o;if(0===n)return;let s=r+n,a=fE(e,t,r);do s<(o=t[a++]).id.clock+o.length&&fE(e,t,s),i(o);while(a<t.length&&t[a].id.clock<s)};class fv{constructor(e,t,r){this.doc=e,this.deleteSet=new dO,this.beforeState=fd(e.store),this.afterState=new Map,this.changed=new Map,this.changedParentTypes=new Map,this._mergeStructs=[],this.origin=t,this.meta=new Map,this.local=r,this.subdocsAdded=new Set,this.subdocsRemoved=new Set,this.subdocsLoaded=new Set,this._needFormattingCleanup=!1}}let fb=(e,t)=>!!(0!==t.deleteSet.clients.size||u8(t.afterState,(e,r)=>t.beforeState.get(r)!==e))&&(dN(t.deleteSet),dX(e,t),dU(e,t.deleteSet),!0),fR=(e,t,r)=>{let n=t._item;(null===n||n.id.clock<(e.beforeState.get(n.id.client)||0)&&!n.deleted)&&u2(e.changed,t,c8).add(r)},fw=(e,t)=>{let r=e[t],n=e[t-1],i=t;for(;i>0;r=n,n=e[--i-1]){if(n.deleted===r.deleted&&n.constructor===r.constructor&&n.mergeWith(r)){r instanceof p1&&null!==r.parentSub&&r.parent._map.get(r.parentSub)===r&&r.parent._map.set(r.parentSub,n);continue}break}let o=t-i;return o&&e.splice(t+1-o,o),o},fO=(e,t,r)=>{for(let[n,i]of e.clients.entries()){let e=t.clients.get(n);for(let n=i.length-1;n>=0;n--){let o=i[n],s=o.clock+o.len;for(let n=fg(e,o.clock),i=e[n];n<e.length&&i.id.clock<s;i=e[++n]){let i=e[n];if(o.clock+o.len<=i.id.clock)break;i instanceof p1&&i.deleted&&!i.keep&&r(i)&&i.gc(t,!1)}}}},fS=(e,t)=>{e.clients.forEach((e,r)=>{let n=t.clients.get(r);for(let t=e.length-1;t>=0;t--){let r=e[t],i=cZ(n.length-1,1+fg(n,r.clock+r.len-1));for(let e=i,t=n[e];e>0&&t.id.clock>=r.clock;t=n[e])e-=1+fw(n,e)}})},fL=(e,t)=>{if(t<e.length){let r=e[t],n=r.doc,i=n.store,o=r.deleteSet,s=r._mergeStructs;try{dN(o),r.afterState=fd(r.doc.store),n.emit("beforeObserverCalls",[r,n]);let e=[];r.changed.forEach((t,n)=>e.push(()=>{null!==n._item&&n._item.deleted||n._callObserver(r,t)})),e.push(()=>{r.changedParentTypes.forEach((e,t)=>{t._dEH.l.length>0&&(null===t._item||!t._item.deleted)&&((e=e.filter(e=>null===e.target._item||!e.target._item.deleted)).forEach(e=>{e.currentTarget=t,e._path=null}),e.sort((e,t)=>e.path.length-t.path.length),fi(t._dEH,e,r))})}),e.push(()=>n.emit("afterTransaction",[r,n])),hd(e,[]),r._needFormattingCleanup&&pR(r)}finally{n.gc&&fO(o,i,n.gcFilter),fS(o,i),r.afterState.forEach((e,t)=>{let n=r.beforeState.get(t)||0;if(n!==e){let e=i.clients.get(t),r=c0(fg(e,n),1);for(let t=e.length-1;t>=r;)t-=1+fw(e,t)}});for(let e=s.length-1;e>=0;e--){let{client:t,clock:r}=s[e].id,n=i.clients.get(t),o=fg(n,r);!(o+1<n.length&&fw(n,o+1)>1)&&o>0&&fw(n,o)}if(r.local||r.afterState.get(n.clientID)===r.beforeState.get(n.clientID)||(dT(dm,dc,"[yjs] ",du,dp,"Changed the client-id because another client seems to be using it."),n.clientID=u4()),n.emit("afterTransactionCleanup",[r,n]),n._observers.has("update")){let e=new dW;fb(e,r)&&n.emit("update",[e.toUint8Array(),r.origin,n,r])}if(n._observers.has("updateV2")){let e=new dY;fb(e,r)&&n.emit("updateV2",[e.toUint8Array(),r.origin,n,r])}let{subdocsAdded:a,subdocsLoaded:l,subdocsRemoved:c}=r;(a.size>0||c.size>0||l.size>0)&&(a.forEach(e=>{e.clientID=n.clientID,null==e.collectionid&&(e.collectionid=n.collectionid),n.subdocs.add(e)}),c.forEach(e=>n.subdocs.delete(e)),n.emit("subdocs",[{loaded:l,added:a,removed:c},n,r]),c.forEach(e=>e.destroy())),e.length<=t+1?(n._transactionCleanups=[],n.emit("afterAllTransactions",[n,e])):fL(e,t+1)}}},fk=(e,t,r=null,n=!0)=>{let i=e._transactionCleanups,o=!1,s=null;null===e._transaction&&(o=!0,e._transaction=new fv(e,r,n),i.push(e._transaction),1===i.length&&e.emit("beforeAllTransactions",[e]),e.emit("beforeTransaction",[e._transaction,e]));try{s=t(e._transaction)}finally{if(o){let t=e._transaction===i[0];e._transaction=null,t&&fL(i,0)}}return s};class fN{constructor(e,t){this.gen=function*(e){let t=uW(e.restDecoder);for(let r=0;r<t;r++){let t=uW(e.restDecoder),r=e.readClient(),n=uW(e.restDecoder);for(let i=0;i<t;i++){let t=e.readInfo();if(10===t){let t=uW(e.restDecoder);yield new p8(fa(r,n),t),n+=t}else if((31&t)!=0){let i=(192&t)==0,o=new p1(fa(r,n),null,(128&t)==128?e.readLeftID():null,null,(64&t)==64?e.readRightID():null,i?e.readParentInfo()?e.readString():e.readLeftID():null,i&&(32&t)==32?e.readString():null,p2(e,t));yield o,n+=o.length}else{let t=e.readLen();yield new pU(fa(r,n),t),n+=t}}}}(e),this.curr=null,this.done=!1,this.filterSkips=t,this.next()}next(){do this.curr=this.gen.next().value||null;while(this.filterSkips&&null!==this.curr&&this.curr.constructor===p8)return this.curr}}class fC{constructor(e){this.currClient=0,this.startClock=0,this.written=0,this.encoder=e,this.clientStructs=[]}}let fI=e=>fM(e,dj,dW),fx=(e,t)=>{if(e.constructor===pU){let{client:r,clock:n}=e.id;return new pU(fa(r,n+t),e.length-t)}if(e.constructor===p8){let{client:r,clock:n}=e.id;return new p8(fa(r,n+t),e.length-t)}{let{client:r,clock:n}=e.id;return new p1(fa(r,n+t),null,fa(r,n+t-1),null,e.rightOrigin,e.parent,e.parentSub,e.content.splice(t))}},fM=(e,t=dG,r=dY)=>{if(1===e.length)return e[0];let n=e.map(e=>new t(uF(e))),i=n.map(e=>new fN(e,!0)),o=null,s=new r,a=new fC(s);for(;(i=i.filter(e=>null!==e.curr)).sort((e,t)=>{if(e.curr.id.client!==t.curr.id.client)return t.curr.id.client-e.curr.id.client;{let r=e.curr.id.clock-t.curr.id.clock;return 0===r?e.curr.constructor===t.curr.constructor?0:e.curr.constructor===p8?1:-1:r}}),0!==i.length;){let e=i[0],t=e.curr.id.client;if(null!==o){let r=e.curr,n=!1;for(;null!==r&&r.id.clock+r.length<=o.struct.id.clock+o.struct.length&&r.id.client>=o.struct.id.client;)r=e.next(),n=!0;if(null===r||r.id.client!==t||n&&r.id.clock>o.struct.id.clock+o.struct.length)continue;if(t!==o.struct.id.client)fD(a,o.struct,o.offset),o={struct:r,offset:0},e.next();else if(o.struct.id.clock+o.struct.length<r.id.clock){if(o.struct.constructor===p8)o.struct.length=r.id.clock+r.length-o.struct.id.clock;else{fD(a,o.struct,o.offset);let e=r.id.clock-o.struct.id.clock-o.struct.length;o={struct:new p8(fa(t,o.struct.id.clock+o.struct.length),e),offset:0}}}else{let t=o.struct.id.clock+o.struct.length-r.id.clock;t>0&&(o.struct.constructor===p8?o.struct.length-=t:r=fx(r,t)),o.struct.mergeWith(r)||(fD(a,o.struct,o.offset),o={struct:r,offset:0},e.next())}}else o={struct:e.curr,offset:0},e.next();for(let r=e.curr;null!==r&&r.id.client===t&&r.id.clock===o.struct.id.clock+o.struct.length&&r.constructor!==p8;r=e.next())fD(a,o.struct,o.offset),o={struct:r,offset:0}}return null!==o&&(fD(a,o.struct,o.offset),o=null),fB(a),dU(s,dC(n.map(e=>dP(e)))),s.toUint8Array()},fU=(e,t,r=dG,n=dY)=>{let i=d3(t),o=new n,s=new fC(o),a=new r(uF(e)),l=new fN(a,!1);for(;l.curr;){let e=l.curr,t=e.id.client,r=i.get(t)||0;if(l.curr.constructor===p8){l.next();continue}if(e.id.clock+e.length>r)for(fD(s,e,c0(r-e.id.clock,0)),l.next();l.curr&&l.curr.id.client===t;)fD(s,l.curr,0),l.next();else for(;l.curr&&l.curr.id.client===t&&l.curr.id.clock+l.curr.length<=r;)l.next()}return fB(s),dU(o,dP(a)),o.toUint8Array()},fP=e=>{e.written>0&&(e.clientStructs.push({written:e.written,restEncoder:uf(e.encoder.restEncoder)}),e.encoder.restEncoder=uh(),e.written=0)},fD=(e,t,r)=>{e.written>0&&e.currClient!==t.id.client&&fP(e),0===e.written&&(e.currClient=t.id.client,e.encoder.writeClient(t.id.client),um(e.encoder.restEncoder,t.id.clock+r)),t.write(e.encoder,r),e.written++},fB=e=>{fP(e);let t=e.encoder.restEncoder;um(t,e.clientStructs.length);for(let r=0;r<e.clientStructs.length;r++){let n=e.clientStructs[r];um(t,n.written),uA(t,n.restEncoder)}},fF=(e,t,r,n)=>{let i=new r(uF(e)),o=new fN(i,!1),s=new n,a=new fC(s);for(let e=o.curr;null!==e;e=o.next())fD(a,t(e),0);return fB(a),dU(s,dP(i)),s.toUint8Array()},fj=e=>fF(e,hf,dG,dW),f$="You must not compute changes after the event-handler fired.";class fG{constructor(e,t){this.target=e,this.currentTarget=e,this.transaction=t,this._changes=null,this._keys=null,this._delta=null,this._path=null}get path(){return this._path||(this._path=fK(this.currentTarget,this.target))}deletes(e){return dk(this.transaction.deleteSet,e.id)}get keys(){if(null===this._keys){if(0===this.transaction.doc._transactionCleanups.length)throw ua(f$);let e=new Map,t=this.target;this.transaction.changed.get(t).forEach(r=>{if(null!==r){let n,i;let o=t._map.get(r);if(this.adds(o)){let e=o.left;for(;null!==e&&this.adds(e);)e=e.left;if(this.deletes(o)){if(!(null!==e&&this.deletes(e)))return;n="delete",i=c3(e.content.getContent())}else null!==e&&this.deletes(e)?(n="update",i=c3(e.content.getContent())):(n="add",i=void 0)}else{if(!this.deletes(o))return;n="delete",i=c3(o.content.getContent())}e.set(r,{action:n,oldValue:i})}}),this._keys=e}return this._keys}get delta(){return this.changes.delta}adds(e){return e.id.clock>=(this.transaction.beforeState.get(e.id.client)||0)}get changes(){let e=this._changes;if(null===e){if(0===this.transaction.doc._transactionCleanups.length)throw ua(f$);let t=this.target,r=c8(),n=c8(),i=[];if(e={added:r,deleted:n,delta:i,keys:this.keys},this.transaction.changed.get(t).has(null)){let e=null,o=()=>{e&&i.push(e)};for(let i=t._start;null!==i;i=i.right)i.deleted?this.deletes(i)&&!this.adds(i)&&((null===e||void 0===e.delete)&&(o(),e={delete:0}),e.delete+=i.length,n.add(i)):this.adds(i)?((null===e||void 0===e.insert)&&(o(),e={insert:[]}),e.insert=e.insert.concat(i.content.getContent()),r.add(i)):((null===e||void 0===e.retain)&&(o(),e={retain:0}),e.retain+=i.length);null!==e&&void 0===e.retain&&o()}this._changes=e}return e}}let fK=(e,t)=>{let r=[];for(;null!==t._item&&t!==e;){if(null!==t._item.parentSub)r.unshift(t._item.parentSub);else{let e=0,n=t._item.parent._start;for(;n!==t._item&&null!==n;)!n.deleted&&e++,n=n.right;r.unshift(e)}t=t._item.parent}return r},fW=0;class fH{constructor(e,t){e.marker=!0,this.p=e,this.index=t,this.timestamp=fW++}}let fY=e=>{e.timestamp=fW++},fV=(e,t,r)=>{e.p.marker=!1,e.p=t,t.marker=!0,e.index=r,e.timestamp=fW++},fz=(e,t,r)=>{if(e.length>=80){let n=e.reduce((e,t)=>e.timestamp<t.timestamp?e:t);return fV(n,t,r),n}{let n=new fH(t,r);return e.push(n),n}},fq=(e,t)=>{if(null===e._start||0===t||null===e._searchMarker)return null;let r=0===e._searchMarker.length?null:e._searchMarker.reduce((e,r)=>cQ(t-e.index)<cQ(t-r.index)?e:r),n=e._start,i=0;for(null!==r&&(n=r.p,i=r.index,fY(r));null!==n.right&&i<t;){if(!n.deleted&&n.countable){if(t<i+n.length)break;i+=n.length}n=n.right}for(;null!==n.left&&i>t;)!(n=n.left).deleted&&n.countable&&(i-=n.length);for(;null!==n.left&&n.left.id.client===n.id.client&&n.left.id.clock+n.left.length===n.id.clock;)!(n=n.left).deleted&&n.countable&&(i-=n.length);return null!==r&&cQ(r.index-i)<n.parent.length/80?(fV(r,n,i),r):fz(e._searchMarker,n,i)},fJ=(e,t,r)=>{for(let n=e.length-1;n>=0;n--){let i=e[n];if(r>0){let t=i.p;for(t.marker=!1;t&&(t.deleted||!t.countable);)(t=t.left)&&!t.deleted&&t.countable&&(i.index-=t.length);if(null===t||!0===t.marker){e.splice(n,1);continue}i.p=t,t.marker=!0}(t<i.index||r>0&&t===i.index)&&(i.index=c0(t,i.index+r))}},fX=(e,t,r)=>{let n=e,i=t.changedParentTypes;for(;u2(i,e,()=>[]).push(r),null!==e._item;)e=e._item.parent;fi(n._eH,r,t)};class fQ{constructor(){this._item=null,this._map=new Map,this._start=null,this.doc=null,this._length=0,this._eH=ft(),this._dEH=ft(),this._searchMarker=null}get parent(){return this._item?this._item.parent:null}_integrate(e,t){this.doc=e,this._item=t}_copy(){throw ul()}clone(){throw ul()}_write(e){}get _first(){let e=this._start;for(;null!==e&&e.deleted;)e=e.right;return e}_callObserver(e,t){!e.local&&this._searchMarker&&(this._searchMarker.length=0)}observe(e){fr(this._eH,e)}observeDeep(e){fr(this._dEH,e)}unobserve(e){fn(this._eH,e)}unobserveDeep(e){fn(this._dEH,e)}toJSON(){}}let fZ=(e,t,r)=>{t<0&&(t=e._length+t),r<0&&(r=e._length+r);let n=r-t,i=[],o=e._start;for(;null!==o&&n>0;){if(o.countable&&!o.deleted){let e=o.content.getContent();if(e.length<=t)t-=e.length;else{for(let r=t;r<e.length&&n>0;r++)i.push(e[r]),n--;t=0}}o=o.right}return i},f0=e=>{let t=[],r=e._start;for(;null!==r;){if(r.countable&&!r.deleted){let e=r.content.getContent();for(let r=0;r<e.length;r++)t.push(e[r])}r=r.right}return t},f1=(e,t)=>{let r=0,n=e._start;for(;null!==n;){if(n.countable&&!n.deleted){let i=n.content.getContent();for(let n=0;n<i.length;n++)t(i[n],r++,e)}n=n.right}},f2=(e,t)=>{let r=[];return f1(e,(n,i)=>{r.push(t(n,i,e))}),r},f6=e=>{let t=e._start,r=null,n=0;return{[Symbol.iterator](){return this},next:()=>{if(null===r){for(;null!==t&&t.deleted;)t=t.right;if(null===t)return{done:!0,value:void 0};r=t.content.getContent(),n=0,t=t.right}let e=r[n++];return r.length<=n&&(r=null),{done:!1,value:e}}}},f8=(e,t)=>{let r=fq(e,t),n=e._start;for(null!==r&&(n=r.p,t-=r.index);null!==n;n=n.right)if(!n.deleted&&n.countable){if(t<n.length)return n.content.getContent()[t];t-=n.length}},f3=(e,t,r,n)=>{let i=r,o=e.doc,s=o.clientID,a=o.store,l=null===r?t._start:r.right,c=[],u=()=>{c.length>0&&((i=new p1(fa(s,ff(a,s)),i,i&&i.lastId,l,l&&l.id,t,null,new pK(c))).integrate(e,0),c=[])};n.forEach(r=>{if(null===r)c.push(r);else switch(r.constructor){case Number:case Object:case Boolean:case Array:case String:c.push(r);break;default:switch(u(),r.constructor){case Uint8Array:case ArrayBuffer:(i=new p1(fa(s,ff(a,s)),i,i&&i.lastId,l,l&&l.id,t,null,new pP(new Uint8Array(r)))).integrate(e,0);break;case dB:(i=new p1(fa(s,ff(a,s)),i,i&&i.lastId,l,l&&l.id,t,null,new pF(r))).integrate(e,0);break;default:if(r instanceof fQ)(i=new p1(fa(s,ff(a,s)),i,i&&i.lastId,l,l&&l.id,t,null,new pZ(r))).integrate(e,0);else throw Error("Unexpected content type in insert operation")}}}),u()},f5=()=>ua("Length exceeded!"),f4=(e,t,r,n)=>{if(r>t._length)throw f5();if(0===r)return t._searchMarker&&fJ(t._searchMarker,r,n.length),f3(e,t,null,n);let i=r,o=fq(t,r),s=t._start;for(null!==o&&(s=o.p,0==(r-=o.index)&&(r+=(s=s.prev)&&s.countable&&!s.deleted?s.length:0));null!==s;s=s.right)if(!s.deleted&&s.countable){if(r<=s.length){r<s.length&&fy(e,fa(s.id.client,s.id.clock+r));break}r-=s.length}return t._searchMarker&&fJ(t._searchMarker,i,n.length),f3(e,t,s,n)},f7=(e,t,r)=>{let n=(t._searchMarker||[]).reduce((e,t)=>t.index>e.index?t:e,{index:0,p:t._start}).p;if(n)for(;n.right;)n=n.right;return f3(e,t,n,r)},f9=(e,t,r,n)=>{if(0===n)return;let i=r,o=n,s=fq(t,r),a=t._start;for(null!==s&&(a=s.p,r-=s.index);null!==a&&r>0;a=a.right)!a.deleted&&a.countable&&(r<a.length&&fy(e,fa(a.id.client,a.id.clock+r)),r-=a.length);for(;n>0&&null!==a;)a.deleted||(n<a.length&&fy(e,fa(a.id.client,a.id.clock+n)),a.delete(e),n-=a.length),a=a.right;if(n>0)throw f5();t._searchMarker&&fJ(t._searchMarker,i,-o+n)},pe=(e,t,r)=>{let n=t._map.get(r);void 0!==n&&n.delete(e)},pt=(e,t,r,n)=>{let i;let o=t._map.get(r)||null,s=e.doc,a=s.clientID;if(null==n)i=new pK([n]);else switch(n.constructor){case Number:case Object:case Boolean:case Array:case String:i=new pK([n]);break;case Uint8Array:i=new pP(n);break;case dB:i=new pF(n);break;default:if(n instanceof fQ)i=new pZ(n);else throw Error("Unexpected content type")}new p1(fa(a,ff(s.store,a)),o,o&&o.lastId,null,null,t,r,i).integrate(e,0)},pr=(e,t)=>{let r=e._map.get(t);return void 0===r||r.deleted?void 0:r.content.getContent()[r.length-1]},pn=e=>{let t={};return e._map.forEach((e,r)=>{e.deleted||(t[r]=e.content.getContent()[e.length-1])}),t},pi=(e,t)=>{let r=e._map.get(t);return void 0!==r&&!r.deleted},po=(e,t)=>{let r={};return e._map.forEach((e,n)=>{let i=e;for(;null!==i&&(!t.sv.has(i.id.client)||i.id.clock>=(t.sv.get(i.id.client)||0));)i=i.left;null!==i&&fc(i,t)&&(r[n]=i.content.getContent()[i.length-1])}),r},ps=e=>db(e.entries(),e=>!e[1].deleted);class pa extends fG{constructor(e,t){super(e,t),this._transaction=t}}class pl extends fQ{constructor(){super(),this._prelimContent=[],this._searchMarker=[]}static from(e){let t=new pl;return t.push(e),t}_integrate(e,t){super._integrate(e,t),this.insert(0,this._prelimContent),this._prelimContent=null}_copy(){return new pl}clone(){let e=new pl;return e.insert(0,this.toArray().map(e=>e instanceof fQ?e.clone():e)),e}get length(){return null===this._prelimContent?this._length:this._prelimContent.length}_callObserver(e,t){super._callObserver(e,t),fX(this,e,new pa(this,e))}insert(e,t){null!==this.doc?fk(this.doc,r=>{f4(r,this,e,t)}):this._prelimContent.splice(e,0,...t)}push(e){null!==this.doc?fk(this.doc,t=>{f7(t,this,e)}):this._prelimContent.push(...e)}unshift(e){this.insert(0,e)}delete(e,t=1){null!==this.doc?fk(this.doc,r=>{f9(r,this,e,t)}):this._prelimContent.splice(e,t)}get(e){return f8(this,e)}toArray(){return f0(this)}slice(e=0,t=this.length){return fZ(this,e,t)}toJSON(){return this.map(e=>e instanceof fQ?e.toJSON():e)}map(e){return f2(this,e)}forEach(e){f1(this,e)}[Symbol.iterator](){return f6(this)}_write(e){e.writeTypeRef(pY)}}class pc extends fG{constructor(e,t,r){super(e,t),this.keysChanged=r}}class pu extends fQ{constructor(e){super(),this._prelimContent=null,void 0===e?this._prelimContent=new Map:this._prelimContent=new Map(e)}_integrate(e,t){super._integrate(e,t),this._prelimContent.forEach((e,t)=>{this.set(t,e)}),this._prelimContent=null}_copy(){return new pu}clone(){let e=new pu;return this.forEach((t,r)=>{e.set(r,t instanceof fQ?t.clone():t)}),e}_callObserver(e,t){fX(this,e,new pc(this,e,t))}toJSON(){let e={};return this._map.forEach((t,r)=>{if(!t.deleted){let n=t.content.getContent()[t.length-1];e[r]=n instanceof fQ?n.toJSON():n}}),e}get size(){return[...ps(this._map)].length}keys(){return dR(ps(this._map),e=>e[0])}values(){return dR(ps(this._map),e=>e[1].content.getContent()[e[1].length-1])}entries(){return dR(ps(this._map),e=>[e[0],e[1].content.getContent()[e[1].length-1]])}forEach(e){this._map.forEach((t,r)=>{t.deleted||e(t.content.getContent()[t.length-1],r,this)})}[Symbol.iterator](){return this.entries()}delete(e){null!==this.doc?fk(this.doc,t=>{pe(t,this,e)}):this._prelimContent.delete(e)}set(e,t){return null!==this.doc?fk(this.doc,r=>{pt(r,this,e,t)}):this._prelimContent.set(e,t),t}get(e){return pr(this,e)}has(e){return pi(this,e)}clear(){null!==this.doc?fk(this.doc,e=>{this.forEach(function(t,r,n){pe(e,n,r)})}):this._prelimContent.clear()}_write(e){e.writeTypeRef(pV)}}let ph=(e,t)=>e===t||"object"==typeof e&&"object"==typeof t&&e&&t&&hh(e,t);class pd{constructor(e,t,r,n){this.left=e,this.right=t,this.index=r,this.currentAttributes=n}forward(){(null===this.right&&uc(),this.right.content.constructor===p$)?this.right.deleted||pm(this.currentAttributes,this.right.content):this.right.deleted||(this.index+=this.right.length),this.left=this.right,this.right=this.right.right}}let pf=(e,t,r)=>{for(;null!==t.right&&r>0;)t.right.content.constructor===p$?t.right.deleted||pm(t.currentAttributes,t.right.content):t.right.deleted||(r<t.right.length&&fy(e,fa(t.right.id.client,t.right.id.clock+r)),t.index+=t.right.length,r-=t.right.length),t.left=t.right,t.right=t.right.right;return t},pp=(e,t,r)=>{let n=new Map,i=fq(t,r);return i?pf(e,new pd(i.p.left,i.p,i.index,n),r-i.index):pf(e,new pd(null,t._start,0,n),r)},pg=(e,t,r,n)=>{for(;null!==r.right&&(!0===r.right.deleted||r.right.content.constructor===p$&&ph(n.get(r.right.content.key),r.right.content.value));)r.right.deleted||n.delete(r.right.content.key),r.forward();let i=e.doc,o=i.clientID;n.forEach((n,s)=>{let a=r.left,l=r.right,c=new p1(fa(o,ff(i.store,o)),a,a&&a.lastId,l,l&&l.id,t,null,new p$(s,n));c.integrate(e,0),r.right=c,r.forward()})},pm=(e,t)=>{let{key:r,value:n}=t;null===n?e.delete(r):e.set(r,n)},pE=(e,t)=>{for(;null!==e.right&&(e.right.deleted||e.right.content.constructor===p$&&ph(t[e.right.content.key]||null,e.right.content.value));)e.forward()},py=(e,t,r,n)=>{let i=e.doc,o=i.clientID,s=new Map;for(let a in n){let l=n[a],c=r.currentAttributes.get(a)||null;if(!ph(c,l)){s.set(a,c);let{left:n,right:u}=r;r.right=new p1(fa(o,ff(i.store,o)),n,n&&n.lastId,u,u&&u.id,t,null,new p$(a,l)),r.right.integrate(e,0),r.forward()}}return s},p_=(e,t,r,n,i)=>{r.currentAttributes.forEach((e,t)=>{void 0===i[t]&&(i[t]=null)});let o=e.doc,s=o.clientID;pE(r,i);let a=py(e,t,r,i),l=n.constructor===String?new pW(n):n instanceof fQ?new pZ(n):new pj(n),{left:c,right:u,index:h}=r;t._searchMarker&&fJ(t._searchMarker,r.index,l.getLength()),(u=new p1(fa(s,ff(o.store,s)),c,c&&c.lastId,u,u&&u.id,t,null,l)).integrate(e,0),r.right=u,r.index=h,r.forward(),pg(e,t,r,a)},pT=(e,t,r,n,i)=>{let o=e.doc,s=o.clientID;pE(r,i);let a=py(e,t,r,i);for(;null!==r.right&&(n>0||a.size>0&&(r.right.deleted||r.right.content.constructor===p$));){if(!r.right.deleted){if(r.right.content.constructor===p$){let{key:t,value:o}=r.right.content,s=i[t];if(void 0!==s){if(ph(s,o))a.delete(t);else{if(0===n)break;a.set(t,o)}r.right.delete(e)}else r.currentAttributes.set(t,o)}else n<r.right.length&&fy(e,fa(r.right.id.client,r.right.id.clock+n)),n-=r.right.length}r.forward()}if(n>0){let i="";for(;n>0;n--)i+="\n";r.right=new p1(fa(s,ff(o.store,s)),r.left,r.left&&r.left.lastId,r.right,r.right&&r.right.id,t,null,new pW(i)),r.right.integrate(e,0),r.forward()}pg(e,t,r,a)},pA=(e,t,r,n,i)=>{let o=t,s=u0();for(;o&&(!o.countable||o.deleted);){if(!o.deleted&&o.content.constructor===p$){let e=o.content;s.set(e.key,e)}o=o.right}let a=0,l=!1;for(;t!==o;){if(r===t&&(l=!0),!t.deleted){let r=t.content;if(r.constructor===p$){let{key:o,value:c}=r,u=n.get(o)||null;s.get(o)===r&&u!==c||(t.delete(e),a++,l||(i.get(o)||null)!==c||u===c||(null===u?i.delete(o):i.set(o,u))),l||t.deleted||pm(i,r)}}t=t.right}return a},pv=(e,t)=>{for(;t&&t.right&&(t.right.deleted||!t.right.countable);)t=t.right;let r=new Set;for(;t&&(t.deleted||!t.countable);){if(!t.deleted&&t.content.constructor===p$){let n=t.content.key;r.has(n)?t.delete(e):r.add(n)}t=t.left}},pb=e=>{let t=0;return fk(e.doc,r=>{let n=e._start,i=e._start,o=u0(),s=u1(o);for(;i;)!1===i.deleted&&(i.content.constructor===p$?pm(s,i.content):(t+=pA(r,n,i,o,s),o=u1(s),n=i)),i=i.right}),t},pR=e=>{let t=new Set,r=e.doc;for(let[n,i]of e.afterState.entries()){let o=e.beforeState.get(n)||0;i!==o&&fA(e,r.store.clients.get(n),o,i,e=>{e.deleted||e.content.constructor!==p$||e.constructor===pU||t.add(e.parent)})}fk(r,r=>{for(let n of(dS(e,e.deleteSet,e=>{if(e instanceof pU||!e.parent._hasFormatting||t.has(e.parent))return;let n=e.parent;e.content.constructor===p$?t.add(n):pv(r,e)}),t))pb(n)})},pw=(e,t,r)=>{let n=r,i=u1(t.currentAttributes),o=t.right;for(;r>0&&null!==t.right;){if(!1===t.right.deleted)switch(t.right.content.constructor){case pZ:case pj:case pW:r<t.right.length&&fy(e,fa(t.right.id.client,t.right.id.clock+r)),r-=t.right.length,t.right.delete(e)}t.forward()}o&&pA(e,o,t.right,i,t.currentAttributes);let s=(t.left||t.right).parent;return s._searchMarker&&fJ(s._searchMarker,t.index,-n+r),t};class pO extends fG{constructor(e,t,r){super(e,t),this.childListChanged=!1,this.keysChanged=new Set,r.forEach(e=>{null===e?this.childListChanged=!0:this.keysChanged.add(e)})}get changes(){if(null===this._changes){let e={keys:this.keys,delta:this.delta,added:new Set,deleted:new Set};this._changes=e}return this._changes}get delta(){if(null===this._delta){let e=this.target.doc,t=[];fk(e,e=>{let r=new Map,n=new Map,i=this.target._start,o=null,s={},a="",l=0,c=0,u=()=>{if(null!==o){let e=null;switch(o){case"delete":c>0&&(e={delete:c}),c=0;break;case"insert":("object"==typeof a||a.length>0)&&(e={insert:a},r.size>0&&(e.attributes={},r.forEach((t,r)=>{null!==t&&(e.attributes[r]=t)}))),a="";break;case"retain":l>0&&(e={retain:l},hl(s)||(e.attributes=hi({},s))),l=0}e&&t.push(e),o=null}};for(;null!==i;){switch(i.content.constructor){case pZ:case pj:this.adds(i)?this.deletes(i)||(u(),o="insert",a=i.content.getContent()[0],u()):this.deletes(i)?("delete"!==o&&(u(),o="delete"),c+=1):i.deleted||("retain"!==o&&(u(),o="retain"),l+=1);break;case pW:this.adds(i)?this.deletes(i)||("insert"!==o&&(u(),o="insert"),a+=i.content.str):this.deletes(i)?("delete"!==o&&(u(),o="delete"),c+=i.length):i.deleted||("retain"!==o&&(u(),o="retain"),l+=i.length);break;case p$:{let{key:t,value:a}=i.content;if(this.adds(i))this.deletes(i)||(ph(r.get(t)||null,a)?null!==a&&i.delete(e):("retain"===o&&u(),ph(a,n.get(t)||null)?delete s[t]:s[t]=a));else if(this.deletes(i)){n.set(t,a);let e=r.get(t)||null;ph(e,a)||("retain"===o&&u(),s[t]=e)}else if(!i.deleted){n.set(t,a);let r=s[t];void 0!==r&&(ph(r,a)?null!==r&&i.delete(e):("retain"===o&&u(),null===a?delete s[t]:s[t]=a))}i.deleted||("insert"===o&&u(),pm(r,i.content))}}i=i.right}for(u();t.length>0;){let e=t[t.length-1];if(void 0!==e.retain&&void 0===e.attributes)t.pop();else break}}),this._delta=t}return this._delta}}class pS extends fQ{constructor(e){super(),this._pending=void 0!==e?[()=>this.insert(0,e)]:[],this._searchMarker=[],this._hasFormatting=!1}get length(){return this._length}_integrate(e,t){super._integrate(e,t);try{this._pending.forEach(e=>e())}catch(e){console.error(e)}this._pending=null}_copy(){return new pS}clone(){let e=new pS;return e.applyDelta(this.toDelta()),e}_callObserver(e,t){super._callObserver(e,t);let r=new pO(this,e,t);fX(this,e,r),!e.local&&this._hasFormatting&&(e._needFormattingCleanup=!0)}toString(){let e="",t=this._start;for(;null!==t;)!t.deleted&&t.countable&&t.content.constructor===pW&&(e+=t.content.str),t=t.right;return e}toJSON(){return this.toString()}applyDelta(e,{sanitize:t=!0}={}){null!==this.doc?fk(this.doc,r=>{let n=new pd(null,this._start,0,new Map);for(let i=0;i<e.length;i++){let o=e[i];if(void 0!==o.insert){let s=t||"string"!=typeof o.insert||i!==e.length-1||null!==n.right||"\n"!==o.insert.slice(-1)?o.insert:o.insert.slice(0,-1);("string"!=typeof s||s.length>0)&&p_(r,this,n,s,o.attributes||{})}else void 0!==o.retain?pT(r,this,n,o.retain,o.attributes||{}):void 0!==o.delete&&pw(r,n,o.delete)}}):this._pending.push(()=>this.applyDelta(e))}toDelta(e,t,r){let n=[],i=new Map,o=this.doc,s="",a=this._start;function l(){if(s.length>0){let e={},t=!1;i.forEach((r,n)=>{t=!0,e[n]=r});let r={insert:s};t&&(r.attributes=e),n.push(r),s=""}}let c=()=>{for(;null!==a;){if(fc(a,e)||void 0!==t&&fc(a,t))switch(a.content.constructor){case pW:{let n=i.get("ychange");void 0===e||fc(a,e)?void 0===t||fc(a,t)?void 0!==n&&(l(),i.delete("ychange")):(void 0===n||n.user!==a.id.client||"added"!==n.type)&&(l(),i.set("ychange",r?r("added",a.id):{type:"added"})):(void 0===n||n.user!==a.id.client||"removed"!==n.type)&&(l(),i.set("ychange",r?r("removed",a.id):{type:"removed"})),s+=a.content.str;break}case pZ:case pj:{l();let e={insert:a.content.getContent()[0]};if(i.size>0){let t={};e.attributes=t,i.forEach((e,r)=>{t[r]=e})}n.push(e);break}case p$:fc(a,e)&&(l(),pm(i,a.content))}a=a.right}l()};return e||t?fk(o,r=>{e&&fu(r,e),t&&fu(r,t),c()},"cleanup"):c(),n}insert(e,t,r){if(t.length<=0)return;let n=this.doc;null!==n?fk(n,n=>{let i=pp(n,this,e);r||(r={},i.currentAttributes.forEach((e,t)=>{r[t]=e})),p_(n,this,i,t,r)}):this._pending.push(()=>this.insert(e,t,r))}insertEmbed(e,t,r={}){let n=this.doc;null!==n?fk(n,n=>{let i=pp(n,this,e);p_(n,this,i,t,r)}):this._pending.push(()=>this.insertEmbed(e,t,r))}delete(e,t){if(0===t)return;let r=this.doc;null!==r?fk(r,r=>{pw(r,pp(r,this,e),t)}):this._pending.push(()=>this.delete(e,t))}format(e,t,r){if(0===t)return;let n=this.doc;null!==n?fk(n,n=>{let i=pp(n,this,e);null!==i.right&&pT(n,this,i,t,r)}):this._pending.push(()=>this.format(e,t,r))}removeAttribute(e){null!==this.doc?fk(this.doc,t=>{pe(t,this,e)}):this._pending.push(()=>this.removeAttribute(e))}setAttribute(e,t){null!==this.doc?fk(this.doc,r=>{pt(r,this,e,t)}):this._pending.push(()=>this.setAttribute(e,t))}getAttribute(e){return pr(this,e)}getAttributes(){return pn(this)}_write(e){e.writeTypeRef(pz)}}class pL{constructor(e,t=()=>!0){this._filter=t,this._root=e,this._currentNode=e._start,this._firstCall=!0}[Symbol.iterator](){return this}next(){let e=this._currentNode,t=e&&e.content&&e.content.type;if(null!==e&&(!this._firstCall||e.deleted||!this._filter(t)))do if(t=e.content.type,e.deleted||t.constructor!==pN&&t.constructor!==pk||null===t._start)for(;null!==e;){if(null!==e.right){e=e.right;break}e=e.parent===this._root?null:e.parent._item}else e=t._start;while(null!==e&&(e.deleted||!this._filter(e.content.type)))return(this._firstCall=!1,null===e)?{value:void 0,done:!0}:(this._currentNode=e,{value:e.content.type,done:!1})}}class pk extends fQ{constructor(){super(),this._prelimContent=[]}get firstChild(){let e=this._first;return e?e.content.getContent()[0]:null}_integrate(e,t){super._integrate(e,t),this.insert(0,this._prelimContent),this._prelimContent=null}_copy(){return new pk}clone(){let e=new pk;return e.insert(0,this.toArray().map(e=>e instanceof fQ?e.clone():e)),e}get length(){return null===this._prelimContent?this._length:this._prelimContent.length}createTreeWalker(e){return new pL(this,e)}querySelector(e){e=e.toUpperCase();let t=new pL(this,t=>t.nodeName&&t.nodeName.toUpperCase()===e).next();return t.done?null:t.value}querySelectorAll(e){return e=e.toUpperCase(),c4(new pL(this,t=>t.nodeName&&t.nodeName.toUpperCase()===e))}_callObserver(e,t){fX(this,e,new pC(this,t,e))}toString(){return f2(this,e=>e.toString()).join("")}toJSON(){return this.toString()}toDOM(e=document,t={},r){let n=e.createDocumentFragment();return void 0!==r&&r._createAssociation(n,this),f1(this,i=>{n.insertBefore(i.toDOM(e,t,r),null)}),n}insert(e,t){null!==this.doc?fk(this.doc,r=>{f4(r,this,e,t)}):this._prelimContent.splice(e,0,...t)}insertAfter(e,t){if(null!==this.doc)fk(this.doc,r=>{f3(r,this,e&&e instanceof fQ?e._item:e,t)});else{let r=this._prelimContent,n=null===e?0:r.findIndex(t=>t===e)+1;if(0===n&&null!==e)throw ua("Reference item not found");r.splice(n,0,...t)}}delete(e,t=1){null!==this.doc?fk(this.doc,r=>{f9(r,this,e,t)}):this._prelimContent.splice(e,t)}toArray(){return f0(this)}push(e){this.insert(this.length,e)}unshift(e){this.insert(0,e)}get(e){return f8(this,e)}slice(e=0,t=this.length){return fZ(this,e,t)}forEach(e){f1(this,e)}_write(e){e.writeTypeRef(pJ)}}class pN extends pk{constructor(e="UNDEFINED"){super(),this.nodeName=e,this._prelimAttrs=new Map}get nextSibling(){let e=this._item?this._item.next:null;return e?e.content.type:null}get prevSibling(){let e=this._item?this._item.prev:null;return e?e.content.type:null}_integrate(e,t){super._integrate(e,t),this._prelimAttrs.forEach((e,t)=>{this.setAttribute(t,e)}),this._prelimAttrs=null}_copy(){return new pN(this.nodeName)}clone(){let e=new pN(this.nodeName);return hs(this.getAttributes(),(t,r)=>{"string"==typeof t&&e.setAttribute(r,t)}),e.insert(0,this.toArray().map(e=>e instanceof fQ?e.clone():e)),e}toString(){let e=this.getAttributes(),t=[],r=[];for(let t in e)r.push(t);r.sort();let n=r.length;for(let i=0;i<n;i++){let n=r[i];t.push(n+'="'+e[n]+'"')}let i=this.nodeName.toLocaleLowerCase(),o=t.length>0?" "+t.join(" "):"";return`<${i}${o}>${super.toString()}</${i}>`}removeAttribute(e){null!==this.doc?fk(this.doc,t=>{pe(t,this,e)}):this._prelimAttrs.delete(e)}setAttribute(e,t){null!==this.doc?fk(this.doc,r=>{pt(r,this,e,t)}):this._prelimAttrs.set(e,t)}getAttribute(e){return pr(this,e)}hasAttribute(e){return pi(this,e)}getAttributes(e){return e?po(this,e):pn(this)}toDOM(e=document,t={},r){let n=e.createElement(this.nodeName),i=this.getAttributes();for(let e in i){let t=i[e];"string"==typeof t&&n.setAttribute(e,t)}return f1(this,i=>{n.appendChild(i.toDOM(e,t,r))}),void 0!==r&&r._createAssociation(n,this),n}_write(e){e.writeTypeRef(pq),e.writeKey(this.nodeName)}}class pC extends fG{constructor(e,t,r){super(e,r),this.childListChanged=!1,this.attributesChanged=new Set,t.forEach(e=>{null===e?this.childListChanged=!0:this.attributesChanged.add(e)})}}class pI extends pu{constructor(e){super(),this.hookName=e}_copy(){return new pI(this.hookName)}clone(){let e=new pI(this.hookName);return this.forEach((t,r)=>{e.set(r,t)}),e}toDOM(e=document,t={},r){let n;let i=t[this.hookName];return(n=void 0!==i?i.createDom(this):document.createElement(this.hookName)).setAttribute("data-yjs-hook",this.hookName),void 0!==r&&r._createAssociation(n,this),n}_write(e){e.writeTypeRef(pX),e.writeKey(this.hookName)}}class px extends pS{get nextSibling(){let e=this._item?this._item.next:null;return e?e.content.type:null}get prevSibling(){let e=this._item?this._item.prev:null;return e?e.content.type:null}_copy(){return new px}clone(){let e=new px;return e.applyDelta(this.toDelta()),e}toDOM(e=document,t,r){let n=e.createTextNode(this.toString());return void 0!==r&&r._createAssociation(n,this),n}toString(){return this.toDelta().map(e=>{let t=[];for(let r in e.attributes){let n=[];for(let t in e.attributes[r])n.push({key:t,value:e.attributes[r][t]});n.sort((e,t)=>e.key<t.key?-1:1),t.push({nodeName:r,attrs:n})}t.sort((e,t)=>e.nodeName<t.nodeName?-1:1);let r="";for(let e=0;e<t.length;e++){let n=t[e];r+=`<${n.nodeName}`;for(let e=0;e<n.attrs.length;e++){let t=n.attrs[e];r+=` ${t.key}="${t.value}"`}r+=">"}r+=e.insert;for(let e=t.length-1;e>=0;e--)r+=`</${t[e].nodeName}>`;return r}).join("")}toJSON(){return this.toString()}_write(e){e.writeTypeRef(pQ)}}class pM{constructor(e,t){this.id=e,this.length=t}get deleted(){throw ul()}mergeWith(e){return!1}write(e,t,r){throw ul()}integrate(e,t){throw ul()}}class pU extends pM{get deleted(){return!0}delete(){}mergeWith(e){return this.constructor===e.constructor&&(this.length+=e.length,!0)}integrate(e,t){t>0&&(this.id.clock+=t,this.length-=t),fp(e.doc.store,this)}write(e,t){e.writeInfo(0),e.writeLen(this.length-t)}getMissing(e,t){return null}}class pP{constructor(e){this.content=e}getLength(){return 1}getContent(){return[this.content]}isCountable(){return!0}copy(){return new pP(this.content)}splice(e){throw ul()}mergeWith(e){return!1}integrate(e,t){}delete(e){}gc(e){}write(e,t){e.writeBuf(this.content)}getRef(){return 3}}class pD{constructor(e){this.len=e}getLength(){return this.len}getContent(){return[]}isCountable(){return!1}copy(){return new pD(this.len)}splice(e){let t=new pD(this.len-e);return this.len=e,t}mergeWith(e){return this.len+=e.len,!0}integrate(e,t){dI(e.deleteSet,t.id.client,t.id.clock,this.len),t.markDeleted()}delete(e){}gc(e){}write(e,t){e.writeLen(this.len-t)}getRef(){return 1}}let pB=(e,t)=>new dB({guid:e,...t,shouldLoad:t.shouldLoad||t.autoLoad||!1});class pF{constructor(e){e._item&&console.error("This document was already integrated as a sub-document. You should create a second instance instead with the same guid."),this.doc=e;let t={};this.opts=t,e.gc||(t.gc=!1),e.autoLoad&&(t.autoLoad=!0),null!==e.meta&&(t.meta=e.meta)}getLength(){return 1}getContent(){return[this.doc]}isCountable(){return!0}copy(){return new pF(pB(this.doc.guid,this.opts))}splice(e){throw ul()}mergeWith(e){return!1}integrate(e,t){this.doc._item=t,e.subdocsAdded.add(this.doc),this.doc.shouldLoad&&e.subdocsLoaded.add(this.doc)}delete(e){e.subdocsAdded.has(this.doc)?e.subdocsAdded.delete(this.doc):e.subdocsRemoved.add(this.doc)}gc(e){}write(e,t){e.writeString(this.doc.guid),e.writeAny(this.opts)}getRef(){return 9}}class pj{constructor(e){this.embed=e}getLength(){return 1}getContent(){return[this.embed]}isCountable(){return!0}copy(){return new pj(this.embed)}splice(e){throw ul()}mergeWith(e){return!1}integrate(e,t){}delete(e){}gc(e){}write(e,t){e.writeJSON(this.embed)}getRef(){return 5}}class p${constructor(e,t){this.key=e,this.value=t}getLength(){return 1}getContent(){return[]}isCountable(){return!1}copy(){return new p$(this.key,this.value)}splice(e){throw ul()}mergeWith(e){return!1}integrate(e,t){let r=t.parent;r._searchMarker=null,r._hasFormatting=!0}delete(e){}gc(e){}write(e,t){e.writeKey(this.key),e.writeJSON(this.value)}getRef(){return 6}}class pG{constructor(e){this.arr=e}getLength(){return this.arr.length}getContent(){return this.arr}isCountable(){return!0}copy(){return new pG(this.arr)}splice(e){let t=new pG(this.arr.slice(e));return this.arr=this.arr.slice(0,e),t}mergeWith(e){return this.arr=this.arr.concat(e.arr),!0}integrate(e,t){}delete(e){}gc(e){}write(e,t){let r=this.arr.length;e.writeLen(r-t);for(let n=t;n<r;n++){let t=this.arr[n];e.writeString(void 0===t?"undefined":JSON.stringify(t))}}getRef(){return 2}}class pK{constructor(e){this.arr=e}getLength(){return this.arr.length}getContent(){return this.arr}isCountable(){return!0}copy(){return new pK(this.arr)}splice(e){let t=new pK(this.arr.slice(e));return this.arr=this.arr.slice(0,e),t}mergeWith(e){return this.arr=this.arr.concat(e.arr),!0}integrate(e,t){}delete(e){}gc(e){}write(e,t){let r=this.arr.length;e.writeLen(r-t);for(let n=t;n<r;n++){let t=this.arr[n];e.writeAny(t)}}getRef(){return 8}}class pW{constructor(e){this.str=e}getLength(){return this.str.length}getContent(){return this.str.split("")}isCountable(){return!0}copy(){return new pW(this.str)}splice(e){let t=new pW(this.str.slice(e));this.str=this.str.slice(0,e);let r=this.str.charCodeAt(e-1);return r>=55296&&r<=56319&&(this.str=this.str.slice(0,e-1)+"",t.str=""+t.str.slice(1)),t}mergeWith(e){return this.str+=e.str,!0}integrate(e,t){}delete(e){}gc(e){}write(e,t){e.writeString(0===t?this.str:this.str.slice(t))}getRef(){return 4}}let pH=[e=>new pl,e=>new pu,e=>new pS,e=>new pN(e.readKey()),e=>new pk,e=>new pI(e.readKey()),e=>new px],pY=0,pV=1,pz=2,pq=3,pJ=4,pX=5,pQ=6;class pZ{constructor(e){this.type=e}getLength(){return 1}getContent(){return[this.type]}isCountable(){return!0}copy(){return new pZ(this.type._copy())}splice(e){throw ul()}mergeWith(e){return!1}integrate(e,t){this.type._integrate(e.doc,t)}delete(e){let t=this.type._start;for(;null!==t;)t.deleted?t.id.clock<(e.beforeState.get(t.id.client)||0)&&e._mergeStructs.push(t):t.delete(e),t=t.right;this.type._map.forEach(t=>{t.deleted?t.id.clock<(e.beforeState.get(t.id.client)||0)&&e._mergeStructs.push(t):t.delete(e)}),e.changed.delete(this.type)}gc(e){let t=this.type._start;for(;null!==t;)t.gc(e,!0),t=t.right;this.type._start=null,this.type._map.forEach(t=>{for(;null!==t;)t.gc(e,!0),t=t.left}),this.type._map=new Map}write(e,t){this.type._write(e)}getRef(){return 7}}let p0=(e,t,r)=>{let{client:n,clock:i}=t.id,o=new p1(fa(n,i+r),t,fa(n,i+r-1),t.right,t.rightOrigin,t.parent,t.parentSub,t.content.splice(r));return t.deleted&&o.markDeleted(),t.keep&&(o.keep=!0),null!==t.redone&&(o.redone=fa(t.redone.client,t.redone.clock+r)),t.right=o,null!==o.right&&(o.right.left=o),e._mergeStructs.push(o),null!==o.parentSub&&null===o.right&&o.parent._map.set(o.parentSub,o),t.length=r,o};class p1 extends pM{constructor(e,t,r,n,i,o,s,a){super(e,a.getLength()),this.origin=r,this.left=t,this.right=n,this.rightOrigin=i,this.parent=o,this.parentSub=s,this.redone=null,this.content=a,this.info=this.content.isCountable()?2:0}set marker(e){(8&this.info)>0!==e&&(this.info^=8)}get marker(){return(8&this.info)>0}get keep(){return(1&this.info)>0}set keep(e){this.keep!==e&&(this.info^=1)}get countable(){return(2&this.info)>0}get deleted(){return(4&this.info)>0}set deleted(e){this.deleted!==e&&(this.info^=4)}markDeleted(){this.info|=4}getMissing(e,t){if(this.origin&&this.origin.client!==this.id.client&&this.origin.clock>=ff(t,this.origin.client))return this.origin.client;if(this.rightOrigin&&this.rightOrigin.client!==this.id.client&&this.rightOrigin.clock>=ff(t,this.rightOrigin.client))return this.rightOrigin.client;if(this.parent&&this.parent.constructor===fo&&this.id.client!==this.parent.client&&this.parent.clock>=ff(t,this.parent.client))return this.parent.client;if(this.origin&&(this.left=f_(e,t,this.origin),this.origin=this.left.lastId),this.rightOrigin&&(this.right=fy(e,this.rightOrigin),this.rightOrigin=this.right.id),this.left&&this.left.constructor===pU||this.right&&this.right.constructor===pU)this.parent=null;else if(this.parent){if(this.parent.constructor===fo){let e=fm(t,this.parent);e.constructor===pU?this.parent=null:this.parent=e.content.type}}else this.left&&this.left.constructor===p1&&(this.parent=this.left.parent,this.parentSub=this.left.parentSub),this.right&&this.right.constructor===p1&&(this.parent=this.right.parent,this.parentSub=this.right.parentSub);return null}integrate(e,t){if(t>0&&(this.id.clock+=t,this.left=f_(e,e.doc.store,fa(this.id.client,this.id.clock-1)),this.origin=this.left.lastId,this.content=this.content.splice(t),this.length-=t),this.parent){if(!this.left&&(!this.right||null!==this.right.left)||this.left&&this.left.right!==this.right){let t,r=this.left;if(null!==r)t=r.right;else if(null!==this.parentSub)for(t=this.parent._map.get(this.parentSub)||null;null!==t&&null!==t.left;)t=t.left;else t=this.parent._start;let n=new Set,i=new Set;for(;null!==t&&t!==this.right;){if(i.add(t),n.add(t),fs(this.origin,t.origin)){if(t.id.client<this.id.client)r=t,n.clear();else if(fs(this.rightOrigin,t.rightOrigin))break}else if(null!==t.origin&&i.has(fm(e.doc.store,t.origin)))n.has(fm(e.doc.store,t.origin))||(r=t,n.clear());else break;t=t.right}this.left=r}if(null!==this.left){let e=this.left.right;this.right=e,this.left.right=this}else{let e;if(null!==this.parentSub)for(e=this.parent._map.get(this.parentSub)||null;null!==e&&null!==e.left;)e=e.left;else e=this.parent._start,this.parent._start=this;this.right=e}null!==this.right?this.right.left=this:null!==this.parentSub&&(this.parent._map.set(this.parentSub,this),null!==this.left&&this.left.delete(e)),null===this.parentSub&&this.countable&&!this.deleted&&(this.parent._length+=this.length),fp(e.doc.store,this),this.content.integrate(e,this),fR(e,this.parent,this.parentSub),(null!==this.parent._item&&this.parent._item.deleted||null!==this.parentSub&&null!==this.right)&&this.delete(e)}else new pU(this.id,this.length).integrate(e,0)}get next(){let e=this.right;for(;null!==e&&e.deleted;)e=e.right;return e}get prev(){let e=this.left;for(;null!==e&&e.deleted;)e=e.left;return e}get lastId(){return 1===this.length?this.id:fa(this.id.client,this.id.clock+this.length-1)}mergeWith(e){if(this.constructor===e.constructor&&fs(e.origin,this.lastId)&&this.right===e&&fs(this.rightOrigin,e.rightOrigin)&&this.id.client===e.id.client&&this.id.clock+this.length===e.id.clock&&this.deleted===e.deleted&&null===this.redone&&null===e.redone&&this.content.constructor===e.content.constructor&&this.content.mergeWith(e.content)){let t=this.parent._searchMarker;return t&&t.forEach(t=>{t.p===e&&(t.p=this,!this.deleted&&this.countable&&(t.index-=this.length))}),e.keep&&(this.keep=!0),this.right=e.right,null!==this.right&&(this.right.left=this),this.length+=e.length,!0}return!1}delete(e){if(!this.deleted){let t=this.parent;this.countable&&null===this.parentSub&&(t._length-=this.length),this.markDeleted(),dI(e.deleteSet,this.id.client,this.id.clock,this.length),fR(e,t,this.parentSub),this.content.delete(e)}}gc(e,t){if(!this.deleted)throw uc();this.content.gc(e),t?fT(e,this,new pU(this.id,this.length)):this.content=new pD(this.length)}write(e,t){let r=t>0?fa(this.id.client,this.id.clock+t-1):this.origin,n=this.rightOrigin,i=this.parentSub,o=31&this.content.getRef()|(null===r?0:128)|(null===n?0:64)|(null===i?0:32);if(e.writeInfo(o),null!==r&&e.writeLeftID(r),null!==n&&e.writeRightID(n),null===r&&null===n){let t=this.parent;if(void 0!==t._item){let r=t._item;if(null===r){let r=fl(t);e.writeParentInfo(!0),e.writeString(r)}else e.writeParentInfo(!1),e.writeLeftID(r.id)}else t.constructor===String?(e.writeParentInfo(!0),e.writeString(t)):t.constructor===fo?(e.writeParentInfo(!1),e.writeLeftID(t)):uc();null!==i&&e.writeString(i)}this.content.write(e,t)}}let p2=(e,t)=>p6[31&t](e),p6=[()=>{uc()},e=>new pD(e.readLen()),e=>{let t=e.readLen(),r=[];for(let n=0;n<t;n++){let t=e.readString();"undefined"===t?r.push(void 0):r.push(JSON.parse(t))}return new pG(r)},e=>new pP(e.readBuf()),e=>new pW(e.readString()),e=>new pj(e.readJSON()),e=>new p$(e.readKey(),e.readJSON()),e=>new pZ(pH[e.readTypeRef()](e)),e=>{let t=e.readLen(),r=[];for(let n=0;n<t;n++)r.push(e.readAny());return new pK(r)},e=>new pF(pB(e.readString(),e.readAny())),()=>{uc()}];class p8 extends pM{get deleted(){return!0}delete(){}mergeWith(e){return this.constructor===e.constructor&&(this.length+=e.length,!0)}integrate(e,t){uc()}write(e,t){e.writeInfo(10),um(e.restEncoder,this.length-t)}getMissing(e,t){return null}}let p3="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:void 0!==en?en:{},p5="__ $YJS$ __";!0===p3[p5]&&console.error("Yjs was already imported. This breaks constructor checks and will lead to issues! - https://github.com/yjs/yjs/issues/438"),p3[p5]=!0;let p4=(e,t)=>{um(e,0),uv(e,d9(t))},p7=(e,t,r)=>{um(e,1),uv(e,d6(t,r))},p9=(e,t,r)=>p7(t,r,uG(e)),ge=(e,t,r)=>{try{d0(t,uG(e),r)}catch(e){console.error("Caught error while handling a Yjs update",e)}},gt=(e,t)=>{um(e,2),uv(e,t)},gr=(e,t,r,n)=>{let i=uW(e);switch(i){case 0:p9(e,t,r);break;case 1:case 2:ge(e,r,n);break;default:throw Error("Unknown message type")}return i},gn={},gi={},go={},gs={},ga=em("shared",["second"],e=>{switch(e.target){case"second":Object.keys(go).forEach(e=>{let t=gs[e];void 0===t?ga.emit("shared:join",e):t<10?gs[e]=t+1:delete gs[e]}),Object.keys(gi).forEach(e=>{ga.emit("shared:active",e)});break;case"join":{let t=e.data,r=gn[t];if(r&&gi[t]){ga.reply(e,"joinack",t);let n=uh();p4(n,r),ga.reply(e,"sync",gc(t,n));let i=uh();p7(i,r),ga.reply(e,"sync",gc(t,i))}break}case"joinack":{let t=e.data;gn[t]&&go[t]&&(gs[t]=0);break}case"active":{let t=e.data;gn[t]&&go[t]&&(gs[t]=0);break}case"sync":{let[t,r,n]=e.data,i=gn[r];if(i&&t!==ga.id()){let e=uF(n),t=uh();if(0===gr(e,t,i,ga)){let e=gc(r,t);ga.emit("shared:sync",e)}}}}});function gl(e){return(function(e){let t=gn[e];if(t)return t;function r(t){let r=uh();gt(r,t),ga.emit("shared:sync",gc(e,r))}return gn[e]=t=new dB({guid:e}),t.on("update",r),t.on("destroy",()=>{t?.off("update",r)}),t})(e).getMap()}function gc(e,t){let r=uf(t);return[ga.id()??"",e,r]}function gu(e,t){let r=e.get(t);return r?.toJSON?r.toJSON():r}function gh(e,t,r){"string"==typeof r?e.set(t,new pS(r)):e.set(t,r)}let gd={};function gf(e,t){return e.player=t,e.layers=[],e.layout=[],e.layoutreset=!0,e.layoutfocus="scroll",e}function gp(e){e.text=[],Object.values(gd[e.id]??{}).forEach(e=>e?.()),gd[e.id]={}}function gg(e){let t=e.layout.find(t=>t.name===e.layoutfocus);if(!t){let t={id:ep(),name:e.layoutfocus,edge:P.RIGHT,size:20,text:[]};return e.layout.push(t),e.layoutreset=!1,t}return t}let gm={},gE=new Set(["hk","hotkey","rn","range","sl","select","nm","number","tx","text"]),gy=new Set(["rn","range","sl","select","nm","number","tx","text"]),g_=new Set(["tx","text"]),gT={rn:1,range:1,sl:0,select:0,nm:0,number:0,tx:"",text:""};function gA(e){let t=gm[e];return eK(t)?t:gm[e]=t=gf({},e)}function gv(e,t,r,n,i){let o=gA(e.id()),s=i||ei(cJ).capital(t),a=o.layout.find(e=>e.name===s);if(a)o.layoutreset=!0,o.layoutfocus=s,eH(n)&&(a.size=n);else switch(r){case P.START:gf(o,e.id());break;case P.LEFT:case P.RIGHT:case P.TOP:case P.BOTTOM:case P.SCROLL:let l={id:ep(),name:s,edge:r,size:n??ev[r],text:[]};o.layout.push(l),o.layoutfocus=s}}let gb=cz({get:()=>[!1,void 0],set:(e,t,r)=>(Object.values(gd).forEach(n=>{void 0!==n[t]&&function(e,t,r){let n=gl(e),i=gu(n,t);(void 0===i||r!==i)&&gh(n,t,r)}(e.id(),t,r)}),[!1,void 0]),tick(e){let t=lH(e.id()),r=t.target?.name??t.target?.kind??"Scroll";gv(e,"scroll",P.SCROLL,void 0,r)},tock(e){!function(e){let t=gA(e.id());t.layout=t.layout.filter(e=>e.edge!==P.SCROLL||e.text.length>0)}(e)}}).command("bg",(e,t)=>{let r=lH(e.id()),[n]=cs({...r,chip:e,words:t},0,[z.COLOR]);return eK(r.target)&&(r.target.bg=n),0}).command("color",(e,t)=>{let r=lH(e.id()),[n]=cs({...r,chip:e,words:t},0,[z.COLOR]);return eK(r.target)&&(r.target.color=n),0}).command("gadget",(e,t)=>{let r={...lH(e.id()),chip:e,words:t},[n]=cs(r,0,[z.STRING]),i=eA[n.toLowerCase()];if(i===P.SCROLL){let[,t,o]=cs(r,0,[z.STRING,z.MAYBE_STRING,z.MAYBE_NUMBER]);gv(e,n,i,o,t)}else{let[,t,o]=cs(r,0,[z.STRING,z.MAYBE_NUMBER,z.MAYBE_STRING]);gv(e,n,i,t,o)}return 0}).command("book",(e,t)=>{let[r,n]=cs({...lH(e.id()),chip:e,words:t},0,[z.STRING,z.STRING]),i=r.toLowerCase(),o=n.toLowerCase();return"create"===o?lW(lv(i,[lT("@board title",{board:lx(e=>e)}),lT("@terrain dirt",{terrain:{char:176,bg:W.BLACK,color:W.DKYELLOW,collision:Y.WALK}}),lT("@terrain dirt2",{terrain:{char:176,bg:W.BLACK,color:W.DKGRAY,collision:Y.WALK}}),lT("@terrain wall",{terrain:{char:177,bg:W.DKGREEN,color:W.GREEN,collision:Y.SOLID}}),lT("@terrain wall2",{terrain:{char:176,bg:W.DKGREEN,color:W.GREEN,collision:Y.SOLID}})])):console.info("book",{ltarget:i,laction:o}),0}).command("frame",(e,t)=>{let r=lH(e.id()),[n,i,o]=cs({...r,chip:e,words:t},0,[z.STRING,z.MAYBE_STRING,z.MAYBE_STRING]),s=r.board?.id??"",a=n.toLowerCase();if("reset"===a)l$(s);else if(eW(i)&&eW(o)){let e=i.toLowerCase();switch(e){case"edit":!function(e,t,r){let n=lG(e);eK(n)&&n.push(function(e,t){let r=lB(1);return r.book=e,r.board=t,r}(t,r))}(s,a,o);break;case"view":!function(e,t,r){let n=lG(e);eK(n)&&n.push(lF(t,r))}(s,a,o);break;default:console.info("frame",{ltype:e,ltarget:a,maybeboard:o})}}return 0}),gR=new Set(["cycle","player","sender","inputmove","inputalt","inputctrl","inputshift","inputok","inputcancel","inputmenu","data"]),gw=new Set(["inputmove","inputalt","inputctrl","inputshift","inputok","inputcancel","inputmenu"]),gO=["NORTH","SOUTH","WEST","EAST"],gS={zzt:cz({get(e,t){let r=function(e){let t=lX[e];if(eW(t))return t;let r=l1[e];if(eW(r))return r;let n=l8[e];if(eW(n))return n;let i=l9[e];if(eW(i))return i}(t);if(eW(r))return[!0,r];let n=lH(e.id());if(n.target){gw.has(t)&&function(e){let t=lH(e.id??"");if(void 0!==t.inputcurrent)return;let[r=D.NONE]=t.inputqueue;void 0===e.stats&&(e.stats={}),e.stats.inputmove=[],e.stats.inputok=0,e.stats.inputcancel=0,e.stats.inputmenu=0;let n=t.inputmods[r];switch(e.stats.inputalt=1&n?1:0,e.stats.inputctrl=16&n?1:0,e.stats.inputshift=256&n?1:0,r){case D.MOVE_UP:case D.MOVE_DOWN:case D.MOVE_LEFT:case D.MOVE_RIGHT:e.stats.inputmove=[gO[r-D.MOVE_UP]];break;case D.OK_BUTTON:e.stats.inputok=1;break;case D.CANCEL_BUTTON:e.stats.inputcancel=1;break;case D.MENU_BUTTON:e.stats.inputmenu=1}t.inputcurrent=r,t.inputqueue.delete(r)}(n.target);let e=n.target.stats?.[t];if(eW(e)||gR.has(t))return[!0,e]}let i=n.board?lD(n.board,n.target):void 0,o=function(e,t,r){let n=lN(e,t);return n?.[r]}(n.book,i?.id??"",t);return[eW(o),o]},set(e,t,r){let n=lH(e.id());if(eW(n.target)&&(eW(n.target?.stats?.[t])||gR.has(t)))return n.target.stats||(n.target.stats={}),n.target.stats[t]=r,[!0,r];let i=n.board?lD(n.board,n.target):void 0;return!function(e,t,r,n){let i=lN(e,t);i&&(i[r]=n)}(n.book,i?.id??"",t,r),[!0,r]},tick(){},tock(){}}).command("become",(e,t)=>(console.info(t),0)).command("bind",(e,t)=>(console.info(t),0)).command("change",(e,t)=>(console.info(t),0)).command("char",(e,t)=>{let r=lH(e.id()),[n]=cs({...r,chip:e,words:t},0,[z.NUMBER]);return eW(r.target)&&(r.target.char=n),0}).command("clear",(e,t)=>{let r=cV(t[0]);return e.set(r,void 0),0}).command("cycle",(e,t)=>{let[r]=cs({...lH(e.id()),chip:e,words:t},0,[z.NUMBER]);return e.cycle(eR(Math.round(r),1,255)),0}).command("die",e=>(e.endofprogram(),0)).command("end",e=>(e.endofprogram(),0)).command("endgame",e=>(e.set("health",0),0)).command("give",(e,t)=>{let[r,n,i]=cs({...lH(e.id()),chip:e,words:t},0,[z.STRING,z.MAYBE_NUMBER]),o=e.get(r),s=eH(o)?o:0,a=n??1;if(!eH(a))return 0;let l=void 0===o?1:0;return l&&i<t.length&&e.command(...t.slice(i)),e.set(r,s+a),l}).command("go",(e,t)=>{let r=lH(e.id()),n=r.target?.x,i=r.target?.y,o=0,s=1,[a,l]=ci({...r,chip:e,words:t},0);for(eH(a)&&(o=l,s=eR(Math.round(a),1,1024));s>0;){let[n]=cs({...r,chip:e,words:t},o,[z.DIR]);if(function(e,t,r,n){let i=function(e,t){if(e)return e.objects[t]}(t,r?.id??"");if(!eK(e)||!eK(t)||!eK(i)||!eK(t.lookup)||n.x<0||n.x>=t.width||n.y<0||n.y>=t.height)return!1;let o=n.x+n.y*t.width,s=lO(e,i),a=i.collision??s?.collision??Y.WALK;if(eK(t.lookup[o]))return!1;let l=t.terrain[o];if(eK(l)){let t=lL(e,l);if(function(e,t){switch(e){case Y.WALK:return t!==Y.WALK;case Y.SWIM:return t!==Y.SWIM;case Y.SOLID:return!0;case Y.BULLET:return t!==Y.WALK&&t!==Y.SWIM}}(a,l.collision??t?.collision??Y.WALK))return!1}return t.lookup[o]=void 0,i.x=n.x,i.y=n.y,t.lookup[i.x+i.y*t.width]=i.id??"",!0}(r.book,r.board,r.target,n))--s;else break}return r.target?.x===n&&r.target?.y===i?1:0}).command("idle",e=>(e.yield(),0)).command("lock",e=>(e.lock(e.id()),0)).command("play",(e,t)=>(console.info(t),0)).command("put",(e,t)=>{let r=lH(e.id()),[n,i]=cs({...r,chip:e,words:t},0,[z.DIR,z.KIND]);if("edit"===n.frame){let e=lG(r.board?.id??"").find(e=>e.type===K.EDIT),t=lK(e?.book??"")??r.book,o=lk(t,e?.board??"");!function(e,t,r,n){var i,o;if(!e||!t)return;let[s,a]=n;eW(lS(e,s))&&(i=r.x,o=r.y,!eW(t)||i<0||i>=t.width||o<0||o>=t.height||(t.terrain[i+o*t.width]={kind:s}));let l=lw(e,n[0]);eW(l)&&eW(l.name)&&(r.x,r.y,console.info({kind:l}))}(t,o,n,i)}return 0}).command("restore",(e,t)=>(e.restore(cV(t[0])),0)).command("send",(e,t)=>{let[r,n]=cs({...lH(e.id()),chip:e,words:t},0,[z.STRING,z.ANY]);return e.send(r,n),0}).command("set",(e,t)=>{let[r,n]=cs({...lH(e.id()),chip:e,words:t},0,[z.STRING,z.ANY]);return e.set(r,n),0}).command("shoot",(e,t)=>{let[r,n]=cs({...lH(e.id()),chip:e,words:t},0,[z.DIR,z.MAYBE_KIND]);return 0}).command("take",(e,t)=>{let[r,n,i]=cs({...lH(e.id()),chip:e,words:t},0,[z.STRING,z.MAYBE_NUMBER]),o=e.get(r);if(!eH(o))return 1;let s=o-(n??1);return s<0?(i<t.length&&e.command(...t.slice(i)),1):(e.set(r,s),0)}).command("throwstar",(e,t)=>{let[r,n]=cs({...lH(e.id()),chip:e,words:t},0,[z.DIR,z.MAYBE_KIND]);return 0}).command("try",(e,t)=>{let[,r]=cs({...lH(e.id()),chip:e,words:t},0,[z.DIR]);return e.command("go",...t.slice(0,r))&&r<t.length&&e.command(...t.slice(r)),e.yield(),0}).command("unlock",e=>(e.unlock(),0)).command("walk",(e,t)=>0).command("zap",(e,t)=>(e.zap(cV(t[0])),0)).command("stat",(e,t)=>{let r=lH(e.id());return r.target&&(r.target.name=t.map(cV).join(" ")),0}).command("text",(e,t)=>(!function(e,t){let r=gA(e.id()),n=gg(r);r.layoutreset&&(r.layoutreset=!1,gp(n)),n.text.push(t)}(e,t.map(cV).join("")),0)).command("hyperlink",(e,t)=>{let[r,n,...i]=t;return!function(e,t,r,n){let i=gA(e.id()),o=gg(i);i.layoutreset&&(i.layoutreset=!1,gp(o));let s=r.toLowerCase(),a=[e.id(),t,...gE.has(s)?[s]:["hypertext",r],...n],l=a[2];if(gy.has(l)){let t=`${a[3]??""}`;gd[o.id]=gd[o.id]??{};let r=e.get(t);void 0===gd[o.id][t]&&(function(e,t,r){console.info({guid:e,key:t,value:r}),gi[e]=!0;let n=gl(e);void 0===n.get(t)&&void 0!==r&&gh(n,t,r)}(e.id(),t,r??gT[l]),g_.has(l)?gd[o.id][t]=function(e,t,r){let n=gl(e),i=n.get(t);function o(){r(i)}function s(e){e.keysChanged.has(t)&&void 0===i&&a(),i&&n.unobserve(s)}function a(){(i=n.get(t))?(i.observeDeep(o),o()):n.observe(s)}return a(),()=>{i?i.unobserveDeep(o):n.unobserve(s)}}(e.id(),t,r=>{if(void 0!==r){let n=r.toJSON();n!==e.get(t)&&e.set(t,n)}}):gd[o.id][t]=function(e,t,r){let n=gl(e);function i(e){e.keysChanged.has(t)&&r(gu(n,t))}return r(gu(n,t)),n.observe(i),()=>{n.unobserve(i)}}(e.id(),t,r=>{void 0!==r&&r!==e.get(t)&&e.set(t,r)}))}o.text.push(a)}(e,cV(r),cV(n),i),0}),zss:gb,media:cq},gL=Object.getPrototypeOf(function*(){}).constructor,gk=ef(eE.numbers,4),gN=ef(`${eE.numbers}${eE.lowercase}`,16),gC=`pid_${gk()}_${gN()}`;lj.defaultplayer=gC;let gI=function(){let e={},t={};return{ids:()=>Object.keys(t),has:e=>eK(t[e]),halt(e){let r=t[e];return r&&delete t[e],!!r},tick(r,n){let i=t[r];if(!eK(t[r])){var o;let s=function(t){let r=e[t];if(r)return r;let n=function(e){var t;let r=function(e){let t=l_(`${e}
`);if(t.errors.length>0)return{errors:t.errors,tokens:[]};cS.input=t.tokens;let r=cS.program();if(cS.errors.length>0)return{tokens:t.tokens,errors:cS.errors};let n=cx.visit(r);return n?(!function e(t){if(!t||void 0===t.type)return;let r=[{start:t.startOffset,end:t.endOffset||0}];return Object.keys(t).forEach(n=>{if("parent"!==n){let i=t[n];Array.isArray(i)?i.forEach(t=>{r.push(e(t))}):r.push(e(i))}}),t.range={start:Math.min(...r.filter(e=>e).map(e=>e?.start||0)),end:Math.max(...r.filter(e=>e).map(e=>e?.end||0))},t.range}(n),{tokens:t.tokens,cst:r,ast:n}):{tokens:t.tokens,cst:r,errors:["no ast output"]}}(e);if(r.errors&&r.errors.length>0)return r;if(!r.ast)return{...r,errors:["no ast output"]};let n=(t=r.ast,cM.internal=0,cM.labels={restart:[1]},cM.labelIndex=2,{...cY(t).toStringWithSourceMap({file:`${cB}.map`}),...cM});if(n.code){aC&&console.info(n.code);try{return{...r,...n,source:n.code,code:new gL("api",n.code)}}catch(e){return{errors:[{message:e.message}],source:"there was an error",code:new gL("api"," ")}}}return{...r,...n,source:"there was an error",code:new gL("api"," ")}}(t);return e[t]=n,n}(n);if(s.errors?.length)return console.error(s.errors),console.info(s.tokens),t[r]=null,!1;o=i=t[r]=function(e,t){let r,n;let i=eN(t.labels??{}),o="",s=0,a={},l={},c={},u=!1,h=3,d=0,f=!1,p=[],g={};function m(e){if(void 0===g[e])for(let t=0;t<p.length;++t){let r=p[t].getcommand(e);r&&(g[e]=r)}return g[e]}function E(e,t){let r=m(e);if(!r)throw Error(`unknown firmware command ${e}`);return r(y,t)}let y={id:()=>e,install(e){g={},p.push(e)},set(e,t){let r=e.toLowerCase();for(let e=0;e<p.length;++e){let[n]=p[e].set(y,r,t);if(n)break}return t},get(e){let t=e.toLowerCase();for(let e=0;e<p.length;++e){let[r,n]=p[e].get(y,t);if(r)return n}},cycle(e){h=e},tick(){if(!y.shouldtick())return!1;let e=d%h==0;if(++d,!e)return!1;s=0,u=!1;for(let e=0;e<p.length;++e)p[e].tick(y);try{let e=r?.next();e?.done&&(console.error("we crashed?",t.source),f=!0)}catch(e){console.error("we crashed?",e),f=!0}for(let e=0;e<p.length;++e)p[e].tock(y);return!0},shouldtick:()=>!1===f||0!==y.hm(),shouldhalt:()=>s++>64,hm(){let e=n?.target??"";return i[e]?.find(e=>e>0)??0},yield(){u=!0},sy:()=>u||y.shouldhalt(),send(t,r){let n=`vm:${e}:${t}`;eu.emit(n,e,r)},lock(e){o=e},unlock(){o=""},message(e){o&&e.sender!==o||(n=e)},zap(e){let t=i[e];if(t){let e=t.findIndex(e=>e>0);e>=0&&(t[e]*=-1)}},restore(e){let t=i[e];if(t)for(let e=0;e<t.length;e++)t[e]=Math.abs(t[e])},getcase(){if(n){let e=y.hm();return y.set("sender",n.sender),y.set("data",n.data),n.player&&y.set("player",n.player),n=void 0,u=!1,f=!1,e}return 0},endofprogram(){y.yield(),f=!0},stacktrace(e){let[t]=ei(cl).parse(e).filter(e=>e.fileName===cB);return{line:t?.lineNumber??0,column:t?.columnNumber??0}},text:e=>E("text",[e]),stat:(...e)=>E("stat",e),hyperlink:(...e)=>E("hyperlink",e),move(e,...t){let r=y.command("go",...t);return y.yield(),r&&e?1:0},command(...e){if(0===e.length)return 0;let[t,...r]=e,n=m(cV(t));return n?n(y,r):E("send",[t,...r])},if(...e){let[t,r]=cs(cn(y,e),0,[z.ANY]),n=Array.isArray(t)?t.length>0?1:0:t??0;return n&&r<e.length&&y.command(...e.slice(r)),n},repeatStart(e,...t){let[r,n]=cs(cn(y,t),0,[z.NUMBER]);a[e]=r,l[e]=n<t.length?t.slice(n):void 0},repeat(e){let t=a[e]??0;a[e]=t-1;let r=t>0,n=l[e];return r&&n&&y.command(...n),r},readStart(e,t){if(!eY(t))return;let r=y.get(t)??[];c[e]=Array.isArray(r)?r:[r]},read(e,...t){let r=c[e];if(!1===Array.isArray(r))return!1;let n=r.shift();if(void 0===n)return!1;let i=t.map(cV);switch(typeof n){case"number":case"string":i.forEach(e=>{y.set(e,n)});break;case"object":i.forEach(e=>{let t=n[e];y.set(e,t)})}return!0},or(...e){let t=cn(y,e),r=0;for(let n=0;n<e.length;){let[e,i]=cs(t,0,[z.ANY]);if(r=e)break;n=i}return r},and(...e){let t=cn(y,e),r=0;for(let n=0;n<e.length;){let[e,i]=cs(t,0,[z.ANY]);if(!(r=e))break;n=i}return r},not(...e){let[t]=cs(cn(y,e),0,[z.ANY]);return t?0:1},expr(...e){let[t]=cs(cn(y,e),0,[z.ANY]);return t},isEq(e,t){let[r]=cs(cn(y,[e]),0,[z.ANY]),[n]=cs(cn(y,[t]),0,[z.ANY]);return 0===eG(r,n).length?1:0},isNotEq(e,t){let[r]=cs(cn(y,[e]),0,[z.ANY]),[n]=cs(cn(y,[t]),0,[z.ANY]);return r!==n?1:0},isLessThan(e,t){let[r]=cs(cn(y,[e]),0,[z.NUMBER]),[n]=cs(cn(y,[t]),0,[z.NUMBER]);return r<n?1:0},isGreaterThan(e,t){let[r]=cs(cn(y,[e]),0,[z.NUMBER]),[n]=cs(cn(y,[t]),0,[z.NUMBER]);return r>n?1:0},isLessThanOrEq(e,t){let[r]=cs(cn(y,[e]),0,[z.NUMBER]),[n]=cs(cn(y,[t]),0,[z.NUMBER]);return r<=n?1:0},isGreaterThanOrEq(e,t){let[r]=cs(cn(y,[e]),0,[z.NUMBER]),[n]=cs(cn(y,[t]),0,[z.NUMBER]);return r>=n?1:0},opPlus(e,t){let[r]=cs(cn(y,[e]),0,[z.ANY]),[n]=cs(cn(y,[t]),0,[z.ANY]);return r+n},opMinus(e,t){let[r]=cs(cn(y,[e]),0,[z.ANY]),[n]=cs(cn(y,[t]),0,[z.ANY]);return r-n},opPower(e,t){let[r]=cs(cn(y,[e]),0,[z.NUMBER]),[n]=cs(cn(y,[t]),0,[z.NUMBER]);return Math.pow(r,n)},opMultiply(e,t){let[r]=cs(cn(y,[e]),0,[z.NUMBER]),[n]=cs(cn(y,[t]),0,[z.NUMBER]);return r*n},opDivide(e,t){let[r]=cs(cn(y,[e]),0,[z.NUMBER]),[n]=cs(cn(y,[t]),0,[z.NUMBER]);return r/n},opModDivide(e,t){let[r]=cs(cn(y,[e]),0,[z.NUMBER]),[n]=cs(cn(y,[t]),0,[z.NUMBER]);return r%n},opFloorDivide(e,t){let[r]=cs(cn(y,[e]),0,[z.NUMBER]),[n]=cs(cn(y,[t]),0,[z.NUMBER]);return Math.floor(r/n)},opUniPlus(e){let[t]=cs(cn(y,[e]),0,[z.NUMBER]);return+t},opUniMinus(e){let[t]=cs(cn(y,[e]),0,[z.NUMBER]);return-t}};return r=t.code?.(y),y}(r,s),Object.values(gS).forEach(e=>{o.install(e)})}return!!i?.tick()},message(e){let{target:r,path:n}=eg(e.target),i=t[r];eW(i)&&i.message({...e,target:n})}}}(),gx={},gM=em("vm",["login","tick","tock"],e=>{switch(e.target){case"login":e.player&&(gx[e.player]=0,function(e){let t=lK(ca.name),r=lk(t,lV),n=lw(t,lY);if(eK(r)&&eK(n)){let n=lM(r,{id:e,x:0,y:0,kind:lY,stats:{player:e}});eK(n?.id)&&eK(t)&&eK(lk(t,lV))&&(t.players[e]=lV)}}(e.player));break;case"tick":!function(e){var t;function r(t,r,n,i,o){let s=lH(i);s.book=t,s.board=r,s.target=n,s.inputcurrent=void 0,e.tick(i,o)}let n=lK(ca.name);(t=Object.values(n?.players??[]),[...new Set(t)].filter(eK)).map(e=>lk(n,e)).filter(eK).forEach(e=>(function(e,t,r){if(!eK(e)||!eK(t))return;!function(e,t){let r=Array(t.width*t.height).fill(void 0),n={},i=Object.values(t.objects);for(let o=0;o<i.length;++o){let s=i[o];if(eK(s.x)&&eK(s.y)&&eK(s.id)){let i=lO(e,s);s.category=V.OBJECT,r[s.x+s.y*t.width]=s.id;let o=(s.name??i?.name??"object").toLowerCase();n[o]||(n[o]=new Set),n[o].add(s.id)}}let o=0,s=0;for(let r=0;r<t.terrain.length;++r){let i=t.terrain[r];if(eK(i)){let t=lO(e,i);i.x=o,i.y=s,i.category=V.TERRAIN;let a=(i.name??t?.name??"terrain").toLowerCase();n[a]||(n[a]=new Set),n[a].add(r)}++o>=t.width&&(o=0,++s)}t.lookup=(e4.add(r),r),t.named=(e4.add(n),n)}(e,t);let n=Object.values(t.objects);for(let i=0;i<n.length;++i){let o=n[i];if(!eK(o.id))return;o.lx=o.x,o.ly=o.y;let s=lO(e,o),a=o.code??s?.code??"";if(!a)return;r(e,t,o,o.id,a)}})(n,e,r))}(gI);break;case"tock":Object.keys(gx).forEach(e=>{++gx[e],gx[e]>480&&(delete gx[e],lj.books.forEach(t=>{var r;return!!(eK(r=lC(t,e))&&eK(r.objects[e]))&&(delete r.objects[e],!0)}))});break;case"doot":e.player&&(gx[e.player]=0);break;case"input":if(e.player){let t=lH(e.player),[r=D.NONE,n=0]=e.data??{};t.inputqueue.add(r),t.inputmods[r]=n}default:gI.message(e)}}),gU=Math.round(25),gP=em("clock",[],()=>{}),gD=0,gB=performance.now(),gF=0;!function e(){let t=performance.now();(gD+=t-gB)>=40&&(gD%=40,gP.emit("tick"),gP.emit("tock"),++gF>=gU&&(gF%=gU,gP.emit("second"))),gB=t,setTimeout(e)}();let gj={},g$=em("gadgetserver",["tock"],e=>{switch(e.target){case"tock":Object.keys(gm).forEach(e=>{let t=gA(e);t.layers=function(e){let t=lK(ca.name),r=lC(t,e),n=[];if(!eK(t)||!eK(r))return n;let i=0;return lG(r.id??"").toSorted((e,t)=>lz(e)-lz(t)).forEach(o=>{let s=lK(o.book??"")??t,a=lk(s,o.board??"")??r;if(eW(s)&&eW(a)){let t=function(e,t,r,n,i){var o;let s=[],a=t,l=0===a,c=n.width??0,u=n.height??0,h=l?W.BLACK:W.CLEAR,d=function(e,t,r,n,i=0){let o=r*n;return{id:`tiles:${e}:${t}`,type:1,width:r,height:n,char:eT(o,0),color:eT(o,0),bg:eT(o,i)}}(e,a++,c,u,h);s.push(d);let f=function(e,t,r,n,i=0){return{id:`dither:${e}:${t}`,type:3,width:r,height:n,alphas:eT(r*n,i)}}(e,a++,c,u);s.push(f);let p=a++,g={id:`sprites:${e}:${p}`,type:2,sprites:[]};s.push(g);let m=(o=a++,{id:`control:${e}:${o}`,type:5,focusx:0,focusy:0,focusid:e,viewscale:2});return i&&s.push(m),n.terrain.forEach((e,t)=>{if(e){let n=lL(r,e);d.char[t]=e.char??n?.char??0,d.color[t]=e.color??n?.color??h,d.bg[t]=e.bg??n?.bg??h}}),Object.values(n.objects??{}).forEach(t=>{let n=t.id??"",i=lO(r,t),o=function(e,t,r,n=1,i=15){return{id:`sprites:${e}:${t}:${r}`,x:0,y:0,char:n,color:i,bg:32}}(e,p,n),s=t.lx??t.x??0,a=t.ly??t.y??0;o.x=t.x??0,o.y=t.y??0,o.char=t.char??i?.char??1,o.color=t.color??i?.color??W.WHITE,o.bg=t.bg??i?.bg??W.CLEAR,g.sprites.push(o),o.bg===W.SHADOW&&(f.alphas[s+a*c]=.5),n===e&&(m.focusx=o.x,m.focusy=o.y,m.focusid=n)}),s}(e,i,s,a,o.type===K.VIEW);i+=t.length,n.push(...t)}}),n}(e);let r=eG(gj[e]??{},t);r.length&&(gj[e]=eN(t),g$.emit("gadgetclient:patch",r,e))});break;case"desync":if(e.player){let t=gA(e.player);g$.emit("gadgetclient:reset",t,e.player)}break;case"clearscroll":e.player&&function(e){let t=gA(e);t.layout=t.layout.filter(e=>e.edge!==P.SCROLL)}(e.player)}}),gG=function(e){let t=new Set;return em("forward",["all"],r=>{t.has(r.id)||(t.add(r.id),e(r))}),function(e){t.has(e.id)||(t.add(e.id),eu.invoke(e))}}(e=>postMessage(e));onmessage=function(e){gG(e.data)},queueMicrotask(function(){lW(ca),gM.emit("ready",void 0,gC)})})();
//# sourceMappingURL=instance.bf092dee.js.map
