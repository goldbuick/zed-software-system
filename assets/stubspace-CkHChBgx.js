(function(){"use strict";const R=new Set,A={emit(e,r,t,n,s){A.invoke(Me(e,r,t,n,s))},invoke(e){switch(e.target){}R.forEach(r=>r.handle(e))},connect(e){R.add(e)},disconnect(e){R.delete(e)}};var P=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},le={exports:{}};(function(e,r){(function(t,n){e.exports=n()})(P,function(){return t.importState=function(s){var i=new t;return i.importState(s),i},t;function t(){return function(s){var i=0,o=0,u=0,c=1;s.length==0&&(s=[+new Date]);var a=n();i=a(" "),o=a(" "),u=a(" ");for(var l=0;l<s.length;l++)i-=a(s[l]),i<0&&(i+=1),o-=a(s[l]),o<0&&(o+=1),u-=a(s[l]),u<0&&(u+=1);a=null;var f=function(){var d=2091639*i+c*23283064365386963e-26;return i=o,o=u,u=d-(c=d|0)};return f.next=f,f.uint32=function(){return f()*4294967296},f.fract53=function(){return f()+(f()*2097152|0)*11102230246251565e-32},f.version="Alea 0.9",f.args=s,f.exportState=function(){return[i,o,u,c]},f.importState=function(d){i=+d[0]||0,o=+d[1]||0,u=+d[2]||0,c=+d[3]||0},f}(Array.prototype.slice.call(arguments))}function n(){var s=4022871197,i=function(o){o=o.toString();for(var u=0;u<o.length;u++){s+=o.charCodeAt(u);var c=.02519603282416938*s;s=c>>>0,c-=s,c*=s,s=c>>>0,c-=s,s+=c*4294967296}return(s>>>0)*23283064365386963e-26};return i.version="Mash 0.9",i}})})(le);var ue={};(function(e){var r=P&&P.__spreadArray||function(a,l,f){if(f||arguments.length===2)for(var d=0,h=l.length,v;d<h;d++)(v||!(d in l))&&(v||(v=Array.prototype.slice.call(l,0,d)),v[d]=l[d]);return a.concat(v||Array.prototype.slice.call(l))};Object.defineProperty(e,"__esModule",{value:!0}),e.minLength=e.maxLength=e.poolSize=e.humanId=e.adverbs=e.verbs=e.nouns=e.adjectives=void 0,e.adjectives=["afraid","all","angry","beige","big","better","bitter","blue","brave","breezy","bright","brown","bumpy","busy","calm","chatty","chilly","chubby","clean","clear","clever","cold","crazy","cruel","cuddly","curly","curvy","cute","common","cold","cool","cyan","dark","deep","dirty","dry","dull","eager","early","easy","eight","eighty","eleven","empty","every","evil","fair","famous","fast","fancy","few","fine","fifty","five","flat","fluffy","floppy","forty","four","free","fresh","fruity","full","funny","fuzzy","gentle","giant","gold","good","great","green","grumpy","happy","heavy","hip","honest","hot","huge","hungry","icy","itchy","khaki","kind","large","late","lazy","lemon","legal","light","little","long","loose","loud","lovely","lucky","major","many","mean","metal","mighty","modern","moody","nasty","neat","new","nice","nine","ninety","odd","old","olive","open","orange","pink","plain","plenty","polite","poor","pretty","proud","public","puny","petite","purple","quick","quiet","rare","real","ready","red","rich","ripe","rotten","rude","sad","salty","seven","shaggy","shaky","sharp","shiny","short","shy","silent","silly","silver","six","sixty","slick","slimy","slow","small","smart","smooth","social","soft","solid","some","sour","spicy","spotty","stale","strong","stupid","sweet","swift","tall","tame","tangy","tasty","ten","tender","thick","thin","thirty","three","tidy","tiny","tired","tough","tricky","true","twelve","twenty","two","upset","vast","violet","warm","weak","wet","whole","wicked","wide","wild","wise","witty","yellow","young","yummy"],e.nouns=["apes","animals","areas","bars","banks","baths","breads","bushes","cloths","clowns","clubs","hoops","loops","memes","papers","parks","paths","showers","sides","signs","sites","streets","teeth","tires","webs","actors","ads","adults","aliens","ants","apples","baboons","badgers","bags","bananas","bats","beans","bears","beds","beers","bees","berries","bikes","birds","boats","bobcats","books","bottles","boxes","brooms","buckets","bugs","buses","buttons","camels","cases","cameras","candies","candles","carpets","carrots","carrots","cars","cats","chairs","chefs","chicken","clocks","clouds","coats","cobras","coins","corners","colts","comics","cooks","cougars","regions","results","cows","crabs","crabs","crews","cups","cities","cycles","dancers","days","deer","dingos","dodos","dogs","dolls","donkeys","donuts","doodles","doors","dots","dragons","drinks","dryers","ducks","ducks","eagles","ears","eels","eggs","ends","mammals","emus","experts","eyes","facts","falcons","fans","feet","files","flies","flowers","forks","foxes","friends","frogs","games","garlics","geckos","geese","ghosts","ghosts","gifts","glasses","goats","grapes","groups","guests","hairs","hands","hats","heads","hornets","horses","hotels","hounds","houses","humans","icons","ideas","impalas","insects","islands","items","jars","jeans","jobs","jokes","keys","kids","kings","kiwis","knives","lamps","lands","laws","lemons","lies","lights","lines","lions","lizards","llamas","mails","mangos","maps","masks","meals","melons","mice","mirrors","moments","moles","monkeys","months","moons","moose","mugs","nails","needles","news","nights","numbers","olives","onions","oranges","otters","owls","pandas","pans","pants","papayas","parents","parts","parrots","paws","peaches","pears","peas","pens","pets","phones","pianos","pigs","pillows","places","planes","planets","plants","plums","poems","poets","points","pots","pugs","pumas","queens","rabbits","radios","rats","ravens","readers","rice","rings","rivers","rockets","rocks","rooms","roses","rules","schools","bats","seals","seas","sheep","shirts","shoes","shrimps","singers","sloths","snails","snakes","socks","spiders","spies","spoons","squids","stars","states","steaks","wings","suits","suns","swans","symbols","tables","taxes","taxis","teams","terms","things","ties","tigers","times","tips","toes","towns","tools","toys","trains","trams","trees","turkeys","turtles","vans","views","walls","walls","wasps","waves","ways","weeks","windows","wolves","women","wombats","words","worlds","worms","yaks","years","zebras","zoos"],e.verbs=["accept","act","add","admire","agree","allow","appear","argue","arrive","ask","attack","attend","bake","bathe","battle","beam","beg","begin","behave","bet","boil","bow","brake","brush","build","burn","buy","call","camp","care","carry","change","cheat","check","cheer","chew","clap","clean","cough","count","cover","crash","create","cross","cry","cut","dance","decide","deny","design","dig","divide","do","double","doubt","draw","dream","dress","drive","drop","drum","eat","end","enter","enjoy","exist","fail","fall","feel","fetch","film","find","fix","flash","float","flow","fly","fold","follow","fry","give","glow","go","grab","greet","grin","grow","guess","hammer","hang","happen","heal","hear","help","hide","hope","hug","hunt","invent","invite","itch","jam","jog","join","joke","judge","juggle","jump","kick","kiss","kneel","knock","know","laugh","lay","lead","learn","leave","lick","like","lie","listen","live","look","lose","love","make","march","marry","mate","matter","melt","mix","move","nail","notice","obey","occur","open","own","pay","peel","play","poke","post","press","prove","pull","pump","pick","punch","push","raise","read","refuse","relate","relax","remain","repair","repeat","reply","report","rescue","rest","retire","return","rhyme","ring","roll","rule","run","rush","say","scream","see","search","sell","send","serve","shake","share","shave","shine","show","shop","shout","sin","sink","sing","sip","sit","sleep","slide","smash","smell","smile","smoke","sneeze","sniff","sort","speak","spend","stand","start","stay","stick","stop","stare","study","strive","swim","switch","take","talk","tan","tap","taste","teach","tease","tell","thank","think","throw","tickle","tie","trade","train","travel","try","turn","type","unite","vanish","visit","wait","walk","warn","wash","watch","wave","wear","win","wink","wish","wonder","work","worry","write","yawn","yell"],e.adverbs=["bravely","brightly","busily","daily","freely","hungrily","joyously","knowlingly","lazily","oddly","mysteriously","noisily","politely","quickly","quietly","rapidly","safely","sleepily","slowly","truly","yearly"];function t(a){return a[Math.floor(Math.random()*a.length)]}function n(a){return a.reduce(function(l,f){return l.length>f.length?l:f})}function s(a){return a.reduce(function(l,f){return l.length<f.length?l:f})}function i(a){a===void 0&&(a={}),typeof a=="string"&&(a={separator:a}),typeof a=="boolean"&&(a={capitalize:a});var l=a.separator,f=l===void 0?"":l,d=a.capitalize,h=d===void 0?!0:d,v=a.adjectiveCount,w=v===void 0?1:v,oe=a.addAdverb,Ge=oe===void 0?!1:oe,G=r(r(r([],r([],Array(w),!0).map(function(Y){return t(e.adjectives)}),!0),[t(e.nouns),t(e.verbs)],!1),Ge?[t(e.adverbs)]:[],!0);return h&&(G=G.map(function(Y){return Y.charAt(0).toUpperCase()+Y.substr(1)})),G.join(f)}e.humanId=i;function o(a){a===void 0&&(a={});var l=a.adjectiveCount,f=l===void 0?1:l,d=a.addAdverb,h=d===void 0?!1:d;return e.adjectives.length*f*e.nouns.length*e.verbs.length*(h?e.adverbs.length:1)}e.poolSize=o;function u(a){a===void 0&&(a={});var l=a.adjectiveCount,f=l===void 0?1:l,d=a.addAdverb,h=d===void 0?!1:d,v=a.separator,w=v===void 0?"":v;return n(e.adjectives).length*f+f*w.length+n(e.nouns).length+w.length+n(e.verbs).length+(h?n(e.adverbs).length+w.length:0)}e.maxLength=u;function c(a){a===void 0&&(a={});var l=a.adjectiveCount,f=l===void 0?1:l,d=a.addAdverb,h=d===void 0?!1:d,v=a.separator,w=v===void 0?"":v;return s(e.adjectives).length*f+f*w.length+s(e.nouns).length+w.length+s(e.verbs).length+(h?s(e.adverbs).length+w.length:0)}e.minLength=c,e.default=i})(ue);const fe="useandom-26T198340PX75pxJACKVERYMINDBUSHWOLF_GQZbfghjklqvwyzrict";let ce=e=>crypto.getRandomValues(new Uint8Array(e)),de=(e,r,t)=>{let n=(2<<Math.log2(e.length-1))-1,s=-~(1.6*n*r/e.length);return(i=r)=>{let o="";for(;;){let u=t(s),c=s;for(;c--;)if(o+=e[u[c]&n]||"",o.length===i)return o}}},W=(e,r=21)=>de(e,r,ce),he=(e=21)=>{let r="",t=crypto.getRandomValues(new Uint8Array(e));for(;e--;)r+=fe[t[e]&63];return r};var X="abcdefghijklmnopqrstuvwxyz",Z="ABCDEFGHIJKLMNOPQRSTUVWXYZ",V="0123456789",pe="346789ABCDEFGHJKLMNPQRTUVWXYabcdefghijkmnpqrtwxyz",ve="6789BCDFGHJKLMNPQRTWbcdfghjkmnpqrtwz";const ye=V,we=X,ge=Z;var me=ye+we+ge,I={lowercase:X,uppercase:Z,numbers:V,nolookalikes:pe,nolookalikesSafe:ve,alphanumeric:me};function L(){return`sid_${he(12).replaceAll("-",".")}`}W(I.numbers,4),W(`${I.numbers}${I.lowercase}`,16);/*!
 * https://github.com/Starcounter-Jack/JSON-Patch
 * (c) 2017-2022 Joachim Wester
 * MIT licensed
 */var _e=function(){var e=function(r,t){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,s){n.__proto__=s}||function(n,s){for(var i in s)s.hasOwnProperty(i)&&(n[i]=s[i])},e(r,t)};return function(r,t){e(r,t);function n(){this.constructor=r}r.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),Ae=Object.prototype.hasOwnProperty;function D(e,r){return Ae.call(e,r)}function S(e){if(Array.isArray(e)){for(var r=new Array(e.length),t=0;t<r.length;t++)r[t]=""+t;return r}if(Object.keys)return Object.keys(e);var n=[];for(var s in e)D(e,s)&&n.push(s);return n}function y(e){switch(typeof e){case"object":return JSON.parse(JSON.stringify(e));case"undefined":return null;default:return e}}function j(e){for(var r=0,t=e.length,n;r<t;){if(n=e.charCodeAt(r),n>=48&&n<=57){r++;continue}return!1}return!0}function g(e){return e.indexOf("/")===-1&&e.indexOf("~")===-1?e:e.replace(/~/g,"~0").replace(/\//g,"~1")}function x(e){return e.replace(/~1/g,"/").replace(/~0/g,"~")}function C(e){if(e===void 0)return!0;if(e){if(Array.isArray(e)){for(var r=0,t=e.length;r<t;r++)if(C(e[r]))return!0}else if(typeof e=="object"){for(var n=S(e),s=n.length,i=0;i<s;i++)if(C(e[n[i]]))return!0}}return!1}function ee(e,r){var t=[e];for(var n in r){var s=typeof r[n]=="object"?JSON.stringify(r[n],null,2):r[n];typeof s<"u"&&t.push(n+": "+s)}return t.join(`
`)}var re=function(e){_e(r,e);function r(t,n,s,i,o){var u=this.constructor,c=e.call(this,ee(t,{name:n,index:s,operation:i,tree:o}))||this;return c.name=n,c.index=s,c.operation=i,c.tree=o,Object.setPrototypeOf(c,u.prototype),c.message=ee(t,{name:n,index:s,operation:i,tree:o}),c}return r}(Error),p=re,be=y,_={add:function(e,r,t){return e[r]=this.value,{newDocument:t}},remove:function(e,r,t){var n=e[r];return delete e[r],{newDocument:t,removed:n}},replace:function(e,r,t){var n=e[r];return e[r]=this.value,{newDocument:t,removed:n}},move:function(e,r,t){var n=O(t,this.path);n&&(n=y(n));var s=m(t,{op:"remove",path:this.from}).removed;return m(t,{op:"add",path:this.path,value:s}),{newDocument:t,removed:n}},copy:function(e,r,t){var n=O(t,this.from);return m(t,{op:"add",path:this.path,value:y(n)}),{newDocument:t}},test:function(e,r,t){return{newDocument:t,test:b(e[r],this.value)}},_get:function(e,r,t){return this.value=e[r],{newDocument:t}}},Oe={add:function(e,r,t){return j(r)?e.splice(r,0,this.value):e[r]=this.value,{newDocument:t,index:r}},remove:function(e,r,t){var n=e.splice(r,1);return{newDocument:t,removed:n[0]}},replace:function(e,r,t){var n=e[r];return e[r]=this.value,{newDocument:t,removed:n}},move:_.move,copy:_.copy,test:_.test,_get:_._get};function O(e,r){if(r=="")return e;var t={op:"_get",path:r};return m(e,t),t.value}function m(e,r,t,n,s,i){if(t===void 0&&(t=!1),n===void 0&&(n=!0),s===void 0&&(s=!0),i===void 0&&(i=0),t&&(typeof t=="function"?t(r,0,e,r.path):E(r,0)),r.path===""){var o={newDocument:e};if(r.op==="add")return o.newDocument=r.value,o;if(r.op==="replace")return o.newDocument=r.value,o.removed=e,o;if(r.op==="move"||r.op==="copy")return o.newDocument=O(e,r.from),r.op==="move"&&(o.removed=e),o;if(r.op==="test"){if(o.test=b(e,r.value),o.test===!1)throw new p("Test operation failed","TEST_OPERATION_FAILED",i,r,e);return o.newDocument=e,o}else{if(r.op==="remove")return o.removed=e,o.newDocument=null,o;if(r.op==="_get")return r.value=e,o;if(t)throw new p("Operation `op` property is not one of operations defined in RFC-6902","OPERATION_OP_INVALID",i,r,e);return o}}else{n||(e=y(e));var u=r.path||"",c=u.split("/"),a=e,l=1,f=c.length,d=void 0,h=void 0,v=void 0;for(typeof t=="function"?v=t:v=E;;){if(h=c[l],h&&h.indexOf("~")!=-1&&(h=x(h)),s&&(h=="__proto__"||h=="prototype"&&l>0&&c[l-1]=="constructor"))throw new TypeError("JSON-Patch: modifying `__proto__` or `constructor/prototype` prop is banned for security reasons, if this was on purpose, please set `banPrototypeModifications` flag false and pass it to this function. More info in fast-json-patch README");if(t&&d===void 0&&(a[h]===void 0?d=c.slice(0,l).join("/"):l==f-1&&(d=r.path),d!==void 0&&v(r,0,e,d)),l++,Array.isArray(a)){if(h==="-")h=a.length;else{if(t&&!j(h))throw new p("Expected an unsigned base-10 integer value, making the new referenced value the array element with the zero-based index","OPERATION_PATH_ILLEGAL_ARRAY_INDEX",i,r,e);j(h)&&(h=~~h)}if(l>=f){if(t&&r.op==="add"&&h>a.length)throw new p("The specified index MUST NOT be greater than the number of elements in the array","OPERATION_VALUE_OUT_OF_BOUNDS",i,r,e);var o=Oe[r.op].call(r,a,h,e);if(o.test===!1)throw new p("Test operation failed","TEST_OPERATION_FAILED",i,r,e);return o}}else if(l>=f){var o=_[r.op].call(r,a,h,e);if(o.test===!1)throw new p("Test operation failed","TEST_OPERATION_FAILED",i,r,e);return o}if(a=a[h],t&&l<f&&(!a||typeof a!="object"))throw new p("Cannot perform operation at the desired path","OPERATION_PATH_UNRESOLVABLE",i,r,e)}}}function M(e,r,t,n,s){if(n===void 0&&(n=!0),s===void 0&&(s=!0),t&&!Array.isArray(r))throw new p("Patch sequence must be an array","SEQUENCE_NOT_AN_ARRAY");n||(e=y(e));for(var i=new Array(r.length),o=0,u=r.length;o<u;o++)i[o]=m(e,r[o],t,!0,s,o),e=i[o].newDocument;return i.newDocument=e,i}function Ee(e,r,t){var n=m(e,r);if(n.test===!1)throw new p("Test operation failed","TEST_OPERATION_FAILED",t,r,e);return n.newDocument}function E(e,r,t,n){if(typeof e!="object"||e===null||Array.isArray(e))throw new p("Operation is not an object","OPERATION_NOT_AN_OBJECT",r,e,t);if(_[e.op]){if(typeof e.path!="string")throw new p("Operation `path` property is not a string","OPERATION_PATH_INVALID",r,e,t);if(e.path.indexOf("/")!==0&&e.path.length>0)throw new p('Operation `path` property must start with "/"',"OPERATION_PATH_INVALID",r,e,t);if((e.op==="move"||e.op==="copy")&&typeof e.from!="string")throw new p("Operation `from` property is not present (applicable in `move` and `copy` operations)","OPERATION_FROM_REQUIRED",r,e,t);if((e.op==="add"||e.op==="replace"||e.op==="test")&&e.value===void 0)throw new p("Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)","OPERATION_VALUE_REQUIRED",r,e,t);if((e.op==="add"||e.op==="replace"||e.op==="test")&&C(e.value))throw new p("Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)","OPERATION_VALUE_CANNOT_CONTAIN_UNDEFINED",r,e,t);if(t){if(e.op=="add"){var s=e.path.split("/").length,i=n.split("/").length;if(s!==i+1&&s!==i)throw new p("Cannot perform an `add` operation at the desired path","OPERATION_PATH_CANNOT_ADD",r,e,t)}else if(e.op==="replace"||e.op==="remove"||e.op==="_get"){if(e.path!==n)throw new p("Cannot perform the operation at a path that does not exist","OPERATION_PATH_UNRESOLVABLE",r,e,t)}else if(e.op==="move"||e.op==="copy"){var o={op:"_get",path:e.from,value:void 0},u=te([o],t);if(u&&u.name==="OPERATION_PATH_UNRESOLVABLE")throw new p("Cannot perform the operation from a path that does not exist","OPERATION_FROM_UNRESOLVABLE",r,e,t)}}}else throw new p("Operation `op` property is not one of operations defined in RFC-6902","OPERATION_OP_INVALID",r,e,t)}function te(e,r,t){try{if(!Array.isArray(e))throw new p("Patch sequence must be an array","SEQUENCE_NOT_AN_ARRAY");if(r)M(y(r),y(e),t||!0);else{t=t||E;for(var n=0;n<e.length;n++)t(e[n],n,r,void 0)}}catch(s){if(s instanceof p)return s;throw s}}function b(e,r){if(e===r)return!0;if(e&&r&&typeof e=="object"&&typeof r=="object"){var t=Array.isArray(e),n=Array.isArray(r),s,i,o;if(t&&n){if(i=e.length,i!=r.length)return!1;for(s=i;s--!==0;)if(!b(e[s],r[s]))return!1;return!0}if(t!=n)return!1;var u=Object.keys(e);if(i=u.length,i!==Object.keys(r).length)return!1;for(s=i;s--!==0;)if(!r.hasOwnProperty(u[s]))return!1;for(s=i;s--!==0;)if(o=u[s],!b(e[o],r[o]))return!1;return!0}return e!==e&&r!==r}var ke=Object.freeze({__proto__:null,JsonPatchError:p,_areEquals:b,applyOperation:m,applyPatch:M,applyReducer:Ee,deepClone:be,getValueByPointer:O,validate:te,validator:E});/*!
 * https://github.com/Starcounter-Jack/JSON-Patch
 * (c) 2017-2021 Joachim Wester
 * MIT license
 */var U=new WeakMap,Te=function(){function e(r){this.observers=new Map,this.obj=r}return e}(),Ne=function(){function e(r,t){this.callback=r,this.observer=t}return e}();function Re(e){return U.get(e)}function Pe(e,r){return e.observers.get(r)}function Ie(e,r){e.observers.delete(r.callback)}function Le(e,r){r.unobserve()}function De(e,r){var t=[],n,s=Re(e);if(!s)s=new Te(e),U.set(e,s);else{var i=Pe(s,r);n=i&&i.observer}if(n)return n;if(n={},s.value=y(e),r){n.callback=r,n.next=null;var o=function(){z(n)},u=function(){clearTimeout(n.next),n.next=setTimeout(o)};typeof window<"u"&&(window.addEventListener("mouseup",u),window.addEventListener("keyup",u),window.addEventListener("mousedown",u),window.addEventListener("keydown",u),window.addEventListener("change",u))}return n.patches=t,n.object=e,n.unobserve=function(){z(n),clearTimeout(n.next),Ie(s,n),typeof window<"u"&&(window.removeEventListener("mouseup",u),window.removeEventListener("keyup",u),window.removeEventListener("mousedown",u),window.removeEventListener("keydown",u),window.removeEventListener("change",u))},s.observers.set(r,new Ne(r,n)),n}function z(e,r){r===void 0&&(r=!1);var t=U.get(e.object);J(t.value,e.object,e.patches,"",r),e.patches.length&&M(t.value,e.patches);var n=e.patches;return n.length>0&&(e.patches=[],e.callback&&e.callback(n)),n}function J(e,r,t,n,s){if(r!==e){typeof r.toJSON=="function"&&(r=r.toJSON());for(var i=S(r),o=S(e),u=!1,c=o.length-1;c>=0;c--){var a=o[c],l=e[a];if(D(r,a)&&!(r[a]===void 0&&l!==void 0&&Array.isArray(r)===!1)){var f=r[a];typeof l=="object"&&l!=null&&typeof f=="object"&&f!=null&&Array.isArray(l)===Array.isArray(f)?J(l,f,t,n+"/"+g(a),s):l!==f&&(s&&t.push({op:"test",path:n+"/"+g(a),value:y(l)}),t.push({op:"replace",path:n+"/"+g(a),value:y(f)}))}else Array.isArray(e)===Array.isArray(r)?(s&&t.push({op:"test",path:n+"/"+g(a),value:y(l)}),t.push({op:"remove",path:n+"/"+g(a)}),u=!0):(s&&t.push({op:"test",path:n,value:e}),t.push({op:"replace",path:n,value:r}))}if(!(!u&&i.length==o.length))for(var c=0;c<i.length;c++){var a=i[c];!D(e,a)&&r[a]!==void 0&&t.push({op:"add",path:n+"/"+g(a),value:y(r[a])})}}}function Se(e,r,t){t===void 0&&(t=!1);var n=[];return J(e,r,n,"",t),n}var je=Object.freeze({__proto__:null,compare:Se,generate:z,observe:De,unobserve:Le});Object.assign({},ke,je,{JsonPatchError:re,deepClone:y,escapePathComponent:g,unescapePathComponent:x});function k(e){return e!=null}function q(e){return typeof e=="string"}function Ce(e){return e}function B(e){return e.toLowerCase().trim()}function Me(e,r,t,n,s){return{session:e,id:L(),target:r,sender:t,data:n,player:s}}function Ue(e){const[r,...t]=e.split(":");return{target:r,path:t.join(":")}}function F(e,r=[],t=Ce,n=""){const s=L(),i=B(e),o=r.map(B);let u=n;const c={id(){return s},name(){return e},session(a){return k(a)?a.session===u?a.session:"":u},topics(){return r},emit(a,l,f){A.emit(u,a,s,l,f)},reply(a,l,f,d){c.emit(`${a.sender}:${l}`,f,d)},replynext(a,l,f,d){setTimeout(()=>c.emit(`${a.sender}:${l}`,f,d),64)},handle(a){const{target:l,path:f}=Ue(a.target),d=B(l);!u&&d==="ready"&&(u=a.session),d==="bridge"&&k(a.session)&&(u=a.session),o.findIndex(h=>h==="all"||h===d)!==-1&&t(a),(s===l||d==="all"||i===d)&&t({...a,target:f})}};return A.connect(c),c}function ze(e){return k(e)&&typeof e=="object"&&q(e.id)&&q(e.target)&&q(e.sender)}function Je(e){e.emit("ready")}function qe(e,...r){return e.emit("tape:info",r),!0}function Be(e){const r=new Set;function t(i){ze(i)&&i.target!=="tick"&&i.target!=="tock"&&r.has(i.id)===!1&&(r.add(i.id),A.invoke(i))}const n=F("forward",["all"],i=>{r.has(i.id)||(r.add(i.id),e(i))});function s(){A.disconnect(n)}return{forward:t,disconnect:s}}function Fe(e,r){qe(e,r)}let ne="";const He=L(),T=F("vm",[],e=>{if(T.session(e))switch(e.target){case"operator":k(e.player)&&(ne=e.player,Fe(T,`operator set to ${ne}`),T.reply(e,"ackoperator",!0,e.player));break}},He);function $e(){Je(T)}const H=66.666,se=Math.round(1e3/H);function Ke(){return location.href.includes("/locked/")}const $=F("clock");let K=0,N=0,Q=0,ae=performance.now();function ie(){const e=performance.now(),r=e-ae,t=Ke()?"locked":"";Q+=r,Q>=H&&(Q%=H,$.emit("tick",N,t),$.emit("tock",N,t),++K,++N,K>=se&&(K%=se,$.emit("second",N,t))),ae=e,setTimeout(ie,2)}ie();const{forward:Qe}=Be(e=>postMessage(e));onmessage=function(r){Qe(r.data)},setTimeout($e,100)})();
