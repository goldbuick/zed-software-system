var qM=Object.defineProperty;var XM=(ar,Ue,Bt)=>Ue in ar?qM(ar,Ue,{enumerable:!0,configurable:!0,writable:!0,value:Bt}):ar[Ue]=Bt;var ye=(ar,Ue,Bt)=>XM(ar,typeof Ue!="symbol"?Ue+"":Ue,Bt);(function(){"use strict";const ar=new Set,Ue={emit(e,t,n,r){Ue.invoke(fb(e,t,n,r))},invoke(e){ar.forEach(t=>t.handle(e))},connect(e){ar.add(e)},disconnect(e){ar.delete(e)}};var Bt=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Pi(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function X_(e){if(e.__esModule)return e;var t=e.default;if(typeof t=="function"){var n=function r(){return this instanceof r?Reflect.construct(t,arguments,this.constructor):t.apply(this,arguments)};n.prototype=t.prototype}else n={};return Object.defineProperty(n,"__esModule",{value:!0}),Object.keys(e).forEach(function(r){var i=Object.getOwnPropertyDescriptor(e,r);Object.defineProperty(n,r,i.get?i:{enumerable:!0,get:function(){return e[r]}})}),n}var nh={};(function(e){var t=Bt&&Bt.__spreadArray||function(l,u,f){if(f||arguments.length===2)for(var d=0,h=u.length,p;d<h;d++)(p||!(d in u))&&(p||(p=Array.prototype.slice.call(u,0,d)),p[d]=u[d]);return l.concat(p||Array.prototype.slice.call(u))};Object.defineProperty(e,"__esModule",{value:!0}),e.minLength=e.maxLength=e.poolSize=e.humanId=e.adverbs=e.verbs=e.nouns=e.adjectives=void 0,e.adjectives=["afraid","all","angry","beige","big","better","bitter","blue","brave","breezy","bright","brown","bumpy","busy","calm","chatty","chilly","chubby","clean","clear","clever","cold","crazy","cruel","cuddly","curly","curvy","cute","common","cold","cool","cyan","dark","deep","dirty","dry","dull","eager","early","easy","eight","eighty","eleven","empty","every","evil","fair","famous","fast","fancy","few","fine","fifty","five","flat","fluffy","floppy","forty","four","free","fresh","fruity","full","funny","fuzzy","gentle","giant","gold","good","great","green","grumpy","happy","heavy","hip","honest","hot","huge","hungry","icy","itchy","khaki","kind","large","late","lazy","lemon","legal","light","little","long","loose","loud","lovely","lucky","major","many","mean","metal","mighty","modern","moody","nasty","neat","new","nice","nine","ninety","odd","old","olive","open","orange","pink","plain","plenty","polite","poor","pretty","proud","public","puny","petite","purple","quick","quiet","rare","real","ready","red","rich","ripe","rotten","rude","sad","salty","seven","shaggy","shaky","sharp","shiny","short","shy","silent","silly","silver","six","sixty","slick","slimy","slow","small","smart","smooth","social","soft","solid","some","sour","spicy","spotty","stale","strong","stupid","sweet","swift","tall","tame","tangy","tasty","ten","tender","thick","thin","thirty","three","tidy","tiny","tired","tough","tricky","true","twelve","twenty","two","upset","vast","violet","warm","weak","wet","whole","wicked","wide","wild","wise","witty","yellow","young","yummy"],e.nouns=["apes","animals","areas","bars","banks","baths","breads","bushes","cloths","clowns","clubs","hoops","loops","memes","papers","parks","paths","showers","sides","signs","sites","streets","teeth","tires","webs","actors","ads","adults","aliens","ants","apples","baboons","badgers","bags","bananas","bats","beans","bears","beds","beers","bees","berries","bikes","birds","boats","bobcats","books","bottles","boxes","brooms","buckets","bugs","buses","buttons","camels","cases","cameras","candies","candles","carpets","carrots","carrots","cars","cats","chairs","chefs","chicken","clocks","clouds","coats","cobras","coins","corners","colts","comics","cooks","cougars","regions","results","cows","crabs","crabs","crews","cups","cities","cycles","dancers","days","deer","dingos","dodos","dogs","dolls","donkeys","donuts","doodles","doors","dots","dragons","drinks","dryers","ducks","ducks","eagles","ears","eels","eggs","ends","mammals","emus","experts","eyes","facts","falcons","fans","feet","files","flies","flowers","forks","foxes","friends","frogs","games","garlics","geckos","geese","ghosts","ghosts","gifts","glasses","goats","grapes","groups","guests","hairs","hands","hats","heads","hornets","horses","hotels","hounds","houses","humans","icons","ideas","impalas","insects","islands","items","jars","jeans","jobs","jokes","keys","kids","kings","kiwis","knives","lamps","lands","laws","lemons","lies","lights","lines","lions","lizards","llamas","mails","mangos","maps","masks","meals","melons","mice","mirrors","moments","moles","monkeys","months","moons","moose","mugs","nails","needles","news","nights","numbers","olives","onions","oranges","otters","owls","pandas","pans","pants","papayas","parents","parts","parrots","paws","peaches","pears","peas","pens","pets","phones","pianos","pigs","pillows","places","planes","planets","plants","plums","poems","poets","points","pots","pugs","pumas","queens","rabbits","radios","rats","ravens","readers","rice","rings","rivers","rockets","rocks","rooms","roses","rules","schools","bats","seals","seas","sheep","shirts","shoes","shrimps","singers","sloths","snails","snakes","socks","spiders","spies","spoons","squids","stars","states","steaks","wings","suits","suns","swans","symbols","tables","taxes","taxis","teams","terms","things","ties","tigers","times","tips","toes","towns","tools","toys","trains","trams","trees","turkeys","turtles","vans","views","walls","walls","wasps","waves","ways","weeks","windows","wolves","women","wombats","words","worlds","worms","yaks","years","zebras","zoos"],e.verbs=["accept","act","add","admire","agree","allow","appear","argue","arrive","ask","attack","attend","bake","bathe","battle","beam","beg","begin","behave","bet","boil","bow","brake","brush","build","burn","buy","call","camp","care","carry","change","cheat","check","cheer","chew","clap","clean","cough","count","cover","crash","create","cross","cry","cut","dance","decide","deny","design","dig","divide","do","double","doubt","draw","dream","dress","drive","drop","drum","eat","end","enter","enjoy","exist","fail","fall","feel","fetch","film","find","fix","flash","float","flow","fly","fold","follow","fry","give","glow","go","grab","greet","grin","grow","guess","hammer","hang","happen","heal","hear","help","hide","hope","hug","hunt","invent","invite","itch","jam","jog","join","joke","judge","juggle","jump","kick","kiss","kneel","knock","know","laugh","lay","lead","learn","leave","lick","like","lie","listen","live","look","lose","love","make","march","marry","mate","matter","melt","mix","move","nail","notice","obey","occur","open","own","pay","peel","play","poke","post","press","prove","pull","pump","pick","punch","push","raise","read","refuse","relate","relax","remain","repair","repeat","reply","report","rescue","rest","retire","return","rhyme","ring","roll","rule","run","rush","say","scream","see","search","sell","send","serve","shake","share","shave","shine","show","shop","shout","sin","sink","sing","sip","sit","sleep","slide","smash","smell","smile","smoke","sneeze","sniff","sort","speak","spend","stand","start","stay","stick","stop","stare","study","strive","swim","switch","take","talk","tan","tap","taste","teach","tease","tell","thank","think","throw","tickle","tie","trade","train","travel","try","turn","type","unite","vanish","visit","wait","walk","warn","wash","watch","wave","wear","win","wink","wish","wonder","work","worry","write","yawn","yell"],e.adverbs=["bravely","brightly","busily","daily","freely","hungrily","joyously","knowlingly","lazily","oddly","mysteriously","noisily","politely","quickly","quietly","rapidly","safely","sleepily","slowly","truly","yearly"];function n(l){return l[Math.floor(Math.random()*l.length)]}function r(l){return l.reduce(function(u,f){return u.length>f.length?u:f})}function i(l){return l.reduce(function(u,f){return u.length<f.length?u:f})}function s(l){l===void 0&&(l={}),typeof l=="string"&&(l={separator:l}),typeof l=="boolean"&&(l={capitalize:l});var u=l.separator,f=u===void 0?"":u,d=l.capitalize,h=d===void 0?!0:d,p=l.adjectiveCount,m=p===void 0?1:p,b=l.addAdverb,_=b===void 0?!1:b,w=t(t(t([],t([],Array(m),!0).map(function(v){return n(e.adjectives)}),!0),[n(e.nouns),n(e.verbs)],!1),_?[n(e.adverbs)]:[],!0);return h&&(w=w.map(function(v){return v.charAt(0).toUpperCase()+v.substr(1)})),w.join(f)}e.humanId=s;function o(l){l===void 0&&(l={});var u=l.adjectiveCount,f=u===void 0?1:u,d=l.addAdverb,h=d===void 0?!1:d;return e.adjectives.length*f*e.nouns.length*e.verbs.length*(h?e.adverbs.length:1)}e.poolSize=o;function a(l){l===void 0&&(l={});var u=l.adjectiveCount,f=u===void 0?1:u,d=l.addAdverb,h=d===void 0?!1:d,p=l.separator,m=p===void 0?"":p;return r(e.adjectives).length*f+f*m.length+r(e.nouns).length+m.length+r(e.verbs).length+(h?r(e.adverbs).length+m.length:0)}e.maxLength=a;function c(l){l===void 0&&(l={});var u=l.adjectiveCount,f=u===void 0?1:u,d=l.addAdverb,h=d===void 0?!1:d,p=l.separator,m=p===void 0?"":p;return i(e.adjectives).length*f+f*m.length+i(e.nouns).length+m.length+i(e.verbs).length+(h?i(e.adverbs).length+m.length:0)}e.minLength=c,e.default=s})(nh);var J_=Pi(nh);const Z_="useandom-26T198340PX75pxJACKVERYMINDBUSHWOLF_GQZbfghjklqvwyzrict";let Y_=e=>crypto.getRandomValues(new Uint8Array(e)),Q_=(e,t,n)=>{let r=(2<<Math.log2(e.length-1))-1,i=-~(1.6*r*t/e.length);return(s=t)=>{let o="";for(;;){let a=n(i),c=i;for(;c--;)if(o+=e[a[c]&r]||"",o.length===s)return o}}},rh=(e,t=21)=>Q_(e,t,Y_),eb=(e=21)=>{let t="",n=crypto.getRandomValues(new Uint8Array(e));for(;e--;)t+=Z_[n[e]&63];return t};var ih="abcdefghijklmnopqrstuvwxyz",sh="ABCDEFGHIJKLMNOPQRSTUVWXYZ",oh="0123456789",tb="346789ABCDEFGHJKLMNPQRTUVWXYabcdefghijkmnpqrtwxyz",nb="6789BCDFGHJKLMNPQRTWbcdfghjkmnpqrtwz";const rb=oh,ib=ih,sb=sh;var ob=rb+ib+sb,Bc={lowercase:ih,uppercase:sh,numbers:oh,nolookalikes:tb,nolookalikesSafe:nb,alphanumeric:ob};function gt(){return`sid_${eb(12).replaceAll("-",".")}`}const ab=rh(Bc.numbers,4),cb=rh(`${Bc.numbers}${Bc.lowercase}`,16);function lb(){return`pid_${ab()}_${cb()}`}function ah(e){return(e==null?void 0:e.startsWith("pid_"))??!1}function ub(){return J_({capitalize:!1,adjectiveCount:1})}var be=(e=>(e[e.BLACK=0]="BLACK",e[e.DKBLUE=1]="DKBLUE",e[e.DKGREEN=2]="DKGREEN",e[e.DKCYAN=3]="DKCYAN",e[e.DKRED=4]="DKRED",e[e.DKPURPLE=5]="DKPURPLE",e[e.DKYELLOW=6]="DKYELLOW",e[e.LTGRAY=7]="LTGRAY",e[e.DKGRAY=8]="DKGRAY",e[e.BLUE=9]="BLUE",e[e.GREEN=10]="GREEN",e[e.CYAN=11]="CYAN",e[e.RED=12]="RED",e[e.PURPLE=13]="PURPLE",e[e.YELLOW=14]="YELLOW",e[e.WHITE=15]="WHITE",e[e.ONBLACK=16]="ONBLACK",e[e.ONDKBLUE=17]="ONDKBLUE",e[e.ONDKGREEN=18]="ONDKGREEN",e[e.ONDKCYAN=19]="ONDKCYAN",e[e.ONDKRED=20]="ONDKRED",e[e.ONDKPURPLE=21]="ONDKPURPLE",e[e.ONDKYELLOW=22]="ONDKYELLOW",e[e.ONLTGRAY=23]="ONLTGRAY",e[e.ONDKGRAY=24]="ONDKGRAY",e[e.ONBLUE=25]="ONBLUE",e[e.ONGREEN=26]="ONGREEN",e[e.ONCYAN=27]="ONCYAN",e[e.ONRED=28]="ONRED",e[e.ONPURPLE=29]="ONPURPLE",e[e.ONYELLOW=30]="ONYELLOW",e[e.ONWHITE=31]="ONWHITE",e[e.ONCLEAR=32]="ONCLEAR",e[e.ONSHADOW=33]="ONSHADOW",e[e.ONBORROW=34]="ONBORROW",e))(be||{}),ct=(e=>(e[e.ISWALK=0]="ISWALK",e[e.ISSOLID=1]="ISSOLID",e[e.ISSWIM=2]="ISSWIM",e[e.ISBULLET=3]="ISBULLET",e))(ct||{}),Co=(e=>(e[e.ISTERRAIN=0]="ISTERRAIN",e[e.ISOBJECT=1]="ISOBJECT",e))(Co||{}),oe=(e=>(e[e.IDLE=0]="IDLE",e[e.NORTH=1]="NORTH",e[e.SOUTH=2]="SOUTH",e[e.WEST=3]="WEST",e[e.EAST=4]="EAST",e[e.BY=5]="BY",e[e.AT=6]="AT",e[e.FLOW=7]="FLOW",e[e.SEEK=8]="SEEK",e[e.RNDNS=9]="RNDNS",e[e.RNDNE=10]="RNDNE",e[e.RND=11]="RND",e[e.CW=12]="CW",e[e.CCW=13]="CCW",e[e.OPP=14]="OPP",e[e.RNDP=15]="RNDP",e))(oe||{}),fe=(e=>(e[e.LOADER=0]="LOADER",e[e.BOARD=1]="BOARD",e[e.OBJECT=2]="OBJECT",e[e.TERRAIN=3]="TERRAIN",e[e.CHARSET=4]="CHARSET",e[e.PALETTE=5]="PALETTE",e[e.CONST=6]="CONST",e[e.RANGE=7]="RANGE",e[e.SELECT=8]="SELECT",e[e.NUMBER=9]="NUMBER",e[e.TEXT=10]="TEXT",e[e.LINK=11]="LINK",e[e.HOTKEY=12]="HOTKEY",e[e.SCROLL=13]="SCROLL",e[e.COPYIT=14]="COPYIT",e))(fe||{});function Pe(e){return e.toLowerCase().trim()}function fb(e,t,n,r){return{id:gt(),target:e,sender:t,data:n,player:r}}function ch(e){const[t,...n]=e.split(":");return{target:t,path:n.join(":")}}function Lo(e,t,n){const r=gt(),i=Pe(e),s=t.map(Pe),o={id(){return r},name(){return e},topics(){return t},emit(a,c,l){Ue.emit(a,r,c,l)},reply(a,c,l,u){o.emit(`${a.sender}:${c}`,l,u)},handle(a){const{target:c,path:l}=ch(a.target),u=Pe(c);s.findIndex(f=>f==="all"||f===u)!==-1&&n(a),(r===c||u==="all"||i===u)&&n({...a,target:l})}};return Ue.connect(o),o}function hb(e){const t=new Set;function n(r){t.has(r.id)||(t.add(r.id),Ue.invoke(r))}return Lo("forward",["all"],r=>{t.has(r.id)||(t.add(r.id),e(r))}),n}function Mo(e,t){return new Array(e).fill(t)}function lh(e,t,n,r,i=0){const s=n*r;return{id:`tiles:${e}:${t}`,type:1,width:n,height:r,char:Mo(s,0),color:Mo(s,0),bg:Mo(s,i)}}function db(e,t,n,r=1,i=15){return{id:`sprites:${e}:${t}:${n}`,x:0,y:0,char:r,color:i,bg:be.ONCLEAR}}function pb(e,t){return{id:`sprites:${e}:${t}`,type:2,sprites:[]}}function mb(e,t,n,r,i=0){const s=n*r;return{id:`dither:${e}:${t}`,type:3,width:n,height:r,alphas:Mo(s,i)}}function gb(e,t){return{id:`control:${e}:${t}`,type:5,focusx:0,focusy:0,focusid:e,viewscale:2}}var un=(e=>(e[e.START=0]="START",e[e.LEFT=1]="LEFT",e[e.RIGHT=2]="RIGHT",e[e.TOP=3]="TOP",e[e.BOTTOM=4]="BOTTOM",e[e.SCROLL=5]="SCROLL",e))(un||{});const yb={start:0,left:1,right:2,top:3,bottom:4,scroll:5},_b={0:1,1:20,2:20,3:1,4:1,5:40};function uh(e,t){return`${e}:${t}`}const bb=1,wb=16,vb=256;var Ft=(e=>(e[e.NONE=0]="NONE",e[e.ALT=1]="ALT",e[e.CTRL=2]="CTRL",e[e.SHIFT=3]="SHIFT",e[e.MOVE_UP=4]="MOVE_UP",e[e.MOVE_DOWN=5]="MOVE_DOWN",e[e.MOVE_LEFT=6]="MOVE_LEFT",e[e.MOVE_RIGHT=7]="MOVE_RIGHT",e[e.OK_BUTTON=8]="OK_BUTTON",e[e.CANCEL_BUTTON=9]="CANCEL_BUTTON",e[e.MENU_BUTTON=10]="MENU_BUTTON",e[e.SHOOT_UP=11]="SHOOT_UP",e[e.SHOOT_DOWN=12]="SHOOT_DOWN",e[e.SHOOT_LEFT=13]="SHOOT_LEFT",e[e.SHOOT_RIGHT=14]="SHOOT_RIGHT",e))(Ft||{});function Qe(e,t,n,r){const i=r??"";return Ue.emit(`error:${t}`,e,n,i),Cb(e,n,i)}function Eb(e,t,n){Ue.emit("gadgetclient:reset",e,t,n)}function kb(e,t,n){Ue.emit("gadgetclient:patch",e,t,n)}function Sb(e,t,n){Ue.emit("register:flush",e,[t,n])}function Ab(e,t){Ue.emit("register:dev",e,void 0,t)}function Tb(e,t){Ue.emit("register:share",e,void 0,t)}function xb(e){Ue.emit("register:refresh",e)}function Rb(e){Ue.emit("register:nuke",e)}function Ib(e){Ue.emit("register:nodetrash",e)}function Ob(e,t,n){Ue.emit("synth:play",e,[t,n])}function Fc(e,t,n,r){Ue.emit("synth:voice",e,[t,n,r])}function Nb(e,t,n,r,i){Ue.emit("synth:voicefx",e,[t,n,r,i])}function yt(e,...t){return Ue.emit("tape:info",e,t),!0}function fh(e,...t){return Ue.emit("tape:debug",e,t),!0}function Cb(e,...t){return Ue.emit("tape:error",e,t),!1}function Lb(e,t,n,r,i,s){Ue.emit("tape:editor:open",e,[t,n,r,i],s)}function Mb(e,t){Ue.emit("vm:endgame",e,void 0,t)}function hh(e,t){return`${e}${t}`}function ni(e){Ue.emit("vm:flush",e)}function $c(e,t){function n(r){console.error(r),Qe(e,"crash",r.message)}t().catch(n)}/*!
 * https://github.com/Starcounter-Jack/JSON-Patch
 * (c) 2017-2022 Joachim Wester
 * MIT licensed
 */var Ub=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var s in i)i.hasOwnProperty(s)&&(r[s]=i[s])},e(t,n)};return function(t,n){e(t,n);function r(){this.constructor=t}t.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),Pb=Object.prototype.hasOwnProperty;function jc(e,t){return Pb.call(e,t)}function zc(e){if(Array.isArray(e)){for(var t=new Array(e.length),n=0;n<t.length;n++)t[n]=""+n;return t}if(Object.keys)return Object.keys(e);var r=[];for(var i in e)jc(e,i)&&r.push(i);return r}function Kt(e){switch(typeof e){case"object":return JSON.parse(JSON.stringify(e));case"undefined":return null;default:return e}}function Wc(e){for(var t=0,n=e.length,r;t<n;){if(r=e.charCodeAt(t),r>=48&&r<=57){t++;continue}return!1}return!0}function ri(e){return e.indexOf("/")===-1&&e.indexOf("~")===-1?e:e.replace(/~/g,"~0").replace(/\//g,"~1")}function dh(e){return e.replace(/~1/g,"/").replace(/~0/g,"~")}function Gc(e){if(e===void 0)return!0;if(e){if(Array.isArray(e)){for(var t=0,n=e.length;t<n;t++)if(Gc(e[t]))return!0}else if(typeof e=="object"){for(var r=zc(e),i=r.length,s=0;s<i;s++)if(Gc(e[r[s]]))return!0}}return!1}function ph(e,t){var n=[e];for(var r in t){var i=typeof t[r]=="object"?JSON.stringify(t[r],null,2):t[r];typeof i<"u"&&n.push(r+": "+i)}return n.join(`
`)}var mh=function(e){Ub(t,e);function t(n,r,i,s,o){var a=this.constructor,c=e.call(this,ph(n,{name:r,index:i,operation:s,tree:o}))||this;return c.name=r,c.index=i,c.operation=s,c.tree=o,Object.setPrototypeOf(c,a.prototype),c.message=ph(n,{name:r,index:i,operation:s,tree:o}),c}return t}(Error),rt=mh,Db=Kt,Di={add:function(e,t,n){return e[t]=this.value,{newDocument:n}},remove:function(e,t,n){var r=e[t];return delete e[t],{newDocument:n,removed:r}},replace:function(e,t,n){var r=e[t];return e[t]=this.value,{newDocument:n,removed:r}},move:function(e,t,n){var r=Uo(n,this.path);r&&(r=Kt(r));var i=ii(n,{op:"remove",path:this.from}).removed;return ii(n,{op:"add",path:this.path,value:i}),{newDocument:n,removed:r}},copy:function(e,t,n){var r=Uo(n,this.from);return ii(n,{op:"add",path:this.path,value:Kt(r)}),{newDocument:n}},test:function(e,t,n){return{newDocument:n,test:gs(e[t],this.value)}},_get:function(e,t,n){return this.value=e[t],{newDocument:n}}},Bb={add:function(e,t,n){return Wc(t)?e.splice(t,0,this.value):e[t]=this.value,{newDocument:n,index:t}},remove:function(e,t,n){var r=e.splice(t,1);return{newDocument:n,removed:r[0]}},replace:function(e,t,n){var r=e[t];return e[t]=this.value,{newDocument:n,removed:r}},move:Di.move,copy:Di.copy,test:Di.test,_get:Di._get};function Uo(e,t){if(t=="")return e;var n={op:"_get",path:t};return ii(e,n),n.value}function ii(e,t,n,r,i,s){if(n===void 0&&(n=!1),r===void 0&&(r=!0),i===void 0&&(i=!0),s===void 0&&(s=0),n&&(typeof n=="function"?n(t,0,e,t.path):Po(t,0)),t.path===""){var o={newDocument:e};if(t.op==="add")return o.newDocument=t.value,o;if(t.op==="replace")return o.newDocument=t.value,o.removed=e,o;if(t.op==="move"||t.op==="copy")return o.newDocument=Uo(e,t.from),t.op==="move"&&(o.removed=e),o;if(t.op==="test"){if(o.test=gs(e,t.value),o.test===!1)throw new rt("Test operation failed","TEST_OPERATION_FAILED",s,t,e);return o.newDocument=e,o}else{if(t.op==="remove")return o.removed=e,o.newDocument=null,o;if(t.op==="_get")return t.value=e,o;if(n)throw new rt("Operation `op` property is not one of operations defined in RFC-6902","OPERATION_OP_INVALID",s,t,e);return o}}else{r||(e=Kt(e));var a=t.path||"",c=a.split("/"),l=e,u=1,f=c.length,d=void 0,h=void 0,p=void 0;for(typeof n=="function"?p=n:p=Po;;){if(h=c[u],h&&h.indexOf("~")!=-1&&(h=dh(h)),i&&(h=="__proto__"||h=="prototype"&&u>0&&c[u-1]=="constructor"))throw new TypeError("JSON-Patch: modifying `__proto__` or `constructor/prototype` prop is banned for security reasons, if this was on purpose, please set `banPrototypeModifications` flag false and pass it to this function. More info in fast-json-patch README");if(n&&d===void 0&&(l[h]===void 0?d=c.slice(0,u).join("/"):u==f-1&&(d=t.path),d!==void 0&&p(t,0,e,d)),u++,Array.isArray(l)){if(h==="-")h=l.length;else{if(n&&!Wc(h))throw new rt("Expected an unsigned base-10 integer value, making the new referenced value the array element with the zero-based index","OPERATION_PATH_ILLEGAL_ARRAY_INDEX",s,t,e);Wc(h)&&(h=~~h)}if(u>=f){if(n&&t.op==="add"&&h>l.length)throw new rt("The specified index MUST NOT be greater than the number of elements in the array","OPERATION_VALUE_OUT_OF_BOUNDS",s,t,e);var o=Bb[t.op].call(t,l,h,e);if(o.test===!1)throw new rt("Test operation failed","TEST_OPERATION_FAILED",s,t,e);return o}}else if(u>=f){var o=Di[t.op].call(t,l,h,e);if(o.test===!1)throw new rt("Test operation failed","TEST_OPERATION_FAILED",s,t,e);return o}if(l=l[h],n&&u<f&&(!l||typeof l!="object"))throw new rt("Cannot perform operation at the desired path","OPERATION_PATH_UNRESOLVABLE",s,t,e)}}}function Hc(e,t,n,r,i){if(r===void 0&&(r=!0),i===void 0&&(i=!0),n&&!Array.isArray(t))throw new rt("Patch sequence must be an array","SEQUENCE_NOT_AN_ARRAY");r||(e=Kt(e));for(var s=new Array(t.length),o=0,a=t.length;o<a;o++)s[o]=ii(e,t[o],n,!0,i,o),e=s[o].newDocument;return s.newDocument=e,s}function Fb(e,t,n){var r=ii(e,t);if(r.test===!1)throw new rt("Test operation failed","TEST_OPERATION_FAILED",n,t,e);return r.newDocument}function Po(e,t,n,r){if(typeof e!="object"||e===null||Array.isArray(e))throw new rt("Operation is not an object","OPERATION_NOT_AN_OBJECT",t,e,n);if(Di[e.op]){if(typeof e.path!="string")throw new rt("Operation `path` property is not a string","OPERATION_PATH_INVALID",t,e,n);if(e.path.indexOf("/")!==0&&e.path.length>0)throw new rt('Operation `path` property must start with "/"',"OPERATION_PATH_INVALID",t,e,n);if((e.op==="move"||e.op==="copy")&&typeof e.from!="string")throw new rt("Operation `from` property is not present (applicable in `move` and `copy` operations)","OPERATION_FROM_REQUIRED",t,e,n);if((e.op==="add"||e.op==="replace"||e.op==="test")&&e.value===void 0)throw new rt("Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)","OPERATION_VALUE_REQUIRED",t,e,n);if((e.op==="add"||e.op==="replace"||e.op==="test")&&Gc(e.value))throw new rt("Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)","OPERATION_VALUE_CANNOT_CONTAIN_UNDEFINED",t,e,n);if(n){if(e.op=="add"){var i=e.path.split("/").length,s=r.split("/").length;if(i!==s+1&&i!==s)throw new rt("Cannot perform an `add` operation at the desired path","OPERATION_PATH_CANNOT_ADD",t,e,n)}else if(e.op==="replace"||e.op==="remove"||e.op==="_get"){if(e.path!==r)throw new rt("Cannot perform the operation at a path that does not exist","OPERATION_PATH_UNRESOLVABLE",t,e,n)}else if(e.op==="move"||e.op==="copy"){var o={op:"_get",path:e.from,value:void 0},a=gh([o],n);if(a&&a.name==="OPERATION_PATH_UNRESOLVABLE")throw new rt("Cannot perform the operation from a path that does not exist","OPERATION_FROM_UNRESOLVABLE",t,e,n)}}}else throw new rt("Operation `op` property is not one of operations defined in RFC-6902","OPERATION_OP_INVALID",t,e,n)}function gh(e,t,n){try{if(!Array.isArray(e))throw new rt("Patch sequence must be an array","SEQUENCE_NOT_AN_ARRAY");if(t)Hc(Kt(t),Kt(e),n||!0);else{n=n||Po;for(var r=0;r<e.length;r++)n(e[r],r,t,void 0)}}catch(i){if(i instanceof rt)return i;throw i}}function gs(e,t){if(e===t)return!0;if(e&&t&&typeof e=="object"&&typeof t=="object"){var n=Array.isArray(e),r=Array.isArray(t),i,s,o;if(n&&r){if(s=e.length,s!=t.length)return!1;for(i=s;i--!==0;)if(!gs(e[i],t[i]))return!1;return!0}if(n!=r)return!1;var a=Object.keys(e);if(s=a.length,s!==Object.keys(t).length)return!1;for(i=s;i--!==0;)if(!t.hasOwnProperty(a[i]))return!1;for(i=s;i--!==0;)if(o=a[i],!gs(e[o],t[o]))return!1;return!0}return e!==e&&t!==t}var $b=Object.freeze({__proto__:null,JsonPatchError:rt,_areEquals:gs,applyOperation:ii,applyPatch:Hc,applyReducer:Fb,deepClone:Db,getValueByPointer:Uo,validate:gh,validator:Po});/*!
 * https://github.com/Starcounter-Jack/JSON-Patch
 * (c) 2017-2021 Joachim Wester
 * MIT license
 */var Vc=new WeakMap,jb=function(){function e(t){this.observers=new Map,this.obj=t}return e}(),zb=function(){function e(t,n){this.callback=t,this.observer=n}return e}();function Wb(e){return Vc.get(e)}function Gb(e,t){return e.observers.get(t)}function Hb(e,t){e.observers.delete(t.callback)}function Vb(e,t){t.unobserve()}function Kb(e,t){var n=[],r,i=Wb(e);if(!i)i=new jb(e),Vc.set(e,i);else{var s=Gb(i,t);r=s&&s.observer}if(r)return r;if(r={},i.value=Kt(e),t){r.callback=t,r.next=null;var o=function(){Kc(r)},a=function(){clearTimeout(r.next),r.next=setTimeout(o)};typeof window<"u"&&(window.addEventListener("mouseup",a),window.addEventListener("keyup",a),window.addEventListener("mousedown",a),window.addEventListener("keydown",a),window.addEventListener("change",a))}return r.patches=n,r.object=e,r.unobserve=function(){Kc(r),clearTimeout(r.next),Hb(i,r),typeof window<"u"&&(window.removeEventListener("mouseup",a),window.removeEventListener("keyup",a),window.removeEventListener("mousedown",a),window.removeEventListener("keydown",a),window.removeEventListener("change",a))},i.observers.set(t,new zb(t,r)),r}function Kc(e,t){t===void 0&&(t=!1);var n=Vc.get(e.object);qc(n.value,e.object,e.patches,"",t),e.patches.length&&Hc(n.value,e.patches);var r=e.patches;return r.length>0&&(e.patches=[],e.callback&&e.callback(r)),r}function qc(e,t,n,r,i){if(t!==e){typeof t.toJSON=="function"&&(t=t.toJSON());for(var s=zc(t),o=zc(e),a=!1,c=o.length-1;c>=0;c--){var l=o[c],u=e[l];if(jc(t,l)&&!(t[l]===void 0&&u!==void 0&&Array.isArray(t)===!1)){var f=t[l];typeof u=="object"&&u!=null&&typeof f=="object"&&f!=null&&Array.isArray(u)===Array.isArray(f)?qc(u,f,n,r+"/"+ri(l),i):u!==f&&(i&&n.push({op:"test",path:r+"/"+ri(l),value:Kt(u)}),n.push({op:"replace",path:r+"/"+ri(l),value:Kt(f)}))}else Array.isArray(e)===Array.isArray(t)?(i&&n.push({op:"test",path:r+"/"+ri(l),value:Kt(u)}),n.push({op:"remove",path:r+"/"+ri(l)}),a=!0):(i&&n.push({op:"test",path:r,value:e}),n.push({op:"replace",path:r,value:t}))}if(!(!a&&s.length==o.length))for(var c=0;c<s.length;c++){var l=s[c];!jc(e,l)&&t[l]!==void 0&&n.push({op:"add",path:r+"/"+ri(l),value:Kt(t[l])})}}}function yh(e,t,n){n===void 0&&(n=!1);var r=[];return qc(e,t,r,"",n),r}var qb=Object.freeze({__proto__:null,compare:yh,generate:Kc,observe:Kb,unobserve:Vb});Object.assign({},$b,qb,{JsonPatchError:mh,deepClone:Kt,escapePathComponent:ri,unescapePathComponent:dh});var Xb=typeof Element<"u",Jb=typeof Map=="function",Zb=typeof Set=="function",Yb=typeof ArrayBuffer=="function"&&!!ArrayBuffer.isView;function Do(e,t){if(e===t)return!0;if(e&&t&&typeof e=="object"&&typeof t=="object"){if(e.constructor!==t.constructor)return!1;var n,r,i;if(Array.isArray(e)){if(n=e.length,n!=t.length)return!1;for(r=n;r--!==0;)if(!Do(e[r],t[r]))return!1;return!0}var s;if(Jb&&e instanceof Map&&t instanceof Map){if(e.size!==t.size)return!1;for(s=e.entries();!(r=s.next()).done;)if(!t.has(r.value[0]))return!1;for(s=e.entries();!(r=s.next()).done;)if(!Do(r.value[1],t.get(r.value[0])))return!1;return!0}if(Zb&&e instanceof Set&&t instanceof Set){if(e.size!==t.size)return!1;for(s=e.entries();!(r=s.next()).done;)if(!t.has(r.value[0]))return!1;return!0}if(Yb&&ArrayBuffer.isView(e)&&ArrayBuffer.isView(t)){if(n=e.length,n!=t.length)return!1;for(r=n;r--!==0;)if(e[r]!==t[r])return!1;return!0}if(e.constructor===RegExp)return e.source===t.source&&e.flags===t.flags;if(e.valueOf!==Object.prototype.valueOf&&typeof e.valueOf=="function"&&typeof t.valueOf=="function")return e.valueOf()===t.valueOf();if(e.toString!==Object.prototype.toString&&typeof e.toString=="function"&&typeof t.toString=="function")return e.toString()===t.toString();if(i=Object.keys(e),n=i.length,n!==Object.keys(t).length)return!1;for(r=n;r--!==0;)if(!Object.prototype.hasOwnProperty.call(t,i[r]))return!1;if(Xb&&e instanceof Element)return!1;for(r=n;r--!==0;)if(!((i[r]==="_owner"||i[r]==="__v"||i[r]==="__o")&&e.$$typeof)&&!Do(e[i[r]],t[i[r]]))return!1;return!0}return e!==e&&t!==t}var Qb=function(t,n){try{return Do(t,n)}catch(r){if((r.message||"").match(/stack|recursion/i))return console.warn("react-fast-compare cannot handle circular refs"),!1;throw r}},ew=Pi(Qb);function S(e){return e!=null}const tw=Object.keys;function ys(e){return Kt(e)}function ke(e){return typeof e=="number"&&isNaN(e)===!1}function Ce(e){return typeof e=="string"}function We(e){return Array.isArray(e)}function nw(e){return e}var _h={exports:{}},Xc={exports:{}},bh;function rw(){return bh||(bh=1,function(e,t){(function(n,r){e.exports=r()})(Bt,function(){function n(m){return!isNaN(parseFloat(m))&&isFinite(m)}function r(m){return m.charAt(0).toUpperCase()+m.substring(1)}function i(m){return function(){return this[m]}}var s=["isConstructor","isEval","isNative","isToplevel"],o=["columnNumber","lineNumber"],a=["fileName","functionName","source"],c=["args"],l=["evalOrigin"],u=s.concat(o,a,c,l);function f(m){if(m)for(var b=0;b<u.length;b++)m[u[b]]!==void 0&&this["set"+r(u[b])](m[u[b]])}f.prototype={getArgs:function(){return this.args},setArgs:function(m){if(Object.prototype.toString.call(m)!=="[object Array]")throw new TypeError("Args must be an Array");this.args=m},getEvalOrigin:function(){return this.evalOrigin},setEvalOrigin:function(m){if(m instanceof f)this.evalOrigin=m;else if(m instanceof Object)this.evalOrigin=new f(m);else throw new TypeError("Eval Origin must be an Object or StackFrame")},toString:function(){var m=this.getFileName()||"",b=this.getLineNumber()||"",_=this.getColumnNumber()||"",w=this.getFunctionName()||"";return this.getIsEval()?m?"[eval] ("+m+":"+b+":"+_+")":"[eval]:"+b+":"+_:w?w+" ("+m+":"+b+":"+_+")":m+":"+b+":"+_}},f.fromString=function(b){var _=b.indexOf("("),w=b.lastIndexOf(")"),v=b.substring(0,_),k=b.substring(_+1,w).split(","),C=b.substring(w+1);if(C.indexOf("@")===0)var I=/@(.+?)(?::(\d+))?(?::(\d+))?$/.exec(C,""),T=I[1],L=I[2],x=I[3];return new f({functionName:v,args:k||void 0,fileName:T,lineNumber:L||void 0,columnNumber:x||void 0})};for(var d=0;d<s.length;d++)f.prototype["get"+r(s[d])]=i(s[d]),f.prototype["set"+r(s[d])]=function(m){return function(b){this[m]=!!b}}(s[d]);for(var h=0;h<o.length;h++)f.prototype["get"+r(o[h])]=i(o[h]),f.prototype["set"+r(o[h])]=function(m){return function(b){if(!n(b))throw new TypeError(m+" must be a Number");this[m]=Number(b)}}(o[h]);for(var p=0;p<a.length;p++)f.prototype["get"+r(a[p])]=i(a[p]),f.prototype["set"+r(a[p])]=function(m){return function(b){this[m]=String(b)}}(a[p]);return f})}(Xc)),Xc.exports}(function(e,t){(function(n,r){e.exports=r(rw())})(Bt,function(r){var i=/(^|@)\S+:\d+/,s=/^\s*at .*(\S+:\d+|\(native\))/m,o=/^(eval@)?(\[native code])?$/;return{parse:function(c){if(typeof c.stacktrace<"u"||typeof c["opera#sourceloc"]<"u")return this.parseOpera(c);if(c.stack&&c.stack.match(s))return this.parseV8OrIE(c);if(c.stack)return this.parseFFOrSafari(c);throw new Error("Cannot parse given Error object")},extractLocation:function(c){if(c.indexOf(":")===-1)return[c];var l=/(.+?)(?::(\d+))?(?::(\d+))?$/,u=l.exec(c.replace(/[()]/g,""));return[u[1],u[2]||void 0,u[3]||void 0]},parseV8OrIE:function(c){var l=c.stack.split(`
`).filter(function(u){return!!u.match(s)},this);return l.map(function(u){u.indexOf("(eval ")>-1&&(u=u.replace(/eval code/g,"eval").replace(/(\(eval at [^()]*)|(,.*$)/g,""));var f=u.replace(/^\s+/,"").replace(/\(eval code/g,"(").replace(/^.*?\s+/,""),d=f.match(/ (\(.+\)$)/);f=d?f.replace(d[0],""):f;var h=this.extractLocation(d?d[1]:f),p=d&&f||void 0,m=["eval","<anonymous>"].indexOf(h[0])>-1?void 0:h[0];return new r({functionName:p,fileName:m,lineNumber:h[1],columnNumber:h[2],source:u})},this)},parseFFOrSafari:function(c){var l=c.stack.split(`
`).filter(function(u){return!u.match(o)},this);return l.map(function(u){if(u.indexOf(" > eval")>-1&&(u=u.replace(/ line (\d+)(?: > eval line \d+)* > eval:\d+:\d+/g,":$1")),u.indexOf("@")===-1&&u.indexOf(":")===-1)return new r({functionName:u});var f=/((.*".+"[^@]*)?[^@]*)(?:@)/,d=u.match(f),h=d&&d[1]?d[1]:void 0,p=this.extractLocation(u.replace(f,""));return new r({functionName:h,fileName:p[0],lineNumber:p[1],columnNumber:p[2],source:u})},this)},parseOpera:function(c){return!c.stacktrace||c.message.indexOf(`
`)>-1&&c.message.split(`
`).length>c.stacktrace.split(`
`).length?this.parseOpera9(c):c.stack?this.parseOpera11(c):this.parseOpera10(c)},parseOpera9:function(c){for(var l=/Line (\d+).*script (?:in )?(\S+)/i,u=c.message.split(`
`),f=[],d=2,h=u.length;d<h;d+=2){var p=l.exec(u[d]);p&&f.push(new r({fileName:p[2],lineNumber:p[1],source:u[d]}))}return f},parseOpera10:function(c){for(var l=/Line (\d+).*script (?:in )?(\S+)(?:: In function (\S+))?$/i,u=c.stacktrace.split(`
`),f=[],d=0,h=u.length;d<h;d+=2){var p=l.exec(u[d]);p&&f.push(new r({functionName:p[3]||void 0,fileName:p[2],lineNumber:p[1],source:u[d]}))}return f},parseOpera11:function(c){var l=c.stack.split(`
`).filter(function(u){return!!u.match(i)&&!u.match(/^Error created at/)},this);return l.map(function(u){var f=u.split("@"),d=this.extractLocation(f.pop()),h=f.shift()||"",p=h.replace(/<anonymous function(: (\w+))?>/,"$2").replace(/\([^)]*\)/g,"")||void 0,m;h.match(/\(([^)]*)\)/)&&(m=h.replace(/^[^(]+\(([^)]*)\)$/,"$1"));var b=m===void 0||m==="[arguments not available]"?void 0:m.split(",");return new r({functionName:p,args:b,fileName:d[0],lineNumber:d[1],columnNumber:d[2],source:u})},this)}}})})(_h);var iw=_h.exports,sw=Pi(iw);function cr(e){const t={},n={get(){return[!1,void 0]},set(){return[!1,void 0]},tick(){},everytick(){},...e,getcommand(r){return t[r]},command(r,i){return t[r]=i,n}};return n}var wh={exports:{}};(function(e,t){(function(n,r){e.exports=r()})(Bt,function(){return n.importState=function(i){var s=new n;return s.importState(i),s},n;function n(){return function(i){var s=0,o=0,a=0,c=1;i.length==0&&(i=[+new Date]);var l=r();s=l(" "),o=l(" "),a=l(" ");for(var u=0;u<i.length;u++)s-=l(i[u]),s<0&&(s+=1),o-=l(i[u]),o<0&&(o+=1),a-=l(i[u]),a<0&&(a+=1);l=null;var f=function(){var d=2091639*s+c*23283064365386963e-26;return s=o,o=a,a=d-(c=d|0)};return f.next=f,f.uint32=function(){return f()*4294967296},f.fract53=function(){return f()+(f()*2097152|0)*11102230246251565e-32},f.version="Alea 0.9",f.args=i,f.exportState=function(){return[s,o,a,c]},f.importState=function(d){s=+d[0]||0,o=+d[1]||0,a=+d[2]||0,c=+d[3]||0},f}(Array.prototype.slice.call(arguments))}function r(){var i=4022871197,s=function(o){o=o.toString();for(var a=0;a<o.length;a++){i+=o.charCodeAt(a);var c=.02519603282416938*i;i=c>>>0,c-=i,c*=i,i=c>>>0,c-=i,i+=c*4294967296}return(i>>>0)*23283064365386963e-26};return s.version="Mash 0.9",s}})})(wh);var ow=wh.exports,aw=Pi(ow);function si(e,t,n){return Math.max(t,Math.min(n,e))}const cw=aw("089fad0j9awfem09wavefc09uwaef");function lw(){return cw()}function Bo(e,t){const n=Math.min(e,t),i=Math.max(e,t)-n+1;return n+Math.floor(lw()*i)}function Jc(e,t,n){typeof e!="number"&&(e=0,t=0,n=1),typeof t!="number"&&(t=e,e=0,n=1),typeof n!="number"&&(n=1);const r=[],i=Math.min(e,t),s=Math.max(e,t);for(let o=i;o<=s;o+=n)r.push(o);return r}function uw(e){return e[Bo(0,e.length-1)]}function lr(...e){return uw(e.flat())}function fw(e){return[...new Set(e)].filter(S)}function hw(...e){const t=e.flat().filter(S);return t.reduce((n,r)=>n+r,0)/t.length}const vh={isterrain:"ISTERRAIN",isobject:"ISOBJECT"};function Pr(e){return We(e)&&Eh(e[0])}function Eh(e){return S(Co[e])&&Ce(e)}function kh(e){if(Ce(e))return vh[Pe(e)]}function Sh(e){if(Pr(e))return e;if(Eh(e))return[e];const t=kh(e);if(S(t))return[t]}function Fo(e){const t=D.words[e],n=Sh(t);if(Pr(n))return[n,e+1];const[r,i]=$t(e),s=Sh(r);return Pr(s)?[s,i]:[void 0,e]}const Ah={issolid:"ISSOLID",iswalk:"ISWALK",isswim:"ISSWIM",isbullet:"ISBULLET",iswalkable:"ISWALKABLE",isswimmable:"ISSWIMABLE"};ct.ISSOLID,ct.ISWALK,ct.ISSWIM,ct.ISBULLET,ct.ISWALK,ct.ISSWIM;function oi(e){return We(e)&&Zc(e[0])}function Zc(e){return S(ct[e])&&Ce(e)}function dw(e){if(Ce(e))return Ah[Pe(e)]}function Th(e){const t=D.words[e];if(oi(t))return[t,e+1];if(Zc(t))return[[t],e+1];const[n,r]=$t(e);return oi(n)?[n,r]:Zc(n)?[[n],r]:[void 0,e]}function ur(e){return S(e)&&S(e.x)&&S(e.y)}function At(e,t){switch(t){case oe.NORTH:--e.y;break;case oe.SOUTH:++e.y;break;case oe.WEST:--e.x;break;case oe.EAST:++e.x;break}return e}function Bi(e,t){const n=t.x-e.x,r=t.y-e.y;if(n<0)return oe.WEST;if(n>0)return oe.EAST;if(r<0)return oe.NORTH;if(r>0)return oe.SOUTH}const xh={idle:"IDLE",up:"NORTH",down:"SOUTH",left:"WEST",right:"EAST",by:"BY",at:"AT",flow:"FLOW",seek:"SEEK",rndns:"RNDNS",rndne:"RNDNE",rnd:"RND",cw:"CW",ccw:"CCW",opp:"OPP",rndp:"RNDP",i:"IDLE",u:"NORTH",north:"NORTH",n:"NORTH",d:"SOUTH",south:"SOUTH",s:"SOUTH",l:"WEST",west:"WEST",w:"WEST",r:"EAST",east:"EAST",e:"EAST",edit:"EDIT"};function fr(e){return We(e)&&Rh(e[0])}function Rh(e){return S(oe[e])&&Ce(e)}function pw(e){const t=oe[e];return S(t)?t:oe.IDLE}function Ih(e){if(Ce(e))return xh[Pe(e)]}function Oh(e){if(fr(e))return e;if(Rh(e))return[e];const t=Ih(e);if(S(t))return[t]}function Nh(e){const t=D.words[e],n=Oh(t);if(fr(n))return[n,e+1];const[r,i]=$t(e),s=Oh(r);return fr(s)?[s,i]:[void 0,e]}function Yc(e){const t=[];let[n,r]=Nh(e);for(;fr(n);){if(t.push(...n),(n[0]==="AT"||n[0]==="BY")&&n.length<2){const[o,a,c]=re(D.words,r,[q.NUMBER,q.NUMBER]);t.push(o,a),r=c}const[i,s]=Nh(r);n=i,r=s}return t.length?[t,r]:[void 0,e]}function $t(e,t=!0){var r;const n=D.words[e];if(kh(n)){const[i,s]=Fo(e);if(S(i))return[i,s]}if(dw(n)){const[i,s]=Th(e);if(S(i))return[i,s]}if(Mh(n)){const[i,s]=jo(e);if(S(i))return[i,s]}if(Ce(n)&&Pe(n)==="rnd"){const[i,s]=$t(e+1),[o,a]=$t(s);return ke(i)&&ke(o)?[Bo(i,o),a]:ke(i)?[Bo(0,i),s]:[Bo(0,1),e+1]}if(Ih(n)){const[i,s]=Yc(e);if(S(i))return[i,s]}if(!S(n))return[void 0,e];if(ur(n)||ke(n)||We(n))return[n,e+1];if(Ce(n)){const i=Pe(n);if(t){const s=(r=D.get)==null?void 0:r.call(D,n);if(S(s))return[s,e+1]}switch(i){case"aligned":case"alligned":break;case"contact":break;case"blocked":break;case"any":break;case"abs":{const[s,o]=re(D.words,e+1,[q.NUMBER]);return[Math.abs(s),o]}case"ceil":{const[s,o]=re(D.words,e+1,[q.NUMBER]);return[Math.ceil(s),o]}case"floor":{const[s,o]=re(D.words,e+1,[q.NUMBER]);return[Math.floor(s),o]}case"round":{const[s,o]=re(D.words,e+1,[q.NUMBER]);return[Math.round(s),o]}case"min":{const s=[];for(let o=e+1;o<D.words.length;){const[a,c]=$t(o);if(We(a)&&!ur(a)&&!fr(a)&&!Pr(a)&&!oi(a)&&!fn(a))return[lr(a),c];o=c,s.push(a)}return[Math.min(...s),D.words.length]}case"max":{const s=[];for(let o=e+1;o<D.words.length;){const[a,c]=$t(o);if(We(a)&&!ur(a)&&!fr(a)&&!Pr(a)&&!oi(a)&&!fn(a))return[lr(a),c];o=c,s.push(a)}return[Math.max(...s),D.words.length]}case"clamp":{const[s,o,a,c]=re(D.words,e+1,[q.NUMBER,q.NUMBER,q.NUMBER]);return[si(s,o,a),c]}case"pick":{const s=[];for(let o=e+1;o<D.words.length;){const[a,c]=$t(o);if(We(a)&&!ur(a)&&!fr(a)&&!Pr(a)&&!oi(a)&&!fn(a))return[lr(a),c];o=c,s.push(a)}return[lr(s),D.words.length]}case"range":{const[s,o,a,c]=re(D.words,e+1,[q.NUMBER,q.MAYBE_NUMBER,q.MAYBE_NUMBER]);return[Jc(s,o,a),c]}}}return[n,e+1]}function mw(e){return S(e)&&e<be.ONBLACK?e:void 0}function gw(e){return S(e)&&e>be.WHITE&&e<be.ONCLEAR?e-be.ONBLACK:void 0}const $o={black:"BLACK",dkblue:"DKBLUE",dkgreen:"DKGREEN",dkcyan:"DKCYAN",dkred:"DKRED",dkpurple:"DKPURPLE",dkyellow:"DKYELLOW",ltgray:"LTGRAY",dkgray:"DKGRAY",blue:"BLUE",green:"GREEN",cyan:"CYAN",red:"RED",purple:"PURPLE",yellow:"YELLOW",white:"WHITE",brown:"DKYELLOW",dkwhite:"LTGRAY",ltgrey:"LTGRAY",gray:"LTGRAY",grey:"LTGRAY",dkgrey:"DKGRAY",ltblack:"DKGRAY",onblack:"ONBLACK",ondkblue:"ONDKBLUE",ondkgreen:"ONDKGREEN",ondkcyan:"ONDKCYAN",ondkred:"ONDKRED",ondkpurple:"ONDKPURPLE",ondkyellow:"ONDKYELLOW",onltgray:"ONLTGRAY",ondkgray:"ONDKGRAY",onblue:"ONBLUE",ongreen:"ONGREEN",oncyan:"ONCYAN",onred:"ONRED",onpurple:"ONPURPLE",onyellow:"ONYELLOW",onwhite:"ONWHITE",onbrown:"ONDKYELLOW",ondkwhite:"ONLTGRAY",onltgrey:"ONLTGRAY",ongray:"ONLTGRAY",ongrey:"ONLTGRAY",ondkgrey:"ONDKGRAY",onltblack:"ONDKGRAY",onclear:"ONCLEAR",onshadow:"ONSHADOW",onborrow:"ONBORROW"};function fn(e){return We(e)&&Lh(e[0])}function Ch(e){return fn(e)&&e[0].startsWith("ON")}function Lh(e){return S(be[e])&&Ce(e)}function Mh(e){if(Ce(e))return $o[Pe(e)]}function yw(e){return e.map(t=>be[t]).find(t=>S(t)&&t<be.ONBLACK)}function _w(e){return e.map(t=>be[t]).find(t=>S(t)&&t>=be.ONBLACK)}function Uh(e){if(fn(e))return e;if(Lh(e))return[e];const t=Mh(e);if(S(t))return[t]}function Ph(e){const t=D.words[e],n=Uh(t);if(fn(n))return[n,e+1];const[r,i]=$t(e),s=Uh(r);return fn(s)?[s,i]:[void 0,e]}function jo(e){const t=[];let n=e;const[r,i]=Ph(e);if(fn(r)&&(t.push(...r),n=i),fn(t)&&!Ch(t)){const[s,o]=Ph(i);Ch(s)&&(n=o)}return t.length?[t,n]:[void 0,e]}function bw(e){const t={};return e.every(n=>{const r=be[n];S(r)&&(r<be.ONBLACK?t.color=r:t.bg=r-be.ONBLACK)}),t}function Fi(e){return We(e)&&typeof e[0]=="string"}function Dh(e){const t=D.words[e];if(Fi(t))return[t,e+1];const[n,r]=jo(e),[i,s]=$t(r,!1);return Ce(i)?[[i,n],s]:[void 0,e]}function Qc(e){if(!Fi(e))return;const[t]=e;return t}function Bh(e){if(!Fi(e))return;const[,t]=e,n=S(t)?yw(t):void 0;return S(n)?n:void 0}function Fh(e){if(!Fi(e))return;const[,t]=e,n=S(t)?_w(t):void 0;return S(n)?n:void 0}const Ge=60,hn=25;var Ae=(e=>(e[e.ERROR=0]="ERROR",e[e.LOADER=1]="LOADER",e[e.BOARD=2]="BOARD",e[e.OBJECT=3]="OBJECT",e[e.TERRAIN=4]="TERRAIN",e[e.CHARSET=5]="CHARSET",e[e.PALETTE=6]="PALETTE",e))(Ae||{});function ww(e,t){const n=e??ct.ISWALK,r=t??ct.ISWALK;switch(n){case ct.ISWALK:return r!==ct.ISWALK;case ct.ISSWIM:return r!==ct.ISSWIM;case ct.ISSOLID:return!0;case ct.ISBULLET:return r!==ct.ISWALK&&r!==ct.ISSWIM}}function el(e,t){var r,i;return[...((i=(r=e==null?void 0:e.named)==null?void 0:r[t])==null?void 0:i.values())??[]].map(s=>typeof s=="string"?e==null?void 0:e.objects[s]:e==null?void 0:e.terrain[s]).filter(S)}function vw(e,t){const n=Qc(t),r=Bh(t),i=Fh(t);return e.filter(s=>!(S(n)&&vl(s)!==n||S(r)&&mv(s)!==r||S(i)&&gv(s)!==i)).filter(S)}function tl(e,t){return S(e)?t.map(n=>{var r;if(typeof n=="string"){const i=e.objects[n];if(S(i))return i;const s=el(e,Pe(n));if(s.length)return s}else if(ur(n)&&n.x>=0&&n.x<Ge&&n.y>=0&&n.y<hn){const i=n.x+n.y*Ge,s=(r=e.lookup)==null?void 0:r[i];return S(s)?e.objects[s]:e.terrain[i]}}).flat().filter(S):[]}function Ew(e,t){let n=0,r;for(let i=0;i<t.length;++i){const s=t[i];if(s){const o=e.x-(s.x??0),a=e.y-(s.y??0),c=Math.sqrt(o*o+a*a);(r===void 0||c<n)&&(n=c,r=s)}}return r}var $h={},hr={},dr={};Object.defineProperty(dr,"__esModule",{value:!0}),dr.throwUnsupportedData=dr.throwUnknownDataType=dr.getType=void 0;function jh(e){return Object.prototype.toString.call(e)}dr.getType=jh;function kw(e){throw new TypeError("unsupported data type: "+jh(e))}dr.throwUnknownDataType=kw;function Sw(e){throw new TypeError("unsupported data type: "+e)}dr.throwUnsupportedData=Sw;var Ct={},Lt={};Object.defineProperty(Lt,"__esModule",{value:!0}),Lt.s_to_num=Lt.int_str_to_s=Lt.num_to_s=Lt.big_int_to_s=Lt.int_to_s=Lt.s_to_big_int=Lt.s_to_int=void 0;let pr="";for(let e=0;e<10;e++){const t=String.fromCharCode(48+e);pr+=t}for(let e=0;e<26;e++){const t=String.fromCharCode(65+e);pr+=t}for(let e=0;e<26;e++){const t=String.fromCharCode(97+e);pr+=t}const $i=pr.length,nl={};for(let e=0;e<$i;e++){const t=pr[e];nl[t]=e}function rl(e){let t=0,n=1;for(let r=e.length-1;r>=0;r--){const i=e[r];let s=nl[i];s*=n,t+=s,n*=$i}return t}Lt.s_to_int=rl;function zh(e){let t=BigInt(0),n=BigInt(1);const r=BigInt($i);for(let i=e.length-1;i>=0;i--){const s=e[i];let o=BigInt(nl[s]);o*=n,t+=o,n*=r}return t}Lt.s_to_big_int=zh;function il(e){if(e===0)return pr[0];const t=[];for(;e!==0;){const n=e%$i,r=pr[n];t.push(r),e-=n,e/=$i}return t.reverse().join("")}Lt.int_to_s=il;function Wh(e){const t=BigInt(0),n=BigInt($i);if(e===t)return pr[0];const r=[];for(;e!==t;){const i=e%n,s=pr[Number(i)];r.push(s),e/=n}return r.reverse().join("")}Lt.big_int_to_s=Wh;function Gh(e){return e.split("").reverse().join("")}function Hh(e){if(e<0)return"-"+Hh(-e);let[t,n]=e.toString().split(".");if(!n)return il(e);let r;n&&([n,r]=n.split("e")),t=zo(t),n=Gh(n),n=zo(n);let i=t+"."+n;if(r){switch(i+=".",r[0]){case"+":r=r.slice(1);break;case"-":i+="-",r=r.slice(1);break}r=zo(r),i+=r}return i}Lt.num_to_s=Hh;function zo(e){const t=+e;return t.toString()===e&&t+1!==t&&t-1!==t?il(t):":"+Wh(BigInt(e))}Lt.int_str_to_s=zo;function sl(e){return e[0]===":"?zh(e.substring(1)).toString():rl(e).toString()}function Vh(e){if(e[0]==="-")return-Vh(e.substr(1));let[t,n,r]=e.split(".");if(!n)return rl(t);t=sl(t),n=sl(n),n=Gh(n);let i=t+"."+n;if(r){i+="e";let s=!1;r[0]==="-"&&(s=!0,r=r.slice(1)),r=sl(r),i+=s?-r:+r}return+i}Lt.s_to_num=Vh,Object.defineProperty(Ct,"__esModule",{value:!0}),Ct.decodeStr=Ct.encodeStr=Ct.decodeBool=Ct.encodeBool=Ct.decodeKey=Ct.decodeNum=Ct.encodeNum=void 0;const ol=Lt;function Aw(e){return"n|"+(0,ol.num_to_s)(e)}Ct.encodeNum=Aw;function Tw(e){return e=e.replace("n|",""),(0,ol.s_to_num)(e)}Ct.decodeNum=Tw;function xw(e){return typeof e=="number"?e:(0,ol.s_to_int)(e)}Ct.decodeKey=xw;function Rw(e){return e?"b|T":"b|F"}Ct.encodeBool=Rw;function Iw(e){switch(e){case"b|T":return!0;case"b|F":return!1}return!!e}Ct.decodeBool=Iw;function Ow(e){switch(e[0]+e[1]){case"b|":case"o|":case"n|":case"a|":case"s|":e="s|"+e}return e}Ct.encodeStr=Ow;function Nw(e){return e[0]+e[1]==="s|"?e.substr(2):e}Ct.decodeStr=Nw;var rn={},_s={};Object.defineProperty(_s,"__esModule",{value:!0}),_s.config=void 0,_s.config={sort_key:!1,error_on_nan:!1,error_on_infinite:!1},Object.defineProperty(rn,"__esModule",{value:!0}),rn.addValue=rn.makeInMemoryMemory=rn.makeInMemoryCache=rn.makeInMemoryStore=rn.memToValues=void 0;const al=_s,cl=dr,ll=Ct,Cw=Lt;function Lw(e){return e.store.toArray()}rn.memToValues=Lw;function Kh(){const e=[];return{forEach(t){for(let n=0;n<e.length;n++)if(t(e[n])==="break")return},add(t){e.push(t)},toArray(){return e}}}rn.makeInMemoryStore=Kh;function qh(){const e=Object.create(null),t=Object.create(null);return{getValue(n){return e[n]},getSchema(n){return t[n]},forEachValue(n){for(const[r,i]of Object.entries(e))if(n(r,i)==="break")return},forEachSchema(n){for(const[r,i]of Object.entries(t))if(n(r,i)==="break")return},setValue(n,r){e[n]=r},setSchema(n,r){t[n]=r},hasValue(n){return n in e},hasSchema(n){return n in t}}}rn.makeInMemoryCache=qh;function Mw(){return{store:Kh(),cache:qh(),keyCount:0}}rn.makeInMemoryMemory=Mw;function ai(e,t){if(e.cache.hasValue(t))return e.cache.getValue(t);const n=e.keyCount++,r=(0,Cw.num_to_s)(n);return e.store.add(t),e.cache.setValue(t,r),r}function Uw(e,t){al.config.sort_key&&t.sort();const n=t.join(",");if(e.cache.hasSchema(n))return e.cache.getSchema(n);const r=bs(e,t,void 0);return e.cache.setSchema(n,r),r}function bs(e,t,n){if(t===null)return"";switch(typeof t){case"undefined":if(Array.isArray(n))return bs(e,null,n);break;case"object":if(t===null)return ai(e,null);if(Array.isArray(t)){let r="a";for(let i=0;i<t.length;i++){const s=t[i],o=s===null?"_":bs(e,s,t);r+="|"+o}return r==="a"&&(r="a|"),ai(e,r)}else{const r=Object.keys(t);if(r.length===0)return ai(e,"o|");let i="o";const s=Uw(e,r);i+="|"+s;for(const o of r){const a=t[o],c=bs(e,a,t);i+="|"+c}return ai(e,i)}case"boolean":return ai(e,(0,ll.encodeBool)(t));case"number":return Number.isNaN(t)?(al.config.error_on_nan&&(0,cl.throwUnsupportedData)("[number NaN]"),""):Number.POSITIVE_INFINITY===t||Number.NEGATIVE_INFINITY===t?(al.config.error_on_infinite&&(0,cl.throwUnsupportedData)("[number Infinity]"),""):ai(e,(0,ll.encodeNum)(t));case"string":return ai(e,(0,ll.encodeStr)(t))}return(0,cl.throwUnknownDataType)(t)}rn.addValue=bs,Object.defineProperty(hr,"__esModule",{value:!0}),hr.decompress=hr.decode=hr.compress=void 0;const Pw=dr,Wo=Ct,ul=rn;function Dw(e){const t=(0,ul.makeInMemoryMemory)(),n=(0,ul.addValue)(t,e,void 0);return[(0,ul.memToValues)(t),n]}hr.compress=Dw;function Bw(e,t){if(t==="o|")return{};const n={},r=t.split("|"),i=r[1];let s=ws(e,i);const o=r.length;o-2===1&&!Array.isArray(s)&&(s=[s]);for(let a=2;a<o;a++){const c=s[a-2];let l=r[a];l=ws(e,l),n[c]=l}return n}function Fw(e,t){if(t==="a|")return[];const n=t.split("|"),r=n.length-1,i=new Array(r);for(let s=0;s<r;s++){let o=n[s+1];o=ws(e,o),i[s]=o}return i}function ws(e,t){if(t===""||t==="_")return null;const n=(0,Wo.decodeKey)(t),r=e[n];if(r===null)return r;switch(typeof r){case"undefined":return r;case"number":return r;case"string":switch(r[0]+r[1]){case"b|":return(0,Wo.decodeBool)(r);case"o|":return Bw(e,r);case"n|":return(0,Wo.decodeNum)(r);case"a|":return Fw(e,r);default:return(0,Wo.decodeStr)(r)}}return(0,Pw.throwUnknownDataType)(r)}hr.decode=ws;function $w(e){const[t,n]=e;return ws(t,n)}hr.decompress=$w;var ji={};Object.defineProperty(ji,"__esModule",{value:!0}),ji.trimUndefinedRecursively=ji.trimUndefined=void 0;function jw(e){for(const t in e)e[t]===void 0&&delete e[t]}ji.trimUndefined=jw;function zw(e){Xh(e,new Set)}ji.trimUndefinedRecursively=zw;function Xh(e,t){t.add(e);for(const n in e)if(e[n]===void 0)delete e[n];else{const r=e[n];r&&typeof r=="object"&&!t.has(r)&&Xh(r,t)}}(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.config=e.trimUndefinedRecursively=e.trimUndefined=e.addValue=e.decode=e.decompress=e.compress=void 0;var t=hr;Object.defineProperty(e,"compress",{enumerable:!0,get:function(){return t.compress}}),Object.defineProperty(e,"decompress",{enumerable:!0,get:function(){return t.decompress}});var n=hr;Object.defineProperty(e,"decode",{enumerable:!0,get:function(){return n.decode}});var r=rn;Object.defineProperty(e,"addValue",{enumerable:!0,get:function(){return r.addValue}});var i=ji;Object.defineProperty(e,"trimUndefined",{enumerable:!0,get:function(){return i.trimUndefined}}),Object.defineProperty(e,"trimUndefinedRecursively",{enumerable:!0,get:function(){return i.trimUndefinedRecursively}});var s=_s;Object.defineProperty(e,"config",{enumerable:!0,get:function(){return s.config}})})($h);var fl;try{fl=new TextDecoder}catch{}var ie,dn,M=0,He={},Ie,Dr,pn=0,Fn=0,Tt,mr,qt=[],Te,Jh={useRecords:!1,mapsAsObjects:!0};class Zh{}const Yh=new Zh;Yh.name="MessagePack 0xC1";var Br=!1,Qh=2,ed;try{new Function("")}catch{Qh=1/0}class vs{constructor(t){t&&(t.useRecords===!1&&t.mapsAsObjects===void 0&&(t.mapsAsObjects=!0),t.sequential&&t.trusted!==!1&&(t.trusted=!0,!t.structures&&t.useRecords!=!1&&(t.structures=[],t.maxSharedStructures||(t.maxSharedStructures=0))),t.structures?t.structures.sharedLength=t.structures.length:t.getStructures&&((t.structures=[]).uninitialized=!0,t.structures.sharedLength=0),t.int64AsNumber&&(t.int64AsType="number")),Object.assign(this,t)}unpack(t,n){if(ie)return dd(()=>(gl(),this?this.unpack(t,n):vs.prototype.unpack.call(Jh,t,n)));!t.buffer&&t.constructor===ArrayBuffer&&(t=typeof Buffer<"u"?Buffer.from(t):new Uint8Array(t)),typeof n=="object"?(dn=n.end||t.length,M=n.start||0):(M=0,dn=n>-1?n:t.length),Fn=0,Dr=null,Tt=null,ie=t;try{Te=t.dataView||(t.dataView=new DataView(t.buffer,t.byteOffset,t.byteLength))}catch(r){throw ie=null,t instanceof Uint8Array?r:new Error("Source must be a Uint8Array or Buffer but was a "+(t&&typeof t=="object"?t.constructor.name:typeof t))}if(this instanceof vs){if(He=this,this.structures)return Ie=this.structures,Go(n);(!Ie||Ie.length>0)&&(Ie=[])}else He=Jh,(!Ie||Ie.length>0)&&(Ie=[]);return Go(n)}unpackMultiple(t,n){let r,i=0;try{Br=!0;let s=t.length,o=this?this.unpack(t,s):Ho.unpack(t,s);if(n){if(n(o,i,M)===!1)return;for(;M<s;)if(i=M,n(Go(),i,M)===!1)return}else{for(r=[o];M<s;)i=M,r.push(Go());return r}}catch(s){throw s.lastPosition=i,s.values=r,s}finally{Br=!1,gl()}}_mergeStructures(t,n){t=t||[],Object.isFrozen(t)&&(t=t.map(r=>r.slice(0)));for(let r=0,i=t.length;r<i;r++){let s=t[r];s&&(s.isShared=!0,r>=32&&(s.highByte=r-32>>5))}t.sharedLength=t.length;for(let r in n||[])if(r>=0){let i=t[r],s=n[r];s&&(i&&((t.restoreStructures||(t.restoreStructures=[]))[r]=i),t[r]=s)}return this.structures=t}decode(t,n){return this.unpack(t,n)}}function Go(e){try{if(!He.trusted&&!Br){let n=Ie.sharedLength||0;n<Ie.length&&(Ie.length=n)}let t;if(He.randomAccessStructure&&ie[M]<64&&ie[M]>=32&&ed?(t=ed(ie,M,dn,He),ie=null,!(e&&e.lazy)&&t&&(t=t.toJSON()),M=dn):t=lt(),Tt&&(M=Tt.postBundlePosition,Tt=null),Br&&(Ie.restoreStructures=null),M==dn)Ie&&Ie.restoreStructures&&td(),Ie=null,ie=null,mr&&(mr=null);else{if(M>dn)throw new Error("Unexpected end of MessagePack data");if(!Br){let n;try{n=JSON.stringify(t,(r,i)=>typeof i=="bigint"?`${i}n`:i).slice(0,100)}catch(r){n="(JSON view not available "+r+")"}throw new Error("Data read, but end of buffer not reached "+n)}}return t}catch(t){throw Ie&&Ie.restoreStructures&&td(),gl(),(t instanceof RangeError||t.message.startsWith("Unexpected end of buffer")||M>dn)&&(t.incomplete=!0),t}}function td(){for(let e in Ie.restoreStructures)Ie[e]=Ie.restoreStructures[e];Ie.restoreStructures=null}function lt(){let e=ie[M++];if(e<160)if(e<128){if(e<64)return e;{let t=Ie[e&63]||He.getStructures&&rd()[e&63];return t?(t.read||(t.read=hl(t,e&63)),t.read()):e}}else if(e<144)if(e-=128,He.mapsAsObjects){let t={};for(let n=0;n<e;n++){let r=ld();r==="__proto__"&&(r="__proto_"),t[r]=lt()}return t}else{let t=new Map;for(let n=0;n<e;n++)t.set(lt(),lt());return t}else{e-=144;let t=new Array(e);for(let n=0;n<e;n++)t[n]=lt();return He.freezeData?Object.freeze(t):t}else if(e<192){let t=e-160;if(Fn>=M)return Dr.slice(M-pn,(M+=t)-pn);if(Fn==0&&dn<140){let n=t<16?pl(t):od(t);if(n!=null)return n}return dl(t)}else{let t;switch(e){case 192:return null;case 193:return Tt?(t=lt(),t>0?Tt[1].slice(Tt.position1,Tt.position1+=t):Tt[0].slice(Tt.position0,Tt.position0-=t)):Yh;case 194:return!1;case 195:return!0;case 196:if(t=ie[M++],t===void 0)throw new Error("Unexpected end of buffer");return ml(t);case 197:return t=Te.getUint16(M),M+=2,ml(t);case 198:return t=Te.getUint32(M),M+=4,ml(t);case 199:return ci(ie[M++]);case 200:return t=Te.getUint16(M),M+=2,ci(t);case 201:return t=Te.getUint32(M),M+=4,ci(t);case 202:if(t=Te.getFloat32(M),He.useFloat32>2){let n=yl[(ie[M]&127)<<1|ie[M+1]>>7];return M+=4,(n*t+(t>0?.5:-.5)>>0)/n}return M+=4,t;case 203:return t=Te.getFloat64(M),M+=8,t;case 204:return ie[M++];case 205:return t=Te.getUint16(M),M+=2,t;case 206:return t=Te.getUint32(M),M+=4,t;case 207:return He.int64AsType==="number"?(t=Te.getUint32(M)*4294967296,t+=Te.getUint32(M+4)):He.int64AsType==="string"?t=Te.getBigUint64(M).toString():He.int64AsType==="auto"?(t=Te.getBigUint64(M),t<=BigInt(2)<<BigInt(52)&&(t=Number(t))):t=Te.getBigUint64(M),M+=8,t;case 208:return Te.getInt8(M++);case 209:return t=Te.getInt16(M),M+=2,t;case 210:return t=Te.getInt32(M),M+=4,t;case 211:return He.int64AsType==="number"?(t=Te.getInt32(M)*4294967296,t+=Te.getUint32(M+4)):He.int64AsType==="string"?t=Te.getBigInt64(M).toString():He.int64AsType==="auto"?(t=Te.getBigInt64(M),t>=BigInt(-2)<<BigInt(52)&&t<=BigInt(2)<<BigInt(52)&&(t=Number(t))):t=Te.getBigInt64(M),M+=8,t;case 212:if(t=ie[M++],t==114)return fd(ie[M++]&63);{let n=qt[t];if(n)return n.read?(M++,n.read(lt())):n.noBuffer?(M++,n()):n(ie.subarray(M,++M));throw new Error("Unknown extension "+t)}case 213:return t=ie[M],t==114?(M++,fd(ie[M++]&63,ie[M++])):ci(2);case 214:return ci(4);case 215:return ci(8);case 216:return ci(16);case 217:return t=ie[M++],Fn>=M?Dr.slice(M-pn,(M+=t)-pn):Gw(t);case 218:return t=Te.getUint16(M),M+=2,Fn>=M?Dr.slice(M-pn,(M+=t)-pn):Hw(t);case 219:return t=Te.getUint32(M),M+=4,Fn>=M?Dr.slice(M-pn,(M+=t)-pn):Vw(t);case 220:return t=Te.getUint16(M),M+=2,id(t);case 221:return t=Te.getUint32(M),M+=4,id(t);case 222:return t=Te.getUint16(M),M+=2,sd(t);case 223:return t=Te.getUint32(M),M+=4,sd(t);default:if(e>=224)return e-256;if(e===void 0){let n=new Error("Unexpected end of MessagePack data");throw n.incomplete=!0,n}throw new Error("Unknown MessagePack token "+e)}}}const Ww=/^[a-zA-Z_$][a-zA-Z\d_$]*$/;function hl(e,t){function n(){if(n.count++>Qh){let i=e.read=new Function("r","return function(){return "+(He.freezeData?"Object.freeze":"")+"({"+e.map(s=>s==="__proto__"?"__proto_:r()":Ww.test(s)?s+":r()":"["+JSON.stringify(s)+"]:r()").join(",")+"})}")(lt);return e.highByte===0&&(e.read=nd(t,e.read)),i()}let r={};for(let i=0,s=e.length;i<s;i++){let o=e[i];o==="__proto__"&&(o="__proto_"),r[o]=lt()}return He.freezeData?Object.freeze(r):r}return n.count=0,e.highByte===0?nd(t,n):n}const nd=(e,t)=>function(){let n=ie[M++];if(n===0)return t();let r=e<32?-(e+(n<<5)):e+(n<<5),i=Ie[r]||rd()[r];if(!i)throw new Error("Record id is not defined for "+r);return i.read||(i.read=hl(i,e)),i.read()};function rd(){let e=dd(()=>(ie=null,He.getStructures()));return Ie=He._mergeStructures(e,Ie)}var dl=Es,Gw=Es,Hw=Es,Vw=Es;function Es(e){let t;if(e<16&&(t=pl(e)))return t;if(e>64&&fl)return fl.decode(ie.subarray(M,M+=e));const n=M+e,r=[];for(t="";M<n;){const i=ie[M++];if(!(i&128))r.push(i);else if((i&224)===192){const s=ie[M++]&63;r.push((i&31)<<6|s)}else if((i&240)===224){const s=ie[M++]&63,o=ie[M++]&63;r.push((i&31)<<12|s<<6|o)}else if((i&248)===240){const s=ie[M++]&63,o=ie[M++]&63,a=ie[M++]&63;let c=(i&7)<<18|s<<12|o<<6|a;c>65535&&(c-=65536,r.push(c>>>10&1023|55296),c=56320|c&1023),r.push(c)}else r.push(i);r.length>=4096&&(t+=xt.apply(String,r),r.length=0)}return r.length>0&&(t+=xt.apply(String,r)),t}function id(e){let t=new Array(e);for(let n=0;n<e;n++)t[n]=lt();return He.freezeData?Object.freeze(t):t}function sd(e){if(He.mapsAsObjects){let t={};for(let n=0;n<e;n++){let r=ld();r==="__proto__"&&(r="__proto_"),t[r]=lt()}return t}else{let t=new Map;for(let n=0;n<e;n++)t.set(lt(),lt());return t}}var xt=String.fromCharCode;function od(e){let t=M,n=new Array(e);for(let r=0;r<e;r++){const i=ie[M++];if((i&128)>0){M=t;return}n[r]=i}return xt.apply(String,n)}function pl(e){if(e<4)if(e<2){if(e===0)return"";{let t=ie[M++];if((t&128)>1){M-=1;return}return xt(t)}}else{let t=ie[M++],n=ie[M++];if((t&128)>0||(n&128)>0){M-=2;return}if(e<3)return xt(t,n);let r=ie[M++];if((r&128)>0){M-=3;return}return xt(t,n,r)}else{let t=ie[M++],n=ie[M++],r=ie[M++],i=ie[M++];if((t&128)>0||(n&128)>0||(r&128)>0||(i&128)>0){M-=4;return}if(e<6){if(e===4)return xt(t,n,r,i);{let s=ie[M++];if((s&128)>0){M-=5;return}return xt(t,n,r,i,s)}}else if(e<8){let s=ie[M++],o=ie[M++];if((s&128)>0||(o&128)>0){M-=6;return}if(e<7)return xt(t,n,r,i,s,o);let a=ie[M++];if((a&128)>0){M-=7;return}return xt(t,n,r,i,s,o,a)}else{let s=ie[M++],o=ie[M++],a=ie[M++],c=ie[M++];if((s&128)>0||(o&128)>0||(a&128)>0||(c&128)>0){M-=8;return}if(e<10){if(e===8)return xt(t,n,r,i,s,o,a,c);{let l=ie[M++];if((l&128)>0){M-=9;return}return xt(t,n,r,i,s,o,a,c,l)}}else if(e<12){let l=ie[M++],u=ie[M++];if((l&128)>0||(u&128)>0){M-=10;return}if(e<11)return xt(t,n,r,i,s,o,a,c,l,u);let f=ie[M++];if((f&128)>0){M-=11;return}return xt(t,n,r,i,s,o,a,c,l,u,f)}else{let l=ie[M++],u=ie[M++],f=ie[M++],d=ie[M++];if((l&128)>0||(u&128)>0||(f&128)>0||(d&128)>0){M-=12;return}if(e<14){if(e===12)return xt(t,n,r,i,s,o,a,c,l,u,f,d);{let h=ie[M++];if((h&128)>0){M-=13;return}return xt(t,n,r,i,s,o,a,c,l,u,f,d,h)}}else{let h=ie[M++],p=ie[M++];if((h&128)>0||(p&128)>0){M-=14;return}if(e<15)return xt(t,n,r,i,s,o,a,c,l,u,f,d,h,p);let m=ie[M++];if((m&128)>0){M-=15;return}return xt(t,n,r,i,s,o,a,c,l,u,f,d,h,p,m)}}}}}function ad(){let e=ie[M++],t;if(e<192)t=e-160;else switch(e){case 217:t=ie[M++];break;case 218:t=Te.getUint16(M),M+=2;break;case 219:t=Te.getUint32(M),M+=4;break;default:throw new Error("Expected string")}return Es(t)}function ml(e){return He.copyBuffers?Uint8Array.prototype.slice.call(ie,M,M+=e):ie.subarray(M,M+=e)}function ci(e){let t=ie[M++];if(qt[t]){let n;return qt[t](ie.subarray(M,n=M+=e),r=>{M=r;try{return lt()}finally{M=n}})}else throw new Error("Unknown extension type "+t)}var cd=new Array(4096);function ld(){let e=ie[M++];if(e>=160&&e<192){if(e=e-160,Fn>=M)return Dr.slice(M-pn,(M+=e)-pn);if(!(Fn==0&&dn<180))return dl(e)}else return M--,ud(lt());let t=(e<<5^(e>1?Te.getUint16(M):e>0?ie[M]:0))&4095,n=cd[t],r=M,i=M+e-3,s,o=0;if(n&&n.bytes==e){for(;r<i;){if(s=Te.getUint32(r),s!=n[o++]){r=1879048192;break}r+=4}for(i+=3;r<i;)if(s=ie[r++],s!=n[o++]){r=1879048192;break}if(r===i)return M=r,n.string;i-=3,r=M}for(n=[],cd[t]=n,n.bytes=e;r<i;)s=Te.getUint32(r),n.push(s),r+=4;for(i+=3;r<i;)s=ie[r++],n.push(s);let a=e<16?pl(e):od(e);return a!=null?n.string=a:n.string=dl(e)}function ud(e){if(typeof e=="string")return e;if(typeof e=="number"||typeof e=="boolean"||typeof e=="bigint")return e.toString();if(e==null)return e+"";throw new Error("Invalid property type for record",typeof e)}const fd=(e,t)=>{let n=lt().map(ud),r=e;t!==void 0&&(e=e<32?-((t<<5)+e):(t<<5)+e,n.highByte=t);let i=Ie[e];return i&&(i.isShared||Br)&&((Ie.restoreStructures||(Ie.restoreStructures=[]))[e]=i),Ie[e]=n,n.read=hl(n,r),n.read()};qt[0]=()=>{},qt[0].noBuffer=!0,qt[66]=e=>{let t=e.length,n=BigInt(e[0]&128?e[0]-256:e[0]);for(let r=1;r<t;r++)n<<=BigInt(8),n+=BigInt(e[r]);return n};let Kw={Error,TypeError,ReferenceError};qt[101]=()=>{let e=lt();return(Kw[e[0]]||Error)(e[1],{cause:e[2]})},qt[105]=e=>{if(He.structuredClone===!1)throw new Error("Structured clone extension is disabled");let t=Te.getUint32(M-4);mr||(mr=new Map);let n=ie[M],r;n>=144&&n<160||n==220||n==221?r=[]:r={};let i={target:r};mr.set(t,i);let s=lt();return i.used?Object.assign(r,s):(i.target=s,s)},qt[112]=e=>{if(He.structuredClone===!1)throw new Error("Structured clone extension is disabled");let t=Te.getUint32(M-4),n=mr.get(t);return n.used=!0,n.target},qt[115]=()=>new Set(lt());const hd=["Int8","Uint8","Uint8Clamped","Int16","Uint16","Int32","Uint32","Float32","Float64","BigInt64","BigUint64"].map(e=>e+"Array");let qw=typeof globalThis=="object"?globalThis:window;qt[116]=e=>{let t=e[0],n=hd[t];if(!n){if(t===16){let r=new ArrayBuffer(e.length-1);return new Uint8Array(r).set(e.subarray(1)),r}throw new Error("Could not find typed array for code "+t)}return new qw[n](Uint8Array.prototype.slice.call(e,1).buffer)},qt[120]=()=>{let e=lt();return new RegExp(e[0],e[1])};const Xw=[];qt[98]=e=>{let t=(e[0]<<24)+(e[1]<<16)+(e[2]<<8)+e[3],n=M;return M+=t-e.length,Tt=Xw,Tt=[ad(),ad()],Tt.position0=0,Tt.position1=0,Tt.postBundlePosition=M,M=n,lt()},qt[255]=e=>e.length==4?new Date((e[0]*16777216+(e[1]<<16)+(e[2]<<8)+e[3])*1e3):e.length==8?new Date(((e[0]<<22)+(e[1]<<14)+(e[2]<<6)+(e[3]>>2))/1e6+((e[3]&3)*4294967296+e[4]*16777216+(e[5]<<16)+(e[6]<<8)+e[7])*1e3):e.length==12?new Date(((e[0]<<24)+(e[1]<<16)+(e[2]<<8)+e[3])/1e6+((e[4]&128?-281474976710656:0)+e[6]*1099511627776+e[7]*4294967296+e[8]*16777216+(e[9]<<16)+(e[10]<<8)+e[11])*1e3):new Date("invalid");function dd(e){let t=dn,n=M,r=pn,i=Fn,s=Dr,o=mr,a=Tt,c=new Uint8Array(ie.slice(0,dn)),l=Ie,u=Ie.slice(0,Ie.length),f=He,d=Br,h=e();return dn=t,M=n,pn=r,Fn=i,Dr=s,mr=o,Tt=a,ie=c,Br=d,Ie=l,Ie.splice(0,Ie.length,...u),He=f,Te=new DataView(ie.buffer,ie.byteOffset,ie.byteLength),h}function gl(){ie=null,mr=null,Ie=null}const yl=new Array(147);for(let e=0;e<256;e++)yl[e]=+("1e"+Math.floor(45.15-e*.30103));var Ho=new vs({useRecords:!1});const Jw=Ho.unpack;Ho.unpackMultiple,Ho.unpack;let Zw=new Float32Array(1);new Uint8Array(Zw.buffer,0,4);let Vo;try{Vo=new TextEncoder}catch{}let _l,pd;const Ko=typeof Buffer<"u",qo=Ko?function(e){return Buffer.allocUnsafeSlow(e)}:Uint8Array,md=Ko?Buffer:Uint8Array,gd=Ko?4294967296:2144337920;let j,ks,Ve,U=0,jt,et=null,Yw;const Qw=21760,ev=/[\u0080-\uFFFF]/,zi=Symbol("record-id");class tv extends vs{constructor(t){super(t),this.offset=0;let n,r,i,s,o=md.prototype.utf8Write?function(E,g){return j.utf8Write(E,g,j.byteLength-g)}:Vo&&Vo.encodeInto?function(E,g){return Vo.encodeInto(E,j.subarray(g)).written}:!1,a=this;t||(t={});let c=t&&t.sequential,l=t.structures||t.saveStructures,u=t.maxSharedStructures;if(u==null&&(u=l?32:0),u>8160)throw new Error("Maximum maxSharedStructure is 8160");t.structuredClone&&t.moreTypes==null&&(this.moreTypes=!0);let f=t.maxOwnStructures;f==null&&(f=l?32:64),!this.structures&&t.useRecords!=!1&&(this.structures=[]);let d=u>32||f+u>64,h=u+64,p=u+f+64;if(p>8256)throw new Error("Maximum maxSharedStructure + maxOwnStructure is 8192");let m=[],b=0,_=0;this.pack=this.encode=function(E,g){if(j||(j=new qo(8192),Ve=j.dataView||(j.dataView=new DataView(j.buffer,0,8192)),U=0),jt=j.length-10,jt-U<2048?(j=new qo(j.length),Ve=j.dataView||(j.dataView=new DataView(j.buffer,0,j.length)),jt=j.length-10,U=0):U=U+7&2147483640,n=U,g&cv&&(U+=g&255),s=a.structuredClone?new Map:null,a.bundleStrings&&typeof E!="string"?(et=[],et.size=1/0):et=null,i=a.structures,i){i.uninitialized&&(i=a._mergeStructures(a.getStructures()));let W=i.sharedLength||0;if(W>u)throw new Error("Shared structures is larger than maximum shared structures, try increasing maxSharedStructures to "+i.sharedLength);if(!i.transitions){i.transitions=Object.create(null);for(let B=0;B<W;B++){let Z=i[B];if(!Z)continue;let H,Y=i.transitions;for(let $=0,F=Z.length;$<F;$++){let ue=Z[$];H=Y[ue],H||(H=Y[ue]=Object.create(null)),Y=H}Y[zi]=B+64}this.lastNamedStructuresLength=W}c||(i.nextId=W+64)}r&&(r=!1);let N;try{a.randomAccessStructure&&E&&E.constructor&&E.constructor===Object?O(E):k(E);let W=et;if(et&&bd(n,k,0),s&&s.idsToInsert){let B=s.idsToInsert.sort(($,F)=>$.offset>F.offset?1:-1),Z=B.length,H=-1;for(;W&&Z>0;){let $=B[--Z].offset+n;$<W.stringsPosition+n&&H===-1&&(H=0),$>W.position+n?H>=0&&(H+=6):(H>=0&&(Ve.setUint32(W.position+n,Ve.getUint32(W.position+n)+H),H=-1),W=W.previous,Z++)}H>=0&&W&&Ve.setUint32(W.position+n,Ve.getUint32(W.position+n)+H),U+=B.length*6,U>jt&&x(U),a.offset=U;let Y=rv(j.subarray(n,U),B);return s=null,Y}return a.offset=U,g&ov?(j.start=n,j.end=U,j):j.subarray(n,U)}catch(W){throw N=W,W}finally{if(i&&(w(),r&&a.saveStructures)){let W=i.sharedLength||0,B=j.subarray(n,U),Z=iv(i,a);if(!N)return a.saveStructures(Z,Z.isCompatible)===!1?a.pack(E,g):(a.lastNamedStructuresLength=W,j.length>1073741824&&(j=null),B)}j.length>1073741824&&(j=null),g&av&&(U=n)}};const w=()=>{_<10&&_++;let E=i.sharedLength||0;if(i.length>E&&!c&&(i.length=E),b>1e4)i.transitions=null,_=0,b=0,m.length>0&&(m=[]);else if(m.length>0&&!c){for(let g=0,N=m.length;g<N;g++)m[g][zi]=0;m=[]}},v=E=>{var g=E.length;g<16?j[U++]=144|g:g<65536?(j[U++]=220,j[U++]=g>>8,j[U++]=g&255):(j[U++]=221,Ve.setUint32(U,g),U+=4);for(let N=0;N<g;N++)k(E[N])},k=E=>{U>jt&&(j=x(U));var g=typeof E,N;if(g==="string"){let W=E.length;if(et&&W>=4&&W<4096){if((et.size+=W)>Qw){let Y,$=(et[0]?et[0].length*3+et[1].length:0)+10;U+$>jt&&(j=x(U+$));let F;et.position?(F=et,j[U]=200,U+=3,j[U++]=98,Y=U-n,U+=4,bd(n,k,0),Ve.setUint16(Y+n-3,U-n-Y)):(j[U++]=214,j[U++]=98,Y=U-n,U+=4),et=["",""],et.previous=F,et.size=0,et.position=Y}let H=ev.test(E);et[H?0:1]+=E,j[U++]=193,k(H?-W:W);return}let B;W<32?B=1:W<256?B=2:W<65536?B=3:B=5;let Z=W*3;if(U+Z>jt&&(j=x(U+Z)),W<64||!o){let H,Y,$,F=U+B;for(H=0;H<W;H++)Y=E.charCodeAt(H),Y<128?j[F++]=Y:Y<2048?(j[F++]=Y>>6|192,j[F++]=Y&63|128):(Y&64512)===55296&&(($=E.charCodeAt(H+1))&64512)===56320?(Y=65536+((Y&1023)<<10)+($&1023),H++,j[F++]=Y>>18|240,j[F++]=Y>>12&63|128,j[F++]=Y>>6&63|128,j[F++]=Y&63|128):(j[F++]=Y>>12|224,j[F++]=Y>>6&63|128,j[F++]=Y&63|128);N=F-U-B}else N=o(E,U+B);N<32?j[U++]=160|N:N<256?(B<2&&j.copyWithin(U+2,U+1,U+1+N),j[U++]=217,j[U++]=N):N<65536?(B<3&&j.copyWithin(U+3,U+2,U+2+N),j[U++]=218,j[U++]=N>>8,j[U++]=N&255):(B<5&&j.copyWithin(U+5,U+3,U+3+N),j[U++]=219,Ve.setUint32(U,N),U+=4),U+=N}else if(g==="number")if(E>>>0===E)E<32||E<128&&this.useRecords===!1||E<64&&!this.randomAccessStructure?j[U++]=E:E<256?(j[U++]=204,j[U++]=E):E<65536?(j[U++]=205,j[U++]=E>>8,j[U++]=E&255):(j[U++]=206,Ve.setUint32(U,E),U+=4);else if(E>>0===E)E>=-32?j[U++]=256+E:E>=-128?(j[U++]=208,j[U++]=E+256):E>=-32768?(j[U++]=209,Ve.setInt16(U,E),U+=2):(j[U++]=210,Ve.setInt32(U,E),U+=4);else{let W;if((W=this.useFloat32)>0&&E<4294967296&&E>=-2147483648){j[U++]=202,Ve.setFloat32(U,E);let B;if(W<4||(B=E*yl[(j[U]&127)<<1|j[U+1]>>7])>>0===B){U+=4;return}else U--}j[U++]=203,Ve.setFloat64(U,E),U+=8}else if(g==="object"||g==="function")if(!E)j[U++]=192;else{if(s){let B=s.get(E);if(B){if(!B.id){let Z=s.idsToInsert||(s.idsToInsert=[]);B.id=Z.push(B)}j[U++]=214,j[U++]=112,Ve.setUint32(U,B.id),U+=4;return}else s.set(E,{offset:U-n})}let W=E.constructor;if(W===Object)L(E);else if(W===Array)v(E);else if(W===Map)if(this.mapAsEmptyObject)j[U++]=128;else{N=E.size,N<16?j[U++]=128|N:N<65536?(j[U++]=222,j[U++]=N>>8,j[U++]=N&255):(j[U++]=223,Ve.setUint32(U,N),U+=4);for(let[B,Z]of E)k(B),k(Z)}else{for(let B=0,Z=_l.length;B<Z;B++){let H=pd[B];if(E instanceof H){let Y=_l[B];if(Y.write){Y.type&&(j[U++]=212,j[U++]=Y.type,j[U++]=0);let ee=Y.write.call(this,E);ee===E?Array.isArray(E)?v(E):L(E):k(ee);return}let $=j,F=Ve,ue=U;j=null;let Q;try{Q=Y.pack.call(this,E,ee=>(j=$,$=null,U+=ee,U>jt&&x(U),{target:j,targetView:Ve,position:U-ee}),k)}finally{$&&(j=$,Ve=F,U=ue,jt=j.length-10)}Q&&(Q.length+U>jt&&x(Q.length+U),U=nv(Q,j,U,Y.type));return}}if(Array.isArray(E))v(E);else{if(E.toJSON){const B=E.toJSON();if(B!==E)return k(B)}if(g==="function")return k(this.writeFunction&&this.writeFunction(E));L(E)}}}else if(g==="boolean")j[U++]=E?195:194;else if(g==="bigint"){if(E<BigInt(1)<<BigInt(63)&&E>=-(BigInt(1)<<BigInt(63)))j[U++]=211,Ve.setBigInt64(U,E);else if(E<BigInt(1)<<BigInt(64)&&E>0)j[U++]=207,Ve.setBigUint64(U,E);else if(this.largeBigIntToFloat)j[U++]=203,Ve.setFloat64(U,Number(E));else{if(this.largeBigIntToString)return k(E.toString());if(this.useBigIntExtension&&E<BigInt(2)**BigInt(1023)&&E>-(BigInt(2)**BigInt(1023))){j[U++]=199,U++,j[U++]=66;let W=[],B;do{let Z=E&BigInt(255);B=(Z&BigInt(128))===(E<BigInt(0)?BigInt(128):BigInt(0)),W.push(Z),E>>=BigInt(8)}while(!((E===BigInt(0)||E===BigInt(-1))&&B));j[U-2]=W.length;for(let Z=W.length;Z>0;)j[U++]=Number(W[--Z]);return}else throw new RangeError(E+" was too large to fit in MessagePack 64-bit integer format, use useBigIntExtension, or set largeBigIntToFloat to convert to float-64, or set largeBigIntToString to convert to string")}U+=8}else if(g==="undefined")this.encodeUndefinedAsNil?j[U++]=192:(j[U++]=212,j[U++]=0,j[U++]=0);else throw new Error("Unknown type: "+g)},C=this.variableMapSize||this.coercibleKeyAsNumber||this.skipValues?E=>{let g;if(this.skipValues){g=[];for(let B in E)(typeof E.hasOwnProperty!="function"||E.hasOwnProperty(B))&&!this.skipValues.includes(E[B])&&g.push(B)}else g=Object.keys(E);let N=g.length;N<16?j[U++]=128|N:N<65536?(j[U++]=222,j[U++]=N>>8,j[U++]=N&255):(j[U++]=223,Ve.setUint32(U,N),U+=4);let W;if(this.coercibleKeyAsNumber)for(let B=0;B<N;B++){W=g[B];let Z=Number(W);k(isNaN(Z)?W:Z),k(E[W])}else for(let B=0;B<N;B++)k(W=g[B]),k(E[W])}:E=>{j[U++]=222;let g=U-n;U+=2;let N=0;for(let W in E)(typeof E.hasOwnProperty!="function"||E.hasOwnProperty(W))&&(k(W),k(E[W]),N++);if(N>65535)throw new Error('Object is too large to serialize with fast 16-bit map size, use the "variableMapSize" option to serialize this object');j[g+++n]=N>>8,j[g+n]=N&255},I=this.useRecords===!1?C:t.progressiveRecords&&!d?E=>{let g,N=i.transitions||(i.transitions=Object.create(null)),W=U++-n,B;for(let Z in E)if(typeof E.hasOwnProperty!="function"||E.hasOwnProperty(Z)){if(g=N[Z],g)N=g;else{let H=Object.keys(E),Y=N;N=i.transitions;let $=0;for(let F=0,ue=H.length;F<ue;F++){let Q=H[F];g=N[Q],g||(g=N[Q]=Object.create(null),$++),N=g}W+n+1==U?(U--,V(N,H,$)):se(N,H,W,$),B=!0,N=Y[Z]}k(E[Z])}if(!B){let Z=N[zi];Z?j[W+n]=Z:se(N,Object.keys(E),W,0)}}:E=>{let g,N=i.transitions||(i.transitions=Object.create(null)),W=0;for(let Z in E)(typeof E.hasOwnProperty!="function"||E.hasOwnProperty(Z))&&(g=N[Z],g||(g=N[Z]=Object.create(null),W++),N=g);let B=N[zi];B?B>=96&&d?(j[U++]=((B-=96)&31)+96,j[U++]=B>>5):j[U++]=B:V(N,N.__keys__||Object.keys(E),W);for(let Z in E)(typeof E.hasOwnProperty!="function"||E.hasOwnProperty(Z))&&k(E[Z])},T=typeof this.useRecords=="function"&&this.useRecords,L=T?E=>{T(E)?I(E):C(E)}:I,x=E=>{let g;if(E>16777216){if(E-n>gd)throw new Error("Packed buffer would be larger than maximum buffer size");g=Math.min(gd,Math.round(Math.max((E-n)*(E>67108864?1.25:2),4194304)/4096)*4096)}else g=(Math.max(E-n<<2,j.length-1)>>12)+1<<12;let N=new qo(g);return Ve=N.dataView||(N.dataView=new DataView(N.buffer,0,g)),E=Math.min(E,j.length),j.copy?j.copy(N,0,n,E):N.set(j.slice(n,E)),U-=n,n=0,jt=N.length-10,j=N},V=(E,g,N)=>{let W=i.nextId;W||(W=64),W<h&&this.shouldShareStructure&&!this.shouldShareStructure(g)?(W=i.nextOwnId,W<p||(W=h),i.nextOwnId=W+1):(W>=p&&(W=h),i.nextId=W+1);let B=g.highByte=W>=96&&d?W-96>>5:-1;E[zi]=W,E.__keys__=g,i[W-64]=g,W<h?(g.isShared=!0,i.sharedLength=W-63,r=!0,B>=0?(j[U++]=(W&31)+96,j[U++]=B):j[U++]=W):(B>=0?(j[U++]=213,j[U++]=114,j[U++]=(W&31)+96,j[U++]=B):(j[U++]=212,j[U++]=114,j[U++]=W),N&&(b+=_*N),m.length>=f&&(m.shift()[zi]=0),m.push(E),k(g))},se=(E,g,N,W)=>{let B=j,Z=U,H=jt,Y=n;j=ks,U=0,n=0,j||(ks=j=new qo(8192)),jt=j.length-10,V(E,g,W),ks=j;let $=U;if(j=B,U=Z,jt=H,n=Y,$>1){let F=U+$-1;F>jt&&x(F);let ue=N+n;j.copyWithin(ue+$,ue+1,U),j.set(ks.slice(0,$),ue),U=F}else j[N+n]=ks[0]},O=E=>{let g=Yw(E,j,n,U,i,x,(N,W,B)=>{if(B)return r=!0;U=W;let Z=j;return k(N),w(),Z!==j?{position:U,targetView:Ve,target:j}:U},this);if(g===0)return L(E);U=g}}useBuffer(t){j=t,j.dataView||(j.dataView=new DataView(j.buffer,j.byteOffset,j.byteLength)),U=0}set position(t){U=t}get position(){return U}clearSharedData(){this.structures&&(this.structures=[]),this.typedStructs&&(this.typedStructs=[])}}pd=[Date,Set,Error,RegExp,ArrayBuffer,Object.getPrototypeOf(Uint8Array.prototype).constructor,Zh],_l=[{pack(e,t,n){let r=e.getTime()/1e3;if((this.useTimestamp32||e.getMilliseconds()===0)&&r>=0&&r<4294967296){let{target:i,targetView:s,position:o}=t(6);i[o++]=214,i[o++]=255,s.setUint32(o,r)}else if(r>0&&r<4294967296){let{target:i,targetView:s,position:o}=t(10);i[o++]=215,i[o++]=255,s.setUint32(o,e.getMilliseconds()*4e6+(r/1e3/4294967296>>0)),s.setUint32(o+4,r)}else if(isNaN(r)){if(this.onInvalidDate)return t(0),n(this.onInvalidDate());let{target:i,targetView:s,position:o}=t(3);i[o++]=212,i[o++]=255,i[o++]=255}else{let{target:i,targetView:s,position:o}=t(15);i[o++]=199,i[o++]=12,i[o++]=255,s.setUint32(o,e.getMilliseconds()*1e6),s.setBigInt64(o+4,BigInt(Math.floor(r)))}}},{pack(e,t,n){if(this.setAsEmptyObject)return t(0),n({});let r=Array.from(e),{target:i,position:s}=t(this.moreTypes?3:0);this.moreTypes&&(i[s++]=212,i[s++]=115,i[s++]=0),n(r)}},{pack(e,t,n){let{target:r,position:i}=t(this.moreTypes?3:0);this.moreTypes&&(r[i++]=212,r[i++]=101,r[i++]=0),n([e.name,e.message,e.cause])}},{pack(e,t,n){let{target:r,position:i}=t(this.moreTypes?3:0);this.moreTypes&&(r[i++]=212,r[i++]=120,r[i++]=0),n([e.source,e.flags])}},{pack(e,t){this.moreTypes?yd(e,16,t):_d(Ko?Buffer.from(e):new Uint8Array(e),t)}},{pack(e,t){let n=e.constructor;n!==md&&this.moreTypes?yd(e,hd.indexOf(n.name),t):_d(e,t)}},{pack(e,t){let{target:n,position:r}=t(1);n[r]=193}}];function yd(e,t,n,r){let i=e.byteLength;if(i+1<256){var{target:s,position:o}=n(4+i);s[o++]=199,s[o++]=i+1}else if(i+1<65536){var{target:s,position:o}=n(5+i);s[o++]=200,s[o++]=i+1>>8,s[o++]=i+1&255}else{var{target:s,position:o,targetView:a}=n(7+i);s[o++]=201,a.setUint32(o,i+1),o+=4}s[o++]=116,s[o++]=t,e.buffer||(e=new Uint8Array(e)),s.set(new Uint8Array(e.buffer,e.byteOffset,e.byteLength),o)}function _d(e,t){let n=e.byteLength;var r,i;if(n<256){var{target:r,position:i}=t(n+2);r[i++]=196,r[i++]=n}else if(n<65536){var{target:r,position:i}=t(n+3);r[i++]=197,r[i++]=n>>8,r[i++]=n&255}else{var{target:r,position:i,targetView:s}=t(n+5);r[i++]=198,s.setUint32(i,n),i+=4}r.set(e,i)}function nv(e,t,n,r){let i=e.length;switch(i){case 1:t[n++]=212;break;case 2:t[n++]=213;break;case 4:t[n++]=214;break;case 8:t[n++]=215;break;case 16:t[n++]=216;break;default:i<256?(t[n++]=199,t[n++]=i):i<65536?(t[n++]=200,t[n++]=i>>8,t[n++]=i&255):(t[n++]=201,t[n++]=i>>24,t[n++]=i>>16&255,t[n++]=i>>8&255,t[n++]=i&255)}return t[n++]=r,t.set(e,n),n+=i,n}function rv(e,t){let n,r=t.length*6,i=e.length-r;for(;n=t.pop();){let s=n.offset,o=n.id;e.copyWithin(s+r,s,i),r-=6;let a=s+r;e[a++]=214,e[a++]=105,e[a++]=o>>24,e[a++]=o>>16&255,e[a++]=o>>8&255,e[a++]=o&255,i=s}return e}function bd(e,t,n){if(et.length>0){Ve.setUint32(et.position+e,U+n-et.position-e),et.stringsPosition=U-e;let r=et;et=null,t(r[0]),t(r[1])}}function iv(e,t){return e.isCompatible=n=>{let r=!n||(t.lastNamedStructuresLength||0)===n.length;return r||t._mergeStructures(n),r},e}let wd=new tv({useRecords:!1});const sv=wd.pack;wd.pack;const ov=512,av=1024,cv=2048;function li(){return null}function Ss(e,t,n={}){if(!S(e))return;const r=[],i=Object.keys(e);for(let s=0;s<i.length;++s){let o=i[s],a=e[o];const c=n[o];S(c)&&(a=c(a));const l=t[o];S(l)&&(o=l),a!==null&&r.push(o,a)}return r}function As(e,t,n={}){if(S(e))try{const r={};for(let i=0;i<e.length;i+=2){let s=e[i],o=e[i+1];const a=t[s];S(a)&&(s=a);const c=n[s];S(c)&&(o=c(o)),r[s]=o}return r}catch(r){Qe("format","binary",r.message)}}function lv(e){try{const t=ys(e);return $h.trimUndefinedRecursively(t),sv(t)}catch(t){Qe("format","binary",t.message)}}function uv(e){try{return Jw(e)}catch(t){Qe("format","binary",t.message)}}function vd(){return{id:gt()}}var bl=(e=>(e[e.kind=0]="kind",e[e.id=1]="id",e[e.x=2]="x",e[e.y=3]="y",e[e.lx=4]="lx",e[e.ly=5]="ly",e[e.code=6]="code",e[e.name=7]="name",e[e.char=8]="char",e[e.color=9]="color",e[e.bg=10]="bg",e[e.player=11]="player",e[e.bucket=12]="bucket",e[e.pushable=13]="pushable",e[e.collision=14]="collision",e[e.destructible=15]="destructible",e[e.tickertext=16]="tickertext",e[e.tickertime=17]="tickertime",e[e.p1=18]="p1",e[e.p2=19]="p2",e[e.p3=20]="p3",e[e.cycle=21]="cycle",e[e.stepx=22]="stepx",e[e.stepy=23]="stepy",e[e.sender=24]="sender",e[e.arg=25]="arg",e[e.headless=26]="headless",e[e.removed=27]="removed",e))(bl||{});function Xo(e){return Ss(e,bl,{category:li,kinddata:li})}function Jo(e){return As(e,bl)}function fv(){return new Array(Ge*hn).map(()=>{})}function hv(e=nw){const t={terrain:fv(),objects:{},id:""};return e(t)}var wl=(e=>(e[e.terrain=0]="terrain",e[e.objects=1]="objects",e[e.isdark=2]="isdark",e[e.over=3]="over",e[e.under=4]="under",e[e.exitnorth=5]="exitnorth",e[e.exitsouth=6]="exitsouth",e[e.exitwest=7]="exitwest",e[e.exiteast=8]="exiteast",e[e.timelimit=9]="timelimit",e[e.restartonzap=10]="restartonzap",e[e.maxplayershots=11]="maxplayershots",e))(wl||{});function dv(e){return Ss(e,wl,{terrain:t=>t.map(Xo),objects:t=>Object.values(t).map(Xo),id:li,named:li,lookup:li,codepage:li})}function pv(e){return As(e,wl,{terrain:t=>t.map(Jo),objects:t=>{const n={};for(let r=0;r<t.length;++r){const i=Jo(t[r]);S(i==null?void 0:i.id)&&(n[i.id]=i)}return n}})}function vl(e){var t;return Pe((e==null?void 0:e.name)??((t=e==null?void 0:e.kinddata)==null?void 0:t.name)??"object")}function mv(e){var t;return(e==null?void 0:e.color)??((t=e==null?void 0:e.kinddata)==null?void 0:t.color)??be.BLACK}function gv(e){var t;return(e==null?void 0:e.bg)??((t=e==null?void 0:e.kinddata)==null?void 0:t.bg)??be.BLACK}function Zo(e,t){if(!S(e)||!fn(t))return;const{color:n,bg:r}=bw(t);S(n)&&(e.color=n),S(r)&&(e.bg=r)}function yv(e,t){if(!S(e)||!S(t)||!S(t.x)||!S(t.y)||t.x<0||t.x>=Ge||t.y<0||t.y>=hn)return;const n={...t},r=t.x+t.y*Ge;return e.terrain[r]=n,t}function _v(e,t){if(!S(e)||!S(t))return;const n={...t,id:t.id??gt()};return e.objects[n.id]=n,n}function Ed(e,t,n){return yv(e,{...t,kind:n})}function El(e,t,n,r){return _v(e,{...t,id:r??void 0,kind:n})}function Yo(e,t){if(e)return e.objects[t]}function kl(e,t,n,r,i){if(!S(e)||!S(t))return{x:0,y:0};const s={x:t.x??0,y:t.y??0},o={x:t.lx??s.x,y:t.ly??s.y},a=Bi(o,s),c=Ge-1,l=hn-1;for(let u=0;u<r.length;++u){const f=pw(r[u]);switch(f){case oe.IDLE:break;case oe.NORTH:case oe.SOUTH:case oe.WEST:case oe.EAST:At(s,f);break;case oe.BY:{const[d,h]=r.slice(u+1);ke(d)&&ke(h)&&(s.x=si(s.x+d,0,c),s.y=si(s.y+h,0,l)),u+=2;break}case oe.AT:{const[d,h]=r.slice(u+1);ke(d)&&ke(h)&&(s.x=si(d,0,c),s.y=si(h,0,l)),u+=2;break}case oe.FLOW:At(s,a);break;case oe.SEEK:{const d=bv(e,t,n);ur(d)&&At(s,Bi(i,d));break}case oe.RNDNS:At(s,lr(oe.NORTH,oe.SOUTH));break;case oe.RNDNE:At(s,lr(oe.NORTH,oe.EAST));break;case oe.RND:At(s,lr(oe.NORTH,oe.SOUTH,oe.WEST,oe.EAST));break;case oe.CW:case oe.CCW:case oe.OPP:case oe.RNDP:{const d=kl(e,t,n,r.slice(u+1),i);switch(s.x=i.x,s.y=i.y,f){case oe.CW:switch(Bi(i,d)){case oe.NORTH:At(s,oe.EAST);break;case oe.SOUTH:At(s,oe.WEST);break;case oe.EAST:At(s,oe.SOUTH);break;case oe.WEST:At(s,oe.NORTH);break}break;case oe.CCW:switch(Bi(i,d)){case oe.NORTH:At(s,oe.WEST);break;case oe.SOUTH:At(s,oe.EAST);break;case oe.EAST:At(s,oe.NORTH);break;case oe.WEST:At(s,oe.SOUTH);break}break;case oe.OPP:switch(Bi(i,d)){case oe.NORTH:At(s,oe.SOUTH);break;case oe.SOUTH:At(s,oe.NORTH);break;case oe.EAST:At(s,oe.WEST);break;case oe.WEST:At(s,oe.EAST);break}break;case oe.RNDP:switch(Bi(i,d)){case oe.NORTH:case oe.SOUTH:s.x+=lr(-1,1);break;case oe.WEST:case oe.EAST:s.y+=lr(-1,1);break}break}break}}}return s}function kd(e,t){return S(e==null?void 0:e.objects[t])?(delete e.objects[t],!0):!1}function bv(e,t,n){if(!S(e)||!S(t))return;const r=e.objects[n];if(S(r))return r;if(ur(t))return Ew(t,el(e,"player"))}const D={timestamp:0,book:void 0,board:void 0,element:void 0,player:"",isplayer:!1,words:[],get:void 0};var q=(e=>(e[e.CATEGORY=0]="CATEGORY",e[e.COLLISION=1]="COLLISION",e[e.COLOR=2]="COLOR",e[e.KIND=3]="KIND",e[e.DIR=4]="DIR",e[e.NUMBER=5]="NUMBER",e[e.STRING=6]="STRING",e[e.NUMBER_OR_STRING=7]="NUMBER_OR_STRING",e[e.MAYBE_CATEGORY=8]="MAYBE_CATEGORY",e[e.MAYBE_COLLISION=9]="MAYBE_COLLISION",e[e.MAYBE_COLOR=10]="MAYBE_COLOR",e[e.MAYBE_KIND=11]="MAYBE_KIND",e[e.MAYBE_DIR=12]="MAYBE_DIR",e[e.MAYBE_NUMBER=13]="MAYBE_NUMBER",e[e.MAYBE_STRING=14]="MAYBE_STRING",e[e.MAYBE_NUMBER_OR_STRING=15]="MAYBE_NUMBER_OR_STRING",e[e.ANY=16]="ANY",e))(q||{});function Rt(e,t){throw new Error(`Invalid arg, expected: ${e} but got ${JSON.stringify(t)}`)}function re(e,t,n){var o,a,c,l;const r=D.words;D.words=e;const i=[];let s=t;for(let u=0;u<n.length;++u)switch(n[u]){case 0:{const[f,d]=Fo(s);Pr(f)||Rt("terrain or object",f),s=d,i.push(f);break}case 1:{const[f,d]=Th(s);oi(f)||Rt("solid, walk, swim, bullet, walkable or swimmable",f),s=d,i.push(f);break}case 2:{const[f,d]=jo(s);fn(f)||Rt("color",f),s=d,i.push(f);break}case 3:{const[f,d]=Dh(s);Fi(f)?(s=d,i.push(f)):Rt("kind",f);break}case 4:{const[f,d]=Yc(s);if(fr(f)){const h=((o=D.element)==null?void 0:o.x)??0,p=((a=D.element)==null?void 0:a.y)??0,m={x:h,y:p},b=S(D.board)&&S(D.element)?kl(D.board,D.element,D.player,f,m):m;s=d,i.push(b)}else Rt("direction",f);break}case 5:{const[f,d]=$t(s);if(Ce(f)){const h=parseFloat(f);ke(h)?i.push(h):Rt("number",f)}else ke(f)?i.push(f):Rt("number",f);s=d;break}case 6:{const f=D.words[s];Ce(f)||Rt("string",f),++s,i.push(f);break}case 7:{const[f,d]=$t(s,!1);let h=f;if(Ce(h)){const p=parseFloat(h);ke(p)&&(h=p)}else ke(h)||Rt("number or string",h);s=d,i.push(h);break}case 8:{const[f,d]=Fo(s);f!==void 0&&!Pr(f)&&Rt("optional terrain or object",f),s=d,i.push(f);break}case 9:{const[f,d]=Fo(s);f!==void 0&&!oi(f)&&Rt("optional solid, walk, swim, bullet, walkable or swimmable",f),s=d,i.push(f);break}case 10:{const[f,d]=jo(s);f!==void 0&&!fn(f)&&Rt("optional color",f),s=d,i.push(f);break}case 11:{const[f,d]=Dh(s);f!==void 0&&!Fi(f)&&Rt("optional kind",f),s=d,i.push(f);break}case 12:{const[f,d]=Yc(s);if(fr(f)){const h=((c=D.element)==null?void 0:c.x)??0,p=((l=D.element)==null?void 0:l.y)??0,m={x:h,y:p},b=D.board?kl(D.board,D.element,D.player,f,m):m;s=d,i.push(b)}else f===void 0?(s=d,i.push(void 0)):Rt("optional direction",f);break}case 13:{const[f,d]=$t(s);if(Ce(f)){const h=parseFloat(f);ke(h)?i.push(h):Rt("optional number",f)}else ke(f)||f===void 0?i.push(f):Rt("optional number",f);s=d;break}case 14:{const f=D.words[s];f!==void 0&&!Ce(f)&&Rt("optional string",f),++s,i.push(f);break}case 15:{const[f,d]=$t(s,!1);let h=f;if(Ce(h)){const p=parseFloat(h);ke(p)&&(h=p)}else h!==void 0&&!ke(h)&&Rt("number or string",h);s=d,i.push(h);break}case 16:{const[f,d]=$t(s);s=d,i.push(f);break}}return D.words=r,[...i,s]}const wv=["echo","reverb","chorus","phaser","distortion","vibrato"];function Sd(e,t,n){const[r]=re(n,0,[q.MAYBE_STRING]),i=r??"",s=t.get(i);Ob("audio",-e,Ce(s)?s:i)}function $n(e,t){const[n]=re(t,0,[q.NUMBER_OR_STRING]);if(ke(n))Fc("audio",e,"volume",n);else if(wv.includes(Pe(n))){const[r,i]=re(t,1,[q.NUMBER_OR_STRING,q.MAYBE_NUMBER_OR_STRING]);Nb("audio",e,n,r,i)}else{const[r]=re(t,1,[q.MAYBE_NUMBER_OR_STRING]);if(ke(r)){const i=t.length-1,s=new Array(i).fill(q.NUMBER),o=re(t,1,s).slice(0,i),a=o.length===1?o[0]:o;Fc("audio",e,n,a)}else{const[i]=re(t,1,[q.MAYBE_NUMBER_OR_STRING]);Fc("audio",e,n,i)}}}const vv=cr().command("play",(e,t)=>(Sd(1,e,t),0)).command("synth",(e,t)=>{for(let n=1;n<=8;++n)$n(n,t);return 0}).command("synth1",(e,t)=>($n(1,t),0)).command("synth2",(e,t)=>($n(2,t),0)).command("synth3",(e,t)=>($n(3,t),0)).command("synth4",(e,t)=>($n(4,t),0)).command("synth5",(e,t)=>($n(5,t),0)).command("synth6",(e,t)=>($n(6,t),0)).command("synth7",(e,t)=>($n(7,t),0)).command("synth8",(e,t)=>($n(8,t),0)).command("bgplay",(e,t)=>(Sd(-1,e,t),0)).command("bgsynth",(e,t)=>($n(0,t),0)),Ad=Math.round(1e3/66.666),Ev=3;var Td=typeof global=="object"&&global&&global.Object===Object&&global,kv=typeof self=="object"&&self&&self.Object===Object&&self,jn=Td||kv||Function("return this")(),mn=jn.Symbol,xd=Object.prototype,Sv=xd.hasOwnProperty,Av=xd.toString,Ts=mn?mn.toStringTag:void 0;function Tv(e){var t=Sv.call(e,Ts),n=e[Ts];try{e[Ts]=void 0;var r=!0}catch{}var i=Av.call(e);return r&&(t?e[Ts]=n:delete e[Ts]),i}var xv=Object.prototype,Rv=xv.toString;function Iv(e){return Rv.call(e)}var Ov="[object Null]",Nv="[object Undefined]",Rd=mn?mn.toStringTag:void 0;function Fr(e){return e==null?e===void 0?Nv:Ov:Rd&&Rd in Object(e)?Tv(e):Iv(e)}function xn(e){return e!=null&&typeof e=="object"}var Cv="[object Symbol]";function Qo(e){return typeof e=="symbol"||xn(e)&&Fr(e)==Cv}function ea(e,t){for(var n=-1,r=e==null?0:e.length,i=Array(r);++n<r;)i[n]=t(e[n],n,e);return i}var Le=Array.isArray,Lv=1/0,Id=mn?mn.prototype:void 0,Od=Id?Id.toString:void 0;function Nd(e){if(typeof e=="string")return e;if(Le(e))return ea(e,Nd)+"";if(Qo(e))return Od?Od.call(e):"";var t=e+"";return t=="0"&&1/e==-Lv?"-0":t}var Mv=/\s/;function Uv(e){for(var t=e.length;t--&&Mv.test(e.charAt(t)););return t}var Pv=/^\s+/;function Dv(e){return e&&e.slice(0,Uv(e)+1).replace(Pv,"")}function gn(e){var t=typeof e;return e!=null&&(t=="object"||t=="function")}var Cd=NaN,Bv=/^[-+]0x[0-9a-f]+$/i,Fv=/^0b[01]+$/i,$v=/^0o[0-7]+$/i,jv=parseInt;function zv(e){if(typeof e=="number")return e;if(Qo(e))return Cd;if(gn(e)){var t=typeof e.valueOf=="function"?e.valueOf():e;e=gn(t)?t+"":t}if(typeof e!="string")return e===0?e:+e;e=Dv(e);var n=Fv.test(e);return n||$v.test(e)?jv(e.slice(2),n?2:8):Bv.test(e)?Cd:+e}var Ld=1/0,Wv=17976931348623157e292;function Gv(e){if(!e)return e===0?e:0;if(e=zv(e),e===Ld||e===-Ld){var t=e<0?-1:1;return t*Wv}return e===e?e:0}function ta(e){var t=Gv(e),n=t%1;return t===t?n?t-n:t:0}function Wi(e){return e}var Hv="[object AsyncFunction]",Vv="[object Function]",Kv="[object GeneratorFunction]",qv="[object Proxy]";function gr(e){if(!gn(e))return!1;var t=Fr(e);return t==Vv||t==Kv||t==Hv||t==qv}var Sl=jn["__core-js_shared__"],Md=function(){var e=/[^.]+$/.exec(Sl&&Sl.keys&&Sl.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}();function Xv(e){return!!Md&&Md in e}var Jv=Function.prototype,Zv=Jv.toString;function ui(e){if(e!=null){try{return Zv.call(e)}catch{}try{return e+""}catch{}}return""}var Yv=/[\\^$.*+?()[\]{}|]/g,Qv=/^\[object .+?Constructor\]$/,eE=Function.prototype,tE=Object.prototype,nE=eE.toString,rE=tE.hasOwnProperty,iE=RegExp("^"+nE.call(rE).replace(Yv,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function sE(e){if(!gn(e)||Xv(e))return!1;var t=gr(e)?iE:Qv;return t.test(ui(e))}function oE(e,t){return e==null?void 0:e[t]}function fi(e,t){var n=oE(e,t);return sE(n)?n:void 0}var Al=fi(jn,"WeakMap"),Ud=Object.create,aE=function(){function e(){}return function(t){if(!gn(t))return{};if(Ud)return Ud(t);e.prototype=t;var n=new e;return e.prototype=void 0,n}}();function cE(e,t,n){switch(n.length){case 0:return e.call(t);case 1:return e.call(t,n[0]);case 2:return e.call(t,n[0],n[1]);case 3:return e.call(t,n[0],n[1],n[2])}return e.apply(t,n)}function _t(){}function lE(e,t){var n=-1,r=e.length;for(t||(t=Array(r));++n<r;)t[n]=e[n];return t}var uE=800,fE=16,hE=Date.now;function dE(e){var t=0,n=0;return function(){var r=hE(),i=fE-(r-n);if(n=r,i>0){if(++t>=uE)return arguments[0]}else t=0;return e.apply(void 0,arguments)}}function pE(e){return function(){return e}}var na=function(){try{var e=fi(Object,"defineProperty");return e({},"",{}),e}catch{}}(),mE=na?function(e,t){return na(e,"toString",{configurable:!0,enumerable:!1,value:pE(t),writable:!0})}:Wi,gE=dE(mE);function Pd(e,t){for(var n=-1,r=e==null?0:e.length;++n<r&&t(e[n],n,e)!==!1;);return e}function Dd(e,t,n,r){for(var i=e.length,s=n+-1;++s<i;)if(t(e[s],s,e))return s;return-1}function yE(e){return e!==e}function _E(e,t,n){for(var r=n-1,i=e.length;++r<i;)if(e[r]===t)return r;return-1}function Tl(e,t,n){return t===t?_E(e,t,n):Dd(e,yE,n)}function Bd(e,t){var n=e==null?0:e.length;return!!n&&Tl(e,t,0)>-1}var bE=9007199254740991,wE=/^(?:0|[1-9]\d*)$/;function ra(e,t){var n=typeof e;return t=t??bE,!!t&&(n=="number"||n!="symbol"&&wE.test(e))&&e>-1&&e%1==0&&e<t}function xl(e,t,n){t=="__proto__"&&na?na(e,t,{configurable:!0,enumerable:!0,value:n,writable:!0}):e[t]=n}function xs(e,t){return e===t||e!==e&&t!==t}var vE=Object.prototype,EE=vE.hasOwnProperty;function ia(e,t,n){var r=e[t];(!(EE.call(e,t)&&xs(r,n))||n===void 0&&!(t in e))&&xl(e,t,n)}function Rl(e,t,n,r){var i=!n;n||(n={});for(var s=-1,o=t.length;++s<o;){var a=t[s],c=void 0;c===void 0&&(c=e[a]),i?xl(n,a,c):ia(n,a,c)}return n}var Fd=Math.max;function kE(e,t,n){return t=Fd(t===void 0?e.length-1:t,0),function(){for(var r=arguments,i=-1,s=Fd(r.length-t,0),o=Array(s);++i<s;)o[i]=r[t+i];i=-1;for(var a=Array(t+1);++i<t;)a[i]=r[i];return a[t]=n(o),cE(e,this,a)}}function Il(e,t){return gE(kE(e,t,Wi),e+"")}var SE=9007199254740991;function Ol(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=SE}function zn(e){return e!=null&&Ol(e.length)&&!gr(e)}function $d(e,t,n){if(!gn(n))return!1;var r=typeof t;return(r=="number"?zn(n)&&ra(t,n.length):r=="string"&&t in n)?xs(n[t],e):!1}function AE(e){return Il(function(t,n){var r=-1,i=n.length,s=i>1?n[i-1]:void 0,o=i>2?n[2]:void 0;for(s=e.length>3&&typeof s=="function"?(i--,s):void 0,o&&$d(n[0],n[1],o)&&(s=i<3?void 0:s,i=1),t=Object(t);++r<i;){var a=n[r];a&&e(t,a,r,s)}return t})}var TE=Object.prototype;function Rs(e){var t=e&&e.constructor,n=typeof t=="function"&&t.prototype||TE;return e===n}function xE(e,t){for(var n=-1,r=Array(e);++n<e;)r[n]=t(n);return r}var RE="[object Arguments]";function jd(e){return xn(e)&&Fr(e)==RE}var zd=Object.prototype,IE=zd.hasOwnProperty,OE=zd.propertyIsEnumerable,sa=jd(function(){return arguments}())?jd:function(e){return xn(e)&&IE.call(e,"callee")&&!OE.call(e,"callee")};function NE(){return!1}var Wd=typeof exports=="object"&&exports&&!exports.nodeType&&exports,Gd=Wd&&typeof module=="object"&&module&&!module.nodeType&&module,CE=Gd&&Gd.exports===Wd,Hd=CE?jn.Buffer:void 0,LE=Hd?Hd.isBuffer:void 0,Is=LE||NE,ME="[object Arguments]",UE="[object Array]",PE="[object Boolean]",DE="[object Date]",BE="[object Error]",FE="[object Function]",$E="[object Map]",jE="[object Number]",zE="[object Object]",WE="[object RegExp]",GE="[object Set]",HE="[object String]",VE="[object WeakMap]",KE="[object ArrayBuffer]",qE="[object DataView]",XE="[object Float32Array]",JE="[object Float64Array]",ZE="[object Int8Array]",YE="[object Int16Array]",QE="[object Int32Array]",ek="[object Uint8Array]",tk="[object Uint8ClampedArray]",nk="[object Uint16Array]",rk="[object Uint32Array]",Ye={};Ye[XE]=Ye[JE]=Ye[ZE]=Ye[YE]=Ye[QE]=Ye[ek]=Ye[tk]=Ye[nk]=Ye[rk]=!0,Ye[ME]=Ye[UE]=Ye[KE]=Ye[PE]=Ye[qE]=Ye[DE]=Ye[BE]=Ye[FE]=Ye[$E]=Ye[jE]=Ye[zE]=Ye[WE]=Ye[GE]=Ye[HE]=Ye[VE]=!1;function ik(e){return xn(e)&&Ol(e.length)&&!!Ye[Fr(e)]}function oa(e){return function(t){return e(t)}}var Vd=typeof exports=="object"&&exports&&!exports.nodeType&&exports,Os=Vd&&typeof module=="object"&&module&&!module.nodeType&&module,sk=Os&&Os.exports===Vd,Nl=sk&&Td.process,$r=function(){try{var e=Os&&Os.require&&Os.require("util").types;return e||Nl&&Nl.binding&&Nl.binding("util")}catch{}}(),Kd=$r&&$r.isTypedArray,Cl=Kd?oa(Kd):ik,ok=Object.prototype,ak=ok.hasOwnProperty;function qd(e,t){var n=Le(e),r=!n&&sa(e),i=!n&&!r&&Is(e),s=!n&&!r&&!i&&Cl(e),o=n||r||i||s,a=o?xE(e.length,String):[],c=a.length;for(var l in e)(t||ak.call(e,l))&&!(o&&(l=="length"||i&&(l=="offset"||l=="parent")||s&&(l=="buffer"||l=="byteLength"||l=="byteOffset")||ra(l,c)))&&a.push(l);return a}function Xd(e,t){return function(n){return e(t(n))}}var ck=Xd(Object.keys,Object),lk=Object.prototype,uk=lk.hasOwnProperty;function Jd(e){if(!Rs(e))return ck(e);var t=[];for(var n in Object(e))uk.call(e,n)&&n!="constructor"&&t.push(n);return t}function yn(e){return zn(e)?qd(e):Jd(e)}var fk=Object.prototype,hk=fk.hasOwnProperty,Xt=AE(function(e,t){if(Rs(t)||zn(t)){Rl(t,yn(t),e);return}for(var n in t)hk.call(t,n)&&ia(e,n,t[n])});function dk(e){var t=[];if(e!=null)for(var n in Object(e))t.push(n);return t}var pk=Object.prototype,mk=pk.hasOwnProperty;function gk(e){if(!gn(e))return dk(e);var t=Rs(e),n=[];for(var r in e)r=="constructor"&&(t||!mk.call(e,r))||n.push(r);return n}function Zd(e){return zn(e)?qd(e,!0):gk(e)}var yk=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,_k=/^\w*$/;function Ll(e,t){if(Le(e))return!1;var n=typeof e;return n=="number"||n=="symbol"||n=="boolean"||e==null||Qo(e)?!0:_k.test(e)||!yk.test(e)||t!=null&&e in Object(t)}var Ns=fi(Object,"create");function bk(){this.__data__=Ns?Ns(null):{},this.size=0}function wk(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}var vk="__lodash_hash_undefined__",Ek=Object.prototype,kk=Ek.hasOwnProperty;function Sk(e){var t=this.__data__;if(Ns){var n=t[e];return n===vk?void 0:n}return kk.call(t,e)?t[e]:void 0}var Ak=Object.prototype,Tk=Ak.hasOwnProperty;function xk(e){var t=this.__data__;return Ns?t[e]!==void 0:Tk.call(t,e)}var Rk="__lodash_hash_undefined__";function Ik(e,t){var n=this.__data__;return this.size+=this.has(e)?0:1,n[e]=Ns&&t===void 0?Rk:t,this}function hi(e){var t=-1,n=e==null?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}hi.prototype.clear=bk,hi.prototype.delete=wk,hi.prototype.get=Sk,hi.prototype.has=xk,hi.prototype.set=Ik;function Ok(){this.__data__=[],this.size=0}function aa(e,t){for(var n=e.length;n--;)if(xs(e[n][0],t))return n;return-1}var Nk=Array.prototype,Ck=Nk.splice;function Lk(e){var t=this.__data__,n=aa(t,e);if(n<0)return!1;var r=t.length-1;return n==r?t.pop():Ck.call(t,n,1),--this.size,!0}function Mk(e){var t=this.__data__,n=aa(t,e);return n<0?void 0:t[n][1]}function Uk(e){return aa(this.__data__,e)>-1}function Pk(e,t){var n=this.__data__,r=aa(n,e);return r<0?(++this.size,n.push([e,t])):n[r][1]=t,this}function yr(e){var t=-1,n=e==null?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}yr.prototype.clear=Ok,yr.prototype.delete=Lk,yr.prototype.get=Mk,yr.prototype.has=Uk,yr.prototype.set=Pk;var Cs=fi(jn,"Map");function Dk(){this.size=0,this.__data__={hash:new hi,map:new(Cs||yr),string:new hi}}function Bk(e){var t=typeof e;return t=="string"||t=="number"||t=="symbol"||t=="boolean"?e!=="__proto__":e===null}function ca(e,t){var n=e.__data__;return Bk(t)?n[typeof t=="string"?"string":"hash"]:n.map}function Fk(e){var t=ca(this,e).delete(e);return this.size-=t?1:0,t}function $k(e){return ca(this,e).get(e)}function jk(e){return ca(this,e).has(e)}function zk(e,t){var n=ca(this,e),r=n.size;return n.set(e,t),this.size+=n.size==r?0:1,this}function _r(e){var t=-1,n=e==null?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}_r.prototype.clear=Dk,_r.prototype.delete=Fk,_r.prototype.get=$k,_r.prototype.has=jk,_r.prototype.set=zk;var Wk="Expected a function";function Ml(e,t){if(typeof e!="function"||t!=null&&typeof t!="function")throw new TypeError(Wk);var n=function(){var r=arguments,i=t?t.apply(this,r):r[0],s=n.cache;if(s.has(i))return s.get(i);var o=e.apply(this,r);return n.cache=s.set(i,o)||s,o};return n.cache=new(Ml.Cache||_r),n}Ml.Cache=_r;var Gk=500;function Hk(e){var t=Ml(e,function(r){return n.size===Gk&&n.clear(),r}),n=t.cache;return t}var Vk=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Kk=/\\(\\)?/g,qk=Hk(function(e){var t=[];return e.charCodeAt(0)===46&&t.push(""),e.replace(Vk,function(n,r,i,s){t.push(i?s.replace(Kk,"$1"):r||n)}),t});function Yd(e){return e==null?"":Nd(e)}function la(e,t){return Le(e)?e:Ll(e,t)?[e]:qk(Yd(e))}var Xk=1/0;function Ls(e){if(typeof e=="string"||Qo(e))return e;var t=e+"";return t=="0"&&1/e==-Xk?"-0":t}function Ul(e,t){t=la(t,e);for(var n=0,r=t.length;e!=null&&n<r;)e=e[Ls(t[n++])];return n&&n==r?e:void 0}function Jk(e,t,n){var r=e==null?void 0:Ul(e,t);return r===void 0?n:r}function Pl(e,t){for(var n=-1,r=t.length,i=e.length;++n<r;)e[i+n]=t[n];return e}var Qd=mn?mn.isConcatSpreadable:void 0;function Zk(e){return Le(e)||sa(e)||!!(Qd&&e&&e[Qd])}function Dl(e,t,n,r,i){var s=-1,o=e.length;for(n||(n=Zk),i||(i=[]);++s<o;){var a=e[s];n(a)?Pl(i,a):r||(i[i.length]=a)}return i}function sn(e){var t=e==null?0:e.length;return t?Dl(e):[]}var ep=Xd(Object.getPrototypeOf,Object);function Bl(e,t,n){var r=-1,i=e.length;t<0&&(t=-t>i?0:i+t),n=n>i?i:n,n<0&&(n+=i),i=t>n?0:n-t>>>0,t>>>=0;for(var s=Array(i);++r<i;)s[r]=e[r+t];return s}function Yk(e,t,n){var r=e.length;return n=n===void 0?r:n,!t&&n>=r?e:Bl(e,t,n)}var Qk="\\ud800-\\udfff",e1="\\u0300-\\u036f",t1="\\ufe20-\\ufe2f",n1="\\u20d0-\\u20ff",r1=e1+t1+n1,i1="\\ufe0e\\ufe0f",s1="\\u200d",o1=RegExp("["+s1+Qk+r1+i1+"]");function tp(e){return o1.test(e)}function a1(e){return e.split("")}var np="\\ud800-\\udfff",c1="\\u0300-\\u036f",l1="\\ufe20-\\ufe2f",u1="\\u20d0-\\u20ff",f1=c1+l1+u1,h1="\\ufe0e\\ufe0f",d1="["+np+"]",Fl="["+f1+"]",$l="\\ud83c[\\udffb-\\udfff]",p1="(?:"+Fl+"|"+$l+")",rp="[^"+np+"]",ip="(?:\\ud83c[\\udde6-\\uddff]){2}",sp="[\\ud800-\\udbff][\\udc00-\\udfff]",m1="\\u200d",op=p1+"?",ap="["+h1+"]?",g1="(?:"+m1+"(?:"+[rp,ip,sp].join("|")+")"+ap+op+")*",y1=ap+op+g1,_1="(?:"+[rp+Fl+"?",Fl,ip,sp,d1].join("|")+")",b1=RegExp($l+"(?="+$l+")|"+_1+y1,"g");function w1(e){return e.match(b1)||[]}function v1(e){return tp(e)?w1(e):a1(e)}function E1(e){return function(t){t=Yd(t);var n=tp(t)?v1(t):void 0,r=n?n[0]:t.charAt(0),i=n?Yk(n,1).join(""):t.slice(1);return r[e]()+i}}var cp=E1("toUpperCase");function k1(e,t,n,r){var i=-1,s=e==null?0:e.length;for(r&&s&&(n=e[++i]);++i<s;)n=t(n,e[i],i,e);return n}function S1(){this.__data__=new yr,this.size=0}function A1(e){var t=this.__data__,n=t.delete(e);return this.size=t.size,n}function T1(e){return this.__data__.get(e)}function x1(e){return this.__data__.has(e)}var R1=200;function I1(e,t){var n=this.__data__;if(n instanceof yr){var r=n.__data__;if(!Cs||r.length<R1-1)return r.push([e,t]),this.size=++n.size,this;n=this.__data__=new _r(r)}return n.set(e,t),this.size=n.size,this}function Wn(e){var t=this.__data__=new yr(e);this.size=t.size}Wn.prototype.clear=S1,Wn.prototype.delete=A1,Wn.prototype.get=T1,Wn.prototype.has=x1,Wn.prototype.set=I1;function O1(e,t){return e&&Rl(t,yn(t),e)}var lp=typeof exports=="object"&&exports&&!exports.nodeType&&exports,up=lp&&typeof module=="object"&&module&&!module.nodeType&&module,N1=up&&up.exports===lp,fp=N1?jn.Buffer:void 0,hp=fp?fp.allocUnsafe:void 0;function C1(e,t){var n=e.length,r=hp?hp(n):new e.constructor(n);return e.copy(r),r}function jl(e,t){for(var n=-1,r=e==null?0:e.length,i=0,s=[];++n<r;){var o=e[n];t(o,n,e)&&(s[i++]=o)}return s}function dp(){return[]}var L1=Object.prototype,M1=L1.propertyIsEnumerable,pp=Object.getOwnPropertySymbols,zl=pp?function(e){return e==null?[]:(e=Object(e),jl(pp(e),function(t){return M1.call(e,t)}))}:dp;function U1(e,t){return Rl(e,zl(e),t)}var P1=Object.getOwnPropertySymbols,D1=P1?function(e){for(var t=[];e;)Pl(t,zl(e)),e=ep(e);return t}:dp;function mp(e,t,n){var r=t(e);return Le(e)?r:Pl(r,n(e))}function Wl(e){return mp(e,yn,zl)}function B1(e){return mp(e,Zd,D1)}var Gl=fi(jn,"DataView"),Hl=fi(jn,"Promise"),Gi=fi(jn,"Set"),gp="[object Map]",F1="[object Object]",yp="[object Promise]",_p="[object Set]",bp="[object WeakMap]",wp="[object DataView]",$1=ui(Gl),j1=ui(Cs),z1=ui(Hl),W1=ui(Gi),G1=ui(Al),_n=Fr;(Gl&&_n(new Gl(new ArrayBuffer(1)))!=wp||Cs&&_n(new Cs)!=gp||Hl&&_n(Hl.resolve())!=yp||Gi&&_n(new Gi)!=_p||Al&&_n(new Al)!=bp)&&(_n=function(e){var t=Fr(e),n=t==F1?e.constructor:void 0,r=n?ui(n):"";if(r)switch(r){case $1:return wp;case j1:return gp;case z1:return yp;case W1:return _p;case G1:return bp}return t});var H1=Object.prototype,V1=H1.hasOwnProperty;function K1(e){var t=e.length,n=new e.constructor(t);return t&&typeof e[0]=="string"&&V1.call(e,"index")&&(n.index=e.index,n.input=e.input),n}var ua=jn.Uint8Array;function q1(e){var t=new e.constructor(e.byteLength);return new ua(t).set(new ua(e)),t}function X1(e,t){var n=e.buffer;return new e.constructor(n,e.byteOffset,e.byteLength)}var J1=/\w*$/;function Z1(e){var t=new e.constructor(e.source,J1.exec(e));return t.lastIndex=e.lastIndex,t}var vp=mn?mn.prototype:void 0,Ep=vp?vp.valueOf:void 0;function Y1(e){return Ep?Object(Ep.call(e)):{}}function Q1(e,t){var n=e.buffer;return new e.constructor(n,e.byteOffset,e.length)}var eS="[object Boolean]",tS="[object Date]",nS="[object Map]",rS="[object Number]",iS="[object RegExp]",sS="[object Set]",oS="[object String]",aS="[object Symbol]",cS="[object ArrayBuffer]",lS="[object DataView]",uS="[object Float32Array]",fS="[object Float64Array]",hS="[object Int8Array]",dS="[object Int16Array]",pS="[object Int32Array]",mS="[object Uint8Array]",gS="[object Uint8ClampedArray]",yS="[object Uint16Array]",_S="[object Uint32Array]";function bS(e,t,n){var r=e.constructor;switch(t){case cS:return q1(e);case eS:case tS:return new r(+e);case lS:return X1(e);case uS:case fS:case hS:case dS:case pS:case mS:case gS:case yS:case _S:return Q1(e);case nS:return new r;case rS:case oS:return new r(e);case iS:return Z1(e);case sS:return new r;case aS:return Y1(e)}}function wS(e){return typeof e.constructor=="function"&&!Rs(e)?aE(ep(e)):{}}var vS="[object Map]";function ES(e){return xn(e)&&_n(e)==vS}var kp=$r&&$r.isMap,kS=kp?oa(kp):ES,SS="[object Set]";function AS(e){return xn(e)&&_n(e)==SS}var Sp=$r&&$r.isSet,TS=Sp?oa(Sp):AS,Ap="[object Arguments]",xS="[object Array]",RS="[object Boolean]",IS="[object Date]",OS="[object Error]",Tp="[object Function]",NS="[object GeneratorFunction]",CS="[object Map]",LS="[object Number]",xp="[object Object]",MS="[object RegExp]",US="[object Set]",PS="[object String]",DS="[object Symbol]",BS="[object WeakMap]",FS="[object ArrayBuffer]",$S="[object DataView]",jS="[object Float32Array]",zS="[object Float64Array]",WS="[object Int8Array]",GS="[object Int16Array]",HS="[object Int32Array]",VS="[object Uint8Array]",KS="[object Uint8ClampedArray]",qS="[object Uint16Array]",XS="[object Uint32Array]",Ke={};Ke[Ap]=Ke[xS]=Ke[FS]=Ke[$S]=Ke[RS]=Ke[IS]=Ke[jS]=Ke[zS]=Ke[WS]=Ke[GS]=Ke[HS]=Ke[CS]=Ke[LS]=Ke[xp]=Ke[MS]=Ke[US]=Ke[PS]=Ke[DS]=Ke[VS]=Ke[KS]=Ke[qS]=Ke[XS]=!0,Ke[OS]=Ke[Tp]=Ke[BS]=!1;function fa(e,t,n,r,i,s){var o;if(o!==void 0)return o;if(!gn(e))return e;var a=Le(e);if(a)return o=K1(e),lE(e,o);var c=_n(e),l=c==Tp||c==NS;if(Is(e))return C1(e);if(c==xp||c==Ap||l&&!i)return o=l?{}:wS(e),U1(e,O1(o,e));if(!Ke[c])return i?e:{};o=bS(e,c),s||(s=new Wn);var u=s.get(e);if(u)return u;s.set(e,o),TS(e)?e.forEach(function(h){o.add(fa(h,t,n,h,e,s))}):kS(e)&&e.forEach(function(h,p){o.set(p,fa(h,t,n,p,e,s))});var f=Wl,d=a?void 0:f(e);return Pd(d||e,function(h,p){d&&(p=h,h=e[p]),ia(o,p,fa(h,t,n,p,e,s))}),o}var JS=4;function Mt(e){return fa(e,JS)}function Ms(e){for(var t=-1,n=e==null?0:e.length,r=0,i=[];++t<n;){var s=e[t];s&&(i[r++]=s)}return i}var ZS="__lodash_hash_undefined__";function YS(e){return this.__data__.set(e,ZS),this}function QS(e){return this.__data__.has(e)}function Hi(e){var t=-1,n=e==null?0:e.length;for(this.__data__=new _r;++t<n;)this.add(e[t])}Hi.prototype.add=Hi.prototype.push=YS,Hi.prototype.has=QS;function Rp(e,t){for(var n=-1,r=e==null?0:e.length;++n<r;)if(t(e[n],n,e))return!0;return!1}function Vl(e,t){return e.has(t)}var eA=1,tA=2;function Ip(e,t,n,r,i,s){var o=n&eA,a=e.length,c=t.length;if(a!=c&&!(o&&c>a))return!1;var l=s.get(e),u=s.get(t);if(l&&u)return l==t&&u==e;var f=-1,d=!0,h=n&tA?new Hi:void 0;for(s.set(e,t),s.set(t,e);++f<a;){var p=e[f],m=t[f];if(r)var b=o?r(m,p,f,t,e,s):r(p,m,f,e,t,s);if(b!==void 0){if(b)continue;d=!1;break}if(h){if(!Rp(t,function(_,w){if(!Vl(h,w)&&(p===_||i(p,_,n,r,s)))return h.push(w)})){d=!1;break}}else if(!(p===m||i(p,m,n,r,s))){d=!1;break}}return s.delete(e),s.delete(t),d}function nA(e){var t=-1,n=Array(e.size);return e.forEach(function(r,i){n[++t]=[i,r]}),n}function Kl(e){var t=-1,n=Array(e.size);return e.forEach(function(r){n[++t]=r}),n}var rA=1,iA=2,sA="[object Boolean]",oA="[object Date]",aA="[object Error]",cA="[object Map]",lA="[object Number]",uA="[object RegExp]",fA="[object Set]",hA="[object String]",dA="[object Symbol]",pA="[object ArrayBuffer]",mA="[object DataView]",Op=mn?mn.prototype:void 0,ql=Op?Op.valueOf:void 0;function gA(e,t,n,r,i,s,o){switch(n){case mA:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case pA:return!(e.byteLength!=t.byteLength||!s(new ua(e),new ua(t)));case sA:case oA:case lA:return xs(+e,+t);case aA:return e.name==t.name&&e.message==t.message;case uA:case hA:return e==t+"";case cA:var a=nA;case fA:var c=r&rA;if(a||(a=Kl),e.size!=t.size&&!c)return!1;var l=o.get(e);if(l)return l==t;r|=iA,o.set(e,t);var u=Ip(a(e),a(t),r,i,s,o);return o.delete(e),u;case dA:if(ql)return ql.call(e)==ql.call(t)}return!1}var yA=1,_A=Object.prototype,bA=_A.hasOwnProperty;function wA(e,t,n,r,i,s){var o=n&yA,a=Wl(e),c=a.length,l=Wl(t),u=l.length;if(c!=u&&!o)return!1;for(var f=c;f--;){var d=a[f];if(!(o?d in t:bA.call(t,d)))return!1}var h=s.get(e),p=s.get(t);if(h&&p)return h==t&&p==e;var m=!0;s.set(e,t),s.set(t,e);for(var b=o;++f<c;){d=a[f];var _=e[d],w=t[d];if(r)var v=o?r(w,_,d,t,e,s):r(_,w,d,e,t,s);if(!(v===void 0?_===w||i(_,w,n,r,s):v)){m=!1;break}b||(b=d=="constructor")}if(m&&!b){var k=e.constructor,C=t.constructor;k!=C&&"constructor"in e&&"constructor"in t&&!(typeof k=="function"&&k instanceof k&&typeof C=="function"&&C instanceof C)&&(m=!1)}return s.delete(e),s.delete(t),m}var vA=1,Np="[object Arguments]",Cp="[object Array]",ha="[object Object]",EA=Object.prototype,Lp=EA.hasOwnProperty;function kA(e,t,n,r,i,s){var o=Le(e),a=Le(t),c=o?Cp:_n(e),l=a?Cp:_n(t);c=c==Np?ha:c,l=l==Np?ha:l;var u=c==ha,f=l==ha,d=c==l;if(d&&Is(e)){if(!Is(t))return!1;o=!0,u=!1}if(d&&!u)return s||(s=new Wn),o||Cl(e)?Ip(e,t,n,r,i,s):gA(e,t,c,n,r,i,s);if(!(n&vA)){var h=u&&Lp.call(e,"__wrapped__"),p=f&&Lp.call(t,"__wrapped__");if(h||p){var m=h?e.value():e,b=p?t.value():t;return s||(s=new Wn),i(m,b,n,r,s)}}return d?(s||(s=new Wn),wA(e,t,n,r,i,s)):!1}function Xl(e,t,n,r,i){return e===t?!0:e==null||t==null||!xn(e)&&!xn(t)?e!==e&&t!==t:kA(e,t,n,r,Xl,i)}var SA=1,AA=2;function TA(e,t,n,r){var i=n.length,s=i;if(e==null)return!s;for(e=Object(e);i--;){var o=n[i];if(o[2]?o[1]!==e[o[0]]:!(o[0]in e))return!1}for(;++i<s;){o=n[i];var a=o[0],c=e[a],l=o[1];if(o[2]){if(c===void 0&&!(a in e))return!1}else{var u=new Wn,f;if(!(f===void 0?Xl(l,c,SA|AA,r,u):f))return!1}}return!0}function Mp(e){return e===e&&!gn(e)}function xA(e){for(var t=yn(e),n=t.length;n--;){var r=t[n],i=e[r];t[n]=[r,i,Mp(i)]}return t}function Up(e,t){return function(n){return n==null?!1:n[e]===t&&(t!==void 0||e in Object(n))}}function RA(e){var t=xA(e);return t.length==1&&t[0][2]?Up(t[0][0],t[0][1]):function(n){return n===e||TA(n,e,t)}}function IA(e,t){return e!=null&&t in Object(e)}function Pp(e,t,n){t=la(t,e);for(var r=-1,i=t.length,s=!1;++r<i;){var o=Ls(t[r]);if(!(s=e!=null&&n(e,o)))break;e=e[o]}return s||++r!=i?s:(i=e==null?0:e.length,!!i&&Ol(i)&&ra(o,i)&&(Le(e)||sa(e)))}function OA(e,t){return e!=null&&Pp(e,t,IA)}var NA=1,CA=2;function LA(e,t){return Ll(e)&&Mp(t)?Up(Ls(e),t):function(n){var r=Jk(n,e);return r===void 0&&r===t?OA(n,e):Xl(t,r,NA|CA)}}function MA(e){return function(t){return t==null?void 0:t[e]}}function UA(e){return function(t){return Ul(t,e)}}function PA(e){return Ll(e)?MA(Ls(e)):UA(e)}function Gn(e){return typeof e=="function"?e:e==null?Wi:typeof e=="object"?Le(e)?LA(e[0],e[1]):RA(e):PA(e)}function DA(e,t,n,r){for(var i=-1,s=e==null?0:e.length;++i<s;){var o=e[i];t(r,o,n(o),e)}return r}function BA(e){return function(t,n,r){for(var i=-1,s=Object(t),o=r(t),a=o.length;a--;){var c=o[++i];if(n(s[c],c,s)===!1)break}return t}}var FA=BA();function $A(e,t){return e&&FA(e,t,yn)}function jA(e,t){return function(n,r){if(n==null)return n;if(!zn(n))return e(n,r);for(var i=n.length,s=-1,o=Object(n);++s<i&&r(o[s],s,o)!==!1;);return n}}var di=jA($A);function zA(e,t,n,r){return di(e,function(i,s,o){t(r,i,n(i),o)}),r}function WA(e,t){return function(n,r){var i=Le(n)?DA:zA,s=t?t():{};return i(n,e,Gn(r),s)}}var Dp=Object.prototype,GA=Dp.hasOwnProperty,Jl=Il(function(e,t){e=Object(e);var n=-1,r=t.length,i=r>2?t[2]:void 0;for(i&&$d(t[0],t[1],i)&&(r=1);++n<r;)for(var s=t[n],o=Zd(s),a=-1,c=o.length;++a<c;){var l=o[a],u=e[l];(u===void 0||xs(u,Dp[l])&&!GA.call(e,l))&&(e[l]=s[l])}return e});function Bp(e){return xn(e)&&zn(e)}var HA=200;function VA(e,t,n,r){var i=-1,s=Bd,o=!0,a=e.length,c=[],l=t.length;if(!a)return c;t.length>=HA&&(s=Vl,o=!1,t=new Hi(t));e:for(;++i<a;){var u=e[i],f=u;if(u=u!==0?u:0,o&&f===f){for(var d=l;d--;)if(t[d]===f)continue e;c.push(u)}else s(t,f,r)||c.push(u)}return c}var da=Il(function(e,t){return Bp(e)?VA(e,Dl(t,1,Bp,!0)):[]});function Vi(e){var t=e==null?0:e.length;return t?e[t-1]:void 0}function Ut(e,t,n){var r=e==null?0:e.length;return r?(t=t===void 0?1:ta(t),Bl(e,t<0?0:t,r)):[]}function Us(e,t,n){var r=e==null?0:e.length;return r?(t=t===void 0?1:ta(t),t=r-t,Bl(e,0,t<0?0:t)):[]}function KA(e){return typeof e=="function"?e:Wi}function me(e,t){var n=Le(e)?Pd:di;return n(e,KA(t))}function qA(e,t){for(var n=-1,r=e==null?0:e.length;++n<r;)if(!t(e[n],n,e))return!1;return!0}function XA(e,t){var n=!0;return di(e,function(r,i,s){return n=!!t(r,i,s),n}),n}function Rn(e,t,n){var r=Le(e)?qA:XA;return r(e,Gn(t))}function Fp(e,t){var n=[];return di(e,function(r,i,s){t(r,i,s)&&n.push(r)}),n}function bn(e,t){var n=Le(e)?jl:Fp;return n(e,Gn(t))}function JA(e){return function(t,n,r){var i=Object(t);if(!zn(t)){var s=Gn(n);t=yn(t),n=function(a){return s(i[a],a,i)}}var o=e(t,n,r);return o>-1?i[s?t[o]:o]:void 0}}var ZA=Math.max;function YA(e,t,n){var r=e==null?0:e.length;if(!r)return-1;var i=n==null?0:ta(n);return i<0&&(i=ZA(r+i,0)),Dd(e,Gn(t),i)}var Ki=JA(YA);function In(e){return e&&e.length?e[0]:void 0}function QA(e,t){var n=-1,r=zn(e)?Array(e.length):[];return di(e,function(i,s,o){r[++n]=t(i,s,o)}),r}function ce(e,t){var n=Le(e)?ea:QA;return n(e,Gn(t))}function wn(e,t){return Dl(ce(e,t))}var eT=Object.prototype,tT=eT.hasOwnProperty,$p=WA(function(e,t,n){tT.call(e,n)?e[n].push(t):xl(e,n,[t])}),nT=Object.prototype,rT=nT.hasOwnProperty;function iT(e,t){return e!=null&&rT.call(e,t)}function pe(e,t){return e!=null&&Pp(e,t,iT)}var sT="[object String]";function Jt(e){return typeof e=="string"||!Le(e)&&xn(e)&&Fr(e)==sT}function oT(e,t){return ea(t,function(n){return e[n]})}function ht(e){return e==null?[]:oT(e,yn(e))}var aT=Math.max;function zt(e,t,n,r){e=zn(e)?e:ht(e),n=n&&!r?ta(n):0;var i=e.length;return n<0&&(n=aT(i+n,0)),Jt(e)?n<=i&&e.indexOf(t,n)>-1:!!i&&Tl(e,t,n)>-1}function jp(e,t,n){var r=e==null?0:e.length;if(!r)return-1;var i=0;return Tl(e,t,i)}var cT="[object Map]",lT="[object Set]",uT=Object.prototype,fT=uT.hasOwnProperty;function qe(e){if(e==null)return!0;if(zn(e)&&(Le(e)||typeof e=="string"||typeof e.splice=="function"||Is(e)||Cl(e)||sa(e)))return!e.length;var t=_n(e);if(t==cT||t==lT)return!e.size;if(Rs(e))return!Jd(e).length;for(var n in e)if(fT.call(e,n))return!1;return!0}var hT="[object RegExp]";function dT(e){return xn(e)&&Fr(e)==hT}var zp=$r&&$r.isRegExp,br=zp?oa(zp):dT;function wr(e){return e===void 0}var pT="Expected a function";function mT(e){if(typeof e!="function")throw new TypeError(pT);return function(){var t=arguments;switch(t.length){case 0:return!e.call(this);case 1:return!e.call(this,t[0]);case 2:return!e.call(this,t[0],t[1]);case 3:return!e.call(this,t[0],t[1],t[2])}return!e.apply(this,t)}}function gT(e,t,n,r){if(!gn(e))return e;t=la(t,e);for(var i=-1,s=t.length,o=s-1,a=e;a!=null&&++i<s;){var c=Ls(t[i]),l=n;if(c==="__proto__"||c==="constructor"||c==="prototype")return e;if(i!=o){var u=a[c];l=void 0,l===void 0&&(l=gn(u)?u:ra(t[i+1])?[]:{})}ia(a,c,l),a=a[c]}return e}function yT(e,t,n){for(var r=-1,i=t.length,s={};++r<i;){var o=t[r],a=Ul(e,o);n(a,o)&&gT(s,la(o,e),a)}return s}function On(e,t){if(e==null)return{};var n=ea(B1(e),function(r){return[r]});return t=Gn(t),yT(e,n,function(r,i){return t(r,i[0])})}function _T(e,t,n,r,i){return i(e,function(s,o,a){n=r?(r=!1,s):t(n,s,o,a)}),n}function Zt(e,t,n){var r=Le(e)?k1:_T,i=arguments.length<3;return r(e,Gn(t),n,i,di)}function pa(e,t){var n=Le(e)?jl:Fp;return n(e,mT(Gn(t)))}function bT(e,t){var n;return di(e,function(r,i,s){return n=t(r,i,s),!n}),!!n}function Zl(e,t,n){var r=Le(e)?Rp:bT;return r(e,Gn(t))}var wT=1/0,vT=Gi&&1/Kl(new Gi([,-0]))[1]==wT?function(e){return new Gi(e)}:_t,ET=200;function kT(e,t,n){var r=-1,i=Bd,s=e.length,o=!0,a=[],c=a;if(s>=ET){var l=vT(e);if(l)return Kl(l);o=!1,i=Vl,c=new Hi}else c=a;e:for(;++r<s;){var u=e[r],f=u;if(u=u!==0?u:0,o&&f===f){for(var d=c.length;d--;)if(c[d]===f)continue e;a.push(u)}else i(c,f,n)||(c!==a&&c.push(f),a.push(u))}return a}function ma(e){return e&&e.length?kT(e):[]}function Yl(e){console&&console.error&&console.error(`Error: ${e}`)}function Wp(e){console&&console.warn&&console.warn(`Warning: ${e}`)}function Gp(e){const t=new Date().getTime(),n=e();return{time:new Date().getTime()-t,value:n}}function Hp(e){function t(){}t.prototype=e;const n=new t;function r(){return typeof n.bar}return r(),r(),e}function ST(e){return AT(e)?e.LABEL:e.name}function AT(e){return Jt(e.LABEL)&&e.LABEL!==""}class Hn{get definition(){return this._definition}set definition(t){this._definition=t}constructor(t){this._definition=t}accept(t){t.visit(this),me(this.definition,n=>{n.accept(t)})}}class Yt extends Hn{constructor(t){super([]),this.idx=1,Xt(this,On(t,n=>n!==void 0))}set definition(t){}get definition(){return this.referencedRule!==void 0?this.referencedRule.definition:[]}accept(t){t.visit(this)}}class qi extends Hn{constructor(t){super(t.definition),this.orgText="",Xt(this,On(t,n=>n!==void 0))}}class Qt extends Hn{constructor(t){super(t.definition),this.ignoreAmbiguities=!1,Xt(this,On(t,n=>n!==void 0))}}class en extends Hn{constructor(t){super(t.definition),this.idx=1,Xt(this,On(t,n=>n!==void 0))}}class Vn extends Hn{constructor(t){super(t.definition),this.idx=1,Xt(this,On(t,n=>n!==void 0))}}class Kn extends Hn{constructor(t){super(t.definition),this.idx=1,Xt(this,On(t,n=>n!==void 0))}}class bt extends Hn{constructor(t){super(t.definition),this.idx=1,Xt(this,On(t,n=>n!==void 0))}}class Nn extends Hn{constructor(t){super(t.definition),this.idx=1,Xt(this,On(t,n=>n!==void 0))}}class Cn extends Hn{get definition(){return this._definition}set definition(t){this._definition=t}constructor(t){super(t.definition),this.idx=1,this.ignoreAmbiguities=!1,this.hasPredicates=!1,Xt(this,On(t,n=>n!==void 0))}}class tt{constructor(t){this.idx=1,Xt(this,On(t,n=>n!==void 0))}accept(t){t.visit(this)}}function TT(e){return ce(e,ga)}function ga(e){function t(n){return ce(n,ga)}if(e instanceof Yt){const n={type:"NonTerminal",name:e.nonTerminalName,idx:e.idx};return Jt(e.label)&&(n.label=e.label),n}else{if(e instanceof Qt)return{type:"Alternative",definition:t(e.definition)};if(e instanceof en)return{type:"Option",idx:e.idx,definition:t(e.definition)};if(e instanceof Vn)return{type:"RepetitionMandatory",idx:e.idx,definition:t(e.definition)};if(e instanceof Kn)return{type:"RepetitionMandatoryWithSeparator",idx:e.idx,separator:ga(new tt({terminalType:e.separator})),definition:t(e.definition)};if(e instanceof Nn)return{type:"RepetitionWithSeparator",idx:e.idx,separator:ga(new tt({terminalType:e.separator})),definition:t(e.definition)};if(e instanceof bt)return{type:"Repetition",idx:e.idx,definition:t(e.definition)};if(e instanceof Cn)return{type:"Alternation",idx:e.idx,definition:t(e.definition)};if(e instanceof tt){const n={type:"Terminal",name:e.terminalType.name,label:ST(e.terminalType),idx:e.idx};Jt(e.label)&&(n.terminalLabel=e.label);const r=e.terminalType.PATTERN;return e.terminalType.PATTERN&&(n.pattern=br(r)?r.source:r),n}else{if(e instanceof qi)return{type:"Rule",name:e.name,orgText:e.orgText,definition:t(e.definition)};throw Error("non exhaustive match")}}}class pi{visit(t){const n=t;switch(n.constructor){case Yt:return this.visitNonTerminal(n);case Qt:return this.visitAlternative(n);case en:return this.visitOption(n);case Vn:return this.visitRepetitionMandatory(n);case Kn:return this.visitRepetitionMandatoryWithSeparator(n);case Nn:return this.visitRepetitionWithSeparator(n);case bt:return this.visitRepetition(n);case Cn:return this.visitAlternation(n);case tt:return this.visitTerminal(n);case qi:return this.visitRule(n);default:throw Error("non exhaustive match")}}visitNonTerminal(t){}visitAlternative(t){}visitOption(t){}visitRepetition(t){}visitRepetitionMandatory(t){}visitRepetitionMandatoryWithSeparator(t){}visitRepetitionWithSeparator(t){}visitAlternation(t){}visitTerminal(t){}visitRule(t){}}function xT(e){return e instanceof Qt||e instanceof en||e instanceof bt||e instanceof Vn||e instanceof Kn||e instanceof Nn||e instanceof tt||e instanceof qi}function ya(e,t=[]){return e instanceof en||e instanceof bt||e instanceof Nn?!0:e instanceof Cn?Zl(e.definition,r=>ya(r,t)):e instanceof Yt&&zt(t,e)?!1:e instanceof Hn?(e instanceof Yt&&t.push(e),Rn(e.definition,r=>ya(r,t))):!1}function RT(e){return e instanceof Cn}function qn(e){if(e instanceof Yt)return"SUBRULE";if(e instanceof en)return"OPTION";if(e instanceof Cn)return"OR";if(e instanceof Vn)return"AT_LEAST_ONE";if(e instanceof Kn)return"AT_LEAST_ONE_SEP";if(e instanceof Nn)return"MANY_SEP";if(e instanceof bt)return"MANY";if(e instanceof tt)return"CONSUME";throw Error("non exhaustive match")}class _a{walk(t,n=[]){me(t.definition,(r,i)=>{const s=Ut(t.definition,i+1);if(r instanceof Yt)this.walkProdRef(r,s,n);else if(r instanceof tt)this.walkTerminal(r,s,n);else if(r instanceof Qt)this.walkFlat(r,s,n);else if(r instanceof en)this.walkOption(r,s,n);else if(r instanceof Vn)this.walkAtLeastOne(r,s,n);else if(r instanceof Kn)this.walkAtLeastOneSep(r,s,n);else if(r instanceof Nn)this.walkManySep(r,s,n);else if(r instanceof bt)this.walkMany(r,s,n);else if(r instanceof Cn)this.walkOr(r,s,n);else throw Error("non exhaustive match")})}walkTerminal(t,n,r){}walkProdRef(t,n,r){}walkFlat(t,n,r){const i=n.concat(r);this.walk(t,i)}walkOption(t,n,r){const i=n.concat(r);this.walk(t,i)}walkAtLeastOne(t,n,r){const i=[new en({definition:t.definition})].concat(n,r);this.walk(t,i)}walkAtLeastOneSep(t,n,r){const i=Vp(t,n,r);this.walk(t,i)}walkMany(t,n,r){const i=[new en({definition:t.definition})].concat(n,r);this.walk(t,i)}walkManySep(t,n,r){const i=Vp(t,n,r);this.walk(t,i)}walkOr(t,n,r){const i=n.concat(r);me(t.definition,s=>{const o=new Qt({definition:[s]});this.walk(o,i)})}}function Vp(e,t,n){return[new en({definition:[new tt({terminalType:e.separator})].concat(e.definition)})].concat(t,n)}function Ps(e){if(e instanceof Yt)return Ps(e.referencedRule);if(e instanceof tt)return NT(e);if(xT(e))return IT(e);if(RT(e))return OT(e);throw Error("non exhaustive match")}function IT(e){let t=[];const n=e.definition;let r=0,i=n.length>r,s,o=!0;for(;i&&o;)s=n[r],o=ya(s),t=t.concat(Ps(s)),r=r+1,i=n.length>r;return ma(t)}function OT(e){const t=ce(e.definition,n=>Ps(n));return ma(sn(t))}function NT(e){return[e.terminalType]}const Kp="_~IN~_";class CT extends _a{constructor(t){super(),this.topProd=t,this.follows={}}startWalking(){return this.walk(this.topProd),this.follows}walkTerminal(t,n,r){}walkProdRef(t,n,r){const i=MT(t.referencedRule,t.idx)+this.topProd.name,s=n.concat(r),o=new Qt({definition:s}),a=Ps(o);this.follows[i]=a}}function LT(e){const t={};return me(e,n=>{const r=new CT(n).startWalking();Xt(t,r)}),t}function MT(e,t){return e.name+t+Kp}function ge(e){return e.charCodeAt(0)}function Ql(e,t){Array.isArray(e)?e.forEach(function(n){t.push(n)}):t.push(e)}function Ds(e,t){if(e[t]===!0)throw"duplicate flag "+t;e[t],e[t]=!0}function Xi(e){if(e===void 0)throw Error("Internal Error - Should never get here!");return!0}function UT(){throw Error("Internal Error - Should never get here!")}function qp(e){return e.type==="Character"}const ba=[];for(let e=ge("0");e<=ge("9");e++)ba.push(e);const wa=[ge("_")].concat(ba);for(let e=ge("a");e<=ge("z");e++)wa.push(e);for(let e=ge("A");e<=ge("Z");e++)wa.push(e);const Xp=[ge(" "),ge("\f"),ge(`
`),ge("\r"),ge("	"),ge("\v"),ge("	"),ge(""),ge(""),ge(""),ge(""),ge(""),ge(""),ge(""),ge(""),ge(""),ge(""),ge(""),ge(""),ge(""),ge("\u2028"),ge("\u2029"),ge(""),ge(""),ge(""),ge("\uFEFF")],PT=/[0-9a-fA-F]/,va=/[0-9]/,DT=/[1-9]/;class BT{constructor(){this.idx=0,this.input="",this.groupIdx=0}saveState(){return{idx:this.idx,input:this.input,groupIdx:this.groupIdx}}restoreState(t){this.idx=t.idx,this.input=t.input,this.groupIdx=t.groupIdx}pattern(t){this.idx=0,this.input=t,this.groupIdx=0,this.consumeChar("/");const n=this.disjunction();this.consumeChar("/");const r={type:"Flags",loc:{begin:this.idx,end:t.length},global:!1,ignoreCase:!1,multiLine:!1,unicode:!1,sticky:!1};for(;this.isRegExpFlag();)switch(this.popChar()){case"g":Ds(r,"global");break;case"i":Ds(r,"ignoreCase");break;case"m":Ds(r,"multiLine");break;case"u":Ds(r,"unicode");break;case"y":Ds(r,"sticky");break}if(this.idx!==this.input.length)throw Error("Redundant input: "+this.input.substring(this.idx));return{type:"Pattern",flags:r,value:n,loc:this.loc(0)}}disjunction(){const t=[],n=this.idx;for(t.push(this.alternative());this.peekChar()==="|";)this.consumeChar("|"),t.push(this.alternative());return{type:"Disjunction",value:t,loc:this.loc(n)}}alternative(){const t=[],n=this.idx;for(;this.isTerm();)t.push(this.term());return{type:"Alternative",value:t,loc:this.loc(n)}}term(){return this.isAssertion()?this.assertion():this.atom()}assertion(){const t=this.idx;switch(this.popChar()){case"^":return{type:"StartAnchor",loc:this.loc(t)};case"$":return{type:"EndAnchor",loc:this.loc(t)};case"\\":switch(this.popChar()){case"b":return{type:"WordBoundary",loc:this.loc(t)};case"B":return{type:"NonWordBoundary",loc:this.loc(t)}}throw Error("Invalid Assertion Escape");case"(":this.consumeChar("?");let n;switch(this.popChar()){case"=":n="Lookahead";break;case"!":n="NegativeLookahead";break}Xi(n);const r=this.disjunction();return this.consumeChar(")"),{type:n,value:r,loc:this.loc(t)}}return UT()}quantifier(t=!1){let n;const r=this.idx;switch(this.popChar()){case"*":n={atLeast:0,atMost:1/0};break;case"+":n={atLeast:1,atMost:1/0};break;case"?":n={atLeast:0,atMost:1};break;case"{":const i=this.integerIncludingZero();switch(this.popChar()){case"}":n={atLeast:i,atMost:i};break;case",":let s;this.isDigit()?(s=this.integerIncludingZero(),n={atLeast:i,atMost:s}):n={atLeast:i,atMost:1/0},this.consumeChar("}");break}if(t===!0&&n===void 0)return;Xi(n);break}if(!(t===!0&&n===void 0)&&Xi(n))return this.peekChar(0)==="?"?(this.consumeChar("?"),n.greedy=!1):n.greedy=!0,n.type="Quantifier",n.loc=this.loc(r),n}atom(){let t;const n=this.idx;switch(this.peekChar()){case".":t=this.dotAll();break;case"\\":t=this.atomEscape();break;case"[":t=this.characterClass();break;case"(":t=this.group();break}if(t===void 0&&this.isPatternCharacter()&&(t=this.patternCharacter()),Xi(t))return t.loc=this.loc(n),this.isQuantifier()&&(t.quantifier=this.quantifier()),t}dotAll(){return this.consumeChar("."),{type:"Set",complement:!0,value:[ge(`
`),ge("\r"),ge("\u2028"),ge("\u2029")]}}atomEscape(){switch(this.consumeChar("\\"),this.peekChar()){case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":return this.decimalEscapeAtom();case"d":case"D":case"s":case"S":case"w":case"W":return this.characterClassEscape();case"f":case"n":case"r":case"t":case"v":return this.controlEscapeAtom();case"c":return this.controlLetterEscapeAtom();case"0":return this.nulCharacterAtom();case"x":return this.hexEscapeSequenceAtom();case"u":return this.regExpUnicodeEscapeSequenceAtom();default:return this.identityEscapeAtom()}}decimalEscapeAtom(){return{type:"GroupBackReference",value:this.positiveInteger()}}characterClassEscape(){let t,n=!1;switch(this.popChar()){case"d":t=ba;break;case"D":t=ba,n=!0;break;case"s":t=Xp;break;case"S":t=Xp,n=!0;break;case"w":t=wa;break;case"W":t=wa,n=!0;break}if(Xi(t))return{type:"Set",value:t,complement:n}}controlEscapeAtom(){let t;switch(this.popChar()){case"f":t=ge("\f");break;case"n":t=ge(`
`);break;case"r":t=ge("\r");break;case"t":t=ge("	");break;case"v":t=ge("\v");break}if(Xi(t))return{type:"Character",value:t}}controlLetterEscapeAtom(){this.consumeChar("c");const t=this.popChar();if(/[a-zA-Z]/.test(t)===!1)throw Error("Invalid ");return{type:"Character",value:t.toUpperCase().charCodeAt(0)-64}}nulCharacterAtom(){return this.consumeChar("0"),{type:"Character",value:ge("\0")}}hexEscapeSequenceAtom(){return this.consumeChar("x"),this.parseHexDigits(2)}regExpUnicodeEscapeSequenceAtom(){return this.consumeChar("u"),this.parseHexDigits(4)}identityEscapeAtom(){const t=this.popChar();return{type:"Character",value:ge(t)}}classPatternCharacterAtom(){switch(this.peekChar()){case`
`:case"\r":case"\u2028":case"\u2029":case"\\":case"]":throw Error("TBD");default:const t=this.popChar();return{type:"Character",value:ge(t)}}}characterClass(){const t=[];let n=!1;for(this.consumeChar("["),this.peekChar(0)==="^"&&(this.consumeChar("^"),n=!0);this.isClassAtom();){const r=this.classAtom();if(r.type,qp(r)&&this.isRangeDash()){this.consumeChar("-");const i=this.classAtom();if(i.type,qp(i)){if(i.value<r.value)throw Error("Range out of order in character class");t.push({from:r.value,to:i.value})}else Ql(r.value,t),t.push(ge("-")),Ql(i.value,t)}else Ql(r.value,t)}return this.consumeChar("]"),{type:"Set",complement:n,value:t}}classAtom(){switch(this.peekChar()){case"]":case`
`:case"\r":case"\u2028":case"\u2029":throw Error("TBD");case"\\":return this.classEscape();default:return this.classPatternCharacterAtom()}}classEscape(){switch(this.consumeChar("\\"),this.peekChar()){case"b":return this.consumeChar("b"),{type:"Character",value:ge("\b")};case"d":case"D":case"s":case"S":case"w":case"W":return this.characterClassEscape();case"f":case"n":case"r":case"t":case"v":return this.controlEscapeAtom();case"c":return this.controlLetterEscapeAtom();case"0":return this.nulCharacterAtom();case"x":return this.hexEscapeSequenceAtom();case"u":return this.regExpUnicodeEscapeSequenceAtom();default:return this.identityEscapeAtom()}}group(){let t=!0;switch(this.consumeChar("("),this.peekChar(0)){case"?":this.consumeChar("?"),this.consumeChar(":"),t=!1;break;default:this.groupIdx++;break}const n=this.disjunction();this.consumeChar(")");const r={type:"Group",capturing:t,value:n};return t&&(r.idx=this.groupIdx),r}positiveInteger(){let t=this.popChar();if(DT.test(t)===!1)throw Error("Expecting a positive integer");for(;va.test(this.peekChar(0));)t+=this.popChar();return parseInt(t,10)}integerIncludingZero(){let t=this.popChar();if(va.test(t)===!1)throw Error("Expecting an integer");for(;va.test(this.peekChar(0));)t+=this.popChar();return parseInt(t,10)}patternCharacter(){const t=this.popChar();switch(t){case`
`:case"\r":case"\u2028":case"\u2029":case"^":case"$":case"\\":case".":case"*":case"+":case"?":case"(":case")":case"[":case"|":throw Error("TBD");default:return{type:"Character",value:ge(t)}}}isRegExpFlag(){switch(this.peekChar(0)){case"g":case"i":case"m":case"u":case"y":return!0;default:return!1}}isRangeDash(){return this.peekChar()==="-"&&this.isClassAtom(1)}isDigit(){return va.test(this.peekChar(0))}isClassAtom(t=0){switch(this.peekChar(t)){case"]":case`
`:case"\r":case"\u2028":case"\u2029":return!1;default:return!0}}isTerm(){return this.isAtom()||this.isAssertion()}isAtom(){if(this.isPatternCharacter())return!0;switch(this.peekChar(0)){case".":case"\\":case"[":case"(":return!0;default:return!1}}isAssertion(){switch(this.peekChar(0)){case"^":case"$":return!0;case"\\":switch(this.peekChar(1)){case"b":case"B":return!0;default:return!1}case"(":return this.peekChar(1)==="?"&&(this.peekChar(2)==="="||this.peekChar(2)==="!");default:return!1}}isQuantifier(){const t=this.saveState();try{return this.quantifier(!0)!==void 0}catch{return!1}finally{this.restoreState(t)}}isPatternCharacter(){switch(this.peekChar()){case"^":case"$":case"\\":case".":case"*":case"+":case"?":case"(":case")":case"[":case"|":case"/":case`
`:case"\r":case"\u2028":case"\u2029":return!1;default:return!0}}parseHexDigits(t){let n="";for(let i=0;i<t;i++){const s=this.popChar();if(PT.test(s)===!1)throw Error("Expecting a HexDecimal digits");n+=s}return{type:"Character",value:parseInt(n,16)}}peekChar(t=0){return this.input[this.idx+t]}popChar(){const t=this.peekChar(0);return this.consumeChar(void 0),t}consumeChar(t){if(t!==void 0&&this.input[this.idx]!==t)throw Error("Expected: '"+t+"' but found: '"+this.input[this.idx]+"' at offset: "+this.idx);if(this.idx>=this.input.length)throw Error("Unexpected end of input");this.idx++}loc(t){return{begin:t,end:this.idx}}}class eu{visitChildren(t){for(const n in t){const r=t[n];t.hasOwnProperty(n)&&(r.type!==void 0?this.visit(r):Array.isArray(r)&&r.forEach(i=>{this.visit(i)},this))}}visit(t){switch(t.type){case"Pattern":this.visitPattern(t);break;case"Flags":this.visitFlags(t);break;case"Disjunction":this.visitDisjunction(t);break;case"Alternative":this.visitAlternative(t);break;case"StartAnchor":this.visitStartAnchor(t);break;case"EndAnchor":this.visitEndAnchor(t);break;case"WordBoundary":this.visitWordBoundary(t);break;case"NonWordBoundary":this.visitNonWordBoundary(t);break;case"Lookahead":this.visitLookahead(t);break;case"NegativeLookahead":this.visitNegativeLookahead(t);break;case"Character":this.visitCharacter(t);break;case"Set":this.visitSet(t);break;case"Group":this.visitGroup(t);break;case"GroupBackReference":this.visitGroupBackReference(t);break;case"Quantifier":this.visitQuantifier(t);break}this.visitChildren(t)}visitPattern(t){}visitFlags(t){}visitDisjunction(t){}visitAlternative(t){}visitStartAnchor(t){}visitEndAnchor(t){}visitWordBoundary(t){}visitNonWordBoundary(t){}visitLookahead(t){}visitNegativeLookahead(t){}visitCharacter(t){}visitSet(t){}visitGroup(t){}visitGroupBackReference(t){}visitQuantifier(t){}}let Ea={};const FT=new BT;function ka(e){const t=e.toString();if(Ea.hasOwnProperty(t))return Ea[t];{const n=FT.pattern(t);return Ea[t]=n,n}}function $T(){Ea={}}const Jp="Complement Sets are not supported for first char optimization",Sa=`Unable to use "first char" lexer optimizations:
`;function jT(e,t=!1){try{const n=ka(e);return tu(n.value,{},n.flags.ignoreCase)}catch(n){if(n.message===Jp)t&&Wp(`${Sa}	Unable to optimize: < ${e.toString()} >
	Complement Sets cannot be automatically optimized.
	This will disable the lexer's first char optimizations.
	See: https://chevrotain.io/docs/guide/resolving_lexer_errors.html#COMPLEMENT for details.`);else{let r="";t&&(r=`
	This will disable the lexer's first char optimizations.
	See: https://chevrotain.io/docs/guide/resolving_lexer_errors.html#REGEXP_PARSING for details.`),Yl(`${Sa}
	Failed parsing: < ${e.toString()} >
	Using the @chevrotain/regexp-to-ast library
	Please open an issue at: https://github.com/chevrotain/chevrotain/issues`+r)}}return[]}function tu(e,t,n){switch(e.type){case"Disjunction":for(let i=0;i<e.value.length;i++)tu(e.value[i],t,n);break;case"Alternative":const r=e.value;for(let i=0;i<r.length;i++){const s=r[i];switch(s.type){case"EndAnchor":case"GroupBackReference":case"Lookahead":case"NegativeLookahead":case"StartAnchor":case"WordBoundary":case"NonWordBoundary":continue}const o=s;switch(o.type){case"Character":Aa(o.value,t,n);break;case"Set":if(o.complement===!0)throw Error(Jp);me(o.value,c=>{if(typeof c=="number")Aa(c,t,n);else{const l=c;if(n===!0)for(let u=l.from;u<=l.to;u++)Aa(u,t,n);else{for(let u=l.from;u<=l.to&&u<Fs;u++)Aa(u,t,n);if(l.to>=Fs){const u=l.from>=Fs?l.from:Fs,f=l.to,d=jr(u),h=jr(f);for(let p=d;p<=h;p++)t[p]=p}}}});break;case"Group":tu(o.value,t,n);break;default:throw Error("Non Exhaustive Match")}const a=o.quantifier!==void 0&&o.quantifier.atLeast===0;if(o.type==="Group"&&nu(o)===!1||o.type!=="Group"&&a===!1)break}break;default:throw Error("non exhaustive match!")}return ht(t)}function Aa(e,t,n){const r=jr(e);t[r]=r,n===!0&&zT(e,t)}function zT(e,t){const n=String.fromCharCode(e),r=n.toUpperCase();if(r!==n){const i=jr(r.charCodeAt(0));t[i]=i}else{const i=n.toLowerCase();if(i!==n){const s=jr(i.charCodeAt(0));t[s]=s}}}function Zp(e,t){return Ki(e.value,n=>{if(typeof n=="number")return zt(t,n);{const r=n;return Ki(t,i=>r.from<=i&&i<=r.to)!==void 0}})}function nu(e){const t=e.quantifier;return t&&t.atLeast===0?!0:e.value?Le(e.value)?Rn(e.value,nu):nu(e.value):!1}class WT extends eu{constructor(t){super(),this.targetCharCodes=t,this.found=!1}visitChildren(t){if(this.found!==!0){switch(t.type){case"Lookahead":this.visitLookahead(t);return;case"NegativeLookahead":this.visitNegativeLookahead(t);return}super.visitChildren(t)}}visitCharacter(t){zt(this.targetCharCodes,t.value)&&(this.found=!0)}visitSet(t){t.complement?Zp(t,this.targetCharCodes)===void 0&&(this.found=!0):Zp(t,this.targetCharCodes)!==void 0&&(this.found=!0)}}function ru(e,t){if(t instanceof RegExp){const n=ka(t),r=new WT(e);return r.visit(n),r.found}else return Ki(t,n=>zt(e,n.charCodeAt(0)))!==void 0}const mi="PATTERN",Bs="defaultMode",Ta="modes";let Yp=typeof new RegExp("(?:)").sticky=="boolean";function GT(e,t){t=Jl(t,{useSticky:Yp,debug:!1,safeMode:!1,positionTracking:"full",lineTerminatorCharacters:["\r",`
`],tracer:(w,v)=>v()});const n=t.tracer;n("initCharCodeToOptimizedIndexMap",()=>{dx()});let r;n("Reject Lexer.NA",()=>{r=pa(e,w=>w[mi]===wt.NA)});let i=!1,s;n("Transform Patterns",()=>{i=!1,s=ce(r,w=>{const v=w[mi];if(br(v)){const k=v.source;return k.length===1&&k!=="^"&&k!=="$"&&k!=="."&&!v.ignoreCase?k:k.length===2&&k[0]==="\\"&&!zt(["d","D","s","S","t","r","n","t","0","c","b","B","f","v","w","W"],k[1])?k[1]:t.useSticky?em(v):Qp(v)}else{if(gr(v))return i=!0,{exec:v};if(typeof v=="object")return i=!0,v;if(typeof v=="string"){if(v.length===1)return v;{const k=v.replace(/[\\^$.*+?()[\]{}|]/g,"\\$&"),C=new RegExp(k);return t.useSticky?em(C):Qp(C)}}else throw Error("non exhaustive match")}})});let o,a,c,l,u;n("misc mapping",()=>{o=ce(r,w=>w.tokenTypeIdx),a=ce(r,w=>{const v=w.GROUP;if(v!==wt.SKIPPED){if(Jt(v))return v;if(wr(v))return!1;throw Error("non exhaustive match")}}),c=ce(r,w=>{const v=w.LONGER_ALT;if(v)return Le(v)?ce(v,C=>jp(r,C)):[jp(r,v)]}),l=ce(r,w=>w.PUSH_MODE),u=ce(r,w=>pe(w,"POP_MODE"))});let f;n("Line Terminator Handling",()=>{const w=rm(t.lineTerminatorCharacters);f=ce(r,v=>!1),t.positionTracking!=="onlyOffset"&&(f=ce(r,v=>pe(v,"LINE_BREAKS")?!!v.LINE_BREAKS:nm(v,w)===!1&&ru(w,v.PATTERN)))});let d,h,p,m;n("Misc Mapping #2",()=>{d=ce(r,tm),h=ce(s,ux),p=Zt(r,(w,v)=>{const k=v.GROUP;return Jt(k)&&k!==wt.SKIPPED&&(w[k]=[]),w},{}),m=ce(s,(w,v)=>({pattern:s[v],longerAlt:c[v],canLineTerminator:f[v],isCustom:d[v],short:h[v],group:a[v],push:l[v],pop:u[v],tokenTypeIdx:o[v],tokenType:r[v]}))});let b=!0,_=[];return t.safeMode||n("First Char Optimization",()=>{_=Zt(r,(w,v,k)=>{if(typeof v.PATTERN=="string"){const C=v.PATTERN.charCodeAt(0),I=jr(C);iu(w,I,m[k])}else if(Le(v.START_CHARS_HINT)){let C;me(v.START_CHARS_HINT,I=>{const T=typeof I=="string"?I.charCodeAt(0):I,L=jr(T);C!==L&&(C=L,iu(w,L,m[k]))})}else if(br(v.PATTERN))if(v.PATTERN.unicode)b=!1,t.ensureOptimizations&&Yl(`${Sa}	Unable to analyze < ${v.PATTERN.toString()} > pattern.
	The regexp unicode flag is not currently supported by the regexp-to-ast library.
	This will disable the lexer's first char optimizations.
	For details See: https://chevrotain.io/docs/guide/resolving_lexer_errors.html#UNICODE_OPTIMIZE`);else{const C=jT(v.PATTERN,t.ensureOptimizations);qe(C)&&(b=!1),me(C,I=>{iu(w,I,m[k])})}else t.ensureOptimizations&&Yl(`${Sa}	TokenType: <${v.name}> is using a custom token pattern without providing <start_chars_hint> parameter.
	This will disable the lexer's first char optimizations.
	For details See: https://chevrotain.io/docs/guide/resolving_lexer_errors.html#CUSTOM_OPTIMIZE`),b=!1;return w},[])}),{emptyGroups:p,patternIdxToConfig:m,charCodeToPatternIdxToConfig:_,hasCustom:i,canBeOptimized:b}}function HT(e,t){let n=[];const r=KT(e);n=n.concat(r.errors);const i=qT(r.valid),s=i.valid;return n=n.concat(i.errors),n=n.concat(VT(s)),n=n.concat(nx(s)),n=n.concat(rx(s,t)),n=n.concat(ix(s)),n}function VT(e){let t=[];const n=bn(e,r=>br(r[mi]));return t=t.concat(JT(n)),t=t.concat(QT(n)),t=t.concat(ex(n)),t=t.concat(tx(n)),t=t.concat(ZT(n)),t}function KT(e){const t=bn(e,i=>!pe(i,mi)),n=ce(t,i=>({message:"Token Type: ->"+i.name+"<- missing static 'PATTERN' property",type:it.MISSING_PATTERN,tokenTypes:[i]})),r=da(e,t);return{errors:n,valid:r}}function qT(e){const t=bn(e,i=>{const s=i[mi];return!br(s)&&!gr(s)&&!pe(s,"exec")&&!Jt(s)}),n=ce(t,i=>({message:"Token Type: ->"+i.name+"<- static 'PATTERN' can only be a RegExp, a Function matching the {CustomPatternMatcherFunc} type or an Object matching the {ICustomPattern} interface.",type:it.INVALID_PATTERN,tokenTypes:[i]})),r=da(e,t);return{errors:n,valid:r}}const XT=/[^\\][$]/;function JT(e){class t extends eu{constructor(){super(...arguments),this.found=!1}visitEndAnchor(s){this.found=!0}}const n=bn(e,i=>{const s=i.PATTERN;try{const o=ka(s),a=new t;return a.visit(o),a.found}catch{return XT.test(s.source)}});return ce(n,i=>({message:`Unexpected RegExp Anchor Error:
	Token Type: ->`+i.name+`<- static 'PATTERN' cannot contain end of input anchor '$'
	See chevrotain.io/docs/guide/resolving_lexer_errors.html#ANCHORS	for details.`,type:it.EOI_ANCHOR_FOUND,tokenTypes:[i]}))}function ZT(e){const t=bn(e,r=>r.PATTERN.test(""));return ce(t,r=>({message:"Token Type: ->"+r.name+"<- static 'PATTERN' must not match an empty string",type:it.EMPTY_MATCH_PATTERN,tokenTypes:[r]}))}const YT=/[^\\[][\^]|^\^/;function QT(e){class t extends eu{constructor(){super(...arguments),this.found=!1}visitStartAnchor(s){this.found=!0}}const n=bn(e,i=>{const s=i.PATTERN;try{const o=ka(s),a=new t;return a.visit(o),a.found}catch{return YT.test(s.source)}});return ce(n,i=>({message:`Unexpected RegExp Anchor Error:
	Token Type: ->`+i.name+`<- static 'PATTERN' cannot contain start of input anchor '^'
	See https://chevrotain.io/docs/guide/resolving_lexer_errors.html#ANCHORS	for details.`,type:it.SOI_ANCHOR_FOUND,tokenTypes:[i]}))}function ex(e){const t=bn(e,r=>{const i=r[mi];return i instanceof RegExp&&(i.multiline||i.global)});return ce(t,r=>({message:"Token Type: ->"+r.name+"<- static 'PATTERN' may NOT contain global('g') or multiline('m')",type:it.UNSUPPORTED_FLAGS_FOUND,tokenTypes:[r]}))}function tx(e){const t=[];let n=ce(e,s=>Zt(e,(o,a)=>(s.PATTERN.source===a.PATTERN.source&&!zt(t,a)&&a.PATTERN!==wt.NA&&(t.push(a),o.push(a)),o),[]));n=Ms(n);const r=bn(n,s=>s.length>1);return ce(r,s=>{const o=ce(s,c=>c.name);return{message:`The same RegExp pattern ->${In(s).PATTERN}<-has been used in all of the following Token Types: ${o.join(", ")} <-`,type:it.DUPLICATE_PATTERNS_FOUND,tokenTypes:s}})}function nx(e){const t=bn(e,r=>{if(!pe(r,"GROUP"))return!1;const i=r.GROUP;return i!==wt.SKIPPED&&i!==wt.NA&&!Jt(i)});return ce(t,r=>({message:"Token Type: ->"+r.name+"<- static 'GROUP' can only be Lexer.SKIPPED/Lexer.NA/A String",type:it.INVALID_GROUP_TYPE_FOUND,tokenTypes:[r]}))}function rx(e,t){const n=bn(e,i=>i.PUSH_MODE!==void 0&&!zt(t,i.PUSH_MODE));return ce(n,i=>({message:`Token Type: ->${i.name}<- static 'PUSH_MODE' value cannot refer to a Lexer Mode ->${i.PUSH_MODE}<-which does not exist`,type:it.PUSH_MODE_DOES_NOT_EXIST,tokenTypes:[i]}))}function ix(e){const t=[],n=Zt(e,(r,i,s)=>{const o=i.PATTERN;return o===wt.NA||(Jt(o)?r.push({str:o,idx:s,tokenType:i}):br(o)&&ox(o)&&r.push({str:o.source,idx:s,tokenType:i})),r},[]);return me(e,(r,i)=>{me(n,({str:s,idx:o,tokenType:a})=>{if(i<o&&sx(s,r.PATTERN)){const c=`Token: ->${a.name}<- can never be matched.
Because it appears AFTER the Token Type ->${r.name}<-in the lexer's definition.
See https://chevrotain.io/docs/guide/resolving_lexer_errors.html#UNREACHABLE`;t.push({message:c,type:it.UNREACHABLE_PATTERN,tokenTypes:[r,a]})}})}),t}function sx(e,t){if(br(t)){const n=t.exec(e);return n!==null&&n.index===0}else{if(gr(t))return t(e,0,[],{});if(pe(t,"exec"))return t.exec(e,0,[],{});if(typeof t=="string")return t===e;throw Error("non exhaustive match")}}function ox(e){return Ki([".","\\","[","]","|","^","$","(",")","?","*","+","{"],n=>e.source.indexOf(n)!==-1)===void 0}function Qp(e){const t=e.ignoreCase?"i":"";return new RegExp(`^(?:${e.source})`,t)}function em(e){const t=e.ignoreCase?"iy":"y";return new RegExp(`${e.source}`,t)}function ax(e,t,n){const r=[];return pe(e,Bs)||r.push({message:"A MultiMode Lexer cannot be initialized without a <"+Bs+`> property in its definition
`,type:it.MULTI_MODE_LEXER_WITHOUT_DEFAULT_MODE}),pe(e,Ta)||r.push({message:"A MultiMode Lexer cannot be initialized without a <"+Ta+`> property in its definition
`,type:it.MULTI_MODE_LEXER_WITHOUT_MODES_PROPERTY}),pe(e,Ta)&&pe(e,Bs)&&!pe(e.modes,e.defaultMode)&&r.push({message:`A MultiMode Lexer cannot be initialized with a ${Bs}: <${e.defaultMode}>which does not exist
`,type:it.MULTI_MODE_LEXER_DEFAULT_MODE_VALUE_DOES_NOT_EXIST}),pe(e,Ta)&&me(e.modes,(i,s)=>{me(i,(o,a)=>{if(wr(o))r.push({message:`A Lexer cannot be initialized using an undefined Token Type. Mode:<${s}> at index: <${a}>
`,type:it.LEXER_DEFINITION_CANNOT_CONTAIN_UNDEFINED});else if(pe(o,"LONGER_ALT")){const c=Le(o.LONGER_ALT)?o.LONGER_ALT:[o.LONGER_ALT];me(c,l=>{!wr(l)&&!zt(i,l)&&r.push({message:`A MultiMode Lexer cannot be initialized with a longer_alt <${l.name}> on token <${o.name}> outside of mode <${s}>
`,type:it.MULTI_MODE_LEXER_LONGER_ALT_NOT_IN_CURRENT_MODE})})}})}),r}function cx(e,t,n){const r=[];let i=!1;const s=Ms(sn(ht(e.modes))),o=pa(s,c=>c[mi]===wt.NA),a=rm(n);return t&&me(o,c=>{const l=nm(c,a);if(l!==!1){const f={message:hx(c,l),type:l.issue,tokenType:c};r.push(f)}else pe(c,"LINE_BREAKS")?c.LINE_BREAKS===!0&&(i=!0):ru(a,c.PATTERN)&&(i=!0)}),t&&!i&&r.push({message:`Warning: No LINE_BREAKS Found.
	This Lexer has been defined to track line and column information,
	But none of the Token Types can be identified as matching a line terminator.
	See https://chevrotain.io/docs/guide/resolving_lexer_errors.html#LINE_BREAKS 
	for details.`,type:it.NO_LINE_BREAKS_FLAGS}),r}function lx(e){const t={},n=yn(e);return me(n,r=>{const i=e[r];if(Le(i))t[r]=[];else throw Error("non exhaustive match")}),t}function tm(e){const t=e.PATTERN;if(br(t))return!1;if(gr(t))return!0;if(pe(t,"exec"))return!0;if(Jt(t))return!1;throw Error("non exhaustive match")}function ux(e){return Jt(e)&&e.length===1?e.charCodeAt(0):!1}const fx={test:function(e){const t=e.length;for(let n=this.lastIndex;n<t;n++){const r=e.charCodeAt(n);if(r===10)return this.lastIndex=n+1,!0;if(r===13)return e.charCodeAt(n+1)===10?this.lastIndex=n+2:this.lastIndex=n+1,!0}return!1},lastIndex:0};function nm(e,t){if(pe(e,"LINE_BREAKS"))return!1;if(br(e.PATTERN)){try{ru(t,e.PATTERN)}catch(n){return{issue:it.IDENTIFY_TERMINATOR,errMsg:n.message}}return!1}else{if(Jt(e.PATTERN))return!1;if(tm(e))return{issue:it.CUSTOM_LINE_BREAK};throw Error("non exhaustive match")}}function hx(e,t){if(t.issue===it.IDENTIFY_TERMINATOR)return`Warning: unable to identify line terminator usage in pattern.
	The problem is in the <${e.name}> Token Type
	 Root cause: ${t.errMsg}.
	For details See: https://chevrotain.io/docs/guide/resolving_lexer_errors.html#IDENTIFY_TERMINATOR`;if(t.issue===it.CUSTOM_LINE_BREAK)return`Warning: A Custom Token Pattern should specify the <line_breaks> option.
	The problem is in the <${e.name}> Token Type
	For details See: https://chevrotain.io/docs/guide/resolving_lexer_errors.html#CUSTOM_LINE_BREAK`;throw Error("non exhaustive match")}function rm(e){return ce(e,n=>Jt(n)?n.charCodeAt(0):n)}function iu(e,t,n){e[t]===void 0?e[t]=[n]:e[t].push(n)}const Fs=256;let xa=[];function jr(e){return e<Fs?e:xa[e]}function dx(){if(qe(xa)){xa=new Array(65536);for(let e=0;e<65536;e++)xa[e]=e>255?255+~~(e/255):e}}function $s(e,t){const n=e.tokenTypeIdx;return n===t.tokenTypeIdx?!0:t.isParent===!0&&t.categoryMatchesMap[n]===!0}function Ra(e,t){return e.tokenTypeIdx===t.tokenTypeIdx}let im=1;const sm={};function js(e){const t=px(e);mx(t),yx(t),gx(t),me(t,n=>{n.isParent=n.categoryMatches.length>0})}function px(e){let t=Mt(e),n=e,r=!0;for(;r;){n=Ms(sn(ce(n,s=>s.CATEGORIES)));const i=da(n,t);t=t.concat(i),qe(i)?r=!1:n=i}return t}function mx(e){me(e,t=>{am(t)||(sm[im]=t,t.tokenTypeIdx=im++),cm(t)&&!Le(t.CATEGORIES)&&(t.CATEGORIES=[t.CATEGORIES]),cm(t)||(t.CATEGORIES=[]),_x(t)||(t.categoryMatches=[]),bx(t)||(t.categoryMatchesMap={})})}function gx(e){me(e,t=>{t.categoryMatches=[],me(t.categoryMatchesMap,(n,r)=>{t.categoryMatches.push(sm[r].tokenTypeIdx)})})}function yx(e){me(e,t=>{om([],t)})}function om(e,t){me(e,n=>{t.categoryMatchesMap[n.tokenTypeIdx]=!0}),me(t.CATEGORIES,n=>{const r=e.concat(t);zt(r,n)||om(r,n)})}function am(e){return pe(e,"tokenTypeIdx")}function cm(e){return pe(e,"CATEGORIES")}function _x(e){return pe(e,"categoryMatches")}function bx(e){return pe(e,"categoryMatchesMap")}function wx(e){return pe(e,"tokenTypeIdx")}const vx={buildUnableToPopLexerModeMessage(e){return`Unable to pop Lexer Mode after encountering Token ->${e.image}<- The Mode Stack is empty`},buildUnexpectedCharactersMessage(e,t,n,r,i){return`unexpected character: ->${e.charAt(t)}<- at offset: ${t}, skipped ${n} characters.`}};var it;(function(e){e[e.MISSING_PATTERN=0]="MISSING_PATTERN",e[e.INVALID_PATTERN=1]="INVALID_PATTERN",e[e.EOI_ANCHOR_FOUND=2]="EOI_ANCHOR_FOUND",e[e.UNSUPPORTED_FLAGS_FOUND=3]="UNSUPPORTED_FLAGS_FOUND",e[e.DUPLICATE_PATTERNS_FOUND=4]="DUPLICATE_PATTERNS_FOUND",e[e.INVALID_GROUP_TYPE_FOUND=5]="INVALID_GROUP_TYPE_FOUND",e[e.PUSH_MODE_DOES_NOT_EXIST=6]="PUSH_MODE_DOES_NOT_EXIST",e[e.MULTI_MODE_LEXER_WITHOUT_DEFAULT_MODE=7]="MULTI_MODE_LEXER_WITHOUT_DEFAULT_MODE",e[e.MULTI_MODE_LEXER_WITHOUT_MODES_PROPERTY=8]="MULTI_MODE_LEXER_WITHOUT_MODES_PROPERTY",e[e.MULTI_MODE_LEXER_DEFAULT_MODE_VALUE_DOES_NOT_EXIST=9]="MULTI_MODE_LEXER_DEFAULT_MODE_VALUE_DOES_NOT_EXIST",e[e.LEXER_DEFINITION_CANNOT_CONTAIN_UNDEFINED=10]="LEXER_DEFINITION_CANNOT_CONTAIN_UNDEFINED",e[e.SOI_ANCHOR_FOUND=11]="SOI_ANCHOR_FOUND",e[e.EMPTY_MATCH_PATTERN=12]="EMPTY_MATCH_PATTERN",e[e.NO_LINE_BREAKS_FLAGS=13]="NO_LINE_BREAKS_FLAGS",e[e.UNREACHABLE_PATTERN=14]="UNREACHABLE_PATTERN",e[e.IDENTIFY_TERMINATOR=15]="IDENTIFY_TERMINATOR",e[e.CUSTOM_LINE_BREAK=16]="CUSTOM_LINE_BREAK",e[e.MULTI_MODE_LEXER_LONGER_ALT_NOT_IN_CURRENT_MODE=17]="MULTI_MODE_LEXER_LONGER_ALT_NOT_IN_CURRENT_MODE"})(it||(it={}));const zs={deferDefinitionErrorsHandling:!1,positionTracking:"full",lineTerminatorsPattern:/\n|\r\n?/g,lineTerminatorCharacters:[`
`,"\r"],ensureOptimizations:!1,safeMode:!1,errorMessageProvider:vx,traceInitPerf:!1,skipValidations:!1,recoveryEnabled:!0};Object.freeze(zs);class wt{constructor(t,n=zs){if(this.lexerDefinition=t,this.lexerDefinitionErrors=[],this.lexerDefinitionWarning=[],this.patternIdxToConfig={},this.charCodeToPatternIdxToConfig={},this.modes=[],this.emptyGroups={},this.trackStartLines=!0,this.trackEndLines=!0,this.hasCustom=!1,this.canModeBeOptimized={},this.TRACE_INIT=(i,s)=>{if(this.traceInitPerf===!0){this.traceInitIndent++;const o=new Array(this.traceInitIndent+1).join("	");this.traceInitIndent<this.traceInitMaxIdent&&console.log(`${o}--> <${i}>`);const{time:a,value:c}=Gp(s),l=a>10?console.warn:console.log;return this.traceInitIndent<this.traceInitMaxIdent&&l(`${o}<-- <${i}> time: ${a}ms`),this.traceInitIndent--,c}else return s()},typeof n=="boolean")throw Error(`The second argument to the Lexer constructor is now an ILexerConfig Object.
a boolean 2nd argument is no longer supported`);this.config=Xt({},zs,n);const r=this.config.traceInitPerf;r===!0?(this.traceInitMaxIdent=1/0,this.traceInitPerf=!0):typeof r=="number"&&(this.traceInitMaxIdent=r,this.traceInitPerf=!0),this.traceInitIndent=-1,this.TRACE_INIT("Lexer Constructor",()=>{let i,s=!0;this.TRACE_INIT("Lexer Config handling",()=>{if(this.config.lineTerminatorsPattern===zs.lineTerminatorsPattern)this.config.lineTerminatorsPattern=fx;else if(this.config.lineTerminatorCharacters===zs.lineTerminatorCharacters)throw Error(`Error: Missing <lineTerminatorCharacters> property on the Lexer config.
	For details See: https://chevrotain.io/docs/guide/resolving_lexer_errors.html#MISSING_LINE_TERM_CHARS`);if(n.safeMode&&n.ensureOptimizations)throw Error('"safeMode" and "ensureOptimizations" flags are mutually exclusive.');this.trackStartLines=/full|onlyStart/i.test(this.config.positionTracking),this.trackEndLines=/full/i.test(this.config.positionTracking),Le(t)?i={modes:{defaultMode:Mt(t)},defaultMode:Bs}:(s=!1,i=Mt(t))}),this.config.skipValidations===!1&&(this.TRACE_INIT("performRuntimeChecks",()=>{this.lexerDefinitionErrors=this.lexerDefinitionErrors.concat(ax(i,this.trackStartLines,this.config.lineTerminatorCharacters))}),this.TRACE_INIT("performWarningRuntimeChecks",()=>{this.lexerDefinitionWarning=this.lexerDefinitionWarning.concat(cx(i,this.trackStartLines,this.config.lineTerminatorCharacters))})),i.modes=i.modes?i.modes:{},me(i.modes,(a,c)=>{i.modes[c]=pa(a,l=>wr(l))});const o=yn(i.modes);if(me(i.modes,(a,c)=>{this.TRACE_INIT(`Mode: <${c}> processing`,()=>{if(this.modes.push(c),this.config.skipValidations===!1&&this.TRACE_INIT("validatePatterns",()=>{this.lexerDefinitionErrors=this.lexerDefinitionErrors.concat(HT(a,o))}),qe(this.lexerDefinitionErrors)){js(a);let l;this.TRACE_INIT("analyzeTokenTypes",()=>{l=GT(a,{lineTerminatorCharacters:this.config.lineTerminatorCharacters,positionTracking:n.positionTracking,ensureOptimizations:n.ensureOptimizations,safeMode:n.safeMode,tracer:this.TRACE_INIT})}),this.patternIdxToConfig[c]=l.patternIdxToConfig,this.charCodeToPatternIdxToConfig[c]=l.charCodeToPatternIdxToConfig,this.emptyGroups=Xt({},this.emptyGroups,l.emptyGroups),this.hasCustom=l.hasCustom||this.hasCustom,this.canModeBeOptimized[c]=l.canBeOptimized}})}),this.defaultMode=i.defaultMode,!qe(this.lexerDefinitionErrors)&&!this.config.deferDefinitionErrorsHandling){const c=ce(this.lexerDefinitionErrors,l=>l.message).join(`-----------------------
`);throw new Error(`Errors detected in definition of Lexer:
`+c)}me(this.lexerDefinitionWarning,a=>{Wp(a.message)}),this.TRACE_INIT("Choosing sub-methods implementations",()=>{if(Yp?(this.chopInput=Wi,this.match=this.matchWithTest):(this.updateLastIndex=_t,this.match=this.matchWithExec),s&&(this.handleModes=_t),this.trackStartLines===!1&&(this.computeNewColumn=Wi),this.trackEndLines===!1&&(this.updateTokenEndLineColumnLocation=_t),/full/i.test(this.config.positionTracking))this.createTokenInstance=this.createFullToken;else if(/onlyStart/i.test(this.config.positionTracking))this.createTokenInstance=this.createStartOnlyToken;else if(/onlyOffset/i.test(this.config.positionTracking))this.createTokenInstance=this.createOffsetOnlyToken;else throw Error(`Invalid <positionTracking> config option: "${this.config.positionTracking}"`);this.hasCustom?(this.addToken=this.addTokenUsingPush,this.handlePayload=this.handlePayloadWithCustom):(this.addToken=this.addTokenUsingMemberAccess,this.handlePayload=this.handlePayloadNoCustom)}),this.TRACE_INIT("Failed Optimization Warnings",()=>{const a=Zt(this.canModeBeOptimized,(c,l,u)=>(l===!1&&c.push(u),c),[]);if(n.ensureOptimizations&&!qe(a))throw Error(`Lexer Modes: < ${a.join(", ")} > cannot be optimized.
	 Disable the "ensureOptimizations" lexer config flag to silently ignore this and run the lexer in an un-optimized mode.
	 Or inspect the console log for details on how to resolve these issues.`)}),this.TRACE_INIT("clearRegExpParserCache",()=>{$T()}),this.TRACE_INIT("toFastProperties",()=>{Hp(this)})})}tokenize(t,n=this.defaultMode){if(!qe(this.lexerDefinitionErrors)){const i=ce(this.lexerDefinitionErrors,s=>s.message).join(`-----------------------
`);throw new Error(`Unable to Tokenize because Errors detected in definition of Lexer:
`+i)}return this.tokenizeInternal(t,n)}tokenizeInternal(t,n){let r,i,s,o,a,c,l,u,f,d,h,p,m,b,_;const w=t,v=w.length;let k=0,C=0;const I=this.hasCustom?0:Math.floor(t.length/10),T=new Array(I),L=[];let x=this.trackStartLines?1:void 0,V=this.trackStartLines?1:void 0;const se=lx(this.emptyGroups),O=this.trackStartLines,E=this.config.lineTerminatorsPattern;let g=0,N=[],W=[];const B=[],Z=[];Object.freeze(Z);let H;function Y(){return N}function $(Se){const je=jr(Se),we=W[je];return we===void 0?Z:we}const F=Se=>{if(B.length===1&&Se.tokenType.PUSH_MODE===void 0){const je=this.config.errorMessageProvider.buildUnableToPopLexerModeMessage(Se);L.push({offset:Se.startOffset,line:Se.startLine,column:Se.startColumn,length:Se.image.length,message:je})}else{B.pop();const je=Vi(B);N=this.patternIdxToConfig[je],W=this.charCodeToPatternIdxToConfig[je],g=N.length;const we=this.canModeBeOptimized[je]&&this.config.safeMode===!1;W&&we?H=$:H=Y}};function ue(Se){B.push(Se),W=this.charCodeToPatternIdxToConfig[Se],N=this.patternIdxToConfig[Se],g=N.length,g=N.length;const je=this.canModeBeOptimized[Se]&&this.config.safeMode===!1;W&&je?H=$:H=Y}ue.call(this,n);let Q;const ee=this.config.recoveryEnabled;for(;k<v;){c=null;const Se=w.charCodeAt(k),je=H(Se),we=je.length;for(r=0;r<we;r++){Q=je[r];const _e=Q.pattern;l=null;const ze=Q.short;if(ze!==!1?Se===ze&&(c=_e):Q.isCustom===!0?(_=_e.exec(w,k,T,se),_!==null?(c=_[0],_.payload!==void 0&&(l=_.payload)):c=null):(this.updateLastIndex(_e,k),c=this.match(_e,t,k)),c!==null){if(a=Q.longerAlt,a!==void 0){const $e=a.length;for(s=0;s<$e;s++){const mt=N[a[s]],St=mt.pattern;if(u=null,mt.isCustom===!0?(_=St.exec(w,k,T,se),_!==null?(o=_[0],_.payload!==void 0&&(u=_.payload)):o=null):(this.updateLastIndex(St,k),o=this.match(St,t,k)),o&&o.length>c.length){c=o,l=u,Q=mt;break}}}break}}if(c!==null){if(f=c.length,d=Q.group,d!==void 0&&(h=Q.tokenTypeIdx,p=this.createTokenInstance(c,k,h,Q.tokenType,x,V,f),this.handlePayload(p,l),d===!1?C=this.addToken(T,C,p):se[d].push(p)),t=this.chopInput(t,f),k=k+f,V=this.computeNewColumn(V,f),O===!0&&Q.canLineTerminator===!0){let _e=0,ze,$e;E.lastIndex=0;do ze=E.test(c),ze===!0&&($e=E.lastIndex-1,_e++);while(ze===!0);_e!==0&&(x=x+_e,V=f-$e,this.updateTokenEndLineColumnLocation(p,d,$e,_e,x,V,f))}this.handleModes(Q,F,ue,p)}else{const _e=k,ze=x,$e=V;let mt=ee===!1;for(;mt===!1&&k<v;)for(t=this.chopInput(t,1),k++,i=0;i<g;i++){const St=N[i],y=St.pattern,K=St.short;if(K!==!1?w.charCodeAt(k)===K&&(mt=!0):St.isCustom===!0?mt=y.exec(w,k,T,se)!==null:(this.updateLastIndex(y,k),mt=y.exec(t)!==null),mt===!0)break}if(m=k-_e,V=this.computeNewColumn(V,m),b=this.config.errorMessageProvider.buildUnexpectedCharactersMessage(w,_e,m,ze,$e),L.push({offset:_e,line:ze,column:$e,length:m,message:b}),ee===!1)break}}return this.hasCustom||(T.length=C),{tokens:T,groups:se,errors:L}}handleModes(t,n,r,i){if(t.pop===!0){const s=t.push;n(i),s!==void 0&&r.call(this,s)}else t.push!==void 0&&r.call(this,t.push)}chopInput(t,n){return t.substring(n)}updateLastIndex(t,n){t.lastIndex=n}updateTokenEndLineColumnLocation(t,n,r,i,s,o,a){let c,l;n!==void 0&&(c=r===a-1,l=c?-1:0,i===1&&c===!0||(t.endLine=s+l,t.endColumn=o-1+-l))}computeNewColumn(t,n){return t+n}createOffsetOnlyToken(t,n,r,i){return{image:t,startOffset:n,tokenTypeIdx:r,tokenType:i}}createStartOnlyToken(t,n,r,i,s,o){return{image:t,startOffset:n,startLine:s,startColumn:o,tokenTypeIdx:r,tokenType:i}}createFullToken(t,n,r,i,s,o,a){return{image:t,startOffset:n,endOffset:n+a-1,startLine:s,endLine:s,startColumn:o,endColumn:o+a-1,tokenTypeIdx:r,tokenType:i}}addTokenUsingPush(t,n,r){return t.push(r),n}addTokenUsingMemberAccess(t,n,r){return t[n]=r,n++,n}handlePayloadNoCustom(t,n){}handlePayloadWithCustom(t,n){n!==null&&(t.payload=n)}matchWithTest(t,n,r){return t.test(n)===!0?n.substring(r,t.lastIndex):null}matchWithExec(t,n){const r=t.exec(n);return r!==null?r[0]:null}}wt.SKIPPED="This marks a skipped Token pattern, this means each token identified by it willbe consumed and then thrown into oblivion, this can be used to for example to completely ignore whitespace.",wt.NA=/NOT_APPLICABLE/;function Ws(e){return lm(e)?e.LABEL:e.name}function lm(e){return Jt(e.LABEL)&&e.LABEL!==""}const Ex="parent",um="categories",fm="label",hm="group",dm="push_mode",pm="pop_mode",mm="longer_alt",gm="line_breaks",ym="start_chars_hint";function on(e){return kx(e)}function kx(e){const t=e.pattern,n={};if(n.name=e.name,wr(t)||(n.PATTERN=t),pe(e,Ex))throw`The parent property is no longer supported.
See: https://github.com/chevrotain/chevrotain/issues/564#issuecomment-349062346 for details.`;return pe(e,um)&&(n.CATEGORIES=e[um]),js([n]),pe(e,fm)&&(n.LABEL=e[fm]),pe(e,hm)&&(n.GROUP=e[hm]),pe(e,pm)&&(n.POP_MODE=e[pm]),pe(e,dm)&&(n.PUSH_MODE=e[dm]),pe(e,mm)&&(n.LONGER_ALT=e[mm]),pe(e,gm)&&(n.LINE_BREAKS=e[gm]),pe(e,ym)&&(n.START_CHARS_HINT=e[ym]),n}const gi=on({name:"EOF",pattern:wt.NA});js([gi]);function Ia(e,t,n,r,i,s,o,a){return{image:t,startOffset:n,endOffset:r,startLine:i,endLine:s,startColumn:o,endColumn:a,tokenTypeIdx:e.tokenTypeIdx,tokenType:e}}function Sx(e,t){return $s(e,t)}const _m={buildMismatchTokenMessage({expected:e,actual:t,previous:n,ruleName:r}){return`Expecting ${lm(e)?`--> ${Ws(e)} <--`:`token of type --> ${e.name} <--`} but found --> '${t.image}' <--`},buildNotAllInputParsedMessage({firstRedundant:e,ruleName:t}){return"Redundant input, expecting EOF but found: "+e.image},buildNoViableAltMessage({expectedPathsPerAlt:e,actual:t,previous:n,customUserDescription:r,ruleName:i}){const s="Expecting: ",a=`
but found: '`+In(t).image+"'";if(r)return s+r+a;{const c=Zt(e,(d,h)=>d.concat(h),[]),l=ce(c,d=>`[${ce(d,h=>Ws(h)).join(", ")}]`),f=`one of these possible Token sequences:
${ce(l,(d,h)=>`  ${h+1}. ${d}`).join(`
`)}`;return s+f+a}},buildEarlyExitMessage({expectedIterationPaths:e,actual:t,customUserDescription:n,ruleName:r}){const i="Expecting: ",o=`
but found: '`+In(t).image+"'";if(n)return i+n+o;{const c=`expecting at least one iteration which starts with one of these possible Token sequences::
  <${ce(e,l=>`[${ce(l,u=>Ws(u)).join(",")}]`).join(" ,")}>`;return i+c+o}}};Object.freeze(_m);const Ax={buildRuleNotFoundError(e,t){return"Invalid grammar, reference to a rule which is not defined: ->"+t.nonTerminalName+`<-
inside top level rule: ->`+e.name+"<-"}},yi={buildDuplicateFoundError(e,t){function n(u){return u instanceof tt?u.terminalType.name:u instanceof Yt?u.nonTerminalName:""}const r=e.name,i=In(t),s=i.idx,o=qn(i),a=n(i),c=s>0;let l=`->${o}${c?s:""}<- ${a?`with argument: ->${a}<-`:""}
                  appears more than once (${t.length} times) in the top level rule: ->${r}<-.                  
                  For further details see: https://chevrotain.io/docs/FAQ.html#NUMERICAL_SUFFIXES 
                  `;return l=l.replace(/[ \t]+/g," "),l=l.replace(/\s\s+/g,`
`),l},buildNamespaceConflictError(e){return`Namespace conflict found in grammar.
The grammar has both a Terminal(Token) and a Non-Terminal(Rule) named: <${e.name}>.
To resolve this make sure each Terminal and Non-Terminal names are unique
This is easy to accomplish by using the convention that Terminal names start with an uppercase letter
and Non-Terminal names start with a lower case letter.`},buildAlternationPrefixAmbiguityError(e){const t=ce(e.prefixPath,i=>Ws(i)).join(", "),n=e.alternation.idx===0?"":e.alternation.idx;return`Ambiguous alternatives: <${e.ambiguityIndices.join(" ,")}> due to common lookahead prefix
in <OR${n}> inside <${e.topLevelRule.name}> Rule,
<${t}> may appears as a prefix path in all these alternatives.
See: https://chevrotain.io/docs/guide/resolving_grammar_errors.html#COMMON_PREFIX
For Further details.`},buildAlternationAmbiguityError(e){const t=ce(e.prefixPath,i=>Ws(i)).join(", "),n=e.alternation.idx===0?"":e.alternation.idx;let r=`Ambiguous Alternatives Detected: <${e.ambiguityIndices.join(" ,")}> in <OR${n}> inside <${e.topLevelRule.name}> Rule,
<${t}> may appears as a prefix path in all these alternatives.
`;return r=r+`See: https://chevrotain.io/docs/guide/resolving_grammar_errors.html#AMBIGUOUS_ALTERNATIVES
For Further details.`,r},buildEmptyRepetitionError(e){let t=qn(e.repetition);return e.repetition.idx!==0&&(t+=e.repetition.idx),`The repetition <${t}> within Rule <${e.topLevelRule.name}> can never consume any tokens.
This could lead to an infinite loop.`},buildTokenNameError(e){return"deprecated"},buildEmptyAlternationError(e){return`Ambiguous empty alternative: <${e.emptyChoiceIdx+1}> in <OR${e.alternation.idx}> inside <${e.topLevelRule.name}> Rule.
Only the last alternative may be an empty alternative.`},buildTooManyAlternativesError(e){return`An Alternation cannot have more than 256 alternatives:
<OR${e.alternation.idx}> inside <${e.topLevelRule.name}> Rule.
 has ${e.alternation.definition.length+1} alternatives.`},buildLeftRecursionError(e){const t=e.topLevelRule.name,n=ce(e.leftRecursionPath,s=>s.name),r=`${t} --> ${n.concat([t]).join(" --> ")}`;return`Left Recursion found in grammar.
rule: <${t}> can be invoked from itself (directly or indirectly)
without consuming any Tokens. The grammar path that causes this is: 
 ${r}
 To fix this refactor your grammar to remove the left recursion.
see: https://en.wikipedia.org/wiki/LL_parser#Left_factoring.`},buildInvalidRuleNameError(e){return"deprecated"},buildDuplicateRuleNameError(e){let t;return e.topLevelRule instanceof qi?t=e.topLevelRule.name:t=e.topLevelRule,`Duplicate definition, rule: ->${t}<- is already defined in the grammar: ->${e.grammarName}<-`}};function Tx(e,t){const n=new xx(e,t);return n.resolveRefs(),n.errors}class xx extends pi{constructor(t,n){super(),this.nameToTopRule=t,this.errMsgProvider=n,this.errors=[]}resolveRefs(){me(ht(this.nameToTopRule),t=>{this.currTopLevel=t,t.accept(this)})}visitNonTerminal(t){const n=this.nameToTopRule[t.nonTerminalName];if(n)t.referencedRule=n;else{const r=this.errMsgProvider.buildRuleNotFoundError(this.currTopLevel,t);this.errors.push({message:r,type:Wt.UNRESOLVED_SUBRULE_REF,ruleName:this.currTopLevel.name,unresolvedRefName:t.nonTerminalName})}}}class Rx extends _a{constructor(t,n){super(),this.topProd=t,this.path=n,this.possibleTokTypes=[],this.nextProductionName="",this.nextProductionOccurrence=0,this.found=!1,this.isAtEndOfPath=!1}startWalking(){if(this.found=!1,this.path.ruleStack[0]!==this.topProd.name)throw Error("The path does not start with the walker's top Rule!");return this.ruleStack=Mt(this.path.ruleStack).reverse(),this.occurrenceStack=Mt(this.path.occurrenceStack).reverse(),this.ruleStack.pop(),this.occurrenceStack.pop(),this.updateExpectedNext(),this.walk(this.topProd),this.possibleTokTypes}walk(t,n=[]){this.found||super.walk(t,n)}walkProdRef(t,n,r){if(t.referencedRule.name===this.nextProductionName&&t.idx===this.nextProductionOccurrence){const i=n.concat(r);this.updateExpectedNext(),this.walk(t.referencedRule,i)}}updateExpectedNext(){qe(this.ruleStack)?(this.nextProductionName="",this.nextProductionOccurrence=0,this.isAtEndOfPath=!0):(this.nextProductionName=this.ruleStack.pop(),this.nextProductionOccurrence=this.occurrenceStack.pop())}}class Ix extends Rx{constructor(t,n){super(t,n),this.path=n,this.nextTerminalName="",this.nextTerminalOccurrence=0,this.nextTerminalName=this.path.lastTok.name,this.nextTerminalOccurrence=this.path.lastTokOccurrence}walkTerminal(t,n,r){if(this.isAtEndOfPath&&t.terminalType.name===this.nextTerminalName&&t.idx===this.nextTerminalOccurrence&&!this.found){const i=n.concat(r),s=new Qt({definition:i});this.possibleTokTypes=Ps(s),this.found=!0}}}class Oa extends _a{constructor(t,n){super(),this.topRule=t,this.occurrence=n,this.result={token:void 0,occurrence:void 0,isEndOfRule:void 0}}startWalking(){return this.walk(this.topRule),this.result}}class Ox extends Oa{walkMany(t,n,r){if(t.idx===this.occurrence){const i=In(n.concat(r));this.result.isEndOfRule=i===void 0,i instanceof tt&&(this.result.token=i.terminalType,this.result.occurrence=i.idx)}else super.walkMany(t,n,r)}}class bm extends Oa{walkManySep(t,n,r){if(t.idx===this.occurrence){const i=In(n.concat(r));this.result.isEndOfRule=i===void 0,i instanceof tt&&(this.result.token=i.terminalType,this.result.occurrence=i.idx)}else super.walkManySep(t,n,r)}}class Nx extends Oa{walkAtLeastOne(t,n,r){if(t.idx===this.occurrence){const i=In(n.concat(r));this.result.isEndOfRule=i===void 0,i instanceof tt&&(this.result.token=i.terminalType,this.result.occurrence=i.idx)}else super.walkAtLeastOne(t,n,r)}}class wm extends Oa{walkAtLeastOneSep(t,n,r){if(t.idx===this.occurrence){const i=In(n.concat(r));this.result.isEndOfRule=i===void 0,i instanceof tt&&(this.result.token=i.terminalType,this.result.occurrence=i.idx)}else super.walkAtLeastOneSep(t,n,r)}}function su(e,t,n=[]){n=Mt(n);let r=[],i=0;function s(a){return a.concat(Ut(e,i+1))}function o(a){const c=su(s(a),t,n);return r.concat(c)}for(;n.length<t&&i<e.length;){const a=e[i];if(a instanceof Qt)return o(a.definition);if(a instanceof Yt)return o(a.definition);if(a instanceof en)r=o(a.definition);else if(a instanceof Vn){const c=a.definition.concat([new bt({definition:a.definition})]);return o(c)}else if(a instanceof Kn){const c=[new Qt({definition:a.definition}),new bt({definition:[new tt({terminalType:a.separator})].concat(a.definition)})];return o(c)}else if(a instanceof Nn){const c=a.definition.concat([new bt({definition:[new tt({terminalType:a.separator})].concat(a.definition)})]);r=o(c)}else if(a instanceof bt){const c=a.definition.concat([new bt({definition:a.definition})]);r=o(c)}else{if(a instanceof Cn)return me(a.definition,c=>{qe(c.definition)===!1&&(r=o(c.definition))}),r;if(a instanceof tt)n.push(a.terminalType);else throw Error("non exhaustive match")}i++}return r.push({partialPath:n,suffixDef:Ut(e,i)}),r}function vm(e,t,n,r){const i="EXIT_NONE_TERMINAL",s=[i],o="EXIT_ALTERNATIVE";let a=!1;const c=t.length,l=c-r-1,u=[],f=[];for(f.push({idx:-1,def:e,ruleStack:[],occurrenceStack:[]});!qe(f);){const d=f.pop();if(d===o){a&&Vi(f).idx<=l&&f.pop();continue}const h=d.def,p=d.idx,m=d.ruleStack,b=d.occurrenceStack;if(qe(h))continue;const _=h[0];if(_===i){const w={idx:p,def:Ut(h),ruleStack:Us(m),occurrenceStack:Us(b)};f.push(w)}else if(_ instanceof tt)if(p<c-1){const w=p+1,v=t[w];if(n(v,_.terminalType)){const k={idx:w,def:Ut(h),ruleStack:m,occurrenceStack:b};f.push(k)}}else if(p===c-1)u.push({nextTokenType:_.terminalType,nextTokenOccurrence:_.idx,ruleStack:m,occurrenceStack:b}),a=!0;else throw Error("non exhaustive match");else if(_ instanceof Yt){const w=Mt(m);w.push(_.nonTerminalName);const v=Mt(b);v.push(_.idx);const k={idx:p,def:_.definition.concat(s,Ut(h)),ruleStack:w,occurrenceStack:v};f.push(k)}else if(_ instanceof en){const w={idx:p,def:Ut(h),ruleStack:m,occurrenceStack:b};f.push(w),f.push(o);const v={idx:p,def:_.definition.concat(Ut(h)),ruleStack:m,occurrenceStack:b};f.push(v)}else if(_ instanceof Vn){const w=new bt({definition:_.definition,idx:_.idx}),v=_.definition.concat([w],Ut(h)),k={idx:p,def:v,ruleStack:m,occurrenceStack:b};f.push(k)}else if(_ instanceof Kn){const w=new tt({terminalType:_.separator}),v=new bt({definition:[w].concat(_.definition),idx:_.idx}),k=_.definition.concat([v],Ut(h)),C={idx:p,def:k,ruleStack:m,occurrenceStack:b};f.push(C)}else if(_ instanceof Nn){const w={idx:p,def:Ut(h),ruleStack:m,occurrenceStack:b};f.push(w),f.push(o);const v=new tt({terminalType:_.separator}),k=new bt({definition:[v].concat(_.definition),idx:_.idx}),C=_.definition.concat([k],Ut(h)),I={idx:p,def:C,ruleStack:m,occurrenceStack:b};f.push(I)}else if(_ instanceof bt){const w={idx:p,def:Ut(h),ruleStack:m,occurrenceStack:b};f.push(w),f.push(o);const v=new bt({definition:_.definition,idx:_.idx}),k=_.definition.concat([v],Ut(h)),C={idx:p,def:k,ruleStack:m,occurrenceStack:b};f.push(C)}else if(_ instanceof Cn)for(let w=_.definition.length-1;w>=0;w--){const v=_.definition[w],k={idx:p,def:v.definition.concat(Ut(h)),ruleStack:m,occurrenceStack:b};f.push(k),f.push(o)}else if(_ instanceof Qt)f.push({idx:p,def:_.definition.concat(Ut(h)),ruleStack:m,occurrenceStack:b});else if(_ instanceof qi)f.push(Cx(_,p,m,b));else throw Error("non exhaustive match")}return u}function Cx(e,t,n,r){const i=Mt(n);i.push(e.name);const s=Mt(r);return s.push(1),{idx:t,def:e.definition,ruleStack:i,occurrenceStack:s}}var st;(function(e){e[e.OPTION=0]="OPTION",e[e.REPETITION=1]="REPETITION",e[e.REPETITION_MANDATORY=2]="REPETITION_MANDATORY",e[e.REPETITION_MANDATORY_WITH_SEPARATOR=3]="REPETITION_MANDATORY_WITH_SEPARATOR",e[e.REPETITION_WITH_SEPARATOR=4]="REPETITION_WITH_SEPARATOR",e[e.ALTERNATION=5]="ALTERNATION"})(st||(st={}));function Em(e){if(e instanceof en||e==="Option")return st.OPTION;if(e instanceof bt||e==="Repetition")return st.REPETITION;if(e instanceof Vn||e==="RepetitionMandatory")return st.REPETITION_MANDATORY;if(e instanceof Kn||e==="RepetitionMandatoryWithSeparator")return st.REPETITION_MANDATORY_WITH_SEPARATOR;if(e instanceof Nn||e==="RepetitionWithSeparator")return st.REPETITION_WITH_SEPARATOR;if(e instanceof Cn||e==="Alternation")return st.ALTERNATION;throw Error("non exhaustive match")}function Lx(e,t,n,r,i,s){const o=au(e,t,n),a=Tm(o)?Ra:$s;return s(o,r,a,i)}function Mx(e,t,n,r,i,s){const o=cu(e,t,i,n),a=Tm(o)?Ra:$s;return s(o[0],a,r)}function Ux(e,t,n,r){const i=e.length,s=Rn(e,o=>Rn(o,a=>a.length===1));if(t)return function(o){const a=ce(o,c=>c.GATE);for(let c=0;c<i;c++){const l=e[c],u=l.length,f=a[c];if(!(f!==void 0&&f.call(this)===!1))e:for(let d=0;d<u;d++){const h=l[d],p=h.length;for(let m=0;m<p;m++){const b=this.LA(m+1);if(n(b,h[m])===!1)continue e}return c}}};if(s&&!r){const o=ce(e,c=>sn(c)),a=Zt(o,(c,l,u)=>(me(l,f=>{pe(c,f.tokenTypeIdx)||(c[f.tokenTypeIdx]=u),me(f.categoryMatches,d=>{pe(c,d)||(c[d]=u)})}),c),{});return function(){const c=this.LA(1);return a[c.tokenTypeIdx]}}else return function(){for(let o=0;o<i;o++){const a=e[o],c=a.length;e:for(let l=0;l<c;l++){const u=a[l],f=u.length;for(let d=0;d<f;d++){const h=this.LA(d+1);if(n(h,u[d])===!1)continue e}return o}}}}function Px(e,t,n){const r=Rn(e,s=>s.length===1),i=e.length;if(r&&!n){const s=sn(e);if(s.length===1&&qe(s[0].categoryMatches)){const a=s[0].tokenTypeIdx;return function(){return this.LA(1).tokenTypeIdx===a}}else{const o=Zt(s,(a,c,l)=>(a[c.tokenTypeIdx]=!0,me(c.categoryMatches,u=>{a[u]=!0}),a),[]);return function(){const a=this.LA(1);return o[a.tokenTypeIdx]===!0}}}else return function(){e:for(let s=0;s<i;s++){const o=e[s],a=o.length;for(let c=0;c<a;c++){const l=this.LA(c+1);if(t(l,o[c])===!1)continue e}return!0}return!1}}class Dx extends _a{constructor(t,n,r){super(),this.topProd=t,this.targetOccurrence=n,this.targetProdType=r}startWalking(){return this.walk(this.topProd),this.restDef}checkIsTarget(t,n,r,i){return t.idx===this.targetOccurrence&&this.targetProdType===n?(this.restDef=r.concat(i),!0):!1}walkOption(t,n,r){this.checkIsTarget(t,st.OPTION,n,r)||super.walkOption(t,n,r)}walkAtLeastOne(t,n,r){this.checkIsTarget(t,st.REPETITION_MANDATORY,n,r)||super.walkOption(t,n,r)}walkAtLeastOneSep(t,n,r){this.checkIsTarget(t,st.REPETITION_MANDATORY_WITH_SEPARATOR,n,r)||super.walkOption(t,n,r)}walkMany(t,n,r){this.checkIsTarget(t,st.REPETITION,n,r)||super.walkOption(t,n,r)}walkManySep(t,n,r){this.checkIsTarget(t,st.REPETITION_WITH_SEPARATOR,n,r)||super.walkOption(t,n,r)}}class km extends pi{constructor(t,n,r){super(),this.targetOccurrence=t,this.targetProdType=n,this.targetRef=r,this.result=[]}checkIsTarget(t,n){t.idx===this.targetOccurrence&&this.targetProdType===n&&(this.targetRef===void 0||t===this.targetRef)&&(this.result=t.definition)}visitOption(t){this.checkIsTarget(t,st.OPTION)}visitRepetition(t){this.checkIsTarget(t,st.REPETITION)}visitRepetitionMandatory(t){this.checkIsTarget(t,st.REPETITION_MANDATORY)}visitRepetitionMandatoryWithSeparator(t){this.checkIsTarget(t,st.REPETITION_MANDATORY_WITH_SEPARATOR)}visitRepetitionWithSeparator(t){this.checkIsTarget(t,st.REPETITION_WITH_SEPARATOR)}visitAlternation(t){this.checkIsTarget(t,st.ALTERNATION)}}function Sm(e){const t=new Array(e);for(let n=0;n<e;n++)t[n]=[];return t}function ou(e){let t=[""];for(let n=0;n<e.length;n++){const r=e[n],i=[];for(let s=0;s<t.length;s++){const o=t[s];i.push(o+"_"+r.tokenTypeIdx);for(let a=0;a<r.categoryMatches.length;a++){const c="_"+r.categoryMatches[a];i.push(o+c)}}t=i}return t}function Bx(e,t,n){for(let r=0;r<e.length;r++){if(r===n)continue;const i=e[r];for(let s=0;s<t.length;s++){const o=t[s];if(i[o]===!0)return!1}}return!0}function Am(e,t){const n=ce(e,o=>su([o],1)),r=Sm(n.length),i=ce(n,o=>{const a={};return me(o,c=>{const l=ou(c.partialPath);me(l,u=>{a[u]=!0})}),a});let s=n;for(let o=1;o<=t;o++){const a=s;s=Sm(a.length);for(let c=0;c<a.length;c++){const l=a[c];for(let u=0;u<l.length;u++){const f=l[u].partialPath,d=l[u].suffixDef,h=ou(f);if(Bx(i,h,c)||qe(d)||f.length===t){const m=r[c];if(lu(m,f)===!1){m.push(f);for(let b=0;b<h.length;b++){const _=h[b];i[c][_]=!0}}}else{const m=su(d,o+1,f);s[c]=s[c].concat(m),me(m,b=>{const _=ou(b.partialPath);me(_,w=>{i[c][w]=!0})})}}}}return r}function au(e,t,n,r){const i=new km(e,st.ALTERNATION,r);return t.accept(i),Am(i.result,n)}function cu(e,t,n,r){const i=new km(e,n);t.accept(i);const s=i.result,a=new Dx(t,e,n).startWalking(),c=new Qt({definition:s}),l=new Qt({definition:a});return Am([c,l],r)}function lu(e,t){e:for(let n=0;n<e.length;n++){const r=e[n];if(r.length===t.length){for(let i=0;i<r.length;i++){const s=t[i],o=r[i];if((s===o||o.categoryMatchesMap[s.tokenTypeIdx]!==void 0)===!1)continue e}return!0}}return!1}function Fx(e,t){return e.length<t.length&&Rn(e,(n,r)=>{const i=t[r];return n===i||i.categoryMatchesMap[n.tokenTypeIdx]})}function Tm(e){return Rn(e,t=>Rn(t,n=>Rn(n,r=>qe(r.categoryMatches))))}function $x(e){const t=e.lookaheadStrategy.validate({rules:e.rules,tokenTypes:e.tokenTypes,grammarName:e.grammarName});return ce(t,n=>Object.assign({type:Wt.CUSTOM_LOOKAHEAD_VALIDATION},n))}function jx(e,t,n,r){const i=wn(e,c=>zx(c,n)),s=eR(e,t,n),o=wn(e,c=>Jx(c,n)),a=wn(e,c=>Hx(c,e,r,n));return i.concat(s,o,a)}function zx(e,t){const n=new Gx;e.accept(n);const r=n.allProductions,i=$p(r,Wx),s=On(i,a=>a.length>1);return ce(ht(s),a=>{const c=In(a),l=t.buildDuplicateFoundError(e,a),u=qn(c),f={message:l,type:Wt.DUPLICATE_PRODUCTIONS,ruleName:e.name,dslName:u,occurrence:c.idx},d=xm(c);return d&&(f.parameter=d),f})}function Wx(e){return`${qn(e)}_#_${e.idx}_#_${xm(e)}`}function xm(e){return e instanceof tt?e.terminalType.name:e instanceof Yt?e.nonTerminalName:""}class Gx extends pi{constructor(){super(...arguments),this.allProductions=[]}visitNonTerminal(t){this.allProductions.push(t)}visitOption(t){this.allProductions.push(t)}visitRepetitionWithSeparator(t){this.allProductions.push(t)}visitRepetitionMandatory(t){this.allProductions.push(t)}visitRepetitionMandatoryWithSeparator(t){this.allProductions.push(t)}visitRepetition(t){this.allProductions.push(t)}visitAlternation(t){this.allProductions.push(t)}visitTerminal(t){this.allProductions.push(t)}}function Hx(e,t,n,r){const i=[];if(Zt(t,(o,a)=>a.name===e.name?o+1:o,0)>1){const o=r.buildDuplicateRuleNameError({topLevelRule:e,grammarName:n});i.push({message:o,type:Wt.DUPLICATE_RULE_NAME,ruleName:e.name})}return i}function Vx(e,t,n){const r=[];let i;return zt(t,e)||(i=`Invalid rule override, rule: ->${e}<- cannot be overridden in the grammar: ->${n}<-as it is not defined in any of the super grammars `,r.push({message:i,type:Wt.INVALID_RULE_OVERRIDE,ruleName:e})),r}function Rm(e,t,n,r=[]){const i=[],s=Na(t.definition);if(qe(s))return[];{const o=e.name;zt(s,e)&&i.push({message:n.buildLeftRecursionError({topLevelRule:e,leftRecursionPath:r}),type:Wt.LEFT_RECURSION,ruleName:o});const c=da(s,r.concat([e])),l=wn(c,u=>{const f=Mt(r);return f.push(u),Rm(e,u,n,f)});return i.concat(l)}}function Na(e){let t=[];if(qe(e))return t;const n=In(e);if(n instanceof Yt)t.push(n.referencedRule);else if(n instanceof Qt||n instanceof en||n instanceof Vn||n instanceof Kn||n instanceof Nn||n instanceof bt)t=t.concat(Na(n.definition));else if(n instanceof Cn)t=sn(ce(n.definition,s=>Na(s.definition)));else if(!(n instanceof tt))throw Error("non exhaustive match");const r=ya(n),i=e.length>1;if(r&&i){const s=Ut(e);return t.concat(Na(s))}else return t}class uu extends pi{constructor(){super(...arguments),this.alternations=[]}visitAlternation(t){this.alternations.push(t)}}function Kx(e,t){const n=new uu;e.accept(n);const r=n.alternations;return wn(r,s=>{const o=Us(s.definition);return wn(o,(a,c)=>{const l=vm([a],[],$s,1);return qe(l)?[{message:t.buildEmptyAlternationError({topLevelRule:e,alternation:s,emptyChoiceIdx:c}),type:Wt.NONE_LAST_EMPTY_ALT,ruleName:e.name,occurrence:s.idx,alternative:c+1}]:[]})})}function qx(e,t,n){const r=new uu;e.accept(r);let i=r.alternations;return i=pa(i,o=>o.ignoreAmbiguities===!0),wn(i,o=>{const a=o.idx,c=o.maxLookahead||t,l=au(a,e,c,o),u=Yx(l,o,e,n),f=Qx(l,o,e,n);return u.concat(f)})}class Xx extends pi{constructor(){super(...arguments),this.allProductions=[]}visitRepetitionWithSeparator(t){this.allProductions.push(t)}visitRepetitionMandatory(t){this.allProductions.push(t)}visitRepetitionMandatoryWithSeparator(t){this.allProductions.push(t)}visitRepetition(t){this.allProductions.push(t)}}function Jx(e,t){const n=new uu;e.accept(n);const r=n.alternations;return wn(r,s=>s.definition.length>255?[{message:t.buildTooManyAlternativesError({topLevelRule:e,alternation:s}),type:Wt.TOO_MANY_ALTS,ruleName:e.name,occurrence:s.idx}]:[])}function Zx(e,t,n){const r=[];return me(e,i=>{const s=new Xx;i.accept(s);const o=s.allProductions;me(o,a=>{const c=Em(a),l=a.maxLookahead||t,u=a.idx,d=cu(u,i,c,l)[0];if(qe(sn(d))){const h=n.buildEmptyRepetitionError({topLevelRule:i,repetition:a});r.push({message:h,type:Wt.NO_NON_EMPTY_LOOKAHEAD,ruleName:i.name})}})}),r}function Yx(e,t,n,r){const i=[],s=Zt(e,(a,c,l)=>(t.definition[l].ignoreAmbiguities===!0||me(c,u=>{const f=[l];me(e,(d,h)=>{l!==h&&lu(d,u)&&t.definition[h].ignoreAmbiguities!==!0&&f.push(h)}),f.length>1&&!lu(i,u)&&(i.push(u),a.push({alts:f,path:u}))}),a),[]);return ce(s,a=>{const c=ce(a.alts,u=>u+1);return{message:r.buildAlternationAmbiguityError({topLevelRule:n,alternation:t,ambiguityIndices:c,prefixPath:a.path}),type:Wt.AMBIGUOUS_ALTS,ruleName:n.name,occurrence:t.idx,alternatives:a.alts}})}function Qx(e,t,n,r){const i=Zt(e,(o,a,c)=>{const l=ce(a,u=>({idx:c,path:u}));return o.concat(l)},[]);return Ms(wn(i,o=>{if(t.definition[o.idx].ignoreAmbiguities===!0)return[];const c=o.idx,l=o.path,u=bn(i,d=>t.definition[d.idx].ignoreAmbiguities!==!0&&d.idx<c&&Fx(d.path,l));return ce(u,d=>{const h=[d.idx+1,c+1],p=t.idx===0?"":t.idx;return{message:r.buildAlternationPrefixAmbiguityError({topLevelRule:n,alternation:t,ambiguityIndices:h,prefixPath:d.path}),type:Wt.AMBIGUOUS_PREFIX_ALTS,ruleName:n.name,occurrence:p,alternatives:h}})}))}function eR(e,t,n){const r=[],i=ce(t,s=>s.name);return me(e,s=>{const o=s.name;if(zt(i,o)){const a=n.buildNamespaceConflictError(s);r.push({message:a,type:Wt.CONFLICT_TOKENS_RULES_NAMESPACE,ruleName:o})}}),r}function tR(e){const t=Jl(e,{errMsgProvider:Ax}),n={};return me(e.rules,r=>{n[r.name]=r}),Tx(n,t.errMsgProvider)}function nR(e){return e=Jl(e,{errMsgProvider:yi}),jx(e.rules,e.tokenTypes,e.errMsgProvider,e.grammarName)}const Im="MismatchedTokenException",Om="NoViableAltException",Nm="EarlyExitException",Cm="NotAllInputParsedException",Lm=[Im,Om,Nm,Cm];Object.freeze(Lm);function Ca(e){return zt(Lm,e.name)}class La extends Error{constructor(t,n){super(t),this.token=n,this.resyncedTokens=[],Object.setPrototypeOf(this,new.target.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor)}}class Mm extends La{constructor(t,n,r){super(t,n),this.previousToken=r,this.name=Im}}class rR extends La{constructor(t,n,r){super(t,n),this.previousToken=r,this.name=Om}}class iR extends La{constructor(t,n){super(t,n),this.name=Cm}}class sR extends La{constructor(t,n,r){super(t,n),this.previousToken=r,this.name=Nm}}const fu={},Um="InRuleRecoveryException";class oR extends Error{constructor(t){super(t),this.name=Um}}class aR{initRecoverable(t){this.firstAfterRepMap={},this.resyncFollows={},this.recoveryEnabled=pe(t,"recoveryEnabled")?t.recoveryEnabled:vr.recoveryEnabled,this.recoveryEnabled&&(this.attemptInRepetitionRecovery=cR)}getTokenToInsert(t){const n=Ia(t,"",NaN,NaN,NaN,NaN,NaN,NaN);return n.isInsertedInRecovery=!0,n}canTokenTypeBeInsertedInRecovery(t){return!0}canTokenTypeBeDeletedInRecovery(t){return!0}tryInRepetitionRecovery(t,n,r,i){const s=this.findReSyncTokenType(),o=this.exportLexerState(),a=[];let c=!1;const l=this.LA(1);let u=this.LA(1);const f=()=>{const d=this.LA(0),h=this.errorMessageProvider.buildMismatchTokenMessage({expected:i,actual:l,previous:d,ruleName:this.getCurrRuleFullName()}),p=new Mm(h,l,this.LA(0));p.resyncedTokens=Us(a),this.SAVE_ERROR(p)};for(;!c;)if(this.tokenMatcher(u,i)){f();return}else if(r.call(this)){f(),t.apply(this,n);return}else this.tokenMatcher(u,s)?c=!0:(u=this.SKIP_TOKEN(),this.addToResyncTokens(u,a));this.importLexerState(o)}shouldInRepetitionRecoveryBeTried(t,n,r){return!(r===!1||this.tokenMatcher(this.LA(1),t)||this.isBackTracking()||this.canPerformInRuleRecovery(t,this.getFollowsForInRuleRecovery(t,n)))}getFollowsForInRuleRecovery(t,n){const r=this.getCurrentGrammarPath(t,n);return this.getNextPossibleTokenTypes(r)}tryInRuleRecovery(t,n){if(this.canRecoverWithSingleTokenInsertion(t,n))return this.getTokenToInsert(t);if(this.canRecoverWithSingleTokenDeletion(t)){const r=this.SKIP_TOKEN();return this.consumeToken(),r}throw new oR("sad sad panda")}canPerformInRuleRecovery(t,n){return this.canRecoverWithSingleTokenInsertion(t,n)||this.canRecoverWithSingleTokenDeletion(t)}canRecoverWithSingleTokenInsertion(t,n){if(!this.canTokenTypeBeInsertedInRecovery(t)||qe(n))return!1;const r=this.LA(1);return Ki(n,s=>this.tokenMatcher(r,s))!==void 0}canRecoverWithSingleTokenDeletion(t){return this.canTokenTypeBeDeletedInRecovery(t)?this.tokenMatcher(this.LA(2),t):!1}isInCurrentRuleReSyncSet(t){const n=this.getCurrFollowKey(),r=this.getFollowSetFromFollowKey(n);return zt(r,t)}findReSyncTokenType(){const t=this.flattenFollowSet();let n=this.LA(1),r=2;for(;;){const i=Ki(t,s=>Sx(n,s));if(i!==void 0)return i;n=this.LA(r),r++}}getCurrFollowKey(){if(this.RULE_STACK.length===1)return fu;const t=this.getLastExplicitRuleShortName(),n=this.getLastExplicitRuleOccurrenceIndex(),r=this.getPreviousExplicitRuleShortName();return{ruleName:this.shortRuleNameToFullName(t),idxInCallingRule:n,inRule:this.shortRuleNameToFullName(r)}}buildFullFollowKeyStack(){const t=this.RULE_STACK,n=this.RULE_OCCURRENCE_STACK;return ce(t,(r,i)=>i===0?fu:{ruleName:this.shortRuleNameToFullName(r),idxInCallingRule:n[i],inRule:this.shortRuleNameToFullName(t[i-1])})}flattenFollowSet(){const t=ce(this.buildFullFollowKeyStack(),n=>this.getFollowSetFromFollowKey(n));return sn(t)}getFollowSetFromFollowKey(t){if(t===fu)return[gi];const n=t.ruleName+t.idxInCallingRule+Kp+t.inRule;return this.resyncFollows[n]}addToResyncTokens(t,n){return this.tokenMatcher(t,gi)||n.push(t),n}reSyncTo(t){const n=[];let r=this.LA(1);for(;this.tokenMatcher(r,t)===!1;)r=this.SKIP_TOKEN(),this.addToResyncTokens(r,n);return Us(n)}attemptInRepetitionRecovery(t,n,r,i,s,o,a){}getCurrentGrammarPath(t,n){const r=this.getHumanReadableRuleStack(),i=Mt(this.RULE_OCCURRENCE_STACK);return{ruleStack:r,occurrenceStack:i,lastTok:t,lastTokOccurrence:n}}getHumanReadableRuleStack(){return ce(this.RULE_STACK,t=>this.shortRuleNameToFullName(t))}}function cR(e,t,n,r,i,s,o){const a=this.getKeyForAutomaticLookahead(r,i);let c=this.firstAfterRepMap[a];if(c===void 0){const d=this.getCurrRuleFullName(),h=this.getGAstProductions()[d];c=new s(h,i).startWalking(),this.firstAfterRepMap[a]=c}let l=c.token,u=c.occurrence;const f=c.isEndOfRule;this.RULE_STACK.length===1&&f&&l===void 0&&(l=gi,u=1),!(l===void 0||u===void 0)&&this.shouldInRepetitionRecoveryBeTried(l,u,o)&&this.tryInRepetitionRecovery(e,t,n,l)}const lR=4,zr=8,Pm=1<<zr,Dm=2<<zr,hu=3<<zr,du=4<<zr,pu=5<<zr,Ma=6<<zr;function mu(e,t,n){return n|t|e}class uR{constructor(t){var n;this.maxLookahead=(n=t==null?void 0:t.maxLookahead)!==null&&n!==void 0?n:vr.maxLookahead}validate(t){const n=this.validateNoLeftRecursion(t.rules);if(qe(n)){const r=this.validateEmptyOrAlternatives(t.rules),i=this.validateAmbiguousAlternationAlternatives(t.rules,this.maxLookahead),s=this.validateSomeNonEmptyLookaheadPath(t.rules,this.maxLookahead);return[...n,...r,...i,...s]}return n}validateNoLeftRecursion(t){return wn(t,n=>Rm(n,n,yi))}validateEmptyOrAlternatives(t){return wn(t,n=>Kx(n,yi))}validateAmbiguousAlternationAlternatives(t,n){return wn(t,r=>qx(r,n,yi))}validateSomeNonEmptyLookaheadPath(t,n){return Zx(t,n,yi)}buildLookaheadForAlternation(t){return Lx(t.prodOccurrence,t.rule,t.maxLookahead,t.hasPredicates,t.dynamicTokensEnabled,Ux)}buildLookaheadForOptional(t){return Mx(t.prodOccurrence,t.rule,t.maxLookahead,t.dynamicTokensEnabled,Em(t.prodType),Px)}}class fR{initLooksAhead(t){this.dynamicTokensEnabled=pe(t,"dynamicTokensEnabled")?t.dynamicTokensEnabled:vr.dynamicTokensEnabled,this.maxLookahead=pe(t,"maxLookahead")?t.maxLookahead:vr.maxLookahead,this.lookaheadStrategy=pe(t,"lookaheadStrategy")?t.lookaheadStrategy:new uR({maxLookahead:this.maxLookahead}),this.lookAheadFuncsCache=new Map}preComputeLookaheadFunctions(t){me(t,n=>{this.TRACE_INIT(`${n.name} Rule Lookahead`,()=>{const{alternation:r,repetition:i,option:s,repetitionMandatory:o,repetitionMandatoryWithSeparator:a,repetitionWithSeparator:c}=dR(n);me(r,l=>{const u=l.idx===0?"":l.idx;this.TRACE_INIT(`${qn(l)}${u}`,()=>{const f=this.lookaheadStrategy.buildLookaheadForAlternation({prodOccurrence:l.idx,rule:n,maxLookahead:l.maxLookahead||this.maxLookahead,hasPredicates:l.hasPredicates,dynamicTokensEnabled:this.dynamicTokensEnabled}),d=mu(this.fullRuleNameToShort[n.name],Pm,l.idx);this.setLaFuncCache(d,f)})}),me(i,l=>{this.computeLookaheadFunc(n,l.idx,hu,"Repetition",l.maxLookahead,qn(l))}),me(s,l=>{this.computeLookaheadFunc(n,l.idx,Dm,"Option",l.maxLookahead,qn(l))}),me(o,l=>{this.computeLookaheadFunc(n,l.idx,du,"RepetitionMandatory",l.maxLookahead,qn(l))}),me(a,l=>{this.computeLookaheadFunc(n,l.idx,Ma,"RepetitionMandatoryWithSeparator",l.maxLookahead,qn(l))}),me(c,l=>{this.computeLookaheadFunc(n,l.idx,pu,"RepetitionWithSeparator",l.maxLookahead,qn(l))})})})}computeLookaheadFunc(t,n,r,i,s,o){this.TRACE_INIT(`${o}${n===0?"":n}`,()=>{const a=this.lookaheadStrategy.buildLookaheadForOptional({prodOccurrence:n,rule:t,maxLookahead:s||this.maxLookahead,dynamicTokensEnabled:this.dynamicTokensEnabled,prodType:i}),c=mu(this.fullRuleNameToShort[t.name],r,n);this.setLaFuncCache(c,a)})}getKeyForAutomaticLookahead(t,n){const r=this.getLastExplicitRuleShortName();return mu(r,t,n)}getLaFuncFromCache(t){return this.lookAheadFuncsCache.get(t)}setLaFuncCache(t,n){this.lookAheadFuncsCache.set(t,n)}}class hR extends pi{constructor(){super(...arguments),this.dslMethods={option:[],alternation:[],repetition:[],repetitionWithSeparator:[],repetitionMandatory:[],repetitionMandatoryWithSeparator:[]}}reset(){this.dslMethods={option:[],alternation:[],repetition:[],repetitionWithSeparator:[],repetitionMandatory:[],repetitionMandatoryWithSeparator:[]}}visitOption(t){this.dslMethods.option.push(t)}visitRepetitionWithSeparator(t){this.dslMethods.repetitionWithSeparator.push(t)}visitRepetitionMandatory(t){this.dslMethods.repetitionMandatory.push(t)}visitRepetitionMandatoryWithSeparator(t){this.dslMethods.repetitionMandatoryWithSeparator.push(t)}visitRepetition(t){this.dslMethods.repetition.push(t)}visitAlternation(t){this.dslMethods.alternation.push(t)}}const Ua=new hR;function dR(e){Ua.reset(),e.accept(Ua);const t=Ua.dslMethods;return Ua.reset(),t}function Bm(e,t){isNaN(e.startOffset)===!0?(e.startOffset=t.startOffset,e.endOffset=t.endOffset):e.endOffset<t.endOffset&&(e.endOffset=t.endOffset)}function Fm(e,t){isNaN(e.startOffset)===!0?(e.startOffset=t.startOffset,e.startColumn=t.startColumn,e.startLine=t.startLine,e.endOffset=t.endOffset,e.endColumn=t.endColumn,e.endLine=t.endLine):e.endOffset<t.endOffset&&(e.endOffset=t.endOffset,e.endColumn=t.endColumn,e.endLine=t.endLine)}function pR(e,t,n){e.children[n]===void 0?e.children[n]=[t]:e.children[n].push(t)}function mR(e,t,n){e.children[t]===void 0?e.children[t]=[n]:e.children[t].push(n)}const gR="name";function $m(e,t){Object.defineProperty(e,gR,{enumerable:!1,configurable:!0,writable:!1,value:t})}function yR(e,t){const n=yn(e),r=n.length;for(let i=0;i<r;i++){const s=n[i],o=e[s],a=o.length;for(let c=0;c<a;c++){const l=o[c];l.tokenTypeIdx===void 0&&this[l.name](l.children,t)}}}function _R(e,t){const n=function(){};$m(n,e+"BaseSemantics");const r={visit:function(i,s){if(Le(i)&&(i=i[0]),!wr(i))return this[i.name](i.children,s)},validateVisitor:function(){const i=wR(this,t);if(!qe(i)){const s=ce(i,o=>o.msg);throw Error(`Errors Detected in CST Visitor <${this.constructor.name}>:
	${s.join(`

`).replace(/\n/g,`
	`)}`)}}};return n.prototype=r,n.prototype.constructor=n,n._RULE_NAMES=t,n}function bR(e,t,n){const r=function(){};$m(r,e+"BaseSemanticsWithDefaults");const i=Object.create(n.prototype);return me(t,s=>{i[s]=yR}),r.prototype=i,r.prototype.constructor=r,r}var gu;(function(e){e[e.REDUNDANT_METHOD=0]="REDUNDANT_METHOD",e[e.MISSING_METHOD=1]="MISSING_METHOD"})(gu||(gu={}));function wR(e,t){return vR(e,t)}function vR(e,t){const n=bn(t,i=>gr(e[i])===!1),r=ce(n,i=>({msg:`Missing visitor method: <${i}> on ${e.constructor.name} CST Visitor.`,type:gu.MISSING_METHOD,methodName:i}));return Ms(r)}class ER{initTreeBuilder(t){if(this.CST_STACK=[],this.outputCst=t.outputCst,this.nodeLocationTracking=pe(t,"nodeLocationTracking")?t.nodeLocationTracking:vr.nodeLocationTracking,!this.outputCst)this.cstInvocationStateUpdate=_t,this.cstFinallyStateUpdate=_t,this.cstPostTerminal=_t,this.cstPostNonTerminal=_t,this.cstPostRule=_t;else if(/full/i.test(this.nodeLocationTracking))this.recoveryEnabled?(this.setNodeLocationFromToken=Fm,this.setNodeLocationFromNode=Fm,this.cstPostRule=_t,this.setInitialNodeLocation=this.setInitialNodeLocationFullRecovery):(this.setNodeLocationFromToken=_t,this.setNodeLocationFromNode=_t,this.cstPostRule=this.cstPostRuleFull,this.setInitialNodeLocation=this.setInitialNodeLocationFullRegular);else if(/onlyOffset/i.test(this.nodeLocationTracking))this.recoveryEnabled?(this.setNodeLocationFromToken=Bm,this.setNodeLocationFromNode=Bm,this.cstPostRule=_t,this.setInitialNodeLocation=this.setInitialNodeLocationOnlyOffsetRecovery):(this.setNodeLocationFromToken=_t,this.setNodeLocationFromNode=_t,this.cstPostRule=this.cstPostRuleOnlyOffset,this.setInitialNodeLocation=this.setInitialNodeLocationOnlyOffsetRegular);else if(/none/i.test(this.nodeLocationTracking))this.setNodeLocationFromToken=_t,this.setNodeLocationFromNode=_t,this.cstPostRule=_t,this.setInitialNodeLocation=_t;else throw Error(`Invalid <nodeLocationTracking> config option: "${t.nodeLocationTracking}"`)}setInitialNodeLocationOnlyOffsetRecovery(t){t.location={startOffset:NaN,endOffset:NaN}}setInitialNodeLocationOnlyOffsetRegular(t){t.location={startOffset:this.LA(1).startOffset,endOffset:NaN}}setInitialNodeLocationFullRecovery(t){t.location={startOffset:NaN,startLine:NaN,startColumn:NaN,endOffset:NaN,endLine:NaN,endColumn:NaN}}setInitialNodeLocationFullRegular(t){const n=this.LA(1);t.location={startOffset:n.startOffset,startLine:n.startLine,startColumn:n.startColumn,endOffset:NaN,endLine:NaN,endColumn:NaN}}cstInvocationStateUpdate(t){const n={name:t,children:Object.create(null)};this.setInitialNodeLocation(n),this.CST_STACK.push(n)}cstFinallyStateUpdate(){this.CST_STACK.pop()}cstPostRuleFull(t){const n=this.LA(0),r=t.location;r.startOffset<=n.startOffset?(r.endOffset=n.endOffset,r.endLine=n.endLine,r.endColumn=n.endColumn):(r.startOffset=NaN,r.startLine=NaN,r.startColumn=NaN)}cstPostRuleOnlyOffset(t){const n=this.LA(0),r=t.location;r.startOffset<=n.startOffset?r.endOffset=n.endOffset:r.startOffset=NaN}cstPostTerminal(t,n){const r=this.CST_STACK[this.CST_STACK.length-1];pR(r,n,t),this.setNodeLocationFromToken(r.location,n)}cstPostNonTerminal(t,n){const r=this.CST_STACK[this.CST_STACK.length-1];mR(r,n,t),this.setNodeLocationFromNode(r.location,t.location)}getBaseCstVisitorConstructor(){if(wr(this.baseCstVisitorConstructor)){const t=_R(this.className,yn(this.gastProductionsCache));return this.baseCstVisitorConstructor=t,t}return this.baseCstVisitorConstructor}getBaseCstVisitorConstructorWithDefaults(){if(wr(this.baseCstVisitorWithDefaultsConstructor)){const t=bR(this.className,yn(this.gastProductionsCache),this.getBaseCstVisitorConstructor());return this.baseCstVisitorWithDefaultsConstructor=t,t}return this.baseCstVisitorWithDefaultsConstructor}getLastExplicitRuleShortName(){const t=this.RULE_STACK;return t[t.length-1]}getPreviousExplicitRuleShortName(){const t=this.RULE_STACK;return t[t.length-2]}getLastExplicitRuleOccurrenceIndex(){const t=this.RULE_OCCURRENCE_STACK;return t[t.length-1]}}class kR{initLexerAdapter(){this.tokVector=[],this.tokVectorLength=0,this.currIdx=-1}set input(t){if(this.selfAnalysisDone!==!0)throw Error("Missing <performSelfAnalysis> invocation at the end of the Parser's constructor.");this.reset(),this.tokVector=t,this.tokVectorLength=t.length}get input(){return this.tokVector}SKIP_TOKEN(){return this.currIdx<=this.tokVector.length-2?(this.consumeToken(),this.LA(1)):Ba}LA(t){const n=this.currIdx+t;return n<0||this.tokVectorLength<=n?Ba:this.tokVector[n]}consumeToken(){this.currIdx++}exportLexerState(){return this.currIdx}importLexerState(t){this.currIdx=t}resetLexerState(){this.currIdx=-1}moveToTerminatedState(){this.currIdx=this.tokVector.length-1}getLexerPosition(){return this.exportLexerState()}}class SR{ACTION(t){return t.call(this)}consume(t,n,r){return this.consumeInternal(n,t,r)}subrule(t,n,r){return this.subruleInternal(n,t,r)}option(t,n){return this.optionInternal(n,t)}or(t,n){return this.orInternal(n,t)}many(t,n){return this.manyInternal(t,n)}atLeastOne(t,n){return this.atLeastOneInternal(t,n)}CONSUME(t,n){return this.consumeInternal(t,0,n)}CONSUME1(t,n){return this.consumeInternal(t,1,n)}CONSUME2(t,n){return this.consumeInternal(t,2,n)}CONSUME3(t,n){return this.consumeInternal(t,3,n)}CONSUME4(t,n){return this.consumeInternal(t,4,n)}CONSUME5(t,n){return this.consumeInternal(t,5,n)}CONSUME6(t,n){return this.consumeInternal(t,6,n)}CONSUME7(t,n){return this.consumeInternal(t,7,n)}CONSUME8(t,n){return this.consumeInternal(t,8,n)}CONSUME9(t,n){return this.consumeInternal(t,9,n)}SUBRULE(t,n){return this.subruleInternal(t,0,n)}SUBRULE1(t,n){return this.subruleInternal(t,1,n)}SUBRULE2(t,n){return this.subruleInternal(t,2,n)}SUBRULE3(t,n){return this.subruleInternal(t,3,n)}SUBRULE4(t,n){return this.subruleInternal(t,4,n)}SUBRULE5(t,n){return this.subruleInternal(t,5,n)}SUBRULE6(t,n){return this.subruleInternal(t,6,n)}SUBRULE7(t,n){return this.subruleInternal(t,7,n)}SUBRULE8(t,n){return this.subruleInternal(t,8,n)}SUBRULE9(t,n){return this.subruleInternal(t,9,n)}OPTION(t){return this.optionInternal(t,0)}OPTION1(t){return this.optionInternal(t,1)}OPTION2(t){return this.optionInternal(t,2)}OPTION3(t){return this.optionInternal(t,3)}OPTION4(t){return this.optionInternal(t,4)}OPTION5(t){return this.optionInternal(t,5)}OPTION6(t){return this.optionInternal(t,6)}OPTION7(t){return this.optionInternal(t,7)}OPTION8(t){return this.optionInternal(t,8)}OPTION9(t){return this.optionInternal(t,9)}OR(t){return this.orInternal(t,0)}OR1(t){return this.orInternal(t,1)}OR2(t){return this.orInternal(t,2)}OR3(t){return this.orInternal(t,3)}OR4(t){return this.orInternal(t,4)}OR5(t){return this.orInternal(t,5)}OR6(t){return this.orInternal(t,6)}OR7(t){return this.orInternal(t,7)}OR8(t){return this.orInternal(t,8)}OR9(t){return this.orInternal(t,9)}MANY(t){this.manyInternal(0,t)}MANY1(t){this.manyInternal(1,t)}MANY2(t){this.manyInternal(2,t)}MANY3(t){this.manyInternal(3,t)}MANY4(t){this.manyInternal(4,t)}MANY5(t){this.manyInternal(5,t)}MANY6(t){this.manyInternal(6,t)}MANY7(t){this.manyInternal(7,t)}MANY8(t){this.manyInternal(8,t)}MANY9(t){this.manyInternal(9,t)}MANY_SEP(t){this.manySepFirstInternal(0,t)}MANY_SEP1(t){this.manySepFirstInternal(1,t)}MANY_SEP2(t){this.manySepFirstInternal(2,t)}MANY_SEP3(t){this.manySepFirstInternal(3,t)}MANY_SEP4(t){this.manySepFirstInternal(4,t)}MANY_SEP5(t){this.manySepFirstInternal(5,t)}MANY_SEP6(t){this.manySepFirstInternal(6,t)}MANY_SEP7(t){this.manySepFirstInternal(7,t)}MANY_SEP8(t){this.manySepFirstInternal(8,t)}MANY_SEP9(t){this.manySepFirstInternal(9,t)}AT_LEAST_ONE(t){this.atLeastOneInternal(0,t)}AT_LEAST_ONE1(t){return this.atLeastOneInternal(1,t)}AT_LEAST_ONE2(t){this.atLeastOneInternal(2,t)}AT_LEAST_ONE3(t){this.atLeastOneInternal(3,t)}AT_LEAST_ONE4(t){this.atLeastOneInternal(4,t)}AT_LEAST_ONE5(t){this.atLeastOneInternal(5,t)}AT_LEAST_ONE6(t){this.atLeastOneInternal(6,t)}AT_LEAST_ONE7(t){this.atLeastOneInternal(7,t)}AT_LEAST_ONE8(t){this.atLeastOneInternal(8,t)}AT_LEAST_ONE9(t){this.atLeastOneInternal(9,t)}AT_LEAST_ONE_SEP(t){this.atLeastOneSepFirstInternal(0,t)}AT_LEAST_ONE_SEP1(t){this.atLeastOneSepFirstInternal(1,t)}AT_LEAST_ONE_SEP2(t){this.atLeastOneSepFirstInternal(2,t)}AT_LEAST_ONE_SEP3(t){this.atLeastOneSepFirstInternal(3,t)}AT_LEAST_ONE_SEP4(t){this.atLeastOneSepFirstInternal(4,t)}AT_LEAST_ONE_SEP5(t){this.atLeastOneSepFirstInternal(5,t)}AT_LEAST_ONE_SEP6(t){this.atLeastOneSepFirstInternal(6,t)}AT_LEAST_ONE_SEP7(t){this.atLeastOneSepFirstInternal(7,t)}AT_LEAST_ONE_SEP8(t){this.atLeastOneSepFirstInternal(8,t)}AT_LEAST_ONE_SEP9(t){this.atLeastOneSepFirstInternal(9,t)}RULE(t,n,r=Fa){if(zt(this.definedRulesNames,t)){const o={message:yi.buildDuplicateRuleNameError({topLevelRule:t,grammarName:this.className}),type:Wt.DUPLICATE_RULE_NAME,ruleName:t};this.definitionErrors.push(o)}this.definedRulesNames.push(t);const i=this.defineRule(t,n,r);return this[t]=i,i}OVERRIDE_RULE(t,n,r=Fa){const i=Vx(t,this.definedRulesNames,this.className);this.definitionErrors=this.definitionErrors.concat(i);const s=this.defineRule(t,n,r);return this[t]=s,s}BACKTRACK(t,n){return function(){this.isBackTrackingStack.push(1);const r=this.saveRecogState();try{return t.apply(this,n),!0}catch(i){if(Ca(i))return!1;throw i}finally{this.reloadRecogState(r),this.isBackTrackingStack.pop()}}}getGAstProductions(){return this.gastProductionsCache}getSerializedGastProductions(){return TT(ht(this.gastProductionsCache))}}class AR{initRecognizerEngine(t,n){if(this.className=this.constructor.name,this.shortRuleNameToFull={},this.fullRuleNameToShort={},this.ruleShortNameIdx=256,this.tokenMatcher=Ra,this.subruleIdx=0,this.definedRulesNames=[],this.tokensMap={},this.isBackTrackingStack=[],this.RULE_STACK=[],this.RULE_OCCURRENCE_STACK=[],this.gastProductionsCache={},pe(n,"serializedGrammar"))throw Error(`The Parser's configuration can no longer contain a <serializedGrammar> property.
	See: https://chevrotain.io/docs/changes/BREAKING_CHANGES.html#_6-0-0
	For Further details.`);if(Le(t)){if(qe(t))throw Error(`A Token Vocabulary cannot be empty.
	Note that the first argument for the parser constructor
	is no longer a Token vector (since v4.0).`);if(typeof t[0].startOffset=="number")throw Error(`The Parser constructor no longer accepts a token vector as the first argument.
	See: https://chevrotain.io/docs/changes/BREAKING_CHANGES.html#_4-0-0
	For Further details.`)}if(Le(t))this.tokensMap=Zt(t,(s,o)=>(s[o.name]=o,s),{});else if(pe(t,"modes")&&Rn(sn(ht(t.modes)),wx)){const s=sn(ht(t.modes)),o=ma(s);this.tokensMap=Zt(o,(a,c)=>(a[c.name]=c,a),{})}else if(gn(t))this.tokensMap=Mt(t);else throw new Error("<tokensDictionary> argument must be An Array of Token constructors, A dictionary of Token constructors or an IMultiModeLexerDefinition");this.tokensMap.EOF=gi;const r=pe(t,"modes")?sn(ht(t.modes)):ht(t),i=Rn(r,s=>qe(s.categoryMatches));this.tokenMatcher=i?Ra:$s,js(ht(this.tokensMap))}defineRule(t,n,r){if(this.selfAnalysisDone)throw Error(`Grammar rule <${t}> may not be defined after the 'performSelfAnalysis' method has been called'
Make sure that all grammar rule definitions are done before 'performSelfAnalysis' is called.`);const i=pe(r,"resyncEnabled")?r.resyncEnabled:Fa.resyncEnabled,s=pe(r,"recoveryValueFunc")?r.recoveryValueFunc:Fa.recoveryValueFunc,o=this.ruleShortNameIdx<<lR+zr;this.ruleShortNameIdx++,this.shortRuleNameToFull[o]=t,this.fullRuleNameToShort[t]=o;let a;return this.outputCst===!0?a=function(...u){try{this.ruleInvocationStateUpdate(o,t,this.subruleIdx),n.apply(this,u);const f=this.CST_STACK[this.CST_STACK.length-1];return this.cstPostRule(f),f}catch(f){return this.invokeRuleCatch(f,i,s)}finally{this.ruleFinallyStateUpdate()}}:a=function(...u){try{return this.ruleInvocationStateUpdate(o,t,this.subruleIdx),n.apply(this,u)}catch(f){return this.invokeRuleCatch(f,i,s)}finally{this.ruleFinallyStateUpdate()}},Object.assign(a,{ruleName:t,originalGrammarAction:n})}invokeRuleCatch(t,n,r){const i=this.RULE_STACK.length===1,s=n&&!this.isBackTracking()&&this.recoveryEnabled;if(Ca(t)){const o=t;if(s){const a=this.findReSyncTokenType();if(this.isInCurrentRuleReSyncSet(a))if(o.resyncedTokens=this.reSyncTo(a),this.outputCst){const c=this.CST_STACK[this.CST_STACK.length-1];return c.recoveredNode=!0,c}else return r(t);else{if(this.outputCst){const c=this.CST_STACK[this.CST_STACK.length-1];c.recoveredNode=!0,o.partialCstResult=c}throw o}}else{if(i)return this.moveToTerminatedState(),r(t);throw o}}else throw t}optionInternal(t,n){const r=this.getKeyForAutomaticLookahead(Dm,n);return this.optionInternalLogic(t,n,r)}optionInternalLogic(t,n,r){let i=this.getLaFuncFromCache(r),s;if(typeof t!="function"){s=t.DEF;const o=t.GATE;if(o!==void 0){const a=i;i=()=>o.call(this)&&a.call(this)}}else s=t;if(i.call(this)===!0)return s.call(this)}atLeastOneInternal(t,n){const r=this.getKeyForAutomaticLookahead(du,t);return this.atLeastOneInternalLogic(t,n,r)}atLeastOneInternalLogic(t,n,r){let i=this.getLaFuncFromCache(r),s;if(typeof n!="function"){s=n.DEF;const o=n.GATE;if(o!==void 0){const a=i;i=()=>o.call(this)&&a.call(this)}}else s=n;if(i.call(this)===!0){let o=this.doSingleRepetition(s);for(;i.call(this)===!0&&o===!0;)o=this.doSingleRepetition(s)}else throw this.raiseEarlyExitException(t,st.REPETITION_MANDATORY,n.ERR_MSG);this.attemptInRepetitionRecovery(this.atLeastOneInternal,[t,n],i,du,t,Nx)}atLeastOneSepFirstInternal(t,n){const r=this.getKeyForAutomaticLookahead(Ma,t);this.atLeastOneSepFirstInternalLogic(t,n,r)}atLeastOneSepFirstInternalLogic(t,n,r){const i=n.DEF,s=n.SEP;if(this.getLaFuncFromCache(r).call(this)===!0){i.call(this);const a=()=>this.tokenMatcher(this.LA(1),s);for(;this.tokenMatcher(this.LA(1),s)===!0;)this.CONSUME(s),i.call(this);this.attemptInRepetitionRecovery(this.repetitionSepSecondInternal,[t,s,a,i,wm],a,Ma,t,wm)}else throw this.raiseEarlyExitException(t,st.REPETITION_MANDATORY_WITH_SEPARATOR,n.ERR_MSG)}manyInternal(t,n){const r=this.getKeyForAutomaticLookahead(hu,t);return this.manyInternalLogic(t,n,r)}manyInternalLogic(t,n,r){let i=this.getLaFuncFromCache(r),s;if(typeof n!="function"){s=n.DEF;const a=n.GATE;if(a!==void 0){const c=i;i=()=>a.call(this)&&c.call(this)}}else s=n;let o=!0;for(;i.call(this)===!0&&o===!0;)o=this.doSingleRepetition(s);this.attemptInRepetitionRecovery(this.manyInternal,[t,n],i,hu,t,Ox,o)}manySepFirstInternal(t,n){const r=this.getKeyForAutomaticLookahead(pu,t);this.manySepFirstInternalLogic(t,n,r)}manySepFirstInternalLogic(t,n,r){const i=n.DEF,s=n.SEP;if(this.getLaFuncFromCache(r).call(this)===!0){i.call(this);const a=()=>this.tokenMatcher(this.LA(1),s);for(;this.tokenMatcher(this.LA(1),s)===!0;)this.CONSUME(s),i.call(this);this.attemptInRepetitionRecovery(this.repetitionSepSecondInternal,[t,s,a,i,bm],a,pu,t,bm)}}repetitionSepSecondInternal(t,n,r,i,s){for(;r();)this.CONSUME(n),i.call(this);this.attemptInRepetitionRecovery(this.repetitionSepSecondInternal,[t,n,r,i,s],r,Ma,t,s)}doSingleRepetition(t){const n=this.getLexerPosition();return t.call(this),this.getLexerPosition()>n}orInternal(t,n){const r=this.getKeyForAutomaticLookahead(Pm,n),i=Le(t)?t:t.DEF,o=this.getLaFuncFromCache(r).call(this,i);if(o!==void 0)return i[o].ALT.call(this);this.raiseNoAltException(n,t.ERR_MSG)}ruleFinallyStateUpdate(){if(this.RULE_STACK.pop(),this.RULE_OCCURRENCE_STACK.pop(),this.cstFinallyStateUpdate(),this.RULE_STACK.length===0&&this.isAtEndOfInput()===!1){const t=this.LA(1),n=this.errorMessageProvider.buildNotAllInputParsedMessage({firstRedundant:t,ruleName:this.getCurrRuleFullName()});this.SAVE_ERROR(new iR(n,t))}}subruleInternal(t,n,r){let i;try{const s=r!==void 0?r.ARGS:void 0;return this.subruleIdx=n,i=t.apply(this,s),this.cstPostNonTerminal(i,r!==void 0&&r.LABEL!==void 0?r.LABEL:t.ruleName),i}catch(s){throw this.subruleInternalError(s,r,t.ruleName)}}subruleInternalError(t,n,r){throw Ca(t)&&t.partialCstResult!==void 0&&(this.cstPostNonTerminal(t.partialCstResult,n!==void 0&&n.LABEL!==void 0?n.LABEL:r),delete t.partialCstResult),t}consumeInternal(t,n,r){let i;try{const s=this.LA(1);this.tokenMatcher(s,t)===!0?(this.consumeToken(),i=s):this.consumeInternalError(t,s,r)}catch(s){i=this.consumeInternalRecovery(t,n,s)}return this.cstPostTerminal(r!==void 0&&r.LABEL!==void 0?r.LABEL:t.name,i),i}consumeInternalError(t,n,r){let i;const s=this.LA(0);throw r!==void 0&&r.ERR_MSG?i=r.ERR_MSG:i=this.errorMessageProvider.buildMismatchTokenMessage({expected:t,actual:n,previous:s,ruleName:this.getCurrRuleFullName()}),this.SAVE_ERROR(new Mm(i,n,s))}consumeInternalRecovery(t,n,r){if(this.recoveryEnabled&&r.name==="MismatchedTokenException"&&!this.isBackTracking()){const i=this.getFollowsForInRuleRecovery(t,n);try{return this.tryInRuleRecovery(t,i)}catch(s){throw s.name===Um?r:s}}else throw r}saveRecogState(){const t=this.errors,n=Mt(this.RULE_STACK);return{errors:t,lexerState:this.exportLexerState(),RULE_STACK:n,CST_STACK:this.CST_STACK}}reloadRecogState(t){this.errors=t.errors,this.importLexerState(t.lexerState),this.RULE_STACK=t.RULE_STACK}ruleInvocationStateUpdate(t,n,r){this.RULE_OCCURRENCE_STACK.push(r),this.RULE_STACK.push(t),this.cstInvocationStateUpdate(n)}isBackTracking(){return this.isBackTrackingStack.length!==0}getCurrRuleFullName(){const t=this.getLastExplicitRuleShortName();return this.shortRuleNameToFull[t]}shortRuleNameToFullName(t){return this.shortRuleNameToFull[t]}isAtEndOfInput(){return this.tokenMatcher(this.LA(1),gi)}reset(){this.resetLexerState(),this.subruleIdx=0,this.isBackTrackingStack=[],this.errors=[],this.RULE_STACK=[],this.CST_STACK=[],this.RULE_OCCURRENCE_STACK=[]}}class TR{initErrorHandler(t){this._errors=[],this.errorMessageProvider=pe(t,"errorMessageProvider")?t.errorMessageProvider:vr.errorMessageProvider}SAVE_ERROR(t){if(Ca(t))return t.context={ruleStack:this.getHumanReadableRuleStack(),ruleOccurrenceStack:Mt(this.RULE_OCCURRENCE_STACK)},this._errors.push(t),t;throw Error("Trying to save an Error which is not a RecognitionException")}get errors(){return Mt(this._errors)}set errors(t){this._errors=t}raiseEarlyExitException(t,n,r){const i=this.getCurrRuleFullName(),s=this.getGAstProductions()[i],a=cu(t,s,n,this.maxLookahead)[0],c=[];for(let u=1;u<=this.maxLookahead;u++)c.push(this.LA(u));const l=this.errorMessageProvider.buildEarlyExitMessage({expectedIterationPaths:a,actual:c,previous:this.LA(0),customUserDescription:r,ruleName:i});throw this.SAVE_ERROR(new sR(l,this.LA(1),this.LA(0)))}raiseNoAltException(t,n){const r=this.getCurrRuleFullName(),i=this.getGAstProductions()[r],s=au(t,i,this.maxLookahead),o=[];for(let l=1;l<=this.maxLookahead;l++)o.push(this.LA(l));const a=this.LA(0),c=this.errorMessageProvider.buildNoViableAltMessage({expectedPathsPerAlt:s,actual:o,previous:a,customUserDescription:n,ruleName:this.getCurrRuleFullName()});throw this.SAVE_ERROR(new rR(c,this.LA(1),a))}}class xR{initContentAssist(){}computeContentAssist(t,n){const r=this.gastProductionsCache[t];if(wr(r))throw Error(`Rule ->${t}<- does not exist in this grammar.`);return vm([r],n,this.tokenMatcher,this.maxLookahead)}getNextPossibleTokenTypes(t){const n=In(t.ruleStack),i=this.getGAstProductions()[n];return new Ix(i,t).startWalking()}}const Pa={description:"This Object indicates the Parser is during Recording Phase"};Object.freeze(Pa);const jm=!0,zm=Math.pow(2,zr)-1,Wm=on({name:"RECORDING_PHASE_TOKEN",pattern:wt.NA});js([Wm]);const Gm=Ia(Wm,`This IToken indicates the Parser is in Recording Phase
	See: https://chevrotain.io/docs/guide/internals.html#grammar-recording for details`,-1,-1,-1,-1,-1,-1);Object.freeze(Gm);const RR={name:`This CSTNode indicates the Parser is in Recording Phase
	See: https://chevrotain.io/docs/guide/internals.html#grammar-recording for details`,children:{}};class IR{initGastRecorder(t){this.recordingProdStack=[],this.RECORDING_PHASE=!1}enableRecording(){this.RECORDING_PHASE=!0,this.TRACE_INIT("Enable Recording",()=>{for(let t=0;t<10;t++){const n=t>0?t:"";this[`CONSUME${n}`]=function(r,i){return this.consumeInternalRecord(r,t,i)},this[`SUBRULE${n}`]=function(r,i){return this.subruleInternalRecord(r,t,i)},this[`OPTION${n}`]=function(r){return this.optionInternalRecord(r,t)},this[`OR${n}`]=function(r){return this.orInternalRecord(r,t)},this[`MANY${n}`]=function(r){this.manyInternalRecord(t,r)},this[`MANY_SEP${n}`]=function(r){this.manySepFirstInternalRecord(t,r)},this[`AT_LEAST_ONE${n}`]=function(r){this.atLeastOneInternalRecord(t,r)},this[`AT_LEAST_ONE_SEP${n}`]=function(r){this.atLeastOneSepFirstInternalRecord(t,r)}}this.consume=function(t,n,r){return this.consumeInternalRecord(n,t,r)},this.subrule=function(t,n,r){return this.subruleInternalRecord(n,t,r)},this.option=function(t,n){return this.optionInternalRecord(n,t)},this.or=function(t,n){return this.orInternalRecord(n,t)},this.many=function(t,n){this.manyInternalRecord(t,n)},this.atLeastOne=function(t,n){this.atLeastOneInternalRecord(t,n)},this.ACTION=this.ACTION_RECORD,this.BACKTRACK=this.BACKTRACK_RECORD,this.LA=this.LA_RECORD})}disableRecording(){this.RECORDING_PHASE=!1,this.TRACE_INIT("Deleting Recording methods",()=>{const t=this;for(let n=0;n<10;n++){const r=n>0?n:"";delete t[`CONSUME${r}`],delete t[`SUBRULE${r}`],delete t[`OPTION${r}`],delete t[`OR${r}`],delete t[`MANY${r}`],delete t[`MANY_SEP${r}`],delete t[`AT_LEAST_ONE${r}`],delete t[`AT_LEAST_ONE_SEP${r}`]}delete t.consume,delete t.subrule,delete t.option,delete t.or,delete t.many,delete t.atLeastOne,delete t.ACTION,delete t.BACKTRACK,delete t.LA})}ACTION_RECORD(t){}BACKTRACK_RECORD(t,n){return()=>!0}LA_RECORD(t){return Ba}topLevelRuleRecord(t,n){try{const r=new qi({definition:[],name:t});return r.name=t,this.recordingProdStack.push(r),n.call(this),this.recordingProdStack.pop(),r}catch(r){if(r.KNOWN_RECORDER_ERROR!==!0)try{r.message=r.message+`
	 This error was thrown during the "grammar recording phase" For more info see:
	https://chevrotain.io/docs/guide/internals.html#grammar-recording`}catch{throw r}throw r}}optionInternalRecord(t,n){return Gs.call(this,en,t,n)}atLeastOneInternalRecord(t,n){Gs.call(this,Vn,n,t)}atLeastOneSepFirstInternalRecord(t,n){Gs.call(this,Kn,n,t,jm)}manyInternalRecord(t,n){Gs.call(this,bt,n,t)}manySepFirstInternalRecord(t,n){Gs.call(this,Nn,n,t,jm)}orInternalRecord(t,n){return OR.call(this,t,n)}subruleInternalRecord(t,n,r){if(Da(n),!t||pe(t,"ruleName")===!1){const a=new Error(`<SUBRULE${Hm(n)}> argument is invalid expecting a Parser method reference but got: <${JSON.stringify(t)}>
 inside top level rule: <${this.recordingProdStack[0].name}>`);throw a.KNOWN_RECORDER_ERROR=!0,a}const i=Vi(this.recordingProdStack),s=t.ruleName,o=new Yt({idx:n,nonTerminalName:s,label:r==null?void 0:r.LABEL,referencedRule:void 0});return i.definition.push(o),this.outputCst?RR:Pa}consumeInternalRecord(t,n,r){if(Da(n),!am(t)){const o=new Error(`<CONSUME${Hm(n)}> argument is invalid expecting a TokenType reference but got: <${JSON.stringify(t)}>
 inside top level rule: <${this.recordingProdStack[0].name}>`);throw o.KNOWN_RECORDER_ERROR=!0,o}const i=Vi(this.recordingProdStack),s=new tt({idx:n,terminalType:t,label:r==null?void 0:r.LABEL});return i.definition.push(s),Gm}}function Gs(e,t,n,r=!1){Da(n);const i=Vi(this.recordingProdStack),s=gr(t)?t:t.DEF,o=new e({definition:[],idx:n});return r&&(o.separator=t.SEP),pe(t,"MAX_LOOKAHEAD")&&(o.maxLookahead=t.MAX_LOOKAHEAD),this.recordingProdStack.push(o),s.call(this),i.definition.push(o),this.recordingProdStack.pop(),Pa}function OR(e,t){Da(t);const n=Vi(this.recordingProdStack),r=Le(e)===!1,i=r===!1?e:e.DEF,s=new Cn({definition:[],idx:t,ignoreAmbiguities:r&&e.IGNORE_AMBIGUITIES===!0});pe(e,"MAX_LOOKAHEAD")&&(s.maxLookahead=e.MAX_LOOKAHEAD);const o=Zl(i,a=>gr(a.GATE));return s.hasPredicates=o,n.definition.push(s),me(i,a=>{const c=new Qt({definition:[]});s.definition.push(c),pe(a,"IGNORE_AMBIGUITIES")?c.ignoreAmbiguities=a.IGNORE_AMBIGUITIES:pe(a,"GATE")&&(c.ignoreAmbiguities=!0),this.recordingProdStack.push(c),a.ALT.call(this),this.recordingProdStack.pop()}),Pa}function Hm(e){return e===0?"":`${e}`}function Da(e){if(e<0||e>zm){const t=new Error(`Invalid DSL Method idx value: <${e}>
	Idx value must be a none negative value smaller than ${zm+1}`);throw t.KNOWN_RECORDER_ERROR=!0,t}}class NR{initPerformanceTracer(t){if(pe(t,"traceInitPerf")){const n=t.traceInitPerf,r=typeof n=="number";this.traceInitMaxIdent=r?n:1/0,this.traceInitPerf=r?n>0:n}else this.traceInitMaxIdent=0,this.traceInitPerf=vr.traceInitPerf;this.traceInitIndent=-1}TRACE_INIT(t,n){if(this.traceInitPerf===!0){this.traceInitIndent++;const r=new Array(this.traceInitIndent+1).join("	");this.traceInitIndent<this.traceInitMaxIdent&&console.log(`${r}--> <${t}>`);const{time:i,value:s}=Gp(n),o=i>10?console.warn:console.log;return this.traceInitIndent<this.traceInitMaxIdent&&o(`${r}<-- <${t}> time: ${i}ms`),this.traceInitIndent--,s}else return n()}}function CR(e,t){t.forEach(n=>{const r=n.prototype;Object.getOwnPropertyNames(r).forEach(i=>{if(i==="constructor")return;const s=Object.getOwnPropertyDescriptor(r,i);s&&(s.get||s.set)?Object.defineProperty(e.prototype,i,s):e.prototype[i]=n.prototype[i]})})}const Ba=Ia(gi,"",NaN,NaN,NaN,NaN,NaN,NaN);Object.freeze(Ba);const vr=Object.freeze({recoveryEnabled:!1,maxLookahead:3,dynamicTokensEnabled:!1,outputCst:!0,errorMessageProvider:_m,nodeLocationTracking:"none",traceInitPerf:!1,skipValidations:!1}),Fa=Object.freeze({recoveryValueFunc:()=>{},resyncEnabled:!0});var Wt;(function(e){e[e.INVALID_RULE_NAME=0]="INVALID_RULE_NAME",e[e.DUPLICATE_RULE_NAME=1]="DUPLICATE_RULE_NAME",e[e.INVALID_RULE_OVERRIDE=2]="INVALID_RULE_OVERRIDE",e[e.DUPLICATE_PRODUCTIONS=3]="DUPLICATE_PRODUCTIONS",e[e.UNRESOLVED_SUBRULE_REF=4]="UNRESOLVED_SUBRULE_REF",e[e.LEFT_RECURSION=5]="LEFT_RECURSION",e[e.NONE_LAST_EMPTY_ALT=6]="NONE_LAST_EMPTY_ALT",e[e.AMBIGUOUS_ALTS=7]="AMBIGUOUS_ALTS",e[e.CONFLICT_TOKENS_RULES_NAMESPACE=8]="CONFLICT_TOKENS_RULES_NAMESPACE",e[e.INVALID_TOKEN_NAME=9]="INVALID_TOKEN_NAME",e[e.NO_NON_EMPTY_LOOKAHEAD=10]="NO_NON_EMPTY_LOOKAHEAD",e[e.AMBIGUOUS_PREFIX_ALTS=11]="AMBIGUOUS_PREFIX_ALTS",e[e.TOO_MANY_ALTS=12]="TOO_MANY_ALTS",e[e.CUSTOM_LOOKAHEAD_VALIDATION=13]="CUSTOM_LOOKAHEAD_VALIDATION"})(Wt||(Wt={}));class Hs{static performSelfAnalysis(t){throw Error("The **static** `performSelfAnalysis` method has been deprecated.	\nUse the **instance** method with the same name instead.")}performSelfAnalysis(){this.TRACE_INIT("performSelfAnalysis",()=>{let t;this.selfAnalysisDone=!0;const n=this.className;this.TRACE_INIT("toFastProps",()=>{Hp(this)}),this.TRACE_INIT("Grammar Recording",()=>{try{this.enableRecording(),me(this.definedRulesNames,i=>{const o=this[i].originalGrammarAction;let a;this.TRACE_INIT(`${i} Rule`,()=>{a=this.topLevelRuleRecord(i,o)}),this.gastProductionsCache[i]=a})}finally{this.disableRecording()}});let r=[];if(this.TRACE_INIT("Grammar Resolving",()=>{r=tR({rules:ht(this.gastProductionsCache)}),this.definitionErrors=this.definitionErrors.concat(r)}),this.TRACE_INIT("Grammar Validations",()=>{if(qe(r)&&this.skipValidations===!1){const i=nR({rules:ht(this.gastProductionsCache),tokenTypes:ht(this.tokensMap),errMsgProvider:yi,grammarName:n}),s=$x({lookaheadStrategy:this.lookaheadStrategy,rules:ht(this.gastProductionsCache),tokenTypes:ht(this.tokensMap),grammarName:n});this.definitionErrors=this.definitionErrors.concat(i,s)}}),qe(this.definitionErrors)&&(this.recoveryEnabled&&this.TRACE_INIT("computeAllProdsFollows",()=>{const i=LT(ht(this.gastProductionsCache));this.resyncFollows=i}),this.TRACE_INIT("ComputeLookaheadFunctions",()=>{var i,s;(s=(i=this.lookaheadStrategy).initialize)===null||s===void 0||s.call(i,{rules:ht(this.gastProductionsCache)}),this.preComputeLookaheadFunctions(ht(this.gastProductionsCache))})),!Hs.DEFER_DEFINITION_ERRORS_HANDLING&&!qe(this.definitionErrors))throw t=ce(this.definitionErrors,i=>i.message),new Error(`Parser Definition Errors detected:
 ${t.join(`
-------------------------------
`)}`)})}constructor(t,n){this.definitionErrors=[],this.selfAnalysisDone=!1;const r=this;if(r.initErrorHandler(n),r.initLexerAdapter(),r.initLooksAhead(n),r.initRecognizerEngine(t,n),r.initRecoverable(n),r.initTreeBuilder(n),r.initContentAssist(),r.initGastRecorder(n),r.initPerformanceTracer(n),pe(n,"ignoredIssues"))throw new Error(`The <ignoredIssues> IParserConfig property has been deprecated.
	Please use the <IGNORE_AMBIGUITIES> flag on the relevant DSL method instead.
	See: https://chevrotain.io/docs/guide/resolving_grammar_errors.html#IGNORING_AMBIGUITIES
	For further details.`);this.skipValidations=pe(n,"skipValidations")?n.skipValidations:vr.skipValidations}}Hs.DEFER_DEFINITION_ERRORS_HANDLING=!1,CR(Hs,[aR,fR,ER,kR,AR,SR,TR,xR,IR,NR]);class LR extends Hs{constructor(t,n=vr){const r=Mt(n);r.outputCst=!0,super(t,r)}}function MR(e){const t=new UR,n=ht(e);return ce(n,r=>t.visitRule(r))}class UR extends pi{visitRule(t){const n=this.visitEach(t.definition),r=$p(n,s=>s.propertyName),i=ce(r,(s,o)=>{const a=!Zl(s,l=>!l.canBeNull);let c=s[0].type;return s.length>1&&(c=ce(s,l=>l.type)),{name:o,type:c,optional:a}});return{name:t.name,properties:i}}visitAlternative(t){return this.visitEachAndOverrideWith(t.definition,{canBeNull:!0})}visitOption(t){return this.visitEachAndOverrideWith(t.definition,{canBeNull:!0})}visitRepetition(t){return this.visitEachAndOverrideWith(t.definition,{canBeNull:!0})}visitRepetitionMandatory(t){return this.visitEach(t.definition)}visitRepetitionMandatoryWithSeparator(t){return this.visitEach(t.definition).concat({propertyName:t.separator.name,canBeNull:!0,type:$a(t.separator)})}visitRepetitionWithSeparator(t){return this.visitEachAndOverrideWith(t.definition,{canBeNull:!0}).concat({propertyName:t.separator.name,canBeNull:!0,type:$a(t.separator)})}visitAlternation(t){return this.visitEachAndOverrideWith(t.definition,{canBeNull:!0})}visitTerminal(t){return[{propertyName:t.label||t.terminalType.name,canBeNull:!1,type:$a(t)}]}visitNonTerminal(t){return[{propertyName:t.label||t.nonTerminalName,canBeNull:!1,type:$a(t)}]}visitEachAndOverrideWith(t,n){return ce(this.visitEach(t),r=>Xt({},r,n))}visitEach(t){return sn(ce(t,n=>this.visit(n)))}}function $a(e){return e instanceof Yt?{kind:"rule",name:e.referencedRule.name}:{kind:"token"}}function PR(e,t){let n=[];return n=n.concat('import type { CstNode, ICstVisitor, IToken } from "chevrotain";'),n=n.concat(sn(ce(e,r=>DR(r)))),t.includeVisitorInterface&&(n=n.concat(jR(t.visitorInterfaceName,e))),n.join(`

`)+`
`}function DR(e){const t=BR(e),n=FR(e);return[t,n]}function BR(e){const t=Km(e.name),n=yu(e.name);return`export interface ${t} extends CstNode {
  name: "${e.name}";
  children: ${n};
}`}function FR(e){return`export type ${yu(e.name)} = {
  ${ce(e.properties,n=>$R(n)).join(`
  `)}
};`}function $R(e){const t=WR(e.type);return`${e.name}${e.optional?"?":""}: ${t}[];`}function jR(e,t){return`export interface ${e}<IN, OUT> extends ICstVisitor<IN, OUT> {
  ${ce(t,n=>zR(n)).join(`
  `)}
}`}function zR(e){const t=yu(e.name);return`${e.name}(children: ${t}, param?: IN): OUT;`}function WR(e){if(Le(e)){const t=ma(ce(e,r=>Vm(r)));return"("+Zt(t,(r,i)=>r+" | "+i)+")"}else return Vm(e)}function Vm(e){return e.kind==="token"?"IToken":Km(e.name)}function Km(e){return cp(e)+"CstNode"}function yu(e){return cp(e)+"CstChildren"}const GR={includeVisitorInterface:!0,visitorInterfaceName:"ICstNodeVisitor"};function HR(e,t){const n=Object.assign(Object.assign({},GR),t),r=MR(e);return PR(r,n)}const Xn=!!JSON.parse("false"),VR=!!JSON.parse("false");JSON.parse("false");const KR=!!JSON.parse("false");JSON.parse("false"),JSON.parse("false");const _u=Jc(32,126).map(e=>String.fromCharCode(e));function xe(e){return on({...e,name:`token_${e.name}`})}function vn(e,t=!1){return xe(t?{name:e,pattern:new RegExp(e.toLowerCase(),"i"),longer_alt:Gt,group:wt.SKIPPED}:{name:e,pattern:new RegExp(e.toLowerCase(),"i"),longer_alt:Gt})}const Vs=xe({name:"newline",line_breaks:!0,start_chars_hint:[`
`,"\r"],pattern:/\n|\r\n?/}),qR=xe({name:"whitespace",pattern:/ +/,group:wt.SKIPPED}),XR=xe({name:"whitespace",pattern:/\s+/,line_breaks:!0,group:wt.SKIPPED}),bu=xe({name:"stat",pattern:/@.*/,start_chars_hint:["@"]}),Ji=xe({name:"command",pattern:/#/,start_chars_hint:["#"]});let qm=!1;function JR(e,t,n){if(!qm)return null;const[r]=n.slice(-1);if(r&&r.tokenType!==Vs)return null;let i=t;for(;e[i]===" ";)i++;if("@#/?':!".includes(e[i]))return null;let s=t+1;for(;s<e.length&&e[s]!==`
`;)s++;const o=e.substring(t,s);return o.trim().length===0?null:[o]}const Xm=xe({name:"text",pattern:JR,line_breaks:!1,start_chars_hint:_u.filter(e=>"@#/?':!".includes(e)===!1)}),Jm=xe({name:"comment",pattern:/'.*/,start_chars_hint:["'"]}),Zm=xe({name:"label",pattern:/:[^;:\n]*/,start_chars_hint:[":"]}),Ym=xe({name:"hyperlink",pattern:/!/,start_chars_hint:["!"]}),Qm=xe({name:"hyperlinktext",pattern:/;[^;\n]*/,start_chars_hint:[";"]}),Gt=xe({name:"stringliteral",pattern:/[^-0-9"!;@#/?\s]+[^-"!;@#/?\s]*/,start_chars_hint:_u}),eg=xe({name:"stringliteraldouble",pattern:/"(?:[^\\"]|\\(?:[^\n\r]|u[0-9a-fA-F]{4}))*"/}),tg=xe({name:"numberliteral",pattern:/-?(\d*\.)?\d+([eE][+-]?\d+)?[jJ]?[lL]?/}),ng=xe({name:"iseq",pattern:/=|is|eq|equal/,longer_alt:Gt}),rg=xe({name:"isnoteq",pattern:/!=|not ?eq|not ?equal/,longer_alt:Gt}),ig=xe({name:"islessthan",pattern:/<|below/,longer_alt:Gt}),sg=xe({name:"isgreaterthan",pattern:/>|above/,longer_alt:Gt}),og=xe({name:"islessthanorequal",pattern:/<=|below ?or ?eq|below ?or ?equal/,longer_alt:Gt}),ag=xe({name:"isgreaterthanorequal",pattern:/>=|above ?or ?eq|above ?or ?equal/,longer_alt:Gt}),wu=xe({name:"or",pattern:/or/i,longer_alt:Gt}),vu=xe({name:"not",pattern:/not/i,longer_alt:Gt}),Eu=xe({name:"and",pattern:/and/i,longer_alt:Gt}),ku=xe({name:"plus",pattern:/\+/}),Su=xe({name:"minus",pattern:/-/}),cg=xe({name:"power",pattern:/\*\*/}),lg=xe({name:"multiply",pattern:/\*/}),Au=xe({name:"divide",pattern:/\//}),ug=xe({name:"moddivide",pattern:/%/}),fg=xe({name:"floordivide",pattern:/%%/}),hg=xe({name:"query",pattern:/\?/}),dg=xe({name:"lparen",pattern:/\(/,push_mode:"ignore_newlines"}),pg=xe({name:"rparen",pattern:/\)/,pop_mode:!0}),mg=xe({name:"command_play",pattern:/(play|bgplay) .*/,start_chars_hint:_u,longer_alt:Gt}),gg=vn("debugger"),Tu=vn("if"),ja=vn("do"),ZR=vn("to",!0),xu=vn("done"),YR=vn("then",!0),Ru=vn("else"),yg=vn("while"),_g=vn("repeat"),bg=vn("waitfor"),wg=xe({name:"foreach",pattern:/foreach|for/,longer_alt:Gt}),vg=vn("break"),Eg=vn("continue");function kg(e){return[...e,tg,ng,rg,og,ig,ag,sg,wu,vu,Eu,ku,Su,cg,lg,Au,fg,ug,hg,dg,pg,eg,Gt]}const Sg=kg([Xm,bu,mg,Ji,Jm,Zm,Ym,Qm,Vs,qR,vg,Eg,gg,xu,ja,Ru,wg,Tu,_g,YR,ZR,bg,yg]),QR=new wt({defaultMode:"use_newlines",modes:{use_newlines:Sg,ignore_newlines:kg([XR])}},{skipValidations:!Xn,ensureOptimizations:Xn});function Ag(e){qm=!0;const t=QR.tokenize(e||` 
`),[n]=(We(t.tokens)?t.tokens:[]).slice(-1);return n&&n.tokenType.name!=="Newline"&&t.tokens.push(Ia(Vs,`
`,n.startOffset,n.endOffset??NaN,n.startLine??NaN,n.endLine??NaN,n.startColumn??NaN,n.endColumn??NaN)),t}function Tg(e,t=!0){const[n,...r]=e;switch(Pe(n)){default:return t?{type:fe.OBJECT,values:e}:{type:fe.CONST,values:e};case"loader":return{type:fe.LOADER,values:r};case"board":return{type:fe.BOARD,values:r};case"object":return{type:fe.OBJECT,values:r};case"terrain":return{type:fe.TERRAIN,values:r};case"charset":return{type:fe.CHARSET,values:r};case"palette":return{type:fe.PALETTE,values:r};case"rn":case"range":return{type:fe.RANGE,values:r};case"sl":case"select":return{type:fe.SELECT,values:r};case"nm":case"number":return{type:fe.NUMBER,values:r};case"tx":case"text":return{type:fe.TEXT,values:r};case"ln":case"link":return{type:fe.LINK,values:r};case"hk":case"hotkey":return{type:fe.HOTKEY,values:r};case"scroll":return{type:fe.SCROLL,values:r};case"copyit":return{type:fe.COPYIT,values:r}}}function En(e){switch(e){case fe.LOADER:return"loader";case fe.BOARD:return"board";case fe.OBJECT:return"object";case fe.TERRAIN:return"terrain";case fe.CHARSET:return"charset";case fe.PALETTE:return"palette";case fe.CONST:return"const";case fe.RANGE:return"range";case fe.SELECT:return"select";case fe.NUMBER:return"number";case fe.TEXT:return"text";case fe.LINK:return"link";case fe.HOTKEY:return"hotkey";case fe.SCROLL:return"scroll";case fe.COPYIT:return"copyit"}}var Iu=(e=>(e[e.width=0]="width",e[e.height=1]="height",e[e.bits=2]="bits",e))(Iu||{});function xg(e){return Ss(e,Iu)}function Rg(e){return As(e,Iu)}function Ig(e,t){return{id:gt(),code:e,...t}}var Ou=(e=>(e[e.id=0]="id",e[e.code=1]="code",e[e.board=2]="board",e[e.object=3]="object",e[e.terrain=4]="terrain",e[e.charset=5]="charset",e[e.palette=6]="palette",e[e.eighttrack=7]="eighttrack",e))(Ou||{});function eI(e){return Ss(e,Ou,{board:dv,object:Xo,terrain:Xo,charset:xg,palette:xg,stats:li})}function tI(e){return As(e,Ou,{board:pv,object:Jo,terrain:Jo,charset:Rg,palette:Rg})}function nI(e){const t={...Ks(e)};return Object.keys(t).forEach(n=>{switch(n){case"type":case"name":delete t[n];break}}),t}function rI(e){return S(e)?(e.stats=void 0,Ks(e)):{}}function Ks(e){var r;if(!S(e))return{};if(S((r=e.stats)==null?void 0:r.type))return e.stats;e.stats={};const t=Ag(e.code);let n=!0;for(let i=0;i<t.tokens.length;++i){const s=t.tokens[i];if(s.tokenType===bu){const a=s.image.slice(1).split(" "),c=Tg(a,n),l=Pe(c.values.join(" "));switch(n=!1,c.type){case fe.LOADER:e.stats.type=Ae.LOADER,e.stats.name=l;break;case fe.BOARD:e.stats.type=Ae.BOARD,e.stats.name=l;break;case fe.OBJECT:e.stats.type=Ae.OBJECT,e.stats.name=l;break;case fe.TERRAIN:e.stats.type=Ae.TERRAIN,e.stats.name=l;break;case fe.CHARSET:e.stats.type=Ae.CHARSET,e.stats.name=l;break;case fe.PALETTE:e.stats.type=Ae.PALETTE,e.stats.name=l;break;case fe.CONST:{const[u,f]=c.values;if(Ce(u)){const d=Pe(u);if(Ce(f)){const h=parseFloat(f);e.stats[d]=ke(h)?h:f}else ke(f)&&(e.stats[d]=f)}break}case fe.RANGE:case fe.SELECT:case fe.NUMBER:case fe.TEXT:case fe.LINK:case fe.HOTKEY:case fe.SCROLL:{const[u,...f]=c.values;if(Ce(u)){const d=Pe(u);e.stats[d]=f}break}}}}return S(e.stats.type)||(e.stats.type=Ae.OBJECT),e.stats}function Og(e){switch(e){default:case Ae.ERROR:return"error";case Ae.LOADER:return En(fe.LOADER);case Ae.BOARD:return En(fe.BOARD);case Ae.OBJECT:return En(fe.OBJECT);case Ae.TERRAIN:return En(fe.TERRAIN);case Ae.CHARSET:return En(fe.CHARSET);case Ae.PALETTE:return En(fe.PALETTE)}}function qs(e){return Ks(e).type??Ae.ERROR}function Xs(e){return Og(qs(e))}function Jn(e){return Ks(e).name??""}function Ng(e,t){const n=nI(e),r=Object.keys(n);for(let i=0;i<r.length;++i){const s=r[i];t[s]=n[s]}}function Nu(e){if(S(e))switch(qs(e)){default:return;case Ae.ERROR:return e.code??"";case Ae.LOADER:return e.code??"";case Ae.BOARD:return S(e.board)||(e.board=hv()),e.board.id=e.id,e.board;case Ae.OBJECT:return S(e.object)||(e.object=vd()),e.object.name=Jn(e),Ng(e,e.object),e.object;case Ae.TERRAIN:return S(e.terrain)||(e.terrain=vd()),e.terrain.name=Jn(e),Ng(e,e.terrain),e.terrain;case Ae.CHARSET:return S(e.charset),e.charset;case Ae.PALETTE:return S(e.palette),e.palette}}function Cg(e){return{id:gt(),name:ub(),timestamp:0,activelist:[],pages:e,flags:{}}}var Cu=(e=>(e[e.id=0]="id",e[e.name=1]="name",e[e.timestamp=2]="timestamp",e[e.activelist=3]="activelist",e[e.pages=4]="pages",e[e.flags=5]="flags",e))(Cu||{});function iI(e){return Ss(e,Cu,{pages:t=>t.map(eI)})}function sI(e){return As(e,Cu,{pages:t=>t.map(tI)})}function _i(e,t){if(!S(e))return;const n=Pe(t);return e.pages.find(i=>i.id===t||n===Jn(i))}function Lu(e,t,n){if(!S(e))return;const r=Pe(n);return e.pages.find(s=>qs(s)===t&&(s.id===n||r===Jn(s)))}function oI(e,t){return S(e)?e.pages.filter(n=>qs(n)===t):[]}function Lg(e,t){if(!S(e)||!S(t))return!1;const n=_i(e,t.id);return S(n)?!1:(e.pages.push(t),!0)}function aI(e,t){const n=_i(e,t);if(S(e)&&S(n)){const r=Pe(t);return e.pages=e.pages.filter(i=>i.id!==t&&r!==Jn(i)),n}}function Er(e,t){if(S(t)&&S(t.kind))return S(t.kinddata)||(t.kinddata=S(t.id)?za(e,t.kind):Ug(e,t.kind)),t.kinddata}function Mg(e,t){const n=Er(e,t);return{char:(t==null?void 0:t.char)??(n==null?void 0:n.char)??1,color:(t==null?void 0:t.color)??(n==null?void 0:n.color)??be.WHITE,bg:(t==null?void 0:t.bg)??(n==null?void 0:n.bg)??be.ONBORROW}}function za(e,t){const n=t??"",r=Lu(e,Ae.OBJECT,n);if(S(r)){const i=Nu(r);return{...ys(i),name:n,code:r.code}}}function Ug(e,t){const n=t??"",r=Lu(e,Ae.TERRAIN,n);if(S(r)){const i=Nu(r);return{...ys(i),name:n,code:r.code}}}function Zi(e,t){const n=_i(e,t);return Nu(n)}function Js(e,t){return e?(e.flags[t]=e.flags[t]??{},e.flags[t]):{}}function Mu(e,t){e&&delete e.flags[t]}function Pg(e,t,n){const r=Js(e,t);return r==null?void 0:r[n]}function cI(e,t,n,r){const i=Js(e,t);return i&&(i[n]=r),r}function Wa(e,t){const n=Pg(e,t,"board");return Zi(e,Ce(n)?n:"")}function Uu(e,t,n){if(!S(e))return;cI(e,t,"board",n);const r=Zi(e,n);S(r)?e.activelist.includes(t)||e.activelist.push(t):e.activelist=e.activelist.filter(i=>i!==t)}function lI(e){const n=((e==null?void 0:e.activelist)??[]).map(r=>{const i=Pg(e,r,"board");return Ce(i)?i:""});return fw(n)}function Dg(e){return lI(e).map(n=>Zi(e,n)).filter(S)}function uI(e,t,n,r){const i=Yo(t,(n==null?void 0:n.id)??"");if(!S(e)||!S(t)||!S(i)||!S(i.x)||!S(i.y)||!S(t.lookup)||r.x<0||r.x>=Ge||r.y<0||r.y>=hn)return{kind:"edge",collision:ct.ISSOLID,x:r.x,y:r.y};if(i.x-r.x===0&&i.y-r.y===0)return;const s=i.x+i.y*Ge,o=r.x+r.y*Ge,a=Er(e,i),c=i.collision??(a==null?void 0:a.collision),l=Yo(t,t.lookup[o]??"");if(S(l))return{...l};const u=t.terrain[o];if(S(u)){const f=Er(e,u),d=u.collision??(f==null?void 0:f.collision);if(ww(c,d))return{...u,x:r.x,y:r.y}}i.x=r.x,i.y=r.y,S(i.removed)||(t.lookup[s]=void 0,t.lookup[o]=i.id??"")}function Yi(e,t){const n=Er(e,t);return S(t==null?void 0:t.id)&&S(t.x)&&S(t.y)?Pe(t.name??(n==null?void 0:n.name)??"object"):Pe((t==null?void 0:t.name)??(n==null?void 0:n.name)??"terrain")}function Pu(e,t,n,r){if(!S(e)||!S(t)||!S(t.named)||!S(n))return;const i=Yi(e,n);t.named[i]||(t.named[i]=new Set),t.named[i].add((n==null?void 0:n.id)??r??"")}function fI(e,t,n){if(!(!S(e)||!S(t)||!S(t.lookup)||!S(n==null?void 0:n.id))&&!S(n.removed)){const r=n.x??0,i=n.y??0;t.lookup[r+i*Ge]=n.id}}function Ga(e,t){if(!S(e)||!S(t)||S(t.lookup)&&S(t.named))return;const n=new Array(Ge*hn).fill(void 0),r={},i=Object.values(t.objects);for(let a=0;a<i.length;++a){const c=i[a];if(S(c.x)&&S(c.y)&&S(c.id)&&!S(c.removed)){c.category=Co.ISOBJECT,n[c.x+c.y*Ge]=c.id;const l=Yi(e,c);r[l]||(r[l]=new Set),r[l].add(c.id)}}let s=0,o=0;for(let a=0;a<t.terrain.length;++a){const c=t.terrain[a];if(S(c)){c.x=s,c.y=o,c.category=Co.ISTERRAIN;const l=Yi(e,c);r[l]||(r[l]=new Set),r[l].add(a)}++s,s>=Ge&&(s=0,++o)}t.lookup=n,t.named=r}function Du(e,t,n){return Yi(e,t)!=="player"&&S(t)?(t.removed=n,!0):!1}function Zs(e,t,n){var r;if(S(e)&&S(t)&&S(n==null?void 0:n.id)){if(S(t.lookup)&&S(n.x)&&S(n.y)){const s=n.x+n.y*Ge;t.lookup[s]===n.id&&t.lookup.splice(s,1)}const i=Yi(e,n);S((r=t.named)==null?void 0:r[i])&&S(n.id)&&t.named[i].delete(n.id)}}function hI(e,t,n){const r=[];if(!S(e)||!S(t))return r;const i=Object.values(t.objects);for(let s=0;s<i.length;++s){const o=i[s];S(o.id)&&S(o.removed)&&n-o.removed>Ad*5&&(r.push(o.id),kd(t,o.id))}return r}function dI(e,t,n){const r=[];if(!S(e)||!S(t))return r;t.lookup=void 0,Ga(e,t);const i=Object.values(t.objects);for(let o=0;o<i.length;++o){const a=i[o];if(!S(a.id))continue;a.lx=a.x,a.ly=a.y;const c=Er(e,a),l=a.code??(c==null?void 0:c.code)??"";l&&r.push({id:a.id,type:Ae.OBJECT,code:l,object:a,terrain:void 0})}const s=hI(e,t,n);for(let o=0;o<s.length;++o)r.push({id:s[o],type:Ae.ERROR,code:"",object:void 0,terrain:void 0});return r}function pI(e,t,n,r){if(S(e)&&S(t)&&S(n)){const[i,s]=n,o=za(e,i);if(S(o)&&S(o.name)){const a=El(t,r,i);return Zo(a,s),Pu(e,t,a),a}}}function Bu(e,t,n,r){if(S(e)&&S(t)&&S(n)){const[i,s]=n,o=Ug(e,i);if(S(o)){const c=Ed(t,r,i);Zo(c,s);const l=r.x+r.y*Ge;return Pu(e,t,c,l),c}const a=za(e,i);if(S(a)&&S(a.name)){const c=El(t,r,i);return Zo(c,s),fI(e,t,c),Pu(e,t,c),c}}}function Ha(e,t,n,r){const i=Ce(t)?t:t.id,s=Ce(t)?void 0:{x:t.x??0,y:t.y??0},o=Ce(n)?n:n.id,a=i??s;S(o)&&S(a)&&e.send(o,r,a)}function mI(e,t,n,r){S(n==null?void 0:n.id)?(n.headless=!0,Zs(e,t,n)):Ed(t,r,"empty")}function Bg(e,t,n,r,i){const s=uI(t,n,r,i);if(S(s)){Ha(e,s,e.id(),"thud"),r.kind===Je.PLAYER?Ha(e,e.id(),s,"touch"):r.collision===ct.ISBULLET?Ha(e,e.id(),s,"shot"):Ha(e,e.id(),s,"bump");const o=Er(t,s);return(s.destructible??(o==null?void 0:o.destructible))&&mI(t,n,s,i),!1}return!0}function Fg(e,t,n){if(!ur(D.element))return 0;const[r,i]=re(t,0,[q.DIR,q.MAYBE_KIND]),s=i??["bullet"],o=pI(D.book,D.board,s,{x:D.element.x,y:D.element.y});if(S(o)){o.arg=n,o.collision=ct.ISBULLET,o.stepx=r.x-D.element.x,o.stepy=r.y-D.element.y;const a=Er(D.book,o),c=o.code??(a==null?void 0:a.code)??"";D_(D.book,D.board,o,c,1),o.x===D.element.x&&o.y===D.element.y?o.headless=!0:e.bucket(o.id)}return e.yield(),0}const gI=cr().command("change",(e,t)=>{if(!S(D.book)||!S(D.board))return 0;const[n,r]=re(t,0,[q.KIND,q.KIND]);Ga(D.book,D.board);const i=Qc(n)??"",s=el(D.board,i),o=vw(s,n),a=Qc(r),c=Bh(r),l=Fh(r);return o.forEach(u=>{if(Yi(D.book,u)===a)S(c)&&(u.color=c),S(l)&&(u.bg=l);else{if(S(u.id)&&(Zs(D.book,D.board,u),!Du(D.book,u,D.timestamp)))return;ur(u)&&Bu(D.book,D.board,r,u)}}),0}).command("put",(e,t)=>{if(!S(D.book)||!S(D.board))return 0;const[n,r]=re(t,0,[q.DIR,q.KIND]);return Ga(D.book,D.board),Bu(D.book,D.board,r,n),0}).command("shootwith",(e,t)=>{const[n,r]=re(t,0,[q.ANY]);return Fg(e,t.slice(r),n)}).command("shoot",Fg).command("throwstar",()=>0);function Ys(){return Ys=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Ys.apply(this,arguments)}function yI(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,Fu(e,t)}function Fu(e,t){return Fu=Object.setPrototypeOf||function(r,i){return r.__proto__=i,r},Fu(e,t)}function _I(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var $g=function(){function e(n){this.trigger=n,this.observing=new Map}var t=e.prototype;return t.registerConnection=function(r){var i=this.observing.get(r.observable);i||(i={byKey:new Set,iterate:!1},this.observing.set(r.observable,i)),r.type==="iterate"?i.iterate=!0:i.byKey.add(r.key)},t.removeObservers=function(){var r=this;this.observing.forEach(function(i,s){i.iterate&&s[vt].connections.iterate.delete(r),i.byKey.forEach(function(o){s[vt].connections.byKey.get(o).delete(r)})}),this.observing.clear()},e}(),bi=[],Va=function(e){yI(t,e);function t(r,i,s){var o;if(o=e.call(this,function(){return o._trigger()})||this,o.func=r,o.options=i,o.effect=s,o.isInitial=!0,o.reaction=function(){bi.push(_I(o));try{o.func()}finally{bi.pop()}o.effect&&(!o.isInitial||o.options.fireImmediately)&&o.effect(),o.isInitial=!1},!s&&!o.options.fireImmediately)throw new Error("if no effect function passed, should always fireImmediately");return o.reaction(),o}var n=t.prototype;return n._trigger=function(){if(bi.includes(this))throw new Error("already running reaction");this.removeObservers(),this.reaction()},t}($g);function jg(){return!!bi.length}function zg(){return bi.length?bi[bi.length-1]:void 0}function bI(e,t,n){var r=Ys({name:"unnamed",fireImmediately:!0},n),i=new Va(e,r,t);return i}var Ka=0;function Wg(){return Ka>0}function $u(e){Ka++;try{return e()}finally{Ka--,Ka===0&&vI()}}var ju=!1;function Gg(){return ju}function Hg(e){ju=!0;try{e()}finally{ju=!1}}function wI(e){return function(){return Hg(e)}}var zu=[];function vI(){var e=[].concat(zu);zu=[],Vg(e)}function Vg(e){var t=new Set;e.forEach(function(n){var r;(n.type==="add"||n.type==="delete")&&n.observable[vt].connections.iterate.forEach(function(i){t.add(i)}),(r=n.observable[vt].connections.byKey.get(n.key))==null||r.forEach(function(i){t.add(i)})}),t.forEach(function(n){n.trigger()})}function qa(e){if(Wg()){zu.push(e);return}Vg([e])}function Kg(e,t){if(e.type==="iterate")e.observable[vt].connections.iterate.add(t);else{var n=e.observable[vt].connections.byKey.get(e.key);n||(n=new Set,e.observable[vt].connections.byKey.set(e.key,n)),n.add(t)}}function Xa(e,t){if(!Gg()){var n=zg();n&&(Kg(e,n),n.registerConnection(e)),t&&(Kg(e,t),t.registerConnection(e))}}var Wu=Symbol("$skipreactive"),vt=Symbol("$reactive"),kn=Symbol("$reactiveproxy");function Qs(e,t){return!!(e&&e[kn]&&e[kn].implicitObserver===t)}function Gu(e){return e[Wu]=!0,e}function qg(e){return!!(e&&!Qs(e)&&e[vt])}function Hu(e,t,n){if(n===void 0&&(n=!1),e[Wu]||Qs(e,t))return e;var r=EI(e,n);if(!t)return r;var i=r[vt].proxiesWithImplicitObserver.get(t);if(!i){var s={implicitObserver:t};Object.setPrototypeOf(s,Xg),i=new Proxy(r[vt].raw,s),r[vt].proxiesWithImplicitObserver.set(t,i)}return i}var eo=Hu;function EI(e,t){if(t===void 0&&(t=!1),Qs(e))return e;if(qg(e))return e[vt].proxy;if(e[vt]||e[kn])throw new Error("unexpected");var n={connections:{iterate:new Set,byKey:new Map},proxy:{},raw:e,proxiesWithImplicitObserver:new Map,shallow:t};Object.defineProperty(e,vt,{enumerable:!1,writable:!0,configurable:!0,value:n});var r=new Proxy(e,Xg);return n.proxy=r,r}var Xg={has:function(t,n){var r=Reflect.has(t,n);return typeof n=="symbol"||Xa({observable:t,key:n,type:"has"},this.implicitObserver),r},get:function(t,n,r){if(n===kn)return{implicitObserver:this.implicitObserver};var i=Reflect.get(t,n,r);if(typeof n=="symbol")return n.toString()==="Symbol($reactiveproxy)"&&console.error("warning, Symbol($reactiveproxy) passed, but does not match $reactiveproxy. Multiple Reactive libraries loaded?"),i;if(n==="length"&&Array.isArray(t)?Xa({observable:t,type:"iterate"},this.implicitObserver):Xa({observable:t,key:n,type:"get"},this.implicitObserver),qg(i))return Hu(i,this.implicitObserver);if(t[vt].shallow)return i;if(typeof i=="object"&&i!==null&&!Qs(i,this.implicitObserver)&&!Object.isFrozen(i)){var s=Reflect.getOwnPropertyDescriptor(t,n);if((!s||!(s.writable===!1&&s.configurable===!1))&&(jg()||this.implicitObserver))return Hu(i,this.implicitObserver)}return i},ownKeys:function(t){return Xa({observable:t,type:"iterate"},this.implicitObserver),Reflect.ownKeys(t)},set:function(t,n,r,i){return $u(function(){if(typeof n=="symbol")return Reflect.set(t,n,r,i);var s=Object.hasOwnProperty.call(t,n),o=Reflect.get(t,n,i),a=Reflect.set(t,n,r,i);if(!s)qa({observable:t,key:n,value:r,type:"add"});else if(r!==o)if(n==="length"&&Array.isArray(t)){if(!(o<r))for(var c=r+1;c<=o;c++)qa({observable:t,key:""+(c-1),oldValue:void 0,type:"delete"})}else qa({observable:t,key:n,value:r,oldValue:o,type:"update"});return a})},deleteProperty:function(t,n){return $u(function(){if(typeof n=="symbol")return Reflect.deleteProperty(t,n);var r=Object.hasOwnProperty.call(t,n),i=Reflect.get(t,n),s=Reflect.deleteProperty(t,n);return r&&qa({observable:t,key:n,oldValue:i,type:"delete"}),s})},preventExtensions:function(t){throw new Error("Dynamic observable objects cannot be frozen")}};function kI(e,t){var n=Ys({name:"unnamed",fireImmediately:!0},t),r=new Va(e,n);return r}function SI(e,t,n){var r=Ys({name:"unnamed",fireImmediately:!0},n),i=new Va(function(){e(t)},r);return t=eo(t,i),r.fireImmediately&&i.trigger(),i}var Jg=function(){function e(){this._observable=eo({_key:1})}var t=e.prototype;return t.reportObserved=function(r){return eo(this._observable,r)._key},t.reportChanged=function(){this._observable._key++},e}();function AI(e,t,n){return new Jg}var TI=Object.freeze({__proto__:null,$reactive:vt,$reactiveproxy:kn,$skipreactive:Wu,Atom:Jg,Observer:$g,Reaction:Va,autorun:kI,autorunAsync:SI,createAtom:AI,hasRunningReaction:jg,isActionRunning:Wg,isReactive:Qs,isTrackingDisabled:Gg,markRaw:Gu,reaction:bI,reactive:eo,runInAction:$u,runningReaction:zg,untracked:Hg,untrackedCB:wI});const Ln=()=>new Map,Vu=e=>{const t=Ln();return e.forEach((n,r)=>{t.set(r,n)}),t},Wr=(e,t,n)=>{let r=e.get(t);return r===void 0&&e.set(t,r=n()),r},xI=(e,t)=>{const n=[];for(const[r,i]of e)n.push(t(i,r));return n},RI=(e,t)=>{for(const[n,r]of e)if(t(r,n))return!0;return!1},Qi=()=>new Set,Ku=e=>e[e.length-1],II=(e,t)=>{for(let n=0;n<t.length;n++)e.push(t[n])},Gr=Array.from,OI=Array.isArray;class NI{constructor(){this._observers=Ln()}on(t,n){return Wr(this._observers,t,Qi).add(n),n}once(t,n){const r=(...i)=>{this.off(t,r),n(...i)};this.on(t,r)}off(t,n){const r=this._observers.get(t);r!==void 0&&(r.delete(n),r.size===0&&this._observers.delete(t))}emit(t,n){return Gr((this._observers.get(t)||Ln()).values()).forEach(r=>r(...n))}destroy(){this._observers=Ln()}}const Hr=Math.floor,Ja=Math.abs,Zg=(e,t)=>e<t?e:t,wi=(e,t)=>e>t?e:t,Yg=e=>e!==0?e<0:1/e<0,Qg=1,e0=2,qu=4,Xu=8,to=32,kr=64,an=128,Za=31,Ju=63,vi=127,CI=2147483647,t0=Number.MAX_SAFE_INTEGER,LI=Number.isInteger||(e=>typeof e=="number"&&isFinite(e)&&Hr(e)===e),MI=e=>e.toLowerCase(),UI=/^\s*/g,PI=e=>e.replace(UI,""),DI=/([A-Z])/g,n0=(e,t)=>PI(e.replace(DI,n=>`${t}${MI(n)}`)),BI=e=>{const t=unescape(encodeURIComponent(e)),n=t.length,r=new Uint8Array(n);for(let i=0;i<n;i++)r[i]=t.codePointAt(i);return r},no=typeof TextEncoder<"u"?new TextEncoder:null,FI=no?e=>no.encode(e):BI;let ro=typeof TextDecoder>"u"?null:new TextDecoder("utf-8",{fatal:!0,ignoreBOM:!0});ro&&ro.decode(new Uint8Array).length===1&&(ro=null);class io{constructor(){this.cpos=0,this.cbuf=new Uint8Array(100),this.bufs=[]}}const Vr=()=>new io,$I=e=>{let t=e.cpos;for(let n=0;n<e.bufs.length;n++)t+=e.bufs[n].length;return t},Mn=e=>{const t=new Uint8Array($I(e));let n=0;for(let r=0;r<e.bufs.length;r++){const i=e.bufs[r];t.set(i,n),n+=i.length}return t.set(new Uint8Array(e.cbuf.buffer,0,e.cpos),n),t},jI=(e,t)=>{const n=e.cbuf.length;n-e.cpos<t&&(e.bufs.push(new Uint8Array(e.cbuf.buffer,0,e.cpos)),e.cbuf=new Uint8Array(wi(n,t)*2),e.cpos=0)},It=(e,t)=>{const n=e.cbuf.length;e.cpos===n&&(e.bufs.push(e.cbuf),e.cbuf=new Uint8Array(n*2),e.cpos=0),e.cbuf[e.cpos++]=t},Zu=It,ve=(e,t)=>{for(;t>vi;)It(e,an|vi&t),t=Hr(t/128);It(e,vi&t)},Yu=(e,t)=>{const n=Yg(t);for(n&&(t=-t),It(e,(t>Ju?an:0)|(n?kr:0)|Ju&t),t=Hr(t/64);t>0;)It(e,(t>vi?an:0)|vi&t),t=Hr(t/128)},Qu=new Uint8Array(3e4),zI=Qu.length/3,WI=(e,t)=>{if(t.length<zI){const n=no.encodeInto(t,Qu).written||0;ve(e,n);for(let r=0;r<n;r++)It(e,Qu[r])}else Pt(e,FI(t))},GI=(e,t)=>{const n=unescape(encodeURIComponent(t)),r=n.length;ve(e,r);for(let i=0;i<r;i++)It(e,n.codePointAt(i))},es=no&&no.encodeInto?WI:GI,Ya=(e,t)=>{const n=e.cbuf.length,r=e.cpos,i=Zg(n-r,t.length),s=t.length-i;e.cbuf.set(t.subarray(0,i),r),e.cpos+=i,s>0&&(e.bufs.push(e.cbuf),e.cbuf=new Uint8Array(wi(n*2,s)),e.cbuf.set(t.subarray(i)),e.cpos=s)},Pt=(e,t)=>{ve(e,t.byteLength),Ya(e,t)},ef=(e,t)=>{jI(e,t);const n=new DataView(e.cbuf.buffer,e.cpos,t);return e.cpos+=t,n},HI=(e,t)=>ef(e,4).setFloat32(0,t,!1),VI=(e,t)=>ef(e,8).setFloat64(0,t,!1),KI=(e,t)=>ef(e,8).setBigInt64(0,t,!1),r0=new DataView(new ArrayBuffer(4)),qI=e=>(r0.setFloat32(0,e),r0.getFloat32(0)===e),so=(e,t)=>{switch(typeof t){case"string":It(e,119),es(e,t);break;case"number":LI(t)&&Ja(t)<=CI?(It(e,125),Yu(e,t)):qI(t)?(It(e,124),HI(e,t)):(It(e,123),VI(e,t));break;case"bigint":It(e,122),KI(e,t);break;case"object":if(t===null)It(e,126);else if(OI(t)){It(e,117),ve(e,t.length);for(let n=0;n<t.length;n++)so(e,t[n])}else if(t instanceof Uint8Array)It(e,116),Pt(e,t);else{It(e,118);const n=Object.keys(t);ve(e,n.length);for(let r=0;r<n.length;r++){const i=n[r];es(e,i),so(e,t[i])}}break;case"boolean":It(e,t?120:121);break;default:It(e,127)}};class i0 extends io{constructor(t){super(),this.w=t,this.s=null,this.count=0}write(t){this.s===t?this.count++:(this.count>0&&ve(this,this.count-1),this.count=1,this.w(this,t),this.s=t)}}const s0=e=>{e.count>0&&(Yu(e.encoder,e.count===1?e.s:-e.s),e.count>1&&ve(e.encoder,e.count-2))};class Qa{constructor(){this.encoder=new io,this.s=0,this.count=0}write(t){this.s===t?this.count++:(s0(this),this.count=1,this.s=t)}toUint8Array(){return s0(this),Mn(this.encoder)}}const o0=e=>{if(e.count>0){const t=e.diff*2+(e.count===1?0:1);Yu(e.encoder,t),e.count>1&&ve(e.encoder,e.count-2)}};class tf{constructor(){this.encoder=new io,this.s=0,this.count=0,this.diff=0}write(t){this.diff===t-this.s?(this.s=t,this.count++):(o0(this),this.count=1,this.diff=t-this.s,this.s=t)}toUint8Array(){return o0(this),Mn(this.encoder)}}class XI{constructor(){this.sarr=[],this.s="",this.lensE=new Qa}write(t){this.s+=t,this.s.length>19&&(this.sarr.push(this.s),this.s=""),this.lensE.write(t.length)}toUint8Array(){const t=new io;return this.sarr.push(this.s),this.s="",es(t,this.sarr.join("")),Ya(t,this.lensE.toUint8Array()),Mn(t)}}const Kr=e=>new Error(e),Zn=()=>{throw Kr("Method unimplemented")},Yn=()=>{throw Kr("Unexpected case")},a0=Kr("Unexpected end of array"),c0=Kr("Integer out of Range");class ec{constructor(t){this.arr=t,this.pos=0}}const Ei=e=>new ec(e),JI=e=>e.pos!==e.arr.length,ZI=(e,t)=>{const n=new Uint8Array(e.arr.buffer,e.pos+e.arr.byteOffset,t);return e.pos+=t,n},Ht=e=>ZI(e,Ee(e)),ts=e=>e.arr[e.pos++],Ee=e=>{let t=0,n=1;const r=e.arr.length;for(;e.pos<r;){const i=e.arr[e.pos++];if(t=t+(i&vi)*n,n*=128,i<an)return t;if(t>t0)throw c0}throw a0},nf=e=>{let t=e.arr[e.pos++],n=t&Ju,r=64;const i=(t&kr)>0?-1:1;if(!(t&an))return i*n;const s=e.arr.length;for(;e.pos<s;){if(t=e.arr[e.pos++],n=n+(t&vi)*r,r*=128,t<an)return i*n;if(n>t0)throw c0}throw a0},ns=ro?e=>ro.decode(Ht(e)):e=>{let t=Ee(e);if(t===0)return"";{let n=String.fromCodePoint(ts(e));if(--t<100)for(;t--;)n+=String.fromCodePoint(ts(e));else for(;t>0;){const r=t<1e4?t:1e4,i=e.arr.subarray(e.pos,e.pos+r);e.pos+=r,n+=String.fromCodePoint.apply(null,i),t-=r}return decodeURIComponent(escape(n))}},rf=(e,t)=>{const n=new DataView(e.arr.buffer,e.arr.byteOffset+e.pos,t);return e.pos+=t,n},YI=[e=>{},e=>null,nf,e=>rf(e,4).getFloat32(0,!1),e=>rf(e,8).getFloat64(0,!1),e=>rf(e,8).getBigInt64(0,!1),e=>!1,e=>!0,ns,e=>{const t=Ee(e),n={};for(let r=0;r<t;r++){const i=ns(e);n[i]=oo(e)}return n},e=>{const t=Ee(e),n=[];for(let r=0;r<t;r++)n.push(oo(e));return n},Ht],oo=e=>YI[127-ts(e)](e);class l0 extends ec{constructor(t,n){super(t),this.reader=n,this.s=null,this.count=0}read(){return this.count===0&&(this.s=this.reader(this),JI(this)?this.count=Ee(this)+1:this.count=-1),this.count--,this.s}}class tc extends ec{constructor(t){super(t),this.s=0,this.count=0}read(){if(this.count===0){this.s=nf(this);const t=Yg(this.s);this.count=1,t&&(this.s=-this.s,this.count=Ee(this)+2)}return this.count--,this.s}}class sf extends ec{constructor(t){super(t),this.s=0,this.count=0,this.diff=0}read(){if(this.count===0){const t=nf(this),n=t&1;this.diff=Hr(t/2),this.count=1,n&&(this.count=Ee(this)+2)}return this.s+=this.diff,this.count--,this.s}}class QI{constructor(t){this.decoder=new tc(t),this.str=ns(this.decoder),this.spos=0}read(){const t=this.spos+this.decoder.read(),n=this.str.slice(this.spos,t);return this.spos=t,n}}const eO=crypto.getRandomValues.bind(crypto),u0=()=>eO(new Uint32Array(1))[0],tO="10000000-1000-4000-8000"+-1e11,nO=()=>tO.replace(/[018]/g,e=>(e^u0()&15>>e/4).toString(16)),f0=e=>new Promise(e);Promise.all.bind(Promise);const h0=e=>e===void 0?null:e;class rO{constructor(){this.map=new Map}setItem(t,n){this.map.set(t,n)}getItem(t){return this.map.get(t)}}let d0=new rO,iO=!0;try{typeof localStorage<"u"&&localStorage&&(d0=localStorage,iO=!1)}catch{}const sO=d0,oO=Object.assign,aO=Object.keys,cO=(e,t)=>{for(const n in e)t(e[n],n)},p0=e=>aO(e).length,lO=e=>{for(const t in e)return!1;return!0},uO=(e,t)=>{for(const n in e)if(!t(e[n],n))return!1;return!0},fO=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),hO=(e,t)=>e===t||p0(e)===p0(t)&&uO(e,(n,r)=>(n!==void 0||fO(t,r))&&t[r]===n),dO=Object.freeze,m0=e=>{for(const t in e){const n=e[t];(typeof n=="object"||typeof n=="function")&&m0(e[t])}return dO(e)},of=(e,t,n=0)=>{try{for(;n<e.length;n++)e[n](...t)}finally{n<e.length&&of(e,t,n+1)}},pO=e=>e,mO=(e,t)=>t.includes(e);var g0={};const ao=typeof process<"u"&&process.release&&/node|io\.js/.test(process.release.name)&&Object.prototype.toString.call(typeof process<"u"?process:0)==="[object process]";let Qn;const gO=()=>{if(Qn===void 0)if(ao){Qn=Ln();const e=process.argv;let t=null;for(let n=0;n<e.length;n++){const r=e[n];r[0]==="-"?(t!==null&&Qn.set(t,""),t=r):t!==null&&(Qn.set(t,r),t=null)}t!==null&&Qn.set(t,"")}else typeof location=="object"?(Qn=Ln(),(location.search||"?").slice(1).split("&").forEach(e=>{if(e.length!==0){const[t,n]=e.split("=");Qn.set(`--${n0(t,"-")}`,n),Qn.set(`-${n0(t,"-")}`,n)}})):Qn=Ln();return Qn},af=e=>gO().has(e),nc=e=>h0(ao?g0[e.toUpperCase().replaceAll("-","_")]:sO.getItem(e)),y0=e=>af("--"+e)||nc(e)!==null;y0("production");const yO=ao&&mO(g0.FORCE_COLOR,["true","1","2"])||!af("--no-colors")&&!y0("no-color")&&(!ao||process.stdout.isTTY)&&(!ao||af("--color")||nc("COLORTERM")!==null||(nc("TERM")||"").includes("color")),_O=e=>new Uint8Array(e),bO=e=>{const t=_O(e.byteLength);return t.set(e),t};class wO{constructor(t,n){this.left=t,this.right=n}}const Sr=(e,t)=>new wO(e,t);typeof DOMParser<"u"&&new DOMParser;const vO=e=>xI(e,(t,n)=>`${n}:${t};`).join(""),Ar=Symbol,_0=Ar(),b0=Ar(),EO=Ar(),kO=Ar(),SO=Ar(),w0=Ar(),AO=Ar(),cf=Ar(),TO=Ar(),xO=e=>{var i;e.length===1&&((i=e[0])==null?void 0:i.constructor)===Function&&(e=e[0]());const t=[],n=[];let r=0;for(;r<e.length;r++){const s=e[r];if(s===void 0)break;if(s.constructor===String||s.constructor===Number)t.push(s);else if(s.constructor===Object)break}for(r>0&&n.push(t.join(""));r<e.length;r++){const s=e[r];s instanceof Symbol||n.push(s)}return n},RO={[_0]:Sr("font-weight","bold"),[b0]:Sr("font-weight","normal"),[EO]:Sr("color","blue"),[SO]:Sr("color","green"),[kO]:Sr("color","grey"),[w0]:Sr("color","red"),[AO]:Sr("color","purple"),[cf]:Sr("color","orange"),[TO]:Sr("color","black")},v0=yO?e=>{var o;e.length===1&&((o=e[0])==null?void 0:o.constructor)===Function&&(e=e[0]());const t=[],n=[],r=Ln();let i=[],s=0;for(;s<e.length;s++){const a=e[s],c=RO[a];if(c!==void 0)r.set(c.left,c.right);else{if(a===void 0)break;if(a.constructor===String||a.constructor===Number){const l=vO(r);s>0||l.length>0?(t.push("%c"+a),n.push(l)):t.push(a)}else break}}for(s>0&&(i=n,i.unshift(t.join("")));s<e.length;s++){const a=e[s];a instanceof Symbol||i.push(a)}return i}:xO,IO=(...e)=>{console.log(...v0(e)),E0.forEach(t=>t.print(e))},OO=(...e)=>{console.warn(...v0(e)),e.unshift(cf),E0.forEach(t=>t.print(e))},E0=Qi(),k0=e=>({[Symbol.iterator](){return this},next:e}),NO=(e,t)=>k0(()=>{let n;do n=e.next();while(!n.done&&!t(n.value));return n}),lf=(e,t)=>k0(()=>{const{done:n,value:r}=e.next();return{done:n,value:n?void 0:t(r)}});class uf{constructor(t,n){this.clock=t,this.len=n}}class co{constructor(){this.clients=new Map}}const S0=(e,t,n)=>t.clients.forEach((r,i)=>{const s=e.doc.store.clients.get(i);for(let o=0;o<r.length;o++){const a=r[o];z0(e,s,a.clock,a.len,n)}}),CO=(e,t)=>{let n=0,r=e.length-1;for(;n<=r;){const i=Hr((n+r)/2),s=e[i],o=s.clock;if(o<=t){if(t<o+s.len)return i;n=i+1}else r=i-1}return null},A0=(e,t)=>{const n=e.clients.get(t.client);return n!==void 0&&CO(n,t.clock)!==null},ff=e=>{e.clients.forEach(t=>{t.sort((i,s)=>i.clock-s.clock);let n,r;for(n=1,r=1;n<t.length;n++){const i=t[r-1],s=t[n];i.clock+i.len>=s.clock?i.len=wi(i.len,s.clock+s.len-i.clock):(r<n&&(t[r]=s),r++)}t.length=r})},LO=e=>{const t=new co;for(let n=0;n<e.length;n++)e[n].clients.forEach((r,i)=>{if(!t.clients.has(i)){const s=r.slice();for(let o=n+1;o<e.length;o++)II(s,e[o].clients.get(i)||[]);t.clients.set(i,s)}});return ff(t),t},rc=(e,t,n,r)=>{Wr(e.clients,t,()=>[]).push(new uf(n,r))},MO=()=>new co,UO=e=>{const t=MO();return e.clients.forEach((n,r)=>{const i=[];for(let s=0;s<n.length;s++){const o=n[s];if(o.deleted){const a=o.id.clock;let c=o.length;if(s+1<n.length)for(let l=n[s+1];s+1<n.length&&l.deleted;l=n[++s+1])c+=l.length;i.push(new uf(a,c))}}i.length>0&&t.clients.set(r,i)}),t},rs=(e,t)=>{ve(e.restEncoder,t.clients.size),Gr(t.clients.entries()).sort((n,r)=>r[0]-n[0]).forEach(([n,r])=>{e.resetDsCurVal(),ve(e.restEncoder,n);const i=r.length;ve(e.restEncoder,i);for(let s=0;s<i;s++){const o=r[s];e.writeDsClock(o.clock),e.writeDsLen(o.len)}})},hf=e=>{const t=new co,n=Ee(e.restDecoder);for(let r=0;r<n;r++){e.resetDsCurVal();const i=Ee(e.restDecoder),s=Ee(e.restDecoder);if(s>0){const o=Wr(t.clients,i,()=>[]);for(let a=0;a<s;a++)o.push(new uf(e.readDsClock(),e.readDsLen()))}}return t},T0=(e,t,n)=>{const r=new co,i=Ee(e.restDecoder);for(let s=0;s<i;s++){e.resetDsCurVal();const o=Ee(e.restDecoder),a=Ee(e.restDecoder),c=n.clients.get(o)||[],l=Ot(n,o);for(let u=0;u<a;u++){const f=e.readDsClock(),d=f+e.readDsLen();if(f<l){l<d&&rc(r,o,l,d-l);let h=Un(c,f),p=c[h];for(!p.deleted&&p.id.clock<f&&(c.splice(h+1,0,gc(t,p,f-p.id.clock)),h++);h<c.length&&(p=c[h++],p.id.clock<d);)p.deleted||(d<p.id.clock+p.length&&c.splice(h,0,gc(t,p,d-p.id.clock)),p.delete(t))}else rc(r,o,f,d-f)}}if(r.clients.size>0){const s=new ki;return ve(s.restEncoder,0),rs(s,r),s.toUint8Array()}return null},x0=u0;class Tr extends NI{constructor({guid:t=nO(),collectionid:n=null,gc:r=!0,gcFilter:i=()=>!0,meta:s=null,autoLoad:o=!1,shouldLoad:a=!0}={}){super(),this.gc=r,this.gcFilter=i,this.clientID=x0(),this.guid=t,this.collectionid=n,this.share=new Map,this.store=new F0,this._transaction=null,this._transactionCleanups=[],this.subdocs=new Set,this._item=null,this.shouldLoad=a,this.autoLoad=o,this.meta=s,this.isLoaded=!1,this.isSynced=!1,this.isDestroyed=!1,this.whenLoaded=f0(l=>{this.on("load",()=>{this.isLoaded=!0,l(this)})});const c=()=>f0(l=>{const u=f=>{(f===void 0||f===!0)&&(this.off("sync",u),l())};this.on("sync",u)});this.on("sync",l=>{l===!1&&this.isSynced&&(this.whenSynced=c()),this.isSynced=l===void 0||l===!0,this.isSynced&&!this.isLoaded&&this.emit("load",[this])}),this.whenSynced=c()}load(){const t=this._item;t!==null&&!this.shouldLoad&&Xe(t.parent.doc,n=>{n.subdocsLoaded.add(this)},null,!0),this.shouldLoad=!0}getSubdocs(){return this.subdocs}getSubdocGuids(){return new Set(Gr(this.subdocs).map(t=>t.guid))}transact(t,n=null){return Xe(this,t,n)}get(t,n=ot){const r=Wr(this.share,t,()=>{const s=new n;return s._integrate(this,null),s}),i=r.constructor;if(n!==ot&&i!==n)if(i===ot){const s=new n;s._map=r._map,r._map.forEach(o=>{for(;o!==null;o=o.left)o.parent=s}),s._start=r._start;for(let o=s._start;o!==null;o=o.right)o.parent=s;return s._length=r._length,this.share.set(t,s),s._integrate(this,null),s}else throw new Error(`Type with the name ${t} has already been defined with a different constructor`);return r}getArray(t=""){return this.get(t,er)}getText(t=""){return this.get(t,Pn)}getMap(t=""){return this.get(t,tr)}getXmlElement(t=""){return this.get(t,xr)}getXmlFragment(t=""){return this.get(t,nr)}toJSON(){const t={};return this.share.forEach((n,r)=>{t[r]=n.toJSON()}),t}destroy(){this.isDestroyed=!0,Gr(this.subdocs).forEach(n=>n.destroy());const t=this._item;if(t!==null){this._item=null;const n=t.content;n.doc=new Tr({guid:this.guid,...n.opts,shouldLoad:!1}),n.doc._item=t,Xe(t.parent.doc,r=>{const i=n.doc;t.deleted||r.subdocsAdded.add(i),r.subdocsRemoved.add(this)},null,!0)}this.emit("destroyed",[!0]),this.emit("destroy",[this]),super.destroy()}}class R0{constructor(t){this.restDecoder=t}resetDsCurVal(){}readDsClock(){return Ee(this.restDecoder)}readDsLen(){return Ee(this.restDecoder)}}class I0 extends R0{readLeftID(){return Oe(Ee(this.restDecoder),Ee(this.restDecoder))}readRightID(){return Oe(Ee(this.restDecoder),Ee(this.restDecoder))}readClient(){return Ee(this.restDecoder)}readInfo(){return ts(this.restDecoder)}readString(){return ns(this.restDecoder)}readParentInfo(){return Ee(this.restDecoder)===1}readTypeRef(){return Ee(this.restDecoder)}readLen(){return Ee(this.restDecoder)}readAny(){return oo(this.restDecoder)}readBuf(){return bO(Ht(this.restDecoder))}readJSON(){return JSON.parse(ns(this.restDecoder))}readKey(){return ns(this.restDecoder)}}class PO{constructor(t){this.dsCurrVal=0,this.restDecoder=t}resetDsCurVal(){this.dsCurrVal=0}readDsClock(){return this.dsCurrVal+=Ee(this.restDecoder),this.dsCurrVal}readDsLen(){const t=Ee(this.restDecoder)+1;return this.dsCurrVal+=t,t}}class is extends PO{constructor(t){super(t),this.keys=[],Ee(t),this.keyClockDecoder=new sf(Ht(t)),this.clientDecoder=new tc(Ht(t)),this.leftClockDecoder=new sf(Ht(t)),this.rightClockDecoder=new sf(Ht(t)),this.infoDecoder=new l0(Ht(t),ts),this.stringDecoder=new QI(Ht(t)),this.parentInfoDecoder=new l0(Ht(t),ts),this.typeRefDecoder=new tc(Ht(t)),this.lenDecoder=new tc(Ht(t))}readLeftID(){return new ss(this.clientDecoder.read(),this.leftClockDecoder.read())}readRightID(){return new ss(this.clientDecoder.read(),this.rightClockDecoder.read())}readClient(){return this.clientDecoder.read()}readInfo(){return this.infoDecoder.read()}readString(){return this.stringDecoder.read()}readParentInfo(){return this.parentInfoDecoder.read()===1}readTypeRef(){return this.typeRefDecoder.read()}readLen(){return this.lenDecoder.read()}readAny(){return oo(this.restDecoder)}readBuf(){return Ht(this.restDecoder)}readJSON(){return oo(this.restDecoder)}readKey(){const t=this.keyClockDecoder.read();if(t<this.keys.length)return this.keys[t];{const n=this.stringDecoder.read();return this.keys.push(n),n}}}class O0{constructor(){this.restEncoder=Vr()}toUint8Array(){return Mn(this.restEncoder)}resetDsCurVal(){}writeDsClock(t){ve(this.restEncoder,t)}writeDsLen(t){ve(this.restEncoder,t)}}class lo extends O0{writeLeftID(t){ve(this.restEncoder,t.client),ve(this.restEncoder,t.clock)}writeRightID(t){ve(this.restEncoder,t.client),ve(this.restEncoder,t.clock)}writeClient(t){ve(this.restEncoder,t)}writeInfo(t){Zu(this.restEncoder,t)}writeString(t){es(this.restEncoder,t)}writeParentInfo(t){ve(this.restEncoder,t?1:0)}writeTypeRef(t){ve(this.restEncoder,t)}writeLen(t){ve(this.restEncoder,t)}writeAny(t){so(this.restEncoder,t)}writeBuf(t){Pt(this.restEncoder,t)}writeJSON(t){es(this.restEncoder,JSON.stringify(t))}writeKey(t){es(this.restEncoder,t)}}class N0{constructor(){this.restEncoder=Vr(),this.dsCurrVal=0}toUint8Array(){return Mn(this.restEncoder)}resetDsCurVal(){this.dsCurrVal=0}writeDsClock(t){const n=t-this.dsCurrVal;this.dsCurrVal=t,ve(this.restEncoder,n)}writeDsLen(t){t===0&&Yn(),ve(this.restEncoder,t-1),this.dsCurrVal+=t}}class ki extends N0{constructor(){super(),this.keyMap=new Map,this.keyClock=0,this.keyClockEncoder=new tf,this.clientEncoder=new Qa,this.leftClockEncoder=new tf,this.rightClockEncoder=new tf,this.infoEncoder=new i0(Zu),this.stringEncoder=new XI,this.parentInfoEncoder=new i0(Zu),this.typeRefEncoder=new Qa,this.lenEncoder=new Qa}toUint8Array(){const t=Vr();return ve(t,0),Pt(t,this.keyClockEncoder.toUint8Array()),Pt(t,this.clientEncoder.toUint8Array()),Pt(t,this.leftClockEncoder.toUint8Array()),Pt(t,this.rightClockEncoder.toUint8Array()),Pt(t,Mn(this.infoEncoder)),Pt(t,this.stringEncoder.toUint8Array()),Pt(t,Mn(this.parentInfoEncoder)),Pt(t,this.typeRefEncoder.toUint8Array()),Pt(t,this.lenEncoder.toUint8Array()),Ya(t,Mn(this.restEncoder)),Mn(t)}writeLeftID(t){this.clientEncoder.write(t.client),this.leftClockEncoder.write(t.clock)}writeRightID(t){this.clientEncoder.write(t.client),this.rightClockEncoder.write(t.clock)}writeClient(t){this.clientEncoder.write(t)}writeInfo(t){this.infoEncoder.write(t)}writeString(t){this.stringEncoder.write(t)}writeParentInfo(t){this.parentInfoEncoder.write(t?1:0)}writeTypeRef(t){this.typeRefEncoder.write(t)}writeLen(t){this.lenEncoder.write(t)}writeAny(t){so(this.restEncoder,t)}writeBuf(t){Pt(this.restEncoder,t)}writeJSON(t){so(this.restEncoder,t)}writeKey(t){const n=this.keyMap.get(t);n===void 0?(this.keyClockEncoder.write(this.keyClock++),this.stringEncoder.write(t)):this.keyClockEncoder.write(n)}}const DO=(e,t,n,r)=>{r=wi(r,t[0].id.clock);const i=Un(t,r);ve(e.restEncoder,t.length-i),e.writeClient(n),ve(e.restEncoder,r);const s=t[i];s.write(e,r-s.id.clock);for(let o=i+1;o<t.length;o++)t[o].write(e,0)},df=(e,t,n)=>{const r=new Map;n.forEach((i,s)=>{Ot(t,s)>i&&r.set(s,i)}),sc(t).forEach((i,s)=>{n.has(s)||r.set(s,0)}),ve(e.restEncoder,r.size),Gr(r.entries()).sort((i,s)=>s[0]-i[0]).forEach(([i,s])=>{DO(e,t.clients.get(i),i,s)})},BO=(e,t)=>{const n=Ln(),r=Ee(e.restDecoder);for(let i=0;i<r;i++){const s=Ee(e.restDecoder),o=new Array(s),a=e.readClient();let c=Ee(e.restDecoder);n.set(a,{i:0,refs:o});for(let l=0;l<s;l++){const u=e.readInfo();switch(Za&u){case 0:{const f=e.readLen();o[l]=new cn(Oe(a,c),f),c+=f;break}case 10:{const f=Ee(e.restDecoder);o[l]=new Sn(Oe(a,c),f),c+=f;break}default:{const f=(u&(kr|an))===0,d=new kt(Oe(a,c),null,(u&an)===an?e.readLeftID():null,null,(u&kr)===kr?e.readRightID():null,f?e.readParentInfo()?t.get(e.readString()):e.readLeftID():null,f&&(u&to)===to?e.readString():null,dy(e,u));o[l]=d,c+=d.length}}}}return n},FO=(e,t,n)=>{const r=[];let i=Gr(n.keys()).sort((h,p)=>h-p);if(i.length===0)return null;const s=()=>{if(i.length===0)return null;let h=n.get(i[i.length-1]);for(;h.refs.length===h.i;)if(i.pop(),i.length>0)h=n.get(i[i.length-1]);else return null;return h};let o=s();if(o===null)return null;const a=new F0,c=new Map,l=(h,p)=>{const m=c.get(h);(m==null||m>p)&&c.set(h,p)};let u=o.refs[o.i++];const f=new Map,d=()=>{for(const h of r){const p=h.id.client,m=n.get(p);m?(m.i--,a.clients.set(p,m.refs.slice(m.i)),n.delete(p),m.i=0,m.refs=[]):a.clients.set(p,[h]),i=i.filter(b=>b!==p)}r.length=0};for(;;){if(u.constructor!==Sn){const p=Wr(f,u.id.client,()=>Ot(t,u.id.client))-u.id.clock;if(p<0)r.push(u),l(u.id.client,u.id.clock-1),d();else{const m=u.getMissing(e,t);if(m!==null){r.push(u);const b=n.get(m)||{refs:[],i:0};if(b.refs.length===b.i)l(m,Ot(t,m)),d();else{u=b.refs[b.i++];continue}}else(p===0||p<u.length)&&(u.integrate(e,p),f.set(u.id.client,u.id.clock+u.length))}}if(r.length>0)u=r.pop();else if(o!==null&&o.i<o.refs.length)u=o.refs[o.i++];else{if(o=s(),o===null)break;u=o.refs[o.i++]}}if(a.clients.size>0){const h=new ki;return df(h,a,new Map),ve(h.restEncoder,0),{missing:c,update:h.toUint8Array()}}return null},$O=(e,t)=>df(e,t.doc.store,t.beforeState),jO=(e,t,n,r=new is(e))=>Xe(t,i=>{i.local=!1;let s=!1;const o=i.doc,a=o.store,c=BO(r,o),l=FO(i,a,c),u=a.pendingStructs;if(u){for(const[d,h]of u.missing)if(h<Ot(a,d)){s=!0;break}if(l){for(const[d,h]of l.missing){const p=u.missing.get(d);(p==null||p>h)&&u.missing.set(d,h)}u.update=ac([u.update,l.update])}}else a.pendingStructs=l;const f=T0(r,i,a);if(a.pendingDs){const d=new is(Ei(a.pendingDs));Ee(d.restDecoder);const h=T0(d,i,a);f&&h?a.pendingDs=ac([f,h]):a.pendingDs=f||h}else a.pendingDs=f;if(s){const d=a.pendingStructs.update;a.pendingStructs=null,C0(i.doc,d)}},n,!1),C0=(e,t,n,r=is)=>{const i=Ei(t);jO(i,e,n,new r(i))},zO=(e,t,n)=>C0(e,t,n,I0),WO=(e,t,n=new Map)=>{df(e,t.store,n),rs(e,UO(t.store))},GO=(e,t=new Uint8Array([0]),n=new ki)=>{const r=L0(t);WO(n,e,r);const i=[n.toUint8Array()];if(e.store.pendingDs&&i.push(e.store.pendingDs),e.store.pendingStructs&&i.push(sN(e.store.pendingStructs.update,t)),i.length>1){if(n.constructor===lo)return rN(i.map((s,o)=>o===0?s:aN(s)));if(n.constructor===ki)return ac(i)}return i[0]},HO=(e,t)=>GO(e,t,new lo),VO=e=>{const t=new Map,n=Ee(e.restDecoder);for(let r=0;r<n;r++){const i=Ee(e.restDecoder),s=Ee(e.restDecoder);t.set(i,s)}return t},L0=e=>VO(new R0(Ei(e))),M0=(e,t)=>(ve(e.restEncoder,t.size),Gr(t.entries()).sort((n,r)=>r[0]-n[0]).forEach(([n,r])=>{ve(e.restEncoder,n),ve(e.restEncoder,r)}),e),KO=(e,t)=>M0(e,sc(t.store)),qO=(e,t=new N0)=>(e instanceof Map?M0(t,e):KO(t,e),t.toUint8Array()),XO=e=>qO(e,new O0);class JO{constructor(){this.l=[]}}const U0=()=>new JO,P0=(e,t)=>e.l.push(t),D0=(e,t)=>{const n=e.l,r=n.length;e.l=n.filter(i=>t!==i),r===e.l.length&&console.error("[yjs] Tried to remove event handler that doesn't exist.")},B0=(e,t,n)=>of(e.l,[t,n]);class ss{constructor(t,n){this.client=t,this.clock=n}}const ic=(e,t)=>e===t||e!==null&&t!==null&&e.client===t.client&&e.clock===t.clock,Oe=(e,t)=>new ss(e,t),ZO=e=>{for(const[t,n]of e.doc.share.entries())if(n===e)return t;throw Yn()},os=(e,t)=>t===void 0?!e.deleted:t.sv.has(e.id.client)&&(t.sv.get(e.id.client)||0)>e.id.clock&&!A0(t.ds,e.id),pf=(e,t)=>{const n=Wr(e.meta,pf,Qi),r=e.doc.store;n.has(t)||(t.sv.forEach((i,s)=>{i<Ot(r,s)&&qr(e,Oe(s,i))}),S0(e,t.ds,i=>{}),n.add(t))};class F0{constructor(){this.clients=new Map,this.pendingStructs=null,this.pendingDs=null}}const sc=e=>{const t=new Map;return e.clients.forEach((n,r)=>{const i=n[n.length-1];t.set(r,i.id.clock+i.length)}),t},Ot=(e,t)=>{const n=e.clients.get(t);if(n===void 0)return 0;const r=n[n.length-1];return r.id.clock+r.length},$0=(e,t)=>{let n=e.clients.get(t.id.client);if(n===void 0)n=[],e.clients.set(t.id.client,n);else{const r=n[n.length-1];if(r.id.clock+r.length!==t.id.clock)throw Yn()}n.push(t)},Un=(e,t)=>{let n=0,r=e.length-1,i=e[r],s=i.id.clock;if(s===t)return r;let o=Hr(t/(s+i.length-1)*r);for(;n<=r;){if(i=e[o],s=i.id.clock,s<=t){if(t<s+i.length)return o;n=o+1}else r=o-1;o=Hr((n+r)/2)}throw Yn()},mf=(e,t)=>{const n=e.clients.get(t.client);return n[Un(n,t.clock)]},gf=(e,t,n)=>{const r=Un(t,n),i=t[r];return i.id.clock<n&&i instanceof kt?(t.splice(r+1,0,gc(e,i,n-i.id.clock)),r+1):r},qr=(e,t)=>{const n=e.doc.store.clients.get(t.client);return n[gf(e,n,t.clock)]},j0=(e,t,n)=>{const r=t.clients.get(n.client),i=Un(r,n.clock),s=r[i];return n.clock!==s.id.clock+s.length-1&&s.constructor!==cn&&r.splice(i+1,0,gc(e,s,n.clock-s.id.clock+1)),s},YO=(e,t,n)=>{const r=e.clients.get(t.id.client);r[Un(r,t.id.clock)]=n},z0=(e,t,n,r,i)=>{if(r===0)return;const s=n+r;let o=gf(e,t,n),a;do a=t[o++],s<a.id.clock+a.length&&gf(e,t,s),i(a);while(o<t.length&&t[o].id.clock<s)};class QO{constructor(t,n,r){this.doc=t,this.deleteSet=new co,this.beforeState=sc(t.store),this.afterState=new Map,this.changed=new Map,this.changedParentTypes=new Map,this._mergeStructs=[],this.origin=n,this.meta=new Map,this.local=r,this.subdocsAdded=new Set,this.subdocsRemoved=new Set,this.subdocsLoaded=new Set,this._needFormattingCleanup=!1}}const W0=(e,t)=>t.deleteSet.clients.size===0&&!RI(t.afterState,(n,r)=>t.beforeState.get(r)!==n)?!1:(ff(t.deleteSet),$O(e,t),rs(e,t.deleteSet),!0),G0=(e,t,n)=>{const r=t._item;(r===null||r.id.clock<(e.beforeState.get(r.id.client)||0)&&!r.deleted)&&Wr(e.changed,t,Qi).add(n)},oc=(e,t)=>{let n=e[t],r=e[t-1],i=t;for(;i>0;n=r,r=e[--i-1]){if(r.deleted===n.deleted&&r.constructor===n.constructor&&r.mergeWith(n)){n instanceof kt&&n.parentSub!==null&&n.parent._map.get(n.parentSub)===n&&n.parent._map.set(n.parentSub,r);continue}break}const s=t-i;return s&&e.splice(t+1-s,s),s},eN=(e,t,n)=>{for(const[r,i]of e.clients.entries()){const s=t.clients.get(r);for(let o=i.length-1;o>=0;o--){const a=i[o],c=a.clock+a.len;for(let l=Un(s,a.clock),u=s[l];l<s.length&&u.id.clock<c;u=s[++l]){const f=s[l];if(a.clock+a.len<=f.id.clock)break;f instanceof kt&&f.deleted&&!f.keep&&n(f)&&f.gc(t,!1)}}}},tN=(e,t)=>{e.clients.forEach((n,r)=>{const i=t.clients.get(r);for(let s=n.length-1;s>=0;s--){const o=n[s],a=Zg(i.length-1,1+Un(i,o.clock+o.len-1));for(let c=a,l=i[c];c>0&&l.id.clock>=o.clock;l=i[c])c-=1+oc(i,c)}})},H0=(e,t)=>{if(t<e.length){const n=e[t],r=n.doc,i=r.store,s=n.deleteSet,o=n._mergeStructs;try{ff(s),n.afterState=sc(n.doc.store),r.emit("beforeObserverCalls",[n,r]);const a=[];n.changed.forEach((c,l)=>a.push(()=>{(l._item===null||!l._item.deleted)&&l._callObserver(n,c)})),a.push(()=>{n.changedParentTypes.forEach((c,l)=>{l._dEH.l.length>0&&(l._item===null||!l._item.deleted)&&(c=c.filter(u=>u.target._item===null||!u.target._item.deleted),c.forEach(u=>{u.currentTarget=l,u._path=null}),c.sort((u,f)=>u.path.length-f.path.length),B0(l._dEH,c,n))})}),a.push(()=>r.emit("afterTransaction",[n,r])),of(a,[]),n._needFormattingCleanup&&vN(n)}finally{r.gc&&eN(s,i,r.gcFilter),tN(s,i),n.afterState.forEach((u,f)=>{const d=n.beforeState.get(f)||0;if(d!==u){const h=i.clients.get(f),p=wi(Un(h,d),1);for(let m=h.length-1;m>=p;)m-=1+oc(h,m)}});for(let u=o.length-1;u>=0;u--){const{client:f,clock:d}=o[u].id,h=i.clients.get(f),p=Un(h,d);p+1<h.length&&oc(h,p+1)>1||p>0&&oc(h,p)}if(!n.local&&n.afterState.get(r.clientID)!==n.beforeState.get(r.clientID)&&(IO(cf,_0,"[yjs] ",b0,w0,"Changed the client-id because another client seems to be using it."),r.clientID=x0()),r.emit("afterTransactionCleanup",[n,r]),r._observers.has("update")){const u=new lo;W0(u,n)&&r.emit("update",[u.toUint8Array(),n.origin,r,n])}if(r._observers.has("updateV2")){const u=new ki;W0(u,n)&&r.emit("updateV2",[u.toUint8Array(),n.origin,r,n])}const{subdocsAdded:a,subdocsLoaded:c,subdocsRemoved:l}=n;(a.size>0||l.size>0||c.size>0)&&(a.forEach(u=>{u.clientID=r.clientID,u.collectionid==null&&(u.collectionid=r.collectionid),r.subdocs.add(u)}),l.forEach(u=>r.subdocs.delete(u)),r.emit("subdocs",[{loaded:c,added:a,removed:l},r,n]),l.forEach(u=>u.destroy())),e.length<=t+1?(r._transactionCleanups=[],r.emit("afterAllTransactions",[r,e])):H0(e,t+1)}}},Xe=(e,t,n=null,r=!0)=>{const i=e._transactionCleanups;let s=!1,o=null;e._transaction===null&&(s=!0,e._transaction=new QO(e,n,r),i.push(e._transaction),i.length===1&&e.emit("beforeAllTransactions",[e]),e.emit("beforeTransaction",[e._transaction,e]));try{o=t(e._transaction)}finally{if(s){const a=e._transaction===i[0];e._transaction=null,a&&H0(i,0)}}return o};function*nN(e){const t=Ee(e.restDecoder);for(let n=0;n<t;n++){const r=Ee(e.restDecoder),i=e.readClient();let s=Ee(e.restDecoder);for(let o=0;o<r;o++){const a=e.readInfo();if(a===10){const c=Ee(e.restDecoder);yield new Sn(Oe(i,s),c),s+=c}else if(Za&a){const c=(a&(kr|an))===0,l=new kt(Oe(i,s),null,(a&an)===an?e.readLeftID():null,null,(a&kr)===kr?e.readRightID():null,c?e.readParentInfo()?e.readString():e.readLeftID():null,c&&(a&to)===to?e.readString():null,dy(e,a));yield l,s+=l.length}else{const c=e.readLen();yield new cn(Oe(i,s),c),s+=c}}}}class yf{constructor(t,n){this.gen=nN(t),this.curr=null,this.done=!1,this.filterSkips=n,this.next()}next(){do this.curr=this.gen.next().value||null;while(this.filterSkips&&this.curr!==null&&this.curr.constructor===Sn);return this.curr}}class _f{constructor(t){this.currClient=0,this.startClock=0,this.written=0,this.encoder=t,this.clientStructs=[]}}const rN=e=>ac(e,I0,lo),iN=(e,t)=>{if(e.constructor===cn){const{client:n,clock:r}=e.id;return new cn(Oe(n,r+t),e.length-t)}else if(e.constructor===Sn){const{client:n,clock:r}=e.id;return new Sn(Oe(n,r+t),e.length-t)}else{const n=e,{client:r,clock:i}=n.id;return new kt(Oe(r,i+t),null,Oe(r,i+t-1),null,n.rightOrigin,n.parent,n.parentSub,n.content.splice(t))}},ac=(e,t=is,n=ki)=>{if(e.length===1)return e[0];const r=e.map(u=>new t(Ei(u)));let i=r.map(u=>new yf(u,!0)),s=null;const o=new n,a=new _f(o);for(;i=i.filter(d=>d.curr!==null),i.sort((d,h)=>{if(d.curr.id.client===h.curr.id.client){const p=d.curr.id.clock-h.curr.id.clock;return p===0?d.curr.constructor===h.curr.constructor?0:d.curr.constructor===Sn?1:-1:p}else return h.curr.id.client-d.curr.id.client}),i.length!==0;){const u=i[0],f=u.curr.id.client;if(s!==null){let d=u.curr,h=!1;for(;d!==null&&d.id.clock+d.length<=s.struct.id.clock+s.struct.length&&d.id.client>=s.struct.id.client;)d=u.next(),h=!0;if(d===null||d.id.client!==f||h&&d.id.clock>s.struct.id.clock+s.struct.length)continue;if(f!==s.struct.id.client)Xr(a,s.struct,s.offset),s={struct:d,offset:0},u.next();else if(s.struct.id.clock+s.struct.length<d.id.clock)if(s.struct.constructor===Sn)s.struct.length=d.id.clock+d.length-s.struct.id.clock;else{Xr(a,s.struct,s.offset);const p=d.id.clock-s.struct.id.clock-s.struct.length;s={struct:new Sn(Oe(f,s.struct.id.clock+s.struct.length),p),offset:0}}else{const p=s.struct.id.clock+s.struct.length-d.id.clock;p>0&&(s.struct.constructor===Sn?s.struct.length-=p:d=iN(d,p)),s.struct.mergeWith(d)||(Xr(a,s.struct,s.offset),s={struct:d,offset:0},u.next())}}else s={struct:u.curr,offset:0},u.next();for(let d=u.curr;d!==null&&d.id.client===f&&d.id.clock===s.struct.id.clock+s.struct.length&&d.constructor!==Sn;d=u.next())Xr(a,s.struct,s.offset),s={struct:d,offset:0}}s!==null&&(Xr(a,s.struct,s.offset),s=null),bf(a);const c=r.map(u=>hf(u)),l=LO(c);return rs(o,l),o.toUint8Array()},sN=(e,t,n=is,r=ki)=>{const i=L0(t),s=new r,o=new _f(s),a=new n(Ei(e)),c=new yf(a,!1);for(;c.curr;){const u=c.curr,f=u.id.client,d=i.get(f)||0;if(c.curr.constructor===Sn){c.next();continue}if(u.id.clock+u.length>d)for(Xr(o,u,wi(d-u.id.clock,0)),c.next();c.curr&&c.curr.id.client===f;)Xr(o,c.curr,0),c.next();else for(;c.curr&&c.curr.id.client===f&&c.curr.id.clock+c.curr.length<=d;)c.next()}bf(o);const l=hf(a);return rs(s,l),s.toUint8Array()},V0=e=>{e.written>0&&(e.clientStructs.push({written:e.written,restEncoder:Mn(e.encoder.restEncoder)}),e.encoder.restEncoder=Vr(),e.written=0)},Xr=(e,t,n)=>{e.written>0&&e.currClient!==t.id.client&&V0(e),e.written===0&&(e.currClient=t.id.client,e.encoder.writeClient(t.id.client),ve(e.encoder.restEncoder,t.id.clock+n)),t.write(e.encoder,n),e.written++},bf=e=>{V0(e);const t=e.encoder.restEncoder;ve(t,e.clientStructs.length);for(let n=0;n<e.clientStructs.length;n++){const r=e.clientStructs[n];ve(t,r.written),Ya(t,r.restEncoder)}},oN=(e,t,n,r)=>{const i=new n(Ei(e)),s=new yf(i,!1),o=new r,a=new _f(o);for(let l=s.curr;l!==null;l=s.next())Xr(a,t(l),0);bf(a);const c=hf(i);return rs(o,c),o.toUint8Array()},aN=e=>oN(e,pO,is,lo),K0="You must not compute changes after the event-handler fired.";class cc{constructor(t,n){this.target=t,this.currentTarget=t,this.transaction=n,this._changes=null,this._keys=null,this._delta=null,this._path=null}get path(){return this._path||(this._path=cN(this.currentTarget,this.target))}deletes(t){return A0(this.transaction.deleteSet,t.id)}get keys(){if(this._keys===null){if(this.transaction.doc._transactionCleanups.length===0)throw Kr(K0);const t=new Map,n=this.target;this.transaction.changed.get(n).forEach(i=>{if(i!==null){const s=n._map.get(i);let o,a;if(this.adds(s)){let c=s.left;for(;c!==null&&this.adds(c);)c=c.left;if(this.deletes(s))if(c!==null&&this.deletes(c))o="delete",a=Ku(c.content.getContent());else return;else c!==null&&this.deletes(c)?(o="update",a=Ku(c.content.getContent())):(o="add",a=void 0)}else if(this.deletes(s))o="delete",a=Ku(s.content.getContent());else return;t.set(i,{action:o,oldValue:a})}}),this._keys=t}return this._keys}get delta(){return this.changes.delta}adds(t){return t.id.clock>=(this.transaction.beforeState.get(t.id.client)||0)}get changes(){let t=this._changes;if(t===null){if(this.transaction.doc._transactionCleanups.length===0)throw Kr(K0);const n=this.target,r=Qi(),i=Qi(),s=[];if(t={added:r,deleted:i,delta:s,keys:this.keys},this.transaction.changed.get(n).has(null)){let a=null;const c=()=>{a&&s.push(a)};for(let l=n._start;l!==null;l=l.right)l.deleted?this.deletes(l)&&!this.adds(l)&&((a===null||a.delete===void 0)&&(c(),a={delete:0}),a.delete+=l.length,i.add(l)):this.adds(l)?((a===null||a.insert===void 0)&&(c(),a={insert:[]}),a.insert=a.insert.concat(l.content.getContent()),r.add(l)):((a===null||a.retain===void 0)&&(c(),a={retain:0}),a.retain+=l.length);a!==null&&a.retain===void 0&&c()}this._changes=t}return t}}const cN=(e,t)=>{const n=[];for(;t._item!==null&&t!==e;){if(t._item.parentSub!==null)n.unshift(t._item.parentSub);else{let r=0,i=t._item.parent._start;for(;i!==t._item&&i!==null;)!i.deleted&&i.countable&&(r+=i.length),i=i.right;n.unshift(r)}t=t._item.parent}return n},Dt=()=>{OO("Invalid access: Add Yjs type to a document before reading data.")},q0=80;let wf=0;class lN{constructor(t,n){t.marker=!0,this.p=t,this.index=n,this.timestamp=wf++}}const uN=e=>{e.timestamp=wf++},X0=(e,t,n)=>{e.p.marker=!1,e.p=t,t.marker=!0,e.index=n,e.timestamp=wf++},fN=(e,t,n)=>{if(e.length>=q0){const r=e.reduce((i,s)=>i.timestamp<s.timestamp?i:s);return X0(r,t,n),r}else{const r=new lN(t,n);return e.push(r),r}},lc=(e,t)=>{if(e._start===null||t===0||e._searchMarker===null)return null;const n=e._searchMarker.length===0?null:e._searchMarker.reduce((s,o)=>Ja(t-s.index)<Ja(t-o.index)?s:o);let r=e._start,i=0;for(n!==null&&(r=n.p,i=n.index,uN(n));r.right!==null&&i<t;){if(!r.deleted&&r.countable){if(t<i+r.length)break;i+=r.length}r=r.right}for(;r.left!==null&&i>t;)r=r.left,!r.deleted&&r.countable&&(i-=r.length);for(;r.left!==null&&r.left.id.client===r.id.client&&r.left.id.clock+r.left.length===r.id.clock;)r=r.left,!r.deleted&&r.countable&&(i-=r.length);return n!==null&&Ja(n.index-i)<r.parent.length/q0?(X0(n,r,i),n):fN(e._searchMarker,r,i)},uo=(e,t,n)=>{for(let r=e.length-1;r>=0;r--){const i=e[r];if(n>0){let s=i.p;for(s.marker=!1;s&&(s.deleted||!s.countable);)s=s.left,s&&!s.deleted&&s.countable&&(i.index-=s.length);if(s===null||s.marker===!0){e.splice(r,1);continue}i.p=s,s.marker=!0}(t<i.index||n>0&&t===i.index)&&(i.index=wi(t,i.index+n))}},uc=(e,t,n)=>{const r=e,i=t.changedParentTypes;for(;Wr(i,e,()=>[]).push(n),e._item!==null;)e=e._item.parent;B0(r._eH,n,t)};class ot{constructor(){this._item=null,this._map=new Map,this._start=null,this.doc=null,this._length=0,this._eH=U0(),this._dEH=U0(),this._searchMarker=null}get parent(){return this._item?this._item.parent:null}_integrate(t,n){this.doc=t,this._item=n}_copy(){throw Zn()}clone(){throw Zn()}_write(t){}get _first(){let t=this._start;for(;t!==null&&t.deleted;)t=t.right;return t}_callObserver(t,n){!t.local&&this._searchMarker&&(this._searchMarker.length=0)}observe(t){P0(this._eH,t)}observeDeep(t){P0(this._dEH,t)}unobserve(t){D0(this._eH,t)}unobserveDeep(t){D0(this._dEH,t)}toJSON(){}}const J0=(e,t,n)=>{e.doc??Dt(),t<0&&(t=e._length+t),n<0&&(n=e._length+n);let r=n-t;const i=[];let s=e._start;for(;s!==null&&r>0;){if(s.countable&&!s.deleted){const o=s.content.getContent();if(o.length<=t)t-=o.length;else{for(let a=t;a<o.length&&r>0;a++)i.push(o[a]),r--;t=0}}s=s.right}return i},Z0=e=>{e.doc??Dt();const t=[];let n=e._start;for(;n!==null;){if(n.countable&&!n.deleted){const r=n.content.getContent();for(let i=0;i<r.length;i++)t.push(r[i])}n=n.right}return t},fo=(e,t)=>{let n=0,r=e._start;for(e.doc??Dt();r!==null;){if(r.countable&&!r.deleted){const i=r.content.getContent();for(let s=0;s<i.length;s++)t(i[s],n++,e)}r=r.right}},Y0=(e,t)=>{const n=[];return fo(e,(r,i)=>{n.push(t(r,i,e))}),n},hN=e=>{let t=e._start,n=null,r=0;return{[Symbol.iterator](){return this},next:()=>{if(n===null){for(;t!==null&&t.deleted;)t=t.right;if(t===null)return{done:!0,value:void 0};n=t.content.getContent(),r=0,t=t.right}const i=n[r++];return n.length<=r&&(n=null),{done:!1,value:i}}}},Q0=(e,t)=>{e.doc??Dt();const n=lc(e,t);let r=e._start;for(n!==null&&(r=n.p,t-=n.index);r!==null;r=r.right)if(!r.deleted&&r.countable){if(t<r.length)return r.content.getContent()[t];t-=r.length}},fc=(e,t,n,r)=>{let i=n;const s=e.doc,o=s.clientID,a=s.store,c=n===null?t._start:n.right;let l=[];const u=()=>{l.length>0&&(i=new kt(Oe(o,Ot(a,o)),i,i&&i.lastId,c,c&&c.id,t,null,new Ti(l)),i.integrate(e,0),l=[])};r.forEach(f=>{if(f===null)l.push(f);else switch(f.constructor){case Number:case Object:case Boolean:case Array:case String:l.push(f);break;default:switch(u(),f.constructor){case Uint8Array:case ArrayBuffer:i=new kt(Oe(o,Ot(a,o)),i,i&&i.lastId,c,c&&c.id,t,null,new ho(new Uint8Array(f))),i.integrate(e,0);break;case Tr:i=new kt(Oe(o,Ot(a,o)),i,i&&i.lastId,c,c&&c.id,t,null,new mo(f)),i.integrate(e,0);break;default:if(f instanceof ot)i=new kt(Oe(o,Ot(a,o)),i,i&&i.lastId,c,c&&c.id,t,null,new Rr(f)),i.integrate(e,0);else throw new Error("Unexpected content type in insert operation")}}}),u()},ey=()=>Kr("Length exceeded!"),ty=(e,t,n,r)=>{if(n>t._length)throw ey();if(n===0)return t._searchMarker&&uo(t._searchMarker,n,r.length),fc(e,t,null,r);const i=n,s=lc(t,n);let o=t._start;for(s!==null&&(o=s.p,n-=s.index,n===0&&(o=o.prev,n+=o&&o.countable&&!o.deleted?o.length:0));o!==null;o=o.right)if(!o.deleted&&o.countable){if(n<=o.length){n<o.length&&qr(e,Oe(o.id.client,o.id.clock+n));break}n-=o.length}return t._searchMarker&&uo(t._searchMarker,i,r.length),fc(e,t,o,r)},dN=(e,t,n)=>{let i=(t._searchMarker||[]).reduce((s,o)=>o.index>s.index?o:s,{index:0,p:t._start}).p;if(i)for(;i.right;)i=i.right;return fc(e,t,i,n)},ny=(e,t,n,r)=>{if(r===0)return;const i=n,s=r,o=lc(t,n);let a=t._start;for(o!==null&&(a=o.p,n-=o.index);a!==null&&n>0;a=a.right)!a.deleted&&a.countable&&(n<a.length&&qr(e,Oe(a.id.client,a.id.clock+n)),n-=a.length);for(;r>0&&a!==null;)a.deleted||(r<a.length&&qr(e,Oe(a.id.client,a.id.clock+r)),a.delete(e),r-=a.length),a=a.right;if(r>0)throw ey();t._searchMarker&&uo(t._searchMarker,i,-s+r)},hc=(e,t,n)=>{const r=t._map.get(n);r!==void 0&&r.delete(e)},vf=(e,t,n,r)=>{const i=t._map.get(n)||null,s=e.doc,o=s.clientID;let a;if(r==null)a=new Ti([r]);else switch(r.constructor){case Number:case Object:case Boolean:case Array:case String:a=new Ti([r]);break;case Uint8Array:a=new ho(r);break;case Tr:a=new mo(r);break;default:if(r instanceof ot)a=new Rr(r);else throw new Error("Unexpected content type")}new kt(Oe(o,Ot(s.store,o)),i,i&&i.lastId,null,null,t,n,a).integrate(e,0)},Ef=(e,t)=>{e.doc??Dt();const n=e._map.get(t);return n!==void 0&&!n.deleted?n.content.getContent()[n.length-1]:void 0},ry=e=>{const t={};return e.doc??Dt(),e._map.forEach((n,r)=>{n.deleted||(t[r]=n.content.getContent()[n.length-1])}),t},iy=(e,t)=>{e.doc??Dt();const n=e._map.get(t);return n!==void 0&&!n.deleted},pN=(e,t)=>{const n={};return e._map.forEach((r,i)=>{let s=r;for(;s!==null&&(!t.sv.has(s.id.client)||s.id.clock>=(t.sv.get(s.id.client)||0));)s=s.left;s!==null&&os(s,t)&&(n[i]=s.content.getContent()[s.length-1])}),n},dc=e=>(e.doc??Dt(),NO(e._map.entries(),t=>!t[1].deleted));class mN extends cc{}class er extends ot{constructor(){super(),this._prelimContent=[],this._searchMarker=[]}static from(t){const n=new er;return n.push(t),n}_integrate(t,n){super._integrate(t,n),this.insert(0,this._prelimContent),this._prelimContent=null}_copy(){return new er}clone(){const t=new er;return t.insert(0,this.toArray().map(n=>n instanceof ot?n.clone():n)),t}get length(){return this.doc??Dt(),this._length}_callObserver(t,n){super._callObserver(t,n),uc(this,t,new mN(this,t))}insert(t,n){this.doc!==null?Xe(this.doc,r=>{ty(r,this,t,n)}):this._prelimContent.splice(t,0,...n)}push(t){this.doc!==null?Xe(this.doc,n=>{dN(n,this,t)}):this._prelimContent.push(...t)}unshift(t){this.insert(0,t)}delete(t,n=1){this.doc!==null?Xe(this.doc,r=>{ny(r,this,t,n)}):this._prelimContent.splice(t,n)}get(t){return Q0(this,t)}toArray(){return Z0(this)}slice(t=0,n=this.length){return J0(this,t,n)}toJSON(){return this.map(t=>t instanceof ot?t.toJSON():t)}map(t){return Y0(this,t)}forEach(t){fo(this,t)}[Symbol.iterator](){return hN(this)}_write(t){t.writeTypeRef($N)}}const gN=e=>new er;class yN extends cc{constructor(t,n,r){super(t,n),this.keysChanged=r}}class tr extends ot{constructor(t){super(),this._prelimContent=null,t===void 0?this._prelimContent=new Map:this._prelimContent=new Map(t)}_integrate(t,n){super._integrate(t,n),this._prelimContent.forEach((r,i)=>{this.set(i,r)}),this._prelimContent=null}_copy(){return new tr}clone(){const t=new tr;return this.forEach((n,r)=>{t.set(r,n instanceof ot?n.clone():n)}),t}_callObserver(t,n){uc(this,t,new yN(this,t,n))}toJSON(){this.doc??Dt();const t={};return this._map.forEach((n,r)=>{if(!n.deleted){const i=n.content.getContent()[n.length-1];t[r]=i instanceof ot?i.toJSON():i}}),t}get size(){return[...dc(this)].length}keys(){return lf(dc(this),t=>t[0])}values(){return lf(dc(this),t=>t[1].content.getContent()[t[1].length-1])}entries(){return lf(dc(this),t=>[t[0],t[1].content.getContent()[t[1].length-1]])}forEach(t){this.doc??Dt(),this._map.forEach((n,r)=>{n.deleted||t(n.content.getContent()[n.length-1],r,this)})}[Symbol.iterator](){return this.entries()}delete(t){this.doc!==null?Xe(this.doc,n=>{hc(n,this,t)}):this._prelimContent.delete(t)}set(t,n){return this.doc!==null?Xe(this.doc,r=>{vf(r,this,t,n)}):this._prelimContent.set(t,n),n}get(t){return Ef(this,t)}has(t){return iy(this,t)}clear(){this.doc!==null?Xe(this.doc,t=>{this.forEach(function(n,r,i){hc(t,i,r)})}):this._prelimContent.clear()}_write(t){t.writeTypeRef(jN)}}const _N=e=>new tr,Jr=(e,t)=>e===t||typeof e=="object"&&typeof t=="object"&&e&&t&&hO(e,t);class kf{constructor(t,n,r,i){this.left=t,this.right=n,this.index=r,this.currentAttributes=i}forward(){switch(this.right===null&&Yn(),this.right.content.constructor){case Et:this.right.deleted||as(this.currentAttributes,this.right.content);break;default:this.right.deleted||(this.index+=this.right.length);break}this.left=this.right,this.right=this.right.right}}const sy=(e,t,n)=>{for(;t.right!==null&&n>0;){switch(t.right.content.constructor){case Et:t.right.deleted||as(t.currentAttributes,t.right.content);break;default:t.right.deleted||(n<t.right.length&&qr(e,Oe(t.right.id.client,t.right.id.clock+n)),t.index+=t.right.length,n-=t.right.length);break}t.left=t.right,t.right=t.right.right}return t},pc=(e,t,n,r)=>{const i=new Map,s=r?lc(t,n):null;if(s){const o=new kf(s.p.left,s.p,s.index,i);return sy(e,o,n-s.index)}else{const o=new kf(null,t._start,0,i);return sy(e,o,n)}},oy=(e,t,n,r)=>{for(;n.right!==null&&(n.right.deleted===!0||n.right.content.constructor===Et&&Jr(r.get(n.right.content.key),n.right.content.value));)n.right.deleted||r.delete(n.right.content.key),n.forward();const i=e.doc,s=i.clientID;r.forEach((o,a)=>{const c=n.left,l=n.right,u=new kt(Oe(s,Ot(i.store,s)),c,c&&c.lastId,l,l&&l.id,t,null,new Et(a,o));u.integrate(e,0),n.right=u,n.forward()})},as=(e,t)=>{const{key:n,value:r}=t;r===null?e.delete(n):e.set(n,r)},ay=(e,t)=>{for(;e.right!==null;){if(!(e.right.deleted||e.right.content.constructor===Et&&Jr(t[e.right.content.key]??null,e.right.content.value)))break;e.forward()}},cy=(e,t,n,r)=>{const i=e.doc,s=i.clientID,o=new Map;for(const a in r){const c=r[a],l=n.currentAttributes.get(a)??null;if(!Jr(l,c)){o.set(a,l);const{left:u,right:f}=n;n.right=new kt(Oe(s,Ot(i.store,s)),u,u&&u.lastId,f,f&&f.id,t,null,new Et(a,c)),n.right.integrate(e,0),n.forward()}}return o},Sf=(e,t,n,r,i)=>{n.currentAttributes.forEach((d,h)=>{i[h]===void 0&&(i[h]=null)});const s=e.doc,o=s.clientID;ay(n,i);const a=cy(e,t,n,i),c=r.constructor===String?new rr(r):r instanceof ot?new Rr(r):new Ai(r);let{left:l,right:u,index:f}=n;t._searchMarker&&uo(t._searchMarker,n.index,c.getLength()),u=new kt(Oe(o,Ot(s.store,o)),l,l&&l.lastId,u,u&&u.id,t,null,c),u.integrate(e,0),n.right=u,n.index=f,n.forward(),oy(e,t,n,a)},ly=(e,t,n,r,i)=>{const s=e.doc,o=s.clientID;ay(n,i);const a=cy(e,t,n,i);e:for(;n.right!==null&&(r>0||a.size>0&&(n.right.deleted||n.right.content.constructor===Et));){if(!n.right.deleted)switch(n.right.content.constructor){case Et:{const{key:c,value:l}=n.right.content,u=i[c];if(u!==void 0){if(Jr(u,l))a.delete(c);else{if(r===0)break e;a.set(c,l)}n.right.delete(e)}else n.currentAttributes.set(c,l);break}default:r<n.right.length&&qr(e,Oe(n.right.id.client,n.right.id.clock+r)),r-=n.right.length;break}n.forward()}if(r>0){let c="";for(;r>0;r--)c+=`
`;n.right=new kt(Oe(o,Ot(s.store,o)),n.left,n.left&&n.left.lastId,n.right,n.right&&n.right.id,t,null,new rr(c)),n.right.integrate(e,0),n.forward()}oy(e,t,n,a)},uy=(e,t,n,r,i)=>{let s=t;const o=Ln();for(;s&&(!s.countable||s.deleted);){if(!s.deleted&&s.content.constructor===Et){const l=s.content;o.set(l.key,l)}s=s.right}let a=0,c=!1;for(;t!==s;){if(n===t&&(c=!0),!t.deleted){const l=t.content;switch(l.constructor){case Et:{const{key:u,value:f}=l,d=r.get(u)??null;(o.get(u)!==l||d===f)&&(t.delete(e),a++,!c&&(i.get(u)??null)===f&&d!==f&&(d===null?i.delete(u):i.set(u,d))),!c&&!t.deleted&&as(i,l);break}}}t=t.right}return a},bN=(e,t)=>{for(;t&&t.right&&(t.right.deleted||!t.right.countable);)t=t.right;const n=new Set;for(;t&&(t.deleted||!t.countable);){if(!t.deleted&&t.content.constructor===Et){const r=t.content.key;n.has(r)?t.delete(e):n.add(r)}t=t.left}},wN=e=>{let t=0;return Xe(e.doc,n=>{let r=e._start,i=e._start,s=Ln();const o=Vu(s);for(;i;){if(i.deleted===!1)switch(i.content.constructor){case Et:as(o,i.content);break;default:t+=uy(n,r,i,s,o),s=Vu(o),r=i;break}i=i.right}}),t},vN=e=>{const t=new Set,n=e.doc;for(const[r,i]of e.afterState.entries()){const s=e.beforeState.get(r)||0;i!==s&&z0(e,n.store.clients.get(r),s,i,o=>{!o.deleted&&o.content.constructor===Et&&o.constructor!==cn&&t.add(o.parent)})}Xe(n,r=>{S0(e,e.deleteSet,i=>{if(i instanceof cn||!i.parent._hasFormatting||t.has(i.parent))return;const s=i.parent;i.content.constructor===Et?t.add(s):bN(r,i)});for(const i of t)wN(i)})},fy=(e,t,n)=>{const r=n,i=Vu(t.currentAttributes),s=t.right;for(;n>0&&t.right!==null;){if(t.right.deleted===!1)switch(t.right.content.constructor){case Rr:case Ai:case rr:n<t.right.length&&qr(e,Oe(t.right.id.client,t.right.id.clock+n)),n-=t.right.length,t.right.delete(e);break}t.forward()}s&&uy(e,s,t.right,i,t.currentAttributes);const o=(t.left||t.right).parent;return o._searchMarker&&uo(o._searchMarker,t.index,-r+n),t};class EN extends cc{constructor(t,n,r){super(t,n),this.childListChanged=!1,this.keysChanged=new Set,r.forEach(i=>{i===null?this.childListChanged=!0:this.keysChanged.add(i)})}get changes(){if(this._changes===null){const t={keys:this.keys,delta:this.delta,added:new Set,deleted:new Set};this._changes=t}return this._changes}get delta(){if(this._delta===null){const t=this.target.doc,n=[];Xe(t,r=>{const i=new Map,s=new Map;let o=this.target._start,a=null;const c={};let l="",u=0,f=0;const d=()=>{if(a!==null){let h=null;switch(a){case"delete":f>0&&(h={delete:f}),f=0;break;case"insert":(typeof l=="object"||l.length>0)&&(h={insert:l},i.size>0&&(h.attributes={},i.forEach((p,m)=>{p!==null&&(h.attributes[m]=p)}))),l="";break;case"retain":u>0&&(h={retain:u},lO(c)||(h.attributes=oO({},c))),u=0;break}h&&n.push(h),a=null}};for(;o!==null;){switch(o.content.constructor){case Rr:case Ai:this.adds(o)?this.deletes(o)||(d(),a="insert",l=o.content.getContent()[0],d()):this.deletes(o)?(a!=="delete"&&(d(),a="delete"),f+=1):o.deleted||(a!=="retain"&&(d(),a="retain"),u+=1);break;case rr:this.adds(o)?this.deletes(o)||(a!=="insert"&&(d(),a="insert"),l+=o.content.str):this.deletes(o)?(a!=="delete"&&(d(),a="delete"),f+=o.length):o.deleted||(a!=="retain"&&(d(),a="retain"),u+=o.length);break;case Et:{const{key:h,value:p}=o.content;if(this.adds(o)){if(!this.deletes(o)){const m=i.get(h)??null;Jr(m,p)?p!==null&&o.delete(r):(a==="retain"&&d(),Jr(p,s.get(h)??null)?delete c[h]:c[h]=p)}}else if(this.deletes(o)){s.set(h,p);const m=i.get(h)??null;Jr(m,p)||(a==="retain"&&d(),c[h]=m)}else if(!o.deleted){s.set(h,p);const m=c[h];m!==void 0&&(Jr(m,p)?m!==null&&o.delete(r):(a==="retain"&&d(),p===null?delete c[h]:c[h]=p))}o.deleted||(a==="insert"&&d(),as(i,o.content));break}}o=o.right}for(d();n.length>0;){const h=n[n.length-1];if(h.retain!==void 0&&h.attributes===void 0)n.pop();else break}}),this._delta=n}return this._delta}}class Pn extends ot{constructor(t){super(),this._pending=t!==void 0?[()=>this.insert(0,t)]:[],this._searchMarker=[],this._hasFormatting=!1}get length(){return this.doc??Dt(),this._length}_integrate(t,n){super._integrate(t,n);try{this._pending.forEach(r=>r())}catch(r){console.error(r)}this._pending=null}_copy(){return new Pn}clone(){const t=new Pn;return t.applyDelta(this.toDelta()),t}_callObserver(t,n){super._callObserver(t,n);const r=new EN(this,t,n);uc(this,t,r),!t.local&&this._hasFormatting&&(t._needFormattingCleanup=!0)}toString(){this.doc??Dt();let t="",n=this._start;for(;n!==null;)!n.deleted&&n.countable&&n.content.constructor===rr&&(t+=n.content.str),n=n.right;return t}toJSON(){return this.toString()}applyDelta(t,{sanitize:n=!0}={}){this.doc!==null?Xe(this.doc,r=>{const i=new kf(null,this._start,0,new Map);for(let s=0;s<t.length;s++){const o=t[s];if(o.insert!==void 0){const a=!n&&typeof o.insert=="string"&&s===t.length-1&&i.right===null&&o.insert.slice(-1)===`
`?o.insert.slice(0,-1):o.insert;(typeof a!="string"||a.length>0)&&Sf(r,this,i,a,o.attributes||{})}else o.retain!==void 0?ly(r,this,i,o.retain,o.attributes||{}):o.delete!==void 0&&fy(r,i,o.delete)}}):this._pending.push(()=>this.applyDelta(t))}toDelta(t,n,r){this.doc??Dt();const i=[],s=new Map,o=this.doc;let a="",c=this._start;function l(){if(a.length>0){const f={};let d=!1;s.forEach((p,m)=>{d=!0,f[m]=p});const h={insert:a};d&&(h.attributes=f),i.push(h),a=""}}const u=()=>{for(;c!==null;){if(os(c,t)||n!==void 0&&os(c,n))switch(c.content.constructor){case rr:{const f=s.get("ychange");t!==void 0&&!os(c,t)?(f===void 0||f.user!==c.id.client||f.type!=="removed")&&(l(),s.set("ychange",r?r("removed",c.id):{type:"removed"})):n!==void 0&&!os(c,n)?(f===void 0||f.user!==c.id.client||f.type!=="added")&&(l(),s.set("ychange",r?r("added",c.id):{type:"added"})):f!==void 0&&(l(),s.delete("ychange")),a+=c.content.str;break}case Rr:case Ai:{l();const f={insert:c.content.getContent()[0]};if(s.size>0){const d={};f.attributes=d,s.forEach((h,p)=>{d[p]=h})}i.push(f);break}case Et:os(c,t)&&(l(),as(s,c.content));break}c=c.right}l()};return t||n?Xe(o,f=>{t&&pf(f,t),n&&pf(f,n),u()},"cleanup"):u(),i}insert(t,n,r){if(n.length<=0)return;const i=this.doc;i!==null?Xe(i,s=>{const o=pc(s,this,t,!r);r||(r={},o.currentAttributes.forEach((a,c)=>{r[c]=a})),Sf(s,this,o,n,r)}):this._pending.push(()=>this.insert(t,n,r))}insertEmbed(t,n,r){const i=this.doc;i!==null?Xe(i,s=>{const o=pc(s,this,t,!r);Sf(s,this,o,n,r||{})}):this._pending.push(()=>this.insertEmbed(t,n,r||{}))}delete(t,n){if(n===0)return;const r=this.doc;r!==null?Xe(r,i=>{fy(i,pc(i,this,t,!0),n)}):this._pending.push(()=>this.delete(t,n))}format(t,n,r){if(n===0)return;const i=this.doc;i!==null?Xe(i,s=>{const o=pc(s,this,t,!1);o.right!==null&&ly(s,this,o,n,r)}):this._pending.push(()=>this.format(t,n,r))}removeAttribute(t){this.doc!==null?Xe(this.doc,n=>{hc(n,this,t)}):this._pending.push(()=>this.removeAttribute(t))}setAttribute(t,n){this.doc!==null?Xe(this.doc,r=>{vf(r,this,t,n)}):this._pending.push(()=>this.setAttribute(t,n))}getAttribute(t){return Ef(this,t)}getAttributes(){return ry(this)}_write(t){t.writeTypeRef(zN)}}const kN=e=>new Pn;class Af{constructor(t,n=()=>!0){this._filter=n,this._root=t,this._currentNode=t._start,this._firstCall=!0,t.doc??Dt()}[Symbol.iterator](){return this}next(){let t=this._currentNode,n=t&&t.content&&t.content.type;if(t!==null&&(!this._firstCall||t.deleted||!this._filter(n)))do if(n=t.content.type,!t.deleted&&(n.constructor===xr||n.constructor===nr)&&n._start!==null)t=n._start;else for(;t!==null;)if(t.right!==null){t=t.right;break}else t.parent===this._root?t=null:t=t.parent._item;while(t!==null&&(t.deleted||!this._filter(t.content.type)));return this._firstCall=!1,t===null?{value:void 0,done:!0}:(this._currentNode=t,{value:t.content.type,done:!1})}}class nr extends ot{constructor(){super(),this._prelimContent=[]}get firstChild(){const t=this._first;return t?t.content.getContent()[0]:null}_integrate(t,n){super._integrate(t,n),this.insert(0,this._prelimContent),this._prelimContent=null}_copy(){return new nr}clone(){const t=new nr;return t.insert(0,this.toArray().map(n=>n instanceof ot?n.clone():n)),t}get length(){return this.doc??Dt(),this._prelimContent===null?this._length:this._prelimContent.length}createTreeWalker(t){return new Af(this,t)}querySelector(t){t=t.toUpperCase();const r=new Af(this,i=>i.nodeName&&i.nodeName.toUpperCase()===t).next();return r.done?null:r.value}querySelectorAll(t){return t=t.toUpperCase(),Gr(new Af(this,n=>n.nodeName&&n.nodeName.toUpperCase()===t))}_callObserver(t,n){uc(this,t,new TN(this,n,t))}toString(){return Y0(this,t=>t.toString()).join("")}toJSON(){return this.toString()}toDOM(t=document,n={},r){const i=t.createDocumentFragment();return r!==void 0&&r._createAssociation(i,this),fo(this,s=>{i.insertBefore(s.toDOM(t,n,r),null)}),i}insert(t,n){this.doc!==null?Xe(this.doc,r=>{ty(r,this,t,n)}):this._prelimContent.splice(t,0,...n)}insertAfter(t,n){if(this.doc!==null)Xe(this.doc,r=>{const i=t&&t instanceof ot?t._item:t;fc(r,this,i,n)});else{const r=this._prelimContent,i=t===null?0:r.findIndex(s=>s===t)+1;if(i===0&&t!==null)throw Kr("Reference item not found");r.splice(i,0,...n)}}delete(t,n=1){this.doc!==null?Xe(this.doc,r=>{ny(r,this,t,n)}):this._prelimContent.splice(t,n)}toArray(){return Z0(this)}push(t){this.insert(this.length,t)}unshift(t){this.insert(0,t)}get(t){return Q0(this,t)}slice(t=0,n=this.length){return J0(this,t,n)}forEach(t){fo(this,t)}_write(t){t.writeTypeRef(GN)}}const SN=e=>new nr;class xr extends nr{constructor(t="UNDEFINED"){super(),this.nodeName=t,this._prelimAttrs=new Map}get nextSibling(){const t=this._item?this._item.next:null;return t?t.content.type:null}get prevSibling(){const t=this._item?this._item.prev:null;return t?t.content.type:null}_integrate(t,n){super._integrate(t,n),this._prelimAttrs.forEach((r,i)=>{this.setAttribute(i,r)}),this._prelimAttrs=null}_copy(){return new xr(this.nodeName)}clone(){const t=new xr(this.nodeName),n=this.getAttributes();return cO(n,(r,i)=>{typeof r=="string"&&t.setAttribute(i,r)}),t.insert(0,this.toArray().map(r=>r instanceof ot?r.clone():r)),t}toString(){const t=this.getAttributes(),n=[],r=[];for(const a in t)r.push(a);r.sort();const i=r.length;for(let a=0;a<i;a++){const c=r[a];n.push(c+'="'+t[c]+'"')}const s=this.nodeName.toLocaleLowerCase(),o=n.length>0?" "+n.join(" "):"";return`<${s}${o}>${super.toString()}</${s}>`}removeAttribute(t){this.doc!==null?Xe(this.doc,n=>{hc(n,this,t)}):this._prelimAttrs.delete(t)}setAttribute(t,n){this.doc!==null?Xe(this.doc,r=>{vf(r,this,t,n)}):this._prelimAttrs.set(t,n)}getAttribute(t){return Ef(this,t)}hasAttribute(t){return iy(this,t)}getAttributes(t){return t?pN(this,t):ry(this)}toDOM(t=document,n={},r){const i=t.createElement(this.nodeName),s=this.getAttributes();for(const o in s){const a=s[o];typeof a=="string"&&i.setAttribute(o,a)}return fo(this,o=>{i.appendChild(o.toDOM(t,n,r))}),r!==void 0&&r._createAssociation(i,this),i}_write(t){t.writeTypeRef(WN),t.writeKey(this.nodeName)}}const AN=e=>new xr(e.readKey());class TN extends cc{constructor(t,n,r){super(t,r),this.childListChanged=!1,this.attributesChanged=new Set,n.forEach(i=>{i===null?this.childListChanged=!0:this.attributesChanged.add(i)})}}class cs extends tr{constructor(t){super(),this.hookName=t}_copy(){return new cs(this.hookName)}clone(){const t=new cs(this.hookName);return this.forEach((n,r)=>{t.set(r,n)}),t}toDOM(t=document,n={},r){const i=n[this.hookName];let s;return i!==void 0?s=i.createDom(this):s=document.createElement(this.hookName),s.setAttribute("data-yjs-hook",this.hookName),r!==void 0&&r._createAssociation(s,this),s}_write(t){t.writeTypeRef(HN),t.writeKey(this.hookName)}}const xN=e=>new cs(e.readKey());class Si extends Pn{get nextSibling(){const t=this._item?this._item.next:null;return t?t.content.type:null}get prevSibling(){const t=this._item?this._item.prev:null;return t?t.content.type:null}_copy(){return new Si}clone(){const t=new Si;return t.applyDelta(this.toDelta()),t}toDOM(t=document,n,r){const i=t.createTextNode(this.toString());return r!==void 0&&r._createAssociation(i,this),i}toString(){return this.toDelta().map(t=>{const n=[];for(const i in t.attributes){const s=[];for(const o in t.attributes[i])s.push({key:o,value:t.attributes[i][o]});s.sort((o,a)=>o.key<a.key?-1:1),n.push({nodeName:i,attrs:s})}n.sort((i,s)=>i.nodeName<s.nodeName?-1:1);let r="";for(let i=0;i<n.length;i++){const s=n[i];r+=`<${s.nodeName}`;for(let o=0;o<s.attrs.length;o++){const a=s.attrs[o];r+=` ${a.key}="${a.value}"`}r+=">"}r+=t.insert;for(let i=n.length-1;i>=0;i--)r+=`</${n[i].nodeName}>`;return r}).join("")}toJSON(){return this.toString()}_write(t){t.writeTypeRef(VN)}}const RN=e=>new Si;class Tf{constructor(t,n){this.id=t,this.length=n}get deleted(){throw Zn()}mergeWith(t){return!1}write(t,n,r){throw Zn()}integrate(t,n){throw Zn()}}const IN=0;class cn extends Tf{get deleted(){return!0}delete(){}mergeWith(t){return this.constructor!==t.constructor?!1:(this.length+=t.length,!0)}integrate(t,n){n>0&&(this.id.clock+=n,this.length-=n),$0(t.doc.store,this)}write(t,n){t.writeInfo(IN),t.writeLen(this.length-n)}getMissing(t,n){return null}}class ho{constructor(t){this.content=t}getLength(){return 1}getContent(){return[this.content]}isCountable(){return!0}copy(){return new ho(this.content)}splice(t){throw Zn()}mergeWith(t){return!1}integrate(t,n){}delete(t){}gc(t){}write(t,n){t.writeBuf(this.content)}getRef(){return 3}}const ON=e=>new ho(e.readBuf());class po{constructor(t){this.len=t}getLength(){return this.len}getContent(){return[]}isCountable(){return!1}copy(){return new po(this.len)}splice(t){const n=new po(this.len-t);return this.len=t,n}mergeWith(t){return this.len+=t.len,!0}integrate(t,n){rc(t.deleteSet,n.id.client,n.id.clock,this.len),n.markDeleted()}delete(t){}gc(t){}write(t,n){t.writeLen(this.len-n)}getRef(){return 1}}const NN=e=>new po(e.readLen()),hy=(e,t)=>new Tr({guid:e,...t,shouldLoad:t.shouldLoad||t.autoLoad||!1});class mo{constructor(t){t._item&&console.error("This document was already integrated as a sub-document. You should create a second instance instead with the same guid."),this.doc=t;const n={};this.opts=n,t.gc||(n.gc=!1),t.autoLoad&&(n.autoLoad=!0),t.meta!==null&&(n.meta=t.meta)}getLength(){return 1}getContent(){return[this.doc]}isCountable(){return!0}copy(){return new mo(hy(this.doc.guid,this.opts))}splice(t){throw Zn()}mergeWith(t){return!1}integrate(t,n){this.doc._item=n,t.subdocsAdded.add(this.doc),this.doc.shouldLoad&&t.subdocsLoaded.add(this.doc)}delete(t){t.subdocsAdded.has(this.doc)?t.subdocsAdded.delete(this.doc):t.subdocsRemoved.add(this.doc)}gc(t){}write(t,n){t.writeString(this.doc.guid),t.writeAny(this.opts)}getRef(){return 9}}const CN=e=>new mo(hy(e.readString(),e.readAny()));class Ai{constructor(t){this.embed=t}getLength(){return 1}getContent(){return[this.embed]}isCountable(){return!0}copy(){return new Ai(this.embed)}splice(t){throw Zn()}mergeWith(t){return!1}integrate(t,n){}delete(t){}gc(t){}write(t,n){t.writeJSON(this.embed)}getRef(){return 5}}const LN=e=>new Ai(e.readJSON());class Et{constructor(t,n){this.key=t,this.value=n}getLength(){return 1}getContent(){return[]}isCountable(){return!1}copy(){return new Et(this.key,this.value)}splice(t){throw Zn()}mergeWith(t){return!1}integrate(t,n){const r=n.parent;r._searchMarker=null,r._hasFormatting=!0}delete(t){}gc(t){}write(t,n){t.writeKey(this.key),t.writeJSON(this.value)}getRef(){return 6}}const MN=e=>new Et(e.readKey(),e.readJSON());class mc{constructor(t){this.arr=t}getLength(){return this.arr.length}getContent(){return this.arr}isCountable(){return!0}copy(){return new mc(this.arr)}splice(t){const n=new mc(this.arr.slice(t));return this.arr=this.arr.slice(0,t),n}mergeWith(t){return this.arr=this.arr.concat(t.arr),!0}integrate(t,n){}delete(t){}gc(t){}write(t,n){const r=this.arr.length;t.writeLen(r-n);for(let i=n;i<r;i++){const s=this.arr[i];t.writeString(s===void 0?"undefined":JSON.stringify(s))}}getRef(){return 2}}const UN=e=>{const t=e.readLen(),n=[];for(let r=0;r<t;r++){const i=e.readString();i==="undefined"?n.push(void 0):n.push(JSON.parse(i))}return new mc(n)},PN=nc("node_env")==="development";class Ti{constructor(t){this.arr=t,PN&&m0(t)}getLength(){return this.arr.length}getContent(){return this.arr}isCountable(){return!0}copy(){return new Ti(this.arr)}splice(t){const n=new Ti(this.arr.slice(t));return this.arr=this.arr.slice(0,t),n}mergeWith(t){return this.arr=this.arr.concat(t.arr),!0}integrate(t,n){}delete(t){}gc(t){}write(t,n){const r=this.arr.length;t.writeLen(r-n);for(let i=n;i<r;i++){const s=this.arr[i];t.writeAny(s)}}getRef(){return 8}}const DN=e=>{const t=e.readLen(),n=[];for(let r=0;r<t;r++)n.push(e.readAny());return new Ti(n)};class rr{constructor(t){this.str=t}getLength(){return this.str.length}getContent(){return this.str.split("")}isCountable(){return!0}copy(){return new rr(this.str)}splice(t){const n=new rr(this.str.slice(t));this.str=this.str.slice(0,t);const r=this.str.charCodeAt(t-1);return r>=55296&&r<=56319&&(this.str=this.str.slice(0,t-1)+"",n.str=""+n.str.slice(1)),n}mergeWith(t){return this.str+=t.str,!0}integrate(t,n){}delete(t){}gc(t){}write(t,n){t.writeString(n===0?this.str:this.str.slice(n))}getRef(){return 4}}const BN=e=>new rr(e.readString()),FN=[gN,_N,kN,AN,SN,xN,RN],$N=0,jN=1,zN=2,WN=3,GN=4,HN=5,VN=6;class Rr{constructor(t){this.type=t}getLength(){return 1}getContent(){return[this.type]}isCountable(){return!0}copy(){return new Rr(this.type._copy())}splice(t){throw Zn()}mergeWith(t){return!1}integrate(t,n){this.type._integrate(t.doc,n)}delete(t){let n=this.type._start;for(;n!==null;)n.deleted?n.id.clock<(t.beforeState.get(n.id.client)||0)&&t._mergeStructs.push(n):n.delete(t),n=n.right;this.type._map.forEach(r=>{r.deleted?r.id.clock<(t.beforeState.get(r.id.client)||0)&&t._mergeStructs.push(r):r.delete(t)}),t.changed.delete(this.type)}gc(t){let n=this.type._start;for(;n!==null;)n.gc(t,!0),n=n.right;this.type._start=null,this.type._map.forEach(r=>{for(;r!==null;)r.gc(t,!0),r=r.left}),this.type._map=new Map}write(t,n){this.type._write(t)}getRef(){return 7}}const KN=e=>new Rr(FN[e.readTypeRef()](e)),gc=(e,t,n)=>{const{client:r,clock:i}=t.id,s=new kt(Oe(r,i+n),t,Oe(r,i+n-1),t.right,t.rightOrigin,t.parent,t.parentSub,t.content.splice(n));return t.deleted&&s.markDeleted(),t.keep&&(s.keep=!0),t.redone!==null&&(s.redone=Oe(t.redone.client,t.redone.clock+n)),t.right=s,s.right!==null&&(s.right.left=s),e._mergeStructs.push(s),s.parentSub!==null&&s.right===null&&s.parent._map.set(s.parentSub,s),t.length=n,s};class kt extends Tf{constructor(t,n,r,i,s,o,a,c){super(t,c.getLength()),this.origin=r,this.left=n,this.right=i,this.rightOrigin=s,this.parent=o,this.parentSub=a,this.redone=null,this.content=c,this.info=this.content.isCountable()?e0:0}set marker(t){(this.info&Xu)>0!==t&&(this.info^=Xu)}get marker(){return(this.info&Xu)>0}get keep(){return(this.info&Qg)>0}set keep(t){this.keep!==t&&(this.info^=Qg)}get countable(){return(this.info&e0)>0}get deleted(){return(this.info&qu)>0}set deleted(t){this.deleted!==t&&(this.info^=qu)}markDeleted(){this.info|=qu}getMissing(t,n){if(this.origin&&this.origin.client!==this.id.client&&this.origin.clock>=Ot(n,this.origin.client))return this.origin.client;if(this.rightOrigin&&this.rightOrigin.client!==this.id.client&&this.rightOrigin.clock>=Ot(n,this.rightOrigin.client))return this.rightOrigin.client;if(this.parent&&this.parent.constructor===ss&&this.id.client!==this.parent.client&&this.parent.clock>=Ot(n,this.parent.client))return this.parent.client;if(this.origin&&(this.left=j0(t,n,this.origin),this.origin=this.left.lastId),this.rightOrigin&&(this.right=qr(t,this.rightOrigin),this.rightOrigin=this.right.id),this.left&&this.left.constructor===cn||this.right&&this.right.constructor===cn)this.parent=null;else if(!this.parent)this.left&&this.left.constructor===kt&&(this.parent=this.left.parent,this.parentSub=this.left.parentSub),this.right&&this.right.constructor===kt&&(this.parent=this.right.parent,this.parentSub=this.right.parentSub);else if(this.parent.constructor===ss){const r=mf(n,this.parent);r.constructor===cn?this.parent=null:this.parent=r.content.type}return null}integrate(t,n){if(n>0&&(this.id.clock+=n,this.left=j0(t,t.doc.store,Oe(this.id.client,this.id.clock-1)),this.origin=this.left.lastId,this.content=this.content.splice(n),this.length-=n),this.parent){if(!this.left&&(!this.right||this.right.left!==null)||this.left&&this.left.right!==this.right){let r=this.left,i;if(r!==null)i=r.right;else if(this.parentSub!==null)for(i=this.parent._map.get(this.parentSub)||null;i!==null&&i.left!==null;)i=i.left;else i=this.parent._start;const s=new Set,o=new Set;for(;i!==null&&i!==this.right;){if(o.add(i),s.add(i),ic(this.origin,i.origin)){if(i.id.client<this.id.client)r=i,s.clear();else if(ic(this.rightOrigin,i.rightOrigin))break}else if(i.origin!==null&&o.has(mf(t.doc.store,i.origin)))s.has(mf(t.doc.store,i.origin))||(r=i,s.clear());else break;i=i.right}this.left=r}if(this.left!==null){const r=this.left.right;this.right=r,this.left.right=this}else{let r;if(this.parentSub!==null)for(r=this.parent._map.get(this.parentSub)||null;r!==null&&r.left!==null;)r=r.left;else r=this.parent._start,this.parent._start=this;this.right=r}this.right!==null?this.right.left=this:this.parentSub!==null&&(this.parent._map.set(this.parentSub,this),this.left!==null&&this.left.delete(t)),this.parentSub===null&&this.countable&&!this.deleted&&(this.parent._length+=this.length),$0(t.doc.store,this),this.content.integrate(t,this),G0(t,this.parent,this.parentSub),(this.parent._item!==null&&this.parent._item.deleted||this.parentSub!==null&&this.right!==null)&&this.delete(t)}else new cn(this.id,this.length).integrate(t,0)}get next(){let t=this.right;for(;t!==null&&t.deleted;)t=t.right;return t}get prev(){let t=this.left;for(;t!==null&&t.deleted;)t=t.left;return t}get lastId(){return this.length===1?this.id:Oe(this.id.client,this.id.clock+this.length-1)}mergeWith(t){if(this.constructor===t.constructor&&ic(t.origin,this.lastId)&&this.right===t&&ic(this.rightOrigin,t.rightOrigin)&&this.id.client===t.id.client&&this.id.clock+this.length===t.id.clock&&this.deleted===t.deleted&&this.redone===null&&t.redone===null&&this.content.constructor===t.content.constructor&&this.content.mergeWith(t.content)){const n=this.parent._searchMarker;return n&&n.forEach(r=>{r.p===t&&(r.p=this,!this.deleted&&this.countable&&(r.index-=this.length))}),t.keep&&(this.keep=!0),this.right=t.right,this.right!==null&&(this.right.left=this),this.length+=t.length,!0}return!1}delete(t){if(!this.deleted){const n=this.parent;this.countable&&this.parentSub===null&&(n._length-=this.length),this.markDeleted(),rc(t.deleteSet,this.id.client,this.id.clock,this.length),G0(t,n,this.parentSub),this.content.delete(t)}}gc(t,n){if(!this.deleted)throw Yn();this.content.gc(t),n?YO(t,this,new cn(this.id,this.length)):this.content=new po(this.length)}write(t,n){const r=n>0?Oe(this.id.client,this.id.clock+n-1):this.origin,i=this.rightOrigin,s=this.parentSub,o=this.content.getRef()&Za|(r===null?0:an)|(i===null?0:kr)|(s===null?0:to);if(t.writeInfo(o),r!==null&&t.writeLeftID(r),i!==null&&t.writeRightID(i),r===null&&i===null){const a=this.parent;if(a._item!==void 0){const c=a._item;if(c===null){const l=ZO(a);t.writeParentInfo(!0),t.writeString(l)}else t.writeParentInfo(!1),t.writeLeftID(c.id)}else a.constructor===String?(t.writeParentInfo(!0),t.writeString(a)):a.constructor===ss?(t.writeParentInfo(!1),t.writeLeftID(a)):Yn();s!==null&&t.writeString(s)}this.content.write(t,n)}}const dy=(e,t)=>qN[t&Za](e),qN=[()=>{Yn()},NN,UN,ON,BN,LN,MN,KN,DN,CN,()=>{Yn()}],XN=10;class Sn extends Tf{get deleted(){return!0}delete(){}mergeWith(t){return this.constructor!==t.constructor?!1:(this.length+=t.length,!0)}integrate(t,n){Yn()}write(t,n){t.writeInfo(XN),ve(t.restEncoder,this.length-n)}getMissing(t,n){return null}}const py=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:{},my="__ $YJS$ __";py[my]===!0&&console.error("Yjs was already imported. This breaks constructor checks and will lead to issues! - https://github.com/yjs/yjs/issues/438"),py[my]=!0;let xf,Rf,JN=e=>e();function ZN(e,t){if(Rf)return Rf(e,t);JN(e)}function xi(e,t,n){if(xf)return xf.apply(null,arguments);throw new Error("observable implementation not provided. Call enableReactiveBindings, enableVueBindings or enableMobxBindings.")}function YN(e){xf=function(t,n,r){const i=e.createAtom(t);return n&&n(),i},Rf=(t,n)=>e.reaction(t,n,{fireImmediately:!1})}const gy=new WeakSet;function QN(e){if(gy.has(e))return e;gy.add(e);let t;const n=new Map;function r(){if(!t){const f=d=>{(d.changes.added.size||d.changes.deleted.size||d.changes.keys.size||d.changes.delta.length)&&t.reportChanged()};t=xi("map",()=>{e.observe(f)},()=>{e.unobserve(f)})}t.reportObserved(e._implicitObserver)}function i(f){let d=n.get(f);if(!d){const h=p=>{d.reportChanged()};d=xi(f+"",()=>{e.observe(h)},()=>{e.unobserve(h)}),n.set(f,d)}d.reportObserved(e._implicitObserver)}const s=e.get;e.get=function(f){if(typeof f!="number")throw new Error("unexpected");return i(f),Reflect.apply(s,this,arguments)};function o(f){const d=e[f];e[f]=function(){return r(),Reflect.apply(d,this,arguments)}}function a(f){let d=e,h=Object.getOwnPropertyDescriptor(d,f);if(h||(d=Object.getPrototypeOf(d),h=Object.getOwnPropertyDescriptor(d,f)),h||(d=Object.getPrototypeOf(d),h=Object.getOwnPropertyDescriptor(d,f)),!h)throw new Error("property not found");const p=h.get;h.get=function(){return this._disableTracking||r(),Reflect.apply(p,this,arguments)},Object.defineProperty(e,f,h)}function c(f,d){let h=e,p=Object.getOwnPropertyDescriptor(h,f);if(p||(h=Object.getPrototypeOf(h),p=Object.getOwnPropertyDescriptor(h,f)),p||(h=Object.getPrototypeOf(h),p=Object.getOwnPropertyDescriptor(h,f)),!p)throw new Error("property not found");Object.defineProperty(e,d,p)}o("forEach"),o("toJSON"),o("toArray"),o("slice"),o("map"),c("length","lengthUntracked"),a("length");const l=e.push;e.push=function(f){this._disableTracking=!0;const d=l.call(this,f);return this._disableTracking=!1,d};const u=e.slice;return e.slice=function(f,d){this._disableTracking=!0;const h=u.call(this,f,d);return this._disableTracking=!1,h},e}const yy=new WeakSet;function eC(e){if(yy.has(e))return e;yy.add(e);let t;function n(){if(!t){let s=Array.from(e.share.keys());const o=a=>{const c=Array.from(e.share.keys());JSON.stringify(s)!==JSON.stringify(c)&&(s=c,t.reportChanged())};t=xi("map",()=>{e.on("beforeObserverCalls",o)},()=>{e.off("beforeObserverCalls",o)})}t.reportObserved(e._implicitObserver)}const r=e.get;e.get=function(s){if(typeof s!="string")throw new Error("unexpected");const o=Reflect.apply(r,this,arguments);return yc(o),o};function i(s){const o=e[s];let a;e[s]=function(){let c,l=arguments;return n(),a&&a.removeObservers(),a=ZN(()=>(c=Reflect.apply(o,e,l),c),()=>t.reportChanged()),c}}return i("toJSON"),Object.defineProperty(e,"keys",{get:()=>(n(),Object.keys(e.share))}),e}const _y=new WeakSet;function tC(e){if(_y.has(e))return e;_y.add(e);let t;const n=new Map;function r(){if(!t){const a=c=>{(c.changes.added.size||c.changes.deleted.size||c.changes.keys.size||c.changes.delta.length)&&t.reportChanged()};t=xi("map",()=>{e.observe(a)},()=>{e.unobserve(a)})}t.reportObserved(e._implicitObserver)}function i(a){let c=n.get(a);if(!c){const l=u=>{u.keysChanged.has(a)&&(u.changes.added.size||u.changes.deleted.size||u.changes.keys.size||u.changes.delta.length)&&c.reportChanged()};c=xi(a,()=>{e.observe(l)},()=>{e.unobserve(l)}),n.set(a,c)}c.reportObserved(e._implicitObserver)}const s=e.get;e.get=function(a){if(typeof a!="string")throw new Error("unexpected");return i(a),Reflect.apply(s,this,arguments)};function o(a){const c=e[a];e[a]=function(){return r(),Reflect.apply(c,this,arguments)}}return o("values"),o("entries"),o("keys"),o("forEach"),o("toJSON"),e}const by=new WeakSet;function wy(e){if(by.has(e))return e;by.add(e);let t;const n=i=>{t.reportChanged()};t=xi("text",()=>{e.observe(n)},()=>{e.unobserve(n)});function r(i){const s=e[i];e[i]=function(){return t.reportObserved(this._implicitObserver),Reflect.apply(s,this,arguments)}}return r("toString"),r("toJSON"),e}const vy=new WeakSet;function Ey(e){if(vy.has(e))return e;vy.add(e);let t;const n=s=>{(s.changes.added.size||s.changes.deleted.size||s.changes.keys.size||s.changes.delta.length)&&t.reportChanged()};t=xi("xml",()=>{e.observe(n)},()=>{e.unobserve(n)});function r(s){const o=e[s];e[s]=function(){return t.reportObserved(this._implicitObserver),Reflect.apply(o,this,arguments)}}function i(s){let o=e,a=Object.getOwnPropertyDescriptor(o,s);if(a||(o=Object.getPrototypeOf(o),a=Object.getOwnPropertyDescriptor(o,s)),a||(o=Object.getPrototypeOf(o),a=Object.getOwnPropertyDescriptor(o,s)),!a)throw new Error("property not found");const c=a.get;a.get=function(){return t.reportObserved(this._implicitObserver),Reflect.apply(c,this,arguments)},Object.defineProperty(e,s,a)}return r("toString"),r("toDOM"),r("toArray"),r("getAttribute"),i("firstChild"),e}function yc(e){return e instanceof Si||e instanceof Pn?wy(e):e instanceof er?QN(e):e instanceof tr?tC(e):e instanceof Tr||Object.prototype.hasOwnProperty.call(e,"autoLoad")?eC(e):e instanceof nr||e instanceof xr?Ey(e):e}function ky(e){e.share.forEach(t=>{t.constructor!==ot&&yc(t)})}function Sy(e,t){for(let r=e.length-1;r>=t;r--){let i=e[r];if(!i.deleted){var n;if(i instanceof cn)continue;(n=i.content)==null||n.getContent().forEach(s=>{s instanceof ot&&yc(s)})}}}const Ay=new WeakSet;function nC(e){Ay.has(e)||(Ay.add(e),yc(e),e.store.clients.forEach(t=>{t&&Sy(t,0)}),ky(e),e.on("beforeObserverCalls",t=>{ky(e),t.afterState.forEach((n,r)=>{const i=t.beforeState.get(r)||0;if(i!==n){const s=t.doc.store.clients.get(r);if(!s)return;const o=Un(s,i);Sy(s,o)}})}))}class go{constructor(t){this.value=void 0,this.value=t}}function rC(e){return ArrayBuffer.isView(e)?new go(e):new go(Object.freeze(e))}function iC(e){const t=function(){var a;let c=(a=this[kn])==null?void 0:a.implicitObserver;return e._implicitObserver=c,e.slice.bind(e).apply(e,arguments).map(u=>{const f=_c(u,c);return c&&typeof f=="object"?eo(f,c):f})},n=function(a){return a.map(c=>{const l=If(c);let u=Ri(l)||l;if(u instanceof go&&(u=u.value),u instanceof ot&&u.parent)throw new Error("Not supported: reassigning object that already occurs in the tree.");return u})},r=function(){return[].findIndex.apply(t.apply(this),arguments)},i={slice:t,unshift:(...o)=>(e.unshift(n(o)),e.lengthUntracked),push:(...o)=>(e.push(n(o)),e.lengthUntracked),insert:e.insert.bind(e),toJSON:e.toJSON.bind(e),forEach:function(){return[].forEach.apply(t.apply(this),arguments)},every:function(){return[].every.apply(t.apply(this),arguments)},filter:function(){return[].filter.apply(t.apply(this),arguments)},find:function(){return[].find.apply(t.apply(this),arguments)},findIndex:r,some:function(){return[].some.apply(t.apply(this),arguments)},includes:function(){return[].includes.apply(t.apply(this),arguments)},map:function(){return[].map.apply(t.apply(this),arguments)},indexOf:function(){const o=arguments[0];return r.call(this,a=>lC(a,o))},splice:function(){let o=arguments[0]<0?e.length-Math.abs(arguments[0]):arguments[0],a=arguments[1],c=Array.from(Array.from(arguments).slice(2)),l=t.apply(this,[o,Number.isInteger(a)?o+a:void 0]);return e.doc?e.doc.transact(()=>{e.delete(o,a),e.insert(o,n(c))}):(e.delete(o,a),e.insert(o,n(c))),l}},s=[];for(let o in i)s[o]=i[o];return s}function yo(e){if(typeof e=="string"&&e.trim().length){const t=Number(e);if(Number.isInteger(t))return t}return e}function Ty(e,t=new er){if(t[vt])throw new Error("unexpected");const n=iC(t),r=new Proxy(n,{set:(i,s,o)=>{throw typeof yo(s)!="number"?new Error:new Error("array assignment is not implemented / supported")},get:(i,s,o)=>{const a=yo(s);if(a===bc)return t;if(typeof a=="number"){let u;if(o&&o[kn]){var c;u=(c=o[kn])==null?void 0:c.implicitObserver,t._implicitObserver=u}let f=t.get(a);return f=_c(f,u),f}if(a===Symbol.toStringTag)return"Array";if(a===Symbol.iterator){const u=t.slice();return Reflect.get(u,a)}return a==="length"?t.length:Reflect.get(i,a,o)},deleteProperty:(i,s)=>{const o=yo(s);if(typeof o!="number")throw new Error;return o<t.lengthUntracked&&o>=0?(t.delete(o),!0):!1},has:(i,s)=>{const o=yo(s);return typeof o!="number"?Reflect.has(i,o):o<t.lengthUntracked&&o>=0},getOwnPropertyDescriptor(i,s){const o=yo(s);if(o==="length")return{enumerable:!1,configurable:!1,writable:!0};if(typeof o=="number"&&o>=0&&o<t.lengthUntracked)return{enumerable:!0,configurable:!0,writable:!0}},ownKeys:i=>{const s=[];for(let o=0;o<t.length;o++)s.push(o+"");return s.push("length"),s}});return n.push.apply(r,e),r}function xy(e,t=new tr){if(t[vt])throw new Error("unexpected");const n=new Proxy({},{set:(r,i,s)=>{if(typeof i!="string")throw new Error;const o=If(s);let a=Ri(o)||o;if(a instanceof go&&(a=a.value),a instanceof ot&&a.parent)throw new Error("Not supported: reassigning object that already occurs in the tree.");return t.set(i,a),!0},get:(r,i,s)=>{if(i===bc)return t;if(typeof i!="string")return Reflect.get(r,i);let o;if(s&&s[kn]){var a;o=(a=s[kn])==null?void 0:a.implicitObserver,t._implicitObserver=o}let c=t.get(i);return c=_c(c,o),c},deleteProperty:(r,i)=>{if(typeof i!="string")throw new Error;return t.has(i)?(t.delete(i),!0):!1},has:(r,i)=>!!(typeof i=="string"&&t.has(i)),getOwnPropertyDescriptor(r,i){if(typeof i=="string"&&t.has(i))return{enumerable:!0,configurable:!0}},ownKeys:r=>Array.from(t.keys())});_o.set(t,n);for(let r in e)n[r]=e[r];return n}function sC(e){return e instanceof ot}const _o=new WeakMap;function _c(e,t){if(sC(e)){if(e._implicitObserver=t,e instanceof er||e instanceof tr){if(!_o.has(e)){const n=If(e);_o.set(e,n)}e=_o.get(e)}else if(e instanceof xr||e instanceof nr||e instanceof Si||e instanceof cs||e instanceof Pn)Gu(e),e.__v_skip=!0;else throw new Error("unknown YType");return e}else{if(e===null)return null;if(typeof e=="object")return rC(e)}return e}function If(e){if(e==null)return e;if(e=Ri(e)||e,e instanceof er)return Ty([],e);if(e instanceof tr)return xy({},e);if(typeof e=="string")return e;if(Array.isArray(e))return Ty(e);if(e instanceof xr||e instanceof nr||e instanceof Si||e instanceof cs)return e;if(e instanceof Pn)return e;if(typeof e=="object")return e instanceof go?e:xy(e);if(typeof e=="number"||typeof e=="boolean")return e;throw new Error("invalid")}function oC(e){for(let[t,n]of Object.entries(e))if(Array.isArray(n)){if(n.length!==0)throw new Error("Root Array initializer must always be empty array")}else if(n&&typeof n=="object"){if(Object.keys(n).length!==0||Object.getPrototypeOf(n)!==Object.prototype)throw new Error("Root Object initializer must always be {}")}else if(n!=="xml"&&n!=="text")throw new Error("unknown Root initializer")}function Ry(e,t,n){let r=t[n];if(!r){n!=="__v_raw"&&n!=="__v_isRef"&&n!=="__v_isReadonly"&&console.warn("property not found on root doc",n);return}return r==="xml"?e.getXmlFragment(n):r==="text"?e.getText(n):Array.isArray(r)?e.getArray(n):e.getMap(n)}function aC(e,t){if(e[vt])throw new Error("unexpected");oC(t);const n=new Proxy({},{set:(r,i,s)=>{throw typeof i!="string"?new Error:new Error("cannot set new elements on root doc")},get:(r,i,s)=>{if(i===bc)return e;if(typeof i!="string")return Reflect.get(r,i);let o;if(s&&s[kn]){var a;o=(a=s[kn])==null?void 0:a.implicitObserver,e._implicitObserver=o}if(i==="toJSON"){for(let u of Object.keys(t))Ry(e,t,u);return Reflect.get(e,i)}let c=Ry(e,t,i);return c=_c(c,o),c},deleteProperty:(r,i)=>{throw new Error("deleteProperty not available for doc")},has:(r,i)=>!!(typeof i=="string"&&e.share.has(i)),getOwnPropertyDescriptor(r,i){if(typeof i=="string"&&e.share.has(i)||i==="toJSON")return{enumerable:!0,configurable:!0}},ownKeys:r=>Array.from(e.share.keys())});return _o.set(e,n),n}YN(TI);const bc=Symbol("INTERNAL_SYMBOL");function Iy(e,t){const n=Ri(e)||e;if(!n)throw new Error("not a valid synced object");return n instanceof Tr?(n.on("update",t),()=>{n.off("update",t)}):(n.observeDeep(t),()=>{n.unobserveDeep(t)})}function cC(e){const t=Ri(e);if(!(t instanceof Tr))throw new Error("store is not a valid syncedStore that maps to a Y.Doc");return t}function Ri(e){if(typeof e!="object"||e===null)return;const t=e[bc];return t&&(Gu(t),t.__v_skip=!0),t}function lC(e,t){if(e===t)return!0;if(typeof e=="object"&&typeof t=="object"){const n=Ri(e),r=Ri(t);return!n||!r?!1:n===r}return!1}function uC(e,t=new Tr){return nC(t),aC(t,e)}var Re={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var bo=Symbol.for("react.element"),fC=Symbol.for("react.portal"),hC=Symbol.for("react.fragment"),dC=Symbol.for("react.strict_mode"),pC=Symbol.for("react.profiler"),mC=Symbol.for("react.provider"),gC=Symbol.for("react.context"),yC=Symbol.for("react.forward_ref"),_C=Symbol.for("react.suspense"),bC=Symbol.for("react.memo"),wC=Symbol.for("react.lazy"),Oy=Symbol.iterator;function vC(e){return e===null||typeof e!="object"?null:(e=Oy&&e[Oy]||e["@@iterator"],typeof e=="function"?e:null)}var Ny={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},Cy=Object.assign,Ly={};function ls(e,t,n){this.props=e,this.context=t,this.refs=Ly,this.updater=n||Ny}ls.prototype.isReactComponent={},ls.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")},ls.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function My(){}My.prototype=ls.prototype;function Of(e,t,n){this.props=e,this.context=t,this.refs=Ly,this.updater=n||Ny}var Nf=Of.prototype=new My;Nf.constructor=Of,Cy(Nf,ls.prototype),Nf.isPureReactComponent=!0;var Uy=Array.isArray,Py=Object.prototype.hasOwnProperty,Cf={current:null},Dy={key:!0,ref:!0,__self:!0,__source:!0};function By(e,t,n){var r,i={},s=null,o=null;if(t!=null)for(r in t.ref!==void 0&&(o=t.ref),t.key!==void 0&&(s=""+t.key),t)Py.call(t,r)&&!Dy.hasOwnProperty(r)&&(i[r]=t[r]);var a=arguments.length-2;if(a===1)i.children=n;else if(1<a){for(var c=Array(a),l=0;l<a;l++)c[l]=arguments[l+2];i.children=c}if(e&&e.defaultProps)for(r in a=e.defaultProps,a)i[r]===void 0&&(i[r]=a[r]);return{$$typeof:bo,type:e,key:s,ref:o,props:i,_owner:Cf.current}}function EC(e,t){return{$$typeof:bo,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function Lf(e){return typeof e=="object"&&e!==null&&e.$$typeof===bo}function kC(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(n){return t[n]})}var Fy=/\/+/g;function Mf(e,t){return typeof e=="object"&&e!==null&&e.key!=null?kC(""+e.key):t.toString(36)}function wc(e,t,n,r,i){var s=typeof e;(s==="undefined"||s==="boolean")&&(e=null);var o=!1;if(e===null)o=!0;else switch(s){case"string":case"number":o=!0;break;case"object":switch(e.$$typeof){case bo:case fC:o=!0}}if(o)return o=e,i=i(o),e=r===""?"."+Mf(o,0):r,Uy(i)?(n="",e!=null&&(n=e.replace(Fy,"$&/")+"/"),wc(i,t,n,"",function(l){return l})):i!=null&&(Lf(i)&&(i=EC(i,n+(!i.key||o&&o.key===i.key?"":(""+i.key).replace(Fy,"$&/")+"/")+e)),t.push(i)),1;if(o=0,r=r===""?".":r+":",Uy(e))for(var a=0;a<e.length;a++){s=e[a];var c=r+Mf(s,a);o+=wc(s,t,n,c,i)}else if(c=vC(e),typeof c=="function")for(e=c.call(e),a=0;!(s=e.next()).done;)s=s.value,c=r+Mf(s,a++),o+=wc(s,t,n,c,i);else if(s==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return o}function vc(e,t,n){if(e==null)return e;var r=[],i=0;return wc(e,r,"","",function(s){return t.call(n,s,i++)}),r}function SC(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(n){(e._status===0||e._status===-1)&&(e._status=1,e._result=n)},function(n){(e._status===0||e._status===-1)&&(e._status=2,e._result=n)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var Vt={current:null},Ec={transition:null},AC={ReactCurrentDispatcher:Vt,ReactCurrentBatchConfig:Ec,ReactCurrentOwner:Cf};function $y(){throw Error("act(...) is not supported in production builds of React.")}Re.Children={map:vc,forEach:function(e,t,n){vc(e,function(){t.apply(this,arguments)},n)},count:function(e){var t=0;return vc(e,function(){t++}),t},toArray:function(e){return vc(e,function(t){return t})||[]},only:function(e){if(!Lf(e))throw Error("React.Children.only expected to receive a single React element child.");return e}},Re.Component=ls,Re.Fragment=hC,Re.Profiler=pC,Re.PureComponent=Of,Re.StrictMode=dC,Re.Suspense=_C,Re.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=AC,Re.act=$y,Re.cloneElement=function(e,t,n){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var r=Cy({},e.props),i=e.key,s=e.ref,o=e._owner;if(t!=null){if(t.ref!==void 0&&(s=t.ref,o=Cf.current),t.key!==void 0&&(i=""+t.key),e.type&&e.type.defaultProps)var a=e.type.defaultProps;for(c in t)Py.call(t,c)&&!Dy.hasOwnProperty(c)&&(r[c]=t[c]===void 0&&a!==void 0?a[c]:t[c])}var c=arguments.length-2;if(c===1)r.children=n;else if(1<c){a=Array(c);for(var l=0;l<c;l++)a[l]=arguments[l+2];r.children=a}return{$$typeof:bo,type:e.type,key:i,ref:s,props:r,_owner:o}},Re.createContext=function(e){return e={$$typeof:gC,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:mC,_context:e},e.Consumer=e},Re.createElement=By,Re.createFactory=function(e){var t=By.bind(null,e);return t.type=e,t},Re.createRef=function(){return{current:null}},Re.forwardRef=function(e){return{$$typeof:yC,render:e}},Re.isValidElement=Lf,Re.lazy=function(e){return{$$typeof:wC,_payload:{_status:-1,_result:e},_init:SC}},Re.memo=function(e,t){return{$$typeof:bC,type:e,compare:t===void 0?null:t}},Re.startTransition=function(e){var t=Ec.transition;Ec.transition={};try{e()}finally{Ec.transition=t}},Re.unstable_act=$y,Re.useCallback=function(e,t){return Vt.current.useCallback(e,t)},Re.useContext=function(e){return Vt.current.useContext(e)},Re.useDebugValue=function(){},Re.useDeferredValue=function(e){return Vt.current.useDeferredValue(e)},Re.useEffect=function(e,t){return Vt.current.useEffect(e,t)},Re.useId=function(){return Vt.current.useId()},Re.useImperativeHandle=function(e,t,n){return Vt.current.useImperativeHandle(e,t,n)},Re.useInsertionEffect=function(e,t){return Vt.current.useInsertionEffect(e,t)},Re.useLayoutEffect=function(e,t){return Vt.current.useLayoutEffect(e,t)},Re.useMemo=function(e,t){return Vt.current.useMemo(e,t)},Re.useReducer=function(e,t,n){return Vt.current.useReducer(e,t,n)},Re.useRef=function(e){return Vt.current.useRef(e)},Re.useState=function(e){return Vt.current.useState(e)},Re.useSyncExternalStore=function(e,t,n){return Vt.current.useSyncExternalStore(e,t,n)},Re.useTransition=function(){return Vt.current.useTransition()},Re.version="18.3.1";const Uf=0,jy=1,zy=2,TC=(e,t)=>{ve(e,Uf);const n=XO(t);Pt(e,n)},Wy=(e,t,n)=>{ve(e,jy),Pt(e,HO(t,n))},xC=(e,t,n)=>Wy(t,n,Ht(e)),Gy=(e,t,n)=>{try{zO(t,Ht(e),n)}catch(r){console.error("Caught error while handling a Yjs update",r)}},RC=(e,t)=>{ve(e,zy),Pt(e,t)},IC=Gy,OC=(e,t,n,r)=>{const i=Ee(e);switch(i){case Uf:xC(e,t,n);break;case jy:Gy(e,n,r);break;case zy:IC(e,n,r);break;default:throw new Error("Unknown message type")}return i},Ir=uC({shared:[]});function kc(e,t,n){return e.find(r=>r.key===t&&r.type===n)}function Hy(e,t,n){const r=kc(Ir.shared,e,t);S(r)||Ir.shared.push({key:e,type:t,value:n})}function NC(e,t){Hy(e,0,t)}function Vy(e,t){const n=new Pn(t);Hy(e,1,n)}function CC(e,t){const n=kc(Ir.shared,e,0);if(S(n)){n.value=t;return}Ir.shared.push({key:e,type:0,value:t})}function LC(e,t){const n=new Pn(t),r=kc(Ir.shared,e,1);if(S(r)){r.value=n;return}Ir.shared.push({key:e,type:1,value:n})}function Ky(e,t,n){let r;function i(){const o=kc(Ir.shared,e,t);S(o)&&(s(),r=Iy(o,()=>n(o.value)))}const s=Iy(Ir.shared,i);return i(),()=>r==null?void 0:r()}function MC(e,t){return Ky(e,0,t)}function qy(e,t){return Ky(e,1,n=>t(n.toJSON()))}function Sc(e){return Mn(e)}let Xy=!1;const Zr=cC(Ir),Or=Lo("modem",["second"],e=>{switch(e.target){case"second":!Xy&&e.data%2===0&&Or.emit("modem:join");break;case"join":if(e.sender!==Or.id()){Or.reply(e,"joinack");const t=Vr();TC(t,Zr),Or.reply(e,"sync",Sc(t));const n=Vr();Wy(n,Zr),Or.reply(e,"sync",Sc(n))}break;case"joinack":Xy=!0;break;case"sync":{if(S(e.data)&&e.sender!==Or.id()){const t=Ei(e.data),n=Vr();OC(t,n,Zr,Or)===Uf&&Or.emit("modem:sync",Sc(n))}break}}});function Jy(e){const t=Vr();RC(t,e),Or.emit("modem:sync",Sc(t))}Zr.on("update",Jy),Zr.on("destroy",()=>{Zr==null||Zr.off("update",Jy)});const UC=navigator.userAgent.includes("Mac")?"cmd":"ctrl",Yr="$dkpurple",PC="$196",DC="$205";function ln(e,t){return`$${e}${t}$blue`}function Zy(e,t){return`$${e}${t}$ondkblue`}function nt(e,t){yt(e,t)}function BC(e,t){const n=PC.repeat(t);nt(e,`${Yr}${n}`)}function Pf(e,t){const n=DC.repeat(t);nt(e,`${Yr}${n}`)}function wo(e,t){nt(e,`${Yr} ${" ".repeat(t.length)} `),BC(e,t.length+2),nt(e,`${Yr} $white${t} `),Pf(e,t.length+2)}function Nr(e,t){nt(e,`${Yr} ${" ".repeat(t.length)} `),nt(e,`${Yr} $gray${t} `),Pf(e,t.length+2)}function De(e,t,n){nt(e,`${Yr} $white${t} $blue${n}`)}function Be(e,t){nt(e,`${Yr}$blue${t}`)}const FC=cr().command("send",(e,t)=>{const[n,r]=re(t,0,[q.STRING,q.ANY]);switch(n){case"helpmenu":wo("cli","H E L P"),De("cli","#help controls","zss controls and inputs"),nt("cli","!helpcontrols;read help controls"),nt("cli",""),De("cli","#help text","text formatting"),nt("cli","!helptext;read help text"),nt("cli",""),De("cli","#help developer","developer commands"),nt("cli","!helpdeveloper;read help developer"),nt("cli",""),De("cli","#help player","player settings"),nt("cli","!helpplayer;read help player"),Nr("cli","keyboard input"),De("cli","?","open console"),De("cli","esc","close console"),De("cli","tab","move console"),De("cli","up / down arrow keys","navigate console items"),De("cli","left / right arrow keys","change console items"),De("cli","enter","interact with console items"),De("cli","alt + arrow keys","skip words and console lines"),De("cli",`${UC} + up / down arrow keys`,"input history");break;case"helpcontrols":wo("cli","zss controls and inputs"),Nr("cli","keyboard input"),De("cli","arrow keys","move"),De("cli","shift + arrow keys","shoot"),De("cli","enter","ok / accept"),De("cli","escape","cancel / close"),De("cli","tab","menu / action"),Nr("cli","mouse input"),Be("cli","todo ???"),Nr("cli","controller input"),De("cli","left stick","move"),De("cli","right stick","aim"),De("cli","a","ok / accept"),De("cli","b","cancel / close"),De("cli","y","menu / action"),De("cli","x","shoot"),De("cli","triggers","shoot");break;case"helptext":wo("cli","text formatting"),Nr("cli","typography"),Be("cli","plain text"),Be("cli","$centering text"),Be("cli",'"\\"@quoted strings for special chars\\""'),Be("cli","$$0-255 for ascii chars $159$176$240"),Be("cli",`use color names like ${ln("red","$$red")} to change foreground color`),Be("cli",`use color names like ${Zy("ongreen","$$ongreen")} to change background color`),Be("cli",`use clear ${Zy("onclear","to change background to")} transparent`),Nr("cli","hyperlinks"),Be("cli",`${ln("white",'"!hotkey"')} message shortcut;${ln("gray","Label")}`),Be("cli",`${ln("white",'"!range"')} flag [labelmin] [labelmax];${ln("gray","Input Label")}`),Be("cli",`${ln("white",'"!select"')} flag ...list of values;${ln("gray","Input Label")}`),Be("cli",`${ln("white",'"!number"')} flag [minvalue] [maxvalue];${ln("gray","Input Label")}`),Be("cli",`${ln("white",'"!text"')} flag;${ln("gray","Input Label")}`),Be("cli",`${ln("white",'"!copyit"')} flag;${ln("gray","Input Label")}`);break;case"helpdeveloper":wo("cli","developer commands"),De("cli","#books","list books in memory"),De("cli","#pages","list pages in opened book"),De("cli","@[pagetype:]page name","create & edit a new codepage in the currently opened book"),De("cli","#trash","list books and pages from open book you can delete"),De("cli","#save","flush state to register");break;case"helpplayer":wo("cli","player settings"),Be("cli","todo");break;default:yt("$2",`${n} ${r??""}`);break}return 0}).command("stat",(e,t)=>{let n;const[r,...i]=t.map(Nt),s=i.join(" ");switch(Pe(r)){case En(fe.LOADER):n=Mi(Je.CONTENT,s,Ae.LOADER);break;default:n=Mi(Je.CONTENT,[r,...i].join(" "),Ae.OBJECT);break;case En(fe.BOARD):n=Mi(Je.CONTENT,s,Ae.BOARD);break;case En(fe.OBJECT):n=Mi(Je.CONTENT,s,Ae.OBJECT);break;case En(fe.TERRAIN):n=Mi(Je.CONTENT,s,Ae.TERRAIN);break;case En(fe.CHARSET):n=Mi(Je.CONTENT,s,Ae.CHARSET);break;case En(fe.PALETTE):n=Mi(Je.CONTENT,s,Ae.PALETTE);break}return S(n)&&e.command("pageopen",n.id),0}).command("text",(e,t)=>{const n=t.map(Nt).join(" ");return yt("$2",n),0}).command("hyperlink",(e,t)=>{const[n,...r]=t,i=Nt(n),s=r.map(Nt).join(" ");return yt("$2",`!${s};${i}`),0}).command("dev",()=>(ni("cli"),Ab("cli",D.player),0)).command("share",()=>(ni("cli"),Tb("cli",D.player),0)).command("bookcreate",(e,t)=>{const[n]=re(t,0,[q.MAYBE_STRING]),r=L_(n);return S(r)&&e.command("bookopen",r.id),0}).command("bookopen",(e,t)=>{const[n]=re(t,0,[q.STRING]),r=ti(n);return S(r)?(Be("cli",`opened [book] ${r.name}`),Uc(Je.MAIN,r.id),e.command("pages")):Qe("cli","bookopen",`book ${n} not found`,D.player),0}).command("booktrash",(e,t)=>{const[n]=re(t,0,[q.STRING]),r=nn(Je.MAIN),i=ti(n);return S(i)&&(r===i&&Uc(Je.MAIN,""),AM(n),Be("cli",`trashed [book] ${i.name}`),ni("cli"),e.command("pages")),0}).command("pageopen",(e,t)=>{const[n]=re(t,0,[q.STRING]),r=Dn(Je.MAIN);if(!S(r))return 0;const i=_i(r,n);if(S(i)){const s=Jn(i),o=Xs(i);Be("cli",`opened [${o}] ${s}`),Vy(hh(r.id,i.id),i.code);const a=Xs(i);Lb("cli",r.id,i.id,a,`${s} - ${r.name}`,D.player)}else Qe("cli","pageopen",`page ${n} not found`,D.player);return 0}).command("pagetrash",(e,t)=>{const[n]=re(t,0,[q.STRING]),r=Dn(Je.MAIN),i=aI(r,n);if(S(n)){const s=Jn(i),o=Xs(i);Be("cli",`trashed [${o}] ${s}`),ni("cli"),e.command("pages")}return 0}).command("nodetrash",()=>(Ib("cli"),Be("cli","node id changed, refreshing page recommended"),0)).command("help",(e,t)=>{const n=t.map(Nt).join(" ")||"menu";return e.command(`help${n}`),0}).command("books",()=>{Nr("cli","books");const e=nn(Je.MAIN);De("cli","main",`${(e==null?void 0:e.name)??"empty"} $GREEN${(e==null?void 0:e.id)??""}`);const t=nn(Je.CONTENT);De("cli","content",`${(t==null?void 0:t.name)??"empty"} ${(t==null?void 0:t.id)??""}`),Pf("cli",7);const n=Mc();return n.length?n.forEach(r=>{nt("cli",`!bookopen ${r.id};${r.name}`)}):Be("cli","no books found"),nt("cli","!bookcreate;create a new book"),0}).command("pages",()=>{Nr("cli","pages");const e=Dn(Je.MAIN);return S(e)&&(De("cli","main",`${e.name} $GREEN${e.id}`),e.pages.length?e.pages.forEach(t=>{const n=Jn(t),r=Xs(t);nt("cli",`!pageopen ${t.id};[${r}] ${n}`)}):(nt("cli",""),Be("cli","no pages found"),Be("cli","use @ to create a page"),Be("cli","@board name of board"),Be("cli","@object name of object"),Be("cli","@terrain name of terrain"),Be("cli","You can omit the type and it will default to object"),Be("cli","@object name of object"),Be("cli","@name of object"))),0}).command("trash",()=>{Nr("cli","$REDTRASH"),Be("cli","books");const e=Mc();e.length&&(e.forEach(n=>{nt("cli",`!booktrash ${n.id};$REDTRASH ${n.name}`)}),nt("cli",""));const t=nn(Je.MAIN);return S(t)&&(Be("cli",`pages in open ${t.name} book`),t.pages.forEach(n=>{const r=Jn(n);nt("cli",`!pagetrash ${n.id};$REDTRASH ${r}`)}),nt("cli","")),0}).command("save",()=>(ni("cli"),0)).command("nuke",()=>(Rb("cli"),0));function $C(e){const t=vh[e];if(S(t))return t;const n=Ah[e];if(S(n))return n;const r=$o[e];if(S(r))return r;const i=xh[e];if(S(i))return i}const jC=cr({get(e,t){const n=$C(t);return S(n)?[!0,n]:[!1,void 0]}}),zC=new Set(["inputmove","inputalt","inputctrl","inputshift","inputok","inputcancel","inputmenu"]),Yy=new Set(["player","pushable","collision","destructible","p1","p2","p3","cycle","stepx","stepy","sender","arg"]),WC=["NORTH","SOUTH","WEST","EAST"];function GC(){const e=ps(D.player);if(We(e.inputqueue)||(e.inputqueue=[],e.inputcurrent=0),ke(e.inputcurrent)&&e.inputcurrent>0)return;const[t]=e.inputqueue,[n=Ft.NONE,r=0]=t??[Ft.NONE,0];switch(e.inputmove=[],e.inputok=0,e.inputcancel=0,e.inputmenu=0,e.inputalt=r&bb?1:0,e.inputctrl=r&wb?1:0,e.inputshift=r&vb?1:0,n){case Ft.MOVE_UP:case Ft.MOVE_DOWN:case Ft.MOVE_LEFT:case Ft.MOVE_RIGHT:e.inputmove=[WC[n-Ft.MOVE_UP]];break;case Ft.OK_BUTTON:e.inputok=1;break;case Ft.CANCEL_BUTTON:e.inputcancel=1;break;case Ft.MENU_BUTTON:e.inputmenu=1;break}e.inputcurrent=n,e.inputqueue=e.inputqueue.filter(i=>{const[s]=i;return s!==Ft.NONE&&s!==n})}const HC=cr({get(e,t){var s;D.isplayer&&zC.has(t)&&GC();const n=(s=D.element)==null?void 0:s[t];if(S(n)||Yy.has(t))return[!0,n];const i=ps(D.player)[t];return[S(i),i]},set(e,t,n){var s;const r=(s=D.element)==null?void 0:s[t];if(S(r)||Yy.has(t))return S(D.element)&&(D.element[t]=n),[!0,n];const i=ps(D.player);return i[t]=n,[!0,n]},everytick(e){var t,n;S((t=D.element)==null?void 0:t.x)&&S(D.element.y)&&S(D.element.stepx)&&S(D.element.stepy)&&Bg(e,D.book,D.board,D.element,{x:D.element.x+D.element.stepx,y:D.element.y+D.element.stepy})===!1&&(D.element.stepx=0,D.element.stepy=0),(n=D.element)!=null&&n.headless&&e.command("die")}}).command("become",(e,t)=>{var i,s;const n={x:((i=D.element)==null?void 0:i.x)??0,y:((s=D.element)==null?void 0:s.y)??0},[r]=re(t,0,[q.KIND]);return Ga(D.book,D.board),Zs(D.book,D.board,D.element),Du(D.book,D.element,D.timestamp)&&Bu(D.book,D.board,r,n),e.endofprogram(),0}).command("bind",()=>0).command("char",(e,t)=>{const[n]=re(t,0,[q.NUMBER]);return S(D.element)&&(D.element.char=n),0}).command("color",(e,t)=>{const[n]=re(t,0,[q.COLOR]);return S(D.element)&&S(n)&&Zo(D.element,n),0}).command("go",(e,t)=>{if(S(D.element)){const[n]=re(t,0,[q.DIR]);if(Bg(e,D.book,D.board,D.element,n),e.yield(),D.element.x===n.x&&D.element.y===n.y)return 0}return 1}).command("try",(e,t)=>{const[,n]=re(t,0,[q.DIR]);return e.command("go",...t)&&n<t.length&&e.command(...t.slice(n)),0}).command("walk",(e,t)=>{if(!S(D.element))return 0;const[n]=re(t,0,[q.DIR]),r=D.element.x??0,i=D.element.y??0;return D.element.stepx=n.x-r,D.element.stepy=n.y-i,0}),VC=cr().command("clear",(e,t)=>(t.forEach(n=>e.set(Nt(n),0)),0)).command("set",(e,t)=>{const[n,r]=re(t,0,[q.STRING,q.ANY]);return e.set(n,r),0}).command("take",(e,t)=>{const[n,r,i]=re(t,0,[q.STRING,q.MAYBE_NUMBER]),s=e.get(n),o=r??1;if(!ke(s))return 1;const a=s-o;return a<0?(i<t.length&&e.command(...t.slice(i)),1):(e.set(n,a),0)}).command("give",(e,t)=>{const[n,r,i]=re(t,0,[q.STRING,q.MAYBE_NUMBER]),s=e.get(n),o=ke(s)?s:0,a=r??1;if(!ke(a))return 0;const c=s===void 0?1:0;return c&&i<t.length&&e.command(...t.slice(i)),e.set(n,o+a),c});var Qy={exports:{}};/*! Case - v1.6.2 - 2020-03-24
* Copyright (c) 2020 Nathan Bubna; Licensed MIT, GPL */(function(e){(function(){var t=function(h,p){return p=p||"",h.replace(/(^|-)/g,"$1\\u"+p).replace(/,/g,"\\u"+p)},n=t("20-26,28-2F,3A-40,5B-60,7B-7E,A0-BF,D7,F7","00"),r="a-z"+t("DF-F6,F8-FF","00"),i="A-Z"+t("C0-D6,D8-DE","00"),s="A|An|And|As|At|But|By|En|For|If|In|Of|On|Or|The|To|Vs?\\.?|Via",o=function(h,p,m,b){return h=h||n,p=p||r,m=m||i,b=b||s,{capitalize:new RegExp("(^|["+h+"])(["+p+"])","g"),pascal:new RegExp("(^|["+h+"])+(["+p+m+"])","g"),fill:new RegExp("["+h+"]+(.|$)","g"),sentence:new RegExp('(^\\s*|[\\?\\!\\.]+"?\\s+"?|,\\s+")(['+p+"])","g"),improper:new RegExp("\\b("+b+")\\b","g"),relax:new RegExp("([^"+m+"])(["+m+"]*)(["+m+"])(?=[^"+m+"]|$)","g"),upper:new RegExp("^[^"+p+"]+$"),hole:/[^\s]\s[^\s]/,apostrophe:/'/g,room:new RegExp("["+h+"]")}},a=o(),c={re:a,unicodes:t,regexps:o,types:[],up:String.prototype.toUpperCase,low:String.prototype.toLowerCase,cap:function(h){return c.up.call(h.charAt(0))+h.slice(1)},decap:function(h){return c.low.call(h.charAt(0))+h.slice(1)},deapostrophe:function(h){return h.replace(a.apostrophe,"")},fill:function(h,p,m){return p!=null&&(h=h.replace(a.fill,function(b,_){return _?p+_:""})),m&&(h=c.deapostrophe(h)),h},prep:function(h,p,m,b){if(h=h==null?"":h+"",!b&&a.upper.test(h)&&(h=c.low.call(h)),!p&&!a.hole.test(h)){var _=c.fill(h," ");a.hole.test(_)&&(h=_)}return!m&&!a.room.test(h)&&(h=h.replace(a.relax,c.relax)),h},relax:function(h,p,m,b){return p+" "+(m?m+" ":"")+b}},l={_:c,of:function(h){for(var p=0,m=c.types.length;p<m;p++)if(l[c.types[p]].apply(l,arguments)===h)return c.types[p]},flip:function(h){return h.replace(/\w/g,function(p){return(p==c.up.call(p)?c.low:c.up).call(p)})},random:function(h){return h.replace(/\w/g,function(p){return(Math.round(Math.random())?c.up:c.low).call(p)})},type:function(h,p){l[h]=p,c.types.push(h)}},u={lower:function(h,p,m){return c.fill(c.low.call(c.prep(h,p)),p,m)},snake:function(h){return l.lower(h,"_",!0)},constant:function(h){return l.upper(h,"_",!0)},camel:function(h){return c.decap(l.pascal(h))},kebab:function(h){return l.lower(h,"-",!0)},upper:function(h,p,m){return c.fill(c.up.call(c.prep(h,p,!1,!0)),p,m)},capital:function(h,p,m){return c.fill(c.prep(h).replace(a.capitalize,function(b,_,w){return _+c.up.call(w)}),p,m)},header:function(h){return l.capital(h,"-",!0)},pascal:function(h){return c.fill(c.prep(h,!1,!0).replace(a.pascal,function(p,m,b){return c.up.call(b)}),"",!0)},title:function(h){return l.capital(h).replace(a.improper,function(p,m,b,_){return b>0&&b<_.lastIndexOf(" ")?c.low.call(p):p})},sentence:function(h,p,m){return h=l.lower(h).replace(a.sentence,function(b,_,w){return _+c.up.call(w)}),p&&p.forEach(function(b){h=h.replace(new RegExp("\\b"+l.lower(b)+"\\b","g"),c.cap)}),m&&m.forEach(function(b){h=h.replace(new RegExp("(\\b"+l.lower(b)+"\\. +)(\\w)"),function(_,w,v){return w+c.low.call(v)})}),h}};u.squish=u.pascal,l.default=l;for(var f in u)l.type(f,u[f]);var d=typeof d=="function"?d:function(){};d(e.exports?e.exports=l:this.Case=l)}).call(Bt)})(Qy);var KC=Qy.exports,qC=Pi(KC);const Qr={};function Df(e){return{player:e,layers:[],panels:[],reset:!0,focus:"scroll"}}function e_(e){e.text=[],Object.values(Qr[e.id]??{}).forEach(t=>t==null?void 0:t()),Qr[e.id]={}}function t_(e){const t=e.panels.find(n=>n.name===e.focus);if(!t){const n={id:gt(),name:e.focus,edge:un.RIGHT,size:20,text:[]};return e.panels.push(n),e.reset=!1,n}return t}const XC=new Set(["hk","hotkey","rn","range","sl","select","nm","number","tx","text"]),JC=new Set(["rn","range","sl","select","nm","number","tx","text"]),ZC=new Set(["tx","text"]),YC={rn:1,range:1,sl:0,select:0,nm:0,number:0,tx:"",text:""},n_={};let r_=e=>{let t=n_[e];return S(t)||(n_[e]=t=Df(e)),t};function QC(e){r_=e}function Ii(e){return r_(e)}function eL(e){const t=Ii(e);t.panels=t.panels.filter(n=>n.edge!==un.SCROLL)}function tL(e,t,n){Object.values(Qr).forEach(r=>{if(r[t]!==void 0){const i=uh(e.id(),t);ke(n)&&CC(i,n),Ce(n)&&LC(i,n)}})}function nL(e){let t="";const n=Ii(e);return n.panels=n.panels.filter(r=>{if(r.edge===un.SCROLL){const[i]=r.text;return Ce(i)&&r.text.length===1&&(t=i),r.text.length>1}return!0}),t}function Bf(e,t,n,r,i){const s=Ii(e),o=r,a=i??qC.capital(t),c=s.panels.find(l=>l.name===a);if(c)s.reset=!0,s.focus=a,ke(o)&&(c.size=o);else switch(n){case un.START:break;case un.LEFT:case un.RIGHT:case un.TOP:case un.BOTTOM:case un.SCROLL:{const l={id:gt(),name:a,edge:n,size:o??_b[n],text:[]};s.panels.push(l),s.focus=a;break}}}function rL(e,t){const n=Ii(e),r=t_(n);n.reset&&(n.reset=!1,e_(r)),r.text.push(t)}function iL(e,t,n,r,i){const s=Ii(e),o=t_(s);s.reset&&(s.reset=!1,e_(o));const a=Pe(r),c=[t.id(),n,...XC.has(a)?[a]:["hyperlink",r],...i],l=c[2];if(JC.has(l)){const u=`${c[3]??""}`;Qr[o.id]=Qr[o.id]??{};const f=t.get(u)??YC[l];if(Qr[o.id][u]===void 0){const d=uh(t.id(),u);ke(f)&&NC(d,f),Ce(f)&&Vy(d,f),ZC.has(l)?Qr[o.id][u]=qy(d,h=>{S(h)&&h!==t.get(u)&&t.set(u,h)}):Qr[o.id][u]=MC(d,h=>{S(h)&&h!==t.get(u)&&t.set(u,h)})}}o.text.push(c)}const sL=cr({get(){return[!1,void 0]},set(e,t,n){return tL(e,t,n),[!1,void 0]},tick(){var t;const e=((t=D.element)==null?void 0:t.name)??"scroll";Bf(D.player,"scroll",un.SCROLL,void 0,e)},everytick(){const e=nL(D.player);if(e&&S(D.element)){D.element.tickertext=e,D.element.tickertime=D.timestamp;const t=Mg(D.book,D.element);yt(`$${be[t.color]}$${t.char}`,e)}}}).command("send",(e,t)=>{var u,f;const[n,r]=re(t,0,[q.STRING,q.ANY]),[i,s]=n.split(":"),o=S(s)?i:"self",a=s??i;function c(d){d.forEach(h=>{S(h.id)&&e.send(h.id,a,r)})}const l=Pe(o);switch(l){case"all":for(const d of Object.keys(((u=D.board)==null?void 0:u.objects)??{}))e.send(d,a,r);break;case"self":e.message({id:gt(),sender:e.id(),target:a,data:r});break;case"others":for(const d of Object.keys(((f=D.board)==null?void 0:f.objects)??{}))d!==e.id()&&e.send(d,a,r);break;default:{c(tl(D.board,[o]));const d=e.get(l);We(d)?c(tl(D.board,d)):c(tl(D.board,[d]));break}}return 0}).command("stat",(e,t)=>{const n=Tg(t.map(Nt));switch(n.type){case fe.OBJECT:S(D.element)&&(D.element.name=n.values.join(" "));break}return 0}).command("text",(e,t)=>{const n=t.map(Nt).join("");return rL(D.player,n),0}).command("hyperlink",(e,t)=>{const[n,r,...i]=t,s=Nt(n),o=Nt(r);return iL(D.player,e,s,o,i),0}).command("gadget",(e,t)=>{const[n]=re(t,0,[q.STRING]),r=yb[Pe(n)];if(r===un.SCROLL){const[,i,s]=re(t,0,[q.STRING,q.MAYBE_STRING,q.MAYBE_NUMBER]);Bf(D.player,n,r,s,i)}else{const[,i,s]=re(t,0,[q.STRING,q.MAYBE_NUMBER,q.MAYBE_STRING]);Bf(D.player,n,r,i,s)}return 0}),oL=cr().command("idle",e=>(e.yield(),0)).command("end",e=>(e.endofprogram(),0)).command("endwith",(e,t)=>{const[n]=re(t,0,[q.ANY]);return e.set("arg",n),e.command("end")}).command("lock",e=>(e.lock(e.id()),0)).command("restore",(e,t)=>(e.restore(Nt(t[0])),0)).command("unlock",e=>(e.unlock(),0)).command("zap",(e,t)=>(e.zap(Nt(t[0])),0)).command("cycle",(e,t)=>{if(S(D.element)){const[n]=re(t,0,[q.NUMBER]);D.element.cycle=si(Math.round(n),1,255)}return 0}).command("die",e=>{var t;return(t=D.element)!=null&&t.headless&&Zs(D.book,D.board,D.element),Du(D.book,D.element,D.timestamp),e.endofprogram(),0}).command("endgame",()=>(Mb("element",D.player),0)).command("run",(e,t)=>{const[n]=re(t,0,[q.STRING]);return B_(n),0}).command("runwith",(e,t)=>{const[n,r]=re(t,0,[q.ANY,q.STRING]);return e.set("arg",n),B_(r),0});function i_(e,t){if(!S(e))return;const n=Pe(t),r=n.endsWith("le");switch(n){case"float32":case"float32le":{const i=e.dataview.getFloat32(e.cursor,r);return e.cursor+=4,i}case"float64":case"float64le":{const i=e.dataview.getFloat64(e.cursor,r);return e.cursor+=8,i}case"int8":case"int8le":{const i=e.dataview.getInt8(e.cursor);return e.cursor+=1,i}case"int16":case"int16le":{const i=e.dataview.getInt16(e.cursor,r);return e.cursor+=2,i}case"int32":case"int32le":{const i=e.dataview.getInt32(e.cursor,r);return e.cursor+=4,i}case"int64":case"int64le":{const i=e.dataview.getBigInt64(e.cursor,r);return e.cursor+=8,i}case"uint8":case"uint8le":{const i=e.dataview.getUint8(e.cursor);return e.cursor+=1,i}case"uint16":case"uint16le":{const i=e.dataview.getUint16(e.cursor,r);return e.cursor+=2,i}case"uint32":case"uint32le":{const i=e.dataview.getUint32(e.cursor,r);return e.cursor+=4,i}case"uint64":case"uint64le":{const i=e.dataview.getBigUint64(e.cursor,r);return e.cursor+=8,i}}}const aL=(e,t)=>{const n=F_(e.id());if(!S(n))return 0;const[r]=re(t,0,[q.STRING]),i=Pe(r);switch(i){case"seek":{const[s]=re(t,1,[q.NUMBER]);n.cursor=s;break}case"float32":case"float32le":case"float64":case"float64le":case"int8":case"int8le":case"int16":case"int16le":case"int32":case"int32le":case"int64":case"int64le":case"uint8":case"uint8le":case"uint16":case"uint16le":case"uint32":case"uint32le":case"uint64":case"uint64le":{const[s]=re(t,1,[q.STRING]);e.set(s,i_(n,i));break}case"text":{const[s,o]=re(t,1,[q.STRING,q.STRING]),a=i_(n,s);if(ke(a)&&Ce(o)){const c=new Uint8Array(n.bytes.buffer,n.cursor,a),u=new TextDecoder("utf-8").decode(c);e.set(o,u),n.cursor+=a}break}}return 0},cL=cr({get(e,t){const n=F_(e.id());if(S(n))switch(Pe(t)){case"filename":return[S(n.filename),n.filename];case"cursor":return[S(n.cursor),n.cursor]}return[!1,void 0]}}).command("send",(e,t)=>{const[n,r]=re(t,0,[q.STRING,q.ANY]);return e.message({id:gt(),sender:e.id(),target:n,data:r}),0}).command("stat",()=>0).command("text",(e,t)=>{const n=t.map(Nt).join(" ");return yt("$2",n),0}).command("hyperlink",(e,t)=>{const[n,...r]=t,i=Nt(n),s=r.map(Nt).join(" ");return yt("$2",`!${s};${i}`),0}).command("load",(e,t)=>{const n=t.map(Nt).join(" "),r=e.get(n)??n;return Dn(Je.CONTENT,r),0}).command("reload",(e,t)=>{const n=t.map(Nt).join(" "),r=e.get(n)??n,i=Dn(Je.CONTENT,r);return i.pages=[],0}).command("bin",aL);var vo=(e=>(e[e.ERROR=0]="ERROR",e[e.CLI=1]="CLI",e[e.LOADER=2]="LOADER",e[e.CODE_PAGE=3]="CODE_PAGE",e))(vo||{});const lL={audio:vv,board:gI,cli:FC,const:jC,element:HC,flags:VC,gadget:sL,lifecycle:oL,loader:cL},Ff=["const","flags","audio","board","lifecycle","element"],uL={0:[],1:["cli",...Ff],2:["loader",...Ff],3:["gadget",...Ff]},fL={0:new Map,1:new Map,2:new Map,3:new Map};function Eo(e){return(uL[e]??[]).map(n=>lL[n]).filter(S)}function hL(e,t){const n=fL[e];if(!n.has(t)){let r;const i=Eo(e);for(let s=0;s<i.length&&(r=i[s].getcommand(t),!S(r));++s);n.set(t,r)}return n.get(t)}function dL(e,t,n){const r=Eo(e);for(let i=0;i<r.length;++i){const[s,o]=r[i].get(t,n);if(s)return[s,o]}return[!1,void 0]}function pL(e,t,n,r){const i=Eo(e);for(let s=0;s<i.length;++s){const[o]=i[s].set(t,n,r);if(o)return[o,r]}return[!1,void 0]}function mL(e,t){const n=Eo(e);for(let r=0;r<n.length;++r)n[r].tick(t)}function s_(e,t){const n=Eo(e);for(let r=0;r<n.length;++r)n[r].everytick(t)}var o_={},a_={},c_={};const l_="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".split("");c_.encode=function(e){if(0<=e&&e<l_.length)return l_[e];throw new TypeError("Must be between 0 and 63: "+e)};const gL=c_,u_=5,f_=1<<u_,yL=f_-1,_L=f_;function bL(e){return e<0?(-e<<1)+1:(e<<1)+0}a_.encode=function(t){let n="",r,i=bL(t);do r=i&yL,i>>>=u_,i>0&&(r|=_L),n+=gL.encode(r);while(i>0);return n};var ko={};(function(e){function t(I,T,L){if(T in I)return I[T];if(arguments.length===3)return L;throw new Error('"'+T+'" is a required argument.')}e.getArg=t;const n=/^(?:([\w+\-.]+):)?\/\/(?:(\w+:\w+)@)?([\w.-]*)(?::(\d+))?(.*)$/,r=/^data:.+\,.+$/;function i(I){const T=I.match(n);return T?{scheme:T[1],auth:T[2],host:T[3],port:T[4],path:T[5]}:null}e.urlParse=i;function s(I){let T="";return I.scheme&&(T+=I.scheme+":"),T+="//",I.auth&&(T+=I.auth+"@"),I.host&&(T+=I.host),I.port&&(T+=":"+I.port),I.path&&(T+=I.path),T}e.urlGenerate=s;const o=32;function a(I){const T=[];return function(L){for(let V=0;V<T.length;V++)if(T[V].input===L){const se=T[0];return T[0]=T[V],T[V]=se,T[0].result}const x=I(L);return T.unshift({input:L,result:x}),T.length>o&&T.pop(),x}}const c=a(function(T){let L=T;const x=i(T);if(x){if(!x.path)return T;L=x.path}const V=e.isAbsolute(L),se=[];let O=0,E=0;for(;;)if(O=E,E=L.indexOf("/",O),E===-1){se.push(L.slice(O));break}else for(se.push(L.slice(O,E));E<L.length&&L[E]==="/";)E++;let g=0;for(E=se.length-1;E>=0;E--){const N=se[E];N==="."?se.splice(E,1):N===".."?g++:g>0&&(N===""?(se.splice(E+1,g),g=0):(se.splice(E,2),g--))}return L=se.join("/"),L===""&&(L=V?"/":"."),x?(x.path=L,s(x)):L});e.normalize=c;function l(I,T){I===""&&(I="."),T===""&&(T=".");const L=i(T),x=i(I);if(x&&(I=x.path||"/"),L&&!L.scheme)return x&&(L.scheme=x.scheme),s(L);if(L||T.match(r))return T;if(x&&!x.host&&!x.path)return x.host=T,s(x);const V=T.charAt(0)==="/"?T:c(I.replace(/\/+$/,"")+"/"+T);return x?(x.path=V,s(x)):V}e.join=l,e.isAbsolute=function(I){return I.charAt(0)==="/"||n.test(I)};function u(I,T){I===""&&(I="."),I=I.replace(/\/$/,"");let L=0;for(;T.indexOf(I+"/")!==0;){const x=I.lastIndexOf("/");if(x<0||(I=I.slice(0,x),I.match(/^([^\/]+:\/)?\/*$/)))return T;++L}return Array(L+1).join("../")+T.substr(I.length+1)}e.relative=u;const f=function(){return!("__proto__"in Object.create(null))}();function d(I){return I}function h(I){return m(I)?"$"+I:I}e.toSetString=f?d:h;function p(I){return m(I)?I.slice(1):I}e.fromSetString=f?d:p;function m(I){if(!I)return!1;const T=I.length;if(T<9||I.charCodeAt(T-1)!==95||I.charCodeAt(T-2)!==95||I.charCodeAt(T-3)!==111||I.charCodeAt(T-4)!==116||I.charCodeAt(T-5)!==111||I.charCodeAt(T-6)!==114||I.charCodeAt(T-7)!==112||I.charCodeAt(T-8)!==95||I.charCodeAt(T-9)!==95)return!1;for(let L=T-10;L>=0;L--)if(I.charCodeAt(L)!==36)return!1;return!0}function b(I,T,L){let x=w(I.source,T.source);return x!==0||(x=I.originalLine-T.originalLine,x!==0)||(x=I.originalColumn-T.originalColumn,x!==0||L)||(x=I.generatedColumn-T.generatedColumn,x!==0)||(x=I.generatedLine-T.generatedLine,x!==0)?x:w(I.name,T.name)}e.compareByOriginalPositions=b;function _(I,T,L){let x=I.generatedLine-T.generatedLine;return x!==0||(x=I.generatedColumn-T.generatedColumn,x!==0||L)||(x=w(I.source,T.source),x!==0)||(x=I.originalLine-T.originalLine,x!==0)||(x=I.originalColumn-T.originalColumn,x!==0)?x:w(I.name,T.name)}e.compareByGeneratedPositionsDeflated=_;function w(I,T){return I===T?0:I===null?1:T===null?-1:I>T?1:-1}function v(I,T){let L=I.generatedLine-T.generatedLine;return L!==0||(L=I.generatedColumn-T.generatedColumn,L!==0)||(L=w(I.source,T.source),L!==0)||(L=I.originalLine-T.originalLine,L!==0)||(L=I.originalColumn-T.originalColumn,L!==0)?L:w(I.name,T.name)}e.compareByGeneratedPositionsInflated=v;function k(I){return JSON.parse(I.replace(/^\)]}'[^\n]*\n/,""))}e.parseSourceMapInput=k;function C(I,T,L){if(T=T||"",I&&(I[I.length-1]!=="/"&&T[0]!=="/"&&(I+="/"),T=I+T),L){const x=i(L);if(!x)throw new Error("sourceMapURL could not be parsed");if(x.path){const V=x.path.lastIndexOf("/");V>=0&&(x.path=x.path.substring(0,V+1))}T=l(s(x),T)}return c(T)}e.computeSourceURL=C})(ko);var $f={};let wL=class K_{constructor(){this._array=[],this._set=new Map}static fromArray(t,n){const r=new K_;for(let i=0,s=t.length;i<s;i++)r.add(t[i],n);return r}size(){return this._set.size}add(t,n){const r=this.has(t),i=this._array.length;(!r||n)&&this._array.push(t),r||this._set.set(t,i)}has(t){return this._set.has(t)}indexOf(t){const n=this._set.get(t);if(n>=0)return n;throw new Error('"'+t+'" is not in the set.')}at(t){if(t>=0&&t<this._array.length)return this._array[t];throw new Error("No element indexed by "+t)}toArray(){return this._array.slice()}};$f.ArraySet=wL;var h_={};const d_=ko;function vL(e,t){const n=e.generatedLine,r=t.generatedLine,i=e.generatedColumn,s=t.generatedColumn;return r>n||r==n&&s>=i||d_.compareByGeneratedPositionsInflated(e,t)<=0}let EL=class{constructor(){this._array=[],this._sorted=!0,this._last={generatedLine:-1,generatedColumn:0}}unsortedForEach(t,n){this._array.forEach(t,n)}add(t){vL(this._last,t)?(this._last=t,this._array.push(t)):(this._sorted=!1,this._array.push(t))}toArray(){return this._sorted||(this._array.sort(d_.compareByGeneratedPositionsInflated),this._sorted=!0),this._array}};h_.MappingList=EL;const So=a_,dt=ko,Ac=$f.ArraySet,kL=h_.MappingList;let p_=class q_{constructor(t){t||(t={}),this._file=dt.getArg(t,"file",null),this._sourceRoot=dt.getArg(t,"sourceRoot",null),this._skipValidation=dt.getArg(t,"skipValidation",!1),this._sources=new Ac,this._names=new Ac,this._mappings=new kL,this._sourcesContents=null}static fromSourceMap(t){const n=t.sourceRoot,r=new q_({file:t.file,sourceRoot:n});return t.eachMapping(function(i){const s={generated:{line:i.generatedLine,column:i.generatedColumn}};i.source!=null&&(s.source=i.source,n!=null&&(s.source=dt.relative(n,s.source)),s.original={line:i.originalLine,column:i.originalColumn},i.name!=null&&(s.name=i.name)),r.addMapping(s)}),t.sources.forEach(function(i){let s=i;n!==null&&(s=dt.relative(n,i)),r._sources.has(s)||r._sources.add(s);const o=t.sourceContentFor(i);o!=null&&r.setSourceContent(i,o)}),r}addMapping(t){const n=dt.getArg(t,"generated"),r=dt.getArg(t,"original",null);let i=dt.getArg(t,"source",null),s=dt.getArg(t,"name",null);this._skipValidation||this._validateMapping(n,r,i,s),i!=null&&(i=String(i),this._sources.has(i)||this._sources.add(i)),s!=null&&(s=String(s),this._names.has(s)||this._names.add(s)),this._mappings.add({generatedLine:n.line,generatedColumn:n.column,originalLine:r!=null&&r.line,originalColumn:r!=null&&r.column,source:i,name:s})}setSourceContent(t,n){let r=t;this._sourceRoot!=null&&(r=dt.relative(this._sourceRoot,r)),n!=null?(this._sourcesContents||(this._sourcesContents=Object.create(null)),this._sourcesContents[dt.toSetString(r)]=n):this._sourcesContents&&(delete this._sourcesContents[dt.toSetString(r)],Object.keys(this._sourcesContents).length===0&&(this._sourcesContents=null))}applySourceMap(t,n,r){let i=n;if(n==null){if(t.file==null)throw new Error(`SourceMapGenerator.prototype.applySourceMap requires either an explicit source file, or the source map's "file" property. Both were omitted.`);i=t.file}const s=this._sourceRoot;s!=null&&(i=dt.relative(s,i));const o=this._mappings.toArray().length>0?new Ac:this._sources,a=new Ac;this._mappings.unsortedForEach(function(c){if(c.source===i&&c.originalLine!=null){const f=t.originalPositionFor({line:c.originalLine,column:c.originalColumn});f.source!=null&&(c.source=f.source,r!=null&&(c.source=dt.join(r,c.source)),s!=null&&(c.source=dt.relative(s,c.source)),c.originalLine=f.line,c.originalColumn=f.column,f.name!=null&&(c.name=f.name))}const l=c.source;l!=null&&!o.has(l)&&o.add(l);const u=c.name;u!=null&&!a.has(u)&&a.add(u)},this),this._sources=o,this._names=a,t.sources.forEach(function(c){const l=t.sourceContentFor(c);l!=null&&(r!=null&&(c=dt.join(r,c)),s!=null&&(c=dt.relative(s,c)),this.setSourceContent(c,l))},this)}_validateMapping(t,n,r,i){if(n&&typeof n.line!="number"&&typeof n.column!="number")throw new Error("original.line and original.column are not numbers -- you probably meant to omit the original mapping entirely and only map the generated position. If so, pass null for the original mapping instead of an object with empty or null values.");if(!(t&&"line"in t&&"column"in t&&t.line>0&&t.column>=0&&!n&&!r&&!i)){if(!(t&&"line"in t&&"column"in t&&n&&"line"in n&&"column"in n&&t.line>0&&t.column>=0&&n.line>0&&n.column>=0&&r))throw new Error("Invalid mapping: "+JSON.stringify({generated:t,source:r,original:n,name:i}))}}_serializeMappings(){let t=0,n=1,r=0,i=0,s=0,o=0,a="",c,l,u,f;const d=this._mappings.toArray();for(let h=0,p=d.length;h<p;h++){if(l=d[h],c="",l.generatedLine!==n)for(t=0;l.generatedLine!==n;)c+=";",n++;else if(h>0){if(!dt.compareByGeneratedPositionsInflated(l,d[h-1]))continue;c+=","}c+=So.encode(l.generatedColumn-t),t=l.generatedColumn,l.source!=null&&(f=this._sources.indexOf(l.source),c+=So.encode(f-o),o=f,c+=So.encode(l.originalLine-1-i),i=l.originalLine-1,c+=So.encode(l.originalColumn-r),r=l.originalColumn,l.name!=null&&(u=this._names.indexOf(l.name),c+=So.encode(u-s),s=u)),a+=c}return a}_generateSourcesContent(t,n){return t.map(function(r){if(!this._sourcesContents)return null;n!=null&&(r=dt.relative(n,r));const i=dt.toSetString(r);return Object.prototype.hasOwnProperty.call(this._sourcesContents,i)?this._sourcesContents[i]:null},this)}toJSON(){const t={version:this._version,sources:this._sources.toArray(),names:this._names.toArray(),mappings:this._serializeMappings()};return this._file!=null&&(t.file=this._file),this._sourceRoot!=null&&(t.sourceRoot=this._sourceRoot),this._sourcesContents&&(t.sourcesContent=this._generateSourcesContent(t.sources,t.sourceRoot)),t}toString(){return JSON.stringify(this.toJSON())}};p_.prototype._version=3,o_.SourceMapGenerator=p_;var m_={};(function(e){e.GREATEST_LOWER_BOUND=1,e.LEAST_UPPER_BOUND=2;function t(n,r,i,s,o,a){const c=Math.floor((r-n)/2)+n,l=o(i,s[c],!0);return l===0?c:l>0?r-c>1?t(c,r,i,s,o,a):a==e.LEAST_UPPER_BOUND?r<s.length?r:-1:c:c-n>1?t(n,c,i,s,o,a):a==e.LEAST_UPPER_BOUND?c:n<0?-1:n}e.search=function(r,i,s,o){if(i.length===0)return-1;let a=t(-1,i.length,r,i,s,o||e.GREATEST_LOWER_BOUND);if(a<0)return-1;for(;a-1>=0&&s(i[a],i[a-1],!0)===0;)--a;return a}})(m_);var Ao={exports:{}},SL={},AL=Object.freeze({__proto__:null,default:SL}),g_=X_(AL);if((function(){return typeof window<"u"&&this===window}).call()){let e=null;Ao.exports=function(){if(typeof e=="string")return fetch(e).then(n=>n.arrayBuffer());if(e instanceof ArrayBuffer)return Promise.resolve(e);throw new Error("You must provide the string URL or ArrayBuffer contents of lib/mappings.wasm by calling SourceMapConsumer.initialize({ 'lib/mappings.wasm': ... }) before using SourceMapConsumer")},Ao.exports.initialize=t=>e=t}else{const e=g_,t=g_;Ao.exports=function(){return new Promise((r,i)=>{const s=t.join(__dirname,"mappings.wasm");e.readFile(s,null,(o,a)=>{if(o){i(o);return}r(a.buffer)})})},Ao.exports.initialize=n=>{console.debug("SourceMapConsumer.initialize is a no-op when running in node.js")}}var y_=Ao.exports;const TL=y_;function xL(){this.generatedLine=0,this.generatedColumn=0,this.lastGeneratedColumn=null,this.source=null,this.originalLine=null,this.originalColumn=null,this.name=null}let To=null;var RL=function(){if(To)return To;const t=[];return To=TL().then(n=>WebAssembly.instantiate(n,{env:{mapping_callback(r,i,s,o,a,c,l,u,f,d){const h=new xL;h.generatedLine=r+1,h.generatedColumn=i,s&&(h.lastGeneratedColumn=o-1),a&&(h.source=c,h.originalLine=l+1,h.originalColumn=u,f&&(h.name=d)),t[t.length-1](h)},start_all_generated_locations_for(){console.time("all_generated_locations_for")},end_all_generated_locations_for(){console.timeEnd("all_generated_locations_for")},start_compute_column_spans(){console.time("compute_column_spans")},end_compute_column_spans(){console.timeEnd("compute_column_spans")},start_generated_location_for(){console.time("generated_location_for")},end_generated_location_for(){console.timeEnd("generated_location_for")},start_original_location_for(){console.time("original_location_for")},end_original_location_for(){console.timeEnd("original_location_for")},start_parse_mappings(){console.time("parse_mappings")},end_parse_mappings(){console.timeEnd("parse_mappings")},start_sort_by_generated_location(){console.time("sort_by_generated_location")},end_sort_by_generated_location(){console.timeEnd("sort_by_generated_location")},start_sort_by_original_location(){console.time("sort_by_original_location")},end_sort_by_original_location(){console.timeEnd("sort_by_original_location")}}})).then(n=>({exports:n.instance.exports,withMappingCallback:(r,i)=>{t.push(r);try{i()}finally{t.pop()}}})).then(null,n=>{throw To=null,n}),To};const he=ko,jf=m_,Tc=$f.ArraySet,IL=y_,OL=RL,zf=Symbol("smcInternal");class ut{constructor(t,n){return t==zf?Promise.resolve(this):CL(t,n)}static initialize(t){IL.initialize(t["lib/mappings.wasm"])}static fromSourceMap(t,n){return LL(t,n)}static async with(t,n,r){const i=await new ut(t,n);try{return await r(i)}finally{i.destroy()}}_parseMappings(t,n){throw new Error("Subclasses must implement _parseMappings")}eachMapping(t,n,r){throw new Error("Subclasses must implement eachMapping")}allGeneratedPositionsFor(t){throw new Error("Subclasses must implement allGeneratedPositionsFor")}destroy(){throw new Error("Subclasses must implement destroy")}}ut.prototype._version=3,ut.GENERATED_ORDER=1,ut.ORIGINAL_ORDER=2,ut.GREATEST_LOWER_BOUND=1,ut.LEAST_UPPER_BOUND=2;class xo extends ut{constructor(t,n){return super(zf).then(r=>{let i=t;typeof t=="string"&&(i=he.parseSourceMapInput(t));const s=he.getArg(i,"version");let o=he.getArg(i,"sources");const a=he.getArg(i,"names",[]);let c=he.getArg(i,"sourceRoot",null);const l=he.getArg(i,"sourcesContent",null),u=he.getArg(i,"mappings"),f=he.getArg(i,"file",null);if(s!=r._version)throw new Error("Unsupported version: "+s);return c&&(c=he.normalize(c)),o=o.map(String).map(he.normalize).map(function(d){return c&&he.isAbsolute(c)&&he.isAbsolute(d)?he.relative(c,d):d}),r._names=Tc.fromArray(a.map(String),!0),r._sources=Tc.fromArray(o,!0),r._absoluteSources=r._sources.toArray().map(function(d){return he.computeSourceURL(c,d,n)}),r.sourceRoot=c,r.sourcesContent=l,r._mappings=u,r._sourceMapURL=n,r.file=f,r._computedColumnSpans=!1,r._mappingsPtr=0,r._wasm=null,OL().then(d=>(r._wasm=d,r))})}_findSourceIndex(t){let n=t;if(this.sourceRoot!=null&&(n=he.relative(this.sourceRoot,n)),this._sources.has(n))return this._sources.indexOf(n);for(let r=0;r<this._absoluteSources.length;++r)if(this._absoluteSources[r]==t)return r;return-1}static fromSourceMap(t,n){return new xo(t.toString())}get sources(){return this._absoluteSources.slice()}_getMappingsPtr(){return this._mappingsPtr===0&&this._parseMappings(this._mappings,this.sourceRoot),this._mappingsPtr}_parseMappings(t,n){const r=t.length,i=this._wasm.exports.allocate_mappings(r),s=new Uint8Array(this._wasm.exports.memory.buffer,i,r);for(let a=0;a<r;a++)s[a]=t.charCodeAt(a);const o=this._wasm.exports.parse_mappings(i);if(!o){const a=this._wasm.exports.get_last_error();let c=`Error parsing mappings (code ${a}): `;switch(a){case 1:c+="the mappings contained a negative line, column, source index, or name index";break;case 2:c+="the mappings contained a number larger than 2**32";break;case 3:c+="reached EOF while in the middle of parsing a VLQ";break;case 4:c+="invalid base 64 character while parsing a VLQ";break;default:c+="unknown error code";break}throw new Error(c)}this._mappingsPtr=o}eachMapping(t,n,r){const i=n||null,s=r||ut.GENERATED_ORDER,o=this.sourceRoot;this._wasm.withMappingCallback(a=>{a.source!==null&&(a.source=this._sources.at(a.source),a.source=he.computeSourceURL(o,a.source,this._sourceMapURL),a.name!==null&&(a.name=this._names.at(a.name))),t.call(i,a)},()=>{switch(s){case ut.GENERATED_ORDER:this._wasm.exports.by_generated_location(this._getMappingsPtr());break;case ut.ORIGINAL_ORDER:this._wasm.exports.by_original_location(this._getMappingsPtr());break;default:throw new Error("Unknown order of iteration.")}})}allGeneratedPositionsFor(t){let n=he.getArg(t,"source");const r=he.getArg(t,"line"),i=t.column||0;if(n=this._findSourceIndex(n),n<0)return[];if(r<1)throw new Error("Line numbers must be >= 1");if(i<0)throw new Error("Column numbers must be >= 0");const s=[];return this._wasm.withMappingCallback(o=>{let a=o.lastGeneratedColumn;this._computedColumnSpans&&a===null&&(a=1/0),s.push({line:o.generatedLine,column:o.generatedColumn,lastColumn:a})},()=>{this._wasm.exports.all_generated_locations_for(this._getMappingsPtr(),n,r-1,"column"in t,i)}),s}destroy(){this._mappingsPtr!==0&&(this._wasm.exports.free_mappings(this._mappingsPtr),this._mappingsPtr=0)}computeColumnSpans(){this._computedColumnSpans||(this._wasm.exports.compute_column_spans(this._getMappingsPtr()),this._computedColumnSpans=!0)}originalPositionFor(t){const n={generatedLine:he.getArg(t,"line"),generatedColumn:he.getArg(t,"column")};if(n.generatedLine<1)throw new Error("Line numbers must be >= 1");if(n.generatedColumn<0)throw new Error("Column numbers must be >= 0");let r=he.getArg(t,"bias",ut.GREATEST_LOWER_BOUND);r==null&&(r=ut.GREATEST_LOWER_BOUND);let i;if(this._wasm.withMappingCallback(s=>i=s,()=>{this._wasm.exports.original_location_for(this._getMappingsPtr(),n.generatedLine-1,n.generatedColumn,r)}),i&&i.generatedLine===n.generatedLine){let s=he.getArg(i,"source",null);s!==null&&(s=this._sources.at(s),s=he.computeSourceURL(this.sourceRoot,s,this._sourceMapURL));let o=he.getArg(i,"name",null);return o!==null&&(o=this._names.at(o)),{source:s,line:he.getArg(i,"originalLine",null),column:he.getArg(i,"originalColumn",null),name:o}}return{source:null,line:null,column:null,name:null}}hasContentsOfAllSources(){return this.sourcesContent?this.sourcesContent.length>=this._sources.size()&&!this.sourcesContent.some(function(t){return t==null}):!1}sourceContentFor(t,n){if(!this.sourcesContent)return null;const r=this._findSourceIndex(t);if(r>=0)return this.sourcesContent[r];let i=t;this.sourceRoot!=null&&(i=he.relative(this.sourceRoot,i));let s;if(this.sourceRoot!=null&&(s=he.urlParse(this.sourceRoot))){const o=i.replace(/^file:\/\//,"");if(s.scheme=="file"&&this._sources.has(o))return this.sourcesContent[this._sources.indexOf(o)];if((!s.path||s.path=="/")&&this._sources.has("/"+i))return this.sourcesContent[this._sources.indexOf("/"+i)]}if(n)return null;throw new Error('"'+i+'" is not in the SourceMap.')}generatedPositionFor(t){let n=he.getArg(t,"source");if(n=this._findSourceIndex(n),n<0)return{line:null,column:null,lastColumn:null};const r={source:n,originalLine:he.getArg(t,"line"),originalColumn:he.getArg(t,"column")};if(r.originalLine<1)throw new Error("Line numbers must be >= 1");if(r.originalColumn<0)throw new Error("Column numbers must be >= 0");let i=he.getArg(t,"bias",ut.GREATEST_LOWER_BOUND);i==null&&(i=ut.GREATEST_LOWER_BOUND);let s;if(this._wasm.withMappingCallback(o=>s=o,()=>{this._wasm.exports.generated_location_for(this._getMappingsPtr(),r.source,r.originalLine-1,r.originalColumn,i)}),s&&s.source===r.source){let o=s.lastGeneratedColumn;return this._computedColumnSpans&&o===null&&(o=1/0),{line:he.getArg(s,"generatedLine",null),column:he.getArg(s,"generatedColumn",null),lastColumn:o}}return{line:null,column:null,lastColumn:null}}}xo.prototype.consumer=ut;class NL extends ut{constructor(t,n){return super(zf).then(r=>{let i=t;typeof t=="string"&&(i=he.parseSourceMapInput(t));const s=he.getArg(i,"version"),o=he.getArg(i,"sections");if(s!=r._version)throw new Error("Unsupported version: "+s);r._sources=new Tc,r._names=new Tc,r.__generatedMappings=null,r.__originalMappings=null,r.__generatedMappingsUnsorted=null,r.__originalMappingsUnsorted=null;let a={line:-1,column:0};return Promise.all(o.map(c=>{if(c.url)throw new Error("Support for url field in sections not implemented.");const l=he.getArg(c,"offset"),u=he.getArg(l,"line"),f=he.getArg(l,"column");if(u<a.line||u===a.line&&f<a.column)throw new Error("Section offsets must be ordered and non-overlapping.");return a=l,new ut(he.getArg(c,"map"),n).then(h=>({generatedOffset:{generatedLine:u+1,generatedColumn:f+1},consumer:h}))})).then(c=>(r._sections=c,r))})}get _generatedMappings(){return this.__generatedMappings||this._sortGeneratedMappings(),this.__generatedMappings}get _originalMappings(){return this.__originalMappings||this._sortOriginalMappings(),this.__originalMappings}get _generatedMappingsUnsorted(){return this.__generatedMappingsUnsorted||this._parseMappings(this._mappings,this.sourceRoot),this.__generatedMappingsUnsorted}get _originalMappingsUnsorted(){return this.__originalMappingsUnsorted||this._parseMappings(this._mappings,this.sourceRoot),this.__originalMappingsUnsorted}_sortGeneratedMappings(){const t=this._generatedMappingsUnsorted;t.sort(he.compareByGeneratedPositionsDeflated),this.__generatedMappings=t}_sortOriginalMappings(){const t=this._originalMappingsUnsorted;t.sort(he.compareByOriginalPositions),this.__originalMappings=t}get sources(){const t=[];for(let n=0;n<this._sections.length;n++)for(let r=0;r<this._sections[n].consumer.sources.length;r++)t.push(this._sections[n].consumer.sources[r]);return t}originalPositionFor(t){const n={generatedLine:he.getArg(t,"line"),generatedColumn:he.getArg(t,"column")},r=jf.search(n,this._sections,function(s,o){const a=s.generatedLine-o.generatedOffset.generatedLine;return a||s.generatedColumn-o.generatedOffset.generatedColumn}),i=this._sections[r];return i?i.consumer.originalPositionFor({line:n.generatedLine-(i.generatedOffset.generatedLine-1),column:n.generatedColumn-(i.generatedOffset.generatedLine===n.generatedLine?i.generatedOffset.generatedColumn-1:0),bias:t.bias}):{source:null,line:null,column:null,name:null}}hasContentsOfAllSources(){return this._sections.every(function(t){return t.consumer.hasContentsOfAllSources()})}sourceContentFor(t,n){for(let r=0;r<this._sections.length;r++){const s=this._sections[r].consumer.sourceContentFor(t,!0);if(s)return s}if(n)return null;throw new Error('"'+t+'" is not in the SourceMap.')}generatedPositionFor(t){for(let n=0;n<this._sections.length;n++){const r=this._sections[n];if(r.consumer._findSourceIndex(he.getArg(t,"source"))===-1)continue;const i=r.consumer.generatedPositionFor(t);if(i)return{line:i.line+(r.generatedOffset.generatedLine-1),column:i.column+(r.generatedOffset.generatedLine===i.line?r.generatedOffset.generatedColumn-1:0)}}return{line:null,column:null}}_parseMappings(t,n){const r=this.__generatedMappingsUnsorted=[],i=this.__originalMappingsUnsorted=[];for(let s=0;s<this._sections.length;s++){const o=this._sections[s],a=[];o.consumer.eachMapping(c=>a.push(c));for(let c=0;c<a.length;c++){const l=a[c];let u=he.computeSourceURL(o.consumer.sourceRoot,null,this._sourceMapURL);this._sources.add(u),u=this._sources.indexOf(u);let f=null;l.name&&(this._names.add(l.name),f=this._names.indexOf(l.name));const d={source:u,generatedLine:l.generatedLine+(o.generatedOffset.generatedLine-1),generatedColumn:l.generatedColumn+(o.generatedOffset.generatedLine===l.generatedLine?o.generatedOffset.generatedColumn-1:0),originalLine:l.originalLine,originalColumn:l.originalColumn,name:f};r.push(d),typeof d.originalLine=="number"&&i.push(d)}}}eachMapping(t,n,r){const i=n||null,s=r||ut.GENERATED_ORDER;let o;switch(s){case ut.GENERATED_ORDER:o=this._generatedMappings;break;case ut.ORIGINAL_ORDER:o=this._originalMappings;break;default:throw new Error("Unknown order of iteration.")}const a=this.sourceRoot;o.map(function(c){let l=null;return c.source!==null&&(l=this._sources.at(c.source),l=he.computeSourceURL(a,l,this._sourceMapURL)),{source:l,generatedLine:c.generatedLine,generatedColumn:c.generatedColumn,originalLine:c.originalLine,originalColumn:c.originalColumn,name:c.name===null?null:this._names.at(c.name)}},this).forEach(t,i)}_findMapping(t,n,r,i,s,o){if(t[r]<=0)throw new TypeError("Line must be greater than or equal to 1, got "+t[r]);if(t[i]<0)throw new TypeError("Column must be greater than or equal to 0, got "+t[i]);return jf.search(t,n,s,o)}allGeneratedPositionsFor(t){const n=he.getArg(t,"line"),r={source:he.getArg(t,"source"),originalLine:n,originalColumn:he.getArg(t,"column",0)};if(r.source=this._findSourceIndex(r.source),r.source<0)return[];if(r.originalLine<1)throw new Error("Line numbers must be >= 1");if(r.originalColumn<0)throw new Error("Column numbers must be >= 0");const i=[];let s=this._findMapping(r,this._originalMappings,"originalLine","originalColumn",he.compareByOriginalPositions,jf.LEAST_UPPER_BOUND);if(s>=0){let o=this._originalMappings[s];if(t.column===void 0){const a=o.originalLine;for(;o&&o.originalLine===a;){let c=o.lastGeneratedColumn;this._computedColumnSpans&&c===null&&(c=1/0),i.push({line:he.getArg(o,"generatedLine",null),column:he.getArg(o,"generatedColumn",null),lastColumn:c}),o=this._originalMappings[++s]}}else{const a=o.originalColumn;for(;o&&o.originalLine===n&&o.originalColumn==a;){let c=o.lastGeneratedColumn;this._computedColumnSpans&&c===null&&(c=1/0),i.push({line:he.getArg(o,"generatedLine",null),column:he.getArg(o,"generatedColumn",null),lastColumn:c}),o=this._originalMappings[++s]}}}return i}destroy(){for(let t=0;t<this._sections.length;t++)this._sections[t].consumer.destroy()}}function CL(e,t){let n=e;typeof e=="string"&&(n=he.parseSourceMapInput(e));const r=n.sections!=null?new NL(n,t):new xo(n,t);return Promise.resolve(r)}function LL(e,t){return xo.fromSourceMap(e,t)}var __={};const ML=o_.SourceMapGenerator,xc=ko,UL=/(\r?\n)/,PL=10,us="$$$isSourceNode$$$";let DL=class th{constructor(t,n,r,i,s){this.children=[],this.sourceContents={},this.line=t??null,this.column=n??null,this.source=r??null,this.name=s??null,this[us]=!0,i!=null&&this.add(i)}static fromStringWithSourceMap(t,n,r){const i=new th,s=t.split(UL);let o=0;const a=function(){const h=m(),p=m()||"";return h+p;function m(){return o<s.length?s[o++]:void 0}};let c=1,l=0,u=null,f;return n.eachMapping(function(h){if(u!==null)if(c<h.generatedLine)d(u,a()),c++,l=0;else{f=s[o]||"";const p=f.substr(0,h.generatedColumn-l);s[o]=f.substr(h.generatedColumn-l),l=h.generatedColumn,d(u,p),u=h;return}for(;c<h.generatedLine;)i.add(a()),c++;l<h.generatedColumn&&(f=s[o]||"",i.add(f.substr(0,h.generatedColumn)),s[o]=f.substr(h.generatedColumn),l=h.generatedColumn),u=h},this),o<s.length&&(u&&d(u,a()),i.add(s.splice(o).join(""))),n.sources.forEach(function(h){const p=n.sourceContentFor(h);p!=null&&(r!=null&&(h=xc.join(r,h)),i.setSourceContent(h,p))}),i;function d(h,p){if(h===null||h.source===void 0)i.add(p);else{const m=r?xc.join(r,h.source):h.source;i.add(new th(h.originalLine,h.originalColumn,m,p,h.name))}}}add(t){if(Array.isArray(t))t.forEach(function(n){this.add(n)},this);else if(t[us]||typeof t=="string")t&&this.children.push(t);else throw new TypeError("Expected a SourceNode, string, or an array of SourceNodes and strings. Got "+t);return this}prepend(t){if(Array.isArray(t))for(let n=t.length-1;n>=0;n--)this.prepend(t[n]);else if(t[us]||typeof t=="string")this.children.unshift(t);else throw new TypeError("Expected a SourceNode, string, or an array of SourceNodes and strings. Got "+t);return this}walk(t){let n;for(let r=0,i=this.children.length;r<i;r++)n=this.children[r],n[us]?n.walk(t):n!==""&&t(n,{source:this.source,line:this.line,column:this.column,name:this.name})}join(t){let n,r;const i=this.children.length;if(i>0){for(n=[],r=0;r<i-1;r++)n.push(this.children[r]),n.push(t);n.push(this.children[r]),this.children=n}return this}replaceRight(t,n){const r=this.children[this.children.length-1];return r[us]?r.replaceRight(t,n):typeof r=="string"?this.children[this.children.length-1]=r.replace(t,n):this.children.push("".replace(t,n)),this}setSourceContent(t,n){this.sourceContents[xc.toSetString(t)]=n}walkSourceContents(t){for(let r=0,i=this.children.length;r<i;r++)this.children[r][us]&&this.children[r].walkSourceContents(t);const n=Object.keys(this.sourceContents);for(let r=0,i=n.length;r<i;r++)t(xc.fromSetString(n[r]),this.sourceContents[n[r]])}toString(){let t="";return this.walk(function(n){t+=n}),t}toStringWithSourceMap(t){const n={code:"",line:1,column:0},r=new ML(t);let i=!1,s=null,o=null,a=null,c=null;return this.walk(function(l,u){n.code+=l,u.source!==null&&u.line!==null&&u.column!==null?((s!==u.source||o!==u.line||a!==u.column||c!==u.name)&&r.addMapping({source:u.source,original:{line:u.line,column:u.column},generated:{line:n.line,column:n.column},name:u.name}),s=u.source,o=u.line,a=u.column,c=u.name,i=!0):i&&(r.addMapping({generated:{line:n.line,column:n.column}}),s=null,i=!1);for(let f=0,d=l.length;f<d;f++)l.charCodeAt(f)===PL?(n.line++,n.column=0,f+1===d?(s=null,i=!1):i&&r.addMapping({source:u.source,original:{line:u.line,column:u.column},generated:{line:n.line,column:n.column},name:u.name})):n.column++}),this.walkSourceContents(function(l,u){r.setSourceContent(l,u)}),{code:n.code,map:r}}};__.SourceNode=DL;var BL=__.SourceNode;const FL=Jc(32,126).map(e=>String.fromCharCode(e)),$L=on({name:"Whitespace",pattern:/ +/}),jL=on({name:"WhitespaceSkipped",pattern:/ +/,group:wt.SKIPPED}),Wf=on({name:"Newline",line_breaks:!0,start_chars_hint:[`
`,"\r"],pattern:/\n|\r\n?/}),b_=on({name:"StringLiteral",pattern:/[^ $;\r\n]+/,start_chars_hint:FL}),Gf=on({name:"StringLiteralDouble",pattern:/"(?:[^\\"]|\\(?:[^\n\r]|u[0-9a-fA-F]{4}))*"/}),Hf=on({name:"EscapedDollar",pattern:"$$"}),Vf=on({name:"MaybeFlag",pattern:/\$[^-0-9"!;@#/?\s]+[^-"!;@#/?\s]*/}),Kf=on({name:"NumberLiteral",pattern:/\$-?(\d*\.)?\d+([eE][+-]?\d+)?[jJ]?[lL]?\+?/}),w_=on({name:"HyperLinkText",pattern:/;[^;\r\n]*/,start_chars_hint:[";"]});function zL(e,t=""){return on({name:t||e,pattern:new RegExp(e.toLowerCase(),"i")})}const v_=Object.keys($o).map(e=>zL(`\\$(${e})`,e)),WL=[$L,Wf,...v_,Gf,b_,Kf,Hf,w_,Vf],GL=new wt(WL,{skipValidations:!Xn,ensureOptimizations:Xn}),HL=new wt([jL,Wf,...v_,Gf,b_,Kf,Hf,w_,Vf],{skipValidations:!Xn,ensureOptimizations:Xn});function qf(e,t=!1){return t?HL.tokenize(e):GL.tokenize(e)}function E_(e,t,n,r,i,s,o,a){return{disablewrap:!1,measureonly:!1,measuredwidth:0,writefullwidth:void 0,x:0,y:0,iseven:!0,active:{color:n,bg:r,topedge:i,leftedge:s,rightedge:o,bottomedge:a},reset:{color:n,bg:r,topedge:i,leftedge:s,rightedge:o,bottomedge:a},width:e,height:t,char:[],color:[],bg:[],changed(){}}}function k_(e){e.active={...e.reset}}function S_(e,t){const n=t.y;function r(){++t.x;const a=t.active.rightedge??t.width-1;!t.disablewrap&&t.x>a&&(t.x=t.active.leftedge??0,++t.y),t.x>t.measuredwidth&&(t.measuredwidth=t.x)}function i(){return t.x>=(t.active.leftedge??0)&&t.x<=(t.active.rightedge??t.width-1)&&t.y>=(t.active.topedge??0)&&t.y<=(t.active.bottomedge??t.height-1)}function s(a){for(let c=0;c<a.length;++c){if(t.measureonly!==!0&&i()){const l=t.x+t.y*t.width;t.char[l]=a.charCodeAt(c),t.active.color!==void 0&&(t.color[l]=t.active.color),t.active.bg!==void 0&&(t.bg[l]=t.active.bg)}r()}}for(let a=0;a<e.length;++a){const c=e[a];switch(c.tokenType){case Hf:s("$");break;case Kf:if(t.measureonly!==!0&&i()){const l=t.x+t.y*t.width;t.char[l]=parseFloat(c.image.replace("$","")),t.active.color!==void 0&&(t.color[l]=t.active.color),t.active.bg!==void 0&&(t.bg[l]=t.active.bg)}r();break;case Gf:s(c.image.substring(1,c.image.length-1).replaceAll('\\"','"'));break;case Wf:{t.x=t.active.leftedge??0,++t.y;break}default:{const l=c.tokenType.name,u=$o[l],f=mw(be[u]),d=gw(be[u]);u==="ONCLEAR"?(t.active.color=t.reset.color,t.active.bg=t.reset.bg):S(f)?t.active.color=f:S(d)?t.active.bg=d:s(c.image);break}}}t.x>t.measuredwidth&&(t.measuredwidth=t.x+1);const o=t.active.leftedge??0;if(S(t.writefullwidth)&&(t.x>o||t.y===n)){const c=(t.active.rightedge??t.width-1)-t.x;if(c>0){k_(t);const l=String.fromCharCode(t.writefullwidth).repeat(c),u=t.x+t.y*t.width;XL(u,u+l.length,t.active.color,t.active.bg,t),qL(u,l,t)}}}function VL(e,t,n){const r=qf(e);r.tokens&&(S_(r.tokens,t),k_(t))}function KL(e,t,n){const r=qf(e);if(!r.tokens)return;const i=E_(t,n,be.WHITE,be.BLACK);return i.measureonly=!0,S_(r.tokens,i),i.x>0&&++i.y,i}function qL(e,t,n){let r=0;const i=e+t.length;for(let s=e;s<i;++s)n.char[s]=t.charCodeAt(r++)}function XL(e,t,n,r,i){const s=Math.min(e,t),o=Math.max(e,t);for(let a=s;a<=o;++a)i.color[a]=n,i.bg[a]=r}let A_=0;const T_=Xn,JL=["Command","lines"];class ZL extends LR{constructor(){super(Sg,{traceInitPerf:Xn,skipValidations:!Xn,maxLookahead:2,recoveryEnabled:!0,nodeLocationTracking:"full"});ye(this,"program",this.RULED("program",()=>{this.MANY(()=>this.SUBRULE(this.line))}));ye(this,"line",this.RULED("line",()=>{this.OR([{ALT:()=>this.SUBRULE(this.stmt)},{ALT:()=>this.CONSUME(Vs)}])}));ye(this,"stmt",this.RULED("stmt",()=>{this.OR([{ALT:()=>this.SUBRULE(this.stmt_label)},{ALT:()=>this.SUBRULE(this.stmt_stat)},{ALT:()=>this.SUBRULE(this.stmt_text)},{ALT:()=>this.SUBRULE(this.stmt_comment)},{ALT:()=>this.SUBRULE(this.stmt_hyperlink)},{ALT:()=>this.SUBRULE(this.stmt_command)},{ALT:()=>{this.AT_LEAST_ONE(()=>this.SUBRULE(this.short_commands)),this.MANY(()=>this.SUBRULE(this.commands))}}])}));ye(this,"inline",this.RULED("inline",()=>{this.SUBRULE(this.instmt)}));ye(this,"instmt",this.RULED("instmt",()=>{this.OR([{ALT:()=>this.SUBRULE(this.stmt_label)},{ALT:()=>this.SUBRULE(this.stmt_stat)},{ALT:()=>this.SUBRULE(this.stmt_text)},{ALT:()=>this.SUBRULE(this.stmt_comment)},{ALT:()=>this.SUBRULE(this.stmt_hyperlink)},{ALT:()=>this.SUBRULE(this.stmt_command)},{ALT:()=>this.AT_LEAST_ONE(()=>this.SUBRULE(this.commands))}])}));ye(this,"stmt_label",this.RULED("stmt_label",()=>{this.CONSUME(Zm)}));ye(this,"stmt_stat",this.RULED("stmt_stat",()=>{this.CONSUME(bu)}));ye(this,"stmt_text",this.RULED("stmt_text",()=>{this.OR([{ALT:()=>this.CONSUME(Xm)}])}));ye(this,"stmt_comment",this.RULED("stmt_comment",()=>{this.CONSUME(Jm)}));ye(this,"stmt_hyperlink",this.RULED("stmt_hyperlink",()=>{this.CONSUME(Ym),this.SUBRULE(this.words),this.CONSUME(Qm)}));ye(this,"stmt_command",this.RULED("stmt_command",()=>{this.CONSUME(Ji),this.AT_LEAST_ONE(()=>this.SUBRULE(this.commands))}));ye(this,"short_commands",this.RULED("short_commands",()=>{this.OR([{ALT:()=>this.SUBRULE(this.short_go)},{ALT:()=>this.SUBRULE(this.short_try)}])}));ye(this,"commands",this.RULED("commands",()=>{this.OR([{ALT:()=>this.SUBRULE(this.words)},{ALT:()=>this.SUBRULE(this.short_go)},{ALT:()=>this.SUBRULE(this.short_try)},{ALT:()=>this.SUBRULE(this.command_play)},{ALT:()=>this.SUBRULE(this.structured_cmd)}])}));ye(this,"structured_cmd",this.RULED("structured_cmd",()=>{this.OR([{ALT:()=>this.SUBRULE(this.command_debugger)},{ALT:()=>this.SUBRULE(this.command_if)},{ALT:()=>this.SUBRULE(this.command_while)},{ALT:()=>this.SUBRULE(this.command_repeat)},{ALT:()=>this.SUBRULE(this.command_waitfor)},{ALT:()=>this.SUBRULE(this.command_foreach)},{ALT:()=>this.SUBRULE(this.command_break)},{ALT:()=>this.SUBRULE(this.command_continue)}])}));ye(this,"short_go",this.RULED("short_go",()=>{this.CONSUME(Au),this.SUBRULE(this.words)}));ye(this,"short_try",this.RULED("short_try",()=>{this.CONSUME(hg),this.SUBRULE(this.words)}));ye(this,"command_debugger",this.RULED("command_debugger",()=>{this.CONSUME(gg)}));ye(this,"command_if",this.RULED("command_if",()=>{this.CONSUME(Tu),this.SUBRULE(this.words),this.OPTION(()=>this.SUBRULE(this.command_if_block))}));ye(this,"command_if_block",this.RULED("command_if_block",()=>{this.OR([{ALT:()=>this.SUBRULE(this.inline)},{ALT:()=>{this.CONSUME(ja),this.MANY(()=>this.SUBRULE(this.line)),this.MANY2({GATE:this.BACKTRACK(this.command_else_if),DEF:()=>this.SUBRULE(this.command_else_if)}),this.OPTION(()=>this.SUBRULE(this.command_else)),this.MANY3(()=>this.CONSUME3(Vs)),this.CONSUME4(Ji),this.CONSUME4(xu)}}])}));ye(this,"command_block",this.RULED("command_block",()=>{this.OR([{ALT:()=>this.SUBRULE(this.inline)},{ALT:()=>{this.CONSUME(ja),this.MANY(()=>this.SUBRULE(this.line)),this.CONSUME(Ji),this.CONSUME(xu)}}])}));ye(this,"command_fork",this.RULED("command_fork",()=>{this.OR([{ALT:()=>this.SUBRULE(this.inline)},{ALT:()=>{this.CONSUME(ja),this.MANY({GATE:this.BACKTRACK(this.line),DEF:()=>this.SUBRULE(this.line)})}}])}));ye(this,"command_else_if",this.RULED("command_else_if",()=>{this.CONSUME(Ji),this.CONSUME(Ru),this.CONSUME(Tu),this.SUBRULE(this.words),this.OPTION(()=>this.SUBRULE(this.command_fork))}));ye(this,"command_else",this.RULED("command_else",()=>{this.CONSUME(Ji),this.CONSUME(Ru),this.OPTION(()=>this.SUBRULE(this.command_fork))}));ye(this,"command_while",this.RULED("command_while",()=>{this.CONSUME(yg),this.SUBRULE(this.words),this.OPTION(()=>this.SUBRULE(this.command_block))}));ye(this,"command_repeat",this.RULED("command_repeat",()=>{this.CONSUME(_g),this.SUBRULE(this.words),this.OPTION(()=>this.SUBRULE(this.command_block))}));ye(this,"command_waitfor",this.RULED("command_waitfor",()=>{this.CONSUME(bg),this.SUBRULE(this.words)}));ye(this,"command_foreach",this.RULED("command_foreach",()=>{this.CONSUME(wg),this.SUBRULE(this.words),this.OPTION(()=>this.SUBRULE(this.command_block))}));ye(this,"command_break",this.RULED("command_break",()=>{this.CONSUME(vg)}));ye(this,"command_continue",this.RULED("command_continue",()=>{this.CONSUME(Eg)}));ye(this,"command_play",this.RULED("command_play",()=>{this.CONSUME(mg)}));ye(this,"expr",this.RULED("expr",()=>{this.SUBRULE1(this.and_test),this.MANY(()=>{this.CONSUME(wu),this.SUBRULE2(this.and_test)})}));ye(this,"and_test",this.RULED("and_test",()=>{this.SUBRULE1(this.not_test),this.MANY(()=>{this.CONSUME(Eu),this.SUBRULE2(this.not_test)})}));ye(this,"not_test",this.RULED("not_test",()=>{this.OR([{ALT:()=>{this.CONSUME(vu),this.SUBRULE1(this.not_test)}},{ALT:()=>this.SUBRULE2(this.comparison)}])}));ye(this,"comparison",this.RULED("comparison",()=>{this.SUBRULE1(this.arith_expr),this.MANY(()=>{this.SUBRULE(this.comp_op),this.SUBRULE2(this.arith_expr)})}));ye(this,"comp_op",this.RULED("comp_op",()=>{this.OR([{ALT:()=>this.CONSUME(ng)},{ALT:()=>this.CONSUME(rg)},{ALT:()=>this.CONSUME(ig)},{ALT:()=>this.CONSUME(sg)},{ALT:()=>this.CONSUME(og)},{ALT:()=>this.CONSUME(ag)}])}));ye(this,"expr_value",this.RULED("expr_value",()=>{this.SUBRULE1(this.and_test_value),this.MANY(()=>{this.CONSUME(wu),this.SUBRULE2(this.and_test_value)})}));ye(this,"and_test_value",this.RULED("and_test_value",()=>{this.SUBRULE1(this.not_test_value),this.MANY(()=>{this.CONSUME(Eu),this.SUBRULE2(this.not_test_value)})}));ye(this,"not_test_value",this.RULED("not_test_value",()=>{this.OR([{ALT:()=>{this.CONSUME(vu),this.SUBRULE1(this.not_test_value)}},{ALT:()=>this.SUBRULE2(this.arith_expr)}])}));ye(this,"arith_expr",this.RULED("arith_expr",()=>{this.SUBRULE1(this.term),this.MANY(()=>this.SUBRULE2(this.arith_expr_item))}));ye(this,"arith_expr_item",this.RULED("arith_expr_item",()=>{this.OR([{ALT:()=>this.CONSUME(ku)},{ALT:()=>this.CONSUME(Su)}]),this.SUBRULE(this.term)}));ye(this,"term",this.RULED("term",()=>{this.SUBRULE1(this.factor),this.MANY(()=>this.SUBRULE2(this.term_item))}));ye(this,"term_item",this.RULED("term_item",()=>{this.OR([{ALT:()=>this.CONSUME(lg)},{ALT:()=>this.CONSUME(Au)},{ALT:()=>this.CONSUME(ug)},{ALT:()=>this.CONSUME(fg)}]),this.SUBRULE(this.factor)}));ye(this,"factor",this.RULED("factor",()=>{this.OR1([{ALT:()=>{this.OR2([{ALT:()=>this.CONSUME(ku)},{ALT:()=>this.CONSUME(Su)}]),this.SUBRULE(this.factor)}},{ALT:()=>this.SUBRULE(this.power)}])}));ye(this,"power",this.RULED("power",()=>{this.SUBRULE(this.token),this.OPTION(()=>{this.CONSUME(cg),this.SUBRULE(this.factor)})}));ye(this,"words",this.RULED("words",()=>{this.AT_LEAST_ONE(()=>this.SUBRULE(this.expr))}));ye(this,"token",this.RULED("token",()=>{this.OR([{ALT:()=>this.CONSUME(eg)},{ALT:()=>this.CONSUME(Gt)},{ALT:()=>this.CONSUME(tg)},{ALT:()=>{this.CONSUME(dg),this.SUBRULE(this.expr),this.CONSUME(pg)}}])}));this.performSelfAnalysis()}PEEK(n,r,...i){console.info(n,i.map(s=>[s.image,s.tokenType]),r)}RULED(n,r,i){const s=JL.some(o=>n.includes(o));return this.RULE(n,()=>{const a=(A_++).toString().padStart(3),c=s?"font-weight: bold;":"";if(T_&&!this.RECORDING_PHASE){const l=[this.LA(1),this.LA(2),this.LA(3)].map(u=>`[${u.tokenType.name} ${u.image.replaceAll(`
`,"\\n")}]`);console.info(`${a}%c> ${n} ${l.join(" ")}`,c)}r(),T_&&!this.RECORDING_PHASE&&console.info(`${a}%c< ${n} `,c),A_--},i)}}const fs=new ZL;if(VR){const e=fs.getGAstProductions(),t=HR(e);console.info(t)}const YL=fs.getBaseCstVisitorConstructor();var ae=(e=>(e[e.PROGRAM=0]="PROGRAM",e[e.API=1]="API",e[e.LINE=2]="LINE",e[e.MARK=3]="MARK",e[e.GOTO=4]="GOTO",e[e.COUNT=5]="COUNT",e[e.TEXT=6]="TEXT",e[e.LABEL=7]="LABEL",e[e.HYPERLINK=8]="HYPERLINK",e[e.STAT=9]="STAT",e[e.MOVE=10]="MOVE",e[e.COMMAND=11]="COMMAND",e[e.LITERAL=12]="LITERAL",e[e.IF=13]="IF",e[e.IF_CHECK=14]="IF_CHECK",e[e.IF_BLOCK=15]="IF_BLOCK",e[e.ELSE_IF=16]="ELSE_IF",e[e.ELSE=17]="ELSE",e[e.WHILE=18]="WHILE",e[e.BREAK=19]="BREAK",e[e.CONTINUE=20]="CONTINUE",e[e.REPEAT=21]="REPEAT",e[e.WAITFOR=22]="WAITFOR",e[e.FOREACH=23]="FOREACH",e[e.OR=24]="OR",e[e.AND=25]="AND",e[e.NOT=26]="NOT",e[e.COMPARE=27]="COMPARE",e[e.COMPARE_ITEM=28]="COMPARE_ITEM",e[e.OPERATOR=29]="OPERATOR",e[e.OPERATOR_ITEM=30]="OPERATOR_ITEM",e[e.EXPR=31]="EXPR",e))(ae||{}),Oi=(e=>(e[e.IS_EQ=0]="IS_EQ",e[e.IS_NOT_EQ=1]="IS_NOT_EQ",e[e.IS_LESS_THAN=2]="IS_LESS_THAN",e[e.IS_GREATER_THAN=3]="IS_GREATER_THAN",e[e.IS_LESS_THAN_OR_EQ=4]="IS_LESS_THAN_OR_EQ",e[e.IS_GREATER_THAN_OR_EQ=5]="IS_GREATER_THAN_OR_EQ",e))(Oi||{}),ir=(e=>(e[e.EMPTY=0]="EMPTY",e[e.PLUS=1]="PLUS",e[e.MINUS=2]="MINUS",e[e.POWER=3]="POWER",e[e.MULTIPLY=4]="MULTIPLY",e[e.DIVIDE=5]="DIVIDE",e[e.MOD_DIVIDE=6]="MOD_DIVIDE",e[e.FLOOR_DIVIDE=7]="FLOOR_DIVIDE",e[e.UNI_PLUS=8]="UNI_PLUS",e[e.UNI_MINUS=9]="UNI_MINUS",e))(ir||{}),Rc=(e=>(e[e.NUMBER=0]="NUMBER",e[e.STRING=1]="STRING",e[e.TEMPLATE=2]="TEMPLATE",e))(Rc||{});function QL(e){return!!(e!=null&&e.tokenType)}function Cr(e,t){const[n]=e??[];return((n==null?void 0:n.image)??t).trimStart().replaceAll(/^"|"$/g,"")}class eM extends YL{constructor(){super();ye(this,"unique",0);Xn&&this.validateVisitor()}getnodelocation(n){const r=Object.values(n).flat().filter(i=>!!i).map(i=>i&&QL(i)?{startLine:i.startLine,startColumn:i.startColumn,startOffset:i.startOffset,endLine:i.endLine,endColumn:i.endColumn,endOffset:i.endOffset}:i!=null&&i.location?{...i.location}:{startLine:0,startColumn:0,startOffset:0,endLine:0,endColumn:0,endOffset:0}).filter(i=>i.startLine!==0&&i.endLine!==0);return{startLine:Math.min(...r.map(i=>i.startLine??1)),startColumn:Math.min(...r.map(i=>i.startColumn??1)),startOffset:Math.min(...r.map(i=>i.startOffset??1)),endLine:Math.max(...r.map(i=>i.endLine??1)),endColumn:Math.max(...r.map(i=>i.endColumn??1)),endOffset:Math.max(...r.map(i=>i.endOffset??1))}}createcodenode(n,r){return[{...r,...this.getnodelocation(n),lineindex:0}]}createstringnode(n,r){return this.createcodenode(n,{type:12,literal:1,value:r})}createmarknode(n,r,i){return this.createlinenode(n,this.createcodenode(n,{type:3,id:r,comment:i}))}creategotonode(n,r,i){return this.createlinenode(n,this.createcodenode(n,{type:4,id:r,comment:i}))}createlinenode(n,r){return this.createcodenode(n,{type:2,stmts:r})}createapinode(n,r,i){return this.createlinenode(n,this.createcodenode(n,{type:1,words:i,method:r}))}createlogicnode(n,r,i,s){return this.createlinenode(n,this.createcodenode(n,{type:14,skip:i,words:s,method:r}))}createcountnode(n){return this.createcodenode(n,{type:5,index:this.unique++})}go(n){return Array.isArray(n)?n.map(r=>this.visit(r)).flat():S(n)?[this.visit(n)].flat():[]}program(n){return this.unique=0,this.createcodenode(n,{type:0,lines:[this.createlinenode(n,this.createcodenode(n,{type:7,active:!0,name:"restart"})),this.go(n.line)].flat()})}line(n){return n.stmt?this.go(n.stmt):[]}stmt(n){return n.stmt_label?this.go(n.stmt_label):n.stmt_stat?this.go(n.stmt_stat):n.stmt_text?this.go(n.stmt_text):n.stmt_comment?this.go(n.stmt_comment):n.stmt_command?this.go(n.stmt_command):n.stmt_hyperlink?this.go(n.stmt_hyperlink):n.short_commands?[this.go(n.short_commands),this.go(n.commands)].flat():[]}inline(n){return this.go(n.instmt)}instmt(n){return n.stmt_label?this.go(n.stmt_label):n.stmt_stat?this.go(n.stmt_stat):n.stmt_text?this.go(n.stmt_text):n.stmt_comment?this.go(n.stmt_comment):n.stmt_command?this.go(n.stmt_command):n.stmt_hyperlink?this.go(n.stmt_hyperlink):n.commands?this.go(n.commands):[]}stmt_label(n){return this.createlinenode(n,this.createcodenode(n,{type:7,active:!0,name:Cr(n.token_label,":").slice(1).trim()}))}stmt_stat(n){return this.createlinenode(n,this.createcodenode(n,{type:9,value:Cr(n.token_stat,"@").slice(1)}))}stmt_text(n){return this.createlinenode(n,this.createcodenode(n,{type:6,value:Cr(n.token_text,"")}))}stmt_comment(n){return this.createlinenode(n,this.createcodenode(n,{type:7,active:!1,name:Cr(n.token_comment,"'").slice(1).trim()}))}stmt_hyperlink(n){return this.createlinenode(n,this.createcodenode(n,{type:8,link:this.go(n.words),text:Cr(n.token_hyperlinktext,";").slice(1)}))}stmt_command(n){return n.commands?this.go(n.commands):[]}short_commands(n){return n.short_go?this.go(n.short_go):n.short_try?this.go(n.short_try):[]}commands(n){return n.words?this.createlinenode(n,this.createcodenode(n,{type:11,words:this.go(n.words)})):n.short_go?this.go(n.short_go):n.short_try?this.go(n.short_try):n.command_play?this.go(n.command_play):n.structured_cmd?this.go(n.structured_cmd):[]}structured_cmd(n){return n.command_if?this.go(n.command_if):n.command_while?this.go(n.command_while):n.command_repeat?this.go(n.command_repeat):n.command_waitfor?this.go(n.command_waitfor):n.command_foreach?this.go(n.command_foreach):n.command_break?this.go(n.command_break):n.command_continue?this.go(n.command_continue):[]}short_go(n){return n.token_divide?this.createlinenode(n,this.createcodenode(n,{type:10,wait:!0,words:this.go(n.words)})):[]}short_try(n){return n.token_query?this.createlinenode(n,this.createcodenode(n,{type:10,wait:!1,words:this.go(n.words)})):[]}command_if(n){const[r]=this.createlogicnode(n,"if","",this.go(n.words)),[i]=this.go(n.command_if_block)??[];return this.createcodenode(n,{type:13,check:r,block:i})}command_if_block(n){const r=gt(),i=gt();return this.createcodenode(n,{type:15,skip:r,done:i,lines:[this.go(n.inline),this.go(n.line),this.creategotonode(n,i,"end of if"),this.createmarknode(n,r,"alt logic")].flat(),altlines:[this.go(n.command_else_if),this.go(n.command_else),this.createmarknode(n,i,"end of if")].flat()})}command_block(n){return[this.go(n.inline),this.go(n.line)].flat()}command_fork(n){return[this.go(n.inline),this.go(n.line)].flat()}command_else_if(n){const r=gt();return this.createcodenode(n,{type:16,done:"",lines:[this.createlogicnode(n,"if",r,this.go(n.words)),this.go(n.command_fork),this.createmarknode(n,r,"skip")].flat()})}command_else(n){return this.createcodenode(n,{type:17,lines:this.go(n.command_fork)})}command_while(n){const r=gt(),i=gt();return this.createcodenode(n,{type:18,loop:r,done:i,lines:[this.createmarknode(n,r,"start of while"),this.createlogicnode(n,"if",i,this.go(n.words)),this.go(n.command_block),this.creategotonode(n,r,"loop of while"),this.createmarknode(n,i,"end of while")].flat()})}command_repeat(n){const r=gt(),i=gt(),o=[this.createcountnode(n),this.go(n.words)].flat();return this.createcodenode(n,{type:21,loop:r,done:i,lines:[this.createapinode(n,"repeatstart",o),this.createmarknode(n,r,"start of repeat"),this.createlogicnode(n,"repeat",i,o),this.go(n.command_block),this.creategotonode(n,r,"loop of repeat"),this.createmarknode(n,i,"end of repeat")].flat()})}command_foreach(n){const r=gt(),i=gt(),o=[this.createcountnode(n),this.go(n.words)].flat();return this.createcodenode(n,{type:23,loop:r,done:i,lines:[this.createapinode(n,"foreachstart",o),this.createmarknode(n,r,"start of foreach"),this.createlogicnode(n,"foreach",i,o),this.go(n.command_block),this.creategotonode(n,r,"loop of foreach"),this.createmarknode(n,i,"end of foreach")].flat()})}command_waitfor(n){return this.createcodenode(n,{type:22,words:this.go(n.words)})}command_break(n){return this.createcodenode(n,{type:19,goto:0})}command_continue(n){return this.createcodenode(n,{type:20,goto:0})}command_play(n){const r=Cr(n.token_command_play,""),i=r.replace("bgplay","").replace("play","").trim(),s=r.includes("bgplay");return this.createlinenode(n,this.createcodenode(n,{type:11,words:[this.createstringnode(n,s?"bgplay":"play"),this.createstringnode(n,i)].flat()}))}expr(n){return n.and_test.length===1?this.go(n.and_test):this.createcodenode(n,{type:24,items:this.go(n.and_test)})}and_test(n){return n.not_test.length===1?this.go(n.not_test):this.createcodenode(n,{type:25,items:this.go(n.not_test)})}not_test(n){return n.comparison?this.go(n.comparison):n.not_test?this.createcodenode(n,{type:26,items:this.go(n.not_test)}):[]}comparison(n){if(n.arith_expr.length===1)return this.go(n.arith_expr);const[r,i]=this.go(n.arith_expr),[s]=this.go(n.comp_op);return this.createcodenode(n,{type:27,lhs:r,compare:s,rhs:i})}comp_op(n){return n.token_iseq?this.createcodenode(n,{type:28,method:0}):n.token_isnoteq?this.createcodenode(n,{type:28,method:1}):n.token_islessthan?this.createcodenode(n,{type:28,method:2}):n.token_isgreaterthan?this.createcodenode(n,{type:28,method:3}):n.token_isgreaterthanorequal?this.createcodenode(n,{type:28,method:4}):n.token_isgreaterthanorequal?this.createcodenode(n,{type:28,method:5}):[]}expr_value(n){return n.and_test_value.length===1?this.go(n.and_test_value):this.createcodenode(n,{type:24,items:this.go(n.and_test_value)})}and_test_value(n){return n.not_test_value.length===1?this.go(n.not_test_value):this.createcodenode(n,{type:25,items:this.go(n.not_test_value)})}not_test_value(n){return n.arith_expr?this.go(n.arith_expr):n.not_test_value?this.createcodenode(n,{type:26,items:this.go(n.not_test_value)}):[]}arith_expr(n){const r=this.go(n.term);return n.arith_expr_item?this.createcodenode(n,{type:29,lhs:r[0],items:this.go(n.arith_expr_item)}):r}arith_expr_item(n){return this.createcodenode(n,{type:30,operator:n.token_plus?1:2,rhs:this.go(n.term)[0]})}term(n){return n.term_item?this.createcodenode(n,{type:29,lhs:this.go(n.factor)[0],items:this.go(n.term_item)}):this.go(n.factor)}term_item(n){let r=0;return n.token_multiply&&(r=4),n.token_divide&&(r=5),n.token_moddivide&&(r=6),n.token_floordivide&&(r=7),this.createcodenode(n,{type:30,operator:r,rhs:this.go(n.factor)[0]})}factor(n){if(n.power)return this.go(n.power);let r=0;return n.token_plus&&(r=8),n.token_minus&&(r=9),this.createcodenode(n,{type:29,lhs:void 0,items:this.createcodenode(n,{type:30,operator:r,rhs:this.go(n.factor)[0]})})}power(n){const r=this.go(n.token);return n.factor?this.createcodenode(n,{type:29,lhs:r[0],items:this.createcodenode(n,{type:30,operator:3,rhs:this.go(n.factor)[0]})}):r}words(n){return this.go(n.expr)}token(n){if(n.token_stringliteraldouble){const r=Cr(n.token_stringliteraldouble,"").replaceAll(/(^"|"$)/g,"");return this.createcodenode(n,{type:12,literal:2,value:r})}if(n.token_stringliteral){const r=Cr(n.token_stringliteral,"").replaceAll(/(^"|"$)/g,"");return this.createcodenode(n,{type:12,literal:1,value:r})}if(n.token_numberliteral){const r=parseFloat(Cr(n.token_numberliteral,"0"));return this.createcodenode(n,{type:12,literal:0,value:r})}return n.token_lparen?this.createcodenode(n,{type:31,words:this.go(n.expr)}):[]}}const tM=new eM,tn={labels:{},internal:0,lineindex:0,linelookup:{},isfirststat:!1},Ic="zss.js";function Ne(e,t){return new BL(e.startLine??1,e.startColumn??1,Ic,t)}function Xf(e){return e.replace(/\\/g,"\\\\").replace(/'/g,"\\'")}function Jf(e){return`'${Xf(e)}'`}function Oc(e){if(e.startsWith('"'))return Oc(e.replaceAll(/(^"|"$)/g,""));const t=qf(e);return t.errors.length?e:`['${t.tokens.map(r=>r.tokenType===Vf?`', api.get('${Xf(r.image.substring(1))}'), '`:Xf(r.image)).join("")}'].join('')`}function Ni(e){return e.filter(t=>t!==void 0).map(Fe)}function x_(e){return Ne(e,"")}function nM(e,t){const n=[];return e.forEach(r=>{n.push(r,t)}),n.pop(),n}function pt(e,t,n){return Ne(e,[`api.${t}(`,...nM(n,", "),")"])}function rM(e){if(e.type===ae.COMPARE&&e.compare.type===ae.COMPARE_ITEM)switch(e.compare.method){case Oi.IS_EQ:return pt(e,"isEq",[Fe(e.lhs),Fe(e.rhs)]);case Oi.IS_NOT_EQ:return pt(e,"isNotEq",[Fe(e.lhs),Fe(e.rhs)]);case Oi.IS_LESS_THAN:return pt(e,"isLessThan",[Fe(e.lhs),Fe(e.rhs)]);case Oi.IS_GREATER_THAN:return pt(e,"isGreaterThan",[Fe(e.lhs),Fe(e.rhs)]);case Oi.IS_LESS_THAN_OR_EQ:return pt(e,"isLessThanOrEq",[Fe(e.lhs),Fe(e.rhs)]);case Oi.IS_GREATER_THAN_OR_EQ:return pt(e,"isGreaterThanOrEq",[Fe(e.lhs),Fe(e.rhs)])}return Ne(e,"")}function Ci(e,t,n){return e.prepend(`api.${t}(`),e.add([", ",Fe(n),")"])}function R_(e,t,n){return e.prepend(`api.${t}(`),e.add([Fe(n),")"])}function iM(e,t){if(e.type===ae.OPERATOR_ITEM)switch(e.operator){case ir.PLUS:return Ci(t,"opPlus",e.rhs);case ir.MINUS:return Ci(t,"opMinus",e.rhs);case ir.POWER:return Ci(t,"opPower",e.rhs);case ir.MULTIPLY:return Ci(t,"opMultiply",e.rhs);case ir.DIVIDE:return Ci(t,"opDivide",e.rhs);case ir.MOD_DIVIDE:return Ci(t,"opModDivide",e.rhs);case ir.FLOOR_DIVIDE:return Ci(t,"opFloorDivide",e.rhs);case ir.UNI_PLUS:return R_(t,"opUniPlus",e.rhs);case ir.UNI_MINUS:return R_(t,"opUniMinus",e.rhs)}return Ne(e,"")}function sM(e){if(e.type===ae.OPERATOR){const t=e.lhs?Fe(e.lhs):Ne(e,"");return e.items.forEach(n=>iM(n,t)),t}return Ne(e,"")}function Nc(e,t){return Ne(e,[pt(e,"jump",[`${t}`]),"; continue;"])}function ei(e){return tn.linelookup[e??""]??-1}function hs(e,t,n){for(let r=0;r<e.length;++r){const i=e[r];switch(i.type){case ae.WHILE:case ae.REPEAT:case ae.FOREACH:case ae.ELSE_IF:i.type===t&&(i.done=n);break;case ae.IF_BLOCK:case ae.IF_CHECK:i.type===t&&(i.skip=n);break;case ae.LINE:hs(i.stmts,t,n);break}}}function Fe(e){var t;switch(e.type){case ae.PROGRAM:return Ne(e,[`try { // first-line
`,`while (true) {
`,`if (api.sy()) { yield 1; }
`,`switch (api.getcase()) {
`,...e.lines.map(Fe).flat(),`default:
`,`  api.endofprogram();
`,`  while (api.hm() === 0) { yield 1; };
`,`  continue;
`,`}
`,`api.nextcase();
`,`} // end of logic
`,`} catch (e) {
`,`console.error(e);
`,`const source = api.stacktrace(e);
`,`const err = new Error(e.message);
`,`err.name = 'GameError';
`,`err.meta = { line: source.line, column: source.column };
`,`throw err;
`,`}
`,`//# sourceURL=${Ic}`]);case ae.API:return Ne(e,["  ",pt(e,e.method,Ni(e.words)),`;
`]);case ae.LINE:return Ne(e,[`case ${e.lineindex}:
`,...e.stmts.map(Fe).flat(),`  break;
`]);case ae.MARK:return Ne(e,`  // ${e.comment}
`);case ae.GOTO:{const n=ei(e.id);return Ne(e,["  ",Nc(e,n),`
`])}case ae.COUNT:return Ne(e,`${e.index}`);case ae.LITERAL:switch(e.literal){case Rc.NUMBER:return Ne(e,`${e.value}`);case Rc.STRING:return Ne(e,Jf(e.value));case Rc.TEMPLATE:return Ne(e,Oc(e.value))}return x_(e);case ae.TEXT:return Ne(e,["  ",pt(e,"text",[Oc(e.value)]),`;
`]);case ae.STAT:if(tn.isfirststat){tn.isfirststat=!1;const n=e.value.trim().split(" ").map(Jf);return Ne(e,["  ",pt(e,"stat",n),`;
`])}return Ne(e,`  // skipped ${e.value}
`);case ae.LABEL:{const n=Pe(e.name),r=e.active?"label":"comment";tn.labels[n]||(tn.labels[n]=[]);const i=(e.active?1:-1)*e.lineindex;return tn.labels[n].push(i),Ne(e,`  // ${i} '${n}' ${r}
`)}case ae.HYPERLINK:return Ne(e,["  ",pt(e,"hyperlink",[Oc(e.text),...Ni(e.link)]),`;
`]);case ae.MOVE:{const n=pt(e,"command",[Jf("go"),Ni(e.words)].flat());return e.wait?Ne(e,["  if (",n,`) { continue; };
`]):Ne(e,["  ",n,`;
`])}case ae.COMMAND:return Ne(e,["  ",pt(e,"command",Ni(e.words)),`;
`]);case ae.IF:{const n=((t=e.block)==null?void 0:t.type)===ae.IF_BLOCK?e.block:void 0;if(S(n)){hs([e.check],ae.IF_CHECK,n.skip);const r=Ne(e,Fe(e.check));return n.lines.forEach(i=>r.add(Fe(i))),hs(n.altlines,ae.ELSE_IF,n.done),n.altlines.forEach(i=>r.add(Fe(i))),r}return Ne(e,Fe(e.check))}case ae.IF_CHECK:{const n=ei(e.skip);return n===-1?Ne(e,["  ",pt(e,e.method,Ni(e.words)),`;
`]):Ne(e,["  if (!",pt(e,e.method,Ni(e.words)),") { ",Nc(e,n),` }
`])}case ae.ELSE_IF:case ae.ELSE:{const n=Ne(e,"");return e.lines.forEach(r=>n.add(Fe(r))),n}case ae.WHILE:{const n=ei(e.loop),r=ei(e.done),i=Ne(e,"");return hs(e.lines,ae.IF_CHECK,e.done),e.lines.forEach(s=>{switch(s.type){case ae.BREAK:s.goto=r;break;case ae.CONTINUE:s.goto=n;break}i.add(Fe(s))}),i}case ae.REPEAT:{const n=ei(e.loop),r=ei(e.done),i=Ne(e,"");return hs(e.lines,ae.IF_CHECK,e.done),e.lines.forEach(s=>{switch(s.type){case ae.BREAK:s.goto=r;break;case ae.CONTINUE:s.goto=n;break}i.add(Fe(s))}),i}case ae.WAITFOR:{const n=Ne(e,"");return n.add(["  if (!",pt(e,"if",Ni(e.words)),`) { api.i(${e.lineindex-1}); }
`]),n}case ae.FOREACH:{const n=ei(e.loop),r=ei(e.done),i=Ne(e,"");return hs(e.lines,ae.IF_CHECK,e.done),e.lines.forEach(s=>{switch(s.type){case ae.BREAK:s.goto=r;break;case ae.CONTINUE:s.goto=n;break}i.add(Fe(s))}),i}case ae.BREAK:return Ne(e,["  ",Nc(e,e.goto),`
`]);case ae.CONTINUE:return Ne(e,["  ",Nc(e,e.goto),`
`]);case ae.OR:return pt(e,"or",e.items.map(Fe));case ae.AND:return pt(e,"and",e.items.map(Fe));case ae.NOT:return pt(e,"not",e.items.map(Fe));case ae.COMPARE:return rM(e);case ae.OPERATOR:return sM(e);case ae.EXPR:return pt(e,"expr",e.words.map(Fe));default:return console.error("<unsupported node>",e.type,e),x_(e)}}function sr(e){if(S(e))switch(e.type===ae.LINE&&++tn.lineindex,e.lineindex=tn.lineindex,e.type){case ae.PROGRAM:e.lines.forEach(sr);break;case ae.LINE:e.stmts.forEach(sr);break;case ae.MARK:tn.linelookup[e.id]=e.lineindex;break;case ae.IF:sr(e.check),sr(e.block);break;case ae.IF_BLOCK:e.lines.forEach(sr),e.altlines.forEach(sr);break;case ae.ELSE_IF:e.lines.forEach(sr);break;case ae.ELSE:case ae.WHILE:case ae.REPEAT:case ae.FOREACH:e.lines.forEach(sr);break;case ae.MOVE:case ae.COMMAND:case ae.WAITFOR:case ae.IF_CHECK:e.words.forEach(sr);break}}function oM(e){return tn.labels={},tn.internal=1,tn.lineindex=0,tn.isfirststat=!0,sr(e),{...Fe(e).toStringWithSourceMap({file:`${Ic}.map`}),...tn}}const Cc={HALT_AT_COUNT:64};function aM(e){return We(e)?e.length>0?1:0:e??0}function Nt(e){return`${e??""}`}function I_(e){return`${e}_chip`}function cM(e,t,n){var c,l;const r=I_(e),i=ps(r);let s;We(i.lb)||(i.lb=ys(Object.entries(n.labels??{})),i.lk="",i.mg=void 0,i.ec=1,i.lc=0,i.ys=0,i.ps=0,i.es=(((c=n.errors)==null?void 0:c.length)??0)!==0?1:0);function o(u,f){D.words=f,D.get=a.get;const d=hL(t,u);return S(d)?d(a,f):u!=="send"?o("send",[u,...f]):0}const a={halt(){kM(r)},id(){return e},senderid(u=e){return`vm:${u??e}`},set(u,f){const[d,h]=pL(t,a,u,f);if(d)return h},get(u){const[f,d]=dL(t,a,u);if(f)return d},bucket(u){const f=a.get("bucket");We(f)?f.push(u):a.set("bucket",[u])},tick(u){const f=ke(i.ps)?i.ps:0,d=f%u===0;if(i.ps=f+1,d===!1)return!1;if(a.shouldtick()===!1)return s_(t,a),!1;i.lc=0,i.ys=0,mL(t,a);try{const h=s==null?void 0:s.next();h!=null&&h.done&&(Qe("chip","crash","generator logic unexpectedly exited"),i.es=1)}catch(h){Qe("chip","crash",h.message),i.es=1}return s_(t,a),!0},isended(){return i.es===1},shouldtick(){return i.es===0||a.hm()!==0},shouldhalt(){return ke(i.lc)?++i.lc>Cc.HALT_AT_COUNT:!0},hm(){if(We(i.mg)&&We(i.lb)){const[,u]=i.mg;if(S(u))for(let f=0;f<i.lb.length;++f){const[d,h]=i.lb[f];if(d===u)return h.find(p=>ke(p)&&p>0)??0}}return 0},yield(){i.ys=1},jump(u){i.ec=u},sy(){return!!i.ys||a.shouldhalt()},emit(u,f,d){Ue.emit(u,a.senderid(),f,d)},send(u,f,d,h){Ue.emit(`${a.senderid(u)}:${f}`,e,d,h)},lock(u){i.lk=u},unlock(){i.lk=""},message(u){i.lk&&u.sender!==i.lk||(i.mg=[u.id,u.target,u.data,u.sender,u.player])},zap(u){if(We(i.lb))for(let f=0;f<i.lb.length;++f){const[d,h]=i.lb[f];if(d===u){const p=h.findIndex(m=>m>0);p>=0&&(h[p]*=-1)}}},restore(u){if(We(i.lb))for(let f=0;f<i.lb.length;++f){const[d,h]=i.lb[f];if(d===u)for(let p=0;p<h.length;p++)h[f]=Math.abs(h[f])}},getcase(){i.ec=ke(i.ec)?i.ec:1;const u=a.hm();if(u&&We(i.mg)){const[,,f,d,h]=i.mg;a.set("sender",d),S(f)&&a.set("arg",f),h&&a.set("player",h),i.mg=void 0,i.ys=0,i.es=0,i.ec=u}return i.ec},nextcase(){const u=ke(i.ec)?i.ec:1;return i.ec=u+1,i.ec},endofprogram(){a.yield(),i.es=1},stacktrace(u){const f=sw.parse(u),[d]=f.filter(h=>h.fileName===Ic);return{line:(d==null?void 0:d.lineNumber)??0,column:(d==null?void 0:d.columnNumber)??0}},text(u){return o("text",[u])},stat(...u){return o("stat",u)},hyperlink(...u){return o("hyperlink",u)},command(...u){if(u.length===0)return 0;const[f,...d]=u;return o(Nt(f),d)},if(...u){const[f,d]=re(u,0,[q.ANY]),h=aM(f);return h&&d<u.length&&a.command(...u.slice(d)),h?1:0},repeatstart(u,...f){const[d,h]=re(f,0,[q.NUMBER]),p=`repeatcount${u}`,m=`repeatwords${u}`;i[p]=d,i[m]=h<f.length?f.slice(h):void 0},repeat(u){const f=`repeatcount${u}`,d=`repeatwords${u}`;if(!ke(i[f]))return 0;const h=i[f];i[f]=h-1;const p=h>0,m=i[d];return p&&We(m)&&a.command(...m),p?1:0},foreachstart(u,...f){const[d,h,p,m]=re(f,0,[q.STRING,q.NUMBER,q.NUMBER,q.MAYBE_NUMBER]);let b=Math.min(h,p),_=Math.max(h,p);const w=(m??0)||1;if(w<0){const v=b;b=_,_=v}return a.set(d,b-w),0},foreach(u,...f){const[d,h,p,m,b]=re(f,0,[q.STRING,q.NUMBER,q.NUMBER,q.MAYBE_NUMBER]);let _=Math.min(h,p),w=Math.max(h,p);const v=(m??0)||1;if(v<0){const I=_;_=w,w=I}let k=a.get(d);!ke(k)||k<_||k>w?k=_:k+=v;const C=k<=w?1:0;return C&&(a.set(d,k),b<f.length&&a.command(...f.slice(b))),C},or(...u){let f=0;for(let d=0;d<u.length;){const[h,p]=re(u,d,[q.ANY]);if(f=h,f)break;d=p}return f},and(...u){let f=0;for(let d=0;d<u.length;){const[h,p]=re(u,d,[q.ANY]);if(f=h,!f)break;d=p}return f},not(...u){const[f]=re(u,0,[q.ANY]);return f?0:1},expr(...u){const[f]=re(u,0,[q.ANY]);return f},isEq(u,f){const[d]=re([u],0,[q.ANY]),[h]=re([f],0,[q.ANY]);return typeof d=="object"||typeof h=="object"?ew(d,h)?1:0:d===h?1:0},isNotEq(u,f){return this.isEq(u,f)?0:1},isLessThan(u,f){const[d]=re([u],0,[q.NUMBER]),[h]=re([f],0,[q.NUMBER]);return d<h?1:0},isGreaterThan(u,f){const[d]=re([u],0,[q.NUMBER]),[h]=re([f],0,[q.NUMBER]);return d>h?1:0},isLessThanOrEq(u,f){const[d]=re([u],0,[q.NUMBER]),[h]=re([f],0,[q.NUMBER]);return d<=h?1:0},isGreaterThanOrEq(u,f){const[d]=re([u],0,[q.NUMBER]),[h]=re([f],0,[q.NUMBER]);return d>=h?1:0},opPlus(u,f){const[d]=re([u],0,[q.ANY]),[h]=re([f],0,[q.ANY]);return d+h},opMinus(u,f){const[d]=re([u],0,[q.ANY]),[h]=re([f],0,[q.ANY]);return d-h},opPower(u,f){const[d]=re([u],0,[q.NUMBER]),[h]=re([f],0,[q.NUMBER]);return Math.pow(d,h)},opMultiply(u,f){const[d]=re([u],0,[q.NUMBER]),[h]=re([f],0,[q.NUMBER]);return d*h},opDivide(u,f){const[d]=re([u],0,[q.NUMBER]),[h]=re([f],0,[q.NUMBER]);return d/h},opModDivide(u,f){const[d]=re([u],0,[q.NUMBER]),[h]=re([f],0,[q.NUMBER]);return d%h},opFloorDivide(u,f){const[d]=re([u],0,[q.NUMBER]),[h]=re([f],0,[q.NUMBER]);return Math.floor(d/h)},opUniPlus(u){const[f]=re([u],0,[q.NUMBER]);return+f},opUniMinus(u){const[f]=re([u],0,[q.NUMBER]);return-f}};return s=(l=n.code)==null?void 0:l.call(n,a),a}function Lc(e){throw new Error('Could not dynamically require "'+e+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var O_={exports:{}};/*!

  JSZip v3.10.1 - A JavaScript class for generating and reading zip files
  <http://stuartk.com/jszip>

  (c) 2009-2016 Stuart Knightley <stuart [at] stuartk.com>
  Dual licenced under the MIT license or GPLv3. See https://raw.github.com/Stuk/jszip/main/LICENSE.markdown.

  JSZip uses the library pako released under the MIT license :
  https://github.com/nodeca/pako/blob/main/LICENSE
  */(function(e,t){(function(n){e.exports=n()})(function(){return function n(r,i,s){function o(l,u){if(!i[l]){if(!r[l]){var f=typeof Lc=="function"&&Lc;if(!u&&f)return f(l,!0);if(a)return a(l,!0);var d=new Error("Cannot find module '"+l+"'");throw d.code="MODULE_NOT_FOUND",d}var h=i[l]={exports:{}};r[l][0].call(h.exports,function(p){var m=r[l][1][p];return o(m||p)},h,h.exports,n,r,i,s)}return i[l].exports}for(var a=typeof Lc=="function"&&Lc,c=0;c<s.length;c++)o(s[c]);return o}({1:[function(n,r,i){var s=n("./utils"),o=n("./support"),a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";i.encode=function(c){for(var l,u,f,d,h,p,m,b=[],_=0,w=c.length,v=w,k=s.getTypeOf(c)!=="string";_<c.length;)v=w-_,f=k?(l=c[_++],u=_<w?c[_++]:0,_<w?c[_++]:0):(l=c.charCodeAt(_++),u=_<w?c.charCodeAt(_++):0,_<w?c.charCodeAt(_++):0),d=l>>2,h=(3&l)<<4|u>>4,p=1<v?(15&u)<<2|f>>6:64,m=2<v?63&f:64,b.push(a.charAt(d)+a.charAt(h)+a.charAt(p)+a.charAt(m));return b.join("")},i.decode=function(c){var l,u,f,d,h,p,m=0,b=0,_="data:";if(c.substr(0,_.length)===_)throw new Error("Invalid base64 input, it looks like a data url.");var w,v=3*(c=c.replace(/[^A-Za-z0-9+/=]/g,"")).length/4;if(c.charAt(c.length-1)===a.charAt(64)&&v--,c.charAt(c.length-2)===a.charAt(64)&&v--,v%1!=0)throw new Error("Invalid base64 input, bad content length.");for(w=o.uint8array?new Uint8Array(0|v):new Array(0|v);m<c.length;)l=a.indexOf(c.charAt(m++))<<2|(d=a.indexOf(c.charAt(m++)))>>4,u=(15&d)<<4|(h=a.indexOf(c.charAt(m++)))>>2,f=(3&h)<<6|(p=a.indexOf(c.charAt(m++))),w[b++]=l,h!==64&&(w[b++]=u),p!==64&&(w[b++]=f);return w}},{"./support":30,"./utils":32}],2:[function(n,r,i){var s=n("./external"),o=n("./stream/DataWorker"),a=n("./stream/Crc32Probe"),c=n("./stream/DataLengthProbe");function l(u,f,d,h,p){this.compressedSize=u,this.uncompressedSize=f,this.crc32=d,this.compression=h,this.compressedContent=p}l.prototype={getContentWorker:function(){var u=new o(s.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new c("data_length")),f=this;return u.on("end",function(){if(this.streamInfo.data_length!==f.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")}),u},getCompressedWorker:function(){return new o(s.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},l.createWorkerFrom=function(u,f,d){return u.pipe(new a).pipe(new c("uncompressedSize")).pipe(f.compressWorker(d)).pipe(new c("compressedSize")).withStreamInfo("compression",f)},r.exports=l},{"./external":6,"./stream/Crc32Probe":25,"./stream/DataLengthProbe":26,"./stream/DataWorker":27}],3:[function(n,r,i){var s=n("./stream/GenericWorker");i.STORE={magic:"\0\0",compressWorker:function(){return new s("STORE compression")},uncompressWorker:function(){return new s("STORE decompression")}},i.DEFLATE=n("./flate")},{"./flate":7,"./stream/GenericWorker":28}],4:[function(n,r,i){var s=n("./utils"),o=function(){for(var a,c=[],l=0;l<256;l++){a=l;for(var u=0;u<8;u++)a=1&a?3988292384^a>>>1:a>>>1;c[l]=a}return c}();r.exports=function(a,c){return a!==void 0&&a.length?s.getTypeOf(a)!=="string"?function(l,u,f,d){var h=o,p=d+f;l^=-1;for(var m=d;m<p;m++)l=l>>>8^h[255&(l^u[m])];return-1^l}(0|c,a,a.length,0):function(l,u,f,d){var h=o,p=d+f;l^=-1;for(var m=d;m<p;m++)l=l>>>8^h[255&(l^u.charCodeAt(m))];return-1^l}(0|c,a,a.length,0):0}},{"./utils":32}],5:[function(n,r,i){i.base64=!1,i.binary=!1,i.dir=!1,i.createFolders=!0,i.date=null,i.compression=null,i.compressionOptions=null,i.comment=null,i.unixPermissions=null,i.dosPermissions=null},{}],6:[function(n,r,i){var s=null;s=typeof Promise<"u"?Promise:n("lie"),r.exports={Promise:s}},{lie:37}],7:[function(n,r,i){var s=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Uint32Array<"u",o=n("pako"),a=n("./utils"),c=n("./stream/GenericWorker"),l=s?"uint8array":"array";function u(f,d){c.call(this,"FlateWorker/"+f),this._pako=null,this._pakoAction=f,this._pakoOptions=d,this.meta={}}i.magic="\b\0",a.inherits(u,c),u.prototype.processChunk=function(f){this.meta=f.meta,this._pako===null&&this._createPako(),this._pako.push(a.transformTo(l,f.data),!1)},u.prototype.flush=function(){c.prototype.flush.call(this),this._pako===null&&this._createPako(),this._pako.push([],!0)},u.prototype.cleanUp=function(){c.prototype.cleanUp.call(this),this._pako=null},u.prototype._createPako=function(){this._pako=new o[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var f=this;this._pako.onData=function(d){f.push({data:d,meta:f.meta})}},i.compressWorker=function(f){return new u("Deflate",f)},i.uncompressWorker=function(){return new u("Inflate",{})}},{"./stream/GenericWorker":28,"./utils":32,pako:38}],8:[function(n,r,i){function s(h,p){var m,b="";for(m=0;m<p;m++)b+=String.fromCharCode(255&h),h>>>=8;return b}function o(h,p,m,b,_,w){var v,k,C=h.file,I=h.compression,T=w!==l.utf8encode,L=a.transformTo("string",w(C.name)),x=a.transformTo("string",l.utf8encode(C.name)),V=C.comment,se=a.transformTo("string",w(V)),O=a.transformTo("string",l.utf8encode(V)),E=x.length!==C.name.length,g=O.length!==V.length,N="",W="",B="",Z=C.dir,H=C.date,Y={crc32:0,compressedSize:0,uncompressedSize:0};p&&!m||(Y.crc32=h.crc32,Y.compressedSize=h.compressedSize,Y.uncompressedSize=h.uncompressedSize);var $=0;p&&($|=8),T||!E&&!g||($|=2048);var F=0,ue=0;Z&&(F|=16),_==="UNIX"?(ue=798,F|=function(ee,Se){var je=ee;return ee||(je=Se?16893:33204),(65535&je)<<16}(C.unixPermissions,Z)):(ue=20,F|=function(ee){return 63&(ee||0)}(C.dosPermissions)),v=H.getUTCHours(),v<<=6,v|=H.getUTCMinutes(),v<<=5,v|=H.getUTCSeconds()/2,k=H.getUTCFullYear()-1980,k<<=4,k|=H.getUTCMonth()+1,k<<=5,k|=H.getUTCDate(),E&&(W=s(1,1)+s(u(L),4)+x,N+="up"+s(W.length,2)+W),g&&(B=s(1,1)+s(u(se),4)+O,N+="uc"+s(B.length,2)+B);var Q="";return Q+=`
\0`,Q+=s($,2),Q+=I.magic,Q+=s(v,2),Q+=s(k,2),Q+=s(Y.crc32,4),Q+=s(Y.compressedSize,4),Q+=s(Y.uncompressedSize,4),Q+=s(L.length,2),Q+=s(N.length,2),{fileRecord:f.LOCAL_FILE_HEADER+Q+L+N,dirRecord:f.CENTRAL_FILE_HEADER+s(ue,2)+Q+s(se.length,2)+"\0\0\0\0"+s(F,4)+s(b,4)+L+N+se}}var a=n("../utils"),c=n("../stream/GenericWorker"),l=n("../utf8"),u=n("../crc32"),f=n("../signature");function d(h,p,m,b){c.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=p,this.zipPlatform=m,this.encodeFileName=b,this.streamFiles=h,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}a.inherits(d,c),d.prototype.push=function(h){var p=h.meta.percent||0,m=this.entriesCount,b=this._sources.length;this.accumulate?this.contentBuffer.push(h):(this.bytesWritten+=h.data.length,c.prototype.push.call(this,{data:h.data,meta:{currentFile:this.currentFile,percent:m?(p+100*(m-b-1))/m:100}}))},d.prototype.openedSource=function(h){this.currentSourceOffset=this.bytesWritten,this.currentFile=h.file.name;var p=this.streamFiles&&!h.file.dir;if(p){var m=o(h,p,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:m.fileRecord,meta:{percent:0}})}else this.accumulate=!0},d.prototype.closedSource=function(h){this.accumulate=!1;var p=this.streamFiles&&!h.file.dir,m=o(h,p,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(m.dirRecord),p)this.push({data:function(b){return f.DATA_DESCRIPTOR+s(b.crc32,4)+s(b.compressedSize,4)+s(b.uncompressedSize,4)}(h),meta:{percent:100}});else for(this.push({data:m.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},d.prototype.flush=function(){for(var h=this.bytesWritten,p=0;p<this.dirRecords.length;p++)this.push({data:this.dirRecords[p],meta:{percent:100}});var m=this.bytesWritten-h,b=function(_,w,v,k,C){var I=a.transformTo("string",C(k));return f.CENTRAL_DIRECTORY_END+"\0\0\0\0"+s(_,2)+s(_,2)+s(w,4)+s(v,4)+s(I.length,2)+I}(this.dirRecords.length,m,h,this.zipComment,this.encodeFileName);this.push({data:b,meta:{percent:100}})},d.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},d.prototype.registerPrevious=function(h){this._sources.push(h);var p=this;return h.on("data",function(m){p.processChunk(m)}),h.on("end",function(){p.closedSource(p.previous.streamInfo),p._sources.length?p.prepareNextSource():p.end()}),h.on("error",function(m){p.error(m)}),this},d.prototype.resume=function(){return!!c.prototype.resume.call(this)&&(!this.previous&&this._sources.length?(this.prepareNextSource(),!0):this.previous||this._sources.length||this.generatedError?void 0:(this.end(),!0))},d.prototype.error=function(h){var p=this._sources;if(!c.prototype.error.call(this,h))return!1;for(var m=0;m<p.length;m++)try{p[m].error(h)}catch{}return!0},d.prototype.lock=function(){c.prototype.lock.call(this);for(var h=this._sources,p=0;p<h.length;p++)h[p].lock()},r.exports=d},{"../crc32":4,"../signature":23,"../stream/GenericWorker":28,"../utf8":31,"../utils":32}],9:[function(n,r,i){var s=n("../compressions"),o=n("./ZipFileWorker");i.generateWorker=function(a,c,l){var u=new o(c.streamFiles,l,c.platform,c.encodeFileName),f=0;try{a.forEach(function(d,h){f++;var p=function(w,v){var k=w||v,C=s[k];if(!C)throw new Error(k+" is not a valid compression method !");return C}(h.options.compression,c.compression),m=h.options.compressionOptions||c.compressionOptions||{},b=h.dir,_=h.date;h._compressWorker(p,m).withStreamInfo("file",{name:d,dir:b,date:_,comment:h.comment||"",unixPermissions:h.unixPermissions,dosPermissions:h.dosPermissions}).pipe(u)}),u.entriesCount=f}catch(d){u.error(d)}return u}},{"../compressions":3,"./ZipFileWorker":8}],10:[function(n,r,i){function s(){if(!(this instanceof s))return new s;if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files=Object.create(null),this.comment=null,this.root="",this.clone=function(){var o=new s;for(var a in this)typeof this[a]!="function"&&(o[a]=this[a]);return o}}(s.prototype=n("./object")).loadAsync=n("./load"),s.support=n("./support"),s.defaults=n("./defaults"),s.version="3.10.1",s.loadAsync=function(o,a){return new s().loadAsync(o,a)},s.external=n("./external"),r.exports=s},{"./defaults":5,"./external":6,"./load":11,"./object":15,"./support":30}],11:[function(n,r,i){var s=n("./utils"),o=n("./external"),a=n("./utf8"),c=n("./zipEntries"),l=n("./stream/Crc32Probe"),u=n("./nodejsUtils");function f(d){return new o.Promise(function(h,p){var m=d.decompressed.getContentWorker().pipe(new l);m.on("error",function(b){p(b)}).on("end",function(){m.streamInfo.crc32!==d.decompressed.crc32?p(new Error("Corrupted zip : CRC32 mismatch")):h()}).resume()})}r.exports=function(d,h){var p=this;return h=s.extend(h||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:a.utf8decode}),u.isNode&&u.isStream(d)?o.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):s.prepareContent("the loaded zip file",d,!0,h.optimizedBinaryString,h.base64).then(function(m){var b=new c(h);return b.load(m),b}).then(function(m){var b=[o.Promise.resolve(m)],_=m.files;if(h.checkCRC32)for(var w=0;w<_.length;w++)b.push(f(_[w]));return o.Promise.all(b)}).then(function(m){for(var b=m.shift(),_=b.files,w=0;w<_.length;w++){var v=_[w],k=v.fileNameStr,C=s.resolve(v.fileNameStr);p.file(C,v.decompressed,{binary:!0,optimizedBinaryString:!0,date:v.date,dir:v.dir,comment:v.fileCommentStr.length?v.fileCommentStr:null,unixPermissions:v.unixPermissions,dosPermissions:v.dosPermissions,createFolders:h.createFolders}),v.dir||(p.file(C).unsafeOriginalName=k)}return b.zipComment.length&&(p.comment=b.zipComment),p})}},{"./external":6,"./nodejsUtils":14,"./stream/Crc32Probe":25,"./utf8":31,"./utils":32,"./zipEntries":33}],12:[function(n,r,i){var s=n("../utils"),o=n("../stream/GenericWorker");function a(c,l){o.call(this,"Nodejs stream input adapter for "+c),this._upstreamEnded=!1,this._bindStream(l)}s.inherits(a,o),a.prototype._bindStream=function(c){var l=this;(this._stream=c).pause(),c.on("data",function(u){l.push({data:u,meta:{percent:0}})}).on("error",function(u){l.isPaused?this.generatedError=u:l.error(u)}).on("end",function(){l.isPaused?l._upstreamEnded=!0:l.end()})},a.prototype.pause=function(){return!!o.prototype.pause.call(this)&&(this._stream.pause(),!0)},a.prototype.resume=function(){return!!o.prototype.resume.call(this)&&(this._upstreamEnded?this.end():this._stream.resume(),!0)},r.exports=a},{"../stream/GenericWorker":28,"../utils":32}],13:[function(n,r,i){var s=n("readable-stream").Readable;function o(a,c,l){s.call(this,c),this._helper=a;var u=this;a.on("data",function(f,d){u.push(f)||u._helper.pause(),l&&l(d)}).on("error",function(f){u.emit("error",f)}).on("end",function(){u.push(null)})}n("../utils").inherits(o,s),o.prototype._read=function(){this._helper.resume()},r.exports=o},{"../utils":32,"readable-stream":16}],14:[function(n,r,i){r.exports={isNode:typeof Buffer<"u",newBufferFrom:function(s,o){if(Buffer.from&&Buffer.from!==Uint8Array.from)return Buffer.from(s,o);if(typeof s=="number")throw new Error('The "data" argument must not be a number');return new Buffer(s,o)},allocBuffer:function(s){if(Buffer.alloc)return Buffer.alloc(s);var o=new Buffer(s);return o.fill(0),o},isBuffer:function(s){return Buffer.isBuffer(s)},isStream:function(s){return s&&typeof s.on=="function"&&typeof s.pause=="function"&&typeof s.resume=="function"}}},{}],15:[function(n,r,i){function s(C,I,T){var L,x=a.getTypeOf(I),V=a.extend(T||{},u);V.date=V.date||new Date,V.compression!==null&&(V.compression=V.compression.toUpperCase()),typeof V.unixPermissions=="string"&&(V.unixPermissions=parseInt(V.unixPermissions,8)),V.unixPermissions&&16384&V.unixPermissions&&(V.dir=!0),V.dosPermissions&&16&V.dosPermissions&&(V.dir=!0),V.dir&&(C=_(C)),V.createFolders&&(L=b(C))&&w.call(this,L,!0);var se=x==="string"&&V.binary===!1&&V.base64===!1;T&&T.binary!==void 0||(V.binary=!se),(I instanceof f&&I.uncompressedSize===0||V.dir||!I||I.length===0)&&(V.base64=!1,V.binary=!0,I="",V.compression="STORE",x="string");var O=null;O=I instanceof f||I instanceof c?I:p.isNode&&p.isStream(I)?new m(C,I):a.prepareContent(C,I,V.binary,V.optimizedBinaryString,V.base64);var E=new d(C,O,V);this.files[C]=E}var o=n("./utf8"),a=n("./utils"),c=n("./stream/GenericWorker"),l=n("./stream/StreamHelper"),u=n("./defaults"),f=n("./compressedObject"),d=n("./zipObject"),h=n("./generate"),p=n("./nodejsUtils"),m=n("./nodejs/NodejsStreamInputAdapter"),b=function(C){C.slice(-1)==="/"&&(C=C.substring(0,C.length-1));var I=C.lastIndexOf("/");return 0<I?C.substring(0,I):""},_=function(C){return C.slice(-1)!=="/"&&(C+="/"),C},w=function(C,I){return I=I!==void 0?I:u.createFolders,C=_(C),this.files[C]||s.call(this,C,null,{dir:!0,createFolders:I}),this.files[C]};function v(C){return Object.prototype.toString.call(C)==="[object RegExp]"}var k={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(C){var I,T,L;for(I in this.files)L=this.files[I],(T=I.slice(this.root.length,I.length))&&I.slice(0,this.root.length)===this.root&&C(T,L)},filter:function(C){var I=[];return this.forEach(function(T,L){C(T,L)&&I.push(L)}),I},file:function(C,I,T){if(arguments.length!==1)return C=this.root+C,s.call(this,C,I,T),this;if(v(C)){var L=C;return this.filter(function(V,se){return!se.dir&&L.test(V)})}var x=this.files[this.root+C];return x&&!x.dir?x:null},folder:function(C){if(!C)return this;if(v(C))return this.filter(function(x,V){return V.dir&&C.test(x)});var I=this.root+C,T=w.call(this,I),L=this.clone();return L.root=T.name,L},remove:function(C){C=this.root+C;var I=this.files[C];if(I||(C.slice(-1)!=="/"&&(C+="/"),I=this.files[C]),I&&!I.dir)delete this.files[C];else for(var T=this.filter(function(x,V){return V.name.slice(0,C.length)===C}),L=0;L<T.length;L++)delete this.files[T[L].name];return this},generate:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(C){var I,T={};try{if((T=a.extend(C||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:o.utf8encode})).type=T.type.toLowerCase(),T.compression=T.compression.toUpperCase(),T.type==="binarystring"&&(T.type="string"),!T.type)throw new Error("No output type specified.");a.checkSupport(T.type),T.platform!=="darwin"&&T.platform!=="freebsd"&&T.platform!=="linux"&&T.platform!=="sunos"||(T.platform="UNIX"),T.platform==="win32"&&(T.platform="DOS");var L=T.comment||this.comment||"";I=h.generateWorker(this,T,L)}catch(x){(I=new c("error")).error(x)}return new l(I,T.type||"string",T.mimeType)},generateAsync:function(C,I){return this.generateInternalStream(C).accumulate(I)},generateNodeStream:function(C,I){return(C=C||{}).type||(C.type="nodebuffer"),this.generateInternalStream(C).toNodejsStream(I)}};r.exports=k},{"./compressedObject":2,"./defaults":5,"./generate":9,"./nodejs/NodejsStreamInputAdapter":12,"./nodejsUtils":14,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31,"./utils":32,"./zipObject":35}],16:[function(n,r,i){r.exports=n("stream")},{stream:void 0}],17:[function(n,r,i){var s=n("./DataReader");function o(a){s.call(this,a);for(var c=0;c<this.data.length;c++)a[c]=255&a[c]}n("../utils").inherits(o,s),o.prototype.byteAt=function(a){return this.data[this.zero+a]},o.prototype.lastIndexOfSignature=function(a){for(var c=a.charCodeAt(0),l=a.charCodeAt(1),u=a.charCodeAt(2),f=a.charCodeAt(3),d=this.length-4;0<=d;--d)if(this.data[d]===c&&this.data[d+1]===l&&this.data[d+2]===u&&this.data[d+3]===f)return d-this.zero;return-1},o.prototype.readAndCheckSignature=function(a){var c=a.charCodeAt(0),l=a.charCodeAt(1),u=a.charCodeAt(2),f=a.charCodeAt(3),d=this.readData(4);return c===d[0]&&l===d[1]&&u===d[2]&&f===d[3]},o.prototype.readData=function(a){if(this.checkOffset(a),a===0)return[];var c=this.data.slice(this.zero+this.index,this.zero+this.index+a);return this.index+=a,c},r.exports=o},{"../utils":32,"./DataReader":18}],18:[function(n,r,i){var s=n("../utils");function o(a){this.data=a,this.length=a.length,this.index=0,this.zero=0}o.prototype={checkOffset:function(a){this.checkIndex(this.index+a)},checkIndex:function(a){if(this.length<this.zero+a||a<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+a+"). Corrupted zip ?")},setIndex:function(a){this.checkIndex(a),this.index=a},skip:function(a){this.setIndex(this.index+a)},byteAt:function(){},readInt:function(a){var c,l=0;for(this.checkOffset(a),c=this.index+a-1;c>=this.index;c--)l=(l<<8)+this.byteAt(c);return this.index+=a,l},readString:function(a){return s.transformTo("string",this.readData(a))},readData:function(){},lastIndexOfSignature:function(){},readAndCheckSignature:function(){},readDate:function(){var a=this.readInt(4);return new Date(Date.UTC(1980+(a>>25&127),(a>>21&15)-1,a>>16&31,a>>11&31,a>>5&63,(31&a)<<1))}},r.exports=o},{"../utils":32}],19:[function(n,r,i){var s=n("./Uint8ArrayReader");function o(a){s.call(this,a)}n("../utils").inherits(o,s),o.prototype.readData=function(a){this.checkOffset(a);var c=this.data.slice(this.zero+this.index,this.zero+this.index+a);return this.index+=a,c},r.exports=o},{"../utils":32,"./Uint8ArrayReader":21}],20:[function(n,r,i){var s=n("./DataReader");function o(a){s.call(this,a)}n("../utils").inherits(o,s),o.prototype.byteAt=function(a){return this.data.charCodeAt(this.zero+a)},o.prototype.lastIndexOfSignature=function(a){return this.data.lastIndexOf(a)-this.zero},o.prototype.readAndCheckSignature=function(a){return a===this.readData(4)},o.prototype.readData=function(a){this.checkOffset(a);var c=this.data.slice(this.zero+this.index,this.zero+this.index+a);return this.index+=a,c},r.exports=o},{"../utils":32,"./DataReader":18}],21:[function(n,r,i){var s=n("./ArrayReader");function o(a){s.call(this,a)}n("../utils").inherits(o,s),o.prototype.readData=function(a){if(this.checkOffset(a),a===0)return new Uint8Array(0);var c=this.data.subarray(this.zero+this.index,this.zero+this.index+a);return this.index+=a,c},r.exports=o},{"../utils":32,"./ArrayReader":17}],22:[function(n,r,i){var s=n("../utils"),o=n("../support"),a=n("./ArrayReader"),c=n("./StringReader"),l=n("./NodeBufferReader"),u=n("./Uint8ArrayReader");r.exports=function(f){var d=s.getTypeOf(f);return s.checkSupport(d),d!=="string"||o.uint8array?d==="nodebuffer"?new l(f):o.uint8array?new u(s.transformTo("uint8array",f)):new a(s.transformTo("array",f)):new c(f)}},{"../support":30,"../utils":32,"./ArrayReader":17,"./NodeBufferReader":19,"./StringReader":20,"./Uint8ArrayReader":21}],23:[function(n,r,i){i.LOCAL_FILE_HEADER="PK",i.CENTRAL_FILE_HEADER="PK",i.CENTRAL_DIRECTORY_END="PK",i.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK\x07",i.ZIP64_CENTRAL_DIRECTORY_END="PK",i.DATA_DESCRIPTOR="PK\x07\b"},{}],24:[function(n,r,i){var s=n("./GenericWorker"),o=n("../utils");function a(c){s.call(this,"ConvertWorker to "+c),this.destType=c}o.inherits(a,s),a.prototype.processChunk=function(c){this.push({data:o.transformTo(this.destType,c.data),meta:c.meta})},r.exports=a},{"../utils":32,"./GenericWorker":28}],25:[function(n,r,i){var s=n("./GenericWorker"),o=n("../crc32");function a(){s.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}n("../utils").inherits(a,s),a.prototype.processChunk=function(c){this.streamInfo.crc32=o(c.data,this.streamInfo.crc32||0),this.push(c)},r.exports=a},{"../crc32":4,"../utils":32,"./GenericWorker":28}],26:[function(n,r,i){var s=n("../utils"),o=n("./GenericWorker");function a(c){o.call(this,"DataLengthProbe for "+c),this.propName=c,this.withStreamInfo(c,0)}s.inherits(a,o),a.prototype.processChunk=function(c){if(c){var l=this.streamInfo[this.propName]||0;this.streamInfo[this.propName]=l+c.data.length}o.prototype.processChunk.call(this,c)},r.exports=a},{"../utils":32,"./GenericWorker":28}],27:[function(n,r,i){var s=n("../utils"),o=n("./GenericWorker");function a(c){o.call(this,"DataWorker");var l=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,c.then(function(u){l.dataIsReady=!0,l.data=u,l.max=u&&u.length||0,l.type=s.getTypeOf(u),l.isPaused||l._tickAndRepeat()},function(u){l.error(u)})}s.inherits(a,o),a.prototype.cleanUp=function(){o.prototype.cleanUp.call(this),this.data=null},a.prototype.resume=function(){return!!o.prototype.resume.call(this)&&(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,s.delay(this._tickAndRepeat,[],this)),!0)},a.prototype._tickAndRepeat=function(){this._tickScheduled=!1,this.isPaused||this.isFinished||(this._tick(),this.isFinished||(s.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},a.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var c=null,l=Math.min(this.max,this.index+16384);if(this.index>=this.max)return this.end();switch(this.type){case"string":c=this.data.substring(this.index,l);break;case"uint8array":c=this.data.subarray(this.index,l);break;case"array":case"nodebuffer":c=this.data.slice(this.index,l)}return this.index=l,this.push({data:c,meta:{percent:this.max?this.index/this.max*100:0}})},r.exports=a},{"../utils":32,"./GenericWorker":28}],28:[function(n,r,i){function s(o){this.name=o||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}s.prototype={push:function(o){this.emit("data",o)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(o){this.emit("error",o)}return!0},error:function(o){return!this.isFinished&&(this.isPaused?this.generatedError=o:(this.isFinished=!0,this.emit("error",o),this.previous&&this.previous.error(o),this.cleanUp()),!0)},on:function(o,a){return this._listeners[o].push(a),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(o,a){if(this._listeners[o])for(var c=0;c<this._listeners[o].length;c++)this._listeners[o][c].call(this,a)},pipe:function(o){return o.registerPrevious(this)},registerPrevious:function(o){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=o.streamInfo,this.mergeStreamInfo(),this.previous=o;var a=this;return o.on("data",function(c){a.processChunk(c)}),o.on("end",function(){a.end()}),o.on("error",function(c){a.error(c)}),this},pause:function(){return!this.isPaused&&!this.isFinished&&(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;var o=this.isPaused=!1;return this.generatedError&&(this.error(this.generatedError),o=!0),this.previous&&this.previous.resume(),!o},flush:function(){},processChunk:function(o){this.push(o)},withStreamInfo:function(o,a){return this.extraStreamInfo[o]=a,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var o in this.extraStreamInfo)Object.prototype.hasOwnProperty.call(this.extraStreamInfo,o)&&(this.streamInfo[o]=this.extraStreamInfo[o])},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var o="Worker "+this.name;return this.previous?this.previous+" -> "+o:o}},r.exports=s},{}],29:[function(n,r,i){var s=n("../utils"),o=n("./ConvertWorker"),a=n("./GenericWorker"),c=n("../base64"),l=n("../support"),u=n("../external"),f=null;if(l.nodestream)try{f=n("../nodejs/NodejsStreamOutputAdapter")}catch{}function d(p,m){return new u.Promise(function(b,_){var w=[],v=p._internalType,k=p._outputType,C=p._mimeType;p.on("data",function(I,T){w.push(I),m&&m(T)}).on("error",function(I){w=[],_(I)}).on("end",function(){try{var I=function(T,L,x){switch(T){case"blob":return s.newBlob(s.transformTo("arraybuffer",L),x);case"base64":return c.encode(L);default:return s.transformTo(T,L)}}(k,function(T,L){var x,V=0,se=null,O=0;for(x=0;x<L.length;x++)O+=L[x].length;switch(T){case"string":return L.join("");case"array":return Array.prototype.concat.apply([],L);case"uint8array":for(se=new Uint8Array(O),x=0;x<L.length;x++)se.set(L[x],V),V+=L[x].length;return se;case"nodebuffer":return Buffer.concat(L);default:throw new Error("concat : unsupported type '"+T+"'")}}(v,w),C);b(I)}catch(T){_(T)}w=[]}).resume()})}function h(p,m,b){var _=m;switch(m){case"blob":case"arraybuffer":_="uint8array";break;case"base64":_="string"}try{this._internalType=_,this._outputType=m,this._mimeType=b,s.checkSupport(_),this._worker=p.pipe(new o(_)),p.lock()}catch(w){this._worker=new a("error"),this._worker.error(w)}}h.prototype={accumulate:function(p){return d(this,p)},on:function(p,m){var b=this;return p==="data"?this._worker.on(p,function(_){m.call(b,_.data,_.meta)}):this._worker.on(p,function(){s.delay(m,arguments,b)}),this},resume:function(){return s.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(p){if(s.checkSupport("nodestream"),this._outputType!=="nodebuffer")throw new Error(this._outputType+" is not supported by this method");return new f(this,{objectMode:this._outputType!=="nodebuffer"},p)}},r.exports=h},{"../base64":1,"../external":6,"../nodejs/NodejsStreamOutputAdapter":13,"../support":30,"../utils":32,"./ConvertWorker":24,"./GenericWorker":28}],30:[function(n,r,i){if(i.base64=!0,i.array=!0,i.string=!0,i.arraybuffer=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u",i.nodebuffer=typeof Buffer<"u",i.uint8array=typeof Uint8Array<"u",typeof ArrayBuffer>"u")i.blob=!1;else{var s=new ArrayBuffer(0);try{i.blob=new Blob([s],{type:"application/zip"}).size===0}catch{try{var o=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);o.append(s),i.blob=o.getBlob("application/zip").size===0}catch{i.blob=!1}}}try{i.nodestream=!!n("readable-stream").Readable}catch{i.nodestream=!1}},{"readable-stream":16}],31:[function(n,r,i){for(var s=n("./utils"),o=n("./support"),a=n("./nodejsUtils"),c=n("./stream/GenericWorker"),l=new Array(256),u=0;u<256;u++)l[u]=252<=u?6:248<=u?5:240<=u?4:224<=u?3:192<=u?2:1;l[254]=l[254]=1;function f(){c.call(this,"utf-8 decode"),this.leftOver=null}function d(){c.call(this,"utf-8 encode")}i.utf8encode=function(h){return o.nodebuffer?a.newBufferFrom(h,"utf-8"):function(p){var m,b,_,w,v,k=p.length,C=0;for(w=0;w<k;w++)(64512&(b=p.charCodeAt(w)))==55296&&w+1<k&&(64512&(_=p.charCodeAt(w+1)))==56320&&(b=65536+(b-55296<<10)+(_-56320),w++),C+=b<128?1:b<2048?2:b<65536?3:4;for(m=o.uint8array?new Uint8Array(C):new Array(C),w=v=0;v<C;w++)(64512&(b=p.charCodeAt(w)))==55296&&w+1<k&&(64512&(_=p.charCodeAt(w+1)))==56320&&(b=65536+(b-55296<<10)+(_-56320),w++),b<128?m[v++]=b:(b<2048?m[v++]=192|b>>>6:(b<65536?m[v++]=224|b>>>12:(m[v++]=240|b>>>18,m[v++]=128|b>>>12&63),m[v++]=128|b>>>6&63),m[v++]=128|63&b);return m}(h)},i.utf8decode=function(h){return o.nodebuffer?s.transformTo("nodebuffer",h).toString("utf-8"):function(p){var m,b,_,w,v=p.length,k=new Array(2*v);for(m=b=0;m<v;)if((_=p[m++])<128)k[b++]=_;else if(4<(w=l[_]))k[b++]=65533,m+=w-1;else{for(_&=w===2?31:w===3?15:7;1<w&&m<v;)_=_<<6|63&p[m++],w--;1<w?k[b++]=65533:_<65536?k[b++]=_:(_-=65536,k[b++]=55296|_>>10&1023,k[b++]=56320|1023&_)}return k.length!==b&&(k.subarray?k=k.subarray(0,b):k.length=b),s.applyFromCharCode(k)}(h=s.transformTo(o.uint8array?"uint8array":"array",h))},s.inherits(f,c),f.prototype.processChunk=function(h){var p=s.transformTo(o.uint8array?"uint8array":"array",h.data);if(this.leftOver&&this.leftOver.length){if(o.uint8array){var m=p;(p=new Uint8Array(m.length+this.leftOver.length)).set(this.leftOver,0),p.set(m,this.leftOver.length)}else p=this.leftOver.concat(p);this.leftOver=null}var b=function(w,v){var k;for((v=v||w.length)>w.length&&(v=w.length),k=v-1;0<=k&&(192&w[k])==128;)k--;return k<0||k===0?v:k+l[w[k]]>v?k:v}(p),_=p;b!==p.length&&(o.uint8array?(_=p.subarray(0,b),this.leftOver=p.subarray(b,p.length)):(_=p.slice(0,b),this.leftOver=p.slice(b,p.length))),this.push({data:i.utf8decode(_),meta:h.meta})},f.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:i.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},i.Utf8DecodeWorker=f,s.inherits(d,c),d.prototype.processChunk=function(h){this.push({data:i.utf8encode(h.data),meta:h.meta})},i.Utf8EncodeWorker=d},{"./nodejsUtils":14,"./stream/GenericWorker":28,"./support":30,"./utils":32}],32:[function(n,r,i){var s=n("./support"),o=n("./base64"),a=n("./nodejsUtils"),c=n("./external");function l(m){return m}function u(m,b){for(var _=0;_<m.length;++_)b[_]=255&m.charCodeAt(_);return b}n("setimmediate"),i.newBlob=function(m,b){i.checkSupport("blob");try{return new Blob([m],{type:b})}catch{try{var _=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);return _.append(m),_.getBlob(b)}catch{throw new Error("Bug : can't construct the Blob.")}}};var f={stringifyByChunk:function(m,b,_){var w=[],v=0,k=m.length;if(k<=_)return String.fromCharCode.apply(null,m);for(;v<k;)b==="array"||b==="nodebuffer"?w.push(String.fromCharCode.apply(null,m.slice(v,Math.min(v+_,k)))):w.push(String.fromCharCode.apply(null,m.subarray(v,Math.min(v+_,k)))),v+=_;return w.join("")},stringifyByChar:function(m){for(var b="",_=0;_<m.length;_++)b+=String.fromCharCode(m[_]);return b},applyCanBeUsed:{uint8array:function(){try{return s.uint8array&&String.fromCharCode.apply(null,new Uint8Array(1)).length===1}catch{return!1}}(),nodebuffer:function(){try{return s.nodebuffer&&String.fromCharCode.apply(null,a.allocBuffer(1)).length===1}catch{return!1}}()}};function d(m){var b=65536,_=i.getTypeOf(m),w=!0;if(_==="uint8array"?w=f.applyCanBeUsed.uint8array:_==="nodebuffer"&&(w=f.applyCanBeUsed.nodebuffer),w)for(;1<b;)try{return f.stringifyByChunk(m,_,b)}catch{b=Math.floor(b/2)}return f.stringifyByChar(m)}function h(m,b){for(var _=0;_<m.length;_++)b[_]=m[_];return b}i.applyFromCharCode=d;var p={};p.string={string:l,array:function(m){return u(m,new Array(m.length))},arraybuffer:function(m){return p.string.uint8array(m).buffer},uint8array:function(m){return u(m,new Uint8Array(m.length))},nodebuffer:function(m){return u(m,a.allocBuffer(m.length))}},p.array={string:d,array:l,arraybuffer:function(m){return new Uint8Array(m).buffer},uint8array:function(m){return new Uint8Array(m)},nodebuffer:function(m){return a.newBufferFrom(m)}},p.arraybuffer={string:function(m){return d(new Uint8Array(m))},array:function(m){return h(new Uint8Array(m),new Array(m.byteLength))},arraybuffer:l,uint8array:function(m){return new Uint8Array(m)},nodebuffer:function(m){return a.newBufferFrom(new Uint8Array(m))}},p.uint8array={string:d,array:function(m){return h(m,new Array(m.length))},arraybuffer:function(m){return m.buffer},uint8array:l,nodebuffer:function(m){return a.newBufferFrom(m)}},p.nodebuffer={string:d,array:function(m){return h(m,new Array(m.length))},arraybuffer:function(m){return p.nodebuffer.uint8array(m).buffer},uint8array:function(m){return h(m,new Uint8Array(m.length))},nodebuffer:l},i.transformTo=function(m,b){if(b=b||"",!m)return b;i.checkSupport(m);var _=i.getTypeOf(b);return p[_][m](b)},i.resolve=function(m){for(var b=m.split("/"),_=[],w=0;w<b.length;w++){var v=b[w];v==="."||v===""&&w!==0&&w!==b.length-1||(v===".."?_.pop():_.push(v))}return _.join("/")},i.getTypeOf=function(m){return typeof m=="string"?"string":Object.prototype.toString.call(m)==="[object Array]"?"array":s.nodebuffer&&a.isBuffer(m)?"nodebuffer":s.uint8array&&m instanceof Uint8Array?"uint8array":s.arraybuffer&&m instanceof ArrayBuffer?"arraybuffer":void 0},i.checkSupport=function(m){if(!s[m.toLowerCase()])throw new Error(m+" is not supported by this platform")},i.MAX_VALUE_16BITS=65535,i.MAX_VALUE_32BITS=-1,i.pretty=function(m){var b,_,w="";for(_=0;_<(m||"").length;_++)w+="\\x"+((b=m.charCodeAt(_))<16?"0":"")+b.toString(16).toUpperCase();return w},i.delay=function(m,b,_){setImmediate(function(){m.apply(_||null,b||[])})},i.inherits=function(m,b){function _(){}_.prototype=b.prototype,m.prototype=new _},i.extend=function(){var m,b,_={};for(m=0;m<arguments.length;m++)for(b in arguments[m])Object.prototype.hasOwnProperty.call(arguments[m],b)&&_[b]===void 0&&(_[b]=arguments[m][b]);return _},i.prepareContent=function(m,b,_,w,v){return c.Promise.resolve(b).then(function(k){return s.blob&&(k instanceof Blob||["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(k))!==-1)&&typeof FileReader<"u"?new c.Promise(function(C,I){var T=new FileReader;T.onload=function(L){C(L.target.result)},T.onerror=function(L){I(L.target.error)},T.readAsArrayBuffer(k)}):k}).then(function(k){var C=i.getTypeOf(k);return C?(C==="arraybuffer"?k=i.transformTo("uint8array",k):C==="string"&&(v?k=o.decode(k):_&&w!==!0&&(k=function(I){return u(I,s.uint8array?new Uint8Array(I.length):new Array(I.length))}(k))),k):c.Promise.reject(new Error("Can't read the data of '"+m+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))})}},{"./base64":1,"./external":6,"./nodejsUtils":14,"./support":30,setimmediate:54}],33:[function(n,r,i){var s=n("./reader/readerFor"),o=n("./utils"),a=n("./signature"),c=n("./zipEntry"),l=n("./support");function u(f){this.files=[],this.loadOptions=f}u.prototype={checkSignature:function(f){if(!this.reader.readAndCheckSignature(f)){this.reader.index-=4;var d=this.reader.readString(4);throw new Error("Corrupted zip or bug: unexpected signature ("+o.pretty(d)+", expected "+o.pretty(f)+")")}},isSignature:function(f,d){var h=this.reader.index;this.reader.setIndex(f);var p=this.reader.readString(4)===d;return this.reader.setIndex(h),p},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var f=this.reader.readData(this.zipCommentLength),d=l.uint8array?"uint8array":"array",h=o.transformTo(d,f);this.zipComment=this.loadOptions.decodeFileName(h)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var f,d,h,p=this.zip64EndOfCentralSize-44;0<p;)f=this.reader.readInt(2),d=this.reader.readInt(4),h=this.reader.readData(d),this.zip64ExtensibleData[f]={id:f,length:d,value:h}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),1<this.disksCount)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var f,d;for(f=0;f<this.files.length;f++)d=this.files[f],this.reader.setIndex(d.localHeaderOffset),this.checkSignature(a.LOCAL_FILE_HEADER),d.readLocalPart(this.reader),d.handleUTF8(),d.processAttributes()},readCentralDir:function(){var f;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(a.CENTRAL_FILE_HEADER);)(f=new c({zip64:this.zip64},this.loadOptions)).readCentralPart(this.reader),this.files.push(f);if(this.centralDirRecords!==this.files.length&&this.centralDirRecords!==0&&this.files.length===0)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var f=this.reader.lastIndexOfSignature(a.CENTRAL_DIRECTORY_END);if(f<0)throw this.isSignature(0,a.LOCAL_FILE_HEADER)?new Error("Corrupted zip: can't find end of central directory"):new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html");this.reader.setIndex(f);var d=f;if(this.checkSignature(a.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===o.MAX_VALUE_16BITS||this.diskWithCentralDirStart===o.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===o.MAX_VALUE_16BITS||this.centralDirRecords===o.MAX_VALUE_16BITS||this.centralDirSize===o.MAX_VALUE_32BITS||this.centralDirOffset===o.MAX_VALUE_32BITS){if(this.zip64=!0,(f=this.reader.lastIndexOfSignature(a.ZIP64_CENTRAL_DIRECTORY_LOCATOR))<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(f),this.checkSignature(a.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,a.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(a.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(a.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var h=this.centralDirOffset+this.centralDirSize;this.zip64&&(h+=20,h+=12+this.zip64EndOfCentralSize);var p=d-h;if(0<p)this.isSignature(d,a.CENTRAL_FILE_HEADER)||(this.reader.zero=p);else if(p<0)throw new Error("Corrupted zip: missing "+Math.abs(p)+" bytes.")},prepareReader:function(f){this.reader=s(f)},load:function(f){this.prepareReader(f),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},r.exports=u},{"./reader/readerFor":22,"./signature":23,"./support":30,"./utils":32,"./zipEntry":34}],34:[function(n,r,i){var s=n("./reader/readerFor"),o=n("./utils"),a=n("./compressedObject"),c=n("./crc32"),l=n("./utf8"),u=n("./compressions"),f=n("./support");function d(h,p){this.options=h,this.loadOptions=p}d.prototype={isEncrypted:function(){return(1&this.bitFlag)==1},useUTF8:function(){return(2048&this.bitFlag)==2048},readLocalPart:function(h){var p,m;if(h.skip(22),this.fileNameLength=h.readInt(2),m=h.readInt(2),this.fileName=h.readData(this.fileNameLength),h.skip(m),this.compressedSize===-1||this.uncompressedSize===-1)throw new Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");if((p=function(b){for(var _ in u)if(Object.prototype.hasOwnProperty.call(u,_)&&u[_].magic===b)return u[_];return null}(this.compressionMethod))===null)throw new Error("Corrupted zip : compression "+o.pretty(this.compressionMethod)+" unknown (inner file : "+o.transformTo("string",this.fileName)+")");this.decompressed=new a(this.compressedSize,this.uncompressedSize,this.crc32,p,h.readData(this.compressedSize))},readCentralPart:function(h){this.versionMadeBy=h.readInt(2),h.skip(2),this.bitFlag=h.readInt(2),this.compressionMethod=h.readString(2),this.date=h.readDate(),this.crc32=h.readInt(4),this.compressedSize=h.readInt(4),this.uncompressedSize=h.readInt(4);var p=h.readInt(2);if(this.extraFieldsLength=h.readInt(2),this.fileCommentLength=h.readInt(2),this.diskNumberStart=h.readInt(2),this.internalFileAttributes=h.readInt(2),this.externalFileAttributes=h.readInt(4),this.localHeaderOffset=h.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");h.skip(p),this.readExtraFields(h),this.parseZIP64ExtraField(h),this.fileComment=h.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var h=this.versionMadeBy>>8;this.dir=!!(16&this.externalFileAttributes),h==0&&(this.dosPermissions=63&this.externalFileAttributes),h==3&&(this.unixPermissions=this.externalFileAttributes>>16&65535),this.dir||this.fileNameStr.slice(-1)!=="/"||(this.dir=!0)},parseZIP64ExtraField:function(){if(this.extraFields[1]){var h=s(this.extraFields[1].value);this.uncompressedSize===o.MAX_VALUE_32BITS&&(this.uncompressedSize=h.readInt(8)),this.compressedSize===o.MAX_VALUE_32BITS&&(this.compressedSize=h.readInt(8)),this.localHeaderOffset===o.MAX_VALUE_32BITS&&(this.localHeaderOffset=h.readInt(8)),this.diskNumberStart===o.MAX_VALUE_32BITS&&(this.diskNumberStart=h.readInt(4))}},readExtraFields:function(h){var p,m,b,_=h.index+this.extraFieldsLength;for(this.extraFields||(this.extraFields={});h.index+4<_;)p=h.readInt(2),m=h.readInt(2),b=h.readData(m),this.extraFields[p]={id:p,length:m,value:b};h.setIndex(_)},handleUTF8:function(){var h=f.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=l.utf8decode(this.fileName),this.fileCommentStr=l.utf8decode(this.fileComment);else{var p=this.findExtraFieldUnicodePath();if(p!==null)this.fileNameStr=p;else{var m=o.transformTo(h,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(m)}var b=this.findExtraFieldUnicodeComment();if(b!==null)this.fileCommentStr=b;else{var _=o.transformTo(h,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(_)}}},findExtraFieldUnicodePath:function(){var h=this.extraFields[28789];if(h){var p=s(h.value);return p.readInt(1)!==1||c(this.fileName)!==p.readInt(4)?null:l.utf8decode(p.readData(h.length-5))}return null},findExtraFieldUnicodeComment:function(){var h=this.extraFields[25461];if(h){var p=s(h.value);return p.readInt(1)!==1||c(this.fileComment)!==p.readInt(4)?null:l.utf8decode(p.readData(h.length-5))}return null}},r.exports=d},{"./compressedObject":2,"./compressions":3,"./crc32":4,"./reader/readerFor":22,"./support":30,"./utf8":31,"./utils":32}],35:[function(n,r,i){function s(p,m,b){this.name=p,this.dir=b.dir,this.date=b.date,this.comment=b.comment,this.unixPermissions=b.unixPermissions,this.dosPermissions=b.dosPermissions,this._data=m,this._dataBinary=b.binary,this.options={compression:b.compression,compressionOptions:b.compressionOptions}}var o=n("./stream/StreamHelper"),a=n("./stream/DataWorker"),c=n("./utf8"),l=n("./compressedObject"),u=n("./stream/GenericWorker");s.prototype={internalStream:function(p){var m=null,b="string";try{if(!p)throw new Error("No output type specified.");var _=(b=p.toLowerCase())==="string"||b==="text";b!=="binarystring"&&b!=="text"||(b="string"),m=this._decompressWorker();var w=!this._dataBinary;w&&!_&&(m=m.pipe(new c.Utf8EncodeWorker)),!w&&_&&(m=m.pipe(new c.Utf8DecodeWorker))}catch(v){(m=new u("error")).error(v)}return new o(m,b,"")},async:function(p,m){return this.internalStream(p).accumulate(m)},nodeStream:function(p,m){return this.internalStream(p||"nodebuffer").toNodejsStream(m)},_compressWorker:function(p,m){if(this._data instanceof l&&this._data.compression.magic===p.magic)return this._data.getCompressedWorker();var b=this._decompressWorker();return this._dataBinary||(b=b.pipe(new c.Utf8EncodeWorker)),l.createWorkerFrom(b,p,m)},_decompressWorker:function(){return this._data instanceof l?this._data.getContentWorker():this._data instanceof u?this._data:new a(this._data)}};for(var f=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],d=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},h=0;h<f.length;h++)s.prototype[f[h]]=d;r.exports=s},{"./compressedObject":2,"./stream/DataWorker":27,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31}],36:[function(n,r,i){(function(s){var o,a,c=s.MutationObserver||s.WebKitMutationObserver;if(c){var l=0,u=new c(p),f=s.document.createTextNode("");u.observe(f,{characterData:!0}),o=function(){f.data=l=++l%2}}else if(s.setImmediate||s.MessageChannel===void 0)o="document"in s&&"onreadystatechange"in s.document.createElement("script")?function(){var m=s.document.createElement("script");m.onreadystatechange=function(){p(),m.onreadystatechange=null,m.parentNode.removeChild(m),m=null},s.document.documentElement.appendChild(m)}:function(){setTimeout(p,0)};else{var d=new s.MessageChannel;d.port1.onmessage=p,o=function(){d.port2.postMessage(0)}}var h=[];function p(){var m,b;a=!0;for(var _=h.length;_;){for(b=h,h=[],m=-1;++m<_;)b[m]();_=h.length}a=!1}r.exports=function(m){h.push(m)!==1||a||o()}}).call(this,typeof Bt<"u"?Bt:typeof self<"u"?self:typeof window<"u"?window:{})},{}],37:[function(n,r,i){var s=n("immediate");function o(){}var a={},c=["REJECTED"],l=["FULFILLED"],u=["PENDING"];function f(_){if(typeof _!="function")throw new TypeError("resolver must be a function");this.state=u,this.queue=[],this.outcome=void 0,_!==o&&m(this,_)}function d(_,w,v){this.promise=_,typeof w=="function"&&(this.onFulfilled=w,this.callFulfilled=this.otherCallFulfilled),typeof v=="function"&&(this.onRejected=v,this.callRejected=this.otherCallRejected)}function h(_,w,v){s(function(){var k;try{k=w(v)}catch(C){return a.reject(_,C)}k===_?a.reject(_,new TypeError("Cannot resolve promise with itself")):a.resolve(_,k)})}function p(_){var w=_&&_.then;if(_&&(typeof _=="object"||typeof _=="function")&&typeof w=="function")return function(){w.apply(_,arguments)}}function m(_,w){var v=!1;function k(T){v||(v=!0,a.reject(_,T))}function C(T){v||(v=!0,a.resolve(_,T))}var I=b(function(){w(C,k)});I.status==="error"&&k(I.value)}function b(_,w){var v={};try{v.value=_(w),v.status="success"}catch(k){v.status="error",v.value=k}return v}(r.exports=f).prototype.finally=function(_){if(typeof _!="function")return this;var w=this.constructor;return this.then(function(v){return w.resolve(_()).then(function(){return v})},function(v){return w.resolve(_()).then(function(){throw v})})},f.prototype.catch=function(_){return this.then(null,_)},f.prototype.then=function(_,w){if(typeof _!="function"&&this.state===l||typeof w!="function"&&this.state===c)return this;var v=new this.constructor(o);return this.state!==u?h(v,this.state===l?_:w,this.outcome):this.queue.push(new d(v,_,w)),v},d.prototype.callFulfilled=function(_){a.resolve(this.promise,_)},d.prototype.otherCallFulfilled=function(_){h(this.promise,this.onFulfilled,_)},d.prototype.callRejected=function(_){a.reject(this.promise,_)},d.prototype.otherCallRejected=function(_){h(this.promise,this.onRejected,_)},a.resolve=function(_,w){var v=b(p,w);if(v.status==="error")return a.reject(_,v.value);var k=v.value;if(k)m(_,k);else{_.state=l,_.outcome=w;for(var C=-1,I=_.queue.length;++C<I;)_.queue[C].callFulfilled(w)}return _},a.reject=function(_,w){_.state=c,_.outcome=w;for(var v=-1,k=_.queue.length;++v<k;)_.queue[v].callRejected(w);return _},f.resolve=function(_){return _ instanceof this?_:a.resolve(new this(o),_)},f.reject=function(_){var w=new this(o);return a.reject(w,_)},f.all=function(_){var w=this;if(Object.prototype.toString.call(_)!=="[object Array]")return this.reject(new TypeError("must be an array"));var v=_.length,k=!1;if(!v)return this.resolve([]);for(var C=new Array(v),I=0,T=-1,L=new this(o);++T<v;)x(_[T],T);return L;function x(V,se){w.resolve(V).then(function(O){C[se]=O,++I!==v||k||(k=!0,a.resolve(L,C))},function(O){k||(k=!0,a.reject(L,O))})}},f.race=function(_){var w=this;if(Object.prototype.toString.call(_)!=="[object Array]")return this.reject(new TypeError("must be an array"));var v=_.length,k=!1;if(!v)return this.resolve([]);for(var C=-1,I=new this(o);++C<v;)T=_[C],w.resolve(T).then(function(L){k||(k=!0,a.resolve(I,L))},function(L){k||(k=!0,a.reject(I,L))});var T;return I}},{immediate:36}],38:[function(n,r,i){var s={};(0,n("./lib/utils/common").assign)(s,n("./lib/deflate"),n("./lib/inflate"),n("./lib/zlib/constants")),r.exports=s},{"./lib/deflate":39,"./lib/inflate":40,"./lib/utils/common":41,"./lib/zlib/constants":44}],39:[function(n,r,i){var s=n("./zlib/deflate"),o=n("./utils/common"),a=n("./utils/strings"),c=n("./zlib/messages"),l=n("./zlib/zstream"),u=Object.prototype.toString,f=0,d=-1,h=0,p=8;function m(_){if(!(this instanceof m))return new m(_);this.options=o.assign({level:d,method:p,chunkSize:16384,windowBits:15,memLevel:8,strategy:h,to:""},_||{});var w=this.options;w.raw&&0<w.windowBits?w.windowBits=-w.windowBits:w.gzip&&0<w.windowBits&&w.windowBits<16&&(w.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new l,this.strm.avail_out=0;var v=s.deflateInit2(this.strm,w.level,w.method,w.windowBits,w.memLevel,w.strategy);if(v!==f)throw new Error(c[v]);if(w.header&&s.deflateSetHeader(this.strm,w.header),w.dictionary){var k;if(k=typeof w.dictionary=="string"?a.string2buf(w.dictionary):u.call(w.dictionary)==="[object ArrayBuffer]"?new Uint8Array(w.dictionary):w.dictionary,(v=s.deflateSetDictionary(this.strm,k))!==f)throw new Error(c[v]);this._dict_set=!0}}function b(_,w){var v=new m(w);if(v.push(_,!0),v.err)throw v.msg||c[v.err];return v.result}m.prototype.push=function(_,w){var v,k,C=this.strm,I=this.options.chunkSize;if(this.ended)return!1;k=w===~~w?w:w===!0?4:0,typeof _=="string"?C.input=a.string2buf(_):u.call(_)==="[object ArrayBuffer]"?C.input=new Uint8Array(_):C.input=_,C.next_in=0,C.avail_in=C.input.length;do{if(C.avail_out===0&&(C.output=new o.Buf8(I),C.next_out=0,C.avail_out=I),(v=s.deflate(C,k))!==1&&v!==f)return this.onEnd(v),!(this.ended=!0);C.avail_out!==0&&(C.avail_in!==0||k!==4&&k!==2)||(this.options.to==="string"?this.onData(a.buf2binstring(o.shrinkBuf(C.output,C.next_out))):this.onData(o.shrinkBuf(C.output,C.next_out)))}while((0<C.avail_in||C.avail_out===0)&&v!==1);return k===4?(v=s.deflateEnd(this.strm),this.onEnd(v),this.ended=!0,v===f):k!==2||(this.onEnd(f),!(C.avail_out=0))},m.prototype.onData=function(_){this.chunks.push(_)},m.prototype.onEnd=function(_){_===f&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=o.flattenChunks(this.chunks)),this.chunks=[],this.err=_,this.msg=this.strm.msg},i.Deflate=m,i.deflate=b,i.deflateRaw=function(_,w){return(w=w||{}).raw=!0,b(_,w)},i.gzip=function(_,w){return(w=w||{}).gzip=!0,b(_,w)}},{"./utils/common":41,"./utils/strings":42,"./zlib/deflate":46,"./zlib/messages":51,"./zlib/zstream":53}],40:[function(n,r,i){var s=n("./zlib/inflate"),o=n("./utils/common"),a=n("./utils/strings"),c=n("./zlib/constants"),l=n("./zlib/messages"),u=n("./zlib/zstream"),f=n("./zlib/gzheader"),d=Object.prototype.toString;function h(m){if(!(this instanceof h))return new h(m);this.options=o.assign({chunkSize:16384,windowBits:0,to:""},m||{});var b=this.options;b.raw&&0<=b.windowBits&&b.windowBits<16&&(b.windowBits=-b.windowBits,b.windowBits===0&&(b.windowBits=-15)),!(0<=b.windowBits&&b.windowBits<16)||m&&m.windowBits||(b.windowBits+=32),15<b.windowBits&&b.windowBits<48&&!(15&b.windowBits)&&(b.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new u,this.strm.avail_out=0;var _=s.inflateInit2(this.strm,b.windowBits);if(_!==c.Z_OK)throw new Error(l[_]);this.header=new f,s.inflateGetHeader(this.strm,this.header)}function p(m,b){var _=new h(b);if(_.push(m,!0),_.err)throw _.msg||l[_.err];return _.result}h.prototype.push=function(m,b){var _,w,v,k,C,I,T=this.strm,L=this.options.chunkSize,x=this.options.dictionary,V=!1;if(this.ended)return!1;w=b===~~b?b:b===!0?c.Z_FINISH:c.Z_NO_FLUSH,typeof m=="string"?T.input=a.binstring2buf(m):d.call(m)==="[object ArrayBuffer]"?T.input=new Uint8Array(m):T.input=m,T.next_in=0,T.avail_in=T.input.length;do{if(T.avail_out===0&&(T.output=new o.Buf8(L),T.next_out=0,T.avail_out=L),(_=s.inflate(T,c.Z_NO_FLUSH))===c.Z_NEED_DICT&&x&&(I=typeof x=="string"?a.string2buf(x):d.call(x)==="[object ArrayBuffer]"?new Uint8Array(x):x,_=s.inflateSetDictionary(this.strm,I)),_===c.Z_BUF_ERROR&&V===!0&&(_=c.Z_OK,V=!1),_!==c.Z_STREAM_END&&_!==c.Z_OK)return this.onEnd(_),!(this.ended=!0);T.next_out&&(T.avail_out!==0&&_!==c.Z_STREAM_END&&(T.avail_in!==0||w!==c.Z_FINISH&&w!==c.Z_SYNC_FLUSH)||(this.options.to==="string"?(v=a.utf8border(T.output,T.next_out),k=T.next_out-v,C=a.buf2string(T.output,v),T.next_out=k,T.avail_out=L-k,k&&o.arraySet(T.output,T.output,v,k,0),this.onData(C)):this.onData(o.shrinkBuf(T.output,T.next_out)))),T.avail_in===0&&T.avail_out===0&&(V=!0)}while((0<T.avail_in||T.avail_out===0)&&_!==c.Z_STREAM_END);return _===c.Z_STREAM_END&&(w=c.Z_FINISH),w===c.Z_FINISH?(_=s.inflateEnd(this.strm),this.onEnd(_),this.ended=!0,_===c.Z_OK):w!==c.Z_SYNC_FLUSH||(this.onEnd(c.Z_OK),!(T.avail_out=0))},h.prototype.onData=function(m){this.chunks.push(m)},h.prototype.onEnd=function(m){m===c.Z_OK&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=o.flattenChunks(this.chunks)),this.chunks=[],this.err=m,this.msg=this.strm.msg},i.Inflate=h,i.inflate=p,i.inflateRaw=function(m,b){return(b=b||{}).raw=!0,p(m,b)},i.ungzip=p},{"./utils/common":41,"./utils/strings":42,"./zlib/constants":44,"./zlib/gzheader":47,"./zlib/inflate":49,"./zlib/messages":51,"./zlib/zstream":53}],41:[function(n,r,i){var s=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Int32Array<"u";i.assign=function(c){for(var l=Array.prototype.slice.call(arguments,1);l.length;){var u=l.shift();if(u){if(typeof u!="object")throw new TypeError(u+"must be non-object");for(var f in u)u.hasOwnProperty(f)&&(c[f]=u[f])}}return c},i.shrinkBuf=function(c,l){return c.length===l?c:c.subarray?c.subarray(0,l):(c.length=l,c)};var o={arraySet:function(c,l,u,f,d){if(l.subarray&&c.subarray)c.set(l.subarray(u,u+f),d);else for(var h=0;h<f;h++)c[d+h]=l[u+h]},flattenChunks:function(c){var l,u,f,d,h,p;for(l=f=0,u=c.length;l<u;l++)f+=c[l].length;for(p=new Uint8Array(f),l=d=0,u=c.length;l<u;l++)h=c[l],p.set(h,d),d+=h.length;return p}},a={arraySet:function(c,l,u,f,d){for(var h=0;h<f;h++)c[d+h]=l[u+h]},flattenChunks:function(c){return[].concat.apply([],c)}};i.setTyped=function(c){c?(i.Buf8=Uint8Array,i.Buf16=Uint16Array,i.Buf32=Int32Array,i.assign(i,o)):(i.Buf8=Array,i.Buf16=Array,i.Buf32=Array,i.assign(i,a))},i.setTyped(s)},{}],42:[function(n,r,i){var s=n("./common"),o=!0,a=!0;try{String.fromCharCode.apply(null,[0])}catch{o=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{a=!1}for(var c=new s.Buf8(256),l=0;l<256;l++)c[l]=252<=l?6:248<=l?5:240<=l?4:224<=l?3:192<=l?2:1;function u(f,d){if(d<65537&&(f.subarray&&a||!f.subarray&&o))return String.fromCharCode.apply(null,s.shrinkBuf(f,d));for(var h="",p=0;p<d;p++)h+=String.fromCharCode(f[p]);return h}c[254]=c[254]=1,i.string2buf=function(f){var d,h,p,m,b,_=f.length,w=0;for(m=0;m<_;m++)(64512&(h=f.charCodeAt(m)))==55296&&m+1<_&&(64512&(p=f.charCodeAt(m+1)))==56320&&(h=65536+(h-55296<<10)+(p-56320),m++),w+=h<128?1:h<2048?2:h<65536?3:4;for(d=new s.Buf8(w),m=b=0;b<w;m++)(64512&(h=f.charCodeAt(m)))==55296&&m+1<_&&(64512&(p=f.charCodeAt(m+1)))==56320&&(h=65536+(h-55296<<10)+(p-56320),m++),h<128?d[b++]=h:(h<2048?d[b++]=192|h>>>6:(h<65536?d[b++]=224|h>>>12:(d[b++]=240|h>>>18,d[b++]=128|h>>>12&63),d[b++]=128|h>>>6&63),d[b++]=128|63&h);return d},i.buf2binstring=function(f){return u(f,f.length)},i.binstring2buf=function(f){for(var d=new s.Buf8(f.length),h=0,p=d.length;h<p;h++)d[h]=f.charCodeAt(h);return d},i.buf2string=function(f,d){var h,p,m,b,_=d||f.length,w=new Array(2*_);for(h=p=0;h<_;)if((m=f[h++])<128)w[p++]=m;else if(4<(b=c[m]))w[p++]=65533,h+=b-1;else{for(m&=b===2?31:b===3?15:7;1<b&&h<_;)m=m<<6|63&f[h++],b--;1<b?w[p++]=65533:m<65536?w[p++]=m:(m-=65536,w[p++]=55296|m>>10&1023,w[p++]=56320|1023&m)}return u(w,p)},i.utf8border=function(f,d){var h;for((d=d||f.length)>f.length&&(d=f.length),h=d-1;0<=h&&(192&f[h])==128;)h--;return h<0||h===0?d:h+c[f[h]]>d?h:d}},{"./common":41}],43:[function(n,r,i){r.exports=function(s,o,a,c){for(var l=65535&s|0,u=s>>>16&65535|0,f=0;a!==0;){for(a-=f=2e3<a?2e3:a;u=u+(l=l+o[c++]|0)|0,--f;);l%=65521,u%=65521}return l|u<<16|0}},{}],44:[function(n,r,i){r.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],45:[function(n,r,i){var s=function(){for(var o,a=[],c=0;c<256;c++){o=c;for(var l=0;l<8;l++)o=1&o?3988292384^o>>>1:o>>>1;a[c]=o}return a}();r.exports=function(o,a,c,l){var u=s,f=l+c;o^=-1;for(var d=l;d<f;d++)o=o>>>8^u[255&(o^a[d])];return-1^o}},{}],46:[function(n,r,i){var s,o=n("../utils/common"),a=n("./trees"),c=n("./adler32"),l=n("./crc32"),u=n("./messages"),f=0,d=4,h=0,p=-2,m=-1,b=4,_=2,w=8,v=9,k=286,C=30,I=19,T=2*k+1,L=15,x=3,V=258,se=V+x+1,O=42,E=113,g=1,N=2,W=3,B=4;function Z(y,K){return y.msg=u[K],K}function H(y){return(y<<1)-(4<y?9:0)}function Y(y){for(var K=y.length;0<=--K;)y[K]=0}function $(y){var K=y.state,G=K.pending;G>y.avail_out&&(G=y.avail_out),G!==0&&(o.arraySet(y.output,K.pending_buf,K.pending_out,G,y.next_out),y.next_out+=G,K.pending_out+=G,y.total_out+=G,y.avail_out-=G,K.pending-=G,K.pending===0&&(K.pending_out=0))}function F(y,K){a._tr_flush_block(y,0<=y.block_start?y.block_start:-1,y.strstart-y.block_start,K),y.block_start=y.strstart,$(y.strm)}function ue(y,K){y.pending_buf[y.pending++]=K}function Q(y,K){y.pending_buf[y.pending++]=K>>>8&255,y.pending_buf[y.pending++]=255&K}function ee(y,K){var G,R,A=y.max_chain_length,P=y.strstart,X=y.prev_length,J=y.nice_match,z=y.strstart>y.w_size-se?y.strstart-(y.w_size-se):0,te=y.window,le=y.w_mask,ne=y.prev,de=y.strstart+V,Ze=te[P+X-1],Me=te[P+X];y.prev_length>=y.good_match&&(A>>=2),J>y.lookahead&&(J=y.lookahead);do if(te[(G=K)+X]===Me&&te[G+X-1]===Ze&&te[G]===te[P]&&te[++G]===te[P+1]){P+=2,G++;do;while(te[++P]===te[++G]&&te[++P]===te[++G]&&te[++P]===te[++G]&&te[++P]===te[++G]&&te[++P]===te[++G]&&te[++P]===te[++G]&&te[++P]===te[++G]&&te[++P]===te[++G]&&P<de);if(R=V-(de-P),P=de-V,X<R){if(y.match_start=K,J<=(X=R))break;Ze=te[P+X-1],Me=te[P+X]}}while((K=ne[K&le])>z&&--A!=0);return X<=y.lookahead?X:y.lookahead}function Se(y){var K,G,R,A,P,X,J,z,te,le,ne=y.w_size;do{if(A=y.window_size-y.lookahead-y.strstart,y.strstart>=ne+(ne-se)){for(o.arraySet(y.window,y.window,ne,ne,0),y.match_start-=ne,y.strstart-=ne,y.block_start-=ne,K=G=y.hash_size;R=y.head[--K],y.head[K]=ne<=R?R-ne:0,--G;);for(K=G=ne;R=y.prev[--K],y.prev[K]=ne<=R?R-ne:0,--G;);A+=ne}if(y.strm.avail_in===0)break;if(X=y.strm,J=y.window,z=y.strstart+y.lookahead,te=A,le=void 0,le=X.avail_in,te<le&&(le=te),G=le===0?0:(X.avail_in-=le,o.arraySet(J,X.input,X.next_in,le,z),X.state.wrap===1?X.adler=c(X.adler,J,le,z):X.state.wrap===2&&(X.adler=l(X.adler,J,le,z)),X.next_in+=le,X.total_in+=le,le),y.lookahead+=G,y.lookahead+y.insert>=x)for(P=y.strstart-y.insert,y.ins_h=y.window[P],y.ins_h=(y.ins_h<<y.hash_shift^y.window[P+1])&y.hash_mask;y.insert&&(y.ins_h=(y.ins_h<<y.hash_shift^y.window[P+x-1])&y.hash_mask,y.prev[P&y.w_mask]=y.head[y.ins_h],y.head[y.ins_h]=P,P++,y.insert--,!(y.lookahead+y.insert<x)););}while(y.lookahead<se&&y.strm.avail_in!==0)}function je(y,K){for(var G,R;;){if(y.lookahead<se){if(Se(y),y.lookahead<se&&K===f)return g;if(y.lookahead===0)break}if(G=0,y.lookahead>=x&&(y.ins_h=(y.ins_h<<y.hash_shift^y.window[y.strstart+x-1])&y.hash_mask,G=y.prev[y.strstart&y.w_mask]=y.head[y.ins_h],y.head[y.ins_h]=y.strstart),G!==0&&y.strstart-G<=y.w_size-se&&(y.match_length=ee(y,G)),y.match_length>=x)if(R=a._tr_tally(y,y.strstart-y.match_start,y.match_length-x),y.lookahead-=y.match_length,y.match_length<=y.max_lazy_match&&y.lookahead>=x){for(y.match_length--;y.strstart++,y.ins_h=(y.ins_h<<y.hash_shift^y.window[y.strstart+x-1])&y.hash_mask,G=y.prev[y.strstart&y.w_mask]=y.head[y.ins_h],y.head[y.ins_h]=y.strstart,--y.match_length!=0;);y.strstart++}else y.strstart+=y.match_length,y.match_length=0,y.ins_h=y.window[y.strstart],y.ins_h=(y.ins_h<<y.hash_shift^y.window[y.strstart+1])&y.hash_mask;else R=a._tr_tally(y,0,y.window[y.strstart]),y.lookahead--,y.strstart++;if(R&&(F(y,!1),y.strm.avail_out===0))return g}return y.insert=y.strstart<x-1?y.strstart:x-1,K===d?(F(y,!0),y.strm.avail_out===0?W:B):y.last_lit&&(F(y,!1),y.strm.avail_out===0)?g:N}function we(y,K){for(var G,R,A;;){if(y.lookahead<se){if(Se(y),y.lookahead<se&&K===f)return g;if(y.lookahead===0)break}if(G=0,y.lookahead>=x&&(y.ins_h=(y.ins_h<<y.hash_shift^y.window[y.strstart+x-1])&y.hash_mask,G=y.prev[y.strstart&y.w_mask]=y.head[y.ins_h],y.head[y.ins_h]=y.strstart),y.prev_length=y.match_length,y.prev_match=y.match_start,y.match_length=x-1,G!==0&&y.prev_length<y.max_lazy_match&&y.strstart-G<=y.w_size-se&&(y.match_length=ee(y,G),y.match_length<=5&&(y.strategy===1||y.match_length===x&&4096<y.strstart-y.match_start)&&(y.match_length=x-1)),y.prev_length>=x&&y.match_length<=y.prev_length){for(A=y.strstart+y.lookahead-x,R=a._tr_tally(y,y.strstart-1-y.prev_match,y.prev_length-x),y.lookahead-=y.prev_length-1,y.prev_length-=2;++y.strstart<=A&&(y.ins_h=(y.ins_h<<y.hash_shift^y.window[y.strstart+x-1])&y.hash_mask,G=y.prev[y.strstart&y.w_mask]=y.head[y.ins_h],y.head[y.ins_h]=y.strstart),--y.prev_length!=0;);if(y.match_available=0,y.match_length=x-1,y.strstart++,R&&(F(y,!1),y.strm.avail_out===0))return g}else if(y.match_available){if((R=a._tr_tally(y,0,y.window[y.strstart-1]))&&F(y,!1),y.strstart++,y.lookahead--,y.strm.avail_out===0)return g}else y.match_available=1,y.strstart++,y.lookahead--}return y.match_available&&(R=a._tr_tally(y,0,y.window[y.strstart-1]),y.match_available=0),y.insert=y.strstart<x-1?y.strstart:x-1,K===d?(F(y,!0),y.strm.avail_out===0?W:B):y.last_lit&&(F(y,!1),y.strm.avail_out===0)?g:N}function _e(y,K,G,R,A){this.good_length=y,this.max_lazy=K,this.nice_length=G,this.max_chain=R,this.func=A}function ze(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=w,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new o.Buf16(2*T),this.dyn_dtree=new o.Buf16(2*(2*C+1)),this.bl_tree=new o.Buf16(2*(2*I+1)),Y(this.dyn_ltree),Y(this.dyn_dtree),Y(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new o.Buf16(L+1),this.heap=new o.Buf16(2*k+1),Y(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new o.Buf16(2*k+1),Y(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function $e(y){var K;return y&&y.state?(y.total_in=y.total_out=0,y.data_type=_,(K=y.state).pending=0,K.pending_out=0,K.wrap<0&&(K.wrap=-K.wrap),K.status=K.wrap?O:E,y.adler=K.wrap===2?0:1,K.last_flush=f,a._tr_init(K),h):Z(y,p)}function mt(y){var K=$e(y);return K===h&&function(G){G.window_size=2*G.w_size,Y(G.head),G.max_lazy_match=s[G.level].max_lazy,G.good_match=s[G.level].good_length,G.nice_match=s[G.level].nice_length,G.max_chain_length=s[G.level].max_chain,G.strstart=0,G.block_start=0,G.lookahead=0,G.insert=0,G.match_length=G.prev_length=x-1,G.match_available=0,G.ins_h=0}(y.state),K}function St(y,K,G,R,A,P){if(!y)return p;var X=1;if(K===m&&(K=6),R<0?(X=0,R=-R):15<R&&(X=2,R-=16),A<1||v<A||G!==w||R<8||15<R||K<0||9<K||P<0||b<P)return Z(y,p);R===8&&(R=9);var J=new ze;return(y.state=J).strm=y,J.wrap=X,J.gzhead=null,J.w_bits=R,J.w_size=1<<J.w_bits,J.w_mask=J.w_size-1,J.hash_bits=A+7,J.hash_size=1<<J.hash_bits,J.hash_mask=J.hash_size-1,J.hash_shift=~~((J.hash_bits+x-1)/x),J.window=new o.Buf8(2*J.w_size),J.head=new o.Buf16(J.hash_size),J.prev=new o.Buf16(J.w_size),J.lit_bufsize=1<<A+6,J.pending_buf_size=4*J.lit_bufsize,J.pending_buf=new o.Buf8(J.pending_buf_size),J.d_buf=1*J.lit_bufsize,J.l_buf=3*J.lit_bufsize,J.level=K,J.strategy=P,J.method=G,mt(y)}s=[new _e(0,0,0,0,function(y,K){var G=65535;for(G>y.pending_buf_size-5&&(G=y.pending_buf_size-5);;){if(y.lookahead<=1){if(Se(y),y.lookahead===0&&K===f)return g;if(y.lookahead===0)break}y.strstart+=y.lookahead,y.lookahead=0;var R=y.block_start+G;if((y.strstart===0||y.strstart>=R)&&(y.lookahead=y.strstart-R,y.strstart=R,F(y,!1),y.strm.avail_out===0)||y.strstart-y.block_start>=y.w_size-se&&(F(y,!1),y.strm.avail_out===0))return g}return y.insert=0,K===d?(F(y,!0),y.strm.avail_out===0?W:B):(y.strstart>y.block_start&&(F(y,!1),y.strm.avail_out),g)}),new _e(4,4,8,4,je),new _e(4,5,16,8,je),new _e(4,6,32,32,je),new _e(4,4,16,16,we),new _e(8,16,32,32,we),new _e(8,16,128,128,we),new _e(8,32,128,256,we),new _e(32,128,258,1024,we),new _e(32,258,258,4096,we)],i.deflateInit=function(y,K){return St(y,K,w,15,8,0)},i.deflateInit2=St,i.deflateReset=mt,i.deflateResetKeep=$e,i.deflateSetHeader=function(y,K){return y&&y.state?y.state.wrap!==2?p:(y.state.gzhead=K,h):p},i.deflate=function(y,K){var G,R,A,P;if(!y||!y.state||5<K||K<0)return y?Z(y,p):p;if(R=y.state,!y.output||!y.input&&y.avail_in!==0||R.status===666&&K!==d)return Z(y,y.avail_out===0?-5:p);if(R.strm=y,G=R.last_flush,R.last_flush=K,R.status===O)if(R.wrap===2)y.adler=0,ue(R,31),ue(R,139),ue(R,8),R.gzhead?(ue(R,(R.gzhead.text?1:0)+(R.gzhead.hcrc?2:0)+(R.gzhead.extra?4:0)+(R.gzhead.name?8:0)+(R.gzhead.comment?16:0)),ue(R,255&R.gzhead.time),ue(R,R.gzhead.time>>8&255),ue(R,R.gzhead.time>>16&255),ue(R,R.gzhead.time>>24&255),ue(R,R.level===9?2:2<=R.strategy||R.level<2?4:0),ue(R,255&R.gzhead.os),R.gzhead.extra&&R.gzhead.extra.length&&(ue(R,255&R.gzhead.extra.length),ue(R,R.gzhead.extra.length>>8&255)),R.gzhead.hcrc&&(y.adler=l(y.adler,R.pending_buf,R.pending,0)),R.gzindex=0,R.status=69):(ue(R,0),ue(R,0),ue(R,0),ue(R,0),ue(R,0),ue(R,R.level===9?2:2<=R.strategy||R.level<2?4:0),ue(R,3),R.status=E);else{var X=w+(R.w_bits-8<<4)<<8;X|=(2<=R.strategy||R.level<2?0:R.level<6?1:R.level===6?2:3)<<6,R.strstart!==0&&(X|=32),X+=31-X%31,R.status=E,Q(R,X),R.strstart!==0&&(Q(R,y.adler>>>16),Q(R,65535&y.adler)),y.adler=1}if(R.status===69)if(R.gzhead.extra){for(A=R.pending;R.gzindex<(65535&R.gzhead.extra.length)&&(R.pending!==R.pending_buf_size||(R.gzhead.hcrc&&R.pending>A&&(y.adler=l(y.adler,R.pending_buf,R.pending-A,A)),$(y),A=R.pending,R.pending!==R.pending_buf_size));)ue(R,255&R.gzhead.extra[R.gzindex]),R.gzindex++;R.gzhead.hcrc&&R.pending>A&&(y.adler=l(y.adler,R.pending_buf,R.pending-A,A)),R.gzindex===R.gzhead.extra.length&&(R.gzindex=0,R.status=73)}else R.status=73;if(R.status===73)if(R.gzhead.name){A=R.pending;do{if(R.pending===R.pending_buf_size&&(R.gzhead.hcrc&&R.pending>A&&(y.adler=l(y.adler,R.pending_buf,R.pending-A,A)),$(y),A=R.pending,R.pending===R.pending_buf_size)){P=1;break}P=R.gzindex<R.gzhead.name.length?255&R.gzhead.name.charCodeAt(R.gzindex++):0,ue(R,P)}while(P!==0);R.gzhead.hcrc&&R.pending>A&&(y.adler=l(y.adler,R.pending_buf,R.pending-A,A)),P===0&&(R.gzindex=0,R.status=91)}else R.status=91;if(R.status===91)if(R.gzhead.comment){A=R.pending;do{if(R.pending===R.pending_buf_size&&(R.gzhead.hcrc&&R.pending>A&&(y.adler=l(y.adler,R.pending_buf,R.pending-A,A)),$(y),A=R.pending,R.pending===R.pending_buf_size)){P=1;break}P=R.gzindex<R.gzhead.comment.length?255&R.gzhead.comment.charCodeAt(R.gzindex++):0,ue(R,P)}while(P!==0);R.gzhead.hcrc&&R.pending>A&&(y.adler=l(y.adler,R.pending_buf,R.pending-A,A)),P===0&&(R.status=103)}else R.status=103;if(R.status===103&&(R.gzhead.hcrc?(R.pending+2>R.pending_buf_size&&$(y),R.pending+2<=R.pending_buf_size&&(ue(R,255&y.adler),ue(R,y.adler>>8&255),y.adler=0,R.status=E)):R.status=E),R.pending!==0){if($(y),y.avail_out===0)return R.last_flush=-1,h}else if(y.avail_in===0&&H(K)<=H(G)&&K!==d)return Z(y,-5);if(R.status===666&&y.avail_in!==0)return Z(y,-5);if(y.avail_in!==0||R.lookahead!==0||K!==f&&R.status!==666){var J=R.strategy===2?function(z,te){for(var le;;){if(z.lookahead===0&&(Se(z),z.lookahead===0)){if(te===f)return g;break}if(z.match_length=0,le=a._tr_tally(z,0,z.window[z.strstart]),z.lookahead--,z.strstart++,le&&(F(z,!1),z.strm.avail_out===0))return g}return z.insert=0,te===d?(F(z,!0),z.strm.avail_out===0?W:B):z.last_lit&&(F(z,!1),z.strm.avail_out===0)?g:N}(R,K):R.strategy===3?function(z,te){for(var le,ne,de,Ze,Me=z.window;;){if(z.lookahead<=V){if(Se(z),z.lookahead<=V&&te===f)return g;if(z.lookahead===0)break}if(z.match_length=0,z.lookahead>=x&&0<z.strstart&&(ne=Me[de=z.strstart-1])===Me[++de]&&ne===Me[++de]&&ne===Me[++de]){Ze=z.strstart+V;do;while(ne===Me[++de]&&ne===Me[++de]&&ne===Me[++de]&&ne===Me[++de]&&ne===Me[++de]&&ne===Me[++de]&&ne===Me[++de]&&ne===Me[++de]&&de<Ze);z.match_length=V-(Ze-de),z.match_length>z.lookahead&&(z.match_length=z.lookahead)}if(z.match_length>=x?(le=a._tr_tally(z,1,z.match_length-x),z.lookahead-=z.match_length,z.strstart+=z.match_length,z.match_length=0):(le=a._tr_tally(z,0,z.window[z.strstart]),z.lookahead--,z.strstart++),le&&(F(z,!1),z.strm.avail_out===0))return g}return z.insert=0,te===d?(F(z,!0),z.strm.avail_out===0?W:B):z.last_lit&&(F(z,!1),z.strm.avail_out===0)?g:N}(R,K):s[R.level].func(R,K);if(J!==W&&J!==B||(R.status=666),J===g||J===W)return y.avail_out===0&&(R.last_flush=-1),h;if(J===N&&(K===1?a._tr_align(R):K!==5&&(a._tr_stored_block(R,0,0,!1),K===3&&(Y(R.head),R.lookahead===0&&(R.strstart=0,R.block_start=0,R.insert=0))),$(y),y.avail_out===0))return R.last_flush=-1,h}return K!==d?h:R.wrap<=0?1:(R.wrap===2?(ue(R,255&y.adler),ue(R,y.adler>>8&255),ue(R,y.adler>>16&255),ue(R,y.adler>>24&255),ue(R,255&y.total_in),ue(R,y.total_in>>8&255),ue(R,y.total_in>>16&255),ue(R,y.total_in>>24&255)):(Q(R,y.adler>>>16),Q(R,65535&y.adler)),$(y),0<R.wrap&&(R.wrap=-R.wrap),R.pending!==0?h:1)},i.deflateEnd=function(y){var K;return y&&y.state?(K=y.state.status)!==O&&K!==69&&K!==73&&K!==91&&K!==103&&K!==E&&K!==666?Z(y,p):(y.state=null,K===E?Z(y,-3):h):p},i.deflateSetDictionary=function(y,K){var G,R,A,P,X,J,z,te,le=K.length;if(!y||!y.state||(P=(G=y.state).wrap)===2||P===1&&G.status!==O||G.lookahead)return p;for(P===1&&(y.adler=c(y.adler,K,le,0)),G.wrap=0,le>=G.w_size&&(P===0&&(Y(G.head),G.strstart=0,G.block_start=0,G.insert=0),te=new o.Buf8(G.w_size),o.arraySet(te,K,le-G.w_size,G.w_size,0),K=te,le=G.w_size),X=y.avail_in,J=y.next_in,z=y.input,y.avail_in=le,y.next_in=0,y.input=K,Se(G);G.lookahead>=x;){for(R=G.strstart,A=G.lookahead-(x-1);G.ins_h=(G.ins_h<<G.hash_shift^G.window[R+x-1])&G.hash_mask,G.prev[R&G.w_mask]=G.head[G.ins_h],G.head[G.ins_h]=R,R++,--A;);G.strstart=R,G.lookahead=x-1,Se(G)}return G.strstart+=G.lookahead,G.block_start=G.strstart,G.insert=G.lookahead,G.lookahead=0,G.match_length=G.prev_length=x-1,G.match_available=0,y.next_in=J,y.input=z,y.avail_in=X,G.wrap=P,h},i.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./messages":51,"./trees":52}],47:[function(n,r,i){r.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},{}],48:[function(n,r,i){r.exports=function(s,o){var a,c,l,u,f,d,h,p,m,b,_,w,v,k,C,I,T,L,x,V,se,O,E,g,N;a=s.state,c=s.next_in,g=s.input,l=c+(s.avail_in-5),u=s.next_out,N=s.output,f=u-(o-s.avail_out),d=u+(s.avail_out-257),h=a.dmax,p=a.wsize,m=a.whave,b=a.wnext,_=a.window,w=a.hold,v=a.bits,k=a.lencode,C=a.distcode,I=(1<<a.lenbits)-1,T=(1<<a.distbits)-1;e:do{v<15&&(w+=g[c++]<<v,v+=8,w+=g[c++]<<v,v+=8),L=k[w&I];t:for(;;){if(w>>>=x=L>>>24,v-=x,(x=L>>>16&255)===0)N[u++]=65535&L;else{if(!(16&x)){if(!(64&x)){L=k[(65535&L)+(w&(1<<x)-1)];continue t}if(32&x){a.mode=12;break e}s.msg="invalid literal/length code",a.mode=30;break e}V=65535&L,(x&=15)&&(v<x&&(w+=g[c++]<<v,v+=8),V+=w&(1<<x)-1,w>>>=x,v-=x),v<15&&(w+=g[c++]<<v,v+=8,w+=g[c++]<<v,v+=8),L=C[w&T];n:for(;;){if(w>>>=x=L>>>24,v-=x,!(16&(x=L>>>16&255))){if(!(64&x)){L=C[(65535&L)+(w&(1<<x)-1)];continue n}s.msg="invalid distance code",a.mode=30;break e}if(se=65535&L,v<(x&=15)&&(w+=g[c++]<<v,(v+=8)<x&&(w+=g[c++]<<v,v+=8)),h<(se+=w&(1<<x)-1)){s.msg="invalid distance too far back",a.mode=30;break e}if(w>>>=x,v-=x,(x=u-f)<se){if(m<(x=se-x)&&a.sane){s.msg="invalid distance too far back",a.mode=30;break e}if(E=_,(O=0)===b){if(O+=p-x,x<V){for(V-=x;N[u++]=_[O++],--x;);O=u-se,E=N}}else if(b<x){if(O+=p+b-x,(x-=b)<V){for(V-=x;N[u++]=_[O++],--x;);if(O=0,b<V){for(V-=x=b;N[u++]=_[O++],--x;);O=u-se,E=N}}}else if(O+=b-x,x<V){for(V-=x;N[u++]=_[O++],--x;);O=u-se,E=N}for(;2<V;)N[u++]=E[O++],N[u++]=E[O++],N[u++]=E[O++],V-=3;V&&(N[u++]=E[O++],1<V&&(N[u++]=E[O++]))}else{for(O=u-se;N[u++]=N[O++],N[u++]=N[O++],N[u++]=N[O++],2<(V-=3););V&&(N[u++]=N[O++],1<V&&(N[u++]=N[O++]))}break}}break}}while(c<l&&u<d);c-=V=v>>3,w&=(1<<(v-=V<<3))-1,s.next_in=c,s.next_out=u,s.avail_in=c<l?l-c+5:5-(c-l),s.avail_out=u<d?d-u+257:257-(u-d),a.hold=w,a.bits=v}},{}],49:[function(n,r,i){var s=n("../utils/common"),o=n("./adler32"),a=n("./crc32"),c=n("./inffast"),l=n("./inftrees"),u=1,f=2,d=0,h=-2,p=1,m=852,b=592;function _(O){return(O>>>24&255)+(O>>>8&65280)+((65280&O)<<8)+((255&O)<<24)}function w(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new s.Buf16(320),this.work=new s.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function v(O){var E;return O&&O.state?(E=O.state,O.total_in=O.total_out=E.total=0,O.msg="",E.wrap&&(O.adler=1&E.wrap),E.mode=p,E.last=0,E.havedict=0,E.dmax=32768,E.head=null,E.hold=0,E.bits=0,E.lencode=E.lendyn=new s.Buf32(m),E.distcode=E.distdyn=new s.Buf32(b),E.sane=1,E.back=-1,d):h}function k(O){var E;return O&&O.state?((E=O.state).wsize=0,E.whave=0,E.wnext=0,v(O)):h}function C(O,E){var g,N;return O&&O.state?(N=O.state,E<0?(g=0,E=-E):(g=1+(E>>4),E<48&&(E&=15)),E&&(E<8||15<E)?h:(N.window!==null&&N.wbits!==E&&(N.window=null),N.wrap=g,N.wbits=E,k(O))):h}function I(O,E){var g,N;return O?(N=new w,(O.state=N).window=null,(g=C(O,E))!==d&&(O.state=null),g):h}var T,L,x=!0;function V(O){if(x){var E;for(T=new s.Buf32(512),L=new s.Buf32(32),E=0;E<144;)O.lens[E++]=8;for(;E<256;)O.lens[E++]=9;for(;E<280;)O.lens[E++]=7;for(;E<288;)O.lens[E++]=8;for(l(u,O.lens,0,288,T,0,O.work,{bits:9}),E=0;E<32;)O.lens[E++]=5;l(f,O.lens,0,32,L,0,O.work,{bits:5}),x=!1}O.lencode=T,O.lenbits=9,O.distcode=L,O.distbits=5}function se(O,E,g,N){var W,B=O.state;return B.window===null&&(B.wsize=1<<B.wbits,B.wnext=0,B.whave=0,B.window=new s.Buf8(B.wsize)),N>=B.wsize?(s.arraySet(B.window,E,g-B.wsize,B.wsize,0),B.wnext=0,B.whave=B.wsize):(N<(W=B.wsize-B.wnext)&&(W=N),s.arraySet(B.window,E,g-N,W,B.wnext),(N-=W)?(s.arraySet(B.window,E,g-N,N,0),B.wnext=N,B.whave=B.wsize):(B.wnext+=W,B.wnext===B.wsize&&(B.wnext=0),B.whave<B.wsize&&(B.whave+=W))),0}i.inflateReset=k,i.inflateReset2=C,i.inflateResetKeep=v,i.inflateInit=function(O){return I(O,15)},i.inflateInit2=I,i.inflate=function(O,E){var g,N,W,B,Z,H,Y,$,F,ue,Q,ee,Se,je,we,_e,ze,$e,mt,St,y,K,G,R,A=0,P=new s.Buf8(4),X=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!O||!O.state||!O.output||!O.input&&O.avail_in!==0)return h;(g=O.state).mode===12&&(g.mode=13),Z=O.next_out,W=O.output,Y=O.avail_out,B=O.next_in,N=O.input,H=O.avail_in,$=g.hold,F=g.bits,ue=H,Q=Y,K=d;e:for(;;)switch(g.mode){case p:if(g.wrap===0){g.mode=13;break}for(;F<16;){if(H===0)break e;H--,$+=N[B++]<<F,F+=8}if(2&g.wrap&&$===35615){P[g.check=0]=255&$,P[1]=$>>>8&255,g.check=a(g.check,P,2,0),F=$=0,g.mode=2;break}if(g.flags=0,g.head&&(g.head.done=!1),!(1&g.wrap)||(((255&$)<<8)+($>>8))%31){O.msg="incorrect header check",g.mode=30;break}if((15&$)!=8){O.msg="unknown compression method",g.mode=30;break}if(F-=4,y=8+(15&($>>>=4)),g.wbits===0)g.wbits=y;else if(y>g.wbits){O.msg="invalid window size",g.mode=30;break}g.dmax=1<<y,O.adler=g.check=1,g.mode=512&$?10:12,F=$=0;break;case 2:for(;F<16;){if(H===0)break e;H--,$+=N[B++]<<F,F+=8}if(g.flags=$,(255&g.flags)!=8){O.msg="unknown compression method",g.mode=30;break}if(57344&g.flags){O.msg="unknown header flags set",g.mode=30;break}g.head&&(g.head.text=$>>8&1),512&g.flags&&(P[0]=255&$,P[1]=$>>>8&255,g.check=a(g.check,P,2,0)),F=$=0,g.mode=3;case 3:for(;F<32;){if(H===0)break e;H--,$+=N[B++]<<F,F+=8}g.head&&(g.head.time=$),512&g.flags&&(P[0]=255&$,P[1]=$>>>8&255,P[2]=$>>>16&255,P[3]=$>>>24&255,g.check=a(g.check,P,4,0)),F=$=0,g.mode=4;case 4:for(;F<16;){if(H===0)break e;H--,$+=N[B++]<<F,F+=8}g.head&&(g.head.xflags=255&$,g.head.os=$>>8),512&g.flags&&(P[0]=255&$,P[1]=$>>>8&255,g.check=a(g.check,P,2,0)),F=$=0,g.mode=5;case 5:if(1024&g.flags){for(;F<16;){if(H===0)break e;H--,$+=N[B++]<<F,F+=8}g.length=$,g.head&&(g.head.extra_len=$),512&g.flags&&(P[0]=255&$,P[1]=$>>>8&255,g.check=a(g.check,P,2,0)),F=$=0}else g.head&&(g.head.extra=null);g.mode=6;case 6:if(1024&g.flags&&(H<(ee=g.length)&&(ee=H),ee&&(g.head&&(y=g.head.extra_len-g.length,g.head.extra||(g.head.extra=new Array(g.head.extra_len)),s.arraySet(g.head.extra,N,B,ee,y)),512&g.flags&&(g.check=a(g.check,N,ee,B)),H-=ee,B+=ee,g.length-=ee),g.length))break e;g.length=0,g.mode=7;case 7:if(2048&g.flags){if(H===0)break e;for(ee=0;y=N[B+ee++],g.head&&y&&g.length<65536&&(g.head.name+=String.fromCharCode(y)),y&&ee<H;);if(512&g.flags&&(g.check=a(g.check,N,ee,B)),H-=ee,B+=ee,y)break e}else g.head&&(g.head.name=null);g.length=0,g.mode=8;case 8:if(4096&g.flags){if(H===0)break e;for(ee=0;y=N[B+ee++],g.head&&y&&g.length<65536&&(g.head.comment+=String.fromCharCode(y)),y&&ee<H;);if(512&g.flags&&(g.check=a(g.check,N,ee,B)),H-=ee,B+=ee,y)break e}else g.head&&(g.head.comment=null);g.mode=9;case 9:if(512&g.flags){for(;F<16;){if(H===0)break e;H--,$+=N[B++]<<F,F+=8}if($!==(65535&g.check)){O.msg="header crc mismatch",g.mode=30;break}F=$=0}g.head&&(g.head.hcrc=g.flags>>9&1,g.head.done=!0),O.adler=g.check=0,g.mode=12;break;case 10:for(;F<32;){if(H===0)break e;H--,$+=N[B++]<<F,F+=8}O.adler=g.check=_($),F=$=0,g.mode=11;case 11:if(g.havedict===0)return O.next_out=Z,O.avail_out=Y,O.next_in=B,O.avail_in=H,g.hold=$,g.bits=F,2;O.adler=g.check=1,g.mode=12;case 12:if(E===5||E===6)break e;case 13:if(g.last){$>>>=7&F,F-=7&F,g.mode=27;break}for(;F<3;){if(H===0)break e;H--,$+=N[B++]<<F,F+=8}switch(g.last=1&$,F-=1,3&($>>>=1)){case 0:g.mode=14;break;case 1:if(V(g),g.mode=20,E!==6)break;$>>>=2,F-=2;break e;case 2:g.mode=17;break;case 3:O.msg="invalid block type",g.mode=30}$>>>=2,F-=2;break;case 14:for($>>>=7&F,F-=7&F;F<32;){if(H===0)break e;H--,$+=N[B++]<<F,F+=8}if((65535&$)!=($>>>16^65535)){O.msg="invalid stored block lengths",g.mode=30;break}if(g.length=65535&$,F=$=0,g.mode=15,E===6)break e;case 15:g.mode=16;case 16:if(ee=g.length){if(H<ee&&(ee=H),Y<ee&&(ee=Y),ee===0)break e;s.arraySet(W,N,B,ee,Z),H-=ee,B+=ee,Y-=ee,Z+=ee,g.length-=ee;break}g.mode=12;break;case 17:for(;F<14;){if(H===0)break e;H--,$+=N[B++]<<F,F+=8}if(g.nlen=257+(31&$),$>>>=5,F-=5,g.ndist=1+(31&$),$>>>=5,F-=5,g.ncode=4+(15&$),$>>>=4,F-=4,286<g.nlen||30<g.ndist){O.msg="too many length or distance symbols",g.mode=30;break}g.have=0,g.mode=18;case 18:for(;g.have<g.ncode;){for(;F<3;){if(H===0)break e;H--,$+=N[B++]<<F,F+=8}g.lens[X[g.have++]]=7&$,$>>>=3,F-=3}for(;g.have<19;)g.lens[X[g.have++]]=0;if(g.lencode=g.lendyn,g.lenbits=7,G={bits:g.lenbits},K=l(0,g.lens,0,19,g.lencode,0,g.work,G),g.lenbits=G.bits,K){O.msg="invalid code lengths set",g.mode=30;break}g.have=0,g.mode=19;case 19:for(;g.have<g.nlen+g.ndist;){for(;_e=(A=g.lencode[$&(1<<g.lenbits)-1])>>>16&255,ze=65535&A,!((we=A>>>24)<=F);){if(H===0)break e;H--,$+=N[B++]<<F,F+=8}if(ze<16)$>>>=we,F-=we,g.lens[g.have++]=ze;else{if(ze===16){for(R=we+2;F<R;){if(H===0)break e;H--,$+=N[B++]<<F,F+=8}if($>>>=we,F-=we,g.have===0){O.msg="invalid bit length repeat",g.mode=30;break}y=g.lens[g.have-1],ee=3+(3&$),$>>>=2,F-=2}else if(ze===17){for(R=we+3;F<R;){if(H===0)break e;H--,$+=N[B++]<<F,F+=8}F-=we,y=0,ee=3+(7&($>>>=we)),$>>>=3,F-=3}else{for(R=we+7;F<R;){if(H===0)break e;H--,$+=N[B++]<<F,F+=8}F-=we,y=0,ee=11+(127&($>>>=we)),$>>>=7,F-=7}if(g.have+ee>g.nlen+g.ndist){O.msg="invalid bit length repeat",g.mode=30;break}for(;ee--;)g.lens[g.have++]=y}}if(g.mode===30)break;if(g.lens[256]===0){O.msg="invalid code -- missing end-of-block",g.mode=30;break}if(g.lenbits=9,G={bits:g.lenbits},K=l(u,g.lens,0,g.nlen,g.lencode,0,g.work,G),g.lenbits=G.bits,K){O.msg="invalid literal/lengths set",g.mode=30;break}if(g.distbits=6,g.distcode=g.distdyn,G={bits:g.distbits},K=l(f,g.lens,g.nlen,g.ndist,g.distcode,0,g.work,G),g.distbits=G.bits,K){O.msg="invalid distances set",g.mode=30;break}if(g.mode=20,E===6)break e;case 20:g.mode=21;case 21:if(6<=H&&258<=Y){O.next_out=Z,O.avail_out=Y,O.next_in=B,O.avail_in=H,g.hold=$,g.bits=F,c(O,Q),Z=O.next_out,W=O.output,Y=O.avail_out,B=O.next_in,N=O.input,H=O.avail_in,$=g.hold,F=g.bits,g.mode===12&&(g.back=-1);break}for(g.back=0;_e=(A=g.lencode[$&(1<<g.lenbits)-1])>>>16&255,ze=65535&A,!((we=A>>>24)<=F);){if(H===0)break e;H--,$+=N[B++]<<F,F+=8}if(_e&&!(240&_e)){for($e=we,mt=_e,St=ze;_e=(A=g.lencode[St+(($&(1<<$e+mt)-1)>>$e)])>>>16&255,ze=65535&A,!($e+(we=A>>>24)<=F);){if(H===0)break e;H--,$+=N[B++]<<F,F+=8}$>>>=$e,F-=$e,g.back+=$e}if($>>>=we,F-=we,g.back+=we,g.length=ze,_e===0){g.mode=26;break}if(32&_e){g.back=-1,g.mode=12;break}if(64&_e){O.msg="invalid literal/length code",g.mode=30;break}g.extra=15&_e,g.mode=22;case 22:if(g.extra){for(R=g.extra;F<R;){if(H===0)break e;H--,$+=N[B++]<<F,F+=8}g.length+=$&(1<<g.extra)-1,$>>>=g.extra,F-=g.extra,g.back+=g.extra}g.was=g.length,g.mode=23;case 23:for(;_e=(A=g.distcode[$&(1<<g.distbits)-1])>>>16&255,ze=65535&A,!((we=A>>>24)<=F);){if(H===0)break e;H--,$+=N[B++]<<F,F+=8}if(!(240&_e)){for($e=we,mt=_e,St=ze;_e=(A=g.distcode[St+(($&(1<<$e+mt)-1)>>$e)])>>>16&255,ze=65535&A,!($e+(we=A>>>24)<=F);){if(H===0)break e;H--,$+=N[B++]<<F,F+=8}$>>>=$e,F-=$e,g.back+=$e}if($>>>=we,F-=we,g.back+=we,64&_e){O.msg="invalid distance code",g.mode=30;break}g.offset=ze,g.extra=15&_e,g.mode=24;case 24:if(g.extra){for(R=g.extra;F<R;){if(H===0)break e;H--,$+=N[B++]<<F,F+=8}g.offset+=$&(1<<g.extra)-1,$>>>=g.extra,F-=g.extra,g.back+=g.extra}if(g.offset>g.dmax){O.msg="invalid distance too far back",g.mode=30;break}g.mode=25;case 25:if(Y===0)break e;if(ee=Q-Y,g.offset>ee){if((ee=g.offset-ee)>g.whave&&g.sane){O.msg="invalid distance too far back",g.mode=30;break}Se=ee>g.wnext?(ee-=g.wnext,g.wsize-ee):g.wnext-ee,ee>g.length&&(ee=g.length),je=g.window}else je=W,Se=Z-g.offset,ee=g.length;for(Y<ee&&(ee=Y),Y-=ee,g.length-=ee;W[Z++]=je[Se++],--ee;);g.length===0&&(g.mode=21);break;case 26:if(Y===0)break e;W[Z++]=g.length,Y--,g.mode=21;break;case 27:if(g.wrap){for(;F<32;){if(H===0)break e;H--,$|=N[B++]<<F,F+=8}if(Q-=Y,O.total_out+=Q,g.total+=Q,Q&&(O.adler=g.check=g.flags?a(g.check,W,Q,Z-Q):o(g.check,W,Q,Z-Q)),Q=Y,(g.flags?$:_($))!==g.check){O.msg="incorrect data check",g.mode=30;break}F=$=0}g.mode=28;case 28:if(g.wrap&&g.flags){for(;F<32;){if(H===0)break e;H--,$+=N[B++]<<F,F+=8}if($!==(4294967295&g.total)){O.msg="incorrect length check",g.mode=30;break}F=$=0}g.mode=29;case 29:K=1;break e;case 30:K=-3;break e;case 31:return-4;case 32:default:return h}return O.next_out=Z,O.avail_out=Y,O.next_in=B,O.avail_in=H,g.hold=$,g.bits=F,(g.wsize||Q!==O.avail_out&&g.mode<30&&(g.mode<27||E!==4))&&se(O,O.output,O.next_out,Q-O.avail_out)?(g.mode=31,-4):(ue-=O.avail_in,Q-=O.avail_out,O.total_in+=ue,O.total_out+=Q,g.total+=Q,g.wrap&&Q&&(O.adler=g.check=g.flags?a(g.check,W,Q,O.next_out-Q):o(g.check,W,Q,O.next_out-Q)),O.data_type=g.bits+(g.last?64:0)+(g.mode===12?128:0)+(g.mode===20||g.mode===15?256:0),(ue==0&&Q===0||E===4)&&K===d&&(K=-5),K)},i.inflateEnd=function(O){if(!O||!O.state)return h;var E=O.state;return E.window&&(E.window=null),O.state=null,d},i.inflateGetHeader=function(O,E){var g;return O&&O.state&&2&(g=O.state).wrap?((g.head=E).done=!1,d):h},i.inflateSetDictionary=function(O,E){var g,N=E.length;return O&&O.state?(g=O.state).wrap!==0&&g.mode!==11?h:g.mode===11&&o(1,E,N,0)!==g.check?-3:se(O,E,N,N)?(g.mode=31,-4):(g.havedict=1,d):h},i.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./inffast":48,"./inftrees":50}],50:[function(n,r,i){var s=n("../utils/common"),o=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],a=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],c=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],l=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];r.exports=function(u,f,d,h,p,m,b,_){var w,v,k,C,I,T,L,x,V,se=_.bits,O=0,E=0,g=0,N=0,W=0,B=0,Z=0,H=0,Y=0,$=0,F=null,ue=0,Q=new s.Buf16(16),ee=new s.Buf16(16),Se=null,je=0;for(O=0;O<=15;O++)Q[O]=0;for(E=0;E<h;E++)Q[f[d+E]]++;for(W=se,N=15;1<=N&&Q[N]===0;N--);if(N<W&&(W=N),N===0)return p[m++]=20971520,p[m++]=20971520,_.bits=1,0;for(g=1;g<N&&Q[g]===0;g++);for(W<g&&(W=g),O=H=1;O<=15;O++)if(H<<=1,(H-=Q[O])<0)return-1;if(0<H&&(u===0||N!==1))return-1;for(ee[1]=0,O=1;O<15;O++)ee[O+1]=ee[O]+Q[O];for(E=0;E<h;E++)f[d+E]!==0&&(b[ee[f[d+E]]++]=E);if(T=u===0?(F=Se=b,19):u===1?(F=o,ue-=257,Se=a,je-=257,256):(F=c,Se=l,-1),O=g,I=m,Z=E=$=0,k=-1,C=(Y=1<<(B=W))-1,u===1&&852<Y||u===2&&592<Y)return 1;for(;;){for(L=O-Z,V=b[E]<T?(x=0,b[E]):b[E]>T?(x=Se[je+b[E]],F[ue+b[E]]):(x=96,0),w=1<<O-Z,g=v=1<<B;p[I+($>>Z)+(v-=w)]=L<<24|x<<16|V|0,v!==0;);for(w=1<<O-1;$&w;)w>>=1;if(w!==0?($&=w-1,$+=w):$=0,E++,--Q[O]==0){if(O===N)break;O=f[d+b[E]]}if(W<O&&($&C)!==k){for(Z===0&&(Z=W),I+=g,H=1<<(B=O-Z);B+Z<N&&!((H-=Q[B+Z])<=0);)B++,H<<=1;if(Y+=1<<B,u===1&&852<Y||u===2&&592<Y)return 1;p[k=$&C]=W<<24|B<<16|I-m|0}}return $!==0&&(p[I+$]=O-Z<<24|64<<16|0),_.bits=W,0}},{"../utils/common":41}],51:[function(n,r,i){r.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],52:[function(n,r,i){var s=n("../utils/common"),o=0,a=1;function c(A){for(var P=A.length;0<=--P;)A[P]=0}var l=0,u=29,f=256,d=f+1+u,h=30,p=19,m=2*d+1,b=15,_=16,w=7,v=256,k=16,C=17,I=18,T=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],L=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],x=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],V=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],se=new Array(2*(d+2));c(se);var O=new Array(2*h);c(O);var E=new Array(512);c(E);var g=new Array(256);c(g);var N=new Array(u);c(N);var W,B,Z,H=new Array(h);function Y(A,P,X,J,z){this.static_tree=A,this.extra_bits=P,this.extra_base=X,this.elems=J,this.max_length=z,this.has_stree=A&&A.length}function $(A,P){this.dyn_tree=A,this.max_code=0,this.stat_desc=P}function F(A){return A<256?E[A]:E[256+(A>>>7)]}function ue(A,P){A.pending_buf[A.pending++]=255&P,A.pending_buf[A.pending++]=P>>>8&255}function Q(A,P,X){A.bi_valid>_-X?(A.bi_buf|=P<<A.bi_valid&65535,ue(A,A.bi_buf),A.bi_buf=P>>_-A.bi_valid,A.bi_valid+=X-_):(A.bi_buf|=P<<A.bi_valid&65535,A.bi_valid+=X)}function ee(A,P,X){Q(A,X[2*P],X[2*P+1])}function Se(A,P){for(var X=0;X|=1&A,A>>>=1,X<<=1,0<--P;);return X>>>1}function je(A,P,X){var J,z,te=new Array(b+1),le=0;for(J=1;J<=b;J++)te[J]=le=le+X[J-1]<<1;for(z=0;z<=P;z++){var ne=A[2*z+1];ne!==0&&(A[2*z]=Se(te[ne]++,ne))}}function we(A){var P;for(P=0;P<d;P++)A.dyn_ltree[2*P]=0;for(P=0;P<h;P++)A.dyn_dtree[2*P]=0;for(P=0;P<p;P++)A.bl_tree[2*P]=0;A.dyn_ltree[2*v]=1,A.opt_len=A.static_len=0,A.last_lit=A.matches=0}function _e(A){8<A.bi_valid?ue(A,A.bi_buf):0<A.bi_valid&&(A.pending_buf[A.pending++]=A.bi_buf),A.bi_buf=0,A.bi_valid=0}function ze(A,P,X,J){var z=2*P,te=2*X;return A[z]<A[te]||A[z]===A[te]&&J[P]<=J[X]}function $e(A,P,X){for(var J=A.heap[X],z=X<<1;z<=A.heap_len&&(z<A.heap_len&&ze(P,A.heap[z+1],A.heap[z],A.depth)&&z++,!ze(P,J,A.heap[z],A.depth));)A.heap[X]=A.heap[z],X=z,z<<=1;A.heap[X]=J}function mt(A,P,X){var J,z,te,le,ne=0;if(A.last_lit!==0)for(;J=A.pending_buf[A.d_buf+2*ne]<<8|A.pending_buf[A.d_buf+2*ne+1],z=A.pending_buf[A.l_buf+ne],ne++,J===0?ee(A,z,P):(ee(A,(te=g[z])+f+1,P),(le=T[te])!==0&&Q(A,z-=N[te],le),ee(A,te=F(--J),X),(le=L[te])!==0&&Q(A,J-=H[te],le)),ne<A.last_lit;);ee(A,v,P)}function St(A,P){var X,J,z,te=P.dyn_tree,le=P.stat_desc.static_tree,ne=P.stat_desc.has_stree,de=P.stat_desc.elems,Ze=-1;for(A.heap_len=0,A.heap_max=m,X=0;X<de;X++)te[2*X]!==0?(A.heap[++A.heap_len]=Ze=X,A.depth[X]=0):te[2*X+1]=0;for(;A.heap_len<2;)te[2*(z=A.heap[++A.heap_len]=Ze<2?++Ze:0)]=1,A.depth[z]=0,A.opt_len--,ne&&(A.static_len-=le[2*z+1]);for(P.max_code=Ze,X=A.heap_len>>1;1<=X;X--)$e(A,te,X);for(z=de;X=A.heap[1],A.heap[1]=A.heap[A.heap_len--],$e(A,te,1),J=A.heap[1],A.heap[--A.heap_max]=X,A.heap[--A.heap_max]=J,te[2*z]=te[2*X]+te[2*J],A.depth[z]=(A.depth[X]>=A.depth[J]?A.depth[X]:A.depth[J])+1,te[2*X+1]=te[2*J+1]=z,A.heap[1]=z++,$e(A,te,1),2<=A.heap_len;);A.heap[--A.heap_max]=A.heap[1],function(Me,Tn){var Io,or,Oo,ft,Pc,eh,Ur=Tn.dyn_tree,H_=Tn.max_code,HM=Tn.stat_desc.static_tree,VM=Tn.stat_desc.has_stree,KM=Tn.stat_desc.extra_bits,V_=Tn.stat_desc.extra_base,No=Tn.stat_desc.max_length,Dc=0;for(ft=0;ft<=b;ft++)Me.bl_count[ft]=0;for(Ur[2*Me.heap[Me.heap_max]+1]=0,Io=Me.heap_max+1;Io<m;Io++)No<(ft=Ur[2*Ur[2*(or=Me.heap[Io])+1]+1]+1)&&(ft=No,Dc++),Ur[2*or+1]=ft,H_<or||(Me.bl_count[ft]++,Pc=0,V_<=or&&(Pc=KM[or-V_]),eh=Ur[2*or],Me.opt_len+=eh*(ft+Pc),VM&&(Me.static_len+=eh*(HM[2*or+1]+Pc)));if(Dc!==0){do{for(ft=No-1;Me.bl_count[ft]===0;)ft--;Me.bl_count[ft]--,Me.bl_count[ft+1]+=2,Me.bl_count[No]--,Dc-=2}while(0<Dc);for(ft=No;ft!==0;ft--)for(or=Me.bl_count[ft];or!==0;)H_<(Oo=Me.heap[--Io])||(Ur[2*Oo+1]!==ft&&(Me.opt_len+=(ft-Ur[2*Oo+1])*Ur[2*Oo],Ur[2*Oo+1]=ft),or--)}}(A,P),je(te,Ze,A.bl_count)}function y(A,P,X){var J,z,te=-1,le=P[1],ne=0,de=7,Ze=4;for(le===0&&(de=138,Ze=3),P[2*(X+1)+1]=65535,J=0;J<=X;J++)z=le,le=P[2*(J+1)+1],++ne<de&&z===le||(ne<Ze?A.bl_tree[2*z]+=ne:z!==0?(z!==te&&A.bl_tree[2*z]++,A.bl_tree[2*k]++):ne<=10?A.bl_tree[2*C]++:A.bl_tree[2*I]++,te=z,Ze=(ne=0)===le?(de=138,3):z===le?(de=6,3):(de=7,4))}function K(A,P,X){var J,z,te=-1,le=P[1],ne=0,de=7,Ze=4;for(le===0&&(de=138,Ze=3),J=0;J<=X;J++)if(z=le,le=P[2*(J+1)+1],!(++ne<de&&z===le)){if(ne<Ze)for(;ee(A,z,A.bl_tree),--ne!=0;);else z!==0?(z!==te&&(ee(A,z,A.bl_tree),ne--),ee(A,k,A.bl_tree),Q(A,ne-3,2)):ne<=10?(ee(A,C,A.bl_tree),Q(A,ne-3,3)):(ee(A,I,A.bl_tree),Q(A,ne-11,7));te=z,Ze=(ne=0)===le?(de=138,3):z===le?(de=6,3):(de=7,4)}}c(H);var G=!1;function R(A,P,X,J){Q(A,(l<<1)+(J?1:0),3),function(z,te,le,ne){_e(z),ue(z,le),ue(z,~le),s.arraySet(z.pending_buf,z.window,te,le,z.pending),z.pending+=le}(A,P,X)}i._tr_init=function(A){G||(function(){var P,X,J,z,te,le=new Array(b+1);for(z=J=0;z<u-1;z++)for(N[z]=J,P=0;P<1<<T[z];P++)g[J++]=z;for(g[J-1]=z,z=te=0;z<16;z++)for(H[z]=te,P=0;P<1<<L[z];P++)E[te++]=z;for(te>>=7;z<h;z++)for(H[z]=te<<7,P=0;P<1<<L[z]-7;P++)E[256+te++]=z;for(X=0;X<=b;X++)le[X]=0;for(P=0;P<=143;)se[2*P+1]=8,P++,le[8]++;for(;P<=255;)se[2*P+1]=9,P++,le[9]++;for(;P<=279;)se[2*P+1]=7,P++,le[7]++;for(;P<=287;)se[2*P+1]=8,P++,le[8]++;for(je(se,d+1,le),P=0;P<h;P++)O[2*P+1]=5,O[2*P]=Se(P,5);W=new Y(se,T,f+1,d,b),B=new Y(O,L,0,h,b),Z=new Y(new Array(0),x,0,p,w)}(),G=!0),A.l_desc=new $(A.dyn_ltree,W),A.d_desc=new $(A.dyn_dtree,B),A.bl_desc=new $(A.bl_tree,Z),A.bi_buf=0,A.bi_valid=0,we(A)},i._tr_stored_block=R,i._tr_flush_block=function(A,P,X,J){var z,te,le=0;0<A.level?(A.strm.data_type===2&&(A.strm.data_type=function(ne){var de,Ze=4093624447;for(de=0;de<=31;de++,Ze>>>=1)if(1&Ze&&ne.dyn_ltree[2*de]!==0)return o;if(ne.dyn_ltree[18]!==0||ne.dyn_ltree[20]!==0||ne.dyn_ltree[26]!==0)return a;for(de=32;de<f;de++)if(ne.dyn_ltree[2*de]!==0)return a;return o}(A)),St(A,A.l_desc),St(A,A.d_desc),le=function(ne){var de;for(y(ne,ne.dyn_ltree,ne.l_desc.max_code),y(ne,ne.dyn_dtree,ne.d_desc.max_code),St(ne,ne.bl_desc),de=p-1;3<=de&&ne.bl_tree[2*V[de]+1]===0;de--);return ne.opt_len+=3*(de+1)+5+5+4,de}(A),z=A.opt_len+3+7>>>3,(te=A.static_len+3+7>>>3)<=z&&(z=te)):z=te=X+5,X+4<=z&&P!==-1?R(A,P,X,J):A.strategy===4||te===z?(Q(A,2+(J?1:0),3),mt(A,se,O)):(Q(A,4+(J?1:0),3),function(ne,de,Ze,Me){var Tn;for(Q(ne,de-257,5),Q(ne,Ze-1,5),Q(ne,Me-4,4),Tn=0;Tn<Me;Tn++)Q(ne,ne.bl_tree[2*V[Tn]+1],3);K(ne,ne.dyn_ltree,de-1),K(ne,ne.dyn_dtree,Ze-1)}(A,A.l_desc.max_code+1,A.d_desc.max_code+1,le+1),mt(A,A.dyn_ltree,A.dyn_dtree)),we(A),J&&_e(A)},i._tr_tally=function(A,P,X){return A.pending_buf[A.d_buf+2*A.last_lit]=P>>>8&255,A.pending_buf[A.d_buf+2*A.last_lit+1]=255&P,A.pending_buf[A.l_buf+A.last_lit]=255&X,A.last_lit++,P===0?A.dyn_ltree[2*X]++:(A.matches++,P--,A.dyn_ltree[2*(g[X]+f+1)]++,A.dyn_dtree[2*F(P)]++),A.last_lit===A.lit_bufsize-1},i._tr_align=function(A){Q(A,2,3),ee(A,v,se),function(P){P.bi_valid===16?(ue(P,P.bi_buf),P.bi_buf=0,P.bi_valid=0):8<=P.bi_valid&&(P.pending_buf[P.pending++]=255&P.bi_buf,P.bi_buf>>=8,P.bi_valid-=8)}(A)}},{"../utils/common":41}],53:[function(n,r,i){r.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},{}],54:[function(n,r,i){(function(s){(function(o,a){if(!o.setImmediate){var c,l,u,f,d=1,h={},p=!1,m=o.document,b=Object.getPrototypeOf&&Object.getPrototypeOf(o);b=b&&b.setTimeout?b:o,c={}.toString.call(o.process)==="[object process]"?function(k){process.nextTick(function(){w(k)})}:function(){if(o.postMessage&&!o.importScripts){var k=!0,C=o.onmessage;return o.onmessage=function(){k=!1},o.postMessage("","*"),o.onmessage=C,k}}()?(f="setImmediate$"+Math.random()+"$",o.addEventListener?o.addEventListener("message",v,!1):o.attachEvent("onmessage",v),function(k){o.postMessage(f+k,"*")}):o.MessageChannel?((u=new MessageChannel).port1.onmessage=function(k){w(k.data)},function(k){u.port2.postMessage(k)}):m&&"onreadystatechange"in m.createElement("script")?(l=m.documentElement,function(k){var C=m.createElement("script");C.onreadystatechange=function(){w(k),C.onreadystatechange=null,l.removeChild(C),C=null},l.appendChild(C)}):function(k){setTimeout(w,0,k)},b.setImmediate=function(k){typeof k!="function"&&(k=new Function(""+k));for(var C=new Array(arguments.length-1),I=0;I<C.length;I++)C[I]=arguments[I+1];var T={callback:k,args:C};return h[d]=T,c(d),d++},b.clearImmediate=_}function _(k){delete h[k]}function w(k){if(p)setTimeout(w,0,k);else{var C=h[k];if(C){p=!0;try{(function(I){var T=I.callback,L=I.args;switch(L.length){case 0:T();break;case 1:T(L[0]);break;case 2:T(L[0],L[1]);break;case 3:T(L[0],L[1],L[2]);break;default:T.apply(a,L)}})(C)}finally{_(k),p=!1}}}}function v(k){k.source===o&&typeof k.data=="string"&&k.data.indexOf(f)===0&&w(+k.data.slice(f.length))}})(typeof self>"u"?s===void 0?this:s:self)}).call(this,typeof Bt<"u"?Bt:typeof self<"u"?self:typeof window<"u"?window:{})},{}]},{},[10])(10)})})(O_);var lM=O_.exports,Zf=Pi(lM);const N_={"application/andrew-inset":["ez"],"application/appinstaller":["appinstaller"],"application/applixware":["aw"],"application/appx":["appx"],"application/appxbundle":["appxbundle"],"application/atom+xml":["atom"],"application/atomcat+xml":["atomcat"],"application/atomdeleted+xml":["atomdeleted"],"application/atomsvc+xml":["atomsvc"],"application/atsc-dwd+xml":["dwd"],"application/atsc-held+xml":["held"],"application/atsc-rsat+xml":["rsat"],"application/automationml-aml+xml":["aml"],"application/automationml-amlx+zip":["amlx"],"application/bdoc":["bdoc"],"application/calendar+xml":["xcs"],"application/ccxml+xml":["ccxml"],"application/cdfx+xml":["cdfx"],"application/cdmi-capability":["cdmia"],"application/cdmi-container":["cdmic"],"application/cdmi-domain":["cdmid"],"application/cdmi-object":["cdmio"],"application/cdmi-queue":["cdmiq"],"application/cpl+xml":["cpl"],"application/cu-seeme":["cu"],"application/cwl":["cwl"],"application/dash+xml":["mpd"],"application/dash-patch+xml":["mpp"],"application/davmount+xml":["davmount"],"application/docbook+xml":["dbk"],"application/dssc+der":["dssc"],"application/dssc+xml":["xdssc"],"application/ecmascript":["ecma"],"application/emma+xml":["emma"],"application/emotionml+xml":["emotionml"],"application/epub+zip":["epub"],"application/exi":["exi"],"application/express":["exp"],"application/fdf":["fdf"],"application/fdt+xml":["fdt"],"application/font-tdpfr":["pfr"],"application/geo+json":["geojson"],"application/gml+xml":["gml"],"application/gpx+xml":["gpx"],"application/gxf":["gxf"],"application/gzip":["gz"],"application/hjson":["hjson"],"application/hyperstudio":["stk"],"application/inkml+xml":["ink","inkml"],"application/ipfix":["ipfix"],"application/its+xml":["its"],"application/java-archive":["jar","war","ear"],"application/java-serialized-object":["ser"],"application/java-vm":["class"],"application/javascript":["*js"],"application/json":["json","map"],"application/json5":["json5"],"application/jsonml+json":["jsonml"],"application/ld+json":["jsonld"],"application/lgr+xml":["lgr"],"application/lost+xml":["lostxml"],"application/mac-binhex40":["hqx"],"application/mac-compactpro":["cpt"],"application/mads+xml":["mads"],"application/manifest+json":["webmanifest"],"application/marc":["mrc"],"application/marcxml+xml":["mrcx"],"application/mathematica":["ma","nb","mb"],"application/mathml+xml":["mathml"],"application/mbox":["mbox"],"application/media-policy-dataset+xml":["mpf"],"application/mediaservercontrol+xml":["mscml"],"application/metalink+xml":["metalink"],"application/metalink4+xml":["meta4"],"application/mets+xml":["mets"],"application/mmt-aei+xml":["maei"],"application/mmt-usd+xml":["musd"],"application/mods+xml":["mods"],"application/mp21":["m21","mp21"],"application/mp4":["*mp4","*mpg4","mp4s","m4p"],"application/msix":["msix"],"application/msixbundle":["msixbundle"],"application/msword":["doc","dot"],"application/mxf":["mxf"],"application/n-quads":["nq"],"application/n-triples":["nt"],"application/node":["cjs"],"application/octet-stream":["bin","dms","lrf","mar","so","dist","distz","pkg","bpk","dump","elc","deploy","exe","dll","deb","dmg","iso","img","msi","msp","msm","buffer"],"application/oda":["oda"],"application/oebps-package+xml":["opf"],"application/ogg":["ogx"],"application/omdoc+xml":["omdoc"],"application/onenote":["onetoc","onetoc2","onetmp","onepkg"],"application/oxps":["oxps"],"application/p2p-overlay+xml":["relo"],"application/patch-ops-error+xml":["xer"],"application/pdf":["pdf"],"application/pgp-encrypted":["pgp"],"application/pgp-keys":["asc"],"application/pgp-signature":["sig","*asc"],"application/pics-rules":["prf"],"application/pkcs10":["p10"],"application/pkcs7-mime":["p7m","p7c"],"application/pkcs7-signature":["p7s"],"application/pkcs8":["p8"],"application/pkix-attr-cert":["ac"],"application/pkix-cert":["cer"],"application/pkix-crl":["crl"],"application/pkix-pkipath":["pkipath"],"application/pkixcmp":["pki"],"application/pls+xml":["pls"],"application/postscript":["ai","eps","ps"],"application/provenance+xml":["provx"],"application/pskc+xml":["pskcxml"],"application/raml+yaml":["raml"],"application/rdf+xml":["rdf","owl"],"application/reginfo+xml":["rif"],"application/relax-ng-compact-syntax":["rnc"],"application/resource-lists+xml":["rl"],"application/resource-lists-diff+xml":["rld"],"application/rls-services+xml":["rs"],"application/route-apd+xml":["rapd"],"application/route-s-tsid+xml":["sls"],"application/route-usd+xml":["rusd"],"application/rpki-ghostbusters":["gbr"],"application/rpki-manifest":["mft"],"application/rpki-roa":["roa"],"application/rsd+xml":["rsd"],"application/rss+xml":["rss"],"application/rtf":["rtf"],"application/sbml+xml":["sbml"],"application/scvp-cv-request":["scq"],"application/scvp-cv-response":["scs"],"application/scvp-vp-request":["spq"],"application/scvp-vp-response":["spp"],"application/sdp":["sdp"],"application/senml+xml":["senmlx"],"application/sensml+xml":["sensmlx"],"application/set-payment-initiation":["setpay"],"application/set-registration-initiation":["setreg"],"application/shf+xml":["shf"],"application/sieve":["siv","sieve"],"application/smil+xml":["smi","smil"],"application/sparql-query":["rq"],"application/sparql-results+xml":["srx"],"application/sql":["sql"],"application/srgs":["gram"],"application/srgs+xml":["grxml"],"application/sru+xml":["sru"],"application/ssdl+xml":["ssdl"],"application/ssml+xml":["ssml"],"application/swid+xml":["swidtag"],"application/tei+xml":["tei","teicorpus"],"application/thraud+xml":["tfi"],"application/timestamped-data":["tsd"],"application/toml":["toml"],"application/trig":["trig"],"application/ttml+xml":["ttml"],"application/ubjson":["ubj"],"application/urc-ressheet+xml":["rsheet"],"application/urc-targetdesc+xml":["td"],"application/voicexml+xml":["vxml"],"application/wasm":["wasm"],"application/watcherinfo+xml":["wif"],"application/widget":["wgt"],"application/winhlp":["hlp"],"application/wsdl+xml":["wsdl"],"application/wspolicy+xml":["wspolicy"],"application/xaml+xml":["xaml"],"application/xcap-att+xml":["xav"],"application/xcap-caps+xml":["xca"],"application/xcap-diff+xml":["xdf"],"application/xcap-el+xml":["xel"],"application/xcap-ns+xml":["xns"],"application/xenc+xml":["xenc"],"application/xfdf":["xfdf"],"application/xhtml+xml":["xhtml","xht"],"application/xliff+xml":["xlf"],"application/xml":["xml","xsl","xsd","rng"],"application/xml-dtd":["dtd"],"application/xop+xml":["xop"],"application/xproc+xml":["xpl"],"application/xslt+xml":["*xsl","xslt"],"application/xspf+xml":["xspf"],"application/xv+xml":["mxml","xhvml","xvml","xvm"],"application/yang":["yang"],"application/yin+xml":["yin"],"application/zip":["zip"],"audio/3gpp":["*3gpp"],"audio/aac":["adts","aac"],"audio/adpcm":["adp"],"audio/amr":["amr"],"audio/basic":["au","snd"],"audio/midi":["mid","midi","kar","rmi"],"audio/mobile-xmf":["mxmf"],"audio/mp3":["*mp3"],"audio/mp4":["m4a","mp4a"],"audio/mpeg":["mpga","mp2","mp2a","mp3","m2a","m3a"],"audio/ogg":["oga","ogg","spx","opus"],"audio/s3m":["s3m"],"audio/silk":["sil"],"audio/wav":["wav"],"audio/wave":["*wav"],"audio/webm":["weba"],"audio/xm":["xm"],"font/collection":["ttc"],"font/otf":["otf"],"font/ttf":["ttf"],"font/woff":["woff"],"font/woff2":["woff2"],"image/aces":["exr"],"image/apng":["apng"],"image/avci":["avci"],"image/avcs":["avcs"],"image/avif":["avif"],"image/bmp":["bmp","dib"],"image/cgm":["cgm"],"image/dicom-rle":["drle"],"image/dpx":["dpx"],"image/emf":["emf"],"image/fits":["fits"],"image/g3fax":["g3"],"image/gif":["gif"],"image/heic":["heic"],"image/heic-sequence":["heics"],"image/heif":["heif"],"image/heif-sequence":["heifs"],"image/hej2k":["hej2"],"image/hsj2":["hsj2"],"image/ief":["ief"],"image/jls":["jls"],"image/jp2":["jp2","jpg2"],"image/jpeg":["jpeg","jpg","jpe"],"image/jph":["jph"],"image/jphc":["jhc"],"image/jpm":["jpm","jpgm"],"image/jpx":["jpx","jpf"],"image/jxr":["jxr"],"image/jxra":["jxra"],"image/jxrs":["jxrs"],"image/jxs":["jxs"],"image/jxsc":["jxsc"],"image/jxsi":["jxsi"],"image/jxss":["jxss"],"image/ktx":["ktx"],"image/ktx2":["ktx2"],"image/png":["png"],"image/sgi":["sgi"],"image/svg+xml":["svg","svgz"],"image/t38":["t38"],"image/tiff":["tif","tiff"],"image/tiff-fx":["tfx"],"image/webp":["webp"],"image/wmf":["wmf"],"message/disposition-notification":["disposition-notification"],"message/global":["u8msg"],"message/global-delivery-status":["u8dsn"],"message/global-disposition-notification":["u8mdn"],"message/global-headers":["u8hdr"],"message/rfc822":["eml","mime"],"model/3mf":["3mf"],"model/gltf+json":["gltf"],"model/gltf-binary":["glb"],"model/iges":["igs","iges"],"model/jt":["jt"],"model/mesh":["msh","mesh","silo"],"model/mtl":["mtl"],"model/obj":["obj"],"model/prc":["prc"],"model/step+xml":["stpx"],"model/step+zip":["stpz"],"model/step-xml+zip":["stpxz"],"model/stl":["stl"],"model/u3d":["u3d"],"model/vrml":["wrl","vrml"],"model/x3d+binary":["*x3db","x3dbz"],"model/x3d+fastinfoset":["x3db"],"model/x3d+vrml":["*x3dv","x3dvz"],"model/x3d+xml":["x3d","x3dz"],"model/x3d-vrml":["x3dv"],"text/cache-manifest":["appcache","manifest"],"text/calendar":["ics","ifb"],"text/coffeescript":["coffee","litcoffee"],"text/css":["css"],"text/csv":["csv"],"text/html":["html","htm","shtml"],"text/jade":["jade"],"text/javascript":["js","mjs"],"text/jsx":["jsx"],"text/less":["less"],"text/markdown":["md","markdown"],"text/mathml":["mml"],"text/mdx":["mdx"],"text/n3":["n3"],"text/plain":["txt","text","conf","def","list","log","in","ini"],"text/richtext":["rtx"],"text/rtf":["*rtf"],"text/sgml":["sgml","sgm"],"text/shex":["shex"],"text/slim":["slim","slm"],"text/spdx":["spdx"],"text/stylus":["stylus","styl"],"text/tab-separated-values":["tsv"],"text/troff":["t","tr","roff","man","me","ms"],"text/turtle":["ttl"],"text/uri-list":["uri","uris","urls"],"text/vcard":["vcard"],"text/vtt":["vtt"],"text/wgsl":["wgsl"],"text/xml":["*xml"],"text/yaml":["yaml","yml"],"video/3gpp":["3gp","3gpp"],"video/3gpp2":["3g2"],"video/h261":["h261"],"video/h263":["h263"],"video/h264":["h264"],"video/iso.segment":["m4s"],"video/jpeg":["jpgv"],"video/jpm":["*jpm","*jpgm"],"video/mj2":["mj2","mjp2"],"video/mp2t":["ts"],"video/mp4":["mp4","mp4v","mpg4"],"video/mpeg":["mpeg","mpg","mpe","m1v","m2v"],"video/ogg":["ogv"],"video/quicktime":["qt","mov"],"video/webm":["webm"]};Object.freeze(N_);var An=function(e,t,n,r){if(n==="a"&&!r)throw new TypeError("Private accessor was defined without a getter");if(typeof t=="function"?e!==t||!r:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return n==="m"?r:n==="a"?r.call(e):r?r.value:t.get(e)},ds,Ro,Li;class uM{constructor(...t){ds.set(this,new Map),Ro.set(this,new Map),Li.set(this,new Map);for(const n of t)this.define(n)}define(t,n=!1){for(let[r,i]of Object.entries(t)){r=r.toLowerCase(),i=i.map(a=>a.toLowerCase()),An(this,Li,"f").has(r)||An(this,Li,"f").set(r,new Set);const s=An(this,Li,"f").get(r);let o=!0;for(let a of i){const c=a.startsWith("*");if(a=c?a.slice(1):a,s==null||s.add(a),o&&An(this,Ro,"f").set(r,a),o=!1,c)continue;const l=An(this,ds,"f").get(a);if(l&&l!=r&&!n)throw new Error(`"${r} -> ${a}" conflicts with "${l} -> ${a}". Pass \`force=true\` to override this definition.`);An(this,ds,"f").set(a,r)}}return this}getType(t){if(typeof t!="string")return null;const n=t.replace(/^.*[/\\]/,"").toLowerCase(),r=n.replace(/^.*\./,"").toLowerCase(),i=n.length<t.length;return!(r.length<n.length-1)&&i?null:An(this,ds,"f").get(r)??null}getExtension(t){var n;return typeof t!="string"?null:(t=(n=t==null?void 0:t.split)==null?void 0:n.call(t,";")[0],(t&&An(this,Ro,"f").get(t.trim().toLowerCase()))??null)}getAllExtensions(t){return typeof t!="string"?null:An(this,Li,"f").get(t.toLowerCase())??null}_freeze(){this.define=()=>{throw new Error("define() not allowed for built-in Mime objects. See https://github.com/broofa/mime/blob/main/README.md#custom-mime-instances")},Object.freeze(this);for(const t of An(this,Li,"f").values())Object.freeze(t);return this}_getTestState(){return{types:An(this,ds,"f"),extensions:An(this,Ro,"f")}}}ds=new WeakMap,Ro=new WeakMap,Li=new WeakMap;var fM=new uM(N_)._freeze();function C_(e,t){switch([...t.slice(0,4)].map(i=>i.toString(16)).join("").toUpperCase()){case"89504E47":return"image/png";case"47494638":return"image/gif";case"25504446":return"application/pdf";case"FFD8FFDB":case"FFD8FFE0":case"FFD8FFE1":return"image/jpeg";case"504B0304":return"application/zip"}return fM.getType(e)??"application/octet-stream"}function hM(e){const t=Ig(e,{}),n=Jn(t),r=Xs(t),i=Dn(Je.MAIN);if(!S(i))return;const s=qs(t),o=Lu(i,s,n);S(o)?yt("memory",`${i.name} already has a [${r}] named ${n}`):(Lg(i,t),U_(t.id,i.id),yt("memory",`created [${r}] ${n} in ${i.name}`))}async function dM(e){const t=await e.text();hM(t)}async function pM(e,t){try{yt("parsezipfile",e.name);const n=await e.arrayBuffer();(await new Zf().loadAsync(n)).forEach((s,o)=>{o.async("uint8array").then(a=>{const c=C_(s,a),l=new File([a],o.name,{type:c});t(l)}).catch(a=>{Qe("memory","crash",a.message)})})}catch(n){Qe("memory","crash",n.message)}}async function mM(e,t){try{yt("parsebinaryfile",e.name);const n=await e.arrayBuffer(),r=e.name.split(".").slice(-1)[0]??"";t(Pe(r),new Uint8Array(n))}catch(n){Qe("memory","crash",n.message)}}function Yf(e){if(!e||e.type===void 0)return;const t=[{start:e.startOffset,end:e.endOffset??0}];return Object.keys(e).forEach(n=>{if(n!=="parent"){const r=e[n];We(r)?r.forEach(i=>{t.push(Yf(i))}):t.push(Yf(r))}}),e.range={start:Math.min(...t.filter(n=>n).map(n=>(n==null?void 0:n.start)??0)),end:Math.max(...t.filter(n=>n).map(n=>(n==null?void 0:n.end)??0))},e.range}function gM(e){const t=Ag(`${e}
`);if(t.errors.length>0)return t;fs.input=t.tokens;const n=fs.program();if(fs.errors.length>0)return{tokens:t.tokens,errors:fs.errors.map(i=>({offset:i.token.startOffset,line:i.token.startLine,column:i.token.startColumn,length:i.token.image.length,message:i.message}))};const[r]=tM.go(n);return r?(Yf(r),{tokens:t.tokens,cst:n,ast:r}):{tokens:t.tokens,cst:n,errors:[{message:"no ast output",offset:0,line:0,column:0,length:0}]}}const Qf=Object.getPrototypeOf(function*(){}).constructor;function yM(e,t){const n=`compile-${e}`;console.time(n);const r=gM(t);if(console.timeEnd(n),r.errors&&r.errors.length>0)return r;if(!r.ast)return{...r,errors:[{message:"no ast output",offset:0,line:0,column:0,length:0}]};const i=oM(r.ast);if(i.code){KR&&console.info(i.code);try{return{...r,...i,source:i.code,code:new Qf("api",i.code)}}catch(s){return{errors:[{message:`unexpected error ${s.message}`,offset:0,line:0,column:0,length:0}],source:"",code:new Qf("api"," ")}}}return{...r,...i,source:"",code:new Qf("api"," ")}}function _M(){const e={},t={};function n(i,s){const o=e[s];if(o)return o;const a=yM(i,s);return e[s]=a,a}const r={ids(){return Object.keys(t)},has(i){return S(t[i])},isended(i){const s=t[i];return S(s)?s.isended():!0},halt(i){const s=t[i];return S(s)&&(s.halt(),delete t[i]),!!s},gc(){const i=r.ids();for(let s=0;s<i.length;++s)r.isended(i[s])&&r.halt(i[s])},tick(i,s,o,a,c){var u;let l=t[i];if(!S(t[i])){const f=n(a,c);if(l=t[i]=cM(i,s,f),(u=f.errors)!=null&&u.length){const[d]=f.errors,h=((d==null?void 0:d.line)??2)-1,p=c.replaceAll(`\r
`,"").split(`
`).map((_,w)=>[_,w]);p.slice(h-5,h).forEach(([_,w])=>{Qe("os","build",`$grey${w+1} $grey${_}`)});const[m,b]=p[h]??[];if(Ce(m)&&S(b)){const _=(d.column??1)-1,w=_+d.length,v=_<m.length?m:`${m}*`,k=v.substring(0,_),C=v.substring(_,w),I=v.substring(w);Qe("os","build",`$red${b+1} $grey${k}$red${C}$grey${I}`)}return d.message.split(`
`).forEach(_=>{Qe("os","build",_)}),!1}}return!!(l!=null&&l.tick(o))},once(i,s,o,a){const c=r.tick(i,s,1,o,a);return r.halt(i)&&c},message(i){const{target:s,path:o}=ch(i.target),a=t[s];if(S(a)){const c={...i,target:o};a.message(c)}}};return r}const Lr=_M();var Je=(e=>(e.MAIN="main",e.TITLE="title",e.PLAYER="player",e.CONTENT="content",e.GADGETSTORE="gadgetstore",e.GADGETSYNC="gadgetsync",e))(Je||{});const at={defaultplayer:lb(),software:{main:"",content:""},books:new Map,chips:new Map,loaders:new Map,chipindex:new Map,codepageindex:new Map,binaryfiles:new Map};function bM(e){at.defaultplayer=e}function wM(){return at.defaultplayer}function Mc(){return[...at.books.values()]}function vM(){const[e]=at.books.values();return e}function ti(e){const t=Pe(e);return at.books.get(e)??Mc().find(n=>n.name===t)}function Uc(e,t){S(ti(t))&&(at.software[e]=t)}function nn(e){return ti(at.software[e])}function L_(e){const t=Cg([]);return Ce(e)&&(t.name=e),M_(t),yt("memory",`created [book] ${t.name}`),t}function EM(e){let t=ti(e);return S(t)||(t=Cg([]),t.name=e),M_(t),yt("memory",`created [book] ${t.name}`),t}function Dn(e,t){let n=S(t)?EM(t):nn(e);return S(n)||(S(n)||(n=vM()),S(n)||(n=L_(t)),S(n)&&yt("memory",`opened [book] ${n.name} for ${e}`)),Uc(e,n.id),n}function Mi(e,t,n){const r=Dn(e);let i=_i(r,t);if(S(i))return i;const s=Og(n);return i=Ig(s==="object"?`@${t}
`:`@${s} ${t}
`,{}),Lg(r,i),U_(i.id,r.id),ni("memory"),i}function ps(e){const t=Dn("main");return Js(t,e)}function kM(e){const t=Dn("main");return Mu(t,e)}function SM(e,t){at.books.clear(),e.forEach(r=>{at.books.set(r.id,r),r.name==="main"&&(at.software.main=r.id)});const n=ti(t);if(S(n)&&Uc("main",n.id),!at.software.main){const r=at.books.values().next();r.value&&(at.software.main=r.value.id)}}function M_(e){return at.books.set(e.id,e),e.id}function AM(e){const t=ti(e);t&&at.books.delete(t.id)}function U_(e,t){at.codepageindex.set(e,t)}function TM(e){if(!Ce(e)||!e)return Qe("memory","login",`failed for playerid ==>${e}<==`,e);const t=nn("main");if(!S(t))return Qe("memory","login:main","login failed to find book 'main'",e);const n=Wa(t,e);if(S(n))return!0;const r=Zi(t,"title");if(!S(r))return Qe("memory","login:title","login failed to find board 'title'",e);const i=za(t,"player");if(!S(i))return Qe("memory","login:player","login failed to find object type 'player'",e);const s={x:0,y:0},o=i.name??"player",a=El(r,s,o,e);return S(a==null?void 0:a.id)?(Uu(t,e,r.id),!0):!1}function P_(e){const t=nn("main"),n=Wa(t,e);Uu(t,e,""),Zs(t,n,Yo(n,e)),kd(n,e),Mu(t,e),Mu(t,I_(e))}function xM(e){const t=nn("main"),n=Dg(t);for(let r=0;r<n.length;++r){const i=n[r],s=Object.keys(i.objects);for(let o=0;o<s.length;++o){const c=i.objects[s[o]].id;ah(c)&&S(e[c])===!1&&(e[c]=0,Uu(t,c,i.id))}}}function RM(e){Lr.message(e)}function D_(e,t,n,r,i=Ev){if(!S(e)||!S(t)||!S(n))return;const s={...D};D.book=e,D.board=t,D.element=n,D.player=n.player??at.defaultplayer,D.isplayer=ah(n.id??"");const o=Er(e,n),a=n.cycle??(o==null?void 0:o.cycle)??i,c=n.id??"",l=vl(n);if(Lr.tick(c,vo.CODE_PAGE,ke(a)?a:i,l,r),ke(n==null?void 0:n.tickertime)&&D.timestamp-n.tickertime>Ad*5&&(n.tickertime=0,n.tickertext=""),D.isplayer){const u=ps(D.player);u.inputcurrent=0}tw(s).forEach(u=>{D[u]=s[u]})}function IM(){const e=nn("main");if(!S(e))return;const t=e.timestamp+1,n=Cc.HALT_AT_COUNT;Cc.HALT_AT_COUNT=n*32,at.loaders.forEach((i,s)=>{Lr.tick(s,vo.LOADER,1,"loader",i),Lr.isended(s)&&(Lr.halt(s),at.loaders.delete(s))}),Cc.HALT_AT_COUNT=n,e.timestamp=t,D.timestamp=t,Dg(e).forEach(i=>{const s=dI(e,i,t);for(let o=0;o<s.length;++o){const{id:a,type:c,code:l,object:u}=s[o];c===Ae.ERROR?Lr.halt(a):D_(e,i,u,l)}})}function OM(){Lr.gc()}function NM(e,t=""){const n=Dn("main");if(!S(n))return;const r=`${e}_cli`;D.book=n,D.board=Wa(n,e),D.element=Yo(D.board,e),D.player=e,fh("memory","running",n.timestamp,r,t),Lr.once(r,vo.CLI,"cli",t)}function B_(e){const t=Dn("main"),n=_i(t,e);if(!S(t)||!S(n)||!S(D.element))return;const r=`${e}_run`,i=vl(D.element),s=(n==null?void 0:n.code)??"";Lr.once(r,vo.CODE_PAGE,i,s)}function CM(e,t,n,r){const i=nn("main");if(!S(i))return;const s=["binaryfile",n];yt("memory","looking for stats",...s);const o=oI(i,Ae.LOADER).filter(a=>{const c=Ks(a);return Object.keys(c).filter(u=>s.includes(Pe(u))).length===s.length});for(let a=0;a<o.length;++a){const c=o[a],l=`${e}_load_${c.id}`;at.binaryfiles.set(l,{filename:t.name,cursor:0,bytes:r,dataview:new DataView(r.buffer)}),yt("memory","starting loader",i.timestamp,l),at.loaders.set(l,c.code)}}function F_(e){return at.binaryfiles.get(e)}function $_(e,t){function n(r){if(S(t))switch(r){case"text/plain":dM(t).catch(i=>Qe("memory","crash",i.message));break;case"application/zip":pM(t,i=>$_(e,i)).catch(i=>Qe("memory","crash",i.message));break;case"application/octet-stream":mM(t,(i,s)=>{CM(e,t,i,s)}).catch(i=>Qe("memory","crash",i.message));break;default:t.arrayBuffer().then(i=>{const s=C_(t.name,new Uint8Array(i));if(s)n(s);else return Qe("memory","loadfile",`unsupported file ${t.name}`)}).catch(i=>Qe("memory","crash",i.message));return}}n((t==null?void 0:t.type)??"")}let j_=0;function LM(){switch(j_++){case 0:return be.BLUE;case 1:return be.GREEN;case 2:return be.CYAN;case 3:return be.RED;case 4:return be.PURPLE;case 5:return be.YELLOW;default:return j_=0,be.WHITE}}function MM(e,t,n,r,i,s){const o=[];let a=t;const c=a===0,l=Ge,u=hn,f=c?be.BLACK:be.ONCLEAR,d=lh(e,a++,l,u,f);o.push(d);const h=mb(e,a++,l,u);o.push(h);const p=a++,m=pb(e,p);o.push(m);const b=lh(e,a++,l,u,be.ONCLEAR);o.push(b);const _={...E_(Ge,hn,LM(),be.ONCLEAR),...b},w=gb(e,a++);i&&o.push(w),r.terrain.forEach((T,L)=>{if(T){const x=Er(n,T);d.char[L]=T.char??(x==null?void 0:x.char)??0,d.color[L]=T.color??(x==null?void 0:x.color)??f,d.bg[L]=T.bg??(x==null?void 0:x.bg)??f,d.color[L]!==be.ONCLEAR&&(s[L]=d.color[L])}});const v=r.objects??{};Object.values(v).forEach(T=>{if(S(T.removed)||S(T.headless))return;const L=T.id??"",x=Mg(n,T),V=db(e,p,L),se=T.lx??T.x??0,O=T.ly??T.y??0,E=se+O*Ge;if(V.x=T.x??0,V.y=T.y??0,V.char=T.char??(x==null?void 0:x.char)??1,V.color=T.color??(x==null?void 0:x.color)??be.WHITE,V.bg=T.bg??(x==null?void 0:x.bg)??be.ONBORROW,m.sprites.push(V),V.bg===be.ONSHADOW&&(V.bg=be.ONCLEAR,h.alphas[se+O*l]=.5),V.bg===be.ONBORROW&&(V.bg=s[E]??be.BLACK),V.color!==be.ONCLEAR&&(s[E]=V.color),Ce(T.tickertext)&&ke(T.tickertime)&&T.tickertext.length){const g=Ge,N=KL(T.tickertext,g,hn-1),W=(N==null?void 0:N.measuredwidth)??1,B=T.x??0,Z=T.y??0,H=Z<hn*.5;_.x=B-Math.floor(W*.5),_.y=Z+(H?1:-1),_.x+W>Ge&&(_.x=Ge-W),_.x<0&&(_.x=0),VL(T.tickertext,_)}L===e&&(w.focusx=V.x,w.focusy=V.y,w.focusid=L)});function k(T,L){if(!(T<0||T>=Ge||L<0||L>=hn))return h.alphas[T+L*Ge]}const C=[[1,1,1,1,1],[1,3,5,3,1],[1,5,12,5,1],[1,3,5,3,1],[1,1,1,1,1]].flat(),I=new Array(h.alphas.length);for(let T=0;T<h.alphas.length;++T){const L=T%Ge,x=Math.floor(T/Ge),V=[[k(L-2,x-2),k(L-1,x-2),k(L,x-2),k(L+1,x-2),k(L+2,x-2)],[k(L-2,x-1),k(L-1,x-1),k(L,x-1),k(L+1,x-1),k(L+2,x-1)],[k(L-2,x),k(L-1,x),k(L,x),k(L+1,x),k(L+2,x)],[k(L-2,x+1),k(L-1,x+1),k(L,x+1),k(L+1,x+1),k(L+2,x+1)],[k(L-2,x+2),k(L-1,x+2),k(L,x+2),k(L+1,x+2),k(L+2,x+2)]].flat().map((se,O)=>S(se)?se*C[O]:void 0).filter(S);I[T]=si(hw(V),0,1)}return h.alphas=I,o}function UM(e){const t=nn("main"),n=Wa(t,e),r=[];if(!S(t)||!S(n))return r;const i=new Array(Ge*hn).fill(0),s=Zi(t,n.over??""),o=Zi(t,n.under??""),a=[s,n,o].filter(S);let c=0;for(let l=0;l<a.length;++l){const u=a[l],f=MM(e,c,t,u,u===n,i);c+=f.length,r.push(...f)}return r}function PM(e){const t=e.replace(/-/g,"+").replace(/_/g,"/"),n="=".repeat((4-t.length%4)%4);return t+n}function DM(e){return e.replace(/\+/g,"-").replace(/\//g,"_")}const BM=new Date("1980/09/02");async function FM(e){return new Promise((t,n)=>{const r=new Zf;for(let i=0;i<e.length;++i){const s=e[i],o=iI(s);if(o){const a=lv(o);S(a)&&r.file(s.id,a,{date:BM})}}r.generateAsync({type:"base64",compression:"DEFLATE",compressionOptions:{level:9}}).then(i=>{t(DM(i))}).catch(n)})}async function $M(e){return new Promise((t,n)=>{const r=new Zf;r.loadAsync(PM(e),{base64:!0}).then(async()=>{const i=[],s=[];r.forEach((o,a)=>s.push(a));for(let o=0;o<s.length;++o){const c=await s[o].async("uint8array"),l=sI(uv(c));S(l)&&i.push(l)}t(i)}).catch(n)})}const jM=16,Ui={},zM=64;let z_=0;const Mr={},ms={};async function W_(){OM();const e=Mc(),t=nn(Je.MAIN);if(e.length&&S(t)){const n=await FM(e);Sb(Bn.name(),`${new Date().toISOString()} ${t.name} ${n.length} chars`,n)}}const Bn=Lo("vm",["tick","second"],e=>{var t;switch(e.target){case"init":S(e.player)&&(bM(e.player),Bn.reply(e,"ackinit",!0,e.player));break;case"books":$c("vm:books",async()=>{if(We(e.data)){const[n,r]=e.data,i=await $M(n),s=i.map(o=>o.name);SM(i,r),yt(Bn.name(),"reset by",e.sender,"with",...s,e.player),Bn.reply(e,"ackbooks",!0,e.player)}});break;case"login":e.player&&TM(e.player)&&(Ui[e.player]=0,yt(Bn.name(),"player login",e.player),Bn.reply(e,"acklogin",!0,e.player));break;case"endgame":$c("vm:endgame",async()=>{e.player&&(P_(e.player),await W_(),xb("vm"))});break;case"doot":e.player&&(Ui[e.player]=0,fh(Bn.name(),"active",e.player));break;case"input":if(e.player){const n=ps(e.player),[r=Ft.NONE,i=0]=e.data??[Ft.NONE,0];We(n.inputqueue)||(n.inputqueue=[]),r!==Ft.NONE&&n.inputqueue.push([r,i])}break;case"codewatch":if(e.player&&We(e.data)){const[n,r]=e.data;if(!S(ms[r])){const i=hh(n,r);ms[r]=qy(i,s=>{const o=ti(n),a=_i(o,r);S(a)&&(a.code=s,rI(a))})}Mr[n]=Mr[n]??{},Mr[n][r]=Mr[n][r]??new Set,Mr[n][r].add(e.player)}break;case"coderelease":if(e.player&&We(e.data)){const[n,r]=e.data;S(Mr[n])&&S(Mr[n][r])&&(Mr[n][r].delete(e.player),Mr[n][r].size===0&&((t=ms[r])==null||t.call(ms),ms[r]=void 0))}break;case"tick":e.player!=="locked"&&IM();break;case"second":{xM(Ui);const n=Object.keys(Ui);for(let r=0;r<n.length;++r)++Ui[n[r]];for(let r=0;r<n.length;++r){const i=n[r];Ui[i]>=jM&&(delete Ui[i],P_(i),yt(Bn.name(),"player logout",i),Bn.emit("logout",void 0,i))}++z_>=zM&&(z_=0,ni(Bn.name()));break}case"flush":$c("vm:flush",W_);break;case"cli":S(e.player)&&NM(e.player,e.data);break;case"loadfile":S(e.player)&&$_(e.player,e.data);break;default:RM(e);break}});function WM(){Bn.emit("ready",void 0,wM())}QC(e=>{const t=nn(Je.MAIN);if(!S(t))return Df("");const n=Js(t,Je.GADGETSTORE);let r=n[e];return S(r)||(n[e]=r=Df(e)),r});const G_=Lo("gadgetserver",["tock"],e=>{const t=nn(Je.MAIN),n=(t==null?void 0:t.activelist)??[],r=Js(t,Je.GADGETSYNC);switch(e.target){case"tock":for(let i=0;i<n.length;++i){const s=n[i],o=Ii(s);o.layers=UM(s);const a=r[s]??{},c=yh(a,o);c.length&&(r[s]=ys(o),kb(G_.name(),c,s))}break;case"desync":e.player&&Eb(G_.name(),Ii(e.player),e.player);break;case"clearscroll":e.player&&eL(e.player);break}}),GM=hb(e=>postMessage(e));onmessage=function(t){GM(t.data)},setTimeout(WM)})();
