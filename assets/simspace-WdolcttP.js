(function(){"use strict";const vh=new Set,oa={emit(t,e,r,n,i){oa.invoke(_R(t,e,r,n,i))},invoke(t){vh.forEach(e=>e.handle(t))},connect(t){vh.add(t)},disconnect(t){vh.delete(t)}};var ji=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function fs(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function BS(t){if(Object.prototype.hasOwnProperty.call(t,"__esModule"))return t;var e=t.default;if(typeof e=="function"){var r=function n(){var i=!1;try{i=this instanceof n}catch{}return i?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};r.prototype=e.prototype}else r={};return Object.defineProperty(r,"__esModule",{value:!0}),Object.keys(t).forEach(function(n){var i=Object.getOwnPropertyDescriptor(t,n);Object.defineProperty(r,n,i.get?i:{enumerable:!0,get:function(){return t[n]}})}),r}var Ac={exports:{}},FS=Ac.exports,Wm;function DS(){return Wm||(Wm=1,(function(t,e){(function(r,n){t.exports=n()})(FS,function(){return r.importState=function(i){var s=new r;return s.importState(i),s},r;function r(){return(function(i){var s=0,o=0,a=0,c=1;i.length==0&&(i=[+new Date]);var l=n();s=l(" "),o=l(" "),a=l(" ");for(var u=0;u<i.length;u++)s-=l(i[u]),s<0&&(s+=1),o-=l(i[u]),o<0&&(o+=1),a-=l(i[u]),a<0&&(a+=1);l=null;var h=function(){var f=2091639*s+c*23283064365386963e-26;return s=o,o=a,a=f-(c=f|0)};return h.next=h,h.uint32=function(){return h()*4294967296},h.fract53=function(){return h()+(h()*2097152|0)*11102230246251565e-32},h.version="Alea 0.9",h.args=i,h.exportState=function(){return[s,o,a,c]},h.importState=function(f){s=+f[0]||0,o=+f[1]||0,a=+f[2]||0,c=+f[3]||0},h})(Array.prototype.slice.call(arguments))}function n(){var i=4022871197,s=function(o){o=o.toString();for(var a=0;a<o.length;a++){i+=o.charCodeAt(a);var c=.02519603282416938*i;i=c>>>0,c-=i,c*=i,i=c>>>0,c-=i,i+=c*4294967296}return(i>>>0)*23283064365386963e-26};return s.version="Mash 0.9",s}})})(Ac)),Ac.exports}var jS=DS(),Hm=fs(jS),aa={},Gm;function zS(){return Gm||(Gm=1,(function(t){var e=aa&&aa.__spreadArray||function(l,u,h){if(h||arguments.length===2)for(var f=0,d=u.length,m;f<d;f++)(m||!(f in u))&&(m||(m=Array.prototype.slice.call(u,0,f)),m[f]=u[f]);return l.concat(m||Array.prototype.slice.call(u))};Object.defineProperty(t,"__esModule",{value:!0}),t.minLength=t.maxLength=t.poolSize=t.humanId=t.adverbs=t.verbs=t.nouns=t.adjectives=void 0,t.adjectives=["afraid","all","angry","beige","big","better","bitter","blue","brave","breezy","bright","brown","bumpy","busy","calm","chatty","chilly","chubby","clean","clear","clever","cold","crazy","cruel","cuddly","curly","curvy","cute","common","cold","cool","cyan","dark","deep","dirty","dry","dull","eager","early","easy","eight","eighty","eleven","empty","every","evil","fair","famous","fast","fancy","few","fine","fifty","five","flat","fluffy","floppy","forty","four","free","fresh","fruity","full","funny","fuzzy","gentle","giant","gold","good","great","green","grumpy","happy","heavy","hip","honest","hot","huge","hungry","icy","itchy","khaki","kind","large","late","lazy","lemon","legal","light","little","long","loose","loud","lovely","lucky","major","many","mean","metal","mighty","modern","moody","nasty","neat","new","nice","nine","ninety","odd","old","olive","open","orange","pink","plain","plenty","polite","poor","pretty","proud","public","puny","petite","purple","quick","quiet","rare","real","ready","red","rich","ripe","rotten","rude","sad","salty","seven","shaggy","shaky","sharp","shiny","short","shy","silent","silly","silver","six","sixty","slick","slimy","slow","small","smart","smooth","social","soft","solid","some","sour","spicy","spotty","stale","strong","stupid","sweet","swift","tall","tame","tangy","tasty","ten","tender","thick","thin","thirty","three","tidy","tiny","tired","tough","tricky","true","twelve","twenty","two","upset","vast","violet","warm","weak","wet","whole","wicked","wide","wild","wise","witty","yellow","young","yummy"],t.nouns=["apes","animals","areas","bars","banks","baths","breads","bushes","cloths","clowns","clubs","hoops","loops","memes","papers","parks","paths","showers","sides","signs","sites","streets","teeth","tires","webs","actors","ads","adults","aliens","ants","apples","baboons","badgers","bags","bananas","bats","beans","bears","beds","beers","bees","berries","bikes","birds","boats","bobcats","books","bottles","boxes","brooms","buckets","bugs","buses","buttons","camels","cases","cameras","candies","candles","carpets","carrots","carrots","cars","cats","chairs","chefs","chicken","clocks","clouds","coats","cobras","coins","corners","colts","comics","cooks","cougars","regions","results","cows","crabs","crabs","crews","cups","cities","cycles","dancers","days","deer","dingos","dodos","dogs","dolls","donkeys","donuts","doodles","doors","dots","dragons","drinks","dryers","ducks","ducks","eagles","ears","eels","eggs","ends","mammals","emus","experts","eyes","facts","falcons","fans","feet","files","flies","flowers","forks","foxes","friends","frogs","games","garlics","geckos","geese","ghosts","ghosts","gifts","glasses","goats","grapes","groups","guests","hairs","hands","hats","heads","hornets","horses","hotels","hounds","houses","humans","icons","ideas","impalas","insects","islands","items","jars","jeans","jobs","jokes","keys","kids","kings","kiwis","knives","lamps","lands","laws","lemons","lies","lights","lines","lions","lizards","llamas","mails","mangos","maps","masks","meals","melons","mice","mirrors","moments","moles","monkeys","months","moons","moose","mugs","nails","needles","news","nights","numbers","olives","onions","oranges","otters","owls","pandas","pans","pants","papayas","parents","parts","parrots","paws","peaches","pears","peas","pens","pets","phones","pianos","pigs","pillows","places","planes","planets","plants","plums","poems","poets","points","pots","pugs","pumas","queens","rabbits","radios","rats","ravens","readers","rice","rings","rivers","rockets","rocks","rooms","roses","rules","schools","bats","seals","seas","sheep","shirts","shoes","shrimps","singers","sloths","snails","snakes","socks","spiders","spies","spoons","squids","stars","states","steaks","wings","suits","suns","swans","symbols","tables","taxes","taxis","teams","terms","things","ties","tigers","times","tips","toes","towns","tools","toys","trains","trams","trees","turkeys","turtles","vans","views","walls","walls","wasps","waves","ways","weeks","windows","wolves","women","wombats","words","worlds","worms","yaks","years","zebras","zoos"],t.verbs=["accept","act","add","admire","agree","allow","appear","argue","arrive","ask","attack","attend","bake","bathe","battle","beam","beg","begin","behave","bet","boil","bow","brake","brush","build","burn","buy","call","camp","care","carry","change","cheat","check","cheer","chew","clap","clean","cough","count","cover","crash","create","cross","cry","cut","dance","decide","deny","design","dig","divide","do","double","doubt","draw","dream","dress","drive","drop","drum","eat","end","enter","enjoy","exist","fail","fall","feel","fetch","film","find","fix","flash","float","flow","fly","fold","follow","fry","give","glow","go","grab","greet","grin","grow","guess","hammer","hang","happen","heal","hear","help","hide","hope","hug","hunt","invent","invite","itch","jam","jog","join","joke","judge","juggle","jump","kick","kiss","kneel","knock","know","laugh","lay","lead","learn","leave","lick","like","lie","listen","live","look","lose","love","make","march","marry","mate","matter","melt","mix","move","nail","notice","obey","occur","open","own","pay","peel","play","poke","post","press","prove","pull","pump","pick","punch","push","raise","read","refuse","relate","relax","remain","repair","repeat","reply","report","rescue","rest","retire","return","rhyme","ring","roll","rule","run","rush","say","scream","see","search","sell","send","serve","shake","share","shave","shine","show","shop","shout","sin","sink","sing","sip","sit","sleep","slide","smash","smell","smile","smoke","sneeze","sniff","sort","speak","spend","stand","start","stay","stick","stop","stare","study","strive","swim","switch","take","talk","tan","tap","taste","teach","tease","tell","thank","think","throw","tickle","tie","trade","train","travel","try","turn","type","unite","vanish","visit","wait","walk","warn","wash","watch","wave","wear","win","wink","wish","wonder","work","worry","write","yawn","yell"],t.adverbs=["bravely","brightly","busily","daily","freely","hungrily","joyously","knowlingly","lazily","oddly","mysteriously","noisily","politely","quickly","quietly","rapidly","safely","sleepily","slowly","truly","yearly"];function r(l){return l[Math.floor(Math.random()*l.length)]}function n(l){return l.reduce(function(u,h){return u.length>h.length?u:h})}function i(l){return l.reduce(function(u,h){return u.length<h.length?u:h})}function s(l){l===void 0&&(l={}),typeof l=="string"&&(l={separator:l}),typeof l=="boolean"&&(l={capitalize:l});var u=l.separator,h=u===void 0?"":u,f=l.capitalize,d=f===void 0?!0:f,m=l.adjectiveCount,p=m===void 0?1:m,g=l.addAdverb,y=g===void 0?!1:g,_=e(e(e([],e([],Array(p),!0).map(function(A){return r(t.adjectives)}),!0),[r(t.nouns),r(t.verbs)],!1),y?[r(t.adverbs)]:[],!0);return d&&(_=_.map(function(A){return A.charAt(0).toUpperCase()+A.substr(1)})),_.join(h)}t.humanId=s;function o(l){l===void 0&&(l={});var u=l.adjectiveCount,h=u===void 0?1:u,f=l.addAdverb,d=f===void 0?!1:f;return t.adjectives.length*h*t.nouns.length*t.verbs.length*(d?t.adverbs.length:1)}t.poolSize=o;function a(l){l===void 0&&(l={});var u=l.adjectiveCount,h=u===void 0?1:u,f=l.addAdverb,d=f===void 0?!1:f,m=l.separator,p=m===void 0?"":m;return n(t.adjectives).length*h+h*p.length+n(t.nouns).length+p.length+n(t.verbs).length+(d?n(t.adverbs).length+p.length:0)}t.maxLength=a;function c(l){l===void 0&&(l={});var u=l.adjectiveCount,h=u===void 0?1:u,f=l.addAdverb,d=f===void 0?!1:f,m=l.separator,p=m===void 0?"":m;return i(t.adjectives).length*h+h*p.length+i(t.nouns).length+p.length+i(t.verbs).length+(d?i(t.adverbs).length+p.length:0)}t.minLength=c,t.default=s})(aa)),aa}var WS=zS(),Km=fs(WS);const HS="useandom-26T198340PX75pxJACKVERYMINDBUSHWOLF_GQZbfghjklqvwyzrict";let GS=t=>crypto.getRandomValues(new Uint8Array(t)),KS=(t,e,r)=>{let n=(2<<Math.log2(t.length-1))-1,i=-~(1.6*n*e/t.length);return(s=e)=>{let o="";for(;;){let a=r(i),c=i|0;for(;c--;)if(o+=t[a[c]&n]||"",o.length>=s)return o}}},qm=(t,e=21)=>KS(t,e|0,GS),qS=(t=21)=>{let e="",r=crypto.getRandomValues(new Uint8Array(t|=0));for(;t--;)e+=HS[r[t]&63];return e};var xh,Ym;function Vm(){return Ym||(Ym=1,xh="abcdefghijklmnopqrstuvwxyz"),xh}var Eh,Xm;function Zm(){return Xm||(Xm=1,Eh="ABCDEFGHIJKLMNOPQRSTUVWXYZ"),Eh}var Ah,Jm;function Qm(){return Jm||(Jm=1,Ah="0123456789"),Ah}var Th,eg;function YS(){return eg||(eg=1,Th="346789ABCDEFGHJKLMNPQRTUVWXYabcdefghijkmnpqrtwxyz"),Th}var Sh,tg;function VS(){return tg||(tg=1,Sh="6789BCDFGHJKLMNPQRTWbcdfghjkmnpqrtwz"),Sh}var Rh,rg;function XS(){if(rg)return Rh;rg=1;const t=Qm(),e=Vm(),r=Zm();return Rh=t+e+r,Rh}var Oh,ng;function ZS(){return ng||(ng=1,Oh={lowercase:Vm(),uppercase:Zm(),numbers:Qm(),nolookalikes:YS(),nolookalikesSafe:VS(),alphanumeric:XS()}),Oh}var Ih=ZS();function Bt(){return`sid_${qS(12).replaceAll("-",".")}`}qm(Ih.numbers,4),qm(`${Ih.numbers}${Ih.lowercase}`,16);function sr(t){return t?.startsWith("pid_")??!1}function JS(){return Km({capitalize:!1,adjectiveCount:1})}function QS(){return Km({addAdverb:!1,capitalize:!1,adjectiveCount:0})}/*!
 * https://github.com/Starcounter-Jack/JSON-Patch
 * (c) 2017-2022 Joachim Wester
 * MIT licensed
 */var eR=(function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var s in i)i.hasOwnProperty(s)&&(n[s]=i[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}})(),tR=Object.prototype.hasOwnProperty;function Nh(t,e){return tR.call(t,e)}function Ch(t){if(Array.isArray(t)){for(var e=new Array(t.length),r=0;r<e.length;r++)e[r]=""+r;return e}if(Object.keys)return Object.keys(t);var n=[];for(var i in t)Nh(t,i)&&n.push(i);return n}function Pr(t){switch(typeof t){case"object":return JSON.parse(JSON.stringify(t));case"undefined":return null;default:return t}}function Lh(t){for(var e=0,r=t.length,n;e<r;){if(n=t.charCodeAt(e),n>=48&&n<=57){e++;continue}return!1}return!0}function ds(t){return t.indexOf("/")===-1&&t.indexOf("~")===-1?t:t.replace(/~/g,"~0").replace(/\//g,"~1")}function ig(t){return t.replace(/~1/g,"/").replace(/~0/g,"~")}function Mh(t){if(t===void 0)return!0;if(t){if(Array.isArray(t)){for(var e=0,r=t.length;e<r;e++)if(Mh(t[e]))return!0}else if(typeof t=="object"){for(var n=Ch(t),i=n.length,s=0;s<i;s++)if(Mh(t[n[s]]))return!0}}return!1}function sg(t,e){var r=[t];for(var n in e){var i=typeof e[n]=="object"?JSON.stringify(e[n],null,2):e[n];typeof i<"u"&&r.push(n+": "+i)}return r.join(`
`)}var og=(function(t){eR(e,t);function e(r,n,i,s,o){var a=this.constructor,c=t.call(this,sg(r,{name:n,index:i,operation:s,tree:o}))||this;return c.name=n,c.index=i,c.operation=s,c.tree=o,Object.setPrototypeOf(c,a.prototype),c.message=sg(r,{name:n,index:i,operation:s,tree:o}),c}return e})(Error),Lt=og,rR=Pr,no={add:function(t,e,r){return t[e]=this.value,{newDocument:r}},remove:function(t,e,r){var n=t[e];return delete t[e],{newDocument:r,removed:n}},replace:function(t,e,r){var n=t[e];return t[e]=this.value,{newDocument:r,removed:n}},move:function(t,e,r){var n=Tc(r,this.path);n&&(n=Pr(n));var i=ps(r,{op:"remove",path:this.from}).removed;return ps(r,{op:"add",path:this.path,value:i}),{newDocument:r,removed:n}},copy:function(t,e,r){var n=Tc(r,this.from);return ps(r,{op:"add",path:this.path,value:Pr(n)}),{newDocument:r}},test:function(t,e,r){return{newDocument:r,test:ca(t[e],this.value)}},_get:function(t,e,r){return this.value=t[e],{newDocument:r}}},nR={add:function(t,e,r){return Lh(e)?t.splice(e,0,this.value):t[e]=this.value,{newDocument:r,index:e}},remove:function(t,e,r){var n=t.splice(e,1);return{newDocument:r,removed:n[0]}},replace:function(t,e,r){var n=t[e];return t[e]=this.value,{newDocument:r,removed:n}},move:no.move,copy:no.copy,test:no.test,_get:no._get};function Tc(t,e){if(e=="")return t;var r={op:"_get",path:e};return ps(t,r),r.value}function ps(t,e,r,n,i,s){if(r===void 0&&(r=!1),n===void 0&&(n=!0),i===void 0&&(i=!0),s===void 0&&(s=0),r&&(typeof r=="function"?r(e,0,t,e.path):Sc(e,0)),e.path===""){var o={newDocument:t};if(e.op==="add")return o.newDocument=e.value,o;if(e.op==="replace")return o.newDocument=e.value,o.removed=t,o;if(e.op==="move"||e.op==="copy")return o.newDocument=Tc(t,e.from),e.op==="move"&&(o.removed=t),o;if(e.op==="test"){if(o.test=ca(t,e.value),o.test===!1)throw new Lt("Test operation failed","TEST_OPERATION_FAILED",s,e,t);return o.newDocument=t,o}else{if(e.op==="remove")return o.removed=t,o.newDocument=null,o;if(e.op==="_get")return e.value=t,o;if(r)throw new Lt("Operation `op` property is not one of operations defined in RFC-6902","OPERATION_OP_INVALID",s,e,t);return o}}else{n||(t=Pr(t));var a=e.path||"",c=a.split("/"),l=t,u=1,h=c.length,f=void 0,d=void 0,m=void 0;for(typeof r=="function"?m=r:m=Sc;;){if(d=c[u],d&&d.indexOf("~")!=-1&&(d=ig(d)),i&&(d=="__proto__"||d=="prototype"&&u>0&&c[u-1]=="constructor"))throw new TypeError("JSON-Patch: modifying `__proto__` or `constructor/prototype` prop is banned for security reasons, if this was on purpose, please set `banPrototypeModifications` flag false and pass it to this function. More info in fast-json-patch README");if(r&&f===void 0&&(l[d]===void 0?f=c.slice(0,u).join("/"):u==h-1&&(f=e.path),f!==void 0&&m(e,0,t,f)),u++,Array.isArray(l)){if(d==="-")d=l.length;else{if(r&&!Lh(d))throw new Lt("Expected an unsigned base-10 integer value, making the new referenced value the array element with the zero-based index","OPERATION_PATH_ILLEGAL_ARRAY_INDEX",s,e,t);Lh(d)&&(d=~~d)}if(u>=h){if(r&&e.op==="add"&&d>l.length)throw new Lt("The specified index MUST NOT be greater than the number of elements in the array","OPERATION_VALUE_OUT_OF_BOUNDS",s,e,t);var o=nR[e.op].call(e,l,d,t);if(o.test===!1)throw new Lt("Test operation failed","TEST_OPERATION_FAILED",s,e,t);return o}}else if(u>=h){var o=no[e.op].call(e,l,d,t);if(o.test===!1)throw new Lt("Test operation failed","TEST_OPERATION_FAILED",s,e,t);return o}if(l=l[d],r&&u<h&&(!l||typeof l!="object"))throw new Lt("Cannot perform operation at the desired path","OPERATION_PATH_UNRESOLVABLE",s,e,t)}}}function Uh(t,e,r,n,i){if(n===void 0&&(n=!0),i===void 0&&(i=!0),r&&!Array.isArray(e))throw new Lt("Patch sequence must be an array","SEQUENCE_NOT_AN_ARRAY");n||(t=Pr(t));for(var s=new Array(e.length),o=0,a=e.length;o<a;o++)s[o]=ps(t,e[o],r,!0,i,o),t=s[o].newDocument;return s.newDocument=t,s}function iR(t,e,r){var n=ps(t,e);if(n.test===!1)throw new Lt("Test operation failed","TEST_OPERATION_FAILED",r,e,t);return n.newDocument}function Sc(t,e,r,n){if(typeof t!="object"||t===null||Array.isArray(t))throw new Lt("Operation is not an object","OPERATION_NOT_AN_OBJECT",e,t,r);if(no[t.op]){if(typeof t.path!="string")throw new Lt("Operation `path` property is not a string","OPERATION_PATH_INVALID",e,t,r);if(t.path.indexOf("/")!==0&&t.path.length>0)throw new Lt('Operation `path` property must start with "/"',"OPERATION_PATH_INVALID",e,t,r);if((t.op==="move"||t.op==="copy")&&typeof t.from!="string")throw new Lt("Operation `from` property is not present (applicable in `move` and `copy` operations)","OPERATION_FROM_REQUIRED",e,t,r);if((t.op==="add"||t.op==="replace"||t.op==="test")&&t.value===void 0)throw new Lt("Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)","OPERATION_VALUE_REQUIRED",e,t,r);if((t.op==="add"||t.op==="replace"||t.op==="test")&&Mh(t.value))throw new Lt("Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)","OPERATION_VALUE_CANNOT_CONTAIN_UNDEFINED",e,t,r);if(r){if(t.op=="add"){var i=t.path.split("/").length,s=n.split("/").length;if(i!==s+1&&i!==s)throw new Lt("Cannot perform an `add` operation at the desired path","OPERATION_PATH_CANNOT_ADD",e,t,r)}else if(t.op==="replace"||t.op==="remove"||t.op==="_get"){if(t.path!==n)throw new Lt("Cannot perform the operation at a path that does not exist","OPERATION_PATH_UNRESOLVABLE",e,t,r)}else if(t.op==="move"||t.op==="copy"){var o={op:"_get",path:t.from,value:void 0},a=ag([o],r);if(a&&a.name==="OPERATION_PATH_UNRESOLVABLE")throw new Lt("Cannot perform the operation from a path that does not exist","OPERATION_FROM_UNRESOLVABLE",e,t,r)}}}else throw new Lt("Operation `op` property is not one of operations defined in RFC-6902","OPERATION_OP_INVALID",e,t,r)}function ag(t,e,r){try{if(!Array.isArray(t))throw new Lt("Patch sequence must be an array","SEQUENCE_NOT_AN_ARRAY");if(e)Uh(Pr(e),Pr(t),r||!0);else{r=r||Sc;for(var n=0;n<t.length;n++)r(t[n],n,e,void 0)}}catch(i){if(i instanceof Lt)return i;throw i}}function ca(t,e){if(t===e)return!0;if(t&&e&&typeof t=="object"&&typeof e=="object"){var r=Array.isArray(t),n=Array.isArray(e),i,s,o;if(r&&n){if(s=t.length,s!=e.length)return!1;for(i=s;i--!==0;)if(!ca(t[i],e[i]))return!1;return!0}if(r!=n)return!1;var a=Object.keys(t);if(s=a.length,s!==Object.keys(e).length)return!1;for(i=s;i--!==0;)if(!e.hasOwnProperty(a[i]))return!1;for(i=s;i--!==0;)if(o=a[i],!ca(t[o],e[o]))return!1;return!0}return t!==t&&e!==e}var sR=Object.freeze({__proto__:null,JsonPatchError:Lt,_areEquals:ca,applyOperation:ps,applyPatch:Uh,applyReducer:iR,deepClone:rR,getValueByPointer:Tc,validate:ag,validator:Sc});/*!
 * https://github.com/Starcounter-Jack/JSON-Patch
 * (c) 2017-2021 Joachim Wester
 * MIT license
 */var $h=new WeakMap,oR=(function(){function t(e){this.observers=new Map,this.obj=e}return t})(),aR=(function(){function t(e,r){this.callback=e,this.observer=r}return t})();function cR(t){return $h.get(t)}function lR(t,e){return t.observers.get(e)}function uR(t,e){t.observers.delete(e.callback)}function hR(t,e){e.unobserve()}function fR(t,e){var r=[],n,i=cR(t);if(!i)i=new oR(t),$h.set(t,i);else{var s=lR(i,e);n=s&&s.observer}if(n)return n;if(n={},i.value=Pr(t),e){n.callback=e,n.next=null;var o=function(){Ph(n)},a=function(){clearTimeout(n.next),n.next=setTimeout(o)};typeof window<"u"&&(window.addEventListener("mouseup",a),window.addEventListener("keyup",a),window.addEventListener("mousedown",a),window.addEventListener("keydown",a),window.addEventListener("change",a))}return n.patches=r,n.object=t,n.unobserve=function(){Ph(n),clearTimeout(n.next),uR(i,n),typeof window<"u"&&(window.removeEventListener("mouseup",a),window.removeEventListener("keyup",a),window.removeEventListener("mousedown",a),window.removeEventListener("keydown",a),window.removeEventListener("change",a))},i.observers.set(e,new aR(e,n)),n}function Ph(t,e){e===void 0&&(e=!1);var r=$h.get(t.object);Bh(r.value,t.object,t.patches,"",e),t.patches.length&&Uh(r.value,t.patches);var n=t.patches;return n.length>0&&(t.patches=[],t.callback&&t.callback(n)),n}function Bh(t,e,r,n,i){if(e!==t){typeof e.toJSON=="function"&&(e=e.toJSON());for(var s=Ch(e),o=Ch(t),a=!1,c=o.length-1;c>=0;c--){var l=o[c],u=t[l];if(Nh(e,l)&&!(e[l]===void 0&&u!==void 0&&Array.isArray(e)===!1)){var h=e[l];typeof u=="object"&&u!=null&&typeof h=="object"&&h!=null&&Array.isArray(u)===Array.isArray(h)?Bh(u,h,r,n+"/"+ds(l),i):u!==h&&(i&&r.push({op:"test",path:n+"/"+ds(l),value:Pr(u)}),r.push({op:"replace",path:n+"/"+ds(l),value:Pr(h)}))}else Array.isArray(t)===Array.isArray(e)?(i&&r.push({op:"test",path:n+"/"+ds(l),value:Pr(u)}),r.push({op:"remove",path:n+"/"+ds(l)}),a=!0):(i&&r.push({op:"test",path:n,value:t}),r.push({op:"replace",path:n,value:e}))}if(!(!a&&s.length==o.length))for(var c=0;c<s.length;c++){var l=s[c];!Nh(t,l)&&e[l]!==void 0&&r.push({op:"add",path:n+"/"+ds(l),value:Pr(e[l])})}}}function cg(t,e,r){r===void 0&&(r=!1);var n=[];return Bh(t,e,n,"",r),n}var dR=Object.freeze({__proto__:null,compare:cg,generate:Ph,observe:fR,unobserve:hR});Object.assign({},sR,dR,{JsonPatchError:og,deepClone:Pr,escapePathComponent:ds,unescapePathComponent:ig});var Fh,lg;function pR(){if(lg)return Fh;lg=1;var t=typeof Element<"u",e=typeof Map=="function",r=typeof Set=="function",n=typeof ArrayBuffer=="function"&&!!ArrayBuffer.isView;function i(s,o){if(s===o)return!0;if(s&&o&&typeof s=="object"&&typeof o=="object"){if(s.constructor!==o.constructor)return!1;var a,c,l;if(Array.isArray(s)){if(a=s.length,a!=o.length)return!1;for(c=a;c--!==0;)if(!i(s[c],o[c]))return!1;return!0}var u;if(e&&s instanceof Map&&o instanceof Map){if(s.size!==o.size)return!1;for(u=s.entries();!(c=u.next()).done;)if(!o.has(c.value[0]))return!1;for(u=s.entries();!(c=u.next()).done;)if(!i(c.value[1],o.get(c.value[0])))return!1;return!0}if(r&&s instanceof Set&&o instanceof Set){if(s.size!==o.size)return!1;for(u=s.entries();!(c=u.next()).done;)if(!o.has(c.value[0]))return!1;return!0}if(n&&ArrayBuffer.isView(s)&&ArrayBuffer.isView(o)){if(a=s.length,a!=o.length)return!1;for(c=a;c--!==0;)if(s[c]!==o[c])return!1;return!0}if(s.constructor===RegExp)return s.source===o.source&&s.flags===o.flags;if(s.valueOf!==Object.prototype.valueOf&&typeof s.valueOf=="function"&&typeof o.valueOf=="function")return s.valueOf()===o.valueOf();if(s.toString!==Object.prototype.toString&&typeof s.toString=="function"&&typeof o.toString=="function")return s.toString()===o.toString();if(l=Object.keys(s),a=l.length,a!==Object.keys(o).length)return!1;for(c=a;c--!==0;)if(!Object.prototype.hasOwnProperty.call(o,l[c]))return!1;if(t&&s instanceof Element)return!1;for(c=a;c--!==0;)if(!((l[c]==="_owner"||l[c]==="__v"||l[c]==="__o")&&s.$$typeof)&&!i(s[l[c]],o[l[c]]))return!1;return!0}return s!==s&&o!==o}return Fh=function(o,a){try{return i(o,a)}catch(c){if((c.message||"").match(/stack|recursion/i))return console.warn("react-fast-compare cannot handle circular refs"),!1;throw c}},Fh}var mR=pR(),gR=fs(mR);function w(t){return t!=null}const Br=Object.keys;function Sn(t){return Pr(t)}function yR(t){return typeof t=="boolean"}function Ae(t){return typeof t=="number"&&isNaN(t)===!1}function ye(t){return typeof t=="string"}function ut(t){return Array.isArray(t)}function Dh(t){return t}var Je=(t=>(t[t.BLACK=0]="BLACK",t[t.DKBLUE=1]="DKBLUE",t[t.DKGREEN=2]="DKGREEN",t[t.DKCYAN=3]="DKCYAN",t[t.DKRED=4]="DKRED",t[t.DKPURPLE=5]="DKPURPLE",t[t.DKYELLOW=6]="DKYELLOW",t[t.LTGRAY=7]="LTGRAY",t[t.DKGRAY=8]="DKGRAY",t[t.BLUE=9]="BLUE",t[t.GREEN=10]="GREEN",t[t.CYAN=11]="CYAN",t[t.RED=12]="RED",t[t.PURPLE=13]="PURPLE",t[t.YELLOW=14]="YELLOW",t[t.WHITE=15]="WHITE",t[t.ONBLACK=16]="ONBLACK",t[t.ONDKBLUE=17]="ONDKBLUE",t[t.ONDKGREEN=18]="ONDKGREEN",t[t.ONDKCYAN=19]="ONDKCYAN",t[t.ONDKRED=20]="ONDKRED",t[t.ONDKPURPLE=21]="ONDKPURPLE",t[t.ONDKYELLOW=22]="ONDKYELLOW",t[t.ONLTGRAY=23]="ONLTGRAY",t[t.ONDKGRAY=24]="ONDKGRAY",t[t.ONBLUE=25]="ONBLUE",t[t.ONGREEN=26]="ONGREEN",t[t.ONCYAN=27]="ONCYAN",t[t.ONRED=28]="ONRED",t[t.ONPURPLE=29]="ONPURPLE",t[t.ONYELLOW=30]="ONYELLOW",t[t.ONWHITE=31]="ONWHITE",t[t.ONCLEAR=32]="ONCLEAR",t[t.BLBLACK=33]="BLBLACK",t[t.BLDKBLUE=34]="BLDKBLUE",t[t.BLDKGREEN=35]="BLDKGREEN",t[t.BLDKCYAN=36]="BLDKCYAN",t[t.BLDKRED=37]="BLDKRED",t[t.BLDKPURPLE=38]="BLDKPURPLE",t[t.BLDKYELLOW=39]="BLDKYELLOW",t[t.BLLTGRAY=40]="BLLTGRAY",t[t.BLDKGRAY=41]="BLDKGRAY",t[t.BLBLUE=42]="BLBLUE",t[t.BLGREEN=43]="BLGREEN",t[t.BLCYAN=44]="BLCYAN",t[t.BLRED=45]="BLRED",t[t.BLPURPLE=46]="BLPURPLE",t[t.BLYELLOW=47]="BLYELLOW",t[t.BLWHITE=48]="BLWHITE",t))(Je||{}),We=(t=>(t[t.ISWALK=0]="ISWALK",t[t.ISSOLID=1]="ISSOLID",t[t.ISSWIM=2]="ISSWIM",t[t.ISBULLET=3]="ISBULLET",t[t.ISGHOST=4]="ISGHOST",t))(We||{}),Fr=(t=>(t[t.ISTERRAIN=0]="ISTERRAIN",t[t.ISOBJECT=1]="ISOBJECT",t))(Fr||{}),ve=(t=>(t[t.IDLE=0]="IDLE",t[t.NORTH=1]="NORTH",t[t.SOUTH=2]="SOUTH",t[t.WEST=3]="WEST",t[t.EAST=4]="EAST",t[t.BY=5]="BY",t[t.AT=6]="AT",t[t.FLOW=7]="FLOW",t[t.SEEK=8]="SEEK",t[t.RNDNS=9]="RNDNS",t[t.RNDNE=10]="RNDNE",t[t.RND=11]="RND",t[t.CW=12]="CW",t[t.CCW=13]="CCW",t[t.OPP=14]="OPP",t[t.RNDP=15]="RNDP",t[t.AWAY=16]="AWAY",t[t.TOWARD=17]="TOWARD",t[t.FIND=18]="FIND",t[t.FLEE=19]="FLEE",t[t.TO=20]="TO",t[t.MID=21]="MID",t[t.OVER=22]="OVER",t[t.UNDER=23]="UNDER",t[t.WITHIN=24]="WITHIN",t[t.AWAYBY=25]="AWAYBY",t))(ve||{}),Pe=(t=>(t[t.LOADER=0]="LOADER",t[t.BOARD=1]="BOARD",t[t.OBJECT=2]="OBJECT",t[t.TERRAIN=3]="TERRAIN",t[t.CHARSET=4]="CHARSET",t[t.PALETTE=5]="PALETTE",t[t.CONST=6]="CONST",t[t.RANGE=7]="RANGE",t[t.SELECT=8]="SELECT",t[t.NUMBER=9]="NUMBER",t[t.TEXT=10]="TEXT",t[t.HOTKEY=11]="HOTKEY",t[t.COPYIT=12]="COPYIT",t[t.OPENIT=13]="OPENIT",t[t.VIEWIT=14]="VIEWIT",t[t.ZSSEDIT=15]="ZSSEDIT",t[t.CHAREDIT=16]="CHAREDIT",t[t.COLOREDIT=17]="COLOREDIT",t))(Pe||{});function Fe(t){return ye(t)?t.toLowerCase().trim():""}function _R(t,e,r,n,i){return{session:t,player:e,id:Bt(),sender:r,target:n,data:i}}function Dr(t){const[e,...r]=t.split(":");return{target:e,path:r.join(":")}}function io(t,e=[],r=Dh,n=""){const i=Bt(),s=Fe(t),o=e.map(Fe);let a=n;const c={id(){return i},name(){return t},session(l){return w(l)?l.session===a?l.session:"":a},topics(){return e},emit(l,u,h){oa.emit(a,l,i,u,h)},reply(l,u,h){c.emit(l.player,`${l.sender}:${u}`,h)},replynext(l,u,h){setTimeout(()=>c.emit(l.player,`${l.sender}:${u}`,h),64)},handle(l){const{target:u,path:h}=Dr(l.target),f=Fe(u);!a&&f==="ready"&&(a=l.session),f==="session_reset"&&(a=""),o.findIndex(d=>d==="all"||d===f)!==-1&&r(l),(i===u||f==="all"||s===f)&&r({...l,target:h})}};return oa.connect(c),c}function bR(t){return typeof t=="object"&&ye(t.session)&&ye(t.player)&&ye(t.id)&&ye(t.sender)&&ye(t.target)}function pt(t,e,r,...n){return t.emit(e,"error",[`$red${r}$blue>>`,...n]),!1}function wR(t,e,...r){return t.emit(e,"info",r),!0}function Ft(t,e,...r){return t.emit(e,"log",r),!0}function kR(t,e,...r){return t.emit(e,"chat",r),!0}function ms(t,e,r){t.emit(e,"toast",r)}function vR(t,e,r){t.emit(e,"bridge:streamstart",r)}function xR(t,e){t.emit(e,"bridge:streamstop",void 0)}function ER(t,e,r){t.emit(e,"bridge:chatstart",r)}function AR(t,e){t.emit(e,"bridge:chatstop")}function TR(t,e,r,n,i,s,o){t.emit(e,"bridge:fetch",[r,n,i,s,o])}function SR(t,e,r){t.emit(e,"bridge:start",r)}function RR(t,e,r){t.emit(e,"bridge:tab",r)}function OR(t,e,r){t.emit(e,"gadgetclient:paint",r)}function IR(t,e,r){t.emit(e,"gadgetclient:patch",r)}function NR(t,e){t.emit(e,"gadgetserver:clearscroll")}function CR(t,e){t.emit(e,"gadgetserver:clearplayer")}function LR(t){t.emit("","ready")}function ug(t,e){t.emit(e,"register:loginfail")}function jh(t,e){t.emit(e,"register:loginready",!0)}function MR(t,e,r,n){t.emit(e,"register:savemem",[r,n])}function UR(t,e,r){t.emit(e,"register:forkmem",[r])}function $R(t,e,r,n){t.emit(e,"register:itchiopublishmem",[r,n])}function Rc(t,e,r){t.emit(e,"register:copy",r)}function PR(t,e,r,n){t.emit(e,"register:copyjsonfile",[r,n])}function hg(t,e,r,n){t.emit(e,"register:downloadjsonfile",[r,n])}function BR(t,e){t.emit(e,"register:dev",void 0)}function FR(t,e){t.emit(e,"register:share",void 0)}function DR(t,e){t.emit(e,"register:nuke",void 0)}function jR(t,e){t.emit(e,"register:enterar",void 0)}function zR(t,e,r,n){t.emit(e,"synth:tts",[r,n])}function WR(t,e,r,n){t.emit(e,"synth:ttsqueue",[r,n])}function HR(t,e,r,n){t.emit(e,"synth:play",[r,n])}function GR(t,e,r,n,i){t.emit(e,"synth:bgplay",[r,n,i])}function KR(t,e,r){t.emit(e,"synth:bpm",r)}function qR(t,e,r){t.emit(e,"synth:playvolume",r)}function YR(t,e,r){t.emit(e,"synth:bgplayvolume",r)}function VR(t,e,r){t.emit(e,"synth:ttsvolume",r)}function zh(t,e,r,n,i){t.emit(e,"synth:voice",[r,n,i])}function fg(t,e,r,n,i,s){t.emit(e,"synth:voicefx",[r,n,i,s])}function XR(t,e,r){t.emit(e,"synth:record",r)}function ZR(t,e){t.emit(e,"synth:flush",filename)}function dg(t,e,r,n){t.emit(e,"register:config",[r,n])}function JR(t,e){t.emit(e,"register:configshow")}function QR(t,e){t.emit(e,"register:inspector")}function eO(t,e){t.emit(e,"register:terminal:full")}function pg(t,e,r,n,i,s){t.emit(e,"register:editor:open",[r,n,i,s])}function tO(t,e,r,n){t.emit(e,"vm:zztsearch",[r,n])}function rO(t,e){t.emit(e,"vm:zztrandom")}function nO(t,e){t.emit(e,"vm:local")}function Wh(t,e){t.emit(e,"vm:logout")}function mg(t,e,r,n,i){t.emit(e,"vm:touched",[r,n,i])}function iO(t,e){t.emit(e,"vm:readzipfilelist")}function Oc(t,e){const[r,n]=e;return`${t}:${[r,n].filter(w).join(":")}`}function sO(t,e,r){t.emit(e,"vm:cli",r)}function oO(t,e){t.emit(e,"vm:restart")}function gg(t,e){t.emit(e,"vm:flush")}function aO(t,e){t.emit(e,"vm:fork")}function cO(t,e){t.emit(e,"vm:itchiopublish")}function lO(t,e){return{filename:t,cursor:0,lines:e.split(`
`)}}function uO(t,e){return{filename:t,json:e}}function hO(t,e){return{filename:t,cursor:0,bytes:e,dataview:new DataView(e.buffer)}}function Hh(t,e,r,n,i,s){let o;switch(n){case"file":o=s;break;case"text":o=lO(i,s);break;case"json":o=uO(i,s);break;case"binary":o=hO(i,s);break}setTimeout(()=>{t.emit(e,"vm:loader",[r,n,i,o])},1)}function fO(t){const e=new Set;function r(s){bR(s)&&s.target!=="tick"&&s.target!=="tock"&&e.has(s.id)===!1&&(e.add(s.id),oa.invoke(s))}const n=io("forward",["all"],s=>{e.has(s.id)||(e.add(s.id),t(s))});function i(){oa.disconnect(n)}return{forward:r,disconnect:i}}function dO(t){switch(t.target){case"log":case"info":case"error":case"tick":case"tock":case"ready":case"chat":case"toast":case"second":return!0;default:{const e=Dr(t.target);switch(e.target){case"vm":case"synth":case"modem":case"bridge":case"register":case"gadgetclient":return!0}switch(e.path){case"sync":case"joinack":case"acklogin":case"ackoperator":case"ackzsswords":case"gadgetclient":return!0}break}}return!1}const Gh=80,Ic=Math.floor(1e3/Gh),yg=3;function Nc(t){return new Promise(e=>setTimeout(e,t))}const Kh=io("clock");let qh=0,Cc=0,Yh=0,_g=performance.now();function bg(){const t=performance.now(),e=t-_g;Yh+=e,Yh>=Gh&&(Yh%=Gh,Kh.emit("","tick",Cc),Kh.emit("","tock",Cc),++qh,++Cc,qh>=Ic&&(qh%=Ic,Kh.emit("","second",Cc))),_g=t,setTimeout(bg,2)}bg();var Vh={exports:{}};function pO(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var wg={exports:{}},Dt=wg.exports={},Gn,Kn;function Xh(){throw new Error("setTimeout has not been defined")}function Zh(){throw new Error("clearTimeout has not been defined")}(function(){try{typeof setTimeout=="function"?Gn=setTimeout:Gn=Xh}catch{Gn=Xh}try{typeof clearTimeout=="function"?Kn=clearTimeout:Kn=Zh}catch{Kn=Zh}})();function kg(t){if(Gn===setTimeout)return setTimeout(t,0);if((Gn===Xh||!Gn)&&setTimeout)return Gn=setTimeout,setTimeout(t,0);try{return Gn(t,0)}catch{try{return Gn.call(null,t,0)}catch{return Gn.call(this,t,0)}}}function mO(t){if(Kn===clearTimeout)return clearTimeout(t);if((Kn===Zh||!Kn)&&clearTimeout)return Kn=clearTimeout,clearTimeout(t);try{return Kn(t)}catch{try{return Kn.call(null,t)}catch{return Kn.call(this,t)}}}var mi=[],so=!1,gs,Lc=-1;function gO(){!so||!gs||(so=!1,gs.length?mi=gs.concat(mi):Lc=-1,mi.length&&vg())}function vg(){if(!so){var t=kg(gO);so=!0;for(var e=mi.length;e;){for(gs=mi,mi=[];++Lc<e;)gs&&gs[Lc].run();Lc=-1,e=mi.length}gs=null,so=!1,mO(t)}}Dt.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)e[r-1]=arguments[r];mi.push(new xg(t,e)),mi.length===1&&!so&&kg(vg)};function xg(t,e){this.fun=t,this.array=e}xg.prototype.run=function(){this.fun.apply(null,this.array)},Dt.title="browser",Dt.browser=!0,Dt.env={},Dt.argv=[],Dt.version="",Dt.versions={};function gi(){}Dt.on=gi,Dt.addListener=gi,Dt.once=gi,Dt.off=gi,Dt.removeListener=gi,Dt.removeAllListeners=gi,Dt.emit=gi,Dt.prependListener=gi,Dt.prependOnceListener=gi,Dt.listeners=function(t){return[]},Dt.binding=function(t){throw new Error("process.binding is not supported")},Dt.cwd=function(){return"/"},Dt.chdir=function(t){throw new Error("process.chdir is not supported")},Dt.umask=function(){return 0};var yO=wg.exports;const Rn=pO(yO);var et={},Eg;function _O(){if(Eg)return et;Eg=1;var t=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),r=Symbol.for("react.fragment"),n=Symbol.for("react.strict_mode"),i=Symbol.for("react.profiler"),s=Symbol.for("react.consumer"),o=Symbol.for("react.context"),a=Symbol.for("react.forward_ref"),c=Symbol.for("react.suspense"),l=Symbol.for("react.memo"),u=Symbol.for("react.lazy"),h=Symbol.iterator;function f(N){return N===null||typeof N!="object"?null:(N=h&&N[h]||N["@@iterator"],typeof N=="function"?N:null)}var d={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},m=Object.assign,p={};function g(N,U,$){this.props=N,this.context=U,this.refs=p,this.updater=$||d}g.prototype.isReactComponent={},g.prototype.setState=function(N,U){if(typeof N!="object"&&typeof N!="function"&&N!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,N,U,"setState")},g.prototype.forceUpdate=function(N){this.updater.enqueueForceUpdate(this,N,"forceUpdate")};function y(){}y.prototype=g.prototype;function _(N,U,$){this.props=N,this.context=U,this.refs=p,this.updater=$||d}var A=_.prototype=new y;A.constructor=_,m(A,g.prototype),A.isPureReactComponent=!0;var T=Array.isArray,x={H:null,A:null,T:null,S:null,V:null},M=Object.prototype.hasOwnProperty;function R(N,U,$,X,q,J){return $=J.ref,{$$typeof:t,type:N,key:U,ref:$!==void 0?$:null,props:J}}function P(N,U){return R(N.type,U,void 0,void 0,void 0,N.props)}function W(N){return typeof N=="object"&&N!==null&&N.$$typeof===t}function F(N){var U={"=":"=0",":":"=2"};return"$"+N.replace(/[=:]/g,function($){return U[$]})}var G=/\/+/g;function O(N,U){return typeof N=="object"&&N!==null&&N.key!=null?F(""+N.key):U.toString(36)}function I(){}function k(N){switch(N.status){case"fulfilled":return N.value;case"rejected":throw N.reason;default:switch(typeof N.status=="string"?N.then(I,I):(N.status="pending",N.then(function(U){N.status==="pending"&&(N.status="fulfilled",N.value=U)},function(U){N.status==="pending"&&(N.status="rejected",N.reason=U)})),N.status){case"fulfilled":return N.value;case"rejected":throw N.reason}}throw N}function C(N,U,$,X,q){var J=typeof N;(J==="undefined"||J==="boolean")&&(N=null);var de=!1;if(N===null)de=!0;else switch(J){case"bigint":case"string":case"number":de=!0;break;case"object":switch(N.$$typeof){case t:case e:de=!0;break;case u:return de=N._init,C(de(N._payload),U,$,X,q)}}if(de)return q=q(N),de=X===""?"."+O(N,0):X,T(q)?($="",de!=null&&($=de.replace(G,"$&/")+"/"),C(q,U,$,"",function(xe){return xe})):q!=null&&(W(q)&&(q=P(q,$+(q.key==null||N&&N.key===q.key?"":(""+q.key).replace(G,"$&/")+"/")+de)),U.push(q)),1;de=0;var Ee=X===""?".":X+":";if(T(N))for(var ke=0;ke<N.length;ke++)X=N[ke],J=Ee+O(X,ke),de+=C(X,U,$,J,q);else if(ke=f(N),typeof ke=="function")for(N=ke.call(N),ke=0;!(X=N.next()).done;)X=X.value,J=Ee+O(X,ke++),de+=C(X,U,$,J,q);else if(J==="object"){if(typeof N.then=="function")return C(k(N),U,$,X,q);throw U=String(N),Error("Objects are not valid as a React child (found: "+(U==="[object Object]"?"object with keys {"+Object.keys(N).join(", ")+"}":U)+"). If you meant to render a collection of children, use an array instead.")}return de}function z(N,U,$){if(N==null)return N;var X=[],q=0;return C(N,X,"","",function(J){return U.call($,J,q++)}),X}function B(N){if(N._status===-1){var U=N._result;U=U(),U.then(function($){(N._status===0||N._status===-1)&&(N._status=1,N._result=$)},function($){(N._status===0||N._status===-1)&&(N._status=2,N._result=$)}),N._status===-1&&(N._status=0,N._result=U)}if(N._status===1)return N._result.default;throw N._result}var Q=typeof reportError=="function"?reportError:function(N){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var U=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof N=="object"&&N!==null&&typeof N.message=="string"?String(N.message):String(N),error:N});if(!window.dispatchEvent(U))return}else if(typeof Rn=="object"&&typeof Rn.emit=="function"){Rn.emit("uncaughtException",N);return}console.error(N)};function Y(){}return et.Children={map:z,forEach:function(N,U,$){z(N,function(){U.apply(this,arguments)},$)},count:function(N){var U=0;return z(N,function(){U++}),U},toArray:function(N){return z(N,function(U){return U})||[]},only:function(N){if(!W(N))throw Error("React.Children.only expected to receive a single React element child.");return N}},et.Component=g,et.Fragment=r,et.Profiler=i,et.PureComponent=_,et.StrictMode=n,et.Suspense=c,et.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=x,et.__COMPILER_RUNTIME={__proto__:null,c:function(N){return x.H.useMemoCache(N)}},et.cache=function(N){return function(){return N.apply(null,arguments)}},et.cloneElement=function(N,U,$){if(N==null)throw Error("The argument must be a React element, but you passed "+N+".");var X=m({},N.props),q=N.key,J=void 0;if(U!=null)for(de in U.ref!==void 0&&(J=void 0),U.key!==void 0&&(q=""+U.key),U)!M.call(U,de)||de==="key"||de==="__self"||de==="__source"||de==="ref"&&U.ref===void 0||(X[de]=U[de]);var de=arguments.length-2;if(de===1)X.children=$;else if(1<de){for(var Ee=Array(de),ke=0;ke<de;ke++)Ee[ke]=arguments[ke+2];X.children=Ee}return R(N.type,q,void 0,void 0,J,X)},et.createContext=function(N){return N={$$typeof:o,_currentValue:N,_currentValue2:N,_threadCount:0,Provider:null,Consumer:null},N.Provider=N,N.Consumer={$$typeof:s,_context:N},N},et.createElement=function(N,U,$){var X,q={},J=null;if(U!=null)for(X in U.key!==void 0&&(J=""+U.key),U)M.call(U,X)&&X!=="key"&&X!=="__self"&&X!=="__source"&&(q[X]=U[X]);var de=arguments.length-2;if(de===1)q.children=$;else if(1<de){for(var Ee=Array(de),ke=0;ke<de;ke++)Ee[ke]=arguments[ke+2];q.children=Ee}if(N&&N.defaultProps)for(X in de=N.defaultProps,de)q[X]===void 0&&(q[X]=de[X]);return R(N,J,void 0,void 0,null,q)},et.createRef=function(){return{current:null}},et.forwardRef=function(N){return{$$typeof:a,render:N}},et.isValidElement=W,et.lazy=function(N){return{$$typeof:u,_payload:{_status:-1,_result:N},_init:B}},et.memo=function(N,U){return{$$typeof:l,type:N,compare:U===void 0?null:U}},et.startTransition=function(N){var U=x.T,$={};x.T=$;try{var X=N(),q=x.S;q!==null&&q($,X),typeof X=="object"&&X!==null&&typeof X.then=="function"&&X.then(Y,Q)}catch(J){Q(J)}finally{x.T=U}},et.unstable_useCacheRefresh=function(){return x.H.useCacheRefresh()},et.use=function(N){return x.H.use(N)},et.useActionState=function(N,U,$){return x.H.useActionState(N,U,$)},et.useCallback=function(N,U){return x.H.useCallback(N,U)},et.useContext=function(N){return x.H.useContext(N)},et.useDebugValue=function(){},et.useDeferredValue=function(N,U){return x.H.useDeferredValue(N,U)},et.useEffect=function(N,U,$){var X=x.H;if(typeof $=="function")throw Error("useEffect CRUD overload is not enabled in this build of React.");return X.useEffect(N,U)},et.useId=function(){return x.H.useId()},et.useImperativeHandle=function(N,U,$){return x.H.useImperativeHandle(N,U,$)},et.useInsertionEffect=function(N,U){return x.H.useInsertionEffect(N,U)},et.useLayoutEffect=function(N,U){return x.H.useLayoutEffect(N,U)},et.useMemo=function(N,U){return x.H.useMemo(N,U)},et.useOptimistic=function(N,U){return x.H.useOptimistic(N,U)},et.useReducer=function(N,U,$){return x.H.useReducer(N,U,$)},et.useRef=function(N){return x.H.useRef(N)},et.useState=function(N){return x.H.useState(N)},et.useSyncExternalStore=function(N,U,$){return x.H.useSyncExternalStore(N,U,$)},et.useTransition=function(){return x.H.useTransition()},et.version="19.1.1",et}var Ag;function bO(){return Ag||(Ag=1,Vh.exports=_O()),Vh.exports}bO();/* Common package for dealing with hex/string/uint8 conversions (and sha1 hashing)
*
* @author   Jimmy Wärting <jimmy@warting.se> (https://jimmy.warting.se/opensource)
* @license  MIT
*/const Tg="0123456789abcdef",Sg=[],Mc=[];for(let t=0;t<256;t++)Sg[t]=Tg[t>>4&15]+Tg[t&15],t<16&&(t<10?Mc[48+t]=t:Mc[87+t]=t);const Rg=t=>{const e=t.length;let r="",n=0;for(;n<e;)r+=Sg[t[n++]];return r},Uc=t=>{const e=t.length>>1,r=e<<1,n=new Uint8Array(e);let i=0,s=0;for(;s<r;)n[i++]=Mc[t.charCodeAt(s++)]<<4|Mc[t.charCodeAt(s++)];return n};for(var Og="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",wO=typeof Uint8Array>"u"?[]:new Uint8Array(256),$c=0;$c<Og.length;$c++)wO[Og.charCodeAt($c)]=$c;new TextDecoder,new TextEncoder;const Ig=typeof window<"u"?window:self,Ng=Ig.crypto||Ig.msCrypto||{};Ng.subtle||Ng.webkitSubtle;const oo=globalThis||void 0||self,On=()=>new Map,Jh=t=>{const e=On();return t.forEach((r,n)=>{e.set(n,r)}),e},zi=(t,e,r)=>{let n=t.get(e);return n===void 0&&t.set(e,n=r()),n},kO=(t,e)=>{const r=[];for(const[n,i]of t)r.push(e(i,n));return r},vO=(t,e)=>{for(const[r,n]of t)if(e(n,r))return!0;return!1},ao=()=>new Set,Qh=t=>t[t.length-1],xO=(t,e)=>{for(let r=0;r<e.length;r++)t.push(e[r])},ys=Array.from,EO=Array.isArray;class AO{constructor(){this._observers=On()}on(e,r){return zi(this._observers,e,ao).add(r),r}once(e,r){const n=(...i)=>{this.off(e,n),r(...i)};this.on(e,n)}off(e,r){const n=this._observers.get(e);n!==void 0&&(n.delete(r),n.size===0&&this._observers.delete(e))}emit(e,r){return ys((this._observers.get(e)||On()).values()).forEach(n=>n(...r))}destroy(){this._observers=On()}}const Wi=Math.floor,Pc=Math.abs,Cg=(t,e)=>t<e?t:e,_s=(t,e)=>t>e?t:e,Lg=t=>t!==0?t<0:1/t<0,Mg=1,Ug=2,ef=4,tf=8,la=32,yi=64,Zr=128,Bc=31,rf=63,bs=127,TO=2147483647,$g=Number.MAX_SAFE_INTEGER,SO=Number.isInteger||(t=>typeof t=="number"&&isFinite(t)&&Wi(t)===t),RO=t=>t.toLowerCase(),OO=/^\s*/g,IO=t=>t.replace(OO,""),NO=/([A-Z])/g,Pg=(t,e)=>IO(t.replace(NO,r=>`${e}${RO(r)}`)),CO=t=>{const e=unescape(encodeURIComponent(t)),r=e.length,n=new Uint8Array(r);for(let i=0;i<r;i++)n[i]=e.codePointAt(i);return n},ua=typeof TextEncoder<"u"?new TextEncoder:null,LO=ua?t=>ua.encode(t):CO;let ha=typeof TextDecoder>"u"?null:new TextDecoder("utf-8",{fatal:!0,ignoreBOM:!0});ha&&ha.decode(new Uint8Array).length===1&&(ha=null);class fa{constructor(){this.cpos=0,this.cbuf=new Uint8Array(100),this.bufs=[]}}const Fc=()=>new fa,MO=t=>{let e=t.cpos;for(let r=0;r<t.bufs.length;r++)e+=t.bufs[r].length;return e},qn=t=>{const e=new Uint8Array(MO(t));let r=0;for(let n=0;n<t.bufs.length;n++){const i=t.bufs[n];e.set(i,r),r+=i.length}return e.set(new Uint8Array(t.cbuf.buffer,0,t.cpos),r),e},UO=(t,e)=>{const r=t.cbuf.length;r-t.cpos<e&&(t.bufs.push(new Uint8Array(t.cbuf.buffer,0,t.cpos)),t.cbuf=new Uint8Array(_s(r,e)*2),t.cpos=0)},or=(t,e)=>{const r=t.cbuf.length;t.cpos===r&&(t.bufs.push(t.cbuf),t.cbuf=new Uint8Array(r*2),t.cpos=0),t.cbuf[t.cpos++]=e},nf=or,ht=(t,e)=>{for(;e>bs;)or(t,Zr|bs&e),e=Wi(e/128);or(t,bs&e)},sf=(t,e)=>{const r=Lg(e);for(r&&(e=-e),or(t,(e>rf?Zr:0)|(r?yi:0)|rf&e),e=Wi(e/64);e>0;)or(t,(e>bs?Zr:0)|bs&e),e=Wi(e/128)},of=new Uint8Array(3e4),$O=of.length/3,PO=(t,e)=>{if(e.length<$O){const r=ua.encodeInto(e,of).written||0;ht(t,r);for(let n=0;n<r;n++)or(t,of[n])}else Jr(t,LO(e))},BO=(t,e)=>{const r=unescape(encodeURIComponent(e)),n=r.length;ht(t,n);for(let i=0;i<n;i++)or(t,r.codePointAt(i))},co=ua&&ua.encodeInto?PO:BO,Dc=(t,e)=>{const r=t.cbuf.length,n=t.cpos,i=Cg(r-n,e.length),s=e.length-i;t.cbuf.set(e.subarray(0,i),n),t.cpos+=i,s>0&&(t.bufs.push(t.cbuf),t.cbuf=new Uint8Array(_s(r*2,s)),t.cbuf.set(e.subarray(i)),t.cpos=s)},Jr=(t,e)=>{ht(t,e.byteLength),Dc(t,e)},af=(t,e)=>{UO(t,e);const r=new DataView(t.cbuf.buffer,t.cpos,e);return t.cpos+=e,r},FO=(t,e)=>af(t,4).setFloat32(0,e,!1),DO=(t,e)=>af(t,8).setFloat64(0,e,!1),jO=(t,e)=>af(t,8).setBigInt64(0,e,!1),Bg=new DataView(new ArrayBuffer(4)),zO=t=>(Bg.setFloat32(0,t),Bg.getFloat32(0)===t),da=(t,e)=>{switch(typeof e){case"string":or(t,119),co(t,e);break;case"number":SO(e)&&Pc(e)<=TO?(or(t,125),sf(t,e)):zO(e)?(or(t,124),FO(t,e)):(or(t,123),DO(t,e));break;case"bigint":or(t,122),jO(t,e);break;case"object":if(e===null)or(t,126);else if(EO(e)){or(t,117),ht(t,e.length);for(let r=0;r<e.length;r++)da(t,e[r])}else if(e instanceof Uint8Array)or(t,116),Jr(t,e);else{or(t,118);const r=Object.keys(e);ht(t,r.length);for(let n=0;n<r.length;n++){const i=r[n];co(t,i),da(t,e[i])}}break;case"boolean":or(t,e?120:121);break;default:or(t,127)}};class Fg extends fa{constructor(e){super(),this.w=e,this.s=null,this.count=0}write(e){this.s===e?this.count++:(this.count>0&&ht(this,this.count-1),this.count=1,this.w(this,e),this.s=e)}}const Dg=t=>{t.count>0&&(sf(t.encoder,t.count===1?t.s:-t.s),t.count>1&&ht(t.encoder,t.count-2))};class jc{constructor(){this.encoder=new fa,this.s=0,this.count=0}write(e){this.s===e?this.count++:(Dg(this),this.count=1,this.s=e)}toUint8Array(){return Dg(this),qn(this.encoder)}}const jg=t=>{if(t.count>0){const e=t.diff*2+(t.count===1?0:1);sf(t.encoder,e),t.count>1&&ht(t.encoder,t.count-2)}};class cf{constructor(){this.encoder=new fa,this.s=0,this.count=0,this.diff=0}write(e){this.diff===e-this.s?(this.s=e,this.count++):(jg(this),this.count=1,this.diff=e-this.s,this.s=e)}toUint8Array(){return jg(this),qn(this.encoder)}}class WO{constructor(){this.sarr=[],this.s="",this.lensE=new jc}write(e){this.s+=e,this.s.length>19&&(this.sarr.push(this.s),this.s=""),this.lensE.write(e.length)}toUint8Array(){const e=new fa;return this.sarr.push(this.s),this.s="",co(e,this.sarr.join("")),Dc(e,this.lensE.toUint8Array()),qn(e)}}const Hi=t=>new Error(t),Yn=()=>{throw Hi("Method unimplemented")},Vn=()=>{throw Hi("Unexpected case")},zg=Hi("Unexpected end of array"),Wg=Hi("Integer out of Range");class zc{constructor(e){this.arr=e,this.pos=0}}const lo=t=>new zc(t),HO=t=>t.pos!==t.arr.length,GO=(t,e)=>{const r=new Uint8Array(t.arr.buffer,t.pos+t.arr.byteOffset,e);return t.pos+=e,r},Qr=t=>GO(t,rt(t)),uo=t=>t.arr[t.pos++],rt=t=>{let e=0,r=1;const n=t.arr.length;for(;t.pos<n;){const i=t.arr[t.pos++];if(e=e+(i&bs)*r,r*=128,i<Zr)return e;if(e>$g)throw Wg}throw zg},lf=t=>{let e=t.arr[t.pos++],r=e&rf,n=64;const i=(e&yi)>0?-1:1;if((e&Zr)===0)return i*r;const s=t.arr.length;for(;t.pos<s;){if(e=t.arr[t.pos++],r=r+(e&bs)*n,n*=128,e<Zr)return i*r;if(r>$g)throw Wg}throw zg},ho=ha?t=>ha.decode(Qr(t)):t=>{let e=rt(t);if(e===0)return"";{let r=String.fromCodePoint(uo(t));if(--e<100)for(;e--;)r+=String.fromCodePoint(uo(t));else for(;e>0;){const n=e<1e4?e:1e4,i=t.arr.subarray(t.pos,t.pos+n);t.pos+=n,r+=String.fromCodePoint.apply(null,i),e-=n}return decodeURIComponent(escape(r))}},uf=(t,e)=>{const r=new DataView(t.arr.buffer,t.arr.byteOffset+t.pos,e);return t.pos+=e,r},KO=[t=>{},t=>null,lf,t=>uf(t,4).getFloat32(0,!1),t=>uf(t,8).getFloat64(0,!1),t=>uf(t,8).getBigInt64(0,!1),t=>!1,t=>!0,ho,t=>{const e=rt(t),r={};for(let n=0;n<e;n++){const i=ho(t);r[i]=pa(t)}return r},t=>{const e=rt(t),r=[];for(let n=0;n<e;n++)r.push(pa(t));return r},Qr],pa=t=>KO[127-uo(t)](t);class Hg extends zc{constructor(e,r){super(e),this.reader=r,this.s=null,this.count=0}read(){return this.count===0&&(this.s=this.reader(this),HO(this)?this.count=rt(this)+1:this.count=-1),this.count--,this.s}}class Wc extends zc{constructor(e){super(e),this.s=0,this.count=0}read(){if(this.count===0){this.s=lf(this);const e=Lg(this.s);this.count=1,e&&(this.s=-this.s,this.count=rt(this)+2)}return this.count--,this.s}}class hf extends zc{constructor(e){super(e),this.s=0,this.count=0,this.diff=0}read(){if(this.count===0){const e=lf(this),r=e&1;this.diff=Wi(e/2),this.count=1,r&&(this.count=rt(this)+2)}return this.s+=this.diff,this.count--,this.s}}class qO{constructor(e){this.decoder=new Wc(e),this.str=ho(this.decoder),this.spos=0}read(){const e=this.spos+this.decoder.read(),r=this.str.slice(this.spos,e);return this.spos=e,r}}const YO=crypto.getRandomValues.bind(crypto),Gg=()=>YO(new Uint32Array(1))[0],VO="10000000-1000-4000-8000"+-1e11,XO=()=>VO.replace(/[018]/g,t=>(t^Gg()&15>>t/4).toString(16)),Kg=t=>new Promise(t);Promise.all.bind(Promise);var qg={},Hc={};Hc.byteLength=QO,Hc.toByteArray=tI,Hc.fromByteArray=iI;for(var Xn=[],fn=[],ZO=typeof Uint8Array<"u"?Uint8Array:Array,ff="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",fo=0,JO=ff.length;fo<JO;++fo)Xn[fo]=ff[fo],fn[ff.charCodeAt(fo)]=fo;fn[45]=62,fn[95]=63;function Yg(t){var e=t.length;if(e%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var r=t.indexOf("=");r===-1&&(r=e);var n=r===e?0:4-r%4;return[r,n]}function QO(t){var e=Yg(t),r=e[0],n=e[1];return(r+n)*3/4-n}function eI(t,e,r){return(e+r)*3/4-r}function tI(t){var e,r=Yg(t),n=r[0],i=r[1],s=new ZO(eI(t,n,i)),o=0,a=i>0?n-4:n,c;for(c=0;c<a;c+=4)e=fn[t.charCodeAt(c)]<<18|fn[t.charCodeAt(c+1)]<<12|fn[t.charCodeAt(c+2)]<<6|fn[t.charCodeAt(c+3)],s[o++]=e>>16&255,s[o++]=e>>8&255,s[o++]=e&255;return i===2&&(e=fn[t.charCodeAt(c)]<<2|fn[t.charCodeAt(c+1)]>>4,s[o++]=e&255),i===1&&(e=fn[t.charCodeAt(c)]<<10|fn[t.charCodeAt(c+1)]<<4|fn[t.charCodeAt(c+2)]>>2,s[o++]=e>>8&255,s[o++]=e&255),s}function rI(t){return Xn[t>>18&63]+Xn[t>>12&63]+Xn[t>>6&63]+Xn[t&63]}function nI(t,e,r){for(var n,i=[],s=e;s<r;s+=3)n=(t[s]<<16&16711680)+(t[s+1]<<8&65280)+(t[s+2]&255),i.push(rI(n));return i.join("")}function iI(t){for(var e,r=t.length,n=r%3,i=[],s=16383,o=0,a=r-n;o<a;o+=s)i.push(nI(t,o,o+s>a?a:o+s));return n===1?(e=t[r-1],i.push(Xn[e>>2]+Xn[e<<4&63]+"==")):n===2&&(e=(t[r-2]<<8)+t[r-1],i.push(Xn[e>>10]+Xn[e>>4&63]+Xn[e<<2&63]+"=")),i.join("")}var df={};/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */df.read=function(t,e,r,n,i){var s,o,a=i*8-n-1,c=(1<<a)-1,l=c>>1,u=-7,h=r?i-1:0,f=r?-1:1,d=t[e+h];for(h+=f,s=d&(1<<-u)-1,d>>=-u,u+=a;u>0;s=s*256+t[e+h],h+=f,u-=8);for(o=s&(1<<-u)-1,s>>=-u,u+=n;u>0;o=o*256+t[e+h],h+=f,u-=8);if(s===0)s=1-l;else{if(s===c)return o?NaN:(d?-1:1)*(1/0);o=o+Math.pow(2,n),s=s-l}return(d?-1:1)*o*Math.pow(2,s-n)},df.write=function(t,e,r,n,i,s){var o,a,c,l=s*8-i-1,u=(1<<l)-1,h=u>>1,f=i===23?Math.pow(2,-24)-Math.pow(2,-77):0,d=n?0:s-1,m=n?1:-1,p=e<0||e===0&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(a=isNaN(e)?1:0,o=u):(o=Math.floor(Math.log(e)/Math.LN2),e*(c=Math.pow(2,-o))<1&&(o--,c*=2),o+h>=1?e+=f/c:e+=f*Math.pow(2,1-h),e*c>=2&&(o++,c/=2),o+h>=u?(a=0,o=u):o+h>=1?(a=(e*c-1)*Math.pow(2,i),o=o+h):(a=e*Math.pow(2,h-1)*Math.pow(2,i),o=0));i>=8;t[r+d]=a&255,d+=m,a/=256,i-=8);for(o=o<<i|a,l+=i;l>0;t[r+d]=o&255,d+=m,o/=256,l-=8);t[r+d-m]|=p*128};/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */(function(t){const e=Hc,r=df,n=typeof Symbol=="function"&&typeof Symbol.for=="function"?Symbol.for("nodejs.util.inspect.custom"):null;t.Buffer=u,t.SlowBuffer=x,t.INSPECT_MAX_BYTES=50;const i=2147483647;t.kMaxLength=i;const{Uint8Array:s,ArrayBuffer:o,SharedArrayBuffer:a}=globalThis;u.TYPED_ARRAY_SUPPORT=c(),!u.TYPED_ARRAY_SUPPORT&&typeof console<"u"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function c(){try{const L=new s(1),b={foo:function(){return 42}};return Object.setPrototypeOf(b,s.prototype),Object.setPrototypeOf(L,b),L.foo()===42}catch{return!1}}Object.defineProperty(u.prototype,"parent",{enumerable:!0,get:function(){if(u.isBuffer(this))return this.buffer}}),Object.defineProperty(u.prototype,"offset",{enumerable:!0,get:function(){if(u.isBuffer(this))return this.byteOffset}});function l(L){if(L>i)throw new RangeError('The value "'+L+'" is invalid for option "size"');const b=new s(L);return Object.setPrototypeOf(b,u.prototype),b}function u(L,b,v){if(typeof L=="number"){if(typeof b=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return m(L)}return h(L,b,v)}u.poolSize=8192;function h(L,b,v){if(typeof L=="string")return p(L,b);if(o.isView(L))return y(L);if(L==null)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof L);if(be(L,o)||L&&be(L.buffer,o)||typeof a<"u"&&(be(L,a)||L&&be(L.buffer,a)))return _(L,b,v);if(typeof L=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');const D=L.valueOf&&L.valueOf();if(D!=null&&D!==L)return u.from(D,b,v);const Z=A(L);if(Z)return Z;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof L[Symbol.toPrimitive]=="function")return u.from(L[Symbol.toPrimitive]("string"),b,v);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof L)}u.from=function(L,b,v){return h(L,b,v)},Object.setPrototypeOf(u.prototype,s.prototype),Object.setPrototypeOf(u,s);function f(L){if(typeof L!="number")throw new TypeError('"size" argument must be of type number');if(L<0)throw new RangeError('The value "'+L+'" is invalid for option "size"')}function d(L,b,v){return f(L),L<=0?l(L):b!==void 0?typeof v=="string"?l(L).fill(b,v):l(L).fill(b):l(L)}u.alloc=function(L,b,v){return d(L,b,v)};function m(L){return f(L),l(L<0?0:T(L)|0)}u.allocUnsafe=function(L){return m(L)},u.allocUnsafeSlow=function(L){return m(L)};function p(L,b){if((typeof b!="string"||b==="")&&(b="utf8"),!u.isEncoding(b))throw new TypeError("Unknown encoding: "+b);const v=M(L,b)|0;let D=l(v);const Z=D.write(L,b);return Z!==v&&(D=D.slice(0,Z)),D}function g(L){const b=L.length<0?0:T(L.length)|0,v=l(b);for(let D=0;D<b;D+=1)v[D]=L[D]&255;return v}function y(L){if(be(L,s)){const b=new s(L);return _(b.buffer,b.byteOffset,b.byteLength)}return g(L)}function _(L,b,v){if(b<0||L.byteLength<b)throw new RangeError('"offset" is outside of buffer bounds');if(L.byteLength<b+(v||0))throw new RangeError('"length" is outside of buffer bounds');let D;return b===void 0&&v===void 0?D=new s(L):v===void 0?D=new s(L,b):D=new s(L,b,v),Object.setPrototypeOf(D,u.prototype),D}function A(L){if(u.isBuffer(L)){const b=T(L.length)|0,v=l(b);return v.length===0||L.copy(v,0,0,b),v}if(L.length!==void 0)return typeof L.length!="number"||De(L.length)?l(0):g(L);if(L.type==="Buffer"&&Array.isArray(L.data))return g(L.data)}function T(L){if(L>=i)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+i.toString(16)+" bytes");return L|0}function x(L){return+L!=L&&(L=0),u.alloc(+L)}u.isBuffer=function(b){return b!=null&&b._isBuffer===!0&&b!==u.prototype},u.compare=function(b,v){if(be(b,s)&&(b=u.from(b,b.offset,b.byteLength)),be(v,s)&&(v=u.from(v,v.offset,v.byteLength)),!u.isBuffer(b)||!u.isBuffer(v))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(b===v)return 0;let D=b.length,Z=v.length;for(let le=0,H=Math.min(D,Z);le<H;++le)if(b[le]!==v[le]){D=b[le],Z=v[le];break}return D<Z?-1:Z<D?1:0},u.isEncoding=function(b){switch(String(b).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},u.concat=function(b,v){if(!Array.isArray(b))throw new TypeError('"list" argument must be an Array of Buffers');if(b.length===0)return u.alloc(0);let D;if(v===void 0)for(v=0,D=0;D<b.length;++D)v+=b[D].length;const Z=u.allocUnsafe(v);let le=0;for(D=0;D<b.length;++D){let H=b[D];if(be(H,s))le+H.length>Z.length?(u.isBuffer(H)||(H=u.from(H)),H.copy(Z,le)):s.prototype.set.call(Z,H,le);else if(u.isBuffer(H))H.copy(Z,le);else throw new TypeError('"list" argument must be an Array of Buffers');le+=H.length}return Z};function M(L,b){if(u.isBuffer(L))return L.length;if(o.isView(L)||be(L,o))return L.byteLength;if(typeof L!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof L);const v=L.length,D=arguments.length>2&&arguments[2]===!0;if(!D&&v===0)return 0;let Z=!1;for(;;)switch(b){case"ascii":case"latin1":case"binary":return v;case"utf8":case"utf-8":return pe(L).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return v*2;case"hex":return v>>>1;case"base64":return _e(L).length;default:if(Z)return D?-1:pe(L).length;b=(""+b).toLowerCase(),Z=!0}}u.byteLength=M;function R(L,b,v){let D=!1;if((b===void 0||b<0)&&(b=0),b>this.length||((v===void 0||v>this.length)&&(v=this.length),v<=0)||(v>>>=0,b>>>=0,v<=b))return"";for(L||(L="utf8");;)switch(L){case"hex":return $(this,b,v);case"utf8":case"utf-8":return B(this,b,v);case"ascii":return N(this,b,v);case"latin1":case"binary":return U(this,b,v);case"base64":return z(this,b,v);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return X(this,b,v);default:if(D)throw new TypeError("Unknown encoding: "+L);L=(L+"").toLowerCase(),D=!0}}u.prototype._isBuffer=!0;function P(L,b,v){const D=L[b];L[b]=L[v],L[v]=D}u.prototype.swap16=function(){const b=this.length;if(b%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let v=0;v<b;v+=2)P(this,v,v+1);return this},u.prototype.swap32=function(){const b=this.length;if(b%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let v=0;v<b;v+=4)P(this,v,v+3),P(this,v+1,v+2);return this},u.prototype.swap64=function(){const b=this.length;if(b%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let v=0;v<b;v+=8)P(this,v,v+7),P(this,v+1,v+6),P(this,v+2,v+5),P(this,v+3,v+4);return this},u.prototype.toString=function(){const b=this.length;return b===0?"":arguments.length===0?B(this,0,b):R.apply(this,arguments)},u.prototype.toLocaleString=u.prototype.toString,u.prototype.equals=function(b){if(!u.isBuffer(b))throw new TypeError("Argument must be a Buffer");return this===b?!0:u.compare(this,b)===0},u.prototype.inspect=function(){let b="";const v=t.INSPECT_MAX_BYTES;return b=this.toString("hex",0,v).replace(/(.{2})/g,"$1 ").trim(),this.length>v&&(b+=" ... "),"<Buffer "+b+">"},n&&(u.prototype[n]=u.prototype.inspect),u.prototype.compare=function(b,v,D,Z,le){if(be(b,s)&&(b=u.from(b,b.offset,b.byteLength)),!u.isBuffer(b))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof b);if(v===void 0&&(v=0),D===void 0&&(D=b?b.length:0),Z===void 0&&(Z=0),le===void 0&&(le=this.length),v<0||D>b.length||Z<0||le>this.length)throw new RangeError("out of range index");if(Z>=le&&v>=D)return 0;if(Z>=le)return-1;if(v>=D)return 1;if(v>>>=0,D>>>=0,Z>>>=0,le>>>=0,this===b)return 0;let H=le-Z,re=D-v;const ze=Math.min(H,re),Ge=this.slice(Z,le),qe=b.slice(v,D);for(let Le=0;Le<ze;++Le)if(Ge[Le]!==qe[Le]){H=Ge[Le],re=qe[Le];break}return H<re?-1:re<H?1:0};function W(L,b,v,D,Z){if(L.length===0)return-1;if(typeof v=="string"?(D=v,v=0):v>2147483647?v=2147483647:v<-2147483648&&(v=-2147483648),v=+v,De(v)&&(v=Z?0:L.length-1),v<0&&(v=L.length+v),v>=L.length){if(Z)return-1;v=L.length-1}else if(v<0)if(Z)v=0;else return-1;if(typeof b=="string"&&(b=u.from(b,D)),u.isBuffer(b))return b.length===0?-1:F(L,b,v,D,Z);if(typeof b=="number")return b=b&255,typeof s.prototype.indexOf=="function"?Z?s.prototype.indexOf.call(L,b,v):s.prototype.lastIndexOf.call(L,b,v):F(L,[b],v,D,Z);throw new TypeError("val must be string, number or Buffer")}function F(L,b,v,D,Z){let le=1,H=L.length,re=b.length;if(D!==void 0&&(D=String(D).toLowerCase(),D==="ucs2"||D==="ucs-2"||D==="utf16le"||D==="utf-16le")){if(L.length<2||b.length<2)return-1;le=2,H/=2,re/=2,v/=2}function ze(qe,Le){return le===1?qe[Le]:qe.readUInt16BE(Le*le)}let Ge;if(Z){let qe=-1;for(Ge=v;Ge<H;Ge++)if(ze(L,Ge)===ze(b,qe===-1?0:Ge-qe)){if(qe===-1&&(qe=Ge),Ge-qe+1===re)return qe*le}else qe!==-1&&(Ge-=Ge-qe),qe=-1}else for(v+re>H&&(v=H-re),Ge=v;Ge>=0;Ge--){let qe=!0;for(let Le=0;Le<re;Le++)if(ze(L,Ge+Le)!==ze(b,Le)){qe=!1;break}if(qe)return Ge}return-1}u.prototype.includes=function(b,v,D){return this.indexOf(b,v,D)!==-1},u.prototype.indexOf=function(b,v,D){return W(this,b,v,D,!0)},u.prototype.lastIndexOf=function(b,v,D){return W(this,b,v,D,!1)};function G(L,b,v,D){v=Number(v)||0;const Z=L.length-v;D?(D=Number(D),D>Z&&(D=Z)):D=Z;const le=b.length;D>le/2&&(D=le/2);let H;for(H=0;H<D;++H){const re=parseInt(b.substr(H*2,2),16);if(De(re))return H;L[v+H]=re}return H}function O(L,b,v,D){return Oe(pe(b,L.length-v),L,v,D)}function I(L,b,v,D){return Oe(me(b),L,v,D)}function k(L,b,v,D){return Oe(_e(b),L,v,D)}function C(L,b,v,D){return Oe(se(b,L.length-v),L,v,D)}u.prototype.write=function(b,v,D,Z){if(v===void 0)Z="utf8",D=this.length,v=0;else if(D===void 0&&typeof v=="string")Z=v,D=this.length,v=0;else if(isFinite(v))v=v>>>0,isFinite(D)?(D=D>>>0,Z===void 0&&(Z="utf8")):(Z=D,D=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");const le=this.length-v;if((D===void 0||D>le)&&(D=le),b.length>0&&(D<0||v<0)||v>this.length)throw new RangeError("Attempt to write outside buffer bounds");Z||(Z="utf8");let H=!1;for(;;)switch(Z){case"hex":return G(this,b,v,D);case"utf8":case"utf-8":return O(this,b,v,D);case"ascii":case"latin1":case"binary":return I(this,b,v,D);case"base64":return k(this,b,v,D);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return C(this,b,v,D);default:if(H)throw new TypeError("Unknown encoding: "+Z);Z=(""+Z).toLowerCase(),H=!0}},u.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function z(L,b,v){return b===0&&v===L.length?e.fromByteArray(L):e.fromByteArray(L.slice(b,v))}function B(L,b,v){v=Math.min(L.length,v);const D=[];let Z=b;for(;Z<v;){const le=L[Z];let H=null,re=le>239?4:le>223?3:le>191?2:1;if(Z+re<=v){let ze,Ge,qe,Le;switch(re){case 1:le<128&&(H=le);break;case 2:ze=L[Z+1],(ze&192)===128&&(Le=(le&31)<<6|ze&63,Le>127&&(H=Le));break;case 3:ze=L[Z+1],Ge=L[Z+2],(ze&192)===128&&(Ge&192)===128&&(Le=(le&15)<<12|(ze&63)<<6|Ge&63,Le>2047&&(Le<55296||Le>57343)&&(H=Le));break;case 4:ze=L[Z+1],Ge=L[Z+2],qe=L[Z+3],(ze&192)===128&&(Ge&192)===128&&(qe&192)===128&&(Le=(le&15)<<18|(ze&63)<<12|(Ge&63)<<6|qe&63,Le>65535&&Le<1114112&&(H=Le))}}H===null?(H=65533,re=1):H>65535&&(H-=65536,D.push(H>>>10&1023|55296),H=56320|H&1023),D.push(H),Z+=re}return Y(D)}const Q=4096;function Y(L){const b=L.length;if(b<=Q)return String.fromCharCode.apply(String,L);let v="",D=0;for(;D<b;)v+=String.fromCharCode.apply(String,L.slice(D,D+=Q));return v}function N(L,b,v){let D="";v=Math.min(L.length,v);for(let Z=b;Z<v;++Z)D+=String.fromCharCode(L[Z]&127);return D}function U(L,b,v){let D="";v=Math.min(L.length,v);for(let Z=b;Z<v;++Z)D+=String.fromCharCode(L[Z]);return D}function $(L,b,v){const D=L.length;(!b||b<0)&&(b=0),(!v||v<0||v>D)&&(v=D);let Z="";for(let le=b;le<v;++le)Z+=gt[L[le]];return Z}function X(L,b,v){const D=L.slice(b,v);let Z="";for(let le=0;le<D.length-1;le+=2)Z+=String.fromCharCode(D[le]+D[le+1]*256);return Z}u.prototype.slice=function(b,v){const D=this.length;b=~~b,v=v===void 0?D:~~v,b<0?(b+=D,b<0&&(b=0)):b>D&&(b=D),v<0?(v+=D,v<0&&(v=0)):v>D&&(v=D),v<b&&(v=b);const Z=this.subarray(b,v);return Object.setPrototypeOf(Z,u.prototype),Z};function q(L,b,v){if(L%1!==0||L<0)throw new RangeError("offset is not uint");if(L+b>v)throw new RangeError("Trying to access beyond buffer length")}u.prototype.readUintLE=u.prototype.readUIntLE=function(b,v,D){b=b>>>0,v=v>>>0,D||q(b,v,this.length);let Z=this[b],le=1,H=0;for(;++H<v&&(le*=256);)Z+=this[b+H]*le;return Z},u.prototype.readUintBE=u.prototype.readUIntBE=function(b,v,D){b=b>>>0,v=v>>>0,D||q(b,v,this.length);let Z=this[b+--v],le=1;for(;v>0&&(le*=256);)Z+=this[b+--v]*le;return Z},u.prototype.readUint8=u.prototype.readUInt8=function(b,v){return b=b>>>0,v||q(b,1,this.length),this[b]},u.prototype.readUint16LE=u.prototype.readUInt16LE=function(b,v){return b=b>>>0,v||q(b,2,this.length),this[b]|this[b+1]<<8},u.prototype.readUint16BE=u.prototype.readUInt16BE=function(b,v){return b=b>>>0,v||q(b,2,this.length),this[b]<<8|this[b+1]},u.prototype.readUint32LE=u.prototype.readUInt32LE=function(b,v){return b=b>>>0,v||q(b,4,this.length),(this[b]|this[b+1]<<8|this[b+2]<<16)+this[b+3]*16777216},u.prototype.readUint32BE=u.prototype.readUInt32BE=function(b,v){return b=b>>>0,v||q(b,4,this.length),this[b]*16777216+(this[b+1]<<16|this[b+2]<<8|this[b+3])},u.prototype.readBigUInt64LE=Ze(function(b){b=b>>>0,ie(b,"offset");const v=this[b],D=this[b+7];(v===void 0||D===void 0)&&K(b,this.length-8);const Z=v+this[++b]*2**8+this[++b]*2**16+this[++b]*2**24,le=this[++b]+this[++b]*2**8+this[++b]*2**16+D*2**24;return BigInt(Z)+(BigInt(le)<<BigInt(32))}),u.prototype.readBigUInt64BE=Ze(function(b){b=b>>>0,ie(b,"offset");const v=this[b],D=this[b+7];(v===void 0||D===void 0)&&K(b,this.length-8);const Z=v*2**24+this[++b]*2**16+this[++b]*2**8+this[++b],le=this[++b]*2**24+this[++b]*2**16+this[++b]*2**8+D;return(BigInt(Z)<<BigInt(32))+BigInt(le)}),u.prototype.readIntLE=function(b,v,D){b=b>>>0,v=v>>>0,D||q(b,v,this.length);let Z=this[b],le=1,H=0;for(;++H<v&&(le*=256);)Z+=this[b+H]*le;return le*=128,Z>=le&&(Z-=Math.pow(2,8*v)),Z},u.prototype.readIntBE=function(b,v,D){b=b>>>0,v=v>>>0,D||q(b,v,this.length);let Z=v,le=1,H=this[b+--Z];for(;Z>0&&(le*=256);)H+=this[b+--Z]*le;return le*=128,H>=le&&(H-=Math.pow(2,8*v)),H},u.prototype.readInt8=function(b,v){return b=b>>>0,v||q(b,1,this.length),this[b]&128?(255-this[b]+1)*-1:this[b]},u.prototype.readInt16LE=function(b,v){b=b>>>0,v||q(b,2,this.length);const D=this[b]|this[b+1]<<8;return D&32768?D|4294901760:D},u.prototype.readInt16BE=function(b,v){b=b>>>0,v||q(b,2,this.length);const D=this[b+1]|this[b]<<8;return D&32768?D|4294901760:D},u.prototype.readInt32LE=function(b,v){return b=b>>>0,v||q(b,4,this.length),this[b]|this[b+1]<<8|this[b+2]<<16|this[b+3]<<24},u.prototype.readInt32BE=function(b,v){return b=b>>>0,v||q(b,4,this.length),this[b]<<24|this[b+1]<<16|this[b+2]<<8|this[b+3]},u.prototype.readBigInt64LE=Ze(function(b){b=b>>>0,ie(b,"offset");const v=this[b],D=this[b+7];(v===void 0||D===void 0)&&K(b,this.length-8);const Z=this[b+4]+this[b+5]*2**8+this[b+6]*2**16+(D<<24);return(BigInt(Z)<<BigInt(32))+BigInt(v+this[++b]*2**8+this[++b]*2**16+this[++b]*2**24)}),u.prototype.readBigInt64BE=Ze(function(b){b=b>>>0,ie(b,"offset");const v=this[b],D=this[b+7];(v===void 0||D===void 0)&&K(b,this.length-8);const Z=(v<<24)+this[++b]*2**16+this[++b]*2**8+this[++b];return(BigInt(Z)<<BigInt(32))+BigInt(this[++b]*2**24+this[++b]*2**16+this[++b]*2**8+D)}),u.prototype.readFloatLE=function(b,v){return b=b>>>0,v||q(b,4,this.length),r.read(this,b,!0,23,4)},u.prototype.readFloatBE=function(b,v){return b=b>>>0,v||q(b,4,this.length),r.read(this,b,!1,23,4)},u.prototype.readDoubleLE=function(b,v){return b=b>>>0,v||q(b,8,this.length),r.read(this,b,!0,52,8)},u.prototype.readDoubleBE=function(b,v){return b=b>>>0,v||q(b,8,this.length),r.read(this,b,!1,52,8)};function J(L,b,v,D,Z,le){if(!u.isBuffer(L))throw new TypeError('"buffer" argument must be a Buffer instance');if(b>Z||b<le)throw new RangeError('"value" argument is out of bounds');if(v+D>L.length)throw new RangeError("Index out of range")}u.prototype.writeUintLE=u.prototype.writeUIntLE=function(b,v,D,Z){if(b=+b,v=v>>>0,D=D>>>0,!Z){const re=Math.pow(2,8*D)-1;J(this,b,v,D,re,0)}let le=1,H=0;for(this[v]=b&255;++H<D&&(le*=256);)this[v+H]=b/le&255;return v+D},u.prototype.writeUintBE=u.prototype.writeUIntBE=function(b,v,D,Z){if(b=+b,v=v>>>0,D=D>>>0,!Z){const re=Math.pow(2,8*D)-1;J(this,b,v,D,re,0)}let le=D-1,H=1;for(this[v+le]=b&255;--le>=0&&(H*=256);)this[v+le]=b/H&255;return v+D},u.prototype.writeUint8=u.prototype.writeUInt8=function(b,v,D){return b=+b,v=v>>>0,D||J(this,b,v,1,255,0),this[v]=b&255,v+1},u.prototype.writeUint16LE=u.prototype.writeUInt16LE=function(b,v,D){return b=+b,v=v>>>0,D||J(this,b,v,2,65535,0),this[v]=b&255,this[v+1]=b>>>8,v+2},u.prototype.writeUint16BE=u.prototype.writeUInt16BE=function(b,v,D){return b=+b,v=v>>>0,D||J(this,b,v,2,65535,0),this[v]=b>>>8,this[v+1]=b&255,v+2},u.prototype.writeUint32LE=u.prototype.writeUInt32LE=function(b,v,D){return b=+b,v=v>>>0,D||J(this,b,v,4,4294967295,0),this[v+3]=b>>>24,this[v+2]=b>>>16,this[v+1]=b>>>8,this[v]=b&255,v+4},u.prototype.writeUint32BE=u.prototype.writeUInt32BE=function(b,v,D){return b=+b,v=v>>>0,D||J(this,b,v,4,4294967295,0),this[v]=b>>>24,this[v+1]=b>>>16,this[v+2]=b>>>8,this[v+3]=b&255,v+4};function de(L,b,v,D,Z){he(b,D,Z,L,v,7);let le=Number(b&BigInt(4294967295));L[v++]=le,le=le>>8,L[v++]=le,le=le>>8,L[v++]=le,le=le>>8,L[v++]=le;let H=Number(b>>BigInt(32)&BigInt(4294967295));return L[v++]=H,H=H>>8,L[v++]=H,H=H>>8,L[v++]=H,H=H>>8,L[v++]=H,v}function Ee(L,b,v,D,Z){he(b,D,Z,L,v,7);let le=Number(b&BigInt(4294967295));L[v+7]=le,le=le>>8,L[v+6]=le,le=le>>8,L[v+5]=le,le=le>>8,L[v+4]=le;let H=Number(b>>BigInt(32)&BigInt(4294967295));return L[v+3]=H,H=H>>8,L[v+2]=H,H=H>>8,L[v+1]=H,H=H>>8,L[v]=H,v+8}u.prototype.writeBigUInt64LE=Ze(function(b,v=0){return de(this,b,v,BigInt(0),BigInt("0xffffffffffffffff"))}),u.prototype.writeBigUInt64BE=Ze(function(b,v=0){return Ee(this,b,v,BigInt(0),BigInt("0xffffffffffffffff"))}),u.prototype.writeIntLE=function(b,v,D,Z){if(b=+b,v=v>>>0,!Z){const ze=Math.pow(2,8*D-1);J(this,b,v,D,ze-1,-ze)}let le=0,H=1,re=0;for(this[v]=b&255;++le<D&&(H*=256);)b<0&&re===0&&this[v+le-1]!==0&&(re=1),this[v+le]=(b/H>>0)-re&255;return v+D},u.prototype.writeIntBE=function(b,v,D,Z){if(b=+b,v=v>>>0,!Z){const ze=Math.pow(2,8*D-1);J(this,b,v,D,ze-1,-ze)}let le=D-1,H=1,re=0;for(this[v+le]=b&255;--le>=0&&(H*=256);)b<0&&re===0&&this[v+le+1]!==0&&(re=1),this[v+le]=(b/H>>0)-re&255;return v+D},u.prototype.writeInt8=function(b,v,D){return b=+b,v=v>>>0,D||J(this,b,v,1,127,-128),b<0&&(b=255+b+1),this[v]=b&255,v+1},u.prototype.writeInt16LE=function(b,v,D){return b=+b,v=v>>>0,D||J(this,b,v,2,32767,-32768),this[v]=b&255,this[v+1]=b>>>8,v+2},u.prototype.writeInt16BE=function(b,v,D){return b=+b,v=v>>>0,D||J(this,b,v,2,32767,-32768),this[v]=b>>>8,this[v+1]=b&255,v+2},u.prototype.writeInt32LE=function(b,v,D){return b=+b,v=v>>>0,D||J(this,b,v,4,2147483647,-2147483648),this[v]=b&255,this[v+1]=b>>>8,this[v+2]=b>>>16,this[v+3]=b>>>24,v+4},u.prototype.writeInt32BE=function(b,v,D){return b=+b,v=v>>>0,D||J(this,b,v,4,2147483647,-2147483648),b<0&&(b=4294967295+b+1),this[v]=b>>>24,this[v+1]=b>>>16,this[v+2]=b>>>8,this[v+3]=b&255,v+4},u.prototype.writeBigInt64LE=Ze(function(b,v=0){return de(this,b,v,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))}),u.prototype.writeBigInt64BE=Ze(function(b,v=0){return Ee(this,b,v,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))});function ke(L,b,v,D,Z,le){if(v+D>L.length)throw new RangeError("Index out of range");if(v<0)throw new RangeError("Index out of range")}function xe(L,b,v,D,Z){return b=+b,v=v>>>0,Z||ke(L,b,v,4),r.write(L,b,v,D,23,4),v+4}u.prototype.writeFloatLE=function(b,v,D){return xe(this,b,v,!0,D)},u.prototype.writeFloatBE=function(b,v,D){return xe(this,b,v,!1,D)};function Te(L,b,v,D,Z){return b=+b,v=v>>>0,Z||ke(L,b,v,8),r.write(L,b,v,D,52,8),v+8}u.prototype.writeDoubleLE=function(b,v,D){return Te(this,b,v,!0,D)},u.prototype.writeDoubleBE=function(b,v,D){return Te(this,b,v,!1,D)},u.prototype.copy=function(b,v,D,Z){if(!u.isBuffer(b))throw new TypeError("argument should be a Buffer");if(D||(D=0),!Z&&Z!==0&&(Z=this.length),v>=b.length&&(v=b.length),v||(v=0),Z>0&&Z<D&&(Z=D),Z===D||b.length===0||this.length===0)return 0;if(v<0)throw new RangeError("targetStart out of bounds");if(D<0||D>=this.length)throw new RangeError("Index out of range");if(Z<0)throw new RangeError("sourceEnd out of bounds");Z>this.length&&(Z=this.length),b.length-v<Z-D&&(Z=b.length-v+D);const le=Z-D;return this===b&&typeof s.prototype.copyWithin=="function"?this.copyWithin(v,D,Z):s.prototype.set.call(b,this.subarray(D,Z),v),le},u.prototype.fill=function(b,v,D,Z){if(typeof b=="string"){if(typeof v=="string"?(Z=v,v=0,D=this.length):typeof D=="string"&&(Z=D,D=this.length),Z!==void 0&&typeof Z!="string")throw new TypeError("encoding must be a string");if(typeof Z=="string"&&!u.isEncoding(Z))throw new TypeError("Unknown encoding: "+Z);if(b.length===1){const H=b.charCodeAt(0);(Z==="utf8"&&H<128||Z==="latin1")&&(b=H)}}else typeof b=="number"?b=b&255:typeof b=="boolean"&&(b=Number(b));if(v<0||this.length<v||this.length<D)throw new RangeError("Out of range index");if(D<=v)return this;v=v>>>0,D=D===void 0?this.length:D>>>0,b||(b=0);let le;if(typeof b=="number")for(le=v;le<D;++le)this[le]=b;else{const H=u.isBuffer(b)?b:u.from(b,Z),re=H.length;if(re===0)throw new TypeError('The value "'+b+'" is invalid for argument "value"');for(le=0;le<D-v;++le)this[le+v]=H[le%re]}return this};const Se={};function Me(L,b,v){Se[L]=class extends v{constructor(){super(),Object.defineProperty(this,"message",{value:b.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${L}]`,this.stack,delete this.name}get code(){return L}set code(Z){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:Z,writable:!0})}toString(){return`${this.name} [${L}]: ${this.message}`}}}Me("ERR_BUFFER_OUT_OF_BOUNDS",function(L){return L?`${L} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"},RangeError),Me("ERR_INVALID_ARG_TYPE",function(L,b){return`The "${L}" argument must be of type number. Received type ${typeof b}`},TypeError),Me("ERR_OUT_OF_RANGE",function(L,b,v){let D=`The value of "${L}" is out of range.`,Z=v;return Number.isInteger(v)&&Math.abs(v)>2**32?Z=je(String(v)):typeof v=="bigint"&&(Z=String(v),(v>BigInt(2)**BigInt(32)||v<-(BigInt(2)**BigInt(32)))&&(Z=je(Z)),Z+="n"),D+=` It must be ${b}. Received ${Z}`,D},RangeError);function je(L){let b="",v=L.length;const D=L[0]==="-"?1:0;for(;v>=D+4;v-=3)b=`_${L.slice(v-3,v)}${b}`;return`${L.slice(0,v)}${b}`}function S(L,b,v){ie(b,"offset"),(L[b]===void 0||L[b+v]===void 0)&&K(b,L.length-(v+1))}function he(L,b,v,D,Z,le){if(L>v||L<b){const H=typeof b=="bigint"?"n":"";let re;throw b===0||b===BigInt(0)?re=`>= 0${H} and < 2${H} ** ${(le+1)*8}${H}`:re=`>= -(2${H} ** ${(le+1)*8-1}${H}) and < 2 ** ${(le+1)*8-1}${H}`,new Se.ERR_OUT_OF_RANGE("value",re,L)}S(D,Z,le)}function ie(L,b){if(typeof L!="number")throw new Se.ERR_INVALID_ARG_TYPE(b,"number",L)}function K(L,b,v){throw Math.floor(L)!==L?(ie(L,v),new Se.ERR_OUT_OF_RANGE("offset","an integer",L)):b<0?new Se.ERR_BUFFER_OUT_OF_BOUNDS:new Se.ERR_OUT_OF_RANGE("offset",`>= 0 and <= ${b}`,L)}const j=/[^+/0-9A-Za-z-_]/g;function ee(L){if(L=L.split("=")[0],L=L.trim().replace(j,""),L.length<2)return"";for(;L.length%4!==0;)L=L+"=";return L}function pe(L,b){b=b||1/0;let v;const D=L.length;let Z=null;const le=[];for(let H=0;H<D;++H){if(v=L.charCodeAt(H),v>55295&&v<57344){if(!Z){if(v>56319){(b-=3)>-1&&le.push(239,191,189);continue}else if(H+1===D){(b-=3)>-1&&le.push(239,191,189);continue}Z=v;continue}if(v<56320){(b-=3)>-1&&le.push(239,191,189),Z=v;continue}v=(Z-55296<<10|v-56320)+65536}else Z&&(b-=3)>-1&&le.push(239,191,189);if(Z=null,v<128){if((b-=1)<0)break;le.push(v)}else if(v<2048){if((b-=2)<0)break;le.push(v>>6|192,v&63|128)}else if(v<65536){if((b-=3)<0)break;le.push(v>>12|224,v>>6&63|128,v&63|128)}else if(v<1114112){if((b-=4)<0)break;le.push(v>>18|240,v>>12&63|128,v>>6&63|128,v&63|128)}else throw new Error("Invalid code point")}return le}function me(L){const b=[];for(let v=0;v<L.length;++v)b.push(L.charCodeAt(v)&255);return b}function se(L,b){let v,D,Z;const le=[];for(let H=0;H<L.length&&!((b-=2)<0);++H)v=L.charCodeAt(H),D=v>>8,Z=v%256,le.push(Z),le.push(D);return le}function _e(L){return e.toByteArray(ee(L))}function Oe(L,b,v,D){let Z;for(Z=0;Z<D&&!(Z+v>=b.length||Z>=L.length);++Z)b[Z+v]=L[Z];return Z}function be(L,b){return L instanceof b||L!=null&&L.constructor!=null&&L.constructor.name!=null&&L.constructor.name===b.name}function De(L){return L!==L}const gt=(function(){const L="0123456789abcdef",b=new Array(256);for(let v=0;v<16;++v){const D=v*16;for(let Z=0;Z<16;++Z)b[D+Z]=L[v]+L[Z]}return b})();function Ze(L){return typeof BigInt>"u"?Jt:L}function Jt(){throw new Error("BigInt not supported")}})(qg);const Qt=qg.Buffer,Vg=t=>t===void 0?null:t;class sI{constructor(){this.map=new Map}setItem(e,r){this.map.set(e,r)}getItem(e){return this.map.get(e)}}let Xg=new sI,oI=!0;try{typeof localStorage<"u"&&localStorage&&(Xg=localStorage,oI=!1)}catch{}const aI=Xg,cI=Object.assign,lI=Object.keys,uI=(t,e)=>{for(const r in t)e(t[r],r)},Zg=t=>lI(t).length,hI=t=>{for(const e in t)return!1;return!0},fI=(t,e)=>{for(const r in t)if(!e(t[r],r))return!1;return!0},dI=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),pI=(t,e)=>t===e||Zg(t)===Zg(e)&&fI(t,(r,n)=>(r!==void 0||dI(e,n))&&e[n]===r),mI=Object.freeze,Jg=t=>{for(const e in t){const r=t[e];(typeof r=="object"||typeof r=="function")&&Jg(t[e])}return mI(t)},pf=(t,e,r=0)=>{try{for(;r<t.length;r++)t[r](...e)}finally{r<t.length&&pf(t,e,r+1)}},gI=t=>t,yI=(t,e)=>e.includes(t);var Qg={};const ma=typeof Rn<"u"&&Rn.release&&/node|io\.js/.test(Rn.release.name)&&Object.prototype.toString.call(typeof Rn<"u"?Rn:0)==="[object process]";let Zn;const _I=()=>{if(Zn===void 0)if(ma){Zn=On();const t=Rn.argv;let e=null;for(let r=0;r<t.length;r++){const n=t[r];n[0]==="-"?(e!==null&&Zn.set(e,""),e=n):e!==null&&(Zn.set(e,n),e=null)}e!==null&&Zn.set(e,"")}else typeof location=="object"?(Zn=On(),(location.search||"?").slice(1).split("&").forEach(t=>{if(t.length!==0){const[e,r]=t.split("=");Zn.set(`--${Pg(e,"-")}`,r),Zn.set(`-${Pg(e,"-")}`,r)}})):Zn=On();return Zn},mf=t=>_I().has(t),Gc=t=>Vg(ma?Qg[t.toUpperCase().replaceAll("-","_")]:aI.getItem(t)),ey=t=>mf("--"+t)||Gc(t)!==null;ey("production");const bI=ma&&yI(Qg.FORCE_COLOR,["true","1","2"])||!mf("--no-colors")&&!ey("no-color")&&(!ma||Rn.stdout.isTTY)&&(!ma||mf("--color")||Gc("COLORTERM")!==null||(Gc("TERM")||"").includes("color")),wI=t=>new Uint8Array(t),kI=t=>{const e=wI(t.byteLength);return e.set(t),e};class vI{constructor(e,r){this.left=e,this.right=r}}const _i=(t,e)=>new vI(t,e);typeof DOMParser<"u"&&new DOMParser;const xI=t=>kO(t,(e,r)=>`${r}:${e};`).join(""),bi=Symbol,ty=bi(),ry=bi(),EI=bi(),AI=bi(),TI=bi(),ny=bi(),SI=bi(),gf=bi(),RI=bi(),OI=t=>{t.length===1&&t[0]?.constructor===Function&&(t=t[0]());const e=[],r=[];let n=0;for(;n<t.length;n++){const i=t[n];if(i===void 0)break;if(i.constructor===String||i.constructor===Number)e.push(i);else if(i.constructor===Object)break}for(n>0&&r.push(e.join(""));n<t.length;n++){const i=t[n];i instanceof Symbol||r.push(i)}return r},II={[ty]:_i("font-weight","bold"),[ry]:_i("font-weight","normal"),[EI]:_i("color","blue"),[TI]:_i("color","green"),[AI]:_i("color","grey"),[ny]:_i("color","red"),[SI]:_i("color","purple"),[gf]:_i("color","orange"),[RI]:_i("color","black")},iy=bI?t=>{t.length===1&&t[0]?.constructor===Function&&(t=t[0]());const e=[],r=[],n=On();let i=[],s=0;for(;s<t.length;s++){const o=t[s],a=II[o];if(a!==void 0)n.set(a.left,a.right);else{if(o===void 0)break;if(o.constructor===String||o.constructor===Number){const c=xI(n);s>0||c.length>0?(e.push("%c"+o),r.push(c)):e.push(o)}else break}}for(s>0&&(i=r,i.unshift(e.join("")));s<t.length;s++){const o=t[s];o instanceof Symbol||i.push(o)}return i}:OI,NI=(...t)=>{console.log(...iy(t)),sy.forEach(e=>e.print(t))},CI=(...t)=>{console.warn(...iy(t)),t.unshift(gf),sy.forEach(e=>e.print(t))},sy=ao(),oy=t=>({[Symbol.iterator](){return this},next:t}),LI=(t,e)=>oy(()=>{let r;do r=t.next();while(!r.done&&!e(r.value));return r}),yf=(t,e)=>oy(()=>{const{done:r,value:n}=t.next();return{done:r,value:r?void 0:e(n)}});class _f{constructor(e,r){this.clock=e,this.len=r}}class ga{constructor(){this.clients=new Map}}const ay=(t,e,r)=>e.clients.forEach((n,i)=>{const s=t.doc.store.clients.get(i);if(s!=null){const o=s[s.length-1],a=o.id.clock+o.length;for(let c=0,l=n[c];c<n.length&&l.clock<a;l=n[++c])xy(t,s,l.clock,l.len,r)}}),MI=(t,e)=>{let r=0,n=t.length-1;for(;r<=n;){const i=Wi((r+n)/2),s=t[i],o=s.clock;if(o<=e){if(e<o+s.len)return i;r=i+1}else n=i-1}return null},cy=(t,e)=>{const r=t.clients.get(e.client);return r!==void 0&&MI(r,e.clock)!==null},bf=t=>{t.clients.forEach(e=>{e.sort((i,s)=>i.clock-s.clock);let r,n;for(r=1,n=1;r<e.length;r++){const i=e[n-1],s=e[r];i.clock+i.len>=s.clock?i.len=_s(i.len,s.clock+s.len-i.clock):(n<r&&(e[n]=s),n++)}e.length=n})},UI=t=>{const e=new ga;for(let r=0;r<t.length;r++)t[r].clients.forEach((n,i)=>{if(!e.clients.has(i)){const s=n.slice();for(let o=r+1;o<t.length;o++)xO(s,t[o].clients.get(i)||[]);e.clients.set(i,s)}});return bf(e),e},Kc=(t,e,r,n)=>{zi(t.clients,e,()=>[]).push(new _f(r,n))},$I=()=>new ga,PI=t=>{const e=$I();return t.clients.forEach((r,n)=>{const i=[];for(let s=0;s<r.length;s++){const o=r[s];if(o.deleted){const a=o.id.clock;let c=o.length;if(s+1<r.length)for(let l=r[s+1];s+1<r.length&&l.deleted;l=r[++s+1])c+=l.length;i.push(new _f(a,c))}}i.length>0&&e.clients.set(n,i)}),e},po=(t,e)=>{ht(t.restEncoder,e.clients.size),ys(e.clients.entries()).sort((r,n)=>n[0]-r[0]).forEach(([r,n])=>{t.resetDsCurVal(),ht(t.restEncoder,r);const i=n.length;ht(t.restEncoder,i);for(let s=0;s<i;s++){const o=n[s];t.writeDsClock(o.clock),t.writeDsLen(o.len)}})},wf=t=>{const e=new ga,r=rt(t.restDecoder);for(let n=0;n<r;n++){t.resetDsCurVal();const i=rt(t.restDecoder),s=rt(t.restDecoder);if(s>0){const o=zi(e.clients,i,()=>[]);for(let a=0;a<s;a++)o.push(new _f(t.readDsClock(),t.readDsLen()))}}return e},ly=(t,e,r)=>{const n=new ga,i=rt(t.restDecoder);for(let s=0;s<i;s++){t.resetDsCurVal();const o=rt(t.restDecoder),a=rt(t.restDecoder),c=r.clients.get(o)||[],l=ar(r,o);for(let u=0;u<a;u++){const h=t.readDsClock(),f=h+t.readDsLen();if(h<l){l<f&&Kc(n,o,l,f-l);let d=Jn(c,h),m=c[d];for(!m.deleted&&m.id.clock<h&&(c.splice(d+1,0,ol(e,m,h-m.id.clock)),d++);d<c.length&&(m=c[d++],m.id.clock<f);)m.deleted||(f<m.id.clock+m.length&&c.splice(d,0,ol(e,m,f-m.id.clock)),m.delete(e))}else Kc(n,o,h,f-h)}}if(n.clients.size>0){const s=new ws;return ht(s.restEncoder,0),po(s,n),s.toUint8Array()}return null},uy=Gg;class mo extends AO{constructor({guid:e=XO(),collectionid:r=null,gc:n=!0,gcFilter:i=()=>!0,meta:s=null,autoLoad:o=!1,shouldLoad:a=!0}={}){super(),this.gc=n,this.gcFilter=i,this.clientID=uy(),this.guid=e,this.collectionid=r,this.share=new Map,this.store=new wy,this._transaction=null,this._transactionCleanups=[],this.subdocs=new Set,this._item=null,this.shouldLoad=a,this.autoLoad=o,this.meta=s,this.isLoaded=!1,this.isSynced=!1,this.isDestroyed=!1,this.whenLoaded=Kg(l=>{this.on("load",()=>{this.isLoaded=!0,l(this)})});const c=()=>Kg(l=>{const u=h=>{(h===void 0||h===!0)&&(this.off("sync",u),l())};this.on("sync",u)});this.on("sync",l=>{l===!1&&this.isSynced&&(this.whenSynced=c()),this.isSynced=l===void 0||l===!0,this.isSynced&&!this.isLoaded&&this.emit("load",[this])}),this.whenSynced=c()}load(){const e=this._item;e!==null&&!this.shouldLoad&&kt(e.parent.doc,r=>{r.subdocsLoaded.add(this)},null,!0),this.shouldLoad=!0}getSubdocs(){return this.subdocs}getSubdocGuids(){return new Set(ys(this.subdocs).map(e=>e.guid))}transact(e,r=null){return kt(this,e,r)}get(e,r=br){const n=zi(this.share,e,()=>{const s=new r;return s._integrate(this,null),s}),i=n.constructor;if(r!==br&&i!==r)if(i===br){const s=new r;s._map=n._map,n._map.forEach(o=>{for(;o!==null;o=o.left)o.parent=s}),s._start=n._start;for(let o=s._start;o!==null;o=o.right)o.parent=s;return s._length=n._length,this.share.set(e,s),s._integrate(this,null),s}else throw new Error(`Type with the name ${e} has already been defined with a different constructor`);return n}getArray(e=""){return this.get(e,bo)}getText(e=""){return this.get(e,wi)}getMap(e=""){return this.get(e,wo)}getXmlElement(e=""){return this.get(e,vo)}getXmlFragment(e=""){return this.get(e,ks)}toJSON(){const e={};return this.share.forEach((r,n)=>{e[n]=r.toJSON()}),e}destroy(){this.isDestroyed=!0,ys(this.subdocs).forEach(r=>r.destroy());const e=this._item;if(e!==null){this._item=null;const r=e.content;r.doc=new mo({guid:this.guid,...r.opts,shouldLoad:!1}),r.doc._item=e,kt(e.parent.doc,n=>{const i=r.doc;e.deleted||n.subdocsAdded.add(i),n.subdocsRemoved.add(this)},null,!0)}this.emit("destroyed",[!0]),this.emit("destroy",[this]),super.destroy()}}class hy{constructor(e){this.restDecoder=e}resetDsCurVal(){}readDsClock(){return rt(this.restDecoder)}readDsLen(){return rt(this.restDecoder)}}class fy extends hy{readLeftID(){return ot(rt(this.restDecoder),rt(this.restDecoder))}readRightID(){return ot(rt(this.restDecoder),rt(this.restDecoder))}readClient(){return rt(this.restDecoder)}readInfo(){return uo(this.restDecoder)}readString(){return ho(this.restDecoder)}readParentInfo(){return rt(this.restDecoder)===1}readTypeRef(){return rt(this.restDecoder)}readLen(){return rt(this.restDecoder)}readAny(){return pa(this.restDecoder)}readBuf(){return kI(Qr(this.restDecoder))}readJSON(){return JSON.parse(ho(this.restDecoder))}readKey(){return ho(this.restDecoder)}}class BI{constructor(e){this.dsCurrVal=0,this.restDecoder=e}resetDsCurVal(){this.dsCurrVal=0}readDsClock(){return this.dsCurrVal+=rt(this.restDecoder),this.dsCurrVal}readDsLen(){const e=rt(this.restDecoder)+1;return this.dsCurrVal+=e,e}}class go extends BI{constructor(e){super(e),this.keys=[],rt(e),this.keyClockDecoder=new hf(Qr(e)),this.clientDecoder=new Wc(Qr(e)),this.leftClockDecoder=new hf(Qr(e)),this.rightClockDecoder=new hf(Qr(e)),this.infoDecoder=new Hg(Qr(e),uo),this.stringDecoder=new qO(Qr(e)),this.parentInfoDecoder=new Hg(Qr(e),uo),this.typeRefDecoder=new Wc(Qr(e)),this.lenDecoder=new Wc(Qr(e))}readLeftID(){return new yo(this.clientDecoder.read(),this.leftClockDecoder.read())}readRightID(){return new yo(this.clientDecoder.read(),this.rightClockDecoder.read())}readClient(){return this.clientDecoder.read()}readInfo(){return this.infoDecoder.read()}readString(){return this.stringDecoder.read()}readParentInfo(){return this.parentInfoDecoder.read()===1}readTypeRef(){return this.typeRefDecoder.read()}readLen(){return this.lenDecoder.read()}readAny(){return pa(this.restDecoder)}readBuf(){return Qr(this.restDecoder)}readJSON(){return pa(this.restDecoder)}readKey(){const e=this.keyClockDecoder.read();if(e<this.keys.length)return this.keys[e];{const r=this.stringDecoder.read();return this.keys.push(r),r}}}class FI{constructor(){this.restEncoder=Fc()}toUint8Array(){return qn(this.restEncoder)}resetDsCurVal(){}writeDsClock(e){ht(this.restEncoder,e)}writeDsLen(e){ht(this.restEncoder,e)}}class ya extends FI{writeLeftID(e){ht(this.restEncoder,e.client),ht(this.restEncoder,e.clock)}writeRightID(e){ht(this.restEncoder,e.client),ht(this.restEncoder,e.clock)}writeClient(e){ht(this.restEncoder,e)}writeInfo(e){nf(this.restEncoder,e)}writeString(e){co(this.restEncoder,e)}writeParentInfo(e){ht(this.restEncoder,e?1:0)}writeTypeRef(e){ht(this.restEncoder,e)}writeLen(e){ht(this.restEncoder,e)}writeAny(e){da(this.restEncoder,e)}writeBuf(e){Jr(this.restEncoder,e)}writeJSON(e){co(this.restEncoder,JSON.stringify(e))}writeKey(e){co(this.restEncoder,e)}}class DI{constructor(){this.restEncoder=Fc(),this.dsCurrVal=0}toUint8Array(){return qn(this.restEncoder)}resetDsCurVal(){this.dsCurrVal=0}writeDsClock(e){const r=e-this.dsCurrVal;this.dsCurrVal=e,ht(this.restEncoder,r)}writeDsLen(e){e===0&&Vn(),ht(this.restEncoder,e-1),this.dsCurrVal+=e}}class ws extends DI{constructor(){super(),this.keyMap=new Map,this.keyClock=0,this.keyClockEncoder=new cf,this.clientEncoder=new jc,this.leftClockEncoder=new cf,this.rightClockEncoder=new cf,this.infoEncoder=new Fg(nf),this.stringEncoder=new WO,this.parentInfoEncoder=new Fg(nf),this.typeRefEncoder=new jc,this.lenEncoder=new jc}toUint8Array(){const e=Fc();return ht(e,0),Jr(e,this.keyClockEncoder.toUint8Array()),Jr(e,this.clientEncoder.toUint8Array()),Jr(e,this.leftClockEncoder.toUint8Array()),Jr(e,this.rightClockEncoder.toUint8Array()),Jr(e,qn(this.infoEncoder)),Jr(e,this.stringEncoder.toUint8Array()),Jr(e,qn(this.parentInfoEncoder)),Jr(e,this.typeRefEncoder.toUint8Array()),Jr(e,this.lenEncoder.toUint8Array()),Dc(e,qn(this.restEncoder)),qn(e)}writeLeftID(e){this.clientEncoder.write(e.client),this.leftClockEncoder.write(e.clock)}writeRightID(e){this.clientEncoder.write(e.client),this.rightClockEncoder.write(e.clock)}writeClient(e){this.clientEncoder.write(e)}writeInfo(e){this.infoEncoder.write(e)}writeString(e){this.stringEncoder.write(e)}writeParentInfo(e){this.parentInfoEncoder.write(e?1:0)}writeTypeRef(e){this.typeRefEncoder.write(e)}writeLen(e){this.lenEncoder.write(e)}writeAny(e){da(this.restEncoder,e)}writeBuf(e){Jr(this.restEncoder,e)}writeJSON(e){da(this.restEncoder,e)}writeKey(e){const r=this.keyMap.get(e);r===void 0?(this.keyClockEncoder.write(this.keyClock++),this.stringEncoder.write(e)):this.keyClockEncoder.write(r)}}const jI=(t,e,r,n)=>{n=_s(n,e[0].id.clock);const i=Jn(e,n);ht(t.restEncoder,e.length-i),t.writeClient(r),ht(t.restEncoder,n);const s=e[i];s.write(t,n-s.id.clock);for(let o=i+1;o<e.length;o++)e[o].write(t,0)},kf=(t,e,r)=>{const n=new Map;r.forEach((i,s)=>{ar(e,s)>i&&n.set(s,i)}),xf(e).forEach((i,s)=>{r.has(s)||n.set(s,0)}),ht(t.restEncoder,n.size),ys(n.entries()).sort((i,s)=>s[0]-i[0]).forEach(([i,s])=>{jI(t,e.clients.get(i),i,s)})},zI=(t,e)=>{const r=On(),n=rt(t.restDecoder);for(let i=0;i<n;i++){const s=rt(t.restDecoder),o=new Array(s),a=t.readClient();let c=rt(t.restDecoder);r.set(a,{i:0,refs:o});for(let l=0;l<s;l++){const u=t.readInfo();switch(Bc&u){case 0:{const h=t.readLen();o[l]=new dn(ot(a,c),h),c+=h;break}case 10:{const h=rt(t.restDecoder);o[l]=new pn(ot(a,c),h),c+=h;break}default:{const h=(u&(yi|Zr))===0,f=new tr(ot(a,c),null,(u&Zr)===Zr?t.readLeftID():null,null,(u&yi)===yi?t.readRightID():null,h?t.readParentInfo()?e.get(t.readString()):t.readLeftID():null,h&&(u&la)===la?t.readString():null,Yy(t,u));o[l]=f,c+=f.length}}}}return r},WI=(t,e,r)=>{const n=[];let i=ys(r.keys()).sort((d,m)=>d-m);if(i.length===0)return null;const s=()=>{if(i.length===0)return null;let d=r.get(i[i.length-1]);for(;d.refs.length===d.i;)if(i.pop(),i.length>0)d=r.get(i[i.length-1]);else return null;return d};let o=s();if(o===null)return null;const a=new wy,c=new Map,l=(d,m)=>{const p=c.get(d);(p==null||p>m)&&c.set(d,m)};let u=o.refs[o.i++];const h=new Map,f=()=>{for(const d of n){const m=d.id.client,p=r.get(m);p?(p.i--,a.clients.set(m,p.refs.slice(p.i)),r.delete(m),p.i=0,p.refs=[]):a.clients.set(m,[d]),i=i.filter(g=>g!==m)}n.length=0};for(;;){if(u.constructor!==pn){const m=zi(h,u.id.client,()=>ar(e,u.id.client))-u.id.clock;if(m<0)n.push(u),l(u.id.client,u.id.clock-1),f();else{const p=u.getMissing(t,e);if(p!==null){n.push(u);const g=r.get(p)||{refs:[],i:0};if(g.refs.length===g.i)l(p,ar(e,p)),f();else{u=g.refs[g.i++];continue}}else(m===0||m<u.length)&&(u.integrate(t,m),h.set(u.id.client,u.id.clock+u.length))}}if(n.length>0)u=n.pop();else if(o!==null&&o.i<o.refs.length)u=o.refs[o.i++];else{if(o=s(),o===null)break;u=o.refs[o.i++]}}if(a.clients.size>0){const d=new ws;return kf(d,a,new Map),ht(d.restEncoder,0),{missing:c,update:d.toUint8Array()}}return null},HI=(t,e)=>kf(t,e.doc.store,e.beforeState),GI=(t,e,r,n=new go(t))=>kt(e,i=>{i.local=!1;let s=!1;const o=i.doc,a=o.store,c=zI(n,o),l=WI(i,a,c),u=a.pendingStructs;if(u){for(const[f,d]of u.missing)if(d<ar(a,f)){s=!0;break}if(l){for(const[f,d]of l.missing){const m=u.missing.get(f);(m==null||m>d)&&u.missing.set(f,d)}u.update=Vc([u.update,l.update])}}else a.pendingStructs=l;const h=ly(n,i,a);if(a.pendingDs){const f=new go(lo(a.pendingDs));rt(f.restDecoder);const d=ly(f,i,a);h&&d?a.pendingDs=Vc([h,d]):a.pendingDs=h||d}else a.pendingDs=h;if(s){const f=a.pendingStructs.update;a.pendingStructs=null,dy(i.doc,f)}},r,!1),dy=(t,e,r,n=go)=>{const i=lo(e);GI(i,t,r,new n(i))},py=(t,e,r)=>dy(t,e,r,fy),KI=(t,e,r=new Map)=>{kf(t,e.store,r),po(t,PI(e.store))},qI=(t,e=new Uint8Array([0]),r=new ws)=>{const n=my(e);KI(r,t,n);const i=[r.toUint8Array()];if(t.store.pendingDs&&i.push(t.store.pendingDs),t.store.pendingStructs&&i.push(sN(t.store.pendingStructs.update,e)),i.length>1){if(r.constructor===ya)return nN(i.map((s,o)=>o===0?s:aN(s)));if(r.constructor===ws)return Vc(i)}return i[0]},YI=(t,e)=>qI(t,e,new ya),VI=t=>{const e=new Map,r=rt(t.restDecoder);for(let n=0;n<r;n++){const i=rt(t.restDecoder),s=rt(t.restDecoder);e.set(i,s)}return e},my=t=>VI(new hy(lo(t)));class XI{constructor(){this.l=[]}}const gy=()=>new XI,yy=(t,e)=>t.l.push(e),_y=(t,e)=>{const r=t.l,n=r.length;t.l=r.filter(i=>e!==i),n===t.l.length&&console.error("[yjs] Tried to remove event handler that doesn't exist.")},by=(t,e,r)=>pf(t.l,[e,r]);class yo{constructor(e,r){this.client=e,this.clock=r}}const qc=(t,e)=>t===e||t!==null&&e!==null&&t.client===e.client&&t.clock===e.clock,ot=(t,e)=>new yo(t,e),ZI=t=>{for(const[e,r]of t.doc.share.entries())if(r===t)return e;throw Vn()},_o=(t,e)=>e===void 0?!t.deleted:e.sv.has(t.id.client)&&(e.sv.get(t.id.client)||0)>t.id.clock&&!cy(e.ds,t.id),vf=(t,e)=>{const r=zi(t.meta,vf,ao),n=t.doc.store;r.has(e)||(e.sv.forEach((i,s)=>{i<ar(n,s)&&Gi(t,ot(s,i))}),ay(t,e.ds,i=>{}),r.add(e))};class wy{constructor(){this.clients=new Map,this.pendingStructs=null,this.pendingDs=null}}const xf=t=>{const e=new Map;return t.clients.forEach((r,n)=>{const i=r[r.length-1];e.set(n,i.id.clock+i.length)}),e},ar=(t,e)=>{const r=t.clients.get(e);if(r===void 0)return 0;const n=r[r.length-1];return n.id.clock+n.length},ky=(t,e)=>{let r=t.clients.get(e.id.client);if(r===void 0)r=[],t.clients.set(e.id.client,r);else{const n=r[r.length-1];if(n.id.clock+n.length!==e.id.clock)throw Vn()}r.push(e)},Jn=(t,e)=>{let r=0,n=t.length-1,i=t[n],s=i.id.clock;if(s===e)return n;let o=Wi(e/(s+i.length-1)*n);for(;r<=n;){if(i=t[o],s=i.id.clock,s<=e){if(e<s+i.length)return o;r=o+1}else n=o-1;o=Wi((r+n)/2)}throw Vn()},Ef=(t,e)=>{const r=t.clients.get(e.client);return r[Jn(r,e.clock)]},Af=(t,e,r)=>{const n=Jn(e,r),i=e[n];return i.id.clock<r&&i instanceof tr?(e.splice(n+1,0,ol(t,i,r-i.id.clock)),n+1):n},Gi=(t,e)=>{const r=t.doc.store.clients.get(e.client);return r[Af(t,r,e.clock)]},vy=(t,e,r)=>{const n=e.clients.get(r.client),i=Jn(n,r.clock),s=n[i];return r.clock!==s.id.clock+s.length-1&&s.constructor!==dn&&n.splice(i+1,0,ol(t,s,r.clock-s.id.clock+1)),s},JI=(t,e,r)=>{const n=t.clients.get(e.id.client);n[Jn(n,e.id.clock)]=r},xy=(t,e,r,n,i)=>{if(n===0)return;const s=r+n;let o=Af(t,e,r),a;do a=e[o++],s<a.id.clock+a.length&&Af(t,e,s),i(a);while(o<e.length&&e[o].id.clock<s)};class QI{constructor(e,r,n){this.doc=e,this.deleteSet=new ga,this.beforeState=xf(e.store),this.afterState=new Map,this.changed=new Map,this.changedParentTypes=new Map,this._mergeStructs=[],this.origin=r,this.meta=new Map,this.local=n,this.subdocsAdded=new Set,this.subdocsRemoved=new Set,this.subdocsLoaded=new Set,this._needFormattingCleanup=!1}}const Ey=(t,e)=>e.deleteSet.clients.size===0&&!vO(e.afterState,(r,n)=>e.beforeState.get(n)!==r)?!1:(bf(e.deleteSet),HI(t,e),po(t,e.deleteSet),!0),Ay=(t,e,r)=>{const n=e._item;(n===null||n.id.clock<(t.beforeState.get(n.id.client)||0)&&!n.deleted)&&zi(t.changed,e,ao).add(r)},Yc=(t,e)=>{let r=t[e],n=t[e-1],i=e;for(;i>0;r=n,n=t[--i-1]){if(n.deleted===r.deleted&&n.constructor===r.constructor&&n.mergeWith(r)){r instanceof tr&&r.parentSub!==null&&r.parent._map.get(r.parentSub)===r&&r.parent._map.set(r.parentSub,n);continue}break}const s=e-i;return s&&t.splice(e+1-s,s),s},eN=(t,e,r)=>{for(const[n,i]of t.clients.entries()){const s=e.clients.get(n);for(let o=i.length-1;o>=0;o--){const a=i[o],c=a.clock+a.len;for(let l=Jn(s,a.clock),u=s[l];l<s.length&&u.id.clock<c;u=s[++l]){const h=s[l];if(a.clock+a.len<=h.id.clock)break;h instanceof tr&&h.deleted&&!h.keep&&r(h)&&h.gc(e,!1)}}}},tN=(t,e)=>{t.clients.forEach((r,n)=>{const i=e.clients.get(n);for(let s=r.length-1;s>=0;s--){const o=r[s],a=Cg(i.length-1,1+Jn(i,o.clock+o.len-1));for(let c=a,l=i[c];c>0&&l.id.clock>=o.clock;l=i[c])c-=1+Yc(i,c)}})},Ty=(t,e)=>{if(e<t.length){const r=t[e],n=r.doc,i=n.store,s=r.deleteSet,o=r._mergeStructs;try{bf(s),r.afterState=xf(r.doc.store),n.emit("beforeObserverCalls",[r,n]);const a=[];r.changed.forEach((c,l)=>a.push(()=>{(l._item===null||!l._item.deleted)&&l._callObserver(r,c)})),a.push(()=>{r.changedParentTypes.forEach((c,l)=>{l._dEH.l.length>0&&(l._item===null||!l._item.deleted)&&(c=c.filter(u=>u.target._item===null||!u.target._item.deleted),c.forEach(u=>{u.currentTarget=l,u._path=null}),c.sort((u,h)=>u.path.length-h.path.length),by(l._dEH,c,r))})}),a.push(()=>n.emit("afterTransaction",[r,n])),pf(a,[]),r._needFormattingCleanup&&kN(r)}finally{n.gc&&eN(s,i,n.gcFilter),tN(s,i),r.afterState.forEach((u,h)=>{const f=r.beforeState.get(h)||0;if(f!==u){const d=i.clients.get(h),m=_s(Jn(d,f),1);for(let p=d.length-1;p>=m;)p-=1+Yc(d,p)}});for(let u=o.length-1;u>=0;u--){const{client:h,clock:f}=o[u].id,d=i.clients.get(h),m=Jn(d,f);m+1<d.length&&Yc(d,m+1)>1||m>0&&Yc(d,m)}if(!r.local&&r.afterState.get(n.clientID)!==r.beforeState.get(n.clientID)&&(NI(gf,ty,"[yjs] ",ry,ny,"Changed the client-id because another client seems to be using it."),n.clientID=uy()),n.emit("afterTransactionCleanup",[r,n]),n._observers.has("update")){const u=new ya;Ey(u,r)&&n.emit("update",[u.toUint8Array(),r.origin,n,r])}if(n._observers.has("updateV2")){const u=new ws;Ey(u,r)&&n.emit("updateV2",[u.toUint8Array(),r.origin,n,r])}const{subdocsAdded:a,subdocsLoaded:c,subdocsRemoved:l}=r;(a.size>0||l.size>0||c.size>0)&&(a.forEach(u=>{u.clientID=n.clientID,u.collectionid==null&&(u.collectionid=n.collectionid),n.subdocs.add(u)}),l.forEach(u=>n.subdocs.delete(u)),n.emit("subdocs",[{loaded:c,added:a,removed:l},n,r]),l.forEach(u=>u.destroy())),t.length<=e+1?(n._transactionCleanups=[],n.emit("afterAllTransactions",[n,t])):Ty(t,e+1)}}},kt=(t,e,r=null,n=!0)=>{const i=t._transactionCleanups;let s=!1,o=null;t._transaction===null&&(s=!0,t._transaction=new QI(t,r,n),i.push(t._transaction),i.length===1&&t.emit("beforeAllTransactions",[t]),t.emit("beforeTransaction",[t._transaction,t]));try{o=e(t._transaction)}finally{if(s){const a=t._transaction===i[0];t._transaction=null,a&&Ty(i,0)}}return o};function*rN(t){const e=rt(t.restDecoder);for(let r=0;r<e;r++){const n=rt(t.restDecoder),i=t.readClient();let s=rt(t.restDecoder);for(let o=0;o<n;o++){const a=t.readInfo();if(a===10){const c=rt(t.restDecoder);yield new pn(ot(i,s),c),s+=c}else if((Bc&a)!==0){const c=(a&(yi|Zr))===0,l=new tr(ot(i,s),null,(a&Zr)===Zr?t.readLeftID():null,null,(a&yi)===yi?t.readRightID():null,c?t.readParentInfo()?t.readString():t.readLeftID():null,c&&(a&la)===la?t.readString():null,Yy(t,a));yield l,s+=l.length}else{const c=t.readLen();yield new dn(ot(i,s),c),s+=c}}}}class Tf{constructor(e,r){this.gen=rN(e),this.curr=null,this.done=!1,this.filterSkips=r,this.next()}next(){do this.curr=this.gen.next().value||null;while(this.filterSkips&&this.curr!==null&&this.curr.constructor===pn);return this.curr}}class Sf{constructor(e){this.currClient=0,this.startClock=0,this.written=0,this.encoder=e,this.clientStructs=[]}}const nN=t=>Vc(t,fy,ya),iN=(t,e)=>{if(t.constructor===dn){const{client:r,clock:n}=t.id;return new dn(ot(r,n+e),t.length-e)}else if(t.constructor===pn){const{client:r,clock:n}=t.id;return new pn(ot(r,n+e),t.length-e)}else{const r=t,{client:n,clock:i}=r.id;return new tr(ot(n,i+e),null,ot(n,i+e-1),null,r.rightOrigin,r.parent,r.parentSub,r.content.splice(e))}},Vc=(t,e=go,r=ws)=>{if(t.length===1)return t[0];const n=t.map(u=>new e(lo(u)));let i=n.map(u=>new Tf(u,!0)),s=null;const o=new r,a=new Sf(o);for(;i=i.filter(f=>f.curr!==null),i.sort((f,d)=>{if(f.curr.id.client===d.curr.id.client){const m=f.curr.id.clock-d.curr.id.clock;return m===0?f.curr.constructor===d.curr.constructor?0:f.curr.constructor===pn?1:-1:m}else return d.curr.id.client-f.curr.id.client}),i.length!==0;){const u=i[0],h=u.curr.id.client;if(s!==null){let f=u.curr,d=!1;for(;f!==null&&f.id.clock+f.length<=s.struct.id.clock+s.struct.length&&f.id.client>=s.struct.id.client;)f=u.next(),d=!0;if(f===null||f.id.client!==h||d&&f.id.clock>s.struct.id.clock+s.struct.length)continue;if(h!==s.struct.id.client)Ki(a,s.struct,s.offset),s={struct:f,offset:0},u.next();else if(s.struct.id.clock+s.struct.length<f.id.clock)if(s.struct.constructor===pn)s.struct.length=f.id.clock+f.length-s.struct.id.clock;else{Ki(a,s.struct,s.offset);const m=f.id.clock-s.struct.id.clock-s.struct.length;s={struct:new pn(ot(h,s.struct.id.clock+s.struct.length),m),offset:0}}else{const m=s.struct.id.clock+s.struct.length-f.id.clock;m>0&&(s.struct.constructor===pn?s.struct.length-=m:f=iN(f,m)),s.struct.mergeWith(f)||(Ki(a,s.struct,s.offset),s={struct:f,offset:0},u.next())}}else s={struct:u.curr,offset:0},u.next();for(let f=u.curr;f!==null&&f.id.client===h&&f.id.clock===s.struct.id.clock+s.struct.length&&f.constructor!==pn;f=u.next())Ki(a,s.struct,s.offset),s={struct:f,offset:0}}s!==null&&(Ki(a,s.struct,s.offset),s=null),Rf(a);const c=n.map(u=>wf(u)),l=UI(c);return po(o,l),o.toUint8Array()},sN=(t,e,r=go,n=ws)=>{const i=my(e),s=new n,o=new Sf(s),a=new r(lo(t)),c=new Tf(a,!1);for(;c.curr;){const u=c.curr,h=u.id.client,f=i.get(h)||0;if(c.curr.constructor===pn){c.next();continue}if(u.id.clock+u.length>f)for(Ki(o,u,_s(f-u.id.clock,0)),c.next();c.curr&&c.curr.id.client===h;)Ki(o,c.curr,0),c.next();else for(;c.curr&&c.curr.id.client===h&&c.curr.id.clock+c.curr.length<=f;)c.next()}Rf(o);const l=wf(a);return po(s,l),s.toUint8Array()},Sy=t=>{t.written>0&&(t.clientStructs.push({written:t.written,restEncoder:qn(t.encoder.restEncoder)}),t.encoder.restEncoder=Fc(),t.written=0)},Ki=(t,e,r)=>{t.written>0&&t.currClient!==e.id.client&&Sy(t),t.written===0&&(t.currClient=e.id.client,t.encoder.writeClient(e.id.client),ht(t.encoder.restEncoder,e.id.clock+r)),e.write(t.encoder,r),t.written++},Rf=t=>{Sy(t);const e=t.encoder.restEncoder;ht(e,t.clientStructs.length);for(let r=0;r<t.clientStructs.length;r++){const n=t.clientStructs[r];ht(e,n.written),Dc(e,n.restEncoder)}},oN=(t,e,r,n)=>{const i=new r(lo(t)),s=new Tf(i,!1),o=new n,a=new Sf(o);for(let l=s.curr;l!==null;l=s.next())Ki(a,e(l),0);Rf(a);const c=wf(i);return po(o,c),o.toUint8Array()},aN=t=>oN(t,gI,go,ya),Ry="You must not compute changes after the event-handler fired.";class Xc{constructor(e,r){this.target=e,this.currentTarget=e,this.transaction=r,this._changes=null,this._keys=null,this._delta=null,this._path=null}get path(){return this._path||(this._path=cN(this.currentTarget,this.target))}deletes(e){return cy(this.transaction.deleteSet,e.id)}get keys(){if(this._keys===null){if(this.transaction.doc._transactionCleanups.length===0)throw Hi(Ry);const e=new Map,r=this.target;this.transaction.changed.get(r).forEach(i=>{if(i!==null){const s=r._map.get(i);let o,a;if(this.adds(s)){let c=s.left;for(;c!==null&&this.adds(c);)c=c.left;if(this.deletes(s))if(c!==null&&this.deletes(c))o="delete",a=Qh(c.content.getContent());else return;else c!==null&&this.deletes(c)?(o="update",a=Qh(c.content.getContent())):(o="add",a=void 0)}else if(this.deletes(s))o="delete",a=Qh(s.content.getContent());else return;e.set(i,{action:o,oldValue:a})}}),this._keys=e}return this._keys}get delta(){return this.changes.delta}adds(e){return e.id.clock>=(this.transaction.beforeState.get(e.id.client)||0)}get changes(){let e=this._changes;if(e===null){if(this.transaction.doc._transactionCleanups.length===0)throw Hi(Ry);const r=this.target,n=ao(),i=ao(),s=[];if(e={added:n,deleted:i,delta:s,keys:this.keys},this.transaction.changed.get(r).has(null)){let a=null;const c=()=>{a&&s.push(a)};for(let l=r._start;l!==null;l=l.right)l.deleted?this.deletes(l)&&!this.adds(l)&&((a===null||a.delete===void 0)&&(c(),a={delete:0}),a.delete+=l.length,i.add(l)):this.adds(l)?((a===null||a.insert===void 0)&&(c(),a={insert:[]}),a.insert=a.insert.concat(l.content.getContent()),n.add(l)):((a===null||a.retain===void 0)&&(c(),a={retain:0}),a.retain+=l.length);a!==null&&a.retain===void 0&&c()}this._changes=e}return e}}const cN=(t,e)=>{const r=[];for(;e._item!==null&&e!==t;){if(e._item.parentSub!==null)r.unshift(e._item.parentSub);else{let n=0,i=e._item.parent._start;for(;i!==e._item&&i!==null;)!i.deleted&&i.countable&&(n+=i.length),i=i.right;r.unshift(n)}e=e._item.parent}return r},vr=()=>{CI("Invalid access: Add Yjs type to a document before reading data.")},Oy=80;let Of=0;class lN{constructor(e,r){e.marker=!0,this.p=e,this.index=r,this.timestamp=Of++}}const uN=t=>{t.timestamp=Of++},Iy=(t,e,r)=>{t.p.marker=!1,t.p=e,e.marker=!0,t.index=r,t.timestamp=Of++},hN=(t,e,r)=>{if(t.length>=Oy){const n=t.reduce((i,s)=>i.timestamp<s.timestamp?i:s);return Iy(n,e,r),n}else{const n=new lN(e,r);return t.push(n),n}},Zc=(t,e)=>{if(t._start===null||e===0||t._searchMarker===null)return null;const r=t._searchMarker.length===0?null:t._searchMarker.reduce((s,o)=>Pc(e-s.index)<Pc(e-o.index)?s:o);let n=t._start,i=0;for(r!==null&&(n=r.p,i=r.index,uN(r));n.right!==null&&i<e;){if(!n.deleted&&n.countable){if(e<i+n.length)break;i+=n.length}n=n.right}for(;n.left!==null&&i>e;)n=n.left,!n.deleted&&n.countable&&(i-=n.length);for(;n.left!==null&&n.left.id.client===n.id.client&&n.left.id.clock+n.left.length===n.id.clock;)n=n.left,!n.deleted&&n.countable&&(i-=n.length);return r!==null&&Pc(r.index-i)<n.parent.length/Oy?(Iy(r,n,i),r):hN(t._searchMarker,n,i)},_a=(t,e,r)=>{for(let n=t.length-1;n>=0;n--){const i=t[n];if(r>0){let s=i.p;for(s.marker=!1;s&&(s.deleted||!s.countable);)s=s.left,s&&!s.deleted&&s.countable&&(i.index-=s.length);if(s===null||s.marker===!0){t.splice(n,1);continue}i.p=s,s.marker=!0}(e<i.index||r>0&&e===i.index)&&(i.index=_s(e,i.index+r))}},Jc=(t,e,r)=>{const n=t,i=e.changedParentTypes;for(;zi(i,t,()=>[]).push(r),t._item!==null;)t=t._item.parent;by(n._eH,r,e)};class br{constructor(){this._item=null,this._map=new Map,this._start=null,this.doc=null,this._length=0,this._eH=gy(),this._dEH=gy(),this._searchMarker=null}get parent(){return this._item?this._item.parent:null}_integrate(e,r){this.doc=e,this._item=r}_copy(){throw Yn()}clone(){throw Yn()}_write(e){}get _first(){let e=this._start;for(;e!==null&&e.deleted;)e=e.right;return e}_callObserver(e,r){!e.local&&this._searchMarker&&(this._searchMarker.length=0)}observe(e){yy(this._eH,e)}observeDeep(e){yy(this._dEH,e)}unobserve(e){_y(this._eH,e)}unobserveDeep(e){_y(this._dEH,e)}toJSON(){}}const Ny=(t,e,r)=>{t.doc??vr(),e<0&&(e=t._length+e),r<0&&(r=t._length+r);let n=r-e;const i=[];let s=t._start;for(;s!==null&&n>0;){if(s.countable&&!s.deleted){const o=s.content.getContent();if(o.length<=e)e-=o.length;else{for(let a=e;a<o.length&&n>0;a++)i.push(o[a]),n--;e=0}}s=s.right}return i},Cy=t=>{t.doc??vr();const e=[];let r=t._start;for(;r!==null;){if(r.countable&&!r.deleted){const n=r.content.getContent();for(let i=0;i<n.length;i++)e.push(n[i])}r=r.right}return e},ba=(t,e)=>{let r=0,n=t._start;for(t.doc??vr();n!==null;){if(n.countable&&!n.deleted){const i=n.content.getContent();for(let s=0;s<i.length;s++)e(i[s],r++,t)}n=n.right}},Ly=(t,e)=>{const r=[];return ba(t,(n,i)=>{r.push(e(n,i,t))}),r},fN=t=>{let e=t._start,r=null,n=0;return{[Symbol.iterator](){return this},next:()=>{if(r===null){for(;e!==null&&e.deleted;)e=e.right;if(e===null)return{done:!0,value:void 0};r=e.content.getContent(),n=0,e=e.right}const i=r[n++];return r.length<=n&&(r=null),{done:!1,value:i}}}},My=(t,e)=>{t.doc??vr();const r=Zc(t,e);let n=t._start;for(r!==null&&(n=r.p,e-=r.index);n!==null;n=n.right)if(!n.deleted&&n.countable){if(e<n.length)return n.content.getContent()[e];e-=n.length}},Qc=(t,e,r,n)=>{let i=r;const s=t.doc,o=s.clientID,a=s.store,c=r===null?e._start:r.right;let l=[];const u=()=>{l.length>0&&(i=new tr(ot(o,ar(a,o)),i,i&&i.lastId,c,c&&c.id,e,null,new xs(l)),i.integrate(t,0),l=[])};n.forEach(h=>{if(h===null)l.push(h);else switch(h.constructor){case Number:case Object:case Boolean:case Array:case String:l.push(h);break;default:switch(u(),h.constructor){case Uint8Array:case ArrayBuffer:i=new tr(ot(o,ar(a,o)),i,i&&i.lastId,c,c&&c.id,e,null,new wa(new Uint8Array(h))),i.integrate(t,0);break;case mo:i=new tr(ot(o,ar(a,o)),i,i&&i.lastId,c,c&&c.id,e,null,new va(h)),i.integrate(t,0);break;default:if(h instanceof br)i=new tr(ot(o,ar(a,o)),i,i&&i.lastId,c,c&&c.id,e,null,new ki(h)),i.integrate(t,0);else throw new Error("Unexpected content type in insert operation")}}}),u()},Uy=()=>Hi("Length exceeded!"),$y=(t,e,r,n)=>{if(r>e._length)throw Uy();if(r===0)return e._searchMarker&&_a(e._searchMarker,r,n.length),Qc(t,e,null,n);const i=r,s=Zc(e,r);let o=e._start;for(s!==null&&(o=s.p,r-=s.index,r===0&&(o=o.prev,r+=o&&o.countable&&!o.deleted?o.length:0));o!==null;o=o.right)if(!o.deleted&&o.countable){if(r<=o.length){r<o.length&&Gi(t,ot(o.id.client,o.id.clock+r));break}r-=o.length}return e._searchMarker&&_a(e._searchMarker,i,n.length),Qc(t,e,o,n)},dN=(t,e,r)=>{let i=(e._searchMarker||[]).reduce((s,o)=>o.index>s.index?o:s,{index:0,p:e._start}).p;if(i)for(;i.right;)i=i.right;return Qc(t,e,i,r)},Py=(t,e,r,n)=>{if(n===0)return;const i=r,s=n,o=Zc(e,r);let a=e._start;for(o!==null&&(a=o.p,r-=o.index);a!==null&&r>0;a=a.right)!a.deleted&&a.countable&&(r<a.length&&Gi(t,ot(a.id.client,a.id.clock+r)),r-=a.length);for(;n>0&&a!==null;)a.deleted||(n<a.length&&Gi(t,ot(a.id.client,a.id.clock+n)),a.delete(t),n-=a.length),a=a.right;if(n>0)throw Uy();e._searchMarker&&_a(e._searchMarker,i,-s+n)},el=(t,e,r)=>{const n=e._map.get(r);n!==void 0&&n.delete(t)},If=(t,e,r,n)=>{const i=e._map.get(r)||null,s=t.doc,o=s.clientID;let a;if(n==null)a=new xs([n]);else switch(n.constructor){case Number:case Object:case Boolean:case Array:case String:case Date:case BigInt:a=new xs([n]);break;case Uint8Array:a=new wa(n);break;case mo:a=new va(n);break;default:if(n instanceof br)a=new ki(n);else throw new Error("Unexpected content type")}new tr(ot(o,ar(s.store,o)),i,i&&i.lastId,null,null,e,r,a).integrate(t,0)},Nf=(t,e)=>{t.doc??vr();const r=t._map.get(e);return r!==void 0&&!r.deleted?r.content.getContent()[r.length-1]:void 0},By=t=>{const e={};return t.doc??vr(),t._map.forEach((r,n)=>{r.deleted||(e[n]=r.content.getContent()[r.length-1])}),e},Fy=(t,e)=>{t.doc??vr();const r=t._map.get(e);return r!==void 0&&!r.deleted},pN=(t,e)=>{const r={};return t._map.forEach((n,i)=>{let s=n;for(;s!==null&&(!e.sv.has(s.id.client)||s.id.clock>=(e.sv.get(s.id.client)||0));)s=s.left;s!==null&&_o(s,e)&&(r[i]=s.content.getContent()[s.length-1])}),r},tl=t=>(t.doc??vr(),LI(t._map.entries(),e=>!e[1].deleted));class mN extends Xc{}class bo extends br{constructor(){super(),this._prelimContent=[],this._searchMarker=[]}static from(e){const r=new bo;return r.push(e),r}_integrate(e,r){super._integrate(e,r),this.insert(0,this._prelimContent),this._prelimContent=null}_copy(){return new bo}clone(){const e=new bo;return e.insert(0,this.toArray().map(r=>r instanceof br?r.clone():r)),e}get length(){return this.doc??vr(),this._length}_callObserver(e,r){super._callObserver(e,r),Jc(this,e,new mN(this,e))}insert(e,r){this.doc!==null?kt(this.doc,n=>{$y(n,this,e,r)}):this._prelimContent.splice(e,0,...r)}push(e){this.doc!==null?kt(this.doc,r=>{dN(r,this,e)}):this._prelimContent.push(...e)}unshift(e){this.insert(0,e)}delete(e,r=1){this.doc!==null?kt(this.doc,n=>{Py(n,this,e,r)}):this._prelimContent.splice(e,r)}get(e){return My(this,e)}toArray(){return Cy(this)}slice(e=0,r=this.length){return Ny(this,e,r)}toJSON(){return this.map(e=>e instanceof br?e.toJSON():e)}map(e){return Ly(this,e)}forEach(e){ba(this,e)}[Symbol.iterator](){return fN(this)}_write(e){e.writeTypeRef(DN)}}const gN=t=>new bo;class yN extends Xc{constructor(e,r,n){super(e,r),this.keysChanged=n}}class wo extends br{constructor(e){super(),this._prelimContent=null,e===void 0?this._prelimContent=new Map:this._prelimContent=new Map(e)}_integrate(e,r){super._integrate(e,r),this._prelimContent.forEach((n,i)=>{this.set(i,n)}),this._prelimContent=null}_copy(){return new wo}clone(){const e=new wo;return this.forEach((r,n)=>{e.set(n,r instanceof br?r.clone():r)}),e}_callObserver(e,r){Jc(this,e,new yN(this,e,r))}toJSON(){this.doc??vr();const e={};return this._map.forEach((r,n)=>{if(!r.deleted){const i=r.content.getContent()[r.length-1];e[n]=i instanceof br?i.toJSON():i}}),e}get size(){return[...tl(this)].length}keys(){return yf(tl(this),e=>e[0])}values(){return yf(tl(this),e=>e[1].content.getContent()[e[1].length-1])}entries(){return yf(tl(this),e=>[e[0],e[1].content.getContent()[e[1].length-1]])}forEach(e){this.doc??vr(),this._map.forEach((r,n)=>{r.deleted||e(r.content.getContent()[r.length-1],n,this)})}[Symbol.iterator](){return this.entries()}delete(e){this.doc!==null?kt(this.doc,r=>{el(r,this,e)}):this._prelimContent.delete(e)}set(e,r){return this.doc!==null?kt(this.doc,n=>{If(n,this,e,r)}):this._prelimContent.set(e,r),r}get(e){return Nf(this,e)}has(e){return Fy(this,e)}clear(){this.doc!==null?kt(this.doc,e=>{this.forEach(function(r,n,i){el(e,i,n)})}):this._prelimContent.clear()}_write(e){e.writeTypeRef(jN)}}const _N=t=>new wo,qi=(t,e)=>t===e||typeof t=="object"&&typeof e=="object"&&t&&e&&pI(t,e);class Cf{constructor(e,r,n,i){this.left=e,this.right=r,this.index=n,this.currentAttributes=i}forward(){switch(this.right===null&&Vn(),this.right.content.constructor){case er:this.right.deleted||ko(this.currentAttributes,this.right.content);break;default:this.right.deleted||(this.index+=this.right.length);break}this.left=this.right,this.right=this.right.right}}const Dy=(t,e,r)=>{for(;e.right!==null&&r>0;){switch(e.right.content.constructor){case er:e.right.deleted||ko(e.currentAttributes,e.right.content);break;default:e.right.deleted||(r<e.right.length&&Gi(t,ot(e.right.id.client,e.right.id.clock+r)),e.index+=e.right.length,r-=e.right.length);break}e.left=e.right,e.right=e.right.right}return e},rl=(t,e,r,n)=>{const i=new Map,s=n?Zc(e,r):null;if(s){const o=new Cf(s.p.left,s.p,s.index,i);return Dy(t,o,r-s.index)}else{const o=new Cf(null,e._start,0,i);return Dy(t,o,r)}},jy=(t,e,r,n)=>{for(;r.right!==null&&(r.right.deleted===!0||r.right.content.constructor===er&&qi(n.get(r.right.content.key),r.right.content.value));)r.right.deleted||n.delete(r.right.content.key),r.forward();const i=t.doc,s=i.clientID;n.forEach((o,a)=>{const c=r.left,l=r.right,u=new tr(ot(s,ar(i.store,s)),c,c&&c.lastId,l,l&&l.id,e,null,new er(a,o));u.integrate(t,0),r.right=u,r.forward()})},ko=(t,e)=>{const{key:r,value:n}=e;n===null?t.delete(r):t.set(r,n)},zy=(t,e)=>{for(;t.right!==null;){if(!(t.right.deleted||t.right.content.constructor===er&&qi(e[t.right.content.key]??null,t.right.content.value)))break;t.forward()}},Wy=(t,e,r,n)=>{const i=t.doc,s=i.clientID,o=new Map;for(const a in n){const c=n[a],l=r.currentAttributes.get(a)??null;if(!qi(l,c)){o.set(a,l);const{left:u,right:h}=r;r.right=new tr(ot(s,ar(i.store,s)),u,u&&u.lastId,h,h&&h.id,e,null,new er(a,c)),r.right.integrate(t,0),r.forward()}}return o},Lf=(t,e,r,n,i)=>{r.currentAttributes.forEach((f,d)=>{i[d]===void 0&&(i[d]=null)});const s=t.doc,o=s.clientID;zy(r,i);const a=Wy(t,e,r,i),c=n.constructor===String?new Qn(n):n instanceof br?new ki(n):new vs(n);let{left:l,right:u,index:h}=r;e._searchMarker&&_a(e._searchMarker,r.index,c.getLength()),u=new tr(ot(o,ar(s.store,o)),l,l&&l.lastId,u,u&&u.id,e,null,c),u.integrate(t,0),r.right=u,r.index=h,r.forward(),jy(t,e,r,a)},Hy=(t,e,r,n,i)=>{const s=t.doc,o=s.clientID;zy(r,i);const a=Wy(t,e,r,i);e:for(;r.right!==null&&(n>0||a.size>0&&(r.right.deleted||r.right.content.constructor===er));){if(!r.right.deleted)switch(r.right.content.constructor){case er:{const{key:c,value:l}=r.right.content,u=i[c];if(u!==void 0){if(qi(u,l))a.delete(c);else{if(n===0)break e;a.set(c,l)}r.right.delete(t)}else r.currentAttributes.set(c,l);break}default:n<r.right.length&&Gi(t,ot(r.right.id.client,r.right.id.clock+n)),n-=r.right.length;break}r.forward()}if(n>0){let c="";for(;n>0;n--)c+=`
`;r.right=new tr(ot(o,ar(s.store,o)),r.left,r.left&&r.left.lastId,r.right,r.right&&r.right.id,e,null,new Qn(c)),r.right.integrate(t,0),r.forward()}jy(t,e,r,a)},Gy=(t,e,r,n,i)=>{let s=e;const o=On();for(;s&&(!s.countable||s.deleted);){if(!s.deleted&&s.content.constructor===er){const l=s.content;o.set(l.key,l)}s=s.right}let a=0,c=!1;for(;e!==s;){if(r===e&&(c=!0),!e.deleted){const l=e.content;switch(l.constructor){case er:{const{key:u,value:h}=l,f=n.get(u)??null;(o.get(u)!==l||f===h)&&(e.delete(t),a++,!c&&(i.get(u)??null)===h&&f!==h&&(f===null?i.delete(u):i.set(u,f))),!c&&!e.deleted&&ko(i,l);break}}}e=e.right}return a},bN=(t,e)=>{for(;e&&e.right&&(e.right.deleted||!e.right.countable);)e=e.right;const r=new Set;for(;e&&(e.deleted||!e.countable);){if(!e.deleted&&e.content.constructor===er){const n=e.content.key;r.has(n)?e.delete(t):r.add(n)}e=e.left}},wN=t=>{let e=0;return kt(t.doc,r=>{let n=t._start,i=t._start,s=On();const o=Jh(s);for(;i;){if(i.deleted===!1)switch(i.content.constructor){case er:ko(o,i.content);break;default:e+=Gy(r,n,i,s,o),s=Jh(o),n=i;break}i=i.right}}),e},kN=t=>{const e=new Set,r=t.doc;for(const[n,i]of t.afterState.entries()){const s=t.beforeState.get(n)||0;i!==s&&xy(t,r.store.clients.get(n),s,i,o=>{!o.deleted&&o.content.constructor===er&&o.constructor!==dn&&e.add(o.parent)})}kt(r,n=>{ay(t,t.deleteSet,i=>{if(i instanceof dn||!i.parent._hasFormatting||e.has(i.parent))return;const s=i.parent;i.content.constructor===er?e.add(s):bN(n,i)});for(const i of e)wN(i)})},Ky=(t,e,r)=>{const n=r,i=Jh(e.currentAttributes),s=e.right;for(;r>0&&e.right!==null;){if(e.right.deleted===!1)switch(e.right.content.constructor){case ki:case vs:case Qn:r<e.right.length&&Gi(t,ot(e.right.id.client,e.right.id.clock+r)),r-=e.right.length,e.right.delete(t);break}e.forward()}s&&Gy(t,s,e.right,i,e.currentAttributes);const o=(e.left||e.right).parent;return o._searchMarker&&_a(o._searchMarker,e.index,-n+r),e};class vN extends Xc{constructor(e,r,n){super(e,r),this.childListChanged=!1,this.keysChanged=new Set,n.forEach(i=>{i===null?this.childListChanged=!0:this.keysChanged.add(i)})}get changes(){if(this._changes===null){const e={keys:this.keys,delta:this.delta,added:new Set,deleted:new Set};this._changes=e}return this._changes}get delta(){if(this._delta===null){const e=this.target.doc,r=[];kt(e,n=>{const i=new Map,s=new Map;let o=this.target._start,a=null;const c={};let l="",u=0,h=0;const f=()=>{if(a!==null){let d=null;switch(a){case"delete":h>0&&(d={delete:h}),h=0;break;case"insert":(typeof l=="object"||l.length>0)&&(d={insert:l},i.size>0&&(d.attributes={},i.forEach((m,p)=>{m!==null&&(d.attributes[p]=m)}))),l="";break;case"retain":u>0&&(d={retain:u},hI(c)||(d.attributes=cI({},c))),u=0;break}d&&r.push(d),a=null}};for(;o!==null;){switch(o.content.constructor){case ki:case vs:this.adds(o)?this.deletes(o)||(f(),a="insert",l=o.content.getContent()[0],f()):this.deletes(o)?(a!=="delete"&&(f(),a="delete"),h+=1):o.deleted||(a!=="retain"&&(f(),a="retain"),u+=1);break;case Qn:this.adds(o)?this.deletes(o)||(a!=="insert"&&(f(),a="insert"),l+=o.content.str):this.deletes(o)?(a!=="delete"&&(f(),a="delete"),h+=o.length):o.deleted||(a!=="retain"&&(f(),a="retain"),u+=o.length);break;case er:{const{key:d,value:m}=o.content;if(this.adds(o)){if(!this.deletes(o)){const p=i.get(d)??null;qi(p,m)?m!==null&&o.delete(n):(a==="retain"&&f(),qi(m,s.get(d)??null)?delete c[d]:c[d]=m)}}else if(this.deletes(o)){s.set(d,m);const p=i.get(d)??null;qi(p,m)||(a==="retain"&&f(),c[d]=p)}else if(!o.deleted){s.set(d,m);const p=c[d];p!==void 0&&(qi(p,m)?p!==null&&o.delete(n):(a==="retain"&&f(),m===null?delete c[d]:c[d]=m))}o.deleted||(a==="insert"&&f(),ko(i,o.content));break}}o=o.right}for(f();r.length>0;){const d=r[r.length-1];if(d.retain!==void 0&&d.attributes===void 0)r.pop();else break}}),this._delta=r}return this._delta}}class wi extends br{constructor(e){super(),this._pending=e!==void 0?[()=>this.insert(0,e)]:[],this._searchMarker=[],this._hasFormatting=!1}get length(){return this.doc??vr(),this._length}_integrate(e,r){super._integrate(e,r);try{this._pending.forEach(n=>n())}catch(n){console.error(n)}this._pending=null}_copy(){return new wi}clone(){const e=new wi;return e.applyDelta(this.toDelta()),e}_callObserver(e,r){super._callObserver(e,r);const n=new vN(this,e,r);Jc(this,e,n),!e.local&&this._hasFormatting&&(e._needFormattingCleanup=!0)}toString(){this.doc??vr();let e="",r=this._start;for(;r!==null;)!r.deleted&&r.countable&&r.content.constructor===Qn&&(e+=r.content.str),r=r.right;return e}toJSON(){return this.toString()}applyDelta(e,{sanitize:r=!0}={}){this.doc!==null?kt(this.doc,n=>{const i=new Cf(null,this._start,0,new Map);for(let s=0;s<e.length;s++){const o=e[s];if(o.insert!==void 0){const a=!r&&typeof o.insert=="string"&&s===e.length-1&&i.right===null&&o.insert.slice(-1)===`
`?o.insert.slice(0,-1):o.insert;(typeof a!="string"||a.length>0)&&Lf(n,this,i,a,o.attributes||{})}else o.retain!==void 0?Hy(n,this,i,o.retain,o.attributes||{}):o.delete!==void 0&&Ky(n,i,o.delete)}}):this._pending.push(()=>this.applyDelta(e))}toDelta(e,r,n){this.doc??vr();const i=[],s=new Map,o=this.doc;let a="",c=this._start;function l(){if(a.length>0){const h={};let f=!1;s.forEach((m,p)=>{f=!0,h[p]=m});const d={insert:a};f&&(d.attributes=h),i.push(d),a=""}}const u=()=>{for(;c!==null;){if(_o(c,e)||r!==void 0&&_o(c,r))switch(c.content.constructor){case Qn:{const h=s.get("ychange");e!==void 0&&!_o(c,e)?(h===void 0||h.user!==c.id.client||h.type!=="removed")&&(l(),s.set("ychange",n?n("removed",c.id):{type:"removed"})):r!==void 0&&!_o(c,r)?(h===void 0||h.user!==c.id.client||h.type!=="added")&&(l(),s.set("ychange",n?n("added",c.id):{type:"added"})):h!==void 0&&(l(),s.delete("ychange")),a+=c.content.str;break}case ki:case vs:{l();const h={insert:c.content.getContent()[0]};if(s.size>0){const f={};h.attributes=f,s.forEach((d,m)=>{f[m]=d})}i.push(h);break}case er:_o(c,e)&&(l(),ko(s,c.content));break}c=c.right}l()};return e||r?kt(o,h=>{e&&vf(h,e),r&&vf(h,r),u()},"cleanup"):u(),i}insert(e,r,n){if(r.length<=0)return;const i=this.doc;i!==null?kt(i,s=>{const o=rl(s,this,e,!n);n||(n={},o.currentAttributes.forEach((a,c)=>{n[c]=a})),Lf(s,this,o,r,n)}):this._pending.push(()=>this.insert(e,r,n))}insertEmbed(e,r,n){const i=this.doc;i!==null?kt(i,s=>{const o=rl(s,this,e,!n);Lf(s,this,o,r,n||{})}):this._pending.push(()=>this.insertEmbed(e,r,n||{}))}delete(e,r){if(r===0)return;const n=this.doc;n!==null?kt(n,i=>{Ky(i,rl(i,this,e,!0),r)}):this._pending.push(()=>this.delete(e,r))}format(e,r,n){if(r===0)return;const i=this.doc;i!==null?kt(i,s=>{const o=rl(s,this,e,!1);o.right!==null&&Hy(s,this,o,r,n)}):this._pending.push(()=>this.format(e,r,n))}removeAttribute(e){this.doc!==null?kt(this.doc,r=>{el(r,this,e)}):this._pending.push(()=>this.removeAttribute(e))}setAttribute(e,r){this.doc!==null?kt(this.doc,n=>{If(n,this,e,r)}):this._pending.push(()=>this.setAttribute(e,r))}getAttribute(e){return Nf(this,e)}getAttributes(){return By(this)}_write(e){e.writeTypeRef(zN)}}const xN=t=>new wi;class Mf{constructor(e,r=()=>!0){this._filter=r,this._root=e,this._currentNode=e._start,this._firstCall=!0,e.doc??vr()}[Symbol.iterator](){return this}next(){let e=this._currentNode,r=e&&e.content&&e.content.type;if(e!==null&&(!this._firstCall||e.deleted||!this._filter(r)))do if(r=e.content.type,!e.deleted&&(r.constructor===vo||r.constructor===ks)&&r._start!==null)e=r._start;else for(;e!==null;){const n=e.next;if(n!==null){e=n;break}else e.parent===this._root?e=null:e=e.parent._item}while(e!==null&&(e.deleted||!this._filter(e.content.type)));return this._firstCall=!1,e===null?{value:void 0,done:!0}:(this._currentNode=e,{value:e.content.type,done:!1})}}class ks extends br{constructor(){super(),this._prelimContent=[]}get firstChild(){const e=this._first;return e?e.content.getContent()[0]:null}_integrate(e,r){super._integrate(e,r),this.insert(0,this._prelimContent),this._prelimContent=null}_copy(){return new ks}clone(){const e=new ks;return e.insert(0,this.toArray().map(r=>r instanceof br?r.clone():r)),e}get length(){return this.doc??vr(),this._prelimContent===null?this._length:this._prelimContent.length}createTreeWalker(e){return new Mf(this,e)}querySelector(e){e=e.toUpperCase();const n=new Mf(this,i=>i.nodeName&&i.nodeName.toUpperCase()===e).next();return n.done?null:n.value}querySelectorAll(e){return e=e.toUpperCase(),ys(new Mf(this,r=>r.nodeName&&r.nodeName.toUpperCase()===e))}_callObserver(e,r){Jc(this,e,new TN(this,r,e))}toString(){return Ly(this,e=>e.toString()).join("")}toJSON(){return this.toString()}toDOM(e=document,r={},n){const i=e.createDocumentFragment();return n!==void 0&&n._createAssociation(i,this),ba(this,s=>{i.insertBefore(s.toDOM(e,r,n),null)}),i}insert(e,r){this.doc!==null?kt(this.doc,n=>{$y(n,this,e,r)}):this._prelimContent.splice(e,0,...r)}insertAfter(e,r){if(this.doc!==null)kt(this.doc,n=>{const i=e&&e instanceof br?e._item:e;Qc(n,this,i,r)});else{const n=this._prelimContent,i=e===null?0:n.findIndex(s=>s===e)+1;if(i===0&&e!==null)throw Hi("Reference item not found");n.splice(i,0,...r)}}delete(e,r=1){this.doc!==null?kt(this.doc,n=>{Py(n,this,e,r)}):this._prelimContent.splice(e,r)}toArray(){return Cy(this)}push(e){this.insert(this.length,e)}unshift(e){this.insert(0,e)}get(e){return My(this,e)}slice(e=0,r=this.length){return Ny(this,e,r)}forEach(e){ba(this,e)}_write(e){e.writeTypeRef(HN)}}const EN=t=>new ks;class vo extends ks{constructor(e="UNDEFINED"){super(),this.nodeName=e,this._prelimAttrs=new Map}get nextSibling(){const e=this._item?this._item.next:null;return e?e.content.type:null}get prevSibling(){const e=this._item?this._item.prev:null;return e?e.content.type:null}_integrate(e,r){super._integrate(e,r),this._prelimAttrs.forEach((n,i)=>{this.setAttribute(i,n)}),this._prelimAttrs=null}_copy(){return new vo(this.nodeName)}clone(){const e=new vo(this.nodeName),r=this.getAttributes();return uI(r,(n,i)=>{typeof n=="string"&&e.setAttribute(i,n)}),e.insert(0,this.toArray().map(n=>n instanceof br?n.clone():n)),e}toString(){const e=this.getAttributes(),r=[],n=[];for(const a in e)n.push(a);n.sort();const i=n.length;for(let a=0;a<i;a++){const c=n[a];r.push(c+'="'+e[c]+'"')}const s=this.nodeName.toLocaleLowerCase(),o=r.length>0?" "+r.join(" "):"";return`<${s}${o}>${super.toString()}</${s}>`}removeAttribute(e){this.doc!==null?kt(this.doc,r=>{el(r,this,e)}):this._prelimAttrs.delete(e)}setAttribute(e,r){this.doc!==null?kt(this.doc,n=>{If(n,this,e,r)}):this._prelimAttrs.set(e,r)}getAttribute(e){return Nf(this,e)}hasAttribute(e){return Fy(this,e)}getAttributes(e){return e?pN(this,e):By(this)}toDOM(e=document,r={},n){const i=e.createElement(this.nodeName),s=this.getAttributes();for(const o in s){const a=s[o];typeof a=="string"&&i.setAttribute(o,a)}return ba(this,o=>{i.appendChild(o.toDOM(e,r,n))}),n!==void 0&&n._createAssociation(i,this),i}_write(e){e.writeTypeRef(WN),e.writeKey(this.nodeName)}}const AN=t=>new vo(t.readKey());class TN extends Xc{constructor(e,r,n){super(e,n),this.childListChanged=!1,this.attributesChanged=new Set,r.forEach(i=>{i===null?this.childListChanged=!0:this.attributesChanged.add(i)})}}class nl extends wo{constructor(e){super(),this.hookName=e}_copy(){return new nl(this.hookName)}clone(){const e=new nl(this.hookName);return this.forEach((r,n)=>{e.set(n,r)}),e}toDOM(e=document,r={},n){const i=r[this.hookName];let s;return i!==void 0?s=i.createDom(this):s=document.createElement(this.hookName),s.setAttribute("data-yjs-hook",this.hookName),n!==void 0&&n._createAssociation(s,this),s}_write(e){e.writeTypeRef(GN),e.writeKey(this.hookName)}}const SN=t=>new nl(t.readKey());class il extends wi{get nextSibling(){const e=this._item?this._item.next:null;return e?e.content.type:null}get prevSibling(){const e=this._item?this._item.prev:null;return e?e.content.type:null}_copy(){return new il}clone(){const e=new il;return e.applyDelta(this.toDelta()),e}toDOM(e=document,r,n){const i=e.createTextNode(this.toString());return n!==void 0&&n._createAssociation(i,this),i}toString(){return this.toDelta().map(e=>{const r=[];for(const i in e.attributes){const s=[];for(const o in e.attributes[i])s.push({key:o,value:e.attributes[i][o]});s.sort((o,a)=>o.key<a.key?-1:1),r.push({nodeName:i,attrs:s})}r.sort((i,s)=>i.nodeName<s.nodeName?-1:1);let n="";for(let i=0;i<r.length;i++){const s=r[i];n+=`<${s.nodeName}`;for(let o=0;o<s.attrs.length;o++){const a=s.attrs[o];n+=` ${a.key}="${a.value}"`}n+=">"}n+=e.insert;for(let i=r.length-1;i>=0;i--)n+=`</${r[i].nodeName}>`;return n}).join("")}toJSON(){return this.toString()}_write(e){e.writeTypeRef(KN)}}const RN=t=>new il;class Uf{constructor(e,r){this.id=e,this.length=r}get deleted(){throw Yn()}mergeWith(e){return!1}write(e,r,n){throw Yn()}integrate(e,r){throw Yn()}}const ON=0;class dn extends Uf{get deleted(){return!0}delete(){}mergeWith(e){return this.constructor!==e.constructor?!1:(this.length+=e.length,!0)}integrate(e,r){r>0&&(this.id.clock+=r,this.length-=r),ky(e.doc.store,this)}write(e,r){e.writeInfo(ON),e.writeLen(this.length-r)}getMissing(e,r){return null}}class wa{constructor(e){this.content=e}getLength(){return 1}getContent(){return[this.content]}isCountable(){return!0}copy(){return new wa(this.content)}splice(e){throw Yn()}mergeWith(e){return!1}integrate(e,r){}delete(e){}gc(e){}write(e,r){e.writeBuf(this.content)}getRef(){return 3}}const IN=t=>new wa(t.readBuf());class ka{constructor(e){this.len=e}getLength(){return this.len}getContent(){return[]}isCountable(){return!1}copy(){return new ka(this.len)}splice(e){const r=new ka(this.len-e);return this.len=e,r}mergeWith(e){return this.len+=e.len,!0}integrate(e,r){Kc(e.deleteSet,r.id.client,r.id.clock,this.len),r.markDeleted()}delete(e){}gc(e){}write(e,r){e.writeLen(this.len-r)}getRef(){return 1}}const NN=t=>new ka(t.readLen()),qy=(t,e)=>new mo({guid:t,...e,shouldLoad:e.shouldLoad||e.autoLoad||!1});class va{constructor(e){e._item&&console.error("This document was already integrated as a sub-document. You should create a second instance instead with the same guid."),this.doc=e;const r={};this.opts=r,e.gc||(r.gc=!1),e.autoLoad&&(r.autoLoad=!0),e.meta!==null&&(r.meta=e.meta)}getLength(){return 1}getContent(){return[this.doc]}isCountable(){return!0}copy(){return new va(qy(this.doc.guid,this.opts))}splice(e){throw Yn()}mergeWith(e){return!1}integrate(e,r){this.doc._item=r,e.subdocsAdded.add(this.doc),this.doc.shouldLoad&&e.subdocsLoaded.add(this.doc)}delete(e){e.subdocsAdded.has(this.doc)?e.subdocsAdded.delete(this.doc):e.subdocsRemoved.add(this.doc)}gc(e){}write(e,r){e.writeString(this.doc.guid),e.writeAny(this.opts)}getRef(){return 9}}const CN=t=>new va(qy(t.readString(),t.readAny()));class vs{constructor(e){this.embed=e}getLength(){return 1}getContent(){return[this.embed]}isCountable(){return!0}copy(){return new vs(this.embed)}splice(e){throw Yn()}mergeWith(e){return!1}integrate(e,r){}delete(e){}gc(e){}write(e,r){e.writeJSON(this.embed)}getRef(){return 5}}const LN=t=>new vs(t.readJSON());class er{constructor(e,r){this.key=e,this.value=r}getLength(){return 1}getContent(){return[]}isCountable(){return!1}copy(){return new er(this.key,this.value)}splice(e){throw Yn()}mergeWith(e){return!1}integrate(e,r){const n=r.parent;n._searchMarker=null,n._hasFormatting=!0}delete(e){}gc(e){}write(e,r){e.writeKey(this.key),e.writeJSON(this.value)}getRef(){return 6}}const MN=t=>new er(t.readKey(),t.readJSON());class sl{constructor(e){this.arr=e}getLength(){return this.arr.length}getContent(){return this.arr}isCountable(){return!0}copy(){return new sl(this.arr)}splice(e){const r=new sl(this.arr.slice(e));return this.arr=this.arr.slice(0,e),r}mergeWith(e){return this.arr=this.arr.concat(e.arr),!0}integrate(e,r){}delete(e){}gc(e){}write(e,r){const n=this.arr.length;e.writeLen(n-r);for(let i=r;i<n;i++){const s=this.arr[i];e.writeString(s===void 0?"undefined":JSON.stringify(s))}}getRef(){return 2}}const UN=t=>{const e=t.readLen(),r=[];for(let n=0;n<e;n++){const i=t.readString();i==="undefined"?r.push(void 0):r.push(JSON.parse(i))}return new sl(r)},$N=Gc("node_env")==="development";class xs{constructor(e){this.arr=e,$N&&Jg(e)}getLength(){return this.arr.length}getContent(){return this.arr}isCountable(){return!0}copy(){return new xs(this.arr)}splice(e){const r=new xs(this.arr.slice(e));return this.arr=this.arr.slice(0,e),r}mergeWith(e){return this.arr=this.arr.concat(e.arr),!0}integrate(e,r){}delete(e){}gc(e){}write(e,r){const n=this.arr.length;e.writeLen(n-r);for(let i=r;i<n;i++){const s=this.arr[i];e.writeAny(s)}}getRef(){return 8}}const PN=t=>{const e=t.readLen(),r=[];for(let n=0;n<e;n++)r.push(t.readAny());return new xs(r)};class Qn{constructor(e){this.str=e}getLength(){return this.str.length}getContent(){return this.str.split("")}isCountable(){return!0}copy(){return new Qn(this.str)}splice(e){const r=new Qn(this.str.slice(e));this.str=this.str.slice(0,e);const n=this.str.charCodeAt(e-1);return n>=55296&&n<=56319&&(this.str=this.str.slice(0,e-1)+"�",r.str="�"+r.str.slice(1)),r}mergeWith(e){return this.str+=e.str,!0}integrate(e,r){}delete(e){}gc(e){}write(e,r){e.writeString(r===0?this.str:this.str.slice(r))}getRef(){return 4}}const BN=t=>new Qn(t.readString()),FN=[gN,_N,xN,AN,EN,SN,RN],DN=0,jN=1,zN=2,WN=3,HN=4,GN=5,KN=6;class ki{constructor(e){this.type=e}getLength(){return 1}getContent(){return[this.type]}isCountable(){return!0}copy(){return new ki(this.type._copy())}splice(e){throw Yn()}mergeWith(e){return!1}integrate(e,r){this.type._integrate(e.doc,r)}delete(e){let r=this.type._start;for(;r!==null;)r.deleted?r.id.clock<(e.beforeState.get(r.id.client)||0)&&e._mergeStructs.push(r):r.delete(e),r=r.right;this.type._map.forEach(n=>{n.deleted?n.id.clock<(e.beforeState.get(n.id.client)||0)&&e._mergeStructs.push(n):n.delete(e)}),e.changed.delete(this.type)}gc(e){let r=this.type._start;for(;r!==null;)r.gc(e,!0),r=r.right;this.type._start=null,this.type._map.forEach(n=>{for(;n!==null;)n.gc(e,!0),n=n.left}),this.type._map=new Map}write(e,r){this.type._write(e)}getRef(){return 7}}const qN=t=>new ki(FN[t.readTypeRef()](t)),ol=(t,e,r)=>{const{client:n,clock:i}=e.id,s=new tr(ot(n,i+r),e,ot(n,i+r-1),e.right,e.rightOrigin,e.parent,e.parentSub,e.content.splice(r));return e.deleted&&s.markDeleted(),e.keep&&(s.keep=!0),e.redone!==null&&(s.redone=ot(e.redone.client,e.redone.clock+r)),e.right=s,s.right!==null&&(s.right.left=s),t._mergeStructs.push(s),s.parentSub!==null&&s.right===null&&s.parent._map.set(s.parentSub,s),e.length=r,s};class tr extends Uf{constructor(e,r,n,i,s,o,a,c){super(e,c.getLength()),this.origin=n,this.left=r,this.right=i,this.rightOrigin=s,this.parent=o,this.parentSub=a,this.redone=null,this.content=c,this.info=this.content.isCountable()?Ug:0}set marker(e){(this.info&tf)>0!==e&&(this.info^=tf)}get marker(){return(this.info&tf)>0}get keep(){return(this.info&Mg)>0}set keep(e){this.keep!==e&&(this.info^=Mg)}get countable(){return(this.info&Ug)>0}get deleted(){return(this.info&ef)>0}set deleted(e){this.deleted!==e&&(this.info^=ef)}markDeleted(){this.info|=ef}getMissing(e,r){if(this.origin&&this.origin.client!==this.id.client&&this.origin.clock>=ar(r,this.origin.client))return this.origin.client;if(this.rightOrigin&&this.rightOrigin.client!==this.id.client&&this.rightOrigin.clock>=ar(r,this.rightOrigin.client))return this.rightOrigin.client;if(this.parent&&this.parent.constructor===yo&&this.id.client!==this.parent.client&&this.parent.clock>=ar(r,this.parent.client))return this.parent.client;if(this.origin&&(this.left=vy(e,r,this.origin),this.origin=this.left.lastId),this.rightOrigin&&(this.right=Gi(e,this.rightOrigin),this.rightOrigin=this.right.id),this.left&&this.left.constructor===dn||this.right&&this.right.constructor===dn)this.parent=null;else if(!this.parent)this.left&&this.left.constructor===tr?(this.parent=this.left.parent,this.parentSub=this.left.parentSub):this.right&&this.right.constructor===tr&&(this.parent=this.right.parent,this.parentSub=this.right.parentSub);else if(this.parent.constructor===yo){const n=Ef(r,this.parent);n.constructor===dn?this.parent=null:this.parent=n.content.type}return null}integrate(e,r){if(r>0&&(this.id.clock+=r,this.left=vy(e,e.doc.store,ot(this.id.client,this.id.clock-1)),this.origin=this.left.lastId,this.content=this.content.splice(r),this.length-=r),this.parent){if(!this.left&&(!this.right||this.right.left!==null)||this.left&&this.left.right!==this.right){let n=this.left,i;if(n!==null)i=n.right;else if(this.parentSub!==null)for(i=this.parent._map.get(this.parentSub)||null;i!==null&&i.left!==null;)i=i.left;else i=this.parent._start;const s=new Set,o=new Set;for(;i!==null&&i!==this.right;){if(o.add(i),s.add(i),qc(this.origin,i.origin)){if(i.id.client<this.id.client)n=i,s.clear();else if(qc(this.rightOrigin,i.rightOrigin))break}else if(i.origin!==null&&o.has(Ef(e.doc.store,i.origin)))s.has(Ef(e.doc.store,i.origin))||(n=i,s.clear());else break;i=i.right}this.left=n}if(this.left!==null){const n=this.left.right;this.right=n,this.left.right=this}else{let n;if(this.parentSub!==null)for(n=this.parent._map.get(this.parentSub)||null;n!==null&&n.left!==null;)n=n.left;else n=this.parent._start,this.parent._start=this;this.right=n}this.right!==null?this.right.left=this:this.parentSub!==null&&(this.parent._map.set(this.parentSub,this),this.left!==null&&this.left.delete(e)),this.parentSub===null&&this.countable&&!this.deleted&&(this.parent._length+=this.length),ky(e.doc.store,this),this.content.integrate(e,this),Ay(e,this.parent,this.parentSub),(this.parent._item!==null&&this.parent._item.deleted||this.parentSub!==null&&this.right!==null)&&this.delete(e)}else new dn(this.id,this.length).integrate(e,0)}get next(){let e=this.right;for(;e!==null&&e.deleted;)e=e.right;return e}get prev(){let e=this.left;for(;e!==null&&e.deleted;)e=e.left;return e}get lastId(){return this.length===1?this.id:ot(this.id.client,this.id.clock+this.length-1)}mergeWith(e){if(this.constructor===e.constructor&&qc(e.origin,this.lastId)&&this.right===e&&qc(this.rightOrigin,e.rightOrigin)&&this.id.client===e.id.client&&this.id.clock+this.length===e.id.clock&&this.deleted===e.deleted&&this.redone===null&&e.redone===null&&this.content.constructor===e.content.constructor&&this.content.mergeWith(e.content)){const r=this.parent._searchMarker;return r&&r.forEach(n=>{n.p===e&&(n.p=this,!this.deleted&&this.countable&&(n.index-=this.length))}),e.keep&&(this.keep=!0),this.right=e.right,this.right!==null&&(this.right.left=this),this.length+=e.length,!0}return!1}delete(e){if(!this.deleted){const r=this.parent;this.countable&&this.parentSub===null&&(r._length-=this.length),this.markDeleted(),Kc(e.deleteSet,this.id.client,this.id.clock,this.length),Ay(e,r,this.parentSub),this.content.delete(e)}}gc(e,r){if(!this.deleted)throw Vn();this.content.gc(e),r?JI(e,this,new dn(this.id,this.length)):this.content=new ka(this.length)}write(e,r){const n=r>0?ot(this.id.client,this.id.clock+r-1):this.origin,i=this.rightOrigin,s=this.parentSub,o=this.content.getRef()&Bc|(n===null?0:Zr)|(i===null?0:yi)|(s===null?0:la);if(e.writeInfo(o),n!==null&&e.writeLeftID(n),i!==null&&e.writeRightID(i),n===null&&i===null){const a=this.parent;if(a._item!==void 0){const c=a._item;if(c===null){const l=ZI(a);e.writeParentInfo(!0),e.writeString(l)}else e.writeParentInfo(!1),e.writeLeftID(c.id)}else a.constructor===String?(e.writeParentInfo(!0),e.writeString(a)):a.constructor===yo?(e.writeParentInfo(!1),e.writeLeftID(a)):Vn();s!==null&&e.writeString(s)}this.content.write(e,r)}}const Yy=(t,e)=>YN[e&Bc](t),YN=[()=>{Vn()},NN,UN,IN,BN,LN,MN,qN,PN,CN,()=>{Vn()}],VN=10;class pn extends Uf{get deleted(){return!0}delete(){}mergeWith(e){return this.constructor!==e.constructor?!1:(this.length+=e.length,!0)}integrate(e,r){Vn()}write(e,r){e.writeInfo(VN),ht(e.restEncoder,this.length-r)}getMissing(e,r){return null}}const Vy=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof oo<"u"?oo:{},Xy="__ $YJS$ __";Vy[Xy]===!0&&console.error("Yjs was already imported. This breaks constructor checks and will lead to issues! - https://github.com/yjs/yjs/issues/438"),Vy[Xy]=!0;let Zy=!1;const en=new mo;function Jy(t,e,r){const n=en.getMap();if(!n.has(t))switch(e){case 0:case 1:n.set(t,r);break}}function XN(t,e){Jy(t,0,e)}function $f(t,e){const r=new wi(e);Jy(t,1,r)}function ZN(t,e){en.getMap().set(t,e)}function JN(t,e){const r=en.getMap(),n=new wi(e);r.set(t,n)}function Qy(t,e){const r=en.getMap();function n(i){const s=r.get(t);for(let o=0;o<i.length;++o)(i[o].target===r||i[o].target===s)&&e(s)}return r.has(t)&&e(r.get(t)),r.observeDeep(n),()=>{r.observeDeep(n)}}function QN(t,e){return Qy(t,r=>{Ae(r)&&e(r)})}function e_(t,e){return Qy(t,r=>{r instanceof wi&&e(r.toJSON())})}const Es=io("modem",["second"],t=>{if(Es.session(t))switch(t.target){case"second":!Zy&&t.data%2===0&&Es.emit(t.player,"modem:join");break;case"join":t.sender!==Es.id()&&Es.reply(t,"joinack",Rg(YI(en)));break;case"joinack":t.sender!==Es.id()&&(Zy=!0,py(en,Uc(t.data),en));break;case"sync":{t.sender!==Es.id()&&w(t.data)&&py(en,Uc(t.data),en);break}}});function t_(t,e){e!==en&&Es.emit("","modem:sync",Rg(t))}en.on("update",t_),en.on("destroy",()=>{en.off("update",t_)});function r_(t,e){return t%e}function n_(t,e){return Math.floor(t/e)}function eC(t,e){return{x:r_(t,e),y:n_(t,e)}}function i_(t,e){const r=t.x-e.x,n=t.y-e.y;return Math.sqrt(r*r+n*n)}function tn(t,e){return t.x+t.y*e}function xo(t,e){return`${t.x},${t.y},${e.x},${e.y}`}function Pf(t,e,r,n,i,s){return t>=s&&t<=n&&e>=r&&e<=i}function s_(t,e,r,n){const i=[],s=Math.min(t,r),o=Math.max(t,r),a=Math.min(e,n),c=Math.max(e,n);for(let l=a;l<=c;++l)for(let u=s;u<=o;++u)i.push({x:u,y:l});return i}function o_(t,e,r,n){const i=[],s=Math.abs(r-t),o=Math.abs(n-e),a=t<r?1:-1,c=e<n?1:-1;let l=s-o;for(i.push({x:t,y:e});t!==r||e!==n;){const u=2*l;u>-o&&(l-=o,t+=a),u<s&&(l+=s,e+=c),i.push({x:t,y:e})}return i}/**
 * @license
 * Copyright 2010-2025 Three.js Authors
 * SPDX-License-Identifier: MIT
 */const a_="176",tC="",In="srgb",c_="srgb-linear",l_="linear",Bf="srgb";function Nn(t,e,r){return Math.max(e,Math.min(r,t))}function rC(t,e){return(t%e+e)%e}function Ff(t,e,r){return(1-r)*t+r*e}class xa{constructor(e=0,r=0){xa.prototype.isVector2=!0,this.x=e,this.y=r}get width(){return this.x}set width(e){this.x=e}get height(){return this.y}set height(e){this.y=e}set(e,r){return this.x=e,this.y=r,this}setScalar(e){return this.x=e,this.y=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setComponent(e,r){switch(e){case 0:this.x=r;break;case 1:this.y=r;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y)}copy(e){return this.x=e.x,this.y=e.y,this}add(e){return this.x+=e.x,this.y+=e.y,this}addScalar(e){return this.x+=e,this.y+=e,this}addVectors(e,r){return this.x=e.x+r.x,this.y=e.y+r.y,this}addScaledVector(e,r){return this.x+=e.x*r,this.y+=e.y*r,this}sub(e){return this.x-=e.x,this.y-=e.y,this}subScalar(e){return this.x-=e,this.y-=e,this}subVectors(e,r){return this.x=e.x-r.x,this.y=e.y-r.y,this}multiply(e){return this.x*=e.x,this.y*=e.y,this}multiplyScalar(e){return this.x*=e,this.y*=e,this}divide(e){return this.x/=e.x,this.y/=e.y,this}divideScalar(e){return this.multiplyScalar(1/e)}applyMatrix3(e){const r=this.x,n=this.y,i=e.elements;return this.x=i[0]*r+i[3]*n+i[6],this.y=i[1]*r+i[4]*n+i[7],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this}clamp(e,r){return this.x=Nn(this.x,e.x,r.x),this.y=Nn(this.y,e.y,r.y),this}clampScalar(e,r){return this.x=Nn(this.x,e,r),this.y=Nn(this.y,e,r),this}clampLength(e,r){const n=this.length();return this.divideScalar(n||1).multiplyScalar(Nn(n,e,r))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(e){return this.x*e.x+this.y*e.y}cross(e){return this.x*e.y-this.y*e.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}angleTo(e){const r=Math.sqrt(this.lengthSq()*e.lengthSq());if(r===0)return Math.PI/2;const n=this.dot(e)/r;return Math.acos(Nn(n,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const r=this.x-e.x,n=this.y-e.y;return r*r+n*n}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,r){return this.x+=(e.x-this.x)*r,this.y+=(e.y-this.y)*r,this}lerpVectors(e,r,n){return this.x=e.x+(r.x-e.x)*n,this.y=e.y+(r.y-e.y)*n,this}equals(e){return e.x===this.x&&e.y===this.y}fromArray(e,r=0){return this.x=e[r],this.y=e[r+1],this}toArray(e=[],r=0){return e[r]=this.x,e[r+1]=this.y,e}fromBufferAttribute(e,r){return this.x=e.getX(r),this.y=e.getY(r),this}rotateAround(e,r){const n=Math.cos(r),i=Math.sin(r),s=this.x-e.x,o=this.y-e.y;return this.x=s*n-o*i+e.x,this.y=s*i+o*n+e.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}}class Ea{constructor(e,r,n,i,s,o,a,c,l){Ea.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1],e!==void 0&&this.set(e,r,n,i,s,o,a,c,l)}set(e,r,n,i,s,o,a,c,l){const u=this.elements;return u[0]=e,u[1]=i,u[2]=a,u[3]=r,u[4]=s,u[5]=c,u[6]=n,u[7]=o,u[8]=l,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(e){const r=this.elements,n=e.elements;return r[0]=n[0],r[1]=n[1],r[2]=n[2],r[3]=n[3],r[4]=n[4],r[5]=n[5],r[6]=n[6],r[7]=n[7],r[8]=n[8],this}extractBasis(e,r,n){return e.setFromMatrix3Column(this,0),r.setFromMatrix3Column(this,1),n.setFromMatrix3Column(this,2),this}setFromMatrix4(e){const r=e.elements;return this.set(r[0],r[4],r[8],r[1],r[5],r[9],r[2],r[6],r[10]),this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,r){const n=e.elements,i=r.elements,s=this.elements,o=n[0],a=n[3],c=n[6],l=n[1],u=n[4],h=n[7],f=n[2],d=n[5],m=n[8],p=i[0],g=i[3],y=i[6],_=i[1],A=i[4],T=i[7],x=i[2],M=i[5],R=i[8];return s[0]=o*p+a*_+c*x,s[3]=o*g+a*A+c*M,s[6]=o*y+a*T+c*R,s[1]=l*p+u*_+h*x,s[4]=l*g+u*A+h*M,s[7]=l*y+u*T+h*R,s[2]=f*p+d*_+m*x,s[5]=f*g+d*A+m*M,s[8]=f*y+d*T+m*R,this}multiplyScalar(e){const r=this.elements;return r[0]*=e,r[3]*=e,r[6]*=e,r[1]*=e,r[4]*=e,r[7]*=e,r[2]*=e,r[5]*=e,r[8]*=e,this}determinant(){const e=this.elements,r=e[0],n=e[1],i=e[2],s=e[3],o=e[4],a=e[5],c=e[6],l=e[7],u=e[8];return r*o*u-r*a*l-n*s*u+n*a*c+i*s*l-i*o*c}invert(){const e=this.elements,r=e[0],n=e[1],i=e[2],s=e[3],o=e[4],a=e[5],c=e[6],l=e[7],u=e[8],h=u*o-a*l,f=a*c-u*s,d=l*s-o*c,m=r*h+n*f+i*d;if(m===0)return this.set(0,0,0,0,0,0,0,0,0);const p=1/m;return e[0]=h*p,e[1]=(i*l-u*n)*p,e[2]=(a*n-i*o)*p,e[3]=f*p,e[4]=(u*r-i*c)*p,e[5]=(i*s-a*r)*p,e[6]=d*p,e[7]=(n*c-l*r)*p,e[8]=(o*r-n*s)*p,this}transpose(){let e;const r=this.elements;return e=r[1],r[1]=r[3],r[3]=e,e=r[2],r[2]=r[6],r[6]=e,e=r[5],r[5]=r[7],r[7]=e,this}getNormalMatrix(e){return this.setFromMatrix4(e).invert().transpose()}transposeIntoArray(e){const r=this.elements;return e[0]=r[0],e[1]=r[3],e[2]=r[6],e[3]=r[1],e[4]=r[4],e[5]=r[7],e[6]=r[2],e[7]=r[5],e[8]=r[8],this}setUvTransform(e,r,n,i,s,o,a){const c=Math.cos(s),l=Math.sin(s);return this.set(n*c,n*l,-n*(c*o+l*a)+o+e,-i*l,i*c,-i*(-l*o+c*a)+a+r,0,0,1),this}scale(e,r){return this.premultiply(Df.makeScale(e,r)),this}rotate(e){return this.premultiply(Df.makeRotation(-e)),this}translate(e,r){return this.premultiply(Df.makeTranslation(e,r)),this}makeTranslation(e,r){return e.isVector2?this.set(1,0,e.x,0,1,e.y,0,0,1):this.set(1,0,e,0,1,r,0,0,1),this}makeRotation(e){const r=Math.cos(e),n=Math.sin(e);return this.set(r,-n,0,n,r,0,0,0,1),this}makeScale(e,r){return this.set(e,0,0,0,r,0,0,0,1),this}equals(e){const r=this.elements,n=e.elements;for(let i=0;i<9;i++)if(r[i]!==n[i])return!1;return!0}fromArray(e,r=0){for(let n=0;n<9;n++)this.elements[n]=e[n+r];return this}toArray(e=[],r=0){const n=this.elements;return e[r]=n[0],e[r+1]=n[1],e[r+2]=n[2],e[r+3]=n[3],e[r+4]=n[4],e[r+5]=n[5],e[r+6]=n[6],e[r+7]=n[7],e[r+8]=n[8],e}clone(){return new this.constructor().fromArray(this.elements)}}const Df=new Ea,u_=new Ea().set(.4123908,.3575843,.1804808,.212639,.7151687,.0721923,.0193308,.1191948,.9505322),h_=new Ea().set(3.2409699,-1.5373832,-.4986108,-.9692436,1.8759675,.0415551,.0556301,-.203977,1.0569715);function nC(){const t={enabled:!0,workingColorSpace:c_,spaces:{},convert:function(i,s,o){return this.enabled===!1||s===o||!s||!o||(this.spaces[s].transfer===Bf&&(i.r=Eo(i.r),i.g=Eo(i.g),i.b=Eo(i.b)),this.spaces[s].primaries!==this.spaces[o].primaries&&(i.applyMatrix3(this.spaces[s].toXYZ),i.applyMatrix3(this.spaces[o].fromXYZ)),this.spaces[o].transfer===Bf&&(i.r=Ao(i.r),i.g=Ao(i.g),i.b=Ao(i.b))),i},fromWorkingColorSpace:function(i,s){return this.convert(i,this.workingColorSpace,s)},toWorkingColorSpace:function(i,s){return this.convert(i,s,this.workingColorSpace)},getPrimaries:function(i){return this.spaces[i].primaries},getTransfer:function(i){return i===tC?l_:this.spaces[i].transfer},getLuminanceCoefficients:function(i,s=this.workingColorSpace){return i.fromArray(this.spaces[s].luminanceCoefficients)},define:function(i){Object.assign(this.spaces,i)},_getMatrix:function(i,s,o){return i.copy(this.spaces[s].toXYZ).multiply(this.spaces[o].fromXYZ)},_getDrawingBufferColorSpace:function(i){return this.spaces[i].outputColorSpaceConfig.drawingBufferColorSpace},_getUnpackColorSpace:function(i=this.workingColorSpace){return this.spaces[i].workingColorSpaceConfig.unpackColorSpace}},e=[.64,.33,.3,.6,.15,.06],r=[.2126,.7152,.0722],n=[.3127,.329];return t.define({[c_]:{primaries:e,whitePoint:n,transfer:l_,toXYZ:u_,fromXYZ:h_,luminanceCoefficients:r,workingColorSpaceConfig:{unpackColorSpace:In},outputColorSpaceConfig:{drawingBufferColorSpace:In}},[In]:{primaries:e,whitePoint:n,transfer:Bf,toXYZ:u_,fromXYZ:h_,luminanceCoefficients:r,outputColorSpaceConfig:{drawingBufferColorSpace:In}}}),t}const Cn=nC();function Eo(t){return t<.04045?t*.0773993808:Math.pow(t*.9478672986+.0521327014,2.4)}function Ao(t){return t<.0031308?t*12.92:1.055*Math.pow(t,.41666)-.055}const f_={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},Yi={h:0,s:0,l:0},al={h:0,s:0,l:0};function jf(t,e,r){return r<0&&(r+=1),r>1&&(r-=1),r<1/6?t+(e-t)*6*r:r<1/2?e:r<2/3?t+(e-t)*6*(2/3-r):t}class cl{constructor(e,r,n){return this.isColor=!0,this.r=1,this.g=1,this.b=1,this.set(e,r,n)}set(e,r,n){if(r===void 0&&n===void 0){const i=e;i&&i.isColor?this.copy(i):typeof i=="number"?this.setHex(i):typeof i=="string"&&this.setStyle(i)}else this.setRGB(e,r,n);return this}setScalar(e){return this.r=e,this.g=e,this.b=e,this}setHex(e,r=In){return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(e&255)/255,Cn.toWorkingColorSpace(this,r),this}setRGB(e,r,n,i=Cn.workingColorSpace){return this.r=e,this.g=r,this.b=n,Cn.toWorkingColorSpace(this,i),this}setHSL(e,r,n,i=Cn.workingColorSpace){if(e=rC(e,1),r=Nn(r,0,1),n=Nn(n,0,1),r===0)this.r=this.g=this.b=n;else{const s=n<=.5?n*(1+r):n+r-n*r,o=2*n-s;this.r=jf(o,s,e+1/3),this.g=jf(o,s,e),this.b=jf(o,s,e-1/3)}return Cn.toWorkingColorSpace(this,i),this}setStyle(e,r=In){function n(s){s!==void 0&&parseFloat(s)<1&&console.warn("THREE.Color: Alpha component of "+e+" will be ignored.")}let i;if(i=/^(\w+)\(([^\)]*)\)/.exec(e)){let s;const o=i[1],a=i[2];switch(o){case"rgb":case"rgba":if(s=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))return n(s[4]),this.setRGB(Math.min(255,parseInt(s[1],10))/255,Math.min(255,parseInt(s[2],10))/255,Math.min(255,parseInt(s[3],10))/255,r);if(s=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))return n(s[4]),this.setRGB(Math.min(100,parseInt(s[1],10))/100,Math.min(100,parseInt(s[2],10))/100,Math.min(100,parseInt(s[3],10))/100,r);break;case"hsl":case"hsla":if(s=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))return n(s[4]),this.setHSL(parseFloat(s[1])/360,parseFloat(s[2])/100,parseFloat(s[3])/100,r);break;default:console.warn("THREE.Color: Unknown color model "+e)}}else if(i=/^\#([A-Fa-f\d]+)$/.exec(e)){const s=i[1],o=s.length;if(o===3)return this.setRGB(parseInt(s.charAt(0),16)/15,parseInt(s.charAt(1),16)/15,parseInt(s.charAt(2),16)/15,r);if(o===6)return this.setHex(parseInt(s,16),r);console.warn("THREE.Color: Invalid hex color "+e)}else if(e&&e.length>0)return this.setColorName(e,r);return this}setColorName(e,r=In){const n=f_[e.toLowerCase()];return n!==void 0?this.setHex(n,r):console.warn("THREE.Color: Unknown color "+e),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(e){return this.r=e.r,this.g=e.g,this.b=e.b,this}copySRGBToLinear(e){return this.r=Eo(e.r),this.g=Eo(e.g),this.b=Eo(e.b),this}copyLinearToSRGB(e){return this.r=Ao(e.r),this.g=Ao(e.g),this.b=Ao(e.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(e=In){return Cn.fromWorkingColorSpace(xr.copy(this),e),Math.round(Nn(xr.r*255,0,255))*65536+Math.round(Nn(xr.g*255,0,255))*256+Math.round(Nn(xr.b*255,0,255))}getHexString(e=In){return("000000"+this.getHex(e).toString(16)).slice(-6)}getHSL(e,r=Cn.workingColorSpace){Cn.fromWorkingColorSpace(xr.copy(this),r);const n=xr.r,i=xr.g,s=xr.b,o=Math.max(n,i,s),a=Math.min(n,i,s);let c,l;const u=(a+o)/2;if(a===o)c=0,l=0;else{const h=o-a;switch(l=u<=.5?h/(o+a):h/(2-o-a),o){case n:c=(i-s)/h+(i<s?6:0);break;case i:c=(s-n)/h+2;break;case s:c=(n-i)/h+4;break}c/=6}return e.h=c,e.s=l,e.l=u,e}getRGB(e,r=Cn.workingColorSpace){return Cn.fromWorkingColorSpace(xr.copy(this),r),e.r=xr.r,e.g=xr.g,e.b=xr.b,e}getStyle(e=In){Cn.fromWorkingColorSpace(xr.copy(this),e);const r=xr.r,n=xr.g,i=xr.b;return e!==In?`color(${e} ${r.toFixed(3)} ${n.toFixed(3)} ${i.toFixed(3)})`:`rgb(${Math.round(r*255)},${Math.round(n*255)},${Math.round(i*255)})`}offsetHSL(e,r,n){return this.getHSL(Yi),this.setHSL(Yi.h+e,Yi.s+r,Yi.l+n)}add(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this}addColors(e,r){return this.r=e.r+r.r,this.g=e.g+r.g,this.b=e.b+r.b,this}addScalar(e){return this.r+=e,this.g+=e,this.b+=e,this}sub(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this}multiply(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this}multiplyScalar(e){return this.r*=e,this.g*=e,this.b*=e,this}lerp(e,r){return this.r+=(e.r-this.r)*r,this.g+=(e.g-this.g)*r,this.b+=(e.b-this.b)*r,this}lerpColors(e,r,n){return this.r=e.r+(r.r-e.r)*n,this.g=e.g+(r.g-e.g)*n,this.b=e.b+(r.b-e.b)*n,this}lerpHSL(e,r){this.getHSL(Yi),e.getHSL(al);const n=Ff(Yi.h,al.h,r),i=Ff(Yi.s,al.s,r),s=Ff(Yi.l,al.l,r);return this.setHSL(n,i,s),this}setFromVector3(e){return this.r=e.x,this.g=e.y,this.b=e.z,this}applyMatrix3(e){const r=this.r,n=this.g,i=this.b,s=e.elements;return this.r=s[0]*r+s[3]*n+s[6]*i,this.g=s[1]*r+s[4]*n+s[7]*i,this.b=s[2]*r+s[5]*n+s[8]*i,this}equals(e){return e.r===this.r&&e.g===this.g&&e.b===this.b}fromArray(e,r=0){return this.r=e[r],this.g=e[r+1],this.b=e[r+2],this}toArray(e=[],r=0){return e[r]=this.r,e[r+1]=this.g,e[r+2]=this.b,e}fromBufferAttribute(e,r){return this.r=e.getX(r),this.g=e.getY(r),this.b=e.getZ(r),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}}const xr=new cl;cl.NAMES=f_,typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:a_}})),typeof window<"u"&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=a_),new xa,new xa;function jt(t,e,r){return Math.max(e,Math.min(r,t))}function d_(t){return t/180*Math.PI}function p_(t){return t*180/Math.PI}const iC=Hm("089fad0j9awfem09wavefc09uwaef");function sC(){return iC()}function oC(t){return Hm(t)()}function rn(t,e){const r=Math.min(t,e),i=Math.max(t,e)-r+1;return r+Math.floor(sC()*i)}function m_(t,e,r){const n=Math.min(e,r),s=Math.max(e,r)-n+1;return n+Math.floor(oC(t)*s)}function zf(t,e,r){typeof t!="number"&&(t=0,e=0,r=1),typeof e!="number"&&(e=t,t=0,r=1),typeof r!="number"&&(r=1);const n=[],i=Math.min(t,e),s=Math.max(t,e);for(let o=i;o<=s;o+=r)n.push(o);return n}function aC(t){return t[rn(0,t.length-1)]}function cC(t,e){return e[m_(t,0,e.length-1)]}function mn(...t){return aC(t.flat())}function lC(t,...e){return cC(t,e.flat())}function uC(t){return[...new Set(t)].filter(w)}function As(t){return w(t)&&w(t.x)&&w(t.y)}function Mt(t,e){switch(e){case ve.NORTH:--t.y;break;case ve.SOUTH:++t.y;break;case ve.WEST:--t.x;break;case ve.EAST:++t.x;break}return t}function Wf(t,e){return t<0?ve.WEST:t>0?ve.EAST:e<0?ve.NORTH:e>0?ve.SOUTH:ve.IDLE}function Ln(t,e){return Wf(e.x-t.x,e.y-t.y)}const Hf={idle:"IDLE",up:"NORTH",down:"SOUTH",left:"WEST",right:"EAST",by:"BY",at:"AT",flow:"FLOW",seek:"SEEK",rndns:"RNDNS",rndne:"RNDNE",rnd:"RND",cw:"CW",ccw:"CCW",opp:"OPP",rndp:"RNDP",away:"AWAY",toward:"TOWARD",find:"FIND",flee:"FLEE",to:"TO",i:"IDLE",u:"NORTH",north:"NORTH",n:"NORTH",d:"SOUTH",south:"SOUTH",s:"SOUTH",l:"WEST",west:"WEST",w:"WEST",r:"EAST",east:"EAST",e:"EAST",over:"OVER",under:"UNDER",within:"WITHIN",awayby:"AWAYBY"};function nn(t){return ut(t)&&g_(t[0])}function g_(t){return w(ve[t])&&ye(t)}function y_(t){const e=ve[t];return w(e)?e:ve.IDLE}function ll(t){if(ye(t))return Hf[Fe(t)]}function hC(t){if(nn(t))return t;if(g_(t))return[t];const e=ll(t);if(w(e))return[e]}function __(t){const e=E.words[t],r=hC(e);return nn(r)?[r,t+1]:[void 0,t]}function b_(t){const e=[];let[r,n]=__(t);for(;nn(r);){switch(e.push(...r),r[0]){case"AT":case"BY":case"AWAY":case"TOWARD":{const[a,c,l]=ue(E.words,n,[V.NUMBER,V.NUMBER]);e.push(a,c),n=l;break}case"FLEE":case"FIND":{const[a,c]=ue(E.words,n,[V.KIND]);console.info("kind",a),n=c;break}case"TO":{const[a,c,l]=ue(E.words,n,[V.DIR,V.DIR]),u=E.element?.x??0,h=E.element?.y??0;a.destpt.x-=u,a.destpt.y-=h,c.destpt.x-=u,c.destpt.y-=h,e.push(u+a.destpt.x+c.destpt.x,h+a.destpt.y+c.destpt.y),n=l;break}case"WITHIN":case"AWAYBY":{const[a,c]=ue(E.words,n,[V.NUMBER]);e.push(a),n=c;break}}const i=n;switch(r[0]){case"CW":case"CCW":case"OPP":case"RNDP":case"OVER":case"UNDER":case"WITHIN":case"AWAYBY":break;default:return[e,n]}const[s,o]=__(i);r=s,n=o}return e.length?[e,n]:[void 0,t]}function fC(t){if(w(t)&&(t<Je.ONBLACK||t>Je.ONCLEAR))return t}function Gf(t){return w(t)&&t>Je.WHITE&&t<Je.ONCLEAR?t-Je.ONBLACK:void 0}const Aa={black:"BLACK",dkblue:"DKBLUE",dkgreen:"DKGREEN",dkcyan:"DKCYAN",dkred:"DKRED",dkpurple:"DKPURPLE",dkyellow:"DKYELLOW",ltgray:"LTGRAY",dkgray:"DKGRAY",blue:"BLUE",green:"GREEN",cyan:"CYAN",red:"RED",purple:"PURPLE",yellow:"YELLOW",white:"WHITE",brown:"DKYELLOW",dkwhite:"LTGRAY",ltgrey:"LTGRAY",gray:"LTGRAY",grey:"LTGRAY",dkgrey:"DKGRAY",ltblack:"DKGRAY",onblack:"ONBLACK",ondkblue:"ONDKBLUE",ondkgreen:"ONDKGREEN",ondkcyan:"ONDKCYAN",ondkred:"ONDKRED",ondkpurple:"ONDKPURPLE",ondkyellow:"ONDKYELLOW",onltgray:"ONLTGRAY",ondkgray:"ONDKGRAY",onblue:"ONBLUE",ongreen:"ONGREEN",oncyan:"ONCYAN",onred:"ONRED",onpurple:"ONPURPLE",onyellow:"ONYELLOW",onwhite:"ONWHITE",onbrown:"ONDKYELLOW",ondkwhite:"ONLTGRAY",onltgrey:"ONLTGRAY",ongray:"ONLTGRAY",ongrey:"ONLTGRAY",ondkgrey:"ONDKGRAY",onltblack:"ONDKGRAY",onclear:"ONCLEAR",blblack:"BLBLACK",bldkblue:"BLDKBLUE",bldkgreen:"BLDKGREEN",bldkcyan:"BLDKCYAN",bldkred:"BLDKRED",bldkpurple:"BLDKPURPLE",bldkyellow:"BLDKYELLOW",blltgray:"BLLTGRAY",bldkgray:"BLDKGRAY",blblue:"BLBLUE",blgreen:"BLGREEN",blcyan:"BLCYAN",blred:"BLRED",blpurple:"BLPURPLE",blyellow:"BLYELLOW",blwhite:"BLWHITE",blbrown:"BLDKYELLOW",bldkwhite:"BLLTGRAY",blltgrey:"BLLTGRAY",blgray:"BLLTGRAY",blgrey:"BLLTGRAY",bldkgrey:"BLDKGRAY",blltblack:"BLDKGRAY"};function Sr(t){return ut(t)&&w_(t[0])}function dC(t){return Sr(t)&&t[0].startsWith("ON")}function w_(t){return w(Je[t])&&ye(t)}function Ta(t){if(ye(t))return Aa[Fe(t)]}function To(t,e){return[w(t)?`${Je[t]}`:void 0,w(e)?`ON${Je[e]}`:void 0].filter(w)}function ul(t){return t.map(e=>Je[e]).find(e=>w(e)&&e<Je.ONBLACK)}function hl(t){return t.map(e=>Je[e]).find(e=>w(e)&&e>=Je.ONBLACK)}function pC(t){if(Sr(t))return t;if(w_(t))return[t];const e=Ta(t);if(w(e))return[e]}function k_(t){const e=E.words[t],r=pC(e);return Sr(r)?[r,t+1]:[void 0,t]}function fl(t){const e=[];let r=t;const n=parseFloat(E.words[t]);if(Ae(n))return[To(n,void 0),t+1];const[i,s]=k_(t);Sr(i)&&(e.push(...i),r=s);const[o,a]=k_(s);return dC(o)&&(e.push(...o),r=a),e.length?[e,r]:[void 0,t]}function v_(t){const e={};for(let r=0;r<t.length;++r){const n=t[r],i=Je[n];w(i)&&(i<Je.ONBLACK?e.color=i:e.bg=Gf(i))}return e}var dl={exports:{}},pl={exports:{}},mC=pl.exports,x_;function gC(){return x_||(x_=1,(function(t,e){(function(r,n){t.exports=n()})(mC,function(){function r(p){return!isNaN(parseFloat(p))&&isFinite(p)}function n(p){return p.charAt(0).toUpperCase()+p.substring(1)}function i(p){return function(){return this[p]}}var s=["isConstructor","isEval","isNative","isToplevel"],o=["columnNumber","lineNumber"],a=["fileName","functionName","source"],c=["args"],l=["evalOrigin"],u=s.concat(o,a,c,l);function h(p){if(p)for(var g=0;g<u.length;g++)p[u[g]]!==void 0&&this["set"+n(u[g])](p[u[g]])}h.prototype={getArgs:function(){return this.args},setArgs:function(p){if(Object.prototype.toString.call(p)!=="[object Array]")throw new TypeError("Args must be an Array");this.args=p},getEvalOrigin:function(){return this.evalOrigin},setEvalOrigin:function(p){if(p instanceof h)this.evalOrigin=p;else if(p instanceof Object)this.evalOrigin=new h(p);else throw new TypeError("Eval Origin must be an Object or StackFrame")},toString:function(){var p=this.getFileName()||"",g=this.getLineNumber()||"",y=this.getColumnNumber()||"",_=this.getFunctionName()||"";return this.getIsEval()?p?"[eval] ("+p+":"+g+":"+y+")":"[eval]:"+g+":"+y:_?_+" ("+p+":"+g+":"+y+")":p+":"+g+":"+y}},h.fromString=function(g){var y=g.indexOf("("),_=g.lastIndexOf(")"),A=g.substring(0,y),T=g.substring(y+1,_).split(","),x=g.substring(_+1);if(x.indexOf("@")===0)var M=/@(.+?)(?::(\d+))?(?::(\d+))?$/.exec(x,""),R=M[1],P=M[2],W=M[3];return new h({functionName:A,args:T||void 0,fileName:R,lineNumber:P||void 0,columnNumber:W||void 0})};for(var f=0;f<s.length;f++)h.prototype["get"+n(s[f])]=i(s[f]),h.prototype["set"+n(s[f])]=(function(p){return function(g){this[p]=!!g}})(s[f]);for(var d=0;d<o.length;d++)h.prototype["get"+n(o[d])]=i(o[d]),h.prototype["set"+n(o[d])]=(function(p){return function(g){if(!r(g))throw new TypeError(p+" must be a Number");this[p]=Number(g)}})(o[d]);for(var m=0;m<a.length;m++)h.prototype["get"+n(a[m])]=i(a[m]),h.prototype["set"+n(a[m])]=(function(p){return function(g){this[p]=String(g)}})(a[m]);return h})})(pl)),pl.exports}var yC=dl.exports,E_;function _C(){return E_||(E_=1,(function(t,e){(function(r,n){t.exports=n(gC())})(yC,function(n){var i=/(^|@)\S+:\d+/,s=/^\s*at .*(\S+:\d+|\(native\))/m,o=/^(eval@)?(\[native code])?$/;return{parse:function(c){if(typeof c.stacktrace<"u"||typeof c["opera#sourceloc"]<"u")return this.parseOpera(c);if(c.stack&&c.stack.match(s))return this.parseV8OrIE(c);if(c.stack)return this.parseFFOrSafari(c);throw new Error("Cannot parse given Error object")},extractLocation:function(c){if(c.indexOf(":")===-1)return[c];var l=/(.+?)(?::(\d+))?(?::(\d+))?$/,u=l.exec(c.replace(/[()]/g,""));return[u[1],u[2]||void 0,u[3]||void 0]},parseV8OrIE:function(c){var l=c.stack.split(`
`).filter(function(u){return!!u.match(s)},this);return l.map(function(u){u.indexOf("(eval ")>-1&&(u=u.replace(/eval code/g,"eval").replace(/(\(eval at [^()]*)|(,.*$)/g,""));var h=u.replace(/^\s+/,"").replace(/\(eval code/g,"(").replace(/^.*?\s+/,""),f=h.match(/ (\(.+\)$)/);h=f?h.replace(f[0],""):h;var d=this.extractLocation(f?f[1]:h),m=f&&h||void 0,p=["eval","<anonymous>"].indexOf(d[0])>-1?void 0:d[0];return new n({functionName:m,fileName:p,lineNumber:d[1],columnNumber:d[2],source:u})},this)},parseFFOrSafari:function(c){var l=c.stack.split(`
`).filter(function(u){return!u.match(o)},this);return l.map(function(u){if(u.indexOf(" > eval")>-1&&(u=u.replace(/ line (\d+)(?: > eval line \d+)* > eval:\d+:\d+/g,":$1")),u.indexOf("@")===-1&&u.indexOf(":")===-1)return new n({functionName:u});var h=/((.*".+"[^@]*)?[^@]*)(?:@)/,f=u.match(h),d=f&&f[1]?f[1]:void 0,m=this.extractLocation(u.replace(h,""));return new n({functionName:d,fileName:m[0],lineNumber:m[1],columnNumber:m[2],source:u})},this)},parseOpera:function(c){return!c.stacktrace||c.message.indexOf(`
`)>-1&&c.message.split(`
`).length>c.stacktrace.split(`
`).length?this.parseOpera9(c):c.stack?this.parseOpera11(c):this.parseOpera10(c)},parseOpera9:function(c){for(var l=/Line (\d+).*script (?:in )?(\S+)/i,u=c.message.split(`
`),h=[],f=2,d=u.length;f<d;f+=2){var m=l.exec(u[f]);m&&h.push(new n({fileName:m[2],lineNumber:m[1],source:u[f]}))}return h},parseOpera10:function(c){for(var l=/Line (\d+).*script (?:in )?(\S+)(?:: In function (\S+))?$/i,u=c.stacktrace.split(`
`),h=[],f=0,d=u.length;f<d;f+=2){var m=l.exec(u[f]);m&&h.push(new n({functionName:m[3]||void 0,fileName:m[2],lineNumber:m[1],source:u[f]}))}return h},parseOpera11:function(c){var l=c.stack.split(`
`).filter(function(u){return!!u.match(i)&&!u.match(/^Error created at/)},this);return l.map(function(u){var h=u.split("@"),f=this.extractLocation(h.pop()),d=h.shift()||"",m=d.replace(/<anonymous function(: (\w+))?>/,"$2").replace(/\([^)]*\)/g,"")||void 0,p;d.match(/\(([^)]*)\)/)&&(p=d.replace(/^[^(]+\(([^)]*)\)$/,"$1"));var g=p===void 0||p==="[arguments not available]"?void 0:p.split(",");return new n({functionName:m,args:g,fileName:f[0],lineNumber:f[1],columnNumber:f[2],source:u})},this)}}})})(dl)),dl.exports}var bC=_C(),wC=fs(bC);const Ue=60,nt=25,Kf=Ue*nt;var Re=(t=>(t[t.ERROR=0]="ERROR",t[t.LOADER=1]="LOADER",t[t.BOARD=2]="BOARD",t[t.OBJECT=3]="OBJECT",t[t.TERRAIN=4]="TERRAIN",t[t.CHARSET=5]="CHARSET",t[t.PALETTE=6]="PALETTE",t))(Re||{});const qf=14,Sa=3,Ts=8,Ss=14,ml=16,kC=16,vC=16;var gl=(t=>(t[t.FAR=1]="FAR",t[t.MID=1.5]="MID",t[t.NEAR=3]="NEAR",t))(gl||{});function Ra(t,e){return new Array(t).fill(e)}function xC(t,e,r,n,i,s=0){const o=n*i;return{id:`tiles:${t}:${e}`,type:1,tag:r,width:n,height:i,char:Ra(o,0),color:Ra(o,0),bg:Ra(o,s),wall:Ra(o,0)}}function EC(t,e,r,n=1,i=15){return{id:`sprites:${t}:${e}:${r}`,x:0,y:0,char:n,color:i,bg:Je.ONCLEAR}}function AC(t,e){return{id:`sprites:${t}:${e}`,type:2,sprites:[]}}function TC(t,e,r,n,i=0){const s=r*n;return{id:`dither:${t}:${e}`,type:3,width:r,height:n,alphas:Ra(s,i)}}function SC(t,e,r,n){return{id:`media:${t}:${e}`,type:4,mime:r,media:n}}function RC(t,e){return{id:`control:${t}:${e}`,type:5,focusx:0,focusy:0,focusid:t,viewscale:1.5,graphics:"flat",facing:0}}function A_(t,e){return`${t}:${e}`}const OC=1,IC=16,NC=256;var Rr=(t=>(t[t.NONE=0]="NONE",t[t.ALT=1]="ALT",t[t.CTRL=2]="CTRL",t[t.SHIFT=3]="SHIFT",t[t.MOVE_UP=4]="MOVE_UP",t[t.MOVE_DOWN=5]="MOVE_DOWN",t[t.MOVE_LEFT=6]="MOVE_LEFT",t[t.MOVE_RIGHT=7]="MOVE_RIGHT",t[t.OK_BUTTON=8]="OK_BUTTON",t[t.CANCEL_BUTTON=9]="CANCEL_BUTTON",t[t.MENU_BUTTON=10]="MENU_BUTTON",t))(Rr||{});const ei=!!JSON.parse("false"),CC=!!JSON.parse("false");JSON.parse("false");const T_=!!JSON.parse("false");JSON.parse("false"),JSON.parse("false"),JSON.parse("false"),JSON.parse("false");const Rs={HALT_AT_COUNT:256},ce=io("SOFTWARE");function vi(t){const e={},r={everytick(){},aftertick(){},listcommands(){return Br(e)},...t,getcommand(n){return e[n]},command(n,i){return e[n]=i,r}};return r}function jr(t,e,r,n){const[i,s]=ue(n,0,[V.NUMBER_OR_STRING,V.MAYBE_NUMBER_OR_STRING]);fg(ce,t,e,r,i,s)}const LC=["echo","reverb","phaser","distortion","vibrato","fc","fcrush","autowah"];function Yf(t,e,r){const[n,i]=ue(r,0,[V.NUMBER_OR_STRING]);if(Ae(n))zh(ce,t,e,"volume",n);else if(LC.includes(Fe(n))){const[s,o]=ue(r,i,[V.NUMBER_OR_STRING,V.MAYBE_NUMBER_OR_STRING]);fg(ce,t,e,n,s,o)}else{const[s]=ue(r,i,[V.MAYBE_NUMBER_OR_STRING]);if(Ae(s)){const o=r.length-i,a=new Array(o).fill(V.NUMBER),c=ue(r,i,a).slice(0,o),l=c.length===1?c[0]:c;zh(ce,t,e,n,l)}else{const[o]=ue(r,i,[V.MAYBE_NUMBER_OR_STRING]);zh(ce,t,e,n,o)}}}function Vi(t,e){const[r]=ue(t,0,[V.MAYBE_NAME]);GR(ce,E.elementfocus,E.board?.id??"",r??"",e)}const yl=vi().command("tts",(t,e)=>{const[r,n]=ue(e,0,[V.STRING,V.STRING]);return zR(ce,E.elementfocus,r,n),0}).command("ttsqueue",(t,e)=>{const[r,n]=ue(e,0,[V.STRING,V.STRING]);return WR(ce,E.elementfocus,r,n),0}).command("bpm",(t,e)=>{const[r]=ue(e,0,[V.NUMBER]);return KR(ce,E.elementfocus,r),0}).command("vol",(t,e)=>{const[r]=ue(e,0,[V.NUMBER]);return qR(ce,E.elementfocus,r),0}).command("bgvol",(t,e)=>{const[r]=ue(e,0,[V.NUMBER]);return YR(ce,E.elementfocus,r),0}).command("ttsvol",(t,e)=>{const[r]=ue(e,0,[V.NUMBER]);return VR(ce,E.elementfocus,r),0}).command("play",(t,e)=>{const[r]=ue(e,0,[V.MAYBE_NAME]);return HR(ce,E.elementfocus,E.board?.id??"",r??""),0}).command("bgplay",(t,e)=>(Vi(e,""),0)).command("bgplayon64n",(t,e)=>(Vi(e,"@64n"),0)).command("bgplayon32n",(t,e)=>(Vi(e,"@32n"),0)).command("bgplayon16n",(t,e)=>(Vi(e,"@16n"),0)).command("bgplayon8n",(t,e)=>(Vi(e,"@8n"),0)).command("bgplayon4n",(t,e)=>(Vi(e,"@4n"),0)).command("bgplayon2n",(t,e)=>(Vi(e,"@2n"),0)).command("bgplayon1n",(t,e)=>(Vi(e,"@1m"),0)).command("synth",(t,e)=>{for(let r=0;r<4;++r)Yf(E.elementfocus,r,e);return 0}).command("synthrecord",(t,e)=>{const[r]=ue(e,0,[V.MAYBE_STRING]);return XR(ce,E.elementfocus,r??""),0}).command("synthflush",()=>(ZR(ce,E.elementfocus),0)).command("echo",(t,e)=>{for(let r=0;r<2;++r)jr(E.elementfocus,r,"echo",e);return 0}).command("fcrush",(t,e)=>{for(let r=0;r<2;++r)jr(E.elementfocus,r,"fc",e);return 0}).command("phaser",(t,e)=>{for(let r=0;r<2;++r)jr(E.elementfocus,r,"phaser",e);return 0}).command("reverb",(t,e)=>{for(let r=0;r<2;++r)jr(E.elementfocus,r,"reverb",e);return 0}).command("distort",(t,e)=>{for(let r=0;r<2;++r)jr(E.elementfocus,r,"distort",e);return 0}).command("vibrato",(t,e)=>{for(let r=0;r<2;++r)jr(E.elementfocus,r,"vibrato",e);return 0}).command("autowah",(t,e)=>{for(let r=0;r<2;++r)jr(E.elementfocus,r,"autowah",e);return 0});for(let t=0;t<4;++t)yl.command(`synth${t+1}`,(e,r)=>(Yf(E.elementfocus,t,r),0));yl.command("synth5",(t,e)=>{for(let r=4;r<8;++r)Yf(E.elementfocus,r,e);return 0});for(let t=0;t<3;++t){const e=t+1;yl.command(`echo${e}`,(r,n)=>(jr(E.elementfocus,t,"echo",n),0)).command(`fcrush${e}`,(r,n)=>(jr(E.elementfocus,t,"fcrush",n),0)).command(`phaser${e}`,(r,n)=>(jr(E.elementfocus,t,"phaser",n),0)).command(`reverb${e}`,(r,n)=>(jr(E.elementfocus,t,"reverb",n),0)).command(`distort${e}`,(r,n)=>(jr(E.elementfocus,t,"distort",n),0)).command(`vibrato${e}`,(r,n)=>(jr(E.elementfocus,t,"vibrato",n),0)).command(`autowah${e}`,(r,n)=>(jr(E.elementfocus,t,"autowah",n),0))}var Vf;try{Vf=new TextDecoder}catch{}var Ne,ti,te=0,vt={},at,Xi,gn=0,ri=0,cr,xi,zr=[],st,S_={useRecords:!1,mapsAsObjects:!0};class R_{}const O_=new R_;O_.name="MessagePack 0xC1";var Zi=!1,I_=2,MC;try{new Function("")}catch{I_=1/0}class Oa{constructor(e){e&&(e.useRecords===!1&&e.mapsAsObjects===void 0&&(e.mapsAsObjects=!0),e.sequential&&e.trusted!==!1&&(e.trusted=!0,!e.structures&&e.useRecords!=!1&&(e.structures=[],e.maxSharedStructures||(e.maxSharedStructures=0))),e.structures?e.structures.sharedLength=e.structures.length:e.getStructures&&((e.structures=[]).uninitialized=!0,e.structures.sharedLength=0),e.int64AsNumber&&(e.int64AsType="number")),Object.assign(this,e)}unpack(e,r){if(Ne)return H_(()=>(ed(),this?this.unpack(e,r):Oa.prototype.unpack.call(S_,e,r)));!e.buffer&&e.constructor===ArrayBuffer&&(e=typeof Qt<"u"?Qt.from(e):new Uint8Array(e)),typeof r=="object"?(ti=r.end||e.length,te=r.start||0):(te=0,ti=r>-1?r:e.length),ri=0,Xi=null,cr=null,Ne=e;try{st=e.dataView||(e.dataView=new DataView(e.buffer,e.byteOffset,e.byteLength))}catch(n){throw Ne=null,e instanceof Uint8Array?n:new Error("Source must be a Uint8Array or Buffer but was a "+(e&&typeof e=="object"?e.constructor.name:typeof e))}if(this instanceof Oa){if(vt=this,this.structures)return at=this.structures,_l(r);(!at||at.length>0)&&(at=[])}else vt=S_,(!at||at.length>0)&&(at=[]);return _l(r)}unpackMultiple(e,r){let n,i=0;try{Zi=!0;let s=e.length,o=this?this.unpack(e,s):bl.unpack(e,s);if(r){if(r(o,i,te)===!1)return;for(;te<s;)if(i=te,r(_l(),i,te)===!1)return}else{for(n=[o];te<s;)i=te,n.push(_l());return n}}catch(s){throw s.lastPosition=i,s.values=n,s}finally{Zi=!1,ed()}}_mergeStructures(e,r){e=e||[],Object.isFrozen(e)&&(e=e.map(n=>n.slice(0)));for(let n=0,i=e.length;n<i;n++){let s=e[n];s&&(s.isShared=!0,n>=32&&(s.highByte=n-32>>5))}e.sharedLength=e.length;for(let n in r||[])if(n>=0){let i=e[n],s=r[n];s&&(i&&((e.restoreStructures||(e.restoreStructures=[]))[n]=i),e[n]=s)}return this.structures=e}decode(e,r){return this.unpack(e,r)}}function _l(t){try{if(!vt.trusted&&!Zi){let r=at.sharedLength||0;r<at.length&&(at.length=r)}let e;if(vt.randomAccessStructure&&Ne[te]<64&&Ne[te]>=32&&MC||(e=zt()),cr&&(te=cr.postBundlePosition,cr=null),Zi&&(at.restoreStructures=null),te==ti)at&&at.restoreStructures&&N_(),at=null,Ne=null,xi&&(xi=null);else{if(te>ti)throw new Error("Unexpected end of MessagePack data");if(!Zi){let r;try{r=JSON.stringify(e,(n,i)=>typeof i=="bigint"?`${i}n`:i).slice(0,100)}catch(n){r="(JSON view not available "+n+")"}throw new Error("Data read, but end of buffer not reached "+r)}}return e}catch(e){throw at&&at.restoreStructures&&N_(),ed(),(e instanceof RangeError||e.message.startsWith("Unexpected end of buffer")||te>ti)&&(e.incomplete=!0),e}}function N_(){for(let t in at.restoreStructures)at[t]=at.restoreStructures[t];at.restoreStructures=null}function zt(){let t=Ne[te++];if(t<160)if(t<128){if(t<64)return t;{let e=at[t&63]||vt.getStructures&&L_()[t&63];return e?(e.read||(e.read=Xf(e,t&63)),e.read()):t}}else if(t<144)if(t-=128,vt.mapsAsObjects){let e={};for(let r=0;r<t;r++){let n=F_();n==="__proto__"&&(n="__proto_"),e[n]=zt()}return e}else{let e=new Map;for(let r=0;r<t;r++)e.set(zt(),zt());return e}else{t-=144;let e=new Array(t);for(let r=0;r<t;r++)e[r]=zt();return vt.freezeData?Object.freeze(e):e}else if(t<192){let e=t-160;if(ri>=te)return Xi.slice(te-gn,(te+=e)-gn);if(ri==0&&ti<140){let r=e<16?Jf(e):$_(e);if(r!=null)return r}return Zf(e)}else{let e;switch(t){case 192:return null;case 193:return cr?(e=zt(),e>0?cr[1].slice(cr.position1,cr.position1+=e):cr[0].slice(cr.position0,cr.position0-=e)):O_;case 194:return!1;case 195:return!0;case 196:if(e=Ne[te++],e===void 0)throw new Error("Unexpected end of buffer");return Qf(e);case 197:return e=st.getUint16(te),te+=2,Qf(e);case 198:return e=st.getUint32(te),te+=4,Qf(e);case 199:return Os(Ne[te++]);case 200:return e=st.getUint16(te),te+=2,Os(e);case 201:return e=st.getUint32(te),te+=4,Os(e);case 202:if(e=st.getFloat32(te),vt.useFloat32>2){let r=td[(Ne[te]&127)<<1|Ne[te+1]>>7];return te+=4,(r*e+(e>0?.5:-.5)>>0)/r}return te+=4,e;case 203:return e=st.getFloat64(te),te+=8,e;case 204:return Ne[te++];case 205:return e=st.getUint16(te),te+=2,e;case 206:return e=st.getUint32(te),te+=4,e;case 207:return vt.int64AsType==="number"?(e=st.getUint32(te)*4294967296,e+=st.getUint32(te+4)):vt.int64AsType==="string"?e=st.getBigUint64(te).toString():vt.int64AsType==="auto"?(e=st.getBigUint64(te),e<=BigInt(2)<<BigInt(52)&&(e=Number(e))):e=st.getBigUint64(te),te+=8,e;case 208:return st.getInt8(te++);case 209:return e=st.getInt16(te),te+=2,e;case 210:return e=st.getInt32(te),te+=4,e;case 211:return vt.int64AsType==="number"?(e=st.getInt32(te)*4294967296,e+=st.getUint32(te+4)):vt.int64AsType==="string"?e=st.getBigInt64(te).toString():vt.int64AsType==="auto"?(e=st.getBigInt64(te),e>=BigInt(-2)<<BigInt(52)&&e<=BigInt(2)<<BigInt(52)&&(e=Number(e))):e=st.getBigInt64(te),te+=8,e;case 212:if(e=Ne[te++],e==114)return j_(Ne[te++]&63);{let r=zr[e];if(r)return r.read?(te++,r.read(zt())):r.noBuffer?(te++,r()):r(Ne.subarray(te,++te));throw new Error("Unknown extension "+e)}case 213:return e=Ne[te],e==114?(te++,j_(Ne[te++]&63,Ne[te++])):Os(2);case 214:return Os(4);case 215:return Os(8);case 216:return Os(16);case 217:return e=Ne[te++],ri>=te?Xi.slice(te-gn,(te+=e)-gn):$C(e);case 218:return e=st.getUint16(te),te+=2,ri>=te?Xi.slice(te-gn,(te+=e)-gn):PC(e);case 219:return e=st.getUint32(te),te+=4,ri>=te?Xi.slice(te-gn,(te+=e)-gn):BC(e);case 220:return e=st.getUint16(te),te+=2,M_(e);case 221:return e=st.getUint32(te),te+=4,M_(e);case 222:return e=st.getUint16(te),te+=2,U_(e);case 223:return e=st.getUint32(te),te+=4,U_(e);default:if(t>=224)return t-256;if(t===void 0){let r=new Error("Unexpected end of MessagePack data");throw r.incomplete=!0,r}throw new Error("Unknown MessagePack token "+t)}}}const UC=/^[a-zA-Z_$][a-zA-Z\d_$]*$/;function Xf(t,e){function r(){if(r.count++>I_){let i=t.read=new Function("r","return function(){return "+(vt.freezeData?"Object.freeze":"")+"({"+t.map(s=>s==="__proto__"?"__proto_:r()":UC.test(s)?s+":r()":"["+JSON.stringify(s)+"]:r()").join(",")+"})}")(zt);return t.highByte===0&&(t.read=C_(e,t.read)),i()}let n={};for(let i=0,s=t.length;i<s;i++){let o=t[i];o==="__proto__"&&(o="__proto_"),n[o]=zt()}return vt.freezeData?Object.freeze(n):n}return r.count=0,t.highByte===0?C_(e,r):r}const C_=(t,e)=>function(){let r=Ne[te++];if(r===0)return e();let n=t<32?-(t+(r<<5)):t+(r<<5),i=at[n]||L_()[n];if(!i)throw new Error("Record id is not defined for "+n);return i.read||(i.read=Xf(i,t)),i.read()};function L_(){let t=H_(()=>(Ne=null,vt.getStructures()));return at=vt._mergeStructures(t,at)}var Zf=Ia,$C=Ia,PC=Ia,BC=Ia;function Ia(t){let e;if(t<16&&(e=Jf(t)))return e;if(t>64&&Vf)return Vf.decode(Ne.subarray(te,te+=t));const r=te+t,n=[];for(e="";te<r;){const i=Ne[te++];if((i&128)===0)n.push(i);else if((i&224)===192){const s=Ne[te++]&63;n.push((i&31)<<6|s)}else if((i&240)===224){const s=Ne[te++]&63,o=Ne[te++]&63;n.push((i&31)<<12|s<<6|o)}else if((i&248)===240){const s=Ne[te++]&63,o=Ne[te++]&63,a=Ne[te++]&63;let c=(i&7)<<18|s<<12|o<<6|a;c>65535&&(c-=65536,n.push(c>>>10&1023|55296),c=56320|c&1023),n.push(c)}else n.push(i);n.length>=4096&&(e+=lr.apply(String,n),n.length=0)}return n.length>0&&(e+=lr.apply(String,n)),e}function M_(t){let e=new Array(t);for(let r=0;r<t;r++)e[r]=zt();return vt.freezeData?Object.freeze(e):e}function U_(t){if(vt.mapsAsObjects){let e={};for(let r=0;r<t;r++){let n=F_();n==="__proto__"&&(n="__proto_"),e[n]=zt()}return e}else{let e=new Map;for(let r=0;r<t;r++)e.set(zt(),zt());return e}}var lr=String.fromCharCode;function $_(t){let e=te,r=new Array(t);for(let n=0;n<t;n++){const i=Ne[te++];if((i&128)>0){te=e;return}r[n]=i}return lr.apply(String,r)}function Jf(t){if(t<4)if(t<2){if(t===0)return"";{let e=Ne[te++];if((e&128)>1){te-=1;return}return lr(e)}}else{let e=Ne[te++],r=Ne[te++];if((e&128)>0||(r&128)>0){te-=2;return}if(t<3)return lr(e,r);let n=Ne[te++];if((n&128)>0){te-=3;return}return lr(e,r,n)}else{let e=Ne[te++],r=Ne[te++],n=Ne[te++],i=Ne[te++];if((e&128)>0||(r&128)>0||(n&128)>0||(i&128)>0){te-=4;return}if(t<6){if(t===4)return lr(e,r,n,i);{let s=Ne[te++];if((s&128)>0){te-=5;return}return lr(e,r,n,i,s)}}else if(t<8){let s=Ne[te++],o=Ne[te++];if((s&128)>0||(o&128)>0){te-=6;return}if(t<7)return lr(e,r,n,i,s,o);let a=Ne[te++];if((a&128)>0){te-=7;return}return lr(e,r,n,i,s,o,a)}else{let s=Ne[te++],o=Ne[te++],a=Ne[te++],c=Ne[te++];if((s&128)>0||(o&128)>0||(a&128)>0||(c&128)>0){te-=8;return}if(t<10){if(t===8)return lr(e,r,n,i,s,o,a,c);{let l=Ne[te++];if((l&128)>0){te-=9;return}return lr(e,r,n,i,s,o,a,c,l)}}else if(t<12){let l=Ne[te++],u=Ne[te++];if((l&128)>0||(u&128)>0){te-=10;return}if(t<11)return lr(e,r,n,i,s,o,a,c,l,u);let h=Ne[te++];if((h&128)>0){te-=11;return}return lr(e,r,n,i,s,o,a,c,l,u,h)}else{let l=Ne[te++],u=Ne[te++],h=Ne[te++],f=Ne[te++];if((l&128)>0||(u&128)>0||(h&128)>0||(f&128)>0){te-=12;return}if(t<14){if(t===12)return lr(e,r,n,i,s,o,a,c,l,u,h,f);{let d=Ne[te++];if((d&128)>0){te-=13;return}return lr(e,r,n,i,s,o,a,c,l,u,h,f,d)}}else{let d=Ne[te++],m=Ne[te++];if((d&128)>0||(m&128)>0){te-=14;return}if(t<15)return lr(e,r,n,i,s,o,a,c,l,u,h,f,d,m);let p=Ne[te++];if((p&128)>0){te-=15;return}return lr(e,r,n,i,s,o,a,c,l,u,h,f,d,m,p)}}}}}function P_(){let t=Ne[te++],e;if(t<192)e=t-160;else switch(t){case 217:e=Ne[te++];break;case 218:e=st.getUint16(te),te+=2;break;case 219:e=st.getUint32(te),te+=4;break;default:throw new Error("Expected string")}return Ia(e)}function Qf(t){return vt.copyBuffers?Uint8Array.prototype.slice.call(Ne,te,te+=t):Ne.subarray(te,te+=t)}function Os(t){let e=Ne[te++];if(zr[e]){let r;return zr[e](Ne.subarray(te,r=te+=t),n=>{te=n;try{return zt()}finally{te=r}})}else throw new Error("Unknown extension type "+e)}var B_=new Array(4096);function F_(){let t=Ne[te++];if(t>=160&&t<192){if(t=t-160,ri>=te)return Xi.slice(te-gn,(te+=t)-gn);if(!(ri==0&&ti<180))return Zf(t)}else return te--,D_(zt());let e=(t<<5^(t>1?st.getUint16(te):t>0?Ne[te]:0))&4095,r=B_[e],n=te,i=te+t-3,s,o=0;if(r&&r.bytes==t){for(;n<i;){if(s=st.getUint32(n),s!=r[o++]){n=1879048192;break}n+=4}for(i+=3;n<i;)if(s=Ne[n++],s!=r[o++]){n=1879048192;break}if(n===i)return te=n,r.string;i-=3,n=te}for(r=[],B_[e]=r,r.bytes=t;n<i;)s=st.getUint32(n),r.push(s),n+=4;for(i+=3;n<i;)s=Ne[n++],r.push(s);let a=t<16?Jf(t):$_(t);return a!=null?r.string=a:r.string=Zf(t)}function D_(t){if(typeof t=="string")return t;if(typeof t=="number"||typeof t=="boolean"||typeof t=="bigint")return t.toString();if(t==null)return t+"";if(vt.allowArraysInMapKeys&&Array.isArray(t)&&t.flat().every(e=>["string","number","boolean","bigint"].includes(typeof e)))return t.flat().toString();throw new Error(`Invalid property type for record: ${typeof t}`)}const j_=(t,e)=>{let r=zt().map(D_),n=t;e!==void 0&&(t=t<32?-((e<<5)+t):(e<<5)+t,r.highByte=e);let i=at[t];return i&&(i.isShared||Zi)&&((at.restoreStructures||(at.restoreStructures=[]))[t]=i),at[t]=r,r.read=Xf(r,n),r.read()};zr[0]=()=>{},zr[0].noBuffer=!0,zr[66]=t=>{let e=t.byteLength%8||8,r=BigInt(t[0]&128?t[0]-256:t[0]);for(let n=1;n<e;n++)r<<=BigInt(8),r+=BigInt(t[n]);if(t.byteLength!==e){let n=new DataView(t.buffer,t.byteOffset,t.byteLength),i=(s,o)=>{let a=o-s;if(a<=40){let h=n.getBigUint64(s);for(let f=s+8;f<o;f+=8)h<<=64n,h|=n.getBigUint64(f);return h}let c=s+(a>>4<<3),l=i(s,c),u=i(c,o);return l<<BigInt((o-c)*8)|u};r=r<<BigInt((n.byteLength-e)*8)|i(e,n.byteLength)}return r};let z_={Error,EvalError,RangeError,ReferenceError,SyntaxError,TypeError,URIError,AggregateError:typeof AggregateError=="function"?AggregateError:null};zr[101]=()=>{let t=zt();if(!z_[t[0]]){let e=Error(t[1],{cause:t[2]});return e.name=t[0],e}return z_[t[0]](t[1],{cause:t[2]})},zr[105]=t=>{if(vt.structuredClone===!1)throw new Error("Structured clone extension is disabled");let e=st.getUint32(te-4);xi||(xi=new Map);let r=Ne[te],n;r>=144&&r<160||r==220||r==221?n=[]:r>=128&&r<144||r==222||r==223?n=new Map:(r>=199&&r<=201||r>=212&&r<=216)&&Ne[te+1]===115?n=new Set:n={};let i={target:n};xi.set(e,i);let s=zt();if(i.used)Object.assign(n,s);else return i.target=s;if(n instanceof Map)for(let[o,a]of s.entries())n.set(o,a);if(n instanceof Set)for(let o of Array.from(s))n.add(o);return n},zr[112]=t=>{if(vt.structuredClone===!1)throw new Error("Structured clone extension is disabled");let e=st.getUint32(te-4),r=xi.get(e);return r.used=!0,r.target},zr[115]=()=>new Set(zt());const W_=["Int8","Uint8","Uint8Clamped","Int16","Uint16","Int32","Uint32","Float32","Float64","BigInt64","BigUint64"].map(t=>t+"Array");let FC=typeof globalThis=="object"?globalThis:window;zr[116]=t=>{let e=t[0],r=Uint8Array.prototype.slice.call(t,1).buffer,n=W_[e];if(!n){if(e===16)return r;if(e===17)return new DataView(r);throw new Error("Could not find typed array for code "+e)}return new FC[n](r)},zr[120]=()=>{let t=zt();return new RegExp(t[0],t[1])};const DC=[];zr[98]=t=>{let e=(t[0]<<24)+(t[1]<<16)+(t[2]<<8)+t[3],r=te;return te+=e-t.length,cr=DC,cr=[P_(),P_()],cr.position0=0,cr.position1=0,cr.postBundlePosition=te,te=r,zt()},zr[255]=t=>t.length==4?new Date((t[0]*16777216+(t[1]<<16)+(t[2]<<8)+t[3])*1e3):t.length==8?new Date(((t[0]<<22)+(t[1]<<14)+(t[2]<<6)+(t[3]>>2))/1e6+((t[3]&3)*4294967296+t[4]*16777216+(t[5]<<16)+(t[6]<<8)+t[7])*1e3):t.length==12?new Date(((t[0]<<24)+(t[1]<<16)+(t[2]<<8)+t[3])/1e6+((t[4]&128?-281474976710656:0)+t[6]*1099511627776+t[7]*4294967296+t[8]*16777216+(t[9]<<16)+(t[10]<<8)+t[11])*1e3):new Date("invalid");function H_(t){let e=ti,r=te,n=gn,i=ri,s=Xi,o=xi,a=cr,c=new Uint8Array(Ne.slice(0,ti)),l=at,u=at.slice(0,at.length),h=vt,f=Zi,d=t();return ti=e,te=r,gn=n,ri=i,Xi=s,xi=o,cr=a,Ne=c,Zi=f,at=l,at.splice(0,at.length,...u),vt=h,st=new DataView(Ne.buffer,Ne.byteOffset,Ne.byteLength),d}function ed(){Ne=null,xi=null,at=null}const td=new Array(147);for(let t=0;t<256;t++)td[t]=+("1e"+Math.floor(45.15-t*.30103));var bl=new Oa({useRecords:!1});const jC=bl.unpack;bl.unpackMultiple,bl.unpack;let zC=new Float32Array(1);new Uint8Array(zC.buffer,0,4);let wl;try{wl=new TextEncoder}catch{}let rd,G_;const So=typeof Qt<"u",kl=So?function(t){return Qt.allocUnsafeSlow(t)}:Uint8Array,K_=So?Qt:Uint8Array,q_=So?4294967296:2144337920;let ae,Na,wt,ne=0,Er,Nt=null,WC;const HC=21760,GC=/[\u0080-\uFFFF]/,Ro=Symbol("record-id");class KC extends Oa{constructor(e){super(e),this.offset=0;let r,n,i,s,o=K_.prototype.utf8Write?function(I,k){return ae.utf8Write(I,k,ae.byteLength-k)}:wl&&wl.encodeInto?function(I,k){return wl.encodeInto(I,ae.subarray(k)).written}:!1,a=this;e||(e={});let c=e&&e.sequential,l=e.structures||e.saveStructures,u=e.maxSharedStructures;if(u==null&&(u=l?32:0),u>8160)throw new Error("Maximum maxSharedStructure is 8160");e.structuredClone&&e.moreTypes==null&&(this.moreTypes=!0);let h=e.maxOwnStructures;h==null&&(h=l?32:64),!this.structures&&e.useRecords!=!1&&(this.structures=[]);let f=u>32||h+u>64,d=u+64,m=u+h+64;if(m>8256)throw new Error("Maximum maxSharedStructure + maxOwnStructure is 8192");let p=[],g=0,y=0;this.pack=this.encode=function(I,k){if(ae||(ae=new kl(8192),wt=ae.dataView||(ae.dataView=new DataView(ae.buffer,0,8192)),ne=0),Er=ae.length-10,Er-ne<2048?(ae=new kl(ae.length),wt=ae.dataView||(ae.dataView=new DataView(ae.buffer,0,ae.length)),Er=ae.length-10,ne=0):ne=ne+7&2147483640,r=ne,k&JC&&(ne+=k&255),s=a.structuredClone?new Map:null,a.bundleStrings&&typeof I!="string"?(Nt=[],Nt.size=1/0):Nt=null,i=a.structures,i){i.uninitialized&&(i=a._mergeStructures(a.getStructures()));let z=i.sharedLength||0;if(z>u)throw new Error("Shared structures is larger than maximum shared structures, try increasing maxSharedStructures to "+i.sharedLength);if(!i.transitions){i.transitions=Object.create(null);for(let B=0;B<z;B++){let Q=i[B];if(!Q)continue;let Y,N=i.transitions;for(let U=0,$=Q.length;U<$;U++){let X=Q[U];Y=N[X],Y||(Y=N[X]=Object.create(null)),N=Y}N[Ro]=B+64}this.lastNamedStructuresLength=z}c||(i.nextId=z+64)}n&&(n=!1);let C;try{a.randomAccessStructure&&I&&I.constructor&&I.constructor===Object?O(I):T(I);let z=Nt;if(Nt&&V_(r,T,0),s&&s.idsToInsert){let B=s.idsToInsert.sort((U,$)=>U.offset>$.offset?1:-1),Q=B.length,Y=-1;for(;z&&Q>0;){let U=B[--Q].offset+r;U<z.stringsPosition+r&&Y===-1&&(Y=0),U>z.position+r?Y>=0&&(Y+=6):(Y>=0&&(wt.setUint32(z.position+r,wt.getUint32(z.position+r)+Y),Y=-1),z=z.previous,Q++)}Y>=0&&z&&wt.setUint32(z.position+r,wt.getUint32(z.position+r)+Y),ne+=B.length*6,ne>Er&&W(ne),a.offset=ne;let N=qC(ae.subarray(r,ne),B);return s=null,N}return a.offset=ne,k&XC?(ae.start=r,ae.end=ne,ae):ae.subarray(r,ne)}catch(z){throw C=z,z}finally{if(i&&(_(),n&&a.saveStructures)){let z=i.sharedLength||0,B=ae.subarray(r,ne),Q=YC(i,a);if(!C)return a.saveStructures(Q,Q.isCompatible)===!1?a.pack(I,k):(a.lastNamedStructuresLength=z,ae.length>1073741824&&(ae=null),B)}ae.length>1073741824&&(ae=null),k&ZC&&(ne=r)}};const _=()=>{y<10&&y++;let I=i.sharedLength||0;if(i.length>I&&!c&&(i.length=I),g>1e4)i.transitions=null,y=0,g=0,p.length>0&&(p=[]);else if(p.length>0&&!c){for(let k=0,C=p.length;k<C;k++)p[k][Ro]=0;p=[]}},A=I=>{var k=I.length;k<16?ae[ne++]=144|k:k<65536?(ae[ne++]=220,ae[ne++]=k>>8,ae[ne++]=k&255):(ae[ne++]=221,wt.setUint32(ne,k),ne+=4);for(let C=0;C<k;C++)T(I[C])},T=I=>{ne>Er&&(ae=W(ne));var k=typeof I,C;if(k==="string"){let z=I.length;if(Nt&&z>=4&&z<4096){if((Nt.size+=z)>HC){let N,U=(Nt[0]?Nt[0].length*3+Nt[1].length:0)+10;ne+U>Er&&(ae=W(ne+U));let $;Nt.position?($=Nt,ae[ne]=200,ne+=3,ae[ne++]=98,N=ne-r,ne+=4,V_(r,T,0),wt.setUint16(N+r-3,ne-r-N)):(ae[ne++]=214,ae[ne++]=98,N=ne-r,ne+=4),Nt=["",""],Nt.previous=$,Nt.size=0,Nt.position=N}let Y=GC.test(I);Nt[Y?0:1]+=I,ae[ne++]=193,T(Y?-z:z);return}let B;z<32?B=1:z<256?B=2:z<65536?B=3:B=5;let Q=z*3;if(ne+Q>Er&&(ae=W(ne+Q)),z<64||!o){let Y,N,U,$=ne+B;for(Y=0;Y<z;Y++)N=I.charCodeAt(Y),N<128?ae[$++]=N:N<2048?(ae[$++]=N>>6|192,ae[$++]=N&63|128):(N&64512)===55296&&((U=I.charCodeAt(Y+1))&64512)===56320?(N=65536+((N&1023)<<10)+(U&1023),Y++,ae[$++]=N>>18|240,ae[$++]=N>>12&63|128,ae[$++]=N>>6&63|128,ae[$++]=N&63|128):(ae[$++]=N>>12|224,ae[$++]=N>>6&63|128,ae[$++]=N&63|128);C=$-ne-B}else C=o(I,ne+B);C<32?ae[ne++]=160|C:C<256?(B<2&&ae.copyWithin(ne+2,ne+1,ne+1+C),ae[ne++]=217,ae[ne++]=C):C<65536?(B<3&&ae.copyWithin(ne+3,ne+2,ne+2+C),ae[ne++]=218,ae[ne++]=C>>8,ae[ne++]=C&255):(B<5&&ae.copyWithin(ne+5,ne+3,ne+3+C),ae[ne++]=219,wt.setUint32(ne,C),ne+=4),ne+=C}else if(k==="number")if(I>>>0===I)I<32||I<128&&this.useRecords===!1||I<64&&!this.randomAccessStructure?ae[ne++]=I:I<256?(ae[ne++]=204,ae[ne++]=I):I<65536?(ae[ne++]=205,ae[ne++]=I>>8,ae[ne++]=I&255):(ae[ne++]=206,wt.setUint32(ne,I),ne+=4);else if(I>>0===I)I>=-32?ae[ne++]=256+I:I>=-128?(ae[ne++]=208,ae[ne++]=I+256):I>=-32768?(ae[ne++]=209,wt.setInt16(ne,I),ne+=2):(ae[ne++]=210,wt.setInt32(ne,I),ne+=4);else{let z;if((z=this.useFloat32)>0&&I<4294967296&&I>=-2147483648){ae[ne++]=202,wt.setFloat32(ne,I);let B;if(z<4||(B=I*td[(ae[ne]&127)<<1|ae[ne+1]>>7])>>0===B){ne+=4;return}else ne--}ae[ne++]=203,wt.setFloat64(ne,I),ne+=8}else if(k==="object"||k==="function")if(!I)ae[ne++]=192;else{if(s){let B=s.get(I);if(B){if(!B.id){let Q=s.idsToInsert||(s.idsToInsert=[]);B.id=Q.push(B)}ae[ne++]=214,ae[ne++]=112,wt.setUint32(ne,B.id),ne+=4;return}else s.set(I,{offset:ne-r})}let z=I.constructor;if(z===Object)P(I);else if(z===Array)A(I);else if(z===Map)if(this.mapAsEmptyObject)ae[ne++]=128;else{C=I.size,C<16?ae[ne++]=128|C:C<65536?(ae[ne++]=222,ae[ne++]=C>>8,ae[ne++]=C&255):(ae[ne++]=223,wt.setUint32(ne,C),ne+=4);for(let[B,Q]of I)T(B),T(Q)}else{for(let B=0,Q=rd.length;B<Q;B++){let Y=G_[B];if(I instanceof Y){let N=rd[B];if(N.write){N.type&&(ae[ne++]=212,ae[ne++]=N.type,ae[ne++]=0);let J=N.write.call(this,I);J===I?Array.isArray(I)?A(I):P(I):T(J);return}let U=ae,$=wt,X=ne;ae=null;let q;try{q=N.pack.call(this,I,J=>(ae=U,U=null,ne+=J,ne>Er&&W(ne),{target:ae,targetView:wt,position:ne-J}),T)}finally{U&&(ae=U,wt=$,ne=X,Er=ae.length-10)}q&&(q.length+ne>Er&&W(q.length+ne),ne=Y_(q,ae,ne,N.type));return}}if(Array.isArray(I))A(I);else{if(I.toJSON){const B=I.toJSON();if(B!==I)return T(B)}if(k==="function")return T(this.writeFunction&&this.writeFunction(I));P(I)}}}else if(k==="boolean")ae[ne++]=I?195:194;else if(k==="bigint"){if(I<9223372036854776e3&&I>=-9223372036854776e3)ae[ne++]=211,wt.setBigInt64(ne,I);else if(I<18446744073709552e3&&I>0)ae[ne++]=207,wt.setBigUint64(ne,I);else if(this.largeBigIntToFloat)ae[ne++]=203,wt.setFloat64(ne,Number(I));else{if(this.largeBigIntToString)return T(I.toString());if(this.useBigIntExtension||this.moreTypes){let z=I<0?BigInt(-1):BigInt(0),B;if(I>>BigInt(65536)===z){let Q=BigInt(18446744073709552e3)-BigInt(1),Y=[];for(;Y.push(I&Q),I>>BigInt(63)!==z;)I>>=BigInt(64);B=new Uint8Array(new BigUint64Array(Y).buffer),B.reverse()}else{let Q=I<0,Y=(Q?~I:I).toString(16);if(Y.length%2?Y="0"+Y:parseInt(Y.charAt(0),16)>=8&&(Y="00"+Y),So)B=Qt.from(Y,"hex");else{B=new Uint8Array(Y.length/2);for(let N=0;N<B.length;N++)B[N]=parseInt(Y.slice(N*2,N*2+2),16)}if(Q)for(let N=0;N<B.length;N++)B[N]=~B[N]}B.length+ne>Er&&W(B.length+ne),ne=Y_(B,ae,ne,66);return}else throw new RangeError(I+" was too large to fit in MessagePack 64-bit integer format, use useBigIntExtension, or set largeBigIntToFloat to convert to float-64, or set largeBigIntToString to convert to string")}ne+=8}else if(k==="undefined")this.encodeUndefinedAsNil?ae[ne++]=192:(ae[ne++]=212,ae[ne++]=0,ae[ne++]=0);else throw new Error("Unknown type: "+k)},x=this.variableMapSize||this.coercibleKeyAsNumber||this.skipValues?I=>{let k;if(this.skipValues){k=[];for(let B in I)(typeof I.hasOwnProperty!="function"||I.hasOwnProperty(B))&&!this.skipValues.includes(I[B])&&k.push(B)}else k=Object.keys(I);let C=k.length;C<16?ae[ne++]=128|C:C<65536?(ae[ne++]=222,ae[ne++]=C>>8,ae[ne++]=C&255):(ae[ne++]=223,wt.setUint32(ne,C),ne+=4);let z;if(this.coercibleKeyAsNumber)for(let B=0;B<C;B++){z=k[B];let Q=Number(z);T(isNaN(Q)?z:Q),T(I[z])}else for(let B=0;B<C;B++)T(z=k[B]),T(I[z])}:I=>{ae[ne++]=222;let k=ne-r;ne+=2;let C=0;for(let z in I)(typeof I.hasOwnProperty!="function"||I.hasOwnProperty(z))&&(T(z),T(I[z]),C++);if(C>65535)throw new Error('Object is too large to serialize with fast 16-bit map size, use the "variableMapSize" option to serialize this object');ae[k+++r]=C>>8,ae[k+r]=C&255},M=this.useRecords===!1?x:e.progressiveRecords&&!f?I=>{let k,C=i.transitions||(i.transitions=Object.create(null)),z=ne++-r,B;for(let Q in I)if(typeof I.hasOwnProperty!="function"||I.hasOwnProperty(Q)){if(k=C[Q],k)C=k;else{let Y=Object.keys(I),N=C;C=i.transitions;let U=0;for(let $=0,X=Y.length;$<X;$++){let q=Y[$];k=C[q],k||(k=C[q]=Object.create(null),U++),C=k}z+r+1==ne?(ne--,F(C,Y,U)):G(C,Y,z,U),B=!0,C=N[Q]}T(I[Q])}if(!B){let Q=C[Ro];Q?ae[z+r]=Q:G(C,Object.keys(I),z,0)}}:I=>{let k,C=i.transitions||(i.transitions=Object.create(null)),z=0;for(let Q in I)(typeof I.hasOwnProperty!="function"||I.hasOwnProperty(Q))&&(k=C[Q],k||(k=C[Q]=Object.create(null),z++),C=k);let B=C[Ro];B?B>=96&&f?(ae[ne++]=((B-=96)&31)+96,ae[ne++]=B>>5):ae[ne++]=B:F(C,C.__keys__||Object.keys(I),z);for(let Q in I)(typeof I.hasOwnProperty!="function"||I.hasOwnProperty(Q))&&T(I[Q])},R=typeof this.useRecords=="function"&&this.useRecords,P=R?I=>{R(I)?M(I):x(I)}:M,W=I=>{let k;if(I>16777216){if(I-r>q_)throw new Error("Packed buffer would be larger than maximum buffer size");k=Math.min(q_,Math.round(Math.max((I-r)*(I>67108864?1.25:2),4194304)/4096)*4096)}else k=(Math.max(I-r<<2,ae.length-1)>>12)+1<<12;let C=new kl(k);return wt=C.dataView||(C.dataView=new DataView(C.buffer,0,k)),I=Math.min(I,ae.length),ae.copy?ae.copy(C,0,r,I):C.set(ae.slice(r,I)),ne-=r,r=0,Er=C.length-10,ae=C},F=(I,k,C)=>{let z=i.nextId;z||(z=64),z<d&&this.shouldShareStructure&&!this.shouldShareStructure(k)?(z=i.nextOwnId,z<m||(z=d),i.nextOwnId=z+1):(z>=m&&(z=d),i.nextId=z+1);let B=k.highByte=z>=96&&f?z-96>>5:-1;I[Ro]=z,I.__keys__=k,i[z-64]=k,z<d?(k.isShared=!0,i.sharedLength=z-63,n=!0,B>=0?(ae[ne++]=(z&31)+96,ae[ne++]=B):ae[ne++]=z):(B>=0?(ae[ne++]=213,ae[ne++]=114,ae[ne++]=(z&31)+96,ae[ne++]=B):(ae[ne++]=212,ae[ne++]=114,ae[ne++]=z),C&&(g+=y*C),p.length>=h&&(p.shift()[Ro]=0),p.push(I),T(k))},G=(I,k,C,z)=>{let B=ae,Q=ne,Y=Er,N=r;ae=Na,ne=0,r=0,ae||(Na=ae=new kl(8192)),Er=ae.length-10,F(I,k,z),Na=ae;let U=ne;if(ae=B,ne=Q,Er=Y,r=N,U>1){let $=ne+U-1;$>Er&&W($);let X=C+r;ae.copyWithin(X+U,X+1,ne),ae.set(Na.slice(0,U),X),ne=$}else ae[C+r]=Na[0]},O=I=>{let k=WC(I,ae,r,ne,i,W,(C,z,B)=>{if(B)return n=!0;ne=z;let Q=ae;return T(C),_(),Q!==ae?{position:ne,targetView:wt,target:ae}:ne},this);if(k===0)return P(I);ne=k}}useBuffer(e){ae=e,ae.dataView||(ae.dataView=new DataView(ae.buffer,ae.byteOffset,ae.byteLength)),wt=ae.dataView,ne=0}set position(e){ne=e}get position(){return ne}clearSharedData(){this.structures&&(this.structures=[]),this.typedStructs&&(this.typedStructs=[])}}G_=[Date,Set,Error,RegExp,ArrayBuffer,Object.getPrototypeOf(Uint8Array.prototype).constructor,DataView,R_],rd=[{pack(t,e,r){let n=t.getTime()/1e3;if((this.useTimestamp32||t.getMilliseconds()===0)&&n>=0&&n<4294967296){let{target:i,targetView:s,position:o}=e(6);i[o++]=214,i[o++]=255,s.setUint32(o,n)}else if(n>0&&n<4294967296){let{target:i,targetView:s,position:o}=e(10);i[o++]=215,i[o++]=255,s.setUint32(o,t.getMilliseconds()*4e6+(n/1e3/4294967296>>0)),s.setUint32(o+4,n)}else if(isNaN(n)){if(this.onInvalidDate)return e(0),r(this.onInvalidDate());let{target:i,targetView:s,position:o}=e(3);i[o++]=212,i[o++]=255,i[o++]=255}else{let{target:i,targetView:s,position:o}=e(15);i[o++]=199,i[o++]=12,i[o++]=255,s.setUint32(o,t.getMilliseconds()*1e6),s.setBigInt64(o+4,BigInt(Math.floor(n)))}}},{pack(t,e,r){if(this.setAsEmptyObject)return e(0),r({});let n=Array.from(t),{target:i,position:s}=e(this.moreTypes?3:0);this.moreTypes&&(i[s++]=212,i[s++]=115,i[s++]=0),r(n)}},{pack(t,e,r){let{target:n,position:i}=e(this.moreTypes?3:0);this.moreTypes&&(n[i++]=212,n[i++]=101,n[i++]=0),r([t.name,t.message,t.cause])}},{pack(t,e,r){let{target:n,position:i}=e(this.moreTypes?3:0);this.moreTypes&&(n[i++]=212,n[i++]=120,n[i++]=0),r([t.source,t.flags])}},{pack(t,e){this.moreTypes?nd(t,16,e):id(So?Qt.from(t):new Uint8Array(t),e)}},{pack(t,e){let r=t.constructor;r!==K_&&this.moreTypes?nd(t,W_.indexOf(r.name),e):id(t,e)}},{pack(t,e){this.moreTypes?nd(t,17,e):id(So?Qt.from(t):new Uint8Array(t),e)}},{pack(t,e){let{target:r,position:n}=e(1);r[n]=193}}];function nd(t,e,r,n){let i=t.byteLength;if(i+1<256){var{target:s,position:o}=r(4+i);s[o++]=199,s[o++]=i+1}else if(i+1<65536){var{target:s,position:o}=r(5+i);s[o++]=200,s[o++]=i+1>>8,s[o++]=i+1&255}else{var{target:s,position:o,targetView:a}=r(7+i);s[o++]=201,a.setUint32(o,i+1),o+=4}s[o++]=116,s[o++]=e,t.buffer||(t=new Uint8Array(t)),s.set(new Uint8Array(t.buffer,t.byteOffset,t.byteLength),o)}function id(t,e){let r=t.byteLength;var n,i;if(r<256){var{target:n,position:i}=e(r+2);n[i++]=196,n[i++]=r}else if(r<65536){var{target:n,position:i}=e(r+3);n[i++]=197,n[i++]=r>>8,n[i++]=r&255}else{var{target:n,position:i,targetView:s}=e(r+5);n[i++]=198,s.setUint32(i,r),i+=4}n.set(t,i)}function Y_(t,e,r,n){let i=t.length;switch(i){case 1:e[r++]=212;break;case 2:e[r++]=213;break;case 4:e[r++]=214;break;case 8:e[r++]=215;break;case 16:e[r++]=216;break;default:i<256?(e[r++]=199,e[r++]=i):i<65536?(e[r++]=200,e[r++]=i>>8,e[r++]=i&255):(e[r++]=201,e[r++]=i>>24,e[r++]=i>>16&255,e[r++]=i>>8&255,e[r++]=i&255)}return e[r++]=n,e.set(t,r),r+=i,r}function qC(t,e){let r,n=e.length*6,i=t.length-n;for(;r=e.pop();){let s=r.offset,o=r.id;t.copyWithin(s+n,s,i),n-=6;let a=s+n;t[a++]=214,t[a++]=105,t[a++]=o>>24,t[a++]=o>>16&255,t[a++]=o>>8&255,t[a++]=o&255,i=s}return t}function V_(t,e,r){if(Nt.length>0){wt.setUint32(Nt.position+t,ne+r-Nt.position-t),Nt.stringsPosition=ne-t;let n=Nt;Nt=null,e(n[0]),e(n[1])}}function YC(t,e){return t.isCompatible=r=>{let n=!r||(e.lastNamedStructuresLength||0)===r.length;return n||e._mergeStructures(r),n},t}let X_=new KC({useRecords:!1});const VC=X_.pack;X_.pack;const XC=512,ZC=1024,JC=2048;function It(){return null}function Oo(t,e,r={}){if(!w(t))return;const n=[],i=Object.keys(t);for(let s=0;s<i.length;++s){let o=i[s],a=t[o];const c=r[o];w(c)&&(a=c(a));const l=e[o];w(l)&&(o=l),a!==null&&n.push(o,a)}return n}function Ca(t,e,r={}){if(w(t))try{const n={};for(let i=0;i<t.length;i+=2){let s=t[i],o=t[i+1];const a=e[s];w(a)&&(s=a);const c=r[s];w(c)&&(o=c(o)),n[s]=o}return n}catch(n){pt(ce,"","format",n.message)}}function QC(t){try{return VC(t)}catch(e){pt(ce,"","format",e.message)}}function sd(t){if(ye(t)){try{return JSON.parse(t)}catch(e){pt(ce,"","format",e.message)}return}try{return jC(t)}catch(e){pt(ce,"","format",e.message)}}function Z_(){return{id:Bt()}}var vl=(t=>(t[t.kind=0]="kind",t[t.id=1]="id",t[t.x=2]="x",t[t.y=3]="y",t[t.lx=4]="lx",t[t.ly=5]="ly",t[t.code=6]="code",t[t.name=7]="name",t[t.char=8]="char",t[t.color=9]="color",t[t.bg=10]="bg",t[t.light=11]="light",t[t.player=12]="player",t[t.bucket=13]="bucket",t[t.pushable=14]="pushable",t[t.collision=15]="collision",t[t.breakable=16]="breakable",t[t.tickertext=17]="tickertext",t[t.tickertime=18]="tickertime",t[t.p1=19]="p1",t[t.p2=20]="p2",t[t.p3=21]="p3",t[t.cycle=22]="cycle",t[t.stepx=23]="stepx",t[t.stepy=24]="stepy",t[t.sender=25]="sender",t[t.arg=26]="arg",t[t.stopped=27]="stopped",t[t.removed=28]="removed",t[t.party=29]="party",t[t.group=30]="group",t[t.lightdir=31]="lightdir",t[t.item=32]="item",t[t.p4=33]="p4",t[t.p5=34]="p5",t[t.p6=35]="p6",t[t.displaychar=36]="displaychar",t[t.displaycolor=37]="displaycolor",t[t.displaybg=38]="displaybg",t[t.shootx=39]="shootx",t[t.shooty=40]="shooty",t[t.p7=41]="p7",t[t.p8=42]="p8",t[t.p9=43]="p9",t[t.p10=44]="p10",t))(vl||{});function xl(t){return w(t?.id)?Oo(t,vl,{category:It,kinddata:It,stopped:It,removed:It,bucket:It}):Oo(t,vl,{id:It,x:It,y:It,lx:It,ly:It,code:It,category:It,kinddata:It,stopped:It,removed:It,bucket:It})}function El(t){return Ca(t,vl)}function Wt(t){return t?.category===Fr.ISOBJECT}function La(t,e){if(!w(t)||!Sr(e))return;const{color:r,bg:n}=v_(e);w(r)&&(t.color=r),w(n)&&(t.bg=n)}function J_(t,e){return{width:t,height:e,size:t*e,bits:new Uint8Array(t*e).fill(0)}}function od(t){const e=Math.floor(t.length/Sa);if(e*Sa!==t.length)return;const r=J_(3,e);for(let n=0;n<r.bits.length;++n)r.bits[n]=t[n];return r}function eL(t,e){return t&1<<e?255:0}function ad(t){const e=Math.floor(t.length/qf);if(e*qf!==t.length)return;const r=Math.ceil(e/ml),n=Ts*ml,i=J_(n,Ss*r);let s=0,o=0,a=0;for(let c=0;c<t.length;++c){const l=o*Ss+a,u=t[c];for(let h=0;h<Ts;++h){const f=s*Ts+h;i.bits[f+l*n]=eL(u,7-h)}++a,a===Ss&&(a=0,++s,s===ml&&(s=0,++o))}return i}const tL=Uc("000000000000000000000000000000007e81a58181bd99817e00000000007effdbffffc3e7ff7e0000000000006cfefefefe7c381000000000000010387cfe7c3810000000000000183c3ce7e7e718183c0000000000183c7effff7e18183c0000000000000000183c3c180000000000ffffffffffe7c3c3e7ffffffffff000000003c664242663c00000000ffffffffc399bdbd99c3ffffffff00001e0e1a3278cccccc7800000000003c6666663c187e181800000000003f333f30303070f0e000000000007f637f63636367e7e6c0000000001818db3ce73cdb1818000000000080c0e0f8fef8e0c080000000000002060e3efe3e0e06020000000000183c7e1818187e3c18000000000066666666666600666600000000007fdbdbdb7b1b1b1b1b000000007cc660386cc6c66c380cc67c000000000000000000fefefe0000000000183c7e1818187e3c187e00000000183c7e18181818181800000000001818181818187e3c1800000000000000180cfe0c180000000000000000003060fe603000000000000000000000c0c0c0fe000000000000000000286cfe6c2800000000000000001038387c7cfefe00000000000000fefe7c7c3838100000000000000000000000000000000000000000183c3c3c1818001818000000006666662400000000000000000000006c6cfe6c6c6cfe6c6c00000018187cc6c2c07c0686c67c18180000000000c2c60c183066c60000000000386c6c3876dccccc76000000003030306000000000000000000000000c183030303030180c000000000030180c0c0c0c0c183000000000000000663cff3c6600000000000000000018187e181800000000000000000000000000181818300000000000000000fe000000000000000000000000000000001818000000000002060c183060c0800000000000007cc6cedef6e6c6c67c000000000018387818181818187e00000000007cc6060c183060c6fe00000000007cc606063c0606c67c00000000000c1c3c6cccfe0c0c1e0000000000fec0c0c0fc0606c67c00000000003860c0c0fcc6c6c67c0000000000fec6060c183030303000000000007cc6c6c67cc6c6c67c00000000007cc6c6c67e06060c78000000000000181800000018180000000000000018180000001818300000000000060c18306030180c0600000000000000007e00007e000000000000006030180c060c18306000000000007cc6c60c181800181800000000007cc6c6dedededcc07c000000000010386cc6c6fec6c6c60000000000fc6666667c666666fc00000000003c66c2c0c0c0c2663c0000000000f86c66666666666cf80000000000fe66626878686266fe0000000000fe66626878686060f000000000003c66c2c0c0dec6663a0000000000c6c6c6c6fec6c6c6c600000000003c181818181818183c00000000001e0c0c0c0c0ccccc780000000000e6666c6c786c6c66e60000000000f060606060606266fe0000000000c6eefefed6c6c6c6c60000000000c6e6f6fedecec6c6c60000000000386cc6c6c6c6c66c380000000000fc6666667c606060f000000000007cc6c6c6c6d6de7c0c0e00000000fc6666667c6c6666e600000000007cc6c660380cc6c67c00000000007e7e5a18181818183c0000000000c6c6c6c6c6c6c6c67c0000000000c6c6c6c6c6c66c38100000000000c6c6c6c6d6d6fe7c6c0000000000c6c66c3838386cc6c60000000000666666663c1818183c0000000000fec68c183060c2c6fe00000000003c303030303030303c000000000080c0e070381c0e060200000000003c0c0c0c0c0c0c0c3c00000010386cc600000000000000000000000000000000000000000000ff0030301800000000000000000000000000000000780c7ccccc760000000000e06060786c6666667c00000000000000007cc6c0c0c67c00000000001c0c0c3c6ccccccc7600000000000000007cc6fec0c67c0000000000386c6460f0606060f0000000000000000076cccccc7c0ccc78000000e060606c76666666e6000000000018180038181818183c00000000000606000e0606060666663c000000e06060666c786c66e6000000000038181818181818183c0000000000000000ecfed6d6d6c60000000000000000dc666666666600000000000000007cc6c6c6c67c0000000000000000dc6666667c6060f000000000000076cccccc7c0c0c1e000000000000dc76666060f000000000000000007cc6701cc67c0000000000103030fc303030361c0000000000000000cccccccccc760000000000000000666666663c180000000000000000c6c6d6d6fe6c0000000000000000c66c38386cc60000000000000000c6c6c6c67e060cf8000000000000fecc183066fe00000000000e181818701818180e00000000001818181800181818180000000000701818180e18181870000000000076dc000000000000000000000000000010386cc6c6fe0000000000003c66c2c0c0c2663c0c067c000000cccc00cccccccccc76000000000c1830007cc6fec0c67c0000000010386c00780c7ccccc760000000000cccc00780c7ccccc760000000060301800780c7ccccc7600000000386c3800780c7ccccc76000000000000003c6660663c0c063c00000010386c007cc6fec0c67c0000000000cccc007cc6fec0c67c00000000603018007cc6fec0c67c000000000066660038181818183c00000000183c660038181818183c000000006030180038181818183c00000000c6c610386cc6c6fec6c6000000386c3800386cc6c6fec6c600000018306000fe66607c6066fe00000000000000cc76367ed8d86e00000000003e6cccccfeccccccce0000000010386c007cc6c6c6c67c0000000000c6c6007cc6c6c6c67c00000000603018007cc6c6c6c67c000000003078cc00cccccccccc760000000060301800cccccccccc760000000000c6c600c6c6c6c67e060c780000c6c6386cc6c6c6c66c3800000000c6c600c6c6c6c6c6c67c0000000018183c666060663c181800000000386c6460f0606060e6fc000000000066663c187e187e181800000000f8ccccf8c4ccdeccccc6000000000e1b1818187e18181818d870000018306000780c7ccccc76000000000c18300038181818183c00000000183060007cc6c6c6c67c0000000018306000cccccccccc76000000000076dc00dc666666666600000076dc00c6e6f6fedecec6c6000000003c6c6c3e007e0000000000000000386c6c38007c000000000000000000303000303060c6c67c000000000000000000fec0c0c000000000000000000000fe0606060000000000c0c0c6ccd83060dc860c183e0000c0c0c6ccd83066ce9e3e060600000018180018183c3c3c1800000000000000366cd86c36000000000000000000d86c366cd80000000000114411441144114411441144114455aa55aa55aa55aa55aa55aa55aadd77dd77dd77dd77dd77dd77dd77181818181818181818181818181818181818181818f81818181818181818181818f818f818181818181836363636363636f636363636363600000000000000fe3636363636360000000000f818f81818181818183636363636f606f636363636363636363636363636363636363636360000000000fe06f63636363636363636363636f606fe00000000000036363636363636fe0000000000001818181818f818f800000000000000000000000000f8181818181818181818181818181f00000000000018181818181818ff00000000000000000000000000ff181818181818181818181818181f18181818181800000000000000ff00000000000018181818181818ff18181818181818181818181f181f1818181818183636363636363637363636363636363636363637303f00000000000000000000003f30373636363636363636363636f700ff0000000000000000000000ff00f736363636363636363636363730373636363636360000000000ff00ff0000000000003636363636f700f73636363636361818181818ff00ff00000000000036363636363636ff0000000000000000000000ff00ff18181818181800000000000000ff363636363636363636363636363f00000000000018181818181f181f00000000000000000000001f181f181818181818000000000000003f36363636363636363636363636ff3636363636361818181818ff18ff18181818181818181818181818f8000000000000000000000000001f181818181818ffffffffffffffffffffffffffff00000000000000fffffffffffffff0f0f0f0f0f0f0f0f0f0f0f0f0f00f0f0f0f0f0f0f0f0f0f0f0f0f0fffffffffffffff00000000000000000000000076dcd8d8dc76000000000000007cc6fcc6c6fcc0c040000000fec6c6c0c0c0c0c0c000000000000000fe6c6c6c6c6c6c0000000000fec66030183060c6fe00000000000000007ed8d8d8d87000000000000000666666667c6060c000000000000076dc181818181800000000007e183c6666663c187e0000000000386cc6c6fec6c66c380000000000386cc6c6c66c6c6cee00000000001e30180c3e6666663c00000000000000007edbdb7e0000000000000003067edbdbf37e60c000000000001c3060607c6060301c0000000000007cc6c6c6c6c6c6c6000000000000fe0000fe0000fe0000000000000018187e18180000ff000000000030180c060c1830007e00000000000c18306030180c007e00000000000e1b1b1818181818181818181818181818181818d8d8700000000000001818007e001818000000000000000076dc0076dc000000000000386c6c3800000000000000000000000000000018180000000000000000000000000018000000000000000f0c0c0c0c0cec6c3c1c00000000d86c6c6c6c6c000000000000000070d83060c8f800000000000000000000007c7c7c7c7c7c000000000000000000000000000000000000"),Q_=Uc("00000000002a002a00002a2a2a00002a002a2a15002a2a2a15151515153f153f15153f3f3f15153f153f3f3f153f3f3f");var eb=typeof oo=="object"&&oo&&oo.Object===Object&&oo,rL=typeof self=="object"&&self&&self.Object===Object&&self,ni=eb||rL||Function("return this")(),yn=ni.Symbol,tb=Object.prototype,nL=tb.hasOwnProperty,iL=tb.toString,Ma=yn?yn.toStringTag:void 0;function sL(t){var e=nL.call(t,Ma),r=t[Ma];try{t[Ma]=void 0;var n=!0}catch{}var i=iL.call(t);return n&&(e?t[Ma]=r:delete t[Ma]),i}var oL=Object.prototype,aL=oL.toString;function cL(t){return aL.call(t)}var lL="[object Null]",uL="[object Undefined]",rb=yn?yn.toStringTag:void 0;function Ji(t){return t==null?t===void 0?uL:lL:rb&&rb in Object(t)?sL(t):cL(t)}function Mn(t){return t!=null&&typeof t=="object"}var hL="[object Symbol]";function Al(t){return typeof t=="symbol"||Mn(t)&&Ji(t)==hL}function Tl(t,e){for(var r=-1,n=t==null?0:t.length,i=Array(n);++r<n;)i[r]=e(t[r],r,t);return i}var lt=Array.isArray,nb=yn?yn.prototype:void 0,ib=nb?nb.toString:void 0;function sb(t){if(typeof t=="string")return t;if(lt(t))return Tl(t,sb)+"";if(Al(t))return ib?ib.call(t):"";var e=t+"";return e=="0"&&1/t==-1/0?"-0":e}var fL=/\s/;function dL(t){for(var e=t.length;e--&&fL.test(t.charAt(e)););return e}var pL=/^\s+/;function mL(t){return t&&t.slice(0,dL(t)+1).replace(pL,"")}function _n(t){var e=typeof t;return t!=null&&(e=="object"||e=="function")}var ob=NaN,gL=/^[-+]0x[0-9a-f]+$/i,yL=/^0b[01]+$/i,_L=/^0o[0-7]+$/i,bL=parseInt;function wL(t){if(typeof t=="number")return t;if(Al(t))return ob;if(_n(t)){var e=typeof t.valueOf=="function"?t.valueOf():t;t=_n(e)?e+"":e}if(typeof t!="string")return t===0?t:+t;t=mL(t);var r=yL.test(t);return r||_L.test(t)?bL(t.slice(2),r?2:8):gL.test(t)?ob:+t}var ab=1/0,kL=17976931348623157e292;function vL(t){if(!t)return t===0?t:0;if(t=wL(t),t===ab||t===-ab){var e=t<0?-1:1;return e*kL}return t===t?t:0}function Sl(t){var e=vL(t),r=e%1;return e===e?r?e-r:e:0}function Io(t){return t}var xL="[object AsyncFunction]",EL="[object Function]",AL="[object GeneratorFunction]",TL="[object Proxy]";function Ei(t){if(!_n(t))return!1;var e=Ji(t);return e==EL||e==AL||e==xL||e==TL}var cd=ni["__core-js_shared__"],cb=(function(){var t=/[^.]+$/.exec(cd&&cd.keys&&cd.keys.IE_PROTO||"");return t?"Symbol(src)_1."+t:""})();function SL(t){return!!cb&&cb in t}var RL=Function.prototype,OL=RL.toString;function Is(t){if(t!=null){try{return OL.call(t)}catch{}try{return t+""}catch{}}return""}var IL=/[\\^$.*+?()[\]{}|]/g,NL=/^\[object .+?Constructor\]$/,CL=Function.prototype,LL=Object.prototype,ML=CL.toString,UL=LL.hasOwnProperty,$L=RegExp("^"+ML.call(UL).replace(IL,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function PL(t){if(!_n(t)||SL(t))return!1;var e=Ei(t)?$L:NL;return e.test(Is(t))}function BL(t,e){return t?.[e]}function Ns(t,e){var r=BL(t,e);return PL(r)?r:void 0}var ld=Ns(ni,"WeakMap"),lb=Object.create,FL=(function(){function t(){}return function(e){if(!_n(e))return{};if(lb)return lb(e);t.prototype=e;var r=new t;return t.prototype=void 0,r}})();function DL(t,e,r){switch(r.length){case 0:return t.call(e);case 1:return t.call(e,r[0]);case 2:return t.call(e,r[0],r[1]);case 3:return t.call(e,r[0],r[1],r[2])}return t.apply(e,r)}function rr(){}function jL(t,e){var r=-1,n=t.length;for(e||(e=Array(n));++r<n;)e[r]=t[r];return e}var zL=800,WL=16,HL=Date.now;function GL(t){var e=0,r=0;return function(){var n=HL(),i=WL-(n-r);if(r=n,i>0){if(++e>=zL)return arguments[0]}else e=0;return t.apply(void 0,arguments)}}function KL(t){return function(){return t}}var Rl=(function(){try{var t=Ns(Object,"defineProperty");return t({},"",{}),t}catch{}})(),qL=Rl?function(t,e){return Rl(t,"toString",{configurable:!0,enumerable:!1,value:KL(e),writable:!0})}:Io,YL=GL(qL);function ub(t,e){for(var r=-1,n=t==null?0:t.length;++r<n&&e(t[r],r,t)!==!1;);return t}function hb(t,e,r,n){for(var i=t.length,s=r+-1;++s<i;)if(e(t[s],s,t))return s;return-1}function VL(t){return t!==t}function XL(t,e,r){for(var n=r-1,i=t.length;++n<i;)if(t[n]===e)return n;return-1}function ud(t,e,r){return e===e?XL(t,e,r):hb(t,VL,r)}function fb(t,e){var r=t==null?0:t.length;return!!r&&ud(t,e,0)>-1}var ZL=9007199254740991,JL=/^(?:0|[1-9]\d*)$/;function Ol(t,e){var r=typeof t;return e=e??ZL,!!e&&(r=="number"||r!="symbol"&&JL.test(t))&&t>-1&&t%1==0&&t<e}function hd(t,e,r){e=="__proto__"&&Rl?Rl(t,e,{configurable:!0,enumerable:!0,value:r,writable:!0}):t[e]=r}function Ua(t,e){return t===e||t!==t&&e!==e}var QL=Object.prototype,e6=QL.hasOwnProperty;function Il(t,e,r){var n=t[e];(!(e6.call(t,e)&&Ua(n,r))||r===void 0&&!(e in t))&&hd(t,e,r)}function $a(t,e,r,n){var i=!r;r||(r={});for(var s=-1,o=e.length;++s<o;){var a=e[s],c=void 0;c===void 0&&(c=t[a]),i?hd(r,a,c):Il(r,a,c)}return r}var db=Math.max;function t6(t,e,r){return e=db(e===void 0?t.length-1:e,0),function(){for(var n=arguments,i=-1,s=db(n.length-e,0),o=Array(s);++i<s;)o[i]=n[e+i];i=-1;for(var a=Array(e+1);++i<e;)a[i]=n[i];return a[e]=r(o),DL(t,this,a)}}function fd(t,e){return YL(t6(t,e,Io),t+"")}var r6=9007199254740991;function dd(t){return typeof t=="number"&&t>-1&&t%1==0&&t<=r6}function ii(t){return t!=null&&dd(t.length)&&!Ei(t)}function pb(t,e,r){if(!_n(r))return!1;var n=typeof e;return(n=="number"?ii(r)&&Ol(e,r.length):n=="string"&&e in r)?Ua(r[e],t):!1}function n6(t){return fd(function(e,r){var n=-1,i=r.length,s=i>1?r[i-1]:void 0,o=i>2?r[2]:void 0;for(s=t.length>3&&typeof s=="function"?(i--,s):void 0,o&&pb(r[0],r[1],o)&&(s=i<3?void 0:s,i=1),e=Object(e);++n<i;){var a=r[n];a&&t(e,a,n,s)}return e})}var i6=Object.prototype;function Pa(t){var e=t&&t.constructor,r=typeof e=="function"&&e.prototype||i6;return t===r}function s6(t,e){for(var r=-1,n=Array(t);++r<t;)n[r]=e(r);return n}var o6="[object Arguments]";function mb(t){return Mn(t)&&Ji(t)==o6}var gb=Object.prototype,a6=gb.hasOwnProperty,c6=gb.propertyIsEnumerable,Nl=mb((function(){return arguments})())?mb:function(t){return Mn(t)&&a6.call(t,"callee")&&!c6.call(t,"callee")};function l6(){return!1}var yb=typeof exports=="object"&&exports&&!exports.nodeType&&exports,_b=yb&&typeof module=="object"&&module&&!module.nodeType&&module,u6=_b&&_b.exports===yb,bb=u6?ni.Buffer:void 0,h6=bb?bb.isBuffer:void 0,Ba=h6||l6,f6="[object Arguments]",d6="[object Array]",p6="[object Boolean]",m6="[object Date]",g6="[object Error]",y6="[object Function]",_6="[object Map]",b6="[object Number]",w6="[object Object]",k6="[object RegExp]",v6="[object Set]",x6="[object String]",E6="[object WeakMap]",A6="[object ArrayBuffer]",T6="[object DataView]",S6="[object Float32Array]",R6="[object Float64Array]",O6="[object Int8Array]",I6="[object Int16Array]",N6="[object Int32Array]",C6="[object Uint8Array]",L6="[object Uint8ClampedArray]",M6="[object Uint16Array]",U6="[object Uint32Array]",Ot={};Ot[S6]=Ot[R6]=Ot[O6]=Ot[I6]=Ot[N6]=Ot[C6]=Ot[L6]=Ot[M6]=Ot[U6]=!0,Ot[f6]=Ot[d6]=Ot[A6]=Ot[p6]=Ot[T6]=Ot[m6]=Ot[g6]=Ot[y6]=Ot[_6]=Ot[b6]=Ot[w6]=Ot[k6]=Ot[v6]=Ot[x6]=Ot[E6]=!1;function $6(t){return Mn(t)&&dd(t.length)&&!!Ot[Ji(t)]}function Cl(t){return function(e){return t(e)}}var wb=typeof exports=="object"&&exports&&!exports.nodeType&&exports,Fa=wb&&typeof module=="object"&&module&&!module.nodeType&&module,P6=Fa&&Fa.exports===wb,pd=P6&&eb.process,Qi=(function(){try{var t=Fa&&Fa.require&&Fa.require("util").types;return t||pd&&pd.binding&&pd.binding("util")}catch{}})(),kb=Qi&&Qi.isTypedArray,md=kb?Cl(kb):$6,B6=Object.prototype,F6=B6.hasOwnProperty;function vb(t,e){var r=lt(t),n=!r&&Nl(t),i=!r&&!n&&Ba(t),s=!r&&!n&&!i&&md(t),o=r||n||i||s,a=o?s6(t.length,String):[],c=a.length;for(var l in t)(e||F6.call(t,l))&&!(o&&(l=="length"||i&&(l=="offset"||l=="parent")||s&&(l=="buffer"||l=="byteLength"||l=="byteOffset")||Ol(l,c)))&&a.push(l);return a}function xb(t,e){return function(r){return t(e(r))}}var D6=xb(Object.keys,Object),j6=Object.prototype,z6=j6.hasOwnProperty;function Eb(t){if(!Pa(t))return D6(t);var e=[];for(var r in Object(t))z6.call(t,r)&&r!="constructor"&&e.push(r);return e}function bn(t){return ii(t)?vb(t):Eb(t)}var W6=Object.prototype,H6=W6.hasOwnProperty,Wr=n6(function(t,e){if(Pa(e)||ii(e)){$a(e,bn(e),t);return}for(var r in e)H6.call(e,r)&&Il(t,r,e[r])});function G6(t){var e=[];if(t!=null)for(var r in Object(t))e.push(r);return e}var K6=Object.prototype,q6=K6.hasOwnProperty;function Y6(t){if(!_n(t))return G6(t);var e=Pa(t),r=[];for(var n in t)n=="constructor"&&(e||!q6.call(t,n))||r.push(n);return r}function gd(t){return ii(t)?vb(t,!0):Y6(t)}var V6=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,X6=/^\w*$/;function yd(t,e){if(lt(t))return!1;var r=typeof t;return r=="number"||r=="symbol"||r=="boolean"||t==null||Al(t)?!0:X6.test(t)||!V6.test(t)||e!=null&&t in Object(e)}var Da=Ns(Object,"create");function Z6(){this.__data__=Da?Da(null):{},this.size=0}function J6(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e}var Q6="__lodash_hash_undefined__",eM=Object.prototype,tM=eM.hasOwnProperty;function rM(t){var e=this.__data__;if(Da){var r=e[t];return r===Q6?void 0:r}return tM.call(e,t)?e[t]:void 0}var nM=Object.prototype,iM=nM.hasOwnProperty;function sM(t){var e=this.__data__;return Da?e[t]!==void 0:iM.call(e,t)}var oM="__lodash_hash_undefined__";function aM(t,e){var r=this.__data__;return this.size+=this.has(t)?0:1,r[t]=Da&&e===void 0?oM:e,this}function Cs(t){var e=-1,r=t==null?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}Cs.prototype.clear=Z6,Cs.prototype.delete=J6,Cs.prototype.get=rM,Cs.prototype.has=sM,Cs.prototype.set=aM;function cM(){this.__data__=[],this.size=0}function Ll(t,e){for(var r=t.length;r--;)if(Ua(t[r][0],e))return r;return-1}var lM=Array.prototype,uM=lM.splice;function hM(t){var e=this.__data__,r=Ll(e,t);if(r<0)return!1;var n=e.length-1;return r==n?e.pop():uM.call(e,r,1),--this.size,!0}function fM(t){var e=this.__data__,r=Ll(e,t);return r<0?void 0:e[r][1]}function dM(t){return Ll(this.__data__,t)>-1}function pM(t,e){var r=this.__data__,n=Ll(r,t);return n<0?(++this.size,r.push([t,e])):r[n][1]=e,this}function Ai(t){var e=-1,r=t==null?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}Ai.prototype.clear=cM,Ai.prototype.delete=hM,Ai.prototype.get=fM,Ai.prototype.has=dM,Ai.prototype.set=pM;var ja=Ns(ni,"Map");function mM(){this.size=0,this.__data__={hash:new Cs,map:new(ja||Ai),string:new Cs}}function gM(t){var e=typeof t;return e=="string"||e=="number"||e=="symbol"||e=="boolean"?t!=="__proto__":t===null}function Ml(t,e){var r=t.__data__;return gM(e)?r[typeof e=="string"?"string":"hash"]:r.map}function yM(t){var e=Ml(this,t).delete(t);return this.size-=e?1:0,e}function _M(t){return Ml(this,t).get(t)}function bM(t){return Ml(this,t).has(t)}function wM(t,e){var r=Ml(this,t),n=r.size;return r.set(t,e),this.size+=r.size==n?0:1,this}function Ti(t){var e=-1,r=t==null?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}Ti.prototype.clear=mM,Ti.prototype.delete=yM,Ti.prototype.get=_M,Ti.prototype.has=bM,Ti.prototype.set=wM;var kM="Expected a function";function _d(t,e){if(typeof t!="function"||e!=null&&typeof e!="function")throw new TypeError(kM);var r=function(){var n=arguments,i=e?e.apply(this,n):n[0],s=r.cache;if(s.has(i))return s.get(i);var o=t.apply(this,n);return r.cache=s.set(i,o)||s,o};return r.cache=new(_d.Cache||Ti),r}_d.Cache=Ti;var vM=500;function xM(t){var e=_d(t,function(n){return r.size===vM&&r.clear(),n}),r=e.cache;return e}var EM=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,AM=/\\(\\)?/g,TM=xM(function(t){var e=[];return t.charCodeAt(0)===46&&e.push(""),t.replace(EM,function(r,n,i,s){e.push(i?s.replace(AM,"$1"):n||r)}),e});function Ab(t){return t==null?"":sb(t)}function Ul(t,e){return lt(t)?t:yd(t,e)?[t]:TM(Ab(t))}function za(t){if(typeof t=="string"||Al(t))return t;var e=t+"";return e=="0"&&1/t==-1/0?"-0":e}function bd(t,e){e=Ul(e,t);for(var r=0,n=e.length;t!=null&&r<n;)t=t[za(e[r++])];return r&&r==n?t:void 0}function SM(t,e,r){var n=t==null?void 0:bd(t,e);return n===void 0?r:n}function wd(t,e){for(var r=-1,n=e.length,i=t.length;++r<n;)t[i+r]=e[r];return t}var Tb=yn?yn.isConcatSpreadable:void 0;function RM(t){return lt(t)||Nl(t)||!!(Tb&&t&&t[Tb])}function kd(t,e,r,n,i){var s=-1,o=t.length;for(r||(r=RM),i||(i=[]);++s<o;){var a=t[s];r(a)?wd(i,a):n||(i[i.length]=a)}return i}function sn(t){var e=t==null?0:t.length;return e?kd(t):[]}var Sb=xb(Object.getPrototypeOf,Object);function vd(t,e,r){var n=-1,i=t.length;e<0&&(e=-e>i?0:i+e),r=r>i?i:r,r<0&&(r+=i),i=e>r?0:r-e>>>0,e>>>=0;for(var s=Array(i);++n<i;)s[n]=t[n+e];return s}function OM(t,e,r){var n=t.length;return r=r===void 0?n:r,!e&&r>=n?t:vd(t,e,r)}var IM="\\ud800-\\udfff",NM="\\u0300-\\u036f",CM="\\ufe20-\\ufe2f",LM="\\u20d0-\\u20ff",MM=NM+CM+LM,UM="\\ufe0e\\ufe0f",$M="\\u200d",PM=RegExp("["+$M+IM+MM+UM+"]");function Rb(t){return PM.test(t)}function BM(t){return t.split("")}var Ob="\\ud800-\\udfff",FM="\\u0300-\\u036f",DM="\\ufe20-\\ufe2f",jM="\\u20d0-\\u20ff",zM=FM+DM+jM,WM="\\ufe0e\\ufe0f",HM="["+Ob+"]",xd="["+zM+"]",Ed="\\ud83c[\\udffb-\\udfff]",GM="(?:"+xd+"|"+Ed+")",Ib="[^"+Ob+"]",Nb="(?:\\ud83c[\\udde6-\\uddff]){2}",Cb="[\\ud800-\\udbff][\\udc00-\\udfff]",KM="\\u200d",Lb=GM+"?",Mb="["+WM+"]?",qM="(?:"+KM+"(?:"+[Ib,Nb,Cb].join("|")+")"+Mb+Lb+")*",YM=Mb+Lb+qM,VM="(?:"+[Ib+xd+"?",xd,Nb,Cb,HM].join("|")+")",XM=RegExp(Ed+"(?="+Ed+")|"+VM+YM,"g");function ZM(t){return t.match(XM)||[]}function JM(t){return Rb(t)?ZM(t):BM(t)}function QM(t){return function(e){e=Ab(e);var r=Rb(e)?JM(e):void 0,n=r?r[0]:e.charAt(0),i=r?OM(r,1).join(""):e.slice(1);return n[t]()+i}}var Ub=QM("toUpperCase");function e2(t,e,r,n){var i=-1,s=t==null?0:t.length;for(n&&s&&(r=t[++i]);++i<s;)r=e(r,t[i],i,t);return r}function t2(){this.__data__=new Ai,this.size=0}function r2(t){var e=this.__data__,r=e.delete(t);return this.size=e.size,r}function n2(t){return this.__data__.get(t)}function i2(t){return this.__data__.has(t)}var s2=200;function o2(t,e){var r=this.__data__;if(r instanceof Ai){var n=r.__data__;if(!ja||n.length<s2-1)return n.push([t,e]),this.size=++r.size,this;r=this.__data__=new Ti(n)}return r.set(t,e),this.size=r.size,this}function si(t){var e=this.__data__=new Ai(t);this.size=e.size}si.prototype.clear=t2,si.prototype.delete=r2,si.prototype.get=n2,si.prototype.has=i2,si.prototype.set=o2;function a2(t,e){return t&&$a(e,bn(e),t)}function c2(t,e){return t&&$a(e,gd(e),t)}var $b=typeof exports=="object"&&exports&&!exports.nodeType&&exports,Pb=$b&&typeof module=="object"&&module&&!module.nodeType&&module,l2=Pb&&Pb.exports===$b,Bb=l2?ni.Buffer:void 0,Fb=Bb?Bb.allocUnsafe:void 0;function u2(t,e){var r=t.length,n=Fb?Fb(r):new t.constructor(r);return t.copy(n),n}function Ad(t,e){for(var r=-1,n=t==null?0:t.length,i=0,s=[];++r<n;){var o=t[r];e(o,r,t)&&(s[i++]=o)}return s}function Db(){return[]}var h2=Object.prototype,f2=h2.propertyIsEnumerable,jb=Object.getOwnPropertySymbols,Td=jb?function(t){return t==null?[]:(t=Object(t),Ad(jb(t),function(e){return f2.call(t,e)}))}:Db;function d2(t,e){return $a(t,Td(t),e)}var p2=Object.getOwnPropertySymbols,zb=p2?function(t){for(var e=[];t;)wd(e,Td(t)),t=Sb(t);return e}:Db;function m2(t,e){return $a(t,zb(t),e)}function Wb(t,e,r){var n=e(t);return lt(t)?n:wd(n,r(t))}function Sd(t){return Wb(t,bn,Td)}function g2(t){return Wb(t,gd,zb)}var Rd=Ns(ni,"DataView"),Od=Ns(ni,"Promise"),No=Ns(ni,"Set"),Hb="[object Map]",y2="[object Object]",Gb="[object Promise]",Kb="[object Set]",qb="[object WeakMap]",Yb="[object DataView]",_2=Is(Rd),b2=Is(ja),w2=Is(Od),k2=Is(No),v2=Is(ld),wn=Ji;(Rd&&wn(new Rd(new ArrayBuffer(1)))!=Yb||ja&&wn(new ja)!=Hb||Od&&wn(Od.resolve())!=Gb||No&&wn(new No)!=Kb||ld&&wn(new ld)!=qb)&&(wn=function(t){var e=Ji(t),r=e==y2?t.constructor:void 0,n=r?Is(r):"";if(n)switch(n){case _2:return Yb;case b2:return Hb;case w2:return Gb;case k2:return Kb;case v2:return qb}return e});var x2=Object.prototype,E2=x2.hasOwnProperty;function A2(t){var e=t.length,r=new t.constructor(e);return e&&typeof t[0]=="string"&&E2.call(t,"index")&&(r.index=t.index,r.input=t.input),r}var $l=ni.Uint8Array;function T2(t){var e=new t.constructor(t.byteLength);return new $l(e).set(new $l(t)),e}function S2(t,e){var r=t.buffer;return new t.constructor(r,t.byteOffset,t.byteLength)}var R2=/\w*$/;function O2(t){var e=new t.constructor(t.source,R2.exec(t));return e.lastIndex=t.lastIndex,e}var Vb=yn?yn.prototype:void 0,Xb=Vb?Vb.valueOf:void 0;function I2(t){return Xb?Object(Xb.call(t)):{}}function N2(t,e){var r=t.buffer;return new t.constructor(r,t.byteOffset,t.length)}var C2="[object Boolean]",L2="[object Date]",M2="[object Map]",U2="[object Number]",$2="[object RegExp]",P2="[object Set]",B2="[object String]",F2="[object Symbol]",D2="[object ArrayBuffer]",j2="[object DataView]",z2="[object Float32Array]",W2="[object Float64Array]",H2="[object Int8Array]",G2="[object Int16Array]",K2="[object Int32Array]",q2="[object Uint8Array]",Y2="[object Uint8ClampedArray]",V2="[object Uint16Array]",X2="[object Uint32Array]";function Z2(t,e,r){var n=t.constructor;switch(e){case D2:return T2(t);case C2:case L2:return new n(+t);case j2:return S2(t);case z2:case W2:case H2:case G2:case K2:case q2:case Y2:case V2:case X2:return N2(t);case M2:return new n;case U2:case B2:return new n(t);case $2:return O2(t);case P2:return new n;case F2:return I2(t)}}function J2(t){return typeof t.constructor=="function"&&!Pa(t)?FL(Sb(t)):{}}var Q2="[object Map]";function e3(t){return Mn(t)&&wn(t)==Q2}var Zb=Qi&&Qi.isMap,t3=Zb?Cl(Zb):e3,r3="[object Set]";function n3(t){return Mn(t)&&wn(t)==r3}var Jb=Qi&&Qi.isSet,i3=Jb?Cl(Jb):n3,s3=2,Qb="[object Arguments]",o3="[object Array]",a3="[object Boolean]",c3="[object Date]",l3="[object Error]",e1="[object Function]",u3="[object GeneratorFunction]",h3="[object Map]",f3="[object Number]",t1="[object Object]",d3="[object RegExp]",p3="[object Set]",m3="[object String]",g3="[object Symbol]",y3="[object WeakMap]",_3="[object ArrayBuffer]",b3="[object DataView]",w3="[object Float32Array]",k3="[object Float64Array]",v3="[object Int8Array]",x3="[object Int16Array]",E3="[object Int32Array]",A3="[object Uint8Array]",T3="[object Uint8ClampedArray]",S3="[object Uint16Array]",R3="[object Uint32Array]",xt={};xt[Qb]=xt[o3]=xt[_3]=xt[b3]=xt[a3]=xt[c3]=xt[w3]=xt[k3]=xt[v3]=xt[x3]=xt[E3]=xt[h3]=xt[f3]=xt[t1]=xt[d3]=xt[p3]=xt[m3]=xt[g3]=xt[A3]=xt[T3]=xt[S3]=xt[R3]=!0,xt[l3]=xt[e1]=xt[y3]=!1;function Pl(t,e,r,n,i,s){var o,a=e&s3;if(o!==void 0)return o;if(!_n(t))return t;var c=lt(t);if(c)return o=A2(t),jL(t,o);var l=wn(t),u=l==e1||l==u3;if(Ba(t))return u2(t);if(l==t1||l==Qb||u&&!i)return o=u?{}:J2(t),a?m2(t,c2(o,t)):d2(t,a2(o,t));if(!xt[l])return i?t:{};o=Z2(t,l),s||(s=new si);var h=s.get(t);if(h)return h;s.set(t,o),i3(t)?t.forEach(function(m){o.add(Pl(m,e,r,m,t,s))}):t3(t)&&t.forEach(function(m,p){o.set(p,Pl(m,e,r,p,t,s))});var f=Sd,d=c?void 0:f(t);return ub(d||t,function(m,p){d&&(p=m,m=t[p]),Il(o,p,Pl(m,e,r,p,t,s))}),o}var O3=4;function wr(t){return Pl(t,O3)}function Wa(t){for(var e=-1,r=t==null?0:t.length,n=0,i=[];++e<r;){var s=t[e];s&&(i[n++]=s)}return i}var I3="__lodash_hash_undefined__";function N3(t){return this.__data__.set(t,I3),this}function C3(t){return this.__data__.has(t)}function Co(t){var e=-1,r=t==null?0:t.length;for(this.__data__=new Ti;++e<r;)this.add(t[e])}Co.prototype.add=Co.prototype.push=N3,Co.prototype.has=C3;function r1(t,e){for(var r=-1,n=t==null?0:t.length;++r<n;)if(e(t[r],r,t))return!0;return!1}function Id(t,e){return t.has(e)}var L3=1,M3=2;function n1(t,e,r,n,i,s){var o=r&L3,a=t.length,c=e.length;if(a!=c&&!(o&&c>a))return!1;var l=s.get(t),u=s.get(e);if(l&&u)return l==e&&u==t;var h=-1,f=!0,d=r&M3?new Co:void 0;for(s.set(t,e),s.set(e,t);++h<a;){var m=t[h],p=e[h];if(n)var g=o?n(p,m,h,e,t,s):n(m,p,h,t,e,s);if(g!==void 0){if(g)continue;f=!1;break}if(d){if(!r1(e,function(y,_){if(!Id(d,_)&&(m===y||i(m,y,r,n,s)))return d.push(_)})){f=!1;break}}else if(!(m===p||i(m,p,r,n,s))){f=!1;break}}return s.delete(t),s.delete(e),f}function U3(t){var e=-1,r=Array(t.size);return t.forEach(function(n,i){r[++e]=[i,n]}),r}function Nd(t){var e=-1,r=Array(t.size);return t.forEach(function(n){r[++e]=n}),r}var $3=1,P3=2,B3="[object Boolean]",F3="[object Date]",D3="[object Error]",j3="[object Map]",z3="[object Number]",W3="[object RegExp]",H3="[object Set]",G3="[object String]",K3="[object Symbol]",q3="[object ArrayBuffer]",Y3="[object DataView]",i1=yn?yn.prototype:void 0,Cd=i1?i1.valueOf:void 0;function V3(t,e,r,n,i,s,o){switch(r){case Y3:if(t.byteLength!=e.byteLength||t.byteOffset!=e.byteOffset)return!1;t=t.buffer,e=e.buffer;case q3:return!(t.byteLength!=e.byteLength||!s(new $l(t),new $l(e)));case B3:case F3:case z3:return Ua(+t,+e);case D3:return t.name==e.name&&t.message==e.message;case W3:case G3:return t==e+"";case j3:var a=U3;case H3:var c=n&$3;if(a||(a=Nd),t.size!=e.size&&!c)return!1;var l=o.get(t);if(l)return l==e;n|=P3,o.set(t,e);var u=n1(a(t),a(e),n,i,s,o);return o.delete(t),u;case K3:if(Cd)return Cd.call(t)==Cd.call(e)}return!1}var X3=1,Z3=Object.prototype,J3=Z3.hasOwnProperty;function Q3(t,e,r,n,i,s){var o=r&X3,a=Sd(t),c=a.length,l=Sd(e),u=l.length;if(c!=u&&!o)return!1;for(var h=c;h--;){var f=a[h];if(!(o?f in e:J3.call(e,f)))return!1}var d=s.get(t),m=s.get(e);if(d&&m)return d==e&&m==t;var p=!0;s.set(t,e),s.set(e,t);for(var g=o;++h<c;){f=a[h];var y=t[f],_=e[f];if(n)var A=o?n(_,y,f,e,t,s):n(y,_,f,t,e,s);if(!(A===void 0?y===_||i(y,_,r,n,s):A)){p=!1;break}g||(g=f=="constructor")}if(p&&!g){var T=t.constructor,x=e.constructor;T!=x&&"constructor"in t&&"constructor"in e&&!(typeof T=="function"&&T instanceof T&&typeof x=="function"&&x instanceof x)&&(p=!1)}return s.delete(t),s.delete(e),p}var eU=1,s1="[object Arguments]",o1="[object Array]",Bl="[object Object]",tU=Object.prototype,a1=tU.hasOwnProperty;function rU(t,e,r,n,i,s){var o=lt(t),a=lt(e),c=o?o1:wn(t),l=a?o1:wn(e);c=c==s1?Bl:c,l=l==s1?Bl:l;var u=c==Bl,h=l==Bl,f=c==l;if(f&&Ba(t)){if(!Ba(e))return!1;o=!0,u=!1}if(f&&!u)return s||(s=new si),o||md(t)?n1(t,e,r,n,i,s):V3(t,e,c,r,n,i,s);if(!(r&eU)){var d=u&&a1.call(t,"__wrapped__"),m=h&&a1.call(e,"__wrapped__");if(d||m){var p=d?t.value():t,g=m?e.value():e;return s||(s=new si),i(p,g,r,n,s)}}return f?(s||(s=new si),Q3(t,e,r,n,i,s)):!1}function Ld(t,e,r,n,i){return t===e?!0:t==null||e==null||!Mn(t)&&!Mn(e)?t!==t&&e!==e:rU(t,e,r,n,Ld,i)}var nU=1,iU=2;function sU(t,e,r,n){var i=r.length,s=i;if(t==null)return!s;for(t=Object(t);i--;){var o=r[i];if(o[2]?o[1]!==t[o[0]]:!(o[0]in t))return!1}for(;++i<s;){o=r[i];var a=o[0],c=t[a],l=o[1];if(o[2]){if(c===void 0&&!(a in t))return!1}else{var u=new si,h;if(!(h===void 0?Ld(l,c,nU|iU,n,u):h))return!1}}return!0}function c1(t){return t===t&&!_n(t)}function oU(t){for(var e=bn(t),r=e.length;r--;){var n=e[r],i=t[n];e[r]=[n,i,c1(i)]}return e}function l1(t,e){return function(r){return r==null?!1:r[t]===e&&(e!==void 0||t in Object(r))}}function aU(t){var e=oU(t);return e.length==1&&e[0][2]?l1(e[0][0],e[0][1]):function(r){return r===t||sU(r,t,e)}}function cU(t,e){return t!=null&&e in Object(t)}function u1(t,e,r){e=Ul(e,t);for(var n=-1,i=e.length,s=!1;++n<i;){var o=za(e[n]);if(!(s=t!=null&&r(t,o)))break;t=t[o]}return s||++n!=i?s:(i=t==null?0:t.length,!!i&&dd(i)&&Ol(o,i)&&(lt(t)||Nl(t)))}function lU(t,e){return t!=null&&u1(t,e,cU)}var uU=1,hU=2;function fU(t,e){return yd(t)&&c1(e)?l1(za(t),e):function(r){var n=SM(r,t);return n===void 0&&n===e?lU(r,t):Ld(e,n,uU|hU)}}function dU(t){return function(e){return e?.[t]}}function pU(t){return function(e){return bd(e,t)}}function mU(t){return yd(t)?dU(za(t)):pU(t)}function oi(t){return typeof t=="function"?t:t==null?Io:typeof t=="object"?lt(t)?fU(t[0],t[1]):aU(t):mU(t)}function gU(t,e,r,n){for(var i=-1,s=t==null?0:t.length;++i<s;){var o=t[i];e(n,o,r(o),t)}return n}function yU(t){return function(e,r,n){for(var i=-1,s=Object(e),o=n(e),a=o.length;a--;){var c=o[++i];if(r(s[c],c,s)===!1)break}return e}}var _U=yU();function bU(t,e){return t&&_U(t,e,bn)}function wU(t,e){return function(r,n){if(r==null)return r;if(!ii(r))return t(r,n);for(var i=r.length,s=-1,o=Object(r);++s<i&&n(o[s],s,o)!==!1;);return r}}var Ls=wU(bU);function kU(t,e,r,n){return Ls(t,function(i,s,o){e(n,i,r(i),o)}),n}function vU(t,e){return function(r,n){var i=lt(r)?gU:kU,s=e?e():{};return i(r,t,oi(n),s)}}var h1=Object.prototype,xU=h1.hasOwnProperty,Md=fd(function(t,e){t=Object(t);var r=-1,n=e.length,i=n>2?e[2]:void 0;for(i&&pb(e[0],e[1],i)&&(n=1);++r<n;)for(var s=e[r],o=gd(s),a=-1,c=o.length;++a<c;){var l=o[a],u=t[l];(u===void 0||Ua(u,h1[l])&&!xU.call(t,l))&&(t[l]=s[l])}return t});function f1(t){return Mn(t)&&ii(t)}var EU=200;function AU(t,e,r,n){var i=-1,s=fb,o=!0,a=t.length,c=[],l=e.length;if(!a)return c;e.length>=EU&&(s=Id,o=!1,e=new Co(e));e:for(;++i<a;){var u=t[i],h=u;if(u=u!==0?u:0,o&&h===h){for(var f=l;f--;)if(e[f]===h)continue e;c.push(u)}else s(e,h,n)||c.push(u)}return c}var Fl=fd(function(t,e){return f1(t)?AU(t,kd(e,1,f1,!0)):[]});function Lo(t){var e=t==null?0:t.length;return e?t[e-1]:void 0}function kr(t,e,r){var n=t==null?0:t.length;return n?(e=e===void 0?1:Sl(e),vd(t,e<0?0:e,n)):[]}function Ha(t,e,r){var n=t==null?0:t.length;return n?(e=e===void 0?1:Sl(e),e=n-e,vd(t,0,e<0?0:e)):[]}function TU(t){return typeof t=="function"?t:Io}function Ye(t,e){var r=lt(t)?ub:Ls;return r(t,TU(e))}function SU(t,e){for(var r=-1,n=t==null?0:t.length;++r<n;)if(!e(t[r],r,t))return!1;return!0}function RU(t,e){var r=!0;return Ls(t,function(n,i,s){return r=!!e(n,i,s),r}),r}function Un(t,e,r){var n=lt(t)?SU:RU;return n(t,oi(e))}function d1(t,e){var r=[];return Ls(t,function(n,i,s){e(n,i,s)&&r.push(n)}),r}function kn(t,e){var r=lt(t)?Ad:d1;return r(t,oi(e))}function OU(t){return function(e,r,n){var i=Object(e);if(!ii(e)){var s=oi(r);e=bn(e),r=function(a){return s(i[a],a,i)}}var o=t(e,r,n);return o>-1?i[s?e[o]:o]:void 0}}var IU=Math.max;function NU(t,e,r){var n=t==null?0:t.length;if(!n)return-1;var i=r==null?0:Sl(r);return i<0&&(i=IU(n+i,0)),hb(t,oi(e),i)}var Mo=OU(NU);function $n(t){return t&&t.length?t[0]:void 0}function CU(t,e){var r=-1,n=ii(t)?Array(t.length):[];return Ls(t,function(i,s,o){n[++r]=e(i,s,o)}),n}function $e(t,e){var r=lt(t)?Tl:CU;return r(t,oi(e))}function vn(t,e){return kd($e(t,e))}var LU=Object.prototype,MU=LU.hasOwnProperty,p1=vU(function(t,e,r){MU.call(t,r)?t[r].push(e):hd(t,r,[e])}),UU=Object.prototype,$U=UU.hasOwnProperty;function PU(t,e){return t!=null&&$U.call(t,e)}function Ke(t,e){return t!=null&&u1(t,e,PU)}var BU="[object String]";function Hr(t){return typeof t=="string"||!lt(t)&&Mn(t)&&Ji(t)==BU}function FU(t,e){return Tl(e,function(r){return t[r]})}function Yt(t){return t==null?[]:FU(t,bn(t))}var DU=Math.max;function Or(t,e,r,n){t=ii(t)?t:Yt(t),r=r?Sl(r):0;var i=t.length;return r<0&&(r=DU(i+r,0)),Hr(t)?r<=i&&t.indexOf(e,r)>-1:!!i&&ud(t,e,r)>-1}function m1(t,e,r){var n=t==null?0:t.length;if(!n)return-1;var i=0;return ud(t,e,i)}var jU="[object Map]",zU="[object Set]",WU=Object.prototype,HU=WU.hasOwnProperty;function Et(t){if(t==null)return!0;if(ii(t)&&(lt(t)||typeof t=="string"||typeof t.splice=="function"||Ba(t)||md(t)||Nl(t)))return!t.length;var e=wn(t);if(e==jU||e==zU)return!t.size;if(Pa(t))return!Eb(t).length;for(var r in t)if(HU.call(t,r))return!1;return!0}var GU="[object RegExp]";function KU(t){return Mn(t)&&Ji(t)==GU}var g1=Qi&&Qi.isRegExp,Si=g1?Cl(g1):KU;function Ri(t){return t===void 0}var qU="Expected a function";function YU(t){if(typeof t!="function")throw new TypeError(qU);return function(){var e=arguments;switch(e.length){case 0:return!t.call(this);case 1:return!t.call(this,e[0]);case 2:return!t.call(this,e[0],e[1]);case 3:return!t.call(this,e[0],e[1],e[2])}return!t.apply(this,e)}}function VU(t,e,r,n){if(!_n(t))return t;e=Ul(e,t);for(var i=-1,s=e.length,o=s-1,a=t;a!=null&&++i<s;){var c=za(e[i]),l=r;if(c==="__proto__"||c==="constructor"||c==="prototype")return t;if(i!=o){var u=a[c];l=void 0,l===void 0&&(l=_n(u)?u:Ol(e[i+1])?[]:{})}Il(a,c,l),a=a[c]}return t}function XU(t,e,r){for(var n=-1,i=e.length,s={};++n<i;){var o=e[n],a=bd(t,o);r(a,o)&&VU(s,Ul(o,t),a)}return s}function Pn(t,e){if(t==null)return{};var r=Tl(g2(t),function(n){return[n]});return e=oi(e),XU(t,r,function(n,i){return e(n,i[0])})}function ZU(t,e,r,n,i){return i(t,function(s,o,a){r=n?(n=!1,s):e(r,s,o,a)}),r}function Gr(t,e,r){var n=lt(t)?e2:ZU,i=arguments.length<3;return n(t,oi(e),r,i,Ls)}function Dl(t,e){var r=lt(t)?Ad:d1;return r(t,YU(oi(e)))}function JU(t,e){var r;return Ls(t,function(n,i,s){return r=e(n,i,s),!r}),!!r}function Ud(t,e,r){var n=lt(t)?r1:JU;return n(t,oi(e))}var QU=1/0,e8=No&&1/Nd(new No([,-0]))[1]==QU?function(t){return new No(t)}:rr,t8=200;function r8(t,e,r){var n=-1,i=fb,s=t.length,o=!0,a=[],c=a;if(s>=t8){var l=e8(t);if(l)return Nd(l);o=!1,i=Id,c=new Co}else c=a;e:for(;++n<s;){var u=t[n],h=u;if(u=u!==0?u:0,o&&h===h){for(var f=c.length;f--;)if(c[f]===h)continue e;a.push(u)}else i(c,h,r)||(c!==a&&c.push(h),a.push(u))}return a}function jl(t){return t&&t.length?r8(t):[]}function $d(t){console&&console.error&&console.error(`Error: ${t}`)}function y1(t){console&&console.warn&&console.warn(`Warning: ${t}`)}function _1(t){const e=new Date().getTime(),r=t();return{time:new Date().getTime()-e,value:r}}function b1(t){function e(){}e.prototype=t;const r=new e;function n(){return typeof r.bar}return n(),n(),t}function n8(t){return i8(t)?t.LABEL:t.name}function i8(t){return Hr(t.LABEL)&&t.LABEL!==""}class ai{get definition(){return this._definition}set definition(e){this._definition=e}constructor(e){this._definition=e}accept(e){e.visit(this),Ye(this.definition,r=>{r.accept(e)})}}class Kr extends ai{constructor(e){super([]),this.idx=1,Wr(this,Pn(e,r=>r!==void 0))}set definition(e){}get definition(){return this.referencedRule!==void 0?this.referencedRule.definition:[]}accept(e){e.visit(this)}}class Uo extends ai{constructor(e){super(e.definition),this.orgText="",Wr(this,Pn(e,r=>r!==void 0))}}class qr extends ai{constructor(e){super(e.definition),this.ignoreAmbiguities=!1,Wr(this,Pn(e,r=>r!==void 0))}}class Yr extends ai{constructor(e){super(e.definition),this.idx=1,Wr(this,Pn(e,r=>r!==void 0))}}class ci extends ai{constructor(e){super(e.definition),this.idx=1,Wr(this,Pn(e,r=>r!==void 0))}}class li extends ai{constructor(e){super(e.definition),this.idx=1,Wr(this,Pn(e,r=>r!==void 0))}}class nr extends ai{constructor(e){super(e.definition),this.idx=1,Wr(this,Pn(e,r=>r!==void 0))}}class Bn extends ai{constructor(e){super(e.definition),this.idx=1,Wr(this,Pn(e,r=>r!==void 0))}}class Fn extends ai{get definition(){return this._definition}set definition(e){this._definition=e}constructor(e){super(e.definition),this.idx=1,this.ignoreAmbiguities=!1,this.hasPredicates=!1,Wr(this,Pn(e,r=>r!==void 0))}}class Ct{constructor(e){this.idx=1,Wr(this,Pn(e,r=>r!==void 0))}accept(e){e.visit(this)}}function s8(t){return $e(t,zl)}function zl(t){function e(r){return $e(r,zl)}if(t instanceof Kr){const r={type:"NonTerminal",name:t.nonTerminalName,idx:t.idx};return Hr(t.label)&&(r.label=t.label),r}else{if(t instanceof qr)return{type:"Alternative",definition:e(t.definition)};if(t instanceof Yr)return{type:"Option",idx:t.idx,definition:e(t.definition)};if(t instanceof ci)return{type:"RepetitionMandatory",idx:t.idx,definition:e(t.definition)};if(t instanceof li)return{type:"RepetitionMandatoryWithSeparator",idx:t.idx,separator:zl(new Ct({terminalType:t.separator})),definition:e(t.definition)};if(t instanceof Bn)return{type:"RepetitionWithSeparator",idx:t.idx,separator:zl(new Ct({terminalType:t.separator})),definition:e(t.definition)};if(t instanceof nr)return{type:"Repetition",idx:t.idx,definition:e(t.definition)};if(t instanceof Fn)return{type:"Alternation",idx:t.idx,definition:e(t.definition)};if(t instanceof Ct){const r={type:"Terminal",name:t.terminalType.name,label:n8(t.terminalType),idx:t.idx};Hr(t.label)&&(r.terminalLabel=t.label);const n=t.terminalType.PATTERN;return t.terminalType.PATTERN&&(r.pattern=Si(n)?n.source:n),r}else{if(t instanceof Uo)return{type:"Rule",name:t.name,orgText:t.orgText,definition:e(t.definition)};throw Error("non exhaustive match")}}}class Ms{visit(e){const r=e;switch(r.constructor){case Kr:return this.visitNonTerminal(r);case qr:return this.visitAlternative(r);case Yr:return this.visitOption(r);case ci:return this.visitRepetitionMandatory(r);case li:return this.visitRepetitionMandatoryWithSeparator(r);case Bn:return this.visitRepetitionWithSeparator(r);case nr:return this.visitRepetition(r);case Fn:return this.visitAlternation(r);case Ct:return this.visitTerminal(r);case Uo:return this.visitRule(r);default:throw Error("non exhaustive match")}}visitNonTerminal(e){}visitAlternative(e){}visitOption(e){}visitRepetition(e){}visitRepetitionMandatory(e){}visitRepetitionMandatoryWithSeparator(e){}visitRepetitionWithSeparator(e){}visitAlternation(e){}visitTerminal(e){}visitRule(e){}}function o8(t){return t instanceof qr||t instanceof Yr||t instanceof nr||t instanceof ci||t instanceof li||t instanceof Bn||t instanceof Ct||t instanceof Uo}function Wl(t,e=[]){return t instanceof Yr||t instanceof nr||t instanceof Bn?!0:t instanceof Fn?Ud(t.definition,n=>Wl(n,e)):t instanceof Kr&&Or(e,t)?!1:t instanceof ai?(t instanceof Kr&&e.push(t),Un(t.definition,n=>Wl(n,e))):!1}function a8(t){return t instanceof Fn}function ui(t){if(t instanceof Kr)return"SUBRULE";if(t instanceof Yr)return"OPTION";if(t instanceof Fn)return"OR";if(t instanceof ci)return"AT_LEAST_ONE";if(t instanceof li)return"AT_LEAST_ONE_SEP";if(t instanceof Bn)return"MANY_SEP";if(t instanceof nr)return"MANY";if(t instanceof Ct)return"CONSUME";throw Error("non exhaustive match")}class Hl{walk(e,r=[]){Ye(e.definition,(n,i)=>{const s=kr(e.definition,i+1);if(n instanceof Kr)this.walkProdRef(n,s,r);else if(n instanceof Ct)this.walkTerminal(n,s,r);else if(n instanceof qr)this.walkFlat(n,s,r);else if(n instanceof Yr)this.walkOption(n,s,r);else if(n instanceof ci)this.walkAtLeastOne(n,s,r);else if(n instanceof li)this.walkAtLeastOneSep(n,s,r);else if(n instanceof Bn)this.walkManySep(n,s,r);else if(n instanceof nr)this.walkMany(n,s,r);else if(n instanceof Fn)this.walkOr(n,s,r);else throw Error("non exhaustive match")})}walkTerminal(e,r,n){}walkProdRef(e,r,n){}walkFlat(e,r,n){const i=r.concat(n);this.walk(e,i)}walkOption(e,r,n){const i=r.concat(n);this.walk(e,i)}walkAtLeastOne(e,r,n){const i=[new Yr({definition:e.definition})].concat(r,n);this.walk(e,i)}walkAtLeastOneSep(e,r,n){const i=w1(e,r,n);this.walk(e,i)}walkMany(e,r,n){const i=[new Yr({definition:e.definition})].concat(r,n);this.walk(e,i)}walkManySep(e,r,n){const i=w1(e,r,n);this.walk(e,i)}walkOr(e,r,n){const i=r.concat(n);Ye(e.definition,s=>{const o=new qr({definition:[s]});this.walk(o,i)})}}function w1(t,e,r){return[new Yr({definition:[new Ct({terminalType:t.separator})].concat(t.definition)})].concat(e,r)}function Ga(t){if(t instanceof Kr)return Ga(t.referencedRule);if(t instanceof Ct)return u8(t);if(o8(t))return c8(t);if(a8(t))return l8(t);throw Error("non exhaustive match")}function c8(t){let e=[];const r=t.definition;let n=0,i=r.length>n,s,o=!0;for(;i&&o;)s=r[n],o=Wl(s),e=e.concat(Ga(s)),n=n+1,i=r.length>n;return jl(e)}function l8(t){const e=$e(t.definition,r=>Ga(r));return jl(sn(e))}function u8(t){return[t.terminalType]}const k1="_~IN~_";class h8 extends Hl{constructor(e){super(),this.topProd=e,this.follows={}}startWalking(){return this.walk(this.topProd),this.follows}walkTerminal(e,r,n){}walkProdRef(e,r,n){const i=d8(e.referencedRule,e.idx)+this.topProd.name,s=r.concat(n),o=new qr({definition:s}),a=Ga(o);this.follows[i]=a}}function f8(t){const e={};return Ye(t,r=>{const n=new h8(r).startWalking();Wr(e,n)}),e}function d8(t,e){return t.name+e+k1}function Ve(t){return t.charCodeAt(0)}function Pd(t,e){Array.isArray(t)?t.forEach(function(r){e.push(r)}):e.push(t)}function Ka(t,e){if(t[e]===!0)throw"duplicate flag "+e;t[e],t[e]=!0}function $o(t){if(t===void 0)throw Error("Internal Error - Should never get here!");return!0}function p8(){throw Error("Internal Error - Should never get here!")}function v1(t){return t.type==="Character"}const Gl=[];for(let t=Ve("0");t<=Ve("9");t++)Gl.push(t);const Kl=[Ve("_")].concat(Gl);for(let t=Ve("a");t<=Ve("z");t++)Kl.push(t);for(let t=Ve("A");t<=Ve("Z");t++)Kl.push(t);const x1=[Ve(" "),Ve("\f"),Ve(`
`),Ve("\r"),Ve("	"),Ve("\v"),Ve("	"),Ve(" "),Ve(" "),Ve(" "),Ve(" "),Ve(" "),Ve(" "),Ve(" "),Ve(" "),Ve(" "),Ve(" "),Ve(" "),Ve(" "),Ve(" "),Ve("\u2028"),Ve("\u2029"),Ve(" "),Ve(" "),Ve("　"),Ve("\uFEFF")],m8=/[0-9a-fA-F]/,ql=/[0-9]/,g8=/[1-9]/;class y8{constructor(){this.idx=0,this.input="",this.groupIdx=0}saveState(){return{idx:this.idx,input:this.input,groupIdx:this.groupIdx}}restoreState(e){this.idx=e.idx,this.input=e.input,this.groupIdx=e.groupIdx}pattern(e){this.idx=0,this.input=e,this.groupIdx=0,this.consumeChar("/");const r=this.disjunction();this.consumeChar("/");const n={type:"Flags",loc:{begin:this.idx,end:e.length},global:!1,ignoreCase:!1,multiLine:!1,unicode:!1,sticky:!1};for(;this.isRegExpFlag();)switch(this.popChar()){case"g":Ka(n,"global");break;case"i":Ka(n,"ignoreCase");break;case"m":Ka(n,"multiLine");break;case"u":Ka(n,"unicode");break;case"y":Ka(n,"sticky");break}if(this.idx!==this.input.length)throw Error("Redundant input: "+this.input.substring(this.idx));return{type:"Pattern",flags:n,value:r,loc:this.loc(0)}}disjunction(){const e=[],r=this.idx;for(e.push(this.alternative());this.peekChar()==="|";)this.consumeChar("|"),e.push(this.alternative());return{type:"Disjunction",value:e,loc:this.loc(r)}}alternative(){const e=[],r=this.idx;for(;this.isTerm();)e.push(this.term());return{type:"Alternative",value:e,loc:this.loc(r)}}term(){return this.isAssertion()?this.assertion():this.atom()}assertion(){const e=this.idx;switch(this.popChar()){case"^":return{type:"StartAnchor",loc:this.loc(e)};case"$":return{type:"EndAnchor",loc:this.loc(e)};case"\\":switch(this.popChar()){case"b":return{type:"WordBoundary",loc:this.loc(e)};case"B":return{type:"NonWordBoundary",loc:this.loc(e)}}throw Error("Invalid Assertion Escape");case"(":this.consumeChar("?");let r;switch(this.popChar()){case"=":r="Lookahead";break;case"!":r="NegativeLookahead";break}$o(r);const n=this.disjunction();return this.consumeChar(")"),{type:r,value:n,loc:this.loc(e)}}return p8()}quantifier(e=!1){let r;const n=this.idx;switch(this.popChar()){case"*":r={atLeast:0,atMost:1/0};break;case"+":r={atLeast:1,atMost:1/0};break;case"?":r={atLeast:0,atMost:1};break;case"{":const i=this.integerIncludingZero();switch(this.popChar()){case"}":r={atLeast:i,atMost:i};break;case",":let s;this.isDigit()?(s=this.integerIncludingZero(),r={atLeast:i,atMost:s}):r={atLeast:i,atMost:1/0},this.consumeChar("}");break}if(e===!0&&r===void 0)return;$o(r);break}if(!(e===!0&&r===void 0)&&$o(r))return this.peekChar(0)==="?"?(this.consumeChar("?"),r.greedy=!1):r.greedy=!0,r.type="Quantifier",r.loc=this.loc(n),r}atom(){let e;const r=this.idx;switch(this.peekChar()){case".":e=this.dotAll();break;case"\\":e=this.atomEscape();break;case"[":e=this.characterClass();break;case"(":e=this.group();break}if(e===void 0&&this.isPatternCharacter()&&(e=this.patternCharacter()),$o(e))return e.loc=this.loc(r),this.isQuantifier()&&(e.quantifier=this.quantifier()),e}dotAll(){return this.consumeChar("."),{type:"Set",complement:!0,value:[Ve(`
`),Ve("\r"),Ve("\u2028"),Ve("\u2029")]}}atomEscape(){switch(this.consumeChar("\\"),this.peekChar()){case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":return this.decimalEscapeAtom();case"d":case"D":case"s":case"S":case"w":case"W":return this.characterClassEscape();case"f":case"n":case"r":case"t":case"v":return this.controlEscapeAtom();case"c":return this.controlLetterEscapeAtom();case"0":return this.nulCharacterAtom();case"x":return this.hexEscapeSequenceAtom();case"u":return this.regExpUnicodeEscapeSequenceAtom();default:return this.identityEscapeAtom()}}decimalEscapeAtom(){return{type:"GroupBackReference",value:this.positiveInteger()}}characterClassEscape(){let e,r=!1;switch(this.popChar()){case"d":e=Gl;break;case"D":e=Gl,r=!0;break;case"s":e=x1;break;case"S":e=x1,r=!0;break;case"w":e=Kl;break;case"W":e=Kl,r=!0;break}if($o(e))return{type:"Set",value:e,complement:r}}controlEscapeAtom(){let e;switch(this.popChar()){case"f":e=Ve("\f");break;case"n":e=Ve(`
`);break;case"r":e=Ve("\r");break;case"t":e=Ve("	");break;case"v":e=Ve("\v");break}if($o(e))return{type:"Character",value:e}}controlLetterEscapeAtom(){this.consumeChar("c");const e=this.popChar();if(/[a-zA-Z]/.test(e)===!1)throw Error("Invalid ");return{type:"Character",value:e.toUpperCase().charCodeAt(0)-64}}nulCharacterAtom(){return this.consumeChar("0"),{type:"Character",value:Ve("\0")}}hexEscapeSequenceAtom(){return this.consumeChar("x"),this.parseHexDigits(2)}regExpUnicodeEscapeSequenceAtom(){return this.consumeChar("u"),this.parseHexDigits(4)}identityEscapeAtom(){const e=this.popChar();return{type:"Character",value:Ve(e)}}classPatternCharacterAtom(){switch(this.peekChar()){case`
`:case"\r":case"\u2028":case"\u2029":case"\\":case"]":throw Error("TBD");default:const e=this.popChar();return{type:"Character",value:Ve(e)}}}characterClass(){const e=[];let r=!1;for(this.consumeChar("["),this.peekChar(0)==="^"&&(this.consumeChar("^"),r=!0);this.isClassAtom();){const n=this.classAtom();if(n.type,v1(n)&&this.isRangeDash()){this.consumeChar("-");const i=this.classAtom();if(i.type,v1(i)){if(i.value<n.value)throw Error("Range out of order in character class");e.push({from:n.value,to:i.value})}else Pd(n.value,e),e.push(Ve("-")),Pd(i.value,e)}else Pd(n.value,e)}return this.consumeChar("]"),{type:"Set",complement:r,value:e}}classAtom(){switch(this.peekChar()){case"]":case`
`:case"\r":case"\u2028":case"\u2029":throw Error("TBD");case"\\":return this.classEscape();default:return this.classPatternCharacterAtom()}}classEscape(){switch(this.consumeChar("\\"),this.peekChar()){case"b":return this.consumeChar("b"),{type:"Character",value:Ve("\b")};case"d":case"D":case"s":case"S":case"w":case"W":return this.characterClassEscape();case"f":case"n":case"r":case"t":case"v":return this.controlEscapeAtom();case"c":return this.controlLetterEscapeAtom();case"0":return this.nulCharacterAtom();case"x":return this.hexEscapeSequenceAtom();case"u":return this.regExpUnicodeEscapeSequenceAtom();default:return this.identityEscapeAtom()}}group(){let e=!0;switch(this.consumeChar("("),this.peekChar(0)){case"?":this.consumeChar("?"),this.consumeChar(":"),e=!1;break;default:this.groupIdx++;break}const r=this.disjunction();this.consumeChar(")");const n={type:"Group",capturing:e,value:r};return e&&(n.idx=this.groupIdx),n}positiveInteger(){let e=this.popChar();if(g8.test(e)===!1)throw Error("Expecting a positive integer");for(;ql.test(this.peekChar(0));)e+=this.popChar();return parseInt(e,10)}integerIncludingZero(){let e=this.popChar();if(ql.test(e)===!1)throw Error("Expecting an integer");for(;ql.test(this.peekChar(0));)e+=this.popChar();return parseInt(e,10)}patternCharacter(){const e=this.popChar();switch(e){case`
`:case"\r":case"\u2028":case"\u2029":case"^":case"$":case"\\":case".":case"*":case"+":case"?":case"(":case")":case"[":case"|":throw Error("TBD");default:return{type:"Character",value:Ve(e)}}}isRegExpFlag(){switch(this.peekChar(0)){case"g":case"i":case"m":case"u":case"y":return!0;default:return!1}}isRangeDash(){return this.peekChar()==="-"&&this.isClassAtom(1)}isDigit(){return ql.test(this.peekChar(0))}isClassAtom(e=0){switch(this.peekChar(e)){case"]":case`
`:case"\r":case"\u2028":case"\u2029":return!1;default:return!0}}isTerm(){return this.isAtom()||this.isAssertion()}isAtom(){if(this.isPatternCharacter())return!0;switch(this.peekChar(0)){case".":case"\\":case"[":case"(":return!0;default:return!1}}isAssertion(){switch(this.peekChar(0)){case"^":case"$":return!0;case"\\":switch(this.peekChar(1)){case"b":case"B":return!0;default:return!1}case"(":return this.peekChar(1)==="?"&&(this.peekChar(2)==="="||this.peekChar(2)==="!");default:return!1}}isQuantifier(){const e=this.saveState();try{return this.quantifier(!0)!==void 0}catch{return!1}finally{this.restoreState(e)}}isPatternCharacter(){switch(this.peekChar()){case"^":case"$":case"\\":case".":case"*":case"+":case"?":case"(":case")":case"[":case"|":case"/":case`
`:case"\r":case"\u2028":case"\u2029":return!1;default:return!0}}parseHexDigits(e){let r="";for(let i=0;i<e;i++){const s=this.popChar();if(m8.test(s)===!1)throw Error("Expecting a HexDecimal digits");r+=s}return{type:"Character",value:parseInt(r,16)}}peekChar(e=0){return this.input[this.idx+e]}popChar(){const e=this.peekChar(0);return this.consumeChar(void 0),e}consumeChar(e){if(e!==void 0&&this.input[this.idx]!==e)throw Error("Expected: '"+e+"' but found: '"+this.input[this.idx]+"' at offset: "+this.idx);if(this.idx>=this.input.length)throw Error("Unexpected end of input");this.idx++}loc(e){return{begin:e,end:this.idx}}}class Bd{visitChildren(e){for(const r in e){const n=e[r];e.hasOwnProperty(r)&&(n.type!==void 0?this.visit(n):Array.isArray(n)&&n.forEach(i=>{this.visit(i)},this))}}visit(e){switch(e.type){case"Pattern":this.visitPattern(e);break;case"Flags":this.visitFlags(e);break;case"Disjunction":this.visitDisjunction(e);break;case"Alternative":this.visitAlternative(e);break;case"StartAnchor":this.visitStartAnchor(e);break;case"EndAnchor":this.visitEndAnchor(e);break;case"WordBoundary":this.visitWordBoundary(e);break;case"NonWordBoundary":this.visitNonWordBoundary(e);break;case"Lookahead":this.visitLookahead(e);break;case"NegativeLookahead":this.visitNegativeLookahead(e);break;case"Character":this.visitCharacter(e);break;case"Set":this.visitSet(e);break;case"Group":this.visitGroup(e);break;case"GroupBackReference":this.visitGroupBackReference(e);break;case"Quantifier":this.visitQuantifier(e);break}this.visitChildren(e)}visitPattern(e){}visitFlags(e){}visitDisjunction(e){}visitAlternative(e){}visitStartAnchor(e){}visitEndAnchor(e){}visitWordBoundary(e){}visitNonWordBoundary(e){}visitLookahead(e){}visitNegativeLookahead(e){}visitCharacter(e){}visitSet(e){}visitGroup(e){}visitGroupBackReference(e){}visitQuantifier(e){}}let Yl={};const _8=new y8;function Vl(t){const e=t.toString();if(Yl.hasOwnProperty(e))return Yl[e];{const r=_8.pattern(e);return Yl[e]=r,r}}function b8(){Yl={}}const E1="Complement Sets are not supported for first char optimization",Xl=`Unable to use "first char" lexer optimizations:
`;function w8(t,e=!1){try{const r=Vl(t);return Fd(r.value,{},r.flags.ignoreCase)}catch(r){if(r.message===E1)e&&y1(`${Xl}	Unable to optimize: < ${t.toString()} >
	Complement Sets cannot be automatically optimized.
	This will disable the lexer's first char optimizations.
	See: https://chevrotain.io/docs/guide/resolving_lexer_errors.html#COMPLEMENT for details.`);else{let n="";e&&(n=`
	This will disable the lexer's first char optimizations.
	See: https://chevrotain.io/docs/guide/resolving_lexer_errors.html#REGEXP_PARSING for details.`),$d(`${Xl}
	Failed parsing: < ${t.toString()} >
	Using the @chevrotain/regexp-to-ast library
	Please open an issue at: https://github.com/chevrotain/chevrotain/issues`+n)}}return[]}function Fd(t,e,r){switch(t.type){case"Disjunction":for(let i=0;i<t.value.length;i++)Fd(t.value[i],e,r);break;case"Alternative":const n=t.value;for(let i=0;i<n.length;i++){const s=n[i];switch(s.type){case"EndAnchor":case"GroupBackReference":case"Lookahead":case"NegativeLookahead":case"StartAnchor":case"WordBoundary":case"NonWordBoundary":continue}const o=s;switch(o.type){case"Character":Zl(o.value,e,r);break;case"Set":if(o.complement===!0)throw Error(E1);Ye(o.value,c=>{if(typeof c=="number")Zl(c,e,r);else{const l=c;if(r===!0)for(let u=l.from;u<=l.to;u++)Zl(u,e,r);else{for(let u=l.from;u<=l.to&&u<Ya;u++)Zl(u,e,r);if(l.to>=Ya){const u=l.from>=Ya?l.from:Ya,h=l.to,f=es(u),d=es(h);for(let m=f;m<=d;m++)e[m]=m}}}});break;case"Group":Fd(o.value,e,r);break;default:throw Error("Non Exhaustive Match")}const a=o.quantifier!==void 0&&o.quantifier.atLeast===0;if(o.type==="Group"&&Dd(o)===!1||o.type!=="Group"&&a===!1)break}break;default:throw Error("non exhaustive match!")}return Yt(e)}function Zl(t,e,r){const n=es(t);e[n]=n,r===!0&&k8(t,e)}function k8(t,e){const r=String.fromCharCode(t),n=r.toUpperCase();if(n!==r){const i=es(n.charCodeAt(0));e[i]=i}else{const i=r.toLowerCase();if(i!==r){const s=es(i.charCodeAt(0));e[s]=s}}}function A1(t,e){return Mo(t.value,r=>{if(typeof r=="number")return Or(e,r);{const n=r;return Mo(e,i=>n.from<=i&&i<=n.to)!==void 0}})}function Dd(t){const e=t.quantifier;return e&&e.atLeast===0?!0:t.value?lt(t.value)?Un(t.value,Dd):Dd(t.value):!1}class v8 extends Bd{constructor(e){super(),this.targetCharCodes=e,this.found=!1}visitChildren(e){if(this.found!==!0){switch(e.type){case"Lookahead":this.visitLookahead(e);return;case"NegativeLookahead":this.visitNegativeLookahead(e);return}super.visitChildren(e)}}visitCharacter(e){Or(this.targetCharCodes,e.value)&&(this.found=!0)}visitSet(e){e.complement?A1(e,this.targetCharCodes)===void 0&&(this.found=!0):A1(e,this.targetCharCodes)!==void 0&&(this.found=!0)}}function jd(t,e){if(e instanceof RegExp){const r=Vl(e),n=new v8(t);return n.visit(r),n.found}else return Mo(e,r=>Or(t,r.charCodeAt(0)))!==void 0}const Us="PATTERN",qa="defaultMode",Jl="modes";let T1=typeof new RegExp("(?:)").sticky=="boolean";function x8(t,e){e=Md(e,{useSticky:T1,debug:!1,safeMode:!1,positionTracking:"full",lineTerminatorCharacters:["\r",`
`],tracer:(_,A)=>A()});const r=e.tracer;r("initCharCodeToOptimizedIndexMap",()=>{K8()});let n;r("Reject Lexer.NA",()=>{n=Dl(t,_=>_[Us]===ur.NA)});let i=!1,s;r("Transform Patterns",()=>{i=!1,s=$e(n,_=>{const A=_[Us];if(Si(A)){const T=A.source;return T.length===1&&T!=="^"&&T!=="$"&&T!=="."&&!A.ignoreCase?T:T.length===2&&T[0]==="\\"&&!Or(["d","D","s","S","t","r","n","t","0","c","b","B","f","v","w","W"],T[1])?T[1]:e.useSticky?R1(A):S1(A)}else{if(Ei(A))return i=!0,{exec:A};if(typeof A=="object")return i=!0,A;if(typeof A=="string"){if(A.length===1)return A;{const T=A.replace(/[\\^$.*+?()[\]{}|]/g,"\\$&"),x=new RegExp(T);return e.useSticky?R1(x):S1(x)}}else throw Error("non exhaustive match")}})});let o,a,c,l,u;r("misc mapping",()=>{o=$e(n,_=>_.tokenTypeIdx),a=$e(n,_=>{const A=_.GROUP;if(A!==ur.SKIPPED){if(Hr(A))return A;if(Ri(A))return!1;throw Error("non exhaustive match")}}),c=$e(n,_=>{const A=_.LONGER_ALT;if(A)return lt(A)?$e(A,x=>m1(n,x)):[m1(n,A)]}),l=$e(n,_=>_.PUSH_MODE),u=$e(n,_=>Ke(_,"POP_MODE"))});let h;r("Line Terminator Handling",()=>{const _=N1(e.lineTerminatorCharacters);h=$e(n,A=>!1),e.positionTracking!=="onlyOffset"&&(h=$e(n,A=>Ke(A,"LINE_BREAKS")?!!A.LINE_BREAKS:I1(A,_)===!1&&jd(_,A.PATTERN)))});let f,d,m,p;r("Misc Mapping #2",()=>{f=$e(n,O1),d=$e(s,W8),m=Gr(n,(_,A)=>{const T=A.GROUP;return Hr(T)&&T!==ur.SKIPPED&&(_[T]=[]),_},{}),p=$e(s,(_,A)=>({pattern:s[A],longerAlt:c[A],canLineTerminator:h[A],isCustom:f[A],short:d[A],group:a[A],push:l[A],pop:u[A],tokenTypeIdx:o[A],tokenType:n[A]}))});let g=!0,y=[];return e.safeMode||r("First Char Optimization",()=>{y=Gr(n,(_,A,T)=>{if(typeof A.PATTERN=="string"){const x=A.PATTERN.charCodeAt(0),M=es(x);zd(_,M,p[T])}else if(lt(A.START_CHARS_HINT)){let x;Ye(A.START_CHARS_HINT,M=>{const R=typeof M=="string"?M.charCodeAt(0):M,P=es(R);x!==P&&(x=P,zd(_,P,p[T]))})}else if(Si(A.PATTERN))if(A.PATTERN.unicode)g=!1,e.ensureOptimizations&&$d(`${Xl}	Unable to analyze < ${A.PATTERN.toString()} > pattern.
	The regexp unicode flag is not currently supported by the regexp-to-ast library.
	This will disable the lexer's first char optimizations.
	For details See: https://chevrotain.io/docs/guide/resolving_lexer_errors.html#UNICODE_OPTIMIZE`);else{const x=w8(A.PATTERN,e.ensureOptimizations);Et(x)&&(g=!1),Ye(x,M=>{zd(_,M,p[T])})}else e.ensureOptimizations&&$d(`${Xl}	TokenType: <${A.name}> is using a custom token pattern without providing <start_chars_hint> parameter.
	This will disable the lexer's first char optimizations.
	For details See: https://chevrotain.io/docs/guide/resolving_lexer_errors.html#CUSTOM_OPTIMIZE`),g=!1;return _},[])}),{emptyGroups:m,patternIdxToConfig:p,charCodeToPatternIdxToConfig:y,hasCustom:i,canBeOptimized:g}}function E8(t,e){let r=[];const n=T8(t);r=r.concat(n.errors);const i=S8(n.valid),s=i.valid;return r=r.concat(i.errors),r=r.concat(A8(s)),r=r.concat(U8(s)),r=r.concat($8(s,e)),r=r.concat(P8(s)),r}function A8(t){let e=[];const r=kn(t,n=>Si(n[Us]));return e=e.concat(O8(r)),e=e.concat(C8(r)),e=e.concat(L8(r)),e=e.concat(M8(r)),e=e.concat(I8(r)),e}function T8(t){const e=kn(t,i=>!Ke(i,Us)),r=$e(e,i=>({message:"Token Type: ->"+i.name+"<- missing static 'PATTERN' property",type:Ut.MISSING_PATTERN,tokenTypes:[i]})),n=Fl(t,e);return{errors:r,valid:n}}function S8(t){const e=kn(t,i=>{const s=i[Us];return!Si(s)&&!Ei(s)&&!Ke(s,"exec")&&!Hr(s)}),r=$e(e,i=>({message:"Token Type: ->"+i.name+"<- static 'PATTERN' can only be a RegExp, a Function matching the {CustomPatternMatcherFunc} type or an Object matching the {ICustomPattern} interface.",type:Ut.INVALID_PATTERN,tokenTypes:[i]})),n=Fl(t,e);return{errors:r,valid:n}}const R8=/[^\\][$]/;function O8(t){class e extends Bd{constructor(){super(...arguments),this.found=!1}visitEndAnchor(s){this.found=!0}}const r=kn(t,i=>{const s=i.PATTERN;try{const o=Vl(s),a=new e;return a.visit(o),a.found}catch{return R8.test(s.source)}});return $e(r,i=>({message:`Unexpected RegExp Anchor Error:
	Token Type: ->`+i.name+`<- static 'PATTERN' cannot contain end of input anchor '$'
	See chevrotain.io/docs/guide/resolving_lexer_errors.html#ANCHORS	for details.`,type:Ut.EOI_ANCHOR_FOUND,tokenTypes:[i]}))}function I8(t){const e=kn(t,n=>n.PATTERN.test(""));return $e(e,n=>({message:"Token Type: ->"+n.name+"<- static 'PATTERN' must not match an empty string",type:Ut.EMPTY_MATCH_PATTERN,tokenTypes:[n]}))}const N8=/[^\\[][\^]|^\^/;function C8(t){class e extends Bd{constructor(){super(...arguments),this.found=!1}visitStartAnchor(s){this.found=!0}}const r=kn(t,i=>{const s=i.PATTERN;try{const o=Vl(s),a=new e;return a.visit(o),a.found}catch{return N8.test(s.source)}});return $e(r,i=>({message:`Unexpected RegExp Anchor Error:
	Token Type: ->`+i.name+`<- static 'PATTERN' cannot contain start of input anchor '^'
	See https://chevrotain.io/docs/guide/resolving_lexer_errors.html#ANCHORS	for details.`,type:Ut.SOI_ANCHOR_FOUND,tokenTypes:[i]}))}function L8(t){const e=kn(t,n=>{const i=n[Us];return i instanceof RegExp&&(i.multiline||i.global)});return $e(e,n=>({message:"Token Type: ->"+n.name+"<- static 'PATTERN' may NOT contain global('g') or multiline('m')",type:Ut.UNSUPPORTED_FLAGS_FOUND,tokenTypes:[n]}))}function M8(t){const e=[];let r=$e(t,s=>Gr(t,(o,a)=>(s.PATTERN.source===a.PATTERN.source&&!Or(e,a)&&a.PATTERN!==ur.NA&&(e.push(a),o.push(a)),o),[]));r=Wa(r);const n=kn(r,s=>s.length>1);return $e(n,s=>{const o=$e(s,c=>c.name);return{message:`The same RegExp pattern ->${$n(s).PATTERN}<-has been used in all of the following Token Types: ${o.join(", ")} <-`,type:Ut.DUPLICATE_PATTERNS_FOUND,tokenTypes:s}})}function U8(t){const e=kn(t,n=>{if(!Ke(n,"GROUP"))return!1;const i=n.GROUP;return i!==ur.SKIPPED&&i!==ur.NA&&!Hr(i)});return $e(e,n=>({message:"Token Type: ->"+n.name+"<- static 'GROUP' can only be Lexer.SKIPPED/Lexer.NA/A String",type:Ut.INVALID_GROUP_TYPE_FOUND,tokenTypes:[n]}))}function $8(t,e){const r=kn(t,i=>i.PUSH_MODE!==void 0&&!Or(e,i.PUSH_MODE));return $e(r,i=>({message:`Token Type: ->${i.name}<- static 'PUSH_MODE' value cannot refer to a Lexer Mode ->${i.PUSH_MODE}<-which does not exist`,type:Ut.PUSH_MODE_DOES_NOT_EXIST,tokenTypes:[i]}))}function P8(t){const e=[],r=Gr(t,(n,i,s)=>{const o=i.PATTERN;return o===ur.NA||(Hr(o)?n.push({str:o,idx:s,tokenType:i}):Si(o)&&F8(o)&&n.push({str:o.source,idx:s,tokenType:i})),n},[]);return Ye(t,(n,i)=>{Ye(r,({str:s,idx:o,tokenType:a})=>{if(i<o&&B8(s,n.PATTERN)){const c=`Token: ->${a.name}<- can never be matched.
Because it appears AFTER the Token Type ->${n.name}<-in the lexer's definition.
See https://chevrotain.io/docs/guide/resolving_lexer_errors.html#UNREACHABLE`;e.push({message:c,type:Ut.UNREACHABLE_PATTERN,tokenTypes:[n,a]})}})}),e}function B8(t,e){if(Si(e)){const r=e.exec(t);return r!==null&&r.index===0}else{if(Ei(e))return e(t,0,[],{});if(Ke(e,"exec"))return e.exec(t,0,[],{});if(typeof e=="string")return e===t;throw Error("non exhaustive match")}}function F8(t){return Mo([".","\\","[","]","|","^","$","(",")","?","*","+","{"],r=>t.source.indexOf(r)!==-1)===void 0}function S1(t){const e=t.ignoreCase?"i":"";return new RegExp(`^(?:${t.source})`,e)}function R1(t){const e=t.ignoreCase?"iy":"y";return new RegExp(`${t.source}`,e)}function D8(t,e,r){const n=[];return Ke(t,qa)||n.push({message:"A MultiMode Lexer cannot be initialized without a <"+qa+`> property in its definition
`,type:Ut.MULTI_MODE_LEXER_WITHOUT_DEFAULT_MODE}),Ke(t,Jl)||n.push({message:"A MultiMode Lexer cannot be initialized without a <"+Jl+`> property in its definition
`,type:Ut.MULTI_MODE_LEXER_WITHOUT_MODES_PROPERTY}),Ke(t,Jl)&&Ke(t,qa)&&!Ke(t.modes,t.defaultMode)&&n.push({message:`A MultiMode Lexer cannot be initialized with a ${qa}: <${t.defaultMode}>which does not exist
`,type:Ut.MULTI_MODE_LEXER_DEFAULT_MODE_VALUE_DOES_NOT_EXIST}),Ke(t,Jl)&&Ye(t.modes,(i,s)=>{Ye(i,(o,a)=>{if(Ri(o))n.push({message:`A Lexer cannot be initialized using an undefined Token Type. Mode:<${s}> at index: <${a}>
`,type:Ut.LEXER_DEFINITION_CANNOT_CONTAIN_UNDEFINED});else if(Ke(o,"LONGER_ALT")){const c=lt(o.LONGER_ALT)?o.LONGER_ALT:[o.LONGER_ALT];Ye(c,l=>{!Ri(l)&&!Or(i,l)&&n.push({message:`A MultiMode Lexer cannot be initialized with a longer_alt <${l.name}> on token <${o.name}> outside of mode <${s}>
`,type:Ut.MULTI_MODE_LEXER_LONGER_ALT_NOT_IN_CURRENT_MODE})})}})}),n}function j8(t,e,r){const n=[];let i=!1;const s=Wa(sn(Yt(t.modes))),o=Dl(s,c=>c[Us]===ur.NA),a=N1(r);return e&&Ye(o,c=>{const l=I1(c,a);if(l!==!1){const h={message:G8(c,l),type:l.issue,tokenType:c};n.push(h)}else Ke(c,"LINE_BREAKS")?c.LINE_BREAKS===!0&&(i=!0):jd(a,c.PATTERN)&&(i=!0)}),e&&!i&&n.push({message:`Warning: No LINE_BREAKS Found.
	This Lexer has been defined to track line and column information,
	But none of the Token Types can be identified as matching a line terminator.
	See https://chevrotain.io/docs/guide/resolving_lexer_errors.html#LINE_BREAKS 
	for details.`,type:Ut.NO_LINE_BREAKS_FLAGS}),n}function z8(t){const e={},r=bn(t);return Ye(r,n=>{const i=t[n];if(lt(i))e[n]=[];else throw Error("non exhaustive match")}),e}function O1(t){const e=t.PATTERN;if(Si(e))return!1;if(Ei(e))return!0;if(Ke(e,"exec"))return!0;if(Hr(e))return!1;throw Error("non exhaustive match")}function W8(t){return Hr(t)&&t.length===1?t.charCodeAt(0):!1}const H8={test:function(t){const e=t.length;for(let r=this.lastIndex;r<e;r++){const n=t.charCodeAt(r);if(n===10)return this.lastIndex=r+1,!0;if(n===13)return t.charCodeAt(r+1)===10?this.lastIndex=r+2:this.lastIndex=r+1,!0}return!1},lastIndex:0};function I1(t,e){if(Ke(t,"LINE_BREAKS"))return!1;if(Si(t.PATTERN)){try{jd(e,t.PATTERN)}catch(r){return{issue:Ut.IDENTIFY_TERMINATOR,errMsg:r.message}}return!1}else{if(Hr(t.PATTERN))return!1;if(O1(t))return{issue:Ut.CUSTOM_LINE_BREAK};throw Error("non exhaustive match")}}function G8(t,e){if(e.issue===Ut.IDENTIFY_TERMINATOR)return`Warning: unable to identify line terminator usage in pattern.
	The problem is in the <${t.name}> Token Type
	 Root cause: ${e.errMsg}.
	For details See: https://chevrotain.io/docs/guide/resolving_lexer_errors.html#IDENTIFY_TERMINATOR`;if(e.issue===Ut.CUSTOM_LINE_BREAK)return`Warning: A Custom Token Pattern should specify the <line_breaks> option.
	The problem is in the <${t.name}> Token Type
	For details See: https://chevrotain.io/docs/guide/resolving_lexer_errors.html#CUSTOM_LINE_BREAK`;throw Error("non exhaustive match")}function N1(t){return $e(t,r=>Hr(r)?r.charCodeAt(0):r)}function zd(t,e,r){t[e]===void 0?t[e]=[r]:t[e].push(r)}const Ya=256;let Ql=[];function es(t){return t<Ya?t:Ql[t]}function K8(){if(Et(Ql)){Ql=new Array(65536);for(let t=0;t<65536;t++)Ql[t]=t>255?255+~~(t/255):t}}function Va(t,e){const r=t.tokenTypeIdx;return r===e.tokenTypeIdx?!0:e.isParent===!0&&e.categoryMatchesMap[r]===!0}function eu(t,e){return t.tokenTypeIdx===e.tokenTypeIdx}let C1=1;const L1={};function Xa(t){const e=q8(t);Y8(e),X8(e),V8(e),Ye(e,r=>{r.isParent=r.categoryMatches.length>0})}function q8(t){let e=wr(t),r=t,n=!0;for(;n;){r=Wa(sn($e(r,s=>s.CATEGORIES)));const i=Fl(r,e);e=e.concat(i),Et(i)?n=!1:r=i}return e}function Y8(t){Ye(t,e=>{U1(e)||(L1[C1]=e,e.tokenTypeIdx=C1++),$1(e)&&!lt(e.CATEGORIES)&&(e.CATEGORIES=[e.CATEGORIES]),$1(e)||(e.CATEGORIES=[]),Z8(e)||(e.categoryMatches=[]),J8(e)||(e.categoryMatchesMap={})})}function V8(t){Ye(t,e=>{e.categoryMatches=[],Ye(e.categoryMatchesMap,(r,n)=>{e.categoryMatches.push(L1[n].tokenTypeIdx)})})}function X8(t){Ye(t,e=>{M1([],e)})}function M1(t,e){Ye(t,r=>{e.categoryMatchesMap[r.tokenTypeIdx]=!0}),Ye(e.CATEGORIES,r=>{const n=t.concat(e);Or(n,r)||M1(n,r)})}function U1(t){return Ke(t,"tokenTypeIdx")}function $1(t){return Ke(t,"CATEGORIES")}function Z8(t){return Ke(t,"categoryMatches")}function J8(t){return Ke(t,"categoryMatchesMap")}function Q8(t){return Ke(t,"tokenTypeIdx")}const e$={buildUnableToPopLexerModeMessage(t){return`Unable to pop Lexer Mode after encountering Token ->${t.image}<- The Mode Stack is empty`},buildUnexpectedCharactersMessage(t,e,r,n,i){return`unexpected character: ->${t.charAt(e)}<- at offset: ${e}, skipped ${r} characters.`}};var Ut;(function(t){t[t.MISSING_PATTERN=0]="MISSING_PATTERN",t[t.INVALID_PATTERN=1]="INVALID_PATTERN",t[t.EOI_ANCHOR_FOUND=2]="EOI_ANCHOR_FOUND",t[t.UNSUPPORTED_FLAGS_FOUND=3]="UNSUPPORTED_FLAGS_FOUND",t[t.DUPLICATE_PATTERNS_FOUND=4]="DUPLICATE_PATTERNS_FOUND",t[t.INVALID_GROUP_TYPE_FOUND=5]="INVALID_GROUP_TYPE_FOUND",t[t.PUSH_MODE_DOES_NOT_EXIST=6]="PUSH_MODE_DOES_NOT_EXIST",t[t.MULTI_MODE_LEXER_WITHOUT_DEFAULT_MODE=7]="MULTI_MODE_LEXER_WITHOUT_DEFAULT_MODE",t[t.MULTI_MODE_LEXER_WITHOUT_MODES_PROPERTY=8]="MULTI_MODE_LEXER_WITHOUT_MODES_PROPERTY",t[t.MULTI_MODE_LEXER_DEFAULT_MODE_VALUE_DOES_NOT_EXIST=9]="MULTI_MODE_LEXER_DEFAULT_MODE_VALUE_DOES_NOT_EXIST",t[t.LEXER_DEFINITION_CANNOT_CONTAIN_UNDEFINED=10]="LEXER_DEFINITION_CANNOT_CONTAIN_UNDEFINED",t[t.SOI_ANCHOR_FOUND=11]="SOI_ANCHOR_FOUND",t[t.EMPTY_MATCH_PATTERN=12]="EMPTY_MATCH_PATTERN",t[t.NO_LINE_BREAKS_FLAGS=13]="NO_LINE_BREAKS_FLAGS",t[t.UNREACHABLE_PATTERN=14]="UNREACHABLE_PATTERN",t[t.IDENTIFY_TERMINATOR=15]="IDENTIFY_TERMINATOR",t[t.CUSTOM_LINE_BREAK=16]="CUSTOM_LINE_BREAK",t[t.MULTI_MODE_LEXER_LONGER_ALT_NOT_IN_CURRENT_MODE=17]="MULTI_MODE_LEXER_LONGER_ALT_NOT_IN_CURRENT_MODE"})(Ut||(Ut={}));const Za={deferDefinitionErrorsHandling:!1,positionTracking:"full",lineTerminatorsPattern:/\n|\r\n?/g,lineTerminatorCharacters:[`
`,"\r"],ensureOptimizations:!1,safeMode:!1,errorMessageProvider:e$,traceInitPerf:!1,skipValidations:!1,recoveryEnabled:!0};Object.freeze(Za);let ur=class{constructor(e,r=Za){if(this.lexerDefinition=e,this.lexerDefinitionErrors=[],this.lexerDefinitionWarning=[],this.patternIdxToConfig={},this.charCodeToPatternIdxToConfig={},this.modes=[],this.emptyGroups={},this.trackStartLines=!0,this.trackEndLines=!0,this.hasCustom=!1,this.canModeBeOptimized={},this.TRACE_INIT=(i,s)=>{if(this.traceInitPerf===!0){this.traceInitIndent++;const o=new Array(this.traceInitIndent+1).join("	");this.traceInitIndent<this.traceInitMaxIdent&&console.log(`${o}--> <${i}>`);const{time:a,value:c}=_1(s),l=a>10?console.warn:console.log;return this.traceInitIndent<this.traceInitMaxIdent&&l(`${o}<-- <${i}> time: ${a}ms`),this.traceInitIndent--,c}else return s()},typeof r=="boolean")throw Error(`The second argument to the Lexer constructor is now an ILexerConfig Object.
a boolean 2nd argument is no longer supported`);this.config=Wr({},Za,r);const n=this.config.traceInitPerf;n===!0?(this.traceInitMaxIdent=1/0,this.traceInitPerf=!0):typeof n=="number"&&(this.traceInitMaxIdent=n,this.traceInitPerf=!0),this.traceInitIndent=-1,this.TRACE_INIT("Lexer Constructor",()=>{let i,s=!0;this.TRACE_INIT("Lexer Config handling",()=>{if(this.config.lineTerminatorsPattern===Za.lineTerminatorsPattern)this.config.lineTerminatorsPattern=H8;else if(this.config.lineTerminatorCharacters===Za.lineTerminatorCharacters)throw Error(`Error: Missing <lineTerminatorCharacters> property on the Lexer config.
	For details See: https://chevrotain.io/docs/guide/resolving_lexer_errors.html#MISSING_LINE_TERM_CHARS`);if(r.safeMode&&r.ensureOptimizations)throw Error('"safeMode" and "ensureOptimizations" flags are mutually exclusive.');this.trackStartLines=/full|onlyStart/i.test(this.config.positionTracking),this.trackEndLines=/full/i.test(this.config.positionTracking),lt(e)?i={modes:{defaultMode:wr(e)},defaultMode:qa}:(s=!1,i=wr(e))}),this.config.skipValidations===!1&&(this.TRACE_INIT("performRuntimeChecks",()=>{this.lexerDefinitionErrors=this.lexerDefinitionErrors.concat(D8(i,this.trackStartLines,this.config.lineTerminatorCharacters))}),this.TRACE_INIT("performWarningRuntimeChecks",()=>{this.lexerDefinitionWarning=this.lexerDefinitionWarning.concat(j8(i,this.trackStartLines,this.config.lineTerminatorCharacters))})),i.modes=i.modes?i.modes:{},Ye(i.modes,(a,c)=>{i.modes[c]=Dl(a,l=>Ri(l))});const o=bn(i.modes);if(Ye(i.modes,(a,c)=>{this.TRACE_INIT(`Mode: <${c}> processing`,()=>{if(this.modes.push(c),this.config.skipValidations===!1&&this.TRACE_INIT("validatePatterns",()=>{this.lexerDefinitionErrors=this.lexerDefinitionErrors.concat(E8(a,o))}),Et(this.lexerDefinitionErrors)){Xa(a);let l;this.TRACE_INIT("analyzeTokenTypes",()=>{l=x8(a,{lineTerminatorCharacters:this.config.lineTerminatorCharacters,positionTracking:r.positionTracking,ensureOptimizations:r.ensureOptimizations,safeMode:r.safeMode,tracer:this.TRACE_INIT})}),this.patternIdxToConfig[c]=l.patternIdxToConfig,this.charCodeToPatternIdxToConfig[c]=l.charCodeToPatternIdxToConfig,this.emptyGroups=Wr({},this.emptyGroups,l.emptyGroups),this.hasCustom=l.hasCustom||this.hasCustom,this.canModeBeOptimized[c]=l.canBeOptimized}})}),this.defaultMode=i.defaultMode,!Et(this.lexerDefinitionErrors)&&!this.config.deferDefinitionErrorsHandling){const c=$e(this.lexerDefinitionErrors,l=>l.message).join(`-----------------------
`);throw new Error(`Errors detected in definition of Lexer:
`+c)}Ye(this.lexerDefinitionWarning,a=>{y1(a.message)}),this.TRACE_INIT("Choosing sub-methods implementations",()=>{if(T1?(this.chopInput=Io,this.match=this.matchWithTest):(this.updateLastIndex=rr,this.match=this.matchWithExec),s&&(this.handleModes=rr),this.trackStartLines===!1&&(this.computeNewColumn=Io),this.trackEndLines===!1&&(this.updateTokenEndLineColumnLocation=rr),/full/i.test(this.config.positionTracking))this.createTokenInstance=this.createFullToken;else if(/onlyStart/i.test(this.config.positionTracking))this.createTokenInstance=this.createStartOnlyToken;else if(/onlyOffset/i.test(this.config.positionTracking))this.createTokenInstance=this.createOffsetOnlyToken;else throw Error(`Invalid <positionTracking> config option: "${this.config.positionTracking}"`);this.hasCustom?(this.addToken=this.addTokenUsingPush,this.handlePayload=this.handlePayloadWithCustom):(this.addToken=this.addTokenUsingMemberAccess,this.handlePayload=this.handlePayloadNoCustom)}),this.TRACE_INIT("Failed Optimization Warnings",()=>{const a=Gr(this.canModeBeOptimized,(c,l,u)=>(l===!1&&c.push(u),c),[]);if(r.ensureOptimizations&&!Et(a))throw Error(`Lexer Modes: < ${a.join(", ")} > cannot be optimized.
	 Disable the "ensureOptimizations" lexer config flag to silently ignore this and run the lexer in an un-optimized mode.
	 Or inspect the console log for details on how to resolve these issues.`)}),this.TRACE_INIT("clearRegExpParserCache",()=>{b8()}),this.TRACE_INIT("toFastProperties",()=>{b1(this)})})}tokenize(e,r=this.defaultMode){if(!Et(this.lexerDefinitionErrors)){const i=$e(this.lexerDefinitionErrors,s=>s.message).join(`-----------------------
`);throw new Error(`Unable to Tokenize because Errors detected in definition of Lexer:
`+i)}return this.tokenizeInternal(e,r)}tokenizeInternal(e,r){let n,i,s,o,a,c,l,u,h,f,d,m,p,g,y;const _=e,A=_.length;let T=0,x=0;const M=this.hasCustom?0:Math.floor(e.length/10),R=new Array(M),P=[];let W=this.trackStartLines?1:void 0,F=this.trackStartLines?1:void 0;const G=z8(this.emptyGroups),O=this.trackStartLines,I=this.config.lineTerminatorsPattern;let k=0,C=[],z=[];const B=[],Q=[];Object.freeze(Q);let Y;function N(){return C}function U(de){const Ee=es(de),ke=z[Ee];return ke===void 0?Q:ke}const $=de=>{if(B.length===1&&de.tokenType.PUSH_MODE===void 0){const Ee=this.config.errorMessageProvider.buildUnableToPopLexerModeMessage(de);P.push({offset:de.startOffset,line:de.startLine,column:de.startColumn,length:de.image.length,message:Ee})}else{B.pop();const Ee=Lo(B);C=this.patternIdxToConfig[Ee],z=this.charCodeToPatternIdxToConfig[Ee],k=C.length;const ke=this.canModeBeOptimized[Ee]&&this.config.safeMode===!1;z&&ke?Y=U:Y=N}};function X(de){B.push(de),z=this.charCodeToPatternIdxToConfig[de],C=this.patternIdxToConfig[de],k=C.length,k=C.length;const Ee=this.canModeBeOptimized[de]&&this.config.safeMode===!1;z&&Ee?Y=U:Y=N}X.call(this,r);let q;const J=this.config.recoveryEnabled;for(;T<A;){c=null;const de=_.charCodeAt(T),Ee=Y(de),ke=Ee.length;for(n=0;n<ke;n++){q=Ee[n];const xe=q.pattern;l=null;const Te=q.short;if(Te!==!1?de===Te&&(c=xe):q.isCustom===!0?(y=xe.exec(_,T,R,G),y!==null?(c=y[0],y.payload!==void 0&&(l=y.payload)):c=null):(this.updateLastIndex(xe,T),c=this.match(xe,e,T)),c!==null){if(a=q.longerAlt,a!==void 0){const Se=a.length;for(s=0;s<Se;s++){const Me=C[a[s]],je=Me.pattern;if(u=null,Me.isCustom===!0?(y=je.exec(_,T,R,G),y!==null?(o=y[0],y.payload!==void 0&&(u=y.payload)):o=null):(this.updateLastIndex(je,T),o=this.match(je,e,T)),o&&o.length>c.length){c=o,l=u,q=Me;break}}}break}}if(c!==null){if(h=c.length,f=q.group,f!==void 0&&(d=q.tokenTypeIdx,m=this.createTokenInstance(c,T,d,q.tokenType,W,F,h),this.handlePayload(m,l),f===!1?x=this.addToken(R,x,m):G[f].push(m)),e=this.chopInput(e,h),T=T+h,F=this.computeNewColumn(F,h),O===!0&&q.canLineTerminator===!0){let xe=0,Te,Se;I.lastIndex=0;do Te=I.test(c),Te===!0&&(Se=I.lastIndex-1,xe++);while(Te===!0);xe!==0&&(W=W+xe,F=h-Se,this.updateTokenEndLineColumnLocation(m,f,Se,xe,W,F,h))}this.handleModes(q,$,X,m)}else{const xe=T,Te=W,Se=F;let Me=J===!1;for(;Me===!1&&T<A;)for(e=this.chopInput(e,1),T++,i=0;i<k;i++){const je=C[i],S=je.pattern,he=je.short;if(he!==!1?_.charCodeAt(T)===he&&(Me=!0):je.isCustom===!0?Me=S.exec(_,T,R,G)!==null:(this.updateLastIndex(S,T),Me=S.exec(e)!==null),Me===!0)break}if(p=T-xe,F=this.computeNewColumn(F,p),g=this.config.errorMessageProvider.buildUnexpectedCharactersMessage(_,xe,p,Te,Se),P.push({offset:xe,line:Te,column:Se,length:p,message:g}),J===!1)break}}return this.hasCustom||(R.length=x),{tokens:R,groups:G,errors:P}}handleModes(e,r,n,i){if(e.pop===!0){const s=e.push;r(i),s!==void 0&&n.call(this,s)}else e.push!==void 0&&n.call(this,e.push)}chopInput(e,r){return e.substring(r)}updateLastIndex(e,r){e.lastIndex=r}updateTokenEndLineColumnLocation(e,r,n,i,s,o,a){let c,l;r!==void 0&&(c=n===a-1,l=c?-1:0,i===1&&c===!0||(e.endLine=s+l,e.endColumn=o-1+-l))}computeNewColumn(e,r){return e+r}createOffsetOnlyToken(e,r,n,i){return{image:e,startOffset:r,tokenTypeIdx:n,tokenType:i}}createStartOnlyToken(e,r,n,i,s,o){return{image:e,startOffset:r,startLine:s,startColumn:o,tokenTypeIdx:n,tokenType:i}}createFullToken(e,r,n,i,s,o,a){return{image:e,startOffset:r,endOffset:r+a-1,startLine:s,endLine:s,startColumn:o,endColumn:o+a-1,tokenTypeIdx:n,tokenType:i}}addTokenUsingPush(e,r,n){return e.push(n),r}addTokenUsingMemberAccess(e,r,n){return e[r]=n,r++,r}handlePayloadNoCustom(e,r){}handlePayloadWithCustom(e,r){r!==null&&(e.payload=r)}matchWithTest(e,r,n){return e.test(r)===!0?r.substring(n,e.lastIndex):null}matchWithExec(e,r){const n=e.exec(r);return n!==null?n[0]:null}};ur.SKIPPED="This marks a skipped Token pattern, this means each token identified by it willbe consumed and then thrown into oblivion, this can be used to for example to completely ignore whitespace.",ur.NA=/NOT_APPLICABLE/;function Ja(t){return P1(t)?t.LABEL:t.name}function P1(t){return Hr(t.LABEL)&&t.LABEL!==""}const t$="parent",B1="categories",F1="label",D1="group",j1="push_mode",z1="pop_mode",W1="longer_alt",H1="line_breaks",G1="start_chars_hint";function on(t){return r$(t)}function r$(t){const e=t.pattern,r={};if(r.name=t.name,Ri(e)||(r.PATTERN=e),Ke(t,t$))throw`The parent property is no longer supported.
See: https://github.com/chevrotain/chevrotain/issues/564#issuecomment-349062346 for details.`;return Ke(t,B1)&&(r.CATEGORIES=t[B1]),Xa([r]),Ke(t,F1)&&(r.LABEL=t[F1]),Ke(t,D1)&&(r.GROUP=t[D1]),Ke(t,z1)&&(r.POP_MODE=t[z1]),Ke(t,j1)&&(r.PUSH_MODE=t[j1]),Ke(t,W1)&&(r.LONGER_ALT=t[W1]),Ke(t,H1)&&(r.LINE_BREAKS=t[H1]),Ke(t,G1)&&(r.START_CHARS_HINT=t[G1]),r}const $s=on({name:"EOF",pattern:ur.NA});Xa([$s]);function tu(t,e,r,n,i,s,o,a){return{image:e,startOffset:r,endOffset:n,startLine:i,endLine:s,startColumn:o,endColumn:a,tokenTypeIdx:t.tokenTypeIdx,tokenType:t}}function n$(t,e){return Va(t,e)}const K1={buildMismatchTokenMessage({expected:t,actual:e,previous:r,ruleName:n}){return`Expecting ${P1(t)?`--> ${Ja(t)} <--`:`token of type --> ${t.name} <--`} but found --> '${e.image}' <--`},buildNotAllInputParsedMessage({firstRedundant:t,ruleName:e}){return"Redundant input, expecting EOF but found: "+t.image},buildNoViableAltMessage({expectedPathsPerAlt:t,actual:e,previous:r,customUserDescription:n,ruleName:i}){const s="Expecting: ",a=`
but found: '`+$n(e).image+"'";if(n)return s+n+a;{const c=Gr(t,(f,d)=>f.concat(d),[]),l=$e(c,f=>`[${$e(f,d=>Ja(d)).join(", ")}]`),h=`one of these possible Token sequences:
${$e(l,(f,d)=>`  ${d+1}. ${f}`).join(`
`)}`;return s+h+a}},buildEarlyExitMessage({expectedIterationPaths:t,actual:e,customUserDescription:r,ruleName:n}){const i="Expecting: ",o=`
but found: '`+$n(e).image+"'";if(r)return i+r+o;{const c=`expecting at least one iteration which starts with one of these possible Token sequences::
  <${$e(t,l=>`[${$e(l,u=>Ja(u)).join(",")}]`).join(" ,")}>`;return i+c+o}}};Object.freeze(K1);const i$={buildRuleNotFoundError(t,e){return"Invalid grammar, reference to a rule which is not defined: ->"+e.nonTerminalName+`<-
inside top level rule: ->`+t.name+"<-"}},Ps={buildDuplicateFoundError(t,e){function r(u){return u instanceof Ct?u.terminalType.name:u instanceof Kr?u.nonTerminalName:""}const n=t.name,i=$n(e),s=i.idx,o=ui(i),a=r(i),c=s>0;let l=`->${o}${c?s:""}<- ${a?`with argument: ->${a}<-`:""}
                  appears more than once (${e.length} times) in the top level rule: ->${n}<-.                  
                  For further details see: https://chevrotain.io/docs/FAQ.html#NUMERICAL_SUFFIXES 
                  `;return l=l.replace(/[ \t]+/g," "),l=l.replace(/\s\s+/g,`
`),l},buildNamespaceConflictError(t){return`Namespace conflict found in grammar.
The grammar has both a Terminal(Token) and a Non-Terminal(Rule) named: <${t.name}>.
To resolve this make sure each Terminal and Non-Terminal names are unique
This is easy to accomplish by using the convention that Terminal names start with an uppercase letter
and Non-Terminal names start with a lower case letter.`},buildAlternationPrefixAmbiguityError(t){const e=$e(t.prefixPath,i=>Ja(i)).join(", "),r=t.alternation.idx===0?"":t.alternation.idx;return`Ambiguous alternatives: <${t.ambiguityIndices.join(" ,")}> due to common lookahead prefix
in <OR${r}> inside <${t.topLevelRule.name}> Rule,
<${e}> may appears as a prefix path in all these alternatives.
See: https://chevrotain.io/docs/guide/resolving_grammar_errors.html#COMMON_PREFIX
For Further details.`},buildAlternationAmbiguityError(t){const e=$e(t.prefixPath,i=>Ja(i)).join(", "),r=t.alternation.idx===0?"":t.alternation.idx;let n=`Ambiguous Alternatives Detected: <${t.ambiguityIndices.join(" ,")}> in <OR${r}> inside <${t.topLevelRule.name}> Rule,
<${e}> may appears as a prefix path in all these alternatives.
`;return n=n+`See: https://chevrotain.io/docs/guide/resolving_grammar_errors.html#AMBIGUOUS_ALTERNATIVES
For Further details.`,n},buildEmptyRepetitionError(t){let e=ui(t.repetition);return t.repetition.idx!==0&&(e+=t.repetition.idx),`The repetition <${e}> within Rule <${t.topLevelRule.name}> can never consume any tokens.
This could lead to an infinite loop.`},buildTokenNameError(t){return"deprecated"},buildEmptyAlternationError(t){return`Ambiguous empty alternative: <${t.emptyChoiceIdx+1}> in <OR${t.alternation.idx}> inside <${t.topLevelRule.name}> Rule.
Only the last alternative may be an empty alternative.`},buildTooManyAlternativesError(t){return`An Alternation cannot have more than 256 alternatives:
<OR${t.alternation.idx}> inside <${t.topLevelRule.name}> Rule.
 has ${t.alternation.definition.length+1} alternatives.`},buildLeftRecursionError(t){const e=t.topLevelRule.name,r=$e(t.leftRecursionPath,s=>s.name),n=`${e} --> ${r.concat([e]).join(" --> ")}`;return`Left Recursion found in grammar.
rule: <${e}> can be invoked from itself (directly or indirectly)
without consuming any Tokens. The grammar path that causes this is: 
 ${n}
 To fix this refactor your grammar to remove the left recursion.
see: https://en.wikipedia.org/wiki/LL_parser#Left_factoring.`},buildInvalidRuleNameError(t){return"deprecated"},buildDuplicateRuleNameError(t){let e;return t.topLevelRule instanceof Uo?e=t.topLevelRule.name:e=t.topLevelRule,`Duplicate definition, rule: ->${e}<- is already defined in the grammar: ->${t.grammarName}<-`}};function s$(t,e){const r=new o$(t,e);return r.resolveRefs(),r.errors}class o$ extends Ms{constructor(e,r){super(),this.nameToTopRule=e,this.errMsgProvider=r,this.errors=[]}resolveRefs(){Ye(Yt(this.nameToTopRule),e=>{this.currTopLevel=e,e.accept(this)})}visitNonTerminal(e){const r=this.nameToTopRule[e.nonTerminalName];if(r)e.referencedRule=r;else{const n=this.errMsgProvider.buildRuleNotFoundError(this.currTopLevel,e);this.errors.push({message:n,type:Ir.UNRESOLVED_SUBRULE_REF,ruleName:this.currTopLevel.name,unresolvedRefName:e.nonTerminalName})}}}class a$ extends Hl{constructor(e,r){super(),this.topProd=e,this.path=r,this.possibleTokTypes=[],this.nextProductionName="",this.nextProductionOccurrence=0,this.found=!1,this.isAtEndOfPath=!1}startWalking(){if(this.found=!1,this.path.ruleStack[0]!==this.topProd.name)throw Error("The path does not start with the walker's top Rule!");return this.ruleStack=wr(this.path.ruleStack).reverse(),this.occurrenceStack=wr(this.path.occurrenceStack).reverse(),this.ruleStack.pop(),this.occurrenceStack.pop(),this.updateExpectedNext(),this.walk(this.topProd),this.possibleTokTypes}walk(e,r=[]){this.found||super.walk(e,r)}walkProdRef(e,r,n){if(e.referencedRule.name===this.nextProductionName&&e.idx===this.nextProductionOccurrence){const i=r.concat(n);this.updateExpectedNext(),this.walk(e.referencedRule,i)}}updateExpectedNext(){Et(this.ruleStack)?(this.nextProductionName="",this.nextProductionOccurrence=0,this.isAtEndOfPath=!0):(this.nextProductionName=this.ruleStack.pop(),this.nextProductionOccurrence=this.occurrenceStack.pop())}}class c$ extends a${constructor(e,r){super(e,r),this.path=r,this.nextTerminalName="",this.nextTerminalOccurrence=0,this.nextTerminalName=this.path.lastTok.name,this.nextTerminalOccurrence=this.path.lastTokOccurrence}walkTerminal(e,r,n){if(this.isAtEndOfPath&&e.terminalType.name===this.nextTerminalName&&e.idx===this.nextTerminalOccurrence&&!this.found){const i=r.concat(n),s=new qr({definition:i});this.possibleTokTypes=Ga(s),this.found=!0}}}class ru extends Hl{constructor(e,r){super(),this.topRule=e,this.occurrence=r,this.result={token:void 0,occurrence:void 0,isEndOfRule:void 0}}startWalking(){return this.walk(this.topRule),this.result}}class l$ extends ru{walkMany(e,r,n){if(e.idx===this.occurrence){const i=$n(r.concat(n));this.result.isEndOfRule=i===void 0,i instanceof Ct&&(this.result.token=i.terminalType,this.result.occurrence=i.idx)}else super.walkMany(e,r,n)}}class q1 extends ru{walkManySep(e,r,n){if(e.idx===this.occurrence){const i=$n(r.concat(n));this.result.isEndOfRule=i===void 0,i instanceof Ct&&(this.result.token=i.terminalType,this.result.occurrence=i.idx)}else super.walkManySep(e,r,n)}}class u$ extends ru{walkAtLeastOne(e,r,n){if(e.idx===this.occurrence){const i=$n(r.concat(n));this.result.isEndOfRule=i===void 0,i instanceof Ct&&(this.result.token=i.terminalType,this.result.occurrence=i.idx)}else super.walkAtLeastOne(e,r,n)}}class Y1 extends ru{walkAtLeastOneSep(e,r,n){if(e.idx===this.occurrence){const i=$n(r.concat(n));this.result.isEndOfRule=i===void 0,i instanceof Ct&&(this.result.token=i.terminalType,this.result.occurrence=i.idx)}else super.walkAtLeastOneSep(e,r,n)}}function Wd(t,e,r=[]){r=wr(r);let n=[],i=0;function s(a){return a.concat(kr(t,i+1))}function o(a){const c=Wd(s(a),e,r);return n.concat(c)}for(;r.length<e&&i<t.length;){const a=t[i];if(a instanceof qr)return o(a.definition);if(a instanceof Kr)return o(a.definition);if(a instanceof Yr)n=o(a.definition);else if(a instanceof ci){const c=a.definition.concat([new nr({definition:a.definition})]);return o(c)}else if(a instanceof li){const c=[new qr({definition:a.definition}),new nr({definition:[new Ct({terminalType:a.separator})].concat(a.definition)})];return o(c)}else if(a instanceof Bn){const c=a.definition.concat([new nr({definition:[new Ct({terminalType:a.separator})].concat(a.definition)})]);n=o(c)}else if(a instanceof nr){const c=a.definition.concat([new nr({definition:a.definition})]);n=o(c)}else{if(a instanceof Fn)return Ye(a.definition,c=>{Et(c.definition)===!1&&(n=o(c.definition))}),n;if(a instanceof Ct)r.push(a.terminalType);else throw Error("non exhaustive match")}i++}return n.push({partialPath:r,suffixDef:kr(t,i)}),n}function V1(t,e,r,n){const i="EXIT_NONE_TERMINAL",s=[i],o="EXIT_ALTERNATIVE";let a=!1;const c=e.length,l=c-n-1,u=[],h=[];for(h.push({idx:-1,def:t,ruleStack:[],occurrenceStack:[]});!Et(h);){const f=h.pop();if(f===o){a&&Lo(h).idx<=l&&h.pop();continue}const d=f.def,m=f.idx,p=f.ruleStack,g=f.occurrenceStack;if(Et(d))continue;const y=d[0];if(y===i){const _={idx:m,def:kr(d),ruleStack:Ha(p),occurrenceStack:Ha(g)};h.push(_)}else if(y instanceof Ct)if(m<c-1){const _=m+1,A=e[_];if(r(A,y.terminalType)){const T={idx:_,def:kr(d),ruleStack:p,occurrenceStack:g};h.push(T)}}else if(m===c-1)u.push({nextTokenType:y.terminalType,nextTokenOccurrence:y.idx,ruleStack:p,occurrenceStack:g}),a=!0;else throw Error("non exhaustive match");else if(y instanceof Kr){const _=wr(p);_.push(y.nonTerminalName);const A=wr(g);A.push(y.idx);const T={idx:m,def:y.definition.concat(s,kr(d)),ruleStack:_,occurrenceStack:A};h.push(T)}else if(y instanceof Yr){const _={idx:m,def:kr(d),ruleStack:p,occurrenceStack:g};h.push(_),h.push(o);const A={idx:m,def:y.definition.concat(kr(d)),ruleStack:p,occurrenceStack:g};h.push(A)}else if(y instanceof ci){const _=new nr({definition:y.definition,idx:y.idx}),A=y.definition.concat([_],kr(d)),T={idx:m,def:A,ruleStack:p,occurrenceStack:g};h.push(T)}else if(y instanceof li){const _=new Ct({terminalType:y.separator}),A=new nr({definition:[_].concat(y.definition),idx:y.idx}),T=y.definition.concat([A],kr(d)),x={idx:m,def:T,ruleStack:p,occurrenceStack:g};h.push(x)}else if(y instanceof Bn){const _={idx:m,def:kr(d),ruleStack:p,occurrenceStack:g};h.push(_),h.push(o);const A=new Ct({terminalType:y.separator}),T=new nr({definition:[A].concat(y.definition),idx:y.idx}),x=y.definition.concat([T],kr(d)),M={idx:m,def:x,ruleStack:p,occurrenceStack:g};h.push(M)}else if(y instanceof nr){const _={idx:m,def:kr(d),ruleStack:p,occurrenceStack:g};h.push(_),h.push(o);const A=new nr({definition:y.definition,idx:y.idx}),T=y.definition.concat([A],kr(d)),x={idx:m,def:T,ruleStack:p,occurrenceStack:g};h.push(x)}else if(y instanceof Fn)for(let _=y.definition.length-1;_>=0;_--){const A=y.definition[_],T={idx:m,def:A.definition.concat(kr(d)),ruleStack:p,occurrenceStack:g};h.push(T),h.push(o)}else if(y instanceof qr)h.push({idx:m,def:y.definition.concat(kr(d)),ruleStack:p,occurrenceStack:g});else if(y instanceof Uo)h.push(h$(y,m,p,g));else throw Error("non exhaustive match")}return u}function h$(t,e,r,n){const i=wr(r);i.push(t.name);const s=wr(n);return s.push(1),{idx:e,def:t.definition,ruleStack:i,occurrenceStack:s}}var $t;(function(t){t[t.OPTION=0]="OPTION",t[t.REPETITION=1]="REPETITION",t[t.REPETITION_MANDATORY=2]="REPETITION_MANDATORY",t[t.REPETITION_MANDATORY_WITH_SEPARATOR=3]="REPETITION_MANDATORY_WITH_SEPARATOR",t[t.REPETITION_WITH_SEPARATOR=4]="REPETITION_WITH_SEPARATOR",t[t.ALTERNATION=5]="ALTERNATION"})($t||($t={}));function X1(t){if(t instanceof Yr||t==="Option")return $t.OPTION;if(t instanceof nr||t==="Repetition")return $t.REPETITION;if(t instanceof ci||t==="RepetitionMandatory")return $t.REPETITION_MANDATORY;if(t instanceof li||t==="RepetitionMandatoryWithSeparator")return $t.REPETITION_MANDATORY_WITH_SEPARATOR;if(t instanceof Bn||t==="RepetitionWithSeparator")return $t.REPETITION_WITH_SEPARATOR;if(t instanceof Fn||t==="Alternation")return $t.ALTERNATION;throw Error("non exhaustive match")}function f$(t,e,r,n,i,s){const o=Gd(t,e,r),a=ew(o)?eu:Va;return s(o,n,a,i)}function d$(t,e,r,n,i,s){const o=Kd(t,e,i,r),a=ew(o)?eu:Va;return s(o[0],a,n)}function p$(t,e,r,n){const i=t.length,s=Un(t,o=>Un(o,a=>a.length===1));if(e)return function(o){const a=$e(o,c=>c.GATE);for(let c=0;c<i;c++){const l=t[c],u=l.length,h=a[c];if(!(h!==void 0&&h.call(this)===!1))e:for(let f=0;f<u;f++){const d=l[f],m=d.length;for(let p=0;p<m;p++){const g=this.LA(p+1);if(r(g,d[p])===!1)continue e}return c}}};if(s&&!n){const o=$e(t,c=>sn(c)),a=Gr(o,(c,l,u)=>(Ye(l,h=>{Ke(c,h.tokenTypeIdx)||(c[h.tokenTypeIdx]=u),Ye(h.categoryMatches,f=>{Ke(c,f)||(c[f]=u)})}),c),{});return function(){const c=this.LA(1);return a[c.tokenTypeIdx]}}else return function(){for(let o=0;o<i;o++){const a=t[o],c=a.length;e:for(let l=0;l<c;l++){const u=a[l],h=u.length;for(let f=0;f<h;f++){const d=this.LA(f+1);if(r(d,u[f])===!1)continue e}return o}}}}function m$(t,e,r){const n=Un(t,s=>s.length===1),i=t.length;if(n&&!r){const s=sn(t);if(s.length===1&&Et(s[0].categoryMatches)){const a=s[0].tokenTypeIdx;return function(){return this.LA(1).tokenTypeIdx===a}}else{const o=Gr(s,(a,c,l)=>(a[c.tokenTypeIdx]=!0,Ye(c.categoryMatches,u=>{a[u]=!0}),a),[]);return function(){const a=this.LA(1);return o[a.tokenTypeIdx]===!0}}}else return function(){e:for(let s=0;s<i;s++){const o=t[s],a=o.length;for(let c=0;c<a;c++){const l=this.LA(c+1);if(e(l,o[c])===!1)continue e}return!0}return!1}}class g$ extends Hl{constructor(e,r,n){super(),this.topProd=e,this.targetOccurrence=r,this.targetProdType=n}startWalking(){return this.walk(this.topProd),this.restDef}checkIsTarget(e,r,n,i){return e.idx===this.targetOccurrence&&this.targetProdType===r?(this.restDef=n.concat(i),!0):!1}walkOption(e,r,n){this.checkIsTarget(e,$t.OPTION,r,n)||super.walkOption(e,r,n)}walkAtLeastOne(e,r,n){this.checkIsTarget(e,$t.REPETITION_MANDATORY,r,n)||super.walkOption(e,r,n)}walkAtLeastOneSep(e,r,n){this.checkIsTarget(e,$t.REPETITION_MANDATORY_WITH_SEPARATOR,r,n)||super.walkOption(e,r,n)}walkMany(e,r,n){this.checkIsTarget(e,$t.REPETITION,r,n)||super.walkOption(e,r,n)}walkManySep(e,r,n){this.checkIsTarget(e,$t.REPETITION_WITH_SEPARATOR,r,n)||super.walkOption(e,r,n)}}class Z1 extends Ms{constructor(e,r,n){super(),this.targetOccurrence=e,this.targetProdType=r,this.targetRef=n,this.result=[]}checkIsTarget(e,r){e.idx===this.targetOccurrence&&this.targetProdType===r&&(this.targetRef===void 0||e===this.targetRef)&&(this.result=e.definition)}visitOption(e){this.checkIsTarget(e,$t.OPTION)}visitRepetition(e){this.checkIsTarget(e,$t.REPETITION)}visitRepetitionMandatory(e){this.checkIsTarget(e,$t.REPETITION_MANDATORY)}visitRepetitionMandatoryWithSeparator(e){this.checkIsTarget(e,$t.REPETITION_MANDATORY_WITH_SEPARATOR)}visitRepetitionWithSeparator(e){this.checkIsTarget(e,$t.REPETITION_WITH_SEPARATOR)}visitAlternation(e){this.checkIsTarget(e,$t.ALTERNATION)}}function J1(t){const e=new Array(t);for(let r=0;r<t;r++)e[r]=[];return e}function Hd(t){let e=[""];for(let r=0;r<t.length;r++){const n=t[r],i=[];for(let s=0;s<e.length;s++){const o=e[s];i.push(o+"_"+n.tokenTypeIdx);for(let a=0;a<n.categoryMatches.length;a++){const c="_"+n.categoryMatches[a];i.push(o+c)}}e=i}return e}function y$(t,e,r){for(let n=0;n<t.length;n++){if(n===r)continue;const i=t[n];for(let s=0;s<e.length;s++){const o=e[s];if(i[o]===!0)return!1}}return!0}function Q1(t,e){const r=$e(t,o=>Wd([o],1)),n=J1(r.length),i=$e(r,o=>{const a={};return Ye(o,c=>{const l=Hd(c.partialPath);Ye(l,u=>{a[u]=!0})}),a});let s=r;for(let o=1;o<=e;o++){const a=s;s=J1(a.length);for(let c=0;c<a.length;c++){const l=a[c];for(let u=0;u<l.length;u++){const h=l[u].partialPath,f=l[u].suffixDef,d=Hd(h);if(y$(i,d,c)||Et(f)||h.length===e){const p=n[c];if(qd(p,h)===!1){p.push(h);for(let g=0;g<d.length;g++){const y=d[g];i[c][y]=!0}}}else{const p=Wd(f,o+1,h);s[c]=s[c].concat(p),Ye(p,g=>{const y=Hd(g.partialPath);Ye(y,_=>{i[c][_]=!0})})}}}}return n}function Gd(t,e,r,n){const i=new Z1(t,$t.ALTERNATION,n);return e.accept(i),Q1(i.result,r)}function Kd(t,e,r,n){const i=new Z1(t,r);e.accept(i);const s=i.result,a=new g$(e,t,r).startWalking(),c=new qr({definition:s}),l=new qr({definition:a});return Q1([c,l],n)}function qd(t,e){e:for(let r=0;r<t.length;r++){const n=t[r];if(n.length===e.length){for(let i=0;i<n.length;i++){const s=e[i],o=n[i];if((s===o||o.categoryMatchesMap[s.tokenTypeIdx]!==void 0)===!1)continue e}return!0}}return!1}function _$(t,e){return t.length<e.length&&Un(t,(r,n)=>{const i=e[n];return r===i||i.categoryMatchesMap[r.tokenTypeIdx]})}function ew(t){return Un(t,e=>Un(e,r=>Un(r,n=>Et(n.categoryMatches))))}function b$(t){const e=t.lookaheadStrategy.validate({rules:t.rules,tokenTypes:t.tokenTypes,grammarName:t.grammarName});return $e(e,r=>Object.assign({type:Ir.CUSTOM_LOOKAHEAD_VALIDATION},r))}function w$(t,e,r,n){const i=vn(t,c=>k$(c,r)),s=L$(t,e,r),o=vn(t,c=>O$(c,r)),a=vn(t,c=>E$(c,t,n,r));return i.concat(s,o,a)}function k$(t,e){const r=new x$;t.accept(r);const n=r.allProductions,i=p1(n,v$),s=Pn(i,a=>a.length>1);return $e(Yt(s),a=>{const c=$n(a),l=e.buildDuplicateFoundError(t,a),u=ui(c),h={message:l,type:Ir.DUPLICATE_PRODUCTIONS,ruleName:t.name,dslName:u,occurrence:c.idx},f=tw(c);return f&&(h.parameter=f),h})}function v$(t){return`${ui(t)}_#_${t.idx}_#_${tw(t)}`}function tw(t){return t instanceof Ct?t.terminalType.name:t instanceof Kr?t.nonTerminalName:""}class x$ extends Ms{constructor(){super(...arguments),this.allProductions=[]}visitNonTerminal(e){this.allProductions.push(e)}visitOption(e){this.allProductions.push(e)}visitRepetitionWithSeparator(e){this.allProductions.push(e)}visitRepetitionMandatory(e){this.allProductions.push(e)}visitRepetitionMandatoryWithSeparator(e){this.allProductions.push(e)}visitRepetition(e){this.allProductions.push(e)}visitAlternation(e){this.allProductions.push(e)}visitTerminal(e){this.allProductions.push(e)}}function E$(t,e,r,n){const i=[];if(Gr(e,(o,a)=>a.name===t.name?o+1:o,0)>1){const o=n.buildDuplicateRuleNameError({topLevelRule:t,grammarName:r});i.push({message:o,type:Ir.DUPLICATE_RULE_NAME,ruleName:t.name})}return i}function A$(t,e,r){const n=[];let i;return Or(e,t)||(i=`Invalid rule override, rule: ->${t}<- cannot be overridden in the grammar: ->${r}<-as it is not defined in any of the super grammars `,n.push({message:i,type:Ir.INVALID_RULE_OVERRIDE,ruleName:t})),n}function rw(t,e,r,n=[]){const i=[],s=nu(e.definition);if(Et(s))return[];{const o=t.name;Or(s,t)&&i.push({message:r.buildLeftRecursionError({topLevelRule:t,leftRecursionPath:n}),type:Ir.LEFT_RECURSION,ruleName:o});const c=Fl(s,n.concat([t])),l=vn(c,u=>{const h=wr(n);return h.push(u),rw(t,u,r,h)});return i.concat(l)}}function nu(t){let e=[];if(Et(t))return e;const r=$n(t);if(r instanceof Kr)e.push(r.referencedRule);else if(r instanceof qr||r instanceof Yr||r instanceof ci||r instanceof li||r instanceof Bn||r instanceof nr)e=e.concat(nu(r.definition));else if(r instanceof Fn)e=sn($e(r.definition,s=>nu(s.definition)));else if(!(r instanceof Ct))throw Error("non exhaustive match");const n=Wl(r),i=t.length>1;if(n&&i){const s=kr(t);return e.concat(nu(s))}else return e}class Yd extends Ms{constructor(){super(...arguments),this.alternations=[]}visitAlternation(e){this.alternations.push(e)}}function T$(t,e){const r=new Yd;t.accept(r);const n=r.alternations;return vn(n,s=>{const o=Ha(s.definition);return vn(o,(a,c)=>{const l=V1([a],[],Va,1);return Et(l)?[{message:e.buildEmptyAlternationError({topLevelRule:t,alternation:s,emptyChoiceIdx:c}),type:Ir.NONE_LAST_EMPTY_ALT,ruleName:t.name,occurrence:s.idx,alternative:c+1}]:[]})})}function S$(t,e,r){const n=new Yd;t.accept(n);let i=n.alternations;return i=Dl(i,o=>o.ignoreAmbiguities===!0),vn(i,o=>{const a=o.idx,c=o.maxLookahead||e,l=Gd(a,t,c,o),u=N$(l,o,t,r),h=C$(l,o,t,r);return u.concat(h)})}class R$ extends Ms{constructor(){super(...arguments),this.allProductions=[]}visitRepetitionWithSeparator(e){this.allProductions.push(e)}visitRepetitionMandatory(e){this.allProductions.push(e)}visitRepetitionMandatoryWithSeparator(e){this.allProductions.push(e)}visitRepetition(e){this.allProductions.push(e)}}function O$(t,e){const r=new Yd;t.accept(r);const n=r.alternations;return vn(n,s=>s.definition.length>255?[{message:e.buildTooManyAlternativesError({topLevelRule:t,alternation:s}),type:Ir.TOO_MANY_ALTS,ruleName:t.name,occurrence:s.idx}]:[])}function I$(t,e,r){const n=[];return Ye(t,i=>{const s=new R$;i.accept(s);const o=s.allProductions;Ye(o,a=>{const c=X1(a),l=a.maxLookahead||e,u=a.idx,f=Kd(u,i,c,l)[0];if(Et(sn(f))){const d=r.buildEmptyRepetitionError({topLevelRule:i,repetition:a});n.push({message:d,type:Ir.NO_NON_EMPTY_LOOKAHEAD,ruleName:i.name})}})}),n}function N$(t,e,r,n){const i=[],s=Gr(t,(a,c,l)=>(e.definition[l].ignoreAmbiguities===!0||Ye(c,u=>{const h=[l];Ye(t,(f,d)=>{l!==d&&qd(f,u)&&e.definition[d].ignoreAmbiguities!==!0&&h.push(d)}),h.length>1&&!qd(i,u)&&(i.push(u),a.push({alts:h,path:u}))}),a),[]);return $e(s,a=>{const c=$e(a.alts,u=>u+1);return{message:n.buildAlternationAmbiguityError({topLevelRule:r,alternation:e,ambiguityIndices:c,prefixPath:a.path}),type:Ir.AMBIGUOUS_ALTS,ruleName:r.name,occurrence:e.idx,alternatives:a.alts}})}function C$(t,e,r,n){const i=Gr(t,(o,a,c)=>{const l=$e(a,u=>({idx:c,path:u}));return o.concat(l)},[]);return Wa(vn(i,o=>{if(e.definition[o.idx].ignoreAmbiguities===!0)return[];const c=o.idx,l=o.path,u=kn(i,f=>e.definition[f.idx].ignoreAmbiguities!==!0&&f.idx<c&&_$(f.path,l));return $e(u,f=>{const d=[f.idx+1,c+1],m=e.idx===0?"":e.idx;return{message:n.buildAlternationPrefixAmbiguityError({topLevelRule:r,alternation:e,ambiguityIndices:d,prefixPath:f.path}),type:Ir.AMBIGUOUS_PREFIX_ALTS,ruleName:r.name,occurrence:m,alternatives:d}})}))}function L$(t,e,r){const n=[],i=$e(e,s=>s.name);return Ye(t,s=>{const o=s.name;if(Or(i,o)){const a=r.buildNamespaceConflictError(s);n.push({message:a,type:Ir.CONFLICT_TOKENS_RULES_NAMESPACE,ruleName:o})}}),n}function M$(t){const e=Md(t,{errMsgProvider:i$}),r={};return Ye(t.rules,n=>{r[n.name]=n}),s$(r,e.errMsgProvider)}function U$(t){return t=Md(t,{errMsgProvider:Ps}),w$(t.rules,t.tokenTypes,t.errMsgProvider,t.grammarName)}const nw="MismatchedTokenException",iw="NoViableAltException",sw="EarlyExitException",ow="NotAllInputParsedException",aw=[nw,iw,sw,ow];Object.freeze(aw);function iu(t){return Or(aw,t.name)}class su extends Error{constructor(e,r){super(e),this.token=r,this.resyncedTokens=[],Object.setPrototypeOf(this,new.target.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor)}}class cw extends su{constructor(e,r,n){super(e,r),this.previousToken=n,this.name=nw}}class $$ extends su{constructor(e,r,n){super(e,r),this.previousToken=n,this.name=iw}}class P$ extends su{constructor(e,r){super(e,r),this.name=ow}}class B$ extends su{constructor(e,r,n){super(e,r),this.previousToken=n,this.name=sw}}const Vd={},lw="InRuleRecoveryException";class F$ extends Error{constructor(e){super(e),this.name=lw}}class D${initRecoverable(e){this.firstAfterRepMap={},this.resyncFollows={},this.recoveryEnabled=Ke(e,"recoveryEnabled")?e.recoveryEnabled:Oi.recoveryEnabled,this.recoveryEnabled&&(this.attemptInRepetitionRecovery=j$)}getTokenToInsert(e){const r=tu(e,"",NaN,NaN,NaN,NaN,NaN,NaN);return r.isInsertedInRecovery=!0,r}canTokenTypeBeInsertedInRecovery(e){return!0}canTokenTypeBeDeletedInRecovery(e){return!0}tryInRepetitionRecovery(e,r,n,i){const s=this.findReSyncTokenType(),o=this.exportLexerState(),a=[];let c=!1;const l=this.LA(1);let u=this.LA(1);const h=()=>{const f=this.LA(0),d=this.errorMessageProvider.buildMismatchTokenMessage({expected:i,actual:l,previous:f,ruleName:this.getCurrRuleFullName()}),m=new cw(d,l,this.LA(0));m.resyncedTokens=Ha(a),this.SAVE_ERROR(m)};for(;!c;)if(this.tokenMatcher(u,i)){h();return}else if(n.call(this)){h(),e.apply(this,r);return}else this.tokenMatcher(u,s)?c=!0:(u=this.SKIP_TOKEN(),this.addToResyncTokens(u,a));this.importLexerState(o)}shouldInRepetitionRecoveryBeTried(e,r,n){return!(n===!1||this.tokenMatcher(this.LA(1),e)||this.isBackTracking()||this.canPerformInRuleRecovery(e,this.getFollowsForInRuleRecovery(e,r)))}getFollowsForInRuleRecovery(e,r){const n=this.getCurrentGrammarPath(e,r);return this.getNextPossibleTokenTypes(n)}tryInRuleRecovery(e,r){if(this.canRecoverWithSingleTokenInsertion(e,r))return this.getTokenToInsert(e);if(this.canRecoverWithSingleTokenDeletion(e)){const n=this.SKIP_TOKEN();return this.consumeToken(),n}throw new F$("sad sad panda")}canPerformInRuleRecovery(e,r){return this.canRecoverWithSingleTokenInsertion(e,r)||this.canRecoverWithSingleTokenDeletion(e)}canRecoverWithSingleTokenInsertion(e,r){if(!this.canTokenTypeBeInsertedInRecovery(e)||Et(r))return!1;const n=this.LA(1);return Mo(r,s=>this.tokenMatcher(n,s))!==void 0}canRecoverWithSingleTokenDeletion(e){return this.canTokenTypeBeDeletedInRecovery(e)?this.tokenMatcher(this.LA(2),e):!1}isInCurrentRuleReSyncSet(e){const r=this.getCurrFollowKey(),n=this.getFollowSetFromFollowKey(r);return Or(n,e)}findReSyncTokenType(){const e=this.flattenFollowSet();let r=this.LA(1),n=2;for(;;){const i=Mo(e,s=>n$(r,s));if(i!==void 0)return i;r=this.LA(n),n++}}getCurrFollowKey(){if(this.RULE_STACK.length===1)return Vd;const e=this.getLastExplicitRuleShortName(),r=this.getLastExplicitRuleOccurrenceIndex(),n=this.getPreviousExplicitRuleShortName();return{ruleName:this.shortRuleNameToFullName(e),idxInCallingRule:r,inRule:this.shortRuleNameToFullName(n)}}buildFullFollowKeyStack(){const e=this.RULE_STACK,r=this.RULE_OCCURRENCE_STACK;return $e(e,(n,i)=>i===0?Vd:{ruleName:this.shortRuleNameToFullName(n),idxInCallingRule:r[i],inRule:this.shortRuleNameToFullName(e[i-1])})}flattenFollowSet(){const e=$e(this.buildFullFollowKeyStack(),r=>this.getFollowSetFromFollowKey(r));return sn(e)}getFollowSetFromFollowKey(e){if(e===Vd)return[$s];const r=e.ruleName+e.idxInCallingRule+k1+e.inRule;return this.resyncFollows[r]}addToResyncTokens(e,r){return this.tokenMatcher(e,$s)||r.push(e),r}reSyncTo(e){const r=[];let n=this.LA(1);for(;this.tokenMatcher(n,e)===!1;)n=this.SKIP_TOKEN(),this.addToResyncTokens(n,r);return Ha(r)}attemptInRepetitionRecovery(e,r,n,i,s,o,a){}getCurrentGrammarPath(e,r){const n=this.getHumanReadableRuleStack(),i=wr(this.RULE_OCCURRENCE_STACK);return{ruleStack:n,occurrenceStack:i,lastTok:e,lastTokOccurrence:r}}getHumanReadableRuleStack(){return $e(this.RULE_STACK,e=>this.shortRuleNameToFullName(e))}}function j$(t,e,r,n,i,s,o){const a=this.getKeyForAutomaticLookahead(n,i);let c=this.firstAfterRepMap[a];if(c===void 0){const f=this.getCurrRuleFullName(),d=this.getGAstProductions()[f];c=new s(d,i).startWalking(),this.firstAfterRepMap[a]=c}let l=c.token,u=c.occurrence;const h=c.isEndOfRule;this.RULE_STACK.length===1&&h&&l===void 0&&(l=$s,u=1),!(l===void 0||u===void 0)&&this.shouldInRepetitionRecoveryBeTried(l,u,o)&&this.tryInRepetitionRecovery(t,e,r,l)}const z$=4,ts=8,uw=1<<ts,hw=2<<ts,Xd=3<<ts,Zd=4<<ts,Jd=5<<ts,ou=6<<ts;function Qd(t,e,r){return r|e|t}class W${constructor(e){var r;this.maxLookahead=(r=e?.maxLookahead)!==null&&r!==void 0?r:Oi.maxLookahead}validate(e){const r=this.validateNoLeftRecursion(e.rules);if(Et(r)){const n=this.validateEmptyOrAlternatives(e.rules),i=this.validateAmbiguousAlternationAlternatives(e.rules,this.maxLookahead),s=this.validateSomeNonEmptyLookaheadPath(e.rules,this.maxLookahead);return[...r,...n,...i,...s]}return r}validateNoLeftRecursion(e){return vn(e,r=>rw(r,r,Ps))}validateEmptyOrAlternatives(e){return vn(e,r=>T$(r,Ps))}validateAmbiguousAlternationAlternatives(e,r){return vn(e,n=>S$(n,r,Ps))}validateSomeNonEmptyLookaheadPath(e,r){return I$(e,r,Ps)}buildLookaheadForAlternation(e){return f$(e.prodOccurrence,e.rule,e.maxLookahead,e.hasPredicates,e.dynamicTokensEnabled,p$)}buildLookaheadForOptional(e){return d$(e.prodOccurrence,e.rule,e.maxLookahead,e.dynamicTokensEnabled,X1(e.prodType),m$)}}class H${initLooksAhead(e){this.dynamicTokensEnabled=Ke(e,"dynamicTokensEnabled")?e.dynamicTokensEnabled:Oi.dynamicTokensEnabled,this.maxLookahead=Ke(e,"maxLookahead")?e.maxLookahead:Oi.maxLookahead,this.lookaheadStrategy=Ke(e,"lookaheadStrategy")?e.lookaheadStrategy:new W$({maxLookahead:this.maxLookahead}),this.lookAheadFuncsCache=new Map}preComputeLookaheadFunctions(e){Ye(e,r=>{this.TRACE_INIT(`${r.name} Rule Lookahead`,()=>{const{alternation:n,repetition:i,option:s,repetitionMandatory:o,repetitionMandatoryWithSeparator:a,repetitionWithSeparator:c}=K$(r);Ye(n,l=>{const u=l.idx===0?"":l.idx;this.TRACE_INIT(`${ui(l)}${u}`,()=>{const h=this.lookaheadStrategy.buildLookaheadForAlternation({prodOccurrence:l.idx,rule:r,maxLookahead:l.maxLookahead||this.maxLookahead,hasPredicates:l.hasPredicates,dynamicTokensEnabled:this.dynamicTokensEnabled}),f=Qd(this.fullRuleNameToShort[r.name],uw,l.idx);this.setLaFuncCache(f,h)})}),Ye(i,l=>{this.computeLookaheadFunc(r,l.idx,Xd,"Repetition",l.maxLookahead,ui(l))}),Ye(s,l=>{this.computeLookaheadFunc(r,l.idx,hw,"Option",l.maxLookahead,ui(l))}),Ye(o,l=>{this.computeLookaheadFunc(r,l.idx,Zd,"RepetitionMandatory",l.maxLookahead,ui(l))}),Ye(a,l=>{this.computeLookaheadFunc(r,l.idx,ou,"RepetitionMandatoryWithSeparator",l.maxLookahead,ui(l))}),Ye(c,l=>{this.computeLookaheadFunc(r,l.idx,Jd,"RepetitionWithSeparator",l.maxLookahead,ui(l))})})})}computeLookaheadFunc(e,r,n,i,s,o){this.TRACE_INIT(`${o}${r===0?"":r}`,()=>{const a=this.lookaheadStrategy.buildLookaheadForOptional({prodOccurrence:r,rule:e,maxLookahead:s||this.maxLookahead,dynamicTokensEnabled:this.dynamicTokensEnabled,prodType:i}),c=Qd(this.fullRuleNameToShort[e.name],n,r);this.setLaFuncCache(c,a)})}getKeyForAutomaticLookahead(e,r){const n=this.getLastExplicitRuleShortName();return Qd(n,e,r)}getLaFuncFromCache(e){return this.lookAheadFuncsCache.get(e)}setLaFuncCache(e,r){this.lookAheadFuncsCache.set(e,r)}}class G$ extends Ms{constructor(){super(...arguments),this.dslMethods={option:[],alternation:[],repetition:[],repetitionWithSeparator:[],repetitionMandatory:[],repetitionMandatoryWithSeparator:[]}}reset(){this.dslMethods={option:[],alternation:[],repetition:[],repetitionWithSeparator:[],repetitionMandatory:[],repetitionMandatoryWithSeparator:[]}}visitOption(e){this.dslMethods.option.push(e)}visitRepetitionWithSeparator(e){this.dslMethods.repetitionWithSeparator.push(e)}visitRepetitionMandatory(e){this.dslMethods.repetitionMandatory.push(e)}visitRepetitionMandatoryWithSeparator(e){this.dslMethods.repetitionMandatoryWithSeparator.push(e)}visitRepetition(e){this.dslMethods.repetition.push(e)}visitAlternation(e){this.dslMethods.alternation.push(e)}}const au=new G$;function K$(t){au.reset(),t.accept(au);const e=au.dslMethods;return au.reset(),e}function fw(t,e){isNaN(t.startOffset)===!0?(t.startOffset=e.startOffset,t.endOffset=e.endOffset):t.endOffset<e.endOffset&&(t.endOffset=e.endOffset)}function dw(t,e){isNaN(t.startOffset)===!0?(t.startOffset=e.startOffset,t.startColumn=e.startColumn,t.startLine=e.startLine,t.endOffset=e.endOffset,t.endColumn=e.endColumn,t.endLine=e.endLine):t.endOffset<e.endOffset&&(t.endOffset=e.endOffset,t.endColumn=e.endColumn,t.endLine=e.endLine)}function q$(t,e,r){t.children[r]===void 0?t.children[r]=[e]:t.children[r].push(e)}function Y$(t,e,r){t.children[e]===void 0?t.children[e]=[r]:t.children[e].push(r)}const V$="name";function pw(t,e){Object.defineProperty(t,V$,{enumerable:!1,configurable:!0,writable:!1,value:e})}function X$(t,e){const r=bn(t),n=r.length;for(let i=0;i<n;i++){const s=r[i],o=t[s],a=o.length;for(let c=0;c<a;c++){const l=o[c];l.tokenTypeIdx===void 0&&this[l.name](l.children,e)}}}function Z$(t,e){const r=function(){};pw(r,t+"BaseSemantics");const n={visit:function(i,s){if(lt(i)&&(i=i[0]),!Ri(i))return this[i.name](i.children,s)},validateVisitor:function(){const i=Q$(this,e);if(!Et(i)){const s=$e(i,o=>o.msg);throw Error(`Errors Detected in CST Visitor <${this.constructor.name}>:
	${s.join(`

`).replace(/\n/g,`
	`)}`)}}};return r.prototype=n,r.prototype.constructor=r,r._RULE_NAMES=e,r}function J$(t,e,r){const n=function(){};pw(n,t+"BaseSemanticsWithDefaults");const i=Object.create(r.prototype);return Ye(e,s=>{i[s]=X$}),n.prototype=i,n.prototype.constructor=n,n}var ep;(function(t){t[t.REDUNDANT_METHOD=0]="REDUNDANT_METHOD",t[t.MISSING_METHOD=1]="MISSING_METHOD"})(ep||(ep={}));function Q$(t,e){return eP(t,e)}function eP(t,e){const r=kn(e,i=>Ei(t[i])===!1),n=$e(r,i=>({msg:`Missing visitor method: <${i}> on ${t.constructor.name} CST Visitor.`,type:ep.MISSING_METHOD,methodName:i}));return Wa(n)}class tP{initTreeBuilder(e){if(this.CST_STACK=[],this.outputCst=e.outputCst,this.nodeLocationTracking=Ke(e,"nodeLocationTracking")?e.nodeLocationTracking:Oi.nodeLocationTracking,!this.outputCst)this.cstInvocationStateUpdate=rr,this.cstFinallyStateUpdate=rr,this.cstPostTerminal=rr,this.cstPostNonTerminal=rr,this.cstPostRule=rr;else if(/full/i.test(this.nodeLocationTracking))this.recoveryEnabled?(this.setNodeLocationFromToken=dw,this.setNodeLocationFromNode=dw,this.cstPostRule=rr,this.setInitialNodeLocation=this.setInitialNodeLocationFullRecovery):(this.setNodeLocationFromToken=rr,this.setNodeLocationFromNode=rr,this.cstPostRule=this.cstPostRuleFull,this.setInitialNodeLocation=this.setInitialNodeLocationFullRegular);else if(/onlyOffset/i.test(this.nodeLocationTracking))this.recoveryEnabled?(this.setNodeLocationFromToken=fw,this.setNodeLocationFromNode=fw,this.cstPostRule=rr,this.setInitialNodeLocation=this.setInitialNodeLocationOnlyOffsetRecovery):(this.setNodeLocationFromToken=rr,this.setNodeLocationFromNode=rr,this.cstPostRule=this.cstPostRuleOnlyOffset,this.setInitialNodeLocation=this.setInitialNodeLocationOnlyOffsetRegular);else if(/none/i.test(this.nodeLocationTracking))this.setNodeLocationFromToken=rr,this.setNodeLocationFromNode=rr,this.cstPostRule=rr,this.setInitialNodeLocation=rr;else throw Error(`Invalid <nodeLocationTracking> config option: "${e.nodeLocationTracking}"`)}setInitialNodeLocationOnlyOffsetRecovery(e){e.location={startOffset:NaN,endOffset:NaN}}setInitialNodeLocationOnlyOffsetRegular(e){e.location={startOffset:this.LA(1).startOffset,endOffset:NaN}}setInitialNodeLocationFullRecovery(e){e.location={startOffset:NaN,startLine:NaN,startColumn:NaN,endOffset:NaN,endLine:NaN,endColumn:NaN}}setInitialNodeLocationFullRegular(e){const r=this.LA(1);e.location={startOffset:r.startOffset,startLine:r.startLine,startColumn:r.startColumn,endOffset:NaN,endLine:NaN,endColumn:NaN}}cstInvocationStateUpdate(e){const r={name:e,children:Object.create(null)};this.setInitialNodeLocation(r),this.CST_STACK.push(r)}cstFinallyStateUpdate(){this.CST_STACK.pop()}cstPostRuleFull(e){const r=this.LA(0),n=e.location;n.startOffset<=r.startOffset?(n.endOffset=r.endOffset,n.endLine=r.endLine,n.endColumn=r.endColumn):(n.startOffset=NaN,n.startLine=NaN,n.startColumn=NaN)}cstPostRuleOnlyOffset(e){const r=this.LA(0),n=e.location;n.startOffset<=r.startOffset?n.endOffset=r.endOffset:n.startOffset=NaN}cstPostTerminal(e,r){const n=this.CST_STACK[this.CST_STACK.length-1];q$(n,r,e),this.setNodeLocationFromToken(n.location,r)}cstPostNonTerminal(e,r){const n=this.CST_STACK[this.CST_STACK.length-1];Y$(n,r,e),this.setNodeLocationFromNode(n.location,e.location)}getBaseCstVisitorConstructor(){if(Ri(this.baseCstVisitorConstructor)){const e=Z$(this.className,bn(this.gastProductionsCache));return this.baseCstVisitorConstructor=e,e}return this.baseCstVisitorConstructor}getBaseCstVisitorConstructorWithDefaults(){if(Ri(this.baseCstVisitorWithDefaultsConstructor)){const e=J$(this.className,bn(this.gastProductionsCache),this.getBaseCstVisitorConstructor());return this.baseCstVisitorWithDefaultsConstructor=e,e}return this.baseCstVisitorWithDefaultsConstructor}getLastExplicitRuleShortName(){const e=this.RULE_STACK;return e[e.length-1]}getPreviousExplicitRuleShortName(){const e=this.RULE_STACK;return e[e.length-2]}getLastExplicitRuleOccurrenceIndex(){const e=this.RULE_OCCURRENCE_STACK;return e[e.length-1]}}class rP{initLexerAdapter(){this.tokVector=[],this.tokVectorLength=0,this.currIdx=-1}set input(e){if(this.selfAnalysisDone!==!0)throw Error("Missing <performSelfAnalysis> invocation at the end of the Parser's constructor.");this.reset(),this.tokVector=e,this.tokVectorLength=e.length}get input(){return this.tokVector}SKIP_TOKEN(){return this.currIdx<=this.tokVector.length-2?(this.consumeToken(),this.LA(1)):uu}LA(e){const r=this.currIdx+e;return r<0||this.tokVectorLength<=r?uu:this.tokVector[r]}consumeToken(){this.currIdx++}exportLexerState(){return this.currIdx}importLexerState(e){this.currIdx=e}resetLexerState(){this.currIdx=-1}moveToTerminatedState(){this.currIdx=this.tokVector.length-1}getLexerPosition(){return this.exportLexerState()}}class nP{ACTION(e){return e.call(this)}consume(e,r,n){return this.consumeInternal(r,e,n)}subrule(e,r,n){return this.subruleInternal(r,e,n)}option(e,r){return this.optionInternal(r,e)}or(e,r){return this.orInternal(r,e)}many(e,r){return this.manyInternal(e,r)}atLeastOne(e,r){return this.atLeastOneInternal(e,r)}CONSUME(e,r){return this.consumeInternal(e,0,r)}CONSUME1(e,r){return this.consumeInternal(e,1,r)}CONSUME2(e,r){return this.consumeInternal(e,2,r)}CONSUME3(e,r){return this.consumeInternal(e,3,r)}CONSUME4(e,r){return this.consumeInternal(e,4,r)}CONSUME5(e,r){return this.consumeInternal(e,5,r)}CONSUME6(e,r){return this.consumeInternal(e,6,r)}CONSUME7(e,r){return this.consumeInternal(e,7,r)}CONSUME8(e,r){return this.consumeInternal(e,8,r)}CONSUME9(e,r){return this.consumeInternal(e,9,r)}SUBRULE(e,r){return this.subruleInternal(e,0,r)}SUBRULE1(e,r){return this.subruleInternal(e,1,r)}SUBRULE2(e,r){return this.subruleInternal(e,2,r)}SUBRULE3(e,r){return this.subruleInternal(e,3,r)}SUBRULE4(e,r){return this.subruleInternal(e,4,r)}SUBRULE5(e,r){return this.subruleInternal(e,5,r)}SUBRULE6(e,r){return this.subruleInternal(e,6,r)}SUBRULE7(e,r){return this.subruleInternal(e,7,r)}SUBRULE8(e,r){return this.subruleInternal(e,8,r)}SUBRULE9(e,r){return this.subruleInternal(e,9,r)}OPTION(e){return this.optionInternal(e,0)}OPTION1(e){return this.optionInternal(e,1)}OPTION2(e){return this.optionInternal(e,2)}OPTION3(e){return this.optionInternal(e,3)}OPTION4(e){return this.optionInternal(e,4)}OPTION5(e){return this.optionInternal(e,5)}OPTION6(e){return this.optionInternal(e,6)}OPTION7(e){return this.optionInternal(e,7)}OPTION8(e){return this.optionInternal(e,8)}OPTION9(e){return this.optionInternal(e,9)}OR(e){return this.orInternal(e,0)}OR1(e){return this.orInternal(e,1)}OR2(e){return this.orInternal(e,2)}OR3(e){return this.orInternal(e,3)}OR4(e){return this.orInternal(e,4)}OR5(e){return this.orInternal(e,5)}OR6(e){return this.orInternal(e,6)}OR7(e){return this.orInternal(e,7)}OR8(e){return this.orInternal(e,8)}OR9(e){return this.orInternal(e,9)}MANY(e){this.manyInternal(0,e)}MANY1(e){this.manyInternal(1,e)}MANY2(e){this.manyInternal(2,e)}MANY3(e){this.manyInternal(3,e)}MANY4(e){this.manyInternal(4,e)}MANY5(e){this.manyInternal(5,e)}MANY6(e){this.manyInternal(6,e)}MANY7(e){this.manyInternal(7,e)}MANY8(e){this.manyInternal(8,e)}MANY9(e){this.manyInternal(9,e)}MANY_SEP(e){this.manySepFirstInternal(0,e)}MANY_SEP1(e){this.manySepFirstInternal(1,e)}MANY_SEP2(e){this.manySepFirstInternal(2,e)}MANY_SEP3(e){this.manySepFirstInternal(3,e)}MANY_SEP4(e){this.manySepFirstInternal(4,e)}MANY_SEP5(e){this.manySepFirstInternal(5,e)}MANY_SEP6(e){this.manySepFirstInternal(6,e)}MANY_SEP7(e){this.manySepFirstInternal(7,e)}MANY_SEP8(e){this.manySepFirstInternal(8,e)}MANY_SEP9(e){this.manySepFirstInternal(9,e)}AT_LEAST_ONE(e){this.atLeastOneInternal(0,e)}AT_LEAST_ONE1(e){return this.atLeastOneInternal(1,e)}AT_LEAST_ONE2(e){this.atLeastOneInternal(2,e)}AT_LEAST_ONE3(e){this.atLeastOneInternal(3,e)}AT_LEAST_ONE4(e){this.atLeastOneInternal(4,e)}AT_LEAST_ONE5(e){this.atLeastOneInternal(5,e)}AT_LEAST_ONE6(e){this.atLeastOneInternal(6,e)}AT_LEAST_ONE7(e){this.atLeastOneInternal(7,e)}AT_LEAST_ONE8(e){this.atLeastOneInternal(8,e)}AT_LEAST_ONE9(e){this.atLeastOneInternal(9,e)}AT_LEAST_ONE_SEP(e){this.atLeastOneSepFirstInternal(0,e)}AT_LEAST_ONE_SEP1(e){this.atLeastOneSepFirstInternal(1,e)}AT_LEAST_ONE_SEP2(e){this.atLeastOneSepFirstInternal(2,e)}AT_LEAST_ONE_SEP3(e){this.atLeastOneSepFirstInternal(3,e)}AT_LEAST_ONE_SEP4(e){this.atLeastOneSepFirstInternal(4,e)}AT_LEAST_ONE_SEP5(e){this.atLeastOneSepFirstInternal(5,e)}AT_LEAST_ONE_SEP6(e){this.atLeastOneSepFirstInternal(6,e)}AT_LEAST_ONE_SEP7(e){this.atLeastOneSepFirstInternal(7,e)}AT_LEAST_ONE_SEP8(e){this.atLeastOneSepFirstInternal(8,e)}AT_LEAST_ONE_SEP9(e){this.atLeastOneSepFirstInternal(9,e)}RULE(e,r,n=hu){if(Or(this.definedRulesNames,e)){const o={message:Ps.buildDuplicateRuleNameError({topLevelRule:e,grammarName:this.className}),type:Ir.DUPLICATE_RULE_NAME,ruleName:e};this.definitionErrors.push(o)}this.definedRulesNames.push(e);const i=this.defineRule(e,r,n);return this[e]=i,i}OVERRIDE_RULE(e,r,n=hu){const i=A$(e,this.definedRulesNames,this.className);this.definitionErrors=this.definitionErrors.concat(i);const s=this.defineRule(e,r,n);return this[e]=s,s}BACKTRACK(e,r){return function(){this.isBackTrackingStack.push(1);const n=this.saveRecogState();try{return e.apply(this,r),!0}catch(i){if(iu(i))return!1;throw i}finally{this.reloadRecogState(n),this.isBackTrackingStack.pop()}}}getGAstProductions(){return this.gastProductionsCache}getSerializedGastProductions(){return s8(Yt(this.gastProductionsCache))}}class iP{initRecognizerEngine(e,r){if(this.className=this.constructor.name,this.shortRuleNameToFull={},this.fullRuleNameToShort={},this.ruleShortNameIdx=256,this.tokenMatcher=eu,this.subruleIdx=0,this.definedRulesNames=[],this.tokensMap={},this.isBackTrackingStack=[],this.RULE_STACK=[],this.RULE_OCCURRENCE_STACK=[],this.gastProductionsCache={},Ke(r,"serializedGrammar"))throw Error(`The Parser's configuration can no longer contain a <serializedGrammar> property.
	See: https://chevrotain.io/docs/changes/BREAKING_CHANGES.html#_6-0-0
	For Further details.`);if(lt(e)){if(Et(e))throw Error(`A Token Vocabulary cannot be empty.
	Note that the first argument for the parser constructor
	is no longer a Token vector (since v4.0).`);if(typeof e[0].startOffset=="number")throw Error(`The Parser constructor no longer accepts a token vector as the first argument.
	See: https://chevrotain.io/docs/changes/BREAKING_CHANGES.html#_4-0-0
	For Further details.`)}if(lt(e))this.tokensMap=Gr(e,(s,o)=>(s[o.name]=o,s),{});else if(Ke(e,"modes")&&Un(sn(Yt(e.modes)),Q8)){const s=sn(Yt(e.modes)),o=jl(s);this.tokensMap=Gr(o,(a,c)=>(a[c.name]=c,a),{})}else if(_n(e))this.tokensMap=wr(e);else throw new Error("<tokensDictionary> argument must be An Array of Token constructors, A dictionary of Token constructors or an IMultiModeLexerDefinition");this.tokensMap.EOF=$s;const n=Ke(e,"modes")?sn(Yt(e.modes)):Yt(e),i=Un(n,s=>Et(s.categoryMatches));this.tokenMatcher=i?eu:Va,Xa(Yt(this.tokensMap))}defineRule(e,r,n){if(this.selfAnalysisDone)throw Error(`Grammar rule <${e}> may not be defined after the 'performSelfAnalysis' method has been called'
Make sure that all grammar rule definitions are done before 'performSelfAnalysis' is called.`);const i=Ke(n,"resyncEnabled")?n.resyncEnabled:hu.resyncEnabled,s=Ke(n,"recoveryValueFunc")?n.recoveryValueFunc:hu.recoveryValueFunc,o=this.ruleShortNameIdx<<z$+ts;this.ruleShortNameIdx++,this.shortRuleNameToFull[o]=e,this.fullRuleNameToShort[e]=o;let a;return this.outputCst===!0?a=function(...u){try{this.ruleInvocationStateUpdate(o,e,this.subruleIdx),r.apply(this,u);const h=this.CST_STACK[this.CST_STACK.length-1];return this.cstPostRule(h),h}catch(h){return this.invokeRuleCatch(h,i,s)}finally{this.ruleFinallyStateUpdate()}}:a=function(...u){try{return this.ruleInvocationStateUpdate(o,e,this.subruleIdx),r.apply(this,u)}catch(h){return this.invokeRuleCatch(h,i,s)}finally{this.ruleFinallyStateUpdate()}},Object.assign(a,{ruleName:e,originalGrammarAction:r})}invokeRuleCatch(e,r,n){const i=this.RULE_STACK.length===1,s=r&&!this.isBackTracking()&&this.recoveryEnabled;if(iu(e)){const o=e;if(s){const a=this.findReSyncTokenType();if(this.isInCurrentRuleReSyncSet(a))if(o.resyncedTokens=this.reSyncTo(a),this.outputCst){const c=this.CST_STACK[this.CST_STACK.length-1];return c.recoveredNode=!0,c}else return n(e);else{if(this.outputCst){const c=this.CST_STACK[this.CST_STACK.length-1];c.recoveredNode=!0,o.partialCstResult=c}throw o}}else{if(i)return this.moveToTerminatedState(),n(e);throw o}}else throw e}optionInternal(e,r){const n=this.getKeyForAutomaticLookahead(hw,r);return this.optionInternalLogic(e,r,n)}optionInternalLogic(e,r,n){let i=this.getLaFuncFromCache(n),s;if(typeof e!="function"){s=e.DEF;const o=e.GATE;if(o!==void 0){const a=i;i=()=>o.call(this)&&a.call(this)}}else s=e;if(i.call(this)===!0)return s.call(this)}atLeastOneInternal(e,r){const n=this.getKeyForAutomaticLookahead(Zd,e);return this.atLeastOneInternalLogic(e,r,n)}atLeastOneInternalLogic(e,r,n){let i=this.getLaFuncFromCache(n),s;if(typeof r!="function"){s=r.DEF;const o=r.GATE;if(o!==void 0){const a=i;i=()=>o.call(this)&&a.call(this)}}else s=r;if(i.call(this)===!0){let o=this.doSingleRepetition(s);for(;i.call(this)===!0&&o===!0;)o=this.doSingleRepetition(s)}else throw this.raiseEarlyExitException(e,$t.REPETITION_MANDATORY,r.ERR_MSG);this.attemptInRepetitionRecovery(this.atLeastOneInternal,[e,r],i,Zd,e,u$)}atLeastOneSepFirstInternal(e,r){const n=this.getKeyForAutomaticLookahead(ou,e);this.atLeastOneSepFirstInternalLogic(e,r,n)}atLeastOneSepFirstInternalLogic(e,r,n){const i=r.DEF,s=r.SEP;if(this.getLaFuncFromCache(n).call(this)===!0){i.call(this);const a=()=>this.tokenMatcher(this.LA(1),s);for(;this.tokenMatcher(this.LA(1),s)===!0;)this.CONSUME(s),i.call(this);this.attemptInRepetitionRecovery(this.repetitionSepSecondInternal,[e,s,a,i,Y1],a,ou,e,Y1)}else throw this.raiseEarlyExitException(e,$t.REPETITION_MANDATORY_WITH_SEPARATOR,r.ERR_MSG)}manyInternal(e,r){const n=this.getKeyForAutomaticLookahead(Xd,e);return this.manyInternalLogic(e,r,n)}manyInternalLogic(e,r,n){let i=this.getLaFuncFromCache(n),s;if(typeof r!="function"){s=r.DEF;const a=r.GATE;if(a!==void 0){const c=i;i=()=>a.call(this)&&c.call(this)}}else s=r;let o=!0;for(;i.call(this)===!0&&o===!0;)o=this.doSingleRepetition(s);this.attemptInRepetitionRecovery(this.manyInternal,[e,r],i,Xd,e,l$,o)}manySepFirstInternal(e,r){const n=this.getKeyForAutomaticLookahead(Jd,e);this.manySepFirstInternalLogic(e,r,n)}manySepFirstInternalLogic(e,r,n){const i=r.DEF,s=r.SEP;if(this.getLaFuncFromCache(n).call(this)===!0){i.call(this);const a=()=>this.tokenMatcher(this.LA(1),s);for(;this.tokenMatcher(this.LA(1),s)===!0;)this.CONSUME(s),i.call(this);this.attemptInRepetitionRecovery(this.repetitionSepSecondInternal,[e,s,a,i,q1],a,Jd,e,q1)}}repetitionSepSecondInternal(e,r,n,i,s){for(;n();)this.CONSUME(r),i.call(this);this.attemptInRepetitionRecovery(this.repetitionSepSecondInternal,[e,r,n,i,s],n,ou,e,s)}doSingleRepetition(e){const r=this.getLexerPosition();return e.call(this),this.getLexerPosition()>r}orInternal(e,r){const n=this.getKeyForAutomaticLookahead(uw,r),i=lt(e)?e:e.DEF,o=this.getLaFuncFromCache(n).call(this,i);if(o!==void 0)return i[o].ALT.call(this);this.raiseNoAltException(r,e.ERR_MSG)}ruleFinallyStateUpdate(){if(this.RULE_STACK.pop(),this.RULE_OCCURRENCE_STACK.pop(),this.cstFinallyStateUpdate(),this.RULE_STACK.length===0&&this.isAtEndOfInput()===!1){const e=this.LA(1),r=this.errorMessageProvider.buildNotAllInputParsedMessage({firstRedundant:e,ruleName:this.getCurrRuleFullName()});this.SAVE_ERROR(new P$(r,e))}}subruleInternal(e,r,n){let i;try{const s=n!==void 0?n.ARGS:void 0;return this.subruleIdx=r,i=e.apply(this,s),this.cstPostNonTerminal(i,n!==void 0&&n.LABEL!==void 0?n.LABEL:e.ruleName),i}catch(s){throw this.subruleInternalError(s,n,e.ruleName)}}subruleInternalError(e,r,n){throw iu(e)&&e.partialCstResult!==void 0&&(this.cstPostNonTerminal(e.partialCstResult,r!==void 0&&r.LABEL!==void 0?r.LABEL:n),delete e.partialCstResult),e}consumeInternal(e,r,n){let i;try{const s=this.LA(1);this.tokenMatcher(s,e)===!0?(this.consumeToken(),i=s):this.consumeInternalError(e,s,n)}catch(s){i=this.consumeInternalRecovery(e,r,s)}return this.cstPostTerminal(n!==void 0&&n.LABEL!==void 0?n.LABEL:e.name,i),i}consumeInternalError(e,r,n){let i;const s=this.LA(0);throw n!==void 0&&n.ERR_MSG?i=n.ERR_MSG:i=this.errorMessageProvider.buildMismatchTokenMessage({expected:e,actual:r,previous:s,ruleName:this.getCurrRuleFullName()}),this.SAVE_ERROR(new cw(i,r,s))}consumeInternalRecovery(e,r,n){if(this.recoveryEnabled&&n.name==="MismatchedTokenException"&&!this.isBackTracking()){const i=this.getFollowsForInRuleRecovery(e,r);try{return this.tryInRuleRecovery(e,i)}catch(s){throw s.name===lw?n:s}}else throw n}saveRecogState(){const e=this.errors,r=wr(this.RULE_STACK);return{errors:e,lexerState:this.exportLexerState(),RULE_STACK:r,CST_STACK:this.CST_STACK}}reloadRecogState(e){this.errors=e.errors,this.importLexerState(e.lexerState),this.RULE_STACK=e.RULE_STACK}ruleInvocationStateUpdate(e,r,n){this.RULE_OCCURRENCE_STACK.push(n),this.RULE_STACK.push(e),this.cstInvocationStateUpdate(r)}isBackTracking(){return this.isBackTrackingStack.length!==0}getCurrRuleFullName(){const e=this.getLastExplicitRuleShortName();return this.shortRuleNameToFull[e]}shortRuleNameToFullName(e){return this.shortRuleNameToFull[e]}isAtEndOfInput(){return this.tokenMatcher(this.LA(1),$s)}reset(){this.resetLexerState(),this.subruleIdx=0,this.isBackTrackingStack=[],this.errors=[],this.RULE_STACK=[],this.CST_STACK=[],this.RULE_OCCURRENCE_STACK=[]}}class sP{initErrorHandler(e){this._errors=[],this.errorMessageProvider=Ke(e,"errorMessageProvider")?e.errorMessageProvider:Oi.errorMessageProvider}SAVE_ERROR(e){if(iu(e))return e.context={ruleStack:this.getHumanReadableRuleStack(),ruleOccurrenceStack:wr(this.RULE_OCCURRENCE_STACK)},this._errors.push(e),e;throw Error("Trying to save an Error which is not a RecognitionException")}get errors(){return wr(this._errors)}set errors(e){this._errors=e}raiseEarlyExitException(e,r,n){const i=this.getCurrRuleFullName(),s=this.getGAstProductions()[i],a=Kd(e,s,r,this.maxLookahead)[0],c=[];for(let u=1;u<=this.maxLookahead;u++)c.push(this.LA(u));const l=this.errorMessageProvider.buildEarlyExitMessage({expectedIterationPaths:a,actual:c,previous:this.LA(0),customUserDescription:n,ruleName:i});throw this.SAVE_ERROR(new B$(l,this.LA(1),this.LA(0)))}raiseNoAltException(e,r){const n=this.getCurrRuleFullName(),i=this.getGAstProductions()[n],s=Gd(e,i,this.maxLookahead),o=[];for(let l=1;l<=this.maxLookahead;l++)o.push(this.LA(l));const a=this.LA(0),c=this.errorMessageProvider.buildNoViableAltMessage({expectedPathsPerAlt:s,actual:o,previous:a,customUserDescription:r,ruleName:this.getCurrRuleFullName()});throw this.SAVE_ERROR(new $$(c,this.LA(1),a))}}class oP{initContentAssist(){}computeContentAssist(e,r){const n=this.gastProductionsCache[e];if(Ri(n))throw Error(`Rule ->${e}<- does not exist in this grammar.`);return V1([n],r,this.tokenMatcher,this.maxLookahead)}getNextPossibleTokenTypes(e){const r=$n(e.ruleStack),i=this.getGAstProductions()[r];return new c$(i,e).startWalking()}}const cu={description:"This Object indicates the Parser is during Recording Phase"};Object.freeze(cu);const mw=!0,gw=Math.pow(2,ts)-1,yw=on({name:"RECORDING_PHASE_TOKEN",pattern:ur.NA});Xa([yw]);const _w=tu(yw,`This IToken indicates the Parser is in Recording Phase
	See: https://chevrotain.io/docs/guide/internals.html#grammar-recording for details`,-1,-1,-1,-1,-1,-1);Object.freeze(_w);const aP={name:`This CSTNode indicates the Parser is in Recording Phase
	See: https://chevrotain.io/docs/guide/internals.html#grammar-recording for details`,children:{}};class cP{initGastRecorder(e){this.recordingProdStack=[],this.RECORDING_PHASE=!1}enableRecording(){this.RECORDING_PHASE=!0,this.TRACE_INIT("Enable Recording",()=>{for(let e=0;e<10;e++){const r=e>0?e:"";this[`CONSUME${r}`]=function(n,i){return this.consumeInternalRecord(n,e,i)},this[`SUBRULE${r}`]=function(n,i){return this.subruleInternalRecord(n,e,i)},this[`OPTION${r}`]=function(n){return this.optionInternalRecord(n,e)},this[`OR${r}`]=function(n){return this.orInternalRecord(n,e)},this[`MANY${r}`]=function(n){this.manyInternalRecord(e,n)},this[`MANY_SEP${r}`]=function(n){this.manySepFirstInternalRecord(e,n)},this[`AT_LEAST_ONE${r}`]=function(n){this.atLeastOneInternalRecord(e,n)},this[`AT_LEAST_ONE_SEP${r}`]=function(n){this.atLeastOneSepFirstInternalRecord(e,n)}}this.consume=function(e,r,n){return this.consumeInternalRecord(r,e,n)},this.subrule=function(e,r,n){return this.subruleInternalRecord(r,e,n)},this.option=function(e,r){return this.optionInternalRecord(r,e)},this.or=function(e,r){return this.orInternalRecord(r,e)},this.many=function(e,r){this.manyInternalRecord(e,r)},this.atLeastOne=function(e,r){this.atLeastOneInternalRecord(e,r)},this.ACTION=this.ACTION_RECORD,this.BACKTRACK=this.BACKTRACK_RECORD,this.LA=this.LA_RECORD})}disableRecording(){this.RECORDING_PHASE=!1,this.TRACE_INIT("Deleting Recording methods",()=>{const e=this;for(let r=0;r<10;r++){const n=r>0?r:"";delete e[`CONSUME${n}`],delete e[`SUBRULE${n}`],delete e[`OPTION${n}`],delete e[`OR${n}`],delete e[`MANY${n}`],delete e[`MANY_SEP${n}`],delete e[`AT_LEAST_ONE${n}`],delete e[`AT_LEAST_ONE_SEP${n}`]}delete e.consume,delete e.subrule,delete e.option,delete e.or,delete e.many,delete e.atLeastOne,delete e.ACTION,delete e.BACKTRACK,delete e.LA})}ACTION_RECORD(e){}BACKTRACK_RECORD(e,r){return()=>!0}LA_RECORD(e){return uu}topLevelRuleRecord(e,r){try{const n=new Uo({definition:[],name:e});return n.name=e,this.recordingProdStack.push(n),r.call(this),this.recordingProdStack.pop(),n}catch(n){if(n.KNOWN_RECORDER_ERROR!==!0)try{n.message=n.message+`
	 This error was thrown during the "grammar recording phase" For more info see:
	https://chevrotain.io/docs/guide/internals.html#grammar-recording`}catch{throw n}throw n}}optionInternalRecord(e,r){return Qa.call(this,Yr,e,r)}atLeastOneInternalRecord(e,r){Qa.call(this,ci,r,e)}atLeastOneSepFirstInternalRecord(e,r){Qa.call(this,li,r,e,mw)}manyInternalRecord(e,r){Qa.call(this,nr,r,e)}manySepFirstInternalRecord(e,r){Qa.call(this,Bn,r,e,mw)}orInternalRecord(e,r){return lP.call(this,e,r)}subruleInternalRecord(e,r,n){if(lu(r),!e||Ke(e,"ruleName")===!1){const a=new Error(`<SUBRULE${bw(r)}> argument is invalid expecting a Parser method reference but got: <${JSON.stringify(e)}>
 inside top level rule: <${this.recordingProdStack[0].name}>`);throw a.KNOWN_RECORDER_ERROR=!0,a}const i=Lo(this.recordingProdStack),s=e.ruleName,o=new Kr({idx:r,nonTerminalName:s,label:n?.LABEL,referencedRule:void 0});return i.definition.push(o),this.outputCst?aP:cu}consumeInternalRecord(e,r,n){if(lu(r),!U1(e)){const o=new Error(`<CONSUME${bw(r)}> argument is invalid expecting a TokenType reference but got: <${JSON.stringify(e)}>
 inside top level rule: <${this.recordingProdStack[0].name}>`);throw o.KNOWN_RECORDER_ERROR=!0,o}const i=Lo(this.recordingProdStack),s=new Ct({idx:r,terminalType:e,label:n?.LABEL});return i.definition.push(s),_w}}function Qa(t,e,r,n=!1){lu(r);const i=Lo(this.recordingProdStack),s=Ei(e)?e:e.DEF,o=new t({definition:[],idx:r});return n&&(o.separator=e.SEP),Ke(e,"MAX_LOOKAHEAD")&&(o.maxLookahead=e.MAX_LOOKAHEAD),this.recordingProdStack.push(o),s.call(this),i.definition.push(o),this.recordingProdStack.pop(),cu}function lP(t,e){lu(e);const r=Lo(this.recordingProdStack),n=lt(t)===!1,i=n===!1?t:t.DEF,s=new Fn({definition:[],idx:e,ignoreAmbiguities:n&&t.IGNORE_AMBIGUITIES===!0});Ke(t,"MAX_LOOKAHEAD")&&(s.maxLookahead=t.MAX_LOOKAHEAD);const o=Ud(i,a=>Ei(a.GATE));return s.hasPredicates=o,r.definition.push(s),Ye(i,a=>{const c=new qr({definition:[]});s.definition.push(c),Ke(a,"IGNORE_AMBIGUITIES")?c.ignoreAmbiguities=a.IGNORE_AMBIGUITIES:Ke(a,"GATE")&&(c.ignoreAmbiguities=!0),this.recordingProdStack.push(c),a.ALT.call(this),this.recordingProdStack.pop()}),cu}function bw(t){return t===0?"":`${t}`}function lu(t){if(t<0||t>gw){const e=new Error(`Invalid DSL Method idx value: <${t}>
	Idx value must be a none negative value smaller than ${gw+1}`);throw e.KNOWN_RECORDER_ERROR=!0,e}}class uP{initPerformanceTracer(e){if(Ke(e,"traceInitPerf")){const r=e.traceInitPerf,n=typeof r=="number";this.traceInitMaxIdent=n?r:1/0,this.traceInitPerf=n?r>0:r}else this.traceInitMaxIdent=0,this.traceInitPerf=Oi.traceInitPerf;this.traceInitIndent=-1}TRACE_INIT(e,r){if(this.traceInitPerf===!0){this.traceInitIndent++;const n=new Array(this.traceInitIndent+1).join("	");this.traceInitIndent<this.traceInitMaxIdent&&console.log(`${n}--> <${e}>`);const{time:i,value:s}=_1(r),o=i>10?console.warn:console.log;return this.traceInitIndent<this.traceInitMaxIdent&&o(`${n}<-- <${e}> time: ${i}ms`),this.traceInitIndent--,s}else return r()}}function hP(t,e){e.forEach(r=>{const n=r.prototype;Object.getOwnPropertyNames(n).forEach(i=>{if(i==="constructor")return;const s=Object.getOwnPropertyDescriptor(n,i);s&&(s.get||s.set)?Object.defineProperty(t.prototype,i,s):t.prototype[i]=r.prototype[i]})})}const uu=tu($s,"",NaN,NaN,NaN,NaN,NaN,NaN);Object.freeze(uu);const Oi=Object.freeze({recoveryEnabled:!1,maxLookahead:3,dynamicTokensEnabled:!1,outputCst:!0,errorMessageProvider:K1,nodeLocationTracking:"none",traceInitPerf:!1,skipValidations:!1}),hu=Object.freeze({recoveryValueFunc:()=>{},resyncEnabled:!0});var Ir;(function(t){t[t.INVALID_RULE_NAME=0]="INVALID_RULE_NAME",t[t.DUPLICATE_RULE_NAME=1]="DUPLICATE_RULE_NAME",t[t.INVALID_RULE_OVERRIDE=2]="INVALID_RULE_OVERRIDE",t[t.DUPLICATE_PRODUCTIONS=3]="DUPLICATE_PRODUCTIONS",t[t.UNRESOLVED_SUBRULE_REF=4]="UNRESOLVED_SUBRULE_REF",t[t.LEFT_RECURSION=5]="LEFT_RECURSION",t[t.NONE_LAST_EMPTY_ALT=6]="NONE_LAST_EMPTY_ALT",t[t.AMBIGUOUS_ALTS=7]="AMBIGUOUS_ALTS",t[t.CONFLICT_TOKENS_RULES_NAMESPACE=8]="CONFLICT_TOKENS_RULES_NAMESPACE",t[t.INVALID_TOKEN_NAME=9]="INVALID_TOKEN_NAME",t[t.NO_NON_EMPTY_LOOKAHEAD=10]="NO_NON_EMPTY_LOOKAHEAD",t[t.AMBIGUOUS_PREFIX_ALTS=11]="AMBIGUOUS_PREFIX_ALTS",t[t.TOO_MANY_ALTS=12]="TOO_MANY_ALTS",t[t.CUSTOM_LOOKAHEAD_VALIDATION=13]="CUSTOM_LOOKAHEAD_VALIDATION"})(Ir||(Ir={}));let tp=class PS{static performSelfAnalysis(e){throw Error("The **static** `performSelfAnalysis` method has been deprecated.	\nUse the **instance** method with the same name instead.")}performSelfAnalysis(){this.TRACE_INIT("performSelfAnalysis",()=>{let e;this.selfAnalysisDone=!0;const r=this.className;this.TRACE_INIT("toFastProps",()=>{b1(this)}),this.TRACE_INIT("Grammar Recording",()=>{try{this.enableRecording(),Ye(this.definedRulesNames,i=>{const o=this[i].originalGrammarAction;let a;this.TRACE_INIT(`${i} Rule`,()=>{a=this.topLevelRuleRecord(i,o)}),this.gastProductionsCache[i]=a})}finally{this.disableRecording()}});let n=[];if(this.TRACE_INIT("Grammar Resolving",()=>{n=M$({rules:Yt(this.gastProductionsCache)}),this.definitionErrors=this.definitionErrors.concat(n)}),this.TRACE_INIT("Grammar Validations",()=>{if(Et(n)&&this.skipValidations===!1){const i=U$({rules:Yt(this.gastProductionsCache),tokenTypes:Yt(this.tokensMap),errMsgProvider:Ps,grammarName:r}),s=b$({lookaheadStrategy:this.lookaheadStrategy,rules:Yt(this.gastProductionsCache),tokenTypes:Yt(this.tokensMap),grammarName:r});this.definitionErrors=this.definitionErrors.concat(i,s)}}),Et(this.definitionErrors)&&(this.recoveryEnabled&&this.TRACE_INIT("computeAllProdsFollows",()=>{const i=f8(Yt(this.gastProductionsCache));this.resyncFollows=i}),this.TRACE_INIT("ComputeLookaheadFunctions",()=>{var i,s;(s=(i=this.lookaheadStrategy).initialize)===null||s===void 0||s.call(i,{rules:Yt(this.gastProductionsCache)}),this.preComputeLookaheadFunctions(Yt(this.gastProductionsCache))})),!PS.DEFER_DEFINITION_ERRORS_HANDLING&&!Et(this.definitionErrors))throw e=$e(this.definitionErrors,i=>i.message),new Error(`Parser Definition Errors detected:
 ${e.join(`
-------------------------------
`)}`)})}constructor(e,r){this.definitionErrors=[],this.selfAnalysisDone=!1;const n=this;if(n.initErrorHandler(r),n.initLexerAdapter(),n.initLooksAhead(r),n.initRecognizerEngine(e,r),n.initRecoverable(r),n.initTreeBuilder(r),n.initContentAssist(),n.initGastRecorder(r),n.initPerformanceTracer(r),Ke(r,"ignoredIssues"))throw new Error(`The <ignoredIssues> IParserConfig property has been deprecated.
	Please use the <IGNORE_AMBIGUITIES> flag on the relevant DSL method instead.
	See: https://chevrotain.io/docs/guide/resolving_grammar_errors.html#IGNORING_AMBIGUITIES
	For further details.`);this.skipValidations=Ke(r,"skipValidations")?r.skipValidations:Oi.skipValidations}};tp.DEFER_DEFINITION_ERRORS_HANDLING=!1,hP(tp,[D$,H$,tP,rP,iP,nP,sP,oP,cP,uP]);class fP extends tp{constructor(e,r=Oi){const n=wr(r);n.outputCst=!0,super(e,n)}}function dP(t){const e=new pP,r=Yt(t);return $e(r,n=>e.visitRule(n))}class pP extends Ms{visitRule(e){const r=this.visitEach(e.definition),n=p1(r,s=>s.propertyName),i=$e(n,(s,o)=>{const a=!Ud(s,l=>!l.canBeNull);let c=s[0].type;return s.length>1&&(c=$e(s,l=>l.type)),{name:o,type:c,optional:a}});return{name:e.name,properties:i}}visitAlternative(e){return this.visitEachAndOverrideWith(e.definition,{canBeNull:!0})}visitOption(e){return this.visitEachAndOverrideWith(e.definition,{canBeNull:!0})}visitRepetition(e){return this.visitEachAndOverrideWith(e.definition,{canBeNull:!0})}visitRepetitionMandatory(e){return this.visitEach(e.definition)}visitRepetitionMandatoryWithSeparator(e){return this.visitEach(e.definition).concat({propertyName:e.separator.name,canBeNull:!0,type:fu(e.separator)})}visitRepetitionWithSeparator(e){return this.visitEachAndOverrideWith(e.definition,{canBeNull:!0}).concat({propertyName:e.separator.name,canBeNull:!0,type:fu(e.separator)})}visitAlternation(e){return this.visitEachAndOverrideWith(e.definition,{canBeNull:!0})}visitTerminal(e){return[{propertyName:e.label||e.terminalType.name,canBeNull:!1,type:fu(e)}]}visitNonTerminal(e){return[{propertyName:e.label||e.nonTerminalName,canBeNull:!1,type:fu(e)}]}visitEachAndOverrideWith(e,r){return $e(this.visitEach(e),n=>Wr({},n,r))}visitEach(e){return sn($e(e,r=>this.visit(r)))}}function fu(t){return t instanceof Kr?{kind:"rule",name:t.referencedRule.name}:{kind:"token"}}function mP(t,e){let r=[];return r=r.concat('import type { CstNode, ICstVisitor, IToken } from "chevrotain";'),r=r.concat(sn($e(t,n=>gP(n)))),e.includeVisitorInterface&&(r=r.concat(wP(e.visitorInterfaceName,t))),r.join(`

`)+`
`}function gP(t){const e=yP(t),r=_P(t);return[e,r]}function yP(t){const e=kw(t.name),r=rp(t.name);return`export interface ${e} extends CstNode {
  name: "${t.name}";
  children: ${r};
}`}function _P(t){return`export type ${rp(t.name)} = {
  ${$e(t.properties,r=>bP(r)).join(`
  `)}
};`}function bP(t){const e=vP(t.type);return`${t.name}${t.optional?"?":""}: ${e}[];`}function wP(t,e){return`export interface ${t}<IN, OUT> extends ICstVisitor<IN, OUT> {
  ${$e(e,r=>kP(r)).join(`
  `)}
}`}function kP(t){const e=rp(t.name);return`${t.name}(children: ${e}, param?: IN): OUT;`}function vP(t){if(lt(t)){const e=jl($e(t,n=>ww(n)));return"("+Gr(e,(n,i)=>n+" | "+i)+")"}else return ww(t)}function ww(t){return t.kind==="token"?"IToken":kw(t.name)}function kw(t){return Ub(t)+"CstNode"}function rp(t){return Ub(t)+"CstChildren"}const xP={includeVisitorInterface:!0,visitorInterfaceName:"ICstNodeVisitor"};function EP(t,e){const r=Object.assign(Object.assign({},xP),e),n=dP(t);return mP(n,r)}const ec=zf(32,126).map(t=>String.fromCharCode(t));function tt(t){return on({...t,name:`token_${t.name}`})}function fe(t){return tt({name:t,pattern:new RegExp(t.toLowerCase(),"i"),longer_alt:Ht})}const du=tt({name:"newline",line_breaks:!0,start_chars_hint:[`
`,"\r"],pattern:/\n|\r\n?/}),AP=tt({name:"whitespace",pattern:/ +/,group:ur.SKIPPED}),TP=tt({name:"whitespace",pattern:/\s+/,line_breaks:!0,group:ur.SKIPPED}),np=tt({name:"stat",pattern:/@.*/,start_chars_hint:["@"]}),Po=tt({name:"command",pattern:/#/,start_chars_hint:["#"]});let vw=!1;const SP="@#/?':!",RP=/^(by|at|away|toward|find|flee|to|cw|ccw|opp|rndp)/i;function OP(t,e){if(!vw)return null;let r=e;const n=t[r-1]??"";if(r>0&&n!==" "&&n!==`
`)return null;if(t[r]===" "){for(;t[r]===" ";)r++;if(SP.includes(t[r]))return null}for(;r>0&&`$"@#':!/?
`.includes(t[r])===!1;)r--;switch(t[r]){case"?":case"/":{const o=t.substring(r+1,e+1).toLowerCase();if(o.indexOf(" ")<1||RP.test(o))return null;break}case"#":return null;case'"':{for(r--;r>0&&t[r]===" ";)r--;if(!(r<1||t[r]===`
`))return null;break}case"@":case"'":case":":case"!":return null}let i=e;for(t[i]==='"'&&++i;i<t.length&&t[i]!==`
`;)i++;const s=t.substring(e,i);return s.trim().length===0||s.toLowerCase()==="do"?null:[s]}const xw=tt({name:"text",pattern:OP,line_breaks:!1,start_chars_hint:ec}),Ew=tt({name:"comment",pattern:/'.*/,start_chars_hint:["'"]}),ip=tt({name:"label",pattern:/:[^;:\n]*/,start_chars_hint:[":"]}),Aw=tt({name:"hyperlink",pattern:/![^;\n]*/,start_chars_hint:["!"]}),Tw=tt({name:"hyperlinktext",pattern:/;[^;\n]*/,start_chars_hint:[";"]}),Ht=tt({name:"stringliteral",pattern:/[^-0-9"!:;@#/?()\s]+[^-"!:;@#/?()\s]*/,start_chars_hint:ec}),pu=tt({name:"stringliteraldouble",pattern:/"(?:[^\\"]|\\(?:[^\n\r]|u[0-9a-fA-F]{4}))*"/}),sp=tt({name:"numberliteral",pattern:/-?(\d*\.)?\d+([eE][+-]?\d+)?[jJ]?[lL]?/}),Sw=fe("isterrain"),Rw=fe("isobject"),Ow=fe("issolid"),Iw=fe("iswalk"),Nw=fe("isswim"),Cw=fe("isbullet"),Lw=fe("isghost"),Mw=fe("iswalking"),Uw=fe("iswalkable"),$w=fe("isswimming"),Pw=fe("isswimmable"),Bw=fe("black"),Fw=fe("dkblue"),Dw=fe("dkgreen"),jw=fe("dkcyan"),zw=fe("dkred"),Ww=fe("dkpurple"),Hw=fe("dkyellow"),Gw=fe("ltgray"),Kw=fe("dkgray"),qw=fe("blue"),Yw=fe("green"),Vw=fe("cyan"),Xw=fe("red"),Zw=fe("purple"),Jw=fe("yellow"),Qw=fe("white"),ek=fe("brown"),tk=fe("dkwhite"),rk=fe("ltgrey"),nk=fe("gray"),ik=fe("grey"),sk=fe("dkgrey"),ok=fe("ltblack"),ak=fe("onblack"),ck=fe("ondkblue"),lk=fe("ondkgreen"),uk=fe("ondkcyan"),hk=fe("ondkred"),fk=fe("ondkpurple"),dk=fe("ondkyellow"),pk=fe("onltgray"),mk=fe("ondkgray"),gk=fe("onblue"),yk=fe("ongreen"),_k=fe("oncyan"),bk=fe("onred"),wk=fe("onpurple"),kk=fe("onyellow"),vk=fe("onwhite"),xk=fe("onbrown"),Ek=fe("ondkwhite"),Ak=fe("onltgrey"),Tk=fe("ongray"),Sk=fe("ongrey"),Rk=fe("ondkgrey"),Ok=fe("onltblack"),Ik=fe("onclear"),Nk=fe("blblack"),Ck=fe("bldkblue"),Lk=fe("bldkgreen"),Mk=fe("bldkcyan"),Uk=fe("bldkred"),$k=fe("bldkpurple"),Pk=fe("bldkyellow"),Bk=fe("blltgray"),Fk=fe("bldkgray"),Dk=fe("blblue"),jk=fe("blgreen"),zk=fe("blcyan"),Wk=fe("blred"),Hk=fe("blpurple"),Gk=fe("blyellow"),Kk=fe("blwhite"),qk=fe("blbrown"),Yk=fe("bldkwhite"),Vk=fe("blltgrey"),Xk=fe("blgray"),Zk=fe("blgrey"),Jk=fe("bldkgrey"),Qk=fe("blltblack"),ev=fe("idle"),tv=fe("up"),rv=fe("down"),nv=fe("left"),iv=fe("right"),sv=fe("by"),ov=fe("at"),av=fe("flow"),cv=fe("seek"),lv=fe("rndns"),uv=fe("rndne"),hv=fe("rnd"),fv=fe("cw"),dv=fe("ccw"),pv=fe("opp"),mv=fe("rndp"),gv=fe("away"),yv=fe("toward"),_v=fe("find"),bv=fe("flee"),wv=fe("to"),kv=fe("i"),vv=fe("u"),xv=fe("north"),Ev=fe("n"),Av=fe("d"),Tv=fe("south"),Sv=fe("s"),Rv=fe("l"),Ov=fe("west"),Iv=fe("w"),Nv=fe("r"),Cv=fe("east"),Lv=fe("e"),Mv=fe("over"),Uv=fe("under"),$v=fe("within"),Pv=fe("awayby"),Bv=tt({name:"expr_aligned",pattern:/aligned|alligned/i,longer_alt:Ht}),Fv=fe("contact"),Dv=fe("blocked"),jv=fe("any"),zv=fe("countof"),Wv=fe("abs"),Hv=fe("intceil"),Gv=fe("intfloor"),Kv=fe("intround"),qv=fe("clamp"),Yv=fe("min"),Vv=fe("max"),Xv=fe("pick"),Zv=fe("pickwith"),Jv=fe("random"),Qv=fe("randomwith"),ex=fe("run"),tx=fe("runwith"),rx=tt({name:"stop",pattern:/\|/,start_chars_hint:["|"]}),nx=tt({name:"iseq",pattern:/=|is|eq|equal/i,longer_alt:Ht}),ix=tt({name:"isnoteq",pattern:/!=|not ?eq|not ?equal/i,longer_alt:Ht}),sx=tt({name:"islessthan",pattern:/<|below/i,longer_alt:Ht}),ox=tt({name:"isgreaterthan",pattern:/>|above/i,longer_alt:Ht}),ax=tt({name:"islessthanorequal",pattern:/<=|below ?or ?eq|below ?or ?equal/i,longer_alt:Ht}),cx=tt({name:"isgreaterthanorequal",pattern:/>=|above ?or ?eq|above ?or ?equal/i,longer_alt:Ht}),op=tt({name:"or",pattern:/or/i,longer_alt:Ht}),ap=tt({name:"not",pattern:/not/i,longer_alt:Ht}),cp=tt({name:"and",pattern:/and/i,longer_alt:Ht}),lp=tt({name:"plus",pattern:/\+/}),up=tt({name:"minus",pattern:/-/}),lx=tt({name:"power",pattern:/\*\*/}),ux=tt({name:"multiply",pattern:/\*/}),hp=tt({name:"divide",pattern:/\//}),hx=tt({name:"moddivide",pattern:/%/}),fx=tt({name:"floordivide",pattern:/%%/}),dx=tt({name:"query",pattern:/\?/}),px=tt({name:"lparen",pattern:/\(/,push_mode:"ignore_newlines"}),mx=tt({name:"rparen",pattern:/\)/,pop_mode:!0}),gx=tt({name:"command_play",pattern:/(play|bgplay|bgplayon64n|bgplayon32n|bgplayon16n|bgplayon8n|bgplayon4n|bgplayon2n|bgplayon1n) .*/i,start_chars_hint:ec,longer_alt:Ht}),yx=tt({name:"command_toast",pattern:/toast .*/i,start_chars_hint:ec,longer_alt:Ht}),_x=tt({name:"command_ticker",pattern:/ticker .*/i,start_chars_hint:ec,longer_alt:Ht}),fp=tt({name:"if",pattern:/if|try|take|give|duplicate/i,longer_alt:Ht}),mu=tt({name:"do",pattern:new RegExp("(?<!(zap |send |restore ))(?<=\\s)do","i"),start_chars_hint:["d"],longer_alt:Ht}),dp=fe("done"),pp=fe("else"),bx=fe("while"),wx=fe("repeat"),kx=fe("waitfor"),vx=tt({name:"foreach",pattern:/foreach|for/i,longer_alt:Ht}),xx=fe("break"),Ex=fe("continue");function Ax(t,e){return[...t,rv,...e,sp,Sw,Rw,Ow,Uw,Mw,Iw,Pw,$w,Nw,Cw,Lw,Bw,Fw,Dw,jw,zw,Ww,Hw,Gw,Kw,qw,Yw,Vw,Xw,Zw,Jw,Qw,ek,tk,rk,nk,ik,sk,ok,ak,ck,lk,uk,hk,fk,dk,pk,mk,gk,yk,_k,bk,wk,kk,vk,xk,Ek,Ak,Tk,Sk,Rk,Ok,Ik,Nk,Ck,Lk,Mk,Uk,$k,Pk,Bk,Fk,Dk,jk,zk,Wk,Hk,Gk,Kk,qk,Yk,Vk,Xk,Zk,Jk,Qk,ev,tv,nv,iv,sv,ov,av,cv,mv,lv,uv,hv,fv,dv,pv,$v,Pv,gv,yv,_v,bv,wv,xv,Tv,Ov,Cv,Mv,Uv,Bv,Fv,Dv,jv,zv,Wv,Hv,Gv,Kv,qv,Yv,Vv,Zv,Xv,Qv,Jv,tx,ex,rx,nx,ix,ax,sx,cx,ox,op,ap,cp,lp,up,lx,ux,hp,fx,hx,dx,px,mx,kv,vv,Ev,Av,Sv,Rv,Iv,Nv,Lv,pu,Ht]}const Tx=Ax([xw,np,gx,yx,_x,Po,Ew,ip,Aw,Tw,du,AP],[xx,Ex,dp,mu,pp,vx,fp,wx,kx,bx]),IP=new ur({defaultMode:"use_newlines",modes:{use_newlines:Tx,ignore_newlines:Ax([TP],[])}},{skipValidations:!ei,ensureOptimizations:ei,positionTracking:"full"});function Sx(t){vw=!0;const e=IP.tokenize(t||` 
`),[r]=(ut(e.tokens)?e.tokens:[]).slice(-1);return r&&r.tokenType.name!=="Newline"&&e.tokens.push(tu(du,`
`,r.startOffset,r.endOffset??NaN,r.startLine??NaN,r.endLine??NaN,r.startColumn??NaN,r.endColumn??NaN)),e}function NP(t,e,r=!0){if(r){const[n,...i]=e;switch(Fe(n??"")){default:return{type:Pe.OBJECT,values:e};case"loader":return{type:Pe.LOADER,values:i};case"board":return{type:Pe.BOARD,values:i};case"object":return{type:Pe.OBJECT,values:i};case"terrain":return{type:Pe.TERRAIN,values:i};case"charset":return{type:Pe.CHARSET,values:i};case"palette":return{type:Pe.PALETTE,values:i}}}else{const[n,i,...s]=e,o=Fe(i??""),a=[n,t,...s];switch(o){default:return{type:Pe.CONST,values:e};case"rn":case"range":return{type:Pe.RANGE,values:a};case"sl":case"select":return{type:Pe.SELECT,values:a};case"nm":case"number":return{type:Pe.NUMBER,values:a};case"tx":case"text":return{type:Pe.TEXT,values:a};case"hk":case"hotkey":return{type:Pe.HOTKEY,values:a};case"copyit":return{type:Pe.COPYIT,values:a};case"openit":return{type:Pe.OPENIT,values:a};case"zssedit":return{type:Pe.ZSSEDIT,values:a};case"charedit":return{type:Pe.CHAREDIT,values:a};case"coloredit":return{type:Pe.COLOREDIT,values:a}}}}function an(t){switch(t){case Pe.LOADER:return"loader";case Pe.BOARD:return"board";case Pe.OBJECT:return"object";case Pe.TERRAIN:return"terrain";case Pe.CHARSET:return"charset";case Pe.PALETTE:return"palette";case Pe.CONST:return"const";case Pe.RANGE:return"range";case Pe.SELECT:return"select";case Pe.NUMBER:return"number";case Pe.TEXT:return"text";case Pe.HOTKEY:return"hotkey";case Pe.COPYIT:return"copyit";case Pe.OPENIT:return"openit";case Pe.VIEWIT:return"viewit";case Pe.ZSSEDIT:return"zssedit";case Pe.CHAREDIT:return"charedit";case Pe.COLOREDIT:return"coloredit"}}var mp=(t=>(t[t.width=0]="width",t[t.height=1]="height",t[t.bits=2]="bits",t))(mp||{});function Rx(t){return Oo(t,mp,{bits:e=>Array.from(e)})}function Ox(t){return Ca(t,mp,{bits:e=>new Uint8Array(e)})}function Bo(t,e){return{id:Bt(),code:t,...e}}var gp=(t=>(t[t.id=0]="id",t[t.code=1]="code",t[t.board=2]="board",t[t.object=3]="object",t[t.terrain=4]="terrain",t[t.charset=5]="charset",t[t.palette=6]="palette",t[t.eighttrack=7]="eighttrack",t))(gp||{});function CP(t){return Oo(t,gp,{board:Y7,object:xl,terrain:xl,charset:Rx,palette:Rx,stats:It})}function LP(t){return Ca(t,gp,{board:V7,object:El,terrain:El,charset:Ox,palette:Ox})}function tc(t){const e={...Bs(t)};return Object.keys(e).forEach(r=>{switch(r){case"type":case"name":delete e[r];break}}),e}function MP(t){return w(t)?(t.stats=void 0,Bs(t)):{}}function gu(t){const e=Sx(t),r={};let n=!0;for(let i=0;i<e.tokens.length;++i){const s=e.tokens[i];if(s.tokenType===np){const o=s.image.slice(1),[a,c]=o.split(";").map(f=>f.trim()),l=a.split(" "),u=NP(ye(c)?c:"",l,n),h=u.values.join(" ");switch(n=!1,u.type){case Pe.LOADER:r.type=Re.LOADER,r.name=h;break;case Pe.BOARD:r.type=Re.BOARD,r.name=h;break;case Pe.OBJECT:r.type=Re.OBJECT,r.name=h||"object";break;case Pe.TERRAIN:r.type=Re.TERRAIN,r.name=h;break;case Pe.CHARSET:r.type=Re.CHARSET,r.name=h;break;case Pe.PALETTE:r.type=Re.PALETTE,r.name=h;break;case Pe.CONST:{const[f,...d]=u.values;if(ye(f)){const m=Fe(f),p=d.join(" ");if(ye(p)){const g=parseFloat(p);r[m]=Ae(g)?g:p}else r[m]=1}break}case Pe.RANGE:case Pe.SELECT:case Pe.NUMBER:case Pe.TEXT:case Pe.HOTKEY:case Pe.ZSSEDIT:case Pe.CHAREDIT:case Pe.COLOREDIT:{const[f,...d]=u.values;if(ye(f)){const m=Fe(f);r[m]=[an(u.type),...d]}break}}}}return r}function Bs(t){return w(t)?(w(t.stats?.type)||(t.stats=gu(t.code),w(t.stats.type)||(t.stats.type=Re.OBJECT)),t.stats):{}}function Ix(t){switch(t){default:case Re.ERROR:return"error";case Re.LOADER:return an(Pe.LOADER);case Re.BOARD:return an(Pe.BOARD);case Re.OBJECT:return an(Pe.OBJECT);case Re.TERRAIN:return an(Pe.TERRAIN);case Re.CHARSET:return an(Pe.CHARSET);case Re.PALETTE:return an(Pe.PALETTE)}}function hi(t){return Bs(t).type??Re.ERROR}function Ii(t){return Ix(hi(t))}function mt(t){return Bs(t).name??""}function UP(t,e){return Bs(t)[e]}const yu=new cl;function $P(t){if(!ye(t))return;const e=Ta(t);if(w(e)&&w(Je[e]))return Je[e];const r=Fe(t),n=ve[r];if(w(n))return n}function _u(t,e){const r=Object.keys(t);for(let n=0;n<r.length;++n){const i=r[n],s=t[i];if(ut(s)){const[o,...a]=s;switch(o){case"text":w(e[i])||(e[i]="");break;case"range":w(e[i])||(e[i]=4);break;case"number":w(e[i])||(e[i]=0);break;case"select":if(!w(e[i])){const[,c]=a;e[i]=c}break}continue}switch(i){case"name":case"char":case"light":case"group":case"p1":case"p2":case"p3":case"p4":case"p5":case"p6":case"p7":case"p8":case"p9":case"p10":case"cycle":case"stepx":case"stepy":case"shootx":case"shooty":case"displaychar":e[i]=s;break;case"color":case"bg":case"lightdir":case"displaycolor":case"displaybg":e[i]=$P(s)??s;break;case"isitem":e.item=1;break;case"notitem":e.item=0;break;case"ispushable":e.pushable=s===""?1:s;break;case"notpushable":e.pushable=0;break;case"iswalk":case"iswalking":case"iswalkable":e.collision=We.ISWALK;break;case"isswim":case"isswimming":case"isswimable":e.collision=We.ISSWIM;break;case"issolid":e.collision=We.ISSOLID;break;case"isbullet":e.collision=We.ISBULLET;break;case"isghost":e.collision=We.ISGHOST;break;case"isbreakable":e.breakable=1;break;case"notbreakable":e.breakable=0;break}}}function At(t){if(w(t))switch(hi(t)){default:return;case Re.ERROR:return t.code??"";case Re.LOADER:return t.code??"";case Re.BOARD:{w(t.board)||(t.board=Zu()),t.board.id=t.id;const e=tc(t);return w(e.isdark)&&(t.board.isdark=1),w(e.notdark)&&(t.board.isdark=0),Ae(e.startx)&&(t.board.startx=e.startx),Ae(e.starty)&&(t.board.starty=e.starty),ye(e.over)&&(Fe(e.over)==="empty"?t.board.over=void 0:t.board.over=e.over,t.board.overboard=void 0),ye(e.under)&&(Fe(e.under)==="empty"?t.board.under=void 0:t.board.under=e.under,t.board.underboard=void 0),ye(e.camera)&&(Fe(e.camera)==="empty"?t.board.camera=void 0:t.board.camera=e.camera),ye(e.graphics)&&(Fe(e.graphics)==="empty"?t.board.graphics=void 0:t.board.graphics=e.graphics),Ae(e.facing)&&(t.board.facing=e.facing),ye(e.facing)&&Fe(e.facing)==="empty"&&(t.board.facing=void 0),ye(e.exitnorth)&&(t.board.exitnorth=e.exitnorth),ye(e.exitsouth)&&(t.board.exitsouth=e.exitsouth),ye(e.exitwest)&&(t.board.exitwest=e.exitwest),ye(e.exiteast)&&(t.board.exiteast=e.exiteast),Ae(e.timelimit)&&(t.board.timelimit=e.timelimit),w(e.restartonzap)&&(t.board.restartonzap=1),w(e.norestartonzap)&&(t.board.restartonzap=0),Ae(e.maxplayershots)&&(t.board.maxplayershots=e.maxplayershots),t.board}case Re.OBJECT:return w(t.object)||(t.object=Z_()),t.object.id=t.id,t.object.code=t.code,t.object.name=mt(t),t.object.category=Fr.ISOBJECT,_u(tc(t),t.object),t.object;case Re.TERRAIN:return w(t.terrain)||(t.terrain=Z_()),t.terrain.id=t.id,t.terrain.name=mt(t),t.terrain.category=Fr.ISTERRAIN,_u(tc(t),t.terrain),t.terrain;case Re.PALETTE:{if(w(t.palette)||(t.palette=od(Q_)),w(t.palette?.bits)){const e=tc(t),r=Br(e);for(let n=0;n<r.length;++n){const i=r[n].toLowerCase(),s=e[i];if(i.startsWith("color")&&ye(s)){const o=parseFloat(i.replace("color",""));if(o>=0&&o<=15){yu.set(s);const a=o*Sa,c=yu.r*63,l=yu.g*63,u=yu.b*63;t.palette.bits[a+0]=jt(c,0,63),t.palette.bits[a+1]=jt(l,0,63),t.palette.bits[a+2]=jt(u,0,63)}}}}return t.palette}case Re.CHARSET:return w(t.charset)||(t.charset=ad(tL)),t.charset}}function yp(t){return{id:Bt(),name:JS(),timestamp:0,activelist:[],pages:t,flags:{}}}var _p=(t=>(t[t.id=0]="id",t[t.name=1]="name",t[t.timestamp=2]="timestamp",t[t.activelist=3]="activelist",t[t.pages=4]="pages",t[t.flags=5]="flags",t[t.token=6]="token",t))(_p||{});function PP(t){return Oo(t,_p,{pages:e=>e.map(CP),flags:e=>{const r=Object.keys(e);for(let n=0;n<r.length;++n){const i=r[n];Object.keys(e[i]).length===0&&delete e[i]}return e}})}function bp(t){return Ca(t,_p,{pages:e=>e.map(LP)})}function Nx(t){w(t)&&(t.token=`${QS()}${rn(1111,9999)}`)}function Fs(t,e){if(!w(t))return;const r=Fe(e);return t.pages.find(i=>i.id===e||r===mt(i))}function Nr(t,e,r){if(!w(t))return;const n=Fe(r);return t.pages.find(s=>hi(s)===e&&(s.id===r||n===mt(s)))}function wp(t,e,r){let n=Nr(t,e,r);if(!w(n)){const i=Ix(e);return n=Bo(i==="object"?`@${r||"object"}
`:`@${i} ${r}
`,{}),js(t,n),[n,!0]}return[n,!1]}function Ds(t,e){return w(t)?t.pages.filter(r=>hi(r)===e):[]}function kp(t,e,r){if(!w(t))return[];const n=Fe(r);return t.pages.filter(s=>hi(s)===e).filter(s=>{const o=Bs(s),a=Fe(mt(s));return s.id===r||n===a||w(o[r])})}function rc(t){return w(t)?Sn(t.pages).sort((r,n)=>{const i=hi(r),s=hi(n);return i===s?mt(r).localeCompare(mt(n)):s-i}):[]}function Cx(t,e){if(w(e)){const r=Nr(t,Re.TERRAIN,e.kind??"");if(w(r))return r;const n=Nr(t,Re.OBJECT,e.kind??"");if(w(n))return n}}function js(t,e){if(!w(t)||!w(e))return!1;const r=Fs(t,e.id);return w(r)?!1:(t.pages.push(e),Nx(t),!0)}function Lx(t,e){const r=Fs(t,e);if(w(t)&&w(r)){const n=Fe(e);return t.pages=t.pages.filter(i=>i.id!==e&&n!==mt(i)),Nx(t),r}}function Vt(t,e=1,r=Je.WHITE,n=Je.BLACK){const i=t?.kinddata;return{name:Fe(t?.name??i?.name),char:t?.displaychar??i?.displaychar??t?.char??i?.char??e,color:t?.displaycolor??i?.displaycolor??t?.color??i?.color??r,bg:t?.displaybg??i?.displaybg??t?.bg??i?.bg??n,light:t?.light??i?.light??0}}function BP(t,e){return!!t?.flags[e]}function Ni(t,e){return t?(t.flags[e]=t.flags[e]??{},t.flags[e]):{}}function Mx(t,e){t&&delete t.flags[e]}function bu(t,e,r){return Ni(t,e)?.[r]}function nc(t,e,r,n){const i=Ni(t,e);return i&&(i[r]=n),n}function hr(t){if(!w(t)||w(t.lookup)&&w(t.named))return;const e=new Array(Ue*nt).fill(void 0),r={},n=Object.values(t.objects);for(let o=0;o<n.length;++o){const a=n[o];if(w(a.x)&&w(a.y)&&w(a.id)&&!w(a.removed)&&He(a,"collision")!==We.ISGHOST){a.category=Fr.ISOBJECT,e[a.x+a.y*Ue]=a.id,ye(a.code)&&!w(a.name)&&_u(gu(a.code),a);const c=Vt(a);r[c.name]||(r[c.name]=new Set),r[c.name].add(a.id)}}let i=0,s=0;for(let o=0;o<t.terrain.length;++o){const a=t.terrain[o];if(w(a)){a.x=i,a.y=s,a.category=Fr.ISTERRAIN;const c=Vt(xn(a));r[c.name]||(r[c.name]=new Set),r[c.name].add(o)}++i,i>=Ue&&(i=0,++s)}t.lookup=e,t.named=r}function ic(t){w(t)&&(delete t.named,delete t.lookup,hr(t))}function vp(t,e,r){if(!w(t)||!w(t.named)||!w(e))return;const n=Fe(e.name??e.kinddata?.name??"");t.named[n]||(t.named[n]=new Set),t.named[n].add(e?.id??r??"")}function Ux(t,e){if(!(!w(t)||!w(t.lookup)||!w(e?.id))&&!w(e.removed)&&He(e,"collision")!==We.ISGHOST){const r=e.x??0,n=e.y??0;t.lookup[r+n*Ue]=e.id}}function FP(t,e){if(w(t)&&w(e?.x)&&w(e.y)){const r=Vt(e),n=$i(t,e);w(t.named?.[r.name])&&t.named[r.name].delete(n)}}function wu(t,e){if(w(t)&&w(e?.id)){if(w(t.lookup)&&w(e.x)&&w(e.y)){const n=e.x+e.y*Ue;t.lookup[n]===e.id&&(t.lookup[n]=void 0)}const r=Vt(e);w(t.named?.[r.name])&&w(e.id)&&t.named[r.name].delete(e.id)}}function ku(t,e,r,n=!1){if(!w(t)||!w(t.lookup)||r.x<0||r.x>=Ue||r.y<0||r.y>=nt)return;const i=r.x+r.y*Ue,s=mr(t,t.lookup[i]??"404");if(w(s))return n&&sr(s.id)?void 0:s;const o=t.terrain[i];if(w(o)&&pc(e,He(o,"collision")))return o}function DP(t,e,r){const n=mr(t,e?.id??""),i=n?.x??-1,s=n?.y??-1;if(i-r.x===0&&s-r.y===0)return!0;const o=He(n,"collision");return w(ku(t,o,r))}function xp(t,e,r){const n=mr(t,e?.id??"");if(!w(t)||!w(n)||!w(n.x)||!w(n.y)||!w(t.lookup)||r.x<0||r.x>=Ue||r.y<0||r.y>=nt)return{name:"edge",kind:"edge",collision:We.ISSOLID,x:r.x,y:r.y};if(n.x-r.x===0&&n.y-r.y===0)return;const i=$i(t,n),s=$i(t,r),o=He(n,"collision");if(o===We.ISGHOST)return;const a=sr(n?.id),c=mr(t,t.lookup[s]??"");if(He(c,"collision")===We.ISGHOST)return;const l=sr(c?.id??"");if(w(c)&&(!a||!l))return{...c};const u=t.terrain[s],h=u?.collision??u?.kinddata?.collision??We.ISWALK;if(pc(o,h))return{...u,x:r.x,y:r.y};n.x=r.x,n.y=r.y,w(n.removed)||(t.lookup[i]=void 0,t.lookup[s]=n.id??"")}function jP(t,e){const r=[];if(!w(t))return r;const n=Object.values(t.objects);for(let i=0;i<n.length;++i){const s=n[i];w(s.id)&&w(s.removed)&&e-s.removed>Ic*5&&(r.push(s.id),xT(t,s.id))}return r}function zP(t,e){const r=[];if(!w(t))return r;t.lookup=void 0,hr(t);const n=Object.values(t.objects);for(let s=0;s<n.length;++s){const o=n[s];if(!w(o.id))continue;o.lx=o.x,o.ly=o.y;const c=`${xn(o)?.code??""}
${o.code??""}`;if(c){if(o.removed){const l=e-o.removed,u=He(o,"cycle");if(l>u)continue}r.push({id:o.id,type:Re.OBJECT,code:c,object:o,terrain:void 0})}}const i=jP(t,e);for(let s=0;s<i.length;++s)r.push({id:i[s],type:Re.ERROR,code:"",object:void 0,terrain:void 0});return r}function $x(t,e,r){const n=[],i=[];if(!w(t))return{objectelements:n,terrainelements:i};function s(a,c){switch(r){case"all":return!0;case"self":return a?.id===e;case"others":return a?.id!==e;case"terrain":return c===!0;case"object":return c===!1}const l=He(a,r);return w(l)||Vt(a).name===r||He(a,"group")===r}const o=Object.values(t.objects);for(let a=0;a<o.length;++a){const c=o[a];s(c,!1)&&n.push(c)}for(let a=0;a<Kf;++a){const c=t.terrain[a];w(c)&&s(c,!0)&&i.push(c)}return{objectelements:n,terrainelements:i}}function Px(t,e,r,n){for(let i=r.y;i<=n.y;++i)for(let s=r.x;s<=n.x;++s){const o=it(e,{x:s,y:i});Wt(o)&&gr(e,o,t.timestamp),St(e,{x:s,y:i})}}function WP(t,e,r){for(let n=e.y;n<=r.y;++n)for(let i=e.x;i<=r.x;++i)St(t,{x:i,y:n})}function Bx(t,e,r,n){for(let i=r.y;i<=n.y;++i)for(let s=r.x;s<=n.x;++s){const o=it(e,{x:s,y:i});Wt(o)&&gr(e,o,t.timestamp),St(e,{x:s,y:i})}}function zs(t,e){w(t)&&(t.name=e.name,t.char=e.char,t.color=e.color,t.bg=e.bg,t.displaychar=e.displaychar,t.displaycolor=e.displaycolor,t.displaybg=e.displaybg,t.p1=e.p1,t.p2=e.p2,t.p3=e.p3,t.p4=e.p4,t.p5=e.p5,t.p6=e.p6,t.code=e.code,t.item=e.item,t.group=e.group,t.party=e.party,t.cycle=e.cycle,t.light=e.light,t.lightdir=e.lightdir,t.stepx=e.stepx,t.stepy=e.stepy,t.shootx=e.shootx,t.shooty=e.shooty,t.pushable=e.pushable,t.collision=e.collision,t.breakable=e.breakable,t.tickertext=e.tickertext,t.tickertime=e.tickertime)}function vu(t,e,r,n,i){switch(i){case"all":case"object":case"terrain":break;default:return HP(t,e,r,"",i)}if(!w(E.book))return;const s=E.book,o=Nr(s,Re.BOARD,t),a=At(o);if(!w(a))return;const c=Nr(s,Re.BOARD,e),l=At(c);if(!w(l))return;hr(a),hr(l);let u=!1;if(w(a)&&w(l)){switch(i){case"all":Px(s,l,r,n);break;case"object":Bx(s,l,r,n);break;case"terrain":WP(l,r,n);break;default:u=!0;break}for(let h=r.y;h<=n.y;++h)for(let f=r.x;f<=n.x;++f){let d=!1,m=!1;switch(i){case"all":d=!0,m=!0;break;case"object":d=!0;break;case"terrain":m=!0;break}const p={x:f,y:h};let g,y=it(a,p);if(Wt(y)?(g=Pi(a,f,h),sr(y?.id)&&(y=void 0)):(g=y,y=void 0),w(g)&&(m||u&&He(g,"group")===i)){u&&Px(s,l,p,p);const _=un(l,[g.kind??""],p);zs(_,g)}if(w(y)&&(d||u&&He(y,"group")===i)){u&&Bx(s,l,p,p);const _=un(l,[y.kind??""],p);zs(_,y)}}ic(l)}}function HP(t,e,r,n,i){if(!w(E.book))return;const s=E.book,o=Nr(s,Re.BOARD,t),a=At(o);if(!w(a))return;const c=Nr(s,Re.BOARD,e),l=At(c);if(w(l)&&(hr(a),hr(l),w(a)&&w(l))){const{terrainelements:u,objectelements:h}=$x(a,n,i);if(u.length===0&&h.length===0)return;const f={x:Ue,y:nt};for(let d=0;d<u.length;++d){const m=u[d];Ae(m.x)&&(f.x=Math.min(f.x,m.x)),Ae(m.y)&&(f.y=Math.min(f.y,m.y))}for(let d=0;d<h.length;++d){const m=h[d];Ae(m.x)&&(f.x=Math.min(f.x,m.x)),Ae(m.y)&&(f.y=Math.min(f.y,m.y))}for(let d=0;d<u.length;++d){const m=u[d],p={x:r.x+(m.x??0)-f.x,y:r.y+(m.y??0)-f.y},g=it(l,p);w(g)&&(Wt(g)&&gr(l,g,s.timestamp),St(l,p));const y=un(l,[m.kind??""],p);zs(y,m)}for(let d=0;d<h.length;++d){const m=h[d],p={x:r.x+(m.x??0)-f.x,y:r.y+(m.y??0)-f.y},g=un(l,[m.kind??""],p);zs(g,m)}ic(l)}}function Pt(t){return`${t??""}`}function sc(t,e){const r=parseFloat(Pt(t));return isNaN(r)?e:r}function GP(t,e){return t?.activelist.includes(e)??!1}function xu(t,e,r){if(!w(t))return;nc(t,e,"board",r);const n=pr(r);w(n)?t.activelist.includes(e)||t.activelist.push(e):t.activelist=t.activelist.filter(i=>i!==e)}function Fo(t,e,r,n,i=!1){const s=Kt(e);if(!w(t)||!w(s))return;const o=mr(s,e);if(!Wt(o)||!o?.id)return;const a=pr(r);if(!w(a))return;hr(a);const c=ku(a,We.ISWALK,n,!0);if(i===!1&&w(c))if(He(c,"item"))qt(e,o,c,"touch");else return;wu(s,o),delete s.objects[o.id],o.x=n.x,o.y=n.y,a.objects[o.id]=o,vp(a,o),Ux(a,o),nc(t,e,"enterx",n.x),nc(t,e,"entery",n.y),xu(t,e,a.id)}function KP(t){const r=(t?.activelist??[]).map(n=>{const i=bu(t,n,"board");return ye(i)?i:""});return uC(r)}function Do(t){const e=KP(t),r=new Set,n=[];for(let i=0;i<e.length;++i){const s=pr(e[i]);if(w(s)&&!r.has(s.id)){if(ye(s.over))if(ye(s.overboard)){const o=pr(s.overboard);w(o)?r.has(o.id)||n.push(o):delete s.overboard}else{const o=pr(s.over);w(o)&&(s.overboard=o.id)}else ye(s.overboard)&&delete s.overboard;if(n.push(s),ye(s.under))if(ye(s.underboard)){const o=pr(s.underboard);w(o)||delete s.underboard}else{const o=pr(s.under);w(o)&&(s.underboard=o.id)}else ye(s.underboard)&&delete s.underboard}}return n}const qP=zf(32,126).map(t=>String.fromCharCode(t)),YP=on({name:"Whitespace",pattern:/ +/}),VP=on({name:"WhitespaceSkipped",pattern:/ +/,group:ur.SKIPPED}),Ep=on({name:"Newline",line_breaks:!0,start_chars_hint:[`
`,"\r"],pattern:/\n|\r\n?/}),Fx=on({name:"StringLiteral",pattern:/[^ $;\r\n]+/,start_chars_hint:qP}),Ap=on({name:"StringLiteralDouble",pattern:/"(?:[^\\"]|\\(?:[^\n\r]|u[0-9a-fA-F]{4}))*"/}),Tp=on({name:"EscapedDollar",pattern:"$$"}),Sp=on({name:"MaybeFlag",pattern:/\$[^-0-9"!;@#/?\s]+[^-"!;@#/?\s]*/}),Rp=on({name:"NumberLiteral",pattern:/\$-?(\d*\.)?\d+([eE][+-]?\d+)?[jJ]?[lL]?\+?/}),Dx=on({name:"HyperLinkText",pattern:/;[^;\r\n]*/,start_chars_hint:[";"]});function XP(t,e=""){return on({name:e||t,pattern:new RegExp(t.toLowerCase(),"i")})}const jx=Object.keys(Aa).map(t=>XP(`\\$(${t})`,t)),ZP=[YP,Ep,...jx,Ap,Fx,Rp,Tp,Dx,Sp],JP=new ur(ZP,{skipValidations:!ei,ensureOptimizations:ei}),QP=new ur([VP,Ep,...jx,Ap,Fx,Rp,Tp,Dx,Sp],{skipValidations:!ei,ensureOptimizations:ei}),zx=/\$CENTER/i;function eB(t){if(zx.test(t))return t.replace(zx,"")}function Op(t,e=!1){return e?QP.tokenize(t):JP.tokenize(t)}function Wx(t,e,r,n,i,s,o,a){return{disablewrap:!1,measureonly:!1,measuredwidth:0,writefullwidth:void 0,x:0,y:0,iseven:!0,active:{color:r,bg:n,topedge:i,leftedge:s,rightedge:o,bottomedge:a},reset:{color:r,bg:n,topedge:i,leftedge:s,rightedge:o,bottomedge:a},width:t,height:e,char:[],color:[],bg:[],changed(){}}}function tB(t){t.active={...t.reset}}function Hx(t,e){const r=e.y;function n(){++e.x;const a=e.active.rightedge??e.width-1;!e.disablewrap&&e.x>a&&(e.x=e.active.leftedge??0,++e.y),e.x>e.measuredwidth&&(e.measuredwidth=e.x)}function i(){return e.x>=(e.active.leftedge??0)&&e.x<=(e.active.rightedge??e.width-1)&&e.y>=(e.active.topedge??0)&&e.y<=(e.active.bottomedge??e.height-1)}function s(a){for(let c=0;c<a.length;++c){if(e.measureonly!==!0&&i()){const l=e.x+e.y*e.width;e.char[l]=a.charCodeAt(c),e.active.color!==void 0&&(e.color[l]=e.active.color),e.active.bg!==void 0&&(e.bg[l]=e.active.bg)}n()}}for(let a=0;a<t.length;++a){const c=t[a];switch(c.tokenType){case Tp:s("$");break;case Rp:if(e.measureonly!==!0&&i()){const l=e.x+e.y*e.width;e.char[l]=parseFloat(c.image.replace("$","")),e.active.color!==void 0&&(e.color[l]=e.active.color),e.active.bg!==void 0&&(e.bg[l]=e.active.bg)}n();break;case Ap:s(c.image.substring(1,c.image.length-1).replaceAll('\\"','"'));break;case Ep:{e.x=e.active.leftedge??0,++e.y;break}default:{const l=c.tokenType.name,u=Aa[l],h=fC(Je[u]),f=Gf(Je[u]);u==="ONCLEAR"?(e.active.color=e.reset.color,e.active.bg=e.reset.bg):w(h)?e.active.color=h:w(f)?e.active.bg=f:s(c.image);break}}}e.x>e.measuredwidth&&(e.measuredwidth=e.x+1);const o=e.active.leftedge??0;if(w(e.writefullwidth)&&(e.x>o||e.y===r)){const c=(e.active.rightedge??e.width-1)-e.x;if(c>0){tB(e);const l=String.fromCharCode(e.writefullwidth).repeat(c),u=e.x+e.y*e.width;sB(u,u+l.length,e.active.color,e.active.bg,e),iB(u,l,e)}}}function rB(t,e,r){const n=Op(t);n.tokens&&(Hx(n.tokens,e),e.changed())}function nB(t,e,r){const n=Op(t);if(!n.tokens)return;const i=Wx(e,r,Je.WHITE,Je.BLACK);return i.measureonly=!0,Hx(n.tokens,i),i.x>0&&++i.y,i}function iB(t,e,r){let n=0;const i=t+e.length;for(let s=t;s<i;++s)r.char[s]=e.charCodeAt(n++);r.changed()}function sB(t,e,r,n,i){const s=Math.min(t,e),o=Math.max(t,e);for(let a=s;a<=o;++a)i.color[a]=r,i.bg[a]=n;i.changed()}function Eu(t,e,r){if(!w(E.element?.x)||!w(E.element.y))return 0;if(E.elementisplayer){const a=E.board?.maxplayershots??0;if(a>0&&Z7(E.board).filter(l=>!l.removed&&sr(l.party)&&He(l,"collision")===We.ISBULLET).length>=a)return t.set("didshoot",0),t.yield(),0}const[n,i]=ue(e,0,[V.DIR,V.MAYBE_KIND]);E.element.shootx=jt(n.destpt.x-n.startpt.x,-1,1),E.element.shooty=jt(n.destpt.y-n.startpt.y,-1,1);const s=i??["bullet"],o=N7(E.board,s,{x:E.element.x,y:E.element.y});if(w(o)){w(r)&&(o.arg=r),o.cycle=1,o.party=E.elementid,o.collision=We.ISBULLET,o.breakable=1,o.stepx=n.destpt.x-E.element.x,o.stepy=n.destpt.y-E.element.y,o.bg=Je.ONCLEAR;const a=xn(o),c=o.code??a?.code??"";fT(E.book,E.board,o,c)}return E.elementisplayer&&t.set("didshoot",w(o)?1:0),t.yield(),0}function oc(t,e,r){if(!As(E.element)||!w(E.book)||!w(E.board)||!w(E.element))return 0;const[n,i]=ue(t,0,[V.DIR,V.KIND]);if(n.targets.length){for(let f=0;f<n.targets.length;++f){const d=n.targets[f];oc(["at",d.x,d.y,...i],e,r)}return 0}const{destpt:s}=n;if(s.x<0||s.x>=Ue||s.y<0||s.y>=nt)return 0;const[o]=i,a={x:E.element?.x??0,y:E.element?.y??0},c=xn({kind:o}),l=He(c,"collision");if(l===We.ISGHOST)return un(E.board,i,n.destpt,e),0;let u=it(E.board,n.destpt);if(He(u,"pushable")){const f=Sn(n.destpt),d=Mt(f,Ln(a,f));zn(E.book,E.board,u,d),u=it(E.board,n.destpt)}if(o==="empty")return gr(E.board,u,E.timestamp),0;if(Wt(u)&&gr(E.board,u,E.timestamp),Wt(c)||un(E.board,i,n.destpt,e),Wt(c)){const f=ku(E.board,l,n.destpt);if(!w(f)){const d=un(E.board,i,n.destpt,e);w(d)&&w(r)&&(d.arg=r)}}return 0}function Au(t,e,r){if(!w(E.book)||!w(E.board))return 1;const[n,i]=ue(e,0,[V.DIR,V.DIR]),s=it(E.board,n.destpt);if(w(s)&&w(s.kind)){const o=He(s,"collision"),a=ku(E.board,o,i.destpt);if(w(a))return 1;const c=un(E.board,[s.kind],i.destpt);if(!w(c))return 1;zs(c,s),w(r)&&(c.arg=r)}else return 1;return 0}const oB={x:0,y:0},aB={x:Ue-1,y:nt-1},cB="all",lB=vi().command("build",(t,e)=>{if(!w(E.book)||!w(E.board)||!w(E.element))return 0;const[r,n]=ue(e,0,[V.NAME,V.MAYBE_STRING]),i=Zu();if(w(i)){if(ye(n)){const s=pr(n);w(s)&&vu(s.id,i.id,oB,aB,cB)}t.set(r,i.id)}return 0}).command("goto",(t,e)=>{if(!w(E.book)||!w(E.board))return 0;const[r,n]=ue(e,0,[V.STRING]),[i,s]=ue(e,n,[V.MAYBE_NUMBER,V.MAYBE_NUMBER]),o=pr(r);if(!w(o))return 0;const a={x:i??o.startx??Math.round(Ue*.5),y:s??o.starty??Math.round(nt*.5)},c=Vt(E.element);if(c.name!=="player"){const l=He(E.element,"color"),u=He(E.element,"bg"),h=To(l,u),f=Xu(o,[c.name,h]),[d]=f.sort((m,p)=>{const g=m.y??1e4,y=p.y??1e4,_=g-y;if(_!==0)return _;const A=m.x??1e4,T=p.x??1e4;return A-T});w(d)&&Ae(d.x)&&Ae(d.y)&&(a.x=d.x,a.y=d.y)}return Fo(E.book,E.elementfocus,o.id,a,!0),0}).command("transport",(t,e)=>{if(!w(E.book)||!w(E.board)||!w(E.element))return 0;const[r]=ue(e,0,[V.STRING]),n=mr(E.board,r);if(w(E.element?.x)&&w(E.element.y)&&w(n?.x)&&w(n.y)){let i=!0;const s={x:E.element.x,y:E.element.y},o=s.x-n.x,a=s.y-n.y;if(He(E.element,"shootx")!==o||He(E.element,"shooty")!==a)return 0;for(;i&&(s.x+=o,s.y+=a,!(s.x<0&&s.x>=Ue&&s.y<0&&s.y>=nt));){const c=it(E.board,s);c?.kind===E.element.kind&&He(c,"shootx")===-o&&He(c,"shooty")===-a&&zn(E.book,E.board,n,{x:s.x+o,y:s.y+a})&&(i=!1)}}return 0}).command("shove",(t,e)=>{if(!w(E.book)||!w(E.board))return 0;const[r,n]=ue(e,0,[V.DIR,V.DIR]),i=it(E.board,r.destpt);if(Wt(i)&&He(i,"pushable")){const s=r.destpt.x+(n.destpt.x-n.startpt.x),o=r.destpt.y+(n.destpt.y-n.startpt.y);zn(E.book,E.board,i,{x:s,y:o})}return 0}).command("duplicate",Au).command("duplicatewith",(t,e)=>{const[r,n]=ue(e,0,[V.ANY]);return Au(e.slice(n),r)}).command("dupe",Au).command("dupewith",(t,e)=>{const[r,n]=ue(e,0,[V.ANY]);return Au(e.slice(n),r)}).command("write",(t,e)=>{if(!w(E.book)||!w(E.board))return 0;const[r,n,i]=ue(e,0,[V.DIR,V.COLOR]),s=e.slice(i).map(Pt).join(" "),{color:o,bg:a}=v_(n),c=nB(s,256,1)?.measuredwidth??1,l=Wx(256,1,o??Je.WHITE,a??Je.BLACK);rB(s,l);const u=c-1;switch(Ln(r.startpt,r.destpt)){case ve.EAST:for(let f=0;f<c;++f)St(E.board,{x:r.destpt.x+f,y:r.destpt.y,name:"text",char:l.char[f],color:l.color[f],bg:l.bg[f]});break;case ve.WEST:for(let f=0;f<c;++f)St(E.board,{x:r.destpt.x+f-u,y:r.destpt.y,name:"text",char:l.char[f],color:l.color[f],bg:l.bg[f]});break;case ve.NORTH:for(let f=0;f<c;++f)St(E.board,{x:r.destpt.x,y:r.destpt.y+f-u,name:"text",char:l.char[f],color:l.color[f],bg:l.bg[f]});break;case ve.SOUTH:for(let f=0;f<c;++f)St(E.board,{x:r.destpt.x,y:r.destpt.y+f,name:"text",char:l.char[f],color:l.color[f],bg:l.bg[f]});break}return 0}).command("change",(t,e)=>{if(!w(E.book)||!w(E.board))return 0;const[r,n]=ue(e,0,[V.KIND,V.KIND]);(dc(r)??"")==="empty"&&G7(E.board).forEach(c=>{un(E.board,n,c)});const s=dc(n),o=Vu(n),a=mT(n);return Xu(E.board,r).forEach(c=>{if(w(o)&&(c.color=o),w(a)&&(c.bg=a),Vt(c).name!==s){const u=He(c,"color"),h=He(c,"bg");if(gr(E.board,c,E.timestamp),s!=="empty"){const f={x:c.x??0,y:c.y??0},d=un(E.board,n,f);w(d)&&(d.color=u,d.bg=h)}}}),0}).command("put",(t,e)=>oc(e)).command("putwith",(t,e)=>{const[r,n]=ue(e,0,[V.ANY]);return oc(e.slice(n),void 0,r)}).command("oneof",(t,e)=>{const[r,n]=ue(e,0,[V.ANY]);return w(E.board)&&mr(E.board,r)?0:oc(e.slice(n),r)}).command("oneofwith",(t,e)=>{const[r,n,i]=ue(e,0,[V.ANY,V.ANY]);return w(E.board)&&mr(E.board,n)?0:oc(e.slice(i),n,r)}).command("shoot",Eu).command("shootwith",(t,e)=>{const[r,n]=ue(e,0,[V.ANY]);return Eu(t,e.slice(n),r)}).command("throwstar",(t,e)=>Eu(t,[...e,"star"])).command("throwstarwith",(t,e)=>{const[r,n]=ue(e,0,[V.ANY]);return Eu(t,[...e.slice(n),"star"],r)});var Ws=(t=>(t[t.Border=-1]="Border",t[t.Data=0]="Data",t[t.Function=1]="Function",t[t.Position=2]="Position",t[t.Timing=3]="Timing",t[t.Alignment=4]="Alignment",t))(Ws||{}),uB=Object.defineProperty,hB=(t,e,r)=>e in t?uB(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Tu=(t,e,r)=>(hB(t,typeof e!="symbol"?e+"":e,r),r);const fB=[0,1],Gx=[1,0],Kx=[2,3],qx=[3,2],dB={L:fB,M:Gx,Q:Kx,H:qx},pB=/^[0-9]*$/,mB=/^[A-Z0-9 $%*+.\/:-]*$/,Ip="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ $%*+-./:",Np=1,Cp=40,Yx=3,gB=3,Su=40,yB=10,Vx=[[-1,7,10,15,20,26,18,20,24,30,18,20,24,26,30,22,24,28,30,28,28,28,28,30,30,26,28,30,30,30,30,30,30,30,30,30,30,30,30,30,30],[-1,10,16,26,18,24,16,18,22,22,26,30,22,22,24,24,28,28,26,26,26,26,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28],[-1,13,22,18,26,18,24,18,22,20,24,28,26,24,20,30,24,28,28,26,30,28,30,30,30,30,28,30,30,30,30,30,30,30,30,30,30,30,30,30,30],[-1,17,28,22,16,22,28,26,26,24,28,24,28,22,24,24,30,28,28,26,28,30,24,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30]],Xx=[[-1,1,1,1,1,1,2,2,2,2,4,4,4,4,4,6,6,6,6,7,8,8,9,9,10,12,12,12,13,14,15,16,17,18,19,19,20,21,22,24,25],[-1,1,1,1,2,2,4,4,4,5,5,5,8,9,9,10,10,11,13,14,16,17,17,18,20,21,23,25,26,28,29,31,33,35,37,38,40,43,45,47,49],[-1,1,1,2,2,4,4,6,6,8,8,8,10,12,16,12,17,16,18,21,20,23,23,25,27,29,34,34,35,38,40,43,45,48,51,53,56,59,62,65,68],[-1,1,1,2,4,4,4,5,6,8,8,11,11,16,16,18,16,19,21,25,25,25,34,30,32,35,37,40,42,45,48,51,54,57,60,63,66,70,74,77,81]];class _B{constructor(e,r,n,i){if(this.version=e,this.ecc=r,Tu(this,"size"),Tu(this,"mask"),Tu(this,"modules",[]),Tu(this,"types",[]),e<Np||e>Cp)throw new RangeError("Version value out of range");if(i<-1||i>7)throw new RangeError("Mask value out of range");this.size=e*4+17;const s=Array.from({length:this.size},()=>!1);for(let a=0;a<this.size;a++)this.modules.push(s.slice()),this.types.push(s.map(()=>0));this.drawFunctionPatterns();const o=this.addEccAndInterleave(n);if(this.drawCodewords(o),i===-1){let a=1e9;for(let c=0;c<8;c++){this.applyMask(c),this.drawFormatBits(c);const l=this.getPenaltyScore();l<a&&(i=c,a=l),this.applyMask(c)}}this.mask=i,this.applyMask(i),this.drawFormatBits(i)}getModule(e,r){return e>=0&&e<this.size&&r>=0&&r<this.size&&this.modules[r][e]}drawFunctionPatterns(){for(let n=0;n<this.size;n++)this.setFunctionModule(6,n,n%2===0,Ws.Timing),this.setFunctionModule(n,6,n%2===0,Ws.Timing);this.drawFinderPattern(3,3),this.drawFinderPattern(this.size-4,3),this.drawFinderPattern(3,this.size-4);const e=this.getAlignmentPatternPositions(),r=e.length;for(let n=0;n<r;n++)for(let i=0;i<r;i++)n===0&&i===0||n===0&&i===r-1||n===r-1&&i===0||this.drawAlignmentPattern(e[n],e[i]);this.drawFormatBits(0),this.drawVersion()}drawFormatBits(e){const r=this.ecc[1]<<3|e;let n=r;for(let s=0;s<10;s++)n=n<<1^(n>>>9)*1335;const i=(r<<10|n)^21522;for(let s=0;s<=5;s++)this.setFunctionModule(8,s,Li(i,s));this.setFunctionModule(8,7,Li(i,6)),this.setFunctionModule(8,8,Li(i,7)),this.setFunctionModule(7,8,Li(i,8));for(let s=9;s<15;s++)this.setFunctionModule(14-s,8,Li(i,s));for(let s=0;s<8;s++)this.setFunctionModule(this.size-1-s,8,Li(i,s));for(let s=8;s<15;s++)this.setFunctionModule(8,this.size-15+s,Li(i,s));this.setFunctionModule(8,this.size-8,!0)}drawVersion(){if(this.version<7)return;let e=this.version;for(let n=0;n<12;n++)e=e<<1^(e>>>11)*7973;const r=this.version<<12|e;for(let n=0;n<18;n++){const i=Li(r,n),s=this.size-11+n%3,o=Math.floor(n/3);this.setFunctionModule(s,o,i),this.setFunctionModule(o,s,i)}}drawFinderPattern(e,r){for(let n=-4;n<=4;n++)for(let i=-4;i<=4;i++){const s=Math.max(Math.abs(i),Math.abs(n)),o=e+i,a=r+n;o>=0&&o<this.size&&a>=0&&a<this.size&&this.setFunctionModule(o,a,s!==2&&s!==4,Ws.Position)}}drawAlignmentPattern(e,r){for(let n=-2;n<=2;n++)for(let i=-2;i<=2;i++)this.setFunctionModule(e+i,r+n,Math.max(Math.abs(i),Math.abs(n))!==1,Ws.Alignment)}setFunctionModule(e,r,n,i=Ws.Function){this.modules[r][e]=n,this.types[r][e]=i}addEccAndInterleave(e){const r=this.version,n=this.ecc;if(e.length!==Ru(r,n))throw new RangeError("Invalid argument");const i=Xx[n[0]][r],s=Vx[n[0]][r],o=Math.floor(Mp(r)/8),a=i-o%i,c=Math.floor(o/i),l=[],u=SB(s);for(let f=0,d=0;f<i;f++){const m=e.slice(d,d+c-s+(f<a?0:1));d+=m.length;const p=RB(m,u);f<a&&m.push(0),l.push(m.concat(p))}const h=[];for(let f=0;f<l[0].length;f++)l.forEach((d,m)=>{(f!==c-s||m>=a)&&h.push(d[f])});return h}drawCodewords(e){if(e.length!==Math.floor(Mp(this.version)/8))throw new RangeError("Invalid argument");let r=0;for(let n=this.size-1;n>=1;n-=2){n===6&&(n=5);for(let i=0;i<this.size;i++)for(let s=0;s<2;s++){const o=n-s,c=(n+1&2)===0?this.size-1-i:i;!this.types[c][o]&&r<e.length*8&&(this.modules[c][o]=Li(e[r>>>3],7-(r&7)),r++)}}}applyMask(e){if(e<0||e>7)throw new RangeError("Mask value out of range");for(let r=0;r<this.size;r++)for(let n=0;n<this.size;n++){let i;switch(e){case 0:i=(n+r)%2===0;break;case 1:i=r%2===0;break;case 2:i=n%3===0;break;case 3:i=(n+r)%3===0;break;case 4:i=(Math.floor(n/3)+Math.floor(r/2))%2===0;break;case 5:i=n*r%2+n*r%3===0;break;case 6:i=(n*r%2+n*r%3)%2===0;break;case 7:i=((n+r)%2+n*r%3)%2===0;break;default:throw new Error("Unreachable")}!this.types[r][n]&&i&&(this.modules[r][n]=!this.modules[r][n])}}getPenaltyScore(){let e=0;for(let s=0;s<this.size;s++){let o=!1,a=0;const c=[0,0,0,0,0,0,0];for(let l=0;l<this.size;l++)this.modules[s][l]===o?(a++,a===5?e+=Yx:a>5&&e++):(this.finderPenaltyAddHistory(a,c),o||(e+=this.finderPenaltyCountPatterns(c)*Su),o=this.modules[s][l],a=1);e+=this.finderPenaltyTerminateAndCount(o,a,c)*Su}for(let s=0;s<this.size;s++){let o=!1,a=0;const c=[0,0,0,0,0,0,0];for(let l=0;l<this.size;l++)this.modules[l][s]===o?(a++,a===5?e+=Yx:a>5&&e++):(this.finderPenaltyAddHistory(a,c),o||(e+=this.finderPenaltyCountPatterns(c)*Su),o=this.modules[l][s],a=1);e+=this.finderPenaltyTerminateAndCount(o,a,c)*Su}for(let s=0;s<this.size-1;s++)for(let o=0;o<this.size-1;o++){const a=this.modules[s][o];a===this.modules[s][o+1]&&a===this.modules[s+1][o]&&a===this.modules[s+1][o+1]&&(e+=gB)}let r=0;for(const s of this.modules)r=s.reduce((o,a)=>o+(a?1:0),r);const n=this.size*this.size,i=Math.ceil(Math.abs(r*20-n*10)/n)-1;return e+=i*yB,e}getAlignmentPatternPositions(){if(this.version===1)return[];{const e=Math.floor(this.version/7)+2,r=this.version===32?26:Math.ceil((this.version*4+4)/(e*2-2))*2,n=[6];for(let i=this.size-7;n.length<e;i-=r)n.splice(1,0,i);return n}}finderPenaltyCountPatterns(e){const r=e[1],n=r>0&&e[2]===r&&e[3]===r*3&&e[4]===r&&e[5]===r;return(n&&e[0]>=r*4&&e[6]>=r?1:0)+(n&&e[6]>=r*4&&e[0]>=r?1:0)}finderPenaltyTerminateAndCount(e,r,n){return e&&(this.finderPenaltyAddHistory(r,n),r=0),r+=this.size,this.finderPenaltyAddHistory(r,n),this.finderPenaltyCountPatterns(n)}finderPenaltyAddHistory(e,r){r[0]===0&&(e+=this.size),r.pop(),r.unshift(e)}}function Ci(t,e,r){if(e<0||e>31||t>>>e)throw new RangeError("Value out of range");for(let n=e-1;n>=0;n--)r.push(t>>>n&1)}function Li(t,e){return(t>>>e&1)!==0}class Lp{constructor(e,r,n){if(this.mode=e,this.numChars=r,this.bitData=n,r<0)throw new RangeError("Invalid argument");this.bitData=n.slice()}getData(){return this.bitData.slice()}}const bB=[1,10,12,14],wB=[2,9,11,13],kB=[4,8,16,16];function Zx(t,e){return t[Math.floor((e+7)/17)+1]}function Jx(t){const e=[];for(const r of t)Ci(r,8,e);return new Lp(kB,t.length,e)}function vB(t){if(!Qx(t))throw new RangeError("String contains non-numeric characters");const e=[];for(let r=0;r<t.length;){const n=Math.min(t.length-r,3);Ci(Number.parseInt(t.substring(r,r+n),10),n*3+1,e),r+=n}return new Lp(bB,t.length,e)}function xB(t){if(!eE(t))throw new RangeError("String contains unencodable characters in alphanumeric mode");const e=[];let r;for(r=0;r+2<=t.length;r+=2){let n=Ip.indexOf(t.charAt(r))*45;n+=Ip.indexOf(t.charAt(r+1)),Ci(n,11,e)}return r<t.length&&Ci(Ip.indexOf(t.charAt(r)),6,e),new Lp(wB,t.length,e)}function EB(t){return t===""?[]:Qx(t)?[vB(t)]:eE(t)?[xB(t)]:[Jx(TB(t))]}function Qx(t){return pB.test(t)}function eE(t){return mB.test(t)}function AB(t,e){let r=0;for(const n of t){const i=Zx(n.mode,e);if(n.numChars>=1<<i)return Number.POSITIVE_INFINITY;r+=4+i+n.bitData.length}return r}function TB(t){t=encodeURI(t);const e=[];for(let r=0;r<t.length;r++)t.charAt(r)!=="%"?e.push(t.charCodeAt(r)):(e.push(Number.parseInt(t.substring(r+1,r+3),16)),r+=2);return e}function Mp(t){if(t<Np||t>Cp)throw new RangeError("Version number out of range");let e=(16*t+128)*t+64;if(t>=2){const r=Math.floor(t/7)+2;e-=(25*r-10)*r-55,t>=7&&(e-=36)}return e}function Ru(t,e){return Math.floor(Mp(t)/8)-Vx[e[0]][t]*Xx[e[0]][t]}function SB(t){if(t<1||t>255)throw new RangeError("Degree out of range");const e=[];for(let n=0;n<t-1;n++)e.push(0);e.push(1);let r=1;for(let n=0;n<t;n++){for(let i=0;i<e.length;i++)e[i]=Up(e[i],r),i+1<e.length&&(e[i]^=e[i+1]);r=Up(r,2)}return e}function RB(t,e){const r=e.map(n=>0);for(const n of t){const i=n^r.shift();r.push(0),e.forEach((s,o)=>r[o]^=Up(s,i))}return r}function Up(t,e){if(t>>>8||e>>>8)throw new RangeError("Byte out of range");let r=0;for(let n=7;n>=0;n--)r=r<<1^(r>>>7)*285,r^=(e>>>n&1)*t;return r}function OB(t,e,r=1,n=40,i=-1,s=!0){if(!(Np<=r&&r<=n&&n<=Cp)||i<-1||i>7)throw new RangeError("Invalid value");let o,a;for(o=r;;o++){const h=Ru(o,e)*8,f=AB(t,o);if(f<=h){a=f;break}if(o>=n)throw new RangeError("Data too long")}for(const h of[Gx,Kx,qx])s&&a<=Ru(o,h)*8&&(e=h);const c=[];for(const h of t){Ci(h.mode[0],4,c),Ci(h.numChars,Zx(h.mode,o),c);for(const f of h.getData())c.push(f)}const l=Ru(o,e)*8;Ci(0,Math.min(4,l-c.length),c),Ci(0,(8-c.length%8)%8,c);for(let h=236;c.length<l;h^=253)Ci(h,8,c);const u=Array.from({length:Math.ceil(c.length/8)},()=>0);return c.forEach((h,f)=>u[f>>>3]|=h<<7-(f&7)),new _B(o,e,u,i)}function IB(t,e){const{ecc:r="L",boostEcc:n=!1,minVersion:i=1,maxVersion:s=40,maskPattern:o=-1,border:a=1}=e||{},c=typeof t=="string"?EB(t):Array.isArray(t)?[Jx(t)]:void 0;if(!c)throw new Error(`uqr only supports encoding string and binary data, but got: ${typeof t}`);const l=OB(c,dB[r],i,s,o,n),u=NB({version:l.version,maskPattern:l.mask,size:l.size,data:l.modules,types:l.types},a);return e?.invert&&(u.data=u.data.map(h=>h.map(f=>!f))),e?.onEncoded?.(u),u}function NB(t,e=1){if(!e)return t;const{size:r}=t,n=r+e*2;t.size=n,t.data.forEach(s=>{for(let o=0;o<e;o++)s.unshift(!1),s.push(!1)});for(let s=0;s<e;s++)t.data.unshift(Array.from({length:n},o=>!1)),t.data.push(Array.from({length:n},o=>!1));const i=Ws.Border;t.types.forEach(s=>{for(let o=0;o<e;o++)s.unshift(i),s.push(i)});for(let s=0;s<e;s++)t.types.unshift(Array.from({length:n},o=>i)),t.types.push(Array.from({length:n},o=>i));return t}function CB(t,e,r,n=!1){return e<0||r<0||e>=t.length||r>=t.length?n:t[r][e]}function LB(t,e={}){const r={WHITE_ALL:"█",WHITE_BLACK:"▀",BLACK_WHITE:"▄",BLACK_ALL:" "},n=IB(t,e),i=!1,s=!0,o=(l,u)=>CB(n.data,l,u,!0),a=[];let c="";for(let l=0;l<n.size;l+=2){for(let u=0;u<n.size;u++)o(u,l)===i&&o(u,l+1)===i?c+=r.WHITE_ALL:o(u,l)===i&&o(u,l+1)===s?c+=r.WHITE_BLACK:o(u,l)===s&&o(u,l+1)===i?c+=r.BLACK_WHITE:c+=r.BLACK_ALL;a.push(c),c=""}return a.join(`
`)}const Hs="$dkpurple",MB="$196",UB="$205",Xt="$yellow$205$205$205$196";function bt(t,e,r){wR(t,e,r)}function $B(t,e,r){const n=MB.repeat(r);bt(t,e,`${Hs}${n}`)}function $p(t,e,r){const n=UB.repeat(r);bt(t,e,`${Hs}${n}`)}function Pp(t,e,r){$B(t,e,r.length+2),bt(t,e,`${Hs} $white${r} `),$p(t,e,r.length+2)}function Gs(t,e,r){bt(t,e,`${Hs} ${" ".repeat(r.length)} `),bt(t,e,`${Hs} $gray${r} `),$p(t,e,r.length+2)}function Ks(t,e,r,n){bt(t,e,`${Hs} $white${r} $blue${n}`)}function jo(t,e,r){bt(t,e,`${Hs}$blue${r}`)}function PB(t,e,r,n){bt(t,e,`!${r};${n}`)}function BB(t,e,r,n,i=!0){if(i){const s=LB(r).split(`
`),o={32:32,9600:223,9604:220,9608:219};for(let a=0;a<s.length;a++){const c=[...s[a]].map(l=>`$${o[l.charCodeAt(0)]}`).join("");bt(t,e,c)}}bt(t,e,`!copyit ${r};${n}`),eO(t,e)}var FB=`desc;$DKGRAYname and type of codepage
`,DB=Object.freeze({__proto__:null,default:FB}),jB="desc;changes object into specified element",zB=Object.freeze({__proto__:null,default:jB}),WB="desc;like #play but for sound effects",HB=Object.freeze({__proto__:null,default:WB}),GB="",KB=Object.freeze({__proto__:null,default:GB}),qB="",YB=Object.freeze({__proto__:null,default:qB}),VB="",XB=Object.freeze({__proto__:null,default:VB}),ZB="",JB=Object.freeze({__proto__:null,default:ZB}),QB="",eF=Object.freeze({__proto__:null,default:QB}),tF="",rF=Object.freeze({__proto__:null,default:tF}),nF="",iF=Object.freeze({__proto__:null,default:nF}),sF="",oF=Object.freeze({__proto__:null,default:sF}),aF="",cF=Object.freeze({__proto__:null,default:aF}),lF="",uF=Object.freeze({__proto__:null,default:lF}),hF="",fF=Object.freeze({__proto__:null,default:hF}),dF="",pF=Object.freeze({__proto__:null,default:dF}),mF="",gF=Object.freeze({__proto__:null,default:mF}),yF="",_F=Object.freeze({__proto__:null,default:yF}),bF="",wF=Object.freeze({__proto__:null,default:bF}),kF=`desc;$DKGRAYstarts a section of an if-do-done block
`,vF=Object.freeze({__proto__:null,default:kF}),xF=`desc;$DKGRAYcompletes an if-do-done block
`,EF=Object.freeze({__proto__:null,default:xF}),AF="",TF=Object.freeze({__proto__:null,default:AF}),SF="",RF=Object.freeze({__proto__:null,default:SF}),OF="",IF=Object.freeze({__proto__:null,default:OF}),NF=`desc;$DKGRAYelse logic in an if-do-done block
`,CF=Object.freeze({__proto__:null,default:NF}),LF=`desc;$DKGRAYconditional else logic in an if-do-done block
`,MF=Object.freeze({__proto__:null,default:LF}),UF="",$F=Object.freeze({__proto__:null,default:UF}),PF="",BF=Object.freeze({__proto__:null,default:PF}),FF="",DF=Object.freeze({__proto__:null,default:FF}),jF="",zF=Object.freeze({__proto__:null,default:jF}),WF="",HF=Object.freeze({__proto__:null,default:WF}),GF="",KF=Object.freeze({__proto__:null,default:GF}),qF="",YF=Object.freeze({__proto__:null,default:qF}),VF="",XF=Object.freeze({__proto__:null,default:VF}),ZF=`desc;$DKGRAYhalt until the next cycle
`,JF=Object.freeze({__proto__:null,default:ZF}),QF=`desc;$DKGRAYevals condition for true or false
`,eD=Object.freeze({__proto__:null,default:QF}),tD="",rD=Object.freeze({__proto__:null,default:tD}),nD="",iD=Object.freeze({__proto__:null,default:nD}),sD="",oD=Object.freeze({__proto__:null,default:sD}),aD="",cD=Object.freeze({__proto__:null,default:aD}),lD="",uD=Object.freeze({__proto__:null,default:lD}),hD="",fD=Object.freeze({__proto__:null,default:hD}),dD="",pD=Object.freeze({__proto__:null,default:dD}),mD="",gD=Object.freeze({__proto__:null,default:mD}),yD="",_D=Object.freeze({__proto__:null,default:yD}),bD="",wD=Object.freeze({__proto__:null,default:bD}),kD="",vD=Object.freeze({__proto__:null,default:kD}),xD="",ED=Object.freeze({__proto__:null,default:xD}),AD="",TD=Object.freeze({__proto__:null,default:AD}),SD="",RD=Object.freeze({__proto__:null,default:SD}),OD="",ID=Object.freeze({__proto__:null,default:OD}),ND="",CD=Object.freeze({__proto__:null,default:ND}),LD="",MD=Object.freeze({__proto__:null,default:LD}),UD="",$D=Object.freeze({__proto__:null,default:UD}),PD="",BD=Object.freeze({__proto__:null,default:PD}),FD="",DD=Object.freeze({__proto__:null,default:FD}),jD="",zD=Object.freeze({__proto__:null,default:jD}),WD=`desc;$DKGRAYlaunches a bullet
words;dir
words2;dir,kind
`,HD=Object.freeze({__proto__:null,default:WD}),GD="",KD=Object.freeze({__proto__:null,default:GD}),qD="",YD=Object.freeze({__proto__:null,default:qD}),VD="",XD=Object.freeze({__proto__:null,default:VD}),ZD="",JD=Object.freeze({__proto__:null,default:ZD}),QD="",e5=Object.freeze({__proto__:null,default:QD}),t5="",r5=Object.freeze({__proto__:null,default:t5}),n5="",i5=Object.freeze({__proto__:null,default:n5}),s5="",o5=Object.freeze({__proto__:null,default:s5}),a5="",c5=Object.freeze({__proto__:null,default:a5}),l5="",u5=Object.freeze({__proto__:null,default:l5}),h5="",f5=Object.freeze({__proto__:null,default:h5}),d5="",p5=Object.freeze({__proto__:null,default:d5}),m5="",g5=Object.freeze({__proto__:null,default:m5}),y5="",_5=Object.freeze({__proto__:null,default:y5}),b5="",w5=Object.freeze({__proto__:null,default:b5}),k5="",v5=Object.freeze({__proto__:null,default:k5}),x5="",E5=Object.freeze({__proto__:null,default:x5}),A5="",T5=Object.freeze({__proto__:null,default:A5}),S5="",R5=Object.freeze({__proto__:null,default:S5}),O5=`desc;$DKGRAYdesignates an inactive label or comment
`,I5=Object.freeze({__proto__:null,default:O5}),N5=`desc;$DKGRAYadds hyperlink text

`,C5=Object.freeze({__proto__:null,default:N5}),L5=`desc;$DKGRAYsends the given message when hotkey is pressed

`,M5=Object.freeze({__proto__:null,default:L5}),U5=`desc;$DKGRAYread number input into given stat/flag
`,$5=Object.freeze({__proto__:null,default:U5}),P5=`desc;$DKGRAYa slider input from 1 to 9 

`,B5=Object.freeze({__proto__:null,default:P5}),F5=`desc;$DKGRAYlist with label value pairs to pick from
`,D5=Object.freeze({__proto__:null,default:F5}),j5=`desc;$DKGRAYread text input into given stat/flag
`,z5=Object.freeze({__proto__:null,default:j5}),W5=`desc;$DKGRAYdesignates a starting point for running code
`,H5=Object.freeze({__proto__:null,default:W5}),G5=`desc;$DKGRAYwaits until the object can move in the given direction and moves
`,K5=Object.freeze({__proto__:null,default:G5}),q5=`desc;$DKGRAYwill move the object in the given direction
`,Y5=Object.freeze({__proto__:null,default:q5}),V5=`desc;$DKGRAYcreates a 60x25 space for terrain and object elements
`,X5=Object.freeze({__proto__:null,default:V5}),Z5=`desc;$DKGRAYcustom 8x14 charset
`,J5=Object.freeze({__proto__:null,default:Z5}),Q5=`desc;$DKGRAYsets stat to given value

`,e4=Object.freeze({__proto__:null,default:Q5}),t4=`desc;$DKGRAYsends the given message when hotkey is pressed

`,r4=Object.freeze({__proto__:null,default:t4}),n4=`desc;$DKGRAYread external content and/or handle events
`,i4=Object.freeze({__proto__:null,default:n4}),s4=`desc;$DKGRAYread number input into given stat/flag
`,o4=Object.freeze({__proto__:null,default:s4}),a4=`desc;$DKGRAYelements that can walk, swim, or be used with #shoot

`,c4=Object.freeze({__proto__:null,default:a4}),l4=`desc;$DKGRAYcustom palette colors
`,u4=Object.freeze({__proto__:null,default:l4}),h4=`desc;$DKGRAYa slider input from 1 to 9 

`,f4=Object.freeze({__proto__:null,default:h4}),d4=`desc;$DKGRAYlist with label value pairs to pick from
`,p4=Object.freeze({__proto__:null,default:d4}),m4=`desc;$DKGRAYterrain for solid, walkable, swimable board elements
`,g4=Object.freeze({__proto__:null,default:m4}),y4=`desc;$DKGRAYread text input into given stat/flag
`,_4=Object.freeze({__proto__:null,default:y4}),b4=`desc;$DKGRAYadds text
`,w4=Object.freeze({__proto__:null,default:b4}),k4=`header;zss controls and inputs
section;keyboard input
option;arrow keys;move
option;shift + arrow keys;shoot
option;enter;ok / accept
option;escape;cancel / close
option;tab;menu / action
section;controller input
option;left stick;move
option;right stick;aim
option;a;ok / accept
option;b;cancel / close
option;y;menu / action
option;x;shoot
option;triggers;shoot
`,v4=Object.freeze({__proto__:null,default:k4}),x4=`header;developer commands
option;#books;list books in memory
option;#pages;list pages in opened book
option;@[pagetype:]page name;create & edit a new codepage in the currently opened book
option;#trash;list books and pages from open book you can delete
option;#save;flush state to register
option;#share;creates a click to copy share url and QR code
`,E4=Object.freeze({__proto__:null,default:x4}),A4=`header;H E L P
keyboard input
option;? or /;open terminal
option;esc;close terminal, scroll, or editor
option;tab;change layout
option;up or down arrow keys;navigate terminal items
option;left or right arrow keys;change terminal items
option;enter;activate terminal items
option;alt + arrow keys;skip words and terminal lines
option;ctrl + up / down arrow keys;input history
$32
option;controls;zss controls and inputs
!helpcontrols;read help controls
$32
option;text;zss text and inputs
!helptext;read help text
$32
option;developer;developer commands
!helpdeveloper;read help developer
$32
option;player;player settings & hotkeys
!helpplayer;read help player
`,T4=Object.freeze({__proto__:null,default:A4}),S4=`$white no pages found
$white use @ to create a page
$white @board name of board
$white @object name of object
$white @terrain name of terrain
$white You can omit the type and it will default to object
$white @object name of object
$white @name of object`,R4=Object.freeze({__proto__:null,default:S4}),O4=`header;player settings
#set user "name goes here"
`,I4=Object.freeze({__proto__:null,default:O4}),N4=`header;text formatting
section;typography
plain text
use"@quoted strings for special chars"
$$0-255 for ascii chars $159$176$240
use color names like $RED$$red$BLUE to change foreground color
use color names like $ONGREEN$$ongreen$ONCLEAR to change background color
use onclear $WHITE$$onclear$BLUE to change background to transparent
section;hyperlinks
option;!hotkey label <shortcut> [shortcutword];
send the given #label when the <shortcut> is pressed
!openit https://github.com/ianstormtaylor/is-hotkey;$BLUEuses is-hotkey
option;!range flag [minword] [maxword];
uses the standard 1 to 9 values input range
option;!select flag ...list of <word> <value> pairs;
gives a user a way to cycle through preset values
option;!text flag;
write user text input into a flag
`,C4=Object.freeze({__proto__:null,default:N4}),L4=`section;#autowah on
#autowah <number>
$white 0-100, 0 is off, 100 is full volume
#autowah basefrequency <frequency>
$white The frequency the filter is set to at the
$white low point of the wah.
#autowah octaves <number>
$white The number of octaves above the baseFrequency 
$white the filter will sweep to when fully open.
#autowah sensitivity <number>
$white The decibel threshold sensitivity for 
$white the incoming signal.
$white Normal range of -40 to 0.
#autowah gain <number>
$white Controls the loudness of the effect.
#autowah follower <seconds>
$white Sets the smoothing time for the effect.`,M4=Object.freeze({__proto__:null,default:L4}),U4=`section;#distort on
#distort <number>
$white 0-100, 0 is off, 100 is full volume
#distort distortion <number>
$white 0 or higher, controls strength of effect.
#distort oversample <2x|4x|none>
$white oversample improves quality.`,$4=Object.freeze({__proto__:null,default:U4}),P4=`section;#echo on
#echo <number>
$white 0-100, 0 is off, 100 is full volume
#echo delaytime <seconds>
$white duration between echos.
#echo feedback <number>
$white A number that is between [0, 1]
$white 1 is forever feedback and 0 is none.`,B4=Object.freeze({__proto__:null,default:P4}),F4=`!fcrushscroll hk f F next;#fcrush on
!echoscroll hk e E next;#echo on
!reverbscroll hk r R next;#reverb on
!phaserscroll hk p P next;#phaser on
!distortscroll hk d D next;#distort on
!vibratoscroll hk v V next;#vibrato on
!autowahscroll hk a A next;#autowah on`,D4=Object.freeze({__proto__:null,default:F4}),j4=`section;#fcrush on
#fcrush <number>
$white 0-100, 0 is off, 100 is full volume
#fcrush rate <number>
$white 1 or higher, more rate, more crush`,z4=Object.freeze({__proto__:null,default:j4}),W4=`section;helper scrolls
!termscroll hk t T next;terminal commands
!dictionary hk d D next;dictionary of commands
!charscroll hk a A next;char
!colorscroll hk c C next;color
!bgscroll hk b B next;bg
!notesscroll hk n N next;notes
!synthscroll hk s S next;synth
!effectsscroll hk e E next;effects
!voicescroll hk v V next;tts voices
`,H4=Object.freeze({__proto__:null,default:W4}),G4=`"duration             cdefgab = notes 
"y = 64th note        x = rest
"t = 32nd note        
"s = 16th note        drums
"i = eight note       0 = hihat
"q = quarter note     1 = open hihat
"h = half note        2 = cowbell
"w = whole note       p = clap
"mods                 4 = high snare
"3 = triplet          5 = high woodblock
". = time and a half  6 = low snare
"# = sharp            7 = low tom
"! = flat             8 = low woodblock
"+ = increase octave  9 = bass drum
"- = decrease octave`,K4=Object.freeze({__proto__:null,default:G4}),q4=`section;sine, square, triangle, sawtooth
#synth phase <degrees>
$white The phase is the starting position within 
$white the oscillator's cycle. For example a phase 
$white of 180 would start halfway through the
$white oscillator's cycle.
section;amsine, amsquare, amtriangle, amsawtooth
#synth harmonicity <number>
$white Harmonicity is the frequency ratio between 
$white the carrier and the modulator oscillators.
$white A harmonicity of 1 gives both oscillators 
$white the same frequency. Harmonicity = 2 
$white means a change of an octave.
#synth modtype <sine, square, triangle, sawtooth>
#synth modenv <a> <d> <s> <r> - in seconds
section;fmsine, fmsquare, fmtriangle, fmsawtooth
#synth harmonicity <number>
$white Harmonicity is the frequency ratio between 
$white the carrier and the modulator oscillators.
$white A harmonicity of 1 gives both oscillators 
$white the same frequency. Harmonicity = 2 
$white means a change of an octave.
#synth modtype <sine, square, triangle, sawtooth>
#synth modenv <a> <d> <s> <r> - in seconds
#synth modindex <degrees>
$white The modulation index which is in essence
$white the depth or amount of the modulation.
$white In other terms it is the ratio of the 
$white frequency of the modulating signal (mf) 
$white to the amplitude of the modulating signal 
$white (ma) -- as in ma/mf
section;fatsine, fatsquare, fattriangle, fatsawtooth
#synth phase <degrees>
#synth count <number>
$white This sets the number of oscillators to 
$white spread along the given range.
#synth spread <cents>
$white This signals the number of cents between
$white oscillators.`,Y4=Object.freeze({__proto__:null,default:q4}),V4=`section;#phaser on
#phaser <number>
$white 0-100, 0 is off, 100 is full volume
#phaser frequency <frequency>
$white The rate of oscilation of the effect.
#phaser octaves <number>
$white Controls the range of the effect.
#phaser basefrequency <frequency>
$white The base frequency of the filters.
`,X4=Object.freeze({__proto__:null,default:V4}),Z4=`section;pulse
#synth width <range>
$white A number that is between [-1, 1] altering
$white this value changes the shape of the square
$white wave`,J4=Object.freeze({__proto__:null,default:Z4}),Q4=`section;pwm
#synth modfreq <frequency>
$white This sets the frequency of change for the 
$white pulse width of this oscillator.`,ej=Object.freeze({__proto__:null,default:Q4}),tj=`section;#reverb on
#reverb <number>
$white 0-100, 0 is off, 100 is full volume
#reverb predelay <seconds>
$white The amount of time before the reverb
$white is fully ramped in.
#reverb decay <seconds>
$white The duration of the reverb.
`,rj=Object.freeze({__proto__:null,default:tj}),nj=`switching voices
#synth <sine, square, triangle, sawtooth> 
#synth <pwm, pulse, bells, doot>
#synth <retro, buzz, clang, metallic>

voice settings
#synth restart - resets voice to default
#synth vol <db> - control volume
#synth port <seconds>
#synth env <attack> <delay> <sustain> <release>

voice specific 
!oscscroll hk o O next;sine, square, triangle, sawtooth
!pwmscroll hk m M next;pwm
!pulsescroll hk p P next;pulse`,ij=Object.freeze({__proto__:null,default:nj}),sj=`press$white C$yellow to chat
press$white #$yellow to run a quick command
section;dev-tools
#gadget
$white toggles inspector tool on/off
#zztrandom
$white downloads random from the museumofzzt api
#zztsearch <field> <value>
$white searches the museumofzzt api for zzt games
section;multi-player
#set user <name>
$white sets your display name when talking to others
#joincode OR ctrl+O 
$white starts a multi-player session showing a
$white QR code. It also provides are sharable link
$white you can give to other to join the game.`,oj=Object.freeze({__proto__:null,default:sj}),aj=`section;#vibrato on
#vibrato <number>
$white 0-100, 0 is off, 100 is full volume
#vibrato maxdelay <seconds>
$white longer delay increases the vibrato`,cj=Object.freeze({__proto__:null,default:aj}),lj=`!copyit "ar-SA-HamedNeural";ar-SA-HamedNeural
!copyit "ar-SA-ZariyahNeural";ar-SA-ZariyahNeural
!copyit "de-DE-AmalaNeural";de-DE-AmalaNeural
!copyit "de-DE-ConradNeural";de-DE-ConradNeural
!copyit "de-DE-KatjaNeural";de-DE-KatjaNeural
!copyit "de-DE-KillianNeural";de-DE-KillianNeural
!copyit "en-US-AnaNeural";en-US-AnaNeural
!copyit "en-US-AndrewNeural";en-US-AndrewNeural
!copyit "en-US-AriaNeural";en-US-AriaNeural
!copyit "en-US-ChristopherNeural";en-US-ChristopherNeural
!copyit "en-US-EricNeural";en-US-EricNeural
!copyit "en-US-GuyNeural";en-US-GuyNeural
!copyit "en-US-JennyNeural";en-US-JennyNeural
!copyit "en-US-MichelleNeural";en-US-MichelleNeural
!copyit "en-US-RogerNeural";en-US-RogerNeural
!copyit "en-US-SteffanNeural";en-US-SteffanNeural
!copyit "es-ES-AlvaroNeural";es-ES-AlvaroNeural
!copyit "es-ES-ElviraNeural";es-ES-ElviraNeural
!copyit "fr-FR-DeniseNeural";fr-FR-DeniseNeural
!copyit "fr-FR-EloiseNeural";fr-FR-EloiseNeural
!copyit "fr-FR-HenriNeural";fr-FR-HenriNeural`,uj=Object.freeze({__proto__:null,default:lj});const tE=Object.assign({"./editor/codepagename.txt":DB,"./editor/command/become.txt":zB,"./editor/command/bgplay.txt":HB,"./editor/command/bgvol.txt":KB,"./editor/command/bind.txt":YB,"./editor/command/board.txt":XB,"./editor/command/bpm.txt":JB,"./editor/command/break.txt":eF,"./editor/command/change.txt":rF,"./editor/command/char.txt":iF,"./editor/command/charset.txt":oF,"./editor/command/clear.txt":cF,"./editor/command/color.txt":uF,"./editor/command/continue.txt":fF,"./editor/command/copy.txt":pF,"./editor/command/cycle.txt":gF,"./editor/command/die.txt":_F,"./editor/command/distort.txt":wF,"./editor/command/do.txt":vF,"./editor/command/done.txt":EF,"./editor/command/duplicate.txt":TF,"./editor/command/echo.txt":RF,"./editor/command/edge.txt":IF,"./editor/command/else.txt":CF,"./editor/command/elseif.txt":MF,"./editor/command/end.txt":$F,"./editor/command/endgame.txt":BF,"./editor/command/endwith.txt":DF,"./editor/command/fcrush.txt":zF,"./editor/command/fetch.txt":HF,"./editor/command/fetchwith.txt":KF,"./editor/command/foreach.txt":YF,"./editor/command/go.txt":XF,"./editor/command/idle.txt":JF,"./editor/command/if.txt":eD,"./editor/command/lock.txt":rD,"./editor/command/oneof.txt":iD,"./editor/command/oneofwith.txt":oD,"./editor/command/palette.txt":cD,"./editor/command/phaser.txt":uD,"./editor/command/pivot.txt":fD,"./editor/command/play.txt":pD,"./editor/command/put.txt":gD,"./editor/command/putwith.txt":_D,"./editor/command/readbin.txt":wD,"./editor/command/readjson.txt":vD,"./editor/command/readline.txt":ED,"./editor/command/readrexpaint.txt":TD,"./editor/command/remix.txt":RD,"./editor/command/repeat.txt":ID,"./editor/command/restore.txt":CD,"./editor/command/reverb.txt":MD,"./editor/command/revert.txt":$D,"./editor/command/run.txt":BD,"./editor/command/runwith.txt":DD,"./editor/command/set.txt":zD,"./editor/command/shoot.txt":HD,"./editor/command/shootwith.txt":KD,"./editor/command/shove.txt":YD,"./editor/command/snapshot.txt":XD,"./editor/command/synth.txt":JD,"./editor/command/toast.txt":e5,"./editor/command/tts.txt":r5,"./editor/command/ttsvol.txt":i5,"./editor/command/twitchbroadcast.txt":o5,"./editor/command/twitchchat.txt":c5,"./editor/command/unlock.txt":u5,"./editor/command/vibrato.txt":f5,"./editor/command/vol.txt":p5,"./editor/command/waitfor.txt":g5,"./editor/command/walk.txt":_5,"./editor/command/weave.txt":w5,"./editor/command/while.txt":v5,"./editor/command/with.txt":E5,"./editor/command/write.txt":T5,"./editor/command/zap.txt":R5,"./editor/comment.txt":I5,"./editor/hyperlink.txt":C5,"./editor/hyperlink/hotkey.txt":M5,"./editor/hyperlink/number.txt":$5,"./editor/hyperlink/range.txt":B5,"./editor/hyperlink/select.txt":D5,"./editor/hyperlink/text.txt":z5,"./editor/label.txt":H5,"./editor/shortgo.txt":K5,"./editor/shorttry.txt":Y5,"./editor/stat/board.txt":X5,"./editor/stat/charset.txt":J5,"./editor/stat/const.txt":e4,"./editor/stat/hotkey.txt":r4,"./editor/stat/loader.txt":i4,"./editor/stat/number.txt":o4,"./editor/stat/object.txt":c4,"./editor/stat/palette.txt":u4,"./editor/stat/range.txt":f4,"./editor/stat/select.txt":p4,"./editor/stat/terrain.txt":g4,"./editor/stat/text.txt":_4,"./editor/text.txt":w4,"./help/controls.txt":v4,"./help/developer.txt":E4,"./help/menu.txt":T4,"./help/nopages.txt":R4,"./help/player.txt":I4,"./help/text.txt":C4,"./refscroll/autowahscroll.txt":M4,"./refscroll/distortscroll.txt":$4,"./refscroll/echoscroll.txt":B4,"./refscroll/effectsscroll.txt":D4,"./refscroll/fcrushscroll.txt":z4,"./refscroll/menu.txt":H4,"./refscroll/notesscroll.txt":K4,"./refscroll/oscscroll.txt":Y4,"./refscroll/phaserscroll.txt":X4,"./refscroll/pulsescroll.txt":J4,"./refscroll/pwmscroll.txt":ej,"./refscroll/reverbscroll.txt":rj,"./refscroll/synthscroll.txt":ij,"./refscroll/termscroll.txt":oj,"./refscroll/vibratoscroll.txt":cj,"./refscroll/voicescroll.txt":uj}),rE={};Br(tE).forEach(t=>{const e=t.replace(".txt","").replace("./","").replaceAll("/",":");rE[e]=tE[t].default});function Ou(t){const e=Fe(t.trim().replaceAll(`
`,"").replace(/:+$/,"")),r=rE[e];if(w(r))return r;const{target:n,path:i}=Dr(e);switch(n){case"editor":{const s=Dr(i);switch(s.target){case"command":if(s.path.length)return`desc;$DKGRAYsends the message ${s.path}`}break}}}function Bp(t,e){const r=(t??"").split(`
`);for(let n=0;n<r.length;++n)e(r[n].split(";"))}function hj(t,e){const[r,...n]=e,i=n[0]??"",s=n[1]??"";switch(Fe(r.trim())){case"header":Pp(ce,t,i);break;case"section":Gs(ce,t,i);break;case"option":Ks(ce,t,i,s);break;default:r.trimStart().startsWith("!")?PB(ce,t,r.trimStart().slice(1),i):bt(ce,t,r);break}}const qs="$dkpurple",fj="$196",dj="$205";function pj(t,e){const r=fj.repeat(e);Ie(t,`${qs}${r}`)}function nE(t,e){const r=dj.repeat(e);Ie(t,`${qs}${r}`)}function mj(t,e){Ie(t,`${qs} ${" ".repeat(e.length)} `),pj(t,e.length+2),Ie(t,`${qs} $white${e} `),nE(t,e.length+2)}function gj(t,e){Ie(t,`${qs} ${" ".repeat(e.length)} `),Ie(t,`${qs} $gray${e} `),nE(t,e.length+2)}function yj(t,e,r){Ie(t,`${qs} $white${e} $blue${r}`)}function iE(t,e){const[r,...n]=e,i=n[0]??"",s=n[1]??"";switch(Fe(r.trim())){case"header":mj(t,i);break;case"section":gj(t,i);break;case"option":yj(t,i,s);break;default:if(r.trimStart().startsWith("!")){const o=r.trimStart().slice(1).split(" ");switch(Fe(o[0]??"")){case"copyit":Be(t,"refscroll",i,["",o[0]??"",o[1]??""]);break;default:{switch(Fe(o[1]??"")){case"hk":case"hotkey":Be(t,"refscroll",i,[o[0]??"",o[1]??"",o[2]??"",` ${o[3]??""} `,o[4]??""]);break;default:Be(t,"refscroll",i,[o[0]??""]);break}break}}}else r.trimStart().startsWith('"')?Ie(t,r.trimStart().slice(1)):Ie(t,r);break}}function Mi(t,e=!1){const[r]=ue(t,0,[V.ANY]);if(e&&nn(r)){const[n,i,s]=ue(t,0,[V.DIR,V.MAYBE_NAME]);return ye(i)&&i.startsWith(":")?{targetdir:n,label:[i.substring(1).trim(),...t.slice(s)].join(" ")}:{targetdir:n,label:t.slice(s-1).join(" ")}}else if(ye(r)){const[n,i,s]=ue(t,0,[V.NAME,V.MAYBE_NAME]);if(ye(i)&&i.startsWith(":")){const a=[i.substring(1).trim(),...t.slice(s)];return{targetname:n,label:a.join(" ")}}return{targetname:"self",label:[n,...t.slice(s-1)].join(" ")}}return{targetname:"",label:""}}function Ys(){gg(ce,Mr())}function zo(t){Bp(Ou(`help:${t}`),e=>hj(E.elementfocus,e))}function sE(t){switch(t.label){case"helpmenu":zo("menu");break;case"helpcontrols":zo("controls");break;case"helptext":zo("text");break;case"helpdeveloper":zo("developer");break;case"helpplayer":zo("player");break;default:{const e=dt(Xe.MAIN),r=Do(e);w(t.targetname)?Xo(t.targetname,t.label,void 0,r):w(t.targetdir)&&Xo(t.targetdir.destpt,t.label,void 0,r);break}}}const _j=vi().command("shortsend",(t,e)=>{const r=Mi(e);return sE(r),0}).command("send",(t,e)=>{const r=Mi(e,!0);return sE(r),0}).command("stat",(t,e)=>{const[r,...n]=e.map(Pt),i=n.join(" ");function s(o,a){if(w(o)&&(t.command("pageopen",o.id),a)){const c=mt(o),l=Ii(o);bt(ce,E.elementfocus,`!pageopen ${o.id};$blue[${l}]$white ${c}`)}}switch(Fe(r)){case an(Pe.LOADER):{const[o,a]=is(Xe.MAIN,i,Re.LOADER);s(o,a);break}default:{const[o,a]=is(Xe.MAIN,[r,...n].join(" "),Re.OBJECT);s(o,a);break}case an(Pe.BOARD):{const[o,a]=is(Xe.MAIN,i,Re.BOARD);s(o,a);break}case an(Pe.OBJECT):{const[o,a]=is(Xe.MAIN,i,Re.OBJECT);s(o,a);break}case an(Pe.TERRAIN):{const[o,a]=is(Xe.MAIN,i,Re.TERRAIN);s(o,a);break}case an(Pe.CHARSET):{const[o,a]=is(Xe.MAIN,i,Re.CHARSET);s(o,a);break}case an(Pe.PALETTE):{const[o,a]=is(Xe.MAIN,i,Re.PALETTE);s(o,a);break}}return 0}).command("text",(t,e)=>{const r=e.map(Pt).join(" ");if(w(E.element)&&E.elementisplayer){const{user:n}=En(E.elementid),i=ye(n)?n:"player";E.element.tickertext=`${i}:$WHITE ${r}`,E.element.tickertime=E.timestamp;const s=Vt(E.element);kR(ce,E.elementid,`$${Je[s.color]}$ON${Je[s.bg]}$${s.char}$ONCLEAR$CYAN ${i}:$WHITE ${r}`),Hh(ce,E.elementid,void 0,"text","chat:message:game",`${i}:${r}`)}return 0}).command("hyperlink",(t,e)=>{const[r,...n]=e,i=Pt(r),s=Mi(n);if(w(s.targetname)){const{user:o}=En(E.elementid),a=ye(o)?o:"player",c=Vt(E.element),l=`$${Je[c.color]}$ON${Je[c.bg]}$${c.char}$ONCLEAR $WHITE${a}$BLUE ${i}`;Ft(ce,E.elementid,`!${s.targetname}:${s.label};${l}`)}return 0}).command("config",(t,e)=>{const[r,n]=ue(e,0,[V.MAYBE_NAME,V.MAYBE_STRING]);return ye(r)&&ye(n)?dg(ce,E.elementfocus,r,n):JR(ce,E.elementfocus),0}).command("bookcreate",(t,e)=>{const[r]=ue(e,0,[V.MAYBE_NAME]),n=oT(r);return w(n)&&t.command("bookopen",n.id),0}).command("bookopen",(t,e)=>{const[r]=ue(e,0,[V.NAME]),n=jn(r);return w(n)?(dg(ce,E.elementfocus,"selected",n.id),Ys()):pt(ce,E.elementfocus,"bookopen",`book ${r} not found`),0}).command("booktrash",(t,e)=>{const[r]=ue(e,0,[V.NAME]),n=dt(Xe.MAIN),i=jn(r);return w(i)&&(n===i&&sT(Xe.MAIN,""),M7(r),Ft(ce,E.elementfocus,`trashed [book] ${i.name}`),Ys(),t.command("pages")),0}).command("boardopen",(t,e)=>{const[r]=ue(e,0,[V.NAME]),n=pr(r);return w(n)&&Fo(E.book,E.elementfocus,n.id,{x:rn(0,Ue-1),y:rn(0,nt-1)},!0),0}).command("pageopen",(t,e)=>{const[r,n]=ue(e,0,[V.NAME,V.MAYBE_NAME]);let i,s;const o=ln();for(let a=0;a<o.length&&(s=o[a],i=Fs(s,r),!w(i));++a);if(w(i)&&w(s)){const a=mt(i),c=[i.id,n];$f(Oc(s.id,c),i.code);const l=Ii(i);pg(ce,E.elementfocus,s.id,c,l,`${a} - ${s.name}`)}else pt(ce,"pageopen",`page ${r} not found`,E.elementfocus);return 0}).command("pagetrash",(t,e)=>{const[r]=ue(e,0,[V.NAME]),n=fr(Xe.MAIN),i=Lx(n,r);if(w(r)){const s=mt(i),o=Ii(i);Ft(ce,E.elementfocus,`trashed [${o}] ${s}`),Ys(),t.command("pages")}return 0}).command("help",(t,e)=>{const r=e.map(Pt).join(" ")||"menu";return t.command(`help${r}`),0}).command("books",()=>{Gs(ce,E.elementfocus,"books");const t=dt(Xe.MAIN);Ks(ce,E.elementfocus,"main",`${t?.name??"empty"} $GREEN${t?.id??""}`);const e=dt(Xe.MAIN);Ks(ce,E.elementfocus,"content",`${e?.name??"empty"} ${e?.id??""}`),$p(ce,E.elementfocus,7);const r=ln();return r.length?r.forEach(n=>{bt(ce,E.elementfocus,`!bookopen ${n.id};${n.name}`)}):jo(ce,E.elementfocus,"no books found"),bt(ce,E.elementfocus,"!bookcreate;create a new book"),0}).command("pages",()=>{const t=fr(Xe.MAIN);if(!w(t))return 0;Gs(ce,E.elementfocus,"pages"),Ks(ce,E.elementfocus,"main",`${t.name} $GREEN${t.id}`),t.pages.length?rc(t).forEach(n=>{const i=mt(n),s=Ii(n);bt(ce,E.elementfocus,`!pageopen ${n.id};$blue[${s}]$white ${i}`)}):(bt(ce,E.elementfocus,""),zo("nopages"));const e=ln();for(let r=0;r<e.length;++r){const n=e[r];n.id!==t.id&&(Ks(ce,E.elementfocus,"content",`${n.name} $GREEN${n.id}`),rc(n).forEach(s=>{const o=mt(s),a=Ii(s);bt(ce,E.elementfocus,`!pageopen ${s.id};$blue[${a}]$white ${o}`)}))}return 0}).command("boards",()=>{Gs(ce,E.elementfocus,"boards");const t=fr(Xe.MAIN);if(w(t)){Ks(ce,E.elementfocus,"main",`${t.name} $GREEN${t.id}`);const r=rc(t);r.filter(n=>hi(n)===Re.BOARD).forEach(n=>{const i=mt(n);bt(ce,E.elementfocus,`!boardopen ${n.id};$blue[#goto]$white ${i}`)}),r.length===0&&(bt(ce,E.elementfocus,""),jo(ce,E.elementfocus,"$white no boards found"),jo(ce,E.elementfocus,"$white use @ to create a board"),jo(ce,E.elementfocus,"$white @board name of board"))}const e=ln();for(let r=0;r<e.length;++r){const n=e[r];n.id!==t.id&&(Ks(ce,E.elementfocus,"content",`${n.name} $GREEN${n.id}`),rc(n).filter(s=>hi(s)===Re.BOARD).forEach(s=>{const o=mt(s);bt(ce,E.elementfocus,`!boardopen ${s.id};$blue[#goto]$white ${o}`)}))}return 0}).command("trash",()=>{Gs(ce,E.elementfocus,"$REDTRASH"),jo(ce,E.elementfocus,"books");const t=ln();t.length&&(t.forEach(r=>{bt(ce,E.elementfocus,`!booktrash ${r.id};$REDTRASH ${r.name}`)}),bt(ce,E.elementfocus,""));const e=dt(Xe.MAIN);return w(e)&&(jo(ce,E.elementfocus,`pages in open ${e.name} book`),e.pages.forEach(r=>{const n=mt(r);bt(ce,E.elementfocus,`!pagetrash ${r.id};$REDTRASH ${n}`)}),bt(ce,E.elementfocus,"")),0}).command("dev",()=>(Ys(),BR(ce,E.elementfocus),0)).command("share",()=>(Ys(),FR(ce,E.elementfocus),0)).command("save",()=>(Ys(),0)).command("fork",()=>(aO(ce,E.elementfocus),0)).command("itchiopublish",()=>(cO(ce,E.elementfocus),0)).command("nuke",()=>(DR(ce,E.elementfocus),0)).command("restart",()=>(oO(ce,E.elementfocus),Ys(),0)).command("export",()=>{Pp(ce,E.elementfocus,"E X P O R T"),Gs(ce,E.elementfocus,"books");const t=ln();return t.length&&t.forEach(e=>bt(ce,E.elementfocus,`!bookexport ${e.id};${e.name}`)),0}).command("bookexport",(t,e)=>{const[r]=ue(e,0,[V.NAME]),n=jn(r);return w(n)&&(Pp(ce,E.elementfocus,"E X P O R T"),Gs(ce,E.elementfocus,"pages"),setTimeout(()=>{if(n.pages.length){const i=rc(n);bt(ce,E.elementfocus,`!bookallexport ${r};$blue[all]$white export book`),i.forEach(s=>{const o=mt(s),a=Ii(s);bt(ce,E.elementfocus,`!pageexport ${r}:${s.id};$blue[${a}]$white ${o}`)})}},1e3)),0}).command("bookallexport",(t,e)=>{const[r]=ue(e,0,[V.NAME]),n=jn(r);return w(n)&&hg(ce,E.elementfocus,Sn(n),`${n.name}.book.json`),0}).command("pageexport",(t,e)=>{const[r]=ue(e,0,[V.NAME]),{target:n,path:i}=Dr(r),s=jn(n),o=Fs(s,i);return w(o)&&hg(ce,E.elementfocus,Sn(o),`${mt(o)}.${Ii(o)}.json`),0}).command("gadget",()=>(QR(ce,E.elementfocus),0)).command("zztsearch",(t,e)=>{const[r,n]=ue(e,0,[V.NAME,V.MAYBE_NAME]),i=w(n)?r:"title",s=w(n)?n:r;return tO(ce,E.elementfocus,i,s),0}).command("zztrandom",()=>(rO(ce,E.elementfocus),0)).command("joincode",(t,e)=>{const[r]=ue(e,0,[V.MAYBE_NAME]);return SR(ce,E.elementfocus,!!r),0}).command("jointab",(t,e)=>{const[r]=ue(e,0,[V.MAYBE_NAME]);return RR(ce,E.elementfocus,!!r),0}).command("startlookingglass",()=>(jR(ce,E.elementfocus),0)),bj=vi().command("toast",(t,e)=>{const r=e.map(Pt).join("");return ms(ce,E.elementfocus,r),0}).command("ticker",(t,e)=>{const r=e.map(Pt).join("");return w(E.element)&&(E.element.tickertext=r,E.element.tickertime=E.timestamp),0}).command("palette",(t,e)=>{const[r]=ue(e,0,[V.NAME]),n=cT(),i=dr(Re.PALETTE,r);return w(i)?(n.palette=i.id,Ft(ce,E.elementfocus,`loaded palette ${r}`)):pt(ce,E.elementfocus,"not-found",`unabled to find palette ${r}`),0}).command("charset",(t,e)=>{const[r]=ue(e,0,[V.NAME]),n=cT(),i=dr(Re.CHARSET,r);return w(i)?(n.charset=i.id,Ft(ce,E.elementfocus,`loaded charset ${r}`)):pt(ce,E.elementfocus,"not-found",`unabled to find charset ${r}`),0}),Fp={issolid:"ISSOLID",iswalk:"ISWALK",isswim:"ISSWIM",isbullet:"ISBULLET",isghost:"ISGHOST",iswalking:"ISWALK",iswalkable:"ISWALK",isswimming:"ISSWIM",isswimmable:"ISSWIM"};We.ISSOLID,We.ISWALK,We.ISSWIM,We.ISBULLET,We.ISGHOST,We.ISWALK,We.ISSWIM;function Iu(t){return ut(t)&&Dp(t[0])}function Dp(t){return w(We[t])&&ye(t)}function wj(t){if(ye(t))return Fp[Fe(t)]}function kj(t){const e=E.words[t];if(Iu(e))return[e,t+1];if(Dp(e))return[[e],t+1];const[r,n]=Cr(t);return Iu(r)?[r,n]:Dp(r)?[[r],n]:[void 0,t]}function Wo(t,e=0){const r=[];let n=t;for(;n<E.words.length;){const[i,s]=Cr(n);if(ut(i)&&!nn(i)&&!ac(i)&&!Iu(i)&&!Sr(i)&&r.push(...i),i==="|")return[r,s];if(n=s,r.push(i),e>0&&r.length>=e)return[r,n]}return[r,n]}function Cr(t){const e=E.words[t],r=t+1;if(aE(e)){const[n,i]=vj(t);if(w(n))return[n,i]}if(wj(e)){const[n,i]=kj(t);if(w(n))return[n,i]}if(Ta(e)){const[n,i]=fl(t);if(w(n))return[n,i]}if(ye(e)&&Fe(e)==="rnd"){const[n,i]=Cr(r),[s,o]=Cr(i);return Ae(n)&&Ae(s)?[rn(n,s),o]:Ae(n)?[rn(0,n),i]:[rn(0,1),r]}if(ll(e)){const[n,i]=b_(t);if(w(n))return[n,i]}if(!w(e))return[void 0,t];if(Ae(e)||ut(e))return[e,r];if(ye(e)){const n=Fe(e),i=E.get?.(e);if(w(i))return[i,r];switch(n){case"aligned":case"alligned":{const s=mc(E.board,{x:E.element?.x??-1,y:E.element?.y??-1},E.elementfocus);return!w(E.element)||!w(s)?[0,r]:[E.element.x===s.x||E.element.y===s.y?1:0,r]}case"contact":{const s=mc(E.board,{x:E.element?.x??-1,y:E.element?.y??-1},E.elementfocus);if(!w(E.element)||!w(s))return[0,r];const o=(s.x??0)-(E.element?.x??0),a=(s.y??0)-(E.element?.y??0);return[o===0&&Math.abs(a)<2||a===0&&Math.abs(o)<2?1:0,r]}case"blocked":{const[s,o]=ue(E.words,r,[V.DIR]);return[DP(E.board,E.element,s.destpt)?1:0,o]}case"any":{const[s]=ue(E.words,r,[V.ANY]);if(nn(s)){const[l,u,h]=ue(E.words,r,[V.DIR,V.COLOR_OR_KIND]);if(l.targets.length){const d=[];for(let m=0;m<l.targets.length;++m){const p=l.targets[m],g=["any","at",p.x,p.y,...u],[y]=ue(g,0,[V.ANY]);ut(y)&&y.length&&d.push(...y)}return[d,h]}const f=l.layer===ve.MID?it(E.board,l.destpt):Pi(E.board,l.destpt.x,l.destpt.y);if(w(f)){const d=Vt(f);if(Sr(u))return[ul(u)===d.color||hl(u)===d.bg?[f]:[],h];const m=Fe(dc(u)),p=Vu(u);if((m.length&&m!==d.name||w(p)&&p!==d.color)===!1)return[[f],h]}return[[],h]}const[o,a]=ue(E.words,r,[V.COLOR_OR_KIND]);return Sr(o)?[gT(E.board,o),a]:[Xu(E.board,o),a]}case"countof":{const[s]=ue(E.words,r,[V.ANY]);if(nn(s)){const[l,u,h]=ue(E.words,r,[V.DIR,V.COLOR_OR_KIND]);if(l.targets.length){let d=0;for(let m=0;m<l.targets.length;++m){const p=l.targets[m],g=["countof","at",p.x,p.y,...u],[y]=ue(g,0,[V.ANY]);Ae(y)&&(d+=y)}return[d,h]}const f=l.layer===ve.MID?it(E.board,l.destpt):Pi(E.board,l.destpt.x,l.destpt.y);if(w(f)){const d=Vt(f);if(Sr(u))return[ul(u)===d.color||hl(u)===d.bg?1:0,h];const m=Fe(dc(u)),p=Vu(u),g=m.length?m===d.name:!0,y=w(p)?p===d.color:!0;if(g&&y)return[1,h]}return[0,h]}const[o,a]=ue(E.words,r,[V.COLOR_OR_KIND]);return Sr(o)?[gT(E.board,o).length,a]:[Xu(E.board,o).length,a]}case"rnd":return[rn(0,1),r];case"abs":{const[s,o]=ue(E.words,r,[V.NUMBER]);return[Math.abs(s),o]}case"intceil":{const[s,o]=ue(E.words,r,[V.NUMBER]);return[Math.ceil(s),o]}case"intfloor":{const[s,o]=ue(E.words,r,[V.NUMBER]);return[Math.floor(s),o]}case"intround":{const[s,o]=ue(E.words,r,[V.NUMBER]);return[Math.round(s),o]}case"clamp":{const[s,o,a,c]=ue(E.words,r,[V.NUMBER,V.NUMBER,V.NUMBER]);return[jt(s,o,a),c]}case"min":{const[s,o]=Wo(r);return[Math.min(...s),o]}case"max":{const[s,o]=Wo(r);return[Math.max(...s),o]}case"pick":{const[s,o]=Wo(r);return[mn(s),o]}case"pickwith":{const[s,o]=ue(E.words,r,[V.NUMBER_OR_STRING]),[a,c]=Wo(o);return[lC(`${s}`,a),c]}case"random":{const[s,o]=Wo(r,2),[a,c]=s;return[rn(a,c??0),o]}case"randomwith":{const[s,o]=ue(E.words,r,[V.NUMBER_OR_STRING]),[a,c]=Wo(o,2),[l,u]=a;return[m_(`${s}`,l,u??0),c]}case"run":{const[s,o]=ue(E.words,r,[V.NAME]);return Yu(s),[E.get?.("arg"),o]}case"runwith":{const[s,o,a]=ue(E.words,r,[V.ANY,V.NAME]);return w(E.element)&&(E.element.arg=s),Yu(o),[E.get?.("arg"),a]}}}return[e,r]}const jp={isterrain:"ISTERRAIN",isobject:"ISOBJECT"};function ac(t){return ut(t)&&oE(t[0])}function oE(t){return w(Fr[t])&&ye(t)}function aE(t){if(ye(t))return jp[Fe(t)]}function cE(t){if(ac(t))return t;if(oE(t))return[t];const e=aE(t);if(w(e))return[e]}function vj(t){const e=E.words[t],r=cE(e);if(ac(r))return[r,t+1];const[n,i]=Cr(t),s=cE(n);return ac(s)?[s,i]:[void 0,t]}const xj=new Set(["inputmove","inputalt","inputctrl","inputshift","inputok","inputcancel","inputmenu"]),lE=new Set(["char","color","bg","displaychar","displaycolor","displaybg","item","group","party","player","pushable","collision","breakable","p1","p2","p3","p4","p5","p6","p7","p8","p9","p10","cycle","stepx","stepy","shootx","shooty","light","lightdir","sender","arg"]),Ej=["NORTH","SOUTH","WEST","EAST"];function Aj(t){const e=En(t);if(Ae(e.inputcurrent)||(e.inputcurrent=0),ut(e.inputqueue)||(e.inputqueue=[]),e.inputcurrent>0)return e;const[r]=e.inputqueue,[n=Rr.NONE,i=0]=r??[Rr.NONE,0];switch(e.inputmove=[],e.inputok=0,e.inputcancel=0,e.inputmenu=0,e.inputalt=i&OC?1:0,e.inputctrl=i&IC?1:0,e.inputshift=i&NC?1:0,n){case Rr.MOVE_UP:case Rr.MOVE_DOWN:case Rr.MOVE_LEFT:case Rr.MOVE_RIGHT:e.inputmove=[Ej[n-Rr.MOVE_UP]];break;case Rr.OK_BUTTON:e.inputok=1;break;case Rr.CANCEL_BUTTON:e.inputcancel=1;break;case Rr.MENU_BUTTON:e.inputmenu=1;break}return e.inputcurrent=n,e.inputqueue=e.inputqueue.filter(s=>{const[o]=s;return o!==Rr.NONE&&o!==n}),e}function Tj(t){const e=jp[t];if(w(e))return e;const r=Fp[t];if(w(r))return r;const n=Aa[t];if(w(n))return n;const i=Hf[t];if(w(i))return i}function uE(){if(gr(E.board,E.element,E.timestamp),!!He(E.element,"item")){const e={x:E.element?.x??-1,y:E.element?.y??-1},r=mc(E.board,e,E.elementfocus);w(r)&&(r.x=e.x,r.y=e.y)}}const Sj=vi({get(t,e){const r=Tj(e);if(w(r))return[!0,r];if(E.elementisplayer&&xj.has(e)){const l=Aj(E.elementid)[e];return[w(l),l]}const n=mc(E.board,{x:E.element?.x??-1,y:E.element?.y??-1},E.elementfocus),i=n?.id??E.elementfocus??Mr(),s=E.element?.sender,o=kT(E.board,ye(s)?s:""),a=o?.id??"";switch(e){case"camera":case"graphics":case"facing":if(w(E.board?.[e]))return[!0,E.board?.[e]];break;case"isdark":return[!0,E.board?.isdark?1:0];case"startx":return[!0,E.board?.startx??0];case"starty":return[!0,E.board?.starty??0];case"over":return[!0,E.board?.over??""];case"under":return[!0,E.board?.under??""];case"exitnorth":return[!0,E.board?.exitnorth??""];case"exitsouth":return[!0,E.board?.exitsouth??""];case"exitwest":return[!0,E.board?.exitwest??""];case"exiteast":return[!0,E.board?.exiteast??""];case"timelimit":return[!0,E.board?.timelimit??0];case"restartonzap":return[!0,E.board?.restartonzap??0];case"maxplayershots":return[!0,E.board?.maxplayershots??0];case"currenttick":return[!0,E.timestamp];case"boardid":return[!0,E.board?.id??""];case"playerid":return[!0,i];case"playerx":return[!0,n?.x??-1];case"playery":return[!0,n?.y??-1];case"thisid":return[!0,E.element?.id??""];case"thisx":return[!0,E.element?.x??-1];case"thisy":return[!0,E.element?.y??-1];case"senderid":return[!0,a];case"senderx":return[!0,o?.x??-1];case"sendery":return[!0,o?.y??-1];default:{if(lE.has(e))return[!0,He(E.element,e)??0];break}}const c=En(i)[e];return[w(c),c]},set(t,e,r){const i=mc(E.board,{x:E.element?.x??-1,y:E.element?.y??-1},E.elementfocus)?.id??E.elementfocus;switch(e){case"camera":case"graphics":case"facing":break;case"isdark":if(w(E.board))return E.board.isdark=r?1:0,[!0,E.board.isdark];break;case"startx":if(w(E.board))return E.board.startx=sc(r,0),[!0,E.board.startx];break;case"starty":if(w(E.board))return E.board.starty=sc(r,0),[!0,E.board.starty];break;case"over":if(w(E.board))return E.board.over=Pt(r),[!0,E.board.over];break;case"under":if(w(E.board))return[!0,E.board.under=Pt(r)];break;case"exitnorth":if(w(E.board))return[!0,E.board.exitnorth=Pt(r)];break;case"exitsouth":if(w(E.board))return[!0,E.board.exitsouth=Pt(r)];break;case"exitwest":if(w(E.board))return[!0,E.board.exitwest=Pt(r)];break;case"exiteast":if(w(E.board))return[!0,E.board.exiteast=Pt(r)];break;case"timelimit":if(w(E.board))return[!0,E.board.timelimit=sc(r,0)];break;case"restartonzap":if(w(E.board))return[!0,E.board.restartonzap=r?1:0];break;case"maxplayershots":if(w(E.board))return[!0,E.board.maxplayershots=sc(r,0)];break;case"currenttick":return[!1,r];case"boardid":return[!1,r];case"playerid":return[!1,r];case"playerx":return[!1,r];case"playery":return[!1,r];case"thisid":return[!1,r];case"thisx":return[!1,r];case"thisy":return[!1,r];case"senderid":return[!1,r];case"senderx":return[!1,r];case"sendery":return[!1,r];default:{if(lE.has(e))return w(E.element)&&(E.element[e]=r),[!0,r];break}}const s=En(i);return w(s)?(s[e]=r,[!0,r]):[!1,r]},everytick(){!E.element?.removed&&w(E.element?.x)&&w(E.element.y)&&w(E.element.stepx)&&w(E.element.stepy)&&(E.element.stepx||E.element.stepy)&&zn(E.book,E.board,E.element,{x:E.element.x+E.element.stepx,y:E.element.y+E.element.stepy})}}).command("clear",(t,e)=>{for(let r=0;r<e.length;++r)t.set(Pt(e[r]),0);return 0}).command("set",(t,e)=>{const[r,n]=ue(e,0,[V.NAME,V.ANY]);return t.set(r,n??1),0}).command("become",(t,e)=>{const[r]=ue(e,0,[V.KIND]);hr(E.board);const n=Vt(E.element),[i,s]=r,o=[...To(n.color,n.bg),...s??[]],a=[i,o];if(wu(E.board,E.element),gr(E.board,E.element,E.timestamp)){const c={x:E.element?.x??0,y:E.element?.y??0};un(E.board,a,c)}return t.endofprogram(),0}).command("bind",(t,e)=>{const[r]=ue(e,0,[V.NAME]),n=Zo(E.board,r);return w(E.element)&&n.length>0&&(E.element.code=mn(...n).code??"",dT(E.elementid)),0}).command("char",(t,e)=>{const[r]=ue(e,0,[V.ANY]);if(nn(r)){const[n,i]=ue(e,0,[V.DIR,V.NUMBER]),s=it(E.board,n.destpt);w(s)&&(s.char=i)}else w(E.element)&&Ae(r)&&(E.element.char=r);return 0}).command("color",(t,e)=>{const[r]=ue(e,0,[V.ANY]);if(nn(r)){const[n,i]=ue(e,0,[V.DIR,V.COLOR]),s=it(E.board,n.destpt);w(s)&&La(E.element,i)}else{const[n]=ue(e,0,[V.COLOR]);w(E.element)&&w(n)&&La(E.element,n)}return 0}).command("go",(t,e)=>{if(w(E.element)){const[r]=ue(e,0,[V.DIR]);if(zn(E.book,E.board,E.element,r.destpt),t.yield(),E.element.x===r.destpt.x&&E.element.y===r.destpt.y)return 0}return 1}).command("walk",(t,e)=>{if(!w(E.element))return 0;const[r]=ue(e,0,[V.DIR]),n=E.element.x??0,i=E.element.y??0;return E.element.stepx=r.destpt.x-n,E.element.stepy=r.destpt.y-i,0}).command("idle",t=>(t.yield(),0)).command("end",t=>(t.endofprogram(),0)).command("endwith",(t,e)=>{const[r]=ue(e,0,[V.ANY]);return t.set("arg",r),t.command("end")}).command("lock",t=>(t.lock(t.id()),0)).command("restore",(t,e)=>(t.restore(Pt(e[0])),0)).command("unlock",t=>(t.unlock(),0)).command("zap",(t,e)=>(t.zap(Pt(e[0])),0)).command("cycle",(t,e)=>{if(w(E.element)){const[r]=ue(e,0,[V.NUMBER]);E.element.cycle=jt(Math.round(r),1,255)}return 0}).command("die",t=>(uE(),t.endofprogram(),0)).command("dieonend",()=>(uE(),0)).command("endgame",()=>(Wh(ce,E.elementfocus),0)).command("run",(t,e)=>{const[r]=ue(e,0,[V.NAME]);return Yu(r),0}).command("runwith",(t,e)=>{const[r,n]=ue(e,0,[V.ANY,V.NAME]);return t.set("arg",r),Yu(n),0}),Nu={};function Rj(t){return Nu[t]?.arg}function Oj(t){return Nu[t]?.format}function Ho(t){return Nu[t]?.content}function hE(t,e,r,n,i){const s=dt(Xe.MAIN);if(!w(s))return;const o=Ds(s,Re.LOADER).filter(a=>{const c=Bs(a),l=c.format,u=ye(l)?new RegExp(l).test(e):!1,h=c.event,f=ye(h)?new RegExp(h).test(r):!1;return ye(l)&&ye(h)?u&&f:ye(l)?u:ye(h)?f:!1});for(let a=0;a<o.length;++a){const c=`${Bt()}_loader`;Nu[c]={arg:t,format:e,content:n,player:i},F7(c,o[a].code)}}function fE(t,e){if(!w(t))return;const r=Fe(e),n=r.endsWith("le");switch(r){case"float32":case"float32le":{const i=t.dataview.getFloat32(t.cursor,n);return t.cursor+=4,i}case"float64":case"float64le":{const i=t.dataview.getFloat64(t.cursor,n);return t.cursor+=8,i}case"int8":case"int8le":{const i=t.dataview.getInt8(t.cursor);return t.cursor+=1,i}case"int16":case"int16le":{const i=t.dataview.getInt16(t.cursor,n);return t.cursor+=2,i}case"int32":case"int32le":{const i=t.dataview.getInt32(t.cursor,n);return t.cursor+=4,i}case"int64":case"int64le":{const i=t.dataview.getBigInt64(t.cursor,n);return t.cursor+=8,i}case"uint8":case"uint8le":{const i=t.dataview.getUint8(t.cursor);return t.cursor+=1,i}case"uint16":case"uint16le":{const i=t.dataview.getUint16(t.cursor,n);return t.cursor+=2,i}case"uint32":case"uint32le":{const i=t.dataview.getUint32(t.cursor,n);return t.cursor+=4,i}case"uint64":case"uint64le":{const i=t.dataview.getBigUint64(t.cursor,n);return t.cursor+=8,i}}}const Ij=(t,e)=>{const r=Ho(t.id());if(!w(r))return 0;const[n,i]=ue(e,0,[V.NAME]),s=Fe(n);switch(s){case"seek":{const[o]=ue(e,i,[V.NUMBER]);r.cursor=o;break}case"float32":case"float32le":case"float64":case"float64le":case"int8":case"int8le":case"int16":case"int16le":case"int32":case"int32le":case"int64":case"int64le":case"uint8":case"uint8le":case"uint16":case"uint16le":case"uint32":case"uint32le":case"uint64":case"uint64le":{const[o]=ue(e,i,[V.NAME]);t.set(o,fE(r,s));break}case"text":{const[o,a]=ue(e,i,[V.NAME,V.NAME]),c=fE(r,o);if(Ae(c)&&ye(a)){const l=new Uint8Array(r.bytes.buffer,r.cursor,c),h=new TextDecoder("utf-8").decode(l);t.set(a,h),r.cursor+=c}break}case"palette":{const[o]=ue(e,i,[V.NAME]),[a]=wp(E.book,Re.PALETTE,o),c=At(a);if(w(c)){const l=vC*Sa,u=od(new Uint8Array(r.bytes.buffer,r.cursor,l));w(u)&&(c.bits=u.bits),r.cursor+=l}break}case"charset":{const[o]=ue(e,i,[V.NAME]),[a]=wp(E.book,Re.CHARSET,o),c=At(a);if(w(c)){const l=ml*kC*qf,u=ad(new Uint8Array(r.bytes.buffer,r.cursor,l));w(u)&&(c.bits=u.bits),r.cursor+=l}break}}return 0},Go=t=>t!==null&&Object.prototype.toString.call(t)==="[object Object]",Cu=(t,e)=>{if(t===e)return!0;if(typeof t!=typeof e)return!1;if(Array.isArray(t)&&Array.isArray(e)){if(t.length!==e.length)return!1;for(let r=0;r<t.length;r+=1)if(!Cu(t[r],e[r]))return!1;return!0}if(Go(t)&&Go(e)){const r=Object.entries(t),n=new Set(Object.keys(e));if(r.length!==n.size)return!1;for(const[i,s]of r){if(!Cu(s,e[i]))return!1;n.delete(i)}return n.size===0}return!1},Lu=t=>{if(t===""||t===!1||t===null||t===void 0||Array.isArray(t)&&t.length===0)return!0;if(Go(t)){for(const e in t)if(t.hasOwnProperty(e))return!1;return!0}return!1},Nj=t=>t>="a"&&t<="z"||t>="A"&&t<="Z"||t==="_",dE=t=>t>="0"&&t<="9"||t==="-",Cj=t=>t>="a"&&t<="z"||t>="A"&&t<="Z"||t>="0"&&t<="9"||t==="_";var oe;(function(t){t.TOK_EOF="EOF",t.TOK_UNQUOTEDIDENTIFIER="UnquotedIdentifier",t.TOK_QUOTEDIDENTIFIER="QuotedIdentifier",t.TOK_RBRACKET="Rbracket",t.TOK_RPAREN="Rparen",t.TOK_COMMA="Comma",t.TOK_COLON="Colon",t.TOK_RBRACE="Rbrace",t.TOK_NUMBER="Number",t.TOK_CURRENT="Current",t.TOK_ROOT="Root",t.TOK_EXPREF="Expref",t.TOK_PIPE="Pipe",t.TOK_OR="Or",t.TOK_AND="And",t.TOK_EQ="EQ",t.TOK_GT="GT",t.TOK_LT="LT",t.TOK_GTE="GTE",t.TOK_LTE="LTE",t.TOK_NE="NE",t.TOK_FLATTEN="Flatten",t.TOK_STAR="Star",t.TOK_FILTER="Filter",t.TOK_DOT="Dot",t.TOK_NOT="Not",t.TOK_LBRACE="Lbrace",t.TOK_LBRACKET="Lbracket",t.TOK_LPAREN="Lparen",t.TOK_LITERAL="Literal"})(oe||(oe={}));const pE={"(":oe.TOK_LPAREN,")":oe.TOK_RPAREN,"*":oe.TOK_STAR,",":oe.TOK_COMMA,".":oe.TOK_DOT,":":oe.TOK_COLON,"@":oe.TOK_CURRENT,$:oe.TOK_ROOT,"]":oe.TOK_RBRACKET,"{":oe.TOK_LBRACE,"}":oe.TOK_RBRACE},Lj={"!":!0,"<":!0,"=":!0,">":!0},Mj={"	":!0,"\n":!0,"\r":!0," ":!0};class Uj{constructor(){this._current=0}tokenize(e){const r=[];this._current=0;let n,i,s;for(;this._current<e.length;)if(Nj(e[this._current]))n=this._current,i=this.consumeUnquotedIdentifier(e),r.push({start:n,type:oe.TOK_UNQUOTEDIDENTIFIER,value:i});else if(pE[e[this._current]]!==void 0)r.push({start:this._current,type:pE[e[this._current]],value:e[this._current]}),this._current+=1;else if(dE(e[this._current]))s=this.consumeNumber(e),r.push(s);else if(e[this._current]==="[")s=this.consumeLBracket(e),r.push(s);else if(e[this._current]==='"')n=this._current,i=this.consumeQuotedIdentifier(e),r.push({start:n,type:oe.TOK_QUOTEDIDENTIFIER,value:i});else if(e[this._current]==="'")n=this._current,i=this.consumeRawStringLiteral(e),r.push({start:n,type:oe.TOK_LITERAL,value:i});else if(e[this._current]==="`"){n=this._current;const o=this.consumeLiteral(e);r.push({start:n,type:oe.TOK_LITERAL,value:o})}else if(Lj[e[this._current]]!==void 0)s=this.consumeOperator(e),s&&r.push(s);else if(Mj[e[this._current]]!==void 0)this._current+=1;else if(e[this._current]==="&")n=this._current,this._current+=1,e[this._current]==="&"?(this._current+=1,r.push({start:n,type:oe.TOK_AND,value:"&&"})):r.push({start:n,type:oe.TOK_EXPREF,value:"&"});else if(e[this._current]==="|")n=this._current,this._current+=1,e[this._current]==="|"?(this._current+=1,r.push({start:n,type:oe.TOK_OR,value:"||"})):r.push({start:n,type:oe.TOK_PIPE,value:"|"});else{const o=new Error(`Unknown character: ${e[this._current]}`);throw o.name="LexerError",o}return r}consumeUnquotedIdentifier(e){const r=this._current;for(this._current+=1;this._current<e.length&&Cj(e[this._current]);)this._current+=1;return e.slice(r,this._current)}consumeQuotedIdentifier(e){const r=this._current;this._current+=1;const n=e.length;for(;e[this._current]!=='"'&&this._current<n;){let i=this._current;e[i]==="\\"&&(e[i+1]==="\\"||e[i+1]==='"')?i+=2:i+=1,this._current=i}return this._current+=1,JSON.parse(e.slice(r,this._current))}consumeRawStringLiteral(e){const r=this._current;this._current+=1;const n=e.length;for(;e[this._current]!=="'"&&this._current<n;){let s=this._current;e[s]==="\\"&&(e[s+1]==="\\"||e[s+1]==="'")?s+=2:s+=1,this._current=s}return this._current+=1,e.slice(r+1,this._current-1).replace("\\'","'")}consumeNumber(e){const r=this._current;this._current+=1;const n=e.length;for(;dE(e[this._current])&&this._current<n;)this._current+=1;const i=parseInt(e.slice(r,this._current),10);return{start:r,value:i,type:oe.TOK_NUMBER}}consumeLBracket(e){const r=this._current;return this._current+=1,e[this._current]==="?"?(this._current+=1,{start:r,type:oe.TOK_FILTER,value:"[?"}):e[this._current]==="]"?(this._current+=1,{start:r,type:oe.TOK_FLATTEN,value:"[]"}):{start:r,type:oe.TOK_LBRACKET,value:"["}}consumeOperator(e){const r=this._current,n=e[r];if(this._current+=1,n==="!")return e[this._current]==="="?(this._current+=1,{start:r,type:oe.TOK_NE,value:"!="}):{start:r,type:oe.TOK_NOT,value:"!"};if(n==="<")return e[this._current]==="="?(this._current+=1,{start:r,type:oe.TOK_LTE,value:"<="}):{start:r,type:oe.TOK_LT,value:"<"};if(n===">")return e[this._current]==="="?(this._current+=1,{start:r,type:oe.TOK_GTE,value:">="}):{start:r,type:oe.TOK_GT,value:">"};if(n==="="&&e[this._current]==="=")return this._current+=1,{start:r,type:oe.TOK_EQ,value:"=="}}consumeLiteral(e){this._current+=1;const r=this._current,n=e.length;for(;e[this._current]!=="`"&&this._current<n;){let o=this._current;e[o]==="\\"&&(e[o+1]==="\\"||e[o+1]==="`")?o+=2:o+=1,this._current=o}let i=e.slice(r,this._current).trimLeft();i=i.replace("\\`","`");const s=this.looksLikeJSON(i)?JSON.parse(i):JSON.parse(`"${i}"`);return this._current+=1,s}looksLikeJSON(e){const n=["true","false","null"],i="-0123456789";if(e==="")return!1;if('[{"'.includes(e[0])||n.includes(e))return!0;if(i.includes(e[0]))try{return JSON.parse(e),!0}catch{return!1}return!1}}const $j=new Uj,Ar={[oe.TOK_EOF]:0,[oe.TOK_UNQUOTEDIDENTIFIER]:0,[oe.TOK_QUOTEDIDENTIFIER]:0,[oe.TOK_RBRACKET]:0,[oe.TOK_RPAREN]:0,[oe.TOK_COMMA]:0,[oe.TOK_RBRACE]:0,[oe.TOK_NUMBER]:0,[oe.TOK_CURRENT]:0,[oe.TOK_EXPREF]:0,[oe.TOK_ROOT]:0,[oe.TOK_PIPE]:1,[oe.TOK_OR]:2,[oe.TOK_AND]:3,[oe.TOK_EQ]:5,[oe.TOK_GT]:5,[oe.TOK_LT]:5,[oe.TOK_GTE]:5,[oe.TOK_LTE]:5,[oe.TOK_NE]:5,[oe.TOK_FLATTEN]:9,[oe.TOK_STAR]:20,[oe.TOK_FILTER]:21,[oe.TOK_DOT]:40,[oe.TOK_NOT]:45,[oe.TOK_LBRACE]:50,[oe.TOK_LBRACKET]:55,[oe.TOK_LPAREN]:60};class Pj{constructor(){this.index=0,this.tokens=[]}parse(e){this.loadTokens(e),this.index=0;const r=this.expression(0);if(this.lookahead(0)!==oe.TOK_EOF){const n=this.lookaheadToken(0);this.errorToken(n,`Unexpected token type: ${n.type}, value: ${n.value}`)}return r}loadTokens(e){this.tokens=[...$j.tokenize(e),{type:oe.TOK_EOF,value:"",start:e.length}]}expression(e){const r=this.lookaheadToken(0);this.advance();let n=this.nud(r),i=this.lookahead(0);for(;e<Ar[i];)this.advance(),n=this.led(i,n),i=this.lookahead(0);return n}lookahead(e){return this.tokens[this.index+e].type}lookaheadToken(e){return this.tokens[this.index+e]}advance(){this.index+=1}nud(e){let r,n,i;switch(e.type){case oe.TOK_LITERAL:return{type:"Literal",value:e.value};case oe.TOK_UNQUOTEDIDENTIFIER:return{type:"Field",name:e.value};case oe.TOK_QUOTEDIDENTIFIER:const s={type:"Field",name:e.value};if(this.lookahead(0)===oe.TOK_LPAREN)throw new Error("Quoted identifier not allowed for function names.");return s;case oe.TOK_NOT:return n=this.expression(Ar.Not),{type:"NotExpression",children:[n]};case oe.TOK_STAR:return r={type:"Identity"},n=this.lookahead(0)===oe.TOK_RBRACKET&&{type:"Identity"}||this.parseProjectionRHS(Ar.Star),{type:"ValueProjection",children:[r,n]};case oe.TOK_FILTER:return this.led(e.type,{type:"Identity"});case oe.TOK_LBRACE:return this.parseMultiselectHash();case oe.TOK_FLATTEN:return r={type:oe.TOK_FLATTEN,children:[{type:"Identity"}]},n=this.parseProjectionRHS(Ar.Flatten),{type:"Projection",children:[r,n]};case oe.TOK_LBRACKET:return this.lookahead(0)===oe.TOK_NUMBER||this.lookahead(0)===oe.TOK_COLON?(n=this.parseIndexExpression(),this.projectIfSlice({type:"Identity"},n)):this.lookahead(0)===oe.TOK_STAR&&this.lookahead(1)===oe.TOK_RBRACKET?(this.advance(),this.advance(),n=this.parseProjectionRHS(Ar.Star),{children:[{type:"Identity"},n],type:"Projection"}):this.parseMultiselectList();case oe.TOK_CURRENT:return{type:oe.TOK_CURRENT};case oe.TOK_ROOT:return{type:oe.TOK_ROOT};case oe.TOK_EXPREF:return i=this.expression(Ar.Expref),{type:"ExpressionReference",children:[i]};case oe.TOK_LPAREN:const o=[];for(;this.lookahead(0)!==oe.TOK_RPAREN;)this.lookahead(0)===oe.TOK_CURRENT?(i={type:oe.TOK_CURRENT},this.advance()):i=this.expression(0),o.push(i);return this.match(oe.TOK_RPAREN),o[0];default:this.errorToken(e)}}led(e,r){let n;switch(e){case oe.TOK_DOT:const i=Ar.Dot;return this.lookahead(0)!==oe.TOK_STAR?(n=this.parseDotRHS(i),{type:"Subexpression",children:[r,n]}):(this.advance(),n=this.parseProjectionRHS(i),{type:"ValueProjection",children:[r,n]});case oe.TOK_PIPE:return n=this.expression(Ar.Pipe),{type:oe.TOK_PIPE,children:[r,n]};case oe.TOK_OR:return n=this.expression(Ar.Or),{type:"OrExpression",children:[r,n]};case oe.TOK_AND:return n=this.expression(Ar.And),{type:"AndExpression",children:[r,n]};case oe.TOK_LPAREN:const s=r.name,o=[];let a;for(;this.lookahead(0)!==oe.TOK_RPAREN;)this.lookahead(0)===oe.TOK_CURRENT?(a={type:oe.TOK_CURRENT},this.advance()):a=this.expression(0),this.lookahead(0)===oe.TOK_COMMA&&this.match(oe.TOK_COMMA),o.push(a);return this.match(oe.TOK_RPAREN),{name:s,type:"Function",children:o};case oe.TOK_FILTER:const l=this.expression(0);return this.match(oe.TOK_RBRACKET),n=this.lookahead(0)===oe.TOK_FLATTEN&&{type:"Identity"}||this.parseProjectionRHS(Ar.Filter),{type:"FilterProjection",children:[r,n,l]};case oe.TOK_FLATTEN:const u={type:oe.TOK_FLATTEN,children:[r]},h=this.parseProjectionRHS(Ar.Flatten);return{type:"Projection",children:[u,h]};case oe.TOK_EQ:case oe.TOK_NE:case oe.TOK_GT:case oe.TOK_GTE:case oe.TOK_LT:case oe.TOK_LTE:return this.parseComparator(r,e);case oe.TOK_LBRACKET:const f=this.lookaheadToken(0);return f.type===oe.TOK_NUMBER||f.type===oe.TOK_COLON?(n=this.parseIndexExpression(),this.projectIfSlice(r,n)):(this.match(oe.TOK_STAR),this.match(oe.TOK_RBRACKET),n=this.parseProjectionRHS(Ar.Star),{type:"Projection",children:[r,n]});default:return this.errorToken(this.lookaheadToken(0))}}match(e){if(this.lookahead(0)===e){this.advance();return}else{const r=this.lookaheadToken(0);this.errorToken(r,`Expected ${e}, got: ${r.type}`)}}errorToken(e,r=""){const n=new Error(r||`Invalid token (${e.type}): "${e.value}"`);throw n.name="ParserError",n}parseIndexExpression(){if(this.lookahead(0)===oe.TOK_COLON||this.lookahead(1)===oe.TOK_COLON)return this.parseSliceExpression();const e={type:"Index",value:this.lookaheadToken(0).value};return this.advance(),this.match(oe.TOK_RBRACKET),e}projectIfSlice(e,r){const n={type:"IndexExpression",children:[e,r]};return r.type==="Slice"?{children:[n,this.parseProjectionRHS(Ar.Star)],type:"Projection"}:n}parseSliceExpression(){const e=[null,null,null];let r=0,n=this.lookahead(0);for(;n!==oe.TOK_RBRACKET&&r<3;){if(n===oe.TOK_COLON)r+=1,this.advance();else if(n===oe.TOK_NUMBER)e[r]=this.lookaheadToken(0).value,this.advance();else{const i=this.lookaheadToken(0);this.errorToken(i,`Syntax error, unexpected token: ${i.value}(${i.type})`)}n=this.lookahead(0)}return this.match(oe.TOK_RBRACKET),{children:e,type:"Slice"}}parseComparator(e,r){const n=this.expression(Ar[r]);return{type:"Comparator",name:r,children:[e,n]}}parseDotRHS(e){const r=this.lookahead(0);if([oe.TOK_UNQUOTEDIDENTIFIER,oe.TOK_QUOTEDIDENTIFIER,oe.TOK_STAR].includes(r))return this.expression(e);if(r===oe.TOK_LBRACKET)return this.match(oe.TOK_LBRACKET),this.parseMultiselectList();if(r===oe.TOK_LBRACE)return this.match(oe.TOK_LBRACE),this.parseMultiselectHash();const i=this.lookaheadToken(0);this.errorToken(i,`Syntax error, unexpected token: ${i.value}(${i.type})`)}parseProjectionRHS(e){if(Ar[this.lookahead(0)]<10)return{type:"Identity"};if(this.lookahead(0)===oe.TOK_LBRACKET)return this.expression(e);if(this.lookahead(0)===oe.TOK_FILTER)return this.expression(e);if(this.lookahead(0)===oe.TOK_DOT)return this.match(oe.TOK_DOT),this.parseDotRHS(e);const r=this.lookaheadToken(0);this.errorToken(r,`Syntax error, unexpected token: ${r.value}(${r.type})`)}parseMultiselectList(){const e=[];for(;this.lookahead(0)!==oe.TOK_RBRACKET;){const r=this.expression(0);if(e.push(r),this.lookahead(0)===oe.TOK_COMMA&&(this.match(oe.TOK_COMMA),this.lookahead(0)===oe.TOK_RBRACKET))throw new Error("Unexpected token Rbracket")}return this.match(oe.TOK_RBRACKET),{type:"MultiSelectList",children:e}}parseMultiselectHash(){const e=[],r=[oe.TOK_UNQUOTEDIDENTIFIER,oe.TOK_QUOTEDIDENTIFIER];let n,i,s;for(;;){if(n=this.lookaheadToken(0),!r.includes(n.type))throw new Error(`Expecting an identifier token, got: ${n.type}`);if(i=n.value,this.advance(),this.match(oe.TOK_COLON),s=this.expression(0),e.push({value:s,type:"KeyValuePair",name:i}),this.lookahead(0)===oe.TOK_COMMA)this.match(oe.TOK_COMMA);else if(this.lookahead(0)===oe.TOK_RBRACE){this.match(oe.TOK_RBRACE);break}}return{type:"MultiSelectHash",children:e}}}const Bj=new Pj;var ge;(function(t){t[t.TYPE_NUMBER=0]="TYPE_NUMBER",t[t.TYPE_ANY=1]="TYPE_ANY",t[t.TYPE_STRING=2]="TYPE_STRING",t[t.TYPE_ARRAY=3]="TYPE_ARRAY",t[t.TYPE_OBJECT=4]="TYPE_OBJECT",t[t.TYPE_BOOLEAN=5]="TYPE_BOOLEAN",t[t.TYPE_EXPREF=6]="TYPE_EXPREF",t[t.TYPE_NULL=7]="TYPE_NULL",t[t.TYPE_ARRAY_NUMBER=8]="TYPE_ARRAY_NUMBER",t[t.TYPE_ARRAY_STRING=9]="TYPE_ARRAY_STRING"})(ge||(ge={}));class Fj{constructor(e){this.TYPE_NAME_TABLE={[ge.TYPE_NUMBER]:"number",[ge.TYPE_ANY]:"any",[ge.TYPE_STRING]:"string",[ge.TYPE_ARRAY]:"array",[ge.TYPE_OBJECT]:"object",[ge.TYPE_BOOLEAN]:"boolean",[ge.TYPE_EXPREF]:"expression",[ge.TYPE_NULL]:"null",[ge.TYPE_ARRAY_NUMBER]:"Array<number>",[ge.TYPE_ARRAY_STRING]:"Array<string>"},this.functionAbs=([r])=>Math.abs(r),this.functionAvg=([r])=>{let n=0;for(let i=0;i<r.length;i+=1)n+=r[i];return n/r.length},this.functionCeil=([r])=>Math.ceil(r),this.functionContains=r=>{const[n,i]=r;return n.includes(i)},this.functionEndsWith=r=>{const[n,i]=r;return n.includes(i,n.length-i.length)},this.functionFloor=([r])=>Math.floor(r),this.functionJoin=r=>{const[n,i]=r;return i.join(n)},this.functionKeys=([r])=>Object.keys(r),this.functionLength=([r])=>Go(r)?Object.keys(r).length:r.length,this.functionMap=r=>{if(!this._interpreter)return[];const n=[],i=this._interpreter,s=r[0],o=r[1];for(let a=0;a<o.length;a+=1)n.push(i.visit(s,o[a]));return n},this.functionMax=([r])=>{if(!r.length)return null;if(this.getTypeName(r[0])===ge.TYPE_NUMBER)return Math.max(...r);const i=r;let s=i[0];for(let o=1;o<i.length;o+=1)s.localeCompare(i[o])<0&&(s=i[o]);return s},this.functionMaxBy=r=>{const n=r[1],i=r[0],s=this.createKeyFunction(n,[ge.TYPE_NUMBER,ge.TYPE_STRING]);let o=-1/0,a,c;for(let l=0;l<i.length;l+=1)c=s&&s(i[l]),c!==void 0&&c>o&&(o=c,a=i[l]);return a},this.functionMerge=r=>{let n={};for(let i=0;i<r.length;i+=1){const s=r[i];n=Object.assign(n,s)}return n},this.functionMin=([r])=>{if(!r.length)return null;if(this.getTypeName(r[0])===ge.TYPE_NUMBER)return Math.min(...r);const i=r;let s=i[0];for(let o=1;o<i.length;o+=1)i[o].localeCompare(s)<0&&(s=i[o]);return s},this.functionMinBy=r=>{const n=r[1],i=r[0],s=this.createKeyFunction(n,[ge.TYPE_NUMBER,ge.TYPE_STRING]);let o=1/0,a,c;for(let l=0;l<i.length;l+=1)c=s&&s(i[l]),c!==void 0&&c<o&&(o=c,a=i[l]);return a},this.functionNotNull=r=>{for(let n=0;n<r.length;n+=1)if(this.getTypeName(r[n])!==ge.TYPE_NULL)return r[n];return null},this.functionReverse=([r])=>{if(this.getTypeName(r)===ge.TYPE_STRING){const s=r;let o="";for(let a=s.length-1;a>=0;a-=1)o+=s[a];return o}const i=r.slice(0);return i.reverse(),i},this.functionSort=([r])=>[...r].sort(),this.functionSortBy=r=>{if(!this._interpreter)return[];const n=r[0].slice(0);if(n.length===0)return n;const i=this._interpreter,s=r[1],o=this.getTypeName(i.visit(s,n[0]));if(o!==void 0&&![ge.TYPE_NUMBER,ge.TYPE_STRING].includes(o))throw new Error(`TypeError: unexpected type (${this.TYPE_NAME_TABLE[o]})`);const a=[];for(let c=0;c<n.length;c+=1)a.push([c,n[c]]);a.sort((c,l)=>{const u=i.visit(s,c[1]),h=i.visit(s,l[1]);if(this.getTypeName(u)!==o)throw new Error(`TypeError: expected (${this.TYPE_NAME_TABLE[o]}), received ${this.TYPE_NAME_TABLE[this.getTypeName(u)]}`);if(this.getTypeName(h)!==o)throw new Error(`TypeError: expected (${this.TYPE_NAME_TABLE[o]}), received ${this.TYPE_NAME_TABLE[this.getTypeName(h)]}`);return u>h?1:u<h?-1:c[0]-l[0]});for(let c=0;c<a.length;c+=1)n[c]=a[c][1];return n},this.functionStartsWith=([r,n])=>r.startsWith(n),this.functionSum=([r])=>r.reduce((n,i)=>n+i,0),this.functionToArray=([r])=>this.getTypeName(r)===ge.TYPE_ARRAY?r:[r],this.functionToNumber=([r])=>{const n=this.getTypeName(r);let i;return n===ge.TYPE_NUMBER?r:n===ge.TYPE_STRING&&(i=+r,!isNaN(i))?i:null},this.functionToString=([r])=>this.getTypeName(r)===ge.TYPE_STRING?r:JSON.stringify(r),this.functionType=([r])=>{switch(this.getTypeName(r)){case ge.TYPE_NUMBER:return"number";case ge.TYPE_STRING:return"string";case ge.TYPE_ARRAY:return"array";case ge.TYPE_OBJECT:return"object";case ge.TYPE_BOOLEAN:return"boolean";case ge.TYPE_EXPREF:return"expref";case ge.TYPE_NULL:return"null";default:return}},this.functionValues=([r])=>Object.values(r),this.functionTable={abs:{_func:this.functionAbs,_signature:[{types:[ge.TYPE_NUMBER]}]},avg:{_func:this.functionAvg,_signature:[{types:[ge.TYPE_ARRAY_NUMBER]}]},ceil:{_func:this.functionCeil,_signature:[{types:[ge.TYPE_NUMBER]}]},contains:{_func:this.functionContains,_signature:[{types:[ge.TYPE_STRING,ge.TYPE_ARRAY]},{types:[ge.TYPE_ANY]}]},ends_with:{_func:this.functionEndsWith,_signature:[{types:[ge.TYPE_STRING]},{types:[ge.TYPE_STRING]}]},floor:{_func:this.functionFloor,_signature:[{types:[ge.TYPE_NUMBER]}]},join:{_func:this.functionJoin,_signature:[{types:[ge.TYPE_STRING]},{types:[ge.TYPE_ARRAY_STRING]}]},keys:{_func:this.functionKeys,_signature:[{types:[ge.TYPE_OBJECT]}]},length:{_func:this.functionLength,_signature:[{types:[ge.TYPE_STRING,ge.TYPE_ARRAY,ge.TYPE_OBJECT]}]},map:{_func:this.functionMap,_signature:[{types:[ge.TYPE_EXPREF]},{types:[ge.TYPE_ARRAY]}]},max:{_func:this.functionMax,_signature:[{types:[ge.TYPE_ARRAY_NUMBER,ge.TYPE_ARRAY_STRING]}]},max_by:{_func:this.functionMaxBy,_signature:[{types:[ge.TYPE_ARRAY]},{types:[ge.TYPE_EXPREF]}]},merge:{_func:this.functionMerge,_signature:[{types:[ge.TYPE_OBJECT],variadic:!0}]},min:{_func:this.functionMin,_signature:[{types:[ge.TYPE_ARRAY_NUMBER,ge.TYPE_ARRAY_STRING]}]},min_by:{_func:this.functionMinBy,_signature:[{types:[ge.TYPE_ARRAY]},{types:[ge.TYPE_EXPREF]}]},not_null:{_func:this.functionNotNull,_signature:[{types:[ge.TYPE_ANY],variadic:!0}]},reverse:{_func:this.functionReverse,_signature:[{types:[ge.TYPE_STRING,ge.TYPE_ARRAY]}]},sort:{_func:this.functionSort,_signature:[{types:[ge.TYPE_ARRAY_STRING,ge.TYPE_ARRAY_NUMBER]}]},sort_by:{_func:this.functionSortBy,_signature:[{types:[ge.TYPE_ARRAY]},{types:[ge.TYPE_EXPREF]}]},starts_with:{_func:this.functionStartsWith,_signature:[{types:[ge.TYPE_STRING]},{types:[ge.TYPE_STRING]}]},sum:{_func:this.functionSum,_signature:[{types:[ge.TYPE_ARRAY_NUMBER]}]},to_array:{_func:this.functionToArray,_signature:[{types:[ge.TYPE_ANY]}]},to_number:{_func:this.functionToNumber,_signature:[{types:[ge.TYPE_ANY]}]},to_string:{_func:this.functionToString,_signature:[{types:[ge.TYPE_ANY]}]},type:{_func:this.functionType,_signature:[{types:[ge.TYPE_ANY]}]},values:{_func:this.functionValues,_signature:[{types:[ge.TYPE_OBJECT]}]}},this._interpreter=e}registerFunction(e,r,n){if(e in this.functionTable)throw new Error(`Function already defined: ${e}()`);this.functionTable[e]={_func:r.bind(this),_signature:n}}callFunction(e,r){const n=this.functionTable[e];if(n===void 0)throw new Error(`Unknown function: ${e}()`);return this.validateArgs(e,r,n._signature),n._func.call(this,r)}validateInputSignatures(e,r){for(let n=0;n<r.length;n+=1)if("variadic"in r[n]&&n!==r.length-1)throw new Error(`ArgumentError: ${e}() 'variadic' argument ${n+1} must occur last`)}validateArgs(e,r,n){var i,s;let o;this.validateInputSignatures(e,n);const a=n.filter(p=>{var g;return(g=!p.optional)!==null&&g!==void 0?g:!1}).length,c=(s=(i=n[n.length-1])===null||i===void 0?void 0:i.variadic)!==null&&s!==void 0?s:!1,l=r.length<a,u=r.length>n.length,h=l&&(!c&&a>1||c)?"at least ":"";if(c&&l||!c&&(l||u))throw o=n.length>1,new Error(`ArgumentError: ${e}() takes ${h}${a} argument${o&&"s"||""} but received ${r.length}`);let f,d,m;for(let p=0;p<n.length;p+=1){m=!1,f=n[p].types,d=this.getTypeName(r[p]);let g;for(g=0;g<f.length;g+=1)if(d!==void 0&&this.typeMatches(d,f[g],r[p])){m=!0;break}if(!m&&d!==void 0){const y=f.map(_=>this.TYPE_NAME_TABLE[_]).join(" | ");throw new Error(`TypeError: ${e}() expected argument ${p+1} to be type (${y}) but received type ${this.TYPE_NAME_TABLE[d]} instead.`)}}}typeMatches(e,r,n){if(r===ge.TYPE_ANY)return!0;if(r===ge.TYPE_ARRAY_STRING||r===ge.TYPE_ARRAY_NUMBER||r===ge.TYPE_ARRAY){if(r===ge.TYPE_ARRAY)return e===ge.TYPE_ARRAY;if(e===ge.TYPE_ARRAY){let i;r===ge.TYPE_ARRAY_NUMBER?i=ge.TYPE_NUMBER:r===ge.TYPE_ARRAY_STRING&&(i=ge.TYPE_STRING);for(let s=0;s<n.length;s+=1){const o=this.getTypeName(n[s]);if(o!==void 0&&i!==void 0&&!this.typeMatches(o,i,n[s]))return!1}return!0}}else return e===r;return!1}getTypeName(e){switch(Object.prototype.toString.call(e)){case"[object String]":return ge.TYPE_STRING;case"[object Number]":return ge.TYPE_NUMBER;case"[object Array]":return ge.TYPE_ARRAY;case"[object Boolean]":return ge.TYPE_BOOLEAN;case"[object Null]":return ge.TYPE_NULL;case"[object Object]":return e.jmespathType===oe.TOK_EXPREF?ge.TYPE_EXPREF:ge.TYPE_OBJECT;default:return}}createKeyFunction(e,r){if(!this._interpreter)return;const n=this._interpreter;return s=>{const o=n.visit(e,s);if(!r.includes(this.getTypeName(o))){const a=`TypeError: expected one of (${r.map(c=>this.TYPE_NAME_TABLE[c]).join(" | ")}), received ${this.TYPE_NAME_TABLE[this.getTypeName(o)]}`;throw new Error(a)}return o}}}class Dj{constructor(){this._rootValue=null,this.runtime=new Fj(this)}search(e,r){return this._rootValue=r,this.visit(e,r)}visit(e,r){let n,i,s,o,a,c,l,u,h,f,d;switch(e.type){case"Field":return r===null?null:Go(r)?(c=r[e.name],c===void 0?null:c):null;case"Subexpression":for(s=this.visit(e.children[0],r),f=1;f<e.children.length;f+=1)if(s=this.visit(e.children[1],s),s===null)return null;return s;case"IndexExpression":return l=this.visit(e.children[0],r),u=this.visit(e.children[1],l),u;case"Index":if(!Array.isArray(r))return null;let m=e.value;return m<0&&(m=r.length+m),s=r[m],s===void 0&&(s=null),s;case"Slice":if(!Array.isArray(r))return null;const p=[...e.children],g=this.computeSliceParams(r.length,p),[y,_,A]=g;if(s=[],A>0)for(f=y;f<_;f+=A)s.push(r[f]);else for(f=y;f>_;f+=A)s.push(r[f]);return s;case"Projection":if(d=this.visit(e.children[0],r),!Array.isArray(d))return null;for(h=[],f=0;f<d.length;f+=1)i=this.visit(e.children[1],d[f]),i!==null&&h.push(i);return h;case"ValueProjection":if(d=this.visit(e.children[0],r),!Go(d))return null;h=[];const T=Object.values(d);for(f=0;f<T.length;f+=1)i=this.visit(e.children[1],T[f]),i!==null&&h.push(i);return h;case"FilterProjection":if(d=this.visit(e.children[0],r),!Array.isArray(d))return null;const x=[],M=[];for(f=0;f<d.length;f+=1)n=this.visit(e.children[2],d[f]),Lu(n)||x.push(d[f]);for(let O=0;O<x.length;O+=1)i=this.visit(e.children[1],x[O]),i!==null&&M.push(i);return M;case"Comparator":switch(o=this.visit(e.children[0],r),a=this.visit(e.children[1],r),e.name){case oe.TOK_EQ:s=Cu(o,a);break;case oe.TOK_NE:s=!Cu(o,a);break;case oe.TOK_GT:s=o>a;break;case oe.TOK_GTE:s=o>=a;break;case oe.TOK_LT:s=o<a;break;case oe.TOK_LTE:s=o<=a;break;default:throw new Error(`Unknown comparator: ${e.name}`)}return s;case oe.TOK_FLATTEN:const R=this.visit(e.children[0],r);if(!Array.isArray(R))return null;let P=[];for(f=0;f<R.length;f+=1)i=R[f],Array.isArray(i)?P=[...P,...i]:P.push(i);return P;case"Identity":return r;case"MultiSelectList":if(r===null)return null;for(h=[],f=0;f<e.children.length;f+=1)h.push(this.visit(e.children[f],r));return h;case"MultiSelectHash":if(r===null)return null;h={};let W;for(f=0;f<e.children.length;f+=1)W=e.children[f],h[W.name]=this.visit(W.value,r);return h;case"OrExpression":return n=this.visit(e.children[0],r),Lu(n)&&(n=this.visit(e.children[1],r)),n;case"AndExpression":return o=this.visit(e.children[0],r),Lu(o)?o:this.visit(e.children[1],r);case"NotExpression":return o=this.visit(e.children[0],r),Lu(o);case"Literal":return e.value;case oe.TOK_PIPE:return l=this.visit(e.children[0],r),this.visit(e.children[1],l);case oe.TOK_CURRENT:return r;case oe.TOK_ROOT:return this._rootValue;case"Function":const F=[];for(let O=0;O<e.children.length;O+=1)F.push(this.visit(e.children[O],r));return this.runtime.callFunction(e.name,F);case"ExpressionReference":const G=e.children[0];return G.jmespathType=oe.TOK_EXPREF,G;default:throw new Error(`Unknown node type: ${e.type}`)}}computeSliceParams(e,r){let[n,i,s]=r;if(s===null)s=1;else if(s===0){const a=new Error("Invalid slice, step cannot be 0");throw a.name="RuntimeError",a}const o=s<0;return n=n===null?o?e-1:0:this.capSliceRange(e,n,s),i=i===null?o?-1:e:this.capSliceRange(e,i,s),[n,i,s]}capSliceRange(e,r,n){let i=r;return i<0?(i+=e,i<0&&(i=n<0?-1:0)):i>=e&&(i=n<0?e-1:e),i}}const jj=new Dj;ge.TYPE_ANY,ge.TYPE_ARRAY,ge.TYPE_ARRAY_NUMBER,ge.TYPE_ARRAY_STRING,ge.TYPE_BOOLEAN,ge.TYPE_EXPREF,ge.TYPE_NULL,ge.TYPE_NUMBER,ge.TYPE_OBJECT,ge.TYPE_STRING;function zj(t,e){const r=Bj.parse(e);return jj.search(r,t)}const Wj=(t,e)=>{const r=Ho(t.id());if(!w(r))return 0;const[n,i]=ue(e,0,[V.NAME,V.NAME]),s=zj(r.json,n);return t.set(i,s),0},Hj=(t,e)=>{const r=Ho(t.id());if(!w(r))return 0;const[n,i]=ue(e,0,[V.NAME]);switch(Fe(n)){case"seek":{const[o]=ue(e,i,[V.NUMBER]);r.cursor=jt(o,0,r.lines.length-1);break}case"line":r.cursor=jt(r.cursor+1,0,r.lines.length-1);break;default:{const o=r.lines[r.cursor]??"",c=new RegExp(n,"i").exec(o)??[];let l=1;for(let u=i;u<e.length;){const[h,f]=ue(e,u,[V.NAME]);t.set(h,c[l]??0),++l,u=f}break}}return 0};function mE(t){const e=dt(Xe.MAIN),r=Do(e);w(t.targetdir)?Xo(t.targetdir.destpt,t.label,void 0,r):w(t.targetname)&&Xo(t.targetname,t.label,void 0,r)}const Gj=vi({get(t,e){const r=Oj(t.id());if(e==="format")return[!0,r];switch(r){case"text":{const n=Ho(t.id());switch(e){case"filename":return[!0,n.filename];case"cursor":return[!0,n.cursor];case"lines":return[!0,n.lines.length]}break}case"json":{const n=Ho(t.id());switch(e){case"filename":return[!0,n.filename]}break}case"binary":{const n=Ho(t.id());switch(e){case"filename":return[!0,n.filename];case"cursor":return[!0,n.cursor];case"bytes":return[!0,n.bytes.length]}break}}return[!1,void 0]}}).command("shortsend",(t,e)=>{const r=Mi(e);return mE(r),0}).command("send",(t,e)=>{const r=Mi(e,!0);return mE(r),0}).command("stat",()=>0).command("text",(t,e)=>{const r=e.map(Pt).join(" ");return Ft(ce,E.elementfocus,"$175",r),0}).command("hyperlink",(t,e)=>{const[r,...n]=e,i=Pt(r),s=Mi(n);return w(s.targetname)&&Ft(ce,E.elementfocus,"$175",`!${s.targetname}${s.label};${i}`),0}).command("readline",Hj).command("readjson",Wj).command("readbin",Ij).command("withboard",(t,e)=>{const[r]=ue(e,0,[V.STRING]),n=pr(r);return w(n)&&(E.board=n,E.element={x:-1,y:-1}),0});function gE(t,e,r,n,i,s){const o=[];for(let a=s;a<i.length;){const[c,l]=ue(i,a,[V.ANY]);ut(c)&&!nn(c)&&!ac(c)&&!Iu(c)&&!Sr(c)?o.push(...c):o.push(c),a=l}switch(Fe(n)){case"get":case"post:json":TR(ce,E.elementfocus,t,e,r,n,o);break}return 0}const Kj=vi().command("fetch",(t,e)=>{const[r,n,i="get",s]=ue(e,0,[V.NAME,V.NAME,V.MAYBE_STRING]);return gE(void 0,r,n,i,e,s),0}).command("fetchwith",(t,e)=>{const[r,n,i,s="get",o]=ue(e,0,[V.ANY,V.NAME,V.NAME,V.MAYBE_STRING]);return gE(r,n,i,s,e,o),0}).command("chat",(t,e)=>{const[r]=ue(e,0,[V.MAYBE_NAME]);return r?ER(ce,E.elementfocus,r):AR(ce,E.elementfocus),0}).command("broadcast",(t,e)=>{const[r]=ue(e,0,[V.MAYBE_NAME]);return r?vR(ce,E.elementfocus,r):xR(ce,E.elementfocus),0});function cc(t,e,r){if(w(E.board)){switch(r){case"shot":case"bombed":He(e,"breakable")&&gr(E.board,e,E.timestamp);break}w(e?.id)&&t.send(E.elementfocus,e.id,r)}}function yE(t,e){if(w(e.targetname)){const r=Object.keys(E.board?.objects??{});switch(e.targetname){case"all":for(let n=0;n<r.length;++n){const i=r[n],s=mr(E.board,i);w(s)&&cc(t,s,e.label)}break;case"others":for(let n=0;n<r.length;++n){const i=r[n],s=mr(E.board,i);i!==t.id()&&w(s)&&cc(t,s,e.label)}break;case"self":E.elementid!==t.id()?t.send(E.elementfocus,E.elementid,e.label):t.message({session:ce.session(),player:E.elementfocus,id:Bt(),sender:E.elementid,target:e.label});break;default:{const n=yT(E.board,[e.targetname]);for(let i=0;i<n.length;++i){const s=n[i];w(s)&&cc(t,s,e.label)}break}}}else if(w(e.targetdir))if(e.targetdir.targets.length)for(let r=0;r<e.targetdir.targets.length;++r){const n=it(E.board,e.targetdir.targets[r]);w(n)&&cc(t,n,e.label)}else{const r=it(E.board,e.targetdir.destpt);w(r)&&cc(t,r,e.label)}}const qj=vi({set(t,e,r){return iW(t,e,r),[!1,void 0]},aftertick(){const t=Zt(E.elementid),[e]=t;if(t.length===1&&ye(e)){if(w(E.element))if(e.trim().length===0){const r=Rt(E.elementid);r.sidebar=[]}else E.element.tickertext=e,E.element.tickertime=E.timestamp}else if(t.length>1)if(E.elementisplayer){const r=Rt(E.elementid);r.sidebar=ST(t)}else{const r=Rt(E.elementfocus);r.scrollname=E.element?.name??E.element?.kinddata?.name??"",r.scroll=ST(t)}}}).command("shortsend",(t,e)=>{const r=Mi(e);return yE(t,r),0}).command("send",(t,e)=>{const r=Mi(e,!0);return yE(t,r),0}).command("stat",()=>0).command("text",(t,e)=>{const r=e.map(Pt).join("");return Ie(E.elementid,r),0}).command("hyperlink",(t,e)=>{const[r,...n]=e,i=Pt(r),s=Mi(n);return w(s.targetname)&&Be(E.elementid,t.id(),i,`${s.targetname}:${s.label}`.split(" "),t.get,t.set),0});function Yj(t,e,r,n,i){if(!w(E.book))return;const s=E.book,o=Nr(s,Re.BOARD,t),a=At(o);if(!w(a))return;const c=Zu(),l=i==="all"||i==="object",u=i==="all"||i==="terrain";hr(a),hr(c);const h=-Math.tan(e*.5),f=Math.sin(e),d=Math.round(12.5*h),m=Math.round(12.5*f),p=new Array(nt).fill(0);o_(d,0,-d,nt-1).forEach(T=>{T.x<0?p[T.y]=Math.min(p[T.y],T.x):p[T.y]=Math.max(p[T.y],T.x)});const y=new Array(Ue).fill(0);o_(0,m,Ue-1,-m).forEach(T=>{T.y<0?y[T.x]=Math.min(y[T.x],T.y):y[T.x]=Math.max(y[T.x],T.y)});const A=[p,y,p];for(let T=0;T<A.length;++T){const x=A[T];if(T!==1){for(let M=0;M<nt;++M){const R=x[M],P=M*Ue;for(let W=0;W<Ue;W++){const F=(W+R+Ue)%Ue;u&&(c.terrain[F+P]=a.terrain[W+P])}}if(l){const M=Object.keys(a.objects);for(let R=0;R<M.length;++R){const P=M[R],{x:W,y:F}=a.objects[P];if(w(W)&&w(F)){const G=x[F];a.objects[P].x=(W+G+Ue)%Ue,a.objects[P].lx=a.objects[P].x}}}}if(T===1){for(let M=0;M<Ue;++M){const R=x[M];for(let P=0;P<nt;++P){const W=(P+R+nt)%nt;u&&(c.terrain[M+W*Ue]=a.terrain[M+P*Ue])}}if(l){const M=Object.keys(a.objects);for(let R=0;R<M.length;++R){const P=M[R],{x:W,y:F}=a.objects[P];if(w(W)&&w(F)){const G=x[W];a.objects[P].y=(F+G+nt)%nt,a.objects[P].ly=a.objects[P].y}}}}u&&(a.terrain=[...c.terrain]),delete c.named,delete c.lookup,delete a.named,delete a.lookup,hr(c),hr(a)}}var zp,_E;function Vj(){if(_E)return zp;_E=1;function t(e,r){let n=0,i=0,s=0;for(;s<e.length;s++)n+=e[s];for(s=0,r*=n;r&&s<e.length;){if(i+=e[s],r<=i)return s;s++}return 0}return zp=t,zp}var Wp,bE;function wE(){if(bE)return Wp;bE=1;const t=Vj(),e=function(){};return e.prototype.FMX=0,e.prototype.FMY=0,e.prototype.FMXxFMY=0,e.prototype.T=0,e.prototype.N=0,e.prototype.initiliazedField=!1,e.prototype.generationComplete=!1,e.prototype.wave=null,e.prototype.compatible=null,e.prototype.weightLogWeights=null,e.prototype.sumOfWeights=0,e.prototype.sumOfWeightLogWeights=0,e.prototype.startingEntropy=0,e.prototype.sumsOfOnes=null,e.prototype.sumsOfWeights=null,e.prototype.sumsOfWeightLogWeights=null,e.prototype.entropies=null,e.prototype.propagator=null,e.prototype.observed=null,e.prototype.distribution=null,e.prototype.stack=null,e.prototype.stackSize=0,e.prototype.DX=[-1,0,1,0],e.prototype.DY=[0,1,0,-1],e.prototype.opposite=[2,3,0,1],e.prototype.initialize=function(){this.distribution=new Array(this.T),this.wave=new Array(this.FMXxFMY),this.compatible=new Array(this.FMXxFMY);for(let r=0;r<this.FMXxFMY;r++){this.wave[r]=new Array(this.T),this.compatible[r]=new Array(this.T);for(let n=0;n<this.T;n++)this.compatible[r][n]=[0,0,0,0]}this.weightLogWeights=new Array(this.T),this.sumOfWeights=0,this.sumOfWeightLogWeights=0;for(let r=0;r<this.T;r++)this.weightLogWeights[r]=this.weights[r]*Math.log(this.weights[r]),this.sumOfWeights+=this.weights[r],this.sumOfWeightLogWeights+=this.weightLogWeights[r];this.startingEntropy=Math.log(this.sumOfWeights)-this.sumOfWeightLogWeights/this.sumOfWeights,this.sumsOfOnes=new Array(this.FMXxFMY),this.sumsOfWeights=new Array(this.FMXxFMY),this.sumsOfWeightLogWeights=new Array(this.FMXxFMY),this.entropies=new Array(this.FMXxFMY),this.stack=new Array(this.FMXxFMY*this.T),this.stackSize=0},e.prototype.observe=function(r){let n=1e3,i=-1;for(let a=0;a<this.FMXxFMY;a++){if(this.onBoundary(a%this.FMX,a/this.FMX|0))continue;const c=this.sumsOfOnes[a];if(c===0)return!1;const l=this.entropies[a];if(c>1&&l<=n){const u=1e-6*r();l+u<n&&(n=l+u,i=a)}}if(i===-1){this.observed=new Array(this.FMXxFMY);for(let a=0;a<this.FMXxFMY;a++)for(let c=0;c<this.T;c++)if(this.wave[a][c]){this.observed[a]=c;break}return!0}for(let a=0;a<this.T;a++)this.distribution[a]=this.wave[i][a]?this.weights[a]:0;const s=t(this.distribution,r()),o=this.wave[i];for(let a=0;a<this.T;a++)o[a]!==(a===s)&&this.ban(i,a);return null},e.prototype.propagate=function(){for(;this.stackSize>0;){const r=this.stack[this.stackSize-1];this.stackSize--;const n=r[0],i=n%this.FMX,s=n/this.FMX|0;for(let o=0;o<4;o++){const a=this.DX[o],c=this.DY[o];let l=i+a,u=s+c;if(this.onBoundary(l,u))continue;l<0?l+=this.FMX:l>=this.FMX&&(l-=this.FMX),u<0?u+=this.FMY:u>=this.FMY&&(u-=this.FMY);const h=l+u*this.FMX,f=this.propagator[o][r[1]],d=this.compatible[h];for(let m=0;m<f.length;m++){const p=f[m],g=d[p];g[o]--,g[o]==0&&this.ban(h,p)}}}},e.prototype.singleIteration=function(r){const n=this.observe(r);return n!==null?(this.generationComplete=n,!!n):(this.propagate(),null)},e.prototype.iterate=function(r,n){this.wave||this.initialize(),this.initiliazedField||this.clear(),r=r||0,n=n||Math.random;for(let i=0;i<r||r===0;i++){const s=this.singleIteration(n);if(s!==null)return!!s}return!0},e.prototype.generate=function(r){for(r=r||Math.random,this.wave||this.initialize(),this.clear();;){const n=this.singleIteration(r);if(n!==null)return!!n}},e.prototype.isGenerationComplete=function(){return this.generationComplete},e.prototype.ban=function(r,n){const i=this.compatible[r][n];for(let o=0;o<4;o++)i[o]=0;this.wave[r][n]=!1,this.stack[this.stackSize]=[r,n],this.stackSize++,this.sumsOfOnes[r]-=1,this.sumsOfWeights[r]-=this.weights[n],this.sumsOfWeightLogWeights[r]-=this.weightLogWeights[n];const s=this.sumsOfWeights[r];this.entropies[r]=Math.log(s)-this.sumsOfWeightLogWeights[r]/s},e.prototype.clear=function(){for(let r=0;r<this.FMXxFMY;r++){for(let n=0;n<this.T;n++){this.wave[r][n]=!0;for(let i=0;i<4;i++)this.compatible[r][n][i]=this.propagator[this.opposite[i]][n].length}this.sumsOfOnes[r]=this.weights.length,this.sumsOfWeights[r]=this.sumOfWeights,this.sumsOfWeightLogWeights[r]=this.sumOfWeightLogWeights,this.entropies[r]=this.startingEntropy}this.initiliazedField=!0,this.generationComplete=!1},Wp=e,Wp}var Hp,kE;function Xj(){if(kE)return Hp;kE=1;const t=wE(),e=function(n,i,s,o,a,c,l,u,h,f){f=f||0,this.N=o,this.FMX=a,this.FMY=c,this.FMXxFMY=a*c,this.periodic=u;const d=i,m=new Array(d);for(let G=0;G<d;G++)m[G]=new Array(s);this.colors=[];const p={};for(let G=0;G<s;G++)for(let O=0;O<i;O++){const I=(G*i+O)*4,k=[n[I],n[I+1],n[I+2],n[I+3]],C=k.join("-");p.hasOwnProperty(C)||(p[C]=this.colors.length,this.colors.push(k)),m[O][G]=p[C]}const g=this.colors.length,y=Math.pow(g,o*o),_=function(O){let I=new Array(o*o);for(let k=0;k<o;k++)for(let C=0;C<o;C++)I[C+k*o]=O(C,k);return I},A=function(O,I){return _(function(k,C){return m[(O+k)%i][(I+C)%s]})},T=function(O){return _(function(I,k){return O[o-1-k+I*o]})},x=function(O){return _(function(I,k){return O[o-1-I+k*o]})},M=function(O){let I=0,k=1;for(let C=0;C<O.length;C++)I+=O[O.length-1-C]*k,k*=g;return I},R=function(O){let I=O,k=y;const C=new Array(o*o);for(let z=0;z<C.length;z++){k/=g;let B=0;for(;I>=k;)I-=k,B++;C[z]=B}return C},P={},W=[];for(let G=0;G<(l?s:s-o+1);G++)for(let O=0;O<(l?i:i-o+1);O++){const I=new Array(8);I[0]=A(O,G),I[1]=x(I[0]),I[2]=T(I[0]),I[3]=x(I[2]),I[4]=T(I[2]),I[5]=x(I[4]),I[6]=T(I[4]),I[7]=x(I[6]);for(let k=0;k<h;k++){const C=M(I[k]);P[C]?P[C]++:(W.push(C),P[C]=1)}}this.T=W.length,this.ground=(f+this.T)%this.T,this.patterns=new Array(this.T),this.weights=new Array(this.T);for(let G=0;G<this.T;G++){const O=parseInt(W[G],10);this.patterns[G]=R(O),this.weights[G]=P[O]}const F=function(O,I,k,C){const z=k<0?0:k,B=k<0?k+o:o,Q=C<0?0:C,Y=C<0?C+o:o;for(let N=Q;N<Y;N++)for(let U=z;U<B;U++)if(O[U+o*N]!=I[U-k+o*(N-C)])return!1;return!0};this.propagator=new Array(4);for(let G=0;G<4;G++){this.propagator[G]=new Array(this.T);for(let O=0;O<this.T;O++){const I=[];for(let k=0;k<this.T;k++)F(this.patterns[O],this.patterns[k],this.DX[G],this.DY[G])&&I.push(k);this.propagator[G][O]=I}}};return e.prototype=Object.create(t.prototype),e.prototype.constructor=e,e.prototype.onBoundary=function(r,n){return!this.periodic&&(r+this.N>this.FMX||n+this.N>this.FMY||r<0||n<0)},e.prototype.clear=function(){if(t.prototype.clear.call(this),this.ground!==0){for(let r=0;r<this.FMX;r++){for(let n=0;n<this.T;n++)n!==this.ground&&this.ban(r+(this.FMY-1)*this.FMX,n);for(let n=0;n<this.FMY-1;n++)this.ban(r+n*this.FMX,this.ground)}this.propagate()}},e.prototype.graphics=function(r){return r=r||new Uint8Array(this.FMXxFMY*4),this.isGenerationComplete()?this.graphicsComplete(r):this.graphicsIncomplete(r),r},e.prototype.graphicsComplete=function(r){for(let n=0;n<this.FMY;n++){const i=n<this.FMY-this.N+1?0:this.N-1;for(let s=0;s<this.FMX;s++){const o=s<this.FMX-this.N+1?0:this.N-1,a=(n*this.FMX+s)*4,c=this.colors[this.patterns[this.observed[s-o+(n-i)*this.FMX]][o+i*this.N]];r[a]=c[0],r[a+1]=c[1],r[a+2]=c[2],r[a+3]=c[3]}}},e.prototype.graphicsIncomplete=function(r){for(let n=0;n<this.FMXxFMY;n++){const i=n%this.FMX,s=n/this.FMX|0;let o=0,a=0,c=0,l=0,u=0;for(let f=0;f<this.N;f++)for(let d=0;d<this.N;d++){let m=i-d;m<0&&(m+=this.FMX);let p=s-f;if(p<0&&(p+=this.FMY),this.onBoundary(m,p))continue;const g=m+p*this.FMX;for(let y=0;y<this.T;y++)if(this.wave[g][y]){o++;const _=this.colors[this.patterns[y][d+f*this.N]];a+=_[0],c+=_[1],l+=_[2],u+=_[3]}}const h=n*4;r[h]=a/o,r[h+1]=c/o,r[h+2]=l/o,r[h+3]=u/o}},Hp=e,Hp}var Gp,vE;function Zj(){if(vE)return Gp;vE=1;const t=wE(),e=function(n,i,s,o,a){const c=n.tilesize||16;this.FMX=s,this.FMY=o,this.FMXxFMY=s*o,this.periodic=a,this.tilesize=c;const l=!!n.unique;let u=null;i&&n.subsets&&n.subsets[i]&&(u=n.subsets[i]);const h=function(M){const R=new Array(c*c);for(let P=0;P<c;P++)for(let W=0;W<c;W++)R[W+P*c]=M(W,P);return R},f=function(M){return h(function(R,P){return M[c-1-P+R*c]})},d=function(M){return h(function(R,P){return M[c-1-R+P*c]})};this.tiles=[];const m=[],p=[],g={};let y,_,A;for(let x=0;x<n.tiles.length;x++){const M=n.tiles[x];if(u!==null&&u.indexOf(M.name)===-1)continue;switch(M.symmetry){case"L":A=4,y=function(P){return(P+1)%4},_=function(P){return P%2===0?P+1:P-1};break;case"T":A=4,y=function(P){return(P+1)%4},_=function(P){return P%2===0?P:4-P};break;case"I":A=2,y=function(P){return 1-P},_=function(P){return P};break;case"\\":A=2,y=function(P){return 1-P},_=function(P){return 1-P};break;case"F":A=8,y=function(P){return P<4?(P+1)%4:4+(P-1)%4},_=function(P){return P<4?P+4:P-4};break;default:A=1,y=function(P){return P},_=function(P){return P};break}this.T=p.length,g[M.name]=this.T;for(let P=0;P<A;P++)p.push([this.T+P,this.T+y(P),this.T+y(y(P)),this.T+y(y(y(P))),this.T+_(P),this.T+_(y(P)),this.T+_(y(y(P))),this.T+_(y(y(y(P))))]);let R;if(l)for(let P=0;P<A;P++)R=M.bitmap[P],this.tiles.push(h(function(W,F){return[R[(c*F+W)*4],R[(c*F+W)*4+1],R[(c*F+W)*4+2],R[(c*F+W)*4+3]]}));else{R=M.bitmap,this.tiles.push(h(function(P,W){return[R[(c*W+P)*4],R[(c*W+P)*4+1],R[(c*W+P)*4+2],R[(c*W+P)*4+3]]}));for(let P=1;P<A;P++)this.tiles.push(P<4?f(this.tiles[this.T+P-1]):d(this.tiles[this.T+P-4]))}for(let P=0;P<A;P++)m.push(M.weight||1)}this.T=p.length,this.weights=m,this.propagator=new Array(4);const T=new Array(4);for(let x=0;x<4;x++){this.propagator[x]=new Array(this.T),T[x]=new Array(this.T);for(let M=0;M<this.T;M++){T[x][M]=new Array(this.T);for(let R=0;R<this.T;R++)T[x][M][R]=!1}}for(let x=0;x<n.neighbors.length;x++){const M=n.neighbors[x],R=M.left.split(" ").filter(function(I){return I.length}),P=M.right.split(" ").filter(function(I){return I.length});if(u!==null&&(u.indexOf(R[0])===-1||u.indexOf(P[0])===-1))continue;const W=p[g[R[0]]][R.length==1?0:parseInt(R[1],10)],F=p[W][1],G=p[g[P[0]]][P.length==1?0:parseInt(P[1],10)],O=p[G][1];T[0][G][W]=!0,T[0][p[G][6]][p[W][6]]=!0,T[0][p[W][4]][p[G][4]]=!0,T[0][p[W][2]][p[G][2]]=!0,T[1][O][F]=!0,T[1][p[F][6]][p[O][6]]=!0,T[1][p[O][4]][p[F][4]]=!0,T[1][p[F][2]][p[O][2]]=!0}for(let x=0;x<this.T;x++)for(let M=0;M<this.T;M++)T[2][x][M]=T[0][M][x],T[3][x][M]=T[1][M][x];for(let x=0;x<4;x++)for(let M=0;M<this.T;M++){const R=[],P=T[x][M];for(let W=0;W<this.T;W++)P[W]&&R.push(W);this.propagator[x][M]=R}};return e.prototype=Object.create(t.prototype),e.prototype.constructor=e,e.prototype.onBoundary=function(r,n){return!this.periodic&&(r<0||n<0||r>=this.FMX||n>=this.FMY)},e.prototype.graphics=function(r,n){return r=r||new Uint8Array(this.FMXxFMY*this.tilesize*this.tilesize*4),this.isGenerationComplete()?this.graphicsComplete(r):this.graphicsIncomplete(r,n),r},e.prototype.graphicsComplete=function(r){for(let n=0;n<this.FMX;n++)for(let i=0;i<this.FMY;i++){const s=this.tiles[this.observed[n+i*this.FMX]];for(let o=0;o<this.tilesize;o++)for(let a=0;a<this.tilesize;a++){const c=(n*this.tilesize+a+(i*this.tilesize+o)*this.FMX*this.tilesize)*4,l=s[a+o*this.tilesize];r[c]=l[0],r[c+1]=l[1],r[c+2]=l[2],r[c+3]=l[3]}}},e.prototype.graphicsIncomplete=function(r,n){(!n||n.length!==4)&&(n=!1);for(let i=0;i<this.FMX;i++)for(let s=0;s<this.FMY;s++){const o=this.wave[i+s*this.FMX];let a=0,c=0;for(let u=0;u<this.T;u++)o[u]&&(a++,c+=this.weights[u]);const l=1/c;for(let u=0;u<this.tilesize;u++)for(let h=0;h<this.tilesize;h++){const f=(i*this.tilesize+h+(s*this.tilesize+u)*this.FMX*this.tilesize)*4;if(n&&a===this.T)r[f]=n[0],r[f+1]=n[1],r[f+2]=n[2],r[f+3]=n[3];else{let d=0,m=0,p=0,g=0;for(let y=0;y<this.T;y++)if(o[y]){const _=this.tiles[y][h+u*this.tilesize],A=this.weights[y]*l;d+=_[0]*A,m+=_[1]*A,p+=_[2]*A,g+=_[3]*A}r[f]=d,r[f+1]=m,r[f+2]=p,r[f+3]=g}}}},Gp=e,Gp}var Kp,xE;function Jj(){return xE||(xE=1,Kp={OverlappingModel:Xj(),SimpleTiledModel:Zj()}),Kp}var Qj=Jj(),ez=fs(Qj);const EE=5;function AE(t,e,r,n,i,s,o){if(!w(E.book))return!1;const a=E.book,c=Nr(a,Re.BOARD,t),l=Nr(a,Re.BOARD,e),u=At(c),h=At(l);if(!w(u)||!w(h))return!1;hr(u),hr(h);let f=0;const d=new Map,m=new Map;let p=0;const g=32,y=new Uint8Array(Kf*4);for(let R=0;R<nt;++R)for(let P=0;P<Ue;++P){const W=it(h,{x:P,y:R}),F=W?.char??0,G=W?.color??g,O=W?.bg??g;y[p++]=F,y[p++]=G,y[p++]=O;const I=xn(W),k=Fe(I?.name??"empty"),C=d.get(k);Ae(C)?y[p++]=C:(d.set(k,f),m.set(f,k),y[p++]=f++)}const _=s.x-i.x+1,A=s.y-i.y+1,T=new ez.OverlappingModel(y,Ue,nt,r,_,A,!1,!1,n,0);let x=0;for(;x<EE&&!T.generate();++x);if(x===EE)return!1;p=0;const M=T.graphics();for(let R=i.y;R<=s.y;++R)for(let P=i.x;P<=s.x;++P){const W={x:P,y:R},F=M[p++],G=M[p++],O=M[p++];switch(f=M[p++],o){case"all":{const z=it(u,{x:P,y:R});Wt(z)&&gr(u,z,a.timestamp),St(u,{x:P,y:R});break}case"object":{const z=it(u,{x:P,y:R});Wt(z)&&gr(u,z,a.timestamp);break}case"terrain":St(u,{x:P,y:R});break}let I=m.get(f)??"";const k=xn({kind:I});switch(o){case"all":break;case"object":Wt(k)||(I="");break;case"terrain":Wt(k)&&(I="");break;default:if(He(k,"group")!==o&&(I=""),I){const z=it(u,{x:P,y:R});Wt(z)&&gr(u,z,a.timestamp),St(u,{x:P,y:R})}break}const C=I?un(u,[I],W):void 0;if(!(!w(C)||!w(k))&&(zs(C,k),F>0&&(C.char=F),G<g&&(C.color=G),O<g&&(C.bg=O),Wt(C))){const z=mn(Zo(h,I));w(z)&&(St(u,{...Pi(h,z.x??0,z.y??0),x:P,y:R}),zs(C,z))}}return!0}function TE(t){return`zss_snapshot_${t}`}const SE={x:0,y:0},RE={x:Ue-1,y:nt-1},OE="all";function tz(t){const e=Nr(E.book,Re.BOARD,t),r=At(e);if(!w(r))return;const n=TE(r.id);Lx(E.book,n);const[i]=is(Xe.MAIN,n,Re.BOARD),s=At(i);if(w(s))return vu(t,s.id,SE,RE,OE),s}function rz(t){const e=Nr(E.book,Re.BOARD,t),r=At(e);if(!w(r))return;const n=TE(r.id),i=Nr(E.book,Re.BOARD,n),s=At(i);if(w(s))return vu(s.id,t,SE,RE,OE),s}function nz(t,e,r,n,i,s){switch(s){case"all":case"object":case"terrain":break;default:return iz(t,e,i,s)}if(!w(E.book))return;const o=E.book,a=Nr(o,Re.BOARD,t),c=At(a);if(!w(c))return;const l=Zu();hr(c);for(let u=r.y;u<=n.y;++u)for(let h=r.x;h<=n.x;++h){let f=!1,d=!1;switch(s){case"all":f=!0,d=!0;break;case"object":f=!0;break;case"terrain":d=!0;break}const m=(h+e.x+Ue)%Ue,p=(u+e.y+nt)%nt;if(f){const g=it(c,{x:h,y:u});Wt(g)&&w(g?.x)&&w(g?.y)&&(g.x=m,g.lx=m,g.y=p,g.ly=p)}d&&(l.terrain[m+p*Ue]=c.terrain[h+u*Ue])}(s==="all"||s==="terrain")&&(c.terrain=[...l.terrain]),ic(c)}function iz(t,e,r,n){if(!w(E.book))return;const i=E.book,s=Nr(i,Re.BOARD,t),o=At(s);if(!w(o))return;hr(o);const{terrainelements:a,objectelements:c}=$x(o,r,n);if(a.length===0&&c.length===0)return;const l=c.map(p=>p.id??""),u=a.map(p=>tn({x:p.x??0,y:p.y??0},Ue)),h=[],f=[];for(let p=0;p<a.length;++p){const g=a[p],y={x:g.x??-1,y:g.y??-1},_=it(o,y);w(_)&&Wt(_)&&(h.push(_.id??""),h.push(_.id??""),f.push(tn({x:_.x??0,y:_.y??0},Ue)))}let d=!1;for(let p=0;p<a.length;++p){const g=a[p],y=He(g,"collision"),_={x:g.x??-1,y:g.y??-1},A=tn(_,Ue),T={x:_.x+e.x,y:_.y+e.y};if(ss(T)){const x=it(o,T),M=x?.id??"",R=tn({x:x?.x??0,y:x?.y??0},Ue),P=He(x,"collision");if(w(x)&&Wt(x)&&h.includes(M)!==!0&&l.includes(M)!==!0){let W=!1;const F=f.includes(A),G=F?it(o,_):void 0,O=F?He(G,"pushable"):!1,I=F&&O;if(nm(g,x)&&(y!==We.ISWALK||F)){let k=F;w(G)&&O&&(d=zn(i,o,G,{x:(G.x??0)-e.x,y:(G.y??0)-e.y})!==!0,d||(k=!1)),(k||y!==We.ISWALK)&&(d=zn(i,o,x,{x:(x.x??0)+e.x,y:(x.y??0)+e.y})!==!0,d&&(W=I))}else(y!==We.ISWALK||I)&&(d=!0,W=I);W&&w(G)&&(d=zn(i,o,G,{x:(G.x??0)-e.x,y:(G.y??0)-e.y})!==!0)}else P===We.ISSOLID&&u.includes(R)===!1&&(d=!0)}else d=!0}if(d)return;for(let p=0;p<c.length;++p){const g=c[p],y=He(g,"collision"),_={x:g.x??0,y:g.y??0},A={x:_.x+e.x,y:_.y+e.y};if(ss(A)){const T=it(o,A),x=T?.id??"",M=He(T,"collision"),R=He(T,"group");w(T)&&Wt(T)&&h.includes(x)&&l.includes(x)!==!0?nm(g,T)?d=zn(i,o,T,A)!==!0:d=!0:pc(y,M)&&n!==R&&(d=!0)}else d=!0}if(d)return;(e.x>0||e.y>0)&&a.reverse();for(let p=0;p<a.length;++p){const g=a[p],y={x:g.x??-1,y:g.y??-1},_={x:y.x+e.x,y:y.y+e.y},A=Pi(o,_.x,_.y);if(w(g)&&w(A)){St(o,{...g,x:_.x,y:_.y}),St(o,{...A,x:y.x,y:y.y});const T=it(o,y);Wt(T)&&w(T)&&(T.x=(T.x??0)+e.x,T.y=(T.y??0)+e.y,T.lx=(T.lx??0)+e.x,T.ly=(T.ly??0)+e.y)}}ic(o);for(let p=0;p<c.length;++p){const g=c[p],y={x:g.x??-1,y:g.y??-1},_={x:y.x+e.x,y:y.y+e.y};if(!zn(i,o,g,_))break}ic(o)}function Mu(t,e){let r="all";const n={x:0,y:0},i={x:Ue-1,y:nt-1};for(let s=e;s<t.length;){const[o,a]=ue(t,s,[V.MAYBE_NUMBER_OR_STRING]);if(ye(o))r=Fe(o),s=a;else if(Ae(o)){const[c,l,u,h]=ue(t,a,[V.NUMBER,V.MAYBE_NUMBER,V.MAYBE_NUMBER]);n.x=Math.min(o,l??o),n.y=Math.min(c,u??c),i.x=Math.max(o,l??o),i.y=Math.max(c,u??c),s=h}else break}return{targetset:r,pt1:n,pt2:i}}function IE(t,e){const r=ln();for(let n=0;n<r.length;++n){const i=r[n],s=mn(kp(i,t,e));if(w(s))return s}}const sz=vi().command("snapshot",()=>(!w(E.book)||!w(E.board)||tz(E.board.id),0)).command("revert",()=>(!w(E.book)||!w(E.board)||rz(E.board.id),0)).command("copy",(t,e)=>{if(!w(E.book)||!w(E.board))return 0;const[r,n]=ue(e,0,[V.STRING]),i=IE(Re.BOARD,r);if(w(i)){const s=Mu(e,n);vu(i.id,E.board.id,s.pt1,s.pt2,s.targetset)}return 0}).command("remix",(t,e)=>{if(!w(E.book)||!w(E.board))return 0;const[r,n,i,s]=ue(e,0,[V.STRING,V.NUMBER,V.NUMBER]),o=IE(Re.BOARD,r);if(w(o)){const a=Mu(e,s);AE(E.board.id,o.id,n,i,a.pt1,a.pt2,a.targetset)}return 0}).command("weave",(t,e)=>{if(!w(E.book)||!w(E.board))return 0;const[r,n]=ue(e,0,[V.DIR]),i={x:r.destpt.x-(E.element?.x??0),y:r.destpt.y-(E.element?.y??0)},s=Mu(e,n);return nz(E.board.id,i,s.pt1,s.pt2,E.elementid,s.targetset),0}).command("pivot",(t,e)=>{if(!w(E.book)||!w(E.board))return 0;const[r,n]=ue(e,0,[V.NUMBER]),i=Mu(e,n);return Yj(E.board.id,d_(r),i.pt1,i.pt2,i.targetset),0});var rs=(t=>(t[t.ERROR=0]="ERROR",t[t.CLI=1]="CLI",t[t.LOADER=2]="LOADER",t[t.RUNTIME=3]="RUNTIME",t))(rs||{});const oz={audio:yl,board:lB,cli:_j,display:bj,element:Sj,runtime:qj,loader:Gj,network:Kj,transform:sz},qp=["audio","board","display","network","transform","element"],az={0:[],1:["cli",...qp],2:["loader",...qp],3:["runtime",...qp]},cz={0:new Map,1:new Map,2:new Map,3:new Map};function Ko(t){return(az[t]??[]).map(r=>oz[r]).filter(w)}function Yp(t){const e=[],r=Ko(t);for(let n=0;n<r.length;++n)e.push(...r[n].listcommands());return e}function lz(t,e){const r=cz[t];if(!r.has(e)){let n;const i=Ko(t);for(let s=0;s<i.length&&(n=i[s].getcommand(e),!w(n));++s);r.set(e,n)}return r.get(e)}function uz(t,e,r){const n=Ko(t);for(let i=0;i<n.length;++i){const s=n[i];if(s.get!==void 0){const[o,a]=s.get(e,r);if(o)return[o,a]}}return[!1,void 0]}function hz(t,e,r,n){const i=Ko(t);for(let s=0;s<i.length;++s){const o=i[s];if(o.set!==void 0){const[a]=o.set(e,r,n);if(a)return[a,n]}}return[!1,void 0]}function fz(t,e){const r=Ko(t);for(let n=0;n<r.length;++n)r[n].everytick(e)}function dz(t,e){const r=Ko(t);for(let n=0;n<r.length;++n)r[n].aftertick(e)}var lc={},Vp={},Xp={},Zp={},NE;function pz(){if(NE)return Zp;NE=1;const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".split("");return Zp.encode=function(e){if(0<=e&&e<t.length)return t[e];throw new TypeError("Must be between 0 and 63: "+e)},Zp}var CE;function LE(){if(CE)return Xp;CE=1;const t=pz(),e=5,r=1<<e,n=r-1,i=r;function s(o){return o<0?(-o<<1)+1:(o<<1)+0}return Xp.encode=function(a){let c="",l,u=s(a);do l=u&n,u>>>=e,u>0&&(l|=i),c+=t.encode(l);while(u>0);return c},Xp}var Dn={},Vs={},uc={exports:{}};/*! https://mths.be/punycode v1.4.1 by @mathias */var mz=uc.exports,ME;function gz(){return ME||(ME=1,(function(t,e){(function(r){var n=e&&!e.nodeType&&e,i=t&&!t.nodeType&&t,s=typeof ji=="object"&&ji;(s.global===s||s.window===s||s.self===s)&&(r=s);var o,a=2147483647,c=36,l=1,u=26,h=38,f=700,d=72,m=128,p="-",g=/^xn--/,y=/[^\x20-\x7E]/,_=/[\x2E\u3002\uFF0E\uFF61]/g,A={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},T=c-l,x=Math.floor,M=String.fromCharCode,R;function P(N){throw new RangeError(A[N])}function W(N,U){for(var $=N.length,X=[];$--;)X[$]=U(N[$]);return X}function F(N,U){var $=N.split("@"),X="";$.length>1&&(X=$[0]+"@",N=$[1]),N=N.replace(_,".");var q=N.split("."),J=W(q,U).join(".");return X+J}function G(N){for(var U=[],$=0,X=N.length,q,J;$<X;)q=N.charCodeAt($++),q>=55296&&q<=56319&&$<X?(J=N.charCodeAt($++),(J&64512)==56320?U.push(((q&1023)<<10)+(J&1023)+65536):(U.push(q),$--)):U.push(q);return U}function O(N){return W(N,function(U){var $="";return U>65535&&(U-=65536,$+=M(U>>>10&1023|55296),U=56320|U&1023),$+=M(U),$}).join("")}function I(N){return N-48<10?N-22:N-65<26?N-65:N-97<26?N-97:c}function k(N,U){return N+22+75*(N<26)-((U!=0)<<5)}function C(N,U,$){var X=0;for(N=$?x(N/f):N>>1,N+=x(N/U);N>T*u>>1;X+=c)N=x(N/T);return x(X+(T+1)*N/(N+h))}function z(N){var U=[],$=N.length,X,q=0,J=m,de=d,Ee,ke,xe,Te,Se,Me,je,S,he;for(Ee=N.lastIndexOf(p),Ee<0&&(Ee=0),ke=0;ke<Ee;++ke)N.charCodeAt(ke)>=128&&P("not-basic"),U.push(N.charCodeAt(ke));for(xe=Ee>0?Ee+1:0;xe<$;){for(Te=q,Se=1,Me=c;xe>=$&&P("invalid-input"),je=I(N.charCodeAt(xe++)),(je>=c||je>x((a-q)/Se))&&P("overflow"),q+=je*Se,S=Me<=de?l:Me>=de+u?u:Me-de,!(je<S);Me+=c)he=c-S,Se>x(a/he)&&P("overflow"),Se*=he;X=U.length+1,de=C(q-Te,X,Te==0),x(q/X)>a-J&&P("overflow"),J+=x(q/X),q%=X,U.splice(q++,0,J)}return O(U)}function B(N){var U,$,X,q,J,de,Ee,ke,xe,Te,Se,Me=[],je,S,he,ie;for(N=G(N),je=N.length,U=m,$=0,J=d,de=0;de<je;++de)Se=N[de],Se<128&&Me.push(M(Se));for(X=q=Me.length,q&&Me.push(p);X<je;){for(Ee=a,de=0;de<je;++de)Se=N[de],Se>=U&&Se<Ee&&(Ee=Se);for(S=X+1,Ee-U>x((a-$)/S)&&P("overflow"),$+=(Ee-U)*S,U=Ee,de=0;de<je;++de)if(Se=N[de],Se<U&&++$>a&&P("overflow"),Se==U){for(ke=$,xe=c;Te=xe<=J?l:xe>=J+u?u:xe-J,!(ke<Te);xe+=c)ie=ke-Te,he=c-Te,Me.push(M(k(Te+ie%he,0))),ke=x(ie/he);Me.push(M(k(ke,0))),J=C($,S,X==q),$=0,++X}++$,++U}return Me.join("")}function Q(N){return F(N,function(U){return g.test(U)?z(U.slice(4).toLowerCase()):U})}function Y(N){return F(N,function(U){return y.test(U)?"xn--"+B(U):U})}if(o={version:"1.4.1",ucs2:{decode:G,encode:O},decode:z,encode:B,toASCII:Y,toUnicode:Q},n&&i)if(t.exports==n)i.exports=o;else for(R in o)o.hasOwnProperty(R)&&(n[R]=o[R]);else r.punycode=o})(mz)})(uc,uc.exports)),uc.exports}var Jp,UE;function qo(){return UE||(UE=1,Jp=TypeError),Jp}var yz={},_z=Object.freeze({__proto__:null,default:yz}),bz=BS(_z),Qp,$E;function Uu(){if($E)return Qp;$E=1;var t=typeof Map=="function"&&Map.prototype,e=Object.getOwnPropertyDescriptor&&t?Object.getOwnPropertyDescriptor(Map.prototype,"size"):null,r=t&&e&&typeof e.get=="function"?e.get:null,n=t&&Map.prototype.forEach,i=typeof Set=="function"&&Set.prototype,s=Object.getOwnPropertyDescriptor&&i?Object.getOwnPropertyDescriptor(Set.prototype,"size"):null,o=i&&s&&typeof s.get=="function"?s.get:null,a=i&&Set.prototype.forEach,c=typeof WeakMap=="function"&&WeakMap.prototype,l=c?WeakMap.prototype.has:null,u=typeof WeakSet=="function"&&WeakSet.prototype,h=u?WeakSet.prototype.has:null,f=typeof WeakRef=="function"&&WeakRef.prototype,d=f?WeakRef.prototype.deref:null,m=Boolean.prototype.valueOf,p=Object.prototype.toString,g=Function.prototype.toString,y=String.prototype.match,_=String.prototype.slice,A=String.prototype.replace,T=String.prototype.toUpperCase,x=String.prototype.toLowerCase,M=RegExp.prototype.test,R=Array.prototype.concat,P=Array.prototype.join,W=Array.prototype.slice,F=Math.floor,G=typeof BigInt=="function"?BigInt.prototype.valueOf:null,O=Object.getOwnPropertySymbols,I=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Symbol.prototype.toString:null,k=typeof Symbol=="function"&&typeof Symbol.iterator=="object",C=typeof Symbol=="function"&&Symbol.toStringTag&&(typeof Symbol.toStringTag===k||!0)?Symbol.toStringTag:null,z=Object.prototype.propertyIsEnumerable,B=(typeof Reflect=="function"?Reflect.getPrototypeOf:Object.getPrototypeOf)||([].__proto__===Array.prototype?function(H){return H.__proto__}:null);function Q(H,re){if(H===1/0||H===-1/0||H!==H||H&&H>-1e3&&H<1e3||M.call(/e/,re))return re;var ze=/[0-9](?=(?:[0-9]{3})+(?![0-9]))/g;if(typeof H=="number"){var Ge=H<0?-F(-H):F(H);if(Ge!==H){var qe=String(Ge),Le=_.call(re,qe.length+1);return A.call(qe,ze,"$&_")+"."+A.call(A.call(Le,/([0-9]{3})/g,"$&_"),/_$/,"")}}return A.call(re,ze,"$&_")}var Y=bz,N=Y.custom,U=S(N)?N:null,$={__proto__:null,double:'"',single:"'"},X={__proto__:null,double:/(["\\])/g,single:/(['\\])/g};Qp=function H(re,ze,Ge,qe){var Le=ze||{};if(K(Le,"quoteStyle")&&!K($,Le.quoteStyle))throw new TypeError('option "quoteStyle" must be "single" or "double"');if(K(Le,"maxStringLength")&&(typeof Le.maxStringLength=="number"?Le.maxStringLength<0&&Le.maxStringLength!==1/0:Le.maxStringLength!==null))throw new TypeError('option "maxStringLength", if provided, must be a positive integer, Infinity, or `null`');var Xr=K(Le,"customInspect")?Le.customInspect:!0;if(typeof Xr!="boolean"&&Xr!=="symbol")throw new TypeError("option \"customInspect\", if provided, must be `true`, `false`, or `'symbol'`");if(K(Le,"indent")&&Le.indent!==null&&Le.indent!=="	"&&!(parseInt(Le.indent,10)===Le.indent&&Le.indent>0))throw new TypeError('option "indent" must be "\\t", an integer > 0, or `null`');if(K(Le,"numericSeparator")&&typeof Le.numericSeparator!="boolean")throw new TypeError('option "numericSeparator", if provided, must be `true` or `false`');var Tn=Le.numericSeparator;if(typeof re>"u")return"undefined";if(re===null)return"null";if(typeof re=="boolean")return re?"true":"false";if(typeof re=="string")return gt(re,Le);if(typeof re=="number"){if(re===0)return 1/0/re>0?"0":"-0";var hn=String(re);return Tn?Q(re,hn):hn}if(typeof re=="bigint"){var hs=String(re)+"n";return Tn?Q(re,hs):hs}var Mm=typeof Le.depth>"u"?5:Le.depth;if(typeof Ge>"u"&&(Ge=0),Ge>=Mm&&Mm>0&&typeof re=="object")return Ee(re)?"[Array]":"[Object]";var ia=D(Le,Ge);if(typeof qe>"u")qe=[];else if(pe(qe,re)>=0)return"[Circular]";function Hn(sa,kh,JG){if(kh&&(qe=W.call(qe),qe.push(kh)),JG){var $S={depth:Le.depth};return K(Le,"quoteStyle")&&($S.quoteStyle=Le.quoteStyle),H(sa,$S,Ge+1,qe)}return H(sa,Le,Ge+1,qe)}if(typeof re=="function"&&!xe(re)){var OS=ee(re),IS=le(re,Hn);return"[Function"+(OS?": "+OS:" (anonymous)")+"]"+(IS.length>0?" { "+P.call(IS,", ")+" }":"")}if(S(re)){var NS=k?A.call(String(re),/^(Symbol\(.*\))_[^)]*$/,"$1"):I.call(re);return typeof re=="object"&&!k?Jt(NS):NS}if(De(re)){for(var Ec="<"+x.call(String(re.nodeName)),Um=re.attributes||[],wh=0;wh<Um.length;wh++)Ec+=" "+Um[wh].name+"="+q(J(Um[wh].value),"double",Le);return Ec+=">",re.childNodes&&re.childNodes.length&&(Ec+="..."),Ec+="</"+x.call(String(re.nodeName))+">",Ec}if(Ee(re)){if(re.length===0)return"[]";var $m=le(re,Hn);return ia&&!v($m)?"["+Z($m,ia)+"]":"[ "+P.call($m,", ")+" ]"}if(Te(re)){var Pm=le(re,Hn);return!("cause"in Error.prototype)&&"cause"in re&&!z.call(re,"cause")?"{ ["+String(re)+"] "+P.call(R.call("[cause]: "+Hn(re.cause),Pm),", ")+" }":Pm.length===0?"["+String(re)+"]":"{ ["+String(re)+"] "+P.call(Pm,", ")+" }"}if(typeof re=="object"&&Xr){if(U&&typeof re[U]=="function"&&Y)return Y(re,{depth:Mm-Ge});if(Xr!=="symbol"&&typeof re.inspect=="function")return re.inspect()}if(me(re)){var CS=[];return n&&n.call(re,function(sa,kh){CS.push(Hn(kh,re,!0)+" => "+Hn(sa,re))}),b("Map",r.call(re),CS,ia)}if(Oe(re)){var LS=[];return a&&a.call(re,function(sa){LS.push(Hn(sa,re))}),b("Set",o.call(re),LS,ia)}if(se(re))return L("WeakMap");if(be(re))return L("WeakSet");if(_e(re))return L("WeakRef");if(Me(re))return Jt(Hn(Number(re)));if(he(re))return Jt(Hn(G.call(re)));if(je(re))return Jt(m.call(re));if(Se(re))return Jt(Hn(String(re)));if(typeof window<"u"&&re===window)return"{ [object Window] }";if(typeof globalThis<"u"&&re===globalThis||typeof ji<"u"&&re===ji)return"{ [object globalThis] }";if(!ke(re)&&!xe(re)){var Bm=le(re,Hn),MS=B?B(re)===Object.prototype:re instanceof Object||re.constructor===Object,Fm=re instanceof Object?"":"null prototype",US=!MS&&C&&Object(re)===re&&C in re?_.call(j(re),8,-1):Fm?"Object":"",ZG=MS||typeof re.constructor!="function"?"":re.constructor.name?re.constructor.name+" ":"",Dm=ZG+(US||Fm?"["+P.call(R.call([],US||[],Fm||[]),": ")+"] ":"");return Bm.length===0?Dm+"{}":ia?Dm+"{"+Z(Bm,ia)+"}":Dm+"{ "+P.call(Bm,", ")+" }"}return String(re)};function q(H,re,ze){var Ge=ze.quoteStyle||re,qe=$[Ge];return qe+H+qe}function J(H){return A.call(String(H),/"/g,"&quot;")}function de(H){return!C||!(typeof H=="object"&&(C in H||typeof H[C]<"u"))}function Ee(H){return j(H)==="[object Array]"&&de(H)}function ke(H){return j(H)==="[object Date]"&&de(H)}function xe(H){return j(H)==="[object RegExp]"&&de(H)}function Te(H){return j(H)==="[object Error]"&&de(H)}function Se(H){return j(H)==="[object String]"&&de(H)}function Me(H){return j(H)==="[object Number]"&&de(H)}function je(H){return j(H)==="[object Boolean]"&&de(H)}function S(H){if(k)return H&&typeof H=="object"&&H instanceof Symbol;if(typeof H=="symbol")return!0;if(!H||typeof H!="object"||!I)return!1;try{return I.call(H),!0}catch{}return!1}function he(H){if(!H||typeof H!="object"||!G)return!1;try{return G.call(H),!0}catch{}return!1}var ie=Object.prototype.hasOwnProperty||function(H){return H in this};function K(H,re){return ie.call(H,re)}function j(H){return p.call(H)}function ee(H){if(H.name)return H.name;var re=y.call(g.call(H),/^function\s*([\w$]+)/);return re?re[1]:null}function pe(H,re){if(H.indexOf)return H.indexOf(re);for(var ze=0,Ge=H.length;ze<Ge;ze++)if(H[ze]===re)return ze;return-1}function me(H){if(!r||!H||typeof H!="object")return!1;try{r.call(H);try{o.call(H)}catch{return!0}return H instanceof Map}catch{}return!1}function se(H){if(!l||!H||typeof H!="object")return!1;try{l.call(H,l);try{h.call(H,h)}catch{return!0}return H instanceof WeakMap}catch{}return!1}function _e(H){if(!d||!H||typeof H!="object")return!1;try{return d.call(H),!0}catch{}return!1}function Oe(H){if(!o||!H||typeof H!="object")return!1;try{o.call(H);try{r.call(H)}catch{return!0}return H instanceof Set}catch{}return!1}function be(H){if(!h||!H||typeof H!="object")return!1;try{h.call(H,h);try{l.call(H,l)}catch{return!0}return H instanceof WeakSet}catch{}return!1}function De(H){return!H||typeof H!="object"?!1:typeof HTMLElement<"u"&&H instanceof HTMLElement?!0:typeof H.nodeName=="string"&&typeof H.getAttribute=="function"}function gt(H,re){if(H.length>re.maxStringLength){var ze=H.length-re.maxStringLength,Ge="... "+ze+" more character"+(ze>1?"s":"");return gt(_.call(H,0,re.maxStringLength),re)+Ge}var qe=X[re.quoteStyle||"single"];qe.lastIndex=0;var Le=A.call(A.call(H,qe,"\\$1"),/[\x00-\x1f]/g,Ze);return q(Le,"single",re)}function Ze(H){var re=H.charCodeAt(0),ze={8:"b",9:"t",10:"n",12:"f",13:"r"}[re];return ze?"\\"+ze:"\\x"+(re<16?"0":"")+T.call(re.toString(16))}function Jt(H){return"Object("+H+")"}function L(H){return H+" { ? }"}function b(H,re,ze,Ge){var qe=Ge?Z(ze,Ge):P.call(ze,", ");return H+" ("+re+") {"+qe+"}"}function v(H){for(var re=0;re<H.length;re++)if(pe(H[re],`
`)>=0)return!1;return!0}function D(H,re){var ze;if(H.indent==="	")ze="	";else if(typeof H.indent=="number"&&H.indent>0)ze=P.call(Array(H.indent+1)," ");else return null;return{base:ze,prev:P.call(Array(re+1),ze)}}function Z(H,re){if(H.length===0)return"";var ze=`
`+re.prev+re.base;return ze+P.call(H,","+ze)+`
`+re.prev}function le(H,re){var ze=Ee(H),Ge=[];if(ze){Ge.length=H.length;for(var qe=0;qe<H.length;qe++)Ge[qe]=K(H,qe)?re(H[qe],H):""}var Le=typeof O=="function"?O(H):[],Xr;if(k){Xr={};for(var Tn=0;Tn<Le.length;Tn++)Xr["$"+Le[Tn]]=Le[Tn]}for(var hn in H)K(H,hn)&&(ze&&String(Number(hn))===hn&&hn<H.length||k&&Xr["$"+hn]instanceof Symbol||(M.call(/[^\w$]/,hn)?Ge.push(re(hn,H)+": "+re(H[hn],H)):Ge.push(hn+": "+re(H[hn],H))));if(typeof O=="function")for(var hs=0;hs<Le.length;hs++)z.call(H,Le[hs])&&Ge.push("["+re(Le[hs])+"]: "+re(H[Le[hs]],H));return Ge}return Qp}var e0,PE;function wz(){if(PE)return e0;PE=1;var t=Uu(),e=qo(),r=function(a,c,l){for(var u=a,h;(h=u.next)!=null;u=h)if(h.key===c)return u.next=h.next,l||(h.next=a.next,a.next=h),h},n=function(a,c){if(a){var l=r(a,c);return l&&l.value}},i=function(a,c,l){var u=r(a,c);u?u.value=l:a.next={key:c,next:a.next,value:l}},s=function(a,c){return a?!!r(a,c):!1},o=function(a,c){if(a)return r(a,c,!0)};return e0=function(){var c,l={assert:function(u){if(!l.has(u))throw new e("Side channel does not contain "+t(u))},delete:function(u){var h=c&&c.next,f=o(c,u);return f&&h&&h===f&&(c=void 0),!!f},get:function(u){return n(c,u)},has:function(u){return s(c,u)},set:function(u,h){c||(c={next:void 0}),i(c,u,h)}};return l},e0}var t0,BE;function FE(){return BE||(BE=1,t0=Object),t0}var r0,DE;function kz(){return DE||(DE=1,r0=Error),r0}var n0,jE;function vz(){return jE||(jE=1,n0=EvalError),n0}var i0,zE;function xz(){return zE||(zE=1,i0=RangeError),i0}var s0,WE;function Ez(){return WE||(WE=1,s0=ReferenceError),s0}var o0,HE;function Az(){return HE||(HE=1,o0=SyntaxError),o0}var a0,GE;function Tz(){return GE||(GE=1,a0=URIError),a0}var c0,KE;function Sz(){return KE||(KE=1,c0=Math.abs),c0}var l0,qE;function Rz(){return qE||(qE=1,l0=Math.floor),l0}var u0,YE;function Oz(){return YE||(YE=1,u0=Math.max),u0}var h0,VE;function Iz(){return VE||(VE=1,h0=Math.min),h0}var f0,XE;function Nz(){return XE||(XE=1,f0=Math.pow),f0}var d0,ZE;function Cz(){return ZE||(ZE=1,d0=Math.round),d0}var p0,JE;function Lz(){return JE||(JE=1,p0=Number.isNaN||function(e){return e!==e}),p0}var m0,QE;function Mz(){if(QE)return m0;QE=1;var t=Lz();return m0=function(r){return t(r)||r===0?r:r<0?-1:1},m0}var g0,eA;function Uz(){return eA||(eA=1,g0=Object.getOwnPropertyDescriptor),g0}var y0,tA;function rA(){if(tA)return y0;tA=1;var t=Uz();if(t)try{t([],"length")}catch{t=null}return y0=t,y0}var _0,nA;function $z(){if(nA)return _0;nA=1;var t=Object.defineProperty||!1;if(t)try{t({},"a",{value:1})}catch{t=!1}return _0=t,_0}var b0,iA;function Pz(){return iA||(iA=1,b0=function(){if(typeof Symbol!="function"||typeof Object.getOwnPropertySymbols!="function")return!1;if(typeof Symbol.iterator=="symbol")return!0;var e={},r=Symbol("test"),n=Object(r);if(typeof r=="string"||Object.prototype.toString.call(r)!=="[object Symbol]"||Object.prototype.toString.call(n)!=="[object Symbol]")return!1;var i=42;e[r]=i;for(var s in e)return!1;if(typeof Object.keys=="function"&&Object.keys(e).length!==0||typeof Object.getOwnPropertyNames=="function"&&Object.getOwnPropertyNames(e).length!==0)return!1;var o=Object.getOwnPropertySymbols(e);if(o.length!==1||o[0]!==r||!Object.prototype.propertyIsEnumerable.call(e,r))return!1;if(typeof Object.getOwnPropertyDescriptor=="function"){var a=Object.getOwnPropertyDescriptor(e,r);if(a.value!==i||a.enumerable!==!0)return!1}return!0}),b0}var w0,sA;function Bz(){if(sA)return w0;sA=1;var t=typeof Symbol<"u"&&Symbol,e=Pz();return w0=function(){return typeof t!="function"||typeof Symbol!="function"||typeof t("foo")!="symbol"||typeof Symbol("bar")!="symbol"?!1:e()},w0}var k0,oA;function aA(){return oA||(oA=1,k0=typeof Reflect<"u"&&Reflect.getPrototypeOf||null),k0}var v0,cA;function lA(){if(cA)return v0;cA=1;var t=FE();return v0=t.getPrototypeOf||null,v0}var x0,uA;function Fz(){if(uA)return x0;uA=1;var t="Function.prototype.bind called on incompatible ",e=Object.prototype.toString,r=Math.max,n="[object Function]",i=function(c,l){for(var u=[],h=0;h<c.length;h+=1)u[h]=c[h];for(var f=0;f<l.length;f+=1)u[f+c.length]=l[f];return u},s=function(c,l){for(var u=[],h=l,f=0;h<c.length;h+=1,f+=1)u[f]=c[h];return u},o=function(a,c){for(var l="",u=0;u<a.length;u+=1)l+=a[u],u+1<a.length&&(l+=c);return l};return x0=function(c){var l=this;if(typeof l!="function"||e.apply(l)!==n)throw new TypeError(t+l);for(var u=s(arguments,1),h,f=function(){if(this instanceof h){var y=l.apply(this,i(u,arguments));return Object(y)===y?y:this}return l.apply(c,i(u,arguments))},d=r(0,l.length-u.length),m=[],p=0;p<d;p++)m[p]="$"+p;if(h=Function("binder","return function ("+o(m,",")+"){ return binder.apply(this,arguments); }")(f),l.prototype){var g=function(){};g.prototype=l.prototype,h.prototype=new g,g.prototype=null}return h},x0}var E0,hA;function $u(){if(hA)return E0;hA=1;var t=Fz();return E0=Function.prototype.bind||t,E0}var A0,fA;function T0(){return fA||(fA=1,A0=Function.prototype.call),A0}var S0,dA;function pA(){return dA||(dA=1,S0=Function.prototype.apply),S0}var R0,mA;function Dz(){return mA||(mA=1,R0=typeof Reflect<"u"&&Reflect&&Reflect.apply),R0}var O0,gA;function jz(){if(gA)return O0;gA=1;var t=$u(),e=pA(),r=T0(),n=Dz();return O0=n||t.call(r,e),O0}var I0,yA;function _A(){if(yA)return I0;yA=1;var t=$u(),e=qo(),r=T0(),n=jz();return I0=function(s){if(s.length<1||typeof s[0]!="function")throw new e("a function is required");return n(t,r,s)},I0}var N0,bA;function zz(){if(bA)return N0;bA=1;var t=_A(),e=rA(),r;try{r=[].__proto__===Array.prototype}catch(o){if(!o||typeof o!="object"||!("code"in o)||o.code!=="ERR_PROTO_ACCESS")throw o}var n=!!r&&e&&e(Object.prototype,"__proto__"),i=Object,s=i.getPrototypeOf;return N0=n&&typeof n.get=="function"?t([n.get]):typeof s=="function"?function(a){return s(a==null?a:i(a))}:!1,N0}var C0,wA;function Wz(){if(wA)return C0;wA=1;var t=aA(),e=lA(),r=zz();return C0=t?function(i){return t(i)}:e?function(i){if(!i||typeof i!="object"&&typeof i!="function")throw new TypeError("getProto: not an object");return e(i)}:r?function(i){return r(i)}:null,C0}var L0,kA;function Hz(){if(kA)return L0;kA=1;var t=Function.prototype.call,e=Object.prototype.hasOwnProperty,r=$u();return L0=r.call(t,e),L0}var M0,vA;function U0(){if(vA)return M0;vA=1;var t,e=FE(),r=kz(),n=vz(),i=xz(),s=Ez(),o=Az(),a=qo(),c=Tz(),l=Sz(),u=Rz(),h=Oz(),f=Iz(),d=Nz(),m=Cz(),p=Mz(),g=Function,y=function(xe){try{return g('"use strict"; return ('+xe+").constructor;")()}catch{}},_=rA(),A=$z(),T=function(){throw new a},x=_?(function(){try{return arguments.callee,T}catch{try{return _(arguments,"callee").get}catch{return T}}})():T,M=Bz()(),R=Wz(),P=lA(),W=aA(),F=pA(),G=T0(),O={},I=typeof Uint8Array>"u"||!R?t:R(Uint8Array),k={__proto__:null,"%AggregateError%":typeof AggregateError>"u"?t:AggregateError,"%Array%":Array,"%ArrayBuffer%":typeof ArrayBuffer>"u"?t:ArrayBuffer,"%ArrayIteratorPrototype%":M&&R?R([][Symbol.iterator]()):t,"%AsyncFromSyncIteratorPrototype%":t,"%AsyncFunction%":O,"%AsyncGenerator%":O,"%AsyncGeneratorFunction%":O,"%AsyncIteratorPrototype%":O,"%Atomics%":typeof Atomics>"u"?t:Atomics,"%BigInt%":typeof BigInt>"u"?t:BigInt,"%BigInt64Array%":typeof BigInt64Array>"u"?t:BigInt64Array,"%BigUint64Array%":typeof BigUint64Array>"u"?t:BigUint64Array,"%Boolean%":Boolean,"%DataView%":typeof DataView>"u"?t:DataView,"%Date%":Date,"%decodeURI%":decodeURI,"%decodeURIComponent%":decodeURIComponent,"%encodeURI%":encodeURI,"%encodeURIComponent%":encodeURIComponent,"%Error%":r,"%eval%":eval,"%EvalError%":n,"%Float16Array%":typeof Float16Array>"u"?t:Float16Array,"%Float32Array%":typeof Float32Array>"u"?t:Float32Array,"%Float64Array%":typeof Float64Array>"u"?t:Float64Array,"%FinalizationRegistry%":typeof FinalizationRegistry>"u"?t:FinalizationRegistry,"%Function%":g,"%GeneratorFunction%":O,"%Int8Array%":typeof Int8Array>"u"?t:Int8Array,"%Int16Array%":typeof Int16Array>"u"?t:Int16Array,"%Int32Array%":typeof Int32Array>"u"?t:Int32Array,"%isFinite%":isFinite,"%isNaN%":isNaN,"%IteratorPrototype%":M&&R?R(R([][Symbol.iterator]())):t,"%JSON%":typeof JSON=="object"?JSON:t,"%Map%":typeof Map>"u"?t:Map,"%MapIteratorPrototype%":typeof Map>"u"||!M||!R?t:R(new Map()[Symbol.iterator]()),"%Math%":Math,"%Number%":Number,"%Object%":e,"%Object.getOwnPropertyDescriptor%":_,"%parseFloat%":parseFloat,"%parseInt%":parseInt,"%Promise%":typeof Promise>"u"?t:Promise,"%Proxy%":typeof Proxy>"u"?t:Proxy,"%RangeError%":i,"%ReferenceError%":s,"%Reflect%":typeof Reflect>"u"?t:Reflect,"%RegExp%":RegExp,"%Set%":typeof Set>"u"?t:Set,"%SetIteratorPrototype%":typeof Set>"u"||!M||!R?t:R(new Set()[Symbol.iterator]()),"%SharedArrayBuffer%":typeof SharedArrayBuffer>"u"?t:SharedArrayBuffer,"%String%":String,"%StringIteratorPrototype%":M&&R?R(""[Symbol.iterator]()):t,"%Symbol%":M?Symbol:t,"%SyntaxError%":o,"%ThrowTypeError%":x,"%TypedArray%":I,"%TypeError%":a,"%Uint8Array%":typeof Uint8Array>"u"?t:Uint8Array,"%Uint8ClampedArray%":typeof Uint8ClampedArray>"u"?t:Uint8ClampedArray,"%Uint16Array%":typeof Uint16Array>"u"?t:Uint16Array,"%Uint32Array%":typeof Uint32Array>"u"?t:Uint32Array,"%URIError%":c,"%WeakMap%":typeof WeakMap>"u"?t:WeakMap,"%WeakRef%":typeof WeakRef>"u"?t:WeakRef,"%WeakSet%":typeof WeakSet>"u"?t:WeakSet,"%Function.prototype.call%":G,"%Function.prototype.apply%":F,"%Object.defineProperty%":A,"%Object.getPrototypeOf%":P,"%Math.abs%":l,"%Math.floor%":u,"%Math.max%":h,"%Math.min%":f,"%Math.pow%":d,"%Math.round%":m,"%Math.sign%":p,"%Reflect.getPrototypeOf%":W};if(R)try{null.error}catch(xe){var C=R(R(xe));k["%Error.prototype%"]=C}var z=function xe(Te){var Se;if(Te==="%AsyncFunction%")Se=y("async function () {}");else if(Te==="%GeneratorFunction%")Se=y("function* () {}");else if(Te==="%AsyncGeneratorFunction%")Se=y("async function* () {}");else if(Te==="%AsyncGenerator%"){var Me=xe("%AsyncGeneratorFunction%");Me&&(Se=Me.prototype)}else if(Te==="%AsyncIteratorPrototype%"){var je=xe("%AsyncGenerator%");je&&R&&(Se=R(je.prototype))}return k[Te]=Se,Se},B={__proto__:null,"%ArrayBufferPrototype%":["ArrayBuffer","prototype"],"%ArrayPrototype%":["Array","prototype"],"%ArrayProto_entries%":["Array","prototype","entries"],"%ArrayProto_forEach%":["Array","prototype","forEach"],"%ArrayProto_keys%":["Array","prototype","keys"],"%ArrayProto_values%":["Array","prototype","values"],"%AsyncFunctionPrototype%":["AsyncFunction","prototype"],"%AsyncGenerator%":["AsyncGeneratorFunction","prototype"],"%AsyncGeneratorPrototype%":["AsyncGeneratorFunction","prototype","prototype"],"%BooleanPrototype%":["Boolean","prototype"],"%DataViewPrototype%":["DataView","prototype"],"%DatePrototype%":["Date","prototype"],"%ErrorPrototype%":["Error","prototype"],"%EvalErrorPrototype%":["EvalError","prototype"],"%Float32ArrayPrototype%":["Float32Array","prototype"],"%Float64ArrayPrototype%":["Float64Array","prototype"],"%FunctionPrototype%":["Function","prototype"],"%Generator%":["GeneratorFunction","prototype"],"%GeneratorPrototype%":["GeneratorFunction","prototype","prototype"],"%Int8ArrayPrototype%":["Int8Array","prototype"],"%Int16ArrayPrototype%":["Int16Array","prototype"],"%Int32ArrayPrototype%":["Int32Array","prototype"],"%JSONParse%":["JSON","parse"],"%JSONStringify%":["JSON","stringify"],"%MapPrototype%":["Map","prototype"],"%NumberPrototype%":["Number","prototype"],"%ObjectPrototype%":["Object","prototype"],"%ObjProto_toString%":["Object","prototype","toString"],"%ObjProto_valueOf%":["Object","prototype","valueOf"],"%PromisePrototype%":["Promise","prototype"],"%PromiseProto_then%":["Promise","prototype","then"],"%Promise_all%":["Promise","all"],"%Promise_reject%":["Promise","reject"],"%Promise_resolve%":["Promise","resolve"],"%RangeErrorPrototype%":["RangeError","prototype"],"%ReferenceErrorPrototype%":["ReferenceError","prototype"],"%RegExpPrototype%":["RegExp","prototype"],"%SetPrototype%":["Set","prototype"],"%SharedArrayBufferPrototype%":["SharedArrayBuffer","prototype"],"%StringPrototype%":["String","prototype"],"%SymbolPrototype%":["Symbol","prototype"],"%SyntaxErrorPrototype%":["SyntaxError","prototype"],"%TypedArrayPrototype%":["TypedArray","prototype"],"%TypeErrorPrototype%":["TypeError","prototype"],"%Uint8ArrayPrototype%":["Uint8Array","prototype"],"%Uint8ClampedArrayPrototype%":["Uint8ClampedArray","prototype"],"%Uint16ArrayPrototype%":["Uint16Array","prototype"],"%Uint32ArrayPrototype%":["Uint32Array","prototype"],"%URIErrorPrototype%":["URIError","prototype"],"%WeakMapPrototype%":["WeakMap","prototype"],"%WeakSetPrototype%":["WeakSet","prototype"]},Q=$u(),Y=Hz(),N=Q.call(G,Array.prototype.concat),U=Q.call(F,Array.prototype.splice),$=Q.call(G,String.prototype.replace),X=Q.call(G,String.prototype.slice),q=Q.call(G,RegExp.prototype.exec),J=/[^%.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|%$))/g,de=/\\(\\)?/g,Ee=function(Te){var Se=X(Te,0,1),Me=X(Te,-1);if(Se==="%"&&Me!=="%")throw new o("invalid intrinsic syntax, expected closing `%`");if(Me==="%"&&Se!=="%")throw new o("invalid intrinsic syntax, expected opening `%`");var je=[];return $(Te,J,function(S,he,ie,K){je[je.length]=ie?$(K,de,"$1"):he||S}),je},ke=function(Te,Se){var Me=Te,je;if(Y(B,Me)&&(je=B[Me],Me="%"+je[0]+"%"),Y(k,Me)){var S=k[Me];if(S===O&&(S=z(Me)),typeof S>"u"&&!Se)throw new a("intrinsic "+Te+" exists, but is not available. Please file an issue!");return{alias:je,name:Me,value:S}}throw new o("intrinsic "+Te+" does not exist!")};return M0=function(Te,Se){if(typeof Te!="string"||Te.length===0)throw new a("intrinsic name must be a non-empty string");if(arguments.length>1&&typeof Se!="boolean")throw new a('"allowMissing" argument must be a boolean');if(q(/^%?[^%]*%?$/,Te)===null)throw new o("`%` may not be present anywhere but at the beginning and end of the intrinsic name");var Me=Ee(Te),je=Me.length>0?Me[0]:"",S=ke("%"+je+"%",Se),he=S.name,ie=S.value,K=!1,j=S.alias;j&&(je=j[0],U(Me,N([0,1],j)));for(var ee=1,pe=!0;ee<Me.length;ee+=1){var me=Me[ee],se=X(me,0,1),_e=X(me,-1);if((se==='"'||se==="'"||se==="`"||_e==='"'||_e==="'"||_e==="`")&&se!==_e)throw new o("property names with quotes must have matching quotes");if((me==="constructor"||!pe)&&(K=!0),je+="."+me,he="%"+je+"%",Y(k,he))ie=k[he];else if(ie!=null){if(!(me in ie)){if(!Se)throw new a("base intrinsic for "+Te+" exists, but the property is not available.");return}if(_&&ee+1>=Me.length){var Oe=_(ie,me);pe=!!Oe,pe&&"get"in Oe&&!("originalValue"in Oe.get)?ie=Oe.get:ie=ie[me]}else pe=Y(ie,me),ie=ie[me];pe&&!K&&(k[he]=ie)}}return ie},M0}var $0,xA;function EA(){if(xA)return $0;xA=1;var t=U0(),e=_A(),r=e([t("%String.prototype.indexOf%")]);return $0=function(i,s){var o=t(i,!!s);return typeof o=="function"&&r(i,".prototype.")>-1?e([o]):o},$0}var P0,AA;function TA(){if(AA)return P0;AA=1;var t=U0(),e=EA(),r=Uu(),n=qo(),i=t("%Map%",!0),s=e("Map.prototype.get",!0),o=e("Map.prototype.set",!0),a=e("Map.prototype.has",!0),c=e("Map.prototype.delete",!0),l=e("Map.prototype.size",!0);return P0=!!i&&function(){var h,f={assert:function(d){if(!f.has(d))throw new n("Side channel does not contain "+r(d))},delete:function(d){if(h){var m=c(h,d);return l(h)===0&&(h=void 0),m}return!1},get:function(d){if(h)return s(h,d)},has:function(d){return h?a(h,d):!1},set:function(d,m){h||(h=new i),o(h,d,m)}};return f},P0}var B0,SA;function Gz(){if(SA)return B0;SA=1;var t=U0(),e=EA(),r=Uu(),n=TA(),i=qo(),s=t("%WeakMap%",!0),o=e("WeakMap.prototype.get",!0),a=e("WeakMap.prototype.set",!0),c=e("WeakMap.prototype.has",!0),l=e("WeakMap.prototype.delete",!0);return B0=s?function(){var h,f,d={assert:function(m){if(!d.has(m))throw new i("Side channel does not contain "+r(m))},delete:function(m){if(s&&m&&(typeof m=="object"||typeof m=="function")){if(h)return l(h,m)}else if(n&&f)return f.delete(m);return!1},get:function(m){return s&&m&&(typeof m=="object"||typeof m=="function")&&h?o(h,m):f&&f.get(m)},has:function(m){return s&&m&&(typeof m=="object"||typeof m=="function")&&h?c(h,m):!!f&&f.has(m)},set:function(m,p){s&&m&&(typeof m=="object"||typeof m=="function")?(h||(h=new s),a(h,m,p)):n&&(f||(f=n()),f.set(m,p))}};return d}:n,B0}var F0,RA;function Kz(){if(RA)return F0;RA=1;var t=qo(),e=Uu(),r=wz(),n=TA(),i=Gz(),s=i||n||r;return F0=function(){var a,c={assert:function(l){if(!c.has(l))throw new t("Side channel does not contain "+e(l))},delete:function(l){return!!a&&a.delete(l)},get:function(l){return a&&a.get(l)},has:function(l){return!!a&&a.has(l)},set:function(l,u){a||(a=s()),a.set(l,u)}};return c},F0}var D0,OA;function j0(){if(OA)return D0;OA=1;var t=String.prototype.replace,e=/%20/g,r={RFC1738:"RFC1738",RFC3986:"RFC3986"};return D0={default:r.RFC3986,formatters:{RFC1738:function(n){return t.call(n,e,"+")},RFC3986:function(n){return String(n)}},RFC1738:r.RFC1738,RFC3986:r.RFC3986},D0}var z0,IA;function NA(){if(IA)return z0;IA=1;var t=j0(),e=Object.prototype.hasOwnProperty,r=Array.isArray,n=(function(){for(var g=[],y=0;y<256;++y)g.push("%"+((y<16?"0":"")+y.toString(16)).toUpperCase());return g})(),i=function(y){for(;y.length>1;){var _=y.pop(),A=_.obj[_.prop];if(r(A)){for(var T=[],x=0;x<A.length;++x)typeof A[x]<"u"&&T.push(A[x]);_.obj[_.prop]=T}}},s=function(y,_){for(var A=_&&_.plainObjects?{__proto__:null}:{},T=0;T<y.length;++T)typeof y[T]<"u"&&(A[T]=y[T]);return A},o=function g(y,_,A){if(!_)return y;if(typeof _!="object"&&typeof _!="function"){if(r(y))y.push(_);else if(y&&typeof y=="object")(A&&(A.plainObjects||A.allowPrototypes)||!e.call(Object.prototype,_))&&(y[_]=!0);else return[y,_];return y}if(!y||typeof y!="object")return[y].concat(_);var T=y;return r(y)&&!r(_)&&(T=s(y,A)),r(y)&&r(_)?(_.forEach(function(x,M){if(e.call(y,M)){var R=y[M];R&&typeof R=="object"&&x&&typeof x=="object"?y[M]=g(R,x,A):y.push(x)}else y[M]=x}),y):Object.keys(_).reduce(function(x,M){var R=_[M];return e.call(x,M)?x[M]=g(x[M],R,A):x[M]=R,x},T)},a=function(y,_){return Object.keys(_).reduce(function(A,T){return A[T]=_[T],A},y)},c=function(g,y,_){var A=g.replace(/\+/g," ");if(_==="iso-8859-1")return A.replace(/%[0-9a-f]{2}/gi,unescape);try{return decodeURIComponent(A)}catch{return A}},l=1024,u=function(y,_,A,T,x){if(y.length===0)return y;var M=y;if(typeof y=="symbol"?M=Symbol.prototype.toString.call(y):typeof y!="string"&&(M=String(y)),A==="iso-8859-1")return escape(M).replace(/%u[0-9a-f]{4}/gi,function(I){return"%26%23"+parseInt(I.slice(2),16)+"%3B"});for(var R="",P=0;P<M.length;P+=l){for(var W=M.length>=l?M.slice(P,P+l):M,F=[],G=0;G<W.length;++G){var O=W.charCodeAt(G);if(O===45||O===46||O===95||O===126||O>=48&&O<=57||O>=65&&O<=90||O>=97&&O<=122||x===t.RFC1738&&(O===40||O===41)){F[F.length]=W.charAt(G);continue}if(O<128){F[F.length]=n[O];continue}if(O<2048){F[F.length]=n[192|O>>6]+n[128|O&63];continue}if(O<55296||O>=57344){F[F.length]=n[224|O>>12]+n[128|O>>6&63]+n[128|O&63];continue}G+=1,O=65536+((O&1023)<<10|W.charCodeAt(G)&1023),F[F.length]=n[240|O>>18]+n[128|O>>12&63]+n[128|O>>6&63]+n[128|O&63]}R+=F.join("")}return R},h=function(y){for(var _=[{obj:{o:y},prop:"o"}],A=[],T=0;T<_.length;++T)for(var x=_[T],M=x.obj[x.prop],R=Object.keys(M),P=0;P<R.length;++P){var W=R[P],F=M[W];typeof F=="object"&&F!==null&&A.indexOf(F)===-1&&(_.push({obj:M,prop:W}),A.push(F))}return i(_),y},f=function(y){return Object.prototype.toString.call(y)==="[object RegExp]"},d=function(y){return!y||typeof y!="object"?!1:!!(y.constructor&&y.constructor.isBuffer&&y.constructor.isBuffer(y))},m=function(y,_){return[].concat(y,_)},p=function(y,_){if(r(y)){for(var A=[],T=0;T<y.length;T+=1)A.push(_(y[T]));return A}return _(y)};return z0={arrayToObject:s,assign:a,combine:m,compact:h,decode:c,encode:u,isBuffer:d,isRegExp:f,maybeMap:p,merge:o},z0}var W0,CA;function qz(){if(CA)return W0;CA=1;var t=Kz(),e=NA(),r=j0(),n=Object.prototype.hasOwnProperty,i={brackets:function(g){return g+"[]"},comma:"comma",indices:function(g,y){return g+"["+y+"]"},repeat:function(g){return g}},s=Array.isArray,o=Array.prototype.push,a=function(p,g){o.apply(p,s(g)?g:[g])},c=Date.prototype.toISOString,l=r.default,u={addQueryPrefix:!1,allowDots:!1,allowEmptyArrays:!1,arrayFormat:"indices",charset:"utf-8",charsetSentinel:!1,commaRoundTrip:!1,delimiter:"&",encode:!0,encodeDotInKeys:!1,encoder:e.encode,encodeValuesOnly:!1,filter:void 0,format:l,formatter:r.formatters[l],indices:!1,serializeDate:function(g){return c.call(g)},skipNulls:!1,strictNullHandling:!1},h=function(g){return typeof g=="string"||typeof g=="number"||typeof g=="boolean"||typeof g=="symbol"||typeof g=="bigint"},f={},d=function p(g,y,_,A,T,x,M,R,P,W,F,G,O,I,k,C,z,B){for(var Q=g,Y=B,N=0,U=!1;(Y=Y.get(f))!==void 0&&!U;){var $=Y.get(g);if(N+=1,typeof $<"u"){if($===N)throw new RangeError("Cyclic object value");U=!0}typeof Y.get(f)>"u"&&(N=0)}if(typeof W=="function"?Q=W(y,Q):Q instanceof Date?Q=O(Q):_==="comma"&&s(Q)&&(Q=e.maybeMap(Q,function(he){return he instanceof Date?O(he):he})),Q===null){if(x)return P&&!C?P(y,u.encoder,z,"key",I):y;Q=""}if(h(Q)||e.isBuffer(Q)){if(P){var X=C?y:P(y,u.encoder,z,"key",I);return[k(X)+"="+k(P(Q,u.encoder,z,"value",I))]}return[k(y)+"="+k(String(Q))]}var q=[];if(typeof Q>"u")return q;var J;if(_==="comma"&&s(Q))C&&P&&(Q=e.maybeMap(Q,P)),J=[{value:Q.length>0?Q.join(",")||null:void 0}];else if(s(W))J=W;else{var de=Object.keys(Q);J=F?de.sort(F):de}var Ee=R?String(y).replace(/\./g,"%2E"):String(y),ke=A&&s(Q)&&Q.length===1?Ee+"[]":Ee;if(T&&s(Q)&&Q.length===0)return ke+"[]";for(var xe=0;xe<J.length;++xe){var Te=J[xe],Se=typeof Te=="object"&&Te&&typeof Te.value<"u"?Te.value:Q[Te];if(!(M&&Se===null)){var Me=G&&R?String(Te).replace(/\./g,"%2E"):String(Te),je=s(Q)?typeof _=="function"?_(ke,Me):ke:ke+(G?"."+Me:"["+Me+"]");B.set(g,N);var S=t();S.set(f,B),a(q,p(Se,je,_,A,T,x,M,R,_==="comma"&&C&&s(Q)?null:P,W,F,G,O,I,k,C,z,S))}}return q},m=function(g){if(!g)return u;if(typeof g.allowEmptyArrays<"u"&&typeof g.allowEmptyArrays!="boolean")throw new TypeError("`allowEmptyArrays` option can only be `true` or `false`, when provided");if(typeof g.encodeDotInKeys<"u"&&typeof g.encodeDotInKeys!="boolean")throw new TypeError("`encodeDotInKeys` option can only be `true` or `false`, when provided");if(g.encoder!==null&&typeof g.encoder<"u"&&typeof g.encoder!="function")throw new TypeError("Encoder has to be a function.");var y=g.charset||u.charset;if(typeof g.charset<"u"&&g.charset!=="utf-8"&&g.charset!=="iso-8859-1")throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");var _=r.default;if(typeof g.format<"u"){if(!n.call(r.formatters,g.format))throw new TypeError("Unknown format option provided.");_=g.format}var A=r.formatters[_],T=u.filter;(typeof g.filter=="function"||s(g.filter))&&(T=g.filter);var x;if(g.arrayFormat in i?x=g.arrayFormat:"indices"in g?x=g.indices?"indices":"repeat":x=u.arrayFormat,"commaRoundTrip"in g&&typeof g.commaRoundTrip!="boolean")throw new TypeError("`commaRoundTrip` must be a boolean, or absent");var M=typeof g.allowDots>"u"?g.encodeDotInKeys===!0?!0:u.allowDots:!!g.allowDots;return{addQueryPrefix:typeof g.addQueryPrefix=="boolean"?g.addQueryPrefix:u.addQueryPrefix,allowDots:M,allowEmptyArrays:typeof g.allowEmptyArrays=="boolean"?!!g.allowEmptyArrays:u.allowEmptyArrays,arrayFormat:x,charset:y,charsetSentinel:typeof g.charsetSentinel=="boolean"?g.charsetSentinel:u.charsetSentinel,commaRoundTrip:!!g.commaRoundTrip,delimiter:typeof g.delimiter>"u"?u.delimiter:g.delimiter,encode:typeof g.encode=="boolean"?g.encode:u.encode,encodeDotInKeys:typeof g.encodeDotInKeys=="boolean"?g.encodeDotInKeys:u.encodeDotInKeys,encoder:typeof g.encoder=="function"?g.encoder:u.encoder,encodeValuesOnly:typeof g.encodeValuesOnly=="boolean"?g.encodeValuesOnly:u.encodeValuesOnly,filter:T,format:_,formatter:A,serializeDate:typeof g.serializeDate=="function"?g.serializeDate:u.serializeDate,skipNulls:typeof g.skipNulls=="boolean"?g.skipNulls:u.skipNulls,sort:typeof g.sort=="function"?g.sort:null,strictNullHandling:typeof g.strictNullHandling=="boolean"?g.strictNullHandling:u.strictNullHandling}};return W0=function(p,g){var y=p,_=m(g),A,T;typeof _.filter=="function"?(T=_.filter,y=T("",y)):s(_.filter)&&(T=_.filter,A=T);var x=[];if(typeof y!="object"||y===null)return"";var M=i[_.arrayFormat],R=M==="comma"&&_.commaRoundTrip;A||(A=Object.keys(y)),_.sort&&A.sort(_.sort);for(var P=t(),W=0;W<A.length;++W){var F=A[W],G=y[F];_.skipNulls&&G===null||a(x,d(G,F,M,R,_.allowEmptyArrays,_.strictNullHandling,_.skipNulls,_.encodeDotInKeys,_.encode?_.encoder:null,_.filter,_.sort,_.allowDots,_.serializeDate,_.format,_.formatter,_.encodeValuesOnly,_.charset,P))}var O=x.join(_.delimiter),I=_.addQueryPrefix===!0?"?":"";return _.charsetSentinel&&(_.charset==="iso-8859-1"?I+="utf8=%26%2310003%3B&":I+="utf8=%E2%9C%93&"),O.length>0?I+O:""},W0}var H0,LA;function Yz(){if(LA)return H0;LA=1;var t=NA(),e=Object.prototype.hasOwnProperty,r=Array.isArray,n={allowDots:!1,allowEmptyArrays:!1,allowPrototypes:!1,allowSparse:!1,arrayLimit:20,charset:"utf-8",charsetSentinel:!1,comma:!1,decodeDotInKeys:!1,decoder:t.decode,delimiter:"&",depth:5,duplicates:"combine",ignoreQueryPrefix:!1,interpretNumericEntities:!1,parameterLimit:1e3,parseArrays:!0,plainObjects:!1,strictDepth:!1,strictNullHandling:!1,throwOnLimitExceeded:!1},i=function(f){return f.replace(/&#(\d+);/g,function(d,m){return String.fromCharCode(parseInt(m,10))})},s=function(f,d,m){if(f&&typeof f=="string"&&d.comma&&f.indexOf(",")>-1)return f.split(",");if(d.throwOnLimitExceeded&&m>=d.arrayLimit)throw new RangeError("Array limit exceeded. Only "+d.arrayLimit+" element"+(d.arrayLimit===1?"":"s")+" allowed in an array.");return f},o="utf8=%26%2310003%3B",a="utf8=%E2%9C%93",c=function(d,m){var p={__proto__:null},g=m.ignoreQueryPrefix?d.replace(/^\?/,""):d;g=g.replace(/%5B/gi,"[").replace(/%5D/gi,"]");var y=m.parameterLimit===1/0?void 0:m.parameterLimit,_=g.split(m.delimiter,m.throwOnLimitExceeded?y+1:y);if(m.throwOnLimitExceeded&&_.length>y)throw new RangeError("Parameter limit exceeded. Only "+y+" parameter"+(y===1?"":"s")+" allowed.");var A=-1,T,x=m.charset;if(m.charsetSentinel)for(T=0;T<_.length;++T)_[T].indexOf("utf8=")===0&&(_[T]===a?x="utf-8":_[T]===o&&(x="iso-8859-1"),A=T,T=_.length);for(T=0;T<_.length;++T)if(T!==A){var M=_[T],R=M.indexOf("]="),P=R===-1?M.indexOf("="):R+1,W,F;P===-1?(W=m.decoder(M,n.decoder,x,"key"),F=m.strictNullHandling?null:""):(W=m.decoder(M.slice(0,P),n.decoder,x,"key"),F=t.maybeMap(s(M.slice(P+1),m,r(p[W])?p[W].length:0),function(O){return m.decoder(O,n.decoder,x,"value")})),F&&m.interpretNumericEntities&&x==="iso-8859-1"&&(F=i(String(F))),M.indexOf("[]=")>-1&&(F=r(F)?[F]:F);var G=e.call(p,W);G&&m.duplicates==="combine"?p[W]=t.combine(p[W],F):(!G||m.duplicates==="last")&&(p[W]=F)}return p},l=function(f,d,m,p){var g=0;if(f.length>0&&f[f.length-1]==="[]"){var y=f.slice(0,-1).join("");g=Array.isArray(d)&&d[y]?d[y].length:0}for(var _=p?d:s(d,m,g),A=f.length-1;A>=0;--A){var T,x=f[A];if(x==="[]"&&m.parseArrays)T=m.allowEmptyArrays&&(_===""||m.strictNullHandling&&_===null)?[]:t.combine([],_);else{T=m.plainObjects?{__proto__:null}:{};var M=x.charAt(0)==="["&&x.charAt(x.length-1)==="]"?x.slice(1,-1):x,R=m.decodeDotInKeys?M.replace(/%2E/g,"."):M,P=parseInt(R,10);!m.parseArrays&&R===""?T={0:_}:!isNaN(P)&&x!==R&&String(P)===R&&P>=0&&m.parseArrays&&P<=m.arrayLimit?(T=[],T[P]=_):R!=="__proto__"&&(T[R]=_)}_=T}return _},u=function(d,m,p,g){if(d){var y=p.allowDots?d.replace(/\.([^.[]+)/g,"[$1]"):d,_=/(\[[^[\]]*])/,A=/(\[[^[\]]*])/g,T=p.depth>0&&_.exec(y),x=T?y.slice(0,T.index):y,M=[];if(x){if(!p.plainObjects&&e.call(Object.prototype,x)&&!p.allowPrototypes)return;M.push(x)}for(var R=0;p.depth>0&&(T=A.exec(y))!==null&&R<p.depth;){if(R+=1,!p.plainObjects&&e.call(Object.prototype,T[1].slice(1,-1))&&!p.allowPrototypes)return;M.push(T[1])}if(T){if(p.strictDepth===!0)throw new RangeError("Input depth exceeded depth option of "+p.depth+" and strictDepth is true");M.push("["+y.slice(T.index)+"]")}return l(M,m,p,g)}},h=function(d){if(!d)return n;if(typeof d.allowEmptyArrays<"u"&&typeof d.allowEmptyArrays!="boolean")throw new TypeError("`allowEmptyArrays` option can only be `true` or `false`, when provided");if(typeof d.decodeDotInKeys<"u"&&typeof d.decodeDotInKeys!="boolean")throw new TypeError("`decodeDotInKeys` option can only be `true` or `false`, when provided");if(d.decoder!==null&&typeof d.decoder<"u"&&typeof d.decoder!="function")throw new TypeError("Decoder has to be a function.");if(typeof d.charset<"u"&&d.charset!=="utf-8"&&d.charset!=="iso-8859-1")throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");if(typeof d.throwOnLimitExceeded<"u"&&typeof d.throwOnLimitExceeded!="boolean")throw new TypeError("`throwOnLimitExceeded` option must be a boolean");var m=typeof d.charset>"u"?n.charset:d.charset,p=typeof d.duplicates>"u"?n.duplicates:d.duplicates;if(p!=="combine"&&p!=="first"&&p!=="last")throw new TypeError("The duplicates option must be either combine, first, or last");var g=typeof d.allowDots>"u"?d.decodeDotInKeys===!0?!0:n.allowDots:!!d.allowDots;return{allowDots:g,allowEmptyArrays:typeof d.allowEmptyArrays=="boolean"?!!d.allowEmptyArrays:n.allowEmptyArrays,allowPrototypes:typeof d.allowPrototypes=="boolean"?d.allowPrototypes:n.allowPrototypes,allowSparse:typeof d.allowSparse=="boolean"?d.allowSparse:n.allowSparse,arrayLimit:typeof d.arrayLimit=="number"?d.arrayLimit:n.arrayLimit,charset:m,charsetSentinel:typeof d.charsetSentinel=="boolean"?d.charsetSentinel:n.charsetSentinel,comma:typeof d.comma=="boolean"?d.comma:n.comma,decodeDotInKeys:typeof d.decodeDotInKeys=="boolean"?d.decodeDotInKeys:n.decodeDotInKeys,decoder:typeof d.decoder=="function"?d.decoder:n.decoder,delimiter:typeof d.delimiter=="string"||t.isRegExp(d.delimiter)?d.delimiter:n.delimiter,depth:typeof d.depth=="number"||d.depth===!1?+d.depth:n.depth,duplicates:p,ignoreQueryPrefix:d.ignoreQueryPrefix===!0,interpretNumericEntities:typeof d.interpretNumericEntities=="boolean"?d.interpretNumericEntities:n.interpretNumericEntities,parameterLimit:typeof d.parameterLimit=="number"?d.parameterLimit:n.parameterLimit,parseArrays:d.parseArrays!==!1,plainObjects:typeof d.plainObjects=="boolean"?d.plainObjects:n.plainObjects,strictDepth:typeof d.strictDepth=="boolean"?!!d.strictDepth:n.strictDepth,strictNullHandling:typeof d.strictNullHandling=="boolean"?d.strictNullHandling:n.strictNullHandling,throwOnLimitExceeded:typeof d.throwOnLimitExceeded=="boolean"?d.throwOnLimitExceeded:!1}};return H0=function(f,d){var m=h(d);if(f===""||f===null||typeof f>"u")return m.plainObjects?{__proto__:null}:{};for(var p=typeof f=="string"?c(f,m):f,g=m.plainObjects?{__proto__:null}:{},y=Object.keys(p),_=0;_<y.length;++_){var A=y[_],T=u(A,p[A],m,typeof f=="string");g=t.merge(g,T,m)}return m.allowSparse===!0?g:t.compact(g)},H0}var G0,MA;function Vz(){if(MA)return G0;MA=1;var t=qz(),e=Yz(),r=j0();return G0={formats:r,parse:e,stringify:t},G0}var UA;function Xz(){if(UA)return Vs;UA=1;var t=gz();function e(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}var r=/^([a-z0-9.+-]+:)/i,n=/:[0-9]*$/,i=/^(\/\/?(?!\/)[^?\s]*)(\?[^\s]*)?$/,s=["<",">",'"',"`"," ","\r",`
`,"	"],o=["{","}","|","\\","^","`"].concat(s),a=["'"].concat(o),c=["%","/","?",";","#"].concat(a),l=["/","?","#"],u=255,h=/^[+a-z0-9A-Z_-]{0,63}$/,f=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,d={javascript:!0,"javascript:":!0},m={javascript:!0,"javascript:":!0},p={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},g=Vz();function y(x,M,R){if(x&&typeof x=="object"&&x instanceof e)return x;var P=new e;return P.parse(x,M,R),P}e.prototype.parse=function(x,M,R){if(typeof x!="string")throw new TypeError("Parameter 'url' must be a string, not "+typeof x);var P=x.indexOf("?"),W=P!==-1&&P<x.indexOf("#")?"?":"#",F=x.split(W),G=/\\/g;F[0]=F[0].replace(G,"/"),x=F.join(W);var O=x;if(O=O.trim(),!R&&x.split("#").length===1){var I=i.exec(O);if(I)return this.path=O,this.href=O,this.pathname=I[1],I[2]?(this.search=I[2],M?this.query=g.parse(this.search.substr(1)):this.query=this.search.substr(1)):M&&(this.search="",this.query={}),this}var k=r.exec(O);if(k){k=k[0];var C=k.toLowerCase();this.protocol=C,O=O.substr(k.length)}if(R||k||O.match(/^\/\/[^@/]+@[^@/]+/)){var z=O.substr(0,2)==="//";z&&!(k&&m[k])&&(O=O.substr(2),this.slashes=!0)}if(!m[k]&&(z||k&&!p[k])){for(var B=-1,Q=0;Q<l.length;Q++){var Y=O.indexOf(l[Q]);Y!==-1&&(B===-1||Y<B)&&(B=Y)}var N,U;B===-1?U=O.lastIndexOf("@"):U=O.lastIndexOf("@",B),U!==-1&&(N=O.slice(0,U),O=O.slice(U+1),this.auth=decodeURIComponent(N)),B=-1;for(var Q=0;Q<c.length;Q++){var Y=O.indexOf(c[Q]);Y!==-1&&(B===-1||Y<B)&&(B=Y)}B===-1&&(B=O.length),this.host=O.slice(0,B),O=O.slice(B),this.parseHost(),this.hostname=this.hostname||"";var $=this.hostname[0]==="["&&this.hostname[this.hostname.length-1]==="]";if(!$)for(var X=this.hostname.split(/\./),Q=0,q=X.length;Q<q;Q++){var J=X[Q];if(J&&!J.match(h)){for(var de="",Ee=0,ke=J.length;Ee<ke;Ee++)J.charCodeAt(Ee)>127?de+="x":de+=J[Ee];if(!de.match(h)){var xe=X.slice(0,Q),Te=X.slice(Q+1),Se=J.match(f);Se&&(xe.push(Se[1]),Te.unshift(Se[2])),Te.length&&(O="/"+Te.join(".")+O),this.hostname=xe.join(".");break}}}this.hostname.length>u?this.hostname="":this.hostname=this.hostname.toLowerCase(),$||(this.hostname=t.toASCII(this.hostname));var Me=this.port?":"+this.port:"",je=this.hostname||"";this.host=je+Me,this.href+=this.host,$&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),O[0]!=="/"&&(O="/"+O))}if(!d[C])for(var Q=0,q=a.length;Q<q;Q++){var S=a[Q];if(O.indexOf(S)!==-1){var he=encodeURIComponent(S);he===S&&(he=escape(S)),O=O.split(S).join(he)}}var ie=O.indexOf("#");ie!==-1&&(this.hash=O.substr(ie),O=O.slice(0,ie));var K=O.indexOf("?");if(K!==-1?(this.search=O.substr(K),this.query=O.substr(K+1),M&&(this.query=g.parse(this.query)),O=O.slice(0,K)):M&&(this.search="",this.query={}),O&&(this.pathname=O),p[C]&&this.hostname&&!this.pathname&&(this.pathname="/"),this.pathname||this.search){var Me=this.pathname||"",j=this.search||"";this.path=Me+j}return this.href=this.format(),this};function _(x){return typeof x=="string"&&(x=y(x)),x instanceof e?x.format():e.prototype.format.call(x)}e.prototype.format=function(){var x=this.auth||"";x&&(x=encodeURIComponent(x),x=x.replace(/%3A/i,":"),x+="@");var M=this.protocol||"",R=this.pathname||"",P=this.hash||"",W=!1,F="";this.host?W=x+this.host:this.hostname&&(W=x+(this.hostname.indexOf(":")===-1?this.hostname:"["+this.hostname+"]"),this.port&&(W+=":"+this.port)),this.query&&typeof this.query=="object"&&Object.keys(this.query).length&&(F=g.stringify(this.query,{arrayFormat:"repeat",addQueryPrefix:!1}));var G=this.search||F&&"?"+F||"";return M&&M.substr(-1)!==":"&&(M+=":"),this.slashes||(!M||p[M])&&W!==!1?(W="//"+(W||""),R&&R.charAt(0)!=="/"&&(R="/"+R)):W||(W=""),P&&P.charAt(0)!=="#"&&(P="#"+P),G&&G.charAt(0)!=="?"&&(G="?"+G),R=R.replace(/[?#]/g,function(O){return encodeURIComponent(O)}),G=G.replace("#","%23"),M+W+R+G+P};function A(x,M){return y(x,!1,!0).resolve(M)}e.prototype.resolve=function(x){return this.resolveObject(y(x,!1,!0)).format()};function T(x,M){return x?y(x,!1,!0).resolveObject(M):M}return e.prototype.resolveObject=function(x){if(typeof x=="string"){var M=new e;M.parse(x,!1,!0),x=M}for(var R=new e,P=Object.keys(this),W=0;W<P.length;W++){var F=P[W];R[F]=this[F]}if(R.hash=x.hash,x.href==="")return R.href=R.format(),R;if(x.slashes&&!x.protocol){for(var G=Object.keys(x),O=0;O<G.length;O++){var I=G[O];I!=="protocol"&&(R[I]=x[I])}return p[R.protocol]&&R.hostname&&!R.pathname&&(R.pathname="/",R.path=R.pathname),R.href=R.format(),R}if(x.protocol&&x.protocol!==R.protocol){if(!p[x.protocol]){for(var k=Object.keys(x),C=0;C<k.length;C++){var z=k[C];R[z]=x[z]}return R.href=R.format(),R}if(R.protocol=x.protocol,!x.host&&!m[x.protocol]){for(var q=(x.pathname||"").split("/");q.length&&!(x.host=q.shift()););x.host||(x.host=""),x.hostname||(x.hostname=""),q[0]!==""&&q.unshift(""),q.length<2&&q.unshift(""),R.pathname=q.join("/")}else R.pathname=x.pathname;if(R.search=x.search,R.query=x.query,R.host=x.host||"",R.auth=x.auth,R.hostname=x.hostname||x.host,R.port=x.port,R.pathname||R.search){var B=R.pathname||"",Q=R.search||"";R.path=B+Q}return R.slashes=R.slashes||x.slashes,R.href=R.format(),R}var Y=R.pathname&&R.pathname.charAt(0)==="/",N=x.host||x.pathname&&x.pathname.charAt(0)==="/",U=N||Y||R.host&&x.pathname,$=U,X=R.pathname&&R.pathname.split("/")||[],q=x.pathname&&x.pathname.split("/")||[],J=R.protocol&&!p[R.protocol];if(J&&(R.hostname="",R.port=null,R.host&&(X[0]===""?X[0]=R.host:X.unshift(R.host)),R.host="",x.protocol&&(x.hostname=null,x.port=null,x.host&&(q[0]===""?q[0]=x.host:q.unshift(x.host)),x.host=null),U=U&&(q[0]===""||X[0]==="")),N)R.host=x.host||x.host===""?x.host:R.host,R.hostname=x.hostname||x.hostname===""?x.hostname:R.hostname,R.search=x.search,R.query=x.query,X=q;else if(q.length)X||(X=[]),X.pop(),X=X.concat(q),R.search=x.search,R.query=x.query;else if(x.search!=null){if(J){R.host=X.shift(),R.hostname=R.host;var de=R.host&&R.host.indexOf("@")>0?R.host.split("@"):!1;de&&(R.auth=de.shift(),R.hostname=de.shift(),R.host=R.hostname)}return R.search=x.search,R.query=x.query,(R.pathname!==null||R.search!==null)&&(R.path=(R.pathname?R.pathname:"")+(R.search?R.search:"")),R.href=R.format(),R}if(!X.length)return R.pathname=null,R.search?R.path="/"+R.search:R.path=null,R.href=R.format(),R;for(var Ee=X.slice(-1)[0],ke=(R.host||x.host||X.length>1)&&(Ee==="."||Ee==="..")||Ee==="",xe=0,Te=X.length;Te>=0;Te--)Ee=X[Te],Ee==="."?X.splice(Te,1):Ee===".."?(X.splice(Te,1),xe++):xe&&(X.splice(Te,1),xe--);if(!U&&!$)for(;xe--;xe)X.unshift("..");U&&X[0]!==""&&(!X[0]||X[0].charAt(0)!=="/")&&X.unshift(""),ke&&X.join("/").substr(-1)!=="/"&&X.push("");var Se=X[0]===""||X[0]&&X[0].charAt(0)==="/";if(J){R.hostname=Se?"":X.length?X.shift():"",R.host=R.hostname;var de=R.host&&R.host.indexOf("@")>0?R.host.split("@"):!1;de&&(R.auth=de.shift(),R.hostname=de.shift(),R.host=R.hostname)}return U=U||R.host&&X.length,U&&!Se&&X.unshift(""),X.length>0?R.pathname=X.join("/"):(R.pathname=null,R.path=null),(R.pathname!==null||R.search!==null)&&(R.path=(R.pathname?R.pathname:"")+(R.search?R.search:"")),R.auth=x.auth||R.auth,R.slashes=R.slashes||x.slashes,R.href=R.format(),R},e.prototype.parseHost=function(){var x=this.host,M=n.exec(x);M&&(M=M[0],M!==":"&&(this.port=M.substr(1)),x=x.substr(0,x.length-M.length)),x&&(this.hostname=x)},Vs.parse=y,Vs.resolve=A,Vs.resolveObject=T,Vs.format=_,Vs.Url=e,Vs}var K0,$A;function Zz(){return $A||($A=1,K0=typeof URL=="function"?URL:Xz().URL),K0}var PA;function Pu(){if(PA)return Dn;PA=1;const t=Zz();function e(F,G,O){if(G in F)return F[G];if(arguments.length===3)return O;throw new Error('"'+G+'" is a required argument.')}Dn.getArg=e;const r=(function(){return!("__proto__"in Object.create(null))})();function n(F){return F}function i(F){return o(F)?"$"+F:F}Dn.toSetString=r?n:i;function s(F){return o(F)?F.slice(1):F}Dn.fromSetString=r?n:s;function o(F){if(!F)return!1;const G=F.length;if(G<9||F.charCodeAt(G-1)!==95||F.charCodeAt(G-2)!==95||F.charCodeAt(G-3)!==111||F.charCodeAt(G-4)!==116||F.charCodeAt(G-5)!==111||F.charCodeAt(G-6)!==114||F.charCodeAt(G-7)!==112||F.charCodeAt(G-8)!==95||F.charCodeAt(G-9)!==95)return!1;for(let O=G-10;O>=0;O--)if(F.charCodeAt(O)!==36)return!1;return!0}function a(F,G){return F===G?0:F===null?1:G===null?-1:F>G?1:-1}function c(F,G){let O=F.generatedLine-G.generatedLine;return O!==0||(O=F.generatedColumn-G.generatedColumn,O!==0)||(O=a(F.source,G.source),O!==0)||(O=F.originalLine-G.originalLine,O!==0)||(O=F.originalColumn-G.originalColumn,O!==0)?O:a(F.name,G.name)}Dn.compareByGeneratedPositionsInflated=c;function l(F){return JSON.parse(F.replace(/^\)]}'[^\n]*\n/,""))}Dn.parseSourceMapInput=l;const u="http:",h=`${u}//host`;function f(F){return G=>{const O=y(G),I=p(G),k=new t(G,I);F(k);const C=k.toString();return O==="absolute"?C:O==="scheme-relative"?C.slice(u.length):O==="path-absolute"?C.slice(h.length):_(I,C)}}function d(F,G){return new t(F,G).toString()}function m(F,G){let O=0;do{const I=F+O++;if(G.indexOf(I)===-1)return I}while(!0)}function p(F){const G=F.split("..").length-1,O=m("p",F);let I=`${h}/`;for(let k=0;k<G;k++)I+=`${O}/`;return I}const g=/^[A-Za-z0-9\+\-\.]+:/;function y(F){return F[0]==="/"?F[1]==="/"?"scheme-relative":"path-absolute":g.test(F)?"absolute":"path-relative"}function _(F,G){typeof F=="string"&&(F=new t(F)),typeof G=="string"&&(G=new t(G));const O=G.pathname.split("/"),I=F.pathname.split("/");for(I.length>0&&!I[I.length-1]&&I.pop();O.length>0&&I.length>0&&O[0]===I[0];)O.shift(),I.shift();return I.map(()=>"..").concat(O).join("/")+G.search+G.hash}const A=f(F=>{F.pathname=F.pathname.replace(/\/?$/,"/")}),T=f(F=>{F.href=new t(".",F.toString()).toString()}),x=f(F=>{});Dn.normalize=x;function M(F,G){const O=y(G),I=y(F);if(F=A(F),O==="absolute")return d(G,void 0);if(I==="absolute")return d(G,F);if(O==="scheme-relative")return x(G);if(I==="scheme-relative")return d(G,d(F,h)).slice(u.length);if(O==="path-absolute")return x(G);if(I==="path-absolute")return d(G,d(F,h)).slice(h.length);const k=p(G+F),C=d(G,d(F,k));return _(k,C)}Dn.join=M;function R(F,G){const O=P(F,G);return typeof O=="string"?O:x(G)}Dn.relative=R;function P(F,G){if(y(F)!==y(G))return null;const I=p(F+G),k=new t(F,I),C=new t(G,I);try{new t("",C.toString())}catch{return null}return C.protocol!==k.protocol||C.user!==k.user||C.password!==k.password||C.hostname!==k.hostname||C.port!==k.port?null:_(k,C)}function W(F,G,O){F&&y(G)==="path-absolute"&&(G=G.replace(/^\//,""));let I=x(G||"");return F&&(I=M(F,I)),O&&(I=M(T(O),I)),I}return Dn.computeSourceURL=W,Dn}var q0={},BA;function FA(){if(BA)return q0;BA=1;class t{constructor(){this._array=[],this._set=new Map}static fromArray(r,n){const i=new t;for(let s=0,o=r.length;s<o;s++)i.add(r[s],n);return i}size(){return this._set.size}add(r,n){const i=this.has(r),s=this._array.length;(!i||n)&&this._array.push(r),i||this._set.set(r,s)}has(r){return this._set.has(r)}indexOf(r){const n=this._set.get(r);if(n>=0)return n;throw new Error('"'+r+'" is not in the set.')}at(r){if(r>=0&&r<this._array.length)return this._array[r];throw new Error("No element indexed by "+r)}toArray(){return this._array.slice()}}return q0.ArraySet=t,q0}var Y0={},DA;function Jz(){if(DA)return Y0;DA=1;const t=Pu();function e(n,i){const s=n.generatedLine,o=i.generatedLine,a=n.generatedColumn,c=i.generatedColumn;return o>s||o==s&&c>=a||t.compareByGeneratedPositionsInflated(n,i)<=0}class r{constructor(){this._array=[],this._sorted=!0,this._last={generatedLine:-1,generatedColumn:0}}unsortedForEach(i,s){this._array.forEach(i,s)}add(i){e(this._last,i)?(this._last=i,this._array.push(i)):(this._sorted=!1,this._array.push(i))}toArray(){return this._sorted||(this._array.sort(t.compareByGeneratedPositionsInflated),this._sorted=!0),this._array}}return Y0.MappingList=r,Y0}var jA;function zA(){if(jA)return Vp;jA=1;const t=LE(),e=Pu(),r=FA().ArraySet,n=Jz().MappingList;class i{constructor(o){o||(o={}),this._file=e.getArg(o,"file",null),this._sourceRoot=e.getArg(o,"sourceRoot",null),this._skipValidation=e.getArg(o,"skipValidation",!1),this._sources=new r,this._names=new r,this._mappings=new n,this._sourcesContents=null}static fromSourceMap(o){const a=o.sourceRoot,c=new i({file:o.file,sourceRoot:a});return o.eachMapping(function(l){const u={generated:{line:l.generatedLine,column:l.generatedColumn}};l.source!=null&&(u.source=l.source,a!=null&&(u.source=e.relative(a,u.source)),u.original={line:l.originalLine,column:l.originalColumn},l.name!=null&&(u.name=l.name)),c.addMapping(u)}),o.sources.forEach(function(l){let u=l;a!=null&&(u=e.relative(a,l)),c._sources.has(u)||c._sources.add(u);const h=o.sourceContentFor(l);h!=null&&c.setSourceContent(l,h)}),c}addMapping(o){const a=e.getArg(o,"generated"),c=e.getArg(o,"original",null);let l=e.getArg(o,"source",null),u=e.getArg(o,"name",null);this._skipValidation||this._validateMapping(a,c,l,u),l!=null&&(l=String(l),this._sources.has(l)||this._sources.add(l)),u!=null&&(u=String(u),this._names.has(u)||this._names.add(u)),this._mappings.add({generatedLine:a.line,generatedColumn:a.column,originalLine:c&&c.line,originalColumn:c&&c.column,source:l,name:u})}setSourceContent(o,a){let c=o;this._sourceRoot!=null&&(c=e.relative(this._sourceRoot,c)),a!=null?(this._sourcesContents||(this._sourcesContents=Object.create(null)),this._sourcesContents[e.toSetString(c)]=a):this._sourcesContents&&(delete this._sourcesContents[e.toSetString(c)],Object.keys(this._sourcesContents).length===0&&(this._sourcesContents=null))}applySourceMap(o,a,c){let l=a;if(a==null){if(o.file==null)throw new Error(`SourceMapGenerator.prototype.applySourceMap requires either an explicit source file, or the source map's "file" property. Both were omitted.`);l=o.file}const u=this._sourceRoot;u!=null&&(l=e.relative(u,l));const h=this._mappings.toArray().length>0?new r:this._sources,f=new r;this._mappings.unsortedForEach(function(d){if(d.source===l&&d.originalLine!=null){const g=o.originalPositionFor({line:d.originalLine,column:d.originalColumn});g.source!=null&&(d.source=g.source,c!=null&&(d.source=e.join(c,d.source)),u!=null&&(d.source=e.relative(u,d.source)),d.originalLine=g.line,d.originalColumn=g.column,g.name!=null&&(d.name=g.name))}const m=d.source;m!=null&&!h.has(m)&&h.add(m);const p=d.name;p!=null&&!f.has(p)&&f.add(p)},this),this._sources=h,this._names=f,o.sources.forEach(function(d){const m=o.sourceContentFor(d);m!=null&&(c!=null&&(d=e.join(c,d)),u!=null&&(d=e.relative(u,d)),this.setSourceContent(d,m))},this)}_validateMapping(o,a,c,l){if(a&&typeof a.line!="number"&&typeof a.column!="number")throw new Error("original.line and original.column are not numbers -- you probably meant to omit the original mapping entirely and only map the generated position. If so, pass null for the original mapping instead of an object with empty or null values.");if(!(o&&"line"in o&&"column"in o&&o.line>0&&o.column>=0&&!a&&!c&&!l)){if(!(o&&"line"in o&&"column"in o&&a&&"line"in a&&"column"in a&&o.line>0&&o.column>=0&&a.line>0&&a.column>=0&&c))throw new Error("Invalid mapping: "+JSON.stringify({generated:o,source:c,original:a,name:l}))}}_serializeMappings(){let o=0,a=1,c=0,l=0,u=0,h=0,f="",d,m,p,g;const y=this._mappings.toArray();for(let _=0,A=y.length;_<A;_++){if(m=y[_],d="",m.generatedLine!==a)for(o=0;m.generatedLine!==a;)d+=";",a++;else if(_>0){if(!e.compareByGeneratedPositionsInflated(m,y[_-1]))continue;d+=","}d+=t.encode(m.generatedColumn-o),o=m.generatedColumn,m.source!=null&&(g=this._sources.indexOf(m.source),d+=t.encode(g-h),h=g,d+=t.encode(m.originalLine-1-l),l=m.originalLine-1,d+=t.encode(m.originalColumn-c),c=m.originalColumn,m.name!=null&&(p=this._names.indexOf(m.name),d+=t.encode(p-u),u=p)),f+=d}return f}_generateSourcesContent(o,a){return o.map(function(c){if(!this._sourcesContents)return null;a!=null&&(c=e.relative(a,c));const l=e.toSetString(c);return Object.prototype.hasOwnProperty.call(this._sourcesContents,l)?this._sourcesContents[l]:null},this)}toJSON(){const o={version:this._version,sources:this._sources.toArray(),names:this._names.toArray(),mappings:this._serializeMappings()};return this._file!=null&&(o.file=this._file),this._sourceRoot!=null&&(o.sourceRoot=this._sourceRoot),this._sourcesContents&&(o.sourcesContent=this._generateSourcesContent(o.sources,o.sourceRoot)),o}toString(){return JSON.stringify(this.toJSON())}}return i.prototype._version=3,Vp.SourceMapGenerator=i,Vp}var hc={},V0={},WA;function Qz(){return WA||(WA=1,(function(t){t.GREATEST_LOWER_BOUND=1,t.LEAST_UPPER_BOUND=2;function e(r,n,i,s,o,a){const c=Math.floor((n-r)/2)+r,l=o(i,s[c],!0);return l===0?c:l>0?n-c>1?e(c,n,i,s,o,a):a===t.LEAST_UPPER_BOUND?n<s.length?n:-1:c:c-r>1?e(r,c,i,s,o,a):a==t.LEAST_UPPER_BOUND?c:r<0?-1:r}t.search=function(n,i,s,o){if(i.length===0)return-1;let a=e(-1,i.length,n,i,s,o||t.GREATEST_LOWER_BOUND);if(a<0)return-1;for(;a-1>=0&&s(i[a],i[a-1],!0)===0;)--a;return a}})(V0)),V0}var Bu={exports:{}},HA;function GA(){if(HA)return Bu.exports;HA=1;let t=null;return Bu.exports=function(){if(typeof t=="string")return fetch(t).then(r=>r.arrayBuffer());if(t instanceof ArrayBuffer)return Promise.resolve(t);throw new Error("You must provide the string URL or ArrayBuffer contents of lib/mappings.wasm by calling SourceMapConsumer.initialize({ 'lib/mappings.wasm': ... }) before using SourceMapConsumer")},Bu.exports.initialize=e=>{t=e},Bu.exports}var X0,KA;function e7(){if(KA)return X0;KA=1;const t=GA();function e(){this.generatedLine=0,this.generatedColumn=0,this.lastGeneratedColumn=null,this.source=null,this.originalLine=null,this.originalColumn=null,this.name=null}let r=null;return X0=function(){if(r)return r;const i=[];return r=t().then(s=>WebAssembly.instantiate(s,{env:{mapping_callback(o,a,c,l,u,h,f,d,m,p){const g=new e;g.generatedLine=o+1,g.generatedColumn=a,c&&(g.lastGeneratedColumn=l-1),u&&(g.source=h,g.originalLine=f+1,g.originalColumn=d,m&&(g.name=p)),i[i.length-1](g)},start_all_generated_locations_for(){console.time("all_generated_locations_for")},end_all_generated_locations_for(){console.timeEnd("all_generated_locations_for")},start_compute_column_spans(){console.time("compute_column_spans")},end_compute_column_spans(){console.timeEnd("compute_column_spans")},start_generated_location_for(){console.time("generated_location_for")},end_generated_location_for(){console.timeEnd("generated_location_for")},start_original_location_for(){console.time("original_location_for")},end_original_location_for(){console.timeEnd("original_location_for")},start_parse_mappings(){console.time("parse_mappings")},end_parse_mappings(){console.timeEnd("parse_mappings")},start_sort_by_generated_location(){console.time("sort_by_generated_location")},end_sort_by_generated_location(){console.timeEnd("sort_by_generated_location")},start_sort_by_original_location(){console.time("sort_by_original_location")},end_sort_by_original_location(){console.timeEnd("sort_by_original_location")}}})).then(s=>({exports:s.instance.exports,withMappingCallback:(o,a)=>{i.push(o);try{a()}finally{i.pop()}}})).then(null,s=>{throw r=null,s}),r},X0}var qA;function t7(){if(qA)return hc;qA=1;const t=Pu(),e=Qz(),r=FA().ArraySet;LE();const n=GA(),i=e7(),s=Symbol("smcInternal");class o{constructor(f,d){return f==s?Promise.resolve(this):l(f,d)}static initialize(f){n.initialize(f["lib/mappings.wasm"])}static fromSourceMap(f,d){return u(f,d)}static async with(f,d,m){const p=await new o(f,d);try{return await m(p)}finally{p.destroy()}}eachMapping(f,d,m){throw new Error("Subclasses must implement eachMapping")}allGeneratedPositionsFor(f){throw new Error("Subclasses must implement allGeneratedPositionsFor")}destroy(){throw new Error("Subclasses must implement destroy")}}o.prototype._version=3,o.GENERATED_ORDER=1,o.ORIGINAL_ORDER=2,o.GREATEST_LOWER_BOUND=1,o.LEAST_UPPER_BOUND=2,hc.SourceMapConsumer=o;class a extends o{constructor(f,d){return super(s).then(m=>{let p=f;typeof f=="string"&&(p=t.parseSourceMapInput(f));const g=t.getArg(p,"version"),y=t.getArg(p,"sources").map(String),_=t.getArg(p,"names",[]),A=t.getArg(p,"sourceRoot",null),T=t.getArg(p,"sourcesContent",null),x=t.getArg(p,"mappings"),M=t.getArg(p,"file",null),R=t.getArg(p,"x_google_ignoreList",null);if(g!=m._version)throw new Error("Unsupported version: "+g);return m._sourceLookupCache=new Map,m._names=r.fromArray(_.map(String),!0),m._sources=r.fromArray(y,!0),m._absoluteSources=r.fromArray(m._sources.toArray().map(function(P){return t.computeSourceURL(A,P,d)}),!0),m.sourceRoot=A,m.sourcesContent=T,m._mappings=x,m._sourceMapURL=d,m.file=M,m.x_google_ignoreList=R,m._computedColumnSpans=!1,m._mappingsPtr=0,m._wasm=null,i().then(P=>(m._wasm=P,m))})}_findSourceIndex(f){const d=this._sourceLookupCache.get(f);if(typeof d=="number")return d;const m=t.computeSourceURL(null,f,this._sourceMapURL);if(this._absoluteSources.has(m)){const g=this._absoluteSources.indexOf(m);return this._sourceLookupCache.set(f,g),g}const p=t.computeSourceURL(this.sourceRoot,f,this._sourceMapURL);if(this._absoluteSources.has(p)){const g=this._absoluteSources.indexOf(p);return this._sourceLookupCache.set(f,g),g}return-1}static fromSourceMap(f,d){return new a(f.toString())}get sources(){return this._absoluteSources.toArray()}_getMappingsPtr(){return this._mappingsPtr===0&&this._parseMappings(),this._mappingsPtr}_parseMappings(){const f=this._mappings,d=f.length,m=this._wasm.exports.allocate_mappings(d)>>>0,p=new Uint8Array(this._wasm.exports.memory.buffer,m,d);for(let y=0;y<d;y++)p[y]=f.charCodeAt(y);const g=this._wasm.exports.parse_mappings(m);if(!g){const y=this._wasm.exports.get_last_error();let _=`Error parsing mappings (code ${y}): `;switch(y){case 1:_+="the mappings contained a negative line, column, source index, or name index";break;case 2:_+="the mappings contained a number larger than 2**32";break;case 3:_+="reached EOF while in the middle of parsing a VLQ";break;case 4:_+="invalid base 64 character while parsing a VLQ";break;default:_+="unknown error code";break}throw new Error(_)}this._mappingsPtr=g}eachMapping(f,d,m){const p=d||null,g=m||o.GENERATED_ORDER;this._wasm.withMappingCallback(y=>{y.source!==null&&(y.source=this._absoluteSources.at(y.source),y.name!==null&&(y.name=this._names.at(y.name))),this._computedColumnSpans&&y.lastGeneratedColumn===null&&(y.lastGeneratedColumn=1/0),f.call(p,y)},()=>{switch(g){case o.GENERATED_ORDER:this._wasm.exports.by_generated_location(this._getMappingsPtr());break;case o.ORIGINAL_ORDER:this._wasm.exports.by_original_location(this._getMappingsPtr());break;default:throw new Error("Unknown order of iteration.")}})}allGeneratedPositionsFor(f){let d=t.getArg(f,"source");const m=t.getArg(f,"line"),p=f.column||0;if(d=this._findSourceIndex(d),d<0)return[];if(m<1)throw new Error("Line numbers must be >= 1");if(p<0)throw new Error("Column numbers must be >= 0");const g=[];return this._wasm.withMappingCallback(y=>{let _=y.lastGeneratedColumn;this._computedColumnSpans&&_===null&&(_=1/0),g.push({line:y.generatedLine,column:y.generatedColumn,lastColumn:_})},()=>{this._wasm.exports.all_generated_locations_for(this._getMappingsPtr(),d,m-1,"column"in f,p)}),g}destroy(){this._mappingsPtr!==0&&(this._wasm.exports.free_mappings(this._mappingsPtr),this._mappingsPtr=0)}computeColumnSpans(){this._computedColumnSpans||(this._wasm.exports.compute_column_spans(this._getMappingsPtr()),this._computedColumnSpans=!0)}originalPositionFor(f){const d={generatedLine:t.getArg(f,"line"),generatedColumn:t.getArg(f,"column")};if(d.generatedLine<1)throw new Error("Line numbers must be >= 1");if(d.generatedColumn<0)throw new Error("Column numbers must be >= 0");let m=t.getArg(f,"bias",o.GREATEST_LOWER_BOUND);m==null&&(m=o.GREATEST_LOWER_BOUND);let p;if(this._wasm.withMappingCallback(g=>p=g,()=>{this._wasm.exports.original_location_for(this._getMappingsPtr(),d.generatedLine-1,d.generatedColumn,m)}),p&&p.generatedLine===d.generatedLine){let g=t.getArg(p,"source",null);g!==null&&(g=this._absoluteSources.at(g));let y=t.getArg(p,"name",null);return y!==null&&(y=this._names.at(y)),{source:g,line:t.getArg(p,"originalLine",null),column:t.getArg(p,"originalColumn",null),name:y}}return{source:null,line:null,column:null,name:null}}hasContentsOfAllSources(){return this.sourcesContent?this.sourcesContent.length>=this._sources.size()&&!this.sourcesContent.some(function(f){return f==null}):!1}sourceContentFor(f,d){if(!this.sourcesContent)return null;const m=this._findSourceIndex(f);if(m>=0)return this.sourcesContent[m];if(d)return null;throw new Error('"'+f+'" is not in the SourceMap.')}generatedPositionFor(f){let d=t.getArg(f,"source");if(d=this._findSourceIndex(d),d<0)return{line:null,column:null,lastColumn:null};const m={source:d,originalLine:t.getArg(f,"line"),originalColumn:t.getArg(f,"column")};if(m.originalLine<1)throw new Error("Line numbers must be >= 1");if(m.originalColumn<0)throw new Error("Column numbers must be >= 0");let p=t.getArg(f,"bias",o.GREATEST_LOWER_BOUND);p==null&&(p=o.GREATEST_LOWER_BOUND);let g;if(this._wasm.withMappingCallback(y=>g=y,()=>{this._wasm.exports.generated_location_for(this._getMappingsPtr(),m.source,m.originalLine-1,m.originalColumn,p)}),g&&g.source===m.source){let y=g.lastGeneratedColumn;return this._computedColumnSpans&&y===null&&(y=1/0),{line:t.getArg(g,"generatedLine",null),column:t.getArg(g,"generatedColumn",null),lastColumn:y}}return{line:null,column:null,lastColumn:null}}}a.prototype.consumer=o,hc.BasicSourceMapConsumer=a;class c extends o{constructor(f,d){return super(s).then(m=>{let p=f;typeof f=="string"&&(p=t.parseSourceMapInput(f));const g=t.getArg(p,"version"),y=t.getArg(p,"sections");if(g!=m._version)throw new Error("Unsupported version: "+g);let _={line:-1,column:0};return Promise.all(y.map(A=>{if(A.url)throw new Error("Support for url field in sections not implemented.");const T=t.getArg(A,"offset"),x=t.getArg(T,"line"),M=t.getArg(T,"column");if(x<_.line||x===_.line&&M<_.column)throw new Error("Section offsets must be ordered and non-overlapping.");return _=T,new o(t.getArg(A,"map"),d).then(P=>({generatedOffset:{generatedLine:x+1,generatedColumn:M+1},consumer:P}))})).then(A=>(m._sections=A,m))})}get sources(){const f=[];for(let d=0;d<this._sections.length;d++)for(let m=0;m<this._sections[d].consumer.sources.length;m++)f.push(this._sections[d].consumer.sources[m]);return f}originalPositionFor(f){const d={generatedLine:t.getArg(f,"line"),generatedColumn:t.getArg(f,"column")},m=e.search(d,this._sections,function(g,y){const _=g.generatedLine-y.generatedOffset.generatedLine;return _||g.generatedColumn-(y.generatedOffset.generatedColumn-1)}),p=this._sections[m];return p?p.consumer.originalPositionFor({line:d.generatedLine-(p.generatedOffset.generatedLine-1),column:d.generatedColumn-(p.generatedOffset.generatedLine===d.generatedLine?p.generatedOffset.generatedColumn-1:0),bias:f.bias}):{source:null,line:null,column:null,name:null}}hasContentsOfAllSources(){return this._sections.every(function(f){return f.consumer.hasContentsOfAllSources()})}sourceContentFor(f,d){for(let m=0;m<this._sections.length;m++){const g=this._sections[m].consumer.sourceContentFor(f,!0);if(g)return g}if(d)return null;throw new Error('"'+f+'" is not in the SourceMap.')}_findSectionIndex(f){for(let d=0;d<this._sections.length;d++){const{consumer:m}=this._sections[d];if(m._findSourceIndex(f)!==-1)return d}return-1}generatedPositionFor(f){const d=this._findSectionIndex(t.getArg(f,"source")),m=d>=0?this._sections[d]:null,p=d>=0&&d+1<this._sections.length?this._sections[d+1]:null,g=m&&m.consumer.generatedPositionFor(f);if(g&&g.line!==null){const y=m.generatedOffset.generatedLine-1,_=m.generatedOffset.generatedColumn-1;return g.line===1&&(g.column+=_,typeof g.lastColumn=="number"&&(g.lastColumn+=_)),g.lastColumn===1/0&&p&&g.line===p.generatedOffset.generatedLine&&(g.lastColumn=p.generatedOffset.generatedColumn-2),g.line+=y,g}return{line:null,column:null,lastColumn:null}}allGeneratedPositionsFor(f){const d=this._findSectionIndex(t.getArg(f,"source")),m=d>=0?this._sections[d]:null,p=d>=0&&d+1<this._sections.length?this._sections[d+1]:null;return m?m.consumer.allGeneratedPositionsFor(f).map(g=>{const y=m.generatedOffset.generatedLine-1,_=m.generatedOffset.generatedColumn-1;return g.line===1&&(g.column+=_,typeof g.lastColumn=="number"&&(g.lastColumn+=_)),g.lastColumn===1/0&&p&&g.line===p.generatedOffset.generatedLine&&(g.lastColumn=p.generatedOffset.generatedColumn-2),g.line+=y,g}):[]}eachMapping(f,d,m){this._sections.forEach((p,g)=>{const y=g+1<this._sections.length?this._sections[g+1]:null,{generatedOffset:_}=p,A=_.generatedLine-1,T=_.generatedColumn-1;p.consumer.eachMapping(function(x){x.generatedLine===1&&(x.generatedColumn+=T,typeof x.lastGeneratedColumn=="number"&&(x.lastGeneratedColumn+=T)),x.lastGeneratedColumn===1/0&&y&&x.generatedLine===y.generatedOffset.generatedLine&&(x.lastGeneratedColumn=y.generatedOffset.generatedColumn-2),x.generatedLine+=A,f.call(this,x)},d,m)})}computeColumnSpans(){for(let f=0;f<this._sections.length;f++)this._sections[f].consumer.computeColumnSpans()}destroy(){for(let f=0;f<this._sections.length;f++)this._sections[f].consumer.destroy()}}hc.IndexedSourceMapConsumer=c;function l(h,f){let d=h;typeof h=="string"&&(d=t.parseSourceMapInput(h));const m=d.sections!=null?new c(d,f):new a(d,f);return Promise.resolve(m)}function u(h,f){return a.fromSourceMap(h,f)}return hc}var Z0={},YA;function r7(){if(YA)return Z0;YA=1;const t=zA().SourceMapGenerator,e=Pu(),r=/(\r?\n)/,n=10,i="$$$isSourceNode$$$";class s{constructor(a,c,l,u,h){this.children=[],this.sourceContents={},this.line=a??null,this.column=c??null,this.source=l??null,this.name=h??null,this[i]=!0,u!=null&&this.add(u)}static fromStringWithSourceMap(a,c,l){const u=new s,h=a.split(r);let f=0;const d=function(){const A=x(),T=x()||"";return A+T;function x(){return f<h.length?h[f++]:void 0}};let m=1,p=0,g=null,y;return c.eachMapping(function(A){if(g!==null)if(m<A.generatedLine)_(g,d()),m++,p=0;else{y=h[f]||"";const T=y.substr(0,A.generatedColumn-p);h[f]=y.substr(A.generatedColumn-p),p=A.generatedColumn,_(g,T),g=A;return}for(;m<A.generatedLine;)u.add(d()),m++;p<A.generatedColumn&&(y=h[f]||"",u.add(y.substr(0,A.generatedColumn)),h[f]=y.substr(A.generatedColumn),p=A.generatedColumn),g=A},this),f<h.length&&(g&&_(g,d()),u.add(h.splice(f).join(""))),c.sources.forEach(function(A){const T=c.sourceContentFor(A);T!=null&&(l!=null&&(A=e.join(l,A)),u.setSourceContent(A,T))}),u;function _(A,T){if(A===null||A.source===void 0)u.add(T);else{const x=l?e.join(l,A.source):A.source;u.add(new s(A.originalLine,A.originalColumn,x,T,A.name))}}}add(a){if(Array.isArray(a))a.forEach(function(c){this.add(c)},this);else if(a[i]||typeof a=="string")a&&this.children.push(a);else throw new TypeError("Expected a SourceNode, string, or an array of SourceNodes and strings. Got "+a);return this}prepend(a){if(Array.isArray(a))for(let c=a.length-1;c>=0;c--)this.prepend(a[c]);else if(a[i]||typeof a=="string")this.children.unshift(a);else throw new TypeError("Expected a SourceNode, string, or an array of SourceNodes and strings. Got "+a);return this}walk(a){let c;for(let l=0,u=this.children.length;l<u;l++)c=this.children[l],c[i]?c.walk(a):c!==""&&a(c,{source:this.source,line:this.line,column:this.column,name:this.name})}join(a){let c,l;const u=this.children.length;if(u>0){for(c=[],l=0;l<u-1;l++)c.push(this.children[l]),c.push(a);c.push(this.children[l]),this.children=c}return this}replaceRight(a,c){const l=this.children[this.children.length-1];return l[i]?l.replaceRight(a,c):typeof l=="string"?this.children[this.children.length-1]=l.replace(a,c):this.children.push("".replace(a,c)),this}setSourceContent(a,c){this.sourceContents[e.toSetString(a)]=c}walkSourceContents(a){for(let l=0,u=this.children.length;l<u;l++)this.children[l][i]&&this.children[l].walkSourceContents(a);const c=Object.keys(this.sourceContents);for(let l=0,u=c.length;l<u;l++)a(e.fromSetString(c[l]),this.sourceContents[c[l]])}toString(){let a="";return this.walk(function(c){a+=c}),a}toStringWithSourceMap(a){const c={code:"",line:1,column:0},l=new t(a);let u=!1,h=null,f=null,d=null,m=null;return this.walk(function(p,g){c.code+=p,g.source!==null&&g.line!==null&&g.column!==null?((h!==g.source||f!==g.line||d!==g.column||m!==g.name)&&l.addMapping({source:g.source,original:{line:g.line,column:g.column},generated:{line:c.line,column:c.column},name:g.name}),h=g.source,f=g.line,d=g.column,m=g.name,u=!0):u&&(l.addMapping({generated:{line:c.line,column:c.column}}),h=null,u=!1);for(let y=0,_=p.length;y<_;y++)p.charCodeAt(y)===n?(c.line++,c.column=0,y+1===_?(h=null,u=!1):u&&l.addMapping({source:g.source,original:{line:g.line,column:g.column},generated:{line:c.line,column:c.column},name:g.name})):c.column++}),this.walkSourceContents(function(p,g){l.setSourceContent(p,g)}),{code:c.code,map:l}}}return Z0.SourceNode=s,Z0}var VA;function n7(){return VA||(VA=1,lc.SourceMapGenerator=zA().SourceMapGenerator,lc.SourceMapConsumer=t7().SourceMapConsumer,lc.SourceNode=r7().SourceNode),lc}var i7=n7();let XA=0;const ZA=ei,s7=["Command","lines"];class o7 extends fP{constructor(){super(Tx,{traceInitPerf:ei,skipValidations:!ei,maxLookahead:2,recoveryEnabled:!0,nodeLocationTracking:"full"}),this.performSelfAnalysis()}PEEK(e,r,...n){console.info(e,n.map(i=>[i.image,i.tokenType]),r)}RULED(e,r,n){const i=s7.some(s=>e.includes(s));return this.RULE(e,()=>{const o=(XA++).toString().padStart(3),a=i?"font-weight: bold;":"";if(ZA&&!this.RECORDING_PHASE){const c=[this.LA(1),this.LA(2),this.LA(3)].map(l=>`[${l.tokenType.name} ${l.image.replaceAll(`
`,"\\n")}]`);console.info(`${o}%c> ${e} ${c.join(" ")}`,a)}r(),ZA&&!this.RECORDING_PHASE&&console.info(`${o}%c< ${e} `,a),XA--},n)}program=this.RULED("program",()=>{this.MANY(()=>this.SUBRULE(this.line))});line=this.RULED("line",()=>{this.OR([{ALT:()=>this.SUBRULE(this.stmt)},{ALT:()=>this.CONSUME(du)}])});stmt=this.RULED("stmt",()=>{this.OR([{ALT:()=>this.SUBRULE(this.stmt_label)},{ALT:()=>this.SUBRULE(this.stmt_stat)},{ALT:()=>this.SUBRULE(this.stmt_text)},{ALT:()=>this.SUBRULE(this.stmt_comment)},{ALT:()=>this.SUBRULE(this.stmt_hyperlink)},{ALT:()=>this.SUBRULE(this.stmt_command)},{ALT:()=>this.SUBRULE(this.short_go)},{ALT:()=>this.SUBRULE(this.short_try)}])});inline_go=this.RULED("inline_go",()=>{this.SUBRULE(this.short_go),this.OPTION(()=>this.SUBRULE(this.inline))});inline_try=this.RULED("inline_try",()=>{this.SUBRULE(this.short_try),this.OPTION(()=>this.SUBRULE(this.inline))});inline_command=this.RULED("inline_command",()=>{this.SUBRULE(this.stmt_command),this.OPTION(()=>this.SUBRULE(this.inline))});inline=this.RULED("inline",()=>{this.OR([{ALT:()=>this.SUBRULE(this.stmt_stat)},{ALT:()=>this.SUBRULE(this.stmt_text)},{ALT:()=>this.SUBRULE(this.stmt_comment)},{ALT:()=>this.SUBRULE(this.stmt_hyperlink)},{ALT:()=>this.SUBRULE(this.structured_cmd)},{ALT:()=>this.SUBRULE(this.inline_go)},{ALT:()=>this.SUBRULE(this.inline_try)},{ALT:()=>this.SUBRULE(this.inline_command)}])});stmt_label=this.RULED("stmt_label",()=>{this.CONSUME(ip)});stmt_stat=this.RULED("stmt_stat",()=>{this.CONSUME(np)});stmt_text=this.RULED("stmt_text",()=>{this.OR([{ALT:()=>this.CONSUME(xw)}])});stmt_comment=this.RULED("stmt_comment",()=>{this.CONSUME(Ew)});stmt_hyperlink=this.RULED("stmt_hyperlink",()=>{this.CONSUME(Aw),this.CONSUME(Tw)});stmt_command=this.RULED("stmt_command",()=>{this.CONSUME(Po),this.OR([{ALT:()=>this.SUBRULE(this.words)},{ALT:()=>this.SUBRULE(this.structured_cmd)}])});structured_cmd=this.RULED("structured_cmd",()=>{this.OR([{ALT:()=>this.SUBRULE(this.command_if)},{ALT:()=>this.SUBRULE(this.command_while)},{ALT:()=>this.SUBRULE(this.command_repeat)},{ALT:()=>this.SUBRULE(this.command_waitfor)},{ALT:()=>this.SUBRULE(this.command_foreach)},{ALT:()=>this.SUBRULE(this.command_break)},{ALT:()=>this.SUBRULE(this.command_continue)}])});short_go=this.RULED("short_go",()=>{this.CONSUME(hp),this.OR([{ALT:()=>this.SUBRULE(this.string_token)},{ALT:()=>this.SUBRULE(this.dir)}])});short_try=this.RULED("short_try",()=>{this.CONSUME(dx),this.OR([{ALT:()=>this.SUBRULE(this.string_token)},{ALT:()=>this.SUBRULE(this.dir)}])});command_if=this.RULED("command_if",()=>{this.CONSUME(fp),this.SUBRULE(this.words),this.OPTION(()=>this.SUBRULE(this.command_if_block))});command_if_block=this.RULED("command_if_block",()=>{this.OR([{ALT:()=>this.SUBRULE(this.inline)},{ALT:()=>{this.CONSUME(mu),this.MANY(()=>this.SUBRULE(this.line)),this.MANY2({GATE:this.BACKTRACK(this.command_else_if),DEF:()=>this.SUBRULE(this.command_else_if)}),this.OPTION(()=>this.SUBRULE(this.command_else)),this.MANY3(()=>this.CONSUME3(du)),this.CONSUME4(Po),this.CONSUME4(dp)}}])});command_block=this.RULED("command_block",()=>{this.OR([{ALT:()=>this.SUBRULE(this.inline)},{ALT:()=>{this.CONSUME(mu),this.MANY(()=>this.SUBRULE(this.line)),this.CONSUME(Po),this.CONSUME(dp)}}])});command_fork=this.RULED("command_fork",()=>{this.OR([{ALT:()=>this.SUBRULE(this.inline)},{ALT:()=>{this.CONSUME(mu),this.MANY({GATE:this.BACKTRACK(this.line),DEF:()=>this.SUBRULE(this.line)})}}])});command_else_if=this.RULED("command_else_if",()=>{this.CONSUME(Po),this.CONSUME(pp),this.CONSUME(fp),this.SUBRULE(this.words),this.OPTION(()=>this.SUBRULE(this.command_fork))});command_else=this.RULED("command_else",()=>{this.CONSUME(Po),this.CONSUME(pp),this.OPTION1(()=>this.SUBRULE(this.words)),this.OPTION2(()=>this.SUBRULE(this.command_fork))});command_while=this.RULED("command_while",()=>{this.CONSUME(bx),this.SUBRULE(this.words),this.OPTION(()=>this.SUBRULE(this.command_block))});command_repeat=this.RULED("command_repeat",()=>{this.CONSUME(wx),this.SUBRULE(this.words),this.OPTION(()=>this.SUBRULE(this.command_block))});command_waitfor=this.RULED("command_waitfor",()=>{this.CONSUME(kx),this.SUBRULE(this.words),this.OPTION(()=>this.SUBRULE(this.command_block))});command_foreach=this.RULED("command_foreach",()=>{this.CONSUME(vx),this.SUBRULE(this.words),this.OPTION(()=>this.SUBRULE(this.command_block))});command_break=this.RULED("command_break",()=>{this.CONSUME(xx)});command_continue=this.RULED("command_continue",()=>{this.CONSUME(Ex)});command_play=this.RULED("command_play",()=>{this.CONSUME(gx)});command_toast=this.RULED("command_toast",()=>{this.CONSUME(yx)});command_ticker=this.RULED("command_ticker",()=>{this.CONSUME(_x)});expr=this.RULED("expr",()=>{this.SUBRULE1(this.and_test,{LABEL:"LHS"}),this.MANY(()=>{this.CONSUME(op),this.SUBRULE2(this.and_test,{LABEL:"RHS"})})});and_test=this.RULED("and_test",()=>{this.SUBRULE1(this.not_test,{LABEL:"LHS"}),this.MANY(()=>{this.CONSUME(cp),this.SUBRULE2(this.not_test,{LABEL:"RHS"})})});not_test=this.RULED("not_test",()=>{this.OR([{ALT:()=>{this.CONSUME(ap),this.SUBRULE1(this.not_test,{LABEL:"LHS"})}},{ALT:()=>this.SUBRULE2(this.comparison)}])});comparison=this.RULED("comparison",()=>{this.SUBRULE1(this.arith_expr,{LABEL:"LHS"}),this.MANY(()=>{this.SUBRULE(this.comp_op),this.SUBRULE2(this.arith_expr,{LABEL:"RHS"})})});comp_op=this.RULED("comp_op",()=>{this.OR([{ALT:()=>this.CONSUME(nx)},{ALT:()=>this.CONSUME(ix)},{ALT:()=>this.CONSUME(sx)},{ALT:()=>this.CONSUME(ox)},{ALT:()=>this.CONSUME(ax)},{ALT:()=>this.CONSUME(cx)}])});expr_value=this.RULED("expr_value",()=>{this.SUBRULE1(this.and_test_value,{LABEL:"LHS"}),this.MANY(()=>{this.CONSUME(op),this.SUBRULE2(this.and_test_value,{LABEL:"RHS"})})});and_test_value=this.RULED("and_test_value",()=>{this.SUBRULE1(this.not_test_value,{LABEL:"LHS"}),this.MANY(()=>{this.CONSUME(cp),this.SUBRULE2(this.not_test_value,{LABEL:"RHS"})})});not_test_value=this.RULED("not_test_value",()=>{this.OR([{ALT:()=>{this.CONSUME(ap),this.SUBRULE1(this.not_test_value,{LABEL:"LHS"})}},{ALT:()=>this.SUBRULE2(this.arith_expr)}])});arith_expr=this.RULED("arith_expr",()=>{this.OR([{ALT:()=>this.SUBRULE(this.token_expr,{LABEL:"LHS"})},{ALT:()=>{this.SUBRULE1(this.term),this.MANY(()=>this.SUBRULE2(this.arith_expr_item,{LABEL:"RHS"}))}}])});arith_expr_item=this.RULED("arith_expr_item",()=>{this.OR([{ALT:()=>this.CONSUME(lp)},{ALT:()=>this.CONSUME(up)}]),this.SUBRULE(this.term)});term=this.RULED("term",()=>{this.SUBRULE1(this.factor),this.MANY(()=>this.SUBRULE2(this.term_item))});term_item=this.RULED("term_item",()=>{this.OR([{ALT:()=>this.CONSUME(ux)},{ALT:()=>this.CONSUME(hp)},{ALT:()=>this.CONSUME(hx)},{ALT:()=>this.CONSUME(fx)}]),this.SUBRULE(this.factor)});factor=this.RULED("factor",()=>{this.OR1([{ALT:()=>{this.OR2([{ALT:()=>this.CONSUME(lp)},{ALT:()=>this.CONSUME(up)}]),this.SUBRULE(this.factor,{LABEL:"LHS"})}},{ALT:()=>this.SUBRULE(this.power)}])});power=this.RULED("power",()=>{this.SUBRULE(this.token),this.OPTION(()=>{this.CONSUME(lx),this.SUBRULE(this.factor)})});words=this.RULED("words",()=>{this.AT_LEAST_ONE(()=>this.SUBRULE(this.expr))});kind=this.RULED("kind",()=>{this.OPTION(()=>this.SUBRULE(this.color)),this.SUBRULE(this.string_token)});category=this.RULED("category",()=>{this.OR([{ALT:()=>this.CONSUME(Sw)},{ALT:()=>this.CONSUME(Rw)}])});collision=this.RULED("collision",()=>{this.OR([{ALT:()=>this.CONSUME(Ow)},{ALT:()=>this.CONSUME(Iw)},{ALT:()=>this.CONSUME(Nw)},{ALT:()=>this.CONSUME(Cw)},{ALT:()=>this.CONSUME(Lw)},{ALT:()=>this.CONSUME(Mw)},{ALT:()=>this.CONSUME(Uw)},{ALT:()=>this.CONSUME($w)},{ALT:()=>this.CONSUME(Pw)}])});color=this.RULED("color",()=>{this.OR([{ALT:()=>this.CONSUME(Bw)},{ALT:()=>this.CONSUME(Fw)},{ALT:()=>this.CONSUME(Dw)},{ALT:()=>this.CONSUME(jw)},{ALT:()=>this.CONSUME(zw)},{ALT:()=>this.CONSUME(Ww)},{ALT:()=>this.CONSUME(Hw)},{ALT:()=>this.CONSUME(Gw)},{ALT:()=>this.CONSUME(Kw)},{ALT:()=>this.CONSUME(qw)},{ALT:()=>this.CONSUME(Yw)},{ALT:()=>this.CONSUME(Vw)},{ALT:()=>this.CONSUME(Xw)},{ALT:()=>this.CONSUME(Zw)},{ALT:()=>this.CONSUME(Jw)},{ALT:()=>this.CONSUME(Qw)},{ALT:()=>this.CONSUME(ek)},{ALT:()=>this.CONSUME(tk)},{ALT:()=>this.CONSUME(rk)},{ALT:()=>this.CONSUME(nk)},{ALT:()=>this.CONSUME(ik)},{ALT:()=>this.CONSUME(sk)},{ALT:()=>this.CONSUME(ok)},{ALT:()=>this.CONSUME(ak)},{ALT:()=>this.CONSUME(ck)},{ALT:()=>this.CONSUME(lk)},{ALT:()=>this.CONSUME(uk)},{ALT:()=>this.CONSUME(hk)},{ALT:()=>this.CONSUME(fk)},{ALT:()=>this.CONSUME(dk)},{ALT:()=>this.CONSUME(pk)},{ALT:()=>this.CONSUME(mk)},{ALT:()=>this.CONSUME(gk)},{ALT:()=>this.CONSUME(yk)},{ALT:()=>this.CONSUME(_k)},{ALT:()=>this.CONSUME(bk)},{ALT:()=>this.CONSUME(wk)},{ALT:()=>this.CONSUME(kk)},{ALT:()=>this.CONSUME(vk)},{ALT:()=>this.CONSUME(xk)},{ALT:()=>this.CONSUME(Ek)},{ALT:()=>this.CONSUME(Ak)},{ALT:()=>this.CONSUME(Tk)},{ALT:()=>this.CONSUME(Sk)},{ALT:()=>this.CONSUME(Rk)},{ALT:()=>this.CONSUME(Ok)},{ALT:()=>this.CONSUME(Ik)},{ALT:()=>this.CONSUME(Nk)},{ALT:()=>this.CONSUME(Ck)},{ALT:()=>this.CONSUME(Lk)},{ALT:()=>this.CONSUME(Mk)},{ALT:()=>this.CONSUME(Uk)},{ALT:()=>this.CONSUME($k)},{ALT:()=>this.CONSUME(Pk)},{ALT:()=>this.CONSUME(Bk)},{ALT:()=>this.CONSUME(Fk)},{ALT:()=>this.CONSUME(Dk)},{ALT:()=>this.CONSUME(jk)},{ALT:()=>this.CONSUME(zk)},{ALT:()=>this.CONSUME(Wk)},{ALT:()=>this.CONSUME(Hk)},{ALT:()=>this.CONSUME(Gk)},{ALT:()=>this.CONSUME(Kk)},{ALT:()=>this.CONSUME(qk)},{ALT:()=>this.CONSUME(Yk)},{ALT:()=>this.CONSUME(Vk)},{ALT:()=>this.CONSUME(Xk)},{ALT:()=>this.CONSUME(Zk)},{ALT:()=>this.CONSUME(Jk)},{ALT:()=>this.CONSUME(Qk)}])});dir_mod=this.RULED("dir_mod",()=>{this.OR([{ALT:()=>this.CONSUME(fv)},{ALT:()=>this.CONSUME(dv)},{ALT:()=>this.CONSUME(pv)},{ALT:()=>this.CONSUME(mv)},{ALT:()=>this.CONSUME(Mv)},{ALT:()=>this.CONSUME(Uv)},{ALT:()=>this.SUBRULE(this.dir_within)},{ALT:()=>this.SUBRULE(this.dir_awayby)}])});dir_by=this.RULED("dir_by",()=>{this.CONSUME(sv),this.SUBRULE1(this.simple_token),this.SUBRULE2(this.simple_token)});dir_at=this.RULED("dir_at",()=>{this.CONSUME(ov),this.SUBRULE1(this.simple_token),this.SUBRULE2(this.simple_token)});dir_away=this.RULED("dir_away",()=>{this.CONSUME(gv),this.SUBRULE1(this.simple_token),this.SUBRULE2(this.simple_token)});dir_toward=this.RULED("dir_toward",()=>{this.CONSUME(yv),this.SUBRULE1(this.simple_token),this.SUBRULE2(this.simple_token)});dir_find=this.RULED("dir_find",()=>{this.CONSUME(_v),this.SUBRULE1(this.kind)});dir_flee=this.RULED("dir_flee",()=>{this.CONSUME(bv),this.SUBRULE1(this.kind)});dir_to=this.RULED("dir_to",()=>{this.CONSUME(wv),this.SUBRULE1(this.dir),this.SUBRULE2(this.dir)});dir_within=this.RULED("dir_within",()=>{this.CONSUME($v),this.SUBRULE1(this.simple_token)});dir_awayby=this.RULED("dir_awayby",()=>{this.CONSUME(Pv),this.SUBRULE1(this.simple_token)});dir=this.RULED("dir",()=>{this.MANY(()=>this.SUBRULE(this.dir_mod)),this.OR([{ALT:()=>this.CONSUME(ev)},{ALT:()=>this.CONSUME(tv)},{ALT:()=>this.CONSUME(rv)},{ALT:()=>this.CONSUME(nv)},{ALT:()=>this.CONSUME(iv)},{ALT:()=>this.SUBRULE(this.dir_by)},{ALT:()=>this.SUBRULE(this.dir_at)},{ALT:()=>this.SUBRULE(this.dir_away)},{ALT:()=>this.SUBRULE(this.dir_toward)},{ALT:()=>this.CONSUME(av)},{ALT:()=>this.CONSUME(cv)},{ALT:()=>this.CONSUME(lv)},{ALT:()=>this.CONSUME(uv)},{ALT:()=>this.CONSUME(hv)},{ALT:()=>this.SUBRULE(this.dir_find)},{ALT:()=>this.SUBRULE(this.dir_flee)},{ALT:()=>this.SUBRULE(this.dir_to)},{ALT:()=>this.CONSUME(kv)},{ALT:()=>this.CONSUME(vv)},{ALT:()=>this.CONSUME(xv)},{ALT:()=>this.CONSUME(Ev)},{ALT:()=>this.CONSUME(Av)},{ALT:()=>this.CONSUME(Tv)},{ALT:()=>this.CONSUME(Sv)},{ALT:()=>this.CONSUME(Rv)},{ALT:()=>this.CONSUME(Ov)},{ALT:()=>this.CONSUME(Iv)},{ALT:()=>this.CONSUME(Nv)},{ALT:()=>this.CONSUME(Cv)},{ALT:()=>this.CONSUME(Lv)}])});expr_any=this.RULED("expr_any",()=>{this.OR1([{ALT:()=>this.SUBRULE1(this.kind)},{ALT:()=>this.SUBRULE1(this.color)},{ALT:()=>{this.SUBRULE(this.dir),this.OR2([{ALT:()=>this.SUBRULE2(this.kind)},{ALT:()=>this.SUBRULE2(this.color)}])}}])});token_expr_any=this.RULED("token_expr_any",()=>{this.CONSUME(jv),this.SUBRULE(this.expr_any)});token_expr_count=this.RULED("token_expr_count",()=>{this.CONSUME(zv),this.SUBRULE(this.expr_any)});token_expr_blocked=this.RULED("token_expr_blocked",()=>{this.CONSUME(Dv),this.SUBRULE(this.dir)});token_expr_abs=this.RULED("token_expr_abs",()=>{this.CONSUME(Wv),this.SUBRULE(this.simple_token)});token_expr_intceil=this.RULED("token_expr_intceil",()=>{this.CONSUME(Hv),this.SUBRULE(this.simple_token)});token_expr_intfloor=this.RULED("token_expr_intfloor",()=>{this.CONSUME(Gv),this.SUBRULE(this.simple_token)});token_expr_intround=this.RULED("token_expr_intround",()=>{this.CONSUME(Kv),this.SUBRULE(this.simple_token)});token_expr_clamp=this.RULED("token_expr_clamp",()=>{this.CONSUME(qv),this.SUBRULE1(this.simple_token),this.SUBRULE2(this.simple_token),this.SUBRULE3(this.simple_token)});token_expr_min=this.RULED("token_expr_min",()=>{this.CONSUME(Yv),this.AT_LEAST_ONE(()=>this.SUBRULE1(this.simple_token))});token_expr_max=this.RULED("token_expr_max",()=>{this.CONSUME(Vv),this.AT_LEAST_ONE(()=>this.SUBRULE1(this.simple_token))});token_expr_pick=this.RULED("token_expr_pick",()=>{this.CONSUME(Xv),this.AT_LEAST_ONE(()=>this.SUBRULE1(this.simple_token))});token_expr_pickwith=this.RULED("token_expr_pickwith",()=>{this.CONSUME(Zv),this.SUBRULE1(this.simple_token),this.AT_LEAST_ONE(()=>this.SUBRULE2(this.simple_token))});token_expr_random=this.RULED("token_expr_random",()=>{this.CONSUME(Jv),this.SUBRULE1(this.simple_token),this.OPTION(()=>this.SUBRULE2(this.simple_token))});token_expr_randomwith=this.RULED("token_expr_randomwith",()=>{this.CONSUME(Qv),this.SUBRULE1(this.simple_token),this.SUBRULE2(this.simple_token),this.OPTION(()=>this.SUBRULE3(this.simple_token))});token_expr_run=this.RULED("token_expr_run",()=>{this.CONSUME(ex),this.SUBRULE(this.string_token)});token_expr_runwith=this.RULED("token_expr_runwith",()=>{this.CONSUME(tx),this.SUBRULE(this.simple_token),this.SUBRULE(this.string_token)});token_expr=this.RULED("token_expr",()=>{this.OR([{ALT:()=>this.CONSUME(Bv)},{ALT:()=>this.CONSUME(Fv)},{ALT:()=>this.SUBRULE(this.token_expr_any)},{ALT:()=>this.SUBRULE(this.token_expr_count)},{ALT:()=>this.SUBRULE(this.token_expr_blocked)},{ALT:()=>this.SUBRULE(this.token_expr_abs)},{ALT:()=>this.SUBRULE(this.token_expr_intceil)},{ALT:()=>this.SUBRULE(this.token_expr_intfloor)},{ALT:()=>this.SUBRULE(this.token_expr_intround)},{ALT:()=>this.SUBRULE(this.token_expr_clamp)},{ALT:()=>this.SUBRULE(this.token_expr_min)},{ALT:()=>this.SUBRULE(this.token_expr_max)},{ALT:()=>this.SUBRULE(this.token_expr_pick)},{ALT:()=>this.SUBRULE(this.token_expr_pickwith)},{ALT:()=>this.SUBRULE(this.token_expr_random)},{ALT:()=>this.SUBRULE(this.token_expr_randomwith)},{ALT:()=>this.SUBRULE(this.token_expr_run)},{ALT:()=>this.SUBRULE(this.token_expr_runwith)}])});string_token=this.RULED("string_token",()=>{this.OR([{ALT:()=>this.CONSUME(Ht)},{ALT:()=>this.CONSUME(pu)}])});simple_token=this.RULED("simple_token",()=>{this.OR([{ALT:()=>this.CONSUME(sp)},{ALT:()=>this.CONSUME(Ht)},{ALT:()=>this.CONSUME(pu)},{ALT:()=>this.SUBRULE(this.color)}])});token=this.RULED("token",()=>{this.OR([{ALT:()=>this.SUBRULE(this.category)},{ALT:()=>this.SUBRULE(this.collision)},{ALT:()=>this.SUBRULE(this.color)},{ALT:()=>this.SUBRULE(this.dir)},{ALT:()=>this.SUBRULE(this.command_play)},{ALT:()=>this.SUBRULE(this.command_toast)},{ALT:()=>this.SUBRULE(this.command_ticker)},{ALT:()=>this.CONSUME(ip)},{ALT:()=>this.CONSUME(pu)},{ALT:()=>this.CONSUME(Ht)},{ALT:()=>this.CONSUME(sp)},{ALT:()=>this.CONSUME(rx)},{ALT:()=>{this.CONSUME(px),this.SUBRULE(this.expr),this.CONSUME(mx)}}])})}const Yo=new o7;if(CC){const t=Yo.getGAstProductions(),e=EP(t);console.info(e)}const a7=Yo.getBaseCstVisitorConstructor();var Ce=(t=>(t[t.PROGRAM=0]="PROGRAM",t[t.API=1]="API",t[t.LINE=2]="LINE",t[t.MARK=3]="MARK",t[t.GOTO=4]="GOTO",t[t.COUNT=5]="COUNT",t[t.TEXT=6]="TEXT",t[t.LABEL=7]="LABEL",t[t.HYPERLINK=8]="HYPERLINK",t[t.STAT=9]="STAT",t[t.MOVE=10]="MOVE",t[t.COMMAND=11]="COMMAND",t[t.LITERAL=12]="LITERAL",t[t.IF=13]="IF",t[t.IF_CHECK=14]="IF_CHECK",t[t.IF_BLOCK=15]="IF_BLOCK",t[t.ELSE_IF=16]="ELSE_IF",t[t.ELSE=17]="ELSE",t[t.WHILE=18]="WHILE",t[t.BREAK=19]="BREAK",t[t.CONTINUE=20]="CONTINUE",t[t.REPEAT=21]="REPEAT",t[t.WAITFOR=22]="WAITFOR",t[t.FOREACH=23]="FOREACH",t[t.OR=24]="OR",t[t.AND=25]="AND",t[t.NOT=26]="NOT",t[t.COMPARE=27]="COMPARE",t[t.COMPARE_ITEM=28]="COMPARE_ITEM",t[t.OPERATOR=29]="OPERATOR",t[t.OPERATOR_ITEM=30]="OPERATOR_ITEM",t[t.EXPR=31]="EXPR",t))(Ce||{}),Xs=(t=>(t[t.IS_EQ=0]="IS_EQ",t[t.IS_NOT_EQ=1]="IS_NOT_EQ",t[t.IS_LESS_THAN=2]="IS_LESS_THAN",t[t.IS_GREATER_THAN=3]="IS_GREATER_THAN",t[t.IS_LESS_THAN_OR_EQ=4]="IS_LESS_THAN_OR_EQ",t[t.IS_GREATER_THAN_OR_EQ=5]="IS_GREATER_THAN_OR_EQ",t))(Xs||{}),fi=(t=>(t[t.EMPTY=0]="EMPTY",t[t.PLUS=1]="PLUS",t[t.MINUS=2]="MINUS",t[t.POWER=3]="POWER",t[t.MULTIPLY=4]="MULTIPLY",t[t.DIVIDE=5]="DIVIDE",t[t.MOD_DIVIDE=6]="MOD_DIVIDE",t[t.FLOOR_DIVIDE=7]="FLOOR_DIVIDE",t[t.UNI_PLUS=8]="UNI_PLUS",t[t.UNI_MINUS=9]="UNI_MINUS",t))(fi||{}),Fu=(t=>(t[t.NUMBER=0]="NUMBER",t[t.STRING=1]="STRING",t[t.TEMPLATE=2]="TEMPLATE",t))(Fu||{});function Gt(t,e){const[r]=t??[];return(r?.image??e).trimStart().replaceAll(/^"|"$/g,"")}class c7 extends a7{unique=0;constructor(){super(),ei&&this.validateVisitor()}visit(e){if(ut(e)&&(e=e[0]),!!w(e))return this[e.name](e.children,e.location)}createcodenode(e,r){return[{...r,...e,lineindex:0}]}createstringnode(e,r){return this.createcodenode(e,{type:12,literal:1,value:r})}createtemplatenode(e,r){return this.createcodenode(e,{type:12,literal:2,value:r})}createmarknode(e,r,n){return this.createlinenode(e,this.createcodenode(e,{type:3,id:r,comment:n}))}creategotonode(e,r,n){return this.createlinenode(e,this.createcodenode(e,{type:4,id:r,comment:n}))}createlinenode(e,r){return this.createcodenode(e,{type:2,stmts:r})}createapinode(e,r,n){return this.createlinenode(e,this.createcodenode(e,{type:1,words:n,method:r}))}createlogicnode(e,r,n,i){return this.createlinenode(e,this.createcodenode(e,{type:14,skip:n,words:i,method:r}))}createcountnode(e){return this.createcodenode(e,{type:5,index:this.unique++})}createexprnodeondemand(e,r){return e.length===1?e[0]:this.createcodenode(r,{type:31,words:e})[0]}go(e){return Array.isArray(e)?e.map(r=>this.visit(r)).flat():w(e)?[this.visit(e)].flat():[]}program(e,r){return this.unique=0,this.createcodenode(r,{type:0,lines:[this.createlinenode(r,this.createcodenode(r,{type:7,active:!0,name:"restart"})),this.go(e.line)].flat()})}line(e){return e.stmt?this.go(e.stmt):[]}stmt(e){return e.stmt_label?this.go(e.stmt_label):e.stmt_stat?this.go(e.stmt_stat):e.stmt_text?this.go(e.stmt_text):e.stmt_comment?this.go(e.stmt_comment):e.stmt_hyperlink?this.go(e.stmt_hyperlink):e.stmt_command?this.go(e.stmt_command):e.short_go?this.go(e.short_go):e.short_try?this.go(e.short_try):[]}inline_go(e){const r=[];return e.short_go&&r.push(...this.go(e.short_go)),e.inline&&r.push(...this.go(e.inline)),r}inline_try(e){const r=[];return e.short_try&&r.push(...this.go(e.short_try)),e.inline&&r.push(...this.go(e.inline)),r}inline_command(e){const r=[];return e.stmt_command&&r.push(...this.go(e.stmt_command)),e.inline&&r.push(...this.go(e.inline)),r}inline(e){const r=[];return e.stmt_stat&&r.push(...this.go(e.stmt_stat)),e.stmt_text&&r.push(...this.go(e.stmt_text)),e.stmt_comment&&r.push(...this.go(e.stmt_comment)),e.stmt_hyperlink&&r.push(...this.go(e.stmt_hyperlink)),e.inline_go&&r.push(...this.go(e.inline_go)),e.inline_try&&r.push(...this.go(e.inline_try)),e.inline_command&&r.push(...this.go(e.inline_command)),e.structured_cmd&&r.push(...this.go(e.structured_cmd)),r}stmt_label(e,r){return this.createlinenode(r,this.createcodenode(r,{type:7,active:!0,name:Gt(e.token_label,":").slice(1).trim()}))}stmt_stat(e,r){return this.createlinenode(r,this.createcodenode(r,{type:9,value:Gt(e.token_stat,"@").slice(1)}))}stmt_text(e,r){const n=Gt(e.token_text,"");return this.createlinenode(r,this.createcodenode(r,{type:6,value:n}))}stmt_comment(e,r){return this.createlinenode(r,this.createcodenode(r,{type:7,active:!1,name:Gt(e.token_comment,"'").slice(1).trim()}))}stmt_hyperlink(e,r){return this.createlinenode(r,this.createcodenode(r,{type:8,link:Gt(e.token_hyperlink,"!").slice(1),text:Gt(e.token_hyperlinktext,";").slice(1)}))}stmt_command(e,r){return e.structured_cmd?this.go(e.structured_cmd):this.createlinenode(r,this.createcodenode(r,{type:11,words:this.go(e.words)}))}structured_cmd(e){return e.command_if?this.go(e.command_if):e.command_while?this.go(e.command_while):e.command_repeat?this.go(e.command_repeat):e.command_waitfor?this.go(e.command_waitfor):e.command_foreach?this.go(e.command_foreach):e.command_break?this.go(e.command_break):e.command_continue?this.go(e.command_continue):[]}short_go(e,r){return e.token_divide?this.createlinenode(r,this.createcodenode(r,{type:10,wait:!0,words:[this.go(e.string_token),this.go(e.dir)].flat()})):[]}short_try(e,r){return e.token_query?this.createlinenode(r,this.createcodenode(r,{type:10,wait:!1,words:[this.go(e.string_token),this.go(e.dir)].flat()})):[]}command_if(e,r){const[n]=this.createlogicnode(r,Gt(e.token_if,"if").toLowerCase(),"",this.go(e.words)),[i]=this.go(e.command_if_block)??[];return this.createcodenode(r,{type:13,check:n,block:i})}command_if_block(e,r){const n=Bt(),i=Bt();return this.createcodenode(r,{type:15,skip:n,done:i,lines:[this.go(e.inline),this.go(e.line),this.creategotonode(r,i,"end of if"),this.createmarknode(r,n,"alt logic")].flat(),altlines:[this.go(e.command_else_if),this.go(e.command_else),this.createmarknode(r,i,"end of if")].flat()})}command_block(e){return[this.go(e.inline),this.go(e.line)].flat()}command_fork(e){return[this.go(e.inline),this.go(e.line)].flat()}command_else_if(e,r){const n=Bt(),i=Bt();return this.createcodenode(r,{type:16,done:i,lines:[this.createlogicnode(r,Gt(e.token_if,"if"),n,this.go(e.words)),this.go(e.command_fork),this.creategotonode(r,i,"end of if"),this.createmarknode(r,n,"skip")].flat()})}command_else(e,r){const n=[];return e.words&&n.push(...this.createlinenode(r,this.createcodenode(r,{type:11,words:this.go(e.words)}))),e.command_fork&&n.push(...this.go(e.command_fork)),this.createcodenode(r,{type:17,lines:n})}command_while(e,r){const n=Bt(),i=Bt();return this.createcodenode(r,{type:18,loop:n,done:i,lines:[this.createmarknode(r,n,"start of while"),this.createlogicnode(r,"if",i,this.go(e.words)),this.go(e.command_block),this.creategotonode(r,n,"loop of while"),this.createmarknode(r,i,"end of while")].flat()})}command_repeat(e,r){const n=Bt(),i=Bt(),o=[this.createcountnode(r),this.go(e.words)].flat();return this.createcodenode(r,{type:21,loop:n,done:i,lines:[this.createapinode(r,"repeatstart",o),this.createmarknode(r,n,"start of repeat"),this.createlogicnode(r,"repeat",i,o),this.go(e.command_block),this.creategotonode(r,n,"loop of repeat"),this.createmarknode(r,i,"end of repeat")].flat()})}command_foreach(e,r){const n=Bt(),i=Bt(),o=[this.createcountnode(r),this.go(e.words)].flat();return this.createcodenode(r,{type:23,loop:n,done:i,lines:[this.createapinode(r,"foreachstart",o),this.createmarknode(r,n,"start of foreach"),this.createlogicnode(r,"foreach",i,o),this.go(e.command_block),this.creategotonode(r,n,"loop of foreach"),this.createmarknode(r,i,"end of foreach")].flat()})}command_waitfor(e,r){const n=Bt();return this.createcodenode(r,{type:22,loop:n,lines:[this.createmarknode(r,n,"start of waitfor"),this.createlogicnode(r,"waitfor",n,this.go(e.words))].flat()})}command_break(e,r){return this.createcodenode(r,{type:19,goto:0})}command_continue(e,r){return this.createcodenode(r,{type:20,goto:0})}command_play(e,r){const n=Gt(e.token_command_play,"").trim(),[i,...s]=n.split(" ");return[this.createstringnode(r,i),this.createstringnode(r,s.join(" "))].flat()}command_toast(e,r){const i=Gt(e.token_command_toast,"").replace("toast","").trim();return[this.createstringnode(r,"toast"),this.createtemplatenode(r,i)].flat()}command_ticker(e,r){const i=Gt(e.token_command_ticker,"").replace("ticker","").trim();return[this.createstringnode(r,"ticker"),this.createtemplatenode(r,i)].flat()}expr(e,r){return e.RHS?this.createcodenode(r,{type:24,items:[this.createexprnodeondemand(this.go(e.LHS),r),this.createexprnodeondemand(this.go(e.RHS),r)]}):this.go(e.LHS)}and_test(e,r){return e.RHS?this.createcodenode(r,{type:25,items:[this.createexprnodeondemand(this.go(e.LHS),r),this.createexprnodeondemand(this.go(e.RHS),r)]}):this.go(e.LHS)}not_test(e,r){return e.comparison?this.go(e.comparison):e.LHS?this.createcodenode(r,{type:26,items:this.go(e.LHS)}):[]}comparison(e,r){if(e.RHS){const[n]=this.go(e.comp_op);return this.createcodenode(r,{type:27,compare:n,lhs:this.createexprnodeondemand(this.go(e.LHS),r),rhs:this.createexprnodeondemand(this.go(e.RHS),r)})}return this.go(e.LHS)}comp_op(e,r){return e.token_iseq?this.createcodenode(r,{type:28,method:0}):e.token_isnoteq?this.createcodenode(r,{type:28,method:1}):e.token_islessthan?this.createcodenode(r,{type:28,method:2}):e.token_isgreaterthan?this.createcodenode(r,{type:28,method:3}):e.token_islessthanorequal?this.createcodenode(r,{type:28,method:4}):e.token_isgreaterthanorequal?this.createcodenode(r,{type:28,method:5}):[]}expr_value(e,r){return e.RHS?this.createcodenode(r,{type:24,items:[this.createexprnodeondemand(this.go(e.LHS),r),this.createexprnodeondemand(this.go(e.RHS),r)]}):this.go(e.LHS)}and_test_value(e,r){return e.RHS?this.createcodenode(r,{type:25,items:[this.createexprnodeondemand(this.go(e.LHS),r),this.createexprnodeondemand(this.go(e.RHS),r)]}):this.go(e.LHS)}not_test_value(e,r){return e.arith_expr?this.go(e.arith_expr):e.LHS?this.createcodenode(r,{type:26,items:this.go(e.LHS)}):[]}arith_expr(e,r){if(e.LHS)return this.go(e.LHS);const n=this.go(e.term);return e.RHS?this.createcodenode(r,{type:29,lhs:n[0],items:this.go(e.RHS)}):n}arith_expr_item(e,r){return this.createcodenode(r,{type:30,operator:e.token_plus?1:2,rhs:this.go(e.term)[0]})}term(e,r){return e.term_item?this.createcodenode(r,{type:29,lhs:this.go(e.factor)[0],items:this.go(e.term_item)}):this.go(e.factor)}term_item(e,r){let n=0;return e.token_multiply&&(n=4),e.token_divide&&(n=5),e.token_moddivide&&(n=6),e.token_floordivide&&(n=7),this.createcodenode(r,{type:30,operator:n,rhs:this.go(e.factor)[0]})}factor(e,r){if(e.power)return this.go(e.power);let n=0;return e.token_plus&&(n=8),e.token_minus&&(n=9),this.createcodenode(r,{type:29,lhs:void 0,items:this.createcodenode(r,{type:30,operator:n,rhs:this.go(e.LHS)[0]})})}power(e,r){const n=this.go(e.token);return e.factor?this.createcodenode(r,{type:29,lhs:n[0],items:this.createcodenode(r,{type:30,operator:3,rhs:this.go(e.factor)[0]})}):n}words(e){return this.go(e.expr)}kind(e){return[this.go(e.color),this.go(e.string_token)].flat()}category(e,r){return e.token_isterrain?this.createcodenode(r,{type:12,literal:1,value:"isterrain"}):e.token_isobject?this.createcodenode(r,{type:12,literal:1,value:"isobject"}):[]}collision(e,r){return e.token_iswalkable?this.createcodenode(r,{type:12,literal:1,value:"iswalkable"}):e.token_iswalking?this.createcodenode(r,{type:12,literal:1,value:"iswalking"}):e.token_iswalk?this.createcodenode(r,{type:12,literal:1,value:"iswalk"}):e.token_isswimmable?this.createcodenode(r,{type:12,literal:1,value:"isswimmable"}):e.token_isswimming?this.createcodenode(r,{type:12,literal:1,value:"isswimming"}):e.token_isswim?this.createcodenode(r,{type:12,literal:1,value:"isswim"}):e.token_issolid?this.createcodenode(r,{type:12,literal:1,value:"issolid"}):e.token_isbullet?this.createcodenode(r,{type:12,literal:1,value:"isbullet"}):e.token_isghost?this.createcodenode(r,{type:12,literal:1,value:"isghost"}):[]}color(e,r){let n="ERROR";return e.token_black&&(n="black"),e.token_dkblue&&(n="dkblue"),e.token_dkgreen&&(n="dkgreen"),e.token_dkcyan&&(n="dkcyan"),e.token_dkred&&(n="dkred"),e.token_dkpurple&&(n="dkpurple"),e.token_dkyellow&&(n="dkyellow"),e.token_ltgray&&(n="ltgray"),e.token_dkgray&&(n="dkgray"),e.token_blue&&(n="blue"),e.token_green&&(n="green"),e.token_cyan&&(n="cyan"),e.token_red&&(n="red"),e.token_purple&&(n="purple"),e.token_yellow&&(n="yellow"),e.token_white&&(n="white"),e.token_brown&&(n="brown"),e.token_dkwhite&&(n="dkwhite"),e.token_ltgrey&&(n="ltgrey"),e.token_gray&&(n="gray"),e.token_grey&&(n="grey"),e.token_dkgrey&&(n="dkgrey"),e.token_ltblack&&(n="ltblack"),e.token_onblack&&(n="onblack"),e.token_ondkblue&&(n="ondkblue"),e.token_ondkgreen&&(n="ondkgreen"),e.token_ondkcyan&&(n="ondkcyan"),e.token_ondkred&&(n="ondkred"),e.token_ondkpurple&&(n="ondkpurple"),e.token_ondkyellow&&(n="ondkyellow"),e.token_onltgray&&(n="onltgray"),e.token_ondkgray&&(n="ondkgray"),e.token_onblue&&(n="onblue"),e.token_ongreen&&(n="ongreen"),e.token_oncyan&&(n="oncyan"),e.token_onred&&(n="onred"),e.token_onpurple&&(n="onpurple"),e.token_onyellow&&(n="onyellow"),e.token_onwhite&&(n="onwhite"),e.token_onbrown&&(n="onbrown"),e.token_ondkwhite&&(n="ondkwhite"),e.token_onltgrey&&(n="onltgrey"),e.token_ongray&&(n="ongray"),e.token_ongrey&&(n="ongrey"),e.token_ondkgrey&&(n="ondkgrey"),e.token_onltblack&&(n="onltblack"),e.token_onclear&&(n="onclear"),this.createcodenode(r,{type:12,literal:1,value:n})}dir_mod(e,r){if(e.dir_within)return this.go(e.dir_within);if(e.dir_awayby)return this.go(e.dir_awayby);let n="ERROR";return e.token_cw&&(n="cw"),e.token_ccw&&(n="ccw"),e.token_opp&&(n="opp"),e.token_rndp&&(n="rndp"),e.token_over&&(n="over"),e.token_under&&(n="under"),this.createcodenode(r,{type:12,literal:1,value:n})}dir_by(e,r){return[...this.createcodenode(r,{type:12,literal:1,value:"by"}),...this.go(e.simple_token)]}dir_at(e,r){return[...this.createcodenode(r,{type:12,literal:1,value:"at"}),...this.go(e.simple_token)]}dir_away(e,r){return[...this.createcodenode(r,{type:12,literal:1,value:"away"}),...this.go(e.simple_token)]}dir_toward(e,r){return[...this.createcodenode(r,{type:12,literal:1,value:"toward"}),...this.go(e.simple_token)]}dir_find(e,r){return[...this.createcodenode(r,{type:12,literal:1,value:"find"}),...this.go(e.kind)]}dir_flee(e,r){return[...this.createcodenode(r,{type:12,literal:1,value:"flee"}),...this.go(e.kind)]}dir_to(e,r){return[...this.createcodenode(r,{type:12,literal:1,value:"to"}),...this.go(e.dir)]}dir_within(e,r){return[...this.createcodenode(r,{type:12,literal:1,value:"within"}),...this.go(e.simple_token)]}dir_awayby(e,r){return[...this.createcodenode(r,{type:12,literal:1,value:"awayby"}),...this.go(e.simple_token)]}dir(e,r){const n=this.go(e.dir_mod)??[];return e.token_i&&n.push(...this.createcodenode(r,{type:12,literal:1,value:"i"})),e.token_idle&&n.push(...this.createcodenode(r,{type:12,literal:1,value:"idle"})),e.token_n&&n.push(...this.createcodenode(r,{type:12,literal:1,value:"n"})),e.token_u&&n.push(...this.createcodenode(r,{type:12,literal:1,value:"u"})),e.token_north&&n.push(...this.createcodenode(r,{type:12,literal:1,value:"north"})),e.token_up&&n.push(...this.createcodenode(r,{type:12,literal:1,value:"up"})),e.token_s&&n.push(...this.createcodenode(r,{type:12,literal:1,value:"s"})),e.token_d&&n.push(...this.createcodenode(r,{type:12,literal:1,value:"d"})),e.token_south&&n.push(...this.createcodenode(r,{type:12,literal:1,value:"south"})),e.token_down&&n.push(...this.createcodenode(r,{type:12,literal:1,value:"down"})),e.token_w&&n.push(...this.createcodenode(r,{type:12,literal:1,value:"w"})),e.token_l&&n.push(...this.createcodenode(r,{type:12,literal:1,value:"l"})),e.token_west&&n.push(...this.createcodenode(r,{type:12,literal:1,value:"west"})),e.token_left&&n.push(...this.createcodenode(r,{type:12,literal:1,value:"left"})),e.token_e&&n.push(...this.createcodenode(r,{type:12,literal:1,value:"e"})),e.token_r&&n.push(...this.createcodenode(r,{type:12,literal:1,value:"r"})),e.token_east&&n.push(...this.createcodenode(r,{type:12,literal:1,value:"east"})),e.token_right&&n.push(...this.createcodenode(r,{type:12,literal:1,value:"right"})),e.token_rnd&&n.push(...this.createcodenode(r,{type:12,literal:1,value:"rnd"})),e.token_rndne&&n.push(...this.createcodenode(r,{type:12,literal:1,value:"rndne"})),e.token_rndns&&n.push(...this.createcodenode(r,{type:12,literal:1,value:"rndns"})),e.token_flow&&n.push(...this.createcodenode(r,{type:12,literal:1,value:"flow"})),e.token_seek&&n.push(...this.createcodenode(r,{type:12,literal:1,value:"seek"})),e.dir_by&&n.push(...this.go(e.dir_by)),e.dir_at&&n.push(...this.go(e.dir_at)),e.dir_away&&n.push(...this.go(e.dir_away)),e.dir_toward&&n.push(...this.go(e.dir_toward)),e.dir_find&&n.push(...this.go(e.dir_find)),e.dir_flee&&n.push(...this.go(e.dir_flee)),e.dir_to&&n.push(...this.go(e.dir_to)),n.flat()}expr_any(e){return[this.go(e.dir),this.go(e.kind),this.go(e.color)].flat()}token_expr_any(e,r){return[this.createcodenode(r,{type:12,literal:1,value:"any"}),this.go(e.expr_any)].flat()}token_expr_count(e,r){return[this.createcodenode(r,{type:12,literal:1,value:"countof"}),this.go(e.expr_any)].flat()}token_expr_blocked(e,r){return[this.createcodenode(r,{type:12,literal:1,value:"blocked"}),this.go(e.dir)].flat()}token_expr_abs(e,r){return[...this.createcodenode(r,{type:12,literal:1,value:"abs"}),...this.go(e.simple_token)]}token_expr_intceil(e,r){return[...this.createcodenode(r,{type:12,literal:1,value:"intceil"}),...this.go(e.simple_token)]}token_expr_intfloor(e,r){return[...this.createcodenode(r,{type:12,literal:1,value:"intfloor"}),...this.go(e.simple_token)]}token_expr_intround(e,r){return[...this.createcodenode(r,{type:12,literal:1,value:"intround"}),...this.go(e.simple_token)]}token_expr_clamp(e,r){return[...this.createcodenode(r,{type:12,literal:1,value:"clamp"}),...this.go(e.simple_token)]}token_expr_min(e,r){return[...this.createcodenode(r,{type:12,literal:1,value:"min"}),...this.go(e.simple_token)]}token_expr_max(e,r){return[...this.createcodenode(r,{type:12,literal:1,value:"max"}),...this.go(e.simple_token)]}token_expr_pick(e,r){return[...this.createcodenode(r,{type:12,literal:1,value:"pick"}),...this.go(e.simple_token)]}token_expr_pickwith(e,r){return[...this.createcodenode(r,{type:12,literal:1,value:"pickwith"}),...this.go(e.simple_token)]}token_expr_random(e,r){return[...this.createcodenode(r,{type:12,literal:1,value:"random"}),...this.go(e.simple_token)]}token_expr_randomwith(e,r){return[...this.createcodenode(r,{type:12,literal:1,value:"randomwith"}),...this.go(e.simple_token)]}token_expr_run(e,r){return[...this.createcodenode(r,{type:12,literal:1,value:"run"}),...this.go(e.string_token)]}token_expr_runwith(e,r){return[...this.createcodenode(r,{type:12,literal:1,value:"runwith"}),...this.go(e.simple_token),...this.go(e.string_token)]}token_expr(e,r){return e.token_expr_aligned?this.createcodenode(r,{type:12,literal:1,value:"aligned"}):e.token_contact?this.createcodenode(r,{type:12,literal:1,value:"contact"}):e.token_expr_any?this.go(e.token_expr_any):e.token_expr_count?this.go(e.token_expr_count):e.token_expr_blocked?this.go(e.token_expr_blocked):e.token_expr_abs?this.go(e.token_expr_abs):e.token_expr_intceil?this.go(e.token_expr_intceil):e.token_expr_intfloor?this.go(e.token_expr_intfloor):e.token_expr_intround?this.go(e.token_expr_intround):e.token_expr_clamp?this.go(e.token_expr_clamp):e.token_expr_min?this.go(e.token_expr_min):e.token_expr_max?this.go(e.token_expr_max):e.token_expr_pick?this.go(e.token_expr_pick):e.token_expr_pickwith?this.go(e.token_expr_pickwith):e.token_expr_random?this.go(e.token_expr_random):e.token_expr_randomwith?this.go(e.token_expr_randomwith):e.token_expr_run?this.go(e.token_expr_run):e.token_expr_runwith?this.go(e.token_expr_runwith):[]}string_token(e,r){if(e.token_stringliteraldouble){const n=Gt(e.token_stringliteraldouble,"");return this.createcodenode(r,{type:12,literal:2,value:n})}if(e.token_stringliteral){const n=Gt(e.token_stringliteral,"");return this.createcodenode(r,{type:12,literal:1,value:n})}return[]}simple_token(e,r){if(e.token_stringliteraldouble){const n=Gt(e.token_stringliteraldouble,"");return this.createcodenode(r,{type:12,literal:2,value:n})}if(e.token_stringliteral){const n=Gt(e.token_stringliteral,"");return this.createcodenode(r,{type:12,literal:1,value:n})}if(e.token_numberliteral){const n=parseFloat(Gt(e.token_numberliteral,"0"));return this.createcodenode(r,{type:12,literal:0,value:n})}return e.color?this.go(e.color):[]}token(e,r){if(e.category)return this.go(e.category);if(e.collision)return this.go(e.collision);if(e.color)return this.go(e.color);if(e.dir)return this.go(e.dir);if(e.command_play)return this.go(e.command_play);if(e.command_toast)return this.go(e.command_toast);if(e.command_ticker)return this.go(e.command_ticker);if(e.token_label){const n=Gt(e.token_label,"");return this.createcodenode(r,{type:12,literal:1,value:n})}if(e.token_stringliteraldouble){const n=Gt(e.token_stringliteraldouble,"");return this.createcodenode(r,{type:12,literal:2,value:n})}if(e.token_stringliteral){const n=Gt(e.token_stringliteral,"");return this.createcodenode(r,{type:12,literal:1,value:n})}if(e.token_numberliteral){const n=parseFloat(Gt(e.token_numberliteral,"0"));return this.createcodenode(r,{type:12,literal:0,value:n})}if(e.token_lparen)return[this.createexprnodeondemand(this.go(e.expr),r)];if(e.token_stop){const n=Gt(e.token_stop,"");return this.createcodenode(r,{type:12,literal:1,value:n})}return[]}}const l7=new c7,Vr={labels:{},internal:0,lineindex:0,linelookup:{},isfirststat:!1},Du="zss.js";function ct(t,e){return new i7.SourceNode(t.startLine??1,t.startColumn??1,Du,e)}function J0(t){return t.replace(/\\/g,"\\\\").replace(/'/g,"\\'")}function ju(t){return`'${J0(t)}'`}function Q0(t){const e=Op(t);return e.errors.length?t:`['${e.tokens.map(n=>{if(n.tokenType===Sp){const i=J0(n.image.substring(1));return Fe(i)==="center"?"$CENTER":`', api.get('${i}'), '`}return J0(n.image)}).join("")}'].join('')`}function fc(t){return t.filter(e=>e!==void 0).map(ft)}function JA(t){return ct(t,"")}function u7(t,e){const r=[];return t.forEach(n=>{r.push(n,e)}),r.pop(),r}function ir(t,e,r){return ct(t,[`api.${e}(`,...u7(r,", "),")"])}function h7(t){if(t.type===Ce.COMPARE&&t.compare.type===Ce.COMPARE_ITEM)switch(t.compare.method){case Xs.IS_EQ:return ir(t,"isEq",[ft(t.lhs),ft(t.rhs)]);case Xs.IS_NOT_EQ:return ir(t,"isNotEq",[ft(t.lhs),ft(t.rhs)]);case Xs.IS_LESS_THAN:return ir(t,"isLessThan",[ft(t.lhs),ft(t.rhs)]);case Xs.IS_GREATER_THAN:return ir(t,"isGreaterThan",[ft(t.lhs),ft(t.rhs)]);case Xs.IS_LESS_THAN_OR_EQ:return ir(t,"isLessThanOrEq",[ft(t.lhs),ft(t.rhs)]);case Xs.IS_GREATER_THAN_OR_EQ:return ir(t,"isGreaterThanOrEq",[ft(t.lhs),ft(t.rhs)])}return ct(t,"")}function Zs(t,e,r){return t.prepend(`api.${e}(`),t.add([", ",ft(r),")"])}function QA(t,e,r){return t.prepend(`api.${e}(`),t.add([ft(r),")"])}function f7(t,e){if(t.type===Ce.OPERATOR_ITEM)switch(t.operator){case fi.PLUS:return Zs(e,"opPlus",t.rhs);case fi.MINUS:return Zs(e,"opMinus",t.rhs);case fi.POWER:return Zs(e,"opPower",t.rhs);case fi.MULTIPLY:return Zs(e,"opMultiply",t.rhs);case fi.DIVIDE:return Zs(e,"opDivide",t.rhs);case fi.MOD_DIVIDE:return Zs(e,"opModDivide",t.rhs);case fi.FLOOR_DIVIDE:return Zs(e,"opFloorDivide",t.rhs);case fi.UNI_PLUS:return QA(e,"opUniPlus",t.rhs);case fi.UNI_MINUS:return QA(e,"opUniMinus",t.rhs)}return ct(t,"")}function d7(t){if(t.type===Ce.OPERATOR){const e=t.lhs?ft(t.lhs):ct(t,"");return t.items.forEach(r=>f7(r,e)),e}return ct(t,"")}function zu(t,e){return ct(t,[ir(t,"jump",[`${e}`]),"; continue;"])}function Ui(t){return Vr.linelookup[t??""]??-1}function em(t,e){Vr.linelookup[t]=e}function Vo(t,e,r){for(let n=0;n<t.length;++n){const i=t[n];switch(i.type){case Ce.WHILE:case Ce.REPEAT:case Ce.FOREACH:case Ce.ELSE_IF:i.type===e&&(i.done=r);break;case Ce.IF_BLOCK:case Ce.IF_CHECK:i.type===e&&(i.skip=r);break;case Ce.LINE:Vo(i.stmts,e,r);break}}}function eT(t,e,r){for(let n=0;n<t.length;++n){const i=t[n];switch(i.type){case Ce.WHILE:case Ce.REPEAT:case Ce.FOREACH:case Ce.ELSE_IF:i.type===e&&em(i.done,r);break;case Ce.IF_BLOCK:case Ce.IF_CHECK:i.type===e&&em(i.skip,r);break;case Ce.LINE:eT(i.stmts,e,r);break}}}function ft(t){switch(t.type){case Ce.PROGRAM:return ct(t,[`try { // first-line
`,`while (true) {
`,`if (api.sy()) { return 1; }
`,`switch (api.getcase()) {
`,...t.lines.map(ft).flat(),`default:
`,`  return 0;
`,`}
`,`api.nextcase();
`,`} // end of logic
`,`} catch (e) {
`,`console.error(e);
`,`const source = api.stacktrace(e);
`,`const err = new Error(e.message);
`,`err.name = 'GameError';
`,`err.meta = { line: source.line, column: source.column };
`,`throw err;
`,`}
`,`//# sourceURL=${Du}`]);case Ce.API:return ct(t,["  ",ir(t,t.method,fc(t.words)),`;
`]);case Ce.LINE:return ct(t,[`case ${t.lineindex}:
`,...t.stmts.map(ft).flat(),`  break;
`]);case Ce.MARK:return ct(t,`  // ${t.comment}
`);case Ce.GOTO:{const e=Ui(t.id);return ct(t,["  ",zu(t,e),`
`])}case Ce.COUNT:return ct(t,`${t.index}`);case Ce.LITERAL:switch(t.literal){case Fu.NUMBER:return ct(t,`${t.value}`);case Fu.STRING:return ct(t,ju(t.value));case Fu.TEMPLATE:return ct(t,Q0(t.value))}return JA(t);case Ce.TEXT:return ct(t,["  ",ir(t,"text",[Q0(t.value)]),`;
`]);case Ce.STAT:if(Vr.isfirststat){Vr.isfirststat=!1;const e=t.value.trim().split(" ").map(ju);return ct(t,["  ",ir(t,"stat",e),`;
`])}return ct(t,`  // skipped ${t.value}
`);case Ce.LABEL:{const e=Fe(t.name),r=t.active?"label":"comment";Vr.labels[e]||(Vr.labels[e]=[]);const n=(t.active?1:-1)*t.lineindex;return Vr.labels[e].push(n),ct(t,`  // ${n} '${e}' ${r}
`)}case Ce.HYPERLINK:return ct(t,["  ",ir(t,"hyperlink",[Q0(t.text),...t.link.split(" ").filter(e=>e.length>0).map(ju)]),`;
`]);case Ce.MOVE:{const e=ir(t,"command",[ju("go"),fc(t.words)].flat());return t.wait?ct(t,["  if (",e,`) { continue; };
`]):ct(t,["  ",e,`;
`])}case Ce.COMMAND:return ct(t,["  if (",ir(t,"command",fc(t.words)),`) { continue; };
`]);case Ce.IF:{const e=t.block?.type===Ce.IF_BLOCK?t.block:void 0;if(w(e)){Vo([t.check],Ce.IF_CHECK,e.skip);const r=ct(t,ft(t.check));return e.lines.forEach(n=>r.add(ft(n))),eT(e.altlines,Ce.ELSE_IF,Ui(e.done)),e.altlines.forEach(n=>r.add(ft(n))),r}return ct(t,ft(t.check))}case Ce.IF_CHECK:{const e=Ui(t.skip);return e===-1?ct(t,["  ",ir(t,t.method,fc(t.words)),`;
`]):ct(t,["  if (!",ir(t,t.method,fc(t.words)),") { ",zu(t,e),` }
`])}case Ce.ELSE_IF:case Ce.ELSE:{const e=ct(t,"");return t.lines.forEach(r=>e.add(ft(r))),e}case Ce.WHILE:{const e=Ui(t.loop),r=Ui(t.done),n=ct(t,"");return Vo(t.lines,Ce.IF_CHECK,t.done),t.lines.forEach(i=>{switch(i.type){case Ce.BREAK:i.goto=r;break;case Ce.CONTINUE:i.goto=e;break}n.add(ft(i))}),n}case Ce.REPEAT:{const e=Ui(t.loop),r=Ui(t.done),n=ct(t,"");return Vo(t.lines,Ce.IF_CHECK,t.done),t.lines.forEach(i=>{switch(i.type){case Ce.BREAK:i.goto=r;break;case Ce.CONTINUE:i.goto=e;break}n.add(ft(i))}),n}case Ce.WAITFOR:{const e=ct(t,"");return Vo(t.lines,Ce.IF_CHECK,t.loop),t.lines.forEach(r=>{e.add(ft(r))}),e}case Ce.FOREACH:{const e=Ui(t.loop),r=Ui(t.done),n=ct(t,"");return Vo(t.lines,Ce.IF_CHECK,t.done),t.lines.forEach(i=>{switch(i.type){case Ce.BREAK:i.goto=r;break;case Ce.CONTINUE:i.goto=e;break}n.add(ft(i))}),n}case Ce.BREAK:return ct(t,["  ",zu(t,t.goto),`
`]);case Ce.CONTINUE:return ct(t,["  ",zu(t,t.goto),`
`]);case Ce.OR:return ir(t,"or",t.items.map(ft));case Ce.AND:return ir(t,"and",t.items.map(ft));case Ce.NOT:return ir(t,"not",t.items.map(ft));case Ce.COMPARE:return h7(t);case Ce.OPERATOR:return d7(t);case Ce.EXPR:return ir(t,"expr",t.words.map(ft));default:return console.error("<unsupported node>",t.type,t),JA(t)}}function di(t){if(w(t))switch(t.type===Ce.LINE&&++Vr.lineindex,t.lineindex=Vr.lineindex,t.type){case Ce.PROGRAM:t.lines.forEach(di);break;case Ce.LINE:t.stmts.forEach(di);break;case Ce.MARK:em(t.id,t.lineindex);break;case Ce.IF:di(t.check),di(t.block);break;case Ce.IF_BLOCK:t.lines.forEach(di),t.altlines.forEach(di);break;case Ce.ELSE_IF:t.lines.forEach(di);break;case Ce.ELSE:case Ce.WHILE:case Ce.REPEAT:case Ce.FOREACH:case Ce.WAITFOR:t.lines.forEach(di);break;case Ce.MOVE:case Ce.COMMAND:case Ce.IF_CHECK:t.words.forEach(di);break}}function p7(t){Vr.labels={},Vr.internal=1,Vr.lineindex=0,Vr.isfirststat=!0,di(t)}function m7(t){return p7(t),{...ft(t).toStringWithSourceMap({file:`${Du}.map`}),...Vr}}function tT(t){return ut(t)?t.length>0?1:0:t??0}function g7(t){return`${t}_chip`}function rT(t=""){return`vm:${t??""}`}function y7(t,e,r){const n=g7(t),i=En(n);let s;const o=Sn(Object.entries(r.labels??{}));(!ut(i.lb)||i.lb.length!==o.length)&&(i.lb=o,i.lk="",i.mg=void 0,i.ec=1,i.lc=0,i.ys=0,i.ps=0,i.es=(r.errors?.length??0)!==0?1:0);function a(l,u){E.words=u;const h=lz(e,l);return w(h)?h(c,u):l!=="send"?a("shortsend",[l,...u]):0}const c={halt(){C7(n)},id(){return t},set(l,u){const[h,f]=hz(e,c,l,u);if(h)return f},get(l){const[u,h]=uz(e,c,l);if(u)return h},tick(l){const u=Ae(i.ps)?i.ps:0,h=u%l===0;if(i.ps=u+1,h===!1)return!1;fz(e,c);const f=c.shouldtick();if(f){i.lc=0,i.ys=0,E.get=c.get;try{s?.(c)||(i.es=1)}catch(d){pt(ce,E.elementfocus,"crash",d.message),i.es=1}}return dz(e,c),f},isended(){return i.es===1},isfirstpulse(){return i.ps===1},shouldtick(){return i.es===0||c.hm()!==0},shouldhalt(){return Ae(i.lc)?++i.lc>Rs.HALT_AT_COUNT:!0},haslabel(l){if(ut(i.lb))for(let u=0;u<i.lb.length;++u){const[h,f]=i.lb[u];if(h===l)return(f.find(m=>Ae(m)&&m>0)??0)>0}return!1},hm(){if(ut(i.mg)&&ut(i.lb)){const[l]=i.mg;if(w(l))for(let u=0;u<i.lb.length;++u){const[h,f]=i.lb[u];if(h===l)return f.find(d=>Ae(d)&&d>0)??0}}return 0},yield(){i.ys=1},jump(l){i.ec=l},sy(){return!!i.ys||c.shouldhalt()},send(l,u,h,f){ce.emit(l,`${rT(u)}:${h}`,f)},lock(l){i.lk=l},unlock(){i.lk=""},message(l){i.lk&&l.sender!==i.lk||c.haslabel(l.target)&&(i.mg=[l.target,l.data,l.sender,l.player])},zap(l){if(ut(i.lb))for(let u=0;u<i.lb.length;++u){const h=i.lb[u];if(h[0]===l){const f=h[1].findIndex(d=>d>0);if(f>=0&&w(h[1])){h[1][f]*=-1;break}}}},restore(l){if(ut(i.lb))for(let u=0;u<i.lb.length;++u){const h=i.lb[u];if(h[0]===l)for(let f=0;f<h[1].length;f++)h[1][f]=Math.abs(h[1][f])}},getcase(){i.ec=Ae(i.ec)?i.ec:1;const l=c.hm();if(l&&ut(i.mg)){const[,u,h,f]=i.mg;c.set("sender",h),w(u)&&c.set("arg",u),f&&(c.set("player",f),E.elementfocus=f),i.mg=void 0,i.ys=0,i.es=0,i.ec=l}return i.ec},nextcase(){const l=Ae(i.ec)?i.ec:1;return i.ec=l+1,i.ec},endofprogram(){c.yield(),i.es=1},stacktrace(l){const u=wC.parse(l),[h]=u.filter(f=>f.fileName===Du);return{line:h?.lineNumber??0,column:h?.columnNumber??0}},text(l){return a("text",[l])},stat(...l){return a("stat",l)},hyperlink(...l){return a("hyperlink",l)},command(...l){if(l.length===0)return 0;const[u,...h]=l;return a(Fe(Pt(u)),h)},if(...l){const[u,h]=ue(l,0,[V.ANY]),f=tT(u);return f&&h<l.length&&c.command(...l.slice(h)),f?1:0},try(...l){const[,u]=ue(l,0,[V.DIR]),h=c.command("go",...l);return h&&u<l.length&&c.command(...l.slice(u)),h?1:0},take(...l){const[u,h,f]=ue(l,0,[V.NAME,V.ANY]),d=Ae(h),m=d?f:1,p=c.get(u),g=d?h:1;if(!Ae(p))return m<l.length&&c.command(...l.slice(m)),1;const y=p-g;return y<0?(m<l.length&&c.command(...l.slice(m)),1):(c.set(u,y),0)},give(...l){const[u,h,f]=ue(l,0,[V.NAME,V.ANY]),d=Ae(h),m=d?f:1,p=c.get(u),g=d?h:1,y=p===void 0?1:0;return y&&m<l.length&&c.command(...l.slice(m)),c.set(u,sc(p,0)+g),y},duplicate(...l){return c.command("duplicate",...l)},repeatstart(l,...u){const[h,f]=ue(u,0,[V.NUMBER]),d=`repeatcount${l}`,m=`repeatwords${l}`;i[d]=h,i[m]=f<u.length?u.slice(f):void 0},repeat(l){const u=`repeatcount${l}`,h=`repeatwords${l}`;if(!Ae(i[u]))return 0;const f=i[u];i[u]=f-1;const d=f>0,m=i[h];return d&&ut(m)&&c.command(...m),d?1:0},foreachstart(l,...u){const[h,f,d,m]=ue(u,0,[V.NAME,V.NUMBER,V.NUMBER,V.MAYBE_NUMBER]);let p=Math.min(f,d),g=Math.max(f,d);const y=(m??0)||1;if(y<0){const _=p;p=g,g=_}return c.set(h,p-y),0},foreach(l,...u){const[h,f,d,m,p]=ue(u,0,[V.NAME,V.NUMBER,V.NUMBER,V.MAYBE_NUMBER]);let g=Math.min(f,d),y=Math.max(f,d);const _=(m??0)||1;if(_<0){const x=g;g=y,y=x}let A=c.get(h);!Ae(A)||A<g||A>y?A=g:A+=_;const T=A<=y?1:0;return T&&(c.set(h,A),p<u.length&&c.command(...u.slice(p))),T},waitfor(...l){const[u]=ue(l,0,[V.ANY]),h=tT(u);return h||c.yield(),h?1:0},or(...l){let u=0;for(let h=0;h<l.length;){const[f,d]=ue(l,h,[V.ANY]);if(u=f,u)break;h=d}return u},and(...l){let u=0;for(let h=0;h<l.length;){const[f,d]=ue(l,h,[V.ANY]);if(u=f,!u)break;h=d}return u},not(...l){const[u]=ue(l,0,[V.ANY]);return u?0:1},expr(...l){const[u]=ue(l,0,[V.ANY]);return u},isEq(l,u){const[h]=ue([l],0,[V.ANY]),[f]=ue([u],0,[V.ANY]);return typeof h=="object"||typeof f=="object"?gR(h,f)?1:0:h===f?1:0},isNotEq(l,u){return this.isEq(l,u)?0:1},isLessThan(l,u){const[h]=ue([l],0,[V.NUMBER]),[f]=ue([u],0,[V.NUMBER]);return h<f?1:0},isGreaterThan(l,u){const[h]=ue([l],0,[V.NUMBER]),[f]=ue([u],0,[V.NUMBER]);return h>f?1:0},isLessThanOrEq(l,u){const[h]=ue([l],0,[V.NUMBER]),[f]=ue([u],0,[V.NUMBER]);return h<=f?1:0},isGreaterThanOrEq(l,u){const[h]=ue([l],0,[V.NUMBER]),[f]=ue([u],0,[V.NUMBER]);return h>=f?1:0},opPlus(l,u){const[h]=ue([l],0,[V.ANY]),[f]=ue([u],0,[V.ANY]);return h+f},opMinus(l,u){const[h]=ue([l],0,[V.ANY]),[f]=ue([u],0,[V.ANY]);return h-f},opPower(l,u){const[h]=ue([l],0,[V.NUMBER]),[f]=ue([u],0,[V.NUMBER]);return Math.pow(h,f)},opMultiply(l,u){const[h]=ue([l],0,[V.NUMBER]),[f]=ue([u],0,[V.NUMBER]);return h*f},opDivide(l,u){const[h]=ue([l],0,[V.NUMBER]),[f]=ue([u],0,[V.NUMBER]);return h/f},opModDivide(l,u){const[h]=ue([l],0,[V.NUMBER]),[f]=ue([u],0,[V.NUMBER]);return h%f},opFloorDivide(l,u){const[h]=ue([l],0,[V.NUMBER]),[f]=ue([u],0,[V.NUMBER]);return Math.floor(h/f)},opUniPlus(l){const[u]=ue([l],0,[V.NUMBER]);return+u},opUniMinus(l){const[u]=ue([l],0,[V.NUMBER]);return-u}};return s=r.code,c}function tm(t){if(!t||t.type===void 0)return;const e=[{start:t.startOffset,end:t.endOffset??0}];return Object.keys(t).forEach(r=>{if(r!=="parent"){const n=t[r];ut(n)?n.forEach(i=>{e.push(tm(i))}):e.push(tm(n))}}),t.range={start:Math.min(...e.filter(r=>r).map(r=>r?.start??0)),end:Math.max(...e.filter(r=>r).map(r=>r?.end??0))},t.range}function _7(t){const e=Sx(`${t}
`);if(e.errors.length>0)return e;Yo.input=e.tokens;const r=Yo.program();if(Yo.errors.length>0)return{tokens:e.tokens,errors:Yo.errors.map(i=>({offset:i.token.startOffset,line:i.token.startLine,column:i.token.startColumn,length:i.token.image.length,message:i.message}))};const[n]=l7.go(r);return n?(tm(n),{tokens:e.tokens,cst:r,ast:n}):{tokens:e.tokens,cst:r,errors:[{message:"no ast output",offset:0,line:0,column:0,length:0}]}}function b7(t,e){const r=`compile-${t}`;console.time(r);const n=_7(e);if(console.timeEnd(r),T_&&console.info(e,n.errors),n.errors&&n.errors.length>0)return console.info(e,n.tokens,n.errors),n;if(!n.ast)return{...n,errors:[{message:"no ast output",offset:0,line:0,column:0,length:0}]};const i=m7(n.ast);if(i.code){T_&&console.info(i.code);try{return{...n,...i,source:i.code,code:new Function("api",i.code)}}catch(s){return{errors:[{message:`unexpected error ${s.message}`,offset:0,line:0,column:0,length:0}],source:"",code:new Function("api"," ")}}}return{...n,...i,source:"",code:new Function("api"," ")}}function w7(){const t={},e={};function r(i,s){const o=t[s];if(o)return o;const a=b7(i,s);return t[s]=a,a}const n={ids(){return Object.keys(e)},isended(i){const s=e[i];return w(s)?s.isended():!0},halt(i){const s=e[i];return w(s)&&(s.halt(),delete e[i]),!!s},gc(){const i=n.ids();for(let s=0;s<i.length;++s)n.isended(i[s])&&n.halt(i[s])},arg(i,s){const o=e[i];w(o)&&o.set("arg",s)},tick(i,s,o,a,c){let l=e[i];if(!w(e[i])){const u=r(a,c);if(l=e[i]=y7(i,s,u),u.errors?.length){const[h]=u.errors,f=(h?.line??2)-1,d=c.replaceAll(`\r
`,"").split(`
`).map((A,T)=>[A,T]),m=d.slice(f-2,f);for(let A=0;A<m.length;++A){const[T,x]=m[A];pt(ce,Mr(),"build",`$grey${x+1} $grey${T}`)}const[p,g]=d[f]??[];if(ye(p)&&w(g)){const A=(h.column??1)-1,T=A+h.length,x=A<p.length?p:`${p}*`,M=x.substring(0,A),R=x.substring(A,T),P=x.substring(T);pt(ce,Mr(),"build",`$red${g+1} $grey${M}$red${R}$grey${P}`)}const y=d.slice(f+1,f+3);for(let A=0;A<y.length;++A){const[T,x]=y[A];pt(ce,Mr(),"build",`$grey${x+1} $grey${T}`)}const _=h.message.split(`
`).slice(0,4).join(" ");return pt(ce,Mr(),"build",_),!1}}return!!l?.tick(o)},once(i,s,o,a){const c=n.tick(i,s,1,o,a);return n.halt(i)&&c},message(i){const{target:s,path:o}=Dr(i.target),a=e[s];if(w(a)){const c={...i,target:o};a.message(c)}}};return n}const Tr=new xa,Lr={},Wu={};function k7(t,e,r,n,i,s=0){const o=`tiles:${t}:${e}`;return w(Lr[o])||(Lr[o]=xC(t,e,r,n,i,s)),Lr[o]}function nT(t,e,r,n){const i=`sprites:${t}:${e}:${r}`,s=`sprite:${t}:${e}:${n}`;return w(Wu[s])||(Wu[s]=EC(t,e,r)),Wu[s].id=i,Wu[s]}function v7(t,e){const r=`sprites:${t}:${e}`;return w(Lr[r])||(Lr[r]=AC(t,e)),Lr[r]}function x7(t,e,r,n,i=0){const s=`dither:${t}:${e}`;return w(Lr[s])||(Lr[s]=TC(t,e,r,n,i)),Lr[s]}function Hu(t,e,r,n){const i=`media:${t}:${e}`;w(Lr[i])||(Lr[i]=SC(t,e,r,n));const s=Lr[i];return s.mime=r,s.media=n,s}function E7(t,e){const r=`control:${t}:${e}`;return w(Lr[r])||(Lr[r]=RC(t,e)),Lr[r]}const ns=3;function iT(t,e){const r=[],n=(t.x+.5)*Ts,i=(t.y+.5)*Ss,s=e.x*Ts,o=e.y*Ss,a=s-n,c=o-i;Tr.x=a-ns,Tr.y=c-ns,r.push(Tr.angle()),Tr.x=a+Ts+ns,Tr.y=c-ns,r.push(Tr.angle()),Tr.x=a-ns,Tr.y=c+Ss+ns,r.push(Tr.angle()),Tr.x=a+Ts+ns,Tr.y=c+Ss+ns,r.push(Tr.angle());const l=r.map(d=>Math.round(p_(d))),u=Math.min(...l),h=Math.max(...l);if(h-u>180){const d=l.filter(y=>y<180),m=l.filter(y=>y>180),p=Math.max(...d);return[Math.min(...m),p]}return[u,h]}function Gu(t,e,r,n,i,s,o,a,c){const l={x:a,y:c},u=$i(t,l);if(u===-1)return;Tr.x=a-i.x,Tr.y=Math.round((c-i.y)*1.333);const h=Tr.length();if(h>s)return;const f=Math.round(p_(Tr.angle()));let d=0;for(let A=0;A<r.length;++A){const[T,x,M]=r[A];T>x?(f>=T||f<=x)&&(d=Math.max(d,M)):f>=T&&f<=x&&(d=Math.max(d,M))}const m=s*.5;e[u]=Math.min(e[u],d+(h<m?0:(h-m)*o)),e[u]=jt(e[u],0,1);const p=mr(t,t.lookup?.[u]??"");if(w(p)){const A=[...iT(i,l),.25];n.push(A)}const g=t.terrain[u],y=xn(g),_=g?.collision??y?.collision;if(pc(We.ISBULLET,_)){const A=[...iT(i,l),1];n.push(A)}}function rm(t,e,r,n,i,s){if(!w(r)||!w(r.terrain)||!w(r.objects))return[];const o=[];let a=e;const c=Ue,l=nt,u=s?Je.BLACK:Je.ONCLEAR,h=k7(t,a++,"terrain",c,l,u);o.push(h);const f=a++,d=v7(t,f);d.sprites=[],o.push(d);const m=r.isdark?1:0,p=x7(t,a++,c,l,m);o.push(p),p.alphas.fill(m);const g=E7(t,a++);if(i){o.push(g);const{graphics:M,camera:R,facing:P}=En(t),W=r.graphics??M??"",F=r.camera??R??"",G=r.facing??P??"";if(ye(W)){const O=Fe(W);switch(O){case"fpv":case"iso":case"flat":case"mode7":g.graphics=O;break;default:g.graphics="flat";break}}if(ye(F))switch(Fe(F)){default:case"mid":g.viewscale=gl.MID;break;case"near":g.viewscale=gl.NEAR;break;case"far":g.viewscale=gl.FAR;break}Ae(G)&&(g.facing=d_(G%360))}for(let M=0;M<r.terrain.length;++M){const R=r.terrain[M],P=Vt(R,0,Je.WHITE,s?Je.BLACK:Je.ONCLEAR),W=He(R,"collision");h.char[M]=P.char,h.color[M]=P.color,h.bg[M]=P.bg,h.wall[M]=W===We.ISSOLID?1:0}const y=Object.values(r.objects??{}),_=new Set;for(let M=0;M<y.length;++M){const R=y[M];sr(R.id)&&Ae(R.x)&&Ae(R.y)&&_.add(tn(R,Ue))}for(let M=0;M<y.length;++M){const R=y[M],P=He(R,"collision");if(w(R.removed)||P===We.ISGHOST)continue;const W=R.id??"";if(sr(W)===!1&&Ae(R.x)&&Ae(R.y)&&_.has(tn(R,Ue))===!0)continue;const F=Vt(R),G=nT(t,f,W,M);if(G.x=R.x??0,G.y=R.y??0,G.char=F.char,G.color=F.color,G.bg=F.bg,d.sprites.push(G),m){if(F.light>0){const O=$i(r,G),I=jt(Math.round(F.light),1,nt),k=1/(I*.5);if(p.alphas[O]=0,I>1){const C=[];for(let z=1;z<=I;++z){if(z===2){const Y=He(R,"lightdir");if(nn(Y)){const N=Jo(r,R,"",Y,G);switch(Ln(G,N.destpt)){case ve.EAST:C.push([45,315,1]);break;case ve.WEST:C.push([225,135,1]);break;case ve.NORTH:C.push([315,225,1]);break;case ve.SOUTH:C.push([135,45,1]);break}}}const B=[];for(let Y=G.y-z;Y<=G.y+z;++Y)Gu(r,p.alphas,C,B,G,I,k,G.x-z,Y),Gu(r,p.alphas,C,B,G,I,k,G.x+z,Y);const Q=z-1;for(let Y=G.x-Q;Y<=G.x+Q;++Y)Gu(r,p.alphas,C,B,G,I,k,Y,G.y-z),Gu(r,p.alphas,C,B,G,I,k,Y,G.y+z);for(let Y=0;Y<B.length;++Y){const N=B[Y];let U=0;for(U=0;U<C.length;++U){const $=C[U];if($[1]>$[0]&&N[1]>=$[0]&&N[0]<=$[1]&&N[2]>=1&&$[2]>=1){C[U]=[Math.min(N[0],$[0]),Math.max(N[1],$[1]),1];break}}U===C.length&&C.push(N)}}}}else if(sr(W)){const O=$i(r,G);p.alphas[O]=0}}W===t&&(g.focusx=G.x,g.focusy=G.y,g.focusid=W)}for(let M=0;M<y.length;++M){const R=y[M],P=He(R,"collision");if(w(R.removed)||P!==We.ISGHOST)continue;const W=R.id??"",F=Vt(R),G=nT(t,f,W,M);G.x=R.x??0,G.y=R.y??0,G.char=F.char,G.color=F.color,G.bg=F.bg,d.sprites.push(G)}for(let M=0;M<y.length;++M){const R=y[M];if(ye(R.tickertext)&&Ae(R.tickertime)&&R.tickertext.length){const P=Vt(R),W=R.kind!=="player"?`${P.name}:$WHITE `:"",F=`$${Je[P.color]}$ON${Je[P.bg]}$${P.char}$ONCLEAR$CYAN ${W}${R.tickertext}`;n.push(F)}}o.push(Hu(t,a++,"text/mood",m?"dark":"bright"));const A=dt(Xe.MAIN),T=Ni(A,Xe.MAIN);if(ye(T.palette)){const M=dr(Re.PALETTE,T.palette),R=At(M);w(R?.bits)&&o.push(Hu(t,a++,"image/palette",Array.from(R.bits)))}if(ye(T.charset)){const M=dr(Re.CHARSET,T.charset),R=At(M);w(R?.bits)&&o.push(Hu(t,a++,"image/charset",Array.from(R.bits)))}const x=Object.keys(r.objects).filter(sr);return o.push(Hu(t,a++,"text/players",x.join(","))),o}const cn=w7();var Xe=(t=>(t.MAIN="main",t.TITLE="title",t.PLAYER="player",t.GADGETSTORE="gadgetstore",t.GADGETSYNC="gadgetsync",t))(Xe||{});const Tt={halt:!1,session:Bt(),operator:"",software:{main:"",content:""},books:new Map,loaders:new Map};function A7(){return Tt.session}function Mr(){return Tt.operator}function T7(t){Tt.operator=t}function S7(t){Tt.halt=t}function R7(){return Tt.halt}function ln(){return[...Tt.books.values()]}function O7(){const[t]=Tt.books.values();return t}function Ku(){const t=ln(),e=dt("main"),[r]=t.filter(n=>n.id!==e?.id);return r??e}function jn(t){const e=Fe(t);return Tt.books.get(t)??ln().find(r=>r.name===e)}function sT(t,e){w(jn(e))&&(Tt.software[t]=e)}function dt(t){return jn(Tt.software[t])}function oT(t){const e=yp([]);return ye(t)&&(e.name=t),qu(e),Ft(ce,Tt.operator,`created [book] ${e.name}`),e}function I7(t){let e=jn(t);return w(e)||(e=yp([]),e.name=t),qu(e),Ft(ce,Tt.operator,`created [book] ${e.name}`),e}function fr(t,e){let r=w(e)?I7(e):dt(t);return w(r)||(w(r)||(r=O7()),w(r)||(r=oT(e)),w(r)&&Ft(ce,Tt.operator,`opened [book] ${r.name} for ${t}`)),sT(t,r.id),r}function is(t,e,r){return wp(fr(t),r,e)}function dr(t,e){const r=dt("main"),n=mn(kp(r,t,e));if(w(n))return n;const i=ln();for(let s=0;s<i.length;++s){const o=i[s];if(o.id!==r?.id){const a=mn(kp(o,t,e));if(w(a))return a}}}function xn(t){if(w(t?.kinddata))return t.kinddata;if(!ye(t?.kind)||!t.kind)return;const e=dr(Re.OBJECT,t.kind);if(w(e))return t.kinddata=At(e),t.kinddata;const r=dr(Re.TERRAIN,t.kind);if(w(r))return t.kinddata=At(r),t.kinddata}function He(t,e){const r=t?.kinddata,n=r?.id??"",i=t?.[e];if(w(i))return i;const s=r?.[e];if(w(s))return s;const o=dr(Re.OBJECT,n)??dr(Re.TERRAIN,n),a=UP(o,e);if(w(a))return a;switch(e){case"group":return"";case"cycle":return yg;case"p1":case"p2":case"p3":case"p4":case"p5":case"p6":case"p7":case"p8":case"p9":case"p10":case"item":case"pushable":case"breakable":return 0;case"collision":return We.ISWALK;default:return}}function nm(t,e){const r={x:t?.x??-1,y:t?.y??-1},n={x:e?.x??-1,y:e?.y??-1},i=Ln(r,n),s=He(e,"pushable");return Ae(s)?s!==0:ye(s)?s.trim().split(" ").map(o=>y_(ll(o))).some(o=>o===i):!1}function un(t,e,r,n){if(!w(t)||!w(e))return;const[i,s]=e,o=dr(Re.OBJECT,i);if(w(o)){const c=cm(t,r,i,n);if(w(c))return La(c,s),xn(c),He(c,"collision")!==We.ISGHOST&&(Ux(t,c),vp(t,c)),c}const a=dr(Re.TERRAIN,i);if(w(a)){const c=X7(t,r,i);if(w(c)){La(c,s),xn(c);const l=tn(r,Ue);return vp(t,c,l),c}}}function N7(t,e,r){if(!w(t)||!w(e))return;const[n,i]=e,s=dr(Re.OBJECT,n);if(w(s)){const o=cm(t,r,n);return La(o,i),o}}function pr(t){const e=dr(Re.BOARD,t);return At(e)}function En(t){const e=fr("main");return Ni(e,t)}function aT(t){const e=fr("main");return BP(e,t)}function cT(){const t=fr("main");return Ni(t,"main")}function C7(t){const e=fr("main");return Mx(e,t)}function L7(t,e){Tt.books.clear(),t.forEach(n=>{Tt.books.set(n.id,n),n.name==="main"&&(Tt.software.main=n.id)});const r=jn(e);if(w(r)&&(Tt.software.main=r.id),!Tt.software.main){const n=Tt.books.values().next();n.value&&(Tt.software.main=n.value.id)}}function qu(t){return Tt.books.set(t.id,t),t.id}function M7(t){const e=jn(t);e&&Tt.books.delete(e.id)}function lT(t){if(!ye(t)||!t)return pt(ce,t,"login",`failed for playerid ==>${t}<==`);const e=dt("main");if(!w(e))return pt(ce,t,"login:main","login failed to find book 'main'","login",`failed for playerid ==>${t}<==`);let r=Kt(t);if(w(r?.objects[t]))return!0;if(!w(r)){const l=dr(Re.BOARD,"title");r=At(l)}if(!w(r))return pt(ce,t,"login:title","login failed to find board with 'title' stat");const n=dr(Re.OBJECT,"player");if(!w(n))return pt(ce,t,"login:player","login failed to find object type 'player'");const i=r.startx??0,s=r.starty??0,o=Ae(i)?i:Math.round(Ue*.5),a=Ae(s)?s:Math.round(nt*.5),c=cm(r,{x:o,y:a},"player",t);return w(c?.id)?(c.player=t,nc(e,t,"enterx",o),nc(e,t,"entery",a),xu(e,t,r.id),!0):!1}function U7(t){const e=dt("main");if(!w(e))return;const r=[];for(let i=0;i<e.activelist.length;++i){const s=e.activelist[i];s.startsWith(t)&&r.push(s)}const n=Kt(t);for(let i=0;i<r.length;++i){const s=r[i];xu(e,s,""),wu(n,mr(n,s)),xT(n,s),cn.halt(s),Mx(e,s)}}function Kt(t){const e=dt("main"),r=bu(e,t,"board"),n=dr(Re.BOARD,r);return At(n)}function $7(t){const e=dt("main"),r=GP(e,t),n=Kt(t),i=mr(n,t);return r&&w(i)}function P7(t){const e=dt("main"),r=Do(e);for(let n=0;n<r.length;++n){const i=r[n],s=Object.keys(i.objects);for(let o=0;o<s.length;++o){const c=i.objects[s[o]].id;sr(c)&&(xu(e,c,i.id),w(t[c])||(t[c]=0))}}}function uT(t){cn.message(t)}function qt(t,e,r,n){if(ye(r.id))if(ye(e.id))mg(ce,t,e.id,r.id,n);else{const i=`${tn({x:e.x??0,y:e.y??0},Ue)}`;mg(ce,t,i,r.id,n)}}function B7(t,e,r,n){const i=r.id??"";if(n.x<0){const s=pr(e?.exitwest??"");w(s)&&Fo(t,i,s.id,{x:Ue-1,y:n.y})}else if(n.x>=Ue){const s=pr(e?.exiteast??"");w(s)&&Fo(t,i,s.id,{x:0,y:n.y})}else if(n.y<0){const s=pr(e?.exitnorth??"");w(s)&&Fo(t,i,s.id,{x:n.x,y:nt-1})}else if(n.y>=nt){const s=pr(e?.exitsouth??"");w(s)&&Fo(t,i,s.id,{x:n.x,y:0})}}function hT(t,e,r,n){const i=bu(t,n,"enterx"),s=bu(t,n,"entery");Ae(i)&&Ae(s)&&w(r)&&xp(e,r,{x:i,y:s})}function zn(t,e,r,n){if(!w(r?.id))return!1;let i=xp(e,r,n);const s=He(r,"collision");if(w(i)&&s!==We.ISBULLET){const o=sr(r?.id),a=!!He(i,"item");if(nm(r,i)&&(!o||!a)){const l=Ln({x:r.x??0,y:r.y??0},n),u=Mt({x:i.x??0,y:i.y??0},l);zn(t,e,i,u)}i=xp(e,r,n)}if(w(i)){const o=sr(r.id),a=sr(r.party??r.id),c=He(r,"collision")===We.ISBULLET,l=r.kind??"";let u="";r.party&&a&&(u=r.party),o&&(u=r.id);const h=sr(i.id),f=sr(i.party??i.id),d=He(i,"collision")===We.ISBULLET,m=i.kind??"",p=a===f;let g="";if(i.party&&f&&(g=i.party),h&&(g=i.id??""),o&&m==="edge")B7(t,e,r,n);else if(o)h?(qt(p?"":g,i,r,"thud"),qt(p?"":u,r,i,"bump")):d?(e?.restartonzap&&hT(t,e,r,u),qt(p?"":g,i,r,p?"partyshot":"shot"),qt(u,r,i,"thud")):(qt(p?"":g,i,r,"thud"),qt(p?"":u,r,i,"touch"));else if(c)if(h)e?.restartonzap&&hT(t,e,i,g),qt(p?"":g,i,r,"thud"),qt(p?"":u,r,i,p?"partyshot":"shot");else if(d)qt(p?"":g,i,r,"thud"),qt(p?"":u,r,i,"thud");else switch(qt(p?"":g,i,r,"thud"),m){case"object":case"scroll":qt(p?"":u,r,i,"shot");break;default:qt(p?"":u,r,i,p?"partyshot":"shot");break}else if(h)qt(p?"":g,i,r,"thud"),qt(p?"":u,r,i,"bump");else if(d){switch(l){case"object":case"scroll":qt(p?"":u,r,i,"shot");break;default:qt(p?"":u,r,i,p?"partyshot":"shot");break}qt(p?"":u,r,i,"thud")}else qt(p?"":g,i,r,"thud"),qt(p?"":u,r,i,"bump");if(c&&He(i,"breakable"))if(w(i?.id)){const y=it(e,{x:i.x??-1,y:i.y??-1});w(y)&&gr(E.board,y,E.timestamp)}else St(e,{x:n.x,y:n.y});return!1}return!0}function fT(t,e,r,n){if(!w(t)||!w(e)||!w(r))return;const i={...E};E.book=t,E.board=e,E.element=r,E.elementid=r.id??"",E.elementisplayer=sr(E.elementid);const s=E.element.player??Tt.operator;E.elementfocus=E.elementisplayer?E.elementid:s;const o=He(r,"cycle"),a=r.id??"",c=Fe(r.name??r.kinddata?.name??"");if(cn.tick(a,rs.RUNTIME,o,c,n),Ae(r?.tickertime)&&E.timestamp-r.tickertime>Ic*5&&(r.tickertime=0,r.tickertext=""),E.elementisplayer){const l=En(E.elementid);Ae(l.inputcurrent)&&(l.inputcurrent=0)}Br(i).forEach(l=>{E[l]=i[l]})}function F7(t,e){Tt.loaders.set(t,e)}function dT(t){cn.halt(t)}function D7(){const t=cn.ids();for(let r=0;r<t.length;++r)cn.halt(t[r]);const e=dt("main");w(e)&&(e.flags={})}function j7(t=!1){const e=dt("main");if(!w(e))return;const r=e.timestamp+1,n=Rs.HALT_AT_COUNT;Rs.HALT_AT_COUNT=n*2,Tt.loaders.forEach((s,o)=>{const a={...E};E.timestamp=e.timestamp,E.book=e,E.board=void 0,E.element=void 0,E.elementid=o,E.elementisplayer=!1,E.elementfocus=Mr();const c=Rj(o);w(c)&&cn.arg(o,c),cn.tick(o,rs.LOADER,1,"loader",s),cn.isended(o)&&(cn.halt(o),Tt.loaders.delete(o)),Br(a).forEach(l=>{E[l]=a[l]})}),Rs.HALT_AT_COUNT=n,e.timestamp=r,E.timestamp=r;const i=Do(e);for(let s=0;s<i.length;++s){const o=i[s];for(let l=0;l<o.terrain.length;++l)xn(o.terrain[l]);const a=Object.keys(o.objects);for(let l=0;l<a.length;++l){const u=a[l];xn(o.objects[u])}const c=zP(o,r);for(let l=0;l<c.length;++l){const{id:u,type:h,code:f,object:d}=c[l];h===Re.ERROR?cn.halt(u):(!t||sr(d?.id??""))&&fT(e,o,d,f)}}}function Xo(t,e,r,n){const i=dt("main");if(!w(i))return;function s(o){for(let a=0;a<o.length;++a){const c=o[a];if(w(c.id)){const l=`${rT(c.id)}:${e}`;ce.emit("",l,r)}}}if(As(t)){for(let o=0;o<n.length;++o){const a=n[o],c=it(a,t);w(c)&&s([c])}return}for(let o=0;o<n.length;++o){const a=n[o];switch(Fe(t)){case"all":case"self":case"others":{s(Object.values(a.objects));break}default:{s(yT(a,[t]));break}}}}function z7(t){const e=En(t),r=e.playbuffer=ye(e.playbuffer)?e.playbuffer:"";r&&pT(t,r,!1)}function pT(t,e,r=!0){const n=fr("main");if(!w(n))return;const i=`${t}_cli`;E.timestamp=n.timestamp,E.book=n,E.board=Kt(t),E.element=mr(E.board,t),E.elementid=E.element?.id??"",E.elementisplayer=!0,E.elementfocus=E.elementid||t;const s=Rs.HALT_AT_COUNT;if(Rs.HALT_AT_COUNT=s*8,cn.once(i,rs.CLI,"cli",e),r){const o=En(t);o.playbuffer=e}Rs.HALT_AT_COUNT=s}function Yu(t){const e=fr("main"),r=Fs(e,t);if(!w(e)||!w(r)||!w(E.element))return;const n={...E},i=`${t}_run`,s=Fe(E.element.name??E.element.kinddata?.name??""),o=r?.code??"";cn.once(i,rs.RUNTIME,s,o),Br(n).forEach(a=>{E[a]=n[a]})}function W7(t){const e=dt("main"),r=Kt(t),n=[],i=[],s=[],o=[];if(!w(e)||!w(r))return{board:"",over:n,under:i,layers:s,tickers:o};const a=r.graphics??"flat",c=pr(r.overboard??""),l=pr(r.underboard??"");return i.push(...rm(t,0,l,o,!1,!0)),s.push(...rm(t,i.length,r,o,!0,a!=="flat")),n.push(...rm(t,i.length+s.length,c,o,!1,!1)),{board:r.id,over:n,under:i,layers:s,tickers:o}}function Js(t){return ut(t)&&typeof t[0]=="string"}function H7(t){const e=E.words[t];return ye(e)?[e,t+1]:[void 0,t]}function im(t){const e=E.words[t];if(Js(e))return[e,t+1];const[r,n]=fl(t),[i,s]=H7(n);return ye(i)&&(i==="empty"||xn({kind:i}))?[[i,r],s]:[void 0,t]}function dc(t){if(!Js(t))return;const[e]=t;return e}function Vu(t){if(!Js(t))return;const[,e]=t,r=w(e)?ul(e):void 0;return w(r)?r:void 0}function mT(t){if(!Js(t))return;const[,e]=t,r=w(e)?hl(e):void 0;return w(r)?Gf(r):void 0}function pc(t,e){const r=t??We.ISWALK,n=e??We.ISWALK;if(r===We.ISGHOST||n===We.ISGHOST)return!1;switch(r){case We.ISWALK:return n!==We.ISWALK;case We.ISSWIM:return n!==We.ISSWIM;case We.ISSOLID:return!0;case We.ISBULLET:return n!==We.ISWALK&&n!==We.ISSWIM}}function mc(t,e,r){const n=t?.objects[r];if(w(n))return n;const i=Zo(t,"player");return w(e)?(e.x<0&&(e.x=rn(0,Ue-1)),e.y<0&&(e.y=rn(0,nt-1)),_T(e,i)):mn(...i)}function Zo(t,e){const r=t?.named?.[e];return w(r)?[...r.values()].map(i=>typeof i=="string"?t?.objects[i]:t?.terrain[i]).filter(w):[]}function G7(t){const e=[];for(let r=0;r<nt;++r)for(let n=0;n<Ue;++n){const i={x:n,y:r},s=it(t,i);!s?.name&&!s?.kind&&e.push(i)}return e}function sm(t,e,r,n){if(!w(t))return!1;const i=Vt(t);return!(w(e)&&e!==i.name||w(r)&&r!==i.color||w(n)&&n!==i.bg)}function Xu(t,e){const r=dc(e),n=Vu(e),i=mT(e);return Zo(t,r??"").filter(s=>sm(s,r,n,i))}function gT(t,e){const r=w(e)?ul(e):void 0,n=w(e)?hl(e):void 0,i=[];if(w(t)){for(let o=0;o<t.terrain.length;++o){const a=t.terrain[o];w(a)&&sm(a,void 0,r,n)&&i.push(a)}const s=Object.values(t.objects);for(let o=0;o<s.length;++o){const a=s[o];sm(a,void 0,r,n)&&i.push(a)}}return i}function yT(t,e){return w(t)?e.map(r=>{if(typeof r=="string"){const n=t.objects[r];if(w(n))return n;const i=Zo(t,Fe(r));if(i.length)return i}else if(As(r)&&r.x>=0&&r.x<Ue&&r.y>=0&&r.y<nt){const n=r.x+r.y*Ue,i=t.lookup?.[n];return w(i)?t.objects[i]:t.terrain[n]}}).flat().filter(w):[]}function _T(t,e){let r=0,n;for(let i=0;i<e.length;++i){const s=e[i];if(s){const o=t.x-(s.x??0),a=t.y-(s.y??0),c=Math.sqrt(o*o+a*a);(n===void 0||c<r)&&(r=c,n=s)}}return n}function K7(t,e,r,n){if(!w(t))return;w(t.distmaps)||(t.distmaps={});const i=`${e}.${r.x}.${r.y}.${n.x}.${n.y}`;let s=t.distmaps[i];if(!w(s)){s=new Array(Kf).fill(-2);const o=[{...n}];let a=0;for(;o.length;){const c=o.shift();if(w(c)&&ss(c)){const l=tn(c,Ue);if(s[l]===-2){const u=Pi(t,c.x,c.y);pc(e,He(u,"collision"))||(s[l]=a,o.push({x:c.x,y:c.y-1},{x:c.x,y:c.y+1},{x:c.x-1,y:c.y},{x:c.x+1,y:c.y})),++a}}}t.distmaps[i]=s}return s}function bT(t,e){return ss(t)?e[tn(t,Ue)]:-1}function wT(t,e,r,n,i){if(!w(t))return;const s=K7(t,e,r,n);if(!w(s))return;const o=[{x:r.x,y:r.y-1},{x:r.x,y:r.y+1},{x:r.x-1,y:r.y},{x:r.x+1,y:r.y}];let a;if(i){let c=i?0:1e4;for(let l=0;l<o.length;++l){const u=bT(o[l],s);u>=0&&u>c&&(c=u,a=o[l])}}else{let c=1e5;for(let l=0;l<o.length;++l){const u=bT(o[l],s);u>=0&&u<c&&(c=u,a=o[l])}}return a}function q7(){return new Array(Ue*nt).map(()=>{})}function Zu(t=Dh){const e={terrain:q7(),objects:{},id:""};return t(e)}var om=(t=>(t[t.terrain=0]="terrain",t[t.objects=1]="objects",t[t.isdark=2]="isdark",t[t.over=3]="over",t[t.under=4]="under",t[t.exitnorth=5]="exitnorth",t[t.exitsouth=6]="exitsouth",t[t.exitwest=7]="exitwest",t[t.exiteast=8]="exiteast",t[t.timelimit=9]="timelimit",t[t.restartonzap=10]="restartonzap",t[t.maxplayershots=11]="maxplayershots",t[t.camera=12]="camera",t[t.graphics=13]="graphics",t))(om||{});function Y7(t){return Oo(t,om,{terrain:e=>e.map(xl),objects:e=>Object.values(e).filter(r=>!r.removed).map(xl),id:It,named:It,lookup:It,codepage:It,distmaps:It,overboard:It,underboard:It})}function V7(t){return Ca(t,om,{terrain:e=>e.map(El),objects:e=>{const r={};for(let n=0;n<e.length;++n){const i=El(e[n]);w(i?.id)&&(r[i.id]=i)}return r}})}function ss(t){return Pf(t.x,t.y,0,Ue-1,nt-1,0)}function $i(t,e){return!w(t)||!w(e?.x)||!w(e?.y)||e.x<0||e.x>=Ue||e.y<0||e.y>=nt?-1:e.x+e.y*Ue}function it(t,e){const r=$i(t,e);if(r<0||!w(t?.lookup))return;const n=mr(t,t.lookup[r]??"");return w(n)?n:t.terrain[r]}function kT(t,e){const r=mr(t,e);if(w(r))return r;const n=parseFloat(e),i=eC(isNaN(n)?-1:n,Ue);return Pi(t,i.x,i.y)}function Pi(t,e,r){return(e>=0&&e<Ue)??(r>=0&&r<nt)?t?.terrain[e+r*Ue]:void 0}function St(t,e){if(!w(t)||!w(e)||!w(e.x)||!w(e.y)||e.x<0||e.x>=Ue||e.y<0||e.y>=nt)return;const r=Sn(e),n=e.x+e.y*Ue;return t.terrain[n]=r,delete t.distmaps,t.terrain[n]}function am(t,e){if(!w(t)||!w(e))return;const r=Sn(e);return r.id=r.id??Bt(),t.objects[r.id]=r,t.objects[r.id]}function X7(t,e,r){return St(t,{...e,kind:r})}function cm(t,e,r,n){return am(t,{...e,kind:r,id:n})}function mr(t,e){if(t)return t.objects[e]}function Z7(t){return w(t)?[...Object.values(t.objects)]:[]}function vT(t,e){const r=$i(t,e);if(r<0||!w(t?.lookup))return;const n=mr(t,t.lookup[r]??"");if(w(n))return n}function gr(t,e,r){return!w(e)||Vt(e).name==="player"?!1:(e.id?(e.removed=r,wu(t,e)):(St(t,{x:e?.x??0,y:e?.y??0}),FP(t,e)),!0)}function xT(t,e){return w(t?.objects[e])?(delete t.objects[e],!0):!1}function J7(t,e,r){if(!w(t)||!w(e))return;const n=t.objects[r];if(w(n))return n;if(As(e))return _T(e,Zo(t,"player"))}function Jo(t,e,r,n,i){const s=ve.MID;if(!w(t)||!w(e))return{dir:n,startpt:i,destpt:i,layer:s,targets:[]};const o={x:e.x??0,y:e.y??0},a={x:o.x+(e.stepx??0),y:o.y+(e.stepy??0)},c=Ln(o,a),l=Ue-1,u=nt-1;for(let h=0;h<n.length;++h){const f=y_(n[h]);switch(f){case ve.IDLE:break;case ve.NORTH:case ve.SOUTH:case ve.WEST:case ve.EAST:Mt(o,f);break;case ve.BY:{const[d,m]=n.slice(h+1);Ae(d)&&Ae(m)&&(o.x=jt(o.x+d,0,l),o.y=jt(o.y+m,0,u)),h+=2;break}case ve.TO:{const[d,m]=n.slice(h+1);Ae(d)&&Ae(m)&&(o.x=jt(d,0,l),o.y=jt(m,0,u)),h+=2;break}case ve.AT:{const[d,m]=n.slice(h+1);Ae(d)&&Ae(m)&&(o.x=jt(d,0,l),o.y=jt(m,0,u)),h+=2;break}case ve.FLOW:Mt(o,c);break;case ve.SEEK:{const d=J7(t,e,r);As(d)&&Mt(o,Ln(i,d));break}case ve.RNDNS:Mt(o,mn(ve.NORTH,ve.SOUTH));break;case ve.RNDNE:Mt(o,mn(ve.NORTH,ve.EAST));break;case ve.RND:Mt(o,mn(ve.NORTH,ve.SOUTH,ve.WEST,ve.EAST));break;case ve.CW:case ve.CCW:case ve.OPP:case ve.RNDP:{const d=Jo(t,e,r,n.slice(h+1),i);switch(o.x=i.x,o.y=i.y,f){case ve.CW:switch(Ln(i,d.destpt)){case ve.NORTH:Mt(o,ve.EAST);break;case ve.SOUTH:Mt(o,ve.WEST);break;case ve.EAST:Mt(o,ve.SOUTH);break;case ve.WEST:Mt(o,ve.NORTH);break}break;case ve.CCW:switch(Ln(i,d.destpt)){case ve.NORTH:Mt(o,ve.WEST);break;case ve.SOUTH:Mt(o,ve.EAST);break;case ve.EAST:Mt(o,ve.NORTH);break;case ve.WEST:Mt(o,ve.SOUTH);break}break;case ve.OPP:switch(Ln(i,d.destpt)){case ve.NORTH:Mt(o,ve.SOUTH);break;case ve.SOUTH:Mt(o,ve.NORTH);break;case ve.EAST:Mt(o,ve.WEST);break;case ve.WEST:Mt(o,ve.EAST);break}break;case ve.RNDP:switch(Ln(i,d.destpt)){case ve.NORTH:case ve.SOUTH:o.x+=mn(-1,1);break;case ve.WEST:case ve.EAST:o.y+=mn(-1,1);break}break}return{dir:n,startpt:i,destpt:o,layer:s,targets:[]}}case ve.FLEE:break;case ve.AWAY:{const[d,m]=n.slice(h+1);if(Ae(d)&&Ae(m)){const p={x:jt(d,0,l),y:jt(m,0,u)},g=p.x-o.x,y=p.y-o.y;if(Math.abs(g)>1||Math.abs(y)>1){const _=He(e,"collision"),A=wT(t,_,o,p,!0);w(A)&&A.x!==d&&A.y!==m&&!vT(t,A)&&(o.x=A.x,o.y=A.y)}else{const _=Wf(-g,-y);Mt(o,_)}}h+=2;break}case ve.FIND:break;case ve.TOWARD:{const[d,m]=n.slice(h+1);if(Ae(d)&&Ae(m)){const p={x:jt(d,0,l),y:jt(m,0,u)},g=p.x-o.x,y=p.y-o.y;if(Math.abs(g)>1||Math.abs(y)>1){const _=He(e,"collision"),A=wT(t,_,o,p,!1);w(A)&&A.x!==d&&A.y!==m&&!vT(t,A)&&(o.x=A.x,o.y=A.y)}else{const _=Wf(g,y);Mt(o,_)}}h+=2;break}case ve.OVER:case ve.UNDER:{const d=Jo(t,e,r,n.slice(h+1),i);return d.layer=f,d}case ve.WITHIN:{const[d]=n.slice(h+1),m=Jo(t,e,r,n.slice(h+2),i);if(m.targets.length===0&&Ae(d)&&d>0)for(let p=-d;p<=d;++p)for(let g=-d;g<=d;++g){const y={x:m.destpt.x+g,y:m.destpt.y+p};ss(y)&&m.targets.push(y)}return Ae(d)&&d>0?{...m,targets:m.targets.filter(p=>As(p)?i_(p,m.destpt)<=d:!1)}:m}case ve.AWAYBY:{const[d]=n.slice(h+1),m=Jo(t,e,r,n.slice(h+2),i);if(m.targets.length===0)for(let p=-Ue;p<=Ue;++p)for(let g=-Ue;g<=Ue;++g){const y={x:m.destpt.x+g,y:m.destpt.y+p};ss(y)&&m.targets.push(y)}return Ae(d)&&d>0?{...m,targets:m.targets.filter(p=>As(p)?i_(p,m.destpt)>=d:!1)}:m}}}return{dir:n,startpt:i,destpt:o,layer:s,targets:[]}}const E={timestamp:0,book:void 0,board:void 0,element:void 0,elementid:"",elementisplayer:!1,elementfocus:"",words:[],get:void 0};var V=(t=>(t[t.COLOR=0]="COLOR",t[t.KIND=1]="KIND",t[t.DIR=2]="DIR",t[t.NAME=3]="NAME",t[t.NUMBER=4]="NUMBER",t[t.STRING=5]="STRING",t[t.NUMBER_OR_STRING=6]="NUMBER_OR_STRING",t[t.COLOR_OR_KIND=7]="COLOR_OR_KIND",t[t.MAYBE_KIND=8]="MAYBE_KIND",t[t.MAYBE_NAME=9]="MAYBE_NAME",t[t.MAYBE_NUMBER=10]="MAYBE_NUMBER",t[t.MAYBE_STRING=11]="MAYBE_STRING",t[t.MAYBE_NUMBER_OR_STRING=12]="MAYBE_NUMBER_OR_STRING",t[t.ANY=13]="ANY",t))(V||{});function yr(t,e,r){throw console.info(r,E.element,E.elementid,E.elementfocus),new Error(`Invalid arg, expected: ${t} but got ${JSON.stringify(e)}`)}function ET(t){const e={x:E.element?.x??0,y:E.element?.y??0};return Jo(E.board,E.element,E.elementfocus,t,e)}function ue(t,e,r){const n=E.words;E.words=t;const i=[];let s=e;for(let o=0;o<r.length;++o)switch(r[o]){case 1:{const[a,c]=im(s);Js(a)?(s=c,i.push(a)):yr("kind",a,t);break}case 0:{if(Ta(t[s])===void 0){const[a,c]=Cr(s);Sr(a)?(s=c,i.push(a)):Ae(a)?(s=c,i.push(To(a,void 0))):yr("color",a,t)}else{const[a,c]=fl(s);Sr(a)?(s=c,i.push(a)):yr("color",a,t)}break}case 2:{if(ll(t[s])===void 0){const[a,c]=Cr(s);nn(a)?(s=c,i.push(ET(a))):yr("direction",a,t)}else{const[a,c]=b_(s);nn(a)?(s=c,i.push(ET(a))):yr("direction",a,t)}break}case 3:{const a=E.words[s];ye(a)||yr("string",a,t),++s,i.push(a);break}case 4:{const[a,c]=Cr(s);if(ye(a)){const l=parseFloat(a);Ae(l)?i.push(l):yr("number",a,t)}else Ae(a)?i.push(a):yr("number",a,t);s=c;break}case 5:{const[a,c]=Cr(s);ye(a)||yr("string",a,t),s=c,i.push(a);break}case 6:{const[a,c]=Cr(s);let l=a;if(ye(l)){const u=parseFloat(l);Ae(u)&&(l=u)}else Ae(l)||yr("number or string",l,t);s=c,i.push(l);break}case 7:{const[a,c]=im(s);if(Js(a))s=c,i.push(a);else if(Ta(t[s])===void 0){const[l,u]=Cr(s);Sr(l)?(s=u,i.push(l)):yr("color",l,t)}else{const[l,u]=fl(s);Sr(l)?(s=u,i.push(l)):yr("color or kind",l,t)}break}case 8:{const[a,c]=im(s);a!==void 0&&!Js(a)&&yr("optional kind",a,t),s=c,i.push(a);break}case 9:{const a=E.words[s];a!==void 0&&!ye(a)&&yr("optional string",a,t),++s,i.push(a);break}case 10:{const[a,c]=Cr(s);if(ye(a)){const l=parseFloat(a);Ae(l)?i.push(l):yr("optional number",a,t)}else Ae(a)||a===void 0?i.push(a):yr("optional number",a,t);s=c;break}case 11:{const[a,c]=Cr(s);a!==void 0&&!ye(a)&&yr("optional string",a,t),s=c,i.push(a);break}case 12:{const[a,c]=Cr(s);let l=a;if(ye(l)){const u=parseFloat(l);Ae(u)&&(l=u)}else l!==void 0&&!Ae(l)&&yr("number or string",l,t);s=c,i.push(l);break}case 13:{const[a,c]=Cr(s);s=c,i.push(a);break}}return E.words=n,[...i,s]}const Ju={},Qo={};function lm(){return{id:Bt(),board:"",layers:[],scroll:[],sidebar:[]}}const Q7=new Set(["rn","range","sl","select","nm","number","tx","text","zssedit","charedit","coloredit","bgedit"]),eW=new Set(["tx","text"]),tW={rn:1,range:1,sl:0,select:0,nm:0,number:0,tx:"",text:"",zssedit:"",charedit:"",coloredit:""},AT={};let TT=t=>{let e=AT[t];return w(e)||(AT[t]=e=lm()),e};function rW(t){TT=t}function Rt(t){return TT(t)}function um(t){return w(Ju[t])||(Ju[t]=[]),Ju[t]}function nW(t){const e=Rt(t);e.scrollname="",e.scroll=[]}function iW(t,e,r){Object.values(Qo).forEach(n=>{if(n[e]!==void 0){const i=A_(t.id(),e);Ae(r)&&ZN(i,r),ye(r)&&JN(i,r)}})}function Zt(t){const e=um(t);return Ju[t]=[],e}function ST(t){const e=[];let r;for(let n=0;n<t.length;++n){const i=t[n],s=ye(i)&&w(eB(i));w(r)&&r!==s&&e.push(" "),e.push(i),r=s}return e}function Ie(t,e){um(t).push(e)}function Be(t,e,r,n,i=()=>0,s=Dh){const o=[e,r,...n],a=Fe(`${o[3]}`),c={...E};function l(u,h){w(h)&&h!==i(u)&&(E.board=c.board,E.element=c.element,E.elementfocus=c.elementfocus,s(u,h))}if(Q7.has(a)){const u=`${o[2]}`;Qo[e]=Qo[e]??{};const h=i(u)??tW[a];if(Qo[e][u]===void 0){const f=A_(e,u);Ae(h)&&XN(f,h),ye(h)&&$f(f,h),eW.has(a)?Qo[e][u]=e_(f,d=>{l(u,d)}):Qo[e][u]=QN(f,d=>{l(u,d)})}}um(t).push(o)}rW(t=>{if(sr(t)){const e=dt(Xe.MAIN),r=Ni(e,Xe.GADGETSTORE);let n=r[t];return w(n)||(r[t]=n=lm()),n}return lm()});const hm=io("gadgetserver",["tock"],t=>{if(!hm.session(t))return;const e=dt(Xe.MAIN),r=[...e?.activelist??[],Mr()],n=[...new Set(r.values())],i=Ni(e,Xe.GADGETSYNC);switch(t.target){case"tock":{for(let s=0;s<n.length;++s){const o=n[s],{board:a,over:c,under:l,layers:u,tickers:h}=W7(o),f=Rt(o);f.board=a,f.over=c,f.under=l,f.layers=u,f.tickers=h;const d=i[o]??{},m=cg(d,f);m.length&&(i[o]=Sn(f),IR(hm,o,m))}break}case"desync":OR(hm,t.player,Rt(t.player));break;case"clearscroll":nW(t.player);break;case"clearplayer":{const s=Ni(e,Xe.GADGETSTORE);delete s[t.player];const o=Ni(e,Xe.GADGETSYNC);delete o[t.player];break}}});async function sW(t){const e=rn(1111111,9999999),r=Fe(t.replace(/[^a-zA-Z/]/g,""));return await(await fetch(`https://raw.githubusercontent.com/wiki/goldbuick/zed-software-system/${r}.md?q=${e}`)).text()}function Qu(t){throw new Error('Could not dynamically require "'+t+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var fm={exports:{}},RT;function oW(){return RT||(RT=1,(function(t,e){(function(r){t.exports=r()})(function(){return(function r(n,i,s){function o(l,u){if(!i[l]){if(!n[l]){var h=typeof Qu=="function"&&Qu;if(!u&&h)return h(l,!0);if(a)return a(l,!0);var f=new Error("Cannot find module '"+l+"'");throw f.code="MODULE_NOT_FOUND",f}var d=i[l]={exports:{}};n[l][0].call(d.exports,function(m){var p=n[l][1][m];return o(p||m)},d,d.exports,r,n,i,s)}return i[l].exports}for(var a=typeof Qu=="function"&&Qu,c=0;c<s.length;c++)o(s[c]);return o})({1:[function(r,n,i){var s=r("./utils"),o=r("./support"),a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";i.encode=function(c){for(var l,u,h,f,d,m,p,g=[],y=0,_=c.length,A=_,T=s.getTypeOf(c)!=="string";y<c.length;)A=_-y,h=T?(l=c[y++],u=y<_?c[y++]:0,y<_?c[y++]:0):(l=c.charCodeAt(y++),u=y<_?c.charCodeAt(y++):0,y<_?c.charCodeAt(y++):0),f=l>>2,d=(3&l)<<4|u>>4,m=1<A?(15&u)<<2|h>>6:64,p=2<A?63&h:64,g.push(a.charAt(f)+a.charAt(d)+a.charAt(m)+a.charAt(p));return g.join("")},i.decode=function(c){var l,u,h,f,d,m,p=0,g=0,y="data:";if(c.substr(0,y.length)===y)throw new Error("Invalid base64 input, it looks like a data url.");var _,A=3*(c=c.replace(/[^A-Za-z0-9+/=]/g,"")).length/4;if(c.charAt(c.length-1)===a.charAt(64)&&A--,c.charAt(c.length-2)===a.charAt(64)&&A--,A%1!=0)throw new Error("Invalid base64 input, bad content length.");for(_=o.uint8array?new Uint8Array(0|A):new Array(0|A);p<c.length;)l=a.indexOf(c.charAt(p++))<<2|(f=a.indexOf(c.charAt(p++)))>>4,u=(15&f)<<4|(d=a.indexOf(c.charAt(p++)))>>2,h=(3&d)<<6|(m=a.indexOf(c.charAt(p++))),_[g++]=l,d!==64&&(_[g++]=u),m!==64&&(_[g++]=h);return _}},{"./support":30,"./utils":32}],2:[function(r,n,i){var s=r("./external"),o=r("./stream/DataWorker"),a=r("./stream/Crc32Probe"),c=r("./stream/DataLengthProbe");function l(u,h,f,d,m){this.compressedSize=u,this.uncompressedSize=h,this.crc32=f,this.compression=d,this.compressedContent=m}l.prototype={getContentWorker:function(){var u=new o(s.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new c("data_length")),h=this;return u.on("end",function(){if(this.streamInfo.data_length!==h.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")}),u},getCompressedWorker:function(){return new o(s.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},l.createWorkerFrom=function(u,h,f){return u.pipe(new a).pipe(new c("uncompressedSize")).pipe(h.compressWorker(f)).pipe(new c("compressedSize")).withStreamInfo("compression",h)},n.exports=l},{"./external":6,"./stream/Crc32Probe":25,"./stream/DataLengthProbe":26,"./stream/DataWorker":27}],3:[function(r,n,i){var s=r("./stream/GenericWorker");i.STORE={magic:"\0\0",compressWorker:function(){return new s("STORE compression")},uncompressWorker:function(){return new s("STORE decompression")}},i.DEFLATE=r("./flate")},{"./flate":7,"./stream/GenericWorker":28}],4:[function(r,n,i){var s=r("./utils"),o=(function(){for(var a,c=[],l=0;l<256;l++){a=l;for(var u=0;u<8;u++)a=1&a?3988292384^a>>>1:a>>>1;c[l]=a}return c})();n.exports=function(a,c){return a!==void 0&&a.length?s.getTypeOf(a)!=="string"?(function(l,u,h,f){var d=o,m=f+h;l^=-1;for(var p=f;p<m;p++)l=l>>>8^d[255&(l^u[p])];return-1^l})(0|c,a,a.length,0):(function(l,u,h,f){var d=o,m=f+h;l^=-1;for(var p=f;p<m;p++)l=l>>>8^d[255&(l^u.charCodeAt(p))];return-1^l})(0|c,a,a.length,0):0}},{"./utils":32}],5:[function(r,n,i){i.base64=!1,i.binary=!1,i.dir=!1,i.createFolders=!0,i.date=null,i.compression=null,i.compressionOptions=null,i.comment=null,i.unixPermissions=null,i.dosPermissions=null},{}],6:[function(r,n,i){var s=null;s=typeof Promise<"u"?Promise:r("lie"),n.exports={Promise:s}},{lie:37}],7:[function(r,n,i){var s=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Uint32Array<"u",o=r("pako"),a=r("./utils"),c=r("./stream/GenericWorker"),l=s?"uint8array":"array";function u(h,f){c.call(this,"FlateWorker/"+h),this._pako=null,this._pakoAction=h,this._pakoOptions=f,this.meta={}}i.magic="\b\0",a.inherits(u,c),u.prototype.processChunk=function(h){this.meta=h.meta,this._pako===null&&this._createPako(),this._pako.push(a.transformTo(l,h.data),!1)},u.prototype.flush=function(){c.prototype.flush.call(this),this._pako===null&&this._createPako(),this._pako.push([],!0)},u.prototype.cleanUp=function(){c.prototype.cleanUp.call(this),this._pako=null},u.prototype._createPako=function(){this._pako=new o[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var h=this;this._pako.onData=function(f){h.push({data:f,meta:h.meta})}},i.compressWorker=function(h){return new u("Deflate",h)},i.uncompressWorker=function(){return new u("Inflate",{})}},{"./stream/GenericWorker":28,"./utils":32,pako:38}],8:[function(r,n,i){function s(d,m){var p,g="";for(p=0;p<m;p++)g+=String.fromCharCode(255&d),d>>>=8;return g}function o(d,m,p,g,y,_){var A,T,x=d.file,M=d.compression,R=_!==l.utf8encode,P=a.transformTo("string",_(x.name)),W=a.transformTo("string",l.utf8encode(x.name)),F=x.comment,G=a.transformTo("string",_(F)),O=a.transformTo("string",l.utf8encode(F)),I=W.length!==x.name.length,k=O.length!==F.length,C="",z="",B="",Q=x.dir,Y=x.date,N={crc32:0,compressedSize:0,uncompressedSize:0};m&&!p||(N.crc32=d.crc32,N.compressedSize=d.compressedSize,N.uncompressedSize=d.uncompressedSize);var U=0;m&&(U|=8),R||!I&&!k||(U|=2048);var $=0,X=0;Q&&($|=16),y==="UNIX"?(X=798,$|=(function(J,de){var Ee=J;return J||(Ee=de?16893:33204),(65535&Ee)<<16})(x.unixPermissions,Q)):(X=20,$|=(function(J){return 63&(J||0)})(x.dosPermissions)),A=Y.getUTCHours(),A<<=6,A|=Y.getUTCMinutes(),A<<=5,A|=Y.getUTCSeconds()/2,T=Y.getUTCFullYear()-1980,T<<=4,T|=Y.getUTCMonth()+1,T<<=5,T|=Y.getUTCDate(),I&&(z=s(1,1)+s(u(P),4)+W,C+="up"+s(z.length,2)+z),k&&(B=s(1,1)+s(u(G),4)+O,C+="uc"+s(B.length,2)+B);var q="";return q+=`
\0`,q+=s(U,2),q+=M.magic,q+=s(A,2),q+=s(T,2),q+=s(N.crc32,4),q+=s(N.compressedSize,4),q+=s(N.uncompressedSize,4),q+=s(P.length,2),q+=s(C.length,2),{fileRecord:h.LOCAL_FILE_HEADER+q+P+C,dirRecord:h.CENTRAL_FILE_HEADER+s(X,2)+q+s(G.length,2)+"\0\0\0\0"+s($,4)+s(g,4)+P+C+G}}var a=r("../utils"),c=r("../stream/GenericWorker"),l=r("../utf8"),u=r("../crc32"),h=r("../signature");function f(d,m,p,g){c.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=m,this.zipPlatform=p,this.encodeFileName=g,this.streamFiles=d,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}a.inherits(f,c),f.prototype.push=function(d){var m=d.meta.percent||0,p=this.entriesCount,g=this._sources.length;this.accumulate?this.contentBuffer.push(d):(this.bytesWritten+=d.data.length,c.prototype.push.call(this,{data:d.data,meta:{currentFile:this.currentFile,percent:p?(m+100*(p-g-1))/p:100}}))},f.prototype.openedSource=function(d){this.currentSourceOffset=this.bytesWritten,this.currentFile=d.file.name;var m=this.streamFiles&&!d.file.dir;if(m){var p=o(d,m,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:p.fileRecord,meta:{percent:0}})}else this.accumulate=!0},f.prototype.closedSource=function(d){this.accumulate=!1;var m=this.streamFiles&&!d.file.dir,p=o(d,m,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(p.dirRecord),m)this.push({data:(function(g){return h.DATA_DESCRIPTOR+s(g.crc32,4)+s(g.compressedSize,4)+s(g.uncompressedSize,4)})(d),meta:{percent:100}});else for(this.push({data:p.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},f.prototype.flush=function(){for(var d=this.bytesWritten,m=0;m<this.dirRecords.length;m++)this.push({data:this.dirRecords[m],meta:{percent:100}});var p=this.bytesWritten-d,g=(function(y,_,A,T,x){var M=a.transformTo("string",x(T));return h.CENTRAL_DIRECTORY_END+"\0\0\0\0"+s(y,2)+s(y,2)+s(_,4)+s(A,4)+s(M.length,2)+M})(this.dirRecords.length,p,d,this.zipComment,this.encodeFileName);this.push({data:g,meta:{percent:100}})},f.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},f.prototype.registerPrevious=function(d){this._sources.push(d);var m=this;return d.on("data",function(p){m.processChunk(p)}),d.on("end",function(){m.closedSource(m.previous.streamInfo),m._sources.length?m.prepareNextSource():m.end()}),d.on("error",function(p){m.error(p)}),this},f.prototype.resume=function(){return!!c.prototype.resume.call(this)&&(!this.previous&&this._sources.length?(this.prepareNextSource(),!0):this.previous||this._sources.length||this.generatedError?void 0:(this.end(),!0))},f.prototype.error=function(d){var m=this._sources;if(!c.prototype.error.call(this,d))return!1;for(var p=0;p<m.length;p++)try{m[p].error(d)}catch{}return!0},f.prototype.lock=function(){c.prototype.lock.call(this);for(var d=this._sources,m=0;m<d.length;m++)d[m].lock()},n.exports=f},{"../crc32":4,"../signature":23,"../stream/GenericWorker":28,"../utf8":31,"../utils":32}],9:[function(r,n,i){var s=r("../compressions"),o=r("./ZipFileWorker");i.generateWorker=function(a,c,l){var u=new o(c.streamFiles,l,c.platform,c.encodeFileName),h=0;try{a.forEach(function(f,d){h++;var m=(function(_,A){var T=_||A,x=s[T];if(!x)throw new Error(T+" is not a valid compression method !");return x})(d.options.compression,c.compression),p=d.options.compressionOptions||c.compressionOptions||{},g=d.dir,y=d.date;d._compressWorker(m,p).withStreamInfo("file",{name:f,dir:g,date:y,comment:d.comment||"",unixPermissions:d.unixPermissions,dosPermissions:d.dosPermissions}).pipe(u)}),u.entriesCount=h}catch(f){u.error(f)}return u}},{"../compressions":3,"./ZipFileWorker":8}],10:[function(r,n,i){function s(){if(!(this instanceof s))return new s;if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files=Object.create(null),this.comment=null,this.root="",this.clone=function(){var o=new s;for(var a in this)typeof this[a]!="function"&&(o[a]=this[a]);return o}}(s.prototype=r("./object")).loadAsync=r("./load"),s.support=r("./support"),s.defaults=r("./defaults"),s.version="3.10.1",s.loadAsync=function(o,a){return new s().loadAsync(o,a)},s.external=r("./external"),n.exports=s},{"./defaults":5,"./external":6,"./load":11,"./object":15,"./support":30}],11:[function(r,n,i){var s=r("./utils"),o=r("./external"),a=r("./utf8"),c=r("./zipEntries"),l=r("./stream/Crc32Probe"),u=r("./nodejsUtils");function h(f){return new o.Promise(function(d,m){var p=f.decompressed.getContentWorker().pipe(new l);p.on("error",function(g){m(g)}).on("end",function(){p.streamInfo.crc32!==f.decompressed.crc32?m(new Error("Corrupted zip : CRC32 mismatch")):d()}).resume()})}n.exports=function(f,d){var m=this;return d=s.extend(d||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:a.utf8decode}),u.isNode&&u.isStream(f)?o.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):s.prepareContent("the loaded zip file",f,!0,d.optimizedBinaryString,d.base64).then(function(p){var g=new c(d);return g.load(p),g}).then(function(p){var g=[o.Promise.resolve(p)],y=p.files;if(d.checkCRC32)for(var _=0;_<y.length;_++)g.push(h(y[_]));return o.Promise.all(g)}).then(function(p){for(var g=p.shift(),y=g.files,_=0;_<y.length;_++){var A=y[_],T=A.fileNameStr,x=s.resolve(A.fileNameStr);m.file(x,A.decompressed,{binary:!0,optimizedBinaryString:!0,date:A.date,dir:A.dir,comment:A.fileCommentStr.length?A.fileCommentStr:null,unixPermissions:A.unixPermissions,dosPermissions:A.dosPermissions,createFolders:d.createFolders}),A.dir||(m.file(x).unsafeOriginalName=T)}return g.zipComment.length&&(m.comment=g.zipComment),m})}},{"./external":6,"./nodejsUtils":14,"./stream/Crc32Probe":25,"./utf8":31,"./utils":32,"./zipEntries":33}],12:[function(r,n,i){var s=r("../utils"),o=r("../stream/GenericWorker");function a(c,l){o.call(this,"Nodejs stream input adapter for "+c),this._upstreamEnded=!1,this._bindStream(l)}s.inherits(a,o),a.prototype._bindStream=function(c){var l=this;(this._stream=c).pause(),c.on("data",function(u){l.push({data:u,meta:{percent:0}})}).on("error",function(u){l.isPaused?this.generatedError=u:l.error(u)}).on("end",function(){l.isPaused?l._upstreamEnded=!0:l.end()})},a.prototype.pause=function(){return!!o.prototype.pause.call(this)&&(this._stream.pause(),!0)},a.prototype.resume=function(){return!!o.prototype.resume.call(this)&&(this._upstreamEnded?this.end():this._stream.resume(),!0)},n.exports=a},{"../stream/GenericWorker":28,"../utils":32}],13:[function(r,n,i){var s=r("readable-stream").Readable;function o(a,c,l){s.call(this,c),this._helper=a;var u=this;a.on("data",function(h,f){u.push(h)||u._helper.pause(),l&&l(f)}).on("error",function(h){u.emit("error",h)}).on("end",function(){u.push(null)})}r("../utils").inherits(o,s),o.prototype._read=function(){this._helper.resume()},n.exports=o},{"../utils":32,"readable-stream":16}],14:[function(r,n,i){n.exports={isNode:typeof Qt<"u",newBufferFrom:function(s,o){if(Qt.from&&Qt.from!==Uint8Array.from)return Qt.from(s,o);if(typeof s=="number")throw new Error('The "data" argument must not be a number');return new Qt(s,o)},allocBuffer:function(s){if(Qt.alloc)return Qt.alloc(s);var o=new Qt(s);return o.fill(0),o},isBuffer:function(s){return Qt.isBuffer(s)},isStream:function(s){return s&&typeof s.on=="function"&&typeof s.pause=="function"&&typeof s.resume=="function"}}},{}],15:[function(r,n,i){function s(x,M,R){var P,W=a.getTypeOf(M),F=a.extend(R||{},u);F.date=F.date||new Date,F.compression!==null&&(F.compression=F.compression.toUpperCase()),typeof F.unixPermissions=="string"&&(F.unixPermissions=parseInt(F.unixPermissions,8)),F.unixPermissions&&16384&F.unixPermissions&&(F.dir=!0),F.dosPermissions&&16&F.dosPermissions&&(F.dir=!0),F.dir&&(x=y(x)),F.createFolders&&(P=g(x))&&_.call(this,P,!0);var G=W==="string"&&F.binary===!1&&F.base64===!1;R&&R.binary!==void 0||(F.binary=!G),(M instanceof h&&M.uncompressedSize===0||F.dir||!M||M.length===0)&&(F.base64=!1,F.binary=!0,M="",F.compression="STORE",W="string");var O=null;O=M instanceof h||M instanceof c?M:m.isNode&&m.isStream(M)?new p(x,M):a.prepareContent(x,M,F.binary,F.optimizedBinaryString,F.base64);var I=new f(x,O,F);this.files[x]=I}var o=r("./utf8"),a=r("./utils"),c=r("./stream/GenericWorker"),l=r("./stream/StreamHelper"),u=r("./defaults"),h=r("./compressedObject"),f=r("./zipObject"),d=r("./generate"),m=r("./nodejsUtils"),p=r("./nodejs/NodejsStreamInputAdapter"),g=function(x){x.slice(-1)==="/"&&(x=x.substring(0,x.length-1));var M=x.lastIndexOf("/");return 0<M?x.substring(0,M):""},y=function(x){return x.slice(-1)!=="/"&&(x+="/"),x},_=function(x,M){return M=M!==void 0?M:u.createFolders,x=y(x),this.files[x]||s.call(this,x,null,{dir:!0,createFolders:M}),this.files[x]};function A(x){return Object.prototype.toString.call(x)==="[object RegExp]"}var T={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(x){var M,R,P;for(M in this.files)P=this.files[M],(R=M.slice(this.root.length,M.length))&&M.slice(0,this.root.length)===this.root&&x(R,P)},filter:function(x){var M=[];return this.forEach(function(R,P){x(R,P)&&M.push(P)}),M},file:function(x,M,R){if(arguments.length!==1)return x=this.root+x,s.call(this,x,M,R),this;if(A(x)){var P=x;return this.filter(function(F,G){return!G.dir&&P.test(F)})}var W=this.files[this.root+x];return W&&!W.dir?W:null},folder:function(x){if(!x)return this;if(A(x))return this.filter(function(W,F){return F.dir&&x.test(W)});var M=this.root+x,R=_.call(this,M),P=this.clone();return P.root=R.name,P},remove:function(x){x=this.root+x;var M=this.files[x];if(M||(x.slice(-1)!=="/"&&(x+="/"),M=this.files[x]),M&&!M.dir)delete this.files[x];else for(var R=this.filter(function(W,F){return F.name.slice(0,x.length)===x}),P=0;P<R.length;P++)delete this.files[R[P].name];return this},generate:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(x){var M,R={};try{if((R=a.extend(x||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:o.utf8encode})).type=R.type.toLowerCase(),R.compression=R.compression.toUpperCase(),R.type==="binarystring"&&(R.type="string"),!R.type)throw new Error("No output type specified.");a.checkSupport(R.type),R.platform!=="darwin"&&R.platform!=="freebsd"&&R.platform!=="linux"&&R.platform!=="sunos"||(R.platform="UNIX"),R.platform==="win32"&&(R.platform="DOS");var P=R.comment||this.comment||"";M=d.generateWorker(this,R,P)}catch(W){(M=new c("error")).error(W)}return new l(M,R.type||"string",R.mimeType)},generateAsync:function(x,M){return this.generateInternalStream(x).accumulate(M)},generateNodeStream:function(x,M){return(x=x||{}).type||(x.type="nodebuffer"),this.generateInternalStream(x).toNodejsStream(M)}};n.exports=T},{"./compressedObject":2,"./defaults":5,"./generate":9,"./nodejs/NodejsStreamInputAdapter":12,"./nodejsUtils":14,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31,"./utils":32,"./zipObject":35}],16:[function(r,n,i){n.exports=r("stream")},{stream:void 0}],17:[function(r,n,i){var s=r("./DataReader");function o(a){s.call(this,a);for(var c=0;c<this.data.length;c++)a[c]=255&a[c]}r("../utils").inherits(o,s),o.prototype.byteAt=function(a){return this.data[this.zero+a]},o.prototype.lastIndexOfSignature=function(a){for(var c=a.charCodeAt(0),l=a.charCodeAt(1),u=a.charCodeAt(2),h=a.charCodeAt(3),f=this.length-4;0<=f;--f)if(this.data[f]===c&&this.data[f+1]===l&&this.data[f+2]===u&&this.data[f+3]===h)return f-this.zero;return-1},o.prototype.readAndCheckSignature=function(a){var c=a.charCodeAt(0),l=a.charCodeAt(1),u=a.charCodeAt(2),h=a.charCodeAt(3),f=this.readData(4);return c===f[0]&&l===f[1]&&u===f[2]&&h===f[3]},o.prototype.readData=function(a){if(this.checkOffset(a),a===0)return[];var c=this.data.slice(this.zero+this.index,this.zero+this.index+a);return this.index+=a,c},n.exports=o},{"../utils":32,"./DataReader":18}],18:[function(r,n,i){var s=r("../utils");function o(a){this.data=a,this.length=a.length,this.index=0,this.zero=0}o.prototype={checkOffset:function(a){this.checkIndex(this.index+a)},checkIndex:function(a){if(this.length<this.zero+a||a<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+a+"). Corrupted zip ?")},setIndex:function(a){this.checkIndex(a),this.index=a},skip:function(a){this.setIndex(this.index+a)},byteAt:function(){},readInt:function(a){var c,l=0;for(this.checkOffset(a),c=this.index+a-1;c>=this.index;c--)l=(l<<8)+this.byteAt(c);return this.index+=a,l},readString:function(a){return s.transformTo("string",this.readData(a))},readData:function(){},lastIndexOfSignature:function(){},readAndCheckSignature:function(){},readDate:function(){var a=this.readInt(4);return new Date(Date.UTC(1980+(a>>25&127),(a>>21&15)-1,a>>16&31,a>>11&31,a>>5&63,(31&a)<<1))}},n.exports=o},{"../utils":32}],19:[function(r,n,i){var s=r("./Uint8ArrayReader");function o(a){s.call(this,a)}r("../utils").inherits(o,s),o.prototype.readData=function(a){this.checkOffset(a);var c=this.data.slice(this.zero+this.index,this.zero+this.index+a);return this.index+=a,c},n.exports=o},{"../utils":32,"./Uint8ArrayReader":21}],20:[function(r,n,i){var s=r("./DataReader");function o(a){s.call(this,a)}r("../utils").inherits(o,s),o.prototype.byteAt=function(a){return this.data.charCodeAt(this.zero+a)},o.prototype.lastIndexOfSignature=function(a){return this.data.lastIndexOf(a)-this.zero},o.prototype.readAndCheckSignature=function(a){return a===this.readData(4)},o.prototype.readData=function(a){this.checkOffset(a);var c=this.data.slice(this.zero+this.index,this.zero+this.index+a);return this.index+=a,c},n.exports=o},{"../utils":32,"./DataReader":18}],21:[function(r,n,i){var s=r("./ArrayReader");function o(a){s.call(this,a)}r("../utils").inherits(o,s),o.prototype.readData=function(a){if(this.checkOffset(a),a===0)return new Uint8Array(0);var c=this.data.subarray(this.zero+this.index,this.zero+this.index+a);return this.index+=a,c},n.exports=o},{"../utils":32,"./ArrayReader":17}],22:[function(r,n,i){var s=r("../utils"),o=r("../support"),a=r("./ArrayReader"),c=r("./StringReader"),l=r("./NodeBufferReader"),u=r("./Uint8ArrayReader");n.exports=function(h){var f=s.getTypeOf(h);return s.checkSupport(f),f!=="string"||o.uint8array?f==="nodebuffer"?new l(h):o.uint8array?new u(s.transformTo("uint8array",h)):new a(s.transformTo("array",h)):new c(h)}},{"../support":30,"../utils":32,"./ArrayReader":17,"./NodeBufferReader":19,"./StringReader":20,"./Uint8ArrayReader":21}],23:[function(r,n,i){i.LOCAL_FILE_HEADER="PK",i.CENTRAL_FILE_HEADER="PK",i.CENTRAL_DIRECTORY_END="PK",i.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK\x07",i.ZIP64_CENTRAL_DIRECTORY_END="PK",i.DATA_DESCRIPTOR="PK\x07\b"},{}],24:[function(r,n,i){var s=r("./GenericWorker"),o=r("../utils");function a(c){s.call(this,"ConvertWorker to "+c),this.destType=c}o.inherits(a,s),a.prototype.processChunk=function(c){this.push({data:o.transformTo(this.destType,c.data),meta:c.meta})},n.exports=a},{"../utils":32,"./GenericWorker":28}],25:[function(r,n,i){var s=r("./GenericWorker"),o=r("../crc32");function a(){s.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}r("../utils").inherits(a,s),a.prototype.processChunk=function(c){this.streamInfo.crc32=o(c.data,this.streamInfo.crc32||0),this.push(c)},n.exports=a},{"../crc32":4,"../utils":32,"./GenericWorker":28}],26:[function(r,n,i){var s=r("../utils"),o=r("./GenericWorker");function a(c){o.call(this,"DataLengthProbe for "+c),this.propName=c,this.withStreamInfo(c,0)}s.inherits(a,o),a.prototype.processChunk=function(c){if(c){var l=this.streamInfo[this.propName]||0;this.streamInfo[this.propName]=l+c.data.length}o.prototype.processChunk.call(this,c)},n.exports=a},{"../utils":32,"./GenericWorker":28}],27:[function(r,n,i){var s=r("../utils"),o=r("./GenericWorker");function a(c){o.call(this,"DataWorker");var l=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,c.then(function(u){l.dataIsReady=!0,l.data=u,l.max=u&&u.length||0,l.type=s.getTypeOf(u),l.isPaused||l._tickAndRepeat()},function(u){l.error(u)})}s.inherits(a,o),a.prototype.cleanUp=function(){o.prototype.cleanUp.call(this),this.data=null},a.prototype.resume=function(){return!!o.prototype.resume.call(this)&&(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,s.delay(this._tickAndRepeat,[],this)),!0)},a.prototype._tickAndRepeat=function(){this._tickScheduled=!1,this.isPaused||this.isFinished||(this._tick(),this.isFinished||(s.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},a.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var c=null,l=Math.min(this.max,this.index+16384);if(this.index>=this.max)return this.end();switch(this.type){case"string":c=this.data.substring(this.index,l);break;case"uint8array":c=this.data.subarray(this.index,l);break;case"array":case"nodebuffer":c=this.data.slice(this.index,l)}return this.index=l,this.push({data:c,meta:{percent:this.max?this.index/this.max*100:0}})},n.exports=a},{"../utils":32,"./GenericWorker":28}],28:[function(r,n,i){function s(o){this.name=o||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}s.prototype={push:function(o){this.emit("data",o)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(o){this.emit("error",o)}return!0},error:function(o){return!this.isFinished&&(this.isPaused?this.generatedError=o:(this.isFinished=!0,this.emit("error",o),this.previous&&this.previous.error(o),this.cleanUp()),!0)},on:function(o,a){return this._listeners[o].push(a),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(o,a){if(this._listeners[o])for(var c=0;c<this._listeners[o].length;c++)this._listeners[o][c].call(this,a)},pipe:function(o){return o.registerPrevious(this)},registerPrevious:function(o){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=o.streamInfo,this.mergeStreamInfo(),this.previous=o;var a=this;return o.on("data",function(c){a.processChunk(c)}),o.on("end",function(){a.end()}),o.on("error",function(c){a.error(c)}),this},pause:function(){return!this.isPaused&&!this.isFinished&&(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;var o=this.isPaused=!1;return this.generatedError&&(this.error(this.generatedError),o=!0),this.previous&&this.previous.resume(),!o},flush:function(){},processChunk:function(o){this.push(o)},withStreamInfo:function(o,a){return this.extraStreamInfo[o]=a,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var o in this.extraStreamInfo)Object.prototype.hasOwnProperty.call(this.extraStreamInfo,o)&&(this.streamInfo[o]=this.extraStreamInfo[o])},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var o="Worker "+this.name;return this.previous?this.previous+" -> "+o:o}},n.exports=s},{}],29:[function(r,n,i){var s=r("../utils"),o=r("./ConvertWorker"),a=r("./GenericWorker"),c=r("../base64"),l=r("../support"),u=r("../external"),h=null;if(l.nodestream)try{h=r("../nodejs/NodejsStreamOutputAdapter")}catch{}function f(m,p){return new u.Promise(function(g,y){var _=[],A=m._internalType,T=m._outputType,x=m._mimeType;m.on("data",function(M,R){_.push(M),p&&p(R)}).on("error",function(M){_=[],y(M)}).on("end",function(){try{var M=(function(R,P,W){switch(R){case"blob":return s.newBlob(s.transformTo("arraybuffer",P),W);case"base64":return c.encode(P);default:return s.transformTo(R,P)}})(T,(function(R,P){var W,F=0,G=null,O=0;for(W=0;W<P.length;W++)O+=P[W].length;switch(R){case"string":return P.join("");case"array":return Array.prototype.concat.apply([],P);case"uint8array":for(G=new Uint8Array(O),W=0;W<P.length;W++)G.set(P[W],F),F+=P[W].length;return G;case"nodebuffer":return Qt.concat(P);default:throw new Error("concat : unsupported type '"+R+"'")}})(A,_),x);g(M)}catch(R){y(R)}_=[]}).resume()})}function d(m,p,g){var y=p;switch(p){case"blob":case"arraybuffer":y="uint8array";break;case"base64":y="string"}try{this._internalType=y,this._outputType=p,this._mimeType=g,s.checkSupport(y),this._worker=m.pipe(new o(y)),m.lock()}catch(_){this._worker=new a("error"),this._worker.error(_)}}d.prototype={accumulate:function(m){return f(this,m)},on:function(m,p){var g=this;return m==="data"?this._worker.on(m,function(y){p.call(g,y.data,y.meta)}):this._worker.on(m,function(){s.delay(p,arguments,g)}),this},resume:function(){return s.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(m){if(s.checkSupport("nodestream"),this._outputType!=="nodebuffer")throw new Error(this._outputType+" is not supported by this method");return new h(this,{objectMode:this._outputType!=="nodebuffer"},m)}},n.exports=d},{"../base64":1,"../external":6,"../nodejs/NodejsStreamOutputAdapter":13,"../support":30,"../utils":32,"./ConvertWorker":24,"./GenericWorker":28}],30:[function(r,n,i){if(i.base64=!0,i.array=!0,i.string=!0,i.arraybuffer=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u",i.nodebuffer=typeof Qt<"u",i.uint8array=typeof Uint8Array<"u",typeof ArrayBuffer>"u")i.blob=!1;else{var s=new ArrayBuffer(0);try{i.blob=new Blob([s],{type:"application/zip"}).size===0}catch{try{var o=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);o.append(s),i.blob=o.getBlob("application/zip").size===0}catch{i.blob=!1}}}try{i.nodestream=!!r("readable-stream").Readable}catch{i.nodestream=!1}},{"readable-stream":16}],31:[function(r,n,i){for(var s=r("./utils"),o=r("./support"),a=r("./nodejsUtils"),c=r("./stream/GenericWorker"),l=new Array(256),u=0;u<256;u++)l[u]=252<=u?6:248<=u?5:240<=u?4:224<=u?3:192<=u?2:1;l[254]=l[254]=1;function h(){c.call(this,"utf-8 decode"),this.leftOver=null}function f(){c.call(this,"utf-8 encode")}i.utf8encode=function(d){return o.nodebuffer?a.newBufferFrom(d,"utf-8"):(function(m){var p,g,y,_,A,T=m.length,x=0;for(_=0;_<T;_++)(64512&(g=m.charCodeAt(_)))==55296&&_+1<T&&(64512&(y=m.charCodeAt(_+1)))==56320&&(g=65536+(g-55296<<10)+(y-56320),_++),x+=g<128?1:g<2048?2:g<65536?3:4;for(p=o.uint8array?new Uint8Array(x):new Array(x),_=A=0;A<x;_++)(64512&(g=m.charCodeAt(_)))==55296&&_+1<T&&(64512&(y=m.charCodeAt(_+1)))==56320&&(g=65536+(g-55296<<10)+(y-56320),_++),g<128?p[A++]=g:(g<2048?p[A++]=192|g>>>6:(g<65536?p[A++]=224|g>>>12:(p[A++]=240|g>>>18,p[A++]=128|g>>>12&63),p[A++]=128|g>>>6&63),p[A++]=128|63&g);return p})(d)},i.utf8decode=function(d){return o.nodebuffer?s.transformTo("nodebuffer",d).toString("utf-8"):(function(m){var p,g,y,_,A=m.length,T=new Array(2*A);for(p=g=0;p<A;)if((y=m[p++])<128)T[g++]=y;else if(4<(_=l[y]))T[g++]=65533,p+=_-1;else{for(y&=_===2?31:_===3?15:7;1<_&&p<A;)y=y<<6|63&m[p++],_--;1<_?T[g++]=65533:y<65536?T[g++]=y:(y-=65536,T[g++]=55296|y>>10&1023,T[g++]=56320|1023&y)}return T.length!==g&&(T.subarray?T=T.subarray(0,g):T.length=g),s.applyFromCharCode(T)})(d=s.transformTo(o.uint8array?"uint8array":"array",d))},s.inherits(h,c),h.prototype.processChunk=function(d){var m=s.transformTo(o.uint8array?"uint8array":"array",d.data);if(this.leftOver&&this.leftOver.length){if(o.uint8array){var p=m;(m=new Uint8Array(p.length+this.leftOver.length)).set(this.leftOver,0),m.set(p,this.leftOver.length)}else m=this.leftOver.concat(m);this.leftOver=null}var g=(function(_,A){var T;for((A=A||_.length)>_.length&&(A=_.length),T=A-1;0<=T&&(192&_[T])==128;)T--;return T<0||T===0?A:T+l[_[T]]>A?T:A})(m),y=m;g!==m.length&&(o.uint8array?(y=m.subarray(0,g),this.leftOver=m.subarray(g,m.length)):(y=m.slice(0,g),this.leftOver=m.slice(g,m.length))),this.push({data:i.utf8decode(y),meta:d.meta})},h.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:i.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},i.Utf8DecodeWorker=h,s.inherits(f,c),f.prototype.processChunk=function(d){this.push({data:i.utf8encode(d.data),meta:d.meta})},i.Utf8EncodeWorker=f},{"./nodejsUtils":14,"./stream/GenericWorker":28,"./support":30,"./utils":32}],32:[function(r,n,i){var s=r("./support"),o=r("./base64"),a=r("./nodejsUtils"),c=r("./external");function l(p){return p}function u(p,g){for(var y=0;y<p.length;++y)g[y]=255&p.charCodeAt(y);return g}r("setimmediate"),i.newBlob=function(p,g){i.checkSupport("blob");try{return new Blob([p],{type:g})}catch{try{var y=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);return y.append(p),y.getBlob(g)}catch{throw new Error("Bug : can't construct the Blob.")}}};var h={stringifyByChunk:function(p,g,y){var _=[],A=0,T=p.length;if(T<=y)return String.fromCharCode.apply(null,p);for(;A<T;)g==="array"||g==="nodebuffer"?_.push(String.fromCharCode.apply(null,p.slice(A,Math.min(A+y,T)))):_.push(String.fromCharCode.apply(null,p.subarray(A,Math.min(A+y,T)))),A+=y;return _.join("")},stringifyByChar:function(p){for(var g="",y=0;y<p.length;y++)g+=String.fromCharCode(p[y]);return g},applyCanBeUsed:{uint8array:(function(){try{return s.uint8array&&String.fromCharCode.apply(null,new Uint8Array(1)).length===1}catch{return!1}})(),nodebuffer:(function(){try{return s.nodebuffer&&String.fromCharCode.apply(null,a.allocBuffer(1)).length===1}catch{return!1}})()}};function f(p){var g=65536,y=i.getTypeOf(p),_=!0;if(y==="uint8array"?_=h.applyCanBeUsed.uint8array:y==="nodebuffer"&&(_=h.applyCanBeUsed.nodebuffer),_)for(;1<g;)try{return h.stringifyByChunk(p,y,g)}catch{g=Math.floor(g/2)}return h.stringifyByChar(p)}function d(p,g){for(var y=0;y<p.length;y++)g[y]=p[y];return g}i.applyFromCharCode=f;var m={};m.string={string:l,array:function(p){return u(p,new Array(p.length))},arraybuffer:function(p){return m.string.uint8array(p).buffer},uint8array:function(p){return u(p,new Uint8Array(p.length))},nodebuffer:function(p){return u(p,a.allocBuffer(p.length))}},m.array={string:f,array:l,arraybuffer:function(p){return new Uint8Array(p).buffer},uint8array:function(p){return new Uint8Array(p)},nodebuffer:function(p){return a.newBufferFrom(p)}},m.arraybuffer={string:function(p){return f(new Uint8Array(p))},array:function(p){return d(new Uint8Array(p),new Array(p.byteLength))},arraybuffer:l,uint8array:function(p){return new Uint8Array(p)},nodebuffer:function(p){return a.newBufferFrom(new Uint8Array(p))}},m.uint8array={string:f,array:function(p){return d(p,new Array(p.length))},arraybuffer:function(p){return p.buffer},uint8array:l,nodebuffer:function(p){return a.newBufferFrom(p)}},m.nodebuffer={string:f,array:function(p){return d(p,new Array(p.length))},arraybuffer:function(p){return m.nodebuffer.uint8array(p).buffer},uint8array:function(p){return d(p,new Uint8Array(p.length))},nodebuffer:l},i.transformTo=function(p,g){if(g=g||"",!p)return g;i.checkSupport(p);var y=i.getTypeOf(g);return m[y][p](g)},i.resolve=function(p){for(var g=p.split("/"),y=[],_=0;_<g.length;_++){var A=g[_];A==="."||A===""&&_!==0&&_!==g.length-1||(A===".."?y.pop():y.push(A))}return y.join("/")},i.getTypeOf=function(p){return typeof p=="string"?"string":Object.prototype.toString.call(p)==="[object Array]"?"array":s.nodebuffer&&a.isBuffer(p)?"nodebuffer":s.uint8array&&p instanceof Uint8Array?"uint8array":s.arraybuffer&&p instanceof ArrayBuffer?"arraybuffer":void 0},i.checkSupport=function(p){if(!s[p.toLowerCase()])throw new Error(p+" is not supported by this platform")},i.MAX_VALUE_16BITS=65535,i.MAX_VALUE_32BITS=-1,i.pretty=function(p){var g,y,_="";for(y=0;y<(p||"").length;y++)_+="\\x"+((g=p.charCodeAt(y))<16?"0":"")+g.toString(16).toUpperCase();return _},i.delay=function(p,g,y){setImmediate(function(){p.apply(y||null,g||[])})},i.inherits=function(p,g){function y(){}y.prototype=g.prototype,p.prototype=new y},i.extend=function(){var p,g,y={};for(p=0;p<arguments.length;p++)for(g in arguments[p])Object.prototype.hasOwnProperty.call(arguments[p],g)&&y[g]===void 0&&(y[g]=arguments[p][g]);return y},i.prepareContent=function(p,g,y,_,A){return c.Promise.resolve(g).then(function(T){return s.blob&&(T instanceof Blob||["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(T))!==-1)&&typeof FileReader<"u"?new c.Promise(function(x,M){var R=new FileReader;R.onload=function(P){x(P.target.result)},R.onerror=function(P){M(P.target.error)},R.readAsArrayBuffer(T)}):T}).then(function(T){var x=i.getTypeOf(T);return x?(x==="arraybuffer"?T=i.transformTo("uint8array",T):x==="string"&&(A?T=o.decode(T):y&&_!==!0&&(T=(function(M){return u(M,s.uint8array?new Uint8Array(M.length):new Array(M.length))})(T))),T):c.Promise.reject(new Error("Can't read the data of '"+p+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))})}},{"./base64":1,"./external":6,"./nodejsUtils":14,"./support":30,setimmediate:54}],33:[function(r,n,i){var s=r("./reader/readerFor"),o=r("./utils"),a=r("./signature"),c=r("./zipEntry"),l=r("./support");function u(h){this.files=[],this.loadOptions=h}u.prototype={checkSignature:function(h){if(!this.reader.readAndCheckSignature(h)){this.reader.index-=4;var f=this.reader.readString(4);throw new Error("Corrupted zip or bug: unexpected signature ("+o.pretty(f)+", expected "+o.pretty(h)+")")}},isSignature:function(h,f){var d=this.reader.index;this.reader.setIndex(h);var m=this.reader.readString(4)===f;return this.reader.setIndex(d),m},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var h=this.reader.readData(this.zipCommentLength),f=l.uint8array?"uint8array":"array",d=o.transformTo(f,h);this.zipComment=this.loadOptions.decodeFileName(d)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var h,f,d,m=this.zip64EndOfCentralSize-44;0<m;)h=this.reader.readInt(2),f=this.reader.readInt(4),d=this.reader.readData(f),this.zip64ExtensibleData[h]={id:h,length:f,value:d}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),1<this.disksCount)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var h,f;for(h=0;h<this.files.length;h++)f=this.files[h],this.reader.setIndex(f.localHeaderOffset),this.checkSignature(a.LOCAL_FILE_HEADER),f.readLocalPart(this.reader),f.handleUTF8(),f.processAttributes()},readCentralDir:function(){var h;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(a.CENTRAL_FILE_HEADER);)(h=new c({zip64:this.zip64},this.loadOptions)).readCentralPart(this.reader),this.files.push(h);if(this.centralDirRecords!==this.files.length&&this.centralDirRecords!==0&&this.files.length===0)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var h=this.reader.lastIndexOfSignature(a.CENTRAL_DIRECTORY_END);if(h<0)throw this.isSignature(0,a.LOCAL_FILE_HEADER)?new Error("Corrupted zip: can't find end of central directory"):new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html");this.reader.setIndex(h);var f=h;if(this.checkSignature(a.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===o.MAX_VALUE_16BITS||this.diskWithCentralDirStart===o.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===o.MAX_VALUE_16BITS||this.centralDirRecords===o.MAX_VALUE_16BITS||this.centralDirSize===o.MAX_VALUE_32BITS||this.centralDirOffset===o.MAX_VALUE_32BITS){if(this.zip64=!0,(h=this.reader.lastIndexOfSignature(a.ZIP64_CENTRAL_DIRECTORY_LOCATOR))<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(h),this.checkSignature(a.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,a.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(a.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(a.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var d=this.centralDirOffset+this.centralDirSize;this.zip64&&(d+=20,d+=12+this.zip64EndOfCentralSize);var m=f-d;if(0<m)this.isSignature(f,a.CENTRAL_FILE_HEADER)||(this.reader.zero=m);else if(m<0)throw new Error("Corrupted zip: missing "+Math.abs(m)+" bytes.")},prepareReader:function(h){this.reader=s(h)},load:function(h){this.prepareReader(h),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},n.exports=u},{"./reader/readerFor":22,"./signature":23,"./support":30,"./utils":32,"./zipEntry":34}],34:[function(r,n,i){var s=r("./reader/readerFor"),o=r("./utils"),a=r("./compressedObject"),c=r("./crc32"),l=r("./utf8"),u=r("./compressions"),h=r("./support");function f(d,m){this.options=d,this.loadOptions=m}f.prototype={isEncrypted:function(){return(1&this.bitFlag)==1},useUTF8:function(){return(2048&this.bitFlag)==2048},readLocalPart:function(d){var m,p;if(d.skip(22),this.fileNameLength=d.readInt(2),p=d.readInt(2),this.fileName=d.readData(this.fileNameLength),d.skip(p),this.compressedSize===-1||this.uncompressedSize===-1)throw new Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");if((m=(function(g){for(var y in u)if(Object.prototype.hasOwnProperty.call(u,y)&&u[y].magic===g)return u[y];return null})(this.compressionMethod))===null)throw new Error("Corrupted zip : compression "+o.pretty(this.compressionMethod)+" unknown (inner file : "+o.transformTo("string",this.fileName)+")");this.decompressed=new a(this.compressedSize,this.uncompressedSize,this.crc32,m,d.readData(this.compressedSize))},readCentralPart:function(d){this.versionMadeBy=d.readInt(2),d.skip(2),this.bitFlag=d.readInt(2),this.compressionMethod=d.readString(2),this.date=d.readDate(),this.crc32=d.readInt(4),this.compressedSize=d.readInt(4),this.uncompressedSize=d.readInt(4);var m=d.readInt(2);if(this.extraFieldsLength=d.readInt(2),this.fileCommentLength=d.readInt(2),this.diskNumberStart=d.readInt(2),this.internalFileAttributes=d.readInt(2),this.externalFileAttributes=d.readInt(4),this.localHeaderOffset=d.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");d.skip(m),this.readExtraFields(d),this.parseZIP64ExtraField(d),this.fileComment=d.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var d=this.versionMadeBy>>8;this.dir=!!(16&this.externalFileAttributes),d==0&&(this.dosPermissions=63&this.externalFileAttributes),d==3&&(this.unixPermissions=this.externalFileAttributes>>16&65535),this.dir||this.fileNameStr.slice(-1)!=="/"||(this.dir=!0)},parseZIP64ExtraField:function(){if(this.extraFields[1]){var d=s(this.extraFields[1].value);this.uncompressedSize===o.MAX_VALUE_32BITS&&(this.uncompressedSize=d.readInt(8)),this.compressedSize===o.MAX_VALUE_32BITS&&(this.compressedSize=d.readInt(8)),this.localHeaderOffset===o.MAX_VALUE_32BITS&&(this.localHeaderOffset=d.readInt(8)),this.diskNumberStart===o.MAX_VALUE_32BITS&&(this.diskNumberStart=d.readInt(4))}},readExtraFields:function(d){var m,p,g,y=d.index+this.extraFieldsLength;for(this.extraFields||(this.extraFields={});d.index+4<y;)m=d.readInt(2),p=d.readInt(2),g=d.readData(p),this.extraFields[m]={id:m,length:p,value:g};d.setIndex(y)},handleUTF8:function(){var d=h.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=l.utf8decode(this.fileName),this.fileCommentStr=l.utf8decode(this.fileComment);else{var m=this.findExtraFieldUnicodePath();if(m!==null)this.fileNameStr=m;else{var p=o.transformTo(d,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(p)}var g=this.findExtraFieldUnicodeComment();if(g!==null)this.fileCommentStr=g;else{var y=o.transformTo(d,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(y)}}},findExtraFieldUnicodePath:function(){var d=this.extraFields[28789];if(d){var m=s(d.value);return m.readInt(1)!==1||c(this.fileName)!==m.readInt(4)?null:l.utf8decode(m.readData(d.length-5))}return null},findExtraFieldUnicodeComment:function(){var d=this.extraFields[25461];if(d){var m=s(d.value);return m.readInt(1)!==1||c(this.fileComment)!==m.readInt(4)?null:l.utf8decode(m.readData(d.length-5))}return null}},n.exports=f},{"./compressedObject":2,"./compressions":3,"./crc32":4,"./reader/readerFor":22,"./support":30,"./utf8":31,"./utils":32}],35:[function(r,n,i){function s(m,p,g){this.name=m,this.dir=g.dir,this.date=g.date,this.comment=g.comment,this.unixPermissions=g.unixPermissions,this.dosPermissions=g.dosPermissions,this._data=p,this._dataBinary=g.binary,this.options={compression:g.compression,compressionOptions:g.compressionOptions}}var o=r("./stream/StreamHelper"),a=r("./stream/DataWorker"),c=r("./utf8"),l=r("./compressedObject"),u=r("./stream/GenericWorker");s.prototype={internalStream:function(m){var p=null,g="string";try{if(!m)throw new Error("No output type specified.");var y=(g=m.toLowerCase())==="string"||g==="text";g!=="binarystring"&&g!=="text"||(g="string"),p=this._decompressWorker();var _=!this._dataBinary;_&&!y&&(p=p.pipe(new c.Utf8EncodeWorker)),!_&&y&&(p=p.pipe(new c.Utf8DecodeWorker))}catch(A){(p=new u("error")).error(A)}return new o(p,g,"")},async:function(m,p){return this.internalStream(m).accumulate(p)},nodeStream:function(m,p){return this.internalStream(m||"nodebuffer").toNodejsStream(p)},_compressWorker:function(m,p){if(this._data instanceof l&&this._data.compression.magic===m.magic)return this._data.getCompressedWorker();var g=this._decompressWorker();return this._dataBinary||(g=g.pipe(new c.Utf8EncodeWorker)),l.createWorkerFrom(g,m,p)},_decompressWorker:function(){return this._data instanceof l?this._data.getContentWorker():this._data instanceof u?this._data:new a(this._data)}};for(var h=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],f=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},d=0;d<h.length;d++)s.prototype[h[d]]=f;n.exports=s},{"./compressedObject":2,"./stream/DataWorker":27,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31}],36:[function(r,n,i){(function(s){var o,a,c=s.MutationObserver||s.WebKitMutationObserver;if(c){var l=0,u=new c(m),h=s.document.createTextNode("");u.observe(h,{characterData:!0}),o=function(){h.data=l=++l%2}}else if(s.setImmediate||s.MessageChannel===void 0)o="document"in s&&"onreadystatechange"in s.document.createElement("script")?function(){var p=s.document.createElement("script");p.onreadystatechange=function(){m(),p.onreadystatechange=null,p.parentNode.removeChild(p),p=null},s.document.documentElement.appendChild(p)}:function(){setTimeout(m,0)};else{var f=new s.MessageChannel;f.port1.onmessage=m,o=function(){f.port2.postMessage(0)}}var d=[];function m(){var p,g;a=!0;for(var y=d.length;y;){for(g=d,d=[],p=-1;++p<y;)g[p]();y=d.length}a=!1}n.exports=function(p){d.push(p)!==1||a||o()}}).call(this,typeof ji<"u"?ji:typeof self<"u"?self:typeof window<"u"?window:{})},{}],37:[function(r,n,i){var s=r("immediate");function o(){}var a={},c=["REJECTED"],l=["FULFILLED"],u=["PENDING"];function h(y){if(typeof y!="function")throw new TypeError("resolver must be a function");this.state=u,this.queue=[],this.outcome=void 0,y!==o&&p(this,y)}function f(y,_,A){this.promise=y,typeof _=="function"&&(this.onFulfilled=_,this.callFulfilled=this.otherCallFulfilled),typeof A=="function"&&(this.onRejected=A,this.callRejected=this.otherCallRejected)}function d(y,_,A){s(function(){var T;try{T=_(A)}catch(x){return a.reject(y,x)}T===y?a.reject(y,new TypeError("Cannot resolve promise with itself")):a.resolve(y,T)})}function m(y){var _=y&&y.then;if(y&&(typeof y=="object"||typeof y=="function")&&typeof _=="function")return function(){_.apply(y,arguments)}}function p(y,_){var A=!1;function T(R){A||(A=!0,a.reject(y,R))}function x(R){A||(A=!0,a.resolve(y,R))}var M=g(function(){_(x,T)});M.status==="error"&&T(M.value)}function g(y,_){var A={};try{A.value=y(_),A.status="success"}catch(T){A.status="error",A.value=T}return A}(n.exports=h).prototype.finally=function(y){if(typeof y!="function")return this;var _=this.constructor;return this.then(function(A){return _.resolve(y()).then(function(){return A})},function(A){return _.resolve(y()).then(function(){throw A})})},h.prototype.catch=function(y){return this.then(null,y)},h.prototype.then=function(y,_){if(typeof y!="function"&&this.state===l||typeof _!="function"&&this.state===c)return this;var A=new this.constructor(o);return this.state!==u?d(A,this.state===l?y:_,this.outcome):this.queue.push(new f(A,y,_)),A},f.prototype.callFulfilled=function(y){a.resolve(this.promise,y)},f.prototype.otherCallFulfilled=function(y){d(this.promise,this.onFulfilled,y)},f.prototype.callRejected=function(y){a.reject(this.promise,y)},f.prototype.otherCallRejected=function(y){d(this.promise,this.onRejected,y)},a.resolve=function(y,_){var A=g(m,_);if(A.status==="error")return a.reject(y,A.value);var T=A.value;if(T)p(y,T);else{y.state=l,y.outcome=_;for(var x=-1,M=y.queue.length;++x<M;)y.queue[x].callFulfilled(_)}return y},a.reject=function(y,_){y.state=c,y.outcome=_;for(var A=-1,T=y.queue.length;++A<T;)y.queue[A].callRejected(_);return y},h.resolve=function(y){return y instanceof this?y:a.resolve(new this(o),y)},h.reject=function(y){var _=new this(o);return a.reject(_,y)},h.all=function(y){var _=this;if(Object.prototype.toString.call(y)!=="[object Array]")return this.reject(new TypeError("must be an array"));var A=y.length,T=!1;if(!A)return this.resolve([]);for(var x=new Array(A),M=0,R=-1,P=new this(o);++R<A;)W(y[R],R);return P;function W(F,G){_.resolve(F).then(function(O){x[G]=O,++M!==A||T||(T=!0,a.resolve(P,x))},function(O){T||(T=!0,a.reject(P,O))})}},h.race=function(y){var _=this;if(Object.prototype.toString.call(y)!=="[object Array]")return this.reject(new TypeError("must be an array"));var A=y.length,T=!1;if(!A)return this.resolve([]);for(var x=-1,M=new this(o);++x<A;)R=y[x],_.resolve(R).then(function(P){T||(T=!0,a.resolve(M,P))},function(P){T||(T=!0,a.reject(M,P))});var R;return M}},{immediate:36}],38:[function(r,n,i){var s={};(0,r("./lib/utils/common").assign)(s,r("./lib/deflate"),r("./lib/inflate"),r("./lib/zlib/constants")),n.exports=s},{"./lib/deflate":39,"./lib/inflate":40,"./lib/utils/common":41,"./lib/zlib/constants":44}],39:[function(r,n,i){var s=r("./zlib/deflate"),o=r("./utils/common"),a=r("./utils/strings"),c=r("./zlib/messages"),l=r("./zlib/zstream"),u=Object.prototype.toString,h=0,f=-1,d=0,m=8;function p(y){if(!(this instanceof p))return new p(y);this.options=o.assign({level:f,method:m,chunkSize:16384,windowBits:15,memLevel:8,strategy:d,to:""},y||{});var _=this.options;_.raw&&0<_.windowBits?_.windowBits=-_.windowBits:_.gzip&&0<_.windowBits&&_.windowBits<16&&(_.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new l,this.strm.avail_out=0;var A=s.deflateInit2(this.strm,_.level,_.method,_.windowBits,_.memLevel,_.strategy);if(A!==h)throw new Error(c[A]);if(_.header&&s.deflateSetHeader(this.strm,_.header),_.dictionary){var T;if(T=typeof _.dictionary=="string"?a.string2buf(_.dictionary):u.call(_.dictionary)==="[object ArrayBuffer]"?new Uint8Array(_.dictionary):_.dictionary,(A=s.deflateSetDictionary(this.strm,T))!==h)throw new Error(c[A]);this._dict_set=!0}}function g(y,_){var A=new p(_);if(A.push(y,!0),A.err)throw A.msg||c[A.err];return A.result}p.prototype.push=function(y,_){var A,T,x=this.strm,M=this.options.chunkSize;if(this.ended)return!1;T=_===~~_?_:_===!0?4:0,typeof y=="string"?x.input=a.string2buf(y):u.call(y)==="[object ArrayBuffer]"?x.input=new Uint8Array(y):x.input=y,x.next_in=0,x.avail_in=x.input.length;do{if(x.avail_out===0&&(x.output=new o.Buf8(M),x.next_out=0,x.avail_out=M),(A=s.deflate(x,T))!==1&&A!==h)return this.onEnd(A),!(this.ended=!0);x.avail_out!==0&&(x.avail_in!==0||T!==4&&T!==2)||(this.options.to==="string"?this.onData(a.buf2binstring(o.shrinkBuf(x.output,x.next_out))):this.onData(o.shrinkBuf(x.output,x.next_out)))}while((0<x.avail_in||x.avail_out===0)&&A!==1);return T===4?(A=s.deflateEnd(this.strm),this.onEnd(A),this.ended=!0,A===h):T!==2||(this.onEnd(h),!(x.avail_out=0))},p.prototype.onData=function(y){this.chunks.push(y)},p.prototype.onEnd=function(y){y===h&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=o.flattenChunks(this.chunks)),this.chunks=[],this.err=y,this.msg=this.strm.msg},i.Deflate=p,i.deflate=g,i.deflateRaw=function(y,_){return(_=_||{}).raw=!0,g(y,_)},i.gzip=function(y,_){return(_=_||{}).gzip=!0,g(y,_)}},{"./utils/common":41,"./utils/strings":42,"./zlib/deflate":46,"./zlib/messages":51,"./zlib/zstream":53}],40:[function(r,n,i){var s=r("./zlib/inflate"),o=r("./utils/common"),a=r("./utils/strings"),c=r("./zlib/constants"),l=r("./zlib/messages"),u=r("./zlib/zstream"),h=r("./zlib/gzheader"),f=Object.prototype.toString;function d(p){if(!(this instanceof d))return new d(p);this.options=o.assign({chunkSize:16384,windowBits:0,to:""},p||{});var g=this.options;g.raw&&0<=g.windowBits&&g.windowBits<16&&(g.windowBits=-g.windowBits,g.windowBits===0&&(g.windowBits=-15)),!(0<=g.windowBits&&g.windowBits<16)||p&&p.windowBits||(g.windowBits+=32),15<g.windowBits&&g.windowBits<48&&(15&g.windowBits)==0&&(g.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new u,this.strm.avail_out=0;var y=s.inflateInit2(this.strm,g.windowBits);if(y!==c.Z_OK)throw new Error(l[y]);this.header=new h,s.inflateGetHeader(this.strm,this.header)}function m(p,g){var y=new d(g);if(y.push(p,!0),y.err)throw y.msg||l[y.err];return y.result}d.prototype.push=function(p,g){var y,_,A,T,x,M,R=this.strm,P=this.options.chunkSize,W=this.options.dictionary,F=!1;if(this.ended)return!1;_=g===~~g?g:g===!0?c.Z_FINISH:c.Z_NO_FLUSH,typeof p=="string"?R.input=a.binstring2buf(p):f.call(p)==="[object ArrayBuffer]"?R.input=new Uint8Array(p):R.input=p,R.next_in=0,R.avail_in=R.input.length;do{if(R.avail_out===0&&(R.output=new o.Buf8(P),R.next_out=0,R.avail_out=P),(y=s.inflate(R,c.Z_NO_FLUSH))===c.Z_NEED_DICT&&W&&(M=typeof W=="string"?a.string2buf(W):f.call(W)==="[object ArrayBuffer]"?new Uint8Array(W):W,y=s.inflateSetDictionary(this.strm,M)),y===c.Z_BUF_ERROR&&F===!0&&(y=c.Z_OK,F=!1),y!==c.Z_STREAM_END&&y!==c.Z_OK)return this.onEnd(y),!(this.ended=!0);R.next_out&&(R.avail_out!==0&&y!==c.Z_STREAM_END&&(R.avail_in!==0||_!==c.Z_FINISH&&_!==c.Z_SYNC_FLUSH)||(this.options.to==="string"?(A=a.utf8border(R.output,R.next_out),T=R.next_out-A,x=a.buf2string(R.output,A),R.next_out=T,R.avail_out=P-T,T&&o.arraySet(R.output,R.output,A,T,0),this.onData(x)):this.onData(o.shrinkBuf(R.output,R.next_out)))),R.avail_in===0&&R.avail_out===0&&(F=!0)}while((0<R.avail_in||R.avail_out===0)&&y!==c.Z_STREAM_END);return y===c.Z_STREAM_END&&(_=c.Z_FINISH),_===c.Z_FINISH?(y=s.inflateEnd(this.strm),this.onEnd(y),this.ended=!0,y===c.Z_OK):_!==c.Z_SYNC_FLUSH||(this.onEnd(c.Z_OK),!(R.avail_out=0))},d.prototype.onData=function(p){this.chunks.push(p)},d.prototype.onEnd=function(p){p===c.Z_OK&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=o.flattenChunks(this.chunks)),this.chunks=[],this.err=p,this.msg=this.strm.msg},i.Inflate=d,i.inflate=m,i.inflateRaw=function(p,g){return(g=g||{}).raw=!0,m(p,g)},i.ungzip=m},{"./utils/common":41,"./utils/strings":42,"./zlib/constants":44,"./zlib/gzheader":47,"./zlib/inflate":49,"./zlib/messages":51,"./zlib/zstream":53}],41:[function(r,n,i){var s=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Int32Array<"u";i.assign=function(c){for(var l=Array.prototype.slice.call(arguments,1);l.length;){var u=l.shift();if(u){if(typeof u!="object")throw new TypeError(u+"must be non-object");for(var h in u)u.hasOwnProperty(h)&&(c[h]=u[h])}}return c},i.shrinkBuf=function(c,l){return c.length===l?c:c.subarray?c.subarray(0,l):(c.length=l,c)};var o={arraySet:function(c,l,u,h,f){if(l.subarray&&c.subarray)c.set(l.subarray(u,u+h),f);else for(var d=0;d<h;d++)c[f+d]=l[u+d]},flattenChunks:function(c){var l,u,h,f,d,m;for(l=h=0,u=c.length;l<u;l++)h+=c[l].length;for(m=new Uint8Array(h),l=f=0,u=c.length;l<u;l++)d=c[l],m.set(d,f),f+=d.length;return m}},a={arraySet:function(c,l,u,h,f){for(var d=0;d<h;d++)c[f+d]=l[u+d]},flattenChunks:function(c){return[].concat.apply([],c)}};i.setTyped=function(c){c?(i.Buf8=Uint8Array,i.Buf16=Uint16Array,i.Buf32=Int32Array,i.assign(i,o)):(i.Buf8=Array,i.Buf16=Array,i.Buf32=Array,i.assign(i,a))},i.setTyped(s)},{}],42:[function(r,n,i){var s=r("./common"),o=!0,a=!0;try{String.fromCharCode.apply(null,[0])}catch{o=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{a=!1}for(var c=new s.Buf8(256),l=0;l<256;l++)c[l]=252<=l?6:248<=l?5:240<=l?4:224<=l?3:192<=l?2:1;function u(h,f){if(f<65537&&(h.subarray&&a||!h.subarray&&o))return String.fromCharCode.apply(null,s.shrinkBuf(h,f));for(var d="",m=0;m<f;m++)d+=String.fromCharCode(h[m]);return d}c[254]=c[254]=1,i.string2buf=function(h){var f,d,m,p,g,y=h.length,_=0;for(p=0;p<y;p++)(64512&(d=h.charCodeAt(p)))==55296&&p+1<y&&(64512&(m=h.charCodeAt(p+1)))==56320&&(d=65536+(d-55296<<10)+(m-56320),p++),_+=d<128?1:d<2048?2:d<65536?3:4;for(f=new s.Buf8(_),p=g=0;g<_;p++)(64512&(d=h.charCodeAt(p)))==55296&&p+1<y&&(64512&(m=h.charCodeAt(p+1)))==56320&&(d=65536+(d-55296<<10)+(m-56320),p++),d<128?f[g++]=d:(d<2048?f[g++]=192|d>>>6:(d<65536?f[g++]=224|d>>>12:(f[g++]=240|d>>>18,f[g++]=128|d>>>12&63),f[g++]=128|d>>>6&63),f[g++]=128|63&d);return f},i.buf2binstring=function(h){return u(h,h.length)},i.binstring2buf=function(h){for(var f=new s.Buf8(h.length),d=0,m=f.length;d<m;d++)f[d]=h.charCodeAt(d);return f},i.buf2string=function(h,f){var d,m,p,g,y=f||h.length,_=new Array(2*y);for(d=m=0;d<y;)if((p=h[d++])<128)_[m++]=p;else if(4<(g=c[p]))_[m++]=65533,d+=g-1;else{for(p&=g===2?31:g===3?15:7;1<g&&d<y;)p=p<<6|63&h[d++],g--;1<g?_[m++]=65533:p<65536?_[m++]=p:(p-=65536,_[m++]=55296|p>>10&1023,_[m++]=56320|1023&p)}return u(_,m)},i.utf8border=function(h,f){var d;for((f=f||h.length)>h.length&&(f=h.length),d=f-1;0<=d&&(192&h[d])==128;)d--;return d<0||d===0?f:d+c[h[d]]>f?d:f}},{"./common":41}],43:[function(r,n,i){n.exports=function(s,o,a,c){for(var l=65535&s|0,u=s>>>16&65535|0,h=0;a!==0;){for(a-=h=2e3<a?2e3:a;u=u+(l=l+o[c++]|0)|0,--h;);l%=65521,u%=65521}return l|u<<16|0}},{}],44:[function(r,n,i){n.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],45:[function(r,n,i){var s=(function(){for(var o,a=[],c=0;c<256;c++){o=c;for(var l=0;l<8;l++)o=1&o?3988292384^o>>>1:o>>>1;a[c]=o}return a})();n.exports=function(o,a,c,l){var u=s,h=l+c;o^=-1;for(var f=l;f<h;f++)o=o>>>8^u[255&(o^a[f])];return-1^o}},{}],46:[function(r,n,i){var s,o=r("../utils/common"),a=r("./trees"),c=r("./adler32"),l=r("./crc32"),u=r("./messages"),h=0,f=4,d=0,m=-2,p=-1,g=4,y=2,_=8,A=9,T=286,x=30,M=19,R=2*T+1,P=15,W=3,F=258,G=F+W+1,O=42,I=113,k=1,C=2,z=3,B=4;function Q(S,he){return S.msg=u[he],he}function Y(S){return(S<<1)-(4<S?9:0)}function N(S){for(var he=S.length;0<=--he;)S[he]=0}function U(S){var he=S.state,ie=he.pending;ie>S.avail_out&&(ie=S.avail_out),ie!==0&&(o.arraySet(S.output,he.pending_buf,he.pending_out,ie,S.next_out),S.next_out+=ie,he.pending_out+=ie,S.total_out+=ie,S.avail_out-=ie,he.pending-=ie,he.pending===0&&(he.pending_out=0))}function $(S,he){a._tr_flush_block(S,0<=S.block_start?S.block_start:-1,S.strstart-S.block_start,he),S.block_start=S.strstart,U(S.strm)}function X(S,he){S.pending_buf[S.pending++]=he}function q(S,he){S.pending_buf[S.pending++]=he>>>8&255,S.pending_buf[S.pending++]=255&he}function J(S,he){var ie,K,j=S.max_chain_length,ee=S.strstart,pe=S.prev_length,me=S.nice_match,se=S.strstart>S.w_size-G?S.strstart-(S.w_size-G):0,_e=S.window,Oe=S.w_mask,be=S.prev,De=S.strstart+F,gt=_e[ee+pe-1],Ze=_e[ee+pe];S.prev_length>=S.good_match&&(j>>=2),me>S.lookahead&&(me=S.lookahead);do if(_e[(ie=he)+pe]===Ze&&_e[ie+pe-1]===gt&&_e[ie]===_e[ee]&&_e[++ie]===_e[ee+1]){ee+=2,ie++;do;while(_e[++ee]===_e[++ie]&&_e[++ee]===_e[++ie]&&_e[++ee]===_e[++ie]&&_e[++ee]===_e[++ie]&&_e[++ee]===_e[++ie]&&_e[++ee]===_e[++ie]&&_e[++ee]===_e[++ie]&&_e[++ee]===_e[++ie]&&ee<De);if(K=F-(De-ee),ee=De-F,pe<K){if(S.match_start=he,me<=(pe=K))break;gt=_e[ee+pe-1],Ze=_e[ee+pe]}}while((he=be[he&Oe])>se&&--j!=0);return pe<=S.lookahead?pe:S.lookahead}function de(S){var he,ie,K,j,ee,pe,me,se,_e,Oe,be=S.w_size;do{if(j=S.window_size-S.lookahead-S.strstart,S.strstart>=be+(be-G)){for(o.arraySet(S.window,S.window,be,be,0),S.match_start-=be,S.strstart-=be,S.block_start-=be,he=ie=S.hash_size;K=S.head[--he],S.head[he]=be<=K?K-be:0,--ie;);for(he=ie=be;K=S.prev[--he],S.prev[he]=be<=K?K-be:0,--ie;);j+=be}if(S.strm.avail_in===0)break;if(pe=S.strm,me=S.window,se=S.strstart+S.lookahead,_e=j,Oe=void 0,Oe=pe.avail_in,_e<Oe&&(Oe=_e),ie=Oe===0?0:(pe.avail_in-=Oe,o.arraySet(me,pe.input,pe.next_in,Oe,se),pe.state.wrap===1?pe.adler=c(pe.adler,me,Oe,se):pe.state.wrap===2&&(pe.adler=l(pe.adler,me,Oe,se)),pe.next_in+=Oe,pe.total_in+=Oe,Oe),S.lookahead+=ie,S.lookahead+S.insert>=W)for(ee=S.strstart-S.insert,S.ins_h=S.window[ee],S.ins_h=(S.ins_h<<S.hash_shift^S.window[ee+1])&S.hash_mask;S.insert&&(S.ins_h=(S.ins_h<<S.hash_shift^S.window[ee+W-1])&S.hash_mask,S.prev[ee&S.w_mask]=S.head[S.ins_h],S.head[S.ins_h]=ee,ee++,S.insert--,!(S.lookahead+S.insert<W)););}while(S.lookahead<G&&S.strm.avail_in!==0)}function Ee(S,he){for(var ie,K;;){if(S.lookahead<G){if(de(S),S.lookahead<G&&he===h)return k;if(S.lookahead===0)break}if(ie=0,S.lookahead>=W&&(S.ins_h=(S.ins_h<<S.hash_shift^S.window[S.strstart+W-1])&S.hash_mask,ie=S.prev[S.strstart&S.w_mask]=S.head[S.ins_h],S.head[S.ins_h]=S.strstart),ie!==0&&S.strstart-ie<=S.w_size-G&&(S.match_length=J(S,ie)),S.match_length>=W)if(K=a._tr_tally(S,S.strstart-S.match_start,S.match_length-W),S.lookahead-=S.match_length,S.match_length<=S.max_lazy_match&&S.lookahead>=W){for(S.match_length--;S.strstart++,S.ins_h=(S.ins_h<<S.hash_shift^S.window[S.strstart+W-1])&S.hash_mask,ie=S.prev[S.strstart&S.w_mask]=S.head[S.ins_h],S.head[S.ins_h]=S.strstart,--S.match_length!=0;);S.strstart++}else S.strstart+=S.match_length,S.match_length=0,S.ins_h=S.window[S.strstart],S.ins_h=(S.ins_h<<S.hash_shift^S.window[S.strstart+1])&S.hash_mask;else K=a._tr_tally(S,0,S.window[S.strstart]),S.lookahead--,S.strstart++;if(K&&($(S,!1),S.strm.avail_out===0))return k}return S.insert=S.strstart<W-1?S.strstart:W-1,he===f?($(S,!0),S.strm.avail_out===0?z:B):S.last_lit&&($(S,!1),S.strm.avail_out===0)?k:C}function ke(S,he){for(var ie,K,j;;){if(S.lookahead<G){if(de(S),S.lookahead<G&&he===h)return k;if(S.lookahead===0)break}if(ie=0,S.lookahead>=W&&(S.ins_h=(S.ins_h<<S.hash_shift^S.window[S.strstart+W-1])&S.hash_mask,ie=S.prev[S.strstart&S.w_mask]=S.head[S.ins_h],S.head[S.ins_h]=S.strstart),S.prev_length=S.match_length,S.prev_match=S.match_start,S.match_length=W-1,ie!==0&&S.prev_length<S.max_lazy_match&&S.strstart-ie<=S.w_size-G&&(S.match_length=J(S,ie),S.match_length<=5&&(S.strategy===1||S.match_length===W&&4096<S.strstart-S.match_start)&&(S.match_length=W-1)),S.prev_length>=W&&S.match_length<=S.prev_length){for(j=S.strstart+S.lookahead-W,K=a._tr_tally(S,S.strstart-1-S.prev_match,S.prev_length-W),S.lookahead-=S.prev_length-1,S.prev_length-=2;++S.strstart<=j&&(S.ins_h=(S.ins_h<<S.hash_shift^S.window[S.strstart+W-1])&S.hash_mask,ie=S.prev[S.strstart&S.w_mask]=S.head[S.ins_h],S.head[S.ins_h]=S.strstart),--S.prev_length!=0;);if(S.match_available=0,S.match_length=W-1,S.strstart++,K&&($(S,!1),S.strm.avail_out===0))return k}else if(S.match_available){if((K=a._tr_tally(S,0,S.window[S.strstart-1]))&&$(S,!1),S.strstart++,S.lookahead--,S.strm.avail_out===0)return k}else S.match_available=1,S.strstart++,S.lookahead--}return S.match_available&&(K=a._tr_tally(S,0,S.window[S.strstart-1]),S.match_available=0),S.insert=S.strstart<W-1?S.strstart:W-1,he===f?($(S,!0),S.strm.avail_out===0?z:B):S.last_lit&&($(S,!1),S.strm.avail_out===0)?k:C}function xe(S,he,ie,K,j){this.good_length=S,this.max_lazy=he,this.nice_length=ie,this.max_chain=K,this.func=j}function Te(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=_,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new o.Buf16(2*R),this.dyn_dtree=new o.Buf16(2*(2*x+1)),this.bl_tree=new o.Buf16(2*(2*M+1)),N(this.dyn_ltree),N(this.dyn_dtree),N(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new o.Buf16(P+1),this.heap=new o.Buf16(2*T+1),N(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new o.Buf16(2*T+1),N(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function Se(S){var he;return S&&S.state?(S.total_in=S.total_out=0,S.data_type=y,(he=S.state).pending=0,he.pending_out=0,he.wrap<0&&(he.wrap=-he.wrap),he.status=he.wrap?O:I,S.adler=he.wrap===2?0:1,he.last_flush=h,a._tr_init(he),d):Q(S,m)}function Me(S){var he=Se(S);return he===d&&(function(ie){ie.window_size=2*ie.w_size,N(ie.head),ie.max_lazy_match=s[ie.level].max_lazy,ie.good_match=s[ie.level].good_length,ie.nice_match=s[ie.level].nice_length,ie.max_chain_length=s[ie.level].max_chain,ie.strstart=0,ie.block_start=0,ie.lookahead=0,ie.insert=0,ie.match_length=ie.prev_length=W-1,ie.match_available=0,ie.ins_h=0})(S.state),he}function je(S,he,ie,K,j,ee){if(!S)return m;var pe=1;if(he===p&&(he=6),K<0?(pe=0,K=-K):15<K&&(pe=2,K-=16),j<1||A<j||ie!==_||K<8||15<K||he<0||9<he||ee<0||g<ee)return Q(S,m);K===8&&(K=9);var me=new Te;return(S.state=me).strm=S,me.wrap=pe,me.gzhead=null,me.w_bits=K,me.w_size=1<<me.w_bits,me.w_mask=me.w_size-1,me.hash_bits=j+7,me.hash_size=1<<me.hash_bits,me.hash_mask=me.hash_size-1,me.hash_shift=~~((me.hash_bits+W-1)/W),me.window=new o.Buf8(2*me.w_size),me.head=new o.Buf16(me.hash_size),me.prev=new o.Buf16(me.w_size),me.lit_bufsize=1<<j+6,me.pending_buf_size=4*me.lit_bufsize,me.pending_buf=new o.Buf8(me.pending_buf_size),me.d_buf=1*me.lit_bufsize,me.l_buf=3*me.lit_bufsize,me.level=he,me.strategy=ee,me.method=ie,Me(S)}s=[new xe(0,0,0,0,function(S,he){var ie=65535;for(ie>S.pending_buf_size-5&&(ie=S.pending_buf_size-5);;){if(S.lookahead<=1){if(de(S),S.lookahead===0&&he===h)return k;if(S.lookahead===0)break}S.strstart+=S.lookahead,S.lookahead=0;var K=S.block_start+ie;if((S.strstart===0||S.strstart>=K)&&(S.lookahead=S.strstart-K,S.strstart=K,$(S,!1),S.strm.avail_out===0)||S.strstart-S.block_start>=S.w_size-G&&($(S,!1),S.strm.avail_out===0))return k}return S.insert=0,he===f?($(S,!0),S.strm.avail_out===0?z:B):(S.strstart>S.block_start&&($(S,!1),S.strm.avail_out),k)}),new xe(4,4,8,4,Ee),new xe(4,5,16,8,Ee),new xe(4,6,32,32,Ee),new xe(4,4,16,16,ke),new xe(8,16,32,32,ke),new xe(8,16,128,128,ke),new xe(8,32,128,256,ke),new xe(32,128,258,1024,ke),new xe(32,258,258,4096,ke)],i.deflateInit=function(S,he){return je(S,he,_,15,8,0)},i.deflateInit2=je,i.deflateReset=Me,i.deflateResetKeep=Se,i.deflateSetHeader=function(S,he){return S&&S.state?S.state.wrap!==2?m:(S.state.gzhead=he,d):m},i.deflate=function(S,he){var ie,K,j,ee;if(!S||!S.state||5<he||he<0)return S?Q(S,m):m;if(K=S.state,!S.output||!S.input&&S.avail_in!==0||K.status===666&&he!==f)return Q(S,S.avail_out===0?-5:m);if(K.strm=S,ie=K.last_flush,K.last_flush=he,K.status===O)if(K.wrap===2)S.adler=0,X(K,31),X(K,139),X(K,8),K.gzhead?(X(K,(K.gzhead.text?1:0)+(K.gzhead.hcrc?2:0)+(K.gzhead.extra?4:0)+(K.gzhead.name?8:0)+(K.gzhead.comment?16:0)),X(K,255&K.gzhead.time),X(K,K.gzhead.time>>8&255),X(K,K.gzhead.time>>16&255),X(K,K.gzhead.time>>24&255),X(K,K.level===9?2:2<=K.strategy||K.level<2?4:0),X(K,255&K.gzhead.os),K.gzhead.extra&&K.gzhead.extra.length&&(X(K,255&K.gzhead.extra.length),X(K,K.gzhead.extra.length>>8&255)),K.gzhead.hcrc&&(S.adler=l(S.adler,K.pending_buf,K.pending,0)),K.gzindex=0,K.status=69):(X(K,0),X(K,0),X(K,0),X(K,0),X(K,0),X(K,K.level===9?2:2<=K.strategy||K.level<2?4:0),X(K,3),K.status=I);else{var pe=_+(K.w_bits-8<<4)<<8;pe|=(2<=K.strategy||K.level<2?0:K.level<6?1:K.level===6?2:3)<<6,K.strstart!==0&&(pe|=32),pe+=31-pe%31,K.status=I,q(K,pe),K.strstart!==0&&(q(K,S.adler>>>16),q(K,65535&S.adler)),S.adler=1}if(K.status===69)if(K.gzhead.extra){for(j=K.pending;K.gzindex<(65535&K.gzhead.extra.length)&&(K.pending!==K.pending_buf_size||(K.gzhead.hcrc&&K.pending>j&&(S.adler=l(S.adler,K.pending_buf,K.pending-j,j)),U(S),j=K.pending,K.pending!==K.pending_buf_size));)X(K,255&K.gzhead.extra[K.gzindex]),K.gzindex++;K.gzhead.hcrc&&K.pending>j&&(S.adler=l(S.adler,K.pending_buf,K.pending-j,j)),K.gzindex===K.gzhead.extra.length&&(K.gzindex=0,K.status=73)}else K.status=73;if(K.status===73)if(K.gzhead.name){j=K.pending;do{if(K.pending===K.pending_buf_size&&(K.gzhead.hcrc&&K.pending>j&&(S.adler=l(S.adler,K.pending_buf,K.pending-j,j)),U(S),j=K.pending,K.pending===K.pending_buf_size)){ee=1;break}ee=K.gzindex<K.gzhead.name.length?255&K.gzhead.name.charCodeAt(K.gzindex++):0,X(K,ee)}while(ee!==0);K.gzhead.hcrc&&K.pending>j&&(S.adler=l(S.adler,K.pending_buf,K.pending-j,j)),ee===0&&(K.gzindex=0,K.status=91)}else K.status=91;if(K.status===91)if(K.gzhead.comment){j=K.pending;do{if(K.pending===K.pending_buf_size&&(K.gzhead.hcrc&&K.pending>j&&(S.adler=l(S.adler,K.pending_buf,K.pending-j,j)),U(S),j=K.pending,K.pending===K.pending_buf_size)){ee=1;break}ee=K.gzindex<K.gzhead.comment.length?255&K.gzhead.comment.charCodeAt(K.gzindex++):0,X(K,ee)}while(ee!==0);K.gzhead.hcrc&&K.pending>j&&(S.adler=l(S.adler,K.pending_buf,K.pending-j,j)),ee===0&&(K.status=103)}else K.status=103;if(K.status===103&&(K.gzhead.hcrc?(K.pending+2>K.pending_buf_size&&U(S),K.pending+2<=K.pending_buf_size&&(X(K,255&S.adler),X(K,S.adler>>8&255),S.adler=0,K.status=I)):K.status=I),K.pending!==0){if(U(S),S.avail_out===0)return K.last_flush=-1,d}else if(S.avail_in===0&&Y(he)<=Y(ie)&&he!==f)return Q(S,-5);if(K.status===666&&S.avail_in!==0)return Q(S,-5);if(S.avail_in!==0||K.lookahead!==0||he!==h&&K.status!==666){var me=K.strategy===2?(function(se,_e){for(var Oe;;){if(se.lookahead===0&&(de(se),se.lookahead===0)){if(_e===h)return k;break}if(se.match_length=0,Oe=a._tr_tally(se,0,se.window[se.strstart]),se.lookahead--,se.strstart++,Oe&&($(se,!1),se.strm.avail_out===0))return k}return se.insert=0,_e===f?($(se,!0),se.strm.avail_out===0?z:B):se.last_lit&&($(se,!1),se.strm.avail_out===0)?k:C})(K,he):K.strategy===3?(function(se,_e){for(var Oe,be,De,gt,Ze=se.window;;){if(se.lookahead<=F){if(de(se),se.lookahead<=F&&_e===h)return k;if(se.lookahead===0)break}if(se.match_length=0,se.lookahead>=W&&0<se.strstart&&(be=Ze[De=se.strstart-1])===Ze[++De]&&be===Ze[++De]&&be===Ze[++De]){gt=se.strstart+F;do;while(be===Ze[++De]&&be===Ze[++De]&&be===Ze[++De]&&be===Ze[++De]&&be===Ze[++De]&&be===Ze[++De]&&be===Ze[++De]&&be===Ze[++De]&&De<gt);se.match_length=F-(gt-De),se.match_length>se.lookahead&&(se.match_length=se.lookahead)}if(se.match_length>=W?(Oe=a._tr_tally(se,1,se.match_length-W),se.lookahead-=se.match_length,se.strstart+=se.match_length,se.match_length=0):(Oe=a._tr_tally(se,0,se.window[se.strstart]),se.lookahead--,se.strstart++),Oe&&($(se,!1),se.strm.avail_out===0))return k}return se.insert=0,_e===f?($(se,!0),se.strm.avail_out===0?z:B):se.last_lit&&($(se,!1),se.strm.avail_out===0)?k:C})(K,he):s[K.level].func(K,he);if(me!==z&&me!==B||(K.status=666),me===k||me===z)return S.avail_out===0&&(K.last_flush=-1),d;if(me===C&&(he===1?a._tr_align(K):he!==5&&(a._tr_stored_block(K,0,0,!1),he===3&&(N(K.head),K.lookahead===0&&(K.strstart=0,K.block_start=0,K.insert=0))),U(S),S.avail_out===0))return K.last_flush=-1,d}return he!==f?d:K.wrap<=0?1:(K.wrap===2?(X(K,255&S.adler),X(K,S.adler>>8&255),X(K,S.adler>>16&255),X(K,S.adler>>24&255),X(K,255&S.total_in),X(K,S.total_in>>8&255),X(K,S.total_in>>16&255),X(K,S.total_in>>24&255)):(q(K,S.adler>>>16),q(K,65535&S.adler)),U(S),0<K.wrap&&(K.wrap=-K.wrap),K.pending!==0?d:1)},i.deflateEnd=function(S){var he;return S&&S.state?(he=S.state.status)!==O&&he!==69&&he!==73&&he!==91&&he!==103&&he!==I&&he!==666?Q(S,m):(S.state=null,he===I?Q(S,-3):d):m},i.deflateSetDictionary=function(S,he){var ie,K,j,ee,pe,me,se,_e,Oe=he.length;if(!S||!S.state||(ee=(ie=S.state).wrap)===2||ee===1&&ie.status!==O||ie.lookahead)return m;for(ee===1&&(S.adler=c(S.adler,he,Oe,0)),ie.wrap=0,Oe>=ie.w_size&&(ee===0&&(N(ie.head),ie.strstart=0,ie.block_start=0,ie.insert=0),_e=new o.Buf8(ie.w_size),o.arraySet(_e,he,Oe-ie.w_size,ie.w_size,0),he=_e,Oe=ie.w_size),pe=S.avail_in,me=S.next_in,se=S.input,S.avail_in=Oe,S.next_in=0,S.input=he,de(ie);ie.lookahead>=W;){for(K=ie.strstart,j=ie.lookahead-(W-1);ie.ins_h=(ie.ins_h<<ie.hash_shift^ie.window[K+W-1])&ie.hash_mask,ie.prev[K&ie.w_mask]=ie.head[ie.ins_h],ie.head[ie.ins_h]=K,K++,--j;);ie.strstart=K,ie.lookahead=W-1,de(ie)}return ie.strstart+=ie.lookahead,ie.block_start=ie.strstart,ie.insert=ie.lookahead,ie.lookahead=0,ie.match_length=ie.prev_length=W-1,ie.match_available=0,S.next_in=me,S.input=se,S.avail_in=pe,ie.wrap=ee,d},i.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./messages":51,"./trees":52}],47:[function(r,n,i){n.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},{}],48:[function(r,n,i){n.exports=function(s,o){var a,c,l,u,h,f,d,m,p,g,y,_,A,T,x,M,R,P,W,F,G,O,I,k,C;a=s.state,c=s.next_in,k=s.input,l=c+(s.avail_in-5),u=s.next_out,C=s.output,h=u-(o-s.avail_out),f=u+(s.avail_out-257),d=a.dmax,m=a.wsize,p=a.whave,g=a.wnext,y=a.window,_=a.hold,A=a.bits,T=a.lencode,x=a.distcode,M=(1<<a.lenbits)-1,R=(1<<a.distbits)-1;e:do{A<15&&(_+=k[c++]<<A,A+=8,_+=k[c++]<<A,A+=8),P=T[_&M];t:for(;;){if(_>>>=W=P>>>24,A-=W,(W=P>>>16&255)===0)C[u++]=65535&P;else{if(!(16&W)){if((64&W)==0){P=T[(65535&P)+(_&(1<<W)-1)];continue t}if(32&W){a.mode=12;break e}s.msg="invalid literal/length code",a.mode=30;break e}F=65535&P,(W&=15)&&(A<W&&(_+=k[c++]<<A,A+=8),F+=_&(1<<W)-1,_>>>=W,A-=W),A<15&&(_+=k[c++]<<A,A+=8,_+=k[c++]<<A,A+=8),P=x[_&R];r:for(;;){if(_>>>=W=P>>>24,A-=W,!(16&(W=P>>>16&255))){if((64&W)==0){P=x[(65535&P)+(_&(1<<W)-1)];continue r}s.msg="invalid distance code",a.mode=30;break e}if(G=65535&P,A<(W&=15)&&(_+=k[c++]<<A,(A+=8)<W&&(_+=k[c++]<<A,A+=8)),d<(G+=_&(1<<W)-1)){s.msg="invalid distance too far back",a.mode=30;break e}if(_>>>=W,A-=W,(W=u-h)<G){if(p<(W=G-W)&&a.sane){s.msg="invalid distance too far back",a.mode=30;break e}if(I=y,(O=0)===g){if(O+=m-W,W<F){for(F-=W;C[u++]=y[O++],--W;);O=u-G,I=C}}else if(g<W){if(O+=m+g-W,(W-=g)<F){for(F-=W;C[u++]=y[O++],--W;);if(O=0,g<F){for(F-=W=g;C[u++]=y[O++],--W;);O=u-G,I=C}}}else if(O+=g-W,W<F){for(F-=W;C[u++]=y[O++],--W;);O=u-G,I=C}for(;2<F;)C[u++]=I[O++],C[u++]=I[O++],C[u++]=I[O++],F-=3;F&&(C[u++]=I[O++],1<F&&(C[u++]=I[O++]))}else{for(O=u-G;C[u++]=C[O++],C[u++]=C[O++],C[u++]=C[O++],2<(F-=3););F&&(C[u++]=C[O++],1<F&&(C[u++]=C[O++]))}break}}break}}while(c<l&&u<f);c-=F=A>>3,_&=(1<<(A-=F<<3))-1,s.next_in=c,s.next_out=u,s.avail_in=c<l?l-c+5:5-(c-l),s.avail_out=u<f?f-u+257:257-(u-f),a.hold=_,a.bits=A}},{}],49:[function(r,n,i){var s=r("../utils/common"),o=r("./adler32"),a=r("./crc32"),c=r("./inffast"),l=r("./inftrees"),u=1,h=2,f=0,d=-2,m=1,p=852,g=592;function y(O){return(O>>>24&255)+(O>>>8&65280)+((65280&O)<<8)+((255&O)<<24)}function _(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new s.Buf16(320),this.work=new s.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function A(O){var I;return O&&O.state?(I=O.state,O.total_in=O.total_out=I.total=0,O.msg="",I.wrap&&(O.adler=1&I.wrap),I.mode=m,I.last=0,I.havedict=0,I.dmax=32768,I.head=null,I.hold=0,I.bits=0,I.lencode=I.lendyn=new s.Buf32(p),I.distcode=I.distdyn=new s.Buf32(g),I.sane=1,I.back=-1,f):d}function T(O){var I;return O&&O.state?((I=O.state).wsize=0,I.whave=0,I.wnext=0,A(O)):d}function x(O,I){var k,C;return O&&O.state?(C=O.state,I<0?(k=0,I=-I):(k=1+(I>>4),I<48&&(I&=15)),I&&(I<8||15<I)?d:(C.window!==null&&C.wbits!==I&&(C.window=null),C.wrap=k,C.wbits=I,T(O))):d}function M(O,I){var k,C;return O?(C=new _,(O.state=C).window=null,(k=x(O,I))!==f&&(O.state=null),k):d}var R,P,W=!0;function F(O){if(W){var I;for(R=new s.Buf32(512),P=new s.Buf32(32),I=0;I<144;)O.lens[I++]=8;for(;I<256;)O.lens[I++]=9;for(;I<280;)O.lens[I++]=7;for(;I<288;)O.lens[I++]=8;for(l(u,O.lens,0,288,R,0,O.work,{bits:9}),I=0;I<32;)O.lens[I++]=5;l(h,O.lens,0,32,P,0,O.work,{bits:5}),W=!1}O.lencode=R,O.lenbits=9,O.distcode=P,O.distbits=5}function G(O,I,k,C){var z,B=O.state;return B.window===null&&(B.wsize=1<<B.wbits,B.wnext=0,B.whave=0,B.window=new s.Buf8(B.wsize)),C>=B.wsize?(s.arraySet(B.window,I,k-B.wsize,B.wsize,0),B.wnext=0,B.whave=B.wsize):(C<(z=B.wsize-B.wnext)&&(z=C),s.arraySet(B.window,I,k-C,z,B.wnext),(C-=z)?(s.arraySet(B.window,I,k-C,C,0),B.wnext=C,B.whave=B.wsize):(B.wnext+=z,B.wnext===B.wsize&&(B.wnext=0),B.whave<B.wsize&&(B.whave+=z))),0}i.inflateReset=T,i.inflateReset2=x,i.inflateResetKeep=A,i.inflateInit=function(O){return M(O,15)},i.inflateInit2=M,i.inflate=function(O,I){var k,C,z,B,Q,Y,N,U,$,X,q,J,de,Ee,ke,xe,Te,Se,Me,je,S,he,ie,K,j=0,ee=new s.Buf8(4),pe=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!O||!O.state||!O.output||!O.input&&O.avail_in!==0)return d;(k=O.state).mode===12&&(k.mode=13),Q=O.next_out,z=O.output,N=O.avail_out,B=O.next_in,C=O.input,Y=O.avail_in,U=k.hold,$=k.bits,X=Y,q=N,he=f;e:for(;;)switch(k.mode){case m:if(k.wrap===0){k.mode=13;break}for(;$<16;){if(Y===0)break e;Y--,U+=C[B++]<<$,$+=8}if(2&k.wrap&&U===35615){ee[k.check=0]=255&U,ee[1]=U>>>8&255,k.check=a(k.check,ee,2,0),$=U=0,k.mode=2;break}if(k.flags=0,k.head&&(k.head.done=!1),!(1&k.wrap)||(((255&U)<<8)+(U>>8))%31){O.msg="incorrect header check",k.mode=30;break}if((15&U)!=8){O.msg="unknown compression method",k.mode=30;break}if($-=4,S=8+(15&(U>>>=4)),k.wbits===0)k.wbits=S;else if(S>k.wbits){O.msg="invalid window size",k.mode=30;break}k.dmax=1<<S,O.adler=k.check=1,k.mode=512&U?10:12,$=U=0;break;case 2:for(;$<16;){if(Y===0)break e;Y--,U+=C[B++]<<$,$+=8}if(k.flags=U,(255&k.flags)!=8){O.msg="unknown compression method",k.mode=30;break}if(57344&k.flags){O.msg="unknown header flags set",k.mode=30;break}k.head&&(k.head.text=U>>8&1),512&k.flags&&(ee[0]=255&U,ee[1]=U>>>8&255,k.check=a(k.check,ee,2,0)),$=U=0,k.mode=3;case 3:for(;$<32;){if(Y===0)break e;Y--,U+=C[B++]<<$,$+=8}k.head&&(k.head.time=U),512&k.flags&&(ee[0]=255&U,ee[1]=U>>>8&255,ee[2]=U>>>16&255,ee[3]=U>>>24&255,k.check=a(k.check,ee,4,0)),$=U=0,k.mode=4;case 4:for(;$<16;){if(Y===0)break e;Y--,U+=C[B++]<<$,$+=8}k.head&&(k.head.xflags=255&U,k.head.os=U>>8),512&k.flags&&(ee[0]=255&U,ee[1]=U>>>8&255,k.check=a(k.check,ee,2,0)),$=U=0,k.mode=5;case 5:if(1024&k.flags){for(;$<16;){if(Y===0)break e;Y--,U+=C[B++]<<$,$+=8}k.length=U,k.head&&(k.head.extra_len=U),512&k.flags&&(ee[0]=255&U,ee[1]=U>>>8&255,k.check=a(k.check,ee,2,0)),$=U=0}else k.head&&(k.head.extra=null);k.mode=6;case 6:if(1024&k.flags&&(Y<(J=k.length)&&(J=Y),J&&(k.head&&(S=k.head.extra_len-k.length,k.head.extra||(k.head.extra=new Array(k.head.extra_len)),s.arraySet(k.head.extra,C,B,J,S)),512&k.flags&&(k.check=a(k.check,C,J,B)),Y-=J,B+=J,k.length-=J),k.length))break e;k.length=0,k.mode=7;case 7:if(2048&k.flags){if(Y===0)break e;for(J=0;S=C[B+J++],k.head&&S&&k.length<65536&&(k.head.name+=String.fromCharCode(S)),S&&J<Y;);if(512&k.flags&&(k.check=a(k.check,C,J,B)),Y-=J,B+=J,S)break e}else k.head&&(k.head.name=null);k.length=0,k.mode=8;case 8:if(4096&k.flags){if(Y===0)break e;for(J=0;S=C[B+J++],k.head&&S&&k.length<65536&&(k.head.comment+=String.fromCharCode(S)),S&&J<Y;);if(512&k.flags&&(k.check=a(k.check,C,J,B)),Y-=J,B+=J,S)break e}else k.head&&(k.head.comment=null);k.mode=9;case 9:if(512&k.flags){for(;$<16;){if(Y===0)break e;Y--,U+=C[B++]<<$,$+=8}if(U!==(65535&k.check)){O.msg="header crc mismatch",k.mode=30;break}$=U=0}k.head&&(k.head.hcrc=k.flags>>9&1,k.head.done=!0),O.adler=k.check=0,k.mode=12;break;case 10:for(;$<32;){if(Y===0)break e;Y--,U+=C[B++]<<$,$+=8}O.adler=k.check=y(U),$=U=0,k.mode=11;case 11:if(k.havedict===0)return O.next_out=Q,O.avail_out=N,O.next_in=B,O.avail_in=Y,k.hold=U,k.bits=$,2;O.adler=k.check=1,k.mode=12;case 12:if(I===5||I===6)break e;case 13:if(k.last){U>>>=7&$,$-=7&$,k.mode=27;break}for(;$<3;){if(Y===0)break e;Y--,U+=C[B++]<<$,$+=8}switch(k.last=1&U,$-=1,3&(U>>>=1)){case 0:k.mode=14;break;case 1:if(F(k),k.mode=20,I!==6)break;U>>>=2,$-=2;break e;case 2:k.mode=17;break;case 3:O.msg="invalid block type",k.mode=30}U>>>=2,$-=2;break;case 14:for(U>>>=7&$,$-=7&$;$<32;){if(Y===0)break e;Y--,U+=C[B++]<<$,$+=8}if((65535&U)!=(U>>>16^65535)){O.msg="invalid stored block lengths",k.mode=30;break}if(k.length=65535&U,$=U=0,k.mode=15,I===6)break e;case 15:k.mode=16;case 16:if(J=k.length){if(Y<J&&(J=Y),N<J&&(J=N),J===0)break e;s.arraySet(z,C,B,J,Q),Y-=J,B+=J,N-=J,Q+=J,k.length-=J;break}k.mode=12;break;case 17:for(;$<14;){if(Y===0)break e;Y--,U+=C[B++]<<$,$+=8}if(k.nlen=257+(31&U),U>>>=5,$-=5,k.ndist=1+(31&U),U>>>=5,$-=5,k.ncode=4+(15&U),U>>>=4,$-=4,286<k.nlen||30<k.ndist){O.msg="too many length or distance symbols",k.mode=30;break}k.have=0,k.mode=18;case 18:for(;k.have<k.ncode;){for(;$<3;){if(Y===0)break e;Y--,U+=C[B++]<<$,$+=8}k.lens[pe[k.have++]]=7&U,U>>>=3,$-=3}for(;k.have<19;)k.lens[pe[k.have++]]=0;if(k.lencode=k.lendyn,k.lenbits=7,ie={bits:k.lenbits},he=l(0,k.lens,0,19,k.lencode,0,k.work,ie),k.lenbits=ie.bits,he){O.msg="invalid code lengths set",k.mode=30;break}k.have=0,k.mode=19;case 19:for(;k.have<k.nlen+k.ndist;){for(;xe=(j=k.lencode[U&(1<<k.lenbits)-1])>>>16&255,Te=65535&j,!((ke=j>>>24)<=$);){if(Y===0)break e;Y--,U+=C[B++]<<$,$+=8}if(Te<16)U>>>=ke,$-=ke,k.lens[k.have++]=Te;else{if(Te===16){for(K=ke+2;$<K;){if(Y===0)break e;Y--,U+=C[B++]<<$,$+=8}if(U>>>=ke,$-=ke,k.have===0){O.msg="invalid bit length repeat",k.mode=30;break}S=k.lens[k.have-1],J=3+(3&U),U>>>=2,$-=2}else if(Te===17){for(K=ke+3;$<K;){if(Y===0)break e;Y--,U+=C[B++]<<$,$+=8}$-=ke,S=0,J=3+(7&(U>>>=ke)),U>>>=3,$-=3}else{for(K=ke+7;$<K;){if(Y===0)break e;Y--,U+=C[B++]<<$,$+=8}$-=ke,S=0,J=11+(127&(U>>>=ke)),U>>>=7,$-=7}if(k.have+J>k.nlen+k.ndist){O.msg="invalid bit length repeat",k.mode=30;break}for(;J--;)k.lens[k.have++]=S}}if(k.mode===30)break;if(k.lens[256]===0){O.msg="invalid code -- missing end-of-block",k.mode=30;break}if(k.lenbits=9,ie={bits:k.lenbits},he=l(u,k.lens,0,k.nlen,k.lencode,0,k.work,ie),k.lenbits=ie.bits,he){O.msg="invalid literal/lengths set",k.mode=30;break}if(k.distbits=6,k.distcode=k.distdyn,ie={bits:k.distbits},he=l(h,k.lens,k.nlen,k.ndist,k.distcode,0,k.work,ie),k.distbits=ie.bits,he){O.msg="invalid distances set",k.mode=30;break}if(k.mode=20,I===6)break e;case 20:k.mode=21;case 21:if(6<=Y&&258<=N){O.next_out=Q,O.avail_out=N,O.next_in=B,O.avail_in=Y,k.hold=U,k.bits=$,c(O,q),Q=O.next_out,z=O.output,N=O.avail_out,B=O.next_in,C=O.input,Y=O.avail_in,U=k.hold,$=k.bits,k.mode===12&&(k.back=-1);break}for(k.back=0;xe=(j=k.lencode[U&(1<<k.lenbits)-1])>>>16&255,Te=65535&j,!((ke=j>>>24)<=$);){if(Y===0)break e;Y--,U+=C[B++]<<$,$+=8}if(xe&&(240&xe)==0){for(Se=ke,Me=xe,je=Te;xe=(j=k.lencode[je+((U&(1<<Se+Me)-1)>>Se)])>>>16&255,Te=65535&j,!(Se+(ke=j>>>24)<=$);){if(Y===0)break e;Y--,U+=C[B++]<<$,$+=8}U>>>=Se,$-=Se,k.back+=Se}if(U>>>=ke,$-=ke,k.back+=ke,k.length=Te,xe===0){k.mode=26;break}if(32&xe){k.back=-1,k.mode=12;break}if(64&xe){O.msg="invalid literal/length code",k.mode=30;break}k.extra=15&xe,k.mode=22;case 22:if(k.extra){for(K=k.extra;$<K;){if(Y===0)break e;Y--,U+=C[B++]<<$,$+=8}k.length+=U&(1<<k.extra)-1,U>>>=k.extra,$-=k.extra,k.back+=k.extra}k.was=k.length,k.mode=23;case 23:for(;xe=(j=k.distcode[U&(1<<k.distbits)-1])>>>16&255,Te=65535&j,!((ke=j>>>24)<=$);){if(Y===0)break e;Y--,U+=C[B++]<<$,$+=8}if((240&xe)==0){for(Se=ke,Me=xe,je=Te;xe=(j=k.distcode[je+((U&(1<<Se+Me)-1)>>Se)])>>>16&255,Te=65535&j,!(Se+(ke=j>>>24)<=$);){if(Y===0)break e;Y--,U+=C[B++]<<$,$+=8}U>>>=Se,$-=Se,k.back+=Se}if(U>>>=ke,$-=ke,k.back+=ke,64&xe){O.msg="invalid distance code",k.mode=30;break}k.offset=Te,k.extra=15&xe,k.mode=24;case 24:if(k.extra){for(K=k.extra;$<K;){if(Y===0)break e;Y--,U+=C[B++]<<$,$+=8}k.offset+=U&(1<<k.extra)-1,U>>>=k.extra,$-=k.extra,k.back+=k.extra}if(k.offset>k.dmax){O.msg="invalid distance too far back",k.mode=30;break}k.mode=25;case 25:if(N===0)break e;if(J=q-N,k.offset>J){if((J=k.offset-J)>k.whave&&k.sane){O.msg="invalid distance too far back",k.mode=30;break}de=J>k.wnext?(J-=k.wnext,k.wsize-J):k.wnext-J,J>k.length&&(J=k.length),Ee=k.window}else Ee=z,de=Q-k.offset,J=k.length;for(N<J&&(J=N),N-=J,k.length-=J;z[Q++]=Ee[de++],--J;);k.length===0&&(k.mode=21);break;case 26:if(N===0)break e;z[Q++]=k.length,N--,k.mode=21;break;case 27:if(k.wrap){for(;$<32;){if(Y===0)break e;Y--,U|=C[B++]<<$,$+=8}if(q-=N,O.total_out+=q,k.total+=q,q&&(O.adler=k.check=k.flags?a(k.check,z,q,Q-q):o(k.check,z,q,Q-q)),q=N,(k.flags?U:y(U))!==k.check){O.msg="incorrect data check",k.mode=30;break}$=U=0}k.mode=28;case 28:if(k.wrap&&k.flags){for(;$<32;){if(Y===0)break e;Y--,U+=C[B++]<<$,$+=8}if(U!==(4294967295&k.total)){O.msg="incorrect length check",k.mode=30;break}$=U=0}k.mode=29;case 29:he=1;break e;case 30:he=-3;break e;case 31:return-4;case 32:default:return d}return O.next_out=Q,O.avail_out=N,O.next_in=B,O.avail_in=Y,k.hold=U,k.bits=$,(k.wsize||q!==O.avail_out&&k.mode<30&&(k.mode<27||I!==4))&&G(O,O.output,O.next_out,q-O.avail_out)?(k.mode=31,-4):(X-=O.avail_in,q-=O.avail_out,O.total_in+=X,O.total_out+=q,k.total+=q,k.wrap&&q&&(O.adler=k.check=k.flags?a(k.check,z,q,O.next_out-q):o(k.check,z,q,O.next_out-q)),O.data_type=k.bits+(k.last?64:0)+(k.mode===12?128:0)+(k.mode===20||k.mode===15?256:0),(X==0&&q===0||I===4)&&he===f&&(he=-5),he)},i.inflateEnd=function(O){if(!O||!O.state)return d;var I=O.state;return I.window&&(I.window=null),O.state=null,f},i.inflateGetHeader=function(O,I){var k;return O&&O.state?(2&(k=O.state).wrap)==0?d:((k.head=I).done=!1,f):d},i.inflateSetDictionary=function(O,I){var k,C=I.length;return O&&O.state?(k=O.state).wrap!==0&&k.mode!==11?d:k.mode===11&&o(1,I,C,0)!==k.check?-3:G(O,I,C,C)?(k.mode=31,-4):(k.havedict=1,f):d},i.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./inffast":48,"./inftrees":50}],50:[function(r,n,i){var s=r("../utils/common"),o=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],a=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],c=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],l=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];n.exports=function(u,h,f,d,m,p,g,y){var _,A,T,x,M,R,P,W,F,G=y.bits,O=0,I=0,k=0,C=0,z=0,B=0,Q=0,Y=0,N=0,U=0,$=null,X=0,q=new s.Buf16(16),J=new s.Buf16(16),de=null,Ee=0;for(O=0;O<=15;O++)q[O]=0;for(I=0;I<d;I++)q[h[f+I]]++;for(z=G,C=15;1<=C&&q[C]===0;C--);if(C<z&&(z=C),C===0)return m[p++]=20971520,m[p++]=20971520,y.bits=1,0;for(k=1;k<C&&q[k]===0;k++);for(z<k&&(z=k),O=Y=1;O<=15;O++)if(Y<<=1,(Y-=q[O])<0)return-1;if(0<Y&&(u===0||C!==1))return-1;for(J[1]=0,O=1;O<15;O++)J[O+1]=J[O]+q[O];for(I=0;I<d;I++)h[f+I]!==0&&(g[J[h[f+I]]++]=I);if(R=u===0?($=de=g,19):u===1?($=o,X-=257,de=a,Ee-=257,256):($=c,de=l,-1),O=k,M=p,Q=I=U=0,T=-1,x=(N=1<<(B=z))-1,u===1&&852<N||u===2&&592<N)return 1;for(;;){for(P=O-Q,F=g[I]<R?(W=0,g[I]):g[I]>R?(W=de[Ee+g[I]],$[X+g[I]]):(W=96,0),_=1<<O-Q,k=A=1<<B;m[M+(U>>Q)+(A-=_)]=P<<24|W<<16|F|0,A!==0;);for(_=1<<O-1;U&_;)_>>=1;if(_!==0?(U&=_-1,U+=_):U=0,I++,--q[O]==0){if(O===C)break;O=h[f+g[I]]}if(z<O&&(U&x)!==T){for(Q===0&&(Q=z),M+=k,Y=1<<(B=O-Q);B+Q<C&&!((Y-=q[B+Q])<=0);)B++,Y<<=1;if(N+=1<<B,u===1&&852<N||u===2&&592<N)return 1;m[T=U&x]=z<<24|B<<16|M-p|0}}return U!==0&&(m[M+U]=O-Q<<24|64<<16|0),y.bits=z,0}},{"../utils/common":41}],51:[function(r,n,i){n.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],52:[function(r,n,i){var s=r("../utils/common"),o=0,a=1;function c(j){for(var ee=j.length;0<=--ee;)j[ee]=0}var l=0,u=29,h=256,f=h+1+u,d=30,m=19,p=2*f+1,g=15,y=16,_=7,A=256,T=16,x=17,M=18,R=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],P=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],W=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],F=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],G=new Array(2*(f+2));c(G);var O=new Array(2*d);c(O);var I=new Array(512);c(I);var k=new Array(256);c(k);var C=new Array(u);c(C);var z,B,Q,Y=new Array(d);function N(j,ee,pe,me,se){this.static_tree=j,this.extra_bits=ee,this.extra_base=pe,this.elems=me,this.max_length=se,this.has_stree=j&&j.length}function U(j,ee){this.dyn_tree=j,this.max_code=0,this.stat_desc=ee}function $(j){return j<256?I[j]:I[256+(j>>>7)]}function X(j,ee){j.pending_buf[j.pending++]=255&ee,j.pending_buf[j.pending++]=ee>>>8&255}function q(j,ee,pe){j.bi_valid>y-pe?(j.bi_buf|=ee<<j.bi_valid&65535,X(j,j.bi_buf),j.bi_buf=ee>>y-j.bi_valid,j.bi_valid+=pe-y):(j.bi_buf|=ee<<j.bi_valid&65535,j.bi_valid+=pe)}function J(j,ee,pe){q(j,pe[2*ee],pe[2*ee+1])}function de(j,ee){for(var pe=0;pe|=1&j,j>>>=1,pe<<=1,0<--ee;);return pe>>>1}function Ee(j,ee,pe){var me,se,_e=new Array(g+1),Oe=0;for(me=1;me<=g;me++)_e[me]=Oe=Oe+pe[me-1]<<1;for(se=0;se<=ee;se++){var be=j[2*se+1];be!==0&&(j[2*se]=de(_e[be]++,be))}}function ke(j){var ee;for(ee=0;ee<f;ee++)j.dyn_ltree[2*ee]=0;for(ee=0;ee<d;ee++)j.dyn_dtree[2*ee]=0;for(ee=0;ee<m;ee++)j.bl_tree[2*ee]=0;j.dyn_ltree[2*A]=1,j.opt_len=j.static_len=0,j.last_lit=j.matches=0}function xe(j){8<j.bi_valid?X(j,j.bi_buf):0<j.bi_valid&&(j.pending_buf[j.pending++]=j.bi_buf),j.bi_buf=0,j.bi_valid=0}function Te(j,ee,pe,me){var se=2*ee,_e=2*pe;return j[se]<j[_e]||j[se]===j[_e]&&me[ee]<=me[pe]}function Se(j,ee,pe){for(var me=j.heap[pe],se=pe<<1;se<=j.heap_len&&(se<j.heap_len&&Te(ee,j.heap[se+1],j.heap[se],j.depth)&&se++,!Te(ee,me,j.heap[se],j.depth));)j.heap[pe]=j.heap[se],pe=se,se<<=1;j.heap[pe]=me}function Me(j,ee,pe){var me,se,_e,Oe,be=0;if(j.last_lit!==0)for(;me=j.pending_buf[j.d_buf+2*be]<<8|j.pending_buf[j.d_buf+2*be+1],se=j.pending_buf[j.l_buf+be],be++,me===0?J(j,se,ee):(J(j,(_e=k[se])+h+1,ee),(Oe=R[_e])!==0&&q(j,se-=C[_e],Oe),J(j,_e=$(--me),pe),(Oe=P[_e])!==0&&q(j,me-=Y[_e],Oe)),be<j.last_lit;);J(j,A,ee)}function je(j,ee){var pe,me,se,_e=ee.dyn_tree,Oe=ee.stat_desc.static_tree,be=ee.stat_desc.has_stree,De=ee.stat_desc.elems,gt=-1;for(j.heap_len=0,j.heap_max=p,pe=0;pe<De;pe++)_e[2*pe]!==0?(j.heap[++j.heap_len]=gt=pe,j.depth[pe]=0):_e[2*pe+1]=0;for(;j.heap_len<2;)_e[2*(se=j.heap[++j.heap_len]=gt<2?++gt:0)]=1,j.depth[se]=0,j.opt_len--,be&&(j.static_len-=Oe[2*se+1]);for(ee.max_code=gt,pe=j.heap_len>>1;1<=pe;pe--)Se(j,_e,pe);for(se=De;pe=j.heap[1],j.heap[1]=j.heap[j.heap_len--],Se(j,_e,1),me=j.heap[1],j.heap[--j.heap_max]=pe,j.heap[--j.heap_max]=me,_e[2*se]=_e[2*pe]+_e[2*me],j.depth[se]=(j.depth[pe]>=j.depth[me]?j.depth[pe]:j.depth[me])+1,_e[2*pe+1]=_e[2*me+1]=se,j.heap[1]=se++,Se(j,_e,1),2<=j.heap_len;);j.heap[--j.heap_max]=j.heap[1],(function(Ze,Jt){var L,b,v,D,Z,le,H=Jt.dyn_tree,re=Jt.max_code,ze=Jt.stat_desc.static_tree,Ge=Jt.stat_desc.has_stree,qe=Jt.stat_desc.extra_bits,Le=Jt.stat_desc.extra_base,Xr=Jt.stat_desc.max_length,Tn=0;for(D=0;D<=g;D++)Ze.bl_count[D]=0;for(H[2*Ze.heap[Ze.heap_max]+1]=0,L=Ze.heap_max+1;L<p;L++)Xr<(D=H[2*H[2*(b=Ze.heap[L])+1]+1]+1)&&(D=Xr,Tn++),H[2*b+1]=D,re<b||(Ze.bl_count[D]++,Z=0,Le<=b&&(Z=qe[b-Le]),le=H[2*b],Ze.opt_len+=le*(D+Z),Ge&&(Ze.static_len+=le*(ze[2*b+1]+Z)));if(Tn!==0){do{for(D=Xr-1;Ze.bl_count[D]===0;)D--;Ze.bl_count[D]--,Ze.bl_count[D+1]+=2,Ze.bl_count[Xr]--,Tn-=2}while(0<Tn);for(D=Xr;D!==0;D--)for(b=Ze.bl_count[D];b!==0;)re<(v=Ze.heap[--L])||(H[2*v+1]!==D&&(Ze.opt_len+=(D-H[2*v+1])*H[2*v],H[2*v+1]=D),b--)}})(j,ee),Ee(_e,gt,j.bl_count)}function S(j,ee,pe){var me,se,_e=-1,Oe=ee[1],be=0,De=7,gt=4;for(Oe===0&&(De=138,gt=3),ee[2*(pe+1)+1]=65535,me=0;me<=pe;me++)se=Oe,Oe=ee[2*(me+1)+1],++be<De&&se===Oe||(be<gt?j.bl_tree[2*se]+=be:se!==0?(se!==_e&&j.bl_tree[2*se]++,j.bl_tree[2*T]++):be<=10?j.bl_tree[2*x]++:j.bl_tree[2*M]++,_e=se,gt=(be=0)===Oe?(De=138,3):se===Oe?(De=6,3):(De=7,4))}function he(j,ee,pe){var me,se,_e=-1,Oe=ee[1],be=0,De=7,gt=4;for(Oe===0&&(De=138,gt=3),me=0;me<=pe;me++)if(se=Oe,Oe=ee[2*(me+1)+1],!(++be<De&&se===Oe)){if(be<gt)for(;J(j,se,j.bl_tree),--be!=0;);else se!==0?(se!==_e&&(J(j,se,j.bl_tree),be--),J(j,T,j.bl_tree),q(j,be-3,2)):be<=10?(J(j,x,j.bl_tree),q(j,be-3,3)):(J(j,M,j.bl_tree),q(j,be-11,7));_e=se,gt=(be=0)===Oe?(De=138,3):se===Oe?(De=6,3):(De=7,4)}}c(Y);var ie=!1;function K(j,ee,pe,me){q(j,(l<<1)+(me?1:0),3),(function(se,_e,Oe,be){xe(se),X(se,Oe),X(se,~Oe),s.arraySet(se.pending_buf,se.window,_e,Oe,se.pending),se.pending+=Oe})(j,ee,pe)}i._tr_init=function(j){ie||((function(){var ee,pe,me,se,_e,Oe=new Array(g+1);for(se=me=0;se<u-1;se++)for(C[se]=me,ee=0;ee<1<<R[se];ee++)k[me++]=se;for(k[me-1]=se,se=_e=0;se<16;se++)for(Y[se]=_e,ee=0;ee<1<<P[se];ee++)I[_e++]=se;for(_e>>=7;se<d;se++)for(Y[se]=_e<<7,ee=0;ee<1<<P[se]-7;ee++)I[256+_e++]=se;for(pe=0;pe<=g;pe++)Oe[pe]=0;for(ee=0;ee<=143;)G[2*ee+1]=8,ee++,Oe[8]++;for(;ee<=255;)G[2*ee+1]=9,ee++,Oe[9]++;for(;ee<=279;)G[2*ee+1]=7,ee++,Oe[7]++;for(;ee<=287;)G[2*ee+1]=8,ee++,Oe[8]++;for(Ee(G,f+1,Oe),ee=0;ee<d;ee++)O[2*ee+1]=5,O[2*ee]=de(ee,5);z=new N(G,R,h+1,f,g),B=new N(O,P,0,d,g),Q=new N(new Array(0),W,0,m,_)})(),ie=!0),j.l_desc=new U(j.dyn_ltree,z),j.d_desc=new U(j.dyn_dtree,B),j.bl_desc=new U(j.bl_tree,Q),j.bi_buf=0,j.bi_valid=0,ke(j)},i._tr_stored_block=K,i._tr_flush_block=function(j,ee,pe,me){var se,_e,Oe=0;0<j.level?(j.strm.data_type===2&&(j.strm.data_type=(function(be){var De,gt=4093624447;for(De=0;De<=31;De++,gt>>>=1)if(1&gt&&be.dyn_ltree[2*De]!==0)return o;if(be.dyn_ltree[18]!==0||be.dyn_ltree[20]!==0||be.dyn_ltree[26]!==0)return a;for(De=32;De<h;De++)if(be.dyn_ltree[2*De]!==0)return a;return o})(j)),je(j,j.l_desc),je(j,j.d_desc),Oe=(function(be){var De;for(S(be,be.dyn_ltree,be.l_desc.max_code),S(be,be.dyn_dtree,be.d_desc.max_code),je(be,be.bl_desc),De=m-1;3<=De&&be.bl_tree[2*F[De]+1]===0;De--);return be.opt_len+=3*(De+1)+5+5+4,De})(j),se=j.opt_len+3+7>>>3,(_e=j.static_len+3+7>>>3)<=se&&(se=_e)):se=_e=pe+5,pe+4<=se&&ee!==-1?K(j,ee,pe,me):j.strategy===4||_e===se?(q(j,2+(me?1:0),3),Me(j,G,O)):(q(j,4+(me?1:0),3),(function(be,De,gt,Ze){var Jt;for(q(be,De-257,5),q(be,gt-1,5),q(be,Ze-4,4),Jt=0;Jt<Ze;Jt++)q(be,be.bl_tree[2*F[Jt]+1],3);he(be,be.dyn_ltree,De-1),he(be,be.dyn_dtree,gt-1)})(j,j.l_desc.max_code+1,j.d_desc.max_code+1,Oe+1),Me(j,j.dyn_ltree,j.dyn_dtree)),ke(j),me&&xe(j)},i._tr_tally=function(j,ee,pe){return j.pending_buf[j.d_buf+2*j.last_lit]=ee>>>8&255,j.pending_buf[j.d_buf+2*j.last_lit+1]=255&ee,j.pending_buf[j.l_buf+j.last_lit]=255&pe,j.last_lit++,ee===0?j.dyn_ltree[2*pe]++:(j.matches++,ee--,j.dyn_ltree[2*(k[pe]+h+1)]++,j.dyn_dtree[2*$(ee)]++),j.last_lit===j.lit_bufsize-1},i._tr_align=function(j){q(j,2,3),J(j,A,G),(function(ee){ee.bi_valid===16?(X(ee,ee.bi_buf),ee.bi_buf=0,ee.bi_valid=0):8<=ee.bi_valid&&(ee.pending_buf[ee.pending++]=255&ee.bi_buf,ee.bi_buf>>=8,ee.bi_valid-=8)})(j)}},{"../utils/common":41}],53:[function(r,n,i){n.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},{}],54:[function(r,n,i){(function(s){(function(o,a){if(!o.setImmediate){var c,l,u,h,f=1,d={},m=!1,p=o.document,g=Object.getPrototypeOf&&Object.getPrototypeOf(o);g=g&&g.setTimeout?g:o,c={}.toString.call(o.process)==="[object process]"?function(T){Rn.nextTick(function(){_(T)})}:(function(){if(o.postMessage&&!o.importScripts){var T=!0,x=o.onmessage;return o.onmessage=function(){T=!1},o.postMessage("","*"),o.onmessage=x,T}})()?(h="setImmediate$"+Math.random()+"$",o.addEventListener?o.addEventListener("message",A,!1):o.attachEvent("onmessage",A),function(T){o.postMessage(h+T,"*")}):o.MessageChannel?((u=new MessageChannel).port1.onmessage=function(T){_(T.data)},function(T){u.port2.postMessage(T)}):p&&"onreadystatechange"in p.createElement("script")?(l=p.documentElement,function(T){var x=p.createElement("script");x.onreadystatechange=function(){_(T),x.onreadystatechange=null,l.removeChild(x),x=null},l.appendChild(x)}):function(T){setTimeout(_,0,T)},g.setImmediate=function(T){typeof T!="function"&&(T=new Function(""+T));for(var x=new Array(arguments.length-1),M=0;M<x.length;M++)x[M]=arguments[M+1];var R={callback:T,args:x};return d[f]=R,c(f),f++},g.clearImmediate=y}function y(T){delete d[T]}function _(T){if(m)setTimeout(_,0,T);else{var x=d[T];if(x){m=!0;try{(function(M){var R=M.callback,P=M.args;switch(P.length){case 0:R();break;case 1:R(P[0]);break;case 2:R(P[0],P[1]);break;case 3:R(P[0],P[1],P[2]);break;default:R.apply(a,P)}})(x)}finally{y(T),m=!1}}}}function A(T){T.source===o&&typeof T.data=="string"&&T.data.indexOf(h)===0&&_(+T.data.slice(h.length))}})(typeof self>"u"?s===void 0?this:s:self)}).call(this,typeof ji<"u"?ji:typeof self<"u"?self:typeof window<"u"?window:{})},{}]},{},[10])(10)})})(fm)),fm.exports}var aW=oW(),dm=fs(aW);const OT={"application/andrew-inset":["ez"],"application/appinstaller":["appinstaller"],"application/applixware":["aw"],"application/appx":["appx"],"application/appxbundle":["appxbundle"],"application/atom+xml":["atom"],"application/atomcat+xml":["atomcat"],"application/atomdeleted+xml":["atomdeleted"],"application/atomsvc+xml":["atomsvc"],"application/atsc-dwd+xml":["dwd"],"application/atsc-held+xml":["held"],"application/atsc-rsat+xml":["rsat"],"application/automationml-aml+xml":["aml"],"application/automationml-amlx+zip":["amlx"],"application/bdoc":["bdoc"],"application/calendar+xml":["xcs"],"application/ccxml+xml":["ccxml"],"application/cdfx+xml":["cdfx"],"application/cdmi-capability":["cdmia"],"application/cdmi-container":["cdmic"],"application/cdmi-domain":["cdmid"],"application/cdmi-object":["cdmio"],"application/cdmi-queue":["cdmiq"],"application/cpl+xml":["cpl"],"application/cu-seeme":["cu"],"application/cwl":["cwl"],"application/dash+xml":["mpd"],"application/dash-patch+xml":["mpp"],"application/davmount+xml":["davmount"],"application/dicom":["dcm"],"application/docbook+xml":["dbk"],"application/dssc+der":["dssc"],"application/dssc+xml":["xdssc"],"application/ecmascript":["ecma"],"application/emma+xml":["emma"],"application/emotionml+xml":["emotionml"],"application/epub+zip":["epub"],"application/exi":["exi"],"application/express":["exp"],"application/fdf":["fdf"],"application/fdt+xml":["fdt"],"application/font-tdpfr":["pfr"],"application/geo+json":["geojson"],"application/gml+xml":["gml"],"application/gpx+xml":["gpx"],"application/gxf":["gxf"],"application/gzip":["gz"],"application/hjson":["hjson"],"application/hyperstudio":["stk"],"application/inkml+xml":["ink","inkml"],"application/ipfix":["ipfix"],"application/its+xml":["its"],"application/java-archive":["jar","war","ear"],"application/java-serialized-object":["ser"],"application/java-vm":["class"],"application/javascript":["*js"],"application/json":["json","map"],"application/json5":["json5"],"application/jsonml+json":["jsonml"],"application/ld+json":["jsonld"],"application/lgr+xml":["lgr"],"application/lost+xml":["lostxml"],"application/mac-binhex40":["hqx"],"application/mac-compactpro":["cpt"],"application/mads+xml":["mads"],"application/manifest+json":["webmanifest"],"application/marc":["mrc"],"application/marcxml+xml":["mrcx"],"application/mathematica":["ma","nb","mb"],"application/mathml+xml":["mathml"],"application/mbox":["mbox"],"application/media-policy-dataset+xml":["mpf"],"application/mediaservercontrol+xml":["mscml"],"application/metalink+xml":["metalink"],"application/metalink4+xml":["meta4"],"application/mets+xml":["mets"],"application/mmt-aei+xml":["maei"],"application/mmt-usd+xml":["musd"],"application/mods+xml":["mods"],"application/mp21":["m21","mp21"],"application/mp4":["*mp4","*mpg4","mp4s","m4p"],"application/msix":["msix"],"application/msixbundle":["msixbundle"],"application/msword":["doc","dot"],"application/mxf":["mxf"],"application/n-quads":["nq"],"application/n-triples":["nt"],"application/node":["cjs"],"application/octet-stream":["bin","dms","lrf","mar","so","dist","distz","pkg","bpk","dump","elc","deploy","exe","dll","deb","dmg","iso","img","msi","msp","msm","buffer"],"application/oda":["oda"],"application/oebps-package+xml":["opf"],"application/ogg":["ogx"],"application/omdoc+xml":["omdoc"],"application/onenote":["onetoc","onetoc2","onetmp","onepkg","one","onea"],"application/oxps":["oxps"],"application/p2p-overlay+xml":["relo"],"application/patch-ops-error+xml":["xer"],"application/pdf":["pdf"],"application/pgp-encrypted":["pgp"],"application/pgp-keys":["asc"],"application/pgp-signature":["sig","*asc"],"application/pics-rules":["prf"],"application/pkcs10":["p10"],"application/pkcs7-mime":["p7m","p7c"],"application/pkcs7-signature":["p7s"],"application/pkcs8":["p8"],"application/pkix-attr-cert":["ac"],"application/pkix-cert":["cer"],"application/pkix-crl":["crl"],"application/pkix-pkipath":["pkipath"],"application/pkixcmp":["pki"],"application/pls+xml":["pls"],"application/postscript":["ai","eps","ps"],"application/provenance+xml":["provx"],"application/pskc+xml":["pskcxml"],"application/raml+yaml":["raml"],"application/rdf+xml":["rdf","owl"],"application/reginfo+xml":["rif"],"application/relax-ng-compact-syntax":["rnc"],"application/resource-lists+xml":["rl"],"application/resource-lists-diff+xml":["rld"],"application/rls-services+xml":["rs"],"application/route-apd+xml":["rapd"],"application/route-s-tsid+xml":["sls"],"application/route-usd+xml":["rusd"],"application/rpki-ghostbusters":["gbr"],"application/rpki-manifest":["mft"],"application/rpki-roa":["roa"],"application/rsd+xml":["rsd"],"application/rss+xml":["rss"],"application/rtf":["rtf"],"application/sbml+xml":["sbml"],"application/scvp-cv-request":["scq"],"application/scvp-cv-response":["scs"],"application/scvp-vp-request":["spq"],"application/scvp-vp-response":["spp"],"application/sdp":["sdp"],"application/senml+xml":["senmlx"],"application/sensml+xml":["sensmlx"],"application/set-payment-initiation":["setpay"],"application/set-registration-initiation":["setreg"],"application/shf+xml":["shf"],"application/sieve":["siv","sieve"],"application/smil+xml":["smi","smil"],"application/sparql-query":["rq"],"application/sparql-results+xml":["srx"],"application/sql":["sql"],"application/srgs":["gram"],"application/srgs+xml":["grxml"],"application/sru+xml":["sru"],"application/ssdl+xml":["ssdl"],"application/ssml+xml":["ssml"],"application/swid+xml":["swidtag"],"application/tei+xml":["tei","teicorpus"],"application/thraud+xml":["tfi"],"application/timestamped-data":["tsd"],"application/toml":["toml"],"application/trig":["trig"],"application/ttml+xml":["ttml"],"application/ubjson":["ubj"],"application/urc-ressheet+xml":["rsheet"],"application/urc-targetdesc+xml":["td"],"application/voicexml+xml":["vxml"],"application/wasm":["wasm"],"application/watcherinfo+xml":["wif"],"application/widget":["wgt"],"application/winhlp":["hlp"],"application/wsdl+xml":["wsdl"],"application/wspolicy+xml":["wspolicy"],"application/xaml+xml":["xaml"],"application/xcap-att+xml":["xav"],"application/xcap-caps+xml":["xca"],"application/xcap-diff+xml":["xdf"],"application/xcap-el+xml":["xel"],"application/xcap-ns+xml":["xns"],"application/xenc+xml":["xenc"],"application/xfdf":["xfdf"],"application/xhtml+xml":["xhtml","xht"],"application/xliff+xml":["xlf"],"application/xml":["xml","xsl","xsd","rng"],"application/xml-dtd":["dtd"],"application/xop+xml":["xop"],"application/xproc+xml":["xpl"],"application/xslt+xml":["*xsl","xslt"],"application/xspf+xml":["xspf"],"application/xv+xml":["mxml","xhvml","xvml","xvm"],"application/yang":["yang"],"application/yin+xml":["yin"],"application/zip":["zip"],"application/zip+dotlottie":["lottie"],"audio/3gpp":["*3gpp"],"audio/aac":["adts","aac"],"audio/adpcm":["adp"],"audio/amr":["amr"],"audio/basic":["au","snd"],"audio/midi":["mid","midi","kar","rmi"],"audio/mobile-xmf":["mxmf"],"audio/mp3":["*mp3"],"audio/mp4":["m4a","mp4a","m4b"],"audio/mpeg":["mpga","mp2","mp2a","mp3","m2a","m3a"],"audio/ogg":["oga","ogg","spx","opus"],"audio/s3m":["s3m"],"audio/silk":["sil"],"audio/wav":["wav"],"audio/wave":["*wav"],"audio/webm":["weba"],"audio/xm":["xm"],"font/collection":["ttc"],"font/otf":["otf"],"font/ttf":["ttf"],"font/woff":["woff"],"font/woff2":["woff2"],"image/aces":["exr"],"image/apng":["apng"],"image/avci":["avci"],"image/avcs":["avcs"],"image/avif":["avif"],"image/bmp":["bmp","dib"],"image/cgm":["cgm"],"image/dicom-rle":["drle"],"image/dpx":["dpx"],"image/emf":["emf"],"image/fits":["fits"],"image/g3fax":["g3"],"image/gif":["gif"],"image/heic":["heic"],"image/heic-sequence":["heics"],"image/heif":["heif"],"image/heif-sequence":["heifs"],"image/hej2k":["hej2"],"image/ief":["ief"],"image/jaii":["jaii"],"image/jais":["jais"],"image/jls":["jls"],"image/jp2":["jp2","jpg2"],"image/jpeg":["jpg","jpeg","jpe"],"image/jph":["jph"],"image/jphc":["jhc"],"image/jpm":["jpm","jpgm"],"image/jpx":["jpx","jpf"],"image/jxl":["jxl"],"image/jxr":["jxr"],"image/jxra":["jxra"],"image/jxrs":["jxrs"],"image/jxs":["jxs"],"image/jxsc":["jxsc"],"image/jxsi":["jxsi"],"image/jxss":["jxss"],"image/ktx":["ktx"],"image/ktx2":["ktx2"],"image/pjpeg":["jfif"],"image/png":["png"],"image/sgi":["sgi"],"image/svg+xml":["svg","svgz"],"image/t38":["t38"],"image/tiff":["tif","tiff"],"image/tiff-fx":["tfx"],"image/webp":["webp"],"image/wmf":["wmf"],"message/disposition-notification":["disposition-notification"],"message/global":["u8msg"],"message/global-delivery-status":["u8dsn"],"message/global-disposition-notification":["u8mdn"],"message/global-headers":["u8hdr"],"message/rfc822":["eml","mime","mht","mhtml"],"model/3mf":["3mf"],"model/gltf+json":["gltf"],"model/gltf-binary":["glb"],"model/iges":["igs","iges"],"model/jt":["jt"],"model/mesh":["msh","mesh","silo"],"model/mtl":["mtl"],"model/obj":["obj"],"model/prc":["prc"],"model/step":["step","stp","stpnc","p21","210"],"model/step+xml":["stpx"],"model/step+zip":["stpz"],"model/step-xml+zip":["stpxz"],"model/stl":["stl"],"model/u3d":["u3d"],"model/vrml":["wrl","vrml"],"model/x3d+binary":["*x3db","x3dbz"],"model/x3d+fastinfoset":["x3db"],"model/x3d+vrml":["*x3dv","x3dvz"],"model/x3d+xml":["x3d","x3dz"],"model/x3d-vrml":["x3dv"],"text/cache-manifest":["appcache","manifest"],"text/calendar":["ics","ifb"],"text/coffeescript":["coffee","litcoffee"],"text/css":["css"],"text/csv":["csv"],"text/html":["html","htm","shtml"],"text/jade":["jade"],"text/javascript":["js","mjs"],"text/jsx":["jsx"],"text/less":["less"],"text/markdown":["md","markdown"],"text/mathml":["mml"],"text/mdx":["mdx"],"text/n3":["n3"],"text/plain":["txt","text","conf","def","list","log","in","ini"],"text/richtext":["rtx"],"text/rtf":["*rtf"],"text/sgml":["sgml","sgm"],"text/shex":["shex"],"text/slim":["slim","slm"],"text/spdx":["spdx"],"text/stylus":["stylus","styl"],"text/tab-separated-values":["tsv"],"text/troff":["t","tr","roff","man","me","ms"],"text/turtle":["ttl"],"text/uri-list":["uri","uris","urls"],"text/vcard":["vcard"],"text/vtt":["vtt"],"text/wgsl":["wgsl"],"text/xml":["*xml"],"text/yaml":["yaml","yml"],"video/3gpp":["3gp","3gpp"],"video/3gpp2":["3g2"],"video/h261":["h261"],"video/h263":["h263"],"video/h264":["h264"],"video/iso.segment":["m4s"],"video/jpeg":["jpgv"],"video/jpm":["*jpm","*jpgm"],"video/mj2":["mj2","mjp2"],"video/mp2t":["ts","m2t","m2ts","mts"],"video/mp4":["mp4","mp4v","mpg4"],"video/mpeg":["mpeg","mpg","mpe","m1v","m2v"],"video/ogg":["ogv"],"video/quicktime":["qt","mov"],"video/webm":["webm"]};Object.freeze(OT);var An=function(t,e,r,n){if(r==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?t!==e||!n:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return r==="m"?n:r==="a"?n.call(t):n?n.value:e.get(t)},ea,gc,Qs;class cW{constructor(...e){ea.set(this,new Map),gc.set(this,new Map),Qs.set(this,new Map);for(const r of e)this.define(r)}define(e,r=!1){for(let[n,i]of Object.entries(e)){n=n.toLowerCase(),i=i.map(a=>a.toLowerCase()),An(this,Qs,"f").has(n)||An(this,Qs,"f").set(n,new Set);const s=An(this,Qs,"f").get(n);let o=!0;for(let a of i){const c=a.startsWith("*");if(a=c?a.slice(1):a,s?.add(a),o&&An(this,gc,"f").set(n,a),o=!1,c)continue;const l=An(this,ea,"f").get(a);if(l&&l!=n&&!r)throw new Error(`"${n} -> ${a}" conflicts with "${l} -> ${a}". Pass \`force=true\` to override this definition.`);An(this,ea,"f").set(a,n)}}return this}getType(e){if(typeof e!="string")return null;const r=e.replace(/^.*[/\\]/s,"").toLowerCase(),n=r.replace(/^.*\./s,"").toLowerCase(),i=r.length<e.length;return!(n.length<r.length-1)&&i?null:An(this,ea,"f").get(n)??null}getExtension(e){return typeof e!="string"?null:(e=e?.split?.(";")[0],(e&&An(this,gc,"f").get(e.trim().toLowerCase()))??null)}getAllExtensions(e){return typeof e!="string"?null:An(this,Qs,"f").get(e.toLowerCase())??null}_freeze(){this.define=()=>{throw new Error("define() not allowed for built-in Mime objects. See https://github.com/broofa/mime/blob/main/README.md#custom-mime-instances")},Object.freeze(this);for(const e of An(this,Qs,"f").values())Object.freeze(e);return this}_getTestState(){return{types:An(this,ea,"f"),extensions:An(this,gc,"f")}}}ea=new WeakMap,gc=new WeakMap,Qs=new WeakMap;var lW=new cW(OT)._freeze(),eh={},IT;function uW(){if(IT)return eh;IT=1,Object.defineProperty(eh,"__esModule",{value:!0});function t(a){return typeof a=="string"?a.startsWith("#")?"hex":null:"r"in a&&"g"in a&&"b"in a?"rgb":"h"in a&&"s"in a&&"l"in a?"hsl":"h"in a&&"s"in a&&"v"in a?"hsv":null}function e(a){const c=a.replace("#",""),l=parseInt(c.substring(0,2),16),u=parseInt(c.substring(2,4),16),h=parseInt(c.substring(4,6),16);return{r:l,g:u,b:h}}function r(a){const{r:c,g:l,b:u}=a;return`#${(c<<16|l<<8|u).toString(16).padStart(6,"0")}`}function n(a,c,l){c/=100,l/=100;const u=d=>(d+a/30)%12,h=c*Math.min(l,1-l),f=d=>l-h*Math.max(-1,Math.min(u(d)-3,Math.min(9-u(d),1)));return{r:Math.round(f(0)*255),g:Math.round(f(8)*255),b:Math.round(f(4)*255)}}function i(a,c,l){c/=100,l/=100;const u=f=>(f+a/60)%6,h=f=>l-l*c*Math.max(0,Math.min(u(f),4-u(f),1));return{r:Math.round(h(5)*255),g:Math.round(h(3)*255),b:Math.round(h(1)*255)}}function s(a,c){const l=Math.abs(a.r-c.r),u=Math.abs(a.g-c.g),h=Math.abs(a.b-c.b),f=1-l/255,d=1-u/255,m=1-h/255;return(f+d+m)/3}function o(a){let c=Math.min(Math.max(a.similarityThreshold||.8,.01),1);const{targetColor:l,colorArray:u}=a,h=t(l);if(h===null)return null;let f;if(h==="hex")f=e(l);else if(h==="rgb")f=l;else if(h==="hsl"){const{h:p,s:g,l:y}=l;f=n(p,g,y)}else if(h==="hsv"){const{h:p,s:g,v:y}=l;f=i(p,g,y)}else return null;let d=null,m=0;for(const p of u){t(p.hex?p.hex:p.rgb),p.hex?p.rgb||(p.rgb=e(p.hex)):p.hex=r(p.rgb);const g=Math.round(s(f,p.rgb)*100)/100;g>=c&&g>m&&(m=g,d={name:p.name,hex:p.hex,rgb:p.rgb,similarity:g})}return d}return eh.default=o,eh}var hW=uW(),fW=fs(hW);function dW(t,e=16){return t?zf(e-1).map(r=>{const n=r*Sa;return new cl(t.bits[n]/63,t.bits[n+1]/63,t.bits[n+2]/63)}):[]}let Bi=class{pos;bytes;size;sauce;SAUCE_ID=new Uint8Array([83,65,85,67,69]);COMNT_ID=new Uint8Array([67,79,77,78,84]);constructor(e){this.bytes=e,this.pos=0,this.size=e.length,this.parseSauce()}get(){if(this.pos>=this.bytes.length)throw new Error("Unexpected end of file reached.");return this.bytes[this.pos++]}get16(){return this.get()+(this.get()<<8)}get32(){let e=this.get();return e+=this.get()<<8,e+=this.get()<<16,e+(this.get()<<24)}getC(){return String.fromCharCode(this.get())}getS(e){let r="";for(;e-- >0;)r+=this.getC();return r.replace(/\s+$/,"")}getSZ(e){let r="",n;for(;e-- >0&&(n=this.get(),n!==0);)r+=String.fromCharCode(n);return r}lookahead(e){let r;for(r=0;r<e.length&&!(this.pos+r===this.bytes.length||this.bytes[this.pos+r]!==e[r]);++r);return r===e.length}read(e){const r=this.pos;for(e=e||this.size-this.pos;++this.pos<this.size&&--e!==0;);return this.bytes.subarray(r,this.pos)}seek(e){this.pos=e}peek(e){return e=e||0,this.bytes[this.pos+e]}getPos(){return this.pos}eof(){return this.pos===this.size}parseSauce(){if(this.pos=this.bytes.length-128,this.lookahead(this.SAUCE_ID)){this.sauce={},this.getS(5),this.sauce.version=this.getS(2),this.sauce.title=this.getS(35),this.sauce.author=this.getS(20),this.sauce.group=this.getS(20),this.sauce.date=this.getS(8),this.sauce.fileSize=this.get32(),this.sauce.dataType=this.get(),this.sauce.fileType=this.get(),this.sauce.tInfo1=this.get16(),this.sauce.tInfo2=this.get16(),this.sauce.tInfo3=this.get16(),this.sauce.tInfo4=this.get16(),this.sauce.comments=[];const e=this.get();if(this.sauce.flags=this.get(),this.sauce.blinkMode=(this.sauce.flags&1)===1,this.sauce.letterSpacing=this.sauce.flags>>1&3,this.sauce.aspectRatio=this.sauce.flags>>3&3,this.sauce.tInfoS=this.getSZ(22),e>0&&(this.pos=this.bytes.length-128-e*64-5,this.lookahead(this.COMNT_ID))){this.getS(5);let r=e;for(;r-- >0;)this.sauce.comments.push(this.getS(64))}}this.pos=0,this.sauce?this.sauce.fileSize>0&&this.sauce.fileSize<this.bytes.length?this.size=this.sauce.fileSize:this.size=this.bytes.length-128:this.size=this.bytes.length}};function NT(t){return new Bi(t).sauce}function pW(t,e,r){const n=new XMLHttpRequest;n.open("GET",t,!0),n.onreadystatechange=function(){if(n.readyState===4)switch(n.status){case 0:case 200:e(new Uint8Array(n.response));break;default:r&&r(n.status)}},n.responseType="arraybuffer",n.send()}function mW(t,e,r){pW(t,n=>{e(NT(n))},r)}function th(t){return new Uint8Array([(((t&32)>>5)+((t&4)>>1))*85,(((t&16)>>4)+(t&2))*85,(((t&8)>>3)+((t&1)<<1))*85,255])}const gW=[0,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7].map(th),yW=[0,4,2,20,1,5,3,7,56,60,58,62,57,61,59,63].map(th),_W=[0,1,2,3,4,5,20,7,56,57,58,59,60,61,62,63].map(th),bW=[7,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0].map(th),wW=[new Uint8Array([170,170,170,255]),new Uint8Array([170,170,170,255]),new Uint8Array([0,0,0,255]),new Uint8Array([0,0,0,255]),new Uint8Array([255,255,255,255]),new Uint8Array([255,255,255,255]),new Uint8Array([102,136,187,255]),new Uint8Array([102,136,187,255]),new Uint8Array([0,0,255,255]),new Uint8Array([0,0,255,255]),new Uint8Array([255,0,255,255]),new Uint8Array([255,0,255,255]),new Uint8Array([0,255,255,255]),new Uint8Array([0,255,255,255]),new Uint8Array([255,255,255,255]),new Uint8Array([255,255,255,255])];function kW(t){const e=[];for(let r=0;r<16;++r){const n=t.get(),i=t.get(),s=t.get();e.push(new Uint8Array([n<<2|n>>4,i<<2|i>>4,s<<2|s>>4,255]))}return e}function vW(t){const e=[];for(let r=0;r<64;++r){const n=t.get(),i=t.get(),s=t.get();e.push(new Uint8Array([n<<2|n>>4,i<<2|i>>4,s<<2|s>>4,255]))}return[e[0],e[1],e[2],e[3],e[4],e[5],e[20],e[7],e[56],e[57],e[58],e[59],e[60],e[61],e[62],e[63]]}const Wn={ASC_PC:gW,ANSI:yW,BIN:_W,CED:bW,WORKBENCH:wW,adf:vW,triplets16:kW};class os{imageData;pos;columns;rows;palette;font;constructor(e){this.columns=e,this.rows=0,this.pos=0,this.imageData=new Uint8Array(e*1e3*10)}reset(){this.imageData=new Uint8Array(this.columns*1e3*10),this.pos=0,this.rows=0}extendImageData(e){const r=new Uint8Array(this.columns*(e+1e3)*10+this.imageData.length);r.set(this.imageData,0),this.imageData=r}set(e,r,n,i,s,o){this.pos=(r*this.columns+e)*10,this.pos>=this.imageData.length&&this.extendImageData(r),this.imageData[this.pos]=n,i?(this.imageData[this.pos+1]=1,this.imageData.set(s,this.pos+2),this.imageData.set(o,this.pos+6)):(this.imageData[this.pos+2]=s,this.imageData[this.pos+3]=o),r+1>this.rows&&(this.rows=r+1)}raw(e){this.rows=Math.ceil(e.length/2/this.columns),this.imageData=new Uint8Array(this.columns*this.rows*10);for(let r=0,n=0;n<e.length;r+=10,n+=2)this.imageData[r]=e[n],this.imageData[r+2]=e[n+1]&15,this.imageData[r+3]=e[n+1]>>4}trimColumns(){let e=0;const r=this.imageData.length/10/this.columns;for(let i=0;i<this.imageData.length;i+=10)this.imageData[i]&&(e=Math.max(i/10%this.columns,e));++e;const n=new Uint8Array((e+1)*r*10);for(let i=0,s=0;i<n.length;i+=e*10,s+=this.columns*10)n.set(this.imageData.subarray(s,s+this.columns*10),i);this.imageData=n,this.columns=e}getData(){const e=this.imageData.subarray(0,this.columns*this.rows*10);for(let r=0;r<e.length;r+=10)e[r+5]=255,e[r+9]=255;return e}}function xW(t,e){const r=new Bi(t);r.getC();const n=new os(80);return n.palette=Wn.adf(r),n.raw(r.read()),{imageData:n,sauce:r.sauce}}function CT(t,e){const r=new Bi(t);let n=!1,i="",s,o,a,c;const l=new os(80);let u=0,h=1,f=1,d,m,p=7,g=0,y,_,A,T,x=!1,M=!1,R=!1,P;function W(){p=7,g=0,y=void 0,_=void 0,x=!1,M=!1,R=!1}function F(){h=1,f===25?++u:++f}function G(I,k){h=Math.min(c,Math.max(1,I)),f=Math.min(26,Math.max(1,k))}function O(){return i.substr(1,i.length-2).split(";").map(I=>{const k=Number.parseInt(I,10);return Number.isNaN(k)?1:k})}if(r.sauce){switch(r.sauce.tInfo1>0?c=r.sauce.tInfo1:c=80,P=r.sauce.flags&1||e.icecolors||0,r.sauce.letterSpacing){case 1:e.bits="8";break;case 2:e.bits="9";break}switch(r.sauce.tInfoS){case"IBM VGA":e.font="80x25";break;case"IBM VGA50":e.font="80x50";break;case"Amiga Topaz 1":e.font="topaz500";break;case"Amiga Topaz 1+":e.font="topaz500+";break;case"Amiga Topaz 2":e.font="topaz";break;case"Amiga Topaz 2+":e.font="topaz+";break;case"Amiga P0T-NOoDLE":e.font="pot-noodle";break;case"Amiga MicroKnight":e.font="microknight";break;case"Amiga MicroKnight+":e.font="microknight+";break;case"Amiga mOsOul":e.font="mosoul";break}}else e.mode==="ced"?c=78:c=80,P=e.icecolors||0;switch(l.columns=c,e.bits){case"ced":l.palette=Wn.CED;break;case"workbench":l.palette=Wn.WORKBENCH;break;default:l.palette=Wn.ANSI}for(;!r.eof();)if(o=r.get(),n){if(i+=String.fromCharCode(o),o>=65&&o<=90||o>=97&&o<=122){if(n=!1,a=O(),i.startsWith("["))switch(i.charAt(i.length-1)){case"A":f=Math.max(1,f-a[0]);break;case"B":f=Math.min(25,f+a[0]);break;case"C":h===c&&F(),h=Math.min(c,h+a[0]);break;case"D":h=Math.max(1,h-a[0]);break;case"H":a.length===1?G(1,a[0]):G(a[1],a[0]);break;case"J":a[0]===2&&(h=1,f=1,l.reset());break;case"K":for(s=h-1;s<c;++s)l.set(s,f-1+u,0,!1,0,0);break;case"m":for(s=0;s<a.length;++s)if(a[s]>=30&&a[s]<=37)p=a[s]-30,y&&(y=void 0);else if(a[s]>=40&&a[s]<=47)g=a[s]-40,_&&(_=void 0);else switch(a[s]){case 0:W();break;case 1:x=!0,y&&(y=void 0);break;case 5:M=!0,_&&(_=void 0);break;case 7:R=!0;break;case 22:x=!1;break;case 25:M=!1;break;case 27:R=!1;break}break;case"s":d=h,m=f;break;case"t":if(a.length===4)switch(a[0]){case 0:_=new Uint8Array([a[1],a[2],a[3]]);break;case 1:y=new Uint8Array([a[1],a[2],a[3]]);break}break;case"u":h=d||h,f=m||f;break}i=""}}else switch(o){case 10:F();break;case 13:r.peek()===10&&(r.read(1),F());break;case 26:break;default:o===27&&r.peek()===91?n=!0:(e.mode==="ced"?l.set(h-1,f-1+u,o,!1,1,0):(R?(A=g,T=p):(A=p,T=g),x&&(A+=8),M&&P&&!_&&(T+=8),y||_?l.set(h-1,f-1+u,o,!0,y||l.palette[A],_||l.palette[T]):l.set(h-1,f-1+u,o,!1,A,T)),++h===c+1&&F())}return{imageData:l,sauce:r.sauce}}function LT(t,e){const r=new Bi(t),n=new os(80);n.palette=Wn.ASC_PC;let i=0,s=0;for(;!r.eof();){const o=r.get();o===13&&r.peek()===10?(r.read(1),++s,i=0):o===10?(++s,i=0):(n.set(i,s,o,!1,1,0),++i===80&&(++s,i=0))}return{imageData:n,sauce:r.sauce}}function EW(t,e){const r=new Bi(t),n=new os(e.columns||160);n.palette=Wn.BIN,n.raw(r.read());let i;if(r.sauce){switch(i=r.sauce.flags&1||e.icecolors||0,r.sauce.letterSpacing){case 1:e.bits="8";break;case 2:e.bits="9";break}switch(r.sauce.tInfoS){case"IBM VGA":e.font="80x25";break;case"IBM VGA50":e.font="80x50";break;case"Amiga Topaz 1":e.font="topaz500";break;case"Amiga Topaz 1+":e.font="topaz500+";break;case"Amiga Topaz 2":e.font="topaz";break;case"Amiga Topaz 2+":e.font="topaz+";break;case"Amiga P0T-NOoDLE":e.font="pot-noodle";break;case"Amiga MicroKnight":e.font="microknight";break;case"Amiga MicroKnight+":e.font="microknight+";break;case"Amiga mOsOul":e.font="mosoul";break}}else i=e.icecolors||0;if(!i){const s=n.getData();for(let o=1;o<s.length;o+=2)s[o]=s[o]&127}return{imageData:n,sauce:r.sauce}}function AW(t,e){const r=new Bi(t);r.seek(8);const n=r.get16()+1,i=new os(n);r.seek(12);let s=0,o=0;for(;r.getPos()<r.size-4144;){const a=r.get16();if(a===1){let c=r.get();r.get();const l=r.get(),u=r.get();for(;c-- >0;)i.set(s++,o,l,!1,u&15,u>>4),s===n&&(s=0,++o)}else i.set(s++,o,a&255,!1,a>>8&15,a>>12),s===n&&(s=0,++o)}return i.palette=Wn.triplets16(r),{imageData:i,sauce:r.sauce}}function TW(t,e){const r=new Bi(t),n=new os(80);n.palette=Wn.BIN;let i=0,s=7,o=0,a=0;const c=r.sauce?r.sauce.flags&1||e.icecolors||0:e.icecolors||0;function l(h){n.set(o,a,h,!1,s,i),++o===80&&(a++,o=0)}let u=0;for(;u<r.size;){const h=t[u];if(h===26)break;switch(h){case 13:break;case 10:a++,o=0;break;case 9:o+=8;break;case 64:t[u+1]===88?(i=t[u+2]-(t[u+2]>=65?55:48),!c&&i>7&&(i-=8),s=t[u+3]-(t[u+3]>=65?55:48),u+=3):t[u+1]===67&&t[u+2]===76&&t[u+3]===83?(o=a=0,n.reset(),u+=4):t[u+1]===80&&t[u+2]===79&&t[u+3]===83&&t[u+4]===58?t[u+6]===64?(o=t[u+5]-48-1,u+=5):(o=10*(t[u+5]-48)+t[u+6]-48-1,u+=6):l(h);break;default:l(h)}u++}return{imageData:n,sauce:r.sauce}}function SW(t,e){const r=new Bi(t);function n(l){let u=l.get()<<24;return u+=l.get()<<16,u+=l.get()<<8,u+l.get()}if(r.get()!==24)throw new Error("File ID does not match.");if(r.getS(8)!=="TUNDRA24")throw new Error("File ID does not match.");const i=new Uint8Array(3),s=new Uint8Array(3);let o=0,a=0;const c=new os(80);for(c.palette=Wn.ANSI;!r.eof();){o===80&&(o=0,++a);let l=r.get();l===1&&(a=n(r),o=n(r)),l===2&&(l=r.get(),r.get(),i.set(r.read(3),0)),l===4&&(l=r.get(),r.get(),s.set(r.read(3),0)),l===6&&(l=r.get(),r.get(),i.set(r.read(3),0),r.get(),s.set(r.read(3),0)),l!==1&&l!==2&&l!==4&&l!==6&&(c.set(o,a,l,!0,i,s),++o)}return{imageData:c,sauce:r.sauce}}function RW(t,e){const r=new Bi(t);function n(a){if(a.getS(4)!=="XBIN")throw new Error("File ID does not match.");if(a.get()!==26)throw new Error("File ID does not match.");const c={};if(c.width=a.get16(),c.height=a.get16(),c.fontHeight=a.get(),c.fontHeight===0||c.fontHeight>32)throw new Error(`Illegal value for the font height (${c.fontHeight}).`);const l=a.get();if(c.palette=(l&1)===1,c.font=(l&2)===2,c.fontHeight!==16&&!c.font)throw new Error("A non-standard font size was defined, but no font information was included with the file.");return c.compressed=(l&4)===4,c.nonBlink=(l&8)===8,c.char512=(l&16)===16,c}function i(a,c,l){const u=new Uint8Array(c*l*2);let h=0;for(;h<u.length;){const f=a.get(),d=f&63;switch(f>>6){case 1:{const m=a.get();for(let p=0;p<=d;++p)u[h++]=m,u[h++]=a.get();break}case 2:{const m=a.get();for(let p=0;p<=d;++p)u[h++]=a.get(),u[h++]=m;break}case 3:{const m=a.get(),p=a.get();for(let g=0;g<=d;++g)u[h++]=m,u[h++]=p;break}default:for(let m=0;m<=d;++m)u[h++]=a.get(),u[h++]=a.get()}}return u}const s=n(r),o=new os(s.width);return o.palette=s.palette?Wn.triplets16(r):Wn.BIN,s.compressed?o.raw(i(r,s.width,s.height)):o.raw(r.read(s.width*s.height*2)),{imageData:o,sauce:r.sauce}}function OW(t,e,r={}){let n;switch(r.filetype){case"txt":n=LT(t);break;case"ion":n=LT(t),n.imageData.trimColumns();break;case"adf":n=xW(t);break;case"bin":n=EW(t,r);break;case"idf":n=AW(t);break;case"pcb":n=TW(t,r);break;case"tnd":n=SW(t);break;case"xb":n=RW(t);break;case"diz":n=CT(t,r),n.imageData.trimColumns();break;default:n=CT(t,r)}e(n.imageData,n.sauce)}const IW={readBytes:OW};function MT(t,e,r){try{IW.readBytes(t,e)}catch(n){if(r)r(n);else throw n}}const NW={sauceBytes:NT,sauce:mW,renderBytes:MT};self?.WorkerLocation&&(self.onmessage=function(t){t.data.bytes&&NW.renderBytes(t.data.bytes,(e,r)=>{self.postMessage({imagedata:e,sauce:r})})});function CW(t,e,r){const n=Ku();w(n)&&MT(r,(i,s)=>{const o=s?.title??"",a=s?.author??"",c=`@board ${o||e}${a?` by ${a}`:""}
`,l=Bo(c,{}),u=mt(l);js(n,l);const h=At(l);if(!w(h))return;const f=new Map,d=dW(od(Q_));if(w(i.palette)&&w(d)){const y=[];for(let _=0;_<d.length;++_){const A=d[_];y.push({name:`${_}`,rgb:{r:Math.round(A.r*255),g:Math.round(A.g*255),b:Math.round(A.b*255)}})}for(let _=0;_<i.palette.length;++_){const A=i.palette[_][0],T=i.palette[_][1],x=i.palette[_][2],M=fW({targetColor:{r:A,g:T,b:x},colorArray:y,similarityThreshold:.5}),R=parseFloat(M?.name??"0");f.set(_,R)}}const m=i.getData();let p=0,g=0;for(let y=0;y<m.length;y+=10){if(m[y+1]){const _=m[y],A=f.get(15)??0,T=f.get(0)??0;ss({x:p,y:g})&&St(h,{x:p,y:g,kind:"fake",char:_,color:A,bg:T})}else{const _=m[y],A=f.get(m[y+2])??0,T=f.get(m[y+3])??0;ss({x:p,y:g})&&St(h,{x:p,y:g,kind:"fake",char:_,color:A,bg:T})}++p,p>=i.columns&&(p=0,++g)}ms(ce,t,`imported ansi file ${u} into ${n.name} book`)})}function LW(t,e,r){const n=Ku();if(!w(n))return;const i=`@charset ${e.toLowerCase().replace(".chr","")}`,s=Bo(i,{}),o=mt(s),a=ad(r),c=At(s);w(a)&&w(c)&&(Object.assign(c,a),js(n,s),ms(ce,t,`imported chr file ${o} into ${n.name} book`))}function MW(t,e){console.info(e)}const UW=/; \$(\w+) ?(.*)/,$W=/title (.+?) (.*)/i;function pm(t){return t.replace(/\\/g,"\\\\").replace(/'/g,"\\'")}function PW(t,e){const r=Ku();if(!w(r))return;const n=e.split(/\r?\n/),i={title:"",gendate:"",gentime:"",songs:[]};function s(m){return i.songs.find(p=>p.order===m)}function o(m,p){return{order:m,title:p,lines:[]}}for(let m=0;m<n.length;++m){const p=n[m],g=UW.exec(p);if(w(g)){const y=g[1].toLowerCase(),_=g[2];switch(y){case"title":i.title=_;break;case"gendate":i.gendate=_;break;case"gentime":i.gentime=_;break;case"song":{const A=$W.exec(_);if(w(A)){const T=parseFloat(A[1]),x=A[2],M=s(T);w(M)?M.title=x:i.songs.push(o(T,x))}else{const T=parseFloat(_);if(Ae(T)){const x=s(T);w(x)||i.songs.push(o(T,""))}}break}}}else{const y=i.songs[i.songs.length-1];w(y)&&p.trim().length&&y.lines.push(p)}}i.songs.sort((m,p)=>m.order-p.order);const a=i.songs.map(m=>m.title),c=`@play_${Fe(i.title).replace(/\W/g,"")}
@cycle 1
@char 14
#end

:touch
"ALBUM: ${pm(i.title)}"
"$purple  ${pm(i.gendate)}"
"$purple  ${pm(i.gentime)}"
${a.map((m,p)=>`!song_${p};${p+1} ${m||"untitled"}`).join(`
`)}
#end

${i.songs.map((m,p)=>`:song_${p}
${m.lines.map(g=>`#play ${g}`).join(`
`)}
#end
`).join(`
`)}
`,l=Bo(c,{}),u=mt(l);js(r,l),ms(ce,t,`imported zzt zzm file ${u} into ${r.name} book`);const h=mt(l),f=Ii(l);bt(ce,t,`!pageopen ${l.id};$blue[${f}]$white ${h}`);const d=`#put n ${u}`;BB(ce,t,d,d,!1)}const rh=60,BW=rh*25;function FW(t,e){let r=0;const n=new DataView(e.buffer);function i(){const C=n.getUint8(r);return r++,C}function s(){const C=n.getInt16(r,!0);return r+=2,C}function o(){const C=n.getInt32(r,!0);return r+=4,C}function a(C){let z="";const B=e.subarray(r,r+C);for(let Q=0;Q<B.length;++Q)z+=String.fromCharCode(B[Q]);return r+=C,z.replace("\r",`
`)}function c(C,z,B,Q){const Y=un(C,z,B);if(w(Y)&&w(Q)){const N=Br(Q);for(let U=0;U<N.length;++U){const $=N[U];Y[$]=Q[$]}}}function l(C){let z="";for(let B=0;B<C.length;++B){const Q=C.charCodeAt(B);Q<32||Q>127?z+=`$${Q}`:z+=C[B]}return z}function u(C){return C.replaceAll(/\r?\n|\r/g,`
`).split(`
`).map(z=>z.replace("$","$CENTER ")).map(l).join(`
`)}function h(C,z,B,Q,Y){const N=Q.color%16,U=Math.floor(Q.color/16)%8,$=To(N,U),X=To((U+8)%16,N),q={},J=Y.find(de=>de.x===z&&de.y===B);if(w(J)&&(Ae(J.cycle)&&J.cycle>0&&(q.cycle=J.cycle),w(J.p1)&&(q.p1=J.p1),w(J.p2)&&(q.p2=J.p2),w(J.p3)&&(q.p3=J.p3),w(J.code)&&J.code&&(q.code=u(J.code)),w(J.stepx)&&(q.stepx=J.stepx),w(J.stepy)&&(q.stepy=J.stepy),w(J.bind)&&J.bind>0)){const de=Y[J.bind];w(de?.code)&&ye(de.code)&&(q.code=u(de.code))}switch(Q.element){case 0:case 1:case 2:case 3:break;case 4:break;case 5:c(C,["ammo",$],{x:z,y:B},q);break;case 6:c(C,["torch",$],{x:z,y:B},q);break;case 7:c(C,["gem",$],{x:z,y:B},q);break;case 8:c(C,["key",$],{x:z,y:B},q);break;case 9:c(C,["door",X],{x:z,y:B},q);break;case 10:c(C,["scroll",$],{x:z,y:B},q);break;case 11:{q.p3=f(J?.p3)??"",c(C,["passage",$],{x:z,y:B},q);break}case 12:c(C,["duplicator",$],{x:z,y:B},{...q,stepx:0,stepy:0,shootx:q.stepx??0,shooty:q.stepy??0});break;case 13:c(C,["bomb",$],{x:z,y:B},q);break;case 14:c(C,["energize",$],{x:z,y:B},q);break;case 15:c(C,["star",$],{x:z,y:B},q);break;case 16:c(C,["clockwise",$],{x:z,y:B},q);break;case 17:c(C,["counter",$],{x:z,y:B},q);break;case 18:c(C,["bullet",$],{x:z,y:B},q);break;case 19:c(C,["water",$],{x:z,y:B},q);break;case 20:c(C,["forest",$],{x:z,y:B},q);break;case 21:c(C,["solid",$],{x:z,y:B},q);break;case 22:c(C,["normal",$],{x:z,y:B},q);break;case 23:c(C,["breakable",$],{x:z,y:B},q);break;case 24:c(C,["boulder",$],{x:z,y:B},q);break;case 25:c(C,["sliderns",$],{x:z,y:B},q);break;case 26:c(C,["sliderew",$],{x:z,y:B},q);break;case 27:c(C,["fake",$],{x:z,y:B},q);break;case 28:c(C,["invisible",$],{x:z,y:B},q);break;case 29:c(C,["blinkwall",$],{x:z,y:B},{...q,stepx:0,stepy:0,shootx:q.stepx??0,shooty:q.stepy??0});break;case 30:c(C,["transporter",$],{x:z,y:B},{...q,stepx:0,stepy:0,shootx:q.stepx??0,shooty:q.stepy??0});break;case 31:c(C,["line",$],{x:z,y:B},q);break;case 32:c(C,["ricochet",$],{x:z,y:B},q);break;case 33:c(C,["blinkns",$],{x:z,y:B},q);break;case 34:c(C,["bear",$],{x:z,y:B},q);break;case 35:c(C,["ruffian",$],{x:z,y:B},q);break;case 36:c(C,["object",$],{x:z,y:B},{...q,char:J?.p1??1});break;case 37:c(C,["slime",$],{x:z,y:B},q);break;case 38:c(C,["shark",$],{x:z,y:B},q);break;case 39:c(C,["spinninggun",$],{x:z,y:B},q);break;case 40:c(C,["pusher",$],{x:z,y:B},q);break;case 41:c(C,["lion",$],{x:z,y:B},q);break;case 42:c(C,["tiger",$],{x:z,y:B},q);break;case 43:c(C,["blinkns",$],{x:z,y:B},q);break;case 44:c(C,["head",$],{x:z,y:B},q);break;case 45:c(C,["segment",$],{x:z,y:B},q);break;case 46:break;case 47:c(C,["text",["WHITE","ONDKBLUE"]],{x:z,y:B},{...q,char:Q.color});break;case 48:c(C,["text",["WHITE","ONDKGREEN"]],{x:z,y:B},{...q,char:Q.color});break;case 49:c(C,["text",["WHITE","ONDKCYAN"]],{x:z,y:B},{...q,char:Q.color});break;case 50:c(C,["text",["WHITE","ONDKRED"]],{x:z,y:B},{...q,char:Q.color});break;case 51:c(C,["text",["WHITE","ONDKPURPLE"]],{x:z,y:B},{...q,char:Q.color});break;case 52:c(C,["text",["WHITE","ONDKYELLOW"]],{x:z,y:B},{...q,char:Q.color});break;case 53:c(C,["text",["WHITE","ONBLACK"]],{x:z,y:B},{...q,char:Q.color});break}}function f(C){if(Ae(C)&&C>0)return`zztboard${C}`}if(s()!=-1)return;const m=s(),p=s(),g=s(),y=a(7),_=s(),A=s(),T=s(),x=s(),M=s();s();const R=s(),P=i(),W=a(20).slice(0,P);for(let C=0;C<9;C++){const z=i();a(20).slice(0,z)}const F=s(),G=s(),O=i();console.info(p,g,y,_,A,T,x,M,R,F,G,O),r=512;const I=[];for(let C=0;C<=m;++C){const z=s(),B=r,Q=i(),N={boardname:a(50).slice(0,Q),elements:[],stats:[]};for(;N.elements.length<BW;){let $=i();$===0&&($=255);const X=i(),q=i();for(let J=0;J<$;++J)N.elements.push({element:X,color:q})}N.maxplayershots=i(),N.isdark=i(),N.exitnorth=i(),N.exitsouth=i(),N.exitwest=i(),N.exiteast=i(),N.restartonzap=i(),N.messagelength=i(),N.message=a(58).slice(0,N.messagelength),N.playerenterx=i(),N.playerentery=i(),N.timelimit=s(),r+=16;const U=s()+1;for(;N.stats.length<U;){const $={};$.x=i()-1,$.y=i()-1,$.stepx=s(),$.stepy=s(),$.cycle=s(),$.p1=i(),$.p2=i(),$.p3=i(),$.follower=s(),$.leader=s(),$.underelement=i(),$.undercolor=i(),$.pointer=o(),$.currentinstruction=s();const X=s();r+=8,X<0?$.bind=Math.abs(X):$.code=a(X),N.stats.push($)}I.push(N),r=B+z}const k=yp([]);k.name=W;for(let C=0;C<I.length;++C){const z=I[C],B=[`@zztboard${C}`,""];C===0?B.push("@title"):C===A&&B.push("@zztstartboard");for(let Ee=0;Ee<z.elements.length;++Ee)z.elements[Ee].element===4&&(B.push(`@startx ${r_(Ee,rh)}`),B.push(`@starty ${n_(Ee,rh)}`));Ae(z.maxplayershots)&&B.push(`@maxplayershots ${z.maxplayershots}`),Ae(z.isdark)&&z.isdark&&B.push("@isdark"),Ae(z.restartonzap)&&z.restartonzap&&B.push("@restartonzap"),Ae(z.timelimit)&&B.push(`@timelimit ${z.timelimit}`);const Q=f(z.exitnorth);ye(Q)&&B.push(`@exitnorth ${Q}`);const Y=f(z.exitsouth);ye(Y)&&B.push(`@exitsouth ${Y}`);const N=f(z.exitwest);ye(N)&&B.push(`@exitwest ${N}`);const U=f(z.exiteast);ye(U)&&B.push(`@exiteast ${U}`);const $=`@board ${String(C).padStart(3,"0")}. ${z.boardname}
${B.join(`
`)}`,X=Bo($,{});js(k,X);const q=At(X);if(!w(q))continue;let J=0,de=0;for(let Ee=0;Ee<z.elements.length;++Ee){const ke=z.elements[Ee];h(q,J,de,ke,z.stats),++J,J===rh&&(J=0,++de)}hr(q)}qu(k),ms(ce,t,`imported zzt file into ${k.name} book`)}function DW(t,e,r){const n=Ku();if(!w(n))return;const s=gu(r).name?r:`@${e.toLowerCase().replace(".obj","")}
${r}`,o=Bo(s,{}),a=mt(o);js(n,o),ms(ce,t,`imported zzt obj file ${a} into ${n.name} book`)}function UT(t,e){switch([...e.slice(0,4)].map(i=>i.toString(16)).join("").toUpperCase()){case"89504E47":return"image/png";case"47494638":return"image/gif";case"25504446":return"application/pdf";case"FFD8FFDB":case"FFD8FFE0":case"FFD8FFE1":return"image/jpeg";case"504B0304":return"application/zip"}return lW.getType(t)??"application/octet-stream"}function $T(t,e){if(!w(e))return"";switch(t){case"model/obj":return"obj";case"text/plain":return"txt";case"application/json":return"json";case"application/zip":return"zip";case"application/octet-stream":if(/.zzt$/i.test(e.name))return"zzt";if(/.brd$/i.test(e.name))return"brd";if(/.chr$/i.test(e.name))return"chr";if(/.zzl$/i.test(e.name))return"zzl";if(/.zzm$/i.test(e.name))return"zzm";if(/.ans$/i.test(e.name))return"ans";break}return""}let ta=[],nh={};async function jW(t,e){try{Ft(ce,t,"parsezipfile",e.name);const r=await e.arrayBuffer(),i=await new dm().loadAsync(r);ta=[],nh={};const s=[];i.forEach((o,a)=>s.push([o,a]));for(let o=0;o<s.length;++o){const[a,c]=s[o],l=await c.async("uint8array"),u=UT(a,l),h=new File([l],c.name,{type:u});ta.push(h)}iO(ce,t)}catch(r){pt(ce,t,"crash",r.message)}}function zW(){const t=[];for(let e=0;e<ta.length;++e){const r=ta[e];t.push([$T(r.type,r),r.name])}return t}function WW(t,e){nh[t.toLowerCase()]=e}function HW(t){return nh[t.toLowerCase()]}async function GW(t){for(let e=0;e<ta.length;++e){const r=ta[e];nh[r.name.toLowerCase()]&&(mm(t,r),await Nc(2e3))}await Nc(2e3),Wh(ce,t)}function PT(t,e,r){if(!w(r))return;switch($T(e,r)){case"obj":r.text().then(i=>DW(t,r.name,i)).catch(i=>pt(ce,t,"crash",i.message));break;case"txt":r.text().then(i=>Hh(ce,t,void 0,"text",`file:${r.name}`,i)).catch(i=>pt(ce,t,"crash",i.message));break;case"json":r.text().then(i=>Hh(ce,t,void 0,"json",`file:${r.name}`,i)).catch(i=>pt(ce,t,"crash",i.message));break;case"zip":jW(t,r).catch(i=>pt(ce,t,"crash",i.message));break;case"zzt":r.arrayBuffer().then(i=>{FW(t,new Uint8Array(i))}).catch(i=>pt(ce,t,"crash",i.message));break;case"brd":r.arrayBuffer().then(i=>{}).catch(i=>pt(ce,t,"crash",i.message));break;case"chr":r.arrayBuffer().then(i=>{LW(t,r.name,new Uint8Array(i))}).catch(i=>pt(ce,t,"crash",i.message));break;case"zzl":r.text().then(i=>{MW(t,i)}).catch(i=>pt(ce,t,"crash",i.message));break;case"zzm":r.text().then(i=>{PW(t,i)}).catch(i=>pt(ce,t,"crash",i.message));break;case"ans":r.arrayBuffer().then(i=>{CW(t,r.name,new Uint8Array(i))}).catch(i=>pt(ce,t,"crash",i.message));break;default:e||r.arrayBuffer().then(i=>{const s=UT(r.name,new Uint8Array(i));if(s)PT(t,s,r);else return pt(ce,t,"parsewebfile",`unsupported file ${r.name}`)}).catch(i=>pt(ce,t,"crash",i.message));return}}function mm(t,e){PT(t,e?.type??"",e)}function gm(){return{async:!1,breaks:!1,extensions:null,gfm:!0,hooks:null,pedantic:!1,renderer:null,silent:!1,tokenizer:null,walkTokens:null}}var eo=gm();function BT(t){eo=t}var yc={exec:()=>null};function yt(t,e=""){let r=typeof t=="string"?t:t.source,n={replace:(i,s)=>{let o=typeof s=="string"?s:s.source;return o=o.replace(Ur.caret,"$1"),r=r.replace(i,o),n},getRegex:()=>new RegExp(r,e)};return n}var Ur={codeRemoveIndent:/^(?: {1,4}| {0,3}\t)/gm,outputLinkReplace:/\\([\[\]])/g,indentCodeCompensation:/^(\s+)(?:```)/,beginningSpace:/^\s+/,endingHash:/#$/,startingSpaceChar:/^ /,endingSpaceChar:/ $/,nonSpaceChar:/[^ ]/,newLineCharGlobal:/\n/g,tabCharGlobal:/\t/g,multipleSpaceGlobal:/\s+/g,blankLine:/^[ \t]*$/,doubleBlankLine:/\n[ \t]*\n[ \t]*$/,blockquoteStart:/^ {0,3}>/,blockquoteSetextReplace:/\n {0,3}((?:=+|-+) *)(?=\n|$)/g,blockquoteSetextReplace2:/^ {0,3}>[ \t]?/gm,listReplaceTabs:/^\t+/,listReplaceNesting:/^ {1,4}(?=( {4})*[^ ])/g,listIsTask:/^\[[ xX]\] /,listReplaceTask:/^\[[ xX]\] +/,anyLine:/\n.*\n/,hrefBrackets:/^<(.*)>$/,tableDelimiter:/[:|]/,tableAlignChars:/^\||\| *$/g,tableRowBlankLine:/\n[ \t]*$/,tableAlignRight:/^ *-+: *$/,tableAlignCenter:/^ *:-+: *$/,tableAlignLeft:/^ *:-+ *$/,startATag:/^<a /i,endATag:/^<\/a>/i,startPreScriptTag:/^<(pre|code|kbd|script)(\s|>)/i,endPreScriptTag:/^<\/(pre|code|kbd|script)(\s|>)/i,startAngleBracket:/^</,endAngleBracket:/>$/,pedanticHrefTitle:/^([^'"]*[^\s])\s+(['"])(.*)\2/,unicodeAlphaNumeric:/[\p{L}\p{N}]/u,escapeTest:/[&<>"']/,escapeReplace:/[&<>"']/g,escapeTestNoEncode:/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/,escapeReplaceNoEncode:/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/g,unescapeTest:/&(#(?:\d+)|(?:#x[0-9A-Fa-f]+)|(?:\w+));?/ig,caret:/(^|[^\[])\^/g,percentDecode:/%25/g,findPipe:/\|/g,splitPipe:/ \|/,slashPipe:/\\\|/g,carriageReturn:/\r\n|\r/g,spaceLine:/^ +$/gm,notSpaceStart:/^\S*/,endingNewline:/\n$/,listItemRegex:t=>new RegExp(`^( {0,3}${t})((?:[	 ][^\\n]*)?(?:\\n|$))`),nextBulletRegex:t=>new RegExp(`^ {0,${Math.min(3,t-1)}}(?:[*+-]|\\d{1,9}[.)])((?:[ 	][^\\n]*)?(?:\\n|$))`),hrRegex:t=>new RegExp(`^ {0,${Math.min(3,t-1)}}((?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$)`),fencesBeginRegex:t=>new RegExp(`^ {0,${Math.min(3,t-1)}}(?:\`\`\`|~~~)`),headingBeginRegex:t=>new RegExp(`^ {0,${Math.min(3,t-1)}}#`),htmlBeginRegex:t=>new RegExp(`^ {0,${Math.min(3,t-1)}}<(?:[a-z].*>|!--)`,"i")},KW=/^(?:[ \t]*(?:\n|$))+/,qW=/^((?: {4}| {0,3}\t)[^\n]+(?:\n(?:[ \t]*(?:\n|$))*)?)+/,YW=/^ {0,3}(`{3,}(?=[^`\n]*(?:\n|$))|~{3,})([^\n]*)(?:\n|$)(?:|([\s\S]*?)(?:\n|$))(?: {0,3}\1[~`]* *(?=\n|$)|$)/,_c=/^ {0,3}((?:-[\t ]*){3,}|(?:_[ \t]*){3,}|(?:\*[ \t]*){3,})(?:\n+|$)/,VW=/^ {0,3}(#{1,6})(?=\s|$)(.*)(?:\n+|$)/,ym=/(?:[*+-]|\d{1,9}[.)])/,FT=/^(?!bull |blockCode|fences|blockquote|heading|html|table)((?:.|\n(?!\s*?\n|bull |blockCode|fences|blockquote|heading|html|table))+?)\n {0,3}(=+|-+) *(?:\n+|$)/,DT=yt(FT).replace(/bull/g,ym).replace(/blockCode/g,/(?: {4}| {0,3}\t)/).replace(/fences/g,/ {0,3}(?:`{3,}|~{3,})/).replace(/blockquote/g,/ {0,3}>/).replace(/heading/g,/ {0,3}#{1,6}/).replace(/html/g,/ {0,3}<[^\n>]+>\n/).replace(/\|table/g,"").getRegex(),XW=yt(FT).replace(/bull/g,ym).replace(/blockCode/g,/(?: {4}| {0,3}\t)/).replace(/fences/g,/ {0,3}(?:`{3,}|~{3,})/).replace(/blockquote/g,/ {0,3}>/).replace(/heading/g,/ {0,3}#{1,6}/).replace(/html/g,/ {0,3}<[^\n>]+>\n/).replace(/table/g,/ {0,3}\|?(?:[:\- ]*\|)+[\:\- ]*\n/).getRegex(),_m=/^([^\n]+(?:\n(?!hr|heading|lheading|blockquote|fences|list|html|table| +\n)[^\n]+)*)/,ZW=/^[^\n]+/,bm=/(?!\s*\])(?:\\[\s\S]|[^\[\]\\])+/,JW=yt(/^ {0,3}\[(label)\]: *(?:\n[ \t]*)?([^<\s][^\s]*|<.*?>)(?:(?: +(?:\n[ \t]*)?| *\n[ \t]*)(title))? *(?:\n+|$)/).replace("label",bm).replace("title",/(?:"(?:\\"?|[^"\\])*"|'[^'\n]*(?:\n[^'\n]+)*\n?'|\([^()]*\))/).getRegex(),QW=yt(/^( {0,3}bull)([ \t][^\n]+?)?(?:\n|$)/).replace(/bull/g,ym).getRegex(),ih="address|article|aside|base|basefont|blockquote|body|caption|center|col|colgroup|dd|details|dialog|dir|div|dl|dt|fieldset|figcaption|figure|footer|form|frame|frameset|h[1-6]|head|header|hr|html|iframe|legend|li|link|main|menu|menuitem|meta|nav|noframes|ol|optgroup|option|p|param|search|section|summary|table|tbody|td|tfoot|th|thead|title|tr|track|ul",wm=/<!--(?:-?>|[\s\S]*?(?:-->|$))/,eH=yt("^ {0,3}(?:<(script|pre|style|textarea)[\\s>][\\s\\S]*?(?:</\\1>[^\\n]*\\n+|$)|comment[^\\n]*(\\n+|$)|<\\?[\\s\\S]*?(?:\\?>\\n*|$)|<![A-Z][\\s\\S]*?(?:>\\n*|$)|<!\\[CDATA\\[[\\s\\S]*?(?:\\]\\]>\\n*|$)|</?(tag)(?: +|\\n|/?>)[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$)|<(?!script|pre|style|textarea)([a-z][\\w-]*)(?:attribute)*? */?>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$)|</(?!script|pre|style|textarea)[a-z][\\w-]*\\s*>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$))","i").replace("comment",wm).replace("tag",ih).replace("attribute",/ +[a-zA-Z:_][\w.:-]*(?: *= *"[^"\n]*"| *= *'[^'\n]*'| *= *[^\s"'=<>`]+)?/).getRegex(),jT=yt(_m).replace("hr",_c).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("|table","").replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",ih).getRegex(),tH=yt(/^( {0,3}> ?(paragraph|[^\n]*)(?:\n|$))+/).replace("paragraph",jT).getRegex(),km={blockquote:tH,code:qW,def:JW,fences:YW,heading:VW,hr:_c,html:eH,lheading:DT,list:QW,newline:KW,paragraph:jT,table:yc,text:ZW},zT=yt("^ *([^\\n ].*)\\n {0,3}((?:\\| *)?:?-+:? *(?:\\| *:?-+:? *)*(?:\\| *)?)(?:\\n((?:(?! *\\n|hr|heading|blockquote|code|fences|list|html).*(?:\\n|$))*)\\n*|$)").replace("hr",_c).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("blockquote"," {0,3}>").replace("code","(?: {4}| {0,3}	)[^\\n]").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",ih).getRegex(),rH={...km,lheading:XW,table:zT,paragraph:yt(_m).replace("hr",_c).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("table",zT).replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",ih).getRegex()},nH={...km,html:yt(`^ *(?:comment *(?:\\n|\\s*$)|<(tag)[\\s\\S]+?</\\1> *(?:\\n{2,}|\\s*$)|<tag(?:"[^"]*"|'[^']*'|\\s[^'"/>\\s]*)*?/?> *(?:\\n{2,}|\\s*$))`).replace("comment",wm).replace(/tag/g,"(?!(?:a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)\\b)\\w+(?!:|[^\\w\\s@]*@)\\b").getRegex(),def:/^ *\[([^\]]+)\]: *<?([^\s>]+)>?(?: +(["(][^\n]+[")]))? *(?:\n+|$)/,heading:/^(#{1,6})(.*)(?:\n+|$)/,fences:yc,lheading:/^(.+?)\n {0,3}(=+|-+) *(?:\n+|$)/,paragraph:yt(_m).replace("hr",_c).replace("heading",` *#{1,6} *[^
]`).replace("lheading",DT).replace("|table","").replace("blockquote"," {0,3}>").replace("|fences","").replace("|list","").replace("|html","").replace("|tag","").getRegex()},iH=/^\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/,sH=/^(`+)([^`]|[^`][\s\S]*?[^`])\1(?!`)/,WT=/^( {2,}|\\)\n(?!\s*$)/,oH=/^(`+|[^`])(?:(?= {2,}\n)|[\s\S]*?(?:(?=[\\<!\[`*_]|\b_|$)|[^ ](?= {2,}\n)))/,sh=/[\p{P}\p{S}]/u,vm=/[\s\p{P}\p{S}]/u,HT=/[^\s\p{P}\p{S}]/u,aH=yt(/^((?![*_])punctSpace)/,"u").replace(/punctSpace/g,vm).getRegex(),GT=/(?!~)[\p{P}\p{S}]/u,cH=/(?!~)[\s\p{P}\p{S}]/u,lH=/(?:[^\s\p{P}\p{S}]|~)/u,uH=/\[[^\[\]]*?\]\((?:\\[\s\S]|[^\\\(\)]|\((?:\\[\s\S]|[^\\\(\)])*\))*\)|`[^`]*?`|<(?! )[^<>]*?>/g,KT=/^(?:\*+(?:((?!\*)punct)|[^\s*]))|^_+(?:((?!_)punct)|([^\s_]))/,hH=yt(KT,"u").replace(/punct/g,sh).getRegex(),fH=yt(KT,"u").replace(/punct/g,GT).getRegex(),qT="^[^_*]*?__[^_*]*?\\*[^_*]*?(?=__)|[^*]+(?=[^*])|(?!\\*)punct(\\*+)(?=[\\s]|$)|notPunctSpace(\\*+)(?!\\*)(?=punctSpace|$)|(?!\\*)punctSpace(\\*+)(?=notPunctSpace)|[\\s](\\*+)(?!\\*)(?=punct)|(?!\\*)punct(\\*+)(?!\\*)(?=punct)|notPunctSpace(\\*+)(?=notPunctSpace)",dH=yt(qT,"gu").replace(/notPunctSpace/g,HT).replace(/punctSpace/g,vm).replace(/punct/g,sh).getRegex(),pH=yt(qT,"gu").replace(/notPunctSpace/g,lH).replace(/punctSpace/g,cH).replace(/punct/g,GT).getRegex(),mH=yt("^[^_*]*?\\*\\*[^_*]*?_[^_*]*?(?=\\*\\*)|[^_]+(?=[^_])|(?!_)punct(_+)(?=[\\s]|$)|notPunctSpace(_+)(?!_)(?=punctSpace|$)|(?!_)punctSpace(_+)(?=notPunctSpace)|[\\s](_+)(?!_)(?=punct)|(?!_)punct(_+)(?!_)(?=punct)","gu").replace(/notPunctSpace/g,HT).replace(/punctSpace/g,vm).replace(/punct/g,sh).getRegex(),gH=yt(/\\(punct)/,"gu").replace(/punct/g,sh).getRegex(),yH=yt(/^<(scheme:[^\s\x00-\x1f<>]*|email)>/).replace("scheme",/[a-zA-Z][a-zA-Z0-9+.-]{1,31}/).replace("email",/[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+(@)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+(?![-_])/).getRegex(),_H=yt(wm).replace("(?:-->|$)","-->").getRegex(),bH=yt("^comment|^</[a-zA-Z][\\w:-]*\\s*>|^<[a-zA-Z][\\w-]*(?:attribute)*?\\s*/?>|^<\\?[\\s\\S]*?\\?>|^<![a-zA-Z]+\\s[\\s\\S]*?>|^<!\\[CDATA\\[[\\s\\S]*?\\]\\]>").replace("comment",_H).replace("attribute",/\s+[a-zA-Z:_][\w.:-]*(?:\s*=\s*"[^"]*"|\s*=\s*'[^']*'|\s*=\s*[^\s"'=<>`]+)?/).getRegex(),oh=/(?:\[(?:\\[\s\S]|[^\[\]\\])*\]|\\[\s\S]|`[^`]*`|[^\[\]\\`])*?/,wH=yt(/^!?\[(label)\]\(\s*(href)(?:(?:[ \t]*(?:\n[ \t]*)?)(title))?\s*\)/).replace("label",oh).replace("href",/<(?:\\.|[^\n<>\\])+>|[^ \t\n\x00-\x1f]*/).replace("title",/"(?:\\"?|[^"\\])*"|'(?:\\'?|[^'\\])*'|\((?:\\\)?|[^)\\])*\)/).getRegex(),YT=yt(/^!?\[(label)\]\[(ref)\]/).replace("label",oh).replace("ref",bm).getRegex(),VT=yt(/^!?\[(ref)\](?:\[\])?/).replace("ref",bm).getRegex(),kH=yt("reflink|nolink(?!\\()","g").replace("reflink",YT).replace("nolink",VT).getRegex(),xm={_backpedal:yc,anyPunctuation:gH,autolink:yH,blockSkip:uH,br:WT,code:sH,del:yc,emStrongLDelim:hH,emStrongRDelimAst:dH,emStrongRDelimUnd:mH,escape:iH,link:wH,nolink:VT,punctuation:aH,reflink:YT,reflinkSearch:kH,tag:bH,text:oH,url:yc},vH={...xm,link:yt(/^!?\[(label)\]\((.*?)\)/).replace("label",oh).getRegex(),reflink:yt(/^!?\[(label)\]\s*\[([^\]]*)\]/).replace("label",oh).getRegex()},Em={...xm,emStrongRDelimAst:pH,emStrongLDelim:fH,url:yt(/^((?:ftp|https?):\/\/|www\.)(?:[a-zA-Z0-9\-]+\.?)+[^\s<]*|^email/,"i").replace("email",/[A-Za-z0-9._+-]+(@)[a-zA-Z0-9-_]+(?:\.[a-zA-Z0-9-_]*[a-zA-Z0-9])+(?![-_])/).getRegex(),_backpedal:/(?:[^?!.,:;*_'"~()&]+|\([^)]*\)|&(?![a-zA-Z0-9]+;$)|[?!.,:;*_'"~)]+(?!$))+/,del:/^(~~?)(?=[^\s~])((?:\\[\s\S]|[^\\])*?(?:\\[\s\S]|[^\s~\\]))\1(?=[^~]|$)/,text:/^([`~]+|[^`~])(?:(?= {2,}\n)|(?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)|[\s\S]*?(?:(?=[\\<!\[`*~_]|\b_|https?:\/\/|ftp:\/\/|www\.|$)|[^ ](?= {2,}\n)|[^a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-](?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)))/},xH={...Em,br:yt(WT).replace("{2,}","*").getRegex(),text:yt(Em.text).replace("\\b_","\\b_| {2,}\\n").replace(/\{2,\}/g,"*").getRegex()},ah={normal:km,gfm:rH,pedantic:nH},bc={normal:xm,gfm:Em,breaks:xH,pedantic:vH},EH={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},XT=t=>EH[t];function pi(t,e){if(e){if(Ur.escapeTest.test(t))return t.replace(Ur.escapeReplace,XT)}else if(Ur.escapeTestNoEncode.test(t))return t.replace(Ur.escapeReplaceNoEncode,XT);return t}function ZT(t){try{t=encodeURI(t).replace(Ur.percentDecode,"%")}catch{return null}return t}function JT(t,e){let r=t.replace(Ur.findPipe,(s,o,a)=>{let c=!1,l=o;for(;--l>=0&&a[l]==="\\";)c=!c;return c?"|":" |"}),n=r.split(Ur.splitPipe),i=0;if(n[0].trim()||n.shift(),n.length>0&&!n.at(-1)?.trim()&&n.pop(),e)if(n.length>e)n.splice(e);else for(;n.length<e;)n.push("");for(;i<n.length;i++)n[i]=n[i].trim().replace(Ur.slashPipe,"|");return n}function wc(t,e,r){let n=t.length;if(n===0)return"";let i=0;for(;i<n&&t.charAt(n-i-1)===e;)i++;return t.slice(0,n-i)}function AH(t,e){if(t.indexOf(e[1])===-1)return-1;let r=0;for(let n=0;n<t.length;n++)if(t[n]==="\\")n++;else if(t[n]===e[0])r++;else if(t[n]===e[1]&&(r--,r<0))return n;return r>0?-2:-1}function QT(t,e,r,n,i){let s=e.href,o=e.title||null,a=t[1].replace(i.other.outputLinkReplace,"$1");n.state.inLink=!0;let c={type:t[0].charAt(0)==="!"?"image":"link",raw:r,href:s,title:o,text:a,tokens:n.inlineTokens(a)};return n.state.inLink=!1,c}function TH(t,e,r){let n=t.match(r.other.indentCodeCompensation);if(n===null)return e;let i=n[1];return e.split(`
`).map(s=>{let o=s.match(r.other.beginningSpace);if(o===null)return s;let[a]=o;return a.length>=i.length?s.slice(i.length):s}).join(`
`)}var ch=class{options;rules;lexer;constructor(t){this.options=t||eo}space(t){let e=this.rules.block.newline.exec(t);if(e&&e[0].length>0)return{type:"space",raw:e[0]}}code(t){let e=this.rules.block.code.exec(t);if(e){let r=e[0].replace(this.rules.other.codeRemoveIndent,"");return{type:"code",raw:e[0],codeBlockStyle:"indented",text:this.options.pedantic?r:wc(r,`
`)}}}fences(t){let e=this.rules.block.fences.exec(t);if(e){let r=e[0],n=TH(r,e[3]||"",this.rules);return{type:"code",raw:r,lang:e[2]?e[2].trim().replace(this.rules.inline.anyPunctuation,"$1"):e[2],text:n}}}heading(t){let e=this.rules.block.heading.exec(t);if(e){let r=e[2].trim();if(this.rules.other.endingHash.test(r)){let n=wc(r,"#");(this.options.pedantic||!n||this.rules.other.endingSpaceChar.test(n))&&(r=n.trim())}return{type:"heading",raw:e[0],depth:e[1].length,text:r,tokens:this.lexer.inline(r)}}}hr(t){let e=this.rules.block.hr.exec(t);if(e)return{type:"hr",raw:wc(e[0],`
`)}}blockquote(t){let e=this.rules.block.blockquote.exec(t);if(e){let r=wc(e[0],`
`).split(`
`),n="",i="",s=[];for(;r.length>0;){let o=!1,a=[],c;for(c=0;c<r.length;c++)if(this.rules.other.blockquoteStart.test(r[c]))a.push(r[c]),o=!0;else if(!o)a.push(r[c]);else break;r=r.slice(c);let l=a.join(`
`),u=l.replace(this.rules.other.blockquoteSetextReplace,`
    $1`).replace(this.rules.other.blockquoteSetextReplace2,"");n=n?`${n}
${l}`:l,i=i?`${i}
${u}`:u;let h=this.lexer.state.top;if(this.lexer.state.top=!0,this.lexer.blockTokens(u,s,!0),this.lexer.state.top=h,r.length===0)break;let f=s.at(-1);if(f?.type==="code")break;if(f?.type==="blockquote"){let d=f,m=d.raw+`
`+r.join(`
`),p=this.blockquote(m);s[s.length-1]=p,n=n.substring(0,n.length-d.raw.length)+p.raw,i=i.substring(0,i.length-d.text.length)+p.text;break}else if(f?.type==="list"){let d=f,m=d.raw+`
`+r.join(`
`),p=this.list(m);s[s.length-1]=p,n=n.substring(0,n.length-f.raw.length)+p.raw,i=i.substring(0,i.length-d.raw.length)+p.raw,r=m.substring(s.at(-1).raw.length).split(`
`);continue}}return{type:"blockquote",raw:n,tokens:s,text:i}}}list(t){let e=this.rules.block.list.exec(t);if(e){let r=e[1].trim(),n=r.length>1,i={type:"list",raw:"",ordered:n,start:n?+r.slice(0,-1):"",loose:!1,items:[]};r=n?`\\d{1,9}\\${r.slice(-1)}`:`\\${r}`,this.options.pedantic&&(r=n?r:"[*+-]");let s=this.rules.other.listItemRegex(r),o=!1;for(;t;){let c=!1,l="",u="";if(!(e=s.exec(t))||this.rules.block.hr.test(t))break;l=e[0],t=t.substring(l.length);let h=e[2].split(`
`,1)[0].replace(this.rules.other.listReplaceTabs,y=>" ".repeat(3*y.length)),f=t.split(`
`,1)[0],d=!h.trim(),m=0;if(this.options.pedantic?(m=2,u=h.trimStart()):d?m=e[1].length+1:(m=e[2].search(this.rules.other.nonSpaceChar),m=m>4?1:m,u=h.slice(m),m+=e[1].length),d&&this.rules.other.blankLine.test(f)&&(l+=f+`
`,t=t.substring(f.length+1),c=!0),!c){let y=this.rules.other.nextBulletRegex(m),_=this.rules.other.hrRegex(m),A=this.rules.other.fencesBeginRegex(m),T=this.rules.other.headingBeginRegex(m),x=this.rules.other.htmlBeginRegex(m);for(;t;){let M=t.split(`
`,1)[0],R;if(f=M,this.options.pedantic?(f=f.replace(this.rules.other.listReplaceNesting,"  "),R=f):R=f.replace(this.rules.other.tabCharGlobal,"    "),A.test(f)||T.test(f)||x.test(f)||y.test(f)||_.test(f))break;if(R.search(this.rules.other.nonSpaceChar)>=m||!f.trim())u+=`
`+R.slice(m);else{if(d||h.replace(this.rules.other.tabCharGlobal,"    ").search(this.rules.other.nonSpaceChar)>=4||A.test(h)||T.test(h)||_.test(h))break;u+=`
`+f}!d&&!f.trim()&&(d=!0),l+=M+`
`,t=t.substring(M.length+1),h=R.slice(m)}}i.loose||(o?i.loose=!0:this.rules.other.doubleBlankLine.test(l)&&(o=!0));let p=null,g;this.options.gfm&&(p=this.rules.other.listIsTask.exec(u),p&&(g=p[0]!=="[ ] ",u=u.replace(this.rules.other.listReplaceTask,""))),i.items.push({type:"list_item",raw:l,task:!!p,checked:g,loose:!1,text:u,tokens:[]}),i.raw+=l}let a=i.items.at(-1);if(a)a.raw=a.raw.trimEnd(),a.text=a.text.trimEnd();else return;i.raw=i.raw.trimEnd();for(let c=0;c<i.items.length;c++)if(this.lexer.state.top=!1,i.items[c].tokens=this.lexer.blockTokens(i.items[c].text,[]),!i.loose){let l=i.items[c].tokens.filter(h=>h.type==="space"),u=l.length>0&&l.some(h=>this.rules.other.anyLine.test(h.raw));i.loose=u}if(i.loose)for(let c=0;c<i.items.length;c++)i.items[c].loose=!0;return i}}html(t){let e=this.rules.block.html.exec(t);if(e)return{type:"html",block:!0,raw:e[0],pre:e[1]==="pre"||e[1]==="script"||e[1]==="style",text:e[0]}}def(t){let e=this.rules.block.def.exec(t);if(e){let r=e[1].toLowerCase().replace(this.rules.other.multipleSpaceGlobal," "),n=e[2]?e[2].replace(this.rules.other.hrefBrackets,"$1").replace(this.rules.inline.anyPunctuation,"$1"):"",i=e[3]?e[3].substring(1,e[3].length-1).replace(this.rules.inline.anyPunctuation,"$1"):e[3];return{type:"def",tag:r,raw:e[0],href:n,title:i}}}table(t){let e=this.rules.block.table.exec(t);if(!e||!this.rules.other.tableDelimiter.test(e[2]))return;let r=JT(e[1]),n=e[2].replace(this.rules.other.tableAlignChars,"").split("|"),i=e[3]?.trim()?e[3].replace(this.rules.other.tableRowBlankLine,"").split(`
`):[],s={type:"table",raw:e[0],header:[],align:[],rows:[]};if(r.length===n.length){for(let o of n)this.rules.other.tableAlignRight.test(o)?s.align.push("right"):this.rules.other.tableAlignCenter.test(o)?s.align.push("center"):this.rules.other.tableAlignLeft.test(o)?s.align.push("left"):s.align.push(null);for(let o=0;o<r.length;o++)s.header.push({text:r[o],tokens:this.lexer.inline(r[o]),header:!0,align:s.align[o]});for(let o of i)s.rows.push(JT(o,s.header.length).map((a,c)=>({text:a,tokens:this.lexer.inline(a),header:!1,align:s.align[c]})));return s}}lheading(t){let e=this.rules.block.lheading.exec(t);if(e)return{type:"heading",raw:e[0],depth:e[2].charAt(0)==="="?1:2,text:e[1],tokens:this.lexer.inline(e[1])}}paragraph(t){let e=this.rules.block.paragraph.exec(t);if(e){let r=e[1].charAt(e[1].length-1)===`
`?e[1].slice(0,-1):e[1];return{type:"paragraph",raw:e[0],text:r,tokens:this.lexer.inline(r)}}}text(t){let e=this.rules.block.text.exec(t);if(e)return{type:"text",raw:e[0],text:e[0],tokens:this.lexer.inline(e[0])}}escape(t){let e=this.rules.inline.escape.exec(t);if(e)return{type:"escape",raw:e[0],text:e[1]}}tag(t){let e=this.rules.inline.tag.exec(t);if(e)return!this.lexer.state.inLink&&this.rules.other.startATag.test(e[0])?this.lexer.state.inLink=!0:this.lexer.state.inLink&&this.rules.other.endATag.test(e[0])&&(this.lexer.state.inLink=!1),!this.lexer.state.inRawBlock&&this.rules.other.startPreScriptTag.test(e[0])?this.lexer.state.inRawBlock=!0:this.lexer.state.inRawBlock&&this.rules.other.endPreScriptTag.test(e[0])&&(this.lexer.state.inRawBlock=!1),{type:"html",raw:e[0],inLink:this.lexer.state.inLink,inRawBlock:this.lexer.state.inRawBlock,block:!1,text:e[0]}}link(t){let e=this.rules.inline.link.exec(t);if(e){let r=e[2].trim();if(!this.options.pedantic&&this.rules.other.startAngleBracket.test(r)){if(!this.rules.other.endAngleBracket.test(r))return;let s=wc(r.slice(0,-1),"\\");if((r.length-s.length)%2===0)return}else{let s=AH(e[2],"()");if(s===-2)return;if(s>-1){let o=(e[0].indexOf("!")===0?5:4)+e[1].length+s;e[2]=e[2].substring(0,s),e[0]=e[0].substring(0,o).trim(),e[3]=""}}let n=e[2],i="";if(this.options.pedantic){let s=this.rules.other.pedanticHrefTitle.exec(n);s&&(n=s[1],i=s[3])}else i=e[3]?e[3].slice(1,-1):"";return n=n.trim(),this.rules.other.startAngleBracket.test(n)&&(this.options.pedantic&&!this.rules.other.endAngleBracket.test(r)?n=n.slice(1):n=n.slice(1,-1)),QT(e,{href:n&&n.replace(this.rules.inline.anyPunctuation,"$1"),title:i&&i.replace(this.rules.inline.anyPunctuation,"$1")},e[0],this.lexer,this.rules)}}reflink(t,e){let r;if((r=this.rules.inline.reflink.exec(t))||(r=this.rules.inline.nolink.exec(t))){let n=(r[2]||r[1]).replace(this.rules.other.multipleSpaceGlobal," "),i=e[n.toLowerCase()];if(!i){let s=r[0].charAt(0);return{type:"text",raw:s,text:s}}return QT(r,i,r[0],this.lexer,this.rules)}}emStrong(t,e,r=""){let n=this.rules.inline.emStrongLDelim.exec(t);if(!(!n||n[3]&&r.match(this.rules.other.unicodeAlphaNumeric))&&(!(n[1]||n[2])||!r||this.rules.inline.punctuation.exec(r))){let i=[...n[0]].length-1,s,o,a=i,c=0,l=n[0][0]==="*"?this.rules.inline.emStrongRDelimAst:this.rules.inline.emStrongRDelimUnd;for(l.lastIndex=0,e=e.slice(-1*t.length+i);(n=l.exec(e))!=null;){if(s=n[1]||n[2]||n[3]||n[4]||n[5]||n[6],!s)continue;if(o=[...s].length,n[3]||n[4]){a+=o;continue}else if((n[5]||n[6])&&i%3&&!((i+o)%3)){c+=o;continue}if(a-=o,a>0)continue;o=Math.min(o,o+a+c);let u=[...n[0]][0].length,h=t.slice(0,i+n.index+u+o);if(Math.min(i,o)%2){let d=h.slice(1,-1);return{type:"em",raw:h,text:d,tokens:this.lexer.inlineTokens(d)}}let f=h.slice(2,-2);return{type:"strong",raw:h,text:f,tokens:this.lexer.inlineTokens(f)}}}}codespan(t){let e=this.rules.inline.code.exec(t);if(e){let r=e[2].replace(this.rules.other.newLineCharGlobal," "),n=this.rules.other.nonSpaceChar.test(r),i=this.rules.other.startingSpaceChar.test(r)&&this.rules.other.endingSpaceChar.test(r);return n&&i&&(r=r.substring(1,r.length-1)),{type:"codespan",raw:e[0],text:r}}}br(t){let e=this.rules.inline.br.exec(t);if(e)return{type:"br",raw:e[0]}}del(t){let e=this.rules.inline.del.exec(t);if(e)return{type:"del",raw:e[0],text:e[2],tokens:this.lexer.inlineTokens(e[2])}}autolink(t){let e=this.rules.inline.autolink.exec(t);if(e){let r,n;return e[2]==="@"?(r=e[1],n="mailto:"+r):(r=e[1],n=r),{type:"link",raw:e[0],text:r,href:n,tokens:[{type:"text",raw:r,text:r}]}}}url(t){let e;if(e=this.rules.inline.url.exec(t)){let r,n;if(e[2]==="@")r=e[0],n="mailto:"+r;else{let i;do i=e[0],e[0]=this.rules.inline._backpedal.exec(e[0])?.[0]??"";while(i!==e[0]);r=e[0],e[1]==="www."?n="http://"+e[0]:n=e[0]}return{type:"link",raw:e[0],text:r,href:n,tokens:[{type:"text",raw:r,text:r}]}}}inlineText(t){let e=this.rules.inline.text.exec(t);if(e){let r=this.lexer.state.inRawBlock;return{type:"text",raw:e[0],text:e[0],escaped:r}}}},Fi=class jm{tokens;options;state;tokenizer;inlineQueue;constructor(e){this.tokens=[],this.tokens.links=Object.create(null),this.options=e||eo,this.options.tokenizer=this.options.tokenizer||new ch,this.tokenizer=this.options.tokenizer,this.tokenizer.options=this.options,this.tokenizer.lexer=this,this.inlineQueue=[],this.state={inLink:!1,inRawBlock:!1,top:!0};let r={other:Ur,block:ah.normal,inline:bc.normal};this.options.pedantic?(r.block=ah.pedantic,r.inline=bc.pedantic):this.options.gfm&&(r.block=ah.gfm,this.options.breaks?r.inline=bc.breaks:r.inline=bc.gfm),this.tokenizer.rules=r}static get rules(){return{block:ah,inline:bc}}static lex(e,r){return new jm(r).lex(e)}static lexInline(e,r){return new jm(r).inlineTokens(e)}lex(e){e=e.replace(Ur.carriageReturn,`
`),this.blockTokens(e,this.tokens);for(let r=0;r<this.inlineQueue.length;r++){let n=this.inlineQueue[r];this.inlineTokens(n.src,n.tokens)}return this.inlineQueue=[],this.tokens}blockTokens(e,r=[],n=!1){for(this.options.pedantic&&(e=e.replace(Ur.tabCharGlobal,"    ").replace(Ur.spaceLine,""));e;){let i;if(this.options.extensions?.block?.some(o=>(i=o.call({lexer:this},e,r))?(e=e.substring(i.raw.length),r.push(i),!0):!1))continue;if(i=this.tokenizer.space(e)){e=e.substring(i.raw.length);let o=r.at(-1);i.raw.length===1&&o!==void 0?o.raw+=`
`:r.push(i);continue}if(i=this.tokenizer.code(e)){e=e.substring(i.raw.length);let o=r.at(-1);o?.type==="paragraph"||o?.type==="text"?(o.raw+=(o.raw.endsWith(`
`)?"":`
`)+i.raw,o.text+=`
`+i.text,this.inlineQueue.at(-1).src=o.text):r.push(i);continue}if(i=this.tokenizer.fences(e)){e=e.substring(i.raw.length),r.push(i);continue}if(i=this.tokenizer.heading(e)){e=e.substring(i.raw.length),r.push(i);continue}if(i=this.tokenizer.hr(e)){e=e.substring(i.raw.length),r.push(i);continue}if(i=this.tokenizer.blockquote(e)){e=e.substring(i.raw.length),r.push(i);continue}if(i=this.tokenizer.list(e)){e=e.substring(i.raw.length),r.push(i);continue}if(i=this.tokenizer.html(e)){e=e.substring(i.raw.length),r.push(i);continue}if(i=this.tokenizer.def(e)){e=e.substring(i.raw.length);let o=r.at(-1);o?.type==="paragraph"||o?.type==="text"?(o.raw+=(o.raw.endsWith(`
`)?"":`
`)+i.raw,o.text+=`
`+i.raw,this.inlineQueue.at(-1).src=o.text):this.tokens.links[i.tag]||(this.tokens.links[i.tag]={href:i.href,title:i.title},r.push(i));continue}if(i=this.tokenizer.table(e)){e=e.substring(i.raw.length),r.push(i);continue}if(i=this.tokenizer.lheading(e)){e=e.substring(i.raw.length),r.push(i);continue}let s=e;if(this.options.extensions?.startBlock){let o=1/0,a=e.slice(1),c;this.options.extensions.startBlock.forEach(l=>{c=l.call({lexer:this},a),typeof c=="number"&&c>=0&&(o=Math.min(o,c))}),o<1/0&&o>=0&&(s=e.substring(0,o+1))}if(this.state.top&&(i=this.tokenizer.paragraph(s))){let o=r.at(-1);n&&o?.type==="paragraph"?(o.raw+=(o.raw.endsWith(`
`)?"":`
`)+i.raw,o.text+=`
`+i.text,this.inlineQueue.pop(),this.inlineQueue.at(-1).src=o.text):r.push(i),n=s.length!==e.length,e=e.substring(i.raw.length);continue}if(i=this.tokenizer.text(e)){e=e.substring(i.raw.length);let o=r.at(-1);o?.type==="text"?(o.raw+=(o.raw.endsWith(`
`)?"":`
`)+i.raw,o.text+=`
`+i.text,this.inlineQueue.pop(),this.inlineQueue.at(-1).src=o.text):r.push(i);continue}if(e){let o="Infinite loop on byte: "+e.charCodeAt(0);if(this.options.silent){console.error(o);break}else throw new Error(o)}}return this.state.top=!0,r}inline(e,r=[]){return this.inlineQueue.push({src:e,tokens:r}),r}inlineTokens(e,r=[]){let n=e,i=null;if(this.tokens.links){let a=Object.keys(this.tokens.links);if(a.length>0)for(;(i=this.tokenizer.rules.inline.reflinkSearch.exec(n))!=null;)a.includes(i[0].slice(i[0].lastIndexOf("[")+1,-1))&&(n=n.slice(0,i.index)+"["+"a".repeat(i[0].length-2)+"]"+n.slice(this.tokenizer.rules.inline.reflinkSearch.lastIndex))}for(;(i=this.tokenizer.rules.inline.anyPunctuation.exec(n))!=null;)n=n.slice(0,i.index)+"++"+n.slice(this.tokenizer.rules.inline.anyPunctuation.lastIndex);for(;(i=this.tokenizer.rules.inline.blockSkip.exec(n))!=null;)n=n.slice(0,i.index)+"["+"a".repeat(i[0].length-2)+"]"+n.slice(this.tokenizer.rules.inline.blockSkip.lastIndex);let s=!1,o="";for(;e;){s||(o=""),s=!1;let a;if(this.options.extensions?.inline?.some(l=>(a=l.call({lexer:this},e,r))?(e=e.substring(a.raw.length),r.push(a),!0):!1))continue;if(a=this.tokenizer.escape(e)){e=e.substring(a.raw.length),r.push(a);continue}if(a=this.tokenizer.tag(e)){e=e.substring(a.raw.length),r.push(a);continue}if(a=this.tokenizer.link(e)){e=e.substring(a.raw.length),r.push(a);continue}if(a=this.tokenizer.reflink(e,this.tokens.links)){e=e.substring(a.raw.length);let l=r.at(-1);a.type==="text"&&l?.type==="text"?(l.raw+=a.raw,l.text+=a.text):r.push(a);continue}if(a=this.tokenizer.emStrong(e,n,o)){e=e.substring(a.raw.length),r.push(a);continue}if(a=this.tokenizer.codespan(e)){e=e.substring(a.raw.length),r.push(a);continue}if(a=this.tokenizer.br(e)){e=e.substring(a.raw.length),r.push(a);continue}if(a=this.tokenizer.del(e)){e=e.substring(a.raw.length),r.push(a);continue}if(a=this.tokenizer.autolink(e)){e=e.substring(a.raw.length),r.push(a);continue}if(!this.state.inLink&&(a=this.tokenizer.url(e))){e=e.substring(a.raw.length),r.push(a);continue}let c=e;if(this.options.extensions?.startInline){let l=1/0,u=e.slice(1),h;this.options.extensions.startInline.forEach(f=>{h=f.call({lexer:this},u),typeof h=="number"&&h>=0&&(l=Math.min(l,h))}),l<1/0&&l>=0&&(c=e.substring(0,l+1))}if(a=this.tokenizer.inlineText(c)){e=e.substring(a.raw.length),a.raw.slice(-1)!=="_"&&(o=a.raw.slice(-1)),s=!0;let l=r.at(-1);l?.type==="text"?(l.raw+=a.raw,l.text+=a.text):r.push(a);continue}if(e){let l="Infinite loop on byte: "+e.charCodeAt(0);if(this.options.silent){console.error(l);break}else throw new Error(l)}}return r}},lh=class{options;parser;constructor(t){this.options=t||eo}space(t){return""}code({text:t,lang:e,escaped:r}){let n=(e||"").match(Ur.notSpaceStart)?.[0],i=t.replace(Ur.endingNewline,"")+`
`;return n?'<pre><code class="language-'+pi(n)+'">'+(r?i:pi(i,!0))+`</code></pre>
`:"<pre><code>"+(r?i:pi(i,!0))+`</code></pre>
`}blockquote({tokens:t}){return`<blockquote>
${this.parser.parse(t)}</blockquote>
`}html({text:t}){return t}def(t){return""}heading({tokens:t,depth:e}){return`<h${e}>${this.parser.parseInline(t)}</h${e}>
`}hr(t){return`<hr>
`}list(t){let e=t.ordered,r=t.start,n="";for(let o=0;o<t.items.length;o++){let a=t.items[o];n+=this.listitem(a)}let i=e?"ol":"ul",s=e&&r!==1?' start="'+r+'"':"";return"<"+i+s+`>
`+n+"</"+i+`>
`}listitem(t){let e="";if(t.task){let r=this.checkbox({checked:!!t.checked});t.loose?t.tokens[0]?.type==="paragraph"?(t.tokens[0].text=r+" "+t.tokens[0].text,t.tokens[0].tokens&&t.tokens[0].tokens.length>0&&t.tokens[0].tokens[0].type==="text"&&(t.tokens[0].tokens[0].text=r+" "+pi(t.tokens[0].tokens[0].text),t.tokens[0].tokens[0].escaped=!0)):t.tokens.unshift({type:"text",raw:r+" ",text:r+" ",escaped:!0}):e+=r+" "}return e+=this.parser.parse(t.tokens,!!t.loose),`<li>${e}</li>
`}checkbox({checked:t}){return"<input "+(t?'checked="" ':"")+'disabled="" type="checkbox">'}paragraph({tokens:t}){return`<p>${this.parser.parseInline(t)}</p>
`}table(t){let e="",r="";for(let i=0;i<t.header.length;i++)r+=this.tablecell(t.header[i]);e+=this.tablerow({text:r});let n="";for(let i=0;i<t.rows.length;i++){let s=t.rows[i];r="";for(let o=0;o<s.length;o++)r+=this.tablecell(s[o]);n+=this.tablerow({text:r})}return n&&(n=`<tbody>${n}</tbody>`),`<table>
<thead>
`+e+`</thead>
`+n+`</table>
`}tablerow({text:t}){return`<tr>
${t}</tr>
`}tablecell(t){let e=this.parser.parseInline(t.tokens),r=t.header?"th":"td";return(t.align?`<${r} align="${t.align}">`:`<${r}>`)+e+`</${r}>
`}strong({tokens:t}){return`<strong>${this.parser.parseInline(t)}</strong>`}em({tokens:t}){return`<em>${this.parser.parseInline(t)}</em>`}codespan({text:t}){return`<code>${pi(t,!0)}</code>`}br(t){return"<br>"}del({tokens:t}){return`<del>${this.parser.parseInline(t)}</del>`}link({href:t,title:e,tokens:r}){let n=this.parser.parseInline(r),i=ZT(t);if(i===null)return n;t=i;let s='<a href="'+t+'"';return e&&(s+=' title="'+pi(e)+'"'),s+=">"+n+"</a>",s}image({href:t,title:e,text:r,tokens:n}){n&&(r=this.parser.parseInline(n,this.parser.textRenderer));let i=ZT(t);if(i===null)return pi(r);t=i;let s=`<img src="${t}" alt="${r}"`;return e&&(s+=` title="${pi(e)}"`),s+=">",s}text(t){return"tokens"in t&&t.tokens?this.parser.parseInline(t.tokens):"escaped"in t&&t.escaped?t.text:pi(t.text)}},Am=class{strong({text:t}){return t}em({text:t}){return t}codespan({text:t}){return t}del({text:t}){return t}html({text:t}){return t}text({text:t}){return t}link({text:t}){return""+t}image({text:t}){return""+t}br(){return""}},Di=class zm{options;renderer;textRenderer;constructor(e){this.options=e||eo,this.options.renderer=this.options.renderer||new lh,this.renderer=this.options.renderer,this.renderer.options=this.options,this.renderer.parser=this,this.textRenderer=new Am}static parse(e,r){return new zm(r).parse(e)}static parseInline(e,r){return new zm(r).parseInline(e)}parse(e,r=!0){let n="";for(let i=0;i<e.length;i++){let s=e[i];if(this.options.extensions?.renderers?.[s.type]){let a=s,c=this.options.extensions.renderers[a.type].call({parser:this},a);if(c!==!1||!["space","hr","heading","code","table","blockquote","list","html","def","paragraph","text"].includes(a.type)){n+=c||"";continue}}let o=s;switch(o.type){case"space":{n+=this.renderer.space(o);continue}case"hr":{n+=this.renderer.hr(o);continue}case"heading":{n+=this.renderer.heading(o);continue}case"code":{n+=this.renderer.code(o);continue}case"table":{n+=this.renderer.table(o);continue}case"blockquote":{n+=this.renderer.blockquote(o);continue}case"list":{n+=this.renderer.list(o);continue}case"html":{n+=this.renderer.html(o);continue}case"def":{n+=this.renderer.def(o);continue}case"paragraph":{n+=this.renderer.paragraph(o);continue}case"text":{let a=o,c=this.renderer.text(a);for(;i+1<e.length&&e[i+1].type==="text";)a=e[++i],c+=`
`+this.renderer.text(a);r?n+=this.renderer.paragraph({type:"paragraph",raw:c,text:c,tokens:[{type:"text",raw:c,text:c,escaped:!0}]}):n+=c;continue}default:{let a='Token with "'+o.type+'" type was not found.';if(this.options.silent)return console.error(a),"";throw new Error(a)}}}return n}parseInline(e,r=this.renderer){let n="";for(let i=0;i<e.length;i++){let s=e[i];if(this.options.extensions?.renderers?.[s.type]){let a=this.options.extensions.renderers[s.type].call({parser:this},s);if(a!==!1||!["escape","html","link","image","strong","em","codespan","br","del","text"].includes(s.type)){n+=a||"";continue}}let o=s;switch(o.type){case"escape":{n+=r.text(o);break}case"html":{n+=r.html(o);break}case"link":{n+=r.link(o);break}case"image":{n+=r.image(o);break}case"strong":{n+=r.strong(o);break}case"em":{n+=r.em(o);break}case"codespan":{n+=r.codespan(o);break}case"br":{n+=r.br(o);break}case"del":{n+=r.del(o);break}case"text":{n+=r.text(o);break}default:{let a='Token with "'+o.type+'" type was not found.';if(this.options.silent)return console.error(a),"";throw new Error(a)}}}return n}},uh=class{options;block;constructor(t){this.options=t||eo}static passThroughHooks=new Set(["preprocess","postprocess","processAllTokens"]);preprocess(t){return t}postprocess(t){return t}processAllTokens(t){return t}provideLexer(){return this.block?Fi.lex:Fi.lexInline}provideParser(){return this.block?Di.parse:Di.parseInline}},SH=class{defaults=gm();options=this.setOptions;parse=this.parseMarkdown(!0);parseInline=this.parseMarkdown(!1);Parser=Di;Renderer=lh;TextRenderer=Am;Lexer=Fi;Tokenizer=ch;Hooks=uh;constructor(...t){this.use(...t)}walkTokens(t,e){let r=[];for(let n of t)switch(r=r.concat(e.call(this,n)),n.type){case"table":{let i=n;for(let s of i.header)r=r.concat(this.walkTokens(s.tokens,e));for(let s of i.rows)for(let o of s)r=r.concat(this.walkTokens(o.tokens,e));break}case"list":{let i=n;r=r.concat(this.walkTokens(i.items,e));break}default:{let i=n;this.defaults.extensions?.childTokens?.[i.type]?this.defaults.extensions.childTokens[i.type].forEach(s=>{let o=i[s].flat(1/0);r=r.concat(this.walkTokens(o,e))}):i.tokens&&(r=r.concat(this.walkTokens(i.tokens,e)))}}return r}use(...t){let e=this.defaults.extensions||{renderers:{},childTokens:{}};return t.forEach(r=>{let n={...r};if(n.async=this.defaults.async||n.async||!1,r.extensions&&(r.extensions.forEach(i=>{if(!i.name)throw new Error("extension name required");if("renderer"in i){let s=e.renderers[i.name];s?e.renderers[i.name]=function(...o){let a=i.renderer.apply(this,o);return a===!1&&(a=s.apply(this,o)),a}:e.renderers[i.name]=i.renderer}if("tokenizer"in i){if(!i.level||i.level!=="block"&&i.level!=="inline")throw new Error("extension level must be 'block' or 'inline'");let s=e[i.level];s?s.unshift(i.tokenizer):e[i.level]=[i.tokenizer],i.start&&(i.level==="block"?e.startBlock?e.startBlock.push(i.start):e.startBlock=[i.start]:i.level==="inline"&&(e.startInline?e.startInline.push(i.start):e.startInline=[i.start]))}"childTokens"in i&&i.childTokens&&(e.childTokens[i.name]=i.childTokens)}),n.extensions=e),r.renderer){let i=this.defaults.renderer||new lh(this.defaults);for(let s in r.renderer){if(!(s in i))throw new Error(`renderer '${s}' does not exist`);if(["options","parser"].includes(s))continue;let o=s,a=r.renderer[o],c=i[o];i[o]=(...l)=>{let u=a.apply(i,l);return u===!1&&(u=c.apply(i,l)),u||""}}n.renderer=i}if(r.tokenizer){let i=this.defaults.tokenizer||new ch(this.defaults);for(let s in r.tokenizer){if(!(s in i))throw new Error(`tokenizer '${s}' does not exist`);if(["options","rules","lexer"].includes(s))continue;let o=s,a=r.tokenizer[o],c=i[o];i[o]=(...l)=>{let u=a.apply(i,l);return u===!1&&(u=c.apply(i,l)),u}}n.tokenizer=i}if(r.hooks){let i=this.defaults.hooks||new uh;for(let s in r.hooks){if(!(s in i))throw new Error(`hook '${s}' does not exist`);if(["options","block"].includes(s))continue;let o=s,a=r.hooks[o],c=i[o];uh.passThroughHooks.has(s)?i[o]=l=>{if(this.defaults.async)return Promise.resolve(a.call(i,l)).then(h=>c.call(i,h));let u=a.call(i,l);return c.call(i,u)}:i[o]=(...l)=>{let u=a.apply(i,l);return u===!1&&(u=c.apply(i,l)),u}}n.hooks=i}if(r.walkTokens){let i=this.defaults.walkTokens,s=r.walkTokens;n.walkTokens=function(o){let a=[];return a.push(s.call(this,o)),i&&(a=a.concat(i.call(this,o))),a}}this.defaults={...this.defaults,...n}}),this}setOptions(t){return this.defaults={...this.defaults,...t},this}lexer(t,e){return Fi.lex(t,e??this.defaults)}parser(t,e){return Di.parse(t,e??this.defaults)}parseMarkdown(t){return(e,r)=>{let n={...r},i={...this.defaults,...n},s=this.onError(!!i.silent,!!i.async);if(this.defaults.async===!0&&n.async===!1)return s(new Error("marked(): The async option was set to true by an extension. Remove async: false from the parse options object to return a Promise."));if(typeof e>"u"||e===null)return s(new Error("marked(): input parameter is undefined or null"));if(typeof e!="string")return s(new Error("marked(): input parameter is of type "+Object.prototype.toString.call(e)+", string expected"));i.hooks&&(i.hooks.options=i,i.hooks.block=t);let o=i.hooks?i.hooks.provideLexer():t?Fi.lex:Fi.lexInline,a=i.hooks?i.hooks.provideParser():t?Di.parse:Di.parseInline;if(i.async)return Promise.resolve(i.hooks?i.hooks.preprocess(e):e).then(c=>o(c,i)).then(c=>i.hooks?i.hooks.processAllTokens(c):c).then(c=>i.walkTokens?Promise.all(this.walkTokens(c,i.walkTokens)).then(()=>c):c).then(c=>a(c,i)).then(c=>i.hooks?i.hooks.postprocess(c):c).catch(s);try{i.hooks&&(e=i.hooks.preprocess(e));let c=o(e,i);i.hooks&&(c=i.hooks.processAllTokens(c)),i.walkTokens&&this.walkTokens(c,i.walkTokens);let l=a(c,i);return i.hooks&&(l=i.hooks.postprocess(l)),l}catch(c){return s(c)}}}onError(t,e){return r=>{if(r.message+=`
Please report this to https://github.com/markedjs/marked.`,t){let n="<p>An error occurred:</p><pre>"+pi(r.message+"",!0)+"</pre>";return e?Promise.resolve(n):n}if(e)return Promise.reject(r);throw r}}},to=new SH;function _t(t,e){return to.parse(t,e)}_t.options=_t.setOptions=function(t){return to.setOptions(t),_t.defaults=to.defaults,BT(_t.defaults),_t},_t.getDefaults=gm,_t.defaults=eo,_t.use=function(...t){return to.use(...t),_t.defaults=to.defaults,BT(_t.defaults),_t},_t.walkTokens=function(t,e){return to.walkTokens(t,e)},_t.parseInline=to.parseInline,_t.Parser=Di,_t.parser=Di.parse,_t.Renderer=lh,_t.TextRenderer=Am,_t.Lexer=Fi,_t.lexer=Fi.lex,_t.Tokenizer=ch,_t.Hooks=uh,_t.parse=_t,_t.options,_t.setOptions,_t.use,_t.walkTokens,_t.parseInline,Di.parse,Fi.lex;const hh="$dkpurple",RH="$196",OH="$205";function eS(t,e){const r=RH.repeat(e);Ie(t,`${hh}${r}`)}function IH(t,e){const r=OH.repeat(e);Ie(t,`${hh}${r}`)}function NH(t,e){Ie(t,`${hh} ${" ".repeat(e.length)} `),eS(t,e.length+2),Ie(t,`${hh} $white${e} `),IH(t,e.length+2)}function tS(t,e,r){const n=e.split(" ");switch(Fe(n[0]??"")){case"copyit":Be(t,"refscroll",r,["",n[0]??"",n[1]??""]);break;default:{switch(Fe(n[1]??"")){case"hk":case"hotkey":Be(t,"refscroll",r,[n[0]??"",n[1]??"",n[2]??"",` ${n[3]??""} `,n[4]??""]);break;default:Be(t,"refscroll",r,[n[0]??""]);break}break}}}function as(t,e){switch(e.type){default:console.info("unknown",e);break;case"heading":NH(t,e.text),Ie(t," ");break;case"hr":Ie(t," "),eS(t,10),Ie(t," ");break;case"paragraph":for(let r=0;r<(e.tokens?.length??0);++r)w(e.tokens?.[r])&&as(t,e.tokens[r]);break;case"code":e.text.split(`
`).forEach(r=>Ie(t,r.replace(/\s+/g," ").trim()));break;case"text":Ie(t,e.text);break;case"link":{const[r,...n]=e.text.split("|").map(s=>s.trim()),i=[...n,e.href??""];tS(t,i.join(" "),r);break}case"image":tS(t,`openit ${e.href}`,`show ${e.title??e.href}`);break;case"blockquote":e.text.split(`
`).forEach(r=>{Ie(t,`$dkpurple$221$white  ${r}`)}),Ie(t," ");break;case"list":for(let r=0;r<(e.items?.length??0);++r)w(e.items?.[r])&&as(t,e.items[r]);Ie(t," ");break;case"list_item":Ie(t,` $grey$7 ${e.text}`);break}}function CH(t,e){_t.use({pedantic:!1,gfm:!0,breaks:!1,renderer:{heading(r){return as(t,r),""},blockquote(r){return as(t,r),""},hr(r){return as(t,r),""},list(r){return as(t,r),""},listitem(r){return as(t,r),""},paragraph(r){return as(t,r),""}}}),_t.parse(e)}const fh="https://bridge.zed.cafe";async function LH(t,e,r){const n=`offset=${r}&${t}=${e}`,i=new Request(`${fh}/api/v1/search/files/?${n}`);return(await(await fetch(i)).json()).data.results}async function MH(){const t=new Request(`${fh}/api/v1/get/random-file/`);return[(await(await fetch(t)).json()).data]}function UH(t){return`${fh}/static/${t}`}async function $H(t,e){const n=await(await fetch(`${fh}/zgames/${e}`)).arrayBuffer(),i=new File([n],e);mm(t,i)}function $r(t,e,r){r().catch(n=>{console.error(n),pt(t,e,"crash",n?.message)})}function PH(t){const[e,r]=t.split(":"),n=w(r);return[n?e:"self",n?r:t]}var we=typeof we<"u"?we:{},kc={},cs;for(cs in we)we.hasOwnProperty(cs)&&(kc[cs]=we[cs]);var ra=we.printErr||console.warn.bind(console);for(cs in kc)kc.hasOwnProperty(cs)&&(we[cs]=kc[cs]);var Tm=(t,e)=>{throw e};kc=null,we.arguments&&we.arguments,we.thisProgram&&(thisProgram=we.thisProgram),we.quit&&(Tm=we.quit),typeof WebAssembly!="object"&&Sm("no native wasm support detected");var dh,ph=!1,mh,rS;function nS(){var t=dh.buffer;we.HEAP8=new Int8Array(t),we.HEAPU8=rS=new Uint8Array(t)}var iS=[],sS=[],oS=[];function BH(){if(we.preRun)for(typeof we.preRun=="function"&&(we.preRun=[we.preRun]);we.preRun.length;)jH(we.preRun.shift());Rm(iS)}function FH(){Rm(sS)}function DH(){if(we.postRun)for(typeof we.postRun=="function"&&(we.postRun=[we.postRun]);we.postRun.length;)WH(we.postRun.shift());Rm(oS)}function jH(t){iS.unshift(t)}function zH(t){sS.unshift(t)}function WH(t){oS.unshift(t)}var ro=0,vc=null;function HH(t){var e;ro++,(e=we.monitorRunDependencies)===null||e===void 0||e.call(we,ro)}function GH(t){var e;if(ro--,(e=we.monitorRunDependencies)===null||e===void 0||e.call(we,ro),ro==0&&vc){var r=vc;vc=null,r()}}function Sm(t){var e;(e=we.onAbort)===null||e===void 0||e.call(we,t),t="Aborted("+t+")",ra(t),ph=!0,t+=". Build with -sASSERTIONS for more info.";var r=new WebAssembly.RuntimeError(t);throw r}function KH(){return{a:aG}}function qH(t){return fetch(t,{credentials:"same-origin"}).then(function(e){if(!e.ok)throw"failed to load wasm binary file at '"+t+"'";return e.arrayBuffer()})}function YH(t){var e=KH();function r(a,c){return _r=a.exports,dh=_r.f,nS(),zH(_r.g),GH(),_r}HH();function n(a){r(a.instance)}function i(a){return qH(t).then(function(c){var l=WebAssembly.instantiate(c,e);return l}).then(a,function(c){ra("failed to asynchronously prepare wasm: "+c),Sm(c)})}function s(){return t&&t.byteLength>0?WebAssembly.instantiate(t,e).then(n,function(a){ra("wasm compile failed: "+a)}):typeof WebAssembly.instantiateStreaming=="function"&&typeof t=="string"&&typeof fetch=="function"?fetch(t,{credentials:"same-origin"}).then(function(a){var c=WebAssembly.instantiateStreaming(a,e);return c.then(n,function(l){return ra("wasm streaming compile failed: "+l),ra("falling back to ArrayBuffer instantiation"),i(n)})}):i(n)}if(we.instantiateWasm)try{var o=we.instantiateWasm(e,r);return o}catch(a){return ra("Module.instantiateWasm callback failed with error: "+a),!1}return s(),{}}class aS{constructor(e){this.name="ExitStatus",this.message=`Program terminated with exit(${e})`,this.status=e}}var Rm=t=>{for(;t.length>0;)t.shift()(we)},cS=we.noExitRuntime||!0,VH=()=>Sm(""),lS=0,XH=()=>{cS=!1,lS=0},xc={},uS=t=>{if(t instanceof aS||t=="unwind")return mh;Tm(1,t)},hS=()=>cS||lS>0,fS=t=>{var e;mh=t,hS()||((e=we.onExit)===null||e===void 0||e.call(we,t),ph=!0),Tm(t,new aS(t))},ZH=(t,e)=>{mh=t,fS(t)},JH=ZH,QH=()=>{if(!hS())try{JH(mh)}catch(t){uS(t)}},eG=t=>{if(!ph)try{t(),QH()}catch(e){uS(e)}},tG=()=>performance.now(),rG=(t,e)=>{if(xc[t]&&(clearTimeout(xc[t].id),delete xc[t]),!e)return 0;var r=setTimeout(()=>{delete xc[t],eG(()=>dS(t,tG()))},e);return xc[t]={id:r,timeout_ms:e},0},nG=()=>2147483648,iG=(t,e)=>Math.ceil(t/e)*e,sG=t=>{var e=dh.buffer,r=(t-e.byteLength+65535)/65536|0;try{return dh.grow(r),nS(),1}catch{}},oG=t=>{var e=rS.length;t>>>=0;var r=nG();if(t>r)return!1;for(var n=1;n<=4;n*=2){var i=e*(1+.2/n);i=Math.min(i,t+100663296);var s=Math.min(r,iG(Math.max(t,i),65536)),o=sG(s);if(o)return!0}return!1},aG={c:VH,b:XH,d:rG,e:oG,a:fS},_r;we._ZSTD_isError=t=>(we._ZSTD_isError=_r.h)(t),we._ZSTD_compressBound=t=>(we._ZSTD_compressBound=_r.i)(t),we._ZSTD_createCCtx=()=>(we._ZSTD_createCCtx=_r.j)(),we._ZSTD_freeCCtx=t=>(we._ZSTD_freeCCtx=_r.k)(t),we._ZSTD_compress_usingDict=(t,e,r,n,i,s,o,a)=>(we._ZSTD_compress_usingDict=_r.l)(t,e,r,n,i,s,o,a),we._ZSTD_compress=(t,e,r,n,i)=>(we._ZSTD_compress=_r.m)(t,e,r,n,i),we._ZSTD_createDCtx=()=>(we._ZSTD_createDCtx=_r.n)(),we._ZSTD_freeDCtx=t=>(we._ZSTD_freeDCtx=_r.o)(t),we._ZSTD_getFrameContentSize=(t,e)=>(we._ZSTD_getFrameContentSize=_r.p)(t,e),we._ZSTD_decompress_usingDict=(t,e,r,n,i,s,o)=>(we._ZSTD_decompress_usingDict=_r.q)(t,e,r,n,i,s,o),we._ZSTD_decompress=(t,e,r,n)=>(we._ZSTD_decompress=_r.r)(t,e,r,n),we._malloc=t=>(we._malloc=_r.s)(t),we._free=t=>(we._free=_r.t)(t);var dS=(t,e)=>(dS=_r.v)(t,e),gh;vc=function t(){gh||pS(),gh||(vc=t)};function pS(){if(ro>0||(BH(),ro>0))return;function t(){var e;gh||(gh=!0,we.calledRun=!0,!ph&&(FH(),(e=we.onRuntimeInitialized)===null||e===void 0||e.call(we),DH()))}we.setStatus?(we.setStatus("Running..."),setTimeout(()=>{setTimeout(()=>we.setStatus(""),1),t()},1)):t()}if(we.run=pS,we.preInit)for(typeof we.preInit=="function"&&(we.preInit=[we.preInit]);we.preInit.length>0;)we.preInit.pop()();we.init=YH;var cG=function(t,e,r,n){function i(s){return s instanceof r?s:new r(function(o){o(s)})}return new(r||(r=Promise))(function(s,o){function a(u){try{l(n.next(u))}catch(h){o(h)}}function c(u){try{l(n.throw(u))}catch(h){o(h)}}function l(u){u.done?s(u.value):i(u.value).then(a,c)}l((n=n.apply(t,e||[])).next())})};const lG=new Promise(t=>{we.onRuntimeInitialized=t}),uG=()=>cG(void 0,void 0,void 0,function*(){yield lG}),mS=t=>{const e=we._ZSTD_isError;return e(t)},hG=(t,e)=>{const r=we._ZSTD_getFrameContentSize;return r(t,e)},fG=(t,e={defaultHeapSize:1024*1024})=>{const r=we._malloc,n=r(t.byteLength);we.HEAP8.set(t,n);const i=hG(n,t.byteLength),s=i===-1?e.defaultHeapSize:i,o=we._free,a=r(s);try{const c=we._ZSTD_decompress,l=c(a,s,n,t.byteLength);if(mS(l))throw new Error(`Failed to compress with code ${l}`);const u=new Uint8Array(we.HEAPU8.buffer,a,l).slice();return o(a,s),o(n,t.byteLength),u}catch(c){throw o(a,s),o(n,t.byteLength),c}},dG=t=>{const e=we._ZSTD_compressBound;return e(t)},pG=(t,e)=>{const r=dG(t.byteLength),n=we._malloc,i=n(r),s=n(t.byteLength);we.HEAP8.set(t,s);const o=we._free;try{const a=we._ZSTD_compress,c=a(i,r,s,t.byteLength,e??3);if(mS(c))throw new Error(`Failed to compress with code ${c}`);const l=new Uint8Array(we.HEAPU8.buffer,i,c).slice();return o(i,r),o(s,t.byteLength),l}catch(a){throw o(i,r),o(s,t.byteLength),a}};var mG=function(t,e,r,n){function i(s){return s instanceof r?s:new r(function(o){o(s)})}return new(r||(r=Promise))(function(s,o){function a(u){try{l(n.next(u))}catch(h){o(h)}}function c(u){try{l(n.throw(u))}catch(h){o(h)}}function l(u){u.done?s(u.value):i(u.value).then(a,c)}l((n=n.apply(t,e||[])).next())})};const gG=t=>mG(void 0,void 0,void 0,function*(){const e=new URL("/assets/zstd-CV7N7xSg.wasm",self.location.href).href;we.init(e),yield uG()});let gS=!1;async function yS(){gS||(await gG(),gS=!0)}function yG(t){const e=t.replace(/-/g,"+").replace(/_/g,"/"),r="=".repeat((4-e.length%4)%4);return e+r}function _G(t){return t.replace(/\+/g,"-").replace(/\//g,"_")}const bG=new Date("1980/09/02");async function Om(t){await yS(),console.info("saved",t);const e=new dm;for(let n=0;n<t.length;++n){const i=t[n],s=PP(i);if(s){const o=QC(s);if(w(o)){const a=pG(o,15);e.file(i.id,a,{date:bG})}}}const r=await e.generateAsync({type:"base64"});return _G(r)}async function wG(t){await yS();const e=[],r=yG(t),n=await dm.loadAsync(r,{base64:!0}),i=[];n.forEach((s,o)=>i.push(o));for(let s=0;s<i.length;++s){const o=i[s],a=await o.async("string"),c=sd(a);if(w(c)){const d=bp(c);if(w(d)){e.push(d);continue}}const l=await o.async("uint8array"),u=sd(l);if(w(u)){const d=bp(u);if(w(d)){e.push(d);continue}}const h=fG(l),f=sd(h);if(w(f)){const d=bp(f);w(d)&&e.push(d)}}return e}function kG(t,e,r,n){const i=Kt(t);if(!w(i))return;let s=0;function o(){return s}function a(l,u){Ae(u)&&(s=u,s_(e.x,e.y,r.x,r.y).forEach(h=>{const f=it(i,h);w(f)&&(f[l]=u)}))}Ie(t,`batch chars: ${e.x},${e.y} - ${r.x},${r.y}`),Ie(t,Xt),Be(t,`batch:${xo(e,r)}`,"char",[n,"charedit"],o,a);const c=Rt(t);c.scrollname="bulk set char",c.scroll=Zt(t)}function vG(t,e,r,n){const i=Kt(t);if(!w(i))return;let s=0;function o(){return s}function a(l,u){if(Ae(u)){s=u;for(let h=e.y;h<=r.y;++h)for(let f=e.x;f<=r.x;++f){const d=it(i,{x:f,y:h});w(d)&&(d[l]=u)}}}Ie(t,`batch chars: ${e.x},${e.y} - ${r.x},${r.y}`),Ie(t,Xt),Be(t,`batch:${xo(e,r)}`,"color",[n,"coloredit"],o,a);const c=Rt(t);c.scrollname="bulk set color",c.scroll=Zt(t)}function xG(t,e,r,n){const i=Kt(t);if(!w(i))return;let s=0;function o(){return s}function a(l,u){Ae(u)&&(s=u,s_(e.x,e.y,r.x,r.y).forEach(h=>{const f=it(i,h);w(f)&&(f[l]=u)}))}Ie(t,`batch chars: ${e.x},${e.y} - ${r.x},${r.y}`),Ie(t,Xt),Be(t,`batch:${xo(e,r)}`,"bg",[n,"bgedit"],o,a);const c=Rt(t);c.scrollname="bulk set bg",c.scroll=Zt(t)}function EG(t,e,r,n){const i=fr(Xe.MAIN);if(!w(i))return;const s=Kt(t);if(!w(s))return;const o=xo(e,r);Ie(t,`selected: ${e.x},${e.y} - ${r.x},${r.y}`),Ie(t,Xt),Be(t,"batch","copy elements",[`copy:${o}`,"hk","1"," 1 ","next"]),Be(t,"batch","cut elements",[`cut:${o}`,"hk","2"," 2 ","next"]),n&&Be(t,"batch","paste elements",[`paste:${o}`,"hk","3"," 3 ","next"]),Be(t,"batch","copy coords",[`copycoords:${o}`,"hk","5"," 5 "]),Be(t,"remix","remix coords",[`remix:${o}`,"hk","r"," R ","next"]),Ie(t,Xt),Be(t,"batch","set chars:",[`chars:${o}`,"hk","a"," A ","next"]),Be(t,"batch","set colors:",[`colors:${o}`,"hk","c"," C ","next"]),Be(t,"batch","set bgs:",[`bgs:${o}`,"hk","b"," B ","next"]),Ie(t,Xt),Be(t,"batch","make empty",[`empty:${o}`,"hk","0"," 0 ","next"]),Ie(t,Xt),Ie(t,"codepages:");const a=Math.min(e.x,r.x),c=Math.min(e.y,r.y),l=Math.max(e.x,r.x),u=Math.max(e.y,r.y),h=new Set;for(let d=c;d<=u;++d)for(let m=a;m<=l;++m){const p=it(s,{x:m,y:d}),g=Cx(i,p);w(g)&&!h.has(g.id)&&(h.add(g.id),Be(t,"batch",`edit @${mt(g)}`,[`pageopen:${g.id}`]))}const f=dr(Re.BOARD,s.id);Ie(t,mt(f)),Be(t,"batch",`id ${s.id}`,["","copyit",s.id]),Be(t,"batch","edit @board codepage",[`pageopen:${s.id}`])}function Im(t){return new Promise((e,r)=>{t.oncomplete=t.onsuccess=()=>e(t.result),t.onabort=t.onerror=()=>r(t.error)})}function AG(t,e){let r;const n=()=>{if(r)return r;const i=indexedDB.open(t);return i.onupgradeneeded=()=>i.result.createObjectStore(e),r=Im(i),r.then(s=>{s.onclose=()=>r=void 0},()=>{}),r};return(i,s)=>n().then(o=>s(o.transaction(e,i).objectStore(e)))}let Nm;function _S(){return Nm||(Nm=AG("keyval-store","keyval")),Nm}function bS(t,e=_S()){return e("readonly",r=>Im(r.get(t)))}function wS(t,e,r=_S()){return r("readwrite",n=>new Promise((i,s)=>{n.get(t).onsuccess=function(){try{n.put(e(this.result),t),i(Im(n.transaction))}catch(o){s(o)}}}))}function Cm(t,e){return`${t.x},${t.y},${e.x},${e.y}`}async function kS(){return bS("secretheap")}async function vS(t){return wS("secretheap",t)}async function TG(){return!!await kS()}function xS(t,e,r){const n=Math.min(e.x,r.x),i=Math.min(e.y,r.y),s=Math.max(e.x,r.x),o=Math.max(e.y,r.y),a=s-n+1,c=o-i+1,l=[],u=[];for(let h=i;h<=o;++h)for(let f=n;f<=s;++f){const d={x:f-n,y:h-i},m=it(t,{x:f,y:h});m?.category===Fr.ISOBJECT?(l.push(Sn(Pi(t,f,h))),Vt(m).name!=="player"&&u.push({...Sn(m),...d,id:"blank"})):l.push({...Sn(m),...d})}return{board:t.id,width:a,height:c,terrain:l,objects:u}}async function SG(t,e,r,n){const i=Kt(t);if(!w(i))return;const s=xS(i,e,r);switch(n){case"copyobjects":s.terrain=[];break;case"copyterrain":s.objects=[];break}await vS(()=>s)}function RG(t,e,r){const n=Cm(e,r);Ie(t,`selected: ${e.x},${e.y} - ${r.x},${r.y}`),Ie(t,Xt),Be(t,"batch","copy terrain & objects",[`copyall:${n}`,"hk","1"]),Be(t,"batch","copy objects",[`copyobjects:${n}`,"hk","2"]),Be(t,"batch","copy terrain",[`copyterrain:${n}`,"hk","3"]),Be(t,"batch","copy as text",[`copyastext:${n}`,"hk","4"]);const i=Rt(t);i.scrollname="copy",i.scroll=Zt(t)}async function OG(t,e,r,n){const i=fr(Xe.MAIN);if(!w(i))return;const s=Kt(t);if(!w(s))return;const o=xS(s,e,r);switch(n){case"cutobjects":o.terrain=[];break;case"cutterrain":o.objects=[];break}switch(n){case"cutall":{for(let a=e.y;a<=r.y;++a)for(let c=e.x;c<=r.x;++c){const l=it(s,{x:c,y:a});l?.category===Fr.ISOBJECT&&gr(s,l,i.timestamp),St(s,{x:c,y:a})}break}case"cutobjects":{for(let a=e.y;a<=r.y;++a)for(let c=e.x;c<=r.x;++c){const l=it(s,{x:c,y:a});l?.category===Fr.ISOBJECT&&gr(s,l,i.timestamp)}break}case"cutterrain":{for(let a=e.y;a<=r.y;++a)for(let c=e.x;c<=r.x;++c)St(s,{x:c,y:a});break}}await vS(()=>o)}function IG(t,e,r){const n=Cm(e,r);Ie(t,`selected: ${e.x},${e.y} - ${r.x},${r.y}`),Ie(t,Xt),Be(t,"batch","cut terrain & objects",[`cutall:${n}`,"hk","1"]),Be(t,"batch","cut objects",[`cutobjects:${n}`,"hk","2"]),Be(t,"batch","cut terrain",[`cutterrain:${n}`,"hk","3"]);const i=Rt(t);i.scrollname="cut",i.scroll=Zt(t)}async function NG(t,e,r,n){const i=Kt(t),s=await kS();if(!w(i)||!w(s))return;const o=Math.min(e.x,r.x),a=Math.min(e.y,r.y),c=Math.max(e.x,r.x),l=Math.max(e.y,r.y),u=c-o+1,h=l-a+1,f=Math.min(s.width,u),d=Math.min(s.height,h);switch(n){case"pasteall":{for(let m=0;m<d;++m)for(let p=0;p<f;++p){const g=tn({x:p,y:m},s.width);St(i,{...s.terrain[g],x:o+p,y:a+m})}for(let m=0;m<s.objects.length;++m){const p=s.objects[m];w(p.x)&&w(p.y)&&Pf(p.x,p.y,0,u-1,h-1,0)&&am(i,{...p,id:void 0,x:o+p.x,y:a+p.y})}break}case"pasteobjects":for(let m=0;m<s.objects.length;++m){const p=s.objects[m];w(p.x)&&w(p.y)&&Pf(p.x,p.y,0,u-1,h-1,0)&&am(i,{...p,id:void 0,x:o+p.x,y:a+p.y})}break;case"pasteterrain":for(let m=0;m<d;++m)for(let p=0;p<f;++p){const g=tn({x:p,y:m},s.width);St(i,{...s.terrain[g],x:o+p,y:a+m})}break;case"pasteterraintiled":for(let m=a;m<=l;++m)for(let p=o;p<=c;++p){const g=(p-o)%s.width,y=(m-a)%s.height,_=tn({x:g,y},s.width);St(i,{...s.terrain[_],x:p,y:m})}break}}function CG(t,e,r){const n=Cm(e,r);Ie(t,`selected: ${e.x},${e.y} - ${r.x},${r.y}`),Ie(t,Xt),Be(t,"batch","paste terrain & objects",[`pasteall:${n}`,"hk","1"]),Be(t,"batch","paste objects",[`pasteobjects:${n}`,"hk","2"]),Be(t,"batch","paste terrain",[`pasteterrain:${n}`,"hk","3"]),Be(t,"batch","paste terrain tiled",[`pasteterraintiled:${n}`,"hk","4"]);const i=Rt(t);i.scrollname="paste",i.scroll=Zt(t)}function Lm(t,e){return`inspect:${e?.id??$i(t,e)}`}function LG(t,e,r){const n=fr(Xe.MAIN);if(!w(n))return;const i=Kt(t);if(!w(i))return;function s(f){return e?.[f]??e?.kinddata?.[f]??0}function o(f,d){w(e)&&(e[f]=d)}const a=e.category===Fr.ISTERRAIN?"terrain":"object",c=e.name??e.kind??"ERR",l=`${e.x??-1}, ${e.y??-1}`,u=Lm(i,e);Ie(t,`${a}: ${c} ${l}`),Ie(t,Xt),Be(t,u,"color",[r,`${r}edit`],s,o);const h=Rt(t);h.scrollname=r,h.scroll=Zt(t)}function MG(t,e,r){const n=fr(Xe.MAIN);if(!w(n))return;const i=Kt(t);if(!w(i))return;function s(f){return e?.[f]??e?.kinddata?.[f]??0}function o(f,d){w(e)&&(e[f]=d)}const a=e.category===Fr.ISTERRAIN?"terrain":"object",c=e.name??e.kind??"ERR",l=`${e.x??-1}, ${e.y??-1}`,u=Lm(i,e);Ie(t,`${a}: ${c} ${l}`),Ie(t,Xt),Be(t,u,"char",[r,"charedit"],s,o);const h=Rt(t);h.scrollname="char",h.scroll=Zt(t)}function UG(t,e,r,n,i,s){const o=fr(Xe.MAIN);if(!w(o))return;function a(m){const p=n?.[m]??n?.kinddata?.[m];if(!w(p))switch(m){case"color":return 15;case"bg":return 0;case"cycle":return yg;case"collision":return We.ISWALK;case"pushable":return 0;case"breakable":return 0}return p}function c(m,p){w(n)&&(n[m]=p)}s?Ie(t,`object: ${n.name??n.kind??"ERR"} ${i.x}, ${i.y}`):Ie(t,`terrain: ${n.kind??"ERR"} ${i.x}, ${i.y}`);const l=Lm(e,n);switch(s&&Ie(t,`cycle: ${He(n,"cycle")}`),He(n,"collision")){case We.ISWALK:Ie(t,"collision: iswalk");break;case We.ISSWIM:Ie(t,"collision: isswim");break;case We.ISSOLID:Ie(t,"collision: issolid");break;case We.ISBULLET:Ie(t,"collision: isbullet");break;case We.ISGHOST:Ie(t,"collision: isghost");break}s&&Ie(t,`ispushable: ${He(n,"pushable")?"yes":"no"}`),Ie(t,`isbreakable: ${He(n,"breakable")?"yes":"no"}`),Ie(t,Xt);const h=tc(r),f=Br(h);for(let m=0;m<f.length;++m){const p=f[m];switch(p){case"char":case"cycle":case"color":case"bg":case"collision":case"pushable":case"breakable":break;default:if(ut(h[p])){const[g,y,..._]=h[p];ye(y)&&Be(t,l,y||p,[p,g,..._],a,c)}break}}Be(t,l,"copy coords",["copycoords","hk","5"," 5 "]),Ie(t,Xt),Be(t,l,`char: ${n.char??n.kinddata?.char??1}`,["char","hk","a"," A ","next"],a,c),Be(t,l,`color: ${n.color??n.kinddata?.color??15}`,["color","hk","c"," C ","next"],a,c),Be(t,l,`bg: ${n.bg??n.kinddata?.bg??0}`,["bg","hk","b"," B ","next"],a,c),Ie(t,Xt),Be(t,l,"make empty",["empty","hk","0"],a,c),Ie(t,Xt),Be(t,"batch",`edit @${mt(r)}`,[`pageopen:${r.id}`]);const d=dr(Re.BOARD,e.id);Ie(t,mt(d)),Be(t,"batch",`id ${e.id}`,["","copyit",e.id]),Be(t,"batch","edit @board codepage",[`pageopen:${e.id}`])}function $G(t,e,r,n){const i=fr(Xe.MAIN);if(!w(i))return;const s=Kt(t);if(w(s))switch(n){case"emptyall":{for(let o=e.y;o<=r.y;++o)for(let a=e.x;a<=r.x;++a){const c=it(s,{x:a,y:o});c?.category===Fr.ISOBJECT&&gr(s,c,i.timestamp),St(s,{x:a,y:o})}break}case"emptyobjects":{for(let o=e.y;o<=r.y;++o)for(let a=e.x;a<=r.x;++a){const c=it(s,{x:a,y:o});c?.category===Fr.ISOBJECT&&gr(s,c,i.timestamp)}break}case"emptyterrain":{for(let o=e.y;o<=r.y;++o)for(let a=e.x;a<=r.x;++a)St(s,{x:a,y:o});break}}}function PG(t,e,r){const n=fr(Xe.MAIN);if(!w(n))return;const i=Kt(t);if(!w(i))return;const s=xo(e,r);Ie(t,`selected: ${e.x},${e.y} - ${r.x},${r.y}`),Ie(t,Xt),Be(t,"batch","clear terrain & objects",[`emptyall:${s}`,"hk","1"]),Be(t,"batch","clear objects",[`emptyobjects:${s}`,"hk","2"]),Be(t,"batch","clear terrain",[`emptyterrain:${s}`,"hk","3"]);const o=Rt(t);o.scrollname="empty",o.scroll=Zt(t)}async function BG(t,e,r){const n=fr(Xe.MAIN),i=await TG();if(!w(n))return;const s=Kt(t);if(!w(s))return;if(hr(s),e.x===r.x&&e.y===r.y){const a=it(s,e),c=Cx(n,a);if(w(a)&&w(c)&&UG(t,s,c,a,e,Wt(a)),!a?.kind){Ie(t,`empty: ${e.x}, ${e.y}`),Ie(t,Xt),Be(t,"empty","copy coords",[`copycoords:${e.x},${e.y}`,"hk","5"," 5 "]);const l=dr(Re.BOARD,s.id);Ie(t,mt(l)),Be(t,"batch",`id ${s.id}`,["","copyit",s.id]),Be(t,"batch","edit @board codepage",[`pageopen:${s.id}`])}}else EG(t,e,r,i);const o=Rt(t);o.scrollname="inspect",o.scroll=Zt(t)}function FG(t,e){const r=dt(Xe.MAIN);if(!w(r))return;const n=Kt(e);if(!w(n))return;const i=Dr(t),s=kT(n,i.target);if(w(s))switch(i.path){case"copycoords":Rc(ce,Mr(),[s.x??0,s.y??0].join(" "));break;case"bg":case"color":LG(e,s,i.path);break;case"char":MG(e,s,i.path);break;case"empty":gr(n,s,r.timestamp);break;case"code":$r(ce,e,async()=>{const o="object",a=[n.id,s.id];$f(Oc(r.id,a),s.code??""),NR(ce,e),await Nc(800),pg(ce,e,r.id,a,o,`${s.name??s.kind??"??"} - ${r.name}`)});break;default:console.info("unknown inspect",i);break}}async function DG(t,e){const r=Kt(e);if(!w(r))return;const n=Dr(t),[i,s,o,a]=n.path.split(",").map(u=>parseFloat(u)),c={x:Math.min(i,o),y:Math.min(s,a)},l={x:Math.max(i,o),y:Math.max(s,a)};switch(n.target){case"copy":RG(e,c,l);break;case"copyall":case"copyobjects":case"copyterrain":await SG(e,c,l,n.target);break;case"copyastext":{const u=Math.min(c.x,l.x),h=Math.min(c.y,l.y),f=Math.max(c.x,l.x),d=Math.max(c.y,l.y);let m="";for(let p=h;p<=d;++p){let g=Je.ONCLEAR,y=Je.ONCLEAR;m+="";for(let _=u;_<=f;++_){const A=Pi(r,_,p),T=Vt(A);T.color!=g&&(g=T.color,m+=`$${Je[T.color]}`.toLowerCase()),T.bg!=y&&(y=T.bg,m+=`$ON${Je[T.bg]}`.toLowerCase()),m+=`$${T.char}`}m+=`
`}Rc(ce,e,m),ms(ce,e,"copied chars");break}case"cut":IG(e,c,l);break;case"cutall":case"cutobjects":case"cutterrain":await OG(e,c,l,n.target);break;case"paste":CG(e,c,l);break;case"pasteall":case"pasteobjects":case"pasteterrain":case"pasteterraintiled":await NG(e,c,l,n.target);break;case"empty":PG(e,c,l);break;case"emptyall":case"emptyobjects":case"emptyterrain":$G(e,c,l,n.target);break;case"chars":kG(e,c,l,"char");break;case"colors":vG(e,c,l,"color");break;case"bgs":xG(e,c,l,"bg");break;case"copycoords":Rc(ce,e,[i,s,o,a].join(" "));break;case"pageopen":$r(ce,e,async()=>{await Nc(800),sO(ce,e,`#pageopen ${n.path}`)});break;default:console.info("unknown batch",n);break}}async function jG(){return bS("remixconfig")}async function zG(t){return wS("remixconfig",t)}let ls={stat:"",patternsize:2,mirror:1};async function WG(t,e){const r=Kt(e);if(!w(r))return;const n=Dr(t),[i,s,o,a]=n.path.split(",").map(u=>parseFloat(u)),c={x:Math.min(i,o),y:Math.min(s,a)},l={x:Math.max(i,o),y:Math.max(s,a)};switch(n.target){case"remix":{await HG(e,c,l);break}case"remixrun":{const u=pr(ls.stat);w(u)&&AE(r.id,u.id,ls.patternsize,ls.mirror,c,l,"all"),await zG(()=>ls);break}default:console.info("unknown remix",n);break}}async function HG(t,e,r){const n=await jG();ls={...ls,...n};const i=xo(e,r);Ie(t,`selected: ${e.x},${e.y} - ${r.x},${r.y}`),Ie(t,Xt);function s(c){const{target:l}=Dr(c);return ls[l]}function o(c,l){if(Ae(l)||ye(l)){const{target:u}=Dr(c);ls[u]=l}}Be(t,"remix","source board",[`stat:${i}`,"text"],s,o),Be(t,"remix","patternsize",[`patternsize:${i}`,"number","1","5"],s,o),Be(t,"remix","mirror",[`mirror:${i}`,"number","1","8"],s,o),Ie(t,Xt),Be(t,"remix","run",[`remixrun:${i}`,"hk","r"," R "]);const a=Rt(t);a.scrollname="remix",a.scroll=Zt(t)}const GG=16,us={},yh={},KG=60;let ES=0;const na={},_h={};async function AS(t){const e=ln(),r=dt(Xe.MAIN);if(e.length&&w(r)){const n=await Om(e),i=`${t?"autosave ":""}${new Date().toISOString()} ${r.name} ${n.length} chars`;MR(Qe,Mr(),i,n)}}async function qG(){const t=ln(),e=dt(Xe.MAIN);if(t.length&&w(e)){const r=await Om(t);UR(Qe,Mr(),r)}}async function YG(){const t=ln(),e=dt(Xe.MAIN);return t.length&&w(e)?Om(t):""}const TS="$176$176$177$177$178 ZZT BRIDGE $178$177$177$176$176";function SS(t){Ie(t,`Searching ${"$6".repeat(rn(1,6))}`);const e=Rt(t);e.scrollname=TS,e.scroll=Zt(t)}function RS(t,e){for(let n=0;n<t.length;++n){const i=t[n],s=`pub: ${new Date(i.publish_date).toLocaleDateString()}`;Ie(e,`$white${i.title}`),Ie(e,`$yellow  ${i.author.join(", ")}`),Ie(e,`$dkgreen  ${i.genres.join(", ")}`),Ie(e,`$purple  ${s}`),i.screenshot&&Be(e,"zztbridge",i.screenshot,["screenshot","viewit",UH(i.screenshot)]),Be(e,"zztbridge",i.filename,["zztimport","hyperlink",`${i.letter}/${i.filename}`]),Ie(e," ")}const r=Rt(e);r.scrollname=TS,r.scroll=Zt(e)}const bh={},Qe=io("vm",["tick","second"],t=>{if(!Qe.session(t))return;const e=Mr();switch(t.target){case"operator":T7(t.player),Ft(Qe,t.player,`operator set to ${t.player}`),Qe.replynext(t,"ackoperator",!0);break;case"zsswords":{const r=dt(Xe.MAIN);Qe.replynext(t,"ackzsswords",{cli:Yp(rs.CLI),loader:Yp(rs.LOADER),runtime:Yp(rs.RUNTIME),flags:[...Br(En(t.player)),"inputmove","inputalt","inputctrl","inputshift","inputok","inputcancel","inputmenu","didshoot"],stats:["currenttick","boardid","isdark","notdark","startx","starty","over","under","camera","graphics","facing","exitnorth","exitsouth","exitwest","exiteast","timelimit","restartonzap","norestartonzap","maxplayershots","playerid","playerx","playery","thisid","thisx","thisy","senderid","senderx","sendery","item","group","party","player","pushable","collision","breakable","ispushable","notpushable","iswalk","iswalking","iswalkable","isswim","isswimming","isswimable","issolid","isbullet","isghost","isbreakable","notbreakable","p1","p2","p3","p4","p5","p6","p7","p8","p9","p10","cycle","stepx","stepy","shootx","shooty","light","lightdir","sender","arg"],kinds:[...Ds(r,Re.OBJECT).map(n=>mt(n)),...Br(jp)],altkinds:[...Ds(r,Re.TERRAIN),...Ds(r,Re.BOARD),...Ds(r,Re.PALETTE),...Ds(r,Re.CHARSET),...Ds(r,Re.LOADER)].map(n=>mt(n)),colors:[...Br(Aa)],dirs:[...Br(Hf).filter(n=>["cw","ccw","oop","rndp"].includes(n)===!1)],dirmods:["cw","ccw","oop","rndp",...Br(Fp)],exprs:["aligned","alligned","contact","blocked","any","countof","color","detect","rnd","abs","intceil","intfloor","intround","clamp","min","max","pick","pickwith","random","randomwith","run","runwith"]});break}case"books":t.player===e&&$r(Qe,t.player,async()=>{if(ut(t.data)){const[r,n]=t.data,i=await wG(r),s=i.map(o=>o.name);L7(i,n),Ft(Qe,t.player,`loading ${s.join(", ")}`),jh(Qe,t.player)}});break;case"search":$7(t.player)||jh(Qe,t.player);break;case"logout":U7(t.player),delete us[t.player],Ft(Qe,e,`player ${t.player} logout`),jh(Qe,t.player);break;case"login":lT(t.player)?(CR(Qe,t.player),us[t.player]=0,Ft(Qe,Mr(),`login from ${t.player}`),Qe.replynext(t,"acklogin",!0)):ug(Qe,t.player);break;case"local":lT(t.player)?(us[t.player]=0,Ft(Qe,Mr(),`login from ${t.player}`)):ug(Qe,t.player);break;case"doot":us[t.player]=0,yh[t.player]=yh[t.player]??0,yh[t.player]%32===0&&Ft(Qe,t.player,`$whiteactive $blue${t.player}`),++yh[t.player];break;case"input":{if(t.player.includes("local")&&!aT(t.player)&&nO(Qe,t.player),!t.player.includes("local")||aT(t.player)){const r=En(t.player),[n=Rr.NONE,i=0]=t.data??[Rr.NONE,0];ut(r.inputqueue)||(r.inputqueue=[]),n!==Rr.NONE&&r.inputqueue.push([n,i])}break}case"codewatch":if(ut(t.data)){const[r,n]=t.data,i=Oc(r,n);w(_h[i])||(_h[i]=e_(i,s=>{const[o,a]=n,c=jn(r),l=Fs(c,o);if(w(l))if(hi(l)===Re.BOARD&&w(a)){const u=At(l),h=mr(u,a);w(h)&&(h.code=s,_u(gu(s),h))}else l.code=s,MP(l)})),na[i]=na[i]??new Set,na[i].add(t.player)}break;case"coderelease":if(ut(t.data)){const[r,n]=t.data,[,i]=n,s=Oc(r,n);w(na[s])&&(na[s].delete(t.player),na[s].size===0&&(_h[s]?.(),_h[s]=void 0,ye(i)&&dT(i)))}break;case"halt":t.player===e&&yR(t.data)&&S7(t.data);break;case"tick":{j7(R7());const r=Br(bh);for(let n=0;n<r.length;++n){const i=r[n];--bh[i]}break}case"synthsend":if(ye(t.data)){const r=t.data,[n,i]=PH(r),s=bh[r];if(!w(s)||s<=0){bh[r]=2;const o=dt(Xe.MAIN);Xo(n,i,void 0,Do(o))}}break;case"second":{P7(us);const r=Object.keys(us);for(let n=0;n<r.length;++n)++us[r[n]];for(let n=0;n<r.length;++n){const i=r[n];us[i]>=GG&&Wh(Qe,i)}++ES>=KG&&(ES=0,$r(Qe,t.player,async()=>{await AS(!0)}));break}case"copyjsonfile":if(t.player===e){const r=dt(Xe.MAIN);if(w(r)&&ut(t.data)){const[n]=t.data,i=Fs(r,n);w(i)&&PR(Qe,e,i,`${mt(i)}.${Ii(i)}.json`)}}break;case"refscroll":{Bp(Ou("refscroll:menu"),n=>iE(t.player,n));const r=Rt(t.player);r.scrollname="refscroll",r.scroll=Zt(t.player);break}case"readzipfilelist":{const r=zW();Ie(t.player,"$CENTER Select Files"),Be(t.player,"zipfilelist","import selected",["importfiles"]);for(let i=0;i<r.length;++i){const[s,o]=r[i];s&&(Ie(t.player,o),Be(t.player,"zipfilelist",`[${s}]`,[Fe(o),"select","NO","0","YES","1"],a=>HW(a)?1:0,(a,c)=>{WW(a,!!c)}))}const n=Rt(t.player);n.scrollname="zipfilelist",n.scroll=Zt(t.player);break}case"fork":t.player===e&&$r(Qe,t.player,async()=>{await qG()});break;case"zztsearch":$r(Qe,t.player,async()=>{if(ut(t.data)){const[r,n]=t.data;let i=0;const s=[];for(;s.length<256;){SS(t.player);const o=await LH(r,n,i);if(i+=o.length,s.push(...o),o.length<25)break}RS(s,t.player)}});break;case"zztrandom":$r(Qe,t.player,async()=>{SS(t.player);const r=await MH();RS(r,t.player)});break;case"itchiopublish":$r(Qe,t.player,async()=>{if(t.player===e){const r=dt(Xe.MAIN);if(w(r)){const n=await YG();$R(Qe,t.player,r.name,n)}}});break;case"flush":t.player===e&&$r(Qe,t.player,async()=>{await AS()});break;case"cli":pT(t.player,t.data);break;case"clirepeatlast":z7(t.player);break;case"restart":t.player===e&&(D7(),gg(Qe,t.player));break;case"inspect":$r(Qe,t.player,async()=>{if(ut(t.data)){const[r,n]=t.data;await BG(t.player,r,n)}});break;case"loader":if(ut(t.data)){const[r,n,i,s]=t.data;switch(n){case"file":mm(t.player,s);break;case"json":if(/file:.*\.book.json/.test(i)){Ft(Qe,t.player,`loading ${i}`);const o=JSON.parse(s.json);w(o.data)&&ye(o.exported)&&(qu(o.data),Ft(Qe,t.player,`loaded ${o.exported}`))}else if(/file:.*\..*\.codepage.json/.test(i)){Ft(Qe,t.player,`loading ${i}`);const o=JSON.parse(s.json),a=dt(Xe.MAIN);w(a)&&w(o.data)&&ye(o.exported)&&(js(a,o.data),Ft(Qe,t.player,`loaded ${o.exported}`))}else hE(r,n,i,s,t.player);break;default:hE(r,n,i,s,t.player);break}}break;default:{const{target:r,path:n}=Dr(t.target);switch(Fe(r)){case"refscroll":switch(n){case"charscroll":{Be(t.player,"refscroll","char",["char","charedit"]);const i=Rt(t.player);i.scrollname="chars",i.scroll=Zt(t.player);break}case"colorscroll":{Be(t.player,"refscroll","color",["color","coloredit"]);const i=Rt(t.player);i.scrollname="colors",i.scroll=Zt(t.player);break}case"bgscroll":{Be(t.player,"refscroll","bg",["bg","bgedit"]);const i=Rt(t.player);i.scrollname="bgs",i.scroll=Zt(t.player);break}default:{$r(Qe,t.player,async()=>{const i=Ou(`refscroll:${n}`);if(w(i))Bp(Ou(`refscroll:${n}`),o=>iE(t.player,o));else{const o=Rt(t.player);o.scrollname="$7$7$7 please wait",o.scroll=["loading $7$7$7"];const a=await sW(n);CH(t.player,a)}const s=Rt(t.player);s.scrollname=n,s.scroll=Zt(t.player)});break}}break;case"batch":$r(Qe,t.player,async()=>{await DG(n,t.player)});break;case"remix":$r(Qe,t.player,async()=>{await WG(n,t.player)});break;case"empty":{const i=Dr(n);switch(i.target){case"copycoords":Rc(Qe,Mr(),i.path.split(",").join(" "));break}break}case"inspect":FG(n,t.player);break;case"touched":if(ut(t.data)){const[i,s,o]=t.data;uT({...t,target:`${s}:${o}`,data:void 0,sender:i})}break;case"zztbridge":$r(Qe,t.player,async()=>{ye(t.data)&&await $H(t.player,t.data)});break;case"zipfilelist":$r(Qe,t.player,async()=>{await GW(t.player)});break;default:{const i=Dr(n);if(Fe(i.target)==="self"||!i.path)t.target=t.target.replace("self:",""),uT(t);else{const s=dt(Xe.MAIN);Xo(i.target,i.path,void 0,Do(s))}break}}break}}},A7());function VG(){LR(Qe)}const{forward:XG}=fO(t=>{dO(t)&&postMessage(t)});onmessage=function(e){XG(e.data)},setTimeout(VG,100)})();
