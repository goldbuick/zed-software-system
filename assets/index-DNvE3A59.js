var lxe=Object.defineProperty;var uxe=t=>{throw TypeError(t)};var hxe=(t,e,n)=>e in t?lxe(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;var Qn=(t,e,n)=>hxe(t,typeof e!="symbol"?e+"":e,n);var dR=(t,e,n)=>e.has(t)?uxe("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(t):e.set(t,n);function fxe(t,e){for(var n=0;n<e.length;n++){const i=e[n];if(typeof i!="string"&&!Array.isArray(i)){for(const r in i)if(r!=="default"&&!(r in t)){const s=Object.getOwnPropertyDescriptor(i,r);s&&Object.defineProperty(t,r,s.get?s:{enumerable:!0,get:()=>i[r]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))i(r);new MutationObserver(r=>{for(const s of r)if(s.type==="childList")for(const a of s.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&i(a)}).observe(document,{childList:!0,subtree:!0});function n(r){const s={};return r.integrity&&(s.integrity=r.integrity),r.referrerPolicy&&(s.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?s.credentials="include":r.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function i(r){if(r.ep)return;r.ep=!0;const s=n(r);fetch(r.href,s)}})();var jl=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Yc(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function koe(t){if(t.__esModule)return t;var e=t.default;if(typeof e=="function"){var n=function i(){return this instanceof i?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};n.prototype=e.prototype}else n={};return Object.defineProperty(n,"__esModule",{value:!0}),Object.keys(t).forEach(function(i){var r=Object.getOwnPropertyDescriptor(t,i);Object.defineProperty(n,i,r.get?r:{enumerable:!0,get:function(){return t[i]}})}),n}var Doe={exports:{}},hB={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var dxe=Symbol.for("react.transitional.element"),pxe=Symbol.for("react.fragment");function Poe(t,e,n){var i=null;if(n!==void 0&&(i=""+n),e.key!==void 0&&(i=""+e.key),"key"in e){n={};for(var r in e)r!=="key"&&(n[r]=e[r])}else n=e;return e=n.ref,{$$typeof:dxe,type:t,key:i,ref:e!==void 0?e:null,props:n}}hB.Fragment=pxe;hB.jsx=Poe;hB.jsxs=Poe;Doe.exports=hB;var Me=Doe.exports;function mxe(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var Loe={exports:{}},Vo=Loe.exports={},Eg,Sg;function cV(){throw new Error("setTimeout has not been defined")}function lV(){throw new Error("clearTimeout has not been defined")}(function(){try{typeof setTimeout=="function"?Eg=setTimeout:Eg=cV}catch{Eg=cV}try{typeof clearTimeout=="function"?Sg=clearTimeout:Sg=lV}catch{Sg=lV}})();function Uoe(t){if(Eg===setTimeout)return setTimeout(t,0);if((Eg===cV||!Eg)&&setTimeout)return Eg=setTimeout,setTimeout(t,0);try{return Eg(t,0)}catch{try{return Eg.call(null,t,0)}catch{return Eg.call(this,t,0)}}}function gxe(t){if(Sg===clearTimeout)return clearTimeout(t);if((Sg===lV||!Sg)&&clearTimeout)return Sg=clearTimeout,clearTimeout(t);try{return Sg(t)}catch{try{return Sg.call(null,t)}catch{return Sg.call(this,t)}}}var Xv=[],zw=!1,iT,YP=-1;function vxe(){!zw||!iT||(zw=!1,iT.length?Xv=iT.concat(Xv):YP=-1,Xv.length&&Boe())}function Boe(){if(!zw){var t=Uoe(vxe);zw=!0;for(var e=Xv.length;e;){for(iT=Xv,Xv=[];++YP<e;)iT&&iT[YP].run();YP=-1,e=Xv.length}iT=null,zw=!1,gxe(t)}}Vo.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];Xv.push(new Foe(t,e)),Xv.length===1&&!zw&&Uoe(Boe)};function Foe(t,e){this.fun=t,this.array=e}Foe.prototype.run=function(){this.fun.apply(null,this.array)};Vo.title="browser";Vo.browser=!0;Vo.env={};Vo.argv=[];Vo.version="";Vo.versions={};function N_(){}Vo.on=N_;Vo.addListener=N_;Vo.once=N_;Vo.off=N_;Vo.removeListener=N_;Vo.removeAllListeners=N_;Vo.emit=N_;Vo.prependListener=N_;Vo.prependOnceListener=N_;Vo.listeners=function(t){return[]};Vo.binding=function(t){throw new Error("process.binding is not supported")};Vo.cwd=function(){return"/"};Vo.chdir=function(t){throw new Error("process.chdir is not supported")};Vo.umask=function(){return 0};var _xe=Loe.exports;const zn=mxe(_xe);/**
 * @license
 * Copyright 2010-2025 Three.js Authors
 * SPDX-License-Identifier: MIT
 */const JN="176",yxe={LEFT:0,MIDDLE:1,RIGHT:2,ROTATE:0,DOLLY:1,PAN:2},bxe={ROTATE:0,PAN:1,DOLLY_PAN:2,DOLLY_ROTATE:3},zoe=0,uV=1,Hoe=2,Exe=3,joe=0,fB=1,vM=2,em=3,Zg=0,Bc=1,dl=2,lp=0,pT=1,hV=2,fV=3,dV=4,Voe=5,nb=100,Goe=101,qoe=102,$oe=103,Woe=104,Yoe=200,Xoe=201,Koe=202,Zoe=203,lL=204,uL=205,Joe=206,Qoe=207,ece=208,tce=209,nce=210,ice=211,rce=212,sce=213,ace=214,hL=0,fL=1,dL=2,NT=3,pL=4,mL=5,gL=6,vL=7,QN=0,oce=1,cce=2,hm=0,lce=1,uce=2,hce=3,Q$=4,fce=5,dce=6,pce=7,pV="attached",mce="detached",dB=300,m_=301,Vb=302,lO=303,uO=304,vA=306,hO=1e3,np=1001,fO=1002,eo=1003,e7=1004,Sxe=1004,fw=1005,Txe=1005,Ea=1006,_M=1007,xxe=1007,Ig=1008,wxe=1008,El=1009,t7=1010,n7=1011,vC=1012,pB=1013,Jg=1014,hu=1015,lE=1016,mB=1017,gB=1018,IT=1020,i7=35902,r7=1021,s7=1022,fu=1023,_C=1026,kT=1027,vB=1028,eI=1029,a7=1030,_B=1031,Cxe=1032,tI=1033,yM=33776,bM=33777,EM=33778,SM=33779,_L=35840,yL=35841,bL=35842,EL=35843,SL=36196,TL=37492,xL=37496,wL=37808,CL=37809,AL=37810,RL=37811,ML=37812,OL=37813,NL=37814,IL=37815,kL=37816,DL=37817,PL=37818,LL=37819,UL=37820,BL=37821,TM=36492,FL=36494,zL=36495,o7=36283,HL=36284,jL=36285,VL=36286,gce=2200,vce=2201,_ce=2202,dO=2300,GL=2301,XP=2302,rT=2400,sT=2401,pO=2402,yB=2500,c7=2501,Axe=0,Rxe=1,Mxe=2,uE=3200,yce=3201,Oxe=3202,Nxe=3203,hE=0,bce=1,om="",ba="srgb",Qg="srgb-linear",mO="linear",As="srgb",Ixe=0,HS=7680,kxe=7681,Dxe=7682,Pxe=7683,Lxe=34055,Uxe=34056,Bxe=5386,Fxe=512,zxe=513,Hxe=514,jxe=515,Vxe=516,Gxe=517,qxe=518,mV=519,Ece=512,Sce=513,Tce=514,l7=515,xce=516,wce=517,Cce=518,Ace=519,gO=35044,$xe=35048,Wxe=35040,Yxe=35045,Xxe=35049,Kxe=35041,Zxe=35046,Jxe=35050,Qxe=35042,ewe="100",gV="300 es",ip=2e3,vO=2001,twe={COMPUTE:"compute",RENDER:"render"},nwe={PERSPECTIVE:"perspective",LINEAR:"linear",FLAT:"flat"},iwe={NORMAL:"normal",CENTROID:"centroid",SAMPLE:"sample",FLAT_FIRST:"flat first",FLAT_EITHER:"flat either"};class cd{addEventListener(e,n){this._listeners===void 0&&(this._listeners={});const i=this._listeners;i[e]===void 0&&(i[e]=[]),i[e].indexOf(n)===-1&&i[e].push(n)}hasEventListener(e,n){const i=this._listeners;return i===void 0?!1:i[e]!==void 0&&i[e].indexOf(n)!==-1}removeEventListener(e,n){const i=this._listeners;if(i===void 0)return;const r=i[e];if(r!==void 0){const s=r.indexOf(n);s!==-1&&r.splice(s,1)}}dispatchEvent(e){const n=this._listeners;if(n===void 0)return;const i=n[e.type];if(i!==void 0){e.target=this;const r=i.slice(0);for(let s=0,a=r.length;s<a;s++)r[s].call(this,e);e.target=null}}}const tu=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"];let lZ=1234567;const mT=Math.PI/180,yC=180/Math.PI;function ed(){const t=Math.random()*4294967295|0,e=Math.random()*4294967295|0,n=Math.random()*4294967295|0,i=Math.random()*4294967295|0;return(tu[t&255]+tu[t>>8&255]+tu[t>>16&255]+tu[t>>24&255]+"-"+tu[e&255]+tu[e>>8&255]+"-"+tu[e>>16&15|64]+tu[e>>24&255]+"-"+tu[n&63|128]+tu[n>>8&255]+"-"+tu[n>>16&255]+tu[n>>24&255]+tu[i&255]+tu[i>>8&255]+tu[i>>16&255]+tu[i>>24&255]).toLowerCase()}function Xi(t,e,n){return Math.max(e,Math.min(n,t))}function u7(t,e){return(t%e+e)%e}function rwe(t,e,n,i,r){return i+(t-e)*(r-i)/(n-e)}function swe(t,e,n){return t!==e?(n-t)/(e-t):0}function xM(t,e,n){return(1-n)*t+n*e}function awe(t,e,n,i){return xM(t,e,1-Math.exp(-n*i))}function owe(t,e=1){return e-Math.abs(u7(t,e*2)-e)}function cwe(t,e,n){return t<=e?0:t>=n?1:(t=(t-e)/(n-e),t*t*(3-2*t))}function lwe(t,e,n){return t<=e?0:t>=n?1:(t=(t-e)/(n-e),t*t*t*(t*(t*6-15)+10))}function uwe(t,e){return t+Math.floor(Math.random()*(e-t+1))}function hwe(t,e){return t+Math.random()*(e-t)}function fwe(t){return t*(.5-Math.random())}function dwe(t){t!==void 0&&(lZ=t);let e=lZ+=1831565813;return e=Math.imul(e^e>>>15,e|1),e^=e+Math.imul(e^e>>>7,e|61),((e^e>>>14)>>>0)/4294967296}function pwe(t){return t*mT}function mwe(t){return t*yC}function gwe(t){return(t&t-1)===0&&t!==0}function vwe(t){return Math.pow(2,Math.ceil(Math.log(t)/Math.LN2))}function _we(t){return Math.pow(2,Math.floor(Math.log(t)/Math.LN2))}function ywe(t,e,n,i,r){const s=Math.cos,a=Math.sin,o=s(n/2),c=a(n/2),l=s((e+i)/2),u=a((e+i)/2),h=s((e-i)/2),f=a((e-i)/2),d=s((i-e)/2),p=a((i-e)/2);switch(r){case"XYX":t.set(o*u,c*h,c*f,o*l);break;case"YZY":t.set(c*f,o*u,c*h,o*l);break;case"ZXZ":t.set(c*h,c*f,o*u,o*l);break;case"XZX":t.set(o*u,c*p,c*d,o*l);break;case"YXY":t.set(c*d,o*u,c*p,o*l);break;case"ZYZ":t.set(c*p,c*d,o*u,o*l);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+r)}}function th(t,e){switch(e.constructor){case Float32Array:return t;case Uint32Array:return t/4294967295;case Uint16Array:return t/65535;case Uint8Array:return t/255;case Int32Array:return Math.max(t/2147483647,-1);case Int16Array:return Math.max(t/32767,-1);case Int8Array:return Math.max(t/127,-1);default:throw new Error("Invalid component type.")}}function tr(t,e){switch(e.constructor){case Float32Array:return t;case Uint32Array:return Math.round(t*4294967295);case Uint16Array:return Math.round(t*65535);case Uint8Array:return Math.round(t*255);case Int32Array:return Math.round(t*2147483647);case Int16Array:return Math.round(t*32767);case Int8Array:return Math.round(t*127);default:throw new Error("Invalid component type.")}}const Rce={DEG2RAD:mT,RAD2DEG:yC,generateUUID:ed,clamp:Xi,euclideanModulo:u7,mapLinear:rwe,inverseLerp:swe,lerp:xM,damp:awe,pingpong:owe,smoothstep:cwe,smootherstep:lwe,randInt:uwe,randFloat:hwe,randFloatSpread:fwe,seededRandom:dwe,degToRad:pwe,radToDeg:mwe,isPowerOfTwo:gwe,ceilPowerOfTwo:vwe,floorPowerOfTwo:_we,setQuaternionFromProperEuler:ywe,normalize:tr,denormalize:th};class Rt{constructor(e=0,n=0){Rt.prototype.isVector2=!0,this.x=e,this.y=n}get width(){return this.x}set width(e){this.x=e}get height(){return this.y}set height(e){this.y=e}set(e,n){return this.x=e,this.y=n,this}setScalar(e){return this.x=e,this.y=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setComponent(e,n){switch(e){case 0:this.x=n;break;case 1:this.y=n;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y)}copy(e){return this.x=e.x,this.y=e.y,this}add(e){return this.x+=e.x,this.y+=e.y,this}addScalar(e){return this.x+=e,this.y+=e,this}addVectors(e,n){return this.x=e.x+n.x,this.y=e.y+n.y,this}addScaledVector(e,n){return this.x+=e.x*n,this.y+=e.y*n,this}sub(e){return this.x-=e.x,this.y-=e.y,this}subScalar(e){return this.x-=e,this.y-=e,this}subVectors(e,n){return this.x=e.x-n.x,this.y=e.y-n.y,this}multiply(e){return this.x*=e.x,this.y*=e.y,this}multiplyScalar(e){return this.x*=e,this.y*=e,this}divide(e){return this.x/=e.x,this.y/=e.y,this}divideScalar(e){return this.multiplyScalar(1/e)}applyMatrix3(e){const n=this.x,i=this.y,r=e.elements;return this.x=r[0]*n+r[3]*i+r[6],this.y=r[1]*n+r[4]*i+r[7],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this}clamp(e,n){return this.x=Xi(this.x,e.x,n.x),this.y=Xi(this.y,e.y,n.y),this}clampScalar(e,n){return this.x=Xi(this.x,e,n),this.y=Xi(this.y,e,n),this}clampLength(e,n){const i=this.length();return this.divideScalar(i||1).multiplyScalar(Xi(i,e,n))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(e){return this.x*e.x+this.y*e.y}cross(e){return this.x*e.y-this.y*e.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}angleTo(e){const n=Math.sqrt(this.lengthSq()*e.lengthSq());if(n===0)return Math.PI/2;const i=this.dot(e)/n;return Math.acos(Xi(i,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const n=this.x-e.x,i=this.y-e.y;return n*n+i*i}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,n){return this.x+=(e.x-this.x)*n,this.y+=(e.y-this.y)*n,this}lerpVectors(e,n,i){return this.x=e.x+(n.x-e.x)*i,this.y=e.y+(n.y-e.y)*i,this}equals(e){return e.x===this.x&&e.y===this.y}fromArray(e,n=0){return this.x=e[n],this.y=e[n+1],this}toArray(e=[],n=0){return e[n]=this.x,e[n+1]=this.y,e}fromBufferAttribute(e,n){return this.x=e.getX(n),this.y=e.getY(n),this}rotateAround(e,n){const i=Math.cos(n),r=Math.sin(n),s=this.x-e.x,a=this.y-e.y;return this.x=s*i-a*r+e.x,this.y=s*r+a*i+e.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}}class Ji{constructor(e,n,i,r,s,a,o,c,l){Ji.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1],e!==void 0&&this.set(e,n,i,r,s,a,o,c,l)}set(e,n,i,r,s,a,o,c,l){const u=this.elements;return u[0]=e,u[1]=r,u[2]=o,u[3]=n,u[4]=s,u[5]=c,u[6]=i,u[7]=a,u[8]=l,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(e){const n=this.elements,i=e.elements;return n[0]=i[0],n[1]=i[1],n[2]=i[2],n[3]=i[3],n[4]=i[4],n[5]=i[5],n[6]=i[6],n[7]=i[7],n[8]=i[8],this}extractBasis(e,n,i){return e.setFromMatrix3Column(this,0),n.setFromMatrix3Column(this,1),i.setFromMatrix3Column(this,2),this}setFromMatrix4(e){const n=e.elements;return this.set(n[0],n[4],n[8],n[1],n[5],n[9],n[2],n[6],n[10]),this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,n){const i=e.elements,r=n.elements,s=this.elements,a=i[0],o=i[3],c=i[6],l=i[1],u=i[4],h=i[7],f=i[2],d=i[5],p=i[8],g=r[0],y=r[3],v=r[6],b=r[1],T=r[4],x=r[7],M=r[2],R=r[5],I=r[8];return s[0]=a*g+o*b+c*M,s[3]=a*y+o*T+c*R,s[6]=a*v+o*x+c*I,s[1]=l*g+u*b+h*M,s[4]=l*y+u*T+h*R,s[7]=l*v+u*x+h*I,s[2]=f*g+d*b+p*M,s[5]=f*y+d*T+p*R,s[8]=f*v+d*x+p*I,this}multiplyScalar(e){const n=this.elements;return n[0]*=e,n[3]*=e,n[6]*=e,n[1]*=e,n[4]*=e,n[7]*=e,n[2]*=e,n[5]*=e,n[8]*=e,this}determinant(){const e=this.elements,n=e[0],i=e[1],r=e[2],s=e[3],a=e[4],o=e[5],c=e[6],l=e[7],u=e[8];return n*a*u-n*o*l-i*s*u+i*o*c+r*s*l-r*a*c}invert(){const e=this.elements,n=e[0],i=e[1],r=e[2],s=e[3],a=e[4],o=e[5],c=e[6],l=e[7],u=e[8],h=u*a-o*l,f=o*c-u*s,d=l*s-a*c,p=n*h+i*f+r*d;if(p===0)return this.set(0,0,0,0,0,0,0,0,0);const g=1/p;return e[0]=h*g,e[1]=(r*l-u*i)*g,e[2]=(o*i-r*a)*g,e[3]=f*g,e[4]=(u*n-r*c)*g,e[5]=(r*s-o*n)*g,e[6]=d*g,e[7]=(i*c-l*n)*g,e[8]=(a*n-i*s)*g,this}transpose(){let e;const n=this.elements;return e=n[1],n[1]=n[3],n[3]=e,e=n[2],n[2]=n[6],n[6]=e,e=n[5],n[5]=n[7],n[7]=e,this}getNormalMatrix(e){return this.setFromMatrix4(e).invert().transpose()}transposeIntoArray(e){const n=this.elements;return e[0]=n[0],e[1]=n[3],e[2]=n[6],e[3]=n[1],e[4]=n[4],e[5]=n[7],e[6]=n[2],e[7]=n[5],e[8]=n[8],this}setUvTransform(e,n,i,r,s,a,o){const c=Math.cos(s),l=Math.sin(s);return this.set(i*c,i*l,-i*(c*a+l*o)+a+e,-r*l,r*c,-r*(-l*a+c*o)+o+n,0,0,1),this}scale(e,n){return this.premultiply(k8.makeScale(e,n)),this}rotate(e){return this.premultiply(k8.makeRotation(-e)),this}translate(e,n){return this.premultiply(k8.makeTranslation(e,n)),this}makeTranslation(e,n){return e.isVector2?this.set(1,0,e.x,0,1,e.y,0,0,1):this.set(1,0,e,0,1,n,0,0,1),this}makeRotation(e){const n=Math.cos(e),i=Math.sin(e);return this.set(n,-i,0,i,n,0,0,0,1),this}makeScale(e,n){return this.set(e,0,0,0,n,0,0,0,1),this}equals(e){const n=this.elements,i=e.elements;for(let r=0;r<9;r++)if(n[r]!==i[r])return!1;return!0}fromArray(e,n=0){for(let i=0;i<9;i++)this.elements[i]=e[i+n];return this}toArray(e=[],n=0){const i=this.elements;return e[n]=i[0],e[n+1]=i[1],e[n+2]=i[2],e[n+3]=i[3],e[n+4]=i[4],e[n+5]=i[5],e[n+6]=i[6],e[n+7]=i[7],e[n+8]=i[8],e}clone(){return new this.constructor().fromArray(this.elements)}}const k8=new Ji;function Mce(t){for(let e=t.length-1;e>=0;--e)if(t[e]>=65535)return!0;return!1}const bwe={Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array};function dw(t,e){return new bwe[t](e)}function _O(t){return document.createElementNS("http://www.w3.org/1999/xhtml",t)}function Oce(){const t=_O("canvas");return t.style.display="block",t}const uZ={};function KP(t){t in uZ||(uZ[t]=!0,console.warn(t))}function Ewe(t,e,n){return new Promise(function(i,r){function s(){switch(t.clientWaitSync(e,t.SYNC_FLUSH_COMMANDS_BIT,0)){case t.WAIT_FAILED:r();break;case t.TIMEOUT_EXPIRED:setTimeout(s,n);break;default:i()}}setTimeout(s,n)})}function Swe(t){const e=t.elements;e[2]=.5*e[2]+.5*e[3],e[6]=.5*e[6]+.5*e[7],e[10]=.5*e[10]+.5*e[11],e[14]=.5*e[14]+.5*e[15]}function Twe(t){const e=t.elements;e[11]===-1?(e[10]=-e[10]-1,e[14]=-e[14]):(e[10]=-e[10],e[14]=-e[14]+1)}const hZ=new Ji().set(.4123908,.3575843,.1804808,.212639,.7151687,.0721923,.0193308,.1191948,.9505322),fZ=new Ji().set(3.2409699,-1.5373832,-.4986108,-.9692436,1.8759675,.0415551,.0556301,-.203977,1.0569715);function xwe(){const t={enabled:!0,workingColorSpace:Qg,spaces:{},convert:function(r,s,a){return this.enabled===!1||s===a||!s||!a||(this.spaces[s].transfer===As&&(r.r=a_(r.r),r.g=a_(r.g),r.b=a_(r.b)),this.spaces[s].primaries!==this.spaces[a].primaries&&(r.applyMatrix3(this.spaces[s].toXYZ),r.applyMatrix3(this.spaces[a].fromXYZ)),this.spaces[a].transfer===As&&(r.r=Hw(r.r),r.g=Hw(r.g),r.b=Hw(r.b))),r},fromWorkingColorSpace:function(r,s){return this.convert(r,this.workingColorSpace,s)},toWorkingColorSpace:function(r,s){return this.convert(r,s,this.workingColorSpace)},getPrimaries:function(r){return this.spaces[r].primaries},getTransfer:function(r){return r===om?mO:this.spaces[r].transfer},getLuminanceCoefficients:function(r,s=this.workingColorSpace){return r.fromArray(this.spaces[s].luminanceCoefficients)},define:function(r){Object.assign(this.spaces,r)},_getMatrix:function(r,s,a){return r.copy(this.spaces[s].toXYZ).multiply(this.spaces[a].fromXYZ)},_getDrawingBufferColorSpace:function(r){return this.spaces[r].outputColorSpaceConfig.drawingBufferColorSpace},_getUnpackColorSpace:function(r=this.workingColorSpace){return this.spaces[r].workingColorSpaceConfig.unpackColorSpace}},e=[.64,.33,.3,.6,.15,.06],n=[.2126,.7152,.0722],i=[.3127,.329];return t.define({[Qg]:{primaries:e,whitePoint:i,transfer:mO,toXYZ:hZ,fromXYZ:fZ,luminanceCoefficients:n,workingColorSpaceConfig:{unpackColorSpace:ba},outputColorSpaceConfig:{drawingBufferColorSpace:ba}},[ba]:{primaries:e,whitePoint:i,transfer:As,toXYZ:hZ,fromXYZ:fZ,luminanceCoefficients:n,outputColorSpaceConfig:{drawingBufferColorSpace:ba}}}),t}const Ur=xwe();function a_(t){return t<.04045?t*.0773993808:Math.pow(t*.9478672986+.0521327014,2.4)}function Hw(t){return t<.0031308?t*12.92:1.055*Math.pow(t,.41666)-.055}let px;class Nce{static getDataURL(e,n="image/png"){if(/^data:/i.test(e.src)||typeof HTMLCanvasElement>"u")return e.src;let i;if(e instanceof HTMLCanvasElement)i=e;else{px===void 0&&(px=_O("canvas")),px.width=e.width,px.height=e.height;const r=px.getContext("2d");e instanceof ImageData?r.putImageData(e,0,0):r.drawImage(e,0,0,e.width,e.height),i=px}return i.toDataURL(n)}static sRGBToLinear(e){if(typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&e instanceof ImageBitmap){const n=_O("canvas");n.width=e.width,n.height=e.height;const i=n.getContext("2d");i.drawImage(e,0,0,e.width,e.height);const r=i.getImageData(0,0,e.width,e.height),s=r.data;for(let a=0;a<s.length;a++)s[a]=a_(s[a]/255)*255;return i.putImageData(r,0,0),n}else if(e.data){const n=e.data.slice(0);for(let i=0;i<n.length;i++)n instanceof Uint8Array||n instanceof Uint8ClampedArray?n[i]=Math.floor(a_(n[i]/255)*255):n[i]=a_(n[i]);return{data:n,width:e.width,height:e.height}}else return console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),e}}let wwe=0,ub=class{constructor(e=null){this.isSource=!0,Object.defineProperty(this,"id",{value:wwe++}),this.uuid=ed(),this.data=e,this.dataReady=!0,this.version=0}set needsUpdate(e){e===!0&&this.version++}toJSON(e){const n=e===void 0||typeof e=="string";if(!n&&e.images[this.uuid]!==void 0)return e.images[this.uuid];const i={uuid:this.uuid,url:""},r=this.data;if(r!==null){let s;if(Array.isArray(r)){s=[];for(let a=0,o=r.length;a<o;a++)r[a].isDataTexture?s.push(D8(r[a].image)):s.push(D8(r[a]))}else s=D8(r);i.url=s}return n||(e.images[this.uuid]=i),i}};function D8(t){return typeof HTMLImageElement<"u"&&t instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&t instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&t instanceof ImageBitmap?Nce.getDataURL(t):t.data?{data:Array.from(t.data),width:t.width,height:t.height,type:t.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}let Cwe=0;class Ba extends cd{constructor(e=Ba.DEFAULT_IMAGE,n=Ba.DEFAULT_MAPPING,i=np,r=np,s=Ea,a=Ig,o=fu,c=El,l=Ba.DEFAULT_ANISOTROPY,u=om){super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:Cwe++}),this.uuid=ed(),this.name="",this.source=new ub(e),this.mipmaps=[],this.mapping=n,this.channel=0,this.wrapS=i,this.wrapT=r,this.magFilter=s,this.minFilter=a,this.anisotropy=l,this.format=o,this.internalFormat=null,this.type=c,this.offset=new Rt(0,0),this.repeat=new Rt(1,1),this.center=new Rt(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new Ji,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.colorSpace=u,this.userData={},this.version=0,this.onUpdate=null,this.renderTarget=null,this.isRenderTargetTexture=!1,this.isTextureArray=!1,this.pmremVersion=0}get image(){return this.source.data}set image(e=null){this.source.data=e}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return new this.constructor().copy(this)}copy(e){return this.name=e.name,this.source=e.source,this.mipmaps=e.mipmaps.slice(0),this.mapping=e.mapping,this.channel=e.channel,this.wrapS=e.wrapS,this.wrapT=e.wrapT,this.magFilter=e.magFilter,this.minFilter=e.minFilter,this.anisotropy=e.anisotropy,this.format=e.format,this.internalFormat=e.internalFormat,this.type=e.type,this.offset.copy(e.offset),this.repeat.copy(e.repeat),this.center.copy(e.center),this.rotation=e.rotation,this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrix.copy(e.matrix),this.generateMipmaps=e.generateMipmaps,this.premultiplyAlpha=e.premultiplyAlpha,this.flipY=e.flipY,this.unpackAlignment=e.unpackAlignment,this.colorSpace=e.colorSpace,this.renderTarget=e.renderTarget,this.isRenderTargetTexture=e.isRenderTargetTexture,this.isTextureArray=e.isTextureArray,this.userData=JSON.parse(JSON.stringify(e.userData)),this.needsUpdate=!0,this}toJSON(e){const n=e===void 0||typeof e=="string";if(!n&&e.textures[this.uuid]!==void 0)return e.textures[this.uuid];const i={metadata:{version:4.6,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(e).uuid,mapping:this.mapping,channel:this.channel,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,internalFormat:this.internalFormat,type:this.type,colorSpace:this.colorSpace,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,generateMipmaps:this.generateMipmaps,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return Object.keys(this.userData).length>0&&(i.userData=this.userData),n||(e.textures[this.uuid]=i),i}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(e){if(this.mapping!==dB)return e;if(e.applyMatrix3(this.matrix),e.x<0||e.x>1)switch(this.wrapS){case hO:e.x=e.x-Math.floor(e.x);break;case np:e.x=e.x<0?0:1;break;case fO:Math.abs(Math.floor(e.x)%2)===1?e.x=Math.ceil(e.x)-e.x:e.x=e.x-Math.floor(e.x);break}if(e.y<0||e.y>1)switch(this.wrapT){case hO:e.y=e.y-Math.floor(e.y);break;case np:e.y=e.y<0?0:1;break;case fO:Math.abs(Math.floor(e.y)%2)===1?e.y=Math.ceil(e.y)-e.y:e.y=e.y-Math.floor(e.y);break}return this.flipY&&(e.y=1-e.y),e}set needsUpdate(e){e===!0&&(this.version++,this.source.needsUpdate=!0)}set needsPMREMUpdate(e){e===!0&&this.pmremVersion++}}Ba.DEFAULT_IMAGE=null;Ba.DEFAULT_MAPPING=dB;Ba.DEFAULT_ANISOTROPY=1;class Zr{constructor(e=0,n=0,i=0,r=1){Zr.prototype.isVector4=!0,this.x=e,this.y=n,this.z=i,this.w=r}get width(){return this.z}set width(e){this.z=e}get height(){return this.w}set height(e){this.w=e}set(e,n,i,r){return this.x=e,this.y=n,this.z=i,this.w=r,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this.w=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setW(e){return this.w=e,this}setComponent(e,n){switch(e){case 0:this.x=n;break;case 1:this.y=n;break;case 2:this.z=n;break;case 3:this.w=n;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=e.w!==void 0?e.w:1,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this}addVectors(e,n){return this.x=e.x+n.x,this.y=e.y+n.y,this.z=e.z+n.z,this.w=e.w+n.w,this}addScaledVector(e,n){return this.x+=e.x*n,this.y+=e.y*n,this.z+=e.z*n,this.w+=e.w*n,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this}subVectors(e,n){return this.x=e.x-n.x,this.y=e.y-n.y,this.z=e.z-n.z,this.w=e.w-n.w,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this.w*=e.w,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this}applyMatrix4(e){const n=this.x,i=this.y,r=this.z,s=this.w,a=e.elements;return this.x=a[0]*n+a[4]*i+a[8]*r+a[12]*s,this.y=a[1]*n+a[5]*i+a[9]*r+a[13]*s,this.z=a[2]*n+a[6]*i+a[10]*r+a[14]*s,this.w=a[3]*n+a[7]*i+a[11]*r+a[15]*s,this}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this.w/=e.w,this}divideScalar(e){return this.multiplyScalar(1/e)}setAxisAngleFromQuaternion(e){this.w=2*Math.acos(e.w);const n=Math.sqrt(1-e.w*e.w);return n<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/n,this.y=e.y/n,this.z=e.z/n),this}setAxisAngleFromRotationMatrix(e){let n,i,r,s;const c=e.elements,l=c[0],u=c[4],h=c[8],f=c[1],d=c[5],p=c[9],g=c[2],y=c[6],v=c[10];if(Math.abs(u-f)<.01&&Math.abs(h-g)<.01&&Math.abs(p-y)<.01){if(Math.abs(u+f)<.1&&Math.abs(h+g)<.1&&Math.abs(p+y)<.1&&Math.abs(l+d+v-3)<.1)return this.set(1,0,0,0),this;n=Math.PI;const T=(l+1)/2,x=(d+1)/2,M=(v+1)/2,R=(u+f)/4,I=(h+g)/4,k=(p+y)/4;return T>x&&T>M?T<.01?(i=0,r=.707106781,s=.707106781):(i=Math.sqrt(T),r=R/i,s=I/i):x>M?x<.01?(i=.707106781,r=0,s=.707106781):(r=Math.sqrt(x),i=R/r,s=k/r):M<.01?(i=.707106781,r=.707106781,s=0):(s=Math.sqrt(M),i=I/s,r=k/s),this.set(i,r,s,n),this}let b=Math.sqrt((y-p)*(y-p)+(h-g)*(h-g)+(f-u)*(f-u));return Math.abs(b)<.001&&(b=1),this.x=(y-p)/b,this.y=(h-g)/b,this.z=(f-u)/b,this.w=Math.acos((l+d+v-1)/2),this}setFromMatrixPosition(e){const n=e.elements;return this.x=n[12],this.y=n[13],this.z=n[14],this.w=n[15],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this}clamp(e,n){return this.x=Xi(this.x,e.x,n.x),this.y=Xi(this.y,e.y,n.y),this.z=Xi(this.z,e.z,n.z),this.w=Xi(this.w,e.w,n.w),this}clampScalar(e,n){return this.x=Xi(this.x,e,n),this.y=Xi(this.y,e,n),this.z=Xi(this.z,e,n),this.w=Xi(this.w,e,n),this}clampLength(e,n){const i=this.length();return this.divideScalar(i||1).multiplyScalar(Xi(i,e,n))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this.w=Math.trunc(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,n){return this.x+=(e.x-this.x)*n,this.y+=(e.y-this.y)*n,this.z+=(e.z-this.z)*n,this.w+=(e.w-this.w)*n,this}lerpVectors(e,n,i){return this.x=e.x+(n.x-e.x)*i,this.y=e.y+(n.y-e.y)*i,this.z=e.z+(n.z-e.z)*i,this.w=e.w+(n.w-e.w)*i,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w}fromArray(e,n=0){return this.x=e[n],this.y=e[n+1],this.z=e[n+2],this.w=e[n+3],this}toArray(e=[],n=0){return e[n]=this.x,e[n+1]=this.y,e[n+2]=this.z,e[n+3]=this.w,e}fromBufferAttribute(e,n){return this.x=e.getX(n),this.y=e.getY(n),this.z=e.getZ(n),this.w=e.getW(n),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}}class bB extends cd{constructor(e=1,n=1,i={}){super(),this.isRenderTarget=!0,this.width=e,this.height=n,this.depth=i.depth?i.depth:1,this.scissor=new Zr(0,0,e,n),this.scissorTest=!1,this.viewport=new Zr(0,0,e,n);const r={width:e,height:n,depth:this.depth};i=Object.assign({generateMipmaps:!1,internalFormat:null,minFilter:Ea,depthBuffer:!0,stencilBuffer:!1,resolveDepthBuffer:!0,resolveStencilBuffer:!0,depthTexture:null,samples:0,count:1,multiview:!1},i);const s=new Ba(r,i.mapping,i.wrapS,i.wrapT,i.magFilter,i.minFilter,i.format,i.type,i.anisotropy,i.colorSpace);s.flipY=!1,s.generateMipmaps=i.generateMipmaps,s.internalFormat=i.internalFormat,this.textures=[];const a=i.count;for(let o=0;o<a;o++)this.textures[o]=s.clone(),this.textures[o].isRenderTargetTexture=!0,this.textures[o].renderTarget=this;this.depthBuffer=i.depthBuffer,this.stencilBuffer=i.stencilBuffer,this.resolveDepthBuffer=i.resolveDepthBuffer,this.resolveStencilBuffer=i.resolveStencilBuffer,this._depthTexture=null,this.depthTexture=i.depthTexture,this.samples=i.samples,this.multiview=i.multiview}get texture(){return this.textures[0]}set texture(e){this.textures[0]=e}set depthTexture(e){this._depthTexture!==null&&(this._depthTexture.renderTarget=null),e!==null&&(e.renderTarget=this),this._depthTexture=e}get depthTexture(){return this._depthTexture}setSize(e,n,i=1){if(this.width!==e||this.height!==n||this.depth!==i){this.width=e,this.height=n,this.depth=i;for(let r=0,s=this.textures.length;r<s;r++)this.textures[r].image.width=e,this.textures[r].image.height=n,this.textures[r].image.depth=i;this.dispose()}this.viewport.set(0,0,e,n),this.scissor.set(0,0,e,n)}clone(){return new this.constructor().copy(this)}copy(e){this.width=e.width,this.height=e.height,this.depth=e.depth,this.scissor.copy(e.scissor),this.scissorTest=e.scissorTest,this.viewport.copy(e.viewport),this.textures.length=0;for(let n=0,i=e.textures.length;n<i;n++){this.textures[n]=e.textures[n].clone(),this.textures[n].isRenderTargetTexture=!0,this.textures[n].renderTarget=this;const r=Object.assign({},e.textures[n].image);this.textures[n].source=new ub(r)}return this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,this.resolveDepthBuffer=e.resolveDepthBuffer,this.resolveStencilBuffer=e.resolveStencilBuffer,e.depthTexture!==null&&(this.depthTexture=e.depthTexture.clone()),this.samples=e.samples,this}dispose(){this.dispatchEvent({type:"dispose"})}}class Vl extends bB{constructor(e=1,n=1,i={}){super(e,n,i),this.isWebGLRenderTarget=!0}}class nI extends Ba{constructor(e=null,n=1,i=1,r=1){super(null),this.isDataArrayTexture=!0,this.image={data:e,width:n,height:i,depth:r},this.magFilter=eo,this.minFilter=eo,this.wrapR=np,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1,this.layerUpdates=new Set}addLayerUpdate(e){this.layerUpdates.add(e)}clearLayerUpdates(){this.layerUpdates.clear()}}class Awe extends Vl{constructor(e=1,n=1,i=1,r={}){super(e,n,r),this.isWebGLArrayRenderTarget=!0,this.depth=i,this.texture=new nI(null,e,n,i),this.texture.isRenderTargetTexture=!0}}class EB extends Ba{constructor(e=null,n=1,i=1,r=1){super(null),this.isData3DTexture=!0,this.image={data:e,width:n,height:i,depth:r},this.magFilter=eo,this.minFilter=eo,this.wrapR=np,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class Rwe extends Vl{constructor(e=1,n=1,i=1,r={}){super(e,n,r),this.isWebGL3DRenderTarget=!0,this.depth=i,this.texture=new EB(null,e,n,i),this.texture.isRenderTargetTexture=!0}}class Qh{constructor(e=0,n=0,i=0,r=1){this.isQuaternion=!0,this._x=e,this._y=n,this._z=i,this._w=r}static slerpFlat(e,n,i,r,s,a,o){let c=i[r+0],l=i[r+1],u=i[r+2],h=i[r+3];const f=s[a+0],d=s[a+1],p=s[a+2],g=s[a+3];if(o===0){e[n+0]=c,e[n+1]=l,e[n+2]=u,e[n+3]=h;return}if(o===1){e[n+0]=f,e[n+1]=d,e[n+2]=p,e[n+3]=g;return}if(h!==g||c!==f||l!==d||u!==p){let y=1-o;const v=c*f+l*d+u*p+h*g,b=v>=0?1:-1,T=1-v*v;if(T>Number.EPSILON){const M=Math.sqrt(T),R=Math.atan2(M,v*b);y=Math.sin(y*R)/M,o=Math.sin(o*R)/M}const x=o*b;if(c=c*y+f*x,l=l*y+d*x,u=u*y+p*x,h=h*y+g*x,y===1-o){const M=1/Math.sqrt(c*c+l*l+u*u+h*h);c*=M,l*=M,u*=M,h*=M}}e[n]=c,e[n+1]=l,e[n+2]=u,e[n+3]=h}static multiplyQuaternionsFlat(e,n,i,r,s,a){const o=i[r],c=i[r+1],l=i[r+2],u=i[r+3],h=s[a],f=s[a+1],d=s[a+2],p=s[a+3];return e[n]=o*p+u*h+c*d-l*f,e[n+1]=c*p+u*f+l*h-o*d,e[n+2]=l*p+u*d+o*f-c*h,e[n+3]=u*p-o*h-c*f-l*d,e}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get w(){return this._w}set w(e){this._w=e,this._onChangeCallback()}set(e,n,i,r){return this._x=e,this._y=n,this._z=i,this._w=r,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this}setFromEuler(e,n=!0){const i=e._x,r=e._y,s=e._z,a=e._order,o=Math.cos,c=Math.sin,l=o(i/2),u=o(r/2),h=o(s/2),f=c(i/2),d=c(r/2),p=c(s/2);switch(a){case"XYZ":this._x=f*u*h+l*d*p,this._y=l*d*h-f*u*p,this._z=l*u*p+f*d*h,this._w=l*u*h-f*d*p;break;case"YXZ":this._x=f*u*h+l*d*p,this._y=l*d*h-f*u*p,this._z=l*u*p-f*d*h,this._w=l*u*h+f*d*p;break;case"ZXY":this._x=f*u*h-l*d*p,this._y=l*d*h+f*u*p,this._z=l*u*p+f*d*h,this._w=l*u*h-f*d*p;break;case"ZYX":this._x=f*u*h-l*d*p,this._y=l*d*h+f*u*p,this._z=l*u*p-f*d*h,this._w=l*u*h+f*d*p;break;case"YZX":this._x=f*u*h+l*d*p,this._y=l*d*h+f*u*p,this._z=l*u*p-f*d*h,this._w=l*u*h-f*d*p;break;case"XZY":this._x=f*u*h-l*d*p,this._y=l*d*h-f*u*p,this._z=l*u*p+f*d*h,this._w=l*u*h+f*d*p;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+a)}return n===!0&&this._onChangeCallback(),this}setFromAxisAngle(e,n){const i=n/2,r=Math.sin(i);return this._x=e.x*r,this._y=e.y*r,this._z=e.z*r,this._w=Math.cos(i),this._onChangeCallback(),this}setFromRotationMatrix(e){const n=e.elements,i=n[0],r=n[4],s=n[8],a=n[1],o=n[5],c=n[9],l=n[2],u=n[6],h=n[10],f=i+o+h;if(f>0){const d=.5/Math.sqrt(f+1);this._w=.25/d,this._x=(u-c)*d,this._y=(s-l)*d,this._z=(a-r)*d}else if(i>o&&i>h){const d=2*Math.sqrt(1+i-o-h);this._w=(u-c)/d,this._x=.25*d,this._y=(r+a)/d,this._z=(s+l)/d}else if(o>h){const d=2*Math.sqrt(1+o-i-h);this._w=(s-l)/d,this._x=(r+a)/d,this._y=.25*d,this._z=(c+u)/d}else{const d=2*Math.sqrt(1+h-i-o);this._w=(a-r)/d,this._x=(s+l)/d,this._y=(c+u)/d,this._z=.25*d}return this._onChangeCallback(),this}setFromUnitVectors(e,n){let i=e.dot(n)+1;return i<Number.EPSILON?(i=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0,this._w=i):(this._x=0,this._y=-e.z,this._z=e.y,this._w=i)):(this._x=e.y*n.z-e.z*n.y,this._y=e.z*n.x-e.x*n.z,this._z=e.x*n.y-e.y*n.x,this._w=i),this.normalize()}angleTo(e){return 2*Math.acos(Math.abs(Xi(this.dot(e),-1,1)))}rotateTowards(e,n){const i=this.angleTo(e);if(i===0)return this;const r=Math.min(1,n/i);return this.slerp(e,r),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let e=this.length();return e===0?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this}multiply(e){return this.multiplyQuaternions(this,e)}premultiply(e){return this.multiplyQuaternions(e,this)}multiplyQuaternions(e,n){const i=e._x,r=e._y,s=e._z,a=e._w,o=n._x,c=n._y,l=n._z,u=n._w;return this._x=i*u+a*o+r*l-s*c,this._y=r*u+a*c+s*o-i*l,this._z=s*u+a*l+i*c-r*o,this._w=a*u-i*o-r*c-s*l,this._onChangeCallback(),this}slerp(e,n){if(n===0)return this;if(n===1)return this.copy(e);const i=this._x,r=this._y,s=this._z,a=this._w;let o=a*e._w+i*e._x+r*e._y+s*e._z;if(o<0?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,o=-o):this.copy(e),o>=1)return this._w=a,this._x=i,this._y=r,this._z=s,this;const c=1-o*o;if(c<=Number.EPSILON){const d=1-n;return this._w=d*a+n*this._w,this._x=d*i+n*this._x,this._y=d*r+n*this._y,this._z=d*s+n*this._z,this.normalize(),this}const l=Math.sqrt(c),u=Math.atan2(l,o),h=Math.sin((1-n)*u)/l,f=Math.sin(n*u)/l;return this._w=a*h+this._w*f,this._x=i*h+this._x*f,this._y=r*h+this._y*f,this._z=s*h+this._z*f,this._onChangeCallback(),this}slerpQuaternions(e,n,i){return this.copy(e).slerp(n,i)}random(){const e=2*Math.PI*Math.random(),n=2*Math.PI*Math.random(),i=Math.random(),r=Math.sqrt(1-i),s=Math.sqrt(i);return this.set(r*Math.sin(e),r*Math.cos(e),s*Math.sin(n),s*Math.cos(n))}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w}fromArray(e,n=0){return this._x=e[n],this._y=e[n+1],this._z=e[n+2],this._w=e[n+3],this._onChangeCallback(),this}toArray(e=[],n=0){return e[n]=this._x,e[n+1]=this._y,e[n+2]=this._z,e[n+3]=this._w,e}fromBufferAttribute(e,n){return this._x=e.getX(n),this._y=e.getY(n),this._z=e.getZ(n),this._w=e.getW(n),this._onChangeCallback(),this}toJSON(){return this.toArray()}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}}class Ae{constructor(e=0,n=0,i=0){Ae.prototype.isVector3=!0,this.x=e,this.y=n,this.z=i}set(e,n,i){return i===void 0&&(i=this.z),this.x=e,this.y=n,this.z=i,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setComponent(e,n){switch(e){case 0:this.x=n;break;case 1:this.y=n;break;case 2:this.z=n;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this}addVectors(e,n){return this.x=e.x+n.x,this.y=e.y+n.y,this.z=e.z+n.z,this}addScaledVector(e,n){return this.x+=e.x*n,this.y+=e.y*n,this.z+=e.z*n,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this}subVectors(e,n){return this.x=e.x-n.x,this.y=e.y-n.y,this.z=e.z-n.z,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this}multiplyVectors(e,n){return this.x=e.x*n.x,this.y=e.y*n.y,this.z=e.z*n.z,this}applyEuler(e){return this.applyQuaternion(dZ.setFromEuler(e))}applyAxisAngle(e,n){return this.applyQuaternion(dZ.setFromAxisAngle(e,n))}applyMatrix3(e){const n=this.x,i=this.y,r=this.z,s=e.elements;return this.x=s[0]*n+s[3]*i+s[6]*r,this.y=s[1]*n+s[4]*i+s[7]*r,this.z=s[2]*n+s[5]*i+s[8]*r,this}applyNormalMatrix(e){return this.applyMatrix3(e).normalize()}applyMatrix4(e){const n=this.x,i=this.y,r=this.z,s=e.elements,a=1/(s[3]*n+s[7]*i+s[11]*r+s[15]);return this.x=(s[0]*n+s[4]*i+s[8]*r+s[12])*a,this.y=(s[1]*n+s[5]*i+s[9]*r+s[13])*a,this.z=(s[2]*n+s[6]*i+s[10]*r+s[14])*a,this}applyQuaternion(e){const n=this.x,i=this.y,r=this.z,s=e.x,a=e.y,o=e.z,c=e.w,l=2*(a*r-o*i),u=2*(o*n-s*r),h=2*(s*i-a*n);return this.x=n+c*l+a*h-o*u,this.y=i+c*u+o*l-s*h,this.z=r+c*h+s*u-a*l,this}project(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)}unproject(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)}transformDirection(e){const n=this.x,i=this.y,r=this.z,s=e.elements;return this.x=s[0]*n+s[4]*i+s[8]*r,this.y=s[1]*n+s[5]*i+s[9]*r,this.z=s[2]*n+s[6]*i+s[10]*r,this.normalize()}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this}divideScalar(e){return this.multiplyScalar(1/e)}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this}clamp(e,n){return this.x=Xi(this.x,e.x,n.x),this.y=Xi(this.y,e.y,n.y),this.z=Xi(this.z,e.z,n.z),this}clampScalar(e,n){return this.x=Xi(this.x,e,n),this.y=Xi(this.y,e,n),this.z=Xi(this.z,e,n),this}clampLength(e,n){const i=this.length();return this.divideScalar(i||1).multiplyScalar(Xi(i,e,n))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,n){return this.x+=(e.x-this.x)*n,this.y+=(e.y-this.y)*n,this.z+=(e.z-this.z)*n,this}lerpVectors(e,n,i){return this.x=e.x+(n.x-e.x)*i,this.y=e.y+(n.y-e.y)*i,this.z=e.z+(n.z-e.z)*i,this}cross(e){return this.crossVectors(this,e)}crossVectors(e,n){const i=e.x,r=e.y,s=e.z,a=n.x,o=n.y,c=n.z;return this.x=r*c-s*o,this.y=s*a-i*c,this.z=i*o-r*a,this}projectOnVector(e){const n=e.lengthSq();if(n===0)return this.set(0,0,0);const i=e.dot(this)/n;return this.copy(e).multiplyScalar(i)}projectOnPlane(e){return P8.copy(this).projectOnVector(e),this.sub(P8)}reflect(e){return this.sub(P8.copy(e).multiplyScalar(2*this.dot(e)))}angleTo(e){const n=Math.sqrt(this.lengthSq()*e.lengthSq());if(n===0)return Math.PI/2;const i=this.dot(e)/n;return Math.acos(Xi(i,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const n=this.x-e.x,i=this.y-e.y,r=this.z-e.z;return n*n+i*i+r*r}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)}setFromSpherical(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)}setFromSphericalCoords(e,n,i){const r=Math.sin(n)*e;return this.x=r*Math.sin(i),this.y=Math.cos(n)*e,this.z=r*Math.cos(i),this}setFromCylindrical(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)}setFromCylindricalCoords(e,n,i){return this.x=e*Math.sin(n),this.y=i,this.z=e*Math.cos(n),this}setFromMatrixPosition(e){const n=e.elements;return this.x=n[12],this.y=n[13],this.z=n[14],this}setFromMatrixScale(e){const n=this.setFromMatrixColumn(e,0).length(),i=this.setFromMatrixColumn(e,1).length(),r=this.setFromMatrixColumn(e,2).length();return this.x=n,this.y=i,this.z=r,this}setFromMatrixColumn(e,n){return this.fromArray(e.elements,n*4)}setFromMatrix3Column(e,n){return this.fromArray(e.elements,n*3)}setFromEuler(e){return this.x=e._x,this.y=e._y,this.z=e._z,this}setFromColor(e){return this.x=e.r,this.y=e.g,this.z=e.b,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z}fromArray(e,n=0){return this.x=e[n],this.y=e[n+1],this.z=e[n+2],this}toArray(e=[],n=0){return e[n]=this.x,e[n+1]=this.y,e[n+2]=this.z,e}fromBufferAttribute(e,n){return this.x=e.getX(n),this.y=e.getY(n),this.z=e.getZ(n),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){const e=Math.random()*Math.PI*2,n=Math.random()*2-1,i=Math.sqrt(1-n*n);return this.x=i*Math.cos(e),this.y=n,this.z=i*Math.sin(e),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}}const P8=new Ae,dZ=new Qh;class gu{constructor(e=new Ae(1/0,1/0,1/0),n=new Ae(-1/0,-1/0,-1/0)){this.isBox3=!0,this.min=e,this.max=n}set(e,n){return this.min.copy(e),this.max.copy(n),this}setFromArray(e){this.makeEmpty();for(let n=0,i=e.length;n<i;n+=3)this.expandByPoint(Xp.fromArray(e,n));return this}setFromBufferAttribute(e){this.makeEmpty();for(let n=0,i=e.count;n<i;n++)this.expandByPoint(Xp.fromBufferAttribute(e,n));return this}setFromPoints(e){this.makeEmpty();for(let n=0,i=e.length;n<i;n++)this.expandByPoint(e[n]);return this}setFromCenterAndSize(e,n){const i=Xp.copy(n).multiplyScalar(.5);return this.min.copy(e).sub(i),this.max.copy(e).add(i),this}setFromObject(e,n=!1){return this.makeEmpty(),this.expandByObject(e,n)}clone(){return new this.constructor().copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(e){return this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}expandByObject(e,n=!1){e.updateWorldMatrix(!1,!1);const i=e.geometry;if(i!==void 0){const s=i.getAttribute("position");if(n===!0&&s!==void 0&&e.isInstancedMesh!==!0)for(let a=0,o=s.count;a<o;a++)e.isMesh===!0?e.getVertexPosition(a,Xp):Xp.fromBufferAttribute(s,a),Xp.applyMatrix4(e.matrixWorld),this.expandByPoint(Xp);else e.boundingBox!==void 0?(e.boundingBox===null&&e.computeBoundingBox(),qk.copy(e.boundingBox)):(i.boundingBox===null&&i.computeBoundingBox(),qk.copy(i.boundingBox)),qk.applyMatrix4(e.matrixWorld),this.union(qk)}const r=e.children;for(let s=0,a=r.length;s<a;s++)this.expandByObject(r[s],n);return this}containsPoint(e){return e.x>=this.min.x&&e.x<=this.max.x&&e.y>=this.min.y&&e.y<=this.max.y&&e.z>=this.min.z&&e.z<=this.max.z}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z}getParameter(e,n){return n.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(e){return e.max.x>=this.min.x&&e.min.x<=this.max.x&&e.max.y>=this.min.y&&e.min.y<=this.max.y&&e.max.z>=this.min.z&&e.min.z<=this.max.z}intersectsSphere(e){return this.clampPoint(e.center,Xp),Xp.distanceToSquared(e.center)<=e.radius*e.radius}intersectsPlane(e){let n,i;return e.normal.x>0?(n=e.normal.x*this.min.x,i=e.normal.x*this.max.x):(n=e.normal.x*this.max.x,i=e.normal.x*this.min.x),e.normal.y>0?(n+=e.normal.y*this.min.y,i+=e.normal.y*this.max.y):(n+=e.normal.y*this.max.y,i+=e.normal.y*this.min.y),e.normal.z>0?(n+=e.normal.z*this.min.z,i+=e.normal.z*this.max.z):(n+=e.normal.z*this.max.z,i+=e.normal.z*this.min.z),n<=-e.constant&&i>=-e.constant}intersectsTriangle(e){if(this.isEmpty())return!1;this.getCenter(pR),$k.subVectors(this.max,pR),mx.subVectors(e.a,pR),gx.subVectors(e.b,pR),vx.subVectors(e.c,pR),by.subVectors(gx,mx),Ey.subVectors(vx,gx),vS.subVectors(mx,vx);let n=[0,-by.z,by.y,0,-Ey.z,Ey.y,0,-vS.z,vS.y,by.z,0,-by.x,Ey.z,0,-Ey.x,vS.z,0,-vS.x,-by.y,by.x,0,-Ey.y,Ey.x,0,-vS.y,vS.x,0];return!L8(n,mx,gx,vx,$k)||(n=[1,0,0,0,1,0,0,0,1],!L8(n,mx,gx,vx,$k))?!1:(Wk.crossVectors(by,Ey),n=[Wk.x,Wk.y,Wk.z],L8(n,mx,gx,vx,$k))}clampPoint(e,n){return n.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return this.clampPoint(e,Xp).distanceTo(e)}getBoundingSphere(e){return this.isEmpty()?e.makeEmpty():(this.getCenter(e.center),e.radius=this.getSize(Xp).length()*.5),e}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}applyMatrix4(e){return this.isEmpty()?this:(yv[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),yv[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),yv[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),yv[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),yv[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),yv[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),yv[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),yv[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(yv),this)}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}const yv=[new Ae,new Ae,new Ae,new Ae,new Ae,new Ae,new Ae,new Ae],Xp=new Ae,qk=new gu,mx=new Ae,gx=new Ae,vx=new Ae,by=new Ae,Ey=new Ae,vS=new Ae,pR=new Ae,$k=new Ae,Wk=new Ae,_S=new Ae;function L8(t,e,n,i,r){for(let s=0,a=t.length-3;s<=a;s+=3){_S.fromArray(t,s);const o=r.x*Math.abs(_S.x)+r.y*Math.abs(_S.y)+r.z*Math.abs(_S.z),c=e.dot(_S),l=n.dot(_S),u=i.dot(_S);if(Math.max(-Math.max(c,l,u),Math.min(c,l,u))>o)return!1}return!0}const Mwe=new gu,mR=new Ae,U8=new Ae;class zl{constructor(e=new Ae,n=-1){this.isSphere=!0,this.center=e,this.radius=n}set(e,n){return this.center.copy(e),this.radius=n,this}setFromPoints(e,n){const i=this.center;n!==void 0?i.copy(n):Mwe.setFromPoints(e).getCenter(i);let r=0;for(let s=0,a=e.length;s<a;s++)r=Math.max(r,i.distanceToSquared(e[s]));return this.radius=Math.sqrt(r),this}copy(e){return this.center.copy(e.center),this.radius=e.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(e){return e.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(e){return e.distanceTo(this.center)-this.radius}intersectsSphere(e){const n=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=n*n}intersectsBox(e){return e.intersectsSphere(this)}intersectsPlane(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius}clampPoint(e,n){const i=this.center.distanceToSquared(e);return n.copy(e),i>this.radius*this.radius&&(n.sub(this.center).normalize(),n.multiplyScalar(this.radius).add(this.center)),n}getBoundingBox(e){return this.isEmpty()?(e.makeEmpty(),e):(e.set(this.center,this.center),e.expandByScalar(this.radius),e)}applyMatrix4(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this}translate(e){return this.center.add(e),this}expandByPoint(e){if(this.isEmpty())return this.center.copy(e),this.radius=0,this;mR.subVectors(e,this.center);const n=mR.lengthSq();if(n>this.radius*this.radius){const i=Math.sqrt(n),r=(i-this.radius)*.5;this.center.addScaledVector(mR,r/i),this.radius+=r}return this}union(e){return e.isEmpty()?this:this.isEmpty()?(this.copy(e),this):(this.center.equals(e.center)===!0?this.radius=Math.max(this.radius,e.radius):(U8.subVectors(e.center,this.center).setLength(e.radius),this.expandByPoint(mR.copy(e.center).add(U8)),this.expandByPoint(mR.copy(e.center).sub(U8))),this)}equals(e){return e.center.equals(this.center)&&e.radius===this.radius}clone(){return new this.constructor().copy(this)}}const bv=new Ae,B8=new Ae,Yk=new Ae,Sy=new Ae,F8=new Ae,Xk=new Ae,z8=new Ae;class _A{constructor(e=new Ae,n=new Ae(0,0,-1)){this.origin=e,this.direction=n}set(e,n){return this.origin.copy(e),this.direction.copy(n),this}copy(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this}at(e,n){return n.copy(this.origin).addScaledVector(this.direction,e)}lookAt(e){return this.direction.copy(e).sub(this.origin).normalize(),this}recast(e){return this.origin.copy(this.at(e,bv)),this}closestPointToPoint(e,n){n.subVectors(e,this.origin);const i=n.dot(this.direction);return i<0?n.copy(this.origin):n.copy(this.origin).addScaledVector(this.direction,i)}distanceToPoint(e){return Math.sqrt(this.distanceSqToPoint(e))}distanceSqToPoint(e){const n=bv.subVectors(e,this.origin).dot(this.direction);return n<0?this.origin.distanceToSquared(e):(bv.copy(this.origin).addScaledVector(this.direction,n),bv.distanceToSquared(e))}distanceSqToSegment(e,n,i,r){B8.copy(e).add(n).multiplyScalar(.5),Yk.copy(n).sub(e).normalize(),Sy.copy(this.origin).sub(B8);const s=e.distanceTo(n)*.5,a=-this.direction.dot(Yk),o=Sy.dot(this.direction),c=-Sy.dot(Yk),l=Sy.lengthSq(),u=Math.abs(1-a*a);let h,f,d,p;if(u>0)if(h=a*c-o,f=a*o-c,p=s*u,h>=0)if(f>=-p)if(f<=p){const g=1/u;h*=g,f*=g,d=h*(h+a*f+2*o)+f*(a*h+f+2*c)+l}else f=s,h=Math.max(0,-(a*f+o)),d=-h*h+f*(f+2*c)+l;else f=-s,h=Math.max(0,-(a*f+o)),d=-h*h+f*(f+2*c)+l;else f<=-p?(h=Math.max(0,-(-a*s+o)),f=h>0?-s:Math.min(Math.max(-s,-c),s),d=-h*h+f*(f+2*c)+l):f<=p?(h=0,f=Math.min(Math.max(-s,-c),s),d=f*(f+2*c)+l):(h=Math.max(0,-(a*s+o)),f=h>0?s:Math.min(Math.max(-s,-c),s),d=-h*h+f*(f+2*c)+l);else f=a>0?-s:s,h=Math.max(0,-(a*f+o)),d=-h*h+f*(f+2*c)+l;return i&&i.copy(this.origin).addScaledVector(this.direction,h),r&&r.copy(B8).addScaledVector(Yk,f),d}intersectSphere(e,n){bv.subVectors(e.center,this.origin);const i=bv.dot(this.direction),r=bv.dot(bv)-i*i,s=e.radius*e.radius;if(r>s)return null;const a=Math.sqrt(s-r),o=i-a,c=i+a;return c<0?null:o<0?this.at(c,n):this.at(o,n)}intersectsSphere(e){return this.distanceSqToPoint(e.center)<=e.radius*e.radius}distanceToPlane(e){const n=e.normal.dot(this.direction);if(n===0)return e.distanceToPoint(this.origin)===0?0:null;const i=-(this.origin.dot(e.normal)+e.constant)/n;return i>=0?i:null}intersectPlane(e,n){const i=this.distanceToPlane(e);return i===null?null:this.at(i,n)}intersectsPlane(e){const n=e.distanceToPoint(this.origin);return n===0||e.normal.dot(this.direction)*n<0}intersectBox(e,n){let i,r,s,a,o,c;const l=1/this.direction.x,u=1/this.direction.y,h=1/this.direction.z,f=this.origin;return l>=0?(i=(e.min.x-f.x)*l,r=(e.max.x-f.x)*l):(i=(e.max.x-f.x)*l,r=(e.min.x-f.x)*l),u>=0?(s=(e.min.y-f.y)*u,a=(e.max.y-f.y)*u):(s=(e.max.y-f.y)*u,a=(e.min.y-f.y)*u),i>a||s>r||((s>i||isNaN(i))&&(i=s),(a<r||isNaN(r))&&(r=a),h>=0?(o=(e.min.z-f.z)*h,c=(e.max.z-f.z)*h):(o=(e.max.z-f.z)*h,c=(e.min.z-f.z)*h),i>c||o>r)||((o>i||i!==i)&&(i=o),(c<r||r!==r)&&(r=c),r<0)?null:this.at(i>=0?i:r,n)}intersectsBox(e){return this.intersectBox(e,bv)!==null}intersectTriangle(e,n,i,r,s){F8.subVectors(n,e),Xk.subVectors(i,e),z8.crossVectors(F8,Xk);let a=this.direction.dot(z8),o;if(a>0){if(r)return null;o=1}else if(a<0)o=-1,a=-a;else return null;Sy.subVectors(this.origin,e);const c=o*this.direction.dot(Xk.crossVectors(Sy,Xk));if(c<0)return null;const l=o*this.direction.dot(F8.cross(Sy));if(l<0||c+l>a)return null;const u=-o*Sy.dot(z8);return u<0?null:this.at(u/a,s)}applyMatrix4(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this}equals(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}clone(){return new this.constructor().copy(this)}}class Ni{constructor(e,n,i,r,s,a,o,c,l,u,h,f,d,p,g,y){Ni.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],e!==void 0&&this.set(e,n,i,r,s,a,o,c,l,u,h,f,d,p,g,y)}set(e,n,i,r,s,a,o,c,l,u,h,f,d,p,g,y){const v=this.elements;return v[0]=e,v[4]=n,v[8]=i,v[12]=r,v[1]=s,v[5]=a,v[9]=o,v[13]=c,v[2]=l,v[6]=u,v[10]=h,v[14]=f,v[3]=d,v[7]=p,v[11]=g,v[15]=y,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return new Ni().fromArray(this.elements)}copy(e){const n=this.elements,i=e.elements;return n[0]=i[0],n[1]=i[1],n[2]=i[2],n[3]=i[3],n[4]=i[4],n[5]=i[5],n[6]=i[6],n[7]=i[7],n[8]=i[8],n[9]=i[9],n[10]=i[10],n[11]=i[11],n[12]=i[12],n[13]=i[13],n[14]=i[14],n[15]=i[15],this}copyPosition(e){const n=this.elements,i=e.elements;return n[12]=i[12],n[13]=i[13],n[14]=i[14],this}setFromMatrix3(e){const n=e.elements;return this.set(n[0],n[3],n[6],0,n[1],n[4],n[7],0,n[2],n[5],n[8],0,0,0,0,1),this}extractBasis(e,n,i){return e.setFromMatrixColumn(this,0),n.setFromMatrixColumn(this,1),i.setFromMatrixColumn(this,2),this}makeBasis(e,n,i){return this.set(e.x,n.x,i.x,0,e.y,n.y,i.y,0,e.z,n.z,i.z,0,0,0,0,1),this}extractRotation(e){const n=this.elements,i=e.elements,r=1/_x.setFromMatrixColumn(e,0).length(),s=1/_x.setFromMatrixColumn(e,1).length(),a=1/_x.setFromMatrixColumn(e,2).length();return n[0]=i[0]*r,n[1]=i[1]*r,n[2]=i[2]*r,n[3]=0,n[4]=i[4]*s,n[5]=i[5]*s,n[6]=i[6]*s,n[7]=0,n[8]=i[8]*a,n[9]=i[9]*a,n[10]=i[10]*a,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,this}makeRotationFromEuler(e){const n=this.elements,i=e.x,r=e.y,s=e.z,a=Math.cos(i),o=Math.sin(i),c=Math.cos(r),l=Math.sin(r),u=Math.cos(s),h=Math.sin(s);if(e.order==="XYZ"){const f=a*u,d=a*h,p=o*u,g=o*h;n[0]=c*u,n[4]=-c*h,n[8]=l,n[1]=d+p*l,n[5]=f-g*l,n[9]=-o*c,n[2]=g-f*l,n[6]=p+d*l,n[10]=a*c}else if(e.order==="YXZ"){const f=c*u,d=c*h,p=l*u,g=l*h;n[0]=f+g*o,n[4]=p*o-d,n[8]=a*l,n[1]=a*h,n[5]=a*u,n[9]=-o,n[2]=d*o-p,n[6]=g+f*o,n[10]=a*c}else if(e.order==="ZXY"){const f=c*u,d=c*h,p=l*u,g=l*h;n[0]=f-g*o,n[4]=-a*h,n[8]=p+d*o,n[1]=d+p*o,n[5]=a*u,n[9]=g-f*o,n[2]=-a*l,n[6]=o,n[10]=a*c}else if(e.order==="ZYX"){const f=a*u,d=a*h,p=o*u,g=o*h;n[0]=c*u,n[4]=p*l-d,n[8]=f*l+g,n[1]=c*h,n[5]=g*l+f,n[9]=d*l-p,n[2]=-l,n[6]=o*c,n[10]=a*c}else if(e.order==="YZX"){const f=a*c,d=a*l,p=o*c,g=o*l;n[0]=c*u,n[4]=g-f*h,n[8]=p*h+d,n[1]=h,n[5]=a*u,n[9]=-o*u,n[2]=-l*u,n[6]=d*h+p,n[10]=f-g*h}else if(e.order==="XZY"){const f=a*c,d=a*l,p=o*c,g=o*l;n[0]=c*u,n[4]=-h,n[8]=l*u,n[1]=f*h+g,n[5]=a*u,n[9]=d*h-p,n[2]=p*h-d,n[6]=o*u,n[10]=g*h+f}return n[3]=0,n[7]=0,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,this}makeRotationFromQuaternion(e){return this.compose(Owe,e,Nwe)}lookAt(e,n,i){const r=this.elements;return kf.subVectors(e,n),kf.lengthSq()===0&&(kf.z=1),kf.normalize(),Ty.crossVectors(i,kf),Ty.lengthSq()===0&&(Math.abs(i.z)===1?kf.x+=1e-4:kf.z+=1e-4,kf.normalize(),Ty.crossVectors(i,kf)),Ty.normalize(),Kk.crossVectors(kf,Ty),r[0]=Ty.x,r[4]=Kk.x,r[8]=kf.x,r[1]=Ty.y,r[5]=Kk.y,r[9]=kf.y,r[2]=Ty.z,r[6]=Kk.z,r[10]=kf.z,this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,n){const i=e.elements,r=n.elements,s=this.elements,a=i[0],o=i[4],c=i[8],l=i[12],u=i[1],h=i[5],f=i[9],d=i[13],p=i[2],g=i[6],y=i[10],v=i[14],b=i[3],T=i[7],x=i[11],M=i[15],R=r[0],I=r[4],k=r[8],P=r[12],U=r[1],G=r[5],$=r[9],q=r[13],Y=r[2],ie=r[6],V=r[10],J=r[14],X=r[3],ee=r[7],oe=r[11],fe=r[15];return s[0]=a*R+o*U+c*Y+l*X,s[4]=a*I+o*G+c*ie+l*ee,s[8]=a*k+o*$+c*V+l*oe,s[12]=a*P+o*q+c*J+l*fe,s[1]=u*R+h*U+f*Y+d*X,s[5]=u*I+h*G+f*ie+d*ee,s[9]=u*k+h*$+f*V+d*oe,s[13]=u*P+h*q+f*J+d*fe,s[2]=p*R+g*U+y*Y+v*X,s[6]=p*I+g*G+y*ie+v*ee,s[10]=p*k+g*$+y*V+v*oe,s[14]=p*P+g*q+y*J+v*fe,s[3]=b*R+T*U+x*Y+M*X,s[7]=b*I+T*G+x*ie+M*ee,s[11]=b*k+T*$+x*V+M*oe,s[15]=b*P+T*q+x*J+M*fe,this}multiplyScalar(e){const n=this.elements;return n[0]*=e,n[4]*=e,n[8]*=e,n[12]*=e,n[1]*=e,n[5]*=e,n[9]*=e,n[13]*=e,n[2]*=e,n[6]*=e,n[10]*=e,n[14]*=e,n[3]*=e,n[7]*=e,n[11]*=e,n[15]*=e,this}determinant(){const e=this.elements,n=e[0],i=e[4],r=e[8],s=e[12],a=e[1],o=e[5],c=e[9],l=e[13],u=e[2],h=e[6],f=e[10],d=e[14],p=e[3],g=e[7],y=e[11],v=e[15];return p*(+s*c*h-r*l*h-s*o*f+i*l*f+r*o*d-i*c*d)+g*(+n*c*d-n*l*f+s*a*f-r*a*d+r*l*u-s*c*u)+y*(+n*l*h-n*o*d-s*a*h+i*a*d+s*o*u-i*l*u)+v*(-r*o*u-n*c*h+n*o*f+r*a*h-i*a*f+i*c*u)}transpose(){const e=this.elements;let n;return n=e[1],e[1]=e[4],e[4]=n,n=e[2],e[2]=e[8],e[8]=n,n=e[6],e[6]=e[9],e[9]=n,n=e[3],e[3]=e[12],e[12]=n,n=e[7],e[7]=e[13],e[13]=n,n=e[11],e[11]=e[14],e[14]=n,this}setPosition(e,n,i){const r=this.elements;return e.isVector3?(r[12]=e.x,r[13]=e.y,r[14]=e.z):(r[12]=e,r[13]=n,r[14]=i),this}invert(){const e=this.elements,n=e[0],i=e[1],r=e[2],s=e[3],a=e[4],o=e[5],c=e[6],l=e[7],u=e[8],h=e[9],f=e[10],d=e[11],p=e[12],g=e[13],y=e[14],v=e[15],b=h*y*l-g*f*l+g*c*d-o*y*d-h*c*v+o*f*v,T=p*f*l-u*y*l-p*c*d+a*y*d+u*c*v-a*f*v,x=u*g*l-p*h*l+p*o*d-a*g*d-u*o*v+a*h*v,M=p*h*c-u*g*c-p*o*f+a*g*f+u*o*y-a*h*y,R=n*b+i*T+r*x+s*M;if(R===0)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const I=1/R;return e[0]=b*I,e[1]=(g*f*s-h*y*s-g*r*d+i*y*d+h*r*v-i*f*v)*I,e[2]=(o*y*s-g*c*s+g*r*l-i*y*l-o*r*v+i*c*v)*I,e[3]=(h*c*s-o*f*s-h*r*l+i*f*l+o*r*d-i*c*d)*I,e[4]=T*I,e[5]=(u*y*s-p*f*s+p*r*d-n*y*d-u*r*v+n*f*v)*I,e[6]=(p*c*s-a*y*s-p*r*l+n*y*l+a*r*v-n*c*v)*I,e[7]=(a*f*s-u*c*s+u*r*l-n*f*l-a*r*d+n*c*d)*I,e[8]=x*I,e[9]=(p*h*s-u*g*s-p*i*d+n*g*d+u*i*v-n*h*v)*I,e[10]=(a*g*s-p*o*s+p*i*l-n*g*l-a*i*v+n*o*v)*I,e[11]=(u*o*s-a*h*s-u*i*l+n*h*l+a*i*d-n*o*d)*I,e[12]=M*I,e[13]=(u*g*r-p*h*r+p*i*f-n*g*f-u*i*y+n*h*y)*I,e[14]=(p*o*r-a*g*r-p*i*c+n*g*c+a*i*y-n*o*y)*I,e[15]=(a*h*r-u*o*r+u*i*c-n*h*c-a*i*f+n*o*f)*I,this}scale(e){const n=this.elements,i=e.x,r=e.y,s=e.z;return n[0]*=i,n[4]*=r,n[8]*=s,n[1]*=i,n[5]*=r,n[9]*=s,n[2]*=i,n[6]*=r,n[10]*=s,n[3]*=i,n[7]*=r,n[11]*=s,this}getMaxScaleOnAxis(){const e=this.elements,n=e[0]*e[0]+e[1]*e[1]+e[2]*e[2],i=e[4]*e[4]+e[5]*e[5]+e[6]*e[6],r=e[8]*e[8]+e[9]*e[9]+e[10]*e[10];return Math.sqrt(Math.max(n,i,r))}makeTranslation(e,n,i){return e.isVector3?this.set(1,0,0,e.x,0,1,0,e.y,0,0,1,e.z,0,0,0,1):this.set(1,0,0,e,0,1,0,n,0,0,1,i,0,0,0,1),this}makeRotationX(e){const n=Math.cos(e),i=Math.sin(e);return this.set(1,0,0,0,0,n,-i,0,0,i,n,0,0,0,0,1),this}makeRotationY(e){const n=Math.cos(e),i=Math.sin(e);return this.set(n,0,i,0,0,1,0,0,-i,0,n,0,0,0,0,1),this}makeRotationZ(e){const n=Math.cos(e),i=Math.sin(e);return this.set(n,-i,0,0,i,n,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(e,n){const i=Math.cos(n),r=Math.sin(n),s=1-i,a=e.x,o=e.y,c=e.z,l=s*a,u=s*o;return this.set(l*a+i,l*o-r*c,l*c+r*o,0,l*o+r*c,u*o+i,u*c-r*a,0,l*c-r*o,u*c+r*a,s*c*c+i,0,0,0,0,1),this}makeScale(e,n,i){return this.set(e,0,0,0,0,n,0,0,0,0,i,0,0,0,0,1),this}makeShear(e,n,i,r,s,a){return this.set(1,i,s,0,e,1,a,0,n,r,1,0,0,0,0,1),this}compose(e,n,i){const r=this.elements,s=n._x,a=n._y,o=n._z,c=n._w,l=s+s,u=a+a,h=o+o,f=s*l,d=s*u,p=s*h,g=a*u,y=a*h,v=o*h,b=c*l,T=c*u,x=c*h,M=i.x,R=i.y,I=i.z;return r[0]=(1-(g+v))*M,r[1]=(d+x)*M,r[2]=(p-T)*M,r[3]=0,r[4]=(d-x)*R,r[5]=(1-(f+v))*R,r[6]=(y+b)*R,r[7]=0,r[8]=(p+T)*I,r[9]=(y-b)*I,r[10]=(1-(f+g))*I,r[11]=0,r[12]=e.x,r[13]=e.y,r[14]=e.z,r[15]=1,this}decompose(e,n,i){const r=this.elements;let s=_x.set(r[0],r[1],r[2]).length();const a=_x.set(r[4],r[5],r[6]).length(),o=_x.set(r[8],r[9],r[10]).length();this.determinant()<0&&(s=-s),e.x=r[12],e.y=r[13],e.z=r[14],Kp.copy(this);const l=1/s,u=1/a,h=1/o;return Kp.elements[0]*=l,Kp.elements[1]*=l,Kp.elements[2]*=l,Kp.elements[4]*=u,Kp.elements[5]*=u,Kp.elements[6]*=u,Kp.elements[8]*=h,Kp.elements[9]*=h,Kp.elements[10]*=h,n.setFromRotationMatrix(Kp),i.x=s,i.y=a,i.z=o,this}makePerspective(e,n,i,r,s,a,o=ip){const c=this.elements,l=2*s/(n-e),u=2*s/(i-r),h=(n+e)/(n-e),f=(i+r)/(i-r);let d,p;if(o===ip)d=-(a+s)/(a-s),p=-2*a*s/(a-s);else if(o===vO)d=-a/(a-s),p=-a*s/(a-s);else throw new Error("THREE.Matrix4.makePerspective(): Invalid coordinate system: "+o);return c[0]=l,c[4]=0,c[8]=h,c[12]=0,c[1]=0,c[5]=u,c[9]=f,c[13]=0,c[2]=0,c[6]=0,c[10]=d,c[14]=p,c[3]=0,c[7]=0,c[11]=-1,c[15]=0,this}makeOrthographic(e,n,i,r,s,a,o=ip){const c=this.elements,l=1/(n-e),u=1/(i-r),h=1/(a-s),f=(n+e)*l,d=(i+r)*u;let p,g;if(o===ip)p=(a+s)*h,g=-2*h;else if(o===vO)p=s*h,g=-1*h;else throw new Error("THREE.Matrix4.makeOrthographic(): Invalid coordinate system: "+o);return c[0]=2*l,c[4]=0,c[8]=0,c[12]=-f,c[1]=0,c[5]=2*u,c[9]=0,c[13]=-d,c[2]=0,c[6]=0,c[10]=g,c[14]=-p,c[3]=0,c[7]=0,c[11]=0,c[15]=1,this}equals(e){const n=this.elements,i=e.elements;for(let r=0;r<16;r++)if(n[r]!==i[r])return!1;return!0}fromArray(e,n=0){for(let i=0;i<16;i++)this.elements[i]=e[i+n];return this}toArray(e=[],n=0){const i=this.elements;return e[n]=i[0],e[n+1]=i[1],e[n+2]=i[2],e[n+3]=i[3],e[n+4]=i[4],e[n+5]=i[5],e[n+6]=i[6],e[n+7]=i[7],e[n+8]=i[8],e[n+9]=i[9],e[n+10]=i[10],e[n+11]=i[11],e[n+12]=i[12],e[n+13]=i[13],e[n+14]=i[14],e[n+15]=i[15],e}}const _x=new Ae,Kp=new Ni,Owe=new Ae(0,0,0),Nwe=new Ae(1,1,1),Ty=new Ae,Kk=new Ae,kf=new Ae,pZ=new Ni,mZ=new Qh;class rf{constructor(e=0,n=0,i=0,r=rf.DEFAULT_ORDER){this.isEuler=!0,this._x=e,this._y=n,this._z=i,this._order=r}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get order(){return this._order}set order(e){this._order=e,this._onChangeCallback()}set(e,n,i,r=this._order){return this._x=e,this._y=n,this._z=i,this._order=r,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(e){return this._x=e._x,this._y=e._y,this._z=e._z,this._order=e._order,this._onChangeCallback(),this}setFromRotationMatrix(e,n=this._order,i=!0){const r=e.elements,s=r[0],a=r[4],o=r[8],c=r[1],l=r[5],u=r[9],h=r[2],f=r[6],d=r[10];switch(n){case"XYZ":this._y=Math.asin(Xi(o,-1,1)),Math.abs(o)<.9999999?(this._x=Math.atan2(-u,d),this._z=Math.atan2(-a,s)):(this._x=Math.atan2(f,l),this._z=0);break;case"YXZ":this._x=Math.asin(-Xi(u,-1,1)),Math.abs(u)<.9999999?(this._y=Math.atan2(o,d),this._z=Math.atan2(c,l)):(this._y=Math.atan2(-h,s),this._z=0);break;case"ZXY":this._x=Math.asin(Xi(f,-1,1)),Math.abs(f)<.9999999?(this._y=Math.atan2(-h,d),this._z=Math.atan2(-a,l)):(this._y=0,this._z=Math.atan2(c,s));break;case"ZYX":this._y=Math.asin(-Xi(h,-1,1)),Math.abs(h)<.9999999?(this._x=Math.atan2(f,d),this._z=Math.atan2(c,s)):(this._x=0,this._z=Math.atan2(-a,l));break;case"YZX":this._z=Math.asin(Xi(c,-1,1)),Math.abs(c)<.9999999?(this._x=Math.atan2(-u,l),this._y=Math.atan2(-h,s)):(this._x=0,this._y=Math.atan2(o,d));break;case"XZY":this._z=Math.asin(-Xi(a,-1,1)),Math.abs(a)<.9999999?(this._x=Math.atan2(f,l),this._y=Math.atan2(o,s)):(this._x=Math.atan2(-u,d),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+n)}return this._order=n,i===!0&&this._onChangeCallback(),this}setFromQuaternion(e,n,i){return pZ.makeRotationFromQuaternion(e),this.setFromRotationMatrix(pZ,n,i)}setFromVector3(e,n=this._order){return this.set(e.x,e.y,e.z,n)}reorder(e){return mZ.setFromEuler(this),this.setFromQuaternion(mZ,e)}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._order===this._order}fromArray(e){return this._x=e[0],this._y=e[1],this._z=e[2],e[3]!==void 0&&(this._order=e[3]),this._onChangeCallback(),this}toArray(e=[],n=0){return e[n]=this._x,e[n+1]=this._y,e[n+2]=this._z,e[n+3]=this._order,e}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}}rf.DEFAULT_ORDER="XYZ";class bC{constructor(){this.mask=1}set(e){this.mask=(1<<e|0)>>>0}enable(e){this.mask|=1<<e|0}enableAll(){this.mask=-1}toggle(e){this.mask^=1<<e|0}disable(e){this.mask&=~(1<<e|0)}disableAll(){this.mask=0}test(e){return(this.mask&e.mask)!==0}isEnabled(e){return(this.mask&(1<<e|0))!==0}}let Iwe=0;const gZ=new Ae,yx=new Qh,Ev=new Ni,Zk=new Ae,gR=new Ae,kwe=new Ae,Dwe=new Qh,vZ=new Ae(1,0,0),_Z=new Ae(0,1,0),yZ=new Ae(0,0,1),bZ={type:"added"},Pwe={type:"removed"},bx={type:"childadded",child:null},H8={type:"childremoved",child:null};class qr extends cd{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:Iwe++}),this.uuid=ed(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=qr.DEFAULT_UP.clone();const e=new Ae,n=new rf,i=new Qh,r=new Ae(1,1,1);function s(){i.setFromEuler(n,!1)}function a(){n.setFromQuaternion(i,void 0,!1)}n._onChange(s),i._onChange(a),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:e},rotation:{configurable:!0,enumerable:!0,value:n},quaternion:{configurable:!0,enumerable:!0,value:i},scale:{configurable:!0,enumerable:!0,value:r},modelViewMatrix:{value:new Ni},normalMatrix:{value:new Ji}}),this.matrix=new Ni,this.matrixWorld=new Ni,this.matrixAutoUpdate=qr.DEFAULT_MATRIX_AUTO_UPDATE,this.matrixWorldAutoUpdate=qr.DEFAULT_MATRIX_WORLD_AUTO_UPDATE,this.matrixWorldNeedsUpdate=!1,this.layers=new bC,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.customDepthMaterial=void 0,this.customDistanceMaterial=void 0,this.userData={}}onBeforeShadow(){}onAfterShadow(){}onBeforeRender(){}onAfterRender(){}applyMatrix4(e){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(e),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(e){return this.quaternion.premultiply(e),this}setRotationFromAxisAngle(e,n){this.quaternion.setFromAxisAngle(e,n)}setRotationFromEuler(e){this.quaternion.setFromEuler(e,!0)}setRotationFromMatrix(e){this.quaternion.setFromRotationMatrix(e)}setRotationFromQuaternion(e){this.quaternion.copy(e)}rotateOnAxis(e,n){return yx.setFromAxisAngle(e,n),this.quaternion.multiply(yx),this}rotateOnWorldAxis(e,n){return yx.setFromAxisAngle(e,n),this.quaternion.premultiply(yx),this}rotateX(e){return this.rotateOnAxis(vZ,e)}rotateY(e){return this.rotateOnAxis(_Z,e)}rotateZ(e){return this.rotateOnAxis(yZ,e)}translateOnAxis(e,n){return gZ.copy(e).applyQuaternion(this.quaternion),this.position.add(gZ.multiplyScalar(n)),this}translateX(e){return this.translateOnAxis(vZ,e)}translateY(e){return this.translateOnAxis(_Z,e)}translateZ(e){return this.translateOnAxis(yZ,e)}localToWorld(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(this.matrixWorld)}worldToLocal(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(Ev.copy(this.matrixWorld).invert())}lookAt(e,n,i){e.isVector3?Zk.copy(e):Zk.set(e,n,i);const r=this.parent;this.updateWorldMatrix(!0,!1),gR.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?Ev.lookAt(gR,Zk,this.up):Ev.lookAt(Zk,gR,this.up),this.quaternion.setFromRotationMatrix(Ev),r&&(Ev.extractRotation(r.matrixWorld),yx.setFromRotationMatrix(Ev),this.quaternion.premultiply(yx.invert()))}add(e){if(arguments.length>1){for(let n=0;n<arguments.length;n++)this.add(arguments[n]);return this}return e===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",e),this):(e&&e.isObject3D?(e.removeFromParent(),e.parent=this,this.children.push(e),e.dispatchEvent(bZ),bx.child=e,this.dispatchEvent(bx),bx.child=null):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",e),this)}remove(e){if(arguments.length>1){for(let i=0;i<arguments.length;i++)this.remove(arguments[i]);return this}const n=this.children.indexOf(e);return n!==-1&&(e.parent=null,this.children.splice(n,1),e.dispatchEvent(Pwe),H8.child=e,this.dispatchEvent(H8),H8.child=null),this}removeFromParent(){const e=this.parent;return e!==null&&e.remove(this),this}clear(){return this.remove(...this.children)}attach(e){return this.updateWorldMatrix(!0,!1),Ev.copy(this.matrixWorld).invert(),e.parent!==null&&(e.parent.updateWorldMatrix(!0,!1),Ev.multiply(e.parent.matrixWorld)),e.applyMatrix4(Ev),e.removeFromParent(),e.parent=this,this.children.push(e),e.updateWorldMatrix(!1,!0),e.dispatchEvent(bZ),bx.child=e,this.dispatchEvent(bx),bx.child=null,this}getObjectById(e){return this.getObjectByProperty("id",e)}getObjectByName(e){return this.getObjectByProperty("name",e)}getObjectByProperty(e,n){if(this[e]===n)return this;for(let i=0,r=this.children.length;i<r;i++){const a=this.children[i].getObjectByProperty(e,n);if(a!==void 0)return a}}getObjectsByProperty(e,n,i=[]){this[e]===n&&i.push(this);const r=this.children;for(let s=0,a=r.length;s<a;s++)r[s].getObjectsByProperty(e,n,i);return i}getWorldPosition(e){return this.updateWorldMatrix(!0,!1),e.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(gR,e,kwe),e}getWorldScale(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(gR,Dwe,e),e}getWorldDirection(e){this.updateWorldMatrix(!0,!1);const n=this.matrixWorld.elements;return e.set(n[8],n[9],n[10]).normalize()}raycast(){}traverse(e){e(this);const n=this.children;for(let i=0,r=n.length;i<r;i++)n[i].traverse(e)}traverseVisible(e){if(this.visible===!1)return;e(this);const n=this.children;for(let i=0,r=n.length;i<r;i++)n[i].traverseVisible(e)}traverseAncestors(e){const n=this.parent;n!==null&&(e(n),n.traverseAncestors(e))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(this.matrixWorldAutoUpdate===!0&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix)),this.matrixWorldNeedsUpdate=!1,e=!0);const n=this.children;for(let i=0,r=n.length;i<r;i++)n[i].updateMatrixWorld(e)}updateWorldMatrix(e,n){const i=this.parent;if(e===!0&&i!==null&&i.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),this.matrixWorldAutoUpdate===!0&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix)),n===!0){const r=this.children;for(let s=0,a=r.length;s<a;s++)r[s].updateWorldMatrix(!1,!0)}}toJSON(e){const n=e===void 0||typeof e=="string",i={};n&&(e={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},i.metadata={version:4.6,type:"Object",generator:"Object3D.toJSON"});const r={};r.uuid=this.uuid,r.type=this.type,this.name!==""&&(r.name=this.name),this.castShadow===!0&&(r.castShadow=!0),this.receiveShadow===!0&&(r.receiveShadow=!0),this.visible===!1&&(r.visible=!1),this.frustumCulled===!1&&(r.frustumCulled=!1),this.renderOrder!==0&&(r.renderOrder=this.renderOrder),Object.keys(this.userData).length>0&&(r.userData=this.userData),r.layers=this.layers.mask,r.matrix=this.matrix.toArray(),r.up=this.up.toArray(),this.matrixAutoUpdate===!1&&(r.matrixAutoUpdate=!1),this.isInstancedMesh&&(r.type="InstancedMesh",r.count=this.count,r.instanceMatrix=this.instanceMatrix.toJSON(),this.instanceColor!==null&&(r.instanceColor=this.instanceColor.toJSON())),this.isBatchedMesh&&(r.type="BatchedMesh",r.perObjectFrustumCulled=this.perObjectFrustumCulled,r.sortObjects=this.sortObjects,r.drawRanges=this._drawRanges,r.reservedRanges=this._reservedRanges,r.geometryInfo=this._geometryInfo.map(o=>({...o,boundingBox:o.boundingBox?{min:o.boundingBox.min.toArray(),max:o.boundingBox.max.toArray()}:void 0,boundingSphere:o.boundingSphere?{radius:o.boundingSphere.radius,center:o.boundingSphere.center.toArray()}:void 0})),r.instanceInfo=this._instanceInfo.map(o=>({...o})),r.availableInstanceIds=this._availableInstanceIds.slice(),r.availableGeometryIds=this._availableGeometryIds.slice(),r.nextIndexStart=this._nextIndexStart,r.nextVertexStart=this._nextVertexStart,r.geometryCount=this._geometryCount,r.maxInstanceCount=this._maxInstanceCount,r.maxVertexCount=this._maxVertexCount,r.maxIndexCount=this._maxIndexCount,r.geometryInitialized=this._geometryInitialized,r.matricesTexture=this._matricesTexture.toJSON(e),r.indirectTexture=this._indirectTexture.toJSON(e),this._colorsTexture!==null&&(r.colorsTexture=this._colorsTexture.toJSON(e)),this.boundingSphere!==null&&(r.boundingSphere={center:this.boundingSphere.center.toArray(),radius:this.boundingSphere.radius}),this.boundingBox!==null&&(r.boundingBox={min:this.boundingBox.min.toArray(),max:this.boundingBox.max.toArray()}));function s(o,c){return o[c.uuid]===void 0&&(o[c.uuid]=c.toJSON(e)),c.uuid}if(this.isScene)this.background&&(this.background.isColor?r.background=this.background.toJSON():this.background.isTexture&&(r.background=this.background.toJSON(e).uuid)),this.environment&&this.environment.isTexture&&this.environment.isRenderTargetTexture!==!0&&(r.environment=this.environment.toJSON(e).uuid);else if(this.isMesh||this.isLine||this.isPoints){r.geometry=s(e.geometries,this.geometry);const o=this.geometry.parameters;if(o!==void 0&&o.shapes!==void 0){const c=o.shapes;if(Array.isArray(c))for(let l=0,u=c.length;l<u;l++){const h=c[l];s(e.shapes,h)}else s(e.shapes,c)}}if(this.isSkinnedMesh&&(r.bindMode=this.bindMode,r.bindMatrix=this.bindMatrix.toArray(),this.skeleton!==void 0&&(s(e.skeletons,this.skeleton),r.skeleton=this.skeleton.uuid)),this.material!==void 0)if(Array.isArray(this.material)){const o=[];for(let c=0,l=this.material.length;c<l;c++)o.push(s(e.materials,this.material[c]));r.material=o}else r.material=s(e.materials,this.material);if(this.children.length>0){r.children=[];for(let o=0;o<this.children.length;o++)r.children.push(this.children[o].toJSON(e).object)}if(this.animations.length>0){r.animations=[];for(let o=0;o<this.animations.length;o++){const c=this.animations[o];r.animations.push(s(e.animations,c))}}if(n){const o=a(e.geometries),c=a(e.materials),l=a(e.textures),u=a(e.images),h=a(e.shapes),f=a(e.skeletons),d=a(e.animations),p=a(e.nodes);o.length>0&&(i.geometries=o),c.length>0&&(i.materials=c),l.length>0&&(i.textures=l),u.length>0&&(i.images=u),h.length>0&&(i.shapes=h),f.length>0&&(i.skeletons=f),d.length>0&&(i.animations=d),p.length>0&&(i.nodes=p)}return i.object=r,i;function a(o){const c=[];for(const l in o){const u=o[l];delete u.metadata,c.push(u)}return c}}clone(e){return new this.constructor().copy(this,e)}copy(e,n=!0){if(this.name=e.name,this.up.copy(e.up),this.position.copy(e.position),this.rotation.order=e.rotation.order,this.quaternion.copy(e.quaternion),this.scale.copy(e.scale),this.matrix.copy(e.matrix),this.matrixWorld.copy(e.matrixWorld),this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrixWorldAutoUpdate=e.matrixWorldAutoUpdate,this.matrixWorldNeedsUpdate=e.matrixWorldNeedsUpdate,this.layers.mask=e.layers.mask,this.visible=e.visible,this.castShadow=e.castShadow,this.receiveShadow=e.receiveShadow,this.frustumCulled=e.frustumCulled,this.renderOrder=e.renderOrder,this.animations=e.animations.slice(),this.userData=JSON.parse(JSON.stringify(e.userData)),n===!0)for(let i=0;i<e.children.length;i++){const r=e.children[i];this.add(r.clone())}return this}}qr.DEFAULT_UP=new Ae(0,1,0);qr.DEFAULT_MATRIX_AUTO_UPDATE=!0;qr.DEFAULT_MATRIX_WORLD_AUTO_UPDATE=!0;const Zp=new Ae,Sv=new Ae,j8=new Ae,Tv=new Ae,Ex=new Ae,Sx=new Ae,EZ=new Ae,V8=new Ae,G8=new Ae,q8=new Ae,$8=new Zr,W8=new Zr,Y8=new Zr;class Gh{constructor(e=new Ae,n=new Ae,i=new Ae){this.a=e,this.b=n,this.c=i}static getNormal(e,n,i,r){r.subVectors(i,n),Zp.subVectors(e,n),r.cross(Zp);const s=r.lengthSq();return s>0?r.multiplyScalar(1/Math.sqrt(s)):r.set(0,0,0)}static getBarycoord(e,n,i,r,s){Zp.subVectors(r,n),Sv.subVectors(i,n),j8.subVectors(e,n);const a=Zp.dot(Zp),o=Zp.dot(Sv),c=Zp.dot(j8),l=Sv.dot(Sv),u=Sv.dot(j8),h=a*l-o*o;if(h===0)return s.set(0,0,0),null;const f=1/h,d=(l*c-o*u)*f,p=(a*u-o*c)*f;return s.set(1-d-p,p,d)}static containsPoint(e,n,i,r){return this.getBarycoord(e,n,i,r,Tv)===null?!1:Tv.x>=0&&Tv.y>=0&&Tv.x+Tv.y<=1}static getInterpolation(e,n,i,r,s,a,o,c){return this.getBarycoord(e,n,i,r,Tv)===null?(c.x=0,c.y=0,"z"in c&&(c.z=0),"w"in c&&(c.w=0),null):(c.setScalar(0),c.addScaledVector(s,Tv.x),c.addScaledVector(a,Tv.y),c.addScaledVector(o,Tv.z),c)}static getInterpolatedAttribute(e,n,i,r,s,a){return $8.setScalar(0),W8.setScalar(0),Y8.setScalar(0),$8.fromBufferAttribute(e,n),W8.fromBufferAttribute(e,i),Y8.fromBufferAttribute(e,r),a.setScalar(0),a.addScaledVector($8,s.x),a.addScaledVector(W8,s.y),a.addScaledVector(Y8,s.z),a}static isFrontFacing(e,n,i,r){return Zp.subVectors(i,n),Sv.subVectors(e,n),Zp.cross(Sv).dot(r)<0}set(e,n,i){return this.a.copy(e),this.b.copy(n),this.c.copy(i),this}setFromPointsAndIndices(e,n,i,r){return this.a.copy(e[n]),this.b.copy(e[i]),this.c.copy(e[r]),this}setFromAttributeAndIndices(e,n,i,r){return this.a.fromBufferAttribute(e,n),this.b.fromBufferAttribute(e,i),this.c.fromBufferAttribute(e,r),this}clone(){return new this.constructor().copy(this)}copy(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this}getArea(){return Zp.subVectors(this.c,this.b),Sv.subVectors(this.a,this.b),Zp.cross(Sv).length()*.5}getMidpoint(e){return e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(e){return Gh.getNormal(this.a,this.b,this.c,e)}getPlane(e){return e.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(e,n){return Gh.getBarycoord(e,this.a,this.b,this.c,n)}getInterpolation(e,n,i,r,s){return Gh.getInterpolation(e,this.a,this.b,this.c,n,i,r,s)}containsPoint(e){return Gh.containsPoint(e,this.a,this.b,this.c)}isFrontFacing(e){return Gh.isFrontFacing(this.a,this.b,this.c,e)}intersectsBox(e){return e.intersectsTriangle(this)}closestPointToPoint(e,n){const i=this.a,r=this.b,s=this.c;let a,o;Ex.subVectors(r,i),Sx.subVectors(s,i),V8.subVectors(e,i);const c=Ex.dot(V8),l=Sx.dot(V8);if(c<=0&&l<=0)return n.copy(i);G8.subVectors(e,r);const u=Ex.dot(G8),h=Sx.dot(G8);if(u>=0&&h<=u)return n.copy(r);const f=c*h-u*l;if(f<=0&&c>=0&&u<=0)return a=c/(c-u),n.copy(i).addScaledVector(Ex,a);q8.subVectors(e,s);const d=Ex.dot(q8),p=Sx.dot(q8);if(p>=0&&d<=p)return n.copy(s);const g=d*l-c*p;if(g<=0&&l>=0&&p<=0)return o=l/(l-p),n.copy(i).addScaledVector(Sx,o);const y=u*p-d*h;if(y<=0&&h-u>=0&&d-p>=0)return EZ.subVectors(s,r),o=(h-u)/(h-u+(d-p)),n.copy(r).addScaledVector(EZ,o);const v=1/(y+g+f);return a=g*v,o=f*v,n.copy(i).addScaledVector(Ex,a).addScaledVector(Sx,o)}equals(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}}const Ice={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},xy={h:0,s:0,l:0},Jk={h:0,s:0,l:0};function X8(t,e,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?t+(e-t)*6*n:n<1/2?e:n<2/3?t+(e-t)*6*(2/3-n):t}class yn{constructor(e,n,i){return this.isColor=!0,this.r=1,this.g=1,this.b=1,this.set(e,n,i)}set(e,n,i){if(n===void 0&&i===void 0){const r=e;r&&r.isColor?this.copy(r):typeof r=="number"?this.setHex(r):typeof r=="string"&&this.setStyle(r)}else this.setRGB(e,n,i);return this}setScalar(e){return this.r=e,this.g=e,this.b=e,this}setHex(e,n=ba){return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(e&255)/255,Ur.toWorkingColorSpace(this,n),this}setRGB(e,n,i,r=Ur.workingColorSpace){return this.r=e,this.g=n,this.b=i,Ur.toWorkingColorSpace(this,r),this}setHSL(e,n,i,r=Ur.workingColorSpace){if(e=u7(e,1),n=Xi(n,0,1),i=Xi(i,0,1),n===0)this.r=this.g=this.b=i;else{const s=i<=.5?i*(1+n):i+n-i*n,a=2*i-s;this.r=X8(a,s,e+1/3),this.g=X8(a,s,e),this.b=X8(a,s,e-1/3)}return Ur.toWorkingColorSpace(this,r),this}setStyle(e,n=ba){function i(s){s!==void 0&&parseFloat(s)<1&&console.warn("THREE.Color: Alpha component of "+e+" will be ignored.")}let r;if(r=/^(\w+)\(([^\)]*)\)/.exec(e)){let s;const a=r[1],o=r[2];switch(a){case"rgb":case"rgba":if(s=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(o))return i(s[4]),this.setRGB(Math.min(255,parseInt(s[1],10))/255,Math.min(255,parseInt(s[2],10))/255,Math.min(255,parseInt(s[3],10))/255,n);if(s=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(o))return i(s[4]),this.setRGB(Math.min(100,parseInt(s[1],10))/100,Math.min(100,parseInt(s[2],10))/100,Math.min(100,parseInt(s[3],10))/100,n);break;case"hsl":case"hsla":if(s=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(o))return i(s[4]),this.setHSL(parseFloat(s[1])/360,parseFloat(s[2])/100,parseFloat(s[3])/100,n);break;default:console.warn("THREE.Color: Unknown color model "+e)}}else if(r=/^\#([A-Fa-f\d]+)$/.exec(e)){const s=r[1],a=s.length;if(a===3)return this.setRGB(parseInt(s.charAt(0),16)/15,parseInt(s.charAt(1),16)/15,parseInt(s.charAt(2),16)/15,n);if(a===6)return this.setHex(parseInt(s,16),n);console.warn("THREE.Color: Invalid hex color "+e)}else if(e&&e.length>0)return this.setColorName(e,n);return this}setColorName(e,n=ba){const i=Ice[e.toLowerCase()];return i!==void 0?this.setHex(i,n):console.warn("THREE.Color: Unknown color "+e),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(e){return this.r=e.r,this.g=e.g,this.b=e.b,this}copySRGBToLinear(e){return this.r=a_(e.r),this.g=a_(e.g),this.b=a_(e.b),this}copyLinearToSRGB(e){return this.r=Hw(e.r),this.g=Hw(e.g),this.b=Hw(e.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(e=ba){return Ur.fromWorkingColorSpace(nu.copy(this),e),Math.round(Xi(nu.r*255,0,255))*65536+Math.round(Xi(nu.g*255,0,255))*256+Math.round(Xi(nu.b*255,0,255))}getHexString(e=ba){return("000000"+this.getHex(e).toString(16)).slice(-6)}getHSL(e,n=Ur.workingColorSpace){Ur.fromWorkingColorSpace(nu.copy(this),n);const i=nu.r,r=nu.g,s=nu.b,a=Math.max(i,r,s),o=Math.min(i,r,s);let c,l;const u=(o+a)/2;if(o===a)c=0,l=0;else{const h=a-o;switch(l=u<=.5?h/(a+o):h/(2-a-o),a){case i:c=(r-s)/h+(r<s?6:0);break;case r:c=(s-i)/h+2;break;case s:c=(i-r)/h+4;break}c/=6}return e.h=c,e.s=l,e.l=u,e}getRGB(e,n=Ur.workingColorSpace){return Ur.fromWorkingColorSpace(nu.copy(this),n),e.r=nu.r,e.g=nu.g,e.b=nu.b,e}getStyle(e=ba){Ur.fromWorkingColorSpace(nu.copy(this),e);const n=nu.r,i=nu.g,r=nu.b;return e!==ba?`color(${e} ${n.toFixed(3)} ${i.toFixed(3)} ${r.toFixed(3)})`:`rgb(${Math.round(n*255)},${Math.round(i*255)},${Math.round(r*255)})`}offsetHSL(e,n,i){return this.getHSL(xy),this.setHSL(xy.h+e,xy.s+n,xy.l+i)}add(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this}addColors(e,n){return this.r=e.r+n.r,this.g=e.g+n.g,this.b=e.b+n.b,this}addScalar(e){return this.r+=e,this.g+=e,this.b+=e,this}sub(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this}multiply(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this}multiplyScalar(e){return this.r*=e,this.g*=e,this.b*=e,this}lerp(e,n){return this.r+=(e.r-this.r)*n,this.g+=(e.g-this.g)*n,this.b+=(e.b-this.b)*n,this}lerpColors(e,n,i){return this.r=e.r+(n.r-e.r)*i,this.g=e.g+(n.g-e.g)*i,this.b=e.b+(n.b-e.b)*i,this}lerpHSL(e,n){this.getHSL(xy),e.getHSL(Jk);const i=xM(xy.h,Jk.h,n),r=xM(xy.s,Jk.s,n),s=xM(xy.l,Jk.l,n);return this.setHSL(i,r,s),this}setFromVector3(e){return this.r=e.x,this.g=e.y,this.b=e.z,this}applyMatrix3(e){const n=this.r,i=this.g,r=this.b,s=e.elements;return this.r=s[0]*n+s[3]*i+s[6]*r,this.g=s[1]*n+s[4]*i+s[7]*r,this.b=s[2]*n+s[5]*i+s[8]*r,this}equals(e){return e.r===this.r&&e.g===this.g&&e.b===this.b}fromArray(e,n=0){return this.r=e[n],this.g=e[n+1],this.b=e[n+2],this}toArray(e=[],n=0){return e[n]=this.r,e[n+1]=this.g,e[n+2]=this.b,e}fromBufferAttribute(e,n){return this.r=e.getX(n),this.g=e.getY(n),this.b=e.getZ(n),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}}const nu=new yn;yn.NAMES=Ice;let Lwe=0;class Tl extends cd{constructor(){super(),this.isMaterial=!0,Object.defineProperty(this,"id",{value:Lwe++}),this.uuid=ed(),this.name="",this.type="Material",this.blending=pT,this.side=Zg,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.alphaHash=!1,this.blendSrc=lL,this.blendDst=uL,this.blendEquation=nb,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.blendColor=new yn(0,0,0),this.blendAlpha=0,this.depthFunc=NT,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=mV,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=HS,this.stencilZFail=HS,this.stencilZPass=HS,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.forceSinglePass=!1,this.allowOverride=!0,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(e){this._alphaTest>0!=e>0&&this.version++,this._alphaTest=e}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(e){if(e!==void 0)for(const n in e){const i=e[n];if(i===void 0){console.warn(`THREE.Material: parameter '${n}' has value of undefined.`);continue}const r=this[n];if(r===void 0){console.warn(`THREE.Material: '${n}' is not a property of THREE.${this.type}.`);continue}r&&r.isColor?r.set(i):r&&r.isVector3&&i&&i.isVector3?r.copy(i):this[n]=i}}toJSON(e){const n=e===void 0||typeof e=="string";n&&(e={textures:{},images:{}});const i={metadata:{version:4.6,type:"Material",generator:"Material.toJSON"}};i.uuid=this.uuid,i.type=this.type,this.name!==""&&(i.name=this.name),this.color&&this.color.isColor&&(i.color=this.color.getHex()),this.roughness!==void 0&&(i.roughness=this.roughness),this.metalness!==void 0&&(i.metalness=this.metalness),this.sheen!==void 0&&(i.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(i.sheenColor=this.sheenColor.getHex()),this.sheenRoughness!==void 0&&(i.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(i.emissive=this.emissive.getHex()),this.emissiveIntensity!==void 0&&this.emissiveIntensity!==1&&(i.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(i.specular=this.specular.getHex()),this.specularIntensity!==void 0&&(i.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(i.specularColor=this.specularColor.getHex()),this.shininess!==void 0&&(i.shininess=this.shininess),this.clearcoat!==void 0&&(i.clearcoat=this.clearcoat),this.clearcoatRoughness!==void 0&&(i.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(i.clearcoatMap=this.clearcoatMap.toJSON(e).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(i.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(e).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(i.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(e).uuid,i.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.dispersion!==void 0&&(i.dispersion=this.dispersion),this.iridescence!==void 0&&(i.iridescence=this.iridescence),this.iridescenceIOR!==void 0&&(i.iridescenceIOR=this.iridescenceIOR),this.iridescenceThicknessRange!==void 0&&(i.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&(i.iridescenceMap=this.iridescenceMap.toJSON(e).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(i.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(e).uuid),this.anisotropy!==void 0&&(i.anisotropy=this.anisotropy),this.anisotropyRotation!==void 0&&(i.anisotropyRotation=this.anisotropyRotation),this.anisotropyMap&&this.anisotropyMap.isTexture&&(i.anisotropyMap=this.anisotropyMap.toJSON(e).uuid),this.map&&this.map.isTexture&&(i.map=this.map.toJSON(e).uuid),this.matcap&&this.matcap.isTexture&&(i.matcap=this.matcap.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(i.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(i.lightMap=this.lightMap.toJSON(e).uuid,i.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(i.aoMap=this.aoMap.toJSON(e).uuid,i.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(i.bumpMap=this.bumpMap.toJSON(e).uuid,i.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(i.normalMap=this.normalMap.toJSON(e).uuid,i.normalMapType=this.normalMapType,i.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(i.displacementMap=this.displacementMap.toJSON(e).uuid,i.displacementScale=this.displacementScale,i.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(i.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(i.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(i.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(i.specularMap=this.specularMap.toJSON(e).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(i.specularIntensityMap=this.specularIntensityMap.toJSON(e).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(i.specularColorMap=this.specularColorMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(i.envMap=this.envMap.toJSON(e).uuid,this.combine!==void 0&&(i.combine=this.combine)),this.envMapRotation!==void 0&&(i.envMapRotation=this.envMapRotation.toArray()),this.envMapIntensity!==void 0&&(i.envMapIntensity=this.envMapIntensity),this.reflectivity!==void 0&&(i.reflectivity=this.reflectivity),this.refractionRatio!==void 0&&(i.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(i.gradientMap=this.gradientMap.toJSON(e).uuid),this.transmission!==void 0&&(i.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(i.transmissionMap=this.transmissionMap.toJSON(e).uuid),this.thickness!==void 0&&(i.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(i.thicknessMap=this.thicknessMap.toJSON(e).uuid),this.attenuationDistance!==void 0&&this.attenuationDistance!==1/0&&(i.attenuationDistance=this.attenuationDistance),this.attenuationColor!==void 0&&(i.attenuationColor=this.attenuationColor.getHex()),this.size!==void 0&&(i.size=this.size),this.shadowSide!==null&&(i.shadowSide=this.shadowSide),this.sizeAttenuation!==void 0&&(i.sizeAttenuation=this.sizeAttenuation),this.blending!==pT&&(i.blending=this.blending),this.side!==Zg&&(i.side=this.side),this.vertexColors===!0&&(i.vertexColors=!0),this.opacity<1&&(i.opacity=this.opacity),this.transparent===!0&&(i.transparent=!0),this.blendSrc!==lL&&(i.blendSrc=this.blendSrc),this.blendDst!==uL&&(i.blendDst=this.blendDst),this.blendEquation!==nb&&(i.blendEquation=this.blendEquation),this.blendSrcAlpha!==null&&(i.blendSrcAlpha=this.blendSrcAlpha),this.blendDstAlpha!==null&&(i.blendDstAlpha=this.blendDstAlpha),this.blendEquationAlpha!==null&&(i.blendEquationAlpha=this.blendEquationAlpha),this.blendColor&&this.blendColor.isColor&&(i.blendColor=this.blendColor.getHex()),this.blendAlpha!==0&&(i.blendAlpha=this.blendAlpha),this.depthFunc!==NT&&(i.depthFunc=this.depthFunc),this.depthTest===!1&&(i.depthTest=this.depthTest),this.depthWrite===!1&&(i.depthWrite=this.depthWrite),this.colorWrite===!1&&(i.colorWrite=this.colorWrite),this.stencilWriteMask!==255&&(i.stencilWriteMask=this.stencilWriteMask),this.stencilFunc!==mV&&(i.stencilFunc=this.stencilFunc),this.stencilRef!==0&&(i.stencilRef=this.stencilRef),this.stencilFuncMask!==255&&(i.stencilFuncMask=this.stencilFuncMask),this.stencilFail!==HS&&(i.stencilFail=this.stencilFail),this.stencilZFail!==HS&&(i.stencilZFail=this.stencilZFail),this.stencilZPass!==HS&&(i.stencilZPass=this.stencilZPass),this.stencilWrite===!0&&(i.stencilWrite=this.stencilWrite),this.rotation!==void 0&&this.rotation!==0&&(i.rotation=this.rotation),this.polygonOffset===!0&&(i.polygonOffset=!0),this.polygonOffsetFactor!==0&&(i.polygonOffsetFactor=this.polygonOffsetFactor),this.polygonOffsetUnits!==0&&(i.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth!==void 0&&this.linewidth!==1&&(i.linewidth=this.linewidth),this.dashSize!==void 0&&(i.dashSize=this.dashSize),this.gapSize!==void 0&&(i.gapSize=this.gapSize),this.scale!==void 0&&(i.scale=this.scale),this.dithering===!0&&(i.dithering=!0),this.alphaTest>0&&(i.alphaTest=this.alphaTest),this.alphaHash===!0&&(i.alphaHash=!0),this.alphaToCoverage===!0&&(i.alphaToCoverage=!0),this.premultipliedAlpha===!0&&(i.premultipliedAlpha=!0),this.forceSinglePass===!0&&(i.forceSinglePass=!0),this.wireframe===!0&&(i.wireframe=!0),this.wireframeLinewidth>1&&(i.wireframeLinewidth=this.wireframeLinewidth),this.wireframeLinecap!=="round"&&(i.wireframeLinecap=this.wireframeLinecap),this.wireframeLinejoin!=="round"&&(i.wireframeLinejoin=this.wireframeLinejoin),this.flatShading===!0&&(i.flatShading=!0),this.visible===!1&&(i.visible=!1),this.toneMapped===!1&&(i.toneMapped=!1),this.fog===!1&&(i.fog=!1),Object.keys(this.userData).length>0&&(i.userData=this.userData);function r(s){const a=[];for(const o in s){const c=s[o];delete c.metadata,a.push(c)}return a}if(n){const s=r(e.textures),a=r(e.images);s.length>0&&(i.textures=s),a.length>0&&(i.images=a)}return i}clone(){return new this.constructor().copy(this)}copy(e){this.name=e.name,this.blending=e.blending,this.side=e.side,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.blendColor.copy(e.blendColor),this.blendAlpha=e.blendAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.stencilWriteMask=e.stencilWriteMask,this.stencilFunc=e.stencilFunc,this.stencilRef=e.stencilRef,this.stencilFuncMask=e.stencilFuncMask,this.stencilFail=e.stencilFail,this.stencilZFail=e.stencilZFail,this.stencilZPass=e.stencilZPass,this.stencilWrite=e.stencilWrite;const n=e.clippingPlanes;let i=null;if(n!==null){const r=n.length;i=new Array(r);for(let s=0;s!==r;++s)i[s]=n[s].clone()}return this.clippingPlanes=i,this.clipIntersection=e.clipIntersection,this.clipShadows=e.clipShadows,this.shadowSide=e.shadowSide,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.alphaHash=e.alphaHash,this.alphaToCoverage=e.alphaToCoverage,this.premultipliedAlpha=e.premultipliedAlpha,this.forceSinglePass=e.forceSinglePass,this.visible=e.visible,this.toneMapped=e.toneMapped,this.userData=JSON.parse(JSON.stringify(e.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(e){e===!0&&this.version++}}class fE extends Tl{constructor(e){super(),this.isMeshBasicMaterial=!0,this.type="MeshBasicMaterial",this.color=new yn(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new rf,this.combine=QN,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}const Gv=Uwe();function Uwe(){const t=new ArrayBuffer(4),e=new Float32Array(t),n=new Uint32Array(t),i=new Uint32Array(512),r=new Uint32Array(512);for(let c=0;c<256;++c){const l=c-127;l<-27?(i[c]=0,i[c|256]=32768,r[c]=24,r[c|256]=24):l<-14?(i[c]=1024>>-l-14,i[c|256]=1024>>-l-14|32768,r[c]=-l-1,r[c|256]=-l-1):l<=15?(i[c]=l+15<<10,i[c|256]=l+15<<10|32768,r[c]=13,r[c|256]=13):l<128?(i[c]=31744,i[c|256]=64512,r[c]=24,r[c|256]=24):(i[c]=31744,i[c|256]=64512,r[c]=13,r[c|256]=13)}const s=new Uint32Array(2048),a=new Uint32Array(64),o=new Uint32Array(64);for(let c=1;c<1024;++c){let l=c<<13,u=0;for(;!(l&8388608);)l<<=1,u-=8388608;l&=-8388609,u+=947912704,s[c]=l|u}for(let c=1024;c<2048;++c)s[c]=939524096+(c-1024<<13);for(let c=1;c<31;++c)a[c]=c<<23;a[31]=1199570944,a[32]=2147483648;for(let c=33;c<63;++c)a[c]=2147483648+(c-32<<23);a[63]=3347054592;for(let c=1;c<64;++c)c!==32&&(o[c]=1024);return{floatView:e,uint32View:n,baseTable:i,shiftTable:r,mantissaTable:s,exponentTable:a,offsetTable:o}}function Lh(t){Math.abs(t)>65504&&console.warn("THREE.DataUtils.toHalfFloat(): Value out of range."),t=Xi(t,-65504,65504),Gv.floatView[0]=t;const e=Gv.uint32View[0],n=e>>23&511;return Gv.baseTable[n]+((e&8388607)>>Gv.shiftTable[n])}function QR(t){const e=t>>10;return Gv.uint32View[0]=Gv.mantissaTable[Gv.offsetTable[e]+(t&1023)]+Gv.exponentTable[e],Gv.floatView[0]}class Bwe{static toHalfFloat(e){return Lh(e)}static fromHalfFloat(e){return QR(e)}}const rc=new Ae,Qk=new Rt;let Fwe=0;class rr{constructor(e,n,i=!1){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,Object.defineProperty(this,"id",{value:Fwe++}),this.name="",this.array=e,this.itemSize=n,this.count=e!==void 0?e.length/n:0,this.normalized=i,this.usage=gO,this.updateRanges=[],this.gpuType=hu,this.version=0}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}setUsage(e){return this.usage=e,this}addUpdateRange(e,n){this.updateRanges.push({start:e,count:n})}clearUpdateRanges(){this.updateRanges.length=0}copy(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.usage=e.usage,this.gpuType=e.gpuType,this}copyAt(e,n,i){e*=this.itemSize,i*=n.itemSize;for(let r=0,s=this.itemSize;r<s;r++)this.array[e+r]=n.array[i+r];return this}copyArray(e){return this.array.set(e),this}applyMatrix3(e){if(this.itemSize===2)for(let n=0,i=this.count;n<i;n++)Qk.fromBufferAttribute(this,n),Qk.applyMatrix3(e),this.setXY(n,Qk.x,Qk.y);else if(this.itemSize===3)for(let n=0,i=this.count;n<i;n++)rc.fromBufferAttribute(this,n),rc.applyMatrix3(e),this.setXYZ(n,rc.x,rc.y,rc.z);return this}applyMatrix4(e){for(let n=0,i=this.count;n<i;n++)rc.fromBufferAttribute(this,n),rc.applyMatrix4(e),this.setXYZ(n,rc.x,rc.y,rc.z);return this}applyNormalMatrix(e){for(let n=0,i=this.count;n<i;n++)rc.fromBufferAttribute(this,n),rc.applyNormalMatrix(e),this.setXYZ(n,rc.x,rc.y,rc.z);return this}transformDirection(e){for(let n=0,i=this.count;n<i;n++)rc.fromBufferAttribute(this,n),rc.transformDirection(e),this.setXYZ(n,rc.x,rc.y,rc.z);return this}set(e,n=0){return this.array.set(e,n),this}getComponent(e,n){let i=this.array[e*this.itemSize+n];return this.normalized&&(i=th(i,this.array)),i}setComponent(e,n,i){return this.normalized&&(i=tr(i,this.array)),this.array[e*this.itemSize+n]=i,this}getX(e){let n=this.array[e*this.itemSize];return this.normalized&&(n=th(n,this.array)),n}setX(e,n){return this.normalized&&(n=tr(n,this.array)),this.array[e*this.itemSize]=n,this}getY(e){let n=this.array[e*this.itemSize+1];return this.normalized&&(n=th(n,this.array)),n}setY(e,n){return this.normalized&&(n=tr(n,this.array)),this.array[e*this.itemSize+1]=n,this}getZ(e){let n=this.array[e*this.itemSize+2];return this.normalized&&(n=th(n,this.array)),n}setZ(e,n){return this.normalized&&(n=tr(n,this.array)),this.array[e*this.itemSize+2]=n,this}getW(e){let n=this.array[e*this.itemSize+3];return this.normalized&&(n=th(n,this.array)),n}setW(e,n){return this.normalized&&(n=tr(n,this.array)),this.array[e*this.itemSize+3]=n,this}setXY(e,n,i){return e*=this.itemSize,this.normalized&&(n=tr(n,this.array),i=tr(i,this.array)),this.array[e+0]=n,this.array[e+1]=i,this}setXYZ(e,n,i,r){return e*=this.itemSize,this.normalized&&(n=tr(n,this.array),i=tr(i,this.array),r=tr(r,this.array)),this.array[e+0]=n,this.array[e+1]=i,this.array[e+2]=r,this}setXYZW(e,n,i,r,s){return e*=this.itemSize,this.normalized&&(n=tr(n,this.array),i=tr(i,this.array),r=tr(r,this.array),s=tr(s,this.array)),this.array[e+0]=n,this.array[e+1]=i,this.array[e+2]=r,this.array[e+3]=s,this}onUpload(e){return this.onUploadCallback=e,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){const e={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};return this.name!==""&&(e.name=this.name),this.usage!==gO&&(e.usage=this.usage),e}}class zwe extends rr{constructor(e,n,i){super(new Int8Array(e),n,i)}}class Hwe extends rr{constructor(e,n,i){super(new Uint8Array(e),n,i)}}class jwe extends rr{constructor(e,n,i){super(new Uint8ClampedArray(e),n,i)}}class Vwe extends rr{constructor(e,n,i){super(new Int16Array(e),n,i)}}class h7 extends rr{constructor(e,n,i){super(new Uint16Array(e),n,i)}}class Gwe extends rr{constructor(e,n,i){super(new Int32Array(e),n,i)}}class f7 extends rr{constructor(e,n,i){super(new Uint32Array(e),n,i)}}class qwe extends rr{constructor(e,n,i){super(new Uint16Array(e),n,i),this.isFloat16BufferAttribute=!0}getX(e){let n=QR(this.array[e*this.itemSize]);return this.normalized&&(n=th(n,this.array)),n}setX(e,n){return this.normalized&&(n=tr(n,this.array)),this.array[e*this.itemSize]=Lh(n),this}getY(e){let n=QR(this.array[e*this.itemSize+1]);return this.normalized&&(n=th(n,this.array)),n}setY(e,n){return this.normalized&&(n=tr(n,this.array)),this.array[e*this.itemSize+1]=Lh(n),this}getZ(e){let n=QR(this.array[e*this.itemSize+2]);return this.normalized&&(n=th(n,this.array)),n}setZ(e,n){return this.normalized&&(n=tr(n,this.array)),this.array[e*this.itemSize+2]=Lh(n),this}getW(e){let n=QR(this.array[e*this.itemSize+3]);return this.normalized&&(n=th(n,this.array)),n}setW(e,n){return this.normalized&&(n=tr(n,this.array)),this.array[e*this.itemSize+3]=Lh(n),this}setXY(e,n,i){return e*=this.itemSize,this.normalized&&(n=tr(n,this.array),i=tr(i,this.array)),this.array[e+0]=Lh(n),this.array[e+1]=Lh(i),this}setXYZ(e,n,i,r){return e*=this.itemSize,this.normalized&&(n=tr(n,this.array),i=tr(i,this.array),r=tr(r,this.array)),this.array[e+0]=Lh(n),this.array[e+1]=Lh(i),this.array[e+2]=Lh(r),this}setXYZW(e,n,i,r,s){return e*=this.itemSize,this.normalized&&(n=tr(n,this.array),i=tr(i,this.array),r=tr(r,this.array),s=tr(s,this.array)),this.array[e+0]=Lh(n),this.array[e+1]=Lh(i),this.array[e+2]=Lh(r),this.array[e+3]=Lh(s),this}}class Hn extends rr{constructor(e,n,i){super(new Float32Array(e),n,i)}}let $we=0;const kd=new Ni,K8=new qr,Tx=new Ae,Df=new gu,vR=new gu,rl=new Ae;class Qi extends cd{constructor(){super(),this.isBufferGeometry=!0,Object.defineProperty(this,"id",{value:$we++}),this.uuid=ed(),this.name="",this.type="BufferGeometry",this.index=null,this.indirect=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(e){return Array.isArray(e)?this.index=new(Mce(e)?f7:h7)(e,1):this.index=e,this}setIndirect(e){return this.indirect=e,this}getIndirect(){return this.indirect}getAttribute(e){return this.attributes[e]}setAttribute(e,n){return this.attributes[e]=n,this}deleteAttribute(e){return delete this.attributes[e],this}hasAttribute(e){return this.attributes[e]!==void 0}addGroup(e,n,i=0){this.groups.push({start:e,count:n,materialIndex:i})}clearGroups(){this.groups=[]}setDrawRange(e,n){this.drawRange.start=e,this.drawRange.count=n}applyMatrix4(e){const n=this.attributes.position;n!==void 0&&(n.applyMatrix4(e),n.needsUpdate=!0);const i=this.attributes.normal;if(i!==void 0){const s=new Ji().getNormalMatrix(e);i.applyNormalMatrix(s),i.needsUpdate=!0}const r=this.attributes.tangent;return r!==void 0&&(r.transformDirection(e),r.needsUpdate=!0),this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this}applyQuaternion(e){return kd.makeRotationFromQuaternion(e),this.applyMatrix4(kd),this}rotateX(e){return kd.makeRotationX(e),this.applyMatrix4(kd),this}rotateY(e){return kd.makeRotationY(e),this.applyMatrix4(kd),this}rotateZ(e){return kd.makeRotationZ(e),this.applyMatrix4(kd),this}translate(e,n,i){return kd.makeTranslation(e,n,i),this.applyMatrix4(kd),this}scale(e,n,i){return kd.makeScale(e,n,i),this.applyMatrix4(kd),this}lookAt(e){return K8.lookAt(e),K8.updateMatrix(),this.applyMatrix4(K8.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(Tx).negate(),this.translate(Tx.x,Tx.y,Tx.z),this}setFromPoints(e){const n=this.getAttribute("position");if(n===void 0){const i=[];for(let r=0,s=e.length;r<s;r++){const a=e[r];i.push(a.x,a.y,a.z||0)}this.setAttribute("position",new Hn(i,3))}else{const i=Math.min(e.length,n.count);for(let r=0;r<i;r++){const s=e[r];n.setXYZ(r,s.x,s.y,s.z||0)}e.length>n.count&&console.warn("THREE.BufferGeometry: Buffer size too small for points data. Use .dispose() and create a new geometry."),n.needsUpdate=!0}return this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new gu);const e=this.attributes.position,n=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){console.error("THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box.",this),this.boundingBox.set(new Ae(-1/0,-1/0,-1/0),new Ae(1/0,1/0,1/0));return}if(e!==void 0){if(this.boundingBox.setFromBufferAttribute(e),n)for(let i=0,r=n.length;i<r;i++){const s=n[i];Df.setFromBufferAttribute(s),this.morphTargetsRelative?(rl.addVectors(this.boundingBox.min,Df.min),this.boundingBox.expandByPoint(rl),rl.addVectors(this.boundingBox.max,Df.max),this.boundingBox.expandByPoint(rl)):(this.boundingBox.expandByPoint(Df.min),this.boundingBox.expandByPoint(Df.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new zl);const e=this.attributes.position,n=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){console.error("THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere.",this),this.boundingSphere.set(new Ae,1/0);return}if(e){const i=this.boundingSphere.center;if(Df.setFromBufferAttribute(e),n)for(let s=0,a=n.length;s<a;s++){const o=n[s];vR.setFromBufferAttribute(o),this.morphTargetsRelative?(rl.addVectors(Df.min,vR.min),Df.expandByPoint(rl),rl.addVectors(Df.max,vR.max),Df.expandByPoint(rl)):(Df.expandByPoint(vR.min),Df.expandByPoint(vR.max))}Df.getCenter(i);let r=0;for(let s=0,a=e.count;s<a;s++)rl.fromBufferAttribute(e,s),r=Math.max(r,i.distanceToSquared(rl));if(n)for(let s=0,a=n.length;s<a;s++){const o=n[s],c=this.morphTargetsRelative;for(let l=0,u=o.count;l<u;l++)rl.fromBufferAttribute(o,l),c&&(Tx.fromBufferAttribute(e,l),rl.add(Tx)),r=Math.max(r,i.distanceToSquared(rl))}this.boundingSphere.radius=Math.sqrt(r),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){const e=this.index,n=this.attributes;if(e===null||n.position===void 0||n.normal===void 0||n.uv===void 0){console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");return}const i=n.position,r=n.normal,s=n.uv;this.hasAttribute("tangent")===!1&&this.setAttribute("tangent",new rr(new Float32Array(4*i.count),4));const a=this.getAttribute("tangent"),o=[],c=[];for(let k=0;k<i.count;k++)o[k]=new Ae,c[k]=new Ae;const l=new Ae,u=new Ae,h=new Ae,f=new Rt,d=new Rt,p=new Rt,g=new Ae,y=new Ae;function v(k,P,U){l.fromBufferAttribute(i,k),u.fromBufferAttribute(i,P),h.fromBufferAttribute(i,U),f.fromBufferAttribute(s,k),d.fromBufferAttribute(s,P),p.fromBufferAttribute(s,U),u.sub(l),h.sub(l),d.sub(f),p.sub(f);const G=1/(d.x*p.y-p.x*d.y);isFinite(G)&&(g.copy(u).multiplyScalar(p.y).addScaledVector(h,-d.y).multiplyScalar(G),y.copy(h).multiplyScalar(d.x).addScaledVector(u,-p.x).multiplyScalar(G),o[k].add(g),o[P].add(g),o[U].add(g),c[k].add(y),c[P].add(y),c[U].add(y))}let b=this.groups;b.length===0&&(b=[{start:0,count:e.count}]);for(let k=0,P=b.length;k<P;++k){const U=b[k],G=U.start,$=U.count;for(let q=G,Y=G+$;q<Y;q+=3)v(e.getX(q+0),e.getX(q+1),e.getX(q+2))}const T=new Ae,x=new Ae,M=new Ae,R=new Ae;function I(k){M.fromBufferAttribute(r,k),R.copy(M);const P=o[k];T.copy(P),T.sub(M.multiplyScalar(M.dot(P))).normalize(),x.crossVectors(R,P);const G=x.dot(c[k])<0?-1:1;a.setXYZW(k,T.x,T.y,T.z,G)}for(let k=0,P=b.length;k<P;++k){const U=b[k],G=U.start,$=U.count;for(let q=G,Y=G+$;q<Y;q+=3)I(e.getX(q+0)),I(e.getX(q+1)),I(e.getX(q+2))}}computeVertexNormals(){const e=this.index,n=this.getAttribute("position");if(n!==void 0){let i=this.getAttribute("normal");if(i===void 0)i=new rr(new Float32Array(n.count*3),3),this.setAttribute("normal",i);else for(let f=0,d=i.count;f<d;f++)i.setXYZ(f,0,0,0);const r=new Ae,s=new Ae,a=new Ae,o=new Ae,c=new Ae,l=new Ae,u=new Ae,h=new Ae;if(e)for(let f=0,d=e.count;f<d;f+=3){const p=e.getX(f+0),g=e.getX(f+1),y=e.getX(f+2);r.fromBufferAttribute(n,p),s.fromBufferAttribute(n,g),a.fromBufferAttribute(n,y),u.subVectors(a,s),h.subVectors(r,s),u.cross(h),o.fromBufferAttribute(i,p),c.fromBufferAttribute(i,g),l.fromBufferAttribute(i,y),o.add(u),c.add(u),l.add(u),i.setXYZ(p,o.x,o.y,o.z),i.setXYZ(g,c.x,c.y,c.z),i.setXYZ(y,l.x,l.y,l.z)}else for(let f=0,d=n.count;f<d;f+=3)r.fromBufferAttribute(n,f+0),s.fromBufferAttribute(n,f+1),a.fromBufferAttribute(n,f+2),u.subVectors(a,s),h.subVectors(r,s),u.cross(h),i.setXYZ(f+0,u.x,u.y,u.z),i.setXYZ(f+1,u.x,u.y,u.z),i.setXYZ(f+2,u.x,u.y,u.z);this.normalizeNormals(),i.needsUpdate=!0}}normalizeNormals(){const e=this.attributes.normal;for(let n=0,i=e.count;n<i;n++)rl.fromBufferAttribute(e,n),rl.normalize(),e.setXYZ(n,rl.x,rl.y,rl.z)}toNonIndexed(){function e(o,c){const l=o.array,u=o.itemSize,h=o.normalized,f=new l.constructor(c.length*u);let d=0,p=0;for(let g=0,y=c.length;g<y;g++){o.isInterleavedBufferAttribute?d=c[g]*o.data.stride+o.offset:d=c[g]*u;for(let v=0;v<u;v++)f[p++]=l[d++]}return new rr(f,u,h)}if(this.index===null)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;const n=new Qi,i=this.index.array,r=this.attributes;for(const o in r){const c=r[o],l=e(c,i);n.setAttribute(o,l)}const s=this.morphAttributes;for(const o in s){const c=[],l=s[o];for(let u=0,h=l.length;u<h;u++){const f=l[u],d=e(f,i);c.push(d)}n.morphAttributes[o]=c}n.morphTargetsRelative=this.morphTargetsRelative;const a=this.groups;for(let o=0,c=a.length;o<c;o++){const l=a[o];n.addGroup(l.start,l.count,l.materialIndex)}return n}toJSON(){const e={metadata:{version:4.6,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,this.name!==""&&(e.name=this.name),Object.keys(this.userData).length>0&&(e.userData=this.userData),this.parameters!==void 0){const c=this.parameters;for(const l in c)c[l]!==void 0&&(e[l]=c[l]);return e}e.data={attributes:{}};const n=this.index;n!==null&&(e.data.index={type:n.array.constructor.name,array:Array.prototype.slice.call(n.array)});const i=this.attributes;for(const c in i){const l=i[c];e.data.attributes[c]=l.toJSON(e.data)}const r={};let s=!1;for(const c in this.morphAttributes){const l=this.morphAttributes[c],u=[];for(let h=0,f=l.length;h<f;h++){const d=l[h];u.push(d.toJSON(e.data))}u.length>0&&(r[c]=u,s=!0)}s&&(e.data.morphAttributes=r,e.data.morphTargetsRelative=this.morphTargetsRelative);const a=this.groups;a.length>0&&(e.data.groups=JSON.parse(JSON.stringify(a)));const o=this.boundingSphere;return o!==null&&(e.data.boundingSphere={center:o.center.toArray(),radius:o.radius}),e}clone(){return new this.constructor().copy(this)}copy(e){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const n={};this.name=e.name;const i=e.index;i!==null&&this.setIndex(i.clone());const r=e.attributes;for(const l in r){const u=r[l];this.setAttribute(l,u.clone(n))}const s=e.morphAttributes;for(const l in s){const u=[],h=s[l];for(let f=0,d=h.length;f<d;f++)u.push(h[f].clone(n));this.morphAttributes[l]=u}this.morphTargetsRelative=e.morphTargetsRelative;const a=e.groups;for(let l=0,u=a.length;l<u;l++){const h=a[l];this.addGroup(h.start,h.count,h.materialIndex)}const o=e.boundingBox;o!==null&&(this.boundingBox=o.clone());const c=e.boundingSphere;return c!==null&&(this.boundingSphere=c.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,this}dispose(){this.dispatchEvent({type:"dispose"})}}const SZ=new Ni,yS=new _A,eD=new zl,TZ=new Ae,tD=new Ae,nD=new Ae,iD=new Ae,Z8=new Ae,rD=new Ae,xZ=new Ae,sD=new Ae;class jo extends qr{constructor(e=new Qi,n=new fE){super(),this.isMesh=!0,this.type="Mesh",this.geometry=e,this.material=n,this.morphTargetDictionary=void 0,this.morphTargetInfluences=void 0,this.updateMorphTargets()}copy(e,n){return super.copy(e,n),e.morphTargetInfluences!==void 0&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),e.morphTargetDictionary!==void 0&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}updateMorphTargets(){const n=this.geometry.morphAttributes,i=Object.keys(n);if(i.length>0){const r=n[i[0]];if(r!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let s=0,a=r.length;s<a;s++){const o=r[s].name||String(s);this.morphTargetInfluences.push(0),this.morphTargetDictionary[o]=s}}}}getVertexPosition(e,n){const i=this.geometry,r=i.attributes.position,s=i.morphAttributes.position,a=i.morphTargetsRelative;n.fromBufferAttribute(r,e);const o=this.morphTargetInfluences;if(s&&o){rD.set(0,0,0);for(let c=0,l=s.length;c<l;c++){const u=o[c],h=s[c];u!==0&&(Z8.fromBufferAttribute(h,e),a?rD.addScaledVector(Z8,u):rD.addScaledVector(Z8.sub(n),u))}n.add(rD)}return n}raycast(e,n){const i=this.geometry,r=this.material,s=this.matrixWorld;r!==void 0&&(i.boundingSphere===null&&i.computeBoundingSphere(),eD.copy(i.boundingSphere),eD.applyMatrix4(s),yS.copy(e.ray).recast(e.near),!(eD.containsPoint(yS.origin)===!1&&(yS.intersectSphere(eD,TZ)===null||yS.origin.distanceToSquared(TZ)>(e.far-e.near)**2))&&(SZ.copy(s).invert(),yS.copy(e.ray).applyMatrix4(SZ),!(i.boundingBox!==null&&yS.intersectsBox(i.boundingBox)===!1)&&this._computeIntersections(e,n,yS)))}_computeIntersections(e,n,i){let r;const s=this.geometry,a=this.material,o=s.index,c=s.attributes.position,l=s.attributes.uv,u=s.attributes.uv1,h=s.attributes.normal,f=s.groups,d=s.drawRange;if(o!==null)if(Array.isArray(a))for(let p=0,g=f.length;p<g;p++){const y=f[p],v=a[y.materialIndex],b=Math.max(y.start,d.start),T=Math.min(o.count,Math.min(y.start+y.count,d.start+d.count));for(let x=b,M=T;x<M;x+=3){const R=o.getX(x),I=o.getX(x+1),k=o.getX(x+2);r=aD(this,v,e,i,l,u,h,R,I,k),r&&(r.faceIndex=Math.floor(x/3),r.face.materialIndex=y.materialIndex,n.push(r))}}else{const p=Math.max(0,d.start),g=Math.min(o.count,d.start+d.count);for(let y=p,v=g;y<v;y+=3){const b=o.getX(y),T=o.getX(y+1),x=o.getX(y+2);r=aD(this,a,e,i,l,u,h,b,T,x),r&&(r.faceIndex=Math.floor(y/3),n.push(r))}}else if(c!==void 0)if(Array.isArray(a))for(let p=0,g=f.length;p<g;p++){const y=f[p],v=a[y.materialIndex],b=Math.max(y.start,d.start),T=Math.min(c.count,Math.min(y.start+y.count,d.start+d.count));for(let x=b,M=T;x<M;x+=3){const R=x,I=x+1,k=x+2;r=aD(this,v,e,i,l,u,h,R,I,k),r&&(r.faceIndex=Math.floor(x/3),r.face.materialIndex=y.materialIndex,n.push(r))}}else{const p=Math.max(0,d.start),g=Math.min(c.count,d.start+d.count);for(let y=p,v=g;y<v;y+=3){const b=y,T=y+1,x=y+2;r=aD(this,a,e,i,l,u,h,b,T,x),r&&(r.faceIndex=Math.floor(y/3),n.push(r))}}}}function Wwe(t,e,n,i,r,s,a,o){let c;if(e.side===Bc?c=i.intersectTriangle(a,s,r,!0,o):c=i.intersectTriangle(r,s,a,e.side===Zg,o),c===null)return null;sD.copy(o),sD.applyMatrix4(t.matrixWorld);const l=n.ray.origin.distanceTo(sD);return l<n.near||l>n.far?null:{distance:l,point:sD.clone(),object:t}}function aD(t,e,n,i,r,s,a,o,c,l){t.getVertexPosition(o,tD),t.getVertexPosition(c,nD),t.getVertexPosition(l,iD);const u=Wwe(t,e,n,i,tD,nD,iD,xZ);if(u){const h=new Ae;Gh.getBarycoord(xZ,tD,nD,iD,h),r&&(u.uv=Gh.getInterpolatedAttribute(r,o,c,l,h,new Rt)),s&&(u.uv1=Gh.getInterpolatedAttribute(s,o,c,l,h,new Rt)),a&&(u.normal=Gh.getInterpolatedAttribute(a,o,c,l,h,new Ae),u.normal.dot(i.direction)>0&&u.normal.multiplyScalar(-1));const f={a:o,b:c,c:l,normal:new Ae,materialIndex:0};Gh.getNormal(tD,nD,iD,f.normal),u.face=f,u.barycoord=h}return u}class d1 extends Qi{constructor(e=1,n=1,i=1,r=1,s=1,a=1){super(),this.type="BoxGeometry",this.parameters={width:e,height:n,depth:i,widthSegments:r,heightSegments:s,depthSegments:a};const o=this;r=Math.floor(r),s=Math.floor(s),a=Math.floor(a);const c=[],l=[],u=[],h=[];let f=0,d=0;p("z","y","x",-1,-1,i,n,e,a,s,0),p("z","y","x",1,-1,i,n,-e,a,s,1),p("x","z","y",1,1,e,i,n,r,a,2),p("x","z","y",1,-1,e,i,-n,r,a,3),p("x","y","z",1,-1,e,n,i,r,s,4),p("x","y","z",-1,-1,e,n,-i,r,s,5),this.setIndex(c),this.setAttribute("position",new Hn(l,3)),this.setAttribute("normal",new Hn(u,3)),this.setAttribute("uv",new Hn(h,2));function p(g,y,v,b,T,x,M,R,I,k,P){const U=x/I,G=M/k,$=x/2,q=M/2,Y=R/2,ie=I+1,V=k+1;let J=0,X=0;const ee=new Ae;for(let oe=0;oe<V;oe++){const fe=oe*G-q;for(let Re=0;Re<ie;Re++){const He=Re*U-$;ee[g]=He*b,ee[y]=fe*T,ee[v]=Y,l.push(ee.x,ee.y,ee.z),ee[g]=0,ee[y]=0,ee[v]=R>0?1:-1,u.push(ee.x,ee.y,ee.z),h.push(Re/I),h.push(1-oe/k),J+=1}}for(let oe=0;oe<k;oe++)for(let fe=0;fe<I;fe++){const Re=f+fe+ie*oe,He=f+fe+ie*(oe+1),Te=f+(fe+1)+ie*(oe+1),Le=f+(fe+1)+ie*oe;c.push(Re,He,Le),c.push(He,Te,Le),X+=6}o.addGroup(d,X,P),d+=X,f+=J}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new d1(e.width,e.height,e.depth,e.widthSegments,e.heightSegments,e.depthSegments)}}function EC(t){const e={};for(const n in t){e[n]={};for(const i in t[n]){const r=t[n][i];r&&(r.isColor||r.isMatrix3||r.isMatrix4||r.isVector2||r.isVector3||r.isVector4||r.isTexture||r.isQuaternion)?r.isRenderTargetTexture?(console.warn("UniformsUtils: Textures of render targets cannot be cloned via cloneUniforms() or mergeUniforms()."),e[n][i]=null):e[n][i]=r.clone():Array.isArray(r)?e[n][i]=r.slice():e[n][i]=r}}return e}function Yu(t){const e={};for(let n=0;n<t.length;n++){const i=EC(t[n]);for(const r in i)e[r]=i[r]}return e}function Ywe(t){const e=[];for(let n=0;n<t.length;n++)e.push(t[n].clone());return e}function kce(t){const e=t.getRenderTarget();return e===null?t.outputColorSpace:e.isXRRenderTarget===!0?e.texture.colorSpace:Ur.workingColorSpace}const Dce={clone:EC,merge:Yu};var Xwe=`void main() {
	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}`,Kwe=`void main() {
	gl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );
}`;class Hc extends Tl{constructor(e){super(),this.isShaderMaterial=!0,this.type="ShaderMaterial",this.defines={},this.uniforms={},this.uniformsGroups=[],this.vertexShader=Xwe,this.fragmentShader=Kwe,this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.forceSinglePass=!0,this.extensions={clipCullDistance:!1,multiDraw:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv1:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,e!==void 0&&this.setValues(e)}copy(e){return super.copy(e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=EC(e.uniforms),this.uniformsGroups=Ywe(e.uniformsGroups),this.defines=Object.assign({},e.defines),this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.fog=e.fog,this.lights=e.lights,this.clipping=e.clipping,this.extensions=Object.assign({},e.extensions),this.glslVersion=e.glslVersion,this}toJSON(e){const n=super.toJSON(e);n.glslVersion=this.glslVersion,n.uniforms={};for(const r in this.uniforms){const a=this.uniforms[r].value;a&&a.isTexture?n.uniforms[r]={type:"t",value:a.toJSON(e).uuid}:a&&a.isColor?n.uniforms[r]={type:"c",value:a.getHex()}:a&&a.isVector2?n.uniforms[r]={type:"v2",value:a.toArray()}:a&&a.isVector3?n.uniforms[r]={type:"v3",value:a.toArray()}:a&&a.isVector4?n.uniforms[r]={type:"v4",value:a.toArray()}:a&&a.isMatrix3?n.uniforms[r]={type:"m3",value:a.toArray()}:a&&a.isMatrix4?n.uniforms[r]={type:"m4",value:a.toArray()}:n.uniforms[r]={value:a}}Object.keys(this.defines).length>0&&(n.defines=this.defines),n.vertexShader=this.vertexShader,n.fragmentShader=this.fragmentShader,n.lights=this.lights,n.clipping=this.clipping;const i={};for(const r in this.extensions)this.extensions[r]===!0&&(i[r]=!0);return Object.keys(i).length>0&&(n.extensions=i),n}}class iI extends qr{constructor(){super(),this.isCamera=!0,this.type="Camera",this.matrixWorldInverse=new Ni,this.projectionMatrix=new Ni,this.projectionMatrixInverse=new Ni,this.coordinateSystem=ip}copy(e,n){return super.copy(e,n),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this.coordinateSystem=e.coordinateSystem,this}getWorldDirection(e){return super.getWorldDirection(e).negate()}updateMatrixWorld(e){super.updateMatrixWorld(e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(e,n){super.updateWorldMatrix(e,n),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return new this.constructor().copy(this)}}const wy=new Ae,wZ=new Rt,CZ=new Rt;let Pc=class extends iI{constructor(e=50,n=1,i=.1,r=2e3){super(),this.isPerspectiveCamera=!0,this.type="PerspectiveCamera",this.fov=e,this.zoom=1,this.near=i,this.far=r,this.focus=10,this.aspect=n,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(e,n){return super.copy(e,n),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=e.view===null?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this}setFocalLength(e){const n=.5*this.getFilmHeight()/e;this.fov=yC*2*Math.atan(n),this.updateProjectionMatrix()}getFocalLength(){const e=Math.tan(mT*.5*this.fov);return .5*this.getFilmHeight()/e}getEffectiveFOV(){return yC*2*Math.atan(Math.tan(mT*.5*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}getViewBounds(e,n,i){wy.set(-1,-1,.5).applyMatrix4(this.projectionMatrixInverse),n.set(wy.x,wy.y).multiplyScalar(-e/wy.z),wy.set(1,1,.5).applyMatrix4(this.projectionMatrixInverse),i.set(wy.x,wy.y).multiplyScalar(-e/wy.z)}getViewSize(e,n){return this.getViewBounds(e,wZ,CZ),n.subVectors(CZ,wZ)}setViewOffset(e,n,i,r,s,a){this.aspect=e/n,this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=n,this.view.offsetX=i,this.view.offsetY=r,this.view.width=s,this.view.height=a,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=this.near;let n=e*Math.tan(mT*.5*this.fov)/this.zoom,i=2*n,r=this.aspect*i,s=-.5*r;const a=this.view;if(this.view!==null&&this.view.enabled){const c=a.fullWidth,l=a.fullHeight;s+=a.offsetX*r/c,n-=a.offsetY*i/l,r*=a.width/c,i*=a.height/l}const o=this.filmOffset;o!==0&&(s+=e*o/this.getFilmWidth()),this.projectionMatrix.makePerspective(s,s+r,n,n-i,e,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const n=super.toJSON(e);return n.object.fov=this.fov,n.object.zoom=this.zoom,n.object.near=this.near,n.object.far=this.far,n.object.focus=this.focus,n.object.aspect=this.aspect,this.view!==null&&(n.object.view=Object.assign({},this.view)),n.object.filmGauge=this.filmGauge,n.object.filmOffset=this.filmOffset,n}};const xx=-90,wx=1;class Pce extends qr{constructor(e,n,i){super(),this.type="CubeCamera",this.renderTarget=i,this.coordinateSystem=null,this.activeMipmapLevel=0;const r=new Pc(xx,wx,e,n);r.layers=this.layers,this.add(r);const s=new Pc(xx,wx,e,n);s.layers=this.layers,this.add(s);const a=new Pc(xx,wx,e,n);a.layers=this.layers,this.add(a);const o=new Pc(xx,wx,e,n);o.layers=this.layers,this.add(o);const c=new Pc(xx,wx,e,n);c.layers=this.layers,this.add(c);const l=new Pc(xx,wx,e,n);l.layers=this.layers,this.add(l)}updateCoordinateSystem(){const e=this.coordinateSystem,n=this.children.concat(),[i,r,s,a,o,c]=n;for(const l of n)this.remove(l);if(e===ip)i.up.set(0,1,0),i.lookAt(1,0,0),r.up.set(0,1,0),r.lookAt(-1,0,0),s.up.set(0,0,-1),s.lookAt(0,1,0),a.up.set(0,0,1),a.lookAt(0,-1,0),o.up.set(0,1,0),o.lookAt(0,0,1),c.up.set(0,1,0),c.lookAt(0,0,-1);else if(e===vO)i.up.set(0,-1,0),i.lookAt(-1,0,0),r.up.set(0,-1,0),r.lookAt(1,0,0),s.up.set(0,0,1),s.lookAt(0,1,0),a.up.set(0,0,-1),a.lookAt(0,-1,0),o.up.set(0,-1,0),o.lookAt(0,0,1),c.up.set(0,-1,0),c.lookAt(0,0,-1);else throw new Error("THREE.CubeCamera.updateCoordinateSystem(): Invalid coordinate system: "+e);for(const l of n)this.add(l),l.updateMatrixWorld()}update(e,n){this.parent===null&&this.updateMatrixWorld();const{renderTarget:i,activeMipmapLevel:r}=this;this.coordinateSystem!==e.coordinateSystem&&(this.coordinateSystem=e.coordinateSystem,this.updateCoordinateSystem());const[s,a,o,c,l,u]=this.children,h=e.getRenderTarget(),f=e.getActiveCubeFace(),d=e.getActiveMipmapLevel(),p=e.xr.enabled;e.xr.enabled=!1;const g=i.texture.generateMipmaps;i.texture.generateMipmaps=!1,e.setRenderTarget(i,0,r),e.render(n,s),e.setRenderTarget(i,1,r),e.render(n,a),e.setRenderTarget(i,2,r),e.render(n,o),e.setRenderTarget(i,3,r),e.render(n,c),e.setRenderTarget(i,4,r),e.render(n,l),i.texture.generateMipmaps=g,e.setRenderTarget(i,5,r),e.render(n,u),e.setRenderTarget(h,f,d),e.xr.enabled=p,i.texture.needsPMREMUpdate=!0}}class rI extends Ba{constructor(e=[],n=m_,i,r,s,a,o,c,l,u){super(e,n,i,r,s,a,o,c,l,u),this.isCubeTexture=!0,this.flipY=!1}get images(){return this.image}set images(e){this.image=e}}class Lce extends Vl{constructor(e=1,n={}){super(e,e,n),this.isWebGLCubeRenderTarget=!0;const i={width:e,height:e,depth:1},r=[i,i,i,i,i,i];this.texture=new rI(r,n.mapping,n.wrapS,n.wrapT,n.magFilter,n.minFilter,n.format,n.type,n.anisotropy,n.colorSpace),this.texture.isRenderTargetTexture=!0,this.texture.generateMipmaps=n.generateMipmaps!==void 0?n.generateMipmaps:!1,this.texture.minFilter=n.minFilter!==void 0?n.minFilter:Ea}fromEquirectangularTexture(e,n){this.texture.type=n.type,this.texture.colorSpace=n.colorSpace,this.texture.generateMipmaps=n.generateMipmaps,this.texture.minFilter=n.minFilter,this.texture.magFilter=n.magFilter;const i={uniforms:{tEquirect:{value:null}},vertexShader:`

				varying vec3 vWorldDirection;

				vec3 transformDirection( in vec3 dir, in mat4 matrix ) {

					return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );

				}

				void main() {

					vWorldDirection = transformDirection( position, modelMatrix );

					#include <begin_vertex>
					#include <project_vertex>

				}
			`,fragmentShader:`

				uniform sampler2D tEquirect;

				varying vec3 vWorldDirection;

				#include <common>

				void main() {

					vec3 direction = normalize( vWorldDirection );

					vec2 sampleUV = equirectUv( direction );

					gl_FragColor = texture2D( tEquirect, sampleUV );

				}
			`},r=new d1(5,5,5),s=new Hc({name:"CubemapFromEquirect",uniforms:EC(i.uniforms),vertexShader:i.vertexShader,fragmentShader:i.fragmentShader,side:Bc,blending:lp});s.uniforms.tEquirect.value=n;const a=new jo(r,s),o=n.minFilter;return n.minFilter===Ig&&(n.minFilter=Ea),new Pce(1,10,this).update(e,a),n.minFilter=o,a.geometry.dispose(),a.material.dispose(),this}clear(e,n=!0,i=!0,r=!0){const s=e.getRenderTarget();for(let a=0;a<6;a++)e.setRenderTarget(this,a),e.clear(n,i,r);e.setRenderTarget(s)}}class pw extends qr{constructor(){super(),this.isGroup=!0,this.type="Group"}}const Zwe={type:"move"};class ZP{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return this._hand===null&&(this._hand=new pw,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return this._targetRay===null&&(this._targetRay=new pw,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new Ae,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new Ae),this._targetRay}getGripSpace(){return this._grip===null&&(this._grip=new pw,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new Ae,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new Ae),this._grip}dispatchEvent(e){return this._targetRay!==null&&this._targetRay.dispatchEvent(e),this._grip!==null&&this._grip.dispatchEvent(e),this._hand!==null&&this._hand.dispatchEvent(e),this}connect(e){if(e&&e.hand){const n=this._hand;if(n)for(const i of e.hand.values())this._getHandJoint(n,i)}return this.dispatchEvent({type:"connected",data:e}),this}disconnect(e){return this.dispatchEvent({type:"disconnected",data:e}),this._targetRay!==null&&(this._targetRay.visible=!1),this._grip!==null&&(this._grip.visible=!1),this._hand!==null&&(this._hand.visible=!1),this}update(e,n,i){let r=null,s=null,a=null;const o=this._targetRay,c=this._grip,l=this._hand;if(e&&n.session.visibilityState!=="visible-blurred"){if(l&&e.hand){a=!0;for(const g of e.hand.values()){const y=n.getJointPose(g,i),v=this._getHandJoint(l,g);y!==null&&(v.matrix.fromArray(y.transform.matrix),v.matrix.decompose(v.position,v.rotation,v.scale),v.matrixWorldNeedsUpdate=!0,v.jointRadius=y.radius),v.visible=y!==null}const u=l.joints["index-finger-tip"],h=l.joints["thumb-tip"],f=u.position.distanceTo(h.position),d=.02,p=.005;l.inputState.pinching&&f>d+p?(l.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:e.handedness,target:this})):!l.inputState.pinching&&f<=d-p&&(l.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:e.handedness,target:this}))}else c!==null&&e.gripSpace&&(s=n.getPose(e.gripSpace,i),s!==null&&(c.matrix.fromArray(s.transform.matrix),c.matrix.decompose(c.position,c.rotation,c.scale),c.matrixWorldNeedsUpdate=!0,s.linearVelocity?(c.hasLinearVelocity=!0,c.linearVelocity.copy(s.linearVelocity)):c.hasLinearVelocity=!1,s.angularVelocity?(c.hasAngularVelocity=!0,c.angularVelocity.copy(s.angularVelocity)):c.hasAngularVelocity=!1));o!==null&&(r=n.getPose(e.targetRaySpace,i),r===null&&s!==null&&(r=s),r!==null&&(o.matrix.fromArray(r.transform.matrix),o.matrix.decompose(o.position,o.rotation,o.scale),o.matrixWorldNeedsUpdate=!0,r.linearVelocity?(o.hasLinearVelocity=!0,o.linearVelocity.copy(r.linearVelocity)):o.hasLinearVelocity=!1,r.angularVelocity?(o.hasAngularVelocity=!0,o.angularVelocity.copy(r.angularVelocity)):o.hasAngularVelocity=!1,this.dispatchEvent(Zwe)))}return o!==null&&(o.visible=r!==null),c!==null&&(c.visible=s!==null),l!==null&&(l.visible=a!==null),this}_getHandJoint(e,n){if(e.joints[n.jointName]===void 0){const i=new pw;i.matrixAutoUpdate=!1,i.visible=!1,e.joints[n.jointName]=i,e.add(i)}return e.joints[n.jointName]}}class SB{constructor(e,n=25e-5){this.isFogExp2=!0,this.name="",this.color=new yn(e),this.density=n}clone(){return new SB(this.color,this.density)}toJSON(){return{type:"FogExp2",name:this.name,color:this.color.getHex(),density:this.density}}}class TB{constructor(e,n=1,i=1e3){this.isFog=!0,this.name="",this.color=new yn(e),this.near=n,this.far=i}clone(){return new TB(this.color,this.near,this.far)}toJSON(){return{type:"Fog",name:this.name,color:this.color.getHex(),near:this.near,far:this.far}}}class SC extends qr{constructor(){super(),this.isScene=!0,this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.backgroundBlurriness=0,this.backgroundIntensity=1,this.backgroundRotation=new rf,this.environmentIntensity=1,this.environmentRotation=new rf,this.overrideMaterial=null,typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(e,n){return super.copy(e,n),e.background!==null&&(this.background=e.background.clone()),e.environment!==null&&(this.environment=e.environment.clone()),e.fog!==null&&(this.fog=e.fog.clone()),this.backgroundBlurriness=e.backgroundBlurriness,this.backgroundIntensity=e.backgroundIntensity,this.backgroundRotation.copy(e.backgroundRotation),this.environmentIntensity=e.environmentIntensity,this.environmentRotation.copy(e.environmentRotation),e.overrideMaterial!==null&&(this.overrideMaterial=e.overrideMaterial.clone()),this.matrixAutoUpdate=e.matrixAutoUpdate,this}toJSON(e){const n=super.toJSON(e);return this.fog!==null&&(n.object.fog=this.fog.toJSON()),this.backgroundBlurriness>0&&(n.object.backgroundBlurriness=this.backgroundBlurriness),this.backgroundIntensity!==1&&(n.object.backgroundIntensity=this.backgroundIntensity),n.object.backgroundRotation=this.backgroundRotation.toArray(),this.environmentIntensity!==1&&(n.object.environmentIntensity=this.environmentIntensity),n.object.environmentRotation=this.environmentRotation.toArray(),n}}class xB{constructor(e,n){this.isInterleavedBuffer=!0,this.array=e,this.stride=n,this.count=e!==void 0?e.length/n:0,this.usage=gO,this.updateRanges=[],this.version=0,this.uuid=ed()}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}setUsage(e){return this.usage=e,this}addUpdateRange(e,n){this.updateRanges.push({start:e,count:n})}clearUpdateRanges(){this.updateRanges.length=0}copy(e){return this.array=new e.array.constructor(e.array),this.count=e.count,this.stride=e.stride,this.usage=e.usage,this}copyAt(e,n,i){e*=this.stride,i*=n.stride;for(let r=0,s=this.stride;r<s;r++)this.array[e+r]=n.array[i+r];return this}set(e,n=0){return this.array.set(e,n),this}clone(e){e.arrayBuffers===void 0&&(e.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=ed()),e.arrayBuffers[this.array.buffer._uuid]===void 0&&(e.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);const n=new this.array.constructor(e.arrayBuffers[this.array.buffer._uuid]),i=new this.constructor(n,this.stride);return i.setUsage(this.usage),i}onUpload(e){return this.onUploadCallback=e,this}toJSON(e){return e.arrayBuffers===void 0&&(e.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=ed()),e.arrayBuffers[this.array.buffer._uuid]===void 0&&(e.arrayBuffers[this.array.buffer._uuid]=Array.from(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}}const $u=new Ae;class DT{constructor(e,n,i,r=!1){this.isInterleavedBufferAttribute=!0,this.name="",this.data=e,this.itemSize=n,this.offset=i,this.normalized=r}get count(){return this.data.count}get array(){return this.data.array}set needsUpdate(e){this.data.needsUpdate=e}applyMatrix4(e){for(let n=0,i=this.data.count;n<i;n++)$u.fromBufferAttribute(this,n),$u.applyMatrix4(e),this.setXYZ(n,$u.x,$u.y,$u.z);return this}applyNormalMatrix(e){for(let n=0,i=this.count;n<i;n++)$u.fromBufferAttribute(this,n),$u.applyNormalMatrix(e),this.setXYZ(n,$u.x,$u.y,$u.z);return this}transformDirection(e){for(let n=0,i=this.count;n<i;n++)$u.fromBufferAttribute(this,n),$u.transformDirection(e),this.setXYZ(n,$u.x,$u.y,$u.z);return this}getComponent(e,n){let i=this.array[e*this.data.stride+this.offset+n];return this.normalized&&(i=th(i,this.array)),i}setComponent(e,n,i){return this.normalized&&(i=tr(i,this.array)),this.data.array[e*this.data.stride+this.offset+n]=i,this}setX(e,n){return this.normalized&&(n=tr(n,this.array)),this.data.array[e*this.data.stride+this.offset]=n,this}setY(e,n){return this.normalized&&(n=tr(n,this.array)),this.data.array[e*this.data.stride+this.offset+1]=n,this}setZ(e,n){return this.normalized&&(n=tr(n,this.array)),this.data.array[e*this.data.stride+this.offset+2]=n,this}setW(e,n){return this.normalized&&(n=tr(n,this.array)),this.data.array[e*this.data.stride+this.offset+3]=n,this}getX(e){let n=this.data.array[e*this.data.stride+this.offset];return this.normalized&&(n=th(n,this.array)),n}getY(e){let n=this.data.array[e*this.data.stride+this.offset+1];return this.normalized&&(n=th(n,this.array)),n}getZ(e){let n=this.data.array[e*this.data.stride+this.offset+2];return this.normalized&&(n=th(n,this.array)),n}getW(e){let n=this.data.array[e*this.data.stride+this.offset+3];return this.normalized&&(n=th(n,this.array)),n}setXY(e,n,i){return e=e*this.data.stride+this.offset,this.normalized&&(n=tr(n,this.array),i=tr(i,this.array)),this.data.array[e+0]=n,this.data.array[e+1]=i,this}setXYZ(e,n,i,r){return e=e*this.data.stride+this.offset,this.normalized&&(n=tr(n,this.array),i=tr(i,this.array),r=tr(r,this.array)),this.data.array[e+0]=n,this.data.array[e+1]=i,this.data.array[e+2]=r,this}setXYZW(e,n,i,r,s){return e=e*this.data.stride+this.offset,this.normalized&&(n=tr(n,this.array),i=tr(i,this.array),r=tr(r,this.array),s=tr(s,this.array)),this.data.array[e+0]=n,this.data.array[e+1]=i,this.data.array[e+2]=r,this.data.array[e+3]=s,this}clone(e){if(e===void 0){console.log("THREE.InterleavedBufferAttribute.clone(): Cloning an interleaved buffer attribute will de-interleave buffer data.");const n=[];for(let i=0;i<this.count;i++){const r=i*this.data.stride+this.offset;for(let s=0;s<this.itemSize;s++)n.push(this.data.array[r+s])}return new rr(new this.array.constructor(n),this.itemSize,this.normalized)}else return e.interleavedBuffers===void 0&&(e.interleavedBuffers={}),e.interleavedBuffers[this.data.uuid]===void 0&&(e.interleavedBuffers[this.data.uuid]=this.data.clone(e)),new DT(e.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)}toJSON(e){if(e===void 0){console.log("THREE.InterleavedBufferAttribute.toJSON(): Serializing an interleaved buffer attribute will de-interleave buffer data.");const n=[];for(let i=0;i<this.count;i++){const r=i*this.data.stride+this.offset;for(let s=0;s<this.itemSize;s++)n.push(this.data.array[r+s])}return{itemSize:this.itemSize,type:this.array.constructor.name,array:n,normalized:this.normalized}}else return e.interleavedBuffers===void 0&&(e.interleavedBuffers={}),e.interleavedBuffers[this.data.uuid]===void 0&&(e.interleavedBuffers[this.data.uuid]=this.data.toJSON(e)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}}class d7 extends Tl{constructor(e){super(),this.isSpriteMaterial=!0,this.type="SpriteMaterial",this.color=new yn(16777215),this.map=null,this.alphaMap=null,this.rotation=0,this.sizeAttenuation=!0,this.transparent=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.rotation=e.rotation,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}}let Cx;const _R=new Ae,Ax=new Ae,Rx=new Ae,Mx=new Rt,yR=new Rt,Uce=new Ni,oD=new Ae,bR=new Ae,cD=new Ae,AZ=new Rt,J8=new Rt,RZ=new Rt;class Bce extends qr{constructor(e=new d7){if(super(),this.isSprite=!0,this.type="Sprite",Cx===void 0){Cx=new Qi;const n=new Float32Array([-.5,-.5,0,0,0,.5,-.5,0,1,0,.5,.5,0,1,1,-.5,.5,0,0,1]),i=new xB(n,5);Cx.setIndex([0,1,2,0,2,3]),Cx.setAttribute("position",new DT(i,3,0,!1)),Cx.setAttribute("uv",new DT(i,2,3,!1))}this.geometry=Cx,this.material=e,this.center=new Rt(.5,.5)}raycast(e,n){e.camera===null&&console.error('THREE.Sprite: "Raycaster.camera" needs to be set in order to raycast against sprites.'),Ax.setFromMatrixScale(this.matrixWorld),Uce.copy(e.camera.matrixWorld),this.modelViewMatrix.multiplyMatrices(e.camera.matrixWorldInverse,this.matrixWorld),Rx.setFromMatrixPosition(this.modelViewMatrix),e.camera.isPerspectiveCamera&&this.material.sizeAttenuation===!1&&Ax.multiplyScalar(-Rx.z);const i=this.material.rotation;let r,s;i!==0&&(s=Math.cos(i),r=Math.sin(i));const a=this.center;lD(oD.set(-.5,-.5,0),Rx,a,Ax,r,s),lD(bR.set(.5,-.5,0),Rx,a,Ax,r,s),lD(cD.set(.5,.5,0),Rx,a,Ax,r,s),AZ.set(0,0),J8.set(1,0),RZ.set(1,1);let o=e.ray.intersectTriangle(oD,bR,cD,!1,_R);if(o===null&&(lD(bR.set(-.5,.5,0),Rx,a,Ax,r,s),J8.set(0,1),o=e.ray.intersectTriangle(oD,cD,bR,!1,_R),o===null))return;const c=e.ray.origin.distanceTo(_R);c<e.near||c>e.far||n.push({distance:c,point:_R.clone(),uv:Gh.getInterpolation(_R,oD,bR,cD,AZ,J8,RZ,new Rt),face:null,object:this})}copy(e,n){return super.copy(e,n),e.center!==void 0&&this.center.copy(e.center),this.material=e.material,this}}function lD(t,e,n,i,r,s){Mx.subVectors(t,n).addScalar(.5).multiply(i),r!==void 0?(yR.x=s*Mx.x-r*Mx.y,yR.y=r*Mx.x+s*Mx.y):yR.copy(Mx),t.copy(e),t.x+=yR.x,t.y+=yR.y,t.applyMatrix4(Uce)}const uD=new Ae,MZ=new Ae;class Fce extends qr{constructor(){super(),this.isLOD=!0,this._currentLevel=0,this.type="LOD",Object.defineProperties(this,{levels:{enumerable:!0,value:[]}}),this.autoUpdate=!0}copy(e){super.copy(e,!1);const n=e.levels;for(let i=0,r=n.length;i<r;i++){const s=n[i];this.addLevel(s.object.clone(),s.distance,s.hysteresis)}return this.autoUpdate=e.autoUpdate,this}addLevel(e,n=0,i=0){n=Math.abs(n);const r=this.levels;let s;for(s=0;s<r.length&&!(n<r[s].distance);s++);return r.splice(s,0,{distance:n,hysteresis:i,object:e}),this.add(e),this}removeLevel(e){const n=this.levels;for(let i=0;i<n.length;i++)if(n[i].distance===e){const r=n.splice(i,1);return this.remove(r[0].object),!0}return!1}getCurrentLevel(){return this._currentLevel}getObjectForDistance(e){const n=this.levels;if(n.length>0){let i,r;for(i=1,r=n.length;i<r;i++){let s=n[i].distance;if(n[i].object.visible&&(s-=s*n[i].hysteresis),e<s)break}return n[i-1].object}return null}raycast(e,n){if(this.levels.length>0){uD.setFromMatrixPosition(this.matrixWorld);const r=e.ray.origin.distanceTo(uD);this.getObjectForDistance(r).raycast(e,n)}}update(e){const n=this.levels;if(n.length>1){uD.setFromMatrixPosition(e.matrixWorld),MZ.setFromMatrixPosition(this.matrixWorld);const i=uD.distanceTo(MZ)/e.zoom;n[0].object.visible=!0;let r,s;for(r=1,s=n.length;r<s;r++){let a=n[r].distance;if(n[r].object.visible&&(a-=a*n[r].hysteresis),i>=a)n[r-1].object.visible=!1,n[r].object.visible=!0;else break}for(this._currentLevel=r-1;r<s;r++)n[r].object.visible=!1}}toJSON(e){const n=super.toJSON(e);this.autoUpdate===!1&&(n.object.autoUpdate=!1),n.object.levels=[];const i=this.levels;for(let r=0,s=i.length;r<s;r++){const a=i[r];n.object.levels.push({object:a.object.uuid,distance:a.distance,hysteresis:a.hysteresis})}return n}}const OZ=new Ae,NZ=new Zr,IZ=new Zr,Jwe=new Ae,kZ=new Ni,hD=new Ae,Q8=new zl,DZ=new Ni,eH=new _A;class zce extends jo{constructor(e,n){super(e,n),this.isSkinnedMesh=!0,this.type="SkinnedMesh",this.bindMode=pV,this.bindMatrix=new Ni,this.bindMatrixInverse=new Ni,this.boundingBox=null,this.boundingSphere=null}computeBoundingBox(){const e=this.geometry;this.boundingBox===null&&(this.boundingBox=new gu),this.boundingBox.makeEmpty();const n=e.getAttribute("position");for(let i=0;i<n.count;i++)this.getVertexPosition(i,hD),this.boundingBox.expandByPoint(hD)}computeBoundingSphere(){const e=this.geometry;this.boundingSphere===null&&(this.boundingSphere=new zl),this.boundingSphere.makeEmpty();const n=e.getAttribute("position");for(let i=0;i<n.count;i++)this.getVertexPosition(i,hD),this.boundingSphere.expandByPoint(hD)}copy(e,n){return super.copy(e,n),this.bindMode=e.bindMode,this.bindMatrix.copy(e.bindMatrix),this.bindMatrixInverse.copy(e.bindMatrixInverse),this.skeleton=e.skeleton,e.boundingBox!==null&&(this.boundingBox=e.boundingBox.clone()),e.boundingSphere!==null&&(this.boundingSphere=e.boundingSphere.clone()),this}raycast(e,n){const i=this.material,r=this.matrixWorld;i!==void 0&&(this.boundingSphere===null&&this.computeBoundingSphere(),Q8.copy(this.boundingSphere),Q8.applyMatrix4(r),e.ray.intersectsSphere(Q8)!==!1&&(DZ.copy(r).invert(),eH.copy(e.ray).applyMatrix4(DZ),!(this.boundingBox!==null&&eH.intersectsBox(this.boundingBox)===!1)&&this._computeIntersections(e,n,eH)))}getVertexPosition(e,n){return super.getVertexPosition(e,n),this.applyBoneTransform(e,n),n}bind(e,n){this.skeleton=e,n===void 0&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),n=this.matrixWorld),this.bindMatrix.copy(n),this.bindMatrixInverse.copy(n).invert()}pose(){this.skeleton.pose()}normalizeSkinWeights(){const e=new Zr,n=this.geometry.attributes.skinWeight;for(let i=0,r=n.count;i<r;i++){e.fromBufferAttribute(n,i);const s=1/e.manhattanLength();s!==1/0?e.multiplyScalar(s):e.set(1,0,0,0),n.setXYZW(i,e.x,e.y,e.z,e.w)}}updateMatrixWorld(e){super.updateMatrixWorld(e),this.bindMode===pV?this.bindMatrixInverse.copy(this.matrixWorld).invert():this.bindMode===mce?this.bindMatrixInverse.copy(this.bindMatrix).invert():console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)}applyBoneTransform(e,n){const i=this.skeleton,r=this.geometry;NZ.fromBufferAttribute(r.attributes.skinIndex,e),IZ.fromBufferAttribute(r.attributes.skinWeight,e),OZ.copy(n).applyMatrix4(this.bindMatrix),n.set(0,0,0);for(let s=0;s<4;s++){const a=IZ.getComponent(s);if(a!==0){const o=NZ.getComponent(s);kZ.multiplyMatrices(i.bones[o].matrixWorld,i.boneInverses[o]),n.addScaledVector(Jwe.copy(OZ).applyMatrix4(kZ),a)}}return n.applyMatrix4(this.bindMatrixInverse)}}class p7 extends qr{constructor(){super(),this.isBone=!0,this.type="Bone"}}class up extends Ba{constructor(e=null,n=1,i=1,r,s,a,o,c,l=eo,u=eo,h,f){super(null,a,o,c,l,u,r,s,h,f),this.isDataTexture=!0,this.image={data:e,width:n,height:i},this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}const PZ=new Ni,Qwe=new Ni;class wB{constructor(e=[],n=[]){this.uuid=ed(),this.bones=e.slice(0),this.boneInverses=n,this.boneMatrices=null,this.boneTexture=null,this.init()}init(){const e=this.bones,n=this.boneInverses;if(this.boneMatrices=new Float32Array(e.length*16),n.length===0)this.calculateInverses();else if(e.length!==n.length){console.warn("THREE.Skeleton: Number of inverse bone matrices does not match amount of bones."),this.boneInverses=[];for(let i=0,r=this.bones.length;i<r;i++)this.boneInverses.push(new Ni)}}calculateInverses(){this.boneInverses.length=0;for(let e=0,n=this.bones.length;e<n;e++){const i=new Ni;this.bones[e]&&i.copy(this.bones[e].matrixWorld).invert(),this.boneInverses.push(i)}}pose(){for(let e=0,n=this.bones.length;e<n;e++){const i=this.bones[e];i&&i.matrixWorld.copy(this.boneInverses[e]).invert()}for(let e=0,n=this.bones.length;e<n;e++){const i=this.bones[e];i&&(i.parent&&i.parent.isBone?(i.matrix.copy(i.parent.matrixWorld).invert(),i.matrix.multiply(i.matrixWorld)):i.matrix.copy(i.matrixWorld),i.matrix.decompose(i.position,i.quaternion,i.scale))}}update(){const e=this.bones,n=this.boneInverses,i=this.boneMatrices,r=this.boneTexture;for(let s=0,a=e.length;s<a;s++){const o=e[s]?e[s].matrixWorld:Qwe;PZ.multiplyMatrices(o,n[s]),PZ.toArray(i,s*16)}r!==null&&(r.needsUpdate=!0)}clone(){return new wB(this.bones,this.boneInverses)}computeBoneTexture(){let e=Math.sqrt(this.bones.length*4);e=Math.ceil(e/4)*4,e=Math.max(e,4);const n=new Float32Array(e*e*4);n.set(this.boneMatrices);const i=new up(n,e,e,fu,hu);return i.needsUpdate=!0,this.boneMatrices=n,this.boneTexture=i,this}getBoneByName(e){for(let n=0,i=this.bones.length;n<i;n++){const r=this.bones[n];if(r.name===e)return r}}dispose(){this.boneTexture!==null&&(this.boneTexture.dispose(),this.boneTexture=null)}fromJSON(e,n){this.uuid=e.uuid;for(let i=0,r=e.bones.length;i<r;i++){const s=e.bones[i];let a=n[s];a===void 0&&(console.warn("THREE.Skeleton: No bone found with UUID:",s),a=new p7),this.bones.push(a),this.boneInverses.push(new Ni().fromArray(e.boneInverses[i]))}return this.init(),this}toJSON(){const e={metadata:{version:4.6,type:"Skeleton",generator:"Skeleton.toJSON"},bones:[],boneInverses:[]};e.uuid=this.uuid;const n=this.bones,i=this.boneInverses;for(let r=0,s=n.length;r<s;r++){const a=n[r];e.bones.push(a.uuid);const o=i[r];e.boneInverses.push(o.toArray())}return e}}class TC extends rr{constructor(e,n,i,r=1){super(e,n,i),this.isInstancedBufferAttribute=!0,this.meshPerAttribute=r}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}toJSON(){const e=super.toJSON();return e.meshPerAttribute=this.meshPerAttribute,e.isInstancedBufferAttribute=!0,e}}const Ox=new Ni,LZ=new Ni,fD=[],UZ=new gu,eCe=new Ni,ER=new jo,SR=new zl;class Hce extends jo{constructor(e,n,i){super(e,n),this.isInstancedMesh=!0,this.instanceMatrix=new TC(new Float32Array(i*16),16),this.instanceColor=null,this.morphTexture=null,this.count=i,this.boundingBox=null,this.boundingSphere=null;for(let r=0;r<i;r++)this.setMatrixAt(r,eCe)}computeBoundingBox(){const e=this.geometry,n=this.count;this.boundingBox===null&&(this.boundingBox=new gu),e.boundingBox===null&&e.computeBoundingBox(),this.boundingBox.makeEmpty();for(let i=0;i<n;i++)this.getMatrixAt(i,Ox),UZ.copy(e.boundingBox).applyMatrix4(Ox),this.boundingBox.union(UZ)}computeBoundingSphere(){const e=this.geometry,n=this.count;this.boundingSphere===null&&(this.boundingSphere=new zl),e.boundingSphere===null&&e.computeBoundingSphere(),this.boundingSphere.makeEmpty();for(let i=0;i<n;i++)this.getMatrixAt(i,Ox),SR.copy(e.boundingSphere).applyMatrix4(Ox),this.boundingSphere.union(SR)}copy(e,n){return super.copy(e,n),this.instanceMatrix.copy(e.instanceMatrix),e.morphTexture!==null&&(this.morphTexture=e.morphTexture.clone()),e.instanceColor!==null&&(this.instanceColor=e.instanceColor.clone()),this.count=e.count,e.boundingBox!==null&&(this.boundingBox=e.boundingBox.clone()),e.boundingSphere!==null&&(this.boundingSphere=e.boundingSphere.clone()),this}getColorAt(e,n){n.fromArray(this.instanceColor.array,e*3)}getMatrixAt(e,n){n.fromArray(this.instanceMatrix.array,e*16)}getMorphAt(e,n){const i=n.morphTargetInfluences,r=this.morphTexture.source.data.data,s=i.length+1,a=e*s+1;for(let o=0;o<i.length;o++)i[o]=r[a+o]}raycast(e,n){const i=this.matrixWorld,r=this.count;if(ER.geometry=this.geometry,ER.material=this.material,ER.material!==void 0&&(this.boundingSphere===null&&this.computeBoundingSphere(),SR.copy(this.boundingSphere),SR.applyMatrix4(i),e.ray.intersectsSphere(SR)!==!1))for(let s=0;s<r;s++){this.getMatrixAt(s,Ox),LZ.multiplyMatrices(i,Ox),ER.matrixWorld=LZ,ER.raycast(e,fD);for(let a=0,o=fD.length;a<o;a++){const c=fD[a];c.instanceId=s,c.object=this,n.push(c)}fD.length=0}}setColorAt(e,n){this.instanceColor===null&&(this.instanceColor=new TC(new Float32Array(this.instanceMatrix.count*3).fill(1),3)),n.toArray(this.instanceColor.array,e*3)}setMatrixAt(e,n){n.toArray(this.instanceMatrix.array,e*16)}setMorphAt(e,n){const i=n.morphTargetInfluences,r=i.length+1;this.morphTexture===null&&(this.morphTexture=new up(new Float32Array(r*this.count),r,this.count,vB,hu));const s=this.morphTexture.source.data.data;let a=0;for(let l=0;l<i.length;l++)a+=i[l];const o=this.geometry.morphTargetsRelative?1:1-a,c=r*e;s[c]=o,s.set(i,c+1)}updateMorphTargets(){}dispose(){this.dispatchEvent({type:"dispose"}),this.morphTexture!==null&&(this.morphTexture.dispose(),this.morphTexture=null)}}const tH=new Ae,tCe=new Ae,nCe=new Ji;class qy{constructor(e=new Ae(1,0,0),n=0){this.isPlane=!0,this.normal=e,this.constant=n}set(e,n){return this.normal.copy(e),this.constant=n,this}setComponents(e,n,i,r){return this.normal.set(e,n,i),this.constant=r,this}setFromNormalAndCoplanarPoint(e,n){return this.normal.copy(e),this.constant=-n.dot(this.normal),this}setFromCoplanarPoints(e,n,i){const r=tH.subVectors(i,n).cross(tCe.subVectors(e,n)).normalize();return this.setFromNormalAndCoplanarPoint(r,e),this}copy(e){return this.normal.copy(e.normal),this.constant=e.constant,this}normalize(){const e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(e){return this.normal.dot(e)+this.constant}distanceToSphere(e){return this.distanceToPoint(e.center)-e.radius}projectPoint(e,n){return n.copy(e).addScaledVector(this.normal,-this.distanceToPoint(e))}intersectLine(e,n){const i=e.delta(tH),r=this.normal.dot(i);if(r===0)return this.distanceToPoint(e.start)===0?n.copy(e.start):null;const s=-(e.start.dot(this.normal)+this.constant)/r;return s<0||s>1?null:n.copy(e.start).addScaledVector(i,s)}intersectsLine(e){const n=this.distanceToPoint(e.start),i=this.distanceToPoint(e.end);return n<0&&i>0||i<0&&n>0}intersectsBox(e){return e.intersectsPlane(this)}intersectsSphere(e){return e.intersectsPlane(this)}coplanarPoint(e){return e.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(e,n){const i=n||nCe.getNormalMatrix(e),r=this.coplanarPoint(tH).applyMatrix4(e),s=this.normal.applyMatrix3(i).normalize();return this.constant=-r.dot(s),this}translate(e){return this.constant-=e.dot(this.normal),this}equals(e){return e.normal.equals(this.normal)&&e.constant===this.constant}clone(){return new this.constructor().copy(this)}}const bS=new zl,dD=new Ae;class yA{constructor(e=new qy,n=new qy,i=new qy,r=new qy,s=new qy,a=new qy){this.planes=[e,n,i,r,s,a]}set(e,n,i,r,s,a){const o=this.planes;return o[0].copy(e),o[1].copy(n),o[2].copy(i),o[3].copy(r),o[4].copy(s),o[5].copy(a),this}copy(e){const n=this.planes;for(let i=0;i<6;i++)n[i].copy(e.planes[i]);return this}setFromProjectionMatrix(e,n=ip){const i=this.planes,r=e.elements,s=r[0],a=r[1],o=r[2],c=r[3],l=r[4],u=r[5],h=r[6],f=r[7],d=r[8],p=r[9],g=r[10],y=r[11],v=r[12],b=r[13],T=r[14],x=r[15];if(i[0].setComponents(c-s,f-l,y-d,x-v).normalize(),i[1].setComponents(c+s,f+l,y+d,x+v).normalize(),i[2].setComponents(c+a,f+u,y+p,x+b).normalize(),i[3].setComponents(c-a,f-u,y-p,x-b).normalize(),i[4].setComponents(c-o,f-h,y-g,x-T).normalize(),n===ip)i[5].setComponents(c+o,f+h,y+g,x+T).normalize();else if(n===vO)i[5].setComponents(o,h,g,T).normalize();else throw new Error("THREE.Frustum.setFromProjectionMatrix(): Invalid coordinate system: "+n);return this}intersectsObject(e){if(e.boundingSphere!==void 0)e.boundingSphere===null&&e.computeBoundingSphere(),bS.copy(e.boundingSphere).applyMatrix4(e.matrixWorld);else{const n=e.geometry;n.boundingSphere===null&&n.computeBoundingSphere(),bS.copy(n.boundingSphere).applyMatrix4(e.matrixWorld)}return this.intersectsSphere(bS)}intersectsSprite(e){return bS.center.set(0,0,0),bS.radius=.7071067811865476,bS.applyMatrix4(e.matrixWorld),this.intersectsSphere(bS)}intersectsSphere(e){const n=this.planes,i=e.center,r=-e.radius;for(let s=0;s<6;s++)if(n[s].distanceToPoint(i)<r)return!1;return!0}intersectsBox(e){const n=this.planes;for(let i=0;i<6;i++){const r=n[i];if(dD.x=r.normal.x>0?e.max.x:e.min.x,dD.y=r.normal.y>0?e.max.y:e.min.y,dD.z=r.normal.z>0?e.max.z:e.min.z,r.distanceToPoint(dD)<0)return!1}return!0}containsPoint(e){const n=this.planes;for(let i=0;i<6;i++)if(n[i].distanceToPoint(e)<0)return!1;return!0}clone(){return new this.constructor().copy(this)}}const og=new Ni,cg=new yA;class CB{constructor(){this.coordinateSystem=ip}intersectsObject(e,n){if(!n.isArrayCamera||n.cameras.length===0)return!1;for(let i=0;i<n.cameras.length;i++){const r=n.cameras[i];if(og.multiplyMatrices(r.projectionMatrix,r.matrixWorldInverse),cg.setFromProjectionMatrix(og,this.coordinateSystem),cg.intersectsObject(e))return!0}return!1}intersectsSprite(e,n){if(!n||!n.cameras||n.cameras.length===0)return!1;for(let i=0;i<n.cameras.length;i++){const r=n.cameras[i];if(og.multiplyMatrices(r.projectionMatrix,r.matrixWorldInverse),cg.setFromProjectionMatrix(og,this.coordinateSystem),cg.intersectsSprite(e))return!0}return!1}intersectsSphere(e,n){if(!n||!n.cameras||n.cameras.length===0)return!1;for(let i=0;i<n.cameras.length;i++){const r=n.cameras[i];if(og.multiplyMatrices(r.projectionMatrix,r.matrixWorldInverse),cg.setFromProjectionMatrix(og,this.coordinateSystem),cg.intersectsSphere(e))return!0}return!1}intersectsBox(e,n){if(!n||!n.cameras||n.cameras.length===0)return!1;for(let i=0;i<n.cameras.length;i++){const r=n.cameras[i];if(og.multiplyMatrices(r.projectionMatrix,r.matrixWorldInverse),cg.setFromProjectionMatrix(og,this.coordinateSystem),cg.intersectsBox(e))return!0}return!1}containsPoint(e,n){if(!n||!n.cameras||n.cameras.length===0)return!1;for(let i=0;i<n.cameras.length;i++){const r=n.cameras[i];if(og.multiplyMatrices(r.projectionMatrix,r.matrixWorldInverse),cg.setFromProjectionMatrix(og,this.coordinateSystem),cg.containsPoint(e))return!0}return!1}clone(){return new CB}}function nH(t,e){return t-e}function iCe(t,e){return t.z-e.z}function rCe(t,e){return e.z-t.z}class sCe{constructor(){this.index=0,this.pool=[],this.list=[]}push(e,n,i,r){const s=this.pool,a=this.list;this.index>=s.length&&s.push({start:-1,count:-1,z:-1,index:-1});const o=s[this.index];a.push(o),this.index++,o.start=e,o.count=n,o.z=i,o.index=r}reset(){this.list.length=0,this.index=0}}const Ph=new Ni,aCe=new yn(1,1,1),BZ=new yA,oCe=new CB,pD=new gu,ES=new zl,TR=new Ae,FZ=new Ae,cCe=new Ae,iH=new sCe,iu=new jo,mD=[];function lCe(t,e,n=0){const i=e.itemSize;if(t.isInterleavedBufferAttribute||t.array.constructor!==e.array.constructor){const r=t.count;for(let s=0;s<r;s++)for(let a=0;a<i;a++)e.setComponent(s+n,a,t.getComponent(s,a))}else e.array.set(t.array,n*i);e.needsUpdate=!0}function SS(t,e){if(t.constructor!==e.constructor){const n=Math.min(t.length,e.length);for(let i=0;i<n;i++)e[i]=t[i]}else{const n=Math.min(t.length,e.length);e.set(new t.constructor(t.buffer,0,n))}}class jce extends jo{constructor(e,n,i=n*2,r){super(new Qi,r),this.isBatchedMesh=!0,this.perObjectFrustumCulled=!0,this.sortObjects=!0,this.boundingBox=null,this.boundingSphere=null,this.customSort=null,this._instanceInfo=[],this._geometryInfo=[],this._availableInstanceIds=[],this._availableGeometryIds=[],this._nextIndexStart=0,this._nextVertexStart=0,this._geometryCount=0,this._visibilityChanged=!0,this._geometryInitialized=!1,this._maxInstanceCount=e,this._maxVertexCount=n,this._maxIndexCount=i,this._multiDrawCounts=new Int32Array(e),this._multiDrawStarts=new Int32Array(e),this._multiDrawCount=0,this._multiDrawInstances=null,this._matricesTexture=null,this._indirectTexture=null,this._colorsTexture=null,this._initMatricesTexture(),this._initIndirectTexture()}get maxInstanceCount(){return this._maxInstanceCount}get instanceCount(){return this._instanceInfo.length-this._availableInstanceIds.length}get unusedVertexCount(){return this._maxVertexCount-this._nextVertexStart}get unusedIndexCount(){return this._maxIndexCount-this._nextIndexStart}_initMatricesTexture(){let e=Math.sqrt(this._maxInstanceCount*4);e=Math.ceil(e/4)*4,e=Math.max(e,4);const n=new Float32Array(e*e*4),i=new up(n,e,e,fu,hu);this._matricesTexture=i}_initIndirectTexture(){let e=Math.sqrt(this._maxInstanceCount);e=Math.ceil(e);const n=new Uint32Array(e*e),i=new up(n,e,e,eI,Jg);this._indirectTexture=i}_initColorsTexture(){let e=Math.sqrt(this._maxInstanceCount);e=Math.ceil(e);const n=new Float32Array(e*e*4).fill(1),i=new up(n,e,e,fu,hu);i.colorSpace=Ur.workingColorSpace,this._colorsTexture=i}_initializeGeometry(e){const n=this.geometry,i=this._maxVertexCount,r=this._maxIndexCount;if(this._geometryInitialized===!1){for(const s in e.attributes){const a=e.getAttribute(s),{array:o,itemSize:c,normalized:l}=a,u=new o.constructor(i*c),h=new rr(u,c,l);n.setAttribute(s,h)}if(e.getIndex()!==null){const s=i>65535?new Uint32Array(r):new Uint16Array(r);n.setIndex(new rr(s,1))}this._geometryInitialized=!0}}_validateGeometry(e){const n=this.geometry;if(!!e.getIndex()!=!!n.getIndex())throw new Error('THREE.BatchedMesh: All geometries must consistently have "index".');for(const i in n.attributes){if(!e.hasAttribute(i))throw new Error(`THREE.BatchedMesh: Added geometry missing "${i}". All geometries must have consistent attributes.`);const r=e.getAttribute(i),s=n.getAttribute(i);if(r.itemSize!==s.itemSize||r.normalized!==s.normalized)throw new Error("THREE.BatchedMesh: All attributes must have a consistent itemSize and normalized value.")}}validateInstanceId(e){const n=this._instanceInfo;if(e<0||e>=n.length||n[e].active===!1)throw new Error(`THREE.BatchedMesh: Invalid instanceId ${e}. Instance is either out of range or has been deleted.`)}validateGeometryId(e){const n=this._geometryInfo;if(e<0||e>=n.length||n[e].active===!1)throw new Error(`THREE.BatchedMesh: Invalid geometryId ${e}. Geometry is either out of range or has been deleted.`)}setCustomSort(e){return this.customSort=e,this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new gu);const e=this.boundingBox,n=this._instanceInfo;e.makeEmpty();for(let i=0,r=n.length;i<r;i++){if(n[i].active===!1)continue;const s=n[i].geometryIndex;this.getMatrixAt(i,Ph),this.getBoundingBoxAt(s,pD).applyMatrix4(Ph),e.union(pD)}}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new zl);const e=this.boundingSphere,n=this._instanceInfo;e.makeEmpty();for(let i=0,r=n.length;i<r;i++){if(n[i].active===!1)continue;const s=n[i].geometryIndex;this.getMatrixAt(i,Ph),this.getBoundingSphereAt(s,ES).applyMatrix4(Ph),e.union(ES)}}addInstance(e){if(this._instanceInfo.length>=this.maxInstanceCount&&this._availableInstanceIds.length===0)throw new Error("THREE.BatchedMesh: Maximum item count reached.");const i={visible:!0,active:!0,geometryIndex:e};let r=null;this._availableInstanceIds.length>0?(this._availableInstanceIds.sort(nH),r=this._availableInstanceIds.shift(),this._instanceInfo[r]=i):(r=this._instanceInfo.length,this._instanceInfo.push(i));const s=this._matricesTexture;Ph.identity().toArray(s.image.data,r*16),s.needsUpdate=!0;const a=this._colorsTexture;return a&&(aCe.toArray(a.image.data,r*4),a.needsUpdate=!0),this._visibilityChanged=!0,r}addGeometry(e,n=-1,i=-1){this._initializeGeometry(e),this._validateGeometry(e);const r={vertexStart:-1,vertexCount:-1,reservedVertexCount:-1,indexStart:-1,indexCount:-1,reservedIndexCount:-1,start:-1,count:-1,boundingBox:null,boundingSphere:null,active:!0},s=this._geometryInfo;r.vertexStart=this._nextVertexStart,r.reservedVertexCount=n===-1?e.getAttribute("position").count:n;const a=e.getIndex();if(a!==null&&(r.indexStart=this._nextIndexStart,r.reservedIndexCount=i===-1?a.count:i),r.indexStart!==-1&&r.indexStart+r.reservedIndexCount>this._maxIndexCount||r.vertexStart+r.reservedVertexCount>this._maxVertexCount)throw new Error("THREE.BatchedMesh: Reserved space request exceeds the maximum buffer size.");let c;return this._availableGeometryIds.length>0?(this._availableGeometryIds.sort(nH),c=this._availableGeometryIds.shift(),s[c]=r):(c=this._geometryCount,this._geometryCount++,s.push(r)),this.setGeometryAt(c,e),this._nextIndexStart=r.indexStart+r.reservedIndexCount,this._nextVertexStart=r.vertexStart+r.reservedVertexCount,c}setGeometryAt(e,n){if(e>=this._geometryCount)throw new Error("THREE.BatchedMesh: Maximum geometry count reached.");this._validateGeometry(n);const i=this.geometry,r=i.getIndex()!==null,s=i.getIndex(),a=n.getIndex(),o=this._geometryInfo[e];if(r&&a.count>o.reservedIndexCount||n.attributes.position.count>o.reservedVertexCount)throw new Error("THREE.BatchedMesh: Reserved space not large enough for provided geometry.");const c=o.vertexStart,l=o.reservedVertexCount;o.vertexCount=n.getAttribute("position").count;for(const u in i.attributes){const h=n.getAttribute(u),f=i.getAttribute(u);lCe(h,f,c);const d=h.itemSize;for(let p=h.count,g=l;p<g;p++){const y=c+p;for(let v=0;v<d;v++)f.setComponent(y,v,0)}f.needsUpdate=!0,f.addUpdateRange(c*d,l*d)}if(r){const u=o.indexStart,h=o.reservedIndexCount;o.indexCount=n.getIndex().count;for(let f=0;f<a.count;f++)s.setX(u+f,c+a.getX(f));for(let f=a.count,d=h;f<d;f++)s.setX(u+f,c);s.needsUpdate=!0,s.addUpdateRange(u,o.reservedIndexCount)}return o.start=r?o.indexStart:o.vertexStart,o.count=r?o.indexCount:o.vertexCount,o.boundingBox=null,n.boundingBox!==null&&(o.boundingBox=n.boundingBox.clone()),o.boundingSphere=null,n.boundingSphere!==null&&(o.boundingSphere=n.boundingSphere.clone()),this._visibilityChanged=!0,e}deleteGeometry(e){const n=this._geometryInfo;if(e>=n.length||n[e].active===!1)return this;const i=this._instanceInfo;for(let r=0,s=i.length;r<s;r++)i[r].active&&i[r].geometryIndex===e&&this.deleteInstance(r);return n[e].active=!1,this._availableGeometryIds.push(e),this._visibilityChanged=!0,this}deleteInstance(e){return this.validateInstanceId(e),this._instanceInfo[e].active=!1,this._availableInstanceIds.push(e),this._visibilityChanged=!0,this}optimize(){let e=0,n=0;const i=this._geometryInfo,r=i.map((a,o)=>o).sort((a,o)=>i[a].vertexStart-i[o].vertexStart),s=this.geometry;for(let a=0,o=i.length;a<o;a++){const c=r[a],l=i[c];if(l.active!==!1){if(s.index!==null){if(l.indexStart!==n){const{indexStart:u,vertexStart:h,reservedIndexCount:f}=l,d=s.index,p=d.array,g=e-h;for(let y=u;y<u+f;y++)p[y]=p[y]+g;d.array.copyWithin(n,u,u+f),d.addUpdateRange(n,f),l.indexStart=n}n+=l.reservedIndexCount}if(l.vertexStart!==e){const{vertexStart:u,reservedVertexCount:h}=l,f=s.attributes;for(const d in f){const p=f[d],{array:g,itemSize:y}=p;g.copyWithin(e*y,u*y,(u+h)*y),p.addUpdateRange(e*y,h*y)}l.vertexStart=e}e+=l.reservedVertexCount,l.start=s.index?l.indexStart:l.vertexStart,this._nextIndexStart=s.index?l.indexStart+l.reservedIndexCount:0,this._nextVertexStart=l.vertexStart+l.reservedVertexCount}}return this}getBoundingBoxAt(e,n){if(e>=this._geometryCount)return null;const i=this.geometry,r=this._geometryInfo[e];if(r.boundingBox===null){const s=new gu,a=i.index,o=i.attributes.position;for(let c=r.start,l=r.start+r.count;c<l;c++){let u=c;a&&(u=a.getX(u)),s.expandByPoint(TR.fromBufferAttribute(o,u))}r.boundingBox=s}return n.copy(r.boundingBox),n}getBoundingSphereAt(e,n){if(e>=this._geometryCount)return null;const i=this.geometry,r=this._geometryInfo[e];if(r.boundingSphere===null){const s=new zl;this.getBoundingBoxAt(e,pD),pD.getCenter(s.center);const a=i.index,o=i.attributes.position;let c=0;for(let l=r.start,u=r.start+r.count;l<u;l++){let h=l;a&&(h=a.getX(h)),TR.fromBufferAttribute(o,h),c=Math.max(c,s.center.distanceToSquared(TR))}s.radius=Math.sqrt(c),r.boundingSphere=s}return n.copy(r.boundingSphere),n}setMatrixAt(e,n){this.validateInstanceId(e);const i=this._matricesTexture,r=this._matricesTexture.image.data;return n.toArray(r,e*16),i.needsUpdate=!0,this}getMatrixAt(e,n){return this.validateInstanceId(e),n.fromArray(this._matricesTexture.image.data,e*16)}setColorAt(e,n){return this.validateInstanceId(e),this._colorsTexture===null&&this._initColorsTexture(),n.toArray(this._colorsTexture.image.data,e*4),this._colorsTexture.needsUpdate=!0,this}getColorAt(e,n){return this.validateInstanceId(e),n.fromArray(this._colorsTexture.image.data,e*4)}setVisibleAt(e,n){return this.validateInstanceId(e),this._instanceInfo[e].visible===n?this:(this._instanceInfo[e].visible=n,this._visibilityChanged=!0,this)}getVisibleAt(e){return this.validateInstanceId(e),this._instanceInfo[e].visible}setGeometryIdAt(e,n){return this.validateInstanceId(e),this.validateGeometryId(n),this._instanceInfo[e].geometryIndex=n,this}getGeometryIdAt(e){return this.validateInstanceId(e),this._instanceInfo[e].geometryIndex}getGeometryRangeAt(e,n={}){this.validateGeometryId(e);const i=this._geometryInfo[e];return n.vertexStart=i.vertexStart,n.vertexCount=i.vertexCount,n.reservedVertexCount=i.reservedVertexCount,n.indexStart=i.indexStart,n.indexCount=i.indexCount,n.reservedIndexCount=i.reservedIndexCount,n.start=i.start,n.count=i.count,n}setInstanceCount(e){const n=this._availableInstanceIds,i=this._instanceInfo;for(n.sort(nH);n[n.length-1]===i.length;)i.pop(),n.pop();if(e<i.length)throw new Error(`BatchedMesh: Instance ids outside the range ${e} are being used. Cannot shrink instance count.`);const r=new Int32Array(e),s=new Int32Array(e);SS(this._multiDrawCounts,r),SS(this._multiDrawStarts,s),this._multiDrawCounts=r,this._multiDrawStarts=s,this._maxInstanceCount=e;const a=this._indirectTexture,o=this._matricesTexture,c=this._colorsTexture;a.dispose(),this._initIndirectTexture(),SS(a.image.data,this._indirectTexture.image.data),o.dispose(),this._initMatricesTexture(),SS(o.image.data,this._matricesTexture.image.data),c&&(c.dispose(),this._initColorsTexture(),SS(c.image.data,this._colorsTexture.image.data))}setGeometrySize(e,n){const i=[...this._geometryInfo].filter(o=>o.active);if(Math.max(...i.map(o=>o.vertexStart+o.reservedVertexCount))>e)throw new Error(`BatchedMesh: Geometry vertex values are being used outside the range ${n}. Cannot shrink further.`);if(this.geometry.index&&Math.max(...i.map(c=>c.indexStart+c.reservedIndexCount))>n)throw new Error(`BatchedMesh: Geometry index values are being used outside the range ${n}. Cannot shrink further.`);const s=this.geometry;s.dispose(),this._maxVertexCount=e,this._maxIndexCount=n,this._geometryInitialized&&(this._geometryInitialized=!1,this.geometry=new Qi,this._initializeGeometry(s));const a=this.geometry;s.index&&SS(s.index.array,a.index.array);for(const o in s.attributes)SS(s.attributes[o].array,a.attributes[o].array)}raycast(e,n){const i=this._instanceInfo,r=this._geometryInfo,s=this.matrixWorld,a=this.geometry;iu.material=this.material,iu.geometry.index=a.index,iu.geometry.attributes=a.attributes,iu.geometry.boundingBox===null&&(iu.geometry.boundingBox=new gu),iu.geometry.boundingSphere===null&&(iu.geometry.boundingSphere=new zl);for(let o=0,c=i.length;o<c;o++){if(!i[o].visible||!i[o].active)continue;const l=i[o].geometryIndex,u=r[l];iu.geometry.setDrawRange(u.start,u.count),this.getMatrixAt(o,iu.matrixWorld).premultiply(s),this.getBoundingBoxAt(l,iu.geometry.boundingBox),this.getBoundingSphereAt(l,iu.geometry.boundingSphere),iu.raycast(e,mD);for(let h=0,f=mD.length;h<f;h++){const d=mD[h];d.object=this,d.batchId=o,n.push(d)}mD.length=0}iu.material=null,iu.geometry.index=null,iu.geometry.attributes={},iu.geometry.setDrawRange(0,1/0)}copy(e){return super.copy(e),this.geometry=e.geometry.clone(),this.perObjectFrustumCulled=e.perObjectFrustumCulled,this.sortObjects=e.sortObjects,this.boundingBox=e.boundingBox!==null?e.boundingBox.clone():null,this.boundingSphere=e.boundingSphere!==null?e.boundingSphere.clone():null,this._geometryInfo=e._geometryInfo.map(n=>({...n,boundingBox:n.boundingBox!==null?n.boundingBox.clone():null,boundingSphere:n.boundingSphere!==null?n.boundingSphere.clone():null})),this._instanceInfo=e._instanceInfo.map(n=>({...n})),this._availableInstanceIds=e._availableInstanceIds.slice(),this._availableGeometryIds=e._availableGeometryIds.slice(),this._nextIndexStart=e._nextIndexStart,this._nextVertexStart=e._nextVertexStart,this._geometryCount=e._geometryCount,this._maxInstanceCount=e._maxInstanceCount,this._maxVertexCount=e._maxVertexCount,this._maxIndexCount=e._maxIndexCount,this._geometryInitialized=e._geometryInitialized,this._multiDrawCounts=e._multiDrawCounts.slice(),this._multiDrawStarts=e._multiDrawStarts.slice(),this._indirectTexture=e._indirectTexture.clone(),this._indirectTexture.image.data=this._indirectTexture.image.data.slice(),this._matricesTexture=e._matricesTexture.clone(),this._matricesTexture.image.data=this._matricesTexture.image.data.slice(),this._colorsTexture!==null&&(this._colorsTexture=e._colorsTexture.clone(),this._colorsTexture.image.data=this._colorsTexture.image.data.slice()),this}dispose(){this.geometry.dispose(),this._matricesTexture.dispose(),this._matricesTexture=null,this._indirectTexture.dispose(),this._indirectTexture=null,this._colorsTexture!==null&&(this._colorsTexture.dispose(),this._colorsTexture=null)}onBeforeRender(e,n,i,r,s){if(!this._visibilityChanged&&!this.perObjectFrustumCulled&&!this.sortObjects)return;const a=r.getIndex(),o=a===null?1:a.array.BYTES_PER_ELEMENT,c=this._instanceInfo,l=this._multiDrawStarts,u=this._multiDrawCounts,h=this._geometryInfo,f=this.perObjectFrustumCulled,d=this._indirectTexture,p=d.image.data,g=i.isArrayCamera?oCe:BZ;f&&!i.isArrayCamera&&(Ph.multiplyMatrices(i.projectionMatrix,i.matrixWorldInverse).multiply(this.matrixWorld),BZ.setFromProjectionMatrix(Ph,e.coordinateSystem));let y=0;if(this.sortObjects){Ph.copy(this.matrixWorld).invert(),TR.setFromMatrixPosition(i.matrixWorld).applyMatrix4(Ph),FZ.set(0,0,-1).transformDirection(i.matrixWorld).transformDirection(Ph);for(let T=0,x=c.length;T<x;T++)if(c[T].visible&&c[T].active){const M=c[T].geometryIndex;this.getMatrixAt(T,Ph),this.getBoundingSphereAt(M,ES).applyMatrix4(Ph);let R=!1;if(f&&(R=!g.intersectsSphere(ES,i)),!R){const I=h[M],k=cCe.subVectors(ES.center,TR).dot(FZ);iH.push(I.start,I.count,k,T)}}const v=iH.list,b=this.customSort;b===null?v.sort(s.transparent?rCe:iCe):b.call(this,v,i);for(let T=0,x=v.length;T<x;T++){const M=v[T];l[y]=M.start*o,u[y]=M.count,p[y]=M.index,y++}iH.reset()}else for(let v=0,b=c.length;v<b;v++)if(c[v].visible&&c[v].active){const T=c[v].geometryIndex;let x=!1;if(f&&(this.getMatrixAt(v,Ph),this.getBoundingSphereAt(T,ES).applyMatrix4(Ph),x=!g.intersectsSphere(ES,i)),!x){const M=h[T];l[y]=M.start*o,u[y]=M.count,p[y]=v,y++}}d.needsUpdate=!0,this._multiDrawCount=y,this._visibilityChanged=!1}onBeforeShadow(e,n,i,r,s,a){this.onBeforeRender(e,null,r,s,a)}}class hh extends Tl{constructor(e){super(),this.isLineBasicMaterial=!0,this.type="LineBasicMaterial",this.color=new yn(16777215),this.map=null,this.linewidth=1,this.linecap="round",this.linejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.linewidth=e.linewidth,this.linecap=e.linecap,this.linejoin=e.linejoin,this.fog=e.fog,this}}const qL=new Ae,$L=new Ae,zZ=new Ni,xR=new _A,gD=new zl,rH=new Ae,HZ=new Ae;class Gb extends qr{constructor(e=new Qi,n=new hh){super(),this.isLine=!0,this.type="Line",this.geometry=e,this.material=n,this.morphTargetDictionary=void 0,this.morphTargetInfluences=void 0,this.updateMorphTargets()}copy(e,n){return super.copy(e,n),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}computeLineDistances(){const e=this.geometry;if(e.index===null){const n=e.attributes.position,i=[0];for(let r=1,s=n.count;r<s;r++)qL.fromBufferAttribute(n,r-1),$L.fromBufferAttribute(n,r),i[r]=i[r-1],i[r]+=qL.distanceTo($L);e.setAttribute("lineDistance",new Hn(i,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}raycast(e,n){const i=this.geometry,r=this.matrixWorld,s=e.params.Line.threshold,a=i.drawRange;if(i.boundingSphere===null&&i.computeBoundingSphere(),gD.copy(i.boundingSphere),gD.applyMatrix4(r),gD.radius+=s,e.ray.intersectsSphere(gD)===!1)return;zZ.copy(r).invert(),xR.copy(e.ray).applyMatrix4(zZ);const o=s/((this.scale.x+this.scale.y+this.scale.z)/3),c=o*o,l=this.isLineSegments?2:1,u=i.index,f=i.attributes.position;if(u!==null){const d=Math.max(0,a.start),p=Math.min(u.count,a.start+a.count);for(let g=d,y=p-1;g<y;g+=l){const v=u.getX(g),b=u.getX(g+1),T=vD(this,e,xR,c,v,b,g);T&&n.push(T)}if(this.isLineLoop){const g=u.getX(p-1),y=u.getX(d),v=vD(this,e,xR,c,g,y,p-1);v&&n.push(v)}}else{const d=Math.max(0,a.start),p=Math.min(f.count,a.start+a.count);for(let g=d,y=p-1;g<y;g+=l){const v=vD(this,e,xR,c,g,g+1,g);v&&n.push(v)}if(this.isLineLoop){const g=vD(this,e,xR,c,p-1,d,p-1);g&&n.push(g)}}}updateMorphTargets(){const n=this.geometry.morphAttributes,i=Object.keys(n);if(i.length>0){const r=n[i[0]];if(r!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let s=0,a=r.length;s<a;s++){const o=r[s].name||String(s);this.morphTargetInfluences.push(0),this.morphTargetDictionary[o]=s}}}}}function vD(t,e,n,i,r,s,a){const o=t.geometry.attributes.position;if(qL.fromBufferAttribute(o,r),$L.fromBufferAttribute(o,s),n.distanceSqToSegment(qL,$L,rH,HZ)>i)return;rH.applyMatrix4(t.matrixWorld);const l=e.ray.origin.distanceTo(rH);if(!(l<e.near||l>e.far))return{distance:l,point:HZ.clone().applyMatrix4(t.matrixWorld),index:a,face:null,faceIndex:null,barycoord:null,object:t}}const jZ=new Ae,VZ=new Ae;class h0 extends Gb{constructor(e,n){super(e,n),this.isLineSegments=!0,this.type="LineSegments"}computeLineDistances(){const e=this.geometry;if(e.index===null){const n=e.attributes.position,i=[];for(let r=0,s=n.count;r<s;r+=2)jZ.fromBufferAttribute(n,r),VZ.fromBufferAttribute(n,r+1),i[r]=r===0?0:i[r-1],i[r+1]=i[r]+jZ.distanceTo(VZ);e.setAttribute("lineDistance",new Hn(i,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}}class Vce extends Gb{constructor(e,n){super(e,n),this.isLineLoop=!0,this.type="LineLoop"}}class m7 extends Tl{constructor(e){super(),this.isPointsMaterial=!0,this.type="PointsMaterial",this.color=new yn(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.size=e.size,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}}const GZ=new Ni,vV=new _A,_D=new zl,yD=new Ae;class Gce extends qr{constructor(e=new Qi,n=new m7){super(),this.isPoints=!0,this.type="Points",this.geometry=e,this.material=n,this.morphTargetDictionary=void 0,this.morphTargetInfluences=void 0,this.updateMorphTargets()}copy(e,n){return super.copy(e,n),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}raycast(e,n){const i=this.geometry,r=this.matrixWorld,s=e.params.Points.threshold,a=i.drawRange;if(i.boundingSphere===null&&i.computeBoundingSphere(),_D.copy(i.boundingSphere),_D.applyMatrix4(r),_D.radius+=s,e.ray.intersectsSphere(_D)===!1)return;GZ.copy(r).invert(),vV.copy(e.ray).applyMatrix4(GZ);const o=s/((this.scale.x+this.scale.y+this.scale.z)/3),c=o*o,l=i.index,h=i.attributes.position;if(l!==null){const f=Math.max(0,a.start),d=Math.min(l.count,a.start+a.count);for(let p=f,g=d;p<g;p++){const y=l.getX(p);yD.fromBufferAttribute(h,y),qZ(yD,y,c,r,e,n,this)}}else{const f=Math.max(0,a.start),d=Math.min(h.count,a.start+a.count);for(let p=f,g=d;p<g;p++)yD.fromBufferAttribute(h,p),qZ(yD,p,c,r,e,n,this)}}updateMorphTargets(){const n=this.geometry.morphAttributes,i=Object.keys(n);if(i.length>0){const r=n[i[0]];if(r!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let s=0,a=r.length;s<a;s++){const o=r[s].name||String(s);this.morphTargetInfluences.push(0),this.morphTargetDictionary[o]=s}}}}}function qZ(t,e,n,i,r,s,a){const o=vV.distanceSqToPoint(t);if(o<n){const c=new Ae;vV.closestPointToPoint(t,c),c.applyMatrix4(i);const l=r.ray.origin.distanceTo(c);if(l<r.near||l>r.far)return;s.push({distance:l,distanceToRay:Math.sqrt(o),point:c,index:e,face:null,faceIndex:null,barycoord:null,object:a})}}class qce extends Ba{constructor(e,n,i,r,s=Ea,a=Ea,o,c,l){super(e,n,i,r,s,a,o,c,l),this.isVideoTexture=!0,this.generateMipmaps=!1;const u=this;function h(){u.needsUpdate=!0,e.requestVideoFrameCallback(h)}"requestVideoFrameCallback"in e&&e.requestVideoFrameCallback(h)}clone(){return new this.constructor(this.image).copy(this)}update(){const e=this.image;"requestVideoFrameCallback"in e===!1&&e.readyState>=e.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}}class uCe extends qce{constructor(e,n,i,r,s,a,o,c){super({},e,n,i,r,s,a,o,c),this.isVideoFrameTexture=!0}update(){}clone(){return new this.constructor().copy(this)}setFrame(e){this.image=e,this.needsUpdate=!0}}class hCe extends Ba{constructor(e,n){super({width:e,height:n}),this.isFramebufferTexture=!0,this.magFilter=eo,this.minFilter=eo,this.generateMipmaps=!1,this.needsUpdate=!0}}class AB extends Ba{constructor(e,n,i,r,s,a,o,c,l,u,h,f){super(null,a,o,c,l,u,r,s,h,f),this.isCompressedTexture=!0,this.image={width:n,height:i},this.mipmaps=e,this.flipY=!1,this.generateMipmaps=!1}}class fCe extends AB{constructor(e,n,i,r,s,a){super(e,n,i,s,a),this.isCompressedArrayTexture=!0,this.image.depth=r,this.wrapR=np,this.layerUpdates=new Set}addLayerUpdate(e){this.layerUpdates.add(e)}clearLayerUpdates(){this.layerUpdates.clear()}}class dCe extends AB{constructor(e,n,i){super(void 0,e[0].width,e[0].height,n,i,m_),this.isCompressedCubeTexture=!0,this.isCubeTexture=!0,this.image=e}}class $ce extends Ba{constructor(e,n,i,r,s,a,o,c,l){super(e,n,i,r,s,a,o,c,l),this.isCanvasTexture=!0,this.needsUpdate=!0}}class bA extends Ba{constructor(e,n,i=Jg,r,s,a,o=eo,c=eo,l,u=_C){if(u!==_C&&u!==kT)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");super(null,r,s,a,o,c,u,i,l),this.isDepthTexture=!0,this.image={width:e,height:n},this.flipY=!1,this.generateMipmaps=!1,this.compareFunction=null}copy(e){return super.copy(e),this.source=new ub(Object.assign({},e.image)),this.compareFunction=e.compareFunction,this}toJSON(e){const n=super.toJSON(e);return this.compareFunction!==null&&(n.compareFunction=this.compareFunction),n}}class pCe extends bA{constructor(e=1,n=1,i=1){super(e,n),this.isDepthArrayTexture=!0,this.image={width:e,height:n,depth:i},this.flipY=!1,this.generateMipmaps=!1,this.compareFunction=null,this.layerUpdates=new Set}addLayerUpdate(e){this.layerUpdates.add(e)}clearLayerUpdates(){this.layerUpdates.clear()}}class RB extends Qi{constructor(e=1,n=1,i=4,r=8,s=1){super(),this.type="CapsuleGeometry",this.parameters={radius:e,height:n,capSegments:i,radialSegments:r,heightSegments:s},n=Math.max(0,n),i=Math.max(1,Math.floor(i)),r=Math.max(3,Math.floor(r)),s=Math.max(1,Math.floor(s));const a=[],o=[],c=[],l=[],u=n/2,h=Math.PI/2*e,f=n,d=2*h+f,p=i*2+s,g=r+1,y=new Ae,v=new Ae;for(let b=0;b<=p;b++){let T=0,x=0,M=0,R=0;if(b<=i){const P=b/i,U=P*Math.PI/2;x=-u-e*Math.cos(U),M=e*Math.sin(U),R=-e*Math.cos(U),T=P*h}else if(b<=i+s){const P=(b-i)/s;x=-u+P*n,M=e,R=0,T=h+P*f}else{const P=(b-i-s)/i,U=P*Math.PI/2;x=u+e*Math.sin(U),M=e*Math.cos(U),R=e*Math.sin(U),T=h+f+P*h}const I=Math.max(0,Math.min(1,T/d));let k=0;b===0?k=.5/r:b===p&&(k=-.5/r);for(let P=0;P<=r;P++){const U=P/r,G=U*Math.PI*2,$=Math.sin(G),q=Math.cos(G);v.x=-M*q,v.y=x,v.z=M*$,o.push(v.x,v.y,v.z),y.set(-M*q,R,M*$),y.normalize(),c.push(y.x,y.y,y.z),l.push(U+k,I)}if(b>0){const P=(b-1)*g;for(let U=0;U<r;U++){const G=P+U,$=P+U+1,q=b*g+U,Y=b*g+U+1;a.push(G,$,q),a.push($,Y,q)}}}this.setIndex(a),this.setAttribute("position",new Hn(o,3)),this.setAttribute("normal",new Hn(c,3)),this.setAttribute("uv",new Hn(l,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new RB(e.radius,e.height,e.capSegments,e.radialSegments,e.heightSegments)}}class MB extends Qi{constructor(e=1,n=32,i=0,r=Math.PI*2){super(),this.type="CircleGeometry",this.parameters={radius:e,segments:n,thetaStart:i,thetaLength:r},n=Math.max(3,n);const s=[],a=[],o=[],c=[],l=new Ae,u=new Rt;a.push(0,0,0),o.push(0,0,1),c.push(.5,.5);for(let h=0,f=3;h<=n;h++,f+=3){const d=i+h/n*r;l.x=e*Math.cos(d),l.y=e*Math.sin(d),a.push(l.x,l.y,l.z),o.push(0,0,1),u.x=(a[f]/e+1)/2,u.y=(a[f+1]/e+1)/2,c.push(u.x,u.y)}for(let h=1;h<=n;h++)s.push(h,h+1,0);this.setIndex(s),this.setAttribute("position",new Hn(a,3)),this.setAttribute("normal",new Hn(o,3)),this.setAttribute("uv",new Hn(c,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new MB(e.radius,e.segments,e.thetaStart,e.thetaLength)}}class sI extends Qi{constructor(e=1,n=1,i=1,r=32,s=1,a=!1,o=0,c=Math.PI*2){super(),this.type="CylinderGeometry",this.parameters={radiusTop:e,radiusBottom:n,height:i,radialSegments:r,heightSegments:s,openEnded:a,thetaStart:o,thetaLength:c};const l=this;r=Math.floor(r),s=Math.floor(s);const u=[],h=[],f=[],d=[];let p=0;const g=[],y=i/2;let v=0;b(),a===!1&&(e>0&&T(!0),n>0&&T(!1)),this.setIndex(u),this.setAttribute("position",new Hn(h,3)),this.setAttribute("normal",new Hn(f,3)),this.setAttribute("uv",new Hn(d,2));function b(){const x=new Ae,M=new Ae;let R=0;const I=(n-e)/i;for(let k=0;k<=s;k++){const P=[],U=k/s,G=U*(n-e)+e;for(let $=0;$<=r;$++){const q=$/r,Y=q*c+o,ie=Math.sin(Y),V=Math.cos(Y);M.x=G*ie,M.y=-U*i+y,M.z=G*V,h.push(M.x,M.y,M.z),x.set(ie,I,V).normalize(),f.push(x.x,x.y,x.z),d.push(q,1-U),P.push(p++)}g.push(P)}for(let k=0;k<r;k++)for(let P=0;P<s;P++){const U=g[P][k],G=g[P+1][k],$=g[P+1][k+1],q=g[P][k+1];(e>0||P!==0)&&(u.push(U,G,q),R+=3),(n>0||P!==s-1)&&(u.push(G,$,q),R+=3)}l.addGroup(v,R,0),v+=R}function T(x){const M=p,R=new Rt,I=new Ae;let k=0;const P=x===!0?e:n,U=x===!0?1:-1;for(let $=1;$<=r;$++)h.push(0,y*U,0),f.push(0,U,0),d.push(.5,.5),p++;const G=p;for(let $=0;$<=r;$++){const Y=$/r*c+o,ie=Math.cos(Y),V=Math.sin(Y);I.x=P*V,I.y=y*U,I.z=P*ie,h.push(I.x,I.y,I.z),f.push(0,U,0),R.x=ie*.5+.5,R.y=V*.5*U+.5,d.push(R.x,R.y),p++}for(let $=0;$<r;$++){const q=M+$,Y=G+$;x===!0?u.push(Y,Y+1,q):u.push(Y+1,Y,q),k+=3}l.addGroup(v,k,x===!0?1:2),v+=k}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new sI(e.radiusTop,e.radiusBottom,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}}class aI extends sI{constructor(e=1,n=1,i=32,r=1,s=!1,a=0,o=Math.PI*2){super(0,e,n,i,r,s,a,o),this.type="ConeGeometry",this.parameters={radius:e,height:n,radialSegments:i,heightSegments:r,openEnded:s,thetaStart:a,thetaLength:o}}static fromJSON(e){return new aI(e.radius,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}}class dE extends Qi{constructor(e=[],n=[],i=1,r=0){super(),this.type="PolyhedronGeometry",this.parameters={vertices:e,indices:n,radius:i,detail:r};const s=[],a=[];o(r),l(i),u(),this.setAttribute("position",new Hn(s,3)),this.setAttribute("normal",new Hn(s.slice(),3)),this.setAttribute("uv",new Hn(a,2)),r===0?this.computeVertexNormals():this.normalizeNormals();function o(b){const T=new Ae,x=new Ae,M=new Ae;for(let R=0;R<n.length;R+=3)d(n[R+0],T),d(n[R+1],x),d(n[R+2],M),c(T,x,M,b)}function c(b,T,x,M){const R=M+1,I=[];for(let k=0;k<=R;k++){I[k]=[];const P=b.clone().lerp(x,k/R),U=T.clone().lerp(x,k/R),G=R-k;for(let $=0;$<=G;$++)$===0&&k===R?I[k][$]=P:I[k][$]=P.clone().lerp(U,$/G)}for(let k=0;k<R;k++)for(let P=0;P<2*(R-k)-1;P++){const U=Math.floor(P/2);P%2===0?(f(I[k][U+1]),f(I[k+1][U]),f(I[k][U])):(f(I[k][U+1]),f(I[k+1][U+1]),f(I[k+1][U]))}}function l(b){const T=new Ae;for(let x=0;x<s.length;x+=3)T.x=s[x+0],T.y=s[x+1],T.z=s[x+2],T.normalize().multiplyScalar(b),s[x+0]=T.x,s[x+1]=T.y,s[x+2]=T.z}function u(){const b=new Ae;for(let T=0;T<s.length;T+=3){b.x=s[T+0],b.y=s[T+1],b.z=s[T+2];const x=y(b)/2/Math.PI+.5,M=v(b)/Math.PI+.5;a.push(x,1-M)}p(),h()}function h(){for(let b=0;b<a.length;b+=6){const T=a[b+0],x=a[b+2],M=a[b+4],R=Math.max(T,x,M),I=Math.min(T,x,M);R>.9&&I<.1&&(T<.2&&(a[b+0]+=1),x<.2&&(a[b+2]+=1),M<.2&&(a[b+4]+=1))}}function f(b){s.push(b.x,b.y,b.z)}function d(b,T){const x=b*3;T.x=e[x+0],T.y=e[x+1],T.z=e[x+2]}function p(){const b=new Ae,T=new Ae,x=new Ae,M=new Ae,R=new Rt,I=new Rt,k=new Rt;for(let P=0,U=0;P<s.length;P+=9,U+=6){b.set(s[P+0],s[P+1],s[P+2]),T.set(s[P+3],s[P+4],s[P+5]),x.set(s[P+6],s[P+7],s[P+8]),R.set(a[U+0],a[U+1]),I.set(a[U+2],a[U+3]),k.set(a[U+4],a[U+5]),M.copy(b).add(T).add(x).divideScalar(3);const G=y(M);g(R,U+0,b,G),g(I,U+2,T,G),g(k,U+4,x,G)}}function g(b,T,x,M){M<0&&b.x===1&&(a[T]=b.x-1),x.x===0&&x.z===0&&(a[T]=M/2/Math.PI+.5)}function y(b){return Math.atan2(b.z,-b.x)}function v(b){return Math.atan2(-b.y,Math.sqrt(b.x*b.x+b.z*b.z))}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new dE(e.vertices,e.indices,e.radius,e.details)}}class OB extends dE{constructor(e=1,n=0){const i=(1+Math.sqrt(5))/2,r=1/i,s=[-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-r,-i,0,-r,i,0,r,-i,0,r,i,-r,-i,0,-r,i,0,r,-i,0,r,i,0,-i,0,-r,i,0,-r,-i,0,r,i,0,r],a=[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9];super(s,a,e,n),this.type="DodecahedronGeometry",this.parameters={radius:e,detail:n}}static fromJSON(e){return new OB(e.radius,e.detail)}}const bD=new Ae,ED=new Ae,sH=new Ae,SD=new Gh;class Wce extends Qi{constructor(e=null,n=1){if(super(),this.type="EdgesGeometry",this.parameters={geometry:e,thresholdAngle:n},e!==null){const r=Math.pow(10,4),s=Math.cos(mT*n),a=e.getIndex(),o=e.getAttribute("position"),c=a?a.count:o.count,l=[0,0,0],u=["a","b","c"],h=new Array(3),f={},d=[];for(let p=0;p<c;p+=3){a?(l[0]=a.getX(p),l[1]=a.getX(p+1),l[2]=a.getX(p+2)):(l[0]=p,l[1]=p+1,l[2]=p+2);const{a:g,b:y,c:v}=SD;if(g.fromBufferAttribute(o,l[0]),y.fromBufferAttribute(o,l[1]),v.fromBufferAttribute(o,l[2]),SD.getNormal(sH),h[0]=`${Math.round(g.x*r)},${Math.round(g.y*r)},${Math.round(g.z*r)}`,h[1]=`${Math.round(y.x*r)},${Math.round(y.y*r)},${Math.round(y.z*r)}`,h[2]=`${Math.round(v.x*r)},${Math.round(v.y*r)},${Math.round(v.z*r)}`,!(h[0]===h[1]||h[1]===h[2]||h[2]===h[0]))for(let b=0;b<3;b++){const T=(b+1)%3,x=h[b],M=h[T],R=SD[u[b]],I=SD[u[T]],k=`${x}_${M}`,P=`${M}_${x}`;P in f&&f[P]?(sH.dot(f[P].normal)<=s&&(d.push(R.x,R.y,R.z),d.push(I.x,I.y,I.z)),f[P]=null):k in f||(f[k]={index0:l[b],index1:l[T],normal:sH.clone()})}}for(const p in f)if(f[p]){const{index0:g,index1:y}=f[p];bD.fromBufferAttribute(o,g),ED.fromBufferAttribute(o,y),d.push(bD.x,bD.y,bD.z),d.push(ED.x,ED.y,ED.z)}this.setAttribute("position",new Hn(d,3))}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}}class bm{constructor(){this.type="Curve",this.arcLengthDivisions=200,this.needsUpdate=!1,this.cacheArcLengths=null}getPoint(){console.warn("THREE.Curve: .getPoint() not implemented.")}getPointAt(e,n){const i=this.getUtoTmapping(e);return this.getPoint(i,n)}getPoints(e=5){const n=[];for(let i=0;i<=e;i++)n.push(this.getPoint(i/e));return n}getSpacedPoints(e=5){const n=[];for(let i=0;i<=e;i++)n.push(this.getPointAt(i/e));return n}getLength(){const e=this.getLengths();return e[e.length-1]}getLengths(e=this.arcLengthDivisions){if(this.cacheArcLengths&&this.cacheArcLengths.length===e+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;const n=[];let i,r=this.getPoint(0),s=0;n.push(0);for(let a=1;a<=e;a++)i=this.getPoint(a/e),s+=i.distanceTo(r),n.push(s),r=i;return this.cacheArcLengths=n,n}updateArcLengths(){this.needsUpdate=!0,this.getLengths()}getUtoTmapping(e,n=null){const i=this.getLengths();let r=0;const s=i.length;let a;n?a=n:a=e*i[s-1];let o=0,c=s-1,l;for(;o<=c;)if(r=Math.floor(o+(c-o)/2),l=i[r]-a,l<0)o=r+1;else if(l>0)c=r-1;else{c=r;break}if(r=c,i[r]===a)return r/(s-1);const u=i[r],f=i[r+1]-u,d=(a-u)/f;return(r+d)/(s-1)}getTangent(e,n){let r=e-1e-4,s=e+1e-4;r<0&&(r=0),s>1&&(s=1);const a=this.getPoint(r),o=this.getPoint(s),c=n||(a.isVector2?new Rt:new Ae);return c.copy(o).sub(a).normalize(),c}getTangentAt(e,n){const i=this.getUtoTmapping(e);return this.getTangent(i,n)}computeFrenetFrames(e,n=!1){const i=new Ae,r=[],s=[],a=[],o=new Ae,c=new Ni;for(let d=0;d<=e;d++){const p=d/e;r[d]=this.getTangentAt(p,new Ae)}s[0]=new Ae,a[0]=new Ae;let l=Number.MAX_VALUE;const u=Math.abs(r[0].x),h=Math.abs(r[0].y),f=Math.abs(r[0].z);u<=l&&(l=u,i.set(1,0,0)),h<=l&&(l=h,i.set(0,1,0)),f<=l&&i.set(0,0,1),o.crossVectors(r[0],i).normalize(),s[0].crossVectors(r[0],o),a[0].crossVectors(r[0],s[0]);for(let d=1;d<=e;d++){if(s[d]=s[d-1].clone(),a[d]=a[d-1].clone(),o.crossVectors(r[d-1],r[d]),o.length()>Number.EPSILON){o.normalize();const p=Math.acos(Xi(r[d-1].dot(r[d]),-1,1));s[d].applyMatrix4(c.makeRotationAxis(o,p))}a[d].crossVectors(r[d],s[d])}if(n===!0){let d=Math.acos(Xi(s[0].dot(s[e]),-1,1));d/=e,r[0].dot(o.crossVectors(s[0],s[e]))>0&&(d=-d);for(let p=1;p<=e;p++)s[p].applyMatrix4(c.makeRotationAxis(r[p],d*p)),a[p].crossVectors(r[p],s[p])}return{tangents:r,normals:s,binormals:a}}clone(){return new this.constructor().copy(this)}copy(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}toJSON(){const e={metadata:{version:4.6,type:"Curve",generator:"Curve.toJSON"}};return e.arcLengthDivisions=this.arcLengthDivisions,e.type=this.type,e}fromJSON(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}}class NB extends bm{constructor(e=0,n=0,i=1,r=1,s=0,a=Math.PI*2,o=!1,c=0){super(),this.isEllipseCurve=!0,this.type="EllipseCurve",this.aX=e,this.aY=n,this.xRadius=i,this.yRadius=r,this.aStartAngle=s,this.aEndAngle=a,this.aClockwise=o,this.aRotation=c}getPoint(e,n=new Rt){const i=n,r=Math.PI*2;let s=this.aEndAngle-this.aStartAngle;const a=Math.abs(s)<Number.EPSILON;for(;s<0;)s+=r;for(;s>r;)s-=r;s<Number.EPSILON&&(a?s=0:s=r),this.aClockwise===!0&&!a&&(s===r?s=-r:s=s-r);const o=this.aStartAngle+e*s;let c=this.aX+this.xRadius*Math.cos(o),l=this.aY+this.yRadius*Math.sin(o);if(this.aRotation!==0){const u=Math.cos(this.aRotation),h=Math.sin(this.aRotation),f=c-this.aX,d=l-this.aY;c=f*u-d*h+this.aX,l=f*h+d*u+this.aY}return i.set(c,l)}copy(e){return super.copy(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}toJSON(){const e=super.toJSON();return e.aX=this.aX,e.aY=this.aY,e.xRadius=this.xRadius,e.yRadius=this.yRadius,e.aStartAngle=this.aStartAngle,e.aEndAngle=this.aEndAngle,e.aClockwise=this.aClockwise,e.aRotation=this.aRotation,e}fromJSON(e){return super.fromJSON(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}}class Yce extends NB{constructor(e,n,i,r,s,a){super(e,n,i,i,r,s,a),this.isArcCurve=!0,this.type="ArcCurve"}}function g7(){let t=0,e=0,n=0,i=0;function r(s,a,o,c){t=s,e=o,n=-3*s+3*a-2*o-c,i=2*s-2*a+o+c}return{initCatmullRom:function(s,a,o,c,l){r(a,o,l*(o-s),l*(c-a))},initNonuniformCatmullRom:function(s,a,o,c,l,u,h){let f=(a-s)/l-(o-s)/(l+u)+(o-a)/u,d=(o-a)/u-(c-a)/(u+h)+(c-o)/h;f*=u,d*=u,r(a,o,f,d)},calc:function(s){const a=s*s,o=a*s;return t+e*s+n*a+i*o}}}const TD=new Ae,aH=new g7,oH=new g7,cH=new g7;class Xce extends bm{constructor(e=[],n=!1,i="centripetal",r=.5){super(),this.isCatmullRomCurve3=!0,this.type="CatmullRomCurve3",this.points=e,this.closed=n,this.curveType=i,this.tension=r}getPoint(e,n=new Ae){const i=n,r=this.points,s=r.length,a=(s-(this.closed?0:1))*e;let o=Math.floor(a),c=a-o;this.closed?o+=o>0?0:(Math.floor(Math.abs(o)/s)+1)*s:c===0&&o===s-1&&(o=s-2,c=1);let l,u;this.closed||o>0?l=r[(o-1)%s]:(TD.subVectors(r[0],r[1]).add(r[0]),l=TD);const h=r[o%s],f=r[(o+1)%s];if(this.closed||o+2<s?u=r[(o+2)%s]:(TD.subVectors(r[s-1],r[s-2]).add(r[s-1]),u=TD),this.curveType==="centripetal"||this.curveType==="chordal"){const d=this.curveType==="chordal"?.5:.25;let p=Math.pow(l.distanceToSquared(h),d),g=Math.pow(h.distanceToSquared(f),d),y=Math.pow(f.distanceToSquared(u),d);g<1e-4&&(g=1),p<1e-4&&(p=g),y<1e-4&&(y=g),aH.initNonuniformCatmullRom(l.x,h.x,f.x,u.x,p,g,y),oH.initNonuniformCatmullRom(l.y,h.y,f.y,u.y,p,g,y),cH.initNonuniformCatmullRom(l.z,h.z,f.z,u.z,p,g,y)}else this.curveType==="catmullrom"&&(aH.initCatmullRom(l.x,h.x,f.x,u.x,this.tension),oH.initCatmullRom(l.y,h.y,f.y,u.y,this.tension),cH.initCatmullRom(l.z,h.z,f.z,u.z,this.tension));return i.set(aH.calc(c),oH.calc(c),cH.calc(c)),i}copy(e){super.copy(e),this.points=[];for(let n=0,i=e.points.length;n<i;n++){const r=e.points[n];this.points.push(r.clone())}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}toJSON(){const e=super.toJSON();e.points=[];for(let n=0,i=this.points.length;n<i;n++){const r=this.points[n];e.points.push(r.toArray())}return e.closed=this.closed,e.curveType=this.curveType,e.tension=this.tension,e}fromJSON(e){super.fromJSON(e),this.points=[];for(let n=0,i=e.points.length;n<i;n++){const r=e.points[n];this.points.push(new Ae().fromArray(r))}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}}function $Z(t,e,n,i,r){const s=(i-e)*.5,a=(r-n)*.5,o=t*t,c=t*o;return(2*n-2*i+s+a)*c+(-3*n+3*i-2*s-a)*o+s*t+n}function mCe(t,e){const n=1-t;return n*n*e}function gCe(t,e){return 2*(1-t)*t*e}function vCe(t,e){return t*t*e}function wM(t,e,n,i){return mCe(t,e)+gCe(t,n)+vCe(t,i)}function _Ce(t,e){const n=1-t;return n*n*n*e}function yCe(t,e){const n=1-t;return 3*n*n*t*e}function bCe(t,e){return 3*(1-t)*t*t*e}function ECe(t,e){return t*t*t*e}function CM(t,e,n,i,r){return _Ce(t,e)+yCe(t,n)+bCe(t,i)+ECe(t,r)}class v7 extends bm{constructor(e=new Rt,n=new Rt,i=new Rt,r=new Rt){super(),this.isCubicBezierCurve=!0,this.type="CubicBezierCurve",this.v0=e,this.v1=n,this.v2=i,this.v3=r}getPoint(e,n=new Rt){const i=n,r=this.v0,s=this.v1,a=this.v2,o=this.v3;return i.set(CM(e,r.x,s.x,a.x,o.x),CM(e,r.y,s.y,a.y,o.y)),i}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}}class Kce extends bm{constructor(e=new Ae,n=new Ae,i=new Ae,r=new Ae){super(),this.isCubicBezierCurve3=!0,this.type="CubicBezierCurve3",this.v0=e,this.v1=n,this.v2=i,this.v3=r}getPoint(e,n=new Ae){const i=n,r=this.v0,s=this.v1,a=this.v2,o=this.v3;return i.set(CM(e,r.x,s.x,a.x,o.x),CM(e,r.y,s.y,a.y,o.y),CM(e,r.z,s.z,a.z,o.z)),i}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}}class _7 extends bm{constructor(e=new Rt,n=new Rt){super(),this.isLineCurve=!0,this.type="LineCurve",this.v1=e,this.v2=n}getPoint(e,n=new Rt){const i=n;return e===1?i.copy(this.v2):(i.copy(this.v2).sub(this.v1),i.multiplyScalar(e).add(this.v1)),i}getPointAt(e,n){return this.getPoint(e,n)}getTangent(e,n=new Rt){return n.subVectors(this.v2,this.v1).normalize()}getTangentAt(e,n){return this.getTangent(e,n)}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class Zce extends bm{constructor(e=new Ae,n=new Ae){super(),this.isLineCurve3=!0,this.type="LineCurve3",this.v1=e,this.v2=n}getPoint(e,n=new Ae){const i=n;return e===1?i.copy(this.v2):(i.copy(this.v2).sub(this.v1),i.multiplyScalar(e).add(this.v1)),i}getPointAt(e,n){return this.getPoint(e,n)}getTangent(e,n=new Ae){return n.subVectors(this.v2,this.v1).normalize()}getTangentAt(e,n){return this.getTangent(e,n)}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class y7 extends bm{constructor(e=new Rt,n=new Rt,i=new Rt){super(),this.isQuadraticBezierCurve=!0,this.type="QuadraticBezierCurve",this.v0=e,this.v1=n,this.v2=i}getPoint(e,n=new Rt){const i=n,r=this.v0,s=this.v1,a=this.v2;return i.set(wM(e,r.x,s.x,a.x),wM(e,r.y,s.y,a.y)),i}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class b7 extends bm{constructor(e=new Ae,n=new Ae,i=new Ae){super(),this.isQuadraticBezierCurve3=!0,this.type="QuadraticBezierCurve3",this.v0=e,this.v1=n,this.v2=i}getPoint(e,n=new Ae){const i=n,r=this.v0,s=this.v1,a=this.v2;return i.set(wM(e,r.x,s.x,a.x),wM(e,r.y,s.y,a.y),wM(e,r.z,s.z,a.z)),i}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class E7 extends bm{constructor(e=[]){super(),this.isSplineCurve=!0,this.type="SplineCurve",this.points=e}getPoint(e,n=new Rt){const i=n,r=this.points,s=(r.length-1)*e,a=Math.floor(s),o=s-a,c=r[a===0?a:a-1],l=r[a],u=r[a>r.length-2?r.length-1:a+1],h=r[a>r.length-3?r.length-1:a+2];return i.set($Z(o,c.x,l.x,u.x,h.x),$Z(o,c.y,l.y,u.y,h.y)),i}copy(e){super.copy(e),this.points=[];for(let n=0,i=e.points.length;n<i;n++){const r=e.points[n];this.points.push(r.clone())}return this}toJSON(){const e=super.toJSON();e.points=[];for(let n=0,i=this.points.length;n<i;n++){const r=this.points[n];e.points.push(r.toArray())}return e}fromJSON(e){super.fromJSON(e),this.points=[];for(let n=0,i=e.points.length;n<i;n++){const r=e.points[n];this.points.push(new Rt().fromArray(r))}return this}}var WL=Object.freeze({__proto__:null,ArcCurve:Yce,CatmullRomCurve3:Xce,CubicBezierCurve:v7,CubicBezierCurve3:Kce,EllipseCurve:NB,LineCurve:_7,LineCurve3:Zce,QuadraticBezierCurve:y7,QuadraticBezierCurve3:b7,SplineCurve:E7});class Jce extends bm{constructor(){super(),this.type="CurvePath",this.curves=[],this.autoClose=!1}add(e){this.curves.push(e)}closePath(){const e=this.curves[0].getPoint(0),n=this.curves[this.curves.length-1].getPoint(1);if(!e.equals(n)){const i=e.isVector2===!0?"LineCurve":"LineCurve3";this.curves.push(new WL[i](n,e))}return this}getPoint(e,n){const i=e*this.getLength(),r=this.getCurveLengths();let s=0;for(;s<r.length;){if(r[s]>=i){const a=r[s]-i,o=this.curves[s],c=o.getLength(),l=c===0?0:1-a/c;return o.getPointAt(l,n)}s++}return null}getLength(){const e=this.getCurveLengths();return e[e.length-1]}updateArcLengths(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()}getCurveLengths(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;const e=[];let n=0;for(let i=0,r=this.curves.length;i<r;i++)n+=this.curves[i].getLength(),e.push(n);return this.cacheLengths=e,e}getSpacedPoints(e=40){const n=[];for(let i=0;i<=e;i++)n.push(this.getPoint(i/e));return this.autoClose&&n.push(n[0]),n}getPoints(e=12){const n=[];let i;for(let r=0,s=this.curves;r<s.length;r++){const a=s[r],o=a.isEllipseCurve?e*2:a.isLineCurve||a.isLineCurve3?1:a.isSplineCurve?e*a.points.length:e,c=a.getPoints(o);for(let l=0;l<c.length;l++){const u=c[l];i&&i.equals(u)||(n.push(u),i=u)}}return this.autoClose&&n.length>1&&!n[n.length-1].equals(n[0])&&n.push(n[0]),n}copy(e){super.copy(e),this.curves=[];for(let n=0,i=e.curves.length;n<i;n++){const r=e.curves[n];this.curves.push(r.clone())}return this.autoClose=e.autoClose,this}toJSON(){const e=super.toJSON();e.autoClose=this.autoClose,e.curves=[];for(let n=0,i=this.curves.length;n<i;n++){const r=this.curves[n];e.curves.push(r.toJSON())}return e}fromJSON(e){super.fromJSON(e),this.autoClose=e.autoClose,this.curves=[];for(let n=0,i=e.curves.length;n<i;n++){const r=e.curves[n];this.curves.push(new WL[r.type]().fromJSON(r))}return this}}class YL extends Jce{constructor(e){super(),this.type="Path",this.currentPoint=new Rt,e&&this.setFromPoints(e)}setFromPoints(e){this.moveTo(e[0].x,e[0].y);for(let n=1,i=e.length;n<i;n++)this.lineTo(e[n].x,e[n].y);return this}moveTo(e,n){return this.currentPoint.set(e,n),this}lineTo(e,n){const i=new _7(this.currentPoint.clone(),new Rt(e,n));return this.curves.push(i),this.currentPoint.set(e,n),this}quadraticCurveTo(e,n,i,r){const s=new y7(this.currentPoint.clone(),new Rt(e,n),new Rt(i,r));return this.curves.push(s),this.currentPoint.set(i,r),this}bezierCurveTo(e,n,i,r,s,a){const o=new v7(this.currentPoint.clone(),new Rt(e,n),new Rt(i,r),new Rt(s,a));return this.curves.push(o),this.currentPoint.set(s,a),this}splineThru(e){const n=[this.currentPoint.clone()].concat(e),i=new E7(n);return this.curves.push(i),this.currentPoint.copy(e[e.length-1]),this}arc(e,n,i,r,s,a){const o=this.currentPoint.x,c=this.currentPoint.y;return this.absarc(e+o,n+c,i,r,s,a),this}absarc(e,n,i,r,s,a){return this.absellipse(e,n,i,i,r,s,a),this}ellipse(e,n,i,r,s,a,o,c){const l=this.currentPoint.x,u=this.currentPoint.y;return this.absellipse(e+l,n+u,i,r,s,a,o,c),this}absellipse(e,n,i,r,s,a,o,c){const l=new NB(e,n,i,r,s,a,o,c);if(this.curves.length>0){const h=l.getPoint(0);h.equals(this.currentPoint)||this.lineTo(h.x,h.y)}this.curves.push(l);const u=l.getPoint(1);return this.currentPoint.copy(u),this}copy(e){return super.copy(e),this.currentPoint.copy(e.currentPoint),this}toJSON(){const e=super.toJSON();return e.currentPoint=this.currentPoint.toArray(),e}fromJSON(e){return super.fromJSON(e),this.currentPoint.fromArray(e.currentPoint),this}}class gT extends YL{constructor(e){super(e),this.uuid=ed(),this.type="Shape",this.holes=[]}getPointsHoles(e){const n=[];for(let i=0,r=this.holes.length;i<r;i++)n[i]=this.holes[i].getPoints(e);return n}extractPoints(e){return{shape:this.getPoints(e),holes:this.getPointsHoles(e)}}copy(e){super.copy(e),this.holes=[];for(let n=0,i=e.holes.length;n<i;n++){const r=e.holes[n];this.holes.push(r.clone())}return this}toJSON(){const e=super.toJSON();e.uuid=this.uuid,e.holes=[];for(let n=0,i=this.holes.length;n<i;n++){const r=this.holes[n];e.holes.push(r.toJSON())}return e}fromJSON(e){super.fromJSON(e),this.uuid=e.uuid,this.holes=[];for(let n=0,i=e.holes.length;n<i;n++){const r=e.holes[n];this.holes.push(new YL().fromJSON(r))}return this}}function SCe(t,e,n=2){const i=e&&e.length,r=i?e[0]*n:t.length;let s=Qce(t,0,r,n,!0);const a=[];if(!s||s.next===s.prev)return a;let o,c,l;if(i&&(s=ACe(t,e,s,n)),t.length>80*n){o=1/0,c=1/0;let u=-1/0,h=-1/0;for(let f=n;f<r;f+=n){const d=t[f],p=t[f+1];d<o&&(o=d),p<c&&(c=p),d>u&&(u=d),p>h&&(h=p)}l=Math.max(u-o,h-c),l=l!==0?32767/l:0}return yO(s,a,n,o,c,l,0),a}function Qce(t,e,n,i,r){let s;if(r===BCe(t,e,n,i)>0)for(let a=e;a<n;a+=i)s=WZ(a/i|0,t[a],t[a+1],s);else for(let a=n-i;a>=e;a-=i)s=WZ(a/i|0,t[a],t[a+1],s);return s&&xC(s,s.next)&&(EO(s),s=s.next),s}function PT(t,e){if(!t)return t;e||(e=t);let n=t,i;do if(i=!1,!n.steiner&&(xC(n,n.next)||Ja(n.prev,n,n.next)===0)){if(EO(n),n=e=n.prev,n===n.next)break;i=!0}else n=n.next;while(i||n!==e);return e}function yO(t,e,n,i,r,s,a){if(!t)return;!a&&s&&ICe(t,i,r,s);let o=t;for(;t.prev!==t.next;){const c=t.prev,l=t.next;if(s?xCe(t,i,r,s):TCe(t)){e.push(c.i,t.i,l.i),EO(t),t=l.next,o=l.next;continue}if(t=l,t===o){a?a===1?(t=wCe(PT(t),e),yO(t,e,n,i,r,s,2)):a===2&&CCe(t,e,n,i,r,s):yO(PT(t),e,n,i,r,s,1);break}}}function TCe(t){const e=t.prev,n=t,i=t.next;if(Ja(e,n,i)>=0)return!1;const r=e.x,s=n.x,a=i.x,o=e.y,c=n.y,l=i.y,u=Math.min(r,s,a),h=Math.min(o,c,l),f=Math.max(r,s,a),d=Math.max(o,c,l);let p=i.next;for(;p!==e;){if(p.x>=u&&p.x<=f&&p.y>=h&&p.y<=d&&eM(r,o,s,c,a,l,p.x,p.y)&&Ja(p.prev,p,p.next)>=0)return!1;p=p.next}return!0}function xCe(t,e,n,i){const r=t.prev,s=t,a=t.next;if(Ja(r,s,a)>=0)return!1;const o=r.x,c=s.x,l=a.x,u=r.y,h=s.y,f=a.y,d=Math.min(o,c,l),p=Math.min(u,h,f),g=Math.max(o,c,l),y=Math.max(u,h,f),v=_V(d,p,e,n,i),b=_V(g,y,e,n,i);let T=t.prevZ,x=t.nextZ;for(;T&&T.z>=v&&x&&x.z<=b;){if(T.x>=d&&T.x<=g&&T.y>=p&&T.y<=y&&T!==r&&T!==a&&eM(o,u,c,h,l,f,T.x,T.y)&&Ja(T.prev,T,T.next)>=0||(T=T.prevZ,x.x>=d&&x.x<=g&&x.y>=p&&x.y<=y&&x!==r&&x!==a&&eM(o,u,c,h,l,f,x.x,x.y)&&Ja(x.prev,x,x.next)>=0))return!1;x=x.nextZ}for(;T&&T.z>=v;){if(T.x>=d&&T.x<=g&&T.y>=p&&T.y<=y&&T!==r&&T!==a&&eM(o,u,c,h,l,f,T.x,T.y)&&Ja(T.prev,T,T.next)>=0)return!1;T=T.prevZ}for(;x&&x.z<=b;){if(x.x>=d&&x.x<=g&&x.y>=p&&x.y<=y&&x!==r&&x!==a&&eM(o,u,c,h,l,f,x.x,x.y)&&Ja(x.prev,x,x.next)>=0)return!1;x=x.nextZ}return!0}function wCe(t,e){let n=t;do{const i=n.prev,r=n.next.next;!xC(i,r)&&tle(i,n,n.next,r)&&bO(i,r)&&bO(r,i)&&(e.push(i.i,n.i,r.i),EO(n),EO(n.next),n=t=r),n=n.next}while(n!==t);return PT(n)}function CCe(t,e,n,i,r,s){let a=t;do{let o=a.next.next;for(;o!==a.prev;){if(a.i!==o.i&&PCe(a,o)){let c=nle(a,o);a=PT(a,a.next),c=PT(c,c.next),yO(a,e,n,i,r,s,0),yO(c,e,n,i,r,s,0);return}o=o.next}a=a.next}while(a!==t)}function ACe(t,e,n,i){const r=[];for(let s=0,a=e.length;s<a;s++){const o=e[s]*i,c=s<a-1?e[s+1]*i:t.length,l=Qce(t,o,c,i,!1);l===l.next&&(l.steiner=!0),r.push(DCe(l))}r.sort(RCe);for(let s=0;s<r.length;s++)n=MCe(r[s],n);return n}function RCe(t,e){let n=t.x-e.x;if(n===0&&(n=t.y-e.y,n===0)){const i=(t.next.y-t.y)/(t.next.x-t.x),r=(e.next.y-e.y)/(e.next.x-e.x);n=i-r}return n}function MCe(t,e){const n=OCe(t,e);if(!n)return e;const i=nle(n,t);return PT(i,i.next),PT(n,n.next)}function OCe(t,e){let n=e;const i=t.x,r=t.y;let s=-1/0,a;if(xC(t,n))return n;do{if(xC(t,n.next))return n.next;if(r<=n.y&&r>=n.next.y&&n.next.y!==n.y){const h=n.x+(r-n.y)*(n.next.x-n.x)/(n.next.y-n.y);if(h<=i&&h>s&&(s=h,a=n.x<n.next.x?n:n.next,h===i))return a}n=n.next}while(n!==e);if(!a)return null;const o=a,c=a.x,l=a.y;let u=1/0;n=a;do{if(i>=n.x&&n.x>=c&&i!==n.x&&ele(r<l?i:s,r,c,l,r<l?s:i,r,n.x,n.y)){const h=Math.abs(r-n.y)/(i-n.x);bO(n,t)&&(h<u||h===u&&(n.x>a.x||n.x===a.x&&NCe(a,n)))&&(a=n,u=h)}n=n.next}while(n!==o);return a}function NCe(t,e){return Ja(t.prev,t,e.prev)<0&&Ja(e.next,t,t.next)<0}function ICe(t,e,n,i){let r=t;do r.z===0&&(r.z=_V(r.x,r.y,e,n,i)),r.prevZ=r.prev,r.nextZ=r.next,r=r.next;while(r!==t);r.prevZ.nextZ=null,r.prevZ=null,kCe(r)}function kCe(t){let e,n=1;do{let i=t,r;t=null;let s=null;for(e=0;i;){e++;let a=i,o=0;for(let l=0;l<n&&(o++,a=a.nextZ,!!a);l++);let c=n;for(;o>0||c>0&&a;)o!==0&&(c===0||!a||i.z<=a.z)?(r=i,i=i.nextZ,o--):(r=a,a=a.nextZ,c--),s?s.nextZ=r:t=r,r.prevZ=s,s=r;i=a}s.nextZ=null,n*=2}while(e>1);return t}function _V(t,e,n,i,r){return t=(t-n)*r|0,e=(e-i)*r|0,t=(t|t<<8)&16711935,t=(t|t<<4)&252645135,t=(t|t<<2)&858993459,t=(t|t<<1)&1431655765,e=(e|e<<8)&16711935,e=(e|e<<4)&252645135,e=(e|e<<2)&858993459,e=(e|e<<1)&1431655765,t|e<<1}function DCe(t){let e=t,n=t;do(e.x<n.x||e.x===n.x&&e.y<n.y)&&(n=e),e=e.next;while(e!==t);return n}function ele(t,e,n,i,r,s,a,o){return(r-a)*(e-o)>=(t-a)*(s-o)&&(t-a)*(i-o)>=(n-a)*(e-o)&&(n-a)*(s-o)>=(r-a)*(i-o)}function eM(t,e,n,i,r,s,a,o){return!(t===a&&e===o)&&ele(t,e,n,i,r,s,a,o)}function PCe(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!LCe(t,e)&&(bO(t,e)&&bO(e,t)&&UCe(t,e)&&(Ja(t.prev,t,e.prev)||Ja(t,e.prev,e))||xC(t,e)&&Ja(t.prev,t,t.next)>0&&Ja(e.prev,e,e.next)>0)}function Ja(t,e,n){return(e.y-t.y)*(n.x-e.x)-(e.x-t.x)*(n.y-e.y)}function xC(t,e){return t.x===e.x&&t.y===e.y}function tle(t,e,n,i){const r=wD(Ja(t,e,n)),s=wD(Ja(t,e,i)),a=wD(Ja(n,i,t)),o=wD(Ja(n,i,e));return!!(r!==s&&a!==o||r===0&&xD(t,n,e)||s===0&&xD(t,i,e)||a===0&&xD(n,t,i)||o===0&&xD(n,e,i))}function xD(t,e,n){return e.x<=Math.max(t.x,n.x)&&e.x>=Math.min(t.x,n.x)&&e.y<=Math.max(t.y,n.y)&&e.y>=Math.min(t.y,n.y)}function wD(t){return t>0?1:t<0?-1:0}function LCe(t,e){let n=t;do{if(n.i!==t.i&&n.next.i!==t.i&&n.i!==e.i&&n.next.i!==e.i&&tle(n,n.next,t,e))return!0;n=n.next}while(n!==t);return!1}function bO(t,e){return Ja(t.prev,t,t.next)<0?Ja(t,e,t.next)>=0&&Ja(t,t.prev,e)>=0:Ja(t,e,t.prev)<0||Ja(t,t.next,e)<0}function UCe(t,e){let n=t,i=!1;const r=(t.x+e.x)/2,s=(t.y+e.y)/2;do n.y>s!=n.next.y>s&&n.next.y!==n.y&&r<(n.next.x-n.x)*(s-n.y)/(n.next.y-n.y)+n.x&&(i=!i),n=n.next;while(n!==t);return i}function nle(t,e){const n=yV(t.i,t.x,t.y),i=yV(e.i,e.x,e.y),r=t.next,s=e.prev;return t.next=e,e.prev=t,n.next=r,r.prev=n,i.next=n,n.prev=i,s.next=i,i.prev=s,i}function WZ(t,e,n,i){const r=yV(t,e,n);return i?(r.next=i.next,r.prev=i,i.next.prev=r,i.next=r):(r.prev=r,r.next=r),r}function EO(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function yV(t,e,n){return{i:t,x:e,y:n,prev:null,next:null,z:0,prevZ:null,nextZ:null,steiner:!1}}function BCe(t,e,n,i){let r=0;for(let s=e,a=n-i;s<n;s+=i)r+=(t[a]-t[s])*(t[s+1]+t[a+1]),a=s;return r}class FCe{static triangulate(e,n,i=2){return SCe(e,n,i)}}class lm{static area(e){const n=e.length;let i=0;for(let r=n-1,s=0;s<n;r=s++)i+=e[r].x*e[s].y-e[s].x*e[r].y;return i*.5}static isClockWise(e){return lm.area(e)<0}static triangulateShape(e,n){const i=[],r=[],s=[];YZ(e),XZ(i,e);let a=e.length;n.forEach(YZ);for(let c=0;c<n.length;c++)r.push(a),a+=n[c].length,XZ(i,n[c]);const o=FCe.triangulate(i,r);for(let c=0;c<o.length;c+=3)s.push(o.slice(c,c+3));return s}}function YZ(t){const e=t.length;e>2&&t[e-1].equals(t[0])&&t.pop()}function XZ(t,e){for(let n=0;n<e.length;n++)t.push(e[n].x),t.push(e[n].y)}class IB extends Qi{constructor(e=new gT([new Rt(.5,.5),new Rt(-.5,.5),new Rt(-.5,-.5),new Rt(.5,-.5)]),n={}){super(),this.type="ExtrudeGeometry",this.parameters={shapes:e,options:n},e=Array.isArray(e)?e:[e];const i=this,r=[],s=[];for(let o=0,c=e.length;o<c;o++){const l=e[o];a(l)}this.setAttribute("position",new Hn(r,3)),this.setAttribute("uv",new Hn(s,2)),this.computeVertexNormals();function a(o){const c=[],l=n.curveSegments!==void 0?n.curveSegments:12,u=n.steps!==void 0?n.steps:1,h=n.depth!==void 0?n.depth:1;let f=n.bevelEnabled!==void 0?n.bevelEnabled:!0,d=n.bevelThickness!==void 0?n.bevelThickness:.2,p=n.bevelSize!==void 0?n.bevelSize:d-.1,g=n.bevelOffset!==void 0?n.bevelOffset:0,y=n.bevelSegments!==void 0?n.bevelSegments:3;const v=n.extrudePath,b=n.UVGenerator!==void 0?n.UVGenerator:zCe;let T,x=!1,M,R,I,k;v&&(T=v.getSpacedPoints(u),x=!0,f=!1,M=v.computeFrenetFrames(u,!1),R=new Ae,I=new Ae,k=new Ae),f||(y=0,d=0,p=0,g=0);const P=o.extractPoints(l);let U=P.shape;const G=P.holes;if(!lm.isClockWise(U)){U=U.reverse();for(let de=0,Be=G.length;de<Be;de++){const Ie=G[de];lm.isClockWise(Ie)&&(G[de]=Ie.reverse())}}function q(de){const Ie=10000000000000001e-36;let rt=de[0];for(let ft=1;ft<=de.length;ft++){const gt=ft%de.length,bt=de[gt],be=bt.x-rt.x,ue=bt.y-rt.y,Xe=be*be+ue*ue,it=Math.max(Math.abs(bt.x),Math.abs(bt.y),Math.abs(rt.x),Math.abs(rt.y)),$e=Ie*it*it;if(Xe<=$e){de.splice(gt,1),ft--;continue}rt=bt}}q(U),G.forEach(q);const Y=G.length,ie=U;for(let de=0;de<Y;de++){const Be=G[de];U=U.concat(Be)}function V(de,Be,Ie){return Be||console.error("THREE.ExtrudeGeometry: vec does not exist"),de.clone().addScaledVector(Be,Ie)}const J=U.length;function X(de,Be,Ie){let rt,ft,gt;const bt=de.x-Be.x,be=de.y-Be.y,ue=Ie.x-de.x,Xe=Ie.y-de.y,it=bt*bt+be*be,$e=bt*Xe-be*ue;if(Math.abs($e)>Number.EPSILON){const Ue=Math.sqrt(it),qt=Math.sqrt(ue*ue+Xe*Xe),Ot=Be.x-be/Ue,Yt=Be.y+bt/Ue,ce=Ie.x-Xe/qt,j=Ie.y+ue/qt,W=((ce-Ot)*Xe-(j-Yt)*ue)/(bt*Xe-be*ue);rt=Ot+bt*W-de.x,ft=Yt+be*W-de.y;const me=rt*rt+ft*ft;if(me<=2)return new Rt(rt,ft);gt=Math.sqrt(me/2)}else{let Ue=!1;bt>Number.EPSILON?ue>Number.EPSILON&&(Ue=!0):bt<-Number.EPSILON?ue<-Number.EPSILON&&(Ue=!0):Math.sign(be)===Math.sign(Xe)&&(Ue=!0),Ue?(rt=-be,ft=bt,gt=Math.sqrt(it)):(rt=bt,ft=be,gt=Math.sqrt(it/2))}return new Rt(rt/gt,ft/gt)}const ee=[];for(let de=0,Be=ie.length,Ie=Be-1,rt=de+1;de<Be;de++,Ie++,rt++)Ie===Be&&(Ie=0),rt===Be&&(rt=0),ee[de]=X(ie[de],ie[Ie],ie[rt]);const oe=[];let fe,Re=ee.concat();for(let de=0,Be=Y;de<Be;de++){const Ie=G[de];fe=[];for(let rt=0,ft=Ie.length,gt=ft-1,bt=rt+1;rt<ft;rt++,gt++,bt++)gt===ft&&(gt=0),bt===ft&&(bt=0),fe[rt]=X(Ie[rt],Ie[gt],Ie[bt]);oe.push(fe),Re=Re.concat(fe)}let He;if(y===0)He=lm.triangulateShape(ie,G);else{const de=[],Be=[];for(let Ie=0;Ie<y;Ie++){const rt=Ie/y,ft=d*Math.cos(rt*Math.PI/2),gt=p*Math.sin(rt*Math.PI/2)+g;for(let bt=0,be=ie.length;bt<be;bt++){const ue=V(ie[bt],ee[bt],gt);St(ue.x,ue.y,-ft),rt===0&&de.push(ue)}for(let bt=0,be=Y;bt<be;bt++){const ue=G[bt];fe=oe[bt];const Xe=[];for(let it=0,$e=ue.length;it<$e;it++){const Ue=V(ue[it],fe[it],gt);St(Ue.x,Ue.y,-ft),rt===0&&Xe.push(Ue)}rt===0&&Be.push(Xe)}}He=lm.triangulateShape(de,Be)}const Te=He.length,Le=p+g;for(let de=0;de<J;de++){const Be=f?V(U[de],Re[de],Le):U[de];x?(I.copy(M.normals[0]).multiplyScalar(Be.x),R.copy(M.binormals[0]).multiplyScalar(Be.y),k.copy(T[0]).add(I).add(R),St(k.x,k.y,k.z)):St(Be.x,Be.y,0)}for(let de=1;de<=u;de++)for(let Be=0;Be<J;Be++){const Ie=f?V(U[Be],Re[Be],Le):U[Be];x?(I.copy(M.normals[de]).multiplyScalar(Ie.x),R.copy(M.binormals[de]).multiplyScalar(Ie.y),k.copy(T[de]).add(I).add(R),St(k.x,k.y,k.z)):St(Ie.x,Ie.y,h/u*de)}for(let de=y-1;de>=0;de--){const Be=de/y,Ie=d*Math.cos(Be*Math.PI/2),rt=p*Math.sin(Be*Math.PI/2)+g;for(let ft=0,gt=ie.length;ft<gt;ft++){const bt=V(ie[ft],ee[ft],rt);St(bt.x,bt.y,h+Ie)}for(let ft=0,gt=G.length;ft<gt;ft++){const bt=G[ft];fe=oe[ft];for(let be=0,ue=bt.length;be<ue;be++){const Xe=V(bt[be],fe[be],rt);x?St(Xe.x,Xe.y+T[u-1].y,T[u-1].x+Ie):St(Xe.x,Xe.y,h+Ie)}}}we(),Ce();function we(){const de=r.length/3;if(f){let Be=0,Ie=J*Be;for(let rt=0;rt<Te;rt++){const ft=He[rt];Mt(ft[2]+Ie,ft[1]+Ie,ft[0]+Ie)}Be=u+y*2,Ie=J*Be;for(let rt=0;rt<Te;rt++){const ft=He[rt];Mt(ft[0]+Ie,ft[1]+Ie,ft[2]+Ie)}}else{for(let Be=0;Be<Te;Be++){const Ie=He[Be];Mt(Ie[2],Ie[1],Ie[0])}for(let Be=0;Be<Te;Be++){const Ie=He[Be];Mt(Ie[0]+J*u,Ie[1]+J*u,Ie[2]+J*u)}}i.addGroup(de,r.length/3-de,0)}function Ce(){const de=r.length/3;let Be=0;ke(ie,Be),Be+=ie.length;for(let Ie=0,rt=G.length;Ie<rt;Ie++){const ft=G[Ie];ke(ft,Be),Be+=ft.length}i.addGroup(de,r.length/3-de,1)}function ke(de,Be){let Ie=de.length;for(;--Ie>=0;){const rt=Ie;let ft=Ie-1;ft<0&&(ft=de.length-1);for(let gt=0,bt=u+y*2;gt<bt;gt++){const be=J*gt,ue=J*(gt+1),Xe=Be+rt+be,it=Be+ft+be,$e=Be+ft+ue,Ue=Be+rt+ue;Ee(Xe,it,$e,Ue)}}}function St(de,Be,Ie){c.push(de),c.push(Be),c.push(Ie)}function Mt(de,Be,Ie){_e(de),_e(Be),_e(Ie);const rt=r.length/3,ft=b.generateTopUV(i,r,rt-3,rt-2,rt-1);tt(ft[0]),tt(ft[1]),tt(ft[2])}function Ee(de,Be,Ie,rt){_e(de),_e(Be),_e(rt),_e(Be),_e(Ie),_e(rt);const ft=r.length/3,gt=b.generateSideWallUV(i,r,ft-6,ft-3,ft-2,ft-1);tt(gt[0]),tt(gt[1]),tt(gt[3]),tt(gt[1]),tt(gt[2]),tt(gt[3])}function _e(de){r.push(c[de*3+0]),r.push(c[de*3+1]),r.push(c[de*3+2])}function tt(de){s.push(de.x),s.push(de.y)}}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){const e=super.toJSON(),n=this.parameters.shapes,i=this.parameters.options;return HCe(n,i,e)}static fromJSON(e,n){const i=[];for(let s=0,a=e.shapes.length;s<a;s++){const o=n[e.shapes[s]];i.push(o)}const r=e.options.extrudePath;return r!==void 0&&(e.options.extrudePath=new WL[r.type]().fromJSON(r)),new IB(i,e.options)}}const zCe={generateTopUV:function(t,e,n,i,r){const s=e[n*3],a=e[n*3+1],o=e[i*3],c=e[i*3+1],l=e[r*3],u=e[r*3+1];return[new Rt(s,a),new Rt(o,c),new Rt(l,u)]},generateSideWallUV:function(t,e,n,i,r,s){const a=e[n*3],o=e[n*3+1],c=e[n*3+2],l=e[i*3],u=e[i*3+1],h=e[i*3+2],f=e[r*3],d=e[r*3+1],p=e[r*3+2],g=e[s*3],y=e[s*3+1],v=e[s*3+2];return Math.abs(o-u)<Math.abs(a-l)?[new Rt(a,1-c),new Rt(l,1-h),new Rt(f,1-p),new Rt(g,1-v)]:[new Rt(o,1-c),new Rt(u,1-h),new Rt(d,1-p),new Rt(y,1-v)]}};function HCe(t,e,n){if(n.shapes=[],Array.isArray(t))for(let i=0,r=t.length;i<r;i++){const s=t[i];n.shapes.push(s.uuid)}else n.shapes.push(t.uuid);return n.options=Object.assign({},e),e.extrudePath!==void 0&&(n.options.extrudePath=e.extrudePath.toJSON()),n}class kB extends dE{constructor(e=1,n=0){const i=(1+Math.sqrt(5))/2,r=[-1,i,0,1,i,0,-1,-i,0,1,-i,0,0,-1,i,0,1,i,0,-1,-i,0,1,-i,i,0,-1,i,0,1,-i,0,-1,-i,0,1],s=[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1];super(r,s,e,n),this.type="IcosahedronGeometry",this.parameters={radius:e,detail:n}}static fromJSON(e){return new kB(e.radius,e.detail)}}class DB extends Qi{constructor(e=[new Rt(0,-.5),new Rt(.5,0),new Rt(0,.5)],n=12,i=0,r=Math.PI*2){super(),this.type="LatheGeometry",this.parameters={points:e,segments:n,phiStart:i,phiLength:r},n=Math.floor(n),r=Xi(r,0,Math.PI*2);const s=[],a=[],o=[],c=[],l=[],u=1/n,h=new Ae,f=new Rt,d=new Ae,p=new Ae,g=new Ae;let y=0,v=0;for(let b=0;b<=e.length-1;b++)switch(b){case 0:y=e[b+1].x-e[b].x,v=e[b+1].y-e[b].y,d.x=v*1,d.y=-y,d.z=v*0,g.copy(d),d.normalize(),c.push(d.x,d.y,d.z);break;case e.length-1:c.push(g.x,g.y,g.z);break;default:y=e[b+1].x-e[b].x,v=e[b+1].y-e[b].y,d.x=v*1,d.y=-y,d.z=v*0,p.copy(d),d.x+=g.x,d.y+=g.y,d.z+=g.z,d.normalize(),c.push(d.x,d.y,d.z),g.copy(p)}for(let b=0;b<=n;b++){const T=i+b*u*r,x=Math.sin(T),M=Math.cos(T);for(let R=0;R<=e.length-1;R++){h.x=e[R].x*x,h.y=e[R].y,h.z=e[R].x*M,a.push(h.x,h.y,h.z),f.x=b/n,f.y=R/(e.length-1),o.push(f.x,f.y);const I=c[3*R+0]*x,k=c[3*R+1],P=c[3*R+0]*M;l.push(I,k,P)}}for(let b=0;b<n;b++)for(let T=0;T<e.length-1;T++){const x=T+b*e.length,M=x,R=x+e.length,I=x+e.length+1,k=x+1;s.push(M,R,k),s.push(I,k,R)}this.setIndex(s),this.setAttribute("position",new Hn(a,3)),this.setAttribute("uv",new Hn(o,2)),this.setAttribute("normal",new Hn(l,3))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new DB(e.points,e.segments,e.phiStart,e.phiLength)}}class oI extends dE{constructor(e=1,n=0){const i=[1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],r=[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2];super(i,r,e,n),this.type="OctahedronGeometry",this.parameters={radius:e,detail:n}}static fromJSON(e){return new oI(e.radius,e.detail)}}class EA extends Qi{constructor(e=1,n=1,i=1,r=1){super(),this.type="PlaneGeometry",this.parameters={width:e,height:n,widthSegments:i,heightSegments:r};const s=e/2,a=n/2,o=Math.floor(i),c=Math.floor(r),l=o+1,u=c+1,h=e/o,f=n/c,d=[],p=[],g=[],y=[];for(let v=0;v<u;v++){const b=v*f-a;for(let T=0;T<l;T++){const x=T*h-s;p.push(x,-b,0),g.push(0,0,1),y.push(T/o),y.push(1-v/c)}}for(let v=0;v<c;v++)for(let b=0;b<o;b++){const T=b+l*v,x=b+l*(v+1),M=b+1+l*(v+1),R=b+1+l*v;d.push(T,x,R),d.push(x,M,R)}this.setIndex(d),this.setAttribute("position",new Hn(p,3)),this.setAttribute("normal",new Hn(g,3)),this.setAttribute("uv",new Hn(y,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new EA(e.width,e.height,e.widthSegments,e.heightSegments)}}class PB extends Qi{constructor(e=.5,n=1,i=32,r=1,s=0,a=Math.PI*2){super(),this.type="RingGeometry",this.parameters={innerRadius:e,outerRadius:n,thetaSegments:i,phiSegments:r,thetaStart:s,thetaLength:a},i=Math.max(3,i),r=Math.max(1,r);const o=[],c=[],l=[],u=[];let h=e;const f=(n-e)/r,d=new Ae,p=new Rt;for(let g=0;g<=r;g++){for(let y=0;y<=i;y++){const v=s+y/i*a;d.x=h*Math.cos(v),d.y=h*Math.sin(v),c.push(d.x,d.y,d.z),l.push(0,0,1),p.x=(d.x/n+1)/2,p.y=(d.y/n+1)/2,u.push(p.x,p.y)}h+=f}for(let g=0;g<r;g++){const y=g*(i+1);for(let v=0;v<i;v++){const b=v+y,T=b,x=b+i+1,M=b+i+2,R=b+1;o.push(T,x,R),o.push(x,M,R)}}this.setIndex(o),this.setAttribute("position",new Hn(c,3)),this.setAttribute("normal",new Hn(l,3)),this.setAttribute("uv",new Hn(u,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new PB(e.innerRadius,e.outerRadius,e.thetaSegments,e.phiSegments,e.thetaStart,e.thetaLength)}}class LB extends Qi{constructor(e=new gT([new Rt(0,.5),new Rt(-.5,-.5),new Rt(.5,-.5)]),n=12){super(),this.type="ShapeGeometry",this.parameters={shapes:e,curveSegments:n};const i=[],r=[],s=[],a=[];let o=0,c=0;if(Array.isArray(e)===!1)l(e);else for(let u=0;u<e.length;u++)l(e[u]),this.addGroup(o,c,u),o+=c,c=0;this.setIndex(i),this.setAttribute("position",new Hn(r,3)),this.setAttribute("normal",new Hn(s,3)),this.setAttribute("uv",new Hn(a,2));function l(u){const h=r.length/3,f=u.extractPoints(n);let d=f.shape;const p=f.holes;lm.isClockWise(d)===!1&&(d=d.reverse());for(let y=0,v=p.length;y<v;y++){const b=p[y];lm.isClockWise(b)===!0&&(p[y]=b.reverse())}const g=lm.triangulateShape(d,p);for(let y=0,v=p.length;y<v;y++){const b=p[y];d=d.concat(b)}for(let y=0,v=d.length;y<v;y++){const b=d[y];r.push(b.x,b.y,0),s.push(0,0,1),a.push(b.x,b.y)}for(let y=0,v=g.length;y<v;y++){const b=g[y],T=b[0]+h,x=b[1]+h,M=b[2]+h;i.push(T,x,M),c+=3}}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){const e=super.toJSON(),n=this.parameters.shapes;return jCe(n,e)}static fromJSON(e,n){const i=[];for(let r=0,s=e.shapes.length;r<s;r++){const a=n[e.shapes[r]];i.push(a)}return new LB(i,e.curveSegments)}}function jCe(t,e){if(e.shapes=[],Array.isArray(t))for(let n=0,i=t.length;n<i;n++){const r=t[n];e.shapes.push(r.uuid)}else e.shapes.push(t.uuid);return e}class cI extends Qi{constructor(e=1,n=32,i=16,r=0,s=Math.PI*2,a=0,o=Math.PI){super(),this.type="SphereGeometry",this.parameters={radius:e,widthSegments:n,heightSegments:i,phiStart:r,phiLength:s,thetaStart:a,thetaLength:o},n=Math.max(3,Math.floor(n)),i=Math.max(2,Math.floor(i));const c=Math.min(a+o,Math.PI);let l=0;const u=[],h=new Ae,f=new Ae,d=[],p=[],g=[],y=[];for(let v=0;v<=i;v++){const b=[],T=v/i;let x=0;v===0&&a===0?x=.5/n:v===i&&c===Math.PI&&(x=-.5/n);for(let M=0;M<=n;M++){const R=M/n;h.x=-e*Math.cos(r+R*s)*Math.sin(a+T*o),h.y=e*Math.cos(a+T*o),h.z=e*Math.sin(r+R*s)*Math.sin(a+T*o),p.push(h.x,h.y,h.z),f.copy(h).normalize(),g.push(f.x,f.y,f.z),y.push(R+x,1-T),b.push(l++)}u.push(b)}for(let v=0;v<i;v++)for(let b=0;b<n;b++){const T=u[v][b+1],x=u[v][b],M=u[v+1][b],R=u[v+1][b+1];(v!==0||a>0)&&d.push(T,x,R),(v!==i-1||c<Math.PI)&&d.push(x,M,R)}this.setIndex(d),this.setAttribute("position",new Hn(p,3)),this.setAttribute("normal",new Hn(g,3)),this.setAttribute("uv",new Hn(y,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new cI(e.radius,e.widthSegments,e.heightSegments,e.phiStart,e.phiLength,e.thetaStart,e.thetaLength)}}class UB extends dE{constructor(e=1,n=0){const i=[1,1,1,-1,-1,1,-1,1,-1,1,-1,-1],r=[2,1,0,0,3,2,1,3,0,2,3,1];super(i,r,e,n),this.type="TetrahedronGeometry",this.parameters={radius:e,detail:n}}static fromJSON(e){return new UB(e.radius,e.detail)}}class BB extends Qi{constructor(e=1,n=.4,i=12,r=48,s=Math.PI*2){super(),this.type="TorusGeometry",this.parameters={radius:e,tube:n,radialSegments:i,tubularSegments:r,arc:s},i=Math.floor(i),r=Math.floor(r);const a=[],o=[],c=[],l=[],u=new Ae,h=new Ae,f=new Ae;for(let d=0;d<=i;d++)for(let p=0;p<=r;p++){const g=p/r*s,y=d/i*Math.PI*2;h.x=(e+n*Math.cos(y))*Math.cos(g),h.y=(e+n*Math.cos(y))*Math.sin(g),h.z=n*Math.sin(y),o.push(h.x,h.y,h.z),u.x=e*Math.cos(g),u.y=e*Math.sin(g),f.subVectors(h,u).normalize(),c.push(f.x,f.y,f.z),l.push(p/r),l.push(d/i)}for(let d=1;d<=i;d++)for(let p=1;p<=r;p++){const g=(r+1)*d+p-1,y=(r+1)*(d-1)+p-1,v=(r+1)*(d-1)+p,b=(r+1)*d+p;a.push(g,y,b),a.push(y,v,b)}this.setIndex(a),this.setAttribute("position",new Hn(o,3)),this.setAttribute("normal",new Hn(c,3)),this.setAttribute("uv",new Hn(l,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new BB(e.radius,e.tube,e.radialSegments,e.tubularSegments,e.arc)}}class FB extends Qi{constructor(e=1,n=.4,i=64,r=8,s=2,a=3){super(),this.type="TorusKnotGeometry",this.parameters={radius:e,tube:n,tubularSegments:i,radialSegments:r,p:s,q:a},i=Math.floor(i),r=Math.floor(r);const o=[],c=[],l=[],u=[],h=new Ae,f=new Ae,d=new Ae,p=new Ae,g=new Ae,y=new Ae,v=new Ae;for(let T=0;T<=i;++T){const x=T/i*s*Math.PI*2;b(x,s,a,e,d),b(x+.01,s,a,e,p),y.subVectors(p,d),v.addVectors(p,d),g.crossVectors(y,v),v.crossVectors(g,y),g.normalize(),v.normalize();for(let M=0;M<=r;++M){const R=M/r*Math.PI*2,I=-n*Math.cos(R),k=n*Math.sin(R);h.x=d.x+(I*v.x+k*g.x),h.y=d.y+(I*v.y+k*g.y),h.z=d.z+(I*v.z+k*g.z),c.push(h.x,h.y,h.z),f.subVectors(h,d).normalize(),l.push(f.x,f.y,f.z),u.push(T/i),u.push(M/r)}}for(let T=1;T<=i;T++)for(let x=1;x<=r;x++){const M=(r+1)*(T-1)+(x-1),R=(r+1)*T+(x-1),I=(r+1)*T+x,k=(r+1)*(T-1)+x;o.push(M,R,k),o.push(R,I,k)}this.setIndex(o),this.setAttribute("position",new Hn(c,3)),this.setAttribute("normal",new Hn(l,3)),this.setAttribute("uv",new Hn(u,2));function b(T,x,M,R,I){const k=Math.cos(T),P=Math.sin(T),U=M/x*T,G=Math.cos(U);I.x=R*(2+G)*.5*k,I.y=R*(2+G)*P*.5,I.z=R*Math.sin(U)*.5}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new FB(e.radius,e.tube,e.tubularSegments,e.radialSegments,e.p,e.q)}}class zB extends Qi{constructor(e=new b7(new Ae(-1,-1,0),new Ae(-1,1,0),new Ae(1,1,0)),n=64,i=1,r=8,s=!1){super(),this.type="TubeGeometry",this.parameters={path:e,tubularSegments:n,radius:i,radialSegments:r,closed:s};const a=e.computeFrenetFrames(n,s);this.tangents=a.tangents,this.normals=a.normals,this.binormals=a.binormals;const o=new Ae,c=new Ae,l=new Rt;let u=new Ae;const h=[],f=[],d=[],p=[];g(),this.setIndex(p),this.setAttribute("position",new Hn(h,3)),this.setAttribute("normal",new Hn(f,3)),this.setAttribute("uv",new Hn(d,2));function g(){for(let T=0;T<n;T++)y(T);y(s===!1?n:0),b(),v()}function y(T){u=e.getPointAt(T/n,u);const x=a.normals[T],M=a.binormals[T];for(let R=0;R<=r;R++){const I=R/r*Math.PI*2,k=Math.sin(I),P=-Math.cos(I);c.x=P*x.x+k*M.x,c.y=P*x.y+k*M.y,c.z=P*x.z+k*M.z,c.normalize(),f.push(c.x,c.y,c.z),o.x=u.x+i*c.x,o.y=u.y+i*c.y,o.z=u.z+i*c.z,h.push(o.x,o.y,o.z)}}function v(){for(let T=1;T<=n;T++)for(let x=1;x<=r;x++){const M=(r+1)*(T-1)+(x-1),R=(r+1)*T+(x-1),I=(r+1)*T+x,k=(r+1)*(T-1)+x;p.push(M,R,k),p.push(R,I,k)}}function b(){for(let T=0;T<=n;T++)for(let x=0;x<=r;x++)l.x=T/n,l.y=x/r,d.push(l.x,l.y)}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){const e=super.toJSON();return e.path=this.parameters.path.toJSON(),e}static fromJSON(e){return new zB(new WL[e.path.type]().fromJSON(e.path),e.tubularSegments,e.radius,e.radialSegments,e.closed)}}class ile extends Qi{constructor(e=null){if(super(),this.type="WireframeGeometry",this.parameters={geometry:e},e!==null){const n=[],i=new Set,r=new Ae,s=new Ae;if(e.index!==null){const a=e.attributes.position,o=e.index;let c=e.groups;c.length===0&&(c=[{start:0,count:o.count,materialIndex:0}]);for(let l=0,u=c.length;l<u;++l){const h=c[l],f=h.start,d=h.count;for(let p=f,g=f+d;p<g;p+=3)for(let y=0;y<3;y++){const v=o.getX(p+y),b=o.getX(p+(y+1)%3);r.fromBufferAttribute(a,v),s.fromBufferAttribute(a,b),KZ(r,s,i)===!0&&(n.push(r.x,r.y,r.z),n.push(s.x,s.y,s.z))}}}else{const a=e.attributes.position;for(let o=0,c=a.count/3;o<c;o++)for(let l=0;l<3;l++){const u=3*o+l,h=3*o+(l+1)%3;r.fromBufferAttribute(a,u),s.fromBufferAttribute(a,h),KZ(r,s,i)===!0&&(n.push(r.x,r.y,r.z),n.push(s.x,s.y,s.z))}}this.setAttribute("position",new Hn(n,3))}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}}function KZ(t,e,n){const i=`${t.x},${t.y},${t.z}-${e.x},${e.y},${e.z}`,r=`${e.x},${e.y},${e.z}-${t.x},${t.y},${t.z}`;return n.has(i)===!0||n.has(r)===!0?!1:(n.add(i),n.add(r),!0)}var ZZ=Object.freeze({__proto__:null,BoxGeometry:d1,CapsuleGeometry:RB,CircleGeometry:MB,ConeGeometry:aI,CylinderGeometry:sI,DodecahedronGeometry:OB,EdgesGeometry:Wce,ExtrudeGeometry:IB,IcosahedronGeometry:kB,LatheGeometry:DB,OctahedronGeometry:oI,PlaneGeometry:EA,PolyhedronGeometry:dE,RingGeometry:PB,ShapeGeometry:LB,SphereGeometry:cI,TetrahedronGeometry:UB,TorusGeometry:BB,TorusKnotGeometry:FB,TubeGeometry:zB,WireframeGeometry:ile});class rle extends Tl{constructor(e){super(),this.isShadowMaterial=!0,this.type="ShadowMaterial",this.color=new yn(0),this.transparent=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.fog=e.fog,this}}class sle extends Hc{constructor(e){super(e),this.isRawShaderMaterial=!0,this.type="RawShaderMaterial"}}class S7 extends Tl{constructor(e){super(),this.isMeshStandardMaterial=!0,this.type="MeshStandardMaterial",this.defines={STANDARD:""},this.color=new yn(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new yn(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=hE,this.normalScale=new Rt(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new rf,this.envMapIntensity=1,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.defines={STANDARD:""},this.color.copy(e.color),this.roughness=e.roughness,this.metalness=e.metalness,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.roughnessMap=e.roughnessMap,this.metalnessMap=e.metalnessMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.envMapIntensity=e.envMapIntensity,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class ale extends S7{constructor(e){super(),this.isMeshPhysicalMaterial=!0,this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.anisotropyRotation=0,this.anisotropyMap=null,this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new Rt(1,1),this.clearcoatNormalMap=null,this.ior=1.5,Object.defineProperty(this,"reflectivity",{get:function(){return Xi(2.5*(this.ior-1)/(this.ior+1),0,1)},set:function(n){this.ior=(1+.4*n)/(1-.4*n)}}),this.iridescenceMap=null,this.iridescenceIOR=1.3,this.iridescenceThicknessRange=[100,400],this.iridescenceThicknessMap=null,this.sheenColor=new yn(0),this.sheenColorMap=null,this.sheenRoughness=1,this.sheenRoughnessMap=null,this.transmissionMap=null,this.thickness=0,this.thicknessMap=null,this.attenuationDistance=1/0,this.attenuationColor=new yn(1,1,1),this.specularIntensity=1,this.specularIntensityMap=null,this.specularColor=new yn(1,1,1),this.specularColorMap=null,this._anisotropy=0,this._clearcoat=0,this._dispersion=0,this._iridescence=0,this._sheen=0,this._transmission=0,this.setValues(e)}get anisotropy(){return this._anisotropy}set anisotropy(e){this._anisotropy>0!=e>0&&this.version++,this._anisotropy=e}get clearcoat(){return this._clearcoat}set clearcoat(e){this._clearcoat>0!=e>0&&this.version++,this._clearcoat=e}get iridescence(){return this._iridescence}set iridescence(e){this._iridescence>0!=e>0&&this.version++,this._iridescence=e}get dispersion(){return this._dispersion}set dispersion(e){this._dispersion>0!=e>0&&this.version++,this._dispersion=e}get sheen(){return this._sheen}set sheen(e){this._sheen>0!=e>0&&this.version++,this._sheen=e}get transmission(){return this._transmission}set transmission(e){this._transmission>0!=e>0&&this.version++,this._transmission=e}copy(e){return super.copy(e),this.defines={STANDARD:"",PHYSICAL:""},this.anisotropy=e.anisotropy,this.anisotropyRotation=e.anisotropyRotation,this.anisotropyMap=e.anisotropyMap,this.clearcoat=e.clearcoat,this.clearcoatMap=e.clearcoatMap,this.clearcoatRoughness=e.clearcoatRoughness,this.clearcoatRoughnessMap=e.clearcoatRoughnessMap,this.clearcoatNormalMap=e.clearcoatNormalMap,this.clearcoatNormalScale.copy(e.clearcoatNormalScale),this.dispersion=e.dispersion,this.ior=e.ior,this.iridescence=e.iridescence,this.iridescenceMap=e.iridescenceMap,this.iridescenceIOR=e.iridescenceIOR,this.iridescenceThicknessRange=[...e.iridescenceThicknessRange],this.iridescenceThicknessMap=e.iridescenceThicknessMap,this.sheen=e.sheen,this.sheenColor.copy(e.sheenColor),this.sheenColorMap=e.sheenColorMap,this.sheenRoughness=e.sheenRoughness,this.sheenRoughnessMap=e.sheenRoughnessMap,this.transmission=e.transmission,this.transmissionMap=e.transmissionMap,this.thickness=e.thickness,this.thicknessMap=e.thicknessMap,this.attenuationDistance=e.attenuationDistance,this.attenuationColor.copy(e.attenuationColor),this.specularIntensity=e.specularIntensity,this.specularIntensityMap=e.specularIntensityMap,this.specularColor.copy(e.specularColor),this.specularColorMap=e.specularColorMap,this}}class ole extends Tl{constructor(e){super(),this.isMeshPhongMaterial=!0,this.type="MeshPhongMaterial",this.color=new yn(16777215),this.specular=new yn(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new yn(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=hE,this.normalScale=new Rt(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new rf,this.combine=QN,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.specular.copy(e.specular),this.shininess=e.shininess,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class cle extends Tl{constructor(e){super(),this.isMeshToonMaterial=!0,this.defines={TOON:""},this.type="MeshToonMaterial",this.color=new yn(16777215),this.map=null,this.gradientMap=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new yn(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=hE,this.normalScale=new Rt(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.gradientMap=e.gradientMap,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}class T7 extends Tl{constructor(e){super(),this.isMeshNormalMaterial=!0,this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=hE,this.normalScale=new Rt(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.flatShading=!1,this.setValues(e)}copy(e){return super.copy(e),this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.flatShading=e.flatShading,this}}class lle extends Tl{constructor(e){super(),this.isMeshLambertMaterial=!0,this.type="MeshLambertMaterial",this.color=new yn(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new yn(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=hE,this.normalScale=new Rt(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new rf,this.combine=QN,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class x7 extends Tl{constructor(e){super(),this.isMeshDepthMaterial=!0,this.type="MeshDepthMaterial",this.depthPacking=uE,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.setValues(e)}copy(e){return super.copy(e),this.depthPacking=e.depthPacking,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this}}class w7 extends Tl{constructor(e){super(),this.isMeshDistanceMaterial=!0,this.type="MeshDistanceMaterial",this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.setValues(e)}copy(e){return super.copy(e),this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this}}class ule extends Tl{constructor(e){super(),this.isMeshMatcapMaterial=!0,this.defines={MATCAP:""},this.type="MeshMatcapMaterial",this.color=new yn(16777215),this.matcap=null,this.map=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=hE,this.normalScale=new Rt(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.defines={MATCAP:""},this.color.copy(e.color),this.matcap=e.matcap,this.map=e.map,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.flatShading=e.flatShading,this.fog=e.fog,this}}class hle extends hh{constructor(e){super(),this.isLineDashedMaterial=!0,this.type="LineDashedMaterial",this.scale=1,this.dashSize=3,this.gapSize=1,this.setValues(e)}copy(e){return super.copy(e),this.scale=e.scale,this.dashSize=e.dashSize,this.gapSize=e.gapSize,this}}function aT(t,e){return!t||t.constructor===e?t:typeof e.BYTES_PER_ELEMENT=="number"?new e(t):Array.prototype.slice.call(t)}function fle(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)}function dle(t){function e(r,s){return t[r]-t[s]}const n=t.length,i=new Array(n);for(let r=0;r!==n;++r)i[r]=r;return i.sort(e),i}function bV(t,e,n){const i=t.length,r=new t.constructor(i);for(let s=0,a=0;a!==i;++s){const o=n[s]*e;for(let c=0;c!==e;++c)r[a++]=t[o+c]}return r}function C7(t,e,n,i){let r=1,s=t[0];for(;s!==void 0&&s[i]===void 0;)s=t[r++];if(s===void 0)return;let a=s[i];if(a!==void 0)if(Array.isArray(a))do a=s[i],a!==void 0&&(e.push(s.time),n.push(...a)),s=t[r++];while(s!==void 0);else if(a.toArray!==void 0)do a=s[i],a!==void 0&&(e.push(s.time),a.toArray(n,n.length)),s=t[r++];while(s!==void 0);else do a=s[i],a!==void 0&&(e.push(s.time),n.push(a)),s=t[r++];while(s!==void 0)}function VCe(t,e,n,i,r=30){const s=t.clone();s.name=e;const a=[];for(let c=0;c<s.tracks.length;++c){const l=s.tracks[c],u=l.getValueSize(),h=[],f=[];for(let d=0;d<l.times.length;++d){const p=l.times[d]*r;if(!(p<n||p>=i)){h.push(l.times[d]);for(let g=0;g<u;++g)f.push(l.values[d*u+g])}}h.length!==0&&(l.times=aT(h,l.times.constructor),l.values=aT(f,l.values.constructor),a.push(l))}s.tracks=a;let o=1/0;for(let c=0;c<s.tracks.length;++c)o>s.tracks[c].times[0]&&(o=s.tracks[c].times[0]);for(let c=0;c<s.tracks.length;++c)s.tracks[c].shift(-1*o);return s.resetDuration(),s}function GCe(t,e=0,n=t,i=30){i<=0&&(i=30);const r=n.tracks.length,s=e/i;for(let a=0;a<r;++a){const o=n.tracks[a],c=o.ValueTypeName;if(c==="bool"||c==="string")continue;const l=t.tracks.find(function(v){return v.name===o.name&&v.ValueTypeName===c});if(l===void 0)continue;let u=0;const h=o.getValueSize();o.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(u=h/3);let f=0;const d=l.getValueSize();l.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(f=d/3);const p=o.times.length-1;let g;if(s<=o.times[0]){const v=u,b=h-u;g=o.values.slice(v,b)}else if(s>=o.times[p]){const v=p*h+u,b=v+h-u;g=o.values.slice(v,b)}else{const v=o.createInterpolant(),b=u,T=h-u;v.evaluate(s),g=v.resultBuffer.slice(b,T)}c==="quaternion"&&new Qh().fromArray(g).normalize().conjugate().toArray(g);const y=l.times.length;for(let v=0;v<y;++v){const b=v*d+f;if(c==="quaternion")Qh.multiplyQuaternionsFlat(l.values,b,g,0,l.values,b);else{const T=d-f*2;for(let x=0;x<T;++x)l.values[b+x]-=g[x]}}}return t.blendMode=c7,t}class qCe{static convertArray(e,n){return aT(e,n)}static isTypedArray(e){return fle(e)}static getKeyframeOrder(e){return dle(e)}static sortedArray(e,n,i){return bV(e,n,i)}static flattenJSON(e,n,i,r){C7(e,n,i,r)}static subclip(e,n,i,r,s=30){return VCe(e,n,i,r,s)}static makeClipAdditive(e,n=0,i=e,r=30){return GCe(e,n,i,r)}}class lI{constructor(e,n,i,r){this.parameterPositions=e,this._cachedIndex=0,this.resultBuffer=r!==void 0?r:new n.constructor(i),this.sampleValues=n,this.valueSize=i,this.settings=null,this.DefaultSettings_={}}evaluate(e){const n=this.parameterPositions;let i=this._cachedIndex,r=n[i],s=n[i-1];e:{t:{let a;n:{i:if(!(e<r)){for(let o=i+2;;){if(r===void 0){if(e<s)break i;return i=n.length,this._cachedIndex=i,this.copySampleValue_(i-1)}if(i===o)break;if(s=r,r=n[++i],e<r)break t}a=n.length;break n}if(!(e>=s)){const o=n[1];e<o&&(i=2,s=o);for(let c=i-2;;){if(s===void 0)return this._cachedIndex=0,this.copySampleValue_(0);if(i===c)break;if(r=s,s=n[--i-1],e>=s)break t}a=i,i=0;break n}break e}for(;i<a;){const o=i+a>>>1;e<n[o]?a=o:i=o+1}if(r=n[i],s=n[i-1],s===void 0)return this._cachedIndex=0,this.copySampleValue_(0);if(r===void 0)return i=n.length,this._cachedIndex=i,this.copySampleValue_(i-1)}this._cachedIndex=i,this.intervalChanged_(i,s,r)}return this.interpolate_(i,s,e,r)}getSettings_(){return this.settings||this.DefaultSettings_}copySampleValue_(e){const n=this.resultBuffer,i=this.sampleValues,r=this.valueSize,s=e*r;for(let a=0;a!==r;++a)n[a]=i[s+a];return n}interpolate_(){throw new Error("call to abstract method")}intervalChanged_(){}}class ple extends lI{constructor(e,n,i,r){super(e,n,i,r),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0,this.DefaultSettings_={endingStart:rT,endingEnd:rT}}intervalChanged_(e,n,i){const r=this.parameterPositions;let s=e-2,a=e+1,o=r[s],c=r[a];if(o===void 0)switch(this.getSettings_().endingStart){case sT:s=e,o=2*n-i;break;case pO:s=r.length-2,o=n+r[s]-r[s+1];break;default:s=e,o=i}if(c===void 0)switch(this.getSettings_().endingEnd){case sT:a=e,c=2*i-n;break;case pO:a=1,c=i+r[1]-r[0];break;default:a=e-1,c=n}const l=(i-n)*.5,u=this.valueSize;this._weightPrev=l/(n-o),this._weightNext=l/(c-i),this._offsetPrev=s*u,this._offsetNext=a*u}interpolate_(e,n,i,r){const s=this.resultBuffer,a=this.sampleValues,o=this.valueSize,c=e*o,l=c-o,u=this._offsetPrev,h=this._offsetNext,f=this._weightPrev,d=this._weightNext,p=(i-n)/(r-n),g=p*p,y=g*p,v=-f*y+2*f*g-f*p,b=(1+f)*y+(-1.5-2*f)*g+(-.5+f)*p+1,T=(-1-d)*y+(1.5+d)*g+.5*p,x=d*y-d*g;for(let M=0;M!==o;++M)s[M]=v*a[u+M]+b*a[l+M]+T*a[c+M]+x*a[h+M];return s}}class A7 extends lI{constructor(e,n,i,r){super(e,n,i,r)}interpolate_(e,n,i,r){const s=this.resultBuffer,a=this.sampleValues,o=this.valueSize,c=e*o,l=c-o,u=(i-n)/(r-n),h=1-u;for(let f=0;f!==o;++f)s[f]=a[l+f]*h+a[c+f]*u;return s}}class mle extends lI{constructor(e,n,i,r){super(e,n,i,r)}interpolate_(e){return this.copySampleValue_(e-1)}}class xp{constructor(e,n,i,r){if(e===void 0)throw new Error("THREE.KeyframeTrack: track name is undefined");if(n===void 0||n.length===0)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+e);this.name=e,this.times=aT(n,this.TimeBufferType),this.values=aT(i,this.ValueBufferType),this.setInterpolation(r||this.DefaultInterpolation)}static toJSON(e){const n=e.constructor;let i;if(n.toJSON!==this.toJSON)i=n.toJSON(e);else{i={name:e.name,times:aT(e.times,Array),values:aT(e.values,Array)};const r=e.getInterpolation();r!==e.DefaultInterpolation&&(i.interpolation=r)}return i.type=e.ValueTypeName,i}InterpolantFactoryMethodDiscrete(e){return new mle(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodLinear(e){return new A7(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodSmooth(e){return new ple(this.times,this.values,this.getValueSize(),e)}setInterpolation(e){let n;switch(e){case dO:n=this.InterpolantFactoryMethodDiscrete;break;case GL:n=this.InterpolantFactoryMethodLinear;break;case XP:n=this.InterpolantFactoryMethodSmooth;break}if(n===void 0){const i="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(this.createInterpolant===void 0)if(e!==this.DefaultInterpolation)this.setInterpolation(this.DefaultInterpolation);else throw new Error(i);return console.warn("THREE.KeyframeTrack:",i),this}return this.createInterpolant=n,this}getInterpolation(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return dO;case this.InterpolantFactoryMethodLinear:return GL;case this.InterpolantFactoryMethodSmooth:return XP}}getValueSize(){return this.values.length/this.times.length}shift(e){if(e!==0){const n=this.times;for(let i=0,r=n.length;i!==r;++i)n[i]+=e}return this}scale(e){if(e!==1){const n=this.times;for(let i=0,r=n.length;i!==r;++i)n[i]*=e}return this}trim(e,n){const i=this.times,r=i.length;let s=0,a=r-1;for(;s!==r&&i[s]<e;)++s;for(;a!==-1&&i[a]>n;)--a;if(++a,s!==0||a!==r){s>=a&&(a=Math.max(a,1),s=a-1);const o=this.getValueSize();this.times=i.slice(s,a),this.values=this.values.slice(s*o,a*o)}return this}validate(){let e=!0;const n=this.getValueSize();n-Math.floor(n)!==0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),e=!1);const i=this.times,r=this.values,s=i.length;s===0&&(console.error("THREE.KeyframeTrack: Track is empty.",this),e=!1);let a=null;for(let o=0;o!==s;o++){const c=i[o];if(typeof c=="number"&&isNaN(c)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,o,c),e=!1;break}if(a!==null&&a>c){console.error("THREE.KeyframeTrack: Out of order keys.",this,o,c,a),e=!1;break}a=c}if(r!==void 0&&fle(r))for(let o=0,c=r.length;o!==c;++o){const l=r[o];if(isNaN(l)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,o,l),e=!1;break}}return e}optimize(){const e=this.times.slice(),n=this.values.slice(),i=this.getValueSize(),r=this.getInterpolation()===XP,s=e.length-1;let a=1;for(let o=1;o<s;++o){let c=!1;const l=e[o],u=e[o+1];if(l!==u&&(o!==1||l!==e[0]))if(r)c=!0;else{const h=o*i,f=h-i,d=h+i;for(let p=0;p!==i;++p){const g=n[h+p];if(g!==n[f+p]||g!==n[d+p]){c=!0;break}}}if(c){if(o!==a){e[a]=e[o];const h=o*i,f=a*i;for(let d=0;d!==i;++d)n[f+d]=n[h+d]}++a}}if(s>0){e[a]=e[s];for(let o=s*i,c=a*i,l=0;l!==i;++l)n[c+l]=n[o+l];++a}return a!==e.length?(this.times=e.slice(0,a),this.values=n.slice(0,a*i)):(this.times=e,this.values=n),this}clone(){const e=this.times.slice(),n=this.values.slice(),i=this.constructor,r=new i(this.name,e,n);return r.createInterpolant=this.createInterpolant,r}}xp.prototype.ValueTypeName="";xp.prototype.TimeBufferType=Float32Array;xp.prototype.ValueBufferType=Float32Array;xp.prototype.DefaultInterpolation=GL;class p1 extends xp{constructor(e,n,i){super(e,n,i)}}p1.prototype.ValueTypeName="bool";p1.prototype.ValueBufferType=Array;p1.prototype.DefaultInterpolation=dO;p1.prototype.InterpolantFactoryMethodLinear=void 0;p1.prototype.InterpolantFactoryMethodSmooth=void 0;class R7 extends xp{constructor(e,n,i,r){super(e,n,i,r)}}R7.prototype.ValueTypeName="color";class SO extends xp{constructor(e,n,i,r){super(e,n,i,r)}}SO.prototype.ValueTypeName="number";class gle extends lI{constructor(e,n,i,r){super(e,n,i,r)}interpolate_(e,n,i,r){const s=this.resultBuffer,a=this.sampleValues,o=this.valueSize,c=(i-n)/(r-n);let l=e*o;for(let u=l+o;l!==u;l+=4)Qh.slerpFlat(s,0,a,l-o,a,l,c);return s}}class uI extends xp{constructor(e,n,i,r){super(e,n,i,r)}InterpolantFactoryMethodLinear(e){return new gle(this.times,this.values,this.getValueSize(),e)}}uI.prototype.ValueTypeName="quaternion";uI.prototype.InterpolantFactoryMethodSmooth=void 0;class m1 extends xp{constructor(e,n,i){super(e,n,i)}}m1.prototype.ValueTypeName="string";m1.prototype.ValueBufferType=Array;m1.prototype.DefaultInterpolation=dO;m1.prototype.InterpolantFactoryMethodLinear=void 0;m1.prototype.InterpolantFactoryMethodSmooth=void 0;class TO extends xp{constructor(e,n,i,r){super(e,n,i,r)}}TO.prototype.ValueTypeName="vector";class xO{constructor(e="",n=-1,i=[],r=yB){this.name=e,this.tracks=i,this.duration=n,this.blendMode=r,this.uuid=ed(),this.duration<0&&this.resetDuration()}static parse(e){const n=[],i=e.tracks,r=1/(e.fps||1);for(let a=0,o=i.length;a!==o;++a)n.push(WCe(i[a]).scale(r));const s=new this(e.name,e.duration,n,e.blendMode);return s.uuid=e.uuid,s}static toJSON(e){const n=[],i=e.tracks,r={name:e.name,duration:e.duration,tracks:n,uuid:e.uuid,blendMode:e.blendMode};for(let s=0,a=i.length;s!==a;++s)n.push(xp.toJSON(i[s]));return r}static CreateFromMorphTargetSequence(e,n,i,r){const s=n.length,a=[];for(let o=0;o<s;o++){let c=[],l=[];c.push((o+s-1)%s,o,(o+1)%s),l.push(0,1,0);const u=dle(c);c=bV(c,1,u),l=bV(l,1,u),!r&&c[0]===0&&(c.push(s),l.push(l[0])),a.push(new SO(".morphTargetInfluences["+n[o].name+"]",c,l).scale(1/i))}return new this(e,-1,a)}static findByName(e,n){let i=e;if(!Array.isArray(e)){const r=e;i=r.geometry&&r.geometry.animations||r.animations}for(let r=0;r<i.length;r++)if(i[r].name===n)return i[r];return null}static CreateClipsFromMorphTargetSequences(e,n,i){const r={},s=/^([\w-]*?)([\d]+)$/;for(let o=0,c=e.length;o<c;o++){const l=e[o],u=l.name.match(s);if(u&&u.length>1){const h=u[1];let f=r[h];f||(r[h]=f=[]),f.push(l)}}const a=[];for(const o in r)a.push(this.CreateFromMorphTargetSequence(o,r[o],n,i));return a}static parseAnimation(e,n){if(console.warn("THREE.AnimationClip: parseAnimation() is deprecated and will be removed with r185"),!e)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;const i=function(h,f,d,p,g){if(d.length!==0){const y=[],v=[];C7(d,y,v,p),y.length!==0&&g.push(new h(f,y,v))}},r=[],s=e.name||"default",a=e.fps||30,o=e.blendMode;let c=e.length||-1;const l=e.hierarchy||[];for(let h=0;h<l.length;h++){const f=l[h].keys;if(!(!f||f.length===0))if(f[0].morphTargets){const d={};let p;for(p=0;p<f.length;p++)if(f[p].morphTargets)for(let g=0;g<f[p].morphTargets.length;g++)d[f[p].morphTargets[g]]=-1;for(const g in d){const y=[],v=[];for(let b=0;b!==f[p].morphTargets.length;++b){const T=f[p];y.push(T.time),v.push(T.morphTarget===g?1:0)}r.push(new SO(".morphTargetInfluence["+g+"]",y,v))}c=d.length*a}else{const d=".bones["+n[h].name+"]";i(TO,d+".position",f,"pos",r),i(uI,d+".quaternion",f,"rot",r),i(TO,d+".scale",f,"scl",r)}}return r.length===0?null:new this(s,c,r,o)}resetDuration(){const e=this.tracks;let n=0;for(let i=0,r=e.length;i!==r;++i){const s=this.tracks[i];n=Math.max(n,s.times[s.times.length-1])}return this.duration=n,this}trim(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].trim(0,this.duration);return this}validate(){let e=!0;for(let n=0;n<this.tracks.length;n++)e=e&&this.tracks[n].validate();return e}optimize(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].optimize();return this}clone(){const e=[];for(let n=0;n<this.tracks.length;n++)e.push(this.tracks[n].clone());return new this.constructor(this.name,this.duration,e,this.blendMode)}toJSON(){return this.constructor.toJSON(this)}}function $Ce(t){switch(t.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return SO;case"vector":case"vector2":case"vector3":case"vector4":return TO;case"color":return R7;case"quaternion":return uI;case"bool":case"boolean":return p1;case"string":return m1}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+t)}function WCe(t){if(t.type===void 0)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");const e=$Ce(t.type);if(t.times===void 0){const n=[],i=[];C7(t.keys,n,i,"value"),t.times=n,t.values=i}return e.parse!==void 0?e.parse(t):new e(t.name,t.times,t.values,t.interpolation)}const Kv={enabled:!1,files:{},add:function(t,e){this.enabled!==!1&&(this.files[t]=e)},get:function(t){if(this.enabled!==!1)return this.files[t]},remove:function(t){delete this.files[t]},clear:function(){this.files={}}};class M7{constructor(e,n,i){const r=this;let s=!1,a=0,o=0,c;const l=[];this.onStart=void 0,this.onLoad=e,this.onProgress=n,this.onError=i,this.itemStart=function(u){o++,s===!1&&r.onStart!==void 0&&r.onStart(u,a,o),s=!0},this.itemEnd=function(u){a++,r.onProgress!==void 0&&r.onProgress(u,a,o),a===o&&(s=!1,r.onLoad!==void 0&&r.onLoad())},this.itemError=function(u){r.onError!==void 0&&r.onError(u)},this.resolveURL=function(u){return c?c(u):u},this.setURLModifier=function(u){return c=u,this},this.addHandler=function(u,h){return l.push(u,h),this},this.removeHandler=function(u){const h=l.indexOf(u);return h!==-1&&l.splice(h,2),this},this.getHandler=function(u){for(let h=0,f=l.length;h<f;h+=2){const d=l[h],p=l[h+1];if(d.global&&(d.lastIndex=0),d.test(u))return p}return null}}}const vle=new M7;class df{constructor(e){this.manager=e!==void 0?e:vle,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}load(){}loadAsync(e,n){const i=this;return new Promise(function(r,s){i.load(e,r,n,s)})}parse(){}setCrossOrigin(e){return this.crossOrigin=e,this}setWithCredentials(e){return this.withCredentials=e,this}setPath(e){return this.path=e,this}setResourcePath(e){return this.resourcePath=e,this}setRequestHeader(e){return this.requestHeader=e,this}}df.DEFAULT_MATERIAL_NAME="__DEFAULT";const xv={};class YCe extends Error{constructor(e,n){super(e),this.response=n}}class g_ extends df{constructor(e){super(e),this.mimeType="",this.responseType=""}load(e,n,i,r){e===void 0&&(e=""),this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);const s=Kv.get(e);if(s!==void 0)return this.manager.itemStart(e),setTimeout(()=>{n&&n(s),this.manager.itemEnd(e)},0),s;if(xv[e]!==void 0){xv[e].push({onLoad:n,onProgress:i,onError:r});return}xv[e]=[],xv[e].push({onLoad:n,onProgress:i,onError:r});const a=new Request(e,{headers:new Headers(this.requestHeader),credentials:this.withCredentials?"include":"same-origin"}),o=this.mimeType,c=this.responseType;fetch(a).then(l=>{if(l.status===200||l.status===0){if(l.status===0&&console.warn("THREE.FileLoader: HTTP Status 0 received."),typeof ReadableStream>"u"||l.body===void 0||l.body.getReader===void 0)return l;const u=xv[e],h=l.body.getReader(),f=l.headers.get("X-File-Size")||l.headers.get("Content-Length"),d=f?parseInt(f):0,p=d!==0;let g=0;const y=new ReadableStream({start(v){b();function b(){h.read().then(({done:T,value:x})=>{if(T)v.close();else{g+=x.byteLength;const M=new ProgressEvent("progress",{lengthComputable:p,loaded:g,total:d});for(let R=0,I=u.length;R<I;R++){const k=u[R];k.onProgress&&k.onProgress(M)}v.enqueue(x),b()}},T=>{v.error(T)})}}});return new Response(y)}else throw new YCe(`fetch for "${l.url}" responded with ${l.status}: ${l.statusText}`,l)}).then(l=>{switch(c){case"arraybuffer":return l.arrayBuffer();case"blob":return l.blob();case"document":return l.text().then(u=>new DOMParser().parseFromString(u,o));case"json":return l.json();default:if(o==="")return l.text();{const h=/charset="?([^;"\s]*)"?/i.exec(o),f=h&&h[1]?h[1].toLowerCase():void 0,d=new TextDecoder(f);return l.arrayBuffer().then(p=>d.decode(p))}}}).then(l=>{Kv.add(e,l);const u=xv[e];delete xv[e];for(let h=0,f=u.length;h<f;h++){const d=u[h];d.onLoad&&d.onLoad(l)}}).catch(l=>{const u=xv[e];if(u===void 0)throw this.manager.itemError(e),l;delete xv[e];for(let h=0,f=u.length;h<f;h++){const d=u[h];d.onError&&d.onError(l)}this.manager.itemError(e)}).finally(()=>{this.manager.itemEnd(e)}),this.manager.itemStart(e)}setResponseType(e){return this.responseType=e,this}setMimeType(e){return this.mimeType=e,this}}class XCe extends df{constructor(e){super(e)}load(e,n,i,r){const s=this,a=new g_(this.manager);a.setPath(this.path),a.setRequestHeader(this.requestHeader),a.setWithCredentials(this.withCredentials),a.load(e,function(o){try{n(s.parse(JSON.parse(o)))}catch(c){r?r(c):console.error(c),s.manager.itemError(e)}},i,r)}parse(e){const n=[];for(let i=0;i<e.length;i++){const r=xO.parse(e[i]);n.push(r)}return n}}class KCe extends df{constructor(e){super(e)}load(e,n,i,r){const s=this,a=[],o=new AB,c=new g_(this.manager);c.setPath(this.path),c.setResponseType("arraybuffer"),c.setRequestHeader(this.requestHeader),c.setWithCredentials(s.withCredentials);let l=0;function u(h){c.load(e[h],function(f){const d=s.parse(f,!0);a[h]={width:d.width,height:d.height,format:d.format,mipmaps:d.mipmaps},l+=1,l===6&&(d.mipmapCount===1&&(o.minFilter=Ea),o.image=a,o.format=d.format,o.needsUpdate=!0,n&&n(o))},i,r)}if(Array.isArray(e))for(let h=0,f=e.length;h<f;++h)u(h);else c.load(e,function(h){const f=s.parse(h,!0);if(f.isCubemap){const d=f.mipmaps.length/f.mipmapCount;for(let p=0;p<d;p++){a[p]={mipmaps:[]};for(let g=0;g<f.mipmapCount;g++)a[p].mipmaps.push(f.mipmaps[p*f.mipmapCount+g]),a[p].format=f.format,a[p].width=f.width,a[p].height=f.height}o.image=a}else o.image.width=f.width,o.image.height=f.height,o.mipmaps=f.mipmaps;f.mipmapCount===1&&(o.minFilter=Ea),o.format=f.format,o.needsUpdate=!0,n&&n(o)},i,r);return o}}class wO extends df{constructor(e){super(e)}load(e,n,i,r){this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);const s=this,a=Kv.get(e);if(a!==void 0)return s.manager.itemStart(e),setTimeout(function(){n&&n(a),s.manager.itemEnd(e)},0),a;const o=_O("img");function c(){u(),Kv.add(e,this),n&&n(this),s.manager.itemEnd(e)}function l(h){u(),r&&r(h),s.manager.itemError(e),s.manager.itemEnd(e)}function u(){o.removeEventListener("load",c,!1),o.removeEventListener("error",l,!1)}return o.addEventListener("load",c,!1),o.addEventListener("error",l,!1),e.slice(0,5)!=="data:"&&this.crossOrigin!==void 0&&(o.crossOrigin=this.crossOrigin),s.manager.itemStart(e),o.src=e,o}}class ZCe extends df{constructor(e){super(e)}load(e,n,i,r){const s=new rI;s.colorSpace=ba;const a=new wO(this.manager);a.setCrossOrigin(this.crossOrigin),a.setPath(this.path);let o=0;function c(l){a.load(e[l],function(u){s.images[l]=u,o++,o===6&&(s.needsUpdate=!0,n&&n(s))},void 0,r)}for(let l=0;l<e.length;++l)c(l);return s}}class JCe extends df{constructor(e){super(e)}load(e,n,i,r){const s=this,a=new up,o=new g_(this.manager);return o.setResponseType("arraybuffer"),o.setRequestHeader(this.requestHeader),o.setPath(this.path),o.setWithCredentials(s.withCredentials),o.load(e,function(c){let l;try{l=s.parse(c)}catch(u){if(r!==void 0)r(u);else{console.error(u);return}}l.image!==void 0?a.image=l.image:l.data!==void 0&&(a.image.width=l.width,a.image.height=l.height,a.image.data=l.data),a.wrapS=l.wrapS!==void 0?l.wrapS:np,a.wrapT=l.wrapT!==void 0?l.wrapT:np,a.magFilter=l.magFilter!==void 0?l.magFilter:Ea,a.minFilter=l.minFilter!==void 0?l.minFilter:Ea,a.anisotropy=l.anisotropy!==void 0?l.anisotropy:1,l.colorSpace!==void 0&&(a.colorSpace=l.colorSpace),l.flipY!==void 0&&(a.flipY=l.flipY),l.format!==void 0&&(a.format=l.format),l.type!==void 0&&(a.type=l.type),l.mipmaps!==void 0&&(a.mipmaps=l.mipmaps,a.minFilter=Ig),l.mipmapCount===1&&(a.minFilter=Ea),l.generateMipmaps!==void 0&&(a.generateMipmaps=l.generateMipmaps),a.needsUpdate=!0,n&&n(a,l)},i,r),a}}class QCe extends df{constructor(e){super(e)}load(e,n,i,r){const s=new Ba,a=new wO(this.manager);return a.setCrossOrigin(this.crossOrigin),a.setPath(this.path),a.load(e,function(o){s.image=o,s.needsUpdate=!0,n!==void 0&&n(s)},i,r),s}}class pE extends qr{constructor(e,n=1){super(),this.isLight=!0,this.type="Light",this.color=new yn(e),this.intensity=n}dispose(){}copy(e,n){return super.copy(e,n),this.color.copy(e.color),this.intensity=e.intensity,this}toJSON(e){const n=super.toJSON(e);return n.object.color=this.color.getHex(),n.object.intensity=this.intensity,this.groundColor!==void 0&&(n.object.groundColor=this.groundColor.getHex()),this.distance!==void 0&&(n.object.distance=this.distance),this.angle!==void 0&&(n.object.angle=this.angle),this.decay!==void 0&&(n.object.decay=this.decay),this.penumbra!==void 0&&(n.object.penumbra=this.penumbra),this.shadow!==void 0&&(n.object.shadow=this.shadow.toJSON()),this.target!==void 0&&(n.object.target=this.target.uuid),n}}class _le extends pE{constructor(e,n,i){super(e,i),this.isHemisphereLight=!0,this.type="HemisphereLight",this.position.copy(qr.DEFAULT_UP),this.updateMatrix(),this.groundColor=new yn(n)}copy(e,n){return super.copy(e,n),this.groundColor.copy(e.groundColor),this}}const lH=new Ni,JZ=new Ae,QZ=new Ae;class O7{constructor(e){this.camera=e,this.intensity=1,this.bias=0,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new Rt(512,512),this.mapType=El,this.map=null,this.mapPass=null,this.matrix=new Ni,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new yA,this._frameExtents=new Rt(1,1),this._viewportCount=1,this._viewports=[new Zr(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(e){const n=this.camera,i=this.matrix;JZ.setFromMatrixPosition(e.matrixWorld),n.position.copy(JZ),QZ.setFromMatrixPosition(e.target.matrixWorld),n.lookAt(QZ),n.updateMatrixWorld(),lH.multiplyMatrices(n.projectionMatrix,n.matrixWorldInverse),this._frustum.setFromProjectionMatrix(lH),i.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),i.multiply(lH)}getViewport(e){return this._viewports[e]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(e){return this.camera=e.camera.clone(),this.intensity=e.intensity,this.bias=e.bias,this.radius=e.radius,this.autoUpdate=e.autoUpdate,this.needsUpdate=e.needsUpdate,this.normalBias=e.normalBias,this.blurSamples=e.blurSamples,this.mapSize.copy(e.mapSize),this}clone(){return new this.constructor().copy(this)}toJSON(){const e={};return this.intensity!==1&&(e.intensity=this.intensity),this.bias!==0&&(e.bias=this.bias),this.normalBias!==0&&(e.normalBias=this.normalBias),this.radius!==1&&(e.radius=this.radius),(this.mapSize.x!==512||this.mapSize.y!==512)&&(e.mapSize=this.mapSize.toArray()),e.camera=this.camera.toJSON(!1).object,delete e.camera.matrix,e}}class eAe extends O7{constructor(){super(new Pc(50,1,.5,500)),this.isSpotLightShadow=!0,this.focus=1}updateMatrices(e){const n=this.camera,i=yC*2*e.angle*this.focus,r=this.mapSize.width/this.mapSize.height,s=e.distance||n.far;(i!==n.fov||r!==n.aspect||s!==n.far)&&(n.fov=i,n.aspect=r,n.far=s,n.updateProjectionMatrix()),super.updateMatrices(e)}copy(e){return super.copy(e),this.focus=e.focus,this}}class yle extends pE{constructor(e,n,i=0,r=Math.PI/3,s=0,a=2){super(e,n),this.isSpotLight=!0,this.type="SpotLight",this.position.copy(qr.DEFAULT_UP),this.updateMatrix(),this.target=new qr,this.distance=i,this.angle=r,this.penumbra=s,this.decay=a,this.map=null,this.shadow=new eAe}get power(){return this.intensity*Math.PI}set power(e){this.intensity=e/Math.PI}dispose(){this.shadow.dispose()}copy(e,n){return super.copy(e,n),this.distance=e.distance,this.angle=e.angle,this.penumbra=e.penumbra,this.decay=e.decay,this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}const eJ=new Ni,wR=new Ae,uH=new Ae;class tAe extends O7{constructor(){super(new Pc(90,1,.5,500)),this.isPointLightShadow=!0,this._frameExtents=new Rt(4,2),this._viewportCount=6,this._viewports=[new Zr(2,1,1,1),new Zr(0,1,1,1),new Zr(3,1,1,1),new Zr(1,1,1,1),new Zr(3,0,1,1),new Zr(1,0,1,1)],this._cubeDirections=[new Ae(1,0,0),new Ae(-1,0,0),new Ae(0,0,1),new Ae(0,0,-1),new Ae(0,1,0),new Ae(0,-1,0)],this._cubeUps=[new Ae(0,1,0),new Ae(0,1,0),new Ae(0,1,0),new Ae(0,1,0),new Ae(0,0,1),new Ae(0,0,-1)]}updateMatrices(e,n=0){const i=this.camera,r=this.matrix,s=e.distance||i.far;s!==i.far&&(i.far=s,i.updateProjectionMatrix()),wR.setFromMatrixPosition(e.matrixWorld),i.position.copy(wR),uH.copy(i.position),uH.add(this._cubeDirections[n]),i.up.copy(this._cubeUps[n]),i.lookAt(uH),i.updateMatrixWorld(),r.makeTranslation(-wR.x,-wR.y,-wR.z),eJ.multiplyMatrices(i.projectionMatrix,i.matrixWorldInverse),this._frustum.setFromProjectionMatrix(eJ)}}class ble extends pE{constructor(e,n,i=0,r=2){super(e,n),this.isPointLight=!0,this.type="PointLight",this.distance=i,this.decay=r,this.shadow=new tAe}get power(){return this.intensity*4*Math.PI}set power(e){this.intensity=e/(4*Math.PI)}dispose(){this.shadow.dispose()}copy(e,n){return super.copy(e,n),this.distance=e.distance,this.decay=e.decay,this.shadow=e.shadow.clone(),this}}let hI=class extends iI{constructor(e=-1,n=1,i=1,r=-1,s=.1,a=2e3){super(),this.isOrthographicCamera=!0,this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=e,this.right=n,this.top=i,this.bottom=r,this.near=s,this.far=a,this.updateProjectionMatrix()}copy(e,n){return super.copy(e,n),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=e.view===null?null:Object.assign({},e.view),this}setViewOffset(e,n,i,r,s,a){this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=n,this.view.offsetX=i,this.view.offsetY=r,this.view.width=s,this.view.height=a,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=(this.right-this.left)/(2*this.zoom),n=(this.top-this.bottom)/(2*this.zoom),i=(this.right+this.left)/2,r=(this.top+this.bottom)/2;let s=i-e,a=i+e,o=r+n,c=r-n;if(this.view!==null&&this.view.enabled){const l=(this.right-this.left)/this.view.fullWidth/this.zoom,u=(this.top-this.bottom)/this.view.fullHeight/this.zoom;s+=l*this.view.offsetX,a=s+l*this.view.width,o-=u*this.view.offsetY,c=o-u*this.view.height}this.projectionMatrix.makeOrthographic(s,a,o,c,this.near,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const n=super.toJSON(e);return n.object.zoom=this.zoom,n.object.left=this.left,n.object.right=this.right,n.object.top=this.top,n.object.bottom=this.bottom,n.object.near=this.near,n.object.far=this.far,this.view!==null&&(n.object.view=Object.assign({},this.view)),n}};class nAe extends O7{constructor(){super(new hI(-5,5,5,-5,.5,500)),this.isDirectionalLightShadow=!0}}class Ele extends pE{constructor(e,n){super(e,n),this.isDirectionalLight=!0,this.type="DirectionalLight",this.position.copy(qr.DEFAULT_UP),this.updateMatrix(),this.target=new qr,this.shadow=new nAe}dispose(){this.shadow.dispose()}copy(e){return super.copy(e),this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}class Sle extends pE{constructor(e,n){super(e,n),this.isAmbientLight=!0,this.type="AmbientLight"}}class Tle extends pE{constructor(e,n,i=10,r=10){super(e,n),this.isRectAreaLight=!0,this.type="RectAreaLight",this.width=i,this.height=r}get power(){return this.intensity*this.width*this.height*Math.PI}set power(e){this.intensity=e/(this.width*this.height*Math.PI)}copy(e){return super.copy(e),this.width=e.width,this.height=e.height,this}toJSON(e){const n=super.toJSON(e);return n.object.width=this.width,n.object.height=this.height,n}}class xle{constructor(){this.isSphericalHarmonics3=!0,this.coefficients=[];for(let e=0;e<9;e++)this.coefficients.push(new Ae)}set(e){for(let n=0;n<9;n++)this.coefficients[n].copy(e[n]);return this}zero(){for(let e=0;e<9;e++)this.coefficients[e].set(0,0,0);return this}getAt(e,n){const i=e.x,r=e.y,s=e.z,a=this.coefficients;return n.copy(a[0]).multiplyScalar(.282095),n.addScaledVector(a[1],.488603*r),n.addScaledVector(a[2],.488603*s),n.addScaledVector(a[3],.488603*i),n.addScaledVector(a[4],1.092548*(i*r)),n.addScaledVector(a[5],1.092548*(r*s)),n.addScaledVector(a[6],.315392*(3*s*s-1)),n.addScaledVector(a[7],1.092548*(i*s)),n.addScaledVector(a[8],.546274*(i*i-r*r)),n}getIrradianceAt(e,n){const i=e.x,r=e.y,s=e.z,a=this.coefficients;return n.copy(a[0]).multiplyScalar(.886227),n.addScaledVector(a[1],2*.511664*r),n.addScaledVector(a[2],2*.511664*s),n.addScaledVector(a[3],2*.511664*i),n.addScaledVector(a[4],2*.429043*i*r),n.addScaledVector(a[5],2*.429043*r*s),n.addScaledVector(a[6],.743125*s*s-.247708),n.addScaledVector(a[7],2*.429043*i*s),n.addScaledVector(a[8],.429043*(i*i-r*r)),n}add(e){for(let n=0;n<9;n++)this.coefficients[n].add(e.coefficients[n]);return this}addScaledSH(e,n){for(let i=0;i<9;i++)this.coefficients[i].addScaledVector(e.coefficients[i],n);return this}scale(e){for(let n=0;n<9;n++)this.coefficients[n].multiplyScalar(e);return this}lerp(e,n){for(let i=0;i<9;i++)this.coefficients[i].lerp(e.coefficients[i],n);return this}equals(e){for(let n=0;n<9;n++)if(!this.coefficients[n].equals(e.coefficients[n]))return!1;return!0}copy(e){return this.set(e.coefficients)}clone(){return new this.constructor().copy(this)}fromArray(e,n=0){const i=this.coefficients;for(let r=0;r<9;r++)i[r].fromArray(e,n+r*3);return this}toArray(e=[],n=0){const i=this.coefficients;for(let r=0;r<9;r++)i[r].toArray(e,n+r*3);return e}static getBasisAt(e,n){const i=e.x,r=e.y,s=e.z;n[0]=.282095,n[1]=.488603*r,n[2]=.488603*s,n[3]=.488603*i,n[4]=1.092548*i*r,n[5]=1.092548*r*s,n[6]=.315392*(3*s*s-1),n[7]=1.092548*i*s,n[8]=.546274*(i*i-r*r)}}class wle extends pE{constructor(e=new xle,n=1){super(void 0,n),this.isLightProbe=!0,this.sh=e}copy(e){return super.copy(e),this.sh.copy(e.sh),this}fromJSON(e){return this.intensity=e.intensity,this.sh.fromArray(e.sh),this}toJSON(e){const n=super.toJSON(e);return n.object.sh=this.sh.toArray(),n}}class HB extends df{constructor(e){super(e),this.textures={}}load(e,n,i,r){const s=this,a=new g_(s.manager);a.setPath(s.path),a.setRequestHeader(s.requestHeader),a.setWithCredentials(s.withCredentials),a.load(e,function(o){try{n(s.parse(JSON.parse(o)))}catch(c){r?r(c):console.error(c),s.manager.itemError(e)}},i,r)}parse(e){const n=this.textures;function i(s){return n[s]===void 0&&console.warn("THREE.MaterialLoader: Undefined texture",s),n[s]}const r=this.createMaterialFromType(e.type);if(e.uuid!==void 0&&(r.uuid=e.uuid),e.name!==void 0&&(r.name=e.name),e.color!==void 0&&r.color!==void 0&&r.color.setHex(e.color),e.roughness!==void 0&&(r.roughness=e.roughness),e.metalness!==void 0&&(r.metalness=e.metalness),e.sheen!==void 0&&(r.sheen=e.sheen),e.sheenColor!==void 0&&(r.sheenColor=new yn().setHex(e.sheenColor)),e.sheenRoughness!==void 0&&(r.sheenRoughness=e.sheenRoughness),e.emissive!==void 0&&r.emissive!==void 0&&r.emissive.setHex(e.emissive),e.specular!==void 0&&r.specular!==void 0&&r.specular.setHex(e.specular),e.specularIntensity!==void 0&&(r.specularIntensity=e.specularIntensity),e.specularColor!==void 0&&r.specularColor!==void 0&&r.specularColor.setHex(e.specularColor),e.shininess!==void 0&&(r.shininess=e.shininess),e.clearcoat!==void 0&&(r.clearcoat=e.clearcoat),e.clearcoatRoughness!==void 0&&(r.clearcoatRoughness=e.clearcoatRoughness),e.dispersion!==void 0&&(r.dispersion=e.dispersion),e.iridescence!==void 0&&(r.iridescence=e.iridescence),e.iridescenceIOR!==void 0&&(r.iridescenceIOR=e.iridescenceIOR),e.iridescenceThicknessRange!==void 0&&(r.iridescenceThicknessRange=e.iridescenceThicknessRange),e.transmission!==void 0&&(r.transmission=e.transmission),e.thickness!==void 0&&(r.thickness=e.thickness),e.attenuationDistance!==void 0&&(r.attenuationDistance=e.attenuationDistance),e.attenuationColor!==void 0&&r.attenuationColor!==void 0&&r.attenuationColor.setHex(e.attenuationColor),e.anisotropy!==void 0&&(r.anisotropy=e.anisotropy),e.anisotropyRotation!==void 0&&(r.anisotropyRotation=e.anisotropyRotation),e.fog!==void 0&&(r.fog=e.fog),e.flatShading!==void 0&&(r.flatShading=e.flatShading),e.blending!==void 0&&(r.blending=e.blending),e.combine!==void 0&&(r.combine=e.combine),e.side!==void 0&&(r.side=e.side),e.shadowSide!==void 0&&(r.shadowSide=e.shadowSide),e.opacity!==void 0&&(r.opacity=e.opacity),e.transparent!==void 0&&(r.transparent=e.transparent),e.alphaTest!==void 0&&(r.alphaTest=e.alphaTest),e.alphaHash!==void 0&&(r.alphaHash=e.alphaHash),e.depthFunc!==void 0&&(r.depthFunc=e.depthFunc),e.depthTest!==void 0&&(r.depthTest=e.depthTest),e.depthWrite!==void 0&&(r.depthWrite=e.depthWrite),e.colorWrite!==void 0&&(r.colorWrite=e.colorWrite),e.blendSrc!==void 0&&(r.blendSrc=e.blendSrc),e.blendDst!==void 0&&(r.blendDst=e.blendDst),e.blendEquation!==void 0&&(r.blendEquation=e.blendEquation),e.blendSrcAlpha!==void 0&&(r.blendSrcAlpha=e.blendSrcAlpha),e.blendDstAlpha!==void 0&&(r.blendDstAlpha=e.blendDstAlpha),e.blendEquationAlpha!==void 0&&(r.blendEquationAlpha=e.blendEquationAlpha),e.blendColor!==void 0&&r.blendColor!==void 0&&r.blendColor.setHex(e.blendColor),e.blendAlpha!==void 0&&(r.blendAlpha=e.blendAlpha),e.stencilWriteMask!==void 0&&(r.stencilWriteMask=e.stencilWriteMask),e.stencilFunc!==void 0&&(r.stencilFunc=e.stencilFunc),e.stencilRef!==void 0&&(r.stencilRef=e.stencilRef),e.stencilFuncMask!==void 0&&(r.stencilFuncMask=e.stencilFuncMask),e.stencilFail!==void 0&&(r.stencilFail=e.stencilFail),e.stencilZFail!==void 0&&(r.stencilZFail=e.stencilZFail),e.stencilZPass!==void 0&&(r.stencilZPass=e.stencilZPass),e.stencilWrite!==void 0&&(r.stencilWrite=e.stencilWrite),e.wireframe!==void 0&&(r.wireframe=e.wireframe),e.wireframeLinewidth!==void 0&&(r.wireframeLinewidth=e.wireframeLinewidth),e.wireframeLinecap!==void 0&&(r.wireframeLinecap=e.wireframeLinecap),e.wireframeLinejoin!==void 0&&(r.wireframeLinejoin=e.wireframeLinejoin),e.rotation!==void 0&&(r.rotation=e.rotation),e.linewidth!==void 0&&(r.linewidth=e.linewidth),e.dashSize!==void 0&&(r.dashSize=e.dashSize),e.gapSize!==void 0&&(r.gapSize=e.gapSize),e.scale!==void 0&&(r.scale=e.scale),e.polygonOffset!==void 0&&(r.polygonOffset=e.polygonOffset),e.polygonOffsetFactor!==void 0&&(r.polygonOffsetFactor=e.polygonOffsetFactor),e.polygonOffsetUnits!==void 0&&(r.polygonOffsetUnits=e.polygonOffsetUnits),e.dithering!==void 0&&(r.dithering=e.dithering),e.alphaToCoverage!==void 0&&(r.alphaToCoverage=e.alphaToCoverage),e.premultipliedAlpha!==void 0&&(r.premultipliedAlpha=e.premultipliedAlpha),e.forceSinglePass!==void 0&&(r.forceSinglePass=e.forceSinglePass),e.visible!==void 0&&(r.visible=e.visible),e.toneMapped!==void 0&&(r.toneMapped=e.toneMapped),e.userData!==void 0&&(r.userData=e.userData),e.vertexColors!==void 0&&(typeof e.vertexColors=="number"?r.vertexColors=e.vertexColors>0:r.vertexColors=e.vertexColors),e.uniforms!==void 0)for(const s in e.uniforms){const a=e.uniforms[s];switch(r.uniforms[s]={},a.type){case"t":r.uniforms[s].value=i(a.value);break;case"c":r.uniforms[s].value=new yn().setHex(a.value);break;case"v2":r.uniforms[s].value=new Rt().fromArray(a.value);break;case"v3":r.uniforms[s].value=new Ae().fromArray(a.value);break;case"v4":r.uniforms[s].value=new Zr().fromArray(a.value);break;case"m3":r.uniforms[s].value=new Ji().fromArray(a.value);break;case"m4":r.uniforms[s].value=new Ni().fromArray(a.value);break;default:r.uniforms[s].value=a.value}}if(e.defines!==void 0&&(r.defines=e.defines),e.vertexShader!==void 0&&(r.vertexShader=e.vertexShader),e.fragmentShader!==void 0&&(r.fragmentShader=e.fragmentShader),e.glslVersion!==void 0&&(r.glslVersion=e.glslVersion),e.extensions!==void 0)for(const s in e.extensions)r.extensions[s]=e.extensions[s];if(e.lights!==void 0&&(r.lights=e.lights),e.clipping!==void 0&&(r.clipping=e.clipping),e.size!==void 0&&(r.size=e.size),e.sizeAttenuation!==void 0&&(r.sizeAttenuation=e.sizeAttenuation),e.map!==void 0&&(r.map=i(e.map)),e.matcap!==void 0&&(r.matcap=i(e.matcap)),e.alphaMap!==void 0&&(r.alphaMap=i(e.alphaMap)),e.bumpMap!==void 0&&(r.bumpMap=i(e.bumpMap)),e.bumpScale!==void 0&&(r.bumpScale=e.bumpScale),e.normalMap!==void 0&&(r.normalMap=i(e.normalMap)),e.normalMapType!==void 0&&(r.normalMapType=e.normalMapType),e.normalScale!==void 0){let s=e.normalScale;Array.isArray(s)===!1&&(s=[s,s]),r.normalScale=new Rt().fromArray(s)}return e.displacementMap!==void 0&&(r.displacementMap=i(e.displacementMap)),e.displacementScale!==void 0&&(r.displacementScale=e.displacementScale),e.displacementBias!==void 0&&(r.displacementBias=e.displacementBias),e.roughnessMap!==void 0&&(r.roughnessMap=i(e.roughnessMap)),e.metalnessMap!==void 0&&(r.metalnessMap=i(e.metalnessMap)),e.emissiveMap!==void 0&&(r.emissiveMap=i(e.emissiveMap)),e.emissiveIntensity!==void 0&&(r.emissiveIntensity=e.emissiveIntensity),e.specularMap!==void 0&&(r.specularMap=i(e.specularMap)),e.specularIntensityMap!==void 0&&(r.specularIntensityMap=i(e.specularIntensityMap)),e.specularColorMap!==void 0&&(r.specularColorMap=i(e.specularColorMap)),e.envMap!==void 0&&(r.envMap=i(e.envMap)),e.envMapRotation!==void 0&&r.envMapRotation.fromArray(e.envMapRotation),e.envMapIntensity!==void 0&&(r.envMapIntensity=e.envMapIntensity),e.reflectivity!==void 0&&(r.reflectivity=e.reflectivity),e.refractionRatio!==void 0&&(r.refractionRatio=e.refractionRatio),e.lightMap!==void 0&&(r.lightMap=i(e.lightMap)),e.lightMapIntensity!==void 0&&(r.lightMapIntensity=e.lightMapIntensity),e.aoMap!==void 0&&(r.aoMap=i(e.aoMap)),e.aoMapIntensity!==void 0&&(r.aoMapIntensity=e.aoMapIntensity),e.gradientMap!==void 0&&(r.gradientMap=i(e.gradientMap)),e.clearcoatMap!==void 0&&(r.clearcoatMap=i(e.clearcoatMap)),e.clearcoatRoughnessMap!==void 0&&(r.clearcoatRoughnessMap=i(e.clearcoatRoughnessMap)),e.clearcoatNormalMap!==void 0&&(r.clearcoatNormalMap=i(e.clearcoatNormalMap)),e.clearcoatNormalScale!==void 0&&(r.clearcoatNormalScale=new Rt().fromArray(e.clearcoatNormalScale)),e.iridescenceMap!==void 0&&(r.iridescenceMap=i(e.iridescenceMap)),e.iridescenceThicknessMap!==void 0&&(r.iridescenceThicknessMap=i(e.iridescenceThicknessMap)),e.transmissionMap!==void 0&&(r.transmissionMap=i(e.transmissionMap)),e.thicknessMap!==void 0&&(r.thicknessMap=i(e.thicknessMap)),e.anisotropyMap!==void 0&&(r.anisotropyMap=i(e.anisotropyMap)),e.sheenColorMap!==void 0&&(r.sheenColorMap=i(e.sheenColorMap)),e.sheenRoughnessMap!==void 0&&(r.sheenRoughnessMap=i(e.sheenRoughnessMap)),r}setTextures(e){return this.textures=e,this}createMaterialFromType(e){return HB.createMaterialFromType(e)}static createMaterialFromType(e){const n={ShadowMaterial:rle,SpriteMaterial:d7,RawShaderMaterial:sle,ShaderMaterial:Hc,PointsMaterial:m7,MeshPhysicalMaterial:ale,MeshStandardMaterial:S7,MeshPhongMaterial:ole,MeshToonMaterial:cle,MeshNormalMaterial:T7,MeshLambertMaterial:lle,MeshDepthMaterial:x7,MeshDistanceMaterial:w7,MeshBasicMaterial:fE,MeshMatcapMaterial:ule,LineDashedMaterial:hle,LineBasicMaterial:hh,Material:Tl};return new n[e]}}class EV{static extractUrlBase(e){const n=e.lastIndexOf("/");return n===-1?"./":e.slice(0,n+1)}static resolveURL(e,n){return typeof e!="string"||e===""?"":(/^https?:\/\//i.test(n)&&/^\//.test(e)&&(n=n.replace(/(^https?:\/\/[^\/]+).*/i,"$1")),/^(https?:)?\/\//i.test(e)||/^data:.*,.*$/i.test(e)||/^blob:.*$/i.test(e)?e:n+e)}}class Cle extends Qi{constructor(){super(),this.isInstancedBufferGeometry=!0,this.type="InstancedBufferGeometry",this.instanceCount=1/0}copy(e){return super.copy(e),this.instanceCount=e.instanceCount,this}toJSON(){const e=super.toJSON();return e.instanceCount=this.instanceCount,e.isInstancedBufferGeometry=!0,e}}class Ale extends df{constructor(e){super(e)}load(e,n,i,r){const s=this,a=new g_(s.manager);a.setPath(s.path),a.setRequestHeader(s.requestHeader),a.setWithCredentials(s.withCredentials),a.load(e,function(o){try{n(s.parse(JSON.parse(o)))}catch(c){r?r(c):console.error(c),s.manager.itemError(e)}},i,r)}parse(e){const n={},i={};function r(d,p){if(n[p]!==void 0)return n[p];const y=d.interleavedBuffers[p],v=s(d,y.buffer),b=dw(y.type,v),T=new xB(b,y.stride);return T.uuid=y.uuid,n[p]=T,T}function s(d,p){if(i[p]!==void 0)return i[p];const y=d.arrayBuffers[p],v=new Uint32Array(y).buffer;return i[p]=v,v}const a=e.isInstancedBufferGeometry?new Cle:new Qi,o=e.data.index;if(o!==void 0){const d=dw(o.type,o.array);a.setIndex(new rr(d,1))}const c=e.data.attributes;for(const d in c){const p=c[d];let g;if(p.isInterleavedBufferAttribute){const y=r(e.data,p.data);g=new DT(y,p.itemSize,p.offset,p.normalized)}else{const y=dw(p.type,p.array),v=p.isInstancedBufferAttribute?TC:rr;g=new v(y,p.itemSize,p.normalized)}p.name!==void 0&&(g.name=p.name),p.usage!==void 0&&g.setUsage(p.usage),a.setAttribute(d,g)}const l=e.data.morphAttributes;if(l)for(const d in l){const p=l[d],g=[];for(let y=0,v=p.length;y<v;y++){const b=p[y];let T;if(b.isInterleavedBufferAttribute){const x=r(e.data,b.data);T=new DT(x,b.itemSize,b.offset,b.normalized)}else{const x=dw(b.type,b.array);T=new rr(x,b.itemSize,b.normalized)}b.name!==void 0&&(T.name=b.name),g.push(T)}a.morphAttributes[d]=g}e.data.morphTargetsRelative&&(a.morphTargetsRelative=!0);const h=e.data.groups||e.data.drawcalls||e.data.offsets;if(h!==void 0)for(let d=0,p=h.length;d!==p;++d){const g=h[d];a.addGroup(g.start,g.count,g.materialIndex)}const f=e.data.boundingSphere;if(f!==void 0){const d=new Ae;f.center!==void 0&&d.fromArray(f.center),a.boundingSphere=new zl(d,f.radius)}return e.name&&(a.name=e.name),e.userData&&(a.userData=e.userData),a}}class iAe extends df{constructor(e){super(e)}load(e,n,i,r){const s=this,a=this.path===""?EV.extractUrlBase(e):this.path;this.resourcePath=this.resourcePath||a;const o=new g_(this.manager);o.setPath(this.path),o.setRequestHeader(this.requestHeader),o.setWithCredentials(this.withCredentials),o.load(e,function(c){let l=null;try{l=JSON.parse(c)}catch(h){r!==void 0&&r(h),console.error("THREE:ObjectLoader: Can't parse "+e+".",h.message);return}const u=l.metadata;if(u===void 0||u.type===void 0||u.type.toLowerCase()==="geometry"){r!==void 0&&r(new Error("THREE.ObjectLoader: Can't load "+e)),console.error("THREE.ObjectLoader: Can't load "+e);return}s.parse(l,n)},i,r)}async loadAsync(e,n){const i=this,r=this.path===""?EV.extractUrlBase(e):this.path;this.resourcePath=this.resourcePath||r;const s=new g_(this.manager);s.setPath(this.path),s.setRequestHeader(this.requestHeader),s.setWithCredentials(this.withCredentials);const a=await s.loadAsync(e,n),o=JSON.parse(a),c=o.metadata;if(c===void 0||c.type===void 0||c.type.toLowerCase()==="geometry")throw new Error("THREE.ObjectLoader: Can't load "+e);return await i.parseAsync(o)}parse(e,n){const i=this.parseAnimations(e.animations),r=this.parseShapes(e.shapes),s=this.parseGeometries(e.geometries,r),a=this.parseImages(e.images,function(){n!==void 0&&n(l)}),o=this.parseTextures(e.textures,a),c=this.parseMaterials(e.materials,o),l=this.parseObject(e.object,s,c,o,i),u=this.parseSkeletons(e.skeletons,l);if(this.bindSkeletons(l,u),this.bindLightTargets(l),n!==void 0){let h=!1;for(const f in a)if(a[f].data instanceof HTMLImageElement){h=!0;break}h===!1&&n(l)}return l}async parseAsync(e){const n=this.parseAnimations(e.animations),i=this.parseShapes(e.shapes),r=this.parseGeometries(e.geometries,i),s=await this.parseImagesAsync(e.images),a=this.parseTextures(e.textures,s),o=this.parseMaterials(e.materials,a),c=this.parseObject(e.object,r,o,a,n),l=this.parseSkeletons(e.skeletons,c);return this.bindSkeletons(c,l),this.bindLightTargets(c),c}parseShapes(e){const n={};if(e!==void 0)for(let i=0,r=e.length;i<r;i++){const s=new gT().fromJSON(e[i]);n[s.uuid]=s}return n}parseSkeletons(e,n){const i={},r={};if(n.traverse(function(s){s.isBone&&(r[s.uuid]=s)}),e!==void 0)for(let s=0,a=e.length;s<a;s++){const o=new wB().fromJSON(e[s],r);i[o.uuid]=o}return i}parseGeometries(e,n){const i={};if(e!==void 0){const r=new Ale;for(let s=0,a=e.length;s<a;s++){let o;const c=e[s];switch(c.type){case"BufferGeometry":case"InstancedBufferGeometry":o=r.parse(c);break;default:c.type in ZZ?o=ZZ[c.type].fromJSON(c,n):console.warn(`THREE.ObjectLoader: Unsupported geometry type "${c.type}"`)}o.uuid=c.uuid,c.name!==void 0&&(o.name=c.name),c.userData!==void 0&&(o.userData=c.userData),i[c.uuid]=o}}return i}parseMaterials(e,n){const i={},r={};if(e!==void 0){const s=new HB;s.setTextures(n);for(let a=0,o=e.length;a<o;a++){const c=e[a];i[c.uuid]===void 0&&(i[c.uuid]=s.parse(c)),r[c.uuid]=i[c.uuid]}}return r}parseAnimations(e){const n={};if(e!==void 0)for(let i=0;i<e.length;i++){const r=e[i],s=xO.parse(r);n[s.uuid]=s}return n}parseImages(e,n){const i=this,r={};let s;function a(c){return i.manager.itemStart(c),s.load(c,function(){i.manager.itemEnd(c)},void 0,function(){i.manager.itemError(c),i.manager.itemEnd(c)})}function o(c){if(typeof c=="string"){const l=c,u=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(l)?l:i.resourcePath+l;return a(u)}else return c.data?{data:dw(c.type,c.data),width:c.width,height:c.height}:null}if(e!==void 0&&e.length>0){const c=new M7(n);s=new wO(c),s.setCrossOrigin(this.crossOrigin);for(let l=0,u=e.length;l<u;l++){const h=e[l],f=h.url;if(Array.isArray(f)){const d=[];for(let p=0,g=f.length;p<g;p++){const y=f[p],v=o(y);v!==null&&(v instanceof HTMLImageElement?d.push(v):d.push(new up(v.data,v.width,v.height)))}r[h.uuid]=new ub(d)}else{const d=o(h.url);r[h.uuid]=new ub(d)}}}return r}async parseImagesAsync(e){const n=this,i={};let r;async function s(a){if(typeof a=="string"){const o=a,c=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(o)?o:n.resourcePath+o;return await r.loadAsync(c)}else return a.data?{data:dw(a.type,a.data),width:a.width,height:a.height}:null}if(e!==void 0&&e.length>0){r=new wO(this.manager),r.setCrossOrigin(this.crossOrigin);for(let a=0,o=e.length;a<o;a++){const c=e[a],l=c.url;if(Array.isArray(l)){const u=[];for(let h=0,f=l.length;h<f;h++){const d=l[h],p=await s(d);p!==null&&(p instanceof HTMLImageElement?u.push(p):u.push(new up(p.data,p.width,p.height)))}i[c.uuid]=new ub(u)}else{const u=await s(c.url);i[c.uuid]=new ub(u)}}}return i}parseTextures(e,n){function i(s,a){return typeof s=="number"?s:(console.warn("THREE.ObjectLoader.parseTexture: Constant should be in numeric form.",s),a[s])}const r={};if(e!==void 0)for(let s=0,a=e.length;s<a;s++){const o=e[s];o.image===void 0&&console.warn('THREE.ObjectLoader: No "image" specified for',o.uuid),n[o.image]===void 0&&console.warn("THREE.ObjectLoader: Undefined image",o.image);const c=n[o.image],l=c.data;let u;Array.isArray(l)?(u=new rI,l.length===6&&(u.needsUpdate=!0)):(l&&l.data?u=new up:u=new Ba,l&&(u.needsUpdate=!0)),u.source=c,u.uuid=o.uuid,o.name!==void 0&&(u.name=o.name),o.mapping!==void 0&&(u.mapping=i(o.mapping,rAe)),o.channel!==void 0&&(u.channel=o.channel),o.offset!==void 0&&u.offset.fromArray(o.offset),o.repeat!==void 0&&u.repeat.fromArray(o.repeat),o.center!==void 0&&u.center.fromArray(o.center),o.rotation!==void 0&&(u.rotation=o.rotation),o.wrap!==void 0&&(u.wrapS=i(o.wrap[0],tJ),u.wrapT=i(o.wrap[1],tJ)),o.format!==void 0&&(u.format=o.format),o.internalFormat!==void 0&&(u.internalFormat=o.internalFormat),o.type!==void 0&&(u.type=o.type),o.colorSpace!==void 0&&(u.colorSpace=o.colorSpace),o.minFilter!==void 0&&(u.minFilter=i(o.minFilter,nJ)),o.magFilter!==void 0&&(u.magFilter=i(o.magFilter,nJ)),o.anisotropy!==void 0&&(u.anisotropy=o.anisotropy),o.flipY!==void 0&&(u.flipY=o.flipY),o.generateMipmaps!==void 0&&(u.generateMipmaps=o.generateMipmaps),o.premultiplyAlpha!==void 0&&(u.premultiplyAlpha=o.premultiplyAlpha),o.unpackAlignment!==void 0&&(u.unpackAlignment=o.unpackAlignment),o.compareFunction!==void 0&&(u.compareFunction=o.compareFunction),o.userData!==void 0&&(u.userData=o.userData),r[o.uuid]=u}return r}parseObject(e,n,i,r,s){let a;function o(f){return n[f]===void 0&&console.warn("THREE.ObjectLoader: Undefined geometry",f),n[f]}function c(f){if(f!==void 0){if(Array.isArray(f)){const d=[];for(let p=0,g=f.length;p<g;p++){const y=f[p];i[y]===void 0&&console.warn("THREE.ObjectLoader: Undefined material",y),d.push(i[y])}return d}return i[f]===void 0&&console.warn("THREE.ObjectLoader: Undefined material",f),i[f]}}function l(f){return r[f]===void 0&&console.warn("THREE.ObjectLoader: Undefined texture",f),r[f]}let u,h;switch(e.type){case"Scene":a=new SC,e.background!==void 0&&(Number.isInteger(e.background)?a.background=new yn(e.background):a.background=l(e.background)),e.environment!==void 0&&(a.environment=l(e.environment)),e.fog!==void 0&&(e.fog.type==="Fog"?a.fog=new TB(e.fog.color,e.fog.near,e.fog.far):e.fog.type==="FogExp2"&&(a.fog=new SB(e.fog.color,e.fog.density)),e.fog.name!==""&&(a.fog.name=e.fog.name)),e.backgroundBlurriness!==void 0&&(a.backgroundBlurriness=e.backgroundBlurriness),e.backgroundIntensity!==void 0&&(a.backgroundIntensity=e.backgroundIntensity),e.backgroundRotation!==void 0&&a.backgroundRotation.fromArray(e.backgroundRotation),e.environmentIntensity!==void 0&&(a.environmentIntensity=e.environmentIntensity),e.environmentRotation!==void 0&&a.environmentRotation.fromArray(e.environmentRotation);break;case"PerspectiveCamera":a=new Pc(e.fov,e.aspect,e.near,e.far),e.focus!==void 0&&(a.focus=e.focus),e.zoom!==void 0&&(a.zoom=e.zoom),e.filmGauge!==void 0&&(a.filmGauge=e.filmGauge),e.filmOffset!==void 0&&(a.filmOffset=e.filmOffset),e.view!==void 0&&(a.view=Object.assign({},e.view));break;case"OrthographicCamera":a=new hI(e.left,e.right,e.top,e.bottom,e.near,e.far),e.zoom!==void 0&&(a.zoom=e.zoom),e.view!==void 0&&(a.view=Object.assign({},e.view));break;case"AmbientLight":a=new Sle(e.color,e.intensity);break;case"DirectionalLight":a=new Ele(e.color,e.intensity),a.target=e.target||"";break;case"PointLight":a=new ble(e.color,e.intensity,e.distance,e.decay);break;case"RectAreaLight":a=new Tle(e.color,e.intensity,e.width,e.height);break;case"SpotLight":a=new yle(e.color,e.intensity,e.distance,e.angle,e.penumbra,e.decay),a.target=e.target||"";break;case"HemisphereLight":a=new _le(e.color,e.groundColor,e.intensity);break;case"LightProbe":a=new wle().fromJSON(e);break;case"SkinnedMesh":u=o(e.geometry),h=c(e.material),a=new zce(u,h),e.bindMode!==void 0&&(a.bindMode=e.bindMode),e.bindMatrix!==void 0&&a.bindMatrix.fromArray(e.bindMatrix),e.skeleton!==void 0&&(a.skeleton=e.skeleton);break;case"Mesh":u=o(e.geometry),h=c(e.material),a=new jo(u,h);break;case"InstancedMesh":u=o(e.geometry),h=c(e.material);const f=e.count,d=e.instanceMatrix,p=e.instanceColor;a=new Hce(u,h,f),a.instanceMatrix=new TC(new Float32Array(d.array),16),p!==void 0&&(a.instanceColor=new TC(new Float32Array(p.array),p.itemSize));break;case"BatchedMesh":u=o(e.geometry),h=c(e.material),a=new jce(e.maxInstanceCount,e.maxVertexCount,e.maxIndexCount,h),a.geometry=u,a.perObjectFrustumCulled=e.perObjectFrustumCulled,a.sortObjects=e.sortObjects,a._drawRanges=e.drawRanges,a._reservedRanges=e.reservedRanges,a._geometryInfo=e.geometryInfo.map(g=>{let y=null,v=null;return g.boundingBox!==void 0&&(y=new gu,y.min.fromArray(g.boundingBox.min),y.max.fromArray(g.boundingBox.max)),g.boundingSphere!==void 0&&(v=new zl,v.radius=g.boundingSphere.radius,v.center.fromArray(g.boundingSphere.center)),{...g,boundingBox:y,boundingSphere:v}}),a._instanceInfo=e.instanceInfo,a._availableInstanceIds=e._availableInstanceIds,a._availableGeometryIds=e._availableGeometryIds,a._nextIndexStart=e.nextIndexStart,a._nextVertexStart=e.nextVertexStart,a._geometryCount=e.geometryCount,a._maxInstanceCount=e.maxInstanceCount,a._maxVertexCount=e.maxVertexCount,a._maxIndexCount=e.maxIndexCount,a._geometryInitialized=e.geometryInitialized,a._matricesTexture=l(e.matricesTexture.uuid),a._indirectTexture=l(e.indirectTexture.uuid),e.colorsTexture!==void 0&&(a._colorsTexture=l(e.colorsTexture.uuid)),e.boundingSphere!==void 0&&(a.boundingSphere=new zl,a.boundingSphere.center.fromArray(e.boundingSphere.center),a.boundingSphere.radius=e.boundingSphere.radius),e.boundingBox!==void 0&&(a.boundingBox=new gu,a.boundingBox.min.fromArray(e.boundingBox.min),a.boundingBox.max.fromArray(e.boundingBox.max));break;case"LOD":a=new Fce;break;case"Line":a=new Gb(o(e.geometry),c(e.material));break;case"LineLoop":a=new Vce(o(e.geometry),c(e.material));break;case"LineSegments":a=new h0(o(e.geometry),c(e.material));break;case"PointCloud":case"Points":a=new Gce(o(e.geometry),c(e.material));break;case"Sprite":a=new Bce(c(e.material));break;case"Group":a=new pw;break;case"Bone":a=new p7;break;default:a=new qr}if(a.uuid=e.uuid,e.name!==void 0&&(a.name=e.name),e.matrix!==void 0?(a.matrix.fromArray(e.matrix),e.matrixAutoUpdate!==void 0&&(a.matrixAutoUpdate=e.matrixAutoUpdate),a.matrixAutoUpdate&&a.matrix.decompose(a.position,a.quaternion,a.scale)):(e.position!==void 0&&a.position.fromArray(e.position),e.rotation!==void 0&&a.rotation.fromArray(e.rotation),e.quaternion!==void 0&&a.quaternion.fromArray(e.quaternion),e.scale!==void 0&&a.scale.fromArray(e.scale)),e.up!==void 0&&a.up.fromArray(e.up),e.castShadow!==void 0&&(a.castShadow=e.castShadow),e.receiveShadow!==void 0&&(a.receiveShadow=e.receiveShadow),e.shadow&&(e.shadow.intensity!==void 0&&(a.shadow.intensity=e.shadow.intensity),e.shadow.bias!==void 0&&(a.shadow.bias=e.shadow.bias),e.shadow.normalBias!==void 0&&(a.shadow.normalBias=e.shadow.normalBias),e.shadow.radius!==void 0&&(a.shadow.radius=e.shadow.radius),e.shadow.mapSize!==void 0&&a.shadow.mapSize.fromArray(e.shadow.mapSize),e.shadow.camera!==void 0&&(a.shadow.camera=this.parseObject(e.shadow.camera))),e.visible!==void 0&&(a.visible=e.visible),e.frustumCulled!==void 0&&(a.frustumCulled=e.frustumCulled),e.renderOrder!==void 0&&(a.renderOrder=e.renderOrder),e.userData!==void 0&&(a.userData=e.userData),e.layers!==void 0&&(a.layers.mask=e.layers),e.children!==void 0){const f=e.children;for(let d=0;d<f.length;d++)a.add(this.parseObject(f[d],n,i,r,s))}if(e.animations!==void 0){const f=e.animations;for(let d=0;d<f.length;d++){const p=f[d];a.animations.push(s[p])}}if(e.type==="LOD"){e.autoUpdate!==void 0&&(a.autoUpdate=e.autoUpdate);const f=e.levels;for(let d=0;d<f.length;d++){const p=f[d],g=a.getObjectByProperty("uuid",p.object);g!==void 0&&a.addLevel(g,p.distance,p.hysteresis)}}return a}bindSkeletons(e,n){Object.keys(n).length!==0&&e.traverse(function(i){if(i.isSkinnedMesh===!0&&i.skeleton!==void 0){const r=n[i.skeleton];r===void 0?console.warn("THREE.ObjectLoader: No skeleton found with UUID:",i.skeleton):i.bind(r,i.bindMatrix)}})}bindLightTargets(e){e.traverse(function(n){if(n.isDirectionalLight||n.isSpotLight){const i=n.target,r=e.getObjectByProperty("uuid",i);r!==void 0?n.target=r:n.target=new qr}})}}const rAe={UVMapping:dB,CubeReflectionMapping:m_,CubeRefractionMapping:Vb,EquirectangularReflectionMapping:lO,EquirectangularRefractionMapping:uO,CubeUVReflectionMapping:vA},tJ={RepeatWrapping:hO,ClampToEdgeWrapping:np,MirroredRepeatWrapping:fO},nJ={NearestFilter:eo,NearestMipmapNearestFilter:e7,NearestMipmapLinearFilter:fw,LinearFilter:Ea,LinearMipmapNearestFilter:_M,LinearMipmapLinearFilter:Ig};class sAe extends df{constructor(e){super(e),this.isImageBitmapLoader=!0,typeof createImageBitmap>"u"&&console.warn("THREE.ImageBitmapLoader: createImageBitmap() not supported."),typeof fetch>"u"&&console.warn("THREE.ImageBitmapLoader: fetch() not supported."),this.options={premultiplyAlpha:"none"}}setOptions(e){return this.options=e,this}load(e,n,i,r){e===void 0&&(e=""),this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);const s=this,a=Kv.get(e);if(a!==void 0){if(s.manager.itemStart(e),a.then){a.then(l=>{n&&n(l),s.manager.itemEnd(e)}).catch(l=>{r&&r(l)});return}return setTimeout(function(){n&&n(a),s.manager.itemEnd(e)},0),a}const o={};o.credentials=this.crossOrigin==="anonymous"?"same-origin":"include",o.headers=this.requestHeader;const c=fetch(e,o).then(function(l){return l.blob()}).then(function(l){return createImageBitmap(l,Object.assign(s.options,{colorSpaceConversion:"none"}))}).then(function(l){return Kv.add(e,l),n&&n(l),s.manager.itemEnd(e),l}).catch(function(l){r&&r(l),Kv.remove(e),s.manager.itemError(e),s.manager.itemEnd(e)});Kv.add(e,c),s.manager.itemStart(e)}}let CD,N7=class{static getContext(){return CD===void 0&&(CD=new(window.AudioContext||window.webkitAudioContext)),CD}static setContext(e){CD=e}};class aAe extends df{constructor(e){super(e)}load(e,n,i,r){const s=this,a=new g_(this.manager);a.setResponseType("arraybuffer"),a.setPath(this.path),a.setRequestHeader(this.requestHeader),a.setWithCredentials(this.withCredentials),a.load(e,function(c){try{const l=c.slice(0);N7.getContext().decodeAudioData(l,function(h){n(h)}).catch(o)}catch(l){o(l)}},i,r);function o(c){r?r(c):console.error(c),s.manager.itemError(e)}}}const iJ=new Ni,rJ=new Ni,TS=new Ni;class oAe{constructor(){this.type="StereoCamera",this.aspect=1,this.eyeSep=.064,this.cameraL=new Pc,this.cameraL.layers.enable(1),this.cameraL.matrixAutoUpdate=!1,this.cameraR=new Pc,this.cameraR.layers.enable(2),this.cameraR.matrixAutoUpdate=!1,this._cache={focus:null,fov:null,aspect:null,near:null,far:null,zoom:null,eyeSep:null}}update(e){const n=this._cache;if(n.focus!==e.focus||n.fov!==e.fov||n.aspect!==e.aspect*this.aspect||n.near!==e.near||n.far!==e.far||n.zoom!==e.zoom||n.eyeSep!==this.eyeSep){n.focus=e.focus,n.fov=e.fov,n.aspect=e.aspect*this.aspect,n.near=e.near,n.far=e.far,n.zoom=e.zoom,n.eyeSep=this.eyeSep,TS.copy(e.projectionMatrix);const r=n.eyeSep/2,s=r*n.near/n.focus,a=n.near*Math.tan(mT*n.fov*.5)/n.zoom;let o,c;rJ.elements[12]=-r,iJ.elements[12]=r,o=-a*n.aspect+s,c=a*n.aspect+s,TS.elements[0]=2*n.near/(c-o),TS.elements[8]=(c+o)/(c-o),this.cameraL.projectionMatrix.copy(TS),o=-a*n.aspect-s,c=a*n.aspect-s,TS.elements[0]=2*n.near/(c-o),TS.elements[8]=(c+o)/(c-o),this.cameraR.projectionMatrix.copy(TS)}this.cameraL.matrixWorld.copy(e.matrixWorld).multiply(rJ),this.cameraR.matrixWorld.copy(e.matrixWorld).multiply(iJ)}}class Rle extends Pc{constructor(e=[]){super(),this.isArrayCamera=!0,this.isMultiViewCamera=!1,this.cameras=e}}let I7=class{constructor(e=!0){this.autoStart=e,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}start(){this.startTime=sJ(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0}stop(){this.getElapsedTime(),this.running=!1,this.autoStart=!1}getElapsedTime(){return this.getDelta(),this.elapsedTime}getDelta(){let e=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){const n=sJ();e=(n-this.oldTime)/1e3,this.oldTime=n,this.elapsedTime+=e}return e}};function sJ(){return performance.now()}const xS=new Ae,aJ=new Qh,cAe=new Ae,wS=new Ae;class lAe extends qr{constructor(){super(),this.type="AudioListener",this.context=N7.getContext(),this.gain=this.context.createGain(),this.gain.connect(this.context.destination),this.filter=null,this.timeDelta=0,this._clock=new I7}getInput(){return this.gain}removeFilter(){return this.filter!==null&&(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination),this.gain.connect(this.context.destination),this.filter=null),this}getFilter(){return this.filter}setFilter(e){return this.filter!==null?(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination)):this.gain.disconnect(this.context.destination),this.filter=e,this.gain.connect(this.filter),this.filter.connect(this.context.destination),this}getMasterVolume(){return this.gain.gain.value}setMasterVolume(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this}updateMatrixWorld(e){super.updateMatrixWorld(e);const n=this.context.listener,i=this.up;if(this.timeDelta=this._clock.getDelta(),this.matrixWorld.decompose(xS,aJ,cAe),wS.set(0,0,-1).applyQuaternion(aJ),n.positionX){const r=this.context.currentTime+this.timeDelta;n.positionX.linearRampToValueAtTime(xS.x,r),n.positionY.linearRampToValueAtTime(xS.y,r),n.positionZ.linearRampToValueAtTime(xS.z,r),n.forwardX.linearRampToValueAtTime(wS.x,r),n.forwardY.linearRampToValueAtTime(wS.y,r),n.forwardZ.linearRampToValueAtTime(wS.z,r),n.upX.linearRampToValueAtTime(i.x,r),n.upY.linearRampToValueAtTime(i.y,r),n.upZ.linearRampToValueAtTime(i.z,r)}else n.setPosition(xS.x,xS.y,xS.z),n.setOrientation(wS.x,wS.y,wS.z,i.x,i.y,i.z)}}class Mle extends qr{constructor(e){super(),this.type="Audio",this.listener=e,this.context=e.context,this.gain=this.context.createGain(),this.gain.connect(e.getInput()),this.autoplay=!1,this.buffer=null,this.detune=0,this.loop=!1,this.loopStart=0,this.loopEnd=0,this.offset=0,this.duration=void 0,this.playbackRate=1,this.isPlaying=!1,this.hasPlaybackControl=!0,this.source=null,this.sourceType="empty",this._startedAt=0,this._progress=0,this._connected=!1,this.filters=[]}getOutput(){return this.gain}setNodeSource(e){return this.hasPlaybackControl=!1,this.sourceType="audioNode",this.source=e,this.connect(),this}setMediaElementSource(e){return this.hasPlaybackControl=!1,this.sourceType="mediaNode",this.source=this.context.createMediaElementSource(e),this.connect(),this}setMediaStreamSource(e){return this.hasPlaybackControl=!1,this.sourceType="mediaStreamNode",this.source=this.context.createMediaStreamSource(e),this.connect(),this}setBuffer(e){return this.buffer=e,this.sourceType="buffer",this.autoplay&&this.play(),this}play(e=0){if(this.isPlaying===!0){console.warn("THREE.Audio: Audio is already playing.");return}if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}this._startedAt=this.context.currentTime+e;const n=this.context.createBufferSource();return n.buffer=this.buffer,n.loop=this.loop,n.loopStart=this.loopStart,n.loopEnd=this.loopEnd,n.onended=this.onEnded.bind(this),n.start(this._startedAt,this._progress+this.offset,this.duration),this.isPlaying=!0,this.source=n,this.setDetune(this.detune),this.setPlaybackRate(this.playbackRate),this.connect()}pause(){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.isPlaying===!0&&(this._progress+=Math.max(this.context.currentTime-this._startedAt,0)*this.playbackRate,this.loop===!0&&(this._progress=this._progress%(this.duration||this.buffer.duration)),this.source.stop(),this.source.onended=null,this.isPlaying=!1),this}stop(e=0){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this._progress=0,this.source!==null&&(this.source.stop(this.context.currentTime+e),this.source.onended=null),this.isPlaying=!1,this}connect(){if(this.filters.length>0){this.source.connect(this.filters[0]);for(let e=1,n=this.filters.length;e<n;e++)this.filters[e-1].connect(this.filters[e]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this._connected=!0,this}disconnect(){if(this._connected!==!1){if(this.filters.length>0){this.source.disconnect(this.filters[0]);for(let e=1,n=this.filters.length;e<n;e++)this.filters[e-1].disconnect(this.filters[e]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this._connected=!1,this}}getFilters(){return this.filters}setFilters(e){return e||(e=[]),this._connected===!0?(this.disconnect(),this.filters=e.slice(),this.connect()):this.filters=e.slice(),this}setDetune(e){return this.detune=e,this.isPlaying===!0&&this.source.detune!==void 0&&this.source.detune.setTargetAtTime(this.detune,this.context.currentTime,.01),this}getDetune(){return this.detune}getFilter(){return this.getFilters()[0]}setFilter(e){return this.setFilters(e?[e]:[])}setPlaybackRate(e){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.playbackRate=e,this.isPlaying===!0&&this.source.playbackRate.setTargetAtTime(this.playbackRate,this.context.currentTime,.01),this}getPlaybackRate(){return this.playbackRate}onEnded(){this.isPlaying=!1,this._progress=0}getLoop(){return this.hasPlaybackControl===!1?(console.warn("THREE.Audio: this Audio has no playback control."),!1):this.loop}setLoop(e){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.loop=e,this.isPlaying===!0&&(this.source.loop=this.loop),this}setLoopStart(e){return this.loopStart=e,this}setLoopEnd(e){return this.loopEnd=e,this}getVolume(){return this.gain.gain.value}setVolume(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this}copy(e,n){return super.copy(e,n),e.sourceType!=="buffer"?(console.warn("THREE.Audio: Audio source type cannot be copied."),this):(this.autoplay=e.autoplay,this.buffer=e.buffer,this.detune=e.detune,this.loop=e.loop,this.loopStart=e.loopStart,this.loopEnd=e.loopEnd,this.offset=e.offset,this.duration=e.duration,this.playbackRate=e.playbackRate,this.hasPlaybackControl=e.hasPlaybackControl,this.sourceType=e.sourceType,this.filters=e.filters.slice(),this)}clone(e){return new this.constructor(this.listener).copy(this,e)}}const CS=new Ae,oJ=new Qh,uAe=new Ae,AS=new Ae;class hAe extends Mle{constructor(e){super(e),this.panner=this.context.createPanner(),this.panner.panningModel="HRTF",this.panner.connect(this.gain)}connect(){return super.connect(),this.panner.connect(this.gain),this}disconnect(){return super.disconnect(),this.panner.disconnect(this.gain),this}getOutput(){return this.panner}getRefDistance(){return this.panner.refDistance}setRefDistance(e){return this.panner.refDistance=e,this}getRolloffFactor(){return this.panner.rolloffFactor}setRolloffFactor(e){return this.panner.rolloffFactor=e,this}getDistanceModel(){return this.panner.distanceModel}setDistanceModel(e){return this.panner.distanceModel=e,this}getMaxDistance(){return this.panner.maxDistance}setMaxDistance(e){return this.panner.maxDistance=e,this}setDirectionalCone(e,n,i){return this.panner.coneInnerAngle=e,this.panner.coneOuterAngle=n,this.panner.coneOuterGain=i,this}updateMatrixWorld(e){if(super.updateMatrixWorld(e),this.hasPlaybackControl===!0&&this.isPlaying===!1)return;this.matrixWorld.decompose(CS,oJ,uAe),AS.set(0,0,1).applyQuaternion(oJ);const n=this.panner;if(n.positionX){const i=this.context.currentTime+this.listener.timeDelta;n.positionX.linearRampToValueAtTime(CS.x,i),n.positionY.linearRampToValueAtTime(CS.y,i),n.positionZ.linearRampToValueAtTime(CS.z,i),n.orientationX.linearRampToValueAtTime(AS.x,i),n.orientationY.linearRampToValueAtTime(AS.y,i),n.orientationZ.linearRampToValueAtTime(AS.z,i)}else n.setPosition(CS.x,CS.y,CS.z),n.setOrientation(AS.x,AS.y,AS.z)}}class fAe{constructor(e,n=2048){this.analyser=e.context.createAnalyser(),this.analyser.fftSize=n,this.data=new Uint8Array(this.analyser.frequencyBinCount),e.getOutput().connect(this.analyser)}getFrequencyData(){return this.analyser.getByteFrequencyData(this.data),this.data}getAverageFrequency(){let e=0;const n=this.getFrequencyData();for(let i=0;i<n.length;i++)e+=n[i];return e/n.length}}class Ole{constructor(e,n,i){this.binding=e,this.valueSize=i;let r,s,a;switch(n){case"quaternion":r=this._slerp,s=this._slerpAdditive,a=this._setAdditiveIdentityQuaternion,this.buffer=new Float64Array(i*6),this._workIndex=5;break;case"string":case"bool":r=this._select,s=this._select,a=this._setAdditiveIdentityOther,this.buffer=new Array(i*5);break;default:r=this._lerp,s=this._lerpAdditive,a=this._setAdditiveIdentityNumeric,this.buffer=new Float64Array(i*5)}this._mixBufferRegion=r,this._mixBufferRegionAdditive=s,this._setIdentity=a,this._origIndex=3,this._addIndex=4,this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,this.useCount=0,this.referenceCount=0}accumulate(e,n){const i=this.buffer,r=this.valueSize,s=e*r+r;let a=this.cumulativeWeight;if(a===0){for(let o=0;o!==r;++o)i[s+o]=i[o];a=n}else{a+=n;const o=n/a;this._mixBufferRegion(i,s,0,o,r)}this.cumulativeWeight=a}accumulateAdditive(e){const n=this.buffer,i=this.valueSize,r=i*this._addIndex;this.cumulativeWeightAdditive===0&&this._setIdentity(),this._mixBufferRegionAdditive(n,r,0,e,i),this.cumulativeWeightAdditive+=e}apply(e){const n=this.valueSize,i=this.buffer,r=e*n+n,s=this.cumulativeWeight,a=this.cumulativeWeightAdditive,o=this.binding;if(this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,s<1){const c=n*this._origIndex;this._mixBufferRegion(i,r,c,1-s,n)}a>0&&this._mixBufferRegionAdditive(i,r,this._addIndex*n,1,n);for(let c=n,l=n+n;c!==l;++c)if(i[c]!==i[c+n]){o.setValue(i,r);break}}saveOriginalState(){const e=this.binding,n=this.buffer,i=this.valueSize,r=i*this._origIndex;e.getValue(n,r);for(let s=i,a=r;s!==a;++s)n[s]=n[r+s%i];this._setIdentity(),this.cumulativeWeight=0,this.cumulativeWeightAdditive=0}restoreOriginalState(){const e=this.valueSize*3;this.binding.setValue(this.buffer,e)}_setAdditiveIdentityNumeric(){const e=this._addIndex*this.valueSize,n=e+this.valueSize;for(let i=e;i<n;i++)this.buffer[i]=0}_setAdditiveIdentityQuaternion(){this._setAdditiveIdentityNumeric(),this.buffer[this._addIndex*this.valueSize+3]=1}_setAdditiveIdentityOther(){const e=this._origIndex*this.valueSize,n=this._addIndex*this.valueSize;for(let i=0;i<this.valueSize;i++)this.buffer[n+i]=this.buffer[e+i]}_select(e,n,i,r,s){if(r>=.5)for(let a=0;a!==s;++a)e[n+a]=e[i+a]}_slerp(e,n,i,r){Qh.slerpFlat(e,n,e,n,e,i,r)}_slerpAdditive(e,n,i,r,s){const a=this._workIndex*s;Qh.multiplyQuaternionsFlat(e,a,e,n,e,i),Qh.slerpFlat(e,n,e,n,e,a,r)}_lerp(e,n,i,r,s){const a=1-r;for(let o=0;o!==s;++o){const c=n+o;e[c]=e[c]*a+e[i+o]*r}}_lerpAdditive(e,n,i,r,s){for(let a=0;a!==s;++a){const o=n+a;e[o]=e[o]+e[i+a]*r}}}const k7="\\[\\]\\.:\\/",dAe=new RegExp("["+k7+"]","g"),D7="[^"+k7+"]",pAe="[^"+k7.replace("\\.","")+"]",mAe=/((?:WC+[\/:])*)/.source.replace("WC",D7),gAe=/(WCOD+)?/.source.replace("WCOD",pAe),vAe=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",D7),_Ae=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",D7),yAe=new RegExp("^"+mAe+gAe+vAe+_Ae+"$"),bAe=["material","materials","bones","map"];class EAe{constructor(e,n,i){const r=i||Xr.parseTrackName(n);this._targetGroup=e,this._bindings=e.subscribe_(n,r)}getValue(e,n){this.bind();const i=this._targetGroup.nCachedObjects_,r=this._bindings[i];r!==void 0&&r.getValue(e,n)}setValue(e,n){const i=this._bindings;for(let r=this._targetGroup.nCachedObjects_,s=i.length;r!==s;++r)i[r].setValue(e,n)}bind(){const e=this._bindings;for(let n=this._targetGroup.nCachedObjects_,i=e.length;n!==i;++n)e[n].bind()}unbind(){const e=this._bindings;for(let n=this._targetGroup.nCachedObjects_,i=e.length;n!==i;++n)e[n].unbind()}}class Xr{constructor(e,n,i){this.path=n,this.parsedPath=i||Xr.parseTrackName(n),this.node=Xr.findNode(e,this.parsedPath.nodeName),this.rootNode=e,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}static create(e,n,i){return e&&e.isAnimationObjectGroup?new Xr.Composite(e,n,i):new Xr(e,n,i)}static sanitizeNodeName(e){return e.replace(/\s/g,"_").replace(dAe,"")}static parseTrackName(e){const n=yAe.exec(e);if(n===null)throw new Error("PropertyBinding: Cannot parse trackName: "+e);const i={nodeName:n[2],objectName:n[3],objectIndex:n[4],propertyName:n[5],propertyIndex:n[6]},r=i.nodeName&&i.nodeName.lastIndexOf(".");if(r!==void 0&&r!==-1){const s=i.nodeName.substring(r+1);bAe.indexOf(s)!==-1&&(i.nodeName=i.nodeName.substring(0,r),i.objectName=s)}if(i.propertyName===null||i.propertyName.length===0)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+e);return i}static findNode(e,n){if(n===void 0||n===""||n==="."||n===-1||n===e.name||n===e.uuid)return e;if(e.skeleton){const i=e.skeleton.getBoneByName(n);if(i!==void 0)return i}if(e.children){const i=function(s){for(let a=0;a<s.length;a++){const o=s[a];if(o.name===n||o.uuid===n)return o;const c=i(o.children);if(c)return c}return null},r=i(e.children);if(r)return r}return null}_getValue_unavailable(){}_setValue_unavailable(){}_getValue_direct(e,n){e[n]=this.targetObject[this.propertyName]}_getValue_array(e,n){const i=this.resolvedProperty;for(let r=0,s=i.length;r!==s;++r)e[n++]=i[r]}_getValue_arrayElement(e,n){e[n]=this.resolvedProperty[this.propertyIndex]}_getValue_toArray(e,n){this.resolvedProperty.toArray(e,n)}_setValue_direct(e,n){this.targetObject[this.propertyName]=e[n]}_setValue_direct_setNeedsUpdate(e,n){this.targetObject[this.propertyName]=e[n],this.targetObject.needsUpdate=!0}_setValue_direct_setMatrixWorldNeedsUpdate(e,n){this.targetObject[this.propertyName]=e[n],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_array(e,n){const i=this.resolvedProperty;for(let r=0,s=i.length;r!==s;++r)i[r]=e[n++]}_setValue_array_setNeedsUpdate(e,n){const i=this.resolvedProperty;for(let r=0,s=i.length;r!==s;++r)i[r]=e[n++];this.targetObject.needsUpdate=!0}_setValue_array_setMatrixWorldNeedsUpdate(e,n){const i=this.resolvedProperty;for(let r=0,s=i.length;r!==s;++r)i[r]=e[n++];this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_arrayElement(e,n){this.resolvedProperty[this.propertyIndex]=e[n]}_setValue_arrayElement_setNeedsUpdate(e,n){this.resolvedProperty[this.propertyIndex]=e[n],this.targetObject.needsUpdate=!0}_setValue_arrayElement_setMatrixWorldNeedsUpdate(e,n){this.resolvedProperty[this.propertyIndex]=e[n],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_fromArray(e,n){this.resolvedProperty.fromArray(e,n)}_setValue_fromArray_setNeedsUpdate(e,n){this.resolvedProperty.fromArray(e,n),this.targetObject.needsUpdate=!0}_setValue_fromArray_setMatrixWorldNeedsUpdate(e,n){this.resolvedProperty.fromArray(e,n),this.targetObject.matrixWorldNeedsUpdate=!0}_getValue_unbound(e,n){this.bind(),this.getValue(e,n)}_setValue_unbound(e,n){this.bind(),this.setValue(e,n)}bind(){let e=this.node;const n=this.parsedPath,i=n.objectName,r=n.propertyName;let s=n.propertyIndex;if(e||(e=Xr.findNode(this.rootNode,n.nodeName),this.node=e),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!e){console.warn("THREE.PropertyBinding: No target node found for track: "+this.path+".");return}if(i){let l=n.objectIndex;switch(i){case"materials":if(!e.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!e.material.materials){console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);return}e=e.material.materials;break;case"bones":if(!e.skeleton){console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);return}e=e.skeleton.bones;for(let u=0;u<e.length;u++)if(e[u].name===l){l=u;break}break;case"map":if("map"in e){e=e.map;break}if(!e.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!e.material.map){console.error("THREE.PropertyBinding: Can not bind to material.map as node.material does not have a map.",this);return}e=e.material.map;break;default:if(e[i]===void 0){console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);return}e=e[i]}if(l!==void 0){if(e[l]===void 0){console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,e);return}e=e[l]}}const a=e[r];if(a===void 0){const l=n.nodeName;console.error("THREE.PropertyBinding: Trying to update property for track: "+l+"."+r+" but it wasn't found.",e);return}let o=this.Versioning.None;this.targetObject=e,e.isMaterial===!0?o=this.Versioning.NeedsUpdate:e.isObject3D===!0&&(o=this.Versioning.MatrixWorldNeedsUpdate);let c=this.BindingType.Direct;if(s!==void 0){if(r==="morphTargetInfluences"){if(!e.geometry){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);return}if(!e.geometry.morphAttributes){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);return}e.morphTargetDictionary[s]!==void 0&&(s=e.morphTargetDictionary[s])}c=this.BindingType.ArrayElement,this.resolvedProperty=a,this.propertyIndex=s}else a.fromArray!==void 0&&a.toArray!==void 0?(c=this.BindingType.HasFromToArray,this.resolvedProperty=a):Array.isArray(a)?(c=this.BindingType.EntireArray,this.resolvedProperty=a):this.propertyName=r;this.getValue=this.GetterByBindingType[c],this.setValue=this.SetterByBindingTypeAndVersioning[c][o]}unbind(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}Xr.Composite=EAe;Xr.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3};Xr.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2};Xr.prototype.GetterByBindingType=[Xr.prototype._getValue_direct,Xr.prototype._getValue_array,Xr.prototype._getValue_arrayElement,Xr.prototype._getValue_toArray];Xr.prototype.SetterByBindingTypeAndVersioning=[[Xr.prototype._setValue_direct,Xr.prototype._setValue_direct_setNeedsUpdate,Xr.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[Xr.prototype._setValue_array,Xr.prototype._setValue_array_setNeedsUpdate,Xr.prototype._setValue_array_setMatrixWorldNeedsUpdate],[Xr.prototype._setValue_arrayElement,Xr.prototype._setValue_arrayElement_setNeedsUpdate,Xr.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[Xr.prototype._setValue_fromArray,Xr.prototype._setValue_fromArray_setNeedsUpdate,Xr.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]];class SAe{constructor(){this.isAnimationObjectGroup=!0,this.uuid=ed(),this._objects=Array.prototype.slice.call(arguments),this.nCachedObjects_=0;const e={};this._indicesByUUID=e;for(let i=0,r=arguments.length;i!==r;++i)e[arguments[i].uuid]=i;this._paths=[],this._parsedPaths=[],this._bindings=[],this._bindingsIndicesByPath={};const n=this;this.stats={objects:{get total(){return n._objects.length},get inUse(){return this.total-n.nCachedObjects_}},get bindingsPerObject(){return n._bindings.length}}}add(){const e=this._objects,n=this._indicesByUUID,i=this._paths,r=this._parsedPaths,s=this._bindings,a=s.length;let o,c=e.length,l=this.nCachedObjects_;for(let u=0,h=arguments.length;u!==h;++u){const f=arguments[u],d=f.uuid;let p=n[d];if(p===void 0){p=c++,n[d]=p,e.push(f);for(let g=0,y=a;g!==y;++g)s[g].push(new Xr(f,i[g],r[g]))}else if(p<l){o=e[p];const g=--l,y=e[g];n[y.uuid]=p,e[p]=y,n[d]=g,e[g]=f;for(let v=0,b=a;v!==b;++v){const T=s[v],x=T[g];let M=T[p];T[p]=x,M===void 0&&(M=new Xr(f,i[v],r[v])),T[g]=M}}else e[p]!==o&&console.error("THREE.AnimationObjectGroup: Different objects with the same UUID detected. Clean the caches or recreate your infrastructure when reloading scenes.")}this.nCachedObjects_=l}remove(){const e=this._objects,n=this._indicesByUUID,i=this._bindings,r=i.length;let s=this.nCachedObjects_;for(let a=0,o=arguments.length;a!==o;++a){const c=arguments[a],l=c.uuid,u=n[l];if(u!==void 0&&u>=s){const h=s++,f=e[h];n[f.uuid]=u,e[u]=f,n[l]=h,e[h]=c;for(let d=0,p=r;d!==p;++d){const g=i[d],y=g[h],v=g[u];g[u]=y,g[h]=v}}}this.nCachedObjects_=s}uncache(){const e=this._objects,n=this._indicesByUUID,i=this._bindings,r=i.length;let s=this.nCachedObjects_,a=e.length;for(let o=0,c=arguments.length;o!==c;++o){const l=arguments[o],u=l.uuid,h=n[u];if(h!==void 0)if(delete n[u],h<s){const f=--s,d=e[f],p=--a,g=e[p];n[d.uuid]=h,e[h]=d,n[g.uuid]=f,e[f]=g,e.pop();for(let y=0,v=r;y!==v;++y){const b=i[y],T=b[f],x=b[p];b[h]=T,b[f]=x,b.pop()}}else{const f=--a,d=e[f];f>0&&(n[d.uuid]=h),e[h]=d,e.pop();for(let p=0,g=r;p!==g;++p){const y=i[p];y[h]=y[f],y.pop()}}}this.nCachedObjects_=s}subscribe_(e,n){const i=this._bindingsIndicesByPath;let r=i[e];const s=this._bindings;if(r!==void 0)return s[r];const a=this._paths,o=this._parsedPaths,c=this._objects,l=c.length,u=this.nCachedObjects_,h=new Array(l);r=s.length,i[e]=r,a.push(e),o.push(n),s.push(h);for(let f=u,d=c.length;f!==d;++f){const p=c[f];h[f]=new Xr(p,e,n)}return h}unsubscribe_(e){const n=this._bindingsIndicesByPath,i=n[e];if(i!==void 0){const r=this._paths,s=this._parsedPaths,a=this._bindings,o=a.length-1,c=a[o],l=e[o];n[l]=i,a[i]=c,a.pop(),s[i]=s[o],s.pop(),r[i]=r[o],r.pop()}}}class Nle{constructor(e,n,i=null,r=n.blendMode){this._mixer=e,this._clip=n,this._localRoot=i,this.blendMode=r;const s=n.tracks,a=s.length,o=new Array(a),c={endingStart:rT,endingEnd:rT};for(let l=0;l!==a;++l){const u=s[l].createInterpolant(null);o[l]=u,u.settings=c}this._interpolantSettings=c,this._interpolants=o,this._propertyBindings=new Array(a),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=vce,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}play(){return this._mixer._activateAction(this),this}stop(){return this._mixer._deactivateAction(this),this.reset()}reset(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()}isRunning(){return this.enabled&&!this.paused&&this.timeScale!==0&&this._startTime===null&&this._mixer._isActiveAction(this)}isScheduled(){return this._mixer._isActiveAction(this)}startAt(e){return this._startTime=e,this}setLoop(e,n){return this.loop=e,this.repetitions=n,this}setEffectiveWeight(e){return this.weight=e,this._effectiveWeight=this.enabled?e:0,this.stopFading()}getEffectiveWeight(){return this._effectiveWeight}fadeIn(e){return this._scheduleFading(e,0,1)}fadeOut(e){return this._scheduleFading(e,1,0)}crossFadeFrom(e,n,i=!1){if(e.fadeOut(n),this.fadeIn(n),i===!0){const r=this._clip.duration,s=e._clip.duration,a=s/r,o=r/s;e.warp(1,a,n),this.warp(o,1,n)}return this}crossFadeTo(e,n,i=!1){return e.crossFadeFrom(this,n,i)}stopFading(){const e=this._weightInterpolant;return e!==null&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}setEffectiveTimeScale(e){return this.timeScale=e,this._effectiveTimeScale=this.paused?0:e,this.stopWarping()}getEffectiveTimeScale(){return this._effectiveTimeScale}setDuration(e){return this.timeScale=this._clip.duration/e,this.stopWarping()}syncWith(e){return this.time=e.time,this.timeScale=e.timeScale,this.stopWarping()}halt(e){return this.warp(this._effectiveTimeScale,0,e)}warp(e,n,i){const r=this._mixer,s=r.time,a=this.timeScale;let o=this._timeScaleInterpolant;o===null&&(o=r._lendControlInterpolant(),this._timeScaleInterpolant=o);const c=o.parameterPositions,l=o.sampleValues;return c[0]=s,c[1]=s+i,l[0]=e/a,l[1]=n/a,this}stopWarping(){const e=this._timeScaleInterpolant;return e!==null&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}getMixer(){return this._mixer}getClip(){return this._clip}getRoot(){return this._localRoot||this._mixer._root}_update(e,n,i,r){if(!this.enabled){this._updateWeight(e);return}const s=this._startTime;if(s!==null){const c=(e-s)*i;c<0||i===0?n=0:(this._startTime=null,n=i*c)}n*=this._updateTimeScale(e);const a=this._updateTime(n),o=this._updateWeight(e);if(o>0){const c=this._interpolants,l=this._propertyBindings;switch(this.blendMode){case c7:for(let u=0,h=c.length;u!==h;++u)c[u].evaluate(a),l[u].accumulateAdditive(o);break;case yB:default:for(let u=0,h=c.length;u!==h;++u)c[u].evaluate(a),l[u].accumulate(r,o)}}}_updateWeight(e){let n=0;if(this.enabled){n=this.weight;const i=this._weightInterpolant;if(i!==null){const r=i.evaluate(e)[0];n*=r,e>i.parameterPositions[1]&&(this.stopFading(),r===0&&(this.enabled=!1))}}return this._effectiveWeight=n,n}_updateTimeScale(e){let n=0;if(!this.paused){n=this.timeScale;const i=this._timeScaleInterpolant;if(i!==null){const r=i.evaluate(e)[0];n*=r,e>i.parameterPositions[1]&&(this.stopWarping(),n===0?this.paused=!0:this.timeScale=n)}}return this._effectiveTimeScale=n,n}_updateTime(e){const n=this._clip.duration,i=this.loop;let r=this.time+e,s=this._loopCount;const a=i===_ce;if(e===0)return s===-1?r:a&&(s&1)===1?n-r:r;if(i===gce){s===-1&&(this._loopCount=0,this._setEndings(!0,!0,!1));e:{if(r>=n)r=n;else if(r<0)r=0;else{this.time=r;break e}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=r,this._mixer.dispatchEvent({type:"finished",action:this,direction:e<0?-1:1})}}else{if(s===-1&&(e>=0?(s=0,this._setEndings(!0,this.repetitions===0,a)):this._setEndings(this.repetitions===0,!0,a)),r>=n||r<0){const o=Math.floor(r/n);r-=n*o,s+=Math.abs(o);const c=this.repetitions-s;if(c<=0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,r=e>0?n:0,this.time=r,this._mixer.dispatchEvent({type:"finished",action:this,direction:e>0?1:-1});else{if(c===1){const l=e<0;this._setEndings(l,!l,a)}else this._setEndings(!1,!1,a);this._loopCount=s,this.time=r,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:o})}}else this.time=r;if(a&&(s&1)===1)return n-r}return r}_setEndings(e,n,i){const r=this._interpolantSettings;i?(r.endingStart=sT,r.endingEnd=sT):(e?r.endingStart=this.zeroSlopeAtStart?sT:rT:r.endingStart=pO,n?r.endingEnd=this.zeroSlopeAtEnd?sT:rT:r.endingEnd=pO)}_scheduleFading(e,n,i){const r=this._mixer,s=r.time;let a=this._weightInterpolant;a===null&&(a=r._lendControlInterpolant(),this._weightInterpolant=a);const o=a.parameterPositions,c=a.sampleValues;return o[0]=s,c[0]=n,o[1]=s+e,c[1]=i,this}}const TAe=new Float32Array(1);class xAe extends cd{constructor(e){super(),this._root=e,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1}_bindAction(e,n){const i=e._localRoot||this._root,r=e._clip.tracks,s=r.length,a=e._propertyBindings,o=e._interpolants,c=i.uuid,l=this._bindingsByRootAndName;let u=l[c];u===void 0&&(u={},l[c]=u);for(let h=0;h!==s;++h){const f=r[h],d=f.name;let p=u[d];if(p!==void 0)++p.referenceCount,a[h]=p;else{if(p=a[h],p!==void 0){p._cacheIndex===null&&(++p.referenceCount,this._addInactiveBinding(p,c,d));continue}const g=n&&n._propertyBindings[h].binding.parsedPath;p=new Ole(Xr.create(i,d,g),f.ValueTypeName,f.getValueSize()),++p.referenceCount,this._addInactiveBinding(p,c,d),a[h]=p}o[h].resultBuffer=p.buffer}}_activateAction(e){if(!this._isActiveAction(e)){if(e._cacheIndex===null){const i=(e._localRoot||this._root).uuid,r=e._clip.uuid,s=this._actionsByClip[r];this._bindAction(e,s&&s.knownActions[0]),this._addInactiveAction(e,r,i)}const n=e._propertyBindings;for(let i=0,r=n.length;i!==r;++i){const s=n[i];s.useCount++===0&&(this._lendBinding(s),s.saveOriginalState())}this._lendAction(e)}}_deactivateAction(e){if(this._isActiveAction(e)){const n=e._propertyBindings;for(let i=0,r=n.length;i!==r;++i){const s=n[i];--s.useCount===0&&(s.restoreOriginalState(),this._takeBackBinding(s))}this._takeBackAction(e)}}_initMemoryManager(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;const e=this;this.stats={actions:{get total(){return e._actions.length},get inUse(){return e._nActiveActions}},bindings:{get total(){return e._bindings.length},get inUse(){return e._nActiveBindings}},controlInterpolants:{get total(){return e._controlInterpolants.length},get inUse(){return e._nActiveControlInterpolants}}}}_isActiveAction(e){const n=e._cacheIndex;return n!==null&&n<this._nActiveActions}_addInactiveAction(e,n,i){const r=this._actions,s=this._actionsByClip;let a=s[n];if(a===void 0)a={knownActions:[e],actionByRoot:{}},e._byClipCacheIndex=0,s[n]=a;else{const o=a.knownActions;e._byClipCacheIndex=o.length,o.push(e)}e._cacheIndex=r.length,r.push(e),a.actionByRoot[i]=e}_removeInactiveAction(e){const n=this._actions,i=n[n.length-1],r=e._cacheIndex;i._cacheIndex=r,n[r]=i,n.pop(),e._cacheIndex=null;const s=e._clip.uuid,a=this._actionsByClip,o=a[s],c=o.knownActions,l=c[c.length-1],u=e._byClipCacheIndex;l._byClipCacheIndex=u,c[u]=l,c.pop(),e._byClipCacheIndex=null;const h=o.actionByRoot,f=(e._localRoot||this._root).uuid;delete h[f],c.length===0&&delete a[s],this._removeInactiveBindingsForAction(e)}_removeInactiveBindingsForAction(e){const n=e._propertyBindings;for(let i=0,r=n.length;i!==r;++i){const s=n[i];--s.referenceCount===0&&this._removeInactiveBinding(s)}}_lendAction(e){const n=this._actions,i=e._cacheIndex,r=this._nActiveActions++,s=n[r];e._cacheIndex=r,n[r]=e,s._cacheIndex=i,n[i]=s}_takeBackAction(e){const n=this._actions,i=e._cacheIndex,r=--this._nActiveActions,s=n[r];e._cacheIndex=r,n[r]=e,s._cacheIndex=i,n[i]=s}_addInactiveBinding(e,n,i){const r=this._bindingsByRootAndName,s=this._bindings;let a=r[n];a===void 0&&(a={},r[n]=a),a[i]=e,e._cacheIndex=s.length,s.push(e)}_removeInactiveBinding(e){const n=this._bindings,i=e.binding,r=i.rootNode.uuid,s=i.path,a=this._bindingsByRootAndName,o=a[r],c=n[n.length-1],l=e._cacheIndex;c._cacheIndex=l,n[l]=c,n.pop(),delete o[s],Object.keys(o).length===0&&delete a[r]}_lendBinding(e){const n=this._bindings,i=e._cacheIndex,r=this._nActiveBindings++,s=n[r];e._cacheIndex=r,n[r]=e,s._cacheIndex=i,n[i]=s}_takeBackBinding(e){const n=this._bindings,i=e._cacheIndex,r=--this._nActiveBindings,s=n[r];e._cacheIndex=r,n[r]=e,s._cacheIndex=i,n[i]=s}_lendControlInterpolant(){const e=this._controlInterpolants,n=this._nActiveControlInterpolants++;let i=e[n];return i===void 0&&(i=new A7(new Float32Array(2),new Float32Array(2),1,TAe),i.__cacheIndex=n,e[n]=i),i}_takeBackControlInterpolant(e){const n=this._controlInterpolants,i=e.__cacheIndex,r=--this._nActiveControlInterpolants,s=n[r];e.__cacheIndex=r,n[r]=e,s.__cacheIndex=i,n[i]=s}clipAction(e,n,i){const r=n||this._root,s=r.uuid;let a=typeof e=="string"?xO.findByName(r,e):e;const o=a!==null?a.uuid:e,c=this._actionsByClip[o];let l=null;if(i===void 0&&(a!==null?i=a.blendMode:i=yB),c!==void 0){const h=c.actionByRoot[s];if(h!==void 0&&h.blendMode===i)return h;l=c.knownActions[0],a===null&&(a=l._clip)}if(a===null)return null;const u=new Nle(this,a,n,i);return this._bindAction(u,l),this._addInactiveAction(u,o,s),u}existingAction(e,n){const i=n||this._root,r=i.uuid,s=typeof e=="string"?xO.findByName(i,e):e,a=s?s.uuid:e,o=this._actionsByClip[a];return o!==void 0&&o.actionByRoot[r]||null}stopAllAction(){const e=this._actions,n=this._nActiveActions;for(let i=n-1;i>=0;--i)e[i].stop();return this}update(e){e*=this.timeScale;const n=this._actions,i=this._nActiveActions,r=this.time+=e,s=Math.sign(e),a=this._accuIndex^=1;for(let l=0;l!==i;++l)n[l]._update(r,e,s,a);const o=this._bindings,c=this._nActiveBindings;for(let l=0;l!==c;++l)o[l].apply(a);return this}setTime(e){this.time=0;for(let n=0;n<this._actions.length;n++)this._actions[n].time=0;return this.update(e)}getRoot(){return this._root}uncacheClip(e){const n=this._actions,i=e.uuid,r=this._actionsByClip,s=r[i];if(s!==void 0){const a=s.knownActions;for(let o=0,c=a.length;o!==c;++o){const l=a[o];this._deactivateAction(l);const u=l._cacheIndex,h=n[n.length-1];l._cacheIndex=null,l._byClipCacheIndex=null,h._cacheIndex=u,n[u]=h,n.pop(),this._removeInactiveBindingsForAction(l)}delete r[i]}}uncacheRoot(e){const n=e.uuid,i=this._actionsByClip;for(const a in i){const o=i[a].actionByRoot,c=o[n];c!==void 0&&(this._deactivateAction(c),this._removeInactiveAction(c))}const r=this._bindingsByRootAndName,s=r[n];if(s!==void 0)for(const a in s){const o=s[a];o.restoreOriginalState(),this._removeInactiveBinding(o)}}uncacheAction(e,n){const i=this.existingAction(e,n);i!==null&&(this._deactivateAction(i),this._removeInactiveAction(i))}}class wAe extends bB{constructor(e=1,n=1,i=1,r={}){super(e,n,r),this.isRenderTarget3D=!0,this.depth=i,this.texture=new EB(null,e,n,i),this.texture.isRenderTargetTexture=!0}}class CAe extends bB{constructor(e=1,n=1,i=1,r={}){super(e,n,r),this.isRenderTargetArray=!0,this.depth=i,this.texture=new nI(null,e,n,i),this.texture.isRenderTargetTexture=!0}}class Yi{constructor(e){this.value=e}clone(){return new Yi(this.value.clone===void 0?this.value:this.value.clone())}}let AAe=0;class RAe extends cd{constructor(){super(),this.isUniformsGroup=!0,Object.defineProperty(this,"id",{value:AAe++}),this.name="",this.usage=gO,this.uniforms=[]}add(e){return this.uniforms.push(e),this}remove(e){const n=this.uniforms.indexOf(e);return n!==-1&&this.uniforms.splice(n,1),this}setName(e){return this.name=e,this}setUsage(e){return this.usage=e,this}dispose(){this.dispatchEvent({type:"dispose"})}copy(e){this.name=e.name,this.usage=e.usage;const n=e.uniforms;this.uniforms.length=0;for(let i=0,r=n.length;i<r;i++){const s=Array.isArray(n[i])?n[i]:[n[i]];for(let a=0;a<s.length;a++)this.uniforms.push(s[a].clone())}return this}clone(){return new this.constructor().copy(this)}}class MAe extends xB{constructor(e,n,i=1){super(e,n),this.isInstancedInterleavedBuffer=!0,this.meshPerAttribute=i}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}clone(e){const n=super.clone(e);return n.meshPerAttribute=this.meshPerAttribute,n}toJSON(e){const n=super.toJSON(e);return n.isInstancedInterleavedBuffer=!0,n.meshPerAttribute=this.meshPerAttribute,n}}class OAe{constructor(e,n,i,r,s){this.isGLBufferAttribute=!0,this.name="",this.buffer=e,this.type=n,this.itemSize=i,this.elementSize=r,this.count=s,this.version=0}set needsUpdate(e){e===!0&&this.version++}setBuffer(e){return this.buffer=e,this}setType(e,n){return this.type=e,this.elementSize=n,this}setItemSize(e){return this.itemSize=e,this}setCount(e){return this.count=e,this}}const cJ=new Ni;class P7{constructor(e,n,i=0,r=1/0){this.ray=new _A(e,n),this.near=i,this.far=r,this.camera=null,this.layers=new bC,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}}}set(e,n){this.ray.set(e,n)}setFromCamera(e,n){n.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(n.matrixWorld),this.ray.direction.set(e.x,e.y,.5).unproject(n).sub(this.ray.origin).normalize(),this.camera=n):n.isOrthographicCamera?(this.ray.origin.set(e.x,e.y,(n.near+n.far)/(n.near-n.far)).unproject(n),this.ray.direction.set(0,0,-1).transformDirection(n.matrixWorld),this.camera=n):console.error("THREE.Raycaster: Unsupported camera type: "+n.type)}setFromXRController(e){return cJ.identity().extractRotation(e.matrixWorld),this.ray.origin.setFromMatrixPosition(e.matrixWorld),this.ray.direction.set(0,0,-1).applyMatrix4(cJ),this}intersectObject(e,n=!0,i=[]){return SV(e,this,i,n),i.sort(lJ),i}intersectObjects(e,n=!0,i=[]){for(let r=0,s=e.length;r<s;r++)SV(e[r],this,i,n);return i.sort(lJ),i}}function lJ(t,e){return t.distance-e.distance}function SV(t,e,n,i){let r=!0;if(t.layers.test(e.layers)&&t.raycast(e,n)===!1&&(r=!1),r===!0&&i===!0){const s=t.children;for(let a=0,o=s.length;a<o;a++)SV(s[a],e,n,!0)}}class NAe{constructor(e=1,n=0,i=0){this.radius=e,this.phi=n,this.theta=i}set(e,n,i){return this.radius=e,this.phi=n,this.theta=i,this}copy(e){return this.radius=e.radius,this.phi=e.phi,this.theta=e.theta,this}makeSafe(){return this.phi=Xi(this.phi,1e-6,Math.PI-1e-6),this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,n,i){return this.radius=Math.sqrt(e*e+n*n+i*i),this.radius===0?(this.theta=0,this.phi=0):(this.theta=Math.atan2(e,i),this.phi=Math.acos(Xi(n/this.radius,-1,1))),this}clone(){return new this.constructor().copy(this)}}class IAe{constructor(e=1,n=0,i=0){this.radius=e,this.theta=n,this.y=i}set(e,n,i){return this.radius=e,this.theta=n,this.y=i,this}copy(e){return this.radius=e.radius,this.theta=e.theta,this.y=e.y,this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,n,i){return this.radius=Math.sqrt(e*e+i*i),this.theta=Math.atan2(e,i),this.y=n,this}clone(){return new this.constructor().copy(this)}}class L7{constructor(e,n,i,r){L7.prototype.isMatrix2=!0,this.elements=[1,0,0,1],e!==void 0&&this.set(e,n,i,r)}identity(){return this.set(1,0,0,1),this}fromArray(e,n=0){for(let i=0;i<4;i++)this.elements[i]=e[i+n];return this}set(e,n,i,r){const s=this.elements;return s[0]=e,s[2]=n,s[1]=i,s[3]=r,this}}const uJ=new Rt;class Ile{constructor(e=new Rt(1/0,1/0),n=new Rt(-1/0,-1/0)){this.isBox2=!0,this.min=e,this.max=n}set(e,n){return this.min.copy(e),this.max.copy(n),this}setFromPoints(e){this.makeEmpty();for(let n=0,i=e.length;n<i;n++)this.expandByPoint(e[n]);return this}setFromCenterAndSize(e,n){const i=uJ.copy(n).multiplyScalar(.5);return this.min.copy(e).sub(i),this.max.copy(e).add(i),this}clone(){return new this.constructor().copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y}getCenter(e){return this.isEmpty()?e.set(0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}containsPoint(e){return e.x>=this.min.x&&e.x<=this.max.x&&e.y>=this.min.y&&e.y<=this.max.y}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y}getParameter(e,n){return n.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y))}intersectsBox(e){return e.max.x>=this.min.x&&e.min.x<=this.max.x&&e.max.y>=this.min.y&&e.min.y<=this.max.y}clampPoint(e,n){return n.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return this.clampPoint(e,uJ).distanceTo(e)}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}const hJ=new Ae,AD=new Ae;class kAe{constructor(e=new Ae,n=new Ae){this.start=e,this.end=n}set(e,n){return this.start.copy(e),this.end.copy(n),this}copy(e){return this.start.copy(e.start),this.end.copy(e.end),this}getCenter(e){return e.addVectors(this.start,this.end).multiplyScalar(.5)}delta(e){return e.subVectors(this.end,this.start)}distanceSq(){return this.start.distanceToSquared(this.end)}distance(){return this.start.distanceTo(this.end)}at(e,n){return this.delta(n).multiplyScalar(e).add(this.start)}closestPointToPointParameter(e,n){hJ.subVectors(e,this.start),AD.subVectors(this.end,this.start);const i=AD.dot(AD);let s=AD.dot(hJ)/i;return n&&(s=Xi(s,0,1)),s}closestPointToPoint(e,n,i){const r=this.closestPointToPointParameter(e,n);return this.delta(i).multiplyScalar(r).add(this.start)}applyMatrix4(e){return this.start.applyMatrix4(e),this.end.applyMatrix4(e),this}equals(e){return e.start.equals(this.start)&&e.end.equals(this.end)}clone(){return new this.constructor().copy(this)}}const fJ=new Ae;class DAe extends qr{constructor(e,n){super(),this.light=e,this.matrixAutoUpdate=!1,this.color=n,this.type="SpotLightHelper";const i=new Qi,r=[0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1];for(let a=0,o=1,c=32;a<c;a++,o++){const l=a/c*Math.PI*2,u=o/c*Math.PI*2;r.push(Math.cos(l),Math.sin(l),1,Math.cos(u),Math.sin(u),1)}i.setAttribute("position",new Hn(r,3));const s=new hh({fog:!1,toneMapped:!1});this.cone=new h0(i,s),this.add(this.cone),this.update()}dispose(){this.cone.geometry.dispose(),this.cone.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.light.target.updateWorldMatrix(!0,!1),this.parent?(this.parent.updateWorldMatrix(!0),this.matrix.copy(this.parent.matrixWorld).invert().multiply(this.light.matrixWorld)):this.matrix.copy(this.light.matrixWorld),this.matrixWorld.copy(this.light.matrixWorld);const e=this.light.distance?this.light.distance:1e3,n=e*Math.tan(this.light.angle);this.cone.scale.set(n,n,e),fJ.setFromMatrixPosition(this.light.target.matrixWorld),this.cone.lookAt(fJ),this.color!==void 0?this.cone.material.color.set(this.color):this.cone.material.color.copy(this.light.color)}}const Cy=new Ae,RD=new Ni,hH=new Ni;class PAe extends h0{constructor(e){const n=kle(e),i=new Qi,r=[],s=[],a=new yn(0,0,1),o=new yn(0,1,0);for(let l=0;l<n.length;l++){const u=n[l];u.parent&&u.parent.isBone&&(r.push(0,0,0),r.push(0,0,0),s.push(a.r,a.g,a.b),s.push(o.r,o.g,o.b))}i.setAttribute("position",new Hn(r,3)),i.setAttribute("color",new Hn(s,3));const c=new hh({vertexColors:!0,depthTest:!1,depthWrite:!1,toneMapped:!1,transparent:!0});super(i,c),this.isSkeletonHelper=!0,this.type="SkeletonHelper",this.root=e,this.bones=n,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1}updateMatrixWorld(e){const n=this.bones,i=this.geometry,r=i.getAttribute("position");hH.copy(this.root.matrixWorld).invert();for(let s=0,a=0;s<n.length;s++){const o=n[s];o.parent&&o.parent.isBone&&(RD.multiplyMatrices(hH,o.matrixWorld),Cy.setFromMatrixPosition(RD),r.setXYZ(a,Cy.x,Cy.y,Cy.z),RD.multiplyMatrices(hH,o.parent.matrixWorld),Cy.setFromMatrixPosition(RD),r.setXYZ(a+1,Cy.x,Cy.y,Cy.z),a+=2)}i.getAttribute("position").needsUpdate=!0,super.updateMatrixWorld(e)}dispose(){this.geometry.dispose(),this.material.dispose()}}function kle(t){const e=[];t.isBone===!0&&e.push(t);for(let n=0;n<t.children.length;n++)e.push(...kle(t.children[n]));return e}class LAe extends jo{constructor(e,n,i){const r=new cI(n,4,2),s=new fE({wireframe:!0,fog:!1,toneMapped:!1});super(r,s),this.light=e,this.color=i,this.type="PointLightHelper",this.matrix=this.light.matrixWorld,this.matrixAutoUpdate=!1,this.update()}dispose(){this.geometry.dispose(),this.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.color!==void 0?this.material.color.set(this.color):this.material.color.copy(this.light.color)}}const UAe=new Ae,dJ=new yn,pJ=new yn;class BAe extends qr{constructor(e,n,i){super(),this.light=e,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=i,this.type="HemisphereLightHelper";const r=new oI(n);r.rotateY(Math.PI*.5),this.material=new fE({wireframe:!0,fog:!1,toneMapped:!1}),this.color===void 0&&(this.material.vertexColors=!0);const s=r.getAttribute("position"),a=new Float32Array(s.count*3);r.setAttribute("color",new rr(a,3)),this.add(new jo(r,this.material)),this.update()}dispose(){this.children[0].geometry.dispose(),this.children[0].material.dispose()}update(){const e=this.children[0];if(this.color!==void 0)this.material.color.set(this.color);else{const n=e.geometry.getAttribute("color");dJ.copy(this.light.color),pJ.copy(this.light.groundColor);for(let i=0,r=n.count;i<r;i++){const s=i<r/2?dJ:pJ;n.setXYZ(i,s.r,s.g,s.b)}n.needsUpdate=!0}this.light.updateWorldMatrix(!0,!1),e.lookAt(UAe.setFromMatrixPosition(this.light.matrixWorld).negate())}}class FAe extends h0{constructor(e=10,n=10,i=4473924,r=8947848){i=new yn(i),r=new yn(r);const s=n/2,a=e/n,o=e/2,c=[],l=[];for(let f=0,d=0,p=-o;f<=n;f++,p+=a){c.push(-o,0,p,o,0,p),c.push(p,0,-o,p,0,o);const g=f===s?i:r;g.toArray(l,d),d+=3,g.toArray(l,d),d+=3,g.toArray(l,d),d+=3,g.toArray(l,d),d+=3}const u=new Qi;u.setAttribute("position",new Hn(c,3)),u.setAttribute("color",new Hn(l,3));const h=new hh({vertexColors:!0,toneMapped:!1});super(u,h),this.type="GridHelper"}dispose(){this.geometry.dispose(),this.material.dispose()}}class zAe extends h0{constructor(e=10,n=16,i=8,r=64,s=4473924,a=8947848){s=new yn(s),a=new yn(a);const o=[],c=[];if(n>1)for(let h=0;h<n;h++){const f=h/n*(Math.PI*2),d=Math.sin(f)*e,p=Math.cos(f)*e;o.push(0,0,0),o.push(d,0,p);const g=h&1?s:a;c.push(g.r,g.g,g.b),c.push(g.r,g.g,g.b)}for(let h=0;h<i;h++){const f=h&1?s:a,d=e-e/i*h;for(let p=0;p<r;p++){let g=p/r*(Math.PI*2),y=Math.sin(g)*d,v=Math.cos(g)*d;o.push(y,0,v),c.push(f.r,f.g,f.b),g=(p+1)/r*(Math.PI*2),y=Math.sin(g)*d,v=Math.cos(g)*d,o.push(y,0,v),c.push(f.r,f.g,f.b)}}const l=new Qi;l.setAttribute("position",new Hn(o,3)),l.setAttribute("color",new Hn(c,3));const u=new hh({vertexColors:!0,toneMapped:!1});super(l,u),this.type="PolarGridHelper"}dispose(){this.geometry.dispose(),this.material.dispose()}}const mJ=new Ae,MD=new Ae,gJ=new Ae;class HAe extends qr{constructor(e,n,i){super(),this.light=e,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=i,this.type="DirectionalLightHelper",n===void 0&&(n=1);let r=new Qi;r.setAttribute("position",new Hn([-n,n,0,n,n,0,n,-n,0,-n,-n,0,-n,n,0],3));const s=new hh({fog:!1,toneMapped:!1});this.lightPlane=new Gb(r,s),this.add(this.lightPlane),r=new Qi,r.setAttribute("position",new Hn([0,0,0,0,0,1],3)),this.targetLine=new Gb(r,s),this.add(this.targetLine),this.update()}dispose(){this.lightPlane.geometry.dispose(),this.lightPlane.material.dispose(),this.targetLine.geometry.dispose(),this.targetLine.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.light.target.updateWorldMatrix(!0,!1),mJ.setFromMatrixPosition(this.light.matrixWorld),MD.setFromMatrixPosition(this.light.target.matrixWorld),gJ.subVectors(MD,mJ),this.lightPlane.lookAt(MD),this.color!==void 0?(this.lightPlane.material.color.set(this.color),this.targetLine.material.color.set(this.color)):(this.lightPlane.material.color.copy(this.light.color),this.targetLine.material.color.copy(this.light.color)),this.targetLine.lookAt(MD),this.targetLine.scale.z=gJ.length()}}const OD=new Ae,fo=new iI;class jAe extends h0{constructor(e){const n=new Qi,i=new hh({color:16777215,vertexColors:!0,toneMapped:!1}),r=[],s=[],a={};o("n1","n2"),o("n2","n4"),o("n4","n3"),o("n3","n1"),o("f1","f2"),o("f2","f4"),o("f4","f3"),o("f3","f1"),o("n1","f1"),o("n2","f2"),o("n3","f3"),o("n4","f4"),o("p","n1"),o("p","n2"),o("p","n3"),o("p","n4"),o("u1","u2"),o("u2","u3"),o("u3","u1"),o("c","t"),o("p","c"),o("cn1","cn2"),o("cn3","cn4"),o("cf1","cf2"),o("cf3","cf4");function o(p,g){c(p),c(g)}function c(p){r.push(0,0,0),s.push(0,0,0),a[p]===void 0&&(a[p]=[]),a[p].push(r.length/3-1)}n.setAttribute("position",new Hn(r,3)),n.setAttribute("color",new Hn(s,3)),super(n,i),this.type="CameraHelper",this.camera=e,this.camera.updateProjectionMatrix&&this.camera.updateProjectionMatrix(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=a,this.update();const l=new yn(16755200),u=new yn(16711680),h=new yn(43775),f=new yn(16777215),d=new yn(3355443);this.setColors(l,u,h,f,d)}setColors(e,n,i,r,s){const o=this.geometry.getAttribute("color");o.setXYZ(0,e.r,e.g,e.b),o.setXYZ(1,e.r,e.g,e.b),o.setXYZ(2,e.r,e.g,e.b),o.setXYZ(3,e.r,e.g,e.b),o.setXYZ(4,e.r,e.g,e.b),o.setXYZ(5,e.r,e.g,e.b),o.setXYZ(6,e.r,e.g,e.b),o.setXYZ(7,e.r,e.g,e.b),o.setXYZ(8,e.r,e.g,e.b),o.setXYZ(9,e.r,e.g,e.b),o.setXYZ(10,e.r,e.g,e.b),o.setXYZ(11,e.r,e.g,e.b),o.setXYZ(12,e.r,e.g,e.b),o.setXYZ(13,e.r,e.g,e.b),o.setXYZ(14,e.r,e.g,e.b),o.setXYZ(15,e.r,e.g,e.b),o.setXYZ(16,e.r,e.g,e.b),o.setXYZ(17,e.r,e.g,e.b),o.setXYZ(18,e.r,e.g,e.b),o.setXYZ(19,e.r,e.g,e.b),o.setXYZ(20,e.r,e.g,e.b),o.setXYZ(21,e.r,e.g,e.b),o.setXYZ(22,e.r,e.g,e.b),o.setXYZ(23,e.r,e.g,e.b),o.setXYZ(24,n.r,n.g,n.b),o.setXYZ(25,n.r,n.g,n.b),o.setXYZ(26,n.r,n.g,n.b),o.setXYZ(27,n.r,n.g,n.b),o.setXYZ(28,n.r,n.g,n.b),o.setXYZ(29,n.r,n.g,n.b),o.setXYZ(30,n.r,n.g,n.b),o.setXYZ(31,n.r,n.g,n.b),o.setXYZ(32,i.r,i.g,i.b),o.setXYZ(33,i.r,i.g,i.b),o.setXYZ(34,i.r,i.g,i.b),o.setXYZ(35,i.r,i.g,i.b),o.setXYZ(36,i.r,i.g,i.b),o.setXYZ(37,i.r,i.g,i.b),o.setXYZ(38,r.r,r.g,r.b),o.setXYZ(39,r.r,r.g,r.b),o.setXYZ(40,s.r,s.g,s.b),o.setXYZ(41,s.r,s.g,s.b),o.setXYZ(42,s.r,s.g,s.b),o.setXYZ(43,s.r,s.g,s.b),o.setXYZ(44,s.r,s.g,s.b),o.setXYZ(45,s.r,s.g,s.b),o.setXYZ(46,s.r,s.g,s.b),o.setXYZ(47,s.r,s.g,s.b),o.setXYZ(48,s.r,s.g,s.b),o.setXYZ(49,s.r,s.g,s.b),o.needsUpdate=!0}update(){const e=this.geometry,n=this.pointMap,i=1,r=1;fo.projectionMatrixInverse.copy(this.camera.projectionMatrixInverse);const s=this.camera.coordinateSystem===ip?-1:0;Do("c",n,e,fo,0,0,s),Do("t",n,e,fo,0,0,1),Do("n1",n,e,fo,-1,-1,s),Do("n2",n,e,fo,i,-1,s),Do("n3",n,e,fo,-1,r,s),Do("n4",n,e,fo,i,r,s),Do("f1",n,e,fo,-1,-1,1),Do("f2",n,e,fo,i,-1,1),Do("f3",n,e,fo,-1,r,1),Do("f4",n,e,fo,i,r,1),Do("u1",n,e,fo,i*.7,r*1.1,s),Do("u2",n,e,fo,-1*.7,r*1.1,s),Do("u3",n,e,fo,0,r*2,s),Do("cf1",n,e,fo,-1,0,1),Do("cf2",n,e,fo,i,0,1),Do("cf3",n,e,fo,0,-1,1),Do("cf4",n,e,fo,0,r,1),Do("cn1",n,e,fo,-1,0,s),Do("cn2",n,e,fo,i,0,s),Do("cn3",n,e,fo,0,-1,s),Do("cn4",n,e,fo,0,r,s),e.getAttribute("position").needsUpdate=!0}dispose(){this.geometry.dispose(),this.material.dispose()}}function Do(t,e,n,i,r,s,a){OD.set(r,s,a).unproject(i);const o=e[t];if(o!==void 0){const c=n.getAttribute("position");for(let l=0,u=o.length;l<u;l++)c.setXYZ(o[l],OD.x,OD.y,OD.z)}}const ND=new gu;class VAe extends h0{constructor(e,n=16776960){const i=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),r=new Float32Array(8*3),s=new Qi;s.setIndex(new rr(i,1)),s.setAttribute("position",new rr(r,3)),super(s,new hh({color:n,toneMapped:!1})),this.object=e,this.type="BoxHelper",this.matrixAutoUpdate=!1,this.update()}update(){if(this.object!==void 0&&ND.setFromObject(this.object),ND.isEmpty())return;const e=ND.min,n=ND.max,i=this.geometry.attributes.position,r=i.array;r[0]=n.x,r[1]=n.y,r[2]=n.z,r[3]=e.x,r[4]=n.y,r[5]=n.z,r[6]=e.x,r[7]=e.y,r[8]=n.z,r[9]=n.x,r[10]=e.y,r[11]=n.z,r[12]=n.x,r[13]=n.y,r[14]=e.z,r[15]=e.x,r[16]=n.y,r[17]=e.z,r[18]=e.x,r[19]=e.y,r[20]=e.z,r[21]=n.x,r[22]=e.y,r[23]=e.z,i.needsUpdate=!0,this.geometry.computeBoundingSphere()}setFromObject(e){return this.object=e,this.update(),this}copy(e,n){return super.copy(e,n),this.object=e.object,this}dispose(){this.geometry.dispose(),this.material.dispose()}}class GAe extends h0{constructor(e,n=16776960){const i=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),r=[1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1],s=new Qi;s.setIndex(new rr(i,1)),s.setAttribute("position",new Hn(r,3)),super(s,new hh({color:n,toneMapped:!1})),this.box=e,this.type="Box3Helper",this.geometry.computeBoundingSphere()}updateMatrixWorld(e){const n=this.box;n.isEmpty()||(n.getCenter(this.position),n.getSize(this.scale),this.scale.multiplyScalar(.5),super.updateMatrixWorld(e))}dispose(){this.geometry.dispose(),this.material.dispose()}}class qAe extends Gb{constructor(e,n=1,i=16776960){const r=i,s=[1,-1,0,-1,1,0,-1,-1,0,1,1,0,-1,1,0,-1,-1,0,1,-1,0,1,1,0],a=new Qi;a.setAttribute("position",new Hn(s,3)),a.computeBoundingSphere(),super(a,new hh({color:r,toneMapped:!1})),this.type="PlaneHelper",this.plane=e,this.size=n;const o=[1,1,0,-1,1,0,-1,-1,0,1,1,0,-1,-1,0,1,-1,0],c=new Qi;c.setAttribute("position",new Hn(o,3)),c.computeBoundingSphere(),this.add(new jo(c,new fE({color:r,opacity:.2,transparent:!0,depthWrite:!1,toneMapped:!1})))}updateMatrixWorld(e){this.position.set(0,0,0),this.scale.set(.5*this.size,.5*this.size,1),this.lookAt(this.plane.normal),this.translateZ(-this.plane.constant),super.updateMatrixWorld(e)}dispose(){this.geometry.dispose(),this.material.dispose(),this.children[0].geometry.dispose(),this.children[0].material.dispose()}}const vJ=new Ae;let ID,fH;class $Ae extends qr{constructor(e=new Ae(0,0,1),n=new Ae(0,0,0),i=1,r=16776960,s=i*.2,a=s*.2){super(),this.type="ArrowHelper",ID===void 0&&(ID=new Qi,ID.setAttribute("position",new Hn([0,0,0,0,1,0],3)),fH=new aI(.5,1,5,1),fH.translate(0,-.5,0)),this.position.copy(n),this.line=new Gb(ID,new hh({color:r,toneMapped:!1})),this.line.matrixAutoUpdate=!1,this.add(this.line),this.cone=new jo(fH,new fE({color:r,toneMapped:!1})),this.cone.matrixAutoUpdate=!1,this.add(this.cone),this.setDirection(e),this.setLength(i,s,a)}setDirection(e){if(e.y>.99999)this.quaternion.set(0,0,0,1);else if(e.y<-.99999)this.quaternion.set(1,0,0,0);else{vJ.set(e.z,0,-e.x).normalize();const n=Math.acos(e.y);this.quaternion.setFromAxisAngle(vJ,n)}}setLength(e,n=e*.2,i=n*.2){this.line.scale.set(1,Math.max(1e-4,e-n),1),this.line.updateMatrix(),this.cone.scale.set(i,n,i),this.cone.position.y=e,this.cone.updateMatrix()}setColor(e){this.line.material.color.set(e),this.cone.material.color.set(e)}copy(e){return super.copy(e,!1),this.line.copy(e.line),this.cone.copy(e.cone),this}dispose(){this.line.geometry.dispose(),this.line.material.dispose(),this.cone.geometry.dispose(),this.cone.material.dispose()}}class WAe extends h0{constructor(e=1){const n=[0,0,0,e,0,0,0,0,0,0,e,0,0,0,0,0,0,e],i=[1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1],r=new Qi;r.setAttribute("position",new Hn(n,3)),r.setAttribute("color",new Hn(i,3));const s=new hh({vertexColors:!0,toneMapped:!1});super(r,s),this.type="AxesHelper"}setColors(e,n,i){const r=new yn,s=this.geometry.attributes.color.array;return r.set(e),r.toArray(s,0),r.toArray(s,3),r.set(n),r.toArray(s,6),r.toArray(s,9),r.set(i),r.toArray(s,12),r.toArray(s,15),this.geometry.attributes.color.needsUpdate=!0,this}dispose(){this.geometry.dispose(),this.material.dispose()}}class YAe{constructor(){this.type="ShapePath",this.color=new yn,this.subPaths=[],this.currentPath=null}moveTo(e,n){return this.currentPath=new YL,this.subPaths.push(this.currentPath),this.currentPath.moveTo(e,n),this}lineTo(e,n){return this.currentPath.lineTo(e,n),this}quadraticCurveTo(e,n,i,r){return this.currentPath.quadraticCurveTo(e,n,i,r),this}bezierCurveTo(e,n,i,r,s,a){return this.currentPath.bezierCurveTo(e,n,i,r,s,a),this}splineThru(e){return this.currentPath.splineThru(e),this}toShapes(e){function n(v){const b=[];for(let T=0,x=v.length;T<x;T++){const M=v[T],R=new gT;R.curves=M.curves,b.push(R)}return b}function i(v,b){const T=b.length;let x=!1;for(let M=T-1,R=0;R<T;M=R++){let I=b[M],k=b[R],P=k.x-I.x,U=k.y-I.y;if(Math.abs(U)>Number.EPSILON){if(U<0&&(I=b[R],P=-P,k=b[M],U=-U),v.y<I.y||v.y>k.y)continue;if(v.y===I.y){if(v.x===I.x)return!0}else{const G=U*(v.x-I.x)-P*(v.y-I.y);if(G===0)return!0;if(G<0)continue;x=!x}}else{if(v.y!==I.y)continue;if(k.x<=v.x&&v.x<=I.x||I.x<=v.x&&v.x<=k.x)return!0}}return x}const r=lm.isClockWise,s=this.subPaths;if(s.length===0)return[];let a,o,c;const l=[];if(s.length===1)return o=s[0],c=new gT,c.curves=o.curves,l.push(c),l;let u=!r(s[0].getPoints());u=e?!u:u;const h=[],f=[];let d=[],p=0,g;f[p]=void 0,d[p]=[];for(let v=0,b=s.length;v<b;v++)o=s[v],g=o.getPoints(),a=r(g),a=e?!a:a,a?(!u&&f[p]&&p++,f[p]={s:new gT,p:g},f[p].s.curves=o.curves,u&&p++,d[p]=[]):d[p].push({h:o,p:g[0]});if(!f[0])return n(s);if(f.length>1){let v=!1,b=0;for(let T=0,x=f.length;T<x;T++)h[T]=[];for(let T=0,x=f.length;T<x;T++){const M=d[T];for(let R=0;R<M.length;R++){const I=M[R];let k=!0;for(let P=0;P<f.length;P++)i(I.p,f[P].p)&&(T!==P&&b++,k?(k=!1,h[P].push(I)):v=!0);k&&h[T].push(I)}}b>0&&v===!1&&(d=h)}let y;for(let v=0,b=f.length;v<b;v++){c=f[v].s,l.push(c),y=d[v];for(let T=0,x=y.length;T<x;T++)c.holes.push(y[T].h)}return l}}let XAe=class extends cd{constructor(e,n=null){super(),this.object=e,this.domElement=n,this.enabled=!0,this.state=-1,this.keys={},this.mouseButtons={LEFT:null,MIDDLE:null,RIGHT:null},this.touches={ONE:null,TWO:null}}connect(e){if(e===void 0){console.warn("THREE.Controls: connect() now requires an element.");return}this.domElement!==null&&this.disconnect(),this.domElement=e}disconnect(){}dispose(){}update(){}};function KAe(t,e){const n=t.image&&t.image.width?t.image.width/t.image.height:1;return n>e?(t.repeat.x=1,t.repeat.y=n/e,t.offset.x=0,t.offset.y=(1-t.repeat.y)/2):(t.repeat.x=e/n,t.repeat.y=1,t.offset.x=(1-t.repeat.x)/2,t.offset.y=0),t}function ZAe(t,e){const n=t.image&&t.image.width?t.image.width/t.image.height:1;return n>e?(t.repeat.x=e/n,t.repeat.y=1,t.offset.x=(1-t.repeat.x)/2,t.offset.y=0):(t.repeat.x=1,t.repeat.y=n/e,t.offset.x=0,t.offset.y=(1-t.repeat.y)/2),t}function JAe(t){return t.repeat.x=1,t.repeat.y=1,t.offset.x=0,t.offset.y=0,t}function TV(t,e,n,i){const r=QAe(i);switch(n){case r7:return t*e;case vB:return t*e/r.components*r.byteLength;case eI:return t*e/r.components*r.byteLength;case a7:return t*e*2/r.components*r.byteLength;case _B:return t*e*2/r.components*r.byteLength;case s7:return t*e*3/r.components*r.byteLength;case fu:return t*e*4/r.components*r.byteLength;case tI:return t*e*4/r.components*r.byteLength;case yM:case bM:return Math.floor((t+3)/4)*Math.floor((e+3)/4)*8;case EM:case SM:return Math.floor((t+3)/4)*Math.floor((e+3)/4)*16;case yL:case EL:return Math.max(t,16)*Math.max(e,8)/4;case _L:case bL:return Math.max(t,8)*Math.max(e,8)/2;case SL:case TL:return Math.floor((t+3)/4)*Math.floor((e+3)/4)*8;case xL:return Math.floor((t+3)/4)*Math.floor((e+3)/4)*16;case wL:return Math.floor((t+3)/4)*Math.floor((e+3)/4)*16;case CL:return Math.floor((t+4)/5)*Math.floor((e+3)/4)*16;case AL:return Math.floor((t+4)/5)*Math.floor((e+4)/5)*16;case RL:return Math.floor((t+5)/6)*Math.floor((e+4)/5)*16;case ML:return Math.floor((t+5)/6)*Math.floor((e+5)/6)*16;case OL:return Math.floor((t+7)/8)*Math.floor((e+4)/5)*16;case NL:return Math.floor((t+7)/8)*Math.floor((e+5)/6)*16;case IL:return Math.floor((t+7)/8)*Math.floor((e+7)/8)*16;case kL:return Math.floor((t+9)/10)*Math.floor((e+4)/5)*16;case DL:return Math.floor((t+9)/10)*Math.floor((e+5)/6)*16;case PL:return Math.floor((t+9)/10)*Math.floor((e+7)/8)*16;case LL:return Math.floor((t+9)/10)*Math.floor((e+9)/10)*16;case UL:return Math.floor((t+11)/12)*Math.floor((e+9)/10)*16;case BL:return Math.floor((t+11)/12)*Math.floor((e+11)/12)*16;case TM:case FL:case zL:return Math.ceil(t/4)*Math.ceil(e/4)*16;case o7:case HL:return Math.ceil(t/4)*Math.ceil(e/4)*8;case jL:case VL:return Math.ceil(t/4)*Math.ceil(e/4)*16}throw new Error(`Unable to determine texture byte length for ${n} format.`)}function QAe(t){switch(t){case El:case t7:return{byteLength:1,components:1};case vC:case n7:case lE:return{byteLength:2,components:1};case mB:case gB:return{byteLength:2,components:4};case Jg:case pB:case hu:return{byteLength:4,components:1};case i7:return{byteLength:4,components:3}}throw new Error(`Unknown texture type ${t}.`)}class eRe{static contain(e,n){return KAe(e,n)}static cover(e,n){return ZAe(e,n)}static fill(e){return JAe(e)}static getByteLength(e,n,i,r){return TV(e,n,i,r)}}typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:JN}}));typeof window<"u"&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=JN);/**
 * @license
 * Copyright 2010-2025 Three.js Authors
 * SPDX-License-Identifier: MIT
 */function Dle(){let t=null,e=!1,n=null,i=null;function r(s,a){n(s,a),i=t.requestAnimationFrame(r)}return{start:function(){e!==!0&&n!==null&&(i=t.requestAnimationFrame(r),e=!0)},stop:function(){t.cancelAnimationFrame(i),e=!1},setAnimationLoop:function(s){n=s},setContext:function(s){t=s}}}function tRe(t){const e=new WeakMap;function n(o,c){const l=o.array,u=o.usage,h=l.byteLength,f=t.createBuffer();t.bindBuffer(c,f),t.bufferData(c,l,u),o.onUploadCallback();let d;if(l instanceof Float32Array)d=t.FLOAT;else if(l instanceof Uint16Array)o.isFloat16BufferAttribute?d=t.HALF_FLOAT:d=t.UNSIGNED_SHORT;else if(l instanceof Int16Array)d=t.SHORT;else if(l instanceof Uint32Array)d=t.UNSIGNED_INT;else if(l instanceof Int32Array)d=t.INT;else if(l instanceof Int8Array)d=t.BYTE;else if(l instanceof Uint8Array)d=t.UNSIGNED_BYTE;else if(l instanceof Uint8ClampedArray)d=t.UNSIGNED_BYTE;else throw new Error("THREE.WebGLAttributes: Unsupported buffer data format: "+l);return{buffer:f,type:d,bytesPerElement:l.BYTES_PER_ELEMENT,version:o.version,size:h}}function i(o,c,l){const u=c.array,h=c.updateRanges;if(t.bindBuffer(l,o),h.length===0)t.bufferSubData(l,0,u);else{h.sort((d,p)=>d.start-p.start);let f=0;for(let d=1;d<h.length;d++){const p=h[f],g=h[d];g.start<=p.start+p.count+1?p.count=Math.max(p.count,g.start+g.count-p.start):(++f,h[f]=g)}h.length=f+1;for(let d=0,p=h.length;d<p;d++){const g=h[d];t.bufferSubData(l,g.start*u.BYTES_PER_ELEMENT,u,g.start,g.count)}c.clearUpdateRanges()}c.onUploadCallback()}function r(o){return o.isInterleavedBufferAttribute&&(o=o.data),e.get(o)}function s(o){o.isInterleavedBufferAttribute&&(o=o.data);const c=e.get(o);c&&(t.deleteBuffer(c.buffer),e.delete(o))}function a(o,c){if(o.isInterleavedBufferAttribute&&(o=o.data),o.isGLBufferAttribute){const u=e.get(o);(!u||u.version<o.version)&&e.set(o,{buffer:o.buffer,type:o.type,bytesPerElement:o.elementSize,version:o.version});return}const l=e.get(o);if(l===void 0)e.set(o,n(o,c));else if(l.version<o.version){if(l.size!==o.array.byteLength)throw new Error("THREE.WebGLAttributes: The size of the buffer attribute's array buffer does not match the original size. Resizing buffer attributes is not supported.");i(l.buffer,o,c),l.version=o.version}}return{get:r,remove:s,update:a}}var nRe=`#ifdef USE_ALPHAHASH
	if ( diffuseColor.a < getAlphaHashThreshold( vPosition ) ) discard;
#endif`,iRe=`#ifdef USE_ALPHAHASH
	const float ALPHA_HASH_SCALE = 0.05;
	float hash2D( vec2 value ) {
		return fract( 1.0e4 * sin( 17.0 * value.x + 0.1 * value.y ) * ( 0.1 + abs( sin( 13.0 * value.y + value.x ) ) ) );
	}
	float hash3D( vec3 value ) {
		return hash2D( vec2( hash2D( value.xy ), value.z ) );
	}
	float getAlphaHashThreshold( vec3 position ) {
		float maxDeriv = max(
			length( dFdx( position.xyz ) ),
			length( dFdy( position.xyz ) )
		);
		float pixScale = 1.0 / ( ALPHA_HASH_SCALE * maxDeriv );
		vec2 pixScales = vec2(
			exp2( floor( log2( pixScale ) ) ),
			exp2( ceil( log2( pixScale ) ) )
		);
		vec2 alpha = vec2(
			hash3D( floor( pixScales.x * position.xyz ) ),
			hash3D( floor( pixScales.y * position.xyz ) )
		);
		float lerpFactor = fract( log2( pixScale ) );
		float x = ( 1.0 - lerpFactor ) * alpha.x + lerpFactor * alpha.y;
		float a = min( lerpFactor, 1.0 - lerpFactor );
		vec3 cases = vec3(
			x * x / ( 2.0 * a * ( 1.0 - a ) ),
			( x - 0.5 * a ) / ( 1.0 - a ),
			1.0 - ( ( 1.0 - x ) * ( 1.0 - x ) / ( 2.0 * a * ( 1.0 - a ) ) )
		);
		float threshold = ( x < ( 1.0 - a ) )
			? ( ( x < a ) ? cases.x : cases.y )
			: cases.z;
		return clamp( threshold , 1.0e-6, 1.0 );
	}
#endif`,rRe=`#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, vAlphaMapUv ).g;
#endif`,sRe=`#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,aRe=`#ifdef USE_ALPHATEST
	#ifdef ALPHA_TO_COVERAGE
	diffuseColor.a = smoothstep( alphaTest, alphaTest + fwidth( diffuseColor.a ), diffuseColor.a );
	if ( diffuseColor.a == 0.0 ) discard;
	#else
	if ( diffuseColor.a < alphaTest ) discard;
	#endif
#endif`,oRe=`#ifdef USE_ALPHATEST
	uniform float alphaTest;
#endif`,cRe=`#ifdef USE_AOMAP
	float ambientOcclusion = ( texture2D( aoMap, vAoMapUv ).r - 1.0 ) * aoMapIntensity + 1.0;
	reflectedLight.indirectDiffuse *= ambientOcclusion;
	#if defined( USE_CLEARCOAT ) 
		clearcoatSpecularIndirect *= ambientOcclusion;
	#endif
	#if defined( USE_SHEEN ) 
		sheenSpecularIndirect *= ambientOcclusion;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD )
		float dotNV = saturate( dot( geometryNormal, geometryViewDir ) );
		reflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );
	#endif
#endif`,lRe=`#ifdef USE_AOMAP
	uniform sampler2D aoMap;
	uniform float aoMapIntensity;
#endif`,uRe=`#ifdef USE_BATCHING
	#if ! defined( GL_ANGLE_multi_draw )
	#define gl_DrawID _gl_DrawID
	uniform int _gl_DrawID;
	#endif
	uniform highp sampler2D batchingTexture;
	uniform highp usampler2D batchingIdTexture;
	mat4 getBatchingMatrix( const in float i ) {
		int size = textureSize( batchingTexture, 0 ).x;
		int j = int( i ) * 4;
		int x = j % size;
		int y = j / size;
		vec4 v1 = texelFetch( batchingTexture, ivec2( x, y ), 0 );
		vec4 v2 = texelFetch( batchingTexture, ivec2( x + 1, y ), 0 );
		vec4 v3 = texelFetch( batchingTexture, ivec2( x + 2, y ), 0 );
		vec4 v4 = texelFetch( batchingTexture, ivec2( x + 3, y ), 0 );
		return mat4( v1, v2, v3, v4 );
	}
	float getIndirectIndex( const in int i ) {
		int size = textureSize( batchingIdTexture, 0 ).x;
		int x = i % size;
		int y = i / size;
		return float( texelFetch( batchingIdTexture, ivec2( x, y ), 0 ).r );
	}
#endif
#ifdef USE_BATCHING_COLOR
	uniform sampler2D batchingColorTexture;
	vec3 getBatchingColor( const in float i ) {
		int size = textureSize( batchingColorTexture, 0 ).x;
		int j = int( i );
		int x = j % size;
		int y = j / size;
		return texelFetch( batchingColorTexture, ivec2( x, y ), 0 ).rgb;
	}
#endif`,hRe=`#ifdef USE_BATCHING
	mat4 batchingMatrix = getBatchingMatrix( getIndirectIndex( gl_DrawID ) );
#endif`,fRe=`vec3 transformed = vec3( position );
#ifdef USE_ALPHAHASH
	vPosition = vec3( position );
#endif`,dRe=`vec3 objectNormal = vec3( normal );
#ifdef USE_TANGENT
	vec3 objectTangent = vec3( tangent.xyz );
#endif`,pRe=`float G_BlinnPhong_Implicit( ) {
	return 0.25;
}
float D_BlinnPhong( const in float shininess, const in float dotNH ) {
	return RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );
}
vec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( specularColor, 1.0, dotVH );
	float G = G_BlinnPhong_Implicit( );
	float D = D_BlinnPhong( shininess, dotNH );
	return F * ( G * D );
} // validated`,mRe=`#ifdef USE_IRIDESCENCE
	const mat3 XYZ_TO_REC709 = mat3(
		 3.2404542, -0.9692660,  0.0556434,
		-1.5371385,  1.8760108, -0.2040259,
		-0.4985314,  0.0415560,  1.0572252
	);
	vec3 Fresnel0ToIor( vec3 fresnel0 ) {
		vec3 sqrtF0 = sqrt( fresnel0 );
		return ( vec3( 1.0 ) + sqrtF0 ) / ( vec3( 1.0 ) - sqrtF0 );
	}
	vec3 IorToFresnel0( vec3 transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - vec3( incidentIor ) ) / ( transmittedIor + vec3( incidentIor ) ) );
	}
	float IorToFresnel0( float transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - incidentIor ) / ( transmittedIor + incidentIor ));
	}
	vec3 evalSensitivity( float OPD, vec3 shift ) {
		float phase = 2.0 * PI * OPD * 1.0e-9;
		vec3 val = vec3( 5.4856e-13, 4.4201e-13, 5.2481e-13 );
		vec3 pos = vec3( 1.6810e+06, 1.7953e+06, 2.2084e+06 );
		vec3 var = vec3( 4.3278e+09, 9.3046e+09, 6.6121e+09 );
		vec3 xyz = val * sqrt( 2.0 * PI * var ) * cos( pos * phase + shift ) * exp( - pow2( phase ) * var );
		xyz.x += 9.7470e-14 * sqrt( 2.0 * PI * 4.5282e+09 ) * cos( 2.2399e+06 * phase + shift[ 0 ] ) * exp( - 4.5282e+09 * pow2( phase ) );
		xyz /= 1.0685e-7;
		vec3 rgb = XYZ_TO_REC709 * xyz;
		return rgb;
	}
	vec3 evalIridescence( float outsideIOR, float eta2, float cosTheta1, float thinFilmThickness, vec3 baseF0 ) {
		vec3 I;
		float iridescenceIOR = mix( outsideIOR, eta2, smoothstep( 0.0, 0.03, thinFilmThickness ) );
		float sinTheta2Sq = pow2( outsideIOR / iridescenceIOR ) * ( 1.0 - pow2( cosTheta1 ) );
		float cosTheta2Sq = 1.0 - sinTheta2Sq;
		if ( cosTheta2Sq < 0.0 ) {
			return vec3( 1.0 );
		}
		float cosTheta2 = sqrt( cosTheta2Sq );
		float R0 = IorToFresnel0( iridescenceIOR, outsideIOR );
		float R12 = F_Schlick( R0, 1.0, cosTheta1 );
		float T121 = 1.0 - R12;
		float phi12 = 0.0;
		if ( iridescenceIOR < outsideIOR ) phi12 = PI;
		float phi21 = PI - phi12;
		vec3 baseIOR = Fresnel0ToIor( clamp( baseF0, 0.0, 0.9999 ) );		vec3 R1 = IorToFresnel0( baseIOR, iridescenceIOR );
		vec3 R23 = F_Schlick( R1, 1.0, cosTheta2 );
		vec3 phi23 = vec3( 0.0 );
		if ( baseIOR[ 0 ] < iridescenceIOR ) phi23[ 0 ] = PI;
		if ( baseIOR[ 1 ] < iridescenceIOR ) phi23[ 1 ] = PI;
		if ( baseIOR[ 2 ] < iridescenceIOR ) phi23[ 2 ] = PI;
		float OPD = 2.0 * iridescenceIOR * thinFilmThickness * cosTheta2;
		vec3 phi = vec3( phi21 ) + phi23;
		vec3 R123 = clamp( R12 * R23, 1e-5, 0.9999 );
		vec3 r123 = sqrt( R123 );
		vec3 Rs = pow2( T121 ) * R23 / ( vec3( 1.0 ) - R123 );
		vec3 C0 = R12 + Rs;
		I = C0;
		vec3 Cm = Rs - T121;
		for ( int m = 1; m <= 2; ++ m ) {
			Cm *= r123;
			vec3 Sm = 2.0 * evalSensitivity( float( m ) * OPD, float( m ) * phi );
			I += Cm * Sm;
		}
		return max( I, vec3( 0.0 ) );
	}
#endif`,gRe=`#ifdef USE_BUMPMAP
	uniform sampler2D bumpMap;
	uniform float bumpScale;
	vec2 dHdxy_fwd() {
		vec2 dSTdx = dFdx( vBumpMapUv );
		vec2 dSTdy = dFdy( vBumpMapUv );
		float Hll = bumpScale * texture2D( bumpMap, vBumpMapUv ).x;
		float dBx = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdx ).x - Hll;
		float dBy = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdy ).x - Hll;
		return vec2( dBx, dBy );
	}
	vec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {
		vec3 vSigmaX = normalize( dFdx( surf_pos.xyz ) );
		vec3 vSigmaY = normalize( dFdy( surf_pos.xyz ) );
		vec3 vN = surf_norm;
		vec3 R1 = cross( vSigmaY, vN );
		vec3 R2 = cross( vN, vSigmaX );
		float fDet = dot( vSigmaX, R1 ) * faceDirection;
		vec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );
		return normalize( abs( fDet ) * surf_norm - vGrad );
	}
#endif`,vRe=`#if NUM_CLIPPING_PLANES > 0
	vec4 plane;
	#ifdef ALPHA_TO_COVERAGE
		float distanceToPlane, distanceGradient;
		float clipOpacity = 1.0;
		#pragma unroll_loop_start
		for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			distanceToPlane = - dot( vClipPosition, plane.xyz ) + plane.w;
			distanceGradient = fwidth( distanceToPlane ) / 2.0;
			clipOpacity *= smoothstep( - distanceGradient, distanceGradient, distanceToPlane );
			if ( clipOpacity == 0.0 ) discard;
		}
		#pragma unroll_loop_end
		#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
			float unionClipOpacity = 1.0;
			#pragma unroll_loop_start
			for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
				plane = clippingPlanes[ i ];
				distanceToPlane = - dot( vClipPosition, plane.xyz ) + plane.w;
				distanceGradient = fwidth( distanceToPlane ) / 2.0;
				unionClipOpacity *= 1.0 - smoothstep( - distanceGradient, distanceGradient, distanceToPlane );
			}
			#pragma unroll_loop_end
			clipOpacity *= 1.0 - unionClipOpacity;
		#endif
		diffuseColor.a *= clipOpacity;
		if ( diffuseColor.a == 0.0 ) discard;
	#else
		#pragma unroll_loop_start
		for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			if ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;
		}
		#pragma unroll_loop_end
		#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
			bool clipped = true;
			#pragma unroll_loop_start
			for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
				plane = clippingPlanes[ i ];
				clipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;
			}
			#pragma unroll_loop_end
			if ( clipped ) discard;
		#endif
	#endif
#endif`,_Re=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
	uniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];
#endif`,yRe=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
#endif`,bRe=`#if NUM_CLIPPING_PLANES > 0
	vClipPosition = - mvPosition.xyz;
#endif`,ERe=`#if defined( USE_COLOR_ALPHA )
	diffuseColor *= vColor;
#elif defined( USE_COLOR )
	diffuseColor.rgb *= vColor;
#endif`,SRe=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR )
	varying vec3 vColor;
#endif`,TRe=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR ) || defined( USE_BATCHING_COLOR )
	varying vec3 vColor;
#endif`,xRe=`#if defined( USE_COLOR_ALPHA )
	vColor = vec4( 1.0 );
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR ) || defined( USE_BATCHING_COLOR )
	vColor = vec3( 1.0 );
#endif
#ifdef USE_COLOR
	vColor *= color;
#endif
#ifdef USE_INSTANCING_COLOR
	vColor.xyz *= instanceColor.xyz;
#endif
#ifdef USE_BATCHING_COLOR
	vec3 batchingColor = getBatchingColor( getIndirectIndex( gl_DrawID ) );
	vColor.xyz *= batchingColor.xyz;
#endif`,wRe=`#define PI 3.141592653589793
#define PI2 6.283185307179586
#define PI_HALF 1.5707963267948966
#define RECIPROCAL_PI 0.3183098861837907
#define RECIPROCAL_PI2 0.15915494309189535
#define EPSILON 1e-6
#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
#define whiteComplement( a ) ( 1.0 - saturate( a ) )
float pow2( const in float x ) { return x*x; }
vec3 pow2( const in vec3 x ) { return x*x; }
float pow3( const in float x ) { return x*x*x; }
float pow4( const in float x ) { float x2 = x*x; return x2*x2; }
float max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }
float average( const in vec3 v ) { return dot( v, vec3( 0.3333333 ) ); }
highp float rand( const in vec2 uv ) {
	const highp float a = 12.9898, b = 78.233, c = 43758.5453;
	highp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );
	return fract( sin( sn ) * c );
}
#ifdef HIGH_PRECISION
	float precisionSafeLength( vec3 v ) { return length( v ); }
#else
	float precisionSafeLength( vec3 v ) {
		float maxComponent = max3( abs( v ) );
		return length( v / maxComponent ) * maxComponent;
	}
#endif
struct IncidentLight {
	vec3 color;
	vec3 direction;
	bool visible;
};
struct ReflectedLight {
	vec3 directDiffuse;
	vec3 directSpecular;
	vec3 indirectDiffuse;
	vec3 indirectSpecular;
};
#ifdef USE_ALPHAHASH
	varying vec3 vPosition;
#endif
vec3 transformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );
}
vec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );
}
mat3 transposeMat3( const in mat3 m ) {
	mat3 tmp;
	tmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );
	tmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );
	tmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );
	return tmp;
}
bool isPerspectiveMatrix( mat4 m ) {
	return m[ 2 ][ 3 ] == - 1.0;
}
vec2 equirectUv( in vec3 dir ) {
	float u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;
	float v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;
	return vec2( u, v );
}
vec3 BRDF_Lambert( const in vec3 diffuseColor ) {
	return RECIPROCAL_PI * diffuseColor;
}
vec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
}
float F_Schlick( const in float f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
} // validated`,CRe=`#ifdef ENVMAP_TYPE_CUBE_UV
	#define cubeUV_minMipLevel 4.0
	#define cubeUV_minTileSize 16.0
	float getFace( vec3 direction ) {
		vec3 absDirection = abs( direction );
		float face = - 1.0;
		if ( absDirection.x > absDirection.z ) {
			if ( absDirection.x > absDirection.y )
				face = direction.x > 0.0 ? 0.0 : 3.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		} else {
			if ( absDirection.z > absDirection.y )
				face = direction.z > 0.0 ? 2.0 : 5.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		}
		return face;
	}
	vec2 getUV( vec3 direction, float face ) {
		vec2 uv;
		if ( face == 0.0 ) {
			uv = vec2( direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 1.0 ) {
			uv = vec2( - direction.x, - direction.z ) / abs( direction.y );
		} else if ( face == 2.0 ) {
			uv = vec2( - direction.x, direction.y ) / abs( direction.z );
		} else if ( face == 3.0 ) {
			uv = vec2( - direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 4.0 ) {
			uv = vec2( - direction.x, direction.z ) / abs( direction.y );
		} else {
			uv = vec2( direction.x, direction.y ) / abs( direction.z );
		}
		return 0.5 * ( uv + 1.0 );
	}
	vec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {
		float face = getFace( direction );
		float filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );
		mipInt = max( mipInt, cubeUV_minMipLevel );
		float faceSize = exp2( mipInt );
		highp vec2 uv = getUV( direction, face ) * ( faceSize - 2.0 ) + 1.0;
		if ( face > 2.0 ) {
			uv.y += faceSize;
			face -= 3.0;
		}
		uv.x += face * faceSize;
		uv.x += filterInt * 3.0 * cubeUV_minTileSize;
		uv.y += 4.0 * ( exp2( CUBEUV_MAX_MIP ) - faceSize );
		uv.x *= CUBEUV_TEXEL_WIDTH;
		uv.y *= CUBEUV_TEXEL_HEIGHT;
		#ifdef texture2DGradEXT
			return texture2DGradEXT( envMap, uv, vec2( 0.0 ), vec2( 0.0 ) ).rgb;
		#else
			return texture2D( envMap, uv ).rgb;
		#endif
	}
	#define cubeUV_r0 1.0
	#define cubeUV_m0 - 2.0
	#define cubeUV_r1 0.8
	#define cubeUV_m1 - 1.0
	#define cubeUV_r4 0.4
	#define cubeUV_m4 2.0
	#define cubeUV_r5 0.305
	#define cubeUV_m5 3.0
	#define cubeUV_r6 0.21
	#define cubeUV_m6 4.0
	float roughnessToMip( float roughness ) {
		float mip = 0.0;
		if ( roughness >= cubeUV_r1 ) {
			mip = ( cubeUV_r0 - roughness ) * ( cubeUV_m1 - cubeUV_m0 ) / ( cubeUV_r0 - cubeUV_r1 ) + cubeUV_m0;
		} else if ( roughness >= cubeUV_r4 ) {
			mip = ( cubeUV_r1 - roughness ) * ( cubeUV_m4 - cubeUV_m1 ) / ( cubeUV_r1 - cubeUV_r4 ) + cubeUV_m1;
		} else if ( roughness >= cubeUV_r5 ) {
			mip = ( cubeUV_r4 - roughness ) * ( cubeUV_m5 - cubeUV_m4 ) / ( cubeUV_r4 - cubeUV_r5 ) + cubeUV_m4;
		} else if ( roughness >= cubeUV_r6 ) {
			mip = ( cubeUV_r5 - roughness ) * ( cubeUV_m6 - cubeUV_m5 ) / ( cubeUV_r5 - cubeUV_r6 ) + cubeUV_m5;
		} else {
			mip = - 2.0 * log2( 1.16 * roughness );		}
		return mip;
	}
	vec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {
		float mip = clamp( roughnessToMip( roughness ), cubeUV_m0, CUBEUV_MAX_MIP );
		float mipF = fract( mip );
		float mipInt = floor( mip );
		vec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );
		if ( mipF == 0.0 ) {
			return vec4( color0, 1.0 );
		} else {
			vec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );
			return vec4( mix( color0, color1, mipF ), 1.0 );
		}
	}
#endif`,ARe=`vec3 transformedNormal = objectNormal;
#ifdef USE_TANGENT
	vec3 transformedTangent = objectTangent;
#endif
#ifdef USE_BATCHING
	mat3 bm = mat3( batchingMatrix );
	transformedNormal /= vec3( dot( bm[ 0 ], bm[ 0 ] ), dot( bm[ 1 ], bm[ 1 ] ), dot( bm[ 2 ], bm[ 2 ] ) );
	transformedNormal = bm * transformedNormal;
	#ifdef USE_TANGENT
		transformedTangent = bm * transformedTangent;
	#endif
#endif
#ifdef USE_INSTANCING
	mat3 im = mat3( instanceMatrix );
	transformedNormal /= vec3( dot( im[ 0 ], im[ 0 ] ), dot( im[ 1 ], im[ 1 ] ), dot( im[ 2 ], im[ 2 ] ) );
	transformedNormal = im * transformedNormal;
	#ifdef USE_TANGENT
		transformedTangent = im * transformedTangent;
	#endif
#endif
transformedNormal = normalMatrix * transformedNormal;
#ifdef FLIP_SIDED
	transformedNormal = - transformedNormal;
#endif
#ifdef USE_TANGENT
	transformedTangent = ( modelViewMatrix * vec4( transformedTangent, 0.0 ) ).xyz;
	#ifdef FLIP_SIDED
		transformedTangent = - transformedTangent;
	#endif
#endif`,RRe=`#ifdef USE_DISPLACEMENTMAP
	uniform sampler2D displacementMap;
	uniform float displacementScale;
	uniform float displacementBias;
#endif`,MRe=`#ifdef USE_DISPLACEMENTMAP
	transformed += normalize( objectNormal ) * ( texture2D( displacementMap, vDisplacementMapUv ).x * displacementScale + displacementBias );
#endif`,ORe=`#ifdef USE_EMISSIVEMAP
	vec4 emissiveColor = texture2D( emissiveMap, vEmissiveMapUv );
	#ifdef DECODE_VIDEO_TEXTURE_EMISSIVE
		emissiveColor = sRGBTransferEOTF( emissiveColor );
	#endif
	totalEmissiveRadiance *= emissiveColor.rgb;
#endif`,NRe=`#ifdef USE_EMISSIVEMAP
	uniform sampler2D emissiveMap;
#endif`,IRe="gl_FragColor = linearToOutputTexel( gl_FragColor );",kRe=`vec4 LinearTransferOETF( in vec4 value ) {
	return value;
}
vec4 sRGBTransferEOTF( in vec4 value ) {
	return vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.a );
}
vec4 sRGBTransferOETF( in vec4 value ) {
	return vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );
}`,DRe=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vec3 cameraToFrag;
		if ( isOrthographic ) {
			cameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToFrag = normalize( vWorldPosition - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vec3 reflectVec = reflect( cameraToFrag, worldNormal );
		#else
			vec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );
		#endif
	#else
		vec3 reflectVec = vReflect;
	#endif
	#ifdef ENVMAP_TYPE_CUBE
		vec4 envColor = textureCube( envMap, envMapRotation * vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );
	#else
		vec4 envColor = vec4( 0.0 );
	#endif
	#ifdef ENVMAP_BLENDING_MULTIPLY
		outgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_MIX )
		outgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_ADD )
		outgoingLight += envColor.xyz * specularStrength * reflectivity;
	#endif
#endif`,PRe=`#ifdef USE_ENVMAP
	uniform float envMapIntensity;
	uniform float flipEnvMap;
	uniform mat3 envMapRotation;
	#ifdef ENVMAP_TYPE_CUBE
		uniform samplerCube envMap;
	#else
		uniform sampler2D envMap;
	#endif
	
#endif`,LRe=`#ifdef USE_ENVMAP
	uniform float reflectivity;
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		varying vec3 vWorldPosition;
		uniform float refractionRatio;
	#else
		varying vec3 vReflect;
	#endif
#endif`,URe=`#ifdef USE_ENVMAP
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		
		varying vec3 vWorldPosition;
	#else
		varying vec3 vReflect;
		uniform float refractionRatio;
	#endif
#endif`,BRe=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vWorldPosition = worldPosition.xyz;
	#else
		vec3 cameraToVertex;
		if ( isOrthographic ) {
			cameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToVertex = normalize( worldPosition.xyz - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vReflect = reflect( cameraToVertex, worldNormal );
		#else
			vReflect = refract( cameraToVertex, worldNormal, refractionRatio );
		#endif
	#endif
#endif`,FRe=`#ifdef USE_FOG
	vFogDepth = - mvPosition.z;
#endif`,zRe=`#ifdef USE_FOG
	varying float vFogDepth;
#endif`,HRe=`#ifdef USE_FOG
	#ifdef FOG_EXP2
		float fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );
	#else
		float fogFactor = smoothstep( fogNear, fogFar, vFogDepth );
	#endif
	gl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );
#endif`,jRe=`#ifdef USE_FOG
	uniform vec3 fogColor;
	varying float vFogDepth;
	#ifdef FOG_EXP2
		uniform float fogDensity;
	#else
		uniform float fogNear;
		uniform float fogFar;
	#endif
#endif`,VRe=`#ifdef USE_GRADIENTMAP
	uniform sampler2D gradientMap;
#endif
vec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {
	float dotNL = dot( normal, lightDirection );
	vec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );
	#ifdef USE_GRADIENTMAP
		return vec3( texture2D( gradientMap, coord ).r );
	#else
		vec2 fw = fwidth( coord ) * 0.5;
		return mix( vec3( 0.7 ), vec3( 1.0 ), smoothstep( 0.7 - fw.x, 0.7 + fw.x, coord.x ) );
	#endif
}`,GRe=`#ifdef USE_LIGHTMAP
	uniform sampler2D lightMap;
	uniform float lightMapIntensity;
#endif`,qRe=`LambertMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularStrength = specularStrength;`,$Re=`varying vec3 vViewPosition;
struct LambertMaterial {
	vec3 diffuseColor;
	float specularStrength;
};
void RE_Direct_Lambert( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Lambert( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Lambert
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Lambert`,WRe=`uniform bool receiveShadow;
uniform vec3 ambientLightColor;
#if defined( USE_LIGHT_PROBES )
	uniform vec3 lightProbe[ 9 ];
#endif
vec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {
	float x = normal.x, y = normal.y, z = normal.z;
	vec3 result = shCoefficients[ 0 ] * 0.886227;
	result += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;
	result += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;
	result += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;
	result += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;
	result += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;
	result += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );
	result += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;
	result += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );
	return result;
}
vec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {
	vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
	vec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );
	return irradiance;
}
vec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {
	vec3 irradiance = ambientLightColor;
	return irradiance;
}
float getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {
	float distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );
	if ( cutoffDistance > 0.0 ) {
		distanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );
	}
	return distanceFalloff;
}
float getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {
	return smoothstep( coneCosine, penumbraCosine, angleCosine );
}
#if NUM_DIR_LIGHTS > 0
	struct DirectionalLight {
		vec3 direction;
		vec3 color;
	};
	uniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];
	void getDirectionalLightInfo( const in DirectionalLight directionalLight, out IncidentLight light ) {
		light.color = directionalLight.color;
		light.direction = directionalLight.direction;
		light.visible = true;
	}
#endif
#if NUM_POINT_LIGHTS > 0
	struct PointLight {
		vec3 position;
		vec3 color;
		float distance;
		float decay;
	};
	uniform PointLight pointLights[ NUM_POINT_LIGHTS ];
	void getPointLightInfo( const in PointLight pointLight, const in vec3 geometryPosition, out IncidentLight light ) {
		vec3 lVector = pointLight.position - geometryPosition;
		light.direction = normalize( lVector );
		float lightDistance = length( lVector );
		light.color = pointLight.color;
		light.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );
		light.visible = ( light.color != vec3( 0.0 ) );
	}
#endif
#if NUM_SPOT_LIGHTS > 0
	struct SpotLight {
		vec3 position;
		vec3 direction;
		vec3 color;
		float distance;
		float decay;
		float coneCos;
		float penumbraCos;
	};
	uniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];
	void getSpotLightInfo( const in SpotLight spotLight, const in vec3 geometryPosition, out IncidentLight light ) {
		vec3 lVector = spotLight.position - geometryPosition;
		light.direction = normalize( lVector );
		float angleCos = dot( light.direction, spotLight.direction );
		float spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );
		if ( spotAttenuation > 0.0 ) {
			float lightDistance = length( lVector );
			light.color = spotLight.color * spotAttenuation;
			light.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );
			light.visible = ( light.color != vec3( 0.0 ) );
		} else {
			light.color = vec3( 0.0 );
			light.visible = false;
		}
	}
#endif
#if NUM_RECT_AREA_LIGHTS > 0
	struct RectAreaLight {
		vec3 color;
		vec3 position;
		vec3 halfWidth;
		vec3 halfHeight;
	};
	uniform sampler2D ltc_1;	uniform sampler2D ltc_2;
	uniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];
#endif
#if NUM_HEMI_LIGHTS > 0
	struct HemisphereLight {
		vec3 direction;
		vec3 skyColor;
		vec3 groundColor;
	};
	uniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];
	vec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {
		float dotNL = dot( normal, hemiLight.direction );
		float hemiDiffuseWeight = 0.5 * dotNL + 0.5;
		vec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );
		return irradiance;
	}
#endif`,YRe=`#ifdef USE_ENVMAP
	vec3 getIBLIrradiance( const in vec3 normal ) {
		#ifdef ENVMAP_TYPE_CUBE_UV
			vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, envMapRotation * worldNormal, 1.0 );
			return PI * envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	vec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {
		#ifdef ENVMAP_TYPE_CUBE_UV
			vec3 reflectVec = reflect( - viewDir, normal );
			reflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );
			reflectVec = inverseTransformDirection( reflectVec, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, envMapRotation * reflectVec, roughness );
			return envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	#ifdef USE_ANISOTROPY
		vec3 getIBLAnisotropyRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness, const in vec3 bitangent, const in float anisotropy ) {
			#ifdef ENVMAP_TYPE_CUBE_UV
				vec3 bentNormal = cross( bitangent, viewDir );
				bentNormal = normalize( cross( bentNormal, bitangent ) );
				bentNormal = normalize( mix( bentNormal, normal, pow2( pow2( 1.0 - anisotropy * ( 1.0 - roughness ) ) ) ) );
				return getIBLRadiance( viewDir, bentNormal, roughness );
			#else
				return vec3( 0.0 );
			#endif
		}
	#endif
#endif`,XRe=`ToonMaterial material;
material.diffuseColor = diffuseColor.rgb;`,KRe=`varying vec3 vViewPosition;
struct ToonMaterial {
	vec3 diffuseColor;
};
void RE_Direct_Toon( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	vec3 irradiance = getGradientIrradiance( geometryNormal, directLight.direction ) * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Toon
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Toon`,ZRe=`BlinnPhongMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularColor = specular;
material.specularShininess = shininess;
material.specularStrength = specularStrength;`,JRe=`varying vec3 vViewPosition;
struct BlinnPhongMaterial {
	vec3 diffuseColor;
	vec3 specularColor;
	float specularShininess;
	float specularStrength;
};
void RE_Direct_BlinnPhong( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
	reflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometryViewDir, geometryNormal, material.specularColor, material.specularShininess ) * material.specularStrength;
}
void RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_BlinnPhong
#define RE_IndirectDiffuse		RE_IndirectDiffuse_BlinnPhong`,QRe=`PhysicalMaterial material;
material.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );
vec3 dxy = max( abs( dFdx( nonPerturbedNormal ) ), abs( dFdy( nonPerturbedNormal ) ) );
float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );
material.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;
material.roughness = min( material.roughness, 1.0 );
#ifdef IOR
	material.ior = ior;
	#ifdef USE_SPECULAR
		float specularIntensityFactor = specularIntensity;
		vec3 specularColorFactor = specularColor;
		#ifdef USE_SPECULAR_COLORMAP
			specularColorFactor *= texture2D( specularColorMap, vSpecularColorMapUv ).rgb;
		#endif
		#ifdef USE_SPECULAR_INTENSITYMAP
			specularIntensityFactor *= texture2D( specularIntensityMap, vSpecularIntensityMapUv ).a;
		#endif
		material.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );
	#else
		float specularIntensityFactor = 1.0;
		vec3 specularColorFactor = vec3( 1.0 );
		material.specularF90 = 1.0;
	#endif
	material.specularColor = mix( min( pow2( ( material.ior - 1.0 ) / ( material.ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );
#else
	material.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );
	material.specularF90 = 1.0;
#endif
#ifdef USE_CLEARCOAT
	material.clearcoat = clearcoat;
	material.clearcoatRoughness = clearcoatRoughness;
	material.clearcoatF0 = vec3( 0.04 );
	material.clearcoatF90 = 1.0;
	#ifdef USE_CLEARCOATMAP
		material.clearcoat *= texture2D( clearcoatMap, vClearcoatMapUv ).x;
	#endif
	#ifdef USE_CLEARCOAT_ROUGHNESSMAP
		material.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vClearcoatRoughnessMapUv ).y;
	#endif
	material.clearcoat = saturate( material.clearcoat );	material.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );
	material.clearcoatRoughness += geometryRoughness;
	material.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );
#endif
#ifdef USE_DISPERSION
	material.dispersion = dispersion;
#endif
#ifdef USE_IRIDESCENCE
	material.iridescence = iridescence;
	material.iridescenceIOR = iridescenceIOR;
	#ifdef USE_IRIDESCENCEMAP
		material.iridescence *= texture2D( iridescenceMap, vIridescenceMapUv ).r;
	#endif
	#ifdef USE_IRIDESCENCE_THICKNESSMAP
		material.iridescenceThickness = (iridescenceThicknessMaximum - iridescenceThicknessMinimum) * texture2D( iridescenceThicknessMap, vIridescenceThicknessMapUv ).g + iridescenceThicknessMinimum;
	#else
		material.iridescenceThickness = iridescenceThicknessMaximum;
	#endif
#endif
#ifdef USE_SHEEN
	material.sheenColor = sheenColor;
	#ifdef USE_SHEEN_COLORMAP
		material.sheenColor *= texture2D( sheenColorMap, vSheenColorMapUv ).rgb;
	#endif
	material.sheenRoughness = clamp( sheenRoughness, 0.07, 1.0 );
	#ifdef USE_SHEEN_ROUGHNESSMAP
		material.sheenRoughness *= texture2D( sheenRoughnessMap, vSheenRoughnessMapUv ).a;
	#endif
#endif
#ifdef USE_ANISOTROPY
	#ifdef USE_ANISOTROPYMAP
		mat2 anisotropyMat = mat2( anisotropyVector.x, anisotropyVector.y, - anisotropyVector.y, anisotropyVector.x );
		vec3 anisotropyPolar = texture2D( anisotropyMap, vAnisotropyMapUv ).rgb;
		vec2 anisotropyV = anisotropyMat * normalize( 2.0 * anisotropyPolar.rg - vec2( 1.0 ) ) * anisotropyPolar.b;
	#else
		vec2 anisotropyV = anisotropyVector;
	#endif
	material.anisotropy = length( anisotropyV );
	if( material.anisotropy == 0.0 ) {
		anisotropyV = vec2( 1.0, 0.0 );
	} else {
		anisotropyV /= material.anisotropy;
		material.anisotropy = saturate( material.anisotropy );
	}
	material.alphaT = mix( pow2( material.roughness ), 1.0, pow2( material.anisotropy ) );
	material.anisotropyT = tbn[ 0 ] * anisotropyV.x + tbn[ 1 ] * anisotropyV.y;
	material.anisotropyB = tbn[ 1 ] * anisotropyV.x - tbn[ 0 ] * anisotropyV.y;
#endif`,eMe=`struct PhysicalMaterial {
	vec3 diffuseColor;
	float roughness;
	vec3 specularColor;
	float specularF90;
	float dispersion;
	#ifdef USE_CLEARCOAT
		float clearcoat;
		float clearcoatRoughness;
		vec3 clearcoatF0;
		float clearcoatF90;
	#endif
	#ifdef USE_IRIDESCENCE
		float iridescence;
		float iridescenceIOR;
		float iridescenceThickness;
		vec3 iridescenceFresnel;
		vec3 iridescenceF0;
	#endif
	#ifdef USE_SHEEN
		vec3 sheenColor;
		float sheenRoughness;
	#endif
	#ifdef IOR
		float ior;
	#endif
	#ifdef USE_TRANSMISSION
		float transmission;
		float transmissionAlpha;
		float thickness;
		float attenuationDistance;
		vec3 attenuationColor;
	#endif
	#ifdef USE_ANISOTROPY
		float anisotropy;
		float alphaT;
		vec3 anisotropyT;
		vec3 anisotropyB;
	#endif
};
vec3 clearcoatSpecularDirect = vec3( 0.0 );
vec3 clearcoatSpecularIndirect = vec3( 0.0 );
vec3 sheenSpecularDirect = vec3( 0.0 );
vec3 sheenSpecularIndirect = vec3(0.0 );
vec3 Schlick_to_F0( const in vec3 f, const in float f90, const in float dotVH ) {
    float x = clamp( 1.0 - dotVH, 0.0, 1.0 );
    float x2 = x * x;
    float x5 = clamp( x * x2 * x2, 0.0, 0.9999 );
    return ( f - vec3( f90 ) * x5 ) / ( 1.0 - x5 );
}
float V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {
	float a2 = pow2( alpha );
	float gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );
	float gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );
	return 0.5 / max( gv + gl, EPSILON );
}
float D_GGX( const in float alpha, const in float dotNH ) {
	float a2 = pow2( alpha );
	float denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;
	return RECIPROCAL_PI * a2 / pow2( denom );
}
#ifdef USE_ANISOTROPY
	float V_GGX_SmithCorrelated_Anisotropic( const in float alphaT, const in float alphaB, const in float dotTV, const in float dotBV, const in float dotTL, const in float dotBL, const in float dotNV, const in float dotNL ) {
		float gv = dotNL * length( vec3( alphaT * dotTV, alphaB * dotBV, dotNV ) );
		float gl = dotNV * length( vec3( alphaT * dotTL, alphaB * dotBL, dotNL ) );
		float v = 0.5 / ( gv + gl );
		return saturate(v);
	}
	float D_GGX_Anisotropic( const in float alphaT, const in float alphaB, const in float dotNH, const in float dotTH, const in float dotBH ) {
		float a2 = alphaT * alphaB;
		highp vec3 v = vec3( alphaB * dotTH, alphaT * dotBH, a2 * dotNH );
		highp float v2 = dot( v, v );
		float w2 = a2 / v2;
		return RECIPROCAL_PI * a2 * pow2 ( w2 );
	}
#endif
#ifdef USE_CLEARCOAT
	vec3 BRDF_GGX_Clearcoat( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material) {
		vec3 f0 = material.clearcoatF0;
		float f90 = material.clearcoatF90;
		float roughness = material.clearcoatRoughness;
		float alpha = pow2( roughness );
		vec3 halfDir = normalize( lightDir + viewDir );
		float dotNL = saturate( dot( normal, lightDir ) );
		float dotNV = saturate( dot( normal, viewDir ) );
		float dotNH = saturate( dot( normal, halfDir ) );
		float dotVH = saturate( dot( viewDir, halfDir ) );
		vec3 F = F_Schlick( f0, f90, dotVH );
		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
		float D = D_GGX( alpha, dotNH );
		return F * ( V * D );
	}
#endif
vec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material ) {
	vec3 f0 = material.specularColor;
	float f90 = material.specularF90;
	float roughness = material.roughness;
	float alpha = pow2( roughness );
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( f0, f90, dotVH );
	#ifdef USE_IRIDESCENCE
		F = mix( F, material.iridescenceFresnel, material.iridescence );
	#endif
	#ifdef USE_ANISOTROPY
		float dotTL = dot( material.anisotropyT, lightDir );
		float dotTV = dot( material.anisotropyT, viewDir );
		float dotTH = dot( material.anisotropyT, halfDir );
		float dotBL = dot( material.anisotropyB, lightDir );
		float dotBV = dot( material.anisotropyB, viewDir );
		float dotBH = dot( material.anisotropyB, halfDir );
		float V = V_GGX_SmithCorrelated_Anisotropic( material.alphaT, alpha, dotTV, dotBV, dotTL, dotBL, dotNV, dotNL );
		float D = D_GGX_Anisotropic( material.alphaT, alpha, dotNH, dotTH, dotBH );
	#else
		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
		float D = D_GGX( alpha, dotNH );
	#endif
	return F * ( V * D );
}
vec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {
	const float LUT_SIZE = 64.0;
	const float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;
	const float LUT_BIAS = 0.5 / LUT_SIZE;
	float dotNV = saturate( dot( N, V ) );
	vec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );
	uv = uv * LUT_SCALE + LUT_BIAS;
	return uv;
}
float LTC_ClippedSphereFormFactor( const in vec3 f ) {
	float l = length( f );
	return max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );
}
vec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {
	float x = dot( v1, v2 );
	float y = abs( x );
	float a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;
	float b = 3.4175940 + ( 4.1616724 + y ) * y;
	float v = a / b;
	float theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;
	return cross( v1, v2 ) * theta_sintheta;
}
vec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {
	vec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];
	vec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];
	vec3 lightNormal = cross( v1, v2 );
	if( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );
	vec3 T1, T2;
	T1 = normalize( V - N * dot( V, N ) );
	T2 = - cross( N, T1 );
	mat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );
	vec3 coords[ 4 ];
	coords[ 0 ] = mat * ( rectCoords[ 0 ] - P );
	coords[ 1 ] = mat * ( rectCoords[ 1 ] - P );
	coords[ 2 ] = mat * ( rectCoords[ 2 ] - P );
	coords[ 3 ] = mat * ( rectCoords[ 3 ] - P );
	coords[ 0 ] = normalize( coords[ 0 ] );
	coords[ 1 ] = normalize( coords[ 1 ] );
	coords[ 2 ] = normalize( coords[ 2 ] );
	coords[ 3 ] = normalize( coords[ 3 ] );
	vec3 vectorFormFactor = vec3( 0.0 );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );
	float result = LTC_ClippedSphereFormFactor( vectorFormFactor );
	return vec3( result );
}
#if defined( USE_SHEEN )
float D_Charlie( float roughness, float dotNH ) {
	float alpha = pow2( roughness );
	float invAlpha = 1.0 / alpha;
	float cos2h = dotNH * dotNH;
	float sin2h = max( 1.0 - cos2h, 0.0078125 );
	return ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );
}
float V_Neubelt( float dotNV, float dotNL ) {
	return saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );
}
vec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float D = D_Charlie( sheenRoughness, dotNH );
	float V = V_Neubelt( dotNV, dotNL );
	return sheenColor * ( D * V );
}
#endif
float IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	float r2 = roughness * roughness;
	float a = roughness < 0.25 ? -339.2 * r2 + 161.4 * roughness - 25.9 : -8.48 * r2 + 14.3 * roughness - 9.95;
	float b = roughness < 0.25 ? 44.0 * r2 - 23.7 * roughness + 3.26 : 1.97 * r2 - 3.27 * roughness + 0.72;
	float DG = exp( a * dotNV + b ) + ( roughness < 0.25 ? 0.0 : 0.1 * ( roughness - 0.25 ) );
	return saturate( DG * RECIPROCAL_PI );
}
vec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	const vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );
	const vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );
	vec4 r = roughness * c0 + c1;
	float a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;
	vec2 fab = vec2( - 1.04, 1.04 ) * a004 + r.zw;
	return fab;
}
vec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	return specularColor * fab.x + specularF90 * fab.y;
}
#ifdef USE_IRIDESCENCE
void computeMultiscatteringIridescence( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float iridescence, const in vec3 iridescenceF0, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#else
void computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#endif
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	#ifdef USE_IRIDESCENCE
		vec3 Fr = mix( specularColor, iridescenceF0, iridescence );
	#else
		vec3 Fr = specularColor;
	#endif
	vec3 FssEss = Fr * fab.x + specularF90 * fab.y;
	float Ess = fab.x + fab.y;
	float Ems = 1.0 - Ess;
	vec3 Favg = Fr + ( 1.0 - Fr ) * 0.047619;	vec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );
	singleScatter += FssEss;
	multiScatter += Fms * Ems;
}
#if NUM_RECT_AREA_LIGHTS > 0
	void RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
		vec3 normal = geometryNormal;
		vec3 viewDir = geometryViewDir;
		vec3 position = geometryPosition;
		vec3 lightPos = rectAreaLight.position;
		vec3 halfWidth = rectAreaLight.halfWidth;
		vec3 halfHeight = rectAreaLight.halfHeight;
		vec3 lightColor = rectAreaLight.color;
		float roughness = material.roughness;
		vec3 rectCoords[ 4 ];
		rectCoords[ 0 ] = lightPos + halfWidth - halfHeight;		rectCoords[ 1 ] = lightPos - halfWidth - halfHeight;
		rectCoords[ 2 ] = lightPos - halfWidth + halfHeight;
		rectCoords[ 3 ] = lightPos + halfWidth + halfHeight;
		vec2 uv = LTC_Uv( normal, viewDir, roughness );
		vec4 t1 = texture2D( ltc_1, uv );
		vec4 t2 = texture2D( ltc_2, uv );
		mat3 mInv = mat3(
			vec3( t1.x, 0, t1.y ),
			vec3(    0, 1,    0 ),
			vec3( t1.z, 0, t1.w )
		);
		vec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );
		reflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );
		reflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );
	}
#endif
void RE_Direct_Physical( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	#ifdef USE_CLEARCOAT
		float dotNLcc = saturate( dot( geometryClearcoatNormal, directLight.direction ) );
		vec3 ccIrradiance = dotNLcc * directLight.color;
		clearcoatSpecularDirect += ccIrradiance * BRDF_GGX_Clearcoat( directLight.direction, geometryViewDir, geometryClearcoatNormal, material );
	#endif
	#ifdef USE_SHEEN
		sheenSpecularDirect += irradiance * BRDF_Sheen( directLight.direction, geometryViewDir, geometryNormal, material.sheenColor, material.sheenRoughness );
	#endif
	reflectedLight.directSpecular += irradiance * BRDF_GGX( directLight.direction, geometryViewDir, geometryNormal, material );
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {
	#ifdef USE_CLEARCOAT
		clearcoatSpecularIndirect += clearcoatRadiance * EnvironmentBRDF( geometryClearcoatNormal, geometryViewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );
	#endif
	#ifdef USE_SHEEN
		sheenSpecularIndirect += irradiance * material.sheenColor * IBLSheenBRDF( geometryNormal, geometryViewDir, material.sheenRoughness );
	#endif
	vec3 singleScattering = vec3( 0.0 );
	vec3 multiScattering = vec3( 0.0 );
	vec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;
	#ifdef USE_IRIDESCENCE
		computeMultiscatteringIridescence( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness, singleScattering, multiScattering );
	#else
		computeMultiscattering( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );
	#endif
	vec3 totalScattering = singleScattering + multiScattering;
	vec3 diffuse = material.diffuseColor * ( 1.0 - max( max( totalScattering.r, totalScattering.g ), totalScattering.b ) );
	reflectedLight.indirectSpecular += radiance * singleScattering;
	reflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;
	reflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;
}
#define RE_Direct				RE_Direct_Physical
#define RE_Direct_RectArea		RE_Direct_RectArea_Physical
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Physical
#define RE_IndirectSpecular		RE_IndirectSpecular_Physical
float computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {
	return saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );
}`,tMe=`
vec3 geometryPosition = - vViewPosition;
vec3 geometryNormal = normal;
vec3 geometryViewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );
vec3 geometryClearcoatNormal = vec3( 0.0 );
#ifdef USE_CLEARCOAT
	geometryClearcoatNormal = clearcoatNormal;
#endif
#ifdef USE_IRIDESCENCE
	float dotNVi = saturate( dot( normal, geometryViewDir ) );
	if ( material.iridescenceThickness == 0.0 ) {
		material.iridescence = 0.0;
	} else {
		material.iridescence = saturate( material.iridescence );
	}
	if ( material.iridescence > 0.0 ) {
		material.iridescenceFresnel = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.specularColor );
		material.iridescenceF0 = Schlick_to_F0( material.iridescenceFresnel, 1.0, dotNVi );
	}
#endif
IncidentLight directLight;
#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )
	PointLight pointLight;
	#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
		pointLight = pointLights[ i ];
		getPointLightInfo( pointLight, geometryPosition, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )
		pointLightShadow = pointLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowIntensity, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )
	SpotLight spotLight;
	vec4 spotColor;
	vec3 spotLightCoord;
	bool inSpotLightMap;
	#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {
		spotLight = spotLights[ i ];
		getSpotLightInfo( spotLight, geometryPosition, directLight );
		#if ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#define SPOT_LIGHT_MAP_INDEX UNROLLED_LOOP_INDEX
		#elif ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		#define SPOT_LIGHT_MAP_INDEX NUM_SPOT_LIGHT_MAPS
		#else
		#define SPOT_LIGHT_MAP_INDEX ( UNROLLED_LOOP_INDEX - NUM_SPOT_LIGHT_SHADOWS + NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#endif
		#if ( SPOT_LIGHT_MAP_INDEX < NUM_SPOT_LIGHT_MAPS )
			spotLightCoord = vSpotLightCoord[ i ].xyz / vSpotLightCoord[ i ].w;
			inSpotLightMap = all( lessThan( abs( spotLightCoord * 2. - 1. ), vec3( 1.0 ) ) );
			spotColor = texture2D( spotLightMap[ SPOT_LIGHT_MAP_INDEX ], spotLightCoord.xy );
			directLight.color = inSpotLightMap ? directLight.color * spotColor.rgb : directLight.color;
		#endif
		#undef SPOT_LIGHT_MAP_INDEX
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		spotLightShadow = spotLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowIntensity, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )
	DirectionalLight directionalLight;
	#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
		directionalLight = directionalLights[ i ];
		getDirectionalLightInfo( directionalLight, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )
		directionalLightShadow = directionalLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowIntensity, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )
	RectAreaLight rectAreaLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {
		rectAreaLight = rectAreaLights[ i ];
		RE_Direct_RectArea( rectAreaLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if defined( RE_IndirectDiffuse )
	vec3 iblIrradiance = vec3( 0.0 );
	vec3 irradiance = getAmbientLightIrradiance( ambientLightColor );
	#if defined( USE_LIGHT_PROBES )
		irradiance += getLightProbeIrradiance( lightProbe, geometryNormal );
	#endif
	#if ( NUM_HEMI_LIGHTS > 0 )
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {
			irradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometryNormal );
		}
		#pragma unroll_loop_end
	#endif
#endif
#if defined( RE_IndirectSpecular )
	vec3 radiance = vec3( 0.0 );
	vec3 clearcoatRadiance = vec3( 0.0 );
#endif`,nMe=`#if defined( RE_IndirectDiffuse )
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
		vec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;
		irradiance += lightMapIrradiance;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )
		iblIrradiance += getIBLIrradiance( geometryNormal );
	#endif
#endif
#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )
	#ifdef USE_ANISOTROPY
		radiance += getIBLAnisotropyRadiance( geometryViewDir, geometryNormal, material.roughness, material.anisotropyB, material.anisotropy );
	#else
		radiance += getIBLRadiance( geometryViewDir, geometryNormal, material.roughness );
	#endif
	#ifdef USE_CLEARCOAT
		clearcoatRadiance += getIBLRadiance( geometryViewDir, geometryClearcoatNormal, material.clearcoatRoughness );
	#endif
#endif`,iMe=`#if defined( RE_IndirectDiffuse )
	RE_IndirectDiffuse( irradiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
#endif
#if defined( RE_IndirectSpecular )
	RE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
#endif`,rMe=`#if defined( USE_LOGDEPTHBUF )
	gl_FragDepth = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;
#endif`,sMe=`#if defined( USE_LOGDEPTHBUF )
	uniform float logDepthBufFC;
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,aMe=`#ifdef USE_LOGDEPTHBUF
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,oMe=`#ifdef USE_LOGDEPTHBUF
	vFragDepth = 1.0 + gl_Position.w;
	vIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );
#endif`,cMe=`#ifdef USE_MAP
	vec4 sampledDiffuseColor = texture2D( map, vMapUv );
	#ifdef DECODE_VIDEO_TEXTURE
		sampledDiffuseColor = sRGBTransferEOTF( sampledDiffuseColor );
	#endif
	diffuseColor *= sampledDiffuseColor;
#endif`,lMe=`#ifdef USE_MAP
	uniform sampler2D map;
#endif`,uMe=`#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
	#if defined( USE_POINTS_UV )
		vec2 uv = vUv;
	#else
		vec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;
	#endif
#endif
#ifdef USE_MAP
	diffuseColor *= texture2D( map, uv );
#endif
#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, uv ).g;
#endif`,hMe=`#if defined( USE_POINTS_UV )
	varying vec2 vUv;
#else
	#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
		uniform mat3 uvTransform;
	#endif
#endif
#ifdef USE_MAP
	uniform sampler2D map;
#endif
#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,fMe=`float metalnessFactor = metalness;
#ifdef USE_METALNESSMAP
	vec4 texelMetalness = texture2D( metalnessMap, vMetalnessMapUv );
	metalnessFactor *= texelMetalness.b;
#endif`,dMe=`#ifdef USE_METALNESSMAP
	uniform sampler2D metalnessMap;
#endif`,pMe=`#ifdef USE_INSTANCING_MORPH
	float morphTargetInfluences[ MORPHTARGETS_COUNT ];
	float morphTargetBaseInfluence = texelFetch( morphTexture, ivec2( 0, gl_InstanceID ), 0 ).r;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		morphTargetInfluences[i] =  texelFetch( morphTexture, ivec2( i + 1, gl_InstanceID ), 0 ).r;
	}
#endif`,mMe=`#if defined( USE_MORPHCOLORS )
	vColor *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		#if defined( USE_COLOR_ALPHA )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ) * morphTargetInfluences[ i ];
		#elif defined( USE_COLOR )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ).rgb * morphTargetInfluences[ i ];
		#endif
	}
#endif`,gMe=`#ifdef USE_MORPHNORMALS
	objectNormal *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		if ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1 ).xyz * morphTargetInfluences[ i ];
	}
#endif`,vMe=`#ifdef USE_MORPHTARGETS
	#ifndef USE_INSTANCING_MORPH
		uniform float morphTargetBaseInfluence;
		uniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];
	#endif
	uniform sampler2DArray morphTargetsTexture;
	uniform ivec2 morphTargetsTextureSize;
	vec4 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset ) {
		int texelIndex = vertexIndex * MORPHTARGETS_TEXTURE_STRIDE + offset;
		int y = texelIndex / morphTargetsTextureSize.x;
		int x = texelIndex - y * morphTargetsTextureSize.x;
		ivec3 morphUV = ivec3( x, y, morphTargetIndex );
		return texelFetch( morphTargetsTexture, morphUV, 0 );
	}
#endif`,_Me=`#ifdef USE_MORPHTARGETS
	transformed *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		if ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0 ).xyz * morphTargetInfluences[ i ];
	}
#endif`,yMe=`float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;
#ifdef FLAT_SHADED
	vec3 fdx = dFdx( vViewPosition );
	vec3 fdy = dFdy( vViewPosition );
	vec3 normal = normalize( cross( fdx, fdy ) );
#else
	vec3 normal = normalize( vNormal );
	#ifdef DOUBLE_SIDED
		normal *= faceDirection;
	#endif
#endif
#if defined( USE_NORMALMAP_TANGENTSPACE ) || defined( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY )
	#ifdef USE_TANGENT
		mat3 tbn = mat3( normalize( vTangent ), normalize( vBitangent ), normal );
	#else
		mat3 tbn = getTangentFrame( - vViewPosition, normal,
		#if defined( USE_NORMALMAP )
			vNormalMapUv
		#elif defined( USE_CLEARCOAT_NORMALMAP )
			vClearcoatNormalMapUv
		#else
			vUv
		#endif
		);
	#endif
	#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )
		tbn[0] *= faceDirection;
		tbn[1] *= faceDirection;
	#endif
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	#ifdef USE_TANGENT
		mat3 tbn2 = mat3( normalize( vTangent ), normalize( vBitangent ), normal );
	#else
		mat3 tbn2 = getTangentFrame( - vViewPosition, normal, vClearcoatNormalMapUv );
	#endif
	#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )
		tbn2[0] *= faceDirection;
		tbn2[1] *= faceDirection;
	#endif
#endif
vec3 nonPerturbedNormal = normal;`,bMe=`#ifdef USE_NORMALMAP_OBJECTSPACE
	normal = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;
	#ifdef FLIP_SIDED
		normal = - normal;
	#endif
	#ifdef DOUBLE_SIDED
		normal = normal * faceDirection;
	#endif
	normal = normalize( normalMatrix * normal );
#elif defined( USE_NORMALMAP_TANGENTSPACE )
	vec3 mapN = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;
	mapN.xy *= normalScale;
	normal = normalize( tbn * mapN );
#elif defined( USE_BUMPMAP )
	normal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );
#endif`,EMe=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,SMe=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,TMe=`#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
	#ifdef USE_TANGENT
		vTangent = normalize( transformedTangent );
		vBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );
	#endif
#endif`,xMe=`#ifdef USE_NORMALMAP
	uniform sampler2D normalMap;
	uniform vec2 normalScale;
#endif
#ifdef USE_NORMALMAP_OBJECTSPACE
	uniform mat3 normalMatrix;
#endif
#if ! defined ( USE_TANGENT ) && ( defined ( USE_NORMALMAP_TANGENTSPACE ) || defined ( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY ) )
	mat3 getTangentFrame( vec3 eye_pos, vec3 surf_norm, vec2 uv ) {
		vec3 q0 = dFdx( eye_pos.xyz );
		vec3 q1 = dFdy( eye_pos.xyz );
		vec2 st0 = dFdx( uv.st );
		vec2 st1 = dFdy( uv.st );
		vec3 N = surf_norm;
		vec3 q1perp = cross( q1, N );
		vec3 q0perp = cross( N, q0 );
		vec3 T = q1perp * st0.x + q0perp * st1.x;
		vec3 B = q1perp * st0.y + q0perp * st1.y;
		float det = max( dot( T, T ), dot( B, B ) );
		float scale = ( det == 0.0 ) ? 0.0 : inversesqrt( det );
		return mat3( T * scale, B * scale, N );
	}
#endif`,wMe=`#ifdef USE_CLEARCOAT
	vec3 clearcoatNormal = nonPerturbedNormal;
#endif`,CMe=`#ifdef USE_CLEARCOAT_NORMALMAP
	vec3 clearcoatMapN = texture2D( clearcoatNormalMap, vClearcoatNormalMapUv ).xyz * 2.0 - 1.0;
	clearcoatMapN.xy *= clearcoatNormalScale;
	clearcoatNormal = normalize( tbn2 * clearcoatMapN );
#endif`,AMe=`#ifdef USE_CLEARCOATMAP
	uniform sampler2D clearcoatMap;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform sampler2D clearcoatNormalMap;
	uniform vec2 clearcoatNormalScale;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform sampler2D clearcoatRoughnessMap;
#endif`,RMe=`#ifdef USE_IRIDESCENCEMAP
	uniform sampler2D iridescenceMap;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform sampler2D iridescenceThicknessMap;
#endif`,MMe=`#ifdef OPAQUE
diffuseColor.a = 1.0;
#endif
#ifdef USE_TRANSMISSION
diffuseColor.a *= material.transmissionAlpha;
#endif
gl_FragColor = vec4( outgoingLight, diffuseColor.a );`,OMe=`vec3 packNormalToRGB( const in vec3 normal ) {
	return normalize( normal ) * 0.5 + 0.5;
}
vec3 unpackRGBToNormal( const in vec3 rgb ) {
	return 2.0 * rgb.xyz - 1.0;
}
const float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;const float ShiftRight8 = 1. / 256.;
const float Inv255 = 1. / 255.;
const vec4 PackFactors = vec4( 1.0, 256.0, 256.0 * 256.0, 256.0 * 256.0 * 256.0 );
const vec2 UnpackFactors2 = vec2( UnpackDownscale, 1.0 / PackFactors.g );
const vec3 UnpackFactors3 = vec3( UnpackDownscale / PackFactors.rg, 1.0 / PackFactors.b );
const vec4 UnpackFactors4 = vec4( UnpackDownscale / PackFactors.rgb, 1.0 / PackFactors.a );
vec4 packDepthToRGBA( const in float v ) {
	if( v <= 0.0 )
		return vec4( 0., 0., 0., 0. );
	if( v >= 1.0 )
		return vec4( 1., 1., 1., 1. );
	float vuf;
	float af = modf( v * PackFactors.a, vuf );
	float bf = modf( vuf * ShiftRight8, vuf );
	float gf = modf( vuf * ShiftRight8, vuf );
	return vec4( vuf * Inv255, gf * PackUpscale, bf * PackUpscale, af );
}
vec3 packDepthToRGB( const in float v ) {
	if( v <= 0.0 )
		return vec3( 0., 0., 0. );
	if( v >= 1.0 )
		return vec3( 1., 1., 1. );
	float vuf;
	float bf = modf( v * PackFactors.b, vuf );
	float gf = modf( vuf * ShiftRight8, vuf );
	return vec3( vuf * Inv255, gf * PackUpscale, bf );
}
vec2 packDepthToRG( const in float v ) {
	if( v <= 0.0 )
		return vec2( 0., 0. );
	if( v >= 1.0 )
		return vec2( 1., 1. );
	float vuf;
	float gf = modf( v * 256., vuf );
	return vec2( vuf * Inv255, gf );
}
float unpackRGBAToDepth( const in vec4 v ) {
	return dot( v, UnpackFactors4 );
}
float unpackRGBToDepth( const in vec3 v ) {
	return dot( v, UnpackFactors3 );
}
float unpackRGToDepth( const in vec2 v ) {
	return v.r * UnpackFactors2.r + v.g * UnpackFactors2.g;
}
vec4 pack2HalfToRGBA( const in vec2 v ) {
	vec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );
	return vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );
}
vec2 unpackRGBATo2Half( const in vec4 v ) {
	return vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );
}
float viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {
	return ( viewZ + near ) / ( near - far );
}
float orthographicDepthToViewZ( const in float depth, const in float near, const in float far ) {
	return depth * ( near - far ) - near;
}
float viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {
	return ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );
}
float perspectiveDepthToViewZ( const in float depth, const in float near, const in float far ) {
	return ( near * far ) / ( ( far - near ) * depth - far );
}`,NMe=`#ifdef PREMULTIPLIED_ALPHA
	gl_FragColor.rgb *= gl_FragColor.a;
#endif`,IMe=`vec4 mvPosition = vec4( transformed, 1.0 );
#ifdef USE_BATCHING
	mvPosition = batchingMatrix * mvPosition;
#endif
#ifdef USE_INSTANCING
	mvPosition = instanceMatrix * mvPosition;
#endif
mvPosition = modelViewMatrix * mvPosition;
gl_Position = projectionMatrix * mvPosition;`,kMe=`#ifdef DITHERING
	gl_FragColor.rgb = dithering( gl_FragColor.rgb );
#endif`,DMe=`#ifdef DITHERING
	vec3 dithering( vec3 color ) {
		float grid_position = rand( gl_FragCoord.xy );
		vec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );
		dither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );
		return color + dither_shift_RGB;
	}
#endif`,PMe=`float roughnessFactor = roughness;
#ifdef USE_ROUGHNESSMAP
	vec4 texelRoughness = texture2D( roughnessMap, vRoughnessMapUv );
	roughnessFactor *= texelRoughness.g;
#endif`,LMe=`#ifdef USE_ROUGHNESSMAP
	uniform sampler2D roughnessMap;
#endif`,UMe=`#if NUM_SPOT_LIGHT_COORDS > 0
	varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#if NUM_SPOT_LIGHT_MAPS > 0
	uniform sampler2D spotLightMap[ NUM_SPOT_LIGHT_MAPS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		uniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];
		struct SpotLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
	float texture2DCompare( sampler2D depths, vec2 uv, float compare ) {
		return step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );
	}
	vec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {
		return unpackRGBATo2Half( texture2D( shadow, uv ) );
	}
	float VSMShadow (sampler2D shadow, vec2 uv, float compare ){
		float occlusion = 1.0;
		vec2 distribution = texture2DDistribution( shadow, uv );
		float hard_shadow = step( compare , distribution.x );
		if (hard_shadow != 1.0 ) {
			float distance = compare - distribution.x ;
			float variance = max( 0.00000, distribution.y * distribution.y );
			float softness_probability = variance / (variance + distance * distance );			softness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );			occlusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );
		}
		return occlusion;
	}
	float getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowIntensity, float shadowBias, float shadowRadius, vec4 shadowCoord ) {
		float shadow = 1.0;
		shadowCoord.xyz /= shadowCoord.w;
		shadowCoord.z += shadowBias;
		bool inFrustum = shadowCoord.x >= 0.0 && shadowCoord.x <= 1.0 && shadowCoord.y >= 0.0 && shadowCoord.y <= 1.0;
		bool frustumTest = inFrustum && shadowCoord.z <= 1.0;
		if ( frustumTest ) {
		#if defined( SHADOWMAP_TYPE_PCF )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx0 = - texelSize.x * shadowRadius;
			float dy0 = - texelSize.y * shadowRadius;
			float dx1 = + texelSize.x * shadowRadius;
			float dy1 = + texelSize.y * shadowRadius;
			float dx2 = dx0 / 2.0;
			float dy2 = dy0 / 2.0;
			float dx3 = dx1 / 2.0;
			float dy3 = dy1 / 2.0;
			shadow = (
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )
			) * ( 1.0 / 17.0 );
		#elif defined( SHADOWMAP_TYPE_PCF_SOFT )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx = texelSize.x;
			float dy = texelSize.y;
			vec2 uv = shadowCoord.xy;
			vec2 f = fract( uv * shadowMapSize + 0.5 );
			uv -= f * texelSize;
			shadow = (
				texture2DCompare( shadowMap, uv, shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),
						  f.x ),
					 mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),
						  f.x ),
					 f.y )
			) * ( 1.0 / 9.0 );
		#elif defined( SHADOWMAP_TYPE_VSM )
			shadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );
		#else
			shadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );
		#endif
		}
		return mix( 1.0, shadow, shadowIntensity );
	}
	vec2 cubeToUV( vec3 v, float texelSizeY ) {
		vec3 absV = abs( v );
		float scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );
		absV *= scaleToCube;
		v *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );
		vec2 planar = v.xy;
		float almostATexel = 1.5 * texelSizeY;
		float almostOne = 1.0 - almostATexel;
		if ( absV.z >= almostOne ) {
			if ( v.z > 0.0 )
				planar.x = 4.0 - v.x;
		} else if ( absV.x >= almostOne ) {
			float signX = sign( v.x );
			planar.x = v.z * signX + 2.0 * signX;
		} else if ( absV.y >= almostOne ) {
			float signY = sign( v.y );
			planar.x = v.x + 2.0 * signY + 2.0;
			planar.y = v.z * signY - 2.0;
		}
		return vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );
	}
	float getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowIntensity, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {
		float shadow = 1.0;
		vec3 lightToPosition = shadowCoord.xyz;
		
		float lightToPositionLength = length( lightToPosition );
		if ( lightToPositionLength - shadowCameraFar <= 0.0 && lightToPositionLength - shadowCameraNear >= 0.0 ) {
			float dp = ( lightToPositionLength - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );			dp += shadowBias;
			vec3 bd3D = normalize( lightToPosition );
			vec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );
			#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )
				vec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;
				shadow = (
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )
				) * ( 1.0 / 9.0 );
			#else
				shadow = texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );
			#endif
		}
		return mix( 1.0, shadow, shadowIntensity );
	}
#endif`,BMe=`#if NUM_SPOT_LIGHT_COORDS > 0
	uniform mat4 spotLightMatrix[ NUM_SPOT_LIGHT_COORDS ];
	varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		struct SpotLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
#endif`,FMe=`#if ( defined( USE_SHADOWMAP ) && ( NUM_DIR_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0 ) ) || ( NUM_SPOT_LIGHT_COORDS > 0 )
	vec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
	vec4 shadowWorldPosition;
#endif
#if defined( USE_SHADOWMAP )
	#if NUM_DIR_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );
			vDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );
			vPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
#endif
#if NUM_SPOT_LIGHT_COORDS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_COORDS; i ++ ) {
		shadowWorldPosition = worldPosition;
		#if ( defined( USE_SHADOWMAP ) && UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
			shadowWorldPosition.xyz += shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias;
		#endif
		vSpotLightCoord[ i ] = spotLightMatrix[ i ] * shadowWorldPosition;
	}
	#pragma unroll_loop_end
#endif`,zMe=`float getShadowMask() {
	float shadow = 1.0;
	#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
		directionalLight = directionalLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowIntensity, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {
		spotLight = spotLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowIntensity, spotLight.shadowBias, spotLight.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
		pointLight = pointLightShadows[ i ];
		shadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowIntensity, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#endif
	return shadow;
}`,HMe=`#ifdef USE_SKINNING
	mat4 boneMatX = getBoneMatrix( skinIndex.x );
	mat4 boneMatY = getBoneMatrix( skinIndex.y );
	mat4 boneMatZ = getBoneMatrix( skinIndex.z );
	mat4 boneMatW = getBoneMatrix( skinIndex.w );
#endif`,jMe=`#ifdef USE_SKINNING
	uniform mat4 bindMatrix;
	uniform mat4 bindMatrixInverse;
	uniform highp sampler2D boneTexture;
	mat4 getBoneMatrix( const in float i ) {
		int size = textureSize( boneTexture, 0 ).x;
		int j = int( i ) * 4;
		int x = j % size;
		int y = j / size;
		vec4 v1 = texelFetch( boneTexture, ivec2( x, y ), 0 );
		vec4 v2 = texelFetch( boneTexture, ivec2( x + 1, y ), 0 );
		vec4 v3 = texelFetch( boneTexture, ivec2( x + 2, y ), 0 );
		vec4 v4 = texelFetch( boneTexture, ivec2( x + 3, y ), 0 );
		return mat4( v1, v2, v3, v4 );
	}
#endif`,VMe=`#ifdef USE_SKINNING
	vec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );
	vec4 skinned = vec4( 0.0 );
	skinned += boneMatX * skinVertex * skinWeight.x;
	skinned += boneMatY * skinVertex * skinWeight.y;
	skinned += boneMatZ * skinVertex * skinWeight.z;
	skinned += boneMatW * skinVertex * skinWeight.w;
	transformed = ( bindMatrixInverse * skinned ).xyz;
#endif`,GMe=`#ifdef USE_SKINNING
	mat4 skinMatrix = mat4( 0.0 );
	skinMatrix += skinWeight.x * boneMatX;
	skinMatrix += skinWeight.y * boneMatY;
	skinMatrix += skinWeight.z * boneMatZ;
	skinMatrix += skinWeight.w * boneMatW;
	skinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;
	objectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;
	#ifdef USE_TANGENT
		objectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#endif
#endif`,qMe=`float specularStrength;
#ifdef USE_SPECULARMAP
	vec4 texelSpecular = texture2D( specularMap, vSpecularMapUv );
	specularStrength = texelSpecular.r;
#else
	specularStrength = 1.0;
#endif`,$Me=`#ifdef USE_SPECULARMAP
	uniform sampler2D specularMap;
#endif`,WMe=`#if defined( TONE_MAPPING )
	gl_FragColor.rgb = toneMapping( gl_FragColor.rgb );
#endif`,YMe=`#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
uniform float toneMappingExposure;
vec3 LinearToneMapping( vec3 color ) {
	return saturate( toneMappingExposure * color );
}
vec3 ReinhardToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	return saturate( color / ( vec3( 1.0 ) + color ) );
}
vec3 CineonToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	color = max( vec3( 0.0 ), color - 0.004 );
	return pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );
}
vec3 RRTAndODTFit( vec3 v ) {
	vec3 a = v * ( v + 0.0245786 ) - 0.000090537;
	vec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;
	return a / b;
}
vec3 ACESFilmicToneMapping( vec3 color ) {
	const mat3 ACESInputMat = mat3(
		vec3( 0.59719, 0.07600, 0.02840 ),		vec3( 0.35458, 0.90834, 0.13383 ),
		vec3( 0.04823, 0.01566, 0.83777 )
	);
	const mat3 ACESOutputMat = mat3(
		vec3(  1.60475, -0.10208, -0.00327 ),		vec3( -0.53108,  1.10813, -0.07276 ),
		vec3( -0.07367, -0.00605,  1.07602 )
	);
	color *= toneMappingExposure / 0.6;
	color = ACESInputMat * color;
	color = RRTAndODTFit( color );
	color = ACESOutputMat * color;
	return saturate( color );
}
const mat3 LINEAR_REC2020_TO_LINEAR_SRGB = mat3(
	vec3( 1.6605, - 0.1246, - 0.0182 ),
	vec3( - 0.5876, 1.1329, - 0.1006 ),
	vec3( - 0.0728, - 0.0083, 1.1187 )
);
const mat3 LINEAR_SRGB_TO_LINEAR_REC2020 = mat3(
	vec3( 0.6274, 0.0691, 0.0164 ),
	vec3( 0.3293, 0.9195, 0.0880 ),
	vec3( 0.0433, 0.0113, 0.8956 )
);
vec3 agxDefaultContrastApprox( vec3 x ) {
	vec3 x2 = x * x;
	vec3 x4 = x2 * x2;
	return + 15.5 * x4 * x2
		- 40.14 * x4 * x
		+ 31.96 * x4
		- 6.868 * x2 * x
		+ 0.4298 * x2
		+ 0.1191 * x
		- 0.00232;
}
vec3 AgXToneMapping( vec3 color ) {
	const mat3 AgXInsetMatrix = mat3(
		vec3( 0.856627153315983, 0.137318972929847, 0.11189821299995 ),
		vec3( 0.0951212405381588, 0.761241990602591, 0.0767994186031903 ),
		vec3( 0.0482516061458583, 0.101439036467562, 0.811302368396859 )
	);
	const mat3 AgXOutsetMatrix = mat3(
		vec3( 1.1271005818144368, - 0.1413297634984383, - 0.14132976349843826 ),
		vec3( - 0.11060664309660323, 1.157823702216272, - 0.11060664309660294 ),
		vec3( - 0.016493938717834573, - 0.016493938717834257, 1.2519364065950405 )
	);
	const float AgxMinEv = - 12.47393;	const float AgxMaxEv = 4.026069;
	color *= toneMappingExposure;
	color = LINEAR_SRGB_TO_LINEAR_REC2020 * color;
	color = AgXInsetMatrix * color;
	color = max( color, 1e-10 );	color = log2( color );
	color = ( color - AgxMinEv ) / ( AgxMaxEv - AgxMinEv );
	color = clamp( color, 0.0, 1.0 );
	color = agxDefaultContrastApprox( color );
	color = AgXOutsetMatrix * color;
	color = pow( max( vec3( 0.0 ), color ), vec3( 2.2 ) );
	color = LINEAR_REC2020_TO_LINEAR_SRGB * color;
	color = clamp( color, 0.0, 1.0 );
	return color;
}
vec3 NeutralToneMapping( vec3 color ) {
	const float StartCompression = 0.8 - 0.04;
	const float Desaturation = 0.15;
	color *= toneMappingExposure;
	float x = min( color.r, min( color.g, color.b ) );
	float offset = x < 0.08 ? x - 6.25 * x * x : 0.04;
	color -= offset;
	float peak = max( color.r, max( color.g, color.b ) );
	if ( peak < StartCompression ) return color;
	float d = 1. - StartCompression;
	float newPeak = 1. - d * d / ( peak + d - StartCompression );
	color *= newPeak / peak;
	float g = 1. - 1. / ( Desaturation * ( peak - newPeak ) + 1. );
	return mix( color, vec3( newPeak ), g );
}
vec3 CustomToneMapping( vec3 color ) { return color; }`,XMe=`#ifdef USE_TRANSMISSION
	material.transmission = transmission;
	material.transmissionAlpha = 1.0;
	material.thickness = thickness;
	material.attenuationDistance = attenuationDistance;
	material.attenuationColor = attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		material.transmission *= texture2D( transmissionMap, vTransmissionMapUv ).r;
	#endif
	#ifdef USE_THICKNESSMAP
		material.thickness *= texture2D( thicknessMap, vThicknessMapUv ).g;
	#endif
	vec3 pos = vWorldPosition;
	vec3 v = normalize( cameraPosition - pos );
	vec3 n = inverseTransformDirection( normal, viewMatrix );
	vec4 transmitted = getIBLVolumeRefraction(
		n, v, material.roughness, material.diffuseColor, material.specularColor, material.specularF90,
		pos, modelMatrix, viewMatrix, projectionMatrix, material.dispersion, material.ior, material.thickness,
		material.attenuationColor, material.attenuationDistance );
	material.transmissionAlpha = mix( material.transmissionAlpha, transmitted.a, material.transmission );
	totalDiffuse = mix( totalDiffuse, transmitted.rgb, material.transmission );
#endif`,KMe=`#ifdef USE_TRANSMISSION
	uniform float transmission;
	uniform float thickness;
	uniform float attenuationDistance;
	uniform vec3 attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		uniform sampler2D transmissionMap;
	#endif
	#ifdef USE_THICKNESSMAP
		uniform sampler2D thicknessMap;
	#endif
	uniform vec2 transmissionSamplerSize;
	uniform sampler2D transmissionSamplerMap;
	uniform mat4 modelMatrix;
	uniform mat4 projectionMatrix;
	varying vec3 vWorldPosition;
	float w0( float a ) {
		return ( 1.0 / 6.0 ) * ( a * ( a * ( - a + 3.0 ) - 3.0 ) + 1.0 );
	}
	float w1( float a ) {
		return ( 1.0 / 6.0 ) * ( a *  a * ( 3.0 * a - 6.0 ) + 4.0 );
	}
	float w2( float a ){
		return ( 1.0 / 6.0 ) * ( a * ( a * ( - 3.0 * a + 3.0 ) + 3.0 ) + 1.0 );
	}
	float w3( float a ) {
		return ( 1.0 / 6.0 ) * ( a * a * a );
	}
	float g0( float a ) {
		return w0( a ) + w1( a );
	}
	float g1( float a ) {
		return w2( a ) + w3( a );
	}
	float h0( float a ) {
		return - 1.0 + w1( a ) / ( w0( a ) + w1( a ) );
	}
	float h1( float a ) {
		return 1.0 + w3( a ) / ( w2( a ) + w3( a ) );
	}
	vec4 bicubic( sampler2D tex, vec2 uv, vec4 texelSize, float lod ) {
		uv = uv * texelSize.zw + 0.5;
		vec2 iuv = floor( uv );
		vec2 fuv = fract( uv );
		float g0x = g0( fuv.x );
		float g1x = g1( fuv.x );
		float h0x = h0( fuv.x );
		float h1x = h1( fuv.x );
		float h0y = h0( fuv.y );
		float h1y = h1( fuv.y );
		vec2 p0 = ( vec2( iuv.x + h0x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
		vec2 p1 = ( vec2( iuv.x + h1x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
		vec2 p2 = ( vec2( iuv.x + h0x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
		vec2 p3 = ( vec2( iuv.x + h1x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
		return g0( fuv.y ) * ( g0x * textureLod( tex, p0, lod ) + g1x * textureLod( tex, p1, lod ) ) +
			g1( fuv.y ) * ( g0x * textureLod( tex, p2, lod ) + g1x * textureLod( tex, p3, lod ) );
	}
	vec4 textureBicubic( sampler2D sampler, vec2 uv, float lod ) {
		vec2 fLodSize = vec2( textureSize( sampler, int( lod ) ) );
		vec2 cLodSize = vec2( textureSize( sampler, int( lod + 1.0 ) ) );
		vec2 fLodSizeInv = 1.0 / fLodSize;
		vec2 cLodSizeInv = 1.0 / cLodSize;
		vec4 fSample = bicubic( sampler, uv, vec4( fLodSizeInv, fLodSize ), floor( lod ) );
		vec4 cSample = bicubic( sampler, uv, vec4( cLodSizeInv, cLodSize ), ceil( lod ) );
		return mix( fSample, cSample, fract( lod ) );
	}
	vec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {
		vec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );
		vec3 modelScale;
		modelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );
		modelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );
		modelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );
		return normalize( refractionVector ) * thickness * modelScale;
	}
	float applyIorToRoughness( const in float roughness, const in float ior ) {
		return roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );
	}
	vec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {
		float lod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );
		return textureBicubic( transmissionSamplerMap, fragCoord.xy, lod );
	}
	vec3 volumeAttenuation( const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {
		if ( isinf( attenuationDistance ) ) {
			return vec3( 1.0 );
		} else {
			vec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;
			vec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );			return transmittance;
		}
	}
	vec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,
		const in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,
		const in mat4 viewMatrix, const in mat4 projMatrix, const in float dispersion, const in float ior, const in float thickness,
		const in vec3 attenuationColor, const in float attenuationDistance ) {
		vec4 transmittedLight;
		vec3 transmittance;
		#ifdef USE_DISPERSION
			float halfSpread = ( ior - 1.0 ) * 0.025 * dispersion;
			vec3 iors = vec3( ior - halfSpread, ior, ior + halfSpread );
			for ( int i = 0; i < 3; i ++ ) {
				vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, iors[ i ], modelMatrix );
				vec3 refractedRayExit = position + transmissionRay;
				vec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );
				vec2 refractionCoords = ndcPos.xy / ndcPos.w;
				refractionCoords += 1.0;
				refractionCoords /= 2.0;
				vec4 transmissionSample = getTransmissionSample( refractionCoords, roughness, iors[ i ] );
				transmittedLight[ i ] = transmissionSample[ i ];
				transmittedLight.a += transmissionSample.a;
				transmittance[ i ] = diffuseColor[ i ] * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance )[ i ];
			}
			transmittedLight.a /= 3.0;
		#else
			vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );
			vec3 refractedRayExit = position + transmissionRay;
			vec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );
			vec2 refractionCoords = ndcPos.xy / ndcPos.w;
			refractionCoords += 1.0;
			refractionCoords /= 2.0;
			transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );
			transmittance = diffuseColor * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance );
		#endif
		vec3 attenuatedColor = transmittance * transmittedLight.rgb;
		vec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );
		float transmittanceFactor = ( transmittance.r + transmittance.g + transmittance.b ) / 3.0;
		return vec4( ( 1.0 - F ) * attenuatedColor, 1.0 - ( 1.0 - transmittedLight.a ) * transmittanceFactor );
	}
#endif`,ZMe=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	varying vec2 vUv;
#endif
#ifdef USE_MAP
	varying vec2 vMapUv;
#endif
#ifdef USE_ALPHAMAP
	varying vec2 vAlphaMapUv;
#endif
#ifdef USE_LIGHTMAP
	varying vec2 vLightMapUv;
#endif
#ifdef USE_AOMAP
	varying vec2 vAoMapUv;
#endif
#ifdef USE_BUMPMAP
	varying vec2 vBumpMapUv;
#endif
#ifdef USE_NORMALMAP
	varying vec2 vNormalMapUv;
#endif
#ifdef USE_EMISSIVEMAP
	varying vec2 vEmissiveMapUv;
#endif
#ifdef USE_METALNESSMAP
	varying vec2 vMetalnessMapUv;
#endif
#ifdef USE_ROUGHNESSMAP
	varying vec2 vRoughnessMapUv;
#endif
#ifdef USE_ANISOTROPYMAP
	varying vec2 vAnisotropyMapUv;
#endif
#ifdef USE_CLEARCOATMAP
	varying vec2 vClearcoatMapUv;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	varying vec2 vClearcoatNormalMapUv;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	varying vec2 vClearcoatRoughnessMapUv;
#endif
#ifdef USE_IRIDESCENCEMAP
	varying vec2 vIridescenceMapUv;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	varying vec2 vIridescenceThicknessMapUv;
#endif
#ifdef USE_SHEEN_COLORMAP
	varying vec2 vSheenColorMapUv;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	varying vec2 vSheenRoughnessMapUv;
#endif
#ifdef USE_SPECULARMAP
	varying vec2 vSpecularMapUv;
#endif
#ifdef USE_SPECULAR_COLORMAP
	varying vec2 vSpecularColorMapUv;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	varying vec2 vSpecularIntensityMapUv;
#endif
#ifdef USE_TRANSMISSIONMAP
	uniform mat3 transmissionMapTransform;
	varying vec2 vTransmissionMapUv;
#endif
#ifdef USE_THICKNESSMAP
	uniform mat3 thicknessMapTransform;
	varying vec2 vThicknessMapUv;
#endif`,JMe=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	varying vec2 vUv;
#endif
#ifdef USE_MAP
	uniform mat3 mapTransform;
	varying vec2 vMapUv;
#endif
#ifdef USE_ALPHAMAP
	uniform mat3 alphaMapTransform;
	varying vec2 vAlphaMapUv;
#endif
#ifdef USE_LIGHTMAP
	uniform mat3 lightMapTransform;
	varying vec2 vLightMapUv;
#endif
#ifdef USE_AOMAP
	uniform mat3 aoMapTransform;
	varying vec2 vAoMapUv;
#endif
#ifdef USE_BUMPMAP
	uniform mat3 bumpMapTransform;
	varying vec2 vBumpMapUv;
#endif
#ifdef USE_NORMALMAP
	uniform mat3 normalMapTransform;
	varying vec2 vNormalMapUv;
#endif
#ifdef USE_DISPLACEMENTMAP
	uniform mat3 displacementMapTransform;
	varying vec2 vDisplacementMapUv;
#endif
#ifdef USE_EMISSIVEMAP
	uniform mat3 emissiveMapTransform;
	varying vec2 vEmissiveMapUv;
#endif
#ifdef USE_METALNESSMAP
	uniform mat3 metalnessMapTransform;
	varying vec2 vMetalnessMapUv;
#endif
#ifdef USE_ROUGHNESSMAP
	uniform mat3 roughnessMapTransform;
	varying vec2 vRoughnessMapUv;
#endif
#ifdef USE_ANISOTROPYMAP
	uniform mat3 anisotropyMapTransform;
	varying vec2 vAnisotropyMapUv;
#endif
#ifdef USE_CLEARCOATMAP
	uniform mat3 clearcoatMapTransform;
	varying vec2 vClearcoatMapUv;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform mat3 clearcoatNormalMapTransform;
	varying vec2 vClearcoatNormalMapUv;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform mat3 clearcoatRoughnessMapTransform;
	varying vec2 vClearcoatRoughnessMapUv;
#endif
#ifdef USE_SHEEN_COLORMAP
	uniform mat3 sheenColorMapTransform;
	varying vec2 vSheenColorMapUv;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	uniform mat3 sheenRoughnessMapTransform;
	varying vec2 vSheenRoughnessMapUv;
#endif
#ifdef USE_IRIDESCENCEMAP
	uniform mat3 iridescenceMapTransform;
	varying vec2 vIridescenceMapUv;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform mat3 iridescenceThicknessMapTransform;
	varying vec2 vIridescenceThicknessMapUv;
#endif
#ifdef USE_SPECULARMAP
	uniform mat3 specularMapTransform;
	varying vec2 vSpecularMapUv;
#endif
#ifdef USE_SPECULAR_COLORMAP
	uniform mat3 specularColorMapTransform;
	varying vec2 vSpecularColorMapUv;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	uniform mat3 specularIntensityMapTransform;
	varying vec2 vSpecularIntensityMapUv;
#endif
#ifdef USE_TRANSMISSIONMAP
	uniform mat3 transmissionMapTransform;
	varying vec2 vTransmissionMapUv;
#endif
#ifdef USE_THICKNESSMAP
	uniform mat3 thicknessMapTransform;
	varying vec2 vThicknessMapUv;
#endif`,QMe=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	vUv = vec3( uv, 1 ).xy;
#endif
#ifdef USE_MAP
	vMapUv = ( mapTransform * vec3( MAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ALPHAMAP
	vAlphaMapUv = ( alphaMapTransform * vec3( ALPHAMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_LIGHTMAP
	vLightMapUv = ( lightMapTransform * vec3( LIGHTMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_AOMAP
	vAoMapUv = ( aoMapTransform * vec3( AOMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_BUMPMAP
	vBumpMapUv = ( bumpMapTransform * vec3( BUMPMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_NORMALMAP
	vNormalMapUv = ( normalMapTransform * vec3( NORMALMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_DISPLACEMENTMAP
	vDisplacementMapUv = ( displacementMapTransform * vec3( DISPLACEMENTMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_EMISSIVEMAP
	vEmissiveMapUv = ( emissiveMapTransform * vec3( EMISSIVEMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_METALNESSMAP
	vMetalnessMapUv = ( metalnessMapTransform * vec3( METALNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ROUGHNESSMAP
	vRoughnessMapUv = ( roughnessMapTransform * vec3( ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ANISOTROPYMAP
	vAnisotropyMapUv = ( anisotropyMapTransform * vec3( ANISOTROPYMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOATMAP
	vClearcoatMapUv = ( clearcoatMapTransform * vec3( CLEARCOATMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	vClearcoatNormalMapUv = ( clearcoatNormalMapTransform * vec3( CLEARCOAT_NORMALMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	vClearcoatRoughnessMapUv = ( clearcoatRoughnessMapTransform * vec3( CLEARCOAT_ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_IRIDESCENCEMAP
	vIridescenceMapUv = ( iridescenceMapTransform * vec3( IRIDESCENCEMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	vIridescenceThicknessMapUv = ( iridescenceThicknessMapTransform * vec3( IRIDESCENCE_THICKNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SHEEN_COLORMAP
	vSheenColorMapUv = ( sheenColorMapTransform * vec3( SHEEN_COLORMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	vSheenRoughnessMapUv = ( sheenRoughnessMapTransform * vec3( SHEEN_ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULARMAP
	vSpecularMapUv = ( specularMapTransform * vec3( SPECULARMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULAR_COLORMAP
	vSpecularColorMapUv = ( specularColorMapTransform * vec3( SPECULAR_COLORMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	vSpecularIntensityMapUv = ( specularIntensityMapTransform * vec3( SPECULAR_INTENSITYMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_TRANSMISSIONMAP
	vTransmissionMapUv = ( transmissionMapTransform * vec3( TRANSMISSIONMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_THICKNESSMAP
	vThicknessMapUv = ( thicknessMapTransform * vec3( THICKNESSMAP_UV, 1 ) ).xy;
#endif`,eOe=`#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION ) || NUM_SPOT_LIGHT_COORDS > 0
	vec4 worldPosition = vec4( transformed, 1.0 );
	#ifdef USE_BATCHING
		worldPosition = batchingMatrix * worldPosition;
	#endif
	#ifdef USE_INSTANCING
		worldPosition = instanceMatrix * worldPosition;
	#endif
	worldPosition = modelMatrix * worldPosition;
#endif`;const tOe=`varying vec2 vUv;
uniform mat3 uvTransform;
void main() {
	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	gl_Position = vec4( position.xy, 1.0, 1.0 );
}`,nOe=`uniform sampler2D t2D;
uniform float backgroundIntensity;
varying vec2 vUv;
void main() {
	vec4 texColor = texture2D( t2D, vUv );
	#ifdef DECODE_VIDEO_TEXTURE
		texColor = vec4( mix( pow( texColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), texColor.rgb * 0.0773993808, vec3( lessThanEqual( texColor.rgb, vec3( 0.04045 ) ) ) ), texColor.w );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,iOe=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,rOe=`#ifdef ENVMAP_TYPE_CUBE
	uniform samplerCube envMap;
#elif defined( ENVMAP_TYPE_CUBE_UV )
	uniform sampler2D envMap;
#endif
uniform float flipEnvMap;
uniform float backgroundBlurriness;
uniform float backgroundIntensity;
uniform mat3 backgroundRotation;
varying vec3 vWorldDirection;
#include <cube_uv_reflection_fragment>
void main() {
	#ifdef ENVMAP_TYPE_CUBE
		vec4 texColor = textureCube( envMap, backgroundRotation * vec3( flipEnvMap * vWorldDirection.x, vWorldDirection.yz ) );
	#elif defined( ENVMAP_TYPE_CUBE_UV )
		vec4 texColor = textureCubeUV( envMap, backgroundRotation * vWorldDirection, backgroundBlurriness );
	#else
		vec4 texColor = vec4( 0.0, 0.0, 0.0, 1.0 );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,sOe=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,aOe=`uniform samplerCube tCube;
uniform float tFlip;
uniform float opacity;
varying vec3 vWorldDirection;
void main() {
	vec4 texColor = textureCube( tCube, vec3( tFlip * vWorldDirection.x, vWorldDirection.yz ) );
	gl_FragColor = texColor;
	gl_FragColor.a *= opacity;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,oOe=`#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
varying vec2 vHighPrecisionZW;
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <skinbase_vertex>
	#include <morphinstance_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vHighPrecisionZW = gl_Position.zw;
}`,cOe=`#if DEPTH_PACKING == 3200
	uniform float opacity;
#endif
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
varying vec2 vHighPrecisionZW;
void main() {
	vec4 diffuseColor = vec4( 1.0 );
	#include <clipping_planes_fragment>
	#if DEPTH_PACKING == 3200
		diffuseColor.a = opacity;
	#endif
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <logdepthbuf_fragment>
	float fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;
	#if DEPTH_PACKING == 3200
		gl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );
	#elif DEPTH_PACKING == 3201
		gl_FragColor = packDepthToRGBA( fragCoordZ );
	#elif DEPTH_PACKING == 3202
		gl_FragColor = vec4( packDepthToRGB( fragCoordZ ), 1.0 );
	#elif DEPTH_PACKING == 3203
		gl_FragColor = vec4( packDepthToRG( fragCoordZ ), 0.0, 1.0 );
	#endif
}`,lOe=`#define DISTANCE
varying vec3 vWorldPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <skinbase_vertex>
	#include <morphinstance_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <clipping_planes_vertex>
	vWorldPosition = worldPosition.xyz;
}`,uOe=`#define DISTANCE
uniform vec3 referencePosition;
uniform float nearDistance;
uniform float farDistance;
varying vec3 vWorldPosition;
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <clipping_planes_pars_fragment>
void main () {
	vec4 diffuseColor = vec4( 1.0 );
	#include <clipping_planes_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	float dist = length( vWorldPosition - referencePosition );
	dist = ( dist - nearDistance ) / ( farDistance - nearDistance );
	dist = saturate( dist );
	gl_FragColor = packDepthToRGBA( dist );
}`,hOe=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
}`,fOe=`uniform sampler2D tEquirect;
varying vec3 vWorldDirection;
#include <common>
void main() {
	vec3 direction = normalize( vWorldDirection );
	vec2 sampleUV = equirectUv( direction );
	gl_FragColor = texture2D( tEquirect, sampleUV );
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,dOe=`uniform float scale;
attribute float lineDistance;
varying float vLineDistance;
#include <common>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	vLineDistance = scale * lineDistance;
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,pOe=`uniform vec3 diffuse;
uniform float opacity;
uniform float dashSize;
uniform float totalSize;
varying float vLineDistance;
#include <common>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	if ( mod( vLineDistance, totalSize ) > dashSize ) {
		discard;
	}
	vec3 outgoingLight = vec3( 0.0 );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,mOe=`#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinbase_vertex>
		#include <skinnormal_vertex>
		#include <defaultnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <fog_vertex>
}`,gOe=`uniform vec3 diffuse;
uniform float opacity;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
		reflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity * RECIPROCAL_PI;
	#else
		reflectedLight.indirectDiffuse += vec3( 1.0 );
	#endif
	#include <aomap_fragment>
	reflectedLight.indirectDiffuse *= diffuseColor.rgb;
	vec3 outgoingLight = reflectedLight.indirectDiffuse;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,vOe=`#define LAMBERT
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,_Oe=`#define LAMBERT
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_lambert_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_lambert_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,yOe=`#define MATCAP
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <displacementmap_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
	vViewPosition = - mvPosition.xyz;
}`,bOe=`#define MATCAP
uniform vec3 diffuse;
uniform float opacity;
uniform sampler2D matcap;
varying vec3 vViewPosition;
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	vec3 viewDir = normalize( vViewPosition );
	vec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );
	vec3 y = cross( viewDir, x );
	vec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;
	#ifdef USE_MATCAP
		vec4 matcapColor = texture2D( matcap, uv );
	#else
		vec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 );
	#endif
	vec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,EOe=`#define NORMAL
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	varying vec3 vViewPosition;
#endif
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphinstance_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	vViewPosition = - mvPosition.xyz;
#endif
}`,SOe=`#define NORMAL
uniform float opacity;
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	varying vec3 vViewPosition;
#endif
#include <packing>
#include <uv_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( 0.0, 0.0, 0.0, opacity );
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	gl_FragColor = vec4( packNormalToRGB( normal ), diffuseColor.a );
	#ifdef OPAQUE
		gl_FragColor.a = 1.0;
	#endif
}`,TOe=`#define PHONG
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphinstance_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,xOe=`#define PHONG
uniform vec3 diffuse;
uniform vec3 emissive;
uniform vec3 specular;
uniform float shininess;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_phong_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_phong_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,wOe=`#define STANDARD
varying vec3 vViewPosition;
#ifdef USE_TRANSMISSION
	varying vec3 vWorldPosition;
#endif
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
#ifdef USE_TRANSMISSION
	vWorldPosition = worldPosition.xyz;
#endif
}`,COe=`#define STANDARD
#ifdef PHYSICAL
	#define IOR
	#define USE_SPECULAR
#endif
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float roughness;
uniform float metalness;
uniform float opacity;
#ifdef IOR
	uniform float ior;
#endif
#ifdef USE_SPECULAR
	uniform float specularIntensity;
	uniform vec3 specularColor;
	#ifdef USE_SPECULAR_COLORMAP
		uniform sampler2D specularColorMap;
	#endif
	#ifdef USE_SPECULAR_INTENSITYMAP
		uniform sampler2D specularIntensityMap;
	#endif
#endif
#ifdef USE_CLEARCOAT
	uniform float clearcoat;
	uniform float clearcoatRoughness;
#endif
#ifdef USE_DISPERSION
	uniform float dispersion;
#endif
#ifdef USE_IRIDESCENCE
	uniform float iridescence;
	uniform float iridescenceIOR;
	uniform float iridescenceThicknessMinimum;
	uniform float iridescenceThicknessMaximum;
#endif
#ifdef USE_SHEEN
	uniform vec3 sheenColor;
	uniform float sheenRoughness;
	#ifdef USE_SHEEN_COLORMAP
		uniform sampler2D sheenColorMap;
	#endif
	#ifdef USE_SHEEN_ROUGHNESSMAP
		uniform sampler2D sheenRoughnessMap;
	#endif
#endif
#ifdef USE_ANISOTROPY
	uniform vec2 anisotropyVector;
	#ifdef USE_ANISOTROPYMAP
		uniform sampler2D anisotropyMap;
	#endif
#endif
varying vec3 vViewPosition;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <iridescence_fragment>
#include <cube_uv_reflection_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_physical_pars_fragment>
#include <fog_pars_fragment>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_physical_pars_fragment>
#include <transmission_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <clearcoat_pars_fragment>
#include <iridescence_pars_fragment>
#include <roughnessmap_pars_fragment>
#include <metalnessmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <roughnessmap_fragment>
	#include <metalnessmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <clearcoat_normal_fragment_begin>
	#include <clearcoat_normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_physical_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;
	vec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;
	#include <transmission_fragment>
	vec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;
	#ifdef USE_SHEEN
		float sheenEnergyComp = 1.0 - 0.157 * max3( material.sheenColor );
		outgoingLight = outgoingLight * sheenEnergyComp + sheenSpecularDirect + sheenSpecularIndirect;
	#endif
	#ifdef USE_CLEARCOAT
		float dotNVcc = saturate( dot( geometryClearcoatNormal, geometryViewDir ) );
		vec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );
		outgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + ( clearcoatSpecularDirect + clearcoatSpecularIndirect ) * material.clearcoat;
	#endif
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,AOe=`#define TOON
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,ROe=`#define TOON
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <gradientmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_toon_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_toon_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,MOe=`uniform float size;
uniform float scale;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
#ifdef USE_POINTS_UV
	varying vec2 vUv;
	uniform mat3 uvTransform;
#endif
void main() {
	#ifdef USE_POINTS_UV
		vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	#endif
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	gl_PointSize = size;
	#ifdef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );
	#endif
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <fog_vertex>
}`,OOe=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <color_pars_fragment>
#include <map_particle_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	#include <logdepthbuf_fragment>
	#include <map_particle_fragment>
	#include <color_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,NOe=`#include <common>
#include <batching_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <shadowmap_pars_vertex>
void main() {
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphinstance_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,IOe=`uniform vec3 color;
uniform float opacity;
#include <common>
#include <packing>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <logdepthbuf_pars_fragment>
#include <shadowmap_pars_fragment>
#include <shadowmask_pars_fragment>
void main() {
	#include <logdepthbuf_fragment>
	gl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
}`,kOe=`uniform float rotation;
uniform vec2 center;
#include <common>
#include <uv_pars_vertex>
#include <fog_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	vec4 mvPosition = modelViewMatrix[ 3 ];
	vec2 scale = vec2( length( modelMatrix[ 0 ].xyz ), length( modelMatrix[ 1 ].xyz ) );
	#ifndef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) scale *= - mvPosition.z;
	#endif
	vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;
	vec2 rotatedPosition;
	rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;
	rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;
	mvPosition.xy += rotatedPosition;
	gl_Position = projectionMatrix * mvPosition;
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,DOe=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
}`,ir={alphahash_fragment:nRe,alphahash_pars_fragment:iRe,alphamap_fragment:rRe,alphamap_pars_fragment:sRe,alphatest_fragment:aRe,alphatest_pars_fragment:oRe,aomap_fragment:cRe,aomap_pars_fragment:lRe,batching_pars_vertex:uRe,batching_vertex:hRe,begin_vertex:fRe,beginnormal_vertex:dRe,bsdfs:pRe,iridescence_fragment:mRe,bumpmap_pars_fragment:gRe,clipping_planes_fragment:vRe,clipping_planes_pars_fragment:_Re,clipping_planes_pars_vertex:yRe,clipping_planes_vertex:bRe,color_fragment:ERe,color_pars_fragment:SRe,color_pars_vertex:TRe,color_vertex:xRe,common:wRe,cube_uv_reflection_fragment:CRe,defaultnormal_vertex:ARe,displacementmap_pars_vertex:RRe,displacementmap_vertex:MRe,emissivemap_fragment:ORe,emissivemap_pars_fragment:NRe,colorspace_fragment:IRe,colorspace_pars_fragment:kRe,envmap_fragment:DRe,envmap_common_pars_fragment:PRe,envmap_pars_fragment:LRe,envmap_pars_vertex:URe,envmap_physical_pars_fragment:YRe,envmap_vertex:BRe,fog_vertex:FRe,fog_pars_vertex:zRe,fog_fragment:HRe,fog_pars_fragment:jRe,gradientmap_pars_fragment:VRe,lightmap_pars_fragment:GRe,lights_lambert_fragment:qRe,lights_lambert_pars_fragment:$Re,lights_pars_begin:WRe,lights_toon_fragment:XRe,lights_toon_pars_fragment:KRe,lights_phong_fragment:ZRe,lights_phong_pars_fragment:JRe,lights_physical_fragment:QRe,lights_physical_pars_fragment:eMe,lights_fragment_begin:tMe,lights_fragment_maps:nMe,lights_fragment_end:iMe,logdepthbuf_fragment:rMe,logdepthbuf_pars_fragment:sMe,logdepthbuf_pars_vertex:aMe,logdepthbuf_vertex:oMe,map_fragment:cMe,map_pars_fragment:lMe,map_particle_fragment:uMe,map_particle_pars_fragment:hMe,metalnessmap_fragment:fMe,metalnessmap_pars_fragment:dMe,morphinstance_vertex:pMe,morphcolor_vertex:mMe,morphnormal_vertex:gMe,morphtarget_pars_vertex:vMe,morphtarget_vertex:_Me,normal_fragment_begin:yMe,normal_fragment_maps:bMe,normal_pars_fragment:EMe,normal_pars_vertex:SMe,normal_vertex:TMe,normalmap_pars_fragment:xMe,clearcoat_normal_fragment_begin:wMe,clearcoat_normal_fragment_maps:CMe,clearcoat_pars_fragment:AMe,iridescence_pars_fragment:RMe,opaque_fragment:MMe,packing:OMe,premultiplied_alpha_fragment:NMe,project_vertex:IMe,dithering_fragment:kMe,dithering_pars_fragment:DMe,roughnessmap_fragment:PMe,roughnessmap_pars_fragment:LMe,shadowmap_pars_fragment:UMe,shadowmap_pars_vertex:BMe,shadowmap_vertex:FMe,shadowmask_pars_fragment:zMe,skinbase_vertex:HMe,skinning_pars_vertex:jMe,skinning_vertex:VMe,skinnormal_vertex:GMe,specularmap_fragment:qMe,specularmap_pars_fragment:$Me,tonemapping_fragment:WMe,tonemapping_pars_fragment:YMe,transmission_fragment:XMe,transmission_pars_fragment:KMe,uv_pars_fragment:ZMe,uv_pars_vertex:JMe,uv_vertex:QMe,worldpos_vertex:eOe,background_vert:tOe,background_frag:nOe,backgroundCube_vert:iOe,backgroundCube_frag:rOe,cube_vert:sOe,cube_frag:aOe,depth_vert:oOe,depth_frag:cOe,distanceRGBA_vert:lOe,distanceRGBA_frag:uOe,equirect_vert:hOe,equirect_frag:fOe,linedashed_vert:dOe,linedashed_frag:pOe,meshbasic_vert:mOe,meshbasic_frag:gOe,meshlambert_vert:vOe,meshlambert_frag:_Oe,meshmatcap_vert:yOe,meshmatcap_frag:bOe,meshnormal_vert:EOe,meshnormal_frag:SOe,meshphong_vert:TOe,meshphong_frag:xOe,meshphysical_vert:wOe,meshphysical_frag:COe,meshtoon_vert:AOe,meshtoon_frag:ROe,points_vert:MOe,points_frag:OOe,shadow_vert:NOe,shadow_frag:IOe,sprite_vert:kOe,sprite_frag:DOe},vn={common:{diffuse:{value:new yn(16777215)},opacity:{value:1},map:{value:null},mapTransform:{value:new Ji},alphaMap:{value:null},alphaMapTransform:{value:new Ji},alphaTest:{value:0}},specularmap:{specularMap:{value:null},specularMapTransform:{value:new Ji}},envmap:{envMap:{value:null},envMapRotation:{value:new Ji},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1},aoMapTransform:{value:new Ji}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1},lightMapTransform:{value:new Ji}},bumpmap:{bumpMap:{value:null},bumpMapTransform:{value:new Ji},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalMapTransform:{value:new Ji},normalScale:{value:new Rt(1,1)}},displacementmap:{displacementMap:{value:null},displacementMapTransform:{value:new Ji},displacementScale:{value:1},displacementBias:{value:0}},emissivemap:{emissiveMap:{value:null},emissiveMapTransform:{value:new Ji}},metalnessmap:{metalnessMap:{value:null},metalnessMapTransform:{value:new Ji}},roughnessmap:{roughnessMap:{value:null},roughnessMapTransform:{value:new Ji}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new yn(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotLightMap:{value:[]},spotShadowMap:{value:[]},spotLightMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new yn(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaMapTransform:{value:new Ji},alphaTest:{value:0},uvTransform:{value:new Ji}},sprite:{diffuse:{value:new yn(16777215)},opacity:{value:1},center:{value:new Rt(.5,.5)},rotation:{value:0},map:{value:null},mapTransform:{value:new Ji},alphaMap:{value:null},alphaMapTransform:{value:new Ji},alphaTest:{value:0}}},im={basic:{uniforms:Yu([vn.common,vn.specularmap,vn.envmap,vn.aomap,vn.lightmap,vn.fog]),vertexShader:ir.meshbasic_vert,fragmentShader:ir.meshbasic_frag},lambert:{uniforms:Yu([vn.common,vn.specularmap,vn.envmap,vn.aomap,vn.lightmap,vn.emissivemap,vn.bumpmap,vn.normalmap,vn.displacementmap,vn.fog,vn.lights,{emissive:{value:new yn(0)}}]),vertexShader:ir.meshlambert_vert,fragmentShader:ir.meshlambert_frag},phong:{uniforms:Yu([vn.common,vn.specularmap,vn.envmap,vn.aomap,vn.lightmap,vn.emissivemap,vn.bumpmap,vn.normalmap,vn.displacementmap,vn.fog,vn.lights,{emissive:{value:new yn(0)},specular:{value:new yn(1118481)},shininess:{value:30}}]),vertexShader:ir.meshphong_vert,fragmentShader:ir.meshphong_frag},standard:{uniforms:Yu([vn.common,vn.envmap,vn.aomap,vn.lightmap,vn.emissivemap,vn.bumpmap,vn.normalmap,vn.displacementmap,vn.roughnessmap,vn.metalnessmap,vn.fog,vn.lights,{emissive:{value:new yn(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:ir.meshphysical_vert,fragmentShader:ir.meshphysical_frag},toon:{uniforms:Yu([vn.common,vn.aomap,vn.lightmap,vn.emissivemap,vn.bumpmap,vn.normalmap,vn.displacementmap,vn.gradientmap,vn.fog,vn.lights,{emissive:{value:new yn(0)}}]),vertexShader:ir.meshtoon_vert,fragmentShader:ir.meshtoon_frag},matcap:{uniforms:Yu([vn.common,vn.bumpmap,vn.normalmap,vn.displacementmap,vn.fog,{matcap:{value:null}}]),vertexShader:ir.meshmatcap_vert,fragmentShader:ir.meshmatcap_frag},points:{uniforms:Yu([vn.points,vn.fog]),vertexShader:ir.points_vert,fragmentShader:ir.points_frag},dashed:{uniforms:Yu([vn.common,vn.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:ir.linedashed_vert,fragmentShader:ir.linedashed_frag},depth:{uniforms:Yu([vn.common,vn.displacementmap]),vertexShader:ir.depth_vert,fragmentShader:ir.depth_frag},normal:{uniforms:Yu([vn.common,vn.bumpmap,vn.normalmap,vn.displacementmap,{opacity:{value:1}}]),vertexShader:ir.meshnormal_vert,fragmentShader:ir.meshnormal_frag},sprite:{uniforms:Yu([vn.sprite,vn.fog]),vertexShader:ir.sprite_vert,fragmentShader:ir.sprite_frag},background:{uniforms:{uvTransform:{value:new Ji},t2D:{value:null},backgroundIntensity:{value:1}},vertexShader:ir.background_vert,fragmentShader:ir.background_frag},backgroundCube:{uniforms:{envMap:{value:null},flipEnvMap:{value:-1},backgroundBlurriness:{value:0},backgroundIntensity:{value:1},backgroundRotation:{value:new Ji}},vertexShader:ir.backgroundCube_vert,fragmentShader:ir.backgroundCube_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:ir.cube_vert,fragmentShader:ir.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:ir.equirect_vert,fragmentShader:ir.equirect_frag},distanceRGBA:{uniforms:Yu([vn.common,vn.displacementmap,{referencePosition:{value:new Ae},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:ir.distanceRGBA_vert,fragmentShader:ir.distanceRGBA_frag},shadow:{uniforms:Yu([vn.lights,vn.fog,{color:{value:new yn(0)},opacity:{value:1}}]),vertexShader:ir.shadow_vert,fragmentShader:ir.shadow_frag}};im.physical={uniforms:Yu([im.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatMapTransform:{value:new Ji},clearcoatNormalMap:{value:null},clearcoatNormalMapTransform:{value:new Ji},clearcoatNormalScale:{value:new Rt(1,1)},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatRoughnessMapTransform:{value:new Ji},dispersion:{value:0},iridescence:{value:0},iridescenceMap:{value:null},iridescenceMapTransform:{value:new Ji},iridescenceIOR:{value:1.3},iridescenceThicknessMinimum:{value:100},iridescenceThicknessMaximum:{value:400},iridescenceThicknessMap:{value:null},iridescenceThicknessMapTransform:{value:new Ji},sheen:{value:0},sheenColor:{value:new yn(0)},sheenColorMap:{value:null},sheenColorMapTransform:{value:new Ji},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},sheenRoughnessMapTransform:{value:new Ji},transmission:{value:0},transmissionMap:{value:null},transmissionMapTransform:{value:new Ji},transmissionSamplerSize:{value:new Rt},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},thicknessMapTransform:{value:new Ji},attenuationDistance:{value:0},attenuationColor:{value:new yn(0)},specularColor:{value:new yn(1,1,1)},specularColorMap:{value:null},specularColorMapTransform:{value:new Ji},specularIntensity:{value:1},specularIntensityMap:{value:null},specularIntensityMapTransform:{value:new Ji},anisotropyVector:{value:new Rt},anisotropyMap:{value:null},anisotropyMapTransform:{value:new Ji}}]),vertexShader:ir.meshphysical_vert,fragmentShader:ir.meshphysical_frag};const kD={r:0,b:0,g:0},RS=new rf,POe=new Ni;function LOe(t,e,n,i,r,s,a){const o=new yn(0);let c=s===!0?0:1,l,u,h=null,f=0,d=null;function p(T){let x=T.isScene===!0?T.background:null;return x&&x.isTexture&&(x=(T.backgroundBlurriness>0?n:e).get(x)),x}function g(T){let x=!1;const M=p(T);M===null?v(o,c):M&&M.isColor&&(v(M,1),x=!0);const R=t.xr.getEnvironmentBlendMode();R==="additive"?i.buffers.color.setClear(0,0,0,1,a):R==="alpha-blend"&&i.buffers.color.setClear(0,0,0,0,a),(t.autoClear||x)&&(i.buffers.depth.setTest(!0),i.buffers.depth.setMask(!0),i.buffers.color.setMask(!0),t.clear(t.autoClearColor,t.autoClearDepth,t.autoClearStencil))}function y(T,x){const M=p(x);M&&(M.isCubeTexture||M.mapping===vA)?(u===void 0&&(u=new jo(new d1(1,1,1),new Hc({name:"BackgroundCubeMaterial",uniforms:EC(im.backgroundCube.uniforms),vertexShader:im.backgroundCube.vertexShader,fragmentShader:im.backgroundCube.fragmentShader,side:Bc,depthTest:!1,depthWrite:!1,fog:!1,allowOverride:!1})),u.geometry.deleteAttribute("normal"),u.geometry.deleteAttribute("uv"),u.onBeforeRender=function(R,I,k){this.matrixWorld.copyPosition(k.matrixWorld)},Object.defineProperty(u.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),r.update(u)),RS.copy(x.backgroundRotation),RS.x*=-1,RS.y*=-1,RS.z*=-1,M.isCubeTexture&&M.isRenderTargetTexture===!1&&(RS.y*=-1,RS.z*=-1),u.material.uniforms.envMap.value=M,u.material.uniforms.flipEnvMap.value=M.isCubeTexture&&M.isRenderTargetTexture===!1?-1:1,u.material.uniforms.backgroundBlurriness.value=x.backgroundBlurriness,u.material.uniforms.backgroundIntensity.value=x.backgroundIntensity,u.material.uniforms.backgroundRotation.value.setFromMatrix4(POe.makeRotationFromEuler(RS)),u.material.toneMapped=Ur.getTransfer(M.colorSpace)!==As,(h!==M||f!==M.version||d!==t.toneMapping)&&(u.material.needsUpdate=!0,h=M,f=M.version,d=t.toneMapping),u.layers.enableAll(),T.unshift(u,u.geometry,u.material,0,0,null)):M&&M.isTexture&&(l===void 0&&(l=new jo(new EA(2,2),new Hc({name:"BackgroundMaterial",uniforms:EC(im.background.uniforms),vertexShader:im.background.vertexShader,fragmentShader:im.background.fragmentShader,side:Zg,depthTest:!1,depthWrite:!1,fog:!1,allowOverride:!1})),l.geometry.deleteAttribute("normal"),Object.defineProperty(l.material,"map",{get:function(){return this.uniforms.t2D.value}}),r.update(l)),l.material.uniforms.t2D.value=M,l.material.uniforms.backgroundIntensity.value=x.backgroundIntensity,l.material.toneMapped=Ur.getTransfer(M.colorSpace)!==As,M.matrixAutoUpdate===!0&&M.updateMatrix(),l.material.uniforms.uvTransform.value.copy(M.matrix),(h!==M||f!==M.version||d!==t.toneMapping)&&(l.material.needsUpdate=!0,h=M,f=M.version,d=t.toneMapping),l.layers.enableAll(),T.unshift(l,l.geometry,l.material,0,0,null))}function v(T,x){T.getRGB(kD,kce(t)),i.buffers.color.setClear(kD.r,kD.g,kD.b,x,a)}function b(){u!==void 0&&(u.geometry.dispose(),u.material.dispose(),u=void 0),l!==void 0&&(l.geometry.dispose(),l.material.dispose(),l=void 0)}return{getClearColor:function(){return o},setClearColor:function(T,x=1){o.set(T),c=x,v(o,c)},getClearAlpha:function(){return c},setClearAlpha:function(T){c=T,v(o,c)},render:g,addToRenderList:y,dispose:b}}function UOe(t,e){const n=t.getParameter(t.MAX_VERTEX_ATTRIBS),i={},r=f(null);let s=r,a=!1;function o(U,G,$,q,Y){let ie=!1;const V=h(q,$,G);s!==V&&(s=V,l(s.object)),ie=d(U,q,$,Y),ie&&p(U,q,$,Y),Y!==null&&e.update(Y,t.ELEMENT_ARRAY_BUFFER),(ie||a)&&(a=!1,x(U,G,$,q),Y!==null&&t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,e.get(Y).buffer))}function c(){return t.createVertexArray()}function l(U){return t.bindVertexArray(U)}function u(U){return t.deleteVertexArray(U)}function h(U,G,$){const q=$.wireframe===!0;let Y=i[U.id];Y===void 0&&(Y={},i[U.id]=Y);let ie=Y[G.id];ie===void 0&&(ie={},Y[G.id]=ie);let V=ie[q];return V===void 0&&(V=f(c()),ie[q]=V),V}function f(U){const G=[],$=[],q=[];for(let Y=0;Y<n;Y++)G[Y]=0,$[Y]=0,q[Y]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:G,enabledAttributes:$,attributeDivisors:q,object:U,attributes:{},index:null}}function d(U,G,$,q){const Y=s.attributes,ie=G.attributes;let V=0;const J=$.getAttributes();for(const X in J)if(J[X].location>=0){const oe=Y[X];let fe=ie[X];if(fe===void 0&&(X==="instanceMatrix"&&U.instanceMatrix&&(fe=U.instanceMatrix),X==="instanceColor"&&U.instanceColor&&(fe=U.instanceColor)),oe===void 0||oe.attribute!==fe||fe&&oe.data!==fe.data)return!0;V++}return s.attributesNum!==V||s.index!==q}function p(U,G,$,q){const Y={},ie=G.attributes;let V=0;const J=$.getAttributes();for(const X in J)if(J[X].location>=0){let oe=ie[X];oe===void 0&&(X==="instanceMatrix"&&U.instanceMatrix&&(oe=U.instanceMatrix),X==="instanceColor"&&U.instanceColor&&(oe=U.instanceColor));const fe={};fe.attribute=oe,oe&&oe.data&&(fe.data=oe.data),Y[X]=fe,V++}s.attributes=Y,s.attributesNum=V,s.index=q}function g(){const U=s.newAttributes;for(let G=0,$=U.length;G<$;G++)U[G]=0}function y(U){v(U,0)}function v(U,G){const $=s.newAttributes,q=s.enabledAttributes,Y=s.attributeDivisors;$[U]=1,q[U]===0&&(t.enableVertexAttribArray(U),q[U]=1),Y[U]!==G&&(t.vertexAttribDivisor(U,G),Y[U]=G)}function b(){const U=s.newAttributes,G=s.enabledAttributes;for(let $=0,q=G.length;$<q;$++)G[$]!==U[$]&&(t.disableVertexAttribArray($),G[$]=0)}function T(U,G,$,q,Y,ie,V){V===!0?t.vertexAttribIPointer(U,G,$,Y,ie):t.vertexAttribPointer(U,G,$,q,Y,ie)}function x(U,G,$,q){g();const Y=q.attributes,ie=$.getAttributes(),V=G.defaultAttributeValues;for(const J in ie){const X=ie[J];if(X.location>=0){let ee=Y[J];if(ee===void 0&&(J==="instanceMatrix"&&U.instanceMatrix&&(ee=U.instanceMatrix),J==="instanceColor"&&U.instanceColor&&(ee=U.instanceColor)),ee!==void 0){const oe=ee.normalized,fe=ee.itemSize,Re=e.get(ee);if(Re===void 0)continue;const He=Re.buffer,Te=Re.type,Le=Re.bytesPerElement,we=Te===t.INT||Te===t.UNSIGNED_INT||ee.gpuType===pB;if(ee.isInterleavedBufferAttribute){const Ce=ee.data,ke=Ce.stride,St=ee.offset;if(Ce.isInstancedInterleavedBuffer){for(let Mt=0;Mt<X.locationSize;Mt++)v(X.location+Mt,Ce.meshPerAttribute);U.isInstancedMesh!==!0&&q._maxInstanceCount===void 0&&(q._maxInstanceCount=Ce.meshPerAttribute*Ce.count)}else for(let Mt=0;Mt<X.locationSize;Mt++)y(X.location+Mt);t.bindBuffer(t.ARRAY_BUFFER,He);for(let Mt=0;Mt<X.locationSize;Mt++)T(X.location+Mt,fe/X.locationSize,Te,oe,ke*Le,(St+fe/X.locationSize*Mt)*Le,we)}else{if(ee.isInstancedBufferAttribute){for(let Ce=0;Ce<X.locationSize;Ce++)v(X.location+Ce,ee.meshPerAttribute);U.isInstancedMesh!==!0&&q._maxInstanceCount===void 0&&(q._maxInstanceCount=ee.meshPerAttribute*ee.count)}else for(let Ce=0;Ce<X.locationSize;Ce++)y(X.location+Ce);t.bindBuffer(t.ARRAY_BUFFER,He);for(let Ce=0;Ce<X.locationSize;Ce++)T(X.location+Ce,fe/X.locationSize,Te,oe,fe*Le,fe/X.locationSize*Ce*Le,we)}}else if(V!==void 0){const oe=V[J];if(oe!==void 0)switch(oe.length){case 2:t.vertexAttrib2fv(X.location,oe);break;case 3:t.vertexAttrib3fv(X.location,oe);break;case 4:t.vertexAttrib4fv(X.location,oe);break;default:t.vertexAttrib1fv(X.location,oe)}}}}b()}function M(){k();for(const U in i){const G=i[U];for(const $ in G){const q=G[$];for(const Y in q)u(q[Y].object),delete q[Y];delete G[$]}delete i[U]}}function R(U){if(i[U.id]===void 0)return;const G=i[U.id];for(const $ in G){const q=G[$];for(const Y in q)u(q[Y].object),delete q[Y];delete G[$]}delete i[U.id]}function I(U){for(const G in i){const $=i[G];if($[U.id]===void 0)continue;const q=$[U.id];for(const Y in q)u(q[Y].object),delete q[Y];delete $[U.id]}}function k(){P(),a=!0,s!==r&&(s=r,l(s.object))}function P(){r.geometry=null,r.program=null,r.wireframe=!1}return{setup:o,reset:k,resetDefaultState:P,dispose:M,releaseStatesOfGeometry:R,releaseStatesOfProgram:I,initAttributes:g,enableAttribute:y,disableUnusedAttributes:b}}function BOe(t,e,n){let i;function r(l){i=l}function s(l,u){t.drawArrays(i,l,u),n.update(u,i,1)}function a(l,u,h){h!==0&&(t.drawArraysInstanced(i,l,u,h),n.update(u,i,h))}function o(l,u,h){if(h===0)return;e.get("WEBGL_multi_draw").multiDrawArraysWEBGL(i,l,0,u,0,h);let d=0;for(let p=0;p<h;p++)d+=u[p];n.update(d,i,1)}function c(l,u,h,f){if(h===0)return;const d=e.get("WEBGL_multi_draw");if(d===null)for(let p=0;p<l.length;p++)a(l[p],u[p],f[p]);else{d.multiDrawArraysInstancedWEBGL(i,l,0,u,0,f,0,h);let p=0;for(let g=0;g<h;g++)p+=u[g]*f[g];n.update(p,i,1)}}this.setMode=r,this.render=s,this.renderInstances=a,this.renderMultiDraw=o,this.renderMultiDrawInstances=c}function FOe(t,e,n,i){let r;function s(){if(r!==void 0)return r;if(e.has("EXT_texture_filter_anisotropic")===!0){const I=e.get("EXT_texture_filter_anisotropic");r=t.getParameter(I.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else r=0;return r}function a(I){return!(I!==fu&&i.convert(I)!==t.getParameter(t.IMPLEMENTATION_COLOR_READ_FORMAT))}function o(I){const k=I===lE&&(e.has("EXT_color_buffer_half_float")||e.has("EXT_color_buffer_float"));return!(I!==El&&i.convert(I)!==t.getParameter(t.IMPLEMENTATION_COLOR_READ_TYPE)&&I!==hu&&!k)}function c(I){if(I==="highp"){if(t.getShaderPrecisionFormat(t.VERTEX_SHADER,t.HIGH_FLOAT).precision>0&&t.getShaderPrecisionFormat(t.FRAGMENT_SHADER,t.HIGH_FLOAT).precision>0)return"highp";I="mediump"}return I==="mediump"&&t.getShaderPrecisionFormat(t.VERTEX_SHADER,t.MEDIUM_FLOAT).precision>0&&t.getShaderPrecisionFormat(t.FRAGMENT_SHADER,t.MEDIUM_FLOAT).precision>0?"mediump":"lowp"}let l=n.precision!==void 0?n.precision:"highp";const u=c(l);u!==l&&(console.warn("THREE.WebGLRenderer:",l,"not supported, using",u,"instead."),l=u);const h=n.logarithmicDepthBuffer===!0,f=n.reverseDepthBuffer===!0&&e.has("EXT_clip_control"),d=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS),p=t.getParameter(t.MAX_VERTEX_TEXTURE_IMAGE_UNITS),g=t.getParameter(t.MAX_TEXTURE_SIZE),y=t.getParameter(t.MAX_CUBE_MAP_TEXTURE_SIZE),v=t.getParameter(t.MAX_VERTEX_ATTRIBS),b=t.getParameter(t.MAX_VERTEX_UNIFORM_VECTORS),T=t.getParameter(t.MAX_VARYING_VECTORS),x=t.getParameter(t.MAX_FRAGMENT_UNIFORM_VECTORS),M=p>0,R=t.getParameter(t.MAX_SAMPLES);return{isWebGL2:!0,getMaxAnisotropy:s,getMaxPrecision:c,textureFormatReadable:a,textureTypeReadable:o,precision:l,logarithmicDepthBuffer:h,reverseDepthBuffer:f,maxTextures:d,maxVertexTextures:p,maxTextureSize:g,maxCubemapSize:y,maxAttributes:v,maxVertexUniforms:b,maxVaryings:T,maxFragmentUniforms:x,vertexTextures:M,maxSamples:R}}function zOe(t){const e=this;let n=null,i=0,r=!1,s=!1;const a=new qy,o=new Ji,c={value:null,needsUpdate:!1};this.uniform=c,this.numPlanes=0,this.numIntersection=0,this.init=function(h,f){const d=h.length!==0||f||i!==0||r;return r=f,i=h.length,d},this.beginShadows=function(){s=!0,u(null)},this.endShadows=function(){s=!1},this.setGlobalState=function(h,f){n=u(h,f,0)},this.setState=function(h,f,d){const p=h.clippingPlanes,g=h.clipIntersection,y=h.clipShadows,v=t.get(h);if(!r||p===null||p.length===0||s&&!y)s?u(null):l();else{const b=s?0:i,T=b*4;let x=v.clippingState||null;c.value=x,x=u(p,f,T,d);for(let M=0;M!==T;++M)x[M]=n[M];v.clippingState=x,this.numIntersection=g?this.numPlanes:0,this.numPlanes+=b}};function l(){c.value!==n&&(c.value=n,c.needsUpdate=i>0),e.numPlanes=i,e.numIntersection=0}function u(h,f,d,p){const g=h!==null?h.length:0;let y=null;if(g!==0){if(y=c.value,p!==!0||y===null){const v=d+g*4,b=f.matrixWorldInverse;o.getNormalMatrix(b),(y===null||y.length<v)&&(y=new Float32Array(v));for(let T=0,x=d;T!==g;++T,x+=4)a.copy(h[T]).applyMatrix4(b,o),a.normal.toArray(y,x),y[x+3]=a.constant}c.value=y,c.needsUpdate=!0}return e.numPlanes=g,e.numIntersection=0,y}}function HOe(t){let e=new WeakMap;function n(a,o){return o===lO?a.mapping=m_:o===uO&&(a.mapping=Vb),a}function i(a){if(a&&a.isTexture){const o=a.mapping;if(o===lO||o===uO)if(e.has(a)){const c=e.get(a).texture;return n(c,a.mapping)}else{const c=a.image;if(c&&c.height>0){const l=new Lce(c.height);return l.fromEquirectangularTexture(t,a),e.set(a,l),a.addEventListener("dispose",r),n(l.texture,a.mapping)}else return null}}return a}function r(a){const o=a.target;o.removeEventListener("dispose",r);const c=e.get(o);c!==void 0&&(e.delete(o),c.dispose())}function s(){e=new WeakMap}return{get:i,dispose:s}}const mw=4,_J=[.125,.215,.35,.446,.526,.582],JS=20,dH=new hI,yJ=new yn;let pH=null,mH=0,gH=0,vH=!1;const jS=(1+Math.sqrt(5))/2,Nx=1/jS,bJ=[new Ae(-jS,Nx,0),new Ae(jS,Nx,0),new Ae(-Nx,0,jS),new Ae(Nx,0,jS),new Ae(0,jS,-Nx),new Ae(0,jS,Nx),new Ae(-1,1,-1),new Ae(1,1,-1),new Ae(-1,1,1),new Ae(1,1,1)],jOe=new Ae;class xV{constructor(e){this._renderer=e,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._lodPlanes=[],this._sizeLods=[],this._sigmas=[],this._blurMaterial=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._compileMaterial(this._blurMaterial)}fromScene(e,n=0,i=.1,r=100,s={}){const{size:a=256,position:o=jOe}=s;pH=this._renderer.getRenderTarget(),mH=this._renderer.getActiveCubeFace(),gH=this._renderer.getActiveMipmapLevel(),vH=this._renderer.xr.enabled,this._renderer.xr.enabled=!1,this._setSize(a);const c=this._allocateTargets();return c.depthBuffer=!0,this._sceneToCubeUV(e,i,r,c,o),n>0&&this._blur(c,0,0,n),this._applyPMREM(c),this._cleanup(c),c}fromEquirectangular(e,n=null){return this._fromTexture(e,n)}fromCubemap(e,n=null){return this._fromTexture(e,n)}compileCubemapShader(){this._cubemapMaterial===null&&(this._cubemapMaterial=TJ(),this._compileMaterial(this._cubemapMaterial))}compileEquirectangularShader(){this._equirectMaterial===null&&(this._equirectMaterial=SJ(),this._compileMaterial(this._equirectMaterial))}dispose(){this._dispose(),this._cubemapMaterial!==null&&this._cubemapMaterial.dispose(),this._equirectMaterial!==null&&this._equirectMaterial.dispose()}_setSize(e){this._lodMax=Math.floor(Math.log2(e)),this._cubeSize=Math.pow(2,this._lodMax)}_dispose(){this._blurMaterial!==null&&this._blurMaterial.dispose(),this._pingPongRenderTarget!==null&&this._pingPongRenderTarget.dispose();for(let e=0;e<this._lodPlanes.length;e++)this._lodPlanes[e].dispose()}_cleanup(e){this._renderer.setRenderTarget(pH,mH,gH),this._renderer.xr.enabled=vH,e.scissorTest=!1,DD(e,0,0,e.width,e.height)}_fromTexture(e,n){e.mapping===m_||e.mapping===Vb?this._setSize(e.image.length===0?16:e.image[0].width||e.image[0].image.width):this._setSize(e.image.width/4),pH=this._renderer.getRenderTarget(),mH=this._renderer.getActiveCubeFace(),gH=this._renderer.getActiveMipmapLevel(),vH=this._renderer.xr.enabled,this._renderer.xr.enabled=!1;const i=n||this._allocateTargets();return this._textureToCubeUV(e,i),this._applyPMREM(i),this._cleanup(i),i}_allocateTargets(){const e=3*Math.max(this._cubeSize,112),n=4*this._cubeSize,i={magFilter:Ea,minFilter:Ea,generateMipmaps:!1,type:lE,format:fu,colorSpace:Qg,depthBuffer:!1},r=EJ(e,n,i);if(this._pingPongRenderTarget===null||this._pingPongRenderTarget.width!==e||this._pingPongRenderTarget.height!==n){this._pingPongRenderTarget!==null&&this._dispose(),this._pingPongRenderTarget=EJ(e,n,i);const{_lodMax:s}=this;({sizeLods:this._sizeLods,lodPlanes:this._lodPlanes,sigmas:this._sigmas}=VOe(s)),this._blurMaterial=GOe(s,e,n)}return r}_compileMaterial(e){const n=new jo(this._lodPlanes[0],e);this._renderer.compile(n,dH)}_sceneToCubeUV(e,n,i,r,s){const c=new Pc(90,1,n,i),l=[1,-1,1,1,1,1],u=[1,1,1,-1,-1,-1],h=this._renderer,f=h.autoClear,d=h.toneMapping;h.getClearColor(yJ),h.toneMapping=hm,h.autoClear=!1;const p=new fE({name:"PMREM.Background",side:Bc,depthWrite:!1,depthTest:!1}),g=new jo(new d1,p);let y=!1;const v=e.background;v?v.isColor&&(p.color.copy(v),e.background=null,y=!0):(p.color.copy(yJ),y=!0);for(let b=0;b<6;b++){const T=b%3;T===0?(c.up.set(0,l[b],0),c.position.set(s.x,s.y,s.z),c.lookAt(s.x+u[b],s.y,s.z)):T===1?(c.up.set(0,0,l[b]),c.position.set(s.x,s.y,s.z),c.lookAt(s.x,s.y+u[b],s.z)):(c.up.set(0,l[b],0),c.position.set(s.x,s.y,s.z),c.lookAt(s.x,s.y,s.z+u[b]));const x=this._cubeSize;DD(r,T*x,b>2?x:0,x,x),h.setRenderTarget(r),y&&h.render(g,c),h.render(e,c)}g.geometry.dispose(),g.material.dispose(),h.toneMapping=d,h.autoClear=f,e.background=v}_textureToCubeUV(e,n){const i=this._renderer,r=e.mapping===m_||e.mapping===Vb;r?(this._cubemapMaterial===null&&(this._cubemapMaterial=TJ()),this._cubemapMaterial.uniforms.flipEnvMap.value=e.isRenderTargetTexture===!1?-1:1):this._equirectMaterial===null&&(this._equirectMaterial=SJ());const s=r?this._cubemapMaterial:this._equirectMaterial,a=new jo(this._lodPlanes[0],s),o=s.uniforms;o.envMap.value=e;const c=this._cubeSize;DD(n,0,0,3*c,2*c),i.setRenderTarget(n),i.render(a,dH)}_applyPMREM(e){const n=this._renderer,i=n.autoClear;n.autoClear=!1;const r=this._lodPlanes.length;for(let s=1;s<r;s++){const a=Math.sqrt(this._sigmas[s]*this._sigmas[s]-this._sigmas[s-1]*this._sigmas[s-1]),o=bJ[(r-s-1)%bJ.length];this._blur(e,s-1,s,a,o)}n.autoClear=i}_blur(e,n,i,r,s){const a=this._pingPongRenderTarget;this._halfBlur(e,a,n,i,r,"latitudinal",s),this._halfBlur(a,e,i,i,r,"longitudinal",s)}_halfBlur(e,n,i,r,s,a,o){const c=this._renderer,l=this._blurMaterial;a!=="latitudinal"&&a!=="longitudinal"&&console.error("blur direction must be either latitudinal or longitudinal!");const u=3,h=new jo(this._lodPlanes[r],l),f=l.uniforms,d=this._sizeLods[i]-1,p=isFinite(s)?Math.PI/(2*d):2*Math.PI/(2*JS-1),g=s/p,y=isFinite(s)?1+Math.floor(u*g):JS;y>JS&&console.warn(`sigmaRadians, ${s}, is too large and will clip, as it requested ${y} samples when the maximum is set to ${JS}`);const v=[];let b=0;for(let I=0;I<JS;++I){const k=I/g,P=Math.exp(-k*k/2);v.push(P),I===0?b+=P:I<y&&(b+=2*P)}for(let I=0;I<v.length;I++)v[I]=v[I]/b;f.envMap.value=e.texture,f.samples.value=y,f.weights.value=v,f.latitudinal.value=a==="latitudinal",o&&(f.poleAxis.value=o);const{_lodMax:T}=this;f.dTheta.value=p,f.mipInt.value=T-i;const x=this._sizeLods[r],M=3*x*(r>T-mw?r-T+mw:0),R=4*(this._cubeSize-x);DD(n,M,R,3*x,2*x),c.setRenderTarget(n),c.render(h,dH)}}function VOe(t){const e=[],n=[],i=[];let r=t;const s=t-mw+1+_J.length;for(let a=0;a<s;a++){const o=Math.pow(2,r);n.push(o);let c=1/o;a>t-mw?c=_J[a-t+mw-1]:a===0&&(c=0),i.push(c);const l=1/(o-2),u=-l,h=1+l,f=[u,u,h,u,h,h,u,u,h,h,u,h],d=6,p=6,g=3,y=2,v=1,b=new Float32Array(g*p*d),T=new Float32Array(y*p*d),x=new Float32Array(v*p*d);for(let R=0;R<d;R++){const I=R%3*2/3-1,k=R>2?0:-1,P=[I,k,0,I+2/3,k,0,I+2/3,k+1,0,I,k,0,I+2/3,k+1,0,I,k+1,0];b.set(P,g*p*R),T.set(f,y*p*R);const U=[R,R,R,R,R,R];x.set(U,v*p*R)}const M=new Qi;M.setAttribute("position",new rr(b,g)),M.setAttribute("uv",new rr(T,y)),M.setAttribute("faceIndex",new rr(x,v)),e.push(M),r>mw&&r--}return{lodPlanes:e,sizeLods:n,sigmas:i}}function EJ(t,e,n){const i=new Vl(t,e,n);return i.texture.mapping=vA,i.texture.name="PMREM.cubeUv",i.scissorTest=!0,i}function DD(t,e,n,i,r){t.viewport.set(e,n,i,r),t.scissor.set(e,n,i,r)}function GOe(t,e,n){const i=new Float32Array(JS),r=new Ae(0,1,0);return new Hc({name:"SphericalGaussianBlur",defines:{n:JS,CUBEUV_TEXEL_WIDTH:1/e,CUBEUV_TEXEL_HEIGHT:1/n,CUBEUV_MAX_MIP:`${t}.0`},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:i},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:r}},vertexShader:U7(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;
			uniform int samples;
			uniform float weights[ n ];
			uniform bool latitudinal;
			uniform float dTheta;
			uniform float mipInt;
			uniform vec3 poleAxis;

			#define ENVMAP_TYPE_CUBE_UV
			#include <cube_uv_reflection_fragment>

			vec3 getSample( float theta, vec3 axis ) {

				float cosTheta = cos( theta );
				// Rodrigues' axis-angle rotation
				vec3 sampleDirection = vOutputDirection * cosTheta
					+ cross( axis, vOutputDirection ) * sin( theta )
					+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );

				return bilinearCubeUV( envMap, sampleDirection, mipInt );

			}

			void main() {

				vec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );

				if ( all( equal( axis, vec3( 0.0 ) ) ) ) {

					axis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );

				}

				axis = normalize( axis );

				gl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );
				gl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );

				for ( int i = 1; i < n; i++ ) {

					if ( i >= samples ) {

						break;

					}

					float theta = dTheta * float( i );
					gl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );
					gl_FragColor.rgb += weights[ i ] * getSample( theta, axis );

				}

			}
		`,blending:lp,depthTest:!1,depthWrite:!1})}function SJ(){return new Hc({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null}},vertexShader:U7(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;

			#include <common>

			void main() {

				vec3 outputDirection = normalize( vOutputDirection );
				vec2 uv = equirectUv( outputDirection );

				gl_FragColor = vec4( texture2D ( envMap, uv ).rgb, 1.0 );

			}
		`,blending:lp,depthTest:!1,depthWrite:!1})}function TJ(){return new Hc({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},flipEnvMap:{value:-1}},vertexShader:U7(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			uniform float flipEnvMap;

			varying vec3 vOutputDirection;

			uniform samplerCube envMap;

			void main() {

				gl_FragColor = textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );

			}
		`,blending:lp,depthTest:!1,depthWrite:!1})}function U7(){return`

		precision mediump float;
		precision mediump int;

		attribute float faceIndex;

		varying vec3 vOutputDirection;

		// RH coordinate system; PMREM face-indexing convention
		vec3 getDirection( vec2 uv, float face ) {

			uv = 2.0 * uv - 1.0;

			vec3 direction = vec3( uv, 1.0 );

			if ( face == 0.0 ) {

				direction = direction.zyx; // ( 1, v, u ) pos x

			} else if ( face == 1.0 ) {

				direction = direction.xzy;
				direction.xz *= -1.0; // ( -u, 1, -v ) pos y

			} else if ( face == 2.0 ) {

				direction.x *= -1.0; // ( -u, v, 1 ) pos z

			} else if ( face == 3.0 ) {

				direction = direction.zyx;
				direction.xz *= -1.0; // ( -1, v, -u ) neg x

			} else if ( face == 4.0 ) {

				direction = direction.xzy;
				direction.xy *= -1.0; // ( -u, -1, v ) neg y

			} else if ( face == 5.0 ) {

				direction.z *= -1.0; // ( u, v, -1 ) neg z

			}

			return direction;

		}

		void main() {

			vOutputDirection = getDirection( uv, faceIndex );
			gl_Position = vec4( position, 1.0 );

		}
	`}function qOe(t){let e=new WeakMap,n=null;function i(o){if(o&&o.isTexture){const c=o.mapping,l=c===lO||c===uO,u=c===m_||c===Vb;if(l||u){let h=e.get(o);const f=h!==void 0?h.texture.pmremVersion:0;if(o.isRenderTargetTexture&&o.pmremVersion!==f)return n===null&&(n=new xV(t)),h=l?n.fromEquirectangular(o,h):n.fromCubemap(o,h),h.texture.pmremVersion=o.pmremVersion,e.set(o,h),h.texture;if(h!==void 0)return h.texture;{const d=o.image;return l&&d&&d.height>0||u&&d&&r(d)?(n===null&&(n=new xV(t)),h=l?n.fromEquirectangular(o):n.fromCubemap(o),h.texture.pmremVersion=o.pmremVersion,e.set(o,h),o.addEventListener("dispose",s),h.texture):null}}}return o}function r(o){let c=0;const l=6;for(let u=0;u<l;u++)o[u]!==void 0&&c++;return c===l}function s(o){const c=o.target;c.removeEventListener("dispose",s);const l=e.get(c);l!==void 0&&(e.delete(c),l.dispose())}function a(){e=new WeakMap,n!==null&&(n.dispose(),n=null)}return{get:i,dispose:a}}function $Oe(t){const e={};function n(i){if(e[i]!==void 0)return e[i];let r;switch(i){case"WEBGL_depth_texture":r=t.getExtension("WEBGL_depth_texture")||t.getExtension("MOZ_WEBGL_depth_texture")||t.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":r=t.getExtension("EXT_texture_filter_anisotropic")||t.getExtension("MOZ_EXT_texture_filter_anisotropic")||t.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":r=t.getExtension("WEBGL_compressed_texture_s3tc")||t.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||t.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":r=t.getExtension("WEBGL_compressed_texture_pvrtc")||t.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:r=t.getExtension(i)}return e[i]=r,r}return{has:function(i){return n(i)!==null},init:function(){n("EXT_color_buffer_float"),n("WEBGL_clip_cull_distance"),n("OES_texture_float_linear"),n("EXT_color_buffer_half_float"),n("WEBGL_multisampled_render_to_texture"),n("WEBGL_render_shared_exponent")},get:function(i){const r=n(i);return r===null&&KP("THREE.WebGLRenderer: "+i+" extension not supported."),r}}}function WOe(t,e,n,i){const r={},s=new WeakMap;function a(h){const f=h.target;f.index!==null&&e.remove(f.index);for(const p in f.attributes)e.remove(f.attributes[p]);f.removeEventListener("dispose",a),delete r[f.id];const d=s.get(f);d&&(e.remove(d),s.delete(f)),i.releaseStatesOfGeometry(f),f.isInstancedBufferGeometry===!0&&delete f._maxInstanceCount,n.memory.geometries--}function o(h,f){return r[f.id]===!0||(f.addEventListener("dispose",a),r[f.id]=!0,n.memory.geometries++),f}function c(h){const f=h.attributes;for(const d in f)e.update(f[d],t.ARRAY_BUFFER)}function l(h){const f=[],d=h.index,p=h.attributes.position;let g=0;if(d!==null){const b=d.array;g=d.version;for(let T=0,x=b.length;T<x;T+=3){const M=b[T+0],R=b[T+1],I=b[T+2];f.push(M,R,R,I,I,M)}}else if(p!==void 0){const b=p.array;g=p.version;for(let T=0,x=b.length/3-1;T<x;T+=3){const M=T+0,R=T+1,I=T+2;f.push(M,R,R,I,I,M)}}else return;const y=new(Mce(f)?f7:h7)(f,1);y.version=g;const v=s.get(h);v&&e.remove(v),s.set(h,y)}function u(h){const f=s.get(h);if(f){const d=h.index;d!==null&&f.version<d.version&&l(h)}else l(h);return s.get(h)}return{get:o,update:c,getWireframeAttribute:u}}function YOe(t,e,n){let i;function r(f){i=f}let s,a;function o(f){s=f.type,a=f.bytesPerElement}function c(f,d){t.drawElements(i,d,s,f*a),n.update(d,i,1)}function l(f,d,p){p!==0&&(t.drawElementsInstanced(i,d,s,f*a,p),n.update(d,i,p))}function u(f,d,p){if(p===0)return;e.get("WEBGL_multi_draw").multiDrawElementsWEBGL(i,d,0,s,f,0,p);let y=0;for(let v=0;v<p;v++)y+=d[v];n.update(y,i,1)}function h(f,d,p,g){if(p===0)return;const y=e.get("WEBGL_multi_draw");if(y===null)for(let v=0;v<f.length;v++)l(f[v]/a,d[v],g[v]);else{y.multiDrawElementsInstancedWEBGL(i,d,0,s,f,0,g,0,p);let v=0;for(let b=0;b<p;b++)v+=d[b]*g[b];n.update(v,i,1)}}this.setMode=r,this.setIndex=o,this.render=c,this.renderInstances=l,this.renderMultiDraw=u,this.renderMultiDrawInstances=h}function XOe(t){const e={geometries:0,textures:0},n={frame:0,calls:0,triangles:0,points:0,lines:0};function i(s,a,o){switch(n.calls++,a){case t.TRIANGLES:n.triangles+=o*(s/3);break;case t.LINES:n.lines+=o*(s/2);break;case t.LINE_STRIP:n.lines+=o*(s-1);break;case t.LINE_LOOP:n.lines+=o*s;break;case t.POINTS:n.points+=o*s;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",a);break}}function r(){n.calls=0,n.triangles=0,n.points=0,n.lines=0}return{memory:e,render:n,programs:null,autoReset:!0,reset:r,update:i}}function KOe(t,e,n){const i=new WeakMap,r=new Zr;function s(a,o,c){const l=a.morphTargetInfluences,u=o.morphAttributes.position||o.morphAttributes.normal||o.morphAttributes.color,h=u!==void 0?u.length:0;let f=i.get(o);if(f===void 0||f.count!==h){let P=function(){I.dispose(),i.delete(o),o.removeEventListener("dispose",P)};f!==void 0&&f.texture.dispose();const d=o.morphAttributes.position!==void 0,p=o.morphAttributes.normal!==void 0,g=o.morphAttributes.color!==void 0,y=o.morphAttributes.position||[],v=o.morphAttributes.normal||[],b=o.morphAttributes.color||[];let T=0;d===!0&&(T=1),p===!0&&(T=2),g===!0&&(T=3);let x=o.attributes.position.count*T,M=1;x>e.maxTextureSize&&(M=Math.ceil(x/e.maxTextureSize),x=e.maxTextureSize);const R=new Float32Array(x*M*4*h),I=new nI(R,x,M,h);I.type=hu,I.needsUpdate=!0;const k=T*4;for(let U=0;U<h;U++){const G=y[U],$=v[U],q=b[U],Y=x*M*4*U;for(let ie=0;ie<G.count;ie++){const V=ie*k;d===!0&&(r.fromBufferAttribute(G,ie),R[Y+V+0]=r.x,R[Y+V+1]=r.y,R[Y+V+2]=r.z,R[Y+V+3]=0),p===!0&&(r.fromBufferAttribute($,ie),R[Y+V+4]=r.x,R[Y+V+5]=r.y,R[Y+V+6]=r.z,R[Y+V+7]=0),g===!0&&(r.fromBufferAttribute(q,ie),R[Y+V+8]=r.x,R[Y+V+9]=r.y,R[Y+V+10]=r.z,R[Y+V+11]=q.itemSize===4?r.w:1)}}f={count:h,texture:I,size:new Rt(x,M)},i.set(o,f),o.addEventListener("dispose",P)}if(a.isInstancedMesh===!0&&a.morphTexture!==null)c.getUniforms().setValue(t,"morphTexture",a.morphTexture,n);else{let d=0;for(let g=0;g<l.length;g++)d+=l[g];const p=o.morphTargetsRelative?1:1-d;c.getUniforms().setValue(t,"morphTargetBaseInfluence",p),c.getUniforms().setValue(t,"morphTargetInfluences",l)}c.getUniforms().setValue(t,"morphTargetsTexture",f.texture,n),c.getUniforms().setValue(t,"morphTargetsTextureSize",f.size)}return{update:s}}function ZOe(t,e,n,i){let r=new WeakMap;function s(c){const l=i.render.frame,u=c.geometry,h=e.get(c,u);if(r.get(h)!==l&&(e.update(h),r.set(h,l)),c.isInstancedMesh&&(c.hasEventListener("dispose",o)===!1&&c.addEventListener("dispose",o),r.get(c)!==l&&(n.update(c.instanceMatrix,t.ARRAY_BUFFER),c.instanceColor!==null&&n.update(c.instanceColor,t.ARRAY_BUFFER),r.set(c,l))),c.isSkinnedMesh){const f=c.skeleton;r.get(f)!==l&&(f.update(),r.set(f,l))}return h}function a(){r=new WeakMap}function o(c){const l=c.target;l.removeEventListener("dispose",o),n.remove(l.instanceMatrix),l.instanceColor!==null&&n.remove(l.instanceColor)}return{update:s,dispose:a}}const Ple=new Ba,xJ=new bA(1,1),Lle=new nI,Ule=new EB,Ble=new rI,wJ=[],CJ=[],AJ=new Float32Array(16),RJ=new Float32Array(9),MJ=new Float32Array(4);function SA(t,e,n){const i=t[0];if(i<=0||i>0)return t;const r=e*n;let s=wJ[r];if(s===void 0&&(s=new Float32Array(r),wJ[r]=s),e!==0){i.toArray(s,0);for(let a=1,o=0;a!==e;++a)o+=n,t[a].toArray(s,o)}return s}function jc(t,e){if(t.length!==e.length)return!1;for(let n=0,i=t.length;n<i;n++)if(t[n]!==e[n])return!1;return!0}function Vc(t,e){for(let n=0,i=e.length;n<i;n++)t[n]=e[n]}function jB(t,e){let n=CJ[e];n===void 0&&(n=new Int32Array(e),CJ[e]=n);for(let i=0;i!==e;++i)n[i]=t.allocateTextureUnit();return n}function JOe(t,e){const n=this.cache;n[0]!==e&&(t.uniform1f(this.addr,e),n[0]=e)}function QOe(t,e){const n=this.cache;if(e.x!==void 0)(n[0]!==e.x||n[1]!==e.y)&&(t.uniform2f(this.addr,e.x,e.y),n[0]=e.x,n[1]=e.y);else{if(jc(n,e))return;t.uniform2fv(this.addr,e),Vc(n,e)}}function eNe(t,e){const n=this.cache;if(e.x!==void 0)(n[0]!==e.x||n[1]!==e.y||n[2]!==e.z)&&(t.uniform3f(this.addr,e.x,e.y,e.z),n[0]=e.x,n[1]=e.y,n[2]=e.z);else if(e.r!==void 0)(n[0]!==e.r||n[1]!==e.g||n[2]!==e.b)&&(t.uniform3f(this.addr,e.r,e.g,e.b),n[0]=e.r,n[1]=e.g,n[2]=e.b);else{if(jc(n,e))return;t.uniform3fv(this.addr,e),Vc(n,e)}}function tNe(t,e){const n=this.cache;if(e.x!==void 0)(n[0]!==e.x||n[1]!==e.y||n[2]!==e.z||n[3]!==e.w)&&(t.uniform4f(this.addr,e.x,e.y,e.z,e.w),n[0]=e.x,n[1]=e.y,n[2]=e.z,n[3]=e.w);else{if(jc(n,e))return;t.uniform4fv(this.addr,e),Vc(n,e)}}function nNe(t,e){const n=this.cache,i=e.elements;if(i===void 0){if(jc(n,e))return;t.uniformMatrix2fv(this.addr,!1,e),Vc(n,e)}else{if(jc(n,i))return;MJ.set(i),t.uniformMatrix2fv(this.addr,!1,MJ),Vc(n,i)}}function iNe(t,e){const n=this.cache,i=e.elements;if(i===void 0){if(jc(n,e))return;t.uniformMatrix3fv(this.addr,!1,e),Vc(n,e)}else{if(jc(n,i))return;RJ.set(i),t.uniformMatrix3fv(this.addr,!1,RJ),Vc(n,i)}}function rNe(t,e){const n=this.cache,i=e.elements;if(i===void 0){if(jc(n,e))return;t.uniformMatrix4fv(this.addr,!1,e),Vc(n,e)}else{if(jc(n,i))return;AJ.set(i),t.uniformMatrix4fv(this.addr,!1,AJ),Vc(n,i)}}function sNe(t,e){const n=this.cache;n[0]!==e&&(t.uniform1i(this.addr,e),n[0]=e)}function aNe(t,e){const n=this.cache;if(e.x!==void 0)(n[0]!==e.x||n[1]!==e.y)&&(t.uniform2i(this.addr,e.x,e.y),n[0]=e.x,n[1]=e.y);else{if(jc(n,e))return;t.uniform2iv(this.addr,e),Vc(n,e)}}function oNe(t,e){const n=this.cache;if(e.x!==void 0)(n[0]!==e.x||n[1]!==e.y||n[2]!==e.z)&&(t.uniform3i(this.addr,e.x,e.y,e.z),n[0]=e.x,n[1]=e.y,n[2]=e.z);else{if(jc(n,e))return;t.uniform3iv(this.addr,e),Vc(n,e)}}function cNe(t,e){const n=this.cache;if(e.x!==void 0)(n[0]!==e.x||n[1]!==e.y||n[2]!==e.z||n[3]!==e.w)&&(t.uniform4i(this.addr,e.x,e.y,e.z,e.w),n[0]=e.x,n[1]=e.y,n[2]=e.z,n[3]=e.w);else{if(jc(n,e))return;t.uniform4iv(this.addr,e),Vc(n,e)}}function lNe(t,e){const n=this.cache;n[0]!==e&&(t.uniform1ui(this.addr,e),n[0]=e)}function uNe(t,e){const n=this.cache;if(e.x!==void 0)(n[0]!==e.x||n[1]!==e.y)&&(t.uniform2ui(this.addr,e.x,e.y),n[0]=e.x,n[1]=e.y);else{if(jc(n,e))return;t.uniform2uiv(this.addr,e),Vc(n,e)}}function hNe(t,e){const n=this.cache;if(e.x!==void 0)(n[0]!==e.x||n[1]!==e.y||n[2]!==e.z)&&(t.uniform3ui(this.addr,e.x,e.y,e.z),n[0]=e.x,n[1]=e.y,n[2]=e.z);else{if(jc(n,e))return;t.uniform3uiv(this.addr,e),Vc(n,e)}}function fNe(t,e){const n=this.cache;if(e.x!==void 0)(n[0]!==e.x||n[1]!==e.y||n[2]!==e.z||n[3]!==e.w)&&(t.uniform4ui(this.addr,e.x,e.y,e.z,e.w),n[0]=e.x,n[1]=e.y,n[2]=e.z,n[3]=e.w);else{if(jc(n,e))return;t.uniform4uiv(this.addr,e),Vc(n,e)}}function dNe(t,e,n){const i=this.cache,r=n.allocateTextureUnit();i[0]!==r&&(t.uniform1i(this.addr,r),i[0]=r);let s;this.type===t.SAMPLER_2D_SHADOW?(xJ.compareFunction=l7,s=xJ):s=Ple,n.setTexture2D(e||s,r)}function pNe(t,e,n){const i=this.cache,r=n.allocateTextureUnit();i[0]!==r&&(t.uniform1i(this.addr,r),i[0]=r),n.setTexture3D(e||Ule,r)}function mNe(t,e,n){const i=this.cache,r=n.allocateTextureUnit();i[0]!==r&&(t.uniform1i(this.addr,r),i[0]=r),n.setTextureCube(e||Ble,r)}function gNe(t,e,n){const i=this.cache,r=n.allocateTextureUnit();i[0]!==r&&(t.uniform1i(this.addr,r),i[0]=r),n.setTexture2DArray(e||Lle,r)}function vNe(t){switch(t){case 5126:return JOe;case 35664:return QOe;case 35665:return eNe;case 35666:return tNe;case 35674:return nNe;case 35675:return iNe;case 35676:return rNe;case 5124:case 35670:return sNe;case 35667:case 35671:return aNe;case 35668:case 35672:return oNe;case 35669:case 35673:return cNe;case 5125:return lNe;case 36294:return uNe;case 36295:return hNe;case 36296:return fNe;case 35678:case 36198:case 36298:case 36306:case 35682:return dNe;case 35679:case 36299:case 36307:return pNe;case 35680:case 36300:case 36308:case 36293:return mNe;case 36289:case 36303:case 36311:case 36292:return gNe}}function _Ne(t,e){t.uniform1fv(this.addr,e)}function yNe(t,e){const n=SA(e,this.size,2);t.uniform2fv(this.addr,n)}function bNe(t,e){const n=SA(e,this.size,3);t.uniform3fv(this.addr,n)}function ENe(t,e){const n=SA(e,this.size,4);t.uniform4fv(this.addr,n)}function SNe(t,e){const n=SA(e,this.size,4);t.uniformMatrix2fv(this.addr,!1,n)}function TNe(t,e){const n=SA(e,this.size,9);t.uniformMatrix3fv(this.addr,!1,n)}function xNe(t,e){const n=SA(e,this.size,16);t.uniformMatrix4fv(this.addr,!1,n)}function wNe(t,e){t.uniform1iv(this.addr,e)}function CNe(t,e){t.uniform2iv(this.addr,e)}function ANe(t,e){t.uniform3iv(this.addr,e)}function RNe(t,e){t.uniform4iv(this.addr,e)}function MNe(t,e){t.uniform1uiv(this.addr,e)}function ONe(t,e){t.uniform2uiv(this.addr,e)}function NNe(t,e){t.uniform3uiv(this.addr,e)}function INe(t,e){t.uniform4uiv(this.addr,e)}function kNe(t,e,n){const i=this.cache,r=e.length,s=jB(n,r);jc(i,s)||(t.uniform1iv(this.addr,s),Vc(i,s));for(let a=0;a!==r;++a)n.setTexture2D(e[a]||Ple,s[a])}function DNe(t,e,n){const i=this.cache,r=e.length,s=jB(n,r);jc(i,s)||(t.uniform1iv(this.addr,s),Vc(i,s));for(let a=0;a!==r;++a)n.setTexture3D(e[a]||Ule,s[a])}function PNe(t,e,n){const i=this.cache,r=e.length,s=jB(n,r);jc(i,s)||(t.uniform1iv(this.addr,s),Vc(i,s));for(let a=0;a!==r;++a)n.setTextureCube(e[a]||Ble,s[a])}function LNe(t,e,n){const i=this.cache,r=e.length,s=jB(n,r);jc(i,s)||(t.uniform1iv(this.addr,s),Vc(i,s));for(let a=0;a!==r;++a)n.setTexture2DArray(e[a]||Lle,s[a])}function UNe(t){switch(t){case 5126:return _Ne;case 35664:return yNe;case 35665:return bNe;case 35666:return ENe;case 35674:return SNe;case 35675:return TNe;case 35676:return xNe;case 5124:case 35670:return wNe;case 35667:case 35671:return CNe;case 35668:case 35672:return ANe;case 35669:case 35673:return RNe;case 5125:return MNe;case 36294:return ONe;case 36295:return NNe;case 36296:return INe;case 35678:case 36198:case 36298:case 36306:case 35682:return kNe;case 35679:case 36299:case 36307:return DNe;case 35680:case 36300:case 36308:case 36293:return PNe;case 36289:case 36303:case 36311:case 36292:return LNe}}class BNe{constructor(e,n,i){this.id=e,this.addr=i,this.cache=[],this.type=n.type,this.setValue=vNe(n.type)}}class FNe{constructor(e,n,i){this.id=e,this.addr=i,this.cache=[],this.type=n.type,this.size=n.size,this.setValue=UNe(n.type)}}class zNe{constructor(e){this.id=e,this.seq=[],this.map={}}setValue(e,n,i){const r=this.seq;for(let s=0,a=r.length;s!==a;++s){const o=r[s];o.setValue(e,n[o.id],i)}}}const _H=/(\w+)(\])?(\[|\.)?/g;function OJ(t,e){t.seq.push(e),t.map[e.id]=e}function HNe(t,e,n){const i=t.name,r=i.length;for(_H.lastIndex=0;;){const s=_H.exec(i),a=_H.lastIndex;let o=s[1];const c=s[2]==="]",l=s[3];if(c&&(o=o|0),l===void 0||l==="["&&a+2===r){OJ(n,l===void 0?new BNe(o,t,e):new FNe(o,t,e));break}else{let h=n.map[o];h===void 0&&(h=new zNe(o),OJ(n,h)),n=h}}}class JP{constructor(e,n){this.seq=[],this.map={};const i=e.getProgramParameter(n,e.ACTIVE_UNIFORMS);for(let r=0;r<i;++r){const s=e.getActiveUniform(n,r),a=e.getUniformLocation(n,s.name);HNe(s,a,this)}}setValue(e,n,i,r){const s=this.map[n];s!==void 0&&s.setValue(e,i,r)}setOptional(e,n,i){const r=n[i];r!==void 0&&this.setValue(e,i,r)}static upload(e,n,i,r){for(let s=0,a=n.length;s!==a;++s){const o=n[s],c=i[o.id];c.needsUpdate!==!1&&o.setValue(e,c.value,r)}}static seqWithValue(e,n){const i=[];for(let r=0,s=e.length;r!==s;++r){const a=e[r];a.id in n&&i.push(a)}return i}}function NJ(t,e,n){const i=t.createShader(e);return t.shaderSource(i,n),t.compileShader(i),i}const jNe=37297;let VNe=0;function GNe(t,e){const n=t.split(`
`),i=[],r=Math.max(e-6,0),s=Math.min(e+6,n.length);for(let a=r;a<s;a++){const o=a+1;i.push(`${o===e?">":" "} ${o}: ${n[a]}`)}return i.join(`
`)}const IJ=new Ji;function qNe(t){Ur._getMatrix(IJ,Ur.workingColorSpace,t);const e=`mat3( ${IJ.elements.map(n=>n.toFixed(4))} )`;switch(Ur.getTransfer(t)){case mO:return[e,"LinearTransferOETF"];case As:return[e,"sRGBTransferOETF"];default:return console.warn("THREE.WebGLProgram: Unsupported color space: ",t),[e,"LinearTransferOETF"]}}function kJ(t,e,n){const i=t.getShaderParameter(e,t.COMPILE_STATUS),r=t.getShaderInfoLog(e).trim();if(i&&r==="")return"";const s=/ERROR: 0:(\d+)/.exec(r);if(s){const a=parseInt(s[1]);return n.toUpperCase()+`

`+r+`

`+GNe(t.getShaderSource(e),a)}else return r}function $Ne(t,e){const n=qNe(e);return[`vec4 ${t}( vec4 value ) {`,`	return ${n[1]}( vec4( value.rgb * ${n[0]}, value.a ) );`,"}"].join(`
`)}function WNe(t,e){let n;switch(e){case lce:n="Linear";break;case uce:n="Reinhard";break;case hce:n="Cineon";break;case Q$:n="ACESFilmic";break;case dce:n="AgX";break;case pce:n="Neutral";break;case fce:n="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",e),n="Linear"}return"vec3 "+t+"( vec3 color ) { return "+n+"ToneMapping( color ); }"}const PD=new Ae;function YNe(){Ur.getLuminanceCoefficients(PD);const t=PD.x.toFixed(4),e=PD.y.toFixed(4),n=PD.z.toFixed(4);return["float luminance( const in vec3 rgb ) {",`	const vec3 weights = vec3( ${t}, ${e}, ${n} );`,"	return dot( weights, rgb );","}"].join(`
`)}function XNe(t){return[t.extensionClipCullDistance?"#extension GL_ANGLE_clip_cull_distance : require":"",t.extensionMultiDraw?"#extension GL_ANGLE_multi_draw : require":""].filter(tM).join(`
`)}function KNe(t){const e=[];for(const n in t){const i=t[n];i!==!1&&e.push("#define "+n+" "+i)}return e.join(`
`)}function ZNe(t,e){const n={},i=t.getProgramParameter(e,t.ACTIVE_ATTRIBUTES);for(let r=0;r<i;r++){const s=t.getActiveAttrib(e,r),a=s.name;let o=1;s.type===t.FLOAT_MAT2&&(o=2),s.type===t.FLOAT_MAT3&&(o=3),s.type===t.FLOAT_MAT4&&(o=4),n[a]={type:s.type,location:t.getAttribLocation(e,a),locationSize:o}}return n}function tM(t){return t!==""}function DJ(t,e){const n=e.numSpotLightShadows+e.numSpotLightMaps-e.numSpotLightShadowsWithMaps;return t.replace(/NUM_DIR_LIGHTS/g,e.numDirLights).replace(/NUM_SPOT_LIGHTS/g,e.numSpotLights).replace(/NUM_SPOT_LIGHT_MAPS/g,e.numSpotLightMaps).replace(/NUM_SPOT_LIGHT_COORDS/g,n).replace(/NUM_RECT_AREA_LIGHTS/g,e.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,e.numPointLights).replace(/NUM_HEMI_LIGHTS/g,e.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,e.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS/g,e.numSpotLightShadowsWithMaps).replace(/NUM_SPOT_LIGHT_SHADOWS/g,e.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,e.numPointLightShadows)}function PJ(t,e){return t.replace(/NUM_CLIPPING_PLANES/g,e.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,e.numClippingPlanes-e.numClipIntersection)}const JNe=/^[ \t]*#include +<([\w\d./]+)>/gm;function wV(t){return t.replace(JNe,eIe)}const QNe=new Map;function eIe(t,e){let n=ir[e];if(n===void 0){const i=QNe.get(e);if(i!==void 0)n=ir[i],console.warn('THREE.WebGLRenderer: Shader chunk "%s" has been deprecated. Use "%s" instead.',e,i);else throw new Error("Can not resolve #include <"+e+">")}return wV(n)}const tIe=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function LJ(t){return t.replace(tIe,nIe)}function nIe(t,e,n,i){let r="";for(let s=parseInt(e);s<parseInt(n);s++)r+=i.replace(/\[\s*i\s*\]/g,"[ "+s+" ]").replace(/UNROLLED_LOOP_INDEX/g,s);return r}function UJ(t){let e=`precision ${t.precision} float;
	precision ${t.precision} int;
	precision ${t.precision} sampler2D;
	precision ${t.precision} samplerCube;
	precision ${t.precision} sampler3D;
	precision ${t.precision} sampler2DArray;
	precision ${t.precision} sampler2DShadow;
	precision ${t.precision} samplerCubeShadow;
	precision ${t.precision} sampler2DArrayShadow;
	precision ${t.precision} isampler2D;
	precision ${t.precision} isampler3D;
	precision ${t.precision} isamplerCube;
	precision ${t.precision} isampler2DArray;
	precision ${t.precision} usampler2D;
	precision ${t.precision} usampler3D;
	precision ${t.precision} usamplerCube;
	precision ${t.precision} usampler2DArray;
	`;return t.precision==="highp"?e+=`
#define HIGH_PRECISION`:t.precision==="mediump"?e+=`
#define MEDIUM_PRECISION`:t.precision==="lowp"&&(e+=`
#define LOW_PRECISION`),e}function iIe(t){let e="SHADOWMAP_TYPE_BASIC";return t.shadowMapType===fB?e="SHADOWMAP_TYPE_PCF":t.shadowMapType===vM?e="SHADOWMAP_TYPE_PCF_SOFT":t.shadowMapType===em&&(e="SHADOWMAP_TYPE_VSM"),e}function rIe(t){let e="ENVMAP_TYPE_CUBE";if(t.envMap)switch(t.envMapMode){case m_:case Vb:e="ENVMAP_TYPE_CUBE";break;case vA:e="ENVMAP_TYPE_CUBE_UV";break}return e}function sIe(t){let e="ENVMAP_MODE_REFLECTION";if(t.envMap)switch(t.envMapMode){case Vb:e="ENVMAP_MODE_REFRACTION";break}return e}function aIe(t){let e="ENVMAP_BLENDING_NONE";if(t.envMap)switch(t.combine){case QN:e="ENVMAP_BLENDING_MULTIPLY";break;case oce:e="ENVMAP_BLENDING_MIX";break;case cce:e="ENVMAP_BLENDING_ADD";break}return e}function oIe(t){const e=t.envMapCubeUVHeight;if(e===null)return null;const n=Math.log2(e)-2,i=1/e;return{texelWidth:1/(3*Math.max(Math.pow(2,n),7*16)),texelHeight:i,maxMip:n}}function cIe(t,e,n,i){const r=t.getContext(),s=n.defines;let a=n.vertexShader,o=n.fragmentShader;const c=iIe(n),l=rIe(n),u=sIe(n),h=aIe(n),f=oIe(n),d=XNe(n),p=KNe(s),g=r.createProgram();let y,v,b=n.glslVersion?"#version "+n.glslVersion+`
`:"";n.isRawShaderMaterial?(y=["#define SHADER_TYPE "+n.shaderType,"#define SHADER_NAME "+n.shaderName,p].filter(tM).join(`
`),y.length>0&&(y+=`
`),v=["#define SHADER_TYPE "+n.shaderType,"#define SHADER_NAME "+n.shaderName,p].filter(tM).join(`
`),v.length>0&&(v+=`
`)):(y=[UJ(n),"#define SHADER_TYPE "+n.shaderType,"#define SHADER_NAME "+n.shaderName,p,n.extensionClipCullDistance?"#define USE_CLIP_DISTANCE":"",n.batching?"#define USE_BATCHING":"",n.batchingColor?"#define USE_BATCHING_COLOR":"",n.instancing?"#define USE_INSTANCING":"",n.instancingColor?"#define USE_INSTANCING_COLOR":"",n.instancingMorph?"#define USE_INSTANCING_MORPH":"",n.useFog&&n.fog?"#define USE_FOG":"",n.useFog&&n.fogExp2?"#define FOG_EXP2":"",n.map?"#define USE_MAP":"",n.envMap?"#define USE_ENVMAP":"",n.envMap?"#define "+u:"",n.lightMap?"#define USE_LIGHTMAP":"",n.aoMap?"#define USE_AOMAP":"",n.bumpMap?"#define USE_BUMPMAP":"",n.normalMap?"#define USE_NORMALMAP":"",n.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",n.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",n.displacementMap?"#define USE_DISPLACEMENTMAP":"",n.emissiveMap?"#define USE_EMISSIVEMAP":"",n.anisotropy?"#define USE_ANISOTROPY":"",n.anisotropyMap?"#define USE_ANISOTROPYMAP":"",n.clearcoatMap?"#define USE_CLEARCOATMAP":"",n.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",n.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",n.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",n.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",n.specularMap?"#define USE_SPECULARMAP":"",n.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",n.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",n.roughnessMap?"#define USE_ROUGHNESSMAP":"",n.metalnessMap?"#define USE_METALNESSMAP":"",n.alphaMap?"#define USE_ALPHAMAP":"",n.alphaHash?"#define USE_ALPHAHASH":"",n.transmission?"#define USE_TRANSMISSION":"",n.transmissionMap?"#define USE_TRANSMISSIONMAP":"",n.thicknessMap?"#define USE_THICKNESSMAP":"",n.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",n.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",n.mapUv?"#define MAP_UV "+n.mapUv:"",n.alphaMapUv?"#define ALPHAMAP_UV "+n.alphaMapUv:"",n.lightMapUv?"#define LIGHTMAP_UV "+n.lightMapUv:"",n.aoMapUv?"#define AOMAP_UV "+n.aoMapUv:"",n.emissiveMapUv?"#define EMISSIVEMAP_UV "+n.emissiveMapUv:"",n.bumpMapUv?"#define BUMPMAP_UV "+n.bumpMapUv:"",n.normalMapUv?"#define NORMALMAP_UV "+n.normalMapUv:"",n.displacementMapUv?"#define DISPLACEMENTMAP_UV "+n.displacementMapUv:"",n.metalnessMapUv?"#define METALNESSMAP_UV "+n.metalnessMapUv:"",n.roughnessMapUv?"#define ROUGHNESSMAP_UV "+n.roughnessMapUv:"",n.anisotropyMapUv?"#define ANISOTROPYMAP_UV "+n.anisotropyMapUv:"",n.clearcoatMapUv?"#define CLEARCOATMAP_UV "+n.clearcoatMapUv:"",n.clearcoatNormalMapUv?"#define CLEARCOAT_NORMALMAP_UV "+n.clearcoatNormalMapUv:"",n.clearcoatRoughnessMapUv?"#define CLEARCOAT_ROUGHNESSMAP_UV "+n.clearcoatRoughnessMapUv:"",n.iridescenceMapUv?"#define IRIDESCENCEMAP_UV "+n.iridescenceMapUv:"",n.iridescenceThicknessMapUv?"#define IRIDESCENCE_THICKNESSMAP_UV "+n.iridescenceThicknessMapUv:"",n.sheenColorMapUv?"#define SHEEN_COLORMAP_UV "+n.sheenColorMapUv:"",n.sheenRoughnessMapUv?"#define SHEEN_ROUGHNESSMAP_UV "+n.sheenRoughnessMapUv:"",n.specularMapUv?"#define SPECULARMAP_UV "+n.specularMapUv:"",n.specularColorMapUv?"#define SPECULAR_COLORMAP_UV "+n.specularColorMapUv:"",n.specularIntensityMapUv?"#define SPECULAR_INTENSITYMAP_UV "+n.specularIntensityMapUv:"",n.transmissionMapUv?"#define TRANSMISSIONMAP_UV "+n.transmissionMapUv:"",n.thicknessMapUv?"#define THICKNESSMAP_UV "+n.thicknessMapUv:"",n.vertexTangents&&n.flatShading===!1?"#define USE_TANGENT":"",n.vertexColors?"#define USE_COLOR":"",n.vertexAlphas?"#define USE_COLOR_ALPHA":"",n.vertexUv1s?"#define USE_UV1":"",n.vertexUv2s?"#define USE_UV2":"",n.vertexUv3s?"#define USE_UV3":"",n.pointsUvs?"#define USE_POINTS_UV":"",n.flatShading?"#define FLAT_SHADED":"",n.skinning?"#define USE_SKINNING":"",n.morphTargets?"#define USE_MORPHTARGETS":"",n.morphNormals&&n.flatShading===!1?"#define USE_MORPHNORMALS":"",n.morphColors?"#define USE_MORPHCOLORS":"",n.morphTargetsCount>0?"#define MORPHTARGETS_TEXTURE_STRIDE "+n.morphTextureStride:"",n.morphTargetsCount>0?"#define MORPHTARGETS_COUNT "+n.morphTargetsCount:"",n.doubleSided?"#define DOUBLE_SIDED":"",n.flipSided?"#define FLIP_SIDED":"",n.shadowMapEnabled?"#define USE_SHADOWMAP":"",n.shadowMapEnabled?"#define "+c:"",n.sizeAttenuation?"#define USE_SIZEATTENUATION":"",n.numLightProbes>0?"#define USE_LIGHT_PROBES":"",n.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",n.reverseDepthBuffer?"#define USE_REVERSEDEPTHBUF":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","	attribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","	attribute vec3 instanceColor;","#endif","#ifdef USE_INSTANCING_MORPH","	uniform sampler2D morphTexture;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_UV1","	attribute vec2 uv1;","#endif","#ifdef USE_UV2","	attribute vec2 uv2;","#endif","#ifdef USE_UV3","	attribute vec2 uv3;","#endif","#ifdef USE_TANGENT","	attribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","	attribute vec4 color;","#elif defined( USE_COLOR )","	attribute vec3 color;","#endif","#ifdef USE_SKINNING","	attribute vec4 skinIndex;","	attribute vec4 skinWeight;","#endif",`
`].filter(tM).join(`
`),v=[UJ(n),"#define SHADER_TYPE "+n.shaderType,"#define SHADER_NAME "+n.shaderName,p,n.useFog&&n.fog?"#define USE_FOG":"",n.useFog&&n.fogExp2?"#define FOG_EXP2":"",n.alphaToCoverage?"#define ALPHA_TO_COVERAGE":"",n.map?"#define USE_MAP":"",n.matcap?"#define USE_MATCAP":"",n.envMap?"#define USE_ENVMAP":"",n.envMap?"#define "+l:"",n.envMap?"#define "+u:"",n.envMap?"#define "+h:"",f?"#define CUBEUV_TEXEL_WIDTH "+f.texelWidth:"",f?"#define CUBEUV_TEXEL_HEIGHT "+f.texelHeight:"",f?"#define CUBEUV_MAX_MIP "+f.maxMip+".0":"",n.lightMap?"#define USE_LIGHTMAP":"",n.aoMap?"#define USE_AOMAP":"",n.bumpMap?"#define USE_BUMPMAP":"",n.normalMap?"#define USE_NORMALMAP":"",n.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",n.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",n.emissiveMap?"#define USE_EMISSIVEMAP":"",n.anisotropy?"#define USE_ANISOTROPY":"",n.anisotropyMap?"#define USE_ANISOTROPYMAP":"",n.clearcoat?"#define USE_CLEARCOAT":"",n.clearcoatMap?"#define USE_CLEARCOATMAP":"",n.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",n.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",n.dispersion?"#define USE_DISPERSION":"",n.iridescence?"#define USE_IRIDESCENCE":"",n.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",n.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",n.specularMap?"#define USE_SPECULARMAP":"",n.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",n.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",n.roughnessMap?"#define USE_ROUGHNESSMAP":"",n.metalnessMap?"#define USE_METALNESSMAP":"",n.alphaMap?"#define USE_ALPHAMAP":"",n.alphaTest?"#define USE_ALPHATEST":"",n.alphaHash?"#define USE_ALPHAHASH":"",n.sheen?"#define USE_SHEEN":"",n.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",n.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",n.transmission?"#define USE_TRANSMISSION":"",n.transmissionMap?"#define USE_TRANSMISSIONMAP":"",n.thicknessMap?"#define USE_THICKNESSMAP":"",n.vertexTangents&&n.flatShading===!1?"#define USE_TANGENT":"",n.vertexColors||n.instancingColor||n.batchingColor?"#define USE_COLOR":"",n.vertexAlphas?"#define USE_COLOR_ALPHA":"",n.vertexUv1s?"#define USE_UV1":"",n.vertexUv2s?"#define USE_UV2":"",n.vertexUv3s?"#define USE_UV3":"",n.pointsUvs?"#define USE_POINTS_UV":"",n.gradientMap?"#define USE_GRADIENTMAP":"",n.flatShading?"#define FLAT_SHADED":"",n.doubleSided?"#define DOUBLE_SIDED":"",n.flipSided?"#define FLIP_SIDED":"",n.shadowMapEnabled?"#define USE_SHADOWMAP":"",n.shadowMapEnabled?"#define "+c:"",n.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",n.numLightProbes>0?"#define USE_LIGHT_PROBES":"",n.decodeVideoTexture?"#define DECODE_VIDEO_TEXTURE":"",n.decodeVideoTextureEmissive?"#define DECODE_VIDEO_TEXTURE_EMISSIVE":"",n.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",n.reverseDepthBuffer?"#define USE_REVERSEDEPTHBUF":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",n.toneMapping!==hm?"#define TONE_MAPPING":"",n.toneMapping!==hm?ir.tonemapping_pars_fragment:"",n.toneMapping!==hm?WNe("toneMapping",n.toneMapping):"",n.dithering?"#define DITHERING":"",n.opaque?"#define OPAQUE":"",ir.colorspace_pars_fragment,$Ne("linearToOutputTexel",n.outputColorSpace),YNe(),n.useDepthPacking?"#define DEPTH_PACKING "+n.depthPacking:"",`
`].filter(tM).join(`
`)),a=wV(a),a=DJ(a,n),a=PJ(a,n),o=wV(o),o=DJ(o,n),o=PJ(o,n),a=LJ(a),o=LJ(o),n.isRawShaderMaterial!==!0&&(b=`#version 300 es
`,y=[d,"#define attribute in","#define varying out","#define texture2D texture"].join(`
`)+`
`+y,v=["#define varying in",n.glslVersion===gV?"":"layout(location = 0) out highp vec4 pc_fragColor;",n.glslVersion===gV?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join(`
`)+`
`+v);const T=b+y+a,x=b+v+o,M=NJ(r,r.VERTEX_SHADER,T),R=NJ(r,r.FRAGMENT_SHADER,x);r.attachShader(g,M),r.attachShader(g,R),n.index0AttributeName!==void 0?r.bindAttribLocation(g,0,n.index0AttributeName):n.morphTargets===!0&&r.bindAttribLocation(g,0,"position"),r.linkProgram(g);function I(G){if(t.debug.checkShaderErrors){const $=r.getProgramInfoLog(g).trim(),q=r.getShaderInfoLog(M).trim(),Y=r.getShaderInfoLog(R).trim();let ie=!0,V=!0;if(r.getProgramParameter(g,r.LINK_STATUS)===!1)if(ie=!1,typeof t.debug.onShaderError=="function")t.debug.onShaderError(r,g,M,R);else{const J=kJ(r,M,"vertex"),X=kJ(r,R,"fragment");console.error("THREE.WebGLProgram: Shader Error "+r.getError()+" - VALIDATE_STATUS "+r.getProgramParameter(g,r.VALIDATE_STATUS)+`

Material Name: `+G.name+`
Material Type: `+G.type+`

Program Info Log: `+$+`
`+J+`
`+X)}else $!==""?console.warn("THREE.WebGLProgram: Program Info Log:",$):(q===""||Y==="")&&(V=!1);V&&(G.diagnostics={runnable:ie,programLog:$,vertexShader:{log:q,prefix:y},fragmentShader:{log:Y,prefix:v}})}r.deleteShader(M),r.deleteShader(R),k=new JP(r,g),P=ZNe(r,g)}let k;this.getUniforms=function(){return k===void 0&&I(this),k};let P;this.getAttributes=function(){return P===void 0&&I(this),P};let U=n.rendererExtensionParallelShaderCompile===!1;return this.isReady=function(){return U===!1&&(U=r.getProgramParameter(g,jNe)),U},this.destroy=function(){i.releaseStatesOfProgram(this),r.deleteProgram(g),this.program=void 0},this.type=n.shaderType,this.name=n.shaderName,this.id=VNe++,this.cacheKey=e,this.usedTimes=1,this.program=g,this.vertexShader=M,this.fragmentShader=R,this}let lIe=0;class uIe{constructor(){this.shaderCache=new Map,this.materialCache=new Map}update(e){const n=e.vertexShader,i=e.fragmentShader,r=this._getShaderStage(n),s=this._getShaderStage(i),a=this._getShaderCacheForMaterial(e);return a.has(r)===!1&&(a.add(r),r.usedTimes++),a.has(s)===!1&&(a.add(s),s.usedTimes++),this}remove(e){const n=this.materialCache.get(e);for(const i of n)i.usedTimes--,i.usedTimes===0&&this.shaderCache.delete(i.code);return this.materialCache.delete(e),this}getVertexShaderID(e){return this._getShaderStage(e.vertexShader).id}getFragmentShaderID(e){return this._getShaderStage(e.fragmentShader).id}dispose(){this.shaderCache.clear(),this.materialCache.clear()}_getShaderCacheForMaterial(e){const n=this.materialCache;let i=n.get(e);return i===void 0&&(i=new Set,n.set(e,i)),i}_getShaderStage(e){const n=this.shaderCache;let i=n.get(e);return i===void 0&&(i=new hIe(e),n.set(e,i)),i}}class hIe{constructor(e){this.id=lIe++,this.code=e,this.usedTimes=0}}function fIe(t,e,n,i,r,s,a){const o=new bC,c=new uIe,l=new Set,u=[],h=r.logarithmicDepthBuffer,f=r.vertexTextures;let d=r.precision;const p={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"};function g(P){return l.add(P),P===0?"uv":`uv${P}`}function y(P,U,G,$,q){const Y=$.fog,ie=q.geometry,V=P.isMeshStandardMaterial?$.environment:null,J=(P.isMeshStandardMaterial?n:e).get(P.envMap||V),X=J&&J.mapping===vA?J.image.height:null,ee=p[P.type];P.precision!==null&&(d=r.getMaxPrecision(P.precision),d!==P.precision&&console.warn("THREE.WebGLProgram.getParameters:",P.precision,"not supported, using",d,"instead."));const oe=ie.morphAttributes.position||ie.morphAttributes.normal||ie.morphAttributes.color,fe=oe!==void 0?oe.length:0;let Re=0;ie.morphAttributes.position!==void 0&&(Re=1),ie.morphAttributes.normal!==void 0&&(Re=2),ie.morphAttributes.color!==void 0&&(Re=3);let He,Te,Le,we;if(ee){const Nt=im[ee];He=Nt.vertexShader,Te=Nt.fragmentShader}else He=P.vertexShader,Te=P.fragmentShader,c.update(P),Le=c.getVertexShaderID(P),we=c.getFragmentShaderID(P);const Ce=t.getRenderTarget(),ke=t.state.buffers.depth.getReversed(),St=q.isInstancedMesh===!0,Mt=q.isBatchedMesh===!0,Ee=!!P.map,_e=!!P.matcap,tt=!!J,de=!!P.aoMap,Be=!!P.lightMap,Ie=!!P.bumpMap,rt=!!P.normalMap,ft=!!P.displacementMap,gt=!!P.emissiveMap,bt=!!P.metalnessMap,be=!!P.roughnessMap,ue=P.anisotropy>0,Xe=P.clearcoat>0,it=P.dispersion>0,$e=P.iridescence>0,Ue=P.sheen>0,qt=P.transmission>0,Ot=ue&&!!P.anisotropyMap,Yt=Xe&&!!P.clearcoatMap,ce=Xe&&!!P.clearcoatNormalMap,j=Xe&&!!P.clearcoatRoughnessMap,W=$e&&!!P.iridescenceMap,me=$e&&!!P.iridescenceThicknessMap,De=Ue&&!!P.sheenColorMap,Ve=Ue&&!!P.sheenRoughnessMap,mt=!!P.specularMap,xt=!!P.specularColorMap,Vn=!!P.specularIntensityMap,qe=qt&&!!P.transmissionMap,Vt=qt&&!!P.thicknessMap,ht=!!P.gradientMap,Pt=!!P.alphaMap,hn=P.alphaTest>0,an=!!P.alphaHash,Ge=!!P.extensions;let ot=hm;P.toneMapped&&(Ce===null||Ce.isXRRenderTarget===!0)&&(ot=t.toneMapping);const At={shaderID:ee,shaderType:P.type,shaderName:P.name,vertexShader:He,fragmentShader:Te,defines:P.defines,customVertexShaderID:Le,customFragmentShaderID:we,isRawShaderMaterial:P.isRawShaderMaterial===!0,glslVersion:P.glslVersion,precision:d,batching:Mt,batchingColor:Mt&&q._colorsTexture!==null,instancing:St,instancingColor:St&&q.instanceColor!==null,instancingMorph:St&&q.morphTexture!==null,supportsVertexTextures:f,outputColorSpace:Ce===null?t.outputColorSpace:Ce.isXRRenderTarget===!0?Ce.texture.colorSpace:Qg,alphaToCoverage:!!P.alphaToCoverage,map:Ee,matcap:_e,envMap:tt,envMapMode:tt&&J.mapping,envMapCubeUVHeight:X,aoMap:de,lightMap:Be,bumpMap:Ie,normalMap:rt,displacementMap:f&&ft,emissiveMap:gt,normalMapObjectSpace:rt&&P.normalMapType===bce,normalMapTangentSpace:rt&&P.normalMapType===hE,metalnessMap:bt,roughnessMap:be,anisotropy:ue,anisotropyMap:Ot,clearcoat:Xe,clearcoatMap:Yt,clearcoatNormalMap:ce,clearcoatRoughnessMap:j,dispersion:it,iridescence:$e,iridescenceMap:W,iridescenceThicknessMap:me,sheen:Ue,sheenColorMap:De,sheenRoughnessMap:Ve,specularMap:mt,specularColorMap:xt,specularIntensityMap:Vn,transmission:qt,transmissionMap:qe,thicknessMap:Vt,gradientMap:ht,opaque:P.transparent===!1&&P.blending===pT&&P.alphaToCoverage===!1,alphaMap:Pt,alphaTest:hn,alphaHash:an,combine:P.combine,mapUv:Ee&&g(P.map.channel),aoMapUv:de&&g(P.aoMap.channel),lightMapUv:Be&&g(P.lightMap.channel),bumpMapUv:Ie&&g(P.bumpMap.channel),normalMapUv:rt&&g(P.normalMap.channel),displacementMapUv:ft&&g(P.displacementMap.channel),emissiveMapUv:gt&&g(P.emissiveMap.channel),metalnessMapUv:bt&&g(P.metalnessMap.channel),roughnessMapUv:be&&g(P.roughnessMap.channel),anisotropyMapUv:Ot&&g(P.anisotropyMap.channel),clearcoatMapUv:Yt&&g(P.clearcoatMap.channel),clearcoatNormalMapUv:ce&&g(P.clearcoatNormalMap.channel),clearcoatRoughnessMapUv:j&&g(P.clearcoatRoughnessMap.channel),iridescenceMapUv:W&&g(P.iridescenceMap.channel),iridescenceThicknessMapUv:me&&g(P.iridescenceThicknessMap.channel),sheenColorMapUv:De&&g(P.sheenColorMap.channel),sheenRoughnessMapUv:Ve&&g(P.sheenRoughnessMap.channel),specularMapUv:mt&&g(P.specularMap.channel),specularColorMapUv:xt&&g(P.specularColorMap.channel),specularIntensityMapUv:Vn&&g(P.specularIntensityMap.channel),transmissionMapUv:qe&&g(P.transmissionMap.channel),thicknessMapUv:Vt&&g(P.thicknessMap.channel),alphaMapUv:Pt&&g(P.alphaMap.channel),vertexTangents:!!ie.attributes.tangent&&(rt||ue),vertexColors:P.vertexColors,vertexAlphas:P.vertexColors===!0&&!!ie.attributes.color&&ie.attributes.color.itemSize===4,pointsUvs:q.isPoints===!0&&!!ie.attributes.uv&&(Ee||Pt),fog:!!Y,useFog:P.fog===!0,fogExp2:!!Y&&Y.isFogExp2,flatShading:P.flatShading===!0,sizeAttenuation:P.sizeAttenuation===!0,logarithmicDepthBuffer:h,reverseDepthBuffer:ke,skinning:q.isSkinnedMesh===!0,morphTargets:ie.morphAttributes.position!==void 0,morphNormals:ie.morphAttributes.normal!==void 0,morphColors:ie.morphAttributes.color!==void 0,morphTargetsCount:fe,morphTextureStride:Re,numDirLights:U.directional.length,numPointLights:U.point.length,numSpotLights:U.spot.length,numSpotLightMaps:U.spotLightMap.length,numRectAreaLights:U.rectArea.length,numHemiLights:U.hemi.length,numDirLightShadows:U.directionalShadowMap.length,numPointLightShadows:U.pointShadowMap.length,numSpotLightShadows:U.spotShadowMap.length,numSpotLightShadowsWithMaps:U.numSpotLightShadowsWithMaps,numLightProbes:U.numLightProbes,numClippingPlanes:a.numPlanes,numClipIntersection:a.numIntersection,dithering:P.dithering,shadowMapEnabled:t.shadowMap.enabled&&G.length>0,shadowMapType:t.shadowMap.type,toneMapping:ot,decodeVideoTexture:Ee&&P.map.isVideoTexture===!0&&Ur.getTransfer(P.map.colorSpace)===As,decodeVideoTextureEmissive:gt&&P.emissiveMap.isVideoTexture===!0&&Ur.getTransfer(P.emissiveMap.colorSpace)===As,premultipliedAlpha:P.premultipliedAlpha,doubleSided:P.side===dl,flipSided:P.side===Bc,useDepthPacking:P.depthPacking>=0,depthPacking:P.depthPacking||0,index0AttributeName:P.index0AttributeName,extensionClipCullDistance:Ge&&P.extensions.clipCullDistance===!0&&i.has("WEBGL_clip_cull_distance"),extensionMultiDraw:(Ge&&P.extensions.multiDraw===!0||Mt)&&i.has("WEBGL_multi_draw"),rendererExtensionParallelShaderCompile:i.has("KHR_parallel_shader_compile"),customProgramCacheKey:P.customProgramCacheKey()};return At.vertexUv1s=l.has(1),At.vertexUv2s=l.has(2),At.vertexUv3s=l.has(3),l.clear(),At}function v(P){const U=[];if(P.shaderID?U.push(P.shaderID):(U.push(P.customVertexShaderID),U.push(P.customFragmentShaderID)),P.defines!==void 0)for(const G in P.defines)U.push(G),U.push(P.defines[G]);return P.isRawShaderMaterial===!1&&(b(U,P),T(U,P),U.push(t.outputColorSpace)),U.push(P.customProgramCacheKey),U.join()}function b(P,U){P.push(U.precision),P.push(U.outputColorSpace),P.push(U.envMapMode),P.push(U.envMapCubeUVHeight),P.push(U.mapUv),P.push(U.alphaMapUv),P.push(U.lightMapUv),P.push(U.aoMapUv),P.push(U.bumpMapUv),P.push(U.normalMapUv),P.push(U.displacementMapUv),P.push(U.emissiveMapUv),P.push(U.metalnessMapUv),P.push(U.roughnessMapUv),P.push(U.anisotropyMapUv),P.push(U.clearcoatMapUv),P.push(U.clearcoatNormalMapUv),P.push(U.clearcoatRoughnessMapUv),P.push(U.iridescenceMapUv),P.push(U.iridescenceThicknessMapUv),P.push(U.sheenColorMapUv),P.push(U.sheenRoughnessMapUv),P.push(U.specularMapUv),P.push(U.specularColorMapUv),P.push(U.specularIntensityMapUv),P.push(U.transmissionMapUv),P.push(U.thicknessMapUv),P.push(U.combine),P.push(U.fogExp2),P.push(U.sizeAttenuation),P.push(U.morphTargetsCount),P.push(U.morphAttributeCount),P.push(U.numDirLights),P.push(U.numPointLights),P.push(U.numSpotLights),P.push(U.numSpotLightMaps),P.push(U.numHemiLights),P.push(U.numRectAreaLights),P.push(U.numDirLightShadows),P.push(U.numPointLightShadows),P.push(U.numSpotLightShadows),P.push(U.numSpotLightShadowsWithMaps),P.push(U.numLightProbes),P.push(U.shadowMapType),P.push(U.toneMapping),P.push(U.numClippingPlanes),P.push(U.numClipIntersection),P.push(U.depthPacking)}function T(P,U){o.disableAll(),U.supportsVertexTextures&&o.enable(0),U.instancing&&o.enable(1),U.instancingColor&&o.enable(2),U.instancingMorph&&o.enable(3),U.matcap&&o.enable(4),U.envMap&&o.enable(5),U.normalMapObjectSpace&&o.enable(6),U.normalMapTangentSpace&&o.enable(7),U.clearcoat&&o.enable(8),U.iridescence&&o.enable(9),U.alphaTest&&o.enable(10),U.vertexColors&&o.enable(11),U.vertexAlphas&&o.enable(12),U.vertexUv1s&&o.enable(13),U.vertexUv2s&&o.enable(14),U.vertexUv3s&&o.enable(15),U.vertexTangents&&o.enable(16),U.anisotropy&&o.enable(17),U.alphaHash&&o.enable(18),U.batching&&o.enable(19),U.dispersion&&o.enable(20),U.batchingColor&&o.enable(21),P.push(o.mask),o.disableAll(),U.fog&&o.enable(0),U.useFog&&o.enable(1),U.flatShading&&o.enable(2),U.logarithmicDepthBuffer&&o.enable(3),U.reverseDepthBuffer&&o.enable(4),U.skinning&&o.enable(5),U.morphTargets&&o.enable(6),U.morphNormals&&o.enable(7),U.morphColors&&o.enable(8),U.premultipliedAlpha&&o.enable(9),U.shadowMapEnabled&&o.enable(10),U.doubleSided&&o.enable(11),U.flipSided&&o.enable(12),U.useDepthPacking&&o.enable(13),U.dithering&&o.enable(14),U.transmission&&o.enable(15),U.sheen&&o.enable(16),U.opaque&&o.enable(17),U.pointsUvs&&o.enable(18),U.decodeVideoTexture&&o.enable(19),U.decodeVideoTextureEmissive&&o.enable(20),U.alphaToCoverage&&o.enable(21),P.push(o.mask)}function x(P){const U=p[P.type];let G;if(U){const $=im[U];G=Dce.clone($.uniforms)}else G=P.uniforms;return G}function M(P,U){let G;for(let $=0,q=u.length;$<q;$++){const Y=u[$];if(Y.cacheKey===U){G=Y,++G.usedTimes;break}}return G===void 0&&(G=new cIe(t,U,P,s),u.push(G)),G}function R(P){if(--P.usedTimes===0){const U=u.indexOf(P);u[U]=u[u.length-1],u.pop(),P.destroy()}}function I(P){c.remove(P)}function k(){c.dispose()}return{getParameters:y,getProgramCacheKey:v,getUniforms:x,acquireProgram:M,releaseProgram:R,releaseShaderCache:I,programs:u,dispose:k}}function dIe(){let t=new WeakMap;function e(a){return t.has(a)}function n(a){let o=t.get(a);return o===void 0&&(o={},t.set(a,o)),o}function i(a){t.delete(a)}function r(a,o,c){t.get(a)[o]=c}function s(){t=new WeakMap}return{has:e,get:n,remove:i,update:r,dispose:s}}function pIe(t,e){return t.groupOrder!==e.groupOrder?t.groupOrder-e.groupOrder:t.renderOrder!==e.renderOrder?t.renderOrder-e.renderOrder:t.material.id!==e.material.id?t.material.id-e.material.id:t.z!==e.z?t.z-e.z:t.id-e.id}function BJ(t,e){return t.groupOrder!==e.groupOrder?t.groupOrder-e.groupOrder:t.renderOrder!==e.renderOrder?t.renderOrder-e.renderOrder:t.z!==e.z?e.z-t.z:t.id-e.id}function FJ(){const t=[];let e=0;const n=[],i=[],r=[];function s(){e=0,n.length=0,i.length=0,r.length=0}function a(h,f,d,p,g,y){let v=t[e];return v===void 0?(v={id:h.id,object:h,geometry:f,material:d,groupOrder:p,renderOrder:h.renderOrder,z:g,group:y},t[e]=v):(v.id=h.id,v.object=h,v.geometry=f,v.material=d,v.groupOrder=p,v.renderOrder=h.renderOrder,v.z=g,v.group=y),e++,v}function o(h,f,d,p,g,y){const v=a(h,f,d,p,g,y);d.transmission>0?i.push(v):d.transparent===!0?r.push(v):n.push(v)}function c(h,f,d,p,g,y){const v=a(h,f,d,p,g,y);d.transmission>0?i.unshift(v):d.transparent===!0?r.unshift(v):n.unshift(v)}function l(h,f){n.length>1&&n.sort(h||pIe),i.length>1&&i.sort(f||BJ),r.length>1&&r.sort(f||BJ)}function u(){for(let h=e,f=t.length;h<f;h++){const d=t[h];if(d.id===null)break;d.id=null,d.object=null,d.geometry=null,d.material=null,d.group=null}}return{opaque:n,transmissive:i,transparent:r,init:s,push:o,unshift:c,finish:u,sort:l}}function mIe(){let t=new WeakMap;function e(i,r){const s=t.get(i);let a;return s===void 0?(a=new FJ,t.set(i,[a])):r>=s.length?(a=new FJ,s.push(a)):a=s[r],a}function n(){t=new WeakMap}return{get:e,dispose:n}}function gIe(){const t={};return{get:function(e){if(t[e.id]!==void 0)return t[e.id];let n;switch(e.type){case"DirectionalLight":n={direction:new Ae,color:new yn};break;case"SpotLight":n={position:new Ae,direction:new Ae,color:new yn,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":n={position:new Ae,color:new yn,distance:0,decay:0};break;case"HemisphereLight":n={direction:new Ae,skyColor:new yn,groundColor:new yn};break;case"RectAreaLight":n={color:new yn,position:new Ae,halfWidth:new Ae,halfHeight:new Ae};break}return t[e.id]=n,n}}}function vIe(){const t={};return{get:function(e){if(t[e.id]!==void 0)return t[e.id];let n;switch(e.type){case"DirectionalLight":n={shadowIntensity:1,shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Rt};break;case"SpotLight":n={shadowIntensity:1,shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Rt};break;case"PointLight":n={shadowIntensity:1,shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Rt,shadowCameraNear:1,shadowCameraFar:1e3};break}return t[e.id]=n,n}}}let _Ie=0;function yIe(t,e){return(e.castShadow?2:0)-(t.castShadow?2:0)+(e.map?1:0)-(t.map?1:0)}function bIe(t){const e=new gIe,n=vIe(),i={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1,numSpotMaps:-1,numLightProbes:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotLightMap:[],spotShadow:[],spotShadowMap:[],spotLightMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[],numSpotLightShadowsWithMaps:0,numLightProbes:0};for(let l=0;l<9;l++)i.probe.push(new Ae);const r=new Ae,s=new Ni,a=new Ni;function o(l){let u=0,h=0,f=0;for(let P=0;P<9;P++)i.probe[P].set(0,0,0);let d=0,p=0,g=0,y=0,v=0,b=0,T=0,x=0,M=0,R=0,I=0;l.sort(yIe);for(let P=0,U=l.length;P<U;P++){const G=l[P],$=G.color,q=G.intensity,Y=G.distance,ie=G.shadow&&G.shadow.map?G.shadow.map.texture:null;if(G.isAmbientLight)u+=$.r*q,h+=$.g*q,f+=$.b*q;else if(G.isLightProbe){for(let V=0;V<9;V++)i.probe[V].addScaledVector(G.sh.coefficients[V],q);I++}else if(G.isDirectionalLight){const V=e.get(G);if(V.color.copy(G.color).multiplyScalar(G.intensity),G.castShadow){const J=G.shadow,X=n.get(G);X.shadowIntensity=J.intensity,X.shadowBias=J.bias,X.shadowNormalBias=J.normalBias,X.shadowRadius=J.radius,X.shadowMapSize=J.mapSize,i.directionalShadow[d]=X,i.directionalShadowMap[d]=ie,i.directionalShadowMatrix[d]=G.shadow.matrix,b++}i.directional[d]=V,d++}else if(G.isSpotLight){const V=e.get(G);V.position.setFromMatrixPosition(G.matrixWorld),V.color.copy($).multiplyScalar(q),V.distance=Y,V.coneCos=Math.cos(G.angle),V.penumbraCos=Math.cos(G.angle*(1-G.penumbra)),V.decay=G.decay,i.spot[g]=V;const J=G.shadow;if(G.map&&(i.spotLightMap[M]=G.map,M++,J.updateMatrices(G),G.castShadow&&R++),i.spotLightMatrix[g]=J.matrix,G.castShadow){const X=n.get(G);X.shadowIntensity=J.intensity,X.shadowBias=J.bias,X.shadowNormalBias=J.normalBias,X.shadowRadius=J.radius,X.shadowMapSize=J.mapSize,i.spotShadow[g]=X,i.spotShadowMap[g]=ie,x++}g++}else if(G.isRectAreaLight){const V=e.get(G);V.color.copy($).multiplyScalar(q),V.halfWidth.set(G.width*.5,0,0),V.halfHeight.set(0,G.height*.5,0),i.rectArea[y]=V,y++}else if(G.isPointLight){const V=e.get(G);if(V.color.copy(G.color).multiplyScalar(G.intensity),V.distance=G.distance,V.decay=G.decay,G.castShadow){const J=G.shadow,X=n.get(G);X.shadowIntensity=J.intensity,X.shadowBias=J.bias,X.shadowNormalBias=J.normalBias,X.shadowRadius=J.radius,X.shadowMapSize=J.mapSize,X.shadowCameraNear=J.camera.near,X.shadowCameraFar=J.camera.far,i.pointShadow[p]=X,i.pointShadowMap[p]=ie,i.pointShadowMatrix[p]=G.shadow.matrix,T++}i.point[p]=V,p++}else if(G.isHemisphereLight){const V=e.get(G);V.skyColor.copy(G.color).multiplyScalar(q),V.groundColor.copy(G.groundColor).multiplyScalar(q),i.hemi[v]=V,v++}}y>0&&(t.has("OES_texture_float_linear")===!0?(i.rectAreaLTC1=vn.LTC_FLOAT_1,i.rectAreaLTC2=vn.LTC_FLOAT_2):(i.rectAreaLTC1=vn.LTC_HALF_1,i.rectAreaLTC2=vn.LTC_HALF_2)),i.ambient[0]=u,i.ambient[1]=h,i.ambient[2]=f;const k=i.hash;(k.directionalLength!==d||k.pointLength!==p||k.spotLength!==g||k.rectAreaLength!==y||k.hemiLength!==v||k.numDirectionalShadows!==b||k.numPointShadows!==T||k.numSpotShadows!==x||k.numSpotMaps!==M||k.numLightProbes!==I)&&(i.directional.length=d,i.spot.length=g,i.rectArea.length=y,i.point.length=p,i.hemi.length=v,i.directionalShadow.length=b,i.directionalShadowMap.length=b,i.pointShadow.length=T,i.pointShadowMap.length=T,i.spotShadow.length=x,i.spotShadowMap.length=x,i.directionalShadowMatrix.length=b,i.pointShadowMatrix.length=T,i.spotLightMatrix.length=x+M-R,i.spotLightMap.length=M,i.numSpotLightShadowsWithMaps=R,i.numLightProbes=I,k.directionalLength=d,k.pointLength=p,k.spotLength=g,k.rectAreaLength=y,k.hemiLength=v,k.numDirectionalShadows=b,k.numPointShadows=T,k.numSpotShadows=x,k.numSpotMaps=M,k.numLightProbes=I,i.version=_Ie++)}function c(l,u){let h=0,f=0,d=0,p=0,g=0;const y=u.matrixWorldInverse;for(let v=0,b=l.length;v<b;v++){const T=l[v];if(T.isDirectionalLight){const x=i.directional[h];x.direction.setFromMatrixPosition(T.matrixWorld),r.setFromMatrixPosition(T.target.matrixWorld),x.direction.sub(r),x.direction.transformDirection(y),h++}else if(T.isSpotLight){const x=i.spot[d];x.position.setFromMatrixPosition(T.matrixWorld),x.position.applyMatrix4(y),x.direction.setFromMatrixPosition(T.matrixWorld),r.setFromMatrixPosition(T.target.matrixWorld),x.direction.sub(r),x.direction.transformDirection(y),d++}else if(T.isRectAreaLight){const x=i.rectArea[p];x.position.setFromMatrixPosition(T.matrixWorld),x.position.applyMatrix4(y),a.identity(),s.copy(T.matrixWorld),s.premultiply(y),a.extractRotation(s),x.halfWidth.set(T.width*.5,0,0),x.halfHeight.set(0,T.height*.5,0),x.halfWidth.applyMatrix4(a),x.halfHeight.applyMatrix4(a),p++}else if(T.isPointLight){const x=i.point[f];x.position.setFromMatrixPosition(T.matrixWorld),x.position.applyMatrix4(y),f++}else if(T.isHemisphereLight){const x=i.hemi[g];x.direction.setFromMatrixPosition(T.matrixWorld),x.direction.transformDirection(y),g++}}}return{setup:o,setupView:c,state:i}}function zJ(t){const e=new bIe(t),n=[],i=[];function r(u){l.camera=u,n.length=0,i.length=0}function s(u){n.push(u)}function a(u){i.push(u)}function o(){e.setup(n)}function c(u){e.setupView(n,u)}const l={lightsArray:n,shadowsArray:i,camera:null,lights:e,transmissionRenderTarget:{}};return{init:r,state:l,setupLights:o,setupLightsView:c,pushLight:s,pushShadow:a}}function EIe(t){let e=new WeakMap;function n(r,s=0){const a=e.get(r);let o;return a===void 0?(o=new zJ(t),e.set(r,[o])):s>=a.length?(o=new zJ(t),a.push(o)):o=a[s],o}function i(){e=new WeakMap}return{get:n,dispose:i}}const SIe=`void main() {
	gl_Position = vec4( position, 1.0 );
}`,TIe=`uniform sampler2D shadow_pass;
uniform vec2 resolution;
uniform float radius;
#include <packing>
void main() {
	const float samples = float( VSM_SAMPLES );
	float mean = 0.0;
	float squared_mean = 0.0;
	float uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );
	float uvStart = samples <= 1.0 ? 0.0 : - 1.0;
	for ( float i = 0.0; i < samples; i ++ ) {
		float uvOffset = uvStart + i * uvStride;
		#ifdef HORIZONTAL_PASS
			vec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ) );
			mean += distribution.x;
			squared_mean += distribution.y * distribution.y + distribution.x * distribution.x;
		#else
			float depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ) );
			mean += depth;
			squared_mean += depth * depth;
		#endif
	}
	mean = mean / samples;
	squared_mean = squared_mean / samples;
	float std_dev = sqrt( squared_mean - mean * mean );
	gl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );
}`;function xIe(t,e,n){let i=new yA;const r=new Rt,s=new Rt,a=new Zr,o=new x7({depthPacking:yce}),c=new w7,l={},u=n.maxTextureSize,h={[Zg]:Bc,[Bc]:Zg,[dl]:dl},f=new Hc({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new Rt},radius:{value:4}},vertexShader:SIe,fragmentShader:TIe}),d=f.clone();d.defines.HORIZONTAL_PASS=1;const p=new Qi;p.setAttribute("position",new rr(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));const g=new jo(p,f),y=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=fB;let v=this.type;this.render=function(R,I,k){if(y.enabled===!1||y.autoUpdate===!1&&y.needsUpdate===!1||R.length===0)return;const P=t.getRenderTarget(),U=t.getActiveCubeFace(),G=t.getActiveMipmapLevel(),$=t.state;$.setBlending(lp),$.buffers.color.setClear(1,1,1,1),$.buffers.depth.setTest(!0),$.setScissorTest(!1);const q=v!==em&&this.type===em,Y=v===em&&this.type!==em;for(let ie=0,V=R.length;ie<V;ie++){const J=R[ie],X=J.shadow;if(X===void 0){console.warn("THREE.WebGLShadowMap:",J,"has no shadow.");continue}if(X.autoUpdate===!1&&X.needsUpdate===!1)continue;r.copy(X.mapSize);const ee=X.getFrameExtents();if(r.multiply(ee),s.copy(X.mapSize),(r.x>u||r.y>u)&&(r.x>u&&(s.x=Math.floor(u/ee.x),r.x=s.x*ee.x,X.mapSize.x=s.x),r.y>u&&(s.y=Math.floor(u/ee.y),r.y=s.y*ee.y,X.mapSize.y=s.y)),X.map===null||q===!0||Y===!0){const fe=this.type!==em?{minFilter:eo,magFilter:eo}:{};X.map!==null&&X.map.dispose(),X.map=new Vl(r.x,r.y,fe),X.map.texture.name=J.name+".shadowMap",X.camera.updateProjectionMatrix()}t.setRenderTarget(X.map),t.clear();const oe=X.getViewportCount();for(let fe=0;fe<oe;fe++){const Re=X.getViewport(fe);a.set(s.x*Re.x,s.y*Re.y,s.x*Re.z,s.y*Re.w),$.viewport(a),X.updateMatrices(J,fe),i=X.getFrustum(),x(I,k,X.camera,J,this.type)}X.isPointLightShadow!==!0&&this.type===em&&b(X,k),X.needsUpdate=!1}v=this.type,y.needsUpdate=!1,t.setRenderTarget(P,U,G)};function b(R,I){const k=e.update(g);f.defines.VSM_SAMPLES!==R.blurSamples&&(f.defines.VSM_SAMPLES=R.blurSamples,d.defines.VSM_SAMPLES=R.blurSamples,f.needsUpdate=!0,d.needsUpdate=!0),R.mapPass===null&&(R.mapPass=new Vl(r.x,r.y)),f.uniforms.shadow_pass.value=R.map.texture,f.uniforms.resolution.value=R.mapSize,f.uniforms.radius.value=R.radius,t.setRenderTarget(R.mapPass),t.clear(),t.renderBufferDirect(I,null,k,f,g,null),d.uniforms.shadow_pass.value=R.mapPass.texture,d.uniforms.resolution.value=R.mapSize,d.uniforms.radius.value=R.radius,t.setRenderTarget(R.map),t.clear(),t.renderBufferDirect(I,null,k,d,g,null)}function T(R,I,k,P){let U=null;const G=k.isPointLight===!0?R.customDistanceMaterial:R.customDepthMaterial;if(G!==void 0)U=G;else if(U=k.isPointLight===!0?c:o,t.localClippingEnabled&&I.clipShadows===!0&&Array.isArray(I.clippingPlanes)&&I.clippingPlanes.length!==0||I.displacementMap&&I.displacementScale!==0||I.alphaMap&&I.alphaTest>0||I.map&&I.alphaTest>0||I.alphaToCoverage===!0){const $=U.uuid,q=I.uuid;let Y=l[$];Y===void 0&&(Y={},l[$]=Y);let ie=Y[q];ie===void 0&&(ie=U.clone(),Y[q]=ie,I.addEventListener("dispose",M)),U=ie}if(U.visible=I.visible,U.wireframe=I.wireframe,P===em?U.side=I.shadowSide!==null?I.shadowSide:I.side:U.side=I.shadowSide!==null?I.shadowSide:h[I.side],U.alphaMap=I.alphaMap,U.alphaTest=I.alphaToCoverage===!0?.5:I.alphaTest,U.map=I.map,U.clipShadows=I.clipShadows,U.clippingPlanes=I.clippingPlanes,U.clipIntersection=I.clipIntersection,U.displacementMap=I.displacementMap,U.displacementScale=I.displacementScale,U.displacementBias=I.displacementBias,U.wireframeLinewidth=I.wireframeLinewidth,U.linewidth=I.linewidth,k.isPointLight===!0&&U.isMeshDistanceMaterial===!0){const $=t.properties.get(U);$.light=k}return U}function x(R,I,k,P,U){if(R.visible===!1)return;if(R.layers.test(I.layers)&&(R.isMesh||R.isLine||R.isPoints)&&(R.castShadow||R.receiveShadow&&U===em)&&(!R.frustumCulled||i.intersectsObject(R))){R.modelViewMatrix.multiplyMatrices(k.matrixWorldInverse,R.matrixWorld);const q=e.update(R),Y=R.material;if(Array.isArray(Y)){const ie=q.groups;for(let V=0,J=ie.length;V<J;V++){const X=ie[V],ee=Y[X.materialIndex];if(ee&&ee.visible){const oe=T(R,ee,P,U);R.onBeforeShadow(t,R,I,k,q,oe,X),t.renderBufferDirect(k,null,q,oe,R,X),R.onAfterShadow(t,R,I,k,q,oe,X)}}}else if(Y.visible){const ie=T(R,Y,P,U);R.onBeforeShadow(t,R,I,k,q,ie,null),t.renderBufferDirect(k,null,q,ie,R,null),R.onAfterShadow(t,R,I,k,q,ie,null)}}const $=R.children;for(let q=0,Y=$.length;q<Y;q++)x($[q],I,k,P,U)}function M(R){R.target.removeEventListener("dispose",M);for(const k in l){const P=l[k],U=R.target.uuid;U in P&&(P[U].dispose(),delete P[U])}}}const wIe={[hL]:fL,[dL]:gL,[pL]:vL,[NT]:mL,[fL]:hL,[gL]:dL,[vL]:pL,[mL]:NT};function CIe(t,e){function n(){let qe=!1;const Vt=new Zr;let ht=null;const Pt=new Zr(0,0,0,0);return{setMask:function(hn){ht!==hn&&!qe&&(t.colorMask(hn,hn,hn,hn),ht=hn)},setLocked:function(hn){qe=hn},setClear:function(hn,an,Ge,ot,At){At===!0&&(hn*=ot,an*=ot,Ge*=ot),Vt.set(hn,an,Ge,ot),Pt.equals(Vt)===!1&&(t.clearColor(hn,an,Ge,ot),Pt.copy(Vt))},reset:function(){qe=!1,ht=null,Pt.set(-1,0,0,0)}}}function i(){let qe=!1,Vt=!1,ht=null,Pt=null,hn=null;return{setReversed:function(an){if(Vt!==an){const Ge=e.get("EXT_clip_control");an?Ge.clipControlEXT(Ge.LOWER_LEFT_EXT,Ge.ZERO_TO_ONE_EXT):Ge.clipControlEXT(Ge.LOWER_LEFT_EXT,Ge.NEGATIVE_ONE_TO_ONE_EXT),Vt=an;const ot=hn;hn=null,this.setClear(ot)}},getReversed:function(){return Vt},setTest:function(an){an?Ce(t.DEPTH_TEST):ke(t.DEPTH_TEST)},setMask:function(an){ht!==an&&!qe&&(t.depthMask(an),ht=an)},setFunc:function(an){if(Vt&&(an=wIe[an]),Pt!==an){switch(an){case hL:t.depthFunc(t.NEVER);break;case fL:t.depthFunc(t.ALWAYS);break;case dL:t.depthFunc(t.LESS);break;case NT:t.depthFunc(t.LEQUAL);break;case pL:t.depthFunc(t.EQUAL);break;case mL:t.depthFunc(t.GEQUAL);break;case gL:t.depthFunc(t.GREATER);break;case vL:t.depthFunc(t.NOTEQUAL);break;default:t.depthFunc(t.LEQUAL)}Pt=an}},setLocked:function(an){qe=an},setClear:function(an){hn!==an&&(Vt&&(an=1-an),t.clearDepth(an),hn=an)},reset:function(){qe=!1,ht=null,Pt=null,hn=null,Vt=!1}}}function r(){let qe=!1,Vt=null,ht=null,Pt=null,hn=null,an=null,Ge=null,ot=null,At=null;return{setTest:function(Nt){qe||(Nt?Ce(t.STENCIL_TEST):ke(t.STENCIL_TEST))},setMask:function(Nt){Vt!==Nt&&!qe&&(t.stencilMask(Nt),Vt=Nt)},setFunc:function(Nt,Yn,sr){(ht!==Nt||Pt!==Yn||hn!==sr)&&(t.stencilFunc(Nt,Yn,sr),ht=Nt,Pt=Yn,hn=sr)},setOp:function(Nt,Yn,sr){(an!==Nt||Ge!==Yn||ot!==sr)&&(t.stencilOp(Nt,Yn,sr),an=Nt,Ge=Yn,ot=sr)},setLocked:function(Nt){qe=Nt},setClear:function(Nt){At!==Nt&&(t.clearStencil(Nt),At=Nt)},reset:function(){qe=!1,Vt=null,ht=null,Pt=null,hn=null,an=null,Ge=null,ot=null,At=null}}}const s=new n,a=new i,o=new r,c=new WeakMap,l=new WeakMap;let u={},h={},f=new WeakMap,d=[],p=null,g=!1,y=null,v=null,b=null,T=null,x=null,M=null,R=null,I=new yn(0,0,0),k=0,P=!1,U=null,G=null,$=null,q=null,Y=null;const ie=t.getParameter(t.MAX_COMBINED_TEXTURE_IMAGE_UNITS);let V=!1,J=0;const X=t.getParameter(t.VERSION);X.indexOf("WebGL")!==-1?(J=parseFloat(/^WebGL (\d)/.exec(X)[1]),V=J>=1):X.indexOf("OpenGL ES")!==-1&&(J=parseFloat(/^OpenGL ES (\d)/.exec(X)[1]),V=J>=2);let ee=null,oe={};const fe=t.getParameter(t.SCISSOR_BOX),Re=t.getParameter(t.VIEWPORT),He=new Zr().fromArray(fe),Te=new Zr().fromArray(Re);function Le(qe,Vt,ht,Pt){const hn=new Uint8Array(4),an=t.createTexture();t.bindTexture(qe,an),t.texParameteri(qe,t.TEXTURE_MIN_FILTER,t.NEAREST),t.texParameteri(qe,t.TEXTURE_MAG_FILTER,t.NEAREST);for(let Ge=0;Ge<ht;Ge++)qe===t.TEXTURE_3D||qe===t.TEXTURE_2D_ARRAY?t.texImage3D(Vt,0,t.RGBA,1,1,Pt,0,t.RGBA,t.UNSIGNED_BYTE,hn):t.texImage2D(Vt+Ge,0,t.RGBA,1,1,0,t.RGBA,t.UNSIGNED_BYTE,hn);return an}const we={};we[t.TEXTURE_2D]=Le(t.TEXTURE_2D,t.TEXTURE_2D,1),we[t.TEXTURE_CUBE_MAP]=Le(t.TEXTURE_CUBE_MAP,t.TEXTURE_CUBE_MAP_POSITIVE_X,6),we[t.TEXTURE_2D_ARRAY]=Le(t.TEXTURE_2D_ARRAY,t.TEXTURE_2D_ARRAY,1,1),we[t.TEXTURE_3D]=Le(t.TEXTURE_3D,t.TEXTURE_3D,1,1),s.setClear(0,0,0,1),a.setClear(1),o.setClear(0),Ce(t.DEPTH_TEST),a.setFunc(NT),Ie(!1),rt(uV),Ce(t.CULL_FACE),de(lp);function Ce(qe){u[qe]!==!0&&(t.enable(qe),u[qe]=!0)}function ke(qe){u[qe]!==!1&&(t.disable(qe),u[qe]=!1)}function St(qe,Vt){return h[qe]!==Vt?(t.bindFramebuffer(qe,Vt),h[qe]=Vt,qe===t.DRAW_FRAMEBUFFER&&(h[t.FRAMEBUFFER]=Vt),qe===t.FRAMEBUFFER&&(h[t.DRAW_FRAMEBUFFER]=Vt),!0):!1}function Mt(qe,Vt){let ht=d,Pt=!1;if(qe){ht=f.get(Vt),ht===void 0&&(ht=[],f.set(Vt,ht));const hn=qe.textures;if(ht.length!==hn.length||ht[0]!==t.COLOR_ATTACHMENT0){for(let an=0,Ge=hn.length;an<Ge;an++)ht[an]=t.COLOR_ATTACHMENT0+an;ht.length=hn.length,Pt=!0}}else ht[0]!==t.BACK&&(ht[0]=t.BACK,Pt=!0);Pt&&t.drawBuffers(ht)}function Ee(qe){return p!==qe?(t.useProgram(qe),p=qe,!0):!1}const _e={[nb]:t.FUNC_ADD,[Goe]:t.FUNC_SUBTRACT,[qoe]:t.FUNC_REVERSE_SUBTRACT};_e[$oe]=t.MIN,_e[Woe]=t.MAX;const tt={[Yoe]:t.ZERO,[Xoe]:t.ONE,[Koe]:t.SRC_COLOR,[lL]:t.SRC_ALPHA,[nce]:t.SRC_ALPHA_SATURATE,[ece]:t.DST_COLOR,[Joe]:t.DST_ALPHA,[Zoe]:t.ONE_MINUS_SRC_COLOR,[uL]:t.ONE_MINUS_SRC_ALPHA,[tce]:t.ONE_MINUS_DST_COLOR,[Qoe]:t.ONE_MINUS_DST_ALPHA,[ice]:t.CONSTANT_COLOR,[rce]:t.ONE_MINUS_CONSTANT_COLOR,[sce]:t.CONSTANT_ALPHA,[ace]:t.ONE_MINUS_CONSTANT_ALPHA};function de(qe,Vt,ht,Pt,hn,an,Ge,ot,At,Nt){if(qe===lp){g===!0&&(ke(t.BLEND),g=!1);return}if(g===!1&&(Ce(t.BLEND),g=!0),qe!==Voe){if(qe!==y||Nt!==P){if((v!==nb||x!==nb)&&(t.blendEquation(t.FUNC_ADD),v=nb,x=nb),Nt)switch(qe){case pT:t.blendFuncSeparate(t.ONE,t.ONE_MINUS_SRC_ALPHA,t.ONE,t.ONE_MINUS_SRC_ALPHA);break;case hV:t.blendFunc(t.ONE,t.ONE);break;case fV:t.blendFuncSeparate(t.ZERO,t.ONE_MINUS_SRC_COLOR,t.ZERO,t.ONE);break;case dV:t.blendFuncSeparate(t.ZERO,t.SRC_COLOR,t.ZERO,t.SRC_ALPHA);break;default:console.error("THREE.WebGLState: Invalid blending: ",qe);break}else switch(qe){case pT:t.blendFuncSeparate(t.SRC_ALPHA,t.ONE_MINUS_SRC_ALPHA,t.ONE,t.ONE_MINUS_SRC_ALPHA);break;case hV:t.blendFunc(t.SRC_ALPHA,t.ONE);break;case fV:t.blendFuncSeparate(t.ZERO,t.ONE_MINUS_SRC_COLOR,t.ZERO,t.ONE);break;case dV:t.blendFunc(t.ZERO,t.SRC_COLOR);break;default:console.error("THREE.WebGLState: Invalid blending: ",qe);break}b=null,T=null,M=null,R=null,I.set(0,0,0),k=0,y=qe,P=Nt}return}hn=hn||Vt,an=an||ht,Ge=Ge||Pt,(Vt!==v||hn!==x)&&(t.blendEquationSeparate(_e[Vt],_e[hn]),v=Vt,x=hn),(ht!==b||Pt!==T||an!==M||Ge!==R)&&(t.blendFuncSeparate(tt[ht],tt[Pt],tt[an],tt[Ge]),b=ht,T=Pt,M=an,R=Ge),(ot.equals(I)===!1||At!==k)&&(t.blendColor(ot.r,ot.g,ot.b,At),I.copy(ot),k=At),y=qe,P=!1}function Be(qe,Vt){qe.side===dl?ke(t.CULL_FACE):Ce(t.CULL_FACE);let ht=qe.side===Bc;Vt&&(ht=!ht),Ie(ht),qe.blending===pT&&qe.transparent===!1?de(lp):de(qe.blending,qe.blendEquation,qe.blendSrc,qe.blendDst,qe.blendEquationAlpha,qe.blendSrcAlpha,qe.blendDstAlpha,qe.blendColor,qe.blendAlpha,qe.premultipliedAlpha),a.setFunc(qe.depthFunc),a.setTest(qe.depthTest),a.setMask(qe.depthWrite),s.setMask(qe.colorWrite);const Pt=qe.stencilWrite;o.setTest(Pt),Pt&&(o.setMask(qe.stencilWriteMask),o.setFunc(qe.stencilFunc,qe.stencilRef,qe.stencilFuncMask),o.setOp(qe.stencilFail,qe.stencilZFail,qe.stencilZPass)),gt(qe.polygonOffset,qe.polygonOffsetFactor,qe.polygonOffsetUnits),qe.alphaToCoverage===!0?Ce(t.SAMPLE_ALPHA_TO_COVERAGE):ke(t.SAMPLE_ALPHA_TO_COVERAGE)}function Ie(qe){U!==qe&&(qe?t.frontFace(t.CW):t.frontFace(t.CCW),U=qe)}function rt(qe){qe!==zoe?(Ce(t.CULL_FACE),qe!==G&&(qe===uV?t.cullFace(t.BACK):qe===Hoe?t.cullFace(t.FRONT):t.cullFace(t.FRONT_AND_BACK))):ke(t.CULL_FACE),G=qe}function ft(qe){qe!==$&&(V&&t.lineWidth(qe),$=qe)}function gt(qe,Vt,ht){qe?(Ce(t.POLYGON_OFFSET_FILL),(q!==Vt||Y!==ht)&&(t.polygonOffset(Vt,ht),q=Vt,Y=ht)):ke(t.POLYGON_OFFSET_FILL)}function bt(qe){qe?Ce(t.SCISSOR_TEST):ke(t.SCISSOR_TEST)}function be(qe){qe===void 0&&(qe=t.TEXTURE0+ie-1),ee!==qe&&(t.activeTexture(qe),ee=qe)}function ue(qe,Vt,ht){ht===void 0&&(ee===null?ht=t.TEXTURE0+ie-1:ht=ee);let Pt=oe[ht];Pt===void 0&&(Pt={type:void 0,texture:void 0},oe[ht]=Pt),(Pt.type!==qe||Pt.texture!==Vt)&&(ee!==ht&&(t.activeTexture(ht),ee=ht),t.bindTexture(qe,Vt||we[qe]),Pt.type=qe,Pt.texture=Vt)}function Xe(){const qe=oe[ee];qe!==void 0&&qe.type!==void 0&&(t.bindTexture(qe.type,null),qe.type=void 0,qe.texture=void 0)}function it(){try{t.compressedTexImage2D(...arguments)}catch(qe){console.error("THREE.WebGLState:",qe)}}function $e(){try{t.compressedTexImage3D(...arguments)}catch(qe){console.error("THREE.WebGLState:",qe)}}function Ue(){try{t.texSubImage2D(...arguments)}catch(qe){console.error("THREE.WebGLState:",qe)}}function qt(){try{t.texSubImage3D(...arguments)}catch(qe){console.error("THREE.WebGLState:",qe)}}function Ot(){try{t.compressedTexSubImage2D(...arguments)}catch(qe){console.error("THREE.WebGLState:",qe)}}function Yt(){try{t.compressedTexSubImage3D(...arguments)}catch(qe){console.error("THREE.WebGLState:",qe)}}function ce(){try{t.texStorage2D(...arguments)}catch(qe){console.error("THREE.WebGLState:",qe)}}function j(){try{t.texStorage3D(...arguments)}catch(qe){console.error("THREE.WebGLState:",qe)}}function W(){try{t.texImage2D(...arguments)}catch(qe){console.error("THREE.WebGLState:",qe)}}function me(){try{t.texImage3D(...arguments)}catch(qe){console.error("THREE.WebGLState:",qe)}}function De(qe){He.equals(qe)===!1&&(t.scissor(qe.x,qe.y,qe.z,qe.w),He.copy(qe))}function Ve(qe){Te.equals(qe)===!1&&(t.viewport(qe.x,qe.y,qe.z,qe.w),Te.copy(qe))}function mt(qe,Vt){let ht=l.get(Vt);ht===void 0&&(ht=new WeakMap,l.set(Vt,ht));let Pt=ht.get(qe);Pt===void 0&&(Pt=t.getUniformBlockIndex(Vt,qe.name),ht.set(qe,Pt))}function xt(qe,Vt){const Pt=l.get(Vt).get(qe);c.get(Vt)!==Pt&&(t.uniformBlockBinding(Vt,Pt,qe.__bindingPointIndex),c.set(Vt,Pt))}function Vn(){t.disable(t.BLEND),t.disable(t.CULL_FACE),t.disable(t.DEPTH_TEST),t.disable(t.POLYGON_OFFSET_FILL),t.disable(t.SCISSOR_TEST),t.disable(t.STENCIL_TEST),t.disable(t.SAMPLE_ALPHA_TO_COVERAGE),t.blendEquation(t.FUNC_ADD),t.blendFunc(t.ONE,t.ZERO),t.blendFuncSeparate(t.ONE,t.ZERO,t.ONE,t.ZERO),t.blendColor(0,0,0,0),t.colorMask(!0,!0,!0,!0),t.clearColor(0,0,0,0),t.depthMask(!0),t.depthFunc(t.LESS),a.setReversed(!1),t.clearDepth(1),t.stencilMask(4294967295),t.stencilFunc(t.ALWAYS,0,4294967295),t.stencilOp(t.KEEP,t.KEEP,t.KEEP),t.clearStencil(0),t.cullFace(t.BACK),t.frontFace(t.CCW),t.polygonOffset(0,0),t.activeTexture(t.TEXTURE0),t.bindFramebuffer(t.FRAMEBUFFER,null),t.bindFramebuffer(t.DRAW_FRAMEBUFFER,null),t.bindFramebuffer(t.READ_FRAMEBUFFER,null),t.useProgram(null),t.lineWidth(1),t.scissor(0,0,t.canvas.width,t.canvas.height),t.viewport(0,0,t.canvas.width,t.canvas.height),u={},ee=null,oe={},h={},f=new WeakMap,d=[],p=null,g=!1,y=null,v=null,b=null,T=null,x=null,M=null,R=null,I=new yn(0,0,0),k=0,P=!1,U=null,G=null,$=null,q=null,Y=null,He.set(0,0,t.canvas.width,t.canvas.height),Te.set(0,0,t.canvas.width,t.canvas.height),s.reset(),a.reset(),o.reset()}return{buffers:{color:s,depth:a,stencil:o},enable:Ce,disable:ke,bindFramebuffer:St,drawBuffers:Mt,useProgram:Ee,setBlending:de,setMaterial:Be,setFlipSided:Ie,setCullFace:rt,setLineWidth:ft,setPolygonOffset:gt,setScissorTest:bt,activeTexture:be,bindTexture:ue,unbindTexture:Xe,compressedTexImage2D:it,compressedTexImage3D:$e,texImage2D:W,texImage3D:me,updateUBOMapping:mt,uniformBlockBinding:xt,texStorage2D:ce,texStorage3D:j,texSubImage2D:Ue,texSubImage3D:qt,compressedTexSubImage2D:Ot,compressedTexSubImage3D:Yt,scissor:De,viewport:Ve,reset:Vn}}function AIe(t,e,n,i,r,s,a){const o=e.has("WEBGL_multisampled_render_to_texture")?e.get("WEBGL_multisampled_render_to_texture"):null,c=typeof navigator>"u"?!1:/OculusBrowser/g.test(navigator.userAgent),l=new Rt,u=new WeakMap;let h;const f=new WeakMap;let d=!1;try{d=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")!==null}catch{}function p(be,ue){return d?new OffscreenCanvas(be,ue):_O("canvas")}function g(be,ue,Xe){let it=1;const $e=bt(be);if(($e.width>Xe||$e.height>Xe)&&(it=Xe/Math.max($e.width,$e.height)),it<1)if(typeof HTMLImageElement<"u"&&be instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&be instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&be instanceof ImageBitmap||typeof VideoFrame<"u"&&be instanceof VideoFrame){const Ue=Math.floor(it*$e.width),qt=Math.floor(it*$e.height);h===void 0&&(h=p(Ue,qt));const Ot=ue?p(Ue,qt):h;return Ot.width=Ue,Ot.height=qt,Ot.getContext("2d").drawImage(be,0,0,Ue,qt),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+$e.width+"x"+$e.height+") to ("+Ue+"x"+qt+")."),Ot}else return"data"in be&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+$e.width+"x"+$e.height+")."),be;return be}function y(be){return be.generateMipmaps}function v(be){t.generateMipmap(be)}function b(be){return be.isWebGLCubeRenderTarget?t.TEXTURE_CUBE_MAP:be.isWebGL3DRenderTarget?t.TEXTURE_3D:be.isWebGLArrayRenderTarget||be.isCompressedArrayTexture?t.TEXTURE_2D_ARRAY:t.TEXTURE_2D}function T(be,ue,Xe,it,$e=!1){if(be!==null){if(t[be]!==void 0)return t[be];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+be+"'")}let Ue=ue;if(ue===t.RED&&(Xe===t.FLOAT&&(Ue=t.R32F),Xe===t.HALF_FLOAT&&(Ue=t.R16F),Xe===t.UNSIGNED_BYTE&&(Ue=t.R8)),ue===t.RED_INTEGER&&(Xe===t.UNSIGNED_BYTE&&(Ue=t.R8UI),Xe===t.UNSIGNED_SHORT&&(Ue=t.R16UI),Xe===t.UNSIGNED_INT&&(Ue=t.R32UI),Xe===t.BYTE&&(Ue=t.R8I),Xe===t.SHORT&&(Ue=t.R16I),Xe===t.INT&&(Ue=t.R32I)),ue===t.RG&&(Xe===t.FLOAT&&(Ue=t.RG32F),Xe===t.HALF_FLOAT&&(Ue=t.RG16F),Xe===t.UNSIGNED_BYTE&&(Ue=t.RG8)),ue===t.RG_INTEGER&&(Xe===t.UNSIGNED_BYTE&&(Ue=t.RG8UI),Xe===t.UNSIGNED_SHORT&&(Ue=t.RG16UI),Xe===t.UNSIGNED_INT&&(Ue=t.RG32UI),Xe===t.BYTE&&(Ue=t.RG8I),Xe===t.SHORT&&(Ue=t.RG16I),Xe===t.INT&&(Ue=t.RG32I)),ue===t.RGB_INTEGER&&(Xe===t.UNSIGNED_BYTE&&(Ue=t.RGB8UI),Xe===t.UNSIGNED_SHORT&&(Ue=t.RGB16UI),Xe===t.UNSIGNED_INT&&(Ue=t.RGB32UI),Xe===t.BYTE&&(Ue=t.RGB8I),Xe===t.SHORT&&(Ue=t.RGB16I),Xe===t.INT&&(Ue=t.RGB32I)),ue===t.RGBA_INTEGER&&(Xe===t.UNSIGNED_BYTE&&(Ue=t.RGBA8UI),Xe===t.UNSIGNED_SHORT&&(Ue=t.RGBA16UI),Xe===t.UNSIGNED_INT&&(Ue=t.RGBA32UI),Xe===t.BYTE&&(Ue=t.RGBA8I),Xe===t.SHORT&&(Ue=t.RGBA16I),Xe===t.INT&&(Ue=t.RGBA32I)),ue===t.RGB&&Xe===t.UNSIGNED_INT_5_9_9_9_REV&&(Ue=t.RGB9_E5),ue===t.RGBA){const qt=$e?mO:Ur.getTransfer(it);Xe===t.FLOAT&&(Ue=t.RGBA32F),Xe===t.HALF_FLOAT&&(Ue=t.RGBA16F),Xe===t.UNSIGNED_BYTE&&(Ue=qt===As?t.SRGB8_ALPHA8:t.RGBA8),Xe===t.UNSIGNED_SHORT_4_4_4_4&&(Ue=t.RGBA4),Xe===t.UNSIGNED_SHORT_5_5_5_1&&(Ue=t.RGB5_A1)}return(Ue===t.R16F||Ue===t.R32F||Ue===t.RG16F||Ue===t.RG32F||Ue===t.RGBA16F||Ue===t.RGBA32F)&&e.get("EXT_color_buffer_float"),Ue}function x(be,ue){let Xe;return be?ue===null||ue===Jg||ue===IT?Xe=t.DEPTH24_STENCIL8:ue===hu?Xe=t.DEPTH32F_STENCIL8:ue===vC&&(Xe=t.DEPTH24_STENCIL8,console.warn("DepthTexture: 16 bit depth attachment is not supported with stencil. Using 24-bit attachment.")):ue===null||ue===Jg||ue===IT?Xe=t.DEPTH_COMPONENT24:ue===hu?Xe=t.DEPTH_COMPONENT32F:ue===vC&&(Xe=t.DEPTH_COMPONENT16),Xe}function M(be,ue){return y(be)===!0||be.isFramebufferTexture&&be.minFilter!==eo&&be.minFilter!==Ea?Math.log2(Math.max(ue.width,ue.height))+1:be.mipmaps!==void 0&&be.mipmaps.length>0?be.mipmaps.length:be.isCompressedTexture&&Array.isArray(be.image)?ue.mipmaps.length:1}function R(be){const ue=be.target;ue.removeEventListener("dispose",R),k(ue),ue.isVideoTexture&&u.delete(ue)}function I(be){const ue=be.target;ue.removeEventListener("dispose",I),U(ue)}function k(be){const ue=i.get(be);if(ue.__webglInit===void 0)return;const Xe=be.source,it=f.get(Xe);if(it){const $e=it[ue.__cacheKey];$e.usedTimes--,$e.usedTimes===0&&P(be),Object.keys(it).length===0&&f.delete(Xe)}i.remove(be)}function P(be){const ue=i.get(be);t.deleteTexture(ue.__webglTexture);const Xe=be.source,it=f.get(Xe);delete it[ue.__cacheKey],a.memory.textures--}function U(be){const ue=i.get(be);if(be.depthTexture&&(be.depthTexture.dispose(),i.remove(be.depthTexture)),be.isWebGLCubeRenderTarget)for(let it=0;it<6;it++){if(Array.isArray(ue.__webglFramebuffer[it]))for(let $e=0;$e<ue.__webglFramebuffer[it].length;$e++)t.deleteFramebuffer(ue.__webglFramebuffer[it][$e]);else t.deleteFramebuffer(ue.__webglFramebuffer[it]);ue.__webglDepthbuffer&&t.deleteRenderbuffer(ue.__webglDepthbuffer[it])}else{if(Array.isArray(ue.__webglFramebuffer))for(let it=0;it<ue.__webglFramebuffer.length;it++)t.deleteFramebuffer(ue.__webglFramebuffer[it]);else t.deleteFramebuffer(ue.__webglFramebuffer);if(ue.__webglDepthbuffer&&t.deleteRenderbuffer(ue.__webglDepthbuffer),ue.__webglMultisampledFramebuffer&&t.deleteFramebuffer(ue.__webglMultisampledFramebuffer),ue.__webglColorRenderbuffer)for(let it=0;it<ue.__webglColorRenderbuffer.length;it++)ue.__webglColorRenderbuffer[it]&&t.deleteRenderbuffer(ue.__webglColorRenderbuffer[it]);ue.__webglDepthRenderbuffer&&t.deleteRenderbuffer(ue.__webglDepthRenderbuffer)}const Xe=be.textures;for(let it=0,$e=Xe.length;it<$e;it++){const Ue=i.get(Xe[it]);Ue.__webglTexture&&(t.deleteTexture(Ue.__webglTexture),a.memory.textures--),i.remove(Xe[it])}i.remove(be)}let G=0;function $(){G=0}function q(){const be=G;return be>=r.maxTextures&&console.warn("THREE.WebGLTextures: Trying to use "+be+" texture units while this GPU supports only "+r.maxTextures),G+=1,be}function Y(be){const ue=[];return ue.push(be.wrapS),ue.push(be.wrapT),ue.push(be.wrapR||0),ue.push(be.magFilter),ue.push(be.minFilter),ue.push(be.anisotropy),ue.push(be.internalFormat),ue.push(be.format),ue.push(be.type),ue.push(be.generateMipmaps),ue.push(be.premultiplyAlpha),ue.push(be.flipY),ue.push(be.unpackAlignment),ue.push(be.colorSpace),ue.join()}function ie(be,ue){const Xe=i.get(be);if(be.isVideoTexture&&ft(be),be.isRenderTargetTexture===!1&&be.version>0&&Xe.__version!==be.version){const it=be.image;if(it===null)console.warn("THREE.WebGLRenderer: Texture marked for update but no image data found.");else if(it.complete===!1)console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete");else{Te(Xe,be,ue);return}}n.bindTexture(t.TEXTURE_2D,Xe.__webglTexture,t.TEXTURE0+ue)}function V(be,ue){const Xe=i.get(be);if(be.version>0&&Xe.__version!==be.version){Te(Xe,be,ue);return}n.bindTexture(t.TEXTURE_2D_ARRAY,Xe.__webglTexture,t.TEXTURE0+ue)}function J(be,ue){const Xe=i.get(be);if(be.version>0&&Xe.__version!==be.version){Te(Xe,be,ue);return}n.bindTexture(t.TEXTURE_3D,Xe.__webglTexture,t.TEXTURE0+ue)}function X(be,ue){const Xe=i.get(be);if(be.version>0&&Xe.__version!==be.version){Le(Xe,be,ue);return}n.bindTexture(t.TEXTURE_CUBE_MAP,Xe.__webglTexture,t.TEXTURE0+ue)}const ee={[hO]:t.REPEAT,[np]:t.CLAMP_TO_EDGE,[fO]:t.MIRRORED_REPEAT},oe={[eo]:t.NEAREST,[e7]:t.NEAREST_MIPMAP_NEAREST,[fw]:t.NEAREST_MIPMAP_LINEAR,[Ea]:t.LINEAR,[_M]:t.LINEAR_MIPMAP_NEAREST,[Ig]:t.LINEAR_MIPMAP_LINEAR},fe={[Ece]:t.NEVER,[Ace]:t.ALWAYS,[Sce]:t.LESS,[l7]:t.LEQUAL,[Tce]:t.EQUAL,[Cce]:t.GEQUAL,[xce]:t.GREATER,[wce]:t.NOTEQUAL};function Re(be,ue){if(ue.type===hu&&e.has("OES_texture_float_linear")===!1&&(ue.magFilter===Ea||ue.magFilter===_M||ue.magFilter===fw||ue.magFilter===Ig||ue.minFilter===Ea||ue.minFilter===_M||ue.minFilter===fw||ue.minFilter===Ig)&&console.warn("THREE.WebGLRenderer: Unable to use linear filtering with floating point textures. OES_texture_float_linear not supported on this device."),t.texParameteri(be,t.TEXTURE_WRAP_S,ee[ue.wrapS]),t.texParameteri(be,t.TEXTURE_WRAP_T,ee[ue.wrapT]),(be===t.TEXTURE_3D||be===t.TEXTURE_2D_ARRAY)&&t.texParameteri(be,t.TEXTURE_WRAP_R,ee[ue.wrapR]),t.texParameteri(be,t.TEXTURE_MAG_FILTER,oe[ue.magFilter]),t.texParameteri(be,t.TEXTURE_MIN_FILTER,oe[ue.minFilter]),ue.compareFunction&&(t.texParameteri(be,t.TEXTURE_COMPARE_MODE,t.COMPARE_REF_TO_TEXTURE),t.texParameteri(be,t.TEXTURE_COMPARE_FUNC,fe[ue.compareFunction])),e.has("EXT_texture_filter_anisotropic")===!0){if(ue.magFilter===eo||ue.minFilter!==fw&&ue.minFilter!==Ig||ue.type===hu&&e.has("OES_texture_float_linear")===!1)return;if(ue.anisotropy>1||i.get(ue).__currentAnisotropy){const Xe=e.get("EXT_texture_filter_anisotropic");t.texParameterf(be,Xe.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(ue.anisotropy,r.getMaxAnisotropy())),i.get(ue).__currentAnisotropy=ue.anisotropy}}}function He(be,ue){let Xe=!1;be.__webglInit===void 0&&(be.__webglInit=!0,ue.addEventListener("dispose",R));const it=ue.source;let $e=f.get(it);$e===void 0&&($e={},f.set(it,$e));const Ue=Y(ue);if(Ue!==be.__cacheKey){$e[Ue]===void 0&&($e[Ue]={texture:t.createTexture(),usedTimes:0},a.memory.textures++,Xe=!0),$e[Ue].usedTimes++;const qt=$e[be.__cacheKey];qt!==void 0&&($e[be.__cacheKey].usedTimes--,qt.usedTimes===0&&P(ue)),be.__cacheKey=Ue,be.__webglTexture=$e[Ue].texture}return Xe}function Te(be,ue,Xe){let it=t.TEXTURE_2D;(ue.isDataArrayTexture||ue.isCompressedArrayTexture)&&(it=t.TEXTURE_2D_ARRAY),ue.isData3DTexture&&(it=t.TEXTURE_3D);const $e=He(be,ue),Ue=ue.source;n.bindTexture(it,be.__webglTexture,t.TEXTURE0+Xe);const qt=i.get(Ue);if(Ue.version!==qt.__version||$e===!0){n.activeTexture(t.TEXTURE0+Xe);const Ot=Ur.getPrimaries(Ur.workingColorSpace),Yt=ue.colorSpace===om?null:Ur.getPrimaries(ue.colorSpace),ce=ue.colorSpace===om||Ot===Yt?t.NONE:t.BROWSER_DEFAULT_WEBGL;t.pixelStorei(t.UNPACK_FLIP_Y_WEBGL,ue.flipY),t.pixelStorei(t.UNPACK_PREMULTIPLY_ALPHA_WEBGL,ue.premultiplyAlpha),t.pixelStorei(t.UNPACK_ALIGNMENT,ue.unpackAlignment),t.pixelStorei(t.UNPACK_COLORSPACE_CONVERSION_WEBGL,ce);let j=g(ue.image,!1,r.maxTextureSize);j=gt(ue,j);const W=s.convert(ue.format,ue.colorSpace),me=s.convert(ue.type);let De=T(ue.internalFormat,W,me,ue.colorSpace,ue.isVideoTexture);Re(it,ue);let Ve;const mt=ue.mipmaps,xt=ue.isVideoTexture!==!0,Vn=qt.__version===void 0||$e===!0,qe=Ue.dataReady,Vt=M(ue,j);if(ue.isDepthTexture)De=x(ue.format===kT,ue.type),Vn&&(xt?n.texStorage2D(t.TEXTURE_2D,1,De,j.width,j.height):n.texImage2D(t.TEXTURE_2D,0,De,j.width,j.height,0,W,me,null));else if(ue.isDataTexture)if(mt.length>0){xt&&Vn&&n.texStorage2D(t.TEXTURE_2D,Vt,De,mt[0].width,mt[0].height);for(let ht=0,Pt=mt.length;ht<Pt;ht++)Ve=mt[ht],xt?qe&&n.texSubImage2D(t.TEXTURE_2D,ht,0,0,Ve.width,Ve.height,W,me,Ve.data):n.texImage2D(t.TEXTURE_2D,ht,De,Ve.width,Ve.height,0,W,me,Ve.data);ue.generateMipmaps=!1}else xt?(Vn&&n.texStorage2D(t.TEXTURE_2D,Vt,De,j.width,j.height),qe&&n.texSubImage2D(t.TEXTURE_2D,0,0,0,j.width,j.height,W,me,j.data)):n.texImage2D(t.TEXTURE_2D,0,De,j.width,j.height,0,W,me,j.data);else if(ue.isCompressedTexture)if(ue.isCompressedArrayTexture){xt&&Vn&&n.texStorage3D(t.TEXTURE_2D_ARRAY,Vt,De,mt[0].width,mt[0].height,j.depth);for(let ht=0,Pt=mt.length;ht<Pt;ht++)if(Ve=mt[ht],ue.format!==fu)if(W!==null)if(xt){if(qe)if(ue.layerUpdates.size>0){const hn=TV(Ve.width,Ve.height,ue.format,ue.type);for(const an of ue.layerUpdates){const Ge=Ve.data.subarray(an*hn/Ve.data.BYTES_PER_ELEMENT,(an+1)*hn/Ve.data.BYTES_PER_ELEMENT);n.compressedTexSubImage3D(t.TEXTURE_2D_ARRAY,ht,0,0,an,Ve.width,Ve.height,1,W,Ge)}ue.clearLayerUpdates()}else n.compressedTexSubImage3D(t.TEXTURE_2D_ARRAY,ht,0,0,0,Ve.width,Ve.height,j.depth,W,Ve.data)}else n.compressedTexImage3D(t.TEXTURE_2D_ARRAY,ht,De,Ve.width,Ve.height,j.depth,0,Ve.data,0,0);else console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()");else xt?qe&&n.texSubImage3D(t.TEXTURE_2D_ARRAY,ht,0,0,0,Ve.width,Ve.height,j.depth,W,me,Ve.data):n.texImage3D(t.TEXTURE_2D_ARRAY,ht,De,Ve.width,Ve.height,j.depth,0,W,me,Ve.data)}else{xt&&Vn&&n.texStorage2D(t.TEXTURE_2D,Vt,De,mt[0].width,mt[0].height);for(let ht=0,Pt=mt.length;ht<Pt;ht++)Ve=mt[ht],ue.format!==fu?W!==null?xt?qe&&n.compressedTexSubImage2D(t.TEXTURE_2D,ht,0,0,Ve.width,Ve.height,W,Ve.data):n.compressedTexImage2D(t.TEXTURE_2D,ht,De,Ve.width,Ve.height,0,Ve.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):xt?qe&&n.texSubImage2D(t.TEXTURE_2D,ht,0,0,Ve.width,Ve.height,W,me,Ve.data):n.texImage2D(t.TEXTURE_2D,ht,De,Ve.width,Ve.height,0,W,me,Ve.data)}else if(ue.isDataArrayTexture)if(xt){if(Vn&&n.texStorage3D(t.TEXTURE_2D_ARRAY,Vt,De,j.width,j.height,j.depth),qe)if(ue.layerUpdates.size>0){const ht=TV(j.width,j.height,ue.format,ue.type);for(const Pt of ue.layerUpdates){const hn=j.data.subarray(Pt*ht/j.data.BYTES_PER_ELEMENT,(Pt+1)*ht/j.data.BYTES_PER_ELEMENT);n.texSubImage3D(t.TEXTURE_2D_ARRAY,0,0,0,Pt,j.width,j.height,1,W,me,hn)}ue.clearLayerUpdates()}else n.texSubImage3D(t.TEXTURE_2D_ARRAY,0,0,0,0,j.width,j.height,j.depth,W,me,j.data)}else n.texImage3D(t.TEXTURE_2D_ARRAY,0,De,j.width,j.height,j.depth,0,W,me,j.data);else if(ue.isData3DTexture)xt?(Vn&&n.texStorage3D(t.TEXTURE_3D,Vt,De,j.width,j.height,j.depth),qe&&n.texSubImage3D(t.TEXTURE_3D,0,0,0,0,j.width,j.height,j.depth,W,me,j.data)):n.texImage3D(t.TEXTURE_3D,0,De,j.width,j.height,j.depth,0,W,me,j.data);else if(ue.isFramebufferTexture){if(Vn)if(xt)n.texStorage2D(t.TEXTURE_2D,Vt,De,j.width,j.height);else{let ht=j.width,Pt=j.height;for(let hn=0;hn<Vt;hn++)n.texImage2D(t.TEXTURE_2D,hn,De,ht,Pt,0,W,me,null),ht>>=1,Pt>>=1}}else if(mt.length>0){if(xt&&Vn){const ht=bt(mt[0]);n.texStorage2D(t.TEXTURE_2D,Vt,De,ht.width,ht.height)}for(let ht=0,Pt=mt.length;ht<Pt;ht++)Ve=mt[ht],xt?qe&&n.texSubImage2D(t.TEXTURE_2D,ht,0,0,W,me,Ve):n.texImage2D(t.TEXTURE_2D,ht,De,W,me,Ve);ue.generateMipmaps=!1}else if(xt){if(Vn){const ht=bt(j);n.texStorage2D(t.TEXTURE_2D,Vt,De,ht.width,ht.height)}qe&&n.texSubImage2D(t.TEXTURE_2D,0,0,0,W,me,j)}else n.texImage2D(t.TEXTURE_2D,0,De,W,me,j);y(ue)&&v(it),qt.__version=Ue.version,ue.onUpdate&&ue.onUpdate(ue)}be.__version=ue.version}function Le(be,ue,Xe){if(ue.image.length!==6)return;const it=He(be,ue),$e=ue.source;n.bindTexture(t.TEXTURE_CUBE_MAP,be.__webglTexture,t.TEXTURE0+Xe);const Ue=i.get($e);if($e.version!==Ue.__version||it===!0){n.activeTexture(t.TEXTURE0+Xe);const qt=Ur.getPrimaries(Ur.workingColorSpace),Ot=ue.colorSpace===om?null:Ur.getPrimaries(ue.colorSpace),Yt=ue.colorSpace===om||qt===Ot?t.NONE:t.BROWSER_DEFAULT_WEBGL;t.pixelStorei(t.UNPACK_FLIP_Y_WEBGL,ue.flipY),t.pixelStorei(t.UNPACK_PREMULTIPLY_ALPHA_WEBGL,ue.premultiplyAlpha),t.pixelStorei(t.UNPACK_ALIGNMENT,ue.unpackAlignment),t.pixelStorei(t.UNPACK_COLORSPACE_CONVERSION_WEBGL,Yt);const ce=ue.isCompressedTexture||ue.image[0].isCompressedTexture,j=ue.image[0]&&ue.image[0].isDataTexture,W=[];for(let Pt=0;Pt<6;Pt++)!ce&&!j?W[Pt]=g(ue.image[Pt],!0,r.maxCubemapSize):W[Pt]=j?ue.image[Pt].image:ue.image[Pt],W[Pt]=gt(ue,W[Pt]);const me=W[0],De=s.convert(ue.format,ue.colorSpace),Ve=s.convert(ue.type),mt=T(ue.internalFormat,De,Ve,ue.colorSpace),xt=ue.isVideoTexture!==!0,Vn=Ue.__version===void 0||it===!0,qe=$e.dataReady;let Vt=M(ue,me);Re(t.TEXTURE_CUBE_MAP,ue);let ht;if(ce){xt&&Vn&&n.texStorage2D(t.TEXTURE_CUBE_MAP,Vt,mt,me.width,me.height);for(let Pt=0;Pt<6;Pt++){ht=W[Pt].mipmaps;for(let hn=0;hn<ht.length;hn++){const an=ht[hn];ue.format!==fu?De!==null?xt?qe&&n.compressedTexSubImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+Pt,hn,0,0,an.width,an.height,De,an.data):n.compressedTexImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+Pt,hn,mt,an.width,an.height,0,an.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):xt?qe&&n.texSubImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+Pt,hn,0,0,an.width,an.height,De,Ve,an.data):n.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+Pt,hn,mt,an.width,an.height,0,De,Ve,an.data)}}}else{if(ht=ue.mipmaps,xt&&Vn){ht.length>0&&Vt++;const Pt=bt(W[0]);n.texStorage2D(t.TEXTURE_CUBE_MAP,Vt,mt,Pt.width,Pt.height)}for(let Pt=0;Pt<6;Pt++)if(j){xt?qe&&n.texSubImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+Pt,0,0,0,W[Pt].width,W[Pt].height,De,Ve,W[Pt].data):n.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+Pt,0,mt,W[Pt].width,W[Pt].height,0,De,Ve,W[Pt].data);for(let hn=0;hn<ht.length;hn++){const Ge=ht[hn].image[Pt].image;xt?qe&&n.texSubImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+Pt,hn+1,0,0,Ge.width,Ge.height,De,Ve,Ge.data):n.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+Pt,hn+1,mt,Ge.width,Ge.height,0,De,Ve,Ge.data)}}else{xt?qe&&n.texSubImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+Pt,0,0,0,De,Ve,W[Pt]):n.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+Pt,0,mt,De,Ve,W[Pt]);for(let hn=0;hn<ht.length;hn++){const an=ht[hn];xt?qe&&n.texSubImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+Pt,hn+1,0,0,De,Ve,an.image[Pt]):n.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+Pt,hn+1,mt,De,Ve,an.image[Pt])}}}y(ue)&&v(t.TEXTURE_CUBE_MAP),Ue.__version=$e.version,ue.onUpdate&&ue.onUpdate(ue)}be.__version=ue.version}function we(be,ue,Xe,it,$e,Ue){const qt=s.convert(Xe.format,Xe.colorSpace),Ot=s.convert(Xe.type),Yt=T(Xe.internalFormat,qt,Ot,Xe.colorSpace),ce=i.get(ue),j=i.get(Xe);if(j.__renderTarget=ue,!ce.__hasExternalTextures){const W=Math.max(1,ue.width>>Ue),me=Math.max(1,ue.height>>Ue);$e===t.TEXTURE_3D||$e===t.TEXTURE_2D_ARRAY?n.texImage3D($e,Ue,Yt,W,me,ue.depth,0,qt,Ot,null):n.texImage2D($e,Ue,Yt,W,me,0,qt,Ot,null)}n.bindFramebuffer(t.FRAMEBUFFER,be),rt(ue)?o.framebufferTexture2DMultisampleEXT(t.FRAMEBUFFER,it,$e,j.__webglTexture,0,Ie(ue)):($e===t.TEXTURE_2D||$e>=t.TEXTURE_CUBE_MAP_POSITIVE_X&&$e<=t.TEXTURE_CUBE_MAP_NEGATIVE_Z)&&t.framebufferTexture2D(t.FRAMEBUFFER,it,$e,j.__webglTexture,Ue),n.bindFramebuffer(t.FRAMEBUFFER,null)}function Ce(be,ue,Xe){if(t.bindRenderbuffer(t.RENDERBUFFER,be),ue.depthBuffer){const it=ue.depthTexture,$e=it&&it.isDepthTexture?it.type:null,Ue=x(ue.stencilBuffer,$e),qt=ue.stencilBuffer?t.DEPTH_STENCIL_ATTACHMENT:t.DEPTH_ATTACHMENT,Ot=Ie(ue);rt(ue)?o.renderbufferStorageMultisampleEXT(t.RENDERBUFFER,Ot,Ue,ue.width,ue.height):Xe?t.renderbufferStorageMultisample(t.RENDERBUFFER,Ot,Ue,ue.width,ue.height):t.renderbufferStorage(t.RENDERBUFFER,Ue,ue.width,ue.height),t.framebufferRenderbuffer(t.FRAMEBUFFER,qt,t.RENDERBUFFER,be)}else{const it=ue.textures;for(let $e=0;$e<it.length;$e++){const Ue=it[$e],qt=s.convert(Ue.format,Ue.colorSpace),Ot=s.convert(Ue.type),Yt=T(Ue.internalFormat,qt,Ot,Ue.colorSpace),ce=Ie(ue);Xe&&rt(ue)===!1?t.renderbufferStorageMultisample(t.RENDERBUFFER,ce,Yt,ue.width,ue.height):rt(ue)?o.renderbufferStorageMultisampleEXT(t.RENDERBUFFER,ce,Yt,ue.width,ue.height):t.renderbufferStorage(t.RENDERBUFFER,Yt,ue.width,ue.height)}}t.bindRenderbuffer(t.RENDERBUFFER,null)}function ke(be,ue){if(ue&&ue.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(n.bindFramebuffer(t.FRAMEBUFFER,be),!(ue.depthTexture&&ue.depthTexture.isDepthTexture))throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");const it=i.get(ue.depthTexture);it.__renderTarget=ue,(!it.__webglTexture||ue.depthTexture.image.width!==ue.width||ue.depthTexture.image.height!==ue.height)&&(ue.depthTexture.image.width=ue.width,ue.depthTexture.image.height=ue.height,ue.depthTexture.needsUpdate=!0),ie(ue.depthTexture,0);const $e=it.__webglTexture,Ue=Ie(ue);if(ue.depthTexture.format===_C)rt(ue)?o.framebufferTexture2DMultisampleEXT(t.FRAMEBUFFER,t.DEPTH_ATTACHMENT,t.TEXTURE_2D,$e,0,Ue):t.framebufferTexture2D(t.FRAMEBUFFER,t.DEPTH_ATTACHMENT,t.TEXTURE_2D,$e,0);else if(ue.depthTexture.format===kT)rt(ue)?o.framebufferTexture2DMultisampleEXT(t.FRAMEBUFFER,t.DEPTH_STENCIL_ATTACHMENT,t.TEXTURE_2D,$e,0,Ue):t.framebufferTexture2D(t.FRAMEBUFFER,t.DEPTH_STENCIL_ATTACHMENT,t.TEXTURE_2D,$e,0);else throw new Error("Unknown depthTexture format")}function St(be){const ue=i.get(be),Xe=be.isWebGLCubeRenderTarget===!0;if(ue.__boundDepthTexture!==be.depthTexture){const it=be.depthTexture;if(ue.__depthDisposeCallback&&ue.__depthDisposeCallback(),it){const $e=()=>{delete ue.__boundDepthTexture,delete ue.__depthDisposeCallback,it.removeEventListener("dispose",$e)};it.addEventListener("dispose",$e),ue.__depthDisposeCallback=$e}ue.__boundDepthTexture=it}if(be.depthTexture&&!ue.__autoAllocateDepthBuffer){if(Xe)throw new Error("target.depthTexture not supported in Cube render targets");const it=be.texture.mipmaps;it&&it.length>0?ke(ue.__webglFramebuffer[0],be):ke(ue.__webglFramebuffer,be)}else if(Xe){ue.__webglDepthbuffer=[];for(let it=0;it<6;it++)if(n.bindFramebuffer(t.FRAMEBUFFER,ue.__webglFramebuffer[it]),ue.__webglDepthbuffer[it]===void 0)ue.__webglDepthbuffer[it]=t.createRenderbuffer(),Ce(ue.__webglDepthbuffer[it],be,!1);else{const $e=be.stencilBuffer?t.DEPTH_STENCIL_ATTACHMENT:t.DEPTH_ATTACHMENT,Ue=ue.__webglDepthbuffer[it];t.bindRenderbuffer(t.RENDERBUFFER,Ue),t.framebufferRenderbuffer(t.FRAMEBUFFER,$e,t.RENDERBUFFER,Ue)}}else{const it=be.texture.mipmaps;if(it&&it.length>0?n.bindFramebuffer(t.FRAMEBUFFER,ue.__webglFramebuffer[0]):n.bindFramebuffer(t.FRAMEBUFFER,ue.__webglFramebuffer),ue.__webglDepthbuffer===void 0)ue.__webglDepthbuffer=t.createRenderbuffer(),Ce(ue.__webglDepthbuffer,be,!1);else{const $e=be.stencilBuffer?t.DEPTH_STENCIL_ATTACHMENT:t.DEPTH_ATTACHMENT,Ue=ue.__webglDepthbuffer;t.bindRenderbuffer(t.RENDERBUFFER,Ue),t.framebufferRenderbuffer(t.FRAMEBUFFER,$e,t.RENDERBUFFER,Ue)}}n.bindFramebuffer(t.FRAMEBUFFER,null)}function Mt(be,ue,Xe){const it=i.get(be);ue!==void 0&&we(it.__webglFramebuffer,be,be.texture,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,0),Xe!==void 0&&St(be)}function Ee(be){const ue=be.texture,Xe=i.get(be),it=i.get(ue);be.addEventListener("dispose",I);const $e=be.textures,Ue=be.isWebGLCubeRenderTarget===!0,qt=$e.length>1;if(qt||(it.__webglTexture===void 0&&(it.__webglTexture=t.createTexture()),it.__version=ue.version,a.memory.textures++),Ue){Xe.__webglFramebuffer=[];for(let Ot=0;Ot<6;Ot++)if(ue.mipmaps&&ue.mipmaps.length>0){Xe.__webglFramebuffer[Ot]=[];for(let Yt=0;Yt<ue.mipmaps.length;Yt++)Xe.__webglFramebuffer[Ot][Yt]=t.createFramebuffer()}else Xe.__webglFramebuffer[Ot]=t.createFramebuffer()}else{if(ue.mipmaps&&ue.mipmaps.length>0){Xe.__webglFramebuffer=[];for(let Ot=0;Ot<ue.mipmaps.length;Ot++)Xe.__webglFramebuffer[Ot]=t.createFramebuffer()}else Xe.__webglFramebuffer=t.createFramebuffer();if(qt)for(let Ot=0,Yt=$e.length;Ot<Yt;Ot++){const ce=i.get($e[Ot]);ce.__webglTexture===void 0&&(ce.__webglTexture=t.createTexture(),a.memory.textures++)}if(be.samples>0&&rt(be)===!1){Xe.__webglMultisampledFramebuffer=t.createFramebuffer(),Xe.__webglColorRenderbuffer=[],n.bindFramebuffer(t.FRAMEBUFFER,Xe.__webglMultisampledFramebuffer);for(let Ot=0;Ot<$e.length;Ot++){const Yt=$e[Ot];Xe.__webglColorRenderbuffer[Ot]=t.createRenderbuffer(),t.bindRenderbuffer(t.RENDERBUFFER,Xe.__webglColorRenderbuffer[Ot]);const ce=s.convert(Yt.format,Yt.colorSpace),j=s.convert(Yt.type),W=T(Yt.internalFormat,ce,j,Yt.colorSpace,be.isXRRenderTarget===!0),me=Ie(be);t.renderbufferStorageMultisample(t.RENDERBUFFER,me,W,be.width,be.height),t.framebufferRenderbuffer(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0+Ot,t.RENDERBUFFER,Xe.__webglColorRenderbuffer[Ot])}t.bindRenderbuffer(t.RENDERBUFFER,null),be.depthBuffer&&(Xe.__webglDepthRenderbuffer=t.createRenderbuffer(),Ce(Xe.__webglDepthRenderbuffer,be,!0)),n.bindFramebuffer(t.FRAMEBUFFER,null)}}if(Ue){n.bindTexture(t.TEXTURE_CUBE_MAP,it.__webglTexture),Re(t.TEXTURE_CUBE_MAP,ue);for(let Ot=0;Ot<6;Ot++)if(ue.mipmaps&&ue.mipmaps.length>0)for(let Yt=0;Yt<ue.mipmaps.length;Yt++)we(Xe.__webglFramebuffer[Ot][Yt],be,ue,t.COLOR_ATTACHMENT0,t.TEXTURE_CUBE_MAP_POSITIVE_X+Ot,Yt);else we(Xe.__webglFramebuffer[Ot],be,ue,t.COLOR_ATTACHMENT0,t.TEXTURE_CUBE_MAP_POSITIVE_X+Ot,0);y(ue)&&v(t.TEXTURE_CUBE_MAP),n.unbindTexture()}else if(qt){for(let Ot=0,Yt=$e.length;Ot<Yt;Ot++){const ce=$e[Ot],j=i.get(ce);n.bindTexture(t.TEXTURE_2D,j.__webglTexture),Re(t.TEXTURE_2D,ce),we(Xe.__webglFramebuffer,be,ce,t.COLOR_ATTACHMENT0+Ot,t.TEXTURE_2D,0),y(ce)&&v(t.TEXTURE_2D)}n.unbindTexture()}else{let Ot=t.TEXTURE_2D;if((be.isWebGL3DRenderTarget||be.isWebGLArrayRenderTarget)&&(Ot=be.isWebGL3DRenderTarget?t.TEXTURE_3D:t.TEXTURE_2D_ARRAY),n.bindTexture(Ot,it.__webglTexture),Re(Ot,ue),ue.mipmaps&&ue.mipmaps.length>0)for(let Yt=0;Yt<ue.mipmaps.length;Yt++)we(Xe.__webglFramebuffer[Yt],be,ue,t.COLOR_ATTACHMENT0,Ot,Yt);else we(Xe.__webglFramebuffer,be,ue,t.COLOR_ATTACHMENT0,Ot,0);y(ue)&&v(Ot),n.unbindTexture()}be.depthBuffer&&St(be)}function _e(be){const ue=be.textures;for(let Xe=0,it=ue.length;Xe<it;Xe++){const $e=ue[Xe];if(y($e)){const Ue=b(be),qt=i.get($e).__webglTexture;n.bindTexture(Ue,qt),v(Ue),n.unbindTexture()}}}const tt=[],de=[];function Be(be){if(be.samples>0){if(rt(be)===!1){const ue=be.textures,Xe=be.width,it=be.height;let $e=t.COLOR_BUFFER_BIT;const Ue=be.stencilBuffer?t.DEPTH_STENCIL_ATTACHMENT:t.DEPTH_ATTACHMENT,qt=i.get(be),Ot=ue.length>1;if(Ot)for(let ce=0;ce<ue.length;ce++)n.bindFramebuffer(t.FRAMEBUFFER,qt.__webglMultisampledFramebuffer),t.framebufferRenderbuffer(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0+ce,t.RENDERBUFFER,null),n.bindFramebuffer(t.FRAMEBUFFER,qt.__webglFramebuffer),t.framebufferTexture2D(t.DRAW_FRAMEBUFFER,t.COLOR_ATTACHMENT0+ce,t.TEXTURE_2D,null,0);n.bindFramebuffer(t.READ_FRAMEBUFFER,qt.__webglMultisampledFramebuffer);const Yt=be.texture.mipmaps;Yt&&Yt.length>0?n.bindFramebuffer(t.DRAW_FRAMEBUFFER,qt.__webglFramebuffer[0]):n.bindFramebuffer(t.DRAW_FRAMEBUFFER,qt.__webglFramebuffer);for(let ce=0;ce<ue.length;ce++){if(be.resolveDepthBuffer&&(be.depthBuffer&&($e|=t.DEPTH_BUFFER_BIT),be.stencilBuffer&&be.resolveStencilBuffer&&($e|=t.STENCIL_BUFFER_BIT)),Ot){t.framebufferRenderbuffer(t.READ_FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.RENDERBUFFER,qt.__webglColorRenderbuffer[ce]);const j=i.get(ue[ce]).__webglTexture;t.framebufferTexture2D(t.DRAW_FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,j,0)}t.blitFramebuffer(0,0,Xe,it,0,0,Xe,it,$e,t.NEAREST),c===!0&&(tt.length=0,de.length=0,tt.push(t.COLOR_ATTACHMENT0+ce),be.depthBuffer&&be.resolveDepthBuffer===!1&&(tt.push(Ue),de.push(Ue),t.invalidateFramebuffer(t.DRAW_FRAMEBUFFER,de)),t.invalidateFramebuffer(t.READ_FRAMEBUFFER,tt))}if(n.bindFramebuffer(t.READ_FRAMEBUFFER,null),n.bindFramebuffer(t.DRAW_FRAMEBUFFER,null),Ot)for(let ce=0;ce<ue.length;ce++){n.bindFramebuffer(t.FRAMEBUFFER,qt.__webglMultisampledFramebuffer),t.framebufferRenderbuffer(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0+ce,t.RENDERBUFFER,qt.__webglColorRenderbuffer[ce]);const j=i.get(ue[ce]).__webglTexture;n.bindFramebuffer(t.FRAMEBUFFER,qt.__webglFramebuffer),t.framebufferTexture2D(t.DRAW_FRAMEBUFFER,t.COLOR_ATTACHMENT0+ce,t.TEXTURE_2D,j,0)}n.bindFramebuffer(t.DRAW_FRAMEBUFFER,qt.__webglMultisampledFramebuffer)}else if(be.depthBuffer&&be.resolveDepthBuffer===!1&&c){const ue=be.stencilBuffer?t.DEPTH_STENCIL_ATTACHMENT:t.DEPTH_ATTACHMENT;t.invalidateFramebuffer(t.DRAW_FRAMEBUFFER,[ue])}}}function Ie(be){return Math.min(r.maxSamples,be.samples)}function rt(be){const ue=i.get(be);return be.samples>0&&e.has("WEBGL_multisampled_render_to_texture")===!0&&ue.__useRenderToTexture!==!1}function ft(be){const ue=a.render.frame;u.get(be)!==ue&&(u.set(be,ue),be.update())}function gt(be,ue){const Xe=be.colorSpace,it=be.format,$e=be.type;return be.isCompressedTexture===!0||be.isVideoTexture===!0||Xe!==Qg&&Xe!==om&&(Ur.getTransfer(Xe)===As?(it!==fu||$e!==El)&&console.warn("THREE.WebGLTextures: sRGB encoded textures have to use RGBAFormat and UnsignedByteType."):console.error("THREE.WebGLTextures: Unsupported texture color space:",Xe)),ue}function bt(be){return typeof HTMLImageElement<"u"&&be instanceof HTMLImageElement?(l.width=be.naturalWidth||be.width,l.height=be.naturalHeight||be.height):typeof VideoFrame<"u"&&be instanceof VideoFrame?(l.width=be.displayWidth,l.height=be.displayHeight):(l.width=be.width,l.height=be.height),l}this.allocateTextureUnit=q,this.resetTextureUnits=$,this.setTexture2D=ie,this.setTexture2DArray=V,this.setTexture3D=J,this.setTextureCube=X,this.rebindTextures=Mt,this.setupRenderTarget=Ee,this.updateRenderTargetMipmap=_e,this.updateMultisampleRenderTarget=Be,this.setupDepthRenderbuffer=St,this.setupFrameBufferTexture=we,this.useMultisampledRTT=rt}function Fle(t,e){function n(i,r=om){let s;const a=Ur.getTransfer(r);if(i===El)return t.UNSIGNED_BYTE;if(i===mB)return t.UNSIGNED_SHORT_4_4_4_4;if(i===gB)return t.UNSIGNED_SHORT_5_5_5_1;if(i===i7)return t.UNSIGNED_INT_5_9_9_9_REV;if(i===t7)return t.BYTE;if(i===n7)return t.SHORT;if(i===vC)return t.UNSIGNED_SHORT;if(i===pB)return t.INT;if(i===Jg)return t.UNSIGNED_INT;if(i===hu)return t.FLOAT;if(i===lE)return t.HALF_FLOAT;if(i===r7)return t.ALPHA;if(i===s7)return t.RGB;if(i===fu)return t.RGBA;if(i===_C)return t.DEPTH_COMPONENT;if(i===kT)return t.DEPTH_STENCIL;if(i===vB)return t.RED;if(i===eI)return t.RED_INTEGER;if(i===a7)return t.RG;if(i===_B)return t.RG_INTEGER;if(i===tI)return t.RGBA_INTEGER;if(i===yM||i===bM||i===EM||i===SM)if(a===As)if(s=e.get("WEBGL_compressed_texture_s3tc_srgb"),s!==null){if(i===yM)return s.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(i===bM)return s.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(i===EM)return s.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(i===SM)return s.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else return null;else if(s=e.get("WEBGL_compressed_texture_s3tc"),s!==null){if(i===yM)return s.COMPRESSED_RGB_S3TC_DXT1_EXT;if(i===bM)return s.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(i===EM)return s.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(i===SM)return s.COMPRESSED_RGBA_S3TC_DXT5_EXT}else return null;if(i===_L||i===yL||i===bL||i===EL)if(s=e.get("WEBGL_compressed_texture_pvrtc"),s!==null){if(i===_L)return s.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(i===yL)return s.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(i===bL)return s.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(i===EL)return s.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}else return null;if(i===SL||i===TL||i===xL)if(s=e.get("WEBGL_compressed_texture_etc"),s!==null){if(i===SL||i===TL)return a===As?s.COMPRESSED_SRGB8_ETC2:s.COMPRESSED_RGB8_ETC2;if(i===xL)return a===As?s.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:s.COMPRESSED_RGBA8_ETC2_EAC}else return null;if(i===wL||i===CL||i===AL||i===RL||i===ML||i===OL||i===NL||i===IL||i===kL||i===DL||i===PL||i===LL||i===UL||i===BL)if(s=e.get("WEBGL_compressed_texture_astc"),s!==null){if(i===wL)return a===As?s.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:s.COMPRESSED_RGBA_ASTC_4x4_KHR;if(i===CL)return a===As?s.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:s.COMPRESSED_RGBA_ASTC_5x4_KHR;if(i===AL)return a===As?s.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:s.COMPRESSED_RGBA_ASTC_5x5_KHR;if(i===RL)return a===As?s.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:s.COMPRESSED_RGBA_ASTC_6x5_KHR;if(i===ML)return a===As?s.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:s.COMPRESSED_RGBA_ASTC_6x6_KHR;if(i===OL)return a===As?s.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:s.COMPRESSED_RGBA_ASTC_8x5_KHR;if(i===NL)return a===As?s.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:s.COMPRESSED_RGBA_ASTC_8x6_KHR;if(i===IL)return a===As?s.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:s.COMPRESSED_RGBA_ASTC_8x8_KHR;if(i===kL)return a===As?s.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:s.COMPRESSED_RGBA_ASTC_10x5_KHR;if(i===DL)return a===As?s.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:s.COMPRESSED_RGBA_ASTC_10x6_KHR;if(i===PL)return a===As?s.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:s.COMPRESSED_RGBA_ASTC_10x8_KHR;if(i===LL)return a===As?s.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:s.COMPRESSED_RGBA_ASTC_10x10_KHR;if(i===UL)return a===As?s.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:s.COMPRESSED_RGBA_ASTC_12x10_KHR;if(i===BL)return a===As?s.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:s.COMPRESSED_RGBA_ASTC_12x12_KHR}else return null;if(i===TM||i===FL||i===zL)if(s=e.get("EXT_texture_compression_bptc"),s!==null){if(i===TM)return a===As?s.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:s.COMPRESSED_RGBA_BPTC_UNORM_EXT;if(i===FL)return s.COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT;if(i===zL)return s.COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT}else return null;if(i===o7||i===HL||i===jL||i===VL)if(s=e.get("EXT_texture_compression_rgtc"),s!==null){if(i===TM)return s.COMPRESSED_RED_RGTC1_EXT;if(i===HL)return s.COMPRESSED_SIGNED_RED_RGTC1_EXT;if(i===jL)return s.COMPRESSED_RED_GREEN_RGTC2_EXT;if(i===VL)return s.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT}else return null;return i===IT?t.UNSIGNED_INT_24_8:t[i]!==void 0?t[i]:null}return{convert:n}}const RIe=`
void main() {

	gl_Position = vec4( position, 1.0 );

}`,MIe=`
uniform sampler2DArray depthColor;
uniform float depthWidth;
uniform float depthHeight;

void main() {

	vec2 coord = vec2( gl_FragCoord.x / depthWidth, gl_FragCoord.y / depthHeight );

	if ( coord.x >= 1.0 ) {

		gl_FragDepth = texture( depthColor, vec3( coord.x - 1.0, coord.y, 1 ) ).r;

	} else {

		gl_FragDepth = texture( depthColor, vec3( coord.x, coord.y, 0 ) ).r;

	}

}`;class OIe{constructor(){this.texture=null,this.mesh=null,this.depthNear=0,this.depthFar=0}init(e,n,i){if(this.texture===null){const r=new Ba,s=e.properties.get(r);s.__webglTexture=n.texture,(n.depthNear!==i.depthNear||n.depthFar!==i.depthFar)&&(this.depthNear=n.depthNear,this.depthFar=n.depthFar),this.texture=r}}getMesh(e){if(this.texture!==null&&this.mesh===null){const n=e.cameras[0].viewport,i=new Hc({vertexShader:RIe,fragmentShader:MIe,uniforms:{depthColor:{value:this.texture},depthWidth:{value:n.z},depthHeight:{value:n.w}}});this.mesh=new jo(new EA(20,20),i)}return this.mesh}reset(){this.texture=null,this.mesh=null}getDepthTexture(){return this.texture}}class NIe extends cd{constructor(e,n){super();const i=this;let r=null,s=1,a=null,o="local-floor",c=1,l=null,u=null,h=null,f=null,d=null,p=null;const g=new OIe,y=n.getContextAttributes();let v=null,b=null;const T=[],x=[],M=new Rt;let R=null;const I=new Pc;I.viewport=new Zr;const k=new Pc;k.viewport=new Zr;const P=[I,k],U=new Rle;let G=null,$=null;this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getController=function(Te){let Le=T[Te];return Le===void 0&&(Le=new ZP,T[Te]=Le),Le.getTargetRaySpace()},this.getControllerGrip=function(Te){let Le=T[Te];return Le===void 0&&(Le=new ZP,T[Te]=Le),Le.getGripSpace()},this.getHand=function(Te){let Le=T[Te];return Le===void 0&&(Le=new ZP,T[Te]=Le),Le.getHandSpace()};function q(Te){const Le=x.indexOf(Te.inputSource);if(Le===-1)return;const we=T[Le];we!==void 0&&(we.update(Te.inputSource,Te.frame,l||a),we.dispatchEvent({type:Te.type,data:Te.inputSource}))}function Y(){r.removeEventListener("select",q),r.removeEventListener("selectstart",q),r.removeEventListener("selectend",q),r.removeEventListener("squeeze",q),r.removeEventListener("squeezestart",q),r.removeEventListener("squeezeend",q),r.removeEventListener("end",Y),r.removeEventListener("inputsourceschange",ie);for(let Te=0;Te<T.length;Te++){const Le=x[Te];Le!==null&&(x[Te]=null,T[Te].disconnect(Le))}G=null,$=null,g.reset(),e.setRenderTarget(v),d=null,f=null,h=null,r=null,b=null,He.stop(),i.isPresenting=!1,e.setPixelRatio(R),e.setSize(M.width,M.height,!1),i.dispatchEvent({type:"sessionend"})}this.setFramebufferScaleFactor=function(Te){s=Te,i.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(Te){o=Te,i.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return l||a},this.setReferenceSpace=function(Te){l=Te},this.getBaseLayer=function(){return f!==null?f:d},this.getBinding=function(){return h},this.getFrame=function(){return p},this.getSession=function(){return r},this.setSession=async function(Te){if(r=Te,r!==null){if(v=e.getRenderTarget(),r.addEventListener("select",q),r.addEventListener("selectstart",q),r.addEventListener("selectend",q),r.addEventListener("squeeze",q),r.addEventListener("squeezestart",q),r.addEventListener("squeezeend",q),r.addEventListener("end",Y),r.addEventListener("inputsourceschange",ie),y.xrCompatible!==!0&&await n.makeXRCompatible(),R=e.getPixelRatio(),e.getSize(M),typeof XRWebGLBinding<"u"&&"createProjectionLayer"in XRWebGLBinding.prototype){let we=null,Ce=null,ke=null;y.depth&&(ke=y.stencil?n.DEPTH24_STENCIL8:n.DEPTH_COMPONENT24,we=y.stencil?kT:_C,Ce=y.stencil?IT:Jg);const St={colorFormat:n.RGBA8,depthFormat:ke,scaleFactor:s};h=new XRWebGLBinding(r,n),f=h.createProjectionLayer(St),r.updateRenderState({layers:[f]}),e.setPixelRatio(1),e.setSize(f.textureWidth,f.textureHeight,!1),b=new Vl(f.textureWidth,f.textureHeight,{format:fu,type:El,depthTexture:new bA(f.textureWidth,f.textureHeight,Ce,void 0,void 0,void 0,void 0,void 0,void 0,we),stencilBuffer:y.stencil,colorSpace:e.outputColorSpace,samples:y.antialias?4:0,resolveDepthBuffer:f.ignoreDepthValues===!1,resolveStencilBuffer:f.ignoreDepthValues===!1})}else{const we={antialias:y.antialias,alpha:!0,depth:y.depth,stencil:y.stencil,framebufferScaleFactor:s};d=new XRWebGLLayer(r,n,we),r.updateRenderState({baseLayer:d}),e.setPixelRatio(1),e.setSize(d.framebufferWidth,d.framebufferHeight,!1),b=new Vl(d.framebufferWidth,d.framebufferHeight,{format:fu,type:El,colorSpace:e.outputColorSpace,stencilBuffer:y.stencil,resolveDepthBuffer:d.ignoreDepthValues===!1,resolveStencilBuffer:d.ignoreDepthValues===!1})}b.isXRRenderTarget=!0,this.setFoveation(c),l=null,a=await r.requestReferenceSpace(o),He.setContext(r),He.start(),i.isPresenting=!0,i.dispatchEvent({type:"sessionstart"})}},this.getEnvironmentBlendMode=function(){if(r!==null)return r.environmentBlendMode},this.getDepthTexture=function(){return g.getDepthTexture()};function ie(Te){for(let Le=0;Le<Te.removed.length;Le++){const we=Te.removed[Le],Ce=x.indexOf(we);Ce>=0&&(x[Ce]=null,T[Ce].disconnect(we))}for(let Le=0;Le<Te.added.length;Le++){const we=Te.added[Le];let Ce=x.indexOf(we);if(Ce===-1){for(let St=0;St<T.length;St++)if(St>=x.length){x.push(we),Ce=St;break}else if(x[St]===null){x[St]=we,Ce=St;break}if(Ce===-1)break}const ke=T[Ce];ke&&ke.connect(we)}}const V=new Ae,J=new Ae;function X(Te,Le,we){V.setFromMatrixPosition(Le.matrixWorld),J.setFromMatrixPosition(we.matrixWorld);const Ce=V.distanceTo(J),ke=Le.projectionMatrix.elements,St=we.projectionMatrix.elements,Mt=ke[14]/(ke[10]-1),Ee=ke[14]/(ke[10]+1),_e=(ke[9]+1)/ke[5],tt=(ke[9]-1)/ke[5],de=(ke[8]-1)/ke[0],Be=(St[8]+1)/St[0],Ie=Mt*de,rt=Mt*Be,ft=Ce/(-de+Be),gt=ft*-de;if(Le.matrixWorld.decompose(Te.position,Te.quaternion,Te.scale),Te.translateX(gt),Te.translateZ(ft),Te.matrixWorld.compose(Te.position,Te.quaternion,Te.scale),Te.matrixWorldInverse.copy(Te.matrixWorld).invert(),ke[10]===-1)Te.projectionMatrix.copy(Le.projectionMatrix),Te.projectionMatrixInverse.copy(Le.projectionMatrixInverse);else{const bt=Mt+ft,be=Ee+ft,ue=Ie-gt,Xe=rt+(Ce-gt),it=_e*Ee/be*bt,$e=tt*Ee/be*bt;Te.projectionMatrix.makePerspective(ue,Xe,it,$e,bt,be),Te.projectionMatrixInverse.copy(Te.projectionMatrix).invert()}}function ee(Te,Le){Le===null?Te.matrixWorld.copy(Te.matrix):Te.matrixWorld.multiplyMatrices(Le.matrixWorld,Te.matrix),Te.matrixWorldInverse.copy(Te.matrixWorld).invert()}this.updateCamera=function(Te){if(r===null)return;let Le=Te.near,we=Te.far;g.texture!==null&&(g.depthNear>0&&(Le=g.depthNear),g.depthFar>0&&(we=g.depthFar)),U.near=k.near=I.near=Le,U.far=k.far=I.far=we,(G!==U.near||$!==U.far)&&(r.updateRenderState({depthNear:U.near,depthFar:U.far}),G=U.near,$=U.far),I.layers.mask=Te.layers.mask|2,k.layers.mask=Te.layers.mask|4,U.layers.mask=I.layers.mask|k.layers.mask;const Ce=Te.parent,ke=U.cameras;ee(U,Ce);for(let St=0;St<ke.length;St++)ee(ke[St],Ce);ke.length===2?X(U,I,k):U.projectionMatrix.copy(I.projectionMatrix),oe(Te,U,Ce)};function oe(Te,Le,we){we===null?Te.matrix.copy(Le.matrixWorld):(Te.matrix.copy(we.matrixWorld),Te.matrix.invert(),Te.matrix.multiply(Le.matrixWorld)),Te.matrix.decompose(Te.position,Te.quaternion,Te.scale),Te.updateMatrixWorld(!0),Te.projectionMatrix.copy(Le.projectionMatrix),Te.projectionMatrixInverse.copy(Le.projectionMatrixInverse),Te.isPerspectiveCamera&&(Te.fov=yC*2*Math.atan(1/Te.projectionMatrix.elements[5]),Te.zoom=1)}this.getCamera=function(){return U},this.getFoveation=function(){if(!(f===null&&d===null))return c},this.setFoveation=function(Te){c=Te,f!==null&&(f.fixedFoveation=Te),d!==null&&d.fixedFoveation!==void 0&&(d.fixedFoveation=Te)},this.hasDepthSensing=function(){return g.texture!==null},this.getDepthSensingMesh=function(){return g.getMesh(U)};let fe=null;function Re(Te,Le){if(u=Le.getViewerPose(l||a),p=Le,u!==null){const we=u.views;d!==null&&(e.setRenderTargetFramebuffer(b,d.framebuffer),e.setRenderTarget(b));let Ce=!1;we.length!==U.cameras.length&&(U.cameras.length=0,Ce=!0);for(let Mt=0;Mt<we.length;Mt++){const Ee=we[Mt];let _e=null;if(d!==null)_e=d.getViewport(Ee);else{const de=h.getViewSubImage(f,Ee);_e=de.viewport,Mt===0&&(e.setRenderTargetTextures(b,de.colorTexture,de.depthStencilTexture),e.setRenderTarget(b))}let tt=P[Mt];tt===void 0&&(tt=new Pc,tt.layers.enable(Mt),tt.viewport=new Zr,P[Mt]=tt),tt.matrix.fromArray(Ee.transform.matrix),tt.matrix.decompose(tt.position,tt.quaternion,tt.scale),tt.projectionMatrix.fromArray(Ee.projectionMatrix),tt.projectionMatrixInverse.copy(tt.projectionMatrix).invert(),tt.viewport.set(_e.x,_e.y,_e.width,_e.height),Mt===0&&(U.matrix.copy(tt.matrix),U.matrix.decompose(U.position,U.quaternion,U.scale)),Ce===!0&&U.cameras.push(tt)}const ke=r.enabledFeatures;if(ke&&ke.includes("depth-sensing")&&r.depthUsage=="gpu-optimized"&&h){const Mt=h.getDepthInformation(we[0]);Mt&&Mt.isValid&&Mt.texture&&g.init(e,Mt,r.renderState)}}for(let we=0;we<T.length;we++){const Ce=x[we],ke=T[we];Ce!==null&&ke!==void 0&&ke.update(Ce,Le,l||a)}fe&&fe(Te,Le),Le.detectedPlanes&&i.dispatchEvent({type:"planesdetected",data:Le}),p=null}const He=new Dle;He.setAnimationLoop(Re),this.setAnimationLoop=function(Te){fe=Te},this.dispose=function(){}}}const MS=new rf,IIe=new Ni;function kIe(t,e){function n(y,v){y.matrixAutoUpdate===!0&&y.updateMatrix(),v.value.copy(y.matrix)}function i(y,v){v.color.getRGB(y.fogColor.value,kce(t)),v.isFog?(y.fogNear.value=v.near,y.fogFar.value=v.far):v.isFogExp2&&(y.fogDensity.value=v.density)}function r(y,v,b,T,x){v.isMeshBasicMaterial||v.isMeshLambertMaterial?s(y,v):v.isMeshToonMaterial?(s(y,v),h(y,v)):v.isMeshPhongMaterial?(s(y,v),u(y,v)):v.isMeshStandardMaterial?(s(y,v),f(y,v),v.isMeshPhysicalMaterial&&d(y,v,x)):v.isMeshMatcapMaterial?(s(y,v),p(y,v)):v.isMeshDepthMaterial?s(y,v):v.isMeshDistanceMaterial?(s(y,v),g(y,v)):v.isMeshNormalMaterial?s(y,v):v.isLineBasicMaterial?(a(y,v),v.isLineDashedMaterial&&o(y,v)):v.isPointsMaterial?c(y,v,b,T):v.isSpriteMaterial?l(y,v):v.isShadowMaterial?(y.color.value.copy(v.color),y.opacity.value=v.opacity):v.isShaderMaterial&&(v.uniformsNeedUpdate=!1)}function s(y,v){y.opacity.value=v.opacity,v.color&&y.diffuse.value.copy(v.color),v.emissive&&y.emissive.value.copy(v.emissive).multiplyScalar(v.emissiveIntensity),v.map&&(y.map.value=v.map,n(v.map,y.mapTransform)),v.alphaMap&&(y.alphaMap.value=v.alphaMap,n(v.alphaMap,y.alphaMapTransform)),v.bumpMap&&(y.bumpMap.value=v.bumpMap,n(v.bumpMap,y.bumpMapTransform),y.bumpScale.value=v.bumpScale,v.side===Bc&&(y.bumpScale.value*=-1)),v.normalMap&&(y.normalMap.value=v.normalMap,n(v.normalMap,y.normalMapTransform),y.normalScale.value.copy(v.normalScale),v.side===Bc&&y.normalScale.value.negate()),v.displacementMap&&(y.displacementMap.value=v.displacementMap,n(v.displacementMap,y.displacementMapTransform),y.displacementScale.value=v.displacementScale,y.displacementBias.value=v.displacementBias),v.emissiveMap&&(y.emissiveMap.value=v.emissiveMap,n(v.emissiveMap,y.emissiveMapTransform)),v.specularMap&&(y.specularMap.value=v.specularMap,n(v.specularMap,y.specularMapTransform)),v.alphaTest>0&&(y.alphaTest.value=v.alphaTest);const b=e.get(v),T=b.envMap,x=b.envMapRotation;T&&(y.envMap.value=T,MS.copy(x),MS.x*=-1,MS.y*=-1,MS.z*=-1,T.isCubeTexture&&T.isRenderTargetTexture===!1&&(MS.y*=-1,MS.z*=-1),y.envMapRotation.value.setFromMatrix4(IIe.makeRotationFromEuler(MS)),y.flipEnvMap.value=T.isCubeTexture&&T.isRenderTargetTexture===!1?-1:1,y.reflectivity.value=v.reflectivity,y.ior.value=v.ior,y.refractionRatio.value=v.refractionRatio),v.lightMap&&(y.lightMap.value=v.lightMap,y.lightMapIntensity.value=v.lightMapIntensity,n(v.lightMap,y.lightMapTransform)),v.aoMap&&(y.aoMap.value=v.aoMap,y.aoMapIntensity.value=v.aoMapIntensity,n(v.aoMap,y.aoMapTransform))}function a(y,v){y.diffuse.value.copy(v.color),y.opacity.value=v.opacity,v.map&&(y.map.value=v.map,n(v.map,y.mapTransform))}function o(y,v){y.dashSize.value=v.dashSize,y.totalSize.value=v.dashSize+v.gapSize,y.scale.value=v.scale}function c(y,v,b,T){y.diffuse.value.copy(v.color),y.opacity.value=v.opacity,y.size.value=v.size*b,y.scale.value=T*.5,v.map&&(y.map.value=v.map,n(v.map,y.uvTransform)),v.alphaMap&&(y.alphaMap.value=v.alphaMap,n(v.alphaMap,y.alphaMapTransform)),v.alphaTest>0&&(y.alphaTest.value=v.alphaTest)}function l(y,v){y.diffuse.value.copy(v.color),y.opacity.value=v.opacity,y.rotation.value=v.rotation,v.map&&(y.map.value=v.map,n(v.map,y.mapTransform)),v.alphaMap&&(y.alphaMap.value=v.alphaMap,n(v.alphaMap,y.alphaMapTransform)),v.alphaTest>0&&(y.alphaTest.value=v.alphaTest)}function u(y,v){y.specular.value.copy(v.specular),y.shininess.value=Math.max(v.shininess,1e-4)}function h(y,v){v.gradientMap&&(y.gradientMap.value=v.gradientMap)}function f(y,v){y.metalness.value=v.metalness,v.metalnessMap&&(y.metalnessMap.value=v.metalnessMap,n(v.metalnessMap,y.metalnessMapTransform)),y.roughness.value=v.roughness,v.roughnessMap&&(y.roughnessMap.value=v.roughnessMap,n(v.roughnessMap,y.roughnessMapTransform)),v.envMap&&(y.envMapIntensity.value=v.envMapIntensity)}function d(y,v,b){y.ior.value=v.ior,v.sheen>0&&(y.sheenColor.value.copy(v.sheenColor).multiplyScalar(v.sheen),y.sheenRoughness.value=v.sheenRoughness,v.sheenColorMap&&(y.sheenColorMap.value=v.sheenColorMap,n(v.sheenColorMap,y.sheenColorMapTransform)),v.sheenRoughnessMap&&(y.sheenRoughnessMap.value=v.sheenRoughnessMap,n(v.sheenRoughnessMap,y.sheenRoughnessMapTransform))),v.clearcoat>0&&(y.clearcoat.value=v.clearcoat,y.clearcoatRoughness.value=v.clearcoatRoughness,v.clearcoatMap&&(y.clearcoatMap.value=v.clearcoatMap,n(v.clearcoatMap,y.clearcoatMapTransform)),v.clearcoatRoughnessMap&&(y.clearcoatRoughnessMap.value=v.clearcoatRoughnessMap,n(v.clearcoatRoughnessMap,y.clearcoatRoughnessMapTransform)),v.clearcoatNormalMap&&(y.clearcoatNormalMap.value=v.clearcoatNormalMap,n(v.clearcoatNormalMap,y.clearcoatNormalMapTransform),y.clearcoatNormalScale.value.copy(v.clearcoatNormalScale),v.side===Bc&&y.clearcoatNormalScale.value.negate())),v.dispersion>0&&(y.dispersion.value=v.dispersion),v.iridescence>0&&(y.iridescence.value=v.iridescence,y.iridescenceIOR.value=v.iridescenceIOR,y.iridescenceThicknessMinimum.value=v.iridescenceThicknessRange[0],y.iridescenceThicknessMaximum.value=v.iridescenceThicknessRange[1],v.iridescenceMap&&(y.iridescenceMap.value=v.iridescenceMap,n(v.iridescenceMap,y.iridescenceMapTransform)),v.iridescenceThicknessMap&&(y.iridescenceThicknessMap.value=v.iridescenceThicknessMap,n(v.iridescenceThicknessMap,y.iridescenceThicknessMapTransform))),v.transmission>0&&(y.transmission.value=v.transmission,y.transmissionSamplerMap.value=b.texture,y.transmissionSamplerSize.value.set(b.width,b.height),v.transmissionMap&&(y.transmissionMap.value=v.transmissionMap,n(v.transmissionMap,y.transmissionMapTransform)),y.thickness.value=v.thickness,v.thicknessMap&&(y.thicknessMap.value=v.thicknessMap,n(v.thicknessMap,y.thicknessMapTransform)),y.attenuationDistance.value=v.attenuationDistance,y.attenuationColor.value.copy(v.attenuationColor)),v.anisotropy>0&&(y.anisotropyVector.value.set(v.anisotropy*Math.cos(v.anisotropyRotation),v.anisotropy*Math.sin(v.anisotropyRotation)),v.anisotropyMap&&(y.anisotropyMap.value=v.anisotropyMap,n(v.anisotropyMap,y.anisotropyMapTransform))),y.specularIntensity.value=v.specularIntensity,y.specularColor.value.copy(v.specularColor),v.specularColorMap&&(y.specularColorMap.value=v.specularColorMap,n(v.specularColorMap,y.specularColorMapTransform)),v.specularIntensityMap&&(y.specularIntensityMap.value=v.specularIntensityMap,n(v.specularIntensityMap,y.specularIntensityMapTransform))}function p(y,v){v.matcap&&(y.matcap.value=v.matcap)}function g(y,v){const b=e.get(v).light;y.referencePosition.value.setFromMatrixPosition(b.matrixWorld),y.nearDistance.value=b.shadow.camera.near,y.farDistance.value=b.shadow.camera.far}return{refreshFogUniforms:i,refreshMaterialUniforms:r}}function DIe(t,e,n,i){let r={},s={},a=[];const o=t.getParameter(t.MAX_UNIFORM_BUFFER_BINDINGS);function c(b,T){const x=T.program;i.uniformBlockBinding(b,x)}function l(b,T){let x=r[b.id];x===void 0&&(p(b),x=u(b),r[b.id]=x,b.addEventListener("dispose",y));const M=T.program;i.updateUBOMapping(b,M);const R=e.render.frame;s[b.id]!==R&&(f(b),s[b.id]=R)}function u(b){const T=h();b.__bindingPointIndex=T;const x=t.createBuffer(),M=b.__size,R=b.usage;return t.bindBuffer(t.UNIFORM_BUFFER,x),t.bufferData(t.UNIFORM_BUFFER,M,R),t.bindBuffer(t.UNIFORM_BUFFER,null),t.bindBufferBase(t.UNIFORM_BUFFER,T,x),x}function h(){for(let b=0;b<o;b++)if(a.indexOf(b)===-1)return a.push(b),b;return console.error("THREE.WebGLRenderer: Maximum number of simultaneously usable uniforms groups reached."),0}function f(b){const T=r[b.id],x=b.uniforms,M=b.__cache;t.bindBuffer(t.UNIFORM_BUFFER,T);for(let R=0,I=x.length;R<I;R++){const k=Array.isArray(x[R])?x[R]:[x[R]];for(let P=0,U=k.length;P<U;P++){const G=k[P];if(d(G,R,P,M)===!0){const $=G.__offset,q=Array.isArray(G.value)?G.value:[G.value];let Y=0;for(let ie=0;ie<q.length;ie++){const V=q[ie],J=g(V);typeof V=="number"||typeof V=="boolean"?(G.__data[0]=V,t.bufferSubData(t.UNIFORM_BUFFER,$+Y,G.__data)):V.isMatrix3?(G.__data[0]=V.elements[0],G.__data[1]=V.elements[1],G.__data[2]=V.elements[2],G.__data[3]=0,G.__data[4]=V.elements[3],G.__data[5]=V.elements[4],G.__data[6]=V.elements[5],G.__data[7]=0,G.__data[8]=V.elements[6],G.__data[9]=V.elements[7],G.__data[10]=V.elements[8],G.__data[11]=0):(V.toArray(G.__data,Y),Y+=J.storage/Float32Array.BYTES_PER_ELEMENT)}t.bufferSubData(t.UNIFORM_BUFFER,$,G.__data)}}}t.bindBuffer(t.UNIFORM_BUFFER,null)}function d(b,T,x,M){const R=b.value,I=T+"_"+x;if(M[I]===void 0)return typeof R=="number"||typeof R=="boolean"?M[I]=R:M[I]=R.clone(),!0;{const k=M[I];if(typeof R=="number"||typeof R=="boolean"){if(k!==R)return M[I]=R,!0}else if(k.equals(R)===!1)return k.copy(R),!0}return!1}function p(b){const T=b.uniforms;let x=0;const M=16;for(let I=0,k=T.length;I<k;I++){const P=Array.isArray(T[I])?T[I]:[T[I]];for(let U=0,G=P.length;U<G;U++){const $=P[U],q=Array.isArray($.value)?$.value:[$.value];for(let Y=0,ie=q.length;Y<ie;Y++){const V=q[Y],J=g(V),X=x%M,ee=X%J.boundary,oe=X+ee;x+=ee,oe!==0&&M-oe<J.storage&&(x+=M-oe),$.__data=new Float32Array(J.storage/Float32Array.BYTES_PER_ELEMENT),$.__offset=x,x+=J.storage}}}const R=x%M;return R>0&&(x+=M-R),b.__size=x,b.__cache={},this}function g(b){const T={boundary:0,storage:0};return typeof b=="number"||typeof b=="boolean"?(T.boundary=4,T.storage=4):b.isVector2?(T.boundary=8,T.storage=8):b.isVector3||b.isColor?(T.boundary=16,T.storage=12):b.isVector4?(T.boundary=16,T.storage=16):b.isMatrix3?(T.boundary=48,T.storage=48):b.isMatrix4?(T.boundary=64,T.storage=64):b.isTexture?console.warn("THREE.WebGLRenderer: Texture samplers can not be part of an uniforms group."):console.warn("THREE.WebGLRenderer: Unsupported uniform value type.",b),T}function y(b){const T=b.target;T.removeEventListener("dispose",y);const x=a.indexOf(T.__bindingPointIndex);a.splice(x,1),t.deleteBuffer(r[T.id]),delete r[T.id],delete s[T.id]}function v(){for(const b in r)t.deleteBuffer(r[b]);a=[],r={},s={}}return{bind:c,update:l,dispose:v}}class zle{constructor(e={}){const{canvas:n=Oce(),context:i=null,depth:r=!0,stencil:s=!1,alpha:a=!1,antialias:o=!1,premultipliedAlpha:c=!0,preserveDrawingBuffer:l=!1,powerPreference:u="default",failIfMajorPerformanceCaveat:h=!1,reverseDepthBuffer:f=!1}=e;this.isWebGLRenderer=!0;let d;if(i!==null){if(typeof WebGLRenderingContext<"u"&&i instanceof WebGLRenderingContext)throw new Error("THREE.WebGLRenderer: WebGL 1 is not supported since r163.");d=i.getContextAttributes().alpha}else d=a;const p=new Uint32Array(4),g=new Int32Array(4);let y=null,v=null;const b=[],T=[];this.domElement=n,this.debug={checkShaderErrors:!0,onShaderError:null},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.toneMapping=hm,this.toneMappingExposure=1,this.transmissionResolutionScale=1;const x=this;let M=!1;this._outputColorSpace=ba;let R=0,I=0,k=null,P=-1,U=null;const G=new Zr,$=new Zr;let q=null;const Y=new yn(0);let ie=0,V=n.width,J=n.height,X=1,ee=null,oe=null;const fe=new Zr(0,0,V,J),Re=new Zr(0,0,V,J);let He=!1;const Te=new yA;let Le=!1,we=!1;const Ce=new Ni,ke=new Ni,St=new Ae,Mt=new Zr,Ee={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};let _e=!1;function tt(){return k===null?X:1}let de=i;function Be(ve,Ke){return n.getContext(ve,Ke)}try{const ve={alpha:!0,depth:r,stencil:s,antialias:o,premultipliedAlpha:c,preserveDrawingBuffer:l,powerPreference:u,failIfMajorPerformanceCaveat:h};if("setAttribute"in n&&n.setAttribute("data-engine",`three.js r${JN}`),n.addEventListener("webglcontextlost",Pt,!1),n.addEventListener("webglcontextrestored",hn,!1),n.addEventListener("webglcontextcreationerror",an,!1),de===null){const Ke="webgl2";if(de=Be(Ke,ve),de===null)throw Be(Ke)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}}catch(ve){throw console.error("THREE.WebGLRenderer: "+ve.message),ve}let Ie,rt,ft,gt,bt,be,ue,Xe,it,$e,Ue,qt,Ot,Yt,ce,j,W,me,De,Ve,mt,xt,Vn,qe;function Vt(){Ie=new $Oe(de),Ie.init(),xt=new Fle(de,Ie),rt=new FOe(de,Ie,e,xt),ft=new CIe(de,Ie),rt.reverseDepthBuffer&&f&&ft.buffers.depth.setReversed(!0),gt=new XOe(de),bt=new dIe,be=new AIe(de,Ie,ft,bt,rt,xt,gt),ue=new HOe(x),Xe=new qOe(x),it=new tRe(de),Vn=new UOe(de,it),$e=new WOe(de,it,gt,Vn),Ue=new ZOe(de,$e,it,gt),De=new KOe(de,rt,be),j=new zOe(bt),qt=new fIe(x,ue,Xe,Ie,rt,Vn,j),Ot=new kIe(x,bt),Yt=new mIe,ce=new EIe(Ie),me=new LOe(x,ue,Xe,ft,Ue,d,c),W=new xIe(x,Ue,rt),qe=new DIe(de,gt,rt,ft),Ve=new BOe(de,Ie,gt),mt=new YOe(de,Ie,gt),gt.programs=qt.programs,x.capabilities=rt,x.extensions=Ie,x.properties=bt,x.renderLists=Yt,x.shadowMap=W,x.state=ft,x.info=gt}Vt();const ht=new NIe(x,de);this.xr=ht,this.getContext=function(){return de},this.getContextAttributes=function(){return de.getContextAttributes()},this.forceContextLoss=function(){const ve=Ie.get("WEBGL_lose_context");ve&&ve.loseContext()},this.forceContextRestore=function(){const ve=Ie.get("WEBGL_lose_context");ve&&ve.restoreContext()},this.getPixelRatio=function(){return X},this.setPixelRatio=function(ve){ve!==void 0&&(X=ve,this.setSize(V,J,!1))},this.getSize=function(ve){return ve.set(V,J)},this.setSize=function(ve,Ke,vt=!0){if(ht.isPresenting){console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting.");return}V=ve,J=Ke,n.width=Math.floor(ve*X),n.height=Math.floor(Ke*X),vt===!0&&(n.style.width=ve+"px",n.style.height=Ke+"px"),this.setViewport(0,0,ve,Ke)},this.getDrawingBufferSize=function(ve){return ve.set(V*X,J*X).floor()},this.setDrawingBufferSize=function(ve,Ke,vt){V=ve,J=Ke,X=vt,n.width=Math.floor(ve*vt),n.height=Math.floor(Ke*vt),this.setViewport(0,0,ve,Ke)},this.getCurrentViewport=function(ve){return ve.copy(G)},this.getViewport=function(ve){return ve.copy(fe)},this.setViewport=function(ve,Ke,vt,_t){ve.isVector4?fe.set(ve.x,ve.y,ve.z,ve.w):fe.set(ve,Ke,vt,_t),ft.viewport(G.copy(fe).multiplyScalar(X).round())},this.getScissor=function(ve){return ve.copy(Re)},this.setScissor=function(ve,Ke,vt,_t){ve.isVector4?Re.set(ve.x,ve.y,ve.z,ve.w):Re.set(ve,Ke,vt,_t),ft.scissor($.copy(Re).multiplyScalar(X).round())},this.getScissorTest=function(){return He},this.setScissorTest=function(ve){ft.setScissorTest(He=ve)},this.setOpaqueSort=function(ve){ee=ve},this.setTransparentSort=function(ve){oe=ve},this.getClearColor=function(ve){return ve.copy(me.getClearColor())},this.setClearColor=function(){me.setClearColor(...arguments)},this.getClearAlpha=function(){return me.getClearAlpha()},this.setClearAlpha=function(){me.setClearAlpha(...arguments)},this.clear=function(ve=!0,Ke=!0,vt=!0){let _t=0;if(ve){let Qe=!1;if(k!==null){const Ht=k.texture.format;Qe=Ht===tI||Ht===_B||Ht===eI}if(Qe){const Ht=k.texture.type,nn=Ht===El||Ht===Jg||Ht===vC||Ht===IT||Ht===mB||Ht===gB,mn=me.getClearColor(),Sn=me.getClearAlpha(),oi=mn.r,ci=mn.g,Cn=mn.b;nn?(p[0]=oi,p[1]=ci,p[2]=Cn,p[3]=Sn,de.clearBufferuiv(de.COLOR,0,p)):(g[0]=oi,g[1]=ci,g[2]=Cn,g[3]=Sn,de.clearBufferiv(de.COLOR,0,g))}else _t|=de.COLOR_BUFFER_BIT}Ke&&(_t|=de.DEPTH_BUFFER_BIT),vt&&(_t|=de.STENCIL_BUFFER_BIT,this.state.buffers.stencil.setMask(4294967295)),de.clear(_t)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){n.removeEventListener("webglcontextlost",Pt,!1),n.removeEventListener("webglcontextrestored",hn,!1),n.removeEventListener("webglcontextcreationerror",an,!1),me.dispose(),Yt.dispose(),ce.dispose(),bt.dispose(),ue.dispose(),Xe.dispose(),Ue.dispose(),Vn.dispose(),qe.dispose(),qt.dispose(),ht.dispose(),ht.removeEventListener("sessionstart",Si),ht.removeEventListener("sessionend",ai),En.stop()};function Pt(ve){ve.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),M=!0}function hn(){console.log("THREE.WebGLRenderer: Context Restored."),M=!1;const ve=gt.autoReset,Ke=W.enabled,vt=W.autoUpdate,_t=W.needsUpdate,Qe=W.type;Vt(),gt.autoReset=ve,W.enabled=Ke,W.autoUpdate=vt,W.needsUpdate=_t,W.type=Qe}function an(ve){console.error("THREE.WebGLRenderer: A WebGL context could not be created. Reason: ",ve.statusMessage)}function Ge(ve){const Ke=ve.target;Ke.removeEventListener("dispose",Ge),ot(Ke)}function ot(ve){At(ve),bt.remove(ve)}function At(ve){const Ke=bt.get(ve).programs;Ke!==void 0&&(Ke.forEach(function(vt){qt.releaseProgram(vt)}),ve.isShaderMaterial&&qt.releaseShaderCache(ve))}this.renderBufferDirect=function(ve,Ke,vt,_t,Qe,Ht){Ke===null&&(Ke=Ee);const nn=Qe.isMesh&&Qe.matrixWorld.determinant()<0,mn=fd(ve,Ke,vt,_t,Qe);ft.setMaterial(_t,nn);let Sn=vt.index,oi=1;if(_t.wireframe===!0){if(Sn=$e.getWireframeAttribute(vt),Sn===void 0)return;oi=2}const ci=vt.drawRange,Cn=vt.attributes.position;let gi=ci.start*oi,ar=(ci.start+ci.count)*oi;Ht!==null&&(gi=Math.max(gi,Ht.start*oi),ar=Math.min(ar,(Ht.start+Ht.count)*oi)),Sn!==null?(gi=Math.max(gi,0),ar=Math.min(ar,Sn.count)):Cn!=null&&(gi=Math.max(gi,0),ar=Math.min(ar,Cn.count));const Os=ar-gi;if(Os<0||Os===1/0)return;Vn.setup(Qe,_t,mn,vt,Sn);let bs,Ki=Ve;if(Sn!==null&&(bs=it.get(Sn),Ki=mt,Ki.setIndex(bs)),Qe.isMesh)_t.wireframe===!0?(ft.setLineWidth(_t.wireframeLinewidth*tt()),Ki.setMode(de.LINES)):Ki.setMode(de.TRIANGLES);else if(Qe.isLine){let Xn=_t.linewidth;Xn===void 0&&(Xn=1),ft.setLineWidth(Xn*tt()),Qe.isLineSegments?Ki.setMode(de.LINES):Qe.isLineLoop?Ki.setMode(de.LINE_LOOP):Ki.setMode(de.LINE_STRIP)}else Qe.isPoints?Ki.setMode(de.POINTS):Qe.isSprite&&Ki.setMode(de.TRIANGLES);if(Qe.isBatchedMesh)if(Qe._multiDrawInstances!==null)KP("THREE.WebGLRenderer: renderMultiDrawInstances has been deprecated and will be removed in r184. Append to renderMultiDraw arguments and use indirection."),Ki.renderMultiDrawInstances(Qe._multiDrawStarts,Qe._multiDrawCounts,Qe._multiDrawCount,Qe._multiDrawInstances);else if(Ie.get("WEBGL_multi_draw"))Ki.renderMultiDraw(Qe._multiDrawStarts,Qe._multiDrawCounts,Qe._multiDrawCount);else{const Xn=Qe._multiDrawStarts,Ti=Qe._multiDrawCounts,Bn=Qe._multiDrawCount,qo=Sn?it.get(Sn).bytesPerElement:1,$l=bt.get(_t).currentProgram.getUniforms();for(let no=0;no<Bn;no++)$l.setValue(de,"_gl_DrawID",no),Ki.render(Xn[no]/qo,Ti[no])}else if(Qe.isInstancedMesh)Ki.renderInstances(gi,Os,Qe.count);else if(vt.isInstancedBufferGeometry){const Xn=vt._maxInstanceCount!==void 0?vt._maxInstanceCount:1/0,Ti=Math.min(vt.instanceCount,Xn);Ki.renderInstances(gi,Os,Ti)}else Ki.render(gi,Os)};function Nt(ve,Ke,vt){ve.transparent===!0&&ve.side===dl&&ve.forceSinglePass===!1?(ve.side=Bc,ve.needsUpdate=!0,ei(ve,Ke,vt),ve.side=Zg,ve.needsUpdate=!0,ei(ve,Ke,vt),ve.side=dl):ei(ve,Ke,vt)}this.compile=function(ve,Ke,vt=null){vt===null&&(vt=ve),v=ce.get(vt),v.init(Ke),T.push(v),vt.traverseVisible(function(Qe){Qe.isLight&&Qe.layers.test(Ke.layers)&&(v.pushLight(Qe),Qe.castShadow&&v.pushShadow(Qe))}),ve!==vt&&ve.traverseVisible(function(Qe){Qe.isLight&&Qe.layers.test(Ke.layers)&&(v.pushLight(Qe),Qe.castShadow&&v.pushShadow(Qe))}),v.setupLights();const _t=new Set;return ve.traverse(function(Qe){if(!(Qe.isMesh||Qe.isPoints||Qe.isLine||Qe.isSprite))return;const Ht=Qe.material;if(Ht)if(Array.isArray(Ht))for(let nn=0;nn<Ht.length;nn++){const mn=Ht[nn];Nt(mn,vt,Qe),_t.add(mn)}else Nt(Ht,vt,Qe),_t.add(Ht)}),v=T.pop(),_t},this.compileAsync=function(ve,Ke,vt=null){const _t=this.compile(ve,Ke,vt);return new Promise(Qe=>{function Ht(){if(_t.forEach(function(nn){bt.get(nn).currentProgram.isReady()&&_t.delete(nn)}),_t.size===0){Qe(ve);return}setTimeout(Ht,10)}Ie.get("KHR_parallel_shader_compile")!==null?Ht():setTimeout(Ht,10)})};let Yn=null;function sr(ve){Yn&&Yn(ve)}function Si(){En.stop()}function ai(){En.start()}const En=new Dle;En.setAnimationLoop(sr),typeof self<"u"&&En.setContext(self),this.setAnimationLoop=function(ve){Yn=ve,ht.setAnimationLoop(ve),ve===null?En.stop():En.start()},ht.addEventListener("sessionstart",Si),ht.addEventListener("sessionend",ai),this.render=function(ve,Ke){if(Ke!==void 0&&Ke.isCamera!==!0){console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");return}if(M===!0)return;if(ve.matrixWorldAutoUpdate===!0&&ve.updateMatrixWorld(),Ke.parent===null&&Ke.matrixWorldAutoUpdate===!0&&Ke.updateMatrixWorld(),ht.enabled===!0&&ht.isPresenting===!0&&(ht.cameraAutoUpdate===!0&&ht.updateCamera(Ke),Ke=ht.getCamera()),ve.isScene===!0&&ve.onBeforeRender(x,ve,Ke,k),v=ce.get(ve,T.length),v.init(Ke),T.push(v),ke.multiplyMatrices(Ke.projectionMatrix,Ke.matrixWorldInverse),Te.setFromProjectionMatrix(ke),we=this.localClippingEnabled,Le=j.init(this.clippingPlanes,we),y=Yt.get(ve,b.length),y.init(),b.push(y),ht.enabled===!0&&ht.isPresenting===!0){const Ht=x.xr.getDepthSensingMesh();Ht!==null&&sn(Ht,Ke,-1/0,x.sortObjects)}sn(ve,Ke,0,x.sortObjects),y.finish(),x.sortObjects===!0&&y.sort(ee,oe),_e=ht.enabled===!1||ht.isPresenting===!1||ht.hasDepthSensing()===!1,_e&&me.addToRenderList(y,ve),this.info.render.frame++,Le===!0&&j.beginShadows();const vt=v.state.shadowsArray;W.render(vt,ve,Ke),Le===!0&&j.endShadows(),this.info.autoReset===!0&&this.info.reset();const _t=y.opaque,Qe=y.transmissive;if(v.setupLights(),Ke.isArrayCamera){const Ht=Ke.cameras;if(Qe.length>0)for(let nn=0,mn=Ht.length;nn<mn;nn++){const Sn=Ht[nn];Nn(_t,Qe,ve,Sn)}_e&&me.render(ve);for(let nn=0,mn=Ht.length;nn<mn;nn++){const Sn=Ht[nn];Ln(y,ve,Sn,Sn.viewport)}}else Qe.length>0&&Nn(_t,Qe,ve,Ke),_e&&me.render(ve),Ln(y,ve,Ke);k!==null&&I===0&&(be.updateMultisampleRenderTarget(k),be.updateRenderTargetMipmap(k)),ve.isScene===!0&&ve.onAfterRender(x,ve,Ke),Vn.resetDefaultState(),P=-1,U=null,T.pop(),T.length>0?(v=T[T.length-1],Le===!0&&j.setGlobalState(x.clippingPlanes,v.state.camera)):v=null,b.pop(),b.length>0?y=b[b.length-1]:y=null};function sn(ve,Ke,vt,_t){if(ve.visible===!1)return;if(ve.layers.test(Ke.layers)){if(ve.isGroup)vt=ve.renderOrder;else if(ve.isLOD)ve.autoUpdate===!0&&ve.update(Ke);else if(ve.isLight)v.pushLight(ve),ve.castShadow&&v.pushShadow(ve);else if(ve.isSprite){if(!ve.frustumCulled||Te.intersectsSprite(ve)){_t&&Mt.setFromMatrixPosition(ve.matrixWorld).applyMatrix4(ke);const nn=Ue.update(ve),mn=ve.material;mn.visible&&y.push(ve,nn,mn,vt,Mt.z,null)}}else if((ve.isMesh||ve.isLine||ve.isPoints)&&(!ve.frustumCulled||Te.intersectsObject(ve))){const nn=Ue.update(ve),mn=ve.material;if(_t&&(ve.boundingSphere!==void 0?(ve.boundingSphere===null&&ve.computeBoundingSphere(),Mt.copy(ve.boundingSphere.center)):(nn.boundingSphere===null&&nn.computeBoundingSphere(),Mt.copy(nn.boundingSphere.center)),Mt.applyMatrix4(ve.matrixWorld).applyMatrix4(ke)),Array.isArray(mn)){const Sn=nn.groups;for(let oi=0,ci=Sn.length;oi<ci;oi++){const Cn=Sn[oi],gi=mn[Cn.materialIndex];gi&&gi.visible&&y.push(ve,nn,gi,vt,Mt.z,Cn)}}else mn.visible&&y.push(ve,nn,mn,vt,Mt.z,null)}}const Ht=ve.children;for(let nn=0,mn=Ht.length;nn<mn;nn++)sn(Ht[nn],Ke,vt,_t)}function Ln(ve,Ke,vt,_t){const Qe=ve.opaque,Ht=ve.transmissive,nn=ve.transparent;v.setupLightsView(vt),Le===!0&&j.setGlobalState(x.clippingPlanes,vt),_t&&ft.viewport(G.copy(_t)),Qe.length>0&&di(Qe,Ke,vt),Ht.length>0&&di(Ht,Ke,vt),nn.length>0&&di(nn,Ke,vt),ft.buffers.depth.setTest(!0),ft.buffers.depth.setMask(!0),ft.buffers.color.setMask(!0),ft.setPolygonOffset(!1)}function Nn(ve,Ke,vt,_t){if((vt.isScene===!0?vt.overrideMaterial:null)!==null)return;v.state.transmissionRenderTarget[_t.id]===void 0&&(v.state.transmissionRenderTarget[_t.id]=new Vl(1,1,{generateMipmaps:!0,type:Ie.has("EXT_color_buffer_half_float")||Ie.has("EXT_color_buffer_float")?lE:El,minFilter:Ig,samples:4,stencilBuffer:s,resolveDepthBuffer:!1,resolveStencilBuffer:!1,colorSpace:Ur.workingColorSpace}));const Ht=v.state.transmissionRenderTarget[_t.id],nn=_t.viewport||G;Ht.setSize(nn.z*x.transmissionResolutionScale,nn.w*x.transmissionResolutionScale);const mn=x.getRenderTarget();x.setRenderTarget(Ht),x.getClearColor(Y),ie=x.getClearAlpha(),ie<1&&x.setClearColor(16777215,.5),x.clear(),_e&&me.render(vt);const Sn=x.toneMapping;x.toneMapping=hm;const oi=_t.viewport;if(_t.viewport!==void 0&&(_t.viewport=void 0),v.setupLightsView(_t),Le===!0&&j.setGlobalState(x.clippingPlanes,_t),di(ve,vt,_t),be.updateMultisampleRenderTarget(Ht),be.updateRenderTargetMipmap(Ht),Ie.has("WEBGL_multisampled_render_to_texture")===!1){let ci=!1;for(let Cn=0,gi=Ke.length;Cn<gi;Cn++){const ar=Ke[Cn],Os=ar.object,bs=ar.geometry,Ki=ar.material,Xn=ar.group;if(Ki.side===dl&&Os.layers.test(_t.layers)){const Ti=Ki.side;Ki.side=Bc,Ki.needsUpdate=!0,hr(Os,vt,_t,bs,Ki,Xn),Ki.side=Ti,Ki.needsUpdate=!0,ci=!0}}ci===!0&&(be.updateMultisampleRenderTarget(Ht),be.updateRenderTargetMipmap(Ht))}x.setRenderTarget(mn),x.setClearColor(Y,ie),oi!==void 0&&(_t.viewport=oi),x.toneMapping=Sn}function di(ve,Ke,vt){const _t=Ke.isScene===!0?Ke.overrideMaterial:null;for(let Qe=0,Ht=ve.length;Qe<Ht;Qe++){const nn=ve[Qe],mn=nn.object,Sn=nn.geometry,oi=nn.group;let ci=nn.material;ci.allowOverride===!0&&_t!==null&&(ci=_t),mn.layers.test(vt.layers)&&hr(mn,Ke,vt,Sn,ci,oi)}}function hr(ve,Ke,vt,_t,Qe,Ht){ve.onBeforeRender(x,Ke,vt,_t,Qe,Ht),ve.modelViewMatrix.multiplyMatrices(vt.matrixWorldInverse,ve.matrixWorld),ve.normalMatrix.getNormalMatrix(ve.modelViewMatrix),Qe.onBeforeRender(x,Ke,vt,_t,ve,Ht),Qe.transparent===!0&&Qe.side===dl&&Qe.forceSinglePass===!1?(Qe.side=Bc,Qe.needsUpdate=!0,x.renderBufferDirect(vt,Ke,_t,Qe,ve,Ht),Qe.side=Zg,Qe.needsUpdate=!0,x.renderBufferDirect(vt,Ke,_t,Qe,ve,Ht),Qe.side=dl):x.renderBufferDirect(vt,Ke,_t,Qe,ve,Ht),ve.onAfterRender(x,Ke,vt,_t,Qe,Ht)}function ei(ve,Ke,vt){Ke.isScene!==!0&&(Ke=Ee);const _t=bt.get(ve),Qe=v.state.lights,Ht=v.state.shadowsArray,nn=Qe.state.version,mn=qt.getParameters(ve,Qe.state,Ht,Ke,vt),Sn=qt.getProgramCacheKey(mn);let oi=_t.programs;_t.environment=ve.isMeshStandardMaterial?Ke.environment:null,_t.fog=Ke.fog,_t.envMap=(ve.isMeshStandardMaterial?Xe:ue).get(ve.envMap||_t.environment),_t.envMapRotation=_t.environment!==null&&ve.envMap===null?Ke.environmentRotation:ve.envMapRotation,oi===void 0&&(ve.addEventListener("dispose",Ge),oi=new Map,_t.programs=oi);let ci=oi.get(Sn);if(ci!==void 0){if(_t.currentProgram===ci&&_t.lightsStateVersion===nn)return xu(ve,mn),ci}else mn.uniforms=qt.getUniforms(ve),ve.onBeforeCompile(mn,x),ci=qt.acquireProgram(mn,Sn),oi.set(Sn,ci),_t.uniforms=mn.uniforms;const Cn=_t.uniforms;return(!ve.isShaderMaterial&&!ve.isRawShaderMaterial||ve.clipping===!0)&&(Cn.clippingPlanes=j.uniform),xu(ve,mn),_t.needsLights=A0(ve),_t.lightsStateVersion=nn,_t.needsLights&&(Cn.ambientLightColor.value=Qe.state.ambient,Cn.lightProbe.value=Qe.state.probe,Cn.directionalLights.value=Qe.state.directional,Cn.directionalLightShadows.value=Qe.state.directionalShadow,Cn.spotLights.value=Qe.state.spot,Cn.spotLightShadows.value=Qe.state.spotShadow,Cn.rectAreaLights.value=Qe.state.rectArea,Cn.ltc_1.value=Qe.state.rectAreaLTC1,Cn.ltc_2.value=Qe.state.rectAreaLTC2,Cn.pointLights.value=Qe.state.point,Cn.pointLightShadows.value=Qe.state.pointShadow,Cn.hemisphereLights.value=Qe.state.hemi,Cn.directionalShadowMap.value=Qe.state.directionalShadowMap,Cn.directionalShadowMatrix.value=Qe.state.directionalShadowMatrix,Cn.spotShadowMap.value=Qe.state.spotShadowMap,Cn.spotLightMatrix.value=Qe.state.spotLightMatrix,Cn.spotLightMap.value=Qe.state.spotLightMap,Cn.pointShadowMap.value=Qe.state.pointShadowMap,Cn.pointShadowMatrix.value=Qe.state.pointShadowMatrix),_t.currentProgram=ci,_t.uniformsList=null,ci}function Fa(ve){if(ve.uniformsList===null){const Ke=ve.currentProgram.getUniforms();ve.uniformsList=JP.seqWithValue(Ke.seq,ve.uniforms)}return ve.uniformsList}function xu(ve,Ke){const vt=bt.get(ve);vt.outputColorSpace=Ke.outputColorSpace,vt.batching=Ke.batching,vt.batchingColor=Ke.batchingColor,vt.instancing=Ke.instancing,vt.instancingColor=Ke.instancingColor,vt.instancingMorph=Ke.instancingMorph,vt.skinning=Ke.skinning,vt.morphTargets=Ke.morphTargets,vt.morphNormals=Ke.morphNormals,vt.morphColors=Ke.morphColors,vt.morphTargetsCount=Ke.morphTargetsCount,vt.numClippingPlanes=Ke.numClippingPlanes,vt.numIntersection=Ke.numClipIntersection,vt.vertexAlphas=Ke.vertexAlphas,vt.vertexTangents=Ke.vertexTangents,vt.toneMapping=Ke.toneMapping}function fd(ve,Ke,vt,_t,Qe){Ke.isScene!==!0&&(Ke=Ee),be.resetTextureUnits();const Ht=Ke.fog,nn=_t.isMeshStandardMaterial?Ke.environment:null,mn=k===null?x.outputColorSpace:k.isXRRenderTarget===!0?k.texture.colorSpace:Qg,Sn=(_t.isMeshStandardMaterial?Xe:ue).get(_t.envMap||nn),oi=_t.vertexColors===!0&&!!vt.attributes.color&&vt.attributes.color.itemSize===4,ci=!!vt.attributes.tangent&&(!!_t.normalMap||_t.anisotropy>0),Cn=!!vt.morphAttributes.position,gi=!!vt.morphAttributes.normal,ar=!!vt.morphAttributes.color;let Os=hm;_t.toneMapped&&(k===null||k.isXRRenderTarget===!0)&&(Os=x.toneMapping);const bs=vt.morphAttributes.position||vt.morphAttributes.normal||vt.morphAttributes.color,Ki=bs!==void 0?bs.length:0,Xn=bt.get(_t),Ti=v.state.lights;if(Le===!0&&(we===!0||ve!==U)){const Vs=ve===U&&_t.id===P;j.setState(_t,ve,Vs)}let Bn=!1;_t.version===Xn.__version?(Xn.needsLights&&Xn.lightsStateVersion!==Ti.state.version||Xn.outputColorSpace!==mn||Qe.isBatchedMesh&&Xn.batching===!1||!Qe.isBatchedMesh&&Xn.batching===!0||Qe.isBatchedMesh&&Xn.batchingColor===!0&&Qe.colorTexture===null||Qe.isBatchedMesh&&Xn.batchingColor===!1&&Qe.colorTexture!==null||Qe.isInstancedMesh&&Xn.instancing===!1||!Qe.isInstancedMesh&&Xn.instancing===!0||Qe.isSkinnedMesh&&Xn.skinning===!1||!Qe.isSkinnedMesh&&Xn.skinning===!0||Qe.isInstancedMesh&&Xn.instancingColor===!0&&Qe.instanceColor===null||Qe.isInstancedMesh&&Xn.instancingColor===!1&&Qe.instanceColor!==null||Qe.isInstancedMesh&&Xn.instancingMorph===!0&&Qe.morphTexture===null||Qe.isInstancedMesh&&Xn.instancingMorph===!1&&Qe.morphTexture!==null||Xn.envMap!==Sn||_t.fog===!0&&Xn.fog!==Ht||Xn.numClippingPlanes!==void 0&&(Xn.numClippingPlanes!==j.numPlanes||Xn.numIntersection!==j.numIntersection)||Xn.vertexAlphas!==oi||Xn.vertexTangents!==ci||Xn.morphTargets!==Cn||Xn.morphNormals!==gi||Xn.morphColors!==ar||Xn.toneMapping!==Os||Xn.morphTargetsCount!==Ki)&&(Bn=!0):(Bn=!0,Xn.__version=_t.version);let qo=Xn.currentProgram;Bn===!0&&(qo=ei(_t,Ke,Qe));let $l=!1,no=!1,mh=!1;const ls=qo.getUniforms(),bn=Xn.uniforms;if(ft.useProgram(qo.program)&&($l=!0,no=!0,mh=!0),_t.id!==P&&(P=_t.id,no=!0),$l||U!==ve){ft.buffers.depth.getReversed()?(Ce.copy(ve.projectionMatrix),Swe(Ce),Twe(Ce),ls.setValue(de,"projectionMatrix",Ce)):ls.setValue(de,"projectionMatrix",ve.projectionMatrix),ls.setValue(de,"viewMatrix",ve.matrixWorldInverse);const qn=ls.map.cameraPosition;qn!==void 0&&qn.setValue(de,St.setFromMatrixPosition(ve.matrixWorld)),rt.logarithmicDepthBuffer&&ls.setValue(de,"logDepthBufFC",2/(Math.log(ve.far+1)/Math.LN2)),(_t.isMeshPhongMaterial||_t.isMeshToonMaterial||_t.isMeshLambertMaterial||_t.isMeshBasicMaterial||_t.isMeshStandardMaterial||_t.isShaderMaterial)&&ls.setValue(de,"isOrthographic",ve.isOrthographicCamera===!0),U!==ve&&(U=ve,no=!0,mh=!0)}if(Qe.isSkinnedMesh){ls.setOptional(de,Qe,"bindMatrix"),ls.setOptional(de,Qe,"bindMatrixInverse");const Vs=Qe.skeleton;Vs&&(Vs.boneTexture===null&&Vs.computeBoneTexture(),ls.setValue(de,"boneTexture",Vs.boneTexture,be))}Qe.isBatchedMesh&&(ls.setOptional(de,Qe,"batchingTexture"),ls.setValue(de,"batchingTexture",Qe._matricesTexture,be),ls.setOptional(de,Qe,"batchingIdTexture"),ls.setValue(de,"batchingIdTexture",Qe._indirectTexture,be),ls.setOptional(de,Qe,"batchingColorTexture"),Qe._colorsTexture!==null&&ls.setValue(de,"batchingColorTexture",Qe._colorsTexture,be));const io=vt.morphAttributes;if((io.position!==void 0||io.normal!==void 0||io.color!==void 0)&&De.update(Qe,vt,qo),(no||Xn.receiveShadow!==Qe.receiveShadow)&&(Xn.receiveShadow=Qe.receiveShadow,ls.setValue(de,"receiveShadow",Qe.receiveShadow)),_t.isMeshGouraudMaterial&&_t.envMap!==null&&(bn.envMap.value=Sn,bn.flipEnvMap.value=Sn.isCubeTexture&&Sn.isRenderTargetTexture===!1?-1:1),_t.isMeshStandardMaterial&&_t.envMap===null&&Ke.environment!==null&&(bn.envMapIntensity.value=Ke.environmentIntensity),no&&(ls.setValue(de,"toneMappingExposure",x.toneMappingExposure),Xn.needsLights&&Np(bn,mh),Ht&&_t.fog===!0&&Ot.refreshFogUniforms(bn,Ht),Ot.refreshMaterialUniforms(bn,_t,X,J,v.state.transmissionRenderTarget[ve.id]),JP.upload(de,Fa(Xn),bn,be)),_t.isShaderMaterial&&_t.uniformsNeedUpdate===!0&&(JP.upload(de,Fa(Xn),bn,be),_t.uniformsNeedUpdate=!1),_t.isSpriteMaterial&&ls.setValue(de,"center",Qe.center),ls.setValue(de,"modelViewMatrix",Qe.modelViewMatrix),ls.setValue(de,"normalMatrix",Qe.normalMatrix),ls.setValue(de,"modelMatrix",Qe.matrixWorld),_t.isShaderMaterial||_t.isRawShaderMaterial){const Vs=_t.uniformsGroups;for(let qn=0,xl=Vs.length;qn<xl;qn++){const la=Vs[qn];qe.update(la,qo),qe.bind(la,qo)}}return qo}function Np(ve,Ke){ve.ambientLightColor.needsUpdate=Ke,ve.lightProbe.needsUpdate=Ke,ve.directionalLights.needsUpdate=Ke,ve.directionalLightShadows.needsUpdate=Ke,ve.pointLights.needsUpdate=Ke,ve.pointLightShadows.needsUpdate=Ke,ve.spotLights.needsUpdate=Ke,ve.spotLightShadows.needsUpdate=Ke,ve.rectAreaLights.needsUpdate=Ke,ve.hemisphereLights.needsUpdate=Ke}function A0(ve){return ve.isMeshLambertMaterial||ve.isMeshToonMaterial||ve.isMeshPhongMaterial||ve.isMeshStandardMaterial||ve.isShadowMaterial||ve.isShaderMaterial&&ve.lights===!0}this.getActiveCubeFace=function(){return R},this.getActiveMipmapLevel=function(){return I},this.getRenderTarget=function(){return k},this.setRenderTargetTextures=function(ve,Ke,vt){const _t=bt.get(ve);_t.__autoAllocateDepthBuffer=ve.resolveDepthBuffer===!1,_t.__autoAllocateDepthBuffer===!1&&(_t.__useRenderToTexture=!1),bt.get(ve.texture).__webglTexture=Ke,bt.get(ve.depthTexture).__webglTexture=_t.__autoAllocateDepthBuffer?void 0:vt,_t.__hasExternalTextures=!0},this.setRenderTargetFramebuffer=function(ve,Ke){const vt=bt.get(ve);vt.__webglFramebuffer=Ke,vt.__useDefaultFramebuffer=Ke===void 0};const dd=de.createFramebuffer();this.setRenderTarget=function(ve,Ke=0,vt=0){k=ve,R=Ke,I=vt;let _t=!0,Qe=null,Ht=!1,nn=!1;if(ve){const Sn=bt.get(ve);if(Sn.__useDefaultFramebuffer!==void 0)ft.bindFramebuffer(de.FRAMEBUFFER,null),_t=!1;else if(Sn.__webglFramebuffer===void 0)be.setupRenderTarget(ve);else if(Sn.__hasExternalTextures)be.rebindTextures(ve,bt.get(ve.texture).__webglTexture,bt.get(ve.depthTexture).__webglTexture);else if(ve.depthBuffer){const Cn=ve.depthTexture;if(Sn.__boundDepthTexture!==Cn){if(Cn!==null&&bt.has(Cn)&&(ve.width!==Cn.image.width||ve.height!==Cn.image.height))throw new Error("WebGLRenderTarget: Attached DepthTexture is initialized to the incorrect size.");be.setupDepthRenderbuffer(ve)}}const oi=ve.texture;(oi.isData3DTexture||oi.isDataArrayTexture||oi.isCompressedArrayTexture)&&(nn=!0);const ci=bt.get(ve).__webglFramebuffer;ve.isWebGLCubeRenderTarget?(Array.isArray(ci[Ke])?Qe=ci[Ke][vt]:Qe=ci[Ke],Ht=!0):ve.samples>0&&be.useMultisampledRTT(ve)===!1?Qe=bt.get(ve).__webglMultisampledFramebuffer:Array.isArray(ci)?Qe=ci[vt]:Qe=ci,G.copy(ve.viewport),$.copy(ve.scissor),q=ve.scissorTest}else G.copy(fe).multiplyScalar(X).floor(),$.copy(Re).multiplyScalar(X).floor(),q=He;if(vt!==0&&(Qe=dd),ft.bindFramebuffer(de.FRAMEBUFFER,Qe)&&_t&&ft.drawBuffers(ve,Qe),ft.viewport(G),ft.scissor($),ft.setScissorTest(q),Ht){const Sn=bt.get(ve.texture);de.framebufferTexture2D(de.FRAMEBUFFER,de.COLOR_ATTACHMENT0,de.TEXTURE_CUBE_MAP_POSITIVE_X+Ke,Sn.__webglTexture,vt)}else if(nn){const Sn=bt.get(ve.texture),oi=Ke;de.framebufferTextureLayer(de.FRAMEBUFFER,de.COLOR_ATTACHMENT0,Sn.__webglTexture,vt,oi)}else if(ve!==null&&vt!==0){const Sn=bt.get(ve.texture);de.framebufferTexture2D(de.FRAMEBUFFER,de.COLOR_ATTACHMENT0,de.TEXTURE_2D,Sn.__webglTexture,vt)}P=-1},this.readRenderTargetPixels=function(ve,Ke,vt,_t,Qe,Ht,nn){if(!(ve&&ve.isWebGLRenderTarget)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");return}let mn=bt.get(ve).__webglFramebuffer;if(ve.isWebGLCubeRenderTarget&&nn!==void 0&&(mn=mn[nn]),mn){ft.bindFramebuffer(de.FRAMEBUFFER,mn);try{const Sn=ve.texture,oi=Sn.format,ci=Sn.type;if(!rt.textureFormatReadable(oi)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");return}if(!rt.textureTypeReadable(ci)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");return}Ke>=0&&Ke<=ve.width-_t&&vt>=0&&vt<=ve.height-Qe&&de.readPixels(Ke,vt,_t,Qe,xt.convert(oi),xt.convert(ci),Ht)}finally{const Sn=k!==null?bt.get(k).__webglFramebuffer:null;ft.bindFramebuffer(de.FRAMEBUFFER,Sn)}}},this.readRenderTargetPixelsAsync=async function(ve,Ke,vt,_t,Qe,Ht,nn){if(!(ve&&ve.isWebGLRenderTarget))throw new Error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");let mn=bt.get(ve).__webglFramebuffer;if(ve.isWebGLCubeRenderTarget&&nn!==void 0&&(mn=mn[nn]),mn)if(Ke>=0&&Ke<=ve.width-_t&&vt>=0&&vt<=ve.height-Qe){ft.bindFramebuffer(de.FRAMEBUFFER,mn);const Sn=ve.texture,oi=Sn.format,ci=Sn.type;if(!rt.textureFormatReadable(oi))throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: renderTarget is not in RGBA or implementation defined format.");if(!rt.textureTypeReadable(ci))throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: renderTarget is not in UnsignedByteType or implementation defined type.");const Cn=de.createBuffer();de.bindBuffer(de.PIXEL_PACK_BUFFER,Cn),de.bufferData(de.PIXEL_PACK_BUFFER,Ht.byteLength,de.STREAM_READ),de.readPixels(Ke,vt,_t,Qe,xt.convert(oi),xt.convert(ci),0);const gi=k!==null?bt.get(k).__webglFramebuffer:null;ft.bindFramebuffer(de.FRAMEBUFFER,gi);const ar=de.fenceSync(de.SYNC_GPU_COMMANDS_COMPLETE,0);return de.flush(),await Ewe(de,ar,4),de.bindBuffer(de.PIXEL_PACK_BUFFER,Cn),de.getBufferSubData(de.PIXEL_PACK_BUFFER,0,Ht),de.deleteBuffer(Cn),de.deleteSync(ar),Ht}else throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: requested read bounds are out of range.")},this.copyFramebufferToTexture=function(ve,Ke=null,vt=0){const _t=Math.pow(2,-vt),Qe=Math.floor(ve.image.width*_t),Ht=Math.floor(ve.image.height*_t),nn=Ke!==null?Ke.x:0,mn=Ke!==null?Ke.y:0;be.setTexture2D(ve,0),de.copyTexSubImage2D(de.TEXTURE_2D,vt,0,0,nn,mn,Qe,Ht),ft.unbindTexture()};const pd=de.createFramebuffer(),wu=de.createFramebuffer();this.copyTextureToTexture=function(ve,Ke,vt=null,_t=null,Qe=0,Ht=null){Ht===null&&(Qe!==0?(KP("WebGLRenderer: copyTextureToTexture function signature has changed to support src and dst mipmap levels."),Ht=Qe,Qe=0):Ht=0);let nn,mn,Sn,oi,ci,Cn,gi,ar,Os;const bs=ve.isCompressedTexture?ve.mipmaps[Ht]:ve.image;if(vt!==null)nn=vt.max.x-vt.min.x,mn=vt.max.y-vt.min.y,Sn=vt.isBox3?vt.max.z-vt.min.z:1,oi=vt.min.x,ci=vt.min.y,Cn=vt.isBox3?vt.min.z:0;else{const io=Math.pow(2,-Qe);nn=Math.floor(bs.width*io),mn=Math.floor(bs.height*io),ve.isDataArrayTexture?Sn=bs.depth:ve.isData3DTexture?Sn=Math.floor(bs.depth*io):Sn=1,oi=0,ci=0,Cn=0}_t!==null?(gi=_t.x,ar=_t.y,Os=_t.z):(gi=0,ar=0,Os=0);const Ki=xt.convert(Ke.format),Xn=xt.convert(Ke.type);let Ti;Ke.isData3DTexture?(be.setTexture3D(Ke,0),Ti=de.TEXTURE_3D):Ke.isDataArrayTexture||Ke.isCompressedArrayTexture?(be.setTexture2DArray(Ke,0),Ti=de.TEXTURE_2D_ARRAY):(be.setTexture2D(Ke,0),Ti=de.TEXTURE_2D),de.pixelStorei(de.UNPACK_FLIP_Y_WEBGL,Ke.flipY),de.pixelStorei(de.UNPACK_PREMULTIPLY_ALPHA_WEBGL,Ke.premultiplyAlpha),de.pixelStorei(de.UNPACK_ALIGNMENT,Ke.unpackAlignment);const Bn=de.getParameter(de.UNPACK_ROW_LENGTH),qo=de.getParameter(de.UNPACK_IMAGE_HEIGHT),$l=de.getParameter(de.UNPACK_SKIP_PIXELS),no=de.getParameter(de.UNPACK_SKIP_ROWS),mh=de.getParameter(de.UNPACK_SKIP_IMAGES);de.pixelStorei(de.UNPACK_ROW_LENGTH,bs.width),de.pixelStorei(de.UNPACK_IMAGE_HEIGHT,bs.height),de.pixelStorei(de.UNPACK_SKIP_PIXELS,oi),de.pixelStorei(de.UNPACK_SKIP_ROWS,ci),de.pixelStorei(de.UNPACK_SKIP_IMAGES,Cn);const ls=ve.isDataArrayTexture||ve.isData3DTexture,bn=Ke.isDataArrayTexture||Ke.isData3DTexture;if(ve.isDepthTexture){const io=bt.get(ve),Vs=bt.get(Ke),qn=bt.get(io.__renderTarget),xl=bt.get(Vs.__renderTarget);ft.bindFramebuffer(de.READ_FRAMEBUFFER,qn.__webglFramebuffer),ft.bindFramebuffer(de.DRAW_FRAMEBUFFER,xl.__webglFramebuffer);for(let la=0;la<Sn;la++)ls&&(de.framebufferTextureLayer(de.READ_FRAMEBUFFER,de.COLOR_ATTACHMENT0,bt.get(ve).__webglTexture,Qe,Cn+la),de.framebufferTextureLayer(de.DRAW_FRAMEBUFFER,de.COLOR_ATTACHMENT0,bt.get(Ke).__webglTexture,Ht,Os+la)),de.blitFramebuffer(oi,ci,nn,mn,gi,ar,nn,mn,de.DEPTH_BUFFER_BIT,de.NEAREST);ft.bindFramebuffer(de.READ_FRAMEBUFFER,null),ft.bindFramebuffer(de.DRAW_FRAMEBUFFER,null)}else if(Qe!==0||ve.isRenderTargetTexture||bt.has(ve)){const io=bt.get(ve),Vs=bt.get(Ke);ft.bindFramebuffer(de.READ_FRAMEBUFFER,pd),ft.bindFramebuffer(de.DRAW_FRAMEBUFFER,wu);for(let qn=0;qn<Sn;qn++)ls?de.framebufferTextureLayer(de.READ_FRAMEBUFFER,de.COLOR_ATTACHMENT0,io.__webglTexture,Qe,Cn+qn):de.framebufferTexture2D(de.READ_FRAMEBUFFER,de.COLOR_ATTACHMENT0,de.TEXTURE_2D,io.__webglTexture,Qe),bn?de.framebufferTextureLayer(de.DRAW_FRAMEBUFFER,de.COLOR_ATTACHMENT0,Vs.__webglTexture,Ht,Os+qn):de.framebufferTexture2D(de.DRAW_FRAMEBUFFER,de.COLOR_ATTACHMENT0,de.TEXTURE_2D,Vs.__webglTexture,Ht),Qe!==0?de.blitFramebuffer(oi,ci,nn,mn,gi,ar,nn,mn,de.COLOR_BUFFER_BIT,de.NEAREST):bn?de.copyTexSubImage3D(Ti,Ht,gi,ar,Os+qn,oi,ci,nn,mn):de.copyTexSubImage2D(Ti,Ht,gi,ar,oi,ci,nn,mn);ft.bindFramebuffer(de.READ_FRAMEBUFFER,null),ft.bindFramebuffer(de.DRAW_FRAMEBUFFER,null)}else bn?ve.isDataTexture||ve.isData3DTexture?de.texSubImage3D(Ti,Ht,gi,ar,Os,nn,mn,Sn,Ki,Xn,bs.data):Ke.isCompressedArrayTexture?de.compressedTexSubImage3D(Ti,Ht,gi,ar,Os,nn,mn,Sn,Ki,bs.data):de.texSubImage3D(Ti,Ht,gi,ar,Os,nn,mn,Sn,Ki,Xn,bs):ve.isDataTexture?de.texSubImage2D(de.TEXTURE_2D,Ht,gi,ar,nn,mn,Ki,Xn,bs.data):ve.isCompressedTexture?de.compressedTexSubImage2D(de.TEXTURE_2D,Ht,gi,ar,bs.width,bs.height,Ki,bs.data):de.texSubImage2D(de.TEXTURE_2D,Ht,gi,ar,nn,mn,Ki,Xn,bs);de.pixelStorei(de.UNPACK_ROW_LENGTH,Bn),de.pixelStorei(de.UNPACK_IMAGE_HEIGHT,qo),de.pixelStorei(de.UNPACK_SKIP_PIXELS,$l),de.pixelStorei(de.UNPACK_SKIP_ROWS,no),de.pixelStorei(de.UNPACK_SKIP_IMAGES,mh),Ht===0&&Ke.generateMipmaps&&de.generateMipmap(Ti),ft.unbindTexture()},this.copyTextureToTexture3D=function(ve,Ke,vt=null,_t=null,Qe=0){return KP('WebGLRenderer: copyTextureToTexture3D function has been deprecated. Use "copyTextureToTexture" instead.'),this.copyTextureToTexture(ve,Ke,vt,_t,Qe)},this.initRenderTarget=function(ve){bt.get(ve).__webglFramebuffer===void 0&&be.setupRenderTarget(ve)},this.initTexture=function(ve){ve.isCubeTexture?be.setTextureCube(ve,0):ve.isData3DTexture?be.setTexture3D(ve,0):ve.isDataArrayTexture||ve.isCompressedArrayTexture?be.setTexture2DArray(ve,0):be.setTexture2D(ve,0),ft.unbindTexture()},this.resetState=function(){R=0,I=0,k=null,ft.reset(),Vn.reset()},typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}get coordinateSystem(){return ip}get outputColorSpace(){return this._outputColorSpace}set outputColorSpace(e){this._outputColorSpace=e;const n=this.getContext();n.drawingBufferColorSpace=Ur._getDrawingBufferColorSpace(e),n.unpackColorSpace=Ur._getUnpackColorSpace()}}const PIe=Object.freeze(Object.defineProperty({__proto__:null,ACESFilmicToneMapping:Q$,AddEquation:nb,AddOperation:cce,AdditiveAnimationBlendMode:c7,AdditiveBlending:hV,AgXToneMapping:dce,AlphaFormat:r7,AlwaysCompare:Ace,AlwaysDepth:fL,AlwaysStencilFunc:mV,AmbientLight:Sle,AnimationAction:Nle,AnimationClip:xO,AnimationLoader:XCe,AnimationMixer:xAe,AnimationObjectGroup:SAe,AnimationUtils:qCe,ArcCurve:Yce,ArrayCamera:Rle,ArrowHelper:$Ae,AttachedBindMode:pV,Audio:Mle,AudioAnalyser:fAe,AudioContext:N7,AudioListener:lAe,AudioLoader:aAe,AxesHelper:WAe,BackSide:Bc,BasicDepthPacking:uE,BasicShadowMap:joe,BatchedMesh:jce,Bone:p7,BooleanKeyframeTrack:p1,Box2:Ile,Box3:gu,Box3Helper:GAe,BoxGeometry:d1,BoxHelper:VAe,BufferAttribute:rr,BufferGeometry:Qi,BufferGeometryLoader:Ale,ByteType:t7,Cache:Kv,Camera:iI,CameraHelper:jAe,CanvasTexture:$ce,CapsuleGeometry:RB,CatmullRomCurve3:Xce,CineonToneMapping:hce,CircleGeometry:MB,ClampToEdgeWrapping:np,Clock:I7,Color:yn,ColorKeyframeTrack:R7,ColorManagement:Ur,CompressedArrayTexture:fCe,CompressedCubeTexture:dCe,CompressedTexture:AB,CompressedTextureLoader:KCe,ConeGeometry:aI,ConstantAlphaFactor:sce,ConstantColorFactor:ice,Controls:XAe,CubeCamera:Pce,CubeReflectionMapping:m_,CubeRefractionMapping:Vb,CubeTexture:rI,CubeTextureLoader:ZCe,CubeUVReflectionMapping:vA,CubicBezierCurve:v7,CubicBezierCurve3:Kce,CubicInterpolant:ple,CullFaceBack:uV,CullFaceFront:Hoe,CullFaceFrontBack:Exe,CullFaceNone:zoe,Curve:bm,CurvePath:Jce,CustomBlending:Voe,CustomToneMapping:fce,CylinderGeometry:sI,Cylindrical:IAe,Data3DTexture:EB,DataArrayTexture:nI,DataTexture:up,DataTextureLoader:JCe,DataUtils:Bwe,DecrementStencilOp:Pxe,DecrementWrapStencilOp:Uxe,DefaultLoadingManager:vle,DepthArrayTexture:pCe,DepthFormat:_C,DepthStencilFormat:kT,DepthTexture:bA,DetachedBindMode:mce,DirectionalLight:Ele,DirectionalLightHelper:HAe,DiscreteInterpolant:mle,DodecahedronGeometry:OB,DoubleSide:dl,DstAlphaFactor:Joe,DstColorFactor:ece,DynamicCopyUsage:Jxe,DynamicDrawUsage:$xe,DynamicReadUsage:Xxe,EdgesGeometry:Wce,EllipseCurve:NB,EqualCompare:Tce,EqualDepth:pL,EqualStencilFunc:Hxe,EquirectangularReflectionMapping:lO,EquirectangularRefractionMapping:uO,Euler:rf,EventDispatcher:cd,ExtrudeGeometry:IB,FileLoader:g_,Float16BufferAttribute:qwe,Float32BufferAttribute:Hn,FloatType:hu,Fog:TB,FogExp2:SB,FramebufferTexture:hCe,FrontSide:Zg,Frustum:yA,FrustumArray:CB,GLBufferAttribute:OAe,GLSL1:ewe,GLSL3:gV,GreaterCompare:xce,GreaterDepth:gL,GreaterEqualCompare:Cce,GreaterEqualDepth:mL,GreaterEqualStencilFunc:qxe,GreaterStencilFunc:Vxe,GridHelper:FAe,Group:pw,HalfFloatType:lE,HemisphereLight:_le,HemisphereLightHelper:BAe,IcosahedronGeometry:kB,ImageBitmapLoader:sAe,ImageLoader:wO,ImageUtils:Nce,IncrementStencilOp:Dxe,IncrementWrapStencilOp:Lxe,InstancedBufferAttribute:TC,InstancedBufferGeometry:Cle,InstancedInterleavedBuffer:MAe,InstancedMesh:Hce,Int16BufferAttribute:Vwe,Int32BufferAttribute:Gwe,Int8BufferAttribute:zwe,IntType:pB,InterleavedBuffer:xB,InterleavedBufferAttribute:DT,Interpolant:lI,InterpolateDiscrete:dO,InterpolateLinear:GL,InterpolateSmooth:XP,InterpolationSamplingMode:iwe,InterpolationSamplingType:nwe,InvertStencilOp:Bxe,KeepStencilOp:HS,KeyframeTrack:xp,LOD:Fce,LatheGeometry:DB,Layers:bC,LessCompare:Sce,LessDepth:dL,LessEqualCompare:l7,LessEqualDepth:NT,LessEqualStencilFunc:jxe,LessStencilFunc:zxe,Light:pE,LightProbe:wle,Line:Gb,Line3:kAe,LineBasicMaterial:hh,LineCurve:_7,LineCurve3:Zce,LineDashedMaterial:hle,LineLoop:Vce,LineSegments:h0,LinearFilter:Ea,LinearInterpolant:A7,LinearMipMapLinearFilter:wxe,LinearMipMapNearestFilter:xxe,LinearMipmapLinearFilter:Ig,LinearMipmapNearestFilter:_M,LinearSRGBColorSpace:Qg,LinearToneMapping:lce,LinearTransfer:mO,Loader:df,LoaderUtils:EV,LoadingManager:M7,LoopOnce:gce,LoopPingPong:_ce,LoopRepeat:vce,MOUSE:yxe,Material:Tl,MaterialLoader:HB,MathUtils:Rce,Matrix2:L7,Matrix3:Ji,Matrix4:Ni,MaxEquation:Woe,Mesh:jo,MeshBasicMaterial:fE,MeshDepthMaterial:x7,MeshDistanceMaterial:w7,MeshLambertMaterial:lle,MeshMatcapMaterial:ule,MeshNormalMaterial:T7,MeshPhongMaterial:ole,MeshPhysicalMaterial:ale,MeshStandardMaterial:S7,MeshToonMaterial:cle,MinEquation:$oe,MirroredRepeatWrapping:fO,MixOperation:oce,MultiplyBlending:dV,MultiplyOperation:QN,NearestFilter:eo,NearestMipMapLinearFilter:Txe,NearestMipMapNearestFilter:Sxe,NearestMipmapLinearFilter:fw,NearestMipmapNearestFilter:e7,NeutralToneMapping:pce,NeverCompare:Ece,NeverDepth:hL,NeverStencilFunc:Fxe,NoBlending:lp,NoColorSpace:om,NoToneMapping:hm,NormalAnimationBlendMode:yB,NormalBlending:pT,NotEqualCompare:wce,NotEqualDepth:vL,NotEqualStencilFunc:Gxe,NumberKeyframeTrack:SO,Object3D:qr,ObjectLoader:iAe,ObjectSpaceNormalMap:bce,OctahedronGeometry:oI,OneFactor:Xoe,OneMinusConstantAlphaFactor:ace,OneMinusConstantColorFactor:rce,OneMinusDstAlphaFactor:Qoe,OneMinusDstColorFactor:tce,OneMinusSrcAlphaFactor:uL,OneMinusSrcColorFactor:Zoe,OrthographicCamera:hI,PCFShadowMap:fB,PCFSoftShadowMap:vM,PMREMGenerator:xV,Path:YL,PerspectiveCamera:Pc,Plane:qy,PlaneGeometry:EA,PlaneHelper:qAe,PointLight:ble,PointLightHelper:LAe,Points:Gce,PointsMaterial:m7,PolarGridHelper:zAe,PolyhedronGeometry:dE,PositionalAudio:hAe,PropertyBinding:Xr,PropertyMixer:Ole,QuadraticBezierCurve:y7,QuadraticBezierCurve3:b7,Quaternion:Qh,QuaternionKeyframeTrack:uI,QuaternionLinearInterpolant:gle,RED_GREEN_RGTC2_Format:jL,RED_RGTC1_Format:o7,REVISION:JN,RGBADepthPacking:yce,RGBAFormat:fu,RGBAIntegerFormat:tI,RGBA_ASTC_10x10_Format:LL,RGBA_ASTC_10x5_Format:kL,RGBA_ASTC_10x6_Format:DL,RGBA_ASTC_10x8_Format:PL,RGBA_ASTC_12x10_Format:UL,RGBA_ASTC_12x12_Format:BL,RGBA_ASTC_4x4_Format:wL,RGBA_ASTC_5x4_Format:CL,RGBA_ASTC_5x5_Format:AL,RGBA_ASTC_6x5_Format:RL,RGBA_ASTC_6x6_Format:ML,RGBA_ASTC_8x5_Format:OL,RGBA_ASTC_8x6_Format:NL,RGBA_ASTC_8x8_Format:IL,RGBA_BPTC_Format:TM,RGBA_ETC2_EAC_Format:xL,RGBA_PVRTC_2BPPV1_Format:EL,RGBA_PVRTC_4BPPV1_Format:bL,RGBA_S3TC_DXT1_Format:bM,RGBA_S3TC_DXT3_Format:EM,RGBA_S3TC_DXT5_Format:SM,RGBDepthPacking:Oxe,RGBFormat:s7,RGBIntegerFormat:Cxe,RGB_BPTC_SIGNED_Format:FL,RGB_BPTC_UNSIGNED_Format:zL,RGB_ETC1_Format:SL,RGB_ETC2_Format:TL,RGB_PVRTC_2BPPV1_Format:yL,RGB_PVRTC_4BPPV1_Format:_L,RGB_S3TC_DXT1_Format:yM,RGDepthPacking:Nxe,RGFormat:a7,RGIntegerFormat:_B,RawShaderMaterial:sle,Ray:_A,Raycaster:P7,RectAreaLight:Tle,RedFormat:vB,RedIntegerFormat:eI,ReinhardToneMapping:uce,RenderTarget:bB,RenderTarget3D:wAe,RenderTargetArray:CAe,RepeatWrapping:hO,ReplaceStencilOp:kxe,ReverseSubtractEquation:qoe,RingGeometry:PB,SIGNED_RED_GREEN_RGTC2_Format:VL,SIGNED_RED_RGTC1_Format:HL,SRGBColorSpace:ba,SRGBTransfer:As,Scene:SC,ShaderChunk:ir,ShaderLib:im,ShaderMaterial:Hc,ShadowMaterial:rle,Shape:gT,ShapeGeometry:LB,ShapePath:YAe,ShapeUtils:lm,ShortType:n7,Skeleton:wB,SkeletonHelper:PAe,SkinnedMesh:zce,Source:ub,Sphere:zl,SphereGeometry:cI,Spherical:NAe,SphericalHarmonics3:xle,SplineCurve:E7,SpotLight:yle,SpotLightHelper:DAe,Sprite:Bce,SpriteMaterial:d7,SrcAlphaFactor:lL,SrcAlphaSaturateFactor:nce,SrcColorFactor:Koe,StaticCopyUsage:Zxe,StaticDrawUsage:gO,StaticReadUsage:Yxe,StereoCamera:oAe,StreamCopyUsage:Qxe,StreamDrawUsage:Wxe,StreamReadUsage:Kxe,StringKeyframeTrack:m1,SubtractEquation:Goe,SubtractiveBlending:fV,TOUCH:bxe,TangentSpaceNormalMap:hE,TetrahedronGeometry:UB,Texture:Ba,TextureLoader:QCe,TextureUtils:eRe,TimestampQuery:twe,TorusGeometry:BB,TorusKnotGeometry:FB,Triangle:Gh,TriangleFanDrawMode:Mxe,TriangleStripDrawMode:Rxe,TrianglesDrawMode:Axe,TubeGeometry:zB,UVMapping:dB,Uint16BufferAttribute:h7,Uint32BufferAttribute:f7,Uint8BufferAttribute:Hwe,Uint8ClampedBufferAttribute:jwe,Uniform:Yi,UniformsGroup:RAe,UniformsLib:vn,UniformsUtils:Dce,UnsignedByteType:El,UnsignedInt248Type:IT,UnsignedInt5999Type:i7,UnsignedIntType:Jg,UnsignedShort4444Type:mB,UnsignedShort5551Type:gB,UnsignedShortType:vC,VSMShadowMap:em,Vector2:Rt,Vector3:Ae,Vector4:Zr,VectorKeyframeTrack:TO,VideoFrameTexture:uCe,VideoTexture:qce,WebGL3DRenderTarget:Rwe,WebGLArrayRenderTarget:Awe,WebGLCoordinateSystem:ip,WebGLCubeRenderTarget:Lce,WebGLRenderTarget:Vl,WebGLRenderer:zle,WebGLUtils:Fle,WebGPUCoordinateSystem:vO,WebXRController:ZP,WireframeGeometry:ile,WrapAroundEnding:pO,ZeroCurvatureEnding:rT,ZeroFactor:Yoe,ZeroSlopeEnding:sT,ZeroStencilOp:Ixe,createCanvasElement:Oce},Symbol.toStringTag,{value:"Module"}));var Hle={exports:{}},ur={},B7=Symbol.for("react.transitional.element"),LIe=Symbol.for("react.portal"),UIe=Symbol.for("react.fragment"),BIe=Symbol.for("react.strict_mode"),FIe=Symbol.for("react.profiler"),zIe=Symbol.for("react.consumer"),HIe=Symbol.for("react.context"),jIe=Symbol.for("react.forward_ref"),VIe=Symbol.for("react.suspense"),GIe=Symbol.for("react.memo"),jle=Symbol.for("react.lazy"),HJ=Symbol.iterator;function qIe(t){return t===null||typeof t!="object"?null:(t=HJ&&t[HJ]||t["@@iterator"],typeof t=="function"?t:null)}var Vle={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},Gle=Object.assign,qle={};function TA(t,e,n){this.props=t,this.context=e,this.refs=qle,this.updater=n||Vle}TA.prototype.isReactComponent={};TA.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};TA.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function $le(){}$le.prototype=TA.prototype;function F7(t,e,n){this.props=t,this.context=e,this.refs=qle,this.updater=n||Vle}var z7=F7.prototype=new $le;z7.constructor=F7;Gle(z7,TA.prototype);z7.isPureReactComponent=!0;var jJ=Array.isArray,La={H:null,A:null,T:null,S:null,V:null},Wle=Object.prototype.hasOwnProperty;function H7(t,e,n,i,r,s){return n=s.ref,{$$typeof:B7,type:t,key:e,ref:n!==void 0?n:null,props:s}}function $Ie(t,e){return H7(t.type,e,void 0,void 0,void 0,t.props)}function j7(t){return typeof t=="object"&&t!==null&&t.$$typeof===B7}function WIe(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var VJ=/\/+/g;function yH(t,e){return typeof t=="object"&&t!==null&&t.key!=null?WIe(""+t.key):e.toString(36)}function GJ(){}function YIe(t){switch(t.status){case"fulfilled":return t.value;case"rejected":throw t.reason;default:switch(typeof t.status=="string"?t.then(GJ,GJ):(t.status="pending",t.then(function(e){t.status==="pending"&&(t.status="fulfilled",t.value=e)},function(e){t.status==="pending"&&(t.status="rejected",t.reason=e)})),t.status){case"fulfilled":return t.value;case"rejected":throw t.reason}}throw t}function tw(t,e,n,i,r){var s=typeof t;(s==="undefined"||s==="boolean")&&(t=null);var a=!1;if(t===null)a=!0;else switch(s){case"bigint":case"string":case"number":a=!0;break;case"object":switch(t.$$typeof){case B7:case LIe:a=!0;break;case jle:return a=t._init,tw(a(t._payload),e,n,i,r)}}if(a)return r=r(t),a=i===""?"."+yH(t,0):i,jJ(r)?(n="",a!=null&&(n=a.replace(VJ,"$&/")+"/"),tw(r,e,n,"",function(l){return l})):r!=null&&(j7(r)&&(r=$Ie(r,n+(r.key==null||t&&t.key===r.key?"":(""+r.key).replace(VJ,"$&/")+"/")+a)),e.push(r)),1;a=0;var o=i===""?".":i+":";if(jJ(t))for(var c=0;c<t.length;c++)i=t[c],s=o+yH(i,c),a+=tw(i,e,n,s,r);else if(c=qIe(t),typeof c=="function")for(t=c.call(t),c=0;!(i=t.next()).done;)i=i.value,s=o+yH(i,c++),a+=tw(i,e,n,s,r);else if(s==="object"){if(typeof t.then=="function")return tw(YIe(t),e,n,i,r);throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.")}return a}function LD(t,e,n){if(t==null)return t;var i=[],r=0;return tw(t,i,"","",function(s){return e.call(n,s,r++)}),i}function XIe(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var qJ=typeof reportError=="function"?reportError:function(t){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var e=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof t=="object"&&t!==null&&typeof t.message=="string"?String(t.message):String(t),error:t});if(!window.dispatchEvent(e))return}else if(typeof zn=="object"&&typeof zn.emit=="function"){zn.emit("uncaughtException",t);return}console.error(t)};function KIe(){}ur.Children={map:LD,forEach:function(t,e,n){LD(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return LD(t,function(){e++}),e},toArray:function(t){return LD(t,function(e){return e})||[]},only:function(t){if(!j7(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};ur.Component=TA;ur.Fragment=UIe;ur.Profiler=FIe;ur.PureComponent=F7;ur.StrictMode=BIe;ur.Suspense=VIe;ur.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=La;ur.__COMPILER_RUNTIME={__proto__:null,c:function(t){return La.H.useMemoCache(t)}};ur.cache=function(t){return function(){return t.apply(null,arguments)}};ur.cloneElement=function(t,e,n){if(t==null)throw Error("The argument must be a React element, but you passed "+t+".");var i=Gle({},t.props),r=t.key,s=void 0;if(e!=null)for(a in e.ref!==void 0&&(s=void 0),e.key!==void 0&&(r=""+e.key),e)!Wle.call(e,a)||a==="key"||a==="__self"||a==="__source"||a==="ref"&&e.ref===void 0||(i[a]=e[a]);var a=arguments.length-2;if(a===1)i.children=n;else if(1<a){for(var o=Array(a),c=0;c<a;c++)o[c]=arguments[c+2];i.children=o}return H7(t.type,r,void 0,void 0,s,i)};ur.createContext=function(t){return t={$$typeof:HIe,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null},t.Provider=t,t.Consumer={$$typeof:zIe,_context:t},t};ur.createElement=function(t,e,n){var i,r={},s=null;if(e!=null)for(i in e.key!==void 0&&(s=""+e.key),e)Wle.call(e,i)&&i!=="key"&&i!=="__self"&&i!=="__source"&&(r[i]=e[i]);var a=arguments.length-2;if(a===1)r.children=n;else if(1<a){for(var o=Array(a),c=0;c<a;c++)o[c]=arguments[c+2];r.children=o}if(t&&t.defaultProps)for(i in a=t.defaultProps,a)r[i]===void 0&&(r[i]=a[i]);return H7(t,s,void 0,void 0,null,r)};ur.createRef=function(){return{current:null}};ur.forwardRef=function(t){return{$$typeof:jIe,render:t}};ur.isValidElement=j7;ur.lazy=function(t){return{$$typeof:jle,_payload:{_status:-1,_result:t},_init:XIe}};ur.memo=function(t,e){return{$$typeof:GIe,type:t,compare:e===void 0?null:e}};ur.startTransition=function(t){var e=La.T,n={};La.T=n;try{var i=t(),r=La.S;r!==null&&r(n,i),typeof i=="object"&&i!==null&&typeof i.then=="function"&&i.then(KIe,qJ)}catch(s){qJ(s)}finally{La.T=e}};ur.unstable_useCacheRefresh=function(){return La.H.useCacheRefresh()};ur.use=function(t){return La.H.use(t)};ur.useActionState=function(t,e,n){return La.H.useActionState(t,e,n)};ur.useCallback=function(t,e){return La.H.useCallback(t,e)};ur.useContext=function(t){return La.H.useContext(t)};ur.useDebugValue=function(){};ur.useDeferredValue=function(t,e){return La.H.useDeferredValue(t,e)};ur.useEffect=function(t,e,n){var i=La.H;if(typeof n=="function")throw Error("useEffect CRUD overload is not enabled in this build of React.");return i.useEffect(t,e)};ur.useId=function(){return La.H.useId()};ur.useImperativeHandle=function(t,e,n){return La.H.useImperativeHandle(t,e,n)};ur.useInsertionEffect=function(t,e){return La.H.useInsertionEffect(t,e)};ur.useLayoutEffect=function(t,e){return La.H.useLayoutEffect(t,e)};ur.useMemo=function(t,e){return La.H.useMemo(t,e)};ur.useOptimistic=function(t,e){return La.H.useOptimistic(t,e)};ur.useReducer=function(t,e,n){return La.H.useReducer(t,e,n)};ur.useRef=function(t){return La.H.useRef(t)};ur.useState=function(t){return La.H.useState(t)};ur.useSyncExternalStore=function(t,e,n){return La.H.useSyncExternalStore(t,e,n)};ur.useTransition=function(){return La.H.useTransition()};ur.version="19.1.0";Hle.exports=ur;var Fe=Hle.exports;const Ug=Yc(Fe);var Yle={exports:{}},mE={};/**
 * @license React
 * react-reconciler-constants.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */mE.ConcurrentRoot=1;mE.ContinuousEventPriority=8;mE.DefaultEventPriority=32;mE.DiscreteEventPriority=2;mE.IdleEventPriority=268435456;mE.LegacyRoot=0;mE.NoEventPriority=0;Yle.exports=mE;var QP=Yle.exports,Xle={exports:{}},Kle={},Zle={exports:{}},Jle={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var wC=Fe;function ZIe(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var JIe=typeof Object.is=="function"?Object.is:ZIe,QIe=wC.useState,eke=wC.useEffect,tke=wC.useLayoutEffect,nke=wC.useDebugValue;function ike(t,e){var n=e(),i=QIe({inst:{value:n,getSnapshot:e}}),r=i[0].inst,s=i[1];return tke(function(){r.value=n,r.getSnapshot=e,bH(r)&&s({inst:r})},[t,n,e]),eke(function(){return bH(r)&&s({inst:r}),t(function(){bH(r)&&s({inst:r})})},[t]),nke(n),n}function bH(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!JIe(t,n)}catch{return!0}}function rke(t,e){return e()}var ske=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?rke:ike;Jle.useSyncExternalStore=wC.useSyncExternalStore!==void 0?wC.useSyncExternalStore:ske;Zle.exports=Jle;var ake=Zle.exports;/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var VB=Fe,oke=ake;function cke(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var lke=typeof Object.is=="function"?Object.is:cke,uke=oke.useSyncExternalStore,hke=VB.useRef,fke=VB.useEffect,dke=VB.useMemo,pke=VB.useDebugValue;Kle.useSyncExternalStoreWithSelector=function(t,e,n,i,r){var s=hke(null);if(s.current===null){var a={hasValue:!1,value:null};s.current=a}else a=s.current;s=dke(function(){function c(d){if(!l){if(l=!0,u=d,d=i(d),r!==void 0&&a.hasValue){var p=a.value;if(r(p,d))return h=p}return h=d}if(p=h,lke(u,d))return p;var g=i(d);return r!==void 0&&r(p,g)?(u=d,p):(u=d,h=g)}var l=!1,u,h,f=n===void 0?null:n;return[function(){return c(e())},f===null?void 0:function(){return c(f())}]},[e,n,i,r]);var o=uke(t,s[0],s[1]);return fke(function(){a.hasValue=!0,a.value=o},[o]),pke(o),o};Xle.exports=Kle;var mke=Xle.exports;const gke=Yc(mke),$J=t=>{let e;const n=new Set,i=(l,u)=>{const h=typeof l=="function"?l(e):l;if(!Object.is(h,e)){const f=e;e=u??(typeof h!="object"||h===null)?h:Object.assign({},e,h),n.forEach(d=>d(e,f))}},r=()=>e,o={setState:i,getState:r,getInitialState:()=>c,subscribe:l=>(n.add(l),()=>n.delete(l))},c=e=t(i,r,o);return o},vke=t=>t?$J(t):$J,{useSyncExternalStoreWithSelector:_ke}=gke,yke=t=>t;function bke(t,e=yke,n){const i=_ke(t.subscribe,t.getState,t.getInitialState,e,n);return Ug.useDebugValue(i),i}const WJ=(t,e)=>{const n=vke(t),i=(r,s=e)=>bke(n,r,s);return Object.assign(i,n),i},Qle=(t,e)=>t?WJ(t,e):WJ;var eue={exports:{}},tue={exports:{}},nue={exports:{}},iue={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(V,J){var X=V.length;V.push(J);e:for(;0<X;){var ee=X-1>>>1,oe=V[ee];if(0<r(oe,J))V[ee]=J,V[X]=oe,X=ee;else break e}}function n(V){return V.length===0?null:V[0]}function i(V){if(V.length===0)return null;var J=V[0],X=V.pop();if(X!==J){V[0]=X;e:for(var ee=0,oe=V.length,fe=oe>>>1;ee<fe;){var Re=2*(ee+1)-1,He=V[Re],Te=Re+1,Le=V[Te];if(0>r(He,X))Te<oe&&0>r(Le,He)?(V[ee]=Le,V[Te]=X,ee=Te):(V[ee]=He,V[Re]=X,ee=Re);else if(Te<oe&&0>r(Le,X))V[ee]=Le,V[Te]=X,ee=Te;else break e}}return J}function r(V,J){var X=V.sortIndex-J.sortIndex;return X!==0?X:V.id-J.id}if(t.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var s=performance;t.unstable_now=function(){return s.now()}}else{var a=Date,o=a.now();t.unstable_now=function(){return a.now()-o}}var c=[],l=[],u=1,h=null,f=3,d=!1,p=!1,g=!1,y=typeof setTimeout=="function"?setTimeout:null,v=typeof clearTimeout=="function"?clearTimeout:null,b=typeof setImmediate<"u"?setImmediate:null;function T(V){for(var J=n(l);J!==null;){if(J.callback===null)i(l);else if(J.startTime<=V)i(l),J.sortIndex=J.expirationTime,e(c,J);else break;J=n(l)}}function x(V){if(g=!1,T(V),!p)if(n(c)!==null)p=!0,Y();else{var J=n(l);J!==null&&ie(x,J.startTime-V)}}var M=!1,R=-1,I=5,k=-1;function P(){return!(t.unstable_now()-k<I)}function U(){if(M){var V=t.unstable_now();k=V;var J=!0;try{e:{p=!1,g&&(g=!1,v(R),R=-1),d=!0;var X=f;try{t:{for(T(V),h=n(c);h!==null&&!(h.expirationTime>V&&P());){var ee=h.callback;if(typeof ee=="function"){h.callback=null,f=h.priorityLevel;var oe=ee(h.expirationTime<=V);if(V=t.unstable_now(),typeof oe=="function"){h.callback=oe,T(V),J=!0;break t}h===n(c)&&i(c),T(V)}else i(c);h=n(c)}if(h!==null)J=!0;else{var fe=n(l);fe!==null&&ie(x,fe.startTime-V),J=!1}}break e}finally{h=null,f=X,d=!1}J=void 0}}finally{J?G():M=!1}}}var G;if(typeof b=="function")G=function(){b(U)};else if(typeof MessageChannel<"u"){var $=new MessageChannel,q=$.port2;$.port1.onmessage=U,G=function(){q.postMessage(null)}}else G=function(){y(U,0)};function Y(){M||(M=!0,G())}function ie(V,J){R=y(function(){V(t.unstable_now())},J)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(V){V.callback=null},t.unstable_continueExecution=function(){p||d||(p=!0,Y())},t.unstable_forceFrameRate=function(V){0>V||125<V?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):I=0<V?Math.floor(1e3/V):5},t.unstable_getCurrentPriorityLevel=function(){return f},t.unstable_getFirstCallbackNode=function(){return n(c)},t.unstable_next=function(V){switch(f){case 1:case 2:case 3:var J=3;break;default:J=f}var X=f;f=J;try{return V()}finally{f=X}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(V,J){switch(V){case 1:case 2:case 3:case 4:case 5:break;default:V=3}var X=f;f=V;try{return J()}finally{f=X}},t.unstable_scheduleCallback=function(V,J,X){var ee=t.unstable_now();switch(typeof X=="object"&&X!==null?(X=X.delay,X=typeof X=="number"&&0<X?ee+X:ee):X=ee,V){case 1:var oe=-1;break;case 2:oe=250;break;case 5:oe=1073741823;break;case 4:oe=1e4;break;default:oe=5e3}return oe=X+oe,V={id:u++,callback:J,priorityLevel:V,startTime:X,expirationTime:oe,sortIndex:-1},X>ee?(V.sortIndex=X,e(l,V),n(c)===null&&V===n(l)&&(g?(v(R),R=-1):g=!0,ie(x,X-ee))):(V.sortIndex=oe,e(c,V),p||d||(p=!0,Y())),V},t.unstable_shouldYield=P,t.unstable_wrapCallback=function(V){var J=f;return function(){var X=f;f=J;try{return V.apply(this,arguments)}finally{f=X}}}})(iue);nue.exports=iue;var CV=nue.exports;(function(t){t.exports=function(e){function n(m,_,C,D){return new Pu(m,_,C,D)}function i(){}function r(m){var _="https://react.dev/errors/"+m;if(1<arguments.length){_+="?args[]="+encodeURIComponent(arguments[1]);for(var C=2;C<arguments.length;C++)_+="&args[]="+encodeURIComponent(arguments[C])}return"Minified React error #"+m+"; visit "+_+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function s(m){return m===null||typeof m!="object"?null:(m=ao&&m[ao]||m["@@iterator"],typeof m=="function"?m:null)}function a(m){if(m==null)return null;if(typeof m=="function")return m.$$typeof===ZE?null:m.displayName||m.name||null;if(typeof m=="string")return m;switch(m){case wh:return"Fragment";case Fp:return"Portal";case Ch:return"Profiler";case el:return"StrictMode";case tv:return"Suspense";case Hp:return"SuspenseList"}if(typeof m=="object")switch(m.$$typeof){case Lu:return(m.displayName||"Context")+".Provider";case KE:return(m._context.displayName||"Context")+".Consumer";case $m:var _=m.render;return m=m.displayName,m||(m=_.displayName||_.name||"",m=m!==""?"ForwardRef("+m+")":"ForwardRef"),m;case nv:return _=m.displayName||null,_!==null?_:a(m.type)||"Memo";case Uu:_=m._payload,m=m._init;try{return a(m(_))}catch{}}return null}function o(m){if(Wm===void 0)try{throw Error()}catch(C){var _=C.stack.trim().match(/\n( *(at )?)/);Wm=_&&_[1]||"",sy=-1<C.stack.indexOf(`
    at`)?" (<anonymous>)":-1<C.stack.indexOf("@")?"@unknown:0:0":""}return`
`+Wm+m+sy}function c(m,_){if(!m||jp)return"";jp=!0;var C=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var D={DetermineComponentFrameRoot:function(){try{if(_){var xn=function(){throw Error()};if(Object.defineProperty(xn.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(xn,[])}catch(er){var An=er}Reflect.construct(m,[],xn)}else{try{xn.call()}catch(er){An=er}m.call(xn.prototype)}}else{try{throw Error()}catch(er){An=er}(xn=m())&&typeof xn.catch=="function"&&xn.catch(function(){})}}catch(er){if(er&&An&&typeof er.stack=="string")return[er.stack,An.stack]}return[null,null]}};D.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var z=Object.getOwnPropertyDescriptor(D.DetermineComponentFrameRoot,"name");z&&z.configurable&&Object.defineProperty(D.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var Z=D.DetermineComponentFrameRoot(),Se=Z[0],ze=Z[1];if(Se&&ze){var ut=Se.split(`
`),Dt=ze.split(`
`);for(z=D=0;D<ut.length&&!ut[D].includes("DetermineComponentFrameRoot");)D++;for(;z<Dt.length&&!Dt[z].includes("DetermineComponentFrameRoot");)z++;if(D===ut.length||z===Dt.length)for(D=ut.length-1,z=Dt.length-1;1<=D&&0<=z&&ut[D]!==Dt[z];)z--;for(;1<=D&&0<=z;D--,z--)if(ut[D]!==Dt[z]){if(D!==1||z!==1)do if(D--,z--,0>z||ut[D]!==Dt[z]){var en=`
`+ut[D].replace(" at new "," at ");return m.displayName&&en.includes("<anonymous>")&&(en=en.replace("<anonymous>",m.displayName)),en}while(1<=D&&0<=z);break}}}finally{jp=!1,Error.prepareStackTrace=C}return(C=m?m.displayName||m.name:"")?o(C):""}function l(m){switch(m.tag){case 26:case 27:case 5:return o(m.type);case 16:return o("Lazy");case 13:return o("Suspense");case 19:return o("SuspenseList");case 0:case 15:return m=c(m.type,!1),m;case 11:return m=c(m.type.render,!1),m;case 1:return m=c(m.type,!0),m;default:return""}}function u(m){try{var _="";do _+=l(m),m=m.return;while(m);return _}catch(C){return`
Error generating stack: `+C.message+`
`+C.stack}}function h(m){var _=m,C=m;if(m.alternate)for(;_.return;)_=_.return;else{m=_;do _=m,_.flags&4098&&(C=_.return),m=_.return;while(m)}return _.tag===3?C:null}function f(m){if(h(m)!==m)throw Error(r(188))}function d(m){var _=m.alternate;if(!_){if(_=h(m),_===null)throw Error(r(188));return _!==m?null:m}for(var C=m,D=_;;){var z=C.return;if(z===null)break;var Z=z.alternate;if(Z===null){if(D=z.return,D!==null){C=D;continue}break}if(z.child===Z.child){for(Z=z.child;Z;){if(Z===C)return f(z),m;if(Z===D)return f(z),_;Z=Z.sibling}throw Error(r(188))}if(C.return!==D.return)C=z,D=Z;else{for(var Se=!1,ze=z.child;ze;){if(ze===C){Se=!0,C=z,D=Z;break}if(ze===D){Se=!0,D=z,C=Z;break}ze=ze.sibling}if(!Se){for(ze=Z.child;ze;){if(ze===C){Se=!0,C=Z,D=z;break}if(ze===D){Se=!0,D=Z,C=z;break}ze=ze.sibling}if(!Se)throw Error(r(189))}}if(C.alternate!==D)throw Error(r(190))}if(C.tag!==3)throw Error(r(188));return C.stateNode.current===C?m:_}function p(m){var _=m.tag;if(_===5||_===26||_===27||_===6)return m;for(m=m.child;m!==null;){if(_=p(m),_!==null)return _;m=m.sibling}return null}function g(m){var _=m.tag;if(_===5||_===26||_===27||_===6)return m;for(m=m.child;m!==null;){if(m.tag!==4&&(_=g(m),_!==null))return _;m=m.sibling}return null}function y(m){return{current:m}}function v(m){0>Ad||(m.current=lo[Ad],lo[Ad]=null,Ad--)}function b(m,_){Ad++,lo[Ad]=m.current,m.current=_}function T(m){return m>>>=0,m===0?32:31-(lR(m)/my|0)|0}function x(m){var _=m&42;if(_!==0)return _;switch(m&-m){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return m&4194176;case 4194304:case 8388608:case 16777216:case 33554432:return m&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return m}}function M(m,_){var C=m.pendingLanes;if(C===0)return 0;var D=0,z=m.suspendedLanes,Z=m.pingedLanes,Se=m.warmLanes;m=m.finishedLanes!==0;var ze=C&134217727;return ze!==0?(C=ze&~z,C!==0?D=x(C):(Z&=ze,Z!==0?D=x(Z):m||(Se=ze&~Se,Se!==0&&(D=x(Se))))):(ze=C&~z,ze!==0?D=x(ze):Z!==0?D=x(Z):m||(Se=C&~Se,Se!==0&&(D=x(Se)))),D===0?0:_!==0&&_!==D&&!(_&z)&&(z=D&-D,Se=_&-_,z>=Se||z===32&&(Se&4194176)!==0)?_:D}function R(m,_){return(m.pendingLanes&~(m.suspendedLanes&~m.pingedLanes)&_)===0}function I(m,_){switch(m){case 1:case 2:case 4:case 8:return _+250;case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return _+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function k(){var m=dv;return dv<<=1,!(dv&4194176)&&(dv=128),m}function P(){var m=qa;return qa<<=1,!(qa&62914560)&&(qa=4194304),m}function U(m){for(var _=[],C=0;31>C;C++)_.push(m);return _}function G(m,_){m.pendingLanes|=_,_!==268435456&&(m.suspendedLanes=0,m.pingedLanes=0,m.warmLanes=0)}function $(m,_,C,D,z,Z){var Se=m.pendingLanes;m.pendingLanes=C,m.suspendedLanes=0,m.pingedLanes=0,m.warmLanes=0,m.expiredLanes&=C,m.entangledLanes&=C,m.errorRecoveryDisabledLanes&=C,m.shellSuspendCounter=0;var ze=m.entanglements,ut=m.expirationTimes,Dt=m.hiddenUpdates;for(C=Se&~C;0<C;){var en=31-tc(C),xn=1<<en;ze[en]=0,ut[en]=-1;var An=Dt[en];if(An!==null)for(Dt[en]=null,en=0;en<An.length;en++){var er=An[en];er!==null&&(er.lane&=-536870913)}C&=~xn}D!==0&&q(m,D,0),Z!==0&&z===0&&m.tag!==0&&(m.suspendedLanes|=Z&~(Se&~_))}function q(m,_,C){m.pendingLanes|=_,m.suspendedLanes&=~_;var D=31-tc(_);m.entangledLanes|=_,m.entanglements[D]=m.entanglements[D]|1073741824|C&4194218}function Y(m,_){var C=m.entangledLanes|=_;for(m=m.entanglements;C;){var D=31-tc(C),z=1<<D;z&_|m[D]&_&&(m[D]|=_),C&=~z}}function ie(m){return m&=-m,2<m?8<m?m&134217727?32:268435456:8:2}function V(m){if(S&&typeof S.onCommitFiberRoot=="function")try{S.onCommitFiberRoot(N,m,void 0,(m.current.flags&128)===128)}catch{}}function J(m){if(typeof sg=="function"&&pS(m),S&&typeof S.setStrictMode=="function")try{S.setStrictMode(N,m)}catch{}}function X(m,_){return m===_&&(m!==0||1/m===1/_)||m!==m&&_!==_}function ee(m,_){if(typeof m=="object"&&m!==null){var C=O.get(m);return C!==void 0?C:(_={value:m,source:_,stack:u(_)},O.set(m,_),_)}return{value:m,source:_,stack:u(_)}}function oe(m,_){L[B++]=te,L[B++]=H,H=m,te=_}function fe(m,_,C){re[K++]=he,re[K++]=pe,re[K++]=ae,ae=m;var D=he;m=pe;var z=32-tc(D)-1;D&=~(1<<z),C+=1;var Z=32-tc(_)+z;if(30<Z){var Se=z-z%5;Z=(D&(1<<Se)-1).toString(32),D>>=Se,z-=Se,he=1<<32-tc(_)+z|C<<z|D,pe=Z+m}else he=1<<Z|C<<z|D,pe=m}function Re(m){m.return!==null&&(oe(m,1),fe(m,1,0))}function He(m){for(;m===H;)H=L[--B],L[B]=null,te=L[--B],L[B]=null;for(;m===ae;)ae=re[--K],re[K]=null,pe=re[--K],re[K]=null,he=re[--K],re[K]=null}function Te(m,_){b(Ye,_),b(Je,m),b(Ne,null),m=Ym(_),v(Ne),b(Ne,m)}function Le(){v(Ne),v(Je),v(Ye)}function we(m){m.memoizedState!==null&&b(Oe,m);var _=Ne.current,C=tx(_,m.type);_!==C&&(b(Je,m),b(Ne,C))}function Ce(m){Je.current===m&&(v(Ne),v(Je)),Oe.current===m&&(v(Oe),Zl?Ml._currentValue=Cf:Ml._currentValue2=Cf)}function ke(m){var _=Error(r(418,""));throw tt(ee(_,m)),Kn}function St(m,_){if(!Al)throw Error(r(175));nR(m.stateNode,m.type,m.memoizedProps,_,m)||ke(m)}function Mt(m){for(ye=m.return;ye;)switch(ye.tag){case 3:case 27:It=!0;return;case 5:case 13:It=!1;return;default:ye=ye.return}}function Ee(m){if(!Al||m!==ye)return!1;if(!wt)return Mt(m),wt=!0,!1;var _=!1;if(Ra?m.tag!==3&&m.tag!==27&&(m.tag!==5||ux(m.type)&&!Xm(m.type,m.memoizedProps))&&(_=!0):m.tag!==3&&(m.tag!==5||ux(m.type)&&!Xm(m.type,m.memoizedProps))&&(_=!0),_&&lt&&ke(m),Mt(m),m.tag===13){if(!Al)throw Error(r(316));if(m=m.memoizedState,m=m!==null?m.dehydrated:null,!m)throw Error(r(317));lt=ng(m)}else lt=ye?Jo(m.stateNode):null;return!0}function _e(){Al&&(lt=ye=null,wt=!1)}function tt(m){Kt===null?Kt=[m]:Kt.push(m)}function de(){for(var m=_i,_=zi=_i=0;_<m;){var C=wn[_];wn[_++]=null;var D=wn[_];wn[_++]=null;var z=wn[_];wn[_++]=null;var Z=wn[_];if(wn[_++]=null,D!==null&&z!==null){var Se=D.pending;Se===null?z.next=z:(z.next=Se.next,Se.next=z),D.pending=z}Z!==0&&ft(C,z,Z)}}function Be(m,_,C,D){wn[_i++]=m,wn[_i++]=_,wn[_i++]=C,wn[_i++]=D,zi|=D,m.lanes|=D,m=m.alternate,m!==null&&(m.lanes|=D)}function Ie(m,_,C,D){return Be(m,_,C,D),gt(m)}function rt(m,_){return Be(m,null,null,_),gt(m)}function ft(m,_,C){m.lanes|=C;var D=m.alternate;D!==null&&(D.lanes|=C);for(var z=!1,Z=m.return;Z!==null;)Z.childLanes|=C,D=Z.alternate,D!==null&&(D.childLanes|=C),Z.tag===22&&(m=Z.stateNode,m===null||m._visibility&1||(z=!0)),m=Z,Z=Z.return;z&&_!==null&&m.tag===3&&(Z=m.stateNode,z=31-tc(C),Z=Z.hiddenUpdates,m=Z[z],m===null?Z[z]=[_]:m.push(_),_.lane=C|536870912)}function gt(m){if(50<hR)throw hR=0,I8=null,Error(r(185));for(var _=m.return;_!==null;)m=_,_=m.return;return m.tag===3?m.stateNode:null}function bt(m){m!==xi&&m.next===null&&(xi===null?ki=xi=m:xi=xi.next=m),Ri=!0,yi||(yi=!0,Ue(ue))}function be(m,_){if(!Di&&Ri){Di=!0;do for(var C=!1,D=ki;D!==null;){if(m!==0){var z=D.pendingLanes;if(z===0)var Z=0;else{var Se=D.suspendedLanes,ze=D.pingedLanes;Z=(1<<31-tc(42|m)+1)-1,Z&=z&~(Se&~ze),Z=Z&201326677?Z&201326677|1:Z?Z|2:0}Z!==0&&(C=!0,$e(D,Z))}else Z=In,Z=M(D,D===Mn?Z:0),!(Z&3)||R(D,Z)||(C=!0,$e(D,Z));D=D.next}while(C);Di=!1}}function ue(){Ri=yi=!1;var m=0;bi!==0&&(Rl()&&(m=bi),bi=0);for(var _=Zn(),C=null,D=ki;D!==null;){var z=D.next,Z=Xe(D,_);Z===0?(D.next=null,C===null?ki=z:C.next=z,z===null&&(xi=C)):(C=D,(m!==0||Z&3)&&(Ri=!0)),D=z}be(m)}function Xe(m,_){for(var C=m.suspendedLanes,D=m.pingedLanes,z=m.expirationTimes,Z=m.pendingLanes&-62914561;0<Z;){var Se=31-tc(Z),ze=1<<Se,ut=z[Se];ut===-1?(!(ze&C)||ze&D)&&(z[Se]=I(ze,_)):ut<=_&&(m.expiredLanes|=ze),Z&=~ze}if(_=Mn,C=In,C=M(m,m===_?C:0),D=m.callbackNode,C===0||m===_&&ln===2||m.cancelPendingCommit!==null)return D!==null&&D!==null&&Nh(D),m.callbackNode=null,m.callbackPriority=0;if(!(C&3)||R(m,C)){if(_=C&-C,_===m.callbackPriority)return _;switch(D!==null&&Nh(D),ie(C)){case 2:case 8:C=uo;break;case 32:C=Ds;break;case 268435456:C=Rd;break;default:C=Ds}return D=it.bind(null,m),C=ks(C,D),m.callbackPriority=_,m.callbackNode=C,_}return D!==null&&D!==null&&Nh(D),m.callbackPriority=2,m.callbackNode=null,2}function it(m,_){var C=m.callbackNode;if(Ec()&&m.callbackNode!==C)return null;var D=In;return D=M(m,m===Mn?D:0),D===0?null:(Iu(m,D,_),Xe(m,Zn()),m.callbackNode!=null&&m.callbackNode===C?it.bind(null,m):null)}function $e(m,_){if(Ec())return null;Iu(m,_,!0)}function Ue(m){cy?ti(function(){Gt&6?ks(fx,m):m()}):ks(fx,m)}function qt(){return bi===0&&(bi=k()),bi}function Ot(m,_){if(Mi===null){var C=Mi=[];ui=0,Tn=qt(),$n={status:"pending",value:void 0,then:function(D){C.push(D)}}}return ui++,_.then(Yt,Yt),_}function Yt(){if(--ui===0&&Mi!==null){$n!==null&&($n.status="fulfilled");var m=Mi;Mi=null,Tn=0,$n=null;for(var _=0;_<m.length;_++)(0,m[_])()}}function ce(m,_){var C=[],D={status:"pending",value:null,reason:null,then:function(z){C.push(z)}};return m.then(function(){D.status="fulfilled",D.value=_;for(var z=0;z<C.length;z++)(0,C[z])(_)},function(z){for(D.status="rejected",D.reason=z,z=0;z<C.length;z++)(0,C[z])(void 0)}),D}function j(m){m.updateQueue={baseState:m.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function W(m,_){m=m.updateQueue,_.updateQueue===m&&(_.updateQueue={baseState:m.baseState,firstBaseUpdate:m.firstBaseUpdate,lastBaseUpdate:m.lastBaseUpdate,shared:m.shared,callbacks:null})}function me(m){return{lane:m,tag:0,payload:null,callback:null,next:null}}function De(m,_,C){var D=m.updateQueue;if(D===null)return null;if(D=D.shared,Gt&2){var z=D.pending;return z===null?_.next=_:(_.next=z.next,z.next=_),D.pending=_,_=gt(m),ft(m,null,C),_}return Be(m,D,_,C),gt(m)}function Ve(m,_,C){if(_=_.updateQueue,_!==null&&(_=_.shared,(C&4194176)!==0)){var D=_.lanes;D&=m.pendingLanes,C|=D,_.lanes=C,Y(m,C)}}function mt(m,_){var C=m.updateQueue,D=m.alternate;if(D!==null&&(D=D.updateQueue,C===D)){var z=null,Z=null;if(C=C.firstBaseUpdate,C!==null){do{var Se={lane:C.lane,tag:C.tag,payload:C.payload,callback:null,next:null};Z===null?z=Z=Se:Z=Z.next=Se,C=C.next}while(C!==null);Z===null?z=Z=_:Z=Z.next=_}else z=Z=_;C={baseState:D.baseState,firstBaseUpdate:z,lastBaseUpdate:Z,shared:D.shared,callbacks:D.callbacks},m.updateQueue=C;return}m=C.lastBaseUpdate,m===null?C.firstBaseUpdate=_:m.next=_,C.lastBaseUpdate=_}function xt(){if(Jr){var m=$n;if(m!==null)throw m}}function Vn(m,_,C,D){Jr=!1;var z=m.updateQueue;$i=!1;var Z=z.firstBaseUpdate,Se=z.lastBaseUpdate,ze=z.shared.pending;if(ze!==null){z.shared.pending=null;var ut=ze,Dt=ut.next;ut.next=null,Se===null?Z=Dt:Se.next=Dt,Se=ut;var en=m.alternate;en!==null&&(en=en.updateQueue,ze=en.lastBaseUpdate,ze!==Se&&(ze===null?en.firstBaseUpdate=Dt:ze.next=Dt,en.lastBaseUpdate=ut))}if(Z!==null){var xn=z.baseState;Se=0,en=Dt=ut=null,ze=Z;do{var An=ze.lane&-536870913,er=An!==ze.lane;if(er?(In&An)===An:(D&An)===An){An!==0&&An===Tn&&(Jr=!0),en!==null&&(en=en.next={lane:0,tag:ze.tag,payload:ze.payload,callback:null,next:null});e:{var Id=m,fR=ze;An=_;var gS=C;switch(fR.tag){case 1:if(Id=fR.payload,typeof Id=="function"){xn=Id.call(gS,xn,An);break e}xn=Id;break e;case 3:Id.flags=Id.flags&-65537|128;case 0:if(Id=fR.payload,An=typeof Id=="function"?Id.call(gS,xn,An):Id,An==null)break e;xn=xh({},xn,An);break e;case 2:$i=!0}}An=ze.callback,An!==null&&(m.flags|=64,er&&(m.flags|=8192),er=z.callbacks,er===null?z.callbacks=[An]:er.push(An))}else er={lane:An,tag:ze.tag,payload:ze.payload,callback:ze.callback,next:null},en===null?(Dt=en=er,ut=xn):en=en.next=er,Se|=An;if(ze=ze.next,ze===null){if(ze=z.shared.pending,ze===null)break;er=ze,ze=er.next,er.next=null,z.lastBaseUpdate=er,z.shared.pending=null}}while(!0);en===null&&(ut=xn),z.baseState=ut,z.firstBaseUpdate=Dt,z.lastBaseUpdate=en,Z===null&&(z.shared.lanes=0),wc|=Se,m.lanes=Se,m.memoizedState=xn}}function qe(m,_){if(typeof m!="function")throw Error(r(191,m));m.call(_)}function Vt(m,_){var C=m.callbacks;if(C!==null)for(m.callbacks=null,m=0;m<C.length;m++)qe(C[m],_)}function ht(m,_){if(A(m,_))return!0;if(typeof m!="object"||m===null||typeof _!="object"||_===null)return!1;var C=Object.keys(m),D=Object.keys(_);if(C.length!==D.length)return!1;for(D=0;D<C.length;D++){var z=C[D];if(!Es.call(_,z)||!A(m[z],_[z]))return!1}return!0}function Pt(m){return m=m.status,m==="fulfilled"||m==="rejected"}function hn(){}function an(m,_,C){switch(C=m[C],C===void 0?m.push(_):C!==_&&(_.then(hn,hn),_=C),_.status){case"fulfilled":return _.value;case"rejected":throw m=_.reason,m===Qr?Error(r(483)):m;default:if(typeof _.status=="string")_.then(hn,hn);else{if(m=Mn,m!==null&&100<m.shellSuspendCounter)throw Error(r(482));m=_,m.status="pending",m.then(function(D){if(_.status==="pending"){var z=_;z.status="fulfilled",z.value=D}},function(D){if(_.status==="pending"){var z=_;z.status="rejected",z.reason=D}})}switch(_.status){case"fulfilled":return _.value;case"rejected":throw m=_.reason,m===Qr?Error(r(483)):m}throw Ir=_,Qr}}function Ge(){if(Ir===null)throw Error(r(459));var m=Ir;return Ir=null,m}function ot(m){var _=Wr;return Wr+=1,fr===null&&(fr=[]),an(fr,m,_)}function At(m,_){_=_.props.ref,m.ref=_!==void 0?_:null}function Nt(m,_){throw _.$$typeof===Bp?Error(r(525)):(m=Object.prototype.toString.call(_),Error(r(31,m==="[object Object]"?"object with keys {"+Object.keys(_).join(", ")+"}":m)))}function Yn(m){var _=m._init;return _(m._payload)}function sr(m){function _(Et,st){if(m){var Tt=Et.deletions;Tt===null?(Et.deletions=[st],Et.flags|=16):Tt.push(st)}}function C(Et,st){if(!m)return null;for(;st!==null;)_(Et,st),st=st.sibling;return null}function D(Et){for(var st=new Map;Et!==null;)Et.key!==null?st.set(Et.key,Et):st.set(Et.index,Et),Et=Et.sibling;return st}function z(Et,st){return Et=Th(Et,st),Et.index=0,Et.sibling=null,Et}function Z(Et,st,Tt){return Et.index=Tt,m?(Tt=Et.alternate,Tt!==null?(Tt=Tt.index,Tt<st?(Et.flags|=33554434,st):Tt):(Et.flags|=33554434,st)):(Et.flags|=1048576,st)}function Se(Et){return m&&Et.alternate===null&&(Et.flags|=33554434),Et}function ze(Et,st,Tt,Zt){return st===null||st.tag!==6?(st=Q0(Tt,Et.mode,Zt),st.return=Et,st):(st=z(st,Tt),st.return=Et,st)}function ut(Et,st,Tt,Zt){var hi=Tt.type;return hi===wh?en(Et,st,Tt.props.children,Zt,Tt.key):st!==null&&(st.elementType===hi||typeof hi=="object"&&hi!==null&&hi.$$typeof===Uu&&Yn(hi)===st.type)?(st=z(st,Tt.props),At(st,Tt),st.return=Et,st):(st=J0(Tt.type,Tt.key,Tt.props,null,Et.mode,Zt),At(st,Tt),st.return=Et,st)}function Dt(Et,st,Tt,Zt){return st===null||st.tag!==4||st.stateNode.containerInfo!==Tt.containerInfo||st.stateNode.implementation!==Tt.implementation?(st=iy(Tt,Et.mode,Zt),st.return=Et,st):(st=z(st,Tt.children||[]),st.return=Et,st)}function en(Et,st,Tt,Zt,hi){return st===null||st.tag!==7?(st=wd(Tt,Et.mode,Zt,hi),st.return=Et,st):(st=z(st,Tt),st.return=Et,st)}function xn(Et,st,Tt){if(typeof st=="string"&&st!==""||typeof st=="number"||typeof st=="bigint")return st=Q0(""+st,Et.mode,Tt),st.return=Et,st;if(typeof st=="object"&&st!==null){switch(st.$$typeof){case qm:return Tt=J0(st.type,st.key,st.props,null,Et.mode,Tt),At(Tt,st),Tt.return=Et,Tt;case Fp:return st=iy(st,Et.mode,Tt),st.return=Et,st;case Uu:var Zt=st._init;return st=Zt(st._payload),xn(Et,st,Tt)}if(wf(st)||s(st))return st=wd(st,Et.mode,Tt,null),st.return=Et,st;if(typeof st.then=="function")return xn(Et,ot(st),Tt);if(st.$$typeof===Lu)return xn(Et,Rr(Et,st),Tt);Nt(Et,st)}return null}function An(Et,st,Tt,Zt){var hi=st!==null?st.key:null;if(typeof Tt=="string"&&Tt!==""||typeof Tt=="number"||typeof Tt=="bigint")return hi!==null?null:ze(Et,st,""+Tt,Zt);if(typeof Tt=="object"&&Tt!==null){switch(Tt.$$typeof){case qm:return Tt.key===hi?ut(Et,st,Tt,Zt):null;case Fp:return Tt.key===hi?Dt(Et,st,Tt,Zt):null;case Uu:return hi=Tt._init,Tt=hi(Tt._payload),An(Et,st,Tt,Zt)}if(wf(Tt)||s(Tt))return hi!==null?null:en(Et,st,Tt,Zt,null);if(typeof Tt.then=="function")return An(Et,st,ot(Tt),Zt);if(Tt.$$typeof===Lu)return An(Et,st,Rr(Et,Tt),Zt);Nt(Et,Tt)}return null}function er(Et,st,Tt,Zt,hi){if(typeof Zt=="string"&&Zt!==""||typeof Zt=="number"||typeof Zt=="bigint")return Et=Et.get(Tt)||null,ze(st,Et,""+Zt,hi);if(typeof Zt=="object"&&Zt!==null){switch(Zt.$$typeof){case qm:return Et=Et.get(Zt.key===null?Tt:Zt.key)||null,ut(st,Et,Zt,hi);case Fp:return Et=Et.get(Zt.key===null?Tt:Zt.key)||null,Dt(st,Et,Zt,hi);case Uu:var va=Zt._init;return Zt=va(Zt._payload),er(Et,st,Tt,Zt,hi)}if(wf(Zt)||s(Zt))return Et=Et.get(Tt)||null,en(st,Et,Zt,hi,null);if(typeof Zt.then=="function")return er(Et,st,Tt,ot(Zt),hi);if(Zt.$$typeof===Lu)return er(Et,st,Tt,Rr(st,Zt),hi);Nt(st,Zt)}return null}function Id(Et,st,Tt,Zt){for(var hi=null,va=null,Hi=st,ns=st=0,il=null;Hi!==null&&ns<Tt.length;ns++){Hi.index>ns?(il=Hi,Hi=null):il=Hi.sibling;var is=An(Et,Hi,Tt[ns],Zt);if(is===null){Hi===null&&(Hi=il);break}m&&Hi&&is.alternate===null&&_(Et,Hi),st=Z(is,st,ns),va===null?hi=is:va.sibling=is,va=is,Hi=il}if(ns===Tt.length)return C(Et,Hi),wt&&oe(Et,ns),hi;if(Hi===null){for(;ns<Tt.length;ns++)Hi=xn(Et,Tt[ns],Zt),Hi!==null&&(st=Z(Hi,st,ns),va===null?hi=Hi:va.sibling=Hi,va=Hi);return wt&&oe(Et,ns),hi}for(Hi=D(Hi);ns<Tt.length;ns++)il=er(Hi,Et,ns,Tt[ns],Zt),il!==null&&(m&&il.alternate!==null&&Hi.delete(il.key===null?ns:il.key),st=Z(il,st,ns),va===null?hi=il:va.sibling=il,va=il);return m&&Hi.forEach(function(yy){return _(Et,yy)}),wt&&oe(Et,ns),hi}function fR(Et,st,Tt,Zt){if(Tt==null)throw Error(r(151));for(var hi=null,va=null,Hi=st,ns=st=0,il=null,is=Tt.next();Hi!==null&&!is.done;ns++,is=Tt.next()){Hi.index>ns?(il=Hi,Hi=null):il=Hi.sibling;var yy=An(Et,Hi,is.value,Zt);if(yy===null){Hi===null&&(Hi=il);break}m&&Hi&&yy.alternate===null&&_(Et,Hi),st=Z(yy,st,ns),va===null?hi=yy:va.sibling=yy,va=yy,Hi=il}if(is.done)return C(Et,Hi),wt&&oe(Et,ns),hi;if(Hi===null){for(;!is.done;ns++,is=Tt.next())is=xn(Et,is.value,Zt),is!==null&&(st=Z(is,st,ns),va===null?hi=is:va.sibling=is,va=is);return wt&&oe(Et,ns),hi}for(Hi=D(Hi);!is.done;ns++,is=Tt.next())is=er(Hi,Et,ns,is.value,Zt),is!==null&&(m&&is.alternate!==null&&Hi.delete(is.key===null?ns:is.key),st=Z(is,st,ns),va===null?hi=is:va.sibling=is,va=is);return m&&Hi.forEach(function(cxe){return _(Et,cxe)}),wt&&oe(Et,ns),hi}function gS(Et,st,Tt,Zt){if(typeof Tt=="object"&&Tt!==null&&Tt.type===wh&&Tt.key===null&&(Tt=Tt.props.children),typeof Tt=="object"&&Tt!==null){switch(Tt.$$typeof){case qm:e:{for(var hi=Tt.key;st!==null;){if(st.key===hi){if(hi=Tt.type,hi===wh){if(st.tag===7){C(Et,st.sibling),Zt=z(st,Tt.props.children),Zt.return=Et,Et=Zt;break e}}else if(st.elementType===hi||typeof hi=="object"&&hi!==null&&hi.$$typeof===Uu&&Yn(hi)===st.type){C(Et,st.sibling),Zt=z(st,Tt.props),At(Zt,Tt),Zt.return=Et,Et=Zt;break e}C(Et,st);break}else _(Et,st);st=st.sibling}Tt.type===wh?(Zt=wd(Tt.props.children,Et.mode,Zt,Tt.key),Zt.return=Et,Et=Zt):(Zt=J0(Tt.type,Tt.key,Tt.props,null,Et.mode,Zt),At(Zt,Tt),Zt.return=Et,Et=Zt)}return Se(Et);case Fp:e:{for(hi=Tt.key;st!==null;){if(st.key===hi)if(st.tag===4&&st.stateNode.containerInfo===Tt.containerInfo&&st.stateNode.implementation===Tt.implementation){C(Et,st.sibling),Zt=z(st,Tt.children||[]),Zt.return=Et,Et=Zt;break e}else{C(Et,st);break}else _(Et,st);st=st.sibling}Zt=iy(Tt,Et.mode,Zt),Zt.return=Et,Et=Zt}return Se(Et);case Uu:return hi=Tt._init,Tt=hi(Tt._payload),gS(Et,st,Tt,Zt)}if(wf(Tt))return Id(Et,st,Tt,Zt);if(s(Tt)){if(hi=s(Tt),typeof hi!="function")throw Error(r(150));return Tt=hi.call(Tt),fR(Et,st,Tt,Zt)}if(typeof Tt.then=="function")return gS(Et,st,ot(Tt),Zt);if(Tt.$$typeof===Lu)return gS(Et,st,Rr(Et,Tt),Zt);Nt(Et,Tt)}return typeof Tt=="string"&&Tt!==""||typeof Tt=="number"||typeof Tt=="bigint"?(Tt=""+Tt,st!==null&&st.tag===6?(C(Et,st.sibling),Zt=z(st,Tt),Zt.return=Et,Et=Zt):(C(Et,st),Zt=Q0(Tt,Et.mode,Zt),Zt.return=Et,Et=Zt),Se(Et)):C(Et,st)}return function(Et,st,Tt,Zt){try{Wr=0;var hi=gS(Et,st,Tt,Zt);return fr=null,hi}catch(Hi){if(Hi===Qr)throw Hi;var va=n(29,Hi,null,Et.mode);return va.lanes=Zt,va.return=Et,va}finally{}}}function Si(m,_){m=kr,b(ga,m),b(Qs,_),kr=m|_.baseLanes}function ai(){b(ga,kr),b(Qs,Qs.current)}function En(){kr=ga.current,v(Qs),v(ga)}function sn(m){var _=m.alternate;b(dr,dr.current&1),b(Ss,m),Ps===null&&(_===null||Qs.current!==null||_.memoizedState!==null)&&(Ps=m)}function Ln(m){if(m.tag===22){if(b(dr,dr.current),b(Ss,m),Ps===null){var _=m.alternate;_!==null&&_.memoizedState!==null&&(Ps=m)}}else Nn()}function Nn(){b(dr,dr.current),b(Ss,Ss.current)}function di(m){v(Ss),Ps===m&&(Ps=null),v(dr)}function hr(m){for(var _=m;_!==null;){if(_.tag===13){var C=_.memoizedState;if(C!==null&&(C=C.dehydrated,C===null||eg(C)||ma(C)))return _}else if(_.tag===19&&_.memoizedProps.revealOrder!==void 0){if(_.flags&128)return _}else if(_.child!==null){_.child.return=_,_=_.child;continue}if(_===m)break;for(;_.sibling===null;){if(_.return===null||_.return===m)return null;_=_.return}_.sibling.return=_.return,_=_.sibling}return null}function ei(){throw Error(r(321))}function Fa(m,_){if(_===null)return!1;for(var C=0;C<_.length&&C<m.length;C++)if(!A(m[C],_[C]))return!1;return!0}function xu(m,_,C,D,z,Z){return Ma=Z,Jn=_,_.memoizedState=null,_.updateQueue=null,_.lanes=0,vi.H=m===null||m.memoizedState===null?ho:ko,Tc=!1,Z=C(D,z),Tc=!1,Io&&(Z=Np(_,C,D,z)),fd(m),Z}function fd(m){vi.H=Oa;var _=Gi!==null&&Gi.next!==null;if(Ma=0,Mr=Gi=Jn=null,$a=!1,ms=0,nc=null,_)throw Error(r(300));m===null||$s||(m=m.dependencies,m!==null&&Au(m)&&($s=!0))}function Np(m,_,C,D){Jn=m;var z=0;do{if(Io&&(nc=null),ms=0,Io=!1,25<=z)throw Error(r(301));if(z+=1,Mr=Gi=null,m.updateQueue!=null){var Z=m.updateQueue;Z.lastEffect=null,Z.events=null,Z.stores=null,Z.memoCache!=null&&(Z.memoCache.index=0)}vi.H=ic,Z=_(C,D)}while(Io);return Z}function A0(){var m=vi.H,_=m.useState()[0];return _=typeof _.then=="function"?vt(_):_,m=m.useState()[0],(Gi!==null?Gi.memoizedState:null)!==m&&(Jn.flags|=1024),_}function dd(){var m=nl!==0;return nl=0,m}function pd(m,_,C){_.updateQueue=m.updateQueue,_.flags&=-2053,m.lanes&=~C}function wu(m){if($a){for(m=m.memoizedState;m!==null;){var _=m.queue;_!==null&&(_.pending=null),m=m.next}$a=!1}Ma=0,Mr=Gi=Jn=null,Io=!1,ms=nl=0,nc=null}function ve(){var m={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Mr===null?Jn.memoizedState=Mr=m:Mr=Mr.next=m,Mr}function Ke(){if(Gi===null){var m=Jn.alternate;m=m!==null?m.memoizedState:null}else m=Gi.next;var _=Mr===null?Jn.memoizedState:Mr.next;if(_!==null)Mr=_,Gi=m;else{if(m===null)throw Jn.alternate===null?Error(r(467)):Error(r(310));Gi=m,m={memoizedState:Gi.memoizedState,baseState:Gi.baseState,baseQueue:Gi.baseQueue,queue:Gi.queue,next:null},Mr===null?Jn.memoizedState=Mr=m:Mr=Mr.next=m}return Mr}function vt(m){var _=ms;return ms+=1,nc===null&&(nc=[]),m=an(nc,m,_),_=Jn,(Mr===null?_.memoizedState:Mr.next)===null&&(_=_.alternate,vi.H=_===null||_.memoizedState===null?ho:ko),m}function _t(m){if(m!==null&&typeof m=="object"){if(typeof m.then=="function")return vt(m);if(m.$$typeof===Lu)return za(m)}throw Error(r(438,String(m)))}function Qe(m){var _=null,C=Jn.updateQueue;if(C!==null&&(_=C.memoCache),_==null){var D=Jn.alternate;D!==null&&(D=D.updateQueue,D!==null&&(D=D.memoCache,D!=null&&(_={data:D.data.map(function(z){return z.slice()}),index:0})))}if(_==null&&(_={data:[],index:0}),C===null&&(C=Jl(),Jn.updateQueue=C),C.memoCache=_,C=_.data[_.index],C===void 0)for(C=_.data[_.index]=Array(m),D=0;D<m;D++)C[D]=QA;return _.index++,C}function Ht(m,_){return typeof _=="function"?_(m):_}function nn(m){var _=Ke();return mn(_,Gi,m)}function mn(m,_,C){var D=m.queue;if(D===null)throw Error(r(311));D.lastRenderedReducer=C;var z=m.baseQueue,Z=D.pending;if(Z!==null){if(z!==null){var Se=z.next;z.next=Z.next,Z.next=Se}_.baseQueue=z=Z,D.pending=null}if(Z=m.baseState,z===null)m.memoizedState=Z;else{_=z.next;var ze=Se=null,ut=null,Dt=_,en=!1;do{var xn=Dt.lane&-536870913;if(xn!==Dt.lane?(In&xn)===xn:(Ma&xn)===xn){var An=Dt.revertLane;if(An===0)ut!==null&&(ut=ut.next={lane:0,revertLane:0,action:Dt.action,hasEagerState:Dt.hasEagerState,eagerState:Dt.eagerState,next:null}),xn===Tn&&(en=!0);else if((Ma&An)===An){Dt=Dt.next,An===Tn&&(en=!0);continue}else xn={lane:0,revertLane:Dt.revertLane,action:Dt.action,hasEagerState:Dt.hasEagerState,eagerState:Dt.eagerState,next:null},ut===null?(ze=ut=xn,Se=Z):ut=ut.next=xn,Jn.lanes|=An,wc|=An;xn=Dt.action,Tc&&C(Z,xn),Z=Dt.hasEagerState?Dt.eagerState:C(Z,xn)}else An={lane:xn,revertLane:Dt.revertLane,action:Dt.action,hasEagerState:Dt.hasEagerState,eagerState:Dt.eagerState,next:null},ut===null?(ze=ut=An,Se=Z):ut=ut.next=An,Jn.lanes|=xn,wc|=xn;Dt=Dt.next}while(Dt!==null&&Dt!==_);if(ut===null?Se=Z:ut.next=ze,!A(Z,m.memoizedState)&&($s=!0,en&&(C=$n,C!==null)))throw C;m.memoizedState=Z,m.baseState=Se,m.baseQueue=ut,D.lastRenderedState=Z}return z===null&&(D.lanes=0),[m.memoizedState,D.dispatch]}function Sn(m){var _=Ke(),C=_.queue;if(C===null)throw Error(r(311));C.lastRenderedReducer=m;var D=C.dispatch,z=C.pending,Z=_.memoizedState;if(z!==null){C.pending=null;var Se=z=z.next;do Z=m(Z,Se.action),Se=Se.next;while(Se!==z);A(Z,_.memoizedState)||($s=!0),_.memoizedState=Z,_.baseQueue===null&&(_.baseState=Z),C.lastRenderedState=Z}return[Z,D]}function oi(m,_,C){var D=Jn,z=Ke(),Z=wt;if(Z){if(C===void 0)throw Error(r(407));C=C()}else C=_();var Se=!A((Gi||z).memoizedState,C);if(Se&&(z.memoizedState=C,$s=!0),z=z.queue,R0(gi.bind(null,D,z,m),[m]),z.getSnapshot!==_||Se||Mr!==null&&Mr.memoizedState.tag&1){if(D.flags|=2048,xl(9,Cn.bind(null,D,z,C,_),{destroy:void 0},null),Mn===null)throw Error(r(349));Z||Ma&60||ci(D,_,C)}return C}function ci(m,_,C){m.flags|=16384,m={getSnapshot:_,value:C},_=Jn.updateQueue,_===null?(_=Jl(),Jn.updateQueue=_,_.stores=[m]):(C=_.stores,C===null?_.stores=[m]:C.push(m))}function Cn(m,_,C,D){_.value=C,_.getSnapshot=D,ar(_)&&Os(m)}function gi(m,_,C){return C(function(){ar(_)&&Os(m)})}function ar(m){var _=m.getSnapshot;m=m.value;try{var C=_();return!A(m,C)}catch{return!0}}function Os(m){var _=rt(m,2);_!==null&&Xo(_,m,2)}function bs(m){var _=ve();if(typeof m=="function"){var C=m;if(m=C(),Tc){J(!0);try{C()}finally{J(!1)}}}return _.memoizedState=_.baseState=m,_.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ht,lastRenderedState:m},_}function Ki(m,_,C,D){return m.baseState=C,mn(m,Gi,typeof D=="function"?D:Ht)}function Xn(m,_,C,D,z){if(Y_(m))throw Error(r(485));if(m=_.action,m!==null){var Z={payload:z,action:m,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(Se){Z.listeners.push(Se)}};vi.T!==null?C(!0):Z.isTransition=!1,D(Z),C=_.pending,C===null?(Z.next=_.pending=Z,Ti(_,Z)):(Z.next=C.next,_.pending=C.next=Z)}}function Ti(m,_){var C=_.action,D=_.payload,z=m.state;if(_.isTransition){var Z=vi.T,Se={};vi.T=Se;try{var ze=C(z,D),ut=vi.S;ut!==null&&ut(Se,ze),Bn(m,_,ze)}catch(Dt){$l(m,_,Dt)}finally{vi.T=Z}}else try{Z=C(z,D),Bn(m,_,Z)}catch(Dt){$l(m,_,Dt)}}function Bn(m,_,C){C!==null&&typeof C=="object"&&typeof C.then=="function"?C.then(function(D){qo(m,_,D)},function(D){return $l(m,_,D)}):qo(m,_,C)}function qo(m,_,C){_.status="fulfilled",_.value=C,no(_),m.state=C,_=m.pending,_!==null&&(C=_.next,C===_?m.pending=null:(C=C.next,_.next=C,Ti(m,C)))}function $l(m,_,C){var D=m.pending;if(m.pending=null,D!==null){D=D.next;do _.status="rejected",_.reason=C,no(_),_=_.next;while(_!==D)}m.action=null}function no(m){m=m.listeners;for(var _=0;_<m.length;_++)(0,m[_])()}function mh(m,_){return _}function ls(m,_){if(wt){var C=Mn.formState;if(C!==null){e:{var D=Jn;if(wt){if(lt){var z=tg(lt,It);if(z){lt=Jo(z),D=fy(z);break e}}ke(D)}D=!1}D&&(_=C[0])}}C=ve(),C.memoizedState=C.baseState=_,D={pending:null,lanes:0,dispatch:null,lastRenderedReducer:mh,lastRenderedState:_},C.queue=D,C=PE.bind(null,Jn,D),D.dispatch=C,D=bs(!1);var Z=gd.bind(null,Jn,!1,D.queue);return D=ve(),z={state:_,dispatch:null,action:m,pending:null},D.queue=z,C=Xn.bind(null,Jn,z,Z,C),z.dispatch=C,D.memoizedState=m,[_,C,!1]}function bn(m){var _=Ke();return io(_,Gi,m)}function io(m,_,C){_=mn(m,_,mh)[0],m=nn(Ht)[0],_=typeof _=="object"&&_!==null&&typeof _.then=="function"?vt(_):_;var D=Ke(),z=D.queue,Z=z.dispatch;return C!==D.memoizedState&&(Jn.flags|=2048,xl(9,Vs.bind(null,z,C),{destroy:void 0},null)),[_,Z,m]}function Vs(m,_){m.action=_}function qn(m){var _=Ke(),C=Gi;if(C!==null)return io(_,C,m);Ke(),_=_.memoizedState,C=Ke();var D=C.queue.dispatch;return C.memoizedState=m,[_,D,!1]}function xl(m,_,C,D){return m={tag:m,create:_,inst:C,deps:D,next:null},_=Jn.updateQueue,_===null&&(_=Jl(),Jn.updateQueue=_),C=_.lastEffect,C===null?_.lastEffect=m.next=m:(D=C.next,C.next=m,m.next=D,_.lastEffect=m),m}function la(){return Ke().memoizedState}function Ip(m,_,C,D){var z=ve();Jn.flags|=m,z.memoizedState=xl(1|_,C,{destroy:void 0},D===void 0?null:D)}function mf(m,_,C,D){var z=Ke();D=D===void 0?null:D;var Z=z.memoizedState.inst;Gi!==null&&D!==null&&Fa(D,Gi.memoizedState.deps)?z.memoizedState=xl(_,C,Z,D):(Jn.flags|=m,z.memoizedState=xl(1|_,C,Z,D))}function gh(m,_){Ip(8390656,8,m,_)}function R0(m,_){mf(2048,8,m,_)}function q_(m,_){return mf(4,2,m,_)}function M0(m,_){return mf(4,4,m,_)}function $o(m,_){if(typeof _=="function"){m=m();var C=_(m);return function(){typeof C=="function"?C():_(null)}}if(_!=null)return m=m(),_.current=m,function(){_.current=null}}function O0(m,_,C){C=C!=null?C.concat([m]):null,mf(4,4,$o.bind(null,_,m),C)}function Wo(){}function G1(m,_){var C=Ke();_=_===void 0?null:_;var D=C.memoizedState;return _!==null&&Fa(_,D[1])?D[0]:(C.memoizedState=[m,_],m)}function kE(m,_){var C=Ke();_=_===void 0?null:_;var D=C.memoizedState;if(_!==null&&Fa(_,D[1]))return D[0];if(D=m(),Tc){J(!0);try{m()}finally{J(!1)}}return C.memoizedState=[D,_],D}function Cu(m,_,C){return C===void 0||Ma&1073741824?m.memoizedState=_:(m.memoizedState=C,m=jE(),Jn.lanes|=m,wc|=m,C)}function Nm(m,_,C,D){return A(C,_)?C:Qs.current!==null?(m=Cu(m,C,D),A(m,_)||($s=!0),m):Ma&42?(m=jE(),Jn.lanes|=m,wc|=m,_):($s=!0,m.memoizedState=C)}function gf(m,_,C,D,z){var Z=oo();Ko(Z!==0&&8>Z?Z:8);var Se=vi.T,ze={};vi.T=ze,gd(m,!1,_,C);try{var ut=z(),Dt=vi.S;if(Dt!==null&&Dt(ze,ut),ut!==null&&typeof ut=="object"&&typeof ut.then=="function"){var en=ce(ut,D);md(m,_,en,Ro(m))}else md(m,_,D,Ro(m))}catch(xn){md(m,_,{then:function(){},status:"rejected",reason:xn},Ro())}finally{Ko(Z),vi.T=Se}}function xs(m){var _=m.memoizedState;if(_!==null)return _;_={memoizedState:Cf,baseState:Cf,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ht,lastRenderedState:Cf},next:null};var C={};return _.next={memoizedState:C,baseState:C,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ht,lastRenderedState:C},next:null},m.memoizedState=_,m=m.alternate,m!==null&&(m.memoizedState=_),_}function vh(){return za(Ml)}function $_(){return Ke().memoizedState}function DE(){return Ke().memoizedState}function W_(m){for(var _=m.return;_!==null;){switch(_.tag){case 24:case 3:var C=Ro();m=me(C);var D=De(_,m,C);D!==null&&(Xo(D,_,C),Ve(D,_,C)),_={cache:K_()},m.payload=_;return}_=_.return}}function q1(m,_,C){var D=Ro();C={lane:D,revertLane:0,action:C,hasEagerState:!1,eagerState:null,next:null},Y_(m)?LE(_,C):(C=Ie(m,_,C,D),C!==null&&(Xo(C,m,D),UE(C,_,D)))}function PE(m,_,C){var D=Ro();md(m,_,C,D)}function md(m,_,C,D){var z={lane:D,revertLane:0,action:C,hasEagerState:!1,eagerState:null,next:null};if(Y_(m))LE(_,z);else{var Z=m.alternate;if(m.lanes===0&&(Z===null||Z.lanes===0)&&(Z=_.lastRenderedReducer,Z!==null))try{var Se=_.lastRenderedState,ze=Z(Se,C);if(z.hasEagerState=!0,z.eagerState=ze,A(ze,Se))return Be(m,_,z,0),Mn===null&&de(),!1}catch{}finally{}if(C=Ie(m,_,z,D),C!==null)return Xo(C,m,D),UE(C,_,D),!0}return!1}function gd(m,_,C,D){if(D={lane:2,revertLane:qt(),action:D,hasEagerState:!1,eagerState:null,next:null},Y_(m)){if(_)throw Error(r(479))}else _=Ie(m,C,D,2),_!==null&&Xo(_,m,2)}function Y_(m){var _=m.alternate;return m===Jn||_!==null&&_===Jn}function LE(m,_){Io=$a=!0;var C=m.pending;C===null?_.next=_:(_.next=C.next,C.next=_),m.pending=_}function UE(m,_,C){if(C&4194176){var D=_.lanes;D&=m.pendingLanes,C|=D,_.lanes=C,Y(m,C)}}function N0(m,_,C,D){_=m.memoizedState,C=C(D,_),C=C==null?_:xh({},_,C),m.memoizedState=C,m.lanes===0&&(m.updateQueue.baseState=C)}function X_(m,_,C,D,z,Z,Se){return m=m.stateNode,typeof m.shouldComponentUpdate=="function"?m.shouldComponentUpdate(D,Z,Se):_.prototype&&_.prototype.isPureReactComponent?!ht(C,D)||!ht(z,Z):!0}function BE(m,_,C,D){m=_.state,typeof _.componentWillReceiveProps=="function"&&_.componentWillReceiveProps(C,D),typeof _.UNSAFE_componentWillReceiveProps=="function"&&_.UNSAFE_componentWillReceiveProps(C,D),_.state!==m&&Md.enqueueReplaceState(_,_.state,null)}function _h(m,_){var C=_;if("ref"in _){C={};for(var D in _)D!=="ref"&&(C[D]=_[D])}if(m=m.defaultProps){C===_&&(C=xh({},C));for(var z in m)C[z]===void 0&&(C[z]=m[z])}return C}function Im(m,_){try{var C=m.onUncaughtError;C(_.value,{componentStack:_.stack})}catch(D){setTimeout(function(){throw D})}}function FE(m,_,C){try{var D=m.onCaughtError;D(C.value,{componentStack:C.stack,errorBoundary:_.tag===1?_.stateNode:null})}catch(z){setTimeout(function(){throw z})}}function pc(m,_,C){return C=me(C),C.tag=3,C.payload={element:null},C.callback=function(){Im(m,_)},C}function Ns(m){return m=me(m),m.tag=3,m}function vf(m,_,C,D){var z=C.type.getDerivedStateFromError;if(typeof z=="function"){var Z=D.value;m.payload=function(){return z(Z)},m.callback=function(){FE(_,C,D)}}var Se=C.stateNode;Se!==null&&typeof Se.componentDidCatch=="function"&&(m.callback=function(){FE(_,C,D),typeof z!="function"&&(If===null?If=new Set([this]):If.add(this));var ze=D.stack;this.componentDidCatch(D.value,{componentStack:ze!==null?ze:""})})}function $1(m,_,C,D,z){if(C.flags|=32768,D!==null&&typeof D=="object"&&typeof D.then=="function"){if(_=C.alternate,_!==null&&D0(_,C,z,!0),C=Ss.current,C!==null){switch(C.tag){case 13:return Ps===null?Ha():C.alternate===null&&pr===0&&(pr=3),C.flags&=-257,C.flags|=65536,C.lanes=z,D===es?C.flags|=16384:(_=C.updateQueue,_===null?C.updateQueue=new Set([D]):_.add(D),X0(m,D,z)),!1;case 22:return C.flags|=65536,D===es?C.flags|=16384:(_=C.updateQueue,_===null?(_={transitions:null,markerInstances:null,retryQueue:new Set([D])},C.updateQueue=_):(C=_.retryQueue,C===null?_.retryQueue=new Set([D]):C.add(D)),X0(m,D,z)),!1}throw Error(r(435,C.tag))}return X0(m,D,z),Ha(),!1}if(wt)return _=Ss.current,_!==null?(!(_.flags&65536)&&(_.flags|=256),_.flags|=65536,_.lanes=z,D!==Kn&&(m=Error(r(422),{cause:D}),tt(ee(m,C)))):(D!==Kn&&(_=Error(r(423),{cause:D}),tt(ee(_,C))),m=m.current.alternate,m.flags|=65536,z&=-z,m.lanes|=z,D=ee(D,C),z=pc(m.stateNode,D,z),mt(m,z),pr!==4&&(pr=2)),!1;var Z=Error(r(520),{cause:D});if(Z=ee(Z,C),Of===null?Of=[Z]:Of.push(Z),pr!==4&&(pr=2),_===null)return!0;D=ee(D,C),C=_;do{switch(C.tag){case 3:return C.flags|=65536,m=z&-z,C.lanes|=m,m=pc(C.stateNode,D,m),mt(C,m),!1;case 1:if(_=C.type,Z=C.stateNode,(C.flags&128)===0&&(typeof _.getDerivedStateFromError=="function"||Z!==null&&typeof Z.componentDidCatch=="function"&&(If===null||!If.has(Z))))return C.flags|=65536,z&=-z,C.lanes|=z,z=Ns(z),vf(z,m,C,D),mt(C,z),!1}C=C.return}while(C!==null);return!1}function ua(m,_,C,D){_.child=m===null?ps(_,null,C,D):ts(_,m.child,C,D)}function W1(m,_,C,D,z){C=C.render;var Z=_.ref;if("ref"in D){var Se={};for(var ze in D)ze!=="ref"&&(Se[ze]=D[ze])}else Se=D;return Zc(_),D=xu(m,_,C,Se,Z,z),ze=dd(),m!==null&&!$s?(pd(m,_,z),ji(m,_,z)):(wt&&ze&&Re(_),_.flags|=1,ua(m,_,D,z),_.child)}function I0(m,_,C,D,z){if(m===null){var Z=C.type;return typeof Z=="function"&&!K0(Z)&&Z.defaultProps===void 0&&C.compare===null?(_.tag=15,_.type=Z,Y1(m,_,Z,D,z)):(m=J0(C.type,null,D,_,_.mode,z),m.ref=_.ref,m.return=_,_.child=m)}if(Z=m.child,!ha(m,z)){var Se=Z.memoizedProps;if(C=C.compare,C=C!==null?C:ht,C(Se,D)&&m.ref===_.ref)return ji(m,_,z)}return _.flags|=1,m=Th(Z,D),m.ref=_.ref,m.return=_,_.child=m}function Y1(m,_,C,D,z){if(m!==null){var Z=m.memoizedProps;if(ht(Z,D)&&m.ref===_.ref)if($s=!1,_.pendingProps=D=Z,ha(m,z))m.flags&131072&&($s=!0);else return _.lanes=m.lanes,ji(m,_,z)}return mc(m,_,C,D,z)}function vd(m,_,C){var D=_.pendingProps,z=D.children,Z=(_.stateNode._pendingVisibility&2)!==0,Se=m!==null?m.memoizedState:null;if(ro(m,_),D.mode==="hidden"||Z){if(_.flags&128){if(D=Se!==null?Se.baseLanes|C:C,m!==null){for(z=_.child=m.child,Z=0;z!==null;)Z=Z|z.lanes|z.childLanes,z=z.sibling;_.childLanes=Z&~D}else _.childLanes=0,_.child=null;return km(m,_,D,C)}if(C&536870912)_.memoizedState={baseLanes:0,cachePool:null},m!==null&&Z_(_,Se!==null?Se.cachePool:null),Se!==null?Si(_,Se):ai(),Ln(_);else return _.lanes=_.childLanes=536870912,km(m,_,Se!==null?Se.baseLanes|C:C,C)}else Se!==null?(Z_(_,Se.cachePool),Si(_,Se),Nn(),_.memoizedState=null):(m!==null&&Z_(_,null),ai(),Nn());return ua(m,_,z,C),_.child}function km(m,_,C,D){var z=yd();return z=z===null?null:{parent:Zl?Yr._currentValue:Yr._currentValue2,pool:z},_.memoizedState={baseLanes:C,cachePool:z},m!==null&&Z_(_,null),ai(),Ln(_),m!==null&&D0(m,_,D,!0),null}function ro(m,_){var C=_.ref;if(C===null)m!==null&&m.ref!==null&&(_.flags|=2097664);else{if(typeof C!="function"&&typeof C!="object")throw Error(r(284));(m===null||m.ref!==C)&&(_.flags|=2097664)}}function mc(m,_,C,D,z){return Zc(_),C=xu(m,_,C,D,void 0,z),D=dd(),m!==null&&!$s?(pd(m,_,z),ji(m,_,z)):(wt&&D&&Re(_),_.flags|=1,ua(m,_,C,z),_.child)}function Dm(m,_,C,D,z,Z){return Zc(_),_.updateQueue=null,C=Np(_,D,C,z),fd(m),D=dd(),m!==null&&!$s?(pd(m,_,Z),ji(m,_,Z)):(wt&&D&&Re(_),_.flags|=1,ua(m,_,C,Z),_.child)}function X1(m,_,C,D,z){if(Zc(_),_.stateNode===null){var Z=ec,Se=C.contextType;typeof Se=="object"&&Se!==null&&(Z=za(Se)),Z=new C(D,Z),_.memoizedState=Z.state!==null&&Z.state!==void 0?Z.state:null,Z.updater=Md,_.stateNode=Z,Z._reactInternals=_,Z=_.stateNode,Z.props=D,Z.state=_.memoizedState,Z.refs={},j(_),Se=C.contextType,Z.context=typeof Se=="object"&&Se!==null?za(Se):ec,Z.state=_.memoizedState,Se=C.getDerivedStateFromProps,typeof Se=="function"&&(N0(_,C,Se,D),Z.state=_.memoizedState),typeof C.getDerivedStateFromProps=="function"||typeof Z.getSnapshotBeforeUpdate=="function"||typeof Z.UNSAFE_componentWillMount!="function"&&typeof Z.componentWillMount!="function"||(Se=Z.state,typeof Z.componentWillMount=="function"&&Z.componentWillMount(),typeof Z.UNSAFE_componentWillMount=="function"&&Z.UNSAFE_componentWillMount(),Se!==Z.state&&Md.enqueueReplaceState(Z,Z.state,null),Vn(_,D,Z,z),xt(),Z.state=_.memoizedState),typeof Z.componentDidMount=="function"&&(_.flags|=4194308),D=!0}else if(m===null){Z=_.stateNode;var ze=_.memoizedProps,ut=_h(C,ze);Z.props=ut;var Dt=Z.context,en=C.contextType;Se=ec,typeof en=="object"&&en!==null&&(Se=za(en));var xn=C.getDerivedStateFromProps;en=typeof xn=="function"||typeof Z.getSnapshotBeforeUpdate=="function",ze=_.pendingProps!==ze,en||typeof Z.UNSAFE_componentWillReceiveProps!="function"&&typeof Z.componentWillReceiveProps!="function"||(ze||Dt!==Se)&&BE(_,Z,D,Se),$i=!1;var An=_.memoizedState;Z.state=An,Vn(_,D,Z,z),xt(),Dt=_.memoizedState,ze||An!==Dt||$i?(typeof xn=="function"&&(N0(_,C,xn,D),Dt=_.memoizedState),(ut=$i||X_(_,C,ut,D,An,Dt,Se))?(en||typeof Z.UNSAFE_componentWillMount!="function"&&typeof Z.componentWillMount!="function"||(typeof Z.componentWillMount=="function"&&Z.componentWillMount(),typeof Z.UNSAFE_componentWillMount=="function"&&Z.UNSAFE_componentWillMount()),typeof Z.componentDidMount=="function"&&(_.flags|=4194308)):(typeof Z.componentDidMount=="function"&&(_.flags|=4194308),_.memoizedProps=D,_.memoizedState=Dt),Z.props=D,Z.state=Dt,Z.context=Se,D=ut):(typeof Z.componentDidMount=="function"&&(_.flags|=4194308),D=!1)}else{Z=_.stateNode,W(m,_),Se=_.memoizedProps,en=_h(C,Se),Z.props=en,xn=_.pendingProps,An=Z.context,Dt=C.contextType,ut=ec,typeof Dt=="object"&&Dt!==null&&(ut=za(Dt)),ze=C.getDerivedStateFromProps,(Dt=typeof ze=="function"||typeof Z.getSnapshotBeforeUpdate=="function")||typeof Z.UNSAFE_componentWillReceiveProps!="function"&&typeof Z.componentWillReceiveProps!="function"||(Se!==xn||An!==ut)&&BE(_,Z,D,ut),$i=!1,An=_.memoizedState,Z.state=An,Vn(_,D,Z,z),xt();var er=_.memoizedState;Se!==xn||An!==er||$i||m!==null&&m.dependencies!==null&&Au(m.dependencies)?(typeof ze=="function"&&(N0(_,C,ze,D),er=_.memoizedState),(en=$i||X_(_,C,en,D,An,er,ut)||m!==null&&m.dependencies!==null&&Au(m.dependencies))?(Dt||typeof Z.UNSAFE_componentWillUpdate!="function"&&typeof Z.componentWillUpdate!="function"||(typeof Z.componentWillUpdate=="function"&&Z.componentWillUpdate(D,er,ut),typeof Z.UNSAFE_componentWillUpdate=="function"&&Z.UNSAFE_componentWillUpdate(D,er,ut)),typeof Z.componentDidUpdate=="function"&&(_.flags|=4),typeof Z.getSnapshotBeforeUpdate=="function"&&(_.flags|=1024)):(typeof Z.componentDidUpdate!="function"||Se===m.memoizedProps&&An===m.memoizedState||(_.flags|=4),typeof Z.getSnapshotBeforeUpdate!="function"||Se===m.memoizedProps&&An===m.memoizedState||(_.flags|=1024),_.memoizedProps=D,_.memoizedState=er),Z.props=D,Z.state=er,Z.context=ut,D=en):(typeof Z.componentDidUpdate!="function"||Se===m.memoizedProps&&An===m.memoizedState||(_.flags|=4),typeof Z.getSnapshotBeforeUpdate!="function"||Se===m.memoizedProps&&An===m.memoizedState||(_.flags|=1024),D=!1)}return Z=D,ro(m,_),D=(_.flags&128)!==0,Z||D?(Z=_.stateNode,C=D&&typeof C.getDerivedStateFromError!="function"?null:Z.render(),_.flags|=1,m!==null&&D?(_.child=ts(_,m.child,null,z),_.child=ts(_,null,C,z)):ua(m,_,C,z),_.memoizedState=Z.state,m=_.child):m=ji(m,_,z),m}function wa(m,_,C,D){return _e(),_.flags|=256,ua(m,_,C,D),_.child}function Zs(m){return{baseLanes:m,cachePool:K1()}}function k0(m,_,C){return m=m!==null?m.childLanes&~C:0,_&&(m|=eu),m}function _f(m,_,C){var D=_.pendingProps,z=!1,Z=(_.flags&128)!==0,Se;if((Se=Z)||(Se=m!==null&&m.memoizedState===null?!1:(dr.current&2)!==0),Se&&(z=!0,_.flags&=-129),Se=(_.flags&32)!==0,_.flags&=-33,m===null){if(wt){if(z?sn(_):Nn(),wt){var ze=lt,ut;(ut=ze)&&(ze=Er(ze,It),ze!==null?(_.memoizedState={dehydrated:ze,treeContext:ae!==null?{id:he,overflow:pe}:null,retryLane:536870912},ut=n(18,null,null,0),ut.stateNode=ze,ut.return=_,_.child=ut,ye=_,lt=null,ut=!0):ut=!1),ut||ke(_)}if(ze=_.memoizedState,ze!==null&&(ze=ze.dehydrated,ze!==null))return ma(ze)?_.lanes=16:_.lanes=536870912,null;di(_)}return ze=D.children,D=D.fallback,z?(Nn(),z=_.mode,ze=dt({mode:"hidden",children:ze},z),D=wd(D,z,C,null),ze.return=_,D.return=_,ze.sibling=D,_.child=ze,z=_.child,z.memoizedState=Zs(C),z.childLanes=k0(m,Se,C),_.memoizedState=Mf,D):(sn(_),kp(_,ze))}if(ut=m.memoizedState,ut!==null&&(ze=ut.dehydrated,ze!==null)){if(Z)_.flags&256?(sn(_),_.flags&=-257,_=at(m,_,C)):_.memoizedState!==null?(Nn(),_.child=m.child,_.flags|=128,_=null):(Nn(),z=D.fallback,ze=_.mode,D=dt({mode:"visible",children:D.children},ze),z=wd(z,ze,C,null),z.flags|=2,D.return=_,z.return=_,D.sibling=z,_.child=D,ts(_,m.child,null,C),D=_.child,D.memoizedState=Zs(C),D.childLanes=k0(m,Se,C),_.memoizedState=Mf,_=z);else if(sn(_),ma(ze))Se=Rh(ze).digest,D=Error(r(419)),D.stack="",D.digest=Se,tt({value:D,source:null,stack:null}),_=at(m,_,C);else if($s||D0(m,_,C,!1),Se=(C&m.childLanes)!==0,$s||Se){if(Se=Mn,Se!==null){if(D=C&-C,D&42)D=1;else switch(D){case 2:D=1;break;case 8:D=4;break;case 32:D=16;break;case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:D=64;break;case 268435456:D=134217728;break;default:D=0}if(D=D&(Se.suspendedLanes|C)?0:D,D!==0&&D!==ut.retryLane)throw ut.retryLane=D,rt(m,D),Xo(Se,m,D),Wp}eg(ze)||Ha(),_=at(m,_,C)}else eg(ze)?(_.flags|=128,_.child=m.child,_=WE.bind(null,m),cx(ze,_),_=null):(m=ut.treeContext,Al&&(lt=oS(ze),ye=_,wt=!0,Kt=null,It=!1,m!==null&&(re[K++]=he,re[K++]=pe,re[K++]=ae,he=m.id,pe=m.overflow,ae=_)),_=kp(_,D.children),_.flags|=4096);return _}return z?(Nn(),z=D.fallback,ze=_.mode,ut=m.child,Z=ut.sibling,D=Th(ut,{mode:"hidden",children:D.children}),D.subtreeFlags=ut.subtreeFlags&31457280,Z!==null?z=Th(Z,z):(z=wd(z,ze,C,null),z.flags|=2),z.return=_,D.return=_,D.sibling=z,_.child=D,D=z,z=_.child,ze=m.child.memoizedState,ze===null?ze=Zs(C):(ut=ze.cachePool,ut!==null?(Z=Zl?Yr._currentValue:Yr._currentValue2,ut=ut.parent!==Z?{parent:Z,pool:Z}:ut):ut=K1(),ze={baseLanes:ze.baseLanes|C,cachePool:ut}),z.memoizedState=ze,z.childLanes=k0(m,Se,C),_.memoizedState=Mf,D):(sn(_),C=m.child,m=C.sibling,C=Th(C,{mode:"visible",children:D.children}),C.return=_,C.sibling=null,m!==null&&(Se=_.deletions,Se===null?(_.deletions=[m],_.flags|=16):Se.push(m)),_.child=C,_.memoizedState=null,C)}function kp(m,_){return _=dt({mode:"visible",children:_},m.mode),_.return=m,m.child=_}function dt(m,_){return YE(m,_,0,null)}function at(m,_,C){return ts(_,m.child,null,C),m=kp(_,_.pendingProps.children),m.flags|=2,_.memoizedState=null,m}function Ft(m,_,C){m.lanes|=_;var D=m.alternate;D!==null&&(D.lanes|=_),Kc(m.return,_,C)}function dn(m,_,C,D,z){var Z=m.memoizedState;Z===null?m.memoizedState={isBackwards:_,rendering:null,renderingStartTime:0,last:D,tail:C,tailMode:z}:(Z.isBackwards=_,Z.rendering=null,Z.renderingStartTime=0,Z.last=D,Z.tail=C,Z.tailMode=z)}function Xt(m,_,C){var D=_.pendingProps,z=D.revealOrder,Z=D.tail;if(ua(m,_,D.children,C),D=dr.current,D&2)D=D&1|2,_.flags|=128;else{if(m!==null&&m.flags&128)e:for(m=_.child;m!==null;){if(m.tag===13)m.memoizedState!==null&&Ft(m,C,_);else if(m.tag===19)Ft(m,C,_);else if(m.child!==null){m.child.return=m,m=m.child;continue}if(m===_)break e;for(;m.sibling===null;){if(m.return===null||m.return===_)break e;m=m.return}m.sibling.return=m.return,m=m.sibling}D&=1}switch(b(dr,D),z){case"forwards":for(C=_.child,z=null;C!==null;)m=C.alternate,m!==null&&hr(m)===null&&(z=C),C=C.sibling;C=z,C===null?(z=_.child,_.child=null):(z=C.sibling,C.sibling=null),dn(_,!1,z,C,Z);break;case"backwards":for(C=null,z=_.child,_.child=null;z!==null;){if(m=z.alternate,m!==null&&hr(m)===null){_.child=z;break}m=z.sibling,z.sibling=C,C=z,z=m}dn(_,!0,C,null,Z);break;case"together":dn(_,!1,null,null,void 0);break;default:_.memoizedState=null}return _.child}function ji(m,_,C){if(m!==null&&(_.dependencies=m.dependencies),wc|=_.lanes,!(C&_.childLanes))if(m!==null){if(D0(m,_,C,!1),(C&_.childLanes)===0)return null}else return null;if(m!==null&&_.child!==m.child)throw Error(r(153));if(_.child!==null){for(m=_.child,C=Th(m,m.pendingProps),_.child=C,C.return=_;m.sibling!==null;)m=m.sibling,C=C.sibling=Th(m,m.pendingProps),C.return=_;C.sibling=null}return _.child}function ha(m,_){return m.lanes&_?!0:(m=m.dependencies,!!(m!==null&&Au(m)))}function yh(m,_,C){switch(_.tag){case 3:Te(_,_.stateNode.containerInfo),Wl(_,Yr,m.memoizedState.cache),_e();break;case 27:case 5:we(_);break;case 4:Te(_,_.stateNode.containerInfo);break;case 10:Wl(_,_.type,_.memoizedProps.value);break;case 13:var D=_.memoizedState;if(D!==null)return D.dehydrated!==null?(sn(_),_.flags|=128,null):C&_.child.childLanes?_f(m,_,C):(sn(_),m=ji(m,_,C),m!==null?m.sibling:null);sn(_);break;case 19:var z=(m.flags&128)!==0;if(D=(C&_.childLanes)!==0,D||(D0(m,_,C,!1),D=(C&_.childLanes)!==0),z){if(D)return Xt(m,_,C);_.flags|=128}if(z=_.memoizedState,z!==null&&(z.rendering=null,z.tail=null,z.lastEffect=null),b(dr,dr.current),D)break;return null;case 22:case 23:return _.lanes=0,vd(m,_,C);case 24:Wl(_,Yr,m.memoizedState.cache)}return ji(m,_,C)}function Zi(m,_,C){if(m!==null)if(m.memoizedProps!==_.pendingProps)$s=!0;else{if(!ha(m,C)&&!(_.flags&128))return $s=!1,yh(m,_,C);$s=!!(m.flags&131072)}else $s=!1,wt&&_.flags&1048576&&fe(_,te,_.index);switch(_.lanes=0,_.tag){case 16:e:{m=_.pendingProps;var D=_.elementType,z=D._init;if(D=z(D._payload),_.type=D,typeof D=="function")K0(D)?(m=_h(D,m),_.tag=1,_=X1(null,_,D,m,C)):(_.tag=0,_=mc(null,_,D,m,C));else{if(D!=null){if(z=D.$$typeof,z===$m){_.tag=11,_=W1(null,_,D,m,C);break e}else if(z===nv){_.tag=14,_=I0(null,_,D,m,C);break e}}throw _=a(D)||D,Error(r(306,_,""))}}return _;case 0:return mc(m,_,_.type,_.pendingProps,C);case 1:return D=_.type,z=_h(D,_.pendingProps),X1(m,_,D,z,C);case 3:e:{if(Te(_,_.stateNode.containerInfo),m===null)throw Error(r(387));var Z=_.pendingProps;z=_.memoizedState,D=z.element,W(m,_),Vn(_,Z,null,C);var Se=_.memoizedState;if(Z=Se.cache,Wl(_,Yr,Z),Z!==z.cache&&Pm(_,[Yr],C,!0),xt(),Z=Se.element,Al&&z.isDehydrated)if(z={element:Z,isDehydrated:!1,cache:Se.cache},_.updateQueue.baseState=z,_.memoizedState=z,_.flags&256){_=wa(m,_,Z,C);break e}else if(Z!==D){D=ee(Error(r(424)),_),tt(D),_=wa(m,_,Z,C);break e}else for(Al&&(lt=No(_.stateNode.containerInfo),ye=_,wt=!0,Kt=null,It=!0),C=ps(_,null,Z,C),_.child=C;C;)C.flags=C.flags&-3|4096,C=C.sibling;else{if(_e(),Z===D){_=ji(m,_,C);break e}ua(m,_,Z,C)}_=_.child}return _;case 26:if(co)return ro(m,_),m===null?(C=Oh(_.type,null,_.pendingProps,null))?_.memoizedState=C:wt||(_.stateNode=oR(_.type,_.pendingProps,Ye.current,_)):_.memoizedState=Oh(_.type,m.memoizedProps,_.pendingProps,m.memoizedState),null;case 27:if(Ra)return we(_),m===null&&Ra&&wt&&(D=_.stateNode=rg(_.type,_.pendingProps,Ye.current,Ne.current,!1),ye=_,It=!0,lt=Oo(D)),D=_.pendingProps.children,m!==null||wt?ua(m,_,D,C):_.child=ts(_,null,D,C),ro(m,_),_.child;case 5:return m===null&&wt&&(Vu(_.type,_.pendingProps,Ne.current),(z=D=lt)&&(D=lx(D,_.type,_.pendingProps,It),D!==null?(_.stateNode=D,ye=_,lt=Oo(D),It=!1,z=!0):z=!1),z||ke(_)),we(_),z=_.type,Z=_.pendingProps,Se=m!==null?m.memoizedProps:null,D=Z.children,Xm(z,Z)?D=null:Se!==null&&Xm(z,Se)&&(_.flags|=32),_.memoizedState!==null&&(z=xu(m,_,A0,null,null,C),Zl?Ml._currentValue=z:Ml._currentValue2=z),ro(m,_),ua(m,_,D,C),_.child;case 6:return m===null&&wt&&(Gu(_.pendingProps,Ne.current),(m=C=lt)&&(C=Af(C,_.pendingProps,It),C!==null?(_.stateNode=C,ye=_,lt=null,m=!0):m=!1),m||ke(_)),null;case 13:return _f(m,_,C);case 4:return Te(_,_.stateNode.containerInfo),D=_.pendingProps,m===null?_.child=ts(_,null,D,C):ua(m,_,D,C),_.child;case 11:return W1(m,_,_.type,_.pendingProps,C);case 7:return ua(m,_,_.pendingProps,C),_.child;case 8:return ua(m,_,_.pendingProps.children,C),_.child;case 12:return ua(m,_,_.pendingProps.children,C),_.child;case 10:return D=_.pendingProps,Wl(_,_.type,D.value),ua(m,_,D.children,C),_.child;case 9:return z=_.type._context,D=_.pendingProps.children,Zc(_),z=za(z),D=D(z),_.flags|=1,ua(m,_,D,C),_.child;case 14:return I0(m,_,_.type,_.pendingProps,C);case 15:return Y1(m,_,_.type,_.pendingProps,C);case 19:return Xt(m,_,C);case 22:return vd(m,_,C);case 24:return Zc(_),D=za(Yr),m===null?(z=yd(),z===null&&(z=Mn,Z=K_(),z.pooledCache=Z,Z.refCount++,Z!==null&&(z.pooledCacheLanes|=C),z=Z),_.memoizedState={parent:D,cache:z},j(_),Wl(_,Yr,z)):(m.lanes&C&&(W(m,_),Vn(_,null,null,C),xt()),z=m.memoizedState,Z=_.memoizedState,z.parent!==D?(z={parent:D,cache:D},_.memoizedState=z,_.lanes===0&&(_.memoizedState=_.updateQueue.baseState=z),Wl(_,Yr,D)):(D=Z.cache,Wl(_,Yr,D),D!==z.cache&&Pm(_,[Yr],C,!0))),ua(m,_,_.pendingProps.children,C),_.child;case 29:throw _.pendingProps}throw Error(r(156,_.tag))}function Wl(m,_,C){Zl?(b(kh,_._currentValue),_._currentValue=C):(b(kh,_._currentValue2),_._currentValue2=C)}function bh(m){var _=kh.current;Zl?m._currentValue=_:m._currentValue2=_,v(kh)}function Kc(m,_,C){for(;m!==null;){var D=m.alternate;if((m.childLanes&_)!==_?(m.childLanes|=_,D!==null&&(D.childLanes|=_)):D!==null&&(D.childLanes&_)!==_&&(D.childLanes|=_),m===C)break;m=m.return}}function Pm(m,_,C,D){var z=m.child;for(z!==null&&(z.return=m);z!==null;){var Z=z.dependencies;if(Z!==null){var Se=z.child;Z=Z.firstContext;e:for(;Z!==null;){var ze=Z;Z=z;for(var ut=0;ut<_.length;ut++)if(ze.context===_[ut]){Z.lanes|=C,ze=Z.alternate,ze!==null&&(ze.lanes|=C),Kc(Z.return,C,m),D||(Se=null);break e}Z=ze.next}}else if(z.tag===18){if(Se=z.return,Se===null)throw Error(r(341));Se.lanes|=C,Z=Se.alternate,Z!==null&&(Z.lanes|=C),Kc(Se,C,m),Se=null}else Se=z.child;if(Se!==null)Se.return=z;else for(Se=z;Se!==null;){if(Se===m){Se=null;break}if(z=Se.sibling,z!==null){z.return=Se.return,Se=z;break}Se=Se.return}z=Se}}function D0(m,_,C,D){m=null;for(var z=_,Z=!1;z!==null;){if(!Z){if(z.flags&524288)Z=!0;else if(z.flags&262144)break}if(z.tag===10){var Se=z.alternate;if(Se===null)throw Error(r(387));if(Se=Se.memoizedProps,Se!==null){var ze=z.type;A(z.pendingProps.value,Se.value)||(m!==null?m.push(ze):m=[ze])}}else if(z===Oe.current){if(Se=z.alternate,Se===null)throw Error(r(387));Se.memoizedState.memoizedState!==z.memoizedState.memoizedState&&(m!==null?m.push(Ml):m=[Ml])}z=z.return}m!==null&&Pm(_,m,C,D),_.flags|=262144}function Au(m){for(m=m.firstContext;m!==null;){var _=m.context;if(!A(Zl?_._currentValue:_._currentValue2,m.memoizedValue))return!0;m=m.next}return!1}function Zc(m){qu=m,Nl=null,m=m.dependencies,m!==null&&(m.firstContext=null)}function za(m){return P0(qu,m)}function Rr(m,_){return qu===null&&Zc(m),P0(m,_)}function P0(m,_){var C=Zl?_._currentValue:_._currentValue2;if(_={context:_,memoizedValue:C,next:null},Nl===null){if(m===null)throw Error(r(308));Nl=_,m.dependencies={lanes:0,firstContext:_},m.flags|=524288}else Nl=Nl.next=_;return C}function K_(){return{controller:new pv,data:new Map,refCount:0}}function _d(m){m.refCount--,m.refCount===0&&gy(mv,function(){m.controller.abort()})}function yd(){var m=Dh.current;return m!==null?m:Mn.pooledCache}function Z_(m,_){_===null?b(Dh,Dh.current):b(Dh,_.pool)}function K1(){var m=yd();return m===null?null:{parent:Zl?Yr._currentValue:Yr._currentValue2,pool:m}}function Yo(m){m.flags|=4}function yf(m,_){if(m!==null&&m.child===_.child)return!1;if(_.flags&16)return!0;for(m=_.child;m!==null;){if(m.flags&13878||m.subtreeFlags&13878)return!0;m=m.sibling}return!1}function Eh(m,_,C,D){if(Mo)for(C=_.child;C!==null;){if(C.tag===5||C.tag===6)Gp(m,C.stateNode);else if(!(C.tag===4||Ra&&C.tag===27)&&C.child!==null){C.child.return=C,C=C.child;continue}if(C===_)break;for(;C.sibling===null;){if(C.return===null||C.return===_)return;C=C.return}C.sibling.return=C.return,C=C.sibling}else if(Fu)for(var z=_.child;z!==null;){if(z.tag===5){var Z=z.stateNode;C&&D&&(Z=Qm(Z,z.type,z.memoizedProps)),Gp(m,Z)}else if(z.tag===6)Z=z.stateNode,C&&D&&(Z=Ga(Z,z.memoizedProps)),Gp(m,Z);else if(z.tag!==4){if(z.tag===22&&z.memoizedState!==null)Z=z.child,Z!==null&&(Z.return=z),Eh(m,z,!0,!0);else if(z.child!==null){z.child.return=z,z=z.child;continue}}if(z===_)break;for(;z.sibling===null;){if(z.return===null||z.return===_)return;z=z.return}z.sibling.return=z.return,z=z.sibling}}function zE(m,_,C,D){if(Fu)for(var z=_.child;z!==null;){if(z.tag===5){var Z=z.stateNode;C&&D&&(Z=Qm(Z,z.type,z.memoizedProps)),ju(m,Z)}else if(z.tag===6)Z=z.stateNode,C&&D&&(Z=Ga(Z,z.memoizedProps)),ju(m,Z);else if(z.tag!==4){if(z.tag===22&&z.memoizedState!==null)Z=z.child,Z!==null&&(Z.return=z),zE(m,z,!(z.memoizedProps!==null&&z.memoizedProps.mode==="manual"),!0);else if(z.child!==null){z.child.return=z,z=z.child;continue}}if(z===_)break;for(;z.sibling===null;){if(z.return===null||z.return===_)return;z=z.return}z.sibling.return=z.return,z=z.sibling}}function Lm(m,_){if(Fu&&yf(m,_)){m=_.stateNode;var C=m.containerInfo,D=hy();zE(D,_,!1,!1),m.pendingChildren=D,Yo(_),$p(C,D)}}function Um(m,_,C,D){if(Mo)m.memoizedProps!==D&&Yo(_);else if(Fu){var z=m.stateNode,Z=m.memoizedProps;if((m=yf(m,_))||Z!==D){var Se=Ne.current;Z=uv(z,C,Z,D,!m,null),Z===z?_.stateNode=z:(JE(Z,C,D,Se)&&Yo(_),_.stateNode=Z,m?Eh(Z,_,!1,!1):Yo(_))}else _.stateNode=z}}function L0(m,_,C){if(QE(_,C)){if(m.flags|=16777216,!Hu(_,C))if(VE())m.flags|=8192;else throw Ir=es,ds}else m.flags&=-16777217}function bd(m,_){if(dy(_)){if(m.flags|=16777216,!uS(_))if(VE())m.flags|=8192;else throw Ir=es,ds}else m.flags&=-16777217}function U0(m,_){_!==null&&(m.flags|=4),m.flags&16384&&(_=m.tag!==22?P():536870912,m.lanes|=_,Yp|=_)}function Ru(m,_){if(!wt)switch(m.tailMode){case"hidden":_=m.tail;for(var C=null;_!==null;)_.alternate!==null&&(C=_),_=_.sibling;C===null?m.tail=null:C.sibling=null;break;case"collapsed":C=m.tail;for(var D=null;C!==null;)C.alternate!==null&&(D=C),C=C.sibling;D===null?_||m.tail===null?m.tail=null:m.tail.sibling=null:D.sibling=null}}function Hr(m){var _=m.alternate!==null&&m.alternate.child===m.child,C=0,D=0;if(_)for(var z=m.child;z!==null;)C|=z.lanes|z.childLanes,D|=z.subtreeFlags&31457280,D|=z.flags&31457280,z.return=m,z=z.sibling;else for(z=m.child;z!==null;)C|=z.lanes|z.childLanes,D|=z.subtreeFlags,D|=z.flags,z.return=m,z=z.sibling;return m.subtreeFlags|=D,m.childLanes=C,_}function B0(m,_,C){var D=_.pendingProps;switch(He(_),_.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Hr(_),null;case 1:return Hr(_),null;case 3:return C=_.stateNode,D=null,m!==null&&(D=m.memoizedState.cache),_.memoizedState.cache!==D&&(_.flags|=2048),bh(Yr),Le(),C.pendingContext&&(C.context=C.pendingContext,C.pendingContext=null),(m===null||m.child===null)&&(Ee(_)?Yo(_):m===null||m.memoizedState.isDehydrated&&!(_.flags&256)||(_.flags|=1024,Kt!==null&&(q0(Kt),Kt=null))),Lm(m,_),Hr(_),null;case 26:if(co){C=_.type;var z=_.memoizedState;return m===null?(Yo(_),z!==null?(Hr(_),bd(_,z)):(Hr(_),L0(_,C,D))):z?z!==m.memoizedState?(Yo(_),Hr(_),bd(_,z)):(Hr(_),_.flags&=-16777217):(Mo?m.memoizedProps!==D&&Yo(_):Um(m,_,C,D),Hr(_),L0(_,C,D)),null}case 27:if(Ra){if(Ce(_),C=Ye.current,z=_.type,m!==null&&_.stateNode!=null)Mo?m.memoizedProps!==D&&Yo(_):Um(m,_,z,D);else{if(!D){if(_.stateNode===null)throw Error(r(166));return Hr(_),null}m=Ne.current,Ee(_)?St(_,m):(m=rg(z,D,C,m,!0),_.stateNode=m,Yo(_))}return Hr(_),null}case 5:if(Ce(_),C=_.type,m!==null&&_.stateNode!=null)Um(m,_,C,D);else{if(!D){if(_.stateNode===null)throw Error(r(166));return Hr(_),null}m=Ne.current,Ee(_)?St(_,m):(z=Vp(C,D,Ye.current,m,_),Eh(z,_,!1,!1),_.stateNode=z,JE(z,C,D,m)&&Yo(_))}return Hr(_),L0(_,_.type,_.pendingProps),null;case 6:if(m&&_.stateNode!=null)C=m.memoizedProps,Mo?C!==D&&Yo(_):Fu&&(C!==D?(_.stateNode=rv(D,Ye.current,Ne.current,_),Yo(_)):_.stateNode=m.stateNode);else{if(typeof D!="string"&&_.stateNode===null)throw Error(r(166));if(m=Ye.current,C=Ne.current,Ee(_)){if(!Al)throw Error(r(176));if(m=_.stateNode,C=_.memoizedProps,D=null,z=ye,z!==null)switch(z.tag){case 27:case 5:D=z.memoizedProps}iR(m,C,_,D)||ke(_)}else _.stateNode=rv(D,m,C,_)}return Hr(_),null;case 13:if(D=_.memoizedState,m===null||m.memoizedState!==null&&m.memoizedState.dehydrated!==null){if(z=Ee(_),D!==null&&D.dehydrated!==null){if(m===null){if(!z)throw Error(r(318));if(!Al)throw Error(r(344));if(z=_.memoizedState,z=z!==null?z.dehydrated:null,!z)throw Error(r(317));rR(z,_)}else _e(),!(_.flags&128)&&(_.memoizedState=null),_.flags|=4;Hr(_),z=!1}else Kt!==null&&(q0(Kt),Kt=null),z=!0;if(!z)return _.flags&256?(di(_),_):(di(_),null)}if(di(_),_.flags&128)return _.lanes=C,_;if(C=D!==null,m=m!==null&&m.memoizedState!==null,C){D=_.child,z=null,D.alternate!==null&&D.alternate.memoizedState!==null&&D.alternate.memoizedState.cachePool!==null&&(z=D.alternate.memoizedState.cachePool.pool);var Z=null;D.memoizedState!==null&&D.memoizedState.cachePool!==null&&(Z=D.memoizedState.cachePool.pool),Z!==z&&(D.flags|=2048)}return C!==m&&C&&(_.child.flags|=8192),U0(_,_.updateQueue),Hr(_),null;case 4:return Le(),Lm(m,_),m===null&&eR(_.stateNode.containerInfo),Hr(_),null;case 10:return bh(_.type),Hr(_),null;case 19:if(v(dr),z=_.memoizedState,z===null)return Hr(_),null;if(D=(_.flags&128)!==0,Z=z.rendering,Z===null)if(D)Ru(z,!1);else{if(pr!==0||m!==null&&m.flags&128)for(m=_.child;m!==null;){if(Z=hr(m),Z!==null){for(_.flags|=128,Ru(z,!1),m=Z.updateQueue,_.updateQueue=m,U0(_,m),_.subtreeFlags=0,m=C,C=_.child;C!==null;)Z0(C,m),C=C.sibling;return b(dr,dr.current&1|2),_.child}m=m.sibling}z.tail!==null&&Zn()>vv&&(_.flags|=128,D=!0,Ru(z,!1),_.lanes=4194304)}else{if(!D)if(m=hr(Z),m!==null){if(_.flags|=128,D=!0,m=m.updateQueue,_.updateQueue=m,U0(_,m),Ru(z,!0),z.tail===null&&z.tailMode==="hidden"&&!Z.alternate&&!wt)return Hr(_),null}else 2*Zn()-z.renderingStartTime>vv&&C!==536870912&&(_.flags|=128,D=!0,Ru(z,!1),_.lanes=4194304);z.isBackwards?(Z.sibling=_.child,_.child=Z):(m=z.last,m!==null?m.sibling=Z:_.child=Z,z.last=Z)}return z.tail!==null?(_=z.tail,z.rendering=_,z.tail=_.sibling,z.renderingStartTime=Zn(),_.sibling=null,m=dr.current,b(dr,D?m&1|2:m&1),_):(Hr(_),null);case 22:case 23:return di(_),En(),D=_.memoizedState!==null,m!==null?m.memoizedState!==null!==D&&(_.flags|=8192):D&&(_.flags|=8192),D?C&536870912&&!(_.flags&128)&&(Hr(_),_.subtreeFlags&6&&(_.flags|=8192)):Hr(_),C=_.updateQueue,C!==null&&U0(_,C.retryQueue),C=null,m!==null&&m.memoizedState!==null&&m.memoizedState.cachePool!==null&&(C=m.memoizedState.cachePool.pool),D=null,_.memoizedState!==null&&_.memoizedState.cachePool!==null&&(D=_.memoizedState.cachePool.pool),D!==C&&(_.flags|=2048),m!==null&&v(Dh),null;case 24:return C=null,m!==null&&(C=m.memoizedState.cache),_.memoizedState.cache!==C&&(_.flags|=2048),bh(Yr),Hr(_),null;case 25:return null}throw Error(r(156,_.tag))}function fn(m,_){switch(He(_),_.tag){case 1:return m=_.flags,m&65536?(_.flags=m&-65537|128,_):null;case 3:return bh(Yr),Le(),m=_.flags,m&65536&&!(m&128)?(_.flags=m&-65537|128,_):null;case 26:case 27:case 5:return Ce(_),null;case 13:if(di(_),m=_.memoizedState,m!==null&&m.dehydrated!==null){if(_.alternate===null)throw Error(r(340));_e()}return m=_.flags,m&65536?(_.flags=m&-65537|128,_):null;case 19:return v(dr),null;case 4:return Le(),null;case 10:return bh(_.type),null;case 22:case 23:return di(_),En(),m!==null&&v(Dh),m=_.flags,m&65536?(_.flags=m&-65537|128,_):null;case 24:return bh(Yr),null;case 25:return null;default:return null}}function fa(m,_){switch(He(_),_.tag){case 3:bh(Yr),Le();break;case 26:case 27:case 5:Ce(_);break;case 4:Le();break;case 13:di(_);break;case 19:v(dr);break;case 10:bh(_.type);break;case 22:case 23:di(_),En(),m!==null&&v(Dh);break;case 24:bh(Yr)}}function F0(m,_){try{var C=_.updateQueue,D=C!==null?C.lastEffect:null;if(D!==null){var z=D.next;C=z;do{if((C.tag&m)===m){D=void 0;var Z=C.create,Se=C.inst;D=Z(),Se.destroy=D}C=C.next}while(C!==z)}}catch(ze){or(_,_.return,ze)}}function Mu(m,_,C){try{var D=_.updateQueue,z=D!==null?D.lastEffect:null;if(z!==null){var Z=z.next;D=Z;do{if((D.tag&m)===m){var Se=D.inst,ze=Se.destroy;if(ze!==void 0){Se.destroy=void 0,z=_;var ut=C;try{ze()}catch(Dt){or(z,ut,Dt)}}}D=D.next}while(D!==Z)}}catch(Dt){or(_,_.return,Dt)}}function Jc(m){var _=m.updateQueue;if(_!==null){var C=m.stateNode;try{Vt(_,C)}catch(D){or(m,m.return,D)}}}function z0(m,_,C){C.props=_h(m.type,m.memoizedProps),C.state=m.memoizedState;try{C.componentWillUnmount()}catch(D){or(m,_,D)}}function Dp(m,_){try{var C=m.ref;if(C!==null){var D=m.stateNode;switch(m.tag){case 26:case 27:case 5:var z=Cd(D);break;default:z=D}typeof C=="function"?m.refCleanup=C(z):C.current=z}}catch(Z){or(m,_,Z)}}function Ca(m,_){var C=m.ref,D=m.refCleanup;if(C!==null)if(typeof D=="function")try{D()}catch(z){or(m,_,z)}finally{m.refCleanup=null,m=m.alternate,m!=null&&(m.refCleanup=null)}else if(typeof C=="function")try{C(null)}catch(z){or(m,_,z)}else C.current=null}function HE(m){var _=m.type,C=m.memoizedProps,D=m.stateNode;try{tR(D,_,C,m)}catch(z){or(m,m.return,z)}}function gc(m,_,C){try{cv(m.stateNode,m.type,C,_,m)}catch(D){or(m,m.return,D)}}function ws(m){return m.tag===5||m.tag===3||(co?m.tag===26:!1)||(Ra?m.tag===27:!1)||m.tag===4}function Js(m){e:for(;;){for(;m.sibling===null;){if(m.return===null||ws(m.return))return null;m=m.return}for(m.sibling.return=m.return,m=m.sibling;m.tag!==5&&m.tag!==6&&(!Ra||m.tag!==27)&&m.tag!==18;){if(m.flags&2||m.child===null||m.tag===4)continue e;m.child.return=m,m=m.child}if(!(m.flags&2))return m.stateNode}}function Ii(m,_,C){var D=m.tag;if(D===5||D===6)m=m.stateNode,_?ox(C,m,_):ly(C,m);else if(!(D===4||Ra&&D===27)&&(m=m.child,m!==null))for(Ii(m,_,C),m=m.sibling;m!==null;)Ii(m,_,C),m=m.sibling}function vc(m,_,C){var D=m.tag;if(D===5||D===6)m=m.stateNode,_?ax(C,m,_):Zo(C,m);else if(!(D===4||Ra&&D===27)&&(m=m.child,m!==null))for(vc(m,_,C),m=m.sibling;m!==null;)vc(m,_,C),m=m.sibling}function Co(m,_,C){m=m.containerInfo;try{aS(m,C)}catch(D){or(_,_.return,D)}}function Pp(m,_){for(nx(m.containerInfo),le=_;le!==null;)if(m=le,_=m.child,(m.subtreeFlags&1028)!==0&&_!==null)_.return=m,le=_;else for(;le!==null;){m=le;var C=m.alternate;switch(_=m.flags,m.tag){case 0:break;case 11:case 15:break;case 1:if(_&1024&&C!==null){_=void 0;var D=m,z=C.memoizedProps;C=C.memoizedState;var Z=D.stateNode;try{var Se=_h(D.type,z,D.elementType===D.type);_=Z.getSnapshotBeforeUpdate(Se,C),Z.__reactInternalSnapshotBeforeUpdate=_}catch(ze){or(D,D.return,ze)}}break;case 3:_&1024&&Mo&&Jm(m.stateNode.containerInfo);break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if(_&1024)throw Error(r(163))}if(_=m.sibling,_!==null){_.return=m.return,le=_;break}le=m.return}return Se=xe,xe=!1,Se}function H0(m,_,C){var D=C.flags;switch(C.tag){case 0:case 11:case 15:wl(m,C),D&4&&F0(5,C);break;case 1:if(wl(m,C),D&4)if(m=C.stateNode,_===null)try{m.componentDidMount()}catch(ze){or(C,C.return,ze)}else{var z=_h(C.type,_.memoizedProps);_=_.memoizedState;try{m.componentDidUpdate(z,_,m.__reactInternalSnapshotBeforeUpdate)}catch(ze){or(C,C.return,ze)}}D&64&&Jc(C),D&512&&Dp(C,C.return);break;case 3:if(wl(m,C),D&64&&(D=C.updateQueue,D!==null)){if(m=null,C.child!==null)switch(C.child.tag){case 27:case 5:m=Cd(C.child.stateNode);break;case 1:m=C.child.stateNode}try{Vt(D,m)}catch(ze){or(C,C.return,ze)}}break;case 26:if(co){wl(m,C),D&512&&Dp(C,C.return);break}case 27:case 5:wl(m,C),_===null&&D&4&&HE(C),D&512&&Dp(C,C.return);break;case 12:wl(m,C);break;case 13:wl(m,C),D&4&&Bm(m,C);break;case 22:if(z=C.memoizedState!==null||E,!z){_=_!==null&&_.memoizedState!==null||w;var Z=E,Se=w;E=z,(w=_)&&!Se?Yl(m,C,(C.subtreeFlags&8772)!==0):wl(m,C),E=Z,w=Se}D&512&&(C.memoizedProps.mode==="manual"?Dp(C,C.return):Ca(C,C.return));break;default:wl(m,C)}}function Ao(m){var _=m.alternate;_!==null&&(m.alternate=null,Ao(_)),m.child=null,m.deletions=null,m.sibling=null,m.tag===5&&(_=m.stateNode,_!==null&&fs(_)),m.stateNode=null,m.return=null,m.dependencies=null,m.memoizedProps=null,m.memoizedState=null,m.pendingProps=null,m.stateNode=null,m.updateQueue=null}function Bt(m,_,C){for(C=C.child;C!==null;)Aa(m,_,C),C=C.sibling}function Aa(m,_,C){if(S&&typeof S.onCommitFiberUnmount=="function")try{S.onCommitFiberUnmount(N,C)}catch{}switch(C.tag){case 26:if(co){w||Ca(C,_),Bt(m,_,C),C.memoizedState?Qo(C.memoizedState):C.stateNode&&lS(C.stateNode);break}case 27:if(Ra){w||Ca(C,_);var D=Pe,z=We;Pe=C.stateNode,Bt(m,_,C),fS(C.stateNode),Pe=D,We=z;break}case 5:w||Ca(C,_);case 6:if(Mo){if(D=Pe,z=We,Pe=null,Bt(m,_,C),Pe=D,We=z,Pe!==null)if(We)try{sS(Pe,C.stateNode)}catch(Z){or(C,_,Z)}else try{Km(Pe,C.stateNode)}catch(Z){or(C,_,Z)}}else Bt(m,_,C);break;case 18:Mo&&Pe!==null&&(We?aR(Pe,C.stateNode):sR(Pe,C.stateNode));break;case 4:Mo?(D=Pe,z=We,Pe=C.stateNode.containerInfo,We=!0,Bt(m,_,C),Pe=D,We=z):(Fu&&Co(C.stateNode,C,hy()),Bt(m,_,C));break;case 0:case 11:case 14:case 15:w||Mu(2,C,_),w||Mu(4,C,_),Bt(m,_,C);break;case 1:w||(Ca(C,_),D=C.stateNode,typeof D.componentWillUnmount=="function"&&z0(C,_,D)),Bt(m,_,C);break;case 21:Bt(m,_,C);break;case 22:w||Ca(C,_),w=(D=w)||C.memoizedState!==null,Bt(m,_,C),w=D;break;default:Bt(m,_,C)}}function Bm(m,_){if(Al&&_.memoizedState===null&&(m=_.alternate,m!==null&&(m=m.memoizedState,m!==null&&(m=m.dehydrated,m!==null))))try{hv(m)}catch(C){or(_,_.return,C)}}function Ed(m){switch(m.tag){case 13:case 19:var _=m.stateNode;return _===null&&(_=m.stateNode=new Q),_;case 22:return m=m.stateNode,_=m._retryCache,_===null&&(_=m._retryCache=new Q),_;default:throw Error(r(435,m.tag))}}function bf(m,_){var C=Ed(m);_.forEach(function(D){var z=Q1.bind(null,m,D);C.has(D)||(C.add(D),D.then(z,z))})}function da(m,_){var C=_.deletions;if(C!==null)for(var D=0;D<C.length;D++){var z=C[D],Z=m,Se=_;if(Mo){var ze=Se;e:for(;ze!==null;){switch(ze.tag){case 27:case 5:Pe=ze.stateNode,We=!1;break e;case 3:Pe=ze.stateNode.containerInfo,We=!0;break e;case 4:Pe=ze.stateNode.containerInfo,We=!0;break e}ze=ze.return}if(Pe===null)throw Error(r(160));Aa(Z,Se,z),Pe=null,We=!1}else Aa(Z,Se,z);Z=z.alternate,Z!==null&&(Z.return=null),z.return=null}if(_.subtreeFlags&13878)for(_=_.child;_!==null;)j0(_,m),_=_.sibling}function j0(m,_){var C=m.alternate,D=m.flags;switch(m.tag){case 0:case 11:case 14:case 15:da(_,m),_c(m),D&4&&(Mu(3,m,m.return),F0(3,m),Mu(5,m,m.return));break;case 1:da(_,m),_c(m),D&512&&(w||C===null||Ca(C,C.return)),D&64&&E&&(m=m.updateQueue,m!==null&&(D=m.callbacks,D!==null&&(C=m.shared.hiddenCallbacks,m.shared.hiddenCallbacks=C===null?D:C.concat(D))));break;case 26:if(co){var z=ct;da(_,m),_c(m),D&512&&(w||C===null||Ca(C,C.return)),D&4&&(D=C!==null?C.memoizedState:null,_=m.memoizedState,C===null?_===null?m.stateNode===null?m.stateNode=cS(z,m.type,m.memoizedProps,m):fv(z,m.type,m.stateNode):m.stateNode=qs(z,_,m.memoizedProps):D!==_?(D===null?C.stateNode!==null&&lS(C.stateNode):Qo(D),_===null?fv(z,m.type,m.stateNode):qs(z,_,m.memoizedProps)):_===null&&m.stateNode!==null&&gc(m,m.memoizedProps,C.memoizedProps));break}case 27:if(Ra&&D&4&&m.alternate===null){z=m.stateNode;var Z=m.memoizedProps;try{py(z),hS(m.type,Z,z,m)}catch(en){or(m,m.return,en)}}case 5:if(da(_,m),_c(m),D&512&&(w||C===null||Ca(C,C.return)),Mo){if(m.flags&32){_=m.stateNode;try{lv(_)}catch(en){or(m,m.return,en)}}D&4&&m.stateNode!=null&&(_=m.memoizedProps,gc(m,_,C!==null?C.memoizedProps:_)),D&1024&&(F=!0)}break;case 6:if(da(_,m),_c(m),D&4&&Mo){if(m.stateNode===null)throw Error(r(162));D=m.memoizedProps,C=C!==null?C.memoizedProps:D,_=m.stateNode;try{rS(_,C,D)}catch(en){or(m,m.return,en)}}break;case 3:if(co?(hx(),z=ct,ct=Rf(_.containerInfo),da(_,m),ct=z):da(_,m),_c(m),D&4){if(Mo&&Al&&C!==null&&C.memoizedState.isDehydrated)try{ig(_.containerInfo)}catch(en){or(m,m.return,en)}if(Fu){D=_.containerInfo,C=_.pendingChildren;try{aS(D,C)}catch(en){or(m,m.return,en)}}}F&&(F=!1,Z1(m));break;case 4:co?(C=ct,ct=Rf(m.stateNode.containerInfo),da(_,m),_c(m),ct=C):(da(_,m),_c(m)),D&4&&Fu&&Co(m.stateNode,m,m.stateNode.pendingChildren);break;case 12:da(_,m),_c(m);break;case 13:da(_,m),_c(m),m.child.flags&8192&&m.memoizedState!==null!=(C!==null&&C.memoizedState!==null)&&(_y=Zn()),D&4&&(D=m.updateQueue,D!==null&&(m.updateQueue=null,bf(m,D)));break;case 22:D&512&&(w||C===null||Ca(C,C.return)),z=m.memoizedState!==null;var Se=C!==null&&C.memoizedState!==null,ze=E,ut=w;if(E=ze||z,w=ut||Se,da(_,m),w=ut,E=ze,_c(m),_=m.stateNode,_._current=m,_._visibility&=-3,_._visibility|=_._pendingVisibility&2,D&8192&&(_._visibility=z?_._visibility&-2:_._visibility|1,z&&(_=E||w,C===null||Se||_||Lp(m)),Mo&&(m.memoizedProps===null||m.memoizedProps.mode!=="manual"))){e:if(C=null,Mo)for(_=m;;){if(_.tag===5||co&&_.tag===26||Ra&&_.tag===27){if(C===null){Se=C=_;try{Z=Se.stateNode,z?tl(Z):uy(Se.stateNode,Se.memoizedProps)}catch(en){or(Se,Se.return,en)}}}else if(_.tag===6){if(C===null){Se=_;try{var Dt=Se.stateNode;z?Zm(Dt):Va(Dt,Se.memoizedProps)}catch(en){or(Se,Se.return,en)}}}else if((_.tag!==22&&_.tag!==23||_.memoizedState===null||_===m)&&_.child!==null){_.child.return=_,_=_.child;continue}if(_===m)break e;for(;_.sibling===null;){if(_.return===null||_.return===m)break e;C===_&&(C=null),_=_.return}C===_&&(C=null),_.sibling.return=_.return,_=_.sibling}}D&4&&(D=m.updateQueue,D!==null&&(C=D.retryQueue,C!==null&&(D.retryQueue=null,bf(m,C))));break;case 19:da(_,m),_c(m),D&4&&(D=m.updateQueue,D!==null&&(m.updateQueue=null,bf(m,D)));break;case 21:break;default:da(_,m),_c(m)}}function _c(m){var _=m.flags;if(_&2){try{if(Mo&&(!Ra||m.tag!==27)){e:{for(var C=m.return;C!==null;){if(ws(C)){var D=C;break e}C=C.return}throw Error(r(160))}switch(D.tag){case 27:if(Ra){var z=D.stateNode,Z=Js(m);vc(m,Z,z);break}case 5:var Se=D.stateNode;D.flags&32&&(lv(Se),D.flags&=-33);var ze=Js(m);vc(m,ze,Se);break;case 3:case 4:var ut=D.stateNode.containerInfo,Dt=Js(m);Ii(m,Dt,ut);break;default:throw Error(r(161))}}}catch(en){or(m,m.return,en)}m.flags&=-3}_&4096&&(m.flags&=-4097)}function Z1(m){if(m.subtreeFlags&1024)for(m=m.child;m!==null;){var _=m;Z1(_),_.tag===5&&_.flags&1024&&li(_.stateNode),m=m.sibling}}function wl(m,_){if(_.subtreeFlags&8772)for(_=_.child;_!==null;)H0(m,_.alternate,_),_=_.sibling}function Lp(m){for(m=m.child;m!==null;){var _=m;switch(_.tag){case 0:case 11:case 14:case 15:Mu(4,_,_.return),Lp(_);break;case 1:Ca(_,_.return);var C=_.stateNode;typeof C.componentWillUnmount=="function"&&z0(_,_.return,C),Lp(_);break;case 26:case 27:case 5:Ca(_,_.return),Lp(_);break;case 22:Ca(_,_.return),_.memoizedState===null&&Lp(_);break;default:Lp(_)}m=m.sibling}}function Yl(m,_,C){for(C=C&&(_.subtreeFlags&8772)!==0,_=_.child;_!==null;){var D=_.alternate,z=m,Z=_,Se=Z.flags;switch(Z.tag){case 0:case 11:case 15:Yl(z,Z,C),F0(4,Z);break;case 1:if(Yl(z,Z,C),D=Z,z=D.stateNode,typeof z.componentDidMount=="function")try{z.componentDidMount()}catch(Dt){or(D,D.return,Dt)}if(D=Z,z=D.updateQueue,z!==null){var ze=D.stateNode;try{var ut=z.shared.hiddenCallbacks;if(ut!==null)for(z.shared.hiddenCallbacks=null,z=0;z<ut.length;z++)qe(ut[z],ze)}catch(Dt){or(D,D.return,Dt)}}C&&Se&64&&Jc(Z),Dp(Z,Z.return);break;case 26:case 27:case 5:Yl(z,Z,C),C&&D===null&&Se&4&&HE(Z),Dp(Z,Z.return);break;case 12:Yl(z,Z,C);break;case 13:Yl(z,Z,C),C&&Se&4&&Bm(z,Z);break;case 22:Z.memoizedState===null&&Yl(z,Z,C),Dp(Z,Z.return);break;default:Yl(z,Z,C)}_=_.sibling}}function Sd(m,_){var C=null;m!==null&&m.memoizedState!==null&&m.memoizedState.cachePool!==null&&(C=m.memoizedState.cachePool.pool),m=null,_.memoizedState!==null&&_.memoizedState.cachePool!==null&&(m=_.memoizedState.cachePool.pool),m!==C&&(m!=null&&m.refCount++,C!=null&&_d(C))}function Fm(m,_){m=null,_.alternate!==null&&(m=_.alternate.memoizedState.cache),_=_.memoizedState.cache,_!==m&&(_.refCount++,m!=null&&_d(m))}function ge(m,_,C,D){if(_.subtreeFlags&10256)for(_=_.child;_!==null;)Ef(m,_,C,D),_=_.sibling}function Ef(m,_,C,D){var z=_.flags;switch(_.tag){case 0:case 11:case 15:ge(m,_,C,D),z&2048&&F0(9,_);break;case 3:ge(m,_,C,D),z&2048&&(m=null,_.alternate!==null&&(m=_.alternate.memoizedState.cache),_=_.memoizedState.cache,_!==m&&(_.refCount++,m!=null&&_d(m)));break;case 12:if(z&2048){ge(m,_,C,D),m=_.stateNode;try{var Z=_.memoizedProps,Se=Z.id,ze=Z.onPostCommit;typeof ze=="function"&&ze(Se,_.alternate===null?"mount":"update",m.passiveEffectDuration,-0)}catch(ut){or(_,_.return,ut)}}else ge(m,_,C,D);break;case 23:break;case 22:Z=_.stateNode,_.memoizedState!==null?Z._visibility&4?ge(m,_,C,D):so(m,_):Z._visibility&4?ge(m,_,C,D):(Z._visibility|=4,Sh(m,_,C,D,(_.subtreeFlags&10256)!==0)),z&2048&&Sd(_.alternate,_);break;case 24:ge(m,_,C,D),z&2048&&Fm(_.alternate,_);break;default:ge(m,_,C,D)}}function Sh(m,_,C,D,z){for(z=z&&(_.subtreeFlags&10256)!==0,_=_.child;_!==null;){var Z=m,Se=_,ze=C,ut=D,Dt=Se.flags;switch(Se.tag){case 0:case 11:case 15:Sh(Z,Se,ze,ut,z),F0(8,Se);break;case 23:break;case 22:var en=Se.stateNode;Se.memoizedState!==null?en._visibility&4?Sh(Z,Se,ze,ut,z):so(Z,Se):(en._visibility|=4,Sh(Z,Se,ze,ut,z)),z&&Dt&2048&&Sd(Se.alternate,Se);break;case 24:Sh(Z,Se,ze,ut,z),z&&Dt&2048&&Fm(Se.alternate,Se);break;default:Sh(Z,Se,ze,ut,z)}_=_.sibling}}function so(m,_){if(_.subtreeFlags&10256)for(_=_.child;_!==null;){var C=m,D=_,z=D.flags;switch(D.tag){case 22:so(C,D),z&2048&&Sd(D.alternate,D);break;case 24:so(C,D),z&2048&&Fm(D.alternate,D);break;default:so(C,D)}_=_.sibling}}function Fi(m){if(m.subtreeFlags&kt)for(m=m.child;m!==null;)Sf(m),m=m.sibling}function Sf(m){switch(m.tag){case 26:Fi(m),m.flags&kt&&(m.memoizedState!==null?cR(ct,m.memoizedState,m.memoizedProps):oy(m.type,m.memoizedProps));break;case 5:Fi(m),m.flags&kt&&oy(m.type,m.memoizedProps);break;case 3:case 4:if(co){var _=ct;ct=Rf(m.stateNode.containerInfo),Fi(m),ct=_}else Fi(m);break;case 22:m.memoizedState===null&&(_=m.alternate,_!==null&&_.memoizedState!==null?(_=kt,kt=16777216,Fi(m),kt=_):Fi(m));break;default:Fi(m)}}function Ou(m){var _=m.alternate;if(_!==null&&(m=_.child,m!==null)){_.child=null;do _=m.sibling,m.sibling=null,m=_;while(m!==null)}}function Qc(m){var _=m.deletions;if(m.flags&16){if(_!==null)for(var C=0;C<_.length;C++){var D=_[C];le=D,J_(D,m)}Ou(m)}if(m.subtreeFlags&10256)for(m=m.child;m!==null;)Nu(m),m=m.sibling}function Nu(m){switch(m.tag){case 0:case 11:case 15:Qc(m),m.flags&2048&&Mu(9,m,m.return);break;case 3:Qc(m);break;case 12:Qc(m);break;case 22:var _=m.stateNode;m.memoizedState!==null&&_._visibility&4&&(m.return===null||m.return.tag!==13)?(_._visibility&=-5,yc(m)):Qc(m);break;default:Qc(m)}}function yc(m){var _=m.deletions;if(m.flags&16){if(_!==null)for(var C=0;C<_.length;C++){var D=_[C];le=D,J_(D,m)}Ou(m)}for(m=m.child;m!==null;){switch(_=m,_.tag){case 0:case 11:case 15:Mu(8,_,_.return),yc(_);break;case 22:C=_.stateNode,C._visibility&4&&(C._visibility&=-5,yc(_));break;default:yc(_)}m=m.sibling}}function J_(m,_){for(;le!==null;){var C=le;switch(C.tag){case 0:case 11:case 15:Mu(8,C,_);break;case 23:case 22:if(C.memoizedState!==null&&C.memoizedState.cachePool!==null){var D=C.memoizedState.cachePool.pool;D!=null&&D.refCount++}break;case 24:_d(C.memoizedState.cache)}if(D=C.child,D!==null)D.return=C,le=D;else e:for(C=m;le!==null;){D=le;var z=D.sibling,Z=D.return;if(Ao(D),D===C){le=null;break e}if(z!==null){z.return=Z,le=z;break e}le=Z}}}function Xl(m){var _=av(m);if(_!=null){if(typeof _.memoizedProps["data-testname"]!="string")throw Error(r(364));return _}if(m=ov(m),m===null)throw Error(r(362));return m.stateNode.current}function Q_(m,_){var C=m.tag;switch(_.$$typeof){case Wt:if(m.type===_.value)return!0;break;case Rn:e:{for(_=_.value,m=[m,0],C=0;C<m.length;){var D=m[C++],z=D.tag,Z=m[C++],Se=_[Z];if(z!==5&&z!==26&&z!==27||!qp(D)){for(;Se!=null&&Q_(D,Se);)Z++,Se=_[Z];if(Z===_.length){_=!0;break e}else for(D=D.child;D!==null;)m.push(D,Z),D=D.sibling}}_=!1}return _;case Un:if((C===5||C===26||C===27)&&sx(m.stateNode,_.value))return!0;break;case Ut:if((C===5||C===6||C===26||C===27)&&(m=ja(m),m!==null&&0<=m.indexOf(_.value)))return!0;break;case ni:if((C===5||C===26||C===27)&&(m=m.memoizedProps["data-testname"],typeof m=="string"&&m.toLowerCase()===_.value.toLowerCase()))return!0;break;default:throw Error(r(365))}return!1}function V0(m){switch(m.$$typeof){case Wt:return"<"+(a(m.value)||"Unknown")+">";case Rn:return":has("+(V0(m)||"")+")";case Un:return'[role="'+m.value+'"]';case Ut:return'"'+m.value+'"';case ni:return'[data-testname="'+m.value+'"]';default:throw Error(r(365))}}function G0(m,_){var C=[];m=[m,0];for(var D=0;D<m.length;){var z=m[D++],Z=z.tag,Se=m[D++],ze=_[Se];if(Z!==5&&Z!==26&&Z!==27||!qp(z)){for(;ze!=null&&Q_(z,ze);)Se++,ze=_[Se];if(Se===_.length)C.push(z);else for(z=z.child;z!==null;)m.push(z,Se),z=z.sibling}}return C}function Td(m,_){if(!Ol)throw Error(r(363));m=Xl(m),m=G0(m,_),_=[],m=Array.from(m);for(var C=0;C<m.length;){var D=m[C++],z=D.tag;if(z===5||z===26||z===27)qp(D)||_.push(D.stateNode);else for(D=D.child;D!==null;)m.push(D),D=D.sibling}return _}function Ro(){if(Gt&2&&In!==0)return In&-In;if(vi.T!==null){var m=Tn;return m!==0?m:qt()}return zu()}function jE(){eu===0&&(eu=!(In&536870912)||wt?k():536870912);var m=Ss.current;return m!==null&&(m.flags|=32),eu}function Xo(m,_,C){(m===Mn&&ln===2||m.cancelPendingCommit!==null)&&(Cl(m,0),us(m,In,eu,!1)),G(m,C),(!(Gt&2)||m!==Mn)&&(m===Mn&&(!(Gt&2)&&(Ql|=C),pr===4&&us(m,In,eu,!1)),bt(m))}function Iu(m,_,C){if(Gt&6)throw Error(r(327));var D=!C&&(_&60)===0&&(_&m.expiredLanes)===0||R(m,_),z=D?ku(m,_):W0(m,_,!0),Z=D;do{if(z===0){Ls&&!D&&us(m,_,0,!1);break}else if(z===6)us(m,_,0,!Cs);else{if(C=m.current.alternate,Z&&!bc(C)){z=W0(m,_,!1),Z=!1;continue}if(z===2){if(Z=_,m.errorRecoveryDisabledLanes&Z)var Se=0;else Se=m.pendingLanes&-536870913,Se=Se!==0?Se:Se&536870912?536870912:0;if(Se!==0){_=Se;e:{var ze=m;z=Of;var ut=Al&&ze.current.memoizedState.isDehydrated;if(ut&&(Cl(ze,Se).flags|=256),Se=W0(ze,Se,!1),Se!==2){if(xc&&!ut){ze.errorRecoveryDisabledLanes|=Z,Ql|=Z,z=4;break e}Z=Nf,Nf=z,Z!==null&&q0(Z)}z=Se}if(Z=!1,z!==2)continue}}if(z===1){Cl(m,0),us(m,_,0,!0);break}e:{switch(D=m,z){case 0:case 1:throw Error(r(345));case 4:if((_&4194176)===_){us(D,_,eu,!Cs);break e}break;case 2:Nf=null;break;case 3:case 5:break;default:throw Error(r(329))}if(D.finishedWork=C,D.finishedLanes=_,(_&62914560)===_&&(Z=_y+300-Zn(),10<Z)){if(us(D,_,eu,!Cs),M(D,0)!==0)break e;D.timeoutHandle=rx(Tf.bind(null,D,C,Nf,_v,dx,_,eu,Ql,Yp,Cs,2,-0,0),Z);break e}Tf(D,C,Nf,_v,dx,_,eu,Ql,Yp,Cs,0,-0,0)}}break}while(!0);bt(m)}function q0(m){Nf===null?Nf=m:Nf.push.apply(Nf,m)}function Tf(m,_,C,D,z,Z,Se,ze,ut,Dt,en,xn,An){var er=_.subtreeFlags;if((er&8192||(er&16785408)===16785408)&&(eS(),Sf(_),_=tS(),_!==null)){m.cancelPendingCommit=_(jm.bind(null,m,C,D,z,Se,ze,ut,1,xn,An)),us(m,Z,Se,!Dt);return}jm(m,C,D,z,Se,ze,ut,en,xn,An)}function bc(m){for(var _=m;;){var C=_.tag;if((C===0||C===11||C===15)&&_.flags&16384&&(C=_.updateQueue,C!==null&&(C=C.stores,C!==null)))for(var D=0;D<C.length;D++){var z=C[D],Z=z.getSnapshot;z=z.value;try{if(!A(Z(),z))return!1}catch{return!1}}if(C=_.child,_.subtreeFlags&16384&&C!==null)C.return=_,_=C;else{if(_===m)break;for(;_.sibling===null;){if(_.return===null||_.return===m)return!0;_=_.return}_.sibling.return=_.return,_=_.sibling}}return!0}function us(m,_,C,D){_&=~vy,_&=~Ql,m.suspendedLanes|=_,m.pingedLanes&=~_,D&&(m.warmLanes|=_),D=m.expirationTimes;for(var z=_;0<z;){var Z=31-tc(z),Se=1<<Z;D[Z]=-1,z&=~Se}C!==0&&q(m,C,_)}function ey(){return Gt&6?!0:(be(0),!1)}function xd(){if(on!==null){if(ln===0)var m=on.return;else m=on,Nl=qu=null,wu(m),fr=null,Wr=0,m=on;for(;m!==null;)fa(m.alternate,m),m=m.return;on=null}}function Cl(m,_){m.finishedWork=null,m.finishedLanes=0;var C=m.timeoutHandle;C!==sv&&(m.timeoutHandle=sv,ay(C)),C=m.cancelPendingCommit,C!==null&&(m.cancelPendingCommit=null,C()),xd(),Mn=m,on=C=Th(m.current,null),In=_,ln=0,Fn=null,Cs=!1,Ls=R(m,_),xc=!1,Yp=eu=vy=Ql=wc=pr=0,Nf=Of=null,dx=!1,_&8&&(_|=_&32);var D=m.entangledLanes;if(D!==0)for(m=m.entanglements,D&=_;0<D;){var z=31-tc(D),Z=1<<z;_|=m[z],D&=~Z}return kr=_,de(),C}function $0(m,_){Jn=null,vi.H=Oa,_===Qr?(_=Ge(),ln=3):_===ds?(_=Ge(),ln=4):ln=_===Wp?8:_!==null&&typeof _=="object"&&typeof _.then=="function"?6:1,Fn=_,on===null&&(pr=1,Im(m,ee(_,m.current)))}function VE(){var m=Ss.current;return m===null?!0:(In&4194176)===In?Ps===null:(In&62914560)===In||In&536870912?m===Ps:!1}function zm(){var m=vi.H;return vi.H=Oa,m===null?Oa:m}function Hm(){var m=vi.A;return vi.A=Lt,m}function Ha(){pr=4,Cs||(In&4194176)!==In&&Ss.current!==null||(Ls=!0),!(wc&134217727)&&!(Ql&134217727)||Mn===null||us(Mn,In,eu,!1)}function W0(m,_,C){var D=Gt;Gt|=2;var z=zm(),Z=Hm();(Mn!==m||In!==_)&&(_v=null,Cl(m,_)),_=!1;var Se=pr;e:do try{if(ln!==0&&on!==null){var ze=on,ut=Fn;switch(ln){case 8:xd(),Se=6;break e;case 3:case 2:case 6:Ss.current===null&&(_=!0);var Dt=ln;if(ln=0,Fn=null,Kl(m,ze,ut,Dt),C&&Ls){Se=0;break e}break;default:Dt=ln,ln=0,Fn=null,Kl(m,ze,ut,Dt)}}GE(),Se=pr;break}catch(en){$0(m,en)}while(!0);return _&&m.shellSuspendCounter++,Nl=qu=null,Gt=D,vi.H=z,vi.A=Z,on===null&&(Mn=null,In=0,de()),Se}function GE(){for(;on!==null;)Du(on)}function ku(m,_){var C=Gt;Gt|=2;var D=zm(),z=Hm();Mn!==m||In!==_?(_v=null,vv=Zn()+500,Cl(m,_)):Ls=R(m,_);e:do try{if(ln!==0&&on!==null){_=on;var Z=Fn;t:switch(ln){case 1:ln=0,Fn=null,Kl(m,_,Z,1);break;case 2:if(Pt(Z)){ln=0,Fn=null,Gs(_);break}_=function(){ln===2&&Mn===m&&(ln=7),bt(m)},Z.then(_,_);break e;case 3:ln=7;break e;case 4:ln=5;break e;case 7:Pt(Z)?(ln=0,Fn=null,Gs(_)):(ln=0,Fn=null,Kl(m,_,Z,7));break;case 5:var Se=null;switch(on.tag){case 26:Se=on.memoizedState;case 5:case 27:var ze=on,ut=ze.type,Dt=ze.pendingProps;if(Se?uS(Se):Hu(ut,Dt)){ln=0,Fn=null;var en=ze.sibling;if(en!==null)on=en;else{var xn=ze.return;xn!==null?(on=xn,pa(xn)):on=null}break t}}ln=0,Fn=null,Kl(m,_,Z,5);break;case 6:ln=0,Fn=null,Kl(m,_,Z,6);break;case 8:xd(),pr=6;break e;default:throw Error(r(462))}}qE();break}catch(An){$0(m,An)}while(!0);return Nl=qu=null,vi.H=D,vi.A=z,Gt=C,on!==null?0:(Mn=null,In=0,de(),pr)}function qE(){for(;on!==null&&!uR();)Du(on)}function Du(m){var _=Zi(m.alternate,m,kr);m.memoizedProps=m.pendingProps,_===null?pa(m):on=_}function Gs(m){var _=m,C=_.alternate;switch(_.tag){case 15:case 0:_=Dm(C,_,_.pendingProps,_.type,void 0,In);break;case 11:_=Dm(C,_,_.pendingProps,_.type.render,_.ref,In);break;case 5:wu(_);default:fa(C,_),_=on=Z0(_,kr),_=Zi(C,_,kr)}m.memoizedProps=m.pendingProps,_===null?pa(m):on=_}function Kl(m,_,C,D){Nl=qu=null,wu(_),fr=null,Wr=0;var z=_.return;try{if($1(m,z,_,C,In)){pr=1,Im(m,ee(C,m.current)),on=null;return}}catch(Z){if(z!==null)throw on=z,Z;pr=1,Im(m,ee(C,m.current)),on=null;return}_.flags&32768?(wt||D===1?m=!0:Ls||In&536870912?m=!1:(Cs=m=!0,(D===2||D===3||D===6)&&(D=Ss.current,D!==null&&D.tag===13&&(D.flags|=16384))),jr(_,m)):pa(_)}function pa(m){var _=m;do{if(_.flags&32768){jr(_,Cs);return}m=_.return;var C=B0(_.alternate,_,kr);if(C!==null){on=C;return}if(_=_.sibling,_!==null){on=_;return}on=_=m}while(_!==null);pr===0&&(pr=5)}function jr(m,_){do{var C=fn(m.alternate,m);if(C!==null){C.flags&=32767,on=C;return}if(C=m.return,C!==null&&(C.flags|=32768,C.subtreeFlags=0,C.deletions=null),!_&&(m=m.sibling,m!==null)){on=m;return}on=m=C}while(m!==null);pr=6,on=null}function jm(m,_,C,D,z,Z,Se,ze,ut,Dt){var en=vi.T,xn=oo();try{Ko(2),vi.T=null,Vm(m,_,C,D,xn,z,Z,Se,ze,ut,Dt)}finally{vi.T=en,Ko(xn)}}function Vm(m,_,C,D,z,Z,Se,ze){do Ec();while(Nd!==null);if(Gt&6)throw Error(r(327));var ut=m.finishedWork;if(D=m.finishedLanes,ut===null)return null;if(m.finishedWork=null,m.finishedLanes=0,ut===m.current)throw Error(r(177));m.callbackNode=null,m.callbackPriority=0,m.cancelPendingCommit=null;var Dt=ut.lanes|ut.childLanes;if(Dt|=zi,$(m,D,Dt,Z,Se,ze),m===Mn&&(on=Mn=null,In=0),!(ut.subtreeFlags&10256)&&!(ut.flags&10256)||mS||(mS=!0,O8=Dt,N8=C,ny(Ds,function(){return Ec(),null})),C=(ut.flags&15990)!==0,ut.subtreeFlags&15990||C?(C=vi.T,vi.T=null,Z=oo(),Ko(2),Se=Gt,Gt|=4,Pp(m,ut),j0(ut,m),ix(m.containerInfo),m.current=ut,H0(m,ut.alternate,ut),Vr(),Gt=Se,Ko(Z),vi.T=C):m.current=ut,mS?(mS=!1,Nd=m,ag=D):ty(m,Dt),Dt=m.pendingLanes,Dt===0&&(If=null),V(ut.stateNode),bt(m),_!==null)for(z=m.onRecoverableError,ut=0;ut<_.length;ut++)Dt=_[ut],z(Dt.value,{componentStack:Dt.stack});return ag&3&&Ec(),Dt=m.pendingLanes,D&4194218&&Dt&42?m===I8?hR++:(hR=0,I8=m):hR=0,be(0),null}function ty(m,_){(m.pooledCacheLanes&=_)===0&&(_=m.pooledCache,_!=null&&(m.pooledCache=null,_d(_)))}function Ec(){if(Nd!==null){var m=Nd,_=O8;O8=0;var C=ie(ag),D=32>C?32:C;C=vi.T;var z=oo();try{if(Ko(D),vi.T=null,Nd===null)var Z=!1;else{D=N8,N8=null;var Se=Nd,ze=ag;if(Nd=null,ag=0,Gt&6)throw Error(r(331));var ut=Gt;if(Gt|=4,Nu(Se.current),Ef(Se,Se.current,ze,D),Gt=ut,be(0,!1),S&&typeof S.onPostCommitFiberRoot=="function")try{S.onPostCommitFiberRoot(N,Se)}catch{}Z=!0}return Z}finally{Ko(z),vi.T=C,ty(m,_)}}return!1}function Y0(m,_,C){_=ee(C,_),_=pc(m.stateNode,_,2),m=De(m,_,2),m!==null&&(G(m,2),bt(m))}function or(m,_,C){if(m.tag===3)Y0(m,m,C);else for(;_!==null;){if(_.tag===3){Y0(_,m,C);break}else if(_.tag===1){var D=_.stateNode;if(typeof _.type.getDerivedStateFromError=="function"||typeof D.componentDidCatch=="function"&&(If===null||!If.has(D))){m=ee(C,m),C=Ns(2),D=De(_,C,2),D!==null&&(vf(C,D,_,m),G(D,2),bt(D));break}}_=_.return}}function X0(m,_,C){var D=m.pingCache;if(D===null){D=m.pingCache=new mi;var z=new Set;D.set(_,z)}else z=D.get(_),z===void 0&&(z=new Set,D.set(_,z));z.has(C)||(xc=!0,z.add(C),m=J1.bind(null,m,_,C),_.then(m,m))}function J1(m,_,C){var D=m.pingCache;D!==null&&D.delete(_),m.pingedLanes|=m.suspendedLanes&C,m.warmLanes&=~C,Mn===m&&(In&C)===C&&(pr===4||pr===3&&(In&62914560)===In&&300>Zn()-_y?!(Gt&2)&&Cl(m,0):vy|=C,Yp===In&&(Yp=0)),bt(m)}function $E(m,_){_===0&&(_=P()),m=rt(m,_),m!==null&&(G(m,_),bt(m))}function WE(m){var _=m.memoizedState,C=0;_!==null&&(C=_.retryLane),$E(m,C)}function Q1(m,_){var C=0;switch(m.tag){case 13:var D=m.stateNode,z=m.memoizedState;z!==null&&(C=z.retryLane);break;case 19:D=m.stateNode;break;case 22:D=m.stateNode._retryCache;break;default:throw Error(r(314))}D!==null&&D.delete(_),$E(m,C)}function ny(m,_){return ks(m,_)}function Pu(m,_,C,D){this.tag=m,this.key=C,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=_,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=D,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function K0(m){return m=m.prototype,!(!m||!m.isReactComponent)}function Th(m,_){var C=m.alternate;return C===null?(C=n(m.tag,_,m.key,m.mode),C.elementType=m.elementType,C.type=m.type,C.stateNode=m.stateNode,C.alternate=m,m.alternate=C):(C.pendingProps=_,C.type=m.type,C.flags=0,C.subtreeFlags=0,C.deletions=null),C.flags=m.flags&31457280,C.childLanes=m.childLanes,C.lanes=m.lanes,C.child=m.child,C.memoizedProps=m.memoizedProps,C.memoizedState=m.memoizedState,C.updateQueue=m.updateQueue,_=m.dependencies,C.dependencies=_===null?null:{lanes:_.lanes,firstContext:_.firstContext},C.sibling=m.sibling,C.index=m.index,C.ref=m.ref,C.refCleanup=m.refCleanup,C}function Z0(m,_){m.flags&=31457282;var C=m.alternate;return C===null?(m.childLanes=0,m.lanes=_,m.child=null,m.subtreeFlags=0,m.memoizedProps=null,m.memoizedState=null,m.updateQueue=null,m.dependencies=null,m.stateNode=null):(m.childLanes=C.childLanes,m.lanes=C.lanes,m.child=C.child,m.subtreeFlags=0,m.deletions=null,m.memoizedProps=C.memoizedProps,m.memoizedState=C.memoizedState,m.updateQueue=C.updateQueue,m.type=C.type,_=C.dependencies,m.dependencies=_===null?null:{lanes:_.lanes,firstContext:_.firstContext}),m}function J0(m,_,C,D,z,Z){var Se=0;if(D=m,typeof m=="function")K0(m)&&(Se=1);else if(typeof m=="string")Se=co&&Ra?Mh(m,C,Ne.current)?26:dS(m)?27:5:co?Mh(m,C,Ne.current)?26:5:Ra&&dS(m)?27:5;else e:switch(m){case wh:return wd(C.children,z,Z,_);case el:Se=8,z|=24;break;case Ch:return m=n(12,C,_,z|2),m.elementType=Ch,m.lanes=Z,m;case tv:return m=n(13,C,_,z),m.elementType=tv,m.lanes=Z,m;case Hp:return m=n(19,C,_,z),m.elementType=Hp,m.lanes=Z,m;case Ah:return YE(C,z,Z,_);default:if(typeof m=="object"&&m!==null)switch(m.$$typeof){case zp:case Lu:Se=10;break e;case KE:Se=9;break e;case $m:Se=11;break e;case nv:Se=14;break e;case Uu:Se=16,D=null;break e}Se=29,C=Error(r(130,m===null?"null":typeof m,"")),D=null}return _=n(Se,C,_,z),_.elementType=m,_.type=D,_.lanes=Z,_}function wd(m,_,C,D){return m=n(7,m,D,_),m.lanes=C,m}function YE(m,_,C,D){m=n(22,m,D,_),m.elementType=Ah,m.lanes=C;var z={_visibility:1,_pendingVisibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null,_current:null,detach:function(){var Z=z._current;if(Z===null)throw Error(r(456));if(!(z._pendingVisibility&2)){var Se=rt(Z,2);Se!==null&&(z._pendingVisibility|=2,Xo(Se,Z,2))}},attach:function(){var Z=z._current;if(Z===null)throw Error(r(456));if(z._pendingVisibility&2){var Se=rt(Z,2);Se!==null&&(z._pendingVisibility&=-3,Xo(Se,Z,2))}}};return m.stateNode=z,m}function Q0(m,_,C){return m=n(6,m,null,_),m.lanes=C,m}function iy(m,_,C){return _=n(4,m.children!==null?m.children:[],m.key,_),_.lanes=C,_.stateNode={containerInfo:m.containerInfo,pendingChildren:null,implementation:m.implementation},_}function XE(m,_,C,D,z,Z,Se,ze){this.tag=1,this.containerInfo=m,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=sv,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=U(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.finishedLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=U(0),this.hiddenUpdates=U(null),this.identifierPrefix=D,this.onUncaughtError=z,this.onCaughtError=Z,this.onRecoverableError=Se,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=ze,this.incompleteTransitions=new Map}function ry(m,_,C,D,z,Z,Se,ze,ut,Dt,en,xn){return m=new XE(m,_,C,Se,ze,ut,Dt,xn),_=1,Z===!0&&(_|=24),Z=n(3,null,null,_),m.current=Z,Z.stateNode=m,_=K_(),_.refCount++,m.pooledCache=_,_.refCount++,Z.memoizedState={element:D,isDehydrated:C,cache:_},j(Z),m}function qi(m){return m?(m=ec,m):ec}function ev(m){var _=m._reactInternals;if(_===void 0)throw typeof m.render=="function"?Error(r(188)):(m=Object.keys(m).join(","),Error(r(268,m)));return m=d(_),m=m!==null?p(m):null,m===null?null:Cd(m.stateNode)}function ex(m,_,C,D,z,Z){z=qi(z),D.context===null?D.context=z:D.pendingContext=z,D=me(_),D.payload={element:C},Z=Z===void 0?null:Z,Z!==null&&(D.callback=Z),C=De(m,D,_),C!==null&&(Xo(C,m,_),Ve(C,m,_))}function Gm(m,_){if(m=m.memoizedState,m!==null&&m.dehydrated!==null){var C=m.retryLane;m.retryLane=C!==0&&C<_?C:_}}function xf(m,_){Gm(m,_),(m=m.alternate)&&Gm(m,_)}var Vi={},Up=Fe,hs=CV,xh=Object.assign,Bp=Symbol.for("react.element"),qm=Symbol.for("react.transitional.element"),Fp=Symbol.for("react.portal"),wh=Symbol.for("react.fragment"),el=Symbol.for("react.strict_mode"),Ch=Symbol.for("react.profiler"),zp=Symbol.for("react.provider"),KE=Symbol.for("react.consumer"),Lu=Symbol.for("react.context"),$m=Symbol.for("react.forward_ref"),tv=Symbol.for("react.suspense"),Hp=Symbol.for("react.suspense_list"),nv=Symbol.for("react.memo"),Uu=Symbol.for("react.lazy"),Ah=Symbol.for("react.offscreen"),QA=Symbol.for("react.memo_cache_sentinel"),ao=Symbol.iterator,ZE=Symbol.for("react.client.reference"),vi=Up.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Wm,sy,jp=!1,wf=Array.isArray,iv=e.rendererVersion,Sc=e.rendererPackageName,Bu=e.extraDevToolsConfig,Cd=e.getPublicInstance,Ym=e.getRootHostContext,tx=e.getChildHostContext,nx=e.prepareForCommit,ix=e.resetAfterCommit,Vp=e.createInstance,Gp=e.appendInitialChild,JE=e.finalizeInitialChildren,Xm=e.shouldSetTextContent,rv=e.createTextInstance,rx=e.scheduleTimeout,ay=e.cancelTimeout,sv=e.noTimeout,Zl=e.isPrimaryRenderer;e.warnsIfNotActing;var Mo=e.supportsMutation,Fu=e.supportsPersistence,Al=e.supportsHydration,av=e.getInstanceFromNode;e.beforeActiveInstanceBlur,e.afterActiveInstanceBlur;var eR=e.preparePortalMount;e.prepareScopeUpdate,e.getInstanceFromScope;var Ko=e.setCurrentUpdatePriority,oo=e.getCurrentUpdatePriority,zu=e.resolveUpdatePriority;e.resolveEventType,e.resolveEventTimeStamp;var Rl=e.shouldAttemptEagerTransition,fs=e.detachDeletedInstance;e.requestPostPaintCallback;var QE=e.maySuspendCommit,Hu=e.preloadInstance,eS=e.startSuspendingCommit,oy=e.suspendInstance,tS=e.waitForCommitToBeReady,Cf=e.NotPendingTransition,Ml=e.HostTransitionContext,li=e.resetFormInstance;e.bindToConsole;var cy=e.supportsMicrotasks,ti=e.scheduleMicrotask,Ol=e.supportsTestSelectors,ov=e.findFiberRoot,nS=e.getBoundingRect,ja=e.getTextContent,qp=e.isHiddenSubtree,sx=e.matchAccessibilityRole,iS=e.setFocusIfFocusable,Is=e.setupIntersectionObserver,Zo=e.appendChild,ly=e.appendChildToContainer,rS=e.commitTextUpdate,tR=e.commitMount,cv=e.commitUpdate,ax=e.insertBefore,ox=e.insertInContainerBefore,Km=e.removeChild,sS=e.removeChildFromContainer,lv=e.resetTextContent,tl=e.hideInstance,Zm=e.hideTextInstance,uy=e.unhideInstance,Va=e.unhideTextInstance,Jm=e.clearContainer,uv=e.cloneInstance,hy=e.createContainerChildSet,ju=e.appendChildToContainerChildSet,$p=e.finalizeContainerChildren,aS=e.replaceContainerChildren,Qm=e.cloneHiddenInstance,Ga=e.cloneHiddenTextInstance,eg=e.isSuspenseInstancePending,ma=e.isSuspenseInstanceFallback,Rh=e.getSuspenseInstanceFallbackErrorDetails,cx=e.registerSuspenseInstanceRetry,tg=e.canHydrateFormStateMarker,fy=e.isFormStateMarkerMatching,Jo=e.getNextHydratableSibling,Oo=e.getFirstHydratableChild,No=e.getFirstHydratableChildWithinContainer,oS=e.getFirstHydratableChildWithinSuspenseInstance,lx=e.canHydrateInstance,Af=e.canHydrateTextInstance,Er=e.canHydrateSuspenseInstance,nR=e.hydrateInstance,iR=e.hydrateTextInstance,rR=e.hydrateSuspenseInstance,ng=e.getNextHydratableInstanceAfterSuspenseInstance,ig=e.commitHydratedContainer,hv=e.commitHydratedSuspenseInstance,sR=e.clearSuspenseBoundary,aR=e.clearSuspenseBoundaryFromContainer,ux=e.shouldDeleteUnhydratedTailInstances;e.diffHydratedPropsForDevWarnings,e.diffHydratedTextForDevWarnings,e.describeHydratableInstanceForDevWarnings;var Vu=e.validateHydratableInstance,Gu=e.validateHydratableTextInstance,co=e.supportsResources,Mh=e.isHostHoistableType,Rf=e.getHoistableRoot,Oh=e.getResource,qs=e.acquireResource,Qo=e.releaseResource,cS=e.hydrateHoistable,fv=e.mountHoistable,lS=e.unmountHoistable,oR=e.createHoistableInstance,hx=e.prepareToCommitHoistables,dy=e.mayResourceSuspendCommit,uS=e.preloadResource,cR=e.suspendResource,Ra=e.supportsSingletons,rg=e.resolveSingletonInstance,py=e.clearSingleton,hS=e.acquireSingletonInstance,fS=e.releaseSingletonInstance,dS=e.isHostSingletonType,lo=[],Ad=-1,ec={},tc=Math.clz32?Math.clz32:T,lR=Math.log,my=Math.LN2,dv=128,qa=4194304,ks=hs.unstable_scheduleCallback,Nh=hs.unstable_cancelCallback,uR=hs.unstable_shouldYield,Vr=hs.unstable_requestPaint,Zn=hs.unstable_now,fx=hs.unstable_ImmediatePriority,uo=hs.unstable_UserBlockingPriority,Ds=hs.unstable_NormalPriority,Rd=hs.unstable_IdlePriority,sg=hs.log,pS=hs.unstable_setDisableYieldValue,N=null,S=null,A=typeof Object.is=="function"?Object.is:X,O=new WeakMap,L=[],B=0,H=null,te=0,re=[],K=0,ae=null,he=1,pe="",Ne=y(null),Je=y(null),Ye=y(null),Oe=y(null),ye=null,lt=null,wt=!1,Kt=null,It=!1,Kn=Error(r(519)),wn=[],_i=0,zi=0,ki=null,xi=null,yi=!1,Ri=!1,Di=!1,bi=0,Mi=null,ui=0,Tn=0,$n=null,$i=!1,Jr=!1,Es=Object.prototype.hasOwnProperty,Qr=Error(r(460)),ds=Error(r(474)),es={then:function(){}},Ir=null,fr=null,Wr=0,ts=sr(!0),ps=sr(!1),Qs=y(null),ga=y(0),Ss=y(null),Ps=null,dr=y(0),Ma=0,Jn=null,Gi=null,Mr=null,$a=!1,Io=!1,Tc=!1,nl=0,ms=0,nc=null,Ih=0,Jl=function(){return{lastEffect:null,events:null,stores:null,memoCache:null}},Oa={readContext:za,use:_t,useCallback:ei,useContext:ei,useEffect:ei,useImperativeHandle:ei,useLayoutEffect:ei,useInsertionEffect:ei,useMemo:ei,useReducer:ei,useRef:ei,useState:ei,useDebugValue:ei,useDeferredValue:ei,useTransition:ei,useSyncExternalStore:ei,useId:ei};Oa.useCacheRefresh=ei,Oa.useMemoCache=ei,Oa.useHostTransitionStatus=ei,Oa.useFormState=ei,Oa.useActionState=ei,Oa.useOptimistic=ei;var ho={readContext:za,use:_t,useCallback:function(m,_){return ve().memoizedState=[m,_===void 0?null:_],m},useContext:za,useEffect:gh,useImperativeHandle:function(m,_,C){C=C!=null?C.concat([m]):null,Ip(4194308,4,$o.bind(null,_,m),C)},useLayoutEffect:function(m,_){return Ip(4194308,4,m,_)},useInsertionEffect:function(m,_){Ip(4,2,m,_)},useMemo:function(m,_){var C=ve();_=_===void 0?null:_;var D=m();if(Tc){J(!0);try{m()}finally{J(!1)}}return C.memoizedState=[D,_],D},useReducer:function(m,_,C){var D=ve();if(C!==void 0){var z=C(_);if(Tc){J(!0);try{C(_)}finally{J(!1)}}}else z=_;return D.memoizedState=D.baseState=z,m={pending:null,lanes:0,dispatch:null,lastRenderedReducer:m,lastRenderedState:z},D.queue=m,m=m.dispatch=q1.bind(null,Jn,m),[D.memoizedState,m]},useRef:function(m){var _=ve();return m={current:m},_.memoizedState=m},useState:function(m){m=bs(m);var _=m.queue,C=PE.bind(null,Jn,_);return _.dispatch=C,[m.memoizedState,C]},useDebugValue:Wo,useDeferredValue:function(m,_){var C=ve();return Cu(C,m,_)},useTransition:function(){var m=bs(!1);return m=gf.bind(null,Jn,m.queue,!0,!1),ve().memoizedState=m,[!1,m]},useSyncExternalStore:function(m,_,C){var D=Jn,z=ve();if(wt){if(C===void 0)throw Error(r(407));C=C()}else{if(C=_(),Mn===null)throw Error(r(349));In&60||ci(D,_,C)}z.memoizedState=C;var Z={value:C,getSnapshot:_};return z.queue=Z,gh(gi.bind(null,D,Z,m),[m]),D.flags|=2048,xl(9,Cn.bind(null,D,Z,C,_),{destroy:void 0},null),C},useId:function(){var m=ve(),_=Mn.identifierPrefix;if(wt){var C=pe,D=he;C=(D&~(1<<32-tc(D)-1)).toString(32)+C,_=":"+_+"R"+C,C=nl++,0<C&&(_+="H"+C.toString(32)),_+=":"}else C=Ih++,_=":"+_+"r"+C.toString(32)+":";return m.memoizedState=_},useCacheRefresh:function(){return ve().memoizedState=W_.bind(null,Jn)}};ho.useMemoCache=Qe,ho.useHostTransitionStatus=vh,ho.useFormState=ls,ho.useActionState=ls,ho.useOptimistic=function(m){var _=ve();_.memoizedState=_.baseState=m;var C={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return _.queue=C,_=gd.bind(null,Jn,!0,C),C.dispatch=_,[m,_]};var ko={readContext:za,use:_t,useCallback:G1,useContext:za,useEffect:R0,useImperativeHandle:O0,useInsertionEffect:q_,useLayoutEffect:M0,useMemo:kE,useReducer:nn,useRef:la,useState:function(){return nn(Ht)},useDebugValue:Wo,useDeferredValue:function(m,_){var C=Ke();return Nm(C,Gi.memoizedState,m,_)},useTransition:function(){var m=nn(Ht)[0],_=Ke().memoizedState;return[typeof m=="boolean"?m:vt(m),_]},useSyncExternalStore:oi,useId:$_};ko.useCacheRefresh=DE,ko.useMemoCache=Qe,ko.useHostTransitionStatus=vh,ko.useFormState=bn,ko.useActionState=bn,ko.useOptimistic=function(m,_){var C=Ke();return Ki(C,Gi,m,_)};var ic={readContext:za,use:_t,useCallback:G1,useContext:za,useEffect:R0,useImperativeHandle:O0,useInsertionEffect:q_,useLayoutEffect:M0,useMemo:kE,useReducer:Sn,useRef:la,useState:function(){return Sn(Ht)},useDebugValue:Wo,useDeferredValue:function(m,_){var C=Ke();return Gi===null?Cu(C,m,_):Nm(C,Gi.memoizedState,m,_)},useTransition:function(){var m=Sn(Ht)[0],_=Ke().memoizedState;return[typeof m=="boolean"?m:vt(m),_]},useSyncExternalStore:oi,useId:$_};ic.useCacheRefresh=DE,ic.useMemoCache=Qe,ic.useHostTransitionStatus=vh,ic.useFormState=qn,ic.useActionState=qn,ic.useOptimistic=function(m,_){var C=Ke();return Gi!==null?Ki(C,Gi,m,_):(C.baseState=m,[m,C.queue.dispatch])};var Md={isMounted:function(m){return(m=m._reactInternals)?h(m)===m:!1},enqueueSetState:function(m,_,C){m=m._reactInternals;var D=Ro(),z=me(D);z.payload=_,C!=null&&(z.callback=C),_=De(m,z,D),_!==null&&(Xo(_,m,D),Ve(_,m,D))},enqueueReplaceState:function(m,_,C){m=m._reactInternals;var D=Ro(),z=me(D);z.tag=1,z.payload=_,C!=null&&(z.callback=C),_=De(m,z,D),_!==null&&(Xo(_,m,D),Ve(_,m,D))},enqueueForceUpdate:function(m,_){m=m._reactInternals;var C=Ro(),D=me(C);D.tag=2,_!=null&&(D.callback=_),_=De(m,D,C),_!==null&&(Xo(_,m,C),Ve(_,m,C))}},Od=typeof reportError=="function"?reportError:function(m){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var _=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof m=="object"&&m!==null&&typeof m.message=="string"?String(m.message):String(m),error:m});if(!window.dispatchEvent(_))return}else if(typeof zn=="object"&&typeof zn.emit=="function"){zn.emit("uncaughtException",m);return}console.error(m)},Wp=Error(r(461)),$s=!1,Mf={dehydrated:null,treeContext:null,retryLane:0},kh=y(null),qu=null,Nl=null,pv=typeof AbortController<"u"?AbortController:function(){var m=[],_=this.signal={aborted:!1,addEventListener:function(C,D){m.push(D)}};this.abort=function(){_.aborted=!0,m.forEach(function(C){return C()})}},gy=hs.unstable_scheduleCallback,mv=hs.unstable_NormalPriority,Yr={$$typeof:Lu,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0},gv=vi.S;vi.S=function(m,_){typeof _=="object"&&_!==null&&typeof _.then=="function"&&Ot(m,_),gv!==null&&gv(m,_)};var Dh=y(null),E=!1,w=!1,F=!1,Q=typeof WeakSet=="function"?WeakSet:Set,le=null,xe=!1,Pe=null,We=!1,ct=null,kt=8192,Lt={getCacheForType:function(m){var _=za(Yr),C=_.data.get(m);return C===void 0&&(C=m(),_.data.set(m,C)),C}},Wt=0,Rn=1,Un=2,ni=3,Ut=4;if(typeof Symbol=="function"&&Symbol.for){var Qt=Symbol.for;Wt=Qt("selector.component"),Rn=Qt("selector.has_pseudo_class"),Un=Qt("selector.role"),ni=Qt("selector.test_id"),Ut=Qt("selector.text")}var mi=typeof WeakMap=="function"?WeakMap:Map,Gt=0,Mn=null,on=null,In=0,ln=0,Fn=null,Cs=!1,Ls=!1,xc=!1,kr=0,pr=0,wc=0,Ql=0,vy=0,eu=0,Yp=0,Of=null,Nf=null,dx=!1,_y=0,vv=1/0,_v=null,If=null,mS=!1,Nd=null,ag=0,O8=0,N8=null,hR=0,I8=null;return Vi.attemptContinuousHydration=function(m){if(m.tag===13){var _=rt(m,67108864);_!==null&&Xo(_,m,67108864),xf(m,67108864)}},Vi.attemptHydrationAtCurrentPriority=function(m){if(m.tag===13){var _=Ro(),C=rt(m,_);C!==null&&Xo(C,m,_),xf(m,_)}},Vi.attemptSynchronousHydration=function(m){switch(m.tag){case 3:if(m=m.stateNode,m.current.memoizedState.isDehydrated){var _=x(m.pendingLanes);if(_!==0){for(m.pendingLanes|=2,m.entangledLanes|=2;_;){var C=1<<31-tc(_);m.entanglements[1]|=C,_&=~C}bt(m),!(Gt&6)&&(vv=Zn()+500,be(0))}}break;case 13:_=rt(m,2),_!==null&&Xo(_,m,2),ey(),xf(m,2)}},Vi.batchedUpdates=function(m,_){return m(_)},Vi.createComponentSelector=function(m){return{$$typeof:Wt,value:m}},Vi.createContainer=function(m,_,C,D,z,Z,Se,ze,ut,Dt){return ry(m,_,!1,null,C,D,Z,Se,ze,ut,Dt,null)},Vi.createHasPseudoClassSelector=function(m){return{$$typeof:Rn,value:m}},Vi.createHydrationContainer=function(m,_,C,D,z,Z,Se,ze,ut,Dt,en,xn,An){return m=ry(C,D,!0,m,z,Z,ze,ut,Dt,en,xn,An),m.context=qi(null),C=m.current,D=Ro(),z=me(D),z.callback=_??null,De(C,z,D),m.current.lanes=D,G(m,D),bt(m),m},Vi.createPortal=function(m,_,C){var D=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Fp,key:D==null?null:""+D,children:m,containerInfo:_,implementation:C}},Vi.createRoleSelector=function(m){return{$$typeof:Un,value:m}},Vi.createTestNameSelector=function(m){return{$$typeof:ni,value:m}},Vi.createTextSelector=function(m){return{$$typeof:Ut,value:m}},Vi.defaultOnCaughtError=function(m){console.error(m)},Vi.defaultOnRecoverableError=function(m){Od(m)},Vi.defaultOnUncaughtError=function(m){Od(m)},Vi.deferredUpdates=function(m){var _=vi.T,C=oo();try{return Ko(32),vi.T=null,m()}finally{Ko(C),vi.T=_}},Vi.discreteUpdates=function(m,_,C,D,z){var Z=vi.T,Se=oo();try{return Ko(2),vi.T=null,m(_,C,D,z)}finally{Ko(Se),vi.T=Z,Gt===0&&(vv=Zn()+500)}},Vi.findAllNodes=Td,Vi.findBoundingRects=function(m,_){if(!Ol)throw Error(r(363));_=Td(m,_),m=[];for(var C=0;C<_.length;C++)m.push(nS(_[C]));for(_=m.length-1;0<_;_--){C=m[_];for(var D=C.x,z=D+C.width,Z=C.y,Se=Z+C.height,ze=_-1;0<=ze;ze--)if(_!==ze){var ut=m[ze],Dt=ut.x,en=Dt+ut.width,xn=ut.y,An=xn+ut.height;if(D>=Dt&&Z>=xn&&z<=en&&Se<=An){m.splice(_,1);break}else if(D!==Dt||C.width!==ut.width||An<Z||xn>Se){if(!(Z!==xn||C.height!==ut.height||en<D||Dt>z)){Dt>D&&(ut.width+=Dt-D,ut.x=D),en<z&&(ut.width=z-Dt),m.splice(_,1);break}}else{xn>Z&&(ut.height+=xn-Z,ut.y=Z),An<Se&&(ut.height=Se-xn),m.splice(_,1);break}}}return m},Vi.findHostInstance=ev,Vi.findHostInstanceWithNoPortals=function(m){return m=d(m),m=m!==null?g(m):null,m===null?null:Cd(m.stateNode)},Vi.findHostInstanceWithWarning=function(m){return ev(m)},Vi.flushPassiveEffects=Ec,Vi.flushSyncFromReconciler=function(m){var _=Gt;Gt|=1;var C=vi.T,D=oo();try{if(Ko(2),vi.T=null,m)return m()}finally{Ko(D),vi.T=C,Gt=_,!(Gt&6)&&be(0)}},Vi.flushSyncWork=ey,Vi.focusWithin=function(m,_){if(!Ol)throw Error(r(363));for(m=Xl(m),_=G0(m,_),_=Array.from(_),m=0;m<_.length;){var C=_[m++],D=C.tag;if(!qp(C)){if((D===5||D===26||D===27)&&iS(C.stateNode))return!0;for(C=C.child;C!==null;)_.push(C),C=C.sibling}}return!1},Vi.getFindAllNodesFailureDescription=function(m,_){if(!Ol)throw Error(r(363));var C=0,D=[];m=[Xl(m),0];for(var z=0;z<m.length;){var Z=m[z++],Se=Z.tag,ze=m[z++],ut=_[ze];if((Se!==5&&Se!==26&&Se!==27||!qp(Z))&&(Q_(Z,ut)&&(D.push(V0(ut)),ze++,ze>C&&(C=ze)),ze<_.length))for(Z=Z.child;Z!==null;)m.push(Z,ze),Z=Z.sibling}if(C<_.length){for(m=[];C<_.length;C++)m.push(V0(_[C]));return`findAllNodes was able to match part of the selector:
  `+(D.join(" > ")+`

No matching component was found for:
  `)+m.join(" > ")}return null},Vi.getPublicRootInstance=function(m){if(m=m.current,!m.child)return null;switch(m.child.tag){case 27:case 5:return Cd(m.child.stateNode);default:return m.child.stateNode}},Vi.injectIntoDevTools=function(){var m={bundleType:0,version:iv,rendererPackageName:Sc,currentDispatcherRef:vi,findFiberByHostInstance:av,reconcilerVersion:"19.0.0"};if(Bu!==null&&(m.rendererConfig=Bu),typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u")m=!1;else{var _=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(_.isDisabled||!_.supportsFiber)m=!0;else{try{N=_.inject(m),S=_}catch{}m=!!_.checkDCE}}return m},Vi.isAlreadyRendering=function(){return!1},Vi.observeVisibleRects=function(m,_,C,D){if(!Ol)throw Error(r(363));m=Td(m,_);var z=Is(m,C,D).disconnect;return{disconnect:function(){z()}}},Vi.shouldError=function(){return null},Vi.shouldSuspend=function(){return!1},Vi.startHostTransition=function(m,_,C,D){if(m.tag!==5)throw Error(r(476));var z=xs(m).queue;gf(m,z,_,Cf,C===null?i:function(){var Z=xs(m).next.queue;return md(m,Z,{},Ro()),C(D)})},Vi.updateContainer=function(m,_,C,D){var z=_.current,Z=Ro();return ex(z,Z,m,_,C,D),Z},Vi.updateContainerSync=function(m,_,C,D){return _.tag===0&&Ec(),ex(_.current,2,m,_,C,D),2},Vi},t.exports.default=t.exports,Object.defineProperty(t.exports,"__esModule",{value:!0})})(tue);var Eke=tue.exports;eue.exports=Eke;var Ske=eue.exports;const Tke=Yc(Ske),xke=t=>typeof t=="object"&&typeof t.then=="function",UD=[];function wke(t,e,n=(i,r)=>i===r){if(t===e)return!0;if(!t||!e)return!1;const i=t.length;if(e.length!==i)return!1;for(let r=0;r<i;r++)if(!n(t[r],e[r]))return!1;return!0}function Cke(t,e=null,n=!1,i={}){e===null&&(e=[t]);for(const s of UD)if(wke(e,s.keys,s.equal)){if(n)return;if(Object.prototype.hasOwnProperty.call(s,"error"))throw s.error;if(Object.prototype.hasOwnProperty.call(s,"response"))return i.lifespan&&i.lifespan>0&&(s.timeout&&clearTimeout(s.timeout),s.timeout=setTimeout(s.remove,i.lifespan)),s.response;if(!n)throw s.promise}const r={keys:e,equal:i.equal,remove:()=>{const s=UD.indexOf(r);s!==-1&&UD.splice(s,1)},promise:(xke(t)?t:t(...e)).then(s=>{r.response=s,i.lifespan&&i.lifespan>0&&(r.timeout=setTimeout(r.remove,i.lifespan))}).catch(s=>r.error=s)};if(UD.push(r),!n)throw r.promise}const Ake=(t,e,n)=>Cke(t,e,!1,n);function V7(t,e,n){if(!t)return;if(n(t)===!0)return t;let i=e?t.return:t.child;for(;i;){const r=V7(i,e,n);if(r)return r;i=e?null:i.sibling}}function rue(t){try{return Object.defineProperties(t,{_currentRenderer:{get(){return null},set(){}},_currentRenderer2:{get(){return null},set(){}}})}catch{return t}}const G7=rue(Fe.createContext(null));let sue=class extends Fe.Component{render(){return Fe.createElement(G7.Provider,{value:this._reactInternals},this.props.children)}};function aue(){const t=Fe.useContext(G7);if(t===null)throw new Error("its-fine: useFiber must be called within a <FiberProvider />!");const e=Fe.useId();return Fe.useMemo(()=>{for(const n of[t,t==null?void 0:t.alternate]){if(!n)continue;const i=V7(n,!1,r=>{let s=r.memoizedState;for(;s;){if(s.memoizedState===e)return!0;s=s.next}});if(i)return i}},[t,e])}const Rke=Symbol.for("react.context"),Mke=t=>t!==null&&typeof t=="object"&&"$$typeof"in t&&t.$$typeof===Rke;function Oke(){const t=aue(),[e]=Fe.useState(()=>new Map);e.clear();let n=t;for(;n;){const i=n.type;Mke(i)&&i!==G7&&!e.has(i)&&e.set(i,Fe.use(rue(i))),n=n.return}return e}function Nke(){const t=Oke();return Fe.useMemo(()=>Array.from(t.keys()).reduce((e,n)=>i=>Fe.createElement(e,null,Fe.createElement(n.Provider,{...i,value:t.get(n)})),e=>Fe.createElement(sue,{...e})),[t])}function oue(t){let e=t.root;for(;e.getState().previousRoot;)e=e.getState().previousRoot;return e}const cue=t=>t&&t.isOrthographicCamera,Ike=t=>t&&t.hasOwnProperty("current"),kke=t=>t!=null&&(typeof t=="string"||typeof t=="number"||t.isColor),fI=((t,e)=>typeof window<"u"&&(((t=window.document)==null?void 0:t.createElement)||((e=window.navigator)==null?void 0:e.product)==="ReactNative"))()?Fe.useLayoutEffect:Fe.useEffect;function q7(t){const e=Fe.useRef(t);return fI(()=>void(e.current=t),[t]),e}function Dke(){const t=aue(),e=Nke();return Fe.useMemo(()=>({children:n})=>{const r=!!V7(t,!0,s=>s.type===Fe.StrictMode)?Fe.StrictMode:Fe.Fragment;return Me.jsx(r,{children:Me.jsx(e,{children:n})})},[t,e])}function Pke({set:t}){return fI(()=>(t(new Promise(()=>null)),()=>t(!1)),[t]),null}const Lke=(t=>(t=class extends Fe.Component{constructor(...n){super(...n),this.state={error:!1}}componentDidCatch(n){this.props.set(n)}render(){return this.state.error?null:this.props.children}},t.getDerivedStateFromError=()=>({error:!0}),t))();function lue(t){var e;const n=typeof window<"u"?(e=window.devicePixelRatio)!=null?e:2:1;return Array.isArray(t)?Math.min(Math.max(t[0],n),t[1]):t}function Ix(t){var e;return(e=t.__r3f)==null?void 0:e.root.getState()}const Ka={obj:t=>t===Object(t)&&!Ka.arr(t)&&typeof t!="function",fun:t=>typeof t=="function",str:t=>typeof t=="string",num:t=>typeof t=="number",boo:t=>typeof t=="boolean",und:t=>t===void 0,nul:t=>t===null,arr:t=>Array.isArray(t),equ(t,e,{arrays:n="shallow",objects:i="reference",strict:r=!0}={}){if(typeof t!=typeof e||!!t!=!!e)return!1;if(Ka.str(t)||Ka.num(t)||Ka.boo(t))return t===e;const s=Ka.obj(t);if(s&&i==="reference")return t===e;const a=Ka.arr(t);if(a&&n==="reference")return t===e;if((a||s)&&t===e)return!0;let o;for(o in t)if(!(o in e))return!1;if(s&&n==="shallow"&&i==="shallow"){for(o in r?e:t)if(!Ka.equ(t[o],e[o],{strict:r,objects:"reference"}))return!1}else for(o in r?e:t)if(t[o]!==e[o])return!1;if(Ka.und(o)){if(a&&t.length===0&&e.length===0||s&&Object.keys(t).length===0&&Object.keys(e).length===0)return!0;if(t!==e)return!1}return!0}};function Uke(t){t.type!=="Scene"&&(t.dispose==null||t.dispose());for(const e in t){const n=t[e];(n==null?void 0:n.type)!=="Scene"&&(n==null||n.dispose==null||n.dispose())}}const uue=["children","key","ref"];function Bke(t){const e={};for(const n in t)uue.includes(n)||(e[n]=t[n]);return e}function XL(t,e,n,i){const r=t;let s=r==null?void 0:r.__r3f;return s||(s={root:e,type:n,parent:null,children:[],props:Bke(i),object:r,eventCount:0,handlers:{},isHidden:!1},r&&(r.__r3f=s)),s}function CO(t,e){let n=t[e];if(!e.includes("-"))return{root:t,key:e,target:n};n=t;for(const r of e.split("-")){var i;e=r,t=n,n=(i=n)==null?void 0:i[e]}return{root:t,key:e,target:n}}const YJ=/-\d+$/;function KL(t,e){if(Ka.str(e.props.attach)){if(YJ.test(e.props.attach)){const r=e.props.attach.replace(YJ,""),{root:s,key:a}=CO(t.object,r);Array.isArray(s[a])||(s[a]=[])}const{root:n,key:i}=CO(t.object,e.props.attach);e.previousAttach=n[i],n[i]=e.object}else Ka.fun(e.props.attach)&&(e.previousAttach=e.props.attach(t.object,e.object))}function ZL(t,e){if(Ka.str(e.props.attach)){const{root:n,key:i}=CO(t.object,e.props.attach),r=e.previousAttach;r===void 0?delete n[i]:n[i]=r}else e.previousAttach==null||e.previousAttach(t.object,e.object);delete e.previousAttach}const AV=[...uue,"args","dispose","attach","object","onUpdate","dispose"],XJ=new Map;function Fke(t){let e=XJ.get(t.constructor);try{e||(e=new t.constructor,XJ.set(t.constructor,e))}catch{}return e}function zke(t,e){const n={};for(const i in e)if(!AV.includes(i)&&!Ka.equ(e[i],t.props[i])){n[i]=e[i];for(const r in e)r.startsWith(`${i}-`)&&(n[r]=e[r])}for(const i in t.props){if(AV.includes(i)||e.hasOwnProperty(i))continue;const{root:r,key:s}=CO(t.object,i);if(r.constructor&&r.constructor.length===0){const a=Fke(r);Ka.und(a)||(n[s]=a[s])}else n[s]=0}return n}const Hke=["map","emissiveMap","sheenColorMap","specularColorMap","envMap"],jke=/^on(Pointer|Click|DoubleClick|ContextMenu|Wheel)/;function ib(t,e){var n;const i=t.__r3f,r=i&&oue(i).getState(),s=i==null?void 0:i.eventCount;for(const o in e){let c=e[o];if(AV.includes(o))continue;if(i&&jke.test(o)){typeof c=="function"?i.handlers[o]=c:delete i.handlers[o],i.eventCount=Object.keys(i.handlers).length;continue}if(c===void 0)continue;let{root:l,key:u,target:h}=CO(t,o);if(h instanceof bC&&c instanceof bC)h.mask=c.mask;else if(h instanceof yn&&kke(c))h.set(c);else if(h!==null&&typeof h=="object"&&typeof h.set=="function"&&typeof h.copy=="function"&&c!=null&&c.constructor&&h.constructor===c.constructor)h.copy(c);else if(h!==null&&typeof h=="object"&&typeof h.set=="function"&&Array.isArray(c))typeof h.fromArray=="function"?h.fromArray(c):h.set(...c);else if(h!==null&&typeof h=="object"&&typeof h.set=="function"&&typeof c=="number")typeof h.setScalar=="function"?h.setScalar(c):h.set(c);else{var a;l[u]=c,r&&!r.linear&&Hke.includes(u)&&(a=l[u])!=null&&a.isTexture&&l[u].format===fu&&l[u].type===El&&(l[u].colorSpace=ba)}}if(i!=null&&i.parent&&r!=null&&r.internal&&(n=i.object)!=null&&n.isObject3D&&s!==i.eventCount){const o=i.object,c=r.internal.interaction.indexOf(o);c>-1&&r.internal.interaction.splice(c,1),i.eventCount&&o.raycast!==null&&r.internal.interaction.push(o)}return i&&i.props.attach===void 0&&(i.object.isBufferGeometry?i.props.attach="geometry":i.object.isMaterial&&(i.props.attach="material")),i&&xA(i),t}function xA(t){var e;if(!t.parent)return;t.props.onUpdate==null||t.props.onUpdate(t.object);const n=(e=t.root)==null||e.getState==null?void 0:e.getState();n&&n.internal.frames===0&&n.invalidate()}function hue(t,e){t.manual||(cue(t)?(t.left=e.width/-2,t.right=e.width/2,t.top=e.height/2,t.bottom=e.height/-2):t.aspect=e.width/e.height,t.updateProjectionMatrix())}const jh=t=>t==null?void 0:t.isObject3D;function BD(t){return(t.eventObject||t.object).uuid+"/"+t.index+t.instanceId}function fue(t,e,n,i){const r=n.get(e);r&&(n.delete(e),n.size===0&&(t.delete(i),r.target.releasePointerCapture(i)))}function Vke(t,e){const{internal:n}=t.getState();n.interaction=n.interaction.filter(i=>i!==e),n.initialHits=n.initialHits.filter(i=>i!==e),n.hovered.forEach((i,r)=>{(i.eventObject===e||i.object===e)&&n.hovered.delete(r)}),n.capturedMap.forEach((i,r)=>{fue(n.capturedMap,e,i,r)})}function Gke(t){function e(c){const{internal:l}=t.getState(),u=c.offsetX-l.initialClick[0],h=c.offsetY-l.initialClick[1];return Math.round(Math.sqrt(u*u+h*h))}function n(c){return c.filter(l=>["Move","Over","Enter","Out","Leave"].some(u=>{var h;return(h=l.__r3f)==null?void 0:h.handlers["onPointer"+u]}))}function i(c,l){const u=t.getState(),h=new Set,f=[],d=l?l(u.internal.interaction):u.internal.interaction;for(let v=0;v<d.length;v++){const b=Ix(d[v]);b&&(b.raycaster.camera=void 0)}u.previousRoot||u.events.compute==null||u.events.compute(c,u);function p(v){const b=Ix(v);if(!b||!b.events.enabled||b.raycaster.camera===null)return[];if(b.raycaster.camera===void 0){var T;b.events.compute==null||b.events.compute(c,b,(T=b.previousRoot)==null?void 0:T.getState()),b.raycaster.camera===void 0&&(b.raycaster.camera=null)}return b.raycaster.camera?b.raycaster.intersectObject(v,!0):[]}let g=d.flatMap(p).sort((v,b)=>{const T=Ix(v.object),x=Ix(b.object);return!T||!x?v.distance-b.distance:x.events.priority-T.events.priority||v.distance-b.distance}).filter(v=>{const b=BD(v);return h.has(b)?!1:(h.add(b),!0)});u.events.filter&&(g=u.events.filter(g,u));for(const v of g){let b=v.object;for(;b;){var y;(y=b.__r3f)!=null&&y.eventCount&&f.push({...v,eventObject:b}),b=b.parent}}if("pointerId"in c&&u.internal.capturedMap.has(c.pointerId))for(let v of u.internal.capturedMap.get(c.pointerId).values())h.has(BD(v.intersection))||f.push(v.intersection);return f}function r(c,l,u,h){if(c.length){const f={stopped:!1};for(const d of c){let p=Ix(d.object);if(p||d.object.traverseAncestors(g=>{const y=Ix(g);if(y)return p=y,!1}),p){const{raycaster:g,pointer:y,camera:v,internal:b}=p,T=new Ae(y.x,y.y,0).unproject(v),x=P=>{var U,G;return(U=(G=b.capturedMap.get(P))==null?void 0:G.has(d.eventObject))!=null?U:!1},M=P=>{const U={intersection:d,target:l.target};b.capturedMap.has(P)?b.capturedMap.get(P).set(d.eventObject,U):b.capturedMap.set(P,new Map([[d.eventObject,U]])),l.target.setPointerCapture(P)},R=P=>{const U=b.capturedMap.get(P);U&&fue(b.capturedMap,d.eventObject,U,P)};let I={};for(let P in l){let U=l[P];typeof U!="function"&&(I[P]=U)}let k={...d,...I,pointer:y,intersections:c,stopped:f.stopped,delta:u,unprojectedPoint:T,ray:g.ray,camera:v,stopPropagation(){const P="pointerId"in l&&b.capturedMap.get(l.pointerId);if((!P||P.has(d.eventObject))&&(k.stopped=f.stopped=!0,b.hovered.size&&Array.from(b.hovered.values()).find(U=>U.eventObject===d.eventObject))){const U=c.slice(0,c.indexOf(d));s([...U,d])}},target:{hasPointerCapture:x,setPointerCapture:M,releasePointerCapture:R},currentTarget:{hasPointerCapture:x,setPointerCapture:M,releasePointerCapture:R},nativeEvent:l};if(h(k),f.stopped===!0)break}}}return c}function s(c){const{internal:l}=t.getState();for(const u of l.hovered.values())if(!c.length||!c.find(h=>h.object===u.object&&h.index===u.index&&h.instanceId===u.instanceId)){const f=u.eventObject.__r3f;if(l.hovered.delete(BD(u)),f!=null&&f.eventCount){const d=f.handlers,p={...u,intersections:c};d.onPointerOut==null||d.onPointerOut(p),d.onPointerLeave==null||d.onPointerLeave(p)}}}function a(c,l){for(let u=0;u<l.length;u++){const h=l[u].__r3f;h==null||h.handlers.onPointerMissed==null||h.handlers.onPointerMissed(c)}}function o(c){switch(c){case"onPointerLeave":case"onPointerCancel":return()=>s([]);case"onLostPointerCapture":return l=>{const{internal:u}=t.getState();"pointerId"in l&&u.capturedMap.has(l.pointerId)&&requestAnimationFrame(()=>{u.capturedMap.has(l.pointerId)&&(u.capturedMap.delete(l.pointerId),s([]))})}}return function(u){const{onPointerMissed:h,internal:f}=t.getState();f.lastEvent.current=u;const d=c==="onPointerMove",p=c==="onClick"||c==="onContextMenu"||c==="onDoubleClick",y=i(u,d?n:void 0),v=p?e(u):0;c==="onPointerDown"&&(f.initialClick=[u.offsetX,u.offsetY],f.initialHits=y.map(T=>T.eventObject)),p&&!y.length&&v<=2&&(a(u,f.interaction),h&&h(u)),d&&s(y);function b(T){const x=T.eventObject,M=x.__r3f;if(!(M!=null&&M.eventCount))return;const R=M.handlers;if(d){if(R.onPointerOver||R.onPointerEnter||R.onPointerOut||R.onPointerLeave){const I=BD(T),k=f.hovered.get(I);k?k.stopped&&T.stopPropagation():(f.hovered.set(I,T),R.onPointerOver==null||R.onPointerOver(T),R.onPointerEnter==null||R.onPointerEnter(T))}R.onPointerMove==null||R.onPointerMove(T)}else{const I=R[c];I?(!p||f.initialHits.includes(x))&&(a(u,f.interaction.filter(k=>!f.initialHits.includes(k))),I(T)):p&&f.initialHits.includes(x)&&a(u,f.interaction.filter(k=>!f.initialHits.includes(k)))}}r(y,u,v,b)}}return{handlePointer:o}}const KJ=t=>!!(t!=null&&t.render),$7=Fe.createContext(null),qke=(t,e)=>{const n=Qle((o,c)=>{const l=new Ae,u=new Ae,h=new Ae;function f(v=c().camera,b=u,T=c().size){const{width:x,height:M,top:R,left:I}=T,k=x/M;b.isVector3?h.copy(b):h.set(...b);const P=v.getWorldPosition(l).distanceTo(h);if(cue(v))return{width:x/v.zoom,height:M/v.zoom,top:R,left:I,factor:1,distance:P,aspect:k};{const U=v.fov*Math.PI/180,G=2*Math.tan(U/2)*P,$=G*(x/M);return{width:$,height:G,top:R,left:I,factor:x/$,distance:P,aspect:k}}}let d;const p=v=>o(b=>({performance:{...b.performance,current:v}})),g=new Rt;return{set:o,get:c,gl:null,camera:null,raycaster:null,events:{priority:1,enabled:!0,connected:!1},scene:null,xr:null,invalidate:(v=1)=>t(c(),v),advance:(v,b)=>e(v,b,c()),legacy:!1,linear:!1,flat:!1,controls:null,clock:new I7,pointer:g,mouse:g,frameloop:"always",onPointerMissed:void 0,performance:{current:1,min:.5,max:1,debounce:200,regress:()=>{const v=c();d&&clearTimeout(d),v.performance.current!==v.performance.min&&p(v.performance.min),d=setTimeout(()=>p(c().performance.max),v.performance.debounce)}},size:{width:0,height:0,top:0,left:0},viewport:{initialDpr:0,dpr:0,width:0,height:0,top:0,left:0,aspect:0,distance:0,factor:0,getCurrentViewport:f},setEvents:v=>o(b=>({...b,events:{...b.events,...v}})),setSize:(v,b,T=0,x=0)=>{const M=c().camera,R={width:v,height:b,top:T,left:x};o(I=>({size:R,viewport:{...I.viewport,...f(M,u,R)}}))},setDpr:v=>o(b=>{const T=lue(v);return{viewport:{...b.viewport,dpr:T,initialDpr:b.viewport.initialDpr||T}}}),setFrameloop:(v="always")=>{const b=c().clock;b.stop(),b.elapsedTime=0,v!=="never"&&(b.start(),b.elapsedTime=0),o(()=>({frameloop:v}))},previousRoot:void 0,internal:{interaction:[],hovered:new Map,subscribers:[],initialClick:[0,0],initialHits:[],capturedMap:new Map,lastEvent:Fe.createRef(),active:!1,frames:0,priority:0,subscribe:(v,b,T)=>{const x=c().internal;return x.priority=x.priority+(b>0?1:0),x.subscribers.push({ref:v,priority:b,store:T}),x.subscribers=x.subscribers.sort((M,R)=>M.priority-R.priority),()=>{const M=c().internal;M!=null&&M.subscribers&&(M.priority=M.priority-(b>0?1:0),M.subscribers=M.subscribers.filter(R=>R.ref!==v))}}}}}),i=n.getState();let r=i.size,s=i.viewport.dpr,a=i.camera;return n.subscribe(()=>{const{camera:o,size:c,viewport:l,gl:u,set:h}=n.getState();if(c.width!==r.width||c.height!==r.height||l.dpr!==s){r=c,s=l.dpr,hue(o,c),l.dpr>0&&u.setPixelRatio(l.dpr);const f=typeof HTMLCanvasElement<"u"&&u.domElement instanceof HTMLCanvasElement;u.setSize(c.width,c.height,f)}o!==a&&(a=o,h(f=>({viewport:{...f.viewport,...f.viewport.getCurrentViewport(o)}})))}),n.subscribe(o=>t(o)),n};function W7(){const t=Fe.useContext($7);if(!t)throw new Error("R3F: Hooks can only be used within the Canvas component!");return t}function oh(t=n=>n,e){return W7()(t,e)}function gE(t,e=0){const n=W7(),i=n.getState().internal.subscribe,r=q7(t);return fI(()=>i(r,e,n),[e,i,n]),null}function $ke(t){const e=Tke(t);return e.injectIntoDevTools({bundleType:(typeof zn<"u",0),rendererPackageName:"@react-three/fiber",version:Fe.version}),e}const due=0,CC={},Wke=/^three(?=[A-Z])/,GB=t=>`${t[0].toUpperCase()}${t.slice(1)}`;let Yke=0;const Xke=t=>typeof t=="function";function pue(t){if(Xke(t)){const e=`${Yke++}`;return CC[e]=t,e}else Object.assign(CC,t)}function mue(t,e){const n=GB(t),i=CC[n];if(t!=="primitive"&&!i)throw new Error(`R3F: ${n} is not part of the THREE namespace! Did you forget to extend? See: https://docs.pmnd.rs/react-three-fiber/api/objects#using-3rd-party-objects-declaratively`);if(t==="primitive"&&!e.object)throw new Error("R3F: Primitives without 'object' are invalid!");if(e.args!==void 0&&!Array.isArray(e.args))throw new Error("R3F: The args prop must be an array!")}function Kke(t,e,n){var i;return t=GB(t)in CC?t:t.replace(Wke,""),mue(t,e),t==="primitive"&&(i=e.object)!=null&&i.__r3f&&delete e.object.__r3f,XL(e.object,n,t,e)}function Zke(t){if(!t.isHidden){var e;t.props.attach&&(e=t.parent)!=null&&e.object?ZL(t.parent,t):jh(t.object)&&(t.object.visible=!1),t.isHidden=!0,xA(t)}}function gue(t){if(t.isHidden){var e;t.props.attach&&(e=t.parent)!=null&&e.object?KL(t.parent,t):jh(t.object)&&t.props.visible!==!1&&(t.object.visible=!0),t.isHidden=!1,xA(t)}}function Y7(t,e,n){const i=e.root.getState();if(!(!t.parent&&t.object!==i.scene)){if(!e.object){var r,s;const a=CC[GB(e.type)];e.object=(r=e.props.object)!=null?r:new a(...(s=e.props.args)!=null?s:[]),e.object.__r3f=e}if(ib(e.object,e.props),e.props.attach)KL(t,e);else if(jh(e.object)&&jh(t.object)){const a=t.object.children.indexOf(n==null?void 0:n.object);if(n&&a!==-1){const o=t.object.children.indexOf(e.object);if(o!==-1){t.object.children.splice(o,1);const c=o<a?a-1:a;t.object.children.splice(c,0,e.object)}else e.object.parent=t.object,t.object.children.splice(a,0,e.object),e.object.dispatchEvent({type:"added"}),t.object.dispatchEvent({type:"childadded",child:e.object})}else t.object.add(e.object)}for(const a of e.children)Y7(e,a);xA(e)}}function EH(t,e){e&&(e.parent=t,t.children.push(e),Y7(t,e))}function ZJ(t,e,n){if(!e||!n)return;e.parent=t;const i=t.children.indexOf(n);i!==-1?t.children.splice(i,0,e):t.children.push(e),Y7(t,e,n)}function vue(t){if(typeof t.dispose=="function"){const e=()=>{try{t.dispose()}catch{}};typeof IS_REACT_ACT_ENVIRONMENT<"u"?e():CV.unstable_scheduleCallback(CV.unstable_IdlePriority,e)}}function RV(t,e,n){if(!e)return;e.parent=null;const i=t.children.indexOf(e);i!==-1&&t.children.splice(i,1),e.props.attach?ZL(t,e):jh(e.object)&&jh(t.object)&&(t.object.remove(e.object),Vke(oue(e),e.object));const r=e.props.dispose!==null&&n!==!1;for(let s=e.children.length-1;s>=0;s--){const a=e.children[s];RV(e,a,r)}e.children.length=0,delete e.object.__r3f,r&&e.type!=="primitive"&&e.object.type!=="Scene"&&vue(e.object),n===void 0&&xA(e)}function Jke(t,e){for(const n of[t,t.alternate])if(n!==null)if(typeof n.ref=="function"){n.refCleanup==null||n.refCleanup();const i=n.ref(e);typeof i=="function"&&(n.refCleanup=i)}else n.ref&&(n.ref.current=e)}const e2=[];function Qke(){for(const[n]of e2){const i=n.parent;if(i){n.props.attach?ZL(i,n):jh(n.object)&&jh(i.object)&&i.object.remove(n.object);for(const r of n.children)r.props.attach?ZL(n,r):jh(r.object)&&jh(n.object)&&n.object.remove(r.object)}n.isHidden&&gue(n),n.object.__r3f&&delete n.object.__r3f,n.type!=="primitive"&&vue(n.object)}for(const[n,i,r]of e2){n.props=i;const s=n.parent;if(s){var t,e;const a=CC[GB(n.type)];n.object=(t=n.props.object)!=null?t:new a(...(e=n.props.args)!=null?e:[]),n.object.__r3f=n,Jke(r,n.object),ib(n.object,n.props),n.props.attach?KL(s,n):jh(n.object)&&jh(s.object)&&s.object.add(n.object);for(const o of n.children)o.props.attach?KL(n,o):jh(o.object)&&jh(n.object)&&n.object.add(o.object);xA(n)}}e2.length=0}const SH=()=>{},JJ={};let FD=due;const eDe=0,tDe=4,JL=$ke({isPrimaryRenderer:!1,warnsIfNotActing:!1,supportsMutation:!0,supportsPersistence:!1,supportsHydration:!1,createInstance:Kke,removeChild:RV,appendChild:EH,appendInitialChild:EH,insertBefore:ZJ,appendChildToContainer(t,e){const n=t.getState().scene.__r3f;!e||!n||EH(n,e)},removeChildFromContainer(t,e){const n=t.getState().scene.__r3f;!e||!n||RV(n,e)},insertInContainerBefore(t,e,n){const i=t.getState().scene.__r3f;!e||!n||!i||ZJ(i,e,n)},getRootHostContext:()=>JJ,getChildHostContext:()=>JJ,commitUpdate(t,e,n,i,r){var s,a,o;mue(e,i);let c=!1;if((t.type==="primitive"&&n.object!==i.object||((s=i.args)==null?void 0:s.length)!==((a=n.args)==null?void 0:a.length)||(o=i.args)!=null&&o.some((u,h)=>{var f;return u!==((f=n.args)==null?void 0:f[h])}))&&(c=!0),c)e2.push([t,{...i},r]);else{const u=zke(t,i);Object.keys(u).length&&(Object.assign(t.props,u),ib(t.object,u))}(r.sibling===null||(r.flags&tDe)===eDe)&&Qke()},finalizeInitialChildren:()=>!1,commitMount(){},getPublicInstance:t=>t==null?void 0:t.object,prepareForCommit:()=>null,preparePortalMount:t=>XL(t.getState().scene,t,"",{}),resetAfterCommit:()=>{},shouldSetTextContent:()=>!1,clearContainer:()=>!1,hideInstance:Zke,unhideInstance:gue,createTextInstance:SH,hideTextInstance:SH,unhideTextInstance:SH,scheduleTimeout:typeof setTimeout=="function"?setTimeout:void 0,cancelTimeout:typeof clearTimeout=="function"?clearTimeout:void 0,noTimeout:-1,getInstanceFromNode:()=>null,beforeActiveInstanceBlur(){},afterActiveInstanceBlur(){},detachDeletedInstance(){},prepareScopeUpdate(){},getInstanceFromScope:()=>null,shouldAttemptEagerTransition:()=>!1,trackSchedulerEvent:()=>{},resolveEventType:()=>null,resolveEventTimeStamp:()=>-1.1,requestPostPaintCallback(){},maySuspendCommit:()=>!1,preloadInstance:()=>!0,startSuspendingCommit(){},suspendInstance(){},waitForCommitToBeReady:()=>null,NotPendingTransition:null,HostTransitionContext:Fe.createContext(null),setCurrentUpdatePriority(t){FD=t},getCurrentUpdatePriority(){return FD},resolveUpdatePriority(){var t;if(FD!==due)return FD;switch(typeof window<"u"&&((t=window.event)==null?void 0:t.type)){case"click":case"contextmenu":case"dblclick":case"pointercancel":case"pointerdown":case"pointerup":return QP.DiscreteEventPriority;case"pointermove":case"pointerout":case"pointerover":case"pointerenter":case"pointerleave":case"wheel":return QP.ContinuousEventPriority;default:return QP.DefaultEventPriority}},resetFormInstance(){}}),LT=new Map,kx={objects:"shallow",strict:!1};function nDe(t,e){if(!e&&typeof HTMLCanvasElement<"u"&&t instanceof HTMLCanvasElement&&t.parentElement){const{width:n,height:i,top:r,left:s}=t.parentElement.getBoundingClientRect();return{width:n,height:i,top:r,left:s}}else if(!e&&typeof OffscreenCanvas<"u"&&t instanceof OffscreenCanvas)return{width:t.width,height:t.height,top:0,left:0};return{width:0,height:0,top:0,left:0,...e}}function iDe(t){const e=LT.get(t),n=e==null?void 0:e.fiber,i=e==null?void 0:e.store;e&&console.warn("R3F.createRoot should only be called once!");const r=typeof reportError=="function"?reportError:console.error,s=i||qke(NV,eQ),a=n||JL.createContainer(s,QP.ConcurrentRoot,null,!1,null,"",r,r,r,null);e||LT.set(t,{fiber:a,store:s});let o,c,l=!1,u=null;return{async configure(h={}){let f;u=new Promise(fe=>f=fe);let{gl:d,size:p,scene:g,events:y,onCreated:v,shadows:b=!1,linear:T=!1,flat:x=!1,legacy:M=!1,orthographic:R=!1,frameloop:I="always",dpr:k=[1,2],performance:P,raycaster:U,camera:G,onPointerMissed:$}=h,q=s.getState(),Y=q.gl;if(!q.gl){const fe={canvas:t,powerPreference:"high-performance",antialias:!0,alpha:!0},Re=typeof d=="function"?await d(fe):d;KJ(Re)?Y=Re:Y=new zle({...fe,...d}),q.set({gl:Y})}let ie=q.raycaster;ie||q.set({raycaster:ie=new P7});const{params:V,...J}=U||{};if(Ka.equ(J,ie,kx)||ib(ie,{...J}),Ka.equ(V,ie.params,kx)||ib(ie,{params:{...ie.params,...V}}),!q.camera||q.camera===c&&!Ka.equ(c,G,kx)){c=G;const fe=G==null?void 0:G.isCamera,Re=fe?G:R?new hI(0,0,0,0,.1,1e3):new Pc(75,0,.1,1e3);fe||(Re.position.z=5,G&&(ib(Re,G),Re.manual||("aspect"in G||"left"in G||"right"in G||"bottom"in G||"top"in G)&&(Re.manual=!0,Re.updateProjectionMatrix())),!q.camera&&!(G!=null&&G.rotation)&&Re.lookAt(0,0,0)),q.set({camera:Re}),ie.camera=Re}if(!q.scene){let fe;g!=null&&g.isScene?(fe=g,XL(fe,s,"",{})):(fe=new SC,XL(fe,s,"",{}),g&&ib(fe,g)),q.set({scene:fe})}y&&!q.events.handlers&&q.set({events:y(s)});const X=nDe(t,p);if(Ka.equ(X,q.size,kx)||q.setSize(X.width,X.height,X.top,X.left),k&&q.viewport.dpr!==lue(k)&&q.setDpr(k),q.frameloop!==I&&q.setFrameloop(I),q.onPointerMissed||q.set({onPointerMissed:$}),P&&!Ka.equ(P,q.performance,kx)&&q.set(fe=>({performance:{...fe.performance,...P}})),!q.xr){var ee;const fe=(Te,Le)=>{const we=s.getState();we.frameloop!=="never"&&eQ(Te,!0,we,Le)},Re=()=>{const Te=s.getState();Te.gl.xr.enabled=Te.gl.xr.isPresenting,Te.gl.xr.setAnimationLoop(Te.gl.xr.isPresenting?fe:null),Te.gl.xr.isPresenting||NV(Te)},He={connect(){const Te=s.getState().gl;Te.xr.addEventListener("sessionstart",Re),Te.xr.addEventListener("sessionend",Re)},disconnect(){const Te=s.getState().gl;Te.xr.removeEventListener("sessionstart",Re),Te.xr.removeEventListener("sessionend",Re)}};typeof((ee=Y.xr)==null?void 0:ee.addEventListener)=="function"&&He.connect(),q.set({xr:He})}if(Y.shadowMap){const fe=Y.shadowMap.enabled,Re=Y.shadowMap.type;if(Y.shadowMap.enabled=!!b,Ka.boo(b))Y.shadowMap.type=vM;else if(Ka.str(b)){var oe;const He={basic:joe,percentage:fB,soft:vM,variance:em};Y.shadowMap.type=(oe=He[b])!=null?oe:vM}else Ka.obj(b)&&Object.assign(Y.shadowMap,b);(fe!==Y.shadowMap.enabled||Re!==Y.shadowMap.type)&&(Y.shadowMap.needsUpdate=!0)}return Ur.enabled=!M,l||(Y.outputColorSpace=T?Qg:ba,Y.toneMapping=x?hm:Q$),q.legacy!==M&&q.set(()=>({legacy:M})),q.linear!==T&&q.set(()=>({linear:T})),q.flat!==x&&q.set(()=>({flat:x})),d&&!Ka.fun(d)&&!KJ(d)&&!Ka.equ(d,Y,kx)&&ib(Y,d),o=v,l=!0,f(),this},render(h){return!l&&!u&&this.configure(),u.then(()=>{JL.updateContainer(Me.jsx(rDe,{store:s,children:h,onCreated:o,rootElement:t}),a,null,()=>{})}),s},unmount(){_ue(t)}}}function rDe({store:t,children:e,onCreated:n,rootElement:i}){return fI(()=>{const r=t.getState();r.set(s=>({internal:{...s.internal,active:!0}})),n&&n(r),t.getState().events.connected||r.events.connect==null||r.events.connect(i)},[]),Me.jsx($7.Provider,{value:t,children:e})}function _ue(t,e){const n=LT.get(t),i=n==null?void 0:n.fiber;if(i){const r=n==null?void 0:n.store.getState();r&&(r.internal.active=!1),JL.updateContainer(null,i,null,()=>{r&&setTimeout(()=>{try{var s,a,o,c;r.events.disconnect==null||r.events.disconnect(),(s=r.gl)==null||(a=s.renderLists)==null||a.dispose==null||a.dispose(),(o=r.gl)==null||o.forceContextLoss==null||o.forceContextLoss(),(c=r.gl)!=null&&c.xr&&r.xr.disconnect(),Uke(r.scene),LT.delete(t)}catch{}},500)})}}function sDe(t,e,n){return Me.jsx(aDe,{children:t,container:e,state:n})}function aDe({state:t={},children:e,container:n}){const{events:i,size:r,...s}=t,a=W7(),[o]=Fe.useState(()=>new P7),[c]=Fe.useState(()=>new Rt),l=q7((h,f)=>{let d;if(f.camera&&r){const p=f.camera;d=h.viewport.getCurrentViewport(p,new Ae,r),p!==h.camera&&hue(p,r)}return{...h,...f,scene:n,raycaster:o,pointer:c,mouse:c,previousRoot:a,events:{...h.events,...f.events,...i},size:{...h.size,...r},viewport:{...h.viewport,...d},setEvents:p=>f.set(g=>({...g,events:{...g.events,...p}}))}}),u=Fe.useMemo(()=>{const h=Qle((d,p)=>({...s,set:d,get:p})),f=d=>h.setState(p=>l.current(d,p));return f(a.getState()),a.subscribe(f),h},[a,n]);return Me.jsx(Me.Fragment,{children:JL.createPortal(Me.jsx($7.Provider,{value:u,children:e}),u,null)})}function yue(t,e){const n={callback:t};return e.add(n),()=>void e.delete(n)}const bue=new Set,Eue=new Set,oDe=new Set,cDe=t=>yue(t,bue),lDe=t=>yue(t,Eue);function TH(t,e){if(t.size)for(const{callback:n}of t.values())n(e)}function AM(t,e){switch(t){case"before":return TH(bue,e);case"after":return TH(Eue,e);case"tail":return TH(oDe,e)}}let xH,wH;function MV(t,e,n){let i=e.clock.getDelta();e.frameloop==="never"&&typeof t=="number"&&(i=t-e.clock.elapsedTime,e.clock.oldTime=e.clock.elapsedTime,e.clock.elapsedTime=t),xH=e.internal.subscribers;for(let r=0;r<xH.length;r++)wH=xH[r],wH.ref.current(wH.store.getState(),i,n);return!e.internal.priority&&e.gl.render&&e.gl.render(e.scene,e.camera),e.internal.frames=Math.max(0,e.internal.frames-1),e.frameloop==="always"?1:e.internal.frames}let QL=!1,OV=!1,CH,QJ,Dx;function Sue(t){QJ=requestAnimationFrame(Sue),QL=!0,CH=0,AM("before",t),OV=!0;for(const n of LT.values()){var e;Dx=n.store.getState(),Dx.internal.active&&(Dx.frameloop==="always"||Dx.internal.frames>0)&&!((e=Dx.gl.xr)!=null&&e.isPresenting)&&(CH+=MV(t,Dx))}if(OV=!1,AM("after",t),CH===0)return AM("tail",t),QL=!1,cancelAnimationFrame(QJ)}function NV(t,e=1){var n;if(!t)return LT.forEach(i=>NV(i.store.getState(),e));(n=t.gl.xr)!=null&&n.isPresenting||!t.internal.active||t.frameloop==="never"||(e>1?t.internal.frames=Math.min(60,t.internal.frames+e):OV?t.internal.frames=2:t.internal.frames=1,QL||(QL=!0,requestAnimationFrame(Sue)))}function eQ(t,e=!0,n,i){if(e&&AM("before",t),n)MV(t,n,i);else for(const r of LT.values())MV(t,r.store.getState());e&&AM("after",t)}const AH={onClick:["click",!1],onContextMenu:["contextmenu",!1],onDoubleClick:["dblclick",!1],onWheel:["wheel",!0],onPointerDown:["pointerdown",!0],onPointerUp:["pointerup",!0],onPointerLeave:["pointerleave",!0],onPointerMove:["pointermove",!0],onPointerCancel:["pointercancel",!0],onLostPointerCapture:["lostpointercapture",!0]};function Tue(t){const{handlePointer:e}=Gke(t);return{priority:1,enabled:!0,compute(n,i,r){i.pointer.set(n.offsetX/i.size.width*2-1,-(n.offsetY/i.size.height)*2+1),i.raycaster.setFromCamera(i.pointer,i.camera)},connected:void 0,handlers:Object.keys(AH).reduce((n,i)=>({...n,[i]:e(i)}),{}),update:()=>{var n;const{events:i,internal:r}=t.getState();(n=r.lastEvent)!=null&&n.current&&i.handlers&&i.handlers.onPointerMove(r.lastEvent.current)},connect:n=>{const{set:i,events:r}=t.getState();if(r.disconnect==null||r.disconnect(),i(s=>({events:{...s.events,connected:n}})),r.handlers)for(const s in r.handlers){const a=r.handlers[s],[o,c]=AH[s];n.addEventListener(o,a,{passive:c})}},disconnect:()=>{const{set:n,events:i}=t.getState();if(i.connected){if(i.handlers)for(const r in i.handlers){const s=i.handlers[r],[a]=AH[r];i.connected.removeEventListener(a,s)}n(r=>({events:{...r.events,connected:void 0}}))}}}}function tQ(t,e){let n;return(...i)=>{window.clearTimeout(n),n=window.setTimeout(()=>t(...i),e)}}function uDe({debounce:t,scroll:e,polyfill:n,offsetSize:i}={debounce:0,scroll:!1,offsetSize:!1}){const r=n||(typeof window>"u"?class{}:window.ResizeObserver);if(!r)throw new Error("This browser does not support ResizeObserver out of the box. See: https://github.com/react-spring/react-use-measure/#resize-observer-polyfills");const[s,a]=Fe.useState({left:0,top:0,width:0,height:0,bottom:0,right:0,x:0,y:0}),o=Fe.useRef({element:null,scrollContainers:null,resizeObserver:null,lastBounds:s,orientationHandler:null}),c=t?typeof t=="number"?t:t.scroll:null,l=t?typeof t=="number"?t:t.resize:null,u=Fe.useRef(!1);Fe.useEffect(()=>(u.current=!0,()=>void(u.current=!1)));const[h,f,d]=Fe.useMemo(()=>{const v=()=>{if(!o.current.element)return;const{left:b,top:T,width:x,height:M,bottom:R,right:I,x:k,y:P}=o.current.element.getBoundingClientRect(),U={left:b,top:T,width:x,height:M,bottom:R,right:I,x:k,y:P};o.current.element instanceof HTMLElement&&i&&(U.height=o.current.element.offsetHeight,U.width=o.current.element.offsetWidth),Object.freeze(U),u.current&&!pDe(o.current.lastBounds,U)&&a(o.current.lastBounds=U)};return[v,l?tQ(v,l):v,c?tQ(v,c):v]},[a,i,c,l]);function p(){o.current.scrollContainers&&(o.current.scrollContainers.forEach(v=>v.removeEventListener("scroll",d,!0)),o.current.scrollContainers=null),o.current.resizeObserver&&(o.current.resizeObserver.disconnect(),o.current.resizeObserver=null),o.current.orientationHandler&&("orientation"in screen&&"removeEventListener"in screen.orientation?screen.orientation.removeEventListener("change",o.current.orientationHandler):"onorientationchange"in window&&window.removeEventListener("orientationchange",o.current.orientationHandler))}function g(){o.current.element&&(o.current.resizeObserver=new r(d),o.current.resizeObserver.observe(o.current.element),e&&o.current.scrollContainers&&o.current.scrollContainers.forEach(v=>v.addEventListener("scroll",d,{capture:!0,passive:!0})),o.current.orientationHandler=()=>{d()},"orientation"in screen&&"addEventListener"in screen.orientation?screen.orientation.addEventListener("change",o.current.orientationHandler):"onorientationchange"in window&&window.addEventListener("orientationchange",o.current.orientationHandler))}const y=v=>{!v||v===o.current.element||(p(),o.current.element=v,o.current.scrollContainers=xue(v),g())};return fDe(d,!!e),hDe(f),Fe.useEffect(()=>{p(),g()},[e,d,f]),Fe.useEffect(()=>p,[]),[y,s,h]}function hDe(t){Fe.useEffect(()=>{const e=t;return window.addEventListener("resize",e),()=>void window.removeEventListener("resize",e)},[t])}function fDe(t,e){Fe.useEffect(()=>{if(e){const n=t;return window.addEventListener("scroll",n,{capture:!0,passive:!0}),()=>void window.removeEventListener("scroll",n,!0)}},[t,e])}function xue(t){const e=[];if(!t||t===document.body)return e;const{overflow:n,overflowX:i,overflowY:r}=window.getComputedStyle(t);return[n,i,r].some(s=>s==="auto"||s==="scroll")&&e.push(t),[...e,...xue(t.parentElement)]}const dDe=["x","y","top","bottom","left","right","width","height"],pDe=(t,e)=>dDe.every(n=>t[n]===e[n]);function mDe({ref:t,children:e,fallback:n,resize:i,style:r,gl:s,events:a=Tue,eventSource:o,eventPrefix:c,shadows:l,linear:u,flat:h,legacy:f,orthographic:d,frameloop:p,dpr:g,performance:y,raycaster:v,camera:b,scene:T,onPointerMissed:x,onCreated:M,...R}){Fe.useMemo(()=>pue(PIe),[]);const I=Dke(),[k,P]=uDe({scroll:!0,debounce:{scroll:50,resize:0},...i}),U=Fe.useRef(null),G=Fe.useRef(null);Fe.useImperativeHandle(t,()=>U.current);const $=q7(x),[q,Y]=Fe.useState(!1),[ie,V]=Fe.useState(!1);if(q)throw q;if(ie)throw ie;const J=Fe.useRef(null);fI(()=>{const ee=U.current;if(P.width>0&&P.height>0&&ee){J.current||(J.current=iDe(ee));async function oe(){await J.current.configure({gl:s,scene:T,events:a,shadows:l,linear:u,flat:h,legacy:f,orthographic:d,frameloop:p,dpr:g,performance:y,raycaster:v,camera:b,size:P,onPointerMissed:(...fe)=>$.current==null?void 0:$.current(...fe),onCreated:fe=>{fe.events.connect==null||fe.events.connect(o?Ike(o)?o.current:o:G.current),c&&fe.setEvents({compute:(Re,He)=>{const Te=Re[c+"X"],Le=Re[c+"Y"];He.pointer.set(Te/He.size.width*2-1,-(Le/He.size.height)*2+1),He.raycaster.setFromCamera(He.pointer,He.camera)}}),M==null||M(fe)}}),J.current.render(Me.jsx(I,{children:Me.jsx(Lke,{set:V,children:Me.jsx(Fe.Suspense,{fallback:Me.jsx(Pke,{set:Y}),children:e??null})})}))}oe()}}),Fe.useEffect(()=>{const ee=U.current;if(ee)return()=>_ue(ee)},[]);const X=o?"none":"auto";return Me.jsx("div",{ref:G,style:{position:"relative",width:"100%",height:"100%",overflow:"hidden",pointerEvents:X,...r},...R,children:Me.jsx("div",{ref:k,style:{width:"100%",height:"100%"},children:Me.jsx("canvas",{ref:U,style:{display:"block"},children:n})})})}function gDe(t){return Me.jsx(sue,{children:Me.jsx(mDe,{...t})})}var X7={exports:{}};function wue(t,e=100,n={}){if(typeof t!="function")throw new TypeError(`Expected the first parameter to be a function, got \`${typeof t}\`.`);if(e<0)throw new RangeError("`wait` must not be negative.");const{immediate:i}=typeof n=="boolean"?{immediate:n}:n;let r,s,a,o,c;function l(){const f=r,d=s;return r=void 0,s=void 0,c=t.apply(f,d),c}function u(){const f=Date.now()-o;f<e&&f>=0?a=setTimeout(u,e-f):(a=void 0,i||(c=l()))}const h=function(...f){if(r&&this!==r&&Object.getPrototypeOf(this)===Object.getPrototypeOf(r))throw new Error("Debounced method called with different contexts of the same prototype.");r=this,s=f,o=Date.now();const d=i&&!a;return a||(a=setTimeout(u,e)),d&&(c=l()),c};return Object.defineProperty(h,"isPending",{get(){return a!==void 0}}),h.clear=()=>{a&&(clearTimeout(a),a=void 0)},h.flush=()=>{a&&h.trigger()},h.trigger=()=>{c=l(),h.clear()},h}X7.exports.debounce=wue;X7.exports=wue;var vDe=X7.exports;const _De=Yc(vDe);var Cue={exports:{}},qB={},Aue={exports:{}},Rue={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(V,J){var X=V.length;V.push(J);e:for(;0<X;){var ee=X-1>>>1,oe=V[ee];if(0<r(oe,J))V[ee]=J,V[X]=oe,X=ee;else break e}}function n(V){return V.length===0?null:V[0]}function i(V){if(V.length===0)return null;var J=V[0],X=V.pop();if(X!==J){V[0]=X;e:for(var ee=0,oe=V.length,fe=oe>>>1;ee<fe;){var Re=2*(ee+1)-1,He=V[Re],Te=Re+1,Le=V[Te];if(0>r(He,X))Te<oe&&0>r(Le,He)?(V[ee]=Le,V[Te]=X,ee=Te):(V[ee]=He,V[Re]=X,ee=Re);else if(Te<oe&&0>r(Le,X))V[ee]=Le,V[Te]=X,ee=Te;else break e}}return J}function r(V,J){var X=V.sortIndex-J.sortIndex;return X!==0?X:V.id-J.id}if(t.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var s=performance;t.unstable_now=function(){return s.now()}}else{var a=Date,o=a.now();t.unstable_now=function(){return a.now()-o}}var c=[],l=[],u=1,h=null,f=3,d=!1,p=!1,g=!1,y=!1,v=typeof setTimeout=="function"?setTimeout:null,b=typeof clearTimeout=="function"?clearTimeout:null,T=typeof setImmediate<"u"?setImmediate:null;function x(V){for(var J=n(l);J!==null;){if(J.callback===null)i(l);else if(J.startTime<=V)i(l),J.sortIndex=J.expirationTime,e(c,J);else break;J=n(l)}}function M(V){if(g=!1,x(V),!p)if(n(c)!==null)p=!0,R||(R=!0,$());else{var J=n(l);J!==null&&ie(M,J.startTime-V)}}var R=!1,I=-1,k=5,P=-1;function U(){return y?!0:!(t.unstable_now()-P<k)}function G(){if(y=!1,R){var V=t.unstable_now();P=V;var J=!0;try{e:{p=!1,g&&(g=!1,b(I),I=-1),d=!0;var X=f;try{t:{for(x(V),h=n(c);h!==null&&!(h.expirationTime>V&&U());){var ee=h.callback;if(typeof ee=="function"){h.callback=null,f=h.priorityLevel;var oe=ee(h.expirationTime<=V);if(V=t.unstable_now(),typeof oe=="function"){h.callback=oe,x(V),J=!0;break t}h===n(c)&&i(c),x(V)}else i(c);h=n(c)}if(h!==null)J=!0;else{var fe=n(l);fe!==null&&ie(M,fe.startTime-V),J=!1}}break e}finally{h=null,f=X,d=!1}J=void 0}}finally{J?$():R=!1}}}var $;if(typeof T=="function")$=function(){T(G)};else if(typeof MessageChannel<"u"){var q=new MessageChannel,Y=q.port2;q.port1.onmessage=G,$=function(){Y.postMessage(null)}}else $=function(){v(G,0)};function ie(V,J){I=v(function(){V(t.unstable_now())},J)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(V){V.callback=null},t.unstable_forceFrameRate=function(V){0>V||125<V?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):k=0<V?Math.floor(1e3/V):5},t.unstable_getCurrentPriorityLevel=function(){return f},t.unstable_next=function(V){switch(f){case 1:case 2:case 3:var J=3;break;default:J=f}var X=f;f=J;try{return V()}finally{f=X}},t.unstable_requestPaint=function(){y=!0},t.unstable_runWithPriority=function(V,J){switch(V){case 1:case 2:case 3:case 4:case 5:break;default:V=3}var X=f;f=V;try{return J()}finally{f=X}},t.unstable_scheduleCallback=function(V,J,X){var ee=t.unstable_now();switch(typeof X=="object"&&X!==null?(X=X.delay,X=typeof X=="number"&&0<X?ee+X:ee):X=ee,V){case 1:var oe=-1;break;case 2:oe=250;break;case 5:oe=1073741823;break;case 4:oe=1e4;break;default:oe=5e3}return oe=X+oe,V={id:u++,callback:J,priorityLevel:V,startTime:X,expirationTime:oe,sortIndex:-1},X>ee?(V.sortIndex=X,e(l,V),n(c)===null&&V===n(l)&&(g?(b(I),I=-1):g=!0,ie(M,X-ee))):(V.sortIndex=oe,e(c,V),p||d||(p=!0,R||(R=!0,$()))),V},t.unstable_shouldYield=U,t.unstable_wrapCallback=function(V){var J=f;return function(){var X=f;f=J;try{return V.apply(this,arguments)}finally{f=X}}}})(Rue);Aue.exports=Rue;var yDe=Aue.exports,Mue={exports:{}},fh={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var bDe=Fe;function Oue(t){var e="https://react.dev/errors/"+t;if(1<arguments.length){e+="?args[]="+encodeURIComponent(arguments[1]);for(var n=2;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n])}return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function Ay(){}var ih={d:{f:Ay,r:function(){throw Error(Oue(522))},D:Ay,C:Ay,L:Ay,m:Ay,X:Ay,S:Ay,M:Ay},p:0,findDOMNode:null},EDe=Symbol.for("react.portal");function SDe(t,e,n){var i=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:EDe,key:i==null?null:""+i,children:t,containerInfo:e,implementation:n}}var RM=bDe.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function $B(t,e){if(t==="font")return"";if(typeof e=="string")return e==="use-credentials"?e:""}fh.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=ih;fh.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)throw Error(Oue(299));return SDe(t,e,null,n)};fh.flushSync=function(t){var e=RM.T,n=ih.p;try{if(RM.T=null,ih.p=2,t)return t()}finally{RM.T=e,ih.p=n,ih.d.f()}};fh.preconnect=function(t,e){typeof t=="string"&&(e?(e=e.crossOrigin,e=typeof e=="string"?e==="use-credentials"?e:"":void 0):e=null,ih.d.C(t,e))};fh.prefetchDNS=function(t){typeof t=="string"&&ih.d.D(t)};fh.preinit=function(t,e){if(typeof t=="string"&&e&&typeof e.as=="string"){var n=e.as,i=$B(n,e.crossOrigin),r=typeof e.integrity=="string"?e.integrity:void 0,s=typeof e.fetchPriority=="string"?e.fetchPriority:void 0;n==="style"?ih.d.S(t,typeof e.precedence=="string"?e.precedence:void 0,{crossOrigin:i,integrity:r,fetchPriority:s}):n==="script"&&ih.d.X(t,{crossOrigin:i,integrity:r,fetchPriority:s,nonce:typeof e.nonce=="string"?e.nonce:void 0})}};fh.preinitModule=function(t,e){if(typeof t=="string")if(typeof e=="object"&&e!==null){if(e.as==null||e.as==="script"){var n=$B(e.as,e.crossOrigin);ih.d.M(t,{crossOrigin:n,integrity:typeof e.integrity=="string"?e.integrity:void 0,nonce:typeof e.nonce=="string"?e.nonce:void 0})}}else e==null&&ih.d.M(t)};fh.preload=function(t,e){if(typeof t=="string"&&typeof e=="object"&&e!==null&&typeof e.as=="string"){var n=e.as,i=$B(n,e.crossOrigin);ih.d.L(t,n,{crossOrigin:i,integrity:typeof e.integrity=="string"?e.integrity:void 0,nonce:typeof e.nonce=="string"?e.nonce:void 0,type:typeof e.type=="string"?e.type:void 0,fetchPriority:typeof e.fetchPriority=="string"?e.fetchPriority:void 0,referrerPolicy:typeof e.referrerPolicy=="string"?e.referrerPolicy:void 0,imageSrcSet:typeof e.imageSrcSet=="string"?e.imageSrcSet:void 0,imageSizes:typeof e.imageSizes=="string"?e.imageSizes:void 0,media:typeof e.media=="string"?e.media:void 0})}};fh.preloadModule=function(t,e){if(typeof t=="string")if(e){var n=$B(e.as,e.crossOrigin);ih.d.m(t,{as:typeof e.as=="string"&&e.as!=="script"?e.as:void 0,crossOrigin:n,integrity:typeof e.integrity=="string"?e.integrity:void 0})}else ih.d.m(t)};fh.requestFormReset=function(t){ih.d.r(t)};fh.unstable_batchedUpdates=function(t,e){return t(e)};fh.useFormState=function(t,e,n){return RM.H.useFormState(t,e,n)};fh.useFormStatus=function(){return RM.H.useHostTransitionStatus()};fh.version="19.1.0";function Nue(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(Nue)}catch(t){console.error(t)}}Nue(),Mue.exports=fh;var TDe=Mue.exports,Gc=yDe,Iue=Fe,xDe=TDe;function jt(t){var e="https://react.dev/errors/"+t;if(1<arguments.length){e+="?args[]="+encodeURIComponent(arguments[1]);for(var n=2;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n])}return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function kue(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function dI(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function Due(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function nQ(t){if(dI(t)!==t)throw Error(jt(188))}function wDe(t){var e=t.alternate;if(!e){if(e=dI(t),e===null)throw Error(jt(188));return e!==t?null:t}for(var n=t,i=e;;){var r=n.return;if(r===null)break;var s=r.alternate;if(s===null){if(i=r.return,i!==null){n=i;continue}break}if(r.child===s.child){for(s=r.child;s;){if(s===n)return nQ(r),t;if(s===i)return nQ(r),e;s=s.sibling}throw Error(jt(188))}if(n.return!==i.return)n=r,i=s;else{for(var a=!1,o=r.child;o;){if(o===n){a=!0,n=r,i=s;break}if(o===i){a=!0,i=r,n=s;break}o=o.sibling}if(!a){for(o=s.child;o;){if(o===n){a=!0,n=s,i=r;break}if(o===i){a=!0,i=s,n=r;break}o=o.sibling}if(!a)throw Error(jt(189))}}if(n.alternate!==i)throw Error(jt(190))}if(n.tag!==3)throw Error(jt(188));return n.stateNode.current===n?t:e}function Pue(t){var e=t.tag;if(e===5||e===26||e===27||e===6)return t;for(t=t.child;t!==null;){if(e=Pue(t),e!==null)return e;t=t.sibling}return null}var xa=Object.assign,CDe=Symbol.for("react.element"),zD=Symbol.for("react.transitional.element"),nM=Symbol.for("react.portal"),gw=Symbol.for("react.fragment"),Lue=Symbol.for("react.strict_mode"),IV=Symbol.for("react.profiler"),ADe=Symbol.for("react.provider"),Uue=Symbol.for("react.consumer"),Zv=Symbol.for("react.context"),K7=Symbol.for("react.forward_ref"),kV=Symbol.for("react.suspense"),DV=Symbol.for("react.suspense_list"),Z7=Symbol.for("react.memo"),$y=Symbol.for("react.lazy"),PV=Symbol.for("react.activity"),RDe=Symbol.for("react.memo_cache_sentinel"),iQ=Symbol.iterator;function CR(t){return t===null||typeof t!="object"?null:(t=iQ&&t[iQ]||t["@@iterator"],typeof t=="function"?t:null)}var MDe=Symbol.for("react.client.reference");function LV(t){if(t==null)return null;if(typeof t=="function")return t.$$typeof===MDe?null:t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case gw:return"Fragment";case IV:return"Profiler";case Lue:return"StrictMode";case kV:return"Suspense";case DV:return"SuspenseList";case PV:return"Activity"}if(typeof t=="object")switch(t.$$typeof){case nM:return"Portal";case Zv:return(t.displayName||"Context")+".Provider";case Uue:return(t._context.displayName||"Context")+".Consumer";case K7:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case Z7:return e=t.displayName||null,e!==null?e:LV(t.type)||"Memo";case $y:e=t._payload,t=t._init;try{return LV(t(e))}catch{}}return null}var iM=Array.isArray,Bi=Iue.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,ys=xDe.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,vT={pending:!1,data:null,method:null,action:null},UV=[],vw=-1;function f0(t){return{current:t}}function _l(t){0>vw||(t.current=UV[vw],UV[vw]=null,vw--)}function Ua(t,e){vw++,UV[vw]=t.current,t.current=e}var Bg=f0(null),AO=f0(null),bb=f0(null),eU=f0(null);function tU(t,e){switch(Ua(bb,e),Ua(AO,t),Ua(Bg,null),e.nodeType){case 9:case 11:t=(t=e.documentElement)&&(t=t.namespaceURI)?cee(t):0;break;default:if(t=e.tagName,e=e.namespaceURI)e=cee(e),t=ede(e,t);else switch(t){case"svg":t=1;break;case"math":t=2;break;default:t=0}}_l(Bg),Ua(Bg,t)}function AC(){_l(Bg),_l(AO),_l(bb)}function BV(t){t.memoizedState!==null&&Ua(eU,t);var e=Bg.current,n=ede(e,t.type);e!==n&&(Ua(AO,t),Ua(Bg,n))}function nU(t){AO.current===t&&(_l(Bg),_l(AO)),eU.current===t&&(_l(eU),UO._currentValue=vT)}var FV=Object.prototype.hasOwnProperty,J7=Gc.unstable_scheduleCallback,RH=Gc.unstable_cancelCallback,ODe=Gc.unstable_shouldYield,NDe=Gc.unstable_requestPaint,Fg=Gc.unstable_now,IDe=Gc.unstable_getCurrentPriorityLevel,Bue=Gc.unstable_ImmediatePriority,Fue=Gc.unstable_UserBlockingPriority,iU=Gc.unstable_NormalPriority,kDe=Gc.unstable_LowPriority,zue=Gc.unstable_IdlePriority,DDe=Gc.log,PDe=Gc.unstable_setDisableYieldValue,pI=null,td=null;function hb(t){if(typeof DDe=="function"&&PDe(t),td&&typeof td.setStrictMode=="function")try{td.setStrictMode(pI,t)}catch{}}var nd=Math.clz32?Math.clz32:BDe,LDe=Math.log,UDe=Math.LN2;function BDe(t){return t>>>=0,t===0?32:31-(LDe(t)/UDe|0)|0}var HD=256,jD=4194304;function VS(t){var e=t&42;if(e!==0)return e;switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194048;case 4194304:case 8388608:case 16777216:case 33554432:return t&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return t}}function WB(t,e,n){var i=t.pendingLanes;if(i===0)return 0;var r=0,s=t.suspendedLanes,a=t.pingedLanes;t=t.warmLanes;var o=i&134217727;return o!==0?(i=o&~s,i!==0?r=VS(i):(a&=o,a!==0?r=VS(a):n||(n=o&~t,n!==0&&(r=VS(n))))):(o=i&~s,o!==0?r=VS(o):a!==0?r=VS(a):n||(n=i&~t,n!==0&&(r=VS(n)))),r===0?0:e!==0&&e!==r&&!(e&s)&&(s=r&-r,n=e&-e,s>=n||s===32&&(n&4194048)!==0)?e:r}function mI(t,e){return(t.pendingLanes&~(t.suspendedLanes&~t.pingedLanes)&e)===0}function FDe(t,e){switch(t){case 1:case 2:case 4:case 8:case 64:return e+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Hue(){var t=HD;return HD<<=1,!(HD&4194048)&&(HD=256),t}function jue(){var t=jD;return jD<<=1,!(jD&62914560)&&(jD=4194304),t}function MH(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function gI(t,e){t.pendingLanes|=e,e!==268435456&&(t.suspendedLanes=0,t.pingedLanes=0,t.warmLanes=0)}function zDe(t,e,n,i,r,s){var a=t.pendingLanes;t.pendingLanes=n,t.suspendedLanes=0,t.pingedLanes=0,t.warmLanes=0,t.expiredLanes&=n,t.entangledLanes&=n,t.errorRecoveryDisabledLanes&=n,t.shellSuspendCounter=0;var o=t.entanglements,c=t.expirationTimes,l=t.hiddenUpdates;for(n=a&~n;0<n;){var u=31-nd(n),h=1<<u;o[u]=0,c[u]=-1;var f=l[u];if(f!==null)for(l[u]=null,u=0;u<f.length;u++){var d=f[u];d!==null&&(d.lane&=-536870913)}n&=~h}i!==0&&Vue(t,i,0),s!==0&&r===0&&t.tag!==0&&(t.suspendedLanes|=s&~(a&~e))}function Vue(t,e,n){t.pendingLanes|=e,t.suspendedLanes&=~e;var i=31-nd(e);t.entangledLanes|=e,t.entanglements[i]=t.entanglements[i]|1073741824|n&4194090}function Gue(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var i=31-nd(n),r=1<<i;r&e|t[i]&e&&(t[i]|=e),n&=~r}}function Q7(t){switch(t){case 2:t=1;break;case 8:t=4;break;case 32:t=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:t=128;break;case 268435456:t=134217728;break;default:t=0}return t}function eW(t){return t&=-t,2<t?8<t?t&134217727?32:268435456:8:2}function que(){var t=ys.p;return t!==0?t:(t=window.event,t===void 0?32:ude(t.type))}function HDe(t,e){var n=ys.p;try{return ys.p=t,e()}finally{ys.p=n}}var vE=Math.random().toString(36).slice(2),du="__reactFiber$"+vE,sf="__reactProps$"+vE,wA="__reactContainer$"+vE,zV="__reactEvents$"+vE,jDe="__reactListeners$"+vE,VDe="__reactHandles$"+vE,rQ="__reactResources$"+vE,vI="__reactMarker$"+vE;function tW(t){delete t[du],delete t[sf],delete t[zV],delete t[jDe],delete t[VDe]}function _w(t){var e=t[du];if(e)return e;for(var n=t.parentNode;n;){if(e=n[wA]||n[du]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=hee(t);t!==null;){if(n=t[du])return n;t=hee(t)}return e}t=n,n=t.parentNode}return null}function CA(t){if(t=t[du]||t[wA]){var e=t.tag;if(e===5||e===6||e===13||e===26||e===27||e===3)return t}return null}function rM(t){var e=t.tag;if(e===5||e===26||e===27||e===6)return t.stateNode;throw Error(jt(33))}function jw(t){var e=t[rQ];return e||(e=t[rQ]={hoistableStyles:new Map,hoistableScripts:new Map}),e}function hl(t){t[vI]=!0}var $ue=new Set,Wue={};function g1(t,e){RC(t,e),RC(t+"Capture",e)}function RC(t,e){for(Wue[t]=e,t=0;t<e.length;t++)$ue.add(e[t])}var GDe=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),sQ={},aQ={};function qDe(t){return FV.call(aQ,t)?!0:FV.call(sQ,t)?!1:GDe.test(t)?aQ[t]=!0:(sQ[t]=!0,!1)}function t2(t,e,n){if(qDe(e))if(n===null)t.removeAttribute(e);else{switch(typeof n){case"undefined":case"function":case"symbol":t.removeAttribute(e);return;case"boolean":var i=e.toLowerCase().slice(0,5);if(i!=="data-"&&i!=="aria-"){t.removeAttribute(e);return}}t.setAttribute(e,""+n)}}function VD(t,e,n){if(n===null)t.removeAttribute(e);else{switch(typeof n){case"undefined":case"function":case"symbol":case"boolean":t.removeAttribute(e);return}t.setAttribute(e,""+n)}}function wv(t,e,n,i){if(i===null)t.removeAttribute(n);else{switch(typeof i){case"undefined":case"function":case"symbol":case"boolean":t.removeAttribute(n);return}t.setAttributeNS(e,n,""+i)}}var OH,oQ;function nw(t){if(OH===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);OH=e&&e[1]||"",oQ=-1<n.stack.indexOf(`
    at`)?" (<anonymous>)":-1<n.stack.indexOf("@")?"@unknown:0:0":""}return`
`+OH+t+oQ}var NH=!1;function IH(t,e){if(!t||NH)return"";NH=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var i={DetermineComponentFrameRoot:function(){try{if(e){var h=function(){throw Error()};if(Object.defineProperty(h.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(h,[])}catch(d){var f=d}Reflect.construct(t,[],h)}else{try{h.call()}catch(d){f=d}t.call(h.prototype)}}else{try{throw Error()}catch(d){f=d}(h=t())&&typeof h.catch=="function"&&h.catch(function(){})}}catch(d){if(d&&f&&typeof d.stack=="string")return[d.stack,f.stack]}return[null,null]}};i.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var r=Object.getOwnPropertyDescriptor(i.DetermineComponentFrameRoot,"name");r&&r.configurable&&Object.defineProperty(i.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var s=i.DetermineComponentFrameRoot(),a=s[0],o=s[1];if(a&&o){var c=a.split(`
`),l=o.split(`
`);for(r=i=0;i<c.length&&!c[i].includes("DetermineComponentFrameRoot");)i++;for(;r<l.length&&!l[r].includes("DetermineComponentFrameRoot");)r++;if(i===c.length||r===l.length)for(i=c.length-1,r=l.length-1;1<=i&&0<=r&&c[i]!==l[r];)r--;for(;1<=i&&0<=r;i--,r--)if(c[i]!==l[r]){if(i!==1||r!==1)do if(i--,r--,0>r||c[i]!==l[r]){var u=`
`+c[i].replace(" at new "," at ");return t.displayName&&u.includes("<anonymous>")&&(u=u.replace("<anonymous>",t.displayName)),u}while(1<=i&&0<=r);break}}}finally{NH=!1,Error.prepareStackTrace=n}return(n=t?t.displayName||t.name:"")?nw(n):""}function $De(t){switch(t.tag){case 26:case 27:case 5:return nw(t.type);case 16:return nw("Lazy");case 13:return nw("Suspense");case 19:return nw("SuspenseList");case 0:case 15:return IH(t.type,!1);case 11:return IH(t.type.render,!1);case 1:return IH(t.type,!0);case 31:return nw("Activity");default:return""}}function cQ(t){try{var e="";do e+=$De(t),t=t.return;while(t);return e}catch(n){return`
Error generating stack: `+n.message+`
`+n.stack}}function Hd(t){switch(typeof t){case"bigint":case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function Yue(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function WDe(t){var e=Yue(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),i=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var r=n.get,s=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return r.call(this)},set:function(a){i=""+a,s.call(this,a)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return i},setValue:function(a){i=""+a},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function rU(t){t._valueTracker||(t._valueTracker=WDe(t))}function Xue(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),i="";return t&&(i=Yue(t)?t.checked?"true":"false":t.value),t=i,t!==n?(e.setValue(t),!0):!1}function sU(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}var YDe=/[\n"\\]/g;function Xd(t){return t.replace(YDe,function(e){return"\\"+e.charCodeAt(0).toString(16)+" "})}function HV(t,e,n,i,r,s,a,o){t.name="",a!=null&&typeof a!="function"&&typeof a!="symbol"&&typeof a!="boolean"?t.type=a:t.removeAttribute("type"),e!=null?a==="number"?(e===0&&t.value===""||t.value!=e)&&(t.value=""+Hd(e)):t.value!==""+Hd(e)&&(t.value=""+Hd(e)):a!=="submit"&&a!=="reset"||t.removeAttribute("value"),e!=null?jV(t,a,Hd(e)):n!=null?jV(t,a,Hd(n)):i!=null&&t.removeAttribute("value"),r==null&&s!=null&&(t.defaultChecked=!!s),r!=null&&(t.checked=r&&typeof r!="function"&&typeof r!="symbol"),o!=null&&typeof o!="function"&&typeof o!="symbol"&&typeof o!="boolean"?t.name=""+Hd(o):t.removeAttribute("name")}function Kue(t,e,n,i,r,s,a,o){if(s!=null&&typeof s!="function"&&typeof s!="symbol"&&typeof s!="boolean"&&(t.type=s),e!=null||n!=null){if(!(s!=="submit"&&s!=="reset"||e!=null))return;n=n!=null?""+Hd(n):"",e=e!=null?""+Hd(e):n,o||e===t.value||(t.value=e),t.defaultValue=e}i=i??r,i=typeof i!="function"&&typeof i!="symbol"&&!!i,t.checked=o?t.checked:!!i,t.defaultChecked=!!i,a!=null&&typeof a!="function"&&typeof a!="symbol"&&typeof a!="boolean"&&(t.name=a)}function jV(t,e,n){e==="number"&&sU(t.ownerDocument)===t||t.defaultValue===""+n||(t.defaultValue=""+n)}function Vw(t,e,n,i){if(t=t.options,e){e={};for(var r=0;r<n.length;r++)e["$"+n[r]]=!0;for(n=0;n<t.length;n++)r=e.hasOwnProperty("$"+t[n].value),t[n].selected!==r&&(t[n].selected=r),r&&i&&(t[n].defaultSelected=!0)}else{for(n=""+Hd(n),e=null,r=0;r<t.length;r++){if(t[r].value===n){t[r].selected=!0,i&&(t[r].defaultSelected=!0);return}e!==null||t[r].disabled||(e=t[r])}e!==null&&(e.selected=!0)}}function Zue(t,e,n){if(e!=null&&(e=""+Hd(e),e!==t.value&&(t.value=e),n==null)){t.defaultValue!==e&&(t.defaultValue=e);return}t.defaultValue=n!=null?""+Hd(n):""}function Jue(t,e,n,i){if(e==null){if(i!=null){if(n!=null)throw Error(jt(92));if(iM(i)){if(1<i.length)throw Error(jt(93));i=i[0]}n=i}n==null&&(n=""),e=n}n=Hd(e),t.defaultValue=n,i=t.textContent,i===n&&i!==""&&i!==null&&(t.value=i)}function MC(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var XDe=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function lQ(t,e,n){var i=e.indexOf("--")===0;n==null||typeof n=="boolean"||n===""?i?t.setProperty(e,""):e==="float"?t.cssFloat="":t[e]="":i?t.setProperty(e,n):typeof n!="number"||n===0||XDe.has(e)?e==="float"?t.cssFloat=n:t[e]=(""+n).trim():t[e]=n+"px"}function Que(t,e,n){if(e!=null&&typeof e!="object")throw Error(jt(62));if(t=t.style,n!=null){for(var i in n)!n.hasOwnProperty(i)||e!=null&&e.hasOwnProperty(i)||(i.indexOf("--")===0?t.setProperty(i,""):i==="float"?t.cssFloat="":t[i]="");for(var r in e)i=e[r],e.hasOwnProperty(r)&&n[r]!==i&&lQ(t,r,i)}else for(var s in e)e.hasOwnProperty(s)&&lQ(t,s,e[s])}function nW(t){if(t.indexOf("-")===-1)return!1;switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var KDe=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),ZDe=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function n2(t){return ZDe.test(""+t)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":t}var VV=null;function iW(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var yw=null,Gw=null;function uQ(t){var e=CA(t);if(e&&(t=e.stateNode)){var n=t[sf]||null;e:switch(t=e.stateNode,e.type){case"input":if(HV(t,n.value,n.defaultValue,n.defaultValue,n.checked,n.defaultChecked,n.type,n.name),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll('input[name="'+Xd(""+e)+'"][type="radio"]'),e=0;e<n.length;e++){var i=n[e];if(i!==t&&i.form===t.form){var r=i[sf]||null;if(!r)throw Error(jt(90));HV(i,r.value,r.defaultValue,r.defaultValue,r.checked,r.defaultChecked,r.type,r.name)}}for(e=0;e<n.length;e++)i=n[e],i.form===t.form&&Xue(i)}break e;case"textarea":Zue(t,n.value,n.defaultValue);break e;case"select":e=n.value,e!=null&&Vw(t,!!n.multiple,e,!1)}}}var kH=!1;function ehe(t,e,n){if(kH)return t(e,n);kH=!0;try{var i=t(e);return i}finally{if(kH=!1,(yw!==null||Gw!==null)&&(iF(),yw&&(e=yw,t=Gw,Gw=yw=null,uQ(e),t)))for(e=0;e<t.length;e++)uQ(t[e])}}function RO(t,e){var n=t.stateNode;if(n===null)return null;var i=n[sf]||null;if(i===null)return null;n=i[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(i=!i.disabled)||(t=t.type,i=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!i;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(jt(231,e,typeof n));return n}var v_=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),GV=!1;if(v_)try{var AR={};Object.defineProperty(AR,"passive",{get:function(){GV=!0}}),window.addEventListener("test",AR,AR),window.removeEventListener("test",AR,AR)}catch{GV=!1}var fb=null,rW=null,i2=null;function the(){if(i2)return i2;var t,e=rW,n=e.length,i,r="value"in fb?fb.value:fb.textContent,s=r.length;for(t=0;t<n&&e[t]===r[t];t++);var a=n-t;for(i=1;i<=a&&e[n-i]===r[s-i];i++);return i2=r.slice(t,1<i?1-i:void 0)}function r2(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function GD(){return!0}function hQ(){return!1}function pf(t){function e(n,i,r,s,a){this._reactName=n,this._targetInst=r,this.type=i,this.nativeEvent=s,this.target=a,this.currentTarget=null;for(var o in t)t.hasOwnProperty(o)&&(n=t[o],this[o]=n?n(s):s[o]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?GD:hQ,this.isPropagationStopped=hQ,this}return xa(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=GD)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=GD)},persist:function(){},isPersistent:GD}),e}var v1={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},YB=pf(v1),_I=xa({},v1,{view:0,detail:0}),JDe=pf(_I),DH,PH,RR,XB=xa({},_I,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:sW,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==RR&&(RR&&t.type==="mousemove"?(DH=t.screenX-RR.screenX,PH=t.screenY-RR.screenY):PH=DH=0,RR=t),DH)},movementY:function(t){return"movementY"in t?t.movementY:PH}}),fQ=pf(XB),QDe=xa({},XB,{dataTransfer:0}),ePe=pf(QDe),tPe=xa({},_I,{relatedTarget:0}),LH=pf(tPe),nPe=xa({},v1,{animationName:0,elapsedTime:0,pseudoElement:0}),iPe=pf(nPe),rPe=xa({},v1,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),sPe=pf(rPe),aPe=xa({},v1,{data:0}),dQ=pf(aPe),oPe={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},cPe={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},lPe={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function uPe(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=lPe[t])?!!e[t]:!1}function sW(){return uPe}var hPe=xa({},_I,{key:function(t){if(t.key){var e=oPe[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=r2(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?cPe[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:sW,charCode:function(t){return t.type==="keypress"?r2(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?r2(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),fPe=pf(hPe),dPe=xa({},XB,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),pQ=pf(dPe),pPe=xa({},_I,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:sW}),mPe=pf(pPe),gPe=xa({},v1,{propertyName:0,elapsedTime:0,pseudoElement:0}),vPe=pf(gPe),_Pe=xa({},XB,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),yPe=pf(_Pe),bPe=xa({},v1,{newState:0,oldState:0}),EPe=pf(bPe),SPe=[9,13,27,32],aW=v_&&"CompositionEvent"in window,MM=null;v_&&"documentMode"in document&&(MM=document.documentMode);var TPe=v_&&"TextEvent"in window&&!MM,nhe=v_&&(!aW||MM&&8<MM&&11>=MM),mQ=" ",gQ=!1;function ihe(t,e){switch(t){case"keyup":return SPe.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function rhe(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var bw=!1;function xPe(t,e){switch(t){case"compositionend":return rhe(e);case"keypress":return e.which!==32?null:(gQ=!0,mQ);case"textInput":return t=e.data,t===mQ&&gQ?null:t;default:return null}}function wPe(t,e){if(bw)return t==="compositionend"||!aW&&ihe(t,e)?(t=the(),i2=rW=fb=null,bw=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return nhe&&e.locale!=="ko"?null:e.data;default:return null}}var CPe={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function vQ(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!CPe[t.type]:e==="textarea"}function she(t,e,n,i){yw?Gw?Gw.push(i):Gw=[i]:yw=i,e=TU(e,"onChange"),0<e.length&&(n=new YB("onChange","change",null,n,i),t.push({event:n,listeners:e}))}var OM=null,MO=null;function APe(t){Zfe(t,0)}function KB(t){var e=rM(t);if(Xue(e))return t}function _Q(t,e){if(t==="change")return e}var ahe=!1;if(v_){var UH;if(v_){var BH="oninput"in document;if(!BH){var yQ=document.createElement("div");yQ.setAttribute("oninput","return;"),BH=typeof yQ.oninput=="function"}UH=BH}else UH=!1;ahe=UH&&(!document.documentMode||9<document.documentMode)}function bQ(){OM&&(OM.detachEvent("onpropertychange",ohe),MO=OM=null)}function ohe(t){if(t.propertyName==="value"&&KB(MO)){var e=[];she(e,MO,t,iW(t)),ehe(APe,e)}}function RPe(t,e,n){t==="focusin"?(bQ(),OM=e,MO=n,OM.attachEvent("onpropertychange",ohe)):t==="focusout"&&bQ()}function MPe(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return KB(MO)}function OPe(t,e){if(t==="click")return KB(e)}function NPe(t,e){if(t==="input"||t==="change")return KB(e)}function IPe(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var od=typeof Object.is=="function"?Object.is:IPe;function OO(t,e){if(od(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),i=Object.keys(e);if(n.length!==i.length)return!1;for(i=0;i<n.length;i++){var r=n[i];if(!FV.call(e,r)||!od(t[r],e[r]))return!1}return!0}function EQ(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function SQ(t,e){var n=EQ(t);t=0;for(var i;n;){if(n.nodeType===3){if(i=t+n.textContent.length,t<=e&&i>=e)return{node:n,offset:e-t};t=i}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=EQ(n)}}function che(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?che(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function lhe(t){t=t!=null&&t.ownerDocument!=null&&t.ownerDocument.defaultView!=null?t.ownerDocument.defaultView:window;for(var e=sU(t.document);e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=sU(t.document)}return e}function oW(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}var kPe=v_&&"documentMode"in document&&11>=document.documentMode,Ew=null,qV=null,NM=null,$V=!1;function TQ(t,e,n){var i=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;$V||Ew==null||Ew!==sU(i)||(i=Ew,"selectionStart"in i&&oW(i)?i={start:i.selectionStart,end:i.selectionEnd}:(i=(i.ownerDocument&&i.ownerDocument.defaultView||window).getSelection(),i={anchorNode:i.anchorNode,anchorOffset:i.anchorOffset,focusNode:i.focusNode,focusOffset:i.focusOffset}),NM&&OO(NM,i)||(NM=i,i=TU(qV,"onSelect"),0<i.length&&(e=new YB("onSelect","select",null,e,n),t.push({event:e,listeners:i}),e.target=Ew)))}function OS(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var Sw={animationend:OS("Animation","AnimationEnd"),animationiteration:OS("Animation","AnimationIteration"),animationstart:OS("Animation","AnimationStart"),transitionrun:OS("Transition","TransitionRun"),transitionstart:OS("Transition","TransitionStart"),transitioncancel:OS("Transition","TransitionCancel"),transitionend:OS("Transition","TransitionEnd")},FH={},uhe={};v_&&(uhe=document.createElement("div").style,"AnimationEvent"in window||(delete Sw.animationend.animation,delete Sw.animationiteration.animation,delete Sw.animationstart.animation),"TransitionEvent"in window||delete Sw.transitionend.transition);function _1(t){if(FH[t])return FH[t];if(!Sw[t])return t;var e=Sw[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in uhe)return FH[t]=e[n];return t}var hhe=_1("animationend"),fhe=_1("animationiteration"),dhe=_1("animationstart"),DPe=_1("transitionrun"),PPe=_1("transitionstart"),LPe=_1("transitioncancel"),phe=_1("transitionend"),mhe=new Map,WV="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");WV.push("scrollEnd");function Em(t,e){mhe.set(t,e),g1(e,[t])}var xQ=new WeakMap;function Kd(t,e){if(typeof t=="object"&&t!==null){var n=xQ.get(t);return n!==void 0?n:(e={value:t,source:e,stack:cQ(e)},xQ.set(t,e),e)}return{value:t,source:e,stack:cQ(e)}}var Ud=[],Tw=0,cW=0;function ZB(){for(var t=Tw,e=cW=Tw=0;e<t;){var n=Ud[e];Ud[e++]=null;var i=Ud[e];Ud[e++]=null;var r=Ud[e];Ud[e++]=null;var s=Ud[e];if(Ud[e++]=null,i!==null&&r!==null){var a=i.pending;a===null?r.next=r:(r.next=a.next,a.next=r),i.pending=r}s!==0&&ghe(n,r,s)}}function JB(t,e,n,i){Ud[Tw++]=t,Ud[Tw++]=e,Ud[Tw++]=n,Ud[Tw++]=i,cW|=i,t.lanes|=i,t=t.alternate,t!==null&&(t.lanes|=i)}function lW(t,e,n,i){return JB(t,e,n,i),aU(t)}function AA(t,e){return JB(t,null,null,e),aU(t)}function ghe(t,e,n){t.lanes|=n;var i=t.alternate;i!==null&&(i.lanes|=n);for(var r=!1,s=t.return;s!==null;)s.childLanes|=n,i=s.alternate,i!==null&&(i.childLanes|=n),s.tag===22&&(t=s.stateNode,t===null||t._visibility&1||(r=!0)),t=s,s=s.return;return t.tag===3?(s=t.stateNode,r&&e!==null&&(r=31-nd(n),t=s.hiddenUpdates,i=t[r],i===null?t[r]=[e]:i.push(e),e.lane=n|536870912),s):null}function aU(t){if(50<HM)throw HM=0,pG=null,Error(jt(185));for(var e=t.return;e!==null;)t=e,e=t.return;return t.tag===3?t.stateNode:null}var xw={};function UPe(t,e,n,i){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=i,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Kf(t,e,n,i){return new UPe(t,e,n,i)}function uW(t){return t=t.prototype,!(!t||!t.isReactComponent)}function o_(t,e){var n=t.alternate;return n===null?(n=Kf(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&65011712,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n.refCleanup=t.refCleanup,n}function vhe(t,e){t.flags&=65011714;var n=t.alternate;return n===null?(t.childLanes=0,t.lanes=e,t.child=null,t.subtreeFlags=0,t.memoizedProps=null,t.memoizedState=null,t.updateQueue=null,t.dependencies=null,t.stateNode=null):(t.childLanes=n.childLanes,t.lanes=n.lanes,t.child=n.child,t.subtreeFlags=0,t.deletions=null,t.memoizedProps=n.memoizedProps,t.memoizedState=n.memoizedState,t.updateQueue=n.updateQueue,t.type=n.type,e=n.dependencies,t.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),t}function s2(t,e,n,i,r,s){var a=0;if(i=t,typeof t=="function")uW(t)&&(a=1);else if(typeof t=="string")a=F2e(t,n,Bg.current)?26:t==="html"||t==="head"||t==="body"?27:5;else e:switch(t){case PV:return t=Kf(31,n,e,r),t.elementType=PV,t.lanes=s,t;case gw:return _T(n.children,r,s,e);case Lue:a=8,r|=24;break;case IV:return t=Kf(12,n,e,r|2),t.elementType=IV,t.lanes=s,t;case kV:return t=Kf(13,n,e,r),t.elementType=kV,t.lanes=s,t;case DV:return t=Kf(19,n,e,r),t.elementType=DV,t.lanes=s,t;default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case ADe:case Zv:a=10;break e;case Uue:a=9;break e;case K7:a=11;break e;case Z7:a=14;break e;case $y:a=16,i=null;break e}a=29,n=Error(jt(130,t===null?"null":typeof t,"")),i=null}return e=Kf(a,n,e,r),e.elementType=t,e.type=i,e.lanes=s,e}function _T(t,e,n,i){return t=Kf(7,t,i,e),t.lanes=n,t}function zH(t,e,n){return t=Kf(6,t,null,e),t.lanes=n,t}function HH(t,e,n){return e=Kf(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}var ww=[],Cw=0,oU=null,cU=0,jd=[],Vd=0,yT=null,Jv=1,Qv="";function GS(t,e){ww[Cw++]=cU,ww[Cw++]=oU,oU=t,cU=e}function _he(t,e,n){jd[Vd++]=Jv,jd[Vd++]=Qv,jd[Vd++]=yT,yT=t;var i=Jv;t=Qv;var r=32-nd(i)-1;i&=~(1<<r),n+=1;var s=32-nd(e)+r;if(30<s){var a=r-r%5;s=(i&(1<<a)-1).toString(32),i>>=a,r-=a,Jv=1<<32-nd(e)+r|n<<r|i,Qv=s+t}else Jv=1<<s|n<<r|i,Qv=t}function hW(t){t.return!==null&&(GS(t,1),_he(t,1,0))}function fW(t){for(;t===oU;)oU=ww[--Cw],ww[Cw]=null,cU=ww[--Cw],ww[Cw]=null;for(;t===yT;)yT=jd[--Vd],jd[Vd]=null,Qv=jd[--Vd],jd[Vd]=null,Jv=jd[--Vd],jd[Vd]=null}var nh=null,yo=null,_s=!1,bT=null,Cg=!1,YV=Error(jt(519));function UT(t){var e=Error(jt(418,""));throw NO(Kd(e,t)),YV}function wQ(t){var e=t.stateNode,n=t.type,i=t.memoizedProps;switch(e[du]=t,e[sf]=i,n){case"dialog":wr("cancel",e),wr("close",e);break;case"iframe":case"object":case"embed":wr("load",e);break;case"video":case"audio":for(n=0;n<DO.length;n++)wr(DO[n],e);break;case"source":wr("error",e);break;case"img":case"image":case"link":wr("error",e),wr("load",e);break;case"details":wr("toggle",e);break;case"input":wr("invalid",e),Kue(e,i.value,i.defaultValue,i.checked,i.defaultChecked,i.type,i.name,!0),rU(e);break;case"select":wr("invalid",e);break;case"textarea":wr("invalid",e),Jue(e,i.value,i.defaultValue,i.children),rU(e)}n=i.children,typeof n!="string"&&typeof n!="number"&&typeof n!="bigint"||e.textContent===""+n||i.suppressHydrationWarning===!0||Qfe(e.textContent,n)?(i.popover!=null&&(wr("beforetoggle",e),wr("toggle",e)),i.onScroll!=null&&wr("scroll",e),i.onScrollEnd!=null&&wr("scrollend",e),i.onClick!=null&&(e.onclick=aF),e=!0):e=!1,e||UT(t)}function CQ(t){for(nh=t.return;nh;)switch(nh.tag){case 5:case 13:Cg=!1;return;case 27:case 3:Cg=!0;return;default:nh=nh.return}}function MR(t){if(t!==nh)return!1;if(!_s)return CQ(t),_s=!0,!1;var e=t.tag,n;if((n=e!==3&&e!==27)&&((n=e===5)&&(n=t.type,n=!(n!=="form"&&n!=="button")||bG(t.type,t.memoizedProps)),n=!n),n&&yo&&UT(t),CQ(t),e===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(jt(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8)if(n=t.data,n==="/$"){if(e===0){yo=fm(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++;t=t.nextSibling}yo=null}}else e===27?(e=yo,_E(t.type)?(t=TG,TG=null,yo=t):yo=e):yo=nh?fm(t.stateNode.nextSibling):null;return!0}function yI(){yo=nh=null,_s=!1}function AQ(){var t=bT;return t!==null&&(zh===null?zh=t:zh.push.apply(zh,t),bT=null),t}function NO(t){bT===null?bT=[t]:bT.push(t)}var XV=f0(null),y1=null,e_=null;function rb(t,e,n){Ua(XV,e._currentValue),e._currentValue=n}function c_(t){t._currentValue=XV.current,_l(XV)}function KV(t,e,n){for(;t!==null;){var i=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,i!==null&&(i.childLanes|=e)):i!==null&&(i.childLanes&e)!==e&&(i.childLanes|=e),t===n)break;t=t.return}}function ZV(t,e,n,i){var r=t.child;for(r!==null&&(r.return=t);r!==null;){var s=r.dependencies;if(s!==null){var a=r.child;s=s.firstContext;e:for(;s!==null;){var o=s;s=r;for(var c=0;c<e.length;c++)if(o.context===e[c]){s.lanes|=n,o=s.alternate,o!==null&&(o.lanes|=n),KV(s.return,n,t),i||(a=null);break e}s=o.next}}else if(r.tag===18){if(a=r.return,a===null)throw Error(jt(341));a.lanes|=n,s=a.alternate,s!==null&&(s.lanes|=n),KV(a,n,t),a=null}else a=r.child;if(a!==null)a.return=r;else for(a=r;a!==null;){if(a===t){a=null;break}if(r=a.sibling,r!==null){r.return=a.return,a=r;break}a=a.return}r=a}}function bI(t,e,n,i){t=null;for(var r=e,s=!1;r!==null;){if(!s){if(r.flags&524288)s=!0;else if(r.flags&262144)break}if(r.tag===10){var a=r.alternate;if(a===null)throw Error(jt(387));if(a=a.memoizedProps,a!==null){var o=r.type;od(r.pendingProps.value,a.value)||(t!==null?t.push(o):t=[o])}}else if(r===eU.current){if(a=r.alternate,a===null)throw Error(jt(387));a.memoizedState.memoizedState!==r.memoizedState.memoizedState&&(t!==null?t.push(UO):t=[UO])}r=r.return}t!==null&&ZV(e,t,n,i),e.flags|=262144}function lU(t){for(t=t.firstContext;t!==null;){if(!od(t.context._currentValue,t.memoizedValue))return!0;t=t.next}return!1}function BT(t){y1=t,e_=null,t=t.dependencies,t!==null&&(t.firstContext=null)}function pu(t){return yhe(y1,t)}function qD(t,e){return y1===null&&BT(t),yhe(t,e)}function yhe(t,e){var n=e._currentValue;if(e={context:e,memoizedValue:n,next:null},e_===null){if(t===null)throw Error(jt(308));e_=e,t.dependencies={lanes:0,firstContext:e},t.flags|=524288}else e_=e_.next=e;return n}var BPe=typeof AbortController<"u"?AbortController:function(){var t=[],e=this.signal={aborted:!1,addEventListener:function(n,i){t.push(i)}};this.abort=function(){e.aborted=!0,t.forEach(function(n){return n()})}},FPe=Gc.unstable_scheduleCallback,zPe=Gc.unstable_NormalPriority,kc={$$typeof:Zv,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function dW(){return{controller:new BPe,data:new Map,refCount:0}}function EI(t){t.refCount--,t.refCount===0&&FPe(zPe,function(){t.controller.abort()})}var IM=null,JV=0,OC=0,qw=null;function HPe(t,e){if(IM===null){var n=IM=[];JV=0,OC=LW(),qw={status:"pending",value:void 0,then:function(i){n.push(i)}}}return JV++,e.then(RQ,RQ),e}function RQ(){if(--JV===0&&IM!==null){qw!==null&&(qw.status="fulfilled");var t=IM;IM=null,OC=0,qw=null;for(var e=0;e<t.length;e++)(0,t[e])()}}function jPe(t,e){var n=[],i={status:"pending",value:null,reason:null,then:function(r){n.push(r)}};return t.then(function(){i.status="fulfilled",i.value=e;for(var r=0;r<n.length;r++)(0,n[r])(e)},function(r){for(i.status="rejected",i.reason=r,r=0;r<n.length;r++)(0,n[r])(void 0)}),i}var MQ=Bi.S;Bi.S=function(t,e){typeof e=="object"&&e!==null&&typeof e.then=="function"&&HPe(t,e),MQ!==null&&MQ(t,e)};var ET=f0(null);function pW(){var t=ET.current;return t!==null?t:aa.pooledCache}function a2(t,e){e===null?Ua(ET,ET.current):Ua(ET,e.pool)}function bhe(){var t=pW();return t===null?null:{parent:kc._currentValue,pool:t}}var SI=Error(jt(460)),Ehe=Error(jt(474)),QB=Error(jt(542)),QV={then:function(){}};function OQ(t){return t=t.status,t==="fulfilled"||t==="rejected"}function $D(){}function She(t,e,n){switch(n=t[n],n===void 0?t.push(e):n!==e&&(e.then($D,$D),e=n),e.status){case"fulfilled":return e.value;case"rejected":throw t=e.reason,IQ(t),t;default:if(typeof e.status=="string")e.then($D,$D);else{if(t=aa,t!==null&&100<t.shellSuspendCounter)throw Error(jt(482));t=e,t.status="pending",t.then(function(i){if(e.status==="pending"){var r=e;r.status="fulfilled",r.value=i}},function(i){if(e.status==="pending"){var r=e;r.status="rejected",r.reason=i}})}switch(e.status){case"fulfilled":return e.value;case"rejected":throw t=e.reason,IQ(t),t}throw kM=e,SI}}var kM=null;function NQ(){if(kM===null)throw Error(jt(459));var t=kM;return kM=null,t}function IQ(t){if(t===SI||t===QB)throw Error(jt(483))}var Wy=!1;function mW(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function eG(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,callbacks:null})}function Eb(t){return{lane:t,tag:0,payload:null,callback:null,next:null}}function Sb(t,e,n){var i=t.updateQueue;if(i===null)return null;if(i=i.shared,Ms&2){var r=i.pending;return r===null?e.next=e:(e.next=r.next,r.next=e),i.pending=e,e=aU(t),ghe(t,null,n),e}return JB(t,i,e,n),aU(t)}function DM(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194048)!==0)){var i=e.lanes;i&=t.pendingLanes,n|=i,e.lanes=n,Gue(t,n)}}function jH(t,e){var n=t.updateQueue,i=t.alternate;if(i!==null&&(i=i.updateQueue,n===i)){var r=null,s=null;if(n=n.firstBaseUpdate,n!==null){do{var a={lane:n.lane,tag:n.tag,payload:n.payload,callback:null,next:null};s===null?r=s=a:s=s.next=a,n=n.next}while(n!==null);s===null?r=s=e:s=s.next=e}else r=s=e;n={baseState:i.baseState,firstBaseUpdate:r,lastBaseUpdate:s,shared:i.shared,callbacks:i.callbacks},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}var tG=!1;function PM(){if(tG){var t=qw;if(t!==null)throw t}}function LM(t,e,n,i){tG=!1;var r=t.updateQueue;Wy=!1;var s=r.firstBaseUpdate,a=r.lastBaseUpdate,o=r.shared.pending;if(o!==null){r.shared.pending=null;var c=o,l=c.next;c.next=null,a===null?s=l:a.next=l,a=c;var u=t.alternate;u!==null&&(u=u.updateQueue,o=u.lastBaseUpdate,o!==a&&(o===null?u.firstBaseUpdate=l:o.next=l,u.lastBaseUpdate=c))}if(s!==null){var h=r.baseState;a=0,u=l=c=null,o=s;do{var f=o.lane&-536870913,d=f!==o.lane;if(d?(Gr&f)===f:(i&f)===f){f!==0&&f===OC&&(tG=!0),u!==null&&(u=u.next={lane:0,tag:o.tag,payload:o.payload,callback:null,next:null});e:{var p=t,g=o;f=e;var y=n;switch(g.tag){case 1:if(p=g.payload,typeof p=="function"){h=p.call(y,h,f);break e}h=p;break e;case 3:p.flags=p.flags&-65537|128;case 0:if(p=g.payload,f=typeof p=="function"?p.call(y,h,f):p,f==null)break e;h=xa({},h,f);break e;case 2:Wy=!0}}f=o.callback,f!==null&&(t.flags|=64,d&&(t.flags|=8192),d=r.callbacks,d===null?r.callbacks=[f]:d.push(f))}else d={lane:f,tag:o.tag,payload:o.payload,callback:o.callback,next:null},u===null?(l=u=d,c=h):u=u.next=d,a|=f;if(o=o.next,o===null){if(o=r.shared.pending,o===null)break;d=o,o=d.next,d.next=null,r.lastBaseUpdate=d,r.shared.pending=null}}while(!0);u===null&&(c=h),r.baseState=c,r.firstBaseUpdate=l,r.lastBaseUpdate=u,s===null&&(r.shared.lanes=0),Wb|=a,t.lanes=a,t.memoizedState=h}}function The(t,e){if(typeof t!="function")throw Error(jt(191,t));t.call(e)}function xhe(t,e){var n=t.callbacks;if(n!==null)for(t.callbacks=null,t=0;t<n.length;t++)The(n[t],e)}var NC=f0(null),uU=f0(0);function kQ(t,e){t=b_,Ua(uU,t),Ua(NC,e),b_=t|e.baseLanes}function nG(){Ua(uU,b_),Ua(NC,NC.current)}function gW(){b_=uU.current,_l(NC),_l(uU)}var qb=0,_r=null,zs=null,lc=null,hU=!1,$w=!1,FT=!1,fU=0,IO=0,Ww=null,VPe=0;function Po(){throw Error(jt(321))}function vW(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!od(t[n],e[n]))return!1;return!0}function _W(t,e,n,i,r,s){return qb=s,_r=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,Bi.H=t===null||t.memoizedState===null?tfe:nfe,FT=!1,s=n(i,r),FT=!1,$w&&(s=Che(e,n,i,r)),whe(t),s}function whe(t){Bi.H=dU;var e=zs!==null&&zs.next!==null;if(qb=0,lc=zs=_r=null,hU=!1,IO=0,Ww=null,e)throw Error(jt(300));t===null||ml||(t=t.dependencies,t!==null&&lU(t)&&(ml=!0))}function Che(t,e,n,i){_r=t;var r=0;do{if($w&&(Ww=null),IO=0,$w=!1,25<=r)throw Error(jt(301));if(r+=1,lc=zs=null,t.updateQueue!=null){var s=t.updateQueue;s.lastEffect=null,s.events=null,s.stores=null,s.memoCache!=null&&(s.memoCache.index=0)}Bi.H=KPe,s=e(n,i)}while($w);return s}function GPe(){var t=Bi.H,e=t.useState()[0];return e=typeof e.then=="function"?TI(e):e,t=t.useState()[0],(zs!==null?zs.memoizedState:null)!==t&&(_r.flags|=1024),e}function yW(){var t=fU!==0;return fU=0,t}function bW(t,e,n){e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~n}function EW(t){if(hU){for(t=t.memoizedState;t!==null;){var e=t.queue;e!==null&&(e.pending=null),t=t.next}hU=!1}qb=0,lc=zs=_r=null,$w=!1,IO=fU=0,Ww=null}function Uh(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return lc===null?_r.memoizedState=lc=t:lc=lc.next=t,lc}function fc(){if(zs===null){var t=_r.alternate;t=t!==null?t.memoizedState:null}else t=zs.next;var e=lc===null?_r.memoizedState:lc.next;if(e!==null)lc=e,zs=t;else{if(t===null)throw _r.alternate===null?Error(jt(467)):Error(jt(310));zs=t,t={memoizedState:zs.memoizedState,baseState:zs.baseState,baseQueue:zs.baseQueue,queue:zs.queue,next:null},lc===null?_r.memoizedState=lc=t:lc=lc.next=t}return lc}function SW(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function TI(t){var e=IO;return IO+=1,Ww===null&&(Ww=[]),t=She(Ww,t,e),e=_r,(lc===null?e.memoizedState:lc.next)===null&&(e=e.alternate,Bi.H=e===null||e.memoizedState===null?tfe:nfe),t}function eF(t){if(t!==null&&typeof t=="object"){if(typeof t.then=="function")return TI(t);if(t.$$typeof===Zv)return pu(t)}throw Error(jt(438,String(t)))}function TW(t){var e=null,n=_r.updateQueue;if(n!==null&&(e=n.memoCache),e==null){var i=_r.alternate;i!==null&&(i=i.updateQueue,i!==null&&(i=i.memoCache,i!=null&&(e={data:i.data.map(function(r){return r.slice()}),index:0})))}if(e==null&&(e={data:[],index:0}),n===null&&(n=SW(),_r.updateQueue=n),n.memoCache=e,n=e.data[e.index],n===void 0)for(n=e.data[e.index]=Array(t),i=0;i<t;i++)n[i]=RDe;return e.index++,n}function __(t,e){return typeof e=="function"?e(t):e}function o2(t){var e=fc();return xW(e,zs,t)}function xW(t,e,n){var i=t.queue;if(i===null)throw Error(jt(311));i.lastRenderedReducer=n;var r=t.baseQueue,s=i.pending;if(s!==null){if(r!==null){var a=r.next;r.next=s.next,s.next=a}e.baseQueue=r=s,i.pending=null}if(s=t.baseState,r===null)t.memoizedState=s;else{e=r.next;var o=a=null,c=null,l=e,u=!1;do{var h=l.lane&-536870913;if(h!==l.lane?(Gr&h)===h:(qb&h)===h){var f=l.revertLane;if(f===0)c!==null&&(c=c.next={lane:0,revertLane:0,action:l.action,hasEagerState:l.hasEagerState,eagerState:l.eagerState,next:null}),h===OC&&(u=!0);else if((qb&f)===f){l=l.next,f===OC&&(u=!0);continue}else h={lane:0,revertLane:l.revertLane,action:l.action,hasEagerState:l.hasEagerState,eagerState:l.eagerState,next:null},c===null?(o=c=h,a=s):c=c.next=h,_r.lanes|=f,Wb|=f;h=l.action,FT&&n(s,h),s=l.hasEagerState?l.eagerState:n(s,h)}else f={lane:h,revertLane:l.revertLane,action:l.action,hasEagerState:l.hasEagerState,eagerState:l.eagerState,next:null},c===null?(o=c=f,a=s):c=c.next=f,_r.lanes|=h,Wb|=h;l=l.next}while(l!==null&&l!==e);if(c===null?a=s:c.next=o,!od(s,t.memoizedState)&&(ml=!0,u&&(n=qw,n!==null)))throw n;t.memoizedState=s,t.baseState=a,t.baseQueue=c,i.lastRenderedState=s}return r===null&&(i.lanes=0),[t.memoizedState,i.dispatch]}function VH(t){var e=fc(),n=e.queue;if(n===null)throw Error(jt(311));n.lastRenderedReducer=t;var i=n.dispatch,r=n.pending,s=e.memoizedState;if(r!==null){n.pending=null;var a=r=r.next;do s=t(s,a.action),a=a.next;while(a!==r);od(s,e.memoizedState)||(ml=!0),e.memoizedState=s,e.baseQueue===null&&(e.baseState=s),n.lastRenderedState=s}return[s,i]}function Ahe(t,e,n){var i=_r,r=fc(),s=_s;if(s){if(n===void 0)throw Error(jt(407));n=n()}else n=e();var a=!od((zs||r).memoizedState,n);a&&(r.memoizedState=n,ml=!0),r=r.queue;var o=Ohe.bind(null,i,r,t);if(xI(2048,8,o,[t]),r.getSnapshot!==e||a||lc!==null&&lc.memoizedState.tag&1){if(i.flags|=2048,IC(9,tF(),Mhe.bind(null,i,r,n,e),null),aa===null)throw Error(jt(349));s||qb&124||Rhe(i,e,n)}return n}function Rhe(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=_r.updateQueue,e===null?(e=SW(),_r.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function Mhe(t,e,n,i){e.value=n,e.getSnapshot=i,Nhe(e)&&Ihe(t)}function Ohe(t,e,n){return n(function(){Nhe(e)&&Ihe(t)})}function Nhe(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!od(t,n)}catch{return!0}}function Ihe(t){var e=AA(t,2);e!==null&&rd(e,t,2)}function iG(t){var e=Uh();if(typeof t=="function"){var n=t;if(t=n(),FT){hb(!0);try{n()}finally{hb(!1)}}}return e.memoizedState=e.baseState=t,e.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:__,lastRenderedState:t},e}function khe(t,e,n,i){return t.baseState=n,xW(t,zs,typeof i=="function"?i:__)}function qPe(t,e,n,i,r){if(nF(t))throw Error(jt(485));if(t=e.action,t!==null){var s={payload:r,action:t,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(a){s.listeners.push(a)}};Bi.T!==null?n(!0):s.isTransition=!1,i(s),n=e.pending,n===null?(s.next=e.pending=s,Dhe(e,s)):(s.next=n.next,e.pending=n.next=s)}}function Dhe(t,e){var n=e.action,i=e.payload,r=t.state;if(e.isTransition){var s=Bi.T,a={};Bi.T=a;try{var o=n(r,i),c=Bi.S;c!==null&&c(a,o),DQ(t,e,o)}catch(l){rG(t,e,l)}finally{Bi.T=s}}else try{s=n(r,i),DQ(t,e,s)}catch(l){rG(t,e,l)}}function DQ(t,e,n){n!==null&&typeof n=="object"&&typeof n.then=="function"?n.then(function(i){PQ(t,e,i)},function(i){return rG(t,e,i)}):PQ(t,e,n)}function PQ(t,e,n){e.status="fulfilled",e.value=n,Phe(e),t.state=n,e=t.pending,e!==null&&(n=e.next,n===e?t.pending=null:(n=n.next,e.next=n,Dhe(t,n)))}function rG(t,e,n){var i=t.pending;if(t.pending=null,i!==null){i=i.next;do e.status="rejected",e.reason=n,Phe(e),e=e.next;while(e!==i)}t.action=null}function Phe(t){t=t.listeners;for(var e=0;e<t.length;e++)(0,t[e])()}function Lhe(t,e){return e}function LQ(t,e){if(_s){var n=aa.formState;if(n!==null){e:{var i=_r;if(_s){if(yo){t:{for(var r=yo,s=Cg;r.nodeType!==8;){if(!s){r=null;break t}if(r=fm(r.nextSibling),r===null){r=null;break t}}s=r.data,r=s==="F!"||s==="F"?r:null}if(r){yo=fm(r.nextSibling),i=r.data==="F!";break e}}UT(i)}i=!1}i&&(e=n[0])}}return n=Uh(),n.memoizedState=n.baseState=e,i={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Lhe,lastRenderedState:e},n.queue=i,n=Jhe.bind(null,_r,i),i.dispatch=n,i=iG(!1),s=RW.bind(null,_r,!1,i.queue),i=Uh(),r={state:e,dispatch:null,action:t,pending:null},i.queue=r,n=qPe.bind(null,_r,r,s,n),r.dispatch=n,i.memoizedState=t,[e,n,!1]}function UQ(t){var e=fc();return Uhe(e,zs,t)}function Uhe(t,e,n){if(e=xW(t,e,Lhe)[0],t=o2(__)[0],typeof e=="object"&&e!==null&&typeof e.then=="function")try{var i=TI(e)}catch(a){throw a===SI?QB:a}else i=e;e=fc();var r=e.queue,s=r.dispatch;return n!==e.memoizedState&&(_r.flags|=2048,IC(9,tF(),$Pe.bind(null,r,n),null)),[i,s,t]}function $Pe(t,e){t.action=e}function BQ(t){var e=fc(),n=zs;if(n!==null)return Uhe(e,n,t);fc(),e=e.memoizedState,n=fc();var i=n.queue.dispatch;return n.memoizedState=t,[e,i,!1]}function IC(t,e,n,i){return t={tag:t,create:n,deps:i,inst:e,next:null},e=_r.updateQueue,e===null&&(e=SW(),_r.updateQueue=e),n=e.lastEffect,n===null?e.lastEffect=t.next=t:(i=n.next,n.next=t,t.next=i,e.lastEffect=t),t}function tF(){return{destroy:void 0,resource:void 0}}function Bhe(){return fc().memoizedState}function c2(t,e,n,i){var r=Uh();i=i===void 0?null:i,_r.flags|=t,r.memoizedState=IC(1|e,tF(),n,i)}function xI(t,e,n,i){var r=fc();i=i===void 0?null:i;var s=r.memoizedState.inst;zs!==null&&i!==null&&vW(i,zs.memoizedState.deps)?r.memoizedState=IC(e,s,n,i):(_r.flags|=t,r.memoizedState=IC(1|e,s,n,i))}function FQ(t,e){c2(8390656,8,t,e)}function Fhe(t,e){xI(2048,8,t,e)}function zhe(t,e){return xI(4,2,t,e)}function Hhe(t,e){return xI(4,4,t,e)}function jhe(t,e){if(typeof e=="function"){t=t();var n=e(t);return function(){typeof n=="function"?n():e(null)}}if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function Vhe(t,e,n){n=n!=null?n.concat([t]):null,xI(4,4,jhe.bind(null,e,t),n)}function wW(){}function Ghe(t,e){var n=fc();e=e===void 0?null:e;var i=n.memoizedState;return e!==null&&vW(e,i[1])?i[0]:(n.memoizedState=[t,e],t)}function qhe(t,e){var n=fc();e=e===void 0?null:e;var i=n.memoizedState;if(e!==null&&vW(e,i[1]))return i[0];if(i=t(),FT){hb(!0);try{t()}finally{hb(!1)}}return n.memoizedState=[i,e],i}function CW(t,e,n){return n===void 0||qb&1073741824?t.memoizedState=e:(t.memoizedState=n,t=Pfe(),_r.lanes|=t,Wb|=t,n)}function $he(t,e,n,i){return od(n,e)?n:NC.current!==null?(t=CW(t,n,i),od(t,e)||(ml=!0),t):qb&42?(t=Pfe(),_r.lanes|=t,Wb|=t,e):(ml=!0,t.memoizedState=n)}function Whe(t,e,n,i,r){var s=ys.p;ys.p=s!==0&&8>s?s:8;var a=Bi.T,o={};Bi.T=o,RW(t,!1,e,n);try{var c=r(),l=Bi.S;if(l!==null&&l(o,c),c!==null&&typeof c=="object"&&typeof c.then=="function"){var u=jPe(c,i);UM(t,e,u,id(t))}else UM(t,e,i,id(t))}catch(h){UM(t,e,{then:function(){},status:"rejected",reason:h},id())}finally{ys.p=s,Bi.T=a}}function WPe(){}function sG(t,e,n,i){if(t.tag!==5)throw Error(jt(476));var r=Yhe(t).queue;Whe(t,r,e,vT,n===null?WPe:function(){return Xhe(t),n(i)})}function Yhe(t){var e=t.memoizedState;if(e!==null)return e;e={memoizedState:vT,baseState:vT,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:__,lastRenderedState:vT},next:null};var n={};return e.next={memoizedState:n,baseState:n,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:__,lastRenderedState:n},next:null},t.memoizedState=e,t=t.alternate,t!==null&&(t.memoizedState=e),e}function Xhe(t){var e=Yhe(t).next.queue;UM(t,e,{},id())}function AW(){return pu(UO)}function Khe(){return fc().memoizedState}function Zhe(){return fc().memoizedState}function YPe(t){for(var e=t.return;e!==null;){switch(e.tag){case 24:case 3:var n=id();t=Eb(n);var i=Sb(e,t,n);i!==null&&(rd(i,e,n),DM(i,e,n)),e={cache:dW()},t.payload=e;return}e=e.return}}function XPe(t,e,n){var i=id();n={lane:i,revertLane:0,action:n,hasEagerState:!1,eagerState:null,next:null},nF(t)?Qhe(e,n):(n=lW(t,e,n,i),n!==null&&(rd(n,t,i),efe(n,e,i)))}function Jhe(t,e,n){var i=id();UM(t,e,n,i)}function UM(t,e,n,i){var r={lane:i,revertLane:0,action:n,hasEagerState:!1,eagerState:null,next:null};if(nF(t))Qhe(e,r);else{var s=t.alternate;if(t.lanes===0&&(s===null||s.lanes===0)&&(s=e.lastRenderedReducer,s!==null))try{var a=e.lastRenderedState,o=s(a,n);if(r.hasEagerState=!0,r.eagerState=o,od(o,a))return JB(t,e,r,0),aa===null&&ZB(),!1}catch{}finally{}if(n=lW(t,e,r,i),n!==null)return rd(n,t,i),efe(n,e,i),!0}return!1}function RW(t,e,n,i){if(i={lane:2,revertLane:LW(),action:i,hasEagerState:!1,eagerState:null,next:null},nF(t)){if(e)throw Error(jt(479))}else e=lW(t,n,i,2),e!==null&&rd(e,t,2)}function nF(t){var e=t.alternate;return t===_r||e!==null&&e===_r}function Qhe(t,e){$w=hU=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function efe(t,e,n){if(n&4194048){var i=e.lanes;i&=t.pendingLanes,n|=i,e.lanes=n,Gue(t,n)}}var dU={readContext:pu,use:eF,useCallback:Po,useContext:Po,useEffect:Po,useImperativeHandle:Po,useLayoutEffect:Po,useInsertionEffect:Po,useMemo:Po,useReducer:Po,useRef:Po,useState:Po,useDebugValue:Po,useDeferredValue:Po,useTransition:Po,useSyncExternalStore:Po,useId:Po,useHostTransitionStatus:Po,useFormState:Po,useActionState:Po,useOptimistic:Po,useMemoCache:Po,useCacheRefresh:Po},tfe={readContext:pu,use:eF,useCallback:function(t,e){return Uh().memoizedState=[t,e===void 0?null:e],t},useContext:pu,useEffect:FQ,useImperativeHandle:function(t,e,n){n=n!=null?n.concat([t]):null,c2(4194308,4,jhe.bind(null,e,t),n)},useLayoutEffect:function(t,e){return c2(4194308,4,t,e)},useInsertionEffect:function(t,e){c2(4,2,t,e)},useMemo:function(t,e){var n=Uh();e=e===void 0?null:e;var i=t();if(FT){hb(!0);try{t()}finally{hb(!1)}}return n.memoizedState=[i,e],i},useReducer:function(t,e,n){var i=Uh();if(n!==void 0){var r=n(e);if(FT){hb(!0);try{n(e)}finally{hb(!1)}}}else r=e;return i.memoizedState=i.baseState=r,t={pending:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:r},i.queue=t,t=t.dispatch=XPe.bind(null,_r,t),[i.memoizedState,t]},useRef:function(t){var e=Uh();return t={current:t},e.memoizedState=t},useState:function(t){t=iG(t);var e=t.queue,n=Jhe.bind(null,_r,e);return e.dispatch=n,[t.memoizedState,n]},useDebugValue:wW,useDeferredValue:function(t,e){var n=Uh();return CW(n,t,e)},useTransition:function(){var t=iG(!1);return t=Whe.bind(null,_r,t.queue,!0,!1),Uh().memoizedState=t,[!1,t]},useSyncExternalStore:function(t,e,n){var i=_r,r=Uh();if(_s){if(n===void 0)throw Error(jt(407));n=n()}else{if(n=e(),aa===null)throw Error(jt(349));Gr&124||Rhe(i,e,n)}r.memoizedState=n;var s={value:n,getSnapshot:e};return r.queue=s,FQ(Ohe.bind(null,i,s,t),[t]),i.flags|=2048,IC(9,tF(),Mhe.bind(null,i,s,n,e),null),n},useId:function(){var t=Uh(),e=aa.identifierPrefix;if(_s){var n=Qv,i=Jv;n=(i&~(1<<32-nd(i)-1)).toString(32)+n,e="«"+e+"R"+n,n=fU++,0<n&&(e+="H"+n.toString(32)),e+="»"}else n=VPe++,e="«"+e+"r"+n.toString(32)+"»";return t.memoizedState=e},useHostTransitionStatus:AW,useFormState:LQ,useActionState:LQ,useOptimistic:function(t){var e=Uh();e.memoizedState=e.baseState=t;var n={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return e.queue=n,e=RW.bind(null,_r,!0,n),n.dispatch=e,[t,e]},useMemoCache:TW,useCacheRefresh:function(){return Uh().memoizedState=YPe.bind(null,_r)}},nfe={readContext:pu,use:eF,useCallback:Ghe,useContext:pu,useEffect:Fhe,useImperativeHandle:Vhe,useInsertionEffect:zhe,useLayoutEffect:Hhe,useMemo:qhe,useReducer:o2,useRef:Bhe,useState:function(){return o2(__)},useDebugValue:wW,useDeferredValue:function(t,e){var n=fc();return $he(n,zs.memoizedState,t,e)},useTransition:function(){var t=o2(__)[0],e=fc().memoizedState;return[typeof t=="boolean"?t:TI(t),e]},useSyncExternalStore:Ahe,useId:Khe,useHostTransitionStatus:AW,useFormState:UQ,useActionState:UQ,useOptimistic:function(t,e){var n=fc();return khe(n,zs,t,e)},useMemoCache:TW,useCacheRefresh:Zhe},KPe={readContext:pu,use:eF,useCallback:Ghe,useContext:pu,useEffect:Fhe,useImperativeHandle:Vhe,useInsertionEffect:zhe,useLayoutEffect:Hhe,useMemo:qhe,useReducer:VH,useRef:Bhe,useState:function(){return VH(__)},useDebugValue:wW,useDeferredValue:function(t,e){var n=fc();return zs===null?CW(n,t,e):$he(n,zs.memoizedState,t,e)},useTransition:function(){var t=VH(__)[0],e=fc().memoizedState;return[typeof t=="boolean"?t:TI(t),e]},useSyncExternalStore:Ahe,useId:Khe,useHostTransitionStatus:AW,useFormState:BQ,useActionState:BQ,useOptimistic:function(t,e){var n=fc();return zs!==null?khe(n,zs,t,e):(n.baseState=t,[t,n.queue.dispatch])},useMemoCache:TW,useCacheRefresh:Zhe},Yw=null,kO=0;function WD(t){var e=kO;return kO+=1,Yw===null&&(Yw=[]),She(Yw,t,e)}function OR(t,e){e=e.props.ref,t.ref=e!==void 0?e:null}function YD(t,e){throw e.$$typeof===CDe?Error(jt(525)):(t=Object.prototype.toString.call(e),Error(jt(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)))}function zQ(t){var e=t._init;return e(t._payload)}function ife(t){function e(v,b){if(t){var T=v.deletions;T===null?(v.deletions=[b],v.flags|=16):T.push(b)}}function n(v,b){if(!t)return null;for(;b!==null;)e(v,b),b=b.sibling;return null}function i(v){for(var b=new Map;v!==null;)v.key!==null?b.set(v.key,v):b.set(v.index,v),v=v.sibling;return b}function r(v,b){return v=o_(v,b),v.index=0,v.sibling=null,v}function s(v,b,T){return v.index=T,t?(T=v.alternate,T!==null?(T=T.index,T<b?(v.flags|=67108866,b):T):(v.flags|=67108866,b)):(v.flags|=1048576,b)}function a(v){return t&&v.alternate===null&&(v.flags|=67108866),v}function o(v,b,T,x){return b===null||b.tag!==6?(b=zH(T,v.mode,x),b.return=v,b):(b=r(b,T),b.return=v,b)}function c(v,b,T,x){var M=T.type;return M===gw?u(v,b,T.props.children,x,T.key):b!==null&&(b.elementType===M||typeof M=="object"&&M!==null&&M.$$typeof===$y&&zQ(M)===b.type)?(b=r(b,T.props),OR(b,T),b.return=v,b):(b=s2(T.type,T.key,T.props,null,v.mode,x),OR(b,T),b.return=v,b)}function l(v,b,T,x){return b===null||b.tag!==4||b.stateNode.containerInfo!==T.containerInfo||b.stateNode.implementation!==T.implementation?(b=HH(T,v.mode,x),b.return=v,b):(b=r(b,T.children||[]),b.return=v,b)}function u(v,b,T,x,M){return b===null||b.tag!==7?(b=_T(T,v.mode,x,M),b.return=v,b):(b=r(b,T),b.return=v,b)}function h(v,b,T){if(typeof b=="string"&&b!==""||typeof b=="number"||typeof b=="bigint")return b=zH(""+b,v.mode,T),b.return=v,b;if(typeof b=="object"&&b!==null){switch(b.$$typeof){case zD:return T=s2(b.type,b.key,b.props,null,v.mode,T),OR(T,b),T.return=v,T;case nM:return b=HH(b,v.mode,T),b.return=v,b;case $y:var x=b._init;return b=x(b._payload),h(v,b,T)}if(iM(b)||CR(b))return b=_T(b,v.mode,T,null),b.return=v,b;if(typeof b.then=="function")return h(v,WD(b),T);if(b.$$typeof===Zv)return h(v,qD(v,b),T);YD(v,b)}return null}function f(v,b,T,x){var M=b!==null?b.key:null;if(typeof T=="string"&&T!==""||typeof T=="number"||typeof T=="bigint")return M!==null?null:o(v,b,""+T,x);if(typeof T=="object"&&T!==null){switch(T.$$typeof){case zD:return T.key===M?c(v,b,T,x):null;case nM:return T.key===M?l(v,b,T,x):null;case $y:return M=T._init,T=M(T._payload),f(v,b,T,x)}if(iM(T)||CR(T))return M!==null?null:u(v,b,T,x,null);if(typeof T.then=="function")return f(v,b,WD(T),x);if(T.$$typeof===Zv)return f(v,b,qD(v,T),x);YD(v,T)}return null}function d(v,b,T,x,M){if(typeof x=="string"&&x!==""||typeof x=="number"||typeof x=="bigint")return v=v.get(T)||null,o(b,v,""+x,M);if(typeof x=="object"&&x!==null){switch(x.$$typeof){case zD:return v=v.get(x.key===null?T:x.key)||null,c(b,v,x,M);case nM:return v=v.get(x.key===null?T:x.key)||null,l(b,v,x,M);case $y:var R=x._init;return x=R(x._payload),d(v,b,T,x,M)}if(iM(x)||CR(x))return v=v.get(T)||null,u(b,v,x,M,null);if(typeof x.then=="function")return d(v,b,T,WD(x),M);if(x.$$typeof===Zv)return d(v,b,T,qD(b,x),M);YD(b,x)}return null}function p(v,b,T,x){for(var M=null,R=null,I=b,k=b=0,P=null;I!==null&&k<T.length;k++){I.index>k?(P=I,I=null):P=I.sibling;var U=f(v,I,T[k],x);if(U===null){I===null&&(I=P);break}t&&I&&U.alternate===null&&e(v,I),b=s(U,b,k),R===null?M=U:R.sibling=U,R=U,I=P}if(k===T.length)return n(v,I),_s&&GS(v,k),M;if(I===null){for(;k<T.length;k++)I=h(v,T[k],x),I!==null&&(b=s(I,b,k),R===null?M=I:R.sibling=I,R=I);return _s&&GS(v,k),M}for(I=i(I);k<T.length;k++)P=d(I,v,k,T[k],x),P!==null&&(t&&P.alternate!==null&&I.delete(P.key===null?k:P.key),b=s(P,b,k),R===null?M=P:R.sibling=P,R=P);return t&&I.forEach(function(G){return e(v,G)}),_s&&GS(v,k),M}function g(v,b,T,x){if(T==null)throw Error(jt(151));for(var M=null,R=null,I=b,k=b=0,P=null,U=T.next();I!==null&&!U.done;k++,U=T.next()){I.index>k?(P=I,I=null):P=I.sibling;var G=f(v,I,U.value,x);if(G===null){I===null&&(I=P);break}t&&I&&G.alternate===null&&e(v,I),b=s(G,b,k),R===null?M=G:R.sibling=G,R=G,I=P}if(U.done)return n(v,I),_s&&GS(v,k),M;if(I===null){for(;!U.done;k++,U=T.next())U=h(v,U.value,x),U!==null&&(b=s(U,b,k),R===null?M=U:R.sibling=U,R=U);return _s&&GS(v,k),M}for(I=i(I);!U.done;k++,U=T.next())U=d(I,v,k,U.value,x),U!==null&&(t&&U.alternate!==null&&I.delete(U.key===null?k:U.key),b=s(U,b,k),R===null?M=U:R.sibling=U,R=U);return t&&I.forEach(function($){return e(v,$)}),_s&&GS(v,k),M}function y(v,b,T,x){if(typeof T=="object"&&T!==null&&T.type===gw&&T.key===null&&(T=T.props.children),typeof T=="object"&&T!==null){switch(T.$$typeof){case zD:e:{for(var M=T.key;b!==null;){if(b.key===M){if(M=T.type,M===gw){if(b.tag===7){n(v,b.sibling),x=r(b,T.props.children),x.return=v,v=x;break e}}else if(b.elementType===M||typeof M=="object"&&M!==null&&M.$$typeof===$y&&zQ(M)===b.type){n(v,b.sibling),x=r(b,T.props),OR(x,T),x.return=v,v=x;break e}n(v,b);break}else e(v,b);b=b.sibling}T.type===gw?(x=_T(T.props.children,v.mode,x,T.key),x.return=v,v=x):(x=s2(T.type,T.key,T.props,null,v.mode,x),OR(x,T),x.return=v,v=x)}return a(v);case nM:e:{for(M=T.key;b!==null;){if(b.key===M)if(b.tag===4&&b.stateNode.containerInfo===T.containerInfo&&b.stateNode.implementation===T.implementation){n(v,b.sibling),x=r(b,T.children||[]),x.return=v,v=x;break e}else{n(v,b);break}else e(v,b);b=b.sibling}x=HH(T,v.mode,x),x.return=v,v=x}return a(v);case $y:return M=T._init,T=M(T._payload),y(v,b,T,x)}if(iM(T))return p(v,b,T,x);if(CR(T)){if(M=CR(T),typeof M!="function")throw Error(jt(150));return T=M.call(T),g(v,b,T,x)}if(typeof T.then=="function")return y(v,b,WD(T),x);if(T.$$typeof===Zv)return y(v,b,qD(v,T),x);YD(v,T)}return typeof T=="string"&&T!==""||typeof T=="number"||typeof T=="bigint"?(T=""+T,b!==null&&b.tag===6?(n(v,b.sibling),x=r(b,T),x.return=v,v=x):(n(v,b),x=zH(T,v.mode,x),x.return=v,v=x),a(v)):n(v,b)}return function(v,b,T,x){try{kO=0;var M=y(v,b,T,x);return Yw=null,M}catch(I){if(I===SI||I===QB)throw I;var R=Kf(29,I,null,v.mode);return R.lanes=x,R.return=v,R}finally{}}}var kC=ife(!0),rfe=ife(!1),pp=f0(null),zg=null;function sb(t){var e=t.alternate;Ua(Lc,Lc.current&1),Ua(pp,t),zg===null&&(e===null||NC.current!==null||e.memoizedState!==null)&&(zg=t)}function sfe(t){if(t.tag===22){if(Ua(Lc,Lc.current),Ua(pp,t),zg===null){var e=t.alternate;e!==null&&e.memoizedState!==null&&(zg=t)}}else ab()}function ab(){Ua(Lc,Lc.current),Ua(pp,pp.current)}function t_(t){_l(pp),zg===t&&(zg=null),_l(Lc)}var Lc=f0(0);function pU(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||SG(n)))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}function GH(t,e,n,i){e=t.memoizedState,n=n(i,e),n=n==null?e:xa({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var aG={enqueueSetState:function(t,e,n){t=t._reactInternals;var i=id(),r=Eb(i);r.payload=e,n!=null&&(r.callback=n),e=Sb(t,r,i),e!==null&&(rd(e,t,i),DM(e,t,i))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var i=id(),r=Eb(i);r.tag=1,r.payload=e,n!=null&&(r.callback=n),e=Sb(t,r,i),e!==null&&(rd(e,t,i),DM(e,t,i))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=id(),i=Eb(n);i.tag=2,e!=null&&(i.callback=e),e=Sb(t,i,n),e!==null&&(rd(e,t,n),DM(e,t,n))}};function HQ(t,e,n,i,r,s,a){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(i,s,a):e.prototype&&e.prototype.isPureReactComponent?!OO(n,i)||!OO(r,s):!0}function jQ(t,e,n,i){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,i),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,i),e.state!==t&&aG.enqueueReplaceState(e,e.state,null)}function zT(t,e){var n=e;if("ref"in e){n={};for(var i in e)i!=="ref"&&(n[i]=e[i])}if(t=t.defaultProps){n===e&&(n=xa({},n));for(var r in t)n[r]===void 0&&(n[r]=t[r])}return n}var mU=typeof reportError=="function"?reportError:function(t){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var e=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof t=="object"&&t!==null&&typeof t.message=="string"?String(t.message):String(t),error:t});if(!window.dispatchEvent(e))return}else if(typeof zn=="object"&&typeof zn.emit=="function"){zn.emit("uncaughtException",t);return}console.error(t)};function afe(t){mU(t)}function ofe(t){console.error(t)}function cfe(t){mU(t)}function gU(t,e){try{var n=t.onUncaughtError;n(e.value,{componentStack:e.stack})}catch(i){setTimeout(function(){throw i})}}function VQ(t,e,n){try{var i=t.onCaughtError;i(n.value,{componentStack:n.stack,errorBoundary:e.tag===1?e.stateNode:null})}catch(r){setTimeout(function(){throw r})}}function oG(t,e,n){return n=Eb(n),n.tag=3,n.payload={element:null},n.callback=function(){gU(t,e)},n}function lfe(t){return t=Eb(t),t.tag=3,t}function ufe(t,e,n,i){var r=n.type.getDerivedStateFromError;if(typeof r=="function"){var s=i.value;t.payload=function(){return r(s)},t.callback=function(){VQ(e,n,i)}}var a=n.stateNode;a!==null&&typeof a.componentDidCatch=="function"&&(t.callback=function(){VQ(e,n,i),typeof r!="function"&&(Tb===null?Tb=new Set([this]):Tb.add(this));var o=i.stack;this.componentDidCatch(i.value,{componentStack:o!==null?o:""})})}function ZPe(t,e,n,i,r){if(n.flags|=32768,i!==null&&typeof i=="object"&&typeof i.then=="function"){if(e=n.alternate,e!==null&&bI(e,n,r,!0),n=pp.current,n!==null){switch(n.tag){case 13:return zg===null?mG():n.alternate===null&&bo===0&&(bo=3),n.flags&=-257,n.flags|=65536,n.lanes=r,i===QV?n.flags|=16384:(e=n.updateQueue,e===null?n.updateQueue=new Set([i]):e.add(i),t5(t,i,r)),!1;case 22:return n.flags|=65536,i===QV?n.flags|=16384:(e=n.updateQueue,e===null?(e={transitions:null,markerInstances:null,retryQueue:new Set([i])},n.updateQueue=e):(n=e.retryQueue,n===null?e.retryQueue=new Set([i]):n.add(i)),t5(t,i,r)),!1}throw Error(jt(435,n.tag))}return t5(t,i,r),mG(),!1}if(_s)return e=pp.current,e!==null?(!(e.flags&65536)&&(e.flags|=256),e.flags|=65536,e.lanes=r,i!==YV&&(t=Error(jt(422),{cause:i}),NO(Kd(t,n)))):(i!==YV&&(e=Error(jt(423),{cause:i}),NO(Kd(e,n))),t=t.current.alternate,t.flags|=65536,r&=-r,t.lanes|=r,i=Kd(i,n),r=oG(t.stateNode,i,r),jH(t,r),bo!==4&&(bo=2)),!1;var s=Error(jt(520),{cause:i});if(s=Kd(s,n),zM===null?zM=[s]:zM.push(s),bo!==4&&(bo=2),e===null)return!0;i=Kd(i,n),n=e;do{switch(n.tag){case 3:return n.flags|=65536,t=r&-r,n.lanes|=t,t=oG(n.stateNode,i,t),jH(n,t),!1;case 1:if(e=n.type,s=n.stateNode,(n.flags&128)===0&&(typeof e.getDerivedStateFromError=="function"||s!==null&&typeof s.componentDidCatch=="function"&&(Tb===null||!Tb.has(s))))return n.flags|=65536,r&=-r,n.lanes|=r,r=lfe(r),ufe(r,t,n,i),jH(n,r),!1}n=n.return}while(n!==null);return!1}var hfe=Error(jt(461)),ml=!1;function Ll(t,e,n,i){e.child=t===null?rfe(e,null,n,i):kC(e,t.child,n,i)}function GQ(t,e,n,i,r){n=n.render;var s=e.ref;if("ref"in i){var a={};for(var o in i)o!=="ref"&&(a[o]=i[o])}else a=i;return BT(e),i=_W(t,e,n,a,s,r),o=yW(),t!==null&&!ml?(bW(t,e,r),y_(t,e,r)):(_s&&o&&hW(e),e.flags|=1,Ll(t,e,i,r),e.child)}function qQ(t,e,n,i,r){if(t===null){var s=n.type;return typeof s=="function"&&!uW(s)&&s.defaultProps===void 0&&n.compare===null?(e.tag=15,e.type=s,ffe(t,e,s,i,r)):(t=s2(n.type,null,i,e,e.mode,r),t.ref=e.ref,t.return=e,e.child=t)}if(s=t.child,!MW(t,r)){var a=s.memoizedProps;if(n=n.compare,n=n!==null?n:OO,n(a,i)&&t.ref===e.ref)return y_(t,e,r)}return e.flags|=1,t=o_(s,i),t.ref=e.ref,t.return=e,e.child=t}function ffe(t,e,n,i,r){if(t!==null){var s=t.memoizedProps;if(OO(s,i)&&t.ref===e.ref)if(ml=!1,e.pendingProps=i=s,MW(t,r))t.flags&131072&&(ml=!0);else return e.lanes=t.lanes,y_(t,e,r)}return cG(t,e,n,i,r)}function dfe(t,e,n){var i=e.pendingProps,r=i.children,s=t!==null?t.memoizedState:null;if(i.mode==="hidden"){if(e.flags&128){if(i=s!==null?s.baseLanes|n:n,t!==null){for(r=e.child=t.child,s=0;r!==null;)s=s|r.lanes|r.childLanes,r=r.sibling;e.childLanes=s&~i}else e.childLanes=0,e.child=null;return $Q(t,e,i,n)}if(n&536870912)e.memoizedState={baseLanes:0,cachePool:null},t!==null&&a2(e,s!==null?s.cachePool:null),s!==null?kQ(e,s):nG(),sfe(e);else return e.lanes=e.childLanes=536870912,$Q(t,e,s!==null?s.baseLanes|n:n,n)}else s!==null?(a2(e,s.cachePool),kQ(e,s),ab(),e.memoizedState=null):(t!==null&&a2(e,null),nG(),ab());return Ll(t,e,r,n),e.child}function $Q(t,e,n,i){var r=pW();return r=r===null?null:{parent:kc._currentValue,pool:r},e.memoizedState={baseLanes:n,cachePool:r},t!==null&&a2(e,null),nG(),sfe(e),t!==null&&bI(t,e,i,!0),null}function l2(t,e){var n=e.ref;if(n===null)t!==null&&t.ref!==null&&(e.flags|=4194816);else{if(typeof n!="function"&&typeof n!="object")throw Error(jt(284));(t===null||t.ref!==n)&&(e.flags|=4194816)}}function cG(t,e,n,i,r){return BT(e),n=_W(t,e,n,i,void 0,r),i=yW(),t!==null&&!ml?(bW(t,e,r),y_(t,e,r)):(_s&&i&&hW(e),e.flags|=1,Ll(t,e,n,r),e.child)}function WQ(t,e,n,i,r,s){return BT(e),e.updateQueue=null,n=Che(e,i,n,r),whe(t),i=yW(),t!==null&&!ml?(bW(t,e,s),y_(t,e,s)):(_s&&i&&hW(e),e.flags|=1,Ll(t,e,n,s),e.child)}function YQ(t,e,n,i,r){if(BT(e),e.stateNode===null){var s=xw,a=n.contextType;typeof a=="object"&&a!==null&&(s=pu(a)),s=new n(i,s),e.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,s.updater=aG,e.stateNode=s,s._reactInternals=e,s=e.stateNode,s.props=i,s.state=e.memoizedState,s.refs={},mW(e),a=n.contextType,s.context=typeof a=="object"&&a!==null?pu(a):xw,s.state=e.memoizedState,a=n.getDerivedStateFromProps,typeof a=="function"&&(GH(e,n,a,i),s.state=e.memoizedState),typeof n.getDerivedStateFromProps=="function"||typeof s.getSnapshotBeforeUpdate=="function"||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(a=s.state,typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount(),a!==s.state&&aG.enqueueReplaceState(s,s.state,null),LM(e,i,s,r),PM(),s.state=e.memoizedState),typeof s.componentDidMount=="function"&&(e.flags|=4194308),i=!0}else if(t===null){s=e.stateNode;var o=e.memoizedProps,c=zT(n,o);s.props=c;var l=s.context,u=n.contextType;a=xw,typeof u=="object"&&u!==null&&(a=pu(u));var h=n.getDerivedStateFromProps;u=typeof h=="function"||typeof s.getSnapshotBeforeUpdate=="function",o=e.pendingProps!==o,u||typeof s.UNSAFE_componentWillReceiveProps!="function"&&typeof s.componentWillReceiveProps!="function"||(o||l!==a)&&jQ(e,s,i,a),Wy=!1;var f=e.memoizedState;s.state=f,LM(e,i,s,r),PM(),l=e.memoizedState,o||f!==l||Wy?(typeof h=="function"&&(GH(e,n,h,i),l=e.memoizedState),(c=Wy||HQ(e,n,c,i,f,l,a))?(u||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount()),typeof s.componentDidMount=="function"&&(e.flags|=4194308)):(typeof s.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=i,e.memoizedState=l),s.props=i,s.state=l,s.context=a,i=c):(typeof s.componentDidMount=="function"&&(e.flags|=4194308),i=!1)}else{s=e.stateNode,eG(t,e),a=e.memoizedProps,u=zT(n,a),s.props=u,h=e.pendingProps,f=s.context,l=n.contextType,c=xw,typeof l=="object"&&l!==null&&(c=pu(l)),o=n.getDerivedStateFromProps,(l=typeof o=="function"||typeof s.getSnapshotBeforeUpdate=="function")||typeof s.UNSAFE_componentWillReceiveProps!="function"&&typeof s.componentWillReceiveProps!="function"||(a!==h||f!==c)&&jQ(e,s,i,c),Wy=!1,f=e.memoizedState,s.state=f,LM(e,i,s,r),PM();var d=e.memoizedState;a!==h||f!==d||Wy||t!==null&&t.dependencies!==null&&lU(t.dependencies)?(typeof o=="function"&&(GH(e,n,o,i),d=e.memoizedState),(u=Wy||HQ(e,n,u,i,f,d,c)||t!==null&&t.dependencies!==null&&lU(t.dependencies))?(l||typeof s.UNSAFE_componentWillUpdate!="function"&&typeof s.componentWillUpdate!="function"||(typeof s.componentWillUpdate=="function"&&s.componentWillUpdate(i,d,c),typeof s.UNSAFE_componentWillUpdate=="function"&&s.UNSAFE_componentWillUpdate(i,d,c)),typeof s.componentDidUpdate=="function"&&(e.flags|=4),typeof s.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof s.componentDidUpdate!="function"||a===t.memoizedProps&&f===t.memoizedState||(e.flags|=4),typeof s.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&f===t.memoizedState||(e.flags|=1024),e.memoizedProps=i,e.memoizedState=d),s.props=i,s.state=d,s.context=c,i=u):(typeof s.componentDidUpdate!="function"||a===t.memoizedProps&&f===t.memoizedState||(e.flags|=4),typeof s.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&f===t.memoizedState||(e.flags|=1024),i=!1)}return s=i,l2(t,e),i=(e.flags&128)!==0,s||i?(s=e.stateNode,n=i&&typeof n.getDerivedStateFromError!="function"?null:s.render(),e.flags|=1,t!==null&&i?(e.child=kC(e,t.child,null,r),e.child=kC(e,null,n,r)):Ll(t,e,n,r),e.memoizedState=s.state,t=e.child):t=y_(t,e,r),t}function XQ(t,e,n,i){return yI(),e.flags|=256,Ll(t,e,n,i),e.child}var qH={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function $H(t){return{baseLanes:t,cachePool:bhe()}}function WH(t,e,n){return t=t!==null?t.childLanes&~n:0,e&&(t|=rp),t}function pfe(t,e,n){var i=e.pendingProps,r=!1,s=(e.flags&128)!==0,a;if((a=s)||(a=t!==null&&t.memoizedState===null?!1:(Lc.current&2)!==0),a&&(r=!0,e.flags&=-129),a=(e.flags&32)!==0,e.flags&=-33,t===null){if(_s){if(r?sb(e):ab(),_s){var o=yo,c;if(c=o){e:{for(c=o,o=Cg;c.nodeType!==8;){if(!o){o=null;break e}if(c=fm(c.nextSibling),c===null){o=null;break e}}o=c}o!==null?(e.memoizedState={dehydrated:o,treeContext:yT!==null?{id:Jv,overflow:Qv}:null,retryLane:536870912,hydrationErrors:null},c=Kf(18,null,null,0),c.stateNode=o,c.return=e,e.child=c,nh=e,yo=null,c=!0):c=!1}c||UT(e)}if(o=e.memoizedState,o!==null&&(o=o.dehydrated,o!==null))return SG(o)?e.lanes=32:e.lanes=536870912,null;t_(e)}return o=i.children,i=i.fallback,r?(ab(),r=e.mode,o=vU({mode:"hidden",children:o},r),i=_T(i,r,n,null),o.return=e,i.return=e,o.sibling=i,e.child=o,r=e.child,r.memoizedState=$H(n),r.childLanes=WH(t,a,n),e.memoizedState=qH,i):(sb(e),lG(e,o))}if(c=t.memoizedState,c!==null&&(o=c.dehydrated,o!==null)){if(s)e.flags&256?(sb(e),e.flags&=-257,e=YH(t,e,n)):e.memoizedState!==null?(ab(),e.child=t.child,e.flags|=128,e=null):(ab(),r=i.fallback,o=e.mode,i=vU({mode:"visible",children:i.children},o),r=_T(r,o,n,null),r.flags|=2,i.return=e,r.return=e,i.sibling=r,e.child=i,kC(e,t.child,null,n),i=e.child,i.memoizedState=$H(n),i.childLanes=WH(t,a,n),e.memoizedState=qH,e=r);else if(sb(e),SG(o)){if(a=o.nextSibling&&o.nextSibling.dataset,a)var l=a.dgst;a=l,i=Error(jt(419)),i.stack="",i.digest=a,NO({value:i,source:null,stack:null}),e=YH(t,e,n)}else if(ml||bI(t,e,n,!1),a=(n&t.childLanes)!==0,ml||a){if(a=aa,a!==null&&(i=n&-n,i=i&42?1:Q7(i),i=i&(a.suspendedLanes|n)?0:i,i!==0&&i!==c.retryLane))throw c.retryLane=i,AA(t,i),rd(a,t,i),hfe;o.data==="$?"||mG(),e=YH(t,e,n)}else o.data==="$?"?(e.flags|=192,e.child=t.child,e=null):(t=c.treeContext,yo=fm(o.nextSibling),nh=e,_s=!0,bT=null,Cg=!1,t!==null&&(jd[Vd++]=Jv,jd[Vd++]=Qv,jd[Vd++]=yT,Jv=t.id,Qv=t.overflow,yT=e),e=lG(e,i.children),e.flags|=4096);return e}return r?(ab(),r=i.fallback,o=e.mode,c=t.child,l=c.sibling,i=o_(c,{mode:"hidden",children:i.children}),i.subtreeFlags=c.subtreeFlags&65011712,l!==null?r=o_(l,r):(r=_T(r,o,n,null),r.flags|=2),r.return=e,i.return=e,i.sibling=r,e.child=i,i=r,r=e.child,o=t.child.memoizedState,o===null?o=$H(n):(c=o.cachePool,c!==null?(l=kc._currentValue,c=c.parent!==l?{parent:l,pool:l}:c):c=bhe(),o={baseLanes:o.baseLanes|n,cachePool:c}),r.memoizedState=o,r.childLanes=WH(t,a,n),e.memoizedState=qH,i):(sb(e),n=t.child,t=n.sibling,n=o_(n,{mode:"visible",children:i.children}),n.return=e,n.sibling=null,t!==null&&(a=e.deletions,a===null?(e.deletions=[t],e.flags|=16):a.push(t)),e.child=n,e.memoizedState=null,n)}function lG(t,e){return e=vU({mode:"visible",children:e},t.mode),e.return=t,t.child=e}function vU(t,e){return t=Kf(22,t,null,e),t.lanes=0,t.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null},t}function YH(t,e,n){return kC(e,t.child,null,n),t=lG(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function KQ(t,e,n){t.lanes|=e;var i=t.alternate;i!==null&&(i.lanes|=e),KV(t.return,e,n)}function XH(t,e,n,i,r){var s=t.memoizedState;s===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:i,tail:n,tailMode:r}:(s.isBackwards=e,s.rendering=null,s.renderingStartTime=0,s.last=i,s.tail=n,s.tailMode=r)}function mfe(t,e,n){var i=e.pendingProps,r=i.revealOrder,s=i.tail;if(Ll(t,e,i.children,n),i=Lc.current,i&2)i=i&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&KQ(t,n,e);else if(t.tag===19)KQ(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}i&=1}switch(Ua(Lc,i),r){case"forwards":for(n=e.child,r=null;n!==null;)t=n.alternate,t!==null&&pU(t)===null&&(r=n),n=n.sibling;n=r,n===null?(r=e.child,e.child=null):(r=n.sibling,n.sibling=null),XH(e,!1,r,n,s);break;case"backwards":for(n=null,r=e.child,e.child=null;r!==null;){if(t=r.alternate,t!==null&&pU(t)===null){e.child=r;break}t=r.sibling,r.sibling=n,n=r,r=t}XH(e,!0,n,null,s);break;case"together":XH(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function y_(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),Wb|=e.lanes,!(n&e.childLanes))if(t!==null){if(bI(t,e,n,!1),(n&e.childLanes)===0)return null}else return null;if(t!==null&&e.child!==t.child)throw Error(jt(153));if(e.child!==null){for(t=e.child,n=o_(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=o_(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function MW(t,e){return t.lanes&e?!0:(t=t.dependencies,!!(t!==null&&lU(t)))}function JPe(t,e,n){switch(e.tag){case 3:tU(e,e.stateNode.containerInfo),rb(e,kc,t.memoizedState.cache),yI();break;case 27:case 5:BV(e);break;case 4:tU(e,e.stateNode.containerInfo);break;case 10:rb(e,e.type,e.memoizedProps.value);break;case 13:var i=e.memoizedState;if(i!==null)return i.dehydrated!==null?(sb(e),e.flags|=128,null):n&e.child.childLanes?pfe(t,e,n):(sb(e),t=y_(t,e,n),t!==null?t.sibling:null);sb(e);break;case 19:var r=(t.flags&128)!==0;if(i=(n&e.childLanes)!==0,i||(bI(t,e,n,!1),i=(n&e.childLanes)!==0),r){if(i)return mfe(t,e,n);e.flags|=128}if(r=e.memoizedState,r!==null&&(r.rendering=null,r.tail=null,r.lastEffect=null),Ua(Lc,Lc.current),i)break;return null;case 22:case 23:return e.lanes=0,dfe(t,e,n);case 24:rb(e,kc,t.memoizedState.cache)}return y_(t,e,n)}function gfe(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps)ml=!0;else{if(!MW(t,n)&&!(e.flags&128))return ml=!1,JPe(t,e,n);ml=!!(t.flags&131072)}else ml=!1,_s&&e.flags&1048576&&_he(e,cU,e.index);switch(e.lanes=0,e.tag){case 16:e:{t=e.pendingProps;var i=e.elementType,r=i._init;if(i=r(i._payload),e.type=i,typeof i=="function")uW(i)?(t=zT(i,t),e.tag=1,e=YQ(null,e,i,t,n)):(e.tag=0,e=cG(null,e,i,t,n));else{if(i!=null){if(r=i.$$typeof,r===K7){e.tag=11,e=GQ(null,e,i,t,n);break e}else if(r===Z7){e.tag=14,e=qQ(null,e,i,t,n);break e}}throw e=LV(i)||i,Error(jt(306,e,""))}}return e;case 0:return cG(t,e,e.type,e.pendingProps,n);case 1:return i=e.type,r=zT(i,e.pendingProps),YQ(t,e,i,r,n);case 3:e:{if(tU(e,e.stateNode.containerInfo),t===null)throw Error(jt(387));i=e.pendingProps;var s=e.memoizedState;r=s.element,eG(t,e),LM(e,i,null,n);var a=e.memoizedState;if(i=a.cache,rb(e,kc,i),i!==s.cache&&ZV(e,[kc],n,!0),PM(),i=a.element,s.isDehydrated)if(s={element:i,isDehydrated:!1,cache:a.cache},e.updateQueue.baseState=s,e.memoizedState=s,e.flags&256){e=XQ(t,e,i,n);break e}else if(i!==r){r=Kd(Error(jt(424)),e),NO(r),e=XQ(t,e,i,n);break e}else{switch(t=e.stateNode.containerInfo,t.nodeType){case 9:t=t.body;break;default:t=t.nodeName==="HTML"?t.ownerDocument.body:t}for(yo=fm(t.firstChild),nh=e,_s=!0,bT=null,Cg=!0,n=rfe(e,null,i,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling}else{if(yI(),i===r){e=y_(t,e,n);break e}Ll(t,e,i,n)}e=e.child}return e;case 26:return l2(t,e),t===null?(n=dee(e.type,null,e.pendingProps,null))?e.memoizedState=n:_s||(n=e.type,t=e.pendingProps,i=xU(bb.current).createElement(n),i[du]=e,i[sf]=t,Hl(i,n,t),hl(i),e.stateNode=i):e.memoizedState=dee(e.type,t.memoizedProps,e.pendingProps,t.memoizedState),null;case 27:return BV(e),t===null&&_s&&(i=e.stateNode=nde(e.type,e.pendingProps,bb.current),nh=e,Cg=!0,r=yo,_E(e.type)?(TG=r,yo=fm(i.firstChild)):yo=r),Ll(t,e,e.pendingProps.children,n),l2(t,e),t===null&&(e.flags|=4194304),e.child;case 5:return t===null&&_s&&((r=i=yo)&&(i=C2e(i,e.type,e.pendingProps,Cg),i!==null?(e.stateNode=i,nh=e,yo=fm(i.firstChild),Cg=!1,r=!0):r=!1),r||UT(e)),BV(e),r=e.type,s=e.pendingProps,a=t!==null?t.memoizedProps:null,i=s.children,bG(r,s)?i=null:a!==null&&bG(r,a)&&(e.flags|=32),e.memoizedState!==null&&(r=_W(t,e,GPe,null,null,n),UO._currentValue=r),l2(t,e),Ll(t,e,i,n),e.child;case 6:return t===null&&_s&&((t=n=yo)&&(n=A2e(n,e.pendingProps,Cg),n!==null?(e.stateNode=n,nh=e,yo=null,t=!0):t=!1),t||UT(e)),null;case 13:return pfe(t,e,n);case 4:return tU(e,e.stateNode.containerInfo),i=e.pendingProps,t===null?e.child=kC(e,null,i,n):Ll(t,e,i,n),e.child;case 11:return GQ(t,e,e.type,e.pendingProps,n);case 7:return Ll(t,e,e.pendingProps,n),e.child;case 8:return Ll(t,e,e.pendingProps.children,n),e.child;case 12:return Ll(t,e,e.pendingProps.children,n),e.child;case 10:return i=e.pendingProps,rb(e,e.type,i.value),Ll(t,e,i.children,n),e.child;case 9:return r=e.type._context,i=e.pendingProps.children,BT(e),r=pu(r),i=i(r),e.flags|=1,Ll(t,e,i,n),e.child;case 14:return qQ(t,e,e.type,e.pendingProps,n);case 15:return ffe(t,e,e.type,e.pendingProps,n);case 19:return mfe(t,e,n);case 31:return i=e.pendingProps,n=e.mode,i={mode:i.mode,children:i.children},t===null?(n=vU(i,n),n.ref=e.ref,e.child=n,n.return=e,e=n):(n=o_(t.child,i),n.ref=e.ref,e.child=n,n.return=e,e=n),e;case 22:return dfe(t,e,n);case 24:return BT(e),i=pu(kc),t===null?(r=pW(),r===null&&(r=aa,s=dW(),r.pooledCache=s,s.refCount++,s!==null&&(r.pooledCacheLanes|=n),r=s),e.memoizedState={parent:i,cache:r},mW(e),rb(e,kc,r)):(t.lanes&n&&(eG(t,e),LM(e,null,null,n),PM()),r=t.memoizedState,s=e.memoizedState,r.parent!==i?(r={parent:i,cache:i},e.memoizedState=r,e.lanes===0&&(e.memoizedState=e.updateQueue.baseState=r),rb(e,kc,i)):(i=s.cache,rb(e,kc,i),i!==r.cache&&ZV(e,[kc],n,!0))),Ll(t,e,e.pendingProps.children,n),e.child;case 29:throw e.pendingProps}throw Error(jt(156,e.tag))}function Cv(t){t.flags|=4}function ZQ(t,e){if(e.type!=="stylesheet"||e.state.loading&4)t.flags&=-16777217;else if(t.flags|=16777216,!sde(e)){if(e=pp.current,e!==null&&((Gr&4194048)===Gr?zg!==null:(Gr&62914560)!==Gr&&!(Gr&536870912)||e!==zg))throw kM=QV,Ehe;t.flags|=8192}}function XD(t,e){e!==null&&(t.flags|=4),t.flags&16384&&(e=t.tag!==22?jue():536870912,t.lanes|=e,DC|=e)}function NR(t,e){if(!_s)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var i=null;n!==null;)n.alternate!==null&&(i=n),n=n.sibling;i===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:i.sibling=null}}function Wa(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,i=0;if(e)for(var r=t.child;r!==null;)n|=r.lanes|r.childLanes,i|=r.subtreeFlags&65011712,i|=r.flags&65011712,r.return=t,r=r.sibling;else for(r=t.child;r!==null;)n|=r.lanes|r.childLanes,i|=r.subtreeFlags,i|=r.flags,r.return=t,r=r.sibling;return t.subtreeFlags|=i,t.childLanes=n,e}function QPe(t,e,n){var i=e.pendingProps;switch(fW(e),e.tag){case 31:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Wa(e),null;case 1:return Wa(e),null;case 3:return n=e.stateNode,i=null,t!==null&&(i=t.memoizedState.cache),e.memoizedState.cache!==i&&(e.flags|=2048),c_(kc),AC(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(t===null||t.child===null)&&(MR(e)?Cv(e):t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,AQ())),Wa(e),null;case 26:return n=e.memoizedState,t===null?(Cv(e),n!==null?(Wa(e),ZQ(e,n)):(Wa(e),e.flags&=-16777217)):n?n!==t.memoizedState?(Cv(e),Wa(e),ZQ(e,n)):(Wa(e),e.flags&=-16777217):(t.memoizedProps!==i&&Cv(e),Wa(e),e.flags&=-16777217),null;case 27:nU(e),n=bb.current;var r=e.type;if(t!==null&&e.stateNode!=null)t.memoizedProps!==i&&Cv(e);else{if(!i){if(e.stateNode===null)throw Error(jt(166));return Wa(e),null}t=Bg.current,MR(e)?wQ(e):(t=nde(r,i,n),e.stateNode=t,Cv(e))}return Wa(e),null;case 5:if(nU(e),n=e.type,t!==null&&e.stateNode!=null)t.memoizedProps!==i&&Cv(e);else{if(!i){if(e.stateNode===null)throw Error(jt(166));return Wa(e),null}if(t=Bg.current,MR(e))wQ(e);else{switch(r=xU(bb.current),t){case 1:t=r.createElementNS("http://www.w3.org/2000/svg",n);break;case 2:t=r.createElementNS("http://www.w3.org/1998/Math/MathML",n);break;default:switch(n){case"svg":t=r.createElementNS("http://www.w3.org/2000/svg",n);break;case"math":t=r.createElementNS("http://www.w3.org/1998/Math/MathML",n);break;case"script":t=r.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild);break;case"select":t=typeof i.is=="string"?r.createElement("select",{is:i.is}):r.createElement("select"),i.multiple?t.multiple=!0:i.size&&(t.size=i.size);break;default:t=typeof i.is=="string"?r.createElement(n,{is:i.is}):r.createElement(n)}}t[du]=e,t[sf]=i;e:for(r=e.child;r!==null;){if(r.tag===5||r.tag===6)t.appendChild(r.stateNode);else if(r.tag!==4&&r.tag!==27&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===e)break e;for(;r.sibling===null;){if(r.return===null||r.return===e)break e;r=r.return}r.sibling.return=r.return,r=r.sibling}e.stateNode=t;e:switch(Hl(t,n,i),n){case"button":case"input":case"select":case"textarea":t=!!i.autoFocus;break e;case"img":t=!0;break e;default:t=!1}t&&Cv(e)}}return Wa(e),e.flags&=-16777217,null;case 6:if(t&&e.stateNode!=null)t.memoizedProps!==i&&Cv(e);else{if(typeof i!="string"&&e.stateNode===null)throw Error(jt(166));if(t=bb.current,MR(e)){if(t=e.stateNode,n=e.memoizedProps,i=null,r=nh,r!==null)switch(r.tag){case 27:case 5:i=r.memoizedProps}t[du]=e,t=!!(t.nodeValue===n||i!==null&&i.suppressHydrationWarning===!0||Qfe(t.nodeValue,n)),t||UT(e)}else t=xU(t).createTextNode(i),t[du]=e,e.stateNode=t}return Wa(e),null;case 13:if(i=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(r=MR(e),i!==null&&i.dehydrated!==null){if(t===null){if(!r)throw Error(jt(318));if(r=e.memoizedState,r=r!==null?r.dehydrated:null,!r)throw Error(jt(317));r[du]=e}else yI(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;Wa(e),r=!1}else r=AQ(),t!==null&&t.memoizedState!==null&&(t.memoizedState.hydrationErrors=r),r=!0;if(!r)return e.flags&256?(t_(e),e):(t_(e),null)}if(t_(e),e.flags&128)return e.lanes=n,e;if(n=i!==null,t=t!==null&&t.memoizedState!==null,n){i=e.child,r=null,i.alternate!==null&&i.alternate.memoizedState!==null&&i.alternate.memoizedState.cachePool!==null&&(r=i.alternate.memoizedState.cachePool.pool);var s=null;i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(s=i.memoizedState.cachePool.pool),s!==r&&(i.flags|=2048)}return n!==t&&n&&(e.child.flags|=8192),XD(e,e.updateQueue),Wa(e),null;case 4:return AC(),t===null&&UW(e.stateNode.containerInfo),Wa(e),null;case 10:return c_(e.type),Wa(e),null;case 19:if(_l(Lc),r=e.memoizedState,r===null)return Wa(e),null;if(i=(e.flags&128)!==0,s=r.rendering,s===null)if(i)NR(r,!1);else{if(bo!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(s=pU(t),s!==null){for(e.flags|=128,NR(r,!1),t=s.updateQueue,e.updateQueue=t,XD(e,t),e.subtreeFlags=0,t=n,n=e.child;n!==null;)vhe(n,t),n=n.sibling;return Ua(Lc,Lc.current&1|2),e.child}t=t.sibling}r.tail!==null&&Fg()>yU&&(e.flags|=128,i=!0,NR(r,!1),e.lanes=4194304)}else{if(!i)if(t=pU(s),t!==null){if(e.flags|=128,i=!0,t=t.updateQueue,e.updateQueue=t,XD(e,t),NR(r,!0),r.tail===null&&r.tailMode==="hidden"&&!s.alternate&&!_s)return Wa(e),null}else 2*Fg()-r.renderingStartTime>yU&&n!==536870912&&(e.flags|=128,i=!0,NR(r,!1),e.lanes=4194304);r.isBackwards?(s.sibling=e.child,e.child=s):(t=r.last,t!==null?t.sibling=s:e.child=s,r.last=s)}return r.tail!==null?(e=r.tail,r.rendering=e,r.tail=e.sibling,r.renderingStartTime=Fg(),e.sibling=null,t=Lc.current,Ua(Lc,i?t&1|2:t&1),e):(Wa(e),null);case 22:case 23:return t_(e),gW(),i=e.memoizedState!==null,t!==null?t.memoizedState!==null!==i&&(e.flags|=8192):i&&(e.flags|=8192),i?n&536870912&&!(e.flags&128)&&(Wa(e),e.subtreeFlags&6&&(e.flags|=8192)):Wa(e),n=e.updateQueue,n!==null&&XD(e,n.retryQueue),n=null,t!==null&&t.memoizedState!==null&&t.memoizedState.cachePool!==null&&(n=t.memoizedState.cachePool.pool),i=null,e.memoizedState!==null&&e.memoizedState.cachePool!==null&&(i=e.memoizedState.cachePool.pool),i!==n&&(e.flags|=2048),t!==null&&_l(ET),null;case 24:return n=null,t!==null&&(n=t.memoizedState.cache),e.memoizedState.cache!==n&&(e.flags|=2048),c_(kc),Wa(e),null;case 25:return null;case 30:return null}throw Error(jt(156,e.tag))}function e2e(t,e){switch(fW(e),e.tag){case 1:return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return c_(kc),AC(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 26:case 27:case 5:return nU(e),null;case 13:if(t_(e),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(jt(340));yI()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return _l(Lc),null;case 4:return AC(),null;case 10:return c_(e.type),null;case 22:case 23:return t_(e),gW(),t!==null&&_l(ET),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 24:return c_(kc),null;case 25:return null;default:return null}}function vfe(t,e){switch(fW(e),e.tag){case 3:c_(kc),AC();break;case 26:case 27:case 5:nU(e);break;case 4:AC();break;case 13:t_(e);break;case 19:_l(Lc);break;case 10:c_(e.type);break;case 22:case 23:t_(e),gW(),t!==null&&_l(ET);break;case 24:c_(kc)}}function wI(t,e){try{var n=e.updateQueue,i=n!==null?n.lastEffect:null;if(i!==null){var r=i.next;n=r;do{if((n.tag&t)===t){i=void 0;var s=n.create,a=n.inst;i=s(),a.destroy=i}n=n.next}while(n!==r)}}catch(o){Xs(e,e.return,o)}}function $b(t,e,n){try{var i=e.updateQueue,r=i!==null?i.lastEffect:null;if(r!==null){var s=r.next;i=s;do{if((i.tag&t)===t){var a=i.inst,o=a.destroy;if(o!==void 0){a.destroy=void 0,r=e;var c=n,l=o;try{l()}catch(u){Xs(r,c,u)}}}i=i.next}while(i!==s)}}catch(u){Xs(e,e.return,u)}}function _fe(t){var e=t.updateQueue;if(e!==null){var n=t.stateNode;try{xhe(e,n)}catch(i){Xs(t,t.return,i)}}}function yfe(t,e,n){n.props=zT(t.type,t.memoizedProps),n.state=t.memoizedState;try{n.componentWillUnmount()}catch(i){Xs(t,e,i)}}function BM(t,e){try{var n=t.ref;if(n!==null){switch(t.tag){case 26:case 27:case 5:var i=t.stateNode;break;case 30:i=t.stateNode;break;default:i=t.stateNode}typeof n=="function"?t.refCleanup=n(i):n.current=i}}catch(r){Xs(t,e,r)}}function kg(t,e){var n=t.ref,i=t.refCleanup;if(n!==null)if(typeof i=="function")try{i()}catch(r){Xs(t,e,r)}finally{t.refCleanup=null,t=t.alternate,t!=null&&(t.refCleanup=null)}else if(typeof n=="function")try{n(null)}catch(r){Xs(t,e,r)}else n.current=null}function bfe(t){var e=t.type,n=t.memoizedProps,i=t.stateNode;try{e:switch(e){case"button":case"input":case"select":case"textarea":n.autoFocus&&i.focus();break e;case"img":n.src?i.src=n.src:n.srcSet&&(i.srcset=n.srcSet)}}catch(r){Xs(t,t.return,r)}}function KH(t,e,n){try{var i=t.stateNode;E2e(i,t.type,n,e),i[sf]=e}catch(r){Xs(t,t.return,r)}}function Efe(t){return t.tag===5||t.tag===3||t.tag===26||t.tag===27&&_E(t.type)||t.tag===4}function ZH(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||Efe(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.tag===27&&_E(t.type)||t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function uG(t,e,n){var i=t.tag;if(i===5||i===6)t=t.stateNode,e?(n.nodeType===9?n.body:n.nodeName==="HTML"?n.ownerDocument.body:n).insertBefore(t,e):(e=n.nodeType===9?n.body:n.nodeName==="HTML"?n.ownerDocument.body:n,e.appendChild(t),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=aF));else if(i!==4&&(i===27&&_E(t.type)&&(n=t.stateNode,e=null),t=t.child,t!==null))for(uG(t,e,n),t=t.sibling;t!==null;)uG(t,e,n),t=t.sibling}function _U(t,e,n){var i=t.tag;if(i===5||i===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(i!==4&&(i===27&&_E(t.type)&&(n=t.stateNode),t=t.child,t!==null))for(_U(t,e,n),t=t.sibling;t!==null;)_U(t,e,n),t=t.sibling}function Sfe(t){var e=t.stateNode,n=t.memoizedProps;try{for(var i=t.type,r=e.attributes;r.length;)e.removeAttributeNode(r[0]);Hl(e,i,n),e[du]=t,e[sf]=n}catch(s){Xs(t,t.return,s)}}var qv=!1,Fo=!1,JH=!1,JQ=typeof WeakSet=="function"?WeakSet:Set,cl=null;function t2e(t,e){if(t=t.containerInfo,_G=RU,t=lhe(t),oW(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var i=n.getSelection&&n.getSelection();if(i&&i.rangeCount!==0){n=i.anchorNode;var r=i.anchorOffset,s=i.focusNode;i=i.focusOffset;try{n.nodeType,s.nodeType}catch{n=null;break e}var a=0,o=-1,c=-1,l=0,u=0,h=t,f=null;t:for(;;){for(var d;h!==n||r!==0&&h.nodeType!==3||(o=a+r),h!==s||i!==0&&h.nodeType!==3||(c=a+i),h.nodeType===3&&(a+=h.nodeValue.length),(d=h.firstChild)!==null;)f=h,h=d;for(;;){if(h===t)break t;if(f===n&&++l===r&&(o=a),f===s&&++u===i&&(c=a),(d=h.nextSibling)!==null)break;h=f,f=h.parentNode}h=d}n=o===-1||c===-1?null:{start:o,end:c}}else n=null}n=n||{start:0,end:0}}else n=null;for(yG={focusedElem:t,selectionRange:n},RU=!1,cl=e;cl!==null;)if(e=cl,t=e.child,(e.subtreeFlags&1024)!==0&&t!==null)t.return=e,cl=t;else for(;cl!==null;){switch(e=cl,s=e.alternate,t=e.flags,e.tag){case 0:break;case 11:case 15:break;case 1:if(t&1024&&s!==null){t=void 0,n=e,r=s.memoizedProps,s=s.memoizedState,i=n.stateNode;try{var p=zT(n.type,r,n.elementType===n.type);t=i.getSnapshotBeforeUpdate(p,s),i.__reactInternalSnapshotBeforeUpdate=t}catch(g){Xs(n,n.return,g)}}break;case 3:if(t&1024){if(t=e.stateNode.containerInfo,n=t.nodeType,n===9)EG(t);else if(n===1)switch(t.nodeName){case"HEAD":case"HTML":case"BODY":EG(t);break;default:t.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if(t&1024)throw Error(jt(163))}if(t=e.sibling,t!==null){t.return=e.return,cl=t;break}cl=e.return}}function Tfe(t,e,n){var i=n.flags;switch(n.tag){case 0:case 11:case 15:Ry(t,n),i&4&&wI(5,n);break;case 1:if(Ry(t,n),i&4)if(t=n.stateNode,e===null)try{t.componentDidMount()}catch(a){Xs(n,n.return,a)}else{var r=zT(n.type,e.memoizedProps);e=e.memoizedState;try{t.componentDidUpdate(r,e,t.__reactInternalSnapshotBeforeUpdate)}catch(a){Xs(n,n.return,a)}}i&64&&_fe(n),i&512&&BM(n,n.return);break;case 3:if(Ry(t,n),i&64&&(t=n.updateQueue,t!==null)){if(e=null,n.child!==null)switch(n.child.tag){case 27:case 5:e=n.child.stateNode;break;case 1:e=n.child.stateNode}try{xhe(t,e)}catch(a){Xs(n,n.return,a)}}break;case 27:e===null&&i&4&&Sfe(n);case 26:case 5:Ry(t,n),e===null&&i&4&&bfe(n),i&512&&BM(n,n.return);break;case 12:Ry(t,n);break;case 13:Ry(t,n),i&4&&Cfe(t,n),i&64&&(t=n.memoizedState,t!==null&&(t=t.dehydrated,t!==null&&(n=u2e.bind(null,n),R2e(t,n))));break;case 22:if(i=n.memoizedState!==null||qv,!i){e=e!==null&&e.memoizedState!==null||Fo,r=qv;var s=Fo;qv=i,(Fo=e)&&!s?Fy(t,n,(n.subtreeFlags&8772)!==0):Ry(t,n),qv=r,Fo=s}break;case 30:break;default:Ry(t,n)}}function xfe(t){var e=t.alternate;e!==null&&(t.alternate=null,xfe(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&tW(e)),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}var Ia=null,Bh=!1;function Av(t,e,n){for(n=n.child;n!==null;)wfe(t,e,n),n=n.sibling}function wfe(t,e,n){if(td&&typeof td.onCommitFiberUnmount=="function")try{td.onCommitFiberUnmount(pI,n)}catch{}switch(n.tag){case 26:Fo||kg(n,e),Av(t,e,n),n.memoizedState?n.memoizedState.count--:n.stateNode&&(n=n.stateNode,n.parentNode.removeChild(n));break;case 27:Fo||kg(n,e);var i=Ia,r=Bh;_E(n.type)&&(Ia=n.stateNode,Bh=!1),Av(t,e,n),jM(n.stateNode),Ia=i,Bh=r;break;case 5:Fo||kg(n,e);case 6:if(i=Ia,r=Bh,Ia=null,Av(t,e,n),Ia=i,Bh=r,Ia!==null)if(Bh)try{(Ia.nodeType===9?Ia.body:Ia.nodeName==="HTML"?Ia.ownerDocument.body:Ia).removeChild(n.stateNode)}catch(s){Xs(n,e,s)}else try{Ia.removeChild(n.stateNode)}catch(s){Xs(n,e,s)}break;case 18:Ia!==null&&(Bh?(t=Ia,uee(t.nodeType===9?t.body:t.nodeName==="HTML"?t.ownerDocument.body:t,n.stateNode),zO(t)):uee(Ia,n.stateNode));break;case 4:i=Ia,r=Bh,Ia=n.stateNode.containerInfo,Bh=!0,Av(t,e,n),Ia=i,Bh=r;break;case 0:case 11:case 14:case 15:Fo||$b(2,n,e),Fo||$b(4,n,e),Av(t,e,n);break;case 1:Fo||(kg(n,e),i=n.stateNode,typeof i.componentWillUnmount=="function"&&yfe(n,e,i)),Av(t,e,n);break;case 21:Av(t,e,n);break;case 22:Fo=(i=Fo)||n.memoizedState!==null,Av(t,e,n),Fo=i;break;default:Av(t,e,n)}}function Cfe(t,e){if(e.memoizedState===null&&(t=e.alternate,t!==null&&(t=t.memoizedState,t!==null&&(t=t.dehydrated,t!==null))))try{zO(t)}catch(n){Xs(e,e.return,n)}}function n2e(t){switch(t.tag){case 13:case 19:var e=t.stateNode;return e===null&&(e=t.stateNode=new JQ),e;case 22:return t=t.stateNode,e=t._retryCache,e===null&&(e=t._retryCache=new JQ),e;default:throw Error(jt(435,t.tag))}}function QH(t,e){var n=n2e(t);e.forEach(function(i){var r=h2e.bind(null,t,i);n.has(i)||(n.add(i),i.then(r,r))})}function Pf(t,e){var n=e.deletions;if(n!==null)for(var i=0;i<n.length;i++){var r=n[i],s=t,a=e,o=a;e:for(;o!==null;){switch(o.tag){case 27:if(_E(o.type)){Ia=o.stateNode,Bh=!1;break e}break;case 5:Ia=o.stateNode,Bh=!1;break e;case 3:case 4:Ia=o.stateNode.containerInfo,Bh=!0;break e}o=o.return}if(Ia===null)throw Error(jt(160));wfe(s,a,r),Ia=null,Bh=!1,s=r.alternate,s!==null&&(s.return=null),r.return=null}if(e.subtreeFlags&13878)for(e=e.child;e!==null;)Afe(e,t),e=e.sibling}var tm=null;function Afe(t,e){var n=t.alternate,i=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:Pf(e,t),Lf(t),i&4&&($b(3,t,t.return),wI(3,t),$b(5,t,t.return));break;case 1:Pf(e,t),Lf(t),i&512&&(Fo||n===null||kg(n,n.return)),i&64&&qv&&(t=t.updateQueue,t!==null&&(i=t.callbacks,i!==null&&(n=t.shared.hiddenCallbacks,t.shared.hiddenCallbacks=n===null?i:n.concat(i))));break;case 26:var r=tm;if(Pf(e,t),Lf(t),i&512&&(Fo||n===null||kg(n,n.return)),i&4){var s=n!==null?n.memoizedState:null;if(i=t.memoizedState,n===null)if(i===null)if(t.stateNode===null){e:{i=t.type,n=t.memoizedProps,r=r.ownerDocument||r;t:switch(i){case"title":s=r.getElementsByTagName("title")[0],(!s||s[vI]||s[du]||s.namespaceURI==="http://www.w3.org/2000/svg"||s.hasAttribute("itemprop"))&&(s=r.createElement(i),r.head.insertBefore(s,r.querySelector("head > title"))),Hl(s,i,n),s[du]=t,hl(s),i=s;break e;case"link":var a=mee("link","href",r).get(i+(n.href||""));if(a){for(var o=0;o<a.length;o++)if(s=a[o],s.getAttribute("href")===(n.href==null||n.href===""?null:n.href)&&s.getAttribute("rel")===(n.rel==null?null:n.rel)&&s.getAttribute("title")===(n.title==null?null:n.title)&&s.getAttribute("crossorigin")===(n.crossOrigin==null?null:n.crossOrigin)){a.splice(o,1);break t}}s=r.createElement(i),Hl(s,i,n),r.head.appendChild(s);break;case"meta":if(a=mee("meta","content",r).get(i+(n.content||""))){for(o=0;o<a.length;o++)if(s=a[o],s.getAttribute("content")===(n.content==null?null:""+n.content)&&s.getAttribute("name")===(n.name==null?null:n.name)&&s.getAttribute("property")===(n.property==null?null:n.property)&&s.getAttribute("http-equiv")===(n.httpEquiv==null?null:n.httpEquiv)&&s.getAttribute("charset")===(n.charSet==null?null:n.charSet)){a.splice(o,1);break t}}s=r.createElement(i),Hl(s,i,n),r.head.appendChild(s);break;default:throw Error(jt(468,i))}s[du]=t,hl(s),i=s}t.stateNode=i}else gee(r,t.type,t.stateNode);else t.stateNode=pee(r,i,t.memoizedProps);else s!==i?(s===null?n.stateNode!==null&&(n=n.stateNode,n.parentNode.removeChild(n)):s.count--,i===null?gee(r,t.type,t.stateNode):pee(r,i,t.memoizedProps)):i===null&&t.stateNode!==null&&KH(t,t.memoizedProps,n.memoizedProps)}break;case 27:Pf(e,t),Lf(t),i&512&&(Fo||n===null||kg(n,n.return)),n!==null&&i&4&&KH(t,t.memoizedProps,n.memoizedProps);break;case 5:if(Pf(e,t),Lf(t),i&512&&(Fo||n===null||kg(n,n.return)),t.flags&32){r=t.stateNode;try{MC(r,"")}catch(d){Xs(t,t.return,d)}}i&4&&t.stateNode!=null&&(r=t.memoizedProps,KH(t,r,n!==null?n.memoizedProps:r)),i&1024&&(JH=!0);break;case 6:if(Pf(e,t),Lf(t),i&4){if(t.stateNode===null)throw Error(jt(162));i=t.memoizedProps,n=t.stateNode;try{n.nodeValue=i}catch(d){Xs(t,t.return,d)}}break;case 3:if(f2=null,r=tm,tm=wU(e.containerInfo),Pf(e,t),tm=r,Lf(t),i&4&&n!==null&&n.memoizedState.isDehydrated)try{zO(e.containerInfo)}catch(d){Xs(t,t.return,d)}JH&&(JH=!1,Rfe(t));break;case 4:i=tm,tm=wU(t.stateNode.containerInfo),Pf(e,t),Lf(t),tm=i;break;case 12:Pf(e,t),Lf(t);break;case 13:Pf(e,t),Lf(t),t.child.flags&8192&&t.memoizedState!==null!=(n!==null&&n.memoizedState!==null)&&(DW=Fg()),i&4&&(i=t.updateQueue,i!==null&&(t.updateQueue=null,QH(t,i)));break;case 22:r=t.memoizedState!==null;var c=n!==null&&n.memoizedState!==null,l=qv,u=Fo;if(qv=l||r,Fo=u||c,Pf(e,t),Fo=u,qv=l,Lf(t),i&8192)e:for(e=t.stateNode,e._visibility=r?e._visibility&-2:e._visibility|1,r&&(n===null||c||qv||Fo||qS(t)),n=null,e=t;;){if(e.tag===5||e.tag===26){if(n===null){c=n=e;try{if(s=c.stateNode,r)a=s.style,typeof a.setProperty=="function"?a.setProperty("display","none","important"):a.display="none";else{o=c.stateNode;var h=c.memoizedProps.style,f=h!=null&&h.hasOwnProperty("display")?h.display:null;o.style.display=f==null||typeof f=="boolean"?"":(""+f).trim()}}catch(d){Xs(c,c.return,d)}}}else if(e.tag===6){if(n===null){c=e;try{c.stateNode.nodeValue=r?"":c.memoizedProps}catch(d){Xs(c,c.return,d)}}}else if((e.tag!==22&&e.tag!==23||e.memoizedState===null||e===t)&&e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;n===e&&(n=null),e=e.return}n===e&&(n=null),e.sibling.return=e.return,e=e.sibling}i&4&&(i=t.updateQueue,i!==null&&(n=i.retryQueue,n!==null&&(i.retryQueue=null,QH(t,n))));break;case 19:Pf(e,t),Lf(t),i&4&&(i=t.updateQueue,i!==null&&(t.updateQueue=null,QH(t,i)));break;case 30:break;case 21:break;default:Pf(e,t),Lf(t)}}function Lf(t){var e=t.flags;if(e&2){try{for(var n,i=t.return;i!==null;){if(Efe(i)){n=i;break}i=i.return}if(n==null)throw Error(jt(160));switch(n.tag){case 27:var r=n.stateNode,s=ZH(t);_U(t,s,r);break;case 5:var a=n.stateNode;n.flags&32&&(MC(a,""),n.flags&=-33);var o=ZH(t);_U(t,o,a);break;case 3:case 4:var c=n.stateNode.containerInfo,l=ZH(t);uG(t,l,c);break;default:throw Error(jt(161))}}catch(u){Xs(t,t.return,u)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function Rfe(t){if(t.subtreeFlags&1024)for(t=t.child;t!==null;){var e=t;Rfe(e),e.tag===5&&e.flags&1024&&e.stateNode.reset(),t=t.sibling}}function Ry(t,e){if(e.subtreeFlags&8772)for(e=e.child;e!==null;)Tfe(t,e.alternate,e),e=e.sibling}function qS(t){for(t=t.child;t!==null;){var e=t;switch(e.tag){case 0:case 11:case 14:case 15:$b(4,e,e.return),qS(e);break;case 1:kg(e,e.return);var n=e.stateNode;typeof n.componentWillUnmount=="function"&&yfe(e,e.return,n),qS(e);break;case 27:jM(e.stateNode);case 26:case 5:kg(e,e.return),qS(e);break;case 22:e.memoizedState===null&&qS(e);break;case 30:qS(e);break;default:qS(e)}t=t.sibling}}function Fy(t,e,n){for(n=n&&(e.subtreeFlags&8772)!==0,e=e.child;e!==null;){var i=e.alternate,r=t,s=e,a=s.flags;switch(s.tag){case 0:case 11:case 15:Fy(r,s,n),wI(4,s);break;case 1:if(Fy(r,s,n),i=s,r=i.stateNode,typeof r.componentDidMount=="function")try{r.componentDidMount()}catch(l){Xs(i,i.return,l)}if(i=s,r=i.updateQueue,r!==null){var o=i.stateNode;try{var c=r.shared.hiddenCallbacks;if(c!==null)for(r.shared.hiddenCallbacks=null,r=0;r<c.length;r++)The(c[r],o)}catch(l){Xs(i,i.return,l)}}n&&a&64&&_fe(s),BM(s,s.return);break;case 27:Sfe(s);case 26:case 5:Fy(r,s,n),n&&i===null&&a&4&&bfe(s),BM(s,s.return);break;case 12:Fy(r,s,n);break;case 13:Fy(r,s,n),n&&a&4&&Cfe(r,s);break;case 22:s.memoizedState===null&&Fy(r,s,n),BM(s,s.return);break;case 30:break;default:Fy(r,s,n)}e=e.sibling}}function OW(t,e){var n=null;t!==null&&t.memoizedState!==null&&t.memoizedState.cachePool!==null&&(n=t.memoizedState.cachePool.pool),t=null,e.memoizedState!==null&&e.memoizedState.cachePool!==null&&(t=e.memoizedState.cachePool.pool),t!==n&&(t!=null&&t.refCount++,n!=null&&EI(n))}function NW(t,e){t=null,e.alternate!==null&&(t=e.alternate.memoizedState.cache),e=e.memoizedState.cache,e!==t&&(e.refCount++,t!=null&&EI(t))}function lg(t,e,n,i){if(e.subtreeFlags&10256)for(e=e.child;e!==null;)Mfe(t,e,n,i),e=e.sibling}function Mfe(t,e,n,i){var r=e.flags;switch(e.tag){case 0:case 11:case 15:lg(t,e,n,i),r&2048&&wI(9,e);break;case 1:lg(t,e,n,i);break;case 3:lg(t,e,n,i),r&2048&&(t=null,e.alternate!==null&&(t=e.alternate.memoizedState.cache),e=e.memoizedState.cache,e!==t&&(e.refCount++,t!=null&&EI(t)));break;case 12:if(r&2048){lg(t,e,n,i),t=e.stateNode;try{var s=e.memoizedProps,a=s.id,o=s.onPostCommit;typeof o=="function"&&o(a,e.alternate===null?"mount":"update",t.passiveEffectDuration,-0)}catch(c){Xs(e,e.return,c)}}else lg(t,e,n,i);break;case 13:lg(t,e,n,i);break;case 23:break;case 22:s=e.stateNode,a=e.alternate,e.memoizedState!==null?s._visibility&2?lg(t,e,n,i):FM(t,e):s._visibility&2?lg(t,e,n,i):(s._visibility|=2,iw(t,e,n,i,(e.subtreeFlags&10256)!==0)),r&2048&&OW(a,e);break;case 24:lg(t,e,n,i),r&2048&&NW(e.alternate,e);break;default:lg(t,e,n,i)}}function iw(t,e,n,i,r){for(r=r&&(e.subtreeFlags&10256)!==0,e=e.child;e!==null;){var s=t,a=e,o=n,c=i,l=a.flags;switch(a.tag){case 0:case 11:case 15:iw(s,a,o,c,r),wI(8,a);break;case 23:break;case 22:var u=a.stateNode;a.memoizedState!==null?u._visibility&2?iw(s,a,o,c,r):FM(s,a):(u._visibility|=2,iw(s,a,o,c,r)),r&&l&2048&&OW(a.alternate,a);break;case 24:iw(s,a,o,c,r),r&&l&2048&&NW(a.alternate,a);break;default:iw(s,a,o,c,r)}e=e.sibling}}function FM(t,e){if(e.subtreeFlags&10256)for(e=e.child;e!==null;){var n=t,i=e,r=i.flags;switch(i.tag){case 22:FM(n,i),r&2048&&OW(i.alternate,i);break;case 24:FM(n,i),r&2048&&NW(i.alternate,i);break;default:FM(n,i)}e=e.sibling}}var sM=8192;function Px(t){if(t.subtreeFlags&sM)for(t=t.child;t!==null;)Ofe(t),t=t.sibling}function Ofe(t){switch(t.tag){case 26:Px(t),t.flags&sM&&t.memoizedState!==null&&H2e(tm,t.memoizedState,t.memoizedProps);break;case 5:Px(t);break;case 3:case 4:var e=tm;tm=wU(t.stateNode.containerInfo),Px(t),tm=e;break;case 22:t.memoizedState===null&&(e=t.alternate,e!==null&&e.memoizedState!==null?(e=sM,sM=16777216,Px(t),sM=e):Px(t));break;default:Px(t)}}function Nfe(t){var e=t.alternate;if(e!==null&&(t=e.child,t!==null)){e.child=null;do e=t.sibling,t.sibling=null,t=e;while(t!==null)}}function IR(t){var e=t.deletions;if(t.flags&16){if(e!==null)for(var n=0;n<e.length;n++){var i=e[n];cl=i,kfe(i,t)}Nfe(t)}if(t.subtreeFlags&10256)for(t=t.child;t!==null;)Ife(t),t=t.sibling}function Ife(t){switch(t.tag){case 0:case 11:case 15:IR(t),t.flags&2048&&$b(9,t,t.return);break;case 3:IR(t);break;case 12:IR(t);break;case 22:var e=t.stateNode;t.memoizedState!==null&&e._visibility&2&&(t.return===null||t.return.tag!==13)?(e._visibility&=-3,u2(t)):IR(t);break;default:IR(t)}}function u2(t){var e=t.deletions;if(t.flags&16){if(e!==null)for(var n=0;n<e.length;n++){var i=e[n];cl=i,kfe(i,t)}Nfe(t)}for(t=t.child;t!==null;){switch(e=t,e.tag){case 0:case 11:case 15:$b(8,e,e.return),u2(e);break;case 22:n=e.stateNode,n._visibility&2&&(n._visibility&=-3,u2(e));break;default:u2(e)}t=t.sibling}}function kfe(t,e){for(;cl!==null;){var n=cl;switch(n.tag){case 0:case 11:case 15:$b(8,n,e);break;case 23:case 22:if(n.memoizedState!==null&&n.memoizedState.cachePool!==null){var i=n.memoizedState.cachePool.pool;i!=null&&i.refCount++}break;case 24:EI(n.memoizedState.cache)}if(i=n.child,i!==null)i.return=n,cl=i;else e:for(n=t;cl!==null;){i=cl;var r=i.sibling,s=i.return;if(xfe(i),i===n){cl=null;break e}if(r!==null){r.return=s,cl=r;break e}cl=s}}}var i2e={getCacheForType:function(t){var e=pu(kc),n=e.data.get(t);return n===void 0&&(n=t(),e.data.set(t,n)),n}},r2e=typeof WeakMap=="function"?WeakMap:Map,Ms=0,aa=null,Cr=null,Gr=0,Rs=0,jf=null,db=!1,RA=!1,IW=!1,b_=0,bo=0,Wb=0,ST=0,kW=0,rp=0,DC=0,zM=null,zh=null,hG=!1,DW=0,yU=1/0,bU=null,Tb=null,Bl=0,xb=null,PC=null,Xw=0,fG=0,dG=null,Dfe=null,HM=0,pG=null;function id(){if(Ms&2&&Gr!==0)return Gr&-Gr;if(Bi.T!==null){var t=OC;return t!==0?t:LW()}return que()}function Pfe(){rp===0&&(rp=!(Gr&536870912)||_s?Hue():536870912);var t=pp.current;return t!==null&&(t.flags|=32),rp}function rd(t,e,n){(t===aa&&(Rs===2||Rs===9)||t.cancelPendingCommit!==null)&&(LC(t,0),pb(t,Gr,rp,!1)),gI(t,n),(!(Ms&2)||t!==aa)&&(t===aa&&(!(Ms&2)&&(ST|=n),bo===4&&pb(t,Gr,rp,!1)),d0(t))}function Lfe(t,e,n){if(Ms&6)throw Error(jt(327));var i=!n&&(e&124)===0&&(e&t.expiredLanes)===0||mI(t,e),r=i?o2e(t,e):e5(t,e,!0),s=i;do{if(r===0){RA&&!i&&pb(t,e,0,!1);break}else{if(n=t.current.alternate,s&&!s2e(n)){r=e5(t,e,!1),s=!1;continue}if(r===2){if(s=e,t.errorRecoveryDisabledLanes&s)var a=0;else a=t.pendingLanes&-536870913,a=a!==0?a:a&536870912?536870912:0;if(a!==0){e=a;e:{var o=t;r=zM;var c=o.current.memoizedState.isDehydrated;if(c&&(LC(o,a).flags|=256),a=e5(o,a,!1),a!==2){if(IW&&!c){o.errorRecoveryDisabledLanes|=s,ST|=s,r=4;break e}s=zh,zh=r,s!==null&&(zh===null?zh=s:zh.push.apply(zh,s))}r=a}if(s=!1,r!==2)continue}}if(r===1){LC(t,0),pb(t,e,0,!0);break}e:{switch(i=t,s=r,s){case 0:case 1:throw Error(jt(345));case 4:if((e&4194048)!==e)break;case 6:pb(i,e,rp,!db);break e;case 2:zh=null;break;case 3:case 5:break;default:throw Error(jt(329))}if((e&62914560)===e&&(r=DW+300-Fg(),10<r)){if(pb(i,e,rp,!db),WB(i,0,!0)!==0)break e;i.timeoutHandle=tde(QQ.bind(null,i,n,zh,bU,hG,e,rp,ST,DC,db,s,2,-0,0),r);break e}QQ(i,n,zh,bU,hG,e,rp,ST,DC,db,s,0,-0,0)}}break}while(!0);d0(t)}function QQ(t,e,n,i,r,s,a,o,c,l,u,h,f,d){if(t.timeoutHandle=-1,h=e.subtreeFlags,(h&8192||(h&16785408)===16785408)&&(LO={stylesheets:null,count:0,unsuspend:z2e},Ofe(e),h=j2e(),h!==null)){t.cancelPendingCommit=h(tee.bind(null,t,e,s,n,i,r,a,o,c,u,1,f,d)),pb(t,s,a,!l);return}tee(t,e,s,n,i,r,a,o,c)}function s2e(t){for(var e=t;;){var n=e.tag;if((n===0||n===11||n===15)&&e.flags&16384&&(n=e.updateQueue,n!==null&&(n=n.stores,n!==null)))for(var i=0;i<n.length;i++){var r=n[i],s=r.getSnapshot;r=r.value;try{if(!od(s(),r))return!1}catch{return!1}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function pb(t,e,n,i){e&=~kW,e&=~ST,t.suspendedLanes|=e,t.pingedLanes&=~e,i&&(t.warmLanes|=e),i=t.expirationTimes;for(var r=e;0<r;){var s=31-nd(r),a=1<<s;i[s]=-1,r&=~a}n!==0&&Vue(t,n,e)}function iF(){return Ms&6?!0:(CI(0),!1)}function PW(){if(Cr!==null){if(Rs===0)var t=Cr.return;else t=Cr,e_=y1=null,EW(t),Yw=null,kO=0,t=Cr;for(;t!==null;)vfe(t.alternate,t),t=t.return;Cr=null}}function LC(t,e){var n=t.timeoutHandle;n!==-1&&(t.timeoutHandle=-1,T2e(n)),n=t.cancelPendingCommit,n!==null&&(t.cancelPendingCommit=null,n()),PW(),aa=t,Cr=n=o_(t.current,null),Gr=e,Rs=0,jf=null,db=!1,RA=mI(t,e),IW=!1,DC=rp=kW=ST=Wb=bo=0,zh=zM=null,hG=!1,e&8&&(e|=e&32);var i=t.entangledLanes;if(i!==0)for(t=t.entanglements,i&=e;0<i;){var r=31-nd(i),s=1<<r;e|=t[r],i&=~s}return b_=e,ZB(),n}function Ufe(t,e){_r=null,Bi.H=dU,e===SI||e===QB?(e=NQ(),Rs=3):e===Ehe?(e=NQ(),Rs=4):Rs=e===hfe?8:e!==null&&typeof e=="object"&&typeof e.then=="function"?6:1,jf=e,Cr===null&&(bo=1,gU(t,Kd(e,t.current)))}function Bfe(){var t=Bi.H;return Bi.H=dU,t===null?dU:t}function Ffe(){var t=Bi.A;return Bi.A=i2e,t}function mG(){bo=4,db||(Gr&4194048)!==Gr&&pp.current!==null||(RA=!0),!(Wb&134217727)&&!(ST&134217727)||aa===null||pb(aa,Gr,rp,!1)}function e5(t,e,n){var i=Ms;Ms|=2;var r=Bfe(),s=Ffe();(aa!==t||Gr!==e)&&(bU=null,LC(t,e)),e=!1;var a=bo;e:do try{if(Rs!==0&&Cr!==null){var o=Cr,c=jf;switch(Rs){case 8:PW(),a=6;break e;case 3:case 2:case 9:case 6:pp.current===null&&(e=!0);var l=Rs;if(Rs=0,jf=null,Aw(t,o,c,l),n&&RA){a=0;break e}break;default:l=Rs,Rs=0,jf=null,Aw(t,o,c,l)}}a2e(),a=bo;break}catch(u){Ufe(t,u)}while(!0);return e&&t.shellSuspendCounter++,e_=y1=null,Ms=i,Bi.H=r,Bi.A=s,Cr===null&&(aa=null,Gr=0,ZB()),a}function a2e(){for(;Cr!==null;)zfe(Cr)}function o2e(t,e){var n=Ms;Ms|=2;var i=Bfe(),r=Ffe();aa!==t||Gr!==e?(bU=null,yU=Fg()+500,LC(t,e)):RA=mI(t,e);e:do try{if(Rs!==0&&Cr!==null){e=Cr;var s=jf;t:switch(Rs){case 1:Rs=0,jf=null,Aw(t,e,s,1);break;case 2:case 9:if(OQ(s)){Rs=0,jf=null,eee(e);break}e=function(){Rs!==2&&Rs!==9||aa!==t||(Rs=7),d0(t)},s.then(e,e);break e;case 3:Rs=7;break e;case 4:Rs=5;break e;case 7:OQ(s)?(Rs=0,jf=null,eee(e)):(Rs=0,jf=null,Aw(t,e,s,7));break;case 5:var a=null;switch(Cr.tag){case 26:a=Cr.memoizedState;case 5:case 27:var o=Cr;if(!a||sde(a)){Rs=0,jf=null;var c=o.sibling;if(c!==null)Cr=c;else{var l=o.return;l!==null?(Cr=l,rF(l)):Cr=null}break t}}Rs=0,jf=null,Aw(t,e,s,5);break;case 6:Rs=0,jf=null,Aw(t,e,s,6);break;case 8:PW(),bo=6;break e;default:throw Error(jt(462))}}c2e();break}catch(u){Ufe(t,u)}while(!0);return e_=y1=null,Bi.H=i,Bi.A=r,Ms=n,Cr!==null?0:(aa=null,Gr=0,ZB(),bo)}function c2e(){for(;Cr!==null&&!ODe();)zfe(Cr)}function zfe(t){var e=gfe(t.alternate,t,b_);t.memoizedProps=t.pendingProps,e===null?rF(t):Cr=e}function eee(t){var e=t,n=e.alternate;switch(e.tag){case 15:case 0:e=WQ(n,e,e.pendingProps,e.type,void 0,Gr);break;case 11:e=WQ(n,e,e.pendingProps,e.type.render,e.ref,Gr);break;case 5:EW(e);default:vfe(n,e),e=Cr=vhe(e,b_),e=gfe(n,e,b_)}t.memoizedProps=t.pendingProps,e===null?rF(t):Cr=e}function Aw(t,e,n,i){e_=y1=null,EW(e),Yw=null,kO=0;var r=e.return;try{if(ZPe(t,r,e,n,Gr)){bo=1,gU(t,Kd(n,t.current)),Cr=null;return}}catch(s){if(r!==null)throw Cr=r,s;bo=1,gU(t,Kd(n,t.current)),Cr=null;return}e.flags&32768?(_s||i===1?t=!0:RA||Gr&536870912?t=!1:(db=t=!0,(i===2||i===9||i===3||i===6)&&(i=pp.current,i!==null&&i.tag===13&&(i.flags|=16384))),Hfe(e,t)):rF(e)}function rF(t){var e=t;do{if(e.flags&32768){Hfe(e,db);return}t=e.return;var n=QPe(e.alternate,e,b_);if(n!==null){Cr=n;return}if(e=e.sibling,e!==null){Cr=e;return}Cr=e=t}while(e!==null);bo===0&&(bo=5)}function Hfe(t,e){do{var n=e2e(t.alternate,t);if(n!==null){n.flags&=32767,Cr=n;return}if(n=t.return,n!==null&&(n.flags|=32768,n.subtreeFlags=0,n.deletions=null),!e&&(t=t.sibling,t!==null)){Cr=t;return}Cr=t=n}while(t!==null);bo=6,Cr=null}function tee(t,e,n,i,r,s,a,o,c){t.cancelPendingCommit=null;do sF();while(Bl!==0);if(Ms&6)throw Error(jt(327));if(e!==null){if(e===t.current)throw Error(jt(177));if(s=e.lanes|e.childLanes,s|=cW,zDe(t,n,s,a,o,c),t===aa&&(Cr=aa=null,Gr=0),PC=e,xb=t,Xw=n,fG=s,dG=r,Dfe=i,e.subtreeFlags&10256||e.flags&10256?(t.callbackNode=null,t.callbackPriority=0,f2e(iU,function(){return $fe(),null})):(t.callbackNode=null,t.callbackPriority=0),i=(e.flags&13878)!==0,e.subtreeFlags&13878||i){i=Bi.T,Bi.T=null,r=ys.p,ys.p=2,a=Ms,Ms|=4;try{t2e(t,e,n)}finally{Ms=a,ys.p=r,Bi.T=i}}Bl=1,jfe(),Vfe(),Gfe()}}function jfe(){if(Bl===1){Bl=0;var t=xb,e=PC,n=(e.flags&13878)!==0;if(e.subtreeFlags&13878||n){n=Bi.T,Bi.T=null;var i=ys.p;ys.p=2;var r=Ms;Ms|=4;try{Afe(e,t);var s=yG,a=lhe(t.containerInfo),o=s.focusedElem,c=s.selectionRange;if(a!==o&&o&&o.ownerDocument&&che(o.ownerDocument.documentElement,o)){if(c!==null&&oW(o)){var l=c.start,u=c.end;if(u===void 0&&(u=l),"selectionStart"in o)o.selectionStart=l,o.selectionEnd=Math.min(u,o.value.length);else{var h=o.ownerDocument||document,f=h&&h.defaultView||window;if(f.getSelection){var d=f.getSelection(),p=o.textContent.length,g=Math.min(c.start,p),y=c.end===void 0?g:Math.min(c.end,p);!d.extend&&g>y&&(a=y,y=g,g=a);var v=SQ(o,g),b=SQ(o,y);if(v&&b&&(d.rangeCount!==1||d.anchorNode!==v.node||d.anchorOffset!==v.offset||d.focusNode!==b.node||d.focusOffset!==b.offset)){var T=h.createRange();T.setStart(v.node,v.offset),d.removeAllRanges(),g>y?(d.addRange(T),d.extend(b.node,b.offset)):(T.setEnd(b.node,b.offset),d.addRange(T))}}}}for(h=[],d=o;d=d.parentNode;)d.nodeType===1&&h.push({element:d,left:d.scrollLeft,top:d.scrollTop});for(typeof o.focus=="function"&&o.focus(),o=0;o<h.length;o++){var x=h[o];x.element.scrollLeft=x.left,x.element.scrollTop=x.top}}RU=!!_G,yG=_G=null}finally{Ms=r,ys.p=i,Bi.T=n}}t.current=e,Bl=2}}function Vfe(){if(Bl===2){Bl=0;var t=xb,e=PC,n=(e.flags&8772)!==0;if(e.subtreeFlags&8772||n){n=Bi.T,Bi.T=null;var i=ys.p;ys.p=2;var r=Ms;Ms|=4;try{Tfe(t,e.alternate,e)}finally{Ms=r,ys.p=i,Bi.T=n}}Bl=3}}function Gfe(){if(Bl===4||Bl===3){Bl=0,NDe();var t=xb,e=PC,n=Xw,i=Dfe;e.subtreeFlags&10256||e.flags&10256?Bl=5:(Bl=0,PC=xb=null,qfe(t,t.pendingLanes));var r=t.pendingLanes;if(r===0&&(Tb=null),eW(n),e=e.stateNode,td&&typeof td.onCommitFiberRoot=="function")try{td.onCommitFiberRoot(pI,e,void 0,(e.current.flags&128)===128)}catch{}if(i!==null){e=Bi.T,r=ys.p,ys.p=2,Bi.T=null;try{for(var s=t.onRecoverableError,a=0;a<i.length;a++){var o=i[a];s(o.value,{componentStack:o.stack})}}finally{Bi.T=e,ys.p=r}}Xw&3&&sF(),d0(t),r=t.pendingLanes,n&4194090&&r&42?t===pG?HM++:(HM=0,pG=t):HM=0,CI(0)}}function qfe(t,e){(t.pooledCacheLanes&=e)===0&&(e=t.pooledCache,e!=null&&(t.pooledCache=null,EI(e)))}function sF(t){return jfe(),Vfe(),Gfe(),$fe()}function $fe(){if(Bl!==5)return!1;var t=xb,e=fG;fG=0;var n=eW(Xw),i=Bi.T,r=ys.p;try{ys.p=32>n?32:n,Bi.T=null,n=dG,dG=null;var s=xb,a=Xw;if(Bl=0,PC=xb=null,Xw=0,Ms&6)throw Error(jt(331));var o=Ms;if(Ms|=4,Ife(s.current),Mfe(s,s.current,a,n),Ms=o,CI(0,!1),td&&typeof td.onPostCommitFiberRoot=="function")try{td.onPostCommitFiberRoot(pI,s)}catch{}return!0}finally{ys.p=r,Bi.T=i,qfe(t,e)}}function nee(t,e,n){e=Kd(n,e),e=oG(t.stateNode,e,2),t=Sb(t,e,2),t!==null&&(gI(t,2),d0(t))}function Xs(t,e,n){if(t.tag===3)nee(t,t,n);else for(;e!==null;){if(e.tag===3){nee(e,t,n);break}else if(e.tag===1){var i=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof i.componentDidCatch=="function"&&(Tb===null||!Tb.has(i))){t=Kd(n,t),n=lfe(2),i=Sb(e,n,2),i!==null&&(ufe(n,i,e,t),gI(i,2),d0(i));break}}e=e.return}}function t5(t,e,n){var i=t.pingCache;if(i===null){i=t.pingCache=new r2e;var r=new Set;i.set(e,r)}else r=i.get(e),r===void 0&&(r=new Set,i.set(e,r));r.has(n)||(IW=!0,r.add(n),t=l2e.bind(null,t,e,n),e.then(t,t))}function l2e(t,e,n){var i=t.pingCache;i!==null&&i.delete(e),t.pingedLanes|=t.suspendedLanes&n,t.warmLanes&=~n,aa===t&&(Gr&n)===n&&(bo===4||bo===3&&(Gr&62914560)===Gr&&300>Fg()-DW?!(Ms&2)&&LC(t,0):kW|=n,DC===Gr&&(DC=0)),d0(t)}function Wfe(t,e){e===0&&(e=jue()),t=AA(t,e),t!==null&&(gI(t,e),d0(t))}function u2e(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),Wfe(t,n)}function h2e(t,e){var n=0;switch(t.tag){case 13:var i=t.stateNode,r=t.memoizedState;r!==null&&(n=r.retryLane);break;case 19:i=t.stateNode;break;case 22:i=t.stateNode._retryCache;break;default:throw Error(jt(314))}i!==null&&i.delete(e),Wfe(t,n)}function f2e(t,e){return J7(t,e)}var EU=null,rw=null,gG=!1,SU=!1,n5=!1,TT=0;function d0(t){t!==rw&&t.next===null&&(rw===null?EU=rw=t:rw=rw.next=t),SU=!0,gG||(gG=!0,p2e())}function CI(t,e){if(!n5&&SU){n5=!0;do for(var n=!1,i=EU;i!==null;){if(t!==0){var r=i.pendingLanes;if(r===0)var s=0;else{var a=i.suspendedLanes,o=i.pingedLanes;s=(1<<31-nd(42|t)+1)-1,s&=r&~(a&~o),s=s&201326741?s&201326741|1:s?s|2:0}s!==0&&(n=!0,iee(i,s))}else s=Gr,s=WB(i,i===aa?s:0,i.cancelPendingCommit!==null||i.timeoutHandle!==-1),!(s&3)||mI(i,s)||(n=!0,iee(i,s));i=i.next}while(n);n5=!1}}function d2e(){Yfe()}function Yfe(){SU=gG=!1;var t=0;TT!==0&&(S2e()&&(t=TT),TT=0);for(var e=Fg(),n=null,i=EU;i!==null;){var r=i.next,s=Xfe(i,e);s===0?(i.next=null,n===null?EU=r:n.next=r,r===null&&(rw=n)):(n=i,(t!==0||s&3)&&(SU=!0)),i=r}CI(t)}function Xfe(t,e){for(var n=t.suspendedLanes,i=t.pingedLanes,r=t.expirationTimes,s=t.pendingLanes&-62914561;0<s;){var a=31-nd(s),o=1<<a,c=r[a];c===-1?(!(o&n)||o&i)&&(r[a]=FDe(o,e)):c<=e&&(t.expiredLanes|=o),s&=~o}if(e=aa,n=Gr,n=WB(t,t===e?n:0,t.cancelPendingCommit!==null||t.timeoutHandle!==-1),i=t.callbackNode,n===0||t===e&&(Rs===2||Rs===9)||t.cancelPendingCommit!==null)return i!==null&&i!==null&&RH(i),t.callbackNode=null,t.callbackPriority=0;if(!(n&3)||mI(t,n)){if(e=n&-n,e===t.callbackPriority)return e;switch(i!==null&&RH(i),eW(n)){case 2:case 8:n=Fue;break;case 32:n=iU;break;case 268435456:n=zue;break;default:n=iU}return i=Kfe.bind(null,t),n=J7(n,i),t.callbackPriority=e,t.callbackNode=n,e}return i!==null&&i!==null&&RH(i),t.callbackPriority=2,t.callbackNode=null,2}function Kfe(t,e){if(Bl!==0&&Bl!==5)return t.callbackNode=null,t.callbackPriority=0,null;var n=t.callbackNode;if(sF()&&t.callbackNode!==n)return null;var i=Gr;return i=WB(t,t===aa?i:0,t.cancelPendingCommit!==null||t.timeoutHandle!==-1),i===0?null:(Lfe(t,i,e),Xfe(t,Fg()),t.callbackNode!=null&&t.callbackNode===n?Kfe.bind(null,t):null)}function iee(t,e){if(sF())return null;Lfe(t,e,!0)}function p2e(){x2e(function(){Ms&6?J7(Bue,d2e):Yfe()})}function LW(){return TT===0&&(TT=Hue()),TT}function ree(t){return t==null||typeof t=="symbol"||typeof t=="boolean"?null:typeof t=="function"?t:n2(""+t)}function see(t,e){var n=e.ownerDocument.createElement("input");return n.name=e.name,n.value=e.value,t.id&&n.setAttribute("form",t.id),e.parentNode.insertBefore(n,e),t=new FormData(t),n.parentNode.removeChild(n),t}function m2e(t,e,n,i,r){if(e==="submit"&&n&&n.stateNode===r){var s=ree((r[sf]||null).action),a=i.submitter;a&&(e=(e=a[sf]||null)?ree(e.formAction):a.getAttribute("formAction"),e!==null&&(s=e,a=null));var o=new YB("action","action",null,i,r);t.push({event:o,listeners:[{instance:null,listener:function(){if(i.defaultPrevented){if(TT!==0){var c=a?see(r,a):new FormData(r);sG(n,{pending:!0,data:c,method:r.method,action:s},null,c)}}else typeof s=="function"&&(o.preventDefault(),c=a?see(r,a):new FormData(r),sG(n,{pending:!0,data:c,method:r.method,action:s},s,c))},currentTarget:r}]})}}for(var i5=0;i5<WV.length;i5++){var r5=WV[i5],g2e=r5.toLowerCase(),v2e=r5[0].toUpperCase()+r5.slice(1);Em(g2e,"on"+v2e)}Em(hhe,"onAnimationEnd");Em(fhe,"onAnimationIteration");Em(dhe,"onAnimationStart");Em("dblclick","onDoubleClick");Em("focusin","onFocus");Em("focusout","onBlur");Em(DPe,"onTransitionRun");Em(PPe,"onTransitionStart");Em(LPe,"onTransitionCancel");Em(phe,"onTransitionEnd");RC("onMouseEnter",["mouseout","mouseover"]);RC("onMouseLeave",["mouseout","mouseover"]);RC("onPointerEnter",["pointerout","pointerover"]);RC("onPointerLeave",["pointerout","pointerover"]);g1("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));g1("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));g1("onBeforeInput",["compositionend","keypress","textInput","paste"]);g1("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));g1("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));g1("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var DO="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),_2e=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(DO));function Zfe(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var i=t[n],r=i.event;i=i.listeners;e:{var s=void 0;if(e)for(var a=i.length-1;0<=a;a--){var o=i[a],c=o.instance,l=o.currentTarget;if(o=o.listener,c!==s&&r.isPropagationStopped())break e;s=o,r.currentTarget=l;try{s(r)}catch(u){mU(u)}r.currentTarget=null,s=c}else for(a=0;a<i.length;a++){if(o=i[a],c=o.instance,l=o.currentTarget,o=o.listener,c!==s&&r.isPropagationStopped())break e;s=o,r.currentTarget=l;try{s(r)}catch(u){mU(u)}r.currentTarget=null,s=c}}}}function wr(t,e){var n=e[zV];n===void 0&&(n=e[zV]=new Set);var i=t+"__bubble";n.has(i)||(Jfe(e,t,2,!1),n.add(i))}function s5(t,e,n){var i=0;e&&(i|=4),Jfe(n,t,i,e)}var KD="_reactListening"+Math.random().toString(36).slice(2);function UW(t){if(!t[KD]){t[KD]=!0,$ue.forEach(function(n){n!=="selectionchange"&&(_2e.has(n)||s5(n,!1,t),s5(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[KD]||(e[KD]=!0,s5("selectionchange",!1,e))}}function Jfe(t,e,n,i){switch(ude(e)){case 2:var r=q2e;break;case 8:r=$2e;break;default:r=HW}n=r.bind(null,e,n,t),r=void 0,!GV||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(r=!0),i?r!==void 0?t.addEventListener(e,n,{capture:!0,passive:r}):t.addEventListener(e,n,!0):r!==void 0?t.addEventListener(e,n,{passive:r}):t.addEventListener(e,n,!1)}function a5(t,e,n,i,r){var s=i;if(!(e&1)&&!(e&2)&&i!==null)e:for(;;){if(i===null)return;var a=i.tag;if(a===3||a===4){var o=i.stateNode.containerInfo;if(o===r)break;if(a===4)for(a=i.return;a!==null;){var c=a.tag;if((c===3||c===4)&&a.stateNode.containerInfo===r)return;a=a.return}for(;o!==null;){if(a=_w(o),a===null)return;if(c=a.tag,c===5||c===6||c===26||c===27){i=s=a;continue e}o=o.parentNode}}i=i.return}ehe(function(){var l=s,u=iW(n),h=[];e:{var f=mhe.get(t);if(f!==void 0){var d=YB,p=t;switch(t){case"keypress":if(r2(n)===0)break e;case"keydown":case"keyup":d=fPe;break;case"focusin":p="focus",d=LH;break;case"focusout":p="blur",d=LH;break;case"beforeblur":case"afterblur":d=LH;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":d=fQ;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":d=ePe;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":d=mPe;break;case hhe:case fhe:case dhe:d=iPe;break;case phe:d=vPe;break;case"scroll":case"scrollend":d=JDe;break;case"wheel":d=yPe;break;case"copy":case"cut":case"paste":d=sPe;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":d=pQ;break;case"toggle":case"beforetoggle":d=EPe}var g=(e&4)!==0,y=!g&&(t==="scroll"||t==="scrollend"),v=g?f!==null?f+"Capture":null:f;g=[];for(var b=l,T;b!==null;){var x=b;if(T=x.stateNode,x=x.tag,x!==5&&x!==26&&x!==27||T===null||v===null||(x=RO(b,v),x!=null&&g.push(PO(b,x,T))),y)break;b=b.return}0<g.length&&(f=new d(f,p,null,n,u),h.push({event:f,listeners:g}))}}if(!(e&7)){e:{if(f=t==="mouseover"||t==="pointerover",d=t==="mouseout"||t==="pointerout",f&&n!==VV&&(p=n.relatedTarget||n.fromElement)&&(_w(p)||p[wA]))break e;if((d||f)&&(f=u.window===u?u:(f=u.ownerDocument)?f.defaultView||f.parentWindow:window,d?(p=n.relatedTarget||n.toElement,d=l,p=p?_w(p):null,p!==null&&(y=dI(p),g=p.tag,p!==y||g!==5&&g!==27&&g!==6)&&(p=null)):(d=null,p=l),d!==p)){if(g=fQ,x="onMouseLeave",v="onMouseEnter",b="mouse",(t==="pointerout"||t==="pointerover")&&(g=pQ,x="onPointerLeave",v="onPointerEnter",b="pointer"),y=d==null?f:rM(d),T=p==null?f:rM(p),f=new g(x,b+"leave",d,n,u),f.target=y,f.relatedTarget=T,x=null,_w(u)===l&&(g=new g(v,b+"enter",p,n,u),g.target=T,g.relatedTarget=y,x=g),y=x,d&&p)t:{for(g=d,v=p,b=0,T=g;T;T=Lx(T))b++;for(T=0,x=v;x;x=Lx(x))T++;for(;0<b-T;)g=Lx(g),b--;for(;0<T-b;)v=Lx(v),T--;for(;b--;){if(g===v||v!==null&&g===v.alternate)break t;g=Lx(g),v=Lx(v)}g=null}else g=null;d!==null&&aee(h,f,d,g,!1),p!==null&&y!==null&&aee(h,y,p,g,!0)}}e:{if(f=l?rM(l):window,d=f.nodeName&&f.nodeName.toLowerCase(),d==="select"||d==="input"&&f.type==="file")var M=_Q;else if(vQ(f))if(ahe)M=NPe;else{M=MPe;var R=RPe}else d=f.nodeName,!d||d.toLowerCase()!=="input"||f.type!=="checkbox"&&f.type!=="radio"?l&&nW(l.elementType)&&(M=_Q):M=OPe;if(M&&(M=M(t,l))){she(h,M,n,u);break e}R&&R(t,f,l),t==="focusout"&&l&&f.type==="number"&&l.memoizedProps.value!=null&&jV(f,"number",f.value)}switch(R=l?rM(l):window,t){case"focusin":(vQ(R)||R.contentEditable==="true")&&(Ew=R,qV=l,NM=null);break;case"focusout":NM=qV=Ew=null;break;case"mousedown":$V=!0;break;case"contextmenu":case"mouseup":case"dragend":$V=!1,TQ(h,n,u);break;case"selectionchange":if(kPe)break;case"keydown":case"keyup":TQ(h,n,u)}var I;if(aW)e:{switch(t){case"compositionstart":var k="onCompositionStart";break e;case"compositionend":k="onCompositionEnd";break e;case"compositionupdate":k="onCompositionUpdate";break e}k=void 0}else bw?ihe(t,n)&&(k="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(k="onCompositionStart");k&&(nhe&&n.locale!=="ko"&&(bw||k!=="onCompositionStart"?k==="onCompositionEnd"&&bw&&(I=the()):(fb=u,rW="value"in fb?fb.value:fb.textContent,bw=!0)),R=TU(l,k),0<R.length&&(k=new dQ(k,t,null,n,u),h.push({event:k,listeners:R}),I?k.data=I:(I=rhe(n),I!==null&&(k.data=I)))),(I=TPe?xPe(t,n):wPe(t,n))&&(k=TU(l,"onBeforeInput"),0<k.length&&(R=new dQ("onBeforeInput","beforeinput",null,n,u),h.push({event:R,listeners:k}),R.data=I)),m2e(h,t,l,n,u)}Zfe(h,e)})}function PO(t,e,n){return{instance:t,listener:e,currentTarget:n}}function TU(t,e){for(var n=e+"Capture",i=[];t!==null;){var r=t,s=r.stateNode;if(r=r.tag,r!==5&&r!==26&&r!==27||s===null||(r=RO(t,n),r!=null&&i.unshift(PO(t,r,s)),r=RO(t,e),r!=null&&i.push(PO(t,r,s))),t.tag===3)return i;t=t.return}return[]}function Lx(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5&&t.tag!==27);return t||null}function aee(t,e,n,i,r){for(var s=e._reactName,a=[];n!==null&&n!==i;){var o=n,c=o.alternate,l=o.stateNode;if(o=o.tag,c!==null&&c===i)break;o!==5&&o!==26&&o!==27||l===null||(c=l,r?(l=RO(n,s),l!=null&&a.unshift(PO(n,l,c))):r||(l=RO(n,s),l!=null&&a.push(PO(n,l,c)))),n=n.return}a.length!==0&&t.push({event:e,listeners:a})}var y2e=/\r\n?/g,b2e=/\u0000|\uFFFD/g;function oee(t){return(typeof t=="string"?t:""+t).replace(y2e,`
`).replace(b2e,"")}function Qfe(t,e){return e=oee(e),oee(t)===e}function aF(){}function Bs(t,e,n,i,r,s){switch(n){case"children":typeof i=="string"?e==="body"||e==="textarea"&&i===""||MC(t,i):(typeof i=="number"||typeof i=="bigint")&&e!=="body"&&MC(t,""+i);break;case"className":VD(t,"class",i);break;case"tabIndex":VD(t,"tabindex",i);break;case"dir":case"role":case"viewBox":case"width":case"height":VD(t,n,i);break;case"style":Que(t,i,s);break;case"data":if(e!=="object"){VD(t,"data",i);break}case"src":case"href":if(i===""&&(e!=="a"||n!=="href")){t.removeAttribute(n);break}if(i==null||typeof i=="function"||typeof i=="symbol"||typeof i=="boolean"){t.removeAttribute(n);break}i=n2(""+i),t.setAttribute(n,i);break;case"action":case"formAction":if(typeof i=="function"){t.setAttribute(n,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof s=="function"&&(n==="formAction"?(e!=="input"&&Bs(t,e,"name",r.name,r,null),Bs(t,e,"formEncType",r.formEncType,r,null),Bs(t,e,"formMethod",r.formMethod,r,null),Bs(t,e,"formTarget",r.formTarget,r,null)):(Bs(t,e,"encType",r.encType,r,null),Bs(t,e,"method",r.method,r,null),Bs(t,e,"target",r.target,r,null)));if(i==null||typeof i=="symbol"||typeof i=="boolean"){t.removeAttribute(n);break}i=n2(""+i),t.setAttribute(n,i);break;case"onClick":i!=null&&(t.onclick=aF);break;case"onScroll":i!=null&&wr("scroll",t);break;case"onScrollEnd":i!=null&&wr("scrollend",t);break;case"dangerouslySetInnerHTML":if(i!=null){if(typeof i!="object"||!("__html"in i))throw Error(jt(61));if(n=i.__html,n!=null){if(r.children!=null)throw Error(jt(60));t.innerHTML=n}}break;case"multiple":t.multiple=i&&typeof i!="function"&&typeof i!="symbol";break;case"muted":t.muted=i&&typeof i!="function"&&typeof i!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(i==null||typeof i=="function"||typeof i=="boolean"||typeof i=="symbol"){t.removeAttribute("xlink:href");break}n=n2(""+i),t.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",n);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":i!=null&&typeof i!="function"&&typeof i!="symbol"?t.setAttribute(n,""+i):t.removeAttribute(n);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":i&&typeof i!="function"&&typeof i!="symbol"?t.setAttribute(n,""):t.removeAttribute(n);break;case"capture":case"download":i===!0?t.setAttribute(n,""):i!==!1&&i!=null&&typeof i!="function"&&typeof i!="symbol"?t.setAttribute(n,i):t.removeAttribute(n);break;case"cols":case"rows":case"size":case"span":i!=null&&typeof i!="function"&&typeof i!="symbol"&&!isNaN(i)&&1<=i?t.setAttribute(n,i):t.removeAttribute(n);break;case"rowSpan":case"start":i==null||typeof i=="function"||typeof i=="symbol"||isNaN(i)?t.removeAttribute(n):t.setAttribute(n,i);break;case"popover":wr("beforetoggle",t),wr("toggle",t),t2(t,"popover",i);break;case"xlinkActuate":wv(t,"http://www.w3.org/1999/xlink","xlink:actuate",i);break;case"xlinkArcrole":wv(t,"http://www.w3.org/1999/xlink","xlink:arcrole",i);break;case"xlinkRole":wv(t,"http://www.w3.org/1999/xlink","xlink:role",i);break;case"xlinkShow":wv(t,"http://www.w3.org/1999/xlink","xlink:show",i);break;case"xlinkTitle":wv(t,"http://www.w3.org/1999/xlink","xlink:title",i);break;case"xlinkType":wv(t,"http://www.w3.org/1999/xlink","xlink:type",i);break;case"xmlBase":wv(t,"http://www.w3.org/XML/1998/namespace","xml:base",i);break;case"xmlLang":wv(t,"http://www.w3.org/XML/1998/namespace","xml:lang",i);break;case"xmlSpace":wv(t,"http://www.w3.org/XML/1998/namespace","xml:space",i);break;case"is":t2(t,"is",i);break;case"innerText":case"textContent":break;default:(!(2<n.length)||n[0]!=="o"&&n[0]!=="O"||n[1]!=="n"&&n[1]!=="N")&&(n=KDe.get(n)||n,t2(t,n,i))}}function vG(t,e,n,i,r,s){switch(n){case"style":Que(t,i,s);break;case"dangerouslySetInnerHTML":if(i!=null){if(typeof i!="object"||!("__html"in i))throw Error(jt(61));if(n=i.__html,n!=null){if(r.children!=null)throw Error(jt(60));t.innerHTML=n}}break;case"children":typeof i=="string"?MC(t,i):(typeof i=="number"||typeof i=="bigint")&&MC(t,""+i);break;case"onScroll":i!=null&&wr("scroll",t);break;case"onScrollEnd":i!=null&&wr("scrollend",t);break;case"onClick":i!=null&&(t.onclick=aF);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!Wue.hasOwnProperty(n))e:{if(n[0]==="o"&&n[1]==="n"&&(r=n.endsWith("Capture"),e=n.slice(2,r?n.length-7:void 0),s=t[sf]||null,s=s!=null?s[n]:null,typeof s=="function"&&t.removeEventListener(e,s,r),typeof i=="function")){typeof s!="function"&&s!==null&&(n in t?t[n]=null:t.hasAttribute(n)&&t.removeAttribute(n)),t.addEventListener(e,i,r);break e}n in t?t[n]=i:i===!0?t.setAttribute(n,""):t2(t,n,i)}}}function Hl(t,e,n){switch(e){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":wr("error",t),wr("load",t);var i=!1,r=!1,s;for(s in n)if(n.hasOwnProperty(s)){var a=n[s];if(a!=null)switch(s){case"src":i=!0;break;case"srcSet":r=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(jt(137,e));default:Bs(t,e,s,a,n,null)}}r&&Bs(t,e,"srcSet",n.srcSet,n,null),i&&Bs(t,e,"src",n.src,n,null);return;case"input":wr("invalid",t);var o=s=a=r=null,c=null,l=null;for(i in n)if(n.hasOwnProperty(i)){var u=n[i];if(u!=null)switch(i){case"name":r=u;break;case"type":a=u;break;case"checked":c=u;break;case"defaultChecked":l=u;break;case"value":s=u;break;case"defaultValue":o=u;break;case"children":case"dangerouslySetInnerHTML":if(u!=null)throw Error(jt(137,e));break;default:Bs(t,e,i,u,n,null)}}Kue(t,s,o,c,l,a,r,!1),rU(t);return;case"select":wr("invalid",t),i=a=s=null;for(r in n)if(n.hasOwnProperty(r)&&(o=n[r],o!=null))switch(r){case"value":s=o;break;case"defaultValue":a=o;break;case"multiple":i=o;default:Bs(t,e,r,o,n,null)}e=s,n=a,t.multiple=!!i,e!=null?Vw(t,!!i,e,!1):n!=null&&Vw(t,!!i,n,!0);return;case"textarea":wr("invalid",t),s=r=i=null;for(a in n)if(n.hasOwnProperty(a)&&(o=n[a],o!=null))switch(a){case"value":i=o;break;case"defaultValue":r=o;break;case"children":s=o;break;case"dangerouslySetInnerHTML":if(o!=null)throw Error(jt(91));break;default:Bs(t,e,a,o,n,null)}Jue(t,i,r,s),rU(t);return;case"option":for(c in n)if(n.hasOwnProperty(c)&&(i=n[c],i!=null))switch(c){case"selected":t.selected=i&&typeof i!="function"&&typeof i!="symbol";break;default:Bs(t,e,c,i,n,null)}return;case"dialog":wr("beforetoggle",t),wr("toggle",t),wr("cancel",t),wr("close",t);break;case"iframe":case"object":wr("load",t);break;case"video":case"audio":for(i=0;i<DO.length;i++)wr(DO[i],t);break;case"image":wr("error",t),wr("load",t);break;case"details":wr("toggle",t);break;case"embed":case"source":case"link":wr("error",t),wr("load",t);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(l in n)if(n.hasOwnProperty(l)&&(i=n[l],i!=null))switch(l){case"children":case"dangerouslySetInnerHTML":throw Error(jt(137,e));default:Bs(t,e,l,i,n,null)}return;default:if(nW(e)){for(u in n)n.hasOwnProperty(u)&&(i=n[u],i!==void 0&&vG(t,e,u,i,n,void 0));return}}for(o in n)n.hasOwnProperty(o)&&(i=n[o],i!=null&&Bs(t,e,o,i,n,null))}function E2e(t,e,n,i){switch(e){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var r=null,s=null,a=null,o=null,c=null,l=null,u=null;for(d in n){var h=n[d];if(n.hasOwnProperty(d)&&h!=null)switch(d){case"checked":break;case"value":break;case"defaultValue":c=h;default:i.hasOwnProperty(d)||Bs(t,e,d,null,i,h)}}for(var f in i){var d=i[f];if(h=n[f],i.hasOwnProperty(f)&&(d!=null||h!=null))switch(f){case"type":s=d;break;case"name":r=d;break;case"checked":l=d;break;case"defaultChecked":u=d;break;case"value":a=d;break;case"defaultValue":o=d;break;case"children":case"dangerouslySetInnerHTML":if(d!=null)throw Error(jt(137,e));break;default:d!==h&&Bs(t,e,f,d,i,h)}}HV(t,a,o,c,l,u,s,r);return;case"select":d=a=o=f=null;for(s in n)if(c=n[s],n.hasOwnProperty(s)&&c!=null)switch(s){case"value":break;case"multiple":d=c;default:i.hasOwnProperty(s)||Bs(t,e,s,null,i,c)}for(r in i)if(s=i[r],c=n[r],i.hasOwnProperty(r)&&(s!=null||c!=null))switch(r){case"value":f=s;break;case"defaultValue":o=s;break;case"multiple":a=s;default:s!==c&&Bs(t,e,r,s,i,c)}e=o,n=a,i=d,f!=null?Vw(t,!!n,f,!1):!!i!=!!n&&(e!=null?Vw(t,!!n,e,!0):Vw(t,!!n,n?[]:"",!1));return;case"textarea":d=f=null;for(o in n)if(r=n[o],n.hasOwnProperty(o)&&r!=null&&!i.hasOwnProperty(o))switch(o){case"value":break;case"children":break;default:Bs(t,e,o,null,i,r)}for(a in i)if(r=i[a],s=n[a],i.hasOwnProperty(a)&&(r!=null||s!=null))switch(a){case"value":f=r;break;case"defaultValue":d=r;break;case"children":break;case"dangerouslySetInnerHTML":if(r!=null)throw Error(jt(91));break;default:r!==s&&Bs(t,e,a,r,i,s)}Zue(t,f,d);return;case"option":for(var p in n)if(f=n[p],n.hasOwnProperty(p)&&f!=null&&!i.hasOwnProperty(p))switch(p){case"selected":t.selected=!1;break;default:Bs(t,e,p,null,i,f)}for(c in i)if(f=i[c],d=n[c],i.hasOwnProperty(c)&&f!==d&&(f!=null||d!=null))switch(c){case"selected":t.selected=f&&typeof f!="function"&&typeof f!="symbol";break;default:Bs(t,e,c,f,i,d)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var g in n)f=n[g],n.hasOwnProperty(g)&&f!=null&&!i.hasOwnProperty(g)&&Bs(t,e,g,null,i,f);for(l in i)if(f=i[l],d=n[l],i.hasOwnProperty(l)&&f!==d&&(f!=null||d!=null))switch(l){case"children":case"dangerouslySetInnerHTML":if(f!=null)throw Error(jt(137,e));break;default:Bs(t,e,l,f,i,d)}return;default:if(nW(e)){for(var y in n)f=n[y],n.hasOwnProperty(y)&&f!==void 0&&!i.hasOwnProperty(y)&&vG(t,e,y,void 0,i,f);for(u in i)f=i[u],d=n[u],!i.hasOwnProperty(u)||f===d||f===void 0&&d===void 0||vG(t,e,u,f,i,d);return}}for(var v in n)f=n[v],n.hasOwnProperty(v)&&f!=null&&!i.hasOwnProperty(v)&&Bs(t,e,v,null,i,f);for(h in i)f=i[h],d=n[h],!i.hasOwnProperty(h)||f===d||f==null&&d==null||Bs(t,e,h,f,i,d)}var _G=null,yG=null;function xU(t){return t.nodeType===9?t:t.ownerDocument}function cee(t){switch(t){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function ede(t,e){if(t===0)switch(e){case"svg":return 1;case"math":return 2;default:return 0}return t===1&&e==="foreignObject"?0:t}function bG(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.children=="bigint"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var o5=null;function S2e(){var t=window.event;return t&&t.type==="popstate"?t===o5?!1:(o5=t,!0):(o5=null,!1)}var tde=typeof setTimeout=="function"?setTimeout:void 0,T2e=typeof clearTimeout=="function"?clearTimeout:void 0,lee=typeof Promise=="function"?Promise:void 0,x2e=typeof queueMicrotask=="function"?queueMicrotask:typeof lee<"u"?function(t){return lee.resolve(null).then(t).catch(w2e)}:tde;function w2e(t){setTimeout(function(){throw t})}function _E(t){return t==="head"}function uee(t,e){var n=e,i=0,r=0;do{var s=n.nextSibling;if(t.removeChild(n),s&&s.nodeType===8)if(n=s.data,n==="/$"){if(0<i&&8>i){n=i;var a=t.ownerDocument;if(n&1&&jM(a.documentElement),n&2&&jM(a.body),n&4)for(n=a.head,jM(n),a=n.firstChild;a;){var o=a.nextSibling,c=a.nodeName;a[vI]||c==="SCRIPT"||c==="STYLE"||c==="LINK"&&a.rel.toLowerCase()==="stylesheet"||n.removeChild(a),a=o}}if(r===0){t.removeChild(s),zO(e);return}r--}else n==="$"||n==="$?"||n==="$!"?r++:i=n.charCodeAt(0)-48;else i=0;n=s}while(n);zO(e)}function EG(t){var e=t.firstChild;for(e&&e.nodeType===10&&(e=e.nextSibling);e;){var n=e;switch(e=e.nextSibling,n.nodeName){case"HTML":case"HEAD":case"BODY":EG(n),tW(n);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(n.rel.toLowerCase()==="stylesheet")continue}t.removeChild(n)}}function C2e(t,e,n,i){for(;t.nodeType===1;){var r=n;if(t.nodeName.toLowerCase()!==e.toLowerCase()){if(!i&&(t.nodeName!=="INPUT"||t.type!=="hidden"))break}else if(i){if(!t[vI])switch(e){case"meta":if(!t.hasAttribute("itemprop"))break;return t;case"link":if(s=t.getAttribute("rel"),s==="stylesheet"&&t.hasAttribute("data-precedence"))break;if(s!==r.rel||t.getAttribute("href")!==(r.href==null||r.href===""?null:r.href)||t.getAttribute("crossorigin")!==(r.crossOrigin==null?null:r.crossOrigin)||t.getAttribute("title")!==(r.title==null?null:r.title))break;return t;case"style":if(t.hasAttribute("data-precedence"))break;return t;case"script":if(s=t.getAttribute("src"),(s!==(r.src==null?null:r.src)||t.getAttribute("type")!==(r.type==null?null:r.type)||t.getAttribute("crossorigin")!==(r.crossOrigin==null?null:r.crossOrigin))&&s&&t.hasAttribute("async")&&!t.hasAttribute("itemprop"))break;return t;default:return t}}else if(e==="input"&&t.type==="hidden"){var s=r.name==null?null:""+r.name;if(r.type==="hidden"&&t.getAttribute("name")===s)return t}else return t;if(t=fm(t.nextSibling),t===null)break}return null}function A2e(t,e,n){if(e==="")return null;for(;t.nodeType!==3;)if((t.nodeType!==1||t.nodeName!=="INPUT"||t.type!=="hidden")&&!n||(t=fm(t.nextSibling),t===null))return null;return t}function SG(t){return t.data==="$!"||t.data==="$?"&&t.ownerDocument.readyState==="complete"}function R2e(t,e){var n=t.ownerDocument;if(t.data!=="$?"||n.readyState==="complete")e();else{var i=function(){e(),n.removeEventListener("DOMContentLoaded",i)};n.addEventListener("DOMContentLoaded",i),t._reactRetry=i}}function fm(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?"||e==="F!"||e==="F")break;if(e==="/$")return null}}return t}var TG=null;function hee(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}function nde(t,e,n){switch(e=xU(n),t){case"html":if(t=e.documentElement,!t)throw Error(jt(452));return t;case"head":if(t=e.head,!t)throw Error(jt(453));return t;case"body":if(t=e.body,!t)throw Error(jt(454));return t;default:throw Error(jt(451))}}function jM(t){for(var e=t.attributes;e.length;)t.removeAttributeNode(e[0]);tW(t)}var mp=new Map,fee=new Set;function wU(t){return typeof t.getRootNode=="function"?t.getRootNode():t.nodeType===9?t:t.ownerDocument}var I_=ys.d;ys.d={f:M2e,r:O2e,D:N2e,C:I2e,L:k2e,m:D2e,X:L2e,S:P2e,M:U2e};function M2e(){var t=I_.f(),e=iF();return t||e}function O2e(t){var e=CA(t);e!==null&&e.tag===5&&e.type==="form"?Xhe(e):I_.r(t)}var MA=typeof document>"u"?null:document;function ide(t,e,n){var i=MA;if(i&&typeof e=="string"&&e){var r=Xd(e);r='link[rel="'+t+'"][href="'+r+'"]',typeof n=="string"&&(r+='[crossorigin="'+n+'"]'),fee.has(r)||(fee.add(r),t={rel:t,crossOrigin:n,href:e},i.querySelector(r)===null&&(e=i.createElement("link"),Hl(e,"link",t),hl(e),i.head.appendChild(e)))}}function N2e(t){I_.D(t),ide("dns-prefetch",t,null)}function I2e(t,e){I_.C(t,e),ide("preconnect",t,e)}function k2e(t,e,n){I_.L(t,e,n);var i=MA;if(i&&t&&e){var r='link[rel="preload"][as="'+Xd(e)+'"]';e==="image"&&n&&n.imageSrcSet?(r+='[imagesrcset="'+Xd(n.imageSrcSet)+'"]',typeof n.imageSizes=="string"&&(r+='[imagesizes="'+Xd(n.imageSizes)+'"]')):r+='[href="'+Xd(t)+'"]';var s=r;switch(e){case"style":s=UC(t);break;case"script":s=OA(t)}mp.has(s)||(t=xa({rel:"preload",href:e==="image"&&n&&n.imageSrcSet?void 0:t,as:e},n),mp.set(s,t),i.querySelector(r)!==null||e==="style"&&i.querySelector(AI(s))||e==="script"&&i.querySelector(RI(s))||(e=i.createElement("link"),Hl(e,"link",t),hl(e),i.head.appendChild(e)))}}function D2e(t,e){I_.m(t,e);var n=MA;if(n&&t){var i=e&&typeof e.as=="string"?e.as:"script",r='link[rel="modulepreload"][as="'+Xd(i)+'"][href="'+Xd(t)+'"]',s=r;switch(i){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":s=OA(t)}if(!mp.has(s)&&(t=xa({rel:"modulepreload",href:t},e),mp.set(s,t),n.querySelector(r)===null)){switch(i){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(n.querySelector(RI(s)))return}i=n.createElement("link"),Hl(i,"link",t),hl(i),n.head.appendChild(i)}}}function P2e(t,e,n){I_.S(t,e,n);var i=MA;if(i&&t){var r=jw(i).hoistableStyles,s=UC(t);e=e||"default";var a=r.get(s);if(!a){var o={loading:0,preload:null};if(a=i.querySelector(AI(s)))o.loading=5;else{t=xa({rel:"stylesheet",href:t,"data-precedence":e},n),(n=mp.get(s))&&BW(t,n);var c=a=i.createElement("link");hl(c),Hl(c,"link",t),c._p=new Promise(function(l,u){c.onload=l,c.onerror=u}),c.addEventListener("load",function(){o.loading|=1}),c.addEventListener("error",function(){o.loading|=2}),o.loading|=4,h2(a,e,i)}a={type:"stylesheet",instance:a,count:1,state:o},r.set(s,a)}}}function L2e(t,e){I_.X(t,e);var n=MA;if(n&&t){var i=jw(n).hoistableScripts,r=OA(t),s=i.get(r);s||(s=n.querySelector(RI(r)),s||(t=xa({src:t,async:!0},e),(e=mp.get(r))&&FW(t,e),s=n.createElement("script"),hl(s),Hl(s,"link",t),n.head.appendChild(s)),s={type:"script",instance:s,count:1,state:null},i.set(r,s))}}function U2e(t,e){I_.M(t,e);var n=MA;if(n&&t){var i=jw(n).hoistableScripts,r=OA(t),s=i.get(r);s||(s=n.querySelector(RI(r)),s||(t=xa({src:t,async:!0,type:"module"},e),(e=mp.get(r))&&FW(t,e),s=n.createElement("script"),hl(s),Hl(s,"link",t),n.head.appendChild(s)),s={type:"script",instance:s,count:1,state:null},i.set(r,s))}}function dee(t,e,n,i){var r=(r=bb.current)?wU(r):null;if(!r)throw Error(jt(446));switch(t){case"meta":case"title":return null;case"style":return typeof n.precedence=="string"&&typeof n.href=="string"?(e=UC(n.href),n=jw(r).hoistableStyles,i=n.get(e),i||(i={type:"style",instance:null,count:0,state:null},n.set(e,i)),i):{type:"void",instance:null,count:0,state:null};case"link":if(n.rel==="stylesheet"&&typeof n.href=="string"&&typeof n.precedence=="string"){t=UC(n.href);var s=jw(r).hoistableStyles,a=s.get(t);if(a||(r=r.ownerDocument||r,a={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},s.set(t,a),(s=r.querySelector(AI(t)))&&!s._p&&(a.instance=s,a.state.loading=5),mp.has(t)||(n={rel:"preload",as:"style",href:n.href,crossOrigin:n.crossOrigin,integrity:n.integrity,media:n.media,hrefLang:n.hrefLang,referrerPolicy:n.referrerPolicy},mp.set(t,n),s||B2e(r,t,n,a.state))),e&&i===null)throw Error(jt(528,""));return a}if(e&&i!==null)throw Error(jt(529,""));return null;case"script":return e=n.async,n=n.src,typeof n=="string"&&e&&typeof e!="function"&&typeof e!="symbol"?(e=OA(n),n=jw(r).hoistableScripts,i=n.get(e),i||(i={type:"script",instance:null,count:0,state:null},n.set(e,i)),i):{type:"void",instance:null,count:0,state:null};default:throw Error(jt(444,t))}}function UC(t){return'href="'+Xd(t)+'"'}function AI(t){return'link[rel="stylesheet"]['+t+"]"}function rde(t){return xa({},t,{"data-precedence":t.precedence,precedence:null})}function B2e(t,e,n,i){t.querySelector('link[rel="preload"][as="style"]['+e+"]")?i.loading=1:(e=t.createElement("link"),i.preload=e,e.addEventListener("load",function(){return i.loading|=1}),e.addEventListener("error",function(){return i.loading|=2}),Hl(e,"link",n),hl(e),t.head.appendChild(e))}function OA(t){return'[src="'+Xd(t)+'"]'}function RI(t){return"script[async]"+t}function pee(t,e,n){if(e.count++,e.instance===null)switch(e.type){case"style":var i=t.querySelector('style[data-href~="'+Xd(n.href)+'"]');if(i)return e.instance=i,hl(i),i;var r=xa({},n,{"data-href":n.href,"data-precedence":n.precedence,href:null,precedence:null});return i=(t.ownerDocument||t).createElement("style"),hl(i),Hl(i,"style",r),h2(i,n.precedence,t),e.instance=i;case"stylesheet":r=UC(n.href);var s=t.querySelector(AI(r));if(s)return e.state.loading|=4,e.instance=s,hl(s),s;i=rde(n),(r=mp.get(r))&&BW(i,r),s=(t.ownerDocument||t).createElement("link"),hl(s);var a=s;return a._p=new Promise(function(o,c){a.onload=o,a.onerror=c}),Hl(s,"link",i),e.state.loading|=4,h2(s,n.precedence,t),e.instance=s;case"script":return s=OA(n.src),(r=t.querySelector(RI(s)))?(e.instance=r,hl(r),r):(i=n,(r=mp.get(s))&&(i=xa({},n),FW(i,r)),t=t.ownerDocument||t,r=t.createElement("script"),hl(r),Hl(r,"link",i),t.head.appendChild(r),e.instance=r);case"void":return null;default:throw Error(jt(443,e.type))}else e.type==="stylesheet"&&!(e.state.loading&4)&&(i=e.instance,e.state.loading|=4,h2(i,n.precedence,t));return e.instance}function h2(t,e,n){for(var i=n.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),r=i.length?i[i.length-1]:null,s=r,a=0;a<i.length;a++){var o=i[a];if(o.dataset.precedence===e)s=o;else if(s!==r)break}s?s.parentNode.insertBefore(t,s.nextSibling):(e=n.nodeType===9?n.head:n,e.insertBefore(t,e.firstChild))}function BW(t,e){t.crossOrigin==null&&(t.crossOrigin=e.crossOrigin),t.referrerPolicy==null&&(t.referrerPolicy=e.referrerPolicy),t.title==null&&(t.title=e.title)}function FW(t,e){t.crossOrigin==null&&(t.crossOrigin=e.crossOrigin),t.referrerPolicy==null&&(t.referrerPolicy=e.referrerPolicy),t.integrity==null&&(t.integrity=e.integrity)}var f2=null;function mee(t,e,n){if(f2===null){var i=new Map,r=f2=new Map;r.set(n,i)}else r=f2,i=r.get(n),i||(i=new Map,r.set(n,i));if(i.has(t))return i;for(i.set(t,null),n=n.getElementsByTagName(t),r=0;r<n.length;r++){var s=n[r];if(!(s[vI]||s[du]||t==="link"&&s.getAttribute("rel")==="stylesheet")&&s.namespaceURI!=="http://www.w3.org/2000/svg"){var a=s.getAttribute(e)||"";a=t+a;var o=i.get(a);o?o.push(s):i.set(a,[s])}}return i}function gee(t,e,n){t=t.ownerDocument||t,t.head.insertBefore(n,e==="title"?t.querySelector("head > title"):null)}function F2e(t,e,n){if(n===1||e.itemProp!=null)return!1;switch(t){case"meta":case"title":return!0;case"style":if(typeof e.precedence!="string"||typeof e.href!="string"||e.href==="")break;return!0;case"link":if(typeof e.rel!="string"||typeof e.href!="string"||e.href===""||e.onLoad||e.onError)break;switch(e.rel){case"stylesheet":return t=e.disabled,typeof e.precedence=="string"&&t==null;default:return!0}case"script":if(e.async&&typeof e.async!="function"&&typeof e.async!="symbol"&&!e.onLoad&&!e.onError&&e.src&&typeof e.src=="string")return!0}return!1}function sde(t){return!(t.type==="stylesheet"&&!(t.state.loading&3))}var LO=null;function z2e(){}function H2e(t,e,n){if(LO===null)throw Error(jt(475));var i=LO;if(e.type==="stylesheet"&&(typeof n.media!="string"||matchMedia(n.media).matches!==!1)&&!(e.state.loading&4)){if(e.instance===null){var r=UC(n.href),s=t.querySelector(AI(r));if(s){t=s._p,t!==null&&typeof t=="object"&&typeof t.then=="function"&&(i.count++,i=CU.bind(i),t.then(i,i)),e.state.loading|=4,e.instance=s,hl(s);return}s=t.ownerDocument||t,n=rde(n),(r=mp.get(r))&&BW(n,r),s=s.createElement("link"),hl(s);var a=s;a._p=new Promise(function(o,c){a.onload=o,a.onerror=c}),Hl(s,"link",n),e.instance=s}i.stylesheets===null&&(i.stylesheets=new Map),i.stylesheets.set(e,t),(t=e.state.preload)&&!(e.state.loading&3)&&(i.count++,e=CU.bind(i),t.addEventListener("load",e),t.addEventListener("error",e))}}function j2e(){if(LO===null)throw Error(jt(475));var t=LO;return t.stylesheets&&t.count===0&&xG(t,t.stylesheets),0<t.count?function(e){var n=setTimeout(function(){if(t.stylesheets&&xG(t,t.stylesheets),t.unsuspend){var i=t.unsuspend;t.unsuspend=null,i()}},6e4);return t.unsuspend=e,function(){t.unsuspend=null,clearTimeout(n)}}:null}function CU(){if(this.count--,this.count===0){if(this.stylesheets)xG(this,this.stylesheets);else if(this.unsuspend){var t=this.unsuspend;this.unsuspend=null,t()}}}var AU=null;function xG(t,e){t.stylesheets=null,t.unsuspend!==null&&(t.count++,AU=new Map,e.forEach(V2e,t),AU=null,CU.call(t))}function V2e(t,e){if(!(e.state.loading&4)){var n=AU.get(t);if(n)var i=n.get(null);else{n=new Map,AU.set(t,n);for(var r=t.querySelectorAll("link[data-precedence],style[data-precedence]"),s=0;s<r.length;s++){var a=r[s];(a.nodeName==="LINK"||a.getAttribute("media")!=="not all")&&(n.set(a.dataset.precedence,a),i=a)}i&&n.set(null,i)}r=e.instance,a=r.getAttribute("data-precedence"),s=n.get(a)||i,s===i&&n.set(null,r),n.set(a,r),this.count++,i=CU.bind(this),r.addEventListener("load",i),r.addEventListener("error",i),s?s.parentNode.insertBefore(r,s.nextSibling):(t=t.nodeType===9?t.head:t,t.insertBefore(r,t.firstChild)),e.state.loading|=4}}var UO={$$typeof:Zv,Provider:null,Consumer:null,_currentValue:vT,_currentValue2:vT,_threadCount:0};function G2e(t,e,n,i,r,s,a,o){this.tag=1,this.containerInfo=t,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=MH(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=MH(0),this.hiddenUpdates=MH(null),this.identifierPrefix=i,this.onUncaughtError=r,this.onCaughtError=s,this.onRecoverableError=a,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=o,this.incompleteTransitions=new Map}function ade(t,e,n,i,r,s,a,o,c,l,u,h){return t=new G2e(t,e,n,a,o,c,l,h),e=1,s===!0&&(e|=24),s=Kf(3,null,null,e),t.current=s,s.stateNode=t,e=dW(),e.refCount++,t.pooledCache=e,e.refCount++,s.memoizedState={element:i,isDehydrated:n,cache:e},mW(s),t}function ode(t){return t?(t=xw,t):xw}function cde(t,e,n,i,r,s){r=ode(r),i.context===null?i.context=r:i.pendingContext=r,i=Eb(e),i.payload={element:n},s=s===void 0?null:s,s!==null&&(i.callback=s),n=Sb(t,i,e),n!==null&&(rd(n,t,e),DM(n,t,e))}function vee(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function zW(t,e){vee(t,e),(t=t.alternate)&&vee(t,e)}function lde(t){if(t.tag===13){var e=AA(t,67108864);e!==null&&rd(e,t,67108864),zW(t,67108864)}}var RU=!0;function q2e(t,e,n,i){var r=Bi.T;Bi.T=null;var s=ys.p;try{ys.p=2,HW(t,e,n,i)}finally{ys.p=s,Bi.T=r}}function $2e(t,e,n,i){var r=Bi.T;Bi.T=null;var s=ys.p;try{ys.p=8,HW(t,e,n,i)}finally{ys.p=s,Bi.T=r}}function HW(t,e,n,i){if(RU){var r=wG(i);if(r===null)a5(t,e,i,MU,n),_ee(t,i);else if(Y2e(r,t,e,n,i))i.stopPropagation();else if(_ee(t,i),e&4&&-1<W2e.indexOf(t)){for(;r!==null;){var s=CA(r);if(s!==null)switch(s.tag){case 3:if(s=s.stateNode,s.current.memoizedState.isDehydrated){var a=VS(s.pendingLanes);if(a!==0){var o=s;for(o.pendingLanes|=2,o.entangledLanes|=2;a;){var c=1<<31-nd(a);o.entanglements[1]|=c,a&=~c}d0(s),!(Ms&6)&&(yU=Fg()+500,CI(0))}}break;case 13:o=AA(s,2),o!==null&&rd(o,s,2),iF(),zW(s,2)}if(s=wG(i),s===null&&a5(t,e,i,MU,n),s===r)break;r=s}r!==null&&i.stopPropagation()}else a5(t,e,i,null,n)}}function wG(t){return t=iW(t),jW(t)}var MU=null;function jW(t){if(MU=null,t=_w(t),t!==null){var e=dI(t);if(e===null)t=null;else{var n=e.tag;if(n===13){if(t=Due(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null)}}return MU=t,null}function ude(t){switch(t){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(IDe()){case Bue:return 2;case Fue:return 8;case iU:case kDe:return 32;case zue:return 268435456;default:return 32}default:return 32}}var CG=!1,wb=null,Cb=null,Ab=null,BO=new Map,FO=new Map,ob=[],W2e="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function _ee(t,e){switch(t){case"focusin":case"focusout":wb=null;break;case"dragenter":case"dragleave":Cb=null;break;case"mouseover":case"mouseout":Ab=null;break;case"pointerover":case"pointerout":BO.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":FO.delete(e.pointerId)}}function kR(t,e,n,i,r,s){return t===null||t.nativeEvent!==s?(t={blockedOn:e,domEventName:n,eventSystemFlags:i,nativeEvent:s,targetContainers:[r]},e!==null&&(e=CA(e),e!==null&&lde(e)),t):(t.eventSystemFlags|=i,e=t.targetContainers,r!==null&&e.indexOf(r)===-1&&e.push(r),t)}function Y2e(t,e,n,i,r){switch(e){case"focusin":return wb=kR(wb,t,e,n,i,r),!0;case"dragenter":return Cb=kR(Cb,t,e,n,i,r),!0;case"mouseover":return Ab=kR(Ab,t,e,n,i,r),!0;case"pointerover":var s=r.pointerId;return BO.set(s,kR(BO.get(s)||null,t,e,n,i,r)),!0;case"gotpointercapture":return s=r.pointerId,FO.set(s,kR(FO.get(s)||null,t,e,n,i,r)),!0}return!1}function hde(t){var e=_w(t.target);if(e!==null){var n=dI(e);if(n!==null){if(e=n.tag,e===13){if(e=Due(n),e!==null){t.blockedOn=e,HDe(t.priority,function(){if(n.tag===13){var i=id();i=Q7(i);var r=AA(n,i);r!==null&&rd(r,n,i),zW(n,i)}});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function d2(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=wG(t.nativeEvent);if(n===null){n=t.nativeEvent;var i=new n.constructor(n.type,n);VV=i,n.target.dispatchEvent(i),VV=null}else return e=CA(n),e!==null&&lde(e),t.blockedOn=n,!1;e.shift()}return!0}function yee(t,e,n){d2(t)&&n.delete(e)}function X2e(){CG=!1,wb!==null&&d2(wb)&&(wb=null),Cb!==null&&d2(Cb)&&(Cb=null),Ab!==null&&d2(Ab)&&(Ab=null),BO.forEach(yee),FO.forEach(yee)}function ZD(t,e){t.blockedOn===e&&(t.blockedOn=null,CG||(CG=!0,Gc.unstable_scheduleCallback(Gc.unstable_NormalPriority,X2e)))}var JD=null;function bee(t){JD!==t&&(JD=t,Gc.unstable_scheduleCallback(Gc.unstable_NormalPriority,function(){JD===t&&(JD=null);for(var e=0;e<t.length;e+=3){var n=t[e],i=t[e+1],r=t[e+2];if(typeof i!="function"){if(jW(i||n)===null)continue;break}var s=CA(n);s!==null&&(t.splice(e,3),e-=3,sG(s,{pending:!0,data:r,method:n.method,action:i},i,r))}}))}function zO(t){function e(c){return ZD(c,t)}wb!==null&&ZD(wb,t),Cb!==null&&ZD(Cb,t),Ab!==null&&ZD(Ab,t),BO.forEach(e),FO.forEach(e);for(var n=0;n<ob.length;n++){var i=ob[n];i.blockedOn===t&&(i.blockedOn=null)}for(;0<ob.length&&(n=ob[0],n.blockedOn===null);)hde(n),n.blockedOn===null&&ob.shift();if(n=(t.ownerDocument||t).$$reactFormReplay,n!=null)for(i=0;i<n.length;i+=3){var r=n[i],s=n[i+1],a=r[sf]||null;if(typeof s=="function")a||bee(n);else if(a){var o=null;if(s&&s.hasAttribute("formAction")){if(r=s,a=s[sf]||null)o=a.formAction;else if(jW(r)!==null)continue}else o=a.action;typeof o=="function"?n[i+1]=o:(n.splice(i,3),i-=3),bee(n)}}}function VW(t){this._internalRoot=t}oF.prototype.render=VW.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(jt(409));var n=e.current,i=id();cde(n,i,t,e,null,null)};oF.prototype.unmount=VW.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;cde(t.current,2,null,t,null,null),iF(),e[wA]=null}};function oF(t){this._internalRoot=t}oF.prototype.unstable_scheduleHydration=function(t){if(t){var e=que();t={blockedOn:null,target:t,priority:e};for(var n=0;n<ob.length&&e!==0&&e<ob[n].priority;n++);ob.splice(n,0,t),n===0&&hde(t)}};var Eee=Iue.version;if(Eee!=="19.1.0")throw Error(jt(527,Eee,"19.1.0"));ys.findDOMNode=function(t){var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(jt(188)):(t=Object.keys(t).join(","),Error(jt(268,t)));return t=wDe(e),t=t!==null?Pue(t):null,t=t===null?null:t.stateNode,t};var K2e={bundleType:0,version:"19.1.0",rendererPackageName:"react-dom",currentDispatcherRef:Bi,reconcilerVersion:"19.1.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var QD=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!QD.isDisabled&&QD.supportsFiber)try{pI=QD.inject(K2e),td=QD}catch{}}qB.createRoot=function(t,e){if(!kue(t))throw Error(jt(299));var n=!1,i="",r=afe,s=ofe,a=cfe,o=null;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(i=e.identifierPrefix),e.onUncaughtError!==void 0&&(r=e.onUncaughtError),e.onCaughtError!==void 0&&(s=e.onCaughtError),e.onRecoverableError!==void 0&&(a=e.onRecoverableError),e.unstable_transitionCallbacks!==void 0&&(o=e.unstable_transitionCallbacks)),e=ade(t,1,!1,null,null,n,i,r,s,a,o,null),t[wA]=e.current,UW(t),new VW(e)};qB.hydrateRoot=function(t,e,n){if(!kue(t))throw Error(jt(299));var i=!1,r="",s=afe,a=ofe,o=cfe,c=null,l=null;return n!=null&&(n.unstable_strictMode===!0&&(i=!0),n.identifierPrefix!==void 0&&(r=n.identifierPrefix),n.onUncaughtError!==void 0&&(s=n.onUncaughtError),n.onCaughtError!==void 0&&(a=n.onCaughtError),n.onRecoverableError!==void 0&&(o=n.onRecoverableError),n.unstable_transitionCallbacks!==void 0&&(c=n.unstable_transitionCallbacks),n.formState!==void 0&&(l=n.formState)),e=ade(t,1,!0,e,n??null,i,r,s,a,o,c,l),e.context=ode(null),n=e.current,i=id(),i=Q7(i),r=Eb(i),r.callback=null,Sb(n,r,i),n=i,e.current.lanes=n,gI(e,n),d0(e),t[wA]=e.current,UW(t),new oF(e)};qB.version="19.1.0";function fde(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(fde)}catch(t){console.error(t)}}fde(),Cue.exports=qB;var Z2e=Cue.exports;/*! unmute-ios-audio. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> */var J2e=Q2e;const See=["auxclick","click","contextmenu","dblclick","keydown","keyup","mousedown","mouseup","touchend"];function Q2e(){const t=window.webkitAudioContext;if(!(navigator.maxTouchPoints>0&&t!=null))return;let n="blocked",i="blocked",r,s,a;const o=new t().sampleRate,c=l(o);See.forEach(p=>{window.addEventListener(p,u,{capture:!0,passive:!0})});function l(p){const g=new ArrayBuffer(10),y=new DataView(g);return y.setUint32(0,p,!0),y.setUint32(4,p,!0),y.setUint16(8,1,!0),`data:audio/wav;base64,UklGRisAAABXQVZFZm10IBAAAAABAAEA${window.btoa(String.fromCharCode(...new Uint8Array(g))).slice(0,13)}AgAZGF0YQcAAACAgICAgICAAAA=`}function u(p){n==="blocked"&&(n="pending",h()),i==="blocked"&&(i="pending",f())}function h(){r=document.createElement("audio"),r.setAttribute("x-webkit-airplay","deny"),r.preload="auto",r.loop=!0,r.src=c,r.load(),r.play().then(()=>{n="allowed",d()},()=>{n="blocked",r.pause(),r.removeAttribute("src"),r.load(),r=null})}function f(){s=new t,a=s.createBufferSource(),a.buffer=s.createBuffer(1,1,22050),a.connect(s.destination),a.start(),s.state==="running"?(i="allowed",d()):(i="blocked",a.disconnect(s.destination),a=null,s.close(),s=null)}function d(){n!=="allowed"||i!=="allowed"||See.forEach(p=>{window.removeEventListener(p,u,{capture:!0,passive:!0})})}}const eLe=Yc(J2e);var dde={exports:{}};(function(t,e){(function(n,i){t.exports=i()})(jl,function(){return n.importState=function(r){var s=new n;return s.importState(r),s},n;function n(){return function(r){var s=0,a=0,o=0,c=1;r.length==0&&(r=[+new Date]);var l=i();s=l(" "),a=l(" "),o=l(" ");for(var u=0;u<r.length;u++)s-=l(r[u]),s<0&&(s+=1),a-=l(r[u]),a<0&&(a+=1),o-=l(r[u]),o<0&&(o+=1);l=null;var h=function(){var f=2091639*s+c*23283064365386963e-26;return s=a,a=o,o=f-(c=f|0)};return h.next=h,h.uint32=function(){return h()*4294967296},h.fract53=function(){return h()+(h()*2097152|0)*11102230246251565e-32},h.version="Alea 0.9",h.args=r,h.exportState=function(){return[s,a,o,c]},h.importState=function(f){s=+f[0]||0,a=+f[1]||0,o=+f[2]||0,c=+f[3]||0},h}(Array.prototype.slice.call(arguments))}function i(){var r=4022871197,s=function(a){a=a.toString();for(var o=0;o<a.length;o++){r+=a.charCodeAt(o);var c=.02519603282416938*r;r=c>>>0,c-=r,c*=r,r=c>>>0,c-=r,r+=c*4294967296}return(r>>>0)*23283064365386963e-26};return s.version="Mash 0.9",s}})})(dde);var tLe=dde.exports;const GW=Yc(tLe);new Rt;new Rt;function lr(t,e,n){return Math.max(e,Math.min(n,t))}function nLe(t,e){return lr(t-Math.floor(t/e)*e,0,e)}function iLe(t,e){var n=nLe(e-t,Math.PI*2);return n>Math.PI&&(n-=Math.PI*2),n}function pde(t){return t/180*Math.PI}function mde(t){return t*180/Math.PI}const rLe=GW("089fad0j9awfem09wavefc09uwaef");function Tee(t){return 2*Math.floor(t/2)}function cF(t,e){return Math.round(t/e)*e}function sLe(){return rLe()}function aLe(t){return GW(t)()}function Zd(t,e){const n=Math.min(t,e),r=Math.max(t,e)-n+1;return n+Math.floor(sLe()*r)}function gde(t,e,n){const i=Math.min(e,n),s=Math.max(e,n)-i+1;return i+Math.floor(aLe(t)*s)}/*!
 * https://github.com/Starcounter-Jack/JSON-Patch
 * (c) 2017-2022 Joachim Wester
 * MIT licensed
 */var oLe=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var s in r)r.hasOwnProperty(s)&&(i[s]=r[s])},t(e,n)};return function(e,n){t(e,n);function i(){this.constructor=e}e.prototype=n===null?Object.create(n):(i.prototype=n.prototype,new i)}}(),cLe=Object.prototype.hasOwnProperty;function AG(t,e){return cLe.call(t,e)}function RG(t){if(Array.isArray(t)){for(var e=new Array(t.length),n=0;n<e.length;n++)e[n]=""+n;return e}if(Object.keys)return Object.keys(t);var i=[];for(var r in t)AG(t,r)&&i.push(r);return i}function Yh(t){switch(typeof t){case"object":return JSON.parse(JSON.stringify(t));case"undefined":return null;default:return t}}function MG(t){for(var e=0,n=t.length,i;e<n;){if(i=t.charCodeAt(e),i>=48&&i<=57){e++;continue}return!1}return!0}function $S(t){return t.indexOf("/")===-1&&t.indexOf("~")===-1?t:t.replace(/~/g,"~0").replace(/\//g,"~1")}function vde(t){return t.replace(/~1/g,"/").replace(/~0/g,"~")}function OG(t){if(t===void 0)return!0;if(t){if(Array.isArray(t)){for(var e=0,n=t.length;e<n;e++)if(OG(t[e]))return!0}else if(typeof t=="object"){for(var i=RG(t),r=i.length,s=0;s<r;s++)if(OG(t[i[s]]))return!0}}return!1}function xee(t,e){var n=[t];for(var i in e){var r=typeof e[i]=="object"?JSON.stringify(e[i],null,2):e[i];typeof r<"u"&&n.push(i+": "+r)}return n.join(`
`)}var _de=function(t){oLe(e,t);function e(n,i,r,s,a){var o=this.constructor,c=t.call(this,xee(n,{name:i,index:r,operation:s,tree:a}))||this;return c.name=i,c.index=r,c.operation=s,c.tree=a,Object.setPrototypeOf(c,o.prototype),c.message=xee(n,{name:i,index:r,operation:s,tree:a}),c}return e}(Error),_o=_de,lLe=Yh,Rw={add:function(t,e,n){return t[e]=this.value,{newDocument:n}},remove:function(t,e,n){var i=t[e];return delete t[e],{newDocument:n,removed:i}},replace:function(t,e,n){var i=t[e];return t[e]=this.value,{newDocument:n,removed:i}},move:function(t,e,n){var i=OU(n,this.path);i&&(i=Yh(i));var r=xT(n,{op:"remove",path:this.from}).removed;return xT(n,{op:"add",path:this.path,value:r}),{newDocument:n,removed:i}},copy:function(t,e,n){var i=OU(n,this.from);return xT(n,{op:"add",path:this.path,value:Yh(i)}),{newDocument:n}},test:function(t,e,n){return{newDocument:n,test:HO(t[e],this.value)}},_get:function(t,e,n){return this.value=t[e],{newDocument:n}}},uLe={add:function(t,e,n){return MG(e)?t.splice(e,0,this.value):t[e]=this.value,{newDocument:n,index:e}},remove:function(t,e,n){var i=t.splice(e,1);return{newDocument:n,removed:i[0]}},replace:function(t,e,n){var i=t[e];return t[e]=this.value,{newDocument:n,removed:i}},move:Rw.move,copy:Rw.copy,test:Rw.test,_get:Rw._get};function OU(t,e){if(e=="")return t;var n={op:"_get",path:e};return xT(t,n),n.value}function xT(t,e,n,i,r,s){if(n===void 0&&(n=!1),i===void 0&&(i=!0),r===void 0&&(r=!0),s===void 0&&(s=0),n&&(typeof n=="function"?n(e,0,t,e.path):NU(e,0)),e.path===""){var a={newDocument:t};if(e.op==="add")return a.newDocument=e.value,a;if(e.op==="replace")return a.newDocument=e.value,a.removed=t,a;if(e.op==="move"||e.op==="copy")return a.newDocument=OU(t,e.from),e.op==="move"&&(a.removed=t),a;if(e.op==="test"){if(a.test=HO(t,e.value),a.test===!1)throw new _o("Test operation failed","TEST_OPERATION_FAILED",s,e,t);return a.newDocument=t,a}else{if(e.op==="remove")return a.removed=t,a.newDocument=null,a;if(e.op==="_get")return e.value=t,a;if(n)throw new _o("Operation `op` property is not one of operations defined in RFC-6902","OPERATION_OP_INVALID",s,e,t);return a}}else{i||(t=Yh(t));var o=e.path||"",c=o.split("/"),l=t,u=1,h=c.length,f=void 0,d=void 0,p=void 0;for(typeof n=="function"?p=n:p=NU;;){if(d=c[u],d&&d.indexOf("~")!=-1&&(d=vde(d)),r&&(d=="__proto__"||d=="prototype"&&u>0&&c[u-1]=="constructor"))throw new TypeError("JSON-Patch: modifying `__proto__` or `constructor/prototype` prop is banned for security reasons, if this was on purpose, please set `banPrototypeModifications` flag false and pass it to this function. More info in fast-json-patch README");if(n&&f===void 0&&(l[d]===void 0?f=c.slice(0,u).join("/"):u==h-1&&(f=e.path),f!==void 0&&p(e,0,t,f)),u++,Array.isArray(l)){if(d==="-")d=l.length;else{if(n&&!MG(d))throw new _o("Expected an unsigned base-10 integer value, making the new referenced value the array element with the zero-based index","OPERATION_PATH_ILLEGAL_ARRAY_INDEX",s,e,t);MG(d)&&(d=~~d)}if(u>=h){if(n&&e.op==="add"&&d>l.length)throw new _o("The specified index MUST NOT be greater than the number of elements in the array","OPERATION_VALUE_OUT_OF_BOUNDS",s,e,t);var a=uLe[e.op].call(e,l,d,t);if(a.test===!1)throw new _o("Test operation failed","TEST_OPERATION_FAILED",s,e,t);return a}}else if(u>=h){var a=Rw[e.op].call(e,l,d,t);if(a.test===!1)throw new _o("Test operation failed","TEST_OPERATION_FAILED",s,e,t);return a}if(l=l[d],n&&u<h&&(!l||typeof l!="object"))throw new _o("Cannot perform operation at the desired path","OPERATION_PATH_UNRESOLVABLE",s,e,t)}}}function lF(t,e,n,i,r){if(i===void 0&&(i=!0),r===void 0&&(r=!0),n&&!Array.isArray(e))throw new _o("Patch sequence must be an array","SEQUENCE_NOT_AN_ARRAY");i||(t=Yh(t));for(var s=new Array(e.length),a=0,o=e.length;a<o;a++)s[a]=xT(t,e[a],n,!0,r,a),t=s[a].newDocument;return s.newDocument=t,s}function hLe(t,e,n){var i=xT(t,e);if(i.test===!1)throw new _o("Test operation failed","TEST_OPERATION_FAILED",n,e,t);return i.newDocument}function NU(t,e,n,i){if(typeof t!="object"||t===null||Array.isArray(t))throw new _o("Operation is not an object","OPERATION_NOT_AN_OBJECT",e,t,n);if(Rw[t.op]){if(typeof t.path!="string")throw new _o("Operation `path` property is not a string","OPERATION_PATH_INVALID",e,t,n);if(t.path.indexOf("/")!==0&&t.path.length>0)throw new _o('Operation `path` property must start with "/"',"OPERATION_PATH_INVALID",e,t,n);if((t.op==="move"||t.op==="copy")&&typeof t.from!="string")throw new _o("Operation `from` property is not present (applicable in `move` and `copy` operations)","OPERATION_FROM_REQUIRED",e,t,n);if((t.op==="add"||t.op==="replace"||t.op==="test")&&t.value===void 0)throw new _o("Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)","OPERATION_VALUE_REQUIRED",e,t,n);if((t.op==="add"||t.op==="replace"||t.op==="test")&&OG(t.value))throw new _o("Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)","OPERATION_VALUE_CANNOT_CONTAIN_UNDEFINED",e,t,n);if(n){if(t.op=="add"){var r=t.path.split("/").length,s=i.split("/").length;if(r!==s+1&&r!==s)throw new _o("Cannot perform an `add` operation at the desired path","OPERATION_PATH_CANNOT_ADD",e,t,n)}else if(t.op==="replace"||t.op==="remove"||t.op==="_get"){if(t.path!==i)throw new _o("Cannot perform the operation at a path that does not exist","OPERATION_PATH_UNRESOLVABLE",e,t,n)}else if(t.op==="move"||t.op==="copy"){var a={op:"_get",path:t.from,value:void 0},o=qW([a],n);if(o&&o.name==="OPERATION_PATH_UNRESOLVABLE")throw new _o("Cannot perform the operation from a path that does not exist","OPERATION_FROM_UNRESOLVABLE",e,t,n)}}}else throw new _o("Operation `op` property is not one of operations defined in RFC-6902","OPERATION_OP_INVALID",e,t,n)}function qW(t,e,n){try{if(!Array.isArray(t))throw new _o("Patch sequence must be an array","SEQUENCE_NOT_AN_ARRAY");if(e)lF(Yh(e),Yh(t),n||!0);else{n=n||NU;for(var i=0;i<t.length;i++)n(t[i],i,e,void 0)}}catch(r){if(r instanceof _o)return r;throw r}}function HO(t,e){if(t===e)return!0;if(t&&e&&typeof t=="object"&&typeof e=="object"){var n=Array.isArray(t),i=Array.isArray(e),r,s,a;if(n&&i){if(s=t.length,s!=e.length)return!1;for(r=s;r--!==0;)if(!HO(t[r],e[r]))return!1;return!0}if(n!=i)return!1;var o=Object.keys(t);if(s=o.length,s!==Object.keys(e).length)return!1;for(r=s;r--!==0;)if(!e.hasOwnProperty(o[r]))return!1;for(r=s;r--!==0;)if(a=o[r],!HO(t[a],e[a]))return!1;return!0}return t!==t&&e!==e}const fLe=Object.freeze(Object.defineProperty({__proto__:null,JsonPatchError:_o,_areEquals:HO,applyOperation:xT,applyPatch:lF,applyReducer:hLe,deepClone:lLe,getValueByPointer:OU,validate:qW,validator:NU},Symbol.toStringTag,{value:"Module"}));/*!
 * https://github.com/Starcounter-Jack/JSON-Patch
 * (c) 2017-2021 Joachim Wester
 * MIT license
 */var $W=new WeakMap,dLe=function(){function t(e){this.observers=new Map,this.obj=e}return t}(),pLe=function(){function t(e,n){this.callback=e,this.observer=n}return t}();function mLe(t){return $W.get(t)}function gLe(t,e){return t.observers.get(e)}function vLe(t,e){t.observers.delete(e.callback)}function _Le(t,e){e.unobserve()}function yLe(t,e){var n=[],i,r=mLe(t);if(!r)r=new dLe(t),$W.set(t,r);else{var s=gLe(r,e);i=s&&s.observer}if(i)return i;if(i={},r.value=Yh(t),e){i.callback=e,i.next=null;var a=function(){NG(i)},o=function(){clearTimeout(i.next),i.next=setTimeout(a)};typeof window<"u"&&(window.addEventListener("mouseup",o),window.addEventListener("keyup",o),window.addEventListener("mousedown",o),window.addEventListener("keydown",o),window.addEventListener("change",o))}return i.patches=n,i.object=t,i.unobserve=function(){NG(i),clearTimeout(i.next),vLe(r,i),typeof window<"u"&&(window.removeEventListener("mouseup",o),window.removeEventListener("keyup",o),window.removeEventListener("mousedown",o),window.removeEventListener("keydown",o),window.removeEventListener("change",o))},r.observers.set(e,new pLe(e,i)),i}function NG(t,e){e===void 0&&(e=!1);var n=$W.get(t.object);WW(n.value,t.object,t.patches,"",e),t.patches.length&&lF(n.value,t.patches);var i=t.patches;return i.length>0&&(t.patches=[],t.callback&&t.callback(i)),i}function WW(t,e,n,i,r){if(e!==t){typeof e.toJSON=="function"&&(e=e.toJSON());for(var s=RG(e),a=RG(t),o=!1,c=a.length-1;c>=0;c--){var l=a[c],u=t[l];if(AG(e,l)&&!(e[l]===void 0&&u!==void 0&&Array.isArray(e)===!1)){var h=e[l];typeof u=="object"&&u!=null&&typeof h=="object"&&h!=null&&Array.isArray(u)===Array.isArray(h)?WW(u,h,n,i+"/"+$S(l),r):u!==h&&(r&&n.push({op:"test",path:i+"/"+$S(l),value:Yh(u)}),n.push({op:"replace",path:i+"/"+$S(l),value:Yh(h)}))}else Array.isArray(t)===Array.isArray(e)?(r&&n.push({op:"test",path:i+"/"+$S(l),value:Yh(u)}),n.push({op:"remove",path:i+"/"+$S(l)}),o=!0):(r&&n.push({op:"test",path:i,value:t}),n.push({op:"replace",path:i,value:e}))}if(!(!o&&s.length==a.length))for(var c=0;c<s.length;c++){var l=s[c];!AG(t,l)&&e[l]!==void 0&&n.push({op:"add",path:i+"/"+$S(l),value:Yh(e[l])})}}}function bLe(t,e,n){n===void 0&&(n=!1);var i=[];return WW(t,e,i,"",n),i}const ELe=Object.freeze(Object.defineProperty({__proto__:null,compare:bLe,generate:NG,observe:yLe,unobserve:_Le},Symbol.toStringTag,{value:"Module"}));Object.assign({},fLe,ELe,{JsonPatchError:_de,deepClone:Yh,escapePathComponent:$S,unescapePathComponent:vde});var SLe=typeof Element<"u",TLe=typeof Map=="function",xLe=typeof Set=="function",wLe=typeof ArrayBuffer=="function"&&!!ArrayBuffer.isView;function p2(t,e){if(t===e)return!0;if(t&&e&&typeof t=="object"&&typeof e=="object"){if(t.constructor!==e.constructor)return!1;var n,i,r;if(Array.isArray(t)){if(n=t.length,n!=e.length)return!1;for(i=n;i--!==0;)if(!p2(t[i],e[i]))return!1;return!0}var s;if(TLe&&t instanceof Map&&e instanceof Map){if(t.size!==e.size)return!1;for(s=t.entries();!(i=s.next()).done;)if(!e.has(i.value[0]))return!1;for(s=t.entries();!(i=s.next()).done;)if(!p2(i.value[1],e.get(i.value[0])))return!1;return!0}if(xLe&&t instanceof Set&&e instanceof Set){if(t.size!==e.size)return!1;for(s=t.entries();!(i=s.next()).done;)if(!e.has(i.value[0]))return!1;return!0}if(wLe&&ArrayBuffer.isView(t)&&ArrayBuffer.isView(e)){if(n=t.length,n!=e.length)return!1;for(i=n;i--!==0;)if(t[i]!==e[i])return!1;return!0}if(t.constructor===RegExp)return t.source===e.source&&t.flags===e.flags;if(t.valueOf!==Object.prototype.valueOf&&typeof t.valueOf=="function"&&typeof e.valueOf=="function")return t.valueOf()===e.valueOf();if(t.toString!==Object.prototype.toString&&typeof t.toString=="function"&&typeof e.toString=="function")return t.toString()===e.toString();if(r=Object.keys(t),n=r.length,n!==Object.keys(e).length)return!1;for(i=n;i--!==0;)if(!Object.prototype.hasOwnProperty.call(e,r[i]))return!1;if(SLe&&t instanceof Element)return!1;for(i=n;i--!==0;)if(!((r[i]==="_owner"||r[i]==="__v"||r[i]==="__o")&&t.$$typeof)&&!p2(t[r[i]],e[r[i]]))return!1;return!0}return t!==t&&e!==e}var CLe=function(e,n){try{return p2(e,n)}catch(i){if((i.message||"").match(/stack|recursion/i))return console.warn("react-fast-compare cannot handle circular refs"),!1;throw i}};const Mw=Yc(CLe);function se(t){return t!=null}const ALe=Object.fromEntries,uF=Object.keys;function fl(t){return Yh(t)}function RLe(t){return typeof t=="boolean"}function pn(t){return typeof t=="number"&&isNaN(t)===!1}function On(t){return typeof t=="string"}function Li(t){return Array.isArray(t)}function Zu(t){return t}/*! pako 2.1.0 https://github.com/nodeca/pako @license (MIT AND Zlib) */const MLe=4,wee=0,Cee=1,OLe=2;function NA(t){let e=t.length;for(;--e>=0;)t[e]=0}const NLe=0,yde=1,ILe=2,kLe=3,DLe=258,YW=29,MI=256,jO=MI+1+YW,Kw=30,XW=19,bde=2*jO+1,oT=15,c5=16,PLe=7,KW=256,Ede=16,Sde=17,Tde=18,IG=new Uint8Array([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0]),m2=new Uint8Array([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13]),LLe=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7]),xde=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),ULe=512,Hv=new Array((jO+2)*2);NA(Hv);const VM=new Array(Kw*2);NA(VM);const VO=new Array(ULe);NA(VO);const GO=new Array(DLe-kLe+1);NA(GO);const ZW=new Array(YW);NA(ZW);const IU=new Array(Kw);NA(IU);function l5(t,e,n,i,r){this.static_tree=t,this.extra_bits=e,this.extra_base=n,this.elems=i,this.max_length=r,this.has_stree=t&&t.length}let wde,Cde,Ade;function u5(t,e){this.dyn_tree=t,this.max_code=0,this.stat_desc=e}const Rde=t=>t<256?VO[t]:VO[256+(t>>>7)],qO=(t,e)=>{t.pending_buf[t.pending++]=e&255,t.pending_buf[t.pending++]=e>>>8&255},Xh=(t,e,n)=>{t.bi_valid>c5-n?(t.bi_buf|=e<<t.bi_valid&65535,qO(t,t.bi_buf),t.bi_buf=e>>c5-t.bi_valid,t.bi_valid+=n-c5):(t.bi_buf|=e<<t.bi_valid&65535,t.bi_valid+=n)},Ag=(t,e,n)=>{Xh(t,n[e*2],n[e*2+1])},Mde=(t,e)=>{let n=0;do n|=t&1,t>>>=1,n<<=1;while(--e>0);return n>>>1},BLe=t=>{t.bi_valid===16?(qO(t,t.bi_buf),t.bi_buf=0,t.bi_valid=0):t.bi_valid>=8&&(t.pending_buf[t.pending++]=t.bi_buf&255,t.bi_buf>>=8,t.bi_valid-=8)},FLe=(t,e)=>{const n=e.dyn_tree,i=e.max_code,r=e.stat_desc.static_tree,s=e.stat_desc.has_stree,a=e.stat_desc.extra_bits,o=e.stat_desc.extra_base,c=e.stat_desc.max_length;let l,u,h,f,d,p,g=0;for(f=0;f<=oT;f++)t.bl_count[f]=0;for(n[t.heap[t.heap_max]*2+1]=0,l=t.heap_max+1;l<bde;l++)u=t.heap[l],f=n[n[u*2+1]*2+1]+1,f>c&&(f=c,g++),n[u*2+1]=f,!(u>i)&&(t.bl_count[f]++,d=0,u>=o&&(d=a[u-o]),p=n[u*2],t.opt_len+=p*(f+d),s&&(t.static_len+=p*(r[u*2+1]+d)));if(g!==0){do{for(f=c-1;t.bl_count[f]===0;)f--;t.bl_count[f]--,t.bl_count[f+1]+=2,t.bl_count[c]--,g-=2}while(g>0);for(f=c;f!==0;f--)for(u=t.bl_count[f];u!==0;)h=t.heap[--l],!(h>i)&&(n[h*2+1]!==f&&(t.opt_len+=(f-n[h*2+1])*n[h*2],n[h*2+1]=f),u--)}},Ode=(t,e,n)=>{const i=new Array(oT+1);let r=0,s,a;for(s=1;s<=oT;s++)r=r+n[s-1]<<1,i[s]=r;for(a=0;a<=e;a++){let o=t[a*2+1];o!==0&&(t[a*2]=Mde(i[o]++,o))}},zLe=()=>{let t,e,n,i,r;const s=new Array(oT+1);for(n=0,i=0;i<YW-1;i++)for(ZW[i]=n,t=0;t<1<<IG[i];t++)GO[n++]=i;for(GO[n-1]=i,r=0,i=0;i<16;i++)for(IU[i]=r,t=0;t<1<<m2[i];t++)VO[r++]=i;for(r>>=7;i<Kw;i++)for(IU[i]=r<<7,t=0;t<1<<m2[i]-7;t++)VO[256+r++]=i;for(e=0;e<=oT;e++)s[e]=0;for(t=0;t<=143;)Hv[t*2+1]=8,t++,s[8]++;for(;t<=255;)Hv[t*2+1]=9,t++,s[9]++;for(;t<=279;)Hv[t*2+1]=7,t++,s[7]++;for(;t<=287;)Hv[t*2+1]=8,t++,s[8]++;for(Ode(Hv,jO+1,s),t=0;t<Kw;t++)VM[t*2+1]=5,VM[t*2]=Mde(t,5);wde=new l5(Hv,IG,MI+1,jO,oT),Cde=new l5(VM,m2,0,Kw,oT),Ade=new l5(new Array(0),LLe,0,XW,PLe)},Nde=t=>{let e;for(e=0;e<jO;e++)t.dyn_ltree[e*2]=0;for(e=0;e<Kw;e++)t.dyn_dtree[e*2]=0;for(e=0;e<XW;e++)t.bl_tree[e*2]=0;t.dyn_ltree[KW*2]=1,t.opt_len=t.static_len=0,t.sym_next=t.matches=0},Ide=t=>{t.bi_valid>8?qO(t,t.bi_buf):t.bi_valid>0&&(t.pending_buf[t.pending++]=t.bi_buf),t.bi_buf=0,t.bi_valid=0},Aee=(t,e,n,i)=>{const r=e*2,s=n*2;return t[r]<t[s]||t[r]===t[s]&&i[e]<=i[n]},h5=(t,e,n)=>{const i=t.heap[n];let r=n<<1;for(;r<=t.heap_len&&(r<t.heap_len&&Aee(e,t.heap[r+1],t.heap[r],t.depth)&&r++,!Aee(e,i,t.heap[r],t.depth));)t.heap[n]=t.heap[r],n=r,r<<=1;t.heap[n]=i},Ree=(t,e,n)=>{let i,r,s=0,a,o;if(t.sym_next!==0)do i=t.pending_buf[t.sym_buf+s++]&255,i+=(t.pending_buf[t.sym_buf+s++]&255)<<8,r=t.pending_buf[t.sym_buf+s++],i===0?Ag(t,r,e):(a=GO[r],Ag(t,a+MI+1,e),o=IG[a],o!==0&&(r-=ZW[a],Xh(t,r,o)),i--,a=Rde(i),Ag(t,a,n),o=m2[a],o!==0&&(i-=IU[a],Xh(t,i,o)));while(s<t.sym_next);Ag(t,KW,e)},kG=(t,e)=>{const n=e.dyn_tree,i=e.stat_desc.static_tree,r=e.stat_desc.has_stree,s=e.stat_desc.elems;let a,o,c=-1,l;for(t.heap_len=0,t.heap_max=bde,a=0;a<s;a++)n[a*2]!==0?(t.heap[++t.heap_len]=c=a,t.depth[a]=0):n[a*2+1]=0;for(;t.heap_len<2;)l=t.heap[++t.heap_len]=c<2?++c:0,n[l*2]=1,t.depth[l]=0,t.opt_len--,r&&(t.static_len-=i[l*2+1]);for(e.max_code=c,a=t.heap_len>>1;a>=1;a--)h5(t,n,a);l=s;do a=t.heap[1],t.heap[1]=t.heap[t.heap_len--],h5(t,n,1),o=t.heap[1],t.heap[--t.heap_max]=a,t.heap[--t.heap_max]=o,n[l*2]=n[a*2]+n[o*2],t.depth[l]=(t.depth[a]>=t.depth[o]?t.depth[a]:t.depth[o])+1,n[a*2+1]=n[o*2+1]=l,t.heap[1]=l++,h5(t,n,1);while(t.heap_len>=2);t.heap[--t.heap_max]=t.heap[1],FLe(t,e),Ode(n,c,t.bl_count)},Mee=(t,e,n)=>{let i,r=-1,s,a=e[0*2+1],o=0,c=7,l=4;for(a===0&&(c=138,l=3),e[(n+1)*2+1]=65535,i=0;i<=n;i++)s=a,a=e[(i+1)*2+1],!(++o<c&&s===a)&&(o<l?t.bl_tree[s*2]+=o:s!==0?(s!==r&&t.bl_tree[s*2]++,t.bl_tree[Ede*2]++):o<=10?t.bl_tree[Sde*2]++:t.bl_tree[Tde*2]++,o=0,r=s,a===0?(c=138,l=3):s===a?(c=6,l=3):(c=7,l=4))},Oee=(t,e,n)=>{let i,r=-1,s,a=e[0*2+1],o=0,c=7,l=4;for(a===0&&(c=138,l=3),i=0;i<=n;i++)if(s=a,a=e[(i+1)*2+1],!(++o<c&&s===a)){if(o<l)do Ag(t,s,t.bl_tree);while(--o!==0);else s!==0?(s!==r&&(Ag(t,s,t.bl_tree),o--),Ag(t,Ede,t.bl_tree),Xh(t,o-3,2)):o<=10?(Ag(t,Sde,t.bl_tree),Xh(t,o-3,3)):(Ag(t,Tde,t.bl_tree),Xh(t,o-11,7));o=0,r=s,a===0?(c=138,l=3):s===a?(c=6,l=3):(c=7,l=4)}},HLe=t=>{let e;for(Mee(t,t.dyn_ltree,t.l_desc.max_code),Mee(t,t.dyn_dtree,t.d_desc.max_code),kG(t,t.bl_desc),e=XW-1;e>=3&&t.bl_tree[xde[e]*2+1]===0;e--);return t.opt_len+=3*(e+1)+5+5+4,e},jLe=(t,e,n,i)=>{let r;for(Xh(t,e-257,5),Xh(t,n-1,5),Xh(t,i-4,4),r=0;r<i;r++)Xh(t,t.bl_tree[xde[r]*2+1],3);Oee(t,t.dyn_ltree,e-1),Oee(t,t.dyn_dtree,n-1)},VLe=t=>{let e=4093624447,n;for(n=0;n<=31;n++,e>>>=1)if(e&1&&t.dyn_ltree[n*2]!==0)return wee;if(t.dyn_ltree[9*2]!==0||t.dyn_ltree[10*2]!==0||t.dyn_ltree[13*2]!==0)return Cee;for(n=32;n<MI;n++)if(t.dyn_ltree[n*2]!==0)return Cee;return wee};let Nee=!1;const GLe=t=>{Nee||(zLe(),Nee=!0),t.l_desc=new u5(t.dyn_ltree,wde),t.d_desc=new u5(t.dyn_dtree,Cde),t.bl_desc=new u5(t.bl_tree,Ade),t.bi_buf=0,t.bi_valid=0,Nde(t)},kde=(t,e,n,i)=>{Xh(t,(NLe<<1)+(i?1:0),3),Ide(t),qO(t,n),qO(t,~n),n&&t.pending_buf.set(t.window.subarray(e,e+n),t.pending),t.pending+=n},qLe=t=>{Xh(t,yde<<1,3),Ag(t,KW,Hv),BLe(t)},$Le=(t,e,n,i)=>{let r,s,a=0;t.level>0?(t.strm.data_type===OLe&&(t.strm.data_type=VLe(t)),kG(t,t.l_desc),kG(t,t.d_desc),a=HLe(t),r=t.opt_len+3+7>>>3,s=t.static_len+3+7>>>3,s<=r&&(r=s)):r=s=n+5,n+4<=r&&e!==-1?kde(t,e,n,i):t.strategy===MLe||s===r?(Xh(t,(yde<<1)+(i?1:0),3),Ree(t,Hv,VM)):(Xh(t,(ILe<<1)+(i?1:0),3),jLe(t,t.l_desc.max_code+1,t.d_desc.max_code+1,a+1),Ree(t,t.dyn_ltree,t.dyn_dtree)),Nde(t),i&&Ide(t)},WLe=(t,e,n)=>(t.pending_buf[t.sym_buf+t.sym_next++]=e,t.pending_buf[t.sym_buf+t.sym_next++]=e>>8,t.pending_buf[t.sym_buf+t.sym_next++]=n,e===0?t.dyn_ltree[n*2]++:(t.matches++,e--,t.dyn_ltree[(GO[n]+MI+1)*2]++,t.dyn_dtree[Rde(e)*2]++),t.sym_next===t.sym_end);var YLe=GLe,XLe=kde,KLe=$Le,ZLe=WLe,JLe=qLe,QLe={_tr_init:YLe,_tr_stored_block:XLe,_tr_flush_block:KLe,_tr_tally:ZLe,_tr_align:JLe};const eUe=(t,e,n,i)=>{let r=t&65535|0,s=t>>>16&65535|0,a=0;for(;n!==0;){a=n>2e3?2e3:n,n-=a;do r=r+e[i++]|0,s=s+r|0;while(--a);r%=65521,s%=65521}return r|s<<16|0};var $O=eUe;const tUe=()=>{let t,e=[];for(var n=0;n<256;n++){t=n;for(var i=0;i<8;i++)t=t&1?3988292384^t>>>1:t>>>1;e[n]=t}return e},nUe=new Uint32Array(tUe()),iUe=(t,e,n,i)=>{const r=nUe,s=i+n;t^=-1;for(let a=i;a<s;a++)t=t>>>8^r[(t^e[a])&255];return t^-1};var ol=iUe,HT={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},b1={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8};const{_tr_init:rUe,_tr_stored_block:DG,_tr_flush_block:sUe,_tr_tally:Rb,_tr_align:aUe}=QLe,{Z_NO_FLUSH:Mb,Z_PARTIAL_FLUSH:oUe,Z_FULL_FLUSH:cUe,Z_FINISH:Jd,Z_BLOCK:Iee,Z_OK:Pl,Z_STREAM_END:kee,Z_STREAM_ERROR:Hg,Z_DATA_ERROR:lUe,Z_BUF_ERROR:f5,Z_DEFAULT_COMPRESSION:uUe,Z_FILTERED:hUe,Z_HUFFMAN_ONLY:eP,Z_RLE:fUe,Z_FIXED:dUe,Z_DEFAULT_STRATEGY:pUe,Z_UNKNOWN:mUe,Z_DEFLATED:hF}=b1,gUe=9,vUe=15,_Ue=8,yUe=29,bUe=256,PG=bUe+1+yUe,EUe=30,SUe=19,TUe=2*PG+1,xUe=15,Lr=3,mb=258,jg=mb+Lr+1,wUe=32,BC=42,JW=57,LG=69,UG=73,BG=91,FG=103,cT=113,aM=666,rh=1,IA=2,jT=3,kA=4,CUe=3,lT=(t,e)=>(t.msg=HT[e],e),Dee=t=>t*2-(t>4?9:0),cb=t=>{let e=t.length;for(;--e>=0;)t[e]=0},AUe=t=>{let e,n,i,r=t.w_size;e=t.hash_size,i=e;do n=t.head[--i],t.head[i]=n>=r?n-r:0;while(--e);e=r,i=e;do n=t.prev[--i],t.prev[i]=n>=r?n-r:0;while(--e)};let RUe=(t,e,n)=>(e<<t.hash_shift^n)&t.hash_mask,Ob=RUe;const Bf=t=>{const e=t.state;let n=e.pending;n>t.avail_out&&(n=t.avail_out),n!==0&&(t.output.set(e.pending_buf.subarray(e.pending_out,e.pending_out+n),t.next_out),t.next_out+=n,e.pending_out+=n,t.total_out+=n,t.avail_out-=n,e.pending-=n,e.pending===0&&(e.pending_out=0))},Zf=(t,e)=>{sUe(t,t.block_start>=0?t.block_start:-1,t.strstart-t.block_start,e),t.block_start=t.strstart,Bf(t.strm)},gs=(t,e)=>{t.pending_buf[t.pending++]=e},DR=(t,e)=>{t.pending_buf[t.pending++]=e>>>8&255,t.pending_buf[t.pending++]=e&255},zG=(t,e,n,i)=>{let r=t.avail_in;return r>i&&(r=i),r===0?0:(t.avail_in-=r,e.set(t.input.subarray(t.next_in,t.next_in+r),n),t.state.wrap===1?t.adler=$O(t.adler,e,r,n):t.state.wrap===2&&(t.adler=ol(t.adler,e,r,n)),t.next_in+=r,t.total_in+=r,r)},Dde=(t,e)=>{let n=t.max_chain_length,i=t.strstart,r,s,a=t.prev_length,o=t.nice_match;const c=t.strstart>t.w_size-jg?t.strstart-(t.w_size-jg):0,l=t.window,u=t.w_mask,h=t.prev,f=t.strstart+mb;let d=l[i+a-1],p=l[i+a];t.prev_length>=t.good_match&&(n>>=2),o>t.lookahead&&(o=t.lookahead);do if(r=e,!(l[r+a]!==p||l[r+a-1]!==d||l[r]!==l[i]||l[++r]!==l[i+1])){i+=2,r++;do;while(l[++i]===l[++r]&&l[++i]===l[++r]&&l[++i]===l[++r]&&l[++i]===l[++r]&&l[++i]===l[++r]&&l[++i]===l[++r]&&l[++i]===l[++r]&&l[++i]===l[++r]&&i<f);if(s=mb-(f-i),i=f-mb,s>a){if(t.match_start=e,a=s,s>=o)break;d=l[i+a-1],p=l[i+a]}}while((e=h[e&u])>c&&--n!==0);return a<=t.lookahead?a:t.lookahead},FC=t=>{const e=t.w_size;let n,i,r;do{if(i=t.window_size-t.lookahead-t.strstart,t.strstart>=e+(e-jg)&&(t.window.set(t.window.subarray(e,e+e-i),0),t.match_start-=e,t.strstart-=e,t.block_start-=e,t.insert>t.strstart&&(t.insert=t.strstart),AUe(t),i+=e),t.strm.avail_in===0)break;if(n=zG(t.strm,t.window,t.strstart+t.lookahead,i),t.lookahead+=n,t.lookahead+t.insert>=Lr)for(r=t.strstart-t.insert,t.ins_h=t.window[r],t.ins_h=Ob(t,t.ins_h,t.window[r+1]);t.insert&&(t.ins_h=Ob(t,t.ins_h,t.window[r+Lr-1]),t.prev[r&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=r,r++,t.insert--,!(t.lookahead+t.insert<Lr)););}while(t.lookahead<jg&&t.strm.avail_in!==0)},Pde=(t,e)=>{let n=t.pending_buf_size-5>t.w_size?t.w_size:t.pending_buf_size-5,i,r,s,a=0,o=t.strm.avail_in;do{if(i=65535,s=t.bi_valid+42>>3,t.strm.avail_out<s||(s=t.strm.avail_out-s,r=t.strstart-t.block_start,i>r+t.strm.avail_in&&(i=r+t.strm.avail_in),i>s&&(i=s),i<n&&(i===0&&e!==Jd||e===Mb||i!==r+t.strm.avail_in)))break;a=e===Jd&&i===r+t.strm.avail_in?1:0,DG(t,0,0,a),t.pending_buf[t.pending-4]=i,t.pending_buf[t.pending-3]=i>>8,t.pending_buf[t.pending-2]=~i,t.pending_buf[t.pending-1]=~i>>8,Bf(t.strm),r&&(r>i&&(r=i),t.strm.output.set(t.window.subarray(t.block_start,t.block_start+r),t.strm.next_out),t.strm.next_out+=r,t.strm.avail_out-=r,t.strm.total_out+=r,t.block_start+=r,i-=r),i&&(zG(t.strm,t.strm.output,t.strm.next_out,i),t.strm.next_out+=i,t.strm.avail_out-=i,t.strm.total_out+=i)}while(a===0);return o-=t.strm.avail_in,o&&(o>=t.w_size?(t.matches=2,t.window.set(t.strm.input.subarray(t.strm.next_in-t.w_size,t.strm.next_in),0),t.strstart=t.w_size,t.insert=t.strstart):(t.window_size-t.strstart<=o&&(t.strstart-=t.w_size,t.window.set(t.window.subarray(t.w_size,t.w_size+t.strstart),0),t.matches<2&&t.matches++,t.insert>t.strstart&&(t.insert=t.strstart)),t.window.set(t.strm.input.subarray(t.strm.next_in-o,t.strm.next_in),t.strstart),t.strstart+=o,t.insert+=o>t.w_size-t.insert?t.w_size-t.insert:o),t.block_start=t.strstart),t.high_water<t.strstart&&(t.high_water=t.strstart),a?kA:e!==Mb&&e!==Jd&&t.strm.avail_in===0&&t.strstart===t.block_start?IA:(s=t.window_size-t.strstart,t.strm.avail_in>s&&t.block_start>=t.w_size&&(t.block_start-=t.w_size,t.strstart-=t.w_size,t.window.set(t.window.subarray(t.w_size,t.w_size+t.strstart),0),t.matches<2&&t.matches++,s+=t.w_size,t.insert>t.strstart&&(t.insert=t.strstart)),s>t.strm.avail_in&&(s=t.strm.avail_in),s&&(zG(t.strm,t.window,t.strstart,s),t.strstart+=s,t.insert+=s>t.w_size-t.insert?t.w_size-t.insert:s),t.high_water<t.strstart&&(t.high_water=t.strstart),s=t.bi_valid+42>>3,s=t.pending_buf_size-s>65535?65535:t.pending_buf_size-s,n=s>t.w_size?t.w_size:s,r=t.strstart-t.block_start,(r>=n||(r||e===Jd)&&e!==Mb&&t.strm.avail_in===0&&r<=s)&&(i=r>s?s:r,a=e===Jd&&t.strm.avail_in===0&&i===r?1:0,DG(t,t.block_start,i,a),t.block_start+=i,Bf(t.strm)),a?jT:rh)},d5=(t,e)=>{let n,i;for(;;){if(t.lookahead<jg){if(FC(t),t.lookahead<jg&&e===Mb)return rh;if(t.lookahead===0)break}if(n=0,t.lookahead>=Lr&&(t.ins_h=Ob(t,t.ins_h,t.window[t.strstart+Lr-1]),n=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart),n!==0&&t.strstart-n<=t.w_size-jg&&(t.match_length=Dde(t,n)),t.match_length>=Lr)if(i=Rb(t,t.strstart-t.match_start,t.match_length-Lr),t.lookahead-=t.match_length,t.match_length<=t.max_lazy_match&&t.lookahead>=Lr){t.match_length--;do t.strstart++,t.ins_h=Ob(t,t.ins_h,t.window[t.strstart+Lr-1]),n=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart;while(--t.match_length!==0);t.strstart++}else t.strstart+=t.match_length,t.match_length=0,t.ins_h=t.window[t.strstart],t.ins_h=Ob(t,t.ins_h,t.window[t.strstart+1]);else i=Rb(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++;if(i&&(Zf(t,!1),t.strm.avail_out===0))return rh}return t.insert=t.strstart<Lr-1?t.strstart:Lr-1,e===Jd?(Zf(t,!0),t.strm.avail_out===0?jT:kA):t.sym_next&&(Zf(t,!1),t.strm.avail_out===0)?rh:IA},Ux=(t,e)=>{let n,i,r;for(;;){if(t.lookahead<jg){if(FC(t),t.lookahead<jg&&e===Mb)return rh;if(t.lookahead===0)break}if(n=0,t.lookahead>=Lr&&(t.ins_h=Ob(t,t.ins_h,t.window[t.strstart+Lr-1]),n=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart),t.prev_length=t.match_length,t.prev_match=t.match_start,t.match_length=Lr-1,n!==0&&t.prev_length<t.max_lazy_match&&t.strstart-n<=t.w_size-jg&&(t.match_length=Dde(t,n),t.match_length<=5&&(t.strategy===hUe||t.match_length===Lr&&t.strstart-t.match_start>4096)&&(t.match_length=Lr-1)),t.prev_length>=Lr&&t.match_length<=t.prev_length){r=t.strstart+t.lookahead-Lr,i=Rb(t,t.strstart-1-t.prev_match,t.prev_length-Lr),t.lookahead-=t.prev_length-1,t.prev_length-=2;do++t.strstart<=r&&(t.ins_h=Ob(t,t.ins_h,t.window[t.strstart+Lr-1]),n=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart);while(--t.prev_length!==0);if(t.match_available=0,t.match_length=Lr-1,t.strstart++,i&&(Zf(t,!1),t.strm.avail_out===0))return rh}else if(t.match_available){if(i=Rb(t,0,t.window[t.strstart-1]),i&&Zf(t,!1),t.strstart++,t.lookahead--,t.strm.avail_out===0)return rh}else t.match_available=1,t.strstart++,t.lookahead--}return t.match_available&&(i=Rb(t,0,t.window[t.strstart-1]),t.match_available=0),t.insert=t.strstart<Lr-1?t.strstart:Lr-1,e===Jd?(Zf(t,!0),t.strm.avail_out===0?jT:kA):t.sym_next&&(Zf(t,!1),t.strm.avail_out===0)?rh:IA},MUe=(t,e)=>{let n,i,r,s;const a=t.window;for(;;){if(t.lookahead<=mb){if(FC(t),t.lookahead<=mb&&e===Mb)return rh;if(t.lookahead===0)break}if(t.match_length=0,t.lookahead>=Lr&&t.strstart>0&&(r=t.strstart-1,i=a[r],i===a[++r]&&i===a[++r]&&i===a[++r])){s=t.strstart+mb;do;while(i===a[++r]&&i===a[++r]&&i===a[++r]&&i===a[++r]&&i===a[++r]&&i===a[++r]&&i===a[++r]&&i===a[++r]&&r<s);t.match_length=mb-(s-r),t.match_length>t.lookahead&&(t.match_length=t.lookahead)}if(t.match_length>=Lr?(n=Rb(t,1,t.match_length-Lr),t.lookahead-=t.match_length,t.strstart+=t.match_length,t.match_length=0):(n=Rb(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++),n&&(Zf(t,!1),t.strm.avail_out===0))return rh}return t.insert=0,e===Jd?(Zf(t,!0),t.strm.avail_out===0?jT:kA):t.sym_next&&(Zf(t,!1),t.strm.avail_out===0)?rh:IA},OUe=(t,e)=>{let n;for(;;){if(t.lookahead===0&&(FC(t),t.lookahead===0)){if(e===Mb)return rh;break}if(t.match_length=0,n=Rb(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++,n&&(Zf(t,!1),t.strm.avail_out===0))return rh}return t.insert=0,e===Jd?(Zf(t,!0),t.strm.avail_out===0?jT:kA):t.sym_next&&(Zf(t,!1),t.strm.avail_out===0)?rh:IA};function ug(t,e,n,i,r){this.good_length=t,this.max_lazy=e,this.nice_length=n,this.max_chain=i,this.func=r}const oM=[new ug(0,0,0,0,Pde),new ug(4,4,8,4,d5),new ug(4,5,16,8,d5),new ug(4,6,32,32,d5),new ug(4,4,16,16,Ux),new ug(8,16,32,32,Ux),new ug(8,16,128,128,Ux),new ug(8,32,128,256,Ux),new ug(32,128,258,1024,Ux),new ug(32,258,258,4096,Ux)],NUe=t=>{t.window_size=2*t.w_size,cb(t.head),t.max_lazy_match=oM[t.level].max_lazy,t.good_match=oM[t.level].good_length,t.nice_match=oM[t.level].nice_length,t.max_chain_length=oM[t.level].max_chain,t.strstart=0,t.block_start=0,t.lookahead=0,t.insert=0,t.match_length=t.prev_length=Lr-1,t.match_available=0,t.ins_h=0};function IUe(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=hF,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new Uint16Array(TUe*2),this.dyn_dtree=new Uint16Array((2*EUe+1)*2),this.bl_tree=new Uint16Array((2*SUe+1)*2),cb(this.dyn_ltree),cb(this.dyn_dtree),cb(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new Uint16Array(xUe+1),this.heap=new Uint16Array(2*PG+1),cb(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new Uint16Array(2*PG+1),cb(this.depth),this.sym_buf=0,this.lit_bufsize=0,this.sym_next=0,this.sym_end=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}const OI=t=>{if(!t)return 1;const e=t.state;return!e||e.strm!==t||e.status!==BC&&e.status!==JW&&e.status!==LG&&e.status!==UG&&e.status!==BG&&e.status!==FG&&e.status!==cT&&e.status!==aM?1:0},Lde=t=>{if(OI(t))return lT(t,Hg);t.total_in=t.total_out=0,t.data_type=mUe;const e=t.state;return e.pending=0,e.pending_out=0,e.wrap<0&&(e.wrap=-e.wrap),e.status=e.wrap===2?JW:e.wrap?BC:cT,t.adler=e.wrap===2?0:1,e.last_flush=-2,rUe(e),Pl},Ude=t=>{const e=Lde(t);return e===Pl&&NUe(t.state),e},kUe=(t,e)=>OI(t)||t.state.wrap!==2?Hg:(t.state.gzhead=e,Pl),Bde=(t,e,n,i,r,s)=>{if(!t)return Hg;let a=1;if(e===uUe&&(e=6),i<0?(a=0,i=-i):i>15&&(a=2,i-=16),r<1||r>gUe||n!==hF||i<8||i>15||e<0||e>9||s<0||s>dUe||i===8&&a!==1)return lT(t,Hg);i===8&&(i=9);const o=new IUe;return t.state=o,o.strm=t,o.status=BC,o.wrap=a,o.gzhead=null,o.w_bits=i,o.w_size=1<<o.w_bits,o.w_mask=o.w_size-1,o.hash_bits=r+7,o.hash_size=1<<o.hash_bits,o.hash_mask=o.hash_size-1,o.hash_shift=~~((o.hash_bits+Lr-1)/Lr),o.window=new Uint8Array(o.w_size*2),o.head=new Uint16Array(o.hash_size),o.prev=new Uint16Array(o.w_size),o.lit_bufsize=1<<r+6,o.pending_buf_size=o.lit_bufsize*4,o.pending_buf=new Uint8Array(o.pending_buf_size),o.sym_buf=o.lit_bufsize,o.sym_end=(o.lit_bufsize-1)*3,o.level=e,o.strategy=s,o.method=n,Ude(t)},DUe=(t,e)=>Bde(t,e,hF,vUe,_Ue,pUe),PUe=(t,e)=>{if(OI(t)||e>Iee||e<0)return t?lT(t,Hg):Hg;const n=t.state;if(!t.output||t.avail_in!==0&&!t.input||n.status===aM&&e!==Jd)return lT(t,t.avail_out===0?f5:Hg);const i=n.last_flush;if(n.last_flush=e,n.pending!==0){if(Bf(t),t.avail_out===0)return n.last_flush=-1,Pl}else if(t.avail_in===0&&Dee(e)<=Dee(i)&&e!==Jd)return lT(t,f5);if(n.status===aM&&t.avail_in!==0)return lT(t,f5);if(n.status===BC&&n.wrap===0&&(n.status=cT),n.status===BC){let r=hF+(n.w_bits-8<<4)<<8,s=-1;if(n.strategy>=eP||n.level<2?s=0:n.level<6?s=1:n.level===6?s=2:s=3,r|=s<<6,n.strstart!==0&&(r|=wUe),r+=31-r%31,DR(n,r),n.strstart!==0&&(DR(n,t.adler>>>16),DR(n,t.adler&65535)),t.adler=1,n.status=cT,Bf(t),n.pending!==0)return n.last_flush=-1,Pl}if(n.status===JW){if(t.adler=0,gs(n,31),gs(n,139),gs(n,8),n.gzhead)gs(n,(n.gzhead.text?1:0)+(n.gzhead.hcrc?2:0)+(n.gzhead.extra?4:0)+(n.gzhead.name?8:0)+(n.gzhead.comment?16:0)),gs(n,n.gzhead.time&255),gs(n,n.gzhead.time>>8&255),gs(n,n.gzhead.time>>16&255),gs(n,n.gzhead.time>>24&255),gs(n,n.level===9?2:n.strategy>=eP||n.level<2?4:0),gs(n,n.gzhead.os&255),n.gzhead.extra&&n.gzhead.extra.length&&(gs(n,n.gzhead.extra.length&255),gs(n,n.gzhead.extra.length>>8&255)),n.gzhead.hcrc&&(t.adler=ol(t.adler,n.pending_buf,n.pending,0)),n.gzindex=0,n.status=LG;else if(gs(n,0),gs(n,0),gs(n,0),gs(n,0),gs(n,0),gs(n,n.level===9?2:n.strategy>=eP||n.level<2?4:0),gs(n,CUe),n.status=cT,Bf(t),n.pending!==0)return n.last_flush=-1,Pl}if(n.status===LG){if(n.gzhead.extra){let r=n.pending,s=(n.gzhead.extra.length&65535)-n.gzindex;for(;n.pending+s>n.pending_buf_size;){let o=n.pending_buf_size-n.pending;if(n.pending_buf.set(n.gzhead.extra.subarray(n.gzindex,n.gzindex+o),n.pending),n.pending=n.pending_buf_size,n.gzhead.hcrc&&n.pending>r&&(t.adler=ol(t.adler,n.pending_buf,n.pending-r,r)),n.gzindex+=o,Bf(t),n.pending!==0)return n.last_flush=-1,Pl;r=0,s-=o}let a=new Uint8Array(n.gzhead.extra);n.pending_buf.set(a.subarray(n.gzindex,n.gzindex+s),n.pending),n.pending+=s,n.gzhead.hcrc&&n.pending>r&&(t.adler=ol(t.adler,n.pending_buf,n.pending-r,r)),n.gzindex=0}n.status=UG}if(n.status===UG){if(n.gzhead.name){let r=n.pending,s;do{if(n.pending===n.pending_buf_size){if(n.gzhead.hcrc&&n.pending>r&&(t.adler=ol(t.adler,n.pending_buf,n.pending-r,r)),Bf(t),n.pending!==0)return n.last_flush=-1,Pl;r=0}n.gzindex<n.gzhead.name.length?s=n.gzhead.name.charCodeAt(n.gzindex++)&255:s=0,gs(n,s)}while(s!==0);n.gzhead.hcrc&&n.pending>r&&(t.adler=ol(t.adler,n.pending_buf,n.pending-r,r)),n.gzindex=0}n.status=BG}if(n.status===BG){if(n.gzhead.comment){let r=n.pending,s;do{if(n.pending===n.pending_buf_size){if(n.gzhead.hcrc&&n.pending>r&&(t.adler=ol(t.adler,n.pending_buf,n.pending-r,r)),Bf(t),n.pending!==0)return n.last_flush=-1,Pl;r=0}n.gzindex<n.gzhead.comment.length?s=n.gzhead.comment.charCodeAt(n.gzindex++)&255:s=0,gs(n,s)}while(s!==0);n.gzhead.hcrc&&n.pending>r&&(t.adler=ol(t.adler,n.pending_buf,n.pending-r,r))}n.status=FG}if(n.status===FG){if(n.gzhead.hcrc){if(n.pending+2>n.pending_buf_size&&(Bf(t),n.pending!==0))return n.last_flush=-1,Pl;gs(n,t.adler&255),gs(n,t.adler>>8&255),t.adler=0}if(n.status=cT,Bf(t),n.pending!==0)return n.last_flush=-1,Pl}if(t.avail_in!==0||n.lookahead!==0||e!==Mb&&n.status!==aM){let r=n.level===0?Pde(n,e):n.strategy===eP?OUe(n,e):n.strategy===fUe?MUe(n,e):oM[n.level].func(n,e);if((r===jT||r===kA)&&(n.status=aM),r===rh||r===jT)return t.avail_out===0&&(n.last_flush=-1),Pl;if(r===IA&&(e===oUe?aUe(n):e!==Iee&&(DG(n,0,0,!1),e===cUe&&(cb(n.head),n.lookahead===0&&(n.strstart=0,n.block_start=0,n.insert=0))),Bf(t),t.avail_out===0))return n.last_flush=-1,Pl}return e!==Jd?Pl:n.wrap<=0?kee:(n.wrap===2?(gs(n,t.adler&255),gs(n,t.adler>>8&255),gs(n,t.adler>>16&255),gs(n,t.adler>>24&255),gs(n,t.total_in&255),gs(n,t.total_in>>8&255),gs(n,t.total_in>>16&255),gs(n,t.total_in>>24&255)):(DR(n,t.adler>>>16),DR(n,t.adler&65535)),Bf(t),n.wrap>0&&(n.wrap=-n.wrap),n.pending!==0?Pl:kee)},LUe=t=>{if(OI(t))return Hg;const e=t.state.status;return t.state=null,e===cT?lT(t,lUe):Pl},UUe=(t,e)=>{let n=e.length;if(OI(t))return Hg;const i=t.state,r=i.wrap;if(r===2||r===1&&i.status!==BC||i.lookahead)return Hg;if(r===1&&(t.adler=$O(t.adler,e,n,0)),i.wrap=0,n>=i.w_size){r===0&&(cb(i.head),i.strstart=0,i.block_start=0,i.insert=0);let c=new Uint8Array(i.w_size);c.set(e.subarray(n-i.w_size,n),0),e=c,n=i.w_size}const s=t.avail_in,a=t.next_in,o=t.input;for(t.avail_in=n,t.next_in=0,t.input=e,FC(i);i.lookahead>=Lr;){let c=i.strstart,l=i.lookahead-(Lr-1);do i.ins_h=Ob(i,i.ins_h,i.window[c+Lr-1]),i.prev[c&i.w_mask]=i.head[i.ins_h],i.head[i.ins_h]=c,c++;while(--l);i.strstart=c,i.lookahead=Lr-1,FC(i)}return i.strstart+=i.lookahead,i.block_start=i.strstart,i.insert=i.lookahead,i.lookahead=0,i.match_length=i.prev_length=Lr-1,i.match_available=0,t.next_in=a,t.input=o,t.avail_in=s,i.wrap=r,Pl};var BUe=DUe,FUe=Bde,zUe=Ude,HUe=Lde,jUe=kUe,VUe=PUe,GUe=LUe,qUe=UUe,$Ue="pako deflate (from Nodeca project)",GM={deflateInit:BUe,deflateInit2:FUe,deflateReset:zUe,deflateResetKeep:HUe,deflateSetHeader:jUe,deflate:VUe,deflateEnd:GUe,deflateSetDictionary:qUe,deflateInfo:$Ue};const WUe=(t,e)=>Object.prototype.hasOwnProperty.call(t,e);var YUe=function(t){const e=Array.prototype.slice.call(arguments,1);for(;e.length;){const n=e.shift();if(n){if(typeof n!="object")throw new TypeError(n+"must be non-object");for(const i in n)WUe(n,i)&&(t[i]=n[i])}}return t},XUe=t=>{let e=0;for(let i=0,r=t.length;i<r;i++)e+=t[i].length;const n=new Uint8Array(e);for(let i=0,r=0,s=t.length;i<s;i++){let a=t[i];n.set(a,r),r+=a.length}return n},fF={assign:YUe,flattenChunks:XUe};let Fde=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{Fde=!1}const WO=new Uint8Array(256);for(let t=0;t<256;t++)WO[t]=t>=252?6:t>=248?5:t>=240?4:t>=224?3:t>=192?2:1;WO[254]=WO[254]=1;var KUe=t=>{if(typeof TextEncoder=="function"&&TextEncoder.prototype.encode)return new TextEncoder().encode(t);let e,n,i,r,s,a=t.length,o=0;for(r=0;r<a;r++)n=t.charCodeAt(r),(n&64512)===55296&&r+1<a&&(i=t.charCodeAt(r+1),(i&64512)===56320&&(n=65536+(n-55296<<10)+(i-56320),r++)),o+=n<128?1:n<2048?2:n<65536?3:4;for(e=new Uint8Array(o),s=0,r=0;s<o;r++)n=t.charCodeAt(r),(n&64512)===55296&&r+1<a&&(i=t.charCodeAt(r+1),(i&64512)===56320&&(n=65536+(n-55296<<10)+(i-56320),r++)),n<128?e[s++]=n:n<2048?(e[s++]=192|n>>>6,e[s++]=128|n&63):n<65536?(e[s++]=224|n>>>12,e[s++]=128|n>>>6&63,e[s++]=128|n&63):(e[s++]=240|n>>>18,e[s++]=128|n>>>12&63,e[s++]=128|n>>>6&63,e[s++]=128|n&63);return e};const ZUe=(t,e)=>{if(e<65534&&t.subarray&&Fde)return String.fromCharCode.apply(null,t.length===e?t:t.subarray(0,e));let n="";for(let i=0;i<e;i++)n+=String.fromCharCode(t[i]);return n};var JUe=(t,e)=>{const n=e||t.length;if(typeof TextDecoder=="function"&&TextDecoder.prototype.decode)return new TextDecoder().decode(t.subarray(0,e));let i,r;const s=new Array(n*2);for(r=0,i=0;i<n;){let a=t[i++];if(a<128){s[r++]=a;continue}let o=WO[a];if(o>4){s[r++]=65533,i+=o-1;continue}for(a&=o===2?31:o===3?15:7;o>1&&i<n;)a=a<<6|t[i++]&63,o--;if(o>1){s[r++]=65533;continue}a<65536?s[r++]=a:(a-=65536,s[r++]=55296|a>>10&1023,s[r++]=56320|a&1023)}return ZUe(s,r)},QUe=(t,e)=>{e=e||t.length,e>t.length&&(e=t.length);let n=e-1;for(;n>=0&&(t[n]&192)===128;)n--;return n<0||n===0?e:n+WO[t[n]]>e?n:e},YO={string2buf:KUe,buf2string:JUe,utf8border:QUe};function e3e(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}var zde=e3e;const Hde=Object.prototype.toString,{Z_NO_FLUSH:t3e,Z_SYNC_FLUSH:n3e,Z_FULL_FLUSH:i3e,Z_FINISH:r3e,Z_OK:kU,Z_STREAM_END:s3e,Z_DEFAULT_COMPRESSION:a3e,Z_DEFAULT_STRATEGY:o3e,Z_DEFLATED:c3e}=b1;function NI(t){this.options=fF.assign({level:a3e,method:c3e,chunkSize:16384,windowBits:15,memLevel:8,strategy:o3e},t||{});let e=this.options;e.raw&&e.windowBits>0?e.windowBits=-e.windowBits:e.gzip&&e.windowBits>0&&e.windowBits<16&&(e.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new zde,this.strm.avail_out=0;let n=GM.deflateInit2(this.strm,e.level,e.method,e.windowBits,e.memLevel,e.strategy);if(n!==kU)throw new Error(HT[n]);if(e.header&&GM.deflateSetHeader(this.strm,e.header),e.dictionary){let i;if(typeof e.dictionary=="string"?i=YO.string2buf(e.dictionary):Hde.call(e.dictionary)==="[object ArrayBuffer]"?i=new Uint8Array(e.dictionary):i=e.dictionary,n=GM.deflateSetDictionary(this.strm,i),n!==kU)throw new Error(HT[n]);this._dict_set=!0}}NI.prototype.push=function(t,e){const n=this.strm,i=this.options.chunkSize;let r,s;if(this.ended)return!1;for(e===~~e?s=e:s=e===!0?r3e:t3e,typeof t=="string"?n.input=YO.string2buf(t):Hde.call(t)==="[object ArrayBuffer]"?n.input=new Uint8Array(t):n.input=t,n.next_in=0,n.avail_in=n.input.length;;){if(n.avail_out===0&&(n.output=new Uint8Array(i),n.next_out=0,n.avail_out=i),(s===n3e||s===i3e)&&n.avail_out<=6){this.onData(n.output.subarray(0,n.next_out)),n.avail_out=0;continue}if(r=GM.deflate(n,s),r===s3e)return n.next_out>0&&this.onData(n.output.subarray(0,n.next_out)),r=GM.deflateEnd(this.strm),this.onEnd(r),this.ended=!0,r===kU;if(n.avail_out===0){this.onData(n.output);continue}if(s>0&&n.next_out>0){this.onData(n.output.subarray(0,n.next_out)),n.avail_out=0;continue}if(n.avail_in===0)break}return!0};NI.prototype.onData=function(t){this.chunks.push(t)};NI.prototype.onEnd=function(t){t===kU&&(this.result=fF.flattenChunks(this.chunks)),this.chunks=[],this.err=t,this.msg=this.strm.msg};function QW(t,e){const n=new NI(e);if(n.push(t,!0),n.err)throw n.msg||HT[n.err];return n.result}function l3e(t,e){return e=e||{},e.raw=!0,QW(t,e)}function u3e(t,e){return e=e||{},e.gzip=!0,QW(t,e)}var h3e=NI,f3e=QW,d3e=l3e,p3e=u3e,m3e=b1,g3e={Deflate:h3e,deflate:f3e,deflateRaw:d3e,gzip:p3e,constants:m3e};const tP=16209,v3e=16191;var _3e=function(e,n){let i,r,s,a,o,c,l,u,h,f,d,p,g,y,v,b,T,x,M,R,I,k,P,U;const G=e.state;i=e.next_in,P=e.input,r=i+(e.avail_in-5),s=e.next_out,U=e.output,a=s-(n-e.avail_out),o=s+(e.avail_out-257),c=G.dmax,l=G.wsize,u=G.whave,h=G.wnext,f=G.window,d=G.hold,p=G.bits,g=G.lencode,y=G.distcode,v=(1<<G.lenbits)-1,b=(1<<G.distbits)-1;e:do{p<15&&(d+=P[i++]<<p,p+=8,d+=P[i++]<<p,p+=8),T=g[d&v];t:for(;;){if(x=T>>>24,d>>>=x,p-=x,x=T>>>16&255,x===0)U[s++]=T&65535;else if(x&16){M=T&65535,x&=15,x&&(p<x&&(d+=P[i++]<<p,p+=8),M+=d&(1<<x)-1,d>>>=x,p-=x),p<15&&(d+=P[i++]<<p,p+=8,d+=P[i++]<<p,p+=8),T=y[d&b];n:for(;;){if(x=T>>>24,d>>>=x,p-=x,x=T>>>16&255,x&16){if(R=T&65535,x&=15,p<x&&(d+=P[i++]<<p,p+=8,p<x&&(d+=P[i++]<<p,p+=8)),R+=d&(1<<x)-1,R>c){e.msg="invalid distance too far back",G.mode=tP;break e}if(d>>>=x,p-=x,x=s-a,R>x){if(x=R-x,x>u&&G.sane){e.msg="invalid distance too far back",G.mode=tP;break e}if(I=0,k=f,h===0){if(I+=l-x,x<M){M-=x;do U[s++]=f[I++];while(--x);I=s-R,k=U}}else if(h<x){if(I+=l+h-x,x-=h,x<M){M-=x;do U[s++]=f[I++];while(--x);if(I=0,h<M){x=h,M-=x;do U[s++]=f[I++];while(--x);I=s-R,k=U}}}else if(I+=h-x,x<M){M-=x;do U[s++]=f[I++];while(--x);I=s-R,k=U}for(;M>2;)U[s++]=k[I++],U[s++]=k[I++],U[s++]=k[I++],M-=3;M&&(U[s++]=k[I++],M>1&&(U[s++]=k[I++]))}else{I=s-R;do U[s++]=U[I++],U[s++]=U[I++],U[s++]=U[I++],M-=3;while(M>2);M&&(U[s++]=U[I++],M>1&&(U[s++]=U[I++]))}}else if(x&64){e.msg="invalid distance code",G.mode=tP;break e}else{T=y[(T&65535)+(d&(1<<x)-1)];continue n}break}}else if(x&64)if(x&32){G.mode=v3e;break e}else{e.msg="invalid literal/length code",G.mode=tP;break e}else{T=g[(T&65535)+(d&(1<<x)-1)];continue t}break}}while(i<r&&s<o);M=p>>3,i-=M,p-=M<<3,d&=(1<<p)-1,e.next_in=i,e.next_out=s,e.avail_in=i<r?5+(r-i):5-(i-r),e.avail_out=s<o?257+(o-s):257-(s-o),G.hold=d,G.bits=p};const Bx=15,Pee=852,Lee=592,Uee=0,p5=1,Bee=2,y3e=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),b3e=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),E3e=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),S3e=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]),T3e=(t,e,n,i,r,s,a,o)=>{const c=o.bits;let l=0,u=0,h=0,f=0,d=0,p=0,g=0,y=0,v=0,b=0,T,x,M,R,I,k=null,P;const U=new Uint16Array(Bx+1),G=new Uint16Array(Bx+1);let $=null,q,Y,ie;for(l=0;l<=Bx;l++)U[l]=0;for(u=0;u<i;u++)U[e[n+u]]++;for(d=c,f=Bx;f>=1&&U[f]===0;f--);if(d>f&&(d=f),f===0)return r[s++]=1<<24|64<<16|0,r[s++]=1<<24|64<<16|0,o.bits=1,0;for(h=1;h<f&&U[h]===0;h++);for(d<h&&(d=h),y=1,l=1;l<=Bx;l++)if(y<<=1,y-=U[l],y<0)return-1;if(y>0&&(t===Uee||f!==1))return-1;for(G[1]=0,l=1;l<Bx;l++)G[l+1]=G[l]+U[l];for(u=0;u<i;u++)e[n+u]!==0&&(a[G[e[n+u]]++]=u);if(t===Uee?(k=$=a,P=20):t===p5?(k=y3e,$=b3e,P=257):(k=E3e,$=S3e,P=0),b=0,u=0,l=h,I=s,p=d,g=0,M=-1,v=1<<d,R=v-1,t===p5&&v>Pee||t===Bee&&v>Lee)return 1;for(;;){q=l-g,a[u]+1<P?(Y=0,ie=a[u]):a[u]>=P?(Y=$[a[u]-P],ie=k[a[u]-P]):(Y=96,ie=0),T=1<<l-g,x=1<<p,h=x;do x-=T,r[I+(b>>g)+x]=q<<24|Y<<16|ie|0;while(x!==0);for(T=1<<l-1;b&T;)T>>=1;if(T!==0?(b&=T-1,b+=T):b=0,u++,--U[l]===0){if(l===f)break;l=e[n+a[u]]}if(l>d&&(b&R)!==M){for(g===0&&(g=d),I+=h,p=l-g,y=1<<p;p+g<f&&(y-=U[p+g],!(y<=0));)p++,y<<=1;if(v+=1<<p,t===p5&&v>Pee||t===Bee&&v>Lee)return 1;M=b&R,r[M]=d<<24|p<<16|I-s|0}}return b!==0&&(r[I+b]=l-g<<24|64<<16|0),o.bits=d,0};var qM=T3e;const x3e=0,jde=1,Vde=2,{Z_FINISH:Fee,Z_BLOCK:w3e,Z_TREES:nP,Z_OK:VT,Z_STREAM_END:C3e,Z_NEED_DICT:A3e,Z_STREAM_ERROR:gp,Z_DATA_ERROR:Gde,Z_MEM_ERROR:qde,Z_BUF_ERROR:R3e,Z_DEFLATED:zee}=b1,dF=16180,Hee=16181,jee=16182,Vee=16183,Gee=16184,qee=16185,$ee=16186,Wee=16187,Yee=16188,Xee=16189,DU=16190,Rv=16191,m5=16192,Kee=16193,g5=16194,Zee=16195,Jee=16196,Qee=16197,ete=16198,iP=16199,rP=16200,tte=16201,nte=16202,ite=16203,rte=16204,ste=16205,v5=16206,ate=16207,ote=16208,Na=16209,$de=16210,Wde=16211,M3e=852,O3e=592,N3e=15,I3e=N3e,cte=t=>(t>>>24&255)+(t>>>8&65280)+((t&65280)<<8)+((t&255)<<24);function k3e(){this.strm=null,this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}const E1=t=>{if(!t)return 1;const e=t.state;return!e||e.strm!==t||e.mode<dF||e.mode>Wde?1:0},Yde=t=>{if(E1(t))return gp;const e=t.state;return t.total_in=t.total_out=e.total=0,t.msg="",e.wrap&&(t.adler=e.wrap&1),e.mode=dF,e.last=0,e.havedict=0,e.flags=-1,e.dmax=32768,e.head=null,e.hold=0,e.bits=0,e.lencode=e.lendyn=new Int32Array(M3e),e.distcode=e.distdyn=new Int32Array(O3e),e.sane=1,e.back=-1,VT},Xde=t=>{if(E1(t))return gp;const e=t.state;return e.wsize=0,e.whave=0,e.wnext=0,Yde(t)},Kde=(t,e)=>{let n;if(E1(t))return gp;const i=t.state;return e<0?(n=0,e=-e):(n=(e>>4)+5,e<48&&(e&=15)),e&&(e<8||e>15)?gp:(i.window!==null&&i.wbits!==e&&(i.window=null),i.wrap=n,i.wbits=e,Xde(t))},Zde=(t,e)=>{if(!t)return gp;const n=new k3e;t.state=n,n.strm=t,n.window=null,n.mode=dF;const i=Kde(t,e);return i!==VT&&(t.state=null),i},D3e=t=>Zde(t,I3e);let lte=!0,_5,y5;const P3e=t=>{if(lte){_5=new Int32Array(512),y5=new Int32Array(32);let e=0;for(;e<144;)t.lens[e++]=8;for(;e<256;)t.lens[e++]=9;for(;e<280;)t.lens[e++]=7;for(;e<288;)t.lens[e++]=8;for(qM(jde,t.lens,0,288,_5,0,t.work,{bits:9}),e=0;e<32;)t.lens[e++]=5;qM(Vde,t.lens,0,32,y5,0,t.work,{bits:5}),lte=!1}t.lencode=_5,t.lenbits=9,t.distcode=y5,t.distbits=5},Jde=(t,e,n,i)=>{let r;const s=t.state;return s.window===null&&(s.wsize=1<<s.wbits,s.wnext=0,s.whave=0,s.window=new Uint8Array(s.wsize)),i>=s.wsize?(s.window.set(e.subarray(n-s.wsize,n),0),s.wnext=0,s.whave=s.wsize):(r=s.wsize-s.wnext,r>i&&(r=i),s.window.set(e.subarray(n-i,n-i+r),s.wnext),i-=r,i?(s.window.set(e.subarray(n-i,n),0),s.wnext=i,s.whave=s.wsize):(s.wnext+=r,s.wnext===s.wsize&&(s.wnext=0),s.whave<s.wsize&&(s.whave+=r))),0},L3e=(t,e)=>{let n,i,r,s,a,o,c,l,u,h,f,d,p,g,y=0,v,b,T,x,M,R,I,k;const P=new Uint8Array(4);let U,G;const $=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(E1(t)||!t.output||!t.input&&t.avail_in!==0)return gp;n=t.state,n.mode===Rv&&(n.mode=m5),a=t.next_out,r=t.output,c=t.avail_out,s=t.next_in,i=t.input,o=t.avail_in,l=n.hold,u=n.bits,h=o,f=c,k=VT;e:for(;;)switch(n.mode){case dF:if(n.wrap===0){n.mode=m5;break}for(;u<16;){if(o===0)break e;o--,l+=i[s++]<<u,u+=8}if(n.wrap&2&&l===35615){n.wbits===0&&(n.wbits=15),n.check=0,P[0]=l&255,P[1]=l>>>8&255,n.check=ol(n.check,P,2,0),l=0,u=0,n.mode=Hee;break}if(n.head&&(n.head.done=!1),!(n.wrap&1)||(((l&255)<<8)+(l>>8))%31){t.msg="incorrect header check",n.mode=Na;break}if((l&15)!==zee){t.msg="unknown compression method",n.mode=Na;break}if(l>>>=4,u-=4,I=(l&15)+8,n.wbits===0&&(n.wbits=I),I>15||I>n.wbits){t.msg="invalid window size",n.mode=Na;break}n.dmax=1<<n.wbits,n.flags=0,t.adler=n.check=1,n.mode=l&512?Xee:Rv,l=0,u=0;break;case Hee:for(;u<16;){if(o===0)break e;o--,l+=i[s++]<<u,u+=8}if(n.flags=l,(n.flags&255)!==zee){t.msg="unknown compression method",n.mode=Na;break}if(n.flags&57344){t.msg="unknown header flags set",n.mode=Na;break}n.head&&(n.head.text=l>>8&1),n.flags&512&&n.wrap&4&&(P[0]=l&255,P[1]=l>>>8&255,n.check=ol(n.check,P,2,0)),l=0,u=0,n.mode=jee;case jee:for(;u<32;){if(o===0)break e;o--,l+=i[s++]<<u,u+=8}n.head&&(n.head.time=l),n.flags&512&&n.wrap&4&&(P[0]=l&255,P[1]=l>>>8&255,P[2]=l>>>16&255,P[3]=l>>>24&255,n.check=ol(n.check,P,4,0)),l=0,u=0,n.mode=Vee;case Vee:for(;u<16;){if(o===0)break e;o--,l+=i[s++]<<u,u+=8}n.head&&(n.head.xflags=l&255,n.head.os=l>>8),n.flags&512&&n.wrap&4&&(P[0]=l&255,P[1]=l>>>8&255,n.check=ol(n.check,P,2,0)),l=0,u=0,n.mode=Gee;case Gee:if(n.flags&1024){for(;u<16;){if(o===0)break e;o--,l+=i[s++]<<u,u+=8}n.length=l,n.head&&(n.head.extra_len=l),n.flags&512&&n.wrap&4&&(P[0]=l&255,P[1]=l>>>8&255,n.check=ol(n.check,P,2,0)),l=0,u=0}else n.head&&(n.head.extra=null);n.mode=qee;case qee:if(n.flags&1024&&(d=n.length,d>o&&(d=o),d&&(n.head&&(I=n.head.extra_len-n.length,n.head.extra||(n.head.extra=new Uint8Array(n.head.extra_len)),n.head.extra.set(i.subarray(s,s+d),I)),n.flags&512&&n.wrap&4&&(n.check=ol(n.check,i,d,s)),o-=d,s+=d,n.length-=d),n.length))break e;n.length=0,n.mode=$ee;case $ee:if(n.flags&2048){if(o===0)break e;d=0;do I=i[s+d++],n.head&&I&&n.length<65536&&(n.head.name+=String.fromCharCode(I));while(I&&d<o);if(n.flags&512&&n.wrap&4&&(n.check=ol(n.check,i,d,s)),o-=d,s+=d,I)break e}else n.head&&(n.head.name=null);n.length=0,n.mode=Wee;case Wee:if(n.flags&4096){if(o===0)break e;d=0;do I=i[s+d++],n.head&&I&&n.length<65536&&(n.head.comment+=String.fromCharCode(I));while(I&&d<o);if(n.flags&512&&n.wrap&4&&(n.check=ol(n.check,i,d,s)),o-=d,s+=d,I)break e}else n.head&&(n.head.comment=null);n.mode=Yee;case Yee:if(n.flags&512){for(;u<16;){if(o===0)break e;o--,l+=i[s++]<<u,u+=8}if(n.wrap&4&&l!==(n.check&65535)){t.msg="header crc mismatch",n.mode=Na;break}l=0,u=0}n.head&&(n.head.hcrc=n.flags>>9&1,n.head.done=!0),t.adler=n.check=0,n.mode=Rv;break;case Xee:for(;u<32;){if(o===0)break e;o--,l+=i[s++]<<u,u+=8}t.adler=n.check=cte(l),l=0,u=0,n.mode=DU;case DU:if(n.havedict===0)return t.next_out=a,t.avail_out=c,t.next_in=s,t.avail_in=o,n.hold=l,n.bits=u,A3e;t.adler=n.check=1,n.mode=Rv;case Rv:if(e===w3e||e===nP)break e;case m5:if(n.last){l>>>=u&7,u-=u&7,n.mode=v5;break}for(;u<3;){if(o===0)break e;o--,l+=i[s++]<<u,u+=8}switch(n.last=l&1,l>>>=1,u-=1,l&3){case 0:n.mode=Kee;break;case 1:if(P3e(n),n.mode=iP,e===nP){l>>>=2,u-=2;break e}break;case 2:n.mode=Jee;break;case 3:t.msg="invalid block type",n.mode=Na}l>>>=2,u-=2;break;case Kee:for(l>>>=u&7,u-=u&7;u<32;){if(o===0)break e;o--,l+=i[s++]<<u,u+=8}if((l&65535)!==(l>>>16^65535)){t.msg="invalid stored block lengths",n.mode=Na;break}if(n.length=l&65535,l=0,u=0,n.mode=g5,e===nP)break e;case g5:n.mode=Zee;case Zee:if(d=n.length,d){if(d>o&&(d=o),d>c&&(d=c),d===0)break e;r.set(i.subarray(s,s+d),a),o-=d,s+=d,c-=d,a+=d,n.length-=d;break}n.mode=Rv;break;case Jee:for(;u<14;){if(o===0)break e;o--,l+=i[s++]<<u,u+=8}if(n.nlen=(l&31)+257,l>>>=5,u-=5,n.ndist=(l&31)+1,l>>>=5,u-=5,n.ncode=(l&15)+4,l>>>=4,u-=4,n.nlen>286||n.ndist>30){t.msg="too many length or distance symbols",n.mode=Na;break}n.have=0,n.mode=Qee;case Qee:for(;n.have<n.ncode;){for(;u<3;){if(o===0)break e;o--,l+=i[s++]<<u,u+=8}n.lens[$[n.have++]]=l&7,l>>>=3,u-=3}for(;n.have<19;)n.lens[$[n.have++]]=0;if(n.lencode=n.lendyn,n.lenbits=7,U={bits:n.lenbits},k=qM(x3e,n.lens,0,19,n.lencode,0,n.work,U),n.lenbits=U.bits,k){t.msg="invalid code lengths set",n.mode=Na;break}n.have=0,n.mode=ete;case ete:for(;n.have<n.nlen+n.ndist;){for(;y=n.lencode[l&(1<<n.lenbits)-1],v=y>>>24,b=y>>>16&255,T=y&65535,!(v<=u);){if(o===0)break e;o--,l+=i[s++]<<u,u+=8}if(T<16)l>>>=v,u-=v,n.lens[n.have++]=T;else{if(T===16){for(G=v+2;u<G;){if(o===0)break e;o--,l+=i[s++]<<u,u+=8}if(l>>>=v,u-=v,n.have===0){t.msg="invalid bit length repeat",n.mode=Na;break}I=n.lens[n.have-1],d=3+(l&3),l>>>=2,u-=2}else if(T===17){for(G=v+3;u<G;){if(o===0)break e;o--,l+=i[s++]<<u,u+=8}l>>>=v,u-=v,I=0,d=3+(l&7),l>>>=3,u-=3}else{for(G=v+7;u<G;){if(o===0)break e;o--,l+=i[s++]<<u,u+=8}l>>>=v,u-=v,I=0,d=11+(l&127),l>>>=7,u-=7}if(n.have+d>n.nlen+n.ndist){t.msg="invalid bit length repeat",n.mode=Na;break}for(;d--;)n.lens[n.have++]=I}}if(n.mode===Na)break;if(n.lens[256]===0){t.msg="invalid code -- missing end-of-block",n.mode=Na;break}if(n.lenbits=9,U={bits:n.lenbits},k=qM(jde,n.lens,0,n.nlen,n.lencode,0,n.work,U),n.lenbits=U.bits,k){t.msg="invalid literal/lengths set",n.mode=Na;break}if(n.distbits=6,n.distcode=n.distdyn,U={bits:n.distbits},k=qM(Vde,n.lens,n.nlen,n.ndist,n.distcode,0,n.work,U),n.distbits=U.bits,k){t.msg="invalid distances set",n.mode=Na;break}if(n.mode=iP,e===nP)break e;case iP:n.mode=rP;case rP:if(o>=6&&c>=258){t.next_out=a,t.avail_out=c,t.next_in=s,t.avail_in=o,n.hold=l,n.bits=u,_3e(t,f),a=t.next_out,r=t.output,c=t.avail_out,s=t.next_in,i=t.input,o=t.avail_in,l=n.hold,u=n.bits,n.mode===Rv&&(n.back=-1);break}for(n.back=0;y=n.lencode[l&(1<<n.lenbits)-1],v=y>>>24,b=y>>>16&255,T=y&65535,!(v<=u);){if(o===0)break e;o--,l+=i[s++]<<u,u+=8}if(b&&!(b&240)){for(x=v,M=b,R=T;y=n.lencode[R+((l&(1<<x+M)-1)>>x)],v=y>>>24,b=y>>>16&255,T=y&65535,!(x+v<=u);){if(o===0)break e;o--,l+=i[s++]<<u,u+=8}l>>>=x,u-=x,n.back+=x}if(l>>>=v,u-=v,n.back+=v,n.length=T,b===0){n.mode=ste;break}if(b&32){n.back=-1,n.mode=Rv;break}if(b&64){t.msg="invalid literal/length code",n.mode=Na;break}n.extra=b&15,n.mode=tte;case tte:if(n.extra){for(G=n.extra;u<G;){if(o===0)break e;o--,l+=i[s++]<<u,u+=8}n.length+=l&(1<<n.extra)-1,l>>>=n.extra,u-=n.extra,n.back+=n.extra}n.was=n.length,n.mode=nte;case nte:for(;y=n.distcode[l&(1<<n.distbits)-1],v=y>>>24,b=y>>>16&255,T=y&65535,!(v<=u);){if(o===0)break e;o--,l+=i[s++]<<u,u+=8}if(!(b&240)){for(x=v,M=b,R=T;y=n.distcode[R+((l&(1<<x+M)-1)>>x)],v=y>>>24,b=y>>>16&255,T=y&65535,!(x+v<=u);){if(o===0)break e;o--,l+=i[s++]<<u,u+=8}l>>>=x,u-=x,n.back+=x}if(l>>>=v,u-=v,n.back+=v,b&64){t.msg="invalid distance code",n.mode=Na;break}n.offset=T,n.extra=b&15,n.mode=ite;case ite:if(n.extra){for(G=n.extra;u<G;){if(o===0)break e;o--,l+=i[s++]<<u,u+=8}n.offset+=l&(1<<n.extra)-1,l>>>=n.extra,u-=n.extra,n.back+=n.extra}if(n.offset>n.dmax){t.msg="invalid distance too far back",n.mode=Na;break}n.mode=rte;case rte:if(c===0)break e;if(d=f-c,n.offset>d){if(d=n.offset-d,d>n.whave&&n.sane){t.msg="invalid distance too far back",n.mode=Na;break}d>n.wnext?(d-=n.wnext,p=n.wsize-d):p=n.wnext-d,d>n.length&&(d=n.length),g=n.window}else g=r,p=a-n.offset,d=n.length;d>c&&(d=c),c-=d,n.length-=d;do r[a++]=g[p++];while(--d);n.length===0&&(n.mode=rP);break;case ste:if(c===0)break e;r[a++]=n.length,c--,n.mode=rP;break;case v5:if(n.wrap){for(;u<32;){if(o===0)break e;o--,l|=i[s++]<<u,u+=8}if(f-=c,t.total_out+=f,n.total+=f,n.wrap&4&&f&&(t.adler=n.check=n.flags?ol(n.check,r,f,a-f):$O(n.check,r,f,a-f)),f=c,n.wrap&4&&(n.flags?l:cte(l))!==n.check){t.msg="incorrect data check",n.mode=Na;break}l=0,u=0}n.mode=ate;case ate:if(n.wrap&&n.flags){for(;u<32;){if(o===0)break e;o--,l+=i[s++]<<u,u+=8}if(n.wrap&4&&l!==(n.total&4294967295)){t.msg="incorrect length check",n.mode=Na;break}l=0,u=0}n.mode=ote;case ote:k=C3e;break e;case Na:k=Gde;break e;case $de:return qde;case Wde:default:return gp}return t.next_out=a,t.avail_out=c,t.next_in=s,t.avail_in=o,n.hold=l,n.bits=u,(n.wsize||f!==t.avail_out&&n.mode<Na&&(n.mode<v5||e!==Fee))&&Jde(t,t.output,t.next_out,f-t.avail_out),h-=t.avail_in,f-=t.avail_out,t.total_in+=h,t.total_out+=f,n.total+=f,n.wrap&4&&f&&(t.adler=n.check=n.flags?ol(n.check,r,f,t.next_out-f):$O(n.check,r,f,t.next_out-f)),t.data_type=n.bits+(n.last?64:0)+(n.mode===Rv?128:0)+(n.mode===iP||n.mode===g5?256:0),(h===0&&f===0||e===Fee)&&k===VT&&(k=R3e),k},U3e=t=>{if(E1(t))return gp;let e=t.state;return e.window&&(e.window=null),t.state=null,VT},B3e=(t,e)=>{if(E1(t))return gp;const n=t.state;return n.wrap&2?(n.head=e,e.done=!1,VT):gp},F3e=(t,e)=>{const n=e.length;let i,r,s;return E1(t)||(i=t.state,i.wrap!==0&&i.mode!==DU)?gp:i.mode===DU&&(r=1,r=$O(r,e,n,0),r!==i.check)?Gde:(s=Jde(t,e,n,n),s?(i.mode=$de,qde):(i.havedict=1,VT))};var z3e=Xde,H3e=Kde,j3e=Yde,V3e=D3e,G3e=Zde,q3e=L3e,$3e=U3e,W3e=B3e,Y3e=F3e,X3e="pako inflate (from Nodeca project)",jv={inflateReset:z3e,inflateReset2:H3e,inflateResetKeep:j3e,inflateInit:V3e,inflateInit2:G3e,inflate:q3e,inflateEnd:$3e,inflateGetHeader:W3e,inflateSetDictionary:Y3e,inflateInfo:X3e};function K3e(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}var Z3e=K3e;const Qde=Object.prototype.toString,{Z_NO_FLUSH:J3e,Z_FINISH:Q3e,Z_OK:XO,Z_STREAM_END:b5,Z_NEED_DICT:E5,Z_STREAM_ERROR:eBe,Z_DATA_ERROR:ute,Z_MEM_ERROR:tBe}=b1;function II(t){this.options=fF.assign({chunkSize:1024*64,windowBits:15,to:""},t||{});const e=this.options;e.raw&&e.windowBits>=0&&e.windowBits<16&&(e.windowBits=-e.windowBits,e.windowBits===0&&(e.windowBits=-15)),e.windowBits>=0&&e.windowBits<16&&!(t&&t.windowBits)&&(e.windowBits+=32),e.windowBits>15&&e.windowBits<48&&(e.windowBits&15||(e.windowBits|=15)),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new zde,this.strm.avail_out=0;let n=jv.inflateInit2(this.strm,e.windowBits);if(n!==XO)throw new Error(HT[n]);if(this.header=new Z3e,jv.inflateGetHeader(this.strm,this.header),e.dictionary&&(typeof e.dictionary=="string"?e.dictionary=YO.string2buf(e.dictionary):Qde.call(e.dictionary)==="[object ArrayBuffer]"&&(e.dictionary=new Uint8Array(e.dictionary)),e.raw&&(n=jv.inflateSetDictionary(this.strm,e.dictionary),n!==XO)))throw new Error(HT[n])}II.prototype.push=function(t,e){const n=this.strm,i=this.options.chunkSize,r=this.options.dictionary;let s,a,o;if(this.ended)return!1;for(e===~~e?a=e:a=e===!0?Q3e:J3e,Qde.call(t)==="[object ArrayBuffer]"?n.input=new Uint8Array(t):n.input=t,n.next_in=0,n.avail_in=n.input.length;;){for(n.avail_out===0&&(n.output=new Uint8Array(i),n.next_out=0,n.avail_out=i),s=jv.inflate(n,a),s===E5&&r&&(s=jv.inflateSetDictionary(n,r),s===XO?s=jv.inflate(n,a):s===ute&&(s=E5));n.avail_in>0&&s===b5&&n.state.wrap>0&&t[n.next_in]!==0;)jv.inflateReset(n),s=jv.inflate(n,a);switch(s){case eBe:case ute:case E5:case tBe:return this.onEnd(s),this.ended=!0,!1}if(o=n.avail_out,n.next_out&&(n.avail_out===0||s===b5))if(this.options.to==="string"){let c=YO.utf8border(n.output,n.next_out),l=n.next_out-c,u=YO.buf2string(n.output,c);n.next_out=l,n.avail_out=i-l,l&&n.output.set(n.output.subarray(c,c+l),0),this.onData(u)}else this.onData(n.output.length===n.next_out?n.output:n.output.subarray(0,n.next_out));if(!(s===XO&&o===0)){if(s===b5)return s=jv.inflateEnd(this.strm),this.onEnd(s),this.ended=!0,!0;if(n.avail_in===0)break}}return!0};II.prototype.onData=function(t){this.chunks.push(t)};II.prototype.onEnd=function(t){t===XO&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=fF.flattenChunks(this.chunks)),this.chunks=[],this.err=t,this.msg=this.strm.msg};function e9(t,e){const n=new II(e);if(n.push(t),n.err)throw n.msg||HT[n.err];return n.result}function nBe(t,e){return e=e||{},e.raw=!0,e9(t,e)}var iBe=II,rBe=e9,sBe=nBe,aBe=e9,oBe=b1,cBe={Inflate:iBe,inflate:rBe,inflateRaw:sBe,ungzip:aBe,constants:oBe};const{Deflate:lBe,deflate:uBe,deflateRaw:hBe,gzip:fBe}=g3e,{Inflate:dBe,inflate:pBe,inflateRaw:mBe,ungzip:gBe}=cBe;var vBe=lBe,_Be=uBe,yBe=hBe,bBe=fBe,EBe=dBe,SBe=pBe,TBe=mBe,xBe=gBe,wBe=b1,CBe={Deflate:vBe,deflate:_Be,deflateRaw:yBe,gzip:bBe,Inflate:EBe,inflate:SBe,inflateRaw:TBe,ungzip:xBe,constants:wBe};function hte(t){let e=t.r.toString(16),n=t.g.toString(16),i=t.b.toString(16);return e.length<2&&(e="0"+e),n.length<2&&(n="0"+n),i.length<2&&(i="0"+i),e+n+i}const ABe=t=>new Promise((e,n)=>{try{const i=CBe.inflate(t),r=RBe(i);e(r)}catch(i){n(i)}}),RBe=t=>{const e=new DataView(t.buffer),n={version:e.getUint32(0,!0),layers:[]},i=e.getUint32(4,!0);let r=8;for(let s=0;s<i;s++){const a={width:0,height:0,raster:[]};a.width=e.getUint32(r,!0),r+=4,a.height=e.getUint32(r,!0),r+=4,a.raster=Array(a.height*a.width);for(let o=0;o<a.width;o++)for(let c=0;c<a.height;c++){const l={asciiCode:e.getUint32(r,!0),transparent:!1,color:{r:0,g:0,b:0,hex:""},bg:{r:0,g:0,b:0,hex:""}};r+=4,l.color.r=e.getUint8(r++),l.color.g=e.getUint8(r++),l.color.b=e.getUint8(r++),l.color.hex=hte(l.color),l.bg.r=e.getUint8(r++),l.bg.g=e.getUint8(r++),l.bg.b=e.getUint8(r++),l.bg.hex=hte(l.bg),l.transparent=l.bg.r===255&&l.bg.g===0&&l.bg.b===255,a.raster[o+a.width*c]=l}n.layers.push(a)}return n};function MBe(t){return typeof t=="object"&&On(t.session)&&On(t.player)&&On(t.id)&&On(t.sender)&&On(t.target)}function Ui(t,e,n,...i){return t.emit(e,"error",[`$red${n}$blue>>`,...i]),!1}function e0(t,e,...n){return t.emit(e,"info",n),!0}function OBe(t,e,...n){return t.emit(e,"debug",n),!0}function NBe(t,e,n){t.emit(e,"toast",n)}function IBe(t,e,n){t.emit(e,"bridge:streamstart",n)}function kBe(t,e){t.emit(e,"bridge:streamstop",void 0)}function DBe(t,e,n){t.emit(e,"bridge:chatstart",n)}function PBe(t,e){t.emit(e,"bridge:chatstop")}function LBe(t,e,n,i,r,s,a){t.emit(e,"bridge:fetch",[n,i,r,s,a])}function UBe(t,e){t.emit(e,"bridge:talkstart",e)}function BBe(t,e){t.emit(e,"bridge:talkstop",e)}function FBe(t,e){t.emit(e,"bridge:mediastart",e)}function zBe(t,e){t.emit(e,"bridge:mediastop",e)}function HBe(t,e,n){t.emit(e,"bridge:join",n)}function jBe(t,e,n){t.emit(e,"bridge:start",n)}function VBe(t,e,n){t.emit(e,"bridge:tab",n)}function GBe(t,e,n){t.emit(e,"bridge:tabopen",n)}function qBe(t,e,n,i){t.emit(e,"bridge:showjoincode",[n,i])}function $Be(t,e){t.emit(e,"gadgetserver:desync")}function WBe(t,e){t.emit(e,"gadgetserver:clearscroll")}function fte(t,e,n,i){t.emit(e,"register:downloadjsonfile",[n,i])}function YBe(t,e){t.emit(e,"register:dev",void 0)}function XBe(t,e){t.emit(e,"register:share",void 0)}function KBe(t,e){t.emit(e,"register:nuke",void 0)}function ZBe(t,e){t.emit(e,"synth:audioenabled",void 0)}function JBe(t,e,n,i){t.emit(e,"synth:tts",[n,i])}function QBe(t,e,n){t.emit(e,"synth:tta",[n])}function zy(t,e,n,i,r){t.emit(e,"synth:play",[n,i,r])}function eFe(t,e,n){t.emit(e,"synth:bpm",n)}function tFe(t,e,n){t.emit(e,"synth:playvolume",n)}function nFe(t,e,n){t.emit(e,"synth:bgplayvolume",n)}function iFe(t,e,n){t.emit(e,"synth:ttsvolume",n)}function S5(t,e,n,i,r){t.emit(e,"synth:voice",[n,i,r])}function epe(t,e,n,i,r,s){t.emit(e,"synth:voicefx",[n,i,r,s])}function rFe(t,e){t.emit(e,"register:inspector")}function sFe(t,e){t.emit(e,"register:terminal:open")}function aFe(t,e){t.emit(e,"register:terminal:quickopen")}function PU(t,e){t.emit(e,"register:terminal:close")}function oFe(t,e){t.emit(e,"register:terminal:toggle")}function tpe(t,e,n){t.emit(e,"register:terminal:inclayout",n)}function t9(t,e){t.emit(e,"register:terminal:full")}function cFe(t,e,n,i,r,s,a){t.emit(e,"register:editor:open",[n,i,r,s,a])}function lFe(t,e){t.emit(e,"register:editor:close")}function uFe(t,e){t.emit(e,"vm:operator")}function hFe(t,e){t.emit(e,"vm:zsswords")}function fFe(t,e,n){t.emit(e,"vm:halt",n)}function dFe(t,e,n,i){t.emit(e,"vm:books",[n,i])}function pFe(t,e){t.emit(e,"vm:search")}function mFe(t,e){t.emit(e,"vm:login")}function gFe(t,e){t.emit(e,"vm:logout")}function vFe(t,e){t.emit(e,"vm:doot")}function _Fe(t,e,n,i){t.emit(e,"vm:input",[n,i])}function yFe(t,e,n){t.emit(e,"vm:copyjsonfile",n)}function bFe(t,e,n){t.emit(e,"vm:refsheet",n)}function EFe(t,e,n,i){t.emit(e,"vm:inspect",[n,i])}function npe(t,e){const[n,i]=e;return`${t}:${[n,i].filter(se).join(":")}`}function SFe(t,e,n,i){t.emit(e,"vm:codewatch",[n,i])}function TFe(t,e,n,i){t.emit(e,"vm:coderelease",[n,i])}function n_(t,e,n){t.emit(e,"vm:cli",n)}function xFe(t,e){t.emit(e,"vm:clirepeatlast")}function wFe(t,e){t.emit(e,"vm:restart")}function CFe(t,e,n){t.emit(e,"vm:synthsend",n)}function AFe(t,e){t.emit(e,"vm:flush")}function RFe(t,e){t.emit(e,"vm:fork")}function MFe(t,e){return{filename:t,cursor:0,lines:e.split(`
`)}}function OFe(t,e){return{filename:t,json:e}}function NFe(t,e){return{filename:t,cursor:0,bytes:e,dataview:new DataView(e.buffer)}}function IFe(t,e){const n={filename:t,cursor:0,content:void 0};return ABe(e).then(i=>{n.content=i}).catch(()=>{}),n}function Vg(t,e,n,i,r,s){let a;switch(i){case"file":a=s;break;case"text":a=MFe(r,s);break;case"json":a=OFe(r,s);break;case"binary":a=NFe(r,s);break;case"rexpaint":a=IFe(r,s);break}setTimeout(()=>{t.emit(e,"vm:loader",[n,i,r,a])},1)}var ipe={};(function(t){var e=jl&&jl.__spreadArray||function(l,u,h){if(h||arguments.length===2)for(var f=0,d=u.length,p;f<d;f++)(p||!(f in u))&&(p||(p=Array.prototype.slice.call(u,0,f)),p[f]=u[f]);return l.concat(p||Array.prototype.slice.call(u))};Object.defineProperty(t,"__esModule",{value:!0}),t.minLength=t.maxLength=t.poolSize=t.humanId=t.adverbs=t.verbs=t.nouns=t.adjectives=void 0,t.adjectives=["afraid","all","angry","beige","big","better","bitter","blue","brave","breezy","bright","brown","bumpy","busy","calm","chatty","chilly","chubby","clean","clear","clever","cold","crazy","cruel","cuddly","curly","curvy","cute","common","cold","cool","cyan","dark","deep","dirty","dry","dull","eager","early","easy","eight","eighty","eleven","empty","every","evil","fair","famous","fast","fancy","few","fine","fifty","five","flat","fluffy","floppy","forty","four","free","fresh","fruity","full","funny","fuzzy","gentle","giant","gold","good","great","green","grumpy","happy","heavy","hip","honest","hot","huge","hungry","icy","itchy","khaki","kind","large","late","lazy","lemon","legal","light","little","long","loose","loud","lovely","lucky","major","many","mean","metal","mighty","modern","moody","nasty","neat","new","nice","nine","ninety","odd","old","olive","open","orange","pink","plain","plenty","polite","poor","pretty","proud","public","puny","petite","purple","quick","quiet","rare","real","ready","red","rich","ripe","rotten","rude","sad","salty","seven","shaggy","shaky","sharp","shiny","short","shy","silent","silly","silver","six","sixty","slick","slimy","slow","small","smart","smooth","social","soft","solid","some","sour","spicy","spotty","stale","strong","stupid","sweet","swift","tall","tame","tangy","tasty","ten","tender","thick","thin","thirty","three","tidy","tiny","tired","tough","tricky","true","twelve","twenty","two","upset","vast","violet","warm","weak","wet","whole","wicked","wide","wild","wise","witty","yellow","young","yummy"],t.nouns=["apes","animals","areas","bars","banks","baths","breads","bushes","cloths","clowns","clubs","hoops","loops","memes","papers","parks","paths","showers","sides","signs","sites","streets","teeth","tires","webs","actors","ads","adults","aliens","ants","apples","baboons","badgers","bags","bananas","bats","beans","bears","beds","beers","bees","berries","bikes","birds","boats","bobcats","books","bottles","boxes","brooms","buckets","bugs","buses","buttons","camels","cases","cameras","candies","candles","carpets","carrots","carrots","cars","cats","chairs","chefs","chicken","clocks","clouds","coats","cobras","coins","corners","colts","comics","cooks","cougars","regions","results","cows","crabs","crabs","crews","cups","cities","cycles","dancers","days","deer","dingos","dodos","dogs","dolls","donkeys","donuts","doodles","doors","dots","dragons","drinks","dryers","ducks","ducks","eagles","ears","eels","eggs","ends","mammals","emus","experts","eyes","facts","falcons","fans","feet","files","flies","flowers","forks","foxes","friends","frogs","games","garlics","geckos","geese","ghosts","ghosts","gifts","glasses","goats","grapes","groups","guests","hairs","hands","hats","heads","hornets","horses","hotels","hounds","houses","humans","icons","ideas","impalas","insects","islands","items","jars","jeans","jobs","jokes","keys","kids","kings","kiwis","knives","lamps","lands","laws","lemons","lies","lights","lines","lions","lizards","llamas","mails","mangos","maps","masks","meals","melons","mice","mirrors","moments","moles","monkeys","months","moons","moose","mugs","nails","needles","news","nights","numbers","olives","onions","oranges","otters","owls","pandas","pans","pants","papayas","parents","parts","parrots","paws","peaches","pears","peas","pens","pets","phones","pianos","pigs","pillows","places","planes","planets","plants","plums","poems","poets","points","pots","pugs","pumas","queens","rabbits","radios","rats","ravens","readers","rice","rings","rivers","rockets","rocks","rooms","roses","rules","schools","bats","seals","seas","sheep","shirts","shoes","shrimps","singers","sloths","snails","snakes","socks","spiders","spies","spoons","squids","stars","states","steaks","wings","suits","suns","swans","symbols","tables","taxes","taxis","teams","terms","things","ties","tigers","times","tips","toes","towns","tools","toys","trains","trams","trees","turkeys","turtles","vans","views","walls","walls","wasps","waves","ways","weeks","windows","wolves","women","wombats","words","worlds","worms","yaks","years","zebras","zoos"],t.verbs=["accept","act","add","admire","agree","allow","appear","argue","arrive","ask","attack","attend","bake","bathe","battle","beam","beg","begin","behave","bet","boil","bow","brake","brush","build","burn","buy","call","camp","care","carry","change","cheat","check","cheer","chew","clap","clean","cough","count","cover","crash","create","cross","cry","cut","dance","decide","deny","design","dig","divide","do","double","doubt","draw","dream","dress","drive","drop","drum","eat","end","enter","enjoy","exist","fail","fall","feel","fetch","film","find","fix","flash","float","flow","fly","fold","follow","fry","give","glow","go","grab","greet","grin","grow","guess","hammer","hang","happen","heal","hear","help","hide","hope","hug","hunt","invent","invite","itch","jam","jog","join","joke","judge","juggle","jump","kick","kiss","kneel","knock","know","laugh","lay","lead","learn","leave","lick","like","lie","listen","live","look","lose","love","make","march","marry","mate","matter","melt","mix","move","nail","notice","obey","occur","open","own","pay","peel","play","poke","post","press","prove","pull","pump","pick","punch","push","raise","read","refuse","relate","relax","remain","repair","repeat","reply","report","rescue","rest","retire","return","rhyme","ring","roll","rule","run","rush","say","scream","see","search","sell","send","serve","shake","share","shave","shine","show","shop","shout","sin","sink","sing","sip","sit","sleep","slide","smash","smell","smile","smoke","sneeze","sniff","sort","speak","spend","stand","start","stay","stick","stop","stare","study","strive","swim","switch","take","talk","tan","tap","taste","teach","tease","tell","thank","think","throw","tickle","tie","trade","train","travel","try","turn","type","unite","vanish","visit","wait","walk","warn","wash","watch","wave","wear","win","wink","wish","wonder","work","worry","write","yawn","yell"],t.adverbs=["bravely","brightly","busily","daily","freely","hungrily","joyously","knowlingly","lazily","oddly","mysteriously","noisily","politely","quickly","quietly","rapidly","safely","sleepily","slowly","truly","yearly"];function n(l){return l[Math.floor(Math.random()*l.length)]}function i(l){return l.reduce(function(u,h){return u.length>h.length?u:h})}function r(l){return l.reduce(function(u,h){return u.length<h.length?u:h})}function s(l){l===void 0&&(l={}),typeof l=="string"&&(l={separator:l}),typeof l=="boolean"&&(l={capitalize:l});var u=l.separator,h=u===void 0?"":u,f=l.capitalize,d=f===void 0?!0:f,p=l.adjectiveCount,g=p===void 0?1:p,y=l.addAdverb,v=y===void 0?!1:y,b=e(e(e([],e([],Array(g),!0).map(function(T){return n(t.adjectives)}),!0),[n(t.nouns),n(t.verbs)],!1),v?[n(t.adverbs)]:[],!0);return d&&(b=b.map(function(T){return T.charAt(0).toUpperCase()+T.substr(1)})),b.join(h)}t.humanId=s;function a(l){l===void 0&&(l={});var u=l.adjectiveCount,h=u===void 0?1:u,f=l.addAdverb,d=f===void 0?!1:f;return t.adjectives.length*h*t.nouns.length*t.verbs.length*(d?t.adverbs.length:1)}t.poolSize=a;function o(l){l===void 0&&(l={});var u=l.adjectiveCount,h=u===void 0?1:u,f=l.addAdverb,d=f===void 0?!1:f,p=l.separator,g=p===void 0?"":p;return i(t.adjectives).length*h+h*g.length+i(t.nouns).length+g.length+i(t.verbs).length+(d?i(t.adverbs).length+g.length:0)}t.maxLength=o;function c(l){l===void 0&&(l={});var u=l.adjectiveCount,h=u===void 0?1:u,f=l.addAdverb,d=f===void 0?!1:f,p=l.separator,g=p===void 0?"":p;return r(t.adjectives).length*h+h*g.length+r(t.nouns).length+g.length+r(t.verbs).length+(d?r(t.adverbs).length+g.length:0)}t.minLength=c,t.default=s})(ipe);const n9=Yc(ipe);function i9(t){return new Promise((e,n)=>{t.oncomplete=t.onsuccess=()=>e(t.result),t.onabort=t.onerror=()=>n(t.error)})}function kFe(t,e){const n=indexedDB.open(t);n.onupgradeneeded=()=>n.result.createObjectStore(e);const i=i9(n);return(r,s)=>i.then(a=>s(a.transaction(e,r).objectStore(e)))}let T5;function rpe(){return T5||(T5=kFe("keyval-store","keyval")),T5}function DFe(t,e=rpe()){return e("readonly",n=>i9(n.get(t)))}function PFe(t,e,n=rpe()){return n("readwrite",i=>new Promise((r,s)=>{i.get(t).onsuccess=function(){try{i.put(e(this.result),t),r(i9(i.transaction))}catch(a){s(a)}}}))}const x5=new Set,KO={emit(t,e,n,i,r){KO.invoke(QFe(t,e,n,i,r))},invoke(t){x5.forEach(e=>e.handle(t))},connect(t){x5.add(t)},disconnect(t){x5.delete(t)}},LFe="useandom-26T198340PX75pxJACKVERYMINDBUSHWOLF_GQZbfghjklqvwyzrict";let UFe=t=>crypto.getRandomValues(new Uint8Array(t)),BFe=(t,e,n)=>{let i=(2<<Math.log2(t.length-1))-1,r=-~(1.6*i*e/t.length);return(s=e)=>{let a="";for(;;){let o=n(r),c=r;for(;c--;)if(a+=t[o[c]&i]||"",a.length===s)return a}}},spe=(t,e=21)=>BFe(t,e,UFe),FFe=(t=21)=>{let e="",n=crypto.getRandomValues(new Uint8Array(t));for(;t--;)e+=LFe[n[t]&63];return e};var ape="abcdefghijklmnopqrstuvwxyz",ope="ABCDEFGHIJKLMNOPQRSTUVWXYZ",cpe="0123456789",zFe="346789ABCDEFGHJKLMNPQRTUVWXYabcdefghijkmnpqrtwxyz",HFe="6789BCDFGHJKLMNPQRTWbcdfghjkmnpqrtwz";const jFe=cpe,VFe=ape,GFe=ope;var qFe=jFe+VFe+GFe,HG={lowercase:ape,uppercase:ope,numbers:cpe,nolookalikes:zFe,nolookalikesSafe:HFe,alphanumeric:qFe};function Bo(){return`sid_${FFe(12).replaceAll("-",".")}`}const $Fe=spe(HG.numbers,4),WFe=spe(`${HG.numbers}${HG.lowercase}`,16);function YFe(){return`pid_${$Fe()}_${WFe()}`}function Nb(t){return(t==null?void 0:t.startsWith("pid_"))??!1}function XFe(){return n9({capitalize:!1,adjectiveCount:1})}function KFe(){return n9({addAdverb:!1,capitalize:!1,adjectiveCount:0})}const ZFe=20,dte="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";function JFe(t){const e=GW(t),n=[];for(let i=0;i<ZFe;++i)n.push(dte[Math.floor(e()*dte.length)]);return n.join("")}var Jt=(t=>(t[t.BLACK=0]="BLACK",t[t.DKBLUE=1]="DKBLUE",t[t.DKGREEN=2]="DKGREEN",t[t.DKCYAN=3]="DKCYAN",t[t.DKRED=4]="DKRED",t[t.DKPURPLE=5]="DKPURPLE",t[t.DKYELLOW=6]="DKYELLOW",t[t.LTGRAY=7]="LTGRAY",t[t.DKGRAY=8]="DKGRAY",t[t.BLUE=9]="BLUE",t[t.GREEN=10]="GREEN",t[t.CYAN=11]="CYAN",t[t.RED=12]="RED",t[t.PURPLE=13]="PURPLE",t[t.YELLOW=14]="YELLOW",t[t.WHITE=15]="WHITE",t[t.ONBLACK=16]="ONBLACK",t[t.ONDKBLUE=17]="ONDKBLUE",t[t.ONDKGREEN=18]="ONDKGREEN",t[t.ONDKCYAN=19]="ONDKCYAN",t[t.ONDKRED=20]="ONDKRED",t[t.ONDKPURPLE=21]="ONDKPURPLE",t[t.ONDKYELLOW=22]="ONDKYELLOW",t[t.ONLTGRAY=23]="ONLTGRAY",t[t.ONDKGRAY=24]="ONDKGRAY",t[t.ONBLUE=25]="ONBLUE",t[t.ONGREEN=26]="ONGREEN",t[t.ONCYAN=27]="ONCYAN",t[t.ONRED=28]="ONRED",t[t.ONPURPLE=29]="ONPURPLE",t[t.ONYELLOW=30]="ONYELLOW",t[t.ONWHITE=31]="ONWHITE",t[t.ONCLEAR=32]="ONCLEAR",t))(Jt||{}),vs=(t=>(t[t.ISWALK=0]="ISWALK",t[t.ISSOLID=1]="ISSOLID",t[t.ISSWIM=2]="ISSWIM",t[t.ISBULLET=3]="ISBULLET",t))(vs||{}),GT=(t=>(t[t.ISTERRAIN=0]="ISTERRAIN",t[t.ISOBJECT=1]="ISOBJECT",t))(GT||{}),rn=(t=>(t[t.IDLE=0]="IDLE",t[t.NORTH=1]="NORTH",t[t.SOUTH=2]="SOUTH",t[t.WEST=3]="WEST",t[t.EAST=4]="EAST",t[t.BY=5]="BY",t[t.AT=6]="AT",t[t.FLOW=7]="FLOW",t[t.SEEK=8]="SEEK",t[t.RNDNS=9]="RNDNS",t[t.RNDNE=10]="RNDNE",t[t.RND=11]="RND",t[t.CW=12]="CW",t[t.CCW=13]="CCW",t[t.OPP=14]="OPP",t[t.RNDP=15]="RNDP",t[t.AWAY=16]="AWAY",t[t.TOWARD=17]="TOWARD",t[t.PLAYER=18]="PLAYER",t[t.FIND=19]="FIND",t[t.FLEE=20]="FLEE",t[t.TO=21]="TO",t))(rn||{}),cn=(t=>(t[t.LOADER=0]="LOADER",t[t.BOARD=1]="BOARD",t[t.OBJECT=2]="OBJECT",t[t.TERRAIN=3]="TERRAIN",t[t.CHARSET=4]="CHARSET",t[t.PALETTE=5]="PALETTE",t[t.CONST=6]="CONST",t[t.RANGE=7]="RANGE",t[t.SELECT=8]="SELECT",t[t.NUMBER=9]="NUMBER",t[t.TEXT=10]="TEXT",t[t.LINK=11]="LINK",t[t.HOTKEY=12]="HOTKEY",t[t.COPYIT=13]="COPYIT",t[t.OPENIT=14]="OPENIT",t[t.ZSSEDIT=15]="ZSSEDIT",t[t.CHAREDIT=16]="CHAREDIT",t[t.COLOREDIT=17]="COLOREDIT",t))(cn||{});function si(t){return(t==null?void 0:t.toLowerCase().trim())??""}function QFe(t,e,n,i,r){return{session:t,player:e,id:Bo(),sender:n,target:i,data:r}}function S1(t){const[e,...n]=t.split(":");return{target:e,path:n.join(":")}}function yE(t,e=[],n=Zu,i=""){const r=Bo(),s=si(t),a=e.map(si);let o=i;const c={id(){return r},name(){return t},session(l){return se(l)?l.session===o?l.session:"":o},topics(){return e},emit(l,u,h){KO.emit(o,l,r,u,h)},reply(l,u,h){c.emit(l.player,`${l.sender}:${u}`,h)},replynext(l,u,h){setTimeout(()=>c.emit(l.player,`${l.sender}:${u}`,h),64)},handle(l){const{target:u,path:h}=S1(l.target),f=si(u);!o&&f==="ready"&&(o=l.session),f==="bridge"&&se(l.session)&&(o=l.session),a.findIndex(d=>d==="all"||d===f)!==-1&&n(l),(r===u||f==="all"||s===f)&&n({...l,target:h})}};return KO.connect(c),c}var QS=(t=>(t[t.Border=-1]="Border",t[t.Data=0]="Data",t[t.Function=1]="Function",t[t.Position=2]="Position",t[t.Timing=3]="Timing",t[t.Alignment=4]="Alignment",t))(QS||{}),e6e=Object.defineProperty,t6e=(t,e,n)=>e in t?e6e(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,sP=(t,e,n)=>(t6e(t,typeof e!="symbol"?e+"":e,n),n);const n6e=[0,1],lpe=[1,0],upe=[2,3],hpe=[3,2],i6e={L:n6e,M:lpe,Q:upe,H:hpe},r6e=/^[0-9]*$/,s6e=/^[A-Z0-9 $%*+.\/:-]*$/,w5="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ $%*+-./:",r9=1,s9=40,pte=3,a6e=3,aP=40,o6e=10,fpe=[[-1,7,10,15,20,26,18,20,24,30,18,20,24,26,30,22,24,28,30,28,28,28,28,30,30,26,28,30,30,30,30,30,30,30,30,30,30,30,30,30,30],[-1,10,16,26,18,24,16,18,22,22,26,30,22,22,24,24,28,28,26,26,26,26,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28],[-1,13,22,18,26,18,24,18,22,20,24,28,26,24,20,30,24,28,28,26,30,28,30,30,30,30,28,30,30,30,30,30,30,30,30,30,30,30,30,30,30],[-1,17,28,22,16,22,28,26,26,24,28,24,28,22,24,24,30,28,28,26,28,30,24,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30]],dpe=[[-1,1,1,1,1,1,2,2,2,2,4,4,4,4,4,6,6,6,6,7,8,8,9,9,10,12,12,12,13,14,15,16,17,18,19,19,20,21,22,24,25],[-1,1,1,1,2,2,4,4,4,5,5,5,8,9,9,10,10,11,13,14,16,17,17,18,20,21,23,25,26,28,29,31,33,35,37,38,40,43,45,47,49],[-1,1,1,2,2,4,4,6,6,8,8,8,10,12,16,12,17,16,18,21,20,23,23,25,27,29,34,34,35,38,40,43,45,48,51,53,56,59,62,65,68],[-1,1,1,2,4,4,4,5,6,8,8,11,11,16,16,18,16,19,21,25,25,25,34,30,32,35,37,40,42,45,48,51,54,57,60,63,66,70,74,77,81]];class c6e{constructor(e,n,i,r){if(this.version=e,this.ecc=n,sP(this,"size"),sP(this,"mask"),sP(this,"modules",[]),sP(this,"types",[]),e<r9||e>s9)throw new RangeError("Version value out of range");if(r<-1||r>7)throw new RangeError("Mask value out of range");this.size=e*4+17;const s=Array.from({length:this.size},()=>!1);for(let o=0;o<this.size;o++)this.modules.push(s.slice()),this.types.push(s.map(()=>0));this.drawFunctionPatterns();const a=this.addEccAndInterleave(i);if(this.drawCodewords(a),r===-1){let o=1e9;for(let c=0;c<8;c++){this.applyMask(c),this.drawFormatBits(c);const l=this.getPenaltyScore();l<o&&(r=c,o=l),this.applyMask(c)}}this.mask=r,this.applyMask(r),this.drawFormatBits(r)}getModule(e,n){return e>=0&&e<this.size&&n>=0&&n<this.size&&this.modules[n][e]}drawFunctionPatterns(){for(let i=0;i<this.size;i++)this.setFunctionModule(6,i,i%2===0,QS.Timing),this.setFunctionModule(i,6,i%2===0,QS.Timing);this.drawFinderPattern(3,3),this.drawFinderPattern(this.size-4,3),this.drawFinderPattern(3,this.size-4);const e=this.getAlignmentPatternPositions(),n=e.length;for(let i=0;i<n;i++)for(let r=0;r<n;r++)i===0&&r===0||i===0&&r===n-1||i===n-1&&r===0||this.drawAlignmentPattern(e[i],e[r]);this.drawFormatBits(0),this.drawVersion()}drawFormatBits(e){const n=this.ecc[1]<<3|e;let i=n;for(let s=0;s<10;s++)i=i<<1^(i>>>9)*1335;const r=(n<<10|i)^21522;for(let s=0;s<=5;s++)this.setFunctionModule(8,s,Mv(r,s));this.setFunctionModule(8,7,Mv(r,6)),this.setFunctionModule(8,8,Mv(r,7)),this.setFunctionModule(7,8,Mv(r,8));for(let s=9;s<15;s++)this.setFunctionModule(14-s,8,Mv(r,s));for(let s=0;s<8;s++)this.setFunctionModule(this.size-1-s,8,Mv(r,s));for(let s=8;s<15;s++)this.setFunctionModule(8,this.size-15+s,Mv(r,s));this.setFunctionModule(8,this.size-8,!0)}drawVersion(){if(this.version<7)return;let e=this.version;for(let i=0;i<12;i++)e=e<<1^(e>>>11)*7973;const n=this.version<<12|e;for(let i=0;i<18;i++){const r=Mv(n,i),s=this.size-11+i%3,a=Math.floor(i/3);this.setFunctionModule(s,a,r),this.setFunctionModule(a,s,r)}}drawFinderPattern(e,n){for(let i=-4;i<=4;i++)for(let r=-4;r<=4;r++){const s=Math.max(Math.abs(r),Math.abs(i)),a=e+r,o=n+i;a>=0&&a<this.size&&o>=0&&o<this.size&&this.setFunctionModule(a,o,s!==2&&s!==4,QS.Position)}}drawAlignmentPattern(e,n){for(let i=-2;i<=2;i++)for(let r=-2;r<=2;r++)this.setFunctionModule(e+r,n+i,Math.max(Math.abs(r),Math.abs(i))!==1,QS.Alignment)}setFunctionModule(e,n,i,r=QS.Function){this.modules[n][e]=i,this.types[n][e]=r}addEccAndInterleave(e){const n=this.version,i=this.ecc;if(e.length!==g2(n,i))throw new RangeError("Invalid argument");const r=dpe[i[0]][n],s=fpe[i[0]][n],a=Math.floor(jG(n)/8),o=r-a%r,c=Math.floor(a/r),l=[],u=v6e(s);for(let f=0,d=0;f<r;f++){const p=e.slice(d,d+c-s+(f<o?0:1));d+=p.length;const g=_6e(p,u);f<o&&p.push(0),l.push(p.concat(g))}const h=[];for(let f=0;f<l[0].length;f++)l.forEach((d,p)=>{(f!==c-s||p>=o)&&h.push(d[f])});return h}drawCodewords(e){if(e.length!==Math.floor(jG(this.version)/8))throw new RangeError("Invalid argument");let n=0;for(let i=this.size-1;i>=1;i-=2){i===6&&(i=5);for(let r=0;r<this.size;r++)for(let s=0;s<2;s++){const a=i-s,c=(i+1&2)===0?this.size-1-r:r;!this.types[c][a]&&n<e.length*8&&(this.modules[c][a]=Mv(e[n>>>3],7-(n&7)),n++)}}}applyMask(e){if(e<0||e>7)throw new RangeError("Mask value out of range");for(let n=0;n<this.size;n++)for(let i=0;i<this.size;i++){let r;switch(e){case 0:r=(i+n)%2===0;break;case 1:r=n%2===0;break;case 2:r=i%3===0;break;case 3:r=(i+n)%3===0;break;case 4:r=(Math.floor(i/3)+Math.floor(n/2))%2===0;break;case 5:r=i*n%2+i*n%3===0;break;case 6:r=(i*n%2+i*n%3)%2===0;break;case 7:r=((i+n)%2+i*n%3)%2===0;break;default:throw new Error("Unreachable")}!this.types[n][i]&&r&&(this.modules[n][i]=!this.modules[n][i])}}getPenaltyScore(){let e=0;for(let s=0;s<this.size;s++){let a=!1,o=0;const c=[0,0,0,0,0,0,0];for(let l=0;l<this.size;l++)this.modules[s][l]===a?(o++,o===5?e+=pte:o>5&&e++):(this.finderPenaltyAddHistory(o,c),a||(e+=this.finderPenaltyCountPatterns(c)*aP),a=this.modules[s][l],o=1);e+=this.finderPenaltyTerminateAndCount(a,o,c)*aP}for(let s=0;s<this.size;s++){let a=!1,o=0;const c=[0,0,0,0,0,0,0];for(let l=0;l<this.size;l++)this.modules[l][s]===a?(o++,o===5?e+=pte:o>5&&e++):(this.finderPenaltyAddHistory(o,c),a||(e+=this.finderPenaltyCountPatterns(c)*aP),a=this.modules[l][s],o=1);e+=this.finderPenaltyTerminateAndCount(a,o,c)*aP}for(let s=0;s<this.size-1;s++)for(let a=0;a<this.size-1;a++){const o=this.modules[s][a];o===this.modules[s][a+1]&&o===this.modules[s+1][a]&&o===this.modules[s+1][a+1]&&(e+=a6e)}let n=0;for(const s of this.modules)n=s.reduce((a,o)=>a+(o?1:0),n);const i=this.size*this.size,r=Math.ceil(Math.abs(n*20-i*10)/i)-1;return e+=r*o6e,e}getAlignmentPatternPositions(){if(this.version===1)return[];{const e=Math.floor(this.version/7)+2,n=this.version===32?26:Math.ceil((this.version*4+4)/(e*2-2))*2,i=[6];for(let r=this.size-7;i.length<e;r-=n)i.splice(1,0,r);return i}}finderPenaltyCountPatterns(e){const n=e[1],i=n>0&&e[2]===n&&e[3]===n*3&&e[4]===n&&e[5]===n;return(i&&e[0]>=n*4&&e[6]>=n?1:0)+(i&&e[6]>=n*4&&e[0]>=n?1:0)}finderPenaltyTerminateAndCount(e,n,i){return e&&(this.finderPenaltyAddHistory(n,i),n=0),n+=this.size,this.finderPenaltyAddHistory(n,i),this.finderPenaltyCountPatterns(i)}finderPenaltyAddHistory(e,n){n[0]===0&&(e+=this.size),n.pop(),n.unshift(e)}}function $v(t,e,n){if(e<0||e>31||t>>>e)throw new RangeError("Value out of range");for(let i=e-1;i>=0;i--)n.push(t>>>i&1)}function Mv(t,e){return(t>>>e&1)!==0}class a9{constructor(e,n,i){if(this.mode=e,this.numChars=n,this.bitData=i,n<0)throw new RangeError("Invalid argument");this.bitData=i.slice()}getData(){return this.bitData.slice()}}const l6e=[1,10,12,14],u6e=[2,9,11,13],h6e=[4,8,16,16];function ppe(t,e){return t[Math.floor((e+7)/17)+1]}function mpe(t){const e=[];for(const n of t)$v(n,8,e);return new a9(h6e,t.length,e)}function f6e(t){if(!gpe(t))throw new RangeError("String contains non-numeric characters");const e=[];for(let n=0;n<t.length;){const i=Math.min(t.length-n,3);$v(Number.parseInt(t.substring(n,n+i),10),i*3+1,e),n+=i}return new a9(l6e,t.length,e)}function d6e(t){if(!vpe(t))throw new RangeError("String contains unencodable characters in alphanumeric mode");const e=[];let n;for(n=0;n+2<=t.length;n+=2){let i=w5.indexOf(t.charAt(n))*45;i+=w5.indexOf(t.charAt(n+1)),$v(i,11,e)}return n<t.length&&$v(w5.indexOf(t.charAt(n)),6,e),new a9(u6e,t.length,e)}function p6e(t){return t===""?[]:gpe(t)?[f6e(t)]:vpe(t)?[d6e(t)]:[mpe(g6e(t))]}function gpe(t){return r6e.test(t)}function vpe(t){return s6e.test(t)}function m6e(t,e){let n=0;for(const i of t){const r=ppe(i.mode,e);if(i.numChars>=1<<r)return Number.POSITIVE_INFINITY;n+=4+r+i.bitData.length}return n}function g6e(t){t=encodeURI(t);const e=[];for(let n=0;n<t.length;n++)t.charAt(n)!=="%"?e.push(t.charCodeAt(n)):(e.push(Number.parseInt(t.substring(n+1,n+3),16)),n+=2);return e}function jG(t){if(t<r9||t>s9)throw new RangeError("Version number out of range");let e=(16*t+128)*t+64;if(t>=2){const n=Math.floor(t/7)+2;e-=(25*n-10)*n-55,t>=7&&(e-=36)}return e}function g2(t,e){return Math.floor(jG(t)/8)-fpe[e[0]][t]*dpe[e[0]][t]}function v6e(t){if(t<1||t>255)throw new RangeError("Degree out of range");const e=[];for(let i=0;i<t-1;i++)e.push(0);e.push(1);let n=1;for(let i=0;i<t;i++){for(let r=0;r<e.length;r++)e[r]=VG(e[r],n),r+1<e.length&&(e[r]^=e[r+1]);n=VG(n,2)}return e}function _6e(t,e){const n=e.map(i=>0);for(const i of t){const r=i^n.shift();n.push(0),e.forEach((s,a)=>n[a]^=VG(s,r))}return n}function VG(t,e){if(t>>>8||e>>>8)throw new RangeError("Byte out of range");let n=0;for(let i=7;i>=0;i--)n=n<<1^(n>>>7)*285,n^=(e>>>i&1)*t;return n}function y6e(t,e,n=1,i=40,r=-1,s=!0){if(!(r9<=n&&n<=i&&i<=s9)||r<-1||r>7)throw new RangeError("Invalid value");let a,o;for(a=n;;a++){const h=g2(a,e)*8,f=m6e(t,a);if(f<=h){o=f;break}if(a>=i)throw new RangeError("Data too long")}for(const h of[lpe,upe,hpe])s&&o<=g2(a,h)*8&&(e=h);const c=[];for(const h of t){$v(h.mode[0],4,c),$v(h.numChars,ppe(h.mode,a),c);for(const f of h.getData())c.push(f)}const l=g2(a,e)*8;$v(0,Math.min(4,l-c.length),c),$v(0,(8-c.length%8)%8,c);for(let h=236;c.length<l;h^=253)$v(h,8,c);const u=Array.from({length:Math.ceil(c.length/8)},()=>0);return c.forEach((h,f)=>u[f>>>3]|=h<<7-(f&7)),new c6e(a,e,u,r)}function b6e(t,e){var h;const{ecc:n="L",boostEcc:i=!1,minVersion:r=1,maxVersion:s=40,maskPattern:a=-1,border:o=1}=e||{},c=typeof t=="string"?p6e(t):Array.isArray(t)?[mpe(t)]:void 0;if(!c)throw new Error(`uqr only supports encoding string and binary data, but got: ${typeof t}`);const l=y6e(c,i6e[n],r,s,a,i),u=E6e({version:l.version,maskPattern:l.mask,size:l.size,data:l.modules,types:l.types},o);return e!=null&&e.invert&&(u.data=u.data.map(f=>f.map(d=>!d))),(h=e==null?void 0:e.onEncoded)==null||h.call(e,u),u}function E6e(t,e=1){if(!e)return t;const{size:n}=t,i=n+e*2;t.size=i,t.data.forEach(s=>{for(let a=0;a<e;a++)s.unshift(!1),s.push(!1)});for(let s=0;s<e;s++)t.data.unshift(Array.from({length:i},a=>!1)),t.data.push(Array.from({length:i},a=>!1));const r=QS.Border;t.types.forEach(s=>{for(let a=0;a<e;a++)s.unshift(r),s.push(r)});for(let s=0;s<e;s++)t.types.unshift(Array.from({length:i},a=>r)),t.types.push(Array.from({length:i},a=>r));return t}function S6e(t,e,n,i=!1){return e<0||n<0||e>=t.length||n>=t.length?i:t[n][e]}function T6e(t,e={}){const n={WHITE_ALL:"█",WHITE_BLACK:"▀",BLACK_WHITE:"▄",BLACK_ALL:" "},i=b6e(t,e),r=!1,s=!0,a=(l,u)=>S6e(i.data,l,u,!0),o=[];let c="";for(let l=0;l<i.size;l+=2){for(let u=0;u<i.size;u++)a(u,l)===r&&a(u,l+1)===r?c+=n.WHITE_ALL:a(u,l)===r&&a(u,l+1)===s?c+=n.WHITE_BLACK:a(u,l)===s&&a(u,l+1)===r?c+=n.BLACK_WHITE:c+=n.BLACK_ALL;o.push(c),c=""}return o.join(`
`)}const Yb="$dkpurple",x6e="$196",w6e="$205";function Ci(t,e,n){e0(t,e,n)}function C6e(t,e,n){const i=x6e.repeat(n);Ci(t,e,`${Yb}${i}`)}function o9(t,e,n){const i=w6e.repeat(n);Ci(t,e,`${Yb}${i}`)}function Gd(t,e,n){Ci(t,e,`${Yb} ${" ".repeat(n.length)} `),C6e(t,e,n.length+2),Ci(t,e,`${Yb} $white${n} `),o9(t,e,n.length+2)}function Ov(t,e,n){Ci(t,e,`${Yb} ${" ".repeat(n.length)} `),Ci(t,e,`${Yb} $gray${n} `),o9(t,e,n.length+2)}function cr(t,e,n,i){Ci(t,e,`${Yb} $white${n} $blue${i}`)}function po(t,e,n){Ci(t,e,`${Yb}$blue${n}`)}function GG(t,e,n,i,r=!0){if(r){const s=T6e(n).split(`
`),a={32:32,9600:223,9604:220,9608:219};for(let o=0;o<s.length;o++){const c=[...s[o]].map(l=>`$${a[l.charCodeAt(0)]}`).join("");Ci(t,e,c)}}Ci(t,e,`!copyit ${n};${i}`),t9(t,e)}function A6e(t,e,n,i){Ci(t,e,`!openit ${n};${i}`)}async function _pe(t){const e=new FormData;e.append("url",t);const n=new Request("https://bytes.zed.cafe",{method:"POST",body:e});return await(await fetch(n)).text()}function ype(){return window.location.href.includes("/join/")}function qG(){return window.location.href.includes("/locked/")}const mte=t=>{let e;const n=new Set,i=(l,u)=>{const h=typeof l=="function"?l(e):l;if(!Object.is(h,e)){const f=e;e=u??(typeof h!="object"||h===null)?h:Object.assign({},e,h),n.forEach(d=>d(e,f))}},r=()=>e,o={setState:i,getState:r,getInitialState:()=>c,subscribe:l=>(n.add(l),()=>n.delete(l))},c=e=t(i,r,o);return o},c9=t=>t?mte(t):mte,R6e=t=>t;function l9(t,e=R6e){const n=Ug.useSyncExternalStore(t.subscribe,()=>e(t.getState()),()=>e(t.getInitialState()));return Ug.useDebugValue(n),n}const gte=t=>{const e=c9(t),n=i=>l9(e,i);return Object.assign(n,e),n},bE=t=>t?gte(t):gte;function vte(t){const e=Fe.useRef();return n=>{const i=t(n);return(e.current===void 0||i===void 0?e.current===i:Mw(e.current,i))?e.current:e.current=i}}const xo=bE(()=>({desync:!1,zsswords:{cli:[],loader:[],runtime:[],flags:[],stats:[],kinds:[],altkinds:[],colors:[],dirs:[],dirmods:[]},gadget:{id:"",layers:[],scroll:[],sidebar:[]}}));var v2=(t=>(t[t.OFF=0]="OFF",t[t.INFO=1]="INFO",t[t.DEBUG=2]="DEBUG",t))(v2||{});const _te=128;var qf=(t=>(t[t.TOP=0]="TOP",t[t.FULL=1]="FULL",t[t.BOTTOM=2]="BOTTOM",t[t.SPLIT_Y=3]="SPLIT_Y",t[t.SPLIT_Y_ALT=4]="SPLIT_Y_ALT",t[t.MAX=5]="MAX",t))(qf||{});const Fs=bE(()=>({layout:0,inspector:qG(),quickterminal:!1,toast:"",terminal:{open:!0,level:1,logs:[]},editor:{open:!1,book:"",path:[],type:"",title:"",refsheet:[]}})),Lo=bE(()=>({scroll:0,xcursor:0,ycursor:0,xselect:void 0,yselect:void 0,bufferindex:0,buffer:[""]})),mo=bE(()=>({id:"",xscroll:0,yscroll:0,cursor:0,select:void 0})),Fx=bE(()=>({cursor:void 0,select:void 0}));function M6e(t){const e=document.createElement("canvas");if(e.width=(t==null?void 0:t.width)||1,e.height=(t==null?void 0:t.height)||1,t){const n=e.getContext("2d"),i=n==null?void 0:n.getImageData(0,0,t.width,t.height);if(i&&n){let r=0;const{data:s}=i;for(let a=0;a<s.length;a+=4){const o=t.bits[r];s[a]=o,s[a+1]=o,s[a+2]=o,s[a+3]=255,r+=1}n.putImageData(i,0,0)}}return e}function bpe(t,e){return{width:t,height:e,size:t*e,bits:new Uint8Array(t*e).fill(0)}}function Zw(t,e,n){return{width:t,height:e,size:t*e,bits:new Uint8Array(n)}}const fi=60,Fr=25,u9=fi*Fr;var Wn=(t=>(t[t.ERROR=0]="ERROR",t[t.LOADER=1]="LOADER",t[t.BOARD=2]="BOARD",t[t.OBJECT=3]="OBJECT",t[t.TERRAIN=4]="TERRAIN",t[t.CHARSET=5]="CHARSET",t[t.PALETTE=6]="PALETTE",t))(Wn||{});const $G=14,Xb=3,Gg=8,qg=14,Kh=16,ZO=16,h9=16;var $f=(t=>(t[t.BLANK=0]="BLANK",t[t.TILES=1]="TILES",t[t.SPRITES=2]="SPRITES",t[t.DITHER=3]="DITHER",t[t.MEDIA=4]="MEDIA",t[t.CONTROL=5]="CONTROL",t))($f||{}),dm=(t=>(t[t.FAR=1]="FAR",t[t.MID=1.5]="MID",t[t.NEAR=3]="NEAR",t))(dm||{});function LU(t){let e=0,n=0,i=fi*.5,r=Fr*.5,s=1.5,a="flat",o=0;return t.forEach(c=>{switch(c.type){case 1:e=Math.max(e,c.width),n=Math.max(n,c.height);break;case 3:e=Math.max(e,c.width),n=Math.max(n,c.height);break;case 5:i=c.focusx,r=c.focusy,s=c.viewscale,a=c.graphics,o=c.facing;break}}),{width:e,height:n,focusx:i,focusy:r,viewscale:s,graphics:a,facing:o}}function EE(t,e){return`${t}:${e}`}const Epe=1,Spe=16,Tpe=256;var tn=(t=>(t[t.NONE=0]="NONE",t[t.ALT=1]="ALT",t[t.CTRL=2]="CTRL",t[t.SHIFT=3]="SHIFT",t[t.MOVE_UP=4]="MOVE_UP",t[t.MOVE_DOWN=5]="MOVE_DOWN",t[t.MOVE_LEFT=6]="MOVE_LEFT",t[t.MOVE_RIGHT=7]="MOVE_RIGHT",t[t.OK_BUTTON=8]="OK_BUTTON",t[t.CANCEL_BUTTON=9]="CANCEL_BUTTON",t[t.MENU_BUTTON=10]="MENU_BUTTON",t))(tn||{});function T1(t){const e=Math.floor(t.length/Xb);if(e*Xb!==t.length)return;const n=bpe(3,e);for(let i=0;i<n.bits.length;++i)n.bits[i]=t[i];return n}function O6e(t,e){return t&1<<e?255:0}function DA(t){const e=Math.floor(t.length/$G);if(e*$G!==t.length)return;const n=Math.ceil(e/Kh),i=Gg*Kh,r=bpe(i,qg*n);let s=0,a=0,o=0;for(let c=0;c<t.length;++c){const l=a*qg+o,u=t[c];for(let h=0;h<Gg;++h){const f=s*Gg+h;r.bits[f+l*i]=O6e(u,7-h)}++o,o===qg&&(o=0,++s,s===Kh&&(s=0,++a))}return r}/* Common package for dealing with hex/string/uint8 conversions (and sha1 hashing)
*
* @author   Jimmy Wärting <jimmy@warting.se> (https://jimmy.warting.se/opensource)
* @license  MIT
*/const yte="0123456789abcdef",xpe=[],UU=[];for(let t=0;t<256;t++)xpe[t]=yte[t>>4&15]+yte[t&15],t<16&&(t<10?UU[48+t]=t:UU[87+t]=t);const wpe=t=>{const e=t.length;let n="",i=0;for(;i<e;)n+=xpe[t[i++]];return n},JO=t=>{const e=t.length>>1,n=e<<1,i=new Uint8Array(e);let r=0,s=0;for(;s<n;)i[r++]=UU[t.charCodeAt(s++)]<<4|UU[t.charCodeAt(s++)];return i};var bte="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",N6e=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(var oP=0;oP<bte.length;oP++)N6e[bte.charCodeAt(oP)]=oP;new TextDecoder;new TextEncoder;const Ete=typeof window<"u"?window:self,Ste=Ete.crypto||Ete.msCrypto||{};Ste.subtle||Ste.webkitSubtle;const kI=JO("000000000000000000000000000000007e81a58181bd99817e00000000007effdbffffc3e7ff7e0000000000006cfefefefe7c381000000000000010387cfe7c3810000000000000183c3ce7e7e718183c0000000000183c7effff7e18183c0000000000000000183c3c180000000000ffffffffffe7c3c3e7ffffffffff000000003c664242663c00000000ffffffffc399bdbd99c3ffffffff00001e0e1a3278cccccc7800000000003c6666663c187e181800000000003f333f30303070f0e000000000007f637f63636367e7e6c0000000001818db3ce73cdb1818000000000080c0e0f8fef8e0c080000000000002060e3efe3e0e06020000000000183c7e1818187e3c18000000000066666666666600666600000000007fdbdbdb7b1b1b1b1b000000007cc660386cc6c66c380cc67c000000000000000000fefefe0000000000183c7e1818187e3c187e00000000183c7e18181818181800000000001818181818187e3c1800000000000000180cfe0c180000000000000000003060fe603000000000000000000000c0c0c0fe000000000000000000286cfe6c2800000000000000001038387c7cfefe00000000000000fefe7c7c3838100000000000000000000000000000000000000000183c3c3c1818001818000000006666662400000000000000000000006c6cfe6c6c6cfe6c6c00000018187cc6c2c07c0686c67c18180000000000c2c60c183066c60000000000386c6c3876dccccc76000000003030306000000000000000000000000c183030303030180c000000000030180c0c0c0c0c183000000000000000663cff3c6600000000000000000018187e181800000000000000000000000000181818300000000000000000fe000000000000000000000000000000001818000000000002060c183060c0800000000000007cc6cedef6e6c6c67c000000000018387818181818187e00000000007cc6060c183060c6fe00000000007cc606063c0606c67c00000000000c1c3c6cccfe0c0c1e0000000000fec0c0c0fc0606c67c00000000003860c0c0fcc6c6c67c0000000000fec6060c183030303000000000007cc6c6c67cc6c6c67c00000000007cc6c6c67e06060c78000000000000181800000018180000000000000018180000001818300000000000060c18306030180c0600000000000000007e00007e000000000000006030180c060c18306000000000007cc6c60c181800181800000000007cc6c6dedededcc07c000000000010386cc6c6fec6c6c60000000000fc6666667c666666fc00000000003c66c2c0c0c0c2663c0000000000f86c66666666666cf80000000000fe66626878686266fe0000000000fe66626878686060f000000000003c66c2c0c0dec6663a0000000000c6c6c6c6fec6c6c6c600000000003c181818181818183c00000000001e0c0c0c0c0ccccc780000000000e6666c6c786c6c66e60000000000f060606060606266fe0000000000c6eefefed6c6c6c6c60000000000c6e6f6fedecec6c6c60000000000386cc6c6c6c6c66c380000000000fc6666667c606060f000000000007cc6c6c6c6d6de7c0c0e00000000fc6666667c6c6666e600000000007cc6c660380cc6c67c00000000007e7e5a18181818183c0000000000c6c6c6c6c6c6c6c67c0000000000c6c6c6c6c6c66c38100000000000c6c6c6c6d6d6fe7c6c0000000000c6c66c3838386cc6c60000000000666666663c1818183c0000000000fec68c183060c2c6fe00000000003c303030303030303c000000000080c0e070381c0e060200000000003c0c0c0c0c0c0c0c3c00000010386cc600000000000000000000000000000000000000000000ff0030301800000000000000000000000000000000780c7ccccc760000000000e06060786c6666667c00000000000000007cc6c0c0c67c00000000001c0c0c3c6ccccccc7600000000000000007cc6fec0c67c0000000000386c6460f0606060f0000000000000000076cccccc7c0ccc78000000e060606c76666666e6000000000018180038181818183c00000000000606000e0606060666663c000000e06060666c786c66e6000000000038181818181818183c0000000000000000ecfed6d6d6c60000000000000000dc666666666600000000000000007cc6c6c6c67c0000000000000000dc6666667c6060f000000000000076cccccc7c0c0c1e000000000000dc76666060f000000000000000007cc6701cc67c0000000000103030fc303030361c0000000000000000cccccccccc760000000000000000666666663c180000000000000000c6c6d6d6fe6c0000000000000000c66c38386cc60000000000000000c6c6c6c67e060cf8000000000000fecc183066fe00000000000e181818701818180e00000000001818181800181818180000000000701818180e18181870000000000076dc000000000000000000000000000010386cc6c6fe0000000000003c66c2c0c0c2663c0c067c000000cccc00cccccccccc76000000000c1830007cc6fec0c67c0000000010386c00780c7ccccc760000000000cccc00780c7ccccc760000000060301800780c7ccccc7600000000386c3800780c7ccccc76000000000000003c6660663c0c063c00000010386c007cc6fec0c67c0000000000cccc007cc6fec0c67c00000000603018007cc6fec0c67c000000000066660038181818183c00000000183c660038181818183c000000006030180038181818183c00000000c6c610386cc6c6fec6c6000000386c3800386cc6c6fec6c600000018306000fe66607c6066fe00000000000000cc76367ed8d86e00000000003e6cccccfeccccccce0000000010386c007cc6c6c6c67c0000000000c6c6007cc6c6c6c67c00000000603018007cc6c6c6c67c000000003078cc00cccccccccc760000000060301800cccccccccc760000000000c6c600c6c6c6c67e060c780000c6c6386cc6c6c6c66c3800000000c6c600c6c6c6c6c6c67c0000000018183c666060663c181800000000386c6460f0606060e6fc000000000066663c187e187e181800000000f8ccccf8c4ccdeccccc6000000000e1b1818187e18181818d870000018306000780c7ccccc76000000000c18300038181818183c00000000183060007cc6c6c6c67c0000000018306000cccccccccc76000000000076dc00dc666666666600000076dc00c6e6f6fedecec6c6000000003c6c6c3e007e0000000000000000386c6c38007c000000000000000000303000303060c6c67c000000000000000000fec0c0c000000000000000000000fe0606060000000000c0c0c6ccd83060dc860c183e0000c0c0c6ccd83066ce9e3e060600000018180018183c3c3c1800000000000000366cd86c36000000000000000000d86c366cd80000000000114411441144114411441144114455aa55aa55aa55aa55aa55aa55aadd77dd77dd77dd77dd77dd77dd77181818181818181818181818181818181818181818f81818181818181818181818f818f818181818181836363636363636f636363636363600000000000000fe3636363636360000000000f818f81818181818183636363636f606f636363636363636363636363636363636363636360000000000fe06f63636363636363636363636f606fe00000000000036363636363636fe0000000000001818181818f818f800000000000000000000000000f8181818181818181818181818181f00000000000018181818181818ff00000000000000000000000000ff181818181818181818181818181f18181818181800000000000000ff00000000000018181818181818ff18181818181818181818181f181f1818181818183636363636363637363636363636363636363637303f00000000000000000000003f30373636363636363636363636f700ff0000000000000000000000ff00f736363636363636363636363730373636363636360000000000ff00ff0000000000003636363636f700f73636363636361818181818ff00ff00000000000036363636363636ff0000000000000000000000ff00ff18181818181800000000000000ff363636363636363636363636363f00000000000018181818181f181f00000000000000000000001f181f181818181818000000000000003f36363636363636363636363636ff3636363636361818181818ff18ff18181818181818181818181818f8000000000000000000000000001f181818181818ffffffffffffffffffffffffffff00000000000000fffffffffffffff0f0f0f0f0f0f0f0f0f0f0f0f0f00f0f0f0f0f0f0f0f0f0f0f0f0f0fffffffffffffff00000000000000000000000076dcd8d8dc76000000000000007cc6fcc6c6fcc0c040000000fec6c6c0c0c0c0c0c000000000000000fe6c6c6c6c6c6c0000000000fec66030183060c6fe00000000000000007ed8d8d8d87000000000000000666666667c6060c000000000000076dc181818181800000000007e183c6666663c187e0000000000386cc6c6fec6c66c380000000000386cc6c6c66c6c6cee00000000001e30180c3e6666663c00000000000000007edbdb7e0000000000000003067edbdbf37e60c000000000001c3060607c6060301c0000000000007cc6c6c6c6c6c6c6000000000000fe0000fe0000fe0000000000000018187e18180000ff000000000030180c060c1830007e00000000000c18306030180c007e00000000000e1b1b1818181818181818181818181818181818d8d8700000000000001818007e001818000000000000000076dc0076dc000000000000386c6c3800000000000000000000000000000018180000000000000000000000000018000000000000000f0c0c0c0c0cec6c3c1c00000000d86c6c6c6c6c000000000000000070d83060c8f800000000000000000000007c7c7c7c7c7c000000000000000000000000000000000000"),PA=JO("00000000002a002a00002a2a2a00002a002a2a15002a2a2a15151515153f153f15153f3f3f15153f153f3f3f153f3f3f"),um=globalThis||void 0||self;var Cpe=typeof um=="object"&&um&&um.Object===Object&&um,I6e=typeof self=="object"&&self&&self.Object===Object&&self,p0=Cpe||I6e||Function("return this")(),vp=p0.Symbol,Ape=Object.prototype,k6e=Ape.hasOwnProperty,D6e=Ape.toString,PR=vp?vp.toStringTag:void 0;function P6e(t){var e=k6e.call(t,PR),n=t[PR];try{t[PR]=void 0;var i=!0}catch{}var r=D6e.call(t);return i&&(e?t[PR]=n:delete t[PR]),r}var L6e=Object.prototype,U6e=L6e.toString;function B6e(t){return U6e.call(t)}var F6e="[object Null]",z6e="[object Undefined]",Tte=vp?vp.toStringTag:void 0;function SE(t){return t==null?t===void 0?z6e:F6e:Tte&&Tte in Object(t)?P6e(t):B6e(t)}function gm(t){return t!=null&&typeof t=="object"}var H6e="[object Symbol]";function pF(t){return typeof t=="symbol"||gm(t)&&SE(t)==H6e}function mF(t,e){for(var n=-1,i=t==null?0:t.length,r=Array(i);++n<i;)r[n]=e(t[n],n,t);return r}var $r=Array.isArray,j6e=1/0,xte=vp?vp.prototype:void 0,wte=xte?xte.toString:void 0;function Rpe(t){if(typeof t=="string")return t;if($r(t))return mF(t,Rpe)+"";if(pF(t))return wte?wte.call(t):"";var e=t+"";return e=="0"&&1/t==-j6e?"-0":e}var V6e=/\s/;function G6e(t){for(var e=t.length;e--&&V6e.test(t.charAt(e)););return e}var q6e=/^\s+/;function $6e(t){return t&&t.slice(0,G6e(t)+1).replace(q6e,"")}function _p(t){var e=typeof t;return t!=null&&(e=="object"||e=="function")}var Cte=NaN,W6e=/^[-+]0x[0-9a-f]+$/i,Y6e=/^0b[01]+$/i,X6e=/^0o[0-7]+$/i,K6e=parseInt;function Z6e(t){if(typeof t=="number")return t;if(pF(t))return Cte;if(_p(t)){var e=typeof t.valueOf=="function"?t.valueOf():t;t=_p(e)?e+"":e}if(typeof t!="string")return t===0?t:+t;t=$6e(t);var n=Y6e.test(t);return n||X6e.test(t)?K6e(t.slice(2),n?2:8):W6e.test(t)?Cte:+t}var Ate=1/0,J6e=17976931348623157e292;function Q6e(t){if(!t)return t===0?t:0;if(t=Z6e(t),t===Ate||t===-Ate){var e=t<0?-1:1;return e*J6e}return t===t?t:0}function gF(t){var e=Q6e(t),n=e%1;return e===e?n?e-n:e:0}function zC(t){return t}var e4e="[object AsyncFunction]",t4e="[object Function]",n4e="[object GeneratorFunction]",i4e="[object Proxy]";function k_(t){if(!_p(t))return!1;var e=SE(t);return e==t4e||e==n4e||e==e4e||e==i4e}var C5=p0["__core-js_shared__"],Rte=function(){var t=/[^.]+$/.exec(C5&&C5.keys&&C5.keys.IE_PROTO||"");return t?"Symbol(src)_1."+t:""}();function r4e(t){return!!Rte&&Rte in t}var s4e=Function.prototype,a4e=s4e.toString;function x1(t){if(t!=null){try{return a4e.call(t)}catch{}try{return t+""}catch{}}return""}var o4e=/[\\^$.*+?()[\]{}|]/g,c4e=/^\[object .+?Constructor\]$/,l4e=Function.prototype,u4e=Object.prototype,h4e=l4e.toString,f4e=u4e.hasOwnProperty,d4e=RegExp("^"+h4e.call(f4e).replace(o4e,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function p4e(t){if(!_p(t)||r4e(t))return!1;var e=k_(t)?d4e:c4e;return e.test(x1(t))}function m4e(t,e){return t==null?void 0:t[e]}function w1(t,e){var n=m4e(t,e);return p4e(n)?n:void 0}var WG=w1(p0,"WeakMap"),Mte=Object.create,g4e=function(){function t(){}return function(e){if(!_p(e))return{};if(Mte)return Mte(e);t.prototype=e;var n=new t;return t.prototype=void 0,n}}();function v4e(t,e,n){switch(n.length){case 0:return t.call(e);case 1:return t.call(e,n[0]);case 2:return t.call(e,n[0],n[1]);case 3:return t.call(e,n[0],n[1],n[2])}return t.apply(e,n)}function Oc(){}function _4e(t,e){var n=-1,i=t.length;for(e||(e=Array(i));++n<i;)e[n]=t[n];return e}var y4e=800,b4e=16,E4e=Date.now;function S4e(t){var e=0,n=0;return function(){var i=E4e(),r=b4e-(i-n);if(n=i,r>0){if(++e>=y4e)return arguments[0]}else e=0;return t.apply(void 0,arguments)}}function T4e(t){return function(){return t}}var BU=function(){try{var t=w1(Object,"defineProperty");return t({},"",{}),t}catch{}}(),x4e=BU?function(t,e){return BU(t,"toString",{configurable:!0,enumerable:!1,value:T4e(e),writable:!0})}:zC,w4e=S4e(x4e);function Mpe(t,e){for(var n=-1,i=t==null?0:t.length;++n<i&&e(t[n],n,t)!==!1;);return t}function Ope(t,e,n,i){for(var r=t.length,s=n+-1;++s<r;)if(e(t[s],s,t))return s;return-1}function C4e(t){return t!==t}function A4e(t,e,n){for(var i=n-1,r=t.length;++i<r;)if(t[i]===e)return i;return-1}function f9(t,e,n){return e===e?A4e(t,e,n):Ope(t,C4e,n)}function Npe(t,e){var n=t==null?0:t.length;return!!n&&f9(t,e,0)>-1}var R4e=9007199254740991,M4e=/^(?:0|[1-9]\d*)$/;function vF(t,e){var n=typeof t;return e=e??R4e,!!e&&(n=="number"||n!="symbol"&&M4e.test(t))&&t>-1&&t%1==0&&t<e}function d9(t,e,n){e=="__proto__"&&BU?BU(t,e,{configurable:!0,enumerable:!0,value:n,writable:!0}):t[e]=n}function DI(t,e){return t===e||t!==t&&e!==e}var O4e=Object.prototype,N4e=O4e.hasOwnProperty;function _F(t,e,n){var i=t[e];(!(N4e.call(t,e)&&DI(i,n))||n===void 0&&!(e in t))&&d9(t,e,n)}function p9(t,e,n,i){var r=!n;n||(n={});for(var s=-1,a=e.length;++s<a;){var o=e[s],c=void 0;c===void 0&&(c=t[o]),r?d9(n,o,c):_F(n,o,c)}return n}var Ote=Math.max;function I4e(t,e,n){return e=Ote(e===void 0?t.length-1:e,0),function(){for(var i=arguments,r=-1,s=Ote(i.length-e,0),a=Array(s);++r<s;)a[r]=i[e+r];r=-1;for(var o=Array(e+1);++r<e;)o[r]=i[r];return o[e]=n(a),v4e(t,this,o)}}function m9(t,e){return w4e(I4e(t,e,zC),t+"")}var k4e=9007199254740991;function g9(t){return typeof t=="number"&&t>-1&&t%1==0&&t<=k4e}function m0(t){return t!=null&&g9(t.length)&&!k_(t)}function Ipe(t,e,n){if(!_p(n))return!1;var i=typeof e;return(i=="number"?m0(n)&&vF(e,n.length):i=="string"&&e in n)?DI(n[e],t):!1}function D4e(t){return m9(function(e,n){var i=-1,r=n.length,s=r>1?n[r-1]:void 0,a=r>2?n[2]:void 0;for(s=t.length>3&&typeof s=="function"?(r--,s):void 0,a&&Ipe(n[0],n[1],a)&&(s=r<3?void 0:s,r=1),e=Object(e);++i<r;){var o=n[i];o&&t(e,o,i,s)}return e})}var P4e=Object.prototype;function PI(t){var e=t&&t.constructor,n=typeof e=="function"&&e.prototype||P4e;return t===n}function L4e(t,e){for(var n=-1,i=Array(t);++n<t;)i[n]=e(n);return i}var U4e="[object Arguments]";function Nte(t){return gm(t)&&SE(t)==U4e}var kpe=Object.prototype,B4e=kpe.hasOwnProperty,F4e=kpe.propertyIsEnumerable,yF=Nte(function(){return arguments}())?Nte:function(t){return gm(t)&&B4e.call(t,"callee")&&!F4e.call(t,"callee")};function z4e(){return!1}var Dpe=typeof exports=="object"&&exports&&!exports.nodeType&&exports,Ite=Dpe&&typeof module=="object"&&module&&!module.nodeType&&module,H4e=Ite&&Ite.exports===Dpe,kte=H4e?p0.Buffer:void 0,j4e=kte?kte.isBuffer:void 0,QO=j4e||z4e,V4e="[object Arguments]",G4e="[object Array]",q4e="[object Boolean]",$4e="[object Date]",W4e="[object Error]",Y4e="[object Function]",X4e="[object Map]",K4e="[object Number]",Z4e="[object Object]",J4e="[object RegExp]",Q4e="[object Set]",eze="[object String]",tze="[object WeakMap]",nze="[object ArrayBuffer]",ize="[object DataView]",rze="[object Float32Array]",sze="[object Float64Array]",aze="[object Int8Array]",oze="[object Int16Array]",cze="[object Int32Array]",lze="[object Uint8Array]",uze="[object Uint8ClampedArray]",hze="[object Uint16Array]",fze="[object Uint32Array]",_a={};_a[rze]=_a[sze]=_a[aze]=_a[oze]=_a[cze]=_a[lze]=_a[uze]=_a[hze]=_a[fze]=!0;_a[V4e]=_a[G4e]=_a[nze]=_a[q4e]=_a[ize]=_a[$4e]=_a[W4e]=_a[Y4e]=_a[X4e]=_a[K4e]=_a[Z4e]=_a[J4e]=_a[Q4e]=_a[eze]=_a[tze]=!1;function dze(t){return gm(t)&&g9(t.length)&&!!_a[SE(t)]}function bF(t){return function(e){return t(e)}}var Ppe=typeof exports=="object"&&exports&&!exports.nodeType&&exports,$M=Ppe&&typeof module=="object"&&module&&!module.nodeType&&module,pze=$M&&$M.exports===Ppe,A5=pze&&Cpe.process,Kb=function(){try{var t=$M&&$M.require&&$M.require("util").types;return t||A5&&A5.binding&&A5.binding("util")}catch{}}(),Dte=Kb&&Kb.isTypedArray,v9=Dte?bF(Dte):dze,mze=Object.prototype,gze=mze.hasOwnProperty;function Lpe(t,e){var n=$r(t),i=!n&&yF(t),r=!n&&!i&&QO(t),s=!n&&!i&&!r&&v9(t),a=n||i||r||s,o=a?L4e(t.length,String):[],c=o.length;for(var l in t)(e||gze.call(t,l))&&!(a&&(l=="length"||r&&(l=="offset"||l=="parent")||s&&(l=="buffer"||l=="byteLength"||l=="byteOffset")||vF(l,c)))&&o.push(l);return o}function Upe(t,e){return function(n){return t(e(n))}}var vze=Upe(Object.keys,Object),_ze=Object.prototype,yze=_ze.hasOwnProperty;function Bpe(t){if(!PI(t))return vze(t);var e=[];for(var n in Object(t))yze.call(t,n)&&n!="constructor"&&e.push(n);return e}function yp(t){return m0(t)?Lpe(t):Bpe(t)}var bze=Object.prototype,Eze=bze.hasOwnProperty,af=D4e(function(t,e){if(PI(e)||m0(e)){p9(e,yp(e),t);return}for(var n in e)Eze.call(e,n)&&_F(t,n,e[n])});function Sze(t){var e=[];if(t!=null)for(var n in Object(t))e.push(n);return e}var Tze=Object.prototype,xze=Tze.hasOwnProperty;function wze(t){if(!_p(t))return Sze(t);var e=PI(t),n=[];for(var i in t)i=="constructor"&&(e||!xze.call(t,i))||n.push(i);return n}function Fpe(t){return m0(t)?Lpe(t,!0):wze(t)}var Cze=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Aze=/^\w*$/;function _9(t,e){if($r(t))return!1;var n=typeof t;return n=="number"||n=="symbol"||n=="boolean"||t==null||pF(t)?!0:Aze.test(t)||!Cze.test(t)||e!=null&&t in Object(e)}var eN=w1(Object,"create");function Rze(){this.__data__=eN?eN(null):{},this.size=0}function Mze(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e}var Oze="__lodash_hash_undefined__",Nze=Object.prototype,Ize=Nze.hasOwnProperty;function kze(t){var e=this.__data__;if(eN){var n=e[t];return n===Oze?void 0:n}return Ize.call(e,t)?e[t]:void 0}var Dze=Object.prototype,Pze=Dze.hasOwnProperty;function Lze(t){var e=this.__data__;return eN?e[t]!==void 0:Pze.call(e,t)}var Uze="__lodash_hash_undefined__";function Bze(t,e){var n=this.__data__;return this.size+=this.has(t)?0:1,n[t]=eN&&e===void 0?Uze:e,this}function qT(t){var e=-1,n=t==null?0:t.length;for(this.clear();++e<n;){var i=t[e];this.set(i[0],i[1])}}qT.prototype.clear=Rze;qT.prototype.delete=Mze;qT.prototype.get=kze;qT.prototype.has=Lze;qT.prototype.set=Bze;function Fze(){this.__data__=[],this.size=0}function EF(t,e){for(var n=t.length;n--;)if(DI(t[n][0],e))return n;return-1}var zze=Array.prototype,Hze=zze.splice;function jze(t){var e=this.__data__,n=EF(e,t);if(n<0)return!1;var i=e.length-1;return n==i?e.pop():Hze.call(e,n,1),--this.size,!0}function Vze(t){var e=this.__data__,n=EF(e,t);return n<0?void 0:e[n][1]}function Gze(t){return EF(this.__data__,t)>-1}function qze(t,e){var n=this.__data__,i=EF(n,t);return i<0?(++this.size,n.push([t,e])):n[i][1]=e,this}function D_(t){var e=-1,n=t==null?0:t.length;for(this.clear();++e<n;){var i=t[e];this.set(i[0],i[1])}}D_.prototype.clear=Fze;D_.prototype.delete=jze;D_.prototype.get=Vze;D_.prototype.has=Gze;D_.prototype.set=qze;var tN=w1(p0,"Map");function $ze(){this.size=0,this.__data__={hash:new qT,map:new(tN||D_),string:new qT}}function Wze(t){var e=typeof t;return e=="string"||e=="number"||e=="symbol"||e=="boolean"?t!=="__proto__":t===null}function SF(t,e){var n=t.__data__;return Wze(e)?n[typeof e=="string"?"string":"hash"]:n.map}function Yze(t){var e=SF(this,t).delete(t);return this.size-=e?1:0,e}function Xze(t){return SF(this,t).get(t)}function Kze(t){return SF(this,t).has(t)}function Zze(t,e){var n=SF(this,t),i=n.size;return n.set(t,e),this.size+=n.size==i?0:1,this}function P_(t){var e=-1,n=t==null?0:t.length;for(this.clear();++e<n;){var i=t[e];this.set(i[0],i[1])}}P_.prototype.clear=$ze;P_.prototype.delete=Yze;P_.prototype.get=Xze;P_.prototype.has=Kze;P_.prototype.set=Zze;var Jze="Expected a function";function y9(t,e){if(typeof t!="function"||e!=null&&typeof e!="function")throw new TypeError(Jze);var n=function(){var i=arguments,r=e?e.apply(this,i):i[0],s=n.cache;if(s.has(r))return s.get(r);var a=t.apply(this,i);return n.cache=s.set(r,a)||s,a};return n.cache=new(y9.Cache||P_),n}y9.Cache=P_;var Qze=500;function e8e(t){var e=y9(t,function(i){return n.size===Qze&&n.clear(),i}),n=e.cache;return e}var t8e=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,n8e=/\\(\\)?/g,i8e=e8e(function(t){var e=[];return t.charCodeAt(0)===46&&e.push(""),t.replace(t8e,function(n,i,r,s){e.push(r?s.replace(n8e,"$1"):i||n)}),e});function zpe(t){return t==null?"":Rpe(t)}function TF(t,e){return $r(t)?t:_9(t,e)?[t]:i8e(zpe(t))}var r8e=1/0;function LI(t){if(typeof t=="string"||pF(t))return t;var e=t+"";return e=="0"&&1/t==-r8e?"-0":e}function b9(t,e){e=TF(e,t);for(var n=0,i=e.length;t!=null&&n<i;)t=t[LI(e[n++])];return n&&n==i?t:void 0}function s8e(t,e,n){var i=t==null?void 0:b9(t,e);return i===void 0?n:i}function E9(t,e){for(var n=-1,i=e.length,r=t.length;++n<i;)t[r+n]=e[n];return t}var Pte=vp?vp.isConcatSpreadable:void 0;function a8e(t){return $r(t)||yF(t)||!!(Pte&&t&&t[Pte])}function S9(t,e,n,i,r){var s=-1,a=t.length;for(n||(n=a8e),r||(r=[]);++s<a;){var o=t[s];n(o)?E9(r,o):i||(r[r.length]=o)}return r}function ef(t){var e=t==null?0:t.length;return e?S9(t):[]}var Hpe=Upe(Object.getPrototypeOf,Object);function T9(t,e,n){var i=-1,r=t.length;e<0&&(e=-e>r?0:r+e),n=n>r?r:n,n<0&&(n+=r),r=e>n?0:n-e>>>0,e>>>=0;for(var s=Array(r);++i<r;)s[i]=t[i+e];return s}function o8e(t,e,n){var i=t.length;return n=n===void 0?i:n,!e&&n>=i?t:T9(t,e,n)}var c8e="\\ud800-\\udfff",l8e="\\u0300-\\u036f",u8e="\\ufe20-\\ufe2f",h8e="\\u20d0-\\u20ff",f8e=l8e+u8e+h8e,d8e="\\ufe0e\\ufe0f",p8e="\\u200d",m8e=RegExp("["+p8e+c8e+f8e+d8e+"]");function jpe(t){return m8e.test(t)}function g8e(t){return t.split("")}var Vpe="\\ud800-\\udfff",v8e="\\u0300-\\u036f",_8e="\\ufe20-\\ufe2f",y8e="\\u20d0-\\u20ff",b8e=v8e+_8e+y8e,E8e="\\ufe0e\\ufe0f",S8e="["+Vpe+"]",YG="["+b8e+"]",XG="\\ud83c[\\udffb-\\udfff]",T8e="(?:"+YG+"|"+XG+")",Gpe="[^"+Vpe+"]",qpe="(?:\\ud83c[\\udde6-\\uddff]){2}",$pe="[\\ud800-\\udbff][\\udc00-\\udfff]",x8e="\\u200d",Wpe=T8e+"?",Ype="["+E8e+"]?",w8e="(?:"+x8e+"(?:"+[Gpe,qpe,$pe].join("|")+")"+Ype+Wpe+")*",C8e=Ype+Wpe+w8e,A8e="(?:"+[Gpe+YG+"?",YG,qpe,$pe,S8e].join("|")+")",R8e=RegExp(XG+"(?="+XG+")|"+A8e+C8e,"g");function M8e(t){return t.match(R8e)||[]}function O8e(t){return jpe(t)?M8e(t):g8e(t)}function N8e(t){return function(e){e=zpe(e);var n=jpe(e)?O8e(e):void 0,i=n?n[0]:e.charAt(0),r=n?o8e(n,1).join(""):e.slice(1);return i[t]()+r}}var Xpe=N8e("toUpperCase");function I8e(t,e,n,i){var r=-1,s=t==null?0:t.length;for(i&&s&&(n=t[++r]);++r<s;)n=e(n,t[r],r,t);return n}function k8e(){this.__data__=new D_,this.size=0}function D8e(t){var e=this.__data__,n=e.delete(t);return this.size=e.size,n}function P8e(t){return this.__data__.get(t)}function L8e(t){return this.__data__.has(t)}var U8e=200;function B8e(t,e){var n=this.__data__;if(n instanceof D_){var i=n.__data__;if(!tN||i.length<U8e-1)return i.push([t,e]),this.size=++n.size,this;n=this.__data__=new P_(i)}return n.set(t,e),this.size=n.size,this}function $g(t){var e=this.__data__=new D_(t);this.size=e.size}$g.prototype.clear=k8e;$g.prototype.delete=D8e;$g.prototype.get=P8e;$g.prototype.has=L8e;$g.prototype.set=B8e;function F8e(t,e){return t&&p9(e,yp(e),t)}var Kpe=typeof exports=="object"&&exports&&!exports.nodeType&&exports,Lte=Kpe&&typeof module=="object"&&module&&!module.nodeType&&module,z8e=Lte&&Lte.exports===Kpe,Ute=z8e?p0.Buffer:void 0,Bte=Ute?Ute.allocUnsafe:void 0;function H8e(t,e){var n=t.length,i=Bte?Bte(n):new t.constructor(n);return t.copy(i),i}function x9(t,e){for(var n=-1,i=t==null?0:t.length,r=0,s=[];++n<i;){var a=t[n];e(a,n,t)&&(s[r++]=a)}return s}function Zpe(){return[]}var j8e=Object.prototype,V8e=j8e.propertyIsEnumerable,Fte=Object.getOwnPropertySymbols,w9=Fte?function(t){return t==null?[]:(t=Object(t),x9(Fte(t),function(e){return V8e.call(t,e)}))}:Zpe;function G8e(t,e){return p9(t,w9(t),e)}var q8e=Object.getOwnPropertySymbols,$8e=q8e?function(t){for(var e=[];t;)E9(e,w9(t)),t=Hpe(t);return e}:Zpe;function Jpe(t,e,n){var i=e(t);return $r(t)?i:E9(i,n(t))}function KG(t){return Jpe(t,yp,w9)}function W8e(t){return Jpe(t,Fpe,$8e)}var ZG=w1(p0,"DataView"),JG=w1(p0,"Promise"),Jw=w1(p0,"Set"),zte="[object Map]",Y8e="[object Object]",Hte="[object Promise]",jte="[object Set]",Vte="[object WeakMap]",Gte="[object DataView]",X8e=x1(ZG),K8e=x1(tN),Z8e=x1(JG),J8e=x1(Jw),Q8e=x1(WG),qd=SE;(ZG&&qd(new ZG(new ArrayBuffer(1)))!=Gte||tN&&qd(new tN)!=zte||JG&&qd(JG.resolve())!=Hte||Jw&&qd(new Jw)!=jte||WG&&qd(new WG)!=Vte)&&(qd=function(t){var e=SE(t),n=e==Y8e?t.constructor:void 0,i=n?x1(n):"";if(i)switch(i){case X8e:return Gte;case K8e:return zte;case Z8e:return Hte;case J8e:return jte;case Q8e:return Vte}return e});var eHe=Object.prototype,tHe=eHe.hasOwnProperty;function nHe(t){var e=t.length,n=new t.constructor(e);return e&&typeof t[0]=="string"&&tHe.call(t,"index")&&(n.index=t.index,n.input=t.input),n}var FU=p0.Uint8Array;function iHe(t){var e=new t.constructor(t.byteLength);return new FU(e).set(new FU(t)),e}function rHe(t,e){var n=t.buffer;return new t.constructor(n,t.byteOffset,t.byteLength)}var sHe=/\w*$/;function aHe(t){var e=new t.constructor(t.source,sHe.exec(t));return e.lastIndex=t.lastIndex,e}var qte=vp?vp.prototype:void 0,$te=qte?qte.valueOf:void 0;function oHe(t){return $te?Object($te.call(t)):{}}function cHe(t,e){var n=t.buffer;return new t.constructor(n,t.byteOffset,t.length)}var lHe="[object Boolean]",uHe="[object Date]",hHe="[object Map]",fHe="[object Number]",dHe="[object RegExp]",pHe="[object Set]",mHe="[object String]",gHe="[object Symbol]",vHe="[object ArrayBuffer]",_He="[object DataView]",yHe="[object Float32Array]",bHe="[object Float64Array]",EHe="[object Int8Array]",SHe="[object Int16Array]",THe="[object Int32Array]",xHe="[object Uint8Array]",wHe="[object Uint8ClampedArray]",CHe="[object Uint16Array]",AHe="[object Uint32Array]";function RHe(t,e,n){var i=t.constructor;switch(e){case vHe:return iHe(t);case lHe:case uHe:return new i(+t);case _He:return rHe(t);case yHe:case bHe:case EHe:case SHe:case THe:case xHe:case wHe:case CHe:case AHe:return cHe(t);case hHe:return new i;case fHe:case mHe:return new i(t);case dHe:return aHe(t);case pHe:return new i;case gHe:return oHe(t)}}function MHe(t){return typeof t.constructor=="function"&&!PI(t)?g4e(Hpe(t)):{}}var OHe="[object Map]";function NHe(t){return gm(t)&&qd(t)==OHe}var Wte=Kb&&Kb.isMap,IHe=Wte?bF(Wte):NHe,kHe="[object Set]";function DHe(t){return gm(t)&&qd(t)==kHe}var Yte=Kb&&Kb.isSet,PHe=Yte?bF(Yte):DHe,Qpe="[object Arguments]",LHe="[object Array]",UHe="[object Boolean]",BHe="[object Date]",FHe="[object Error]",eme="[object Function]",zHe="[object GeneratorFunction]",HHe="[object Map]",jHe="[object Number]",tme="[object Object]",VHe="[object RegExp]",GHe="[object Set]",qHe="[object String]",$He="[object Symbol]",WHe="[object WeakMap]",YHe="[object ArrayBuffer]",XHe="[object DataView]",KHe="[object Float32Array]",ZHe="[object Float64Array]",JHe="[object Int8Array]",QHe="[object Int16Array]",e5e="[object Int32Array]",t5e="[object Uint8Array]",n5e="[object Uint8ClampedArray]",i5e="[object Uint16Array]",r5e="[object Uint32Array]",ia={};ia[Qpe]=ia[LHe]=ia[YHe]=ia[XHe]=ia[UHe]=ia[BHe]=ia[KHe]=ia[ZHe]=ia[JHe]=ia[QHe]=ia[e5e]=ia[HHe]=ia[jHe]=ia[tme]=ia[VHe]=ia[GHe]=ia[qHe]=ia[$He]=ia[t5e]=ia[n5e]=ia[i5e]=ia[r5e]=!0;ia[FHe]=ia[eme]=ia[WHe]=!1;function _2(t,e,n,i,r,s){var a;if(a!==void 0)return a;if(!_p(t))return t;var o=$r(t);if(o)return a=nHe(t),_4e(t,a);var c=qd(t),l=c==eme||c==zHe;if(QO(t))return H8e(t);if(c==tme||c==Qpe||l&&!r)return a=l?{}:MHe(t),G8e(t,F8e(a,t));if(!ia[c])return r?t:{};a=RHe(t,c),s||(s=new $g);var u=s.get(t);if(u)return u;s.set(t,a),PHe(t)?t.forEach(function(d){a.add(_2(d,e,n,d,t,s))}):IHe(t)&&t.forEach(function(d,p){a.set(p,_2(d,e,n,p,t,s))});var h=KG,f=o?void 0:h(t);return Mpe(f||t,function(d,p){f&&(p=d,d=t[p]),_F(a,p,_2(d,e,n,p,t,s))}),a}var s5e=4;function Gl(t){return _2(t,s5e)}function UI(t){for(var e=-1,n=t==null?0:t.length,i=0,r=[];++e<n;){var s=t[e];s&&(r[i++]=s)}return r}var a5e="__lodash_hash_undefined__";function o5e(t){return this.__data__.set(t,a5e),this}function c5e(t){return this.__data__.has(t)}function HC(t){var e=-1,n=t==null?0:t.length;for(this.__data__=new P_;++e<n;)this.add(t[e])}HC.prototype.add=HC.prototype.push=o5e;HC.prototype.has=c5e;function nme(t,e){for(var n=-1,i=t==null?0:t.length;++n<i;)if(e(t[n],n,t))return!0;return!1}function C9(t,e){return t.has(e)}var l5e=1,u5e=2;function ime(t,e,n,i,r,s){var a=n&l5e,o=t.length,c=e.length;if(o!=c&&!(a&&c>o))return!1;var l=s.get(t),u=s.get(e);if(l&&u)return l==e&&u==t;var h=-1,f=!0,d=n&u5e?new HC:void 0;for(s.set(t,e),s.set(e,t);++h<o;){var p=t[h],g=e[h];if(i)var y=a?i(g,p,h,e,t,s):i(p,g,h,t,e,s);if(y!==void 0){if(y)continue;f=!1;break}if(d){if(!nme(e,function(v,b){if(!C9(d,b)&&(p===v||r(p,v,n,i,s)))return d.push(b)})){f=!1;break}}else if(!(p===g||r(p,g,n,i,s))){f=!1;break}}return s.delete(t),s.delete(e),f}function h5e(t){var e=-1,n=Array(t.size);return t.forEach(function(i,r){n[++e]=[r,i]}),n}function A9(t){var e=-1,n=Array(t.size);return t.forEach(function(i){n[++e]=i}),n}var f5e=1,d5e=2,p5e="[object Boolean]",m5e="[object Date]",g5e="[object Error]",v5e="[object Map]",_5e="[object Number]",y5e="[object RegExp]",b5e="[object Set]",E5e="[object String]",S5e="[object Symbol]",T5e="[object ArrayBuffer]",x5e="[object DataView]",Xte=vp?vp.prototype:void 0,R5=Xte?Xte.valueOf:void 0;function w5e(t,e,n,i,r,s,a){switch(n){case x5e:if(t.byteLength!=e.byteLength||t.byteOffset!=e.byteOffset)return!1;t=t.buffer,e=e.buffer;case T5e:return!(t.byteLength!=e.byteLength||!s(new FU(t),new FU(e)));case p5e:case m5e:case _5e:return DI(+t,+e);case g5e:return t.name==e.name&&t.message==e.message;case y5e:case E5e:return t==e+"";case v5e:var o=h5e;case b5e:var c=i&f5e;if(o||(o=A9),t.size!=e.size&&!c)return!1;var l=a.get(t);if(l)return l==e;i|=d5e,a.set(t,e);var u=ime(o(t),o(e),i,r,s,a);return a.delete(t),u;case S5e:if(R5)return R5.call(t)==R5.call(e)}return!1}var C5e=1,A5e=Object.prototype,R5e=A5e.hasOwnProperty;function M5e(t,e,n,i,r,s){var a=n&C5e,o=KG(t),c=o.length,l=KG(e),u=l.length;if(c!=u&&!a)return!1;for(var h=c;h--;){var f=o[h];if(!(a?f in e:R5e.call(e,f)))return!1}var d=s.get(t),p=s.get(e);if(d&&p)return d==e&&p==t;var g=!0;s.set(t,e),s.set(e,t);for(var y=a;++h<c;){f=o[h];var v=t[f],b=e[f];if(i)var T=a?i(b,v,f,e,t,s):i(v,b,f,t,e,s);if(!(T===void 0?v===b||r(v,b,n,i,s):T)){g=!1;break}y||(y=f=="constructor")}if(g&&!y){var x=t.constructor,M=e.constructor;x!=M&&"constructor"in t&&"constructor"in e&&!(typeof x=="function"&&x instanceof x&&typeof M=="function"&&M instanceof M)&&(g=!1)}return s.delete(t),s.delete(e),g}var O5e=1,Kte="[object Arguments]",Zte="[object Array]",cP="[object Object]",N5e=Object.prototype,Jte=N5e.hasOwnProperty;function I5e(t,e,n,i,r,s){var a=$r(t),o=$r(e),c=a?Zte:qd(t),l=o?Zte:qd(e);c=c==Kte?cP:c,l=l==Kte?cP:l;var u=c==cP,h=l==cP,f=c==l;if(f&&QO(t)){if(!QO(e))return!1;a=!0,u=!1}if(f&&!u)return s||(s=new $g),a||v9(t)?ime(t,e,n,i,r,s):w5e(t,e,c,n,i,r,s);if(!(n&O5e)){var d=u&&Jte.call(t,"__wrapped__"),p=h&&Jte.call(e,"__wrapped__");if(d||p){var g=d?t.value():t,y=p?e.value():e;return s||(s=new $g),r(g,y,n,i,s)}}return f?(s||(s=new $g),M5e(t,e,n,i,r,s)):!1}function R9(t,e,n,i,r){return t===e?!0:t==null||e==null||!gm(t)&&!gm(e)?t!==t&&e!==e:I5e(t,e,n,i,R9,r)}var k5e=1,D5e=2;function P5e(t,e,n,i){var r=n.length,s=r;if(t==null)return!s;for(t=Object(t);r--;){var a=n[r];if(a[2]?a[1]!==t[a[0]]:!(a[0]in t))return!1}for(;++r<s;){a=n[r];var o=a[0],c=t[o],l=a[1];if(a[2]){if(c===void 0&&!(o in t))return!1}else{var u=new $g,h;if(!(h===void 0?R9(l,c,k5e|D5e,i,u):h))return!1}}return!0}function rme(t){return t===t&&!_p(t)}function L5e(t){for(var e=yp(t),n=e.length;n--;){var i=e[n],r=t[i];e[n]=[i,r,rme(r)]}return e}function sme(t,e){return function(n){return n==null?!1:n[t]===e&&(e!==void 0||t in Object(n))}}function U5e(t){var e=L5e(t);return e.length==1&&e[0][2]?sme(e[0][0],e[0][1]):function(n){return n===t||P5e(n,t,e)}}function B5e(t,e){return t!=null&&e in Object(t)}function ame(t,e,n){e=TF(e,t);for(var i=-1,r=e.length,s=!1;++i<r;){var a=LI(e[i]);if(!(s=t!=null&&n(t,a)))break;t=t[a]}return s||++i!=r?s:(r=t==null?0:t.length,!!r&&g9(r)&&vF(a,r)&&($r(t)||yF(t)))}function F5e(t,e){return t!=null&&ame(t,e,B5e)}var z5e=1,H5e=2;function j5e(t,e){return _9(t)&&rme(e)?sme(LI(t),e):function(n){var i=s8e(n,t);return i===void 0&&i===e?F5e(n,t):R9(e,i,z5e|H5e)}}function V5e(t){return function(e){return e==null?void 0:e[t]}}function G5e(t){return function(e){return b9(e,t)}}function q5e(t){return _9(t)?V5e(LI(t)):G5e(t)}function g0(t){return typeof t=="function"?t:t==null?zC:typeof t=="object"?$r(t)?j5e(t[0],t[1]):U5e(t):q5e(t)}function $5e(t,e,n,i){for(var r=-1,s=t==null?0:t.length;++r<s;){var a=t[r];e(i,a,n(a),t)}return i}function W5e(t){return function(e,n,i){for(var r=-1,s=Object(e),a=i(e),o=a.length;o--;){var c=a[++r];if(n(s[c],c,s)===!1)break}return e}}var Y5e=W5e();function X5e(t,e){return t&&Y5e(t,e,yp)}function K5e(t,e){return function(n,i){if(n==null)return n;if(!m0(n))return t(n,i);for(var r=n.length,s=-1,a=Object(n);++s<r&&i(a[s],s,a)!==!1;);return n}}var C1=K5e(X5e);function Z5e(t,e,n,i){return C1(t,function(r,s,a){e(i,r,n(r),a)}),i}function J5e(t,e){return function(n,i){var r=$r(n)?$5e:Z5e,s=e?e():{};return r(n,t,g0(i),s)}}var ome=Object.prototype,Q5e=ome.hasOwnProperty,M9=m9(function(t,e){t=Object(t);var n=-1,i=e.length,r=i>2?e[2]:void 0;for(r&&Ipe(e[0],e[1],r)&&(i=1);++n<i;)for(var s=e[n],a=Fpe(s),o=-1,c=a.length;++o<c;){var l=a[o],u=t[l];(u===void 0||DI(u,ome[l])&&!Q5e.call(t,l))&&(t[l]=s[l])}return t});function Qte(t){return gm(t)&&m0(t)}var eje=200;function tje(t,e,n,i){var r=-1,s=Npe,a=!0,o=t.length,c=[],l=e.length;if(!o)return c;e.length>=eje&&(s=C9,a=!1,e=new HC(e));e:for(;++r<o;){var u=t[r],h=u;if(u=u!==0?u:0,a&&h===h){for(var f=l;f--;)if(e[f]===h)continue e;c.push(u)}else s(e,h,i)||c.push(u)}return c}var xF=m9(function(t,e){return Qte(t)?tje(t,S9(e,1,Qte,!0)):[]});function jC(t){var e=t==null?0:t.length;return e?t[e-1]:void 0}function Dl(t,e,n){var i=t==null?0:t.length;return i?(e=e===void 0?1:gF(e),T9(t,e<0?0:e,i)):[]}function nN(t,e,n){var i=t==null?0:t.length;return i?(e=e===void 0?1:gF(e),e=i-e,T9(t,0,e<0?0:e)):[]}function nje(t){return typeof t=="function"?t:zC}function Oi(t,e){var n=$r(t)?Mpe:C1;return n(t,nje(e))}function ije(t,e){for(var n=-1,i=t==null?0:t.length;++n<i;)if(!e(t[n],n,t))return!1;return!0}function rje(t,e){var n=!0;return C1(t,function(i,r,s){return n=!!e(i,r,s),n}),n}function pm(t,e,n){var i=$r(t)?ije:rje;return i(t,g0(e))}function cme(t,e){var n=[];return C1(t,function(i,r,s){e(i,r,s)&&n.push(i)}),n}function wp(t,e){var n=$r(t)?x9:cme;return n(t,g0(e))}function sje(t){return function(e,n,i){var r=Object(e);if(!m0(e)){var s=g0(n);e=yp(e),n=function(o){return s(r[o],o,r)}}var a=t(e,n,i);return a>-1?r[s?e[a]:a]:void 0}}var aje=Math.max;function oje(t,e,n){var i=t==null?0:t.length;if(!i)return-1;var r=n==null?0:gF(n);return r<0&&(r=aje(i+r,0)),Ope(t,g0(e),r)}var VC=sje(oje);function vm(t){return t&&t.length?t[0]:void 0}function cje(t,e){var n=-1,i=m0(t)?Array(t.length):[];return C1(t,function(r,s,a){i[++n]=e(r,s,a)}),i}function Dn(t,e){var n=$r(t)?mF:cje;return n(t,g0(e))}function hp(t,e){return S9(Dn(t,e))}var lje=Object.prototype,uje=lje.hasOwnProperty,lme=J5e(function(t,e,n){uje.call(t,n)?t[n].push(e):d9(t,n,[e])}),hje=Object.prototype,fje=hje.hasOwnProperty;function dje(t,e){return t!=null&&fje.call(t,e)}function Ei(t,e){return t!=null&&ame(t,e,dje)}var pje="[object String]";function of(t){return typeof t=="string"||!$r(t)&&gm(t)&&SE(t)==pje}function mje(t,e){return mF(e,function(n){return t[n]})}function uc(t){return t==null?[]:mje(t,yp(t))}var gje=Math.max;function dh(t,e,n,i){t=m0(t)?t:uc(t),n=n&&!i?gF(n):0;var r=t.length;return n<0&&(n=gje(r+n,0)),of(t)?n<=r&&t.indexOf(e,n)>-1:!!r&&f9(t,e,n)>-1}function ene(t,e,n){var i=t==null?0:t.length;if(!i)return-1;var r=0;return f9(t,e,r)}var vje="[object Map]",_je="[object Set]",yje=Object.prototype,bje=yje.hasOwnProperty;function sa(t){if(t==null)return!0;if(m0(t)&&($r(t)||typeof t=="string"||typeof t.splice=="function"||QO(t)||v9(t)||yF(t)))return!t.length;var e=qd(t);if(e==vje||e==_je)return!t.size;if(PI(t))return!Bpe(t).length;for(var n in t)if(bje.call(t,n))return!1;return!0}var Eje="[object RegExp]";function Sje(t){return gm(t)&&SE(t)==Eje}var tne=Kb&&Kb.isRegExp,E_=tne?bF(tne):Sje;function S_(t){return t===void 0}var Tje="Expected a function";function xje(t){if(typeof t!="function")throw new TypeError(Tje);return function(){var e=arguments;switch(e.length){case 0:return!t.call(this);case 1:return!t.call(this,e[0]);case 2:return!t.call(this,e[0],e[1]);case 3:return!t.call(this,e[0],e[1],e[2])}return!t.apply(this,e)}}function wje(t,e,n,i){if(!_p(t))return t;e=TF(e,t);for(var r=-1,s=e.length,a=s-1,o=t;o!=null&&++r<s;){var c=LI(e[r]),l=n;if(c==="__proto__"||c==="constructor"||c==="prototype")return t;if(r!=a){var u=o[c];l=void 0,l===void 0&&(l=_p(u)?u:vF(e[r+1])?[]:{})}_F(o,c,l),o=o[c]}return t}function Cje(t,e,n){for(var i=-1,r=e.length,s={};++i<r;){var a=e[i],o=b9(t,a);n(o,a)&&wje(s,TF(a,t),o)}return s}function Sm(t,e){if(t==null)return{};var n=mF(W8e(t),function(i){return[i]});return e=g0(e),Cje(t,n,function(i,r){return e(i,r[0])})}function Aje(t,e,n,i,r){return r(t,function(s,a,o){n=i?(i=!1,s):e(n,s,a,o)}),n}function cf(t,e,n){var i=$r(t)?I8e:Aje,r=arguments.length<3;return i(t,g0(e),n,r,C1)}function wF(t,e){var n=$r(t)?x9:cme;return n(t,xje(g0(e)))}function Rje(t,e){var n;return C1(t,function(i,r,s){return n=e(i,r,s),!n}),!!n}function O9(t,e,n){var i=$r(t)?nme:Rje;return i(t,g0(e))}var Mje=1/0,Oje=Jw&&1/A9(new Jw([,-0]))[1]==Mje?function(t){return new Jw(t)}:Oc,Nje=200;function Ije(t,e,n){var i=-1,r=Npe,s=t.length,a=!0,o=[],c=o;if(s>=Nje){var l=Oje(t);if(l)return A9(l);a=!1,r=C9,c=new HC}else c=o;e:for(;++i<s;){var u=t[i],h=u;if(u=u!==0?u:0,a&&h===h){for(var f=c.length;f--;)if(c[f]===h)continue e;o.push(u)}else r(c,h,n)||(c!==o&&c.push(h),o.push(u))}return o}function CF(t){return t&&t.length?Ije(t):[]}function QG(t){console&&console.error&&console.error(`Error: ${t}`)}function ume(t){console&&console.warn&&console.warn(`Warning: ${t}`)}function hme(t){const e=new Date().getTime(),n=t();return{time:new Date().getTime()-e,value:n}}function fme(t){function e(){}e.prototype=t;const n=new e;function i(){return typeof n.bar}return i(),i(),t}function kje(t){return Dje(t)?t.LABEL:t.name}function Dje(t){return of(t.LABEL)&&t.LABEL!==""}class v0{get definition(){return this._definition}set definition(e){this._definition=e}constructor(e){this._definition=e}accept(e){e.visit(this),Oi(this.definition,n=>{n.accept(e)})}}class lf extends v0{constructor(e){super([]),this.idx=1,af(this,Sm(e,n=>n!==void 0))}set definition(e){}get definition(){return this.referencedRule!==void 0?this.referencedRule.definition:[]}accept(e){e.visit(this)}}class LA extends v0{constructor(e){super(e.definition),this.orgText="",af(this,Sm(e,n=>n!==void 0))}}class uf extends v0{constructor(e){super(e.definition),this.ignoreAmbiguities=!1,af(this,Sm(e,n=>n!==void 0))}}class tf extends v0{constructor(e){super(e.definition),this.idx=1,af(this,Sm(e,n=>n!==void 0))}}class _0 extends v0{constructor(e){super(e.definition),this.idx=1,af(this,Sm(e,n=>n!==void 0))}}class y0 extends v0{constructor(e){super(e.definition),this.idx=1,af(this,Sm(e,n=>n!==void 0))}}class Uc extends v0{constructor(e){super(e.definition),this.idx=1,af(this,Sm(e,n=>n!==void 0))}}class Tm extends v0{constructor(e){super(e.definition),this.idx=1,af(this,Sm(e,n=>n!==void 0))}}class xm extends v0{get definition(){return this._definition}set definition(e){this._definition=e}constructor(e){super(e.definition),this.idx=1,this.ignoreAmbiguities=!1,this.hasPredicates=!1,af(this,Sm(e,n=>n!==void 0))}}class to{constructor(e){this.idx=1,af(this,Sm(e,n=>n!==void 0))}accept(e){e.visit(this)}}function Pje(t){return Dn(t,y2)}function y2(t){function e(n){return Dn(n,y2)}if(t instanceof lf){const n={type:"NonTerminal",name:t.nonTerminalName,idx:t.idx};return of(t.label)&&(n.label=t.label),n}else{if(t instanceof uf)return{type:"Alternative",definition:e(t.definition)};if(t instanceof tf)return{type:"Option",idx:t.idx,definition:e(t.definition)};if(t instanceof _0)return{type:"RepetitionMandatory",idx:t.idx,definition:e(t.definition)};if(t instanceof y0)return{type:"RepetitionMandatoryWithSeparator",idx:t.idx,separator:y2(new to({terminalType:t.separator})),definition:e(t.definition)};if(t instanceof Tm)return{type:"RepetitionWithSeparator",idx:t.idx,separator:y2(new to({terminalType:t.separator})),definition:e(t.definition)};if(t instanceof Uc)return{type:"Repetition",idx:t.idx,definition:e(t.definition)};if(t instanceof xm)return{type:"Alternation",idx:t.idx,definition:e(t.definition)};if(t instanceof to){const n={type:"Terminal",name:t.terminalType.name,label:kje(t.terminalType),idx:t.idx};of(t.label)&&(n.terminalLabel=t.label);const i=t.terminalType.PATTERN;return t.terminalType.PATTERN&&(n.pattern=E_(i)?i.source:i),n}else{if(t instanceof LA)return{type:"Rule",name:t.name,orgText:t.orgText,definition:e(t.definition)};throw Error("non exhaustive match")}}}class A1{visit(e){const n=e;switch(n.constructor){case lf:return this.visitNonTerminal(n);case uf:return this.visitAlternative(n);case tf:return this.visitOption(n);case _0:return this.visitRepetitionMandatory(n);case y0:return this.visitRepetitionMandatoryWithSeparator(n);case Tm:return this.visitRepetitionWithSeparator(n);case Uc:return this.visitRepetition(n);case xm:return this.visitAlternation(n);case to:return this.visitTerminal(n);case LA:return this.visitRule(n);default:throw Error("non exhaustive match")}}visitNonTerminal(e){}visitAlternative(e){}visitOption(e){}visitRepetition(e){}visitRepetitionMandatory(e){}visitRepetitionMandatoryWithSeparator(e){}visitRepetitionWithSeparator(e){}visitAlternation(e){}visitTerminal(e){}visitRule(e){}}function Lje(t){return t instanceof uf||t instanceof tf||t instanceof Uc||t instanceof _0||t instanceof y0||t instanceof Tm||t instanceof to||t instanceof LA}function zU(t,e=[]){return t instanceof tf||t instanceof Uc||t instanceof Tm?!0:t instanceof xm?O9(t.definition,i=>zU(i,e)):t instanceof lf&&dh(e,t)?!1:t instanceof v0?(t instanceof lf&&e.push(t),pm(t.definition,i=>zU(i,e))):!1}function Uje(t){return t instanceof xm}function Tg(t){if(t instanceof lf)return"SUBRULE";if(t instanceof tf)return"OPTION";if(t instanceof xm)return"OR";if(t instanceof _0)return"AT_LEAST_ONE";if(t instanceof y0)return"AT_LEAST_ONE_SEP";if(t instanceof Tm)return"MANY_SEP";if(t instanceof Uc)return"MANY";if(t instanceof to)return"CONSUME";throw Error("non exhaustive match")}class AF{walk(e,n=[]){Oi(e.definition,(i,r)=>{const s=Dl(e.definition,r+1);if(i instanceof lf)this.walkProdRef(i,s,n);else if(i instanceof to)this.walkTerminal(i,s,n);else if(i instanceof uf)this.walkFlat(i,s,n);else if(i instanceof tf)this.walkOption(i,s,n);else if(i instanceof _0)this.walkAtLeastOne(i,s,n);else if(i instanceof y0)this.walkAtLeastOneSep(i,s,n);else if(i instanceof Tm)this.walkManySep(i,s,n);else if(i instanceof Uc)this.walkMany(i,s,n);else if(i instanceof xm)this.walkOr(i,s,n);else throw Error("non exhaustive match")})}walkTerminal(e,n,i){}walkProdRef(e,n,i){}walkFlat(e,n,i){const r=n.concat(i);this.walk(e,r)}walkOption(e,n,i){const r=n.concat(i);this.walk(e,r)}walkAtLeastOne(e,n,i){const r=[new tf({definition:e.definition})].concat(n,i);this.walk(e,r)}walkAtLeastOneSep(e,n,i){const r=nne(e,n,i);this.walk(e,r)}walkMany(e,n,i){const r=[new tf({definition:e.definition})].concat(n,i);this.walk(e,r)}walkManySep(e,n,i){const r=nne(e,n,i);this.walk(e,r)}walkOr(e,n,i){const r=n.concat(i);Oi(e.definition,s=>{const a=new uf({definition:[s]});this.walk(a,r)})}}function nne(t,e,n){return[new tf({definition:[new to({terminalType:t.separator})].concat(t.definition)})].concat(e,n)}function BI(t){if(t instanceof lf)return BI(t.referencedRule);if(t instanceof to)return zje(t);if(Lje(t))return Bje(t);if(Uje(t))return Fje(t);throw Error("non exhaustive match")}function Bje(t){let e=[];const n=t.definition;let i=0,r=n.length>i,s,a=!0;for(;r&&a;)s=n[i],a=zU(s),e=e.concat(BI(s)),i=i+1,r=n.length>i;return CF(e)}function Fje(t){const e=Dn(t.definition,n=>BI(n));return CF(ef(e))}function zje(t){return[t.terminalType]}const dme="_~IN~_";class Hje extends AF{constructor(e){super(),this.topProd=e,this.follows={}}startWalking(){return this.walk(this.topProd),this.follows}walkTerminal(e,n,i){}walkProdRef(e,n,i){const r=Vje(e.referencedRule,e.idx)+this.topProd.name,s=n.concat(i),a=new uf({definition:s}),o=BI(a);this.follows[r]=o}}function jje(t){const e={};return Oi(t,n=>{const i=new Hje(n).startWalking();af(e,i)}),e}function Vje(t,e){return t.name+e+dme}function Pi(t){return t.charCodeAt(0)}function M5(t,e){Array.isArray(t)?t.forEach(function(n){e.push(n)}):e.push(t)}function LR(t,e){if(t[e]===!0)throw"duplicate flag "+e;t[e],t[e]=!0}function zx(t){if(t===void 0)throw Error("Internal Error - Should never get here!");return!0}function Gje(){throw Error("Internal Error - Should never get here!")}function ine(t){return t.type==="Character"}const HU=[];for(let t=Pi("0");t<=Pi("9");t++)HU.push(t);const jU=[Pi("_")].concat(HU);for(let t=Pi("a");t<=Pi("z");t++)jU.push(t);for(let t=Pi("A");t<=Pi("Z");t++)jU.push(t);const rne=[Pi(" "),Pi("\f"),Pi(`
`),Pi("\r"),Pi("	"),Pi("\v"),Pi("	"),Pi(" "),Pi(" "),Pi(" "),Pi(" "),Pi(" "),Pi(" "),Pi(" "),Pi(" "),Pi(" "),Pi(" "),Pi(" "),Pi(" "),Pi(" "),Pi("\u2028"),Pi("\u2029"),Pi(" "),Pi(" "),Pi("　"),Pi("\uFEFF")],qje=/[0-9a-fA-F]/,lP=/[0-9]/,$je=/[1-9]/;class Wje{constructor(){this.idx=0,this.input="",this.groupIdx=0}saveState(){return{idx:this.idx,input:this.input,groupIdx:this.groupIdx}}restoreState(e){this.idx=e.idx,this.input=e.input,this.groupIdx=e.groupIdx}pattern(e){this.idx=0,this.input=e,this.groupIdx=0,this.consumeChar("/");const n=this.disjunction();this.consumeChar("/");const i={type:"Flags",loc:{begin:this.idx,end:e.length},global:!1,ignoreCase:!1,multiLine:!1,unicode:!1,sticky:!1};for(;this.isRegExpFlag();)switch(this.popChar()){case"g":LR(i,"global");break;case"i":LR(i,"ignoreCase");break;case"m":LR(i,"multiLine");break;case"u":LR(i,"unicode");break;case"y":LR(i,"sticky");break}if(this.idx!==this.input.length)throw Error("Redundant input: "+this.input.substring(this.idx));return{type:"Pattern",flags:i,value:n,loc:this.loc(0)}}disjunction(){const e=[],n=this.idx;for(e.push(this.alternative());this.peekChar()==="|";)this.consumeChar("|"),e.push(this.alternative());return{type:"Disjunction",value:e,loc:this.loc(n)}}alternative(){const e=[],n=this.idx;for(;this.isTerm();)e.push(this.term());return{type:"Alternative",value:e,loc:this.loc(n)}}term(){return this.isAssertion()?this.assertion():this.atom()}assertion(){const e=this.idx;switch(this.popChar()){case"^":return{type:"StartAnchor",loc:this.loc(e)};case"$":return{type:"EndAnchor",loc:this.loc(e)};case"\\":switch(this.popChar()){case"b":return{type:"WordBoundary",loc:this.loc(e)};case"B":return{type:"NonWordBoundary",loc:this.loc(e)}}throw Error("Invalid Assertion Escape");case"(":this.consumeChar("?");let n;switch(this.popChar()){case"=":n="Lookahead";break;case"!":n="NegativeLookahead";break}zx(n);const i=this.disjunction();return this.consumeChar(")"),{type:n,value:i,loc:this.loc(e)}}return Gje()}quantifier(e=!1){let n;const i=this.idx;switch(this.popChar()){case"*":n={atLeast:0,atMost:1/0};break;case"+":n={atLeast:1,atMost:1/0};break;case"?":n={atLeast:0,atMost:1};break;case"{":const r=this.integerIncludingZero();switch(this.popChar()){case"}":n={atLeast:r,atMost:r};break;case",":let s;this.isDigit()?(s=this.integerIncludingZero(),n={atLeast:r,atMost:s}):n={atLeast:r,atMost:1/0},this.consumeChar("}");break}if(e===!0&&n===void 0)return;zx(n);break}if(!(e===!0&&n===void 0)&&zx(n))return this.peekChar(0)==="?"?(this.consumeChar("?"),n.greedy=!1):n.greedy=!0,n.type="Quantifier",n.loc=this.loc(i),n}atom(){let e;const n=this.idx;switch(this.peekChar()){case".":e=this.dotAll();break;case"\\":e=this.atomEscape();break;case"[":e=this.characterClass();break;case"(":e=this.group();break}if(e===void 0&&this.isPatternCharacter()&&(e=this.patternCharacter()),zx(e))return e.loc=this.loc(n),this.isQuantifier()&&(e.quantifier=this.quantifier()),e}dotAll(){return this.consumeChar("."),{type:"Set",complement:!0,value:[Pi(`
`),Pi("\r"),Pi("\u2028"),Pi("\u2029")]}}atomEscape(){switch(this.consumeChar("\\"),this.peekChar()){case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":return this.decimalEscapeAtom();case"d":case"D":case"s":case"S":case"w":case"W":return this.characterClassEscape();case"f":case"n":case"r":case"t":case"v":return this.controlEscapeAtom();case"c":return this.controlLetterEscapeAtom();case"0":return this.nulCharacterAtom();case"x":return this.hexEscapeSequenceAtom();case"u":return this.regExpUnicodeEscapeSequenceAtom();default:return this.identityEscapeAtom()}}decimalEscapeAtom(){return{type:"GroupBackReference",value:this.positiveInteger()}}characterClassEscape(){let e,n=!1;switch(this.popChar()){case"d":e=HU;break;case"D":e=HU,n=!0;break;case"s":e=rne;break;case"S":e=rne,n=!0;break;case"w":e=jU;break;case"W":e=jU,n=!0;break}if(zx(e))return{type:"Set",value:e,complement:n}}controlEscapeAtom(){let e;switch(this.popChar()){case"f":e=Pi("\f");break;case"n":e=Pi(`
`);break;case"r":e=Pi("\r");break;case"t":e=Pi("	");break;case"v":e=Pi("\v");break}if(zx(e))return{type:"Character",value:e}}controlLetterEscapeAtom(){this.consumeChar("c");const e=this.popChar();if(/[a-zA-Z]/.test(e)===!1)throw Error("Invalid ");return{type:"Character",value:e.toUpperCase().charCodeAt(0)-64}}nulCharacterAtom(){return this.consumeChar("0"),{type:"Character",value:Pi("\0")}}hexEscapeSequenceAtom(){return this.consumeChar("x"),this.parseHexDigits(2)}regExpUnicodeEscapeSequenceAtom(){return this.consumeChar("u"),this.parseHexDigits(4)}identityEscapeAtom(){const e=this.popChar();return{type:"Character",value:Pi(e)}}classPatternCharacterAtom(){switch(this.peekChar()){case`
`:case"\r":case"\u2028":case"\u2029":case"\\":case"]":throw Error("TBD");default:const e=this.popChar();return{type:"Character",value:Pi(e)}}}characterClass(){const e=[];let n=!1;for(this.consumeChar("["),this.peekChar(0)==="^"&&(this.consumeChar("^"),n=!0);this.isClassAtom();){const i=this.classAtom();if(i.type,ine(i)&&this.isRangeDash()){this.consumeChar("-");const r=this.classAtom();if(r.type,ine(r)){if(r.value<i.value)throw Error("Range out of order in character class");e.push({from:i.value,to:r.value})}else M5(i.value,e),e.push(Pi("-")),M5(r.value,e)}else M5(i.value,e)}return this.consumeChar("]"),{type:"Set",complement:n,value:e}}classAtom(){switch(this.peekChar()){case"]":case`
`:case"\r":case"\u2028":case"\u2029":throw Error("TBD");case"\\":return this.classEscape();default:return this.classPatternCharacterAtom()}}classEscape(){switch(this.consumeChar("\\"),this.peekChar()){case"b":return this.consumeChar("b"),{type:"Character",value:Pi("\b")};case"d":case"D":case"s":case"S":case"w":case"W":return this.characterClassEscape();case"f":case"n":case"r":case"t":case"v":return this.controlEscapeAtom();case"c":return this.controlLetterEscapeAtom();case"0":return this.nulCharacterAtom();case"x":return this.hexEscapeSequenceAtom();case"u":return this.regExpUnicodeEscapeSequenceAtom();default:return this.identityEscapeAtom()}}group(){let e=!0;switch(this.consumeChar("("),this.peekChar(0)){case"?":this.consumeChar("?"),this.consumeChar(":"),e=!1;break;default:this.groupIdx++;break}const n=this.disjunction();this.consumeChar(")");const i={type:"Group",capturing:e,value:n};return e&&(i.idx=this.groupIdx),i}positiveInteger(){let e=this.popChar();if($je.test(e)===!1)throw Error("Expecting a positive integer");for(;lP.test(this.peekChar(0));)e+=this.popChar();return parseInt(e,10)}integerIncludingZero(){let e=this.popChar();if(lP.test(e)===!1)throw Error("Expecting an integer");for(;lP.test(this.peekChar(0));)e+=this.popChar();return parseInt(e,10)}patternCharacter(){const e=this.popChar();switch(e){case`
`:case"\r":case"\u2028":case"\u2029":case"^":case"$":case"\\":case".":case"*":case"+":case"?":case"(":case")":case"[":case"|":throw Error("TBD");default:return{type:"Character",value:Pi(e)}}}isRegExpFlag(){switch(this.peekChar(0)){case"g":case"i":case"m":case"u":case"y":return!0;default:return!1}}isRangeDash(){return this.peekChar()==="-"&&this.isClassAtom(1)}isDigit(){return lP.test(this.peekChar(0))}isClassAtom(e=0){switch(this.peekChar(e)){case"]":case`
`:case"\r":case"\u2028":case"\u2029":return!1;default:return!0}}isTerm(){return this.isAtom()||this.isAssertion()}isAtom(){if(this.isPatternCharacter())return!0;switch(this.peekChar(0)){case".":case"\\":case"[":case"(":return!0;default:return!1}}isAssertion(){switch(this.peekChar(0)){case"^":case"$":return!0;case"\\":switch(this.peekChar(1)){case"b":case"B":return!0;default:return!1}case"(":return this.peekChar(1)==="?"&&(this.peekChar(2)==="="||this.peekChar(2)==="!");default:return!1}}isQuantifier(){const e=this.saveState();try{return this.quantifier(!0)!==void 0}catch{return!1}finally{this.restoreState(e)}}isPatternCharacter(){switch(this.peekChar()){case"^":case"$":case"\\":case".":case"*":case"+":case"?":case"(":case")":case"[":case"|":case"/":case`
`:case"\r":case"\u2028":case"\u2029":return!1;default:return!0}}parseHexDigits(e){let n="";for(let r=0;r<e;r++){const s=this.popChar();if(qje.test(s)===!1)throw Error("Expecting a HexDecimal digits");n+=s}return{type:"Character",value:parseInt(n,16)}}peekChar(e=0){return this.input[this.idx+e]}popChar(){const e=this.peekChar(0);return this.consumeChar(void 0),e}consumeChar(e){if(e!==void 0&&this.input[this.idx]!==e)throw Error("Expected: '"+e+"' but found: '"+this.input[this.idx]+"' at offset: "+this.idx);if(this.idx>=this.input.length)throw Error("Unexpected end of input");this.idx++}loc(e){return{begin:e,end:this.idx}}}class N9{visitChildren(e){for(const n in e){const i=e[n];e.hasOwnProperty(n)&&(i.type!==void 0?this.visit(i):Array.isArray(i)&&i.forEach(r=>{this.visit(r)},this))}}visit(e){switch(e.type){case"Pattern":this.visitPattern(e);break;case"Flags":this.visitFlags(e);break;case"Disjunction":this.visitDisjunction(e);break;case"Alternative":this.visitAlternative(e);break;case"StartAnchor":this.visitStartAnchor(e);break;case"EndAnchor":this.visitEndAnchor(e);break;case"WordBoundary":this.visitWordBoundary(e);break;case"NonWordBoundary":this.visitNonWordBoundary(e);break;case"Lookahead":this.visitLookahead(e);break;case"NegativeLookahead":this.visitNegativeLookahead(e);break;case"Character":this.visitCharacter(e);break;case"Set":this.visitSet(e);break;case"Group":this.visitGroup(e);break;case"GroupBackReference":this.visitGroupBackReference(e);break;case"Quantifier":this.visitQuantifier(e);break}this.visitChildren(e)}visitPattern(e){}visitFlags(e){}visitDisjunction(e){}visitAlternative(e){}visitStartAnchor(e){}visitEndAnchor(e){}visitWordBoundary(e){}visitNonWordBoundary(e){}visitLookahead(e){}visitNegativeLookahead(e){}visitCharacter(e){}visitSet(e){}visitGroup(e){}visitGroupBackReference(e){}visitQuantifier(e){}}let b2={};const Yje=new Wje;function RF(t){const e=t.toString();if(b2.hasOwnProperty(e))return b2[e];{const n=Yje.pattern(e);return b2[e]=n,n}}function Xje(){b2={}}const pme="Complement Sets are not supported for first char optimization",VU=`Unable to use "first char" lexer optimizations:
`;function Kje(t,e=!1){try{const n=RF(t);return eq(n.value,{},n.flags.ignoreCase)}catch(n){if(n.message===pme)e&&ume(`${VU}	Unable to optimize: < ${t.toString()} >
	Complement Sets cannot be automatically optimized.
	This will disable the lexer's first char optimizations.
	See: https://chevrotain.io/docs/guide/resolving_lexer_errors.html#COMPLEMENT for details.`);else{let i="";e&&(i=`
	This will disable the lexer's first char optimizations.
	See: https://chevrotain.io/docs/guide/resolving_lexer_errors.html#REGEXP_PARSING for details.`),QG(`${VU}
	Failed parsing: < ${t.toString()} >
	Using the @chevrotain/regexp-to-ast library
	Please open an issue at: https://github.com/chevrotain/chevrotain/issues`+i)}}return[]}function eq(t,e,n){switch(t.type){case"Disjunction":for(let r=0;r<t.value.length;r++)eq(t.value[r],e,n);break;case"Alternative":const i=t.value;for(let r=0;r<i.length;r++){const s=i[r];switch(s.type){case"EndAnchor":case"GroupBackReference":case"Lookahead":case"NegativeLookahead":case"StartAnchor":case"WordBoundary":case"NonWordBoundary":continue}const a=s;switch(a.type){case"Character":uP(a.value,e,n);break;case"Set":if(a.complement===!0)throw Error(pme);Oi(a.value,c=>{if(typeof c=="number")uP(c,e,n);else{const l=c;if(n===!0)for(let u=l.from;u<=l.to;u++)uP(u,e,n);else{for(let u=l.from;u<=l.to&&u<lM;u++)uP(u,e,n);if(l.to>=lM){const u=l.from>=lM?l.from:lM,h=l.to,f=Zb(u),d=Zb(h);for(let p=f;p<=d;p++)e[p]=p}}}});break;case"Group":eq(a.value,e,n);break;default:throw Error("Non Exhaustive Match")}const o=a.quantifier!==void 0&&a.quantifier.atLeast===0;if(a.type==="Group"&&tq(a)===!1||a.type!=="Group"&&o===!1)break}break;default:throw Error("non exhaustive match!")}return uc(e)}function uP(t,e,n){const i=Zb(t);e[i]=i,n===!0&&Zje(t,e)}function Zje(t,e){const n=String.fromCharCode(t),i=n.toUpperCase();if(i!==n){const r=Zb(i.charCodeAt(0));e[r]=r}else{const r=n.toLowerCase();if(r!==n){const s=Zb(r.charCodeAt(0));e[s]=s}}}function sne(t,e){return VC(t.value,n=>{if(typeof n=="number")return dh(e,n);{const i=n;return VC(e,r=>i.from<=r&&r<=i.to)!==void 0}})}function tq(t){const e=t.quantifier;return e&&e.atLeast===0?!0:t.value?$r(t.value)?pm(t.value,tq):tq(t.value):!1}class Jje extends N9{constructor(e){super(),this.targetCharCodes=e,this.found=!1}visitChildren(e){if(this.found!==!0){switch(e.type){case"Lookahead":this.visitLookahead(e);return;case"NegativeLookahead":this.visitNegativeLookahead(e);return}super.visitChildren(e)}}visitCharacter(e){dh(this.targetCharCodes,e.value)&&(this.found=!0)}visitSet(e){e.complement?sne(e,this.targetCharCodes)===void 0&&(this.found=!0):sne(e,this.targetCharCodes)!==void 0&&(this.found=!0)}}function I9(t,e){if(e instanceof RegExp){const n=RF(e),i=new Jje(t);return i.visit(n),i.found}else return VC(e,n=>dh(t,n.charCodeAt(0)))!==void 0}const $T="PATTERN",cM="defaultMode",hP="modes";let mme=typeof new RegExp("(?:)").sticky=="boolean";function Qje(t,e){e=M9(e,{useSticky:mme,debug:!1,safeMode:!1,positionTracking:"full",lineTerminatorCharacters:["\r",`
`],tracer:(b,T)=>T()});const n=e.tracer;n("initCharCodeToOptimizedIndexMap",()=>{SVe()});let i;n("Reject Lexer.NA",()=>{i=wF(t,b=>b[$T]===zc.NA)});let r=!1,s;n("Transform Patterns",()=>{r=!1,s=Dn(i,b=>{const T=b[$T];if(E_(T)){const x=T.source;return x.length===1&&x!=="^"&&x!=="$"&&x!=="."&&!T.ignoreCase?x:x.length===2&&x[0]==="\\"&&!dh(["d","D","s","S","t","r","n","t","0","c","b","B","f","v","w","W"],x[1])?x[1]:e.useSticky?one(T):ane(T)}else{if(k_(T))return r=!0,{exec:T};if(typeof T=="object")return r=!0,T;if(typeof T=="string"){if(T.length===1)return T;{const x=T.replace(/[\\^$.*+?()[\]{}|]/g,"\\$&"),M=new RegExp(x);return e.useSticky?one(M):ane(M)}}else throw Error("non exhaustive match")}})});let a,o,c,l,u;n("misc mapping",()=>{a=Dn(i,b=>b.tokenTypeIdx),o=Dn(i,b=>{const T=b.GROUP;if(T!==zc.SKIPPED){if(of(T))return T;if(S_(T))return!1;throw Error("non exhaustive match")}}),c=Dn(i,b=>{const T=b.LONGER_ALT;if(T)return $r(T)?Dn(T,M=>ene(i,M)):[ene(i,T)]}),l=Dn(i,b=>b.PUSH_MODE),u=Dn(i,b=>Ei(b,"POP_MODE"))});let h;n("Line Terminator Handling",()=>{const b=_me(e.lineTerminatorCharacters);h=Dn(i,T=>!1),e.positionTracking!=="onlyOffset"&&(h=Dn(i,T=>Ei(T,"LINE_BREAKS")?!!T.LINE_BREAKS:vme(T,b)===!1&&I9(b,T.PATTERN)))});let f,d,p,g;n("Misc Mapping #2",()=>{f=Dn(i,gme),d=Dn(s,yVe),p=cf(i,(b,T)=>{const x=T.GROUP;return of(x)&&x!==zc.SKIPPED&&(b[x]=[]),b},{}),g=Dn(s,(b,T)=>({pattern:s[T],longerAlt:c[T],canLineTerminator:h[T],isCustom:f[T],short:d[T],group:o[T],push:l[T],pop:u[T],tokenTypeIdx:a[T],tokenType:i[T]}))});let y=!0,v=[];return e.safeMode||n("First Char Optimization",()=>{v=cf(i,(b,T,x)=>{if(typeof T.PATTERN=="string"){const M=T.PATTERN.charCodeAt(0),R=Zb(M);O5(b,R,g[x])}else if($r(T.START_CHARS_HINT)){let M;Oi(T.START_CHARS_HINT,R=>{const I=typeof R=="string"?R.charCodeAt(0):R,k=Zb(I);M!==k&&(M=k,O5(b,k,g[x]))})}else if(E_(T.PATTERN))if(T.PATTERN.unicode)y=!1,e.ensureOptimizations&&QG(`${VU}	Unable to analyze < ${T.PATTERN.toString()} > pattern.
	The regexp unicode flag is not currently supported by the regexp-to-ast library.
	This will disable the lexer's first char optimizations.
	For details See: https://chevrotain.io/docs/guide/resolving_lexer_errors.html#UNICODE_OPTIMIZE`);else{const M=Kje(T.PATTERN,e.ensureOptimizations);sa(M)&&(y=!1),Oi(M,R=>{O5(b,R,g[x])})}else e.ensureOptimizations&&QG(`${VU}	TokenType: <${T.name}> is using a custom token pattern without providing <start_chars_hint> parameter.
	This will disable the lexer's first char optimizations.
	For details See: https://chevrotain.io/docs/guide/resolving_lexer_errors.html#CUSTOM_OPTIMIZE`),y=!1;return b},[])}),{emptyGroups:p,patternIdxToConfig:g,charCodeToPatternIdxToConfig:v,hasCustom:r,canBeOptimized:y}}function eVe(t,e){let n=[];const i=nVe(t);n=n.concat(i.errors);const r=iVe(i.valid),s=r.valid;return n=n.concat(r.errors),n=n.concat(tVe(s)),n=n.concat(hVe(s)),n=n.concat(fVe(s,e)),n=n.concat(dVe(s)),n}function tVe(t){let e=[];const n=wp(t,i=>E_(i[$T]));return e=e.concat(sVe(n)),e=e.concat(cVe(n)),e=e.concat(lVe(n)),e=e.concat(uVe(n)),e=e.concat(aVe(n)),e}function nVe(t){const e=wp(t,r=>!Ei(r,$T)),n=Dn(e,r=>({message:"Token Type: ->"+r.name+"<- missing static 'PATTERN' property",type:wo.MISSING_PATTERN,tokenTypes:[r]})),i=xF(t,e);return{errors:n,valid:i}}function iVe(t){const e=wp(t,r=>{const s=r[$T];return!E_(s)&&!k_(s)&&!Ei(s,"exec")&&!of(s)}),n=Dn(e,r=>({message:"Token Type: ->"+r.name+"<- static 'PATTERN' can only be a RegExp, a Function matching the {CustomPatternMatcherFunc} type or an Object matching the {ICustomPattern} interface.",type:wo.INVALID_PATTERN,tokenTypes:[r]})),i=xF(t,e);return{errors:n,valid:i}}const rVe=/[^\\][$]/;function sVe(t){class e extends N9{constructor(){super(...arguments),this.found=!1}visitEndAnchor(s){this.found=!0}}const n=wp(t,r=>{const s=r.PATTERN;try{const a=RF(s),o=new e;return o.visit(a),o.found}catch{return rVe.test(s.source)}});return Dn(n,r=>({message:`Unexpected RegExp Anchor Error:
	Token Type: ->`+r.name+`<- static 'PATTERN' cannot contain end of input anchor '$'
	See chevrotain.io/docs/guide/resolving_lexer_errors.html#ANCHORS	for details.`,type:wo.EOI_ANCHOR_FOUND,tokenTypes:[r]}))}function aVe(t){const e=wp(t,i=>i.PATTERN.test(""));return Dn(e,i=>({message:"Token Type: ->"+i.name+"<- static 'PATTERN' must not match an empty string",type:wo.EMPTY_MATCH_PATTERN,tokenTypes:[i]}))}const oVe=/[^\\[][\^]|^\^/;function cVe(t){class e extends N9{constructor(){super(...arguments),this.found=!1}visitStartAnchor(s){this.found=!0}}const n=wp(t,r=>{const s=r.PATTERN;try{const a=RF(s),o=new e;return o.visit(a),o.found}catch{return oVe.test(s.source)}});return Dn(n,r=>({message:`Unexpected RegExp Anchor Error:
	Token Type: ->`+r.name+`<- static 'PATTERN' cannot contain start of input anchor '^'
	See https://chevrotain.io/docs/guide/resolving_lexer_errors.html#ANCHORS	for details.`,type:wo.SOI_ANCHOR_FOUND,tokenTypes:[r]}))}function lVe(t){const e=wp(t,i=>{const r=i[$T];return r instanceof RegExp&&(r.multiline||r.global)});return Dn(e,i=>({message:"Token Type: ->"+i.name+"<- static 'PATTERN' may NOT contain global('g') or multiline('m')",type:wo.UNSUPPORTED_FLAGS_FOUND,tokenTypes:[i]}))}function uVe(t){const e=[];let n=Dn(t,s=>cf(t,(a,o)=>(s.PATTERN.source===o.PATTERN.source&&!dh(e,o)&&o.PATTERN!==zc.NA&&(e.push(o),a.push(o)),a),[]));n=UI(n);const i=wp(n,s=>s.length>1);return Dn(i,s=>{const a=Dn(s,c=>c.name);return{message:`The same RegExp pattern ->${vm(s).PATTERN}<-has been used in all of the following Token Types: ${a.join(", ")} <-`,type:wo.DUPLICATE_PATTERNS_FOUND,tokenTypes:s}})}function hVe(t){const e=wp(t,i=>{if(!Ei(i,"GROUP"))return!1;const r=i.GROUP;return r!==zc.SKIPPED&&r!==zc.NA&&!of(r)});return Dn(e,i=>({message:"Token Type: ->"+i.name+"<- static 'GROUP' can only be Lexer.SKIPPED/Lexer.NA/A String",type:wo.INVALID_GROUP_TYPE_FOUND,tokenTypes:[i]}))}function fVe(t,e){const n=wp(t,r=>r.PUSH_MODE!==void 0&&!dh(e,r.PUSH_MODE));return Dn(n,r=>({message:`Token Type: ->${r.name}<- static 'PUSH_MODE' value cannot refer to a Lexer Mode ->${r.PUSH_MODE}<-which does not exist`,type:wo.PUSH_MODE_DOES_NOT_EXIST,tokenTypes:[r]}))}function dVe(t){const e=[],n=cf(t,(i,r,s)=>{const a=r.PATTERN;return a===zc.NA||(of(a)?i.push({str:a,idx:s,tokenType:r}):E_(a)&&mVe(a)&&i.push({str:a.source,idx:s,tokenType:r})),i},[]);return Oi(t,(i,r)=>{Oi(n,({str:s,idx:a,tokenType:o})=>{if(r<a&&pVe(s,i.PATTERN)){const c=`Token: ->${o.name}<- can never be matched.
Because it appears AFTER the Token Type ->${i.name}<-in the lexer's definition.
See https://chevrotain.io/docs/guide/resolving_lexer_errors.html#UNREACHABLE`;e.push({message:c,type:wo.UNREACHABLE_PATTERN,tokenTypes:[i,o]})}})}),e}function pVe(t,e){if(E_(e)){const n=e.exec(t);return n!==null&&n.index===0}else{if(k_(e))return e(t,0,[],{});if(Ei(e,"exec"))return e.exec(t,0,[],{});if(typeof e=="string")return e===t;throw Error("non exhaustive match")}}function mVe(t){return VC([".","\\","[","]","|","^","$","(",")","?","*","+","{"],n=>t.source.indexOf(n)!==-1)===void 0}function ane(t){const e=t.ignoreCase?"i":"";return new RegExp(`^(?:${t.source})`,e)}function one(t){const e=t.ignoreCase?"iy":"y";return new RegExp(`${t.source}`,e)}function gVe(t,e,n){const i=[];return Ei(t,cM)||i.push({message:"A MultiMode Lexer cannot be initialized without a <"+cM+`> property in its definition
`,type:wo.MULTI_MODE_LEXER_WITHOUT_DEFAULT_MODE}),Ei(t,hP)||i.push({message:"A MultiMode Lexer cannot be initialized without a <"+hP+`> property in its definition
`,type:wo.MULTI_MODE_LEXER_WITHOUT_MODES_PROPERTY}),Ei(t,hP)&&Ei(t,cM)&&!Ei(t.modes,t.defaultMode)&&i.push({message:`A MultiMode Lexer cannot be initialized with a ${cM}: <${t.defaultMode}>which does not exist
`,type:wo.MULTI_MODE_LEXER_DEFAULT_MODE_VALUE_DOES_NOT_EXIST}),Ei(t,hP)&&Oi(t.modes,(r,s)=>{Oi(r,(a,o)=>{if(S_(a))i.push({message:`A Lexer cannot be initialized using an undefined Token Type. Mode:<${s}> at index: <${o}>
`,type:wo.LEXER_DEFINITION_CANNOT_CONTAIN_UNDEFINED});else if(Ei(a,"LONGER_ALT")){const c=$r(a.LONGER_ALT)?a.LONGER_ALT:[a.LONGER_ALT];Oi(c,l=>{!S_(l)&&!dh(r,l)&&i.push({message:`A MultiMode Lexer cannot be initialized with a longer_alt <${l.name}> on token <${a.name}> outside of mode <${s}>
`,type:wo.MULTI_MODE_LEXER_LONGER_ALT_NOT_IN_CURRENT_MODE})})}})}),i}function vVe(t,e,n){const i=[];let r=!1;const s=UI(ef(uc(t.modes))),a=wF(s,c=>c[$T]===zc.NA),o=_me(n);return e&&Oi(a,c=>{const l=vme(c,o);if(l!==!1){const h={message:EVe(c,l),type:l.issue,tokenType:c};i.push(h)}else Ei(c,"LINE_BREAKS")?c.LINE_BREAKS===!0&&(r=!0):I9(o,c.PATTERN)&&(r=!0)}),e&&!r&&i.push({message:`Warning: No LINE_BREAKS Found.
	This Lexer has been defined to track line and column information,
	But none of the Token Types can be identified as matching a line terminator.
	See https://chevrotain.io/docs/guide/resolving_lexer_errors.html#LINE_BREAKS 
	for details.`,type:wo.NO_LINE_BREAKS_FLAGS}),i}function _Ve(t){const e={},n=yp(t);return Oi(n,i=>{const r=t[i];if($r(r))e[i]=[];else throw Error("non exhaustive match")}),e}function gme(t){const e=t.PATTERN;if(E_(e))return!1;if(k_(e))return!0;if(Ei(e,"exec"))return!0;if(of(e))return!1;throw Error("non exhaustive match")}function yVe(t){return of(t)&&t.length===1?t.charCodeAt(0):!1}const bVe={test:function(t){const e=t.length;for(let n=this.lastIndex;n<e;n++){const i=t.charCodeAt(n);if(i===10)return this.lastIndex=n+1,!0;if(i===13)return t.charCodeAt(n+1)===10?this.lastIndex=n+2:this.lastIndex=n+1,!0}return!1},lastIndex:0};function vme(t,e){if(Ei(t,"LINE_BREAKS"))return!1;if(E_(t.PATTERN)){try{I9(e,t.PATTERN)}catch(n){return{issue:wo.IDENTIFY_TERMINATOR,errMsg:n.message}}return!1}else{if(of(t.PATTERN))return!1;if(gme(t))return{issue:wo.CUSTOM_LINE_BREAK};throw Error("non exhaustive match")}}function EVe(t,e){if(e.issue===wo.IDENTIFY_TERMINATOR)return`Warning: unable to identify line terminator usage in pattern.
	The problem is in the <${t.name}> Token Type
	 Root cause: ${e.errMsg}.
	For details See: https://chevrotain.io/docs/guide/resolving_lexer_errors.html#IDENTIFY_TERMINATOR`;if(e.issue===wo.CUSTOM_LINE_BREAK)return`Warning: A Custom Token Pattern should specify the <line_breaks> option.
	The problem is in the <${t.name}> Token Type
	For details See: https://chevrotain.io/docs/guide/resolving_lexer_errors.html#CUSTOM_LINE_BREAK`;throw Error("non exhaustive match")}function _me(t){return Dn(t,n=>of(n)?n.charCodeAt(0):n)}function O5(t,e,n){t[e]===void 0?t[e]=[n]:t[e].push(n)}const lM=256;let E2=[];function Zb(t){return t<lM?t:E2[t]}function SVe(){if(sa(E2)){E2=new Array(65536);for(let t=0;t<65536;t++)E2[t]=t>255?255+~~(t/255):t}}function FI(t,e){const n=t.tokenTypeIdx;return n===e.tokenTypeIdx?!0:e.isParent===!0&&e.categoryMatchesMap[n]===!0}function GU(t,e){return t.tokenTypeIdx===e.tokenTypeIdx}let cne=1;const yme={};function zI(t){const e=TVe(t);xVe(e),CVe(e),wVe(e),Oi(e,n=>{n.isParent=n.categoryMatches.length>0})}function TVe(t){let e=Gl(t),n=t,i=!0;for(;i;){n=UI(ef(Dn(n,s=>s.CATEGORIES)));const r=xF(n,e);e=e.concat(r),sa(r)?i=!1:n=r}return e}function xVe(t){Oi(t,e=>{Eme(e)||(yme[cne]=e,e.tokenTypeIdx=cne++),lne(e)&&!$r(e.CATEGORIES)&&(e.CATEGORIES=[e.CATEGORIES]),lne(e)||(e.CATEGORIES=[]),AVe(e)||(e.categoryMatches=[]),RVe(e)||(e.categoryMatchesMap={})})}function wVe(t){Oi(t,e=>{e.categoryMatches=[],Oi(e.categoryMatchesMap,(n,i)=>{e.categoryMatches.push(yme[i].tokenTypeIdx)})})}function CVe(t){Oi(t,e=>{bme([],e)})}function bme(t,e){Oi(t,n=>{e.categoryMatchesMap[n.tokenTypeIdx]=!0}),Oi(e.CATEGORIES,n=>{const i=t.concat(e);dh(i,n)||bme(i,n)})}function Eme(t){return Ei(t,"tokenTypeIdx")}function lne(t){return Ei(t,"CATEGORIES")}function AVe(t){return Ei(t,"categoryMatches")}function RVe(t){return Ei(t,"categoryMatchesMap")}function MVe(t){return Ei(t,"tokenTypeIdx")}const OVe={buildUnableToPopLexerModeMessage(t){return`Unable to pop Lexer Mode after encountering Token ->${t.image}<- The Mode Stack is empty`},buildUnexpectedCharactersMessage(t,e,n,i,r){return`unexpected character: ->${t.charAt(e)}<- at offset: ${e}, skipped ${n} characters.`}};var wo;(function(t){t[t.MISSING_PATTERN=0]="MISSING_PATTERN",t[t.INVALID_PATTERN=1]="INVALID_PATTERN",t[t.EOI_ANCHOR_FOUND=2]="EOI_ANCHOR_FOUND",t[t.UNSUPPORTED_FLAGS_FOUND=3]="UNSUPPORTED_FLAGS_FOUND",t[t.DUPLICATE_PATTERNS_FOUND=4]="DUPLICATE_PATTERNS_FOUND",t[t.INVALID_GROUP_TYPE_FOUND=5]="INVALID_GROUP_TYPE_FOUND",t[t.PUSH_MODE_DOES_NOT_EXIST=6]="PUSH_MODE_DOES_NOT_EXIST",t[t.MULTI_MODE_LEXER_WITHOUT_DEFAULT_MODE=7]="MULTI_MODE_LEXER_WITHOUT_DEFAULT_MODE",t[t.MULTI_MODE_LEXER_WITHOUT_MODES_PROPERTY=8]="MULTI_MODE_LEXER_WITHOUT_MODES_PROPERTY",t[t.MULTI_MODE_LEXER_DEFAULT_MODE_VALUE_DOES_NOT_EXIST=9]="MULTI_MODE_LEXER_DEFAULT_MODE_VALUE_DOES_NOT_EXIST",t[t.LEXER_DEFINITION_CANNOT_CONTAIN_UNDEFINED=10]="LEXER_DEFINITION_CANNOT_CONTAIN_UNDEFINED",t[t.SOI_ANCHOR_FOUND=11]="SOI_ANCHOR_FOUND",t[t.EMPTY_MATCH_PATTERN=12]="EMPTY_MATCH_PATTERN",t[t.NO_LINE_BREAKS_FLAGS=13]="NO_LINE_BREAKS_FLAGS",t[t.UNREACHABLE_PATTERN=14]="UNREACHABLE_PATTERN",t[t.IDENTIFY_TERMINATOR=15]="IDENTIFY_TERMINATOR",t[t.CUSTOM_LINE_BREAK=16]="CUSTOM_LINE_BREAK",t[t.MULTI_MODE_LEXER_LONGER_ALT_NOT_IN_CURRENT_MODE=17]="MULTI_MODE_LEXER_LONGER_ALT_NOT_IN_CURRENT_MODE"})(wo||(wo={}));const uM={deferDefinitionErrorsHandling:!1,positionTracking:"full",lineTerminatorsPattern:/\n|\r\n?/g,lineTerminatorCharacters:[`
`,"\r"],ensureOptimizations:!1,safeMode:!1,errorMessageProvider:OVe,traceInitPerf:!1,skipValidations:!1,recoveryEnabled:!0};Object.freeze(uM);let zc=class{constructor(e,n=uM){if(this.lexerDefinition=e,this.lexerDefinitionErrors=[],this.lexerDefinitionWarning=[],this.patternIdxToConfig={},this.charCodeToPatternIdxToConfig={},this.modes=[],this.emptyGroups={},this.trackStartLines=!0,this.trackEndLines=!0,this.hasCustom=!1,this.canModeBeOptimized={},this.TRACE_INIT=(r,s)=>{if(this.traceInitPerf===!0){this.traceInitIndent++;const a=new Array(this.traceInitIndent+1).join("	");this.traceInitIndent<this.traceInitMaxIdent&&console.log(`${a}--> <${r}>`);const{time:o,value:c}=hme(s),l=o>10?console.warn:console.log;return this.traceInitIndent<this.traceInitMaxIdent&&l(`${a}<-- <${r}> time: ${o}ms`),this.traceInitIndent--,c}else return s()},typeof n=="boolean")throw Error(`The second argument to the Lexer constructor is now an ILexerConfig Object.
a boolean 2nd argument is no longer supported`);this.config=af({},uM,n);const i=this.config.traceInitPerf;i===!0?(this.traceInitMaxIdent=1/0,this.traceInitPerf=!0):typeof i=="number"&&(this.traceInitMaxIdent=i,this.traceInitPerf=!0),this.traceInitIndent=-1,this.TRACE_INIT("Lexer Constructor",()=>{let r,s=!0;this.TRACE_INIT("Lexer Config handling",()=>{if(this.config.lineTerminatorsPattern===uM.lineTerminatorsPattern)this.config.lineTerminatorsPattern=bVe;else if(this.config.lineTerminatorCharacters===uM.lineTerminatorCharacters)throw Error(`Error: Missing <lineTerminatorCharacters> property on the Lexer config.
	For details See: https://chevrotain.io/docs/guide/resolving_lexer_errors.html#MISSING_LINE_TERM_CHARS`);if(n.safeMode&&n.ensureOptimizations)throw Error('"safeMode" and "ensureOptimizations" flags are mutually exclusive.');this.trackStartLines=/full|onlyStart/i.test(this.config.positionTracking),this.trackEndLines=/full/i.test(this.config.positionTracking),$r(e)?r={modes:{defaultMode:Gl(e)},defaultMode:cM}:(s=!1,r=Gl(e))}),this.config.skipValidations===!1&&(this.TRACE_INIT("performRuntimeChecks",()=>{this.lexerDefinitionErrors=this.lexerDefinitionErrors.concat(gVe(r,this.trackStartLines,this.config.lineTerminatorCharacters))}),this.TRACE_INIT("performWarningRuntimeChecks",()=>{this.lexerDefinitionWarning=this.lexerDefinitionWarning.concat(vVe(r,this.trackStartLines,this.config.lineTerminatorCharacters))})),r.modes=r.modes?r.modes:{},Oi(r.modes,(o,c)=>{r.modes[c]=wF(o,l=>S_(l))});const a=yp(r.modes);if(Oi(r.modes,(o,c)=>{this.TRACE_INIT(`Mode: <${c}> processing`,()=>{if(this.modes.push(c),this.config.skipValidations===!1&&this.TRACE_INIT("validatePatterns",()=>{this.lexerDefinitionErrors=this.lexerDefinitionErrors.concat(eVe(o,a))}),sa(this.lexerDefinitionErrors)){zI(o);let l;this.TRACE_INIT("analyzeTokenTypes",()=>{l=Qje(o,{lineTerminatorCharacters:this.config.lineTerminatorCharacters,positionTracking:n.positionTracking,ensureOptimizations:n.ensureOptimizations,safeMode:n.safeMode,tracer:this.TRACE_INIT})}),this.patternIdxToConfig[c]=l.patternIdxToConfig,this.charCodeToPatternIdxToConfig[c]=l.charCodeToPatternIdxToConfig,this.emptyGroups=af({},this.emptyGroups,l.emptyGroups),this.hasCustom=l.hasCustom||this.hasCustom,this.canModeBeOptimized[c]=l.canBeOptimized}})}),this.defaultMode=r.defaultMode,!sa(this.lexerDefinitionErrors)&&!this.config.deferDefinitionErrorsHandling){const c=Dn(this.lexerDefinitionErrors,l=>l.message).join(`-----------------------
`);throw new Error(`Errors detected in definition of Lexer:
`+c)}Oi(this.lexerDefinitionWarning,o=>{ume(o.message)}),this.TRACE_INIT("Choosing sub-methods implementations",()=>{if(mme?(this.chopInput=zC,this.match=this.matchWithTest):(this.updateLastIndex=Oc,this.match=this.matchWithExec),s&&(this.handleModes=Oc),this.trackStartLines===!1&&(this.computeNewColumn=zC),this.trackEndLines===!1&&(this.updateTokenEndLineColumnLocation=Oc),/full/i.test(this.config.positionTracking))this.createTokenInstance=this.createFullToken;else if(/onlyStart/i.test(this.config.positionTracking))this.createTokenInstance=this.createStartOnlyToken;else if(/onlyOffset/i.test(this.config.positionTracking))this.createTokenInstance=this.createOffsetOnlyToken;else throw Error(`Invalid <positionTracking> config option: "${this.config.positionTracking}"`);this.hasCustom?(this.addToken=this.addTokenUsingPush,this.handlePayload=this.handlePayloadWithCustom):(this.addToken=this.addTokenUsingMemberAccess,this.handlePayload=this.handlePayloadNoCustom)}),this.TRACE_INIT("Failed Optimization Warnings",()=>{const o=cf(this.canModeBeOptimized,(c,l,u)=>(l===!1&&c.push(u),c),[]);if(n.ensureOptimizations&&!sa(o))throw Error(`Lexer Modes: < ${o.join(", ")} > cannot be optimized.
	 Disable the "ensureOptimizations" lexer config flag to silently ignore this and run the lexer in an un-optimized mode.
	 Or inspect the console log for details on how to resolve these issues.`)}),this.TRACE_INIT("clearRegExpParserCache",()=>{Xje()}),this.TRACE_INIT("toFastProperties",()=>{fme(this)})})}tokenize(e,n=this.defaultMode){if(!sa(this.lexerDefinitionErrors)){const r=Dn(this.lexerDefinitionErrors,s=>s.message).join(`-----------------------
`);throw new Error(`Unable to Tokenize because Errors detected in definition of Lexer:
`+r)}return this.tokenizeInternal(e,n)}tokenizeInternal(e,n){let i,r,s,a,o,c,l,u,h,f,d,p,g,y,v;const b=e,T=b.length;let x=0,M=0;const R=this.hasCustom?0:Math.floor(e.length/10),I=new Array(R),k=[];let P=this.trackStartLines?1:void 0,U=this.trackStartLines?1:void 0;const G=_Ve(this.emptyGroups),$=this.trackStartLines,q=this.config.lineTerminatorsPattern;let Y=0,ie=[],V=[];const J=[],X=[];Object.freeze(X);let ee;function oe(){return ie}function fe(we){const Ce=Zb(we),ke=V[Ce];return ke===void 0?X:ke}const Re=we=>{if(J.length===1&&we.tokenType.PUSH_MODE===void 0){const Ce=this.config.errorMessageProvider.buildUnableToPopLexerModeMessage(we);k.push({offset:we.startOffset,line:we.startLine,column:we.startColumn,length:we.image.length,message:Ce})}else{J.pop();const Ce=jC(J);ie=this.patternIdxToConfig[Ce],V=this.charCodeToPatternIdxToConfig[Ce],Y=ie.length;const ke=this.canModeBeOptimized[Ce]&&this.config.safeMode===!1;V&&ke?ee=fe:ee=oe}};function He(we){J.push(we),V=this.charCodeToPatternIdxToConfig[we],ie=this.patternIdxToConfig[we],Y=ie.length,Y=ie.length;const Ce=this.canModeBeOptimized[we]&&this.config.safeMode===!1;V&&Ce?ee=fe:ee=oe}He.call(this,n);let Te;const Le=this.config.recoveryEnabled;for(;x<T;){c=null;const we=b.charCodeAt(x),Ce=ee(we),ke=Ce.length;for(i=0;i<ke;i++){Te=Ce[i];const St=Te.pattern;l=null;const Mt=Te.short;if(Mt!==!1?we===Mt&&(c=St):Te.isCustom===!0?(v=St.exec(b,x,I,G),v!==null?(c=v[0],v.payload!==void 0&&(l=v.payload)):c=null):(this.updateLastIndex(St,x),c=this.match(St,e,x)),c!==null){if(o=Te.longerAlt,o!==void 0){const Ee=o.length;for(s=0;s<Ee;s++){const _e=ie[o[s]],tt=_e.pattern;if(u=null,_e.isCustom===!0?(v=tt.exec(b,x,I,G),v!==null?(a=v[0],v.payload!==void 0&&(u=v.payload)):a=null):(this.updateLastIndex(tt,x),a=this.match(tt,e,x)),a&&a.length>c.length){c=a,l=u,Te=_e;break}}}break}}if(c!==null){if(h=c.length,f=Te.group,f!==void 0&&(d=Te.tokenTypeIdx,p=this.createTokenInstance(c,x,d,Te.tokenType,P,U,h),this.handlePayload(p,l),f===!1?M=this.addToken(I,M,p):G[f].push(p)),e=this.chopInput(e,h),x=x+h,U=this.computeNewColumn(U,h),$===!0&&Te.canLineTerminator===!0){let St=0,Mt,Ee;q.lastIndex=0;do Mt=q.test(c),Mt===!0&&(Ee=q.lastIndex-1,St++);while(Mt===!0);St!==0&&(P=P+St,U=h-Ee,this.updateTokenEndLineColumnLocation(p,f,Ee,St,P,U,h))}this.handleModes(Te,Re,He,p)}else{const St=x,Mt=P,Ee=U;let _e=Le===!1;for(;_e===!1&&x<T;)for(e=this.chopInput(e,1),x++,r=0;r<Y;r++){const tt=ie[r],de=tt.pattern,Be=tt.short;if(Be!==!1?b.charCodeAt(x)===Be&&(_e=!0):tt.isCustom===!0?_e=de.exec(b,x,I,G)!==null:(this.updateLastIndex(de,x),_e=de.exec(e)!==null),_e===!0)break}if(g=x-St,U=this.computeNewColumn(U,g),y=this.config.errorMessageProvider.buildUnexpectedCharactersMessage(b,St,g,Mt,Ee),k.push({offset:St,line:Mt,column:Ee,length:g,message:y}),Le===!1)break}}return this.hasCustom||(I.length=M),{tokens:I,groups:G,errors:k}}handleModes(e,n,i,r){if(e.pop===!0){const s=e.push;n(r),s!==void 0&&i.call(this,s)}else e.push!==void 0&&i.call(this,e.push)}chopInput(e,n){return e.substring(n)}updateLastIndex(e,n){e.lastIndex=n}updateTokenEndLineColumnLocation(e,n,i,r,s,a,o){let c,l;n!==void 0&&(c=i===o-1,l=c?-1:0,r===1&&c===!0||(e.endLine=s+l,e.endColumn=a-1+-l))}computeNewColumn(e,n){return e+n}createOffsetOnlyToken(e,n,i,r){return{image:e,startOffset:n,tokenTypeIdx:i,tokenType:r}}createStartOnlyToken(e,n,i,r,s,a){return{image:e,startOffset:n,startLine:s,startColumn:a,tokenTypeIdx:i,tokenType:r}}createFullToken(e,n,i,r,s,a,o){return{image:e,startOffset:n,endOffset:n+o-1,startLine:s,endLine:s,startColumn:a,endColumn:a+o-1,tokenTypeIdx:i,tokenType:r}}addTokenUsingPush(e,n,i){return e.push(i),n}addTokenUsingMemberAccess(e,n,i){return e[n]=i,n++,n}handlePayloadNoCustom(e,n){}handlePayloadWithCustom(e,n){n!==null&&(e.payload=n)}matchWithTest(e,n,i){return e.test(n)===!0?n.substring(i,e.lastIndex):null}matchWithExec(e,n){const i=e.exec(n);return i!==null?i[0]:null}};zc.SKIPPED="This marks a skipped Token pattern, this means each token identified by it willbe consumed and then thrown into oblivion, this can be used to for example to completely ignore whitespace.";zc.NA=/NOT_APPLICABLE/;function WM(t){return Sme(t)?t.LABEL:t.name}function Sme(t){return of(t.LABEL)&&t.LABEL!==""}const NVe="parent",une="categories",hne="label",fne="group",dne="push_mode",pne="pop_mode",mne="longer_alt",gne="line_breaks",vne="start_chars_hint";function ld(t){return IVe(t)}function IVe(t){const e=t.pattern,n={};if(n.name=t.name,S_(e)||(n.PATTERN=e),Ei(t,NVe))throw`The parent property is no longer supported.
See: https://github.com/chevrotain/chevrotain/issues/564#issuecomment-349062346 for details.`;return Ei(t,une)&&(n.CATEGORIES=t[une]),zI([n]),Ei(t,hne)&&(n.LABEL=t[hne]),Ei(t,fne)&&(n.GROUP=t[fne]),Ei(t,pne)&&(n.POP_MODE=t[pne]),Ei(t,dne)&&(n.PUSH_MODE=t[dne]),Ei(t,mne)&&(n.LONGER_ALT=t[mne]),Ei(t,gne)&&(n.LINE_BREAKS=t[gne]),Ei(t,vne)&&(n.START_CHARS_HINT=t[vne]),n}const WT=ld({name:"EOF",pattern:zc.NA});zI([WT]);function HI(t,e,n,i,r,s,a,o){return{image:e,startOffset:n,endOffset:i,startLine:r,endLine:s,startColumn:a,endColumn:o,tokenTypeIdx:t.tokenTypeIdx,tokenType:t}}function kVe(t,e){return FI(t,e)}const Tme={buildMismatchTokenMessage({expected:t,actual:e,previous:n,ruleName:i}){return`Expecting ${Sme(t)?`--> ${WM(t)} <--`:`token of type --> ${t.name} <--`} but found --> '${e.image}' <--`},buildNotAllInputParsedMessage({firstRedundant:t,ruleName:e}){return"Redundant input, expecting EOF but found: "+t.image},buildNoViableAltMessage({expectedPathsPerAlt:t,actual:e,previous:n,customUserDescription:i,ruleName:r}){const s="Expecting: ",o=`
but found: '`+vm(e).image+"'";if(i)return s+i+o;{const c=cf(t,(f,d)=>f.concat(d),[]),l=Dn(c,f=>`[${Dn(f,d=>WM(d)).join(", ")}]`),h=`one of these possible Token sequences:
${Dn(l,(f,d)=>`  ${d+1}. ${f}`).join(`
`)}`;return s+h+o}},buildEarlyExitMessage({expectedIterationPaths:t,actual:e,customUserDescription:n,ruleName:i}){const r="Expecting: ",a=`
but found: '`+vm(e).image+"'";if(n)return r+n+a;{const c=`expecting at least one iteration which starts with one of these possible Token sequences::
  <${Dn(t,l=>`[${Dn(l,u=>WM(u)).join(",")}]`).join(" ,")}>`;return r+c+a}}};Object.freeze(Tme);const DVe={buildRuleNotFoundError(t,e){return"Invalid grammar, reference to a rule which is not defined: ->"+e.nonTerminalName+`<-
inside top level rule: ->`+t.name+"<-"}},uT={buildDuplicateFoundError(t,e){function n(u){return u instanceof to?u.terminalType.name:u instanceof lf?u.nonTerminalName:""}const i=t.name,r=vm(e),s=r.idx,a=Tg(r),o=n(r),c=s>0;let l=`->${a}${c?s:""}<- ${o?`with argument: ->${o}<-`:""}
                  appears more than once (${e.length} times) in the top level rule: ->${i}<-.                  
                  For further details see: https://chevrotain.io/docs/FAQ.html#NUMERICAL_SUFFIXES 
                  `;return l=l.replace(/[ \t]+/g," "),l=l.replace(/\s\s+/g,`
`),l},buildNamespaceConflictError(t){return`Namespace conflict found in grammar.
The grammar has both a Terminal(Token) and a Non-Terminal(Rule) named: <${t.name}>.
To resolve this make sure each Terminal and Non-Terminal names are unique
This is easy to accomplish by using the convention that Terminal names start with an uppercase letter
and Non-Terminal names start with a lower case letter.`},buildAlternationPrefixAmbiguityError(t){const e=Dn(t.prefixPath,r=>WM(r)).join(", "),n=t.alternation.idx===0?"":t.alternation.idx;return`Ambiguous alternatives: <${t.ambiguityIndices.join(" ,")}> due to common lookahead prefix
in <OR${n}> inside <${t.topLevelRule.name}> Rule,
<${e}> may appears as a prefix path in all these alternatives.
See: https://chevrotain.io/docs/guide/resolving_grammar_errors.html#COMMON_PREFIX
For Further details.`},buildAlternationAmbiguityError(t){const e=Dn(t.prefixPath,r=>WM(r)).join(", "),n=t.alternation.idx===0?"":t.alternation.idx;let i=`Ambiguous Alternatives Detected: <${t.ambiguityIndices.join(" ,")}> in <OR${n}> inside <${t.topLevelRule.name}> Rule,
<${e}> may appears as a prefix path in all these alternatives.
`;return i=i+`See: https://chevrotain.io/docs/guide/resolving_grammar_errors.html#AMBIGUOUS_ALTERNATIVES
For Further details.`,i},buildEmptyRepetitionError(t){let e=Tg(t.repetition);return t.repetition.idx!==0&&(e+=t.repetition.idx),`The repetition <${e}> within Rule <${t.topLevelRule.name}> can never consume any tokens.
This could lead to an infinite loop.`},buildTokenNameError(t){return"deprecated"},buildEmptyAlternationError(t){return`Ambiguous empty alternative: <${t.emptyChoiceIdx+1}> in <OR${t.alternation.idx}> inside <${t.topLevelRule.name}> Rule.
Only the last alternative may be an empty alternative.`},buildTooManyAlternativesError(t){return`An Alternation cannot have more than 256 alternatives:
<OR${t.alternation.idx}> inside <${t.topLevelRule.name}> Rule.
 has ${t.alternation.definition.length+1} alternatives.`},buildLeftRecursionError(t){const e=t.topLevelRule.name,n=Dn(t.leftRecursionPath,s=>s.name),i=`${e} --> ${n.concat([e]).join(" --> ")}`;return`Left Recursion found in grammar.
rule: <${e}> can be invoked from itself (directly or indirectly)
without consuming any Tokens. The grammar path that causes this is: 
 ${i}
 To fix this refactor your grammar to remove the left recursion.
see: https://en.wikipedia.org/wiki/LL_parser#Left_factoring.`},buildInvalidRuleNameError(t){return"deprecated"},buildDuplicateRuleNameError(t){let e;return t.topLevelRule instanceof LA?e=t.topLevelRule.name:e=t.topLevelRule,`Duplicate definition, rule: ->${e}<- is already defined in the grammar: ->${t.grammarName}<-`}};function PVe(t,e){const n=new LVe(t,e);return n.resolveRefs(),n.errors}class LVe extends A1{constructor(e,n){super(),this.nameToTopRule=e,this.errMsgProvider=n,this.errors=[]}resolveRefs(){Oi(uc(this.nameToTopRule),e=>{this.currTopLevel=e,e.accept(this)})}visitNonTerminal(e){const n=this.nameToTopRule[e.nonTerminalName];if(n)e.referencedRule=n;else{const i=this.errMsgProvider.buildRuleNotFoundError(this.currTopLevel,e);this.errors.push({message:i,type:ch.UNRESOLVED_SUBRULE_REF,ruleName:this.currTopLevel.name,unresolvedRefName:e.nonTerminalName})}}}class UVe extends AF{constructor(e,n){super(),this.topProd=e,this.path=n,this.possibleTokTypes=[],this.nextProductionName="",this.nextProductionOccurrence=0,this.found=!1,this.isAtEndOfPath=!1}startWalking(){if(this.found=!1,this.path.ruleStack[0]!==this.topProd.name)throw Error("The path does not start with the walker's top Rule!");return this.ruleStack=Gl(this.path.ruleStack).reverse(),this.occurrenceStack=Gl(this.path.occurrenceStack).reverse(),this.ruleStack.pop(),this.occurrenceStack.pop(),this.updateExpectedNext(),this.walk(this.topProd),this.possibleTokTypes}walk(e,n=[]){this.found||super.walk(e,n)}walkProdRef(e,n,i){if(e.referencedRule.name===this.nextProductionName&&e.idx===this.nextProductionOccurrence){const r=n.concat(i);this.updateExpectedNext(),this.walk(e.referencedRule,r)}}updateExpectedNext(){sa(this.ruleStack)?(this.nextProductionName="",this.nextProductionOccurrence=0,this.isAtEndOfPath=!0):(this.nextProductionName=this.ruleStack.pop(),this.nextProductionOccurrence=this.occurrenceStack.pop())}}class BVe extends UVe{constructor(e,n){super(e,n),this.path=n,this.nextTerminalName="",this.nextTerminalOccurrence=0,this.nextTerminalName=this.path.lastTok.name,this.nextTerminalOccurrence=this.path.lastTokOccurrence}walkTerminal(e,n,i){if(this.isAtEndOfPath&&e.terminalType.name===this.nextTerminalName&&e.idx===this.nextTerminalOccurrence&&!this.found){const r=n.concat(i),s=new uf({definition:r});this.possibleTokTypes=BI(s),this.found=!0}}}class MF extends AF{constructor(e,n){super(),this.topRule=e,this.occurrence=n,this.result={token:void 0,occurrence:void 0,isEndOfRule:void 0}}startWalking(){return this.walk(this.topRule),this.result}}class FVe extends MF{walkMany(e,n,i){if(e.idx===this.occurrence){const r=vm(n.concat(i));this.result.isEndOfRule=r===void 0,r instanceof to&&(this.result.token=r.terminalType,this.result.occurrence=r.idx)}else super.walkMany(e,n,i)}}class _ne extends MF{walkManySep(e,n,i){if(e.idx===this.occurrence){const r=vm(n.concat(i));this.result.isEndOfRule=r===void 0,r instanceof to&&(this.result.token=r.terminalType,this.result.occurrence=r.idx)}else super.walkManySep(e,n,i)}}class zVe extends MF{walkAtLeastOne(e,n,i){if(e.idx===this.occurrence){const r=vm(n.concat(i));this.result.isEndOfRule=r===void 0,r instanceof to&&(this.result.token=r.terminalType,this.result.occurrence=r.idx)}else super.walkAtLeastOne(e,n,i)}}class yne extends MF{walkAtLeastOneSep(e,n,i){if(e.idx===this.occurrence){const r=vm(n.concat(i));this.result.isEndOfRule=r===void 0,r instanceof to&&(this.result.token=r.terminalType,this.result.occurrence=r.idx)}else super.walkAtLeastOneSep(e,n,i)}}function nq(t,e,n=[]){n=Gl(n);let i=[],r=0;function s(o){return o.concat(Dl(t,r+1))}function a(o){const c=nq(s(o),e,n);return i.concat(c)}for(;n.length<e&&r<t.length;){const o=t[r];if(o instanceof uf)return a(o.definition);if(o instanceof lf)return a(o.definition);if(o instanceof tf)i=a(o.definition);else if(o instanceof _0){const c=o.definition.concat([new Uc({definition:o.definition})]);return a(c)}else if(o instanceof y0){const c=[new uf({definition:o.definition}),new Uc({definition:[new to({terminalType:o.separator})].concat(o.definition)})];return a(c)}else if(o instanceof Tm){const c=o.definition.concat([new Uc({definition:[new to({terminalType:o.separator})].concat(o.definition)})]);i=a(c)}else if(o instanceof Uc){const c=o.definition.concat([new Uc({definition:o.definition})]);i=a(c)}else{if(o instanceof xm)return Oi(o.definition,c=>{sa(c.definition)===!1&&(i=a(c.definition))}),i;if(o instanceof to)n.push(o.terminalType);else throw Error("non exhaustive match")}r++}return i.push({partialPath:n,suffixDef:Dl(t,r)}),i}function xme(t,e,n,i){const r="EXIT_NONE_TERMINAL",s=[r],a="EXIT_ALTERNATIVE";let o=!1;const c=e.length,l=c-i-1,u=[],h=[];for(h.push({idx:-1,def:t,ruleStack:[],occurrenceStack:[]});!sa(h);){const f=h.pop();if(f===a){o&&jC(h).idx<=l&&h.pop();continue}const d=f.def,p=f.idx,g=f.ruleStack,y=f.occurrenceStack;if(sa(d))continue;const v=d[0];if(v===r){const b={idx:p,def:Dl(d),ruleStack:nN(g),occurrenceStack:nN(y)};h.push(b)}else if(v instanceof to)if(p<c-1){const b=p+1,T=e[b];if(n(T,v.terminalType)){const x={idx:b,def:Dl(d),ruleStack:g,occurrenceStack:y};h.push(x)}}else if(p===c-1)u.push({nextTokenType:v.terminalType,nextTokenOccurrence:v.idx,ruleStack:g,occurrenceStack:y}),o=!0;else throw Error("non exhaustive match");else if(v instanceof lf){const b=Gl(g);b.push(v.nonTerminalName);const T=Gl(y);T.push(v.idx);const x={idx:p,def:v.definition.concat(s,Dl(d)),ruleStack:b,occurrenceStack:T};h.push(x)}else if(v instanceof tf){const b={idx:p,def:Dl(d),ruleStack:g,occurrenceStack:y};h.push(b),h.push(a);const T={idx:p,def:v.definition.concat(Dl(d)),ruleStack:g,occurrenceStack:y};h.push(T)}else if(v instanceof _0){const b=new Uc({definition:v.definition,idx:v.idx}),T=v.definition.concat([b],Dl(d)),x={idx:p,def:T,ruleStack:g,occurrenceStack:y};h.push(x)}else if(v instanceof y0){const b=new to({terminalType:v.separator}),T=new Uc({definition:[b].concat(v.definition),idx:v.idx}),x=v.definition.concat([T],Dl(d)),M={idx:p,def:x,ruleStack:g,occurrenceStack:y};h.push(M)}else if(v instanceof Tm){const b={idx:p,def:Dl(d),ruleStack:g,occurrenceStack:y};h.push(b),h.push(a);const T=new to({terminalType:v.separator}),x=new Uc({definition:[T].concat(v.definition),idx:v.idx}),M=v.definition.concat([x],Dl(d)),R={idx:p,def:M,ruleStack:g,occurrenceStack:y};h.push(R)}else if(v instanceof Uc){const b={idx:p,def:Dl(d),ruleStack:g,occurrenceStack:y};h.push(b),h.push(a);const T=new Uc({definition:v.definition,idx:v.idx}),x=v.definition.concat([T],Dl(d)),M={idx:p,def:x,ruleStack:g,occurrenceStack:y};h.push(M)}else if(v instanceof xm)for(let b=v.definition.length-1;b>=0;b--){const T=v.definition[b],x={idx:p,def:T.definition.concat(Dl(d)),ruleStack:g,occurrenceStack:y};h.push(x),h.push(a)}else if(v instanceof uf)h.push({idx:p,def:v.definition.concat(Dl(d)),ruleStack:g,occurrenceStack:y});else if(v instanceof LA)h.push(HVe(v,p,g,y));else throw Error("non exhaustive match")}return u}function HVe(t,e,n,i){const r=Gl(n);r.push(t.name);const s=Gl(i);return s.push(1),{idx:e,def:t.definition,ruleStack:r,occurrenceStack:s}}var Eo;(function(t){t[t.OPTION=0]="OPTION",t[t.REPETITION=1]="REPETITION",t[t.REPETITION_MANDATORY=2]="REPETITION_MANDATORY",t[t.REPETITION_MANDATORY_WITH_SEPARATOR=3]="REPETITION_MANDATORY_WITH_SEPARATOR",t[t.REPETITION_WITH_SEPARATOR=4]="REPETITION_WITH_SEPARATOR",t[t.ALTERNATION=5]="ALTERNATION"})(Eo||(Eo={}));function wme(t){if(t instanceof tf||t==="Option")return Eo.OPTION;if(t instanceof Uc||t==="Repetition")return Eo.REPETITION;if(t instanceof _0||t==="RepetitionMandatory")return Eo.REPETITION_MANDATORY;if(t instanceof y0||t==="RepetitionMandatoryWithSeparator")return Eo.REPETITION_MANDATORY_WITH_SEPARATOR;if(t instanceof Tm||t==="RepetitionWithSeparator")return Eo.REPETITION_WITH_SEPARATOR;if(t instanceof xm||t==="Alternation")return Eo.ALTERNATION;throw Error("non exhaustive match")}function jVe(t,e,n,i,r,s){const a=k9(t,e,n),o=Rme(a)?GU:FI;return s(a,i,o,r)}function VVe(t,e,n,i,r,s){const a=D9(t,e,r,n),o=Rme(a)?GU:FI;return s(a[0],o,i)}function GVe(t,e,n,i){const r=t.length,s=pm(t,a=>pm(a,o=>o.length===1));if(e)return function(a){const o=Dn(a,c=>c.GATE);for(let c=0;c<r;c++){const l=t[c],u=l.length,h=o[c];if(!(h!==void 0&&h.call(this)===!1))e:for(let f=0;f<u;f++){const d=l[f],p=d.length;for(let g=0;g<p;g++){const y=this.LA(g+1);if(n(y,d[g])===!1)continue e}return c}}};if(s&&!i){const a=Dn(t,c=>ef(c)),o=cf(a,(c,l,u)=>(Oi(l,h=>{Ei(c,h.tokenTypeIdx)||(c[h.tokenTypeIdx]=u),Oi(h.categoryMatches,f=>{Ei(c,f)||(c[f]=u)})}),c),{});return function(){const c=this.LA(1);return o[c.tokenTypeIdx]}}else return function(){for(let a=0;a<r;a++){const o=t[a],c=o.length;e:for(let l=0;l<c;l++){const u=o[l],h=u.length;for(let f=0;f<h;f++){const d=this.LA(f+1);if(n(d,u[f])===!1)continue e}return a}}}}function qVe(t,e,n){const i=pm(t,s=>s.length===1),r=t.length;if(i&&!n){const s=ef(t);if(s.length===1&&sa(s[0].categoryMatches)){const o=s[0].tokenTypeIdx;return function(){return this.LA(1).tokenTypeIdx===o}}else{const a=cf(s,(o,c,l)=>(o[c.tokenTypeIdx]=!0,Oi(c.categoryMatches,u=>{o[u]=!0}),o),[]);return function(){const o=this.LA(1);return a[o.tokenTypeIdx]===!0}}}else return function(){e:for(let s=0;s<r;s++){const a=t[s],o=a.length;for(let c=0;c<o;c++){const l=this.LA(c+1);if(e(l,a[c])===!1)continue e}return!0}return!1}}class $Ve extends AF{constructor(e,n,i){super(),this.topProd=e,this.targetOccurrence=n,this.targetProdType=i}startWalking(){return this.walk(this.topProd),this.restDef}checkIsTarget(e,n,i,r){return e.idx===this.targetOccurrence&&this.targetProdType===n?(this.restDef=i.concat(r),!0):!1}walkOption(e,n,i){this.checkIsTarget(e,Eo.OPTION,n,i)||super.walkOption(e,n,i)}walkAtLeastOne(e,n,i){this.checkIsTarget(e,Eo.REPETITION_MANDATORY,n,i)||super.walkOption(e,n,i)}walkAtLeastOneSep(e,n,i){this.checkIsTarget(e,Eo.REPETITION_MANDATORY_WITH_SEPARATOR,n,i)||super.walkOption(e,n,i)}walkMany(e,n,i){this.checkIsTarget(e,Eo.REPETITION,n,i)||super.walkOption(e,n,i)}walkManySep(e,n,i){this.checkIsTarget(e,Eo.REPETITION_WITH_SEPARATOR,n,i)||super.walkOption(e,n,i)}}class Cme extends A1{constructor(e,n,i){super(),this.targetOccurrence=e,this.targetProdType=n,this.targetRef=i,this.result=[]}checkIsTarget(e,n){e.idx===this.targetOccurrence&&this.targetProdType===n&&(this.targetRef===void 0||e===this.targetRef)&&(this.result=e.definition)}visitOption(e){this.checkIsTarget(e,Eo.OPTION)}visitRepetition(e){this.checkIsTarget(e,Eo.REPETITION)}visitRepetitionMandatory(e){this.checkIsTarget(e,Eo.REPETITION_MANDATORY)}visitRepetitionMandatoryWithSeparator(e){this.checkIsTarget(e,Eo.REPETITION_MANDATORY_WITH_SEPARATOR)}visitRepetitionWithSeparator(e){this.checkIsTarget(e,Eo.REPETITION_WITH_SEPARATOR)}visitAlternation(e){this.checkIsTarget(e,Eo.ALTERNATION)}}function bne(t){const e=new Array(t);for(let n=0;n<t;n++)e[n]=[];return e}function N5(t){let e=[""];for(let n=0;n<t.length;n++){const i=t[n],r=[];for(let s=0;s<e.length;s++){const a=e[s];r.push(a+"_"+i.tokenTypeIdx);for(let o=0;o<i.categoryMatches.length;o++){const c="_"+i.categoryMatches[o];r.push(a+c)}}e=r}return e}function WVe(t,e,n){for(let i=0;i<t.length;i++){if(i===n)continue;const r=t[i];for(let s=0;s<e.length;s++){const a=e[s];if(r[a]===!0)return!1}}return!0}function Ame(t,e){const n=Dn(t,a=>nq([a],1)),i=bne(n.length),r=Dn(n,a=>{const o={};return Oi(a,c=>{const l=N5(c.partialPath);Oi(l,u=>{o[u]=!0})}),o});let s=n;for(let a=1;a<=e;a++){const o=s;s=bne(o.length);for(let c=0;c<o.length;c++){const l=o[c];for(let u=0;u<l.length;u++){const h=l[u].partialPath,f=l[u].suffixDef,d=N5(h);if(WVe(r,d,c)||sa(f)||h.length===e){const g=i[c];if(iq(g,h)===!1){g.push(h);for(let y=0;y<d.length;y++){const v=d[y];r[c][v]=!0}}}else{const g=nq(f,a+1,h);s[c]=s[c].concat(g),Oi(g,y=>{const v=N5(y.partialPath);Oi(v,b=>{r[c][b]=!0})})}}}}return i}function k9(t,e,n,i){const r=new Cme(t,Eo.ALTERNATION,i);return e.accept(r),Ame(r.result,n)}function D9(t,e,n,i){const r=new Cme(t,n);e.accept(r);const s=r.result,o=new $Ve(e,t,n).startWalking(),c=new uf({definition:s}),l=new uf({definition:o});return Ame([c,l],i)}function iq(t,e){e:for(let n=0;n<t.length;n++){const i=t[n];if(i.length===e.length){for(let r=0;r<i.length;r++){const s=e[r],a=i[r];if((s===a||a.categoryMatchesMap[s.tokenTypeIdx]!==void 0)===!1)continue e}return!0}}return!1}function YVe(t,e){return t.length<e.length&&pm(t,(n,i)=>{const r=e[i];return n===r||r.categoryMatchesMap[n.tokenTypeIdx]})}function Rme(t){return pm(t,e=>pm(e,n=>pm(n,i=>sa(i.categoryMatches))))}function XVe(t){const e=t.lookaheadStrategy.validate({rules:t.rules,tokenTypes:t.tokenTypes,grammarName:t.grammarName});return Dn(e,n=>Object.assign({type:ch.CUSTOM_LOOKAHEAD_VALIDATION},n))}function KVe(t,e,n,i){const r=hp(t,c=>ZVe(c,n)),s=lGe(t,e,n),a=hp(t,c=>sGe(c,n)),o=hp(t,c=>eGe(c,t,i,n));return r.concat(s,a,o)}function ZVe(t,e){const n=new QVe;t.accept(n);const i=n.allProductions,r=lme(i,JVe),s=Sm(r,o=>o.length>1);return Dn(uc(s),o=>{const c=vm(o),l=e.buildDuplicateFoundError(t,o),u=Tg(c),h={message:l,type:ch.DUPLICATE_PRODUCTIONS,ruleName:t.name,dslName:u,occurrence:c.idx},f=Mme(c);return f&&(h.parameter=f),h})}function JVe(t){return`${Tg(t)}_#_${t.idx}_#_${Mme(t)}`}function Mme(t){return t instanceof to?t.terminalType.name:t instanceof lf?t.nonTerminalName:""}class QVe extends A1{constructor(){super(...arguments),this.allProductions=[]}visitNonTerminal(e){this.allProductions.push(e)}visitOption(e){this.allProductions.push(e)}visitRepetitionWithSeparator(e){this.allProductions.push(e)}visitRepetitionMandatory(e){this.allProductions.push(e)}visitRepetitionMandatoryWithSeparator(e){this.allProductions.push(e)}visitRepetition(e){this.allProductions.push(e)}visitAlternation(e){this.allProductions.push(e)}visitTerminal(e){this.allProductions.push(e)}}function eGe(t,e,n,i){const r=[];if(cf(e,(a,o)=>o.name===t.name?a+1:a,0)>1){const a=i.buildDuplicateRuleNameError({topLevelRule:t,grammarName:n});r.push({message:a,type:ch.DUPLICATE_RULE_NAME,ruleName:t.name})}return r}function tGe(t,e,n){const i=[];let r;return dh(e,t)||(r=`Invalid rule override, rule: ->${t}<- cannot be overridden in the grammar: ->${n}<-as it is not defined in any of the super grammars `,i.push({message:r,type:ch.INVALID_RULE_OVERRIDE,ruleName:t})),i}function Ome(t,e,n,i=[]){const r=[],s=S2(e.definition);if(sa(s))return[];{const a=t.name;dh(s,t)&&r.push({message:n.buildLeftRecursionError({topLevelRule:t,leftRecursionPath:i}),type:ch.LEFT_RECURSION,ruleName:a});const c=xF(s,i.concat([t])),l=hp(c,u=>{const h=Gl(i);return h.push(u),Ome(t,u,n,h)});return r.concat(l)}}function S2(t){let e=[];if(sa(t))return e;const n=vm(t);if(n instanceof lf)e.push(n.referencedRule);else if(n instanceof uf||n instanceof tf||n instanceof _0||n instanceof y0||n instanceof Tm||n instanceof Uc)e=e.concat(S2(n.definition));else if(n instanceof xm)e=ef(Dn(n.definition,s=>S2(s.definition)));else if(!(n instanceof to))throw Error("non exhaustive match");const i=zU(n),r=t.length>1;if(i&&r){const s=Dl(t);return e.concat(S2(s))}else return e}class P9 extends A1{constructor(){super(...arguments),this.alternations=[]}visitAlternation(e){this.alternations.push(e)}}function nGe(t,e){const n=new P9;t.accept(n);const i=n.alternations;return hp(i,s=>{const a=nN(s.definition);return hp(a,(o,c)=>{const l=xme([o],[],FI,1);return sa(l)?[{message:e.buildEmptyAlternationError({topLevelRule:t,alternation:s,emptyChoiceIdx:c}),type:ch.NONE_LAST_EMPTY_ALT,ruleName:t.name,occurrence:s.idx,alternative:c+1}]:[]})})}function iGe(t,e,n){const i=new P9;t.accept(i);let r=i.alternations;return r=wF(r,a=>a.ignoreAmbiguities===!0),hp(r,a=>{const o=a.idx,c=a.maxLookahead||e,l=k9(o,t,c,a),u=oGe(l,a,t,n),h=cGe(l,a,t,n);return u.concat(h)})}class rGe extends A1{constructor(){super(...arguments),this.allProductions=[]}visitRepetitionWithSeparator(e){this.allProductions.push(e)}visitRepetitionMandatory(e){this.allProductions.push(e)}visitRepetitionMandatoryWithSeparator(e){this.allProductions.push(e)}visitRepetition(e){this.allProductions.push(e)}}function sGe(t,e){const n=new P9;t.accept(n);const i=n.alternations;return hp(i,s=>s.definition.length>255?[{message:e.buildTooManyAlternativesError({topLevelRule:t,alternation:s}),type:ch.TOO_MANY_ALTS,ruleName:t.name,occurrence:s.idx}]:[])}function aGe(t,e,n){const i=[];return Oi(t,r=>{const s=new rGe;r.accept(s);const a=s.allProductions;Oi(a,o=>{const c=wme(o),l=o.maxLookahead||e,u=o.idx,f=D9(u,r,c,l)[0];if(sa(ef(f))){const d=n.buildEmptyRepetitionError({topLevelRule:r,repetition:o});i.push({message:d,type:ch.NO_NON_EMPTY_LOOKAHEAD,ruleName:r.name})}})}),i}function oGe(t,e,n,i){const r=[],s=cf(t,(o,c,l)=>(e.definition[l].ignoreAmbiguities===!0||Oi(c,u=>{const h=[l];Oi(t,(f,d)=>{l!==d&&iq(f,u)&&e.definition[d].ignoreAmbiguities!==!0&&h.push(d)}),h.length>1&&!iq(r,u)&&(r.push(u),o.push({alts:h,path:u}))}),o),[]);return Dn(s,o=>{const c=Dn(o.alts,u=>u+1);return{message:i.buildAlternationAmbiguityError({topLevelRule:n,alternation:e,ambiguityIndices:c,prefixPath:o.path}),type:ch.AMBIGUOUS_ALTS,ruleName:n.name,occurrence:e.idx,alternatives:o.alts}})}function cGe(t,e,n,i){const r=cf(t,(a,o,c)=>{const l=Dn(o,u=>({idx:c,path:u}));return a.concat(l)},[]);return UI(hp(r,a=>{if(e.definition[a.idx].ignoreAmbiguities===!0)return[];const c=a.idx,l=a.path,u=wp(r,f=>e.definition[f.idx].ignoreAmbiguities!==!0&&f.idx<c&&YVe(f.path,l));return Dn(u,f=>{const d=[f.idx+1,c+1],p=e.idx===0?"":e.idx;return{message:i.buildAlternationPrefixAmbiguityError({topLevelRule:n,alternation:e,ambiguityIndices:d,prefixPath:f.path}),type:ch.AMBIGUOUS_PREFIX_ALTS,ruleName:n.name,occurrence:p,alternatives:d}})}))}function lGe(t,e,n){const i=[],r=Dn(e,s=>s.name);return Oi(t,s=>{const a=s.name;if(dh(r,a)){const o=n.buildNamespaceConflictError(s);i.push({message:o,type:ch.CONFLICT_TOKENS_RULES_NAMESPACE,ruleName:a})}}),i}function uGe(t){const e=M9(t,{errMsgProvider:DVe}),n={};return Oi(t.rules,i=>{n[i.name]=i}),PVe(n,e.errMsgProvider)}function hGe(t){return t=M9(t,{errMsgProvider:uT}),KVe(t.rules,t.tokenTypes,t.errMsgProvider,t.grammarName)}const Nme="MismatchedTokenException",Ime="NoViableAltException",kme="EarlyExitException",Dme="NotAllInputParsedException",Pme=[Nme,Ime,kme,Dme];Object.freeze(Pme);function qU(t){return dh(Pme,t.name)}class OF extends Error{constructor(e,n){super(e),this.token=n,this.resyncedTokens=[],Object.setPrototypeOf(this,new.target.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor)}}class Lme extends OF{constructor(e,n,i){super(e,n),this.previousToken=i,this.name=Nme}}class fGe extends OF{constructor(e,n,i){super(e,n),this.previousToken=i,this.name=Ime}}class dGe extends OF{constructor(e,n){super(e,n),this.name=Dme}}class pGe extends OF{constructor(e,n,i){super(e,n),this.previousToken=i,this.name=kme}}const I5={},Ume="InRuleRecoveryException";class mGe extends Error{constructor(e){super(e),this.name=Ume}}class gGe{initRecoverable(e){this.firstAfterRepMap={},this.resyncFollows={},this.recoveryEnabled=Ei(e,"recoveryEnabled")?e.recoveryEnabled:T_.recoveryEnabled,this.recoveryEnabled&&(this.attemptInRepetitionRecovery=vGe)}getTokenToInsert(e){const n=HI(e,"",NaN,NaN,NaN,NaN,NaN,NaN);return n.isInsertedInRecovery=!0,n}canTokenTypeBeInsertedInRecovery(e){return!0}canTokenTypeBeDeletedInRecovery(e){return!0}tryInRepetitionRecovery(e,n,i,r){const s=this.findReSyncTokenType(),a=this.exportLexerState(),o=[];let c=!1;const l=this.LA(1);let u=this.LA(1);const h=()=>{const f=this.LA(0),d=this.errorMessageProvider.buildMismatchTokenMessage({expected:r,actual:l,previous:f,ruleName:this.getCurrRuleFullName()}),p=new Lme(d,l,this.LA(0));p.resyncedTokens=nN(o),this.SAVE_ERROR(p)};for(;!c;)if(this.tokenMatcher(u,r)){h();return}else if(i.call(this)){h(),e.apply(this,n);return}else this.tokenMatcher(u,s)?c=!0:(u=this.SKIP_TOKEN(),this.addToResyncTokens(u,o));this.importLexerState(a)}shouldInRepetitionRecoveryBeTried(e,n,i){return!(i===!1||this.tokenMatcher(this.LA(1),e)||this.isBackTracking()||this.canPerformInRuleRecovery(e,this.getFollowsForInRuleRecovery(e,n)))}getFollowsForInRuleRecovery(e,n){const i=this.getCurrentGrammarPath(e,n);return this.getNextPossibleTokenTypes(i)}tryInRuleRecovery(e,n){if(this.canRecoverWithSingleTokenInsertion(e,n))return this.getTokenToInsert(e);if(this.canRecoverWithSingleTokenDeletion(e)){const i=this.SKIP_TOKEN();return this.consumeToken(),i}throw new mGe("sad sad panda")}canPerformInRuleRecovery(e,n){return this.canRecoverWithSingleTokenInsertion(e,n)||this.canRecoverWithSingleTokenDeletion(e)}canRecoverWithSingleTokenInsertion(e,n){if(!this.canTokenTypeBeInsertedInRecovery(e)||sa(n))return!1;const i=this.LA(1);return VC(n,s=>this.tokenMatcher(i,s))!==void 0}canRecoverWithSingleTokenDeletion(e){return this.canTokenTypeBeDeletedInRecovery(e)?this.tokenMatcher(this.LA(2),e):!1}isInCurrentRuleReSyncSet(e){const n=this.getCurrFollowKey(),i=this.getFollowSetFromFollowKey(n);return dh(i,e)}findReSyncTokenType(){const e=this.flattenFollowSet();let n=this.LA(1),i=2;for(;;){const r=VC(e,s=>kVe(n,s));if(r!==void 0)return r;n=this.LA(i),i++}}getCurrFollowKey(){if(this.RULE_STACK.length===1)return I5;const e=this.getLastExplicitRuleShortName(),n=this.getLastExplicitRuleOccurrenceIndex(),i=this.getPreviousExplicitRuleShortName();return{ruleName:this.shortRuleNameToFullName(e),idxInCallingRule:n,inRule:this.shortRuleNameToFullName(i)}}buildFullFollowKeyStack(){const e=this.RULE_STACK,n=this.RULE_OCCURRENCE_STACK;return Dn(e,(i,r)=>r===0?I5:{ruleName:this.shortRuleNameToFullName(i),idxInCallingRule:n[r],inRule:this.shortRuleNameToFullName(e[r-1])})}flattenFollowSet(){const e=Dn(this.buildFullFollowKeyStack(),n=>this.getFollowSetFromFollowKey(n));return ef(e)}getFollowSetFromFollowKey(e){if(e===I5)return[WT];const n=e.ruleName+e.idxInCallingRule+dme+e.inRule;return this.resyncFollows[n]}addToResyncTokens(e,n){return this.tokenMatcher(e,WT)||n.push(e),n}reSyncTo(e){const n=[];let i=this.LA(1);for(;this.tokenMatcher(i,e)===!1;)i=this.SKIP_TOKEN(),this.addToResyncTokens(i,n);return nN(n)}attemptInRepetitionRecovery(e,n,i,r,s,a,o){}getCurrentGrammarPath(e,n){const i=this.getHumanReadableRuleStack(),r=Gl(this.RULE_OCCURRENCE_STACK);return{ruleStack:i,occurrenceStack:r,lastTok:e,lastTokOccurrence:n}}getHumanReadableRuleStack(){return Dn(this.RULE_STACK,e=>this.shortRuleNameToFullName(e))}}function vGe(t,e,n,i,r,s,a){const o=this.getKeyForAutomaticLookahead(i,r);let c=this.firstAfterRepMap[o];if(c===void 0){const f=this.getCurrRuleFullName(),d=this.getGAstProductions()[f];c=new s(d,r).startWalking(),this.firstAfterRepMap[o]=c}let l=c.token,u=c.occurrence;const h=c.isEndOfRule;this.RULE_STACK.length===1&&h&&l===void 0&&(l=WT,u=1),!(l===void 0||u===void 0)&&this.shouldInRepetitionRecoveryBeTried(l,u,a)&&this.tryInRepetitionRecovery(t,e,n,l)}const _Ge=4,TE=8,Bme=1<<TE,Fme=2<<TE,rq=3<<TE,sq=4<<TE,aq=5<<TE,T2=6<<TE;function k5(t,e,n){return n|e|t}class yGe{constructor(e){var n;this.maxLookahead=(n=e==null?void 0:e.maxLookahead)!==null&&n!==void 0?n:T_.maxLookahead}validate(e){const n=this.validateNoLeftRecursion(e.rules);if(sa(n)){const i=this.validateEmptyOrAlternatives(e.rules),r=this.validateAmbiguousAlternationAlternatives(e.rules,this.maxLookahead),s=this.validateSomeNonEmptyLookaheadPath(e.rules,this.maxLookahead);return[...n,...i,...r,...s]}return n}validateNoLeftRecursion(e){return hp(e,n=>Ome(n,n,uT))}validateEmptyOrAlternatives(e){return hp(e,n=>nGe(n,uT))}validateAmbiguousAlternationAlternatives(e,n){return hp(e,i=>iGe(i,n,uT))}validateSomeNonEmptyLookaheadPath(e,n){return aGe(e,n,uT)}buildLookaheadForAlternation(e){return jVe(e.prodOccurrence,e.rule,e.maxLookahead,e.hasPredicates,e.dynamicTokensEnabled,GVe)}buildLookaheadForOptional(e){return VVe(e.prodOccurrence,e.rule,e.maxLookahead,e.dynamicTokensEnabled,wme(e.prodType),qVe)}}class bGe{initLooksAhead(e){this.dynamicTokensEnabled=Ei(e,"dynamicTokensEnabled")?e.dynamicTokensEnabled:T_.dynamicTokensEnabled,this.maxLookahead=Ei(e,"maxLookahead")?e.maxLookahead:T_.maxLookahead,this.lookaheadStrategy=Ei(e,"lookaheadStrategy")?e.lookaheadStrategy:new yGe({maxLookahead:this.maxLookahead}),this.lookAheadFuncsCache=new Map}preComputeLookaheadFunctions(e){Oi(e,n=>{this.TRACE_INIT(`${n.name} Rule Lookahead`,()=>{const{alternation:i,repetition:r,option:s,repetitionMandatory:a,repetitionMandatoryWithSeparator:o,repetitionWithSeparator:c}=SGe(n);Oi(i,l=>{const u=l.idx===0?"":l.idx;this.TRACE_INIT(`${Tg(l)}${u}`,()=>{const h=this.lookaheadStrategy.buildLookaheadForAlternation({prodOccurrence:l.idx,rule:n,maxLookahead:l.maxLookahead||this.maxLookahead,hasPredicates:l.hasPredicates,dynamicTokensEnabled:this.dynamicTokensEnabled}),f=k5(this.fullRuleNameToShort[n.name],Bme,l.idx);this.setLaFuncCache(f,h)})}),Oi(r,l=>{this.computeLookaheadFunc(n,l.idx,rq,"Repetition",l.maxLookahead,Tg(l))}),Oi(s,l=>{this.computeLookaheadFunc(n,l.idx,Fme,"Option",l.maxLookahead,Tg(l))}),Oi(a,l=>{this.computeLookaheadFunc(n,l.idx,sq,"RepetitionMandatory",l.maxLookahead,Tg(l))}),Oi(o,l=>{this.computeLookaheadFunc(n,l.idx,T2,"RepetitionMandatoryWithSeparator",l.maxLookahead,Tg(l))}),Oi(c,l=>{this.computeLookaheadFunc(n,l.idx,aq,"RepetitionWithSeparator",l.maxLookahead,Tg(l))})})})}computeLookaheadFunc(e,n,i,r,s,a){this.TRACE_INIT(`${a}${n===0?"":n}`,()=>{const o=this.lookaheadStrategy.buildLookaheadForOptional({prodOccurrence:n,rule:e,maxLookahead:s||this.maxLookahead,dynamicTokensEnabled:this.dynamicTokensEnabled,prodType:r}),c=k5(this.fullRuleNameToShort[e.name],i,n);this.setLaFuncCache(c,o)})}getKeyForAutomaticLookahead(e,n){const i=this.getLastExplicitRuleShortName();return k5(i,e,n)}getLaFuncFromCache(e){return this.lookAheadFuncsCache.get(e)}setLaFuncCache(e,n){this.lookAheadFuncsCache.set(e,n)}}class EGe extends A1{constructor(){super(...arguments),this.dslMethods={option:[],alternation:[],repetition:[],repetitionWithSeparator:[],repetitionMandatory:[],repetitionMandatoryWithSeparator:[]}}reset(){this.dslMethods={option:[],alternation:[],repetition:[],repetitionWithSeparator:[],repetitionMandatory:[],repetitionMandatoryWithSeparator:[]}}visitOption(e){this.dslMethods.option.push(e)}visitRepetitionWithSeparator(e){this.dslMethods.repetitionWithSeparator.push(e)}visitRepetitionMandatory(e){this.dslMethods.repetitionMandatory.push(e)}visitRepetitionMandatoryWithSeparator(e){this.dslMethods.repetitionMandatoryWithSeparator.push(e)}visitRepetition(e){this.dslMethods.repetition.push(e)}visitAlternation(e){this.dslMethods.alternation.push(e)}}const fP=new EGe;function SGe(t){fP.reset(),t.accept(fP);const e=fP.dslMethods;return fP.reset(),e}function Ene(t,e){isNaN(t.startOffset)===!0?(t.startOffset=e.startOffset,t.endOffset=e.endOffset):t.endOffset<e.endOffset&&(t.endOffset=e.endOffset)}function Sne(t,e){isNaN(t.startOffset)===!0?(t.startOffset=e.startOffset,t.startColumn=e.startColumn,t.startLine=e.startLine,t.endOffset=e.endOffset,t.endColumn=e.endColumn,t.endLine=e.endLine):t.endOffset<e.endOffset&&(t.endOffset=e.endOffset,t.endColumn=e.endColumn,t.endLine=e.endLine)}function TGe(t,e,n){t.children[n]===void 0?t.children[n]=[e]:t.children[n].push(e)}function xGe(t,e,n){t.children[e]===void 0?t.children[e]=[n]:t.children[e].push(n)}const wGe="name";function zme(t,e){Object.defineProperty(t,wGe,{enumerable:!1,configurable:!0,writable:!1,value:e})}function CGe(t,e){const n=yp(t),i=n.length;for(let r=0;r<i;r++){const s=n[r],a=t[s],o=a.length;for(let c=0;c<o;c++){const l=a[c];l.tokenTypeIdx===void 0&&this[l.name](l.children,e)}}}function AGe(t,e){const n=function(){};zme(n,t+"BaseSemantics");const i={visit:function(r,s){if($r(r)&&(r=r[0]),!S_(r))return this[r.name](r.children,s)},validateVisitor:function(){const r=MGe(this,e);if(!sa(r)){const s=Dn(r,a=>a.msg);throw Error(`Errors Detected in CST Visitor <${this.constructor.name}>:
	${s.join(`

`).replace(/\n/g,`
	`)}`)}}};return n.prototype=i,n.prototype.constructor=n,n._RULE_NAMES=e,n}function RGe(t,e,n){const i=function(){};zme(i,t+"BaseSemanticsWithDefaults");const r=Object.create(n.prototype);return Oi(e,s=>{r[s]=CGe}),i.prototype=r,i.prototype.constructor=i,i}var oq;(function(t){t[t.REDUNDANT_METHOD=0]="REDUNDANT_METHOD",t[t.MISSING_METHOD=1]="MISSING_METHOD"})(oq||(oq={}));function MGe(t,e){return OGe(t,e)}function OGe(t,e){const n=wp(e,r=>k_(t[r])===!1),i=Dn(n,r=>({msg:`Missing visitor method: <${r}> on ${t.constructor.name} CST Visitor.`,type:oq.MISSING_METHOD,methodName:r}));return UI(i)}class NGe{initTreeBuilder(e){if(this.CST_STACK=[],this.outputCst=e.outputCst,this.nodeLocationTracking=Ei(e,"nodeLocationTracking")?e.nodeLocationTracking:T_.nodeLocationTracking,!this.outputCst)this.cstInvocationStateUpdate=Oc,this.cstFinallyStateUpdate=Oc,this.cstPostTerminal=Oc,this.cstPostNonTerminal=Oc,this.cstPostRule=Oc;else if(/full/i.test(this.nodeLocationTracking))this.recoveryEnabled?(this.setNodeLocationFromToken=Sne,this.setNodeLocationFromNode=Sne,this.cstPostRule=Oc,this.setInitialNodeLocation=this.setInitialNodeLocationFullRecovery):(this.setNodeLocationFromToken=Oc,this.setNodeLocationFromNode=Oc,this.cstPostRule=this.cstPostRuleFull,this.setInitialNodeLocation=this.setInitialNodeLocationFullRegular);else if(/onlyOffset/i.test(this.nodeLocationTracking))this.recoveryEnabled?(this.setNodeLocationFromToken=Ene,this.setNodeLocationFromNode=Ene,this.cstPostRule=Oc,this.setInitialNodeLocation=this.setInitialNodeLocationOnlyOffsetRecovery):(this.setNodeLocationFromToken=Oc,this.setNodeLocationFromNode=Oc,this.cstPostRule=this.cstPostRuleOnlyOffset,this.setInitialNodeLocation=this.setInitialNodeLocationOnlyOffsetRegular);else if(/none/i.test(this.nodeLocationTracking))this.setNodeLocationFromToken=Oc,this.setNodeLocationFromNode=Oc,this.cstPostRule=Oc,this.setInitialNodeLocation=Oc;else throw Error(`Invalid <nodeLocationTracking> config option: "${e.nodeLocationTracking}"`)}setInitialNodeLocationOnlyOffsetRecovery(e){e.location={startOffset:NaN,endOffset:NaN}}setInitialNodeLocationOnlyOffsetRegular(e){e.location={startOffset:this.LA(1).startOffset,endOffset:NaN}}setInitialNodeLocationFullRecovery(e){e.location={startOffset:NaN,startLine:NaN,startColumn:NaN,endOffset:NaN,endLine:NaN,endColumn:NaN}}setInitialNodeLocationFullRegular(e){const n=this.LA(1);e.location={startOffset:n.startOffset,startLine:n.startLine,startColumn:n.startColumn,endOffset:NaN,endLine:NaN,endColumn:NaN}}cstInvocationStateUpdate(e){const n={name:e,children:Object.create(null)};this.setInitialNodeLocation(n),this.CST_STACK.push(n)}cstFinallyStateUpdate(){this.CST_STACK.pop()}cstPostRuleFull(e){const n=this.LA(0),i=e.location;i.startOffset<=n.startOffset?(i.endOffset=n.endOffset,i.endLine=n.endLine,i.endColumn=n.endColumn):(i.startOffset=NaN,i.startLine=NaN,i.startColumn=NaN)}cstPostRuleOnlyOffset(e){const n=this.LA(0),i=e.location;i.startOffset<=n.startOffset?i.endOffset=n.endOffset:i.startOffset=NaN}cstPostTerminal(e,n){const i=this.CST_STACK[this.CST_STACK.length-1];TGe(i,n,e),this.setNodeLocationFromToken(i.location,n)}cstPostNonTerminal(e,n){const i=this.CST_STACK[this.CST_STACK.length-1];xGe(i,n,e),this.setNodeLocationFromNode(i.location,e.location)}getBaseCstVisitorConstructor(){if(S_(this.baseCstVisitorConstructor)){const e=AGe(this.className,yp(this.gastProductionsCache));return this.baseCstVisitorConstructor=e,e}return this.baseCstVisitorConstructor}getBaseCstVisitorConstructorWithDefaults(){if(S_(this.baseCstVisitorWithDefaultsConstructor)){const e=RGe(this.className,yp(this.gastProductionsCache),this.getBaseCstVisitorConstructor());return this.baseCstVisitorWithDefaultsConstructor=e,e}return this.baseCstVisitorWithDefaultsConstructor}getLastExplicitRuleShortName(){const e=this.RULE_STACK;return e[e.length-1]}getPreviousExplicitRuleShortName(){const e=this.RULE_STACK;return e[e.length-2]}getLastExplicitRuleOccurrenceIndex(){const e=this.RULE_OCCURRENCE_STACK;return e[e.length-1]}}class IGe{initLexerAdapter(){this.tokVector=[],this.tokVectorLength=0,this.currIdx=-1}set input(e){if(this.selfAnalysisDone!==!0)throw Error("Missing <performSelfAnalysis> invocation at the end of the Parser's constructor.");this.reset(),this.tokVector=e,this.tokVectorLength=e.length}get input(){return this.tokVector}SKIP_TOKEN(){return this.currIdx<=this.tokVector.length-2?(this.consumeToken(),this.LA(1)):WU}LA(e){const n=this.currIdx+e;return n<0||this.tokVectorLength<=n?WU:this.tokVector[n]}consumeToken(){this.currIdx++}exportLexerState(){return this.currIdx}importLexerState(e){this.currIdx=e}resetLexerState(){this.currIdx=-1}moveToTerminatedState(){this.currIdx=this.tokVector.length-1}getLexerPosition(){return this.exportLexerState()}}class kGe{ACTION(e){return e.call(this)}consume(e,n,i){return this.consumeInternal(n,e,i)}subrule(e,n,i){return this.subruleInternal(n,e,i)}option(e,n){return this.optionInternal(n,e)}or(e,n){return this.orInternal(n,e)}many(e,n){return this.manyInternal(e,n)}atLeastOne(e,n){return this.atLeastOneInternal(e,n)}CONSUME(e,n){return this.consumeInternal(e,0,n)}CONSUME1(e,n){return this.consumeInternal(e,1,n)}CONSUME2(e,n){return this.consumeInternal(e,2,n)}CONSUME3(e,n){return this.consumeInternal(e,3,n)}CONSUME4(e,n){return this.consumeInternal(e,4,n)}CONSUME5(e,n){return this.consumeInternal(e,5,n)}CONSUME6(e,n){return this.consumeInternal(e,6,n)}CONSUME7(e,n){return this.consumeInternal(e,7,n)}CONSUME8(e,n){return this.consumeInternal(e,8,n)}CONSUME9(e,n){return this.consumeInternal(e,9,n)}SUBRULE(e,n){return this.subruleInternal(e,0,n)}SUBRULE1(e,n){return this.subruleInternal(e,1,n)}SUBRULE2(e,n){return this.subruleInternal(e,2,n)}SUBRULE3(e,n){return this.subruleInternal(e,3,n)}SUBRULE4(e,n){return this.subruleInternal(e,4,n)}SUBRULE5(e,n){return this.subruleInternal(e,5,n)}SUBRULE6(e,n){return this.subruleInternal(e,6,n)}SUBRULE7(e,n){return this.subruleInternal(e,7,n)}SUBRULE8(e,n){return this.subruleInternal(e,8,n)}SUBRULE9(e,n){return this.subruleInternal(e,9,n)}OPTION(e){return this.optionInternal(e,0)}OPTION1(e){return this.optionInternal(e,1)}OPTION2(e){return this.optionInternal(e,2)}OPTION3(e){return this.optionInternal(e,3)}OPTION4(e){return this.optionInternal(e,4)}OPTION5(e){return this.optionInternal(e,5)}OPTION6(e){return this.optionInternal(e,6)}OPTION7(e){return this.optionInternal(e,7)}OPTION8(e){return this.optionInternal(e,8)}OPTION9(e){return this.optionInternal(e,9)}OR(e){return this.orInternal(e,0)}OR1(e){return this.orInternal(e,1)}OR2(e){return this.orInternal(e,2)}OR3(e){return this.orInternal(e,3)}OR4(e){return this.orInternal(e,4)}OR5(e){return this.orInternal(e,5)}OR6(e){return this.orInternal(e,6)}OR7(e){return this.orInternal(e,7)}OR8(e){return this.orInternal(e,8)}OR9(e){return this.orInternal(e,9)}MANY(e){this.manyInternal(0,e)}MANY1(e){this.manyInternal(1,e)}MANY2(e){this.manyInternal(2,e)}MANY3(e){this.manyInternal(3,e)}MANY4(e){this.manyInternal(4,e)}MANY5(e){this.manyInternal(5,e)}MANY6(e){this.manyInternal(6,e)}MANY7(e){this.manyInternal(7,e)}MANY8(e){this.manyInternal(8,e)}MANY9(e){this.manyInternal(9,e)}MANY_SEP(e){this.manySepFirstInternal(0,e)}MANY_SEP1(e){this.manySepFirstInternal(1,e)}MANY_SEP2(e){this.manySepFirstInternal(2,e)}MANY_SEP3(e){this.manySepFirstInternal(3,e)}MANY_SEP4(e){this.manySepFirstInternal(4,e)}MANY_SEP5(e){this.manySepFirstInternal(5,e)}MANY_SEP6(e){this.manySepFirstInternal(6,e)}MANY_SEP7(e){this.manySepFirstInternal(7,e)}MANY_SEP8(e){this.manySepFirstInternal(8,e)}MANY_SEP9(e){this.manySepFirstInternal(9,e)}AT_LEAST_ONE(e){this.atLeastOneInternal(0,e)}AT_LEAST_ONE1(e){return this.atLeastOneInternal(1,e)}AT_LEAST_ONE2(e){this.atLeastOneInternal(2,e)}AT_LEAST_ONE3(e){this.atLeastOneInternal(3,e)}AT_LEAST_ONE4(e){this.atLeastOneInternal(4,e)}AT_LEAST_ONE5(e){this.atLeastOneInternal(5,e)}AT_LEAST_ONE6(e){this.atLeastOneInternal(6,e)}AT_LEAST_ONE7(e){this.atLeastOneInternal(7,e)}AT_LEAST_ONE8(e){this.atLeastOneInternal(8,e)}AT_LEAST_ONE9(e){this.atLeastOneInternal(9,e)}AT_LEAST_ONE_SEP(e){this.atLeastOneSepFirstInternal(0,e)}AT_LEAST_ONE_SEP1(e){this.atLeastOneSepFirstInternal(1,e)}AT_LEAST_ONE_SEP2(e){this.atLeastOneSepFirstInternal(2,e)}AT_LEAST_ONE_SEP3(e){this.atLeastOneSepFirstInternal(3,e)}AT_LEAST_ONE_SEP4(e){this.atLeastOneSepFirstInternal(4,e)}AT_LEAST_ONE_SEP5(e){this.atLeastOneSepFirstInternal(5,e)}AT_LEAST_ONE_SEP6(e){this.atLeastOneSepFirstInternal(6,e)}AT_LEAST_ONE_SEP7(e){this.atLeastOneSepFirstInternal(7,e)}AT_LEAST_ONE_SEP8(e){this.atLeastOneSepFirstInternal(8,e)}AT_LEAST_ONE_SEP9(e){this.atLeastOneSepFirstInternal(9,e)}RULE(e,n,i=YU){if(dh(this.definedRulesNames,e)){const a={message:uT.buildDuplicateRuleNameError({topLevelRule:e,grammarName:this.className}),type:ch.DUPLICATE_RULE_NAME,ruleName:e};this.definitionErrors.push(a)}this.definedRulesNames.push(e);const r=this.defineRule(e,n,i);return this[e]=r,r}OVERRIDE_RULE(e,n,i=YU){const r=tGe(e,this.definedRulesNames,this.className);this.definitionErrors=this.definitionErrors.concat(r);const s=this.defineRule(e,n,i);return this[e]=s,s}BACKTRACK(e,n){return function(){this.isBackTrackingStack.push(1);const i=this.saveRecogState();try{return e.apply(this,n),!0}catch(r){if(qU(r))return!1;throw r}finally{this.reloadRecogState(i),this.isBackTrackingStack.pop()}}}getGAstProductions(){return this.gastProductionsCache}getSerializedGastProductions(){return Pje(uc(this.gastProductionsCache))}}class DGe{initRecognizerEngine(e,n){if(this.className=this.constructor.name,this.shortRuleNameToFull={},this.fullRuleNameToShort={},this.ruleShortNameIdx=256,this.tokenMatcher=GU,this.subruleIdx=0,this.definedRulesNames=[],this.tokensMap={},this.isBackTrackingStack=[],this.RULE_STACK=[],this.RULE_OCCURRENCE_STACK=[],this.gastProductionsCache={},Ei(n,"serializedGrammar"))throw Error(`The Parser's configuration can no longer contain a <serializedGrammar> property.
	See: https://chevrotain.io/docs/changes/BREAKING_CHANGES.html#_6-0-0
	For Further details.`);if($r(e)){if(sa(e))throw Error(`A Token Vocabulary cannot be empty.
	Note that the first argument for the parser constructor
	is no longer a Token vector (since v4.0).`);if(typeof e[0].startOffset=="number")throw Error(`The Parser constructor no longer accepts a token vector as the first argument.
	See: https://chevrotain.io/docs/changes/BREAKING_CHANGES.html#_4-0-0
	For Further details.`)}if($r(e))this.tokensMap=cf(e,(s,a)=>(s[a.name]=a,s),{});else if(Ei(e,"modes")&&pm(ef(uc(e.modes)),MVe)){const s=ef(uc(e.modes)),a=CF(s);this.tokensMap=cf(a,(o,c)=>(o[c.name]=c,o),{})}else if(_p(e))this.tokensMap=Gl(e);else throw new Error("<tokensDictionary> argument must be An Array of Token constructors, A dictionary of Token constructors or an IMultiModeLexerDefinition");this.tokensMap.EOF=WT;const i=Ei(e,"modes")?ef(uc(e.modes)):uc(e),r=pm(i,s=>sa(s.categoryMatches));this.tokenMatcher=r?GU:FI,zI(uc(this.tokensMap))}defineRule(e,n,i){if(this.selfAnalysisDone)throw Error(`Grammar rule <${e}> may not be defined after the 'performSelfAnalysis' method has been called'
Make sure that all grammar rule definitions are done before 'performSelfAnalysis' is called.`);const r=Ei(i,"resyncEnabled")?i.resyncEnabled:YU.resyncEnabled,s=Ei(i,"recoveryValueFunc")?i.recoveryValueFunc:YU.recoveryValueFunc,a=this.ruleShortNameIdx<<_Ge+TE;this.ruleShortNameIdx++,this.shortRuleNameToFull[a]=e,this.fullRuleNameToShort[e]=a;let o;return this.outputCst===!0?o=function(...u){try{this.ruleInvocationStateUpdate(a,e,this.subruleIdx),n.apply(this,u);const h=this.CST_STACK[this.CST_STACK.length-1];return this.cstPostRule(h),h}catch(h){return this.invokeRuleCatch(h,r,s)}finally{this.ruleFinallyStateUpdate()}}:o=function(...u){try{return this.ruleInvocationStateUpdate(a,e,this.subruleIdx),n.apply(this,u)}catch(h){return this.invokeRuleCatch(h,r,s)}finally{this.ruleFinallyStateUpdate()}},Object.assign(o,{ruleName:e,originalGrammarAction:n})}invokeRuleCatch(e,n,i){const r=this.RULE_STACK.length===1,s=n&&!this.isBackTracking()&&this.recoveryEnabled;if(qU(e)){const a=e;if(s){const o=this.findReSyncTokenType();if(this.isInCurrentRuleReSyncSet(o))if(a.resyncedTokens=this.reSyncTo(o),this.outputCst){const c=this.CST_STACK[this.CST_STACK.length-1];return c.recoveredNode=!0,c}else return i(e);else{if(this.outputCst){const c=this.CST_STACK[this.CST_STACK.length-1];c.recoveredNode=!0,a.partialCstResult=c}throw a}}else{if(r)return this.moveToTerminatedState(),i(e);throw a}}else throw e}optionInternal(e,n){const i=this.getKeyForAutomaticLookahead(Fme,n);return this.optionInternalLogic(e,n,i)}optionInternalLogic(e,n,i){let r=this.getLaFuncFromCache(i),s;if(typeof e!="function"){s=e.DEF;const a=e.GATE;if(a!==void 0){const o=r;r=()=>a.call(this)&&o.call(this)}}else s=e;if(r.call(this)===!0)return s.call(this)}atLeastOneInternal(e,n){const i=this.getKeyForAutomaticLookahead(sq,e);return this.atLeastOneInternalLogic(e,n,i)}atLeastOneInternalLogic(e,n,i){let r=this.getLaFuncFromCache(i),s;if(typeof n!="function"){s=n.DEF;const a=n.GATE;if(a!==void 0){const o=r;r=()=>a.call(this)&&o.call(this)}}else s=n;if(r.call(this)===!0){let a=this.doSingleRepetition(s);for(;r.call(this)===!0&&a===!0;)a=this.doSingleRepetition(s)}else throw this.raiseEarlyExitException(e,Eo.REPETITION_MANDATORY,n.ERR_MSG);this.attemptInRepetitionRecovery(this.atLeastOneInternal,[e,n],r,sq,e,zVe)}atLeastOneSepFirstInternal(e,n){const i=this.getKeyForAutomaticLookahead(T2,e);this.atLeastOneSepFirstInternalLogic(e,n,i)}atLeastOneSepFirstInternalLogic(e,n,i){const r=n.DEF,s=n.SEP;if(this.getLaFuncFromCache(i).call(this)===!0){r.call(this);const o=()=>this.tokenMatcher(this.LA(1),s);for(;this.tokenMatcher(this.LA(1),s)===!0;)this.CONSUME(s),r.call(this);this.attemptInRepetitionRecovery(this.repetitionSepSecondInternal,[e,s,o,r,yne],o,T2,e,yne)}else throw this.raiseEarlyExitException(e,Eo.REPETITION_MANDATORY_WITH_SEPARATOR,n.ERR_MSG)}manyInternal(e,n){const i=this.getKeyForAutomaticLookahead(rq,e);return this.manyInternalLogic(e,n,i)}manyInternalLogic(e,n,i){let r=this.getLaFuncFromCache(i),s;if(typeof n!="function"){s=n.DEF;const o=n.GATE;if(o!==void 0){const c=r;r=()=>o.call(this)&&c.call(this)}}else s=n;let a=!0;for(;r.call(this)===!0&&a===!0;)a=this.doSingleRepetition(s);this.attemptInRepetitionRecovery(this.manyInternal,[e,n],r,rq,e,FVe,a)}manySepFirstInternal(e,n){const i=this.getKeyForAutomaticLookahead(aq,e);this.manySepFirstInternalLogic(e,n,i)}manySepFirstInternalLogic(e,n,i){const r=n.DEF,s=n.SEP;if(this.getLaFuncFromCache(i).call(this)===!0){r.call(this);const o=()=>this.tokenMatcher(this.LA(1),s);for(;this.tokenMatcher(this.LA(1),s)===!0;)this.CONSUME(s),r.call(this);this.attemptInRepetitionRecovery(this.repetitionSepSecondInternal,[e,s,o,r,_ne],o,aq,e,_ne)}}repetitionSepSecondInternal(e,n,i,r,s){for(;i();)this.CONSUME(n),r.call(this);this.attemptInRepetitionRecovery(this.repetitionSepSecondInternal,[e,n,i,r,s],i,T2,e,s)}doSingleRepetition(e){const n=this.getLexerPosition();return e.call(this),this.getLexerPosition()>n}orInternal(e,n){const i=this.getKeyForAutomaticLookahead(Bme,n),r=$r(e)?e:e.DEF,a=this.getLaFuncFromCache(i).call(this,r);if(a!==void 0)return r[a].ALT.call(this);this.raiseNoAltException(n,e.ERR_MSG)}ruleFinallyStateUpdate(){if(this.RULE_STACK.pop(),this.RULE_OCCURRENCE_STACK.pop(),this.cstFinallyStateUpdate(),this.RULE_STACK.length===0&&this.isAtEndOfInput()===!1){const e=this.LA(1),n=this.errorMessageProvider.buildNotAllInputParsedMessage({firstRedundant:e,ruleName:this.getCurrRuleFullName()});this.SAVE_ERROR(new dGe(n,e))}}subruleInternal(e,n,i){let r;try{const s=i!==void 0?i.ARGS:void 0;return this.subruleIdx=n,r=e.apply(this,s),this.cstPostNonTerminal(r,i!==void 0&&i.LABEL!==void 0?i.LABEL:e.ruleName),r}catch(s){throw this.subruleInternalError(s,i,e.ruleName)}}subruleInternalError(e,n,i){throw qU(e)&&e.partialCstResult!==void 0&&(this.cstPostNonTerminal(e.partialCstResult,n!==void 0&&n.LABEL!==void 0?n.LABEL:i),delete e.partialCstResult),e}consumeInternal(e,n,i){let r;try{const s=this.LA(1);this.tokenMatcher(s,e)===!0?(this.consumeToken(),r=s):this.consumeInternalError(e,s,i)}catch(s){r=this.consumeInternalRecovery(e,n,s)}return this.cstPostTerminal(i!==void 0&&i.LABEL!==void 0?i.LABEL:e.name,r),r}consumeInternalError(e,n,i){let r;const s=this.LA(0);throw i!==void 0&&i.ERR_MSG?r=i.ERR_MSG:r=this.errorMessageProvider.buildMismatchTokenMessage({expected:e,actual:n,previous:s,ruleName:this.getCurrRuleFullName()}),this.SAVE_ERROR(new Lme(r,n,s))}consumeInternalRecovery(e,n,i){if(this.recoveryEnabled&&i.name==="MismatchedTokenException"&&!this.isBackTracking()){const r=this.getFollowsForInRuleRecovery(e,n);try{return this.tryInRuleRecovery(e,r)}catch(s){throw s.name===Ume?i:s}}else throw i}saveRecogState(){const e=this.errors,n=Gl(this.RULE_STACK);return{errors:e,lexerState:this.exportLexerState(),RULE_STACK:n,CST_STACK:this.CST_STACK}}reloadRecogState(e){this.errors=e.errors,this.importLexerState(e.lexerState),this.RULE_STACK=e.RULE_STACK}ruleInvocationStateUpdate(e,n,i){this.RULE_OCCURRENCE_STACK.push(i),this.RULE_STACK.push(e),this.cstInvocationStateUpdate(n)}isBackTracking(){return this.isBackTrackingStack.length!==0}getCurrRuleFullName(){const e=this.getLastExplicitRuleShortName();return this.shortRuleNameToFull[e]}shortRuleNameToFullName(e){return this.shortRuleNameToFull[e]}isAtEndOfInput(){return this.tokenMatcher(this.LA(1),WT)}reset(){this.resetLexerState(),this.subruleIdx=0,this.isBackTrackingStack=[],this.errors=[],this.RULE_STACK=[],this.CST_STACK=[],this.RULE_OCCURRENCE_STACK=[]}}class PGe{initErrorHandler(e){this._errors=[],this.errorMessageProvider=Ei(e,"errorMessageProvider")?e.errorMessageProvider:T_.errorMessageProvider}SAVE_ERROR(e){if(qU(e))return e.context={ruleStack:this.getHumanReadableRuleStack(),ruleOccurrenceStack:Gl(this.RULE_OCCURRENCE_STACK)},this._errors.push(e),e;throw Error("Trying to save an Error which is not a RecognitionException")}get errors(){return Gl(this._errors)}set errors(e){this._errors=e}raiseEarlyExitException(e,n,i){const r=this.getCurrRuleFullName(),s=this.getGAstProductions()[r],o=D9(e,s,n,this.maxLookahead)[0],c=[];for(let u=1;u<=this.maxLookahead;u++)c.push(this.LA(u));const l=this.errorMessageProvider.buildEarlyExitMessage({expectedIterationPaths:o,actual:c,previous:this.LA(0),customUserDescription:i,ruleName:r});throw this.SAVE_ERROR(new pGe(l,this.LA(1),this.LA(0)))}raiseNoAltException(e,n){const i=this.getCurrRuleFullName(),r=this.getGAstProductions()[i],s=k9(e,r,this.maxLookahead),a=[];for(let l=1;l<=this.maxLookahead;l++)a.push(this.LA(l));const o=this.LA(0),c=this.errorMessageProvider.buildNoViableAltMessage({expectedPathsPerAlt:s,actual:a,previous:o,customUserDescription:n,ruleName:this.getCurrRuleFullName()});throw this.SAVE_ERROR(new fGe(c,this.LA(1),o))}}class LGe{initContentAssist(){}computeContentAssist(e,n){const i=this.gastProductionsCache[e];if(S_(i))throw Error(`Rule ->${e}<- does not exist in this grammar.`);return xme([i],n,this.tokenMatcher,this.maxLookahead)}getNextPossibleTokenTypes(e){const n=vm(e.ruleStack),r=this.getGAstProductions()[n];return new BVe(r,e).startWalking()}}const NF={description:"This Object indicates the Parser is during Recording Phase"};Object.freeze(NF);const Tne=!0,xne=Math.pow(2,TE)-1,Hme=ld({name:"RECORDING_PHASE_TOKEN",pattern:zc.NA});zI([Hme]);const jme=HI(Hme,`This IToken indicates the Parser is in Recording Phase
	See: https://chevrotain.io/docs/guide/internals.html#grammar-recording for details`,-1,-1,-1,-1,-1,-1);Object.freeze(jme);const UGe={name:`This CSTNode indicates the Parser is in Recording Phase
	See: https://chevrotain.io/docs/guide/internals.html#grammar-recording for details`,children:{}};class BGe{initGastRecorder(e){this.recordingProdStack=[],this.RECORDING_PHASE=!1}enableRecording(){this.RECORDING_PHASE=!0,this.TRACE_INIT("Enable Recording",()=>{for(let e=0;e<10;e++){const n=e>0?e:"";this[`CONSUME${n}`]=function(i,r){return this.consumeInternalRecord(i,e,r)},this[`SUBRULE${n}`]=function(i,r){return this.subruleInternalRecord(i,e,r)},this[`OPTION${n}`]=function(i){return this.optionInternalRecord(i,e)},this[`OR${n}`]=function(i){return this.orInternalRecord(i,e)},this[`MANY${n}`]=function(i){this.manyInternalRecord(e,i)},this[`MANY_SEP${n}`]=function(i){this.manySepFirstInternalRecord(e,i)},this[`AT_LEAST_ONE${n}`]=function(i){this.atLeastOneInternalRecord(e,i)},this[`AT_LEAST_ONE_SEP${n}`]=function(i){this.atLeastOneSepFirstInternalRecord(e,i)}}this.consume=function(e,n,i){return this.consumeInternalRecord(n,e,i)},this.subrule=function(e,n,i){return this.subruleInternalRecord(n,e,i)},this.option=function(e,n){return this.optionInternalRecord(n,e)},this.or=function(e,n){return this.orInternalRecord(n,e)},this.many=function(e,n){this.manyInternalRecord(e,n)},this.atLeastOne=function(e,n){this.atLeastOneInternalRecord(e,n)},this.ACTION=this.ACTION_RECORD,this.BACKTRACK=this.BACKTRACK_RECORD,this.LA=this.LA_RECORD})}disableRecording(){this.RECORDING_PHASE=!1,this.TRACE_INIT("Deleting Recording methods",()=>{const e=this;for(let n=0;n<10;n++){const i=n>0?n:"";delete e[`CONSUME${i}`],delete e[`SUBRULE${i}`],delete e[`OPTION${i}`],delete e[`OR${i}`],delete e[`MANY${i}`],delete e[`MANY_SEP${i}`],delete e[`AT_LEAST_ONE${i}`],delete e[`AT_LEAST_ONE_SEP${i}`]}delete e.consume,delete e.subrule,delete e.option,delete e.or,delete e.many,delete e.atLeastOne,delete e.ACTION,delete e.BACKTRACK,delete e.LA})}ACTION_RECORD(e){}BACKTRACK_RECORD(e,n){return()=>!0}LA_RECORD(e){return WU}topLevelRuleRecord(e,n){try{const i=new LA({definition:[],name:e});return i.name=e,this.recordingProdStack.push(i),n.call(this),this.recordingProdStack.pop(),i}catch(i){if(i.KNOWN_RECORDER_ERROR!==!0)try{i.message=i.message+`
	 This error was thrown during the "grammar recording phase" For more info see:
	https://chevrotain.io/docs/guide/internals.html#grammar-recording`}catch{throw i}throw i}}optionInternalRecord(e,n){return UR.call(this,tf,e,n)}atLeastOneInternalRecord(e,n){UR.call(this,_0,n,e)}atLeastOneSepFirstInternalRecord(e,n){UR.call(this,y0,n,e,Tne)}manyInternalRecord(e,n){UR.call(this,Uc,n,e)}manySepFirstInternalRecord(e,n){UR.call(this,Tm,n,e,Tne)}orInternalRecord(e,n){return FGe.call(this,e,n)}subruleInternalRecord(e,n,i){if($U(n),!e||Ei(e,"ruleName")===!1){const o=new Error(`<SUBRULE${wne(n)}> argument is invalid expecting a Parser method reference but got: <${JSON.stringify(e)}>
 inside top level rule: <${this.recordingProdStack[0].name}>`);throw o.KNOWN_RECORDER_ERROR=!0,o}const r=jC(this.recordingProdStack),s=e.ruleName,a=new lf({idx:n,nonTerminalName:s,label:i==null?void 0:i.LABEL,referencedRule:void 0});return r.definition.push(a),this.outputCst?UGe:NF}consumeInternalRecord(e,n,i){if($U(n),!Eme(e)){const a=new Error(`<CONSUME${wne(n)}> argument is invalid expecting a TokenType reference but got: <${JSON.stringify(e)}>
 inside top level rule: <${this.recordingProdStack[0].name}>`);throw a.KNOWN_RECORDER_ERROR=!0,a}const r=jC(this.recordingProdStack),s=new to({idx:n,terminalType:e,label:i==null?void 0:i.LABEL});return r.definition.push(s),jme}}function UR(t,e,n,i=!1){$U(n);const r=jC(this.recordingProdStack),s=k_(e)?e:e.DEF,a=new t({definition:[],idx:n});return i&&(a.separator=e.SEP),Ei(e,"MAX_LOOKAHEAD")&&(a.maxLookahead=e.MAX_LOOKAHEAD),this.recordingProdStack.push(a),s.call(this),r.definition.push(a),this.recordingProdStack.pop(),NF}function FGe(t,e){$U(e);const n=jC(this.recordingProdStack),i=$r(t)===!1,r=i===!1?t:t.DEF,s=new xm({definition:[],idx:e,ignoreAmbiguities:i&&t.IGNORE_AMBIGUITIES===!0});Ei(t,"MAX_LOOKAHEAD")&&(s.maxLookahead=t.MAX_LOOKAHEAD);const a=O9(r,o=>k_(o.GATE));return s.hasPredicates=a,n.definition.push(s),Oi(r,o=>{const c=new uf({definition:[]});s.definition.push(c),Ei(o,"IGNORE_AMBIGUITIES")?c.ignoreAmbiguities=o.IGNORE_AMBIGUITIES:Ei(o,"GATE")&&(c.ignoreAmbiguities=!0),this.recordingProdStack.push(c),o.ALT.call(this),this.recordingProdStack.pop()}),NF}function wne(t){return t===0?"":`${t}`}function $U(t){if(t<0||t>xne){const e=new Error(`Invalid DSL Method idx value: <${t}>
	Idx value must be a none negative value smaller than ${xne+1}`);throw e.KNOWN_RECORDER_ERROR=!0,e}}class zGe{initPerformanceTracer(e){if(Ei(e,"traceInitPerf")){const n=e.traceInitPerf,i=typeof n=="number";this.traceInitMaxIdent=i?n:1/0,this.traceInitPerf=i?n>0:n}else this.traceInitMaxIdent=0,this.traceInitPerf=T_.traceInitPerf;this.traceInitIndent=-1}TRACE_INIT(e,n){if(this.traceInitPerf===!0){this.traceInitIndent++;const i=new Array(this.traceInitIndent+1).join("	");this.traceInitIndent<this.traceInitMaxIdent&&console.log(`${i}--> <${e}>`);const{time:r,value:s}=hme(n),a=r>10?console.warn:console.log;return this.traceInitIndent<this.traceInitMaxIdent&&a(`${i}<-- <${e}> time: ${r}ms`),this.traceInitIndent--,s}else return n()}}function HGe(t,e){e.forEach(n=>{const i=n.prototype;Object.getOwnPropertyNames(i).forEach(r=>{if(r==="constructor")return;const s=Object.getOwnPropertyDescriptor(i,r);s&&(s.get||s.set)?Object.defineProperty(t.prototype,r,s):t.prototype[r]=n.prototype[r]})})}const WU=HI(WT,"",NaN,NaN,NaN,NaN,NaN,NaN);Object.freeze(WU);const T_=Object.freeze({recoveryEnabled:!1,maxLookahead:3,dynamicTokensEnabled:!1,outputCst:!0,errorMessageProvider:Tme,nodeLocationTracking:"none",traceInitPerf:!1,skipValidations:!1}),YU=Object.freeze({recoveryValueFunc:()=>{},resyncEnabled:!0});var ch;(function(t){t[t.INVALID_RULE_NAME=0]="INVALID_RULE_NAME",t[t.DUPLICATE_RULE_NAME=1]="DUPLICATE_RULE_NAME",t[t.INVALID_RULE_OVERRIDE=2]="INVALID_RULE_OVERRIDE",t[t.DUPLICATE_PRODUCTIONS=3]="DUPLICATE_PRODUCTIONS",t[t.UNRESOLVED_SUBRULE_REF=4]="UNRESOLVED_SUBRULE_REF",t[t.LEFT_RECURSION=5]="LEFT_RECURSION",t[t.NONE_LAST_EMPTY_ALT=6]="NONE_LAST_EMPTY_ALT",t[t.AMBIGUOUS_ALTS=7]="AMBIGUOUS_ALTS",t[t.CONFLICT_TOKENS_RULES_NAMESPACE=8]="CONFLICT_TOKENS_RULES_NAMESPACE",t[t.INVALID_TOKEN_NAME=9]="INVALID_TOKEN_NAME",t[t.NO_NON_EMPTY_LOOKAHEAD=10]="NO_NON_EMPTY_LOOKAHEAD",t[t.AMBIGUOUS_PREFIX_ALTS=11]="AMBIGUOUS_PREFIX_ALTS",t[t.TOO_MANY_ALTS=12]="TOO_MANY_ALTS",t[t.CUSTOM_LOOKAHEAD_VALIDATION=13]="CUSTOM_LOOKAHEAD_VALIDATION"})(ch||(ch={}));let L9=class Vme{static performSelfAnalysis(e){throw Error("The **static** `performSelfAnalysis` method has been deprecated.	\nUse the **instance** method with the same name instead.")}performSelfAnalysis(){this.TRACE_INIT("performSelfAnalysis",()=>{let e;this.selfAnalysisDone=!0;const n=this.className;this.TRACE_INIT("toFastProps",()=>{fme(this)}),this.TRACE_INIT("Grammar Recording",()=>{try{this.enableRecording(),Oi(this.definedRulesNames,r=>{const a=this[r].originalGrammarAction;let o;this.TRACE_INIT(`${r} Rule`,()=>{o=this.topLevelRuleRecord(r,a)}),this.gastProductionsCache[r]=o})}finally{this.disableRecording()}});let i=[];if(this.TRACE_INIT("Grammar Resolving",()=>{i=uGe({rules:uc(this.gastProductionsCache)}),this.definitionErrors=this.definitionErrors.concat(i)}),this.TRACE_INIT("Grammar Validations",()=>{if(sa(i)&&this.skipValidations===!1){const r=hGe({rules:uc(this.gastProductionsCache),tokenTypes:uc(this.tokensMap),errMsgProvider:uT,grammarName:n}),s=XVe({lookaheadStrategy:this.lookaheadStrategy,rules:uc(this.gastProductionsCache),tokenTypes:uc(this.tokensMap),grammarName:n});this.definitionErrors=this.definitionErrors.concat(r,s)}}),sa(this.definitionErrors)&&(this.recoveryEnabled&&this.TRACE_INIT("computeAllProdsFollows",()=>{const r=jje(uc(this.gastProductionsCache));this.resyncFollows=r}),this.TRACE_INIT("ComputeLookaheadFunctions",()=>{var r,s;(s=(r=this.lookaheadStrategy).initialize)===null||s===void 0||s.call(r,{rules:uc(this.gastProductionsCache)}),this.preComputeLookaheadFunctions(uc(this.gastProductionsCache))})),!Vme.DEFER_DEFINITION_ERRORS_HANDLING&&!sa(this.definitionErrors))throw e=Dn(this.definitionErrors,r=>r.message),new Error(`Parser Definition Errors detected:
 ${e.join(`
-------------------------------
`)}`)})}constructor(e,n){this.definitionErrors=[],this.selfAnalysisDone=!1;const i=this;if(i.initErrorHandler(n),i.initLexerAdapter(),i.initLooksAhead(n),i.initRecognizerEngine(e,n),i.initRecoverable(n),i.initTreeBuilder(n),i.initContentAssist(),i.initGastRecorder(n),i.initPerformanceTracer(n),Ei(n,"ignoredIssues"))throw new Error(`The <ignoredIssues> IParserConfig property has been deprecated.
	Please use the <IGNORE_AMBIGUITIES> flag on the relevant DSL method instead.
	See: https://chevrotain.io/docs/guide/resolving_grammar_errors.html#IGNORING_AMBIGUITIES
	For further details.`);this.skipValidations=Ei(n,"skipValidations")?n.skipValidations:T_.skipValidations}};L9.DEFER_DEFINITION_ERRORS_HANDLING=!1;HGe(L9,[gGe,bGe,NGe,IGe,DGe,kGe,PGe,LGe,BGe,zGe]);class jGe extends L9{constructor(e,n=T_){const i=Gl(n);i.outputCst=!0,super(e,i)}}function VGe(t){const e=new GGe,n=uc(t);return Dn(n,i=>e.visitRule(i))}class GGe extends A1{visitRule(e){const n=this.visitEach(e.definition),i=lme(n,s=>s.propertyName),r=Dn(i,(s,a)=>{const o=!O9(s,l=>!l.canBeNull);let c=s[0].type;return s.length>1&&(c=Dn(s,l=>l.type)),{name:a,type:c,optional:o}});return{name:e.name,properties:r}}visitAlternative(e){return this.visitEachAndOverrideWith(e.definition,{canBeNull:!0})}visitOption(e){return this.visitEachAndOverrideWith(e.definition,{canBeNull:!0})}visitRepetition(e){return this.visitEachAndOverrideWith(e.definition,{canBeNull:!0})}visitRepetitionMandatory(e){return this.visitEach(e.definition)}visitRepetitionMandatoryWithSeparator(e){return this.visitEach(e.definition).concat({propertyName:e.separator.name,canBeNull:!0,type:dP(e.separator)})}visitRepetitionWithSeparator(e){return this.visitEachAndOverrideWith(e.definition,{canBeNull:!0}).concat({propertyName:e.separator.name,canBeNull:!0,type:dP(e.separator)})}visitAlternation(e){return this.visitEachAndOverrideWith(e.definition,{canBeNull:!0})}visitTerminal(e){return[{propertyName:e.label||e.terminalType.name,canBeNull:!1,type:dP(e)}]}visitNonTerminal(e){return[{propertyName:e.label||e.nonTerminalName,canBeNull:!1,type:dP(e)}]}visitEachAndOverrideWith(e,n){return Dn(this.visitEach(e),i=>af({},i,n))}visitEach(e){return ef(Dn(e,n=>this.visit(n)))}}function dP(t){return t instanceof lf?{kind:"rule",name:t.referencedRule.name}:{kind:"token"}}function qGe(t,e){let n=[];return n=n.concat('import type { CstNode, ICstVisitor, IToken } from "chevrotain";'),n=n.concat(ef(Dn(t,i=>$Ge(i)))),e.includeVisitorInterface&&(n=n.concat(KGe(e.visitorInterfaceName,t))),n.join(`

`)+`
`}function $Ge(t){const e=WGe(t),n=YGe(t);return[e,n]}function WGe(t){const e=Gme(t.name),n=U9(t.name);return`export interface ${e} extends CstNode {
  name: "${t.name}";
  children: ${n};
}`}function YGe(t){return`export type ${U9(t.name)} = {
  ${Dn(t.properties,n=>XGe(n)).join(`
  `)}
};`}function XGe(t){const e=JGe(t.type);return`${t.name}${t.optional?"?":""}: ${e}[];`}function KGe(t,e){return`export interface ${t}<IN, OUT> extends ICstVisitor<IN, OUT> {
  ${Dn(e,n=>ZGe(n)).join(`
  `)}
}`}function ZGe(t){const e=U9(t.name);return`${t.name}(children: ${e}, param?: IN): OUT;`}function JGe(t){if($r(t)){const e=CF(Dn(t,i=>Cne(i)));return"("+cf(e,(i,r)=>i+" | "+r)+")"}else return Cne(t)}function Cne(t){return t.kind==="token"?"IToken":Gme(t.name)}function Gme(t){return Xpe(t)+"CstNode"}function U9(t){return Xpe(t)+"CstChildren"}const QGe={includeVisitorInterface:!0,visitorInterfaceName:"ICstNodeVisitor"};function eqe(t,e){const n=Object.assign(Object.assign({},QGe),e),i=VGe(t);return qGe(i,n)}const t0=!!JSON.parse("false"),tqe=!!JSON.parse("false"),nqe=!!JSON.parse("false"),iqe=!!JSON.parse("false");JSON.parse("false");const rqe=!!JSON.parse("false"),sqe=!!JSON.parse("false"),aqe=!!JSON.parse("false"),kn={HALT_AT_COUNT:256,DRAW_CHAR_SCALE:2,DRAW_CHAR_WIDTH(){return Gg*kn.DRAW_CHAR_SCALE},DRAW_CHAR_HEIGHT(){return qg*kn.DRAW_CHAR_SCALE}};function B9(t,e,n){typeof t!="number"&&(t=0,e=0,n=1),typeof e!="number"&&(e=t,t=0,n=1),typeof n!="number"&&(n=1);const i=[],r=Math.min(t,e),s=Math.max(t,e);for(let a=r;a<=s;a+=n)i.push(a);return i}function oqe(t){return t[Zd(0,t.length-1)]}function cqe(t,e){return e[gde(t,0,e.length-1)]}function Za(...t){return oqe(t.flat())}function qme(t,...e){return cqe(t,e.flat())}function lqe(t){return[...new Set(t)].filter(se)}function uqe(t,e){return t%e}function hqe(t,e){return Math.floor(t/e)}function Ane(t,e){return{x:uqe(t,e),y:hqe(t,e)}}function YT(t,e){return t.x+t.y*e}function nm(t,e,n,i,r,s){return t>=s&&t<=i&&e>=n&&e<=r}function Rne(t,e,n,i){const r=[],s=Math.abs(n-t),a=Math.abs(i-e),o=t<n?1:-1,c=e<i?1:-1;let l=s-a;for(r.push({x:t,y:e});t!==n||e!==i;){const u=2*l;u>-a&&(l-=a,t+=o),u<s&&(l+=s,e+=c),r.push({x:t,y:e})}return r}const fqe=66.666,F9=Math.round(1e3/fqe),dqe=3;function Bd(t){return new Promise(e=>setTimeout(e,t))}function GC(t){return se(t)&&se(t.x)&&se(t.y)}function ac(t,e){switch(e){case rn.NORTH:--t.y;break;case rn.SOUTH:++t.y;break;case rn.WEST:--t.x;break;case rn.EAST:++t.x;break}return t}function Fv(t,e){const n=e.x-t.x,i=e.y-t.y;if(n<0)return rn.WEST;if(n>0)return rn.EAST;if(i<0)return rn.NORTH;if(i>0)return rn.SOUTH}const $me={idle:"IDLE",up:"NORTH",down:"SOUTH",left:"WEST",right:"EAST",by:"BY",at:"AT",flow:"FLOW",seek:"SEEK",rndns:"RNDNS",rndne:"RNDNE",rnd:"RND",cw:"CW",ccw:"CCW",opp:"OPP",rndp:"RNDP",away:"AWAY",toward:"TOWARD",player:"PLAYER",find:"FIND",flee:"FLEE",to:"TO",i:"IDLE",u:"NORTH",north:"NORTH",n:"NORTH",d:"SOUTH",south:"SOUTH",s:"SOUTH",l:"WEST",west:"WEST",w:"WEST",r:"EAST",east:"EAST",e:"EAST"};function x_(t){return Li(t)&&Wme(t[0])}function Wme(t){return se(rn[t])&&On(t)}function pqe(t){const e=rn[t];return se(e)?e:rn.IDLE}function z9(t){if(On(t))return $me[si(t)]}function mqe(t){if(x_(t))return t;if(Wme(t))return[t];const e=z9(t);if(se(e))return[e]}function Mne(t){const e=ne.words[t],n=mqe(e);return x_(n)?[n,t+1]:[void 0,t]}function Yme(t){var r,s;const e=[];let[n,i]=Mne(t);for(;x_(n);){switch(e.push(...n),n[0]){case"AT":case"BY":case"AWAY":case"TOWARD":{const[c,l,u]=Ct(ne.words,i,[Ze.NUMBER,Ze.NUMBER]);e.push(c,l),i=u;break}case"FLEE":case"FIND":{const[c,l]=Ct(ne.words,i,[Ze.DIR]);e.push(c.x,c.y),i=l;break}case"TO":{const[c,l,u]=Ct(ne.words,i,[Ze.DIR,Ze.DIR]),h=((r=ne.element)==null?void 0:r.x)??0,f=((s=ne.element)==null?void 0:s.y)??0;c.x-=h,c.y-=f,l.x-=h,l.y-=f,e.push(h+c.x+l.x,f+c.y+l.y),i=u;break}}switch(n[0]){case"CW":case"CCW":case"OPP":case"RNDP":break;default:return[e,i]}const[a,o]=Mne(i);n=a,i=o}return e.length?[e,i]:[void 0,t]}function qC(t){return Li(t)&&typeof t[0]=="string"}function gqe(t){const e=ne.words[t];return On(e)?[e,t+1]:[void 0,t]}function One(t){const e=ne.words[t];if(qC(e))return[e,t+1];const[n,i]=YY(t),[r,s]=gqe(i);return On(r)?[[r,n],s]:[void 0,t]}function cq(t){if(!qC(t))return;const[e]=t;return e}function Xme(t){if(!qC(t))return;const[,e]=t,n=se(e)?_Xe(e):void 0;return se(n)?n:void 0}function Kme(t){if(!qC(t))return;const[,e]=t,n=se(e)?yXe(e):void 0;return se(n)?n:void 0}var Xc={},IF={};IF.byteLength=yqe;IF.toByteArray=Eqe;IF.fromByteArray=xqe;var Rg=[],Ld=[],vqe=typeof Uint8Array<"u"?Uint8Array:Array,D5="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";for(var Hx=0,_qe=D5.length;Hx<_qe;++Hx)Rg[Hx]=D5[Hx],Ld[D5.charCodeAt(Hx)]=Hx;Ld[45]=62;Ld[95]=63;function Zme(t){var e=t.length;if(e%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var n=t.indexOf("=");n===-1&&(n=e);var i=n===e?0:4-n%4;return[n,i]}function yqe(t){var e=Zme(t),n=e[0],i=e[1];return(n+i)*3/4-i}function bqe(t,e,n){return(e+n)*3/4-n}function Eqe(t){var e,n=Zme(t),i=n[0],r=n[1],s=new vqe(bqe(t,i,r)),a=0,o=r>0?i-4:i,c;for(c=0;c<o;c+=4)e=Ld[t.charCodeAt(c)]<<18|Ld[t.charCodeAt(c+1)]<<12|Ld[t.charCodeAt(c+2)]<<6|Ld[t.charCodeAt(c+3)],s[a++]=e>>16&255,s[a++]=e>>8&255,s[a++]=e&255;return r===2&&(e=Ld[t.charCodeAt(c)]<<2|Ld[t.charCodeAt(c+1)]>>4,s[a++]=e&255),r===1&&(e=Ld[t.charCodeAt(c)]<<10|Ld[t.charCodeAt(c+1)]<<4|Ld[t.charCodeAt(c+2)]>>2,s[a++]=e>>8&255,s[a++]=e&255),s}function Sqe(t){return Rg[t>>18&63]+Rg[t>>12&63]+Rg[t>>6&63]+Rg[t&63]}function Tqe(t,e,n){for(var i,r=[],s=e;s<n;s+=3)i=(t[s]<<16&16711680)+(t[s+1]<<8&65280)+(t[s+2]&255),r.push(Sqe(i));return r.join("")}function xqe(t){for(var e,n=t.length,i=n%3,r=[],s=16383,a=0,o=n-i;a<o;a+=s)r.push(Tqe(t,a,a+s>o?o:a+s));return i===1?(e=t[n-1],r.push(Rg[e>>2]+Rg[e<<4&63]+"==")):i===2&&(e=(t[n-2]<<8)+t[n-1],r.push(Rg[e>>10]+Rg[e>>4&63]+Rg[e<<2&63]+"=")),r.join("")}var H9={};/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */H9.read=function(t,e,n,i,r){var s,a,o=r*8-i-1,c=(1<<o)-1,l=c>>1,u=-7,h=n?r-1:0,f=n?-1:1,d=t[e+h];for(h+=f,s=d&(1<<-u)-1,d>>=-u,u+=o;u>0;s=s*256+t[e+h],h+=f,u-=8);for(a=s&(1<<-u)-1,s>>=-u,u+=i;u>0;a=a*256+t[e+h],h+=f,u-=8);if(s===0)s=1-l;else{if(s===c)return a?NaN:(d?-1:1)*(1/0);a=a+Math.pow(2,i),s=s-l}return(d?-1:1)*a*Math.pow(2,s-i)};H9.write=function(t,e,n,i,r,s){var a,o,c,l=s*8-r-1,u=(1<<l)-1,h=u>>1,f=r===23?Math.pow(2,-24)-Math.pow(2,-77):0,d=i?0:s-1,p=i?1:-1,g=e<0||e===0&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(o=isNaN(e)?1:0,a=u):(a=Math.floor(Math.log(e)/Math.LN2),e*(c=Math.pow(2,-a))<1&&(a--,c*=2),a+h>=1?e+=f/c:e+=f*Math.pow(2,1-h),e*c>=2&&(a++,c/=2),a+h>=u?(o=0,a=u):a+h>=1?(o=(e*c-1)*Math.pow(2,r),a=a+h):(o=e*Math.pow(2,h-1)*Math.pow(2,r),a=0));r>=8;t[n+d]=o&255,d+=p,o/=256,r-=8);for(a=a<<r|o,l+=r;l>0;t[n+d]=a&255,d+=p,a/=256,l-=8);t[n+d-p]|=g*128};/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */(function(t){const e=IF,n=H9,i=typeof Symbol=="function"&&typeof Symbol.for=="function"?Symbol.for("nodejs.util.inspect.custom"):null;t.Buffer=u,t.SlowBuffer=M,t.INSPECT_MAX_BYTES=50;const r=2147483647;t.kMaxLength=r;const{Uint8Array:s,ArrayBuffer:a,SharedArrayBuffer:o}=globalThis;u.TYPED_ARRAY_SUPPORT=c(),!u.TYPED_ARRAY_SUPPORT&&typeof console<"u"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function c(){try{const ce=new s(1),j={foo:function(){return 42}};return Object.setPrototypeOf(j,s.prototype),Object.setPrototypeOf(ce,j),ce.foo()===42}catch{return!1}}Object.defineProperty(u.prototype,"parent",{enumerable:!0,get:function(){if(u.isBuffer(this))return this.buffer}}),Object.defineProperty(u.prototype,"offset",{enumerable:!0,get:function(){if(u.isBuffer(this))return this.byteOffset}});function l(ce){if(ce>r)throw new RangeError('The value "'+ce+'" is invalid for option "size"');const j=new s(ce);return Object.setPrototypeOf(j,u.prototype),j}function u(ce,j,W){if(typeof ce=="number"){if(typeof j=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return p(ce)}return h(ce,j,W)}u.poolSize=8192;function h(ce,j,W){if(typeof ce=="string")return g(ce,j);if(a.isView(ce))return v(ce);if(ce==null)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof ce);if($e(ce,a)||ce&&$e(ce.buffer,a)||typeof o<"u"&&($e(ce,o)||ce&&$e(ce.buffer,o)))return b(ce,j,W);if(typeof ce=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');const me=ce.valueOf&&ce.valueOf();if(me!=null&&me!==ce)return u.from(me,j,W);const De=T(ce);if(De)return De;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof ce[Symbol.toPrimitive]=="function")return u.from(ce[Symbol.toPrimitive]("string"),j,W);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof ce)}u.from=function(ce,j,W){return h(ce,j,W)},Object.setPrototypeOf(u.prototype,s.prototype),Object.setPrototypeOf(u,s);function f(ce){if(typeof ce!="number")throw new TypeError('"size" argument must be of type number');if(ce<0)throw new RangeError('The value "'+ce+'" is invalid for option "size"')}function d(ce,j,W){return f(ce),ce<=0?l(ce):j!==void 0?typeof W=="string"?l(ce).fill(j,W):l(ce).fill(j):l(ce)}u.alloc=function(ce,j,W){return d(ce,j,W)};function p(ce){return f(ce),l(ce<0?0:x(ce)|0)}u.allocUnsafe=function(ce){return p(ce)},u.allocUnsafeSlow=function(ce){return p(ce)};function g(ce,j){if((typeof j!="string"||j==="")&&(j="utf8"),!u.isEncoding(j))throw new TypeError("Unknown encoding: "+j);const W=R(ce,j)|0;let me=l(W);const De=me.write(ce,j);return De!==W&&(me=me.slice(0,De)),me}function y(ce){const j=ce.length<0?0:x(ce.length)|0,W=l(j);for(let me=0;me<j;me+=1)W[me]=ce[me]&255;return W}function v(ce){if($e(ce,s)){const j=new s(ce);return b(j.buffer,j.byteOffset,j.byteLength)}return y(ce)}function b(ce,j,W){if(j<0||ce.byteLength<j)throw new RangeError('"offset" is outside of buffer bounds');if(ce.byteLength<j+(W||0))throw new RangeError('"length" is outside of buffer bounds');let me;return j===void 0&&W===void 0?me=new s(ce):W===void 0?me=new s(ce,j):me=new s(ce,j,W),Object.setPrototypeOf(me,u.prototype),me}function T(ce){if(u.isBuffer(ce)){const j=x(ce.length)|0,W=l(j);return W.length===0||ce.copy(W,0,0,j),W}if(ce.length!==void 0)return typeof ce.length!="number"||Ue(ce.length)?l(0):y(ce);if(ce.type==="Buffer"&&Array.isArray(ce.data))return y(ce.data)}function x(ce){if(ce>=r)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+r.toString(16)+" bytes");return ce|0}function M(ce){return+ce!=ce&&(ce=0),u.alloc(+ce)}u.isBuffer=function(j){return j!=null&&j._isBuffer===!0&&j!==u.prototype},u.compare=function(j,W){if($e(j,s)&&(j=u.from(j,j.offset,j.byteLength)),$e(W,s)&&(W=u.from(W,W.offset,W.byteLength)),!u.isBuffer(j)||!u.isBuffer(W))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(j===W)return 0;let me=j.length,De=W.length;for(let Ve=0,mt=Math.min(me,De);Ve<mt;++Ve)if(j[Ve]!==W[Ve]){me=j[Ve],De=W[Ve];break}return me<De?-1:De<me?1:0},u.isEncoding=function(j){switch(String(j).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},u.concat=function(j,W){if(!Array.isArray(j))throw new TypeError('"list" argument must be an Array of Buffers');if(j.length===0)return u.alloc(0);let me;if(W===void 0)for(W=0,me=0;me<j.length;++me)W+=j[me].length;const De=u.allocUnsafe(W);let Ve=0;for(me=0;me<j.length;++me){let mt=j[me];if($e(mt,s))Ve+mt.length>De.length?(u.isBuffer(mt)||(mt=u.from(mt)),mt.copy(De,Ve)):s.prototype.set.call(De,mt,Ve);else if(u.isBuffer(mt))mt.copy(De,Ve);else throw new TypeError('"list" argument must be an Array of Buffers');Ve+=mt.length}return De};function R(ce,j){if(u.isBuffer(ce))return ce.length;if(a.isView(ce)||$e(ce,a))return ce.byteLength;if(typeof ce!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof ce);const W=ce.length,me=arguments.length>2&&arguments[2]===!0;if(!me&&W===0)return 0;let De=!1;for(;;)switch(j){case"ascii":case"latin1":case"binary":return W;case"utf8":case"utf-8":return bt(ce).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return W*2;case"hex":return W>>>1;case"base64":return Xe(ce).length;default:if(De)return me?-1:bt(ce).length;j=(""+j).toLowerCase(),De=!0}}u.byteLength=R;function I(ce,j,W){let me=!1;if((j===void 0||j<0)&&(j=0),j>this.length||((W===void 0||W>this.length)&&(W=this.length),W<=0)||(W>>>=0,j>>>=0,W<=j))return"";for(ce||(ce="utf8");;)switch(ce){case"hex":return Re(this,j,W);case"utf8":case"utf-8":return J(this,j,W);case"ascii":return oe(this,j,W);case"latin1":case"binary":return fe(this,j,W);case"base64":return V(this,j,W);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return He(this,j,W);default:if(me)throw new TypeError("Unknown encoding: "+ce);ce=(ce+"").toLowerCase(),me=!0}}u.prototype._isBuffer=!0;function k(ce,j,W){const me=ce[j];ce[j]=ce[W],ce[W]=me}u.prototype.swap16=function(){const j=this.length;if(j%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let W=0;W<j;W+=2)k(this,W,W+1);return this},u.prototype.swap32=function(){const j=this.length;if(j%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let W=0;W<j;W+=4)k(this,W,W+3),k(this,W+1,W+2);return this},u.prototype.swap64=function(){const j=this.length;if(j%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let W=0;W<j;W+=8)k(this,W,W+7),k(this,W+1,W+6),k(this,W+2,W+5),k(this,W+3,W+4);return this},u.prototype.toString=function(){const j=this.length;return j===0?"":arguments.length===0?J(this,0,j):I.apply(this,arguments)},u.prototype.toLocaleString=u.prototype.toString,u.prototype.equals=function(j){if(!u.isBuffer(j))throw new TypeError("Argument must be a Buffer");return this===j?!0:u.compare(this,j)===0},u.prototype.inspect=function(){let j="";const W=t.INSPECT_MAX_BYTES;return j=this.toString("hex",0,W).replace(/(.{2})/g,"$1 ").trim(),this.length>W&&(j+=" ... "),"<Buffer "+j+">"},i&&(u.prototype[i]=u.prototype.inspect),u.prototype.compare=function(j,W,me,De,Ve){if($e(j,s)&&(j=u.from(j,j.offset,j.byteLength)),!u.isBuffer(j))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof j);if(W===void 0&&(W=0),me===void 0&&(me=j?j.length:0),De===void 0&&(De=0),Ve===void 0&&(Ve=this.length),W<0||me>j.length||De<0||Ve>this.length)throw new RangeError("out of range index");if(De>=Ve&&W>=me)return 0;if(De>=Ve)return-1;if(W>=me)return 1;if(W>>>=0,me>>>=0,De>>>=0,Ve>>>=0,this===j)return 0;let mt=Ve-De,xt=me-W;const Vn=Math.min(mt,xt),qe=this.slice(De,Ve),Vt=j.slice(W,me);for(let ht=0;ht<Vn;++ht)if(qe[ht]!==Vt[ht]){mt=qe[ht],xt=Vt[ht];break}return mt<xt?-1:xt<mt?1:0};function P(ce,j,W,me,De){if(ce.length===0)return-1;if(typeof W=="string"?(me=W,W=0):W>2147483647?W=2147483647:W<-2147483648&&(W=-2147483648),W=+W,Ue(W)&&(W=De?0:ce.length-1),W<0&&(W=ce.length+W),W>=ce.length){if(De)return-1;W=ce.length-1}else if(W<0)if(De)W=0;else return-1;if(typeof j=="string"&&(j=u.from(j,me)),u.isBuffer(j))return j.length===0?-1:U(ce,j,W,me,De);if(typeof j=="number")return j=j&255,typeof s.prototype.indexOf=="function"?De?s.prototype.indexOf.call(ce,j,W):s.prototype.lastIndexOf.call(ce,j,W):U(ce,[j],W,me,De);throw new TypeError("val must be string, number or Buffer")}function U(ce,j,W,me,De){let Ve=1,mt=ce.length,xt=j.length;if(me!==void 0&&(me=String(me).toLowerCase(),me==="ucs2"||me==="ucs-2"||me==="utf16le"||me==="utf-16le")){if(ce.length<2||j.length<2)return-1;Ve=2,mt/=2,xt/=2,W/=2}function Vn(Vt,ht){return Ve===1?Vt[ht]:Vt.readUInt16BE(ht*Ve)}let qe;if(De){let Vt=-1;for(qe=W;qe<mt;qe++)if(Vn(ce,qe)===Vn(j,Vt===-1?0:qe-Vt)){if(Vt===-1&&(Vt=qe),qe-Vt+1===xt)return Vt*Ve}else Vt!==-1&&(qe-=qe-Vt),Vt=-1}else for(W+xt>mt&&(W=mt-xt),qe=W;qe>=0;qe--){let Vt=!0;for(let ht=0;ht<xt;ht++)if(Vn(ce,qe+ht)!==Vn(j,ht)){Vt=!1;break}if(Vt)return qe}return-1}u.prototype.includes=function(j,W,me){return this.indexOf(j,W,me)!==-1},u.prototype.indexOf=function(j,W,me){return P(this,j,W,me,!0)},u.prototype.lastIndexOf=function(j,W,me){return P(this,j,W,me,!1)};function G(ce,j,W,me){W=Number(W)||0;const De=ce.length-W;me?(me=Number(me),me>De&&(me=De)):me=De;const Ve=j.length;me>Ve/2&&(me=Ve/2);let mt;for(mt=0;mt<me;++mt){const xt=parseInt(j.substr(mt*2,2),16);if(Ue(xt))return mt;ce[W+mt]=xt}return mt}function $(ce,j,W,me){return it(bt(j,ce.length-W),ce,W,me)}function q(ce,j,W,me){return it(be(j),ce,W,me)}function Y(ce,j,W,me){return it(Xe(j),ce,W,me)}function ie(ce,j,W,me){return it(ue(j,ce.length-W),ce,W,me)}u.prototype.write=function(j,W,me,De){if(W===void 0)De="utf8",me=this.length,W=0;else if(me===void 0&&typeof W=="string")De=W,me=this.length,W=0;else if(isFinite(W))W=W>>>0,isFinite(me)?(me=me>>>0,De===void 0&&(De="utf8")):(De=me,me=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");const Ve=this.length-W;if((me===void 0||me>Ve)&&(me=Ve),j.length>0&&(me<0||W<0)||W>this.length)throw new RangeError("Attempt to write outside buffer bounds");De||(De="utf8");let mt=!1;for(;;)switch(De){case"hex":return G(this,j,W,me);case"utf8":case"utf-8":return $(this,j,W,me);case"ascii":case"latin1":case"binary":return q(this,j,W,me);case"base64":return Y(this,j,W,me);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return ie(this,j,W,me);default:if(mt)throw new TypeError("Unknown encoding: "+De);De=(""+De).toLowerCase(),mt=!0}},u.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function V(ce,j,W){return j===0&&W===ce.length?e.fromByteArray(ce):e.fromByteArray(ce.slice(j,W))}function J(ce,j,W){W=Math.min(ce.length,W);const me=[];let De=j;for(;De<W;){const Ve=ce[De];let mt=null,xt=Ve>239?4:Ve>223?3:Ve>191?2:1;if(De+xt<=W){let Vn,qe,Vt,ht;switch(xt){case 1:Ve<128&&(mt=Ve);break;case 2:Vn=ce[De+1],(Vn&192)===128&&(ht=(Ve&31)<<6|Vn&63,ht>127&&(mt=ht));break;case 3:Vn=ce[De+1],qe=ce[De+2],(Vn&192)===128&&(qe&192)===128&&(ht=(Ve&15)<<12|(Vn&63)<<6|qe&63,ht>2047&&(ht<55296||ht>57343)&&(mt=ht));break;case 4:Vn=ce[De+1],qe=ce[De+2],Vt=ce[De+3],(Vn&192)===128&&(qe&192)===128&&(Vt&192)===128&&(ht=(Ve&15)<<18|(Vn&63)<<12|(qe&63)<<6|Vt&63,ht>65535&&ht<1114112&&(mt=ht))}}mt===null?(mt=65533,xt=1):mt>65535&&(mt-=65536,me.push(mt>>>10&1023|55296),mt=56320|mt&1023),me.push(mt),De+=xt}return ee(me)}const X=4096;function ee(ce){const j=ce.length;if(j<=X)return String.fromCharCode.apply(String,ce);let W="",me=0;for(;me<j;)W+=String.fromCharCode.apply(String,ce.slice(me,me+=X));return W}function oe(ce,j,W){let me="";W=Math.min(ce.length,W);for(let De=j;De<W;++De)me+=String.fromCharCode(ce[De]&127);return me}function fe(ce,j,W){let me="";W=Math.min(ce.length,W);for(let De=j;De<W;++De)me+=String.fromCharCode(ce[De]);return me}function Re(ce,j,W){const me=ce.length;(!j||j<0)&&(j=0),(!W||W<0||W>me)&&(W=me);let De="";for(let Ve=j;Ve<W;++Ve)De+=qt[ce[Ve]];return De}function He(ce,j,W){const me=ce.slice(j,W);let De="";for(let Ve=0;Ve<me.length-1;Ve+=2)De+=String.fromCharCode(me[Ve]+me[Ve+1]*256);return De}u.prototype.slice=function(j,W){const me=this.length;j=~~j,W=W===void 0?me:~~W,j<0?(j+=me,j<0&&(j=0)):j>me&&(j=me),W<0?(W+=me,W<0&&(W=0)):W>me&&(W=me),W<j&&(W=j);const De=this.subarray(j,W);return Object.setPrototypeOf(De,u.prototype),De};function Te(ce,j,W){if(ce%1!==0||ce<0)throw new RangeError("offset is not uint");if(ce+j>W)throw new RangeError("Trying to access beyond buffer length")}u.prototype.readUintLE=u.prototype.readUIntLE=function(j,W,me){j=j>>>0,W=W>>>0,me||Te(j,W,this.length);let De=this[j],Ve=1,mt=0;for(;++mt<W&&(Ve*=256);)De+=this[j+mt]*Ve;return De},u.prototype.readUintBE=u.prototype.readUIntBE=function(j,W,me){j=j>>>0,W=W>>>0,me||Te(j,W,this.length);let De=this[j+--W],Ve=1;for(;W>0&&(Ve*=256);)De+=this[j+--W]*Ve;return De},u.prototype.readUint8=u.prototype.readUInt8=function(j,W){return j=j>>>0,W||Te(j,1,this.length),this[j]},u.prototype.readUint16LE=u.prototype.readUInt16LE=function(j,W){return j=j>>>0,W||Te(j,2,this.length),this[j]|this[j+1]<<8},u.prototype.readUint16BE=u.prototype.readUInt16BE=function(j,W){return j=j>>>0,W||Te(j,2,this.length),this[j]<<8|this[j+1]},u.prototype.readUint32LE=u.prototype.readUInt32LE=function(j,W){return j=j>>>0,W||Te(j,4,this.length),(this[j]|this[j+1]<<8|this[j+2]<<16)+this[j+3]*16777216},u.prototype.readUint32BE=u.prototype.readUInt32BE=function(j,W){return j=j>>>0,W||Te(j,4,this.length),this[j]*16777216+(this[j+1]<<16|this[j+2]<<8|this[j+3])},u.prototype.readBigUInt64LE=Ot(function(j){j=j>>>0,Ie(j,"offset");const W=this[j],me=this[j+7];(W===void 0||me===void 0)&&rt(j,this.length-8);const De=W+this[++j]*2**8+this[++j]*2**16+this[++j]*2**24,Ve=this[++j]+this[++j]*2**8+this[++j]*2**16+me*2**24;return BigInt(De)+(BigInt(Ve)<<BigInt(32))}),u.prototype.readBigUInt64BE=Ot(function(j){j=j>>>0,Ie(j,"offset");const W=this[j],me=this[j+7];(W===void 0||me===void 0)&&rt(j,this.length-8);const De=W*2**24+this[++j]*2**16+this[++j]*2**8+this[++j],Ve=this[++j]*2**24+this[++j]*2**16+this[++j]*2**8+me;return(BigInt(De)<<BigInt(32))+BigInt(Ve)}),u.prototype.readIntLE=function(j,W,me){j=j>>>0,W=W>>>0,me||Te(j,W,this.length);let De=this[j],Ve=1,mt=0;for(;++mt<W&&(Ve*=256);)De+=this[j+mt]*Ve;return Ve*=128,De>=Ve&&(De-=Math.pow(2,8*W)),De},u.prototype.readIntBE=function(j,W,me){j=j>>>0,W=W>>>0,me||Te(j,W,this.length);let De=W,Ve=1,mt=this[j+--De];for(;De>0&&(Ve*=256);)mt+=this[j+--De]*Ve;return Ve*=128,mt>=Ve&&(mt-=Math.pow(2,8*W)),mt},u.prototype.readInt8=function(j,W){return j=j>>>0,W||Te(j,1,this.length),this[j]&128?(255-this[j]+1)*-1:this[j]},u.prototype.readInt16LE=function(j,W){j=j>>>0,W||Te(j,2,this.length);const me=this[j]|this[j+1]<<8;return me&32768?me|4294901760:me},u.prototype.readInt16BE=function(j,W){j=j>>>0,W||Te(j,2,this.length);const me=this[j+1]|this[j]<<8;return me&32768?me|4294901760:me},u.prototype.readInt32LE=function(j,W){return j=j>>>0,W||Te(j,4,this.length),this[j]|this[j+1]<<8|this[j+2]<<16|this[j+3]<<24},u.prototype.readInt32BE=function(j,W){return j=j>>>0,W||Te(j,4,this.length),this[j]<<24|this[j+1]<<16|this[j+2]<<8|this[j+3]},u.prototype.readBigInt64LE=Ot(function(j){j=j>>>0,Ie(j,"offset");const W=this[j],me=this[j+7];(W===void 0||me===void 0)&&rt(j,this.length-8);const De=this[j+4]+this[j+5]*2**8+this[j+6]*2**16+(me<<24);return(BigInt(De)<<BigInt(32))+BigInt(W+this[++j]*2**8+this[++j]*2**16+this[++j]*2**24)}),u.prototype.readBigInt64BE=Ot(function(j){j=j>>>0,Ie(j,"offset");const W=this[j],me=this[j+7];(W===void 0||me===void 0)&&rt(j,this.length-8);const De=(W<<24)+this[++j]*2**16+this[++j]*2**8+this[++j];return(BigInt(De)<<BigInt(32))+BigInt(this[++j]*2**24+this[++j]*2**16+this[++j]*2**8+me)}),u.prototype.readFloatLE=function(j,W){return j=j>>>0,W||Te(j,4,this.length),n.read(this,j,!0,23,4)},u.prototype.readFloatBE=function(j,W){return j=j>>>0,W||Te(j,4,this.length),n.read(this,j,!1,23,4)},u.prototype.readDoubleLE=function(j,W){return j=j>>>0,W||Te(j,8,this.length),n.read(this,j,!0,52,8)},u.prototype.readDoubleBE=function(j,W){return j=j>>>0,W||Te(j,8,this.length),n.read(this,j,!1,52,8)};function Le(ce,j,W,me,De,Ve){if(!u.isBuffer(ce))throw new TypeError('"buffer" argument must be a Buffer instance');if(j>De||j<Ve)throw new RangeError('"value" argument is out of bounds');if(W+me>ce.length)throw new RangeError("Index out of range")}u.prototype.writeUintLE=u.prototype.writeUIntLE=function(j,W,me,De){if(j=+j,W=W>>>0,me=me>>>0,!De){const xt=Math.pow(2,8*me)-1;Le(this,j,W,me,xt,0)}let Ve=1,mt=0;for(this[W]=j&255;++mt<me&&(Ve*=256);)this[W+mt]=j/Ve&255;return W+me},u.prototype.writeUintBE=u.prototype.writeUIntBE=function(j,W,me,De){if(j=+j,W=W>>>0,me=me>>>0,!De){const xt=Math.pow(2,8*me)-1;Le(this,j,W,me,xt,0)}let Ve=me-1,mt=1;for(this[W+Ve]=j&255;--Ve>=0&&(mt*=256);)this[W+Ve]=j/mt&255;return W+me},u.prototype.writeUint8=u.prototype.writeUInt8=function(j,W,me){return j=+j,W=W>>>0,me||Le(this,j,W,1,255,0),this[W]=j&255,W+1},u.prototype.writeUint16LE=u.prototype.writeUInt16LE=function(j,W,me){return j=+j,W=W>>>0,me||Le(this,j,W,2,65535,0),this[W]=j&255,this[W+1]=j>>>8,W+2},u.prototype.writeUint16BE=u.prototype.writeUInt16BE=function(j,W,me){return j=+j,W=W>>>0,me||Le(this,j,W,2,65535,0),this[W]=j>>>8,this[W+1]=j&255,W+2},u.prototype.writeUint32LE=u.prototype.writeUInt32LE=function(j,W,me){return j=+j,W=W>>>0,me||Le(this,j,W,4,4294967295,0),this[W+3]=j>>>24,this[W+2]=j>>>16,this[W+1]=j>>>8,this[W]=j&255,W+4},u.prototype.writeUint32BE=u.prototype.writeUInt32BE=function(j,W,me){return j=+j,W=W>>>0,me||Le(this,j,W,4,4294967295,0),this[W]=j>>>24,this[W+1]=j>>>16,this[W+2]=j>>>8,this[W+3]=j&255,W+4};function we(ce,j,W,me,De){Be(j,me,De,ce,W,7);let Ve=Number(j&BigInt(4294967295));ce[W++]=Ve,Ve=Ve>>8,ce[W++]=Ve,Ve=Ve>>8,ce[W++]=Ve,Ve=Ve>>8,ce[W++]=Ve;let mt=Number(j>>BigInt(32)&BigInt(4294967295));return ce[W++]=mt,mt=mt>>8,ce[W++]=mt,mt=mt>>8,ce[W++]=mt,mt=mt>>8,ce[W++]=mt,W}function Ce(ce,j,W,me,De){Be(j,me,De,ce,W,7);let Ve=Number(j&BigInt(4294967295));ce[W+7]=Ve,Ve=Ve>>8,ce[W+6]=Ve,Ve=Ve>>8,ce[W+5]=Ve,Ve=Ve>>8,ce[W+4]=Ve;let mt=Number(j>>BigInt(32)&BigInt(4294967295));return ce[W+3]=mt,mt=mt>>8,ce[W+2]=mt,mt=mt>>8,ce[W+1]=mt,mt=mt>>8,ce[W]=mt,W+8}u.prototype.writeBigUInt64LE=Ot(function(j,W=0){return we(this,j,W,BigInt(0),BigInt("0xffffffffffffffff"))}),u.prototype.writeBigUInt64BE=Ot(function(j,W=0){return Ce(this,j,W,BigInt(0),BigInt("0xffffffffffffffff"))}),u.prototype.writeIntLE=function(j,W,me,De){if(j=+j,W=W>>>0,!De){const Vn=Math.pow(2,8*me-1);Le(this,j,W,me,Vn-1,-Vn)}let Ve=0,mt=1,xt=0;for(this[W]=j&255;++Ve<me&&(mt*=256);)j<0&&xt===0&&this[W+Ve-1]!==0&&(xt=1),this[W+Ve]=(j/mt>>0)-xt&255;return W+me},u.prototype.writeIntBE=function(j,W,me,De){if(j=+j,W=W>>>0,!De){const Vn=Math.pow(2,8*me-1);Le(this,j,W,me,Vn-1,-Vn)}let Ve=me-1,mt=1,xt=0;for(this[W+Ve]=j&255;--Ve>=0&&(mt*=256);)j<0&&xt===0&&this[W+Ve+1]!==0&&(xt=1),this[W+Ve]=(j/mt>>0)-xt&255;return W+me},u.prototype.writeInt8=function(j,W,me){return j=+j,W=W>>>0,me||Le(this,j,W,1,127,-128),j<0&&(j=255+j+1),this[W]=j&255,W+1},u.prototype.writeInt16LE=function(j,W,me){return j=+j,W=W>>>0,me||Le(this,j,W,2,32767,-32768),this[W]=j&255,this[W+1]=j>>>8,W+2},u.prototype.writeInt16BE=function(j,W,me){return j=+j,W=W>>>0,me||Le(this,j,W,2,32767,-32768),this[W]=j>>>8,this[W+1]=j&255,W+2},u.prototype.writeInt32LE=function(j,W,me){return j=+j,W=W>>>0,me||Le(this,j,W,4,2147483647,-2147483648),this[W]=j&255,this[W+1]=j>>>8,this[W+2]=j>>>16,this[W+3]=j>>>24,W+4},u.prototype.writeInt32BE=function(j,W,me){return j=+j,W=W>>>0,me||Le(this,j,W,4,2147483647,-2147483648),j<0&&(j=4294967295+j+1),this[W]=j>>>24,this[W+1]=j>>>16,this[W+2]=j>>>8,this[W+3]=j&255,W+4},u.prototype.writeBigInt64LE=Ot(function(j,W=0){return we(this,j,W,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))}),u.prototype.writeBigInt64BE=Ot(function(j,W=0){return Ce(this,j,W,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))});function ke(ce,j,W,me,De,Ve){if(W+me>ce.length)throw new RangeError("Index out of range");if(W<0)throw new RangeError("Index out of range")}function St(ce,j,W,me,De){return j=+j,W=W>>>0,De||ke(ce,j,W,4),n.write(ce,j,W,me,23,4),W+4}u.prototype.writeFloatLE=function(j,W,me){return St(this,j,W,!0,me)},u.prototype.writeFloatBE=function(j,W,me){return St(this,j,W,!1,me)};function Mt(ce,j,W,me,De){return j=+j,W=W>>>0,De||ke(ce,j,W,8),n.write(ce,j,W,me,52,8),W+8}u.prototype.writeDoubleLE=function(j,W,me){return Mt(this,j,W,!0,me)},u.prototype.writeDoubleBE=function(j,W,me){return Mt(this,j,W,!1,me)},u.prototype.copy=function(j,W,me,De){if(!u.isBuffer(j))throw new TypeError("argument should be a Buffer");if(me||(me=0),!De&&De!==0&&(De=this.length),W>=j.length&&(W=j.length),W||(W=0),De>0&&De<me&&(De=me),De===me||j.length===0||this.length===0)return 0;if(W<0)throw new RangeError("targetStart out of bounds");if(me<0||me>=this.length)throw new RangeError("Index out of range");if(De<0)throw new RangeError("sourceEnd out of bounds");De>this.length&&(De=this.length),j.length-W<De-me&&(De=j.length-W+me);const Ve=De-me;return this===j&&typeof s.prototype.copyWithin=="function"?this.copyWithin(W,me,De):s.prototype.set.call(j,this.subarray(me,De),W),Ve},u.prototype.fill=function(j,W,me,De){if(typeof j=="string"){if(typeof W=="string"?(De=W,W=0,me=this.length):typeof me=="string"&&(De=me,me=this.length),De!==void 0&&typeof De!="string")throw new TypeError("encoding must be a string");if(typeof De=="string"&&!u.isEncoding(De))throw new TypeError("Unknown encoding: "+De);if(j.length===1){const mt=j.charCodeAt(0);(De==="utf8"&&mt<128||De==="latin1")&&(j=mt)}}else typeof j=="number"?j=j&255:typeof j=="boolean"&&(j=Number(j));if(W<0||this.length<W||this.length<me)throw new RangeError("Out of range index");if(me<=W)return this;W=W>>>0,me=me===void 0?this.length:me>>>0,j||(j=0);let Ve;if(typeof j=="number")for(Ve=W;Ve<me;++Ve)this[Ve]=j;else{const mt=u.isBuffer(j)?j:u.from(j,De),xt=mt.length;if(xt===0)throw new TypeError('The value "'+j+'" is invalid for argument "value"');for(Ve=0;Ve<me-W;++Ve)this[Ve+W]=mt[Ve%xt]}return this};const Ee={};function _e(ce,j,W){Ee[ce]=class extends W{constructor(){super(),Object.defineProperty(this,"message",{value:j.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${ce}]`,this.stack,delete this.name}get code(){return ce}set code(De){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:De,writable:!0})}toString(){return`${this.name} [${ce}]: ${this.message}`}}}_e("ERR_BUFFER_OUT_OF_BOUNDS",function(ce){return ce?`${ce} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"},RangeError),_e("ERR_INVALID_ARG_TYPE",function(ce,j){return`The "${ce}" argument must be of type number. Received type ${typeof j}`},TypeError),_e("ERR_OUT_OF_RANGE",function(ce,j,W){let me=`The value of "${ce}" is out of range.`,De=W;return Number.isInteger(W)&&Math.abs(W)>2**32?De=tt(String(W)):typeof W=="bigint"&&(De=String(W),(W>BigInt(2)**BigInt(32)||W<-(BigInt(2)**BigInt(32)))&&(De=tt(De)),De+="n"),me+=` It must be ${j}. Received ${De}`,me},RangeError);function tt(ce){let j="",W=ce.length;const me=ce[0]==="-"?1:0;for(;W>=me+4;W-=3)j=`_${ce.slice(W-3,W)}${j}`;return`${ce.slice(0,W)}${j}`}function de(ce,j,W){Ie(j,"offset"),(ce[j]===void 0||ce[j+W]===void 0)&&rt(j,ce.length-(W+1))}function Be(ce,j,W,me,De,Ve){if(ce>W||ce<j){const mt=typeof j=="bigint"?"n":"";let xt;throw j===0||j===BigInt(0)?xt=`>= 0${mt} and < 2${mt} ** ${(Ve+1)*8}${mt}`:xt=`>= -(2${mt} ** ${(Ve+1)*8-1}${mt}) and < 2 ** ${(Ve+1)*8-1}${mt}`,new Ee.ERR_OUT_OF_RANGE("value",xt,ce)}de(me,De,Ve)}function Ie(ce,j){if(typeof ce!="number")throw new Ee.ERR_INVALID_ARG_TYPE(j,"number",ce)}function rt(ce,j,W){throw Math.floor(ce)!==ce?(Ie(ce,W),new Ee.ERR_OUT_OF_RANGE("offset","an integer",ce)):j<0?new Ee.ERR_BUFFER_OUT_OF_BOUNDS:new Ee.ERR_OUT_OF_RANGE("offset",`>= 0 and <= ${j}`,ce)}const ft=/[^+/0-9A-Za-z-_]/g;function gt(ce){if(ce=ce.split("=")[0],ce=ce.trim().replace(ft,""),ce.length<2)return"";for(;ce.length%4!==0;)ce=ce+"=";return ce}function bt(ce,j){j=j||1/0;let W;const me=ce.length;let De=null;const Ve=[];for(let mt=0;mt<me;++mt){if(W=ce.charCodeAt(mt),W>55295&&W<57344){if(!De){if(W>56319){(j-=3)>-1&&Ve.push(239,191,189);continue}else if(mt+1===me){(j-=3)>-1&&Ve.push(239,191,189);continue}De=W;continue}if(W<56320){(j-=3)>-1&&Ve.push(239,191,189),De=W;continue}W=(De-55296<<10|W-56320)+65536}else De&&(j-=3)>-1&&Ve.push(239,191,189);if(De=null,W<128){if((j-=1)<0)break;Ve.push(W)}else if(W<2048){if((j-=2)<0)break;Ve.push(W>>6|192,W&63|128)}else if(W<65536){if((j-=3)<0)break;Ve.push(W>>12|224,W>>6&63|128,W&63|128)}else if(W<1114112){if((j-=4)<0)break;Ve.push(W>>18|240,W>>12&63|128,W>>6&63|128,W&63|128)}else throw new Error("Invalid code point")}return Ve}function be(ce){const j=[];for(let W=0;W<ce.length;++W)j.push(ce.charCodeAt(W)&255);return j}function ue(ce,j){let W,me,De;const Ve=[];for(let mt=0;mt<ce.length&&!((j-=2)<0);++mt)W=ce.charCodeAt(mt),me=W>>8,De=W%256,Ve.push(De),Ve.push(me);return Ve}function Xe(ce){return e.toByteArray(gt(ce))}function it(ce,j,W,me){let De;for(De=0;De<me&&!(De+W>=j.length||De>=ce.length);++De)j[De+W]=ce[De];return De}function $e(ce,j){return ce instanceof j||ce!=null&&ce.constructor!=null&&ce.constructor.name!=null&&ce.constructor.name===j.name}function Ue(ce){return ce!==ce}const qt=function(){const ce="0123456789abcdef",j=new Array(256);for(let W=0;W<16;++W){const me=W*16;for(let De=0;De<16;++De)j[me+De]=ce[W]+ce[De]}return j}();function Ot(ce){return typeof BigInt>"u"?Yt:ce}function Yt(){throw new Error("BigInt not supported")}})(Xc);const Fl=Xc.Buffer,wqe=Xc.Blob,Cqe=Xc.BlobOptions,Aqe=Xc.Buffer,Rqe=Xc.File,Mqe=Xc.FileOptions,Oqe=Xc.INSPECT_MAX_BYTES,Nqe=Xc.SlowBuffer,Iqe=Xc.TranscodeEncoding,kqe=Xc.atob,Dqe=Xc.btoa,Pqe=Xc.constants,Lqe=Xc.isAscii,Uqe=Xc.isUtf8,Bqe=Xc.kMaxLength,Fqe=Xc.kStringMaxLength,zqe=Xc.resolveObjectURL,Hqe=Xc.transcode,jqe=Object.freeze(Object.defineProperty({__proto__:null,Blob:wqe,BlobOptions:Cqe,Buffer:Aqe,File:Rqe,FileOptions:Mqe,INSPECT_MAX_BYTES:Oqe,SlowBuffer:Nqe,TranscodeEncoding:Iqe,atob:kqe,btoa:Dqe,constants:Pqe,default:Fl,isAscii:Lqe,isUtf8:Uqe,kMaxLength:Bqe,kStringMaxLength:Fqe,resolveObjectURL:zqe,transcode:Hqe},Symbol.toStringTag,{value:"Module"}));var lq;try{lq=new TextDecoder}catch{}var gn,Qd,et=0,ra={},Br,gb,Fd=0,Mg=0,ll,l_,hf=[],Nr,Nne={useRecords:!1,mapsAsObjects:!0};class Jme{}const Qme=new Jme;Qme.name="MessagePack 0xC1";var Ib=!1,ege=2,Ine;try{new Function("")}catch{ege=1/0}class iN{constructor(e){e&&(e.useRecords===!1&&e.mapsAsObjects===void 0&&(e.mapsAsObjects=!0),e.sequential&&e.trusted!==!1&&(e.trusted=!0,!e.structures&&e.useRecords!=!1&&(e.structures=[],e.maxSharedStructures||(e.maxSharedStructures=0))),e.structures?e.structures.sharedLength=e.structures.length:e.getStructures&&((e.structures=[]).uninitialized=!0,e.structures.sharedLength=0),e.int64AsNumber&&(e.int64AsType="number")),Object.assign(this,e)}unpack(e,n){if(gn)return age(()=>(hq(),this?this.unpack(e,n):iN.prototype.unpack.call(Nne,e,n)));!e.buffer&&e.constructor===ArrayBuffer&&(e=typeof Fl<"u"?Fl.from(e):new Uint8Array(e)),typeof n=="object"?(Qd=n.end||e.length,et=n.start||0):(et=0,Qd=n>-1?n:e.length),Mg=0,gb=null,ll=null,gn=e;try{Nr=e.dataView||(e.dataView=new DataView(e.buffer,e.byteOffset,e.byteLength))}catch(i){throw gn=null,e instanceof Uint8Array?i:new Error("Source must be a Uint8Array or Buffer but was a "+(e&&typeof e=="object"?e.constructor.name:typeof e))}if(this instanceof iN){if(ra=this,this.structures)return Br=this.structures,pP(n);(!Br||Br.length>0)&&(Br=[])}else ra=Nne,(!Br||Br.length>0)&&(Br=[]);return pP(n)}unpackMultiple(e,n){let i,r=0;try{Ib=!0;let s=e.length,a=this?this.unpack(e,s):kF.unpack(e,s);if(n){if(n(a,r,et)===!1)return;for(;et<s;)if(r=et,n(pP(),r,et)===!1)return}else{for(i=[a];et<s;)r=et,i.push(pP());return i}}catch(s){throw s.lastPosition=r,s.values=i,s}finally{Ib=!1,hq()}}_mergeStructures(e,n){e=e||[],Object.isFrozen(e)&&(e=e.map(i=>i.slice(0)));for(let i=0,r=e.length;i<r;i++){let s=e[i];s&&(s.isShared=!0,i>=32&&(s.highByte=i-32>>5))}e.sharedLength=e.length;for(let i in n||[])if(i>=0){let r=e[i],s=n[i];s&&(r&&((e.restoreStructures||(e.restoreStructures=[]))[i]=r),e[i]=s)}return this.structures=e}decode(e,n){return this.unpack(e,n)}}function pP(t){try{if(!ra.trusted&&!Ib){let n=Br.sharedLength||0;n<Br.length&&(Br.length=n)}let e;if(ra.randomAccessStructure&&gn[et]<64&&gn[et]>=32&&Ine?(e=Ine(gn,et,Qd,ra),gn=null,!(t&&t.lazy)&&e&&(e=e.toJSON()),et=Qd):e=Ho(),ll&&(et=ll.postBundlePosition,ll=null),Ib&&(Br.restoreStructures=null),et==Qd)Br&&Br.restoreStructures&&kne(),Br=null,gn=null,l_&&(l_=null);else{if(et>Qd)throw new Error("Unexpected end of MessagePack data");if(!Ib){let n;try{n=JSON.stringify(e,(i,r)=>typeof r=="bigint"?`${r}n`:r).slice(0,100)}catch(i){n="(JSON view not available "+i+")"}throw new Error("Data read, but end of buffer not reached "+n)}}return e}catch(e){throw Br&&Br.restoreStructures&&kne(),hq(),(e instanceof RangeError||e.message.startsWith("Unexpected end of buffer")||et>Qd)&&(e.incomplete=!0),e}}function kne(){for(let t in Br.restoreStructures)Br[t]=Br.restoreStructures[t];Br.restoreStructures=null}function Ho(){let t=gn[et++];if(t<160)if(t<128){if(t<64)return t;{let e=Br[t&63]||ra.getStructures&&tge()[t&63];return e?(e.read||(e.read=j9(e,t&63)),e.read()):t}}else if(t<144)if(t-=128,ra.mapsAsObjects){let e={};for(let n=0;n<t;n++){let i=ige();i==="__proto__"&&(i="__proto_"),e[i]=Ho()}return e}else{let e=new Map;for(let n=0;n<t;n++)e.set(Ho(),Ho());return e}else{t-=144;let e=new Array(t);for(let n=0;n<t;n++)e[n]=Ho();return ra.freezeData?Object.freeze(e):e}else if(t<192){let e=t-160;if(Mg>=et)return gb.slice(et-Fd,(et+=e)-Fd);if(Mg==0&&Qd<140){let n=e<16?V9(e):nge(e);if(n!=null)return n}return uq(e)}else{let e;switch(t){case 192:return null;case 193:return ll?(e=Ho(),e>0?ll[1].slice(ll.position1,ll.position1+=e):ll[0].slice(ll.position0,ll.position0-=e)):Qme;case 194:return!1;case 195:return!0;case 196:if(e=gn[et++],e===void 0)throw new Error("Unexpected end of buffer");return P5(e);case 197:return e=Nr.getUint16(et),et+=2,P5(e);case 198:return e=Nr.getUint32(et),et+=4,P5(e);case 199:return NS(gn[et++]);case 200:return e=Nr.getUint16(et),et+=2,NS(e);case 201:return e=Nr.getUint32(et),et+=4,NS(e);case 202:if(e=Nr.getFloat32(et),ra.useFloat32>2){let n=G9[(gn[et]&127)<<1|gn[et+1]>>7];return et+=4,(n*e+(e>0?.5:-.5)>>0)/n}return et+=4,e;case 203:return e=Nr.getFloat64(et),et+=8,e;case 204:return gn[et++];case 205:return e=Nr.getUint16(et),et+=2,e;case 206:return e=Nr.getUint32(et),et+=4,e;case 207:return ra.int64AsType==="number"?(e=Nr.getUint32(et)*4294967296,e+=Nr.getUint32(et+4)):ra.int64AsType==="string"?e=Nr.getBigUint64(et).toString():ra.int64AsType==="auto"?(e=Nr.getBigUint64(et),e<=BigInt(2)<<BigInt(52)&&(e=Number(e))):e=Nr.getBigUint64(et),et+=8,e;case 208:return Nr.getInt8(et++);case 209:return e=Nr.getInt16(et),et+=2,e;case 210:return e=Nr.getInt32(et),et+=4,e;case 211:return ra.int64AsType==="number"?(e=Nr.getInt32(et)*4294967296,e+=Nr.getUint32(et+4)):ra.int64AsType==="string"?e=Nr.getBigInt64(et).toString():ra.int64AsType==="auto"?(e=Nr.getBigInt64(et),e>=BigInt(-2)<<BigInt(52)&&e<=BigInt(2)<<BigInt(52)&&(e=Number(e))):e=Nr.getBigInt64(et),et+=8,e;case 212:if(e=gn[et++],e==114)return Fne(gn[et++]&63);{let n=hf[e];if(n)return n.read?(et++,n.read(Ho())):n.noBuffer?(et++,n()):n(gn.subarray(et,++et));throw new Error("Unknown extension "+e)}case 213:return e=gn[et],e==114?(et++,Fne(gn[et++]&63,gn[et++])):NS(2);case 214:return NS(4);case 215:return NS(8);case 216:return NS(16);case 217:return e=gn[et++],Mg>=et?gb.slice(et-Fd,(et+=e)-Fd):Gqe(e);case 218:return e=Nr.getUint16(et),et+=2,Mg>=et?gb.slice(et-Fd,(et+=e)-Fd):qqe(e);case 219:return e=Nr.getUint32(et),et+=4,Mg>=et?gb.slice(et-Fd,(et+=e)-Fd):$qe(e);case 220:return e=Nr.getUint16(et),et+=2,Pne(e);case 221:return e=Nr.getUint32(et),et+=4,Pne(e);case 222:return e=Nr.getUint16(et),et+=2,Lne(e);case 223:return e=Nr.getUint32(et),et+=4,Lne(e);default:if(t>=224)return t-256;if(t===void 0){let n=new Error("Unexpected end of MessagePack data");throw n.incomplete=!0,n}throw new Error("Unknown MessagePack token "+t)}}}const Vqe=/^[a-zA-Z_$][a-zA-Z\d_$]*$/;function j9(t,e){function n(){if(n.count++>ege){let r=t.read=new Function("r","return function(){return "+(ra.freezeData?"Object.freeze":"")+"({"+t.map(s=>s==="__proto__"?"__proto_:r()":Vqe.test(s)?s+":r()":"["+JSON.stringify(s)+"]:r()").join(",")+"})}")(Ho);return t.highByte===0&&(t.read=Dne(e,t.read)),r()}let i={};for(let r=0,s=t.length;r<s;r++){let a=t[r];a==="__proto__"&&(a="__proto_"),i[a]=Ho()}return ra.freezeData?Object.freeze(i):i}return n.count=0,t.highByte===0?Dne(e,n):n}const Dne=(t,e)=>function(){let n=gn[et++];if(n===0)return e();let i=t<32?-(t+(n<<5)):t+(n<<5),r=Br[i]||tge()[i];if(!r)throw new Error("Record id is not defined for "+i);return r.read||(r.read=j9(r,t)),r.read()};function tge(){let t=age(()=>(gn=null,ra.getStructures()));return Br=ra._mergeStructures(t,Br)}var uq=jI,Gqe=jI,qqe=jI,$qe=jI;function jI(t){let e;if(t<16&&(e=V9(t)))return e;if(t>64&&lq)return lq.decode(gn.subarray(et,et+=t));const n=et+t,i=[];for(e="";et<n;){const r=gn[et++];if(!(r&128))i.push(r);else if((r&224)===192){const s=gn[et++]&63;i.push((r&31)<<6|s)}else if((r&240)===224){const s=gn[et++]&63,a=gn[et++]&63;i.push((r&31)<<12|s<<6|a)}else if((r&248)===240){const s=gn[et++]&63,a=gn[et++]&63,o=gn[et++]&63;let c=(r&7)<<18|s<<12|a<<6|o;c>65535&&(c-=65536,i.push(c>>>10&1023|55296),c=56320|c&1023),i.push(c)}else i.push(r);i.length>=4096&&(e+=sl.apply(String,i),i.length=0)}return i.length>0&&(e+=sl.apply(String,i)),e}function Pne(t){let e=new Array(t);for(let n=0;n<t;n++)e[n]=Ho();return ra.freezeData?Object.freeze(e):e}function Lne(t){if(ra.mapsAsObjects){let e={};for(let n=0;n<t;n++){let i=ige();i==="__proto__"&&(i="__proto_"),e[i]=Ho()}return e}else{let e=new Map;for(let n=0;n<t;n++)e.set(Ho(),Ho());return e}}var sl=String.fromCharCode;function nge(t){let e=et,n=new Array(t);for(let i=0;i<t;i++){const r=gn[et++];if((r&128)>0){et=e;return}n[i]=r}return sl.apply(String,n)}function V9(t){if(t<4)if(t<2){if(t===0)return"";{let e=gn[et++];if((e&128)>1){et-=1;return}return sl(e)}}else{let e=gn[et++],n=gn[et++];if((e&128)>0||(n&128)>0){et-=2;return}if(t<3)return sl(e,n);let i=gn[et++];if((i&128)>0){et-=3;return}return sl(e,n,i)}else{let e=gn[et++],n=gn[et++],i=gn[et++],r=gn[et++];if((e&128)>0||(n&128)>0||(i&128)>0||(r&128)>0){et-=4;return}if(t<6){if(t===4)return sl(e,n,i,r);{let s=gn[et++];if((s&128)>0){et-=5;return}return sl(e,n,i,r,s)}}else if(t<8){let s=gn[et++],a=gn[et++];if((s&128)>0||(a&128)>0){et-=6;return}if(t<7)return sl(e,n,i,r,s,a);let o=gn[et++];if((o&128)>0){et-=7;return}return sl(e,n,i,r,s,a,o)}else{let s=gn[et++],a=gn[et++],o=gn[et++],c=gn[et++];if((s&128)>0||(a&128)>0||(o&128)>0||(c&128)>0){et-=8;return}if(t<10){if(t===8)return sl(e,n,i,r,s,a,o,c);{let l=gn[et++];if((l&128)>0){et-=9;return}return sl(e,n,i,r,s,a,o,c,l)}}else if(t<12){let l=gn[et++],u=gn[et++];if((l&128)>0||(u&128)>0){et-=10;return}if(t<11)return sl(e,n,i,r,s,a,o,c,l,u);let h=gn[et++];if((h&128)>0){et-=11;return}return sl(e,n,i,r,s,a,o,c,l,u,h)}else{let l=gn[et++],u=gn[et++],h=gn[et++],f=gn[et++];if((l&128)>0||(u&128)>0||(h&128)>0||(f&128)>0){et-=12;return}if(t<14){if(t===12)return sl(e,n,i,r,s,a,o,c,l,u,h,f);{let d=gn[et++];if((d&128)>0){et-=13;return}return sl(e,n,i,r,s,a,o,c,l,u,h,f,d)}}else{let d=gn[et++],p=gn[et++];if((d&128)>0||(p&128)>0){et-=14;return}if(t<15)return sl(e,n,i,r,s,a,o,c,l,u,h,f,d,p);let g=gn[et++];if((g&128)>0){et-=15;return}return sl(e,n,i,r,s,a,o,c,l,u,h,f,d,p,g)}}}}}function Une(){let t=gn[et++],e;if(t<192)e=t-160;else switch(t){case 217:e=gn[et++];break;case 218:e=Nr.getUint16(et),et+=2;break;case 219:e=Nr.getUint32(et),et+=4;break;default:throw new Error("Expected string")}return jI(e)}function P5(t){return ra.copyBuffers?Uint8Array.prototype.slice.call(gn,et,et+=t):gn.subarray(et,et+=t)}function NS(t){let e=gn[et++];if(hf[e]){let n;return hf[e](gn.subarray(et,n=et+=t),i=>{et=i;try{return Ho()}finally{et=n}})}else throw new Error("Unknown extension type "+e)}var Bne=new Array(4096);function ige(){let t=gn[et++];if(t>=160&&t<192){if(t=t-160,Mg>=et)return gb.slice(et-Fd,(et+=t)-Fd);if(!(Mg==0&&Qd<180))return uq(t)}else return et--,rge(Ho());let e=(t<<5^(t>1?Nr.getUint16(et):t>0?gn[et]:0))&4095,n=Bne[e],i=et,r=et+t-3,s,a=0;if(n&&n.bytes==t){for(;i<r;){if(s=Nr.getUint32(i),s!=n[a++]){i=1879048192;break}i+=4}for(r+=3;i<r;)if(s=gn[i++],s!=n[a++]){i=1879048192;break}if(i===r)return et=i,n.string;r-=3,i=et}for(n=[],Bne[e]=n,n.bytes=t;i<r;)s=Nr.getUint32(i),n.push(s),i+=4;for(r+=3;i<r;)s=gn[i++],n.push(s);let o=t<16?V9(t):nge(t);return o!=null?n.string=o:n.string=uq(t)}function rge(t){if(typeof t=="string")return t;if(typeof t=="number"||typeof t=="boolean"||typeof t=="bigint")return t.toString();if(t==null)return t+"";throw new Error("Invalid property type for record",typeof t)}const Fne=(t,e)=>{let n=Ho().map(rge),i=t;e!==void 0&&(t=t<32?-((e<<5)+t):(e<<5)+t,n.highByte=e);let r=Br[t];return r&&(r.isShared||Ib)&&((Br.restoreStructures||(Br.restoreStructures=[]))[t]=r),Br[t]=n,n.read=j9(n,i),n.read()};hf[0]=()=>{};hf[0].noBuffer=!0;hf[66]=t=>{let e=t.length,n=BigInt(t[0]&128?t[0]-256:t[0]);for(let i=1;i<e;i++)n<<=BigInt(8),n+=BigInt(t[i]);return n};let Wqe={Error,TypeError,ReferenceError};hf[101]=()=>{let t=Ho();return(Wqe[t[0]]||Error)(t[1],{cause:t[2]})};hf[105]=t=>{if(ra.structuredClone===!1)throw new Error("Structured clone extension is disabled");let e=Nr.getUint32(et-4);l_||(l_=new Map);let n=gn[et],i;n>=144&&n<160||n==220||n==221?i=[]:i={};let r={target:i};l_.set(e,r);let s=Ho();return r.used?Object.assign(i,s):(r.target=s,s)};hf[112]=t=>{if(ra.structuredClone===!1)throw new Error("Structured clone extension is disabled");let e=Nr.getUint32(et-4),n=l_.get(e);return n.used=!0,n.target};hf[115]=()=>new Set(Ho());const sge=["Int8","Uint8","Uint8Clamped","Int16","Uint16","Int32","Uint32","Float32","Float64","BigInt64","BigUint64"].map(t=>t+"Array");let Yqe=typeof globalThis=="object"?globalThis:window;hf[116]=t=>{let e=t[0],n=sge[e];if(!n){if(e===16){let i=new ArrayBuffer(t.length-1);return new Uint8Array(i).set(t.subarray(1)),i}throw new Error("Could not find typed array for code "+e)}return new Yqe[n](Uint8Array.prototype.slice.call(t,1).buffer)};hf[120]=()=>{let t=Ho();return new RegExp(t[0],t[1])};const Xqe=[];hf[98]=t=>{let e=(t[0]<<24)+(t[1]<<16)+(t[2]<<8)+t[3],n=et;return et+=e-t.length,ll=Xqe,ll=[Une(),Une()],ll.position0=0,ll.position1=0,ll.postBundlePosition=et,et=n,Ho()};hf[255]=t=>t.length==4?new Date((t[0]*16777216+(t[1]<<16)+(t[2]<<8)+t[3])*1e3):t.length==8?new Date(((t[0]<<22)+(t[1]<<14)+(t[2]<<6)+(t[3]>>2))/1e6+((t[3]&3)*4294967296+t[4]*16777216+(t[5]<<16)+(t[6]<<8)+t[7])*1e3):t.length==12?new Date(((t[0]<<24)+(t[1]<<16)+(t[2]<<8)+t[3])/1e6+((t[4]&128?-281474976710656:0)+t[6]*1099511627776+t[7]*4294967296+t[8]*16777216+(t[9]<<16)+(t[10]<<8)+t[11])*1e3):new Date("invalid");function age(t){let e=Qd,n=et,i=Fd,r=Mg,s=gb,a=l_,o=ll,c=new Uint8Array(gn.slice(0,Qd)),l=Br,u=Br.slice(0,Br.length),h=ra,f=Ib,d=t();return Qd=e,et=n,Fd=i,Mg=r,gb=s,l_=a,ll=o,gn=c,Ib=f,Br=l,Br.splice(0,Br.length,...u),ra=h,Nr=new DataView(gn.buffer,gn.byteOffset,gn.byteLength),d}function hq(){gn=null,l_=null,Br=null}const G9=new Array(147);for(let t=0;t<256;t++)G9[t]=+("1e"+Math.floor(45.15-t*.30103));var kF=new iN({useRecords:!1});kF.unpack;kF.unpackMultiple;kF.unpack;let Kqe=new Float32Array(1);new Uint8Array(Kqe.buffer,0,4);let x2;try{x2=new TextEncoder}catch{}let fq,oge;const DF=typeof Fl<"u",mP=DF?function(t){return Fl.allocUnsafeSlow(t)}:Uint8Array,cge=DF?Fl:Uint8Array,zne=DF?4294967296:2144337920;let yt,BR,na,nt=0,Wu,Xa=null,Zqe;const Jqe=21760,Qqe=/[\u0080-\uFFFF]/,jx=Symbol("record-id");class e$e extends iN{constructor(e){super(e),this.offset=0;let n,i,r,s,a=cge.prototype.utf8Write?function(q,Y){return yt.utf8Write(q,Y,yt.byteLength-Y)}:x2&&x2.encodeInto?function(q,Y){return x2.encodeInto(q,yt.subarray(Y)).written}:!1,o=this;e||(e={});let c=e&&e.sequential,l=e.structures||e.saveStructures,u=e.maxSharedStructures;if(u==null&&(u=l?32:0),u>8160)throw new Error("Maximum maxSharedStructure is 8160");e.structuredClone&&e.moreTypes==null&&(this.moreTypes=!0);let h=e.maxOwnStructures;h==null&&(h=l?32:64),!this.structures&&e.useRecords!=!1&&(this.structures=[]);let f=u>32||h+u>64,d=u+64,p=u+h+64;if(p>8256)throw new Error("Maximum maxSharedStructure + maxOwnStructure is 8192");let g=[],y=0,v=0;this.pack=this.encode=function(q,Y){if(yt||(yt=new mP(8192),na=yt.dataView||(yt.dataView=new DataView(yt.buffer,0,8192)),nt=0),Wu=yt.length-10,Wu-nt<2048?(yt=new mP(yt.length),na=yt.dataView||(yt.dataView=new DataView(yt.buffer,0,yt.length)),Wu=yt.length-10,nt=0):nt=nt+7&2147483640,n=nt,Y&a$e&&(nt+=Y&255),s=o.structuredClone?new Map:null,o.bundleStrings&&typeof q!="string"?(Xa=[],Xa.size=1/0):Xa=null,r=o.structures,r){r.uninitialized&&(r=o._mergeStructures(o.getStructures()));let V=r.sharedLength||0;if(V>u)throw new Error("Shared structures is larger than maximum shared structures, try increasing maxSharedStructures to "+r.sharedLength);if(!r.transitions){r.transitions=Object.create(null);for(let J=0;J<V;J++){let X=r[J];if(!X)continue;let ee,oe=r.transitions;for(let fe=0,Re=X.length;fe<Re;fe++){let He=X[fe];ee=oe[He],ee||(ee=oe[He]=Object.create(null)),oe=ee}oe[jx]=J+64}this.lastNamedStructuresLength=V}c||(r.nextId=V+64)}i&&(i=!1);let ie;try{o.randomAccessStructure&&q&&q.constructor&&q.constructor===Object?$(q):x(q);let V=Xa;if(Xa&&Vne(n,x,0),s&&s.idsToInsert){let J=s.idsToInsert.sort((fe,Re)=>fe.offset>Re.offset?1:-1),X=J.length,ee=-1;for(;V&&X>0;){let fe=J[--X].offset+n;fe<V.stringsPosition+n&&ee===-1&&(ee=0),fe>V.position+n?ee>=0&&(ee+=6):(ee>=0&&(na.setUint32(V.position+n,na.getUint32(V.position+n)+ee),ee=-1),V=V.previous,X++)}ee>=0&&V&&na.setUint32(V.position+n,na.getUint32(V.position+n)+ee),nt+=J.length*6,nt>Wu&&P(nt),o.offset=nt;let oe=n$e(yt.subarray(n,nt),J);return s=null,oe}return o.offset=nt,Y&r$e?(yt.start=n,yt.end=nt,yt):yt.subarray(n,nt)}catch(V){throw ie=V,V}finally{if(r&&(b(),i&&o.saveStructures)){let V=r.sharedLength||0,J=yt.subarray(n,nt),X=i$e(r,o);if(!ie)return o.saveStructures(X,X.isCompatible)===!1?o.pack(q,Y):(o.lastNamedStructuresLength=V,yt.length>1073741824&&(yt=null),J)}yt.length>1073741824&&(yt=null),Y&s$e&&(nt=n)}};const b=()=>{v<10&&v++;let q=r.sharedLength||0;if(r.length>q&&!c&&(r.length=q),y>1e4)r.transitions=null,v=0,y=0,g.length>0&&(g=[]);else if(g.length>0&&!c){for(let Y=0,ie=g.length;Y<ie;Y++)g[Y][jx]=0;g=[]}},T=q=>{var Y=q.length;Y<16?yt[nt++]=144|Y:Y<65536?(yt[nt++]=220,yt[nt++]=Y>>8,yt[nt++]=Y&255):(yt[nt++]=221,na.setUint32(nt,Y),nt+=4);for(let ie=0;ie<Y;ie++)x(q[ie])},x=q=>{nt>Wu&&(yt=P(nt));var Y=typeof q,ie;if(Y==="string"){let V=q.length;if(Xa&&V>=4&&V<4096){if((Xa.size+=V)>Jqe){let oe,fe=(Xa[0]?Xa[0].length*3+Xa[1].length:0)+10;nt+fe>Wu&&(yt=P(nt+fe));let Re;Xa.position?(Re=Xa,yt[nt]=200,nt+=3,yt[nt++]=98,oe=nt-n,nt+=4,Vne(n,x,0),na.setUint16(oe+n-3,nt-n-oe)):(yt[nt++]=214,yt[nt++]=98,oe=nt-n,nt+=4),Xa=["",""],Xa.previous=Re,Xa.size=0,Xa.position=oe}let ee=Qqe.test(q);Xa[ee?0:1]+=q,yt[nt++]=193,x(ee?-V:V);return}let J;V<32?J=1:V<256?J=2:V<65536?J=3:J=5;let X=V*3;if(nt+X>Wu&&(yt=P(nt+X)),V<64||!a){let ee,oe,fe,Re=nt+J;for(ee=0;ee<V;ee++)oe=q.charCodeAt(ee),oe<128?yt[Re++]=oe:oe<2048?(yt[Re++]=oe>>6|192,yt[Re++]=oe&63|128):(oe&64512)===55296&&((fe=q.charCodeAt(ee+1))&64512)===56320?(oe=65536+((oe&1023)<<10)+(fe&1023),ee++,yt[Re++]=oe>>18|240,yt[Re++]=oe>>12&63|128,yt[Re++]=oe>>6&63|128,yt[Re++]=oe&63|128):(yt[Re++]=oe>>12|224,yt[Re++]=oe>>6&63|128,yt[Re++]=oe&63|128);ie=Re-nt-J}else ie=a(q,nt+J);ie<32?yt[nt++]=160|ie:ie<256?(J<2&&yt.copyWithin(nt+2,nt+1,nt+1+ie),yt[nt++]=217,yt[nt++]=ie):ie<65536?(J<3&&yt.copyWithin(nt+3,nt+2,nt+2+ie),yt[nt++]=218,yt[nt++]=ie>>8,yt[nt++]=ie&255):(J<5&&yt.copyWithin(nt+5,nt+3,nt+3+ie),yt[nt++]=219,na.setUint32(nt,ie),nt+=4),nt+=ie}else if(Y==="number")if(q>>>0===q)q<32||q<128&&this.useRecords===!1||q<64&&!this.randomAccessStructure?yt[nt++]=q:q<256?(yt[nt++]=204,yt[nt++]=q):q<65536?(yt[nt++]=205,yt[nt++]=q>>8,yt[nt++]=q&255):(yt[nt++]=206,na.setUint32(nt,q),nt+=4);else if(q>>0===q)q>=-32?yt[nt++]=256+q:q>=-128?(yt[nt++]=208,yt[nt++]=q+256):q>=-32768?(yt[nt++]=209,na.setInt16(nt,q),nt+=2):(yt[nt++]=210,na.setInt32(nt,q),nt+=4);else{let V;if((V=this.useFloat32)>0&&q<4294967296&&q>=-2147483648){yt[nt++]=202,na.setFloat32(nt,q);let J;if(V<4||(J=q*G9[(yt[nt]&127)<<1|yt[nt+1]>>7])>>0===J){nt+=4;return}else nt--}yt[nt++]=203,na.setFloat64(nt,q),nt+=8}else if(Y==="object"||Y==="function")if(!q)yt[nt++]=192;else{if(s){let J=s.get(q);if(J){if(!J.id){let X=s.idsToInsert||(s.idsToInsert=[]);J.id=X.push(J)}yt[nt++]=214,yt[nt++]=112,na.setUint32(nt,J.id),nt+=4;return}else s.set(q,{offset:nt-n})}let V=q.constructor;if(V===Object)k(q);else if(V===Array)T(q);else if(V===Map)if(this.mapAsEmptyObject)yt[nt++]=128;else{ie=q.size,ie<16?yt[nt++]=128|ie:ie<65536?(yt[nt++]=222,yt[nt++]=ie>>8,yt[nt++]=ie&255):(yt[nt++]=223,na.setUint32(nt,ie),nt+=4);for(let[J,X]of q)x(J),x(X)}else{for(let J=0,X=fq.length;J<X;J++){let ee=oge[J];if(q instanceof ee){let oe=fq[J];if(oe.write){oe.type&&(yt[nt++]=212,yt[nt++]=oe.type,yt[nt++]=0);let Le=oe.write.call(this,q);Le===q?Array.isArray(q)?T(q):k(q):x(Le);return}let fe=yt,Re=na,He=nt;yt=null;let Te;try{Te=oe.pack.call(this,q,Le=>(yt=fe,fe=null,nt+=Le,nt>Wu&&P(nt),{target:yt,targetView:na,position:nt-Le}),x)}finally{fe&&(yt=fe,na=Re,nt=He,Wu=yt.length-10)}Te&&(Te.length+nt>Wu&&P(Te.length+nt),nt=t$e(Te,yt,nt,oe.type));return}}if(Array.isArray(q))T(q);else{if(q.toJSON){const J=q.toJSON();if(J!==q)return x(J)}if(Y==="function")return x(this.writeFunction&&this.writeFunction(q));k(q)}}}else if(Y==="boolean")yt[nt++]=q?195:194;else if(Y==="bigint"){if(q<BigInt(1)<<BigInt(63)&&q>=-(BigInt(1)<<BigInt(63)))yt[nt++]=211,na.setBigInt64(nt,q);else if(q<BigInt(1)<<BigInt(64)&&q>0)yt[nt++]=207,na.setBigUint64(nt,q);else if(this.largeBigIntToFloat)yt[nt++]=203,na.setFloat64(nt,Number(q));else{if(this.largeBigIntToString)return x(q.toString());if(this.useBigIntExtension&&q<BigInt(2)**BigInt(1023)&&q>-(BigInt(2)**BigInt(1023))){yt[nt++]=199,nt++,yt[nt++]=66;let V=[],J;do{let X=q&BigInt(255);J=(X&BigInt(128))===(q<BigInt(0)?BigInt(128):BigInt(0)),V.push(X),q>>=BigInt(8)}while(!((q===BigInt(0)||q===BigInt(-1))&&J));yt[nt-2]=V.length;for(let X=V.length;X>0;)yt[nt++]=Number(V[--X]);return}else throw new RangeError(q+" was too large to fit in MessagePack 64-bit integer format, use useBigIntExtension, or set largeBigIntToFloat to convert to float-64, or set largeBigIntToString to convert to string")}nt+=8}else if(Y==="undefined")this.encodeUndefinedAsNil?yt[nt++]=192:(yt[nt++]=212,yt[nt++]=0,yt[nt++]=0);else throw new Error("Unknown type: "+Y)},M=this.variableMapSize||this.coercibleKeyAsNumber||this.skipValues?q=>{let Y;if(this.skipValues){Y=[];for(let J in q)(typeof q.hasOwnProperty!="function"||q.hasOwnProperty(J))&&!this.skipValues.includes(q[J])&&Y.push(J)}else Y=Object.keys(q);let ie=Y.length;ie<16?yt[nt++]=128|ie:ie<65536?(yt[nt++]=222,yt[nt++]=ie>>8,yt[nt++]=ie&255):(yt[nt++]=223,na.setUint32(nt,ie),nt+=4);let V;if(this.coercibleKeyAsNumber)for(let J=0;J<ie;J++){V=Y[J];let X=Number(V);x(isNaN(X)?V:X),x(q[V])}else for(let J=0;J<ie;J++)x(V=Y[J]),x(q[V])}:q=>{yt[nt++]=222;let Y=nt-n;nt+=2;let ie=0;for(let V in q)(typeof q.hasOwnProperty!="function"||q.hasOwnProperty(V))&&(x(V),x(q[V]),ie++);if(ie>65535)throw new Error('Object is too large to serialize with fast 16-bit map size, use the "variableMapSize" option to serialize this object');yt[Y+++n]=ie>>8,yt[Y+n]=ie&255},R=this.useRecords===!1?M:e.progressiveRecords&&!f?q=>{let Y,ie=r.transitions||(r.transitions=Object.create(null)),V=nt++-n,J;for(let X in q)if(typeof q.hasOwnProperty!="function"||q.hasOwnProperty(X)){if(Y=ie[X],Y)ie=Y;else{let ee=Object.keys(q),oe=ie;ie=r.transitions;let fe=0;for(let Re=0,He=ee.length;Re<He;Re++){let Te=ee[Re];Y=ie[Te],Y||(Y=ie[Te]=Object.create(null),fe++),ie=Y}V+n+1==nt?(nt--,U(ie,ee,fe)):G(ie,ee,V,fe),J=!0,ie=oe[X]}x(q[X])}if(!J){let X=ie[jx];X?yt[V+n]=X:G(ie,Object.keys(q),V,0)}}:q=>{let Y,ie=r.transitions||(r.transitions=Object.create(null)),V=0;for(let X in q)(typeof q.hasOwnProperty!="function"||q.hasOwnProperty(X))&&(Y=ie[X],Y||(Y=ie[X]=Object.create(null),V++),ie=Y);let J=ie[jx];J?J>=96&&f?(yt[nt++]=((J-=96)&31)+96,yt[nt++]=J>>5):yt[nt++]=J:U(ie,ie.__keys__||Object.keys(q),V);for(let X in q)(typeof q.hasOwnProperty!="function"||q.hasOwnProperty(X))&&x(q[X])},I=typeof this.useRecords=="function"&&this.useRecords,k=I?q=>{I(q)?R(q):M(q)}:R,P=q=>{let Y;if(q>16777216){if(q-n>zne)throw new Error("Packed buffer would be larger than maximum buffer size");Y=Math.min(zne,Math.round(Math.max((q-n)*(q>67108864?1.25:2),4194304)/4096)*4096)}else Y=(Math.max(q-n<<2,yt.length-1)>>12)+1<<12;let ie=new mP(Y);return na=ie.dataView||(ie.dataView=new DataView(ie.buffer,0,Y)),q=Math.min(q,yt.length),yt.copy?yt.copy(ie,0,n,q):ie.set(yt.slice(n,q)),nt-=n,n=0,Wu=ie.length-10,yt=ie},U=(q,Y,ie)=>{let V=r.nextId;V||(V=64),V<d&&this.shouldShareStructure&&!this.shouldShareStructure(Y)?(V=r.nextOwnId,V<p||(V=d),r.nextOwnId=V+1):(V>=p&&(V=d),r.nextId=V+1);let J=Y.highByte=V>=96&&f?V-96>>5:-1;q[jx]=V,q.__keys__=Y,r[V-64]=Y,V<d?(Y.isShared=!0,r.sharedLength=V-63,i=!0,J>=0?(yt[nt++]=(V&31)+96,yt[nt++]=J):yt[nt++]=V):(J>=0?(yt[nt++]=213,yt[nt++]=114,yt[nt++]=(V&31)+96,yt[nt++]=J):(yt[nt++]=212,yt[nt++]=114,yt[nt++]=V),ie&&(y+=v*ie),g.length>=h&&(g.shift()[jx]=0),g.push(q),x(Y))},G=(q,Y,ie,V)=>{let J=yt,X=nt,ee=Wu,oe=n;yt=BR,nt=0,n=0,yt||(BR=yt=new mP(8192)),Wu=yt.length-10,U(q,Y,V),BR=yt;let fe=nt;if(yt=J,nt=X,Wu=ee,n=oe,fe>1){let Re=nt+fe-1;Re>Wu&&P(Re);let He=ie+n;yt.copyWithin(He+fe,He+1,nt),yt.set(BR.slice(0,fe),He),nt=Re}else yt[ie+n]=BR[0]},$=q=>{let Y=Zqe(q,yt,n,nt,r,P,(ie,V,J)=>{if(J)return i=!0;nt=V;let X=yt;return x(ie),b(),X!==yt?{position:nt,targetView:na,target:yt}:nt},this);if(Y===0)return k(q);nt=Y}}useBuffer(e){yt=e,yt.dataView||(yt.dataView=new DataView(yt.buffer,yt.byteOffset,yt.byteLength)),nt=0}set position(e){nt=e}get position(){return nt}clearSharedData(){this.structures&&(this.structures=[]),this.typedStructs&&(this.typedStructs=[])}}oge=[Date,Set,Error,RegExp,ArrayBuffer,Object.getPrototypeOf(Uint8Array.prototype).constructor,Jme];fq=[{pack(t,e,n){let i=t.getTime()/1e3;if((this.useTimestamp32||t.getMilliseconds()===0)&&i>=0&&i<4294967296){let{target:r,targetView:s,position:a}=e(6);r[a++]=214,r[a++]=255,s.setUint32(a,i)}else if(i>0&&i<4294967296){let{target:r,targetView:s,position:a}=e(10);r[a++]=215,r[a++]=255,s.setUint32(a,t.getMilliseconds()*4e6+(i/1e3/4294967296>>0)),s.setUint32(a+4,i)}else if(isNaN(i)){if(this.onInvalidDate)return e(0),n(this.onInvalidDate());let{target:r,targetView:s,position:a}=e(3);r[a++]=212,r[a++]=255,r[a++]=255}else{let{target:r,targetView:s,position:a}=e(15);r[a++]=199,r[a++]=12,r[a++]=255,s.setUint32(a,t.getMilliseconds()*1e6),s.setBigInt64(a+4,BigInt(Math.floor(i)))}}},{pack(t,e,n){if(this.setAsEmptyObject)return e(0),n({});let i=Array.from(t),{target:r,position:s}=e(this.moreTypes?3:0);this.moreTypes&&(r[s++]=212,r[s++]=115,r[s++]=0),n(i)}},{pack(t,e,n){let{target:i,position:r}=e(this.moreTypes?3:0);this.moreTypes&&(i[r++]=212,i[r++]=101,i[r++]=0),n([t.name,t.message,t.cause])}},{pack(t,e,n){let{target:i,position:r}=e(this.moreTypes?3:0);this.moreTypes&&(i[r++]=212,i[r++]=120,i[r++]=0),n([t.source,t.flags])}},{pack(t,e){this.moreTypes?Hne(t,16,e):jne(DF?Fl.from(t):new Uint8Array(t),e)}},{pack(t,e){let n=t.constructor;n!==cge&&this.moreTypes?Hne(t,sge.indexOf(n.name),e):jne(t,e)}},{pack(t,e){let{target:n,position:i}=e(1);n[i]=193}}];function Hne(t,e,n,i){let r=t.byteLength;if(r+1<256){var{target:s,position:a}=n(4+r);s[a++]=199,s[a++]=r+1}else if(r+1<65536){var{target:s,position:a}=n(5+r);s[a++]=200,s[a++]=r+1>>8,s[a++]=r+1&255}else{var{target:s,position:a,targetView:o}=n(7+r);s[a++]=201,o.setUint32(a,r+1),a+=4}s[a++]=116,s[a++]=e,t.buffer||(t=new Uint8Array(t)),s.set(new Uint8Array(t.buffer,t.byteOffset,t.byteLength),a)}function jne(t,e){let n=t.byteLength;var i,r;if(n<256){var{target:i,position:r}=e(n+2);i[r++]=196,i[r++]=n}else if(n<65536){var{target:i,position:r}=e(n+3);i[r++]=197,i[r++]=n>>8,i[r++]=n&255}else{var{target:i,position:r,targetView:s}=e(n+5);i[r++]=198,s.setUint32(r,n),r+=4}i.set(t,r)}function t$e(t,e,n,i){let r=t.length;switch(r){case 1:e[n++]=212;break;case 2:e[n++]=213;break;case 4:e[n++]=214;break;case 8:e[n++]=215;break;case 16:e[n++]=216;break;default:r<256?(e[n++]=199,e[n++]=r):r<65536?(e[n++]=200,e[n++]=r>>8,e[n++]=r&255):(e[n++]=201,e[n++]=r>>24,e[n++]=r>>16&255,e[n++]=r>>8&255,e[n++]=r&255)}return e[n++]=i,e.set(t,n),n+=r,n}function n$e(t,e){let n,i=e.length*6,r=t.length-i;for(;n=e.pop();){let s=n.offset,a=n.id;t.copyWithin(s+i,s,r),i-=6;let o=s+i;t[o++]=214,t[o++]=105,t[o++]=a>>24,t[o++]=a>>16&255,t[o++]=a>>8&255,t[o++]=a&255,r=s}return t}function Vne(t,e,n){if(Xa.length>0){na.setUint32(Xa.position+t,nt+n-Xa.position-t),Xa.stringsPosition=nt-t;let i=Xa;Xa=null,e(i[0]),e(i[1])}}function i$e(t,e){return t.isCompatible=n=>{let i=!n||(e.lastNamedStructuresLength||0)===n.length;return i||e._mergeStructures(n),i},t}let lge=new e$e({useRecords:!1});lge.pack;lge.pack;const r$e=512,s$e=1024,a$e=2048,je=yE("SOFTWARE");function Gne(){return{id:Bo()}}function sh(t){var e;return(((e=t==null?void 0:t.id)==null?void 0:e.length)??0)>0}function rN(t,e){if(!se(t)||!a0(e))return;const{color:n,bg:i}=ave(e);se(n)&&(t.color=n),se(i)&&(t.bg=i)}function UA(t){var e;return si((t==null?void 0:t.name)??((e=t==null?void 0:t.kinddata)==null?void 0:e.name)??"")}function o$e(){return new Array(fi*Fr).map(()=>{})}function q9(t=Zu){const e={terrain:o$e(),objects:{},id:""};return t(e)}function XU(t){return nm(t.x,t.y,0,fi-1,Fr-1,0)}function XT(t,e){return!se(t)||!se(e==null?void 0:e.x)||!se(e==null?void 0:e.y)||e.x<0||e.x>=fi||e.y<0||e.y>=Fr?-1:e.x+e.y*fi}function gl(t,e){const n=XT(t,e);if(n<0||!se(t==null?void 0:t.lookup))return;const i=w_(t,t.lookup[n]??"");return se(i)?i:t.terrain[n]}function PF(t,e,n){return(e>=0&&e<fi)??(n>=0&&n<Fr)?t==null?void 0:t.terrain[e+n*fi]:void 0}function Jf(t,e){if(!se(t)||!se(e)||!se(e.x)||!se(e.y)||e.x<0||e.x>=fi||e.y<0||e.y>=Fr)return;const n=fl(e),i=e.x+e.y*fi;return t.terrain[i]=n,delete t.distmaps,t.terrain[i]}function c$e(t,e){if(!se(t)||!se(e))return;const n=fl(e);return n.id=n.id??Bo(),t.objects[n.id]=n,t.objects[n.id]}function l$e(t,e,n){return Jf(t,{...e,kind:n})}function uge(t,e,n,i){return c$e(t,{...e,kind:n,id:i})}function w_(t,e){if(t)return t.objects[e]}function u$e(t,e){const n=XT(t,e);if(n<0||!se(t==null?void 0:t.lookup))return;const i=w_(t,t.lookup[n]??"");if(se(i))return i}function h$e(t,e,n){if(!se(t)||!se(e))return;const i=t.objects[n];if(se(i))return i;if(GC(e))return dge(e,VI(t,"player"))}function sN(t,e){const n=t??vs.ISWALK,i=e??vs.ISWALK;switch(n){case vs.ISWALK:return i!==vs.ISWALK;case vs.ISSWIM:return i!==vs.ISSWIM;case vs.ISSOLID:return!0;case vs.ISBULLET:return i!==vs.ISWALK&&i!==vs.ISSWIM}}function aN(t,e,n){const i=t==null?void 0:t.objects[n];if(se(i))return i;const r=VI(t,"player");return se(e)?(e.x<0&&(e.x=Zd(0,fi-1)),e.y<0&&(e.y=Zd(0,Fr-1)),dge(e,r)):Za(...r)}function VI(t,e){var i,r;return[...((r=(i=t==null?void 0:t.named)==null?void 0:i[e])==null?void 0:r.values())??[]].map(s=>typeof s=="string"?t==null?void 0:t.objects[s]:t==null?void 0:t.terrain[s]).filter(se)}function f$e(t){const e=[];for(let n=0;n<Fr;++n)for(let i=0;i<fi;++i){const r={x:i,y:n},s=gl(t,r);!(s!=null&&s.name)&&!(s!=null&&s.kind)&&e.push(r)}return e}function hge(t,e){const n=cq(e),i=Xme(e),r=Kme(e);return VI(t,n??"").filter(s=>{var a,o,c;return!(se(n)&&si((s==null?void 0:s.name)??((a=s==null?void 0:s.kinddata)==null?void 0:a.name)??"")!==n||se(i)&&((s==null?void 0:s.color)??((o=s==null?void 0:s.kinddata)==null?void 0:o.color)??Jt.WHITE)!==i||se(r)&&((s==null?void 0:s.bg)??((c=s==null?void 0:s.kinddata)==null?void 0:c.bg)??Jt.BLACK)!==r)}).filter(se)}function fge(t,e){return se(t)?e.map(n=>{var i;if(typeof n=="string"){const r=t.objects[n];if(se(r))return r;const s=VI(t,si(n));if(s.length)return s}else if(GC(n)&&n.x>=0&&n.x<fi&&n.y>=0&&n.y<Fr){const r=n.x+n.y*fi,s=(i=t.lookup)==null?void 0:i[r];return se(s)?t.objects[s]:t.terrain[r]}}).flat().filter(se):[]}function dge(t,e){let n=0,i;for(let r=0;r<e.length;++r){const s=e[r];if(s){const a=t.x-(s.x??0),o=t.y-(s.y??0),c=Math.sqrt(a*a+o*o);(i===void 0||c<n)&&(n=c,i=s)}}return i}function Ws(t){return`${t??""}`}function hT(t,e){const n=parseFloat(Ws(t));return isNaN(n)?e:n}function mu(t,e){return typeof t==typeof e?t:e}const LF=B9(32,126).map(t=>String.fromCharCode(t));function xr(t){return ld({...t,name:`token_${t.name}`})}function xE(t,e=!1){return xr(e?{name:t,pattern:new RegExp(t.toLowerCase(),"i"),longer_alt:Sl,group:zc.SKIPPED}:{name:t,pattern:new RegExp(t.toLowerCase(),"i"),longer_alt:Sl})}const $C=xr({name:"newline",line_breaks:!0,start_chars_hint:[`
`,"\r"],pattern:/\n|\r\n?/}),pge=xr({name:"whitespace",pattern:/ +/,group:zc.SKIPPED}),mge=xr({name:"whitespace",pattern:/\s+/,line_breaks:!0,group:zc.SKIPPED}),GI=xr({name:"stat",pattern:/@.*/,start_chars_hint:["@"]}),eT=xr({name:"command",pattern:/#/,start_chars_hint:["#"]});let gge=!1;function d$e(t,e,n){if(!gge)return null;const[i]=n.slice(-1);if(i&&i.tokenType!==$C)return null;let r=e;for(;t[r]===" ";)r++;if("@#/?':!".includes(t[r]))return null;let s=e+1;for(;s<t.length&&t[s]!==`
`;)s++;const a=t.substring(e,s);return a.trim().length===0?null:[a]}const UF=xr({name:"text",pattern:d$e,line_breaks:!1,start_chars_hint:LF.filter(t=>"@#/?':!".includes(t)===!1)}),$9=xr({name:"comment",pattern:/'.*/,start_chars_hint:["'"]}),W9=xr({name:"label",pattern:/:[^;:\n]*/,start_chars_hint:[":"]}),Y9=xr({name:"hyperlink",pattern:/!/,start_chars_hint:["!"]}),X9=xr({name:"hyperlinktext",pattern:/;[^;\n]*/,start_chars_hint:[";"]}),Sl=xr({name:"stringliteral",pattern:/[^-0-9"!;@#/?()\s]+[^-"!;@#/?()\s]*/,start_chars_hint:LF}),K9=xr({name:"stringliteraldouble",pattern:/"(?:[^\\"]|\\(?:[^\n\r]|u[0-9a-fA-F]{4}))*"/}),Z9=xr({name:"numberliteral",pattern:/-?(\d*\.)?\d+([eE][+-]?\d+)?[jJ]?[lL]?/}),J9=xr({name:"iseq",pattern:/=|is|eq|equal/,longer_alt:Sl}),Q9=xr({name:"isnoteq",pattern:/!=|not ?eq|not ?equal/,longer_alt:Sl}),eY=xr({name:"islessthan",pattern:/<|below/,longer_alt:Sl}),tY=xr({name:"isgreaterthan",pattern:/>|above/,longer_alt:Sl}),nY=xr({name:"islessthanorequal",pattern:/<=|below ?or ?eq|below ?or ?equal/,longer_alt:Sl}),iY=xr({name:"isgreaterthanorequal",pattern:/>=|above ?or ?eq|above ?or ?equal/,longer_alt:Sl}),KU=xr({name:"or",pattern:/or/i,longer_alt:Sl}),ZU=xr({name:"not",pattern:/not/i,longer_alt:Sl}),JU=xr({name:"and",pattern:/and/i,longer_alt:Sl}),QU=xr({name:"plus",pattern:/\+/}),e3=xr({name:"minus",pattern:/-/}),rY=xr({name:"power",pattern:/\*\*/}),sY=xr({name:"multiply",pattern:/\*/}),t3=xr({name:"divide",pattern:/\//}),aY=xr({name:"moddivide",pattern:/%/}),oY=xr({name:"floordivide",pattern:/%%/}),cY=xr({name:"query",pattern:/\?/}),lY=xr({name:"lparen",pattern:/\(/,push_mode:"ignore_newlines"}),uY=xr({name:"rparen",pattern:/\)/,pop_mode:!0}),hY=xr({name:"command_play",pattern:/(play|bgplay) .*/,start_chars_hint:LF,longer_alt:Sl}),vge=xr({name:"command_toast",pattern:/toast .*/,start_chars_hint:LF,longer_alt:Sl}),n3=xr({name:"if",pattern:/if|try|take|give/,longer_alt:Sl}),YM=xE("do"),i3=xE("done"),r3=xE("else"),fY=xE("while"),dY=xE("repeat"),pY=xE("waitfor"),mY=xr({name:"foreach",pattern:/foreach|for/,longer_alt:Sl}),gY=xE("break"),vY=xE("continue");function _ge(t){return[...t,Z9,J9,Q9,nY,eY,iY,tY,KU,ZU,JU,QU,e3,rY,sY,t3,oY,aY,cY,lY,uY,K9,Sl]}const yge=_ge([UF,GI,hY,vge,eT,$9,W9,Y9,X9,$C,pge,gY,vY,i3,YM,r3,mY,n3,dY,pY,fY]),p$e=new zc({defaultMode:"use_newlines",modes:{use_newlines:yge,ignore_newlines:_ge([mge])}},{skipValidations:!t0,ensureOptimizations:t0});function _Y(t){gge=!0;const e=p$e.tokenize(t||` 
`),[n]=(Li(e.tokens)?e.tokens:[]).slice(-1);return n&&n.tokenType.name!=="Newline"&&e.tokens.push(HI($C,`
`,n.startOffset,n.endOffset??NaN,n.startLine??NaN,n.endLine??NaN,n.startColumn??NaN,n.endColumn??NaN)),e}function bge(t,e,n=!0){if(n){const[i,...r]=e;switch(si(i??"")){default:return{type:cn.OBJECT,values:e};case"loader":return{type:cn.LOADER,values:r};case"board":return{type:cn.BOARD,values:r};case"object":return{type:cn.OBJECT,values:r};case"terrain":return{type:cn.TERRAIN,values:r};case"charset":return{type:cn.CHARSET,values:r};case"palette":return{type:cn.PALETTE,values:r}}}else{const[i,r,...s]=e,a=si(r??""),o=[i,t,...s];switch(a){default:return{type:cn.CONST,values:e};case"rn":case"range":return{type:cn.RANGE,values:o};case"sl":case"select":return{type:cn.SELECT,values:o};case"nm":case"number":return{type:cn.NUMBER,values:o};case"tx":case"text":return{type:cn.TEXT,values:o};case"ln":case"link":return{type:cn.LINK,values:o};case"hk":case"hotkey":return{type:cn.HOTKEY,values:o};case"copyit":return{type:cn.COPYIT,values:o};case"openit":return{type:cn.OPENIT,values:o};case"zssedit":return{type:cn.ZSSEDIT,values:o};case"charedit":return{type:cn.CHAREDIT,values:o};case"coloredit":return{type:cn.COLOREDIT,values:o}}}}function Wf(t){switch(t){case cn.LOADER:return"loader";case cn.BOARD:return"board";case cn.OBJECT:return"object";case cn.TERRAIN:return"terrain";case cn.CHARSET:return"charset";case cn.PALETTE:return"palette";case cn.CONST:return"const";case cn.RANGE:return"range";case cn.SELECT:return"select";case cn.NUMBER:return"number";case cn.TEXT:return"text";case cn.LINK:return"link";case cn.HOTKEY:return"hotkey";case cn.COPYIT:return"copyit";case cn.OPENIT:return"openit";case cn.ZSSEDIT:return"zssedit";case cn.CHAREDIT:return"charedit";case cn.COLOREDIT:return"coloredit"}}function m$e(t,e){return{id:Bo(),code:t,...e}}function gP(t){const e={...BF(t)};return Object.keys(e).forEach(n=>{switch(n){case"type":case"name":delete e[n];break}}),e}function g$e(t){const e=_Y(t),n={};let i=!0;for(let r=0;r<e.tokens.length;++r){const s=e.tokens[r];if(s.tokenType===GI){const a=s.image.slice(1),[o,c]=a.split(";").map(f=>f.trim()),l=o.split(" "),u=bge(On(c)?c:"",l,i),h=si(u.values.join(" "));switch(i=!1,u.type){case cn.LOADER:n.type=Wn.LOADER,n.name=h;break;case cn.BOARD:n.type=Wn.BOARD,n.name=h;break;case cn.OBJECT:n.type=Wn.OBJECT,n.name=h||"object";break;case cn.TERRAIN:n.type=Wn.TERRAIN,n.name=h;break;case cn.CHARSET:n.type=Wn.CHARSET,n.name=h;break;case cn.PALETTE:n.type=Wn.PALETTE,n.name=h;break;case cn.CONST:{const[f,d]=u.values;if(On(f)){const p=si(f);if(On(d)){const g=parseFloat(d);n[p]=pn(g)?g:d}else pn(d)?n[p]=d:n[p]=1}break}case cn.RANGE:case cn.SELECT:case cn.NUMBER:case cn.TEXT:case cn.LINK:case cn.HOTKEY:case cn.ZSSEDIT:case cn.CHAREDIT:case cn.COLOREDIT:{const[f,...d]=u.values;if(On(f)){const p=si(f);n[p]=[Wf(u.type),...d]}break}}}}return n}function BF(t){var e;return se(t)?(se((e=t.stats)==null?void 0:e.type)||(t.stats=g$e(t.code),se(t.stats.type)||(t.stats.type=Wn.OBJECT)),t.stats):{}}function Ege(t){switch(t){default:case Wn.ERROR:return"error";case Wn.LOADER:return Wf(cn.LOADER);case Wn.BOARD:return Wf(cn.BOARD);case Wn.OBJECT:return Wf(cn.OBJECT);case Wn.TERRAIN:return Wf(cn.TERRAIN);case Wn.CHARSET:return Wf(cn.CHARSET);case Wn.PALETTE:return Wf(cn.PALETTE)}}function KT(t){return BF(t).type??Wn.ERROR}function IS(t){return Ege(KT(t))}function Qu(t){return BF(t).name??""}const vP=new yn;function qne(t,e){const n=Object.keys(t);for(let i=0;i<n.length;++i){const r=n[i],s=t[r];if(!Li(s))switch(r){case"name":case"char":case"color":case"bg":case"light":case"group":case"p1":case"p2":case"p3":case"cycle":case"stepx":case"stepy":e[r]=t[r];break;case"ispushable":e.pushable=1;break;case"iswalk":case"iswalking":case"iswalkable":e.collision=vs.ISWALK;break;case"isswim":case"isswimming":case"isswimable":e.collision=vs.ISSWIM;break;case"issolid":e.collision=vs.ISSOLID;break;case"isbullet":e.collision=vs.ISBULLET;break;case"isdestructible":e.destructible=1;break}}}function qc(t){var e;if(se(t))switch(KT(t)){default:return;case Wn.ERROR:return t.code??"";case Wn.LOADER:return t.code??"";case Wn.BOARD:{se(t.board)||(t.board=q9()),t.board.id=t.id;const n=gP(t);return t.board.isdark=n.isdark??t.board.isdark?1:0,t.board.startx=n.startx??t.board.startx,t.board.starty=n.starty??t.board.starty,t.board.over=n.over??t.board.over,t.board.under=n.under??t.board.under,t.board.camera=n.camera??t.board.camera,t.board.graphics=n.graphics??t.board.graphics,t.board.facing=n.facing??t.board.facing,t.board.exitnorth=n.exitnorth??t.board.exitnorth,t.board.exitsouth=n.exitsouth??t.board.exitsouth,t.board.exitwest=n.exitwest??t.board.exitwest,t.board.exiteast=n.exiteast??t.board.exiteast,t.board.timelimit=n.timelimit??t.board.timelimit,t.board.restartonzap=n.restartonzap??t.board.restartonzap,t.board.maxplayershots=n.maxplayershots??t.board.maxplayershots,t.board}case Wn.OBJECT:return se(t.object)||(t.object=Gne()),t.object.name=Qu(t),t.object.category=GT.ISOBJECT,qne(gP(t),t.object),t.object;case Wn.TERRAIN:return se(t.terrain)||(t.terrain=Gne()),t.terrain.name=Qu(t),t.terrain.category=GT.ISTERRAIN,qne(gP(t),t.terrain),t.terrain;case Wn.PALETTE:{if(se(t.palette)||(t.palette=T1(PA)),se((e=t.palette)==null?void 0:e.bits)){const n=gP(t),i=uF(n);for(let r=0;r<i.length;++r){const s=i[r].toLowerCase(),a=n[s];if(s.startsWith("color")&&On(a)){const o=parseFloat(s.replace("color",""));if(o>=0&&o<=15){vP.set(a);const c=o*Xb,l=vP.r*63,u=vP.g*63,h=vP.b*63;t.palette.bits[c+0]=lr(l,0,63),t.palette.bits[c+1]=lr(u,0,63),t.palette.bits[c+2]=lr(h,0,63)}}}}return t.palette}case Wn.CHARSET:return se(t.charset)||(t.charset=DA(kI)),t.charset}}function Sge(t){return{id:Bo(),name:XFe(),timestamp:0,activelist:[],pages:t,flags:{}}}function Tge(t){se(t)&&(t.token=`${KFe()}${Zd(1111,9999)}`)}function wT(t,e){if(!se(t))return;const n=si(e);return t.pages.find(r=>r.id===e||n===Qu(r))}function lh(t,e,n){if(!se(t))return;const i=si(n);return t.pages.find(s=>KT(s)===e&&(s.id===n||i===Qu(s)))}function dq(t,e,n){let i=lh(t,e,n);if(!se(i)){const r=Ege(e);i=m$e(r==="object"?`@${n||"object"}
`:`@${r} ${n}
`,{}),v$e(t,i)}return i}function sp(t,e,n){if(!se(t))return[];const i=si(n);return t.pages.filter(s=>KT(s)===e).filter(s=>{const a=BF(s),o=si(Qu(s));return s.id===n||i===o||se(a[n])})}function L5(t){return se(t)?fl(t.pages).sort((n,i)=>{const r=KT(n),s=KT(i);return r===s?Qu(n).localeCompare(Qu(i)):s-r}):[]}function v$e(t,e){if(!se(t)||!se(e))return!1;const n=wT(t,e.id);return se(n)?!1:(t.pages.push(e),Tge(t),!0)}function xge(t,e){const n=wT(t,e);if(se(t)&&se(n)){const i=si(e);return t.pages=t.pages.filter(r=>r.id!==e&&i!==Qu(r)),Tge(t),n}}function Jb(t,e){if(se(e)&&se(e.kind))return se(e.kinddata)||(e.kinddata=se(e.id)?qI(t,e.kind):FF(t,e.kind)),e.kinddata}function lu(t,e,n){const i=Jb(t,e);return(e==null?void 0:e[n])??(i==null?void 0:i[n])}function C_(t,e){return Ws(lu(t,e,"group"))}function qI(t,e){const n=e??"",i=lh(t,Wn.OBJECT,n);if(se(i)){const r=qc(i);return{...fl(r),name:n,code:i.code}}}function FF(t,e){const n=e??"",i=lh(t,Wn.TERRAIN,n);if(se(i)){const r=qc(i);return{...fl(r),name:n,code:i.code}}}function Qw(t,e){const n=wT(t,e);return qc(n)}function zF(t,e){return t?(t.flags[e]=t.flags[e]??{},t.flags[e]):{}}function _$e(t,e){t&&delete t.flags[e]}function wge(t,e,n){const i=zF(t,e);return i==null?void 0:i[n]}function y$e(t,e,n,i){const r=zF(t,e);return r&&(r[n]=i),i}function b$e(t,e){const n=wge(t,e,"board");return Qw(t,On(n)?n:"")}function E$e(t,e,n){if(!se(t))return;y$e(t,e,"board",n);const i=Qw(t,n);se(i)?t.activelist.includes(e)||t.activelist.push(e):t.activelist=t.activelist.filter(r=>r!==e)}function Ow(t,e,n,i){if(!se(t))return;const r=b$e(t,e);if(!se(r))return;const s=w_(r,e);if(!sh(s)||!(s!=null&&s.id))return;const a=Qw(t,n);if(!se(a)||(vl(t,a),yY(t,a,vs.ISWALK,i)))return;delete r.objects[s.id];const o=XT(r,s);r.lookup&&(r.lookup[o]=void 0),s.x=i.x,s.y=i.y,a.objects[s.id]=s;const c=XT(a,s);a.lookup&&(a.lookup[c]=s.id),E$e(t,e,a.id)}function S$e(t){const n=((t==null?void 0:t.activelist)??[]).map(i=>{const r=wge(t,i,"board");return On(r)?r:""});return lqe(n)}function T$e(t){const e=S$e(t),n=new Set,i=[];for(let r=0;r<e.length;++r){const s=Qw(t,e[r]);if(se(s)&&!n.has(s.id)){if(On(s.over))if(On(s.overboard)){const a=Qw(t,s.overboard);se(a)?n.has(a.id)||i.push(a):delete s.overboard}else{const a=sp(t,Wn.BOARD,s.over);if(a.length){const o=Za(a),c=qc(o);se(c)&&(s.overboard=c.id)}}else On(s.overboard)&&delete s.overboard;if(i.push(s),On(s.under))if(On(s.underboard)){const a=Qw(t,s.underboard);se(a)||delete s.underboard}else{const a=sp(t,Wn.BOARD,s.under);if(a.length){const o=Za(a),c=qc(o);se(c)&&(s.underboard=c.id)}}else On(s.underboard)&&delete s.underboard}}return i}function x$e(t,e,n,i,r){if(!se(e))return;se(e.distmaps)||(e.distmaps={});const s=`${n}.${i.x}.${i.y}.${r.x}.${r.y}`;let a=e.distmaps[s];if(!se(a)){a=new Array(u9).fill(-2);const o=[{...r}];let c=0;for(;o.length;){const l=o.shift();if(se(l)&&XU(l)){const u=YT(l,fi);if(a[u]===-2){const h=PF(e,l.x,l.y);sN(n,lu(t,h,"collision")??vs.ISWALK)||(a[u]=c,o.push({x:l.x,y:l.y-1},{x:l.x,y:l.y+1},{x:l.x-1,y:l.y},{x:l.x+1,y:l.y})),++c}}}e.distmaps[s]=a}return a}function $ne(t,e){return XU(t)?e[YT(t,fi)]:-1}function Wne(t,e,n,i,r,s){if(!se(t)||!se(e))return;const a=x$e(t,e,n,i,r);if(!se(a))return;const o=[{x:i.x,y:i.y-1},{x:i.x,y:i.y+1},{x:i.x-1,y:i.y},{x:i.x+1,y:i.y}];let c;if(s){let l=s?0:1e4;for(let u=0;u<o.length;++u){const h=$ne(o[u],a);h>=0&&h>l&&(l=h,c=o[u])}}else{let l=1e5;for(let u=0;u<o.length;++u){const h=$ne(o[u],a);h>=0&&h<l&&(l=h,c=o[u])}}return c}function vl(t,e){var o;if(!se(t)||!se(e)||se(e.lookup)&&se(e.named))return;const n=new Array(fi*Fr).fill(void 0),i={},r=Object.values(e.objects);for(let c=0;c<r.length;++c){const l=r[c];if(se(l.x)&&se(l.y)&&se(l.id)&&!se(l.removed)){l.category=GT.ISOBJECT,n[l.x+l.y*fi]=l.id;const u=si(l.name??((o=l.kinddata)==null?void 0:o.name)??"");i[u]||(i[u]=new Set),i[u].add(l.id)}}let s=0,a=0;for(let c=0;c<e.terrain.length;++c){const l=e.terrain[c];if(se(l)){l.x=s,l.y=a,l.category=GT.ISTERRAIN;const u=UA(l);i[u]||(i[u]=new Set),i[u].add(c)}++s,s>=fi&&(s=0,++a)}e.lookup=n,e.named=i}function s3(t,e){se(e)&&(delete e.named,delete e.lookup,vl(t,e))}function Yne(t,e,n,i){var s;if(!se(t)||!se(e)||!se(e.named)||!se(n))return;const r=si(n.name??((s=n.kinddata)==null?void 0:s.name)??"");e.named[r]||(e.named[r]=new Set),e.named[r].add((n==null?void 0:n.id)??i??"")}function w$e(t,e,n){if(!(!se(t)||!se(e)||!se(e.lookup)||!se(n==null?void 0:n.id))&&!se(n.removed)){const i=n.x??0,r=n.y??0;e.lookup[i+r*fi]=n.id}}function C$e(t,e,n){var i;if(se(t)&&se(e)&&se(n==null?void 0:n.x)&&se(n.y)){const r=UA(n),s=XT(e,n);se((i=e.named)==null?void 0:i[r])&&e.named[r].delete(s)}}function Cge(t,e,n){var i;if(se(t)&&se(e)&&se(n==null?void 0:n.id)){if(se(e.lookup)&&se(n.x)&&se(n.y)){const s=n.x+n.y*fi;e.lookup[s]===n.id&&(e.lookup[s]=void 0)}const r=UA(n);se((i=e.named)==null?void 0:i[r])&&se(n.id)&&e.named[r].delete(n.id)}}function Age(t,e,n,i,r,s){if(!se(t)||!se(e)||!se(n))return{x:0,y:0};const a={x:n.x??0,y:n.y??0},o={x:n.lx??a.x,y:n.ly??a.y},c=Fv(o,a),l=fi-1,u=Fr-1;for(let h=0;h<r.length;++h){const f=pqe(r[h]);switch(f){case rn.IDLE:break;case rn.NORTH:case rn.SOUTH:case rn.WEST:case rn.EAST:ac(a,f);break;case rn.BY:{const[d,p]=r.slice(h+1);pn(d)&&pn(p)&&(a.x=lr(a.x+d,0,l),a.y=lr(a.y+p,0,u)),h+=2;break}case rn.TO:case rn.AT:{const[d,p]=r.slice(h+1);pn(d)&&pn(p)&&(a.x=lr(d,0,l),a.y=lr(p,0,u)),h+=2;break}case rn.FLOW:ac(a,c);break;case rn.SEEK:{const d=h$e(e,n,i);GC(d)&&ac(a,Fv(s,d));break}case rn.RNDNS:ac(a,Za(rn.NORTH,rn.SOUTH));break;case rn.RNDNE:ac(a,Za(rn.NORTH,rn.EAST));break;case rn.RND:ac(a,Za(rn.NORTH,rn.SOUTH,rn.WEST,rn.EAST));break;case rn.CW:case rn.CCW:case rn.OPP:case rn.RNDP:{const d=Age(t,e,n,i,r.slice(h+1),s);switch(a.x=s.x,a.y=s.y,f){case rn.CW:switch(Fv(s,d)){case rn.NORTH:ac(a,rn.EAST);break;case rn.SOUTH:ac(a,rn.WEST);break;case rn.EAST:ac(a,rn.SOUTH);break;case rn.WEST:ac(a,rn.NORTH);break}break;case rn.CCW:switch(Fv(s,d)){case rn.NORTH:ac(a,rn.WEST);break;case rn.SOUTH:ac(a,rn.EAST);break;case rn.EAST:ac(a,rn.NORTH);break;case rn.WEST:ac(a,rn.SOUTH);break}break;case rn.OPP:switch(Fv(s,d)){case rn.NORTH:ac(a,rn.SOUTH);break;case rn.SOUTH:ac(a,rn.NORTH);break;case rn.EAST:ac(a,rn.WEST);break;case rn.WEST:ac(a,rn.EAST);break}break;case rn.RNDP:switch(Fv(s,d)){case rn.NORTH:case rn.SOUTH:a.x+=Za(-1,1);break;case rn.WEST:case rn.EAST:a.y+=Za(-1,1);break}break}break}case rn.FLEE:case rn.AWAY:{const[d,p]=r.slice(h+1);if(pn(d)&&pn(p)){const g={x:lr(d,0,l),y:lr(p,0,u)},y=lu(t,n,"collision"),v=Wne(t,e,y,a,g,!0);se(v)&&(a.x=v.x,a.y=v.y)}h+=2;break}case rn.FIND:case rn.TOWARD:{const[d,p]=r.slice(h+1);if(pn(d)&&pn(p)){const g={x:lr(d,0,l),y:lr(p,0,u)};if(Zd(1,100)<5)ac(a,Za(rn.NORTH,rn.SOUTH,rn.WEST,rn.EAST));else{const y=lu(t,n,"collision"),v=Wne(t,e,y,a,g,!1);if(se(v))if(v.x!==d&&v.y!==p&&u$e(e,v))switch(Fv(s,v)){case rn.EAST:case rn.WEST:a.y+=Za(-1,1);break;case rn.NORTH:case rn.SOUTH:a.x+=Za(-1,1);break}else a.x=v.x,a.y=v.y}}h+=2;break}case rn.PLAYER:{const d=aN(e,s,i);GC(d)&&(a.x=d.x,a.y=d.y);break}}}return a}function A$e(t,e,n,i){if(se(t)&&se(e)&&se(n)){const[r,s]=n,a=qI(t,r);if(se(a)&&se(a.name)){const o=uge(e,i,r);return rN(o,s),o}}}function ZT(t,e,n,i,r){if(se(t)&&se(e)&&se(n)){const[s,a]=n,o=FF(t,s);if(se(o)){const l=l$e(e,i,s);if(se(l)){rN(l,a);const u=YT(i,fi);return Jb(t,l),Yne(t,e,l,u),l}}const c=qI(t,s);if(se(c)&&se(c.name)){const l=uge(e,i,s,r);if(se(l))return rN(l,a),w$e(t,e,l),Jb(t,l),Yne(t,e,l),l}}}function Wg(t,e,n,i){return!se(n)||UA(n)==="player"?!1:(n.id?(n.removed=i,Cge(t,e,n)):(Jf(e,{x:(n==null?void 0:n.x)??0,y:(n==null?void 0:n.y)??0}),C$e(t,e,n)),!0)}function yY(t,e,n,i){if(!se(t)||!se(e)||!se(e.lookup)||i.x<0||i.x>=fi||i.y<0||i.y>=Fr)return!0;const r=i.x+i.y*fi,s=w_(e,e.lookup[r]??"404");if(se(s))return!0;const a=e.terrain[r];if(se(a)){const o=Jb(t,a),c=a.collision??(o==null?void 0:o.collision);return sN(n,c)}return!1}function R$e(t,e,n,i){const r=w_(e,(n==null?void 0:n.id)??""),s=(r==null?void 0:r.x)??-1,a=(r==null?void 0:r.y)??-1;if(s-i.x===0&&a-i.y===0)return!0;const o=lu(t,r,"collision");return yY(t,e,o,i)}function bY(t,e,n,i){var f;const r=w_(e,(n==null?void 0:n.id)??"");if(!se(t)||!se(e)||!se(r)||!se(r.x)||!se(r.y)||!se(e.lookup)||!se(n)||i.x<0||i.x>=fi||i.y<0||i.y>=Fr)return{name:"edge",kind:"edge",collision:vs.ISSOLID,x:i.x,y:i.y};if(r.x-i.x===0&&r.y-i.y===0)return;const s=XT(e,r),a=XT(e,i),o=lu(t,r,"collision")??vs.ISWALK,c=Nb(r==null?void 0:r.id),l=w_(e,e.lookup[a]??""),u=Nb((l==null?void 0:l.id)??"");if(se(l)&&(!c||!u)&&C_(t,n)!==C_(t,l)){if(!!lu(t,l,"pushable")){const p={x:i.x-(n.x??0),y:i.y-(n.y??0)};bY(t,e,l,p)}return{...l}}const h=e.terrain[a];if(se(h)){const d=h.collision??((f=h==null?void 0:h.kinddata)==null?void 0:f.collision)??vs.ISWALK;if(sN(o,d))return{...h,x:i.x,y:i.y}}r.x=i.x,r.y=i.y,se(r.removed)||(e.lookup[s]=void 0,e.lookup[a]=r.id??"")}function M$e(t,e,n){const i=[],r=[];if(!se(t)||!se(e))return{objectelements:i,terrainelements:r};const s=Object.values(e.objects);for(let a=0;a<s.length;++a){const o=s[a],c=lu(t,o,n),l=C_(t,o);(se(c)||l===n)&&i.push(o)}for(let a=0;a<u9;++a){const o=e.terrain[a];if(se(o)){const c=lu(t,o,n),l=C_(t,o);(se(c)||l===n)&&r.push(o)}}return{objectelements:i,terrainelements:r}}var Rge={exports:{}},U5={exports:{}},Xne;function O$e(){return Xne||(Xne=1,function(t,e){(function(n,i){t.exports=i()})(jl,function(){function n(g){return!isNaN(parseFloat(g))&&isFinite(g)}function i(g){return g.charAt(0).toUpperCase()+g.substring(1)}function r(g){return function(){return this[g]}}var s=["isConstructor","isEval","isNative","isToplevel"],a=["columnNumber","lineNumber"],o=["fileName","functionName","source"],c=["args"],l=["evalOrigin"],u=s.concat(a,o,c,l);function h(g){if(g)for(var y=0;y<u.length;y++)g[u[y]]!==void 0&&this["set"+i(u[y])](g[u[y]])}h.prototype={getArgs:function(){return this.args},setArgs:function(g){if(Object.prototype.toString.call(g)!=="[object Array]")throw new TypeError("Args must be an Array");this.args=g},getEvalOrigin:function(){return this.evalOrigin},setEvalOrigin:function(g){if(g instanceof h)this.evalOrigin=g;else if(g instanceof Object)this.evalOrigin=new h(g);else throw new TypeError("Eval Origin must be an Object or StackFrame")},toString:function(){var g=this.getFileName()||"",y=this.getLineNumber()||"",v=this.getColumnNumber()||"",b=this.getFunctionName()||"";return this.getIsEval()?g?"[eval] ("+g+":"+y+":"+v+")":"[eval]:"+y+":"+v:b?b+" ("+g+":"+y+":"+v+")":g+":"+y+":"+v}},h.fromString=function(y){var v=y.indexOf("("),b=y.lastIndexOf(")"),T=y.substring(0,v),x=y.substring(v+1,b).split(","),M=y.substring(b+1);if(M.indexOf("@")===0)var R=/@(.+?)(?::(\d+))?(?::(\d+))?$/.exec(M,""),I=R[1],k=R[2],P=R[3];return new h({functionName:T,args:x||void 0,fileName:I,lineNumber:k||void 0,columnNumber:P||void 0})};for(var f=0;f<s.length;f++)h.prototype["get"+i(s[f])]=r(s[f]),h.prototype["set"+i(s[f])]=function(g){return function(y){this[g]=!!y}}(s[f]);for(var d=0;d<a.length;d++)h.prototype["get"+i(a[d])]=r(a[d]),h.prototype["set"+i(a[d])]=function(g){return function(y){if(!n(y))throw new TypeError(g+" must be a Number");this[g]=Number(y)}}(a[d]);for(var p=0;p<o.length;p++)h.prototype["get"+i(o[p])]=r(o[p]),h.prototype["set"+i(o[p])]=function(g){return function(y){this[g]=String(y)}}(o[p]);return h})}(U5)),U5.exports}(function(t,e){(function(n,i){t.exports=i(O$e())})(jl,function(i){var r=/(^|@)\S+:\d+/,s=/^\s*at .*(\S+:\d+|\(native\))/m,a=/^(eval@)?(\[native code])?$/;return{parse:function(c){if(typeof c.stacktrace<"u"||typeof c["opera#sourceloc"]<"u")return this.parseOpera(c);if(c.stack&&c.stack.match(s))return this.parseV8OrIE(c);if(c.stack)return this.parseFFOrSafari(c);throw new Error("Cannot parse given Error object")},extractLocation:function(c){if(c.indexOf(":")===-1)return[c];var l=/(.+?)(?::(\d+))?(?::(\d+))?$/,u=l.exec(c.replace(/[()]/g,""));return[u[1],u[2]||void 0,u[3]||void 0]},parseV8OrIE:function(c){var l=c.stack.split(`
`).filter(function(u){return!!u.match(s)},this);return l.map(function(u){u.indexOf("(eval ")>-1&&(u=u.replace(/eval code/g,"eval").replace(/(\(eval at [^()]*)|(,.*$)/g,""));var h=u.replace(/^\s+/,"").replace(/\(eval code/g,"(").replace(/^.*?\s+/,""),f=h.match(/ (\(.+\)$)/);h=f?h.replace(f[0],""):h;var d=this.extractLocation(f?f[1]:h),p=f&&h||void 0,g=["eval","<anonymous>"].indexOf(d[0])>-1?void 0:d[0];return new i({functionName:p,fileName:g,lineNumber:d[1],columnNumber:d[2],source:u})},this)},parseFFOrSafari:function(c){var l=c.stack.split(`
`).filter(function(u){return!u.match(a)},this);return l.map(function(u){if(u.indexOf(" > eval")>-1&&(u=u.replace(/ line (\d+)(?: > eval line \d+)* > eval:\d+:\d+/g,":$1")),u.indexOf("@")===-1&&u.indexOf(":")===-1)return new i({functionName:u});var h=/((.*".+"[^@]*)?[^@]*)(?:@)/,f=u.match(h),d=f&&f[1]?f[1]:void 0,p=this.extractLocation(u.replace(h,""));return new i({functionName:d,fileName:p[0],lineNumber:p[1],columnNumber:p[2],source:u})},this)},parseOpera:function(c){return!c.stacktrace||c.message.indexOf(`
`)>-1&&c.message.split(`
`).length>c.stacktrace.split(`
`).length?this.parseOpera9(c):c.stack?this.parseOpera11(c):this.parseOpera10(c)},parseOpera9:function(c){for(var l=/Line (\d+).*script (?:in )?(\S+)/i,u=c.message.split(`
`),h=[],f=2,d=u.length;f<d;f+=2){var p=l.exec(u[f]);p&&h.push(new i({fileName:p[2],lineNumber:p[1],source:u[f]}))}return h},parseOpera10:function(c){for(var l=/Line (\d+).*script (?:in )?(\S+)(?:: In function (\S+))?$/i,u=c.stacktrace.split(`
`),h=[],f=0,d=u.length;f<d;f+=2){var p=l.exec(u[f]);p&&h.push(new i({functionName:p[3]||void 0,fileName:p[2],lineNumber:p[1],source:u[f]}))}return h},parseOpera11:function(c){var l=c.stack.split(`
`).filter(function(u){return!!u.match(r)&&!u.match(/^Error created at/)},this);return l.map(function(u){var h=u.split("@"),f=this.extractLocation(h.pop()),d=h.shift()||"",p=d.replace(/<anonymous function(: (\w+))?>/,"$2").replace(/\([^)]*\)/g,"")||void 0,g;d.match(/\(([^)]*)\)/)&&(g=d.replace(/^[^(]+\(([^)]*)\)$/,"$1"));var y=g===void 0||g==="[arguments not available]"?void 0:g.split(",");return new i({functionName:p,args:y,fileName:f[0],lineNumber:f[1],columnNumber:f[2],source:u})},this)}}})})(Rge);var N$e=Rge.exports;const I$e=Yc(N$e);function b0(t){const e={},n={tick(){},everytick(){},listcommands(){return uF(e)},...t,getcommand(i){return e[i]},command(i,r){return e[i]=r,n}};return n}function Kne(t,e,n){var r;const[i]=Ct(e,0,[Ze.MAYBE_NAME]);zy(je,t,((r=ne.board)==null?void 0:r.id)??"",i??"",n)}function $d(t,e,n,i){const[r,s]=Ct(i,0,[Ze.NUMBER_OR_STRING,Ze.MAYBE_NUMBER_OR_STRING]);epe(je,t,e,n,r,s)}const k$e=["echo","reverb","phaser","distortion","vibrato","fc"];function Mge(t,e,n){const[i,r]=Ct(n,0,[Ze.NUMBER_OR_STRING]);if(pn(i))S5(je,t,e,"volume",i);else if(k$e.includes(si(i))){const[s,a]=Ct(n,r,[Ze.NUMBER_OR_STRING,Ze.MAYBE_NUMBER_OR_STRING]);epe(je,t,e,i,s,a)}else{const[s]=Ct(n,r,[Ze.MAYBE_NUMBER_OR_STRING]);if(pn(s)){const a=n.length-r,o=new Array(a).fill(Ze.NUMBER),c=Ct(n,r,o).slice(0,a),l=c.length===1?c[0]:c;S5(je,t,e,i,l)}else{const[a]=Ct(n,r,[Ze.MAYBE_NUMBER_OR_STRING]);S5(je,t,e,i,a)}}}const EY=b0().command("talk",(t,e)=>{const[n]=Ct(e,0,[Ze.ANY]);switch(si(n)){default:UBe(je,ne.elementfocus);break;case"stop":BBe(je,ne.elementfocus);break}return 0}).command("media",(t,e)=>{const[n]=Ct(e,0,[Ze.ANY]);switch(si(n)){default:FBe(je,ne.elementfocus);break;case"stop":zBe(je,ne.elementfocus);break}return 0}).command("tts",(t,e)=>{const[n,i]=Ct(e,0,[Ze.STRING]),r=e.slice(i).map(Ws).join("");return JBe(je,ne.elementfocus,n,r),0}).command("tta",(t,e)=>{const n=e.map(Ws).join("");return QBe(je,ne.elementfocus,n),0}).command("bpm",(t,e)=>{const[n]=Ct(e,0,[Ze.NUMBER]);return eFe(je,ne.elementfocus,n),0}).command("vol",(t,e)=>{const[n]=Ct(e,0,[Ze.NUMBER]);return tFe(je,ne.elementfocus,n),0}).command("bgvol",(t,e)=>{const[n]=Ct(e,0,[Ze.NUMBER]);return nFe(je,ne.elementfocus,n),0}).command("ttsvol",(t,e)=>{const[n]=Ct(e,0,[Ze.NUMBER]);return iFe(je,ne.elementfocus,n),0}).command("play",(t,e)=>(Kne(ne.elementfocus,e,!1),0)).command("bgplay",(t,e)=>(Kne(ne.elementfocus,e,!0),0)).command("synth",(t,e)=>{for(let n=0;n<8;++n)Mge(ne.elementfocus,n,e);return 0}).command("echo",(t,e)=>{for(let n=0;n<3;++n)$d(ne.elementfocus,n,"echo",e);return 0}).command("fcrush",(t,e)=>{for(let n=0;n<3;++n)$d(ne.elementfocus,n,"fc",e);return 0}).command("phaser",(t,e)=>{for(let n=0;n<3;++n)$d(ne.elementfocus,n,"phaser",e);return 0}).command("reverb",(t,e)=>{for(let n=0;n<3;++n)$d(ne.elementfocus,n,"reverb",e);return 0}).command("distort",(t,e)=>{for(let n=0;n<3;++n)$d(ne.elementfocus,n,"distort",e);return 0}).command("vibrato",(t,e)=>{for(let n=0;n<3;++n)$d(ne.elementfocus,n,"vibrato",e);return 0});for(let t=0;t<8;++t)EY.command(`synth${t+1}`,(e,n)=>(Mge(ne.elementfocus,t,n),0));for(let t=0;t<3;++t){const e=t+1;EY.command(`echo${e}`,(n,i)=>($d(ne.elementfocus,t,"echo",i),0)).command(`fcrush${e}`,(n,i)=>($d(ne.elementfocus,t,"fcrush",i),0)).command(`phaser${e}`,(n,i)=>($d(ne.elementfocus,t,"phaser",i),0)).command(`reverb${e}`,(n,i)=>($d(ne.elementfocus,t,"reverb",i),0)).command(`distort${e}`,(n,i)=>($d(ne.elementfocus,t,"distort",i),0)).command(`vibrato${e}`,(n,i)=>($d(ne.elementfocus,t,"vibrato",i),0))}function Zne(t,e,n){if(!GC(ne.element))return 0;const[i,r]=Ct(e,0,[Ze.DIR,Ze.MAYBE_KIND]),s=r??["bullet"],a=A$e(ne.book,ne.board,s,{x:ne.element.x,y:ne.element.y});if(se(a)){se(n)&&(a.arg=n),a.party=ne.elementid,a.collision=vs.ISBULLET,a.destructible=1,a.stepx=i.x-ne.element.x,a.stepy=i.y-ne.element.y,a.bg=Jt.ONCLEAR;const o=Jb(ne.book,a),c=a.code??(o==null?void 0:o.code)??"";mXe(ne.book,ne.board,a,c,1)}return t.yield(),0}function _P(t,e,n,i){var h,f;if(!GC(ne.element)||!se(ne.book)||!se(ne.board)||!se(ne.element))return 0;vl(ne.book,ne.board);const[r,s]=Ct(e,0,[Ze.DIR,Ze.KIND]),a=gl(ne.board,r);if((a==null?void 0:a.category)===GT.ISOBJECT&&(a!=null&&a.pushable)){const d={x:((h=ne.element)==null?void 0:h.x)??0,y:((f=ne.element)==null?void 0:f.y)??0},p=ac(r,Fv(d,r));bY(ne.book,ne.board,a,p)}const[o]=s,c=qI(ne.book,o)??FF(ne.book,o),l=(c==null?void 0:c.collision)??vs.ISWALK;if(!yY(ne.book,ne.board,l,r)){const d=ZT(ne.book,ne.board,s,r,n);se(d)&&se(i)&&(d.arg=i)}return 0}const D$e=b0().command("board",(t,e)=>{if(!se(ne.book)||!se(ne.board))return 0;const[n,i]=Ct(e,0,[Ze.NAME]),[r,s]=Ct(e,i,[Ze.MAYBE_NUMBER,Ze.MAYBE_NUMBER]),a=sp(ne.book,Wn.BOARD,n);if(a.length){const o=Za(...a);se(o)&&Ow(ne.book,ne.elementfocus,o.id,{x:r??Math.round(fi*.5),y:s??Math.round(Fr*.5)})}return 0}).command("edge",(t,e)=>{var s,a;if(!se(ne.book)||!se(ne.board)||!se(ne.element))return 0;const[n,i]=Ct(e,0,[Ze.DIR,Ze.NAME]),r=sp(ne.book,Wn.BOARD,i);if(r.length){const o={x:((s=ne.element)==null?void 0:s.x)??0,y:((a=ne.element)==null?void 0:a.y)??0},c=Fv(o,n),l=Za(...r);switch(c){case rn.NORTH:ne.board.exitnorth=l.id;break;case rn.SOUTH:ne.board.exitsouth=l.id;break;case rn.WEST:ne.board.exitwest=l.id;break;case rn.EAST:ne.board.exiteast=l.id;break}}return 0}).command("shove",(t,e)=>{if(!se(ne.book)||!se(ne.board))return 0;vl(ne.book,ne.board);const[n,i]=Ct(e,0,[Ze.DIR,Ze.DIR]),r=gl(ne.board,n);return sh(r)&&rC(ne.book,ne.board,r,i),0}).command("duplicate",(t,e)=>{if(!se(ne.book)||!se(ne.board))return 0;vl(ne.book,ne.board);const[n,i]=Ct(e,0,[Ze.DIR,Ze.DIR]),r=gl(ne.board,n);return sh(r),0}).command("write",(t,e)=>{var l;if(!se(ne.book)||!se(ne.board))return 0;vl(ne.book,ne.board);const[n,i,r]=Ct(e,0,[Ze.DIR,Ze.COLOR,Ze.STRING]),{color:s,bg:a}=ave(i),o=((l=tk(r,256,1))==null?void 0:l.measuredwidth)??1,c=CE(256,1,s??Jt.WHITE,a??Jt.BLACK);ri(r,c,!1);for(let u=0;u<o;++u)Jf(ne.board,{x:n.x+u,y:n.y,name:"text",char:c.char[u],color:c.color[u],bg:c.bg[u]});return 0}).command("change",(t,e)=>{if(!se(ne.book)||!se(ne.board))return 0;vl(ne.book,ne.board);const[n,i]=Ct(e,0,[Ze.KIND,Ze.KIND]);(cq(n)??"")==="empty"&&f$e(ne.board).forEach(c=>{ZT(ne.book,ne.board,i,c)});const s=cq(i),a=Xme(i),o=Kme(i);return hge(ne.board,n).forEach(c=>{if(UA(c)===s)se(a)&&(c.color=a),se(o)&&(c.bg=o);else if(Wg(ne.book,ne.board,c,ne.timestamp),s!=="empty"){const l={x:c.x??0,y:c.y??0};ZT(ne.book,ne.board,i,l)}}),0}).command("put",(t,e)=>_P(t,e)).command("putwith",(t,e)=>{const[n,i]=Ct(e,0,[Ze.ANY]);return _P(t,e.slice(i),void 0,n)}).command("oneof",(t,e)=>{const[n,i]=Ct(e,0,[Ze.ANY]);return se(ne.board)&&w_(ne.board,n)?0:_P(t,e.slice(i),n)}).command("oneofwith",(t,e)=>{const[n,i,r]=Ct(e,0,[Ze.ANY,Ze.ANY]);return se(ne.board)&&w_(ne.board,i)?0:_P(t,e.slice(r),i,n)}).command("shoot",Zne).command("shootwith",(t,e)=>{const[n,i]=Ct(e,0,[Ze.ANY]);return Zne(t,e.slice(i),n)}),mm=()=>new Map,pq=t=>{const e=mm();return t.forEach((n,i)=>{e.set(i,n)}),e},wE=(t,e,n)=>{let i=t.get(e);return i===void 0&&t.set(e,i=n()),i},P$e=(t,e)=>{const n=[];for(const[i,r]of t)n.push(e(r,i));return n},L$e=(t,e)=>{for(const[n,i]of t)if(e(i,n))return!0;return!1},WC=()=>new Set,B5=t=>t[t.length-1],U$e=(t,e)=>{for(let n=0;n<e.length;n++)t.push(e[n])},JT=Array.from,B$e=(t,e)=>{for(let n=0;n<t.length;n++)if(e(t[n],n,t))return!0;return!1},mq=Array.isArray;class Oge{constructor(){this._observers=mm()}on(e,n){return wE(this._observers,e,WC).add(n),n}once(e,n){const i=(...r)=>{this.off(e,i),n(...r)};this.on(e,i)}off(e,n){const i=this._observers.get(e);i!==void 0&&(i.delete(n),i.size===0&&this._observers.delete(e))}emit(e,n){return JT((this._observers.get(e)||mm()).values()).forEach(i=>i(...n))}destroy(){this._observers=mm()}}const Qb=Math.floor,w2=Math.abs,Nge=(t,e)=>t<e?t:e,R1=(t,e)=>t>e?t:e,Ige=t=>t!==0?t<0:1/t<0,Jne=1,Qne=2,F5=4,z5=8,oN=32,u_=64,sd=128,HF=31,gq=63,CT=127,F$e=2147483647,kge=Number.MAX_SAFE_INTEGER,z$e=Number.isInteger||(t=>typeof t=="number"&&isFinite(t)&&Qb(t)===t),H$e=t=>t.toLowerCase(),j$e=/^\s*/g,V$e=t=>t.replace(j$e,""),G$e=/([A-Z])/g,eie=(t,e)=>V$e(t.replace(G$e,n=>`${e}${H$e(n)}`)),q$e=t=>{const e=unescape(encodeURIComponent(t)),n=e.length,i=new Uint8Array(n);for(let r=0;r<n;r++)i[r]=e.codePointAt(r);return i},cN=typeof TextEncoder<"u"?new TextEncoder:null,$$e=t=>cN.encode(t),W$e=cN?$$e:q$e;let XM=typeof TextDecoder>"u"?null:new TextDecoder("utf-8",{fatal:!0,ignoreBOM:!0});XM&&XM.decode(new Uint8Array).length===1&&(XM=null);class $I{constructor(){this.cpos=0,this.cbuf=new Uint8Array(100),this.bufs=[]}}const jF=()=>new $I,Y$e=t=>{let e=t.cpos;for(let n=0;n<t.bufs.length;n++)e+=t.bufs[n].length;return e},Dg=t=>{const e=new Uint8Array(Y$e(t));let n=0;for(let i=0;i<t.bufs.length;i++){const r=t.bufs[i];e.set(r,n),n+=r.length}return e.set(new Uint8Array(t.cbuf.buffer,0,t.cpos),n),e},X$e=(t,e)=>{const n=t.cbuf.length;n-t.cpos<e&&(t.bufs.push(new Uint8Array(t.cbuf.buffer,0,t.cpos)),t.cbuf=new Uint8Array(R1(n,e)*2),t.cpos=0)},al=(t,e)=>{const n=t.cbuf.length;t.cpos===n&&(t.bufs.push(t.cbuf),t.cbuf=new Uint8Array(n*2),t.cpos=0),t.cbuf[t.cpos++]=e},vq=al,Kr=(t,e)=>{for(;e>CT;)al(t,sd|CT&e),e=Qb(e/128);al(t,CT&e)},SY=(t,e)=>{const n=Ige(e);for(n&&(e=-e),al(t,(e>gq?sd:0)|(n?u_:0)|gq&e),e=Qb(e/64);e>0;)al(t,(e>CT?sd:0)|CT&e),e=Qb(e/128)},_q=new Uint8Array(3e4),K$e=_q.length/3,Z$e=(t,e)=>{if(e.length<K$e){const n=cN.encodeInto(e,_q).written||0;Kr(t,n);for(let i=0;i<n;i++)al(t,_q[i])}else Ff(t,W$e(e))},J$e=(t,e)=>{const n=unescape(encodeURIComponent(e)),i=n.length;Kr(t,i);for(let r=0;r<i;r++)al(t,n.codePointAt(r))},eC=cN&&cN.encodeInto?Z$e:J$e,VF=(t,e)=>{const n=t.cbuf.length,i=t.cpos,r=Nge(n-i,e.length),s=e.length-r;t.cbuf.set(e.subarray(0,r),i),t.cpos+=r,s>0&&(t.bufs.push(t.cbuf),t.cbuf=new Uint8Array(R1(n*2,s)),t.cbuf.set(e.subarray(r)),t.cpos=s)},Ff=(t,e)=>{Kr(t,e.byteLength),VF(t,e)},TY=(t,e)=>{X$e(t,e);const n=new DataView(t.cbuf.buffer,t.cpos,e);return t.cpos+=e,n},Q$e=(t,e)=>TY(t,4).setFloat32(0,e,!1),e7e=(t,e)=>TY(t,8).setFloat64(0,e,!1),t7e=(t,e)=>TY(t,8).setBigInt64(0,e,!1),tie=new DataView(new ArrayBuffer(4)),n7e=t=>(tie.setFloat32(0,t),tie.getFloat32(0)===t),lN=(t,e)=>{switch(typeof e){case"string":al(t,119),eC(t,e);break;case"number":z$e(e)&&w2(e)<=F$e?(al(t,125),SY(t,e)):n7e(e)?(al(t,124),Q$e(t,e)):(al(t,123),e7e(t,e));break;case"bigint":al(t,122),t7e(t,e);break;case"object":if(e===null)al(t,126);else if(mq(e)){al(t,117),Kr(t,e.length);for(let n=0;n<e.length;n++)lN(t,e[n])}else if(e instanceof Uint8Array)al(t,116),Ff(t,e);else{al(t,118);const n=Object.keys(e);Kr(t,n.length);for(let i=0;i<n.length;i++){const r=n[i];eC(t,r),lN(t,e[r])}}break;case"boolean":al(t,e?120:121);break;default:al(t,127)}};class nie extends $I{constructor(e){super(),this.w=e,this.s=null,this.count=0}write(e){this.s===e?this.count++:(this.count>0&&Kr(this,this.count-1),this.count=1,this.w(this,e),this.s=e)}}const iie=t=>{t.count>0&&(SY(t.encoder,t.count===1?t.s:-t.s),t.count>1&&Kr(t.encoder,t.count-2))};class C2{constructor(){this.encoder=new $I,this.s=0,this.count=0}write(e){this.s===e?this.count++:(iie(this),this.count=1,this.s=e)}toUint8Array(){return iie(this),Dg(this.encoder)}}const rie=t=>{if(t.count>0){const e=t.diff*2+(t.count===1?0:1);SY(t.encoder,e),t.count>1&&Kr(t.encoder,t.count-2)}};class H5{constructor(){this.encoder=new $I,this.s=0,this.count=0,this.diff=0}write(e){this.diff===e-this.s?(this.s=e,this.count++):(rie(this),this.count=1,this.diff=e-this.s,this.s=e)}toUint8Array(){return rie(this),Dg(this.encoder)}}class i7e{constructor(){this.sarr=[],this.s="",this.lensE=new C2}write(e){this.s+=e,this.s.length>19&&(this.sarr.push(this.s),this.s=""),this.lensE.write(e.length)}toUint8Array(){const e=new $I;return this.sarr.push(this.s),this.s="",eC(e,this.sarr.join("")),VF(e,this.lensE.toUint8Array()),Dg(e)}}const eE=t=>new Error(t),Yg=()=>{throw eE("Method unimplemented")},n0=()=>{throw eE("Unexpected case")},Dge=eE("Unexpected end of array"),Pge=eE("Integer out of Range");class GF{constructor(e){this.arr=e,this.pos=0}}const BA=t=>new GF(t),r7e=t=>t.pos!==t.arr.length,s7e=(t,e)=>{const n=new Uint8Array(t.arr.buffer,t.pos+t.arr.byteOffset,e);return t.pos+=e,n},zf=t=>s7e(t,Sr(t)),YC=t=>t.arr[t.pos++],Sr=t=>{let e=0,n=1;const i=t.arr.length;for(;t.pos<i;){const r=t.arr[t.pos++];if(e=e+(r&CT)*n,n*=128,r<sd)return e;if(e>kge)throw Pge}throw Dge},xY=t=>{let e=t.arr[t.pos++],n=e&gq,i=64;const r=(e&u_)>0?-1:1;if(!(e&sd))return r*n;const s=t.arr.length;for(;t.pos<s;){if(e=t.arr[t.pos++],n=n+(e&CT)*i,i*=128,e<sd)return r*n;if(n>kge)throw Pge}throw Dge},a7e=t=>{let e=Sr(t);if(e===0)return"";{let n=String.fromCodePoint(YC(t));if(--e<100)for(;e--;)n+=String.fromCodePoint(YC(t));else for(;e>0;){const i=e<1e4?e:1e4,r=t.arr.subarray(t.pos,t.pos+i);t.pos+=i,n+=String.fromCodePoint.apply(null,r),e-=i}return decodeURIComponent(escape(n))}},o7e=t=>XM.decode(zf(t)),tC=XM?o7e:a7e,wY=(t,e)=>{const n=new DataView(t.arr.buffer,t.arr.byteOffset+t.pos,e);return t.pos+=e,n},c7e=t=>wY(t,4).getFloat32(0,!1),l7e=t=>wY(t,8).getFloat64(0,!1),u7e=t=>wY(t,8).getBigInt64(0,!1),h7e=[t=>{},t=>null,xY,c7e,l7e,u7e,t=>!1,t=>!0,tC,t=>{const e=Sr(t),n={};for(let i=0;i<e;i++){const r=tC(t);n[r]=uN(t)}return n},t=>{const e=Sr(t),n=[];for(let i=0;i<e;i++)n.push(uN(t));return n},zf],uN=t=>h7e[127-YC(t)](t);class sie extends GF{constructor(e,n){super(e),this.reader=n,this.s=null,this.count=0}read(){return this.count===0&&(this.s=this.reader(this),r7e(this)?this.count=Sr(this)+1:this.count=-1),this.count--,this.s}}class A2 extends GF{constructor(e){super(e),this.s=0,this.count=0}read(){if(this.count===0){this.s=xY(this);const e=Ige(this.s);this.count=1,e&&(this.s=-this.s,this.count=Sr(this)+2)}return this.count--,this.s}}class j5 extends GF{constructor(e){super(e),this.s=0,this.count=0,this.diff=0}read(){if(this.count===0){const e=xY(this),n=e&1;this.diff=Qb(e/2),this.count=1,n&&(this.count=Sr(this)+2)}return this.s+=this.diff,this.count--,this.s}}class f7e{constructor(e){this.decoder=new A2(e),this.str=tC(this.decoder),this.spos=0}read(){const e=this.spos+this.decoder.read(),n=this.str.slice(this.spos,e);return this.spos=e,n}}const d7e=crypto.getRandomValues.bind(crypto),Lge=()=>d7e(new Uint32Array(1))[0],p7e="10000000-1000-4000-8000"+-1e11,m7e=()=>p7e.replace(/[018]/g,t=>(t^Lge()&15>>t/4).toString(16)),g7e=Date.now,aie=t=>new Promise(t);Promise.all.bind(Promise);const oie=t=>t===void 0?null:t;class v7e{constructor(){this.map=new Map}setItem(e,n){this.map.set(e,n)}getItem(e){return this.map.get(e)}}let Uge=new v7e,_7e=!0;try{typeof localStorage<"u"&&localStorage&&(Uge=localStorage,_7e=!1)}catch{}const y7e=Uge,b7e=Object.assign,E7e=Object.keys,S7e=(t,e)=>{for(const n in t)e(t[n],n)},cie=t=>E7e(t).length,T7e=t=>{for(const e in t)return!1;return!0},x7e=(t,e)=>{for(const n in t)if(!e(t[n],n))return!1;return!0},w7e=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),C7e=(t,e)=>t===e||cie(t)===cie(e)&&x7e(t,(n,i)=>(n!==void 0||w7e(e,i))&&e[i]===n),A7e=Object.freeze,Bge=t=>{for(const e in t){const n=t[e];(typeof n=="object"||typeof n=="function")&&Bge(t[e])}return A7e(t)},CY=(t,e,n=0)=>{try{for(;n<t.length;n++)t[n](...e)}finally{n<t.length&&CY(t,e,n+1)}},R7e=t=>t,M7e=(t,e)=>e.includes(t);var Fge={};const hN=typeof zn<"u"&&zn.release&&/node|io\.js/.test(zn.release.name)&&Object.prototype.toString.call(typeof zn<"u"?zn:0)==="[object process]";let hg;const O7e=()=>{if(hg===void 0)if(hN){hg=mm();const t=zn.argv;let e=null;for(let n=0;n<t.length;n++){const i=t[n];i[0]==="-"?(e!==null&&hg.set(e,""),e=i):e!==null&&(hg.set(e,i),e=null)}e!==null&&hg.set(e,"")}else typeof location=="object"?(hg=mm(),(location.search||"?").slice(1).split("&").forEach(t=>{if(t.length!==0){const[e,n]=t.split("=");hg.set(`--${eie(e,"-")}`,n),hg.set(`-${eie(e,"-")}`,n)}})):hg=mm();return hg},yq=t=>O7e().has(t),a3=t=>oie(hN?Fge[t.toUpperCase().replaceAll("-","_")]:y7e.getItem(t)),zge=t=>yq("--"+t)||a3(t)!==null;zge("production");const N7e=hN&&M7e(Fge.FORCE_COLOR,["true","1","2"]),I7e=N7e||!yq("--no-colors")&&!zge("no-color")&&(!hN||zn.stdout.isTTY)&&(!hN||yq("--color")||a3("COLORTERM")!==null||(a3("TERM")||"").includes("color")),k7e=t=>new Uint8Array(t),D7e=t=>{const e=k7e(t.byteLength);return e.set(t),e};class P7e{constructor(e,n){this.left=e,this.right=n}}const Nv=(t,e)=>new P7e(t,e);typeof DOMParser<"u"&&new DOMParser;const L7e=t=>P$e(t,(e,n)=>`${n}:${e};`).join(""),L_=Symbol,Hge=L_(),jge=L_(),U7e=L_(),B7e=L_(),F7e=L_(),Vge=L_(),z7e=L_(),AY=L_(),H7e=L_(),j7e=t=>{var r;t.length===1&&((r=t[0])==null?void 0:r.constructor)===Function&&(t=t[0]());const e=[],n=[];let i=0;for(;i<t.length;i++){const s=t[i];if(s===void 0)break;if(s.constructor===String||s.constructor===Number)e.push(s);else if(s.constructor===Object)break}for(i>0&&n.push(e.join(""));i<t.length;i++){const s=t[i];s instanceof Symbol||n.push(s)}return n},V7e={[Hge]:Nv("font-weight","bold"),[jge]:Nv("font-weight","normal"),[U7e]:Nv("color","blue"),[F7e]:Nv("color","green"),[B7e]:Nv("color","grey"),[Vge]:Nv("color","red"),[z7e]:Nv("color","purple"),[AY]:Nv("color","orange"),[H7e]:Nv("color","black")},G7e=t=>{var a;t.length===1&&((a=t[0])==null?void 0:a.constructor)===Function&&(t=t[0]());const e=[],n=[],i=mm();let r=[],s=0;for(;s<t.length;s++){const o=t[s],c=V7e[o];if(c!==void 0)i.set(c.left,c.right);else{if(o===void 0)break;if(o.constructor===String||o.constructor===Number){const l=L7e(i);s>0||l.length>0?(e.push("%c"+o),n.push(l)):e.push(o)}else break}}for(s>0&&(r=n,r.unshift(e.join("")));s<t.length;s++){const o=t[s];o instanceof Symbol||r.push(o)}return r},Gge=I7e?G7e:j7e,q7e=(...t)=>{console.log(...Gge(t)),$ge.forEach(e=>e.print(t))},qge=(...t)=>{console.warn(...Gge(t)),t.unshift(AY),$ge.forEach(e=>e.print(t))},$ge=WC(),Wge=t=>({[Symbol.iterator](){return this},next:t}),$7e=(t,e)=>Wge(()=>{let n;do n=t.next();while(!n.done&&!e(n.value));return n}),V5=(t,e)=>Wge(()=>{const{done:n,value:i}=t.next();return{done:n,value:n?void 0:e(i)}});class RY{constructor(e,n){this.clock=e,this.len=n}}class FA{constructor(){this.clients=new Map}}const XC=(t,e,n)=>e.clients.forEach((i,r)=>{const s=t.doc.store.clients.get(r);for(let a=0;a<i.length;a++){const o=i[a];n0e(t,s,o.clock,o.len,n)}}),W7e=(t,e)=>{let n=0,i=t.length-1;for(;n<=i;){const r=Qb((n+i)/2),s=t[r],a=s.clock;if(a<=e){if(e<a+s.len)return r;n=r+1}else i=r-1}return null},WI=(t,e)=>{const n=t.clients.get(e.client);return n!==void 0&&W7e(n,e.clock)!==null},MY=t=>{t.clients.forEach(e=>{e.sort((r,s)=>r.clock-s.clock);let n,i;for(n=1,i=1;n<e.length;n++){const r=e[i-1],s=e[n];r.clock+r.len>=s.clock?r.len=R1(r.len,s.clock+s.len-r.clock):(i<n&&(e[i]=s),i++)}e.length=i})},bq=t=>{const e=new FA;for(let n=0;n<t.length;n++)t[n].clients.forEach((i,r)=>{if(!e.clients.has(r)){const s=i.slice();for(let a=n+1;a<t.length;a++)U$e(s,t[a].clients.get(r)||[]);e.clients.set(r,s)}});return MY(e),e},fN=(t,e,n,i)=>{wE(t.clients,e,()=>[]).push(new RY(n,i))},Y7e=()=>new FA,X7e=t=>{const e=Y7e();return t.clients.forEach((n,i)=>{const r=[];for(let s=0;s<n.length;s++){const a=n[s];if(a.deleted){const o=a.id.clock;let c=a.length;if(s+1<n.length)for(let l=n[s+1];s+1<n.length&&l.deleted;l=n[++s+1])c+=l.length;r.push(new RY(o,c))}}r.length>0&&e.clients.set(i,r)}),e},zA=(t,e)=>{Kr(t.restEncoder,e.clients.size),JT(e.clients.entries()).sort((n,i)=>i[0]-n[0]).forEach(([n,i])=>{t.resetDsCurVal(),Kr(t.restEncoder,n);const r=i.length;Kr(t.restEncoder,r);for(let s=0;s<r;s++){const a=i[s];t.writeDsClock(a.clock),t.writeDsLen(a.len)}})},OY=t=>{const e=new FA,n=Sr(t.restDecoder);for(let i=0;i<n;i++){t.resetDsCurVal();const r=Sr(t.restDecoder),s=Sr(t.restDecoder);if(s>0){const a=wE(e.clients,r,()=>[]);for(let o=0;o<s;o++)a.push(new RY(t.readDsClock(),t.readDsLen()))}}return e},lie=(t,e,n)=>{const i=new FA,r=Sr(t.restDecoder);for(let s=0;s<r;s++){t.resetDsCurVal();const a=Sr(t.restDecoder),o=Sr(t.restDecoder),c=n.clients.get(a)||[],l=Fc(n,a);for(let u=0;u<o;u++){const h=t.readDsClock(),f=h+t.readDsLen();if(h<l){l<f&&fN(i,a,l,f-l);let d=i0(c,h),p=c[d];for(!p.deleted&&p.id.clock<h&&(c.splice(d+1,0,p3(e,p,h-p.id.clock)),d++);d<c.length&&(p=c[d++],p.id.clock<f);)p.deleted||(f<p.id.clock+p.length&&c.splice(d,0,p3(e,p,f-p.id.clock)),p.delete(e))}else fN(i,a,h,f-h)}}if(i.clients.size>0){const s=new QT;return Kr(s.restEncoder,0),zA(s,i),s.toUint8Array()}return null},Yge=Lge;class M1 extends Oge{constructor({guid:e=m7e(),collectionid:n=null,gc:i=!0,gcFilter:r=()=>!0,meta:s=null,autoLoad:a=!1,shouldLoad:o=!0}={}){super(),this.gc=i,this.gcFilter=r,this.clientID=Yge(),this.guid=e,this.collectionid=n,this.share=new Map,this.store=new e0e,this._transaction=null,this._transactionCleanups=[],this.subdocs=new Set,this._item=null,this.shouldLoad=o,this.autoLoad=a,this.meta=s,this.isLoaded=!1,this.isSynced=!1,this.isDestroyed=!1,this.whenLoaded=aie(l=>{this.on("load",()=>{this.isLoaded=!0,l(this)})});const c=()=>aie(l=>{const u=h=>{(h===void 0||h===!0)&&(this.off("sync",u),l())};this.on("sync",u)});this.on("sync",l=>{l===!1&&this.isSynced&&(this.whenSynced=c()),this.isSynced=l===void 0||l===!0,this.isSynced&&!this.isLoaded&&this.emit("load",[this])}),this.whenSynced=c()}load(){const e=this._item;e!==null&&!this.shouldLoad&&Ys(e.parent.doc,n=>{n.subdocsLoaded.add(this)},null,!0),this.shouldLoad=!0}getSubdocs(){return this.subdocs}getSubdocGuids(){return new Set(JT(this.subdocs).map(e=>e.guid))}transact(e,n=null){return Ys(this,e,n)}get(e,n=yl){const i=wE(this.share,e,()=>{const s=new n;return s._integrate(this,null),s}),r=i.constructor;if(n!==yl&&r!==n)if(r===yl){const s=new n;s._map=i._map,i._map.forEach(a=>{for(;a!==null;a=a.left)a.parent=s}),s._start=i._start;for(let a=s._start;a!==null;a=a.right)a.parent=s;return s._length=i._length,this.share.set(e,s),s._integrate(this,null),s}else throw new Error(`Type with the name ${e} has already been defined with a different constructor`);return i}getArray(e=""){return this.get(e,iC)}getText(e=""){return this.get(e,r0)}getMap(e=""){return this.get(e,ZC)}getXmlElement(e=""){return this.get(e,JC)}getXmlFragment(e=""){return this.get(e,e1)}toJSON(){const e={};return this.share.forEach((n,i)=>{e[i]=n.toJSON()}),e}destroy(){this.isDestroyed=!0,JT(this.subdocs).forEach(n=>n.destroy());const e=this._item;if(e!==null){this._item=null;const n=e.content;n.doc=new M1({guid:this.guid,...n.opts,shouldLoad:!1}),n.doc._item=e,Ys(e.parent.doc,i=>{const r=n.doc;e.deleted||i.subdocsAdded.add(r),i.subdocsRemoved.add(this)},null,!0)}this.emit("destroyed",[!0]),this.emit("destroy",[this]),super.destroy()}}class Xge{constructor(e){this.restDecoder=e}resetDsCurVal(){}readDsClock(){return Sr(this.restDecoder)}readDsLen(){return Sr(this.restDecoder)}}class Kge extends Xge{readLeftID(){return Tr(Sr(this.restDecoder),Sr(this.restDecoder))}readRightID(){return Tr(Sr(this.restDecoder),Sr(this.restDecoder))}readClient(){return Sr(this.restDecoder)}readInfo(){return YC(this.restDecoder)}readString(){return tC(this.restDecoder)}readParentInfo(){return Sr(this.restDecoder)===1}readTypeRef(){return Sr(this.restDecoder)}readLen(){return Sr(this.restDecoder)}readAny(){return uN(this.restDecoder)}readBuf(){return D7e(zf(this.restDecoder))}readJSON(){return JSON.parse(tC(this.restDecoder))}readKey(){return tC(this.restDecoder)}}class K7e{constructor(e){this.dsCurrVal=0,this.restDecoder=e}resetDsCurVal(){this.dsCurrVal=0}readDsClock(){return this.dsCurrVal+=Sr(this.restDecoder),this.dsCurrVal}readDsLen(){const e=Sr(this.restDecoder)+1;return this.dsCurrVal+=e,e}}class KC extends K7e{constructor(e){super(e),this.keys=[],Sr(e),this.keyClockDecoder=new j5(zf(e)),this.clientDecoder=new A2(zf(e)),this.leftClockDecoder=new j5(zf(e)),this.rightClockDecoder=new j5(zf(e)),this.infoDecoder=new sie(zf(e),YC),this.stringDecoder=new f7e(zf(e)),this.parentInfoDecoder=new sie(zf(e),YC),this.typeRefDecoder=new A2(zf(e)),this.lenDecoder=new A2(zf(e))}readLeftID(){return new nC(this.clientDecoder.read(),this.leftClockDecoder.read())}readRightID(){return new nC(this.clientDecoder.read(),this.rightClockDecoder.read())}readClient(){return this.clientDecoder.read()}readInfo(){return this.infoDecoder.read()}readString(){return this.stringDecoder.read()}readParentInfo(){return this.parentInfoDecoder.read()===1}readTypeRef(){return this.typeRefDecoder.read()}readLen(){return this.lenDecoder.read()}readAny(){return uN(this.restDecoder)}readBuf(){return zf(this.restDecoder)}readJSON(){return uN(this.restDecoder)}readKey(){const e=this.keyClockDecoder.read();if(e<this.keys.length)return this.keys[e];{const n=this.stringDecoder.read();return this.keys.push(n),n}}}class Z7e{constructor(){this.restEncoder=jF()}toUint8Array(){return Dg(this.restEncoder)}resetDsCurVal(){}writeDsClock(e){Kr(this.restEncoder,e)}writeDsLen(e){Kr(this.restEncoder,e)}}class YI extends Z7e{writeLeftID(e){Kr(this.restEncoder,e.client),Kr(this.restEncoder,e.clock)}writeRightID(e){Kr(this.restEncoder,e.client),Kr(this.restEncoder,e.clock)}writeClient(e){Kr(this.restEncoder,e)}writeInfo(e){vq(this.restEncoder,e)}writeString(e){eC(this.restEncoder,e)}writeParentInfo(e){Kr(this.restEncoder,e?1:0)}writeTypeRef(e){Kr(this.restEncoder,e)}writeLen(e){Kr(this.restEncoder,e)}writeAny(e){lN(this.restEncoder,e)}writeBuf(e){Ff(this.restEncoder,e)}writeJSON(e){eC(this.restEncoder,JSON.stringify(e))}writeKey(e){eC(this.restEncoder,e)}}class J7e{constructor(){this.restEncoder=jF(),this.dsCurrVal=0}toUint8Array(){return Dg(this.restEncoder)}resetDsCurVal(){this.dsCurrVal=0}writeDsClock(e){const n=e-this.dsCurrVal;this.dsCurrVal=e,Kr(this.restEncoder,n)}writeDsLen(e){e===0&&n0(),Kr(this.restEncoder,e-1),this.dsCurrVal+=e}}class QT extends J7e{constructor(){super(),this.keyMap=new Map,this.keyClock=0,this.keyClockEncoder=new H5,this.clientEncoder=new C2,this.leftClockEncoder=new H5,this.rightClockEncoder=new H5,this.infoEncoder=new nie(vq),this.stringEncoder=new i7e,this.parentInfoEncoder=new nie(vq),this.typeRefEncoder=new C2,this.lenEncoder=new C2}toUint8Array(){const e=jF();return Kr(e,0),Ff(e,this.keyClockEncoder.toUint8Array()),Ff(e,this.clientEncoder.toUint8Array()),Ff(e,this.leftClockEncoder.toUint8Array()),Ff(e,this.rightClockEncoder.toUint8Array()),Ff(e,Dg(this.infoEncoder)),Ff(e,this.stringEncoder.toUint8Array()),Ff(e,Dg(this.parentInfoEncoder)),Ff(e,this.typeRefEncoder.toUint8Array()),Ff(e,this.lenEncoder.toUint8Array()),VF(e,Dg(this.restEncoder)),Dg(e)}writeLeftID(e){this.clientEncoder.write(e.client),this.leftClockEncoder.write(e.clock)}writeRightID(e){this.clientEncoder.write(e.client),this.rightClockEncoder.write(e.clock)}writeClient(e){this.clientEncoder.write(e)}writeInfo(e){this.infoEncoder.write(e)}writeString(e){this.stringEncoder.write(e)}writeParentInfo(e){this.parentInfoEncoder.write(e?1:0)}writeTypeRef(e){this.typeRefEncoder.write(e)}writeLen(e){this.lenEncoder.write(e)}writeAny(e){lN(this.restEncoder,e)}writeBuf(e){Ff(this.restEncoder,e)}writeJSON(e){lN(this.restEncoder,e)}writeKey(e){const n=this.keyMap.get(e);n===void 0?(this.keyClockEncoder.write(this.keyClock++),this.stringEncoder.write(e)):this.keyClockEncoder.write(n)}}const Q7e=(t,e,n,i)=>{i=R1(i,e[0].id.clock);const r=i0(e,i);Kr(t.restEncoder,e.length-r),t.writeClient(n),Kr(t.restEncoder,i);const s=e[r];s.write(t,i-s.id.clock);for(let a=r+1;a<e.length;a++)e[a].write(t,0)},NY=(t,e,n)=>{const i=new Map;n.forEach((r,s)=>{Fc(e,s)>r&&i.set(s,r)}),IY(e).forEach((r,s)=>{n.has(s)||i.set(s,0)}),Kr(t.restEncoder,i.size),JT(i.entries()).sort((r,s)=>s[0]-r[0]).forEach(([r,s])=>{Q7e(t,e.clients.get(r),r,s)})},eWe=(t,e)=>{const n=mm(),i=Sr(t.restDecoder);for(let r=0;r<i;r++){const s=Sr(t.restDecoder),a=new Array(s),o=t.readClient();let c=Sr(t.restDecoder);n.set(o,{i:0,refs:a});for(let l=0;l<s;l++){const u=t.readInfo();switch(HF&u){case 0:{const h=t.readLen();a[l]=new ep(Tr(o,c),h),c+=h;break}case 10:{const h=Sr(t.restDecoder);a[l]=new tp(Tr(o,c),h),c+=h;break}default:{const h=(u&(u_|sd))===0,f=new Sa(Tr(o,c),null,(u&sd)===sd?t.readLeftID():null,null,(u&u_)===u_?t.readRightID():null,h?t.readParentInfo()?e.get(t.readString()):t.readLeftID():null,h&&(u&oN)===oN?t.readString():null,S0e(t,u));a[l]=f,c+=f.length}}}}return n},tWe=(t,e,n)=>{const i=[];let r=JT(n.keys()).sort((d,p)=>d-p);if(r.length===0)return null;const s=()=>{if(r.length===0)return null;let d=n.get(r[r.length-1]);for(;d.refs.length===d.i;)if(r.pop(),r.length>0)d=n.get(r[r.length-1]);else return null;return d};let a=s();if(a===null)return null;const o=new e0e,c=new Map,l=(d,p)=>{const g=c.get(d);(g==null||g>p)&&c.set(d,p)};let u=a.refs[a.i++];const h=new Map,f=()=>{for(const d of i){const p=d.id.client,g=n.get(p);g?(g.i--,o.clients.set(p,g.refs.slice(g.i)),n.delete(p),g.i=0,g.refs=[]):o.clients.set(p,[d]),r=r.filter(y=>y!==p)}i.length=0};for(;;){if(u.constructor!==tp){const p=wE(h,u.id.client,()=>Fc(e,u.id.client))-u.id.clock;if(p<0)i.push(u),l(u.id.client,u.id.clock-1),f();else{const g=u.getMissing(t,e);if(g!==null){i.push(u);const y=n.get(g)||{refs:[],i:0};if(y.refs.length===y.i)l(g,Fc(e,g)),f();else{u=y.refs[y.i++];continue}}else(p===0||p<u.length)&&(u.integrate(t,p),h.set(u.id.client,u.id.clock+u.length))}}if(i.length>0)u=i.pop();else if(a!==null&&a.i<a.refs.length)u=a.refs[a.i++];else{if(a=s(),a===null)break;u=a.refs[a.i++]}}if(o.clients.size>0){const d=new QT;return NY(d,o,new Map),Kr(d.restEncoder,0),{missing:c,update:d.toUint8Array()}}return null},nWe=(t,e)=>NY(t,e.doc.store,e.beforeState),iWe=(t,e,n,i=new KC(t))=>Ys(e,r=>{r.local=!1;let s=!1;const a=r.doc,o=a.store,c=eWe(i,a),l=tWe(r,o,c),u=o.pendingStructs;if(u){for(const[f,d]of u.missing)if(d<Fc(o,f)){s=!0;break}if(l){for(const[f,d]of l.missing){const p=u.missing.get(f);(p==null||p>d)&&u.missing.set(f,d)}u.update=c3([u.update,l.update])}}else o.pendingStructs=l;const h=lie(i,r,o);if(o.pendingDs){const f=new KC(BA(o.pendingDs));Sr(f.restDecoder);const d=lie(f,r,o);h&&d?o.pendingDs=c3([h,d]):o.pendingDs=h||d}else o.pendingDs=h;if(s){const f=o.pendingStructs.update;o.pendingStructs=null,Zge(r.doc,f)}},n,!1),Zge=(t,e,n,i=KC)=>{const r=BA(e);iWe(r,t,n,new i(r))},uie=(t,e,n)=>Zge(t,e,n,Kge),rWe=(t,e,n=new Map)=>{NY(t,e.store,n),zA(t,X7e(e.store))},sWe=(t,e=new Uint8Array([0]),n=new QT)=>{const i=Jge(e);rWe(n,t,i);const r=[n.toUint8Array()];if(t.store.pendingDs&&r.push(t.store.pendingDs),t.store.pendingStructs&&r.push(bWe(t.store.pendingStructs.update,e)),r.length>1){if(n.constructor===YI)return _We(r.map((s,a)=>a===0?s:SWe(s)));if(n.constructor===QT)return c3(r)}return r[0]},aWe=(t,e)=>sWe(t,e,new YI),oWe=t=>{const e=new Map,n=Sr(t.restDecoder);for(let i=0;i<n;i++){const r=Sr(t.restDecoder),s=Sr(t.restDecoder);e.set(r,s)}return e},Jge=t=>oWe(new Xge(BA(t)));class cWe{constructor(){this.l=[]}}const hie=()=>new cWe,fie=(t,e)=>t.l.push(e),die=(t,e)=>{const n=t.l,i=n.length;t.l=n.filter(r=>e!==r),i===t.l.length&&console.error("[yjs] Tried to remove event handler that doesn't exist.")},Qge=(t,e,n)=>CY(t.l,[e,n]);class nC{constructor(e,n){this.client=e,this.clock=n}}const yP=(t,e)=>t===e||t!==null&&e!==null&&t.client===e.client&&t.clock===e.clock,Tr=(t,e)=>new nC(t,e),lWe=t=>{for(const[e,n]of t.doc.share.entries())if(n===t)return e;throw n0()},o3=(t,e)=>{for(;e!==null;){if(e.parent===t)return!0;e=e.parent._item}return!1},sw=(t,e)=>e===void 0?!t.deleted:e.sv.has(t.id.client)&&(e.sv.get(t.id.client)||0)>t.id.clock&&!WI(e.ds,t.id),Eq=(t,e)=>{const n=wE(t.meta,Eq,WC),i=t.doc.store;n.has(e)||(e.sv.forEach((r,s)=>{r<Fc(i,s)&&qh(t,Tr(s,r))}),XC(t,e.ds,r=>{}),n.add(e))};class e0e{constructor(){this.clients=new Map,this.pendingStructs=null,this.pendingDs=null}}const IY=t=>{const e=new Map;return t.clients.forEach((n,i)=>{const r=n[n.length-1];e.set(i,r.id.clock+r.length)}),e},Fc=(t,e)=>{const n=t.clients.get(e);if(n===void 0)return 0;const i=n[n.length-1];return i.id.clock+i.length},t0e=(t,e)=>{let n=t.clients.get(e.id.client);if(n===void 0)n=[],t.clients.set(e.id.client,n);else{const i=n[n.length-1];if(i.id.clock+i.length!==e.id.clock)throw n0()}n.push(e)},i0=(t,e)=>{let n=0,i=t.length-1,r=t[i],s=r.id.clock;if(s===e)return i;let a=Qb(e/(s+r.length-1)*i);for(;n<=i;){if(r=t[a],s=r.id.clock,s<=e){if(e<s+r.length)return a;n=a+1}else i=a-1;a=Qb((n+i)/2)}throw n0()},uWe=(t,e)=>{const n=t.clients.get(e.client);return n[i0(n,e.clock)]},R2=uWe,Sq=(t,e,n)=>{const i=i0(e,n),r=e[i];return r.id.clock<n&&r instanceof Sa?(e.splice(i+1,0,p3(t,r,n-r.id.clock)),i+1):i},qh=(t,e)=>{const n=t.doc.store.clients.get(e.client);return n[Sq(t,n,e.clock)]},pie=(t,e,n)=>{const i=e.clients.get(n.client),r=i0(i,n.clock),s=i[r];return n.clock!==s.id.clock+s.length-1&&s.constructor!==ep&&i.splice(r+1,0,p3(t,s,n.clock-s.id.clock+1)),s},hWe=(t,e,n)=>{const i=t.clients.get(e.id.client);i[i0(i,e.id.clock)]=n},n0e=(t,e,n,i,r)=>{if(i===0)return;const s=n+i;let a=Sq(t,e,n),o;do o=e[a++],s<o.id.clock+o.length&&Sq(t,e,s),r(o);while(a<e.length&&e[a].id.clock<s)};class fWe{constructor(e,n,i){this.doc=e,this.deleteSet=new FA,this.beforeState=IY(e.store),this.afterState=new Map,this.changed=new Map,this.changedParentTypes=new Map,this._mergeStructs=[],this.origin=n,this.meta=new Map,this.local=i,this.subdocsAdded=new Set,this.subdocsRemoved=new Set,this.subdocsLoaded=new Set,this._needFormattingCleanup=!1}}const mie=(t,e)=>e.deleteSet.clients.size===0&&!L$e(e.afterState,(n,i)=>e.beforeState.get(i)!==n)?!1:(MY(e.deleteSet),nWe(t,e),zA(t,e.deleteSet),!0),gie=(t,e,n)=>{const i=e._item;(i===null||i.id.clock<(t.beforeState.get(i.id.client)||0)&&!i.deleted)&&wE(t.changed,e,WC).add(n)},M2=(t,e)=>{let n=t[e],i=t[e-1],r=e;for(;r>0;n=i,i=t[--r-1]){if(i.deleted===n.deleted&&i.constructor===n.constructor&&i.mergeWith(n)){n instanceof Sa&&n.parentSub!==null&&n.parent._map.get(n.parentSub)===n&&n.parent._map.set(n.parentSub,i);continue}break}const s=e-r;return s&&t.splice(e+1-s,s),s},dWe=(t,e,n)=>{for(const[i,r]of t.clients.entries()){const s=e.clients.get(i);for(let a=r.length-1;a>=0;a--){const o=r[a],c=o.clock+o.len;for(let l=i0(s,o.clock),u=s[l];l<s.length&&u.id.clock<c;u=s[++l]){const h=s[l];if(o.clock+o.len<=h.id.clock)break;h instanceof Sa&&h.deleted&&!h.keep&&n(h)&&h.gc(e,!1)}}}},pWe=(t,e)=>{t.clients.forEach((n,i)=>{const r=e.clients.get(i);for(let s=n.length-1;s>=0;s--){const a=n[s],o=Nge(r.length-1,1+i0(r,a.clock+a.len-1));for(let c=o,l=r[c];c>0&&l.id.clock>=a.clock;l=r[c])c-=1+M2(r,c)}})},i0e=(t,e)=>{if(e<t.length){const n=t[e],i=n.doc,r=i.store,s=n.deleteSet,a=n._mergeStructs;try{MY(s),n.afterState=IY(n.doc.store),i.emit("beforeObserverCalls",[n,i]);const o=[];n.changed.forEach((c,l)=>o.push(()=>{(l._item===null||!l._item.deleted)&&l._callObserver(n,c)})),o.push(()=>{n.changedParentTypes.forEach((c,l)=>{l._dEH.l.length>0&&(l._item===null||!l._item.deleted)&&(c=c.filter(u=>u.target._item===null||!u.target._item.deleted),c.forEach(u=>{u.currentTarget=l,u._path=null}),c.sort((u,h)=>u.path.length-h.path.length),Qge(l._dEH,c,n))})}),o.push(()=>i.emit("afterTransaction",[n,i])),CY(o,[]),n._needFormattingCleanup&&LWe(n)}finally{i.gc&&dWe(s,r,i.gcFilter),pWe(s,r),n.afterState.forEach((u,h)=>{const f=n.beforeState.get(h)||0;if(f!==u){const d=r.clients.get(h),p=R1(i0(d,f),1);for(let g=d.length-1;g>=p;)g-=1+M2(d,g)}});for(let u=a.length-1;u>=0;u--){const{client:h,clock:f}=a[u].id,d=r.clients.get(h),p=i0(d,f);p+1<d.length&&M2(d,p+1)>1||p>0&&M2(d,p)}if(!n.local&&n.afterState.get(i.clientID)!==n.beforeState.get(i.clientID)&&(q7e(AY,Hge,"[yjs] ",jge,Vge,"Changed the client-id because another client seems to be using it."),i.clientID=Yge()),i.emit("afterTransactionCleanup",[n,i]),i._observers.has("update")){const u=new YI;mie(u,n)&&i.emit("update",[u.toUint8Array(),n.origin,i,n])}if(i._observers.has("updateV2")){const u=new QT;mie(u,n)&&i.emit("updateV2",[u.toUint8Array(),n.origin,i,n])}const{subdocsAdded:o,subdocsLoaded:c,subdocsRemoved:l}=n;(o.size>0||l.size>0||c.size>0)&&(o.forEach(u=>{u.clientID=i.clientID,u.collectionid==null&&(u.collectionid=i.collectionid),i.subdocs.add(u)}),l.forEach(u=>i.subdocs.delete(u)),i.emit("subdocs",[{loaded:c,added:o,removed:l},i,n]),l.forEach(u=>u.destroy())),t.length<=e+1?(i._transactionCleanups=[],i.emit("afterAllTransactions",[i,t])):i0e(t,e+1)}}},Ys=(t,e,n=null,i=!0)=>{const r=t._transactionCleanups;let s=!1,a=null;t._transaction===null&&(s=!0,t._transaction=new fWe(t,n,i),r.push(t._transaction),r.length===1&&t.emit("beforeAllTransactions",[t]),t.emit("beforeTransaction",[t._transaction,t]));try{a=e(t._transaction)}finally{if(s){const o=t._transaction===r[0];t._transaction=null,o&&i0e(r,0)}}return a};class mWe{constructor(e,n){this.insertions=n,this.deletions=e,this.meta=new Map}}const vie=(t,e,n)=>{XC(t,n.deletions,i=>{i instanceof Sa&&e.scope.some(r=>r===t.doc||o3(r,i))&&zY(i,!1)})},_ie=(t,e,n)=>{let i=null;const r=t.doc,s=t.scope;Ys(r,o=>{for(;e.length>0&&t.currStackItem===null;){const c=r.store,l=e.pop(),u=new Set,h=[];let f=!1;XC(o,l.insertions,d=>{if(d instanceof Sa){if(d.redone!==null){let{item:p,diff:g}=l9e(c,d.id);g>0&&(p=qh(o,Tr(p.id.client,p.id.clock+g))),d=p}!d.deleted&&s.some(p=>p===o.doc||o3(p,d))&&h.push(d)}}),XC(o,l.deletions,d=>{d instanceof Sa&&s.some(p=>p===o.doc||o3(p,d))&&!WI(l.insertions,d.id)&&u.add(d)}),u.forEach(d=>{f=E0e(o,d,u,l.insertions,t.ignoreRemoteMapChanges,t)!==null||f});for(let d=h.length-1;d>=0;d--){const p=h[d];t.deleteFilter(p)&&(p.delete(o),f=!0)}t.currStackItem=f?l:null}o.changed.forEach((c,l)=>{c.has(null)&&l._searchMarker&&(l._searchMarker.length=0)}),i=o},t);const a=t.currStackItem;if(a!=null){const o=i.changedParentTypes;t.emit("stack-item-popped",[{stackItem:a,type:n,changedParentTypes:o,origin:t},t]),t.currStackItem=null}return a};class gWe extends Oge{constructor(e,{captureTimeout:n=500,captureTransaction:i=c=>!0,deleteFilter:r=()=>!0,trackedOrigins:s=new Set([null]),ignoreRemoteMapChanges:a=!1,doc:o=mq(e)?e[0].doc:e instanceof M1?e:e.doc}={}){super(),this.scope=[],this.doc=o,this.addToScope(e),this.deleteFilter=r,s.add(this),this.trackedOrigins=s,this.captureTransaction=i,this.undoStack=[],this.redoStack=[],this.undoing=!1,this.redoing=!1,this.currStackItem=null,this.lastChange=0,this.ignoreRemoteMapChanges=a,this.captureTimeout=n,this.afterTransactionHandler=c=>{if(!this.captureTransaction(c)||!this.scope.some(y=>c.changedParentTypes.has(y)||y===this.doc)||!this.trackedOrigins.has(c.origin)&&(!c.origin||!this.trackedOrigins.has(c.origin.constructor)))return;const l=this.undoing,u=this.redoing,h=l?this.redoStack:this.undoStack;l?this.stopCapturing():u||this.clear(!1,!0);const f=new FA;c.afterState.forEach((y,v)=>{const b=c.beforeState.get(v)||0,T=y-b;T>0&&fN(f,v,b,T)});const d=g7e();let p=!1;if(this.lastChange>0&&d-this.lastChange<this.captureTimeout&&h.length>0&&!l&&!u){const y=h[h.length-1];y.deletions=bq([y.deletions,c.deleteSet]),y.insertions=bq([y.insertions,f])}else h.push(new mWe(c.deleteSet,f)),p=!0;!l&&!u&&(this.lastChange=d),XC(c,c.deleteSet,y=>{y instanceof Sa&&this.scope.some(v=>v===c.doc||o3(v,y))&&zY(y,!0)});const g=[{stackItem:h[h.length-1],origin:c.origin,type:l?"redo":"undo",changedParentTypes:c.changedParentTypes},this];p?this.emit("stack-item-added",g):this.emit("stack-item-updated",g)},this.doc.on("afterTransaction",this.afterTransactionHandler),this.doc.on("destroy",()=>{this.destroy()})}addToScope(e){const n=new Set(this.scope);e=mq(e)?e:[e],e.forEach(i=>{n.has(i)||(n.add(i),(i instanceof yl?i.doc!==this.doc:i!==this.doc)&&qge("[yjs#509] Not same Y.Doc"),this.scope.push(i))})}addTrackedOrigin(e){this.trackedOrigins.add(e)}removeTrackedOrigin(e){this.trackedOrigins.delete(e)}clear(e=!0,n=!0){(e&&this.canUndo()||n&&this.canRedo())&&this.doc.transact(i=>{e&&(this.undoStack.forEach(r=>vie(i,this,r)),this.undoStack=[]),n&&(this.redoStack.forEach(r=>vie(i,this,r)),this.redoStack=[]),this.emit("stack-cleared",[{undoStackCleared:e,redoStackCleared:n}])})}stopCapturing(){this.lastChange=0}undo(){this.undoing=!0;let e;try{e=_ie(this,this.undoStack,"undo")}finally{this.undoing=!1}return e}redo(){this.redoing=!0;let e;try{e=_ie(this,this.redoStack,"redo")}finally{this.redoing=!1}return e}canUndo(){return this.undoStack.length>0}canRedo(){return this.redoStack.length>0}destroy(){this.trackedOrigins.delete(this),this.doc.off("afterTransaction",this.afterTransactionHandler),super.destroy()}}function*vWe(t){const e=Sr(t.restDecoder);for(let n=0;n<e;n++){const i=Sr(t.restDecoder),r=t.readClient();let s=Sr(t.restDecoder);for(let a=0;a<i;a++){const o=t.readInfo();if(o===10){const c=Sr(t.restDecoder);yield new tp(Tr(r,s),c),s+=c}else if(HF&o){const c=(o&(u_|sd))===0,l=new Sa(Tr(r,s),null,(o&sd)===sd?t.readLeftID():null,null,(o&u_)===u_?t.readRightID():null,c?t.readParentInfo()?t.readString():t.readLeftID():null,c&&(o&oN)===oN?t.readString():null,S0e(t,o));yield l,s+=l.length}else{const c=t.readLen();yield new ep(Tr(r,s),c),s+=c}}}}class kY{constructor(e,n){this.gen=vWe(e),this.curr=null,this.done=!1,this.filterSkips=n,this.next()}next(){do this.curr=this.gen.next().value||null;while(this.filterSkips&&this.curr!==null&&this.curr.constructor===tp);return this.curr}}class DY{constructor(e){this.currClient=0,this.startClock=0,this.written=0,this.encoder=e,this.clientStructs=[]}}const _We=t=>c3(t,Kge,YI),yWe=(t,e)=>{if(t.constructor===ep){const{client:n,clock:i}=t.id;return new ep(Tr(n,i+e),t.length-e)}else if(t.constructor===tp){const{client:n,clock:i}=t.id;return new tp(Tr(n,i+e),t.length-e)}else{const n=t,{client:i,clock:r}=n.id;return new Sa(Tr(i,r+e),null,Tr(i,r+e-1),null,n.rightOrigin,n.parent,n.parentSub,n.content.splice(e))}},c3=(t,e=KC,n=QT)=>{if(t.length===1)return t[0];const i=t.map(u=>new e(BA(u)));let r=i.map(u=>new kY(u,!0)),s=null;const a=new n,o=new DY(a);for(;r=r.filter(f=>f.curr!==null),r.sort((f,d)=>{if(f.curr.id.client===d.curr.id.client){const p=f.curr.id.clock-d.curr.id.clock;return p===0?f.curr.constructor===d.curr.constructor?0:f.curr.constructor===tp?1:-1:p}else return d.curr.id.client-f.curr.id.client}),r.length!==0;){const u=r[0],h=u.curr.id.client;if(s!==null){let f=u.curr,d=!1;for(;f!==null&&f.id.clock+f.length<=s.struct.id.clock+s.struct.length&&f.id.client>=s.struct.id.client;)f=u.next(),d=!0;if(f===null||f.id.client!==h||d&&f.id.clock>s.struct.id.clock+s.struct.length)continue;if(h!==s.struct.id.client)lb(o,s.struct,s.offset),s={struct:f,offset:0},u.next();else if(s.struct.id.clock+s.struct.length<f.id.clock)if(s.struct.constructor===tp)s.struct.length=f.id.clock+f.length-s.struct.id.clock;else{lb(o,s.struct,s.offset);const p=f.id.clock-s.struct.id.clock-s.struct.length;s={struct:new tp(Tr(h,s.struct.id.clock+s.struct.length),p),offset:0}}else{const p=s.struct.id.clock+s.struct.length-f.id.clock;p>0&&(s.struct.constructor===tp?s.struct.length-=p:f=yWe(f,p)),s.struct.mergeWith(f)||(lb(o,s.struct,s.offset),s={struct:f,offset:0},u.next())}}else s={struct:u.curr,offset:0},u.next();for(let f=u.curr;f!==null&&f.id.client===h&&f.id.clock===s.struct.id.clock+s.struct.length&&f.constructor!==tp;f=u.next())lb(o,s.struct,s.offset),s={struct:f,offset:0}}s!==null&&(lb(o,s.struct,s.offset),s=null),PY(o);const c=i.map(u=>OY(u)),l=bq(c);return zA(a,l),a.toUint8Array()},bWe=(t,e,n=KC,i=QT)=>{const r=Jge(e),s=new i,a=new DY(s),o=new n(BA(t)),c=new kY(o,!1);for(;c.curr;){const u=c.curr,h=u.id.client,f=r.get(h)||0;if(c.curr.constructor===tp){c.next();continue}if(u.id.clock+u.length>f)for(lb(a,u,R1(f-u.id.clock,0)),c.next();c.curr&&c.curr.id.client===h;)lb(a,c.curr,0),c.next();else for(;c.curr&&c.curr.id.client===h&&c.curr.id.clock+c.curr.length<=f;)c.next()}PY(a);const l=OY(o);return zA(s,l),s.toUint8Array()},r0e=t=>{t.written>0&&(t.clientStructs.push({written:t.written,restEncoder:Dg(t.encoder.restEncoder)}),t.encoder.restEncoder=jF(),t.written=0)},lb=(t,e,n)=>{t.written>0&&t.currClient!==e.id.client&&r0e(t),t.written===0&&(t.currClient=e.id.client,t.encoder.writeClient(e.id.client),Kr(t.encoder.restEncoder,e.id.clock+n)),e.write(t.encoder,n),t.written++},PY=t=>{r0e(t);const e=t.encoder.restEncoder;Kr(e,t.clientStructs.length);for(let n=0;n<t.clientStructs.length;n++){const i=t.clientStructs[n];Kr(e,i.written),VF(e,i.restEncoder)}},EWe=(t,e,n,i)=>{const r=new n(BA(t)),s=new kY(r,!1),a=new i,o=new DY(a);for(let l=s.curr;l!==null;l=s.next())lb(o,e(l),0);PY(o);const c=OY(r);return zA(a,c),a.toUint8Array()},SWe=t=>EWe(t,R7e,KC,YI),yie="You must not compute changes after the event-handler fired.";class qF{constructor(e,n){this.target=e,this.currentTarget=e,this.transaction=n,this._changes=null,this._keys=null,this._delta=null,this._path=null}get path(){return this._path||(this._path=TWe(this.currentTarget,this.target))}deletes(e){return WI(this.transaction.deleteSet,e.id)}get keys(){if(this._keys===null){if(this.transaction.doc._transactionCleanups.length===0)throw eE(yie);const e=new Map,n=this.target;this.transaction.changed.get(n).forEach(r=>{if(r!==null){const s=n._map.get(r);let a,o;if(this.adds(s)){let c=s.left;for(;c!==null&&this.adds(c);)c=c.left;if(this.deletes(s))if(c!==null&&this.deletes(c))a="delete",o=B5(c.content.getContent());else return;else c!==null&&this.deletes(c)?(a="update",o=B5(c.content.getContent())):(a="add",o=void 0)}else if(this.deletes(s))a="delete",o=B5(s.content.getContent());else return;e.set(r,{action:a,oldValue:o})}}),this._keys=e}return this._keys}get delta(){return this.changes.delta}adds(e){return e.id.clock>=(this.transaction.beforeState.get(e.id.client)||0)}get changes(){let e=this._changes;if(e===null){if(this.transaction.doc._transactionCleanups.length===0)throw eE(yie);const n=this.target,i=WC(),r=WC(),s=[];if(e={added:i,deleted:r,delta:s,keys:this.keys},this.transaction.changed.get(n).has(null)){let o=null;const c=()=>{o&&s.push(o)};for(let l=n._start;l!==null;l=l.right)l.deleted?this.deletes(l)&&!this.adds(l)&&((o===null||o.delete===void 0)&&(c(),o={delete:0}),o.delete+=l.length,r.add(l)):this.adds(l)?((o===null||o.insert===void 0)&&(c(),o={insert:[]}),o.insert=o.insert.concat(l.content.getContent()),i.add(l)):((o===null||o.retain===void 0)&&(c(),o={retain:0}),o.retain+=l.length);o!==null&&o.retain===void 0&&c()}this._changes=e}return e}}const TWe=(t,e)=>{const n=[];for(;e._item!==null&&e!==t;){if(e._item.parentSub!==null)n.unshift(e._item.parentSub);else{let i=0,r=e._item.parent._start;for(;r!==e._item&&r!==null;)!r.deleted&&r.countable&&(i+=r.length),r=r.right;n.unshift(i)}e=e._item.parent}return n},vu=()=>{qge("Invalid access: Add Yjs type to a document before reading data.")},s0e=80;let LY=0;class xWe{constructor(e,n){e.marker=!0,this.p=e,this.index=n,this.timestamp=LY++}}const wWe=t=>{t.timestamp=LY++},a0e=(t,e,n)=>{t.p.marker=!1,t.p=e,e.marker=!0,t.index=n,t.timestamp=LY++},CWe=(t,e,n)=>{if(t.length>=s0e){const i=t.reduce((r,s)=>r.timestamp<s.timestamp?r:s);return a0e(i,e,n),i}else{const i=new xWe(e,n);return t.push(i),i}},$F=(t,e)=>{if(t._start===null||e===0||t._searchMarker===null)return null;const n=t._searchMarker.length===0?null:t._searchMarker.reduce((s,a)=>w2(e-s.index)<w2(e-a.index)?s:a);let i=t._start,r=0;for(n!==null&&(i=n.p,r=n.index,wWe(n));i.right!==null&&r<e;){if(!i.deleted&&i.countable){if(e<r+i.length)break;r+=i.length}i=i.right}for(;i.left!==null&&r>e;)i=i.left,!i.deleted&&i.countable&&(r-=i.length);for(;i.left!==null&&i.left.id.client===i.id.client&&i.left.id.clock+i.left.length===i.id.clock;)i=i.left,!i.deleted&&i.countable&&(r-=i.length);return n!==null&&w2(n.index-r)<i.parent.length/s0e?(a0e(n,i,r),n):CWe(t._searchMarker,i,r)},dN=(t,e,n)=>{for(let i=t.length-1;i>=0;i--){const r=t[i];if(n>0){let s=r.p;for(s.marker=!1;s&&(s.deleted||!s.countable);)s=s.left,s&&!s.deleted&&s.countable&&(r.index-=s.length);if(s===null||s.marker===!0){t.splice(i,1);continue}r.p=s,s.marker=!0}(e<r.index||n>0&&e===r.index)&&(r.index=R1(e,r.index+n))}},WF=(t,e,n)=>{const i=t,r=e.changedParentTypes;for(;wE(r,t,()=>[]).push(n),t._item!==null;)t=t._item.parent;Qge(i._eH,n,e)};class yl{constructor(){this._item=null,this._map=new Map,this._start=null,this.doc=null,this._length=0,this._eH=hie(),this._dEH=hie(),this._searchMarker=null}get parent(){return this._item?this._item.parent:null}_integrate(e,n){this.doc=e,this._item=n}_copy(){throw Yg()}clone(){throw Yg()}_write(e){}get _first(){let e=this._start;for(;e!==null&&e.deleted;)e=e.right;return e}_callObserver(e,n){!e.local&&this._searchMarker&&(this._searchMarker.length=0)}observe(e){fie(this._eH,e)}observeDeep(e){fie(this._dEH,e)}unobserve(e){die(this._eH,e)}unobserveDeep(e){die(this._dEH,e)}toJSON(){}}const o0e=(t,e,n)=>{t.doc??vu(),e<0&&(e=t._length+e),n<0&&(n=t._length+n);let i=n-e;const r=[];let s=t._start;for(;s!==null&&i>0;){if(s.countable&&!s.deleted){const a=s.content.getContent();if(a.length<=e)e-=a.length;else{for(let o=e;o<a.length&&i>0;o++)r.push(a[o]),i--;e=0}}s=s.right}return r},c0e=t=>{t.doc??vu();const e=[];let n=t._start;for(;n!==null;){if(n.countable&&!n.deleted){const i=n.content.getContent();for(let r=0;r<i.length;r++)e.push(i[r])}n=n.right}return e},pN=(t,e)=>{let n=0,i=t._start;for(t.doc??vu();i!==null;){if(i.countable&&!i.deleted){const r=i.content.getContent();for(let s=0;s<r.length;s++)e(r[s],n++,t)}i=i.right}},l0e=(t,e)=>{const n=[];return pN(t,(i,r)=>{n.push(e(i,r,t))}),n},AWe=t=>{let e=t._start,n=null,i=0;return{[Symbol.iterator](){return this},next:()=>{if(n===null){for(;e!==null&&e.deleted;)e=e.right;if(e===null)return{done:!0,value:void 0};n=e.content.getContent(),i=0,e=e.right}const r=n[i++];return n.length<=i&&(n=null),{done:!1,value:r}}}},u0e=(t,e)=>{t.doc??vu();const n=$F(t,e);let i=t._start;for(n!==null&&(i=n.p,e-=n.index);i!==null;i=i.right)if(!i.deleted&&i.countable){if(e<i.length)return i.content.getContent()[e];e-=i.length}},l3=(t,e,n,i)=>{let r=n;const s=t.doc,a=s.clientID,o=s.store,c=n===null?e._start:n.right;let l=[];const u=()=>{l.length>0&&(r=new Sa(Tr(a,Fc(o,a)),r,r&&r.lastId,c,c&&c.id,e,null,new t1(l)),r.integrate(t,0),l=[])};i.forEach(h=>{if(h===null)l.push(h);else switch(h.constructor){case Number:case Object:case Boolean:case Array:case String:l.push(h);break;default:switch(u(),h.constructor){case Uint8Array:case ArrayBuffer:r=new Sa(Tr(a,Fc(o,a)),r,r&&r.lastId,c,c&&c.id,e,null,new XI(new Uint8Array(h))),r.integrate(t,0);break;case M1:r=new Sa(Tr(a,Fc(o,a)),r,r&&r.lastId,c,c&&c.id,e,null,new KI(h)),r.integrate(t,0);break;default:if(h instanceof yl)r=new Sa(Tr(a,Fc(o,a)),r,r&&r.lastId,c,c&&c.id,e,null,new U_(h)),r.integrate(t,0);else throw new Error("Unexpected content type in insert operation")}}}),u()},h0e=()=>eE("Length exceeded!"),f0e=(t,e,n,i)=>{if(n>e._length)throw h0e();if(n===0)return e._searchMarker&&dN(e._searchMarker,n,i.length),l3(t,e,null,i);const r=n,s=$F(e,n);let a=e._start;for(s!==null&&(a=s.p,n-=s.index,n===0&&(a=a.prev,n+=a&&a.countable&&!a.deleted?a.length:0));a!==null;a=a.right)if(!a.deleted&&a.countable){if(n<=a.length){n<a.length&&qh(t,Tr(a.id.client,a.id.clock+n));break}n-=a.length}return e._searchMarker&&dN(e._searchMarker,r,i.length),l3(t,e,a,i)},RWe=(t,e,n)=>{let r=(e._searchMarker||[]).reduce((s,a)=>a.index>s.index?a:s,{index:0,p:e._start}).p;if(r)for(;r.right;)r=r.right;return l3(t,e,r,n)},d0e=(t,e,n,i)=>{if(i===0)return;const r=n,s=i,a=$F(e,n);let o=e._start;for(a!==null&&(o=a.p,n-=a.index);o!==null&&n>0;o=o.right)!o.deleted&&o.countable&&(n<o.length&&qh(t,Tr(o.id.client,o.id.clock+n)),n-=o.length);for(;i>0&&o!==null;)o.deleted||(i<o.length&&qh(t,Tr(o.id.client,o.id.clock+i)),o.delete(t),i-=o.length),o=o.right;if(i>0)throw h0e();e._searchMarker&&dN(e._searchMarker,r,-s+i)},u3=(t,e,n)=>{const i=e._map.get(n);i!==void 0&&i.delete(t)},UY=(t,e,n,i)=>{const r=e._map.get(n)||null,s=t.doc,a=s.clientID;let o;if(i==null)o=new t1([i]);else switch(i.constructor){case Number:case Object:case Boolean:case Array:case String:o=new t1([i]);break;case Uint8Array:o=new XI(i);break;case M1:o=new KI(i);break;default:if(i instanceof yl)o=new U_(i);else throw new Error("Unexpected content type")}new Sa(Tr(a,Fc(s.store,a)),r,r&&r.lastId,null,null,e,n,o).integrate(t,0)},BY=(t,e)=>{t.doc??vu();const n=t._map.get(e);return n!==void 0&&!n.deleted?n.content.getContent()[n.length-1]:void 0},p0e=t=>{const e={};return t.doc??vu(),t._map.forEach((n,i)=>{n.deleted||(e[i]=n.content.getContent()[n.length-1])}),e},m0e=(t,e)=>{t.doc??vu();const n=t._map.get(e);return n!==void 0&&!n.deleted},MWe=(t,e)=>{const n={};return t._map.forEach((i,r)=>{let s=i;for(;s!==null&&(!e.sv.has(s.id.client)||s.id.clock>=(e.sv.get(s.id.client)||0));)s=s.left;s!==null&&sw(s,e)&&(n[r]=s.content.getContent()[s.length-1])}),n},bP=t=>(t.doc??vu(),$7e(t._map.entries(),e=>!e[1].deleted));class OWe extends qF{}class iC extends yl{constructor(){super(),this._prelimContent=[],this._searchMarker=[]}static from(e){const n=new iC;return n.push(e),n}_integrate(e,n){super._integrate(e,n),this.insert(0,this._prelimContent),this._prelimContent=null}_copy(){return new iC}clone(){const e=new iC;return e.insert(0,this.toArray().map(n=>n instanceof yl?n.clone():n)),e}get length(){return this.doc??vu(),this._length}_callObserver(e,n){super._callObserver(e,n),WF(this,e,new OWe(this,e))}insert(e,n){this.doc!==null?Ys(this.doc,i=>{f0e(i,this,e,n)}):this._prelimContent.splice(e,0,...n)}push(e){this.doc!==null?Ys(this.doc,n=>{RWe(n,this,e)}):this._prelimContent.push(...e)}unshift(e){this.insert(0,e)}delete(e,n=1){this.doc!==null?Ys(this.doc,i=>{d0e(i,this,e,n)}):this._prelimContent.splice(e,n)}get(e){return u0e(this,e)}toArray(){return c0e(this)}slice(e=0,n=this.length){return o0e(this,e,n)}toJSON(){return this.map(e=>e instanceof yl?e.toJSON():e)}map(e){return l0e(this,e)}forEach(e){pN(this,e)}[Symbol.iterator](){return AWe(this)}_write(e){e.writeTypeRef(t9e)}}const NWe=t=>new iC;class IWe extends qF{constructor(e,n,i){super(e,n),this.keysChanged=i}}class ZC extends yl{constructor(e){super(),this._prelimContent=null,e===void 0?this._prelimContent=new Map:this._prelimContent=new Map(e)}_integrate(e,n){super._integrate(e,n),this._prelimContent.forEach((i,r)=>{this.set(r,i)}),this._prelimContent=null}_copy(){return new ZC}clone(){const e=new ZC;return this.forEach((n,i)=>{e.set(i,n instanceof yl?n.clone():n)}),e}_callObserver(e,n){WF(this,e,new IWe(this,e,n))}toJSON(){this.doc??vu();const e={};return this._map.forEach((n,i)=>{if(!n.deleted){const r=n.content.getContent()[n.length-1];e[i]=r instanceof yl?r.toJSON():r}}),e}get size(){return[...bP(this)].length}keys(){return V5(bP(this),e=>e[0])}values(){return V5(bP(this),e=>e[1].content.getContent()[e[1].length-1])}entries(){return V5(bP(this),e=>[e[0],e[1].content.getContent()[e[1].length-1]])}forEach(e){this.doc??vu(),this._map.forEach((n,i)=>{n.deleted||e(n.content.getContent()[n.length-1],i,this)})}[Symbol.iterator](){return this.entries()}delete(e){this.doc!==null?Ys(this.doc,n=>{u3(n,this,e)}):this._prelimContent.delete(e)}set(e,n){return this.doc!==null?Ys(this.doc,i=>{UY(i,this,e,n)}):this._prelimContent.set(e,n),n}get(e){return BY(this,e)}has(e){return m0e(this,e)}clear(){this.doc!==null?Ys(this.doc,e=>{this.forEach(function(n,i,r){u3(e,r,i)})}):this._prelimContent.clear()}_write(e){e.writeTypeRef(n9e)}}const kWe=t=>new ZC,vb=(t,e)=>t===e||typeof t=="object"&&typeof e=="object"&&t&&e&&C7e(t,e);class Tq{constructor(e,n,i,r){this.left=e,this.right=n,this.index=i,this.currentAttributes=r}forward(){switch(this.right===null&&n0(),this.right.content.constructor){case $c:this.right.deleted||HA(this.currentAttributes,this.right.content);break;default:this.right.deleted||(this.index+=this.right.length);break}this.left=this.right,this.right=this.right.right}}const bie=(t,e,n)=>{for(;e.right!==null&&n>0;){switch(e.right.content.constructor){case $c:e.right.deleted||HA(e.currentAttributes,e.right.content);break;default:e.right.deleted||(n<e.right.length&&qh(t,Tr(e.right.id.client,e.right.id.clock+n)),e.index+=e.right.length,n-=e.right.length);break}e.left=e.right,e.right=e.right.right}return e},EP=(t,e,n,i)=>{const r=new Map,s=i?$F(e,n):null;if(s){const a=new Tq(s.p.left,s.p,s.index,r);return bie(t,a,n-s.index)}else{const a=new Tq(null,e._start,0,r);return bie(t,a,n)}},g0e=(t,e,n,i)=>{for(;n.right!==null&&(n.right.deleted===!0||n.right.content.constructor===$c&&vb(i.get(n.right.content.key),n.right.content.value));)n.right.deleted||i.delete(n.right.content.key),n.forward();const r=t.doc,s=r.clientID;i.forEach((a,o)=>{const c=n.left,l=n.right,u=new Sa(Tr(s,Fc(r.store,s)),c,c&&c.lastId,l,l&&l.id,e,null,new $c(o,a));u.integrate(t,0),n.right=u,n.forward()})},HA=(t,e)=>{const{key:n,value:i}=e;i===null?t.delete(n):t.set(n,i)},v0e=(t,e)=>{for(;t.right!==null;){if(!(t.right.deleted||t.right.content.constructor===$c&&vb(e[t.right.content.key]??null,t.right.content.value)))break;t.forward()}},_0e=(t,e,n,i)=>{const r=t.doc,s=r.clientID,a=new Map;for(const o in i){const c=i[o],l=n.currentAttributes.get(o)??null;if(!vb(l,c)){a.set(o,l);const{left:u,right:h}=n;n.right=new Sa(Tr(s,Fc(r.store,s)),u,u&&u.lastId,h,h&&h.id,e,null,new $c(o,c)),n.right.integrate(t,0),n.forward()}}return a},G5=(t,e,n,i,r)=>{n.currentAttributes.forEach((f,d)=>{r[d]===void 0&&(r[d]=null)});const s=t.doc,a=s.clientID;v0e(n,r);const o=_0e(t,e,n,r),c=i.constructor===String?new s0(i):i instanceof yl?new U_(i):new O1(i);let{left:l,right:u,index:h}=n;e._searchMarker&&dN(e._searchMarker,n.index,c.getLength()),u=new Sa(Tr(a,Fc(s.store,a)),l,l&&l.lastId,u,u&&u.id,e,null,c),u.integrate(t,0),n.right=u,n.index=h,n.forward(),g0e(t,e,n,o)},Eie=(t,e,n,i,r)=>{const s=t.doc,a=s.clientID;v0e(n,r);const o=_0e(t,e,n,r);e:for(;n.right!==null&&(i>0||o.size>0&&(n.right.deleted||n.right.content.constructor===$c));){if(!n.right.deleted)switch(n.right.content.constructor){case $c:{const{key:c,value:l}=n.right.content,u=r[c];if(u!==void 0){if(vb(u,l))o.delete(c);else{if(i===0)break e;o.set(c,l)}n.right.delete(t)}else n.currentAttributes.set(c,l);break}default:i<n.right.length&&qh(t,Tr(n.right.id.client,n.right.id.clock+i)),i-=n.right.length;break}n.forward()}if(i>0){let c="";for(;i>0;i--)c+=`
`;n.right=new Sa(Tr(a,Fc(s.store,a)),n.left,n.left&&n.left.lastId,n.right,n.right&&n.right.id,e,null,new s0(c)),n.right.integrate(t,0),n.forward()}g0e(t,e,n,o)},y0e=(t,e,n,i,r)=>{let s=e;const a=mm();for(;s&&(!s.countable||s.deleted);){if(!s.deleted&&s.content.constructor===$c){const l=s.content;a.set(l.key,l)}s=s.right}let o=0,c=!1;for(;e!==s;){if(n===e&&(c=!0),!e.deleted){const l=e.content;switch(l.constructor){case $c:{const{key:u,value:h}=l,f=i.get(u)??null;(a.get(u)!==l||f===h)&&(e.delete(t),o++,!c&&(r.get(u)??null)===h&&f!==h&&(f===null?r.delete(u):r.set(u,f))),!c&&!e.deleted&&HA(r,l);break}}}e=e.right}return o},DWe=(t,e)=>{for(;e&&e.right&&(e.right.deleted||!e.right.countable);)e=e.right;const n=new Set;for(;e&&(e.deleted||!e.countable);){if(!e.deleted&&e.content.constructor===$c){const i=e.content.key;n.has(i)?e.delete(t):n.add(i)}e=e.left}},PWe=t=>{let e=0;return Ys(t.doc,n=>{let i=t._start,r=t._start,s=mm();const a=pq(s);for(;r;){if(r.deleted===!1)switch(r.content.constructor){case $c:HA(a,r.content);break;default:e+=y0e(n,i,r,s,a),s=pq(a),i=r;break}r=r.right}}),e},LWe=t=>{const e=new Set,n=t.doc;for(const[i,r]of t.afterState.entries()){const s=t.beforeState.get(i)||0;r!==s&&n0e(t,n.store.clients.get(i),s,r,a=>{!a.deleted&&a.content.constructor===$c&&a.constructor!==ep&&e.add(a.parent)})}Ys(n,i=>{XC(t,t.deleteSet,r=>{if(r instanceof ep||!r.parent._hasFormatting||e.has(r.parent))return;const s=r.parent;r.content.constructor===$c?e.add(s):DWe(i,r)});for(const r of e)PWe(r)})},Sie=(t,e,n)=>{const i=n,r=pq(e.currentAttributes),s=e.right;for(;n>0&&e.right!==null;){if(e.right.deleted===!1)switch(e.right.content.constructor){case U_:case O1:case s0:n<e.right.length&&qh(t,Tr(e.right.id.client,e.right.id.clock+n)),n-=e.right.length,e.right.delete(t);break}e.forward()}s&&y0e(t,s,e.right,r,e.currentAttributes);const a=(e.left||e.right).parent;return a._searchMarker&&dN(a._searchMarker,e.index,-i+n),e};class UWe extends qF{constructor(e,n,i){super(e,n),this.childListChanged=!1,this.keysChanged=new Set,i.forEach(r=>{r===null?this.childListChanged=!0:this.keysChanged.add(r)})}get changes(){if(this._changes===null){const e={keys:this.keys,delta:this.delta,added:new Set,deleted:new Set};this._changes=e}return this._changes}get delta(){if(this._delta===null){const e=this.target.doc,n=[];Ys(e,i=>{const r=new Map,s=new Map;let a=this.target._start,o=null;const c={};let l="",u=0,h=0;const f=()=>{if(o!==null){let d=null;switch(o){case"delete":h>0&&(d={delete:h}),h=0;break;case"insert":(typeof l=="object"||l.length>0)&&(d={insert:l},r.size>0&&(d.attributes={},r.forEach((p,g)=>{p!==null&&(d.attributes[g]=p)}))),l="";break;case"retain":u>0&&(d={retain:u},T7e(c)||(d.attributes=b7e({},c))),u=0;break}d&&n.push(d),o=null}};for(;a!==null;){switch(a.content.constructor){case U_:case O1:this.adds(a)?this.deletes(a)||(f(),o="insert",l=a.content.getContent()[0],f()):this.deletes(a)?(o!=="delete"&&(f(),o="delete"),h+=1):a.deleted||(o!=="retain"&&(f(),o="retain"),u+=1);break;case s0:this.adds(a)?this.deletes(a)||(o!=="insert"&&(f(),o="insert"),l+=a.content.str):this.deletes(a)?(o!=="delete"&&(f(),o="delete"),h+=a.length):a.deleted||(o!=="retain"&&(f(),o="retain"),u+=a.length);break;case $c:{const{key:d,value:p}=a.content;if(this.adds(a)){if(!this.deletes(a)){const g=r.get(d)??null;vb(g,p)?p!==null&&a.delete(i):(o==="retain"&&f(),vb(p,s.get(d)??null)?delete c[d]:c[d]=p)}}else if(this.deletes(a)){s.set(d,p);const g=r.get(d)??null;vb(g,p)||(o==="retain"&&f(),c[d]=g)}else if(!a.deleted){s.set(d,p);const g=c[d];g!==void 0&&(vb(g,p)?g!==null&&a.delete(i):(o==="retain"&&f(),p===null?delete c[d]:c[d]=p))}a.deleted||(o==="insert"&&f(),HA(r,a.content));break}}a=a.right}for(f();n.length>0;){const d=n[n.length-1];if(d.retain!==void 0&&d.attributes===void 0)n.pop();else break}}),this._delta=n}return this._delta}}class r0 extends yl{constructor(e){super(),this._pending=e!==void 0?[()=>this.insert(0,e)]:[],this._searchMarker=[],this._hasFormatting=!1}get length(){return this.doc??vu(),this._length}_integrate(e,n){super._integrate(e,n);try{this._pending.forEach(i=>i())}catch(i){console.error(i)}this._pending=null}_copy(){return new r0}clone(){const e=new r0;return e.applyDelta(this.toDelta()),e}_callObserver(e,n){super._callObserver(e,n);const i=new UWe(this,e,n);WF(this,e,i),!e.local&&this._hasFormatting&&(e._needFormattingCleanup=!0)}toString(){this.doc??vu();let e="",n=this._start;for(;n!==null;)!n.deleted&&n.countable&&n.content.constructor===s0&&(e+=n.content.str),n=n.right;return e}toJSON(){return this.toString()}applyDelta(e,{sanitize:n=!0}={}){this.doc!==null?Ys(this.doc,i=>{const r=new Tq(null,this._start,0,new Map);for(let s=0;s<e.length;s++){const a=e[s];if(a.insert!==void 0){const o=!n&&typeof a.insert=="string"&&s===e.length-1&&r.right===null&&a.insert.slice(-1)===`
`?a.insert.slice(0,-1):a.insert;(typeof o!="string"||o.length>0)&&G5(i,this,r,o,a.attributes||{})}else a.retain!==void 0?Eie(i,this,r,a.retain,a.attributes||{}):a.delete!==void 0&&Sie(i,r,a.delete)}}):this._pending.push(()=>this.applyDelta(e))}toDelta(e,n,i){this.doc??vu();const r=[],s=new Map,a=this.doc;let o="",c=this._start;function l(){if(o.length>0){const h={};let f=!1;s.forEach((p,g)=>{f=!0,h[g]=p});const d={insert:o};f&&(d.attributes=h),r.push(d),o=""}}const u=()=>{for(;c!==null;){if(sw(c,e)||n!==void 0&&sw(c,n))switch(c.content.constructor){case s0:{const h=s.get("ychange");e!==void 0&&!sw(c,e)?(h===void 0||h.user!==c.id.client||h.type!=="removed")&&(l(),s.set("ychange",i?i("removed",c.id):{type:"removed"})):n!==void 0&&!sw(c,n)?(h===void 0||h.user!==c.id.client||h.type!=="added")&&(l(),s.set("ychange",i?i("added",c.id):{type:"added"})):h!==void 0&&(l(),s.delete("ychange")),o+=c.content.str;break}case U_:case O1:{l();const h={insert:c.content.getContent()[0]};if(s.size>0){const f={};h.attributes=f,s.forEach((d,p)=>{f[p]=d})}r.push(h);break}case $c:sw(c,e)&&(l(),HA(s,c.content));break}c=c.right}l()};return e||n?Ys(a,h=>{e&&Eq(h,e),n&&Eq(h,n),u()},"cleanup"):u(),r}insert(e,n,i){if(n.length<=0)return;const r=this.doc;r!==null?Ys(r,s=>{const a=EP(s,this,e,!i);i||(i={},a.currentAttributes.forEach((o,c)=>{i[c]=o})),G5(s,this,a,n,i)}):this._pending.push(()=>this.insert(e,n,i))}insertEmbed(e,n,i){const r=this.doc;r!==null?Ys(r,s=>{const a=EP(s,this,e,!i);G5(s,this,a,n,i||{})}):this._pending.push(()=>this.insertEmbed(e,n,i||{}))}delete(e,n){if(n===0)return;const i=this.doc;i!==null?Ys(i,r=>{Sie(r,EP(r,this,e,!0),n)}):this._pending.push(()=>this.delete(e,n))}format(e,n,i){if(n===0)return;const r=this.doc;r!==null?Ys(r,s=>{const a=EP(s,this,e,!1);a.right!==null&&Eie(s,this,a,n,i)}):this._pending.push(()=>this.format(e,n,i))}removeAttribute(e){this.doc!==null?Ys(this.doc,n=>{u3(n,this,e)}):this._pending.push(()=>this.removeAttribute(e))}setAttribute(e,n){this.doc!==null?Ys(this.doc,i=>{UY(i,this,e,n)}):this._pending.push(()=>this.setAttribute(e,n))}getAttribute(e){return BY(this,e)}getAttributes(){return p0e(this)}_write(e){e.writeTypeRef(i9e)}}const BWe=t=>new r0;class q5{constructor(e,n=()=>!0){this._filter=n,this._root=e,this._currentNode=e._start,this._firstCall=!0,e.doc??vu()}[Symbol.iterator](){return this}next(){let e=this._currentNode,n=e&&e.content&&e.content.type;if(e!==null&&(!this._firstCall||e.deleted||!this._filter(n)))do if(n=e.content.type,!e.deleted&&(n.constructor===JC||n.constructor===e1)&&n._start!==null)e=n._start;else for(;e!==null;){const i=e.next;if(i!==null){e=i;break}else e.parent===this._root?e=null:e=e.parent._item}while(e!==null&&(e.deleted||!this._filter(e.content.type)));return this._firstCall=!1,e===null?{value:void 0,done:!0}:(this._currentNode=e,{value:e.content.type,done:!1})}}class e1 extends yl{constructor(){super(),this._prelimContent=[]}get firstChild(){const e=this._first;return e?e.content.getContent()[0]:null}_integrate(e,n){super._integrate(e,n),this.insert(0,this._prelimContent),this._prelimContent=null}_copy(){return new e1}clone(){const e=new e1;return e.insert(0,this.toArray().map(n=>n instanceof yl?n.clone():n)),e}get length(){return this.doc??vu(),this._prelimContent===null?this._length:this._prelimContent.length}createTreeWalker(e){return new q5(this,e)}querySelector(e){e=e.toUpperCase();const i=new q5(this,r=>r.nodeName&&r.nodeName.toUpperCase()===e).next();return i.done?null:i.value}querySelectorAll(e){return e=e.toUpperCase(),JT(new q5(this,n=>n.nodeName&&n.nodeName.toUpperCase()===e))}_callObserver(e,n){WF(this,e,new HWe(this,n,e))}toString(){return l0e(this,e=>e.toString()).join("")}toJSON(){return this.toString()}toDOM(e=document,n={},i){const r=e.createDocumentFragment();return i!==void 0&&i._createAssociation(r,this),pN(this,s=>{r.insertBefore(s.toDOM(e,n,i),null)}),r}insert(e,n){this.doc!==null?Ys(this.doc,i=>{f0e(i,this,e,n)}):this._prelimContent.splice(e,0,...n)}insertAfter(e,n){if(this.doc!==null)Ys(this.doc,i=>{const r=e&&e instanceof yl?e._item:e;l3(i,this,r,n)});else{const i=this._prelimContent,r=e===null?0:i.findIndex(s=>s===e)+1;if(r===0&&e!==null)throw eE("Reference item not found");i.splice(r,0,...n)}}delete(e,n=1){this.doc!==null?Ys(this.doc,i=>{d0e(i,this,e,n)}):this._prelimContent.splice(e,n)}toArray(){return c0e(this)}push(e){this.insert(this.length,e)}unshift(e){this.insert(0,e)}get(e){return u0e(this,e)}slice(e=0,n=this.length){return o0e(this,e,n)}forEach(e){pN(this,e)}_write(e){e.writeTypeRef(s9e)}}const FWe=t=>new e1;class JC extends e1{constructor(e="UNDEFINED"){super(),this.nodeName=e,this._prelimAttrs=new Map}get nextSibling(){const e=this._item?this._item.next:null;return e?e.content.type:null}get prevSibling(){const e=this._item?this._item.prev:null;return e?e.content.type:null}_integrate(e,n){super._integrate(e,n),this._prelimAttrs.forEach((i,r)=>{this.setAttribute(r,i)}),this._prelimAttrs=null}_copy(){return new JC(this.nodeName)}clone(){const e=new JC(this.nodeName),n=this.getAttributes();return S7e(n,(i,r)=>{typeof i=="string"&&e.setAttribute(r,i)}),e.insert(0,this.toArray().map(i=>i instanceof yl?i.clone():i)),e}toString(){const e=this.getAttributes(),n=[],i=[];for(const o in e)i.push(o);i.sort();const r=i.length;for(let o=0;o<r;o++){const c=i[o];n.push(c+'="'+e[c]+'"')}const s=this.nodeName.toLocaleLowerCase(),a=n.length>0?" "+n.join(" "):"";return`<${s}${a}>${super.toString()}</${s}>`}removeAttribute(e){this.doc!==null?Ys(this.doc,n=>{u3(n,this,e)}):this._prelimAttrs.delete(e)}setAttribute(e,n){this.doc!==null?Ys(this.doc,i=>{UY(i,this,e,n)}):this._prelimAttrs.set(e,n)}getAttribute(e){return BY(this,e)}hasAttribute(e){return m0e(this,e)}getAttributes(e){return e?MWe(this,e):p0e(this)}toDOM(e=document,n={},i){const r=e.createElement(this.nodeName),s=this.getAttributes();for(const a in s){const o=s[a];typeof o=="string"&&r.setAttribute(a,o)}return pN(this,a=>{r.appendChild(a.toDOM(e,n,i))}),i!==void 0&&i._createAssociation(r,this),r}_write(e){e.writeTypeRef(r9e),e.writeKey(this.nodeName)}}const zWe=t=>new JC(t.readKey());class HWe extends qF{constructor(e,n,i){super(e,i),this.childListChanged=!1,this.attributesChanged=new Set,n.forEach(r=>{r===null?this.childListChanged=!0:this.attributesChanged.add(r)})}}class h3 extends ZC{constructor(e){super(),this.hookName=e}_copy(){return new h3(this.hookName)}clone(){const e=new h3(this.hookName);return this.forEach((n,i)=>{e.set(i,n)}),e}toDOM(e=document,n={},i){const r=n[this.hookName];let s;return r!==void 0?s=r.createDom(this):s=document.createElement(this.hookName),s.setAttribute("data-yjs-hook",this.hookName),i!==void 0&&i._createAssociation(s,this),s}_write(e){e.writeTypeRef(a9e),e.writeKey(this.hookName)}}const jWe=t=>new h3(t.readKey());class f3 extends r0{get nextSibling(){const e=this._item?this._item.next:null;return e?e.content.type:null}get prevSibling(){const e=this._item?this._item.prev:null;return e?e.content.type:null}_copy(){return new f3}clone(){const e=new f3;return e.applyDelta(this.toDelta()),e}toDOM(e=document,n,i){const r=e.createTextNode(this.toString());return i!==void 0&&i._createAssociation(r,this),r}toString(){return this.toDelta().map(e=>{const n=[];for(const r in e.attributes){const s=[];for(const a in e.attributes[r])s.push({key:a,value:e.attributes[r][a]});s.sort((a,o)=>a.key<o.key?-1:1),n.push({nodeName:r,attrs:s})}n.sort((r,s)=>r.nodeName<s.nodeName?-1:1);let i="";for(let r=0;r<n.length;r++){const s=n[r];i+=`<${s.nodeName}`;for(let a=0;a<s.attrs.length;a++){const o=s.attrs[a];i+=` ${o.key}="${o.value}"`}i+=">"}i+=e.insert;for(let r=n.length-1;r>=0;r--)i+=`</${n[r].nodeName}>`;return i}).join("")}toJSON(){return this.toString()}_write(e){e.writeTypeRef(o9e)}}const VWe=t=>new f3;class FY{constructor(e,n){this.id=e,this.length=n}get deleted(){throw Yg()}mergeWith(e){return!1}write(e,n,i){throw Yg()}integrate(e,n){throw Yg()}}const GWe=0;class ep extends FY{get deleted(){return!0}delete(){}mergeWith(e){return this.constructor!==e.constructor?!1:(this.length+=e.length,!0)}integrate(e,n){n>0&&(this.id.clock+=n,this.length-=n),t0e(e.doc.store,this)}write(e,n){e.writeInfo(GWe),e.writeLen(this.length-n)}getMissing(e,n){return null}}class XI{constructor(e){this.content=e}getLength(){return 1}getContent(){return[this.content]}isCountable(){return!0}copy(){return new XI(this.content)}splice(e){throw Yg()}mergeWith(e){return!1}integrate(e,n){}delete(e){}gc(e){}write(e,n){e.writeBuf(this.content)}getRef(){return 3}}const qWe=t=>new XI(t.readBuf());class mN{constructor(e){this.len=e}getLength(){return this.len}getContent(){return[]}isCountable(){return!1}copy(){return new mN(this.len)}splice(e){const n=new mN(this.len-e);return this.len=e,n}mergeWith(e){return this.len+=e.len,!0}integrate(e,n){fN(e.deleteSet,n.id.client,n.id.clock,this.len),n.markDeleted()}delete(e){}gc(e){}write(e,n){e.writeLen(this.len-n)}getRef(){return 1}}const $We=t=>new mN(t.readLen()),b0e=(t,e)=>new M1({guid:t,...e,shouldLoad:e.shouldLoad||e.autoLoad||!1});class KI{constructor(e){e._item&&console.error("This document was already integrated as a sub-document. You should create a second instance instead with the same guid."),this.doc=e;const n={};this.opts=n,e.gc||(n.gc=!1),e.autoLoad&&(n.autoLoad=!0),e.meta!==null&&(n.meta=e.meta)}getLength(){return 1}getContent(){return[this.doc]}isCountable(){return!0}copy(){return new KI(b0e(this.doc.guid,this.opts))}splice(e){throw Yg()}mergeWith(e){return!1}integrate(e,n){this.doc._item=n,e.subdocsAdded.add(this.doc),this.doc.shouldLoad&&e.subdocsLoaded.add(this.doc)}delete(e){e.subdocsAdded.has(this.doc)?e.subdocsAdded.delete(this.doc):e.subdocsRemoved.add(this.doc)}gc(e){}write(e,n){e.writeString(this.doc.guid),e.writeAny(this.opts)}getRef(){return 9}}const WWe=t=>new KI(b0e(t.readString(),t.readAny()));class O1{constructor(e){this.embed=e}getLength(){return 1}getContent(){return[this.embed]}isCountable(){return!0}copy(){return new O1(this.embed)}splice(e){throw Yg()}mergeWith(e){return!1}integrate(e,n){}delete(e){}gc(e){}write(e,n){e.writeJSON(this.embed)}getRef(){return 5}}const YWe=t=>new O1(t.readJSON());class $c{constructor(e,n){this.key=e,this.value=n}getLength(){return 1}getContent(){return[]}isCountable(){return!1}copy(){return new $c(this.key,this.value)}splice(e){throw Yg()}mergeWith(e){return!1}integrate(e,n){const i=n.parent;i._searchMarker=null,i._hasFormatting=!0}delete(e){}gc(e){}write(e,n){e.writeKey(this.key),e.writeJSON(this.value)}getRef(){return 6}}const XWe=t=>new $c(t.readKey(),t.readJSON());class d3{constructor(e){this.arr=e}getLength(){return this.arr.length}getContent(){return this.arr}isCountable(){return!0}copy(){return new d3(this.arr)}splice(e){const n=new d3(this.arr.slice(e));return this.arr=this.arr.slice(0,e),n}mergeWith(e){return this.arr=this.arr.concat(e.arr),!0}integrate(e,n){}delete(e){}gc(e){}write(e,n){const i=this.arr.length;e.writeLen(i-n);for(let r=n;r<i;r++){const s=this.arr[r];e.writeString(s===void 0?"undefined":JSON.stringify(s))}}getRef(){return 2}}const KWe=t=>{const e=t.readLen(),n=[];for(let i=0;i<e;i++){const r=t.readString();r==="undefined"?n.push(void 0):n.push(JSON.parse(r))}return new d3(n)},ZWe=a3("node_env")==="development";class t1{constructor(e){this.arr=e,ZWe&&Bge(e)}getLength(){return this.arr.length}getContent(){return this.arr}isCountable(){return!0}copy(){return new t1(this.arr)}splice(e){const n=new t1(this.arr.slice(e));return this.arr=this.arr.slice(0,e),n}mergeWith(e){return this.arr=this.arr.concat(e.arr),!0}integrate(e,n){}delete(e){}gc(e){}write(e,n){const i=this.arr.length;e.writeLen(i-n);for(let r=n;r<i;r++){const s=this.arr[r];e.writeAny(s)}}getRef(){return 8}}const JWe=t=>{const e=t.readLen(),n=[];for(let i=0;i<e;i++)n.push(t.readAny());return new t1(n)};class s0{constructor(e){this.str=e}getLength(){return this.str.length}getContent(){return this.str.split("")}isCountable(){return!0}copy(){return new s0(this.str)}splice(e){const n=new s0(this.str.slice(e));this.str=this.str.slice(0,e);const i=this.str.charCodeAt(e-1);return i>=55296&&i<=56319&&(this.str=this.str.slice(0,e-1)+"�",n.str="�"+n.str.slice(1)),n}mergeWith(e){return this.str+=e.str,!0}integrate(e,n){}delete(e){}gc(e){}write(e,n){e.writeString(n===0?this.str:this.str.slice(n))}getRef(){return 4}}const QWe=t=>new s0(t.readString()),e9e=[NWe,kWe,BWe,zWe,FWe,jWe,VWe],t9e=0,n9e=1,i9e=2,r9e=3,s9e=4,a9e=5,o9e=6;class U_{constructor(e){this.type=e}getLength(){return 1}getContent(){return[this.type]}isCountable(){return!0}copy(){return new U_(this.type._copy())}splice(e){throw Yg()}mergeWith(e){return!1}integrate(e,n){this.type._integrate(e.doc,n)}delete(e){let n=this.type._start;for(;n!==null;)n.deleted?n.id.clock<(e.beforeState.get(n.id.client)||0)&&e._mergeStructs.push(n):n.delete(e),n=n.right;this.type._map.forEach(i=>{i.deleted?i.id.clock<(e.beforeState.get(i.id.client)||0)&&e._mergeStructs.push(i):i.delete(e)}),e.changed.delete(this.type)}gc(e){let n=this.type._start;for(;n!==null;)n.gc(e,!0),n=n.right;this.type._start=null,this.type._map.forEach(i=>{for(;i!==null;)i.gc(e,!0),i=i.left}),this.type._map=new Map}write(e,n){this.type._write(e)}getRef(){return 7}}const c9e=t=>new U_(e9e[t.readTypeRef()](t)),l9e=(t,e)=>{let n=e,i=0,r;do i>0&&(n=Tr(n.client,n.clock+i)),r=R2(t,n),i=n.clock-r.id.clock,n=r.redone;while(n!==null&&r instanceof Sa);return{item:r,diff:i}},zY=(t,e)=>{for(;t!==null&&t.keep!==e;)t.keep=e,t=t.parent._item},p3=(t,e,n)=>{const{client:i,clock:r}=e.id,s=new Sa(Tr(i,r+n),e,Tr(i,r+n-1),e.right,e.rightOrigin,e.parent,e.parentSub,e.content.splice(n));return e.deleted&&s.markDeleted(),e.keep&&(s.keep=!0),e.redone!==null&&(s.redone=Tr(e.redone.client,e.redone.clock+n)),e.right=s,s.right!==null&&(s.right.left=s),t._mergeStructs.push(s),s.parentSub!==null&&s.right===null&&s.parent._map.set(s.parentSub,s),e.length=n,s},Tie=(t,e)=>B$e(t,n=>WI(n.deletions,e)),E0e=(t,e,n,i,r,s)=>{const a=t.doc,o=a.store,c=a.clientID,l=e.redone;if(l!==null)return qh(t,l);let u=e.parent._item,h=null,f;if(u!==null&&u.deleted===!0){if(u.redone===null&&(!n.has(u)||E0e(t,u,n,i,r,s)===null))return null;for(;u.redone!==null;)u=qh(t,u.redone)}const d=u===null?e.parent:u.content.type;if(e.parentSub===null){for(h=e.left,f=e;h!==null;){let v=h;for(;v!==null&&v.parent._item!==u;)v=v.redone===null?null:qh(t,v.redone);if(v!==null&&v.parent._item===u){h=v;break}h=h.left}for(;f!==null;){let v=f;for(;v!==null&&v.parent._item!==u;)v=v.redone===null?null:qh(t,v.redone);if(v!==null&&v.parent._item===u){f=v;break}f=f.right}}else if(f=null,e.right&&!r){for(h=e;h!==null&&h.right!==null&&(h.right.redone||WI(i,h.right.id)||Tie(s.undoStack,h.right.id)||Tie(s.redoStack,h.right.id));)for(h=h.right;h.redone;)h=qh(t,h.redone);if(h&&h.right!==null)return null}else h=d._map.get(e.parentSub)||null;const p=Fc(o,c),g=Tr(c,p),y=new Sa(g,h,h&&h.lastId,f,f&&f.id,d,e.parentSub,e.content.copy());return e.redone=g,zY(y,!0),y.integrate(t,0),y};class Sa extends FY{constructor(e,n,i,r,s,a,o,c){super(e,c.getLength()),this.origin=i,this.left=n,this.right=r,this.rightOrigin=s,this.parent=a,this.parentSub=o,this.redone=null,this.content=c,this.info=this.content.isCountable()?Qne:0}set marker(e){(this.info&z5)>0!==e&&(this.info^=z5)}get marker(){return(this.info&z5)>0}get keep(){return(this.info&Jne)>0}set keep(e){this.keep!==e&&(this.info^=Jne)}get countable(){return(this.info&Qne)>0}get deleted(){return(this.info&F5)>0}set deleted(e){this.deleted!==e&&(this.info^=F5)}markDeleted(){this.info|=F5}getMissing(e,n){if(this.origin&&this.origin.client!==this.id.client&&this.origin.clock>=Fc(n,this.origin.client))return this.origin.client;if(this.rightOrigin&&this.rightOrigin.client!==this.id.client&&this.rightOrigin.clock>=Fc(n,this.rightOrigin.client))return this.rightOrigin.client;if(this.parent&&this.parent.constructor===nC&&this.id.client!==this.parent.client&&this.parent.clock>=Fc(n,this.parent.client))return this.parent.client;if(this.origin&&(this.left=pie(e,n,this.origin),this.origin=this.left.lastId),this.rightOrigin&&(this.right=qh(e,this.rightOrigin),this.rightOrigin=this.right.id),this.left&&this.left.constructor===ep||this.right&&this.right.constructor===ep)this.parent=null;else if(!this.parent)this.left&&this.left.constructor===Sa?(this.parent=this.left.parent,this.parentSub=this.left.parentSub):this.right&&this.right.constructor===Sa&&(this.parent=this.right.parent,this.parentSub=this.right.parentSub);else if(this.parent.constructor===nC){const i=R2(n,this.parent);i.constructor===ep?this.parent=null:this.parent=i.content.type}return null}integrate(e,n){if(n>0&&(this.id.clock+=n,this.left=pie(e,e.doc.store,Tr(this.id.client,this.id.clock-1)),this.origin=this.left.lastId,this.content=this.content.splice(n),this.length-=n),this.parent){if(!this.left&&(!this.right||this.right.left!==null)||this.left&&this.left.right!==this.right){let i=this.left,r;if(i!==null)r=i.right;else if(this.parentSub!==null)for(r=this.parent._map.get(this.parentSub)||null;r!==null&&r.left!==null;)r=r.left;else r=this.parent._start;const s=new Set,a=new Set;for(;r!==null&&r!==this.right;){if(a.add(r),s.add(r),yP(this.origin,r.origin)){if(r.id.client<this.id.client)i=r,s.clear();else if(yP(this.rightOrigin,r.rightOrigin))break}else if(r.origin!==null&&a.has(R2(e.doc.store,r.origin)))s.has(R2(e.doc.store,r.origin))||(i=r,s.clear());else break;r=r.right}this.left=i}if(this.left!==null){const i=this.left.right;this.right=i,this.left.right=this}else{let i;if(this.parentSub!==null)for(i=this.parent._map.get(this.parentSub)||null;i!==null&&i.left!==null;)i=i.left;else i=this.parent._start,this.parent._start=this;this.right=i}this.right!==null?this.right.left=this:this.parentSub!==null&&(this.parent._map.set(this.parentSub,this),this.left!==null&&this.left.delete(e)),this.parentSub===null&&this.countable&&!this.deleted&&(this.parent._length+=this.length),t0e(e.doc.store,this),this.content.integrate(e,this),gie(e,this.parent,this.parentSub),(this.parent._item!==null&&this.parent._item.deleted||this.parentSub!==null&&this.right!==null)&&this.delete(e)}else new ep(this.id,this.length).integrate(e,0)}get next(){let e=this.right;for(;e!==null&&e.deleted;)e=e.right;return e}get prev(){let e=this.left;for(;e!==null&&e.deleted;)e=e.left;return e}get lastId(){return this.length===1?this.id:Tr(this.id.client,this.id.clock+this.length-1)}mergeWith(e){if(this.constructor===e.constructor&&yP(e.origin,this.lastId)&&this.right===e&&yP(this.rightOrigin,e.rightOrigin)&&this.id.client===e.id.client&&this.id.clock+this.length===e.id.clock&&this.deleted===e.deleted&&this.redone===null&&e.redone===null&&this.content.constructor===e.content.constructor&&this.content.mergeWith(e.content)){const n=this.parent._searchMarker;return n&&n.forEach(i=>{i.p===e&&(i.p=this,!this.deleted&&this.countable&&(i.index-=this.length))}),e.keep&&(this.keep=!0),this.right=e.right,this.right!==null&&(this.right.left=this),this.length+=e.length,!0}return!1}delete(e){if(!this.deleted){const n=this.parent;this.countable&&this.parentSub===null&&(n._length-=this.length),this.markDeleted(),fN(e.deleteSet,this.id.client,this.id.clock,this.length),gie(e,n,this.parentSub),this.content.delete(e)}}gc(e,n){if(!this.deleted)throw n0();this.content.gc(e),n?hWe(e,this,new ep(this.id,this.length)):this.content=new mN(this.length)}write(e,n){const i=n>0?Tr(this.id.client,this.id.clock+n-1):this.origin,r=this.rightOrigin,s=this.parentSub,a=this.content.getRef()&HF|(i===null?0:sd)|(r===null?0:u_)|(s===null?0:oN);if(e.writeInfo(a),i!==null&&e.writeLeftID(i),r!==null&&e.writeRightID(r),i===null&&r===null){const o=this.parent;if(o._item!==void 0){const c=o._item;if(c===null){const l=lWe(o);e.writeParentInfo(!0),e.writeString(l)}else e.writeParentInfo(!1),e.writeLeftID(c.id)}else o.constructor===String?(e.writeParentInfo(!0),e.writeString(o)):o.constructor===nC?(e.writeParentInfo(!1),e.writeLeftID(o)):n0();s!==null&&e.writeString(s)}this.content.write(e,n)}}const S0e=(t,e)=>u9e[e&HF](t),u9e=[()=>{n0()},$We,KWe,qWe,QWe,YWe,XWe,c9e,JWe,WWe,()=>{n0()}],h9e=10;class tp extends FY{get deleted(){return!0}delete(){}mergeWith(e){return this.constructor!==e.constructor?!1:(this.length+=e.length,!0)}integrate(e,n){n0()}write(e,n){e.writeInfo(h9e),Kr(e.restEncoder,this.length-n)}getMissing(e,n){return null}}const T0e=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof um<"u"?um:{},x0e="__ $YJS$ __";T0e[x0e]===!0&&console.error("Yjs was already imported. This breaks constructor checks and will lead to issues! - https://github.com/yjs/yjs/issues/438");T0e[x0e]=!0;let xie=!1;const $h=new M1;function w0e(t){const e=$h.getMap(),[,n]=Fe.useState(0);if(Fe.useEffect(()=>{function i(){n(r=>1-r)}return e.observe(i),()=>{e.unobserve(i)}},[e,n]),e.has(t))return e.get(t)}function ZI(t){const e=w0e(t);if(pn(e))return e}function C0e(t){const e=w0e(t);if(!(!se(e)||!(e instanceof r0)))return e}function A0e(t,e,n){const i=$h.getMap();if(!i.has(t))switch(e){case 0:case 1:i.set(t,n);break}}function f9e(t,e){A0e(t,0,e)}function R0e(t,e){const n=new r0(e);A0e(t,1,n)}function pl(t,e){$h.getMap().set(t,e)}function d9e(t,e){const n=$h.getMap(),i=new r0(e);n.set(t,i)}function M0e(t,e){const n=$h.getMap();function i(r){const s=n.get(t);for(let a=0;a<r.length;++a)(r[a].target===n||r[a].target===s)&&e(s)}return n.has(t)&&e(n.get(t)),n.observeDeep(i),()=>{n.observeDeep(i)}}function p9e(t,e){return M0e(t,n=>{pn(n)&&e(n)})}function m9e(t,e){return M0e(t,n=>{n instanceof r0&&e(n.toJSON())})}const WS=yE("modem",["second"],t=>{if(WS.session(t))switch(t.target){case"second":!xie&&t.data%2===0&&WS.emit(t.player,"modem:join");break;case"join":t.sender!==WS.id()&&WS.reply(t,"joinack",wpe(aWe($h)));break;case"joinack":t.sender!==WS.id()&&(xie=!0,uie($h,JO(t.data),$h));break;case"sync":{t.sender!==WS.id()&&se(t.data)&&uie($h,JO(t.data),$h);break}}});function O0e(t,e){e!==$h&&WS.emit("","modem:sync",wpe(t))}$h.on("update",O0e);$h.on("destroy",()=>{$h.off("update",O0e)});function g9e(t,e,n,i){const r=t.slice(0,e),s=t.slice(e+n);return`${r}${i??""}${s}`}function HY(t){const[e,n]=t.split(":"),i=se(n);return[i?e:"self",i?n:t]}const tE=navigator.userAgent.includes("Mac"),Uf=tE?"cmd":"ctrl";function Vx(){AFe(je,KM())}const v9e=b0().command("send",(t,e)=>{const[n,i]=Ct(e,0,[Ze.NAME,Ze.ANY]);switch(si(n)){case"helpmenu":Gd(je,ne.elementfocus,"H E L P"),Ci(je,ne.elementfocus,""),cr(je,ne.elementfocus,"#help controls","zss controls and inputs"),Ci(je,ne.elementfocus,"!helpcontrols;read help controls"),Ci(je,ne.elementfocus,""),cr(je,ne.elementfocus,"#help text","text formatting"),Ci(je,ne.elementfocus,"!helptext;read help text"),Ci(je,ne.elementfocus,""),cr(je,ne.elementfocus,"#help developer","developer commands"),Ci(je,ne.elementfocus,"!helpdeveloper;read help developer"),Ci(je,ne.elementfocus,""),cr(je,ne.elementfocus,"#help player","player settings"),Ci(je,ne.elementfocus,"!helpplayer;read help player"),Ov(je,ne.elementfocus,"keyboard input"),cr(je,ne.elementfocus,"?","open console"),cr(je,ne.elementfocus,"esc","close console"),cr(je,ne.elementfocus,"tab","move console"),cr(je,ne.elementfocus,"up / down arrow keys","navigate console items"),cr(je,ne.elementfocus,"left / right arrow keys","change console items"),cr(je,ne.elementfocus,"enter","interact with console items"),cr(je,ne.elementfocus,"alt + arrow keys","skip words and console lines"),cr(je,ne.elementfocus,`${Uf} + up / down arrow keys`,"input history");break;case"helpcontrols":Gd(je,ne.elementfocus,"zss controls and inputs"),Ov(je,ne.elementfocus,"keyboard input"),cr(je,ne.elementfocus,"arrow keys","move"),cr(je,ne.elementfocus,"shift + arrow keys","shoot"),cr(je,ne.elementfocus,"enter","ok / accept"),cr(je,ne.elementfocus,"escape","cancel / close"),cr(je,ne.elementfocus,"tab","menu / action"),Ov(je,ne.elementfocus,"controller input"),cr(je,ne.elementfocus,"left stick","move"),cr(je,ne.elementfocus,"right stick","aim"),cr(je,ne.elementfocus,"a","ok / accept"),cr(je,ne.elementfocus,"b","cancel / close"),cr(je,ne.elementfocus,"y","menu / action"),cr(je,ne.elementfocus,"x","shoot"),cr(je,ne.elementfocus,"triggers","shoot");break;case"helptext":break;case"helpdeveloper":Gd(je,ne.elementfocus,"developer commands"),cr(je,ne.elementfocus,"#books","list books in memory"),cr(je,ne.elementfocus,"#pages","list pages in opened book"),cr(je,ne.elementfocus,"@[pagetype:]page name","create & edit a new codepage in the currently opened book"),cr(je,ne.elementfocus,"#trash","list books and pages from open book you can delete"),cr(je,ne.elementfocus,"#save","flush state to register"),cr(je,ne.elementfocus,"#share","creates a click to copy share url and QR code");break;case"helpplayer":Gd(je,ne.elementfocus,"player settings"),po(je,ne.elementfocus,"todo");break;default:{const[r,s]=HY(n);rve(r==="self"&&ne.elementisplayer?`${ne.elementfocus}:${s}`:n,i);break}}return 0}).command("stat",(t,e)=>{let n;const[i,...r]=e.map(Ws),s=r.join(" ");switch(si(i)){case Wf(cn.LOADER):n=Hy(Rc.CONTENT,s,Wn.LOADER);break;default:n=Hy(Rc.CONTENT,[i,...r].join(" "),Wn.OBJECT);break;case Wf(cn.BOARD):n=Hy(Rc.CONTENT,s,Wn.BOARD);break;case Wf(cn.OBJECT):n=Hy(Rc.CONTENT,s,Wn.OBJECT);break;case Wf(cn.TERRAIN):n=Hy(Rc.CONTENT,s,Wn.TERRAIN);break;case Wf(cn.CHARSET):n=Hy(Rc.CONTENT,s,Wn.CHARSET);break;case Wf(cn.PALETTE):n=Hy(Rc.CONTENT,s,Wn.PALETTE);break}return se(n)&&t.command("pageopen",n.id),0}).command("text",(t,e)=>{const n=e.map(Ws).join(" ");return se(ne.element)&&(ne.element.tickertext=n,ne.element.tickertime=ne.timestamp),0}).command("hyperlink",(t,e)=>{const[n,...i]=e,r=Ws(n),s=i.map(Ws).join(" ");return e0(je,ne.elementfocus,`!${s};${r}`),0}).command("bookcreate",(t,e)=>{const[n]=Ct(e,0,[Ze.MAYBE_NAME]),i=nve(n);return se(i)&&t.command("bookopen",i.id),0}).command("bookopen",(t,e)=>{const[n]=Ct(e,0,[Ze.NAME]),i=Wv(n);return se(i)?(po(je,ne.elementfocus,`opened [book] ${i.name}`),Oq(Rc.MAIN,i.id),t.command("pages")):Ui(je,ne.elementfocus,"bookopen",`book ${n} not found`),0}).command("booktrash",(t,e)=>{const[n]=Ct(e,0,[Ze.NAME]),i=Iw(Rc.MAIN),r=Wv(n);return se(r)&&(i===r&&Oq(Rc.MAIN,""),pXe(n),po(je,ne.elementfocus,`trashed [book] ${r.name}`),Vx(),t.command("pages")),0}).command("boardopen",(t,e)=>{const[n]=Ct(e,0,[Ze.NAME]),i=sp(ne.book,Wn.BOARD,n);if(i.length){const r=Za(...i);se(r)&&Ow(ne.book,ne.elementfocus,r.id,{x:Zd(0,fi-1),y:Zd(0,Fr-1)})}return 0}).command("pageopenwith",(t,e)=>{const[n,i,r]=Ct(e,0,[Ze.NAME,Ze.MAYBE_NAME,Ze.MAYBE_NAME]);return t.command("pageopen",i,r,n)}).command("pageopen",(t,e)=>{const[n,i,r]=Ct(e,0,[Ze.NAME,Ze.MAYBE_NAME,Ze.MAYBE_NAME]),s=i_(Rc.MAIN);if(!se(s))return 0;const a=wT(s,n);if(se(a)){const o=Qu(a),c=IS(a);po(je,ne.elementfocus,`opened [${c}] ${o}`);const l=[],u=wT(s,r??""),h=se(u)?_Y(u.code):void 0;if(se(h))for(let p=0;p<h.tokens.length;++p){const g=h.tokens[p];g.tokenType===UF&&l.push(g.image.startsWith('"')?g.image.slice(1):g.image)}const f=[a.id,i];R0e(npe(s.id,f),a.code);const d=IS(a);cFe(je,ne.elementfocus,s.id,f,d,`${o} - ${s.name}`,l)}else Ui(je,"pageopen",`page ${n} not found`,ne.elementfocus);return 0}).command("pagetrash",(t,e)=>{const[n]=Ct(e,0,[Ze.NAME]),i=i_(Rc.MAIN),r=xge(i,n);if(se(n)){const s=Qu(r),a=IS(r);po(je,ne.elementfocus,`trashed [${a}] ${s}`),Vx(),t.command("pages")}return 0}).command("help",(t,e)=>{const n=e.map(Ws).join(" ")||"menu";return t.command(`help${n}`),0}).command("books",()=>{Ov(je,ne.elementfocus,"books");const t=Iw(Rc.MAIN);cr(je,ne.elementfocus,"main",`${(t==null?void 0:t.name)??"empty"} $GREEN${(t==null?void 0:t.id)??""}`);const e=Iw(Rc.CONTENT);cr(je,ne.elementfocus,"content",`${(e==null?void 0:e.name)??"empty"} ${(e==null?void 0:e.id)??""}`),o9(je,ne.elementfocus,7);const n=k2();return n.length?n.forEach(i=>{Ci(je,ne.elementfocus,`!bookopen ${i.id};${i.name}`)}):po(je,ne.elementfocus,"no books found"),Ci(je,ne.elementfocus,"!bookcreate;create a new book"),0}).command("pages",()=>{const t=i_(Rc.MAIN);return se(t)&&(Ov(je,ne.elementfocus,"pages"),cr(je,ne.elementfocus,"main",`${t.name} $GREEN${t.id}`),t.pages.length?L5(t).forEach(n=>{const i=Qu(n),r=IS(n);Ci(je,ne.elementfocus,`!pageopen ${n.id};$blue[${r}]$white ${i}`)}):(Ci(je,ne.elementfocus,""),po(je,ne.elementfocus,"$white no pages found"),po(je,ne.elementfocus,"$white use @ to create a page"),po(je,ne.elementfocus,"$white @board name of board"),po(je,ne.elementfocus,"$white @object name of object"),po(je,ne.elementfocus,"$white @terrain name of terrain"),po(je,ne.elementfocus,"$white You can omit the type and it will default to object"),po(je,ne.elementfocus,"$white @object name of object"),po(je,ne.elementfocus,"$white @name of object"))),0}).command("boards",()=>{Ov(je,ne.elementfocus,"boards");const t=i_(Rc.MAIN);if(se(t)){cr(je,ne.elementfocus,"main",`${t.name} $GREEN${t.id}`);const e=L5(t);e.filter(n=>KT(n)===Wn.BOARD).forEach(n=>{const i=Qu(n),r=IS(n);Ci(je,ne.elementfocus,`!boardopen ${n.id};$blue[${r}]$white ${i}`)}),e.length===0&&(Ci(je,ne.elementfocus,""),po(je,ne.elementfocus,"$white no boards found"),po(je,ne.elementfocus,"$white use @ to create a board"),po(je,ne.elementfocus,"$white @board name of board"))}return 0}).command("trash",()=>{Ov(je,ne.elementfocus,"$REDTRASH"),po(je,ne.elementfocus,"books");const t=k2();t.length&&(t.forEach(n=>{Ci(je,ne.elementfocus,`!booktrash ${n.id};$REDTRASH ${n.name}`)}),Ci(je,ne.elementfocus,""));const e=Iw(Rc.MAIN);return se(e)&&(po(je,ne.elementfocus,`pages in open ${e.name} book`),e.pages.forEach(n=>{const i=Qu(n);Ci(je,ne.elementfocus,`!pagetrash ${n.id};$REDTRASH ${i}`)}),Ci(je,ne.elementfocus,"")),0}).command("dev",()=>(Vx(),YBe(je,ne.elementfocus),0)).command("share",()=>(Vx(),XBe(je,ne.elementfocus),0)).command("save",()=>(Vx(),0)).command("fork",()=>(RFe(je,ne.elementfocus),0)).command("nuke",()=>(KBe(je,ne.elementfocus),0)).command("restart",()=>(wFe(je,ne.elementfocus),Vx(),0)).command("export",()=>{Gd(je,ne.elementfocus,"E X P O R T"),Ov(je,ne.elementfocus,"books");const t=k2();return t.length&&t.forEach(e=>Ci(je,ne.elementfocus,`!bookexport ${e.id};${e.name}`)),0}).command("bookexport",(t,e)=>{const[n]=Ct(e,0,[Ze.NAME]),i=Wv(n);return se(i)&&(Gd(je,ne.elementfocus,"E X P O R T"),Ov(je,ne.elementfocus,"pages"),setTimeout(()=>{if(i.pages.length){const r=L5(i);Ci(je,ne.elementfocus,`!bookallexport ${n};$blue[all]$white export book`),r.forEach(s=>{const a=Qu(s),o=IS(s);Ci(je,ne.elementfocus,`!pageexport ${n}:${s.id};$blue[${o}]$white ${a}`)})}},1e3)),0}).command("bookallexport",(t,e)=>{const[n]=Ct(e,0,[Ze.NAME]),i=Wv(n);return se(i)&&fte(je,ne.elementfocus,fl(i),`${i.name}.book.json`),0}).command("pageexport",(t,e)=>{const[n]=Ct(e,0,[Ze.NAME]),{target:i,path:r}=S1(n),s=Wv(i),a=wT(s,r);return se(a)&&fte(je,ne.elementfocus,fl(a),`${Qu(a)}.${IS(a)}.json`),0}).command("gadget",()=>(rFe(je,ne.elementfocus),0)).command("joincode",(t,e)=>{const[n]=Ct(e,0,[Ze.MAYBE_NAME]);return jBe(je,ne.elementfocus,!!n),0}).command("jointab",(t,e)=>{const[n]=Ct(e,0,[Ze.MAYBE_NAME]);return VBe(je,ne.elementfocus,!!n),0}),_9e=b0().command("toast",(t,e)=>{const n=e.map(Ws).join("");return NBe(je,ne.elementfocus,n),0}).command("palette",(t,e)=>{const[n]=Ct(e,0,[Ze.NAME]),i=Vie(),r=lh(ne.book,Wn.PALETTE,n);return se(r)?(i.palette=r.id,Ci(je,ne.elementfocus,`loaded palette ${n}`)):Ui(je,ne.elementfocus,"not-found",`unabled to find palette ${n}`),0}).command("charset",(t,e)=>{const[n]=Ct(e,0,[Ze.NAME]),i=Vie(),r=lh(ne.book,Wn.CHARSET,n);return se(r)?(i.charset=r.id,Ci(je,ne.elementfocus,`loaded charset ${n}`)):Ui(je,ne.elementfocus,"not-found",`unabled to find charset ${n}`),0}),N0e={isterrain:"ISTERRAIN",isobject:"ISOBJECT"};function gN(t){return Li(t)&&I0e(t[0])}function I0e(t){return se(GT[t])&&On(t)}function k0e(t){if(On(t))return N0e[si(t)]}function wie(t){if(gN(t))return t;if(I0e(t))return[t];const e=k0e(t);if(se(e))return[e]}function y9e(t){const e=ne.words[t],n=wie(e);if(gN(n))return[n,t+1];const[i,r]=Hh(t),s=wie(i);return gN(s)?[s,r]:[void 0,t]}const D0e={issolid:"ISSOLID",iswalk:"ISWALK",isswim:"ISSWIM",isbullet:"ISBULLET",iswalking:"ISWALK",iswalkable:"ISWALK",isswimming:"ISSWIM",isswimmable:"ISSWIM"};vs.ISSOLID,vs.ISWALK,vs.ISSWIM,vs.ISBULLET,vs.ISWALK,vs.ISSWIM;function m3(t){return Li(t)&&xq(t[0])}function xq(t){return se(vs[t])&&On(t)}function b9e(t){if(On(t))return D0e[si(t)]}function E9e(t){const e=ne.words[t];if(m3(e))return[e,t+1];if(xq(e))return[[e],t+1];const[n,i]=Hh(t);return m3(n)?[n,i]:xq(n)?[[n],i]:[void 0,t]}const S9e=new Set(["inputmove","inputalt","inputctrl","inputshift","inputok","inputcancel","inputmenu"]),Cie=new Set(["group","party","player","pushable","collision","destructible","p1","p2","p3","cycle","stepx","stepy","light","sender","arg"]),T9e=["NORTH","SOUTH","WEST","EAST"];function x9e(t){const e=vN(t);if(pn(e.inputcurrent)||(e.inputcurrent=0),Li(e.inputqueue)||(e.inputqueue=[]),e.inputcurrent>0)return e;const[n]=e.inputqueue,[i=tn.NONE,r=0]=n??[tn.NONE,0];switch(e.inputmove=[],e.inputok=0,e.inputcancel=0,e.inputmenu=0,e.inputalt=r&Epe?1:0,e.inputctrl=r&Spe?1:0,e.inputshift=r&Tpe?1:0,i){case tn.MOVE_UP:case tn.MOVE_DOWN:case tn.MOVE_LEFT:case tn.MOVE_RIGHT:e.inputmove=[T9e[i-tn.MOVE_UP]];break;case tn.OK_BUTTON:e.inputok=1;break;case tn.CANCEL_BUTTON:e.inputcancel=1;break;case tn.MENU_BUTTON:e.inputmenu=1;break}return e.inputcurrent=i,e.inputqueue=e.inputqueue.filter(s=>{const[a]=s;return a!==tn.NONE&&a!==i}),e}function w9e(t){const e=N0e[t];if(se(e))return e;const n=D0e[t];if(se(n))return n;const i=XF[t];if(se(i))return i;const r=$me[t];if(se(r))return r}const C9e=b0({get(t,e){var a,o,c,l,u,h,f,d,p,g,y,v,b,T,x,M,R,I,k,P,U;const n=w9e(e);if(se(n))return[!0,n];if(ne.elementisplayer&&S9e.has(e)){const G=x9e(ne.elementid)[e];return[se(G),G]}const i=aN(ne.board,{x:((a=ne.element)==null?void 0:a.x)??-1,y:((o=ne.element)==null?void 0:o.y)??-1},ne.elementfocus),r=(i==null?void 0:i.id)??ne.elementfocus??KM();switch(e){case"isdark":return[!0,(c=ne.board)!=null&&c.isdark?1:0];case"startx":return[!0,((l=ne.board)==null?void 0:l.startx)??0];case"starty":return[!0,((u=ne.board)==null?void 0:u.starty)??0];case"over":return[!0,((h=ne.board)==null?void 0:h.over)??""];case"under":return[!0,((f=ne.board)==null?void 0:f.under)??""];case"camera":return[!0,((d=ne.board)==null?void 0:d.camera)??""];case"graphics":return[!0,((p=ne.board)==null?void 0:p.graphics)??""];case"facing":break;case"exitnorth":return[!0,((g=ne.board)==null?void 0:g.exitnorth)??""];case"exitsouth":return[!0,((y=ne.board)==null?void 0:y.exitsouth)??""];case"exitwest":return[!0,((v=ne.board)==null?void 0:v.exitwest)??""];case"exiteast":return[!0,((b=ne.board)==null?void 0:b.exiteast)??""];case"timelimit":return[!0,((T=ne.board)==null?void 0:T.timelimit)??0];case"restartonzap":return[!0,((x=ne.board)==null?void 0:x.restartonzap)??0];case"maxplayershots":return[!0,((M=ne.board)==null?void 0:M.maxplayershots)??0];case"boardid":return[!0,((R=ne.board)==null?void 0:R.id)??"ERR"];case"playerx":return[!0,(i==null?void 0:i.x)??-1];case"playery":return[!0,(i==null?void 0:i.y)??-1];case"thisid":return[!0,((I=ne.element)==null?void 0:I.id)??""];case"thisx":return[!0,((k=ne.element)==null?void 0:k.x)??-1];case"thisy":return[!0,((P=ne.element)==null?void 0:P.y)??-1];default:{const G=(U=ne.element)==null?void 0:U[e];if(Cie.has(e))return[!0,G];break}}const s=vN(r)[e];return[se(s),s]},set(t,e,n){var a,o;const i=aN(ne.board,{x:((a=ne.element)==null?void 0:a.x)??-1,y:((o=ne.element)==null?void 0:o.y)??-1},ne.elementfocus),r=(i==null?void 0:i.id)??ne.elementfocus;switch(e){case"isdark":if(se(ne.board))return ne.board.isdark=n?1:0,[!0,ne.board.isdark];break;case"startx":if(se(ne.board))return ne.board.startx=hT(n,0),[!0,ne.board.startx];break;case"starty":if(se(ne.board))return ne.board.starty=hT(n,0),[!0,ne.board.starty];break;case"over":if(se(ne.board))return ne.board.over=pn(n)?n:Ws(n),[!0,ne.board.over];break;case"under":if(se(ne.board))return ne.board.under=pn(n)?n:Ws(n),[!0,ne.board.under];break;case"camera":if(se(ne.board))return[!0,ne.board.camera=Ws(n)];break;case"graphics":if(se(ne.board))return[!0,ne.board.graphics=Ws(n)];break;case"facing":break;case"exitnorth":if(se(ne.board))return ne.board.exitnorth=Ws(n),[!0,ne.board.exitnorth];break;case"exitsouth":if(se(ne.board))return ne.board.exitsouth=Ws(n),[!0,ne.board.exitsouth];break;case"exitwest":if(se(ne.board))return ne.board.exitwest=Ws(n),[!0,ne.board.exitwest];break;case"exiteast":if(se(ne.board))return ne.board.exiteast=Ws(n),[!0,ne.board.exiteast];break;case"timelimit":if(se(ne.board))return ne.board.timelimit=hT(n,0),[!0,ne.board.timelimit];break;case"restartonzap":if(se(ne.board))return ne.board.restartonzap=n?1:0,[!0,ne.board.restartonzap];break;case"maxplayershots":if(se(ne.board))return ne.board.maxplayershots=hT(n,0),[!0,ne.board.maxplayershots];break;case"boardid":return[!1,n];case"playerx":return[!1,n];case"playery":return[!1,n];case"thisid":return[!1,n];case"thisx":return[!1,n];case"thisy":return[!1,n];default:{if(Cie.has(e))return se(ne.element)&&(ne.element[e]=n),[!0,n];break}}const s=vN(r);return se(s)?(s[e]=n,[!0,n]):[!1,n]},everytick(){var t,e,n,i,r;if(!((t=ne.element)!=null&&t.removed)&&(se((e=ne.element)==null?void 0:e.stepx)||se((n=ne.element)==null?void 0:n.stepy))){const s={x:((i=ne.element)==null?void 0:i.x)??0,y:((r=ne.element)==null?void 0:r.y)??0};rC(ne.book,ne.board,ne.element,{x:s.x+(ne.element.stepx??0),y:s.y+(ne.element.stepy??0)})===!1&&(ne.element.stepx=0,ne.element.stepy=0,lu(ne.book,ne.element,"destructible")&&Wg(ne.book,ne.board,ne.element,ne.timestamp))}}}).command("clear",(t,e)=>(e.forEach(n=>t.set(Ws(n),0)),0)).command("set",(t,e)=>{const[n,i]=Ct(e,0,[Ze.NAME,Ze.ANY]);return t.set(n,i),0}).command("become",(t,e)=>{var i,r;const[n]=Ct(e,0,[Ze.KIND]);if(vl(ne.book,ne.board),Cge(ne.book,ne.board,ne.element),Wg(ne.book,ne.board,ne.element,ne.timestamp)){const s={x:((i=ne.element)==null?void 0:i.x)??0,y:((r=ne.element)==null?void 0:r.y)??0};ZT(ne.book,ne.board,n,s)}return t.endofprogram(),0}).command("bind",()=>0).command("char",(t,e)=>{const[n]=Ct(e,0,[Ze.ANY]);if(x_(n)){const[i,r]=Ct(e,0,[Ze.DIR,Ze.NUMBER]),s=gl(ne.board,i);se(s)&&(s.char=r)}else se(ne.element)&&pn(n)&&(ne.element.char=n);return 0}).command("color",(t,e)=>{const[n]=Ct(e,0,[Ze.ANY]);if(x_(n)){const[i,r]=Ct(e,0,[Ze.DIR,Ze.COLOR]),s=gl(ne.board,i);se(s)&&rN(ne.element,r)}else{const[i]=Ct(e,0,[Ze.COLOR]);se(ne.element)&&se(i)&&rN(ne.element,i)}return 0}).command("go",(t,e)=>{if(se(ne.element)){const[n]=Ct(e,0,[Ze.DIR]);if(rC(ne.book,ne.board,ne.element,n),t.yield(),ne.element.x===n.x&&ne.element.y===n.y)return 0}return 1}).command("walk",(t,e)=>{if(!se(ne.element))return 0;const[n]=Ct(e,0,[Ze.DIR]),i=ne.element.x??0,r=ne.element.y??0;return ne.element.stepx=n.x-i,ne.element.stepy=n.y-r,0}),A9e=b0().command("idle",t=>(t.yield(),0)).command("end",t=>(t.endofprogram(),0)).command("endwith",(t,e)=>{const[n]=Ct(e,0,[Ze.ANY]);return t.set("arg",n),t.command("end")}).command("lock",t=>(t.lock(t.id()),0)).command("restore",(t,e)=>(t.restore(Ws(e[0])),0)).command("unlock",t=>(t.unlock(),0)).command("zap",(t,e)=>(t.zap(Ws(e[0])),0)).command("cycle",(t,e)=>{if(se(ne.element)){const[n]=Ct(e,0,[Ze.NUMBER]);ne.element.cycle=lr(Math.round(n),1,255)}return 0}).command("die",t=>(Wg(ne.book,ne.board,ne.element,ne.timestamp),t.endofprogram(),0)).command("endgame",()=>(gFe(je,ne.elementfocus),0)).command("run",(t,e)=>{const[n]=Ct(e,0,[Ze.NAME]);return y3(n),0}).command("runwith",(t,e)=>{const[n,i]=Ct(e,0,[Ze.ANY,Ze.NAME]);return t.set("arg",n),y3(i),0}),P0e={};function R9e(t){var e;return(e=P0e[t])==null?void 0:e.format}function _b(t){var e;return(e=P0e[t])==null?void 0:e.content}function Aie(t,e){if(!se(t))return;const n=si(e),i=n.endsWith("le");switch(n){case"float32":case"float32le":{const r=t.dataview.getFloat32(t.cursor,i);return t.cursor+=4,r}case"float64":case"float64le":{const r=t.dataview.getFloat64(t.cursor,i);return t.cursor+=8,r}case"int8":case"int8le":{const r=t.dataview.getInt8(t.cursor);return t.cursor+=1,r}case"int16":case"int16le":{const r=t.dataview.getInt16(t.cursor,i);return t.cursor+=2,r}case"int32":case"int32le":{const r=t.dataview.getInt32(t.cursor,i);return t.cursor+=4,r}case"int64":case"int64le":{const r=t.dataview.getBigInt64(t.cursor,i);return t.cursor+=8,r}case"uint8":case"uint8le":{const r=t.dataview.getUint8(t.cursor);return t.cursor+=1,r}case"uint16":case"uint16le":{const r=t.dataview.getUint16(t.cursor,i);return t.cursor+=2,r}case"uint32":case"uint32le":{const r=t.dataview.getUint32(t.cursor,i);return t.cursor+=4,r}case"uint64":case"uint64le":{const r=t.dataview.getBigUint64(t.cursor,i);return t.cursor+=8,r}}}const M9e=(t,e)=>{const n=_b(t.id());if(!se(n))return 0;const[i,r]=Ct(e,0,[Ze.NAME]),s=si(i);switch(s){case"seek":{const[a]=Ct(e,r,[Ze.NUMBER]);n.cursor=a;break}case"float32":case"float32le":case"float64":case"float64le":case"int8":case"int8le":case"int16":case"int16le":case"int32":case"int32le":case"int64":case"int64le":case"uint8":case"uint8le":case"uint16":case"uint16le":case"uint32":case"uint32le":case"uint64":case"uint64le":{const[a]=Ct(e,r,[Ze.NAME]);t.set(a,Aie(n,s));break}case"text":{const[a,o]=Ct(e,r,[Ze.NAME,Ze.NAME]),c=Aie(n,a);if(pn(c)&&On(o)){const l=new Uint8Array(n.bytes.buffer,n.cursor,c),h=new TextDecoder("utf-8").decode(l);t.set(o,h),n.cursor+=c}break}case"palette":{const[a]=Ct(e,r,[Ze.NAME]),o=dq(ne.book,Wn.PALETTE,a),c=qc(o);if(se(c)){const l=h9*Xb,u=T1(new Uint8Array(n.bytes.buffer,n.cursor,l));se(u)&&(c.bits=u.bits),n.cursor+=l}break}case"charset":{const[a]=Ct(e,r,[Ze.NAME]),o=dq(ne.book,Wn.CHARSET,a),c=qc(o);if(se(c)){const l=Kh*ZO*$G,u=DA(new Uint8Array(n.bytes.buffer,n.cursor,l));se(u)&&(c.bits=u.bits),n.cursor+=l}break}}return 0},QC=t=>t!==null&&Object.prototype.toString.call(t)==="[object Object]",g3=(t,e)=>{if(t===e)return!0;if(typeof t!=typeof e)return!1;if(Array.isArray(t)&&Array.isArray(e)){if(t.length!==e.length)return!1;for(let n=0;n<t.length;n+=1)if(!g3(t[n],e[n]))return!1;return!0}if(QC(t)&&QC(e)){const n=Object.entries(t),i=new Set(Object.keys(e));if(n.length!==i.size)return!1;for(const[r,s]of n){if(!g3(s,e[r]))return!1;i.delete(r)}return i.size===0}return!1},SP=t=>{if(t===""||t===!1||t===null||t===void 0||Array.isArray(t)&&t.length===0)return!0;if(QC(t)){for(const e in t)if(t.hasOwnProperty(e))return!1;return!0}return!1},O9e=t=>t>="a"&&t<="z"||t>="A"&&t<="Z"||t==="_",Rie=t=>t>="0"&&t<="9"||t==="-",N9e=t=>t>="a"&&t<="z"||t>="A"&&t<="Z"||t>="0"&&t<="9"||t==="_";var pt;(function(t){t.TOK_EOF="EOF",t.TOK_UNQUOTEDIDENTIFIER="UnquotedIdentifier",t.TOK_QUOTEDIDENTIFIER="QuotedIdentifier",t.TOK_RBRACKET="Rbracket",t.TOK_RPAREN="Rparen",t.TOK_COMMA="Comma",t.TOK_COLON="Colon",t.TOK_RBRACE="Rbrace",t.TOK_NUMBER="Number",t.TOK_CURRENT="Current",t.TOK_ROOT="Root",t.TOK_EXPREF="Expref",t.TOK_PIPE="Pipe",t.TOK_OR="Or",t.TOK_AND="And",t.TOK_EQ="EQ",t.TOK_GT="GT",t.TOK_LT="LT",t.TOK_GTE="GTE",t.TOK_LTE="LTE",t.TOK_NE="NE",t.TOK_FLATTEN="Flatten",t.TOK_STAR="Star",t.TOK_FILTER="Filter",t.TOK_DOT="Dot",t.TOK_NOT="Not",t.TOK_LBRACE="Lbrace",t.TOK_LBRACKET="Lbracket",t.TOK_LPAREN="Lparen",t.TOK_LITERAL="Literal"})(pt||(pt={}));const Mie={"(":pt.TOK_LPAREN,")":pt.TOK_RPAREN,"*":pt.TOK_STAR,",":pt.TOK_COMMA,".":pt.TOK_DOT,":":pt.TOK_COLON,"@":pt.TOK_CURRENT,$:pt.TOK_ROOT,"]":pt.TOK_RBRACKET,"{":pt.TOK_LBRACE,"}":pt.TOK_RBRACE},I9e={"!":!0,"<":!0,"=":!0,">":!0},k9e={"	":!0,"\n":!0,"\r":!0," ":!0};class D9e{constructor(){this._current=0}tokenize(e){const n=[];this._current=0;let i,r,s;for(;this._current<e.length;)if(O9e(e[this._current]))i=this._current,r=this.consumeUnquotedIdentifier(e),n.push({start:i,type:pt.TOK_UNQUOTEDIDENTIFIER,value:r});else if(Mie[e[this._current]]!==void 0)n.push({start:this._current,type:Mie[e[this._current]],value:e[this._current]}),this._current+=1;else if(Rie(e[this._current]))s=this.consumeNumber(e),n.push(s);else if(e[this._current]==="[")s=this.consumeLBracket(e),n.push(s);else if(e[this._current]==='"')i=this._current,r=this.consumeQuotedIdentifier(e),n.push({start:i,type:pt.TOK_QUOTEDIDENTIFIER,value:r});else if(e[this._current]==="'")i=this._current,r=this.consumeRawStringLiteral(e),n.push({start:i,type:pt.TOK_LITERAL,value:r});else if(e[this._current]==="`"){i=this._current;const a=this.consumeLiteral(e);n.push({start:i,type:pt.TOK_LITERAL,value:a})}else if(I9e[e[this._current]]!==void 0)s=this.consumeOperator(e),s&&n.push(s);else if(k9e[e[this._current]]!==void 0)this._current+=1;else if(e[this._current]==="&")i=this._current,this._current+=1,e[this._current]==="&"?(this._current+=1,n.push({start:i,type:pt.TOK_AND,value:"&&"})):n.push({start:i,type:pt.TOK_EXPREF,value:"&"});else if(e[this._current]==="|")i=this._current,this._current+=1,e[this._current]==="|"?(this._current+=1,n.push({start:i,type:pt.TOK_OR,value:"||"})):n.push({start:i,type:pt.TOK_PIPE,value:"|"});else{const a=new Error(`Unknown character: ${e[this._current]}`);throw a.name="LexerError",a}return n}consumeUnquotedIdentifier(e){const n=this._current;for(this._current+=1;this._current<e.length&&N9e(e[this._current]);)this._current+=1;return e.slice(n,this._current)}consumeQuotedIdentifier(e){const n=this._current;this._current+=1;const i=e.length;for(;e[this._current]!=='"'&&this._current<i;){let r=this._current;e[r]==="\\"&&(e[r+1]==="\\"||e[r+1]==='"')?r+=2:r+=1,this._current=r}return this._current+=1,JSON.parse(e.slice(n,this._current))}consumeRawStringLiteral(e){const n=this._current;this._current+=1;const i=e.length;for(;e[this._current]!=="'"&&this._current<i;){let s=this._current;e[s]==="\\"&&(e[s+1]==="\\"||e[s+1]==="'")?s+=2:s+=1,this._current=s}return this._current+=1,e.slice(n+1,this._current-1).replace("\\'","'")}consumeNumber(e){const n=this._current;this._current+=1;const i=e.length;for(;Rie(e[this._current])&&this._current<i;)this._current+=1;const r=parseInt(e.slice(n,this._current),10);return{start:n,value:r,type:pt.TOK_NUMBER}}consumeLBracket(e){const n=this._current;return this._current+=1,e[this._current]==="?"?(this._current+=1,{start:n,type:pt.TOK_FILTER,value:"[?"}):e[this._current]==="]"?(this._current+=1,{start:n,type:pt.TOK_FLATTEN,value:"[]"}):{start:n,type:pt.TOK_LBRACKET,value:"["}}consumeOperator(e){const n=this._current,i=e[n];if(this._current+=1,i==="!")return e[this._current]==="="?(this._current+=1,{start:n,type:pt.TOK_NE,value:"!="}):{start:n,type:pt.TOK_NOT,value:"!"};if(i==="<")return e[this._current]==="="?(this._current+=1,{start:n,type:pt.TOK_LTE,value:"<="}):{start:n,type:pt.TOK_LT,value:"<"};if(i===">")return e[this._current]==="="?(this._current+=1,{start:n,type:pt.TOK_GTE,value:">="}):{start:n,type:pt.TOK_GT,value:">"};if(i==="="&&e[this._current]==="=")return this._current+=1,{start:n,type:pt.TOK_EQ,value:"=="}}consumeLiteral(e){this._current+=1;const n=this._current,i=e.length;for(;e[this._current]!=="`"&&this._current<i;){let a=this._current;e[a]==="\\"&&(e[a+1]==="\\"||e[a+1]==="`")?a+=2:a+=1,this._current=a}let r=e.slice(n,this._current).trimLeft();r=r.replace("\\`","`");const s=this.looksLikeJSON(r)?JSON.parse(r):JSON.parse(`"${r}"`);return this._current+=1,s}looksLikeJSON(e){const n='[{"',i=["true","false","null"],r="-0123456789";if(e==="")return!1;if(n.includes(e[0])||i.includes(e))return!0;if(r.includes(e[0]))try{return JSON.parse(e),!0}catch{return!1}return!1}}const P9e=new D9e,ru={[pt.TOK_EOF]:0,[pt.TOK_UNQUOTEDIDENTIFIER]:0,[pt.TOK_QUOTEDIDENTIFIER]:0,[pt.TOK_RBRACKET]:0,[pt.TOK_RPAREN]:0,[pt.TOK_COMMA]:0,[pt.TOK_RBRACE]:0,[pt.TOK_NUMBER]:0,[pt.TOK_CURRENT]:0,[pt.TOK_EXPREF]:0,[pt.TOK_ROOT]:0,[pt.TOK_PIPE]:1,[pt.TOK_OR]:2,[pt.TOK_AND]:3,[pt.TOK_EQ]:5,[pt.TOK_GT]:5,[pt.TOK_LT]:5,[pt.TOK_GTE]:5,[pt.TOK_LTE]:5,[pt.TOK_NE]:5,[pt.TOK_FLATTEN]:9,[pt.TOK_STAR]:20,[pt.TOK_FILTER]:21,[pt.TOK_DOT]:40,[pt.TOK_NOT]:45,[pt.TOK_LBRACE]:50,[pt.TOK_LBRACKET]:55,[pt.TOK_LPAREN]:60};class L9e{constructor(){this.index=0,this.tokens=[]}parse(e){this.loadTokens(e),this.index=0;const n=this.expression(0);if(this.lookahead(0)!==pt.TOK_EOF){const i=this.lookaheadToken(0);this.errorToken(i,`Unexpected token type: ${i.type}, value: ${i.value}`)}return n}loadTokens(e){this.tokens=[...P9e.tokenize(e),{type:pt.TOK_EOF,value:"",start:e.length}]}expression(e){const n=this.lookaheadToken(0);this.advance();let i=this.nud(n),r=this.lookahead(0);for(;e<ru[r];)this.advance(),i=this.led(r,i),r=this.lookahead(0);return i}lookahead(e){return this.tokens[this.index+e].type}lookaheadToken(e){return this.tokens[this.index+e]}advance(){this.index+=1}nud(e){let n,i,r;switch(e.type){case pt.TOK_LITERAL:return{type:"Literal",value:e.value};case pt.TOK_UNQUOTEDIDENTIFIER:return{type:"Field",name:e.value};case pt.TOK_QUOTEDIDENTIFIER:const s={type:"Field",name:e.value};if(this.lookahead(0)===pt.TOK_LPAREN)throw new Error("Quoted identifier not allowed for function names.");return s;case pt.TOK_NOT:return i=this.expression(ru.Not),{type:"NotExpression",children:[i]};case pt.TOK_STAR:return n={type:"Identity"},i=this.lookahead(0)===pt.TOK_RBRACKET&&{type:"Identity"}||this.parseProjectionRHS(ru.Star),{type:"ValueProjection",children:[n,i]};case pt.TOK_FILTER:return this.led(e.type,{type:"Identity"});case pt.TOK_LBRACE:return this.parseMultiselectHash();case pt.TOK_FLATTEN:return n={type:pt.TOK_FLATTEN,children:[{type:"Identity"}]},i=this.parseProjectionRHS(ru.Flatten),{type:"Projection",children:[n,i]};case pt.TOK_LBRACKET:return this.lookahead(0)===pt.TOK_NUMBER||this.lookahead(0)===pt.TOK_COLON?(i=this.parseIndexExpression(),this.projectIfSlice({type:"Identity"},i)):this.lookahead(0)===pt.TOK_STAR&&this.lookahead(1)===pt.TOK_RBRACKET?(this.advance(),this.advance(),i=this.parseProjectionRHS(ru.Star),{children:[{type:"Identity"},i],type:"Projection"}):this.parseMultiselectList();case pt.TOK_CURRENT:return{type:pt.TOK_CURRENT};case pt.TOK_ROOT:return{type:pt.TOK_ROOT};case pt.TOK_EXPREF:return r=this.expression(ru.Expref),{type:"ExpressionReference",children:[r]};case pt.TOK_LPAREN:const a=[];for(;this.lookahead(0)!==pt.TOK_RPAREN;)this.lookahead(0)===pt.TOK_CURRENT?(r={type:pt.TOK_CURRENT},this.advance()):r=this.expression(0),a.push(r);return this.match(pt.TOK_RPAREN),a[0];default:this.errorToken(e)}}led(e,n){let i;switch(e){case pt.TOK_DOT:const r=ru.Dot;return this.lookahead(0)!==pt.TOK_STAR?(i=this.parseDotRHS(r),{type:"Subexpression",children:[n,i]}):(this.advance(),i=this.parseProjectionRHS(r),{type:"ValueProjection",children:[n,i]});case pt.TOK_PIPE:return i=this.expression(ru.Pipe),{type:pt.TOK_PIPE,children:[n,i]};case pt.TOK_OR:return i=this.expression(ru.Or),{type:"OrExpression",children:[n,i]};case pt.TOK_AND:return i=this.expression(ru.And),{type:"AndExpression",children:[n,i]};case pt.TOK_LPAREN:const s=n.name,a=[];let o;for(;this.lookahead(0)!==pt.TOK_RPAREN;)this.lookahead(0)===pt.TOK_CURRENT?(o={type:pt.TOK_CURRENT},this.advance()):o=this.expression(0),this.lookahead(0)===pt.TOK_COMMA&&this.match(pt.TOK_COMMA),a.push(o);return this.match(pt.TOK_RPAREN),{name:s,type:"Function",children:a};case pt.TOK_FILTER:const l=this.expression(0);return this.match(pt.TOK_RBRACKET),i=this.lookahead(0)===pt.TOK_FLATTEN&&{type:"Identity"}||this.parseProjectionRHS(ru.Filter),{type:"FilterProjection",children:[n,i,l]};case pt.TOK_FLATTEN:const u={type:pt.TOK_FLATTEN,children:[n]},h=this.parseProjectionRHS(ru.Flatten);return{type:"Projection",children:[u,h]};case pt.TOK_EQ:case pt.TOK_NE:case pt.TOK_GT:case pt.TOK_GTE:case pt.TOK_LT:case pt.TOK_LTE:return this.parseComparator(n,e);case pt.TOK_LBRACKET:const f=this.lookaheadToken(0);return f.type===pt.TOK_NUMBER||f.type===pt.TOK_COLON?(i=this.parseIndexExpression(),this.projectIfSlice(n,i)):(this.match(pt.TOK_STAR),this.match(pt.TOK_RBRACKET),i=this.parseProjectionRHS(ru.Star),{type:"Projection",children:[n,i]});default:return this.errorToken(this.lookaheadToken(0))}}match(e){if(this.lookahead(0)===e){this.advance();return}else{const n=this.lookaheadToken(0);this.errorToken(n,`Expected ${e}, got: ${n.type}`)}}errorToken(e,n=""){const i=new Error(n||`Invalid token (${e.type}): "${e.value}"`);throw i.name="ParserError",i}parseIndexExpression(){if(this.lookahead(0)===pt.TOK_COLON||this.lookahead(1)===pt.TOK_COLON)return this.parseSliceExpression();const e={type:"Index",value:this.lookaheadToken(0).value};return this.advance(),this.match(pt.TOK_RBRACKET),e}projectIfSlice(e,n){const i={type:"IndexExpression",children:[e,n]};return n.type==="Slice"?{children:[i,this.parseProjectionRHS(ru.Star)],type:"Projection"}:i}parseSliceExpression(){const e=[null,null,null];let n=0,i=this.lookahead(0);for(;i!==pt.TOK_RBRACKET&&n<3;){if(i===pt.TOK_COLON)n+=1,this.advance();else if(i===pt.TOK_NUMBER)e[n]=this.lookaheadToken(0).value,this.advance();else{const r=this.lookaheadToken(0);this.errorToken(r,`Syntax error, unexpected token: ${r.value}(${r.type})`)}i=this.lookahead(0)}return this.match(pt.TOK_RBRACKET),{children:e,type:"Slice"}}parseComparator(e,n){const i=this.expression(ru[n]);return{type:"Comparator",name:n,children:[e,i]}}parseDotRHS(e){const n=this.lookahead(0);if([pt.TOK_UNQUOTEDIDENTIFIER,pt.TOK_QUOTEDIDENTIFIER,pt.TOK_STAR].includes(n))return this.expression(e);if(n===pt.TOK_LBRACKET)return this.match(pt.TOK_LBRACKET),this.parseMultiselectList();if(n===pt.TOK_LBRACE)return this.match(pt.TOK_LBRACE),this.parseMultiselectHash();const r=this.lookaheadToken(0);this.errorToken(r,`Syntax error, unexpected token: ${r.value}(${r.type})`)}parseProjectionRHS(e){if(ru[this.lookahead(0)]<10)return{type:"Identity"};if(this.lookahead(0)===pt.TOK_LBRACKET)return this.expression(e);if(this.lookahead(0)===pt.TOK_FILTER)return this.expression(e);if(this.lookahead(0)===pt.TOK_DOT)return this.match(pt.TOK_DOT),this.parseDotRHS(e);const n=this.lookaheadToken(0);this.errorToken(n,`Syntax error, unexpected token: ${n.value}(${n.type})`)}parseMultiselectList(){const e=[];for(;this.lookahead(0)!==pt.TOK_RBRACKET;){const n=this.expression(0);if(e.push(n),this.lookahead(0)===pt.TOK_COMMA&&(this.match(pt.TOK_COMMA),this.lookahead(0)===pt.TOK_RBRACKET))throw new Error("Unexpected token Rbracket")}return this.match(pt.TOK_RBRACKET),{type:"MultiSelectList",children:e}}parseMultiselectHash(){const e=[],n=[pt.TOK_UNQUOTEDIDENTIFIER,pt.TOK_QUOTEDIDENTIFIER];let i,r,s;for(;;){if(i=this.lookaheadToken(0),!n.includes(i.type))throw new Error(`Expecting an identifier token, got: ${i.type}`);if(r=i.value,this.advance(),this.match(pt.TOK_COLON),s=this.expression(0),e.push({value:s,type:"KeyValuePair",name:r}),this.lookahead(0)===pt.TOK_COMMA)this.match(pt.TOK_COMMA);else if(this.lookahead(0)===pt.TOK_RBRACE){this.match(pt.TOK_RBRACE);break}}return{type:"MultiSelectHash",children:e}}}const U9e=new L9e;var $t;(function(t){t[t.TYPE_NUMBER=0]="TYPE_NUMBER",t[t.TYPE_ANY=1]="TYPE_ANY",t[t.TYPE_STRING=2]="TYPE_STRING",t[t.TYPE_ARRAY=3]="TYPE_ARRAY",t[t.TYPE_OBJECT=4]="TYPE_OBJECT",t[t.TYPE_BOOLEAN=5]="TYPE_BOOLEAN",t[t.TYPE_EXPREF=6]="TYPE_EXPREF",t[t.TYPE_NULL=7]="TYPE_NULL",t[t.TYPE_ARRAY_NUMBER=8]="TYPE_ARRAY_NUMBER",t[t.TYPE_ARRAY_STRING=9]="TYPE_ARRAY_STRING"})($t||($t={}));class B9e{constructor(e){this.TYPE_NAME_TABLE={[$t.TYPE_NUMBER]:"number",[$t.TYPE_ANY]:"any",[$t.TYPE_STRING]:"string",[$t.TYPE_ARRAY]:"array",[$t.TYPE_OBJECT]:"object",[$t.TYPE_BOOLEAN]:"boolean",[$t.TYPE_EXPREF]:"expression",[$t.TYPE_NULL]:"null",[$t.TYPE_ARRAY_NUMBER]:"Array<number>",[$t.TYPE_ARRAY_STRING]:"Array<string>"},this.functionAbs=([n])=>Math.abs(n),this.functionAvg=([n])=>{let i=0;for(let r=0;r<n.length;r+=1)i+=n[r];return i/n.length},this.functionCeil=([n])=>Math.ceil(n),this.functionContains=n=>{const[i,r]=n;return i.includes(r)},this.functionEndsWith=n=>{const[i,r]=n;return i.includes(r,i.length-r.length)},this.functionFloor=([n])=>Math.floor(n),this.functionJoin=n=>{const[i,r]=n;return r.join(i)},this.functionKeys=([n])=>Object.keys(n),this.functionLength=([n])=>QC(n)?Object.keys(n).length:n.length,this.functionMap=n=>{if(!this._interpreter)return[];const i=[],r=this._interpreter,s=n[0],a=n[1];for(let o=0;o<a.length;o+=1)i.push(r.visit(s,a[o]));return i},this.functionMax=([n])=>{if(!n.length)return null;if(this.getTypeName(n[0])===$t.TYPE_NUMBER)return Math.max(...n);const r=n;let s=r[0];for(let a=1;a<r.length;a+=1)s.localeCompare(r[a])<0&&(s=r[a]);return s},this.functionMaxBy=n=>{const i=n[1],r=n[0],s=this.createKeyFunction(i,[$t.TYPE_NUMBER,$t.TYPE_STRING]);let a=-1/0,o,c;for(let l=0;l<r.length;l+=1)c=s&&s(r[l]),c!==void 0&&c>a&&(a=c,o=r[l]);return o},this.functionMerge=n=>{let i={};for(let r=0;r<n.length;r+=1){const s=n[r];i=Object.assign(i,s)}return i},this.functionMin=([n])=>{if(!n.length)return null;if(this.getTypeName(n[0])===$t.TYPE_NUMBER)return Math.min(...n);const r=n;let s=r[0];for(let a=1;a<r.length;a+=1)r[a].localeCompare(s)<0&&(s=r[a]);return s},this.functionMinBy=n=>{const i=n[1],r=n[0],s=this.createKeyFunction(i,[$t.TYPE_NUMBER,$t.TYPE_STRING]);let a=1/0,o,c;for(let l=0;l<r.length;l+=1)c=s&&s(r[l]),c!==void 0&&c<a&&(a=c,o=r[l]);return o},this.functionNotNull=n=>{for(let i=0;i<n.length;i+=1)if(this.getTypeName(n[i])!==$t.TYPE_NULL)return n[i];return null},this.functionReverse=([n])=>{if(this.getTypeName(n)===$t.TYPE_STRING){const s=n;let a="";for(let o=s.length-1;o>=0;o-=1)a+=s[o];return a}const r=n.slice(0);return r.reverse(),r},this.functionSort=([n])=>[...n].sort(),this.functionSortBy=n=>{if(!this._interpreter)return[];const i=n[0].slice(0);if(i.length===0)return i;const r=this._interpreter,s=n[1],a=this.getTypeName(r.visit(s,i[0]));if(a!==void 0&&![$t.TYPE_NUMBER,$t.TYPE_STRING].includes(a))throw new Error(`TypeError: unexpected type (${this.TYPE_NAME_TABLE[a]})`);const o=[];for(let c=0;c<i.length;c+=1)o.push([c,i[c]]);o.sort((c,l)=>{const u=r.visit(s,c[1]),h=r.visit(s,l[1]);if(this.getTypeName(u)!==a)throw new Error(`TypeError: expected (${this.TYPE_NAME_TABLE[a]}), received ${this.TYPE_NAME_TABLE[this.getTypeName(u)]}`);if(this.getTypeName(h)!==a)throw new Error(`TypeError: expected (${this.TYPE_NAME_TABLE[a]}), received ${this.TYPE_NAME_TABLE[this.getTypeName(h)]}`);return u>h?1:u<h?-1:c[0]-l[0]});for(let c=0;c<o.length;c+=1)i[c]=o[c][1];return i},this.functionStartsWith=([n,i])=>n.startsWith(i),this.functionSum=([n])=>n.reduce((i,r)=>i+r,0),this.functionToArray=([n])=>this.getTypeName(n)===$t.TYPE_ARRAY?n:[n],this.functionToNumber=([n])=>{const i=this.getTypeName(n);let r;return i===$t.TYPE_NUMBER?n:i===$t.TYPE_STRING&&(r=+n,!isNaN(r))?r:null},this.functionToString=([n])=>this.getTypeName(n)===$t.TYPE_STRING?n:JSON.stringify(n),this.functionType=([n])=>{switch(this.getTypeName(n)){case $t.TYPE_NUMBER:return"number";case $t.TYPE_STRING:return"string";case $t.TYPE_ARRAY:return"array";case $t.TYPE_OBJECT:return"object";case $t.TYPE_BOOLEAN:return"boolean";case $t.TYPE_EXPREF:return"expref";case $t.TYPE_NULL:return"null";default:return}},this.functionValues=([n])=>Object.values(n),this.functionTable={abs:{_func:this.functionAbs,_signature:[{types:[$t.TYPE_NUMBER]}]},avg:{_func:this.functionAvg,_signature:[{types:[$t.TYPE_ARRAY_NUMBER]}]},ceil:{_func:this.functionCeil,_signature:[{types:[$t.TYPE_NUMBER]}]},contains:{_func:this.functionContains,_signature:[{types:[$t.TYPE_STRING,$t.TYPE_ARRAY]},{types:[$t.TYPE_ANY]}]},ends_with:{_func:this.functionEndsWith,_signature:[{types:[$t.TYPE_STRING]},{types:[$t.TYPE_STRING]}]},floor:{_func:this.functionFloor,_signature:[{types:[$t.TYPE_NUMBER]}]},join:{_func:this.functionJoin,_signature:[{types:[$t.TYPE_STRING]},{types:[$t.TYPE_ARRAY_STRING]}]},keys:{_func:this.functionKeys,_signature:[{types:[$t.TYPE_OBJECT]}]},length:{_func:this.functionLength,_signature:[{types:[$t.TYPE_STRING,$t.TYPE_ARRAY,$t.TYPE_OBJECT]}]},map:{_func:this.functionMap,_signature:[{types:[$t.TYPE_EXPREF]},{types:[$t.TYPE_ARRAY]}]},max:{_func:this.functionMax,_signature:[{types:[$t.TYPE_ARRAY_NUMBER,$t.TYPE_ARRAY_STRING]}]},max_by:{_func:this.functionMaxBy,_signature:[{types:[$t.TYPE_ARRAY]},{types:[$t.TYPE_EXPREF]}]},merge:{_func:this.functionMerge,_signature:[{types:[$t.TYPE_OBJECT],variadic:!0}]},min:{_func:this.functionMin,_signature:[{types:[$t.TYPE_ARRAY_NUMBER,$t.TYPE_ARRAY_STRING]}]},min_by:{_func:this.functionMinBy,_signature:[{types:[$t.TYPE_ARRAY]},{types:[$t.TYPE_EXPREF]}]},not_null:{_func:this.functionNotNull,_signature:[{types:[$t.TYPE_ANY],variadic:!0}]},reverse:{_func:this.functionReverse,_signature:[{types:[$t.TYPE_STRING,$t.TYPE_ARRAY]}]},sort:{_func:this.functionSort,_signature:[{types:[$t.TYPE_ARRAY_STRING,$t.TYPE_ARRAY_NUMBER]}]},sort_by:{_func:this.functionSortBy,_signature:[{types:[$t.TYPE_ARRAY]},{types:[$t.TYPE_EXPREF]}]},starts_with:{_func:this.functionStartsWith,_signature:[{types:[$t.TYPE_STRING]},{types:[$t.TYPE_STRING]}]},sum:{_func:this.functionSum,_signature:[{types:[$t.TYPE_ARRAY_NUMBER]}]},to_array:{_func:this.functionToArray,_signature:[{types:[$t.TYPE_ANY]}]},to_number:{_func:this.functionToNumber,_signature:[{types:[$t.TYPE_ANY]}]},to_string:{_func:this.functionToString,_signature:[{types:[$t.TYPE_ANY]}]},type:{_func:this.functionType,_signature:[{types:[$t.TYPE_ANY]}]},values:{_func:this.functionValues,_signature:[{types:[$t.TYPE_OBJECT]}]}},this._interpreter=e}registerFunction(e,n,i){if(e in this.functionTable)throw new Error(`Function already defined: ${e}()`);this.functionTable[e]={_func:n.bind(this),_signature:i}}callFunction(e,n){const i=this.functionTable[e];if(i===void 0)throw new Error(`Unknown function: ${e}()`);return this.validateArgs(e,n,i._signature),i._func.call(this,n)}validateInputSignatures(e,n){for(let i=0;i<n.length;i+=1)if("variadic"in n[i]&&i!==n.length-1)throw new Error(`ArgumentError: ${e}() 'variadic' argument ${i+1} must occur last`)}validateArgs(e,n,i){var r,s;let a;this.validateInputSignatures(e,i);const o=i.filter(g=>{var y;return(y=!g.optional)!==null&&y!==void 0?y:!1}).length,c=(s=(r=i[i.length-1])===null||r===void 0?void 0:r.variadic)!==null&&s!==void 0?s:!1,l=n.length<o,u=n.length>i.length,h=l&&(!c&&o>1||c)?"at least ":"";if(c&&l||!c&&(l||u))throw a=i.length>1,new Error(`ArgumentError: ${e}() takes ${h}${o} argument${a&&"s"||""} but received ${n.length}`);let f,d,p;for(let g=0;g<i.length;g+=1){p=!1,f=i[g].types,d=this.getTypeName(n[g]);let y;for(y=0;y<f.length;y+=1)if(d!==void 0&&this.typeMatches(d,f[y],n[g])){p=!0;break}if(!p&&d!==void 0){const v=f.map(b=>this.TYPE_NAME_TABLE[b]).join(" | ");throw new Error(`TypeError: ${e}() expected argument ${g+1} to be type (${v}) but received type ${this.TYPE_NAME_TABLE[d]} instead.`)}}}typeMatches(e,n,i){if(n===$t.TYPE_ANY)return!0;if(n===$t.TYPE_ARRAY_STRING||n===$t.TYPE_ARRAY_NUMBER||n===$t.TYPE_ARRAY){if(n===$t.TYPE_ARRAY)return e===$t.TYPE_ARRAY;if(e===$t.TYPE_ARRAY){let r;n===$t.TYPE_ARRAY_NUMBER?r=$t.TYPE_NUMBER:n===$t.TYPE_ARRAY_STRING&&(r=$t.TYPE_STRING);for(let s=0;s<i.length;s+=1){const a=this.getTypeName(i[s]);if(a!==void 0&&r!==void 0&&!this.typeMatches(a,r,i[s]))return!1}return!0}}else return e===n;return!1}getTypeName(e){switch(Object.prototype.toString.call(e)){case"[object String]":return $t.TYPE_STRING;case"[object Number]":return $t.TYPE_NUMBER;case"[object Array]":return $t.TYPE_ARRAY;case"[object Boolean]":return $t.TYPE_BOOLEAN;case"[object Null]":return $t.TYPE_NULL;case"[object Object]":return e.jmespathType===pt.TOK_EXPREF?$t.TYPE_EXPREF:$t.TYPE_OBJECT;default:return}}createKeyFunction(e,n){if(!this._interpreter)return;const i=this._interpreter;return s=>{const a=i.visit(e,s);if(!n.includes(this.getTypeName(a))){const o=`TypeError: expected one of (${n.map(c=>this.TYPE_NAME_TABLE[c]).join(" | ")}), received ${this.TYPE_NAME_TABLE[this.getTypeName(a)]}`;throw new Error(o)}return a}}}class F9e{constructor(){this._rootValue=null,this.runtime=new B9e(this)}search(e,n){return this._rootValue=n,this.visit(e,n)}visit(e,n){let i,r,s,a,o,c,l,u,h,f,d;switch(e.type){case"Field":return n===null?null:QC(n)?(c=n[e.name],c===void 0?null:c):null;case"Subexpression":for(s=this.visit(e.children[0],n),f=1;f<e.children.length;f+=1)if(s=this.visit(e.children[1],s),s===null)return null;return s;case"IndexExpression":return l=this.visit(e.children[0],n),u=this.visit(e.children[1],l),u;case"Index":if(!Array.isArray(n))return null;let p=e.value;return p<0&&(p=n.length+p),s=n[p],s===void 0&&(s=null),s;case"Slice":if(!Array.isArray(n))return null;const g=[...e.children],y=this.computeSliceParams(n.length,g),[v,b,T]=y;if(s=[],T>0)for(f=v;f<b;f+=T)s.push(n[f]);else for(f=v;f>b;f+=T)s.push(n[f]);return s;case"Projection":if(d=this.visit(e.children[0],n),!Array.isArray(d))return null;for(h=[],f=0;f<d.length;f+=1)r=this.visit(e.children[1],d[f]),r!==null&&h.push(r);return h;case"ValueProjection":if(d=this.visit(e.children[0],n),!QC(d))return null;h=[];const x=Object.values(d);for(f=0;f<x.length;f+=1)r=this.visit(e.children[1],x[f]),r!==null&&h.push(r);return h;case"FilterProjection":if(d=this.visit(e.children[0],n),!Array.isArray(d))return null;const M=[],R=[];for(f=0;f<d.length;f+=1)i=this.visit(e.children[2],d[f]),SP(i)||M.push(d[f]);for(let $=0;$<M.length;$+=1)r=this.visit(e.children[1],M[$]),r!==null&&R.push(r);return R;case"Comparator":switch(a=this.visit(e.children[0],n),o=this.visit(e.children[1],n),e.name){case pt.TOK_EQ:s=g3(a,o);break;case pt.TOK_NE:s=!g3(a,o);break;case pt.TOK_GT:s=a>o;break;case pt.TOK_GTE:s=a>=o;break;case pt.TOK_LT:s=a<o;break;case pt.TOK_LTE:s=a<=o;break;default:throw new Error(`Unknown comparator: ${e.name}`)}return s;case pt.TOK_FLATTEN:const I=this.visit(e.children[0],n);if(!Array.isArray(I))return null;let k=[];for(f=0;f<I.length;f+=1)r=I[f],Array.isArray(r)?k=[...k,...r]:k.push(r);return k;case"Identity":return n;case"MultiSelectList":if(n===null)return null;for(h=[],f=0;f<e.children.length;f+=1)h.push(this.visit(e.children[f],n));return h;case"MultiSelectHash":if(n===null)return null;h={};let P;for(f=0;f<e.children.length;f+=1)P=e.children[f],h[P.name]=this.visit(P.value,n);return h;case"OrExpression":return i=this.visit(e.children[0],n),SP(i)&&(i=this.visit(e.children[1],n)),i;case"AndExpression":return a=this.visit(e.children[0],n),SP(a)?a:this.visit(e.children[1],n);case"NotExpression":return a=this.visit(e.children[0],n),SP(a);case"Literal":return e.value;case pt.TOK_PIPE:return l=this.visit(e.children[0],n),this.visit(e.children[1],l);case pt.TOK_CURRENT:return n;case pt.TOK_ROOT:return this._rootValue;case"Function":const U=[];for(let $=0;$<e.children.length;$+=1)U.push(this.visit(e.children[$],n));return this.runtime.callFunction(e.name,U);case"ExpressionReference":const G=e.children[0];return G.jmespathType=pt.TOK_EXPREF,G;default:throw new Error(`Unknown node type: ${e.type}`)}}computeSliceParams(e,n){let[i,r,s]=n;if(s===null)s=1;else if(s===0){const o=new Error("Invalid slice, step cannot be 0");throw o.name="RuntimeError",o}const a=s<0;return i=i===null?a?e-1:0:this.capSliceRange(e,i,s),r=r===null?a?-1:e:this.capSliceRange(e,r,s),[i,r,s]}capSliceRange(e,n,i){let r=n;return r<0?(r+=e,r<0&&(r=i<0?-1:0)):r>=e&&(r=i<0?e-1:e),r}}const z9e=new F9e;$t.TYPE_ANY;$t.TYPE_ARRAY;$t.TYPE_ARRAY_NUMBER;$t.TYPE_ARRAY_STRING;$t.TYPE_BOOLEAN;$t.TYPE_EXPREF;$t.TYPE_NULL;$t.TYPE_NUMBER;$t.TYPE_OBJECT;$t.TYPE_STRING;function H9e(t,e){const n=U9e.parse(e);return z9e.search(n,t)}const j9e=(t,e)=>{const n=_b(t.id());if(!se(n))return 0;const[i,r]=Ct(e,0,[Ze.NAME,Ze.NAME]),s=H9e(n.json,i);return t.set(r,s),0};function V9e(t,e){return Math.sqrt(Math.pow(t.r-e.r,2)+Math.pow(t.g-e.g,2)+Math.pow(t.b-e.b,2))}const TP=T1(PA);function Oie(t){let e;if(!se(TP))return e;let n=1e9;for(let i=0;i<=Jt.BLACK;++i){const r=i*Xb,s=TP.bits[r],a=TP.bits[r+1],o=TP.bits[r+2],c=V9e(t,{r:s,g:a,b:o,hex:""});c<n&&(e=i,n=c)}return e}const G9e=(t,e)=>{var o,c,l,u;const n=_b(t.id());if(!se(n))return 0;const[i,r]=Ct(e,0,[Ze.NAME]),s=si(i),a=((o=n.content)==null?void 0:o.layers)??[];switch(s){case"seek":{const[h]=Ct(e,r,[Ze.NUMBER]);n.cursor=lr(h,0,a.length-1);break}case"layer":{const h=n.cursor+1;n.cursor=lr(h,0,a.length-1);break}case"char":{const[h,f,d]=Ct(e,r,[Ze.NUMBER,Ze.NUMBER,Ze.NAME]),p=(c=n.content)==null?void 0:c.layers[n.cursor];se(p)&&nm(h,f,0,p.width-1,p.height-1,0)&&t.set(d,p.raster[h+f*p.width].asciiCode);break}case"color":{const[h,f,d]=Ct(e,r,[Ze.NUMBER,Ze.NUMBER,Ze.NAME]),p=(l=n.content)==null?void 0:l.layers[n.cursor];se(p)&&nm(h,f,0,p.width-1,p.height-1,0)&&t.set(d,Oie(p.raster[h+f*p.width].color));break}case"bg":{const[h,f,d]=Ct(e,r,[Ze.NUMBER,Ze.NUMBER,Ze.NAME]),p=(u=n.content)==null?void 0:u.layers[n.cursor];se(p)&&nm(h,f,0,p.width-1,p.height-1,0)&&t.set(d,Oie(p.raster[h+f*p.width].bg));break}}return 0},q9e=(t,e)=>{const n=_b(t.id());if(!se(n))return 0;const[i,r]=Ct(e,0,[Ze.NAME]);switch(si(i)){case"seek":{const[a]=Ct(e,r,[Ze.NUMBER]);n.cursor=lr(a,0,n.lines.length-1);break}case"line":n.cursor=lr(n.cursor+1,0,n.lines.length-1);break;default:{const a=n.lines[n.cursor]??"",c=new RegExp(i,"i").exec(a)??[];let l=1;for(let u=r;u<e.length;){const[h,f]=Ct(e,u,[Ze.NAME]);t.set(h,c[l]??0),++l,u=f}break}}return 0},$9e=b0({get(t,e){var i,r,s;const n=R9e(t.id());if(e==="format")return[!0,n];switch(n){case"text":{const a=_b(t.id());switch(e){case"filename":return[!0,a.filename];case"cursor":return[!0,a.cursor];case"lines":return[!0,a.lines.length]}break}case"json":{const a=_b(t.id());switch(e){case"filename":return[!0,a.filename]}break}case"binary":{const a=_b(t.id());switch(e){case"filename":return[!0,a.filename];case"cursor":return[!0,a.cursor];case"bytes":return[!0,a.bytes.length]}break}case"rexpaint":{const a=_b(t.id());switch(e){case"filename":return[!0,a.filename];case"layers":return[!0,((i=a.content)==null?void 0:i.layers.length)??0];case"width":return[!0,((r=a.content)==null?void 0:r.layers[a.cursor].width)??0];case"height":return[!0,((s=a.content)==null?void 0:s.layers[a.cursor].height)??0];case"cursor":return[!0,a.cursor]}break}}return[!1,void 0]}}).command("send",(t,e)=>{const[n,i]=Ct(e,0,[Ze.NAME,Ze.ANY]);return rve(n,i),0}).command("stat",()=>0).command("text",(t,e)=>{const n=e.map(Ws).join(" ");return e0(je,ne.elementfocus,"$175",n),0}).command("hyperlink",(t,e)=>{const[n,...i]=e,r=Ws(n),s=i.map(Ws).join(" ");return e0(je,ne.elementfocus,"$175",`!${s};${r}`),0}).command("readline",q9e).command("readjson",j9e).command("readbin",M9e).command("readrexpaint",G9e).command("with",(t,e)=>{const[n]=Ct(e,0,[Ze.NAME]),i=sp(ne.book,Wn.BOARD,n);if(i.length){const r=Za(...i);se(r)&&(ne.board=qc(r),ne.element={x:-1,y:-1})}return 0});function Nie(t,e,n,i,r,s){const a=[];for(let o=s;o<r.length;){const[c,l]=Ct(r,o,[Ze.ANY]);Li(c)&&!x_(c)&&!gN(c)&&!m3(c)&&!a0(c)?a.push(...c):a.push(c),o=l}switch(si(i)){case"get":case"post:json":LBe(je,ne.elementfocus,t,e,n,i,a);break}return 0}const W9e=b0().command("fetch",(t,e)=>{const[n,i,r="get",s]=Ct(e,0,[Ze.NAME,Ze.NAME,Ze.MAYBE_STRING]);return Nie(void 0,n,i,r,e,s),0}).command("fetchwith",(t,e)=>{const[n,i,r,s="get",a]=Ct(e,0,[Ze.ANY,Ze.NAME,Ze.NAME,Ze.MAYBE_STRING]);return Nie(n,i,r,s,e,a),0}).command("twitchchat",(t,e)=>{const[n]=Ct(e,0,[Ze.ANY]);switch(si(n)){default:DBe(je,ne.elementfocus,n);break;case"stop":PBe(je,ne.elementfocus);break}return 0}).command("twitchbroadcast",(t,e)=>{const[n]=Ct(e,0,[Ze.NAME]);switch(si(n)){default:IBe(je,ne.elementfocus,n);break;case"stop":kBe(je,ne.elementfocus);break}return 0}),O2={},aw={};function Y9e(){return{id:Bo(),layers:[],scroll:[],sidebar:[]}}const X9e=new Set(["rn","range","sl","select","nm","number","tx","text","zssedit","charedit","coloredit"]),K9e=new Set(["tx","text"]),Z9e={rn:1,range:1,sl:0,select:0,nm:0,number:0,tx:"",text:"",zssedit:"",charedit:"",coloredit:""},Iie={};let J9e=t=>{let e=Iie[t];return se(e)||(Iie[t]=e=Y9e()),e};function $5(t){return J9e(t)}function jY(t){return se(O2[t])||(O2[t]=[]),O2[t]}function Q9e(t,e,n){Object.values(aw).forEach(i=>{if(i[e]!==void 0){const r=EE(t.id(),e);pn(n)&&pl(r,n),On(n)&&d9e(r,n)}})}function eYe(t){const e=jY(t);return O2[t]=[],e}function tYe(t,e){jY(t).push(e)}function nYe(t,e,n,i,r=()=>0,s=Zu){const a=[e,n,...i],o=si(`${a[3]}`),c={...ne};function l(u,h){se(h)&&h!==r(u)&&(ne.board=c.board,ne.element=c.element,ne.elementfocus=c.elementfocus,s(u,h))}if(X9e.has(o)){const u=`${a[2]}`;aw[e]=aw[e]??{};const h=r(u)??Z9e[o];if(aw[e][u]===void 0){const f=EE(e,u);pn(h)&&f9e(f,h),On(h)&&R0e(f,h),K9e.has(o)?aw[e][u]=m9e(f,d=>{l(u,d)}):aw[e][u]=p9e(f,d=>{l(u,d)})}}jY(t).push(a)}const iYe=b0({set(t,e,n){return Q9e(t,e,n),[!1,void 0]},everytick(){const t=eYe(ne.elementid),[e]=t;if(t.length===1&&On(e)){if(se(ne.element))if(e.trim().length===0){const n=$5(ne.elementid);n.sidebar=[]}else ne.element.tickertext=e,ne.element.tickertime=ne.timestamp}else if(t.length>1)if(ne.elementisplayer){const n=$5(ne.elementid);n.sidebar=t}else{const n=$5(ne.elementfocus);n.scroll=t}}}).command("send",(t,e)=>{var o,c;const[n,i]=Ct(e,0,[Ze.NAME,Ze.ANY]),[r,s]=HY(n);switch(si(r)){case"all":for(const l of Object.keys(((o=ne.board)==null?void 0:o.objects)??{}))t.send(ne.elementfocus,l,s,i);break;case"self":t.message({session:je.session(),player:ne.elementfocus,id:Bo(),sender:t.id(),target:s,data:i});break;case"others":for(const l of Object.keys(((c=ne.board)==null?void 0:c.objects)??{}))l!==t.id()&&t.send(ne.elementfocus,l,s,i);break;default:{const l=fge(ne.board,[r]);for(let u=0;u<l.length;++u){const h=l[u];se(h.id)&&t.send(ne.elementfocus,h.id,s,i)}break}}return 0}).command("stat",()=>0).command("text",(t,e)=>{const n=e.map(Ws).join("");return tYe(ne.elementid,n),0}).command("hyperlink",(t,e)=>{const[n,...i]=e,r=Ws(n);return nYe(ne.elementid,t.id(),r,i,t.get,t.set),0});function kie(t,e,n,i){for(let r=n.y;r<=i.y;++r)for(let s=n.x;s<=i.x;++s){const a=gl(e,{x:s,y:r});sh(a)&&Wg(t,e,a,t.timestamp),Jf(e,{x:s,y:r})}}function rYe(t,e,n){for(let i=e.y;i<=n.y;++i)for(let r=e.x;r<=n.x;++r)Jf(t,{x:r,y:i})}function Die(t,e,n,i){for(let r=n.y;r<=i.y;++r)for(let s=n.x;s<=i.x;++s){const a=gl(e,{x:s,y:r});sh(a)&&Wg(t,e,a,t.timestamp),Jf(e,{x:s,y:r})}}function v3(t,e){se(t)&&(t.name=e.name,t.char=e.char,t.color=e.color,t.bg=e.bg,t.p1=e.p1,t.p2=e.p2,t.p3=e.p3,t.code=e.code,t.group=e.group,t.party=e.party,t.cycle=e.cycle,t.light=e.light,t.stepx=e.stepx,t.stepy=e.stepy,t.pushable=e.pushable,t.collision=e.collision,t.destructible=e.destructible,t.tickertext=e.tickertext,t.tickertime=e.tickertime)}function VY(t,e,n,i,r){if(!se(ne.book))return;const s=ne.book,a=lh(s,Wn.BOARD,t),o=qc(a);if(!se(o))return;const c=lh(s,Wn.BOARD,e),l=qc(c);if(!se(l))return;vl(s,o),vl(s,l);let u=!1;if(se(o)&&se(l)){switch(r){case"all":kie(s,l,n,i);break;case"object":Die(s,l,n,i);break;case"terrain":rYe(l,n,i);break;default:u=!0;break}for(let h=n.y;h<=i.y;++h)for(let f=n.x;f<=i.x;++f){let d=!1,p=!1;switch(r){case"all":d=!0,p=!0;break;case"object":d=!0;break;case"terrain":p=!0;break}const g={x:f,y:h};let y,v=gl(o,g);if(sh(v)?(y=PF(o,f,h),Nb(v==null?void 0:v.id)&&(v=void 0)):(y=v,v=void 0),se(y)&&(p||u&&C_(s,y)===r)){u&&kie(s,l,g,g);const b=ZT(s,l,[y.kind??""],g);v3(b,y)}if(se(v)&&(d||u&&C_(s,v)===r)){u&&Die(s,l,g,g);const b=ZT(s,l,[v.kind??""],g);v3(b,v)}}s3(s,l)}}function sYe(t,e,n,i,r){if(!se(ne.book))return;const s=ne.book,a=lh(s,Wn.BOARD,t),o=qc(a);if(!se(o))return;const c=q9(),l=r==="all"||r==="object",u=r==="all"||r==="terrain";vl(s,o),vl(s,c);const h=-Math.tan(e*.5),f=Math.sin(e),d=Math.round(12.5*h),p=Math.round(12.5*f),g=new Array(Fr).fill(0);Rne(d,0,-d,Fr-1).forEach(x=>{x.x<0?g[x.y]=Math.min(g[x.y],x.x):g[x.y]=Math.max(g[x.y],x.x)});const v=new Array(fi).fill(0);Rne(0,p,fi-1,-p).forEach(x=>{x.y<0?v[x.x]=Math.min(v[x.x],x.y):v[x.x]=Math.max(v[x.x],x.y)});const T=[g,v,g];for(let x=0;x<T.length;++x){const M=T[x];if(x!==1){for(let R=0;R<Fr;++R){const I=M[R],k=R*fi;for(let P=0;P<fi;P++){const U=(P+I+fi)%fi;u&&(c.terrain[U+k]=o.terrain[P+k])}}if(l){const R=Object.keys(o.objects);for(let I=0;I<R.length;++I){const k=R[I],{x:P,y:U}=o.objects[k];if(se(P)&&se(U)){const G=M[U];o.objects[k].x=(P+G+fi)%fi,o.objects[k].lx=o.objects[k].x}}}}if(x===1){for(let R=0;R<fi;++R){const I=M[R];for(let k=0;k<Fr;++k){const P=(k+I+Fr)%Fr;u&&(c.terrain[R+P*fi]=o.terrain[R+k*fi])}}if(l){const R=Object.keys(o.objects);for(let I=0;I<R.length;++I){const k=R[I],{x:P,y:U}=o.objects[k];if(se(P)&&se(U)){const G=M[P];o.objects[k].y=(U+G+Fr)%Fr,o.objects[k].ly=o.objects[k].y}}}}u&&(o.terrain=[...c.terrain]),delete c.named,delete c.lookup,delete o.named,delete o.lookup,vl(s,c),vl(s,o)}}function aYe(t,e){let n=0,i=0,r=0;for(;r<t.length;r++)n+=t[r];for(r=0,e*=n;e&&r<t.length;){if(i+=t[r],e<=i)return r;r++}return 0}var oYe=aYe;const cYe=oYe,zr=function(){};zr.prototype.FMX=0;zr.prototype.FMY=0;zr.prototype.FMXxFMY=0;zr.prototype.T=0;zr.prototype.N=0;zr.prototype.initiliazedField=!1;zr.prototype.generationComplete=!1;zr.prototype.wave=null;zr.prototype.compatible=null;zr.prototype.weightLogWeights=null;zr.prototype.sumOfWeights=0;zr.prototype.sumOfWeightLogWeights=0;zr.prototype.startingEntropy=0;zr.prototype.sumsOfOnes=null;zr.prototype.sumsOfWeights=null;zr.prototype.sumsOfWeightLogWeights=null;zr.prototype.entropies=null;zr.prototype.propagator=null;zr.prototype.observed=null;zr.prototype.distribution=null;zr.prototype.stack=null;zr.prototype.stackSize=0;zr.prototype.DX=[-1,0,1,0];zr.prototype.DY=[0,1,0,-1];zr.prototype.opposite=[2,3,0,1];zr.prototype.initialize=function(){this.distribution=new Array(this.T),this.wave=new Array(this.FMXxFMY),this.compatible=new Array(this.FMXxFMY);for(let t=0;t<this.FMXxFMY;t++){this.wave[t]=new Array(this.T),this.compatible[t]=new Array(this.T);for(let e=0;e<this.T;e++)this.compatible[t][e]=[0,0,0,0]}this.weightLogWeights=new Array(this.T),this.sumOfWeights=0,this.sumOfWeightLogWeights=0;for(let t=0;t<this.T;t++)this.weightLogWeights[t]=this.weights[t]*Math.log(this.weights[t]),this.sumOfWeights+=this.weights[t],this.sumOfWeightLogWeights+=this.weightLogWeights[t];this.startingEntropy=Math.log(this.sumOfWeights)-this.sumOfWeightLogWeights/this.sumOfWeights,this.sumsOfOnes=new Array(this.FMXxFMY),this.sumsOfWeights=new Array(this.FMXxFMY),this.sumsOfWeightLogWeights=new Array(this.FMXxFMY),this.entropies=new Array(this.FMXxFMY),this.stack=new Array(this.FMXxFMY*this.T),this.stackSize=0};zr.prototype.observe=function(t){let e=1e3,n=-1;for(let s=0;s<this.FMXxFMY;s++){if(this.onBoundary(s%this.FMX,s/this.FMX|0))continue;const a=this.sumsOfOnes[s];if(a===0)return!1;const o=this.entropies[s];if(a>1&&o<=e){const c=1e-6*t();o+c<e&&(e=o+c,n=s)}}if(n===-1){this.observed=new Array(this.FMXxFMY);for(let s=0;s<this.FMXxFMY;s++)for(let a=0;a<this.T;a++)if(this.wave[s][a]){this.observed[s]=a;break}return!0}for(let s=0;s<this.T;s++)this.distribution[s]=this.wave[n][s]?this.weights[s]:0;const i=cYe(this.distribution,t()),r=this.wave[n];for(let s=0;s<this.T;s++)r[s]!==(s===i)&&this.ban(n,s);return null};zr.prototype.propagate=function(){for(;this.stackSize>0;){const t=this.stack[this.stackSize-1];this.stackSize--;const e=t[0],n=e%this.FMX,i=e/this.FMX|0;for(let r=0;r<4;r++){const s=this.DX[r],a=this.DY[r];let o=n+s,c=i+a;if(this.onBoundary(o,c))continue;o<0?o+=this.FMX:o>=this.FMX&&(o-=this.FMX),c<0?c+=this.FMY:c>=this.FMY&&(c-=this.FMY);const l=o+c*this.FMX,u=this.propagator[r][t[1]],h=this.compatible[l];for(let f=0;f<u.length;f++){const d=u[f],p=h[d];p[r]--,p[r]==0&&this.ban(l,d)}}}};zr.prototype.singleIteration=function(t){const e=this.observe(t);return e!==null?(this.generationComplete=e,!!e):(this.propagate(),null)};zr.prototype.iterate=function(t,e){this.wave||this.initialize(),this.initiliazedField||this.clear(),t=t||0,e=e||Math.random;for(let n=0;n<t||t===0;n++){const i=this.singleIteration(e);if(i!==null)return!!i}return!0};zr.prototype.generate=function(t){for(t=t||Math.random,this.wave||this.initialize(),this.clear();;){const e=this.singleIteration(t);if(e!==null)return!!e}};zr.prototype.isGenerationComplete=function(){return this.generationComplete};zr.prototype.ban=function(t,e){const n=this.compatible[t][e];for(let r=0;r<4;r++)n[r]=0;this.wave[t][e]=!1,this.stack[this.stackSize]=[t,e],this.stackSize++,this.sumsOfOnes[t]-=1,this.sumsOfWeights[t]-=this.weights[e],this.sumsOfWeightLogWeights[t]-=this.weightLogWeights[e];const i=this.sumsOfWeights[t];this.entropies[t]=Math.log(i)-this.sumsOfWeightLogWeights[t]/i};zr.prototype.clear=function(){for(let t=0;t<this.FMXxFMY;t++){for(let e=0;e<this.T;e++){this.wave[t][e]=!0;for(let n=0;n<4;n++)this.compatible[t][e][n]=this.propagator[this.opposite[n]][e].length}this.sumsOfOnes[t]=this.weights.length,this.sumsOfWeights[t]=this.sumOfWeights,this.sumsOfWeightLogWeights[t]=this.sumOfWeightLogWeights,this.entropies[t]=this.startingEntropy}this.initiliazedField=!0,this.generationComplete=!1};var L0e=zr;const U0e=L0e,A_=function(e,n,i,r,s,a,o,c,l,u){u=u||0,this.N=r,this.FMX=s,this.FMY=a,this.FMXxFMY=s*a,this.periodic=c;const h=n,f=new Array(h);for(let P=0;P<h;P++)f[P]=new Array(i);this.colors=[];const d={};for(let P=0;P<i;P++)for(let U=0;U<n;U++){const G=(P*n+U)*4,$=[e[G],e[G+1],e[G+2],e[G+3]],q=$.join("-");d.hasOwnProperty(q)||(d[q]=this.colors.length,this.colors.push($)),f[U][P]=d[q]}const p=this.colors.length,g=Math.pow(p,r*r),y=function(U){let G=new Array(r*r);for(let $=0;$<r;$++)for(let q=0;q<r;q++)G[q+$*r]=U(q,$);return G},v=function(U,G){return y(function($,q){return f[(U+$)%n][(G+q)%i]})},b=function(U){return y(function(G,$){return U[r-1-$+G*r]})},T=function(U){return y(function(G,$){return U[r-1-G+$*r]})},x=function(U){let G=0,$=1;for(let q=0;q<U.length;q++)G+=U[U.length-1-q]*$,$*=p;return G},M=function(U){let G=U,$=g;const q=new Array(r*r);for(let Y=0;Y<q.length;Y++){$/=p;let ie=0;for(;G>=$;)G-=$,ie++;q[Y]=ie}return q},R={},I=[];for(let P=0;P<(o?i:i-r+1);P++)for(let U=0;U<(o?n:n-r+1);U++){const G=new Array(8);G[0]=v(U,P),G[1]=T(G[0]),G[2]=b(G[0]),G[3]=T(G[2]),G[4]=b(G[2]),G[5]=T(G[4]),G[6]=b(G[4]),G[7]=T(G[6]);for(let $=0;$<l;$++){const q=x(G[$]);R[q]?R[q]++:(I.push(q),R[q]=1)}}this.T=I.length,this.ground=(u+this.T)%this.T,this.patterns=new Array(this.T),this.weights=new Array(this.T);for(let P=0;P<this.T;P++){const U=parseInt(I[P],10);this.patterns[P]=M(U),this.weights[P]=R[U]}const k=function(U,G,$,q){const Y=$<0?0:$,ie=$<0?$+r:r,V=q<0?0:q,J=q<0?q+r:r;for(let X=V;X<J;X++)for(let ee=Y;ee<ie;ee++)if(U[ee+r*X]!=G[ee-$+r*(X-q)])return!1;return!0};this.propagator=new Array(4);for(let P=0;P<4;P++){this.propagator[P]=new Array(this.T);for(let U=0;U<this.T;U++){const G=[];for(let $=0;$<this.T;$++)k(this.patterns[U],this.patterns[$],this.DX[P],this.DY[P])&&G.push($);this.propagator[P][U]=G}}};A_.prototype=Object.create(U0e.prototype);A_.prototype.constructor=A_;A_.prototype.onBoundary=function(t,e){return!this.periodic&&(t+this.N>this.FMX||e+this.N>this.FMY||t<0||e<0)};A_.prototype.clear=function(){if(U0e.prototype.clear.call(this),this.ground!==0){for(let t=0;t<this.FMX;t++){for(let e=0;e<this.T;e++)e!==this.ground&&this.ban(t+(this.FMY-1)*this.FMX,e);for(let e=0;e<this.FMY-1;e++)this.ban(t+e*this.FMX,this.ground)}this.propagate()}};A_.prototype.graphics=function(t){return t=t||new Uint8Array(this.FMXxFMY*4),this.isGenerationComplete()?this.graphicsComplete(t):this.graphicsIncomplete(t),t};A_.prototype.graphicsComplete=function(t){for(let e=0;e<this.FMY;e++){const n=e<this.FMY-this.N+1?0:this.N-1;for(let i=0;i<this.FMX;i++){const r=i<this.FMX-this.N+1?0:this.N-1,s=(e*this.FMX+i)*4,a=this.colors[this.patterns[this.observed[i-r+(e-n)*this.FMX]][r+n*this.N]];t[s]=a[0],t[s+1]=a[1],t[s+2]=a[2],t[s+3]=a[3]}}};A_.prototype.graphicsIncomplete=function(t){for(let e=0;e<this.FMXxFMY;e++){const n=e%this.FMX,i=e/this.FMX|0;let r=0,s=0,a=0,o=0,c=0;for(let u=0;u<this.N;u++)for(let h=0;h<this.N;h++){let f=n-h;f<0&&(f+=this.FMX);let d=i-u;if(d<0&&(d+=this.FMY),this.onBoundary(f,d))continue;const p=f+d*this.FMX;for(let g=0;g<this.T;g++)if(this.wave[p][g]){r++;const y=this.colors[this.patterns[g][h+u*this.N]];s+=y[0],a+=y[1],o+=y[2],c+=y[3]}}const l=e*4;t[l]=s/r,t[l+1]=a/r,t[l+2]=o/r,t[l+3]=c/r}};var lYe=A_;const uYe=L0e,nE=function(e,n,i,r,s){const a=e.tilesize||16;this.FMX=i,this.FMY=r,this.FMXxFMY=i*r,this.periodic=s,this.tilesize=a;const o=!!e.unique;let c=null;n&&e.subsets&&e.subsets[n]&&(c=e.subsets[n]);const l=function(x){const M=new Array(a*a);for(let R=0;R<a;R++)for(let I=0;I<a;I++)M[I+R*a]=x(I,R);return M},u=function(x){return l(function(M,R){return x[a-1-R+M*a]})},h=function(x){return l(function(M,R){return x[a-1-M+R*a]})};this.tiles=[];const f=[],d=[],p={};let g,y,v;for(let T=0;T<e.tiles.length;T++){const x=e.tiles[T];if(c!==null&&c.indexOf(x.name)===-1)continue;switch(x.symmetry){case"L":v=4,g=function(R){return(R+1)%4},y=function(R){return R%2===0?R+1:R-1};break;case"T":v=4,g=function(R){return(R+1)%4},y=function(R){return R%2===0?R:4-R};break;case"I":v=2,g=function(R){return 1-R},y=function(R){return R};break;case"\\":v=2,g=function(R){return 1-R},y=function(R){return 1-R};break;case"F":v=8,g=function(R){return R<4?(R+1)%4:4+(R-1)%4},y=function(R){return R<4?R+4:R-4};break;default:v=1,g=function(R){return R},y=function(R){return R};break}this.T=d.length,p[x.name]=this.T;for(let R=0;R<v;R++)d.push([this.T+R,this.T+g(R),this.T+g(g(R)),this.T+g(g(g(R))),this.T+y(R),this.T+y(g(R)),this.T+y(g(g(R))),this.T+y(g(g(g(R))))]);let M;if(o)for(let R=0;R<v;R++)M=x.bitmap[R],this.tiles.push(l(function(I,k){return[M[(a*k+I)*4],M[(a*k+I)*4+1],M[(a*k+I)*4+2],M[(a*k+I)*4+3]]}));else{M=x.bitmap,this.tiles.push(l(function(R,I){return[M[(a*I+R)*4],M[(a*I+R)*4+1],M[(a*I+R)*4+2],M[(a*I+R)*4+3]]}));for(let R=1;R<v;R++)this.tiles.push(R<4?u(this.tiles[this.T+R-1]):h(this.tiles[this.T+R-4]))}for(let R=0;R<v;R++)f.push(x.weight||1)}this.T=d.length,this.weights=f,this.propagator=new Array(4);const b=new Array(4);for(let T=0;T<4;T++){this.propagator[T]=new Array(this.T),b[T]=new Array(this.T);for(let x=0;x<this.T;x++){b[T][x]=new Array(this.T);for(let M=0;M<this.T;M++)b[T][x][M]=!1}}for(let T=0;T<e.neighbors.length;T++){const x=e.neighbors[T],M=x.left.split(" ").filter(function(G){return G.length}),R=x.right.split(" ").filter(function(G){return G.length});if(c!==null&&(c.indexOf(M[0])===-1||c.indexOf(R[0])===-1))continue;const I=d[p[M[0]]][M.length==1?0:parseInt(M[1],10)],k=d[I][1],P=d[p[R[0]]][R.length==1?0:parseInt(R[1],10)],U=d[P][1];b[0][P][I]=!0,b[0][d[P][6]][d[I][6]]=!0,b[0][d[I][4]][d[P][4]]=!0,b[0][d[I][2]][d[P][2]]=!0,b[1][U][k]=!0,b[1][d[k][6]][d[U][6]]=!0,b[1][d[U][4]][d[k][4]]=!0,b[1][d[k][2]][d[U][2]]=!0}for(let T=0;T<this.T;T++)for(let x=0;x<this.T;x++)b[2][T][x]=b[0][x][T],b[3][T][x]=b[1][x][T];for(let T=0;T<4;T++)for(let x=0;x<this.T;x++){const M=[],R=b[T][x];for(let I=0;I<this.T;I++)R[I]&&M.push(I);this.propagator[T][x]=M}};nE.prototype=Object.create(uYe.prototype);nE.prototype.constructor=nE;nE.prototype.onBoundary=function(t,e){return!this.periodic&&(t<0||e<0||t>=this.FMX||e>=this.FMY)};nE.prototype.graphics=function(t,e){return t=t||new Uint8Array(this.FMXxFMY*this.tilesize*this.tilesize*4),this.isGenerationComplete()?this.graphicsComplete(t):this.graphicsIncomplete(t,e),t};nE.prototype.graphicsComplete=function(t){for(let e=0;e<this.FMX;e++)for(let n=0;n<this.FMY;n++){const i=this.tiles[this.observed[e+n*this.FMX]];for(let r=0;r<this.tilesize;r++)for(let s=0;s<this.tilesize;s++){const a=(e*this.tilesize+s+(n*this.tilesize+r)*this.FMX*this.tilesize)*4,o=i[s+r*this.tilesize];t[a]=o[0],t[a+1]=o[1],t[a+2]=o[2],t[a+3]=o[3]}}};nE.prototype.graphicsIncomplete=function(t,e){(!e||e.length!==4)&&(e=!1);for(let n=0;n<this.FMX;n++)for(let i=0;i<this.FMY;i++){const r=this.wave[n+i*this.FMX];let s=0,a=0;for(let c=0;c<this.T;c++)r[c]&&(s++,a+=this.weights[c]);const o=1/a;for(let c=0;c<this.tilesize;c++)for(let l=0;l<this.tilesize;l++){const u=(n*this.tilesize+l+(i*this.tilesize+c)*this.FMX*this.tilesize)*4;if(e&&s===this.T)t[u]=e[0],t[u+1]=e[1],t[u+2]=e[2],t[u+3]=e[3];else{let h=0,f=0,d=0,p=0;for(let g=0;g<this.T;g++)if(r[g]){const y=this.tiles[g][l+c*this.tilesize],v=this.weights[g]*o;h+=y[0]*v,f+=y[1]*v,d+=y[2]*v,p+=y[3]*v}t[u]=h,t[u+1]=f,t[u+2]=d,t[u+3]=p}}}};var hYe=nE,fYe={OverlappingModel:lYe,SimpleTiledModel:hYe};const dYe=Yc(fYe),Pie=5;function pYe(t,e,n,i,r,s,a){if(!se(ne.book))return!1;const o=ne.book,c=lh(o,Wn.BOARD,t),l=lh(o,Wn.BOARD,e),u=qc(c),h=qc(l);if(!se(u)||!se(h))return!1;vl(o,u),vl(o,h);let f=0;const d=new Map,p=new Map;let g=0;const y=32,v=new Uint8Array(u9*4);for(let I=0;I<Fr;++I)for(let k=0;k<fi;++k){const P=gl(h,{x:k,y:I}),U=(P==null?void 0:P.char)??0,G=(P==null?void 0:P.color)??y,$=(P==null?void 0:P.bg)??y;v[g++]=U,v[g++]=G,v[g++]=$;const q=Jb(o,P),Y=si((q==null?void 0:q.name)??"empty"),ie=d.get(Y);pn(ie)?v[g++]=ie:(d.set(Y,f),p.set(f,Y),v[g++]=f++)}const b=s.x-r.x+1,T=s.y-r.y+1,x=new dYe.OverlappingModel(v,fi,Fr,n,b,T,!1,!1,i,0);let M=0;for(;M<Pie&&!x.generate();++M);if(M===Pie)return!1;g=0;const R=x.graphics();for(let I=r.y;I<=s.y;++I)for(let k=r.x;k<=s.x;++k){const P={x:k,y:I},U=R[g++],G=R[g++],$=R[g++];switch(f=R[g++],a){case"all":{const X=gl(u,{x:k,y:I});sh(X)&&Wg(o,u,X,o.timestamp),Jf(u,{x:k,y:I});break}case"object":{const X=gl(u,{x:k,y:I});sh(X)&&Wg(o,u,X,o.timestamp);break}case"terrain":Jf(u,{x:k,y:I});break}let q=p.get(f)??"";const Y=qI(o,q),ie=FF(o,q),V=Y??ie;switch(a){case"all":break;case"object":se(ie)&&(q="");break;case"terrain":se(Y)&&(q="");break;default:if(C_(o,V)!==a&&(q=""),q){const X=gl(u,{x:k,y:I});sh(X)&&Wg(o,u,X,o.timestamp),Jf(u,{x:k,y:I})}break}const J=q?ZT(o,u,[q],P):void 0;if(!(!se(J)||!se(V))&&(v3(J,V),U>0&&(J.char=U),G<y&&(J.color=G),$<y&&(J.bg=$),sh(J))){const X=Za(VI(h,q));se(X)&&(Jf(u,{...PF(h,X.x??0,X.y??0),x:k,y:I}),v3(J,X))}}return!0}function B0e(t){return`zss_snapshot_${t}`}function mYe(t,e,n,i){const r=lh(ne.book,Wn.BOARD,t),s=qc(r);if(!se(s))return;const a=B0e(s.id);xge(ne.book,a);const o=Hy(Rc.CONTENT,a,Wn.BOARD),c=qc(o);if(se(c))return VY(t,c.id,e,n,i),c}function gYe(t,e,n,i){const r=lh(ne.book,Wn.BOARD,t),s=qc(r);if(!se(s))return;const a=B0e(s.id),o=lh(ne.book,Wn.BOARD,a),c=qc(o);if(se(c))return VY(c.id,t,e,n,i),c}function vYe(t,e,n,i,r){switch(r){case"all":case"object":case"terrain":break;default:return _Ye(t,e,r)}if(!se(ne.book))return;const s=ne.book,a=lh(s,Wn.BOARD,t),o=qc(a);if(!se(o))return;const c=q9();vl(s,o);for(let l=n.y;l<=i.y;++l)for(let u=n.x;u<=i.x;++u){let h=!1,f=!1;switch(r){case"all":h=!0,f=!0;break;case"object":h=!0;break;case"terrain":f=!0;break}const d=(u+e.x+fi)%fi,p=(l+e.y+Fr)%Fr;if(h){const g=gl(o,{x:u,y:l});sh(g)&&se(g==null?void 0:g.x)&&se(g==null?void 0:g.y)&&(g.x=d,g.lx=d,g.y=p,g.ly=p)}f&&(c.terrain[d+p*fi]=o.terrain[u+l*fi])}(r==="all"||r==="terrain")&&(o.terrain=[...c.terrain]),s3(s,o)}function _Ye(t,e,n){if(!se(ne.book))return;const i=ne.book,r=lh(i,Wn.BOARD,t),s=qc(r);if(!se(s))return;vl(i,s);const{objectelements:a,terrainelements:o}=M$e(i,s,n);let c=!1;const l={};for(let h=0;h<o.length;++h){const f=o[h],d=lu(i,f,"collision"),p={x:f.x??-1,y:f.y??-1},g=gl(s,p);sh(g)&&se(g)&&(l[g.id??""]=!0);const y={x:p.x+e.x,y:p.y+e.y};if(XU(y)){const v=gl(s,y),b=C_(i,v),T=lu(i,v,"collision");sh(v)&&n!==b?sN(d,T)?c=!0:lu(i,v,"pushable")?c=rC(i,s,v,y)!==!0:c=!1:T===vs.ISSOLID&&n!==b&&(c=!0)}else c=!0}if(c)return;for(let h=0;h<a.length;++h){const f=a[h],d=lu(i,f,"collision"),p={x:f.x??0,y:f.y??0},g={x:p.x+e.x,y:p.y+e.y};if(XU(g)){const y=gl(s,g),v=C_(i,y),b=lu(i,y,"collision");sh(y)&&se(y)&&n!==v&&!l[y.id??""]?lu(i,y,"pushable")?c=rC(i,s,y,g)!==!0:c=!0:sN(d,b)&&n!==v&&(c=!0)}else c=!0}if(c)return;(e.x>0||e.y>0)&&o.reverse();for(let h=0;h<o.length;++h){const f=o[h],d={x:f.x??-1,y:f.y??-1},p={x:d.x+e.x,y:d.y+e.y},g=PF(s,p.x,p.y);if(se(f)&&se(g)){Jf(s,{...f,x:p.x,y:p.y}),Jf(s,{...g,x:d.x,y:d.y});const y=gl(s,d);sh(y)&&se(y)&&(y.x=(y.x??0)+e.x,y.y=(y.y??0)+e.y,y.lx=(y.lx??0)+e.x,y.ly=(y.ly??0)+e.y)}}s3(i,s);for(let h=0;h<a.length;++h){const f=a[h],d={x:f.x??-1,y:f.y??-1},p={x:d.x+e.x,y:d.y+e.y};if(!rC(i,s,f,p))break}s3(i,s)}function Gx(t,e){let n="all";const i={x:0,y:0},r={x:fi-1,y:Fr-1};for(let s=e;s<t.length;){const[a,o]=Ct(t,s,[Ze.MAYBE_NUMBER_OR_STRING]);if(On(a))n=si(a),s=o;else if(pn(a)){const[c,l,u,h]=Ct(t,o,[Ze.NUMBER,Ze.NUMBER,Ze.NUMBER]);i.x=Math.min(a,l),i.y=Math.min(c,u),r.x=Math.max(a,l),r.y=Math.max(c,u),s=h}else break}return{targetset:n,pt1:i,pt2:r}}const yYe=b0().command("snapshot",(t,e)=>{if(!se(ne.book)||!se(ne.board))return 0;const n=Gx(e,0);return mYe(ne.board.id,n.pt1,n.pt2,n.targetset),0}).command("revert",(t,e)=>{if(!se(ne.book)||!se(ne.board))return 0;const n=Gx(e,0);return gYe(ne.board.id,n.pt1,n.pt2,n.targetset),0}).command("copy",(t,e)=>{if(!se(ne.book)||!se(ne.board))return 0;const[n,i]=Ct(e,0,[Ze.NAME]),r=sp(ne.book,Wn.BOARD,n),s=Za(...r);if(se(s)){const a=Gx(e,i);VY(s.id,ne.board.id,a.pt1,a.pt2,a.targetset)}return 0}).command("remix",(t,e)=>{if(!se(ne.book)||!se(ne.board))return 0;const[n,i,r,s]=Ct(e,0,[Ze.NAME,Ze.NUMBER,Ze.NUMBER]),a=sp(ne.book,Wn.BOARD,n),o=Za(...a);if(se(o)){const c=Gx(e,s);pYe(ne.board.id,o.id,i,r,c.pt1,c.pt2,c.targetset)}return 0}).command("weave",(t,e)=>{var a,o;if(!se(ne.book)||!se(ne.board))return 0;const[n,i]=Ct(e,0,[Ze.DIR]),r={x:n.x-(((a=ne.element)==null?void 0:a.x)??0),y:n.y-(((o=ne.element)==null?void 0:o.y)??0)},s=Gx(e,i);return vYe(ne.board.id,r,s.pt1,s.pt2,s.targetset),0}).command("pivot",(t,e)=>{if(!se(ne.book)||!se(ne.board))return 0;const[n,i]=Ct(e,0,[Ze.NUMBER]),r=Gx(e,i);return sYe(ne.board.id,pde(n),r.pt1,r.pt2,r.targetset),0});var GY=(t=>(t[t.ERROR=0]="ERROR",t[t.CLI=1]="CLI",t[t.LOADER=2]="LOADER",t[t.RUNTIME=3]="RUNTIME",t))(GY||{});const bYe={audio:EY,board:D$e,cli:v9e,display:_9e,element:C9e,runtime:iYe,lifecycle:A9e,loader:$9e,network:W9e,transform:yYe},W5=["audio","board","display","network","transform","lifecycle","element"],EYe={0:[],1:["cli",...W5],2:["loader",...W5],3:["runtime",...W5]},SYe={0:new Map,1:new Map,2:new Map,3:new Map};function JI(t){return(EYe[t]??[]).map(n=>bYe[n]).filter(se)}function TYe(t,e){const n=SYe[t];if(!n.has(e)){let i;const r=JI(t);for(let s=0;s<r.length&&(i=r[s].getcommand(e),!se(i));++s);n.set(e,i)}return n.get(e)}function xYe(t,e,n){const i=JI(t);for(let r=0;r<i.length;++r){const s=i[r];if(s.get!==void 0){const[a,o]=s.get(e,n);if(a)return[a,o]}}return[!1,void 0]}function wYe(t,e,n,i){const r=JI(t);for(let s=0;s<r.length;++s){const a=r[s];if(a.set!==void 0){const[o]=a.set(e,n,i);if(o)return[o,i]}}return[!1,void 0]}function CYe(t,e){const n=JI(t);for(let i=0;i<n.length;++i)n[i].tick(e)}function Lie(t,e){const n=JI(t);for(let i=0;i<n.length;++i)n[i].everytick(e)}var F0e={},z0e={},H0e={};const Uie="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".split("");H0e.encode=function(t){if(0<=t&&t<Uie.length)return Uie[t];throw new TypeError("Must be between 0 and 63: "+t)};const AYe=H0e,j0e=5,V0e=1<<j0e,RYe=V0e-1,MYe=V0e;function OYe(t){return t<0?(-t<<1)+1:(t<<1)+0}z0e.encode=function(e){let n="",i,r=OYe(e);do i=r&RYe,r>>>=j0e,r>0&&(i|=MYe),n+=AYe.encode(i);while(r>0);return n};var QI={};(function(t){function e(R,I,k){if(I in R)return R[I];if(arguments.length===3)return k;throw new Error('"'+I+'" is a required argument.')}t.getArg=e;const n=/^(?:([\w+\-.]+):)?\/\/(?:(\w+:\w+)@)?([\w.-]*)(?::(\d+))?(.*)$/,i=/^data:.+\,.+$/;function r(R){const I=R.match(n);return I?{scheme:I[1],auth:I[2],host:I[3],port:I[4],path:I[5]}:null}t.urlParse=r;function s(R){let I="";return R.scheme&&(I+=R.scheme+":"),I+="//",R.auth&&(I+=R.auth+"@"),R.host&&(I+=R.host),R.port&&(I+=":"+R.port),R.path&&(I+=R.path),I}t.urlGenerate=s;const a=32;function o(R){const I=[];return function(k){for(let U=0;U<I.length;U++)if(I[U].input===k){const G=I[0];return I[0]=I[U],I[U]=G,I[0].result}const P=R(k);return I.unshift({input:k,result:P}),I.length>a&&I.pop(),P}}const c=o(function(I){let k=I;const P=r(I);if(P){if(!P.path)return I;k=P.path}const U=t.isAbsolute(k),G=[];let $=0,q=0;for(;;)if($=q,q=k.indexOf("/",$),q===-1){G.push(k.slice($));break}else for(G.push(k.slice($,q));q<k.length&&k[q]==="/";)q++;let Y=0;for(q=G.length-1;q>=0;q--){const ie=G[q];ie==="."?G.splice(q,1):ie===".."?Y++:Y>0&&(ie===""?(G.splice(q+1,Y),Y=0):(G.splice(q,2),Y--))}return k=G.join("/"),k===""&&(k=U?"/":"."),P?(P.path=k,s(P)):k});t.normalize=c;function l(R,I){R===""&&(R="."),I===""&&(I=".");const k=r(I),P=r(R);if(P&&(R=P.path||"/"),k&&!k.scheme)return P&&(k.scheme=P.scheme),s(k);if(k||I.match(i))return I;if(P&&!P.host&&!P.path)return P.host=I,s(P);const U=I.charAt(0)==="/"?I:c(R.replace(/\/+$/,"")+"/"+I);return P?(P.path=U,s(P)):U}t.join=l,t.isAbsolute=function(R){return R.charAt(0)==="/"||n.test(R)};function u(R,I){R===""&&(R="."),R=R.replace(/\/$/,"");let k=0;for(;I.indexOf(R+"/")!==0;){const P=R.lastIndexOf("/");if(P<0||(R=R.slice(0,P),R.match(/^([^\/]+:\/)?\/*$/)))return I;++k}return Array(k+1).join("../")+I.substr(R.length+1)}t.relative=u;const h=function(){return!("__proto__"in Object.create(null))}();function f(R){return R}function d(R){return g(R)?"$"+R:R}t.toSetString=h?f:d;function p(R){return g(R)?R.slice(1):R}t.fromSetString=h?f:p;function g(R){if(!R)return!1;const I=R.length;if(I<9||R.charCodeAt(I-1)!==95||R.charCodeAt(I-2)!==95||R.charCodeAt(I-3)!==111||R.charCodeAt(I-4)!==116||R.charCodeAt(I-5)!==111||R.charCodeAt(I-6)!==114||R.charCodeAt(I-7)!==112||R.charCodeAt(I-8)!==95||R.charCodeAt(I-9)!==95)return!1;for(let k=I-10;k>=0;k--)if(R.charCodeAt(k)!==36)return!1;return!0}function y(R,I,k){let P=b(R.source,I.source);return P!==0||(P=R.originalLine-I.originalLine,P!==0)||(P=R.originalColumn-I.originalColumn,P!==0||k)||(P=R.generatedColumn-I.generatedColumn,P!==0)||(P=R.generatedLine-I.generatedLine,P!==0)?P:b(R.name,I.name)}t.compareByOriginalPositions=y;function v(R,I,k){let P=R.generatedLine-I.generatedLine;return P!==0||(P=R.generatedColumn-I.generatedColumn,P!==0||k)||(P=b(R.source,I.source),P!==0)||(P=R.originalLine-I.originalLine,P!==0)||(P=R.originalColumn-I.originalColumn,P!==0)?P:b(R.name,I.name)}t.compareByGeneratedPositionsDeflated=v;function b(R,I){return R===I?0:R===null?1:I===null?-1:R>I?1:-1}function T(R,I){let k=R.generatedLine-I.generatedLine;return k!==0||(k=R.generatedColumn-I.generatedColumn,k!==0)||(k=b(R.source,I.source),k!==0)||(k=R.originalLine-I.originalLine,k!==0)||(k=R.originalColumn-I.originalColumn,k!==0)?k:b(R.name,I.name)}t.compareByGeneratedPositionsInflated=T;function x(R){return JSON.parse(R.replace(/^\)]}'[^\n]*\n/,""))}t.parseSourceMapInput=x;function M(R,I,k){if(I=I||"",R&&(R[R.length-1]!=="/"&&I[0]!=="/"&&(R+="/"),I=R+I),k){const P=r(k);if(!P)throw new Error("sourceMapURL could not be parsed");if(P.path){const U=P.path.lastIndexOf("/");U>=0&&(P.path=P.path.substring(0,U+1))}I=l(s(P),I)}return c(I)}t.computeSourceURL=M})(QI);var qY={};let NYe=class G0e{constructor(){this._array=[],this._set=new Map}static fromArray(e,n){const i=new G0e;for(let r=0,s=e.length;r<s;r++)i.add(e[r],n);return i}size(){return this._set.size}add(e,n){const i=this.has(e),r=this._array.length;(!i||n)&&this._array.push(e),i||this._set.set(e,r)}has(e){return this._set.has(e)}indexOf(e){const n=this._set.get(e);if(n>=0)return n;throw new Error('"'+e+'" is not in the set.')}at(e){if(e>=0&&e<this._array.length)return this._array[e];throw new Error("No element indexed by "+e)}toArray(){return this._array.slice()}};qY.ArraySet=NYe;var q0e={};const $0e=QI;function IYe(t,e){const n=t.generatedLine,i=e.generatedLine,r=t.generatedColumn,s=e.generatedColumn;return i>n||i==n&&s>=r||$0e.compareByGeneratedPositionsInflated(t,e)<=0}let kYe=class{constructor(){this._array=[],this._sorted=!0,this._last={generatedLine:-1,generatedColumn:0}}unsortedForEach(e,n){this._array.forEach(e,n)}add(e){IYe(this._last,e)?(this._last=e,this._array.push(e)):(this._sorted=!1,this._array.push(e))}toArray(){return this._sorted||(this._array.sort($0e.compareByGeneratedPositionsInflated),this._sorted=!0),this._array}};q0e.MappingList=kYe;const FR=z0e,sc=QI,xP=qY.ArraySet,DYe=q0e.MappingList;let W0e=class Y0e{constructor(e){e||(e={}),this._file=sc.getArg(e,"file",null),this._sourceRoot=sc.getArg(e,"sourceRoot",null),this._skipValidation=sc.getArg(e,"skipValidation",!1),this._sources=new xP,this._names=new xP,this._mappings=new DYe,this._sourcesContents=null}static fromSourceMap(e){const n=e.sourceRoot,i=new Y0e({file:e.file,sourceRoot:n});return e.eachMapping(function(r){const s={generated:{line:r.generatedLine,column:r.generatedColumn}};r.source!=null&&(s.source=r.source,n!=null&&(s.source=sc.relative(n,s.source)),s.original={line:r.originalLine,column:r.originalColumn},r.name!=null&&(s.name=r.name)),i.addMapping(s)}),e.sources.forEach(function(r){let s=r;n!==null&&(s=sc.relative(n,r)),i._sources.has(s)||i._sources.add(s);const a=e.sourceContentFor(r);a!=null&&i.setSourceContent(r,a)}),i}addMapping(e){const n=sc.getArg(e,"generated"),i=sc.getArg(e,"original",null);let r=sc.getArg(e,"source",null),s=sc.getArg(e,"name",null);this._skipValidation||this._validateMapping(n,i,r,s),r!=null&&(r=String(r),this._sources.has(r)||this._sources.add(r)),s!=null&&(s=String(s),this._names.has(s)||this._names.add(s)),this._mappings.add({generatedLine:n.line,generatedColumn:n.column,originalLine:i!=null&&i.line,originalColumn:i!=null&&i.column,source:r,name:s})}setSourceContent(e,n){let i=e;this._sourceRoot!=null&&(i=sc.relative(this._sourceRoot,i)),n!=null?(this._sourcesContents||(this._sourcesContents=Object.create(null)),this._sourcesContents[sc.toSetString(i)]=n):this._sourcesContents&&(delete this._sourcesContents[sc.toSetString(i)],Object.keys(this._sourcesContents).length===0&&(this._sourcesContents=null))}applySourceMap(e,n,i){let r=n;if(n==null){if(e.file==null)throw new Error(`SourceMapGenerator.prototype.applySourceMap requires either an explicit source file, or the source map's "file" property. Both were omitted.`);r=e.file}const s=this._sourceRoot;s!=null&&(r=sc.relative(s,r));const a=this._mappings.toArray().length>0?new xP:this._sources,o=new xP;this._mappings.unsortedForEach(function(c){if(c.source===r&&c.originalLine!=null){const h=e.originalPositionFor({line:c.originalLine,column:c.originalColumn});h.source!=null&&(c.source=h.source,i!=null&&(c.source=sc.join(i,c.source)),s!=null&&(c.source=sc.relative(s,c.source)),c.originalLine=h.line,c.originalColumn=h.column,h.name!=null&&(c.name=h.name))}const l=c.source;l!=null&&!a.has(l)&&a.add(l);const u=c.name;u!=null&&!o.has(u)&&o.add(u)},this),this._sources=a,this._names=o,e.sources.forEach(function(c){const l=e.sourceContentFor(c);l!=null&&(i!=null&&(c=sc.join(i,c)),s!=null&&(c=sc.relative(s,c)),this.setSourceContent(c,l))},this)}_validateMapping(e,n,i,r){if(n&&typeof n.line!="number"&&typeof n.column!="number")throw new Error("original.line and original.column are not numbers -- you probably meant to omit the original mapping entirely and only map the generated position. If so, pass null for the original mapping instead of an object with empty or null values.");if(!(e&&"line"in e&&"column"in e&&e.line>0&&e.column>=0&&!n&&!i&&!r)){if(!(e&&"line"in e&&"column"in e&&n&&"line"in n&&"column"in n&&e.line>0&&e.column>=0&&n.line>0&&n.column>=0&&i))throw new Error("Invalid mapping: "+JSON.stringify({generated:e,source:i,original:n,name:r}))}}_serializeMappings(){let e=0,n=1,i=0,r=0,s=0,a=0,o="",c,l,u,h;const f=this._mappings.toArray();for(let d=0,p=f.length;d<p;d++){if(l=f[d],c="",l.generatedLine!==n)for(e=0;l.generatedLine!==n;)c+=";",n++;else if(d>0){if(!sc.compareByGeneratedPositionsInflated(l,f[d-1]))continue;c+=","}c+=FR.encode(l.generatedColumn-e),e=l.generatedColumn,l.source!=null&&(h=this._sources.indexOf(l.source),c+=FR.encode(h-a),a=h,c+=FR.encode(l.originalLine-1-r),r=l.originalLine-1,c+=FR.encode(l.originalColumn-i),i=l.originalColumn,l.name!=null&&(u=this._names.indexOf(l.name),c+=FR.encode(u-s),s=u)),o+=c}return o}_generateSourcesContent(e,n){return e.map(function(i){if(!this._sourcesContents)return null;n!=null&&(i=sc.relative(n,i));const r=sc.toSetString(i);return Object.prototype.hasOwnProperty.call(this._sourcesContents,r)?this._sourcesContents[r]:null},this)}toJSON(){const e={version:this._version,sources:this._sources.toArray(),names:this._names.toArray(),mappings:this._serializeMappings()};return this._file!=null&&(e.file=this._file),this._sourceRoot!=null&&(e.sourceRoot=this._sourceRoot),this._sourcesContents&&(e.sourcesContent=this._generateSourcesContent(e.sources,e.sourceRoot)),e}toString(){return JSON.stringify(this.toJSON())}};W0e.prototype._version=3;F0e.SourceMapGenerator=W0e;var X0e={};(function(t){t.GREATEST_LOWER_BOUND=1,t.LEAST_UPPER_BOUND=2;function e(n,i,r,s,a,o){const c=Math.floor((i-n)/2)+n,l=a(r,s[c],!0);return l===0?c:l>0?i-c>1?e(c,i,r,s,a,o):o==t.LEAST_UPPER_BOUND?i<s.length?i:-1:c:c-n>1?e(n,c,r,s,a,o):o==t.LEAST_UPPER_BOUND?c:n<0?-1:n}t.search=function(i,r,s,a){if(r.length===0)return-1;let o=e(-1,r.length,i,r,s,a||t.GREATEST_LOWER_BOUND);if(o<0)return-1;for(;o-1>=0&&s(r[o],r[o-1],!0)===0;)--o;return o}})(X0e);var hM={exports:{}};const PYe={},wq=Object.freeze(Object.defineProperty({__proto__:null,default:PYe},Symbol.toStringTag,{value:"Module"})),n1=koe(wq),LYe=(function(){return typeof window<"u"&&this===window}).call();if(LYe){let t=null;hM.exports=function(){if(typeof t=="string")return fetch(t).then(n=>n.arrayBuffer());if(t instanceof ArrayBuffer)return Promise.resolve(t);throw new Error("You must provide the string URL or ArrayBuffer contents of lib/mappings.wasm by calling SourceMapConsumer.initialize({ 'lib/mappings.wasm': ... }) before using SourceMapConsumer")},hM.exports.initialize=e=>t=e}else{const t=n1,e=n1;hM.exports=function(){return new Promise((i,r)=>{const s=e.join(__dirname,"mappings.wasm");t.readFile(s,null,(a,o)=>{if(a){r(a);return}i(o.buffer)})})},hM.exports.initialize=n=>{console.debug("SourceMapConsumer.initialize is a no-op when running in node.js")}}var K0e=hM.exports;const UYe=K0e;function BYe(){this.generatedLine=0,this.generatedColumn=0,this.lastGeneratedColumn=null,this.source=null,this.originalLine=null,this.originalColumn=null,this.name=null}let zR=null;var FYe=function(){if(zR)return zR;const e=[];return zR=UYe().then(n=>WebAssembly.instantiate(n,{env:{mapping_callback(i,r,s,a,o,c,l,u,h,f){const d=new BYe;d.generatedLine=i+1,d.generatedColumn=r,s&&(d.lastGeneratedColumn=a-1),o&&(d.source=c,d.originalLine=l+1,d.originalColumn=u,h&&(d.name=f)),e[e.length-1](d)},start_all_generated_locations_for(){console.time("all_generated_locations_for")},end_all_generated_locations_for(){console.timeEnd("all_generated_locations_for")},start_compute_column_spans(){console.time("compute_column_spans")},end_compute_column_spans(){console.timeEnd("compute_column_spans")},start_generated_location_for(){console.time("generated_location_for")},end_generated_location_for(){console.timeEnd("generated_location_for")},start_original_location_for(){console.time("original_location_for")},end_original_location_for(){console.timeEnd("original_location_for")},start_parse_mappings(){console.time("parse_mappings")},end_parse_mappings(){console.timeEnd("parse_mappings")},start_sort_by_generated_location(){console.time("sort_by_generated_location")},end_sort_by_generated_location(){console.timeEnd("sort_by_generated_location")},start_sort_by_original_location(){console.time("sort_by_original_location")},end_sort_by_original_location(){console.timeEnd("sort_by_original_location")}}})).then(n=>({exports:n.instance.exports,withMappingCallback:(i,r)=>{e.push(i);try{r()}finally{e.pop()}}})).then(null,n=>{throw zR=null,n}),zR};const ii=QI,Y5=X0e,_3=qY.ArraySet,zYe=K0e,HYe=FYe,$Y=Symbol("smcInternal");class zo{constructor(e,n){return e==$Y?Promise.resolve(this):VYe(e,n)}static initialize(e){zYe.initialize(e["lib/mappings.wasm"])}static fromSourceMap(e,n){return GYe(e,n)}static async with(e,n,i){const r=await new zo(e,n);try{return await i(r)}finally{r.destroy()}}_parseMappings(e,n){throw new Error("Subclasses must implement _parseMappings")}eachMapping(e,n,i){throw new Error("Subclasses must implement eachMapping")}allGeneratedPositionsFor(e){throw new Error("Subclasses must implement allGeneratedPositionsFor")}destroy(){throw new Error("Subclasses must implement destroy")}}zo.prototype._version=3;zo.GENERATED_ORDER=1;zo.ORIGINAL_ORDER=2;zo.GREATEST_LOWER_BOUND=1;zo.LEAST_UPPER_BOUND=2;class ek extends zo{constructor(e,n){return super($Y).then(i=>{let r=e;typeof e=="string"&&(r=ii.parseSourceMapInput(e));const s=ii.getArg(r,"version");let a=ii.getArg(r,"sources");const o=ii.getArg(r,"names",[]);let c=ii.getArg(r,"sourceRoot",null);const l=ii.getArg(r,"sourcesContent",null),u=ii.getArg(r,"mappings"),h=ii.getArg(r,"file",null);if(s!=i._version)throw new Error("Unsupported version: "+s);return c&&(c=ii.normalize(c)),a=a.map(String).map(ii.normalize).map(function(f){return c&&ii.isAbsolute(c)&&ii.isAbsolute(f)?ii.relative(c,f):f}),i._names=_3.fromArray(o.map(String),!0),i._sources=_3.fromArray(a,!0),i._absoluteSources=i._sources.toArray().map(function(f){return ii.computeSourceURL(c,f,n)}),i.sourceRoot=c,i.sourcesContent=l,i._mappings=u,i._sourceMapURL=n,i.file=h,i._computedColumnSpans=!1,i._mappingsPtr=0,i._wasm=null,HYe().then(f=>(i._wasm=f,i))})}_findSourceIndex(e){let n=e;if(this.sourceRoot!=null&&(n=ii.relative(this.sourceRoot,n)),this._sources.has(n))return this._sources.indexOf(n);for(let i=0;i<this._absoluteSources.length;++i)if(this._absoluteSources[i]==e)return i;return-1}static fromSourceMap(e,n){return new ek(e.toString())}get sources(){return this._absoluteSources.slice()}_getMappingsPtr(){return this._mappingsPtr===0&&this._parseMappings(this._mappings,this.sourceRoot),this._mappingsPtr}_parseMappings(e,n){const i=e.length,r=this._wasm.exports.allocate_mappings(i),s=new Uint8Array(this._wasm.exports.memory.buffer,r,i);for(let o=0;o<i;o++)s[o]=e.charCodeAt(o);const a=this._wasm.exports.parse_mappings(r);if(!a){const o=this._wasm.exports.get_last_error();let c=`Error parsing mappings (code ${o}): `;switch(o){case 1:c+="the mappings contained a negative line, column, source index, or name index";break;case 2:c+="the mappings contained a number larger than 2**32";break;case 3:c+="reached EOF while in the middle of parsing a VLQ";break;case 4:c+="invalid base 64 character while parsing a VLQ";break;default:c+="unknown error code";break}throw new Error(c)}this._mappingsPtr=a}eachMapping(e,n,i){const r=n||null,s=i||zo.GENERATED_ORDER,a=this.sourceRoot;this._wasm.withMappingCallback(o=>{o.source!==null&&(o.source=this._sources.at(o.source),o.source=ii.computeSourceURL(a,o.source,this._sourceMapURL),o.name!==null&&(o.name=this._names.at(o.name))),e.call(r,o)},()=>{switch(s){case zo.GENERATED_ORDER:this._wasm.exports.by_generated_location(this._getMappingsPtr());break;case zo.ORIGINAL_ORDER:this._wasm.exports.by_original_location(this._getMappingsPtr());break;default:throw new Error("Unknown order of iteration.")}})}allGeneratedPositionsFor(e){let n=ii.getArg(e,"source");const i=ii.getArg(e,"line"),r=e.column||0;if(n=this._findSourceIndex(n),n<0)return[];if(i<1)throw new Error("Line numbers must be >= 1");if(r<0)throw new Error("Column numbers must be >= 0");const s=[];return this._wasm.withMappingCallback(a=>{let o=a.lastGeneratedColumn;this._computedColumnSpans&&o===null&&(o=1/0),s.push({line:a.generatedLine,column:a.generatedColumn,lastColumn:o})},()=>{this._wasm.exports.all_generated_locations_for(this._getMappingsPtr(),n,i-1,"column"in e,r)}),s}destroy(){this._mappingsPtr!==0&&(this._wasm.exports.free_mappings(this._mappingsPtr),this._mappingsPtr=0)}computeColumnSpans(){this._computedColumnSpans||(this._wasm.exports.compute_column_spans(this._getMappingsPtr()),this._computedColumnSpans=!0)}originalPositionFor(e){const n={generatedLine:ii.getArg(e,"line"),generatedColumn:ii.getArg(e,"column")};if(n.generatedLine<1)throw new Error("Line numbers must be >= 1");if(n.generatedColumn<0)throw new Error("Column numbers must be >= 0");let i=ii.getArg(e,"bias",zo.GREATEST_LOWER_BOUND);i==null&&(i=zo.GREATEST_LOWER_BOUND);let r;if(this._wasm.withMappingCallback(s=>r=s,()=>{this._wasm.exports.original_location_for(this._getMappingsPtr(),n.generatedLine-1,n.generatedColumn,i)}),r&&r.generatedLine===n.generatedLine){let s=ii.getArg(r,"source",null);s!==null&&(s=this._sources.at(s),s=ii.computeSourceURL(this.sourceRoot,s,this._sourceMapURL));let a=ii.getArg(r,"name",null);return a!==null&&(a=this._names.at(a)),{source:s,line:ii.getArg(r,"originalLine",null),column:ii.getArg(r,"originalColumn",null),name:a}}return{source:null,line:null,column:null,name:null}}hasContentsOfAllSources(){return this.sourcesContent?this.sourcesContent.length>=this._sources.size()&&!this.sourcesContent.some(function(e){return e==null}):!1}sourceContentFor(e,n){if(!this.sourcesContent)return null;const i=this._findSourceIndex(e);if(i>=0)return this.sourcesContent[i];let r=e;this.sourceRoot!=null&&(r=ii.relative(this.sourceRoot,r));let s;if(this.sourceRoot!=null&&(s=ii.urlParse(this.sourceRoot))){const a=r.replace(/^file:\/\//,"");if(s.scheme=="file"&&this._sources.has(a))return this.sourcesContent[this._sources.indexOf(a)];if((!s.path||s.path=="/")&&this._sources.has("/"+r))return this.sourcesContent[this._sources.indexOf("/"+r)]}if(n)return null;throw new Error('"'+r+'" is not in the SourceMap.')}generatedPositionFor(e){let n=ii.getArg(e,"source");if(n=this._findSourceIndex(n),n<0)return{line:null,column:null,lastColumn:null};const i={source:n,originalLine:ii.getArg(e,"line"),originalColumn:ii.getArg(e,"column")};if(i.originalLine<1)throw new Error("Line numbers must be >= 1");if(i.originalColumn<0)throw new Error("Column numbers must be >= 0");let r=ii.getArg(e,"bias",zo.GREATEST_LOWER_BOUND);r==null&&(r=zo.GREATEST_LOWER_BOUND);let s;if(this._wasm.withMappingCallback(a=>s=a,()=>{this._wasm.exports.generated_location_for(this._getMappingsPtr(),i.source,i.originalLine-1,i.originalColumn,r)}),s&&s.source===i.source){let a=s.lastGeneratedColumn;return this._computedColumnSpans&&a===null&&(a=1/0),{line:ii.getArg(s,"generatedLine",null),column:ii.getArg(s,"generatedColumn",null),lastColumn:a}}return{line:null,column:null,lastColumn:null}}}ek.prototype.consumer=zo;class jYe extends zo{constructor(e,n){return super($Y).then(i=>{let r=e;typeof e=="string"&&(r=ii.parseSourceMapInput(e));const s=ii.getArg(r,"version"),a=ii.getArg(r,"sections");if(s!=i._version)throw new Error("Unsupported version: "+s);i._sources=new _3,i._names=new _3,i.__generatedMappings=null,i.__originalMappings=null,i.__generatedMappingsUnsorted=null,i.__originalMappingsUnsorted=null;let o={line:-1,column:0};return Promise.all(a.map(c=>{if(c.url)throw new Error("Support for url field in sections not implemented.");const l=ii.getArg(c,"offset"),u=ii.getArg(l,"line"),h=ii.getArg(l,"column");if(u<o.line||u===o.line&&h<o.column)throw new Error("Section offsets must be ordered and non-overlapping.");return o=l,new zo(ii.getArg(c,"map"),n).then(d=>({generatedOffset:{generatedLine:u+1,generatedColumn:h+1},consumer:d}))})).then(c=>(i._sections=c,i))})}get _generatedMappings(){return this.__generatedMappings||this._sortGeneratedMappings(),this.__generatedMappings}get _originalMappings(){return this.__originalMappings||this._sortOriginalMappings(),this.__originalMappings}get _generatedMappingsUnsorted(){return this.__generatedMappingsUnsorted||this._parseMappings(this._mappings,this.sourceRoot),this.__generatedMappingsUnsorted}get _originalMappingsUnsorted(){return this.__originalMappingsUnsorted||this._parseMappings(this._mappings,this.sourceRoot),this.__originalMappingsUnsorted}_sortGeneratedMappings(){const e=this._generatedMappingsUnsorted;e.sort(ii.compareByGeneratedPositionsDeflated),this.__generatedMappings=e}_sortOriginalMappings(){const e=this._originalMappingsUnsorted;e.sort(ii.compareByOriginalPositions),this.__originalMappings=e}get sources(){const e=[];for(let n=0;n<this._sections.length;n++)for(let i=0;i<this._sections[n].consumer.sources.length;i++)e.push(this._sections[n].consumer.sources[i]);return e}originalPositionFor(e){const n={generatedLine:ii.getArg(e,"line"),generatedColumn:ii.getArg(e,"column")},i=Y5.search(n,this._sections,function(s,a){const o=s.generatedLine-a.generatedOffset.generatedLine;return o||s.generatedColumn-a.generatedOffset.generatedColumn}),r=this._sections[i];return r?r.consumer.originalPositionFor({line:n.generatedLine-(r.generatedOffset.generatedLine-1),column:n.generatedColumn-(r.generatedOffset.generatedLine===n.generatedLine?r.generatedOffset.generatedColumn-1:0),bias:e.bias}):{source:null,line:null,column:null,name:null}}hasContentsOfAllSources(){return this._sections.every(function(e){return e.consumer.hasContentsOfAllSources()})}sourceContentFor(e,n){for(let i=0;i<this._sections.length;i++){const s=this._sections[i].consumer.sourceContentFor(e,!0);if(s)return s}if(n)return null;throw new Error('"'+e+'" is not in the SourceMap.')}generatedPositionFor(e){for(let n=0;n<this._sections.length;n++){const i=this._sections[n];if(i.consumer._findSourceIndex(ii.getArg(e,"source"))===-1)continue;const r=i.consumer.generatedPositionFor(e);if(r)return{line:r.line+(i.generatedOffset.generatedLine-1),column:r.column+(i.generatedOffset.generatedLine===r.line?i.generatedOffset.generatedColumn-1:0)}}return{line:null,column:null}}_parseMappings(e,n){const i=this.__generatedMappingsUnsorted=[],r=this.__originalMappingsUnsorted=[];for(let s=0;s<this._sections.length;s++){const a=this._sections[s],o=[];a.consumer.eachMapping(c=>o.push(c));for(let c=0;c<o.length;c++){const l=o[c];let u=ii.computeSourceURL(a.consumer.sourceRoot,null,this._sourceMapURL);this._sources.add(u),u=this._sources.indexOf(u);let h=null;l.name&&(this._names.add(l.name),h=this._names.indexOf(l.name));const f={source:u,generatedLine:l.generatedLine+(a.generatedOffset.generatedLine-1),generatedColumn:l.generatedColumn+(a.generatedOffset.generatedLine===l.generatedLine?a.generatedOffset.generatedColumn-1:0),originalLine:l.originalLine,originalColumn:l.originalColumn,name:h};i.push(f),typeof f.originalLine=="number"&&r.push(f)}}}eachMapping(e,n,i){const r=n||null,s=i||zo.GENERATED_ORDER;let a;switch(s){case zo.GENERATED_ORDER:a=this._generatedMappings;break;case zo.ORIGINAL_ORDER:a=this._originalMappings;break;default:throw new Error("Unknown order of iteration.")}const o=this.sourceRoot;a.map(function(c){let l=null;return c.source!==null&&(l=this._sources.at(c.source),l=ii.computeSourceURL(o,l,this._sourceMapURL)),{source:l,generatedLine:c.generatedLine,generatedColumn:c.generatedColumn,originalLine:c.originalLine,originalColumn:c.originalColumn,name:c.name===null?null:this._names.at(c.name)}},this).forEach(e,r)}_findMapping(e,n,i,r,s,a){if(e[i]<=0)throw new TypeError("Line must be greater than or equal to 1, got "+e[i]);if(e[r]<0)throw new TypeError("Column must be greater than or equal to 0, got "+e[r]);return Y5.search(e,n,s,a)}allGeneratedPositionsFor(e){const n=ii.getArg(e,"line"),i={source:ii.getArg(e,"source"),originalLine:n,originalColumn:ii.getArg(e,"column",0)};if(i.source=this._findSourceIndex(i.source),i.source<0)return[];if(i.originalLine<1)throw new Error("Line numbers must be >= 1");if(i.originalColumn<0)throw new Error("Column numbers must be >= 0");const r=[];let s=this._findMapping(i,this._originalMappings,"originalLine","originalColumn",ii.compareByOriginalPositions,Y5.LEAST_UPPER_BOUND);if(s>=0){let a=this._originalMappings[s];if(e.column===void 0){const o=a.originalLine;for(;a&&a.originalLine===o;){let c=a.lastGeneratedColumn;this._computedColumnSpans&&c===null&&(c=1/0),r.push({line:ii.getArg(a,"generatedLine",null),column:ii.getArg(a,"generatedColumn",null),lastColumn:c}),a=this._originalMappings[++s]}}else{const o=a.originalColumn;for(;a&&a.originalLine===n&&a.originalColumn==o;){let c=a.lastGeneratedColumn;this._computedColumnSpans&&c===null&&(c=1/0),r.push({line:ii.getArg(a,"generatedLine",null),column:ii.getArg(a,"generatedColumn",null),lastColumn:c}),a=this._originalMappings[++s]}}}return r}destroy(){for(let e=0;e<this._sections.length;e++)this._sections[e].consumer.destroy()}}function VYe(t,e){let n=t;typeof t=="string"&&(n=ii.parseSourceMapInput(t));const i=n.sections!=null?new jYe(n,e):new ek(n,e);return Promise.resolve(i)}function GYe(t,e){return ek.fromSourceMap(t,e)}var Z0e={};const qYe=F0e.SourceMapGenerator,wP=QI,$Ye=/(\r?\n)/,WYe=10,qx="$$$isSourceNode$$$";let YYe=class Cq{constructor(e,n,i,r,s){this.children=[],this.sourceContents={},this.line=e??null,this.column=n??null,this.source=i??null,this.name=s??null,this[qx]=!0,r!=null&&this.add(r)}static fromStringWithSourceMap(e,n,i){const r=new Cq,s=e.split($Ye);let a=0;const o=function(){const d=g(),p=g()||"";return d+p;function g(){return a<s.length?s[a++]:void 0}};let c=1,l=0,u=null,h;return n.eachMapping(function(d){if(u!==null)if(c<d.generatedLine)f(u,o()),c++,l=0;else{h=s[a]||"";const p=h.substr(0,d.generatedColumn-l);s[a]=h.substr(d.generatedColumn-l),l=d.generatedColumn,f(u,p),u=d;return}for(;c<d.generatedLine;)r.add(o()),c++;l<d.generatedColumn&&(h=s[a]||"",r.add(h.substr(0,d.generatedColumn)),s[a]=h.substr(d.generatedColumn),l=d.generatedColumn),u=d},this),a<s.length&&(u&&f(u,o()),r.add(s.splice(a).join(""))),n.sources.forEach(function(d){const p=n.sourceContentFor(d);p!=null&&(i!=null&&(d=wP.join(i,d)),r.setSourceContent(d,p))}),r;function f(d,p){if(d===null||d.source===void 0)r.add(p);else{const g=i?wP.join(i,d.source):d.source;r.add(new Cq(d.originalLine,d.originalColumn,g,p,d.name))}}}add(e){if(Array.isArray(e))e.forEach(function(n){this.add(n)},this);else if(e[qx]||typeof e=="string")e&&this.children.push(e);else throw new TypeError("Expected a SourceNode, string, or an array of SourceNodes and strings. Got "+e);return this}prepend(e){if(Array.isArray(e))for(let n=e.length-1;n>=0;n--)this.prepend(e[n]);else if(e[qx]||typeof e=="string")this.children.unshift(e);else throw new TypeError("Expected a SourceNode, string, or an array of SourceNodes and strings. Got "+e);return this}walk(e){let n;for(let i=0,r=this.children.length;i<r;i++)n=this.children[i],n[qx]?n.walk(e):n!==""&&e(n,{source:this.source,line:this.line,column:this.column,name:this.name})}join(e){let n,i;const r=this.children.length;if(r>0){for(n=[],i=0;i<r-1;i++)n.push(this.children[i]),n.push(e);n.push(this.children[i]),this.children=n}return this}replaceRight(e,n){const i=this.children[this.children.length-1];return i[qx]?i.replaceRight(e,n):typeof i=="string"?this.children[this.children.length-1]=i.replace(e,n):this.children.push("".replace(e,n)),this}setSourceContent(e,n){this.sourceContents[wP.toSetString(e)]=n}walkSourceContents(e){for(let i=0,r=this.children.length;i<r;i++)this.children[i][qx]&&this.children[i].walkSourceContents(e);const n=Object.keys(this.sourceContents);for(let i=0,r=n.length;i<r;i++)e(wP.fromSetString(n[i]),this.sourceContents[n[i]])}toString(){let e="";return this.walk(function(n){e+=n}),e}toStringWithSourceMap(e){const n={code:"",line:1,column:0},i=new qYe(e);let r=!1,s=null,a=null,o=null,c=null;return this.walk(function(l,u){n.code+=l,u.source!==null&&u.line!==null&&u.column!==null?((s!==u.source||a!==u.line||o!==u.column||c!==u.name)&&i.addMapping({source:u.source,original:{line:u.line,column:u.column},generated:{line:n.line,column:n.column},name:u.name}),s=u.source,a=u.line,o=u.column,c=u.name,r=!0):r&&(i.addMapping({generated:{line:n.line,column:n.column}}),s=null,r=!1);for(let h=0,f=l.length;h<f;h++)l.charCodeAt(h)===WYe?(n.line++,n.column=0,h+1===f?(s=null,r=!1):r&&i.addMapping({source:u.source,original:{line:u.line,column:u.column},generated:{line:n.line,column:n.column},name:u.name})):n.column++}),this.walkSourceContents(function(l,u){i.setSourceContent(l,u)}),{code:n.code,map:i}}};Z0e.SourceNode=YYe;var XYe=Z0e.SourceNode;let Bie=0;const Fie=t0,KYe=["Command","lines"];class ZYe extends jGe{constructor(){super(yge,{traceInitPerf:t0,skipValidations:!t0,maxLookahead:2,recoveryEnabled:!0,nodeLocationTracking:"full"});Qn(this,"program",this.RULED("program",()=>{this.MANY(()=>this.SUBRULE(this.line))}));Qn(this,"line",this.RULED("line",()=>{this.OR([{ALT:()=>this.SUBRULE(this.stmt)},{ALT:()=>this.CONSUME($C)}])}));Qn(this,"stmt",this.RULED("stmt",()=>{this.OR([{ALT:()=>this.SUBRULE(this.stmt_label)},{ALT:()=>this.SUBRULE(this.stmt_stat)},{ALT:()=>this.SUBRULE(this.stmt_text)},{ALT:()=>this.SUBRULE(this.stmt_comment)},{ALT:()=>this.SUBRULE(this.stmt_hyperlink)},{ALT:()=>this.SUBRULE(this.stmt_command)},{ALT:()=>{this.AT_LEAST_ONE(()=>this.SUBRULE(this.short_commands)),this.MANY(()=>this.SUBRULE(this.commands))}}])}));Qn(this,"inline",this.RULED("inline",()=>{this.SUBRULE(this.instmt)}));Qn(this,"instmt",this.RULED("instmt",()=>{this.OR([{ALT:()=>this.SUBRULE(this.stmt_label)},{ALT:()=>this.SUBRULE(this.stmt_stat)},{ALT:()=>this.SUBRULE(this.stmt_text)},{ALT:()=>this.SUBRULE(this.stmt_comment)},{ALT:()=>this.SUBRULE(this.stmt_hyperlink)},{ALT:()=>this.SUBRULE(this.stmt_command)},{ALT:()=>this.AT_LEAST_ONE(()=>this.SUBRULE(this.commands))}])}));Qn(this,"stmt_label",this.RULED("stmt_label",()=>{this.CONSUME(W9)}));Qn(this,"stmt_stat",this.RULED("stmt_stat",()=>{this.CONSUME(GI)}));Qn(this,"stmt_text",this.RULED("stmt_text",()=>{this.OR([{ALT:()=>this.CONSUME(UF)}])}));Qn(this,"stmt_comment",this.RULED("stmt_comment",()=>{this.CONSUME($9)}));Qn(this,"stmt_hyperlink",this.RULED("stmt_hyperlink",()=>{this.CONSUME(Y9),this.SUBRULE(this.words),this.CONSUME(X9)}));Qn(this,"stmt_command",this.RULED("stmt_command",()=>{this.CONSUME(eT),this.AT_LEAST_ONE(()=>this.SUBRULE(this.commands))}));Qn(this,"short_commands",this.RULED("short_commands",()=>{this.OR([{ALT:()=>this.SUBRULE(this.short_go)},{ALT:()=>this.SUBRULE(this.short_try)}])}));Qn(this,"commands",this.RULED("commands",()=>{this.OR([{ALT:()=>this.SUBRULE(this.words)},{ALT:()=>this.SUBRULE(this.short_go)},{ALT:()=>this.SUBRULE(this.short_try)},{ALT:()=>this.SUBRULE(this.command_play)},{ALT:()=>this.SUBRULE(this.command_toast)},{ALT:()=>this.SUBRULE(this.structured_cmd)}])}));Qn(this,"structured_cmd",this.RULED("structured_cmd",()=>{this.OR([{ALT:()=>this.SUBRULE(this.command_if)},{ALT:()=>this.SUBRULE(this.command_while)},{ALT:()=>this.SUBRULE(this.command_repeat)},{ALT:()=>this.SUBRULE(this.command_waitfor)},{ALT:()=>this.SUBRULE(this.command_foreach)},{ALT:()=>this.SUBRULE(this.command_break)},{ALT:()=>this.SUBRULE(this.command_continue)}])}));Qn(this,"short_go",this.RULED("short_go",()=>{this.CONSUME(t3),this.SUBRULE(this.words)}));Qn(this,"short_try",this.RULED("short_try",()=>{this.CONSUME(cY),this.SUBRULE(this.words)}));Qn(this,"command_if",this.RULED("command_if",()=>{this.CONSUME(n3),this.SUBRULE(this.words),this.OPTION(()=>this.SUBRULE(this.command_if_block))}));Qn(this,"command_if_block",this.RULED("command_if_block",()=>{this.OR([{ALT:()=>this.SUBRULE(this.inline)},{ALT:()=>{this.CONSUME(YM),this.MANY(()=>this.SUBRULE(this.line)),this.MANY2({GATE:this.BACKTRACK(this.command_else_if),DEF:()=>this.SUBRULE(this.command_else_if)}),this.OPTION(()=>this.SUBRULE(this.command_else)),this.MANY3(()=>this.CONSUME3($C)),this.CONSUME4(eT),this.CONSUME4(i3)}}])}));Qn(this,"command_block",this.RULED("command_block",()=>{this.OR([{ALT:()=>this.SUBRULE(this.inline)},{ALT:()=>{this.CONSUME(YM),this.MANY(()=>this.SUBRULE(this.line)),this.CONSUME(eT),this.CONSUME(i3)}}])}));Qn(this,"command_fork",this.RULED("command_fork",()=>{this.OR([{ALT:()=>this.SUBRULE(this.inline)},{ALT:()=>{this.CONSUME(YM),this.MANY({GATE:this.BACKTRACK(this.line),DEF:()=>this.SUBRULE(this.line)})}}])}));Qn(this,"command_else_if",this.RULED("command_else_if",()=>{this.CONSUME(eT),this.CONSUME(r3),this.CONSUME(n3),this.SUBRULE(this.words),this.OPTION(()=>this.SUBRULE(this.command_fork))}));Qn(this,"command_else",this.RULED("command_else",()=>{this.CONSUME(eT),this.CONSUME(r3),this.OPTION(()=>this.SUBRULE(this.command_fork))}));Qn(this,"command_while",this.RULED("command_while",()=>{this.CONSUME(fY),this.SUBRULE(this.words),this.OPTION(()=>this.SUBRULE(this.command_block))}));Qn(this,"command_repeat",this.RULED("command_repeat",()=>{this.CONSUME(dY),this.SUBRULE(this.words),this.OPTION(()=>this.SUBRULE(this.command_block))}));Qn(this,"command_waitfor",this.RULED("command_waitfor",()=>{this.CONSUME(pY),this.SUBRULE(this.words)}));Qn(this,"command_foreach",this.RULED("command_foreach",()=>{this.CONSUME(mY),this.SUBRULE(this.words),this.OPTION(()=>this.SUBRULE(this.command_block))}));Qn(this,"command_break",this.RULED("command_break",()=>{this.CONSUME(gY)}));Qn(this,"command_continue",this.RULED("command_continue",()=>{this.CONSUME(vY)}));Qn(this,"command_play",this.RULED("command_play",()=>{this.CONSUME(hY)}));Qn(this,"command_toast",this.RULED("command_toast",()=>{this.CONSUME(vge)}));Qn(this,"expr",this.RULED("expr",()=>{this.SUBRULE1(this.and_test),this.MANY(()=>{this.CONSUME(KU),this.SUBRULE2(this.and_test)})}));Qn(this,"and_test",this.RULED("and_test",()=>{this.SUBRULE1(this.not_test),this.MANY(()=>{this.CONSUME(JU),this.SUBRULE2(this.not_test)})}));Qn(this,"not_test",this.RULED("not_test",()=>{this.OR([{ALT:()=>{this.CONSUME(ZU),this.SUBRULE1(this.not_test)}},{ALT:()=>this.SUBRULE2(this.comparison)}])}));Qn(this,"comparison",this.RULED("comparison",()=>{this.SUBRULE1(this.arith_expr),this.MANY(()=>{this.SUBRULE(this.comp_op),this.SUBRULE2(this.arith_expr)})}));Qn(this,"comp_op",this.RULED("comp_op",()=>{this.OR([{ALT:()=>this.CONSUME(J9)},{ALT:()=>this.CONSUME(Q9)},{ALT:()=>this.CONSUME(eY)},{ALT:()=>this.CONSUME(tY)},{ALT:()=>this.CONSUME(nY)},{ALT:()=>this.CONSUME(iY)}])}));Qn(this,"expr_value",this.RULED("expr_value",()=>{this.SUBRULE1(this.and_test_value),this.MANY(()=>{this.CONSUME(KU),this.SUBRULE2(this.and_test_value)})}));Qn(this,"and_test_value",this.RULED("and_test_value",()=>{this.SUBRULE1(this.not_test_value),this.MANY(()=>{this.CONSUME(JU),this.SUBRULE2(this.not_test_value)})}));Qn(this,"not_test_value",this.RULED("not_test_value",()=>{this.OR([{ALT:()=>{this.CONSUME(ZU),this.SUBRULE1(this.not_test_value)}},{ALT:()=>this.SUBRULE2(this.arith_expr)}])}));Qn(this,"arith_expr",this.RULED("arith_expr",()=>{this.SUBRULE1(this.term),this.MANY(()=>this.SUBRULE2(this.arith_expr_item))}));Qn(this,"arith_expr_item",this.RULED("arith_expr_item",()=>{this.OR([{ALT:()=>this.CONSUME(QU)},{ALT:()=>this.CONSUME(e3)}]),this.SUBRULE(this.term)}));Qn(this,"term",this.RULED("term",()=>{this.SUBRULE1(this.factor),this.MANY(()=>this.SUBRULE2(this.term_item))}));Qn(this,"term_item",this.RULED("term_item",()=>{this.OR([{ALT:()=>this.CONSUME(sY)},{ALT:()=>this.CONSUME(t3)},{ALT:()=>this.CONSUME(aY)},{ALT:()=>this.CONSUME(oY)}]),this.SUBRULE(this.factor)}));Qn(this,"factor",this.RULED("factor",()=>{this.OR1([{ALT:()=>{this.OR2([{ALT:()=>this.CONSUME(QU)},{ALT:()=>this.CONSUME(e3)}]),this.SUBRULE(this.factor)}},{ALT:()=>this.SUBRULE(this.power)}])}));Qn(this,"power",this.RULED("power",()=>{this.SUBRULE(this.token),this.OPTION(()=>{this.CONSUME(rY),this.SUBRULE(this.factor)})}));Qn(this,"words",this.RULED("words",()=>{this.AT_LEAST_ONE(()=>this.SUBRULE(this.expr))}));Qn(this,"token",this.RULED("token",()=>{this.OR([{ALT:()=>this.CONSUME(K9)},{ALT:()=>this.CONSUME(Sl)},{ALT:()=>this.CONSUME(Z9)},{ALT:()=>{this.CONSUME(lY),this.SUBRULE(this.words),this.CONSUME(uY)}}])}));this.performSelfAnalysis()}PEEK(n,i,...r){console.info(n,r.map(s=>[s.image,s.tokenType]),i)}RULED(n,i,r){const s=KYe.some(a=>n.includes(a));return this.RULE(n,()=>{const o=(Bie++).toString().padStart(3),c=s?"font-weight: bold;":"";if(Fie&&!this.RECORDING_PHASE){const l=[this.LA(1),this.LA(2),this.LA(3)].map(u=>`[${u.tokenType.name} ${u.image.replaceAll(`
`,"\\n")}]`);console.info(`${o}%c> ${n} ${l.join(" ")}`,c)}i(),Fie&&!this.RECORDING_PHASE&&console.info(`${o}%c< ${n} `,c),Bie--},r)}}const Nw=new ZYe;if(tqe){const t=Nw.getGAstProductions(),e=eqe(t);console.info(e)}const JYe=Nw.getBaseCstVisitorConstructor();var _n=(t=>(t[t.PROGRAM=0]="PROGRAM",t[t.API=1]="API",t[t.LINE=2]="LINE",t[t.MARK=3]="MARK",t[t.GOTO=4]="GOTO",t[t.COUNT=5]="COUNT",t[t.TEXT=6]="TEXT",t[t.LABEL=7]="LABEL",t[t.HYPERLINK=8]="HYPERLINK",t[t.STAT=9]="STAT",t[t.MOVE=10]="MOVE",t[t.COMMAND=11]="COMMAND",t[t.LITERAL=12]="LITERAL",t[t.IF=13]="IF",t[t.IF_CHECK=14]="IF_CHECK",t[t.IF_BLOCK=15]="IF_BLOCK",t[t.ELSE_IF=16]="ELSE_IF",t[t.ELSE=17]="ELSE",t[t.WHILE=18]="WHILE",t[t.BREAK=19]="BREAK",t[t.CONTINUE=20]="CONTINUE",t[t.REPEAT=21]="REPEAT",t[t.WAITFOR=22]="WAITFOR",t[t.FOREACH=23]="FOREACH",t[t.OR=24]="OR",t[t.AND=25]="AND",t[t.NOT=26]="NOT",t[t.COMPARE=27]="COMPARE",t[t.COMPARE_ITEM=28]="COMPARE_ITEM",t[t.OPERATOR=29]="OPERATOR",t[t.OPERATOR_ITEM=30]="OPERATOR_ITEM",t[t.EXPR=31]="EXPR",t))(_n||{}),YS=(t=>(t[t.IS_EQ=0]="IS_EQ",t[t.IS_NOT_EQ=1]="IS_NOT_EQ",t[t.IS_LESS_THAN=2]="IS_LESS_THAN",t[t.IS_GREATER_THAN=3]="IS_GREATER_THAN",t[t.IS_LESS_THAN_OR_EQ=4]="IS_LESS_THAN_OR_EQ",t[t.IS_GREATER_THAN_OR_EQ=5]="IS_GREATER_THAN_OR_EQ",t))(YS||{}),_g=(t=>(t[t.EMPTY=0]="EMPTY",t[t.PLUS=1]="PLUS",t[t.MINUS=2]="MINUS",t[t.POWER=3]="POWER",t[t.MULTIPLY=4]="MULTIPLY",t[t.DIVIDE=5]="DIVIDE",t[t.MOD_DIVIDE=6]="MOD_DIVIDE",t[t.FLOOR_DIVIDE=7]="FLOOR_DIVIDE",t[t.UNI_PLUS=8]="UNI_PLUS",t[t.UNI_MINUS=9]="UNI_MINUS",t))(_g||{}),N2=(t=>(t[t.NUMBER=0]="NUMBER",t[t.STRING=1]="STRING",t[t.TEMPLATE=2]="TEMPLATE",t))(N2||{});function QYe(t){return!!(t!=null&&t.tokenType)}function Dd(t,e){const[n]=t??[];return((n==null?void 0:n.image)??e).trimStart().replaceAll(/^"|"$/g,"")}class eXe extends JYe{constructor(){super();Qn(this,"unique",0);t0&&this.validateVisitor()}getnodelocation(n){const i=Object.values(n).flat().filter(r=>!!r).map(r=>r&&QYe(r)?{startLine:r.startLine,startColumn:r.startColumn,startOffset:r.startOffset,endLine:r.endLine,endColumn:r.endColumn,endOffset:r.endOffset}:r!=null&&r.location?{...r.location}:{startLine:0,startColumn:0,startOffset:0,endLine:0,endColumn:0,endOffset:0}).filter(r=>r.startLine!==0&&r.endLine!==0);return{startLine:Math.min(...i.map(r=>r.startLine??1)),startColumn:Math.min(...i.map(r=>r.startColumn??1)),startOffset:Math.min(...i.map(r=>r.startOffset??1)),endLine:Math.max(...i.map(r=>r.endLine??1)),endColumn:Math.max(...i.map(r=>r.endColumn??1)),endOffset:Math.max(...i.map(r=>r.endOffset??1))}}createcodenode(n,i){return[{...i,...this.getnodelocation(n),lineindex:0}]}createstringnode(n,i){return this.createcodenode(n,{type:12,literal:1,value:i})}createmarknode(n,i,r){return this.createlinenode(n,this.createcodenode(n,{type:3,id:i,comment:r}))}creategotonode(n,i,r){return this.createlinenode(n,this.createcodenode(n,{type:4,id:i,comment:r}))}createlinenode(n,i){return this.createcodenode(n,{type:2,stmts:i})}createapinode(n,i,r){return this.createlinenode(n,this.createcodenode(n,{type:1,words:r,method:i}))}createlogicnode(n,i,r,s){return this.createlinenode(n,this.createcodenode(n,{type:14,skip:r,words:s,method:i}))}createcountnode(n){return this.createcodenode(n,{type:5,index:this.unique++})}go(n){return Array.isArray(n)?n.map(i=>this.visit(i)).flat():se(n)?[this.visit(n)].flat():[]}program(n){return this.unique=0,this.createcodenode(n,{type:0,lines:[this.createlinenode(n,this.createcodenode(n,{type:7,active:!0,name:"restart"})),this.go(n.line)].flat()})}line(n){return n.stmt?this.go(n.stmt):[]}stmt(n){return n.stmt_label?this.go(n.stmt_label):n.stmt_stat?this.go(n.stmt_stat):n.stmt_text?this.go(n.stmt_text):n.stmt_comment?this.go(n.stmt_comment):n.stmt_command?this.go(n.stmt_command):n.stmt_hyperlink?this.go(n.stmt_hyperlink):n.short_commands?[this.go(n.short_commands),this.go(n.commands)].flat():[]}inline(n){return this.go(n.instmt)}instmt(n){return n.stmt_label?this.go(n.stmt_label):n.stmt_stat?this.go(n.stmt_stat):n.stmt_text?this.go(n.stmt_text):n.stmt_comment?this.go(n.stmt_comment):n.stmt_command?this.go(n.stmt_command):n.stmt_hyperlink?this.go(n.stmt_hyperlink):n.commands?this.go(n.commands):[]}stmt_label(n){return this.createlinenode(n,this.createcodenode(n,{type:7,active:!0,name:Dd(n.token_label,":").slice(1).trim()}))}stmt_stat(n){return this.createlinenode(n,this.createcodenode(n,{type:9,value:Dd(n.token_stat,"@").slice(1)}))}stmt_text(n){return this.createlinenode(n,this.createcodenode(n,{type:6,value:Dd(n.token_text,"")}))}stmt_comment(n){return this.createlinenode(n,this.createcodenode(n,{type:7,active:!1,name:Dd(n.token_comment,"'").slice(1).trim()}))}stmt_hyperlink(n){return this.createlinenode(n,this.createcodenode(n,{type:8,link:this.go(n.words),text:Dd(n.token_hyperlinktext,";").slice(1)}))}stmt_command(n){return n.commands?this.go(n.commands):[]}short_commands(n){return n.short_go?this.go(n.short_go):n.short_try?this.go(n.short_try):[]}commands(n){return n.words?this.createlinenode(n,this.createcodenode(n,{type:11,words:this.go(n.words)})):n.short_go?this.go(n.short_go):n.short_try?this.go(n.short_try):n.command_play?this.go(n.command_play):n.command_toast?this.go(n.command_toast):n.structured_cmd?this.go(n.structured_cmd):[]}structured_cmd(n){return n.command_if?this.go(n.command_if):n.command_while?this.go(n.command_while):n.command_repeat?this.go(n.command_repeat):n.command_waitfor?this.go(n.command_waitfor):n.command_foreach?this.go(n.command_foreach):n.command_break?this.go(n.command_break):n.command_continue?this.go(n.command_continue):[]}short_go(n){return n.token_divide?this.createlinenode(n,this.createcodenode(n,{type:10,wait:!0,words:this.go(n.words)})):[]}short_try(n){return n.token_query?this.createlinenode(n,this.createcodenode(n,{type:10,wait:!1,words:this.go(n.words)})):[]}command_if(n){const[i]=this.createlogicnode(n,Dd(n.token_if,"if"),"",this.go(n.words)),[r]=this.go(n.command_if_block)??[];return this.createcodenode(n,{type:13,check:i,block:r})}command_if_block(n){const i=Bo(),r=Bo();return this.createcodenode(n,{type:15,skip:i,done:r,lines:[this.go(n.inline),this.go(n.line),this.creategotonode(n,r,"end of if"),this.createmarknode(n,i,"alt logic")].flat(),altlines:[this.go(n.command_else_if),this.go(n.command_else),this.createmarknode(n,r,"end of if")].flat()})}command_block(n){return[this.go(n.inline),this.go(n.line)].flat()}command_fork(n){return[this.go(n.inline),this.go(n.line)].flat()}command_else_if(n){const i=Bo(),r=Bo();return this.createcodenode(n,{type:16,done:r,lines:[this.createlogicnode(n,Dd(n.token_if,"if"),i,this.go(n.words)),this.go(n.command_fork),this.creategotonode(n,r,"end of if"),this.createmarknode(n,i,"skip")].flat()})}command_else(n){return this.createcodenode(n,{type:17,lines:this.go(n.command_fork)})}command_while(n){const i=Bo(),r=Bo();return this.createcodenode(n,{type:18,loop:i,done:r,lines:[this.createmarknode(n,i,"start of while"),this.createlogicnode(n,"if",r,this.go(n.words)),this.go(n.command_block),this.creategotonode(n,i,"loop of while"),this.createmarknode(n,r,"end of while")].flat()})}command_repeat(n){const i=Bo(),r=Bo(),a=[this.createcountnode(n),this.go(n.words)].flat();return this.createcodenode(n,{type:21,loop:i,done:r,lines:[this.createapinode(n,"repeatstart",a),this.createmarknode(n,i,"start of repeat"),this.createlogicnode(n,"repeat",r,a),this.go(n.command_block),this.creategotonode(n,i,"loop of repeat"),this.createmarknode(n,r,"end of repeat")].flat()})}command_foreach(n){const i=Bo(),r=Bo(),a=[this.createcountnode(n),this.go(n.words)].flat();return this.createcodenode(n,{type:23,loop:i,done:r,lines:[this.createapinode(n,"foreachstart",a),this.createmarknode(n,i,"start of foreach"),this.createlogicnode(n,"foreach",r,a),this.go(n.command_block),this.creategotonode(n,i,"loop of foreach"),this.createmarknode(n,r,"end of foreach")].flat()})}command_waitfor(n){const i=Bo();return this.createcodenode(n,{type:22,loop:i,lines:[this.createmarknode(n,i,"start of waitfor"),this.createlogicnode(n,"waitfor",i,this.go(n.words))].flat()})}command_break(n){return this.createcodenode(n,{type:19,goto:0})}command_continue(n){return this.createcodenode(n,{type:20,goto:0})}command_play(n){const i=Dd(n.token_command_play,""),r=i.replace("bgplay","").replace("play","").trim(),s=i.includes("bgplay");return this.createlinenode(n,this.createcodenode(n,{type:11,words:[this.createstringnode(n,s?"bgplay":"play"),this.createstringnode(n,r)].flat()}))}command_toast(n){const r=Dd(n.token_command_toast,"").replace("toast","").trim();return this.createlinenode(n,this.createcodenode(n,{type:11,words:[this.createstringnode(n,"toast"),this.createstringnode(n,r)].flat()}))}expr(n){return n.and_test.length===1?this.go(n.and_test):this.createcodenode(n,{type:24,items:this.go(n.and_test)})}and_test(n){return n.not_test.length===1?this.go(n.not_test):this.createcodenode(n,{type:25,items:this.go(n.not_test)})}not_test(n){return n.comparison?this.go(n.comparison):n.not_test?this.createcodenode(n,{type:26,items:this.go(n.not_test)}):[]}comparison(n){if(n.arith_expr.length===1)return this.go(n.arith_expr);const[i,r]=this.go(n.arith_expr),[s]=this.go(n.comp_op);return this.createcodenode(n,{type:27,lhs:i,compare:s,rhs:r})}comp_op(n){return n.token_iseq?this.createcodenode(n,{type:28,method:0}):n.token_isnoteq?this.createcodenode(n,{type:28,method:1}):n.token_islessthan?this.createcodenode(n,{type:28,method:2}):n.token_isgreaterthan?this.createcodenode(n,{type:28,method:3}):n.token_islessthanorequal?this.createcodenode(n,{type:28,method:4}):n.token_isgreaterthanorequal?this.createcodenode(n,{type:28,method:5}):[]}expr_value(n){return n.and_test_value.length===1?this.go(n.and_test_value):this.createcodenode(n,{type:24,items:this.go(n.and_test_value)})}and_test_value(n){return n.not_test_value.length===1?this.go(n.not_test_value):this.createcodenode(n,{type:25,items:this.go(n.not_test_value)})}not_test_value(n){return n.arith_expr?this.go(n.arith_expr):n.not_test_value?this.createcodenode(n,{type:26,items:this.go(n.not_test_value)}):[]}arith_expr(n){const i=this.go(n.term);return n.arith_expr_item?this.createcodenode(n,{type:29,lhs:i[0],items:this.go(n.arith_expr_item)}):i}arith_expr_item(n){return this.createcodenode(n,{type:30,operator:n.token_plus?1:2,rhs:this.go(n.term)[0]})}term(n){return n.term_item?this.createcodenode(n,{type:29,lhs:this.go(n.factor)[0],items:this.go(n.term_item)}):this.go(n.factor)}term_item(n){let i=0;return n.token_multiply&&(i=4),n.token_divide&&(i=5),n.token_moddivide&&(i=6),n.token_floordivide&&(i=7),this.createcodenode(n,{type:30,operator:i,rhs:this.go(n.factor)[0]})}factor(n){if(n.power)return this.go(n.power);let i=0;return n.token_plus&&(i=8),n.token_minus&&(i=9),this.createcodenode(n,{type:29,lhs:void 0,items:this.createcodenode(n,{type:30,operator:i,rhs:this.go(n.factor)[0]})})}power(n){const i=this.go(n.token);return n.factor?this.createcodenode(n,{type:29,lhs:i[0],items:this.createcodenode(n,{type:30,operator:3,rhs:this.go(n.factor)[0]})}):i}words(n){return this.go(n.expr)}token(n){if(n.token_stringliteraldouble){const i=Dd(n.token_stringliteraldouble,"").replaceAll(/(^"|"$)/g,"");return this.createcodenode(n,{type:12,literal:2,value:i})}if(n.token_stringliteral){const i=Dd(n.token_stringliteral,"").replaceAll(/(^"|"$)/g,"");return this.createcodenode(n,{type:12,literal:1,value:i})}if(n.token_numberliteral){const i=parseFloat(Dd(n.token_numberliteral,"0"));return this.createcodenode(n,{type:12,literal:0,value:i})}return n.token_lparen?this.createcodenode(n,{type:31,words:this.go(n.words)}):[]}}const tXe=new eXe,Wh={labels:{},internal:0,lineindex:0,linelookup:{},isfirststat:!1},YF="zss.js";function Pr(t,e){return new XYe(t.startLine??1,t.startColumn??1,YF,e)}function Aq(t){return t.replace(/\\/g,"\\\\").replace(/'/g,"\\'")}function X5(t){return`'${Aq(t)}'`}function I2(t){if(t.startsWith('"'))return I2(t.replaceAll(/(^"|"$)/g,""));const e=KF(t);return e.errors.length?t:`['${e.tokens.map(i=>i.tokenType===QY?`', api.get('${Aq(i.image.substring(1))}'), '`:Aq(i.image)).join("")}'].join('')`}function $x(t){return t.filter(e=>e!==void 0).map(ss)}function zie(t){return Pr(t,"")}function nXe(t,e){const n=[];return t.forEach(i=>{n.push(i,e)}),n.pop(),n}function Ic(t,e,n){return Pr(t,[`api.${e}(`,...nXe(n,", "),")"])}function iXe(t){if(t.type===_n.COMPARE&&t.compare.type===_n.COMPARE_ITEM)switch(t.compare.method){case YS.IS_EQ:return Ic(t,"isEq",[ss(t.lhs),ss(t.rhs)]);case YS.IS_NOT_EQ:return Ic(t,"isNotEq",[ss(t.lhs),ss(t.rhs)]);case YS.IS_LESS_THAN:return Ic(t,"isLessThan",[ss(t.lhs),ss(t.rhs)]);case YS.IS_GREATER_THAN:return Ic(t,"isGreaterThan",[ss(t.lhs),ss(t.rhs)]);case YS.IS_LESS_THAN_OR_EQ:return Ic(t,"isLessThanOrEq",[ss(t.lhs),ss(t.rhs)]);case YS.IS_GREATER_THAN_OR_EQ:return Ic(t,"isGreaterThanOrEq",[ss(t.lhs),ss(t.rhs)])}return Pr(t,"")}function kS(t,e,n){return t.prepend(`api.${e}(`),t.add([", ",ss(n),")"])}function Hie(t,e,n){return t.prepend(`api.${e}(`),t.add([ss(n),")"])}function rXe(t,e){if(t.type===_n.OPERATOR_ITEM)switch(t.operator){case _g.PLUS:return kS(e,"opPlus",t.rhs);case _g.MINUS:return kS(e,"opMinus",t.rhs);case _g.POWER:return kS(e,"opPower",t.rhs);case _g.MULTIPLY:return kS(e,"opMultiply",t.rhs);case _g.DIVIDE:return kS(e,"opDivide",t.rhs);case _g.MOD_DIVIDE:return kS(e,"opModDivide",t.rhs);case _g.FLOOR_DIVIDE:return kS(e,"opFloorDivide",t.rhs);case _g.UNI_PLUS:return Hie(e,"opUniPlus",t.rhs);case _g.UNI_MINUS:return Hie(e,"opUniMinus",t.rhs)}return Pr(t,"")}function sXe(t){if(t.type===_n.OPERATOR){const e=t.lhs?ss(t.lhs):Pr(t,"");return t.items.forEach(n=>rXe(n,e)),e}return Pr(t,"")}function CP(t,e){return Pr(t,[Ic(t,"jump",[`${e}`]),"; continue;"])}function Iv(t){return Wh.linelookup[t??""]??-1}function Rq(t,e){Wh.linelookup[t]=e}function ow(t,e,n){for(let i=0;i<t.length;++i){const r=t[i];switch(r.type){case _n.WHILE:case _n.REPEAT:case _n.FOREACH:case _n.ELSE_IF:r.type===e&&(r.done=n);break;case _n.IF_BLOCK:case _n.IF_CHECK:r.type===e&&(r.skip=n);break;case _n.LINE:ow(r.stmts,e,n);break}}}function J0e(t,e,n){for(let i=0;i<t.length;++i){const r=t[i];switch(r.type){case _n.WHILE:case _n.REPEAT:case _n.FOREACH:case _n.ELSE_IF:r.type===e&&Rq(r.done,n);break;case _n.IF_BLOCK:case _n.IF_CHECK:r.type===e&&Rq(r.skip,n);break;case _n.LINE:J0e(r.stmts,e,n);break}}}function ss(t){var e;switch(t.type){case _n.PROGRAM:return Pr(t,[`try { // first-line
`,`while (true) {
`,`if (api.sy()) { yield 1; }
`,`switch (api.getcase()) {
`,...t.lines.map(ss).flat(),`default:
`,`  api.endofprogram();
`,`  while (api.hm() === 0) { yield 1; };
`,`  continue;
`,`}
`,`api.nextcase();
`,`} // end of logic
`,`} catch (e) {
`,`console.error(e);
`,`const source = api.stacktrace(e);
`,`const err = new Error(e.message);
`,`err.name = 'GameError';
`,`err.meta = { line: source.line, column: source.column };
`,`throw err;
`,`}
`,`//# sourceURL=${YF}`]);case _n.API:return Pr(t,["  ",Ic(t,t.method,$x(t.words)),`;
`]);case _n.LINE:return Pr(t,[`case ${t.lineindex}:
`,...t.stmts.map(ss).flat(),`  break;
`]);case _n.MARK:return Pr(t,`  // ${t.comment}
`);case _n.GOTO:{const n=Iv(t.id);return Pr(t,["  ",CP(t,n),`
`])}case _n.COUNT:return Pr(t,`${t.index}`);case _n.LITERAL:switch(t.literal){case N2.NUMBER:return Pr(t,`${t.value}`);case N2.STRING:return Pr(t,X5(t.value));case N2.TEMPLATE:return Pr(t,I2(t.value))}return zie(t);case _n.TEXT:return Pr(t,["  ",Ic(t,"text",[I2(t.value)]),`;
`]);case _n.STAT:if(Wh.isfirststat){Wh.isfirststat=!1;const n=t.value.trim().split(" ").map(X5);return Pr(t,["  ",Ic(t,"stat",n),`;
`])}return Pr(t,`  // skipped ${t.value}
`);case _n.LABEL:{const n=si(t.name),i=t.active?"label":"comment";Wh.labels[n]||(Wh.labels[n]=[]);const r=(t.active?1:-1)*t.lineindex;return Wh.labels[n].push(r),Pr(t,`  // ${r} '${n}' ${i}
`)}case _n.HYPERLINK:return Pr(t,["  ",Ic(t,"hyperlink",[I2(t.text),...$x(t.link)]),`;
`]);case _n.MOVE:{const n=Ic(t,"command",[X5("go"),$x(t.words)].flat());return t.wait?Pr(t,["  if (",n,`) { continue; };
`]):Pr(t,["  ",n,`;
`])}case _n.COMMAND:return Pr(t,["  if (",Ic(t,"command",$x(t.words)),`) { continue; };
`]);case _n.IF:{const n=((e=t.block)==null?void 0:e.type)===_n.IF_BLOCK?t.block:void 0;if(se(n)){ow([t.check],_n.IF_CHECK,n.skip);const i=Pr(t,ss(t.check));return n.lines.forEach(r=>i.add(ss(r))),J0e(n.altlines,_n.ELSE_IF,Iv(n.done)),n.altlines.forEach(r=>i.add(ss(r))),i}return Pr(t,ss(t.check))}case _n.IF_CHECK:{const n=Iv(t.skip);return n===-1?Pr(t,["  ",Ic(t,t.method,$x(t.words)),`;
`]):Pr(t,["  if (!",Ic(t,t.method,$x(t.words)),") { ",CP(t,n),` }
`])}case _n.ELSE_IF:case _n.ELSE:{const n=Pr(t,"");return t.lines.forEach(i=>n.add(ss(i))),n}case _n.WHILE:{const n=Iv(t.loop),i=Iv(t.done),r=Pr(t,"");return ow(t.lines,_n.IF_CHECK,t.done),t.lines.forEach(s=>{switch(s.type){case _n.BREAK:s.goto=i;break;case _n.CONTINUE:s.goto=n;break}r.add(ss(s))}),r}case _n.REPEAT:{const n=Iv(t.loop),i=Iv(t.done),r=Pr(t,"");return ow(t.lines,_n.IF_CHECK,t.done),t.lines.forEach(s=>{switch(s.type){case _n.BREAK:s.goto=i;break;case _n.CONTINUE:s.goto=n;break}r.add(ss(s))}),r}case _n.WAITFOR:{const n=Pr(t,"");return ow(t.lines,_n.IF_CHECK,t.loop),t.lines.forEach(i=>{n.add(ss(i))}),n}case _n.FOREACH:{const n=Iv(t.loop),i=Iv(t.done),r=Pr(t,"");return ow(t.lines,_n.IF_CHECK,t.done),t.lines.forEach(s=>{switch(s.type){case _n.BREAK:s.goto=i;break;case _n.CONTINUE:s.goto=n;break}r.add(ss(s))}),r}case _n.BREAK:return Pr(t,["  ",CP(t,t.goto),`
`]);case _n.CONTINUE:return Pr(t,["  ",CP(t,t.goto),`
`]);case _n.OR:return Ic(t,"or",t.items.map(ss));case _n.AND:return Ic(t,"and",t.items.map(ss));case _n.NOT:return Ic(t,"not",t.items.map(ss));case _n.COMPARE:return iXe(t);case _n.OPERATOR:return sXe(t);case _n.EXPR:return Ic(t,"expr",t.words.map(ss));default:return console.error("<unsupported node>",t.type,t),zie(t)}}function yg(t){if(se(t))switch(t.type===_n.LINE&&++Wh.lineindex,t.lineindex=Wh.lineindex,t.type){case _n.PROGRAM:t.lines.forEach(yg);break;case _n.LINE:t.stmts.forEach(yg);break;case _n.MARK:Rq(t.id,t.lineindex);break;case _n.IF:yg(t.check),yg(t.block);break;case _n.IF_BLOCK:t.lines.forEach(yg),t.altlines.forEach(yg);break;case _n.ELSE_IF:t.lines.forEach(yg);break;case _n.ELSE:case _n.WHILE:case _n.REPEAT:case _n.FOREACH:case _n.WAITFOR:t.lines.forEach(yg);break;case _n.MOVE:case _n.COMMAND:case _n.IF_CHECK:t.words.forEach(yg);break}}function aXe(t){return Wh.labels={},Wh.internal=1,Wh.lineindex=0,Wh.isfirststat=!0,yg(t),{...ss(t).toStringWithSourceMap({file:`${YF}.map`}),...Wh}}function jie(t){return Li(t)?t.length>0?1:0:t??0}function oXe(t){return`${t}_chip`}function Q0e(t=""){return`vm:${t??""}`}function cXe(t,e,n){var l,u;const i=oXe(t),r=vN(i);let s;const a=fl(Object.entries(n.labels??{}));(!Li(r.lb)||r.lb.length!==a.length)&&(r.lb=a,r.lk="",r.mg=void 0,r.ec=1,r.lc=0,r.ys=0,r.ps=0,r.es=(((l=n.errors)==null?void 0:l.length)??0)!==0?1:0);function o(h,f){ne.words=f;const d=TYe(e,h);return se(d)?d(c,f):h!=="send"?o("send",[h,...f]):0}const c={halt(){dXe(i)},id(){return t},set(h,f){const[d,p]=wYe(e,c,h,f);if(d)return p},get(h){const[f,d]=xYe(e,c,h);if(f)return d},tick(h){const f=pn(r.ps)?r.ps:0,d=f%h===0;if(r.ps=f+1,d===!1)return!1;if(c.shouldtick()===!1)return Lie(e,c),!1;r.lc=0,r.ys=0,ne.get=c.get,CYe(e,c);try{const p=s==null?void 0:s.next();p!=null&&p.done&&(r.es=1)}catch(p){Ui(je,ne.elementfocus,"crash",p.message),r.es=1}return Lie(e,c),!0},isended(){return r.es===1},isfirstpulse(){return r.ps===1},shouldtick(){return r.es===0||c.hm()!==0},shouldhalt(){return pn(r.lc)?++r.lc>kn.HALT_AT_COUNT:!0},hm(){if(Li(r.mg)&&Li(r.lb)){const[h]=r.mg;if(se(h))for(let f=0;f<r.lb.length;++f){const[d,p]=r.lb[f];if(d===h)return p.find(g=>pn(g)&&g>0)??0}}return 0},yield(){r.ys=1},jump(h){r.ec=h},sy(){return!!r.ys||c.shouldhalt()},send(h,f,d,p){je.emit(h,`${Q0e(f)}:${d}`,p)},lock(h){r.lk=h},unlock(){r.lk=""},message(h){r.lk&&h.sender!==r.lk||(r.mg=[h.target,h.data,h.sender,h.player])},zap(h){if(Li(r.lb))for(let f=0;f<r.lb.length;++f){const[d,p]=r.lb[f];if(d===h){const g=p.findIndex(y=>y>0);g>=0&&(p[g]*=-1)}}},restore(h){if(Li(r.lb))for(let f=0;f<r.lb.length;++f){const[d,p]=r.lb[f];if(d===h)for(let g=0;g<p.length;g++)p[f]=Math.abs(p[f])}},getcase(){r.ec=pn(r.ec)?r.ec:1;const h=c.hm();if(h&&Li(r.mg)){const[,f,d,p]=r.mg;c.set("sender",d),se(f)&&c.set("arg",f),p&&(c.set("player",p),ne.elementfocus=p),r.mg=void 0,r.ys=0,r.es=0,r.ec=h}return r.ec},nextcase(){const h=pn(r.ec)?r.ec:1;return r.ec=h+1,r.ec},endofprogram(){c.yield(),r.es=1},stacktrace(h){const f=I$e.parse(h),[d]=f.filter(p=>p.fileName===YF);return{line:(d==null?void 0:d.lineNumber)??0,column:(d==null?void 0:d.columnNumber)??0}},text(h){return o("text",[h])},stat(...h){return o("stat",h)},hyperlink(...h){return o("hyperlink",h)},command(...h){if(h.length===0)return 0;const[f,...d]=h;return o(si(Ws(f)),d)},if(...h){const[f,d]=Ct(h,0,[Ze.ANY]),p=jie(f);return p&&d<h.length&&c.command(...h.slice(d)),p?1:0},try(...h){const[,f]=Ct(h,0,[Ze.DIR]),d=c.command("go",...h);return d&&f<h.length&&c.command(...h.slice(f)),d?1:0},take(...h){const[f,d,p]=Ct(h,0,[Ze.NAME,Ze.ANY]),g=pn(d),y=g?p:1,v=c.get(f),b=g?d:1;if(!pn(v))return y<h.length&&c.command(...h.slice(y)),1;const T=v-b;return T<0?(y<h.length&&c.command(...h.slice(y)),1):(c.set(f,T),0)},give(...h){const[f,d,p]=Ct(h,0,[Ze.NAME,Ze.ANY]),g=pn(d),y=g?p:1,v=c.get(f),b=g?d:1,T=v===void 0?1:0;return T&&y<h.length&&c.command(...h.slice(y)),c.set(f,hT(v,0)+b),T},repeatstart(h,...f){const[d,p]=Ct(f,0,[Ze.NUMBER]),g=`repeatcount${h}`,y=`repeatwords${h}`;r[g]=d,r[y]=p<f.length?f.slice(p):void 0},repeat(h){const f=`repeatcount${h}`,d=`repeatwords${h}`;if(!pn(r[f]))return 0;const p=r[f];r[f]=p-1;const g=p>0,y=r[d];return g&&Li(y)&&c.command(...y),g?1:0},foreachstart(h,...f){const[d,p,g,y]=Ct(f,0,[Ze.NAME,Ze.NUMBER,Ze.NUMBER,Ze.MAYBE_NUMBER]);let v=Math.min(p,g),b=Math.max(p,g);const T=(y??0)||1;if(T<0){const x=v;v=b,b=x}return c.set(d,v-T),0},foreach(h,...f){const[d,p,g,y,v]=Ct(f,0,[Ze.NAME,Ze.NUMBER,Ze.NUMBER,Ze.MAYBE_NUMBER]);let b=Math.min(p,g),T=Math.max(p,g);const x=(y??0)||1;if(x<0){const I=b;b=T,T=I}let M=c.get(d);!pn(M)||M<b||M>T?M=b:M+=x;const R=M<=T?1:0;return R&&(c.set(d,M),v<f.length&&c.command(...f.slice(v))),R},waitfor(...h){const[f]=Ct(h,0,[Ze.ANY]),d=jie(f);return d||c.yield(),d?1:0},or(...h){let f=0;for(let d=0;d<h.length;){const[p,g]=Ct(h,d,[Ze.ANY]);if(f=p,f)break;d=g}return f},and(...h){let f=0;for(let d=0;d<h.length;){const[p,g]=Ct(h,d,[Ze.ANY]);if(f=p,!f)break;d=g}return f},not(...h){const[f]=Ct(h,0,[Ze.ANY]);return f?0:1},expr(...h){const[f]=Ct(h,0,[Ze.ANY]);return f},isEq(h,f){const[d]=Ct([h],0,[Ze.ANY]),[p]=Ct([f],0,[Ze.ANY]);return typeof d=="object"||typeof p=="object"?Mw(d,p)?1:0:d===p?1:0},isNotEq(h,f){return this.isEq(h,f)?0:1},isLessThan(h,f){const[d]=Ct([h],0,[Ze.NUMBER]),[p]=Ct([f],0,[Ze.NUMBER]);return d<p?1:0},isGreaterThan(h,f){const[d]=Ct([h],0,[Ze.NUMBER]),[p]=Ct([f],0,[Ze.NUMBER]);return d>p?1:0},isLessThanOrEq(h,f){const[d]=Ct([h],0,[Ze.NUMBER]),[p]=Ct([f],0,[Ze.NUMBER]);return d<=p?1:0},isGreaterThanOrEq(h,f){const[d]=Ct([h],0,[Ze.NUMBER]),[p]=Ct([f],0,[Ze.NUMBER]);return d>=p?1:0},opPlus(h,f){const[d]=Ct([h],0,[Ze.ANY]),[p]=Ct([f],0,[Ze.ANY]);return d+p},opMinus(h,f){const[d]=Ct([h],0,[Ze.ANY]),[p]=Ct([f],0,[Ze.ANY]);return d-p},opPower(h,f){const[d]=Ct([h],0,[Ze.NUMBER]),[p]=Ct([f],0,[Ze.NUMBER]);return Math.pow(d,p)},opMultiply(h,f){const[d]=Ct([h],0,[Ze.NUMBER]),[p]=Ct([f],0,[Ze.NUMBER]);return d*p},opDivide(h,f){const[d]=Ct([h],0,[Ze.NUMBER]),[p]=Ct([f],0,[Ze.NUMBER]);return d/p},opModDivide(h,f){const[d]=Ct([h],0,[Ze.NUMBER]),[p]=Ct([f],0,[Ze.NUMBER]);return d%p},opFloorDivide(h,f){const[d]=Ct([h],0,[Ze.NUMBER]),[p]=Ct([f],0,[Ze.NUMBER]);return Math.floor(d/p)},opUniPlus(h){const[f]=Ct([h],0,[Ze.NUMBER]);return+f},opUniMinus(h){const[f]=Ct([h],0,[Ze.NUMBER]);return-f}};return s=(u=n.code)==null?void 0:u.call(n,c),c}function Mq(t){if(!t||t.type===void 0)return;const e=[{start:t.startOffset,end:t.endOffset??0}];return Object.keys(t).forEach(n=>{if(n!=="parent"){const i=t[n];Li(i)?i.forEach(r=>{e.push(Mq(r))}):e.push(Mq(i))}}),t.range={start:Math.min(...e.filter(n=>n).map(n=>(n==null?void 0:n.start)??0)),end:Math.max(...e.filter(n=>n).map(n=>(n==null?void 0:n.end)??0))},t.range}function eve(t){const e=_Y(`${t}
`);if(e.errors.length>0)return e;Nw.input=e.tokens;const n=Nw.program();if(Nw.errors.length>0)return{tokens:e.tokens,errors:Nw.errors.map(r=>({offset:r.token.startOffset,line:r.token.startLine,column:r.token.startColumn,length:r.token.image.length,message:r.message}))};const[i]=tXe.go(n);return i?(Mq(i),{tokens:e.tokens,cst:n,ast:i}):{tokens:e.tokens,cst:n,errors:[{message:"no ast output",offset:0,line:0,column:0,length:0}]}}const K5=Object.getPrototypeOf(function*(){}).constructor;function lXe(t,e){const n=`compile-${t}`;console.time(n);const i=eve(e);if(console.timeEnd(n),i.errors&&i.errors.length>0)return i;if(!i.ast)return{...i,errors:[{message:"no ast output",offset:0,line:0,column:0,length:0}]};const r=aXe(i.ast);if(r.code){iqe&&console.info(r.code);try{return{...i,...r,source:r.code,code:new K5("api",r.code)}}catch(s){return{errors:[{message:`unexpected error ${s.message}`,offset:0,line:0,column:0,length:0}],source:"",code:new K5("api"," ")}}}return{...i,...r,source:"",code:new K5("api"," ")}}function uXe(){const t={},e={};function n(r,s){const a=t[s];if(a)return a;const o=lXe(r,s);return t[s]=o,o}const i={ids(){return Object.keys(e)},isended(r){const s=e[r];return se(s)?s.isended():!0},halt(r){const s=e[r];return se(s)&&(s.halt(),delete e[r]),!!s},gc(){const r=i.ids();for(let s=0;s<r.length;++s)i.isended(r[s])&&i.halt(r[s])},arg(r,s){const a=e[r];se(a)&&a.set("arg",s)},tick(r,s,a,o,c){var u;let l=e[r];if(!se(e[r])){const h=n(o,c);if(l=e[r]=cXe(r,s,h),(u=h.errors)!=null&&u.length){const[f]=h.errors,d=((f==null?void 0:f.line)??2)-1,p=c.replaceAll(`\r
`,"").split(`
`).map((v,b)=>[v,b]);p.slice(d-5,d).forEach(([v,b])=>{Ui(je,KM(),"build",`$grey${b+1} $grey${v}`)});const[g,y]=p[d]??[];if(On(g)&&se(y)){const v=(f.column??1)-1,b=v+f.length,T=v<g.length?g:`${g}*`,x=T.substring(0,v),M=T.substring(v,b),R=T.substring(b);Ui(je,KM(),"build",`$red${y+1} $grey${x}$red${M}$grey${R}`)}return f.message.split(`
`).forEach(v=>{Ui(je,KM(),"build",v)}),!1}}return!!(l!=null&&l.tick(a))},once(r,s,a,o){const c=i.tick(r,s,1,a,o);return i.halt(r)&&c},message(r){const{target:s,path:a}=S1(r.target),o=e[s];if(se(o)){const c={...r,target:a};o.message(c)}}};return i}new Rt;const tve=uXe();var Rc=(t=>(t.MAIN="main",t.TITLE="title",t.PLAYER="player",t.CONTENT="content",t.GADGETSTORE="gadgetstore",t.GADGETSYNC="gadgetsync",t))(Rc||{});const Cp={halt:!1,session:Bo(),operator:"",software:{main:"",content:""},books:new Map,chips:new Map,loaders:new Map};function KM(){return Cp.operator}function k2(){return[...Cp.books.values()]}function hXe(){const[t]=Cp.books.values();return t}function Wv(t){const e=si(t);return Cp.books.get(t)??k2().find(n=>n.name===e)}function Oq(t,e){se(Wv(e))&&(Cp.software[t]=e)}function Iw(t){return Wv(Cp.software[t])}function nve(t){const e=Sge([]);return On(t)&&(e.name=t),ive(e),e0(je,Cp.operator,`created [book] ${e.name}`),e}function fXe(t){let e=Wv(t);return se(e)||(e=Sge([]),e.name=t),ive(e),e0(je,Cp.operator,`created [book] ${e.name}`),e}function i_(t,e){let n=se(e)?fXe(e):Iw(t);return se(n)||(se(n)||(n=hXe()),se(n)||(n=nve(e)),se(n)&&e0(je,Cp.operator,`opened [book] ${n.name} for ${t}`)),Oq(t,n.id),n}function Hy(t,e,n){return dq(i_(t),n,e)}function vN(t){const e=i_("main");return zF(e,t)}function Vie(){const t=i_("main");return zF(t,"main")}function dXe(t){const e=i_("main");return _$e(e,t)}function ive(t){return Cp.books.set(t.id,t),t.id}function pXe(t){const e=Wv(t);e&&Cp.books.delete(e.id)}function HR(t,e,n,i){const r=UA(e);On(n.id)&&je.emit(t,"vm:touched",[n.id,r,i])}function rC(t,e,n,i){if(!se(n==null?void 0:n.id))return!1;const r=bY(t,e,n,i);if(se(r)){if(n.kind==="player"&&r.kind==="edge"){if(i.x<0){const a=sp(t,Wn.BOARD,(e==null?void 0:e.exitwest)??"");if(a.length){const o=Za(a);Ow(t,n.id,o.id,{x:fi-1,y:i.y})}}else if(i.x>=fi){const a=sp(t,Wn.BOARD,(e==null?void 0:e.exiteast)??"");if(a.length){const o=Za(a);Ow(t,n.id,o.id,{x:0,y:i.y})}}else if(i.y<0){const a=sp(t,Wn.BOARD,(e==null?void 0:e.exitnorth)??"");if(a.length){const o=Za(a);Ow(t,n.id,o.id,{x:i.x,y:Fr-1})}}else if(i.y>=Fr){const a=sp(t,Wn.BOARD,(e==null?void 0:e.exitsouth)??"");if(a.length){const o=Za(a);Ow(t,n.id,o.id,{x:i.x,y:0})}}}else HR("",r,n,"thud");if(n.kind==="player"){const a=Nb(r.id);HR(n.id,n,r,a?"bump":"touch")}else if(n.collision===vs.ISBULLET){const a=Nb(n.party),o=Nb(r.id);a!==o?HR(n.party??"",n,r,"shot"):HR("",n,r,"thud")}else HR("",n,r,"bump");const s=Jb(t,r);return r.destructible??(s==null?void 0:s.destructible)?(se(r==null?void 0:r.id)?Wg(ne.book,ne.board,r,ne.timestamp):Jf(e,{x:i.x,y:i.y}),!0):!1}return!0}function mXe(t,e,n,i,r=dqe){var h;if(!se(t)||!se(e)||!se(n))return;const s={...ne};ne.book=t,ne.board=e,ne.element=n,ne.elementid=n.id??"",ne.elementisplayer=Nb(ne.elementid);const a=ne.element.player??Cp.operator;ne.elementfocus=ne.elementisplayer?ne.elementid:a;const o=Jb(t,n),c=n.cycle??(o==null?void 0:o.cycle)??r,l=n.id??"",u=si(n.name??((h=n.kinddata)==null?void 0:h.name)??"");if(tve.tick(l,GY.RUNTIME,pn(c)?c:r,u,i),pn(n==null?void 0:n.tickertime)&&ne.timestamp-n.tickertime>F9*5&&(n.tickertime=0,n.tickertext=""),ne.elementisplayer){const f=vN(ne.elementid);pn(f.inputcurrent)&&(f.inputcurrent=0)}uF(s).forEach(f=>{ne[f]=s[f]})}function rve(t,e){const n=Iw("main");if(!se(n))return;function i(o,c){for(let l=0;l<o.length;++l){const u=o[l];if(se(u.id)){const h=`${Q0e(u.id)}:${c}`;je.emit("",h,e)}}}const{target:r,path:s}=S1(t),a=T$e(n);for(let o=0;o<a.length;++o){const c=a[o];switch(si(r)){case"all":case"self":case"others":{i(Object.values(c.objects),s);break}default:{i(fge(c,[r]),s);break}}}}function y3(t){var a;const e=i_("main"),n=wT(e,t);if(!se(e)||!se(n)||!se(ne.element))return;const i=`${t}_run`,r=si(ne.element.name??((a=ne.element.kinddata)==null?void 0:a.name)??""),s=(n==null?void 0:n.code)??"";tve.once(i,GY.RUNTIME,r,s)}function Wx(t,e=0){const n=[];let i=t;for(;i<ne.words.length;){const[r,s]=Hh(i);if(Li(r)&&!x_(r)&&!gN(r)&&!m3(r)&&!a0(r)&&n.push(...r),r==="|")return[n,s];if(i=s,n.push(r),e>0&&n.length>=e)return[n,i]}return[n,i]}function Hh(t){var i,r,s,a,o,c,l,u,h;const e=ne.words[t],n=t+1;if(k0e(e)){const[f,d]=y9e(t);if(se(f))return[f,d]}if(b9e(e)){const[f,d]=E9e(t);if(se(f))return[f,d]}if(WY(e)){const[f,d]=YY(t);if(se(f))return[f,d]}if(On(e)&&si(e)==="rnd"){const[f,d]=Hh(n),[p,g]=Hh(d);return pn(f)&&pn(p)?[Zd(f,p),g]:pn(f)?[Zd(0,f),d]:[Zd(0,1),n]}if(z9(e)){const[f,d]=Yme(t);if(se(f))return[f,d]}if(!se(e))return[void 0,t];if(pn(e)||Li(e))return[e,n];if(On(e)){const f=si(e),d=(i=ne.get)==null?void 0:i.call(ne,e);if(se(d))return[d,n];switch(f){case"aligned":case"alligned":{const p=aN(ne.board,{x:((r=ne.element)==null?void 0:r.x)??-1,y:((s=ne.element)==null?void 0:s.y)??-1},ne.elementfocus);return!se(ne.element)||!se(p)?[0,n]:[ne.element.x===p.x||ne.element.y===p.y?1:0,n]}case"contact":{const p=aN(ne.board,{x:((a=ne.element)==null?void 0:a.x)??-1,y:((o=ne.element)==null?void 0:o.y)??-1},ne.elementfocus);if(!se(ne.element)||!se(p))return[0,n];const g=(p.x??0)-(((c=ne.element)==null?void 0:c.x)??0),y=(p.y??0)-(((l=ne.element)==null?void 0:l.y)??0);return[g===0&&Math.abs(y)<2||y===0&&Math.abs(g)<2?1:0,n]}case"blocked":{const[p,g]=Ct(ne.words,n,[Ze.DIR]);return[R$e(ne.book,ne.board,ne.element,p)?1:0,g]}case"any":{const[p,g]=Ct(ne.words,n,[Ze.KIND]);return[hge(ne.board,p).length?1:0,g]}case"rnd":return[Zd(0,1),n];case"abs":{const[p,g]=Ct(ne.words,n,[Ze.NUMBER]);return[Math.abs(p),g]}case"ceil":{const[p,g]=Ct(ne.words,n,[Ze.NUMBER]);return[Math.ceil(p),g]}case"floor":{const[p,g]=Ct(ne.words,n,[Ze.NUMBER]);return[Math.floor(p),g]}case"round":{const[p,g]=Ct(ne.words,n,[Ze.NUMBER]);return[Math.round(p),g]}case"clamp":{const[p,g,y,v]=Ct(ne.words,n,[Ze.NUMBER,Ze.NUMBER,Ze.NUMBER]);return[lr(p,g,y),v]}case"min":{const[p,g]=Wx(n);return[Math.min(...p),g]}case"max":{const[p,g]=Wx(n);return[Math.max(...p),g]}case"pick":{const[p,g]=Wx(n);return[Za(p),g]}case"pickwith":{const[p,g]=Ct(ne.words,n,[Ze.NUMBER_OR_STRING]),[y,v]=Wx(g);return[qme(`${p}`,y),v]}case"random":{const[p,g]=Wx(n,2),[y,v]=p;return[Zd(y,v??0),g]}case"randomwith":{const[p,g]=Ct(ne.words,n,[Ze.NUMBER_OR_STRING]),[y,v]=Wx(g,2),[b,T]=y;return[gde(`${p}`,b,T??0),v]}case"run":{const[p,g]=Ct(ne.words,n,[Ze.NAME]);return y3(p),[(u=ne.get)==null?void 0:u.call(ne,"arg"),g]}case"runwith":{const[p,g,y]=Ct(ne.words,n,[Ze.ANY,Ze.NAME]);return se(ne.element)&&(ne.element.arg=p),y3(g),[(h=ne.get)==null?void 0:h.call(ne,"arg"),y]}}}return[e,n]}const ne={timestamp:0,book:void 0,board:void 0,element:void 0,elementid:"",elementisplayer:!1,elementfocus:"",words:[],get:void 0};var Ze=(t=>(t[t.COLOR=0]="COLOR",t[t.KIND=1]="KIND",t[t.DIR=2]="DIR",t[t.NAME=3]="NAME",t[t.NUMBER=4]="NUMBER",t[t.STRING=5]="STRING",t[t.NUMBER_OR_STRING=6]="NUMBER_OR_STRING",t[t.MAYBE_KIND=7]="MAYBE_KIND",t[t.MAYBE_NAME=8]="MAYBE_NAME",t[t.MAYBE_NUMBER=9]="MAYBE_NUMBER",t[t.MAYBE_STRING=10]="MAYBE_STRING",t[t.MAYBE_NUMBER_OR_STRING=11]="MAYBE_NUMBER_OR_STRING",t[t.ANY=12]="ANY",t))(Ze||{});function su(t,e,n){throw console.info(n,ne.element,ne.elementid,ne.elementfocus),new Error(`Invalid arg, expected: ${t} but got ${JSON.stringify(e)}`)}function Gie(t){var i,r;const e={x:((i=ne.element)==null?void 0:i.x)??0,y:((r=ne.element)==null?void 0:r.y)??0};return se(ne.board)&&se(ne.element)?Age(ne.book,ne.board,ne.element,ne.elementfocus,t,e):e}function Ct(t,e,n){const i=ne.words;ne.words=t;const r=[];let s=e;for(let a=0;a<n.length;++a)switch(n[a]){case 1:{const[o,c]=One(s);qC(o)?(s=c,r.push(o)):su("kind",o,t);break}case 0:{if(WY(t[0])===void 0){const[o,c]=Hh(s);a0(o)?(s=c,r.push(o)):su("color",o,t)}else{const[o,c]=YY(s);a0(o)?(s=c,r.push(o)):su("color",o,t)}break}case 2:{if(z9(t[0])===void 0){const[o,c]=Hh(s);x_(o)?(s=c,r.push(Gie(o))):su("direction",o,t)}else{const[o,c]=Yme(s);x_(o)?(s=c,r.push(Gie(o))):su("direction",o,t)}break}case 3:{const o=ne.words[s];On(o)||su("string",o,t),++s,r.push(o);break}case 4:{const[o,c]=Hh(s);if(On(o)){const l=parseFloat(o);pn(l)?r.push(l):su("number",o,t)}else pn(o)?r.push(o):su("number",o,t);s=c;break}case 5:{const[o,c]=Hh(s);On(o)||su("string",o,t),s=c,r.push(o);break}case 6:{const[o,c]=Hh(s);let l=o;if(On(l)){const u=parseFloat(l);pn(u)&&(l=u)}else pn(l)||su("number or string",l,t);s=c,r.push(l);break}case 7:{const[o,c]=One(s);o!==void 0&&!qC(o)&&su("optional kind",o,t),s=c,r.push(o);break}case 8:{const o=ne.words[s];o!==void 0&&!On(o)&&su("optional string",o,t),++s,r.push(o);break}case 9:{const[o,c]=Hh(s);if(On(o)){const l=parseFloat(o);pn(l)?r.push(l):su("optional number",o,t)}else pn(o)||o===void 0?r.push(o):su("optional number",o,t);s=c;break}case 10:{const[o,c]=Hh(s);o!==void 0&&!On(o)&&su("optional string",o,t),s=c,r.push(o);break}case 11:{const[o,c]=Hh(s);let l=o;if(On(l)){const u=parseFloat(l);pn(u)&&(l=u)}else l!==void 0&&!pn(l)&&su("number or string",l,t);s=c,r.push(l);break}case 12:{const[o,c]=Hh(s);s=c,r.push(o);break}}return ne.words=i,[...r,s]}function gXe(t){return se(t)&&t<Jt.ONBLACK?t:void 0}function vXe(t){return se(t)&&t>Jt.WHITE&&t<Jt.ONCLEAR?t-Jt.ONBLACK:void 0}const XF={black:"BLACK",dkblue:"DKBLUE",dkgreen:"DKGREEN",dkcyan:"DKCYAN",dkred:"DKRED",dkpurple:"DKPURPLE",dkyellow:"DKYELLOW",ltgray:"LTGRAY",dkgray:"DKGRAY",blue:"BLUE",green:"GREEN",cyan:"CYAN",red:"RED",purple:"PURPLE",yellow:"YELLOW",white:"WHITE",brown:"DKYELLOW",dkwhite:"LTGRAY",ltgrey:"LTGRAY",gray:"LTGRAY",grey:"LTGRAY",dkgrey:"DKGRAY",ltblack:"DKGRAY",onblack:"ONBLACK",ondkblue:"ONDKBLUE",ondkgreen:"ONDKGREEN",ondkcyan:"ONDKCYAN",ondkred:"ONDKRED",ondkpurple:"ONDKPURPLE",ondkyellow:"ONDKYELLOW",onltgray:"ONLTGRAY",ondkgray:"ONDKGRAY",onblue:"ONBLUE",ongreen:"ONGREEN",oncyan:"ONCYAN",onred:"ONRED",onpurple:"ONPURPLE",onyellow:"ONYELLOW",onwhite:"ONWHITE",onbrown:"ONDKYELLOW",ondkwhite:"ONLTGRAY",onltgrey:"ONLTGRAY",ongray:"ONLTGRAY",ongrey:"ONLTGRAY",ondkgrey:"ONDKGRAY",onltblack:"ONDKGRAY",onclear:"ONCLEAR"};function a0(t){return Li(t)&&sve(t[0])}function qie(t){return a0(t)&&t[0].startsWith("ON")}function sve(t){return se(Jt[t])&&On(t)}function WY(t){if(On(t))return XF[si(t)]}function _Xe(t){return t.map(e=>Jt[e]).find(e=>se(e)&&e<Jt.ONBLACK)}function yXe(t){return t.map(e=>Jt[e]).find(e=>se(e)&&e>=Jt.ONBLACK)}function bXe(t){if(a0(t))return t;if(sve(t))return[t];const e=WY(t);if(se(e))return[e]}function $ie(t){const e=ne.words[t],n=bXe(e);return a0(n)?[n,t+1]:[void 0,t]}function YY(t){const e=[];let n=t;const[i,r]=$ie(t);if(a0(i)&&(e.push(...i),n=r),a0(e)&&!qie(e)){const[s,a]=$ie(r);qie(s)&&(n=a)}return e.length?[e,n]:[void 0,t]}function ave(t){const e={};return t.every(n=>{const i=Jt[n];se(i)&&(i<Jt.ONBLACK?e.color=i:e.bg=i-Jt.ONBLACK)}),e}const EXe=B9(32,126).map(t=>String.fromCharCode(t)),SXe=ld({name:"Whitespace",pattern:/ +/}),TXe=ld({name:"WhitespaceSkipped",pattern:/ +/,group:zc.SKIPPED}),XY=ld({name:"Newline",line_breaks:!0,start_chars_hint:[`
`,"\r"],pattern:/\n|\r\n?/}),KY=ld({name:"StringLiteral",pattern:/[^ $;\r\n]+/,start_chars_hint:EXe}),ZY=ld({name:"StringLiteralDouble",pattern:/"(?:[^\\"]|\\(?:[^\n\r]|u[0-9a-fA-F]{4}))*"/}),JY=ld({name:"EscapedDollar",pattern:"$$"}),QY=ld({name:"MaybeFlag",pattern:/\$[^-0-9"!;@#/?\s]+[^-"!;@#/?\s]*/}),eX=ld({name:"NumberLiteral",pattern:/\$-?(\d*\.)?\d+([eE][+-]?\d+)?[jJ]?[lL]?\+?/}),tX=ld({name:"HyperLinkText",pattern:/;[^;\r\n]*/,start_chars_hint:[";"]});function xXe(t,e=""){return ld({name:e||t,pattern:new RegExp(t.toLowerCase(),"i")})}const wXe=Object.keys(XF),ove=wXe.map(t=>xXe(`\\$(${t})`,t)),CXe=[SXe,XY,...ove,ZY,KY,eX,JY,tX,QY],AXe=new zc(CXe,{skipValidations:!t0,ensureOptimizations:t0}),RXe=new zc([TXe,XY,...ove,ZY,KY,eX,JY,tX,QY],{skipValidations:!t0,ensureOptimizations:t0});function KF(t,e=!1){return e?RXe.tokenize(t):AXe.tokenize(t)}function CE(t,e,n,i,r,s,a,o){return{disablewrap:!1,measureonly:!1,measuredwidth:0,writefullwidth:void 0,x:0,y:0,iseven:!0,active:{color:n,bg:i,topedge:r,leftedge:s,rightedge:a,bottomedge:o},reset:{color:n,bg:i,topedge:r,leftedge:s,rightedge:a,bottomedge:o},width:t,height:e,char:[],color:[],bg:[],changed(){}}}function ZF(t){t.active={...t.reset}}function nX(t,e){const n=e.y;function i(){++e.x;const o=e.active.rightedge??e.width-1;!e.disablewrap&&e.x>o&&(e.x=e.active.leftedge??0,++e.y),e.x>e.measuredwidth&&(e.measuredwidth=e.x)}function r(){return e.x>=(e.active.leftedge??0)&&e.x<=(e.active.rightedge??e.width-1)&&e.y>=(e.active.topedge??0)&&e.y<=(e.active.bottomedge??e.height-1)}function s(o){for(let c=0;c<o.length;++c){if(e.measureonly!==!0&&r()){const l=e.x+e.y*e.width;e.char[l]=o.charCodeAt(c),e.active.color!==void 0&&(e.color[l]=e.active.color),e.active.bg!==void 0&&(e.bg[l]=e.active.bg)}i()}}for(let o=0;o<t.length;++o){const c=t[o];switch(c.tokenType){case JY:s("$");break;case eX:if(e.measureonly!==!0&&r()){const l=e.x+e.y*e.width;e.char[l]=parseFloat(c.image.replace("$","")),e.active.color!==void 0&&(e.color[l]=e.active.color),e.active.bg!==void 0&&(e.bg[l]=e.active.bg)}i();break;case ZY:s(c.image.substring(1,c.image.length-1).replaceAll('\\"','"'));break;case XY:{e.x=e.active.leftedge??0,++e.y;break}default:{const l=c.tokenType.name,u=XF[l],h=gXe(Jt[u]),f=vXe(Jt[u]);u==="ONCLEAR"?(e.active.color=e.reset.color,e.active.bg=e.reset.bg):se(h)?e.active.color=h:se(f)?e.active.bg=f:s(c.image);break}}}e.x>e.measuredwidth&&(e.measuredwidth=e.x+1);const a=e.active.leftedge??0;if(se(e.writefullwidth)&&(e.x>a||e.y===n)){const c=(e.active.rightedge??e.width-1)-e.x;if(c>0){ZF(e);const l=String.fromCharCode(e.writefullwidth).repeat(c),u=e.x+e.y*e.width;_N(u,u+l.length,e.active.color,e.active.bg,e),JF(u,l,e)}}}function ri(t,e,n){const i=KF(t);i.tokens&&(nX(i.tokens,e),n&&ZF(e),e.changed())}function tk(t,e,n){const i=KF(t);if(!i.tokens)return;const r=CE(e,n,Jt.WHITE,Jt.BLACK);return r.measureonly=!0,nX(i.tokens,r),r.x>0&&++r.y,r}function JF(t,e,n){let i=0;const r=t+e.length;for(let s=t;s<r;++s)n.char[s]=e.charCodeAt(i++);n.changed()}function _N(t,e,n,i,r){const s=Math.min(t,e),a=Math.max(t,e);for(let o=s;o<=a;++o)r.color[o]=n,r.bg[o]=i;r.changed()}function fg(t,e,n,i,r,s,a){const o=Math.min(n,i),c=Math.max(n,i);if(o>e||c<0)return;const l=Math.max(0,o),u=Math.min(e,c);_N(t+l,t+u,r,s,a)}function cve(t,e,n){const i=HI(KY,t,0,0,0,0,0,0);nX([i],e),n&&ZF(e),e.changed()}function MXe(t,e,n,i,r){r.active.topedge=t,r.active.leftedge=e,r.active.rightedge=n,r.active.bottomedge=i}function wm(t){const e=t.reset.leftedge??0,n=t.reset.rightedge??t.width-1,i=t.reset.topedge??0,r=t.reset.bottomedge??t.height-1,s=n-e+1,a=r-i+1;return{left:e,right:n,top:i,bottom:r,width:s,height:a}}function yN(t,e=16){return t?B9(e-1).map(n=>{const i=n*Xb;return new yn(t.bits[i]/63,t.bits[i+1]/63,t.bits[i+2]/63)}):[]}function OXe(t){return t.generateMipmaps=!1,t.minFilter=eo,t.magFilter=eo,t.needsUpdate=!0,t}function sC(t){if(se(t))return OXe(new $ce(M6e(t)))}const Yy=Fe.createContext(CE(1,1,15,1));function Cm(){return Fe.useContext(Yy)}const lve=bE(()=>({blink:!1}));setInterval(()=>{lve.setState(t=>({blink:!t.blink}))},333);function ud(){return lve(t=>t.blink)}function uve(){return c9(t=>{function e(){t(n=>({render:n.render+1}))}return{dither:[],render:0,changed(){queueMicrotask(e)}}})}function NXe(t){t.fill(0)}function Z5(t,e,n,i,r,s){if(i<0||i>=e||r<0||r>=n)return-1;t[i+r*e]=s}const hve=Fe.createContext(uve());function IXe(t,e,n){const[i]=Fe.useState(()=>uve()),r=t*e,s=i.getState();return s.dither.length!==r&&(s.dither=new Array(r).fill(n),s.render=0),i}function fve(){return c9(t=>{function e(){t(n=>({render:n.render+1}))}return{width:0,height:0,char:[],color:[],bg:[],render:0,changed(){queueMicrotask(e)}}})}function dve(t,e,n,i){t.char.fill(e),t.color.fill(n),t.bg.fill(i)}function Uo(t,e,n,i,r,s){if(i<0||i>=e||r<0||r>=n)return;const a=i+r*e;uF(s).forEach(o=>{const c=s[o];se(c)&&(t[o][a]=c)})}const iX=Fe.createContext(fve());function nk(t,e,n,i,r){const[s]=Fe.useState(()=>fve()),a=t*e,o=s.getState();return o.char.length!==a&&(o.width=t,o.height=e,o.char=new Array(a).fill(n),o.color=new Array(a).fill(i),o.bg=new Array(a).fill(r),o.render=0),s}function pve(){return Fe.useContext(iX).getState()}const Wie=T1(PA),Yie=DA(kI),h_=bE(t=>({palette:Wie,charset:Yie,screen:{},palettedata:yN(Wie),charsetdata:sC(Yie),setpalette(e){t(n=>Mw(n.palette,e)?n:{...n,palette:e,palettedata:yN(e)})},setcharset(e){t(n=>Mw(n.charset,e)?n:{...n,charset:e,charsetdata:sC(e)})},setaltcharset(e){t(n=>Mw(n.altcharset,e)?n:{...n,altcharset:e,altcharsetdata:sC(e)})},setscreen(e,n){t(i=>Mw(i.screen,n)?i:{...i,screen:{...i.screen,[e]:n}})}})),Zh=bE(()=>({insetcols:20,insetrows:20,islowrez:!1,islandscape:!0,sidebaropen:!0,showkeyboard:!1,keyboardalt:!1,keyboardctrl:!1,keyboardshift:!1,showtouchcontrols:!1}));function cu(t,e,n){function i(r){Ui(t,e,"crash",r.message)}n().catch(i)}function gr(t,e,n){return t.namespaceURI&&t.namespaceURI!=="http://www.w3.org/1999/xhtml"||(e=Array.isArray(e)?e:[e],!e.includes(t.tagName.toLowerCase()))?!1:n?Object.entries(n).every(([i,r])=>t[i]===r):!0}function Ap(t){var e;if(kXe(t)&&t.defaultView)return t.defaultView;if(!((e=t.ownerDocument)===null||e===void 0)&&e.defaultView)return t.ownerDocument.defaultView;throw new Error(`Could not determine window of node. Node was ${DXe(t)}`)}function kXe(t){return t.nodeType===9}function DXe(t){return typeof t=="function"?`function ${t.name}`:t===null?"null":String(t)}function mve(t,e){return new Promise((n,i)=>{const r=new e;r.onerror=i,r.onabort=i,r.onload=()=>{n(String(r.result))},r.readAsText(t)})}function rX(t,e){const n={...e,length:e.length,item:i=>n[i],[Symbol.iterator]:function*(){for(let r=0;r<n.length;r++)yield n[r]}};return n.constructor=t.FileList,t.FileList&&Object.setPrototypeOf(n,t.FileList.prototype),Object.freeze(n),n}function yb(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}class gve{getAsFile(){return this.file}getAsString(e){typeof this.data=="string"&&e(this.data)}webkitGetAsEntry(){throw new Error("not implemented")}constructor(e,n){yb(this,"kind",void 0),yb(this,"type",void 0),yb(this,"file",null),yb(this,"data",void 0),typeof e=="string"?(this.kind="string",this.type=String(n),this.data=e):(this.kind="file",this.type=e.type,this.file=e)}}class PXe extends Array{add(...e){const n=new gve(e[0],e[1]);return this.push(n),n}clear(){this.splice(0,this.length)}remove(e){this.splice(e,1)}}function AP(t,e){const[n,i]=t.split("/"),r=!i||i==="*";return s=>e?s.type===(r?n:t):r?s.type.startsWith(`${n}/`):s.type===n}function LXe(t){return new class{getData(n){var i;const r=(i=this.items.find(AP(n,!0)))!==null&&i!==void 0?i:this.items.find(AP(n,!1));let s="";return r==null||r.getAsString(a=>{s=a}),s}setData(n,i){const r=this.items.findIndex(AP(n,!0)),s=new gve(i,n);r>=0?this.items.splice(r,1,s):this.items.push(s)}clearData(n){if(n){const i=this.items.findIndex(AP(n,!0));i>=0&&this.items.remove(i)}else this.items.clear()}get types(){const n=[];return this.files.length&&n.push("Files"),this.items.forEach(i=>n.push(i.type)),Object.freeze(n),n}setDragImage(){}constructor(){yb(this,"dropEffect","none"),yb(this,"effectAllowed","uninitialized"),yb(this,"items",new PXe),yb(this,"files",rX(t,[]))}}}function sX(t,e=[]){const n=typeof t.DataTransfer>"u"?LXe(t):new t.DataTransfer;return Object.defineProperty(n,"files",{get:()=>rX(t,e)}),n}async function UXe(t,e){return e.kind==="file"?e.getAsFile():new t.Blob([await new Promise(n=>e.getAsString(n))],{type:e.type})}function vve(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function _ve(t,...e){const n=Object.fromEntries(e.map(i=>[typeof i=="string"?"text/plain":i.type,Promise.resolve(i)]));return typeof t.ClipboardItem<"u"?new t.ClipboardItem(n):new class{get types(){return Array.from(Object.keys(this.data))}async getType(r){const s=await this.data[r];if(!s)throw new Error(`${r} is not one of the available MIME types on this item.`);return s instanceof t.Blob?s:new t.Blob([s],{type:r})}constructor(r){vve(this,"data",void 0),this.data=r}}(n)}const eA=Symbol("Manage ClipboardSub");function Xie(t,e){return Object.assign(new class extends t.EventTarget{async read(){return Array.from(this.items)}async readText(){let i="";for(const r of this.items){const s=r.types.includes("text/plain")?"text/plain":r.types.find(a=>a.startsWith("text/"));s&&(i+=await r.getType(s).then(a=>mve(a,t.FileReader)))}return i}async write(i){this.items=i}async writeText(i){this.items=[_ve(t,i)]}constructor(...i){super(...i),vve(this,"items",[])}},{[eA]:e})}function aX(t){return!!(t!=null&&t[eA])}function BXe(t){if(aX(t.navigator.clipboard))return t.navigator.clipboard[eA];const e=Object.getOwnPropertyDescriptor(t.navigator,"clipboard");let n;const i={resetClipboardStub:()=>{n=Xie(t,i)},detachClipboardStub:()=>{e?Object.defineProperty(t.navigator,"clipboard",e):Object.defineProperty(t.navigator,"clipboard",{value:void 0,configurable:!0})}};return n=Xie(t,i),Object.defineProperty(t.navigator,"clipboard",{get:()=>n,configurable:!0}),n[eA]}function FXe(t){aX(t.navigator.clipboard)&&t.navigator.clipboard[eA].resetClipboardStub()}function zXe(t){aX(t.navigator.clipboard)&&t.navigator.clipboard[eA].detachClipboardStub()}async function HXe(t){const e=t.defaultView,n=e==null?void 0:e.navigator.clipboard,i=n&&await n.read();if(!i)throw new Error("The Clipboard API is unavailable.");const r=sX(e);for(const s of i)for(const a of s.types)r.setData(a,await s.getType(a).then(o=>mve(o,e.FileReader)));return r}async function yve(t,e){const n=Ap(t),i=n.navigator.clipboard,r=[];for(let a=0;a<e.items.length;a++){const o=e.items[a],c=await UXe(n,o);r.push(_ve(n,c))}if(!(i&&await i.write(r).then(()=>!0,()=>!1)))throw new Error("The Clipboard API is unavailable.")}const b3=globalThis;typeof b3.afterEach=="function"&&b3.afterEach(()=>FXe(globalThis.window));typeof b3.afterAll=="function"&&b3.afterAll(()=>zXe(globalThis.window));const bve=["input:not([type=hidden]):not([disabled])","button:not([disabled])","select:not([disabled])","textarea:not([disabled])",'[contenteditable=""]','[contenteditable="true"]',"a[href]","[tabindex]:not([disabled])"].join(", ");function oX(t){return t.matches(bve)}function jXe(t){return new t.constructor(t.type,t)}function R_(t){for(let n=t;n;n=n.parentElement)if(gr(n,["button","input","select","textarea","optgroup","option"])){if(n.hasAttribute("disabled"))return!0}else if(gr(n,"fieldset")){var e;if(n.hasAttribute("disabled")&&!(!((e=n.querySelector(":scope > legend"))===null||e===void 0)&&e.contains(t)))return!0}else if(n.tagName.includes("-")&&n.constructor.formAssociated&&n.hasAttribute("disabled"))return!0;return!1}function ik(t){const e=t.activeElement;return e!=null&&e.shadowRoot?ik(e.shadowRoot):R_(e)?t.ownerDocument?t.ownerDocument.body:t.body:e}function J5(t){var e;return(e=ik(t))!==null&&e!==void 0?e:t.body}function VXe(t,e){let n=t;do{if(e(n))return n;n=n.parentElement}while(n&&n!==t.ownerDocument.body)}function i1(t){return t.hasAttribute("contenteditable")&&(t.getAttribute("contenteditable")=="true"||t.getAttribute("contenteditable")=="")}function bN(t){const e=GXe(t);return e&&(e.closest('[contenteditable=""]')||e.closest('[contenteditable="true"]'))}function GXe(t){return t.nodeType===1?t:t.parentElement}var Eve=function(t){return t.button="button",t.color="color",t.file="file",t.image="image",t.reset="reset",t.submit="submit",t.checkbox="checkbox",t.radio="radio",t}(Eve||{});function Sve(t){return gr(t,"button")||gr(t,"input")&&t.type in Eve}function tA(t){return xve(t)&&!t.readOnly||i1(t)}var Tve=function(t){return t.text="text",t.date="date",t["datetime-local"]="datetime-local",t.email="email",t.month="month",t.number="number",t.password="password",t.search="search",t.tel="tel",t.time="time",t.url="url",t.week="week",t}(Tve||{});function xve(t){return gr(t,"textarea")||gr(t,"input")&&t.type in Tve}function E0(t){return wve(t)&&xve(t)}function qXe(t){return wve(t)&&Sve(t)}function wve(t){return t.nodeType===1}function $Xe(t){const e=t.ownerDocument.getSelection();if(e!=null&&e.focusNode&&E0(t)){const i=bN(e.focusNode);if(i){if(!e.isCollapsed){var n;const r=((n=i.firstChild)===null||n===void 0?void 0:n.nodeType)===3?i.firstChild:i;e.setBaseAndExtent(r,0,r,0)}}else e.setBaseAndExtent(t,0,t,0)}}var iE={},cX={exports:{}};cX.exports;(function(t){const n=(s=0)=>a=>`\x1B[${38+s};5;${a}m`,i=(s=0)=>(a,o,c)=>`\x1B[${38+s};2;${a};${o};${c}m`;function r(){const s=new Map,a={modifier:{reset:[0,0],bold:[1,22],dim:[2,22],italic:[3,23],underline:[4,24],overline:[53,55],inverse:[7,27],hidden:[8,28],strikethrough:[9,29]},color:{black:[30,39],red:[31,39],green:[32,39],yellow:[33,39],blue:[34,39],magenta:[35,39],cyan:[36,39],white:[37,39],blackBright:[90,39],redBright:[91,39],greenBright:[92,39],yellowBright:[93,39],blueBright:[94,39],magentaBright:[95,39],cyanBright:[96,39],whiteBright:[97,39]},bgColor:{bgBlack:[40,49],bgRed:[41,49],bgGreen:[42,49],bgYellow:[43,49],bgBlue:[44,49],bgMagenta:[45,49],bgCyan:[46,49],bgWhite:[47,49],bgBlackBright:[100,49],bgRedBright:[101,49],bgGreenBright:[102,49],bgYellowBright:[103,49],bgBlueBright:[104,49],bgMagentaBright:[105,49],bgCyanBright:[106,49],bgWhiteBright:[107,49]}};a.color.gray=a.color.blackBright,a.bgColor.bgGray=a.bgColor.bgBlackBright,a.color.grey=a.color.blackBright,a.bgColor.bgGrey=a.bgColor.bgBlackBright;for(const[o,c]of Object.entries(a)){for(const[l,u]of Object.entries(c))a[l]={open:`\x1B[${u[0]}m`,close:`\x1B[${u[1]}m`},c[l]=a[l],s.set(u[0],u[1]);Object.defineProperty(a,o,{value:c,enumerable:!1})}return Object.defineProperty(a,"codes",{value:s,enumerable:!1}),a.color.close="\x1B[39m",a.bgColor.close="\x1B[49m",a.color.ansi256=n(),a.color.ansi16m=i(),a.bgColor.ansi256=n(10),a.bgColor.ansi16m=i(10),Object.defineProperties(a,{rgbToAnsi256:{value:(o,c,l)=>o===c&&c===l?o<8?16:o>248?231:Math.round((o-8)/247*24)+232:16+36*Math.round(o/255*5)+6*Math.round(c/255*5)+Math.round(l/255*5),enumerable:!1},hexToRgb:{value:o=>{const c=/(?<colorString>[a-f\d]{6}|[a-f\d]{3})/i.exec(o.toString(16));if(!c)return[0,0,0];let{colorString:l}=c.groups;l.length===3&&(l=l.split("").map(h=>h+h).join(""));const u=Number.parseInt(l,16);return[u>>16&255,u>>8&255,u&255]},enumerable:!1},hexToAnsi256:{value:o=>a.rgbToAnsi256(...a.hexToRgb(o)),enumerable:!1}}),a}Object.defineProperty(t,"exports",{enumerable:!0,get:r})})(cX);var Cve=cX.exports,B_={};Object.defineProperty(B_,"__esModule",{value:!0});B_.printIteratorEntries=YXe;B_.printIteratorValues=XXe;B_.printListItems=KXe;B_.printObjectProperties=ZXe;const WXe=(t,e)=>{const n=Object.keys(t).sort(e);return Object.getOwnPropertySymbols&&Object.getOwnPropertySymbols(t).forEach(i=>{Object.getOwnPropertyDescriptor(t,i).enumerable&&n.push(i)}),n};function YXe(t,e,n,i,r,s,a=": "){let o="",c=t.next();if(!c.done){o+=e.spacingOuter;const l=n+e.indent;for(;!c.done;){const u=s(c.value[0],e,l,i,r),h=s(c.value[1],e,l,i,r);o+=l+u+a+h,c=t.next(),c.done?e.min||(o+=","):o+=","+e.spacingInner}o+=e.spacingOuter+n}return o}function XXe(t,e,n,i,r,s){let a="",o=t.next();if(!o.done){a+=e.spacingOuter;const c=n+e.indent;for(;!o.done;)a+=c+s(o.value,e,c,i,r),o=t.next(),o.done?e.min||(a+=","):a+=","+e.spacingInner;a+=e.spacingOuter+n}return a}function KXe(t,e,n,i,r,s){let a="";if(t.length){a+=e.spacingOuter;const o=n+e.indent;for(let c=0;c<t.length;c++)a+=o,c in t&&(a+=s(t[c],e,o,i,r)),c<t.length-1?a+=","+e.spacingInner:e.min||(a+=",");a+=e.spacingOuter+n}return a}function ZXe(t,e,n,i,r,s){let a="";const o=WXe(t,e.compareKeys);if(o.length){a+=e.spacingOuter;const c=n+e.indent;for(let l=0;l<o.length;l++){const u=o[l],h=s(u,e,c,i,r),f=s(t[u],e,c,i,r);a+=c+h+": "+f,l<o.length-1?a+=","+e.spacingInner:e.min||(a+=",")}a+=e.spacingOuter+n}return a}var kb={};Object.defineProperty(kb,"__esModule",{value:!0});kb.test=kb.serialize=kb.default=void 0;var Kie=B_,E3=function(){return typeof globalThis<"u"?globalThis:typeof E3<"u"?E3:typeof self<"u"?self:typeof window<"u"?window:Function("return this")()}(),Q5=E3["jest-symbol-do-not-touch"]||E3.Symbol;const JXe=typeof Q5=="function"&&Q5.for?Q5.for("jest.asymmetricMatcher"):1267621,RP=" ",Ave=(t,e,n,i,r,s)=>{const a=t.toString();return a==="ArrayContaining"||a==="ArrayNotContaining"?++i>e.maxDepth?"["+a+"]":a+RP+"["+(0,Kie.printListItems)(t.sample,e,n,i,r,s)+"]":a==="ObjectContaining"||a==="ObjectNotContaining"?++i>e.maxDepth?"["+a+"]":a+RP+"{"+(0,Kie.printObjectProperties)(t.sample,e,n,i,r,s)+"}":a==="StringMatching"||a==="StringNotMatching"||a==="StringContaining"||a==="StringNotContaining"?a+RP+s(t.sample,e,n,i,r):t.toAsymmetricMatcher()};kb.serialize=Ave;const Rve=t=>t&&t.$$typeof===JXe;kb.test=Rve;const QXe={serialize:Ave,test:Rve};var eKe=QXe;kb.default=eKe;var Db={},tKe=({onlyFirst:t=!1}={})=>{const e=["[\\u001B\\u009B][[\\]()#;?]*(?:(?:(?:(?:;[-a-zA-Z\\d\\/#&.:=?%@~_]+)*|[a-zA-Z\\d]+(?:;[-a-zA-Z\\d\\/#&.:=?%@~_]*)*)?\\u0007)","(?:(?:\\d{1,4}(?:;\\d{0,4})*)?[\\dA-PR-TZcf-ntqry=><~]))"].join("|");return new RegExp(e,t?void 0:"g")};Object.defineProperty(Db,"__esModule",{value:!0});Db.test=Db.serialize=Db.default=void 0;var Mve=Ove(tKe),ea=Ove(Cve);function Ove(t){return t&&t.__esModule?t:{default:t}}const nKe=t=>t.replace((0,Mve.default)(),e=>{switch(e){case ea.default.red.close:case ea.default.green.close:case ea.default.cyan.close:case ea.default.gray.close:case ea.default.white.close:case ea.default.yellow.close:case ea.default.bgRed.close:case ea.default.bgGreen.close:case ea.default.bgYellow.close:case ea.default.inverse.close:case ea.default.dim.close:case ea.default.bold.close:case ea.default.reset.open:case ea.default.reset.close:return"</>";case ea.default.red.open:return"<red>";case ea.default.green.open:return"<green>";case ea.default.cyan.open:return"<cyan>";case ea.default.gray.open:return"<gray>";case ea.default.white.open:return"<white>";case ea.default.yellow.open:return"<yellow>";case ea.default.bgRed.open:return"<bgRed>";case ea.default.bgGreen.open:return"<bgGreen>";case ea.default.bgYellow.open:return"<bgYellow>";case ea.default.inverse.open:return"<inverse>";case ea.default.dim.open:return"<dim>";case ea.default.bold.open:return"<bold>";default:return""}}),Nve=t=>typeof t=="string"&&!!t.match((0,Mve.default)());Db.test=Nve;const Ive=(t,e,n,i,r,s)=>s(nKe(t),e,n,i,r);Db.serialize=Ive;const iKe={serialize:Ive,test:Nve};var rKe=iKe;Db.default=rKe;var Pb={};Object.defineProperty(Pb,"__esModule",{value:!0});Pb.test=Pb.serialize=Pb.default=void 0;var Zie=B_;const sKe=" ",kve=["DOMStringMap","NamedNodeMap"],aKe=/^(HTML\w*Collection|NodeList)$/,oKe=t=>kve.indexOf(t)!==-1||aKe.test(t),Dve=t=>t&&t.constructor&&!!t.constructor.name&&oKe(t.constructor.name);Pb.test=Dve;const cKe=t=>t.constructor.name==="NamedNodeMap",Pve=(t,e,n,i,r,s)=>{const a=t.constructor.name;return++i>e.maxDepth?"["+a+"]":(e.min?"":a+sKe)+(kve.indexOf(a)!==-1?"{"+(0,Zie.printObjectProperties)(cKe(t)?Array.from(t).reduce((o,c)=>(o[c.name]=c.value,o),{}):{...t},e,n,i,r,s)+"}":"["+(0,Zie.printListItems)(Array.from(t),e,n,i,r,s)+"]")};Pb.serialize=Pve;const lKe={serialize:Pve,test:Dve};var uKe=lKe;Pb.default=uKe;var Lb={},uu={},lX={};Object.defineProperty(lX,"__esModule",{value:!0});lX.default=hKe;function hKe(t){return t.replace(/</g,"&lt;").replace(/>/g,"&gt;")}Object.defineProperty(uu,"__esModule",{value:!0});uu.printText=uu.printProps=uu.printElementAsLeaf=uu.printElement=uu.printComment=uu.printChildren=void 0;var Lve=fKe(lX);function fKe(t){return t&&t.__esModule?t:{default:t}}const dKe=(t,e,n,i,r,s,a)=>{const o=i+n.indent,c=n.colors;return t.map(l=>{const u=e[l];let h=a(u,n,o,r,s);return typeof u!="string"&&(h.indexOf(`
`)!==-1&&(h=n.spacingOuter+o+h+n.spacingOuter+i),h="{"+h+"}"),n.spacingInner+i+c.prop.open+l+c.prop.close+"="+c.value.open+h+c.value.close}).join("")};uu.printProps=dKe;const pKe=(t,e,n,i,r,s)=>t.map(a=>e.spacingOuter+n+(typeof a=="string"?Uve(a,e):s(a,e,n,i,r))).join("");uu.printChildren=pKe;const Uve=(t,e)=>{const n=e.colors.content;return n.open+(0,Lve.default)(t)+n.close};uu.printText=Uve;const mKe=(t,e)=>{const n=e.colors.comment;return n.open+"<!--"+(0,Lve.default)(t)+"-->"+n.close};uu.printComment=mKe;const gKe=(t,e,n,i,r)=>{const s=i.colors.tag;return s.open+"<"+t+(e&&s.close+e+i.spacingOuter+r+s.open)+(n?">"+s.close+n+i.spacingOuter+r+s.open+"</"+t:(e&&!i.min?"":" ")+"/")+">"+s.close};uu.printElement=gKe;const vKe=(t,e)=>{const n=e.colors.tag;return n.open+"<"+t+n.close+" …"+n.open+" />"+n.close};uu.printElementAsLeaf=vKe;Object.defineProperty(Lb,"__esModule",{value:!0});Lb.test=Lb.serialize=Lb.default=void 0;var Yx=uu;const _Ke=1,Bve=3,Fve=8,zve=11,yKe=/^((HTML|SVG)\w*)?Element$/,bKe=t=>{try{return typeof t.hasAttribute=="function"&&t.hasAttribute("is")}catch{return!1}},EKe=t=>{const e=t.constructor.name,{nodeType:n,tagName:i}=t,r=typeof i=="string"&&i.includes("-")||bKe(t);return n===_Ke&&(yKe.test(e)||r)||n===Bve&&e==="Text"||n===Fve&&e==="Comment"||n===zve&&e==="DocumentFragment"},Hve=t=>{var e;return(t==null||(e=t.constructor)===null||e===void 0?void 0:e.name)&&EKe(t)};Lb.test=Hve;function SKe(t){return t.nodeType===Bve}function TKe(t){return t.nodeType===Fve}function ej(t){return t.nodeType===zve}const jve=(t,e,n,i,r,s)=>{if(SKe(t))return(0,Yx.printText)(t.data,e);if(TKe(t))return(0,Yx.printComment)(t.data,e);const a=ej(t)?"DocumentFragment":t.tagName.toLowerCase();return++i>e.maxDepth?(0,Yx.printElementAsLeaf)(a,e):(0,Yx.printElement)(a,(0,Yx.printProps)(ej(t)?[]:Array.from(t.attributes).map(o=>o.name).sort(),ej(t)?{}:Array.from(t.attributes).reduce((o,c)=>(o[c.name]=c.value,o),{}),e,n+e.indent,i,r,s),(0,Yx.printChildren)(Array.prototype.slice.call(t.childNodes||t.children),e,n+e.indent,i,r,s),e,n)};Lb.serialize=jve;const xKe={serialize:jve,test:Hve};var wKe=xKe;Lb.default=wKe;var Ub={};Object.defineProperty(Ub,"__esModule",{value:!0});Ub.test=Ub.serialize=Ub.default=void 0;var EN=B_;const CKe="@@__IMMUTABLE_ITERABLE__@@",AKe="@@__IMMUTABLE_LIST__@@",RKe="@@__IMMUTABLE_KEYED__@@",MKe="@@__IMMUTABLE_MAP__@@",Jie="@@__IMMUTABLE_ORDERED__@@",OKe="@@__IMMUTABLE_RECORD__@@",NKe="@@__IMMUTABLE_SEQ__@@",IKe="@@__IMMUTABLE_SET__@@",kKe="@@__IMMUTABLE_STACK__@@",nA=t=>"Immutable."+t,QF=t=>"["+t+"]",SN=" ",Qie="…",DKe=(t,e,n,i,r,s,a)=>++i>e.maxDepth?QF(nA(a)):nA(a)+SN+"{"+(0,EN.printIteratorEntries)(t.entries(),e,n,i,r,s)+"}";function PKe(t){let e=0;return{next(){if(e<t._keys.length){const n=t._keys[e++];return{done:!1,value:[n,t.get(n)]}}return{done:!0,value:void 0}}}}const LKe=(t,e,n,i,r,s)=>{const a=nA(t._name||"Record");return++i>e.maxDepth?QF(a):a+SN+"{"+(0,EN.printIteratorEntries)(PKe(t),e,n,i,r,s)+"}"},UKe=(t,e,n,i,r,s)=>{const a=nA("Seq");return++i>e.maxDepth?QF(a):t[RKe]?a+SN+"{"+(t._iter||t._object?(0,EN.printIteratorEntries)(t.entries(),e,n,i,r,s):Qie)+"}":a+SN+"["+(t._iter||t._array||t._collection||t._iterable?(0,EN.printIteratorValues)(t.values(),e,n,i,r,s):Qie)+"]"},tj=(t,e,n,i,r,s,a)=>++i>e.maxDepth?QF(nA(a)):nA(a)+SN+"["+(0,EN.printIteratorValues)(t.values(),e,n,i,r,s)+"]",Vve=(t,e,n,i,r,s)=>t[MKe]?DKe(t,e,n,i,r,s,t[Jie]?"OrderedMap":"Map"):t[AKe]?tj(t,e,n,i,r,s,"List"):t[IKe]?tj(t,e,n,i,r,s,t[Jie]?"OrderedSet":"Set"):t[kKe]?tj(t,e,n,i,r,s,"Stack"):t[NKe]?UKe(t,e,n,i,r,s):LKe(t,e,n,i,r,s);Ub.serialize=Vve;const Gve=t=>t&&(t[CKe]===!0||t[OKe]===!0);Ub.test=Gve;const BKe={serialize:Vve,test:Gve};var FKe=BKe;Ub.default=FKe;var Bb={},qve={exports:{}},Ks={};/** @license React v17.0.2
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var e6=60103,t6=60106,rk=60107,sk=60108,ak=60114,ok=60109,ck=60110,lk=60112,uk=60113,uX=60120,hk=60115,fk=60116,$ve=60121,Wve=60122,Yve=60117,Xve=60129,Kve=60131;if(typeof Symbol=="function"&&Symbol.for){var Il=Symbol.for;e6=Il("react.element"),t6=Il("react.portal"),rk=Il("react.fragment"),sk=Il("react.strict_mode"),ak=Il("react.profiler"),ok=Il("react.provider"),ck=Il("react.context"),lk=Il("react.forward_ref"),uk=Il("react.suspense"),uX=Il("react.suspense_list"),hk=Il("react.memo"),fk=Il("react.lazy"),$ve=Il("react.block"),Wve=Il("react.server.block"),Yve=Il("react.fundamental"),Xve=Il("react.debug_trace_mode"),Kve=Il("react.legacy_hidden")}function Am(t){if(typeof t=="object"&&t!==null){var e=t.$$typeof;switch(e){case e6:switch(t=t.type,t){case rk:case ak:case sk:case uk:case uX:return t;default:switch(t=t&&t.$$typeof,t){case ck:case lk:case fk:case hk:case ok:return t;default:return e}}case t6:return e}}}var zKe=ok,HKe=e6,jKe=lk,VKe=rk,GKe=fk,qKe=hk,$Ke=t6,WKe=ak,YKe=sk,XKe=uk;Ks.ContextConsumer=ck;Ks.ContextProvider=zKe;Ks.Element=HKe;Ks.ForwardRef=jKe;Ks.Fragment=VKe;Ks.Lazy=GKe;Ks.Memo=qKe;Ks.Portal=$Ke;Ks.Profiler=WKe;Ks.StrictMode=YKe;Ks.Suspense=XKe;Ks.isAsyncMode=function(){return!1};Ks.isConcurrentMode=function(){return!1};Ks.isContextConsumer=function(t){return Am(t)===ck};Ks.isContextProvider=function(t){return Am(t)===ok};Ks.isElement=function(t){return typeof t=="object"&&t!==null&&t.$$typeof===e6};Ks.isForwardRef=function(t){return Am(t)===lk};Ks.isFragment=function(t){return Am(t)===rk};Ks.isLazy=function(t){return Am(t)===fk};Ks.isMemo=function(t){return Am(t)===hk};Ks.isPortal=function(t){return Am(t)===t6};Ks.isProfiler=function(t){return Am(t)===ak};Ks.isStrictMode=function(t){return Am(t)===sk};Ks.isSuspense=function(t){return Am(t)===uk};Ks.isValidElementType=function(t){return typeof t=="string"||typeof t=="function"||t===rk||t===ak||t===Xve||t===sk||t===uk||t===uX||t===Kve||typeof t=="object"&&t!==null&&(t.$$typeof===fk||t.$$typeof===hk||t.$$typeof===ok||t.$$typeof===ck||t.$$typeof===lk||t.$$typeof===Yve||t.$$typeof===$ve||t[0]===Wve)};Ks.typeOf=Am;qve.exports=Ks;var KKe=qve.exports;Object.defineProperty(Bb,"__esModule",{value:!0});Bb.test=Bb.serialize=Bb.default=void 0;var XS=ZKe(KKe),MP=uu;function Zve(t){if(typeof WeakMap!="function")return null;var e=new WeakMap,n=new WeakMap;return(Zve=function(i){return i?n:e})(t)}function ZKe(t,e){if(t&&t.__esModule)return t;if(t===null||typeof t!="object"&&typeof t!="function")return{default:t};var n=Zve(e);if(n&&n.has(t))return n.get(t);var i={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var s in t)if(s!=="default"&&Object.prototype.hasOwnProperty.call(t,s)){var a=r?Object.getOwnPropertyDescriptor(t,s):null;a&&(a.get||a.set)?Object.defineProperty(i,s,a):i[s]=t[s]}return i.default=t,n&&n.set(t,i),i}const Jve=(t,e=[])=>(Array.isArray(t)?t.forEach(n=>{Jve(n,e)}):t!=null&&t!==!1&&e.push(t),e),ere=t=>{const e=t.type;if(typeof e=="string")return e;if(typeof e=="function")return e.displayName||e.name||"Unknown";if(XS.isFragment(t))return"React.Fragment";if(XS.isSuspense(t))return"React.Suspense";if(typeof e=="object"&&e!==null){if(XS.isContextProvider(t))return"Context.Provider";if(XS.isContextConsumer(t))return"Context.Consumer";if(XS.isForwardRef(t)){if(e.displayName)return e.displayName;const n=e.render.displayName||e.render.name||"";return n!==""?"ForwardRef("+n+")":"ForwardRef"}if(XS.isMemo(t)){const n=e.displayName||e.type.displayName||e.type.name||"";return n!==""?"Memo("+n+")":"Memo"}}return"UNDEFINED"},JKe=t=>{const{props:e}=t;return Object.keys(e).filter(n=>n!=="children"&&e[n]!==void 0).sort()},Qve=(t,e,n,i,r,s)=>++i>e.maxDepth?(0,MP.printElementAsLeaf)(ere(t),e):(0,MP.printElement)(ere(t),(0,MP.printProps)(JKe(t),t.props,e,n+e.indent,i,r,s),(0,MP.printChildren)(Jve(t.props.children),e,n+e.indent,i,r,s),e,n);Bb.serialize=Qve;const e_e=t=>t!=null&&XS.isElement(t);Bb.test=e_e;const QKe={serialize:Qve,test:e_e};var eZe=QKe;Bb.default=eZe;var Fb={};Object.defineProperty(Fb,"__esModule",{value:!0});Fb.test=Fb.serialize=Fb.default=void 0;var OP=uu,S3=function(){return typeof globalThis<"u"?globalThis:typeof S3<"u"?S3:typeof self<"u"?self:typeof window<"u"?window:Function("return this")()}(),nj=S3["jest-symbol-do-not-touch"]||S3.Symbol;const tZe=typeof nj=="function"&&nj.for?nj.for("react.test.json"):245830487,nZe=t=>{const{props:e}=t;return e?Object.keys(e).filter(n=>e[n]!==void 0).sort():[]},t_e=(t,e,n,i,r,s)=>++i>e.maxDepth?(0,OP.printElementAsLeaf)(t.type,e):(0,OP.printElement)(t.type,t.props?(0,OP.printProps)(nZe(t),t.props,e,n+e.indent,i,r,s):"",t.children?(0,OP.printChildren)(t.children,e,n+e.indent,i,r,s):"",e,n);Fb.serialize=t_e;const n_e=t=>t&&t.$$typeof===tZe;Fb.test=n_e;const iZe={serialize:t_e,test:n_e};var rZe=iZe;Fb.default=rZe;Object.defineProperty(iE,"__esModule",{value:!0});iE.default=iE.DEFAULT_OPTIONS=void 0;var sZe=iE.format=p_e,i_e=iE.plugins=void 0,aZe=AE(Cve),jR=B_,oZe=AE(kb),cZe=AE(Db),lZe=AE(Pb),uZe=AE(Lb),hZe=AE(Ub),fZe=AE(Bb),dZe=AE(Fb);function AE(t){return t&&t.__esModule?t:{default:t}}const r_e=Object.prototype.toString,pZe=Date.prototype.toISOString,mZe=Error.prototype.toString,tre=RegExp.prototype.toString,ij=t=>typeof t.constructor=="function"&&t.constructor.name||"Object",gZe=t=>typeof window<"u"&&t===window,vZe=/^Symbol\((.*)\)(.*)$/,_Ze=/\n/gi;class s_e extends Error{constructor(e,n){super(e),this.stack=n,this.name=this.constructor.name}}function yZe(t){return t==="[object Array]"||t==="[object ArrayBuffer]"||t==="[object DataView]"||t==="[object Float32Array]"||t==="[object Float64Array]"||t==="[object Int8Array]"||t==="[object Int16Array]"||t==="[object Int32Array]"||t==="[object Uint8Array]"||t==="[object Uint8ClampedArray]"||t==="[object Uint16Array]"||t==="[object Uint32Array]"}function bZe(t){return Object.is(t,-0)?"-0":String(t)}function EZe(t){return`${t}n`}function nre(t,e){return e?"[Function "+(t.name||"anonymous")+"]":"[Function]"}function ire(t){return String(t).replace(vZe,"Symbol($1)")}function rre(t){return"["+mZe.call(t)+"]"}function a_e(t,e,n,i){if(t===!0||t===!1)return""+t;if(t===void 0)return"undefined";if(t===null)return"null";const r=typeof t;if(r==="number")return bZe(t);if(r==="bigint")return EZe(t);if(r==="string")return i?'"'+t.replace(/"|\\/g,"\\$&")+'"':'"'+t+'"';if(r==="function")return nre(t,e);if(r==="symbol")return ire(t);const s=r_e.call(t);return s==="[object WeakMap]"?"WeakMap {}":s==="[object WeakSet]"?"WeakSet {}":s==="[object Function]"||s==="[object GeneratorFunction]"?nre(t,e):s==="[object Symbol]"?ire(t):s==="[object Date]"?isNaN(+t)?"Date { NaN }":pZe.call(t):s==="[object Error]"?rre(t):s==="[object RegExp]"?n?tre.call(t).replace(/[\\^$*+?.()|[\]{}]/g,"\\$&"):tre.call(t):t instanceof Error?rre(t):null}function o_e(t,e,n,i,r,s){if(r.indexOf(t)!==-1)return"[Circular]";r=r.slice(),r.push(t);const a=++i>e.maxDepth,o=e.min;if(e.callToJSON&&!a&&t.toJSON&&typeof t.toJSON=="function"&&!s)return Xy(t.toJSON(),e,n,i,r,!0);const c=r_e.call(t);return c==="[object Arguments]"?a?"[Arguments]":(o?"":"Arguments ")+"["+(0,jR.printListItems)(t,e,n,i,r,Xy)+"]":yZe(c)?a?"["+t.constructor.name+"]":(o||!e.printBasicPrototype&&t.constructor.name==="Array"?"":t.constructor.name+" ")+"["+(0,jR.printListItems)(t,e,n,i,r,Xy)+"]":c==="[object Map]"?a?"[Map]":"Map {"+(0,jR.printIteratorEntries)(t.entries(),e,n,i,r,Xy," => ")+"}":c==="[object Set]"?a?"[Set]":"Set {"+(0,jR.printIteratorValues)(t.values(),e,n,i,r,Xy)+"}":a||gZe(t)?"["+ij(t)+"]":(o||!e.printBasicPrototype&&ij(t)==="Object"?"":ij(t)+" ")+"{"+(0,jR.printObjectProperties)(t,e,n,i,r,Xy)+"}"}function SZe(t){return t.serialize!=null}function c_e(t,e,n,i,r,s){let a;try{a=SZe(t)?t.serialize(e,n,i,r,s,Xy):t.print(e,o=>Xy(o,n,i,r,s),o=>{const c=i+n.indent;return c+o.replace(_Ze,`
`+c)},{edgeSpacing:n.spacingOuter,min:n.min,spacing:n.spacingInner},n.colors)}catch(o){throw new s_e(o.message,o.stack)}if(typeof a!="string")throw new Error(`pretty-format: Plugin must return type "string" but instead returned "${typeof a}".`);return a}function l_e(t,e){for(let n=0;n<t.length;n++)try{if(t[n].test(e))return t[n]}catch(i){throw new s_e(i.message,i.stack)}return null}function Xy(t,e,n,i,r,s){const a=l_e(e.plugins,t);if(a!==null)return c_e(a,t,e,n,i,r);const o=a_e(t,e.printFunctionName,e.escapeRegex,e.escapeString);return o!==null?o:o_e(t,e,n,i,r,s)}const hX={comment:"gray",content:"reset",prop:"yellow",tag:"cyan",value:"green"},u_e=Object.keys(hX),rm={callToJSON:!0,compareKeys:void 0,escapeRegex:!1,escapeString:!0,highlight:!1,indent:2,maxDepth:1/0,min:!1,plugins:[],printBasicPrototype:!0,printFunctionName:!0,theme:hX};iE.DEFAULT_OPTIONS=rm;function TZe(t){if(Object.keys(t).forEach(e=>{if(!rm.hasOwnProperty(e))throw new Error(`pretty-format: Unknown option "${e}".`)}),t.min&&t.indent!==void 0&&t.indent!==0)throw new Error('pretty-format: Options "min" and "indent" cannot be used together.');if(t.theme!==void 0){if(t.theme===null)throw new Error('pretty-format: Option "theme" must not be null.');if(typeof t.theme!="object")throw new Error(`pretty-format: Option "theme" must be of type "object" but instead received "${typeof t.theme}".`)}}const xZe=t=>u_e.reduce((e,n)=>{const i=t.theme&&t.theme[n]!==void 0?t.theme[n]:hX[n],r=i&&aZe.default[i];if(r&&typeof r.close=="string"&&typeof r.open=="string")e[n]=r;else throw new Error(`pretty-format: Option "theme" has a key "${n}" whose value "${i}" is undefined in ansi-styles.`);return e},Object.create(null)),wZe=()=>u_e.reduce((t,e)=>(t[e]={close:"",open:""},t),Object.create(null)),h_e=t=>t&&t.printFunctionName!==void 0?t.printFunctionName:rm.printFunctionName,f_e=t=>t&&t.escapeRegex!==void 0?t.escapeRegex:rm.escapeRegex,d_e=t=>t&&t.escapeString!==void 0?t.escapeString:rm.escapeString,sre=t=>{var e;return{callToJSON:t&&t.callToJSON!==void 0?t.callToJSON:rm.callToJSON,colors:t&&t.highlight?xZe(t):wZe(),compareKeys:t&&typeof t.compareKeys=="function"?t.compareKeys:rm.compareKeys,escapeRegex:f_e(t),escapeString:d_e(t),indent:t&&t.min?"":CZe(t&&t.indent!==void 0?t.indent:rm.indent),maxDepth:t&&t.maxDepth!==void 0?t.maxDepth:rm.maxDepth,min:t&&t.min!==void 0?t.min:rm.min,plugins:t&&t.plugins!==void 0?t.plugins:rm.plugins,printBasicPrototype:(e=t==null?void 0:t.printBasicPrototype)!==null&&e!==void 0?e:!0,printFunctionName:h_e(t),spacingInner:t&&t.min?" ":`
`,spacingOuter:t&&t.min?"":`
`}};function CZe(t){return new Array(t+1).join(" ")}function p_e(t,e){if(e&&(TZe(e),e.plugins)){const i=l_e(e.plugins,t);if(i!==null)return c_e(i,t,sre(e),"",0,[])}const n=a_e(t,h_e(e),f_e(e),d_e(e));return n!==null?n:o_e(t,sre(e),"",0,[])}const AZe={AsymmetricMatcher:oZe.default,ConvertAnsi:cZe.default,DOMCollection:lZe.default,DOMElement:uZe.default,Immutable:hZe.default,ReactElement:fZe.default,ReactTestComponent:dZe.default};i_e=iE.plugins=AZe;var RZe=p_e;iE.default=RZe;var MZe=Object.prototype.toString;function OZe(t){return typeof t=="function"||MZe.call(t)==="[object Function]"}function NZe(t){var e=Number(t);return isNaN(e)?0:e===0||!isFinite(e)?e:(e>0?1:-1)*Math.floor(Math.abs(e))}var IZe=Math.pow(2,53)-1;function kZe(t){var e=NZe(t);return Math.min(Math.max(e,0),IZe)}function sm(t,e){var n=Array,i=Object(t);if(t==null)throw new TypeError("Array.from requires an array-like object - not null or undefined");for(var r=kZe(i.length),s=OZe(n)?Object(new n(r)):new Array(r),a=0,o;a<r;)o=i[a],s[a]=o,a+=1;return s.length=r,s}function TN(t){"@babel/helpers - typeof";return TN=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},TN(t)}function DZe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function PZe(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,m_e(i.key),i)}}function LZe(t,e,n){return e&&PZe(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t}function UZe(t,e,n){return e=m_e(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function m_e(t){var e=BZe(t,"string");return TN(e)==="symbol"?e:String(e)}function BZe(t,e){if(TN(t)!=="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(TN(i)!=="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var FZe=function(){function t(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];DZe(this,t),UZe(this,"items",void 0),this.items=e}return LZe(t,[{key:"add",value:function(n){return this.has(n)===!1&&this.items.push(n),this}},{key:"clear",value:function(){this.items=[]}},{key:"delete",value:function(n){var i=this.items.length;return this.items=this.items.filter(function(r){return r!==n}),i!==this.items.length}},{key:"forEach",value:function(n){var i=this;this.items.forEach(function(r){n(r,r,i)})}},{key:"has",value:function(n){return this.items.indexOf(n)!==-1}},{key:"size",get:function(){return this.items.length}}]),t}();const zZe=typeof Set>"u"?Set:FZe;function yu(t){var e;return(e=t.localName)!==null&&e!==void 0?e:t.tagName.toLowerCase()}var HZe={article:"article",aside:"complementary",button:"button",datalist:"listbox",dd:"definition",details:"group",dialog:"dialog",dt:"term",fieldset:"group",figure:"figure",form:"form",footer:"contentinfo",h1:"heading",h2:"heading",h3:"heading",h4:"heading",h5:"heading",h6:"heading",header:"banner",hr:"separator",html:"document",legend:"legend",li:"listitem",math:"math",main:"main",menu:"list",nav:"navigation",ol:"list",optgroup:"group",option:"option",output:"status",progress:"progressbar",section:"region",summary:"button",table:"table",tbody:"rowgroup",textarea:"textbox",tfoot:"rowgroup",td:"cell",th:"columnheader",thead:"rowgroup",tr:"row",ul:"list"},jZe={caption:new Set(["aria-label","aria-labelledby"]),code:new Set(["aria-label","aria-labelledby"]),deletion:new Set(["aria-label","aria-labelledby"]),emphasis:new Set(["aria-label","aria-labelledby"]),generic:new Set(["aria-label","aria-labelledby","aria-roledescription"]),insertion:new Set(["aria-label","aria-labelledby"]),paragraph:new Set(["aria-label","aria-labelledby"]),presentation:new Set(["aria-label","aria-labelledby"]),strong:new Set(["aria-label","aria-labelledby"]),subscript:new Set(["aria-label","aria-labelledby"]),superscript:new Set(["aria-label","aria-labelledby"])};function VZe(t,e){return["aria-atomic","aria-busy","aria-controls","aria-current","aria-describedby","aria-details","aria-dropeffect","aria-flowto","aria-grabbed","aria-hidden","aria-keyshortcuts","aria-label","aria-labelledby","aria-live","aria-owns","aria-relevant","aria-roledescription"].some(function(n){var i;return t.hasAttribute(n)&&!((i=jZe[e])!==null&&i!==void 0&&i.has(n))})}function g_e(t,e){return VZe(t,e)}function GZe(t){var e=$Ze(t);if(e===null||e==="presentation"){var n=qZe(t);if(e!=="presentation"||g_e(t,n||""))return n}return e}function qZe(t){var e=HZe[yu(t)];if(e!==void 0)return e;switch(yu(t)){case"a":case"area":case"link":if(t.hasAttribute("href"))return"link";break;case"img":return t.getAttribute("alt")===""&&!g_e(t,"img")?"presentation":"img";case"input":{var n=t,i=n.type;switch(i){case"button":case"image":case"reset":case"submit":return"button";case"checkbox":case"radio":return i;case"range":return"slider";case"email":case"tel":case"text":case"url":return t.hasAttribute("list")?"combobox":"textbox";case"search":return t.hasAttribute("list")?"combobox":"searchbox";case"number":return"spinbutton";default:return null}}case"select":return t.hasAttribute("multiple")||t.size>1?"listbox":"combobox"}return null}function $Ze(t){var e=t.getAttribute("role");if(e!==null){var n=e.trim().split(" ")[0];if(n.length>0)return n}return null}function ka(t){return t!==null&&t.nodeType===t.ELEMENT_NODE}function v_e(t){return ka(t)&&yu(t)==="caption"}function D2(t){return ka(t)&&yu(t)==="input"}function WZe(t){return ka(t)&&yu(t)==="optgroup"}function YZe(t){return ka(t)&&yu(t)==="select"}function XZe(t){return ka(t)&&yu(t)==="table"}function KZe(t){return ka(t)&&yu(t)==="textarea"}function ZZe(t){var e=t.ownerDocument===null?t:t.ownerDocument,n=e.defaultView;if(n===null)throw new TypeError("no window available");return n}function JZe(t){return ka(t)&&yu(t)==="fieldset"}function QZe(t){return ka(t)&&yu(t)==="legend"}function eJe(t){return ka(t)&&yu(t)==="slot"}function tJe(t){return ka(t)&&t.ownerSVGElement!==void 0}function nJe(t){return ka(t)&&yu(t)==="svg"}function iJe(t){return tJe(t)&&yu(t)==="title"}function T3(t,e){if(ka(t)&&t.hasAttribute(e)){var n=t.getAttribute(e).split(" "),i=t.getRootNode?t.getRootNode():t.ownerDocument;return n.map(function(r){return i.getElementById(r)}).filter(function(r){return r!==null})}return[]}function r_(t,e){return ka(t)?e.indexOf(GZe(t))!==-1:!1}function rJe(t){return t.trim().replace(/\s\s+/g," ")}function sJe(t,e){if(!ka(t))return!1;if(t.hasAttribute("hidden")||t.getAttribute("aria-hidden")==="true")return!0;var n=e(t);return n.getPropertyValue("display")==="none"||n.getPropertyValue("visibility")==="hidden"}function aJe(t){return r_(t,["button","combobox","listbox","textbox"])||__e(t,"range")}function __e(t,e){if(!ka(t))return!1;switch(e){case"range":return r_(t,["meter","progressbar","scrollbar","slider","spinbutton"]);default:throw new TypeError("No knowledge about abstract role '".concat(e,"'. This is likely a bug :("))}}function are(t,e){var n=sm(t.querySelectorAll(e));return T3(t,"aria-owns").forEach(function(i){n.push.apply(n,sm(i.querySelectorAll(e)))}),n}function oJe(t){return YZe(t)?t.selectedOptions||are(t,"[selected]"):are(t,'[aria-selected="true"]')}function cJe(t){return r_(t,["none","presentation"])}function lJe(t){return v_e(t)}function uJe(t){return r_(t,["button","cell","checkbox","columnheader","gridcell","heading","label","legend","link","menuitem","menuitemcheckbox","menuitemradio","option","radio","row","rowheader","switch","tab","tooltip","treeitem"])}function hJe(t){return!1}function fJe(t){return D2(t)||KZe(t)?t.value:t.textContent||""}function ore(t){var e=t.getPropertyValue("content");return/^["'].*["']$/.test(e)?e.slice(1,-1):""}function y_e(t){var e=yu(t);return e==="button"||e==="input"&&t.getAttribute("type")!=="hidden"||e==="meter"||e==="output"||e==="progress"||e==="select"||e==="textarea"}function b_e(t){if(y_e(t))return t;var e=null;return t.childNodes.forEach(function(n){if(e===null&&ka(n)){var i=b_e(n);i!==null&&(e=i)}}),e}function dJe(t){if(t.control!==void 0)return t.control;var e=t.getAttribute("for");return e!==null?t.ownerDocument.getElementById(e):b_e(t)}function pJe(t){var e=t.labels;if(e===null)return e;if(e!==void 0)return sm(e);if(!y_e(t))return null;var n=t.ownerDocument;return sm(n.querySelectorAll("label")).filter(function(i){return dJe(i)===t})}function mJe(t){var e=t.assignedNodes();return e.length===0?sm(t.childNodes):e}function E_e(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=new zZe,i=ZZe(t),r=e.compute,s=r===void 0?"name":r,a=e.computedStyleSupportsPseudoElements,o=a===void 0?e.getComputedStyle!==void 0:a,c=e.getComputedStyle,l=c===void 0?i.getComputedStyle.bind(i):c,u=e.hidden,h=u===void 0?!1:u;function f(v,b){var T="";if(ka(v)&&o){var x=l(v,"::before"),M=ore(x);T="".concat(M," ").concat(T)}var R=eJe(v)?mJe(v):sm(v.childNodes).concat(T3(v,"aria-owns"));if(R.forEach(function(P){var U=y(P,{isEmbeddedInLabel:b.isEmbeddedInLabel,isReferenced:!1,recursion:!0}),G=ka(P)?l(P).getPropertyValue("display"):"inline",$=G!=="inline"?" ":"";T+="".concat($).concat(U).concat($)}),ka(v)&&o){var I=l(v,"::after"),k=ore(I);T="".concat(T," ").concat(k)}return T.trim()}function d(v,b){var T=v.getAttributeNode(b);return T!==null&&!n.has(T)&&T.value.trim()!==""?(n.add(T),T.value):null}function p(v){return ka(v)?d(v,"title"):null}function g(v){if(!ka(v))return null;if(JZe(v)){n.add(v);for(var b=sm(v.childNodes),T=0;T<b.length;T+=1){var x=b[T];if(QZe(x))return y(x,{isEmbeddedInLabel:!1,isReferenced:!1,recursion:!1})}}else if(XZe(v)){n.add(v);for(var M=sm(v.childNodes),R=0;R<M.length;R+=1){var I=M[R];if(v_e(I))return y(I,{isEmbeddedInLabel:!1,isReferenced:!1,recursion:!1})}}else if(nJe(v)){n.add(v);for(var k=sm(v.childNodes),P=0;P<k.length;P+=1){var U=k[P];if(iJe(U))return U.textContent}return null}else if(yu(v)==="img"||yu(v)==="area"){var G=d(v,"alt");if(G!==null)return G}else if(WZe(v)){var $=d(v,"label");if($!==null)return $}if(D2(v)&&(v.type==="button"||v.type==="submit"||v.type==="reset")){var q=d(v,"value");if(q!==null)return q;if(v.type==="submit")return"Submit";if(v.type==="reset")return"Reset"}var Y=pJe(v);if(Y!==null&&Y.length!==0)return n.add(v),sm(Y).map(function(X){return y(X,{isEmbeddedInLabel:!0,isReferenced:!1,recursion:!0})}).filter(function(X){return X.length>0}).join(" ");if(D2(v)&&v.type==="image"){var ie=d(v,"alt");if(ie!==null)return ie;var V=d(v,"title");return V!==null?V:"Submit Query"}if(r_(v,["button"])){var J=f(v,{isEmbeddedInLabel:!1,isReferenced:!1});if(J!=="")return J}return null}function y(v,b){if(n.has(v))return"";if(!h&&sJe(v,l)&&!b.isReferenced)return n.add(v),"";var T=ka(v)?v.getAttributeNode("aria-labelledby"):null,x=T!==null&&!n.has(T)?T3(v,"aria-labelledby"):[];if(s==="name"&&!b.isReferenced&&x.length>0)return n.add(T),x.map(function(G){return y(G,{isEmbeddedInLabel:b.isEmbeddedInLabel,isReferenced:!0,recursion:!1})}).join(" ");var M=b.recursion&&aJe(v)&&s==="name";if(!M){var R=(ka(v)&&v.getAttribute("aria-label")||"").trim();if(R!==""&&s==="name")return n.add(v),R;if(!cJe(v)){var I=g(v);if(I!==null)return n.add(v),I}}if(r_(v,["menu"]))return n.add(v),"";if(M||b.isEmbeddedInLabel||b.isReferenced){if(r_(v,["combobox","listbox"])){n.add(v);var k=oJe(v);return k.length===0?D2(v)?v.value:"":sm(k).map(function(G){return y(G,{isEmbeddedInLabel:b.isEmbeddedInLabel,isReferenced:!1,recursion:!0})}).join(" ")}if(__e(v,"range"))return n.add(v),v.hasAttribute("aria-valuetext")?v.getAttribute("aria-valuetext"):v.hasAttribute("aria-valuenow")?v.getAttribute("aria-valuenow"):v.getAttribute("value")||"";if(r_(v,["textbox"]))return n.add(v),fJe(v)}if(uJe(v)||ka(v)&&b.isReferenced||lJe(v)||hJe()){var P=f(v,{isEmbeddedInLabel:b.isEmbeddedInLabel,isReferenced:!1});if(P!=="")return n.add(v),P}if(v.nodeType===v.TEXT_NODE)return n.add(v),v.textContent||"";if(b.recursion)return n.add(v),f(v,{isEmbeddedInLabel:b.isEmbeddedInLabel,isReferenced:!1});var U=p(v);return U!==null?(n.add(v),U):(n.add(v),"")}return rJe(y(t,{isEmbeddedInLabel:!1,isReferenced:s==="description",recursion:!1}))}function xN(t){"@babel/helpers - typeof";return xN=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},xN(t)}function cre(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter(function(r){return Object.getOwnPropertyDescriptor(t,r).enumerable})),n.push.apply(n,i)}return n}function lre(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?cre(Object(n),!0).forEach(function(i){gJe(t,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):cre(Object(n)).forEach(function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(n,i))})}return t}function gJe(t,e,n){return e=vJe(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function vJe(t){var e=_Je(t,"string");return xN(e)==="symbol"?e:String(e)}function _Je(t,e){if(xN(t)!=="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(xN(i)!=="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function S_e(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=T3(t,"aria-describedby").map(function(r){return E_e(r,lre(lre({},e),{},{compute:"description"}))}).join(" ");if(n===""){var i=t.getAttribute("title");n=i===null?"":i}return n}function yJe(t){return r_(t,["caption","code","deletion","emphasis","generic","insertion","paragraph","presentation","strong","subscript","superscript"])}function fX(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return yJe(t)?"":E_e(t,e)}var cm={},n6={},N1={},i6={};Object.defineProperty(i6,"__esModule",{value:!0});i6.default=void 0;function bJe(){var t=this,e=0,n={"@@iterator":function(){return n},next:function(){if(e<t.length){var r=t[e];return e=e+1,{done:!1,value:r}}else return{done:!0}}};return n}var EJe=bJe;i6.default=EJe;Object.defineProperty(N1,"__esModule",{value:!0});N1.default=xJe;var SJe=TJe(i6);function TJe(t){return t&&t.__esModule?t:{default:t}}function Nq(t){"@babel/helpers - typeof";return Nq=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Nq(t)}function xJe(t,e){return typeof Symbol=="function"&&Nq(Symbol.iterator)==="symbol"&&Object.defineProperty(t,Symbol.iterator,{value:SJe.default.bind(e)}),t}Object.defineProperty(n6,"__esModule",{value:!0});n6.default=void 0;var wJe=CJe(N1);function CJe(t){return t&&t.__esModule?t:{default:t}}function rj(t,e){return MJe(t)||RJe(t,e)||T_e(t,e)||AJe()}function AJe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function RJe(t,e){var n=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(n!=null){var i=[],r=!0,s=!1,a,o;try{for(n=n.call(t);!(r=(a=n.next()).done)&&(i.push(a.value),!(e&&i.length===e));r=!0);}catch(c){s=!0,o=c}finally{try{!r&&n.return!=null&&n.return()}finally{if(s)throw o}}return i}}function MJe(t){if(Array.isArray(t))return t}function OJe(t,e){var n=typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=T_e(t))||e){n&&(t=n);var i=0,r=function(){};return{s:r,n:function(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}},e:function(l){throw l},f:r}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var s=!0,a=!1,o;return{s:function(){n=n.call(t)},n:function(){var l=n.next();return s=l.done,l},e:function(l){a=!0,o=l},f:function(){try{!s&&n.return!=null&&n.return()}finally{if(a)throw o}}}}function T_e(t,e){if(t){if(typeof t=="string")return ure(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);if(n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set")return Array.from(t);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return ure(t,e)}}function ure(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}var Xx=[["aria-activedescendant",{type:"id"}],["aria-atomic",{type:"boolean"}],["aria-autocomplete",{type:"token",values:["inline","list","both","none"]}],["aria-braillelabel",{type:"string"}],["aria-brailleroledescription",{type:"string"}],["aria-busy",{type:"boolean"}],["aria-checked",{type:"tristate"}],["aria-colcount",{type:"integer"}],["aria-colindex",{type:"integer"}],["aria-colspan",{type:"integer"}],["aria-controls",{type:"idlist"}],["aria-current",{type:"token",values:["page","step","location","date","time",!0,!1]}],["aria-describedby",{type:"idlist"}],["aria-description",{type:"string"}],["aria-details",{type:"id"}],["aria-disabled",{type:"boolean"}],["aria-dropeffect",{type:"tokenlist",values:["copy","execute","link","move","none","popup"]}],["aria-errormessage",{type:"id"}],["aria-expanded",{type:"boolean",allowundefined:!0}],["aria-flowto",{type:"idlist"}],["aria-grabbed",{type:"boolean",allowundefined:!0}],["aria-haspopup",{type:"token",values:[!1,!0,"menu","listbox","tree","grid","dialog"]}],["aria-hidden",{type:"boolean",allowundefined:!0}],["aria-invalid",{type:"token",values:["grammar",!1,"spelling",!0]}],["aria-keyshortcuts",{type:"string"}],["aria-label",{type:"string"}],["aria-labelledby",{type:"idlist"}],["aria-level",{type:"integer"}],["aria-live",{type:"token",values:["assertive","off","polite"]}],["aria-modal",{type:"boolean"}],["aria-multiline",{type:"boolean"}],["aria-multiselectable",{type:"boolean"}],["aria-orientation",{type:"token",values:["vertical","undefined","horizontal"]}],["aria-owns",{type:"idlist"}],["aria-placeholder",{type:"string"}],["aria-posinset",{type:"integer"}],["aria-pressed",{type:"tristate"}],["aria-readonly",{type:"boolean"}],["aria-relevant",{type:"tokenlist",values:["additions","all","removals","text"]}],["aria-required",{type:"boolean"}],["aria-roledescription",{type:"string"}],["aria-rowcount",{type:"integer"}],["aria-rowindex",{type:"integer"}],["aria-rowspan",{type:"integer"}],["aria-selected",{type:"boolean",allowundefined:!0}],["aria-setsize",{type:"integer"}],["aria-sort",{type:"token",values:["ascending","descending","none","other"]}],["aria-valuemax",{type:"number"}],["aria-valuemin",{type:"number"}],["aria-valuenow",{type:"number"}],["aria-valuetext",{type:"string"}]],Iq={entries:function(){return Xx},forEach:function(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,i=OJe(Xx),r;try{for(i.s();!(r=i.n()).done;){var s=rj(r.value,2),a=s[0],o=s[1];e.call(n,o,a,Xx)}}catch(c){i.e(c)}finally{i.f()}},get:function(e){var n=Xx.find(function(i){return i[0]===e});return n&&n[1]},has:function(e){return!!Iq.get(e)},keys:function(){return Xx.map(function(e){var n=rj(e,1),i=n[0];return i})},values:function(){return Xx.map(function(e){var n=rj(e,2),i=n[1];return i})}},NJe=(0,wJe.default)(Iq,Iq.entries());n6.default=NJe;var r6={};Object.defineProperty(r6,"__esModule",{value:!0});r6.default=void 0;var IJe=kJe(N1);function kJe(t){return t&&t.__esModule?t:{default:t}}function sj(t,e){return LJe(t)||PJe(t,e)||x_e(t,e)||DJe()}function DJe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function PJe(t,e){var n=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(n!=null){var i=[],r=!0,s=!1,a,o;try{for(n=n.call(t);!(r=(a=n.next()).done)&&(i.push(a.value),!(e&&i.length===e));r=!0);}catch(c){s=!0,o=c}finally{try{!r&&n.return!=null&&n.return()}finally{if(s)throw o}}return i}}function LJe(t){if(Array.isArray(t))return t}function UJe(t,e){var n=typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=x_e(t))||e){n&&(t=n);var i=0,r=function(){};return{s:r,n:function(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}},e:function(l){throw l},f:r}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var s=!0,a=!1,o;return{s:function(){n=n.call(t)},n:function(){var l=n.next();return s=l.done,l},e:function(l){a=!0,o=l},f:function(){try{!s&&n.return!=null&&n.return()}finally{if(a)throw o}}}}function x_e(t,e){if(t){if(typeof t=="string")return hre(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);if(n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set")return Array.from(t);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return hre(t,e)}}function hre(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}var Kx=[["a",{reserved:!1}],["abbr",{reserved:!1}],["acronym",{reserved:!1}],["address",{reserved:!1}],["applet",{reserved:!1}],["area",{reserved:!1}],["article",{reserved:!1}],["aside",{reserved:!1}],["audio",{reserved:!1}],["b",{reserved:!1}],["base",{reserved:!0}],["bdi",{reserved:!1}],["bdo",{reserved:!1}],["big",{reserved:!1}],["blink",{reserved:!1}],["blockquote",{reserved:!1}],["body",{reserved:!1}],["br",{reserved:!1}],["button",{reserved:!1}],["canvas",{reserved:!1}],["caption",{reserved:!1}],["center",{reserved:!1}],["cite",{reserved:!1}],["code",{reserved:!1}],["col",{reserved:!0}],["colgroup",{reserved:!0}],["content",{reserved:!1}],["data",{reserved:!1}],["datalist",{reserved:!1}],["dd",{reserved:!1}],["del",{reserved:!1}],["details",{reserved:!1}],["dfn",{reserved:!1}],["dialog",{reserved:!1}],["dir",{reserved:!1}],["div",{reserved:!1}],["dl",{reserved:!1}],["dt",{reserved:!1}],["em",{reserved:!1}],["embed",{reserved:!1}],["fieldset",{reserved:!1}],["figcaption",{reserved:!1}],["figure",{reserved:!1}],["font",{reserved:!1}],["footer",{reserved:!1}],["form",{reserved:!1}],["frame",{reserved:!1}],["frameset",{reserved:!1}],["h1",{reserved:!1}],["h2",{reserved:!1}],["h3",{reserved:!1}],["h4",{reserved:!1}],["h5",{reserved:!1}],["h6",{reserved:!1}],["head",{reserved:!0}],["header",{reserved:!1}],["hgroup",{reserved:!1}],["hr",{reserved:!1}],["html",{reserved:!0}],["i",{reserved:!1}],["iframe",{reserved:!1}],["img",{reserved:!1}],["input",{reserved:!1}],["ins",{reserved:!1}],["kbd",{reserved:!1}],["keygen",{reserved:!1}],["label",{reserved:!1}],["legend",{reserved:!1}],["li",{reserved:!1}],["link",{reserved:!0}],["main",{reserved:!1}],["map",{reserved:!1}],["mark",{reserved:!1}],["marquee",{reserved:!1}],["menu",{reserved:!1}],["menuitem",{reserved:!1}],["meta",{reserved:!0}],["meter",{reserved:!1}],["nav",{reserved:!1}],["noembed",{reserved:!0}],["noscript",{reserved:!0}],["object",{reserved:!1}],["ol",{reserved:!1}],["optgroup",{reserved:!1}],["option",{reserved:!1}],["output",{reserved:!1}],["p",{reserved:!1}],["param",{reserved:!0}],["picture",{reserved:!0}],["pre",{reserved:!1}],["progress",{reserved:!1}],["q",{reserved:!1}],["rp",{reserved:!1}],["rt",{reserved:!1}],["rtc",{reserved:!1}],["ruby",{reserved:!1}],["s",{reserved:!1}],["samp",{reserved:!1}],["script",{reserved:!0}],["section",{reserved:!1}],["select",{reserved:!1}],["small",{reserved:!1}],["source",{reserved:!0}],["spacer",{reserved:!1}],["span",{reserved:!1}],["strike",{reserved:!1}],["strong",{reserved:!1}],["style",{reserved:!0}],["sub",{reserved:!1}],["summary",{reserved:!1}],["sup",{reserved:!1}],["table",{reserved:!1}],["tbody",{reserved:!1}],["td",{reserved:!1}],["textarea",{reserved:!1}],["tfoot",{reserved:!1}],["th",{reserved:!1}],["thead",{reserved:!1}],["time",{reserved:!1}],["title",{reserved:!0}],["tr",{reserved:!1}],["track",{reserved:!0}],["tt",{reserved:!1}],["u",{reserved:!1}],["ul",{reserved:!1}],["var",{reserved:!1}],["video",{reserved:!1}],["wbr",{reserved:!1}],["xmp",{reserved:!1}]],kq={entries:function(){return Kx},forEach:function(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,i=UJe(Kx),r;try{for(i.s();!(r=i.n()).done;){var s=sj(r.value,2),a=s[0],o=s[1];e.call(n,o,a,Kx)}}catch(c){i.e(c)}finally{i.f()}},get:function(e){var n=Kx.find(function(i){return i[0]===e});return n&&n[1]},has:function(e){return!!kq.get(e)},keys:function(){return Kx.map(function(e){var n=sj(e,1),i=n[0];return i})},values:function(){return Kx.map(function(e){var n=sj(e,2),i=n[1];return i})}},BJe=(0,IJe.default)(kq,kq.entries());r6.default=BJe;var jA={},s6={},a6={};Object.defineProperty(a6,"__esModule",{value:!0});a6.default=void 0;var FJe={abstract:!0,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{},relatedConcepts:[],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","widget"]]},zJe=FJe;a6.default=zJe;var o6={};Object.defineProperty(o6,"__esModule",{value:!0});o6.default=void 0;var HJe={abstract:!0,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-activedescendant":null,"aria-disabled":null},relatedConcepts:[],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","widget"]]},jJe=HJe;o6.default=jJe;var c6={};Object.defineProperty(c6,"__esModule",{value:!0});c6.default=void 0;var VJe={abstract:!0,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-disabled":null},relatedConcepts:[{concept:{name:"input"},module:"XForms"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","widget"]]},GJe=VJe;c6.default=GJe;var l6={};Object.defineProperty(l6,"__esModule",{value:!0});l6.default=void 0;var qJe={abstract:!0,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{},relatedConcepts:[],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section"]]},$Je=qJe;l6.default=$Je;var u6={};Object.defineProperty(u6,"__esModule",{value:!0});u6.default=void 0;var WJe={abstract:!0,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-valuemax":null,"aria-valuemin":null,"aria-valuenow":null},relatedConcepts:[],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure"]]},YJe=WJe;u6.default=YJe;var h6={};Object.defineProperty(h6,"__esModule",{value:!0});h6.default=void 0;var XJe={abstract:!0,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:[],prohibitedProps:[],props:{"aria-atomic":null,"aria-busy":null,"aria-controls":null,"aria-current":null,"aria-describedby":null,"aria-details":null,"aria-dropeffect":null,"aria-flowto":null,"aria-grabbed":null,"aria-hidden":null,"aria-keyshortcuts":null,"aria-label":null,"aria-labelledby":null,"aria-live":null,"aria-owns":null,"aria-relevant":null,"aria-roledescription":null},relatedConcepts:[{concept:{name:"role"},module:"XHTML"},{concept:{name:"type"},module:"Dublin Core"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[]},KJe=XJe;h6.default=KJe;var f6={};Object.defineProperty(f6,"__esModule",{value:!0});f6.default=void 0;var ZJe={abstract:!0,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:[],prohibitedProps:[],props:{},relatedConcepts:[{concept:{name:"frontmatter"},module:"DTB"},{concept:{name:"level"},module:"DTB"},{concept:{name:"level"},module:"SMIL"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure"]]},JJe=ZJe;f6.default=JJe;var d6={};Object.defineProperty(d6,"__esModule",{value:!0});d6.default=void 0;var QJe={abstract:!0,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author","contents"],prohibitedProps:[],props:{},relatedConcepts:[],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure"]]},eQe=QJe;d6.default=eQe;var p6={};Object.defineProperty(p6,"__esModule",{value:!0});p6.default=void 0;var tQe={abstract:!0,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-orientation":null},relatedConcepts:[],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","widget","composite"],["roletype","structure","section","group"]]},nQe=tQe;p6.default=nQe;var m6={};Object.defineProperty(m6,"__esModule",{value:!0});m6.default=void 0;var iQe={abstract:!0,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:[],prohibitedProps:[],props:{},relatedConcepts:[],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype"]]},rQe=iQe;m6.default=rQe;var g6={};Object.defineProperty(g6,"__esModule",{value:!0});g6.default=void 0;var sQe={abstract:!0,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:[],prohibitedProps:[],props:{},relatedConcepts:[],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype"]]},aQe=sQe;g6.default=aQe;var v6={};Object.defineProperty(v6,"__esModule",{value:!0});v6.default=void 0;var oQe={abstract:!0,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-modal":null},relatedConcepts:[],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype"]]},cQe=oQe;v6.default=cQe;Object.defineProperty(s6,"__esModule",{value:!0});s6.default=void 0;var lQe=Rp(a6),uQe=Rp(o6),hQe=Rp(c6),fQe=Rp(l6),dQe=Rp(u6),pQe=Rp(h6),mQe=Rp(f6),gQe=Rp(d6),vQe=Rp(p6),_Qe=Rp(m6),yQe=Rp(g6),bQe=Rp(v6);function Rp(t){return t&&t.__esModule?t:{default:t}}var EQe=[["command",lQe.default],["composite",uQe.default],["input",hQe.default],["landmark",fQe.default],["range",dQe.default],["roletype",pQe.default],["section",mQe.default],["sectionhead",gQe.default],["select",vQe.default],["structure",_Qe.default],["widget",yQe.default],["window",bQe.default]],SQe=EQe;s6.default=SQe;var _6={},y6={};Object.defineProperty(y6,"__esModule",{value:!0});y6.default=void 0;var TQe={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-atomic":"true","aria-live":"assertive"},relatedConcepts:[{concept:{name:"alert"},module:"XForms"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section"]]},xQe=TQe;y6.default=xQe;var b6={};Object.defineProperty(b6,"__esModule",{value:!0});b6.default=void 0;var wQe={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{},relatedConcepts:[{concept:{name:"alert"},module:"XForms"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section","alert"],["roletype","window","dialog"]]},CQe=wQe;b6.default=CQe;var E6={};Object.defineProperty(E6,"__esModule",{value:!0});E6.default=void 0;var AQe={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-activedescendant":null,"aria-disabled":null,"aria-errormessage":null,"aria-expanded":null,"aria-haspopup":null,"aria-invalid":null},relatedConcepts:[{concept:{name:"Device Independence Delivery Unit"}}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure"]]},RQe=AQe;E6.default=RQe;var S6={};Object.defineProperty(S6,"__esModule",{value:!0});S6.default=void 0;var MQe={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-posinset":null,"aria-setsize":null},relatedConcepts:[{concept:{name:"article"},module:"HTML"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","document"]]},OQe=MQe;S6.default=OQe;var T6={};Object.defineProperty(T6,"__esModule",{value:!0});T6.default=void 0;var NQe={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{},relatedConcepts:[{concept:{constraints:["scoped to the body element"],name:"header"},module:"HTML"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section","landmark"]]},IQe=NQe;T6.default=IQe;var x6={};Object.defineProperty(x6,"__esModule",{value:!0});x6.default=void 0;var kQe={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{},relatedConcepts:[{concept:{name:"blockquote"},module:"HTML"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section"]]},DQe=kQe;x6.default=DQe;var w6={};Object.defineProperty(w6,"__esModule",{value:!0});w6.default=void 0;var PQe={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!0,nameFrom:["author","contents"],prohibitedProps:[],props:{"aria-disabled":null,"aria-expanded":null,"aria-haspopup":null,"aria-pressed":null},relatedConcepts:[{concept:{attributes:[{name:"type",value:"button"}],name:"input"},module:"HTML"},{concept:{attributes:[{name:"type",value:"image"}],name:"input"},module:"HTML"},{concept:{attributes:[{name:"type",value:"reset"}],name:"input"},module:"HTML"},{concept:{attributes:[{name:"type",value:"submit"}],name:"input"},module:"HTML"},{concept:{name:"button"},module:"HTML"},{concept:{name:"trigger"},module:"XForms"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","widget","command"]]},LQe=PQe;w6.default=LQe;var C6={};Object.defineProperty(C6,"__esModule",{value:!0});C6.default=void 0;var UQe={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["prohibited"],prohibitedProps:["aria-label","aria-labelledby"],props:{},relatedConcepts:[{concept:{name:"caption"},module:"HTML"}],requireContextRole:["figure","grid","table"],requiredContextRole:["figure","grid","table"],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section"]]},BQe=UQe;C6.default=BQe;var A6={};Object.defineProperty(A6,"__esModule",{value:!0});A6.default=void 0;var FQe={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author","contents"],prohibitedProps:[],props:{"aria-colindex":null,"aria-colspan":null,"aria-rowindex":null,"aria-rowspan":null},relatedConcepts:[{concept:{constraints:["ancestor table element has table role"],name:"td"},module:"HTML"}],requireContextRole:["row"],requiredContextRole:["row"],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section"]]},zQe=FQe;A6.default=zQe;var R6={};Object.defineProperty(R6,"__esModule",{value:!0});R6.default=void 0;var HQe={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!0,nameFrom:["author","contents"],prohibitedProps:[],props:{"aria-checked":null,"aria-errormessage":null,"aria-expanded":null,"aria-invalid":null,"aria-readonly":null,"aria-required":null},relatedConcepts:[{concept:{attributes:[{name:"type",value:"checkbox"}],name:"input"},module:"HTML"},{concept:{name:"option"},module:"ARIA"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{"aria-checked":null},superClass:[["roletype","widget","input"]]},jQe=HQe;R6.default=jQe;var M6={};Object.defineProperty(M6,"__esModule",{value:!0});M6.default=void 0;var VQe={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["prohibited"],prohibitedProps:["aria-label","aria-labelledby"],props:{},relatedConcepts:[{concept:{name:"code"},module:"HTML"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section"]]},GQe=VQe;M6.default=GQe;var O6={};Object.defineProperty(O6,"__esModule",{value:!0});O6.default=void 0;var qQe={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!1,nameFrom:["author","contents"],prohibitedProps:[],props:{"aria-sort":null},relatedConcepts:[{concept:{name:"th"},module:"HTML"},{concept:{attributes:[{name:"scope",value:"col"}],name:"th"},module:"HTML"},{concept:{attributes:[{name:"scope",value:"colgroup"}],name:"th"},module:"HTML"}],requireContextRole:["row"],requiredContextRole:["row"],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section","cell"],["roletype","structure","section","cell","gridcell"],["roletype","widget","gridcell"],["roletype","structure","sectionhead"]]},$Qe=qQe;O6.default=$Qe;var N6={};Object.defineProperty(N6,"__esModule",{value:!0});N6.default=void 0;var WQe={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-activedescendant":null,"aria-autocomplete":null,"aria-errormessage":null,"aria-invalid":null,"aria-readonly":null,"aria-required":null,"aria-expanded":"false","aria-haspopup":"listbox"},relatedConcepts:[{concept:{attributes:[{constraints:["set"],name:"list"},{name:"type",value:"email"}],name:"input"},module:"HTML"},{concept:{attributes:[{constraints:["set"],name:"list"},{name:"type",value:"search"}],name:"input"},module:"HTML"},{concept:{attributes:[{constraints:["set"],name:"list"},{name:"type",value:"tel"}],name:"input"},module:"HTML"},{concept:{attributes:[{constraints:["set"],name:"list"},{name:"type",value:"text"}],name:"input"},module:"HTML"},{concept:{attributes:[{constraints:["set"],name:"list"},{name:"type",value:"url"}],name:"input"},module:"HTML"},{concept:{attributes:[{constraints:["set"],name:"list"},{name:"type",value:"url"}],name:"input"},module:"HTML"},{concept:{attributes:[{constraints:["undefined"],name:"multiple"},{constraints:["undefined"],name:"size"}],constraints:["the multiple attribute is not set and the size attribute does not have a value greater than 1"],name:"select"},module:"HTML"},{concept:{name:"select"},module:"XForms"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{"aria-controls":null,"aria-expanded":"false"},superClass:[["roletype","widget","input"]]},YQe=WQe;N6.default=YQe;var I6={};Object.defineProperty(I6,"__esModule",{value:!0});I6.default=void 0;var XQe={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{},relatedConcepts:[{concept:{name:"aside"},module:"HTML"},{concept:{attributes:[{constraints:["set"],name:"aria-label"}],constraints:["scoped to a sectioning content element","scoped to a sectioning root element other than body"],name:"aside"},module:"HTML"},{concept:{attributes:[{constraints:["set"],name:"aria-labelledby"}],constraints:["scoped to a sectioning content element","scoped to a sectioning root element other than body"],name:"aside"},module:"HTML"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section","landmark"]]},KQe=XQe;I6.default=KQe;var k6={};Object.defineProperty(k6,"__esModule",{value:!0});k6.default=void 0;var ZQe={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{},relatedConcepts:[{concept:{constraints:["scoped to the body element"],name:"footer"},module:"HTML"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section","landmark"]]},JQe=ZQe;k6.default=JQe;var D6={};Object.defineProperty(D6,"__esModule",{value:!0});D6.default=void 0;var QQe={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{},relatedConcepts:[{concept:{name:"dd"},module:"HTML"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section"]]},eet=QQe;D6.default=eet;var P6={};Object.defineProperty(P6,"__esModule",{value:!0});P6.default=void 0;var tet={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["prohibited"],prohibitedProps:["aria-label","aria-labelledby"],props:{},relatedConcepts:[{concept:{name:"del"},module:"HTML"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section"]]},net=tet;P6.default=net;var L6={};Object.defineProperty(L6,"__esModule",{value:!0});L6.default=void 0;var iet={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{},relatedConcepts:[{concept:{name:"dialog"},module:"HTML"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","window"]]},ret=iet;L6.default=ret;var U6={};Object.defineProperty(U6,"__esModule",{value:!0});U6.default=void 0;var set={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{},relatedConcepts:[{module:"DAISY Guide"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section","list"]]},aet=set;U6.default=aet;var B6={};Object.defineProperty(B6,"__esModule",{value:!0});B6.default=void 0;var oet={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{},relatedConcepts:[{concept:{name:"Device Independence Delivery Unit"}},{concept:{name:"html"},module:"HTML"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure"]]},cet=oet;B6.default=cet;var F6={};Object.defineProperty(F6,"__esModule",{value:!0});F6.default=void 0;var uet={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["prohibited"],prohibitedProps:["aria-label","aria-labelledby"],props:{},relatedConcepts:[{concept:{name:"em"},module:"HTML"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section"]]},het=uet;F6.default=het;var z6={};Object.defineProperty(z6,"__esModule",{value:!0});z6.default=void 0;var fet={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{},relatedConcepts:[],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[["article"]],requiredProps:{},superClass:[["roletype","structure","section","list"]]},det=fet;z6.default=det;var H6={};Object.defineProperty(H6,"__esModule",{value:!0});H6.default=void 0;var pet={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{},relatedConcepts:[{concept:{name:"figure"},module:"HTML"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section"]]},met=pet;H6.default=met;var j6={};Object.defineProperty(j6,"__esModule",{value:!0});j6.default=void 0;var get={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{},relatedConcepts:[{concept:{attributes:[{constraints:["set"],name:"aria-label"}],name:"form"},module:"HTML"},{concept:{attributes:[{constraints:["set"],name:"aria-labelledby"}],name:"form"},module:"HTML"},{concept:{attributes:[{constraints:["set"],name:"name"}],name:"form"},module:"HTML"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section","landmark"]]},vet=get;j6.default=vet;var V6={};Object.defineProperty(V6,"__esModule",{value:!0});V6.default=void 0;var _et={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["prohibited"],prohibitedProps:["aria-label","aria-labelledby"],props:{},relatedConcepts:[{concept:{name:"a"},module:"HTML"},{concept:{name:"area"},module:"HTML"},{concept:{name:"aside"},module:"HTML"},{concept:{name:"b"},module:"HTML"},{concept:{name:"bdo"},module:"HTML"},{concept:{name:"body"},module:"HTML"},{concept:{name:"data"},module:"HTML"},{concept:{name:"div"},module:"HTML"},{concept:{constraints:["scoped to the main element","scoped to a sectioning content element","scoped to a sectioning root element other than body"],name:"footer"},module:"HTML"},{concept:{constraints:["scoped to the main element","scoped to a sectioning content element","scoped to a sectioning root element other than body"],name:"header"},module:"HTML"},{concept:{name:"hgroup"},module:"HTML"},{concept:{name:"i"},module:"HTML"},{concept:{name:"pre"},module:"HTML"},{concept:{name:"q"},module:"HTML"},{concept:{name:"samp"},module:"HTML"},{concept:{name:"section"},module:"HTML"},{concept:{name:"small"},module:"HTML"},{concept:{name:"span"},module:"HTML"},{concept:{name:"u"},module:"HTML"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure"]]},yet=_et;V6.default=yet;var G6={};Object.defineProperty(G6,"__esModule",{value:!0});G6.default=void 0;var bet={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-multiselectable":null,"aria-readonly":null},relatedConcepts:[],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[["row"],["row","rowgroup"]],requiredProps:{},superClass:[["roletype","widget","composite"],["roletype","structure","section","table"]]},Eet=bet;G6.default=Eet;var q6={};Object.defineProperty(q6,"__esModule",{value:!0});q6.default=void 0;var Tet={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author","contents"],prohibitedProps:[],props:{"aria-disabled":null,"aria-errormessage":null,"aria-expanded":null,"aria-haspopup":null,"aria-invalid":null,"aria-readonly":null,"aria-required":null,"aria-selected":null},relatedConcepts:[{concept:{constraints:["ancestor table element has grid role","ancestor table element has treegrid role"],name:"td"},module:"HTML"}],requireContextRole:["row"],requiredContextRole:["row"],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section","cell"],["roletype","widget"]]},xet=Tet;q6.default=xet;var $6={};Object.defineProperty($6,"__esModule",{value:!0});$6.default=void 0;var wet={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-activedescendant":null,"aria-disabled":null},relatedConcepts:[{concept:{name:"details"},module:"HTML"},{concept:{name:"fieldset"},module:"HTML"},{concept:{name:"optgroup"},module:"HTML"},{concept:{name:"address"},module:"HTML"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section"]]},Cet=wet;$6.default=Cet;var W6={};Object.defineProperty(W6,"__esModule",{value:!0});W6.default=void 0;var Aet={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!1,nameFrom:["author","contents"],prohibitedProps:[],props:{"aria-level":"2"},relatedConcepts:[{concept:{name:"h1"},module:"HTML"},{concept:{name:"h2"},module:"HTML"},{concept:{name:"h3"},module:"HTML"},{concept:{name:"h4"},module:"HTML"},{concept:{name:"h5"},module:"HTML"},{concept:{name:"h6"},module:"HTML"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{"aria-level":"2"},superClass:[["roletype","structure","sectionhead"]]},Ret=Aet;W6.default=Ret;var Y6={};Object.defineProperty(Y6,"__esModule",{value:!0});Y6.default=void 0;var Met={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!0,nameFrom:["author"],prohibitedProps:[],props:{},relatedConcepts:[{concept:{attributes:[{constraints:["set"],name:"alt"}],name:"img"},module:"HTML"},{concept:{attributes:[{constraints:["undefined"],name:"alt"}],name:"img"},module:"HTML"},{concept:{name:"imggroup"},module:"DTB"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section"]]},Oet=Met;Y6.default=Oet;var X6={};Object.defineProperty(X6,"__esModule",{value:!0});X6.default=void 0;var Net={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["prohibited"],prohibitedProps:["aria-label","aria-labelledby"],props:{},relatedConcepts:[{concept:{name:"ins"},module:"HTML"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section"]]},Iet=Net;X6.default=Iet;var K6={};Object.defineProperty(K6,"__esModule",{value:!0});K6.default=void 0;var ket={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!1,nameFrom:["author","contents"],prohibitedProps:[],props:{"aria-disabled":null,"aria-expanded":null,"aria-haspopup":null},relatedConcepts:[{concept:{attributes:[{constraints:["set"],name:"href"}],name:"a"},module:"HTML"},{concept:{attributes:[{constraints:["set"],name:"href"}],name:"area"},module:"HTML"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","widget","command"]]},Det=ket;K6.default=Det;var Z6={};Object.defineProperty(Z6,"__esModule",{value:!0});Z6.default=void 0;var Pet={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{},relatedConcepts:[{concept:{name:"menu"},module:"HTML"},{concept:{name:"ol"},module:"HTML"},{concept:{name:"ul"},module:"HTML"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[["listitem"]],requiredProps:{},superClass:[["roletype","structure","section"]]},Let=Pet;Z6.default=Let;var J6={};Object.defineProperty(J6,"__esModule",{value:!0});J6.default=void 0;var Uet={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-errormessage":null,"aria-expanded":null,"aria-invalid":null,"aria-multiselectable":null,"aria-readonly":null,"aria-required":null,"aria-orientation":"vertical"},relatedConcepts:[{concept:{attributes:[{constraints:[">1"],name:"size"}],constraints:["the size attribute value is greater than 1"],name:"select"},module:"HTML"},{concept:{attributes:[{name:"multiple"}],name:"select"},module:"HTML"},{concept:{name:"datalist"},module:"HTML"},{concept:{name:"list"},module:"ARIA"},{concept:{name:"select"},module:"XForms"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[["option","group"],["option"]],requiredProps:{},superClass:[["roletype","widget","composite","select"],["roletype","structure","section","group","select"]]},Bet=Uet;J6.default=Bet;var Q6={};Object.defineProperty(Q6,"__esModule",{value:!0});Q6.default=void 0;var Fet={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-level":null,"aria-posinset":null,"aria-setsize":null},relatedConcepts:[{concept:{constraints:["direct descendant of ol","direct descendant of ul","direct descendant of menu"],name:"li"},module:"HTML"},{concept:{name:"item"},module:"XForms"}],requireContextRole:["directory","list"],requiredContextRole:["directory","list"],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section"]]},zet=Fet;Q6.default=zet;var e4={};Object.defineProperty(e4,"__esModule",{value:!0});e4.default=void 0;var Het={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-live":"polite"},relatedConcepts:[],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section"]]},jet=Het;e4.default=jet;var t4={};Object.defineProperty(t4,"__esModule",{value:!0});t4.default=void 0;var Vet={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{},relatedConcepts:[{concept:{name:"main"},module:"HTML"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section","landmark"]]},Get=Vet;t4.default=Get;var n4={};Object.defineProperty(n4,"__esModule",{value:!0});n4.default=void 0;var qet={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["prohibited"],prohibitedProps:[],props:{"aria-braillelabel":null,"aria-brailleroledescription":null,"aria-description":null},relatedConcepts:[{concept:{name:"mark"},module:"HTML"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section"]]},$et=qet;n4.default=$et;var i4={};Object.defineProperty(i4,"__esModule",{value:!0});i4.default=void 0;var Wet={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{},relatedConcepts:[],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section"]]},Yet=Wet;i4.default=Yet;var r4={};Object.defineProperty(r4,"__esModule",{value:!0});r4.default=void 0;var Xet={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{},relatedConcepts:[{concept:{name:"math"},module:"HTML"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section"]]},Ket=Xet;r4.default=Ket;var s4={};Object.defineProperty(s4,"__esModule",{value:!0});s4.default=void 0;var Zet={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-orientation":"vertical"},relatedConcepts:[{concept:{name:"MENU"},module:"JAPI"},{concept:{name:"list"},module:"ARIA"},{concept:{name:"select"},module:"XForms"},{concept:{name:"sidebar"},module:"DTB"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[["menuitem","group"],["menuitemradio","group"],["menuitemcheckbox","group"],["menuitem"],["menuitemcheckbox"],["menuitemradio"]],requiredProps:{},superClass:[["roletype","widget","composite","select"],["roletype","structure","section","group","select"]]},Jet=Zet;s4.default=Jet;var a4={};Object.defineProperty(a4,"__esModule",{value:!0});a4.default=void 0;var Qet={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-orientation":"horizontal"},relatedConcepts:[{concept:{name:"toolbar"},module:"ARIA"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[["menuitem","group"],["menuitemradio","group"],["menuitemcheckbox","group"],["menuitem"],["menuitemcheckbox"],["menuitemradio"]],requiredProps:{},superClass:[["roletype","widget","composite","select","menu"],["roletype","structure","section","group","select","menu"]]},ett=Qet;a4.default=ett;var o4={};Object.defineProperty(o4,"__esModule",{value:!0});o4.default=void 0;var ttt={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!1,nameFrom:["author","contents"],prohibitedProps:[],props:{"aria-disabled":null,"aria-expanded":null,"aria-haspopup":null,"aria-posinset":null,"aria-setsize":null},relatedConcepts:[{concept:{name:"MENU_ITEM"},module:"JAPI"},{concept:{name:"listitem"},module:"ARIA"},{concept:{name:"option"},module:"ARIA"}],requireContextRole:["group","menu","menubar"],requiredContextRole:["group","menu","menubar"],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","widget","command"]]},ntt=ttt;o4.default=ntt;var c4={};Object.defineProperty(c4,"__esModule",{value:!0});c4.default=void 0;var itt={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!0,nameFrom:["author","contents"],prohibitedProps:[],props:{},relatedConcepts:[{concept:{name:"menuitem"},module:"ARIA"}],requireContextRole:["group","menu","menubar"],requiredContextRole:["group","menu","menubar"],requiredOwnedElements:[],requiredProps:{"aria-checked":null},superClass:[["roletype","widget","input","checkbox"],["roletype","widget","command","menuitem"]]},rtt=itt;c4.default=rtt;var l4={};Object.defineProperty(l4,"__esModule",{value:!0});l4.default=void 0;var stt={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!0,nameFrom:["author","contents"],prohibitedProps:[],props:{},relatedConcepts:[{concept:{name:"menuitem"},module:"ARIA"}],requireContextRole:["group","menu","menubar"],requiredContextRole:["group","menu","menubar"],requiredOwnedElements:[],requiredProps:{"aria-checked":null},superClass:[["roletype","widget","input","checkbox","menuitemcheckbox"],["roletype","widget","command","menuitem","menuitemcheckbox"],["roletype","widget","input","radio"]]},att=stt;l4.default=att;var u4={};Object.defineProperty(u4,"__esModule",{value:!0});u4.default=void 0;var ott={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!0,nameFrom:["author"],prohibitedProps:[],props:{"aria-valuetext":null,"aria-valuemax":"100","aria-valuemin":"0"},relatedConcepts:[{concept:{name:"meter"},module:"HTML"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{"aria-valuenow":null},superClass:[["roletype","structure","range"]]},ctt=ott;u4.default=ctt;var h4={};Object.defineProperty(h4,"__esModule",{value:!0});h4.default=void 0;var ltt={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{},relatedConcepts:[{concept:{name:"nav"},module:"HTML"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section","landmark"]]},utt=ltt;h4.default=utt;var f4={};Object.defineProperty(f4,"__esModule",{value:!0});f4.default=void 0;var htt={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:[],prohibitedProps:[],props:{},relatedConcepts:[],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[]},ftt=htt;f4.default=ftt;var d4={};Object.defineProperty(d4,"__esModule",{value:!0});d4.default=void 0;var dtt={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{},relatedConcepts:[],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section"]]},ptt=dtt;d4.default=ptt;var p4={};Object.defineProperty(p4,"__esModule",{value:!0});p4.default=void 0;var mtt={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!0,nameFrom:["author","contents"],prohibitedProps:[],props:{"aria-checked":null,"aria-posinset":null,"aria-setsize":null,"aria-selected":"false"},relatedConcepts:[{concept:{name:"item"},module:"XForms"},{concept:{name:"listitem"},module:"ARIA"},{concept:{name:"option"},module:"HTML"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{"aria-selected":"false"},superClass:[["roletype","widget","input"]]},gtt=mtt;p4.default=gtt;var m4={};Object.defineProperty(m4,"__esModule",{value:!0});m4.default=void 0;var vtt={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["prohibited"],prohibitedProps:["aria-label","aria-labelledby"],props:{},relatedConcepts:[{concept:{name:"p"},module:"HTML"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section"]]},_tt=vtt;m4.default=_tt;var g4={};Object.defineProperty(g4,"__esModule",{value:!0});g4.default=void 0;var ytt={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["prohibited"],prohibitedProps:["aria-label","aria-labelledby"],props:{},relatedConcepts:[{concept:{attributes:[{name:"alt",value:""}],name:"img"},module:"HTML"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure"]]},btt=ytt;g4.default=btt;var v4={};Object.defineProperty(v4,"__esModule",{value:!0});v4.default=void 0;var Ett={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!0,nameFrom:["author"],prohibitedProps:[],props:{"aria-valuetext":null},relatedConcepts:[{concept:{name:"progress"},module:"HTML"},{concept:{name:"status"},module:"ARIA"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","range"],["roletype","widget"]]},Stt=Ett;v4.default=Stt;var _4={};Object.defineProperty(_4,"__esModule",{value:!0});_4.default=void 0;var Ttt={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!0,nameFrom:["author","contents"],prohibitedProps:[],props:{"aria-checked":null,"aria-posinset":null,"aria-setsize":null},relatedConcepts:[{concept:{attributes:[{name:"type",value:"radio"}],name:"input"},module:"HTML"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{"aria-checked":null},superClass:[["roletype","widget","input"]]},xtt=Ttt;_4.default=xtt;var y4={};Object.defineProperty(y4,"__esModule",{value:!0});y4.default=void 0;var wtt={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-errormessage":null,"aria-invalid":null,"aria-readonly":null,"aria-required":null},relatedConcepts:[{concept:{name:"list"},module:"ARIA"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[["radio"]],requiredProps:{},superClass:[["roletype","widget","composite","select"],["roletype","structure","section","group","select"]]},Ctt=wtt;y4.default=Ctt;var b4={};Object.defineProperty(b4,"__esModule",{value:!0});b4.default=void 0;var Att={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{},relatedConcepts:[{concept:{attributes:[{constraints:["set"],name:"aria-label"}],name:"section"},module:"HTML"},{concept:{attributes:[{constraints:["set"],name:"aria-labelledby"}],name:"section"},module:"HTML"},{concept:{name:"Device Independence Glossart perceivable unit"}}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section","landmark"]]},Rtt=Att;b4.default=Rtt;var E4={};Object.defineProperty(E4,"__esModule",{value:!0});E4.default=void 0;var Mtt={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author","contents"],prohibitedProps:[],props:{"aria-colindex":null,"aria-expanded":null,"aria-level":null,"aria-posinset":null,"aria-rowindex":null,"aria-selected":null,"aria-setsize":null},relatedConcepts:[{concept:{name:"tr"},module:"HTML"}],requireContextRole:["grid","rowgroup","table","treegrid"],requiredContextRole:["grid","rowgroup","table","treegrid"],requiredOwnedElements:[["cell"],["columnheader"],["gridcell"],["rowheader"]],requiredProps:{},superClass:[["roletype","structure","section","group"],["roletype","widget"]]},Ott=Mtt;E4.default=Ott;var S4={};Object.defineProperty(S4,"__esModule",{value:!0});S4.default=void 0;var Ntt={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author","contents"],prohibitedProps:[],props:{},relatedConcepts:[{concept:{name:"tbody"},module:"HTML"},{concept:{name:"tfoot"},module:"HTML"},{concept:{name:"thead"},module:"HTML"}],requireContextRole:["grid","table","treegrid"],requiredContextRole:["grid","table","treegrid"],requiredOwnedElements:[["row"]],requiredProps:{},superClass:[["roletype","structure"]]},Itt=Ntt;S4.default=Itt;var T4={};Object.defineProperty(T4,"__esModule",{value:!0});T4.default=void 0;var ktt={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!1,nameFrom:["author","contents"],prohibitedProps:[],props:{"aria-sort":null},relatedConcepts:[{concept:{attributes:[{name:"scope",value:"row"}],name:"th"},module:"HTML"},{concept:{attributes:[{name:"scope",value:"rowgroup"}],name:"th"},module:"HTML"}],requireContextRole:["row","rowgroup"],requiredContextRole:["row","rowgroup"],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section","cell"],["roletype","structure","section","cell","gridcell"],["roletype","widget","gridcell"],["roletype","structure","sectionhead"]]},Dtt=ktt;T4.default=Dtt;var x4={};Object.defineProperty(x4,"__esModule",{value:!0});x4.default=void 0;var Ptt={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!0,nameFrom:["author"],prohibitedProps:[],props:{"aria-disabled":null,"aria-valuetext":null,"aria-orientation":"vertical","aria-valuemax":"100","aria-valuemin":"0"},relatedConcepts:[],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{"aria-controls":null,"aria-valuenow":null},superClass:[["roletype","structure","range"],["roletype","widget"]]},Ltt=Ptt;x4.default=Ltt;var w4={};Object.defineProperty(w4,"__esModule",{value:!0});w4.default=void 0;var Utt={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{},relatedConcepts:[],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section","landmark"]]},Btt=Utt;w4.default=Btt;var C4={};Object.defineProperty(C4,"__esModule",{value:!0});C4.default=void 0;var Ftt={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{},relatedConcepts:[{concept:{attributes:[{constraints:["undefined"],name:"list"},{name:"type",value:"search"}],constraints:["the list attribute is not set"],name:"input"},module:"HTML"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","widget","input","textbox"]]},ztt=Ftt;C4.default=ztt;var A4={};Object.defineProperty(A4,"__esModule",{value:!0});A4.default=void 0;var Htt={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!0,nameFrom:["author"],prohibitedProps:[],props:{"aria-disabled":null,"aria-orientation":"horizontal","aria-valuemax":"100","aria-valuemin":"0","aria-valuenow":null,"aria-valuetext":null},relatedConcepts:[{concept:{name:"hr"},module:"HTML"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure"]]},jtt=Htt;A4.default=jtt;var R4={};Object.defineProperty(R4,"__esModule",{value:!0});R4.default=void 0;var Vtt={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!0,nameFrom:["author"],prohibitedProps:[],props:{"aria-errormessage":null,"aria-haspopup":null,"aria-invalid":null,"aria-readonly":null,"aria-valuetext":null,"aria-orientation":"horizontal","aria-valuemax":"100","aria-valuemin":"0"},relatedConcepts:[{concept:{attributes:[{name:"type",value:"range"}],name:"input"},module:"HTML"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{"aria-valuenow":null},superClass:[["roletype","widget","input"],["roletype","structure","range"]]},Gtt=Vtt;R4.default=Gtt;var M4={};Object.defineProperty(M4,"__esModule",{value:!0});M4.default=void 0;var qtt={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-errormessage":null,"aria-invalid":null,"aria-readonly":null,"aria-required":null,"aria-valuetext":null,"aria-valuenow":"0"},relatedConcepts:[{concept:{attributes:[{name:"type",value:"number"}],name:"input"},module:"HTML"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","widget","composite"],["roletype","widget","input"],["roletype","structure","range"]]},$tt=qtt;M4.default=$tt;var O4={};Object.defineProperty(O4,"__esModule",{value:!0});O4.default=void 0;var Wtt={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-atomic":"true","aria-live":"polite"},relatedConcepts:[{concept:{name:"output"},module:"HTML"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section"]]},Ytt=Wtt;O4.default=Ytt;var N4={};Object.defineProperty(N4,"__esModule",{value:!0});N4.default=void 0;var Xtt={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["prohibited"],prohibitedProps:["aria-label","aria-labelledby"],props:{},relatedConcepts:[{concept:{name:"strong"},module:"HTML"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section"]]},Ktt=Xtt;N4.default=Ktt;var I4={};Object.defineProperty(I4,"__esModule",{value:!0});I4.default=void 0;var Ztt={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["prohibited"],prohibitedProps:["aria-label","aria-labelledby"],props:{},relatedConcepts:[{concept:{name:"sub"},module:"HTML"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section"]]},Jtt=Ztt;I4.default=Jtt;var k4={};Object.defineProperty(k4,"__esModule",{value:!0});k4.default=void 0;var Qtt={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["prohibited"],prohibitedProps:["aria-label","aria-labelledby"],props:{},relatedConcepts:[{concept:{name:"sup"},module:"HTML"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section"]]},ent=Qtt;k4.default=ent;var D4={};Object.defineProperty(D4,"__esModule",{value:!0});D4.default=void 0;var tnt={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!0,nameFrom:["author","contents"],prohibitedProps:[],props:{},relatedConcepts:[{concept:{name:"button"},module:"ARIA"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{"aria-checked":null},superClass:[["roletype","widget","input","checkbox"]]},nnt=tnt;D4.default=nnt;var P4={};Object.defineProperty(P4,"__esModule",{value:!0});P4.default=void 0;var int={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!0,nameFrom:["author","contents"],prohibitedProps:[],props:{"aria-disabled":null,"aria-expanded":null,"aria-haspopup":null,"aria-posinset":null,"aria-setsize":null,"aria-selected":"false"},relatedConcepts:[],requireContextRole:["tablist"],requiredContextRole:["tablist"],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","sectionhead"],["roletype","widget"]]},rnt=int;P4.default=rnt;var L4={};Object.defineProperty(L4,"__esModule",{value:!0});L4.default=void 0;var snt={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-colcount":null,"aria-rowcount":null},relatedConcepts:[{concept:{name:"table"},module:"HTML"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[["row"],["row","rowgroup"]],requiredProps:{},superClass:[["roletype","structure","section"]]},ant=snt;L4.default=ant;var U4={};Object.defineProperty(U4,"__esModule",{value:!0});U4.default=void 0;var ont={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-level":null,"aria-multiselectable":null,"aria-orientation":"horizontal"},relatedConcepts:[{module:"DAISY",concept:{name:"guide"}}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[["tab"]],requiredProps:{},superClass:[["roletype","widget","composite"]]},cnt=ont;U4.default=cnt;var B4={};Object.defineProperty(B4,"__esModule",{value:!0});B4.default=void 0;var lnt={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{},relatedConcepts:[],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section"]]},unt=lnt;B4.default=unt;var F4={};Object.defineProperty(F4,"__esModule",{value:!0});F4.default=void 0;var hnt={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{},relatedConcepts:[{concept:{name:"dfn"},module:"HTML"},{concept:{name:"dt"},module:"HTML"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section"]]},fnt=hnt;F4.default=fnt;var z4={};Object.defineProperty(z4,"__esModule",{value:!0});z4.default=void 0;var dnt={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-activedescendant":null,"aria-autocomplete":null,"aria-errormessage":null,"aria-haspopup":null,"aria-invalid":null,"aria-multiline":null,"aria-placeholder":null,"aria-readonly":null,"aria-required":null},relatedConcepts:[{concept:{attributes:[{constraints:["undefined"],name:"type"},{constraints:["undefined"],name:"list"}],constraints:["the list attribute is not set"],name:"input"},module:"HTML"},{concept:{attributes:[{constraints:["undefined"],name:"list"},{name:"type",value:"email"}],constraints:["the list attribute is not set"],name:"input"},module:"HTML"},{concept:{attributes:[{constraints:["undefined"],name:"list"},{name:"type",value:"tel"}],constraints:["the list attribute is not set"],name:"input"},module:"HTML"},{concept:{attributes:[{constraints:["undefined"],name:"list"},{name:"type",value:"text"}],constraints:["the list attribute is not set"],name:"input"},module:"HTML"},{concept:{attributes:[{constraints:["undefined"],name:"list"},{name:"type",value:"url"}],constraints:["the list attribute is not set"],name:"input"},module:"HTML"},{concept:{name:"input"},module:"XForms"},{concept:{name:"textarea"},module:"HTML"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","widget","input"]]},pnt=dnt;z4.default=pnt;var H4={};Object.defineProperty(H4,"__esModule",{value:!0});H4.default=void 0;var mnt={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{},relatedConcepts:[{concept:{name:"time"},module:"HTML"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section"]]},gnt=mnt;H4.default=gnt;var j4={};Object.defineProperty(j4,"__esModule",{value:!0});j4.default=void 0;var vnt={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{},relatedConcepts:[],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section","status"]]},_nt=vnt;j4.default=_nt;var V4={};Object.defineProperty(V4,"__esModule",{value:!0});V4.default=void 0;var ynt={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-orientation":"horizontal"},relatedConcepts:[{concept:{name:"menubar"},module:"ARIA"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section","group"]]},bnt=ynt;V4.default=bnt;var G4={};Object.defineProperty(G4,"__esModule",{value:!0});G4.default=void 0;var Ent={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!1,nameFrom:["author","contents"],prohibitedProps:[],props:{},relatedConcepts:[],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section"]]},Snt=Ent;G4.default=Snt;var q4={};Object.defineProperty(q4,"__esModule",{value:!0});q4.default=void 0;var Tnt={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-errormessage":null,"aria-invalid":null,"aria-multiselectable":null,"aria-required":null,"aria-orientation":"vertical"},relatedConcepts:[],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[["treeitem","group"],["treeitem"]],requiredProps:{},superClass:[["roletype","widget","composite","select"],["roletype","structure","section","group","select"]]},xnt=Tnt;q4.default=xnt;var $4={};Object.defineProperty($4,"__esModule",{value:!0});$4.default=void 0;var wnt={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{},relatedConcepts:[],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[["row"],["row","rowgroup"]],requiredProps:{},superClass:[["roletype","widget","composite","grid"],["roletype","structure","section","table","grid"],["roletype","widget","composite","select","tree"],["roletype","structure","section","group","select","tree"]]},Cnt=wnt;$4.default=Cnt;var W4={};Object.defineProperty(W4,"__esModule",{value:!0});W4.default=void 0;var Ant={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!1,nameFrom:["author","contents"],prohibitedProps:[],props:{"aria-expanded":null,"aria-haspopup":null},relatedConcepts:[],requireContextRole:["group","tree"],requiredContextRole:["group","tree"],requiredOwnedElements:[],requiredProps:{"aria-selected":null},superClass:[["roletype","structure","section","listitem"],["roletype","widget","input","option"]]},Rnt=Ant;W4.default=Rnt;Object.defineProperty(_6,"__esModule",{value:!0});_6.default=void 0;var Mnt=un(y6),Ont=un(b6),Nnt=un(E6),Int=un(S6),knt=un(T6),Dnt=un(x6),Pnt=un(w6),Lnt=un(C6),Unt=un(A6),Bnt=un(R6),Fnt=un(M6),znt=un(O6),Hnt=un(N6),jnt=un(I6),Vnt=un(k6),Gnt=un(D6),qnt=un(P6),$nt=un(L6),Wnt=un(U6),Ynt=un(B6),Xnt=un(F6),Knt=un(z6),Znt=un(H6),Jnt=un(j6),Qnt=un(V6),eit=un(G6),tit=un(q6),nit=un($6),iit=un(W6),rit=un(Y6),sit=un(X6),ait=un(K6),oit=un(Z6),cit=un(J6),lit=un(Q6),uit=un(e4),hit=un(t4),fit=un(n4),dit=un(i4),pit=un(r4),mit=un(s4),git=un(a4),vit=un(o4),_it=un(c4),yit=un(l4),bit=un(u4),Eit=un(h4),Sit=un(f4),Tit=un(d4),xit=un(p4),wit=un(m4),Cit=un(g4),Ait=un(v4),Rit=un(_4),Mit=un(y4),Oit=un(b4),Nit=un(E4),Iit=un(S4),kit=un(T4),Dit=un(x4),Pit=un(w4),Lit=un(C4),Uit=un(A4),Bit=un(R4),Fit=un(M4),zit=un(O4),Hit=un(N4),jit=un(I4),Vit=un(k4),Git=un(D4),qit=un(P4),$it=un(L4),Wit=un(U4),Yit=un(B4),Xit=un(F4),Kit=un(z4),Zit=un(H4),Jit=un(j4),Qit=un(V4),ert=un(G4),trt=un(q4),nrt=un($4),irt=un(W4);function un(t){return t&&t.__esModule?t:{default:t}}var rrt=[["alert",Mnt.default],["alertdialog",Ont.default],["application",Nnt.default],["article",Int.default],["banner",knt.default],["blockquote",Dnt.default],["button",Pnt.default],["caption",Lnt.default],["cell",Unt.default],["checkbox",Bnt.default],["code",Fnt.default],["columnheader",znt.default],["combobox",Hnt.default],["complementary",jnt.default],["contentinfo",Vnt.default],["definition",Gnt.default],["deletion",qnt.default],["dialog",$nt.default],["directory",Wnt.default],["document",Ynt.default],["emphasis",Xnt.default],["feed",Knt.default],["figure",Znt.default],["form",Jnt.default],["generic",Qnt.default],["grid",eit.default],["gridcell",tit.default],["group",nit.default],["heading",iit.default],["img",rit.default],["insertion",sit.default],["link",ait.default],["list",oit.default],["listbox",cit.default],["listitem",lit.default],["log",uit.default],["main",hit.default],["mark",fit.default],["marquee",dit.default],["math",pit.default],["menu",mit.default],["menubar",git.default],["menuitem",vit.default],["menuitemcheckbox",_it.default],["menuitemradio",yit.default],["meter",bit.default],["navigation",Eit.default],["none",Sit.default],["note",Tit.default],["option",xit.default],["paragraph",wit.default],["presentation",Cit.default],["progressbar",Ait.default],["radio",Rit.default],["radiogroup",Mit.default],["region",Oit.default],["row",Nit.default],["rowgroup",Iit.default],["rowheader",kit.default],["scrollbar",Dit.default],["search",Pit.default],["searchbox",Lit.default],["separator",Uit.default],["slider",Bit.default],["spinbutton",Fit.default],["status",zit.default],["strong",Hit.default],["subscript",jit.default],["superscript",Vit.default],["switch",Git.default],["tab",qit.default],["table",$it.default],["tablist",Wit.default],["tabpanel",Yit.default],["term",Xit.default],["textbox",Kit.default],["time",Zit.default],["timer",Jit.default],["toolbar",Qit.default],["tooltip",ert.default],["tree",trt.default],["treegrid",nrt.default],["treeitem",irt.default]],srt=rrt;_6.default=srt;var Y4={},X4={};Object.defineProperty(X4,"__esModule",{value:!0});X4.default=void 0;var art={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-disabled":null,"aria-errormessage":null,"aria-expanded":null,"aria-haspopup":null,"aria-invalid":null},relatedConcepts:[{concept:{name:"abstract [EPUB-SSV]"},module:"EPUB"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section"]]},ort=art;X4.default=ort;var K4={};Object.defineProperty(K4,"__esModule",{value:!0});K4.default=void 0;var crt={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-disabled":null,"aria-errormessage":null,"aria-expanded":null,"aria-haspopup":null,"aria-invalid":null},relatedConcepts:[{concept:{name:"acknowledgments [EPUB-SSV]"},module:"EPUB"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section","landmark"]]},lrt=crt;K4.default=lrt;var Z4={};Object.defineProperty(Z4,"__esModule",{value:!0});Z4.default=void 0;var urt={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-disabled":null,"aria-errormessage":null,"aria-expanded":null,"aria-haspopup":null,"aria-invalid":null},relatedConcepts:[{concept:{name:"afterword [EPUB-SSV]"},module:"EPUB"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section","landmark"]]},hrt=urt;Z4.default=hrt;var J4={};Object.defineProperty(J4,"__esModule",{value:!0});J4.default=void 0;var frt={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-disabled":null,"aria-errormessage":null,"aria-expanded":null,"aria-haspopup":null,"aria-invalid":null},relatedConcepts:[{concept:{name:"appendix [EPUB-SSV]"},module:"EPUB"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section","landmark"]]},drt=frt;J4.default=drt;var Q4={};Object.defineProperty(Q4,"__esModule",{value:!0});Q4.default=void 0;var prt={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!1,nameFrom:["author","contents"],prohibitedProps:[],props:{"aria-errormessage":null,"aria-invalid":null},relatedConcepts:[{concept:{name:"referrer [EPUB-SSV]"},module:"EPUB"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","widget","command","link"]]},mrt=prt;Q4.default=mrt;var ez={};Object.defineProperty(ez,"__esModule",{value:!0});ez.default=void 0;var grt={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-disabled":null,"aria-errormessage":null,"aria-expanded":null,"aria-haspopup":null,"aria-invalid":null},relatedConcepts:[{concept:{name:"EPUB biblioentry [EPUB-SSV]"},module:"EPUB"}],requireContextRole:["doc-bibliography"],requiredContextRole:["doc-bibliography"],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section","listitem"]]},vrt=grt;ez.default=vrt;var tz={};Object.defineProperty(tz,"__esModule",{value:!0});tz.default=void 0;var _rt={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-disabled":null,"aria-errormessage":null,"aria-expanded":null,"aria-haspopup":null,"aria-invalid":null},relatedConcepts:[{concept:{name:"bibliography [EPUB-SSV]"},module:"EPUB"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[["doc-biblioentry"]],requiredProps:{},superClass:[["roletype","structure","section","landmark"]]},yrt=_rt;tz.default=yrt;var nz={};Object.defineProperty(nz,"__esModule",{value:!0});nz.default=void 0;var brt={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!1,nameFrom:["author","contents"],prohibitedProps:[],props:{"aria-errormessage":null,"aria-invalid":null},relatedConcepts:[{concept:{name:"biblioref [EPUB-SSV]"},module:"EPUB"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","widget","command","link"]]},Ert=brt;nz.default=Ert;var iz={};Object.defineProperty(iz,"__esModule",{value:!0});iz.default=void 0;var Srt={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-disabled":null,"aria-errormessage":null,"aria-expanded":null,"aria-haspopup":null,"aria-invalid":null},relatedConcepts:[{concept:{name:"chapter [EPUB-SSV]"},module:"EPUB"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section","landmark"]]},Trt=Srt;iz.default=Trt;var rz={};Object.defineProperty(rz,"__esModule",{value:!0});rz.default=void 0;var xrt={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-disabled":null,"aria-errormessage":null,"aria-expanded":null,"aria-haspopup":null,"aria-invalid":null},relatedConcepts:[{concept:{name:"colophon [EPUB-SSV]"},module:"EPUB"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section"]]},wrt=xrt;rz.default=wrt;var sz={};Object.defineProperty(sz,"__esModule",{value:!0});sz.default=void 0;var Crt={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-disabled":null,"aria-errormessage":null,"aria-expanded":null,"aria-haspopup":null,"aria-invalid":null},relatedConcepts:[{concept:{name:"conclusion [EPUB-SSV]"},module:"EPUB"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section","landmark"]]},Art=Crt;sz.default=Art;var az={};Object.defineProperty(az,"__esModule",{value:!0});az.default=void 0;var Rrt={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-disabled":null,"aria-errormessage":null,"aria-expanded":null,"aria-haspopup":null,"aria-invalid":null},relatedConcepts:[{concept:{name:"cover [EPUB-SSV]"},module:"EPUB"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section","img"]]},Mrt=Rrt;az.default=Mrt;var oz={};Object.defineProperty(oz,"__esModule",{value:!0});oz.default=void 0;var Ort={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-disabled":null,"aria-errormessage":null,"aria-expanded":null,"aria-haspopup":null,"aria-invalid":null},relatedConcepts:[{concept:{name:"credit [EPUB-SSV]"},module:"EPUB"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section"]]},Nrt=Ort;oz.default=Nrt;var cz={};Object.defineProperty(cz,"__esModule",{value:!0});cz.default=void 0;var Irt={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-disabled":null,"aria-errormessage":null,"aria-expanded":null,"aria-haspopup":null,"aria-invalid":null},relatedConcepts:[{concept:{name:"credits [EPUB-SSV]"},module:"EPUB"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section","landmark"]]},krt=Irt;cz.default=krt;var lz={};Object.defineProperty(lz,"__esModule",{value:!0});lz.default=void 0;var Drt={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-disabled":null,"aria-errormessage":null,"aria-expanded":null,"aria-haspopup":null,"aria-invalid":null},relatedConcepts:[{concept:{name:"dedication [EPUB-SSV]"},module:"EPUB"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section"]]},Prt=Drt;lz.default=Prt;var uz={};Object.defineProperty(uz,"__esModule",{value:!0});uz.default=void 0;var Lrt={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-disabled":null,"aria-errormessage":null,"aria-expanded":null,"aria-haspopup":null,"aria-invalid":null},relatedConcepts:[{concept:{name:"rearnote [EPUB-SSV]"},module:"EPUB"}],requireContextRole:["doc-endnotes"],requiredContextRole:["doc-endnotes"],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section","listitem"]]},Urt=Lrt;uz.default=Urt;var hz={};Object.defineProperty(hz,"__esModule",{value:!0});hz.default=void 0;var Brt={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-disabled":null,"aria-errormessage":null,"aria-expanded":null,"aria-haspopup":null,"aria-invalid":null},relatedConcepts:[{concept:{name:"rearnotes [EPUB-SSV]"},module:"EPUB"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[["doc-endnote"]],requiredProps:{},superClass:[["roletype","structure","section","landmark"]]},Frt=Brt;hz.default=Frt;var fz={};Object.defineProperty(fz,"__esModule",{value:!0});fz.default=void 0;var zrt={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-disabled":null,"aria-errormessage":null,"aria-expanded":null,"aria-haspopup":null,"aria-invalid":null},relatedConcepts:[{concept:{name:"epigraph [EPUB-SSV]"},module:"EPUB"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section"]]},Hrt=zrt;fz.default=Hrt;var dz={};Object.defineProperty(dz,"__esModule",{value:!0});dz.default=void 0;var jrt={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-disabled":null,"aria-errormessage":null,"aria-expanded":null,"aria-haspopup":null,"aria-invalid":null},relatedConcepts:[{concept:{name:"epilogue [EPUB-SSV]"},module:"EPUB"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section","landmark"]]},Vrt=jrt;dz.default=Vrt;var pz={};Object.defineProperty(pz,"__esModule",{value:!0});pz.default=void 0;var Grt={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-disabled":null,"aria-errormessage":null,"aria-expanded":null,"aria-haspopup":null,"aria-invalid":null},relatedConcepts:[{concept:{name:"errata [EPUB-SSV]"},module:"EPUB"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section","landmark"]]},qrt=Grt;pz.default=qrt;var mz={};Object.defineProperty(mz,"__esModule",{value:!0});mz.default=void 0;var $rt={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-disabled":null,"aria-errormessage":null,"aria-expanded":null,"aria-haspopup":null,"aria-invalid":null},relatedConcepts:[],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section"]]},Wrt=$rt;mz.default=Wrt;var gz={};Object.defineProperty(gz,"__esModule",{value:!0});gz.default=void 0;var Yrt={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-disabled":null,"aria-errormessage":null,"aria-expanded":null,"aria-haspopup":null,"aria-invalid":null},relatedConcepts:[{concept:{name:"footnote [EPUB-SSV]"},module:"EPUB"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section"]]},Xrt=Yrt;gz.default=Xrt;var vz={};Object.defineProperty(vz,"__esModule",{value:!0});vz.default=void 0;var Krt={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-disabled":null,"aria-errormessage":null,"aria-expanded":null,"aria-haspopup":null,"aria-invalid":null},relatedConcepts:[{concept:{name:"foreword [EPUB-SSV]"},module:"EPUB"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section","landmark"]]},Zrt=Krt;vz.default=Zrt;var _z={};Object.defineProperty(_z,"__esModule",{value:!0});_z.default=void 0;var Jrt={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-disabled":null,"aria-errormessage":null,"aria-expanded":null,"aria-haspopup":null,"aria-invalid":null},relatedConcepts:[{concept:{name:"glossary [EPUB-SSV]"},module:"EPUB"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[["definition"],["term"]],requiredProps:{},superClass:[["roletype","structure","section","landmark"]]},Qrt=Jrt;_z.default=Qrt;var yz={};Object.defineProperty(yz,"__esModule",{value:!0});yz.default=void 0;var est={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!1,nameFrom:["author","contents"],prohibitedProps:[],props:{"aria-errormessage":null,"aria-invalid":null},relatedConcepts:[{concept:{name:"glossref [EPUB-SSV]"},module:"EPUB"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","widget","command","link"]]},tst=est;yz.default=tst;var bz={};Object.defineProperty(bz,"__esModule",{value:!0});bz.default=void 0;var nst={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-disabled":null,"aria-errormessage":null,"aria-expanded":null,"aria-haspopup":null,"aria-invalid":null},relatedConcepts:[{concept:{name:"index [EPUB-SSV]"},module:"EPUB"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section","landmark","navigation"]]},ist=nst;bz.default=ist;var Ez={};Object.defineProperty(Ez,"__esModule",{value:!0});Ez.default=void 0;var rst={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-disabled":null,"aria-errormessage":null,"aria-expanded":null,"aria-haspopup":null,"aria-invalid":null},relatedConcepts:[{concept:{name:"introduction [EPUB-SSV]"},module:"EPUB"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section","landmark"]]},sst=rst;Ez.default=sst;var Sz={};Object.defineProperty(Sz,"__esModule",{value:!0});Sz.default=void 0;var ast={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!1,nameFrom:["author","contents"],prohibitedProps:[],props:{"aria-errormessage":null,"aria-invalid":null},relatedConcepts:[{concept:{name:"noteref [EPUB-SSV]"},module:"EPUB"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","widget","command","link"]]},ost=ast;Sz.default=ost;var Tz={};Object.defineProperty(Tz,"__esModule",{value:!0});Tz.default=void 0;var cst={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-disabled":null,"aria-errormessage":null,"aria-expanded":null,"aria-haspopup":null,"aria-invalid":null},relatedConcepts:[{concept:{name:"notice [EPUB-SSV]"},module:"EPUB"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section","note"]]},lst=cst;Tz.default=lst;var xz={};Object.defineProperty(xz,"__esModule",{value:!0});xz.default=void 0;var ust={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!0,nameFrom:["author"],prohibitedProps:[],props:{"aria-errormessage":null,"aria-expanded":null,"aria-haspopup":null,"aria-invalid":null},relatedConcepts:[{concept:{name:"pagebreak [EPUB-SSV]"},module:"EPUB"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","separator"]]},hst=ust;xz.default=hst;var wz={};Object.defineProperty(wz,"__esModule",{value:!0});wz.default=void 0;var fst={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-disabled":null,"aria-errormessage":null,"aria-expanded":null,"aria-haspopup":null,"aria-invalid":null},relatedConcepts:[{concept:{name:"page-list [EPUB-SSV]"},module:"EPUB"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section","landmark","navigation"]]},dst=fst;wz.default=dst;var Cz={};Object.defineProperty(Cz,"__esModule",{value:!0});Cz.default=void 0;var pst={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-disabled":null,"aria-errormessage":null,"aria-expanded":null,"aria-haspopup":null,"aria-invalid":null},relatedConcepts:[{concept:{name:"part [EPUB-SSV]"},module:"EPUB"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section","landmark"]]},mst=pst;Cz.default=mst;var Az={};Object.defineProperty(Az,"__esModule",{value:!0});Az.default=void 0;var gst={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-disabled":null,"aria-errormessage":null,"aria-expanded":null,"aria-haspopup":null,"aria-invalid":null},relatedConcepts:[{concept:{name:"preface [EPUB-SSV]"},module:"EPUB"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section","landmark"]]},vst=gst;Az.default=vst;var Rz={};Object.defineProperty(Rz,"__esModule",{value:!0});Rz.default=void 0;var _st={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-disabled":null,"aria-errormessage":null,"aria-expanded":null,"aria-haspopup":null,"aria-invalid":null},relatedConcepts:[{concept:{name:"prologue [EPUB-SSV]"},module:"EPUB"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section","landmark"]]},yst=_st;Rz.default=yst;var Mz={};Object.defineProperty(Mz,"__esModule",{value:!0});Mz.default=void 0;var bst={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{},relatedConcepts:[{concept:{name:"pullquote [EPUB-SSV]"},module:"EPUB"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["none"]]},Est=bst;Mz.default=Est;var Oz={};Object.defineProperty(Oz,"__esModule",{value:!0});Oz.default=void 0;var Sst={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-disabled":null,"aria-errormessage":null,"aria-expanded":null,"aria-haspopup":null,"aria-invalid":null},relatedConcepts:[{concept:{name:"qna [EPUB-SSV]"},module:"EPUB"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section"]]},Tst=Sst;Oz.default=Tst;var Nz={};Object.defineProperty(Nz,"__esModule",{value:!0});Nz.default=void 0;var xst={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-disabled":null,"aria-errormessage":null,"aria-expanded":null,"aria-haspopup":null,"aria-invalid":null},relatedConcepts:[{concept:{name:"subtitle [EPUB-SSV]"},module:"EPUB"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","sectionhead"]]},wst=xst;Nz.default=wst;var Iz={};Object.defineProperty(Iz,"__esModule",{value:!0});Iz.default=void 0;var Cst={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-disabled":null,"aria-errormessage":null,"aria-expanded":null,"aria-haspopup":null,"aria-invalid":null},relatedConcepts:[{concept:{name:"help [EPUB-SSV]"},module:"EPUB"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section","note"]]},Ast=Cst;Iz.default=Ast;var kz={};Object.defineProperty(kz,"__esModule",{value:!0});kz.default=void 0;var Rst={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-disabled":null,"aria-errormessage":null,"aria-expanded":null,"aria-haspopup":null,"aria-invalid":null},relatedConcepts:[{concept:{name:"toc [EPUB-SSV]"},module:"EPUB"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section","landmark","navigation"]]},Mst=Rst;kz.default=Mst;Object.defineProperty(Y4,"__esModule",{value:!0});Y4.default=void 0;var Ost=br(X4),Nst=br(K4),Ist=br(Z4),kst=br(J4),Dst=br(Q4),Pst=br(ez),Lst=br(tz),Ust=br(nz),Bst=br(iz),Fst=br(rz),zst=br(sz),Hst=br(az),jst=br(oz),Vst=br(cz),Gst=br(lz),qst=br(uz),$st=br(hz),Wst=br(fz),Yst=br(dz),Xst=br(pz),Kst=br(mz),Zst=br(gz),Jst=br(vz),Qst=br(_z),eat=br(yz),tat=br(bz),nat=br(Ez),iat=br(Sz),rat=br(Tz),sat=br(xz),aat=br(wz),oat=br(Cz),cat=br(Az),lat=br(Rz),uat=br(Mz),hat=br(Oz),fat=br(Nz),dat=br(Iz),pat=br(kz);function br(t){return t&&t.__esModule?t:{default:t}}var mat=[["doc-abstract",Ost.default],["doc-acknowledgments",Nst.default],["doc-afterword",Ist.default],["doc-appendix",kst.default],["doc-backlink",Dst.default],["doc-biblioentry",Pst.default],["doc-bibliography",Lst.default],["doc-biblioref",Ust.default],["doc-chapter",Bst.default],["doc-colophon",Fst.default],["doc-conclusion",zst.default],["doc-cover",Hst.default],["doc-credit",jst.default],["doc-credits",Vst.default],["doc-dedication",Gst.default],["doc-endnote",qst.default],["doc-endnotes",$st.default],["doc-epigraph",Wst.default],["doc-epilogue",Yst.default],["doc-errata",Xst.default],["doc-example",Kst.default],["doc-footnote",Zst.default],["doc-foreword",Jst.default],["doc-glossary",Qst.default],["doc-glossref",eat.default],["doc-index",tat.default],["doc-introduction",nat.default],["doc-noteref",iat.default],["doc-notice",rat.default],["doc-pagebreak",sat.default],["doc-pagelist",aat.default],["doc-part",oat.default],["doc-preface",cat.default],["doc-prologue",lat.default],["doc-pullquote",uat.default],["doc-qna",hat.default],["doc-subtitle",fat.default],["doc-tip",dat.default],["doc-toc",pat.default]],gat=mat;Y4.default=gat;var Dz={},Pz={};Object.defineProperty(Pz,"__esModule",{value:!0});Pz.default=void 0;var vat={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-disabled":null,"aria-errormessage":null,"aria-expanded":null,"aria-haspopup":null,"aria-invalid":null},relatedConcepts:[{module:"GRAPHICS",concept:{name:"graphics-object"}},{module:"ARIA",concept:{name:"img"}},{module:"ARIA",concept:{name:"article"}}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","document"]]},_at=vat;Pz.default=_at;var Lz={};Object.defineProperty(Lz,"__esModule",{value:!0});Lz.default=void 0;var yat={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author","contents"],prohibitedProps:[],props:{"aria-errormessage":null,"aria-expanded":null,"aria-haspopup":null,"aria-invalid":null},relatedConcepts:[{module:"GRAPHICS",concept:{name:"graphics-document"}},{module:"ARIA",concept:{name:"group"}},{module:"ARIA",concept:{name:"img"}},{module:"GRAPHICS",concept:{name:"graphics-symbol"}}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section","group"]]},bat=yat;Lz.default=bat;var Uz={};Object.defineProperty(Uz,"__esModule",{value:!0});Uz.default=void 0;var Eat={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!0,nameFrom:["author"],prohibitedProps:[],props:{"aria-disabled":null,"aria-errormessage":null,"aria-expanded":null,"aria-haspopup":null,"aria-invalid":null},relatedConcepts:[],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section","img"]]},Sat=Eat;Uz.default=Sat;Object.defineProperty(Dz,"__esModule",{value:!0});Dz.default=void 0;var Tat=dX(Pz),xat=dX(Lz),wat=dX(Uz);function dX(t){return t&&t.__esModule?t:{default:t}}var Cat=[["graphics-document",Tat.default],["graphics-object",xat.default],["graphics-symbol",wat.default]],Aat=Cat;Dz.default=Aat;Object.defineProperty(jA,"__esModule",{value:!0});jA.default=void 0;var Rat=dk(s6),Mat=dk(_6),Oat=dk(Y4),Nat=dk(Dz),Iat=dk(N1);function dk(t){return t&&t.__esModule?t:{default:t}}function kat(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Dq(t,e){var n=typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=w_e(t))||e){n&&(t=n);var i=0,r=function(){};return{s:r,n:function(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}},e:function(l){throw l},f:r}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var s=!0,a=!1,o;return{s:function(){n=n.call(t)},n:function(){var l=n.next();return s=l.done,l},e:function(l){a=!0,o=l},f:function(){try{!s&&n.return!=null&&n.return()}finally{if(a)throw o}}}}function ZM(t,e){return Lat(t)||Pat(t,e)||w_e(t,e)||Dat()}function Dat(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function w_e(t,e){if(t){if(typeof t=="string")return fre(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);if(n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set")return Array.from(t);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return fre(t,e)}}function fre(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}function Pat(t,e){var n=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(n!=null){var i=[],r=!0,s=!1,a,o;try{for(n=n.call(t);!(r=(a=n.next()).done)&&(i.push(a.value),!(e&&i.length===e));r=!0);}catch(c){s=!0,o=c}finally{try{!r&&n.return!=null&&n.return()}finally{if(s)throw o}}return i}}function Lat(t){if(Array.isArray(t))return t}var Ky=[].concat(Rat.default,Mat.default,Oat.default,Nat.default);Ky.forEach(function(t){var e=ZM(t,2),n=e[1],i=Dq(n.superClass),r;try{for(i.s();!(r=i.n()).done;){var s=r.value,a=Dq(s),o;try{var c=function(){var u=o.value,h=Ky.find(function(y){var v=ZM(y,1),b=v[0];return b===u});if(h)for(var f=h[1],d=0,p=Object.keys(f.props);d<p.length;d++){var g=p[d];Object.prototype.hasOwnProperty.call(n.props,g)||Object.assign(n.props,kat({},g,f.props[g]))}};for(a.s();!(o=a.n()).done;)c()}catch(l){a.e(l)}finally{a.f()}}}catch(l){i.e(l)}finally{i.f()}});var Pq={entries:function(){return Ky},forEach:function(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,i=Dq(Ky),r;try{for(i.s();!(r=i.n()).done;){var s=ZM(r.value,2),a=s[0],o=s[1];e.call(n,o,a,Ky)}}catch(c){i.e(c)}finally{i.f()}},get:function(e){var n=Ky.find(function(i){return i[0]===e});return n&&n[1]},has:function(e){return!!Pq.get(e)},keys:function(){return Ky.map(function(e){var n=ZM(e,1),i=n[0];return i})},values:function(){return Ky.map(function(e){var n=ZM(e,2),i=n[1];return i})}},Uat=(0,Iat.default)(Pq,Pq.entries());jA.default=Uat;var Bz={},C_e={},dre=Object.prototype.hasOwnProperty;function Lq(t,e){var n,i;if(t===e)return!0;if(t&&e&&(n=t.constructor)===e.constructor){if(n===Date)return t.getTime()===e.getTime();if(n===RegExp)return t.toString()===e.toString();if(n===Array){if((i=t.length)===e.length)for(;i--&&Lq(t[i],e[i]););return i===-1}if(!n||typeof t=="object"){i=0;for(n in t)if(dre.call(t,n)&&++i&&!dre.call(e,n)||!(n in e)||!Lq(t[n],e[n]))return!1;return Object.keys(e).length===i}}return t!==t&&e!==e}C_e.dequal=Lq;Object.defineProperty(Bz,"__esModule",{value:!0});Bz.default=void 0;var A_e=C_e,Bat=M_e(N1),R_e=M_e(jA);function M_e(t){return t&&t.__esModule?t:{default:t}}function aj(t,e){return Hat(t)||zat(t,e)||O_e(t,e)||Fat()}function Fat(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function zat(t,e){var n=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(n!=null){var i=[],r=!0,s=!1,a,o;try{for(n=n.call(t);!(r=(a=n.next()).done)&&(i.push(a.value),!(e&&i.length===e));r=!0);}catch(c){s=!0,o=c}finally{try{!r&&n.return!=null&&n.return()}finally{if(s)throw o}}return i}}function Hat(t){if(Array.isArray(t))return t}function jat(t,e){var n=typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=O_e(t))||e){n&&(t=n);var i=0,r=function(){};return{s:r,n:function(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}},e:function(l){throw l},f:r}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var s=!0,a=!1,o;return{s:function(){n=n.call(t)},n:function(){var l=n.next();return s=l.done,l},e:function(l){a=!0,o=l},f:function(){try{!s&&n.return!=null&&n.return()}finally{if(a)throw o}}}}function O_e(t,e){if(t){if(typeof t=="string")return pre(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);if(n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set")return Array.from(t);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return pre(t,e)}}function pre(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}var Zy=[],mre=R_e.default.keys();for(var oj=0;oj<mre.length;oj++){var cj=mre[oj],lj=R_e.default.get(cj);if(lj)for(var gre=[].concat(lj.baseConcepts,lj.relatedConcepts),uj=0;uj<gre.length;uj++){var vre=gre[uj];vre.module==="HTML"&&function(){var t=vre.concept;if(t){var e=Zy.find(function(s){return(0,A_e.dequal)(s,t)}),n;e?n=e[1]:n=[];for(var i=!0,r=0;r<n.length;r++)if(n[r]===cj){i=!1;break}i&&n.push(cj),Zy.push([t,n])}}()}}var Uq={entries:function(){return Zy},forEach:function(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,i=jat(Zy),r;try{for(i.s();!(r=i.n()).done;){var s=aj(r.value,2),a=s[0],o=s[1];e.call(n,o,a,Zy)}}catch(c){i.e(c)}finally{i.f()}},get:function(e){var n=Zy.find(function(i){return e.name===i[0].name&&(0,A_e.dequal)(e.attributes,i[0].attributes)});return n&&n[1]},has:function(e){return!!Uq.get(e)},keys:function(){return Zy.map(function(e){var n=aj(e,1),i=n[0];return i})},values:function(){return Zy.map(function(e){var n=aj(e,2),i=n[1];return i})}},Vat=(0,Bat.default)(Uq,Uq.entries());Bz.default=Vat;var Fz={};Object.defineProperty(Fz,"__esModule",{value:!0});Fz.default=void 0;var Gat=I_e(N1),N_e=I_e(jA);function I_e(t){return t&&t.__esModule?t:{default:t}}function hj(t,e){return Wat(t)||$at(t,e)||k_e(t,e)||qat()}function qat(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function $at(t,e){var n=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(n!=null){var i=[],r=!0,s=!1,a,o;try{for(n=n.call(t);!(r=(a=n.next()).done)&&(i.push(a.value),!(e&&i.length===e));r=!0);}catch(c){s=!0,o=c}finally{try{!r&&n.return!=null&&n.return()}finally{if(s)throw o}}return i}}function Wat(t){if(Array.isArray(t))return t}function Yat(t,e){var n=typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=k_e(t))||e){n&&(t=n);var i=0,r=function(){};return{s:r,n:function(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}},e:function(l){throw l},f:r}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var s=!0,a=!1,o;return{s:function(){n=n.call(t)},n:function(){var l=n.next();return s=l.done,l},e:function(l){a=!0,o=l},f:function(){try{!s&&n.return!=null&&n.return()}finally{if(a)throw o}}}}function k_e(t,e){if(t){if(typeof t=="string")return _re(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);if(n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set")return Array.from(t);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _re(t,e)}}function _re(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}var KS=[],yre=N_e.default.keys();for(var fj=0;fj<yre.length;fj++){var bre=yre[fj],dj=N_e.default.get(bre),pj=[];if(dj){for(var Ere=[].concat(dj.baseConcepts,dj.relatedConcepts),mj=0;mj<Ere.length;mj++){var Sre=Ere[mj];if(Sre.module==="HTML"){var Tre=Sre.concept;Tre!=null&&pj.push(Tre)}}pj.length>0&&KS.push([bre,pj])}}var Bq={entries:function(){return KS},forEach:function(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,i=Yat(KS),r;try{for(i.s();!(r=i.n()).done;){var s=hj(r.value,2),a=s[0],o=s[1];e.call(n,o,a,KS)}}catch(c){i.e(c)}finally{i.f()}},get:function(e){var n=KS.find(function(i){return i[0]===e});return n&&n[1]},has:function(e){return!!Bq.get(e)},keys:function(){return KS.map(function(e){var n=hj(e,1),i=n[0];return i})},values:function(){return KS.map(function(e){var n=hj(e,2),i=n[1];return i})}},Xat=(0,Gat.default)(Bq,Bq.entries());Fz.default=Xat;Object.defineProperty(cm,"__esModule",{value:!0});var Qp=cm.roles=P_e=cm.roleElements=D_e=cm.elementRoles=cm.dom=cm.aria=void 0,Kat=pk(n6),Zat=pk(r6),Jat=pk(jA),Qat=pk(Bz),eot=pk(Fz);function pk(t){return t&&t.__esModule?t:{default:t}}var tot=Kat.default;cm.aria=tot;var not=Zat.default;cm.dom=not;var iot=Jat.default;Qp=cm.roles=iot;var rot=Qat.default,D_e=cm.elementRoles=rot,sot=eot.default,P_e=cm.roleElements=sot,pX={exports:{}};pX.exports;(function(t){var e=function(){var n=String.fromCharCode,i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+-$",s={};function a(c,l){if(!s[c]){s[c]={};for(var u=0;u<c.length;u++)s[c][c.charAt(u)]=u}return s[c][l]}var o={compressToBase64:function(c){if(c==null)return"";var l=o._compress(c,6,function(u){return i.charAt(u)});switch(l.length%4){default:case 0:return l;case 1:return l+"===";case 2:return l+"==";case 3:return l+"="}},decompressFromBase64:function(c){return c==null?"":c==""?null:o._decompress(c.length,32,function(l){return a(i,c.charAt(l))})},compressToUTF16:function(c){return c==null?"":o._compress(c,15,function(l){return n(l+32)})+" "},decompressFromUTF16:function(c){return c==null?"":c==""?null:o._decompress(c.length,16384,function(l){return c.charCodeAt(l)-32})},compressToUint8Array:function(c){for(var l=o.compress(c),u=new Uint8Array(l.length*2),h=0,f=l.length;h<f;h++){var d=l.charCodeAt(h);u[h*2]=d>>>8,u[h*2+1]=d%256}return u},decompressFromUint8Array:function(c){if(c==null)return o.decompress(c);for(var l=new Array(c.length/2),u=0,h=l.length;u<h;u++)l[u]=c[u*2]*256+c[u*2+1];var f=[];return l.forEach(function(d){f.push(n(d))}),o.decompress(f.join(""))},compressToEncodedURIComponent:function(c){return c==null?"":o._compress(c,6,function(l){return r.charAt(l)})},decompressFromEncodedURIComponent:function(c){return c==null?"":c==""?null:(c=c.replace(/ /g,"+"),o._decompress(c.length,32,function(l){return a(r,c.charAt(l))}))},compress:function(c){return o._compress(c,16,function(l){return n(l)})},_compress:function(c,l,u){if(c==null)return"";var h,f,d={},p={},g="",y="",v="",b=2,T=3,x=2,M=[],R=0,I=0,k;for(k=0;k<c.length;k+=1)if(g=c.charAt(k),Object.prototype.hasOwnProperty.call(d,g)||(d[g]=T++,p[g]=!0),y=v+g,Object.prototype.hasOwnProperty.call(d,y))v=y;else{if(Object.prototype.hasOwnProperty.call(p,v)){if(v.charCodeAt(0)<256){for(h=0;h<x;h++)R=R<<1,I==l-1?(I=0,M.push(u(R)),R=0):I++;for(f=v.charCodeAt(0),h=0;h<8;h++)R=R<<1|f&1,I==l-1?(I=0,M.push(u(R)),R=0):I++,f=f>>1}else{for(f=1,h=0;h<x;h++)R=R<<1|f,I==l-1?(I=0,M.push(u(R)),R=0):I++,f=0;for(f=v.charCodeAt(0),h=0;h<16;h++)R=R<<1|f&1,I==l-1?(I=0,M.push(u(R)),R=0):I++,f=f>>1}b--,b==0&&(b=Math.pow(2,x),x++),delete p[v]}else for(f=d[v],h=0;h<x;h++)R=R<<1|f&1,I==l-1?(I=0,M.push(u(R)),R=0):I++,f=f>>1;b--,b==0&&(b=Math.pow(2,x),x++),d[y]=T++,v=String(g)}if(v!==""){if(Object.prototype.hasOwnProperty.call(p,v)){if(v.charCodeAt(0)<256){for(h=0;h<x;h++)R=R<<1,I==l-1?(I=0,M.push(u(R)),R=0):I++;for(f=v.charCodeAt(0),h=0;h<8;h++)R=R<<1|f&1,I==l-1?(I=0,M.push(u(R)),R=0):I++,f=f>>1}else{for(f=1,h=0;h<x;h++)R=R<<1|f,I==l-1?(I=0,M.push(u(R)),R=0):I++,f=0;for(f=v.charCodeAt(0),h=0;h<16;h++)R=R<<1|f&1,I==l-1?(I=0,M.push(u(R)),R=0):I++,f=f>>1}b--,b==0&&(b=Math.pow(2,x),x++),delete p[v]}else for(f=d[v],h=0;h<x;h++)R=R<<1|f&1,I==l-1?(I=0,M.push(u(R)),R=0):I++,f=f>>1;b--,b==0&&(b=Math.pow(2,x),x++)}for(f=2,h=0;h<x;h++)R=R<<1|f&1,I==l-1?(I=0,M.push(u(R)),R=0):I++,f=f>>1;for(;;)if(R=R<<1,I==l-1){M.push(u(R));break}else I++;return M.join("")},decompress:function(c){return c==null?"":c==""?null:o._decompress(c.length,32768,function(l){return c.charCodeAt(l)})},_decompress:function(c,l,u){var h=[],f=4,d=4,p=3,g="",y=[],v,b,T,x,M,R,I,k={val:u(0),position:l,index:1};for(v=0;v<3;v+=1)h[v]=v;for(T=0,M=Math.pow(2,2),R=1;R!=M;)x=k.val&k.position,k.position>>=1,k.position==0&&(k.position=l,k.val=u(k.index++)),T|=(x>0?1:0)*R,R<<=1;switch(T){case 0:for(T=0,M=Math.pow(2,8),R=1;R!=M;)x=k.val&k.position,k.position>>=1,k.position==0&&(k.position=l,k.val=u(k.index++)),T|=(x>0?1:0)*R,R<<=1;I=n(T);break;case 1:for(T=0,M=Math.pow(2,16),R=1;R!=M;)x=k.val&k.position,k.position>>=1,k.position==0&&(k.position=l,k.val=u(k.index++)),T|=(x>0?1:0)*R,R<<=1;I=n(T);break;case 2:return""}for(h[3]=I,b=I,y.push(I);;){if(k.index>c)return"";for(T=0,M=Math.pow(2,p),R=1;R!=M;)x=k.val&k.position,k.position>>=1,k.position==0&&(k.position=l,k.val=u(k.index++)),T|=(x>0?1:0)*R,R<<=1;switch(I=T){case 0:for(T=0,M=Math.pow(2,8),R=1;R!=M;)x=k.val&k.position,k.position>>=1,k.position==0&&(k.position=l,k.val=u(k.index++)),T|=(x>0?1:0)*R,R<<=1;h[d++]=n(T),I=d-1,f--;break;case 1:for(T=0,M=Math.pow(2,16),R=1;R!=M;)x=k.val&k.position,k.position>>=1,k.position==0&&(k.position=l,k.val=u(k.index++)),T|=(x>0?1:0)*R,R<<=1;h[d++]=n(T),I=d-1,f--;break;case 2:return y.join("")}if(f==0&&(f=Math.pow(2,p),p++),h[I])g=h[I];else if(I===d)g=b+b.charAt(0);else return null;y.push(g),h[d++]=b+g.charAt(0),f--,b=g,f==0&&(f=Math.pow(2,p),p++)}}};return o}();t!=null?t.exports=e:typeof angular<"u"&&angular!=null&&angular.module("LZString",[]).factory("LZString",function(){return e})})(pX);var aot=pX.exports;const oot=Yc(aot);var Fq={};function L_e(t){return t.replace(/</g,"&lt;").replace(/>/g,"&gt;")}const cot=(t,e,n,i,r,s,a)=>{const o=i+n.indent,c=n.colors;return t.map(l=>{const u=e[l];let h=a(u,n,o,r,s);return typeof u!="string"&&(h.indexOf(`
`)!==-1&&(h=n.spacingOuter+o+h+n.spacingOuter+i),h="{"+h+"}"),n.spacingInner+i+c.prop.open+l+c.prop.close+"="+c.value.open+h+c.value.close}).join("")},lot=3,uot=(t,e,n,i,r,s)=>t.map(a=>{const o=typeof a=="string"?U_e(a,e):s(a,e,n,i,r);return o===""&&typeof a=="object"&&a!==null&&a.nodeType!==lot?"":e.spacingOuter+n+o}).join(""),U_e=(t,e)=>{const n=e.colors.content;return n.open+L_e(t)+n.close},hot=(t,e)=>{const n=e.colors.comment;return n.open+"<!--"+L_e(t)+"-->"+n.close},fot=(t,e,n,i,r)=>{const s=i.colors.tag;return s.open+"<"+t+(e&&s.close+e+i.spacingOuter+r+s.open)+(n?">"+s.close+n+i.spacingOuter+r+s.open+"</"+t:(e&&!i.min?"":" ")+"/")+">"+s.close},dot=(t,e)=>{const n=e.colors.tag;return n.open+"<"+t+n.close+" …"+n.open+" />"+n.close},pot=1,B_e=3,F_e=8,z_e=11,mot=/^((HTML|SVG)\w*)?Element$/,H_e=t=>{const{tagName:e}=t;return!!(typeof e=="string"&&e.includes("-")||typeof t.hasAttribute=="function"&&t.hasAttribute("is"))},got=t=>{const e=t.constructor.name,{nodeType:n}=t;return n===pot&&(mot.test(e)||H_e(t))||n===B_e&&e==="Text"||n===F_e&&e==="Comment"||n===z_e&&e==="DocumentFragment"};function vot(t){return t.nodeType===B_e}function _ot(t){return t.nodeType===F_e}function gj(t){return t.nodeType===z_e}function yot(t){return{test:e=>{var n;return((e==null||(n=e.constructor)==null?void 0:n.name)||H_e(e))&&got(e)},serialize:(e,n,i,r,s,a)=>{if(vot(e))return U_e(e.data,n);if(_ot(e))return hot(e.data,n);const o=gj(e)?"DocumentFragment":e.tagName.toLowerCase();return++r>n.maxDepth?dot(o,n):fot(o,cot(gj(e)?[]:Array.from(e.attributes).map(c=>c.name).sort(),gj(e)?{}:Array.from(e.attributes).reduce((c,l)=>(c[l.name]=l.value,c),{}),n,i+n.indent,r,s,a),uot(Array.prototype.slice.call(e.childNodes||e.children).filter(t),n,i+n.indent,r,s,a),n,i)}}}let j_e=null,mX=null,gX=null;try{const t=module&&module.require;mX=t.call(module,"fs").readFileSync,gX=t.call(module,"@babel/code-frame").codeFrameColumns,j_e=t.call(module,"chalk")}catch{}function bot(t){const e=t.indexOf("(")+1,n=t.indexOf(")"),i=t.slice(e,n),r=i.split(":"),[s,a,o]=[r[0],parseInt(r[1],10),parseInt(r[2],10)];let c="";try{c=mX(s,"utf-8")}catch{return""}const l=gX(c,{start:{line:a,column:o}},{highlightCode:!0,linesBelow:0});return j_e.dim(i)+`
`+l+`
`}function Eot(){if(!mX||!gX)return"";const e=new Error().stack.split(`
`).slice(1).find(n=>!n.includes("node_modules/"));return bot(e)}const V_e=3;function vj(){return typeof jest<"u"&&jest!==null?setTimeout._isMockFunction===!0||Object.prototype.hasOwnProperty.call(setTimeout,"clock"):!1}function vX(){if(typeof window>"u")throw new Error("Could not find default container");return window.document}function Sot(t){if(t.defaultView)return t.defaultView;if(t.ownerDocument&&t.ownerDocument.defaultView)return t.ownerDocument.defaultView;if(t.window)return t.window;throw t.ownerDocument&&t.ownerDocument.defaultView===null?new Error("It looks like the window object is not available for the provided node."):t.then instanceof Function?new Error("It looks like you passed a Promise object instead of a DOM node. Did you do something like `fireEvent.click(screen.findBy...` when you meant to use a `getBy` query `fireEvent.click(screen.getBy...`, or await the findBy query `fireEvent.click(await screen.findBy...`?"):Array.isArray(t)?new Error("It looks like you passed an Array instead of a DOM node. Did you do something like `fireEvent.click(screen.getAllBy...` when you meant to use a `getBy` query `fireEvent.click(screen.getBy...`?"):typeof t.debug=="function"&&typeof t.logTestingPlaygroundURL=="function"?new Error("It looks like you passed a `screen` object. Did you do something like `fireEvent.click(screen, ...` when you meant to use a query, e.g. `fireEvent.click(screen.getBy..., `?"):new Error("The given node is not an Element, the node type is: "+typeof t+".")}function F_(t){if(!t||typeof t.querySelector!="function"||typeof t.querySelectorAll!="function")throw new TypeError("Expected container to be an Element, a Document or a DocumentFragment but got "+e(t)+".");function e(n){return typeof n=="object"?n===null?"null":n.constructor.name:typeof n}}const Tot=()=>{if(typeof zn>"u")return!1;let t;try{var e;const n=(e=Fq)==null?void 0:e.COLORS;n&&(t=JSON.parse(n))}catch{}return typeof t=="boolean"?t:zn.versions!==void 0&&zn.versions.node!==void 0},{DOMCollection:xot}=i_e,wot=1,Cot=8;function Aot(t){return t.nodeType!==Cot&&(t.nodeType!==wot||!t.matches(os().defaultIgnore))}function x3(t,e,n){if(n===void 0&&(n={}),t||(t=vX().body),typeof e!="number"&&(e=typeof zn<"u"&&typeof Fq<"u"&&Fq.DEBUG_PRINT_LIMIT||7e3),e===0)return"";t.documentElement&&(t=t.documentElement);let i=typeof t;if(i==="object"?i=t.constructor.name:t={},!("outerHTML"in t))throw new TypeError("Expected an element or document but got "+i);const{filterNode:r=Aot,...s}=n,a=sZe(t,{plugins:[yot(r),xot],printFunctionName:!1,highlight:Tot(),...s});return e!==void 0&&t.outerHTML.length>e?a.slice(0,e)+"...":a}const xre=function(){const t=Eot();console.log(t?x3(...arguments)+`

`+t:x3(...arguments))};let w3={testIdAttribute:"data-testid",asyncUtilTimeout:1e3,asyncWrapper:t=>t(),unstable_advanceTimersWrapper:t=>t(),eventWrapper:t=>t(),defaultHidden:!1,defaultIgnore:"script, style",showOriginalStackTrace:!1,throwSuggestions:!1,getElementError(t,e){const n=x3(e),i=new Error([t,"Ignored nodes: comments, "+w3.defaultIgnore+`
`+n].filter(Boolean).join(`

`));return i.name="TestingLibraryElementError",i},_disableExpensiveErrorDiagnostics:!1,computedStyleSupportsPseudoElements:!1};function Rot(t){try{return w3._disableExpensiveErrorDiagnostics=!0,t()}finally{w3._disableExpensiveErrorDiagnostics=!1}}function os(){return w3}const Mot=["button","meter","output","progress","select","textarea","input"];function G_e(t){return Mot.includes(t.nodeName.toLowerCase())?"":t.nodeType===V_e?t.textContent:Array.from(t.childNodes).map(e=>G_e(e)).join("")}function zq(t){let e;return t.tagName.toLowerCase()==="label"?e=G_e(t):e=t.value||t.textContent,e}function q_e(t){if(t.labels!==void 0){var e;return(e=t.labels)!=null?e:[]}if(!Oot(t))return[];const n=t.ownerDocument.querySelectorAll("label");return Array.from(n).filter(i=>i.control===t)}function Oot(t){return/BUTTON|METER|OUTPUT|PROGRESS|SELECT|TEXTAREA/.test(t.tagName)||t.tagName==="INPUT"&&t.getAttribute("type")!=="hidden"}function $_e(t,e,n){let{selector:i="*"}=n===void 0?{}:n;const r=e.getAttribute("aria-labelledby"),s=r?r.split(" "):[];return s.length?s.map(a=>{const o=t.querySelector('[id="'+a+'"]');return o?{content:zq(o),formControl:null}:{content:"",formControl:null}}):Array.from(q_e(e)).map(a=>{const o=zq(a),l=Array.from(a.querySelectorAll("button, input, meter, output, progress, select, textarea")).filter(u=>u.matches(i))[0];return{content:o,formControl:l}})}function W_e(t){if(t==null)throw new Error("It looks like "+t+" was passed instead of a matcher. Did you do something like getByText("+t+")?")}function VA(t,e,n,i){if(typeof t!="string")return!1;W_e(n);const r=i(t);return typeof n=="string"||typeof n=="number"?r.toLowerCase().includes(n.toString().toLowerCase()):typeof n=="function"?n(r,e):X_e(n,r)}function f_(t,e,n,i){if(typeof t!="string")return!1;W_e(n);const r=i(t);return n instanceof Function?n(r,e):n instanceof RegExp?X_e(n,r):r===String(n)}function Y_e(t){let{trim:e=!0,collapseWhitespace:n=!0}=t===void 0?{}:t;return i=>{let r=i;return r=e?r.trim():r,r=n?r.replace(/\s+/g," "):r,r}}function I1(t){let{trim:e,collapseWhitespace:n,normalizer:i}=t;if(!i)return Y_e({trim:e,collapseWhitespace:n});if(typeof e<"u"||typeof n<"u")throw new Error('trim and collapseWhitespace are not supported with a normalizer. If you want to use the default trim and collapseWhitespace logic in your normalizer, use "getDefaultNormalizer({trim, collapseWhitespace})" and compose that into your normalizer');return i}function X_e(t,e){const n=t.test(e);return t.global&&t.lastIndex!==0&&(console.warn("To match all elements we had to reset the lastIndex of the RegExp because the global flag is enabled. We encourage to remove the global flag from the RegExp."),t.lastIndex=0),n}function zz(t){return t.matches("input[type=submit], input[type=button], input[type=reset]")?t.value:Array.from(t.childNodes).filter(e=>e.nodeType===V_e&&!!e.textContent).map(e=>e.textContent).join("")}const Not=Iot(D_e);function K_e(t){return t.hidden===!0||t.getAttribute("aria-hidden")==="true"||t.ownerDocument.defaultView.getComputedStyle(t).display==="none"}function _X(t,e){e===void 0&&(e={});const{isSubtreeInaccessible:n=K_e}=e;if(t.ownerDocument.defaultView.getComputedStyle(t).visibility==="hidden")return!0;let r=t;for(;r;){if(n(r))return!0;r=r.parentElement}return!1}function yX(t){for(const{match:e,roles:n}of Not)if(e(t))return[...n];return[]}function Iot(t){function e(a){let{name:o,attributes:c}=a;return""+o+c.map(l=>{let{name:u,value:h,constraints:f=[]}=l;const d=f.indexOf("undefined")!==-1,p=f.indexOf("set")!==-1;return typeof h<"u"?"["+u+'="'+h+'"]':d?":not(["+u+"])":p?"["+u+"]:not(["+u+'=""])':"["+u+"]"}).join("")}function n(a){let{attributes:o=[]}=a;return o.length}function i(a,o){let{specificity:c}=a,{specificity:l}=o;return l-c}function r(a){let{attributes:o=[]}=a;const c=o.findIndex(u=>u.value&&u.name==="type"&&u.value==="text");c>=0&&(o=[...o.slice(0,c),...o.slice(c+1)]);const l=e({...a,attributes:o});return u=>c>=0&&u.type!=="text"?!1:u.matches(l)}let s=[];for(const[a,o]of t.entries())s=[...s,{match:r(a),roles:Array.from(o),specificity:n(a)}];return s.sort(i)}function kot(t,e){let{hidden:n=!1}=e===void 0?{}:e;function i(r){return[r,...Array.from(r.children).reduce((s,a)=>[...s,...i(a)],[])]}return i(t).filter(r=>n===!1?_X(r)===!1:!0).reduce((r,s)=>{let a=[];return s.hasAttribute("role")?a=s.getAttribute("role").split(" ").slice(0,1):a=yX(s),a.reduce((o,c)=>Array.isArray(o[c])?{...o,[c]:[...o[c],s]}:{...o,[c]:[s]},r)},{})}function Dot(t,e){let{hidden:n,includeDescription:i}=e;const r=kot(t,{hidden:n});return Object.entries(r).filter(s=>{let[a]=s;return a!=="generic"}).map(s=>{let[a,o]=s;const c="-".repeat(50),l=o.map(u=>{const h='Name "'+fX(u,{computedStyleSupportsPseudoElements:os().computedStyleSupportsPseudoElements})+`":
`,f=x3(u.cloneNode(!1));if(i){const d='Description "'+S_e(u,{computedStyleSupportsPseudoElements:os().computedStyleSupportsPseudoElements})+`":
`;return""+h+d+f}return""+h+f}).join(`

`);return a+`:

`+l+`

`+c}).join(`
`)}function Pot(t){return t.tagName==="OPTION"?t.selected:mk(t,"aria-selected")}function Lot(t){return t.getAttribute("aria-busy")==="true"}function Uot(t){if(!("indeterminate"in t&&t.indeterminate))return"checked"in t?t.checked:mk(t,"aria-checked")}function Bot(t){return mk(t,"aria-pressed")}function Fot(t){var e,n;return(e=(n=mk(t,"aria-current"))!=null?n:t.getAttribute("aria-current"))!=null?e:!1}function zot(t){return mk(t,"aria-expanded")}function mk(t,e){const n=t.getAttribute(e);if(n==="true")return!0;if(n==="false")return!1}function Hot(t){const e={H1:1,H2:2,H3:3,H4:4,H5:5,H6:6};return t.getAttribute("aria-level")&&Number(t.getAttribute("aria-level"))||e[t.tagName]}function jot(t){const e=t.getAttribute("aria-valuenow");return e===null?void 0:+e}function Vot(t){const e=t.getAttribute("aria-valuemax");return e===null?void 0:+e}function Got(t){const e=t.getAttribute("aria-valuemin");return e===null?void 0:+e}function qot(t){const e=t.getAttribute("aria-valuetext");return e===null?void 0:e}const wre=Y_e();function $ot(t){return t.replace(/[.*+\-?^${}()|[\]\\]/g,"\\$&")}function Cre(t){return new RegExp($ot(t.toLowerCase()),"i")}function My(t,e,n,i){let{variant:r,name:s}=i,a="";const o={},c=[["Role","TestId"].includes(t)?n:Cre(n)];s&&(o.name=Cre(s)),t==="Role"&&_X(e)&&(o.hidden=!0,a=`Element is inaccessible. This means that the element and all its children are invisible to screen readers.
    If you are using the aria-hidden prop, make sure this is the right choice for your case.
    `),Object.keys(o).length>0&&c.push(o);const l=r+"By"+t;return{queryName:t,queryMethod:l,queryArgs:c,variant:r,warning:a,toString(){a&&console.warn(a);let[u,h]=c;return u=typeof u=="string"?"'"+u+"'":u,h=h?", { "+Object.entries(h).map(f=>{let[d,p]=f;return d+": "+p}).join(", ")+" }":"",l+"("+u+h+")"}}}function Oy(t,e,n){return n&&!e}function Hq(t,e,n){var i,r;if(e===void 0&&(e="get"),t.matches(os().defaultIgnore))return;const s=(i=t.getAttribute("role"))!=null?i:(r=yX(t))==null?void 0:r[0];if(s!=="generic"&&Oy("Role",n,s))return My("Role",t,s,{variant:e,name:fX(t,{computedStyleSupportsPseudoElements:os().computedStyleSupportsPseudoElements})});const a=$_e(document,t).map(f=>f.content).join(" ");if(Oy("LabelText",n,a))return My("LabelText",t,a,{variant:e});const o=t.getAttribute("placeholder");if(Oy("PlaceholderText",n,o))return My("PlaceholderText",t,o,{variant:e});const c=wre(zz(t));if(Oy("Text",n,c))return My("Text",t,c,{variant:e});if(Oy("DisplayValue",n,t.value))return My("DisplayValue",t,wre(t.value),{variant:e});const l=t.getAttribute("alt");if(Oy("AltText",n,l))return My("AltText",t,l,{variant:e});const u=t.getAttribute("title");if(Oy("Title",n,u))return My("Title",t,u,{variant:e});const h=t.getAttribute(os().testIdAttribute);if(Oy("TestId",n,h))return My("TestId",t,h,{variant:e})}function NP(t,e){t.stack=e.stack.replace(e.message,t.message)}function Wot(t,e){let{container:n=vX(),timeout:i=os().asyncUtilTimeout,showOriginalStackTrace:r=os().showOriginalStackTrace,stackTraceError:s,interval:a=50,onTimeout:o=l=>(Object.defineProperty(l,"message",{value:os().getElementError(l.message,n).message}),l),mutationObserverOptions:c={subtree:!0,childList:!0,attributes:!0,characterData:!0}}=e;if(typeof t!="function")throw new TypeError("Received `callback` arg must be a function");return new Promise(async(l,u)=>{let h,f,d,p=!1,g="idle";const y=setTimeout(M,i),v=vj();if(v){const{unstable_advanceTimersWrapper:R}=os();for(x();!p;){if(!vj()){const I=new Error("Changed from using fake timers to real timers while using waitFor. This is not allowed and will result in very strange behavior. Please ensure you're awaiting all async things your test is doing before changing to real timers. For more info, please go to https://github.com/testing-library/dom-testing-library/issues/830");r||NP(I,s),u(I);return}if(await R(async()=>{jest.advanceTimersByTime(a)}),p)break;x()}}else{try{F_(n)}catch(I){u(I);return}f=setInterval(T,a);const{MutationObserver:R}=Sot(n);d=new R(T),d.observe(n,c),x()}function b(R,I){p=!0,clearTimeout(y),v||(clearInterval(f),d.disconnect()),R?u(R):l(I)}function T(){if(vj()){const R=new Error("Changed from using real timers to fake timers while using waitFor. This is not allowed and will result in very strange behavior. Please ensure you're awaiting all async things your test is doing before changing to fake timers. For more info, please go to https://github.com/testing-library/dom-testing-library/issues/830");return r||NP(R,s),u(R)}else return x()}function x(){if(g!=="pending")try{const R=Rot(t);typeof(R==null?void 0:R.then)=="function"?(g="pending",R.then(I=>{g="resolved",b(null,I)},I=>{g="rejected",h=I})):b(null,R)}catch(R){h=R}}function M(){let R;h?(R=h,!r&&R.name==="TestingLibraryElementError"&&NP(R,s)):(R=new Error("Timed out in waitFor."),r||NP(R,s)),b(o(R),null)}})}function Yot(t,e){const n=new Error("STACK_TRACE_MESSAGE");return os().asyncWrapper(()=>Wot(t,{stackTraceError:n,...e}))}function Z_e(t,e){return os().getElementError(t,e)}function Xot(t,e){return Z_e(t+"\n\n(If this is intentional, then use the `*AllBy*` variant of the query (like `queryAllByText`, `getAllByText`, or `findAllByText`)).",e)}function Hz(t,e,n,i){let{exact:r=!0,collapseWhitespace:s,trim:a,normalizer:o}=i===void 0?{}:i;const c=r?f_:VA,l=I1({collapseWhitespace:s,trim:a,normalizer:o});return Array.from(e.querySelectorAll("["+t+"]")).filter(u=>c(u.getAttribute(t),u,n,l))}function C3(t,e){return function(n){for(var i=arguments.length,r=new Array(i>1?i-1:0),s=1;s<i;s++)r[s-1]=arguments[s];const a=t(n,...r);if(a.length>1){const o=a.map(c=>Z_e(null,c).message).join(`

`);throw Xot(e(n,...r)+`

Here are the matching elements:

`+o,n)}return a[0]||null}}function J_e(t,e){return os().getElementError(`A better query is available, try this:
`+t.toString()+`
`,e)}function Kot(t,e){return function(n){for(var i=arguments.length,r=new Array(i>1?i-1:0),s=1;s<i;s++)r[s-1]=arguments[s];const a=t(n,...r);if(!a.length)throw os().getElementError(e(n,...r),n);return a}}function A3(t){return(e,n,i,r)=>Yot(()=>t(e,n,i),{container:e,...r})}const aC=(t,e,n)=>function(i){for(var r=arguments.length,s=new Array(r>1?r-1:0),a=1;a<r;a++)s[a-1]=arguments[a];const o=t(i,...s),[{suggest:c=os().throwSuggestions}={}]=s.slice(-1);if(o&&c){const l=Hq(o,n);if(l&&!e.endsWith(l.queryName))throw J_e(l.toString(),i)}return o},bp=(t,e,n)=>function(i){for(var r=arguments.length,s=new Array(r>1?r-1:0),a=1;a<r;a++)s[a-1]=arguments[a];const o=t(i,...s),[{suggest:c=os().throwSuggestions}={}]=s.slice(-1);if(o.length&&c){const l=[...new Set(o.map(u=>{var h;return(h=Hq(u,n))==null?void 0:h.toString()}))];if(l.length===1&&!e.endsWith(Hq(o[0],n).queryName))throw J_e(l[0],i)}return o};function k1(t,e,n){const i=aC(C3(t,e),t.name,"query"),r=Kot(t,n),s=C3(r,e),a=aC(s,t.name,"get"),o=bp(r,t.name.replace("query","get"),"getAll"),c=A3(bp(r,t.name,"findAll")),l=A3(aC(s,t.name,"find"));return[i,o,a,c,l]}function Zot(t){return Array.from(t.querySelectorAll("label,input")).map(e=>({node:e,textToMatch:zq(e)})).filter(e=>{let{textToMatch:n}=e;return n!==null})}const Jot=function(t,e,n){let{exact:i=!0,trim:r,collapseWhitespace:s,normalizer:a}=n===void 0?{}:n;const o=i?f_:VA,c=I1({collapseWhitespace:s,trim:r,normalizer:a});return Zot(t).filter(u=>{let{node:h,textToMatch:f}=u;return o(f,h,e,c)}).map(u=>{let{node:h}=u;return h})},wN=function(t,e,n){let{selector:i="*",exact:r=!0,collapseWhitespace:s,trim:a,normalizer:o}=n===void 0?{}:n;F_(t);const c=r?f_:VA,l=I1({collapseWhitespace:s,trim:a,normalizer:o}),u=Array.from(t.querySelectorAll("*")).filter(h=>q_e(h).length||h.hasAttribute("aria-labelledby")).reduce((h,f)=>{const d=$_e(t,f,{selector:i});d.filter(g=>!!g.formControl).forEach(g=>{c(g.content,g.formControl,e,l)&&g.formControl&&h.push(g.formControl)});const p=d.filter(g=>!!g.content).map(g=>g.content);return c(p.join(" "),f,e,l)&&h.push(f),p.length>1&&p.forEach((g,y)=>{c(g,f,e,l)&&h.push(f);const v=[...p];v.splice(y,1),v.length>1&&c(v.join(" "),f,e,l)&&h.push(f)}),h},[]).concat(Hz("aria-label",t,e,{exact:r,normalizer:l}));return Array.from(new Set(u)).filter(h=>h.matches(i))},r1=function(t,e){for(var n=arguments.length,i=new Array(n>2?n-2:0),r=2;r<n;r++)i[r-2]=arguments[r];const s=wN(t,e,...i);if(!s.length){const a=Jot(t,e,...i);if(a.length){const o=a.map(c=>Qot(t,c)).filter(c=>!!c);throw o.length?os().getElementError(o.map(c=>"Found a label with the text of: "+e+", however the element associated with this label (<"+c+" />) is non-labellable [https://html.spec.whatwg.org/multipage/forms.html#category-label]. If you really need to label a <"+c+" />, you can use aria-label or aria-labelledby instead.").join(`

`),t):os().getElementError("Found a label with the text of: "+e+`, however no form control was found associated to that label. Make sure you're using the "for" attribute or "aria-labelledby" attribute correctly.`,t)}else throw os().getElementError("Unable to find a label with the text of: "+e,t)}return s};function Qot(t,e){const n=e.getAttribute("for");if(!n)return null;const i=t.querySelector('[id="'+n+'"]');return i?i.tagName.toLowerCase():null}const Q_e=(t,e)=>"Found multiple elements with the text of: "+e,ect=aC(C3(wN,Q_e),wN.name,"query"),eye=C3(r1,Q_e),tct=A3(bp(r1,r1.name,"findAll")),nct=A3(aC(eye,r1.name,"find")),ict=bp(r1,r1.name,"getAll"),rct=aC(eye,r1.name,"get"),sct=bp(wN,wN.name,"queryAll"),jq=function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return F_(e[0]),Hz("placeholder",...e)},act=(t,e)=>"Found multiple elements with the placeholder text of: "+e,oct=(t,e)=>"Unable to find an element with the placeholder text of: "+e,cct=bp(jq,jq.name,"queryAll"),[lct,uct,hct,fct,dct]=k1(jq,act,oct),Vq=function(t,e,n){let{selector:i="*",exact:r=!0,collapseWhitespace:s,trim:a,ignore:o=os().defaultIgnore,normalizer:c}=n===void 0?{}:n;F_(t);const l=r?f_:VA,u=I1({collapseWhitespace:s,trim:a,normalizer:c});let h=[];return typeof t.matches=="function"&&t.matches(i)&&(h=[t]),[...h,...Array.from(t.querySelectorAll(i))].filter(f=>!o||!f.matches(o)).filter(f=>l(zz(f),f,e,u))},pct=(t,e)=>"Found multiple elements with the text: "+e,mct=function(t,e,n){n===void 0&&(n={});const{collapseWhitespace:i,trim:r,normalizer:s,selector:a}=n,c=I1({collapseWhitespace:i,trim:r,normalizer:s})(e.toString()),l=c!==e.toString(),u=(a??"*")!=="*";return"Unable to find an element with the text: "+(l?c+" (normalized from '"+e+"')":e)+(u?", which matches selector '"+a+"'":"")+". This could be because the text is broken up by multiple elements. In this case, you can provide a function for your text matcher to make your matcher more flexible."},gct=bp(Vq,Vq.name,"queryAll"),[vct,_ct,yct,bct,Ect]=k1(Vq,pct,mct),Gq=function(t,e,n){let{exact:i=!0,collapseWhitespace:r,trim:s,normalizer:a}=n===void 0?{}:n;F_(t);const o=i?f_:VA,c=I1({collapseWhitespace:r,trim:s,normalizer:a});return Array.from(t.querySelectorAll("input,textarea,select")).filter(l=>l.tagName==="SELECT"?Array.from(l.options).filter(h=>h.selected).some(h=>o(zz(h),h,e,c)):o(l.value,l,e,c))},Sct=(t,e)=>"Found multiple elements with the display value: "+e+".",Tct=(t,e)=>"Unable to find an element with the display value: "+e+".",xct=bp(Gq,Gq.name,"queryAll"),[wct,Cct,Act,Rct,Mct]=k1(Gq,Sct,Tct),Oct=/^(img|input|area|.+-.+)$/i,qq=function(t,e,n){return n===void 0&&(n={}),F_(t),Hz("alt",t,e,n).filter(i=>Oct.test(i.tagName))},Nct=(t,e)=>"Found multiple elements with the alt text: "+e,Ict=(t,e)=>"Unable to find an element with the alt text: "+e,kct=bp(qq,qq.name,"queryAll"),[Dct,Pct,Lct,Uct,Bct]=k1(qq,Nct,Ict),Fct=t=>{var e;return t.tagName.toLowerCase()==="title"&&((e=t.parentElement)==null?void 0:e.tagName.toLowerCase())==="svg"},$q=function(t,e,n){let{exact:i=!0,collapseWhitespace:r,trim:s,normalizer:a}=n===void 0?{}:n;F_(t);const o=i?f_:VA,c=I1({collapseWhitespace:r,trim:s,normalizer:a});return Array.from(t.querySelectorAll("[title], svg > title")).filter(l=>o(l.getAttribute("title"),l,e,c)||Fct(l)&&o(zz(l),l,e,c))},zct=(t,e)=>"Found multiple elements with the title: "+e+".",Hct=(t,e)=>"Unable to find an element with the title: "+e+".",jct=bp($q,$q.name,"queryAll"),[Vct,Gct,qct,$ct,Wct]=k1($q,zct,Hct),Wq=function(t,e,n){let{hidden:i=os().defaultHidden,name:r,description:s,queryFallbacks:a=!1,selected:o,busy:c,checked:l,pressed:u,current:h,level:f,expanded:d,value:{now:p,min:g,max:y,text:v}={}}=n===void 0?{}:n;if(F_(t),o!==void 0){var b;if(((b=Qp.get(e))==null?void 0:b.props["aria-selected"])===void 0)throw new Error('"aria-selected" is not supported on role "'+e+'".')}if(c!==void 0){var T;if(((T=Qp.get(e))==null?void 0:T.props["aria-busy"])===void 0)throw new Error('"aria-busy" is not supported on role "'+e+'".')}if(l!==void 0){var x;if(((x=Qp.get(e))==null?void 0:x.props["aria-checked"])===void 0)throw new Error('"aria-checked" is not supported on role "'+e+'".')}if(u!==void 0){var M;if(((M=Qp.get(e))==null?void 0:M.props["aria-pressed"])===void 0)throw new Error('"aria-pressed" is not supported on role "'+e+'".')}if(h!==void 0){var R;if(((R=Qp.get(e))==null?void 0:R.props["aria-current"])===void 0)throw new Error('"aria-current" is not supported on role "'+e+'".')}if(f!==void 0&&e!=="heading")throw new Error('Role "'+e+'" cannot have "level" property.');if(p!==void 0){var I;if(((I=Qp.get(e))==null?void 0:I.props["aria-valuenow"])===void 0)throw new Error('"aria-valuenow" is not supported on role "'+e+'".')}if(y!==void 0){var k;if(((k=Qp.get(e))==null?void 0:k.props["aria-valuemax"])===void 0)throw new Error('"aria-valuemax" is not supported on role "'+e+'".')}if(g!==void 0){var P;if(((P=Qp.get(e))==null?void 0:P.props["aria-valuemin"])===void 0)throw new Error('"aria-valuemin" is not supported on role "'+e+'".')}if(v!==void 0){var U;if(((U=Qp.get(e))==null?void 0:U.props["aria-valuetext"])===void 0)throw new Error('"aria-valuetext" is not supported on role "'+e+'".')}if(d!==void 0){var G;if(((G=Qp.get(e))==null?void 0:G.props["aria-expanded"])===void 0)throw new Error('"aria-expanded" is not supported on role "'+e+'".')}const $=new WeakMap;function q(Y){return $.has(Y)||$.set(Y,K_e(Y)),$.get(Y)}return Array.from(t.querySelectorAll(Yct(e))).filter(Y=>{if(Y.hasAttribute("role")){const J=Y.getAttribute("role");if(a)return J.split(" ").filter(Boolean).some(ee=>ee===e);const[X]=J.split(" ");return X===e}return yX(Y).some(J=>J===e)}).filter(Y=>{if(o!==void 0)return o===Pot(Y);if(c!==void 0)return c===Lot(Y);if(l!==void 0)return l===Uot(Y);if(u!==void 0)return u===Bot(Y);if(h!==void 0)return h===Fot(Y);if(d!==void 0)return d===zot(Y);if(f!==void 0)return f===Hot(Y);if(p!==void 0||y!==void 0||g!==void 0||v!==void 0){let V=!0;if(p!==void 0&&V&&(V=p===jot(Y)),y!==void 0&&V&&(V=y===Vot(Y)),g!==void 0&&V&&(V=g===Got(Y)),v!==void 0){var ie;V&&(V=f_((ie=qot(Y))!=null?ie:null,Y,v,J=>J))}return V}return!0}).filter(Y=>r===void 0?!0:f_(fX(Y,{computedStyleSupportsPseudoElements:os().computedStyleSupportsPseudoElements}),Y,r,ie=>ie)).filter(Y=>s===void 0?!0:f_(S_e(Y,{computedStyleSupportsPseudoElements:os().computedStyleSupportsPseudoElements}),Y,s,ie=>ie)).filter(Y=>i===!1?_X(Y,{isSubtreeInaccessible:q})===!1:!0)};function Yct(t){var e;const n='*[role~="'+t+'"]',i=(e=P_e.get(t))!=null?e:new Set,r=new Set(Array.from(i).map(s=>{let{name:a}=s;return a}));return[n].concat(Array.from(r)).join(",")}const tye=t=>{let e="";return t===void 0?e="":typeof t=="string"?e=' and name "'+t+'"':e=" and name `"+t+"`",e},Xct=function(t,e,n){let{name:i}=n===void 0?{}:n;return'Found multiple elements with the role "'+e+'"'+tye(i)},Kct=function(t,e,n){let{hidden:i=os().defaultHidden,name:r,description:s}=n===void 0?{}:n;if(os()._disableExpensiveErrorDiagnostics)return'Unable to find role="'+e+'"'+tye(r);let a="";Array.from(t.children).forEach(u=>{a+=Dot(u,{hidden:i,includeDescription:s!==void 0})});let o;a.length===0?i===!1?o="There are no accessible roles. But there might be some inaccessible roles. If you wish to access them, then set the `hidden` option to `true`. Learn more about this here: https://testing-library.com/docs/dom-testing-library/api-queries#byrole":o="There are no available roles.":o=(`
Here are the `+(i===!1?"accessible":"available")+` roles:

  `+a.replace(/\n/g,`
  `).replace(/\n\s\s\n/g,`

`)+`
`).trim();let c="";r===void 0?c="":typeof r=="string"?c=' and name "'+r+'"':c=" and name `"+r+"`";let l="";return s===void 0?l="":typeof s=="string"?l=' and description "'+s+'"':l=" and description `"+s+"`",(`
Unable to find an `+(i===!1?"accessible ":"")+'element with the role "'+e+'"'+c+l+`

`+o).trim()},Zct=bp(Wq,Wq.name,"queryAll"),[Jct,Qct,elt,tlt,nlt]=k1(Wq,Xct,Kct),bX=()=>os().testIdAttribute,Yq=function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return F_(e[0]),Hz(bX(),...e)},ilt=(t,e)=>"Found multiple elements by: ["+bX()+'="'+e+'"]',rlt=(t,e)=>"Unable to find an element by: ["+bX()+'="'+e+'"]',slt=bp(Yq,Yq.name,"queryAll"),[alt,olt,clt,llt,ult]=k1(Yq,ilt,rlt);var Xq=Object.freeze({__proto__:null,queryAllByLabelText:sct,queryByLabelText:ect,getAllByLabelText:ict,getByLabelText:rct,findAllByLabelText:tct,findByLabelText:nct,queryByPlaceholderText:lct,queryAllByPlaceholderText:cct,getByPlaceholderText:hct,getAllByPlaceholderText:uct,findAllByPlaceholderText:fct,findByPlaceholderText:dct,queryByText:vct,queryAllByText:gct,getByText:yct,getAllByText:_ct,findAllByText:bct,findByText:Ect,queryByDisplayValue:wct,queryAllByDisplayValue:xct,getByDisplayValue:Act,getAllByDisplayValue:Cct,findAllByDisplayValue:Rct,findByDisplayValue:Mct,queryByAltText:Dct,queryAllByAltText:kct,getByAltText:Lct,getAllByAltText:Pct,findAllByAltText:Uct,findByAltText:Bct,queryByTitle:Vct,queryAllByTitle:jct,getByTitle:qct,getAllByTitle:Gct,findAllByTitle:$ct,findByTitle:Wct,queryByRole:Jct,queryAllByRole:Zct,getAllByRole:Qct,getByRole:elt,findAllByRole:tlt,findByRole:nlt,queryByTestId:alt,queryAllByTestId:slt,getByTestId:clt,getAllByTestId:olt,findAllByTestId:llt,findByTestId:ult});function hlt(t,e,n){return e===void 0&&(e=Xq),n===void 0&&(n={}),Object.keys(e).reduce((i,r)=>{const s=e[r];return i[r]=s.bind(null,t),i},n)}const flt={copy:{EventType:"ClipboardEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},cut:{EventType:"ClipboardEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},paste:{EventType:"ClipboardEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},compositionEnd:{EventType:"CompositionEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},compositionStart:{EventType:"CompositionEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},compositionUpdate:{EventType:"CompositionEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},keyDown:{EventType:"KeyboardEvent",defaultInit:{bubbles:!0,cancelable:!0,charCode:0,composed:!0}},keyPress:{EventType:"KeyboardEvent",defaultInit:{bubbles:!0,cancelable:!0,charCode:0,composed:!0}},keyUp:{EventType:"KeyboardEvent",defaultInit:{bubbles:!0,cancelable:!0,charCode:0,composed:!0}},focus:{EventType:"FocusEvent",defaultInit:{bubbles:!1,cancelable:!1,composed:!0}},blur:{EventType:"FocusEvent",defaultInit:{bubbles:!1,cancelable:!1,composed:!0}},focusIn:{EventType:"FocusEvent",defaultInit:{bubbles:!0,cancelable:!1,composed:!0}},focusOut:{EventType:"FocusEvent",defaultInit:{bubbles:!0,cancelable:!1,composed:!0}},change:{EventType:"Event",defaultInit:{bubbles:!0,cancelable:!1}},input:{EventType:"InputEvent",defaultInit:{bubbles:!0,cancelable:!1,composed:!0}},invalid:{EventType:"Event",defaultInit:{bubbles:!1,cancelable:!0}},submit:{EventType:"Event",defaultInit:{bubbles:!0,cancelable:!0}},reset:{EventType:"Event",defaultInit:{bubbles:!0,cancelable:!0}},click:{EventType:"MouseEvent",defaultInit:{bubbles:!0,cancelable:!0,button:0,composed:!0}},contextMenu:{EventType:"MouseEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},dblClick:{EventType:"MouseEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},drag:{EventType:"DragEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},dragEnd:{EventType:"DragEvent",defaultInit:{bubbles:!0,cancelable:!1,composed:!0}},dragEnter:{EventType:"DragEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},dragExit:{EventType:"DragEvent",defaultInit:{bubbles:!0,cancelable:!1,composed:!0}},dragLeave:{EventType:"DragEvent",defaultInit:{bubbles:!0,cancelable:!1,composed:!0}},dragOver:{EventType:"DragEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},dragStart:{EventType:"DragEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},drop:{EventType:"DragEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},mouseDown:{EventType:"MouseEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},mouseEnter:{EventType:"MouseEvent",defaultInit:{bubbles:!1,cancelable:!1,composed:!0}},mouseLeave:{EventType:"MouseEvent",defaultInit:{bubbles:!1,cancelable:!1,composed:!0}},mouseMove:{EventType:"MouseEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},mouseOut:{EventType:"MouseEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},mouseOver:{EventType:"MouseEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},mouseUp:{EventType:"MouseEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},select:{EventType:"Event",defaultInit:{bubbles:!0,cancelable:!1}},touchCancel:{EventType:"TouchEvent",defaultInit:{bubbles:!0,cancelable:!1,composed:!0}},touchEnd:{EventType:"TouchEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},touchMove:{EventType:"TouchEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},touchStart:{EventType:"TouchEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},resize:{EventType:"UIEvent",defaultInit:{bubbles:!1,cancelable:!1}},scroll:{EventType:"UIEvent",defaultInit:{bubbles:!1,cancelable:!1}},wheel:{EventType:"WheelEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},abort:{EventType:"Event",defaultInit:{bubbles:!1,cancelable:!1}},canPlay:{EventType:"Event",defaultInit:{bubbles:!1,cancelable:!1}},canPlayThrough:{EventType:"Event",defaultInit:{bubbles:!1,cancelable:!1}},durationChange:{EventType:"Event",defaultInit:{bubbles:!1,cancelable:!1}},emptied:{EventType:"Event",defaultInit:{bubbles:!1,cancelable:!1}},encrypted:{EventType:"Event",defaultInit:{bubbles:!1,cancelable:!1}},ended:{EventType:"Event",defaultInit:{bubbles:!1,cancelable:!1}},loadedData:{EventType:"Event",defaultInit:{bubbles:!1,cancelable:!1}},loadedMetadata:{EventType:"Event",defaultInit:{bubbles:!1,cancelable:!1}},loadStart:{EventType:"ProgressEvent",defaultInit:{bubbles:!1,cancelable:!1}},pause:{EventType:"Event",defaultInit:{bubbles:!1,cancelable:!1}},play:{EventType:"Event",defaultInit:{bubbles:!1,cancelable:!1}},playing:{EventType:"Event",defaultInit:{bubbles:!1,cancelable:!1}},progress:{EventType:"ProgressEvent",defaultInit:{bubbles:!1,cancelable:!1}},rateChange:{EventType:"Event",defaultInit:{bubbles:!1,cancelable:!1}},seeked:{EventType:"Event",defaultInit:{bubbles:!1,cancelable:!1}},seeking:{EventType:"Event",defaultInit:{bubbles:!1,cancelable:!1}},stalled:{EventType:"Event",defaultInit:{bubbles:!1,cancelable:!1}},suspend:{EventType:"Event",defaultInit:{bubbles:!1,cancelable:!1}},timeUpdate:{EventType:"Event",defaultInit:{bubbles:!1,cancelable:!1}},volumeChange:{EventType:"Event",defaultInit:{bubbles:!1,cancelable:!1}},waiting:{EventType:"Event",defaultInit:{bubbles:!1,cancelable:!1}},load:{EventType:"Event",defaultInit:{bubbles:!1,cancelable:!1}},error:{EventType:"Event",defaultInit:{bubbles:!1,cancelable:!1}},animationStart:{EventType:"AnimationEvent",defaultInit:{bubbles:!0,cancelable:!1}},animationEnd:{EventType:"AnimationEvent",defaultInit:{bubbles:!0,cancelable:!1}},animationIteration:{EventType:"AnimationEvent",defaultInit:{bubbles:!0,cancelable:!1}},transitionCancel:{EventType:"TransitionEvent",defaultInit:{bubbles:!0,cancelable:!1}},transitionEnd:{EventType:"TransitionEvent",defaultInit:{bubbles:!0,cancelable:!0}},transitionRun:{EventType:"TransitionEvent",defaultInit:{bubbles:!0,cancelable:!1}},transitionStart:{EventType:"TransitionEvent",defaultInit:{bubbles:!0,cancelable:!1}},pointerOver:{EventType:"PointerEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},pointerEnter:{EventType:"PointerEvent",defaultInit:{bubbles:!1,cancelable:!1}},pointerDown:{EventType:"PointerEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},pointerMove:{EventType:"PointerEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},pointerUp:{EventType:"PointerEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},pointerCancel:{EventType:"PointerEvent",defaultInit:{bubbles:!0,cancelable:!1,composed:!0}},pointerOut:{EventType:"PointerEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},pointerLeave:{EventType:"PointerEvent",defaultInit:{bubbles:!1,cancelable:!1}},gotPointerCapture:{EventType:"PointerEvent",defaultInit:{bubbles:!0,cancelable:!1,composed:!0}},lostPointerCapture:{EventType:"PointerEvent",defaultInit:{bubbles:!0,cancelable:!1,composed:!0}},popState:{EventType:"PopStateEvent",defaultInit:{bubbles:!0,cancelable:!1}},offline:{EventType:"Event",defaultInit:{bubbles:!1,cancelable:!1}},online:{EventType:"Event",defaultInit:{bubbles:!1,cancelable:!1}},pageHide:{EventType:"PageTransitionEvent",defaultInit:{bubbles:!0,cancelable:!0}},pageShow:{EventType:"PageTransitionEvent",defaultInit:{bubbles:!0,cancelable:!0}}},dlt={doubleClick:"dblClick"};Object.keys(flt).forEach(t=>{t.toLowerCase()});Object.keys(dlt).forEach(t=>{});function plt(t){return t.replace(/[ \t]*[\n][ \t]*/g,`
`)}function mlt(t){return oot.compressToEncodedURIComponent(plt(t))}function glt(t){return"https://testing-playground.com/#markup="+mlt(t)}const vlt=(t,e,n)=>Array.isArray(t)?t.forEach(i=>xre(i,e,n)):xre(t,e,n),_lt=function(t){if(t===void 0&&(t=vX().body),!t||!("innerHTML"in t)){console.log("The element you're providing isn't a valid DOM element.");return}if(!t.innerHTML){console.log("The provided element doesn't have any children.");return}const e=glt(t.innerHTML);return console.log(`Open this URL in your browser

`+e),e},Are={debug:vlt,logTestingPlaygroundURL:_lt};typeof document<"u"&&document.body?hlt(document.body,Xq,Are):Object.keys(Xq).reduce((t,e)=>(t[e]=()=>{throw new TypeError("For queries bound to document.body a global document has to be available... Learn more: https://testing-library.com/s/screen-global-error")},t),Are);function iA(t,e){return os().eventWrapper(t)}function rE(t){const e=VXe(t,oX),n=ik(t.ownerDocument);(e??t.ownerDocument.body)!==n&&(iA(e?()=>e.focus():()=>n==null?void 0:n.blur()),$Xe(e??t.ownerDocument.body))}function ylt(t){!oX(t)||!(ik(t.ownerDocument)===t)||iA(()=>t.blur())}const sE={};sE.click=(t,e,n)=>{const i=e.closest("button,input,label,select,textarea"),r=i&&gr(i,"label")&&i.control;if(r&&r!==e)return()=>{oX(r)&&(rE(r),n.dispatchEvent(r,jXe(t)))};if(gr(e,"input",{type:"file"}))return()=>{ylt(e),e.dispatchEvent(new(Ap(e)).Event("fileDialog")),rE(e)}};const rA=Symbol("Displayed value in UI"),s_=Symbol("Displayed selection in UI"),R3=Symbol("Initial value to compare on blur");function blt(t){return typeof t=="object"&&rA in t}function Elt(t){return!!t&&typeof t=="object"&&s_ in t}function Slt(t,e){t[R3]===void 0&&(t[R3]=t.value),t[rA]=e,t.value=Object.assign(new String(e),{[rA]:!0})}function S0(t){return t[rA]===void 0?t.value:String(t[rA])}function EX(t){t[rA]=void 0}function nye(t){t[R3]=void 0}function Tlt(t){return t[R3]}function xlt(t,e){t[s_]=e}function GA(t,{focusOffset:e,anchorOffset:n=e},i="replace"){const r=S0(t).length,s=h=>Math.max(0,Math.min(r,h)),a=i==="replace"||t[s_]===void 0?s(n):t[s_].anchorOffset,o=s(e),c=Math.min(a,o),l=Math.max(a,o);if(t[s_]={anchorOffset:a,focusOffset:o},t.selectionStart===c&&t.selectionEnd===l)return;const u=Object.assign(new Number(c),{[s_]:!0});try{t.setSelectionRange(u,l)}catch{}}function CN(t){var e,n,i;const r=(i=t[s_])!==null&&i!==void 0?i:{anchorOffset:(e=t.selectionStart)!==null&&e!==void 0?e:0,focusOffset:(n=t.selectionEnd)!==null&&n!==void 0?n:0};return{...r,startOffset:Math.min(r.anchorOffset,r.focusOffset),endOffset:Math.max(r.anchorOffset,r.focusOffset)}}function wlt(t){return!!t[s_]}function P2(t){t[s_]=void 0}const M3=globalThis.parseInt;function Clt(t){const e=t.replace(/\D/g,"");if(e.length<2)return t;const n=M3(e[0],10),i=M3(e[1],10);if(n>=3||n===2&&i>=4){let r;return n>=3?r=1:r=2,Rre(e,r)}return t.length===2?t:Rre(e,2)}function Rre(t,e){const n=t.slice(0,e),i=Math.min(M3(n,10),23),r=t.slice(e),s=M3(r,10),a=Math.min(s,59);return`${i.toString().padStart(2,"0")}:${a.toString().padStart(2,"0")}`}function iye(t,e){const n=t.cloneNode();return n.value=e,n.value===e}var rye=function(t){return t.email="email",t.password="password",t.search="search",t.telephone="telephone",t.text="text",t.url="url",t}(rye||{});function Alt(t){var e;const n=(e=t.getAttribute("maxlength"))!==null&&e!==void 0?e:"";return/^\d+$/.test(n)&&Number(n)>=0?Number(n):void 0}function Rlt(t){return gr(t,"textarea")||gr(t,"input")&&t.type in rye}function sye(t,e,n,i){if(L2(t)&&e+n>=0&&e+n<=t.nodeValue.length)return{node:t,offset:e+n};const r=Mre(t,e,n);if(r){if(L2(r))return{node:r,offset:n>0?Math.min(1,r.nodeValue.length):Math.max(r.nodeValue.length-1,0)};if(gr(r,"br")){const s=Mre(r,void 0,n);return s?L2(s)?{node:s,offset:n>0?0:s.nodeValue.length}:n<0&&gr(s,"br")?{node:r.parentNode,offset:IP(r)}:{node:s.parentNode,offset:IP(s)+(n>0?0:1)}:n<0&&i==="deleteContentBackward"?{node:r.parentNode,offset:IP(r)}:void 0}else return{node:r.parentNode,offset:IP(r)+(n>0?1:0)}}}function Mre(t,e,n){const i=Number(e)+(n<0?-1:0);return e!==void 0&&SX(t)&&i>=0&&i<t.children.length&&(t=t.children[i]),Olt(t,n===1?"next":"previous",Mlt)}function Mlt(t){if(L2(t))return!0;if(SX(t)){if(gr(t,["input","textarea"]))return t.type!=="hidden";if(gr(t,"br"))return!0}return!1}function IP(t){let e=0;for(;t.previousSibling;)e++,t=t.previousSibling;return e}function SX(t){return t.nodeType===1}function L2(t){return t.nodeType===3}function Olt(t,e,n){for(;;){var i;const r=t[`${e}Sibling`];if(r){if(t=Nlt(r,e==="next"?"first":"last"),n(t))return t}else if(t.parentNode&&(!SX(t.parentNode)||!i1(t.parentNode)&&t.parentNode!==((i=t.ownerDocument)===null||i===void 0?void 0:i.body)))t=t.parentNode;else break}}function Nlt(t,e){for(;t.hasChildNodes();)t=t[`${e}Child`];return t}const AN=Symbol("Track programmatic changes for React workaround");function Ilt(t){return Object.getOwnPropertyNames(t).some(e=>e.startsWith("__react"))&&Ap(t).REACT_VERSION===17}function klt(t){Ilt(t)&&(t[AN]={previousValue:String(t.value),tracked:[]})}function Dlt(t,e){var n,i;(i=t[AN])===null||i===void 0||(n=i.tracked)===null||n===void 0||n.push(e),t[AN]||(EX(t),GA(t,{focusOffset:e.length}))}function Plt(t,e){var n;const i=t[AN];if(t[AN]=void 0,!(!(i==null||(n=i.tracked)===null||n===void 0)&&n.length))return;const r=i.tracked.length===2&&i.tracked[0]===i.previousValue&&i.tracked[1]===t.value;r||EX(t),wlt(t)&&GA(t,{focusOffset:r?e:t.value.length})}function aye(t){const e=Llt(t);if(e&&E0(e))return{type:"input",selection:CN(e)};const n=e==null?void 0:e.ownerDocument.getSelection();return{type:bN(t)&&(n==null?void 0:n.anchorNode)&&bN(n.anchorNode)?"contenteditable":"default",selection:n}}function Llt(t){return t.nodeType===1?t:t.parentElement}function Ult(t){const e=aye(t);if(e.type==="input")return e.selection;if(e.type==="contenteditable"){var n;return(n=e.selection)===null||n===void 0?void 0:n.getRangeAt(0)}}function s1({focusNode:t,focusOffset:e,anchorNode:n=t,anchorOffset:i=e}){var r,s;if(aye(t).type==="input")return GA(t,{anchorOffset:i,focusOffset:e});(s=n.ownerDocument)===null||s===void 0||(r=s.getSelection())===null||r===void 0||r.setBaseAndExtent(n,i,t,e)}function oye(t){return gr(t,"input")&&["date","time"].includes(t.type)}function sA(t,e,n,i="insertText"){const r=Ult(e);r&&(!oye(e)&&!t.dispatchUIEvent(e,"beforeinput",{inputType:i,data:n})||("startContainer"in r?Blt(t,e,r,n,i):Flt(t,e,r,n,i)))}function Blt(t,e,n,i,r){let s=!1;if(!n.collapsed)s=!0,n.deleteContents();else if(["deleteContentBackward","deleteContentForward"].includes(r)){const a=sye(n.startContainer,n.startOffset,r==="deleteContentBackward"?-1:1,r);if(a){s=!0;const o=n.cloneRange();o.comparePoint(a.node,a.offset)<0?o.setStart(a.node,a.offset):o.setEnd(a.node,a.offset),o.deleteContents()}}if(i)if(n.endContainer.nodeType===3){const a=n.endOffset;n.endContainer.insertData(a,i),n.setStart(n.endContainer,a+i.length),n.setEnd(n.endContainer,a+i.length)}else{const a=e.ownerDocument.createTextNode(i);n.insertNode(a),n.setStart(a,i.length),n.setEnd(a,i.length)}(s||i)&&t.dispatchUIEvent(e,"input",{inputType:r})}function Flt(t,e,n,i,r){let s=i;if(Rlt(e)){const l=Alt(e);if(l!==void 0&&i.length>0){const u=l-e.value.length;if(u>0)s=i.substring(0,u);else return}}const{newValue:a,newOffset:o,oldValue:c}=zlt(s,e,n,r);a===c&&o===n.startOffset&&o===n.endOffset||gr(e,"input",{type:"number"})&&!Hlt(a)||(Slt(e,a),s1({focusNode:e,anchorOffset:o,focusOffset:o}),oye(e)?iye(e,a)&&(Ore(t,e,o,{}),t.dispatchUIEvent(e,"change"),nye(e)):Ore(t,e,o,{data:i,inputType:r}))}function zlt(t,e,{startOffset:n,endOffset:i},r){const s=S0(e),a=Math.max(0,n===i&&r==="deleteContentBackward"?n-1:n),o=s.substring(0,a),c=Math.min(s.length,n===i&&r==="deleteContentForward"?n+1:i),l=s.substring(c,s.length);let u=`${o}${t}${l}`,h=a+t.length;if(gr(e,"input",{type:"time"})){const f=Clt(u);f!==""&&iye(e,f)&&(u=f,h=f.length)}return{oldValue:s,newValue:u,newOffset:h}}function Ore(t,e,n,i){t.dispatchUIEvent(e,"input",i),Plt(e,n)}function Hlt(t){var e,n;const i=t.split("e",2);return!(/[^\d.\-e]/.test(t)||Number((e=t.match(/-/g))===null||e===void 0?void 0:e.length)>2||Number((n=t.match(/\./g))===null||n===void 0?void 0:n.length)>1||i[1]&&!/^-?\d*$/.test(i[1]))}sE.cut=(t,e,n)=>()=>{tA(e)&&sA(n,e,"","deleteByCut")};function jlt(t){return t?i1(t)?t.textContent:S0(t):null}function Vlt(t){const e=Ap(t);for(let n=t;n!=null&&n.ownerDocument;n=n.parentElement){const{display:i,visibility:r}=e.getComputedStyle(n);if(i==="none"||r==="hidden")return!1}return!0}function Glt(t,e){const n=t.ownerDocument,i=n.querySelectorAll(bve),r=Array.from(i).filter(c=>c===t||!(Number(c.getAttribute("tabindex"))<0||R_(c)));Number(t.getAttribute("tabindex"))>=0&&r.sort((c,l)=>{const u=Number(c.getAttribute("tabindex")),h=Number(l.getAttribute("tabindex"));return u===h?0:u===0?1:h===0?-1:u-h});const s={};let a=[n.body];const o=gr(t,"input",{type:"radio"})?t.name:void 0;r.forEach(c=>{const l=c;if(gr(l,"input",{type:"radio"})&&l.name){if(l===t){a.push(l);return}else if(l.name===o)return;if(l.checked){a=a.filter(u=>!gr(u,"input",{type:"radio",name:l.name})),a.push(l),s[l.name]=l;return}if(typeof s[l.name]<"u")return}a.push(l)});for(let c=a.findIndex(l=>l===t);;)if(c+=e?-1:1,c===a.length?c=0:c===-1&&(c=a.length-1),a[c]===t||a[c]===n.body||Vlt(a[c]))return a[c]}function Nre(t,e){if(E0(t)){const n=CN(t);s1({focusNode:t,focusOffset:n.startOffset===n.endOffset?n.focusOffset+e:e<0?n.startOffset:n.endOffset})}else{const n=t.ownerDocument.getSelection();if(!(n!=null&&n.focusNode))return;if(n.isCollapsed){const i=sye(n.focusNode,n.focusOffset,e);i&&s1({focusNode:i.node,focusOffset:i.offset})}else n[e<0?"collapseToStart":"collapseToEnd"]()}}function cye(t){if(E0(t))return s1({focusNode:t,anchorOffset:0,focusOffset:S0(t).length});var e;const n=(e=bN(t))!==null&&e!==void 0?e:t.ownerDocument.body;s1({focusNode:n,anchorOffset:0,focusOffset:n.childNodes.length})}function qlt(t){if(E0(t))return CN(t).startOffset===0&&CN(t).endOffset===S0(t).length;var e;const n=(e=bN(t))!==null&&e!==void 0?e:t.ownerDocument.body,i=t.ownerDocument.getSelection();return(i==null?void 0:i.anchorNode)===n&&i.focusNode===n&&i.anchorOffset===0&&i.focusOffset===n.childNodes.length}function fM(t,e,n){var i;if(E0(t))return s1({focusNode:t,anchorOffset:e,focusOffset:n});if(i1(t)&&((i=t.firstChild)===null||i===void 0?void 0:i.nodeType)===3)return s1({focusNode:t.firstChild,anchorOffset:e,focusOffset:n});throw new Error("Not implemented. The result of this interaction is unreliable.")}function kP(t,e,n){const i=Ap(e),r=Array.from(e.ownerDocument.querySelectorAll(e.name?`input[type="radio"][name="${i.CSS.escape(e.name)}"]`:'input[type="radio"][name=""], input[type="radio"]:not([name])'));for(let s=r.findIndex(a=>a===e)+n;;s+=n){if(r[s]||(s=n>0?0:r.length-1),r[s]===e)return;if(!R_(r[s])){rE(r[s]),t.dispatchUIEvent(r[s],"click");return}}}sE.keydown=(t,e,n)=>{var i,r;return(r=(i=Ire[t.key])===null||i===void 0?void 0:i.call(Ire,t,e,n))!==null&&r!==void 0?r:$lt(t,e,n)};const Ire={ArrowDown:(t,e,n)=>{if(gr(e,"input",{type:"radio"}))return()=>kP(n,e,1)},ArrowLeft:(t,e,n)=>gr(e,"input",{type:"radio"})?()=>kP(n,e,-1):()=>Nre(e,-1),ArrowRight:(t,e,n)=>gr(e,"input",{type:"radio"})?()=>kP(n,e,1):()=>Nre(e,1),ArrowUp:(t,e,n)=>{if(gr(e,"input",{type:"radio"}))return()=>kP(n,e,-1)},Backspace:(t,e,n)=>{if(tA(e))return()=>{sA(n,e,"","deleteContentBackward")}},Delete:(t,e,n)=>{if(tA(e))return()=>{sA(n,e,"","deleteContentForward")}},End:(t,e)=>{if(gr(e,["input","textarea"])||i1(e))return()=>{var n,i;const r=(i=(n=jlt(e))===null||n===void 0?void 0:n.length)!==null&&i!==void 0?i:0;fM(e,r,r)}},Home:(t,e)=>{if(gr(e,["input","textarea"])||i1(e))return()=>{fM(e,0,0)}},PageDown:(t,e)=>{if(gr(e,["input"]))return()=>{const n=S0(e).length;fM(e,n,n)}},PageUp:(t,e)=>{if(gr(e,["input"]))return()=>{fM(e,0,0)}},Tab:(t,e,n)=>()=>{const i=Glt(e,n.system.keyboard.modifiers.Shift);rE(i),E0(i)&&GA(i,{anchorOffset:0,focusOffset:i.value.length})}},$lt=(t,e,n)=>{if(t.code==="KeyA"&&n.system.keyboard.modifiers.Control)return()=>cye(e)};sE.keypress=(t,e,n)=>{if(t.key==="Enter"){if(gr(e,"button")||gr(e,"input")&&Wlt.includes(e.type)||gr(e,"a")&&e.href)return()=>{n.dispatchUIEvent(e,"click")};if(gr(e,"input")){const i=e.form,r=i==null?void 0:i.querySelector('input[type="submit"], button:not([type]), button[type="submit"]');return r?()=>n.dispatchUIEvent(r,"click"):i&&Ylt.includes(e.type)&&i.querySelectorAll("input").length===1?()=>n.dispatchUIEvent(i,"submit"):void 0}}if(tA(e)){const i=t.key==="Enter"?i1(e)&&!n.system.keyboard.modifiers.Shift?"insertParagraph":"insertLineBreak":"insertText",r=t.key==="Enter"?`
`:t.key;return()=>sA(n,e,r,i)}};const Wlt=["button","color","file","image","reset","submit"],Ylt=["email","month","password","search","tel","text","url","week"];sE.keyup=(t,e,n)=>{var i;return(i=kre[t.key])===null||i===void 0?void 0:i.call(kre,t,e,n)};const kre={" ":(t,e,n)=>{if(Sve(e))return()=>n.dispatchUIEvent(e,"click")}};sE.paste=(t,e,n)=>{if(tA(e))return()=>{var i;const r=(i=t.clipboardData)===null||i===void 0?void 0:i.getData("text");r&&sA(n,e,r,"insertFromPaste")}};const lye={auxclick:{EventType:"PointerEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},beforeinput:{EventType:"InputEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},blur:{EventType:"FocusEvent",defaultInit:{bubbles:!1,cancelable:!1,composed:!0}},click:{EventType:"PointerEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},contextmenu:{EventType:"PointerEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},copy:{EventType:"ClipboardEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},change:{EventType:"Event",defaultInit:{bubbles:!0,cancelable:!1}},cut:{EventType:"ClipboardEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},dblclick:{EventType:"MouseEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},focus:{EventType:"FocusEvent",defaultInit:{bubbles:!1,cancelable:!1,composed:!0}},focusin:{EventType:"FocusEvent",defaultInit:{bubbles:!0,cancelable:!1,composed:!0}},focusout:{EventType:"FocusEvent",defaultInit:{bubbles:!0,cancelable:!1,composed:!0}},keydown:{EventType:"KeyboardEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},keypress:{EventType:"KeyboardEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},keyup:{EventType:"KeyboardEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},paste:{EventType:"ClipboardEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},input:{EventType:"InputEvent",defaultInit:{bubbles:!0,cancelable:!1,composed:!0}},mousedown:{EventType:"MouseEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},mouseenter:{EventType:"MouseEvent",defaultInit:{bubbles:!1,cancelable:!1,composed:!0}},mouseleave:{EventType:"MouseEvent",defaultInit:{bubbles:!1,cancelable:!1,composed:!0}},mousemove:{EventType:"MouseEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},mouseout:{EventType:"MouseEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},mouseover:{EventType:"MouseEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},mouseup:{EventType:"MouseEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},pointerover:{EventType:"PointerEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},pointerenter:{EventType:"PointerEvent",defaultInit:{bubbles:!1,cancelable:!1}},pointerdown:{EventType:"PointerEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},pointermove:{EventType:"PointerEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},pointerup:{EventType:"PointerEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},pointercancel:{EventType:"PointerEvent",defaultInit:{bubbles:!0,cancelable:!1,composed:!0}},pointerout:{EventType:"PointerEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},pointerleave:{EventType:"PointerEvent",defaultInit:{bubbles:!1,cancelable:!1}},submit:{EventType:"Event",defaultInit:{bubbles:!0,cancelable:!0}}};function uye(t){return lye[t].EventType}const Xlt=["MouseEvent","PointerEvent"];function Klt(t){return Xlt.includes(uye(t))}function Zlt(t){return uye(t)==="KeyboardEvent"}const Jlt={ClipboardEvent:[eut],Event:[],FocusEvent:[VR,tut],InputEvent:[VR,nut],MouseEvent:[VR,_j,Dre],PointerEvent:[VR,_j,Dre,rut],KeyboardEvent:[VR,_j,iut]};function hye(t,e,n){const i=Ap(e),{EventType:r,defaultInit:s}=lye[t],a=new(Qlt(i))[r](t,s);return Jlt[r].forEach(o=>o(a,n??{})),a}function Qlt(t){var e;const n=(e=t.Event)!==null&&e!==void 0?e:class{};var i;const r=(i=t.AnimationEvent)!==null&&i!==void 0?i:class extends n{};var s;const a=(s=t.ClipboardEvent)!==null&&s!==void 0?s:class extends n{};var o;const c=(o=t.PopStateEvent)!==null&&o!==void 0?o:class extends n{};var l;const u=(l=t.ProgressEvent)!==null&&l!==void 0?l:class extends n{};var h;const f=(h=t.TransitionEvent)!==null&&h!==void 0?h:class extends n{};var d;const p=(d=t.UIEvent)!==null&&d!==void 0?d:class extends n{};var g;const y=(g=t.CompositionEvent)!==null&&g!==void 0?g:class extends p{};var v;const b=(v=t.FocusEvent)!==null&&v!==void 0?v:class extends p{};var T;const x=(T=t.InputEvent)!==null&&T!==void 0?T:class extends p{};var M;const R=(M=t.KeyboardEvent)!==null&&M!==void 0?M:class extends p{};var I;const k=(I=t.MouseEvent)!==null&&I!==void 0?I:class extends p{};var P;const U=(P=t.DragEvent)!==null&&P!==void 0?P:class extends k{};var G;const $=(G=t.PointerEvent)!==null&&G!==void 0?G:class extends k{};var q;const Y=(q=t.TouchEvent)!==null&&q!==void 0?q:class extends p{};return{Event:n,AnimationEvent:r,ClipboardEvent:a,PopStateEvent:c,ProgressEvent:u,TransitionEvent:f,UIEvent:p,CompositionEvent:y,FocusEvent:b,InputEvent:x,KeyboardEvent:R,MouseEvent:k,DragEvent:U,PointerEvent:$,TouchEvent:Y}}function RE(t,e){for(const[n,i]of Object.entries(e))Object.defineProperty(t,n,{get:()=>i??null})}function vo(t){return Number(t??0)}function eut(t,{clipboardData:e}){RE(t,{clipboardData:e})}function tut(t,{relatedTarget:e}){RE(t,{relatedTarget:e})}function nut(t,{data:e,inputType:n,isComposing:i}){RE(t,{data:e,isComposing:!!i,inputType:String(n)})}function VR(t,{view:e,detail:n}){RE(t,{view:e,detail:vo(n??0)})}function _j(t,{altKey:e,ctrlKey:n,metaKey:i,shiftKey:r,modifierAltGraph:s,modifierCapsLock:a,modifierFn:o,modifierFnLock:c,modifierNumLock:l,modifierScrollLock:u,modifierSymbol:h,modifierSymbolLock:f}){RE(t,{altKey:!!e,ctrlKey:!!n,metaKey:!!i,shiftKey:!!r,getModifierState(d){return!!{Alt:e,AltGraph:s,CapsLock:a,Control:n,Fn:o,FnLock:c,Meta:i,NumLock:l,ScrollLock:u,Shift:r,Symbol:h,SymbolLock:f}[d]}})}function iut(t,{key:e,code:n,location:i,repeat:r,isComposing:s,charCode:a}){RE(t,{key:String(e),code:String(n),location:vo(i),repeat:!!r,isComposing:!!s,charCode:a})}function Dre(t,{x:e,y:n,screenX:i,screenY:r,clientX:s=e,clientY:a=n,button:o,buttons:c,relatedTarget:l,offsetX:u,offsetY:h,pageX:f,pageY:d}){RE(t,{screenX:vo(i),screenY:vo(r),clientX:vo(s),x:vo(s),clientY:vo(a),y:vo(a),button:vo(o),buttons:vo(c),relatedTarget:l,offsetX:vo(u),offsetY:vo(h),pageX:vo(f),pageY:vo(d)})}function rut(t,{pointerId:e,width:n,height:i,pressure:r,tangentialPressure:s,tiltX:a,tiltY:o,twist:c,pointerType:l,isPrimary:u}){RE(t,{pointerId:vo(e),width:vo(n??1),height:vo(i??1),pressure:vo(r),tangentialPressure:vo(s),tiltX:vo(a),tiltY:vo(o),twist:vo(c),pointerType:String(l),isPrimary:!!u})}function sut(t,e,n,i=!1){(Klt(e)||Zlt(e))&&(n={...n,...this.system.getUIEventModifiers()});const r=hye(e,t,n);return fye.call(this,t,r,i)}function fye(t,e,n=!1){var i;const r=e.type,s=n?()=>{}:(i=sE[r])===null||i===void 0?void 0:i.call(sE,e,t,this);if(s){e.preventDefault();let a=!1;return Object.defineProperty(e,"defaultPrevented",{get:()=>a}),Object.defineProperty(e,"preventDefault",{value:()=>{a=e.cancelable}}),iA(()=>t.dispatchEvent(e)),a||s(),!a}return iA(()=>t.dispatchEvent(e))}function ZS(t,e,n){const i=hye(e,t,n);iA(()=>t.dispatchEvent(i))}const Pre=Symbol("patched focus/blur methods");function dye(t){if(t.prototype[Pre])return;const{focus:e,blur:n}=t.prototype;Object.defineProperties(t.prototype,{focus:{configurable:!0,get:()=>r},blur:{configurable:!0,get:()=>s},[Pre]:{configurable:!0,get:()=>({focus:e,blur:n})}});let i;function r(a){if(this.ownerDocument.visibilityState!=="hidden")return e.call(this,a);const o=Lre(this.ownerDocument);if(o===this)return;const c=Symbol("focus call");i=c,o&&(n.call(o),ZS(o,"blur",{relatedTarget:this}),ZS(o,"focusout",{relatedTarget:i===c?this:null})),i===c&&(e.call(this,a),ZS(this,"focus",{relatedTarget:o})),i===c&&ZS(this,"focusin",{relatedTarget:o})}function s(){if(this.ownerDocument.visibilityState!=="hidden")return n.call(this);const a=Lre(this.ownerDocument);if(a!==this)return;i=Symbol("blur call"),n.call(this),ZS(a,"blur",{relatedTarget:null}),ZS(a,"focusout",{relatedTarget:null})}}function Lre(t){const e=ik(t);return(e==null?void 0:e.tagName)==="BODY"?null:e}const yj=Symbol("Interceptor for programmatical calls");function kw(t,e,n){const i=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),r=Object.getOwnPropertyDescriptor(t,e),s=i!=null&&i.set?"set":"value";if(typeof(i==null?void 0:i[s])!="function"||i[s][yj])throw new Error(`Element ${t.tagName} does not implement "${String(e)}".`);function a(...o){const{applyNative:c=!1,realArgs:l,then:u}=n.call(this,...o),h=(!c&&r||i)[s];s==="set"?h.call(this,l):h.call(this,...l),u==null||u()}a[yj]=yj,Object.defineProperty(t,e,{...r??i,[s]:a})}function aut(t){kw(t,"value",function(n){const i=blt(n);return i&&klt(this),{applyNative:!!i,realArgs:out(this,n),then:i?void 0:()=>Dlt(this,String(n))}})}function out(t,e){return gr(t,"input",{type:"number"})&&String(e)!==""&&!Number.isNaN(Number(e))?String(Number(e)):String(e)}function cut(t){kw(t,"setSelectionRange",function(n,...i){const r=Elt(n);return{applyNative:!!r,realArgs:[Number(n),...i],then:()=>r?void 0:P2(t)}}),kw(t,"selectionStart",function(n){return{realArgs:n,then:()=>P2(t)}}),kw(t,"selectionEnd",function(n){return{realArgs:n,then:()=>P2(t)}}),kw(t,"select",function(){return{realArgs:[],then:()=>xlt(t,{anchorOffset:0,focusOffset:S0(t).length})}})}function lut(t){kw(t,"setRangeText",function(...n){return{realArgs:n,then:()=>{EX(t),P2(t)}}})}const oC=Symbol("Node prepared with document state workarounds");function pye(t){t[oC]||(t.addEventListener("focus",e=>{const n=e.target;Ure(n)},{capture:!0,passive:!0}),t.activeElement&&Ure(t.activeElement),t.addEventListener("blur",e=>{const n=e.target,i=Tlt(n);i!==void 0&&(n.value!==i&&ZS(n,"change"),nye(n))},{capture:!0,passive:!0}),t[oC]=oC)}function Ure(t){t[oC]||(gr(t,["input","textarea"])&&(aut(t),cut(t),lut(t)),t[oC]=oC)}function uut(t){return hut(t)?t:t.ownerDocument}function hut(t){return t.nodeType===9}var Vf=function(t){return t[t.Trigger=2]="Trigger",t[t.Call=1]="Call",t}({});function dM(t,e){t.levelRefs[e]={}}function DP(t,e){return t.levelRefs[e]}function aA(t){const e=t.delay;if(typeof e=="number")return Promise.all([new Promise(n=>globalThis.setTimeout(()=>n(),e)),t.advanceTimers(e)])}var U2=function(t){return t[t.EachTrigger=4]="EachTrigger",t[t.EachApiCall=2]="EachApiCall",t[t.EachTarget=1]="EachTarget",t[t.Never=0]="Never",t}({});function DS(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var dg=function(t){return t[t.STANDARD=0]="STANDARD",t[t.LEFT=1]="LEFT",t[t.RIGHT=2]="RIGHT",t[t.NUMPAD=3]="NUMPAD",t}({});const fut=["Alt","AltGraph","Control","Fn","Meta","Shift","Symbol"];function Bre(t){return fut.includes(t)}const dut=["CapsLock","FnLock","NumLock","ScrollLock","SymbolLock"];function Fre(t){return dut.includes(t)}class put{isKeyPressed(e){return this.pressed.has(String(e.code))}getPressedKeys(){return this.pressed.values().map(e=>e.keyDef)}async keydown(e,n){const i=String(n.key),r=String(n.code),s=J5(e.config.document);this.setKeydownTarget(s),this.pressed.add(r,n),Bre(i)&&(this.modifiers[i]=!0);const a=e.dispatchUIEvent(s,"keydown",{key:i,code:r});Fre(i)&&!this.modifiers[i]&&(this.modifiers[i]=!0,this.modifierLockStart[i]=!0),a&&this.pressed.setUnprevented(r),a&&this.hasKeyPress(i)&&e.dispatchUIEvent(J5(e.config.document),"keypress",{key:i,code:r,charCode:n.key==="Enter"?13:String(n.key).charCodeAt(0)})}async keyup(e,n){const i=String(n.key),r=String(n.code),s=this.pressed.isUnprevented(r);this.pressed.delete(r),Bre(i)&&!this.pressed.values().find(a=>a.keyDef.key===i)&&(this.modifiers[i]=!1),e.dispatchUIEvent(J5(e.config.document),"keyup",{key:i,code:r},!s),Fre(i)&&this.modifiers[i]&&(this.modifierLockStart[i]?this.modifierLockStart[i]=!1:this.modifiers[i]=!1)}setKeydownTarget(e){e!==this.lastKeydownTarget&&(this.carryChar=""),this.lastKeydownTarget=e}hasKeyPress(e){return(e.length===1||e==="Enter")&&!this.modifiers.Control&&!this.modifiers.Alt}constructor(e){DS(this,"system",void 0),DS(this,"modifiers",{Alt:!1,AltGraph:!1,CapsLock:!1,Control:!1,Fn:!1,FnLock:!1,Meta:!1,NumLock:!1,ScrollLock:!1,Shift:!1,Symbol:!1,SymbolLock:!1}),DS(this,"pressed",new class{add(n,i){var r,s,a;(a=(r=this.registry)[s=n])!==null&&a!==void 0||(r[s]={keyDef:i,unpreventedDefault:!1})}has(n){return!!this.registry[n]}setUnprevented(n){const i=this.registry[n];i&&(i.unpreventedDefault=!0)}isUnprevented(n){var i;return!!(!((i=this.registry[n])===null||i===void 0)&&i.unpreventedDefault)}delete(n){delete this.registry[n]}values(){return Object.values(this.registry)}constructor(){DS(this,"registry",{})}}),DS(this,"carryChar",""),DS(this,"lastKeydownTarget",void 0),DS(this,"modifierLockStart",{}),this.system=e}}const mut=[..."0123456789".split("").map(t=>({code:`Digit${t}`,key:t})),...")!@#$%^&*(".split("").map((t,e)=>({code:`Digit${e}`,key:t,shiftKey:!0})),..."abcdefghijklmnopqrstuvwxyz".split("").map(t=>({code:`Key${t.toUpperCase()}`,key:t})),..."ABCDEFGHIJKLMNOPQRSTUVWXYZ".split("").map(t=>({code:`Key${t}`,key:t,shiftKey:!0})),{code:"BracketLeft",key:"["},{code:"BracketLeft",key:"{",shiftKey:!0},{code:"BracketRight",key:"]"},{code:"BracketRight",key:"}",shiftKey:!0},{code:"Space",key:" "},{code:"AltLeft",key:"Alt",location:dg.LEFT},{code:"AltRight",key:"Alt",location:dg.RIGHT},{code:"ShiftLeft",key:"Shift",location:dg.LEFT},{code:"ShiftRight",key:"Shift",location:dg.RIGHT},{code:"ControlLeft",key:"Control",location:dg.LEFT},{code:"ControlRight",key:"Control",location:dg.RIGHT},{code:"MetaLeft",key:"Meta",location:dg.LEFT},{code:"MetaRight",key:"Meta",location:dg.RIGHT},{code:"OSLeft",key:"OS",location:dg.LEFT},{code:"OSRight",key:"OS",location:dg.RIGHT},{code:"ContextMenu",key:"ContextMenu"},{code:"Tab",key:"Tab"},{code:"CapsLock",key:"CapsLock"},{code:"Backspace",key:"Backspace"},{code:"Enter",key:"Enter"},{code:"Escape",key:"Escape"},{code:"ArrowUp",key:"ArrowUp"},{code:"ArrowDown",key:"ArrowDown"},{code:"ArrowLeft",key:"ArrowLeft"},{code:"ArrowRight",key:"ArrowRight"},{code:"Home",key:"Home"},{code:"End",key:"End"},{code:"Delete",key:"Delete"},{code:"PageUp",key:"PageUp"},{code:"PageDown",key:"PageDown"},{code:"Fn",key:"Fn"},{code:"Symbol",key:"Symbol"},{code:"AltRight",key:"AltGraph"}],gut=[{name:"MouseLeft",pointerType:"mouse",button:"primary"},{name:"MouseRight",pointerType:"mouse",button:"secondary"},{name:"MouseMiddle",pointerType:"mouse",button:"auxiliary"},{name:"TouchA",pointerType:"touch"},{name:"TouchB",pointerType:"touch"},{name:"TouchC",pointerType:"touch"}];function vut(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}class mye{getButtons(){let e=0;for(const n of Object.keys(this.pressed))e|=2**Number(n);return e}down(e){const n=Kq(e.button);if(n in this.pressed){this.pressed[n].push(e);return}return this.pressed[n]=[e],n}up(e){const n=Kq(e.button);if(n in this.pressed&&(this.pressed[n]=this.pressed[n].filter(i=>i.name!==e.name),this.pressed[n].length===0))return delete this.pressed[n],n}constructor(){vut(this,"pressed",{})}}const zre={primary:0,secondary:1,auxiliary:2,back:3,X1:3,forward:4,X2:4};function Kq(t=0){return t in zre?zre[t]:Number(t)}const Hre={1:2,2:1};function Zq(t){return t=Kq(t),t in Hre?Hre[t]:t}function _ut(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}class yut{get countPressed(){return this.pressedKeys.size}isPressed(e){return this.pressedKeys.has(e.name)}addPressed(e){return this.pressedKeys.add(e.name)}removePressed(e){return this.pressedKeys.delete(e.name)}constructor(){_ut(this,"pressedKeys",new Set)}}function JM(t,e){const n=[];for(let s=t;s;s=s.parentElement)n.push(s);const i=[];for(let s=e;s;s=s.parentElement)i.push(s);let r=0;for(;!(r>=n.length||r>=i.length||n[n.length-1-r]!==i[i.length-1-r]);r++);return[n.slice(0,n.length-r),i.slice(0,i.length-r),i.slice(i.length-r)]}function Jq({target:t,node:e,offset:n}){return E0(t)?{node:t,offset:n??S0(t).length}:e?{node:e,offset:n??(e.nodeType===3?e.nodeValue.length:e.childNodes.length)}:gye(t,n)}function gye(t,e,n=!0){let i=e===void 0?t.childNodes.length-1:0;const r=e===void 0?-1:1;for(;e===void 0?i>=(n?Math.max(t.childNodes.length-1,0):0):i<=t.childNodes.length;){if(e&&i===t.childNodes.length)throw new Error("The given offset is out of bounds.");const s=t.childNodes.item(i),a=String(s.textContent);if(a.length)if(e!==void 0&&a.length<e)e-=a.length;else{if(s.nodeType===1)return gye(s,e,!1);if(s.nodeType===3)return{node:s,offset:e??s.nodeValue.length}}i+=r}return{node:t,offset:t.childNodes.length}}function but({document:t,target:e,clickCount:n,node:i,offset:r}){if(qXe(e))return;const s=E0(e),a=String(s?S0(e):e.textContent),[o,c]=i?[r,r]:Eut(a,r,n);if(s)return GA(e,{anchorOffset:o??a.length,focusOffset:c??a.length}),{node:e,start:o??0,end:c??a.length};{const{node:l,offset:u}=Jq({target:e,node:i,offset:o}),{node:h,offset:f}=Jq({target:e,node:i,offset:c}),d=e.ownerDocument.createRange();try{d.setStart(l,u),d.setEnd(h,f)}catch{throw new Error("The given offset is out of bounds.")}const p=t.getSelection();return p==null||p.removeAllRanges(),p==null||p.addRange(d.cloneRange()),d}}function Eut(t,e,n){if(n%3===1||t.length===0)return[e,e];const i=e??t.length;return n%3===2?[i-t.substr(0,e).match(/(\w+|\s+|\W)?$/)[0].length,e===void 0?e:e+t.substr(e).match(/^(\w+|\s+|\W)?/)[0].length]:[i-t.substr(0,e).match(/[^\r\n]*$/)[0].length,e===void 0?e:e+t.substr(e).match(/^[^\r\n]*/)[0].length]}function Sut(t,{document:e,target:n,node:i,offset:r}){const s=Jq({target:n,node:i,offset:r});if("node"in t){if(s.node===t.node){const a=s.offset<t.start?t.end:t.start,o=s.offset>t.end||s.offset<t.start?s.offset:t.end;GA(t.node,{anchorOffset:a,focusOffset:o})}}else{const a=t.cloneRange(),o=a.comparePoint(s.node,s.offset);o<0?a.setStart(s.node,s.offset):o>0&&a.setEnd(s.node,s.offset);const c=e.getSelection();c==null||c.removeAllRanges(),c==null||c.addRange(a.cloneRange())}}function vye(t,e){var n,i,r,s,a,o,c,l,u,h,f,d,p,g,y,v,b,T,x,M,R,I,k,P;return t.target!==e.target||((n=t.coords)===null||n===void 0?void 0:n.x)!==((i=e.coords)===null||i===void 0?void 0:i.x)||((r=t.coords)===null||r===void 0?void 0:r.y)!==((s=e.coords)===null||s===void 0?void 0:s.y)||((a=t.coords)===null||a===void 0?void 0:a.clientX)!==((o=e.coords)===null||o===void 0?void 0:o.clientX)||((c=t.coords)===null||c===void 0?void 0:c.clientY)!==((l=e.coords)===null||l===void 0?void 0:l.clientY)||((u=t.coords)===null||u===void 0?void 0:u.offsetX)!==((h=e.coords)===null||h===void 0?void 0:h.offsetX)||((f=t.coords)===null||f===void 0?void 0:f.offsetY)!==((d=e.coords)===null||d===void 0?void 0:d.offsetY)||((p=t.coords)===null||p===void 0?void 0:p.pageX)!==((g=e.coords)===null||g===void 0?void 0:g.pageX)||((y=t.coords)===null||y===void 0?void 0:y.pageY)!==((v=e.coords)===null||v===void 0?void 0:v.pageY)||((b=t.coords)===null||b===void 0?void 0:b.screenX)!==((T=e.coords)===null||T===void 0?void 0:T.screenX)||((x=t.coords)===null||x===void 0?void 0:x.screenY)!==((M=e.coords)===null||M===void 0?void 0:M.screenY)||((R=t.caret)===null||R===void 0?void 0:R.node)!==((I=e.caret)===null||I===void 0?void 0:I.node)||((k=t.caret)===null||k===void 0?void 0:k.offset)!==((P=e.caret)===null||P===void 0?void 0:P.offset)}function PS(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}class Tut{move(e,n,i){const r=this.position,s=this.getTarget(e);if(this.position=n,!vye(r,n))return;const a=this.getTarget(e),o=this.getEventInit("mousemove"),[c,l]=JM(s,a);return{leave:()=>{s!==a&&(e.dispatchUIEvent(s,"mouseout",o),c.forEach(u=>e.dispatchUIEvent(u,"mouseleave",o)))},enter:()=>{s!==a&&(e.dispatchUIEvent(a,"mouseover",o),l.forEach(u=>e.dispatchUIEvent(u,"mouseenter",o)))},move:()=>{i||(e.dispatchUIEvent(a,"mousemove",o),this.modifySelecting(e))}}}down(e,n,i){const r=this.buttons.down(n);if(r===void 0)return;const s=this.getTarget(e);this.buttonDownTarget[r]=s;const a=this.getEventInit("mousedown",n.button),o=R_(s);!i&&(o||e.dispatchUIEvent(s,"mousedown",a))&&(this.startSelecting(e,a.detail),rE(s)),!o&&Zq(n.button)===2&&e.dispatchUIEvent(s,"contextmenu",this.getEventInit("contextmenu",n.button))}up(e,n,i){const r=this.buttons.up(n);if(r===void 0)return;const s=this.getTarget(e);if(!R_(s)){if(!i){const o=this.getEventInit("mouseup",n.button);e.dispatchUIEvent(s,"mouseup",o),this.endSelecting()}const a=JM(this.buttonDownTarget[r],s)[2][0];if(a){const o=this.getEventInit("click",n.button);o.detail&&(e.dispatchUIEvent(a,o.button===0?"click":"auxclick",o),o.button===0&&o.detail===2&&e.dispatchUIEvent(a,"dblclick",{...this.getEventInit("dblclick",n.button),detail:o.detail}))}}}resetClickCount(){this.clickCount.reset()}getEventInit(e,n){const i={...this.position.coords};return i.button=Zq(n),i.buttons=this.buttons.getButtons(),e==="mousedown"?i.detail=this.clickCount.getOnDown(i.button):e==="mouseup"?i.detail=this.clickCount.getOnUp(i.button):(e==="click"||e==="auxclick")&&(i.detail=this.clickCount.incOnClick(i.button)),i}getTarget(e){var n;return(n=this.position.target)!==null&&n!==void 0?n:e.config.document.body}startSelecting(e,n){var i,r;this.selecting=but({document:e.config.document,target:this.getTarget(e),node:(i=this.position.caret)===null||i===void 0?void 0:i.node,offset:(r=this.position.caret)===null||r===void 0?void 0:r.offset,clickCount:n})}modifySelecting(e){var n,i;this.selecting&&Sut(this.selecting,{document:e.config.document,target:this.getTarget(e),node:(n=this.position.caret)===null||n===void 0?void 0:n.node,offset:(i=this.position.caret)===null||i===void 0?void 0:i.offset})}endSelecting(){this.selecting=void 0}constructor(){PS(this,"position",{}),PS(this,"buttons",new mye),PS(this,"selecting",void 0),PS(this,"buttonDownTarget",{}),PS(this,"clickCount",new class{incOnClick(e){const n=this.down[e]===void 0?void 0:Number(this.down[e])+1;return this.count=this.count[e]===void 0?{}:{[e]:Number(this.count[e])+1},n}getOnDown(e){var n;this.down={[e]:(n=this.count[e])!==null&&n!==void 0?n:0};var i;return this.count={[e]:(i=this.count[e])!==null&&i!==void 0?i:0},Number(this.count[e])+1}getOnUp(e){return this.down[e]===void 0?void 0:Number(this.down[e])+1}reset(){this.count={}}constructor(){PS(this,"down",{}),PS(this,"count",{})}})}}function O3(t,e){var n;return((n=_ye(t,e))===null||n===void 0?void 0:n.pointerEvents)!=="none"}function xut(t){const e=Ap(t);for(let n=t,i=[];n!=null&&n.ownerDocument;n=n.parentElement){i.push(n);const r=e.getComputedStyle(n).pointerEvents;if(r&&!["inherit","unset"].includes(r))return{pointerEvents:r,tree:i}}}const jre=Symbol("Last check for pointer-events");function _ye(t,e){const n=e[jre];if(!(t.config.pointerEventsCheck!==U2.Never&&(!n||Vre(t.config.pointerEventsCheck,U2.EachApiCall)&&n[Vf.Call]!==DP(t,Vf.Call)||Vre(t.config.pointerEventsCheck,U2.EachTrigger)&&n[Vf.Trigger]!==DP(t,Vf.Trigger))))return n==null?void 0:n.result;const r=xut(e);return e[jre]={[Vf.Call]:DP(t,Vf.Call),[Vf.Trigger]:DP(t,Vf.Trigger),result:r},r}function pM(t,e){const n=_ye(t,e);if((n==null?void 0:n.pointerEvents)==="none")throw new Error([`Unable to perform pointer interaction as the element ${n.tree.length>1?"inherits":"has"} \`pointer-events: none\`:`,"",wut(n.tree)].join(`
`))}function wut(t){return t.reverse().map((e,n)=>["".padEnd(n),e.tagName,e.id&&`#${e.id}`,e.hasAttribute("data-testid")&&`(testId=${e.getAttribute("data-testid")})`,Cut(e),t.length>1&&n===0&&"  <-- This element declared `pointer-events: none`",t.length>1&&n===t.length-1&&"  <-- Asserted pointer events here"].filter(Boolean).join("")).join(`
`)}function Cut(t){var e;let n;if(t.hasAttribute("aria-label"))n=t.getAttribute("aria-label");else if(t.hasAttribute("aria-labelledby")){var i,r;n=(r=t.ownerDocument.getElementById(t.getAttribute("aria-labelledby")))===null||r===void 0||(i=r.textContent)===null||i===void 0?void 0:i.trim()}else if(gr(t,["button","input","meter","output","progress","select","textarea"])&&(!((e=t.labels)===null||e===void 0)&&e.length))n=Array.from(t.labels).map(a=>{var o;return(o=a.textContent)===null||o===void 0?void 0:o.trim()}).join("|");else if(gr(t,"button")){var s;n=(s=t.textContent)===null||s===void 0?void 0:s.trim()}return n=n==null?void 0:n.replace(/\n/g,"  "),Number(n==null?void 0:n.length)>30&&(n=`${n==null?void 0:n.substring(0,29)}…`),n?`(label=${n})`:""}function Vre(t,e){return(t&e)>0}function kv(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}class Aut{init(e){const n=this.getTarget(e),[,i]=JM(null,n),r=this.getEventInit();return pM(e,n),e.dispatchUIEvent(n,"pointerover",r),i.forEach(s=>e.dispatchUIEvent(s,"pointerenter",r)),this}move(e,n){const i=this.position,r=this.getTarget(e);if(this.position=n,!vye(i,n))return;const s=this.getTarget(e),a=this.getEventInit(-1),[o,c]=JM(r,s);return{leave:()=>{O3(e,r)&&r!==s&&(e.dispatchUIEvent(r,"pointerout",a),o.forEach(l=>e.dispatchUIEvent(l,"pointerleave",a)))},enter:()=>{pM(e,s),r!==s&&(e.dispatchUIEvent(s,"pointerover",a),c.forEach(l=>e.dispatchUIEvent(l,"pointerenter",a)))},move:()=>{e.dispatchUIEvent(s,"pointermove",a)}}}down(e,n=0){if(this.isDown)return;const i=this.getTarget(e);pM(e,i),this.isDown=!0,this.isPrevented=!e.dispatchUIEvent(i,"pointerdown",this.getEventInit(n))}up(e,n=0){if(!this.isDown)return;const i=this.getTarget(e);pM(e,i),this.isPrevented=!1,this.isDown=!1,e.dispatchUIEvent(i,"pointerup",this.getEventInit(n))}release(e){const n=this.getTarget(e),[i]=JM(n,null),r=this.getEventInit();O3(e,n)&&(e.dispatchUIEvent(n,"pointerout",r),i.forEach(s=>e.dispatchUIEvent(s,"pointerleave",r))),this.isCancelled=!0}getTarget(e){var n;return(n=this.position.target)!==null&&n!==void 0?n:e.config.document.body}getEventInit(e){return{...this.position.coords,pointerId:this.pointerId,pointerType:this.pointerType,isPrimary:this.isPrimary,button:Zq(e),buttons:this.buttons.getButtons()}}constructor({pointerId:e,pointerType:n,isPrimary:i},r){kv(this,"pointerId",void 0),kv(this,"pointerType",void 0),kv(this,"isPrimary",void 0),kv(this,"buttons",void 0),kv(this,"isMultitouch",!1),kv(this,"isCancelled",!1),kv(this,"isDown",!1),kv(this,"isPrevented",!1),kv(this,"position",{}),this.pointerId=e,this.pointerType=n,this.isPrimary=i,this.isMultitouch=!i,this.buttons=r}}function Ny(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}class Rut{isKeyPressed(e){return this.devices.get(e.pointerType).isPressed(e)}async press(e,n,i){this.devices.get(n.pointerType).addPressed(n),this.buttons.down(n);const r=this.getPointerName(n),s=n.pointerType==="touch"?this.pointers.new(r,n.pointerType,this.buttons):this.pointers.get(r);s.position=i,s.pointerType!=="touch"&&(this.mouse.position=i),s.pointerType==="touch"&&s.init(e),s.down(e,n.button),s.pointerType!=="touch"&&this.mouse.down(e,n,s.isPrevented)}async move(e,n,i){const r=this.pointers.get(n),s=r.move(e,i),a=r.pointerType==="touch"?void 0:this.mouse.move(e,i,r.isPrevented);s==null||s.leave(),a==null||a.leave(),s==null||s.enter(),a==null||a.enter(),s==null||s.move(),a==null||a.move()}async release(e,n,i){const r=this.devices.get(n.pointerType);r.removePressed(n),this.buttons.up(n);const s=this.pointers.get(this.getPointerName(n)),a=s.isPrevented;if(s.position=i,s.pointerType!=="touch"&&(this.mouse.position=i),r.countPressed===0&&s.up(e,n.button),s.pointerType==="touch"&&s.release(e),s.pointerType==="touch"&&!s.isMultitouch){const o=this.mouse.move(e,i,a);o==null||o.leave(),o==null||o.enter(),o==null||o.move(),this.mouse.down(e,n,a)}if(!s.isMultitouch){const o=this.mouse.move(e,i,a);o==null||o.leave(),o==null||o.enter(),o==null||o.move(),this.mouse.up(e,n,a)}}getPointerName(e){return e.pointerType==="touch"?e.name:e.pointerType}getPreviousPosition(e){return this.pointers.has(e)?this.pointers.get(e).position:void 0}resetClickCount(){this.mouse.resetClickCount()}getMouseTarget(e){var n;return(n=this.mouse.position.target)!==null&&n!==void 0?n:e.config.document.body}setMousePosition(e){this.mouse.position=e,this.pointers.get("mouse").position=e}constructor(e){Ny(this,"system",void 0),Ny(this,"mouse",void 0),Ny(this,"buttons",void 0),Ny(this,"devices",new class{get(n){var i,r,s;return(s=(i=this.registry)[r=n])!==null&&s!==void 0?s:i[r]=new yut}constructor(){Ny(this,"registry",{})}}),Ny(this,"pointers",new class{new(n,i,r){const s=i!=="touch"||!Object.values(this.registry).some(a=>a.pointerType==="touch"&&!a.isCancelled);return s||Object.values(this.registry).forEach(a=>{a.pointerType===i&&!a.isCancelled&&(a.isMultitouch=!0)}),this.registry[n]=new Aut({pointerId:this.nextId++,pointerType:i,isPrimary:s},r),this.registry[n]}get(n){if(!this.has(n))throw new Error(`Trying to access pointer "${n}" which does not exist.`);return this.registry[n]}has(n){return n in this.registry}constructor(){Ny(this,"registry",{}),Ny(this,"nextId",1)}}),this.system=e,this.buttons=new mye,this.mouse=new Tut,this.pointers.new("mouse","mouse",this.buttons)}}function Gre(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}class yye{getUIEventModifiers(){return{altKey:this.keyboard.modifiers.Alt,ctrlKey:this.keyboard.modifiers.Control,metaKey:this.keyboard.modifiers.Meta,shiftKey:this.keyboard.modifiers.Shift,modifierAltGraph:this.keyboard.modifiers.AltGraph,modifierCapsLock:this.keyboard.modifiers.CapsLock,modifierFn:this.keyboard.modifiers.Fn,modifierFnLock:this.keyboard.modifiers.FnLock,modifierNumLock:this.keyboard.modifiers.NumLock,modifierScrollLock:this.keyboard.modifiers.ScrollLock,modifierSymbol:this.keyboard.modifiers.Symbol,modifierSymbolLock:this.keyboard.modifiers.SymbolLock}}constructor(){Gre(this,"keyboard",new put(this)),Gre(this,"pointer",new Rut(this))}}async function Mut(t){const e=[];return this.config.skipHover||e.push({target:t}),e.push({keys:"[MouseLeft]",target:t}),this.pointer(e)}async function Out(t){return this.pointer([{target:t},"[MouseLeft][MouseLeft]"])}async function Nut(t){return this.pointer([{target:t},"[MouseLeft][MouseLeft][MouseLeft]"])}async function Iut(t){return this.pointer({target:t})}async function kut(t){return pM(this,this.system.pointer.getMouseTarget(this)),this.pointer({target:t.ownerDocument.body})}async function Dut({shift:t}={}){return this.keyboard(t===!0?"{Shift>}{Tab}{/Shift}":t===!1?"[/ShiftLeft][/ShiftRight]{Tab}":"{Tab}")}var TX=function(t){return t["{"]="}",t["["]="]",t}(TX||{});function bye(t,e){let n=0;const i=t[n]in TX?t[n]:"";n+=i.length;const s=new RegExp(`^\\${i}{2}`).test(t)?"":i;return{type:s,...s===""?Put(t,n,e):Lut(t,n,s,e)}}function Put(t,e,n){const i=t[e];return Eye(i,t,e,n),e+=i.length,{consumedLength:e,descriptor:i,releasePrevious:!1,releaseSelf:!0,repeat:1}}function Lut(t,e,n,i){var r,s;const a=t[e]==="/"?"/":"";e+=a.length;const o=n==="{"&&t[e]==="\\";e+=Number(o);const c=o?t[e]:(r=t.slice(e).match(n==="{"?/^\w+|^[^}>/]/:/^\w+/))===null||r===void 0?void 0:r[0];Eye(c,t,e,i),e+=c.length;var l;const u=(l=(s=t.slice(e).match(/^>\d+/))===null||s===void 0?void 0:s[0])!==null&&l!==void 0?l:"";e+=u.length;const h=t[e]==="/"||!u&&t[e]===">"?t[e]:"";e+=h.length;const f=TX[n],d=t[e]===f?f:"";if(!d)throw new Error(Sye([!u&&"repeat modifier",!h&&"release modifier",`"${f}"`].filter(Boolean).join(" or "),t[e],t,i));return e+=d.length,{consumedLength:e,descriptor:c,releasePrevious:!!a,repeat:u?Math.max(Number(u.substr(1)),1):1,releaseSelf:Uut(h,u)}}function Eye(t,e,n,i){if(!t)throw new Error(Sye("key descriptor",e[n],e,i))}function Uut(t,e){if(t)return t==="/";if(e)return!1}function Sye(t,e,n,i){return`Expected ${t} but found "${e??""}" in "${n}"
    See ${i==="pointer"?"https://testing-library.com/docs/user-event/pointer#pressing-a-button-or-touching-the-screen":"https://testing-library.com/docs/user-event/keyboard"}
    for more information about how userEvent parses your input.`}function But(t,e){const n=[];do{const{type:r,descriptor:s,consumedLength:a,releasePrevious:o,releaseSelf:c=!0,repeat:l}=bye(e,"keyboard");var i;const u=(i=t.find(h=>{if(r==="["){var f;return((f=h.code)===null||f===void 0?void 0:f.toLowerCase())===s.toLowerCase()}else if(r==="{"){var d;return((d=h.key)===null||d===void 0?void 0:d.toLowerCase())===s.toLowerCase()}return h.key===s}))!==null&&i!==void 0?i:{key:"Unknown",code:"Unknown",[r==="["?"code":"key"]:s};n.push({keyDef:u,releasePrevious:o,releaseSelf:c,repeat:l}),e=e.slice(a)}while(e);return n}async function Fut(t){const e=But(this.config.keyboardMap,t);for(let n=0;n<e.length;n++)await aA(this.config),await zut(this,e[n])}async function zut(t,{keyDef:e,releasePrevious:n,releaseSelf:i,repeat:r}){const{system:s}=t;if(s.keyboard.isKeyPressed(e)&&await s.keyboard.keyup(t,e),!n){for(let a=1;a<=r;a++)await s.keyboard.keydown(t,e),a<r&&await aA(t.config);i&&await s.keyboard.keyup(t,e)}}async function Hut(t){for(const e of t.system.keyboard.getPressedKeys())await t.system.keyboard.keyup(t,e)}function Tye(t){const e=E0(t)?{"text/plain":jut(t)}:{"text/plain":String(t.ownerDocument.getSelection())},n=sX(Ap(t));for(const i in e)e[i]&&n.setData(i,e[i]);return n}function jut(t){const e=CN(t);return S0(t).substring(e.startOffset,e.endOffset)}async function Vut(){const t=this.config.document;var e;const n=(e=t.activeElement)!==null&&e!==void 0?e:t.body,i=Tye(n);if(i.items.length!==0)return this.dispatchUIEvent(n,"copy",{clipboardData:i})&&this.config.writeToClipboard&&await yve(t,i),i}async function Gut(){const t=this.config.document;var e;const n=(e=t.activeElement)!==null&&e!==void 0?e:t.body,i=Tye(n);if(i.items.length!==0)return this.dispatchUIEvent(n,"cut",{clipboardData:i})&&this.config.writeToClipboard&&await yve(n.ownerDocument,i),i}async function qut(t){const e=this.config.document;var n;const i=(n=e.activeElement)!==null&&n!==void 0?n:e.body;var r;const s=(r=typeof t=="string"?$ut(e,t):t)!==null&&r!==void 0?r:await HXe(e).catch(()=>{throw new Error("`userEvent.paste()` without `clipboardData` requires the `ClipboardAPI` to be available.")});this.dispatchUIEvent(i,"paste",{clipboardData:s})}function $ut(t,e){const n=sX(Ap(t));return n.setData("text",e),n}function qre(t,e){const n=[];do{const{descriptor:i,consumedLength:r,releasePrevious:s,releaseSelf:a=!0}=bye(e,"pointer"),o=t.find(c=>c.name===i);o&&n.push({keyDef:o,releasePrevious:s,releaseSelf:a}),e=e.slice(r)}while(e);return n}async function Wut(t){const{pointerMap:e}=this.config,n=[];(Array.isArray(t)?t:[t]).forEach(i=>{typeof i=="string"?n.push(...qre(e,i)):"keys"in i?n.push(...qre(e,i.keys).map(r=>({...i,...r}))):n.push(i)});for(let i=0;i<n.length;i++)await aA(this.config),await Yut(this,n[i]);this.system.pointer.resetClickCount()}async function Yut(t,e){var n,i;const r="pointerName"in e&&e.pointerName?e.pointerName:"keyDef"in e?t.system.pointer.getPointerName(e.keyDef):"mouse",s=t.system.pointer.getPreviousPosition(r);var a,o,c,l;const u={target:(a=e.target)!==null&&a!==void 0?a:Xut(t,s),coords:(o=e.coords)!==null&&o!==void 0?o:s==null?void 0:s.coords,caret:{node:(c=e.node)!==null&&c!==void 0?c:$re(e)||s==null||(n=s.caret)===null||n===void 0?void 0:n.node,offset:(l=e.offset)!==null&&l!==void 0?l:$re(e)||s==null||(i=s.caret)===null||i===void 0?void 0:i.offset}};"keyDef"in e?(t.system.pointer.isKeyPressed(e.keyDef)&&(dM(t,Vf.Trigger),await t.system.pointer.release(t,e.keyDef,u)),e.releasePrevious||(dM(t,Vf.Trigger),await t.system.pointer.press(t,e.keyDef,u),e.releaseSelf&&(dM(t,Vf.Trigger),await t.system.pointer.release(t,e.keyDef,u)))):(dM(t,Vf.Trigger),await t.system.pointer.move(t,r,u))}function $re(t){var e,n;return!!((n=(e=t.target)!==null&&e!==void 0?e:t.node)!==null&&n!==void 0?n:t.offset!==void 0)}function Xut(t,e){if(!e)throw new Error("This pointer has no previous position. Provide a target property!");var n;return(n=e.target)!==null&&n!==void 0?n:t.config.document.body}async function Kut(t){if(!tA(t)||R_(t))throw new Error("clear()` is only supported on editable elements.");if(rE(t),t.ownerDocument.activeElement!==t)throw new Error("The element to be cleared could not be focused.");if(cye(t),!qlt(t))throw new Error("The element content to be cleared could not be selected.");sA(this,t,"","deleteContentBackward")}async function Zut(t,e){return xye.call(this,!0,t,e)}async function Jut(t,e){return xye.call(this,!1,t,e)}async function xye(t,e,n){if(!t&&!e.multiple)throw os().getElementError("Unable to deselect an option in a non-multiple select. Use selectOptions to change the selection instead.",e);const i=Array.isArray(n)?n:[n],r=Array.from(e.querySelectorAll('option, [role="option"]')),s=i.map(o=>{if(typeof o!="string"&&r.includes(o))return o;{const c=r.find(l=>l.value===o||l.innerHTML===o);if(c)return c;throw os().getElementError(`Value "${String(o)}" not found in options`,e)}}).filter(o=>!R_(o));if(R_(e)||!s.length)return;const a=o=>{o.selected=t,this.dispatchUIEvent(e,"input",{bubbles:!0,cancelable:!1,composed:!0}),this.dispatchUIEvent(e,"change")};if(gr(e,"select"))if(e.multiple)for(const o of s){const c=this.config.pointerEventsCheck===0?!0:O3(this,o);c&&(this.dispatchUIEvent(o,"pointerover"),this.dispatchUIEvent(e,"pointerenter"),this.dispatchUIEvent(o,"mouseover"),this.dispatchUIEvent(e,"mouseenter"),this.dispatchUIEvent(o,"pointermove"),this.dispatchUIEvent(o,"mousemove"),this.dispatchUIEvent(o,"pointerdown"),this.dispatchUIEvent(o,"mousedown")),rE(e),c&&(this.dispatchUIEvent(o,"pointerup"),this.dispatchUIEvent(o,"mouseup")),a(o),c&&this.dispatchUIEvent(o,"click"),await aA(this.config)}else if(s.length===1){const o=this.config.pointerEventsCheck===0?!0:O3(this,e);o?await this.click(e):rE(e),a(s[0]),o&&(this.dispatchUIEvent(e,"pointerover"),this.dispatchUIEvent(e,"pointerenter"),this.dispatchUIEvent(e,"mouseover"),this.dispatchUIEvent(e,"mouseenter"),this.dispatchUIEvent(e,"pointerup"),this.dispatchUIEvent(e,"mouseup"),this.dispatchUIEvent(e,"click")),await aA(this.config)}else throw os().getElementError("Cannot select multiple options on a non-multiple select",e);else if(e.getAttribute("role")==="listbox")for(const o of s)await this.click(o),await this.unhover(o);else throw os().getElementError("Cannot select options on elements that are neither select nor listbox elements",e)}async function Qut(t,e,{skipClick:n=this.config.skipClick,skipAutoClose:i=this.config.skipAutoClose,initialSelectionStart:r,initialSelectionEnd:s}={}){t.disabled||(n||await this.click(t),r!==void 0&&fM(t,r,s??r),await this.keyboard(e),i||await Hut(this))}const Wre=Symbol("files and value properties are mocked");function bj(t,e,n){n?Object.defineProperty(t,e,n):delete t[e]}function eht(t,e){var n;(n=t[Wre])===null||n===void 0||n.restore();const i=Object.getOwnPropertyDescriptor(t,"type"),r=Object.getOwnPropertyDescriptor(t,"value"),s=Object.getOwnPropertyDescriptor(t,"files");function a(){bj(t,"type",i),bj(t,"value",r),bj(t,"files",s)}t[Wre]={restore:a},Object.defineProperties(t,{files:{configurable:!0,get:()=>e},value:{configurable:!0,get:()=>e.length?`C:\\fakepath\\${e[0].name}`:"",set(o){if(o==="")a();else{var c;r==null||(c=r.set)===null||c===void 0||c.call(t,o)}}},type:{configurable:!0,get:()=>"file",set(o){o!=="file"&&(a(),t.type=o)}}})}async function tht(t,e){const n=gr(t,"label")?t.control:t;if(!n||!gr(n,"input",{type:"file"}))throw new TypeError(`The ${n===t?"given":"associated"} ${n==null?void 0:n.tagName} element does not accept file uploads`);if(R_(t))return;const i=(Array.isArray(e)?e:[e]).filter(s=>!this.config.applyAccept||nht(s,n.accept)).slice(0,n.multiple?void 0:1),r=()=>{var s;i.length===((s=n.files)===null||s===void 0?void 0:s.length)&&i.every((a,o)=>{var c;return a===((c=n.files)===null||c===void 0?void 0:c.item(o))})||(eht(n,rX(Ap(t),i)),this.dispatchUIEvent(n,"input"),this.dispatchUIEvent(n,"change"))};n.addEventListener("fileDialog",r),await this.click(t),n.removeEventListener("fileDialog",r)}function PP(t){return t.toLowerCase().replace(/(\.|\/)jpg\b/g,"$1jpeg")}function nht(t,e){if(!e)return!0;const n=["audio/*","image/*","video/*"];return PP(e).trim().split(/\s*,\s*/).some(i=>i.startsWith(".")?PP(t.name).endsWith(i):n.includes(i)?PP(t.type).startsWith(i.replace("*","")):PP(t.type)===i)}const Yre={click:Mut,dblClick:Out,tripleClick:Nut,hover:Iut,unhover:kut,tab:Dut,keyboard:Fut,copy:Vut,cut:Gut,paste:qut,pointer:Wut,clear:Kut,deselectOptions:Jut,selectOptions:Zut,type:Qut,upload:tht};function iht(t){return os().asyncWrapper(t)}const wye={applyAccept:!0,autoModify:!0,delay:0,document:globalThis.document,keyboardMap:mut,pointerMap:gut,pointerEventsCheck:U2.EachApiCall,skipAutoClose:!1,skipClick:!1,skipHover:!1,writeToClipboard:!1,advanceTimers:()=>Promise.resolve()},rht={...wye,writeToClipboard:!0};function Cye(t={},e=rht,n){const i=cht(t,n,e);return{...e,...t,document:i}}function sht(t={}){const e=Cye(t);pye(e.document),dye(Ap(e.document).HTMLElement);var n;const i=(n=e.document.defaultView)!==null&&n!==void 0?n:globalThis.window;return BXe(i),xX(e).api}function Su({keyboardState:t,pointerState:e,...n}={},i){const r=Cye(n,wye,i);pye(r.document),dye(Ap(r.document).HTMLElement);var s;const a=(s=e??t)!==null&&s!==void 0?s:new yye;return{api:xX(r,a).api,system:a}}function aht(t){return xX({...this.config,...t},this.system).api}function oht(t,e){function n(...i){return dM(t,Vf.Call),iht(()=>e.apply(t,i).then(async r=>(await aA(t.config),r)))}return Object.defineProperty(n,"name",{get:()=>e.name}),n}function xX(t,e=new yye){const n={};return Object.assign(n,{config:t,dispatchEvent:fye.bind(n),dispatchUIEvent:sut.bind(n),system:e,levelRefs:{},...Yre}),{instance:n,api:{...Object.fromEntries(Object.entries(Yre).map(([i,r])=>[i,oht(n,r)])),setup:aht.bind(n)}}}function cht(t,e,n){var i,r;return(r=(i=t.document)!==null&&i!==void 0?i:e&&uut(e))!==null&&r!==void 0?r:n.document}function lht(t){return Su().api.clear(t)}function uht(t,e={}){return Su(e,t).api.click(t)}function hht(t={}){return Su(t).api.copy()}function fht(t={}){return Su(t).api.cut()}function dht(t,e={}){return Su(e).api.dblClick(t)}function pht(t,e,n={}){return Su(n).api.deselectOptions(t,e)}function mht(t,e={}){return Su(e).api.hover(t)}async function ght(t,e={}){const{api:n,system:i}=Su(e);return n.keyboard(t).then(()=>i)}async function vht(t,e={}){const{api:n,system:i}=Su(e);return n.pointer(t).then(()=>i)}function _ht(t,e){return Su(e).api.paste(t)}function yht(t,e,n={}){return Su(n).api.selectOptions(t,e)}function bht(t,e={}){return Su(e).api.tripleClick(t)}function Eht(t,e,n={}){return Su(n,t).api.type(t,e,n)}function Sht(t,e={}){const{api:n,system:i}=Su(e);return i.pointer.setMousePosition({target:t}),n.unhover(t)}function Tht(t,e,n={}){return Su(n).api.upload(t,e)}function xht(t={}){return Su().api.tab(t)}const wht=Object.freeze(Object.defineProperty({__proto__:null,clear:lht,click:uht,copy:hht,cut:fht,dblClick:dht,deselectOptions:pht,hover:mht,keyboard:ght,paste:_ht,pointer:vht,selectOptions:yht,tab:xht,tripleClick:bht,type:Eht,unhover:Sht,upload:Tht},Symbol.toStringTag,{value:"Module"})),Cht={...wht,setup:sht},Hf=Cht.setup({delay:null});function Pa(){return window.sysclipboard}function wX(t){const e=new Set;function n(s){MBe(s)&&s.target!=="tick"&&s.target!=="tock"&&e.has(s.id)===!1&&(e.add(s.id),KO.invoke(s))}const i=yE("forward",["all"],s=>{e.has(s.id)||(e.add(s.id),t(s))});function r(){KO.disconnect(i)}return{forward:n,disconnect:r}}function Aht(t){switch(t.target){case"tick":case"tock":case"ready":return!0}return!1}function Rht(t){switch(t.target){case"info":case"debug":case"error":case"tick":case"tock":case"ready":case"second":return!0;default:{const e=S1(t.target);switch(e.target){case"vm":case"synth":case"modem":case"bridge":case"register":case"gadgetclient":return!0}switch(e.path){case"sync":case"joinack":case"acklogin":case"ackoperator":case"ackzsswords":case"gadgetclient":return!0}break}}return!1}function Mht(t){return!1}function Aye(t){const e=S1(t.target);switch(e.target){case"vm":case"modem":case"gadgetserver":return!0}switch(e.path){case"sync":case"joinack":return!0}return!1}function Oht(t){return new Worker("/assets/simspace-PvLiL6oo.js",{name:t==null?void 0:t.name})}function Nht(t){return new Worker("/assets/stubspace-_xHV6VG8.js",{name:t==null?void 0:t.name})}let LP;function Iht(t=!1){if(!se(LP)){LP=t?new Nht:new Oht;const{forward:e}=wX(n=>{Aye(n)&&LP.postMessage(n)});LP.addEventListener("message",n=>e(n.data))}}async function RN(t){return DFe(t)}async function N3(t,e){return PFe(t,e)}function kht(t){try{return sessionStorage.getItem(t)??void 0}catch(e){Ui(wi,ya,`readsession ${t}`,e.message)}}function Dht(t,e){try{se(e)?sessionStorage.setItem(t,e):sessionStorage.removeItem(t)}catch(n){Ui(wi,ya,`writesession ${t} <- ${e}`,n.message)}}function CX(){try{const t=location.hash.slice(1);if(t.length)return t}catch(t){Ui(wi,ya,"crash",t.message)}return""}async function B2(){const t=CX();if(t.length){const e=await jht(t);return se(e)&&e.length>t.length?e:t}return""}function Rye(){A6e(wi,ya,"https://github.com/goldbuick/zed-software-system/wiki","open help wiki")}const Pht=["$brown$153","$purple$5","$green$42","$ltgray$94","$white$24","$white$25","$white$26","$white$27","$white$16","$white$17","$white$30","$white$31","$red$234","$cyan$227","$dkpurple$227"];function Xre(t){return Li(t.data)?[t.sender,...t.data.map(e=>`${e}`)].join(" "):""}function Ej(t){const{terminal:e}=Fs.getState();let i=[[Bo(),t.target,qme(t.sender,Pht),...t.data],...e.logs];i.length>_te&&(i=i.slice(0,_te)),Fs.setState(r=>({terminal:{...r.terminal,logs:i}}))}function Lht(t){const{layout:e,editor:n}=Fs.getState();let r=e+(t?1:-1);if(r<0&&(r+=qf.MAX),r>=qf.MAX&&(r-=qf.MAX),!n.open)switch(r){case qf.SPLIT_Y:case qf.SPLIT_Y_ALT:r=qf.TOP;break}Fs.setState({layout:r})}async function Qq(t){if(t.length===0){Ui(wi,ya,"content","no content found"),Rye(),t9(wi,ya);return}const e=await Uht()??"";dFe(wi,ya,t,e)}let MN="";window.addEventListener("hashchange",()=>{cu(wi,ya,async()=>{const t=CX();if(MN!==t){MN=t;const e=await B2();await Qq(e)}})});async function Mye(t,e){if(t.length>1024){const i=await Hht(t);return Mye(i,e)}const n=`#${t}`;if(location.hash!==n){MN=t,location.hash=n;const i=`wrote ${(t==null?void 0:t.length)??0} chars [${t.slice(0,8)}...${t.slice(-8)}]`;e.includes("autosave")?OBe(wi,ya,i):(e.length&&(document.title=e),e0(wi,ya,i))}}async function Uht(){return RN("SELECTED")}async function Bht(t){return N3("SELECTED",()=>t)}async function Fht(){return RN("HISTORYBUFFER")}async function zht(t){return N3("HISTORYBUFFER",()=>t)}async function Hht(t){let e=await RN(t);if(e===void 0){for(;e===void 0;){const n=n9({addAdverb:!0,capitalize:!1,adjectiveCount:2});await RN(n)===void 0&&(e=n)}await N3(t,()=>e),await N3(e,()=>t)}return e}async function jht(t){return await RN(t)}let Sj=0;const Kre=1,ya=kht("PLAYER")??YFe();Dht("PLAYER",ya);function nr(){return ya}const wi=yE("register",["ready","second","info","error","debug","toast"],function(t){if(!wi.session(t))return;switch(t.target){case"ready":case"second":break;default:if(t.player!==ya)return;break}const{terminal:e}=Fs.getState();switch(t.target){case"ready":{cu(wi,t.player,async()=>{const n=await Fht();se(n)&&Lo.setState({buffer:n}),await Bd(256),Ci(wi,ya,`myplayerid ${ya}`),uFe(wi,ya)});break}case"loginfail":n_(wi,ya,"#pages"),Rye(),t9(wi,ya);break;case"ackoperator":cu(wi,t.player,async()=>{const n=await B2();ype()?HBe(wi,ya,n):(fFe(wi,ya,qG()),await Qq(n))});break;case"loginready":mFe(wi,ya);break;case"acklogin":PU(wi,ya),$Be(wi,ya),hFe(wi,ya);break;case"ackzsswords":xo.setState({zsswords:t.data});break;case"copy":On(t.data)&&se(Pa())&&Pa().writeText(t.data).then(()=>po(wi,t.player,"copied!")).catch(n=>console.error(n));break;case"copyjsonfile":if(Li(t.data)&&se(Pa())){const[n,i]=t.data,r=new Blob([JSON.stringify({exported:i,data:n},null,2)],{type:"text/plain"});Pa().write([new ClipboardItem({[r.type]:r})]).then(()=>po(wi,t.player,"copied!")).catch(s=>console.error(s))}break;case"downloadjsonfile":if(Li(t.data)){const[n,i]=t.data;try{const r=new Blob([JSON.stringify({exported:i,data:n},null,2)],{type:"application/json;charset=utf-8"}),s=URL.createObjectURL(r),a=document.createElement("a");a.href=s,a.download=i,a.click(),URL.revokeObjectURL(s)}catch(r){console.error(r)}}break;case"dev":cu(wi,t.player,async function(){qG()?(Gd(wi,t.player,"unlocking terminal"),await Bd(100),location.href=location.href.replace("/locked/#","/#")):(Gd(wi,t.player,"creating locked terminal"),await Bd(100),location.href=location.href.replace("/#","/locked/#"))});break;case"share":cu(wi,t.player,async function(){const n=CX(),i=await B2(),r=`#${i}`;MN=i,location.hash=r;const s=await _pe(location.href);GG(wi,t.player,s,s),location.hash=`#${n}`});break;case"nuke":cu(wi,t.player,async function(){Gd(wi,t.player,"nuke in"),cr(wi,t.player,"3","..."),await Bd(1e3),cr(wi,t.player,"2","..."),await Bd(1e3),cr(wi,t.player,"1","..."),await Bd(1e3),Gd(wi,t.player,"BYE"),await Bd(100),location.hash="",MN=location.hash,location.reload()});break;case"savemem":cu(wi,t.player,async function(){if(Li(t.data)){const[n,i]=t.data;On(n)&&On(i)&&await Mye(i,n)}});break;case"forkmem":if(Li(t.data)){const[n]=t.data;On(n)&&window.open(location.href.replace(/#.*/,`#${n}`),"_blank")}break;case"select":cu(wi,t.player,async()=>{if(On(t.data)){await Bht(t.data);const n=await B2();await Qq(n)}});break;case"second":++Sj,Sj>=Kre&&(Sj-=Kre,vFe(wi,ya));break;case"inspector":Fs.setState(n=>{const i=se(t.data)?!!t.data:!n.inspector;return Ci(wi,t.player,`gadget inspector ${i?"$greenon":"$redoff"}`),i&&Ci(wi,t.player,"mouse click or tap elements to inspect"),{inspector:i}});break;case"info":e.level>=v2.INFO&&Ej(t);break;case"debug":e.level>=v2.DEBUG&&(Ej(t),console.debug(Xre(t)));break;case"error":e.level>v2.OFF&&Ej(t),console.error(Xre(t));break;case"toast":cu(wi,t.player,async()=>{if(se(t.data)){const n=Math.min(Math.max(t.data.length*150,3e3),14e3);Fs.setState({toast:t.data}),await Bd(n),Fs.setState({toast:""})}});break;case"terminal:full":Fs.setState(n=>({layout:qf.FULL,terminal:{...n.terminal,open:!0}}));break;case"terminal:open":Fs.setState(n=>({terminal:{...n.terminal,open:!0}}));break;case"terminal:quickopen":Fs.setState({quickterminal:!0});break;case"terminal:close":Fs.setState(n=>({quickterminal:!1,terminal:{...n.terminal,open:!1}}));break;case"terminal:toggle":Fs.setState(n=>({terminal:{...n.terminal,open:!n.terminal.open}}));break;case"terminal:inclayout":RLe(t.data)&&Lht(t.data);break;case"editor:open":if(Li(t.data)){const[n,i,r,s,a]=t.data;Fs.setState(o=>({editor:{open:!0,player:t.player,book:n,path:i,type:r,title:s,refsheet:a.length?a:o.editor.refsheet}}))}break;case"editor:close":Fs.setState(n=>({editor:{...n.editor,open:!1}}));break;default:{const{target:n,path:i}=S1(t.target);switch(n){case"touchkey":cu(wi,t.player,async()=>{switch(i){case"[Alt]":zy(wi,t.player,"","-c",!0),Zh.setState(r=>({...r,keyboardalt:!r.keyboardalt,keyboardctrl:!1,keyboardshift:!1}));break;case"[Ctrl]":zy(wi,t.player,"","-e",!0),Zh.setState(r=>({...r,keyboardalt:!1,keyboardctrl:!r.keyboardctrl,keyboardshift:!1}));break;case"[Shift]":zy(wi,t.player,"","-g",!0),Zh.setState(r=>({...r,keyboardalt:!1,keyboardctrl:!1,keyboardshift:!r.keyboardshift}));break;default:{const r=!isNaN(parseInt(i,10)),s=Zh.getState(),a=[],o=tE?"Meta":"Ctrl";s.keyboardshift?(zy(wi,t.player,"",r?"+c":"+f",!0),a.push("{Shift>}")):s.keyboardalt?(zy(wi,t.player,"",r?"+c!":"+f!",!0),a.push("{Alt>}")):s.keyboardctrl?(zy(wi,t.player,"",r?"+c#":"+f#",!0),a.push(`{${o}>}`)):zy(wi,t.player,"",r?"-c":"-f",!0),a.push(i),s.keyboardshift?a.push("{/Shift}"):s.keyboardalt?a.push("{/Alt}"):s.keyboardctrl&&a.push(`{/${o}}`);const c=a.join("");await Hf.keyboard(c);break}}});break}break}}});setTimeout(function(){Iht(ype())},100);const Oye="15.1.22",Zre=(t,e,n)=>({endTime:e,insertTime:n,type:"exponentialRampToValue",value:t}),Jre=(t,e,n)=>({endTime:e,insertTime:n,type:"linearRampToValue",value:t}),e$=(t,e)=>({startTime:e,type:"setValue",value:t}),Nye=(t,e,n)=>({duration:n,startTime:e,type:"setValueCurve",values:t}),Iye=(t,e,{startTime:n,target:i,timeConstant:r})=>i+(e-i)*Math.exp((n-t)/r),Dw=t=>t.type==="exponentialRampToValue",I3=t=>t.type==="linearRampToValue",Jy=t=>Dw(t)||I3(t),AX=t=>t.type==="setValue",zv=t=>t.type==="setValueCurve",k3=(t,e,n,i)=>{const r=t[e];return r===void 0?i:Jy(r)||AX(r)?r.value:zv(r)?r.values[r.values.length-1]:Iye(n,k3(t,e-1,r.startTime,i),r)},Qre=(t,e,n,i,r)=>n===void 0?[i.insertTime,r]:Jy(n)?[n.endTime,n.value]:AX(n)?[n.startTime,n.value]:zv(n)?[n.startTime+n.duration,n.values[n.values.length-1]]:[n.startTime,k3(t,e-1,n.startTime,r)],t$=t=>t.type==="cancelAndHold",n$=t=>t.type==="cancelScheduledValues",Iy=t=>t$(t)||n$(t)?t.cancelTime:Dw(t)||I3(t)?t.endTime:t.startTime,ese=(t,e,n,{endTime:i,value:r})=>n===r?r:0<n&&0<r||n<0&&r<0?n*(r/n)**((t-e)/(i-e)):0,tse=(t,e,n,{endTime:i,value:r})=>n+(t-e)/(i-e)*(r-n),Vht=(t,e)=>{const n=Math.floor(e),i=Math.ceil(e);return n===i?t[n]:(1-(e-n))*t[n]+(1-(i-e))*t[i]},Ght=(t,{duration:e,startTime:n,values:i})=>{const r=(t-n)/e*(i.length-1);return Vht(i,r)},UP=t=>t.type==="setTarget";class qht{constructor(e){this._automationEvents=[],this._currenTime=0,this._defaultValue=e}[Symbol.iterator](){return this._automationEvents[Symbol.iterator]()}add(e){const n=Iy(e);if(t$(e)||n$(e)){const i=this._automationEvents.findIndex(s=>n$(e)&&zv(s)?s.startTime+s.duration>=n:Iy(s)>=n),r=this._automationEvents[i];if(i!==-1&&(this._automationEvents=this._automationEvents.slice(0,i)),t$(e)){const s=this._automationEvents[this._automationEvents.length-1];if(r!==void 0&&Jy(r)){if(s!==void 0&&UP(s))throw new Error("The internal list is malformed.");const a=s===void 0?r.insertTime:zv(s)?s.startTime+s.duration:Iy(s),o=s===void 0?this._defaultValue:zv(s)?s.values[s.values.length-1]:s.value,c=Dw(r)?ese(n,a,o,r):tse(n,a,o,r),l=Dw(r)?Zre(c,n,this._currenTime):Jre(c,n,this._currenTime);this._automationEvents.push(l)}if(s!==void 0&&UP(s)&&this._automationEvents.push(e$(this.getValue(n),n)),s!==void 0&&zv(s)&&s.startTime+s.duration>n){const a=n-s.startTime,o=(s.values.length-1)/s.duration,c=Math.max(2,1+Math.ceil(a*o)),l=a/(c-1)*o,u=s.values.slice(0,c);if(l<1)for(let h=1;h<c;h+=1){const f=l*h%1;u[h]=s.values[h-1]*(1-f)+s.values[h]*f}this._automationEvents[this._automationEvents.length-1]=Nye(u,s.startTime,a)}}}else{const i=this._automationEvents.findIndex(a=>Iy(a)>n),r=i===-1?this._automationEvents[this._automationEvents.length-1]:this._automationEvents[i-1];if(r!==void 0&&zv(r)&&Iy(r)+r.duration>n)return!1;const s=Dw(e)?Zre(e.value,e.endTime,this._currenTime):I3(e)?Jre(e.value,n,this._currenTime):e;if(i===-1)this._automationEvents.push(s);else{if(zv(e)&&n+e.duration>Iy(this._automationEvents[i]))return!1;this._automationEvents.splice(i,0,s)}}return!0}flush(e){const n=this._automationEvents.findIndex(i=>Iy(i)>e);if(n>1){const i=this._automationEvents.slice(n-1),r=i[0];UP(r)&&i.unshift(e$(k3(this._automationEvents,n-2,r.startTime,this._defaultValue),r.startTime)),this._automationEvents=i}}getValue(e){if(this._automationEvents.length===0)return this._defaultValue;const n=this._automationEvents.findIndex(a=>Iy(a)>e),i=this._automationEvents[n],r=(n===-1?this._automationEvents.length:n)-1,s=this._automationEvents[r];if(s!==void 0&&UP(s)&&(i===void 0||!Jy(i)||i.insertTime>e))return Iye(e,k3(this._automationEvents,r-1,s.startTime,this._defaultValue),s);if(s!==void 0&&AX(s)&&(i===void 0||!Jy(i)))return s.value;if(s!==void 0&&zv(s)&&(i===void 0||!Jy(i)||s.startTime+s.duration>e))return e<s.startTime+s.duration?Ght(e,s):s.values[s.values.length-1];if(s!==void 0&&Jy(s)&&(i===void 0||!Jy(i)))return s.value;if(i!==void 0&&Dw(i)){const[a,o]=Qre(this._automationEvents,r,s,i,this._defaultValue);return ese(e,a,o,i)}if(i!==void 0&&I3(i)){const[a,o]=Qre(this._automationEvents,r,s,i,this._defaultValue);return tse(e,a,o,i)}return this._defaultValue}}const $ht=t=>({cancelTime:t,type:"cancelAndHold"}),Wht=t=>({cancelTime:t,type:"cancelScheduledValues"}),Yht=(t,e)=>({endTime:e,type:"exponentialRampToValue",value:t}),Xht=(t,e)=>({endTime:e,type:"linearRampToValue",value:t}),Kht=(t,e,n)=>({startTime:e,target:t,timeConstant:n,type:"setTarget"}),Zht=()=>new DOMException("","AbortError"),Jht=t=>(e,n,[i,r,s],a)=>{t(e[r],[n,i,s],o=>o[0]===n&&o[1]===i,a)},Qht=t=>(e,n,i)=>{const r=[];for(let s=0;s<i.numberOfInputs;s+=1)r.push(new Set);t.set(e,{activeInputs:r,outputs:new Set,passiveInputs:new WeakMap,renderer:n})},eft=t=>(e,n)=>{t.set(e,{activeInputs:new Set,passiveInputs:new WeakMap,renderer:n})},oA=new WeakSet,kye=new WeakMap,RX=new WeakMap,Dye=new WeakMap,MX=new WeakMap,jz=new WeakMap,Pye=new WeakMap,i$=new WeakMap,r$=new WeakMap,s$=new WeakMap,Lye={construct(){return Lye}},tft=t=>{try{const e=new Proxy(t,Lye);new e}catch{return!1}return!0},nse=/^import(?:(?:[\s]+[\w]+|(?:[\s]+[\w]+[\s]*,)?[\s]*\{[\s]*[\w]+(?:[\s]+as[\s]+[\w]+)?(?:[\s]*,[\s]*[\w]+(?:[\s]+as[\s]+[\w]+)?)*[\s]*}|(?:[\s]+[\w]+[\s]*,)?[\s]*\*[\s]+as[\s]+[\w]+)[\s]+from)?(?:[\s]*)("([^"\\]|\\.)+"|'([^'\\]|\\.)+')(?:[\s]*);?/,ise=(t,e)=>{const n=[];let i=t.replace(/^[\s]+/,""),r=i.match(nse);for(;r!==null;){const s=r[1].slice(1,-1),a=r[0].replace(/([\s]+)?;?$/,"").replace(s,new URL(s,e).toString());n.push(a),i=i.slice(r[0].length).replace(/^[\s]+/,""),r=i.match(nse)}return[n.join(";"),i]},rse=t=>{if(t!==void 0&&!Array.isArray(t))throw new TypeError("The parameterDescriptors property of given value for processorCtor is not an array.")},sse=t=>{if(!tft(t))throw new TypeError("The given value for processorCtor should be a constructor.");if(t.prototype===null||typeof t.prototype!="object")throw new TypeError("The given value for processorCtor should have a prototype.")},nft=(t,e,n,i,r,s,a,o,c,l,u,h,f)=>{let d=0;return(p,g,y={credentials:"omit"})=>{const v=u.get(p);if(v!==void 0&&v.has(g))return Promise.resolve();const b=l.get(p);if(b!==void 0){const M=b.get(g);if(M!==void 0)return M}const T=s(p),x=T.audioWorklet===void 0?r(g).then(([M,R])=>{const[I,k]=ise(M,R),P=`${I};((a,b)=>{(a[b]=a[b]||[]).push((AudioWorkletProcessor,global,registerProcessor,sampleRate,self,window)=>{${k}
})})(window,'_AWGS')`;return n(P)}).then(()=>{const M=f._AWGS.pop();if(M===void 0)throw new SyntaxError;i(T.currentTime,T.sampleRate,()=>M(class{},void 0,(R,I)=>{if(R.trim()==="")throw e();const k=r$.get(T);if(k!==void 0){if(k.has(R))throw e();sse(I),rse(I.parameterDescriptors),k.set(R,I)}else sse(I),rse(I.parameterDescriptors),r$.set(T,new Map([[R,I]]))},T.sampleRate,void 0,void 0))}):Promise.all([r(g),Promise.resolve(t(h,h))]).then(([[M,R],I])=>{const k=d+1;d=k;const[P,U]=ise(M,R),Y=`${P};((AudioWorkletProcessor,registerProcessor)=>{${U}
})(${I?"AudioWorkletProcessor":"class extends AudioWorkletProcessor {__b=new WeakSet();constructor(){super();(p=>p.postMessage=(q=>(m,t)=>q.call(p,m,t?t.filter(u=>!this.__b.has(u)):t))(p.postMessage))(this.port)}}"},(n,p)=>registerProcessor(n,class extends p{${I?"":"__c = (a) => a.forEach(e=>this.__b.add(e.buffer));"}process(i,o,p){${I?"":"i.forEach(this.__c);o.forEach(this.__c);this.__c(Object.values(p));"}return super.process(i.map(j=>j.some(k=>k.length===0)?[]:j),o,p)}}));registerProcessor('__sac${k}',class extends AudioWorkletProcessor{process(){return !1}})`,ie=new Blob([Y],{type:"application/javascript; charset=utf-8"}),V=URL.createObjectURL(ie);return T.audioWorklet.addModule(V,y).then(()=>{if(o(T))return T;const J=a(T);return J.audioWorklet.addModule(V,y).then(()=>J)}).then(J=>{if(c===null)throw new SyntaxError;try{new c(J,`__sac${k}`)}catch{throw new SyntaxError}}).finally(()=>URL.revokeObjectURL(V))});return b===void 0?l.set(p,new Map([[g,x]])):b.set(g,x),x.then(()=>{const M=u.get(p);M===void 0?u.set(p,new Set([g])):M.add(g)}).finally(()=>{const M=l.get(p);M!==void 0&&M.delete(g)}),x}},_m=(t,e)=>{const n=t.get(e);if(n===void 0)throw new Error("A value with the given key could not be found.");return n},Vz=(t,e)=>{const n=Array.from(t).filter(e);if(n.length>1)throw Error("More than one element was found.");if(n.length===0)throw Error("No element was found.");const[i]=n;return t.delete(i),i},Uye=(t,e,n,i)=>{const r=_m(t,e),s=Vz(r,a=>a[0]===n&&a[1]===i);return r.size===0&&t.delete(e),s},gk=t=>_m(Pye,t),cA=t=>{if(oA.has(t))throw new Error("The AudioNode is already stored.");oA.add(t),gk(t).forEach(e=>e(!0))},Bye=t=>"port"in t,vk=t=>{if(!oA.has(t))throw new Error("The AudioNode is not stored.");oA.delete(t),gk(t).forEach(e=>e(!1))},a$=(t,e)=>{!Bye(t)&&e.every(n=>n.size===0)&&vk(t)},ift=(t,e,n,i,r,s,a,o,c,l,u,h,f)=>{const d=new WeakMap;return(p,g,y,v,b)=>{const{activeInputs:T,passiveInputs:x}=s(g),{outputs:M}=s(p),R=o(p),I=k=>{const P=c(g),U=c(p);if(k){const G=Uye(x,p,y,v);t(T,p,G,!1),!b&&!h(p)&&n(U,P,y,v),f(g)&&cA(g)}else{const G=i(T,p,y,v);e(x,v,G,!1),!b&&!h(p)&&r(U,P,y,v);const $=a(g);if($===0)u(g)&&a$(g,T);else{const q=d.get(g);q!==void 0&&clearTimeout(q),d.set(g,setTimeout(()=>{u(g)&&a$(g,T)},$*1e3))}}};return l(M,[g,y,v],k=>k[0]===g&&k[1]===y&&k[2]===v,!0)?(R.add(I),u(p)?t(T,p,[y,v,I],!0):e(x,v,[p,y,I],!0),!0):!1}},rft=t=>(e,n,[i,r,s],a)=>{const o=e.get(i);o===void 0?e.set(i,new Set([[r,n,s]])):t(o,[r,n,s],c=>c[0]===r&&c[1]===n,a)},sft=t=>(e,n)=>{const i=t(e,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});n.connect(i).connect(e.destination);const r=()=>{n.removeEventListener("ended",r),n.disconnect(i),i.disconnect()};n.addEventListener("ended",r)},aft=t=>(e,n)=>{t(e).add(n)},oft={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",fftSize:2048,maxDecibels:-30,minDecibels:-100,smoothingTimeConstant:.8},cft=(t,e,n,i,r,s)=>class extends t{constructor(o,c){const l=r(o),u={...oft,...c},h=i(l,u),f=s(l)?e():null;super(o,!1,h,f),this._nativeAnalyserNode=h}get fftSize(){return this._nativeAnalyserNode.fftSize}set fftSize(o){this._nativeAnalyserNode.fftSize=o}get frequencyBinCount(){return this._nativeAnalyserNode.frequencyBinCount}get maxDecibels(){return this._nativeAnalyserNode.maxDecibels}set maxDecibels(o){const c=this._nativeAnalyserNode.maxDecibels;if(this._nativeAnalyserNode.maxDecibels=o,!(o>this._nativeAnalyserNode.minDecibels))throw this._nativeAnalyserNode.maxDecibels=c,n()}get minDecibels(){return this._nativeAnalyserNode.minDecibels}set minDecibels(o){const c=this._nativeAnalyserNode.minDecibels;if(this._nativeAnalyserNode.minDecibels=o,!(this._nativeAnalyserNode.maxDecibels>o))throw this._nativeAnalyserNode.minDecibels=c,n()}get smoothingTimeConstant(){return this._nativeAnalyserNode.smoothingTimeConstant}set smoothingTimeConstant(o){this._nativeAnalyserNode.smoothingTimeConstant=o}getByteFrequencyData(o){this._nativeAnalyserNode.getByteFrequencyData(o)}getByteTimeDomainData(o){this._nativeAnalyserNode.getByteTimeDomainData(o)}getFloatFrequencyData(o){this._nativeAnalyserNode.getFloatFrequencyData(o)}getFloatTimeDomainData(o){this._nativeAnalyserNode.getFloatTimeDomainData(o)}},Tu=(t,e)=>t.context===e,lft=(t,e,n)=>()=>{const i=new WeakMap,r=async(s,a)=>{let o=e(s);if(!Tu(o,a)){const l={channelCount:o.channelCount,channelCountMode:o.channelCountMode,channelInterpretation:o.channelInterpretation,fftSize:o.fftSize,maxDecibels:o.maxDecibels,minDecibels:o.minDecibels,smoothingTimeConstant:o.smoothingTimeConstant};o=t(a,l)}return i.set(a,o),await n(s,a,o),o};return{render(s,a){const o=i.get(a);return o!==void 0?Promise.resolve(o):r(s,a)}}},D3=t=>{try{t.copyToChannel(new Float32Array(1),0,-1)}catch{return!1}return!0},T0=()=>new DOMException("","IndexSizeError"),OX=t=>{t.getChannelData=(e=>n=>{try{return e.call(t,n)}catch(i){throw i.code===12?T0():i}})(t.getChannelData)},uft={numberOfChannels:1},hft=(t,e,n,i,r,s,a,o)=>{let c=null;return class Fye{constructor(u){if(r===null)throw new Error("Missing the native OfflineAudioContext constructor.");const{length:h,numberOfChannels:f,sampleRate:d}={...uft,...u};c===null&&(c=new r(1,1,44100));const p=i!==null&&e(s,s)?new i({length:h,numberOfChannels:f,sampleRate:d}):c.createBuffer(f,h,d);if(p.numberOfChannels===0)throw n();return typeof p.copyFromChannel!="function"?(a(p),OX(p)):e(D3,()=>D3(p))||o(p),t.add(p),p}static[Symbol.hasInstance](u){return u!==null&&typeof u=="object"&&Object.getPrototypeOf(u)===Fye.prototype||t.has(u)}}},Vh=-34028234663852886e22,eh=-Vh,d_=t=>oA.has(t),fft={buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1},dft=(t,e,n,i,r,s,a,o)=>class extends t{constructor(l,u){const h=s(l),f={...fft,...u},d=r(h,f),p=a(h),g=p?e():null;super(l,!1,d,g),this._audioBufferSourceNodeRenderer=g,this._isBufferNullified=!1,this._isBufferSet=f.buffer!==null,this._nativeAudioBufferSourceNode=d,this._onended=null,this._playbackRate=n(this,p,d.playbackRate,eh,Vh)}get buffer(){return this._isBufferNullified?null:this._nativeAudioBufferSourceNode.buffer}set buffer(l){if(this._nativeAudioBufferSourceNode.buffer=l,l!==null){if(this._isBufferSet)throw i();this._isBufferSet=!0}}get loop(){return this._nativeAudioBufferSourceNode.loop}set loop(l){this._nativeAudioBufferSourceNode.loop=l}get loopEnd(){return this._nativeAudioBufferSourceNode.loopEnd}set loopEnd(l){this._nativeAudioBufferSourceNode.loopEnd=l}get loopStart(){return this._nativeAudioBufferSourceNode.loopStart}set loopStart(l){this._nativeAudioBufferSourceNode.loopStart=l}get onended(){return this._onended}set onended(l){const u=typeof l=="function"?o(this,l):null;this._nativeAudioBufferSourceNode.onended=u;const h=this._nativeAudioBufferSourceNode.onended;this._onended=h!==null&&h===u?l:h}get playbackRate(){return this._playbackRate}start(l=0,u=0,h){if(this._nativeAudioBufferSourceNode.start(l,u,h),this._audioBufferSourceNodeRenderer!==null&&(this._audioBufferSourceNodeRenderer.start=h===void 0?[l,u]:[l,u,h]),this.context.state!=="closed"){cA(this);const f=()=>{this._nativeAudioBufferSourceNode.removeEventListener("ended",f),d_(this)&&vk(this)};this._nativeAudioBufferSourceNode.addEventListener("ended",f)}}stop(l=0){this._nativeAudioBufferSourceNode.stop(l),this._audioBufferSourceNodeRenderer!==null&&(this._audioBufferSourceNodeRenderer.stop=l)}},pft=(t,e,n,i,r)=>()=>{const s=new WeakMap;let a=null,o=null;const c=async(l,u)=>{let h=n(l);const f=Tu(h,u);if(!f){const d={buffer:h.buffer,channelCount:h.channelCount,channelCountMode:h.channelCountMode,channelInterpretation:h.channelInterpretation,loop:h.loop,loopEnd:h.loopEnd,loopStart:h.loopStart,playbackRate:h.playbackRate.value};h=e(u,d),a!==null&&h.start(...a),o!==null&&h.stop(o)}return s.set(u,h),f?await t(u,l.playbackRate,h.playbackRate):await i(u,l.playbackRate,h.playbackRate),await r(l,u,h),h};return{set start(l){a=l},set stop(l){o=l},render(l,u){const h=s.get(u);return h!==void 0?Promise.resolve(h):c(l,u)}}},mft=t=>"playbackRate"in t,gft=t=>"frequency"in t&&"gain"in t,vft=t=>"offset"in t,_ft=t=>!("frequency"in t)&&"gain"in t,yft=t=>"detune"in t&&"frequency"in t&&!("gain"in t),bft=t=>"pan"in t,ah=t=>_m(kye,t),_k=t=>_m(Dye,t),o$=(t,e)=>{const{activeInputs:n}=ah(t);n.forEach(r=>r.forEach(([s])=>{e.includes(t)||o$(s,[...e,t])}));const i=mft(t)?[t.playbackRate]:Bye(t)?Array.from(t.parameters.values()):gft(t)?[t.Q,t.detune,t.frequency,t.gain]:vft(t)?[t.offset]:_ft(t)?[t.gain]:yft(t)?[t.detune,t.frequency]:bft(t)?[t.pan]:[];for(const r of i){const s=_k(r);s!==void 0&&s.activeInputs.forEach(([a])=>o$(a,e))}d_(t)&&vk(t)},zye=t=>{o$(t.destination,[])},Eft=t=>t===void 0||typeof t=="number"||typeof t=="string"&&(t==="balanced"||t==="interactive"||t==="playback"),Sft=(t,e,n,i,r,s,a,o,c)=>class extends t{constructor(u={}){if(c===null)throw new Error("Missing the native AudioContext constructor.");let h;try{h=new c(u)}catch(p){throw p.code===12&&p.message==="sampleRate is not in range"?n():p}if(h===null)throw i();if(!Eft(u.latencyHint))throw new TypeError(`The provided value '${u.latencyHint}' is not a valid enum value of type AudioContextLatencyCategory.`);if(u.sampleRate!==void 0&&h.sampleRate!==u.sampleRate)throw n();super(h,2);const{latencyHint:f}=u,{sampleRate:d}=h;if(this._baseLatency=typeof h.baseLatency=="number"?h.baseLatency:f==="balanced"?512/d:f==="interactive"||f===void 0?256/d:f==="playback"?1024/d:Math.max(2,Math.min(128,Math.round(f*d/128)))*128/d,this._nativeAudioContext=h,c.name==="webkitAudioContext"?(this._nativeGainNode=h.createGain(),this._nativeOscillatorNode=h.createOscillator(),this._nativeGainNode.gain.value=1e-37,this._nativeOscillatorNode.connect(this._nativeGainNode).connect(h.destination),this._nativeOscillatorNode.start()):(this._nativeGainNode=null,this._nativeOscillatorNode=null),this._state=null,h.state==="running"){this._state="suspended";const p=()=>{this._state==="suspended"&&(this._state=null),h.removeEventListener("statechange",p)};h.addEventListener("statechange",p)}}get baseLatency(){return this._baseLatency}get state(){return this._state!==null?this._state:this._nativeAudioContext.state}close(){return this.state==="closed"?this._nativeAudioContext.close().then(()=>{throw e()}):(this._state==="suspended"&&(this._state=null),this._nativeAudioContext.close().then(()=>{this._nativeGainNode!==null&&this._nativeOscillatorNode!==null&&(this._nativeOscillatorNode.stop(),this._nativeGainNode.disconnect(),this._nativeOscillatorNode.disconnect()),zye(this)}))}createMediaElementSource(u){return new r(this,{mediaElement:u})}createMediaStreamDestination(){return new s(this)}createMediaStreamSource(u){return new a(this,{mediaStream:u})}createMediaStreamTrackSource(u){return new o(this,{mediaStreamTrack:u})}resume(){return this._state==="suspended"?new Promise((u,h)=>{const f=()=>{this._nativeAudioContext.removeEventListener("statechange",f),this._nativeAudioContext.state==="running"?u():this.resume().then(u,h)};this._nativeAudioContext.addEventListener("statechange",f)}):this._nativeAudioContext.resume().catch(u=>{throw u===void 0||u.code===15?e():u})}suspend(){return this._nativeAudioContext.suspend().catch(u=>{throw u===void 0?e():u})}},Tft=(t,e,n,i,r,s,a,o)=>class extends t{constructor(l,u){const h=s(l),f=a(h),d=r(h,u,f),p=f?e(o):null;super(l,!1,d,p),this._isNodeOfNativeOfflineAudioContext=f,this._nativeAudioDestinationNode=d}get channelCount(){return this._nativeAudioDestinationNode.channelCount}set channelCount(l){if(this._isNodeOfNativeOfflineAudioContext)throw i();if(l>this._nativeAudioDestinationNode.maxChannelCount)throw n();this._nativeAudioDestinationNode.channelCount=l}get channelCountMode(){return this._nativeAudioDestinationNode.channelCountMode}set channelCountMode(l){if(this._isNodeOfNativeOfflineAudioContext)throw i();this._nativeAudioDestinationNode.channelCountMode=l}get maxChannelCount(){return this._nativeAudioDestinationNode.maxChannelCount}},xft=t=>{const e=new WeakMap,n=async(i,r)=>{const s=r.destination;return e.set(r,s),await t(i,r,s),s};return{render(i,r){const s=e.get(r);return s!==void 0?Promise.resolve(s):n(i,r)}}},wft=(t,e,n,i,r,s,a,o)=>(c,l)=>{const u=l.listener,h=()=>{const M=new Float32Array(1),R=e(l,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:9}),I=a(l);let k=!1,P=[0,0,-1,0,1,0],U=[0,0,0];const G=()=>{if(k)return;k=!0;const ie=i(l,256,9,0);ie.onaudioprocess=({inputBuffer:V})=>{const J=[s(V,M,0),s(V,M,1),s(V,M,2),s(V,M,3),s(V,M,4),s(V,M,5)];J.some((ee,oe)=>ee!==P[oe])&&(u.setOrientation(...J),P=J);const X=[s(V,M,6),s(V,M,7),s(V,M,8)];X.some((ee,oe)=>ee!==U[oe])&&(u.setPosition(...X),U=X)},R.connect(ie)},$=ie=>V=>{V!==P[ie]&&(P[ie]=V,u.setOrientation(...P))},q=ie=>V=>{V!==U[ie]&&(U[ie]=V,u.setPosition(...U))},Y=(ie,V,J)=>{const X=n(l,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:V});X.connect(R,0,ie),X.start(),Object.defineProperty(X.offset,"defaultValue",{get(){return V}});const ee=t({context:c},I,X.offset,eh,Vh);return o(ee,"value",oe=>()=>oe.call(ee),oe=>fe=>{try{oe.call(ee,fe)}catch(Re){if(Re.code!==9)throw Re}G(),I&&J(fe)}),ee.cancelAndHoldAtTime=(oe=>I?()=>{throw r()}:(...fe)=>{const Re=oe.apply(ee,fe);return G(),Re})(ee.cancelAndHoldAtTime),ee.cancelScheduledValues=(oe=>I?()=>{throw r()}:(...fe)=>{const Re=oe.apply(ee,fe);return G(),Re})(ee.cancelScheduledValues),ee.exponentialRampToValueAtTime=(oe=>I?()=>{throw r()}:(...fe)=>{const Re=oe.apply(ee,fe);return G(),Re})(ee.exponentialRampToValueAtTime),ee.linearRampToValueAtTime=(oe=>I?()=>{throw r()}:(...fe)=>{const Re=oe.apply(ee,fe);return G(),Re})(ee.linearRampToValueAtTime),ee.setTargetAtTime=(oe=>I?()=>{throw r()}:(...fe)=>{const Re=oe.apply(ee,fe);return G(),Re})(ee.setTargetAtTime),ee.setValueAtTime=(oe=>I?()=>{throw r()}:(...fe)=>{const Re=oe.apply(ee,fe);return G(),Re})(ee.setValueAtTime),ee.setValueCurveAtTime=(oe=>I?()=>{throw r()}:(...fe)=>{const Re=oe.apply(ee,fe);return G(),Re})(ee.setValueCurveAtTime),ee};return{forwardX:Y(0,0,$(0)),forwardY:Y(1,0,$(1)),forwardZ:Y(2,-1,$(2)),positionX:Y(6,0,q(0)),positionY:Y(7,0,q(1)),positionZ:Y(8,0,q(2)),upX:Y(3,0,$(3)),upY:Y(4,1,$(4)),upZ:Y(5,0,$(5))}},{forwardX:f,forwardY:d,forwardZ:p,positionX:g,positionY:y,positionZ:v,upX:b,upY:T,upZ:x}=u.forwardX===void 0?h():u;return{get forwardX(){return f},get forwardY(){return d},get forwardZ(){return p},get positionX(){return g},get positionY(){return y},get positionZ(){return v},get upX(){return b},get upY(){return T},get upZ(){return x}}},P3=t=>"context"in t,yk=t=>P3(t[0]),D1=(t,e,n,i)=>{for(const r of t)if(n(r)){if(i)return!1;throw Error("The set contains at least one similar element.")}return t.add(e),!0},ase=(t,e,[n,i],r)=>{D1(t,[e,n,i],s=>s[0]===e&&s[1]===n,r)},ose=(t,[e,n,i],r)=>{const s=t.get(e);s===void 0?t.set(e,new Set([[n,i]])):D1(s,[n,i],a=>a[0]===n,r)},qA=t=>"inputs"in t,L3=(t,e,n,i)=>{if(qA(e)){const r=e.inputs[i];return t.connect(r,n,0),[r,n,0]}return t.connect(e,n,i),[e,n,i]},Hye=(t,e,n)=>{for(const i of t)if(i[0]===e&&i[1]===n)return t.delete(i),i;return null},Cft=(t,e,n)=>Vz(t,i=>i[0]===e&&i[1]===n),jye=(t,e)=>{if(!gk(t).delete(e))throw new Error("Missing the expected event listener.")},Vye=(t,e,n)=>{const i=_m(t,e),r=Vz(i,s=>s[0]===n);return i.size===0&&t.delete(e),r},U3=(t,e,n,i)=>{qA(e)?t.disconnect(e.inputs[i],n,0):t.disconnect(e,n,i)},Ta=t=>_m(RX,t),ON=t=>_m(MX,t),a1=t=>i$.has(t),F2=t=>!oA.has(t),cse=(t,e)=>new Promise(n=>{if(e!==null)n(!0);else{const i=t.createScriptProcessor(256,1,1),r=t.createGain(),s=t.createBuffer(1,2,44100),a=s.getChannelData(0);a[0]=1,a[1]=1;const o=t.createBufferSource();o.buffer=s,o.loop=!0,o.connect(i).connect(t.destination),o.connect(r),o.disconnect(r),i.onaudioprocess=c=>{const l=c.inputBuffer.getChannelData(0);Array.prototype.some.call(l,u=>u===1)?n(!0):n(!1),o.stop(),i.onaudioprocess=null,o.disconnect(i),i.disconnect(t.destination)},o.start()}}),Tj=(t,e)=>{const n=new Map;for(const i of t)for(const r of i){const s=n.get(r);n.set(r,s===void 0?1:s+1)}n.forEach((i,r)=>e(r,i))},B3=t=>"context"in t,Aft=t=>{const e=new Map;t.connect=(n=>(i,r=0,s=0)=>{const a=B3(i)?n(i,r,s):n(i,r),o=e.get(i);return o===void 0?e.set(i,[{input:s,output:r}]):o.every(c=>c.input!==s||c.output!==r)&&o.push({input:s,output:r}),a})(t.connect.bind(t)),t.disconnect=(n=>(i,r,s)=>{if(n.apply(t),i===void 0)e.clear();else if(typeof i=="number")for(const[a,o]of e){const c=o.filter(l=>l.output!==i);c.length===0?e.delete(a):e.set(a,c)}else if(e.has(i))if(r===void 0)e.delete(i);else{const a=e.get(i);if(a!==void 0){const o=a.filter(c=>c.output!==r&&(c.input!==s||s===void 0));o.length===0?e.delete(i):e.set(i,o)}}for(const[a,o]of e)o.forEach(c=>{B3(a)?t.connect(a,c.output,c.input):t.connect(a,c.output)})})(t.disconnect)},Rft=(t,e,n,i)=>{const{activeInputs:r,passiveInputs:s}=_k(e),{outputs:a}=ah(t),o=gk(t),c=l=>{const u=Ta(t),h=ON(e);if(l){const f=Vye(s,t,n);ase(r,t,f,!1),!i&&!a1(t)&&u.connect(h,n)}else{const f=Cft(r,t,n);ose(s,f,!1),!i&&!a1(t)&&u.disconnect(h,n)}};return D1(a,[e,n],l=>l[0]===e&&l[1]===n,!0)?(o.add(c),d_(t)?ase(r,t,[n,c],!0):ose(s,[t,n,c],!0),!0):!1},Mft=(t,e,n,i)=>{const{activeInputs:r,passiveInputs:s}=ah(e),a=Hye(r[i],t,n);return a===null?[Uye(s,t,n,i)[2],!1]:[a[2],!0]},Oft=(t,e,n)=>{const{activeInputs:i,passiveInputs:r}=_k(e),s=Hye(i,t,n);return s===null?[Vye(r,t,n)[1],!1]:[s[2],!0]},NX=(t,e,n,i,r)=>{const[s,a]=Mft(t,n,i,r);if(s!==null&&(jye(t,s),a&&!e&&!a1(t)&&U3(Ta(t),Ta(n),i,r)),d_(n)){const{activeInputs:o}=ah(n);a$(n,o)}},IX=(t,e,n,i)=>{const[r,s]=Oft(t,n,i);r!==null&&(jye(t,r),s&&!e&&!a1(t)&&Ta(t).disconnect(ON(n),i))},Nft=(t,e)=>{const n=ah(t),i=[];for(const r of n.outputs)yk(r)?NX(t,e,...r):IX(t,e,...r),i.push(r[0]);return n.outputs.clear(),i},Ift=(t,e,n)=>{const i=ah(t),r=[];for(const s of i.outputs)s[1]===n&&(yk(s)?NX(t,e,...s):IX(t,e,...s),r.push(s[0]),i.outputs.delete(s));return r},kft=(t,e,n,i,r)=>{const s=ah(t);return Array.from(s.outputs).filter(a=>a[0]===n&&(i===void 0||a[1]===i)&&(r===void 0||a[2]===r)).map(a=>(yk(a)?NX(t,e,...a):IX(t,e,...a),s.outputs.delete(a),a[0]))},Dft=(t,e,n,i,r,s,a,o,c,l,u,h,f,d,p,g)=>class extends l{constructor(v,b,T,x){super(T),this._context=v,this._nativeAudioNode=T;const M=u(v);h(M)&&n(cse,()=>cse(M,g))!==!0&&Aft(T),RX.set(this,T),Pye.set(this,new Set),v.state!=="closed"&&b&&cA(this),t(this,x,T)}get channelCount(){return this._nativeAudioNode.channelCount}set channelCount(v){this._nativeAudioNode.channelCount=v}get channelCountMode(){return this._nativeAudioNode.channelCountMode}set channelCountMode(v){this._nativeAudioNode.channelCountMode=v}get channelInterpretation(){return this._nativeAudioNode.channelInterpretation}set channelInterpretation(v){this._nativeAudioNode.channelInterpretation=v}get context(){return this._context}get numberOfInputs(){return this._nativeAudioNode.numberOfInputs}get numberOfOutputs(){return this._nativeAudioNode.numberOfOutputs}connect(v,b=0,T=0){if(b<0||b>=this._nativeAudioNode.numberOfOutputs)throw r();const x=u(this._context),M=p(x);if(f(v)||d(v))throw s();if(P3(v)){const k=Ta(v);try{const U=L3(this._nativeAudioNode,k,b,T),G=F2(this);(M||G)&&this._nativeAudioNode.disconnect(...U),this.context.state!=="closed"&&!G&&F2(v)&&cA(v)}catch(U){throw U.code===12?s():U}if(e(this,v,b,T,M)){const U=c([this],v);Tj(U,i(M))}return v}const R=ON(v);if(R.name==="playbackRate"&&R.maxValue===1024)throw a();try{this._nativeAudioNode.connect(R,b),(M||F2(this))&&this._nativeAudioNode.disconnect(R,b)}catch(k){throw k.code===12?s():k}if(Rft(this,v,b,M)){const k=c([this],v);Tj(k,i(M))}}disconnect(v,b,T){let x;const M=u(this._context),R=p(M);if(v===void 0)x=Nft(this,R);else if(typeof v=="number"){if(v<0||v>=this.numberOfOutputs)throw r();x=Ift(this,R,v)}else{if(b!==void 0&&(b<0||b>=this.numberOfOutputs)||P3(v)&&T!==void 0&&(T<0||T>=v.numberOfInputs))throw r();if(x=kft(this,R,v,b,T),x.length===0)throw s()}for(const I of x){const k=c([this],I);Tj(k,o)}}},Pft=(t,e,n,i,r,s,a,o,c,l,u,h,f)=>(d,p,g,y=null,v=null)=>{const b=g.value,T=new qht(b),x=p?i(T):null,M={get defaultValue(){return b},get maxValue(){return y===null?g.maxValue:y},get minValue(){return v===null?g.minValue:v},get value(){return g.value},set value(R){g.value=R,M.setValueAtTime(R,d.context.currentTime)},cancelAndHoldAtTime(R){if(typeof g.cancelAndHoldAtTime=="function")x===null&&T.flush(d.context.currentTime),T.add(r(R)),g.cancelAndHoldAtTime(R);else{const I=Array.from(T).pop();x===null&&T.flush(d.context.currentTime),T.add(r(R));const k=Array.from(T).pop();g.cancelScheduledValues(R),I!==k&&k!==void 0&&(k.type==="exponentialRampToValue"?g.exponentialRampToValueAtTime(k.value,k.endTime):k.type==="linearRampToValue"?g.linearRampToValueAtTime(k.value,k.endTime):k.type==="setValue"?g.setValueAtTime(k.value,k.startTime):k.type==="setValueCurve"&&g.setValueCurveAtTime(k.values,k.startTime,k.duration))}return M},cancelScheduledValues(R){return x===null&&T.flush(d.context.currentTime),T.add(s(R)),g.cancelScheduledValues(R),M},exponentialRampToValueAtTime(R,I){if(R===0)throw new RangeError;if(!Number.isFinite(I)||I<0)throw new RangeError;const k=d.context.currentTime;return x===null&&T.flush(k),Array.from(T).length===0&&(T.add(l(b,k)),g.setValueAtTime(b,k)),T.add(a(R,I)),g.exponentialRampToValueAtTime(R,I),M},linearRampToValueAtTime(R,I){const k=d.context.currentTime;return x===null&&T.flush(k),Array.from(T).length===0&&(T.add(l(b,k)),g.setValueAtTime(b,k)),T.add(o(R,I)),g.linearRampToValueAtTime(R,I),M},setTargetAtTime(R,I,k){return x===null&&T.flush(d.context.currentTime),T.add(c(R,I,k)),g.setTargetAtTime(R,I,k),M},setValueAtTime(R,I){return x===null&&T.flush(d.context.currentTime),T.add(l(R,I)),g.setValueAtTime(R,I),M},setValueCurveAtTime(R,I,k){const P=R instanceof Float32Array?R:new Float32Array(R);if(h!==null&&h.name==="webkitAudioContext"){const U=I+k,G=d.context.sampleRate,$=Math.ceil(I*G),q=Math.floor(U*G),Y=q-$,ie=new Float32Array(Y);for(let J=0;J<Y;J+=1){const X=(P.length-1)/k*(($+J)/G-I),ee=Math.floor(X),oe=Math.ceil(X);ie[J]=ee===oe?P[ee]:(1-(X-ee))*P[ee]+(1-(oe-X))*P[oe]}x===null&&T.flush(d.context.currentTime),T.add(u(ie,I,k)),g.setValueCurveAtTime(ie,I,k);const V=q/G;V<U&&f(M,ie[ie.length-1],V),f(M,P[P.length-1],U)}else x===null&&T.flush(d.context.currentTime),T.add(u(P,I,k)),g.setValueCurveAtTime(P,I,k);return M}};return n.set(M,g),e.set(M,d),t(M,x),M},Lft=t=>({replay(e){for(const n of t)if(n.type==="exponentialRampToValue"){const{endTime:i,value:r}=n;e.exponentialRampToValueAtTime(r,i)}else if(n.type==="linearRampToValue"){const{endTime:i,value:r}=n;e.linearRampToValueAtTime(r,i)}else if(n.type==="setTarget"){const{startTime:i,target:r,timeConstant:s}=n;e.setTargetAtTime(r,i,s)}else if(n.type==="setValue"){const{startTime:i,value:r}=n;e.setValueAtTime(r,i)}else if(n.type==="setValueCurve"){const{duration:i,startTime:r,values:s}=n;e.setValueCurveAtTime(s,r,i)}else throw new Error("Can't apply an unknown automation.")}});class Gye{constructor(e){this._map=new Map(e)}get size(){return this._map.size}entries(){return this._map.entries()}forEach(e,n=null){return this._map.forEach((i,r)=>e.call(n,i,r,this))}get(e){return this._map.get(e)}has(e){return this._map.has(e)}keys(){return this._map.keys()}values(){return this._map.values()}}const Uft={channelCount:2,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:1,numberOfOutputs:1,parameterData:{},processorOptions:{}},Bft=(t,e,n,i,r,s,a,o,c,l,u,h,f,d)=>class extends e{constructor(g,y,v){var b;const T=o(g),x=c(T),M=u({...Uft,...v});f(M);const R=r$.get(T),I=R==null?void 0:R.get(y),k=x||T.state!=="closed"?T:(b=a(T))!==null&&b!==void 0?b:T,P=r(k,x?null:g.baseLatency,l,y,I,M),U=x?i(y,M,I):null;super(g,!0,P,U);const G=[];P.parameters.forEach((q,Y)=>{const ie=n(this,x,q);G.push([Y,ie])}),this._nativeAudioWorkletNode=P,this._onprocessorerror=null,this._parameters=new Gye(G),x&&t(T,this);const{activeInputs:$}=s(this);h(P,$)}get onprocessorerror(){return this._onprocessorerror}set onprocessorerror(g){const y=typeof g=="function"?d(this,g):null;this._nativeAudioWorkletNode.onprocessorerror=y;const v=this._nativeAudioWorkletNode.onprocessorerror;this._onprocessorerror=v!==null&&v===y?g:v}get parameters(){return this._parameters===null?this._nativeAudioWorkletNode.parameters:this._parameters}get port(){return this._nativeAudioWorkletNode.port}};function F3(t,e,n,i,r){if(typeof t.copyFromChannel=="function")e[n].byteLength===0&&(e[n]=new Float32Array(128)),t.copyFromChannel(e[n],i,r);else{const s=t.getChannelData(i);if(e[n].byteLength===0)e[n]=s.slice(r,r+128);else{const a=new Float32Array(s.buffer,r*Float32Array.BYTES_PER_ELEMENT,128);e[n].set(a)}}}const qye=(t,e,n,i,r)=>{typeof t.copyToChannel=="function"?e[n].byteLength!==0&&t.copyToChannel(e[n],i,r):e[n].byteLength!==0&&t.getChannelData(i).set(e[n],r)},z3=(t,e)=>{const n=[];for(let i=0;i<t;i+=1){const r=[],s=typeof e=="number"?e:e[i];for(let a=0;a<s;a+=1)r.push(new Float32Array(128));n.push(r)}return n},Fft=(t,e)=>{const n=_m(s$,t),i=Ta(e);return _m(n,i)},zft=async(t,e,n,i,r,s,a)=>{const o=e===null?Math.ceil(t.context.length/128)*128:e.length,c=i.channelCount*i.numberOfInputs,l=r.reduce((y,v)=>y+v,0),u=l===0?null:n.createBuffer(l,o,n.sampleRate);if(s===void 0)throw new Error("Missing the processor constructor.");const h=ah(t),f=await Fft(n,t),d=z3(i.numberOfInputs,i.channelCount),p=z3(i.numberOfOutputs,r),g=Array.from(t.parameters.keys()).reduce((y,v)=>({...y,[v]:new Float32Array(128)}),{});for(let y=0;y<o;y+=128){if(i.numberOfInputs>0&&e!==null)for(let v=0;v<i.numberOfInputs;v+=1)for(let b=0;b<i.channelCount;b+=1)F3(e,d[v],b,b,y);s.parameterDescriptors!==void 0&&e!==null&&s.parameterDescriptors.forEach(({name:v},b)=>{F3(e,g,v,c+b,y)});for(let v=0;v<i.numberOfInputs;v+=1)for(let b=0;b<r[v];b+=1)p[v][b].byteLength===0&&(p[v][b]=new Float32Array(128));try{const v=d.map((T,x)=>h.activeInputs[x].size===0?[]:T),b=a(y/n.sampleRate,n.sampleRate,()=>f.process(v,p,g));if(u!==null)for(let T=0,x=0;T<i.numberOfOutputs;T+=1){for(let M=0;M<r[T];M+=1)qye(u,p[T],M,x+M,y);x+=r[T]}if(!b)break}catch(v){t.dispatchEvent(new ErrorEvent("processorerror",{colno:v.colno,filename:v.filename,lineno:v.lineno,message:v.message}));break}}return u},Hft=(t,e,n,i,r,s,a,o,c,l,u,h,f,d,p,g)=>(y,v,b)=>{const T=new WeakMap;let x=null;const M=async(R,I)=>{let k=u(R),P=null;const U=Tu(k,I),G=Array.isArray(v.outputChannelCount)?v.outputChannelCount:Array.from(v.outputChannelCount);if(h===null){const $=G.reduce((V,J)=>V+J,0),q=r(I,{channelCount:Math.max(1,$),channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:Math.max(1,$)}),Y=[];for(let V=0;V<R.numberOfOutputs;V+=1)Y.push(i(I,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:G[V]}));const ie=a(I,{channelCount:v.channelCount,channelCountMode:v.channelCountMode,channelInterpretation:v.channelInterpretation,gain:1});ie.connect=e.bind(null,Y),ie.disconnect=c.bind(null,Y),P=[q,Y,ie]}else U||(k=new h(I,y));if(T.set(I,P===null?k:P[2]),P!==null){if(x===null){if(b===void 0)throw new Error("Missing the processor constructor.");if(f===null)throw new Error("Missing the native OfflineAudioContext constructor.");const J=R.channelCount*R.numberOfInputs,X=b.parameterDescriptors===void 0?0:b.parameterDescriptors.length,ee=J+X;x=zft(R,ee===0?null:await(async()=>{const fe=new f(ee,Math.ceil(R.context.length/128)*128,I.sampleRate),Re=[],He=[];for(let we=0;we<v.numberOfInputs;we+=1)Re.push(a(fe,{channelCount:v.channelCount,channelCountMode:v.channelCountMode,channelInterpretation:v.channelInterpretation,gain:1})),He.push(r(fe,{channelCount:v.channelCount,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:v.channelCount}));const Te=await Promise.all(Array.from(R.parameters.values()).map(async we=>{const Ce=s(fe,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:we.value});return await d(fe,we,Ce.offset),Ce})),Le=i(fe,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:Math.max(1,J+X)});for(let we=0;we<v.numberOfInputs;we+=1){Re[we].connect(He[we]);for(let Ce=0;Ce<v.channelCount;Ce+=1)He[we].connect(Le,Ce,we*v.channelCount+Ce)}for(const[we,Ce]of Te.entries())Ce.connect(Le,0,J+we),Ce.start(0);return Le.connect(fe.destination),await Promise.all(Re.map(we=>p(R,fe,we))),g(fe)})(),I,v,G,b,l)}const $=await x,q=n(I,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}),[Y,ie,V]=P;$!==null&&(q.buffer=$,q.start(0)),q.connect(Y);for(let J=0,X=0;J<R.numberOfOutputs;J+=1){const ee=ie[J];for(let oe=0;oe<G[J];oe+=1)Y.connect(ee,X+oe,oe);X+=G[J]}return V}if(U)for(const[$,q]of R.parameters.entries())await t(I,q,k.parameters.get($));else for(const[$,q]of R.parameters.entries())await d(I,q,k.parameters.get($));return await p(R,I,k),k};return{render(R,I){o(I,R);const k=T.get(I);return k!==void 0?Promise.resolve(k):M(R,I)}}},jft=(t,e,n,i,r,s,a,o,c,l,u,h,f,d,p,g,y,v,b,T)=>class extends p{constructor(M,R){super(M,R),this._nativeContext=M,this._audioWorklet=t===void 0?void 0:{addModule:(I,k)=>t(this,I,k)}}get audioWorklet(){return this._audioWorklet}createAnalyser(){return new e(this)}createBiquadFilter(){return new r(this)}createBuffer(M,R,I){return new n({length:R,numberOfChannels:M,sampleRate:I})}createBufferSource(){return new i(this)}createChannelMerger(M=6){return new s(this,{numberOfInputs:M})}createChannelSplitter(M=6){return new a(this,{numberOfOutputs:M})}createConstantSource(){return new o(this)}createConvolver(){return new c(this)}createDelay(M=1){return new u(this,{maxDelayTime:M})}createDynamicsCompressor(){return new h(this)}createGain(){return new f(this)}createIIRFilter(M,R){return new d(this,{feedback:R,feedforward:M})}createOscillator(){return new g(this)}createPanner(){return new y(this)}createPeriodicWave(M,R,I={disableNormalization:!1}){return new v(this,{...I,imag:R,real:M})}createStereoPanner(){return new b(this)}createWaveShaper(){return new T(this)}decodeAudioData(M,R,I){return l(this._nativeContext,M).then(k=>(typeof R=="function"&&R(k),k),k=>{throw typeof I=="function"&&I(k),k})}},Vft={Q:1,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",detune:0,frequency:350,gain:0,type:"lowpass"},Gft=(t,e,n,i,r,s,a,o)=>class extends t{constructor(l,u){const h=s(l),f={...Vft,...u},d=r(h,f),p=a(h),g=p?n():null;super(l,!1,d,g),this._Q=e(this,p,d.Q,eh,Vh),this._detune=e(this,p,d.detune,1200*Math.log2(eh),-1200*Math.log2(eh)),this._frequency=e(this,p,d.frequency,l.sampleRate/2,0),this._gain=e(this,p,d.gain,40*Math.log10(eh),Vh),this._nativeBiquadFilterNode=d,o(this,1)}get detune(){return this._detune}get frequency(){return this._frequency}get gain(){return this._gain}get Q(){return this._Q}get type(){return this._nativeBiquadFilterNode.type}set type(l){this._nativeBiquadFilterNode.type=l}getFrequencyResponse(l,u,h){try{this._nativeBiquadFilterNode.getFrequencyResponse(l,u,h)}catch(f){throw f.code===11?i():f}if(l.length!==u.length||u.length!==h.length)throw i()}},qft=(t,e,n,i,r)=>()=>{const s=new WeakMap,a=async(o,c)=>{let l=n(o);const u=Tu(l,c);if(!u){const h={Q:l.Q.value,channelCount:l.channelCount,channelCountMode:l.channelCountMode,channelInterpretation:l.channelInterpretation,detune:l.detune.value,frequency:l.frequency.value,gain:l.gain.value,type:l.type};l=e(c,h)}return s.set(c,l),u?(await t(c,o.Q,l.Q),await t(c,o.detune,l.detune),await t(c,o.frequency,l.frequency),await t(c,o.gain,l.gain)):(await i(c,o.Q,l.Q),await i(c,o.detune,l.detune),await i(c,o.frequency,l.frequency),await i(c,o.gain,l.gain)),await r(o,c,l),l};return{render(o,c){const l=s.get(c);return l!==void 0?Promise.resolve(l):a(o,c)}}},$ft=(t,e)=>(n,i)=>{const r=e.get(n);if(r!==void 0)return r;const s=t.get(n);if(s!==void 0)return s;try{const a=i();return a instanceof Promise?(t.set(n,a),a.catch(()=>!1).then(o=>(t.delete(n),e.set(n,o),o))):(e.set(n,a),a)}catch{return e.set(n,!1),!1}},Wft={channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:6},Yft=(t,e,n,i,r)=>class extends t{constructor(a,o){const c=i(a),l={...Wft,...o},u=n(c,l),h=r(c)?e():null;super(a,!1,u,h)}},Xft=(t,e,n)=>()=>{const i=new WeakMap,r=async(s,a)=>{let o=e(s);if(!Tu(o,a)){const l={channelCount:o.channelCount,channelCountMode:o.channelCountMode,channelInterpretation:o.channelInterpretation,numberOfInputs:o.numberOfInputs};o=t(a,l)}return i.set(a,o),await n(s,a,o),o};return{render(s,a){const o=i.get(a);return o!==void 0?Promise.resolve(o):r(s,a)}}},Kft={channelCount:6,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:6},Zft=(t,e,n,i,r,s)=>class extends t{constructor(o,c){const l=i(o),u=s({...Kft,...c}),h=n(l,u),f=r(l)?e():null;super(o,!1,h,f)}},Jft=(t,e,n)=>()=>{const i=new WeakMap,r=async(s,a)=>{let o=e(s);if(!Tu(o,a)){const l={channelCount:o.channelCount,channelCountMode:o.channelCountMode,channelInterpretation:o.channelInterpretation,numberOfOutputs:o.numberOfOutputs};o=t(a,l)}return i.set(a,o),await n(s,a,o),o};return{render(s,a){const o=i.get(a);return o!==void 0?Promise.resolve(o):r(s,a)}}},Qft=t=>(e,n,i)=>t(n,e,i),edt=t=>(e,n,i=0,r=0)=>{const s=e[i];if(s===void 0)throw t();return B3(n)?s.connect(n,0,r):s.connect(n,0)},tdt=t=>(e,n)=>{const i=t(e,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}),r=e.createBuffer(1,2,44100);return i.buffer=r,i.loop=!0,i.connect(n),i.start(),()=>{i.stop(),i.disconnect(n)}},ndt={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",offset:1},idt=(t,e,n,i,r,s,a)=>class extends t{constructor(c,l){const u=r(c),h={...ndt,...l},f=i(u,h),d=s(u),p=d?n():null;super(c,!1,f,p),this._constantSourceNodeRenderer=p,this._nativeConstantSourceNode=f,this._offset=e(this,d,f.offset,eh,Vh),this._onended=null}get offset(){return this._offset}get onended(){return this._onended}set onended(c){const l=typeof c=="function"?a(this,c):null;this._nativeConstantSourceNode.onended=l;const u=this._nativeConstantSourceNode.onended;this._onended=u!==null&&u===l?c:u}start(c=0){if(this._nativeConstantSourceNode.start(c),this._constantSourceNodeRenderer!==null&&(this._constantSourceNodeRenderer.start=c),this.context.state!=="closed"){cA(this);const l=()=>{this._nativeConstantSourceNode.removeEventListener("ended",l),d_(this)&&vk(this)};this._nativeConstantSourceNode.addEventListener("ended",l)}}stop(c=0){this._nativeConstantSourceNode.stop(c),this._constantSourceNodeRenderer!==null&&(this._constantSourceNodeRenderer.stop=c)}},rdt=(t,e,n,i,r)=>()=>{const s=new WeakMap;let a=null,o=null;const c=async(l,u)=>{let h=n(l);const f=Tu(h,u);if(!f){const d={channelCount:h.channelCount,channelCountMode:h.channelCountMode,channelInterpretation:h.channelInterpretation,offset:h.offset.value};h=e(u,d),a!==null&&h.start(a),o!==null&&h.stop(o)}return s.set(u,h),f?await t(u,l.offset,h.offset):await i(u,l.offset,h.offset),await r(l,u,h),h};return{set start(l){a=l},set stop(l){o=l},render(l,u){const h=s.get(u);return h!==void 0?Promise.resolve(h):c(l,u)}}},sdt=t=>e=>(t[0]=e,t[0]),adt={buffer:null,channelCount:2,channelCountMode:"clamped-max",channelInterpretation:"speakers",disableNormalization:!1},odt=(t,e,n,i,r,s)=>class extends t{constructor(o,c){const l=i(o),u={...adt,...c},h=n(l,u),d=r(l)?e():null;super(o,!1,h,d),this._isBufferNullified=!1,this._nativeConvolverNode=h,u.buffer!==null&&s(this,u.buffer.duration)}get buffer(){return this._isBufferNullified?null:this._nativeConvolverNode.buffer}set buffer(o){if(this._nativeConvolverNode.buffer=o,o===null&&this._nativeConvolverNode.buffer!==null){const c=this._nativeConvolverNode.context;this._nativeConvolverNode.buffer=c.createBuffer(1,1,c.sampleRate),this._isBufferNullified=!0,s(this,0)}else this._isBufferNullified=!1,s(this,this._nativeConvolverNode.buffer===null?0:this._nativeConvolverNode.buffer.duration)}get normalize(){return this._nativeConvolverNode.normalize}set normalize(o){this._nativeConvolverNode.normalize=o}},cdt=(t,e,n)=>()=>{const i=new WeakMap,r=async(s,a)=>{let o=e(s);if(!Tu(o,a)){const l={buffer:o.buffer,channelCount:o.channelCount,channelCountMode:o.channelCountMode,channelInterpretation:o.channelInterpretation,disableNormalization:!o.normalize};o=t(a,l)}return i.set(a,o),qA(o)?await n(s,a,o.inputs[0]):await n(s,a,o),o};return{render(s,a){const o=i.get(a);return o!==void 0?Promise.resolve(o):r(s,a)}}},ldt=(t,e)=>(n,i,r)=>{if(e===null)throw new Error("Missing the native OfflineAudioContext constructor.");try{return new e(n,i,r)}catch(s){throw s.name==="SyntaxError"?t():s}},udt=()=>new DOMException("","DataCloneError"),lse=t=>{const{port1:e,port2:n}=new MessageChannel;return new Promise(i=>{const r=()=>{n.onmessage=null,e.close(),n.close(),i()};n.onmessage=()=>r();try{e.postMessage(t,[t])}catch{}finally{r()}})},hdt=(t,e,n,i,r,s,a,o,c,l,u)=>(h,f)=>{const d=a(h)?h:s(h);if(r.has(f)){const p=n();return Promise.reject(p)}try{r.add(f)}catch{}return e(c,()=>c(d))?d.decodeAudioData(f).then(p=>(lse(f).catch(()=>{}),e(o,()=>o(p))||u(p),t.add(p),p)):new Promise((p,g)=>{const y=async()=>{try{await lse(f)}catch{}},v=b=>{g(b),y()};try{d.decodeAudioData(f,b=>{typeof b.copyFromChannel!="function"&&(l(b),OX(b)),t.add(b),y().then(()=>p(b))},b=>{v(b===null?i():b)})}catch(b){v(b)}})},fdt=(t,e,n,i,r,s,a,o)=>(c,l)=>{const u=e.get(c);if(u===void 0)throw new Error("Missing the expected cycle count.");const h=s(c.context),f=o(h);if(u===l){if(e.delete(c),!f&&a(c)){const d=i(c),{outputs:p}=n(c);for(const g of p)if(yk(g)){const y=i(g[0]);t(d,y,g[1],g[2])}else{const y=r(g[0]);d.connect(y,g[1])}}}else e.set(c,u-l)},ddt={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",delayTime:0,maxDelayTime:1},pdt=(t,e,n,i,r,s,a)=>class extends t{constructor(c,l){const u=r(c),h={...ddt,...l},f=i(u,h),d=s(u),p=d?n(h.maxDelayTime):null;super(c,!1,f,p),this._delayTime=e(this,d,f.delayTime),a(this,h.maxDelayTime)}get delayTime(){return this._delayTime}},mdt=(t,e,n,i,r)=>s=>{const a=new WeakMap,o=async(c,l)=>{let u=n(c);const h=Tu(u,l);if(!h){const f={channelCount:u.channelCount,channelCountMode:u.channelCountMode,channelInterpretation:u.channelInterpretation,delayTime:u.delayTime.value,maxDelayTime:s};u=e(l,f)}return a.set(l,u),h?await t(l,c.delayTime,u.delayTime):await i(l,c.delayTime,u.delayTime),await r(c,l,u),u};return{render(c,l){const u=a.get(l);return u!==void 0?Promise.resolve(u):o(c,l)}}},gdt=t=>(e,n,i,r)=>t(e[r],s=>s[0]===n&&s[1]===i),vdt=t=>(e,n)=>{t(e).delete(n)},_dt=t=>"delayTime"in t,ydt=(t,e,n)=>function i(r,s){const a=P3(s)?s:n(t,s);if(_dt(a))return[];if(r[0]===a)return[r];if(r.includes(a))return[];const{outputs:o}=e(a);return Array.from(o).map(c=>i([...r,a],c[0])).reduce((c,l)=>c.concat(l),[])},BP=(t,e,n)=>{const i=e[n];if(i===void 0)throw t();return i},bdt=t=>(e,n=void 0,i=void 0,r=0)=>n===void 0?e.forEach(s=>s.disconnect()):typeof n=="number"?BP(t,e,n).disconnect():B3(n)?i===void 0?e.forEach(s=>s.disconnect(n)):r===void 0?BP(t,e,i).disconnect(n,0):BP(t,e,i).disconnect(n,0,r):i===void 0?e.forEach(s=>s.disconnect(n)):BP(t,e,i).disconnect(n,0),Edt={attack:.003,channelCount:2,channelCountMode:"clamped-max",channelInterpretation:"speakers",knee:30,ratio:12,release:.25,threshold:-24},Sdt=(t,e,n,i,r,s,a,o)=>class extends t{constructor(l,u){const h=s(l),f={...Edt,...u},d=i(h,f),p=a(h),g=p?n():null;super(l,!1,d,g),this._attack=e(this,p,d.attack),this._knee=e(this,p,d.knee),this._nativeDynamicsCompressorNode=d,this._ratio=e(this,p,d.ratio),this._release=e(this,p,d.release),this._threshold=e(this,p,d.threshold),o(this,.006)}get attack(){return this._attack}get channelCount(){return this._nativeDynamicsCompressorNode.channelCount}set channelCount(l){const u=this._nativeDynamicsCompressorNode.channelCount;if(this._nativeDynamicsCompressorNode.channelCount=l,l>2)throw this._nativeDynamicsCompressorNode.channelCount=u,r()}get channelCountMode(){return this._nativeDynamicsCompressorNode.channelCountMode}set channelCountMode(l){const u=this._nativeDynamicsCompressorNode.channelCountMode;if(this._nativeDynamicsCompressorNode.channelCountMode=l,l==="max")throw this._nativeDynamicsCompressorNode.channelCountMode=u,r()}get knee(){return this._knee}get ratio(){return this._ratio}get reduction(){return typeof this._nativeDynamicsCompressorNode.reduction.value=="number"?this._nativeDynamicsCompressorNode.reduction.value:this._nativeDynamicsCompressorNode.reduction}get release(){return this._release}get threshold(){return this._threshold}},Tdt=(t,e,n,i,r)=>()=>{const s=new WeakMap,a=async(o,c)=>{let l=n(o);const u=Tu(l,c);if(!u){const h={attack:l.attack.value,channelCount:l.channelCount,channelCountMode:l.channelCountMode,channelInterpretation:l.channelInterpretation,knee:l.knee.value,ratio:l.ratio.value,release:l.release.value,threshold:l.threshold.value};l=e(c,h)}return s.set(c,l),u?(await t(c,o.attack,l.attack),await t(c,o.knee,l.knee),await t(c,o.ratio,l.ratio),await t(c,o.release,l.release),await t(c,o.threshold,l.threshold)):(await i(c,o.attack,l.attack),await i(c,o.knee,l.knee),await i(c,o.ratio,l.ratio),await i(c,o.release,l.release),await i(c,o.threshold,l.threshold)),await r(o,c,l),l};return{render(o,c){const l=s.get(c);return l!==void 0?Promise.resolve(l):a(o,c)}}},xdt=()=>new DOMException("","EncodingError"),wdt=t=>e=>new Promise((n,i)=>{if(t===null){i(new SyntaxError);return}const r=t.document.head;if(r===null)i(new SyntaxError);else{const s=t.document.createElement("script"),a=new Blob([e],{type:"application/javascript"}),o=URL.createObjectURL(a),c=t.onerror,l=()=>{t.onerror=c,URL.revokeObjectURL(o)};t.onerror=(u,h,f,d,p)=>{if(h===o||h===t.location.href&&f===1&&d===1)return l(),i(p),!1;if(c!==null)return c(u,h,f,d,p)},s.onerror=()=>{l(),i(new SyntaxError)},s.onload=()=>{l(),n()},s.src=o,s.type="module",r.appendChild(s)}}),Cdt=t=>class{constructor(n){this._nativeEventTarget=n,this._listeners=new WeakMap}addEventListener(n,i,r){if(i!==null){let s=this._listeners.get(i);s===void 0&&(s=t(this,i),typeof i=="function"&&this._listeners.set(i,s)),this._nativeEventTarget.addEventListener(n,s,r)}}dispatchEvent(n){return this._nativeEventTarget.dispatchEvent(n)}removeEventListener(n,i,r){const s=i===null?void 0:this._listeners.get(i);this._nativeEventTarget.removeEventListener(n,s===void 0?null:s,r)}},Adt=t=>(e,n,i)=>{Object.defineProperties(t,{currentFrame:{configurable:!0,get(){return Math.round(e*n)}},currentTime:{configurable:!0,get(){return e}}});try{return i()}finally{t!==null&&(delete t.currentFrame,delete t.currentTime)}},Rdt=t=>async e=>{try{const n=await fetch(e);if(n.ok)return[await n.text(),n.url]}catch{}throw t()},Mdt={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",gain:1},Odt=(t,e,n,i,r,s)=>class extends t{constructor(o,c){const l=r(o),u={...Mdt,...c},h=i(l,u),f=s(l),d=f?n():null;super(o,!1,h,d),this._gain=e(this,f,h.gain,eh,Vh)}get gain(){return this._gain}},Ndt=(t,e,n,i,r)=>()=>{const s=new WeakMap,a=async(o,c)=>{let l=n(o);const u=Tu(l,c);if(!u){const h={channelCount:l.channelCount,channelCountMode:l.channelCountMode,channelInterpretation:l.channelInterpretation,gain:l.gain.value};l=e(c,h)}return s.set(c,l),u?await t(c,o.gain,l.gain):await i(c,o.gain,l.gain),await r(o,c,l),l};return{render(o,c){const l=s.get(c);return l!==void 0?Promise.resolve(l):a(o,c)}}},Idt=(t,e)=>n=>e(t,n),kdt=t=>e=>{const n=t(e);if(n.renderer===null)throw new Error("Missing the renderer of the given AudioNode in the audio graph.");return n.renderer},Ddt=t=>e=>{var n;return(n=t.get(e))!==null&&n!==void 0?n:0},Pdt=t=>e=>{const n=t(e);if(n.renderer===null)throw new Error("Missing the renderer of the given AudioParam in the audio graph.");return n.renderer},Ldt=t=>e=>t.get(e),bl=()=>new DOMException("","InvalidStateError"),Udt=t=>e=>{const n=t.get(e);if(n===void 0)throw bl();return n},Bdt=(t,e)=>n=>{let i=t.get(n);if(i!==void 0)return i;if(e===null)throw new Error("Missing the native OfflineAudioContext constructor.");return i=new e(1,1,44100),t.set(n,i),i},Fdt=t=>e=>{const n=t.get(e);if(n===void 0)throw new Error("The context has no set of AudioWorkletNodes.");return n},Gz=()=>new DOMException("","InvalidAccessError"),zdt=t=>{t.getFrequencyResponse=(e=>(n,i,r)=>{if(n.length!==i.length||i.length!==r.length)throw Gz();return e.call(t,n,i,r)})(t.getFrequencyResponse)},Hdt={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers"},jdt=(t,e,n,i,r,s)=>class extends t{constructor(o,c){const l=i(o),u=r(l),h={...Hdt,...c},f=e(l,u?null:o.baseLatency,h),d=u?n(h.feedback,h.feedforward):null;super(o,!1,f,d),zdt(f),this._nativeIIRFilterNode=f,s(this,1)}getFrequencyResponse(o,c,l){return this._nativeIIRFilterNode.getFrequencyResponse(o,c,l)}},$ye=(t,e,n,i,r,s,a,o,c,l,u)=>{const h=l.length;let f=o;for(let d=0;d<h;d+=1){let p=n[0]*l[d];for(let g=1;g<r;g+=1){const y=f-g&c-1;p+=n[g]*s[y],p-=t[g]*a[y]}for(let g=r;g<i;g+=1)p+=n[g]*s[f-g&c-1];for(let g=r;g<e;g+=1)p-=t[g]*a[f-g&c-1];s[f]=l[d],a[f]=p,f=f+1&c-1,u[d]=p}return f},Vdt=(t,e,n,i)=>{const r=n instanceof Float64Array?n:new Float64Array(n),s=i instanceof Float64Array?i:new Float64Array(i),a=r.length,o=s.length,c=Math.min(a,o);if(r[0]!==1){for(let p=0;p<a;p+=1)s[p]/=r[0];for(let p=1;p<o;p+=1)r[p]/=r[0]}const l=32,u=new Float32Array(l),h=new Float32Array(l),f=e.createBuffer(t.numberOfChannels,t.length,t.sampleRate),d=t.numberOfChannels;for(let p=0;p<d;p+=1){const g=t.getChannelData(p),y=f.getChannelData(p);u.fill(0),h.fill(0),$ye(r,a,s,o,c,u,h,0,l,g,y)}return f},Gdt=(t,e,n,i,r)=>(s,a)=>{const o=new WeakMap;let c=null;const l=async(u,h)=>{let f=null,d=e(u);const p=Tu(d,h);if(h.createIIRFilter===void 0?f=t(h,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}):p||(d=h.createIIRFilter(a,s)),o.set(h,f===null?d:f),f!==null){if(c===null){if(n===null)throw new Error("Missing the native OfflineAudioContext constructor.");const y=new n(u.context.destination.channelCount,u.context.length,h.sampleRate);c=(async()=>{await i(u,y,y.destination);const v=await r(y);return Vdt(v,h,s,a)})()}const g=await c;return f.buffer=g,f.start(0),f}return await i(u,h,d),d};return{render(u,h){const f=o.get(h);return f!==void 0?Promise.resolve(f):l(u,h)}}},qdt=(t,e,n,i,r,s)=>a=>(o,c)=>{const l=t.get(o);if(l===void 0){if(!a&&s(o)){const u=i(o),{outputs:h}=n(o);for(const f of h)if(yk(f)){const d=i(f[0]);e(u,d,f[1],f[2])}else{const d=r(f[0]);u.disconnect(d,f[1])}}t.set(o,c)}else t.set(o,l+c)},$dt=(t,e)=>n=>{const i=t.get(n);return e(i)||e(n)},Wdt=(t,e)=>n=>t.has(n)||e(n),Ydt=(t,e)=>n=>t.has(n)||e(n),Xdt=(t,e)=>n=>{const i=t.get(n);return e(i)||e(n)},Kdt=t=>e=>t!==null&&e instanceof t,Zdt=t=>e=>t!==null&&typeof t.AudioNode=="function"&&e instanceof t.AudioNode,Jdt=t=>e=>t!==null&&typeof t.AudioParam=="function"&&e instanceof t.AudioParam,Qdt=(t,e)=>n=>t(n)||e(n),ept=t=>e=>t!==null&&e instanceof t,tpt=t=>t!==null&&t.isSecureContext,npt=(t,e,n,i)=>class extends t{constructor(s,a){const o=n(s),c=e(o,a);if(i(o))throw TypeError();super(s,!0,c,null),this._nativeMediaElementAudioSourceNode=c}get mediaElement(){return this._nativeMediaElementAudioSourceNode.mediaElement}},ipt={channelCount:2,channelCountMode:"explicit",channelInterpretation:"speakers"},rpt=(t,e,n,i)=>class extends t{constructor(s,a){const o=n(s);if(i(o))throw new TypeError;const c={...ipt,...a},l=e(o,c);super(s,!1,l,null),this._nativeMediaStreamAudioDestinationNode=l}get stream(){return this._nativeMediaStreamAudioDestinationNode.stream}},spt=(t,e,n,i)=>class extends t{constructor(s,a){const o=n(s),c=e(o,a);if(i(o))throw new TypeError;super(s,!0,c,null),this._nativeMediaStreamAudioSourceNode=c}get mediaStream(){return this._nativeMediaStreamAudioSourceNode.mediaStream}},apt=(t,e,n)=>class extends t{constructor(r,s){const a=n(r),o=e(a,s);super(r,!0,o,null)}},opt=(t,e,n,i,r,s)=>class extends n{constructor(o,c){super(o),this._nativeContext=o,jz.set(this,o),i(o)&&r.set(o,new Set),this._destination=new t(this,c),this._listener=e(this,o),this._onstatechange=null}get currentTime(){return this._nativeContext.currentTime}get destination(){return this._destination}get listener(){return this._listener}get onstatechange(){return this._onstatechange}set onstatechange(o){const c=typeof o=="function"?s(this,o):null;this._nativeContext.onstatechange=c;const l=this._nativeContext.onstatechange;this._onstatechange=l!==null&&l===c?o:l}get sampleRate(){return this._nativeContext.sampleRate}get state(){return this._nativeContext.state}},NN=t=>{const e=new Uint32Array([1179011410,40,1163280727,544501094,16,131073,44100,176400,1048580,1635017060,4,0]);try{const n=t.decodeAudioData(e.buffer,()=>{});return n===void 0?!1:(n.catch(()=>{}),!0)}catch{}return!1},cpt=(t,e)=>(n,i,r)=>{const s=new Set;return n.connect=(a=>(o,c=0,l=0)=>{const u=s.size===0;if(e(o))return a.call(n,o,c,l),t(s,[o,c,l],h=>h[0]===o&&h[1]===c&&h[2]===l,!0),u&&i(),o;a.call(n,o,c),t(s,[o,c],h=>h[0]===o&&h[1]===c,!0),u&&i()})(n.connect),n.disconnect=(a=>(o,c,l)=>{const u=s.size>0;if(o===void 0)a.apply(n),s.clear();else if(typeof o=="number"){a.call(n,o);for(const f of s)f[1]===o&&s.delete(f)}else{e(o)?a.call(n,o,c,l):a.call(n,o,c);for(const f of s)f[0]===o&&(c===void 0||f[1]===c)&&(l===void 0||f[2]===l)&&s.delete(f)}const h=s.size===0;u&&h&&r()})(n.disconnect),n},Da=(t,e,n)=>{const i=e[n];i!==void 0&&i!==t[n]&&(t[n]=i)},Wc=(t,e)=>{Da(t,e,"channelCount"),Da(t,e,"channelCountMode"),Da(t,e,"channelInterpretation")},use=t=>typeof t.getFloatTimeDomainData=="function",lpt=t=>{t.getFloatTimeDomainData=e=>{const n=new Uint8Array(e.length);t.getByteTimeDomainData(n);const i=Math.max(n.length,t.fftSize);for(let r=0;r<i;r+=1)e[r]=(n[r]-128)*.0078125;return e}},upt=(t,e)=>(n,i)=>{const r=n.createAnalyser();if(Wc(r,i),!(i.maxDecibels>i.minDecibels))throw e();return Da(r,i,"fftSize"),Da(r,i,"maxDecibels"),Da(r,i,"minDecibels"),Da(r,i,"smoothingTimeConstant"),t(use,()=>use(r))||lpt(r),r},hpt=t=>t===null?null:t.hasOwnProperty("AudioBuffer")?t.AudioBuffer:null,So=(t,e,n)=>{const i=e[n];i!==void 0&&i!==t[n].value&&(t[n].value=i)},fpt=t=>{t.start=(e=>{let n=!1;return(i=0,r=0,s)=>{if(n)throw bl();e.call(t,i,r,s),n=!0}})(t.start)},kX=t=>{t.start=(e=>(n=0,i=0,r)=>{if(typeof r=="number"&&r<0||i<0||n<0)throw new RangeError("The parameters can't be negative.");e.call(t,n,i,r)})(t.start)},DX=t=>{t.stop=(e=>(n=0)=>{if(n<0)throw new RangeError("The parameter can't be negative.");e.call(t,n)})(t.stop)},dpt=(t,e,n,i,r,s,a,o,c,l,u)=>(h,f)=>{const d=h.createBufferSource();return Wc(d,f),So(d,f,"playbackRate"),Da(d,f,"buffer"),Da(d,f,"loop"),Da(d,f,"loopEnd"),Da(d,f,"loopStart"),e(n,()=>n(h))||fpt(d),e(i,()=>i(h))||c(d),e(r,()=>r(h))||l(d,h),e(s,()=>s(h))||kX(d),e(a,()=>a(h))||u(d,h),e(o,()=>o(h))||DX(d),t(h,d),d},ppt=t=>t===null?null:t.hasOwnProperty("AudioContext")?t.AudioContext:t.hasOwnProperty("webkitAudioContext")?t.webkitAudioContext:null,mpt=(t,e)=>(n,i,r)=>{const s=n.destination;if(s.channelCount!==i)try{s.channelCount=i}catch{}r&&s.channelCountMode!=="explicit"&&(s.channelCountMode="explicit"),s.maxChannelCount===0&&Object.defineProperty(s,"maxChannelCount",{value:i});const a=t(n,{channelCount:i,channelCountMode:s.channelCountMode,channelInterpretation:s.channelInterpretation,gain:1});return e(a,"channelCount",o=>()=>o.call(a),o=>c=>{o.call(a,c);try{s.channelCount=c}catch(l){if(c>s.maxChannelCount)throw l}}),e(a,"channelCountMode",o=>()=>o.call(a),o=>c=>{o.call(a,c),s.channelCountMode=c}),e(a,"channelInterpretation",o=>()=>o.call(a),o=>c=>{o.call(a,c),s.channelInterpretation=c}),Object.defineProperty(a,"maxChannelCount",{get:()=>s.maxChannelCount}),a.connect(s),a},gpt=t=>t===null?null:t.hasOwnProperty("AudioWorkletNode")?t.AudioWorkletNode:null,vpt=t=>{const{port1:e}=new MessageChannel;try{e.postMessage(t)}finally{e.close()}},_pt=(t,e,n,i,r)=>(s,a,o,c,l,u)=>{if(o!==null)try{const h=new o(s,c,u),f=new Map;let d=null;if(Object.defineProperties(h,{channelCount:{get:()=>u.channelCount,set:()=>{throw t()}},channelCountMode:{get:()=>"explicit",set:()=>{throw t()}},onprocessorerror:{get:()=>d,set:p=>{typeof d=="function"&&h.removeEventListener("processorerror",d),d=typeof p=="function"?p:null,typeof d=="function"&&h.addEventListener("processorerror",d)}}}),h.addEventListener=(p=>(...g)=>{if(g[0]==="processorerror"){const y=typeof g[1]=="function"?g[1]:typeof g[1]=="object"&&g[1]!==null&&typeof g[1].handleEvent=="function"?g[1].handleEvent:null;if(y!==null){const v=f.get(g[1]);v!==void 0?g[1]=v:(g[1]=b=>{b.type==="error"?(Object.defineProperties(b,{type:{value:"processorerror"}}),y(b)):y(new ErrorEvent(g[0],{...b}))},f.set(y,g[1]))}}return p.call(h,"error",g[1],g[2]),p.call(h,...g)})(h.addEventListener),h.removeEventListener=(p=>(...g)=>{if(g[0]==="processorerror"){const y=f.get(g[1]);y!==void 0&&(f.delete(g[1]),g[1]=y)}return p.call(h,"error",g[1],g[2]),p.call(h,g[0],g[1],g[2])})(h.removeEventListener),u.numberOfOutputs!==0){const p=n(s,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});return h.connect(p).connect(s.destination),r(h,()=>p.disconnect(),()=>p.connect(s.destination))}return h}catch(h){throw h.code===11?i():h}if(l===void 0)throw i();return vpt(u),e(s,a,l,u)},Wye=(t,e)=>t===null?512:Math.max(512,Math.min(16384,Math.pow(2,Math.round(Math.log2(t*e))))),ypt=t=>new Promise((e,n)=>{const{port1:i,port2:r}=new MessageChannel;i.onmessage=({data:s})=>{i.close(),r.close(),e(s)},i.onmessageerror=({data:s})=>{i.close(),r.close(),n(s)},r.postMessage(t)}),bpt=async(t,e)=>{const n=await ypt(e);return new t(n)},Ept=(t,e,n,i)=>{let r=s$.get(t);r===void 0&&(r=new WeakMap,s$.set(t,r));const s=bpt(n,i);return r.set(e,s),s},Spt=(t,e,n,i,r,s,a,o,c,l,u,h,f)=>(d,p,g,y)=>{if(y.numberOfInputs===0&&y.numberOfOutputs===0)throw c();const v=Array.isArray(y.outputChannelCount)?y.outputChannelCount:Array.from(y.outputChannelCount);if(v.some(Be=>Be<1))throw c();if(v.length!==y.numberOfOutputs)throw e();if(y.channelCountMode!=="explicit")throw c();const b=y.channelCount*y.numberOfInputs,T=v.reduce((Be,Ie)=>Be+Ie,0),x=g.parameterDescriptors===void 0?0:g.parameterDescriptors.length;if(b+x>6||T>6)throw c();const M=new MessageChannel,R=[],I=[];for(let Be=0;Be<y.numberOfInputs;Be+=1)R.push(a(d,{channelCount:y.channelCount,channelCountMode:y.channelCountMode,channelInterpretation:y.channelInterpretation,gain:1})),I.push(r(d,{channelCount:y.channelCount,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:y.channelCount}));const k=[];if(g.parameterDescriptors!==void 0)for(const{defaultValue:Be,maxValue:Ie,minValue:rt,name:ft}of g.parameterDescriptors){const gt=s(d,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:y.parameterData[ft]!==void 0?y.parameterData[ft]:Be===void 0?0:Be});Object.defineProperties(gt.offset,{defaultValue:{get:()=>Be===void 0?0:Be},maxValue:{get:()=>Ie===void 0?eh:Ie},minValue:{get:()=>rt===void 0?Vh:rt}}),k.push(gt)}const P=i(d,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:Math.max(1,b+x)}),U=Wye(p,d.sampleRate),G=o(d,U,b+x,Math.max(1,T)),$=r(d,{channelCount:Math.max(1,T),channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:Math.max(1,T)}),q=[];for(let Be=0;Be<y.numberOfOutputs;Be+=1)q.push(i(d,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:v[Be]}));for(let Be=0;Be<y.numberOfInputs;Be+=1){R[Be].connect(I[Be]);for(let Ie=0;Ie<y.channelCount;Ie+=1)I[Be].connect(P,Ie,Be*y.channelCount+Ie)}const Y=new Gye(g.parameterDescriptors===void 0?[]:g.parameterDescriptors.map(({name:Be},Ie)=>{const rt=k[Ie];return rt.connect(P,0,b+Ie),rt.start(0),[Be,rt.offset]}));P.connect(G);let ie=y.channelInterpretation,V=null;const J=y.numberOfOutputs===0?[G]:q,X={get bufferSize(){return U},get channelCount(){return y.channelCount},set channelCount(Be){throw n()},get channelCountMode(){return y.channelCountMode},set channelCountMode(Be){throw n()},get channelInterpretation(){return ie},set channelInterpretation(Be){for(const Ie of R)Ie.channelInterpretation=Be;ie=Be},get context(){return G.context},get inputs(){return R},get numberOfInputs(){return y.numberOfInputs},get numberOfOutputs(){return y.numberOfOutputs},get onprocessorerror(){return V},set onprocessorerror(Be){typeof V=="function"&&X.removeEventListener("processorerror",V),V=typeof Be=="function"?Be:null,typeof V=="function"&&X.addEventListener("processorerror",V)},get parameters(){return Y},get port(){return M.port2},addEventListener(...Be){return G.addEventListener(Be[0],Be[1],Be[2])},connect:t.bind(null,J),disconnect:l.bind(null,J),dispatchEvent(...Be){return G.dispatchEvent(Be[0])},removeEventListener(...Be){return G.removeEventListener(Be[0],Be[1],Be[2])}},ee=new Map;M.port1.addEventListener=(Be=>(...Ie)=>{if(Ie[0]==="message"){const rt=typeof Ie[1]=="function"?Ie[1]:typeof Ie[1]=="object"&&Ie[1]!==null&&typeof Ie[1].handleEvent=="function"?Ie[1].handleEvent:null;if(rt!==null){const ft=ee.get(Ie[1]);ft!==void 0?Ie[1]=ft:(Ie[1]=gt=>{u(d.currentTime,d.sampleRate,()=>rt(gt))},ee.set(rt,Ie[1]))}}return Be.call(M.port1,Ie[0],Ie[1],Ie[2])})(M.port1.addEventListener),M.port1.removeEventListener=(Be=>(...Ie)=>{if(Ie[0]==="message"){const rt=ee.get(Ie[1]);rt!==void 0&&(ee.delete(Ie[1]),Ie[1]=rt)}return Be.call(M.port1,Ie[0],Ie[1],Ie[2])})(M.port1.removeEventListener);let oe=null;Object.defineProperty(M.port1,"onmessage",{get:()=>oe,set:Be=>{typeof oe=="function"&&M.port1.removeEventListener("message",oe),oe=typeof Be=="function"?Be:null,typeof oe=="function"&&(M.port1.addEventListener("message",oe),M.port1.start())}}),g.prototype.port=M.port1;let fe=null;Ept(d,X,g,y).then(Be=>fe=Be);const He=z3(y.numberOfInputs,y.channelCount),Te=z3(y.numberOfOutputs,v),Le=g.parameterDescriptors===void 0?[]:g.parameterDescriptors.reduce((Be,{name:Ie})=>({...Be,[Ie]:new Float32Array(128)}),{});let we=!0;const Ce=()=>{y.numberOfOutputs>0&&G.disconnect($);for(let Be=0,Ie=0;Be<y.numberOfOutputs;Be+=1){const rt=q[Be];for(let ft=0;ft<v[Be];ft+=1)$.disconnect(rt,Ie+ft,ft);Ie+=v[Be]}},ke=new Map;G.onaudioprocess=({inputBuffer:Be,outputBuffer:Ie})=>{if(fe!==null){const rt=h(X);for(let ft=0;ft<U;ft+=128){for(let gt=0;gt<y.numberOfInputs;gt+=1)for(let bt=0;bt<y.channelCount;bt+=1)F3(Be,He[gt],bt,bt,ft);g.parameterDescriptors!==void 0&&g.parameterDescriptors.forEach(({name:gt},bt)=>{F3(Be,Le,gt,b+bt,ft)});for(let gt=0;gt<y.numberOfInputs;gt+=1)for(let bt=0;bt<v[gt];bt+=1)Te[gt][bt].byteLength===0&&(Te[gt][bt]=new Float32Array(128));try{const gt=He.map((be,ue)=>{if(rt[ue].size>0)return ke.set(ue,U/128),be;const it=ke.get(ue);return it===void 0?[]:(be.every($e=>$e.every(Ue=>Ue===0))&&(it===1?ke.delete(ue):ke.set(ue,it-1)),be)});we=u(d.currentTime+ft/d.sampleRate,d.sampleRate,()=>fe.process(gt,Te,Le));for(let be=0,ue=0;be<y.numberOfOutputs;be+=1){for(let Xe=0;Xe<v[be];Xe+=1)qye(Ie,Te[be],Xe,ue+Xe,ft);ue+=v[be]}}catch(gt){we=!1,X.dispatchEvent(new ErrorEvent("processorerror",{colno:gt.colno,filename:gt.filename,lineno:gt.lineno,message:gt.message}))}if(!we){for(let gt=0;gt<y.numberOfInputs;gt+=1){R[gt].disconnect(I[gt]);for(let bt=0;bt<y.channelCount;bt+=1)I[ft].disconnect(P,bt,gt*y.channelCount+bt)}if(g.parameterDescriptors!==void 0){const gt=g.parameterDescriptors.length;for(let bt=0;bt<gt;bt+=1){const be=k[bt];be.disconnect(P,0,b+bt),be.stop()}}P.disconnect(G),G.onaudioprocess=null,St?Ce():_e();break}}}};let St=!1;const Mt=a(d,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0}),Ee=()=>G.connect(Mt).connect(d.destination),_e=()=>{G.disconnect(Mt),Mt.disconnect()},tt=()=>{if(we){_e(),y.numberOfOutputs>0&&G.connect($);for(let Be=0,Ie=0;Be<y.numberOfOutputs;Be+=1){const rt=q[Be];for(let ft=0;ft<v[Be];ft+=1)$.connect(rt,Ie+ft,ft);Ie+=v[Be]}}St=!0},de=()=>{we&&(Ee(),Ce()),St=!1};return Ee(),f(X,tt,de)},Yye=(t,e)=>{const n=t.createBiquadFilter();return Wc(n,e),So(n,e,"Q"),So(n,e,"detune"),So(n,e,"frequency"),So(n,e,"gain"),Da(n,e,"type"),n},Tpt=(t,e)=>(n,i)=>{const r=n.createChannelMerger(i.numberOfInputs);return t!==null&&t.name==="webkitAudioContext"&&e(n,r),Wc(r,i),r},xpt=t=>{const e=t.numberOfOutputs;Object.defineProperty(t,"channelCount",{get:()=>e,set:n=>{if(n!==e)throw bl()}}),Object.defineProperty(t,"channelCountMode",{get:()=>"explicit",set:n=>{if(n!=="explicit")throw bl()}}),Object.defineProperty(t,"channelInterpretation",{get:()=>"discrete",set:n=>{if(n!=="discrete")throw bl()}})},bk=(t,e)=>{const n=t.createChannelSplitter(e.numberOfOutputs);return Wc(n,e),xpt(n),n},wpt=(t,e,n,i,r)=>(s,a)=>{if(s.createConstantSource===void 0)return n(s,a);const o=s.createConstantSource();return Wc(o,a),So(o,a,"offset"),e(i,()=>i(s))||kX(o),e(r,()=>r(s))||DX(o),t(s,o),o},$A=(t,e)=>(t.connect=e.connect.bind(e),t.disconnect=e.disconnect.bind(e),t),Cpt=(t,e,n,i)=>(r,{offset:s,...a})=>{const o=r.createBuffer(1,2,44100),c=e(r,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}),l=n(r,{...a,gain:s}),u=o.getChannelData(0);u[0]=1,u[1]=1,c.buffer=o,c.loop=!0;const h={get bufferSize(){},get channelCount(){return l.channelCount},set channelCount(p){l.channelCount=p},get channelCountMode(){return l.channelCountMode},set channelCountMode(p){l.channelCountMode=p},get channelInterpretation(){return l.channelInterpretation},set channelInterpretation(p){l.channelInterpretation=p},get context(){return l.context},get inputs(){return[]},get numberOfInputs(){return c.numberOfInputs},get numberOfOutputs(){return l.numberOfOutputs},get offset(){return l.gain},get onended(){return c.onended},set onended(p){c.onended=p},addEventListener(...p){return c.addEventListener(p[0],p[1],p[2])},dispatchEvent(...p){return c.dispatchEvent(p[0])},removeEventListener(...p){return c.removeEventListener(p[0],p[1],p[2])},start(p=0){c.start.call(c,p)},stop(p=0){c.stop.call(c,p)}},f=()=>c.connect(l),d=()=>c.disconnect(l);return t(r,c),i($A(h,l),f,d)},Apt=(t,e)=>(n,i)=>{const r=n.createConvolver();if(Wc(r,i),i.disableNormalization===r.normalize&&(r.normalize=!i.disableNormalization),Da(r,i,"buffer"),i.channelCount>2||(e(r,"channelCount",s=>()=>s.call(r),s=>a=>{if(a>2)throw t();return s.call(r,a)}),i.channelCountMode==="max"))throw t();return e(r,"channelCountMode",s=>()=>s.call(r),s=>a=>{if(a==="max")throw t();return s.call(r,a)}),r},Xye=(t,e)=>{const n=t.createDelay(e.maxDelayTime);return Wc(n,e),So(n,e,"delayTime"),n},Rpt=t=>(e,n)=>{const i=e.createDynamicsCompressor();if(Wc(i,n),n.channelCount>2||n.channelCountMode==="max")throw t();return So(i,n,"attack"),So(i,n,"knee"),So(i,n,"ratio"),So(i,n,"release"),So(i,n,"threshold"),i},ff=(t,e)=>{const n=t.createGain();return Wc(n,e),So(n,e,"gain"),n},Mpt=t=>(e,n,i)=>{if(e.createIIRFilter===void 0)return t(e,n,i);const r=e.createIIRFilter(i.feedforward,i.feedback);return Wc(r,i),r};function Opt(t,e){const n=e[0]*e[0]+e[1]*e[1];return[(t[0]*e[0]+t[1]*e[1])/n,(t[1]*e[0]-t[0]*e[1])/n]}function Npt(t,e){return[t[0]*e[0]-t[1]*e[1],t[0]*e[1]+t[1]*e[0]]}function hse(t,e){let n=[0,0];for(let i=t.length-1;i>=0;i-=1)n=Npt(n,e),n[0]+=t[i];return n}const Ipt=(t,e,n,i)=>(r,s,{channelCount:a,channelCountMode:o,channelInterpretation:c,feedback:l,feedforward:u})=>{const h=Wye(s,r.sampleRate),f=l instanceof Float64Array?l:new Float64Array(l),d=u instanceof Float64Array?u:new Float64Array(u),p=f.length,g=d.length,y=Math.min(p,g);if(p===0||p>20)throw i();if(f[0]===0)throw e();if(g===0||g>20)throw i();if(d[0]===0)throw e();if(f[0]!==1){for(let k=0;k<g;k+=1)d[k]/=f[0];for(let k=1;k<p;k+=1)f[k]/=f[0]}const v=n(r,h,a,a);v.channelCount=a,v.channelCountMode=o,v.channelInterpretation=c;const b=32,T=[],x=[],M=[];for(let k=0;k<a;k+=1){T.push(0);const P=new Float32Array(b),U=new Float32Array(b);P.fill(0),U.fill(0),x.push(P),M.push(U)}v.onaudioprocess=k=>{const P=k.inputBuffer,U=k.outputBuffer,G=P.numberOfChannels;for(let $=0;$<G;$+=1){const q=P.getChannelData($),Y=U.getChannelData($);T[$]=$ye(f,p,d,g,y,x[$],M[$],T[$],b,q,Y)}};const R=r.sampleRate/2;return $A({get bufferSize(){return h},get channelCount(){return v.channelCount},set channelCount(k){v.channelCount=k},get channelCountMode(){return v.channelCountMode},set channelCountMode(k){v.channelCountMode=k},get channelInterpretation(){return v.channelInterpretation},set channelInterpretation(k){v.channelInterpretation=k},get context(){return v.context},get inputs(){return[v]},get numberOfInputs(){return v.numberOfInputs},get numberOfOutputs(){return v.numberOfOutputs},addEventListener(...k){return v.addEventListener(k[0],k[1],k[2])},dispatchEvent(...k){return v.dispatchEvent(k[0])},getFrequencyResponse(k,P,U){if(k.length!==P.length||P.length!==U.length)throw t();const G=k.length;for(let $=0;$<G;$+=1){const q=-Math.PI*(k[$]/R),Y=[Math.cos(q),Math.sin(q)],ie=hse(d,Y),V=hse(f,Y),J=Opt(ie,V);P[$]=Math.sqrt(J[0]*J[0]+J[1]*J[1]),U[$]=Math.atan2(J[1],J[0])}},removeEventListener(...k){return v.removeEventListener(k[0],k[1],k[2])}},v)},kpt=(t,e)=>t.createMediaElementSource(e.mediaElement),Dpt=(t,e)=>{const n=t.createMediaStreamDestination();return Wc(n,e),n.numberOfOutputs===1&&Object.defineProperty(n,"numberOfOutputs",{get:()=>0}),n},Ppt=(t,{mediaStream:e})=>{const n=e.getAudioTracks();n.sort((s,a)=>s.id<a.id?-1:s.id>a.id?1:0);const i=n.slice(0,1),r=t.createMediaStreamSource(new MediaStream(i));return Object.defineProperty(r,"mediaStream",{value:e}),r},Lpt=(t,e)=>(n,{mediaStreamTrack:i})=>{if(typeof n.createMediaStreamTrackSource=="function")return n.createMediaStreamTrackSource(i);const r=new MediaStream([i]),s=n.createMediaStreamSource(r);if(i.kind!=="audio")throw t();if(e(n))throw new TypeError;return s},Upt=t=>t===null?null:t.hasOwnProperty("OfflineAudioContext")?t.OfflineAudioContext:t.hasOwnProperty("webkitOfflineAudioContext")?t.webkitOfflineAudioContext:null,Bpt=(t,e,n,i,r,s)=>(a,o)=>{const c=a.createOscillator();return Wc(c,o),So(c,o,"detune"),So(c,o,"frequency"),o.periodicWave!==void 0?c.setPeriodicWave(o.periodicWave):Da(c,o,"type"),e(n,()=>n(a))||kX(c),e(i,()=>i(a))||s(c,a),e(r,()=>r(a))||DX(c),t(a,c),c},Fpt=t=>(e,n)=>{const i=e.createPanner();return i.orientationX===void 0?t(e,n):(Wc(i,n),So(i,n,"orientationX"),So(i,n,"orientationY"),So(i,n,"orientationZ"),So(i,n,"positionX"),So(i,n,"positionY"),So(i,n,"positionZ"),Da(i,n,"coneInnerAngle"),Da(i,n,"coneOuterAngle"),Da(i,n,"coneOuterGain"),Da(i,n,"distanceModel"),Da(i,n,"maxDistance"),Da(i,n,"panningModel"),Da(i,n,"refDistance"),Da(i,n,"rolloffFactor"),i)},zpt=(t,e,n,i,r,s,a,o,c,l)=>(u,{coneInnerAngle:h,coneOuterAngle:f,coneOuterGain:d,distanceModel:p,maxDistance:g,orientationX:y,orientationY:v,orientationZ:b,panningModel:T,positionX:x,positionY:M,positionZ:R,refDistance:I,rolloffFactor:k,...P})=>{const U=u.createPanner();if(P.channelCount>2||P.channelCountMode==="max")throw a();Wc(U,P);const G={channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete"},$=n(u,{...G,channelInterpretation:"speakers",numberOfInputs:6}),q=i(u,{...P,gain:1}),Y=i(u,{...G,gain:1}),ie=i(u,{...G,gain:0}),V=i(u,{...G,gain:0}),J=i(u,{...G,gain:0}),X=i(u,{...G,gain:0}),ee=i(u,{...G,gain:0}),oe=r(u,256,6,1),fe=s(u,{...G,curve:new Float32Array([1,1]),oversample:"none"});let Re=[y,v,b],He=[x,M,R];const Te=new Float32Array(1);oe.onaudioprocess=({inputBuffer:ke})=>{const St=[c(ke,Te,0),c(ke,Te,1),c(ke,Te,2)];St.some((Ee,_e)=>Ee!==Re[_e])&&(U.setOrientation(...St),Re=St);const Mt=[c(ke,Te,3),c(ke,Te,4),c(ke,Te,5)];Mt.some((Ee,_e)=>Ee!==He[_e])&&(U.setPosition(...Mt),He=Mt)},Object.defineProperty(ie.gain,"defaultValue",{get:()=>0}),Object.defineProperty(V.gain,"defaultValue",{get:()=>0}),Object.defineProperty(J.gain,"defaultValue",{get:()=>0}),Object.defineProperty(X.gain,"defaultValue",{get:()=>0}),Object.defineProperty(ee.gain,"defaultValue",{get:()=>0});const Le={get bufferSize(){},get channelCount(){return U.channelCount},set channelCount(ke){if(ke>2)throw a();q.channelCount=ke,U.channelCount=ke},get channelCountMode(){return U.channelCountMode},set channelCountMode(ke){if(ke==="max")throw a();q.channelCountMode=ke,U.channelCountMode=ke},get channelInterpretation(){return U.channelInterpretation},set channelInterpretation(ke){q.channelInterpretation=ke,U.channelInterpretation=ke},get coneInnerAngle(){return U.coneInnerAngle},set coneInnerAngle(ke){U.coneInnerAngle=ke},get coneOuterAngle(){return U.coneOuterAngle},set coneOuterAngle(ke){U.coneOuterAngle=ke},get coneOuterGain(){return U.coneOuterGain},set coneOuterGain(ke){if(ke<0||ke>1)throw e();U.coneOuterGain=ke},get context(){return U.context},get distanceModel(){return U.distanceModel},set distanceModel(ke){U.distanceModel=ke},get inputs(){return[q]},get maxDistance(){return U.maxDistance},set maxDistance(ke){if(ke<0)throw new RangeError;U.maxDistance=ke},get numberOfInputs(){return U.numberOfInputs},get numberOfOutputs(){return U.numberOfOutputs},get orientationX(){return Y.gain},get orientationY(){return ie.gain},get orientationZ(){return V.gain},get panningModel(){return U.panningModel},set panningModel(ke){U.panningModel=ke},get positionX(){return J.gain},get positionY(){return X.gain},get positionZ(){return ee.gain},get refDistance(){return U.refDistance},set refDistance(ke){if(ke<0)throw new RangeError;U.refDistance=ke},get rolloffFactor(){return U.rolloffFactor},set rolloffFactor(ke){if(ke<0)throw new RangeError;U.rolloffFactor=ke},addEventListener(...ke){return q.addEventListener(ke[0],ke[1],ke[2])},dispatchEvent(...ke){return q.dispatchEvent(ke[0])},removeEventListener(...ke){return q.removeEventListener(ke[0],ke[1],ke[2])}};h!==Le.coneInnerAngle&&(Le.coneInnerAngle=h),f!==Le.coneOuterAngle&&(Le.coneOuterAngle=f),d!==Le.coneOuterGain&&(Le.coneOuterGain=d),p!==Le.distanceModel&&(Le.distanceModel=p),g!==Le.maxDistance&&(Le.maxDistance=g),y!==Le.orientationX.value&&(Le.orientationX.value=y),v!==Le.orientationY.value&&(Le.orientationY.value=v),b!==Le.orientationZ.value&&(Le.orientationZ.value=b),T!==Le.panningModel&&(Le.panningModel=T),x!==Le.positionX.value&&(Le.positionX.value=x),M!==Le.positionY.value&&(Le.positionY.value=M),R!==Le.positionZ.value&&(Le.positionZ.value=R),I!==Le.refDistance&&(Le.refDistance=I),k!==Le.rolloffFactor&&(Le.rolloffFactor=k),(Re[0]!==1||Re[1]!==0||Re[2]!==0)&&U.setOrientation(...Re),(He[0]!==0||He[1]!==0||He[2]!==0)&&U.setPosition(...He);const we=()=>{q.connect(U),t(q,fe,0,0),fe.connect(Y).connect($,0,0),fe.connect(ie).connect($,0,1),fe.connect(V).connect($,0,2),fe.connect(J).connect($,0,3),fe.connect(X).connect($,0,4),fe.connect(ee).connect($,0,5),$.connect(oe).connect(u.destination)},Ce=()=>{q.disconnect(U),o(q,fe,0,0),fe.disconnect(Y),Y.disconnect($),fe.disconnect(ie),ie.disconnect($),fe.disconnect(V),V.disconnect($),fe.disconnect(J),J.disconnect($),fe.disconnect(X),X.disconnect($),fe.disconnect(ee),ee.disconnect($),$.disconnect(oe),oe.disconnect(u.destination)};return l($A(Le,U),we,Ce)},Hpt=t=>(e,{disableNormalization:n,imag:i,real:r})=>{const s=i instanceof Float32Array?i:new Float32Array(i),a=r instanceof Float32Array?r:new Float32Array(r),o=e.createPeriodicWave(a,s,{disableNormalization:n});if(Array.from(i).length<2)throw t();return o},Ek=(t,e,n,i)=>t.createScriptProcessor(e,n,i),jpt=(t,e)=>(n,i)=>{const r=i.channelCountMode;if(r==="clamped-max")throw e();if(n.createStereoPanner===void 0)return t(n,i);const s=n.createStereoPanner();return Wc(s,i),So(s,i,"pan"),Object.defineProperty(s,"channelCountMode",{get:()=>r,set:a=>{if(a!==r)throw e()}}),s},Vpt=(t,e,n,i,r,s)=>{const o=new Float32Array([1,1]),c=Math.PI/2,l={channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete"},u={...l,oversample:"none"},h=(p,g,y,v)=>{const b=new Float32Array(16385),T=new Float32Array(16385);for(let P=0;P<16385;P+=1){const U=P/16384*c;b[P]=Math.cos(U),T[P]=Math.sin(U)}const x=n(p,{...l,gain:0}),M=i(p,{...u,curve:b}),R=i(p,{...u,curve:o}),I=n(p,{...l,gain:0}),k=i(p,{...u,curve:T});return{connectGraph(){g.connect(x),g.connect(R.inputs===void 0?R:R.inputs[0]),g.connect(I),R.connect(y),y.connect(M.inputs===void 0?M:M.inputs[0]),y.connect(k.inputs===void 0?k:k.inputs[0]),M.connect(x.gain),k.connect(I.gain),x.connect(v,0,0),I.connect(v,0,1)},disconnectGraph(){g.disconnect(x),g.disconnect(R.inputs===void 0?R:R.inputs[0]),g.disconnect(I),R.disconnect(y),y.disconnect(M.inputs===void 0?M:M.inputs[0]),y.disconnect(k.inputs===void 0?k:k.inputs[0]),M.disconnect(x.gain),k.disconnect(I.gain),x.disconnect(v,0,0),I.disconnect(v,0,1)}}},f=(p,g,y,v)=>{const b=new Float32Array(16385),T=new Float32Array(16385),x=new Float32Array(16385),M=new Float32Array(16385),R=Math.floor(16385/2);for(let J=0;J<16385;J+=1)if(J>R){const X=(J-R)/(16384-R)*c;b[J]=Math.cos(X),T[J]=Math.sin(X),x[J]=0,M[J]=1}else{const X=J/(16384-R)*c;b[J]=1,T[J]=0,x[J]=Math.cos(X),M[J]=Math.sin(X)}const I=e(p,{channelCount:2,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:2}),k=n(p,{...l,gain:0}),P=i(p,{...u,curve:b}),U=n(p,{...l,gain:0}),G=i(p,{...u,curve:T}),$=i(p,{...u,curve:o}),q=n(p,{...l,gain:0}),Y=i(p,{...u,curve:x}),ie=n(p,{...l,gain:0}),V=i(p,{...u,curve:M});return{connectGraph(){g.connect(I),g.connect($.inputs===void 0?$:$.inputs[0]),I.connect(k,0),I.connect(U,0),I.connect(q,1),I.connect(ie,1),$.connect(y),y.connect(P.inputs===void 0?P:P.inputs[0]),y.connect(G.inputs===void 0?G:G.inputs[0]),y.connect(Y.inputs===void 0?Y:Y.inputs[0]),y.connect(V.inputs===void 0?V:V.inputs[0]),P.connect(k.gain),G.connect(U.gain),Y.connect(q.gain),V.connect(ie.gain),k.connect(v,0,0),q.connect(v,0,0),U.connect(v,0,1),ie.connect(v,0,1)},disconnectGraph(){g.disconnect(I),g.disconnect($.inputs===void 0?$:$.inputs[0]),I.disconnect(k,0),I.disconnect(U,0),I.disconnect(q,1),I.disconnect(ie,1),$.disconnect(y),y.disconnect(P.inputs===void 0?P:P.inputs[0]),y.disconnect(G.inputs===void 0?G:G.inputs[0]),y.disconnect(Y.inputs===void 0?Y:Y.inputs[0]),y.disconnect(V.inputs===void 0?V:V.inputs[0]),P.disconnect(k.gain),G.disconnect(U.gain),Y.disconnect(q.gain),V.disconnect(ie.gain),k.disconnect(v,0,0),q.disconnect(v,0,0),U.disconnect(v,0,1),ie.disconnect(v,0,1)}}},d=(p,g,y,v,b)=>{if(g===1)return h(p,y,v,b);if(g===2)return f(p,y,v,b);throw r()};return(p,{channelCount:g,channelCountMode:y,pan:v,...b})=>{if(y==="max")throw r();const T=t(p,{...b,channelCount:1,channelCountMode:y,numberOfInputs:2}),x=n(p,{...b,channelCount:g,channelCountMode:y,gain:1}),M=n(p,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:v});let{connectGraph:R,disconnectGraph:I}=d(p,g,x,M,T);Object.defineProperty(M.gain,"defaultValue",{get:()=>0}),Object.defineProperty(M.gain,"maxValue",{get:()=>1}),Object.defineProperty(M.gain,"minValue",{get:()=>-1});const k={get bufferSize(){},get channelCount(){return x.channelCount},set channelCount($){x.channelCount!==$&&(P&&I(),{connectGraph:R,disconnectGraph:I}=d(p,$,x,M,T),P&&R()),x.channelCount=$},get channelCountMode(){return x.channelCountMode},set channelCountMode($){if($==="clamped-max"||$==="max")throw r();x.channelCountMode=$},get channelInterpretation(){return x.channelInterpretation},set channelInterpretation($){x.channelInterpretation=$},get context(){return x.context},get inputs(){return[x]},get numberOfInputs(){return x.numberOfInputs},get numberOfOutputs(){return x.numberOfOutputs},get pan(){return M.gain},addEventListener(...$){return x.addEventListener($[0],$[1],$[2])},dispatchEvent(...$){return x.dispatchEvent($[0])},removeEventListener(...$){return x.removeEventListener($[0],$[1],$[2])}};let P=!1;const U=()=>{R(),P=!0},G=()=>{I(),P=!1};return s($A(k,T),U,G)}},Gpt=(t,e,n,i,r,s,a)=>(o,c)=>{const l=o.createWaveShaper();if(s!==null&&s.name==="webkitAudioContext"&&o.createGain().gain.automationRate===void 0)return n(o,c);Wc(l,c);const u=c.curve===null||c.curve instanceof Float32Array?c.curve:new Float32Array(c.curve);if(u!==null&&u.length<2)throw e();Da(l,{curve:u},"curve"),Da(l,c,"oversample");let h=null,f=!1;return a(l,"curve",g=>()=>g.call(l),g=>y=>(g.call(l,y),f&&(i(y)&&h===null?h=t(o,l):!i(y)&&h!==null&&(h(),h=null)),y)),r(l,()=>{f=!0,i(l.curve)&&(h=t(o,l))},()=>{f=!1,h!==null&&(h(),h=null)})},qpt=(t,e,n,i,r)=>(s,{curve:a,oversample:o,...c})=>{const l=s.createWaveShaper(),u=s.createWaveShaper();Wc(l,c),Wc(u,c);const h=n(s,{...c,gain:1}),f=n(s,{...c,gain:-1}),d=n(s,{...c,gain:1}),p=n(s,{...c,gain:-1});let g=null,y=!1,v=null;const b={get bufferSize(){},get channelCount(){return l.channelCount},set channelCount(M){h.channelCount=M,f.channelCount=M,l.channelCount=M,d.channelCount=M,u.channelCount=M,p.channelCount=M},get channelCountMode(){return l.channelCountMode},set channelCountMode(M){h.channelCountMode=M,f.channelCountMode=M,l.channelCountMode=M,d.channelCountMode=M,u.channelCountMode=M,p.channelCountMode=M},get channelInterpretation(){return l.channelInterpretation},set channelInterpretation(M){h.channelInterpretation=M,f.channelInterpretation=M,l.channelInterpretation=M,d.channelInterpretation=M,u.channelInterpretation=M,p.channelInterpretation=M},get context(){return l.context},get curve(){return v},set curve(M){if(M!==null&&M.length<2)throw e();if(M===null)l.curve=M,u.curve=M;else{const R=M.length,I=new Float32Array(R+2-R%2),k=new Float32Array(R+2-R%2);I[0]=M[0],k[0]=-M[R-1];const P=Math.ceil((R+1)/2),U=(R+1)/2-1;for(let G=1;G<P;G+=1){const $=G/P*U,q=Math.floor($),Y=Math.ceil($);I[G]=q===Y?M[q]:(1-($-q))*M[q]+(1-(Y-$))*M[Y],k[G]=q===Y?-M[R-1-q]:-((1-($-q))*M[R-1-q])-(1-(Y-$))*M[R-1-Y]}I[P]=R%2===1?M[P-1]:(M[P-2]+M[P-1])/2,l.curve=I,u.curve=k}v=M,y&&(i(v)&&g===null?g=t(s,h):g!==null&&(g(),g=null))},get inputs(){return[h]},get numberOfInputs(){return l.numberOfInputs},get numberOfOutputs(){return l.numberOfOutputs},get oversample(){return l.oversample},set oversample(M){l.oversample=M,u.oversample=M},addEventListener(...M){return h.addEventListener(M[0],M[1],M[2])},dispatchEvent(...M){return h.dispatchEvent(M[0])},removeEventListener(...M){return h.removeEventListener(M[0],M[1],M[2])}};a!==null&&(b.curve=a instanceof Float32Array?a:new Float32Array(a)),o!==b.oversample&&(b.oversample=o);const T=()=>{h.connect(l).connect(d),h.connect(f).connect(u).connect(p).connect(d),y=!0,i(v)&&(g=t(s,h))},x=()=>{h.disconnect(l),l.disconnect(d),h.disconnect(f),f.disconnect(u),u.disconnect(p),p.disconnect(d),y=!1,g!==null&&(g(),g=null)};return r($A(b,d),T,x)},ph=()=>new DOMException("","NotSupportedError"),$pt={numberOfChannels:1},Wpt=(t,e,n,i,r)=>class extends t{constructor(a,o,c){let l;if(typeof a=="number"&&o!==void 0&&c!==void 0)l={length:o,numberOfChannels:a,sampleRate:c};else if(typeof a=="object")l=a;else throw new Error("The given parameters are not valid.");const{length:u,numberOfChannels:h,sampleRate:f}={...$pt,...l},d=i(h,u,f);e(NN,()=>NN(d))||d.addEventListener("statechange",(()=>{let p=0;const g=y=>{this._state==="running"&&(p>0?(d.removeEventListener("statechange",g),y.stopImmediatePropagation(),this._waitForThePromiseToSettle(y)):p+=1)};return g})()),super(d,h),this._length=u,this._nativeOfflineAudioContext=d,this._state=null}get length(){return this._nativeOfflineAudioContext.length===void 0?this._length:this._nativeOfflineAudioContext.length}get state(){return this._state===null?this._nativeOfflineAudioContext.state:this._state}startRendering(){return this._state==="running"?Promise.reject(n()):(this._state="running",r(this.destination,this._nativeOfflineAudioContext).finally(()=>{this._state=null,zye(this)}))}_waitForThePromiseToSettle(a){this._state===null?this._nativeOfflineAudioContext.dispatchEvent(a):setTimeout(()=>this._waitForThePromiseToSettle(a))}},Ypt={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",detune:0,frequency:440,periodicWave:void 0,type:"sine"},Xpt=(t,e,n,i,r,s,a)=>class extends t{constructor(c,l){const u=r(c),h={...Ypt,...l},f=n(u,h),d=s(u),p=d?i():null,g=c.sampleRate/2;super(c,!1,f,p),this._detune=e(this,d,f.detune,153600,-153600),this._frequency=e(this,d,f.frequency,g,-g),this._nativeOscillatorNode=f,this._onended=null,this._oscillatorNodeRenderer=p,this._oscillatorNodeRenderer!==null&&h.periodicWave!==void 0&&(this._oscillatorNodeRenderer.periodicWave=h.periodicWave)}get detune(){return this._detune}get frequency(){return this._frequency}get onended(){return this._onended}set onended(c){const l=typeof c=="function"?a(this,c):null;this._nativeOscillatorNode.onended=l;const u=this._nativeOscillatorNode.onended;this._onended=u!==null&&u===l?c:u}get type(){return this._nativeOscillatorNode.type}set type(c){this._nativeOscillatorNode.type=c,this._oscillatorNodeRenderer!==null&&(this._oscillatorNodeRenderer.periodicWave=null)}setPeriodicWave(c){this._nativeOscillatorNode.setPeriodicWave(c),this._oscillatorNodeRenderer!==null&&(this._oscillatorNodeRenderer.periodicWave=c)}start(c=0){if(this._nativeOscillatorNode.start(c),this._oscillatorNodeRenderer!==null&&(this._oscillatorNodeRenderer.start=c),this.context.state!=="closed"){cA(this);const l=()=>{this._nativeOscillatorNode.removeEventListener("ended",l),d_(this)&&vk(this)};this._nativeOscillatorNode.addEventListener("ended",l)}}stop(c=0){this._nativeOscillatorNode.stop(c),this._oscillatorNodeRenderer!==null&&(this._oscillatorNodeRenderer.stop=c)}},Kpt=(t,e,n,i,r)=>()=>{const s=new WeakMap;let a=null,o=null,c=null;const l=async(u,h)=>{let f=n(u);const d=Tu(f,h);if(!d){const p={channelCount:f.channelCount,channelCountMode:f.channelCountMode,channelInterpretation:f.channelInterpretation,detune:f.detune.value,frequency:f.frequency.value,periodicWave:a===null?void 0:a,type:f.type};f=e(h,p),o!==null&&f.start(o),c!==null&&f.stop(c)}return s.set(h,f),d?(await t(h,u.detune,f.detune),await t(h,u.frequency,f.frequency)):(await i(h,u.detune,f.detune),await i(h,u.frequency,f.frequency)),await r(u,h,f),f};return{set periodicWave(u){a=u},set start(u){o=u},set stop(u){c=u},render(u,h){const f=s.get(h);return f!==void 0?Promise.resolve(f):l(u,h)}}},Zpt={channelCount:2,channelCountMode:"clamped-max",channelInterpretation:"speakers",coneInnerAngle:360,coneOuterAngle:360,coneOuterGain:0,distanceModel:"inverse",maxDistance:1e4,orientationX:1,orientationY:0,orientationZ:0,panningModel:"equalpower",positionX:0,positionY:0,positionZ:0,refDistance:1,rolloffFactor:1},Jpt=(t,e,n,i,r,s,a)=>class extends t{constructor(c,l){const u=r(c),h={...Zpt,...l},f=n(u,h),d=s(u),p=d?i():null;super(c,!1,f,p),this._nativePannerNode=f,this._orientationX=e(this,d,f.orientationX,eh,Vh),this._orientationY=e(this,d,f.orientationY,eh,Vh),this._orientationZ=e(this,d,f.orientationZ,eh,Vh),this._positionX=e(this,d,f.positionX,eh,Vh),this._positionY=e(this,d,f.positionY,eh,Vh),this._positionZ=e(this,d,f.positionZ,eh,Vh),a(this,1)}get coneInnerAngle(){return this._nativePannerNode.coneInnerAngle}set coneInnerAngle(c){this._nativePannerNode.coneInnerAngle=c}get coneOuterAngle(){return this._nativePannerNode.coneOuterAngle}set coneOuterAngle(c){this._nativePannerNode.coneOuterAngle=c}get coneOuterGain(){return this._nativePannerNode.coneOuterGain}set coneOuterGain(c){this._nativePannerNode.coneOuterGain=c}get distanceModel(){return this._nativePannerNode.distanceModel}set distanceModel(c){this._nativePannerNode.distanceModel=c}get maxDistance(){return this._nativePannerNode.maxDistance}set maxDistance(c){this._nativePannerNode.maxDistance=c}get orientationX(){return this._orientationX}get orientationY(){return this._orientationY}get orientationZ(){return this._orientationZ}get panningModel(){return this._nativePannerNode.panningModel}set panningModel(c){this._nativePannerNode.panningModel=c}get positionX(){return this._positionX}get positionY(){return this._positionY}get positionZ(){return this._positionZ}get refDistance(){return this._nativePannerNode.refDistance}set refDistance(c){this._nativePannerNode.refDistance=c}get rolloffFactor(){return this._nativePannerNode.rolloffFactor}set rolloffFactor(c){this._nativePannerNode.rolloffFactor=c}},Qpt=(t,e,n,i,r,s,a,o,c,l)=>()=>{const u=new WeakMap;let h=null;const f=async(d,p)=>{let g=null,y=s(d);const v={channelCount:y.channelCount,channelCountMode:y.channelCountMode,channelInterpretation:y.channelInterpretation},b={...v,coneInnerAngle:y.coneInnerAngle,coneOuterAngle:y.coneOuterAngle,coneOuterGain:y.coneOuterGain,distanceModel:y.distanceModel,maxDistance:y.maxDistance,panningModel:y.panningModel,refDistance:y.refDistance,rolloffFactor:y.rolloffFactor},T=Tu(y,p);if("bufferSize"in y)g=i(p,{...v,gain:1});else if(!T){const x={...b,orientationX:y.orientationX.value,orientationY:y.orientationY.value,orientationZ:y.orientationZ.value,positionX:y.positionX.value,positionY:y.positionY.value,positionZ:y.positionZ.value};y=r(p,x)}if(u.set(p,g===null?y:g),g!==null){if(h===null){if(a===null)throw new Error("Missing the native OfflineAudioContext constructor.");const G=new a(6,d.context.length,p.sampleRate),$=e(G,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:6});$.connect(G.destination),h=(async()=>{const q=await Promise.all([d.orientationX,d.orientationY,d.orientationZ,d.positionX,d.positionY,d.positionZ].map(async(Y,ie)=>{const V=n(G,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:ie===0?1:0});return await o(G,Y,V.offset),V}));for(let Y=0;Y<6;Y+=1)q[Y].connect($,0,Y),q[Y].start(0);return l(G)})()}const x=await h,M=i(p,{...v,gain:1});await c(d,p,M);const R=[];for(let G=0;G<x.numberOfChannels;G+=1)R.push(x.getChannelData(G));let I=[R[0][0],R[1][0],R[2][0]],k=[R[3][0],R[4][0],R[5][0]],P=i(p,{...v,gain:1}),U=r(p,{...b,orientationX:I[0],orientationY:I[1],orientationZ:I[2],positionX:k[0],positionY:k[1],positionZ:k[2]});M.connect(P).connect(U.inputs[0]),U.connect(g);for(let G=128;G<x.length;G+=128){const $=[R[0][G],R[1][G],R[2][G]],q=[R[3][G],R[4][G],R[5][G]];if($.some((Y,ie)=>Y!==I[ie])||q.some((Y,ie)=>Y!==k[ie])){I=$,k=q;const Y=G/p.sampleRate;P.gain.setValueAtTime(0,Y),P=i(p,{...v,gain:0}),U=r(p,{...b,orientationX:I[0],orientationY:I[1],orientationZ:I[2],positionX:k[0],positionY:k[1],positionZ:k[2]}),P.gain.setValueAtTime(1,Y),M.connect(P).connect(U.inputs[0]),U.connect(g)}}return g}return T?(await t(p,d.orientationX,y.orientationX),await t(p,d.orientationY,y.orientationY),await t(p,d.orientationZ,y.orientationZ),await t(p,d.positionX,y.positionX),await t(p,d.positionY,y.positionY),await t(p,d.positionZ,y.positionZ)):(await o(p,d.orientationX,y.orientationX),await o(p,d.orientationY,y.orientationY),await o(p,d.orientationZ,y.orientationZ),await o(p,d.positionX,y.positionX),await o(p,d.positionY,y.positionY),await o(p,d.positionZ,y.positionZ)),qA(y)?await c(d,p,y.inputs[0]):await c(d,p,y),y};return{render(d,p){const g=u.get(p);return g!==void 0?Promise.resolve(g):f(d,p)}}},emt={disableNormalization:!1},tmt=(t,e,n,i)=>class Kye{constructor(s,a){const o=e(s),c=i({...emt,...a}),l=t(o,c);return n.add(l),l}static[Symbol.hasInstance](s){return s!==null&&typeof s=="object"&&Object.getPrototypeOf(s)===Kye.prototype||n.has(s)}},nmt=(t,e)=>(n,i,r)=>(t(i).replay(r),e(i,n,r)),imt=(t,e,n)=>async(i,r,s)=>{const a=t(i);await Promise.all(a.activeInputs.map((o,c)=>Array.from(o).map(async([l,u])=>{const f=await e(l).render(l,r),d=i.context.destination;!n(l)&&(i!==d||!n(i))&&f.connect(s,u,c)})).reduce((o,c)=>[...o,...c],[]))},rmt=(t,e,n)=>async(i,r,s)=>{const a=e(i);await Promise.all(Array.from(a.activeInputs).map(async([o,c])=>{const u=await t(o).render(o,r);n(o)||u.connect(s,c)}))},smt=(t,e,n,i)=>r=>t(NN,()=>NN(r))?Promise.resolve(t(i,i)).then(s=>{if(!s){const a=n(r,512,0,1);r.oncomplete=()=>{a.onaudioprocess=null,a.disconnect()},a.onaudioprocess=()=>r.currentTime,a.connect(r.destination)}return r.startRendering()}):new Promise(s=>{const a=e(r,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});r.oncomplete=o=>{a.disconnect(),s(o.renderedBuffer)},a.connect(r.destination),r.startRendering()}),amt=t=>(e,n)=>{t.set(e,n)},omt=t=>(e,n)=>t.set(e,n),cmt=(t,e,n,i,r,s,a,o)=>(c,l)=>n(c).render(c,l).then(()=>Promise.all(Array.from(i(l)).map(u=>n(u).render(u,l)))).then(()=>r(l)).then(u=>(typeof u.copyFromChannel!="function"?(a(u),OX(u)):e(s,()=>s(u))||o(u),t.add(u),u)),lmt={channelCount:2,channelCountMode:"explicit",channelInterpretation:"speakers",pan:0},umt=(t,e,n,i,r,s)=>class extends t{constructor(o,c){const l=r(o),u={...lmt,...c},h=n(l,u),f=s(l),d=f?i():null;super(o,!1,h,d),this._pan=e(this,f,h.pan)}get pan(){return this._pan}},hmt=(t,e,n,i,r)=>()=>{const s=new WeakMap,a=async(o,c)=>{let l=n(o);const u=Tu(l,c);if(!u){const h={channelCount:l.channelCount,channelCountMode:l.channelCountMode,channelInterpretation:l.channelInterpretation,pan:l.pan.value};l=e(c,h)}return s.set(c,l),u?await t(c,o.pan,l.pan):await i(c,o.pan,l.pan),qA(l)?await r(o,c,l.inputs[0]):await r(o,c,l),l};return{render(o,c){const l=s.get(c);return l!==void 0?Promise.resolve(l):a(o,c)}}},fmt=t=>()=>{if(t===null)return!1;try{new t({length:1,sampleRate:44100})}catch{return!1}return!0},dmt=(t,e)=>async()=>{if(t===null)return!0;if(e===null)return!1;const n=new Blob(['class A extends AudioWorkletProcessor{process(i){this.port.postMessage(i,[i[0][0].buffer])}}registerProcessor("a",A)'],{type:"application/javascript; charset=utf-8"}),i=new e(1,128,44100),r=URL.createObjectURL(n);let s=!1,a=!1;try{await i.audioWorklet.addModule(r);const o=new t(i,"a",{numberOfOutputs:0}),c=i.createOscillator();o.port.onmessage=()=>s=!0,o.onprocessorerror=()=>a=!0,c.connect(o),c.start(0),await i.startRendering(),await new Promise(l=>setTimeout(l))}catch{}finally{URL.revokeObjectURL(r)}return s&&!a},pmt=(t,e)=>()=>{if(e===null)return Promise.resolve(!1);const n=new e(1,1,44100),i=t(n,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});return new Promise(r=>{n.oncomplete=()=>{i.disconnect(),r(n.currentTime!==0)},n.startRendering()})},mmt=()=>new DOMException("","UnknownError"),gmt={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",curve:null,oversample:"none"},vmt=(t,e,n,i,r,s,a)=>class extends t{constructor(c,l){const u=r(c),h={...gmt,...l},f=n(u,h),p=s(u)?i():null;super(c,!0,f,p),this._isCurveNullified=!1,this._nativeWaveShaperNode=f,a(this,1)}get curve(){return this._isCurveNullified?null:this._nativeWaveShaperNode.curve}set curve(c){if(c===null)this._isCurveNullified=!0,this._nativeWaveShaperNode.curve=new Float32Array([0,0]);else{if(c.length<2)throw e();this._isCurveNullified=!1,this._nativeWaveShaperNode.curve=c}}get oversample(){return this._nativeWaveShaperNode.oversample}set oversample(c){this._nativeWaveShaperNode.oversample=c}},_mt=(t,e,n)=>()=>{const i=new WeakMap,r=async(s,a)=>{let o=e(s);if(!Tu(o,a)){const l={channelCount:o.channelCount,channelCountMode:o.channelCountMode,channelInterpretation:o.channelInterpretation,curve:o.curve,oversample:o.oversample};o=t(a,l)}return i.set(a,o),qA(o)?await n(s,a,o.inputs[0]):await n(s,a,o),o};return{render(s,a){const o=i.get(a);return o!==void 0?Promise.resolve(o):r(s,a)}}},ymt=()=>typeof window>"u"?null:window,bmt=(t,e)=>n=>{n.copyFromChannel=(i,r,s=0)=>{const a=t(s),o=t(r);if(o>=n.numberOfChannels)throw e();const c=n.length,l=n.getChannelData(o),u=i.length;for(let h=a<0?-a:0;h+a<c&&h<u;h+=1)i[h]=l[h+a]},n.copyToChannel=(i,r,s=0)=>{const a=t(s),o=t(r);if(o>=n.numberOfChannels)throw e();const c=n.length,l=n.getChannelData(o),u=i.length;for(let h=a<0?-a:0;h+a<c&&h<u;h+=1)l[h+a]=i[h]}},Emt=t=>e=>{e.copyFromChannel=(n=>(i,r,s=0)=>{const a=t(s),o=t(r);if(a<e.length)return n.call(e,i,o,a)})(e.copyFromChannel),e.copyToChannel=(n=>(i,r,s=0)=>{const a=t(s),o=t(r);if(a<e.length)return n.call(e,i,o,a)})(e.copyToChannel)},Smt=t=>(e,n)=>{const i=n.createBuffer(1,1,44100);e.buffer===null&&(e.buffer=i),t(e,"buffer",r=>()=>{const s=r.call(e);return s===i?null:s},r=>s=>r.call(e,s===null?i:s))},Tmt=(t,e)=>(n,i)=>{i.channelCount=1,i.channelCountMode="explicit",Object.defineProperty(i,"channelCount",{get:()=>1,set:()=>{throw t()}}),Object.defineProperty(i,"channelCountMode",{get:()=>"explicit",set:()=>{throw t()}});const r=n.createBufferSource();e(i,()=>{const o=i.numberOfInputs;for(let c=0;c<o;c+=1)r.connect(i,0,c)},()=>r.disconnect(i))},Zye=(t,e,n)=>t.copyFromChannel===void 0?t.getChannelData(n)[0]:(t.copyFromChannel(e,n),e[0]),Jye=t=>{if(t===null)return!1;const e=t.length;return e%2!==0?t[Math.floor(e/2)]!==0:t[e/2-1]+t[e/2]!==0},Sk=(t,e,n,i)=>{let r=t;for(;!r.hasOwnProperty(e);)r=Object.getPrototypeOf(r);const{get:s,set:a}=Object.getOwnPropertyDescriptor(r,e);Object.defineProperty(t,e,{get:n(s),set:i(a)})},xmt=t=>({...t,outputChannelCount:t.outputChannelCount!==void 0?t.outputChannelCount:t.numberOfInputs===1&&t.numberOfOutputs===1?[t.channelCount]:Array.from({length:t.numberOfOutputs},()=>1)}),wmt=t=>({...t,channelCount:t.numberOfOutputs}),Cmt=t=>{const{imag:e,real:n}=t;return e===void 0?n===void 0?{...t,imag:[0,0],real:[0,0]}:{...t,imag:Array.from(n,()=>0),real:n}:n===void 0?{...t,imag:e,real:Array.from(e,()=>0)}:{...t,imag:e,real:n}},Qye=(t,e,n)=>{try{t.setValueAtTime(e,n)}catch(i){if(i.code!==9)throw i;Qye(t,e,n+1e-7)}},Amt=t=>{const e=t.createBufferSource();e.start();try{e.start()}catch{return!0}return!1},Rmt=t=>{const e=t.createBufferSource(),n=t.createBuffer(1,1,44100);e.buffer=n;try{e.start(0,1)}catch{return!1}return!0},Mmt=t=>{const e=t.createBufferSource();e.start();try{e.stop()}catch{return!1}return!0},PX=t=>{const e=t.createOscillator();try{e.start(-1)}catch(n){return n instanceof RangeError}return!1},ebe=t=>{const e=t.createBuffer(1,1,44100),n=t.createBufferSource();n.buffer=e,n.start(),n.stop();try{return n.stop(),!0}catch{return!1}},LX=t=>{const e=t.createOscillator();try{e.stop(-1)}catch(n){return n instanceof RangeError}return!1},Omt=t=>{const{port1:e,port2:n}=new MessageChannel;try{e.postMessage(t)}finally{e.close(),n.close()}},Nmt=t=>{t.start=(e=>(n=0,i=0,r)=>{const s=t.buffer,a=s===null?i:Math.min(s.duration,i);s!==null&&a>s.duration-.5/t.context.sampleRate?e.call(t,n,0,0):e.call(t,n,a,r)})(t.start)},tbe=(t,e)=>{const n=e.createGain();t.connect(n);const i=(r=>()=>{r.call(t,n),t.removeEventListener("ended",i)})(t.disconnect);t.addEventListener("ended",i),$A(t,n),t.stop=(r=>{let s=!1;return(a=0)=>{if(s)try{r.call(t,a)}catch{n.gain.setValueAtTime(0,a)}else r.call(t,a),s=!0}})(t.stop)},WA=(t,e)=>n=>{const i={value:t};return Object.defineProperties(n,{currentTarget:i,target:i}),typeof e=="function"?e.call(t,n):e.handleEvent.call(t,n)},Imt=Jht(D1),kmt=rft(D1),Dmt=gdt(Vz),nbe=new WeakMap,Pmt=Ddt(nbe),Rm=$ft(new Map,new WeakMap),o0=ymt(),ibe=upt(Rm,T0),UX=kdt(ah),ql=imt(ah,UX,a1),Lmt=lft(ibe,Ta,ql),oa=Udt(jz),z_=Upt(o0),Hs=ept(z_),rbe=new WeakMap,sbe=Cdt(WA),Tk=ppt(o0),BX=Kdt(Tk),FX=Zdt(o0),abe=Jdt(o0),IN=gpt(o0),Go=Dft(Qht(kye),ift(Imt,kmt,L3,Dmt,U3,ah,Pmt,gk,Ta,D1,d_,a1,F2),Rm,qdt(i$,U3,ah,Ta,ON,d_),T0,Gz,ph,fdt(L3,i$,ah,Ta,ON,oa,d_,Hs),ydt(rbe,ah,_m),sbe,oa,BX,FX,abe,Hs,IN),Umt=cft(Go,Lmt,T0,ibe,oa,Hs),zX=new WeakSet,fse=hpt(o0),obe=sdt(new Uint32Array(1)),HX=bmt(obe,T0),jX=Emt(obe),cbe=hft(zX,Rm,ph,fse,z_,fmt(fse),HX,jX),qz=sft(ff),lbe=rmt(UX,_k,a1),x0=Qft(lbe),YA=dpt(qz,Rm,Amt,Rmt,Mmt,PX,ebe,LX,Nmt,Smt(Sk),tbe),w0=nmt(Pdt(_k),lbe),Bmt=pft(x0,YA,Ta,w0,ql),Mm=Pft(eft(Dye),rbe,MX,Lft,$ht,Wht,Yht,Xht,Kht,e$,Nye,Tk,Qye),Fmt=dft(Go,Bmt,Mm,bl,YA,oa,Hs,WA),zmt=Tft(Go,xft,T0,bl,mpt(ff,Sk),oa,Hs,ql),Hmt=qft(x0,Yye,Ta,w0,ql),P1=omt(nbe),jmt=Gft(Go,Mm,Hmt,Gz,Yye,oa,Hs,P1),ME=cpt(D1,FX),Vmt=Tmt(bl,ME),OE=Tpt(Tk,Vmt),Gmt=Xft(OE,Ta,ql),qmt=Yft(Go,Gmt,OE,oa,Hs),$mt=Jft(bk,Ta,ql),Wmt=Zft(Go,$mt,bk,oa,Hs,wmt),Ymt=Cpt(qz,YA,ff,ME),XA=wpt(qz,Rm,Ymt,PX,LX),Xmt=rdt(x0,XA,Ta,w0,ql),Kmt=idt(Go,Mm,Xmt,XA,oa,Hs,WA),ube=Apt(ph,Sk),Zmt=cdt(ube,Ta,ql),Jmt=odt(Go,Zmt,ube,oa,Hs,P1),Qmt=mdt(x0,Xye,Ta,w0,ql),egt=pdt(Go,Mm,Qmt,Xye,oa,Hs,P1),hbe=Rpt(ph),tgt=Tdt(x0,hbe,Ta,w0,ql),ngt=Sdt(Go,Mm,tgt,hbe,ph,oa,Hs,P1),igt=Ndt(x0,ff,Ta,w0,ql),rgt=Odt(Go,Mm,igt,ff,oa,Hs),sgt=Ipt(Gz,bl,Ek,ph),$z=smt(Rm,ff,Ek,pmt(ff,z_)),agt=Gdt(YA,Ta,z_,ql,$z),ogt=Mpt(sgt),cgt=jdt(Go,ogt,agt,oa,Hs,P1),lgt=wft(Mm,OE,XA,Ek,ph,Zye,Hs,Sk),fbe=new WeakMap,ugt=opt(zmt,lgt,sbe,Hs,fbe,WA),dbe=Bpt(qz,Rm,PX,ebe,LX,tbe),hgt=Kpt(x0,dbe,Ta,w0,ql),fgt=Xpt(Go,Mm,dbe,hgt,oa,Hs,WA),pbe=tdt(YA),dgt=qpt(pbe,bl,ff,Jye,ME),Wz=Gpt(pbe,bl,dgt,Jye,ME,Tk,Sk),pgt=zpt(L3,bl,OE,ff,Ek,Wz,ph,U3,Zye,ME),mbe=Fpt(pgt),mgt=Qpt(x0,OE,XA,ff,mbe,Ta,z_,w0,ql,$z),ggt=Jpt(Go,Mm,mbe,mgt,oa,Hs,P1),vgt=Hpt(T0),_gt=tmt(vgt,oa,new WeakSet,Cmt),ygt=Vpt(OE,bk,ff,Wz,ph,ME),gbe=jpt(ygt,ph),bgt=hmt(x0,gbe,Ta,w0,ql),Egt=umt(Go,Mm,gbe,bgt,oa,Hs),Sgt=_mt(Wz,Ta,ql),Tgt=vmt(Go,bl,Wz,Sgt,oa,Hs,P1),vbe=tpt(o0),VX=Adt(o0),_be=new WeakMap,xgt=Bdt(_be,z_),wgt=vbe?nft(Rm,ph,wdt(o0),VX,Rdt(Zht),oa,xgt,Hs,IN,new WeakMap,new WeakMap,dmt(IN,z_),o0):void 0,Cgt=Qdt(BX,Hs),Agt=hdt(zX,Rm,udt,xdt,new WeakSet,oa,Cgt,D3,NN,HX,jX),ybe=jft(wgt,Umt,cbe,Fmt,jmt,qmt,Wmt,Kmt,Jmt,Agt,egt,ngt,rgt,cgt,ugt,fgt,ggt,_gt,Egt,Tgt),Rgt=npt(Go,kpt,oa,Hs),Mgt=rpt(Go,Dpt,oa,Hs),Ogt=spt(Go,Ppt,oa,Hs),Ngt=Lpt(bl,Hs),Igt=apt(Go,Ngt,oa),kgt=Sft(ybe,bl,ph,mmt,Rgt,Mgt,Ogt,Igt,Tk),GX=Fdt(fbe),Dgt=aft(GX),bbe=edt(T0),Pgt=vdt(GX),Ebe=bdt(T0),Sbe=new WeakMap,Lgt=Idt(Sbe,_m),Ugt=Spt(bbe,T0,bl,OE,bk,XA,ff,Ek,ph,Ebe,VX,Lgt,ME),Bgt=_pt(bl,Ugt,ff,ph,ME),Fgt=Hft(x0,bbe,YA,OE,bk,XA,ff,Pgt,Ebe,VX,Ta,IN,z_,w0,ql,$z),zgt=Ldt(_be),Hgt=amt(Sbe),dse=vbe?Bft(Dgt,Go,Mm,Fgt,Bgt,ah,zgt,oa,Hs,IN,xmt,Hgt,Omt,WA):void 0,jgt=ldt(ph,z_),Vgt=cmt(zX,Rm,UX,GX,$z,D3,HX,jX),Ggt=Wpt(ybe,Rm,bl,jgt,Vgt),qgt=$dt(jz,BX),$gt=Wdt(RX,FX),Wgt=Ydt(MX,abe),Ygt=Xdt(jz,Hs);function ad(t){return t===void 0}function vr(t){return t!==void 0}function Xgt(t){return typeof t=="function"}function ym(t){return typeof t=="number"}function zb(t){return Object.prototype.toString.call(t)==="[object Object]"&&t.constructor===Object}function Tbe(t){return typeof t=="boolean"}function nf(t){return Array.isArray(t)}function M_(t){return typeof t=="string"}function FP(t){return M_(t)&&/^([a-g]{1}(?:b|#|x|bb)?)(-?[0-9]+)/i.test(t)}function Ai(t,e){if(!t)throw new Error(e)}function ap(t,e,n=1/0){if(!(e<=t&&t<=n))throw new RangeError(`Value must be within [${e}, ${n}], got: ${t}`)}function xbe(t){!t.isOffline&&t.state!=="running"&&Yz('The AudioContext is "suspended". Invoke Tone.start() from a user action to start the audio.')}let wbe=!1,pse=!1;function mse(t){wbe=t}function Kgt(t){ad(t)&&wbe&&!pse&&(pse=!0,Yz("Events scheduled inside of scheduled callbacks should use the passed in scheduling time. See https://github.com/Tonejs/Tone.js/wiki/Accurate-Timing"))}let Cbe=console;function Zgt(...t){Cbe.log(...t)}function Yz(...t){Cbe.warn(...t)}function Jgt(t){return new kgt(t)}function Qgt(t,e,n){return new Ggt(t,e,n)}const Yf=typeof self=="object"?self:null,e0t=Yf&&(Yf.hasOwnProperty("AudioContext")||Yf.hasOwnProperty("webkitAudioContext"));function t0t(t,e,n){return Ai(vr(dse),"AudioWorkletNode only works in a secure context (https or localhost)"),new(t instanceof(Yf==null?void 0:Yf.BaseAudioContext)?Yf==null?void 0:Yf.AudioWorkletNode:dse)(t,e,n)}var c$=function(t,e){return c$=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(n[r]=i[r])},c$(t,e)};function Abe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");c$(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}function ca(t,e,n,i){var r=arguments.length,s=r<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,n):i,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(t,e,n,i);else for(var o=t.length-1;o>=0;o--)(a=t[o])&&(s=(r<3?a(s):r>3?a(e,n,s):a(e,n))||s);return r>3&&s&&Object.defineProperty(e,n,s),s}function Qa(t,e,n,i){function r(s){return s instanceof n?s:new n(function(a){a(s)})}return new(n||(n=Promise))(function(s,a){function o(u){try{l(i.next(u))}catch(h){a(h)}}function c(u){try{l(i.throw(u))}catch(h){a(h)}}function l(u){u.done?s(u.value):r(u.value).then(o,c)}l((i=i.apply(t,e||[])).next())})}function qX(t,e){var n={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},i,r,s,a=Object.create((typeof Iterator=="function"?Iterator:Object).prototype);return a.next=o(0),a.throw=o(1),a.return=o(2),typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function o(l){return function(u){return c([l,u])}}function c(l){if(i)throw new TypeError("Generator is already executing.");for(;a&&(a=0,l[0]&&(n=0)),n;)try{if(i=1,r&&(s=l[0]&2?r.return:l[0]?r.throw||((s=r.return)&&s.call(r),0):r.next)&&!(s=s.call(r,l[1])).done)return s;switch(r=0,s&&(l=[l[0]&2,s.value]),l[0]){case 0:case 1:s=l;break;case 4:return n.label++,{value:l[1],done:!1};case 5:n.label++,r=l[1],l=[0];continue;case 7:l=n.ops.pop(),n.trys.pop();continue;default:if(s=n.trys,!(s=s.length>0&&s[s.length-1])&&(l[0]===6||l[0]===2)){n=0;continue}if(l[0]===3&&(!s||l[1]>s[0]&&l[1]<s[3])){n.label=l[1];break}if(l[0]===6&&n.label<s[1]){n.label=s[1],s=l;break}if(s&&n.label<s[2]){n.label=s[2],n.ops.push(l);break}s[2]&&n.ops.pop(),n.trys.pop();continue}l=e.call(t,n)}catch(u){l=[6,u],r=0}finally{i=s=0}if(l[0]&5)throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}}function Xz(t,e){var n=typeof Symbol=="function"&&t[Symbol.iterator];if(!n)return t;var i=n.call(t),r,s=[],a;try{for(;(e===void 0||e-- >0)&&!(r=i.next()).done;)s.push(r.value)}catch(o){a={error:o}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(a)throw a.error}}return s}function l$(t,e,n){if(n||arguments.length===2)for(var i=0,r=e.length,s;i<r;i++)(s||!(i in e))&&(s||(s=Array.prototype.slice.call(e,0,i)),s[i]=e[i]);return t.concat(s||Array.prototype.slice.call(e))}class n0t{constructor(e,n,i,r){this._callback=e,this._type=n,this._minimumUpdateInterval=Math.max(128/(r||44100),.001),this.updateInterval=i,this._createClock()}_createWorker(){const e=new Blob([`
			// the initial timeout time
			let timeoutTime =  ${(this._updateInterval*1e3).toFixed(1)};
			// onmessage callback
			self.onmessage = function(msg){
				timeoutTime = parseInt(msg.data);
			};
			// the tick function which posts a message
			// and schedules a new tick
			function tick(){
				setTimeout(tick, timeoutTime);
				self.postMessage('tick');
			}
			// call tick initially
			tick();
			`],{type:"text/javascript"}),n=URL.createObjectURL(e),i=new Worker(n);i.onmessage=this._callback.bind(this),this._worker=i}_createTimeout(){this._timeout=setTimeout(()=>{this._createTimeout(),this._callback()},this._updateInterval*1e3)}_createClock(){if(this._type==="worker")try{this._createWorker()}catch{this._type="timeout",this._createClock()}else this._type==="timeout"&&this._createTimeout()}_disposeClock(){this._timeout&&clearTimeout(this._timeout),this._worker&&(this._worker.terminate(),this._worker.onmessage=null)}get updateInterval(){return this._updateInterval}set updateInterval(e){var n;this._updateInterval=Math.max(e,this._minimumUpdateInterval),this._type==="worker"&&((n=this._worker)===null||n===void 0||n.postMessage(this._updateInterval*1e3))}get type(){return this._type}set type(e){this._disposeClock(),this._type=e,this._createClock()}dispose(){this._disposeClock()}}function o1(t){return Wgt(t)}function Hb(t){return $gt(t)}function z2(t){return Ygt(t)}function cw(t){return qgt(t)}function i0t(t){return t instanceof cbe}function r0t(t,e){return t==="value"||o1(e)||Hb(e)||i0t(e)}function AT(t,...e){if(!e.length)return t;const n=e.shift();if(zb(t)&&zb(n))for(const i in n)r0t(i,n[i])?t[i]=n[i]:zb(n[i])?(t[i]||Object.assign(t,{[i]:{}}),AT(t[i],n[i])):Object.assign(t,{[i]:n[i]});return AT(t,...e)}function s0t(t,e){return t.length===e.length&&t.every((n,i)=>e[i]===n)}function Pn(t,e,n=[],i){const r={},s=Array.from(e);if(zb(s[0])&&i&&!Reflect.has(s[0],i)&&(Object.keys(s[0]).some(o=>Reflect.has(t,o))||(AT(r,{[i]:s[0]}),n.splice(n.indexOf(i),1),s.shift())),s.length===1&&zb(s[0]))AT(r,s[0]);else for(let a=0;a<n.length;a++)vr(s[a])&&(r[n[a]]=s[a]);return AT(t,r)}function a0t(t){return t.constructor.getDefaults()}function Xg(t,e){return ad(t)?e:t}function kN(t,e){return e.forEach(n=>{Reflect.has(t,n)&&delete t[n]}),t}/**
 * Tone.js
 * @author Yotam Mann
 * @license http://opensource.org/licenses/MIT MIT License
 * @copyright 2014-2024 Yotam Mann
 */class H_{constructor(){this.debug=!1,this._wasDisposed=!1}static getDefaults(){return{}}log(...e){(this.debug||Yf&&this.toString()===Yf.TONE_DEBUG_CLASS)&&Zgt(this,...e)}dispose(){return this._wasDisposed=!0,this}get disposed(){return this._wasDisposed}toString(){return this.name}}H_.version=Oye;const $X=1e-6;function lA(t,e){return t>e+$X}function u$(t,e){return lA(t,e)||am(t,e)}function H3(t,e){return t+$X<e}function am(t,e){return Math.abs(t-e)<$X}function o0t(t,e,n){return Math.max(Math.min(t,n),e)}class fp extends H_{constructor(){super(),this.name="Timeline",this._timeline=[];const e=Pn(fp.getDefaults(),arguments,["memory"]);this.memory=e.memory,this.increasing=e.increasing}static getDefaults(){return{memory:1/0,increasing:!1}}get length(){return this._timeline.length}add(e){if(Ai(Reflect.has(e,"time"),"Timeline: events must have a time attribute"),e.time=e.time.valueOf(),this.increasing&&this.length){const n=this._timeline[this.length-1];Ai(u$(e.time,n.time),"The time must be greater than or equal to the last scheduled time"),this._timeline.push(e)}else{const n=this._search(e.time);this._timeline.splice(n+1,0,e)}if(this.length>this.memory){const n=this.length-this.memory;this._timeline.splice(0,n)}return this}remove(e){const n=this._timeline.indexOf(e);return n!==-1&&this._timeline.splice(n,1),this}get(e,n="time"){const i=this._search(e,n);return i!==-1?this._timeline[i]:null}peek(){return this._timeline[0]}shift(){return this._timeline.shift()}getAfter(e,n="time"){const i=this._search(e,n);return i+1<this._timeline.length?this._timeline[i+1]:null}getBefore(e){const n=this._timeline.length;if(n>0&&this._timeline[n-1].time<e)return this._timeline[n-1];const i=this._search(e);return i-1>=0?this._timeline[i-1]:null}cancel(e){if(this._timeline.length>1){let n=this._search(e);if(n>=0)if(am(this._timeline[n].time,e)){for(let i=n;i>=0&&am(this._timeline[i].time,e);i--)n=i;this._timeline=this._timeline.slice(0,n)}else this._timeline=this._timeline.slice(0,n+1);else this._timeline=[]}else this._timeline.length===1&&u$(this._timeline[0].time,e)&&(this._timeline=[]);return this}cancelBefore(e){const n=this._search(e);return n>=0&&(this._timeline=this._timeline.slice(n+1)),this}previousEvent(e){const n=this._timeline.indexOf(e);return n>0?this._timeline[n-1]:null}_search(e,n="time"){if(this._timeline.length===0)return-1;let i=0;const r=this._timeline.length;let s=r;if(r>0&&this._timeline[r-1][n]<=e)return r-1;for(;i<s;){let a=Math.floor(i+(s-i)/2);const o=this._timeline[a],c=this._timeline[a+1];if(am(o[n],e)){for(let l=a;l<this._timeline.length;l++){const u=this._timeline[l];if(am(u[n],e))a=l;else break}return a}else{if(H3(o[n],e)&&lA(c[n],e))return a;lA(o[n],e)?s=a:i=a+1}}return-1}_iterate(e,n=0,i=this._timeline.length-1){this._timeline.slice(n,i+1).forEach(e)}forEach(e){return this._iterate(e),this}forEachBefore(e,n){const i=this._search(e);return i!==-1&&this._iterate(n,0,i),this}forEachAfter(e,n){const i=this._search(e);return this._iterate(n,i+1),this}forEachBetween(e,n,i){let r=this._search(e),s=this._search(n);return r!==-1&&s!==-1?(this._timeline[r].time!==e&&(r+=1),this._timeline[s].time===n&&(s-=1),this._iterate(i,r,s)):r===-1&&this._iterate(i,0,s),this}forEachFrom(e,n){let i=this._search(e);for(;i>=0&&this._timeline[i].time>=e;)i--;return this._iterate(n,i+1),this}forEachAtTime(e,n){const i=this._search(e);if(i!==-1&&am(this._timeline[i].time,e)){let r=i;for(let s=i;s>=0&&am(this._timeline[s].time,e);s--)r=s;this._iterate(s=>{n(s)},r,i)}return this}dispose(){return super.dispose(),this._timeline=[],this}}const Rbe=[];function Kz(t){Rbe.push(t)}function c0t(t){Rbe.forEach(e=>e(t))}const Mbe=[];function Zz(t){Mbe.push(t)}function l0t(t){Mbe.forEach(e=>e(t))}class xk extends H_{constructor(){super(...arguments),this.name="Emitter"}on(e,n){return e.split(/\W+/).forEach(r=>{ad(this._events)&&(this._events={}),this._events.hasOwnProperty(r)||(this._events[r]=[]),this._events[r].push(n)}),this}once(e,n){const i=(...r)=>{n(...r),this.off(e,i)};return this.on(e,i),this}off(e,n){return e.split(/\W+/).forEach(r=>{if(ad(this._events)&&(this._events={}),this._events.hasOwnProperty(r))if(ad(n))this._events[r]=[];else{const s=this._events[r];for(let a=s.length-1;a>=0;a--)s[a]===n&&s.splice(a,1)}}),this}emit(e,...n){if(this._events&&this._events.hasOwnProperty(e)){const i=this._events[e].slice(0);for(let r=0,s=i.length;r<s;r++)i[r].apply(this,n)}return this}static mixin(e){["on","once","off","emit"].forEach(n=>{const i=Object.getOwnPropertyDescriptor(xk.prototype,n);Object.defineProperty(e.prototype,n,i)})}dispose(){return super.dispose(),this._events=void 0,this}}class Obe extends xk{constructor(){super(...arguments),this.isOffline=!1}toJSON(){return{}}}class KA extends Obe{constructor(){var e,n;super(),this.name="Context",this._constants=new Map,this._timeouts=new fp,this._timeoutIds=0,this._initialized=!1,this._closeStarted=!1,this.isOffline=!1,this._workletPromise=null;const i=Pn(KA.getDefaults(),arguments,["context"]);i.context?(this._context=i.context,this._latencyHint=((e=arguments[0])===null||e===void 0?void 0:e.latencyHint)||""):(this._context=Jgt({latencyHint:i.latencyHint}),this._latencyHint=i.latencyHint),this._ticker=new n0t(this.emit.bind(this,"tick"),i.clockSource,i.updateInterval,this._context.sampleRate),this.on("tick",this._timeoutLoop.bind(this)),this._context.onstatechange=()=>{this.emit("statechange",this.state)},this[!((n=arguments[0])===null||n===void 0)&&n.hasOwnProperty("updateInterval")?"_lookAhead":"lookAhead"]=i.lookAhead}static getDefaults(){return{clockSource:"worker",latencyHint:"interactive",lookAhead:.1,updateInterval:.05}}initialize(){return this._initialized||(c0t(this),this._initialized=!0),this}createAnalyser(){return this._context.createAnalyser()}createOscillator(){return this._context.createOscillator()}createBufferSource(){return this._context.createBufferSource()}createBiquadFilter(){return this._context.createBiquadFilter()}createBuffer(e,n,i){return this._context.createBuffer(e,n,i)}createChannelMerger(e){return this._context.createChannelMerger(e)}createChannelSplitter(e){return this._context.createChannelSplitter(e)}createConstantSource(){return this._context.createConstantSource()}createConvolver(){return this._context.createConvolver()}createDelay(e){return this._context.createDelay(e)}createDynamicsCompressor(){return this._context.createDynamicsCompressor()}createGain(){return this._context.createGain()}createIIRFilter(e,n){return this._context.createIIRFilter(e,n)}createPanner(){return this._context.createPanner()}createPeriodicWave(e,n,i){return this._context.createPeriodicWave(e,n,i)}createStereoPanner(){return this._context.createStereoPanner()}createWaveShaper(){return this._context.createWaveShaper()}createMediaStreamSource(e){return Ai(cw(this._context),"Not available if OfflineAudioContext"),this._context.createMediaStreamSource(e)}createMediaElementSource(e){return Ai(cw(this._context),"Not available if OfflineAudioContext"),this._context.createMediaElementSource(e)}createMediaStreamDestination(){return Ai(cw(this._context),"Not available if OfflineAudioContext"),this._context.createMediaStreamDestination()}decodeAudioData(e){return this._context.decodeAudioData(e)}get currentTime(){return this._context.currentTime}get state(){return this._context.state}get sampleRate(){return this._context.sampleRate}get listener(){return this.initialize(),this._listener}set listener(e){Ai(!this._initialized,"The listener cannot be set after initialization."),this._listener=e}get transport(){return this.initialize(),this._transport}set transport(e){Ai(!this._initialized,"The transport cannot be set after initialization."),this._transport=e}get draw(){return this.initialize(),this._draw}set draw(e){Ai(!this._initialized,"Draw cannot be set after initialization."),this._draw=e}get destination(){return this.initialize(),this._destination}set destination(e){Ai(!this._initialized,"The destination cannot be set after initialization."),this._destination=e}createAudioWorkletNode(e,n){return t0t(this.rawContext,e,n)}addAudioWorkletModule(e){return Qa(this,void 0,void 0,function*(){Ai(vr(this.rawContext.audioWorklet),"AudioWorkletNode is only available in a secure context (https or localhost)"),this._workletPromise||(this._workletPromise=this.rawContext.audioWorklet.addModule(e)),yield this._workletPromise})}workletsAreReady(){return Qa(this,void 0,void 0,function*(){(yield this._workletPromise)?this._workletPromise:Promise.resolve()})}get updateInterval(){return this._ticker.updateInterval}set updateInterval(e){this._ticker.updateInterval=e}get clockSource(){return this._ticker.type}set clockSource(e){this._ticker.type=e}get lookAhead(){return this._lookAhead}set lookAhead(e){this._lookAhead=e,this.updateInterval=e?e/2:.01}get latencyHint(){return this._latencyHint}get rawContext(){return this._context}now(){return this._context.currentTime+this._lookAhead}immediate(){return this._context.currentTime}resume(){return cw(this._context)?this._context.resume():Promise.resolve()}close(){return Qa(this,void 0,void 0,function*(){cw(this._context)&&this.state!=="closed"&&!this._closeStarted&&(this._closeStarted=!0,yield this._context.close()),this._initialized&&l0t(this)})}getConstant(e){if(this._constants.has(e))return this._constants.get(e);{const n=this._context.createBuffer(1,128,this._context.sampleRate),i=n.getChannelData(0);for(let s=0;s<i.length;s++)i[s]=e;const r=this._context.createBufferSource();return r.channelCount=1,r.channelCountMode="explicit",r.buffer=n,r.loop=!0,r.start(0),this._constants.set(e,r),r}}dispose(){return super.dispose(),this._ticker.dispose(),this._timeouts.dispose(),Object.keys(this._constants).map(e=>this._constants[e].disconnect()),this.close(),this}_timeoutLoop(){const e=this.now();this._timeouts.forEachBefore(e,n=>{n.callback(),this._timeouts.remove(n)})}setTimeout(e,n){this._timeoutIds++;const i=this.now();return this._timeouts.add({callback:e,id:this._timeoutIds,time:i+n}),this._timeoutIds}clearTimeout(e){return this._timeouts.forEach(n=>{n.id===e&&this._timeouts.remove(n)}),this}clearInterval(e){return this.clearTimeout(e)}setInterval(e,n){const i=++this._timeoutIds,r=()=>{const s=this.now();this._timeouts.add({callback:()=>{e(),r()},id:i,time:s+n})};return r(),i}}class u0t extends Obe{constructor(){super(...arguments),this.lookAhead=0,this.latencyHint=0,this.isOffline=!1}createAnalyser(){return{}}createOscillator(){return{}}createBufferSource(){return{}}createBiquadFilter(){return{}}createBuffer(e,n,i){return{}}createChannelMerger(e){return{}}createChannelSplitter(e){return{}}createConstantSource(){return{}}createConvolver(){return{}}createDelay(e){return{}}createDynamicsCompressor(){return{}}createGain(){return{}}createIIRFilter(e,n){return{}}createPanner(){return{}}createPeriodicWave(e,n,i){return{}}createStereoPanner(){return{}}createWaveShaper(){return{}}createMediaStreamSource(e){return{}}createMediaElementSource(e){return{}}createMediaStreamDestination(){return{}}decodeAudioData(e){return Promise.resolve({})}createAudioWorkletNode(e,n){return{}}get rawContext(){return{}}addAudioWorkletModule(e){return Qa(this,void 0,void 0,function*(){return Promise.resolve()})}resume(){return Promise.resolve()}setTimeout(e,n){return 0}clearTimeout(e){return this}setInterval(e,n){return 0}clearInterval(e){return this}getConstant(e){return{}}get currentTime(){return 0}get state(){return{}}get sampleRate(){return 0}get listener(){return{}}get transport(){return{}}get draw(){return{}}set draw(e){}get destination(){return{}}set destination(e){}now(){return 0}immediate(){return 0}}function Ar(t,e){nf(e)?e.forEach(n=>Ar(t,n)):Object.defineProperty(t,e,{enumerable:!0,writable:!1})}function wk(t,e){nf(e)?e.forEach(n=>wk(t,n)):Object.defineProperty(t,e,{writable:!0})}const Ts=()=>{};class Us extends H_{constructor(){super(),this.name="ToneAudioBuffer",this.onload=Ts;const e=Pn(Us.getDefaults(),arguments,["url","onload","onerror"]);this.reverse=e.reverse,this.onload=e.onload,M_(e.url)?this.load(e.url).catch(e.onerror):e.url&&this.set(e.url)}static getDefaults(){return{onerror:Ts,onload:Ts,reverse:!1}}get sampleRate(){return this._buffer?this._buffer.sampleRate:hc().sampleRate}set(e){return e instanceof Us?e.loaded?this._buffer=e.get():e.onload=()=>{this.set(e),this.onload(this)}:this._buffer=e,this._reversed&&this._reverse(),this}get(){return this._buffer}load(e){return Qa(this,void 0,void 0,function*(){const n=Us.load(e).then(i=>{this.set(i),this.onload(this)});Us.downloads.push(n);try{yield n}finally{const i=Us.downloads.indexOf(n);Us.downloads.splice(i,1)}return this})}dispose(){return super.dispose(),this._buffer=void 0,this}fromArray(e){const n=nf(e)&&e[0].length>0,i=n?e.length:1,r=n?e[0].length:e.length,s=hc(),a=s.createBuffer(i,r,s.sampleRate),o=!n&&i===1?[e]:e;for(let c=0;c<i;c++)a.copyToChannel(o[c],c);return this._buffer=a,this}toMono(e){if(ym(e))this.fromArray(this.toArray(e));else{let n=new Float32Array(this.length);const i=this.numberOfChannels;for(let r=0;r<i;r++){const s=this.toArray(r);for(let a=0;a<s.length;a++)n[a]+=s[a]}n=n.map(r=>r/i),this.fromArray(n)}return this}toArray(e){if(ym(e))return this.getChannelData(e);if(this.numberOfChannels===1)return this.toArray(0);{const n=[];for(let i=0;i<this.numberOfChannels;i++)n[i]=this.getChannelData(i);return n}}getChannelData(e){return this._buffer?this._buffer.getChannelData(e):new Float32Array(0)}slice(e,n=this.duration){Ai(this.loaded,"Buffer is not loaded");const i=Math.floor(e*this.sampleRate),r=Math.floor(n*this.sampleRate);Ai(i<r,"The start time must be less than the end time");const s=r-i,a=hc().createBuffer(this.numberOfChannels,s,this.sampleRate);for(let o=0;o<this.numberOfChannels;o++)a.copyToChannel(this.getChannelData(o).subarray(i,r),o);return new Us(a)}_reverse(){if(this.loaded)for(let e=0;e<this.numberOfChannels;e++)this.getChannelData(e).reverse();return this}get loaded(){return this.length>0}get duration(){return this._buffer?this._buffer.duration:0}get length(){return this._buffer?this._buffer.length:0}get numberOfChannels(){return this._buffer?this._buffer.numberOfChannels:0}get reverse(){return this._reversed}set reverse(e){this._reversed!==e&&(this._reversed=e,this._reverse())}static fromArray(e){return new Us().fromArray(e)}static fromUrl(e){return Qa(this,void 0,void 0,function*(){return yield new Us().load(e)})}static load(e){return Qa(this,void 0,void 0,function*(){const n=Us.baseUrl===""||Us.baseUrl.endsWith("/")?Us.baseUrl:Us.baseUrl+"/",i=yield fetch(n+e);if(!i.ok)throw new Error(`could not load url: ${e}`);const r=yield i.arrayBuffer();return yield hc().decodeAudioData(r)})}static supportsType(e){const n=e.split("."),i=n[n.length-1];return document.createElement("audio").canPlayType("audio/"+i)!==""}static loaded(){return Qa(this,void 0,void 0,function*(){for(yield Promise.resolve();Us.downloads.length;)yield Us.downloads[0]})}}Us.baseUrl="";Us.downloads=[];class Jz extends KA{constructor(){super({clockSource:"offline",context:z2(arguments[0])?arguments[0]:Qgt(arguments[0],arguments[1]*arguments[2],arguments[2]),lookAhead:0,updateInterval:z2(arguments[0])?128/arguments[0].sampleRate:128/arguments[2]}),this.name="OfflineContext",this._currentTime=0,this.isOffline=!0,this._duration=z2(arguments[0])?arguments[0].length/arguments[0].sampleRate:arguments[1]}now(){return this._currentTime}get currentTime(){return this._currentTime}_renderClock(e){return Qa(this,void 0,void 0,function*(){let n=0;for(;this._duration-this._currentTime>=0;){this.emit("tick"),this._currentTime+=128/this.sampleRate,n++;const i=Math.floor(this.sampleRate/128);e&&n%i===0&&(yield new Promise(r=>setTimeout(r,1)))}})}render(){return Qa(this,arguments,void 0,function*(e=!0){yield this.workletsAreReady(),yield this._renderClock(e);const n=yield this._context.startRendering();return new Us(n)})}close(){return Promise.resolve()}}const Nbe=new u0t;let fT=Nbe;function hc(){return fT===Nbe&&e0t&&Ibe(new KA),fT}function Ibe(t,e=!1){e&&fT.dispose(),cw(t)?fT=new KA(t):z2(t)?fT=new Jz(t):fT=t}function h0t(){return fT.resume()}if(Yf&&!Yf.TONE_SILENCE_LOGGING){const e=` * Tone.js v${Oye} * `;console.log(`%c${e}`,"background: #000; color: #fff")}function f0t(t){return Math.pow(10,t/20)}function d0t(t){return 20*(Math.log(t)/Math.LN10)}function kbe(t){return Math.pow(2,t/12)}let Qz=440;function p0t(){return Qz}function m0t(t){Qz=t}function dT(t){return Math.round(Dbe(t))}function Dbe(t){return 69+12*Math.log2(t/Qz)}function Pbe(t){return Qz*Math.pow(2,(t-69)/12)}class WX extends H_{constructor(e,n,i){super(),this.defaultUnits="s",this._val=n,this._units=i,this.context=e,this._expressions=this._getExpressions()}_getExpressions(){return{hz:{method:e=>this._frequencyToUnits(parseFloat(e)),regexp:/^(\d+(?:\.\d+)?)hz$/i},i:{method:e=>this._ticksToUnits(parseInt(e,10)),regexp:/^(\d+)i$/i},m:{method:e=>this._beatsToUnits(parseInt(e,10)*this._getTimeSignature()),regexp:/^(\d+)m$/i},n:{method:(e,n)=>{const i=parseInt(e,10),r=n==="."?1.5:1;return i===1?this._beatsToUnits(this._getTimeSignature())*r:this._beatsToUnits(4/i)*r},regexp:/^(\d+)n(\.?)$/i},number:{method:e=>this._expressions[this.defaultUnits].method.call(this,e),regexp:/^(\d+(?:\.\d+)?)$/},s:{method:e=>this._secondsToUnits(parseFloat(e)),regexp:/^(\d+(?:\.\d+)?)s$/},samples:{method:e=>parseInt(e,10)/this.context.sampleRate,regexp:/^(\d+)samples$/},t:{method:e=>{const n=parseInt(e,10);return this._beatsToUnits(8/(Math.floor(n)*3))},regexp:/^(\d+)t$/i},tr:{method:(e,n,i)=>{let r=0;return e&&e!=="0"&&(r+=this._beatsToUnits(this._getTimeSignature()*parseFloat(e))),n&&n!=="0"&&(r+=this._beatsToUnits(parseFloat(n))),i&&i!=="0"&&(r+=this._beatsToUnits(parseFloat(i)/4)),r},regexp:/^(\d+(?:\.\d+)?):(\d+(?:\.\d+)?):?(\d+(?:\.\d+)?)?$/}}}valueOf(){if(this._val instanceof WX&&this.fromType(this._val),ad(this._val))return this._noArg();if(M_(this._val)&&ad(this._units)){for(const e in this._expressions)if(this._expressions[e].regexp.test(this._val.trim())){this._units=e;break}}else if(zb(this._val)){let e=0;for(const n in this._val)if(vr(this._val[n])){const i=this._val[n],r=new this.constructor(this.context,n).valueOf()*i;e+=r}return e}if(vr(this._units)){const e=this._expressions[this._units],n=this._val.toString().trim().match(e.regexp);return n?e.method.apply(this,n.slice(1)):e.method.call(this,this._val)}else return M_(this._val)?parseFloat(this._val):this._val}_frequencyToUnits(e){return 1/e}_beatsToUnits(e){return 60/this._getBpm()*e}_secondsToUnits(e){return e}_ticksToUnits(e){return e*this._beatsToUnits(1)/this._getPPQ()}_noArg(){return this._now()}_getBpm(){return this.context.transport.bpm.value}_getTimeSignature(){return this.context.transport.timeSignature}_getPPQ(){return this.context.transport.PPQ}fromType(e){switch(this._units=void 0,this.defaultUnits){case"s":this._val=e.toSeconds();break;case"i":this._val=e.toTicks();break;case"hz":this._val=e.toFrequency();break;case"midi":this._val=e.toMidi();break}return this}toFrequency(){return 1/this.toSeconds()}toSamples(){return this.toSeconds()*this.context.sampleRate}toMilliseconds(){return this.toSeconds()*1e3}}class op extends WX{constructor(){super(...arguments),this.name="TimeClass"}_getExpressions(){return Object.assign(super._getExpressions(),{now:{method:e=>this._now()+new this.constructor(this.context,e).valueOf(),regexp:/^\+(.+)/},quantize:{method:e=>{const n=new op(this.context,e).valueOf();return this._secondsToUnits(this.context.transport.nextSubdivision(n))},regexp:/^@(.+)/}})}quantize(e,n=1){const i=new this.constructor(this.context,e).valueOf(),r=this.valueOf(),o=Math.round(r/i)*i-r;return r+o*n}toNotation(){const e=this.toSeconds(),n=["1m"];for(let s=1;s<9;s++){const a=Math.pow(2,s);n.push(a+"n."),n.push(a+"n"),n.push(a+"t")}n.push("0");let i=n[0],r=new op(this.context,n[0]).toSeconds();return n.forEach(s=>{const a=new op(this.context,s).toSeconds();Math.abs(a-e)<Math.abs(r-e)&&(i=s,r=a)}),i}toBarsBeatsSixteenths(){const e=this._beatsToUnits(1);let n=this.valueOf()/e;n=parseFloat(n.toFixed(4));const i=Math.floor(n/this._getTimeSignature());let r=n%1*4;n=Math.floor(n)%this._getTimeSignature();const s=r.toString();return s.length>3&&(r=parseFloat(parseFloat(s).toFixed(3))),[i,n,r].join(":")}toTicks(){const e=this._beatsToUnits(1);return this.valueOf()/e*this._getPPQ()}toSeconds(){return this.valueOf()}toMidi(){return dT(this.toFrequency())}_now(){return this.context.now()}}function Mc(t,e){return new op(hc(),t,e)}class Jh extends op{constructor(){super(...arguments),this.name="Frequency",this.defaultUnits="hz"}static get A4(){return p0t()}static set A4(e){m0t(e)}_getExpressions(){return Object.assign({},super._getExpressions(),{midi:{regexp:/^(\d+(?:\.\d+)?midi)/,method(e){return this.defaultUnits==="midi"?e:Jh.mtof(e)}},note:{regexp:/^([a-g]{1}(?:b|#|##|x|bb|###|#x|x#|bbb)?)(-?[0-9]+)/i,method(e,n){const r=g0t[e.toLowerCase()]+(parseInt(n,10)+1)*12;return this.defaultUnits==="midi"?r:Jh.mtof(r)}},tr:{regexp:/^(\d+(?:\.\d+)?):(\d+(?:\.\d+)?):?(\d+(?:\.\d+)?)?/,method(e,n,i){let r=1;return e&&e!=="0"&&(r*=this._beatsToUnits(this._getTimeSignature()*parseFloat(e))),n&&n!=="0"&&(r*=this._beatsToUnits(parseFloat(n))),i&&i!=="0"&&(r*=this._beatsToUnits(parseFloat(i)/4)),r}}})}transpose(e){return new Jh(this.context,this.valueOf()*kbe(e))}harmonize(e){return e.map(n=>this.transpose(n))}toMidi(){return dT(this.valueOf())}toNote(){const e=this.toFrequency(),n=Math.log2(e/Jh.A4);let i=Math.round(12*n)+57;const r=Math.floor(i/12);return r<0&&(i+=-12*r),v0t[i%12]+r.toString()}toSeconds(){return 1/super.toSeconds()}toTicks(){const e=this._beatsToUnits(1),n=this.valueOf()/e;return Math.floor(n*this._getPPQ())}_noArg(){return 0}_frequencyToUnits(e){return e}_ticksToUnits(e){return 1/(e*60/(this._getBpm()*this._getPPQ()))}_beatsToUnits(e){return 1/super._beatsToUnits(e)}_secondsToUnits(e){return 1/e}static mtof(e){return Pbe(e)}static ftom(e){return dT(e)}}const g0t={cbbb:-3,cbb:-2,cb:-1,c:0,"c#":1,cx:2,"c##":2,"c###":3,"cx#":3,"c#x":3,dbbb:-1,dbb:0,db:1,d:2,"d#":3,dx:4,"d##":4,"d###":5,"dx#":5,"d#x":5,ebbb:1,ebb:2,eb:3,e:4,"e#":5,ex:6,"e##":6,"e###":7,"ex#":7,"e#x":7,fbbb:2,fbb:3,fb:4,f:5,"f#":6,fx:7,"f##":7,"f###":8,"fx#":8,"f#x":8,gbbb:4,gbb:5,gb:6,g:7,"g#":8,gx:9,"g##":9,"g###":10,"gx#":10,"g#x":10,abbb:6,abb:7,ab:8,a:9,"a#":10,ax:11,"a##":11,"a###":12,"ax#":12,"a#x":12,bbbb:8,bbb:9,bb:10,b:11,"b#":12,bx:13,"b##":13,"b###":14,"bx#":14,"b#x":14},v0t=["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"];function gse(t,e){return new Jh(hc(),t,e)}class cC extends op{constructor(){super(...arguments),this.name="TransportTime"}_now(){return this.context.transport.seconds}}class _u extends H_{constructor(){super();const e=Pn(_u.getDefaults(),arguments,["context"]);this.defaultContext?this.context=this.defaultContext:this.context=e.context}static getDefaults(){return{context:hc()}}now(){return this.context.currentTime+this.context.lookAhead}immediate(){return this.context.currentTime}get sampleTime(){return 1/this.context.sampleRate}get blockTime(){return 128/this.context.sampleRate}toSeconds(e){return Kgt(e),new op(this.context,e).toSeconds()}toFrequency(e){return new Jh(this.context,e).toFrequency()}toTicks(e){return new cC(this.context,e).toTicks()}_getPartialProperties(e){const n=this.get();return Object.keys(n).forEach(i=>{ad(e[i])&&delete n[i]}),n}get(){const e=a0t(this);return Object.keys(e).forEach(n=>{if(Reflect.has(this,n)){const i=this[n];vr(i)&&vr(i.value)&&vr(i.setValueAtTime)?e[n]=i.value:i instanceof _u?e[n]=i._getPartialProperties(e[n]):nf(i)||ym(i)||M_(i)||Tbe(i)?e[n]=i:delete e[n]}}),e}set(e){return Object.keys(e).forEach(n=>{Reflect.has(this,n)&&vr(this[n])&&(this[n]&&vr(this[n].value)&&vr(this[n].setValueAtTime)?this[n].value!==e[n]&&(this[n].value=e[n]):this[n]instanceof _u?this[n].set(e[n]):this[n]=e[n])}),this}}class Ck extends fp{constructor(e="stopped"){super(),this.name="StateTimeline",this._initial=e,this.setStateAtTime(this._initial,0)}getValueAtTime(e){const n=this.get(e);return n!==null?n.state:this._initial}setStateAtTime(e,n,i){return ap(n,0),this.add(Object.assign({},i,{state:e,time:n})),this}getLastState(e,n){const i=this._search(n);for(let r=i;r>=0;r--){const s=this._timeline[r];if(s.state===e)return s}}getNextState(e,n){const i=this._search(n);if(i!==-1)for(let r=i;r<this._timeline.length;r++){const s=this._timeline[r];if(s.state===e)return s}}}class mr extends _u{constructor(){const e=Pn(mr.getDefaults(),arguments,["param","units","convert"]);for(super(e),this.name="Param",this.overridden=!1,this._minOutput=1e-7,Ai(vr(e.param)&&(o1(e.param)||e.param instanceof mr),"param must be an AudioParam");!o1(e.param);)e.param=e.param._param;this._swappable=vr(e.swappable)?e.swappable:!1,this._swappable?(this.input=this.context.createGain(),this._param=e.param,this.input.connect(this._param)):this._param=this.input=e.param,this._events=new fp(1e3),this._initialValue=this._param.defaultValue,this.units=e.units,this.convert=e.convert,this._minValue=e.minValue,this._maxValue=e.maxValue,vr(e.value)&&e.value!==this._toType(this._initialValue)&&this.setValueAtTime(e.value,0)}static getDefaults(){return Object.assign(_u.getDefaults(),{convert:!0,units:"number"})}get value(){const e=this.now();return this.getValueAtTime(e)}set value(e){this.cancelScheduledValues(this.now()),this.setValueAtTime(e,this.now())}get minValue(){return vr(this._minValue)?this._minValue:this.units==="time"||this.units==="frequency"||this.units==="normalRange"||this.units==="positive"||this.units==="transportTime"||this.units==="ticks"||this.units==="bpm"||this.units==="hertz"||this.units==="samples"?0:this.units==="audioRange"?-1:this.units==="decibels"?-1/0:this._param.minValue}get maxValue(){return vr(this._maxValue)?this._maxValue:this.units==="normalRange"||this.units==="audioRange"?1:this._param.maxValue}_is(e,n){return this.units===n}_assertRange(e){return vr(this.maxValue)&&vr(this.minValue)&&ap(e,this._fromType(this.minValue),this._fromType(this.maxValue)),e}_fromType(e){return this.convert&&!this.overridden?this._is(e,"time")?this.toSeconds(e):this._is(e,"decibels")?f0t(e):this._is(e,"frequency")?this.toFrequency(e):e:this.overridden?0:e}_toType(e){return this.convert&&this.units==="decibels"?d0t(e):e}setValueAtTime(e,n){const i=this.toSeconds(n),r=this._fromType(e);return Ai(isFinite(r)&&isFinite(i),`Invalid argument(s) to setValueAtTime: ${JSON.stringify(e)}, ${JSON.stringify(n)}`),this._assertRange(r),this.log(this.units,"setValueAtTime",e,i),this._events.add({time:i,type:"setValueAtTime",value:r}),this._param.setValueAtTime(r,i),this}getValueAtTime(e){const n=Math.max(this.toSeconds(e),0),i=this._events.getAfter(n),r=this._events.get(n);let s=this._initialValue;if(r===null)s=this._initialValue;else if(r.type==="setTargetAtTime"&&(i===null||i.type==="setValueAtTime")){const a=this._events.getBefore(r.time);let o;a===null?o=this._initialValue:o=a.value,r.type==="setTargetAtTime"&&(s=this._exponentialApproach(r.time,o,r.value,r.constant,n))}else if(i===null)s=r.value;else if(i.type==="linearRampToValueAtTime"||i.type==="exponentialRampToValueAtTime"){let a=r.value;if(r.type==="setTargetAtTime"){const o=this._events.getBefore(r.time);o===null?a=this._initialValue:a=o.value}i.type==="linearRampToValueAtTime"?s=this._linearInterpolate(r.time,a,i.time,i.value,n):s=this._exponentialInterpolate(r.time,a,i.time,i.value,n)}else s=r.value;return this._toType(s)}setRampPoint(e){e=this.toSeconds(e);let n=this.getValueAtTime(e);return this.cancelAndHoldAtTime(e),this._fromType(n)===0&&(n=this._toType(this._minOutput)),this.setValueAtTime(n,e),this}linearRampToValueAtTime(e,n){const i=this._fromType(e),r=this.toSeconds(n);return Ai(isFinite(i)&&isFinite(r),`Invalid argument(s) to linearRampToValueAtTime: ${JSON.stringify(e)}, ${JSON.stringify(n)}`),this._assertRange(i),this._events.add({time:r,type:"linearRampToValueAtTime",value:i}),this.log(this.units,"linearRampToValueAtTime",e,r),this._param.linearRampToValueAtTime(i,r),this}exponentialRampToValueAtTime(e,n){let i=this._fromType(e);i=am(i,0)?this._minOutput:i,this._assertRange(i);const r=this.toSeconds(n);return Ai(isFinite(i)&&isFinite(r),`Invalid argument(s) to exponentialRampToValueAtTime: ${JSON.stringify(e)}, ${JSON.stringify(n)}`),this._events.add({time:r,type:"exponentialRampToValueAtTime",value:i}),this.log(this.units,"exponentialRampToValueAtTime",e,r),this._param.exponentialRampToValueAtTime(i,r),this}exponentialRampTo(e,n,i){return i=this.toSeconds(i),this.setRampPoint(i),this.exponentialRampToValueAtTime(e,i+this.toSeconds(n)),this}linearRampTo(e,n,i){return i=this.toSeconds(i),this.setRampPoint(i),this.linearRampToValueAtTime(e,i+this.toSeconds(n)),this}targetRampTo(e,n,i){return i=this.toSeconds(i),this.setRampPoint(i),this.exponentialApproachValueAtTime(e,i,n),this}exponentialApproachValueAtTime(e,n,i){n=this.toSeconds(n),i=this.toSeconds(i);const r=Math.log(i+1)/Math.log(200);return this.setTargetAtTime(e,n,r),this.cancelAndHoldAtTime(n+i*.9),this.linearRampToValueAtTime(e,n+i),this}setTargetAtTime(e,n,i){const r=this._fromType(e);Ai(isFinite(i)&&i>0,"timeConstant must be a number greater than 0");const s=this.toSeconds(n);return this._assertRange(r),Ai(isFinite(r)&&isFinite(s),`Invalid argument(s) to setTargetAtTime: ${JSON.stringify(e)}, ${JSON.stringify(n)}`),this._events.add({constant:i,time:s,type:"setTargetAtTime",value:r}),this.log(this.units,"setTargetAtTime",e,s,i),this._param.setTargetAtTime(r,s,i),this}setValueCurveAtTime(e,n,i,r=1){i=this.toSeconds(i),n=this.toSeconds(n);const s=this._fromType(e[0])*r;this.setValueAtTime(this._toType(s),n);const a=i/(e.length-1);for(let o=1;o<e.length;o++){const c=this._fromType(e[o])*r;this.linearRampToValueAtTime(this._toType(c),n+o*a)}return this}cancelScheduledValues(e){const n=this.toSeconds(e);return Ai(isFinite(n),`Invalid argument to cancelScheduledValues: ${JSON.stringify(e)}`),this._events.cancel(n),this._param.cancelScheduledValues(n),this.log(this.units,"cancelScheduledValues",n),this}cancelAndHoldAtTime(e){const n=this.toSeconds(e),i=this._fromType(this.getValueAtTime(n));Ai(isFinite(n),`Invalid argument to cancelAndHoldAtTime: ${JSON.stringify(e)}`),this.log(this.units,"cancelAndHoldAtTime",n,"value="+i);const r=this._events.get(n),s=this._events.getAfter(n);return r&&am(r.time,n)?s?(this._param.cancelScheduledValues(s.time),this._events.cancel(s.time)):(this._param.cancelAndHoldAtTime(n),this._events.cancel(n+this.sampleTime)):s&&(this._param.cancelScheduledValues(s.time),this._events.cancel(s.time),s.type==="linearRampToValueAtTime"?this.linearRampToValueAtTime(this._toType(i),n):s.type==="exponentialRampToValueAtTime"&&this.exponentialRampToValueAtTime(this._toType(i),n)),this._events.add({time:n,type:"setValueAtTime",value:i}),this._param.setValueAtTime(i,n),this}rampTo(e,n=.1,i){return this.units==="frequency"||this.units==="bpm"||this.units==="decibels"?this.exponentialRampTo(e,n,i):this.linearRampTo(e,n,i),this}apply(e){const n=this.context.currentTime;e.setValueAtTime(this.getValueAtTime(n),n);const i=this._events.get(n);if(i&&i.type==="setTargetAtTime"){const r=this._events.getAfter(i.time),s=r?r.time:n+2,a=(s-n)/10;for(let o=n;o<s;o+=a)e.linearRampToValueAtTime(this.getValueAtTime(o),o)}return this._events.forEachAfter(this.context.currentTime,r=>{r.type==="cancelScheduledValues"?e.cancelScheduledValues(r.time):r.type==="setTargetAtTime"?e.setTargetAtTime(r.value,r.time,r.constant):e[r.type](r.value,r.time)}),this}setParam(e){Ai(this._swappable,"The Param must be assigned as 'swappable' in the constructor");const n=this.input;return n.disconnect(this._param),this.apply(e),this._param=e,n.connect(this._param),this}dispose(){return super.dispose(),this._events.dispose(),this}get defaultValue(){return this._toType(this._param.defaultValue)}_exponentialApproach(e,n,i,r,s){return i+(n-i)*Math.exp(-(s-e)/r)}_linearInterpolate(e,n,i,r,s){return n+(r-n)*((s-e)/(i-e))}_exponentialInterpolate(e,n,i,r,s){return n*Math.pow(r/n,(s-e)/(i-e))}}class Gn extends _u{constructor(){super(...arguments),this._internalChannels=[]}get numberOfInputs(){return vr(this.input)?o1(this.input)||this.input instanceof mr?1:this.input.numberOfInputs:0}get numberOfOutputs(){return vr(this.output)?this.output.numberOfOutputs:0}_isAudioNode(e){return vr(e)&&(e instanceof Gn||Hb(e))}_getInternalNodes(){const e=this._internalChannels.slice(0);return this._isAudioNode(this.input)&&e.push(this.input),this._isAudioNode(this.output)&&this.input!==this.output&&e.push(this.output),e}_setChannelProperties(e){this._getInternalNodes().forEach(i=>{i.channelCount=e.channelCount,i.channelCountMode=e.channelCountMode,i.channelInterpretation=e.channelInterpretation})}_getChannelProperties(){const e=this._getInternalNodes();Ai(e.length>0,"ToneAudioNode does not have any internal nodes");const n=e[0];return{channelCount:n.channelCount,channelCountMode:n.channelCountMode,channelInterpretation:n.channelInterpretation}}get channelCount(){return this._getChannelProperties().channelCount}set channelCount(e){const n=this._getChannelProperties();this._setChannelProperties(Object.assign(n,{channelCount:e}))}get channelCountMode(){return this._getChannelProperties().channelCountMode}set channelCountMode(e){const n=this._getChannelProperties();this._setChannelProperties(Object.assign(n,{channelCountMode:e}))}get channelInterpretation(){return this._getChannelProperties().channelInterpretation}set channelInterpretation(e){const n=this._getChannelProperties();this._setChannelProperties(Object.assign(n,{channelInterpretation:e}))}connect(e,n=0,i=0){return Ep(this,e,n,i),this}toDestination(){return this.connect(this.context.destination),this}toMaster(){return Yz("toMaster() has been renamed toDestination()"),this.toDestination()}disconnect(e,n=0,i=0){return Lbe(this,e,n,i),this}chain(...e){return c1(this,...e),this}fan(...e){return e.forEach(n=>this.connect(n)),this}dispose(){return super.dispose(),vr(this.input)&&(this.input instanceof Gn?this.input.dispose():Hb(this.input)&&this.input.disconnect()),vr(this.output)&&(this.output instanceof Gn?this.output.dispose():Hb(this.output)&&this.output.disconnect()),this._internalChannels=[],this}}function c1(...t){const e=t.shift();t.reduce((n,i)=>(n instanceof Gn?n.connect(i):Hb(n)&&Ep(n,i),i),e)}function Ep(t,e,n=0,i=0){for(Ai(vr(t),"Cannot connect from undefined node"),Ai(vr(e),"Cannot connect to undefined node"),(e instanceof Gn||Hb(e))&&Ai(e.numberOfInputs>0,"Cannot connect to node with no inputs"),Ai(t.numberOfOutputs>0,"Cannot connect from node with no outputs");e instanceof Gn||e instanceof mr;)vr(e.input)&&(e=e.input);for(;t instanceof Gn;)vr(t.output)&&(t=t.output);o1(e)?t.connect(e,n):t.connect(e,n,i)}function Lbe(t,e,n=0,i=0){if(vr(e))for(;e instanceof Gn;)e=e.input;for(;!Hb(t);)vr(t.output)&&(t=t.output);o1(e)?t.disconnect(e,n):Hb(e)?t.disconnect(e,n,i):t.disconnect()}class yr extends Gn{constructor(){const e=Pn(yr.getDefaults(),arguments,["gain","units"]);super(e),this.name="Gain",this._gainNode=this.context.createGain(),this.input=this._gainNode,this.output=this._gainNode,this.gain=new mr({context:this.context,convert:e.convert,param:this._gainNode.gain,units:e.units,value:e.gain,minValue:e.minValue,maxValue:e.maxValue}),Ar(this,"gain")}static getDefaults(){return Object.assign(Gn.getDefaults(),{convert:!0,gain:1,units:"gain"})}dispose(){return super.dispose(),this._gainNode.disconnect(),this.gain.dispose(),this}}class uA extends Gn{constructor(e){super(e),this.onended=Ts,this._startTime=-1,this._stopTime=-1,this._timeout=-1,this.output=new yr({context:this.context,gain:0}),this._gainNode=this.output,this.getStateAtTime=function(n){const i=this.toSeconds(n);return this._startTime!==-1&&i>=this._startTime&&(this._stopTime===-1||i<=this._stopTime)?"started":"stopped"},this._fadeIn=e.fadeIn,this._fadeOut=e.fadeOut,this._curve=e.curve,this.onended=e.onended}static getDefaults(){return Object.assign(Gn.getDefaults(),{curve:"linear",fadeIn:0,fadeOut:0,onended:Ts})}_startGain(e,n=1){Ai(this._startTime===-1,"Source cannot be started more than once");const i=this.toSeconds(this._fadeIn);return this._startTime=e+i,this._startTime=Math.max(this._startTime,this.context.currentTime),i>0?(this._gainNode.gain.setValueAtTime(0,e),this._curve==="linear"?this._gainNode.gain.linearRampToValueAtTime(n,e+i):this._gainNode.gain.exponentialApproachValueAtTime(n,e,i)):this._gainNode.gain.setValueAtTime(n,e),this}stop(e){return this.log("stop",e),this._stopGain(this.toSeconds(e)),this}_stopGain(e){Ai(this._startTime!==-1,"'start' must be called before 'stop'"),this.cancelStop();const n=this.toSeconds(this._fadeOut);return this._stopTime=this.toSeconds(e)+n,this._stopTime=Math.max(this._stopTime,this.now()),n>0?this._curve==="linear"?this._gainNode.gain.linearRampTo(0,n,e):this._gainNode.gain.targetRampTo(0,n,e):(this._gainNode.gain.cancelAndHoldAtTime(e),this._gainNode.gain.setValueAtTime(0,e)),this.context.clearTimeout(this._timeout),this._timeout=this.context.setTimeout(()=>{const i=this._curve==="exponential"?n*2:0;this._stopSource(this.now()+i),this._onended()},this._stopTime-this.context.currentTime),this}_onended(){if(this.onended!==Ts&&(this.onended(this),this.onended=Ts,!this.context.isOffline)){const e=()=>this.dispose();typeof requestIdleCallback<"u"?requestIdleCallback(e):setTimeout(e,10)}}get state(){return this.getStateAtTime(this.now())}cancelStop(){return this.log("cancelStop"),Ai(this._startTime!==-1,"Source is not started"),this._gainNode.gain.cancelScheduledValues(this._startTime+this.sampleTime),this.context.clearTimeout(this._timeout),this._stopTime=-1,this}dispose(){return super.dispose(),this._gainNode.dispose(),this.onended=Ts,this}}class YX extends uA{constructor(){const e=Pn(YX.getDefaults(),arguments,["offset"]);super(e),this.name="ToneConstantSource",this._source=this.context.createConstantSource(),Ep(this._source,this._gainNode),this.offset=new mr({context:this.context,convert:e.convert,param:this._source.offset,units:e.units,value:e.offset,minValue:e.minValue,maxValue:e.maxValue})}static getDefaults(){return Object.assign(uA.getDefaults(),{convert:!0,offset:1,units:"number"})}start(e){const n=this.toSeconds(e);return this.log("start",n),this._startGain(n),this._source.start(n),this}_stopSource(e){this._source.stop(e)}dispose(){return super.dispose(),this.state==="started"&&this.stop(),this._source.disconnect(),this.offset.dispose(),this}}class cs extends Gn{constructor(){const e=Pn(cs.getDefaults(),arguments,["value","units"]);super(e),this.name="Signal",this.override=!0,this.output=this._constantSource=new YX({context:this.context,convert:e.convert,offset:e.value,units:e.units,minValue:e.minValue,maxValue:e.maxValue}),this._constantSource.start(0),this.input=this._param=this._constantSource.offset}static getDefaults(){return Object.assign(Gn.getDefaults(),{convert:!0,units:"number",value:0})}connect(e,n=0,i=0){return e8(this,e,n,i),this}dispose(){return super.dispose(),this._param.dispose(),this._constantSource.dispose(),this}setValueAtTime(e,n){return this._param.setValueAtTime(e,n),this}getValueAtTime(e){return this._param.getValueAtTime(e)}setRampPoint(e){return this._param.setRampPoint(e),this}linearRampToValueAtTime(e,n){return this._param.linearRampToValueAtTime(e,n),this}exponentialRampToValueAtTime(e,n){return this._param.exponentialRampToValueAtTime(e,n),this}exponentialRampTo(e,n,i){return this._param.exponentialRampTo(e,n,i),this}linearRampTo(e,n,i){return this._param.linearRampTo(e,n,i),this}targetRampTo(e,n,i){return this._param.targetRampTo(e,n,i),this}exponentialApproachValueAtTime(e,n,i){return this._param.exponentialApproachValueAtTime(e,n,i),this}setTargetAtTime(e,n,i){return this._param.setTargetAtTime(e,n,i),this}setValueCurveAtTime(e,n,i,r){return this._param.setValueCurveAtTime(e,n,i,r),this}cancelScheduledValues(e){return this._param.cancelScheduledValues(e),this}cancelAndHoldAtTime(e){return this._param.cancelAndHoldAtTime(e),this}rampTo(e,n,i){return this._param.rampTo(e,n,i),this}get value(){return this._param.value}set value(e){this._param.value=e}get convert(){return this._param.convert}set convert(e){this._param.convert=e}get units(){return this._param.units}get overridden(){return this._param.overridden}set overridden(e){this._param.overridden=e}get maxValue(){return this._param.maxValue}get minValue(){return this._param.minValue}apply(e){return this._param.apply(e),this}}function e8(t,e,n,i){(e instanceof mr||o1(e)||e instanceof cs&&e.override)&&(e.cancelScheduledValues(0),e.setValueAtTime(0,0),e instanceof cs&&(e.overridden=!0)),Ep(t,e,n,i)}class XX extends mr{constructor(){const e=Pn(XX.getDefaults(),arguments,["value"]);super(e),this.name="TickParam",this._events=new fp(1/0),this._multiplier=1,this._multiplier=e.multiplier,this._events.cancel(0),this._events.add({ticks:0,time:0,type:"setValueAtTime",value:this._fromType(e.value)}),this.setValueAtTime(e.value,0)}static getDefaults(){return Object.assign(mr.getDefaults(),{multiplier:1,units:"hertz",value:1})}setTargetAtTime(e,n,i){n=this.toSeconds(n),this.setRampPoint(n);const r=this._fromType(e),s=this._events.get(n),a=Math.round(Math.max(1/i,1));for(let o=0;o<=a;o++){const c=i*o+n,l=this._exponentialApproach(s.time,s.value,r,i,c);this.linearRampToValueAtTime(this._toType(l),c)}return this}setValueAtTime(e,n){const i=this.toSeconds(n);super.setValueAtTime(e,n);const r=this._events.get(i),s=this._events.previousEvent(r),a=this._getTicksUntilEvent(s,i);return r.ticks=Math.max(a,0),this}linearRampToValueAtTime(e,n){const i=this.toSeconds(n);super.linearRampToValueAtTime(e,n);const r=this._events.get(i),s=this._events.previousEvent(r),a=this._getTicksUntilEvent(s,i);return r.ticks=Math.max(a,0),this}exponentialRampToValueAtTime(e,n){n=this.toSeconds(n);const i=this._fromType(e),r=this._events.get(n),s=Math.round(Math.max((n-r.time)*10,1)),a=(n-r.time)/s;for(let o=0;o<=s;o++){const c=a*o+r.time,l=this._exponentialInterpolate(r.time,r.value,n,i,c);this.linearRampToValueAtTime(this._toType(l),c)}return this}_getTicksUntilEvent(e,n){if(e===null)e={ticks:0,time:0,type:"setValueAtTime",value:0};else if(ad(e.ticks)){const a=this._events.previousEvent(e);e.ticks=this._getTicksUntilEvent(a,e.time)}const i=this._fromType(this.getValueAtTime(e.time));let r=this._fromType(this.getValueAtTime(n));const s=this._events.get(n);return s&&s.time===n&&s.type==="setValueAtTime"&&(r=this._fromType(this.getValueAtTime(n-this.sampleTime))),.5*(n-e.time)*(i+r)+e.ticks}getTicksAtTime(e){const n=this.toSeconds(e),i=this._events.get(n);return Math.max(this._getTicksUntilEvent(i,n),0)}getDurationOfTicks(e,n){const i=this.toSeconds(n),r=this.getTicksAtTime(n);return this.getTimeOfTick(r+e)-i}getTimeOfTick(e){const n=this._events.get(e,"ticks"),i=this._events.getAfter(e,"ticks");if(n&&n.ticks===e)return n.time;if(n&&i&&i.type==="linearRampToValueAtTime"&&n.value!==i.value){const r=this._fromType(this.getValueAtTime(n.time)),a=(this._fromType(this.getValueAtTime(i.time))-r)/(i.time-n.time),o=Math.sqrt(Math.pow(r,2)-2*a*(n.ticks-e)),c=(-r+o)/a,l=(-r-o)/a;return(c>0?c:l)+n.time}else return n?n.value===0?1/0:n.time+(e-n.ticks)/n.value:e/this._initialValue}ticksToTime(e,n){return this.getDurationOfTicks(e,n)}timeToTicks(e,n){const i=this.toSeconds(n),r=this.toSeconds(e),s=this.getTicksAtTime(i);return this.getTicksAtTime(i+r)-s}_fromType(e){return this.units==="bpm"&&this.multiplier?1/(60/e/this.multiplier):super._fromType(e)}_toType(e){return this.units==="bpm"&&this.multiplier?e/this.multiplier*60:super._toType(e)}get multiplier(){return this._multiplier}set multiplier(e){const n=this.value;this._multiplier=e,this.cancelScheduledValues(0),this.setValueAtTime(n,0)}}class KX extends cs{constructor(){const e=Pn(KX.getDefaults(),arguments,["value"]);super(e),this.name="TickSignal",this.input=this._param=new XX({context:this.context,convert:e.convert,multiplier:e.multiplier,param:this._constantSource.offset,units:e.units,value:e.value})}static getDefaults(){return Object.assign(cs.getDefaults(),{multiplier:1,units:"hertz",value:1})}ticksToTime(e,n){return this._param.ticksToTime(e,n)}timeToTicks(e,n){return this._param.timeToTicks(e,n)}getTimeOfTick(e){return this._param.getTimeOfTick(e)}getDurationOfTicks(e,n){return this._param.getDurationOfTicks(e,n)}getTicksAtTime(e){return this._param.getTicksAtTime(e)}get multiplier(){return this._param.multiplier}set multiplier(e){this._param.multiplier=e}dispose(){return super.dispose(),this._param.dispose(),this}}class ZX extends _u{constructor(){const e=Pn(ZX.getDefaults(),arguments,["frequency"]);super(e),this.name="TickSource",this._state=new Ck,this._tickOffset=new fp,this._ticksAtTime=new fp,this._secondsAtTime=new fp,this.frequency=new KX({context:this.context,units:e.units,value:e.frequency}),Ar(this,"frequency"),this._state.setStateAtTime("stopped",0),this.setTicksAtTime(0,0)}static getDefaults(){return Object.assign({frequency:1,units:"hertz"},_u.getDefaults())}get state(){return this.getStateAtTime(this.now())}start(e,n){const i=this.toSeconds(e);return this._state.getValueAtTime(i)!=="started"&&(this._state.setStateAtTime("started",i),vr(n)&&this.setTicksAtTime(n,i),this._ticksAtTime.cancel(i),this._secondsAtTime.cancel(i)),this}stop(e){const n=this.toSeconds(e);if(this._state.getValueAtTime(n)==="stopped"){const i=this._state.get(n);i&&i.time>0&&(this._tickOffset.cancel(i.time),this._state.cancel(i.time))}return this._state.cancel(n),this._state.setStateAtTime("stopped",n),this.setTicksAtTime(0,n),this._ticksAtTime.cancel(n),this._secondsAtTime.cancel(n),this}pause(e){const n=this.toSeconds(e);return this._state.getValueAtTime(n)==="started"&&(this._state.setStateAtTime("paused",n),this._ticksAtTime.cancel(n),this._secondsAtTime.cancel(n)),this}cancel(e){return e=this.toSeconds(e),this._state.cancel(e),this._tickOffset.cancel(e),this._ticksAtTime.cancel(e),this._secondsAtTime.cancel(e),this}getTicksAtTime(e){const n=this.toSeconds(e),i=this._state.getLastState("stopped",n),r=this._ticksAtTime.get(n),s={state:"paused",time:n};this._state.add(s);let a=r||i,o=r?r.ticks:0,c=null;return this._state.forEachBetween(a.time,n+this.sampleTime,l=>{let u=a.time;const h=this._tickOffset.get(l.time);h&&h.time>=a.time&&(o=h.ticks,u=h.time),a.state==="started"&&l.state!=="started"&&(o+=this.frequency.getTicksAtTime(l.time)-this.frequency.getTicksAtTime(u),l.time!==s.time&&(c={state:l.state,time:l.time,ticks:o})),a=l}),this._state.remove(s),c&&this._ticksAtTime.add(c),o}get ticks(){return this.getTicksAtTime(this.now())}set ticks(e){this.setTicksAtTime(e,this.now())}get seconds(){return this.getSecondsAtTime(this.now())}set seconds(e){const n=this.now(),i=this.frequency.timeToTicks(e,n);this.setTicksAtTime(i,n)}getSecondsAtTime(e){e=this.toSeconds(e);const n=this._state.getLastState("stopped",e),i={state:"paused",time:e};this._state.add(i);const r=this._secondsAtTime.get(e);let s=r||n,a=r?r.seconds:0,o=null;return this._state.forEachBetween(s.time,e+this.sampleTime,c=>{let l=s.time;const u=this._tickOffset.get(c.time);u&&u.time>=s.time&&(a=u.seconds,l=u.time),s.state==="started"&&c.state!=="started"&&(a+=c.time-l,c.time!==i.time&&(o={state:c.state,time:c.time,seconds:a})),s=c}),this._state.remove(i),o&&this._secondsAtTime.add(o),a}setTicksAtTime(e,n){return n=this.toSeconds(n),this._tickOffset.cancel(n),this._tickOffset.add({seconds:this.frequency.getDurationOfTicks(e,n),ticks:e,time:n}),this._ticksAtTime.cancel(n),this._secondsAtTime.cancel(n),this}getStateAtTime(e){return e=this.toSeconds(e),this._state.getValueAtTime(e)}getTimeOfTick(e,n=this.now()){const i=this._tickOffset.get(n),r=this._state.get(n),s=Math.max(i.time,r.time),a=this.frequency.getTicksAtTime(s)+e-i.ticks;return this.frequency.getTimeOfTick(a)}forEachTickBetween(e,n,i){let r=this._state.get(e);this._state.forEachBetween(e,n,a=>{r&&r.state==="started"&&a.state!=="started"&&this.forEachTickBetween(Math.max(r.time,e),a.time-this.sampleTime,i),r=a});let s=null;if(r&&r.state==="started"){const a=Math.max(r.time,e),o=this.frequency.getTicksAtTime(a),c=this.frequency.getTicksAtTime(r.time),l=o-c;let u=Math.ceil(l)-l;u=am(u,1)?0:u;let h=this.frequency.getTimeOfTick(o+u);for(;h<n;){try{i(h,Math.round(this.getTicksAtTime(h)))}catch(f){s=f;break}h+=this.frequency.getDurationOfTicks(1,h)}}if(s)throw s;return this}dispose(){return super.dispose(),this._state.dispose(),this._tickOffset.dispose(),this._ticksAtTime.dispose(),this._secondsAtTime.dispose(),this.frequency.dispose(),this}}class t8 extends _u{constructor(){const e=Pn(t8.getDefaults(),arguments,["callback","frequency"]);super(e),this.name="Clock",this.callback=Ts,this._lastUpdate=0,this._state=new Ck("stopped"),this._boundLoop=this._loop.bind(this),this.callback=e.callback,this._tickSource=new ZX({context:this.context,frequency:e.frequency,units:e.units}),this._lastUpdate=0,this.frequency=this._tickSource.frequency,Ar(this,"frequency"),this._state.setStateAtTime("stopped",0),this.context.on("tick",this._boundLoop)}static getDefaults(){return Object.assign(_u.getDefaults(),{callback:Ts,frequency:1,units:"hertz"})}get state(){return this._state.getValueAtTime(this.now())}start(e,n){xbe(this.context);const i=this.toSeconds(e);return this.log("start",i),this._state.getValueAtTime(i)!=="started"&&(this._state.setStateAtTime("started",i),this._tickSource.start(i,n),i<this._lastUpdate&&this.emit("start",i,n)),this}stop(e){const n=this.toSeconds(e);return this.log("stop",n),this._state.cancel(n),this._state.setStateAtTime("stopped",n),this._tickSource.stop(n),n<this._lastUpdate&&this.emit("stop",n),this}pause(e){const n=this.toSeconds(e);return this._state.getValueAtTime(n)==="started"&&(this._state.setStateAtTime("paused",n),this._tickSource.pause(n),n<this._lastUpdate&&this.emit("pause",n)),this}get ticks(){return Math.ceil(this.getTicksAtTime(this.now()))}set ticks(e){this._tickSource.ticks=e}get seconds(){return this._tickSource.seconds}set seconds(e){this._tickSource.seconds=e}getSecondsAtTime(e){return this._tickSource.getSecondsAtTime(e)}setTicksAtTime(e,n){return this._tickSource.setTicksAtTime(e,n),this}getTimeOfTick(e,n=this.now()){return this._tickSource.getTimeOfTick(e,n)}getTicksAtTime(e){return this._tickSource.getTicksAtTime(e)}nextTickTime(e,n){const i=this.toSeconds(n),r=this.getTicksAtTime(i);return this._tickSource.getTimeOfTick(r+e,i)}_loop(){const e=this._lastUpdate,n=this.now();this._lastUpdate=n,this.log("loop",e,n),e!==n&&(this._state.forEachBetween(e,n,i=>{switch(i.state){case"started":const r=this._tickSource.getTicksAtTime(i.time);this.emit("start",i.time,r);break;case"stopped":i.time!==0&&this.emit("stop",i.time);break;case"paused":this.emit("pause",i.time);break}}),this._tickSource.forEachTickBetween(e,n,(i,r)=>{this.callback(i,r)}))}getStateAtTime(e){const n=this.toSeconds(e);return this._state.getValueAtTime(n)}dispose(){return super.dispose(),this.context.off("tick",this._boundLoop),this._tickSource.dispose(),this._state.dispose(),this}}xk.mixin(t8);class hA extends Gn{constructor(){const e=Pn(hA.getDefaults(),arguments,["delayTime","maxDelay"]);super(e),this.name="Delay";const n=this.toSeconds(e.maxDelay);this._maxDelay=Math.max(n,this.toSeconds(e.delayTime)),this._delayNode=this.input=this.output=this.context.createDelay(n),this.delayTime=new mr({context:this.context,param:this._delayNode.delayTime,units:"time",value:e.delayTime,minValue:0,maxValue:this.maxDelay}),Ar(this,"delayTime")}static getDefaults(){return Object.assign(Gn.getDefaults(),{delayTime:0,maxDelay:1})}get maxDelay(){return this._maxDelay}dispose(){return super.dispose(),this._delayNode.disconnect(),this.delayTime.dispose(),this}}class Pg extends Gn{constructor(){const e=Pn(Pg.getDefaults(),arguments,["volume"]);super(e),this.name="Volume",this.input=this.output=new yr({context:this.context,gain:e.volume,units:"decibels"}),this.volume=this.output.gain,Ar(this,"volume"),this._unmutedVolume=e.volume,this.mute=e.mute}static getDefaults(){return Object.assign(Gn.getDefaults(),{mute:!1,volume:0})}get mute(){return this.volume.value===-1/0}set mute(e){!this.mute&&e?(this._unmutedVolume=this.volume.value,this.volume.value=-1/0):this.mute&&!e&&(this.volume.value=this._unmutedVolume)}dispose(){return super.dispose(),this.input.dispose(),this.volume.dispose(),this}}class JX extends Gn{constructor(){const e=Pn(JX.getDefaults(),arguments);super(e),this.name="Destination",this.input=new Pg({context:this.context}),this.output=new yr({context:this.context}),this.volume=this.input.volume,c1(this.input,this.output,this.context.rawContext.destination),this.mute=e.mute,this._internalChannels=[this.input,this.context.rawContext.destination,this.output]}static getDefaults(){return Object.assign(Gn.getDefaults(),{mute:!1,volume:0})}get mute(){return this.input.mute}set mute(e){this.input.mute=e}chain(...e){return this.input.disconnect(),e.unshift(this.input),e.push(this.output),c1(...e),this}get maxChannelCount(){return this.context.rawContext.destination.maxChannelCount}dispose(){return super.dispose(),this.volume.dispose(),this}}Kz(t=>{t.destination=new JX({context:t})});Zz(t=>{t.destination.dispose()});class _0t extends Gn{constructor(){super(...arguments),this.name="Listener",this.positionX=new mr({context:this.context,param:this.context.rawContext.listener.positionX}),this.positionY=new mr({context:this.context,param:this.context.rawContext.listener.positionY}),this.positionZ=new mr({context:this.context,param:this.context.rawContext.listener.positionZ}),this.forwardX=new mr({context:this.context,param:this.context.rawContext.listener.forwardX}),this.forwardY=new mr({context:this.context,param:this.context.rawContext.listener.forwardY}),this.forwardZ=new mr({context:this.context,param:this.context.rawContext.listener.forwardZ}),this.upX=new mr({context:this.context,param:this.context.rawContext.listener.upX}),this.upY=new mr({context:this.context,param:this.context.rawContext.listener.upY}),this.upZ=new mr({context:this.context,param:this.context.rawContext.listener.upZ})}static getDefaults(){return Object.assign(Gn.getDefaults(),{positionX:0,positionY:0,positionZ:0,forwardX:0,forwardY:0,forwardZ:-1,upX:0,upY:1,upZ:0})}dispose(){return super.dispose(),this.positionX.dispose(),this.positionY.dispose(),this.positionZ.dispose(),this.forwardX.dispose(),this.forwardY.dispose(),this.forwardZ.dispose(),this.upX.dispose(),this.upY.dispose(),this.upZ.dispose(),this}}Kz(t=>{t.listener=new _0t({context:t})});Zz(t=>{t.listener.dispose()});class QX extends H_{constructor(){super(),this.name="ToneAudioBuffers",this._buffers=new Map,this._loadingCount=0;const e=Pn(QX.getDefaults(),arguments,["urls","onload","baseUrl"],"urls");this.baseUrl=e.baseUrl,Object.keys(e.urls).forEach(n=>{this._loadingCount++;const i=e.urls[n];this.add(n,i,this._bufferLoaded.bind(this,e.onload),e.onerror)})}static getDefaults(){return{baseUrl:"",onerror:Ts,onload:Ts,urls:{}}}has(e){return this._buffers.has(e.toString())}get(e){return Ai(this.has(e),`ToneAudioBuffers has no buffer named: ${e}`),this._buffers.get(e.toString())}_bufferLoaded(e){this._loadingCount--,this._loadingCount===0&&e&&e()}get loaded(){return Array.from(this._buffers).every(([e,n])=>n.loaded)}add(e,n,i=Ts,r=Ts){return M_(n)?(this.baseUrl&&n.trim().substring(0,11).toLowerCase()==="data:audio/"&&(this.baseUrl=""),this._buffers.set(e.toString(),new Us(this.baseUrl+n,i,r))):this._buffers.set(e.toString(),new Us(n,i,r)),this}dispose(){return super.dispose(),this._buffers.forEach(e=>e.dispose()),this._buffers.clear(),this}}class j3 extends Jh{constructor(){super(...arguments),this.name="MidiClass",this.defaultUnits="midi"}_frequencyToUnits(e){return dT(super._frequencyToUnits(e))}_ticksToUnits(e){return dT(super._ticksToUnits(e))}_beatsToUnits(e){return dT(super._beatsToUnits(e))}_secondsToUnits(e){return dT(super._secondsToUnits(e))}toMidi(){return this.valueOf()}toFrequency(){return Pbe(this.toMidi())}transpose(e){return new j3(this.context,this.toMidi()+e)}}class Dc extends cC{constructor(){super(...arguments),this.name="Ticks",this.defaultUnits="i"}_now(){return this.context.transport.ticks}_beatsToUnits(e){return this._getPPQ()*e}_secondsToUnits(e){return Math.floor(e/(60/this._getBpm())*this._getPPQ())}_ticksToUnits(e){return e}toTicks(){return this.valueOf()}toSeconds(){return this.valueOf()/this._getPPQ()*(60/this._getBpm())}}class y0t extends _u{constructor(){super(...arguments),this.name="Draw",this.expiration=.25,this.anticipation=.008,this._events=new fp,this._boundDrawLoop=this._drawLoop.bind(this),this._animationFrame=-1}schedule(e,n){return this._events.add({callback:e,time:this.toSeconds(n)}),this._events.length===1&&(this._animationFrame=requestAnimationFrame(this._boundDrawLoop)),this}cancel(e){return this._events.cancel(this.toSeconds(e)),this}_drawLoop(){const e=this.context.currentTime;this._events.forEachBefore(e+this.anticipation,n=>{e-n.time<=this.expiration&&n.callback(),this._events.remove(n)}),this._events.length>0&&(this._animationFrame=requestAnimationFrame(this._boundDrawLoop))}dispose(){return super.dispose(),this._events.dispose(),cancelAnimationFrame(this._animationFrame),this}}Kz(t=>{t.draw=new y0t({context:t})});Zz(t=>{t.draw.dispose()});class b0t extends H_{constructor(){super(...arguments),this.name="IntervalTimeline",this._root=null,this._length=0}add(e){Ai(vr(e.time),"Events must have a time property"),Ai(vr(e.duration),"Events must have a duration parameter"),e.time=e.time.valueOf();let n=new E0t(e.time,e.time+e.duration,e);for(this._root===null?this._root=n:this._root.insert(n),this._length++;n!==null;)n.updateHeight(),n.updateMax(),this._rebalance(n),n=n.parent;return this}remove(e){if(this._root!==null){const n=[];this._root.search(e.time,n);for(const i of n)if(i.event===e){this._removeNode(i),this._length--;break}}return this}get length(){return this._length}cancel(e){return this.forEachFrom(e,n=>this.remove(n)),this}_setRoot(e){this._root=e,this._root!==null&&(this._root.parent=null)}_replaceNodeInParent(e,n){e.parent!==null?(e.isLeftChild()?e.parent.left=n:e.parent.right=n,this._rebalance(e.parent)):this._setRoot(n)}_removeNode(e){if(e.left===null&&e.right===null)this._replaceNodeInParent(e,null);else if(e.right===null)this._replaceNodeInParent(e,e.left);else if(e.left===null)this._replaceNodeInParent(e,e.right);else{const n=e.getBalance();let i,r=null;if(n>0)if(e.left.right===null)i=e.left,i.right=e.right,r=i;else{for(i=e.left.right;i.right!==null;)i=i.right;i.parent&&(i.parent.right=i.left,r=i.parent,i.left=e.left,i.right=e.right)}else if(e.right.left===null)i=e.right,i.left=e.left,r=i;else{for(i=e.right.left;i.left!==null;)i=i.left;i.parent&&(i.parent.left=i.right,r=i.parent,i.left=e.left,i.right=e.right)}e.parent!==null?e.isLeftChild()?e.parent.left=i:e.parent.right=i:this._setRoot(i),r&&this._rebalance(r)}e.dispose()}_rotateLeft(e){const n=e.parent,i=e.isLeftChild(),r=e.right;r&&(e.right=r.left,r.left=e),n!==null?i?n.left=r:n.right=r:this._setRoot(r)}_rotateRight(e){const n=e.parent,i=e.isLeftChild(),r=e.left;r&&(e.left=r.right,r.right=e),n!==null?i?n.left=r:n.right=r:this._setRoot(r)}_rebalance(e){const n=e.getBalance();n>1&&e.left?e.left.getBalance()<0?this._rotateLeft(e.left):this._rotateRight(e):n<-1&&e.right&&(e.right.getBalance()>0?this._rotateRight(e.right):this._rotateLeft(e))}get(e){if(this._root!==null){const n=[];if(this._root.search(e,n),n.length>0){let i=n[0];for(let r=1;r<n.length;r++)n[r].low>i.low&&(i=n[r]);return i.event}}return null}forEach(e){if(this._root!==null){const n=[];this._root.traverse(i=>n.push(i)),n.forEach(i=>{i.event&&e(i.event)})}return this}forEachAtTime(e,n){if(this._root!==null){const i=[];this._root.search(e,i),i.forEach(r=>{r.event&&n(r.event)})}return this}forEachFrom(e,n){if(this._root!==null){const i=[];this._root.searchAfter(e,i),i.forEach(r=>{r.event&&n(r.event)})}return this}dispose(){return super.dispose(),this._root!==null&&this._root.traverse(e=>e.dispose()),this._root=null,this}}class E0t{constructor(e,n,i){this._left=null,this._right=null,this.parent=null,this.height=0,this.event=i,this.low=e,this.high=n,this.max=this.high}insert(e){e.low<=this.low?this.left===null?this.left=e:this.left.insert(e):this.right===null?this.right=e:this.right.insert(e)}search(e,n){e>this.max||(this.left!==null&&this.left.search(e,n),this.low<=e&&this.high>e&&n.push(this),!(this.low>e)&&this.right!==null&&this.right.search(e,n))}searchAfter(e,n){this.low>=e&&(n.push(this),this.left!==null&&this.left.searchAfter(e,n)),this.right!==null&&this.right.searchAfter(e,n)}traverse(e){e(this),this.left!==null&&this.left.traverse(e),this.right!==null&&this.right.traverse(e)}updateHeight(){this.left!==null&&this.right!==null?this.height=Math.max(this.left.height,this.right.height)+1:this.right!==null?this.height=this.right.height+1:this.left!==null?this.height=this.left.height+1:this.height=0}updateMax(){this.max=this.high,this.left!==null&&(this.max=Math.max(this.max,this.left.max)),this.right!==null&&(this.max=Math.max(this.max,this.right.max))}getBalance(){let e=0;return this.left!==null&&this.right!==null?e=this.left.height-this.right.height:this.left!==null?e=this.left.height+1:this.right!==null&&(e=-(this.right.height+1)),e}isLeftChild(){return this.parent!==null&&this.parent.left===this}get left(){return this._left}set left(e){this._left=e,e!==null&&(e.parent=this),this.updateHeight(),this.updateMax()}get right(){return this._right}set right(e){this._right=e,e!==null&&(e.parent=this),this.updateHeight(),this.updateMax()}dispose(){this.parent=null,this._left=null,this._right=null,this.event=null}}class S0t extends H_{constructor(e){super(),this.name="TimelineValue",this._timeline=new fp({memory:10}),this._initialValue=e}set(e,n){return this._timeline.add({value:e,time:n}),this}get(e){const n=this._timeline.get(e);return n?n.value:this._initialValue}}class c0 extends Gn{constructor(){super(Pn(c0.getDefaults(),arguments,["context"]))}connect(e,n=0,i=0){return e8(this,e,n,i),this}}class L1 extends c0{constructor(){const e=Pn(L1.getDefaults(),arguments,["mapping","length"]);super(e),this.name="WaveShaper",this._shaper=this.context.createWaveShaper(),this.input=this._shaper,this.output=this._shaper,nf(e.mapping)||e.mapping instanceof Float32Array?this.curve=Float32Array.from(e.mapping):Xgt(e.mapping)&&this.setMap(e.mapping,e.length)}static getDefaults(){return Object.assign(cs.getDefaults(),{length:1024})}setMap(e,n=1024){const i=new Float32Array(n);for(let r=0,s=n;r<s;r++){const a=r/(s-1)*2-1;i[r]=e(a,r)}return this.curve=i,this}get curve(){return this._shaper.curve}set curve(e){this._shaper.curve=e}get oversample(){return this._shaper.oversample}set oversample(e){const n=["none","2x","4x"].some(i=>i.includes(e));Ai(n,"oversampling must be either 'none', '2x', or '4x'"),this._shaper.oversample=e}dispose(){return super.dispose(),this._shaper.disconnect(),this}}class eK extends c0{constructor(){const e=Pn(eK.getDefaults(),arguments,["value"]);super(e),this.name="Pow",this._exponentScaler=this.input=this.output=new L1({context:this.context,mapping:this._expFunc(e.value),length:8192}),this._exponent=e.value}static getDefaults(){return Object.assign(c0.getDefaults(),{value:1})}_expFunc(e){return n=>Math.pow(Math.abs(n),e)}get value(){return this._exponent}set value(e){this._exponent=e,this._exponentScaler.setMap(this._expFunc(this._exponent))}dispose(){return super.dispose(),this._exponentScaler.dispose(),this}}class aE{constructor(e,n){this.id=aE._eventId++,this._remainderTime=0;const i=Object.assign(aE.getDefaults(),n);this.transport=e,this.callback=i.callback,this._once=i.once,this.time=Math.floor(i.time),this._remainderTime=i.time-this.time}static getDefaults(){return{callback:Ts,once:!1,time:0}}get floatTime(){return this.time+this._remainderTime}invoke(e){if(this.callback){const n=this.transport.bpm.getDurationOfTicks(1,e);this.callback(e+this._remainderTime*n),this._once&&this.transport.clear(this.id)}}dispose(){return this.callback=void 0,this}}aE._eventId=0;class tK extends aE{constructor(e,n){super(e,n),this._currentId=-1,this._nextId=-1,this._nextTick=this.time,this._boundRestart=this._restart.bind(this);const i=Object.assign(tK.getDefaults(),n);this.duration=i.duration,this._interval=i.interval,this._nextTick=i.time,this.transport.on("start",this._boundRestart),this.transport.on("loopStart",this._boundRestart),this.transport.on("ticks",this._boundRestart),this.context=this.transport.context,this._restart()}static getDefaults(){return Object.assign({},aE.getDefaults(),{duration:1/0,interval:1,once:!1})}invoke(e){this._createEvents(e),super.invoke(e)}_createEvent(){return H3(this._nextTick,this.floatTime+this.duration)?this.transport.scheduleOnce(this.invoke.bind(this),new Dc(this.context,this._nextTick).toSeconds()):-1}_createEvents(e){H3(this._nextTick+this._interval,this.floatTime+this.duration)&&(this._nextTick+=this._interval,this._currentId=this._nextId,this._nextId=this.transport.scheduleOnce(this.invoke.bind(this),new Dc(this.context,this._nextTick).toSeconds()))}_restart(e){this.transport.clear(this._currentId),this.transport.clear(this._nextId),this._nextTick=this.floatTime;const n=this.transport.getTicksAtTime(e);lA(n,this.time)&&(this._nextTick=this.floatTime+Math.ceil((n-this.floatTime)/this._interval)*this._interval),this._currentId=this._createEvent(),this._nextTick+=this._interval,this._nextId=this._createEvent()}dispose(){return super.dispose(),this.transport.clear(this._currentId),this.transport.clear(this._nextId),this.transport.off("start",this._boundRestart),this.transport.off("loopStart",this._boundRestart),this.transport.off("ticks",this._boundRestart),this}}class n8 extends _u{constructor(){const e=Pn(n8.getDefaults(),arguments);super(e),this.name="Transport",this._loop=new S0t(!1),this._loopStart=0,this._loopEnd=0,this._scheduledEvents={},this._timeline=new fp,this._repeatedEvents=new b0t,this._syncedSignals=[],this._swingAmount=0,this._ppq=e.ppq,this._clock=new t8({callback:this._processTick.bind(this),context:this.context,frequency:0,units:"bpm"}),this._bindClockEvents(),this.bpm=this._clock.frequency,this._clock.frequency.multiplier=e.ppq,this.bpm.setValueAtTime(e.bpm,0),Ar(this,"bpm"),this._timeSignature=e.timeSignature,this._swingTicks=e.ppq/2}static getDefaults(){return Object.assign(_u.getDefaults(),{bpm:120,loopEnd:"4m",loopStart:0,ppq:192,swing:0,swingSubdivision:"8n",timeSignature:4})}_processTick(e,n){if(this._loop.get(e)&&n>=this._loopEnd&&(this.emit("loopEnd",e),this._clock.setTicksAtTime(this._loopStart,e),n=this._loopStart,this.emit("loopStart",e,this._clock.getSecondsAtTime(e)),this.emit("loop",e)),this._swingAmount>0&&n%this._ppq!==0&&n%(this._swingTicks*2)!==0){const i=n%(this._swingTicks*2)/(this._swingTicks*2),r=Math.sin(i*Math.PI)*this._swingAmount;e+=new Dc(this.context,this._swingTicks*2/3).toSeconds()*r}mse(!0),this._timeline.forEachAtTime(n,i=>i.invoke(e)),mse(!1)}schedule(e,n){const i=new aE(this,{callback:e,time:new cC(this.context,n).toTicks()});return this._addEvent(i,this._timeline)}scheduleRepeat(e,n,i,r=1/0){const s=new tK(this,{callback:e,duration:new op(this.context,r).toTicks(),interval:new op(this.context,n).toTicks(),time:new cC(this.context,i).toTicks()});return this._addEvent(s,this._repeatedEvents)}scheduleOnce(e,n){const i=new aE(this,{callback:e,once:!0,time:new cC(this.context,n).toTicks()});return this._addEvent(i,this._timeline)}clear(e){if(this._scheduledEvents.hasOwnProperty(e)){const n=this._scheduledEvents[e.toString()];n.timeline.remove(n.event),n.event.dispose(),delete this._scheduledEvents[e.toString()]}return this}_addEvent(e,n){return this._scheduledEvents[e.id.toString()]={event:e,timeline:n},n.add(e),e.id}cancel(e=0){const n=this.toTicks(e);return this._timeline.forEachFrom(n,i=>this.clear(i.id)),this._repeatedEvents.forEachFrom(n,i=>this.clear(i.id)),this}_bindClockEvents(){this._clock.on("start",(e,n)=>{n=new Dc(this.context,n).toSeconds(),this.emit("start",e,n)}),this._clock.on("stop",e=>{this.emit("stop",e)}),this._clock.on("pause",e=>{this.emit("pause",e)})}get state(){return this._clock.getStateAtTime(this.now())}start(e,n){this.context.resume();let i;return vr(n)&&(i=this.toTicks(n)),this._clock.start(e,i),this}stop(e){return this._clock.stop(e),this}pause(e){return this._clock.pause(e),this}toggle(e){return e=this.toSeconds(e),this._clock.getStateAtTime(e)!=="started"?this.start(e):this.stop(e),this}get timeSignature(){return this._timeSignature}set timeSignature(e){nf(e)&&(e=e[0]/e[1]*4),this._timeSignature=e}get loopStart(){return new op(this.context,this._loopStart,"i").toSeconds()}set loopStart(e){this._loopStart=this.toTicks(e)}get loopEnd(){return new op(this.context,this._loopEnd,"i").toSeconds()}set loopEnd(e){this._loopEnd=this.toTicks(e)}get loop(){return this._loop.get(this.now())}set loop(e){this._loop.set(e,this.now())}setLoopPoints(e,n){return this.loopStart=e,this.loopEnd=n,this}get swing(){return this._swingAmount}set swing(e){this._swingAmount=e}get swingSubdivision(){return new Dc(this.context,this._swingTicks).toNotation()}set swingSubdivision(e){this._swingTicks=this.toTicks(e)}get position(){const e=this.now(),n=this._clock.getTicksAtTime(e);return new Dc(this.context,n).toBarsBeatsSixteenths()}set position(e){const n=this.toTicks(e);this.ticks=n}get seconds(){return this._clock.seconds}set seconds(e){const n=this.now(),i=this._clock.frequency.timeToTicks(e,n);this.ticks=i}get progress(){if(this.loop){const e=this.now();return(this._clock.getTicksAtTime(e)-this._loopStart)/(this._loopEnd-this._loopStart)}else return 0}get ticks(){return this._clock.ticks}set ticks(e){if(this._clock.ticks!==e){const n=this.now();if(this.state==="started"){const i=this._clock.getTicksAtTime(n),r=this._clock.frequency.getDurationOfTicks(Math.ceil(i)-i,n),s=n+r;this.emit("stop",s),this._clock.setTicksAtTime(e,s),this.emit("start",s,this._clock.getSecondsAtTime(s))}else this.emit("ticks",n),this._clock.setTicksAtTime(e,n)}}getTicksAtTime(e){return this._clock.getTicksAtTime(e)}getSecondsAtTime(e){return this._clock.getSecondsAtTime(e)}get PPQ(){return this._clock.frequency.multiplier}set PPQ(e){this._clock.frequency.multiplier=e}nextSubdivision(e){if(e=this.toTicks(e),this.state!=="started")return 0;{const n=this.now(),i=this.getTicksAtTime(n),r=e-i%e;return this._clock.nextTickTime(r,n)}}syncSignal(e,n){const i=this.now();let r=this.bpm,s=1/(60/r.getValueAtTime(i)/this.PPQ),a=[];if(e.units==="time"){const c=.015625/s,l=new yr(c),u=new eK(-1),h=new yr(c);r.chain(l,u,h),r=h,s=1/s,a=[l,u,h]}n||(e.getValueAtTime(i)!==0?n=e.getValueAtTime(i)/s:n=0);const o=new yr(n);return r.connect(o),o.connect(e._param),a.push(o),this._syncedSignals.push({initial:e.value,nodes:a,signal:e}),e.value=0,this}unsyncSignal(e){for(let n=this._syncedSignals.length-1;n>=0;n--){const i=this._syncedSignals[n];i.signal===e&&(i.nodes.forEach(r=>r.dispose()),i.signal.value=i.initial,this._syncedSignals.splice(n,1))}return this}dispose(){return super.dispose(),this._clock.dispose(),wk(this,"bpm"),this._timeline.dispose(),this._repeatedEvents.dispose(),this}}xk.mixin(n8);Kz(t=>{t.transport=new n8({context:t})});Zz(t=>{t.transport.dispose()});class bu extends Gn{constructor(e){super(e),this.input=void 0,this._state=new Ck("stopped"),this._synced=!1,this._scheduled=[],this._syncedStart=Ts,this._syncedStop=Ts,this._state.memory=100,this._state.increasing=!0,this._volume=this.output=new Pg({context:this.context,mute:e.mute,volume:e.volume}),this.volume=this._volume.volume,Ar(this,"volume"),this.onstop=e.onstop}static getDefaults(){return Object.assign(Gn.getDefaults(),{mute:!1,onstop:Ts,volume:0})}get state(){return this._synced?this.context.transport.state==="started"?this._state.getValueAtTime(this.context.transport.seconds):"stopped":this._state.getValueAtTime(this.now())}get mute(){return this._volume.mute}set mute(e){this._volume.mute=e}_clampToCurrentTime(e){return this._synced?e:Math.max(e,this.context.currentTime)}start(e,n,i){let r=ad(e)&&this._synced?this.context.transport.seconds:this.toSeconds(e);if(r=this._clampToCurrentTime(r),!this._synced&&this._state.getValueAtTime(r)==="started")Ai(lA(r,this._state.get(r).time),"Start time must be strictly greater than previous start time"),this._state.cancel(r),this._state.setStateAtTime("started",r),this.log("restart",r),this.restart(r,n,i);else if(this.log("start",r),this._state.setStateAtTime("started",r),this._synced){const s=this._state.get(r);s&&(s.offset=this.toSeconds(Xg(n,0)),s.duration=i?this.toSeconds(i):void 0);const a=this.context.transport.schedule(o=>{this._start(o,n,i)},r);this._scheduled.push(a),this.context.transport.state==="started"&&this.context.transport.getSecondsAtTime(this.immediate())>r&&this._syncedStart(this.now(),this.context.transport.seconds)}else xbe(this.context),this._start(r,n,i);return this}stop(e){let n=ad(e)&&this._synced?this.context.transport.seconds:this.toSeconds(e);if(n=this._clampToCurrentTime(n),this._state.getValueAtTime(n)==="started"||vr(this._state.getNextState("started",n))){if(this.log("stop",n),!this._synced)this._stop(n);else{const i=this.context.transport.schedule(this._stop.bind(this),n);this._scheduled.push(i)}this._state.cancel(n),this._state.setStateAtTime("stopped",n)}return this}restart(e,n,i){return e=this.toSeconds(e),this._state.getValueAtTime(e)==="started"&&(this._state.cancel(e),this._restart(e,n,i)),this}sync(){return this._synced||(this._synced=!0,this._syncedStart=(e,n)=>{if(lA(n,0)){const i=this._state.get(n);if(i&&i.state==="started"&&i.time!==n){const r=n-this.toSeconds(i.time);let s;i.duration&&(s=this.toSeconds(i.duration)-r),this._start(e,this.toSeconds(i.offset)+r,s)}}},this._syncedStop=e=>{const n=this.context.transport.getSecondsAtTime(Math.max(e-this.sampleTime,0));this._state.getValueAtTime(n)==="started"&&this._stop(e)},this.context.transport.on("start",this._syncedStart),this.context.transport.on("loopStart",this._syncedStart),this.context.transport.on("stop",this._syncedStop),this.context.transport.on("pause",this._syncedStop),this.context.transport.on("loopEnd",this._syncedStop)),this}unsync(){return this._synced&&(this.context.transport.off("stop",this._syncedStop),this.context.transport.off("pause",this._syncedStop),this.context.transport.off("loopEnd",this._syncedStop),this.context.transport.off("start",this._syncedStart),this.context.transport.off("loopStart",this._syncedStart)),this._synced=!1,this._scheduled.forEach(e=>this.context.transport.clear(e)),this._scheduled=[],this._state.cancel(0),this._stop(0),this}dispose(){return super.dispose(),this.onstop=Ts,this.unsync(),this._volume.dispose(),this._state.dispose(),this}}class Ak extends uA{constructor(){const e=Pn(Ak.getDefaults(),arguments,["url","onload"]);super(e),this.name="ToneBufferSource",this._source=this.context.createBufferSource(),this._internalChannels=[this._source],this._sourceStarted=!1,this._sourceStopped=!1,Ep(this._source,this._gainNode),this._source.onended=()=>this._stopSource(),this.playbackRate=new mr({context:this.context,param:this._source.playbackRate,units:"positive",value:e.playbackRate}),this.loop=e.loop,this.loopStart=e.loopStart,this.loopEnd=e.loopEnd,this._buffer=new Us(e.url,e.onload,e.onerror),this._internalChannels.push(this._source)}static getDefaults(){return Object.assign(uA.getDefaults(),{url:new Us,loop:!1,loopEnd:0,loopStart:0,onload:Ts,onerror:Ts,playbackRate:1})}get fadeIn(){return this._fadeIn}set fadeIn(e){this._fadeIn=e}get fadeOut(){return this._fadeOut}set fadeOut(e){this._fadeOut=e}get curve(){return this._curve}set curve(e){this._curve=e}start(e,n,i,r=1){Ai(this.buffer.loaded,"buffer is either not set or not loaded");const s=this.toSeconds(e);this._startGain(s,r),this.loop?n=Xg(n,this.loopStart):n=Xg(n,0);let a=Math.max(this.toSeconds(n),0);if(this.loop){const o=this.toSeconds(this.loopEnd)||this.buffer.duration,c=this.toSeconds(this.loopStart),l=o-c;u$(a,o)&&(a=(a-c)%l+c),am(a,this.buffer.duration)&&(a=0)}if(this._source.buffer=this.buffer.get(),this._source.loopEnd=this.toSeconds(this.loopEnd)||this.buffer.duration,H3(a,this.buffer.duration)&&(this._sourceStarted=!0,this._source.start(s,a)),vr(i)){let o=this.toSeconds(i);o=Math.max(o,0),this.stop(s+o)}return this}_stopSource(e){!this._sourceStopped&&this._sourceStarted&&(this._sourceStopped=!0,this._source.stop(this.toSeconds(e)),this._onended())}get loopStart(){return this._source.loopStart}set loopStart(e){this._source.loopStart=this.toSeconds(e)}get loopEnd(){return this._source.loopEnd}set loopEnd(e){this._source.loopEnd=this.toSeconds(e)}get buffer(){return this._buffer}set buffer(e){this._buffer.set(e)}get loop(){return this._source.loop}set loop(e){this._source.loop=e,this._sourceStarted&&this.cancelStop()}dispose(){return super.dispose(),this._source.onended=null,this._source.disconnect(),this._buffer.dispose(),this.playbackRate.dispose(),this}}class fA extends bu{constructor(){const e=Pn(fA.getDefaults(),arguments,["type"]);super(e),this.name="Noise",this._source=null,this._playbackRate=e.playbackRate,this.type=e.type,this._fadeIn=e.fadeIn,this._fadeOut=e.fadeOut}static getDefaults(){return Object.assign(bu.getDefaults(),{fadeIn:0,fadeOut:0,playbackRate:1,type:"white"})}get type(){return this._type}set type(e){if(Ai(e in vse,"Noise: invalid type: "+e),this._type!==e&&(this._type=e,this.state==="started")){const n=this.now();this._stop(n),this._start(n)}}get playbackRate(){return this._playbackRate}set playbackRate(e){this._playbackRate=e,this._source&&(this._source.playbackRate.value=e)}_start(e){const n=vse[this._type];this._source=new Ak({url:n,context:this.context,fadeIn:this._fadeIn,fadeOut:this._fadeOut,loop:!0,onended:()=>this.onstop(this),playbackRate:this._playbackRate}).connect(this.output),this._source.start(this.toSeconds(e),Math.random()*(n.duration-.001))}_stop(e){this._source&&(this._source.stop(this.toSeconds(e)),this._source=null)}get fadeIn(){return this._fadeIn}set fadeIn(e){this._fadeIn=e,this._source&&(this._source.fadeIn=this._fadeIn)}get fadeOut(){return this._fadeOut}set fadeOut(e){this._fadeOut=e,this._source&&(this._source.fadeOut=this._fadeOut)}_restart(e){this._stop(e),this._start(e)}dispose(){return super.dispose(),this._source&&this._source.disconnect(),this}}const Zx=44100*5,xj=2,Dv={brown:null,pink:null,white:null},vse={get brown(){if(!Dv.brown){const t=[];for(let e=0;e<xj;e++){const n=new Float32Array(Zx);t[e]=n;let i=0;for(let r=0;r<Zx;r++){const s=Math.random()*2-1;n[r]=(i+.02*s)/1.02,i=n[r],n[r]*=3.5}}Dv.brown=new Us().fromArray(t)}return Dv.brown},get pink(){if(!Dv.pink){const t=[];for(let e=0;e<xj;e++){const n=new Float32Array(Zx);t[e]=n;let i,r,s,a,o,c,l;i=r=s=a=o=c=l=0;for(let u=0;u<Zx;u++){const h=Math.random()*2-1;i=.99886*i+h*.0555179,r=.99332*r+h*.0750759,s=.969*s+h*.153852,a=.8665*a+h*.3104856,o=.55*o+h*.5329522,c=-.7616*c-h*.016898,n[u]=i+r+s+a+o+c+l+h*.5362,n[u]*=.11,l=h*.115926}}Dv.pink=new Us().fromArray(t)}return Dv.pink},get white(){if(!Dv.white){const t=[];for(let e=0;e<xj;e++){const n=new Float32Array(Zx);t[e]=n;for(let i=0;i<Zx;i++)n[i]=Math.random()*2-1}Dv.white=new Us().fromArray(t)}return Dv.white}};function U1(t,e){return Qa(this,void 0,void 0,function*(){const n=e/t.context.sampleRate,i=new Jz(1,n,t.context.sampleRate);return new t.constructor(Object.assign(t.get(),{frequency:2/n,detune:0,context:i})).toDestination().start(0),(yield i.render()).getChannelData(0)})}class nK extends uA{constructor(){const e=Pn(nK.getDefaults(),arguments,["frequency","type"]);super(e),this.name="ToneOscillatorNode",this._oscillator=this.context.createOscillator(),this._internalChannels=[this._oscillator],Ep(this._oscillator,this._gainNode),this.type=e.type,this.frequency=new mr({context:this.context,param:this._oscillator.frequency,units:"frequency",value:e.frequency}),this.detune=new mr({context:this.context,param:this._oscillator.detune,units:"cents",value:e.detune}),Ar(this,["frequency","detune"])}static getDefaults(){return Object.assign(uA.getDefaults(),{detune:0,frequency:440,type:"sine"})}start(e){const n=this.toSeconds(e);return this.log("start",n),this._startGain(n),this._oscillator.start(n),this}_stopSource(e){this._oscillator.stop(e)}setPeriodicWave(e){return this._oscillator.setPeriodicWave(e),this}get type(){return this._oscillator.type}set type(e){this._oscillator.type=e}dispose(){return super.dispose(),this.state==="started"&&this.stop(),this._oscillator.disconnect(),this.frequency.dispose(),this.detune.dispose(),this}}class To extends bu{constructor(){const e=Pn(To.getDefaults(),arguments,["frequency","type"]);super(e),this.name="Oscillator",this._oscillator=null,this.frequency=new cs({context:this.context,units:"frequency",value:e.frequency}),Ar(this,"frequency"),this.detune=new cs({context:this.context,units:"cents",value:e.detune}),Ar(this,"detune"),this._partials=e.partials,this._partialCount=e.partialCount,this._type=e.type,e.partialCount&&e.type!=="custom"&&(this._type=this.baseType+e.partialCount.toString()),this.phase=e.phase}static getDefaults(){return Object.assign(bu.getDefaults(),{detune:0,frequency:440,partialCount:0,partials:[],phase:0,type:"sine"})}_start(e){const n=this.toSeconds(e),i=new nK({context:this.context,onended:()=>this.onstop(this)});this._oscillator=i,this._wave?this._oscillator.setPeriodicWave(this._wave):this._oscillator.type=this._type,this._oscillator.connect(this.output),this.frequency.connect(this._oscillator.frequency),this.detune.connect(this._oscillator.detune),this._oscillator.start(n)}_stop(e){const n=this.toSeconds(e);this._oscillator&&this._oscillator.stop(n)}_restart(e){const n=this.toSeconds(e);return this.log("restart",n),this._oscillator&&this._oscillator.cancelStop(),this._state.cancel(n),this}syncFrequency(){return this.context.transport.syncSignal(this.frequency),this}unsyncFrequency(){return this.context.transport.unsyncSignal(this.frequency),this}_getCachedPeriodicWave(){if(this._type==="custom")return To._periodicWaveCache.find(n=>n.phase===this._phase&&s0t(n.partials,this._partials));{const e=To._periodicWaveCache.find(n=>n.type===this._type&&n.phase===this._phase);return this._partialCount=e?e.partialCount:this._partialCount,e}}get type(){return this._type}set type(e){this._type=e;const n=["sine","square","sawtooth","triangle"].indexOf(e)!==-1;if(this._phase===0&&n)this._wave=void 0,this._partialCount=0,this._oscillator!==null&&(this._oscillator.type=e);else{const i=this._getCachedPeriodicWave();if(vr(i)){const{partials:r,wave:s}=i;this._wave=s,this._partials=r,this._oscillator!==null&&this._oscillator.setPeriodicWave(this._wave)}else{const[r,s]=this._getRealImaginary(e,this._phase),a=this.context.createPeriodicWave(r,s);this._wave=a,this._oscillator!==null&&this._oscillator.setPeriodicWave(this._wave),To._periodicWaveCache.push({imag:s,partialCount:this._partialCount,partials:this._partials,phase:this._phase,real:r,type:this._type,wave:this._wave}),To._periodicWaveCache.length>100&&To._periodicWaveCache.shift()}}}get baseType(){return this._type.replace(this.partialCount.toString(),"")}set baseType(e){this.partialCount&&this._type!=="custom"&&e!=="custom"?this.type=e+this.partialCount:this.type=e}get partialCount(){return this._partialCount}set partialCount(e){ap(e,0);let n=this._type;const i=/^(sine|triangle|square|sawtooth)(\d+)$/.exec(this._type);if(i&&(n=i[1]),this._type!=="custom")e===0?this.type=n:this.type=n+e.toString();else{const r=new Float32Array(e);this._partials.forEach((s,a)=>r[a]=s),this._partials=Array.from(r),this.type=this._type}}_getRealImaginary(e,n){let r=2048;const s=new Float32Array(r),a=new Float32Array(r);let o=1;if(e==="custom"){if(o=this._partials.length+1,this._partialCount=this._partials.length,r=o,this._partials.length===0)return[s,a]}else{const c=/^(sine|triangle|square|sawtooth)(\d+)$/.exec(e);c?(o=parseInt(c[2],10)+1,this._partialCount=parseInt(c[2],10),e=c[1],o=Math.max(o,2),r=o):this._partialCount=0,this._partials=[]}for(let c=1;c<r;++c){const l=2/(c*Math.PI);let u;switch(e){case"sine":u=c<=o?1:0,this._partials[c-1]=u;break;case"square":u=c&1?2*l:0,this._partials[c-1]=u;break;case"sawtooth":u=l*(c&1?1:-1),this._partials[c-1]=u;break;case"triangle":c&1?u=2*(l*l)*(c-1>>1&1?-1:1):u=0,this._partials[c-1]=u;break;case"custom":u=this._partials[c-1];break;default:throw new TypeError("Oscillator: invalid type: "+e)}u!==0?(s[c]=-u*Math.sin(n*c),a[c]=u*Math.cos(n*c)):(s[c]=0,a[c]=0)}return[s,a]}_inverseFFT(e,n,i){let r=0;const s=e.length;for(let a=0;a<s;a++)r+=e[a]*Math.cos(a*i)+n[a]*Math.sin(a*i);return r}getInitialValue(){const[e,n]=this._getRealImaginary(this._type,0);let i=0;const r=Math.PI*2,s=32;for(let a=0;a<s;a++)i=Math.max(this._inverseFFT(e,n,a/s*r),i);return o0t(-this._inverseFFT(e,n,this._phase)/i,-1,1)}get partials(){return this._partials.slice(0,this.partialCount)}set partials(e){this._partials=e,this._partialCount=this._partials.length,e.length&&(this.type="custom")}get phase(){return this._phase*(180/Math.PI)}set phase(e){this._phase=e*Math.PI/180,this.type=this._type}asArray(){return Qa(this,arguments,void 0,function*(e=1024){return U1(this,e)})}dispose(){return super.dispose(),this._oscillator!==null&&this._oscillator.dispose(),this._wave=void 0,this.frequency.dispose(),this.detune.dispose(),this}}To._periodicWaveCache=[];class Ube extends c0{constructor(){super(...arguments),this.name="AudioToGain",this._norm=new L1({context:this.context,mapping:e=>(e+1)/2}),this.input=this._norm,this.output=this._norm}dispose(){return super.dispose(),this._norm.dispose(),this}}class l1 extends cs{constructor(){const e=Pn(l1.getDefaults(),arguments,["value"]);super(e),this.name="Multiply",this.override=!1,this._mult=this.input=this.output=new yr({context:this.context,minValue:e.minValue,maxValue:e.maxValue}),this.factor=this._param=this._mult.gain,this.factor.setValueAtTime(e.value,0)}static getDefaults(){return Object.assign(cs.getDefaults(),{value:0})}dispose(){return super.dispose(),this._mult.dispose(),this}}class i8 extends bu{constructor(){const e=Pn(i8.getDefaults(),arguments,["frequency","type","modulationType"]);super(e),this.name="AMOscillator",this._modulationScale=new Ube({context:this.context}),this._modulationNode=new yr({context:this.context}),this._carrier=new To({context:this.context,detune:e.detune,frequency:e.frequency,onstop:()=>this.onstop(this),phase:e.phase,type:e.type}),this.frequency=this._carrier.frequency,this.detune=this._carrier.detune,this._modulator=new To({context:this.context,phase:e.phase,type:e.modulationType}),this.harmonicity=new l1({context:this.context,units:"positive",value:e.harmonicity}),this.frequency.chain(this.harmonicity,this._modulator.frequency),this._modulator.chain(this._modulationScale,this._modulationNode.gain),this._carrier.chain(this._modulationNode,this.output),Ar(this,["frequency","detune","harmonicity"])}static getDefaults(){return Object.assign(To.getDefaults(),{harmonicity:1,modulationType:"square"})}_start(e){this._modulator.start(e),this._carrier.start(e)}_stop(e){this._modulator.stop(e),this._carrier.stop(e)}_restart(e){this._modulator.restart(e),this._carrier.restart(e)}get type(){return this._carrier.type}set type(e){this._carrier.type=e}get baseType(){return this._carrier.baseType}set baseType(e){this._carrier.baseType=e}get partialCount(){return this._carrier.partialCount}set partialCount(e){this._carrier.partialCount=e}get modulationType(){return this._modulator.type}set modulationType(e){this._modulator.type=e}get phase(){return this._carrier.phase}set phase(e){this._carrier.phase=e,this._modulator.phase=e}get partials(){return this._carrier.partials}set partials(e){this._carrier.partials=e}asArray(){return Qa(this,arguments,void 0,function*(e=1024){return U1(this,e)})}dispose(){return super.dispose(),this.frequency.dispose(),this.detune.dispose(),this.harmonicity.dispose(),this._carrier.dispose(),this._modulator.dispose(),this._modulationNode.dispose(),this._modulationScale.dispose(),this}}class r8 extends bu{constructor(){const e=Pn(r8.getDefaults(),arguments,["frequency","type","modulationType"]);super(e),this.name="FMOscillator",this._modulationNode=new yr({context:this.context,gain:0}),this._carrier=new To({context:this.context,detune:e.detune,frequency:0,onstop:()=>this.onstop(this),phase:e.phase,type:e.type}),this.detune=this._carrier.detune,this.frequency=new cs({context:this.context,units:"frequency",value:e.frequency}),this._modulator=new To({context:this.context,phase:e.phase,type:e.modulationType}),this.harmonicity=new l1({context:this.context,units:"positive",value:e.harmonicity}),this.modulationIndex=new l1({context:this.context,units:"positive",value:e.modulationIndex}),this.frequency.connect(this._carrier.frequency),this.frequency.chain(this.harmonicity,this._modulator.frequency),this.frequency.chain(this.modulationIndex,this._modulationNode),this._modulator.connect(this._modulationNode.gain),this._modulationNode.connect(this._carrier.frequency),this._carrier.connect(this.output),this.detune.connect(this._modulator.detune),Ar(this,["modulationIndex","frequency","detune","harmonicity"])}static getDefaults(){return Object.assign(To.getDefaults(),{harmonicity:1,modulationIndex:2,modulationType:"square"})}_start(e){this._modulator.start(e),this._carrier.start(e)}_stop(e){this._modulator.stop(e),this._carrier.stop(e)}_restart(e){return this._modulator.restart(e),this._carrier.restart(e),this}get type(){return this._carrier.type}set type(e){this._carrier.type=e}get baseType(){return this._carrier.baseType}set baseType(e){this._carrier.baseType=e}get partialCount(){return this._carrier.partialCount}set partialCount(e){this._carrier.partialCount=e}get modulationType(){return this._modulator.type}set modulationType(e){this._modulator.type=e}get phase(){return this._carrier.phase}set phase(e){this._carrier.phase=e,this._modulator.phase=e}get partials(){return this._carrier.partials}set partials(e){this._carrier.partials=e}asArray(){return Qa(this,arguments,void 0,function*(e=1024){return U1(this,e)})}dispose(){return super.dispose(),this.frequency.dispose(),this.harmonicity.dispose(),this._carrier.dispose(),this._modulator.dispose(),this._modulationNode.dispose(),this.modulationIndex.dispose(),this}}class Rk extends bu{constructor(){const e=Pn(Rk.getDefaults(),arguments,["frequency","width"]);super(e),this.name="PulseOscillator",this._widthGate=new yr({context:this.context,gain:0}),this._thresh=new L1({context:this.context,mapping:n=>n<=0?-1:1}),this.width=new cs({context:this.context,units:"audioRange",value:e.width}),this._triangle=new To({context:this.context,detune:e.detune,frequency:e.frequency,onstop:()=>this.onstop(this),phase:e.phase,type:"triangle"}),this.frequency=this._triangle.frequency,this.detune=this._triangle.detune,this._triangle.chain(this._thresh,this.output),this.width.chain(this._widthGate,this._thresh),Ar(this,["width","frequency","detune"])}static getDefaults(){return Object.assign(bu.getDefaults(),{detune:0,frequency:440,phase:0,type:"pulse",width:.2})}_start(e){e=this.toSeconds(e),this._triangle.start(e),this._widthGate.gain.setValueAtTime(1,e)}_stop(e){e=this.toSeconds(e),this._triangle.stop(e),this._widthGate.gain.cancelScheduledValues(e),this._widthGate.gain.setValueAtTime(0,e)}_restart(e){this._triangle.restart(e),this._widthGate.gain.cancelScheduledValues(e),this._widthGate.gain.setValueAtTime(1,e)}get phase(){return this._triangle.phase}set phase(e){this._triangle.phase=e}get type(){return"pulse"}get baseType(){return"pulse"}get partials(){return[]}get partialCount(){return 0}set carrierType(e){this._triangle.type=e}asArray(){return Qa(this,arguments,void 0,function*(e=1024){return U1(this,e)})}dispose(){return super.dispose(),this._triangle.dispose(),this.width.dispose(),this._widthGate.dispose(),this._thresh.dispose(),this}}class s8 extends bu{constructor(){const e=Pn(s8.getDefaults(),arguments,["frequency","type","spread"]);super(e),this.name="FatOscillator",this._oscillators=[],this.frequency=new cs({context:this.context,units:"frequency",value:e.frequency}),this.detune=new cs({context:this.context,units:"cents",value:e.detune}),this._spread=e.spread,this._type=e.type,this._phase=e.phase,this._partials=e.partials,this._partialCount=e.partialCount,this.count=e.count,Ar(this,["frequency","detune"])}static getDefaults(){return Object.assign(To.getDefaults(),{count:3,spread:20,type:"sawtooth"})}_start(e){e=this.toSeconds(e),this._forEach(n=>n.start(e))}_stop(e){e=this.toSeconds(e),this._forEach(n=>n.stop(e))}_restart(e){this._forEach(n=>n.restart(e))}_forEach(e){for(let n=0;n<this._oscillators.length;n++)e(this._oscillators[n],n)}get type(){return this._type}set type(e){this._type=e,this._forEach(n=>n.type=e)}get spread(){return this._spread}set spread(e){if(this._spread=e,this._oscillators.length>1){const n=-e/2,i=e/(this._oscillators.length-1);this._forEach((r,s)=>r.detune.value=n+i*s)}}get count(){return this._oscillators.length}set count(e){if(ap(e,1),this._oscillators.length!==e){this._forEach(n=>n.dispose()),this._oscillators=[];for(let n=0;n<e;n++){const i=new To({context:this.context,volume:-6-e*1.1,type:this._type,phase:this._phase+n/e*360,partialCount:this._partialCount,onstop:n===0?()=>this.onstop(this):Ts});this.type==="custom"&&(i.partials=this._partials),this.frequency.connect(i.frequency),this.detune.connect(i.detune),i.detune.overridden=!1,i.connect(this.output),this._oscillators[n]=i}this.spread=this._spread,this.state==="started"&&this._forEach(n=>n.start())}}get phase(){return this._phase}set phase(e){this._phase=e,this._forEach((n,i)=>n.phase=this._phase+i/this.count*360)}get baseType(){return this._oscillators[0].baseType}set baseType(e){this._forEach(n=>n.baseType=e),this._type=this._oscillators[0].type}get partials(){return this._oscillators[0].partials}set partials(e){this._partials=e,this._partialCount=this._partials.length,e.length&&(this._type="custom",this._forEach(n=>n.partials=e))}get partialCount(){return this._oscillators[0].partialCount}set partialCount(e){this._partialCount=e,this._forEach(n=>n.partialCount=e),this._type=this._oscillators[0].type}asArray(){return Qa(this,arguments,void 0,function*(e=1024){return U1(this,e)})}dispose(){return super.dispose(),this.frequency.dispose(),this.detune.dispose(),this._forEach(e=>e.dispose()),this}}class a8 extends bu{constructor(){const e=Pn(a8.getDefaults(),arguments,["frequency","modulationFrequency"]);super(e),this.name="PWMOscillator",this.sourceType="pwm",this._scale=new l1({context:this.context,value:2}),this._pulse=new Rk({context:this.context,frequency:e.modulationFrequency}),this._pulse.carrierType="sine",this.modulationFrequency=this._pulse.frequency,this._modulator=new To({context:this.context,detune:e.detune,frequency:e.frequency,onstop:()=>this.onstop(this),phase:e.phase}),this.frequency=this._modulator.frequency,this.detune=this._modulator.detune,this._modulator.chain(this._scale,this._pulse.width),this._pulse.connect(this.output),Ar(this,["modulationFrequency","frequency","detune"])}static getDefaults(){return Object.assign(bu.getDefaults(),{detune:0,frequency:440,modulationFrequency:.4,phase:0,type:"pwm"})}_start(e){e=this.toSeconds(e),this._modulator.start(e),this._pulse.start(e)}_stop(e){e=this.toSeconds(e),this._modulator.stop(e),this._pulse.stop(e)}_restart(e){this._modulator.restart(e),this._pulse.restart(e)}get type(){return"pwm"}get baseType(){return"pwm"}get partials(){return[]}get partialCount(){return 0}get phase(){return this._modulator.phase}set phase(e){this._modulator.phase=e}asArray(){return Qa(this,arguments,void 0,function*(e=1024){return U1(this,e)})}dispose(){return super.dispose(),this._pulse.dispose(),this._scale.dispose(),this._modulator.dispose(),this}}const _se={am:i8,fat:s8,fm:r8,oscillator:To,pulse:Rk,pwm:a8};class V3 extends bu{constructor(){const e=Pn(V3.getDefaults(),arguments,["frequency","type"]);super(e),this.name="OmniOscillator",this.frequency=new cs({context:this.context,units:"frequency",value:e.frequency}),this.detune=new cs({context:this.context,units:"cents",value:e.detune}),Ar(this,["frequency","detune"]),this.set(e)}static getDefaults(){return Object.assign(To.getDefaults(),r8.getDefaults(),i8.getDefaults(),s8.getDefaults(),Rk.getDefaults(),a8.getDefaults())}_start(e){this._oscillator.start(e)}_stop(e){this._oscillator.stop(e)}_restart(e){return this._oscillator.restart(e),this}get type(){let e="";return["am","fm","fat"].some(n=>this._sourceType===n)&&(e=this._sourceType),e+this._oscillator.type}set type(e){e.substr(0,2)==="fm"?(this._createNewOscillator("fm"),this._oscillator=this._oscillator,this._oscillator.type=e.substr(2)):e.substr(0,2)==="am"?(this._createNewOscillator("am"),this._oscillator=this._oscillator,this._oscillator.type=e.substr(2)):e.substr(0,3)==="fat"?(this._createNewOscillator("fat"),this._oscillator=this._oscillator,this._oscillator.type=e.substr(3)):e==="pwm"?(this._createNewOscillator("pwm"),this._oscillator=this._oscillator):e==="pulse"?this._createNewOscillator("pulse"):(this._createNewOscillator("oscillator"),this._oscillator=this._oscillator,this._oscillator.type=e)}get partials(){return this._oscillator.partials}set partials(e){!this._getOscType(this._oscillator,"pulse")&&!this._getOscType(this._oscillator,"pwm")&&(this._oscillator.partials=e)}get partialCount(){return this._oscillator.partialCount}set partialCount(e){!this._getOscType(this._oscillator,"pulse")&&!this._getOscType(this._oscillator,"pwm")&&(this._oscillator.partialCount=e)}set(e){return Reflect.has(e,"type")&&e.type&&(this.type=e.type),super.set(e),this}_createNewOscillator(e){if(e!==this._sourceType){this._sourceType=e;const n=_se[e],i=this.now();if(this._oscillator){const r=this._oscillator;r.stop(i),this.context.setTimeout(()=>r.dispose(),this.blockTime)}this._oscillator=new n({context:this.context}),this.frequency.connect(this._oscillator.frequency),this.detune.connect(this._oscillator.detune),this._oscillator.connect(this.output),this._oscillator.onstop=()=>this.onstop(this),this.state==="started"&&this._oscillator.start(i)}}get phase(){return this._oscillator.phase}set phase(e){this._oscillator.phase=e}get sourceType(){return this._sourceType}set sourceType(e){let n="sine";this._oscillator.type!=="pwm"&&this._oscillator.type!=="pulse"&&(n=this._oscillator.type),e==="fm"?this.type="fm"+n:e==="am"?this.type="am"+n:e==="fat"?this.type="fat"+n:e==="oscillator"?this.type=n:e==="pulse"?this.type="pulse":e==="pwm"&&(this.type="pwm")}_getOscType(e,n){return e instanceof _se[n]}get baseType(){return this._oscillator.baseType}set baseType(e){!this._getOscType(this._oscillator,"pulse")&&!this._getOscType(this._oscillator,"pwm")&&e!=="pulse"&&e!=="pwm"&&(this._oscillator.baseType=e)}get width(){if(this._getOscType(this._oscillator,"pulse"))return this._oscillator.width}get count(){if(this._getOscType(this._oscillator,"fat"))return this._oscillator.count}set count(e){this._getOscType(this._oscillator,"fat")&&ym(e)&&(this._oscillator.count=e)}get spread(){if(this._getOscType(this._oscillator,"fat"))return this._oscillator.spread}set spread(e){this._getOscType(this._oscillator,"fat")&&ym(e)&&(this._oscillator.spread=e)}get modulationType(){if(this._getOscType(this._oscillator,"fm")||this._getOscType(this._oscillator,"am"))return this._oscillator.modulationType}set modulationType(e){(this._getOscType(this._oscillator,"fm")||this._getOscType(this._oscillator,"am"))&&M_(e)&&(this._oscillator.modulationType=e)}get modulationIndex(){if(this._getOscType(this._oscillator,"fm"))return this._oscillator.modulationIndex}get harmonicity(){if(this._getOscType(this._oscillator,"fm")||this._getOscType(this._oscillator,"am"))return this._oscillator.harmonicity}get modulationFrequency(){if(this._getOscType(this._oscillator,"pwm"))return this._oscillator.modulationFrequency}asArray(){return Qa(this,arguments,void 0,function*(e=1024){return U1(this,e)})}dispose(){return super.dispose(),this.detune.dispose(),this.frequency.dispose(),this._oscillator.dispose(),this}}class iK extends cs{constructor(){super(Pn(iK.getDefaults(),arguments,["value"])),this.override=!1,this.name="Add",this._sum=new yr({context:this.context}),this.input=this._sum,this.output=this._sum,this.addend=this._param,c1(this._constantSource,this._sum)}static getDefaults(){return Object.assign(cs.getDefaults(),{value:0})}dispose(){return super.dispose(),this._sum.dispose(),this}}class rK extends c0{constructor(){const e=Pn(rK.getDefaults(),arguments,["min","max"]);super(e),this.name="Scale",this._mult=this.input=new l1({context:this.context,value:e.max-e.min}),this._add=this.output=new iK({context:this.context,value:e.min}),this._min=e.min,this._max=e.max,this.input.connect(this.output)}static getDefaults(){return Object.assign(c0.getDefaults(),{max:1,min:0})}get min(){return this._min}set min(e){this._min=e,this._setRange()}get max(){return this._max}set max(e){this._max=e,this._setRange()}_setRange(){this._add.value=this._min,this._mult.value=this._max-this._min}dispose(){return super.dispose(),this._add.dispose(),this._mult.dispose(),this}}class sK extends c0{constructor(){super(Pn(sK.getDefaults(),arguments)),this.name="Zero",this._gain=new yr({context:this.context}),this.output=this._gain,this.input=void 0,Ep(this.context.getConstant(0),this._gain)}dispose(){return super.dispose(),Lbe(this.context.getConstant(0),this._gain),this}}class u1 extends Gn{constructor(){const e=Pn(u1.getDefaults(),arguments,["frequency","min","max"]);super(e),this.name="LFO",this._stoppedValue=0,this._units="number",this.convert=!0,this._fromType=mr.prototype._fromType,this._toType=mr.prototype._toType,this._is=mr.prototype._is,this._clampValue=mr.prototype._clampValue,this._oscillator=new To(e),this.frequency=this._oscillator.frequency,this._amplitudeGain=new yr({context:this.context,gain:e.amplitude,units:"normalRange"}),this.amplitude=this._amplitudeGain.gain,this._stoppedSignal=new cs({context:this.context,units:"audioRange",value:0}),this._zeros=new sK({context:this.context}),this._a2g=new Ube({context:this.context}),this._scaler=this.output=new rK({context:this.context,max:e.max,min:e.min}),this.units=e.units,this.min=e.min,this.max=e.max,this._oscillator.chain(this._amplitudeGain,this._a2g,this._scaler),this._zeros.connect(this._a2g),this._stoppedSignal.connect(this._a2g),Ar(this,["amplitude","frequency"]),this.phase=e.phase}static getDefaults(){return Object.assign(To.getDefaults(),{amplitude:1,frequency:"4n",max:1,min:0,type:"sine",units:"number"})}start(e){return e=this.toSeconds(e),this._stoppedSignal.setValueAtTime(0,e),this._oscillator.start(e),this}stop(e){return e=this.toSeconds(e),this._stoppedSignal.setValueAtTime(this._stoppedValue,e),this._oscillator.stop(e),this}sync(){return this._oscillator.sync(),this._oscillator.syncFrequency(),this}unsync(){return this._oscillator.unsync(),this._oscillator.unsyncFrequency(),this}_setStoppedValue(){this._stoppedValue=this._oscillator.getInitialValue(),this._stoppedSignal.value=this._stoppedValue}get min(){return this._toType(this._scaler.min)}set min(e){e=this._fromType(e),this._scaler.min=e}get max(){return this._toType(this._scaler.max)}set max(e){e=this._fromType(e),this._scaler.max=e}get type(){return this._oscillator.type}set type(e){this._oscillator.type=e,this._setStoppedValue()}get partials(){return this._oscillator.partials}set partials(e){this._oscillator.partials=e,this._setStoppedValue()}get phase(){return this._oscillator.phase}set phase(e){this._oscillator.phase=e,this._setStoppedValue()}get units(){return this._units}set units(e){const n=this.min,i=this.max;this._units=e,this.min=n,this.max=i}get state(){return this._oscillator.state}connect(e,n,i){return(e instanceof mr||e instanceof cs)&&(this.convert=e.convert,this.units=e.units),e8(this,e,n,i),this}dispose(){return super.dispose(),this._oscillator.dispose(),this._stoppedSignal.dispose(),this._zeros.dispose(),this._scaler.dispose(),this._a2g.dispose(),this._amplitudeGain.dispose(),this.amplitude.dispose(),this}}function Bbe(t,e=1/0){const n=new WeakMap;return function(i,r){Reflect.defineProperty(i,r,{configurable:!0,enumerable:!0,get:function(){return n.get(this)},set:function(s){ap(s,t,e),n.set(this,s)}})}}function j_(t,e=1/0){const n=new WeakMap;return function(i,r){Reflect.defineProperty(i,r,{configurable:!0,enumerable:!0,get:function(){return n.get(this)},set:function(s){ap(this.toSeconds(s),t,e),n.set(this,s)}})}}class Mk extends bu{constructor(){const e=Pn(Mk.getDefaults(),arguments,["url","onload"]);super(e),this.name="Player",this._activeSources=new Set,this._buffer=new Us({onload:this._onload.bind(this,e.onload),onerror:e.onerror,reverse:e.reverse,url:e.url}),this.autostart=e.autostart,this._loop=e.loop,this._loopStart=e.loopStart,this._loopEnd=e.loopEnd,this._playbackRate=e.playbackRate,this.fadeIn=e.fadeIn,this.fadeOut=e.fadeOut}static getDefaults(){return Object.assign(bu.getDefaults(),{autostart:!1,fadeIn:0,fadeOut:0,loop:!1,loopEnd:0,loopStart:0,onload:Ts,onerror:Ts,playbackRate:1,reverse:!1})}load(e){return Qa(this,void 0,void 0,function*(){return yield this._buffer.load(e),this._onload(),this})}_onload(e=Ts){e(),this.autostart&&this.start()}_onSourceEnd(e){this.onstop(this),this._activeSources.delete(e),this._activeSources.size===0&&!this._synced&&this._state.getValueAtTime(this.now())==="started"&&(this._state.cancel(this.now()),this._state.setStateAtTime("stopped",this.now()))}start(e,n,i){return super.start(e,n,i),this}_start(e,n,i){this._loop?n=Xg(n,this._loopStart):n=Xg(n,0);const r=this.toSeconds(n),s=i;i=Xg(i,Math.max(this._buffer.duration-r,0));let a=this.toSeconds(i);a=a/this._playbackRate,e=this.toSeconds(e);const o=new Ak({url:this._buffer,context:this.context,fadeIn:this.fadeIn,fadeOut:this.fadeOut,loop:this._loop,loopEnd:this._loopEnd,loopStart:this._loopStart,onended:this._onSourceEnd.bind(this),playbackRate:this._playbackRate}).connect(this.output);!this._loop&&!this._synced&&(this._state.cancel(e+a),this._state.setStateAtTime("stopped",e+a,{implicitEnd:!0})),this._activeSources.add(o),this._loop&&ad(s)?o.start(e,r):o.start(e,r,a-this.toSeconds(this.fadeOut))}_stop(e){const n=this.toSeconds(e);this._activeSources.forEach(i=>i.stop(n))}restart(e,n,i){return super.restart(e,n,i),this}_restart(e,n,i){var r;(r=[...this._activeSources].pop())===null||r===void 0||r.stop(e),this._start(e,n,i)}seek(e,n){const i=this.toSeconds(n);if(this._state.getValueAtTime(i)==="started"){const r=this.toSeconds(e);this._stop(i),this._start(i,r)}return this}setLoopPoints(e,n){return this.loopStart=e,this.loopEnd=n,this}get loopStart(){return this._loopStart}set loopStart(e){this._loopStart=e,this.buffer.loaded&&ap(this.toSeconds(e),0,this.buffer.duration),this._activeSources.forEach(n=>{n.loopStart=e})}get loopEnd(){return this._loopEnd}set loopEnd(e){this._loopEnd=e,this.buffer.loaded&&ap(this.toSeconds(e),0,this.buffer.duration),this._activeSources.forEach(n=>{n.loopEnd=e})}get buffer(){return this._buffer}set buffer(e){this._buffer.set(e)}get loop(){return this._loop}set loop(e){if(this._loop!==e&&(this._loop=e,this._activeSources.forEach(n=>{n.loop=e}),e)){const n=this._state.getNextState("stopped",this.now());n&&this._state.cancel(n.time)}}get playbackRate(){return this._playbackRate}set playbackRate(e){this._playbackRate=e;const n=this.now(),i=this._state.getNextState("stopped",n);i&&i.implicitEnd&&(this._state.cancel(i.time),this._activeSources.forEach(r=>r.cancelStop())),this._activeSources.forEach(r=>{r.playbackRate.setValueAtTime(e,n)})}get reverse(){return this._buffer.reverse}set reverse(e){this._buffer.reverse=e}get loaded(){return this._buffer.loaded}dispose(){return super.dispose(),this._activeSources.forEach(e=>e.dispose()),this._activeSources.clear(),this._buffer.dispose(),this}}ca([j_(0)],Mk.prototype,"fadeIn",void 0);ca([j_(0)],Mk.prototype,"fadeOut",void 0);class T0t extends c0{constructor(){super(...arguments),this.name="GainToAudio",this._norm=new L1({context:this.context,mapping:e=>Math.abs(e)*2-1}),this.input=this._norm,this.output=this._norm}dispose(){return super.dispose(),this._norm.dispose(),this}}class V_ extends Gn{constructor(){const e=Pn(V_.getDefaults(),arguments,["attack","decay","sustain","release"]);super(e),this.name="Envelope",this._sig=new cs({context:this.context,value:0}),this.output=this._sig,this.input=void 0,this.attack=e.attack,this.decay=e.decay,this.sustain=e.sustain,this.release=e.release,this.attackCurve=e.attackCurve,this.releaseCurve=e.releaseCurve,this.decayCurve=e.decayCurve}static getDefaults(){return Object.assign(Gn.getDefaults(),{attack:.01,attackCurve:"linear",decay:.1,decayCurve:"exponential",release:1,releaseCurve:"exponential",sustain:.5})}get value(){return this.getValueAtTime(this.now())}_getCurve(e,n){if(M_(e))return e;{let i;for(i in zP)if(zP[i][n]===e)return i;return e}}_setCurve(e,n,i){if(M_(i)&&Reflect.has(zP,i)){const r=zP[i];zb(r)?e!=="_decayCurve"&&(this[e]=r[n]):this[e]=r}else if(nf(i)&&e!=="_decayCurve")this[e]=i;else throw new Error("Envelope: invalid curve: "+i)}get attackCurve(){return this._getCurve(this._attackCurve,"In")}set attackCurve(e){this._setCurve("_attackCurve","In",e)}get releaseCurve(){return this._getCurve(this._releaseCurve,"Out")}set releaseCurve(e){this._setCurve("_releaseCurve","Out",e)}get decayCurve(){return this._getCurve(this._decayCurve,"Out")}set decayCurve(e){this._setCurve("_decayCurve","Out",e)}triggerAttack(e,n=1){this.log("triggerAttack",e,n),e=this.toSeconds(e);let r=this.toSeconds(this.attack);const s=this.toSeconds(this.decay),a=this.getValueAtTime(e);if(a>0){const o=1/r;r=(1-a)/o}if(r<this.sampleTime)this._sig.cancelScheduledValues(e),this._sig.setValueAtTime(n,e);else if(this._attackCurve==="linear")this._sig.linearRampTo(n,r,e);else if(this._attackCurve==="exponential")this._sig.targetRampTo(n,r,e);else{this._sig.cancelAndHoldAtTime(e);let o=this._attackCurve;for(let c=1;c<o.length;c++)if(o[c-1]<=a&&a<=o[c]){o=this._attackCurve.slice(c),o[0]=a;break}this._sig.setValueCurveAtTime(o,e,r,n)}if(s&&this.sustain<1){const o=n*this.sustain,c=e+r;this.log("decay",c),this._decayCurve==="linear"?this._sig.linearRampToValueAtTime(o,s+c):this._sig.exponentialApproachValueAtTime(o,c,s)}return this}triggerRelease(e){this.log("triggerRelease",e),e=this.toSeconds(e);const n=this.getValueAtTime(e);if(n>0){const i=this.toSeconds(this.release);i<this.sampleTime?this._sig.setValueAtTime(0,e):this._releaseCurve==="linear"?this._sig.linearRampTo(0,i,e):this._releaseCurve==="exponential"?this._sig.targetRampTo(0,i,e):(Ai(nf(this._releaseCurve),"releaseCurve must be either 'linear', 'exponential' or an array"),this._sig.cancelAndHoldAtTime(e),this._sig.setValueCurveAtTime(this._releaseCurve,e,i,n))}return this}getValueAtTime(e){return this._sig.getValueAtTime(e)}triggerAttackRelease(e,n,i=1){return n=this.toSeconds(n),this.triggerAttack(n,i),this.triggerRelease(n+this.toSeconds(e)),this}cancel(e){return this._sig.cancelScheduledValues(this.toSeconds(e)),this}connect(e,n=0,i=0){return e8(this,e,n,i),this}asArray(){return Qa(this,arguments,void 0,function*(e=1024){const n=e/this.context.sampleRate,i=new Jz(1,n,this.context.sampleRate),r=this.toSeconds(this.attack)+this.toSeconds(this.decay),s=r+this.toSeconds(this.release),a=s*.1,o=s+a,c=new this.constructor(Object.assign(this.get(),{attack:n*this.toSeconds(this.attack)/o,decay:n*this.toSeconds(this.decay)/o,release:n*this.toSeconds(this.release)/o,context:i}));return c._sig.toDestination(),c.triggerAttackRelease(n*(r+a)/o,0),(yield i.render()).getChannelData(0)})}dispose(){return super.dispose(),this._sig.dispose(),this}}ca([j_(0)],V_.prototype,"attack",void 0);ca([j_(0)],V_.prototype,"decay",void 0);ca([Bbe(0,1)],V_.prototype,"sustain",void 0);ca([j_(0)],V_.prototype,"release",void 0);const zP=(()=>{let e,n;const i=[];for(e=0;e<128;e++)i[e]=Math.sin(e/127*(Math.PI/2));const r=[],s=6.4;for(e=0;e<127;e++){n=e/127;const f=Math.sin(n*(Math.PI*2)*s-Math.PI/2)+1;r[e]=f/10+n*.83}r[127]=1;const a=[],o=5;for(e=0;e<128;e++)a[e]=Math.ceil(e/127*o)/o;const c=[];for(e=0;e<128;e++)n=e/127,c[e]=.5*(1-Math.cos(Math.PI*n));const l=[];for(e=0;e<128;e++){n=e/127;const f=Math.pow(n,3)*4+.2,d=Math.cos(f*Math.PI*2*n);l[e]=Math.abs(d*(1-n))}function u(f){const d=new Array(f.length);for(let p=0;p<f.length;p++)d[p]=1-f[p];return d}function h(f){return f.slice(0).reverse()}return{bounce:{In:u(l),Out:l},cosine:{In:i,Out:h(i)},exponential:"exponential",linear:"linear",ripple:{In:r,Out:u(r)},sine:{In:c,Out:u(c)},step:{In:a,Out:u(a)}}})();class l0 extends Gn{constructor(){const e=Pn(l0.getDefaults(),arguments);super(e),this._scheduledEvents=[],this._synced=!1,this._original_triggerAttack=this.triggerAttack,this._original_triggerRelease=this.triggerRelease,this._syncedRelease=n=>this._original_triggerRelease(n),this._volume=this.output=new Pg({context:this.context,volume:e.volume}),this.volume=this._volume.volume,Ar(this,"volume")}static getDefaults(){return Object.assign(Gn.getDefaults(),{volume:0})}sync(){return this._syncState()&&(this._syncMethod("triggerAttack",1),this._syncMethod("triggerRelease",0),this.context.transport.on("stop",this._syncedRelease),this.context.transport.on("pause",this._syncedRelease),this.context.transport.on("loopEnd",this._syncedRelease)),this}_syncState(){let e=!1;return this._synced||(this._synced=!0,e=!0),e}_syncMethod(e,n){const i=this["_original_"+e]=this[e];this[e]=(...r)=>{const s=r[n],a=this.context.transport.schedule(o=>{r[n]=o,i.apply(this,r)},s);this._scheduledEvents.push(a)}}unsync(){return this._scheduledEvents.forEach(e=>this.context.transport.clear(e)),this._scheduledEvents=[],this._synced&&(this._synced=!1,this.triggerAttack=this._original_triggerAttack,this.triggerRelease=this._original_triggerRelease,this.context.transport.off("stop",this._syncedRelease),this.context.transport.off("pause",this._syncedRelease),this.context.transport.off("loopEnd",this._syncedRelease)),this}triggerAttackRelease(e,n,i,r){const s=this.toSeconds(i),a=this.toSeconds(n);return this.triggerAttack(e,s,r),this.triggerRelease(s+a),this}dispose(){return super.dispose(),this._volume.dispose(),this.unsync(),this._scheduledEvents=[],this}}class h1 extends l0{constructor(){const e=Pn(h1.getDefaults(),arguments);super(e),this.portamento=e.portamento,this.onsilence=e.onsilence}static getDefaults(){return Object.assign(l0.getDefaults(),{detune:0,onsilence:Ts,portamento:0})}triggerAttack(e,n,i=1){this.log("triggerAttack",e,n,i);const r=this.toSeconds(n);return this._triggerEnvelopeAttack(r,i),this.setNote(e,r),this}triggerRelease(e){this.log("triggerRelease",e);const n=this.toSeconds(e);return this._triggerEnvelopeRelease(n),this}setNote(e,n){const i=this.toSeconds(n),r=e instanceof Jh?e.toFrequency():e;if(this.portamento>0&&this.getLevelAtTime(i)>.05){const s=this.toSeconds(this.portamento);this.frequency.exponentialRampTo(r,s,i)}else this.frequency.setValueAtTime(r,i);return this}}ca([j_(0)],h1.prototype,"portamento",void 0);class o8 extends V_{constructor(){super(Pn(o8.getDefaults(),arguments,["attack","decay","sustain","release"])),this.name="AmplitudeEnvelope",this._gainNode=new yr({context:this.context,gain:0}),this.output=this._gainNode,this.input=this._gainNode,this._sig.connect(this._gainNode.gain),this.output=this._gainNode,this.input=this._gainNode}dispose(){return super.dispose(),this._gainNode.dispose(),this}}class Ju extends h1{constructor(){const e=Pn(Ju.getDefaults(),arguments);super(e),this.name="Synth",this.oscillator=new V3(Object.assign({context:this.context,detune:e.detune,onstop:()=>this.onsilence(this)},e.oscillator)),this.frequency=this.oscillator.frequency,this.detune=this.oscillator.detune,this.envelope=new o8(Object.assign({context:this.context},e.envelope)),this.oscillator.chain(this.envelope,this.output),Ar(this,["oscillator","frequency","detune","envelope"])}static getDefaults(){return Object.assign(h1.getDefaults(),{envelope:Object.assign(kN(V_.getDefaults(),Object.keys(Gn.getDefaults())),{attack:.005,decay:.1,release:1,sustain:.3}),oscillator:Object.assign(kN(V3.getDefaults(),[...Object.keys(bu.getDefaults()),"frequency","detune"]),{type:"triangle"})})}_triggerEnvelopeAttack(e,n){if(this.envelope.triggerAttack(e,n),this.oscillator.start(e),this.envelope.sustain===0){const i=this.toSeconds(this.envelope.attack),r=this.toSeconds(this.envelope.decay);this.oscillator.stop(e+i+r)}}_triggerEnvelopeRelease(e){this.envelope.triggerRelease(e),this.oscillator.stop(e+this.toSeconds(this.envelope.release))}getLevelAtTime(e){return e=this.toSeconds(e),this.envelope.getValueAtTime(e)}dispose(){return super.dispose(),this.oscillator.dispose(),this.envelope.dispose(),this}}class G3 extends Gn{constructor(){const e=Pn(G3.getDefaults(),arguments,["frequency","type"]);super(e),this.name="BiquadFilter",this._filter=this.context.createBiquadFilter(),this.input=this.output=this._filter,this.Q=new mr({context:this.context,units:"number",value:e.Q,param:this._filter.Q}),this.frequency=new mr({context:this.context,units:"frequency",value:e.frequency,param:this._filter.frequency}),this.detune=new mr({context:this.context,units:"cents",value:e.detune,param:this._filter.detune}),this.gain=new mr({context:this.context,units:"decibels",convert:!1,value:e.gain,param:this._filter.gain}),this.type=e.type}static getDefaults(){return Object.assign(Gn.getDefaults(),{Q:1,type:"lowpass",frequency:350,detune:0,gain:0})}get type(){return this._filter.type}set type(e){Ai(["lowpass","highpass","bandpass","lowshelf","highshelf","notch","allpass","peaking"].indexOf(e)!==-1,`Invalid filter type: ${e}`),this._filter.type=e}getFrequencyResponse(e=128){const n=new Float32Array(e);for(let a=0;a<e;a++){const c=Math.pow(a/e,2)*19980+20;n[a]=c}const i=new Float32Array(e),r=new Float32Array(e),s=this.context.createBiquadFilter();return s.type=this.type,s.Q.value=this.Q.value,s.frequency.value=this.frequency.value,s.gain.value=this.gain.value,s.getFrequencyResponse(n,i,r),i}dispose(){return super.dispose(),this._filter.disconnect(),this.Q.dispose(),this.frequency.dispose(),this.gain.dispose(),this.detune.dispose(),this}}class Wd extends Gn{constructor(){const e=Pn(Wd.getDefaults(),arguments,["frequency","type","rolloff"]);super(e),this.name="Filter",this.input=new yr({context:this.context}),this.output=new yr({context:this.context}),this._filters=[],this._filters=[],this.Q=new cs({context:this.context,units:"positive",value:e.Q}),this.frequency=new cs({context:this.context,units:"frequency",value:e.frequency}),this.detune=new cs({context:this.context,units:"cents",value:e.detune}),this.gain=new cs({context:this.context,units:"decibels",convert:!1,value:e.gain}),this._type=e.type,this.rolloff=e.rolloff,Ar(this,["detune","frequency","gain","Q"])}static getDefaults(){return Object.assign(Gn.getDefaults(),{Q:1,detune:0,frequency:350,gain:0,rolloff:-12,type:"lowpass"})}get type(){return this._type}set type(e){Ai(["lowpass","highpass","bandpass","lowshelf","highshelf","notch","allpass","peaking"].indexOf(e)!==-1,`Invalid filter type: ${e}`),this._type=e,this._filters.forEach(i=>i.type=e)}get rolloff(){return this._rolloff}set rolloff(e){const n=ym(e)?e:parseInt(e,10),i=[-12,-24,-48,-96];let r=i.indexOf(n);Ai(r!==-1,`rolloff can only be ${i.join(", ")}`),r+=1,this._rolloff=n,this.input.disconnect(),this._filters.forEach(s=>s.disconnect()),this._filters=new Array(r);for(let s=0;s<r;s++){const a=new G3({context:this.context});a.type=this._type,this.frequency.connect(a.frequency),this.detune.connect(a.detune),this.Q.connect(a.Q),this.gain.connect(a.gain),this._filters[s]=a}this._internalChannels=this._filters,c1(this.input,...this._internalChannels,this.output)}getFrequencyResponse(e=128){const n=new G3({context:this.context,frequency:this.frequency.value,gain:this.gain.value,Q:this.Q.value,type:this._type,detune:this.detune.value}),i=new Float32Array(e).map(()=>1);return this._filters.forEach(()=>{n.getFrequencyResponse(e).forEach((s,a)=>i[a]*=s)}),n.dispose(),i}dispose(){return super.dispose(),this._filters.forEach(e=>{e.dispose()}),wk(this,["detune","frequency","gain","Q"]),this.frequency.dispose(),this.Q.dispose(),this.detune.dispose(),this.gain.dispose(),this}}class Ok extends Ju{constructor(){const e=Pn(Ok.getDefaults(),arguments);super(e),this.name="MembraneSynth",this.portamento=0,this.pitchDecay=e.pitchDecay,this.octaves=e.octaves,Ar(this,["oscillator","envelope"])}static getDefaults(){return AT(h1.getDefaults(),Ju.getDefaults(),{envelope:{attack:.001,attackCurve:"exponential",decay:.4,release:1.4,sustain:.01},octaves:10,oscillator:{type:"sine"},pitchDecay:.05})}setNote(e,n){const i=this.toSeconds(n),r=this.toFrequency(e instanceof Jh?e.toFrequency():e),s=r*this.octaves;return this.oscillator.frequency.setValueAtTime(s,i),this.oscillator.frequency.exponentialRampToValueAtTime(r,i+this.toSeconds(this.pitchDecay)),this}dispose(){return super.dispose(),this}}ca([Bbe(0)],Ok.prototype,"octaves",void 0);ca([j_(0)],Ok.prototype,"pitchDecay",void 0);class Pw extends l0{constructor(){const e=Pn(Pw.getDefaults(),arguments);super(e),this.name="NoiseSynth",this.noise=new fA(Object.assign({context:this.context},e.noise)),this.envelope=new o8(Object.assign({context:this.context},e.envelope)),this.noise.chain(this.envelope,this.output)}static getDefaults(){return Object.assign(l0.getDefaults(),{envelope:Object.assign(kN(V_.getDefaults(),Object.keys(Gn.getDefaults())),{decay:.1,sustain:0}),noise:Object.assign(kN(fA.getDefaults(),Object.keys(bu.getDefaults())),{type:"white"})})}triggerAttack(e,n=1){return e=this.toSeconds(e),this.envelope.triggerAttack(e,n),this.noise.start(e),this.envelope.sustain===0&&this.noise.stop(e+this.toSeconds(this.envelope.attack)+this.toSeconds(this.envelope.decay)),this}triggerRelease(e){return e=this.toSeconds(e),this.envelope.triggerRelease(e),this.noise.stop(e+this.toSeconds(this.envelope.release)),this}sync(){return this._syncState()&&(this._syncMethod("triggerAttack",0),this._syncMethod("triggerRelease",0)),this}triggerAttackRelease(e,n,i=1){return n=this.toSeconds(n),e=this.toSeconds(e),this.triggerAttack(n,i),this.triggerRelease(n+e),this}dispose(){return super.dispose(),this.noise.dispose(),this.envelope.dispose(),this}}const Fbe=new Set;function aK(t){Fbe.add(t)}function zbe(t,e){const n=`registerProcessor("${t}", ${e})`;Fbe.add(n)}const x0t=`
	/**
	 * The base AudioWorkletProcessor for use in Tone.js. Works with the {@link ToneAudioWorklet}. 
	 */
	class ToneAudioWorkletProcessor extends AudioWorkletProcessor {

		constructor(options) {
			
			super(options);
			/**
			 * If the processor was disposed or not. Keep alive until it's disposed.
			 */
			this.disposed = false;
		   	/** 
			 * The number of samples in the processing block
			 */
			this.blockSize = 128;
			/**
			 * the sample rate
			 */
			this.sampleRate = sampleRate;

			this.port.onmessage = (event) => {
				// when it receives a dispose 
				if (event.data === "dispose") {
					this.disposed = true;
				}
			};
		}
	}
`;aK(x0t);const w0t=`
	/**
	 * Abstract class for a single input/output processor. 
	 * has a 'generate' function which processes one sample at a time
	 */
	class SingleIOProcessor extends ToneAudioWorkletProcessor {

		constructor(options) {
			super(Object.assign(options, {
				numberOfInputs: 1,
				numberOfOutputs: 1
			}));
			/**
			 * Holds the name of the parameter and a single value of that
			 * parameter at the current sample
			 * @type { [name: string]: number }
			 */
			this.params = {}
		}

		/**
		 * Generate an output sample from the input sample and parameters
		 * @abstract
		 * @param input number
		 * @param channel number
		 * @param parameters { [name: string]: number }
		 * @returns number
		 */
		generate(){}

		/**
		 * Update the private params object with the 
		 * values of the parameters at the given index
		 * @param parameters { [name: string]: Float32Array },
		 * @param index number
		 */
		updateParams(parameters, index) {
			for (const paramName in parameters) {
				const param = parameters[paramName];
				if (param.length > 1) {
					this.params[paramName] = parameters[paramName][index];
				} else {
					this.params[paramName] = parameters[paramName][0];
				}
			}
		}

		/**
		 * Process a single frame of the audio
		 * @param inputs Float32Array[][]
		 * @param outputs Float32Array[][]
		 */
		process(inputs, outputs, parameters) {
			const input = inputs[0];
			const output = outputs[0];
			// get the parameter values
			const channelCount = Math.max(input && input.length || 0, output.length);
			for (let sample = 0; sample < this.blockSize; sample++) {
				this.updateParams(parameters, sample);
				for (let channel = 0; channel < channelCount; channel++) {
					const inputSample = input && input.length ? input[channel][sample] : 0;
					output[channel][sample] = this.generate(inputSample, channel, this.params);
				}
			}
			return !this.disposed;
		}
	};
`;aK(w0t);const C0t=`
	/**
	 * A multichannel buffer for use within an AudioWorkletProcessor as a delay line
	 */
	class DelayLine {
		
		constructor(size, channels) {
			this.buffer = [];
			this.writeHead = []
			this.size = size;

			// create the empty channels
			for (let i = 0; i < channels; i++) {
				this.buffer[i] = new Float32Array(this.size);
				this.writeHead[i] = 0;
			}
		}

		/**
		 * Push a value onto the end
		 * @param channel number
		 * @param value number
		 */
		push(channel, value) {
			this.writeHead[channel] += 1;
			if (this.writeHead[channel] > this.size) {
				this.writeHead[channel] = 0;
			}
			this.buffer[channel][this.writeHead[channel]] = value;
		}

		/**
		 * Get the recorded value of the channel given the delay
		 * @param channel number
		 * @param delay number delay samples
		 */
		get(channel, delay) {
			let readHead = this.writeHead[channel] - Math.floor(delay);
			if (readHead < 0) {
				readHead += this.size;
			}
			return this.buffer[channel][readHead];
		}
	}
`;aK(C0t);const A0t="feedback-comb-filter",R0t=`
	class FeedbackCombFilterWorklet extends SingleIOProcessor {

		constructor(options) {
			super(options);
			this.delayLine = new DelayLine(this.sampleRate, options.channelCount || 2);
		}

		static get parameterDescriptors() {
			return [{
				name: "delayTime",
				defaultValue: 0.1,
				minValue: 0,
				maxValue: 1,
				automationRate: "k-rate"
			}, {
				name: "feedback",
				defaultValue: 0.5,
				minValue: 0,
				maxValue: 0.9999,
				automationRate: "k-rate"
			}];
		}

		generate(input, channel, parameters) {
			const delayedSample = this.delayLine.get(channel, parameters.delayTime * this.sampleRate);
			this.delayLine.push(channel, input + delayedSample * parameters.feedback);
			return delayedSample;
		}
	}
`;zbe(A0t,R0t);class q3 extends l0{constructor(){const e=Pn(q3.getDefaults(),arguments,["voice","options"]);super(e),this.name="PolySynth",this._availableVoices=[],this._activeVoices=[],this._voices=[],this._gcTimeout=-1,this._averageActiveVoices=0,this._syncedRelease=r=>this.releaseAll(r),Ai(!ym(e.voice),"DEPRECATED: The polyphony count is no longer the first argument.");const n=e.voice.getDefaults();this.options=Object.assign(n,e.options),this.voice=e.voice,this.maxPolyphony=e.maxPolyphony,this._dummyVoice=this._getNextAvailableVoice();const i=this._voices.indexOf(this._dummyVoice);this._voices.splice(i,1),this._gcTimeout=this.context.setInterval(this._collectGarbage.bind(this),1)}static getDefaults(){return Object.assign(l0.getDefaults(),{maxPolyphony:32,options:{},voice:Ju})}get activeVoices(){return this._activeVoices.length}_makeVoiceAvailable(e){this._availableVoices.push(e);const n=this._activeVoices.findIndex(i=>i.voice===e);this._activeVoices.splice(n,1)}_getNextAvailableVoice(){if(this._availableVoices.length)return this._availableVoices.shift();if(this._voices.length<this.maxPolyphony){const e=new this.voice(Object.assign(this.options,{context:this.context,onsilence:this._makeVoiceAvailable.bind(this)}));return Ai(e instanceof h1,"Voice must extend Monophonic class"),e.connect(this.output),this._voices.push(e),e}else Yz("Max polyphony exceeded. Note dropped.")}_collectGarbage(){if(this._averageActiveVoices=Math.max(this._averageActiveVoices*.95,this.activeVoices),this._availableVoices.length&&this._voices.length>Math.ceil(this._averageActiveVoices+1)){const e=this._availableVoices.shift(),n=this._voices.indexOf(e);this._voices.splice(n,1),this.context.isOffline||e.dispose()}}_triggerAttack(e,n,i){e.forEach(r=>{const s=new j3(this.context,r).toMidi(),a=this._getNextAvailableVoice();a&&(a.triggerAttack(r,n,i),this._activeVoices.push({midi:s,voice:a,released:!1}),this.log("triggerAttack",r,n))})}_triggerRelease(e,n){e.forEach(i=>{const r=new j3(this.context,i).toMidi(),s=this._activeVoices.find(({midi:a,released:o})=>a===r&&!o);s&&(s.voice.triggerRelease(n),s.released=!0,this.log("triggerRelease",i,n))})}_scheduleEvent(e,n,i,r){Ai(!this.disposed,"Synth was already disposed"),i<=this.now()?e==="attack"?this._triggerAttack(n,i,r):this._triggerRelease(n,i):this.context.setTimeout(()=>{this.disposed||this._scheduleEvent(e,n,i,r)},i-this.now())}triggerAttack(e,n,i){Array.isArray(e)||(e=[e]);const r=this.toSeconds(n);return this._scheduleEvent("attack",e,r,i),this}triggerRelease(e,n){Array.isArray(e)||(e=[e]);const i=this.toSeconds(n);return this._scheduleEvent("release",e,i),this}triggerAttackRelease(e,n,i,r){const s=this.toSeconds(i);if(this.triggerAttack(e,s,r),nf(n)){Ai(nf(e),"If the duration is an array, the notes must also be an array"),e=e;for(let a=0;a<e.length;a++){const o=n[Math.min(a,n.length-1)],c=this.toSeconds(o);Ai(c>0,"The duration must be greater than 0"),this.triggerRelease(e[a],s+c)}}else{const a=this.toSeconds(n);Ai(a>0,"The duration must be greater than 0"),this.triggerRelease(e,s+a)}return this}sync(){return this._syncState()&&(this._syncMethod("triggerAttack",1),this._syncMethod("triggerRelease",1),this.context.transport.on("stop",this._syncedRelease),this.context.transport.on("pause",this._syncedRelease),this.context.transport.on("loopEnd",this._syncedRelease)),this}set(e){const n=kN(e,["onsilence","context"]);return this.options=AT(this.options,n),this._voices.forEach(i=>i.set(n)),this._dummyVoice.set(n),this}get(){return this._dummyVoice.get()}releaseAll(e){const n=this.toSeconds(e);return this._activeVoices.forEach(({voice:i})=>{i.triggerRelease(n)}),this}dispose(){return super.dispose(),this._dummyVoice.dispose(),this._voices.forEach(e=>e.dispose()),this._activeVoices=[],this._availableVoices=[],this.context.clearInterval(this._gcTimeout),this}}class Nk extends l0{constructor(){const e=Pn(Nk.getDefaults(),arguments,["urls","onload","baseUrl"],"urls");super(e),this.name="Sampler",this._activeSources=new Map;const n={};Object.keys(e.urls).forEach(i=>{const r=parseInt(i,10);if(Ai(FP(i)||ym(r)&&isFinite(r),`url key is neither a note or midi pitch: ${i}`),FP(i)){const s=new Jh(this.context,i).toMidi();n[s]=e.urls[i]}else ym(r)&&isFinite(r)&&(n[r]=e.urls[r])}),this._buffers=new QX({urls:n,onload:e.onload,baseUrl:e.baseUrl,onerror:e.onerror}),this.attack=e.attack,this.release=e.release,this.curve=e.curve,this._buffers.loaded&&Promise.resolve().then(e.onload)}static getDefaults(){return Object.assign(l0.getDefaults(),{attack:0,baseUrl:"",curve:"exponential",onload:Ts,onerror:Ts,release:.1,urls:{}})}_findClosest(e){let i=0;for(;i<96;){if(this._buffers.has(e+i))return-i;if(this._buffers.has(e-i))return i;i++}throw new Error(`No available buffers for note: ${e}`)}triggerAttack(e,n,i=1){return this.log("triggerAttack",e,n,i),Array.isArray(e)||(e=[e]),e.forEach(r=>{const s=Dbe(new Jh(this.context,r).toFrequency()),a=Math.round(s),o=s-a,c=this._findClosest(a),l=a-c,u=this._buffers.get(l),h=kbe(c+o),f=new Ak({url:u,context:this.context,curve:this.curve,fadeIn:this.attack,fadeOut:this.release,playbackRate:h}).connect(this.output);f.start(n,0,u.duration/h,i),nf(this._activeSources.get(a))||this._activeSources.set(a,[]),this._activeSources.get(a).push(f),f.onended=()=>{if(this._activeSources&&this._activeSources.has(a)){const d=this._activeSources.get(a),p=d.indexOf(f);p!==-1&&d.splice(p,1)}}}),this}triggerRelease(e,n){return this.log("triggerRelease",e,n),Array.isArray(e)||(e=[e]),e.forEach(i=>{const r=new Jh(this.context,i).toMidi();if(this._activeSources.has(r)&&this._activeSources.get(r).length){const s=this._activeSources.get(r);n=this.toSeconds(n),s.forEach(a=>{a.stop(n)}),this._activeSources.set(r,[])}}),this}releaseAll(e){const n=this.toSeconds(e);return this._activeSources.forEach(i=>{for(;i.length;)i.shift().stop(n)}),this}sync(){return this._syncState()&&(this._syncMethod("triggerAttack",1),this._syncMethod("triggerRelease",1)),this}triggerAttackRelease(e,n,i,r=1){const s=this.toSeconds(i);return this.triggerAttack(e,s,r),nf(n)?(Ai(nf(e),"notes must be an array when duration is array"),e.forEach((a,o)=>{const c=n[Math.min(o,n.length-1)];this.triggerRelease(a,s+this.toSeconds(c))})):this.triggerRelease(e,s+this.toSeconds(n)),this}add(e,n,i){if(Ai(FP(e)||isFinite(e),`note must be a pitch or midi: ${e}`),FP(e)){const r=new Jh(this.context,e).toMidi();this._buffers.add(r,n,i)}else this._buffers.add(e,n,i);return this}get loaded(){return this._buffers.loaded}dispose(){return super.dispose(),this._buffers.dispose(),this._activeSources.forEach(e=>{e.forEach(n=>n.dispose())}),this._activeSources.clear(),this}}ca([j_(0)],Nk.prototype,"attack",void 0);ca([j_(0)],Nk.prototype,"release",void 0);class Lw extends _u{constructor(){const e=Pn(Lw.getDefaults(),arguments,["callback","value"]);super(e),this.name="ToneEvent",this._state=new Ck("stopped"),this._startOffset=0,this._loop=e.loop,this.callback=e.callback,this.value=e.value,this._loopStart=this.toTicks(e.loopStart),this._loopEnd=this.toTicks(e.loopEnd),this._playbackRate=e.playbackRate,this._probability=e.probability,this._humanize=e.humanize,this.mute=e.mute,this._playbackRate=e.playbackRate,this._state.increasing=!0,this._rescheduleEvents()}static getDefaults(){return Object.assign(_u.getDefaults(),{callback:Ts,humanize:!1,loop:!1,loopEnd:"1m",loopStart:0,mute:!1,playbackRate:1,probability:1,value:null})}_rescheduleEvents(e=-1){this._state.forEachFrom(e,n=>{let i;if(n.state==="started"){n.id!==-1&&this.context.transport.clear(n.id);const r=n.time+Math.round(this.startOffset/this._playbackRate);if(this._loop===!0||ym(this._loop)&&this._loop>1){i=1/0,ym(this._loop)&&(i=this._loop*this._getLoopDuration());const s=this._state.getAfter(r);s!==null&&(i=Math.min(i,s.time-r)),i!==1/0&&(i=new Dc(this.context,i));const a=new Dc(this.context,this._getLoopDuration());n.id=this.context.transport.scheduleRepeat(this._tick.bind(this),a,new Dc(this.context,r),i)}else n.id=this.context.transport.schedule(this._tick.bind(this),new Dc(this.context,r))}})}get state(){return this._state.getValueAtTime(this.context.transport.ticks)}get startOffset(){return this._startOffset}set startOffset(e){this._startOffset=e}get probability(){return this._probability}set probability(e){this._probability=e}get humanize(){return this._humanize}set humanize(e){this._humanize=e}start(e){const n=this.toTicks(e);return this._state.getValueAtTime(n)==="stopped"&&(this._state.add({id:-1,state:"started",time:n}),this._rescheduleEvents(n)),this}stop(e){this.cancel(e);const n=this.toTicks(e);if(this._state.getValueAtTime(n)==="started"){this._state.setStateAtTime("stopped",n,{id:-1});const i=this._state.getBefore(n);let r=n;i!==null&&(r=i.time),this._rescheduleEvents(r)}return this}cancel(e){e=Xg(e,-1/0);const n=this.toTicks(e);return this._state.forEachFrom(n,i=>{this.context.transport.clear(i.id)}),this._state.cancel(n),this}_tick(e){const n=this.context.transport.getTicksAtTime(e);if(!this.mute&&this._state.getValueAtTime(n)==="started"){if(this.probability<1&&Math.random()>this.probability)return;if(this.humanize){let i=.02;Tbe(this.humanize)||(i=this.toSeconds(this.humanize)),e+=(Math.random()*2-1)*i}this.callback(e,this.value)}}_getLoopDuration(){return(this._loopEnd-this._loopStart)/this._playbackRate}get loop(){return this._loop}set loop(e){this._loop=e,this._rescheduleEvents()}get playbackRate(){return this._playbackRate}set playbackRate(e){this._playbackRate=e,this._rescheduleEvents()}get loopEnd(){return new Dc(this.context,this._loopEnd).toSeconds()}set loopEnd(e){this._loopEnd=this.toTicks(e),this._loop&&this._rescheduleEvents()}get loopStart(){return new Dc(this.context,this._loopStart).toSeconds()}set loopStart(e){this._loopStart=this.toTicks(e),this._loop&&this._rescheduleEvents()}get progress(){if(this._loop){const e=this.context.transport.ticks,n=this._state.get(e);if(n!==null&&n.state==="started"){const i=this._getLoopDuration();return(e-n.time)%i/i}else return 0}else return 0}dispose(){return super.dispose(),this.cancel(),this._state.dispose(),this}}class $3 extends Lw{constructor(){const e=Pn($3.getDefaults(),arguments,["callback","events"]);super(e),this.name="Part",this._state=new Ck("stopped"),this._events=new Set,this._state.increasing=!0,e.events.forEach(n=>{nf(n)?this.add(n[0],n[1]):this.add(n)})}static getDefaults(){return Object.assign(Lw.getDefaults(),{events:[]})}start(e,n){const i=this.toTicks(e);if(this._state.getValueAtTime(i)!=="started"){n=Xg(n,this._loop?this._loopStart:0),this._loop?n=Xg(n,this._loopStart):n=Xg(n,0);const r=this.toTicks(n);this._state.add({id:-1,offset:r,state:"started",time:i}),this._forEach(s=>{this._startNote(s,i,r)})}return this}_startNote(e,n,i){n-=i,this._loop?e.startOffset>=this._loopStart&&e.startOffset<this._loopEnd?(e.startOffset<i&&(n+=this._getLoopDuration()),e.start(new Dc(this.context,n))):e.startOffset<this._loopStart&&e.startOffset>=i&&(e.loop=!1,e.start(new Dc(this.context,n))):e.startOffset>=i&&e.start(new Dc(this.context,n))}get startOffset(){return this._startOffset}set startOffset(e){this._startOffset=e,this._forEach(n=>{n.startOffset+=this._startOffset})}stop(e){const n=this.toTicks(e);return this._state.cancel(n),this._state.setStateAtTime("stopped",n),this._forEach(i=>{i.stop(e)}),this}at(e,n){const i=new cC(this.context,e).toTicks(),r=new Dc(this.context,1).toSeconds(),s=this._events.values();let a=s.next();for(;!a.done;){const o=a.value;if(Math.abs(i-o.startOffset)<r)return vr(n)&&(o.value=n),o;a=s.next()}return vr(n)?(this.add(e,n),this.at(e)):null}add(e,n){e instanceof Object&&Reflect.has(e,"time")&&(n=e,e=n.time);const i=this.toTicks(e);let r;return n instanceof Lw?(r=n,r.callback=this._tick.bind(this)):r=new Lw({callback:this._tick.bind(this),context:this.context,value:n}),r.startOffset=i,r.set({humanize:this.humanize,loop:this.loop,loopEnd:this.loopEnd,loopStart:this.loopStart,playbackRate:this.playbackRate,probability:this.probability}),this._events.add(r),this._restartEvent(r),this}_restartEvent(e){this._state.forEach(n=>{n.state==="started"?this._startNote(e,n.time,n.offset):e.stop(new Dc(this.context,n.time))})}remove(e,n){return zb(e)&&e.hasOwnProperty("time")&&(n=e,e=n.time),e=this.toTicks(e),this._events.forEach(i=>{i.startOffset===e&&(ad(n)||vr(n)&&i.value===n)&&(this._events.delete(i),i.dispose())}),this}clear(){return this._forEach(e=>e.dispose()),this._events.clear(),this}cancel(e){return this._forEach(n=>n.cancel(e)),this._state.cancel(this.toTicks(e)),this}_forEach(e){return this._events&&this._events.forEach(n=>{n instanceof $3?n._forEach(e):e(n)}),this}_setAll(e,n){this._forEach(i=>{i[e]=n})}_tick(e,n){this.mute||this.callback(e,n)}_testLoopBoundries(e){this._loop&&(e.startOffset<this._loopStart||e.startOffset>=this._loopEnd)?e.cancel(0):e.state==="stopped"&&this._restartEvent(e)}get probability(){return this._probability}set probability(e){this._probability=e,this._setAll("probability",e)}get humanize(){return this._humanize}set humanize(e){this._humanize=e,this._setAll("humanize",e)}get loop(){return this._loop}set loop(e){this._loop=e,this._forEach(n=>{n.loopStart=this.loopStart,n.loopEnd=this.loopEnd,n.loop=e,this._testLoopBoundries(n)})}get loopEnd(){return new Dc(this.context,this._loopEnd).toSeconds()}set loopEnd(e){this._loopEnd=this.toTicks(e),this._loop&&this._forEach(n=>{n.loopEnd=e,this._testLoopBoundries(n)})}get loopStart(){return new Dc(this.context,this._loopStart).toSeconds()}set loopStart(e){this._loopStart=this.toTicks(e),this._loop&&this._forEach(n=>{n.loopStart=this.loopStart,this._testLoopBoundries(n)})}get playbackRate(){return this._playbackRate}set playbackRate(e){this._playbackRate=e,this._setAll("playbackRate",e)}get length(){return this._events.size}dispose(){return super.dispose(),this.clear(),this}}class c8 extends Gn{constructor(){const e=Pn(c8.getDefaults(),arguments,["fade"]);super(e),this.name="CrossFade",this._panner=this.context.createStereoPanner(),this._split=this.context.createChannelSplitter(2),this._g2a=new T0t({context:this.context}),this.a=new yr({context:this.context,gain:0}),this.b=new yr({context:this.context,gain:0}),this.output=new yr({context:this.context}),this._internalChannels=[this.a,this.b],this.fade=new cs({context:this.context,units:"normalRange",value:e.fade}),Ar(this,"fade"),this.context.getConstant(1).connect(this._panner),this._panner.connect(this._split),this._panner.channelCount=1,this._panner.channelCountMode="explicit",Ep(this._split,this.a.gain,0),Ep(this._split,this.b.gain,1),this.fade.chain(this._g2a,this._panner.pan),this.a.connect(this.output),this.b.connect(this.output)}static getDefaults(){return Object.assign(Gn.getDefaults(),{fade:.5})}dispose(){return super.dispose(),this.a.dispose(),this.b.dispose(),this.output.dispose(),this.fade.dispose(),this._g2a.dispose(),this._panner.disconnect(),this._split.disconnect(),this}}let u0=class extends Gn{constructor(e){super(e),this.name="Effect",this._dryWet=new c8({context:this.context}),this.wet=this._dryWet.fade,this.effectSend=new yr({context:this.context}),this.effectReturn=new yr({context:this.context}),this.input=new yr({context:this.context}),this.output=this._dryWet,this.input.fan(this._dryWet.a,this.effectSend),this.effectReturn.connect(this._dryWet.b),this.wet.setValueAtTime(e.wet,0),this._internalChannels=[this.effectReturn,this.effectSend],Ar(this,"wet")}static getDefaults(){return Object.assign(Gn.getDefaults(),{wet:1})}connectEffect(e){return this._internalChannels.push(e),this.effectSend.chain(e,this.effectReturn),this}dispose(){return super.dispose(),this._dryWet.dispose(),this.effectSend.dispose(),this.effectReturn.dispose(),this.wet.dispose(),this}};class oK extends Gn{constructor(){const e=Pn(oK.getDefaults(),arguments,["pan"]);super(e),this.name="Panner",this._panner=this.context.createStereoPanner(),this.input=this._panner,this.output=this._panner,this.pan=new mr({context:this.context,param:this._panner.pan,value:e.pan,minValue:-1,maxValue:1}),this._panner.channelCount=e.channelCount,this._panner.channelCountMode="explicit",Ar(this,"pan")}static getDefaults(){return Object.assign(Gn.getDefaults(),{pan:0,channelCount:1})}dispose(){return super.dispose(),this._panner.disconnect(),this.pan.dispose(),this}}const M0t="bit-crusher",O0t=`
	class BitCrusherWorklet extends SingleIOProcessor {

		static get parameterDescriptors() {
			return [{
				name: "bits",
				defaultValue: 12,
				minValue: 1,
				maxValue: 16,
				automationRate: 'k-rate'
			}];
		}

		generate(input, _channel, parameters) {
			const step = Math.pow(0.5, parameters.bits - 1);
			const val = step * Math.floor(input / step + 0.5);
			return val;
		}
	}
`;zbe(M0t,O0t);class l8 extends Gn{constructor(){const e=Pn(l8.getDefaults(),arguments,["channels"]);super(e),this.name="Split",this._splitter=this.input=this.output=this.context.createChannelSplitter(e.channels),this._internalChannels=[this._splitter]}static getDefaults(){return Object.assign(Gn.getDefaults(),{channels:2})}dispose(){return super.dispose(),this._splitter.disconnect(),this}}class Ik extends Gn{constructor(){const e=Pn(Ik.getDefaults(),arguments,["channels"]);super(e),this.name="Merge",this._merger=this.output=this.input=this.context.createChannelMerger(e.channels)}static getDefaults(){return Object.assign(Gn.getDefaults(),{channels:2})}dispose(){return super.dispose(),this._merger.disconnect(),this}}class W3 extends Gn{constructor(e){super(e),this.name="StereoEffect",this.input=new yr({context:this.context}),this.input.channelCount=2,this.input.channelCountMode="explicit",this._dryWet=this.output=new c8({context:this.context,fade:e.wet}),this.wet=this._dryWet.fade,this._split=new l8({context:this.context,channels:2}),this._merge=new Ik({context:this.context,channels:2}),this.input.connect(this._split),this.input.connect(this._dryWet.a),this._merge.connect(this._dryWet.b),Ar(this,["wet"])}connectEffectLeft(...e){this._split.connect(e[0],0,0),c1(...e),Ep(e[e.length-1],this._merge,0,0)}connectEffectRight(...e){this._split.connect(e[0],1,0),c1(...e),Ep(e[e.length-1],this._merge,0,1)}static getDefaults(){return Object.assign(Gn.getDefaults(),{wet:1})}dispose(){return super.dispose(),this._dryWet.dispose(),this._split.dispose(),this._merge.dispose(),this}}class yse extends W3{constructor(e){super(e),this.feedback=new cs({context:this.context,value:e.feedback,units:"normalRange"}),this._feedbackL=new yr({context:this.context}),this._feedbackR=new yr({context:this.context}),this._feedbackSplit=new l8({context:this.context,channels:2}),this._feedbackMerge=new Ik({context:this.context,channels:2}),this._merge.connect(this._feedbackSplit),this._feedbackMerge.connect(this._split),this._feedbackSplit.connect(this._feedbackL,0,0),this._feedbackL.connect(this._feedbackMerge,0,0),this._feedbackSplit.connect(this._feedbackR,1,0),this._feedbackR.connect(this._feedbackMerge,0,1),this.feedback.fan(this._feedbackL.gain,this._feedbackR.gain),Ar(this,["feedback"])}static getDefaults(){return Object.assign(W3.getDefaults(),{feedback:.5})}dispose(){return super.dispose(),this.feedback.dispose(),this._feedbackL.dispose(),this._feedbackR.dispose(),this._feedbackSplit.dispose(),this._feedbackMerge.dispose(),this}}class cK extends yse{constructor(){const e=Pn(cK.getDefaults(),arguments,["frequency","delayTime","depth"]);super(e),this.name="Chorus",this._depth=e.depth,this._delayTime=e.delayTime/1e3,this._lfoL=new u1({context:this.context,frequency:e.frequency,min:0,max:1}),this._lfoR=new u1({context:this.context,frequency:e.frequency,min:0,max:1,phase:180}),this._delayNodeL=new hA({context:this.context}),this._delayNodeR=new hA({context:this.context}),this.frequency=this._lfoL.frequency,Ar(this,["frequency"]),this._lfoL.frequency.connect(this._lfoR.frequency),this.connectEffectLeft(this._delayNodeL),this.connectEffectRight(this._delayNodeR),this._lfoL.connect(this._delayNodeL.delayTime),this._lfoR.connect(this._delayNodeR.delayTime),this.depth=this._depth,this.type=e.type,this.spread=e.spread}static getDefaults(){return Object.assign(yse.getDefaults(),{frequency:1.5,delayTime:3.5,depth:.7,type:"sine",spread:180,feedback:0,wet:.5})}get depth(){return this._depth}set depth(e){this._depth=e;const n=this._delayTime*e;this._lfoL.min=Math.max(this._delayTime-n,0),this._lfoL.max=this._delayTime+n,this._lfoR.min=Math.max(this._delayTime-n,0),this._lfoR.max=this._delayTime+n}get delayTime(){return this._delayTime*1e3}set delayTime(e){this._delayTime=e/1e3,this.depth=this._depth}get type(){return this._lfoL.type}set type(e){this._lfoL.type=e,this._lfoR.type=e}get spread(){return this._lfoR.phase-this._lfoL.phase}set spread(e){this._lfoL.phase=90-e/2,this._lfoR.phase=e/2+90}start(e){return this._lfoL.start(e),this._lfoR.start(e),this}stop(e){return this._lfoL.stop(e),this._lfoR.stop(e),this}sync(){return this._lfoL.sync(),this._lfoR.sync(),this}unsync(){return this._lfoL.unsync(),this._lfoR.unsync(),this}dispose(){return super.dispose(),this._lfoL.dispose(),this._lfoR.dispose(),this._delayNodeL.dispose(),this._delayNodeR.dispose(),this.frequency.dispose(),this}}class DN extends u0{constructor(){const e=Pn(DN.getDefaults(),arguments,["distortion"]);super(e),this.name="Distortion",this._shaper=new L1({context:this.context,length:4096}),this._distortion=e.distortion,this.connectEffect(this._shaper),this.distortion=e.distortion,this.oversample=e.oversample}static getDefaults(){return Object.assign(u0.getDefaults(),{distortion:.4,oversample:"none"})}get distortion(){return this._distortion}set distortion(e){this._distortion=e;const n=e*100,i=Math.PI/180;this._shaper.setMap(r=>Math.abs(r)<.001?0:(3+n)*r*20*i/(Math.PI+n*Math.abs(r)))}get oversample(){return this._shaper.oversample}set oversample(e){this._shaper.oversample=e}dispose(){return super.dispose(),this._shaper.dispose(),this}}class bse extends u0{constructor(e){super(e),this.name="FeedbackEffect",this._feedbackGain=new yr({context:this.context,gain:e.feedback,units:"normalRange"}),this.feedback=this._feedbackGain.gain,Ar(this,"feedback"),this.effectReturn.chain(this._feedbackGain,this.effectSend)}static getDefaults(){return Object.assign(u0.getDefaults(),{feedback:.125})}dispose(){return super.dispose(),this._feedbackGain.dispose(),this.feedback.dispose(),this}}class u8 extends bse{constructor(){const e=Pn(u8.getDefaults(),arguments,["delayTime","feedback"]);super(e),this.name="FeedbackDelay",this._delayNode=new hA({context:this.context,delayTime:e.delayTime,maxDelay:e.maxDelay}),this.delayTime=this._delayNode.delayTime,this.connectEffect(this._delayNode),Ar(this,"delayTime")}static getDefaults(){return Object.assign(bse.getDefaults(),{delayTime:.25,maxDelay:1})}dispose(){return super.dispose(),this._delayNode.dispose(),this.delayTime.dispose(),this}}class lK extends W3{constructor(){const e=Pn(lK.getDefaults(),arguments,["frequency","octaves","baseFrequency"]);super(e),this.name="Phaser",this._lfoL=new u1({context:this.context,frequency:e.frequency,min:0,max:1}),this._lfoR=new u1({context:this.context,frequency:e.frequency,min:0,max:1,phase:180}),this._baseFrequency=this.toFrequency(e.baseFrequency),this._octaves=e.octaves,this.Q=new cs({context:this.context,value:e.Q,units:"positive"}),this._filtersL=this._makeFilters(e.stages,this._lfoL),this._filtersR=this._makeFilters(e.stages,this._lfoR),this.frequency=this._lfoL.frequency,this.frequency.value=e.frequency,this.connectEffectLeft(...this._filtersL),this.connectEffectRight(...this._filtersR),this._lfoL.frequency.connect(this._lfoR.frequency),this.baseFrequency=e.baseFrequency,this.octaves=e.octaves,this._lfoL.start(),this._lfoR.start(),Ar(this,["frequency","Q"])}static getDefaults(){return Object.assign(W3.getDefaults(),{frequency:.5,octaves:3,stages:10,Q:10,baseFrequency:350})}_makeFilters(e,n){const i=[];for(let r=0;r<e;r++){const s=this.context.createBiquadFilter();s.type="allpass",this.Q.connect(s.Q),n.connect(s.frequency),i.push(s)}return i}get octaves(){return this._octaves}set octaves(e){this._octaves=e;const n=this._baseFrequency*Math.pow(2,e);this._lfoL.max=n,this._lfoR.max=n}get baseFrequency(){return this._baseFrequency}set baseFrequency(e){this._baseFrequency=this.toFrequency(e),this._lfoL.min=this._baseFrequency,this._lfoR.min=this._baseFrequency,this.octaves=this._octaves}dispose(){return super.dispose(),this.Q.dispose(),this._lfoL.dispose(),this._lfoR.dispose(),this._filtersL.forEach(e=>e.disconnect()),this._filtersR.forEach(e=>e.disconnect()),this.frequency.dispose(),this}}class uK extends u0{constructor(){const e=Pn(uK.getDefaults(),arguments,["decay"]);super(e),this.name="Reverb",this._convolver=this.context.createConvolver(),this.ready=Promise.resolve();const n=this.toSeconds(e.decay);ap(n,.001),this._decay=n;const i=this.toSeconds(e.preDelay);ap(i,0),this._preDelay=i,this.generate(),this.connectEffect(this._convolver)}static getDefaults(){return Object.assign(u0.getDefaults(),{decay:1.5,preDelay:.01})}get decay(){return this._decay}set decay(e){e=this.toSeconds(e),ap(e,.001),this._decay=e,this.generate()}get preDelay(){return this._preDelay}set preDelay(e){e=this.toSeconds(e),ap(e,0),this._preDelay=e,this.generate()}generate(){return Qa(this,void 0,void 0,function*(){const e=this.ready,n=new Jz(2,this._decay+this._preDelay,this.context.sampleRate),i=new fA({context:n}),r=new fA({context:n}),s=new Ik({context:n});i.connect(s,0,0),r.connect(s,0,1);const a=new yr({context:n}).toDestination();s.connect(a),i.start(0),r.start(0),a.gain.setValueAtTime(0,0),a.gain.setValueAtTime(1,this._preDelay),a.gain.exponentialApproachValueAtTime(0,this._preDelay,this.decay);const o=n.render();return this.ready=o.then(Ts),yield e,this._convolver.buffer=(yield o).get(),this})}dispose(){return super.dispose(),this._convolver.disconnect(),this}}class hK extends u0{constructor(){const e=Pn(hK.getDefaults(),arguments,["frequency","depth"]);super(e),this.name="Vibrato",this._delayNode=new hA({context:this.context,delayTime:0,maxDelay:e.maxDelay}),this._lfo=new u1({context:this.context,type:e.type,min:0,max:e.maxDelay,frequency:e.frequency,phase:-90}).start().connect(this._delayNode.delayTime),this.frequency=this._lfo.frequency,this.depth=this._lfo.amplitude,this.depth.value=e.depth,Ar(this,["frequency","depth"]),this.effectSend.chain(this._delayNode,this.effectReturn)}static getDefaults(){return Object.assign(u0.getDefaults(),{maxDelay:.005,frequency:5,depth:.1,type:"sine"})}get type(){return this._lfo.type}set type(e){this._lfo.type=e}dispose(){return super.dispose(),this._delayNode.dispose(),this._lfo.dispose(),this.frequency.dispose(),this.depth.dispose(),this}}class oc extends Gn{constructor(){const e=Pn(oc.getDefaults(),arguments,["solo"]);super(e),this.name="Solo",this.input=this.output=new yr({context:this.context}),oc._allSolos.has(this.context)||oc._allSolos.set(this.context,new Set),oc._allSolos.get(this.context).add(this),this.solo=e.solo}static getDefaults(){return Object.assign(Gn.getDefaults(),{solo:!1})}get solo(){return this._isSoloed()}set solo(e){e?this._addSolo():this._removeSolo(),oc._allSolos.get(this.context).forEach(n=>n._updateSolo())}get muted(){return this.input.gain.value===0}_addSolo(){oc._soloed.has(this.context)||oc._soloed.set(this.context,new Set),oc._soloed.get(this.context).add(this)}_removeSolo(){oc._soloed.has(this.context)&&oc._soloed.get(this.context).delete(this)}_isSoloed(){return oc._soloed.has(this.context)&&oc._soloed.get(this.context).has(this)}_noSolos(){return!oc._soloed.has(this.context)||oc._soloed.has(this.context)&&oc._soloed.get(this.context).size===0}_updateSolo(){this._isSoloed()?this.input.gain.value=1:this._noSolos()?this.input.gain.value=1:this.input.gain.value=0}dispose(){return super.dispose(),oc._allSolos.get(this.context).delete(this),this._removeSolo(),this}}oc._allSolos=new Map;oc._soloed=new Map;class fK extends Gn{constructor(){const e=Pn(fK.getDefaults(),arguments,["pan","volume"]);super(e),this.name="PanVol",this._panner=this.input=new oK({context:this.context,pan:e.pan,channelCount:e.channelCount}),this.pan=this._panner.pan,this._volume=this.output=new Pg({context:this.context,volume:e.volume}),this.volume=this._volume.volume,this._panner.connect(this._volume),this.mute=e.mute,Ar(this,["pan","volume"])}static getDefaults(){return Object.assign(Gn.getDefaults(),{mute:!1,pan:0,volume:0,channelCount:1})}get mute(){return this._volume.mute}set mute(e){this._volume.mute=e}dispose(){return super.dispose(),this._panner.dispose(),this.pan.dispose(),this._volume.dispose(),this.volume.dispose(),this}}class Uw extends Gn{constructor(){const e=Pn(Uw.getDefaults(),arguments,["volume","pan"]);super(e),this.name="Channel",this._solo=this.input=new oc({solo:e.solo,context:this.context}),this._panVol=this.output=new fK({context:this.context,pan:e.pan,volume:e.volume,mute:e.mute,channelCount:e.channelCount}),this.pan=this._panVol.pan,this.volume=this._panVol.volume,this._solo.connect(this._panVol),Ar(this,["pan","volume"])}static getDefaults(){return Object.assign(Gn.getDefaults(),{pan:0,volume:0,mute:!1,solo:!1,channelCount:1})}get solo(){return this._solo.solo}set solo(e){this._solo.solo=e}get muted(){return this._solo.muted||this.mute}get mute(){return this._panVol.mute}set mute(e){this._panVol.mute=e}_getBus(e){return Uw.buses.has(e)||Uw.buses.set(e,new yr({context:this.context})),Uw.buses.get(e)}send(e,n=0){const i=this._getBus(e),r=new yr({context:this.context,units:"decibels",gain:n});return this.connect(r),r.connect(i),r}receive(e){return this._getBus(e).connect(this),this}dispose(){return super.dispose(),this._panVol.dispose(),this.pan.dispose(),this.volume.dispose(),this._solo.dispose(),this}}Uw.buses=new Map;class dK extends Gn{constructor(){const e=Pn(dK.getDefaults(),arguments,["lowFrequency","highFrequency"]);super(e),this.name="MultibandSplit",this.input=new yr({context:this.context}),this.output=void 0,this.low=new Wd({context:this.context,frequency:0,type:"lowpass"}),this._lowMidFilter=new Wd({context:this.context,frequency:0,type:"highpass"}),this.mid=new Wd({context:this.context,frequency:0,type:"lowpass"}),this.high=new Wd({context:this.context,frequency:0,type:"highpass"}),this._internalChannels=[this.low,this.mid,this.high],this.lowFrequency=new cs({context:this.context,units:"frequency",value:e.lowFrequency}),this.highFrequency=new cs({context:this.context,units:"frequency",value:e.highFrequency}),this.Q=new cs({context:this.context,units:"positive",value:e.Q}),this.input.fan(this.low,this.high),this.input.chain(this._lowMidFilter,this.mid),this.lowFrequency.fan(this.low.frequency,this._lowMidFilter.frequency),this.highFrequency.fan(this.mid.frequency,this.high.frequency),this.Q.connect(this.low.Q),this.Q.connect(this._lowMidFilter.Q),this.Q.connect(this.mid.Q),this.Q.connect(this.high.Q),Ar(this,["high","mid","low","highFrequency","lowFrequency"])}static getDefaults(){return Object.assign(Gn.getDefaults(),{Q:1,highFrequency:2500,lowFrequency:400})}dispose(){return super.dispose(),wk(this,["high","mid","low","highFrequency","lowFrequency"]),this.low.dispose(),this._lowMidFilter.dispose(),this.mid.dispose(),this.high.dispose(),this.lowFrequency.dispose(),this.highFrequency.dispose(),this.Q.dispose(),this}}class pK extends Gn{constructor(){const e=Pn(pK.getDefaults(),arguments,["threshold","ratio"]);super(e),this.name="Compressor",this._compressor=this.context.createDynamicsCompressor(),this.input=this._compressor,this.output=this._compressor,this.threshold=new mr({minValue:this._compressor.threshold.minValue,maxValue:this._compressor.threshold.maxValue,context:this.context,convert:!1,param:this._compressor.threshold,units:"decibels",value:e.threshold}),this.attack=new mr({minValue:this._compressor.attack.minValue,maxValue:this._compressor.attack.maxValue,context:this.context,param:this._compressor.attack,units:"time",value:e.attack}),this.release=new mr({minValue:this._compressor.release.minValue,maxValue:this._compressor.release.maxValue,context:this.context,param:this._compressor.release,units:"time",value:e.release}),this.knee=new mr({minValue:this._compressor.knee.minValue,maxValue:this._compressor.knee.maxValue,context:this.context,convert:!1,param:this._compressor.knee,units:"decibels",value:e.knee}),this.ratio=new mr({minValue:this._compressor.ratio.minValue,maxValue:this._compressor.ratio.maxValue,context:this.context,convert:!1,param:this._compressor.ratio,units:"positive",value:e.ratio}),Ar(this,["knee","release","attack","ratio","threshold"])}static getDefaults(){return Object.assign(Gn.getDefaults(),{attack:.003,knee:30,ratio:12,release:.25,threshold:-24})}get reduction(){return this._compressor.reduction}dispose(){return super.dispose(),this._compressor.disconnect(),this.attack.dispose(),this.release.dispose(),this.threshold.dispose(),this.ratio.dispose(),this.knee.dispose(),this}}class mK extends Gn{constructor(){const e=Pn(mK.getDefaults(),arguments,["low","mid","high"]);super(e),this.name="EQ3",this.output=new yr({context:this.context}),this._internalChannels=[],this.input=this._multibandSplit=new dK({context:this.context,highFrequency:e.highFrequency,lowFrequency:e.lowFrequency}),this._lowGain=new yr({context:this.context,gain:e.low,units:"decibels"}),this._midGain=new yr({context:this.context,gain:e.mid,units:"decibels"}),this._highGain=new yr({context:this.context,gain:e.high,units:"decibels"}),this.low=this._lowGain.gain,this.mid=this._midGain.gain,this.high=this._highGain.gain,this.Q=this._multibandSplit.Q,this.lowFrequency=this._multibandSplit.lowFrequency,this.highFrequency=this._multibandSplit.highFrequency,this._multibandSplit.low.chain(this._lowGain,this.output),this._multibandSplit.mid.chain(this._midGain,this.output),this._multibandSplit.high.chain(this._highGain,this.output),Ar(this,["low","mid","high","lowFrequency","highFrequency"]),this._internalChannels=[this._multibandSplit]}static getDefaults(){return Object.assign(Gn.getDefaults(),{high:0,highFrequency:2500,low:0,lowFrequency:400,mid:0})}dispose(){return super.dispose(),wk(this,["low","mid","high","lowFrequency","highFrequency"]),this._multibandSplit.dispose(),this.lowFrequency.dispose(),this.highFrequency.dispose(),this._lowGain.dispose(),this._midGain.dispose(),this._highGain.dispose(),this.low.dispose(),this.mid.dispose(),this.high.dispose(),this.Q.dispose(),this}}hc().transport;function gK(){return hc().transport}hc().destination;hc().destination;function N0t(){return hc().destination}hc().listener;hc().draw;hc();const Ese=4,I0t={a:1,b:2,c:3,d:4,e:5,f:6,g:7,x:8,"#":9,"!":10,y:13,t:14,s:15,i:16,q:17,h:18,w:19,3:20,".":21,"+":11,"-":12,0:22,1:23,2:24,p:25,4:26,5:27,6:29,7:28,8:30,9:31};function k0t(t,e,n,i=!0){let r=e,s=3,a="32n",o="",c="";const l=[];function u(){c="",o="",r+=Mc(a).toSeconds()}function h(){c===null?(l.push([r,[t,a,c]]),u()):pn(c)?(l.push([r,[t,a,c]]),u()):c.startsWith("#")?(l.push([r,[t,a,c]]),u()):c!==""&&(l.push([r,[t,a,`${c}${o}${s}`]]),u())}if(On(n))c=n;else for(let f=0;f<n.length;++f){switch(n[f]){case 9:case 10:break;default:h();break}switch(n[f]){case 1:c="A";break;case 2:c="B";break;case 3:c="C";break;case 4:c="D";break;case 5:c="E";break;case 6:c="F";break;case 7:c="G";break;case 8:c=null;break;case 9:o+="#";break;case 10:o+="b";break;case 11:++s;break;case 12:--s;break;case 13:a="64n";break;case 14:a="32n";break;case 15:a="16n";break;case 16:a="8n";break;case 17:a="4n";break;case 18:a="2n";break;case 19:a="1n";break;case 20:a=a.replace("n","t");break;case 21:a+=".";break;case 22:c=0;break;case 23:c=1;break;case 24:c=2;break;case 25:c=3;break;case 26:c=4;break;case 27:c=5;break;case 29:c=6;break;case 28:c=7;break;case 30:c=8;break;case 31:c=9;break}}return h(),i&&l.push([r,[t,"8n",-1]]),l}function D0t(t){const e=[],n=t.split(";");for(let i=0;i<n.length;++i){const r=[],s=n[i];if(s.startsWith("#"))e.push(s);else{for(let a=0;a<s.length;++a){const o=I0t[s[a]];se(o)&&r.push(o)}e.push(r)}}return e}const P0t="data:text/javascript;base64,Ly8gQSBkb3duc2FtcGxpbmcvZGVncmFkaW5nIHByb2Nlc3NpbmcgZWZmZWN0Ci8vIFNhbXBsZSBhbmQgaG9sZHMgdGhlIHNpZ25hbCBiYXNlZCBvbiBhbiBpbmNyZW1lbnRpbmcgY291bnRlcgovLyB3cml0dGVuIGJ5IFRpbW8gSG9vZ2xhbmQsIChjKSAyMDIzLCB3d3cudGltb2hvb2dsYW5kLmNvbQovLwpjbGFzcyBTeW50aFdvcmtsZXRQcm9jZXNzb3IgZXh0ZW5kcyBBdWRpb1dvcmtsZXRQcm9jZXNzb3IgewogIHN0YXRpYyBnZXQgcGFyYW1ldGVyRGVzY3JpcHRvcnMoKSB7CiAgICByZXR1cm4gWwogICAgICB7CiAgICAgICAgbmFtZTogJ2Rvd24nLAogICAgICAgIGRlZmF1bHRWYWx1ZTogMSwKICAgICAgICBtaW5WYWx1ZTogMSwKICAgICAgICBtYXhWYWx1ZTogNTEyLAogICAgICB9LAogICAgXQogIH0KCiAgY29uc3RydWN0b3IoKSB7CiAgICBzdXBlcigpCiAgICAvLyB0aGUgZnJhbWUgY291bnRlcgogICAgdGhpcy5jb3VudCA9IDAKICAgIC8vIHNhbXBsZSBhbmQgaG9sZCB2YXJpYWJsZSBhcnJheQogICAgdGhpcy5zYWggPSBbXQogIH0KCiAgcHJvY2VzcyhpbnB1dHMsIG91dHB1dHMsIHBhcmFtZXRlcnMpIHsKICAgIGNvbnN0IGlucHV0ID0gaW5wdXRzWzBdCiAgICBjb25zdCBvdXRwdXQgPSBvdXRwdXRzWzBdCgogICAgLy8gaWYgdGhlcmUgaXMgYW55dGhpbmcgdG8gcHJvY2VzcwogICAgaWYgKGlucHV0Lmxlbmd0aCA+IDApIHsKICAgICAgLy8gZm9yIHRoZSBsZW5ndGggb2YgdGhlIHNhbXBsZSBhcnJheSAoZ2VuZXJhbGx5IDEyOCkKICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBpbnB1dFswXS5sZW5ndGg7IGkrKykgewogICAgICAgIC8vIGZvciBldmVyeSBjaGFubmVsCiAgICAgICAgZm9yIChsZXQgY2hhbm5lbCA9IDA7IGNoYW5uZWwgPCBpbnB1dC5sZW5ndGg7ICsrY2hhbm5lbCkgewogICAgICAgICAgLy8gaWYgY291bnRlciBlcXVhbHMgMCwgc2FtcGxlIGFuZCBob2xkCiAgICAgICAgICBpZiAodGhpcy5jb3VudCAlIHBhcmFtZXRlcnMuZG93biA9PT0gMCkgewogICAgICAgICAgICB0aGlzLnNhaFtjaGFubmVsXSA9IGlucHV0W2NoYW5uZWxdW2ldCiAgICAgICAgICB9CiAgICAgICAgICAvLyBvdXRwdXQgdGhlIGN1cnJlbnRseSBoZWxkIHNhbXBsZQogICAgICAgICAgb3V0cHV0W2NoYW5uZWxdW2ldID0gdGhpcy5zYWhbY2hhbm5lbF0KICAgICAgICB9CiAgICAgICAgLy8gaW5jcmVtZW50IHNhbXBsZSBjb3VudGVyCiAgICAgICAgdGhpcy5jb3VudCsrCiAgICAgIH0KICAgIH0KICAgIHJldHVybiB0cnVlCiAgfQp9CgpyZWdpc3RlclByb2Nlc3Nvcignc3ludGh3b3JrbGV0cHJvY2Vzc29yJywgU3ludGhXb3JrbGV0UHJvY2Vzc29yKQo=";class vK extends u0{constructor(){const n=Pn(vK.getDefaults(),arguments,["rate"]);super(n);Qn(this,"name","FrequencyCrusher");Qn(this,"rate");Qn(this,"_audioworkletnode",this.context.createAudioWorkletNode("synthworkletprocessor"));this.rate=new mr({context:this.context,param:this._audioworkletnode.parameters.get("down"),value:n.rate,minValue:1,maxValue:512}),this.connectEffect(this._audioworkletnode)}static getDefaults(){return Object.assign(u0.getDefaults(),{rate:64})}dispose(){return super.dispose(),this._audioworkletnode.disconnect(),this}}async function L0t(){await hc().addAudioWorkletModule(P0t)}const h$=Mc("256n").toSeconds(),U0t=Mc("8n").toSeconds();function wj(){const t=new uK,e=fl(t.get()),n=new u8,i=fl(n.get()),r=new lK,s=fl(r.get()),a=new DN,o=fl(a.get()),c=new hK,l=fl(c.get()),u=new vK,h=fl(u.get());function f(){t.set({...e,wet:0}),n.set({...i,wet:0,delayTime:h$,maxDelay:"8n",feedback:.666}),r.set({...s,wet:0,frequency:4,octaves:3,baseFrequency:330}),a.set({...o,wet:0,distortion:.9,oversample:"2x"}),c.set({...l,wet:0,depth:.2}),u.set({...h,wet:0,rate:32})}return f(),{fc:u,echo:n,reverb:t,phaser:r,vibrato:c,distortion:a,applyreset:f,fcrush:u,distort:a}}var Ul=(t=>(t[t.SYNTH=0]="SYNTH",t[t.RETRO_NOISE=1]="RETRO_NOISE",t[t.BUZZ_NOISE=2]="BUZZ_NOISE",t[t.CLANG_NOISE=3]="CLANG_NOISE",t[t.METALLIC_NOISE=4]="METALLIC_NOISE",t))(Ul||{});const Sse=32768;function B0t(t){const e=hc().createBuffer(1,Sse,hc().sampleRate);let n=1;const i=e.getChannelData(0);for(let r=0;r<Sse;r++){t===4?i[r]=(n&1)*4*(Math.random()*14+1)-8:i[r]=(n&1)*2-1;let s=n>>1;if((n+s&1)==1)switch(t){default:case 1:s+=16384;break;case 3:s+=32768;break;case 2:s+=40;break;case 4:s+=60;break}n=s}return e}function Pv(t){let e,n;function i(){switch(e==null?void 0:e.type){case 0:{e.synth.set({...n,envelope:{...n.envelope,attack:.01,decay:.01,sustain:.5,release:.01},oscillator:{...n.oscillator,type:"square"}});break}case 1:e.synth.set({...n,release:"8n"})}}switch(t){case 0:return e={type:t,synth:new Ju},n=fl(e.synth.get()),i(),{source:e,applyreset:i};case 1:case 2:case 3:case 4:return e={type:t,synth:new Nk({volume:-12,attack:.001,release:.75,urls:{C4:B0t(t)}})},n=fl(e.synth.get()),i(),{source:e,applyreset:i}}}function Tse(t){return 20*Math.log10(t)-35}function F0t(){const t=N0t(),e=hc().createMediaStreamDestination(),n=new Pg(-4);n.connect(t),n.connect(e);const i=new pK({threshold:-24,ratio:4,attack:.003,release:.25,knee:30});i.connect(n);const r=new cK;r.set({wet:.22,depth:.777,delayTime:16}),r.connect(i);const s=new Pg;s.connect(r);const a=new Pg;a.connect(r);const o=new Pg;o.connect(r);const c=[Pv(Ul.SYNTH),Pv(Ul.SYNTH),Pv(Ul.SYNTH),Pv(Ul.SYNTH),Pv(Ul.SYNTH),Pv(Ul.SYNTH),Pv(Ul.SYNTH),Pv(Ul.SYNTH)],l=[wj(),wj(),wj()];function u($e){return $e<4?Math.floor($e/2):2}function h($e){const Ue=u($e);c[$e].source.synth.chain(l[Ue].fc,l[Ue].distortion,l[Ue].vibrato,l[Ue].phaser,l[Ue].echo,l[Ue].reverb,$e<4?s:a)}for(let $e=0;$e<c.length;++$e)h($e);function f($e,Ue){c[$e].source.type!==Ue&&(c[$e].source.synth.dispose(),c[$e]=Pv(Ue),h($e))}const d=new q3().connect(s);d.maxPolyphony=8,d.set({envelope:{attack:.001,decay:.001,sustain:.001,release:.1},oscillator:{type:"square"}});function p($e){d.triggerAttackRelease("C6","1i",$e)}const g=new Ju().connect(s);d.set({envelope:{attack:.001,decay:.001,sustain:.001,release:.1},oscillator:{type:"square"}});function y($e){const Ue=Mc("64n").toSeconds();g.triggerAttackRelease("C6","8n",$e),g.frequency.exponentialRampToValueAtTime("C11",Ue+$e)}const v=new Wd(350,"bandpass").connect(s),b=new yr().connect(v);b.gain.value=0;const T=new q3().connect(b);T.volume.value=16,T.maxPolyphony=8,T.set({envelope:{attack:.001,decay:.01,sustain:.1,release:.1},oscillator:{type:"square"}});function x($e,Ue){const qt=Mc("64n").toSeconds()+Mc($e).toSeconds();b.gain.setValueAtTime(.5,Ue),b.gain.exponentialRampToValueAtTime(.01,qt+Ue),T.triggerAttackRelease([800,540],$e,Ue)}const M=new mK(-10,10,-1).connect(s),R=new Wd(800,"highpass",-12);R.connect(M);const I=new Pw;I.set({envelope:{attack:.01,decay:.1,sustain:.1,release:.1}}),I.connect(R);function k($e,Ue){I.triggerAttackRelease($e,Ue)}const P=new DN().connect(s);P.set({distortion:.666});const U=new Ju;U.set({envelope:{attack:0,decay:.1,sustain:0,release:1},oscillator:{type:"triangle"}}),U.connect(P);const G=new Wd;G.set({type:"highpass",frequency:1e4}),G.connect(P);const $=new Pw;$.set({envelope:{attack:.01,decay:.1,sustain:0,release:.1}}),$.connect(G);function q($e,Ue){const qt=Mc("512n").toSeconds(),Ot=Mc("32n").toSeconds();U.triggerAttackRelease(1e4,$e,Ue,1),U.frequency.exponentialRampToValueAtTime(300,Ue+qt),U.frequency.exponentialRampToValueAtTime(100,Ue+Ot),$.triggerAttackRelease("8n",Ue,.333),$.volume.setValueAtTime(1,Ue),$.volume.exponentialRampToValueAtTime(0,Ue+Mc("32n").toSeconds())}const Y=new Wd;Y.set({type:"bandpass",frequency:256,Q:.17}),Y.connect(s);const ie=new Ju;ie.set({envelope:{attack:.001,decay:.001,sustain:.001,release:.1},oscillator:{type:"sawtooth"}}),ie.connect(Y);const V=new Ju;V.set({envelope:{attack:.001,decay:.1,sustain:.001,release:.1},oscillator:{type:"sine"}}),V.connect(Y);function J($e,Ue){ie.triggerAttackRelease(2e3,$e,Ue),ie.frequency.exponentialRampToValueAtTime(1e3,Ue+Mc("32n").toSeconds()),V.triggerAttackRelease(999,$e,Ue),V.frequency.exponentialRampToValueAtTime(888,Ue+Mc("256n").toSeconds())}const X=new DN().connect(s);X.set({distortion:.876});const ee=new Ju;ee.set({envelope:{attack:0,decay:.1,sustain:0,release:1},oscillator:{type:"triangle"}}),ee.connect(X);const oe=new Wd;oe.set({type:"highpass",frequency:1e4}),oe.connect(X);const fe=new Pw;fe.set({envelope:{attack:.01,decay:.1,sustain:.001,release:.1}}),fe.connect(oe);function Re($e,Ue){const qt=Mc("512n").toSeconds(),Ot=Mc("32n").toSeconds();ee.triggerAttackRelease(1e4,$e,Ue,1),ee.frequency.exponentialRampToValueAtTime(150,Ue+qt),ee.frequency.exponentialRampToValueAtTime(100,Ue+Ot),fe.triggerAttackRelease("8n",Ue,.25),fe.volume.setValueAtTime(1,Ue),fe.volume.exponentialRampToValueAtTime(0,Ue+Mc("32n").toSeconds())}const He=new Ju().connect(s);He.set({envelope:{attack:.01,decay:.1,sustain:.001,release:.1},oscillator:{type:"sawtooth"}});const Te=new Ju().connect(s);He.set({envelope:{attack:.01,decay:.1,sustain:.001,release:.1},oscillator:{type:"triangle"}});const Le=new Pw().connect(s);Le.set({envelope:{attack:.01,decay:.1,sustain:.001,release:.1}});function we($e,Ue){const qt=Mc("256n").toSeconds(),Ot=Mc($e).toSeconds()-qt;He.triggerAttackRelease("C4",Ot,Ue,1),He.frequency.exponentialRampToValueAtTime(gse("C0").toFrequency(),Ue+Ot),Te.triggerAttackRelease("C5",Ot,Ue,.5),Te.frequency.exponentialRampToValueAtTime(gse("C0").toFrequency(),Ue+Ot);const Yt=Mc("4n").toSeconds();Le.triggerAttackRelease("8n",Ue),Le.volume.setValueAtTime(1,Ue),Le.volume.exponentialRampToValueAtTime(0,Ue+Yt)}const Ce=new Wd;Ce.set({type:"bandpass",frequency:256,Q:.17}),Ce.connect(s);const ke=new Ju;ke.set({envelope:{attack:.001,decay:.001,sustain:.001,release:.1},oscillator:{type:"sawtooth"}}),ke.connect(Ce);const St=new Ju;St.set({envelope:{attack:.001,decay:.1,sustain:.001,release:.1},oscillator:{type:"sine"}}),St.connect(Ce);function Mt($e,Ue){ke.triggerAttackRelease(2e3,$e,Ue),ke.frequency.exponentialRampToValueAtTime(100,Ue+Mc("32n").toSeconds()),St.triggerAttackRelease(699,$e,Ue),St.frequency.exponentialRampToValueAtTime(399,Ue+Mc("256n").toSeconds())}const Ee=new Ok().connect(s);Ee.set({octaves:8});function _e($e){Ee.triggerAttackRelease("C1","8n",$e)}const tt=new $3(de);function de($e,Ue){if(Ue===null)return;const[qt,Ot,Yt]=Ue;if(On(Yt)&&se(c[qt])&&(Yt.startsWith("#")?CFe(je,"",Yt.slice(1)):c[qt].source.synth.triggerAttackRelease(Yt,Ot,$e)),pn(Yt))switch(Yt){case 0:p($e);break;case 1:y($e);break;case 2:x(Ot,$e);break;case 3:k(Ot,$e);break;case 4:q(Ot,$e);break;case 5:J(Ot,$e);break;case 6:Re(Ot,$e);break;case 7:we(Ot,$e);break;case 8:Mt(Ot,$e);break;case 9:_e($e);break;case-1:--rt,rt===0&&(tt.clear(),Ie=-1);break}}function Be($e,Ue,qt,Ot=!0){let Yt=Ue;const ce=k0t($e,Ue,qt,Ot),j=ce[ce.length-1];se(j)&&(Yt=Math.max(Yt,j[0]));for(let W=0;W<ce.length;++W){const[me,De]=ce[W];tt.add(me,De)}return Yt}let Ie=-1,rt=0,ft=Ese;function gt($e,Ue){const qt=D0t($e),Ot=gK().seconds+.1;if(Ue)for(let Yt=0;Yt<qt.length;++Yt)Be(ft++,Ot,qt[Yt],!1),ft>=c.length&&(ft=Ese);else{Ie===-1&&(Ie=Ot),rt+=qt.length;const Yt=Ie;for(let ce=0;ce<qt.length&&ce<c.length;++ce){const j=Be(ce,Yt,qt[ce]);Ie=Math.max(Ie,j)}}}tt.start(0);function bt(){tt.clear(),Ie=-1,rt=0}function be($e){s.volume.value=Tse($e)}function ue($e){a.volume.value=Tse($e)}function Xe($e){new Mk($e).connect(o).start(0)}function it($e){o.volume.value=$e}return it(100),be(45),ue(80),{broadcastdestination:e,addplay:gt,stopplay:bt,addttsaudiobuffer:Xe,setplayvolume:be,setbgplayvolume:ue,setttsvolume:it,SOURCE:c,FX:l,changesource:f}}const z0t=/(am|fm|fat)*(sine|square|triangle|sawtooth|custom)[0-9]+/,H0t=/(am|fm|fat)*(sine|square|triangle|sawtooth|custom)[0-9]*/;function j0t(t,e){if(On(t)){const n=si(t);if(z0t.test(n))return Li(e);switch(n){case"pwm":case"pulse":case"retro":case"buzz":case"clang":case"metallic":return!0;default:return H0t.test(n)}}return!1}function V0t(t,e,n,i,r){if(!se(e))return;const s=e.SOURCE[n];if(!se(s)){Ui(je,t,"synth",`unknown voice ${n}`);return}switch(i){case"reset":case"restart":s.applyreset();return;case"vol":case"volume":pn(r)&&(s.source.synth.volume.value=r);return;case"port":case"portamento":if(pn(r))switch(s.source.type){case Ul.SYNTH:s.source.synth.portamento=r;break;case Ul.RETRO_NOISE:Ui(je,t,"synth","portamento for retro synth not supported");break}return;case"env":case"envelope":if(Li(r)){const[a,o,c,l]=r;s.source.synth.set({envelope:{attack:a,decay:o,sustain:c,release:l}})}return;default:if(On(i)){if(j0t(i,r)){switch(i){case"retro":e.changesource(n,Ul.RETRO_NOISE);break;case"buzz":e.changesource(n,Ul.BUZZ_NOISE);break;case"clang":e.changesource(n,Ul.CLANG_NOISE);break;case"metallic":e.changesource(n,Ul.METALLIC_NOISE);break;default:e.changesource(n,Ul.SYNTH),s.source.synth.set({oscillator:{type:i}}),Li(r)&&s.source.synth.set({oscillator:{type:i,partials:r,partialCount:r.length}}),pn(r)&&s.source.synth.set({oscillator:{type:i,partials:[r],partialCount:1}});break}return}switch(s.source.type){case Ul.SYNTH:{switch(s.source.synth.get().oscillator.type){case"pwm":switch(i){case"modfreq":case"modulationfrequency":pn(r)&&s.source.synth.set({oscillator:{modulationFrequency:r}});return}break;case"pulse":switch(i){case"width":pn(r)&&s.source.synth.set({oscillator:{width:r}});return}break;case"custom":case"sine":case"square":case"triangle":case"sawtooth":switch(i){case"phase":pn(r)&&s.source.synth.set({oscillator:{phase:r}});return}break;case"amcustom":case"amsine":case"amsquare":case"amtriangle":case"amsawtooth":switch(i){case"harmonicity":pn(r)&&s.source.synth.set({oscillator:{harmonicity:r}});return;case"modtype":case"modulationtype":On(r)&&s.source.synth.set({oscillator:{modulationType:r}});return;case"modenv":case"modulationenvelope":if(Li(r)){const[o,c,l,u]=r;s.source.synth.set({oscillator:{modulationEnvelope:{attack:o,decay:c,sustain:l,release:u}}});return}break}break;case"fmcustom":case"fmsine":case"fmsquare":case"fmtriangle":case"fmsawtooth":switch(i){case"harmonicity":if(pn(r)){s.source.synth.set({oscillator:{harmonicity:r}});return}break;case"modindex":if(pn(r)){s.source.synth.set({oscillator:{modulationIndex:r}});return}break;case"modtype":if(On(r)){s.source.synth.set({oscillator:{modulationType:r}});return}break;case"modenv":if(Li(r)){const[o,c,l,u]=r;s.source.synth.set({oscillator:{modulationEnvelope:{attack:o,decay:c,sustain:l,release:u}}});return}break}break;case"fatcustom":case"fatsine":case"fatsquare":case"fattriangle":case"fatsawtooth":switch(i){case"count":if(pn(r)){s.source.synth.set({oscillator:{count:r}});return}break;case"phase":if(pn(r)){s.source.synth.set({oscillator:{phase:r}});return}break;case"spread":if(pn(r)){s.source.synth.set({oscillator:{spread:r}});return}break}break}return}}Ui(je,t,"synth",`unknown config ${i}`)}break}}function G0t(t,e,n,i,r){if(!se(e)||n<0||n>=e.FX.length){Ui(je,t,"synth",`index ${n} out of bounds`);return}const s=e.FX[n].distortion;switch(i){case"distortion":if(pn(r)){s.set({distortion:r});return}break;case"oversample":if(On(r)){s.set({oversample:r});return}break}Ui(je,t,"kind",`unknown distortion ${i} or ${r}`)}function q0t(t,e,n,i,r){if(!se(e)||n<0||n>=e.FX.length){Ui(je,t,"synth",`index ${n} out of bounds`);return}const s=e.FX[n].echo;switch(i){case"delaytime":if(pn(r)){s.set({delayTime:r});return}break;case"feedback":if(pn(r)){s.set({feedback:r});return}break}Ui(je,t,"kind",`unknown echo ${i} or ${r}`)}function $0t(t,e,n,i,r){if(!se(e)||n<0||n>=e.FX.length){Ui(je,t,"synth",`index ${n} out of bounds`);return}const s=e.FX[n].fcrush;switch(i){case"rate":if(pn(r)){s.set({rate:r});return}break}Ui(je,t,"kind",`unknown fcrush ${i} or ${r}`)}function W0t(t,e,n,i,r){if(!se(e)||n<0||n>=e.FX.length){Ui(je,t,"synth",`index ${n} out of bounds`);return}const s=e.FX[n].phaser;switch(i){case"q":if(pn(r)){s.set({Q:r});return}break;case"octaves":if(pn(r)){s.set({octaves:r});return}break;case"basefrequency":s.set({baseFrequency:r});return}Ui(je,t,"kind",`unknown phaser ${i} or ${r}`)}function Y0t(t,e,n,i,r){if(!se(e)||n<0||n>=e.FX.length){Ui(je,t,"synth",`index ${n} out of bounds`);return}const s=e.FX[n].reverb;switch(i){case"decay":if(pn(r)){s.set({decay:r});return}break;case"predelay":if(pn(r)){s.set({preDelay:r});return}break}Ui(je,t,"kind",`unknown reverb ${i} or ${r}`)}function X0t(t,e,n,i,r){if(!se(e))return;if(n<0||n>=e.FX.length){Ui(je,t,"synth",`index ${n} out of bounds`);return}const s=e.FX[n].vibrato;switch(i){case"maxdelay":if(pn(r)){s.set({maxDelay:r});return}break;case"depth":if(pn(r)){s.set({depth:r});return}break}Ui(je,t,"synth",`unknown vibrato config ${i} with ${r}`)}function K0t(t,e,n,i,r,s){if(!se(e))return;if(n<0||n>=e.FX.length){Ui(je,t,"synth",`index ${n} out of bounds`);return}const a=e.FX[n][i];if(se(a)){switch(r){case"on":a.wet.value=.2;break;case"off":a.wet.value=0;break;default:if(pn(r))a.wet.value=lr(.01*r,0,1);else switch(i){case"fc":case"fcrush":$0t(t,e,n,r,s);break;case"echo":q0t(t,e,n,r,s);break;case"phaser":W0t(t,e,n,r,s);break;case"reverb":Y0t(t,e,n,r,s);break;case"distort":case"distortion":G0t(t,e,n,r,s);break;case"vibrato":X0t(t,e,n,r,s);break}break}a instanceof u8&&(a.wet.value===0?a.set({delayTime:h$}):a.get().delayTime===h$&&a.set({delayTime:U0t}));return}Ui(je,t,"synth",`unknown fx ${i}`)}const Z0t="modulepreload",J0t=function(t){return"/"+t},xse={},f$=function(e,n,i){let r=Promise.resolve();if(n&&n.length>0){document.getElementsByTagName("link");const a=document.querySelector("meta[property=csp-nonce]"),o=(a==null?void 0:a.nonce)||(a==null?void 0:a.getAttribute("nonce"));r=Promise.allSettled(n.map(c=>{if(c=J0t(c),c in xse)return;xse[c]=!0;const l=c.endsWith(".css"),u=l?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${c}"]${u}`))return;const h=document.createElement("link");if(h.rel=l?"stylesheet":Z0t,l||(h.as="script"),h.crossOrigin="",h.href=c,o&&h.setAttribute("nonce",o),document.head.appendChild(h),l)return new Promise((f,d)=>{h.addEventListener("load",f),h.addEventListener("error",()=>d(new Error(`Unable to preload CSS for ${c}`)))})}))}function s(a){const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=a,window.dispatchEvent(o),!o.defaultPrevented)throw a}return r.then(a=>{for(const o of a||[])o.status==="rejected"&&s(o.reason);return e().catch(s)})};var Q0t=Object.defineProperty,evt=(t,e,n)=>e in t?Q0t(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,Wi=(t,e,n)=>(evt(t,typeof e!="symbol"?e+"":e,n),n),Hbe=(t,e,n)=>{if(!e.has(t))throw TypeError("Cannot "+n)},GR=(t,e,n)=>(Hbe(t,e,"read from private field"),n?n.call(t):e.get(t)),tvt=(t,e,n)=>{if(e.has(t))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(t):e.set(t,n)},nvt=(t,e,n,i)=>(Hbe(t,e,"write to private field"),e.set(t,n),n),jy,Cj=new Intl.Collator(0,{numeric:1}).compare;function jbe(t,e,n){return t=t.split("."),e=e.split("."),Cj(t[0],e[0])||Cj(t[1],e[1])||(e[2]=e.slice(2).join("."),n=/[.-]/.test(t[2]=t.slice(2).join(".")),n==/[.-]/.test(e[2])?Cj(t[2],e[2]):n?-1:1)}const ivt="host",Vbe="queue/data",rvt="queue/join",wse="upload",svt="login",avt="config",ovt="info",cvt="runtime",lvt="sleeptime",uvt="heartbeat",hvt="component_server",fvt="reset",dvt="cancel",pvt="https://gradio-space-api-fetcher-v2.hf.space/api",Gbe="This application is currently busy. Please try again. ",RT="Connection errored out. ",Qy="Could not resolve app config. ",mvt="Could not get space status. ",gvt="Could not get API info. ",_K="Space metadata could not be loaded. ",vvt="Invalid URL. A full URL path is required.",_vt="Not authorized to access this space. ",qbe="Invalid credentials. Could not login. ",yvt="Login credentials are required to access this space.",bvt="File system access is only available in Node.js environments",$be="Root URL not found in client config",Evt="Error uploading file";function Wbe(t,e,n){return e.startsWith("http://")||e.startsWith("https://")?n?t:e:t+e}async function Cse(t,e,n){try{return(await(await fetch(`https://huggingface.co/api/spaces/${t}/jwt`,{headers:{Authorization:`Bearer ${e}`,...n?{Cookie:n}:{}}})).json()).token||!1}catch{return!1}}function Svt(t){let e={};return t.forEach(({api_name:n,id:i})=>{n&&(e[n]=i)}),e}async function Tvt(t){var e;const n=this.options.hf_token?{Authorization:`Bearer ${this.options.hf_token}`}:{};if(n["Content-Type"]="application/json",typeof window<"u"&&window.gradio_config&&location.origin!=="http://localhost:9876"&&!window.gradio_config.dev_mode){const i=window.gradio_config.root,r=window.gradio_config;let s=Wbe(t,r.root,!1);return r.root=s,{...r,path:i}}else if(t){const i=Kbe(t,avt),r=await this.fetch(i,{headers:n,credentials:"include"});if((r==null?void 0:r.status)===401&&!this.options.auth)throw new Error(yvt);if((r==null?void 0:r.status)===401&&this.options.auth)throw new Error(qbe);if((r==null?void 0:r.status)===200){let s=await r.json();return s.path=s.path??"",s.root=t,(e=s.dependencies)==null||e.forEach((a,o)=>{a.id===void 0&&(a.id=o)}),s}else if((r==null?void 0:r.status)===401)throw new Error(_vt);throw new Error(Qy)}throw new Error(Qy)}async function xvt(){const{http_protocol:t,host:e}=await h8(this.app_reference,this.options.hf_token);try{if(this.options.auth){const n=await Ybe(t,e,this.options.auth,this.fetch,this.options.hf_token);n&&this.set_cookies(n)}}catch(n){throw Error(n.message)}}async function Ybe(t,e,n,i,r){const s=new FormData;s.append("username",n==null?void 0:n[0]),s.append("password",n==null?void 0:n[1]);let a={};r&&(a.Authorization=`Bearer ${r}`);const o=await i(`${t}//${e}/${svt}`,{headers:a,method:"POST",body:s,credentials:"include"});if(o.status===200)return o.headers.get("set-cookie");throw o.status===401?new Error(qbe):new Error(_K)}function Aj(t){if(t.startsWith("http")){const{protocol:e,host:n,pathname:i}=new URL(t);return{ws_protocol:e==="https:"?"wss":"ws",http_protocol:e,host:n+(i!=="/"?i:"")}}else if(t.startsWith("file:"))return{ws_protocol:"ws",http_protocol:"http:",host:"lite.local"};return{ws_protocol:"wss",http_protocol:"https:",host:new URL(t).host}}const Xbe=t=>{let e=[];return t.split(/,(?=\s*[^\s=;]+=[^\s=;]+)/).forEach(i=>{const[r,s]=i.split(";")[0].split("=");r&&s&&e.push(`${r.trim()}=${s.trim()}`)}),e},yK=/^[a-zA-Z0-9_\-\.]+\/[a-zA-Z0-9_\-\.]+$/,wvt=/.*hf\.space\/{0,1}.*$/;async function h8(t,e){const n={};e&&(n.Authorization=`Bearer ${e}`);const i=t.trim().replace(/\/$/,"");if(yK.test(i))try{const s=(await(await fetch(`https://huggingface.co/api/spaces/${i}/${ivt}`,{headers:n})).json()).host;return{space_id:t,...Aj(s)}}catch{throw new Error(_K)}if(wvt.test(i)){const{ws_protocol:r,http_protocol:s,host:a}=Aj(i);return{space_id:a.split("/")[0].replace(".hf.space",""),ws_protocol:r,http_protocol:s,host:a}}return{space_id:!1,...Aj(i)}}const Kbe=(...t)=>{try{return t.reduce((e,n)=>(e=e.replace(/\/+$/,""),n=n.replace(/^\/+/,""),new URL(n,e+"/").toString()))}catch{throw new Error(vvt)}};function Cvt(t,e,n){const i={named_endpoints:{},unnamed_endpoints:{}};return Object.keys(t).forEach(r=>{(r==="named_endpoints"||r==="unnamed_endpoints")&&(i[r]={},Object.entries(t[r]).forEach(([s,{parameters:a,returns:o}])=>{var c,l,u,h;const f=((c=e.dependencies.find(g=>g.api_name===s||g.api_name===s.replace("/","")))==null?void 0:c.id)||n[s.replace("/","")]||-1,d=f!==-1?(l=e.dependencies.find(g=>g.id==f))==null?void 0:l.types:{generator:!1,cancel:!1};if(f!==-1&&((h=(u=e.dependencies.find(g=>g.id==f))==null?void 0:u.inputs)==null?void 0:h.length)!==a.length){const g=e.dependencies.find(y=>y.id==f).inputs.map(y=>{var v;return(v=e.components.find(b=>b.id===y))==null?void 0:v.type});try{g.forEach((y,v)=>{if(y==="state"){const b={component:"state",example:null,parameter_default:null,parameter_has_default:!0,parameter_name:null,hidden:!0};a.splice(v,0,b)}})}catch(y){console.error(y)}}const p=(g,y,v,b)=>({...g,description:Rvt(g==null?void 0:g.type,v),type:Avt(g==null?void 0:g.type,y,v,b)||""});i[r][s]={parameters:a.map(g=>p(g,g==null?void 0:g.component,g==null?void 0:g.serializer,"parameter")),returns:o.map(g=>p(g,g==null?void 0:g.component,g==null?void 0:g.serializer,"return")),type:d}}))}),i}function Avt(t,e,n,i){if(e==="Api")return t.type;switch(t==null?void 0:t.type){case"string":return"string";case"boolean":return"boolean";case"number":return"number"}if(n==="JSONSerializable"||n==="StringSerializable")return"any";if(n==="ListStringSerializable")return"string[]";if(e==="Image")return i==="parameter"?"Blob | File | Buffer":"string";if(n==="FileSerializable")return(t==null?void 0:t.type)==="array"?i==="parameter"?"(Blob | File | Buffer)[]":"{ name: string; data: string; size?: number; is_file?: boolean; orig_name?: string}[]":i==="parameter"?"Blob | File | Buffer":"{ name: string; data: string; size?: number; is_file?: boolean; orig_name?: string}";if(n==="GallerySerializable")return i==="parameter"?"[(Blob | File | Buffer), (string | null)][]":"[{ name: string; data: string; size?: number; is_file?: boolean; orig_name?: string}, (string | null))][]"}function Rvt(t,e){return e==="GallerySerializable"?"array of [file, label] tuples":e==="ListStringSerializable"?"array of strings":e==="FileSerializable"?"array of files or single file":t==null?void 0:t.description}function Rj(t,e){switch(t.msg){case"send_data":return{type:"data"};case"send_hash":return{type:"hash"};case"queue_full":return{type:"update",status:{queue:!0,message:Gbe,stage:"error",code:t.code,success:t.success}};case"heartbeat":return{type:"heartbeat"};case"unexpected_error":return{type:"unexpected_error",status:{queue:!0,message:t.message,stage:"error",success:!1}};case"estimation":return{type:"update",status:{queue:!0,stage:e||"pending",code:t.code,size:t.queue_size,position:t.rank,eta:t.rank_eta,success:t.success}};case"progress":return{type:"update",status:{queue:!0,stage:"pending",code:t.code,progress_data:t.progress_data,success:t.success}};case"log":return{type:"log",data:t};case"process_generating":return{type:"generating",status:{queue:!0,message:t.success?null:t.output.error,stage:t.success?"generating":"error",code:t.code,progress_data:t.progress_data,eta:t.average_duration,changed_state_ids:t.success?t.output.changed_state_ids:void 0},data:t.success?t.output:null};case"process_streaming":return{type:"streaming",status:{queue:!0,message:t.output.error,stage:"streaming",time_limit:t.time_limit,code:t.code,progress_data:t.progress_data,eta:t.eta},data:t.output};case"process_completed":return"error"in t.output?{type:"update",status:{queue:!0,title:t.output.title,message:t.output.error,visible:t.output.visible,duration:t.output.duration,stage:"error",code:t.code,success:t.success}}:{type:"complete",status:{queue:!0,message:t.success?void 0:t.output.error,stage:t.success?"complete":"error",code:t.code,progress_data:t.progress_data,changed_state_ids:t.success?t.output.changed_state_ids:void 0},data:t.success?t.output:null};case"process_starts":return{type:"update",status:{queue:!0,stage:"pending",code:t.code,size:t.rank,position:0,success:t.success,eta:t.eta},original_msg:"process_starts"}}return{type:"none",status:{stage:"error",queue:!0}}}const Mvt=(t=[],e)=>{const n=e?e.parameters:[];if(Array.isArray(t))return t.length>n.length&&console.warn("Too many arguments provided for the endpoint."),t;const i=[],r=Object.keys(t);return n.forEach((s,a)=>{if(t.hasOwnProperty(s.parameter_name))i[a]=t[s.parameter_name];else if(s.parameter_has_default)i[a]=s.parameter_default;else throw new Error(`No value provided for required parameter: ${s.parameter_name}`)}),r.forEach(s=>{if(!n.some(a=>a.parameter_name===s))throw new Error(`Parameter \`${s}\` is not a valid keyword argument. Please refer to the API for usage.`)}),i.forEach((s,a)=>{if(s===void 0&&!n[a].parameter_has_default)throw new Error(`No value provided for required parameter: ${n[a].parameter_name}`)}),i};async function Ovt(){if(this.api_info)return this.api_info;const{hf_token:t}=this.options,{config:e}=this,n={"Content-Type":"application/json"};if(t&&(n.Authorization=`Bearer ${t}`),!!e)try{let i,r;if(typeof window<"u"&&window.gradio_api_info)r=window.gradio_api_info;else{if(jbe((e==null?void 0:e.version)||"2.0.0","3.30")<0)i=await this.fetch(pvt,{method:"POST",body:JSON.stringify({serialize:!1,config:JSON.stringify(e)}),headers:n,credentials:"include"});else{const s=Kbe(e.root,this.api_prefix,ovt);i=await this.fetch(s,{headers:n,credentials:"include"})}if(!i.ok)throw new Error(RT);r=await i.json()}return"api"in r&&(r=r.api),r.named_endpoints["/predict"]&&!r.unnamed_endpoints[0]&&(r.unnamed_endpoints[0]=r.named_endpoints["/predict"]),Cvt(r,e,this.api_map)}catch(i){""+i.message}}async function Nvt(t,e,n){var i;const r={};(i=this==null?void 0:this.options)!=null&&i.hf_token&&(r.Authorization=`Bearer ${this.options.hf_token}`);const s=1e3,a=[];let o;for(let c=0;c<e.length;c+=s){const l=e.slice(c,c+s),u=new FormData;l.forEach(f=>{u.append("files",f)});try{const f=n?`${t}${this.api_prefix}/${wse}?upload_id=${n}`:`${t}${this.api_prefix}/${wse}`;o=await this.fetch(f,{method:"POST",body:u,headers:r,credentials:"include"})}catch(f){throw new Error(RT+f.message)}if(!o.ok){const f=await o.text();return{error:`HTTP ${o.status}: ${f}`}}const h=await o.json();h&&a.push(...h)}return{files:a}}async function Ivt(t,e,n,i){let r=(Array.isArray(t)?t:[t]).map(a=>a.blob);const s=r.filter(a=>a.size>(i??1/0));if(s.length)throw new Error(`File size exceeds the maximum allowed size of ${i} bytes: ${s.map(a=>a.name).join(", ")}`);return await Promise.all(await this.upload_files(e,r,n).then(async a=>{if(a.error)throw new Error(a.error);return a.files?a.files.map((o,c)=>new bK({...t[c],path:o,url:`${e}${this.api_prefix}/file=${o}`})):[]}))}class bK{constructor({path:e,url:n,orig_name:i,size:r,blob:s,is_stream:a,mime_type:o,alt_text:c,b64:l}){Wi(this,"path"),Wi(this,"url"),Wi(this,"orig_name"),Wi(this,"size"),Wi(this,"blob"),Wi(this,"is_stream"),Wi(this,"mime_type"),Wi(this,"alt_text"),Wi(this,"b64"),Wi(this,"meta",{_type:"gradio.FileData"}),this.path=e,this.url=n,this.orig_name=i,this.size=r,this.blob=n?void 0:s,this.is_stream=a,this.mime_type=o,this.alt_text=c,this.b64=l}}class kvt{constructor(e,n){Wi(this,"type"),Wi(this,"command"),Wi(this,"meta"),Wi(this,"fileData"),this.type="command",this.command=e,this.meta=n}}typeof zn<"u"&&zn.versions&&zn.versions.node;function Ase(t,e,n){for(;n.length>1;){const r=n.shift();if(typeof r=="string"||typeof r=="number")t=t[r];else throw new Error("Invalid key type")}const i=n.shift();if(typeof i=="string"||typeof i=="number")t[i]=e;else throw new Error("Invalid key type")}async function d$(t,e=void 0,n=[],i=!1,r=void 0){if(Array.isArray(t)){let s=[];return await Promise.all(t.map(async(a,o)=>{var c;let l=n.slice();l.push(String(o));const u=await d$(t[o],i?((c=r==null?void 0:r.parameters[o])==null?void 0:c.component)||void 0:e,l,!1,r);s=s.concat(u)})),s}else{if(globalThis.Buffer&&t instanceof globalThis.Buffer||t instanceof Blob)return[{path:n,blob:new Blob([t]),type:e}];if(typeof t=="object"&&t!==null){let s=[];for(const a of Object.keys(t)){const o=[...n,a],c=t[a];s=s.concat(await d$(c,void 0,o,!1,r))}return s}}return[]}function Dvt(t,e){var n,i;let r=(i=(n=e==null?void 0:e.dependencies)==null?void 0:n.find(s=>s.id==t))==null?void 0:i.queue;return r!=null?!r:!e.enable_queue}function Pvt(t,e){return new Promise((n,i)=>{const r=new MessageChannel;r.port1.onmessage=({data:s})=>{r.port1.close(),n(s)},window.parent.postMessage(t,e,[r.port2])})}function qR(t,e,n,i,r=!1){if(i==="input"&&!r)throw new Error("Invalid code path. Cannot skip state inputs for input.");if(i==="output"&&r)return t;let s=[],a=0;const o=i==="input"?e.inputs:e.outputs;for(let c=0;c<o.length;c++){const l=o[c],u=n.find(h=>h.id===l);if((u==null?void 0:u.type)==="state"){if(r)if(t.length===o.length){const h=t[a];s.push(h),a++}else s.push(null);else{a++;continue}continue}else{const h=t[a];s.push(h),a++}}return s}async function Lvt(t,e,n){const i=this;await Uvt(i,e);const r=await d$(e,void 0,[],!0,n);return(await Promise.all(r.map(async({path:a,blob:o,type:c})=>{if(!o)return{path:a,type:c};const l=await i.upload_files(t,[o]),u=l.files&&l.files[0];return{path:a,file_url:u,type:c,name:typeof File<"u"&&o instanceof File?o==null?void 0:o.name:void 0}}))).forEach(({path:a,file_url:o,type:c,name:l})=>{if(c==="Gallery")Ase(e,o,a);else if(o){const u=new bK({path:o,orig_name:l});Ase(e,u,a)}}),e}async function Uvt(t,e){var n,i;if(!(((n=t.config)==null?void 0:n.root)||((i=t.config)==null?void 0:i.root_url)))throw new Error($be);await Zbe(t,e)}async function Zbe(t,e,n=[]){for(const i in e)e[i]instanceof kvt?await Bvt(t,e,i):typeof e[i]=="object"&&e[i]!==null&&await Zbe(t,e[i],[...n,i])}async function Bvt(t,e,n){var i,r;let s=e[n];const a=((i=t.config)==null?void 0:i.root)||((r=t.config)==null?void 0:r.root_url);if(!a)throw new Error($be);try{let o,c;if(typeof zn<"u"&&zn.versions&&zn.versions.node){const f=await f$(()=>Promise.resolve().then(()=>wq),void 0);c=(await f$(()=>Promise.resolve().then(()=>wq),void 0)).resolve(zn.cwd(),s.meta.path),o=await f.readFile(c)}else throw new Error(bvt);const l=new Blob([o],{type:"application/octet-stream"}),u=await t.upload_files(a,[l]),h=u.files&&u.files[0];if(h){const f=new bK({path:h,orig_name:s.meta.name||""});e[n]=f}}catch(o){console.error(Evt,o)}}async function Fvt(t,e,n){const i={"Content-Type":"application/json"};this.options.hf_token&&(i.Authorization=`Bearer ${this.options.hf_token}`);try{var r=await this.fetch(t,{method:"POST",body:JSON.stringify(e),headers:{...i,...n},credentials:"include"})}catch{return[{error:RT},500]}let s,a;try{s=await r.json(),a=r.status}catch(o){s={error:`Could not parse server response: ${o}`},a=500}return[s,a]}async function zvt(t,e={}){let n=!1,i=!1;if(!this.config)throw new Error("Could not resolve app config");if(typeof t=="number")this.config.dependencies.find(r=>r.id==t);else{const r=t.replace(/^\//,"");this.config.dependencies.find(s=>s.id==this.api_map[r])}return new Promise(async(r,s)=>{const a=this.submit(t,e,null,null,!0);let o;for await(const c of a)c.type==="data"&&(i&&r(o),n=!0,o=c),c.type==="status"&&(c.stage==="error"&&s(c),c.stage==="complete"&&(i=!0,n&&r(o)))})}async function QM(t,e,n){let i=e==="subdomain"?`https://huggingface.co/api/spaces/by-subdomain/${t}`:`https://huggingface.co/api/spaces/${t}`,r,s;try{if(r=await fetch(i),s=r.status,s!==200)throw new Error;r=await r.json()}catch{n({status:"error",load_status:"error",message:mvt,detail:"NOT_FOUND"});return}if(!r||s!==200)return;const{runtime:{stage:a},id:o}=r;switch(a){case"STOPPED":case"SLEEPING":n({status:"sleeping",load_status:"pending",message:"Space is asleep. Waking it up...",detail:a}),setTimeout(()=>{QM(t,e,n)},1e3);break;case"PAUSED":n({status:"paused",load_status:"error",message:"This space has been paused by the author. If you would like to try this demo, consider duplicating the space.",detail:a,discussions_enabled:await Rse(o)});break;case"RUNNING":case"RUNNING_BUILDING":n({status:"running",load_status:"complete",message:"Space is running.",detail:a});break;case"BUILDING":n({status:"building",load_status:"pending",message:"Space is building...",detail:a}),setTimeout(()=>{QM(t,e,n)},1e3);break;case"APP_STARTING":n({status:"starting",load_status:"pending",message:"Space is starting...",detail:a}),setTimeout(()=>{QM(t,e,n)},1e3);break;default:n({status:"space_error",load_status:"error",message:"This space is experiencing an issue.",detail:a,discussions_enabled:await Rse(o)});break}}const Jbe=async(t,e)=>{let n=0;const i=12,r=5e3;return new Promise(s=>{QM(t,yK.test(t)?"space_name":"subdomain",a=>{e(a),a.status==="running"||a.status==="error"||a.status==="paused"||a.status==="space_error"?s():(a.status==="sleeping"||a.status==="building")&&(n<i?(n++,setTimeout(()=>{Jbe(t,e).then(s)},r)):s())})})},Hvt=/^(?=[^]*\b[dD]iscussions{0,1}\b)(?=[^]*\b[dD]isabled\b)[^]*$/;async function Rse(t){try{const e=await fetch(`https://huggingface.co/api/spaces/${t}/discussions`,{method:"HEAD"}),n=e.headers.get("x-error-message");return!(!e.ok||n&&Hvt.test(n))}catch{return!1}}async function jvt(t,e){const n={};e&&(n.Authorization=`Bearer ${e}`);try{const i=await fetch(`https://huggingface.co/api/spaces/${t}/${cvt}`,{headers:n});if(i.status!==200)throw new Error("Space hardware could not be obtained.");const{hardware:r}=await i.json();return r.current}catch(i){throw new Error(i.message)}}async function Vvt(t,e,n){const i={};n&&(i.Authorization=`Bearer ${n}`);const r={seconds:e};try{const s=await fetch(`https://huggingface.co/api/spaces/${t}/${lvt}`,{method:"POST",headers:{"Content-Type":"application/json",...i},body:JSON.stringify(r)});if(s.status!==200)throw new Error("Could not set sleep timeout on duplicated Space. Please visit *ADD HF LINK TO SETTINGS* to set a timeout manually to reduce billing charges.");return await s.json()}catch(s){throw new Error(s.message)}}const Mse=["cpu-basic","cpu-upgrade","cpu-xl","t4-small","t4-medium","a10g-small","a10g-large","a10g-largex2","a10g-largex4","a100-large","zero-a10g","h100","h100x8"];async function Gvt(t,e){const{hf_token:n,private:i,hardware:r,timeout:s,auth:a}=e;if(r&&!Mse.includes(r))throw new Error(`Invalid hardware type provided. Valid types are: ${Mse.map(y=>`"${y}"`).join(",")}.`);const{http_protocol:o,host:c}=await h8(t,n);let l=null;if(a){const y=await Ybe(o,c,a,fetch);y&&(l=Xbe(y))}const u={Authorization:`Bearer ${n}`,"Content-Type":"application/json",...l?{Cookie:l.join("; ")}:{}},h=(await(await fetch("https://huggingface.co/api/whoami-v2",{headers:u})).json()).name,f=t.split("/")[1],d={repository:`${h}/${f}`};i&&(d.private=!0);let p;try{r||(p=await jvt(t,n))}catch(y){throw Error(_K+y.message)}const g=r||p||"cpu-basic";d.hardware=g;try{const y=await fetch(`https://huggingface.co/api/spaces/${t}/duplicate`,{method:"POST",headers:u,body:JSON.stringify(d)});if(y.status===409)try{return await p$.connect(`${h}/${f}`,e)}catch(b){throw console.error("Failed to connect Client instance:",b),b}else if(y.status!==200)throw new Error(y.statusText);const v=await y.json();return await Vvt(`${h}/${f}`,s||300,n),await p$.connect(qvt(v.url),e)}catch(y){throw new Error(y)}}function qvt(t){const e=/https:\/\/huggingface.co\/spaces\/([^/]+\/[^/]+)/,n=t.match(e);if(n)return n[1]}class $vt extends TransformStream{constructor(e={allowCR:!1}){super({transform:(n,i)=>{for(n=GR(this,jy)+n;;){const r=n.indexOf(`
`),s=e.allowCR?n.indexOf("\r"):-1;if(s!==-1&&s!==n.length-1&&(r===-1||r-1>s)){i.enqueue(n.slice(0,s)),n=n.slice(s+1);continue}if(r===-1)break;const a=n[r-1]==="\r"?r-1:r;i.enqueue(n.slice(0,a)),n=n.slice(r+1)}nvt(this,jy,n)},flush:n=>{if(GR(this,jy)==="")return;const i=e.allowCR&&GR(this,jy).endsWith("\r")?GR(this,jy).slice(0,-1):GR(this,jy);n.enqueue(i)}}),tvt(this,jy,"")}}jy=new WeakMap;function Wvt(t){let e=new TextDecoderStream,n=new $vt({allowCR:!0});return t.pipeThrough(e).pipeThrough(n)}function Yvt(t){let n=/[:]\s*/.exec(t),i=n&&n.index;if(i)return[t.substring(0,i),t.substring(i+n[0].length)]}function Ose(t,e,n){t.get(e)||t.set(e,n)}async function*Xvt(t,e){if(!t.body)return;let n=Wvt(t.body),i,r=n.getReader(),s;for(;;){if(e&&e.aborted)return r.cancel();if(i=await r.read(),i.done)return;if(!i.value){s&&(yield s),s=void 0;continue}let[a,o]=Yvt(i.value)||[];a&&(a==="data"?(s||(s={}),s[a]=s[a]?s[a]+`
`+o:o):a==="event"?(s||(s={}),s[a]=o):a==="id"?(s||(s={}),s[a]=+o||o):a==="retry"&&(s||(s={}),s[a]=+o||void 0))}}async function Kvt(t,e){let n=new Request(t,e);Ose(n.headers,"Accept","text/event-stream"),Ose(n.headers,"Content-Type","application/json");let i=await fetch(n);if(!i.ok)throw i;return Xvt(i,n.signal)}async function Zvt(){let{event_callbacks:t,unclosed_events:e,pending_stream_messages:n,stream_status:i,config:r,jwt:s}=this;const a=this;if(!r)throw new Error("Could not resolve app config");i.open=!0;let o=null,c=new URLSearchParams({session_hash:this.session_hash}).toString(),l=new URL(`${r.root}${this.api_prefix}/${Vbe}?${c}`);if(s&&l.searchParams.set("__sign",s),o=this.stream(l),!o){console.warn("Cannot connect to SSE endpoint: "+l.toString());return}o.onmessage=async function(u){let h=JSON.parse(u.data);if(h.msg==="close_stream"){Y3(i,a.abort_controller);return}const f=h.event_id;if(!f)await Promise.all(Object.keys(t).map(d=>t[d](h)));else if(t[f]&&r){h.msg==="process_completed"&&["sse","sse_v1","sse_v2","sse_v2.1","sse_v3"].includes(r.protocol)&&e.delete(f);let d=t[f];typeof window<"u"&&typeof document<"u"?setTimeout(d,0,h):d(h)}else n[f]||(n[f]=[]),n[f].push(h)},o.onerror=async function(){await Promise.all(Object.keys(t).map(u=>t[u]({msg:"unexpected_error",message:RT})))}}function Y3(t,e){t&&(t.open=!1,e==null||e.abort())}function Jvt(t,e,n){!t[e]?(t[e]=[],n.data.forEach((r,s)=>{t[e][s]=r})):n.data.forEach((r,s)=>{let a=Qvt(t[e][s],r);t[e][s]=a,n.data[s]=a})}function Qvt(t,e){return e.forEach(([n,i,r])=>{t=e_t(t,i,n,r)}),t}function e_t(t,e,n,i){if(e.length===0){if(n==="replace")return i;if(n==="append")return t+i;throw new Error(`Unsupported action: ${n}`)}let r=t;for(let a=0;a<e.length-1;a++)r=r[e[a]];const s=e[e.length-1];switch(n){case"replace":r[s]=i;break;case"append":r[s]+=i;break;case"add":Array.isArray(r)?r.splice(Number(s),0,i):r[s]=i;break;case"delete":Array.isArray(r)?r.splice(Number(s),1):delete r[s];break;default:throw new Error(`Unknown action: ${n}`)}return t}function t_t(t,e={}){const n={close:()=>{console.warn("Method not implemented.")},onerror:null,onmessage:null,onopen:null,readyState:0,url:t.toString(),withCredentials:!1,CONNECTING:0,OPEN:1,CLOSED:2,addEventListener:()=>{throw new Error("Method not implemented.")},dispatchEvent:()=>{throw new Error("Method not implemented.")},removeEventListener:()=>{throw new Error("Method not implemented.")}};return Kvt(t,e).then(async i=>{n.readyState=n.OPEN;try{for await(const r of i)n.onmessage&&n.onmessage(r);n.readyState=n.CLOSED}catch(r){n.onerror&&n.onerror(r),n.readyState=n.CLOSED}}).catch(i=>{console.error(i),n.onerror&&n.onerror(i),n.readyState=n.CLOSED}),n}function n_t(t,e={},n,i,r){var s;try{let a=function(Be){(r||Ce[Be.type])&&u(Be)},o=function(){for(Ee=!0;tt.length>0;)tt.shift()({value:void 0,done:!0})},c=function(Be){Ee||(tt.length>0?tt.shift()(Be):_e.push(Be))},l=function(Be){c(i_t(Be)),o()},u=function(Be){c({value:Be,done:!1})},h=function(){return _e.length>0?Promise.resolve(_e.shift()):Ee?Promise.resolve({value:void 0,done:!0}):new Promise(Be=>tt.push(Be))};const{hf_token:f}=this.options,{fetch:d,app_reference:p,config:g,session_hash:y,api_info:v,api_map:b,stream_status:T,pending_stream_messages:x,pending_diff_streams:M,event_callbacks:R,unclosed_events:I,post_data:k,options:P,api_prefix:U}=this,G=this;if(!v)throw new Error("No API found");if(!g)throw new Error("Could not resolve app config");let{fn_index:$,endpoint_info:q,dependency:Y}=r_t(v,t,b,g),ie=Mvt(e,q),V,J,X=g.protocol??"ws",ee="",oe=()=>ee;const fe=typeof t=="number"?"/predict":t;let Re,He=null,Te=!1,Le={},we=typeof window<"u"&&typeof document<"u"?new URLSearchParams(window.location.search).toString():"";const Ce=((s=P==null?void 0:P.events)==null?void 0:s.reduce((Be,Ie)=>(Be[Ie]=!0,Be),{}))||{};async function ke(){const Be={stage:"complete",queue:!1,time:new Date};Te=Be,a({...Be,type:"status",endpoint:fe,fn_index:$});let Ie={},rt={};X==="ws"?(V&&V.readyState===0?V.addEventListener("open",()=>{V.close()}):V.close(),Ie={fn_index:$,session_hash:y}):(Y3(T,G.abort_controller),o(),Ie={event_id:He},rt={event_id:He,session_hash:y,fn_index:$});try{if(!g)throw new Error("Could not resolve app config");"event_id"in rt&&await d(`${g.root}${U}/${dvt}`,{headers:{"Content-Type":"application/json"},method:"POST",body:JSON.stringify(rt)}),await d(`${g.root}${U}/${fvt}`,{headers:{"Content-Type":"application/json"},method:"POST",body:JSON.stringify(Ie)})}catch{console.warn("The `/reset` endpoint could not be called. Subsequent endpoint results may be unreliable.")}}const St=async Be=>{await this._resolve_hearbeat(Be)};async function Mt(Be){if(!g)return;let Ie=Be.render_id;g.components=[...g.components.filter(gt=>gt.props.rendered_in!==Ie),...Be.components],g.dependencies=[...g.dependencies.filter(gt=>gt.rendered_in!==Ie),...Be.dependencies];const rt=g.components.some(gt=>gt.type==="state"),ft=g.dependencies.some(gt=>gt.targets.some(bt=>bt[1]==="unload"));g.connect_heartbeat=rt||ft,await St(g),a({type:"render",data:Be,endpoint:fe,fn_index:$})}this.handle_blob(g.root,ie,q).then(async Be=>{var Ie;if(Re={data:qR(Be,Y,g.components,"input",!0)||[],event_data:n,fn_index:$,trigger_id:i},Dvt($,g))a({type:"status",endpoint:fe,stage:"pending",queue:!1,fn_index:$,time:new Date}),k(`${g.root}${U}/run${fe.startsWith("/")?fe:`/${fe}`}${we?"?"+we:""}`,{...Re,session_hash:y}).then(([gt,bt])=>{const be=gt.data;bt==200?(a({type:"data",endpoint:fe,fn_index:$,data:qR(be,Y,g.components,"output",P.with_null_state),time:new Date,event_data:n,trigger_id:i}),gt.render_config&&Mt(gt.render_config),a({type:"status",endpoint:fe,fn_index:$,stage:"complete",eta:gt.average_duration,queue:!1,time:new Date})):a({type:"status",stage:"error",endpoint:fe,fn_index:$,message:gt.error,queue:!1,time:new Date})}).catch(gt=>{a({type:"status",stage:"error",message:gt.message,endpoint:fe,fn_index:$,queue:!1,time:new Date})});else if(X=="ws"){const{ws_protocol:gt,host:bt}=await h8(p,f);a({type:"status",stage:"pending",queue:!0,endpoint:fe,fn_index:$,time:new Date});let be=new URL(`${gt}://${Wbe(bt,g.path,!0)}/queue/join${we?"?"+we:""}`);this.jwt&&be.searchParams.set("__sign",this.jwt),V=new WebSocket(be),V.onclose=ue=>{ue.wasClean||a({type:"status",stage:"error",broken:!0,message:RT,queue:!0,endpoint:fe,fn_index:$,time:new Date})},V.onmessage=function(ue){const Xe=JSON.parse(ue.data),{type:it,status:$e,data:Ue}=Rj(Xe,Le[$]);if(it==="update"&&$e&&!Te)a({type:"status",endpoint:fe,fn_index:$,time:new Date,...$e}),$e.stage==="error"&&V.close();else if(it==="hash"){V.send(JSON.stringify({fn_index:$,session_hash:y}));return}else it==="data"?V.send(JSON.stringify({...Re,session_hash:y})):it==="complete"?Te=$e:it==="log"?a({type:"log",title:Ue.title,log:Ue.log,level:Ue.level,endpoint:fe,duration:Ue.duration,visible:Ue.visible,fn_index:$}):it==="generating"&&a({type:"status",time:new Date,...$e,stage:$e==null?void 0:$e.stage,queue:!0,endpoint:fe,fn_index:$});Ue&&(a({type:"data",time:new Date,data:qR(Ue.data,Y,g.components,"output",P.with_null_state),endpoint:fe,fn_index:$,event_data:n,trigger_id:i}),Te&&(a({type:"status",time:new Date,...Te,stage:$e==null?void 0:$e.stage,queue:!0,endpoint:fe,fn_index:$}),V.close()))},jbe(g.version||"2.0.0","3.6")<0&&addEventListener("open",()=>V.send(JSON.stringify({hash:y})))}else if(X=="sse"){a({type:"status",stage:"pending",queue:!0,endpoint:fe,fn_index:$,time:new Date});var ft=new URLSearchParams({fn_index:$.toString(),session_hash:y}).toString();let gt=new URL(`${g.root}${U}/${Vbe}?${we?we+"&":""}${ft}`);if(this.jwt&&gt.searchParams.set("__sign",this.jwt),J=this.stream(gt),!J)return Promise.reject(new Error("Cannot connect to SSE endpoint: "+gt.toString()));J.onmessage=async function(bt){const be=JSON.parse(bt.data),{type:ue,status:Xe,data:it}=Rj(be,Le[$]);if(ue==="update"&&Xe&&!Te)a({type:"status",endpoint:fe,fn_index:$,time:new Date,...Xe}),Xe.stage==="error"&&(J==null||J.close(),o());else if(ue==="data"){let[$e,Ue]=await k(`${g.root}${U}/queue/data`,{...Re,session_hash:y,event_id:He});Ue!==200&&(a({type:"status",stage:"error",message:RT,queue:!0,endpoint:fe,fn_index:$,time:new Date}),J==null||J.close(),o())}else ue==="complete"?Te=Xe:ue==="log"?a({type:"log",title:it.title,log:it.log,level:it.level,endpoint:fe,duration:it.duration,visible:it.visible,fn_index:$}):(ue==="generating"||ue==="streaming")&&a({type:"status",time:new Date,...Xe,stage:Xe==null?void 0:Xe.stage,queue:!0,endpoint:fe,fn_index:$});it&&(a({type:"data",time:new Date,data:qR(it.data,Y,g.components,"output",P.with_null_state),endpoint:fe,fn_index:$,event_data:n,trigger_id:i}),Te&&(a({type:"status",time:new Date,...Te,stage:Xe==null?void 0:Xe.stage,queue:!0,endpoint:fe,fn_index:$}),J==null||J.close(),o()))}}else if(X=="sse_v1"||X=="sse_v2"||X=="sse_v2.1"||X=="sse_v3"){a({type:"status",stage:"pending",queue:!0,endpoint:fe,fn_index:$,time:new Date});let gt="";typeof window<"u"&&typeof document<"u"&&(gt=(Ie=window==null?void 0:window.location)==null?void 0:Ie.hostname);const be=gt.includes(".dev.")?`https://moon-${gt.split(".")[1]}.dev.spaces.huggingface.tech`:"https://huggingface.co";(typeof window<"u"&&typeof document<"u"&&window.parent!=window&&window.supports_zerogpu_headers?Pvt("zerogpu-headers",be):Promise.resolve(null)).then($e=>k(`${g.root}${U}/${rvt}?${we}`,{...Re,session_hash:y},$e)).then(async([$e,Ue])=>{if(Ue===503)a({type:"status",stage:"error",message:Gbe,queue:!0,endpoint:fe,fn_index:$,time:new Date});else if(Ue!==200)a({type:"status",stage:"error",message:RT,queue:!0,endpoint:fe,fn_index:$,time:new Date});else{He=$e.event_id,ee=He;let qt=async function(Ot){try{const{type:Yt,status:ce,data:j,original_msg:W}=Rj(Ot,Le[$]);if(Yt=="heartbeat")return;if(Yt==="update"&&ce&&!Te)a({type:"status",endpoint:fe,fn_index:$,time:new Date,original_msg:W,...ce});else if(Yt==="complete")Te=ce;else if(Yt=="unexpected_error")console.error("Unexpected error",ce==null?void 0:ce.message),a({type:"status",stage:"error",message:(ce==null?void 0:ce.message)||"An Unexpected Error Occurred!",queue:!0,endpoint:fe,fn_index:$,time:new Date});else if(Yt==="log"){a({type:"log",title:j.title,log:j.log,level:j.level,endpoint:fe,duration:j.duration,visible:j.visible,fn_index:$});return}else(Yt==="generating"||Yt==="streaming")&&(a({type:"status",time:new Date,...ce,stage:ce==null?void 0:ce.stage,queue:!0,endpoint:fe,fn_index:$}),j&&Y.connection!=="stream"&&["sse_v2","sse_v2.1","sse_v3"].includes(X)&&Jvt(M,He,j));j&&(a({type:"data",time:new Date,data:qR(j.data,Y,g.components,"output",P.with_null_state),endpoint:fe,fn_index:$}),j.render_config&&await Mt(j.render_config),Te&&(a({type:"status",time:new Date,...Te,stage:ce==null?void 0:ce.stage,queue:!0,endpoint:fe,fn_index:$}),o())),((ce==null?void 0:ce.stage)==="complete"||(ce==null?void 0:ce.stage)==="error")&&(R[He]&&delete R[He],He in M&&delete M[He])}catch(Yt){console.error("Unexpected client exception",Yt),a({type:"status",stage:"error",message:"An Unexpected Error Occurred!",queue:!0,endpoint:fe,fn_index:$,time:new Date}),["sse_v2","sse_v2.1","sse_v3"].includes(X)&&(Y3(T,G.abort_controller),T.open=!1,o())}};He in x&&(x[He].forEach(Ot=>qt(Ot)),delete x[He]),R[He]=qt,I.add(He),T.open||await this.open_stream()}})}});let Ee=!1;const _e=[],tt=[],de={[Symbol.asyncIterator]:()=>de,next:h,throw:async Be=>(l(Be),h()),return:async()=>(o(),h()),cancel:ke,event_id:oe};return de}catch(a){throw console.error("Submit function encountered an error:",a),a}}function i_t(t){return{then:(e,n)=>n(t)}}function r_t(t,e,n,i){let r,s,a;if(typeof e=="number")r=e,s=t.unnamed_endpoints[r],a=i.dependencies.find(o=>o.id==e);else{const o=e.replace(/^\//,"");r=n[o],s=t.named_endpoints[e.trim()],a=i.dependencies.find(c=>c.id==n[o])}if(typeof r!="number")throw new Error("There is no endpoint matching that name of fn_index matching that number.");return{fn_index:r,endpoint_info:s,dependency:a}}class p${constructor(e,n={events:["data"]}){Wi(this,"app_reference"),Wi(this,"options"),Wi(this,"config"),Wi(this,"api_prefix",""),Wi(this,"api_info"),Wi(this,"api_map",{}),Wi(this,"session_hash",Math.random().toString(36).substring(2)),Wi(this,"jwt",!1),Wi(this,"last_status",{}),Wi(this,"cookies",null),Wi(this,"stream_status",{open:!1}),Wi(this,"pending_stream_messages",{}),Wi(this,"pending_diff_streams",{}),Wi(this,"event_callbacks",{}),Wi(this,"unclosed_events",new Set),Wi(this,"heartbeat_event",null),Wi(this,"abort_controller",null),Wi(this,"stream_instance",null),Wi(this,"current_payload"),Wi(this,"ws_map",{}),Wi(this,"view_api"),Wi(this,"upload_files"),Wi(this,"upload"),Wi(this,"handle_blob"),Wi(this,"post_data"),Wi(this,"submit"),Wi(this,"predict"),Wi(this,"open_stream"),Wi(this,"resolve_config"),Wi(this,"resolve_cookies"),this.app_reference=e,n.events||(n.events=["data"]),this.options=n,this.current_payload={},this.view_api=Ovt.bind(this),this.upload_files=Nvt.bind(this),this.handle_blob=Lvt.bind(this),this.post_data=Fvt.bind(this),this.submit=n_t.bind(this),this.predict=zvt.bind(this),this.open_stream=Zvt.bind(this),this.resolve_config=Tvt.bind(this),this.resolve_cookies=xvt.bind(this),this.upload=Ivt.bind(this),this.fetch=this.fetch.bind(this),this.handle_space_success=this.handle_space_success.bind(this),this.stream=this.stream.bind(this)}get_url_config(e=null){if(!this.config)throw new Error(Qy);e===null&&(e=window.location.href);const n=a=>a.replace(/^\/+|\/+$/g,"");let i=n(new URL(this.config.root).pathname),r=n(new URL(e).pathname),s;return r.startsWith(i)?s=n(r.substring(i.length)):s="",this.get_page_config(s)}get_page_config(e){if(!this.config)throw new Error(Qy);let n=this.config;return e in n.page||(e=""),{...n,current_page:e,layout:n.page[e].layout,components:n.components.filter(i=>n.page[e].components.includes(i.id)),dependencies:this.config.dependencies.filter(i=>n.page[e].dependencies.includes(i.id))}}fetch(e,n){const i=new Headers((n==null?void 0:n.headers)||{});if(this&&this.cookies&&i.append("Cookie",this.cookies),this&&this.options.headers)for(const r in this.options.headers)i.append(r,this.options.headers[r]);return fetch(e,{...n,headers:i})}stream(e){const n=new Headers;if(this&&this.cookies&&n.append("Cookie",this.cookies),this&&this.options.headers)for(const i in this.options.headers)n.append(i,this.options.headers[i]);return this.abort_controller=new AbortController,this.stream_instance=t_t(e.toString(),{credentials:"include",headers:n,signal:this.abort_controller.signal}),this.stream_instance}async init(){var e;if((typeof window>"u"||!("WebSocket"in window))&&!um.WebSocket){const n=await f$(()=>import("./wrapper-CviSselG-C__wymOM.js"),[]);um.WebSocket=n.WebSocket}this.options.auth&&await this.resolve_cookies(),await this._resolve_config().then(({config:n})=>this._resolve_hearbeat(n)),this.api_info=await this.view_api(),this.api_map=Svt(((e=this.config)==null?void 0:e.dependencies)||[])}async _resolve_hearbeat(e){if(e&&(this.config=e,this.api_prefix=e.api_prefix||"",this.config&&this.config.connect_heartbeat&&this.config.space_id&&this.options.hf_token&&(this.jwt=await Cse(this.config.space_id,this.options.hf_token,this.cookies))),e.space_id&&this.options.hf_token&&(this.jwt=await Cse(e.space_id,this.options.hf_token)),this.config&&this.config.connect_heartbeat){const n=new URL(`${this.config.root}${this.api_prefix}/${uvt}/${this.session_hash}`);this.jwt&&n.searchParams.set("__sign",this.jwt),this.heartbeat_event||(this.heartbeat_event=this.stream(n))}}static async connect(e,n={events:["data"]}){const i=new this(e,n);return await i.init(),i}close(){Y3(this.stream_status,this.abort_controller)}set_current_payload(e){this.current_payload=e}static async duplicate(e,n={events:["data"]}){return Gvt(e,n)}async _resolve_config(){const{http_protocol:e,host:n,space_id:i}=await h8(this.app_reference,this.options.hf_token),{status_callback:r}=this.options;i&&r&&await Jbe(i,r);let s;try{if(s=await this.resolve_config(`${e}//${n}`),!s)throw new Error(Qy);return this.config_success(s)}catch(a){if(i&&r)QM(i,yK.test(i)?"space_name":"subdomain",this.handle_space_success);else throw r&&r({status:"error",message:"Could not load this space.",load_status:"error",detail:"NOT_FOUND"}),Error(a)}}async config_success(e){if(this.config=e,this.api_prefix=e.api_prefix||"",typeof window<"u"&&typeof document<"u"&&window.location.protocol==="https:"&&(this.config.root=this.config.root.replace("http://","https://")),this.config.auth_required)return this.prepare_return_obj();try{this.api_info=await this.view_api()}catch(n){console.error(gvt+n.message)}return this.prepare_return_obj()}async handle_space_success(e){var n;if(!this)throw new Error(Qy);const{status_callback:i}=this.options;if(i&&i(e),e.status==="running")try{if(this.config=await this._resolve_config(),this.api_prefix=((n=this==null?void 0:this.config)==null?void 0:n.api_prefix)||"",!this.config)throw new Error(Qy);return await this.config_success(this.config)}catch(r){throw i&&i({status:"error",message:"Could not load this space.",load_status:"error",detail:"NOT_FOUND"}),r}}async component_server(e,n,i){var r;if(!this.config)throw new Error(Qy);const s={},{hf_token:a}=this.options,{session_hash:o}=this;a&&(s.Authorization=`Bearer ${this.options.hf_token}`);let c,l=this.config.components.find(h=>h.id===e);(r=l==null?void 0:l.props)!=null&&r.root_url?c=l.props.root_url:c=this.config.root;let u;if("binary"in i){u=new FormData;for(const h in i.data)h!=="binary"&&u.append(h,i.data[h]);u.set("component_id",e.toString()),u.set("fn_name",n),u.set("session_hash",o)}else u=JSON.stringify({data:i,component_id:e,fn_name:n,session_hash:o}),s["Content-Type"]="application/json";a&&(s.Authorization=`Bearer ${a}`);try{const h=await this.fetch(`${c}${this.api_prefix}/${hvt}/`,{method:"POST",body:u,headers:s,credentials:"include"});if(!h.ok)throw new Error("Could not connect to component server: "+h.statusText);return await h.json()}catch(h){console.warn(h)}}set_cookies(e){this.cookies=Xbe(e).join("; ")}prepare_return_obj(){return{config:this.config,predict:this.predict,submit:this.submit,view_api:this.view_api,component_server:this.component_server}}async connect_ws(e){return new Promise((n,i)=>{let r;try{r=new WebSocket(e)}catch{this.ws_map[e]="failed";return}r.onopen=()=>{n()},r.onerror=s=>{console.error("WebSocket error:",s),this.close_ws(e),this.ws_map[e]="failed",n()},r.onclose=()=>{delete this.ws_map[e],this.ws_map[e]="failed"},r.onmessage=s=>{},this.ws_map[e]=r})}async send_ws_message(e,n){e in this.ws_map||await this.connect_ws(e);const i=this.ws_map[e];i instanceof WebSocket?i.send(JSON.stringify(n)):this.post_data(e,n)}async close_ws(e){if(e in this.ws_map){const n=this.ws_map[e];n instanceof WebSocket&&(n.close(),delete this.ws_map[e])}}}function f1(t){"@babel/helpers - typeof";return f1=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},f1(t)}function Xf(){Xf=function(){return e};var t,e={},n=Object.prototype,i=n.hasOwnProperty,r=Object.defineProperty||function(V,J,X){V[J]=X.value},s=typeof Symbol=="function"?Symbol:{},a=s.iterator||"@@iterator",o=s.asyncIterator||"@@asyncIterator",c=s.toStringTag||"@@toStringTag";function l(V,J,X){return Object.defineProperty(V,J,{value:X,enumerable:!0,configurable:!0,writable:!0}),V[J]}try{l({},"")}catch{l=function(X,ee,oe){return X[ee]=oe}}function u(V,J,X,ee){var oe=J&&J.prototype instanceof v?J:v,fe=Object.create(oe.prototype),Re=new Y(ee||[]);return r(fe,"_invoke",{value:U(V,X,Re)}),fe}function h(V,J,X){try{return{type:"normal",arg:V.call(J,X)}}catch(ee){return{type:"throw",arg:ee}}}e.wrap=u;var f="suspendedStart",d="suspendedYield",p="executing",g="completed",y={};function v(){}function b(){}function T(){}var x={};l(x,a,function(){return this});var M=Object.getPrototypeOf,R=M&&M(M(ie([])));R&&R!==n&&i.call(R,a)&&(x=R);var I=T.prototype=v.prototype=Object.create(x);function k(V){["next","throw","return"].forEach(function(J){l(V,J,function(X){return this._invoke(J,X)})})}function P(V,J){function X(oe,fe,Re,He){var Te=h(V[oe],V,fe);if(Te.type!=="throw"){var Le=Te.arg,we=Le.value;return we&&f1(we)=="object"&&i.call(we,"__await")?J.resolve(we.__await).then(function(Ce){X("next",Ce,Re,He)},function(Ce){X("throw",Ce,Re,He)}):J.resolve(we).then(function(Ce){Le.value=Ce,Re(Le)},function(Ce){return X("throw",Ce,Re,He)})}He(Te.arg)}var ee;r(this,"_invoke",{value:function(fe,Re){function He(){return new J(function(Te,Le){X(fe,Re,Te,Le)})}return ee=ee?ee.then(He,He):He()}})}function U(V,J,X){var ee=f;return function(oe,fe){if(ee===p)throw Error("Generator is already running");if(ee===g){if(oe==="throw")throw fe;return{value:t,done:!0}}for(X.method=oe,X.arg=fe;;){var Re=X.delegate;if(Re){var He=G(Re,X);if(He){if(He===y)continue;return He}}if(X.method==="next")X.sent=X._sent=X.arg;else if(X.method==="throw"){if(ee===f)throw ee=g,X.arg;X.dispatchException(X.arg)}else X.method==="return"&&X.abrupt("return",X.arg);ee=p;var Te=h(V,J,X);if(Te.type==="normal"){if(ee=X.done?g:d,Te.arg===y)continue;return{value:Te.arg,done:X.done}}Te.type==="throw"&&(ee=g,X.method="throw",X.arg=Te.arg)}}}function G(V,J){var X=J.method,ee=V.iterator[X];if(ee===t)return J.delegate=null,X==="throw"&&V.iterator.return&&(J.method="return",J.arg=t,G(V,J),J.method==="throw")||X!=="return"&&(J.method="throw",J.arg=new TypeError("The iterator does not provide a '"+X+"' method")),y;var oe=h(ee,V.iterator,J.arg);if(oe.type==="throw")return J.method="throw",J.arg=oe.arg,J.delegate=null,y;var fe=oe.arg;return fe?fe.done?(J[V.resultName]=fe.value,J.next=V.nextLoc,J.method!=="return"&&(J.method="next",J.arg=t),J.delegate=null,y):fe:(J.method="throw",J.arg=new TypeError("iterator result is not an object"),J.delegate=null,y)}function $(V){var J={tryLoc:V[0]};1 in V&&(J.catchLoc=V[1]),2 in V&&(J.finallyLoc=V[2],J.afterLoc=V[3]),this.tryEntries.push(J)}function q(V){var J=V.completion||{};J.type="normal",delete J.arg,V.completion=J}function Y(V){this.tryEntries=[{tryLoc:"root"}],V.forEach($,this),this.reset(!0)}function ie(V){if(V||V===""){var J=V[a];if(J)return J.call(V);if(typeof V.next=="function")return V;if(!isNaN(V.length)){var X=-1,ee=function oe(){for(;++X<V.length;)if(i.call(V,X))return oe.value=V[X],oe.done=!1,oe;return oe.value=t,oe.done=!0,oe};return ee.next=ee}}throw new TypeError(f1(V)+" is not iterable")}return b.prototype=T,r(I,"constructor",{value:T,configurable:!0}),r(T,"constructor",{value:b,configurable:!0}),b.displayName=l(T,c,"GeneratorFunction"),e.isGeneratorFunction=function(V){var J=typeof V=="function"&&V.constructor;return!!J&&(J===b||(J.displayName||J.name)==="GeneratorFunction")},e.mark=function(V){return Object.setPrototypeOf?Object.setPrototypeOf(V,T):(V.__proto__=T,l(V,c,"GeneratorFunction")),V.prototype=Object.create(I),V},e.awrap=function(V){return{__await:V}},k(P.prototype),l(P.prototype,o,function(){return this}),e.AsyncIterator=P,e.async=function(V,J,X,ee,oe){oe===void 0&&(oe=Promise);var fe=new P(u(V,J,X,ee),oe);return e.isGeneratorFunction(J)?fe:fe.next().then(function(Re){return Re.done?Re.value:fe.next()})},k(I),l(I,c,"Generator"),l(I,a,function(){return this}),l(I,"toString",function(){return"[object Generator]"}),e.keys=function(V){var J=Object(V),X=[];for(var ee in J)X.push(ee);return X.reverse(),function oe(){for(;X.length;){var fe=X.pop();if(fe in J)return oe.value=fe,oe.done=!1,oe}return oe.done=!0,oe}},e.values=ie,Y.prototype={constructor:Y,reset:function(J){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(q),!J)for(var X in this)X.charAt(0)==="t"&&i.call(this,X)&&!isNaN(+X.slice(1))&&(this[X]=t)},stop:function(){this.done=!0;var J=this.tryEntries[0].completion;if(J.type==="throw")throw J.arg;return this.rval},dispatchException:function(J){if(this.done)throw J;var X=this;function ee(Le,we){return Re.type="throw",Re.arg=J,X.next=Le,we&&(X.method="next",X.arg=t),!!we}for(var oe=this.tryEntries.length-1;oe>=0;--oe){var fe=this.tryEntries[oe],Re=fe.completion;if(fe.tryLoc==="root")return ee("end");if(fe.tryLoc<=this.prev){var He=i.call(fe,"catchLoc"),Te=i.call(fe,"finallyLoc");if(He&&Te){if(this.prev<fe.catchLoc)return ee(fe.catchLoc,!0);if(this.prev<fe.finallyLoc)return ee(fe.finallyLoc)}else if(He){if(this.prev<fe.catchLoc)return ee(fe.catchLoc,!0)}else{if(!Te)throw Error("try statement without catch or finally");if(this.prev<fe.finallyLoc)return ee(fe.finallyLoc)}}}},abrupt:function(J,X){for(var ee=this.tryEntries.length-1;ee>=0;--ee){var oe=this.tryEntries[ee];if(oe.tryLoc<=this.prev&&i.call(oe,"finallyLoc")&&this.prev<oe.finallyLoc){var fe=oe;break}}fe&&(J==="break"||J==="continue")&&fe.tryLoc<=X&&X<=fe.finallyLoc&&(fe=null);var Re=fe?fe.completion:{};return Re.type=J,Re.arg=X,fe?(this.method="next",this.next=fe.finallyLoc,y):this.complete(Re)},complete:function(J,X){if(J.type==="throw")throw J.arg;return J.type==="break"||J.type==="continue"?this.next=J.arg:J.type==="return"?(this.rval=this.arg=J.arg,this.method="return",this.next="end"):J.type==="normal"&&X&&(this.next=X),y},finish:function(J){for(var X=this.tryEntries.length-1;X>=0;--X){var ee=this.tryEntries[X];if(ee.finallyLoc===J)return this.complete(ee.completion,ee.afterLoc),q(ee),y}},catch:function(J){for(var X=this.tryEntries.length-1;X>=0;--X){var ee=this.tryEntries[X];if(ee.tryLoc===J){var oe=ee.completion;if(oe.type==="throw"){var fe=oe.arg;q(ee)}return fe}}throw Error("illegal catch attempt")},delegateYield:function(J,X,ee){return this.delegate={iterator:ie(J),resultName:X,nextLoc:ee},this.method==="next"&&(this.arg=t),y}},e}function Nse(t,e,n,i,r,s,a){try{var o=t[s](a),c=o.value}catch(l){return void n(l)}o.done?e(c):Promise.resolve(c).then(i,r)}function lC(t){return function(){var e=this,n=arguments;return new Promise(function(i,r){var s=t.apply(e,n);function a(c){Nse(s,i,r,a,o,"next",c)}function o(c){Nse(s,i,r,a,o,"throw",c)}a(void 0)})}}function s_t(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function a_t(t,e){if(f1(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(f1(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Qbe(t){var e=a_t(t,"string");return f1(e)=="symbol"?e:e+""}function o_t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,Qbe(i.key),i)}}function c_t(t,e,n){return e&&o_t(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t}function xg(t,e,n){return(e=Qbe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}const H2={"ar-SA":["ar-SA-HamedNeural","ar-SA-ZariyahNeural"],"de-DE":["de-DE-AmalaNeural","de-DE-ConradNeural","de-DE-KatjaNeural","de-DE-KillianNeural"],"en-US":["en-US-AriaNeural","en-US-AnaNeural","en-US-ChristopherNeural","en-US-EricNeural","en-US-GuyNeural","en-US-JennyNeural","en-US-MichelleNeural","en-US-RogerNeural","en-US-SteffanNeural"],"es-ES":["es-ES-AlvaroNeural","es-ES-ElviraNeural"],"fr-FR":["fr-FR-DeniseNeural","fr-FR-EloiseNeural","fr-FR-HenriNeural"],"ja-JP":["ja-JP-KeitaNeural","ja-JP-NanamiNeural"],"ko-KR":["ko-KR-InJoonNeural","ko-KR-SunHiNeural"],"pt-BR":["pt-BR-AntonioNeural","pt-BR-FranciscaNeural"],"ru-RU":["ru-RU-DmitryNeural","ru-RU-SvetlanaNeural"],"zh-CN":["zh-CN-XiaoxiaoNeural","zh-CN-XiaoyiNeural","zh-CN-YunjianNeural","zh-CN-liaoning-XiaobeiNeural","zh-CN-shaanxi-XiaoniNeural","zh-CN-YunxiNeural","zh-CN-YunxiaNeural","zh-CN-YunyangNeural"],"zh-TW":["zh-TW-HsiaoChenNeural","zh-TW-YunJheNeural","zh-TW-HsiaoYuNeural"]},j2={"ar-SA-HamedNeural":"حامد","ar-SA-ZariyahNeural":"زارية","de-DE-AmalaNeural":"Amala","de-DE-BerndNeural":"Bernd","de-DE-ChristophNeural":"Christoph","de-DE-ConradNeural":"Conrad","de-DE-ElkeNeural":"Elke","de-DE-GiselaNeural":"Gisela","de-DE-KasperNeural":"Kasper","de-DE-KatjaNeural":"Katja","de-DE-KillianNeural":"Killian","de-DE-KlarissaNeural":"Klarissa","de-DE-KlausNeural":"Klaus","de-DE-LouisaNeural":"Louisa","de-DE-MajaNeural":"Maja","de-DE-RalfNeural":"Ralf","de-DE-TanjaNeural":"Tanja","en-US-AIGenerate1Neural":"AIGenerate1","en-US-AIGenerate2Neural":"AIGenerate2","en-US-AmberNeural":"Amber","en-US-AnaNeural":"Ana","en-US-AndrewNeural":"Andrew","en-US-AriaNeural":"Aria","en-US-AshleyNeural":"Ashley","en-US-BlueNeural":"Blue","en-US-BrandonNeural":"Brandon","en-US-BrianNeural":"Brian","en-US-ChristopherNeural":"Christopher","en-US-CoraNeural":"Cora","en-US-DavisNeural":"Davis","en-US-ElizabethNeural":"Elizabeth","en-US-EmmaNeural":"Emma","en-US-EricNeural":"Eric","en-US-GuyNeural":"Guy","en-US-JacobNeural":"Jacob","en-US-JaneNeural":"Jane","en-US-JasonNeural":"Jason","en-US-JennyMultilingualNeural":"Jenny Multilingual","en-US-JennyMultilingualV2Neural":"Jenny Multilingual V2","en-US-JennyNeural":"Jenny","en-US-MichelleNeural":"Michelle","en-US-MonicaNeural":"Monica","en-US-NancyNeural":"Nancy","en-US-RogerNeural":"Roger","en-US-RyanMultilingualNeural":"Ryan Multilingual","en-US-SaraNeural":"Sara","en-US-SteffanNeural":"Steffan","en-US-TonyNeural":"Tony","es-ES-AbrilNeural":"Abril","es-ES-AlvaroNeural":"Álvaro","es-ES-ArnauNeural":"Arnau","es-ES-DarioNeural":"Dario","es-ES-EliasNeural":"Elias","es-ES-ElviraNeural":"Elvira","es-ES-EstrellaNeural":"Estrella","es-ES-IreneNeural":"Irene","es-ES-LaiaNeural":"Laia","es-ES-LiaNeural":"Lia","es-ES-NilNeural":"Nil","es-ES-SaulNeural":"Saul","es-ES-TeoNeural":"Teo","es-ES-TrianaNeural":"Triana","es-ES-VeraNeural":"Vera","fr-FR-AlainNeural":"Alain","fr-FR-BrigitteNeural":"Brigitte","fr-FR-CelesteNeural":"Celeste","fr-FR-ClaudeNeural":"Claude","fr-FR-CoralieNeural":"Coralie","fr-FR-DeniseNeural":"Denise","fr-FR-EloiseNeural":"Eloise","fr-FR-HenriNeural":"Henri","fr-FR-JacquelineNeural":"Jacqueline","fr-FR-JeromeNeural":"Jerome","fr-FR-JosephineNeural":"Josephine","fr-FR-MauriceNeural":"Maurice","fr-FR-YvesNeural":"Yves","fr-FR-YvetteNeural":"Yvette","ja-JP-AoiNeural":"碧衣","ja-JP-DaichiNeural":"大智","ja-JP-KeitaNeural":"圭太","ja-JP-MayuNeural":"真夕","ja-JP-NanamiNeural":"七海","ja-JP-NaokiNeural":"直紀","ja-JP-ShioriNeural":"志織","ko-KR-BongJinNeural":"봉진","ko-KR-GookMinNeural":"국민","ko-KR-InJoonNeural":"인준","ko-KR-JiMinNeural":"지민","ko-KR-SeoHyeonNeural":"서현","ko-KR-SoonBokNeural":"순복","ko-KR-SunHiNeural":"선히","ko-KR-YuJinNeural":"유진","pt-BR-AntonioNeural":"Antônio","pt-BR-BrendaNeural":"Brenda","pt-BR-DonatoNeural":"Donato","pt-BR-ElzaNeural":"Elza","pt-BR-FabioNeural":"Fabio","pt-BR-FranciscaNeural":"Francisca","pt-BR-GiovannaNeural":"Giovanna","pt-BR-HumbertoNeural":"Humberto","pt-BR-JulioNeural":"Julio","pt-BR-LeilaNeural":"Leila","pt-BR-LeticiaNeural":"Leticia","pt-BR-ManuelaNeural":"Manuela","pt-BR-NicolauNeural":"Nicolau","pt-BR-ValerioNeural":"Valerio","pt-BR-YaraNeural":"Yara","ru-RU-DariyaNeural":"Дария","ru-RU-DmitryNeural":"Дмитрий","ru-RU-SvetlanaNeural":"Светлана","wuu-CN-XiaotongNeural":"晓彤","wuu-CN-YunzheNeural":"云哲","yue-CN-XiaoMinNeural":"晓敏","yue-CN-YunSongNeural":"云松","zh-CN-XiaochenNeural":"晓辰","zh-CN-XiaohanNeural":"晓涵","zh-CN-XiaomengNeural":"晓梦","zh-CN-XiaomoNeural":"晓墨","zh-CN-XiaoqiuNeural":"晓秋","zh-CN-XiaorouNeural":"晓柔","zh-CN-XiaoruiNeural":"晓睿","zh-CN-XiaoshuangNeural":"晓双","zh-CN-XiaoxiaoNeural":"晓晓","zh-CN-XiaoxuanNeural":"晓萱","zh-CN-XiaoyanNeural":"晓颜","zh-CN-XiaoyiNeural":"晓伊","zh-CN-XiaoyouNeural":"晓悠","zh-CN-XiaozhenNeural":"晓甄","zh-CN-YunfengNeural":"云枫","zh-CN-YunhaoNeural":"云皓","zh-CN-YunjianNeural":"云健","zh-CN-YunjieNeural":"云杰","zh-CN-YunxiNeural":"云希","zh-CN-YunxiaNeural":"云夏","zh-CN-YunyangNeural":"云扬","zh-CN-YunyeNeural":"云野","zh-CN-YunzeNeural":"云泽","zh-CN-guangxi-YunqiNeural":"云奇","zh-CN-henan-YundengNeural":"云登","zh-CN-liaoning-XiaobeiNeural":"晓北","zh-CN-liaoning-YunbiaoNeural":"云彪","zh-CN-shaanxi-XiaoniNeural":"晓妮","zh-CN-shandong-YunxiangNeural":"云翔","zh-CN-sichuan-YunxiNeural":"云希","zh-TW-HsiaoChenNeural":"曉臻","zh-TW-HsiaoYuNeural":"曉雨","zh-TW-YunJheNeural":"雲哲"};var l_t=function(){var t=lC(Xf().mark(function e(n){var i;return Xf().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return i=new AudioContext,s.next=3,i.decodeAudioData(n);case 3:return s.abrupt("return",s.sent);case 4:case"end":return s.stop()}},e)}));return function(n){return t.apply(this,arguments)}}();function u_t(t){if(Array.isArray(t))return t}function h_t(t,e){var n=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(n!=null){var i,r,s,a,o=[],c=!0,l=!1;try{if(s=(n=n.call(t)).next,e!==0)for(;!(c=(i=s.call(n)).done)&&(o.push(i.value),o.length!==e);c=!0);}catch(u){l=!0,r=u}finally{try{if(!c&&n.return!=null&&(a=n.return(),Object(a)!==a))return}finally{if(l)throw r}}return o}}function Ise(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,i=Array(e);n<e;n++)i[n]=t[n];return i}function eEe(t,e){if(t){if(typeof t=="string")return Ise(t,e);var n={}.toString.call(t).slice(8,-1);return n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set"?Array.from(t):n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Ise(t,e):void 0}}function f_t(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function EK(t,e){return u_t(t)||h_t(t,e)||eEe(t,e)||f_t()}const d_t={"ar-SA":"العربية","de-DE":"Deutsch","en-US":"English","es-ES":"Español","fr-FR":"Français","ja-JP":"日本語","ko-KR":"한국어","pt-BR":"Português","ru-RU":"Русский","zh-CN":"简体中文","zh-TW":"繁體中文"};var p_t=function(){return Object.entries(d_t).map(function(e){var n=EK(e,2),i=n[0],r=n[1];return{label:r,value:i}})};const tEe="%[a-f0-9]{2}",kse=new RegExp("("+tEe+")|([^%]+?)","gi"),Dse=new RegExp("("+tEe+")+","gi");function m$(t,e){try{return[decodeURIComponent(t.join(""))]}catch{}if(t.length===1)return t;e=e||1;const n=t.slice(0,e),i=t.slice(e);return Array.prototype.concat.call([],m$(n),m$(i))}function m_t(t){try{return decodeURIComponent(t)}catch{let e=t.match(kse)||[];for(let n=1;n<e.length;n++)t=m$(e,n).join(""),e=t.match(kse)||[];return t}}function g_t(t){const e={"%FE%FF":"��","%FF%FE":"��"};let n=Dse.exec(t);for(;n;){try{e[n[0]]=decodeURIComponent(n[0])}catch{const r=m_t(n[0]);r!==n[0]&&(e[n[0]]=r)}n=Dse.exec(t)}e["%C2"]="�";const i=Object.keys(e);for(const r of i)t=t.replace(new RegExp(r,"g"),e[r]);return t}function v_t(t){if(typeof t!="string")throw new TypeError("Expected `encodedURI` to be of type `string`, got `"+typeof t+"`");try{return decodeURIComponent(t)}catch{return g_t(t)}}function __t(t,e){const n={};if(Array.isArray(e))for(const i of e){const r=Object.getOwnPropertyDescriptor(t,i);r!=null&&r.enumerable&&Object.defineProperty(n,i,r)}else for(const i of Reflect.ownKeys(t)){const r=Object.getOwnPropertyDescriptor(t,i);if(r.enumerable){const s=t[i];e(i,s,t)&&Object.defineProperty(n,i,r)}}return n}function nEe(t,e){if(!(typeof t=="string"&&typeof e=="string"))throw new TypeError("Expected the arguments to be of type `string`");if(t===""||e==="")return[];const n=t.indexOf(e);return n===-1?[]:[t.slice(0,n),t.slice(n+e.length)]}const y_t=t=>t==null,b_t=t=>encodeURIComponent(t).replaceAll(/[!'()*]/g,e=>`%${e.charCodeAt(0).toString(16).toUpperCase()}`),g$=Symbol("encodeFragmentIdentifier");function E_t(t){switch(t.arrayFormat){case"index":return e=>(n,i)=>{const r=n.length;return i===void 0||t.skipNull&&i===null||t.skipEmptyString&&i===""?n:i===null?[...n,[cc(e,t),"[",r,"]"].join("")]:[...n,[cc(e,t),"[",cc(r,t),"]=",cc(i,t)].join("")]};case"bracket":return e=>(n,i)=>i===void 0||t.skipNull&&i===null||t.skipEmptyString&&i===""?n:i===null?[...n,[cc(e,t),"[]"].join("")]:[...n,[cc(e,t),"[]=",cc(i,t)].join("")];case"colon-list-separator":return e=>(n,i)=>i===void 0||t.skipNull&&i===null||t.skipEmptyString&&i===""?n:i===null?[...n,[cc(e,t),":list="].join("")]:[...n,[cc(e,t),":list=",cc(i,t)].join("")];case"comma":case"separator":case"bracket-separator":{const e=t.arrayFormat==="bracket-separator"?"[]=":"=";return n=>(i,r)=>r===void 0||t.skipNull&&r===null||t.skipEmptyString&&r===""?i:(r=r===null?"":r,i.length===0?[[cc(n,t),e,cc(r,t)].join("")]:[[i,cc(r,t)].join(t.arrayFormatSeparator)])}default:return e=>(n,i)=>i===void 0||t.skipNull&&i===null||t.skipEmptyString&&i===""?n:i===null?[...n,cc(e,t)]:[...n,[cc(e,t),"=",cc(i,t)].join("")]}}function S_t(t){let e;switch(t.arrayFormat){case"index":return(n,i,r)=>{if(e=/\[(\d*)]$/.exec(n),n=n.replace(/\[\d*]$/,""),!e){r[n]=i;return}r[n]===void 0&&(r[n]={}),r[n][e[1]]=i};case"bracket":return(n,i,r)=>{if(e=/(\[])$/.exec(n),n=n.replace(/\[]$/,""),!e){r[n]=i;return}if(r[n]===void 0){r[n]=[i];return}r[n]=[...r[n],i]};case"colon-list-separator":return(n,i,r)=>{if(e=/(:list)$/.exec(n),n=n.replace(/:list$/,""),!e){r[n]=i;return}if(r[n]===void 0){r[n]=[i];return}r[n]=[...r[n],i]};case"comma":case"separator":return(n,i,r)=>{const s=typeof i=="string"&&i.includes(t.arrayFormatSeparator),a=typeof i=="string"&&!s&&Vv(i,t).includes(t.arrayFormatSeparator);i=a?Vv(i,t):i;const o=s||a?i.split(t.arrayFormatSeparator).map(c=>Vv(c,t)):i===null?i:Vv(i,t);r[n]=o};case"bracket-separator":return(n,i,r)=>{const s=/(\[])$/.test(n);if(n=n.replace(/\[]$/,""),!s){r[n]=i&&Vv(i,t);return}const a=i===null?[]:Vv(i,t).split(t.arrayFormatSeparator);if(r[n]===void 0){r[n]=a;return}r[n]=[...r[n],...a]};default:return(n,i,r)=>{if(r[n]===void 0){r[n]=i;return}r[n]=[...[r[n]].flat(),i]}}}function iEe(t){if(typeof t!="string"||t.length!==1)throw new TypeError("arrayFormatSeparator must be single character string")}function cc(t,e){return e.encode?e.strict?b_t(t):encodeURIComponent(t):t}function Vv(t,e){return e.decode?v_t(t):t}function rEe(t){return Array.isArray(t)?t.sort():typeof t=="object"?rEe(Object.keys(t)).sort((e,n)=>Number(e)-Number(n)).map(e=>t[e]):t}function sEe(t){const e=t.indexOf("#");return e!==-1&&(t=t.slice(0,e)),t}function T_t(t){let e="";const n=t.indexOf("#");return n!==-1&&(e=t.slice(n)),e}function Pse(t,e,n){return n==="string"&&typeof t=="string"?t:typeof n=="function"&&typeof t=="string"?n(t):e.parseBooleans&&t!==null&&(t.toLowerCase()==="true"||t.toLowerCase()==="false")?t.toLowerCase()==="true":n==="number"&&!Number.isNaN(Number(t))&&typeof t=="string"&&t.trim()!==""||e.parseNumbers&&!Number.isNaN(Number(t))&&typeof t=="string"&&t.trim()!==""?Number(t):t}function SK(t){t=sEe(t);const e=t.indexOf("?");return e===-1?"":t.slice(e+1)}function TK(t,e){e={decode:!0,sort:!0,arrayFormat:"none",arrayFormatSeparator:",",parseNumbers:!1,parseBooleans:!1,types:Object.create(null),...e},iEe(e.arrayFormatSeparator);const n=S_t(e),i=Object.create(null);if(typeof t!="string"||(t=t.trim().replace(/^[?#&]/,""),!t))return i;for(const r of t.split("&")){if(r==="")continue;const s=e.decode?r.replaceAll("+"," "):r;let[a,o]=nEe(s,"=");a===void 0&&(a=s),o=o===void 0?null:["comma","separator","bracket-separator"].includes(e.arrayFormat)?o:Vv(o,e),n(Vv(a,e),o,i)}for(const[r,s]of Object.entries(i))if(typeof s=="object"&&s!==null&&e.types[r]!=="string")for(const[a,o]of Object.entries(s)){const c=e.types[r]?e.types[r].replace("[]",""):void 0;s[a]=Pse(o,e,c)}else typeof s=="object"&&s!==null&&e.types[r]==="string"?i[r]=Object.values(s).join(e.arrayFormatSeparator):i[r]=Pse(s,e,e.types[r]);return e.sort===!1?i:(e.sort===!0?Object.keys(i).sort():Object.keys(i).sort(e.sort)).reduce((r,s)=>{const a=i[s];return r[s]=a&&typeof a=="object"&&!Array.isArray(a)?rEe(a):a,r},Object.create(null))}function aEe(t,e){if(!t)return"";e={encode:!0,strict:!0,arrayFormat:"none",arrayFormatSeparator:",",...e},iEe(e.arrayFormatSeparator);const n=a=>e.skipNull&&y_t(t[a])||e.skipEmptyString&&t[a]==="",i=E_t(e),r={};for(const[a,o]of Object.entries(t))n(a)||(r[a]=o);const s=Object.keys(r);return e.sort!==!1&&s.sort(e.sort),s.map(a=>{const o=t[a];return o===void 0?"":o===null?cc(a,e):Array.isArray(o)?o.length===0&&e.arrayFormat==="bracket-separator"?cc(a,e)+"[]":o.reduce(i(a),[]).join("&"):cc(a,e)+"="+cc(o,e)}).filter(a=>a.length>0).join("&")}function oEe(t,e){var r;e={decode:!0,...e};let[n,i]=nEe(t,"#");return n===void 0&&(n=t),{url:((r=n==null?void 0:n.split("?"))==null?void 0:r[0])??"",query:TK(SK(t),e),...e&&e.parseFragmentIdentifier&&i?{fragmentIdentifier:Vv(i,e)}:{}}}function cEe(t,e){e={encode:!0,strict:!0,[g$]:!0,...e};const n=sEe(t.url).split("?")[0]||"",i=SK(t.url),r={...TK(i,{sort:!1}),...t.query};let s=aEe(r,e);s&&(s=`?${s}`);let a=T_t(t.url);if(typeof t.fragmentIdentifier=="string"){const o=new URL(n);o.hash=t.fragmentIdentifier,a=e[g$]?o.hash:`#${t.fragmentIdentifier}`}return`${n}${s}${a}`}function lEe(t,e,n){n={parseFragmentIdentifier:!0,[g$]:!1,...n};const{url:i,query:r,fragmentIdentifier:s}=oEe(t,n);return cEe({url:i,query:__t(r,e),fragmentIdentifier:s},n)}function x_t(t,e,n){const i=Array.isArray(e)?r=>!e.includes(r):(r,s)=>!e(r,s);return lEe(t,i,n)}const w_t=Object.freeze(Object.defineProperty({__proto__:null,exclude:x_t,extract:SK,parse:TK,parseUrl:oEe,pick:lEe,stringify:aEe,stringifyUrl:cEe},Symbol.toStringTag,{value:"Module"}));var kl=[];for(var Mj=0;Mj<256;++Mj)kl.push((Mj+256).toString(16).slice(1));function C_t(t,e=0){return(kl[t[e+0]]+kl[t[e+1]]+kl[t[e+2]]+kl[t[e+3]]+"-"+kl[t[e+4]]+kl[t[e+5]]+"-"+kl[t[e+6]]+kl[t[e+7]]+"-"+kl[t[e+8]]+kl[t[e+9]]+"-"+kl[t[e+10]]+kl[t[e+11]]+kl[t[e+12]]+kl[t[e+13]]+kl[t[e+14]]+kl[t[e+15]]).toLowerCase()}var HP,A_t=new Uint8Array(16);function R_t(){if(!HP&&(HP=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!HP))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return HP(A_t)}var M_t=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto);const Lse={randomUUID:M_t};function O_t(t,e,n){if(Lse.randomUUID&&!e&&!t)return Lse.randomUUID();t=t||{};var i=t.random||(t.rng||R_t)();return i[6]=i[6]&15|64,i[8]=i[8]&63|128,C_t(i)}var N_t=function(e,n){var i=n.voice;return'<voice name="'.concat(i,'">').concat(e,"</voice>")},I_t=function(e,n){var i=n.style;return i?'<mstts:express-as style="'.concat(i,'">').concat(e,"</mstts:express-as>"):e},k_t=function(e,n){var i=n.pitch,r=n.rate;return!i&&!r?e:'<prosody pitch="'.concat(Math.floor((i||1)*100),'%" rate="').concat(Math.floor((r||1)*100),'%">').concat(e,"</prosody>")},D_t=function(e){return'<speak version="1.0" xmlns="http://www.w3.org/2001/10/synthesis" xmlns:mstts="https://www.w3.org/2001/mstts" xml:lang="en-US">'.concat(e,"</speak>")},P_t=function(e,n){var i=k_t(e,n);return i=I_t(i,n),i=N_t(i,n),i=D_t(i),i},Use=function(e,n){for(var i=[],r=0,s=Object.entries(e);r<s.length;r++){var a=EK(s[r],2),o=a[0],c=a[1];i.push("".concat(o,":").concat(c))}return i.push("",n),i.join(`\r
`)};function L_t(t,e){var n=typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=eEe(t))||e){n&&(t=n);var i=0,r=function(){};return{s:r,n:function(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}},e:function(l){throw l},f:r}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var s,a=!0,o=!1;return{s:function(){n=n.call(t)},n:function(){var l=n.next();return a=l.done,l},e:function(l){o=!0,s=l},f:function(){try{a||n.return==null||n.return()}finally{if(o)throw s}}}}var U_t=function(e){var n={},i=L_t(e.slice(0,e.indexOf(`\r
\r
`)).split(`\r
`)),r;try{for(i.s();!(r=i.n()).done;){var s=r.value,a=s.split(":",2),o=EK(a,2),c=o[0],l=o[1];n[c]=l}}catch(u){i.e(u)}finally{i.f()}return{data:e.slice(e.indexOf(`\r
\r
`)+4),headers:n}},B_t="wss://speech.platform.bing.com/consumer/speech/synthesize/readaloud/edge/v1",F_t="6A5AA1D4EAFF4E9FB37E23D68491D6F4",z_t=JSON.stringify({context:{synthesis:{audio:{metadataoptions:{sentenceBoundaryEnabled:!1,wordBoundaryEnabled:!0},outputFormat:"audio-24khz-48kbitrate-mono-mp3"}}}}),H_t=function(e){var n=new Date().toString(),i={"Content-Type":"application/json; charset=utf-8",Path:"speech.config","X-Timestamp":n},r={"Content-Type":"application/ssml+xml",Path:"ssml","X-RequestId":e,"X-Timestamp":n};return{configHeader:i,contentHeader:r}},uEe=function(){var t=lC(Xf().mark(function e(n){var i,r,s,a,o,c,l,u,h,f,d,p,g,y=arguments;return Xf().wrap(function(b){for(;;)switch(b.prev=b.next){case 0:return i=n.payload,r=y.length>1&&y[1]!==void 0?y[1]:{},s=r.proxyUrl,a=r.token,o=i.input,c=i.options,l=O_t().replaceAll("-",""),u=w_t.stringifyUrl({query:{ConnectionId:l,TrustedClientToken:a||F_t},url:s||B_t}),h=H_t(l),f=h.configHeader,d=h.contentHeader,p=Use(f,z_t),g=Use(d,P_t(o,c)),b.abrupt("return",new Promise(function(T,x){var M=new WebSocket(u);M.binaryType="arraybuffer";var R=function(){M.send(p),M.send(g)},I=new ArrayBuffer(0),k=function(){var U=lC(Xf().mark(function G($){var q,Y,ie,V,J,X,ee,oe;return Xf().wrap(function(Re){for(;;)switch(Re.prev=Re.next){case 0:if(typeof $.data!="string"){Re.next=13;break}q=U_t($.data),Y=q.headers,Re.t0=Y.Path,Re.next=Re.t0==="turn.end"?5:11;break;case 5:if(M.close(),I.byteLength){Re.next=8;break}return Re.abrupt("return");case 8:return ie=new Response(I),T(ie),Re.abrupt("break",11);case 11:Re.next=14;break;case 13:$.data instanceof ArrayBuffer&&(V=new DataView($.data),J=V.getInt16(0),$.data.byteLength>J+2&&(X=$.data.slice(2+J),ee=new ArrayBuffer(I.byteLength+X.byteLength),oe=new Uint8Array(ee),oe.set(new Uint8Array(I),0),oe.set(new Uint8Array(X),I.byteLength),I=ee));case 14:case"end":return Re.stop()}},G)}));return function($){return U.apply(this,arguments)}}(),P=function(){x(new Error("WebSocket error occurred.")),M.close()};M.addEventListener("open",R),M.addEventListener("message",k),M.addEventListener("error",P)}));case 9:case"end":return b.stop()}},e)}));return function(n){return t.apply(this,arguments)}}(),j_t=function(e){var n=e&&H2[e]?H2[e]||[]:ef(Object.values(H2));return n.map(function(i){return{label:(j2==null?void 0:j2[i])||i,value:i}})},kk=function(){function t(){var e=this,n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},i=n.serviceUrl,r=n.locale,s=n.headers;s_t(this,t),xg(this,"locale",void 0),xg(this,"serviceUrl",void 0),xg(this,"headers",void 0),xg(this,"fetch",function(){var a=lC(Xf().mark(function o(c){var l;return Xf().wrap(function(h){for(;;)switch(h.prev=h.next){case 0:return h.next=2,e.serviceUrl?fetch(e.serviceUrl,{body:JSON.stringify(c),headers:e.headers,method:"POST"}):uEe({payload:c});case 2:return l=h.sent,h.abrupt("return",l);case 4:case"end":return h.stop()}},o)}));return function(o){return a.apply(this,arguments)}}()),xg(this,"create",function(){var a=lC(Xf().mark(function o(c){return Xf().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.abrupt("return",e.fetch(c));case 1:case"end":return u.stop()}},o)}));return function(o){return a.apply(this,arguments)}}()),xg(this,"createAudio",function(){var a=lC(Xf().mark(function o(c){var l,u;return Xf().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:return f.next=2,e.create(c);case 2:return l=f.sent,f.next=5,l.arrayBuffer();case 5:return u=f.sent,f.abrupt("return",l_t(u));case 7:case"end":return f.stop()}},o)}));return function(o){return a.apply(this,arguments)}}()),this.locale=r,this.serviceUrl=i,this.headers=s}return c_t(t,[{key:"voiceOptions",get:function(){return j_t(this.locale)}}]),t}();xg(kk,"localeOptions",p_t());xg(kk,"voiceList",H2);xg(kk,"voiceName",j2);xg(kk,"createRequest",uEe);let Oj;async function V_t(t,e){if(!se(t))return;se(Oj)||(Oj=new kk({locale:"en-US"}));const[n,i]=e,r=await Oj.createAudio({input:i,options:{voice:n||"en-US-GuyNeural"}});t.addttsaudiobuffer(r)}const Bse=new Map;async function G_t(t,e,n){var s,a;if(!se(e))return;const[i]=n,r=Bse.get(i);if(se(r))r.loaded&&e.addttsaudiobuffer(r);else{const c=await(await p$.connect("declare-lab/TangoFlux")).predict("/predict",[i,25,4.5,3]);if(Li(c.data)&&On((s=c.data[0])==null?void 0:s.url)){const l=(a=c.data[0])==null?void 0:a.url;Bse.set(i,new Us(l,()=>{e0(je,t,"loaded",`${l.substring(0,8)}...${l.slice(-8)}`)}))}}}const q_t=Date.now(),zd={get value(){return(Date.now()-q_t)/1e3%1e6}},$_t=120;let hEe=0;function xK(t){hEe=$_t/t,gK().bpm.value=t}xK(150);const f8={get value(){return hEe}};function d8(t){const e=t.clone();return e.uniforms.time=zd,e.uniforms.interval=f8,e}Ibe(new KA({latencyHint:"playback"}));L0t().catch(t=>{Ui(Yv,nr(),"audio",t.message)});let V2=!1;function NE(){V2||h0t().then(()=>{if(!V2){const t=gK();V2=!0,t.start(),e0(Yv,nr(),"audio is enabled!"),xK(107);try{const e=navigator;se(e.audioSession)&&(e.audioSession.type="playback")}catch{}ZBe(Yv,nr())}}).catch(t=>{Ui(Yv,nr(),"audio",t.message)})}let Xu,Fse="";function W_t(){return Xu==null?void 0:Xu.broadcastdestination}const Yv=yE("synth",[],t=>{if(Yv.session(t)&&(V2&&!se(Xu)&&(Xu=F0t()),!!se(Xu)))switch(t.target){case"audioenabled":cu(Yv,t.player,async()=>{await Bd(1e3),Vg(Yv,t.player,void 0,"text","audioenabled","")});break;case"bpm":pn(t.data)&&xK(t.data);break;case"playvolume":pn(t.data)&&Xu.setplayvolume(t.data);break;case"bgplayvolume":pn(t.data)&&Xu.setbgplayvolume(t.data);break;case"ttsvolume":pn(t.data)&&Xu.setttsvolume(t.data);break;case"focus":On(t.data)&&(Fse=t.data);break;case"play":if(Li(t.data)){const[e,n,i]=t.data;if(e&&e!==Fse)return;n.trim()===""?Xu.stopplay():Xu.addplay(n,i)}break;case"voice":if(Li(t.data)){const[e,n,i]=t.data;V0t(t.player,Xu,e,n,i)}break;case"voicefx":if(Li(t.data)){const[e,n,i,r]=t.data;K0t(t.player,Xu,e,n,i,r)}break;case"tts":cu(Yv,t.player,async()=>{Li(t.data)&&await V_t(Xu,t.data)});break;case"tta":cu(Yv,t.player,async()=>{Li(t.data)&&await G_t(t.player,Xu,t.data)});break}});function PN(){return PN=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)({}).hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t},PN.apply(null,arguments)}var Y_t=function(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:.01,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:1/(2*Math.PI);return i/Math.atan(1/n)*Math.atan(Math.sin(2*Math.PI*e*r)/n)},X_t=function(e){return 1/(1+e+.48*e*e+.235*e*e*e)};function p_(t,e,n){var i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:.25,r=arguments.length>4&&arguments[4]!==void 0?arguments[4]:.01,s=arguments.length>5&&arguments[5]!==void 0?arguments[5]:1/0,a=arguments.length>6&&arguments[6]!==void 0?arguments[6]:X_t,o=arguments.length>7&&arguments[7]!==void 0?arguments[7]:.001,c="velocity_"+e;if(t.__damp===void 0&&(t.__damp={}),t.__damp[c]===void 0&&(t.__damp[c]=0),Math.abs(t[e]-n)<=o)return t[e]=n,!1;i=Math.max(1e-4,i);var l=2/i,u=a(l*r),h=t[e]-n,f=n,d=s*i;h=Math.min(Math.max(h,-d),d),n=t[e]-h;var p=(t.__damp[c]+l*h)*r;t.__damp[c]=(t.__damp[c]-l*p)*u;var g=n+(h+p)*u;return f-t[e]>0==g>f&&(g=f,t.__damp[c]=(g-f)/r),t[e]=g,!0}function Nj(t,e,n,i,r,s,a,o){return p_(t,e,t[e]+iLe(t[e],n),i,r,s,a,o)}var Jx=new Ae,zse,Hse,jse;function X3(t,e,n,i,r,s,a){return typeof e=="number"?Jx.setScalar(e):Array.isArray(e)?Jx.set(e[0],e[1],e[2]):Jx.copy(e),zse=p_(t,"x",Jx.x,n,i,r,s,a),Hse=p_(t,"y",Jx.y,n,i,r,s,a),jse=p_(t,"z",Jx.z,n,i,r,s,a),zse||Hse||jse}var $R=new rf,Vse,Gse,qse;function K_t(t,e,n,i,r,s,a){return Array.isArray(e)?$R.set(e[0],e[1],e[2],e[3]):$R.copy(e),Vse=Nj(t,"x",$R.x,n,i,r,s,a),Gse=Nj(t,"y",$R.y,n,i,r,s,a),qse=Nj(t,"z",$R.z,n,i,r,s,a),Vse||Gse||qse}const $se=t=>Symbol.iterator in t,Wse=t=>"entries"in t,Yse=(t,e)=>{const n=t instanceof Map?t:new Map(t.entries()),i=e instanceof Map?e:new Map(e.entries());if(n.size!==i.size)return!1;for(const[r,s]of n)if(!Object.is(s,i.get(r)))return!1;return!0},Z_t=(t,e)=>{const n=t[Symbol.iterator](),i=e[Symbol.iterator]();let r=n.next(),s=i.next();for(;!r.done&&!s.done;){if(!Object.is(r.value,s.value))return!1;r=n.next(),s=i.next()}return!!r.done&&!!s.done};function J_t(t,e){return Object.is(t,e)?!0:typeof t!="object"||t===null||typeof e!="object"||e===null?!1:!$se(t)||!$se(e)?Yse({entries:()=>Object.entries(t)},{entries:()=>Object.entries(e)}):Wse(t)&&Wse(e)?Yse(t,e):Z_t(t,e)}function Sp(t){const e=Ug.useRef();return n=>{const i=t(n);return J_t(e.current,i)?e.current:e.current=i}}function wK(t,e,n){const i=oh(f=>f.size),r=oh(f=>f.viewport),s=typeof t=="number"?t:i.width*r.dpr,a=typeof e=="number"?e:i.height*r.dpr,o=(typeof t=="number"?n:t)||{},{samples:c=0,depth:l,...u}=o,h=Fe.useMemo(()=>{const f=new Vl(s,a,{minFilter:Ea,magFilter:Ea,type:lE,...u});return l&&(f.depthTexture=new bA(s,a,hu)),f.samples=c,f},[]);return Fe.useLayoutEffect(()=>{h.setSize(s,a),c&&(h.samples=c)},[c,h,s,a]),Fe.useEffect(()=>()=>h.dispose(),[]),h}const Q_t=t=>typeof t=="function",eyt=Fe.forwardRef(({envMap:t,resolution:e=256,frames:n=1/0,children:i,makeDefault:r,...s},a)=>{const o=oh(({set:y})=>y),c=oh(({camera:y})=>y),l=oh(({size:y})=>y),u=Fe.useRef(null);Fe.useImperativeHandle(a,()=>u.current,[]);const h=Fe.useRef(null),f=wK(e);Fe.useLayoutEffect(()=>{s.manual||u.current.updateProjectionMatrix()},[l,s]),Fe.useLayoutEffect(()=>{u.current.updateProjectionMatrix()}),Fe.useLayoutEffect(()=>{if(r){const y=c;return o(()=>({camera:u.current})),()=>o(()=>({camera:y}))}},[u,r,o]);let d=0,p=null;const g=Q_t(i);return gE(y=>{g&&(n===1/0||d<n)&&(h.current.visible=!1,y.gl.setRenderTarget(f),p=y.scene.background,t&&(y.scene.background=t),y.gl.render(y.scene,u.current),y.scene.background=p,y.gl.setRenderTarget(null),h.current.visible=!0,d++)}),Fe.createElement(Fe.Fragment,null,Fe.createElement("orthographicCamera",PN({left:l.width/-2,right:l.width/2,top:l.height/2,bottom:l.height/-2,ref:u},s),!g&&i),Fe.createElement("group",{ref:h},g&&i(f.texture)))}),tyt=t=>typeof t=="function",nyt=Fe.forwardRef(({envMap:t,resolution:e=256,frames:n=1/0,makeDefault:i,children:r,...s},a)=>{const o=oh(({set:y})=>y),c=oh(({camera:y})=>y),l=oh(({size:y})=>y),u=Fe.useRef(null);Fe.useImperativeHandle(a,()=>u.current,[]);const h=Fe.useRef(null),f=wK(e);Fe.useLayoutEffect(()=>{s.manual||(u.current.aspect=l.width/l.height)},[l,s]),Fe.useLayoutEffect(()=>{u.current.updateProjectionMatrix()});let d=0,p=null;const g=tyt(r);return gE(y=>{g&&(n===1/0||d<n)&&(h.current.visible=!1,y.gl.setRenderTarget(f),p=y.scene.background,t&&(y.scene.background=t),y.gl.render(y.scene,u.current),y.scene.background=p,y.gl.setRenderTarget(null),h.current.visible=!0,d++)}),Fe.useLayoutEffect(()=>{if(i){const y=c;return o(()=>({camera:u.current})),()=>o(()=>({camera:y}))}},[u,i,o]),Fe.createElement(Fe.Fragment,null,Fe.createElement("perspectiveCamera",PN({ref:u},s),!g&&r),Fe.createElement("group",{ref:h},g&&r(f.texture)))});var fEe={exports:{}};(function(t,e){(function(n,i){t.exports=i()})(jl,function(){var n=function(){function i(d){return a.appendChild(d.dom),d}function r(d){for(var p=0;p<a.children.length;p++)a.children[p].style.display=p===d?"block":"none";s=d}var s=0,a=document.createElement("div");a.style.cssText="position:fixed;top:0;left:0;cursor:pointer;opacity:0.9;z-index:10000",a.addEventListener("click",function(d){d.preventDefault(),r(++s%a.children.length)},!1);var o=(performance||Date).now(),c=o,l=0,u=i(new n.Panel("FPS","#0ff","#002")),h=i(new n.Panel("MS","#0f0","#020"));if(self.performance&&self.performance.memory)var f=i(new n.Panel("MB","#f08","#201"));return r(0),{REVISION:16,dom:a,addPanel:i,showPanel:r,begin:function(){o=(performance||Date).now()},end:function(){l++;var d=(performance||Date).now();if(h.update(d-o,200),d>c+1e3&&(u.update(1e3*l/(d-c),100),c=d,l=0,f)){var p=performance.memory;f.update(p.usedJSHeapSize/1048576,p.jsHeapSizeLimit/1048576)}return d},update:function(){o=this.end()},domElement:a,setMode:r}};return n.Panel=function(i,r,s){var a=1/0,o=0,c=Math.round,l=c(window.devicePixelRatio||1),u=80*l,h=48*l,f=3*l,d=2*l,p=3*l,g=15*l,y=74*l,v=30*l,b=document.createElement("canvas");b.width=u,b.height=h,b.style.cssText="width:80px;height:48px";var T=b.getContext("2d");return T.font="bold "+9*l+"px Helvetica,Arial,sans-serif",T.textBaseline="top",T.fillStyle=s,T.fillRect(0,0,u,h),T.fillStyle=r,T.fillText(i,f,d),T.fillRect(p,g,y,v),T.fillStyle=s,T.globalAlpha=.9,T.fillRect(p,g,y,v),{dom:b,update:function(x,M){a=Math.min(a,x),o=Math.max(o,x),T.fillStyle=s,T.globalAlpha=1,T.fillRect(0,0,u,g),T.fillStyle=r,T.fillText(c(x)+" "+i+" ("+c(a)+"-"+c(o)+")",f,d),T.drawImage(b,p+l,g,y-l,v,p,g,y-l,v),T.fillRect(p+y-l,g,l,v),T.fillStyle=s,T.globalAlpha=.9,T.fillRect(p+y-l,g,l,c((1-x/M)*v))}}},n})})(fEe);var iyt=fEe.exports;const ryt=Yc(iyt);function Ij(t,e,n,i){return new(n||(n=Promise))(function(r,s){function a(l){try{c(i.next(l))}catch(u){s(u)}}function o(l){try{c(i.throw(l))}catch(u){s(u)}}function c(l){var u;l.done?r(l.value):(u=l.value,u instanceof n?u:new n(function(h){h(u)})).then(a,o)}c((i=i.apply(t,[])).next())})}const syt=["geforce 320m","geforce 8600","geforce 8600m gt","geforce 8800 gs","geforce 8800 gt","geforce 9400","geforce 9400m g","geforce 9400m","geforce 9600m gt","geforce 9600m","geforce fx go5200","geforce gt 120","geforce gt 130","geforce gt 330m","geforce gtx 285","google swiftshader","intel g41","intel g45","intel gma 4500mhd","intel gma x3100","intel hd 3000","intel q45","legacy","mali-2","mali-3","mali-4","quadro fx 1500","quadro fx 4","quadro fx 5","radeon hd 2400","radeon hd 2600","radeon hd 4670","radeon hd 4850","radeon hd 4870","radeon hd 5670","radeon hd 5750","radeon hd 6290","radeon hd 6300","radeon hd 6310","radeon hd 6320","radeon hd 6490m","radeon hd 6630m","radeon hd 6750m","radeon hd 6770m","radeon hd 6970m","sgx 543","sgx543"];function Xse(t){return t=t.toLowerCase().replace(/.*angle ?\((.+)\)(?: on vulkan [0-9.]+)?$/i,"$1").replace(/\s(\d{1,2}gb|direct3d.+$)|\(r\)| \([^)]+\)$/g,"").replace(/(?:vulkan|opengl) \d+\.\d+(?:\.\d+)?(?: \((.*)\))?/,"$1")}const dEe=typeof window>"u",bg=(()=>{if(dEe)return;const{userAgent:t,platform:e,maxTouchPoints:n}=window.navigator,i=/(iphone|ipod|ipad)/i.test(t),r=e==="iPad"||e==="MacIntel"&&n>0&&!window.MSStream;return{isIpad:r,isMobile:/android/i.test(t)||i||r,isSafari12:/Version\/12.+Safari/.test(t),isFirefox:/Firefox/.test(t)}})();function ayt(t,e,n){if(!n)return[e];const i=function(l){const u=`
    precision highp float;
    attribute vec3 aPosition;
    varying float vvv;
    void main() {
      vvv = 0.31622776601683794;
      gl_Position = vec4(aPosition, 1.0);
    }
  `,h=`
    precision highp float;
    varying float vvv;
    void main() {
      vec4 enc = vec4(1.0, 255.0, 65025.0, 16581375.0) * vvv;
      enc = fract(enc);
      enc -= enc.yzww * vec4(1.0 / 255.0, 1.0 / 255.0, 1.0 / 255.0, 0.0);
      gl_FragColor = enc;
    }
  `,f=l.createShader(35633),d=l.createShader(35632),p=l.createProgram();if(!(d&&f&&p))return;l.shaderSource(f,u),l.shaderSource(d,h),l.compileShader(f),l.compileShader(d),l.attachShader(p,f),l.attachShader(p,d),l.linkProgram(p),l.detachShader(p,f),l.detachShader(p,d),l.deleteShader(f),l.deleteShader(d),l.useProgram(p);const g=l.createBuffer();l.bindBuffer(34962,g),l.bufferData(34962,new Float32Array([-1,-1,0,3,-1,0,-1,3,0]),35044);const y=l.getAttribLocation(p,"aPosition");l.vertexAttribPointer(y,3,5126,!1,0,0),l.enableVertexAttribArray(y),l.clearColor(1,1,1,1),l.clear(16384),l.viewport(0,0,1,1),l.drawArrays(4,0,3);const v=new Uint8Array(4);return l.readPixels(0,0,1,1,6408,5121,v),l.deleteProgram(p),l.deleteBuffer(g),v.join("")}(t),r="801621810",s="8016218135",a="80162181161",o=bg!=null&&bg.isIpad?[["a7",a,12],["a8",s,15],["a8x",s,15],["a9",s,15],["a9x",s,15],["a10",s,15],["a10x",s,15],["a12",r,15],["a12x",r,15],["a12z",r,15],["a14",r,15],["a15",r,15],["m1",r,15],["m2",r,15]]:[["a7",a,12],["a8",s,12],["a9",s,15],["a10",s,15],["a11",r,15],["a12",r,15],["a13",r,15],["a14",r,15],["a15",r,15],["a16",r,15],["a17",r,15]];let c;return i==="80162181255"?c=o.filter(([,,l])=>l>=14):(c=o.filter(([,l])=>l===i),c.length||(c=o)),c.map(([l])=>`apple ${l} gpu`)}class Kse extends Error{constructor(e){super(e),Object.setPrototypeOf(this,new.target.prototype)}}const kj=[],Zse=[];function oyt(t,e){if(t===e)return 0;const n=t;t.length>e.length&&(t=e,e=n);let i=t.length,r=e.length;for(;i>0&&t.charCodeAt(~-i)===e.charCodeAt(~-r);)i--,r--;let s,a=0;for(;a<i&&t.charCodeAt(a)===e.charCodeAt(a);)a++;if(i-=a,r-=a,i===0)return r;let o,c,l=0,u=0,h=0;for(;u<i;)Zse[u]=t.charCodeAt(a+u),kj[u]=++u;for(;h<r;)for(s=e.charCodeAt(a+h),o=h++,l=h,u=0;u<i;u++)c=s===Zse[u]?o:o+1,o=kj[u],l=kj[u]=o>l?c>l?l+1:c:c>o?o+1:c;return l}function cyt(t){return t!=null}const lyt=({mobileTiers:t=[0,15,30,60],desktopTiers:e=[0,15,30,60],override:n={},glContext:i,failIfMajorPerformanceCaveat:r=!1,benchmarksURL:s="https://unpkg.com/detect-gpu@5.0.56/dist/benchmarks"}={})=>Ij(void 0,void 0,void 0,function*(){const a={};if(dEe)return{tier:0,type:"SSR"};const{isIpad:o=!!(bg!=null&&bg.isIpad),isMobile:c=!!(bg!=null&&bg.isMobile),screenSize:l=window.screen,loadBenchmarks:u=M=>Ij(void 0,void 0,void 0,function*(){const R=yield fetch(`${s}/${M}`).then(I=>I.json());if(parseInt(R.shift().split(".")[0],10)<4)throw new Kse("Detect GPU benchmark data is out of date. Please update to version 4x");return R})}=n;let{renderer:h}=n;const f=(M,R,I,k,P)=>({device:P,fps:k,gpu:I,isMobile:c,tier:M,type:R});let d,p="";if(h)h=Xse(h),d=[h];else{const M=i||function(I,k=!1){const P={alpha:!1,antialias:!1,depth:!1,failIfMajorPerformanceCaveat:k,powerPreference:"high-performance",stencil:!1};I&&delete P.powerPreference;const U=window.document.createElement("canvas"),G=U.getContext("webgl",P)||U.getContext("experimental-webgl",P);return G??void 0}(bg==null?void 0:bg.isSafari12,r);if(!M)return f(0,"WEBGL_UNSUPPORTED");const R=bg!=null&&bg.isFirefox?null:M.getExtension("WEBGL_debug_renderer_info");if(h=R?M.getParameter(R.UNMASKED_RENDERER_WEBGL):M.getParameter(M.RENDERER),!h)return f(1,"FALLBACK");p=h,h=Xse(h),d=function(I,k,P){return k==="apple gpu"?ayt(I,k,P):[k]}(M,h,c)}const g=(yield Promise.all(d.map(function(M){var R;return Ij(this,void 0,void 0,function*(){const I=(He=>{const Te=c?["adreno","apple","mali-t","mali","nvidia","powervr","samsung"]:["intel","apple","amd","radeon","nvidia","geforce","adreno"];for(const Le of Te)if(He.includes(Le))return Le})(M);if(!I)return;const k=`${c?"m":"d"}-${I}${o?"-ipad":""}.json`,P=a[k]=(R=a[k])!==null&&R!==void 0?R:u(k);let U;try{U=yield P}catch(He){if(He instanceof Kse)throw He;return}const G=function(He){var Te;const Le=(He=He.replace(/\([^)]+\)/,"")).match(/\d+/)||He.match(/(\W|^)([A-Za-z]{1,3})(\W|$)/g);return(Te=Le==null?void 0:Le.join("").replace(/\W|amd/g,""))!==null&&Te!==void 0?Te:""}(M);let $=U.filter(([,He])=>He===G);$.length||($=U.filter(([He])=>He.includes(M)));const q=$.length;if(q===0)return;const Y=M.split(/[.,()\[\]/\s]/g).sort().filter((He,Te,Le)=>Te===0||He!==Le[Te-1]).join(" ");let ie,[V,,,,J]=q>1?$.map(He=>[He,oyt(Y,He[2])]).sort(([,He],[,Te])=>He-Te)[0][0]:$[0],X=Number.MAX_VALUE;const{devicePixelRatio:ee}=window,oe=l.width*ee*l.height*ee;for(const He of J){const[Te,Le]=He,we=Te*Le,Ce=Math.abs(oe-we);Ce<X&&(X=Ce,ie=He)}if(!ie)return;const[,,fe,Re]=ie;return[X,fe,V,Re]})}))).filter(cyt).sort(([M=Number.MAX_VALUE,R],[I=Number.MAX_VALUE,k])=>M===I?R-k:M-I);if(!g.length){const M=syt.find(R=>h.includes(R));return M?f(0,"BLOCKLISTED",M):f(1,"FALLBACK",`${h} (${p})`)}const[,y,v,b]=g[0];if(y===-1)return f(0,"BLOCKLISTED",v,y,b);const T=c?t:e;let x=0;for(let M=0;M<T.length;M++)y>=T[M]&&(x=M);return f(x,"BENCHMARK",v,y,b)}),uyt=t=>Ake(()=>lyt(t),["useDetectGPU"]),hyt=Fe.forwardRef(({children:t,compute:e,width:n,height:i,samples:r=8,renderPriority:s=0,eventPriority:a=0,frames:o=1/0,stencilBuffer:c=!1,depthBuffer:l=!0,generateMipmaps:u=!1,...h},f)=>{const{size:d,viewport:p}=oh(),g=wK((n||d.width)*p.dpr,(i||d.height)*p.dpr,{samples:r,stencilBuffer:c,depthBuffer:l,generateMipmaps:u}),[y]=Fe.useState(()=>new SC),v=Fe.useCallback((b,T,x)=>{var M,R;let I=(M=g.texture)==null||(M=M.__r3f.parent)==null?void 0:M.object;for(;I&&!(I instanceof qr);){var k;I=(k=I.__r3f.parent)==null?void 0:k.object}if(!I)return!1;x.raycaster.camera||x.events.compute(b,x,(R=x.previousRoot)==null?void 0:R.getState());const[P]=x.raycaster.intersectObject(I);if(!P)return!1;const U=P.uv;if(!U)return!1;T.raycaster.setFromCamera(T.pointer.set(U.x*2-1,U.y*2-1),T.camera)},[]);return Fe.useImperativeHandle(f,()=>g.texture,[g]),Fe.createElement(Fe.Fragment,null,sDe(Fe.createElement(fyt,{renderPriority:s,frames:o,fbo:g},t,Fe.createElement("group",{onPointerOver:()=>null})),y,{events:{compute:e||v,priority:a}}),Fe.createElement("primitive",PN({object:g.texture},h)))});function fyt({frames:t,renderPriority:e,children:n,fbo:i}){let r=0,s,a,o,c;return gE(l=>{(t===1/0||r<t)&&(s=l.gl.autoClear,a=l.gl.xr.enabled,o=l.gl.getRenderTarget(),c=l.gl.xr.isPresenting,l.gl.autoClear=!0,l.gl.xr.enabled=!1,l.gl.xr.isPresenting=!1,l.gl.setRenderTarget(i),l.gl.render(l.scene,l.camera),l.gl.setRenderTarget(o),l.gl.autoClear=s,l.gl.xr.enabled=a,l.gl.xr.isPresenting=c,r++)},e),Fe.createElement(Fe.Fragment,null,n)}/**
 * postprocessing v6.37.3 build Sun Apr 27 2025
 * https://github.com/pmndrs/postprocessing
 * Copyright 2015-2025 Raoul van Rüschen
 * @license Zlib
 */var Dj=1/1e3,dyt=1e3,pyt=class{constructor(){this.startTime=performance.now(),this.previousTime=0,this.currentTime=0,this._delta=0,this._elapsed=0,this._fixedDelta=1e3/60,this.timescale=1,this.useFixedDelta=!1,this._autoReset=!1}get autoReset(){return this._autoReset}set autoReset(t){typeof document<"u"&&document.hidden!==void 0&&(t?document.addEventListener("visibilitychange",this):document.removeEventListener("visibilitychange",this),this._autoReset=t)}get delta(){return this._delta*Dj}get fixedDelta(){return this._fixedDelta*Dj}set fixedDelta(t){this._fixedDelta=t*dyt}get elapsed(){return this._elapsed*Dj}update(t){this.useFixedDelta?this._delta=this.fixedDelta:(this.previousTime=this.currentTime,this.currentTime=(t!==void 0?t:performance.now())-this.startTime,this._delta=this.currentTime-this.previousTime),this._delta*=this.timescale,this._elapsed+=this._delta}reset(){this._delta=0,this._elapsed=0,this.currentTime=performance.now()-this.startTime}getDelta(){return this.delta}getElapsed(){return this.elapsed}handleEvent(t){document.hidden||(this.currentTime=performance.now()-this.startTime)}dispose(){this.autoReset=!1}},myt=(()=>{const t=new Float32Array([-1,-1,0,3,-1,0,-1,3,0]),e=new Float32Array([0,0,2,0,0,2]),n=new Qi;return n.setAttribute("position",new rr(t,3)),n.setAttribute("uv",new rr(e,2)),n})(),Om=class v${static get fullscreenGeometry(){return myt}constructor(e="Pass",n=new SC,i=new iI){this.name=e,this.renderer=null,this.scene=n,this.camera=i,this.screen=null,this.rtt=!0,this.needsSwap=!0,this.needsDepthTexture=!1,this.enabled=!0}get renderToScreen(){return!this.rtt}set renderToScreen(e){if(this.rtt===e){const n=this.fullscreenMaterial;n!==null&&(n.needsUpdate=!0),this.rtt=!e}}set mainScene(e){}set mainCamera(e){}setRenderer(e){this.renderer=e}isEnabled(){return this.enabled}setEnabled(e){this.enabled=e}get fullscreenMaterial(){return this.screen!==null?this.screen.material:null}set fullscreenMaterial(e){let n=this.screen;n!==null?n.material=e:(n=new jo(v$.fullscreenGeometry,e),n.frustumCulled=!1,this.scene===null&&(this.scene=new SC),this.scene.add(n),this.screen=n)}getFullscreenMaterial(){return this.fullscreenMaterial}setFullscreenMaterial(e){this.fullscreenMaterial=e}getDepthTexture(){return null}setDepthTexture(e,n=uE){}render(e,n,i,r,s){throw new Error("Render method not implemented!")}setSize(e,n){}initialize(e,n,i){}dispose(){for(const e of Object.keys(this)){const n=this[e];(n instanceof Vl||n instanceof Tl||n instanceof Ba||n instanceof v$)&&this[e].dispose()}this.fullscreenMaterial!==null&&this.fullscreenMaterial.dispose()}},gyt=class extends Om{constructor(){super("ClearMaskPass",null,null),this.needsSwap=!1}render(t,e,n,i,r){const s=t.state.buffers.stencil;s.setLocked(!1),s.setTest(!1)}},vyt=`#include <common>
#include <dithering_pars_fragment>
#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D inputBuffer;
#else
uniform lowp sampler2D inputBuffer;
#endif
uniform float opacity;varying vec2 vUv;void main(){vec4 texel=texture2D(inputBuffer,vUv);gl_FragColor=opacity*texel;
#include <colorspace_fragment>
#include <dithering_fragment>
}`,_yt="varying vec2 vUv;void main(){vUv=position.xy*0.5+0.5;gl_Position=vec4(position.xy,1.0,1.0);}",yyt=class extends Hc{constructor(){super({name:"CopyMaterial",uniforms:{inputBuffer:new Yi(null),opacity:new Yi(1)},blending:lp,toneMapped:!1,depthWrite:!1,depthTest:!1,fragmentShader:vyt,vertexShader:_yt})}set inputBuffer(t){this.uniforms.inputBuffer.value=t}setInputBuffer(t){this.uniforms.inputBuffer.value=t}getOpacity(t){return this.uniforms.opacity.value}setOpacity(t){this.uniforms.opacity.value=t}},byt=class extends Om{constructor(t,e=!0){super("CopyPass"),this.fullscreenMaterial=new yyt,this.needsSwap=!1,this.renderTarget=t,t===void 0&&(this.renderTarget=new Vl(1,1,{minFilter:Ea,magFilter:Ea,stencilBuffer:!1,depthBuffer:!1}),this.renderTarget.texture.name="CopyPass.Target"),this.autoResize=e}get resize(){return this.autoResize}set resize(t){this.autoResize=t}get texture(){return this.renderTarget.texture}getTexture(){return this.renderTarget.texture}setAutoResizeEnabled(t){this.autoResize=t}render(t,e,n,i,r){this.fullscreenMaterial.inputBuffer=e.texture,t.setRenderTarget(this.renderToScreen?null:this.renderTarget),t.render(this.scene,this.camera)}setSize(t,e){this.autoResize&&this.renderTarget.setSize(t,e)}initialize(t,e,n){n!==void 0&&(this.renderTarget.texture.type=n,n!==El?this.fullscreenMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1":t!==null&&t.outputColorSpace===ba&&(this.renderTarget.texture.colorSpace=ba))}},Jse=new yn,pEe=class extends Om{constructor(t=!0,e=!0,n=!1){super("ClearPass",null,null),this.needsSwap=!1,this.color=t,this.depth=e,this.stencil=n,this.overrideClearColor=null,this.overrideClearAlpha=-1}setClearFlags(t,e,n){this.color=t,this.depth=e,this.stencil=n}getOverrideClearColor(){return this.overrideClearColor}setOverrideClearColor(t){this.overrideClearColor=t}getOverrideClearAlpha(){return this.overrideClearAlpha}setOverrideClearAlpha(t){this.overrideClearAlpha=t}render(t,e,n,i,r){const s=this.overrideClearColor,a=this.overrideClearAlpha,o=t.getClearAlpha(),c=s!==null,l=a>=0;c?(t.getClearColor(Jse),t.setClearColor(s,l?a:o)):l&&t.setClearAlpha(a),t.setRenderTarget(this.renderToScreen?null:e),t.clear(this.color,this.depth,this.stencil),c?t.setClearColor(Jse,o):l&&t.setClearAlpha(o)}},Eyt=class extends Om{constructor(t,e){super("MaskPass",t,e),this.needsSwap=!1,this.clearPass=new pEe(!1,!1,!0),this.inverse=!1}set mainScene(t){this.scene=t}set mainCamera(t){this.camera=t}get inverted(){return this.inverse}set inverted(t){this.inverse=t}get clear(){return this.clearPass.enabled}set clear(t){this.clearPass.enabled=t}getClearPass(){return this.clearPass}isInverted(){return this.inverted}setInverted(t){this.inverted=t}render(t,e,n,i,r){const s=t.getContext(),a=t.state.buffers,o=this.scene,c=this.camera,l=this.clearPass,u=this.inverted?0:1,h=1-u;a.color.setMask(!1),a.depth.setMask(!1),a.color.setLocked(!0),a.depth.setLocked(!0),a.stencil.setTest(!0),a.stencil.setOp(s.REPLACE,s.REPLACE,s.REPLACE),a.stencil.setFunc(s.ALWAYS,u,4294967295),a.stencil.setClear(h),a.stencil.setLocked(!0),this.clearPass.enabled&&(this.renderToScreen?l.render(t,null):(l.render(t,e),l.render(t,n))),this.renderToScreen?(t.setRenderTarget(null),t.render(o,c)):(t.setRenderTarget(e),t.render(o,c),t.setRenderTarget(n),t.render(o,c)),a.color.setLocked(!1),a.depth.setLocked(!1),a.stencil.setLocked(!1),a.stencil.setFunc(s.EQUAL,1,4294967295),a.stencil.setOp(s.KEEP,s.KEEP,s.KEEP),a.stencil.setLocked(!0)}},Syt=class{constructor(t=null,{depthBuffer:e=!0,stencilBuffer:n=!1,multisampling:i=0,frameBufferType:r}={}){this.renderer=null,this.inputBuffer=this.createBuffer(e,n,r,i),this.outputBuffer=this.inputBuffer.clone(),this.copyPass=new byt,this.depthTexture=null,this.passes=[],this.timer=new pyt,this.autoRenderToScreen=!0,this.setRenderer(t)}get multisampling(){return this.inputBuffer.samples||0}set multisampling(t){const e=this.inputBuffer,n=this.multisampling;n>0&&t>0?(this.inputBuffer.samples=t,this.outputBuffer.samples=t,this.inputBuffer.dispose(),this.outputBuffer.dispose()):n!==t&&(this.inputBuffer.dispose(),this.outputBuffer.dispose(),this.inputBuffer=this.createBuffer(e.depthBuffer,e.stencilBuffer,e.texture.type,t),this.inputBuffer.depthTexture=this.depthTexture,this.outputBuffer=this.inputBuffer.clone())}getTimer(){return this.timer}getRenderer(){return this.renderer}setRenderer(t){if(this.renderer=t,t!==null){const e=t.getSize(new Rt),n=t.getContext().getContextAttributes().alpha,i=this.inputBuffer.texture.type;i===El&&t.outputColorSpace===ba&&(this.inputBuffer.texture.colorSpace=ba,this.outputBuffer.texture.colorSpace=ba,this.inputBuffer.dispose(),this.outputBuffer.dispose()),t.autoClear=!1,this.setSize(e.width,e.height);for(const r of this.passes)r.initialize(t,n,i)}}replaceRenderer(t,e=!0){const n=this.renderer,i=n.domElement.parentNode;return this.setRenderer(t),e&&i!==null&&(i.removeChild(n.domElement),i.appendChild(t.domElement)),n}createDepthTexture(){const t=this.depthTexture=new bA;return this.inputBuffer.depthTexture=t,this.inputBuffer.dispose(),this.inputBuffer.stencilBuffer?(t.format=kT,t.type=IT):t.type=Jg,t}deleteDepthTexture(){if(this.depthTexture!==null){this.depthTexture.dispose(),this.depthTexture=null,this.inputBuffer.depthTexture=null,this.inputBuffer.dispose();for(const t of this.passes)t.setDepthTexture(null)}}createBuffer(t,e,n,i){const r=this.renderer,s=r===null?new Rt:r.getDrawingBufferSize(new Rt),a={minFilter:Ea,magFilter:Ea,stencilBuffer:e,depthBuffer:t,type:n},o=new Vl(s.width,s.height,a);return i>0&&(o.ignoreDepthForMultisampleCopy=!1,o.samples=i),n===El&&r!==null&&r.outputColorSpace===ba&&(o.texture.colorSpace=ba),o.texture.name="EffectComposer.Buffer",o.texture.generateMipmaps=!1,o}setMainScene(t){for(const e of this.passes)e.mainScene=t}setMainCamera(t){for(const e of this.passes)e.mainCamera=t}addPass(t,e){const n=this.passes,i=this.renderer,r=i.getDrawingBufferSize(new Rt),s=i.getContext().getContextAttributes().alpha,a=this.inputBuffer.texture.type;if(t.setRenderer(i),t.setSize(r.width,r.height),t.initialize(i,s,a),this.autoRenderToScreen&&(n.length>0&&(n[n.length-1].renderToScreen=!1),t.renderToScreen&&(this.autoRenderToScreen=!1)),e!==void 0?n.splice(e,0,t):n.push(t),this.autoRenderToScreen&&(n[n.length-1].renderToScreen=!0),t.needsDepthTexture||this.depthTexture!==null)if(this.depthTexture===null){const o=this.createDepthTexture();for(t of n)t.setDepthTexture(o)}else t.setDepthTexture(this.depthTexture)}removePass(t){const e=this.passes,n=e.indexOf(t);if(n!==-1&&e.splice(n,1).length>0){if(this.depthTexture!==null){const s=(o,c)=>o||c.needsDepthTexture;e.reduce(s,!1)||(t.getDepthTexture()===this.depthTexture&&t.setDepthTexture(null),this.deleteDepthTexture())}this.autoRenderToScreen&&n===e.length&&(t.renderToScreen=!1,e.length>0&&(e[e.length-1].renderToScreen=!0))}}removeAllPasses(){const t=this.passes;this.deleteDepthTexture(),t.length>0&&(this.autoRenderToScreen&&(t[t.length-1].renderToScreen=!1),this.passes=[])}render(t){const e=this.renderer,n=this.copyPass;let i=this.inputBuffer,r=this.outputBuffer,s=!1,a,o,c;t===void 0&&(this.timer.update(),t=this.timer.getDelta());for(const l of this.passes)l.enabled&&(l.render(e,i,r,t,s),l.needsSwap&&(s&&(n.renderToScreen=l.renderToScreen,a=e.getContext(),o=e.state.buffers.stencil,o.setFunc(a.NOTEQUAL,1,4294967295),n.render(e,i,r,t,s),o.setFunc(a.EQUAL,1,4294967295)),c=i,i=r,r=c),l instanceof Eyt?s=!0:l instanceof gyt&&(s=!1))}setSize(t,e,n){const i=this.renderer,r=i.getSize(new Rt);(t===void 0||e===void 0)&&(t=r.width,e=r.height),(r.width!==t||r.height!==e)&&i.setSize(t,e,n);const s=i.getDrawingBufferSize(new Rt);this.inputBuffer.setSize(s.width,s.height),this.outputBuffer.setSize(s.width,s.height);for(const a of this.passes)a.setSize(s.width,s.height)}reset(){this.dispose(),this.autoRenderToScreen=!0}dispose(){for(const t of this.passes)t.dispose();this.passes=[],this.inputBuffer!==null&&this.inputBuffer.dispose(),this.outputBuffer!==null&&this.outputBuffer.dispose(),this.deleteDepthTexture(),this.copyPass.dispose(),this.timer.dispose(),Om.fullscreenGeometry.dispose()}},jb={NONE:0,DEPTH:1,CONVOLUTION:2},as={FRAGMENT_HEAD:"FRAGMENT_HEAD",FRAGMENT_MAIN_UV:"FRAGMENT_MAIN_UV",FRAGMENT_MAIN_IMAGE:"FRAGMENT_MAIN_IMAGE",VERTEX_HEAD:"VERTEX_HEAD",VERTEX_MAIN_SUPPORT:"VERTEX_MAIN_SUPPORT"},Tyt=class{constructor(){this.shaderParts=new Map([[as.FRAGMENT_HEAD,null],[as.FRAGMENT_MAIN_UV,null],[as.FRAGMENT_MAIN_IMAGE,null],[as.VERTEX_HEAD,null],[as.VERTEX_MAIN_SUPPORT,null]]),this.defines=new Map,this.uniforms=new Map,this.blendModes=new Map,this.extensions=new Set,this.attributes=jb.NONE,this.varyings=new Set,this.uvTransformation=!1,this.readDepth=!1,this.colorSpace=Qg}},Pj=!1,Qse=class{constructor(t=null){this.originalMaterials=new Map,this.material=null,this.materials=null,this.materialsBackSide=null,this.materialsDoubleSide=null,this.materialsFlatShaded=null,this.materialsFlatShadedBackSide=null,this.materialsFlatShadedDoubleSide=null,this.setMaterial(t),this.meshCount=0,this.replaceMaterial=e=>{if(e.isMesh){let n;if(e.material.flatShading)switch(e.material.side){case dl:n=this.materialsFlatShadedDoubleSide;break;case Bc:n=this.materialsFlatShadedBackSide;break;default:n=this.materialsFlatShaded;break}else switch(e.material.side){case dl:n=this.materialsDoubleSide;break;case Bc:n=this.materialsBackSide;break;default:n=this.materials;break}this.originalMaterials.set(e,e.material),e.isSkinnedMesh?e.material=n[2]:e.isInstancedMesh?e.material=n[1]:e.material=n[0],++this.meshCount}}}cloneMaterial(t){if(!(t instanceof Hc))return t.clone();const e=t.uniforms,n=new Map;for(const r in e){const s=e[r].value;s.isRenderTargetTexture&&(e[r].value=null,n.set(r,s))}const i=t.clone();for(const r of n)e[r[0]].value=r[1],i.uniforms[r[0]].value=r[1];return i}setMaterial(t){if(this.disposeMaterials(),this.material=t,t!==null){const e=this.materials=[this.cloneMaterial(t),this.cloneMaterial(t),this.cloneMaterial(t)];for(const n of e)n.uniforms=Object.assign({},t.uniforms),n.side=Zg;e[2].skinning=!0,this.materialsBackSide=e.map(n=>{const i=this.cloneMaterial(n);return i.uniforms=Object.assign({},t.uniforms),i.side=Bc,i}),this.materialsDoubleSide=e.map(n=>{const i=this.cloneMaterial(n);return i.uniforms=Object.assign({},t.uniforms),i.side=dl,i}),this.materialsFlatShaded=e.map(n=>{const i=this.cloneMaterial(n);return i.uniforms=Object.assign({},t.uniforms),i.flatShading=!0,i}),this.materialsFlatShadedBackSide=e.map(n=>{const i=this.cloneMaterial(n);return i.uniforms=Object.assign({},t.uniforms),i.flatShading=!0,i.side=Bc,i}),this.materialsFlatShadedDoubleSide=e.map(n=>{const i=this.cloneMaterial(n);return i.uniforms=Object.assign({},t.uniforms),i.flatShading=!0,i.side=dl,i})}}render(t,e,n){const i=t.shadowMap.enabled;if(t.shadowMap.enabled=!1,Pj){const r=this.originalMaterials;this.meshCount=0,e.traverse(this.replaceMaterial),t.render(e,n);for(const s of r)s[0].material=s[1];this.meshCount!==r.size&&r.clear()}else{const r=e.overrideMaterial;e.overrideMaterial=this.material,t.render(e,n),e.overrideMaterial=r}t.shadowMap.enabled=i}disposeMaterials(){if(this.material!==null){const t=this.materials.concat(this.materialsBackSide).concat(this.materialsDoubleSide).concat(this.materialsFlatShaded).concat(this.materialsFlatShadedBackSide).concat(this.materialsFlatShadedDoubleSide);for(const e of t)e.dispose()}}dispose(){this.originalMaterials.clear(),this.disposeMaterials()}static get workaroundEnabled(){return Pj}static set workaroundEnabled(t){Pj=t}},ky=-1,uC=class extends cd{constructor(t,e=ky,n=ky,i=1){super(),this.resizable=t,this.baseSize=new Rt(1,1),this.preferredSize=new Rt(e,n),this.target=this.preferredSize,this.s=i,this.effectiveSize=new Rt,this.addEventListener("change",()=>this.updateEffectiveSize()),this.updateEffectiveSize()}updateEffectiveSize(){const t=this.baseSize,e=this.preferredSize,n=this.effectiveSize,i=this.scale;e.width!==ky?n.width=e.width:e.height!==ky?n.width=Math.round(e.height*(t.width/Math.max(t.height,1))):n.width=Math.round(t.width*i),e.height!==ky?n.height=e.height:e.width!==ky?n.height=Math.round(e.width/Math.max(t.width/Math.max(t.height,1),1)):n.height=Math.round(t.height*i)}get width(){return this.effectiveSize.width}set width(t){this.preferredWidth=t}get height(){return this.effectiveSize.height}set height(t){this.preferredHeight=t}getWidth(){return this.width}getHeight(){return this.height}get scale(){return this.s}set scale(t){this.s!==t&&(this.s=t,this.preferredSize.setScalar(ky),this.dispatchEvent({type:"change"}),this.resizable.setSize(this.baseSize.width,this.baseSize.height))}getScale(){return this.scale}setScale(t){this.scale=t}get baseWidth(){return this.baseSize.width}set baseWidth(t){this.baseSize.width!==t&&(this.baseSize.width=t,this.dispatchEvent({type:"change"}),this.resizable.setSize(this.baseSize.width,this.baseSize.height))}getBaseWidth(){return this.baseWidth}setBaseWidth(t){this.baseWidth=t}get baseHeight(){return this.baseSize.height}set baseHeight(t){this.baseSize.height!==t&&(this.baseSize.height=t,this.dispatchEvent({type:"change"}),this.resizable.setSize(this.baseSize.width,this.baseSize.height))}getBaseHeight(){return this.baseHeight}setBaseHeight(t){this.baseHeight=t}setBaseSize(t,e){(this.baseSize.width!==t||this.baseSize.height!==e)&&(this.baseSize.set(t,e),this.dispatchEvent({type:"change"}),this.resizable.setSize(this.baseSize.width,this.baseSize.height))}get preferredWidth(){return this.preferredSize.width}set preferredWidth(t){this.preferredSize.width!==t&&(this.preferredSize.width=t,this.dispatchEvent({type:"change"}),this.resizable.setSize(this.baseSize.width,this.baseSize.height))}getPreferredWidth(){return this.preferredWidth}setPreferredWidth(t){this.preferredWidth=t}get preferredHeight(){return this.preferredSize.height}set preferredHeight(t){this.preferredSize.height!==t&&(this.preferredSize.height=t,this.dispatchEvent({type:"change"}),this.resizable.setSize(this.baseSize.width,this.baseSize.height))}getPreferredHeight(){return this.preferredHeight}setPreferredHeight(t){this.preferredHeight=t}setPreferredSize(t,e){(this.preferredSize.width!==t||this.preferredSize.height!==e)&&(this.preferredSize.set(t,e),this.dispatchEvent({type:"change"}),this.resizable.setSize(this.baseSize.width,this.baseSize.height))}copy(t){this.s=t.scale,this.baseSize.set(t.baseWidth,t.baseHeight),this.preferredSize.set(t.preferredWidth,t.preferredHeight),this.dispatchEvent({type:"change"}),this.resizable.setSize(this.baseSize.width,this.baseSize.height)}static get AUTO_SIZE(){return ky}},Or={SKIP:9,SET:30,ADD:0,ALPHA:1,AVERAGE:2,COLOR:3,COLOR_BURN:4,COLOR_DODGE:5,DARKEN:6,DIFFERENCE:7,DIVIDE:8,DST:9,EXCLUSION:10,HARD_LIGHT:11,HARD_MIX:12,HUE:13,INVERT:14,INVERT_RGB:15,LIGHTEN:16,LINEAR_BURN:17,LINEAR_DODGE:18,LINEAR_LIGHT:19,LUMINOSITY:20,MULTIPLY:21,NEGATION:22,NORMAL:23,OVERLAY:24,PIN_LIGHT:25,REFLECT:26,SATURATION:27,SCREEN:28,SOFT_LIGHT:29,SRC:30,SUBTRACT:31,VIVID_LIGHT:32},xyt="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,x+y,opacity);}",wyt="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,y,min(y.a,opacity));}",Cyt="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,(x+y)*0.5,opacity);}",Ayt="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec3 xHSL=RGBToHSL(x.rgb);vec3 yHSL=RGBToHSL(y.rgb);vec3 z=HSLToRGB(vec3(yHSL.rg,xHSL.b));return vec4(mix(x.rgb,z,opacity),y.a);}",Ryt="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec4 z=mix(step(0.0,y)*(1.0-min(vec4(1.0),(1.0-x)/y)),vec4(1.0),step(1.0,x));return mix(x,z,opacity);}",Myt="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec4 z=step(0.0,x)*mix(min(vec4(1.0),x/max(1.0-y,1e-9)),vec4(1.0),step(1.0,y));return mix(x,z,opacity);}",Oyt="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,min(x,y),opacity);}",Nyt="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,abs(x-y),opacity);}",Iyt="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,x/max(y,1e-12),opacity);}",kyt="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,(x+y-2.0*x*y),opacity);}",Dyt="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec4 a=min(x,1.0),b=min(y,1.0);vec4 z=mix(2.0*a*b,1.0-2.0*(1.0-a)*(1.0-b),step(0.5,y));return mix(x,z,opacity);}",Pyt="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,step(1.0,x+y),opacity);}",Lyt="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec3 xHSL=RGBToHSL(x.rgb);vec3 yHSL=RGBToHSL(y.rgb);vec3 z=HSLToRGB(vec3(yHSL.r,xHSL.gb));return vec4(mix(x.rgb,z,opacity),y.a);}",Uyt="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,1.0-y,opacity);}",Byt="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,y*(1.0-x),opacity);}",Fyt="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,max(x,y),opacity);}",zyt="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,clamp(y+x-1.0,0.0,1.0),opacity);}",Hyt="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,min(x+y,1.0),opacity);}",jyt="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,clamp(2.0*y+x-1.0,0.0,1.0),opacity);}",Vyt="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec3 xHSL=RGBToHSL(x.rgb);vec3 yHSL=RGBToHSL(y.rgb);vec3 z=HSLToRGB(vec3(xHSL.rg,yHSL.b));return vec4(mix(x.rgb,z,opacity),y.a);}",Gyt="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,x*y,opacity);}",qyt="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,1.0-abs(1.0-x-y),opacity);}",$yt="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,y,opacity);}",Wyt="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec4 z=mix(2.0*y*x,1.0-2.0*(1.0-y)*(1.0-x),step(0.5,x));return mix(x,z,opacity);}",Yyt="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec4 y2=2.0*y;vec4 z=mix(mix(y2,x,step(0.5*x,y)),max(vec4(0.0),y2-1.0),step(x,(y2-1.0)));return mix(x,z,opacity);}",Xyt="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec4 z=mix(min(x*x/max(1.0-y,1e-12),1.0),y,step(1.0,y));return mix(x,z,opacity);}",Kyt="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec3 xHSL=RGBToHSL(x.rgb);vec3 yHSL=RGBToHSL(y.rgb);vec3 z=HSLToRGB(vec3(xHSL.r,yHSL.g,xHSL.b));return vec4(mix(x.rgb,z,opacity),y.a);}",Zyt="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,x+y-min(x*y,1.0),opacity);}",Jyt="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec4 y2=2.0*y;vec4 w=step(0.5,y);vec4 z=mix(x-(1.0-y2)*x*(1.0-x),mix(x+(y2-1.0)*(sqrt(x)-x),x+(y2-1.0)*x*((16.0*x-12.0)*x+3.0),w*(1.0-step(0.25,x))),w);return mix(x,z,opacity);}",Qyt="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return y;}",ebt="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,max(x+y-1.0,0.0),opacity);}",tbt="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec4 z=mix(max(1.0-min((1.0-x)/(2.0*y),1.0),0.0),min(x/(2.0*(1.0-y)),1.0),step(0.5,y));return mix(x,z,opacity);}",nbt=new Map([[Or.ADD,xyt],[Or.ALPHA,wyt],[Or.AVERAGE,Cyt],[Or.COLOR,Ayt],[Or.COLOR_BURN,Ryt],[Or.COLOR_DODGE,Myt],[Or.DARKEN,Oyt],[Or.DIFFERENCE,Nyt],[Or.DIVIDE,Iyt],[Or.DST,null],[Or.EXCLUSION,kyt],[Or.HARD_LIGHT,Dyt],[Or.HARD_MIX,Pyt],[Or.HUE,Lyt],[Or.INVERT,Uyt],[Or.INVERT_RGB,Byt],[Or.LIGHTEN,Fyt],[Or.LINEAR_BURN,zyt],[Or.LINEAR_DODGE,Hyt],[Or.LINEAR_LIGHT,jyt],[Or.LUMINOSITY,Vyt],[Or.MULTIPLY,Gyt],[Or.NEGATION,qyt],[Or.NORMAL,$yt],[Or.OVERLAY,Wyt],[Or.PIN_LIGHT,Yyt],[Or.REFLECT,Xyt],[Or.SATURATION,Kyt],[Or.SCREEN,Zyt],[Or.SOFT_LIGHT,Jyt],[Or.SRC,Qyt],[Or.SUBTRACT,ebt],[Or.VIVID_LIGHT,tbt]]),ibt=class extends cd{constructor(t,e=1){super(),this._blendFunction=t,this.opacity=new Yi(e)}getOpacity(){return this.opacity.value}setOpacity(t){this.opacity.value=t}get blendFunction(){return this._blendFunction}set blendFunction(t){this._blendFunction=t,this.dispatchEvent({type:"change"})}getBlendFunction(){return this.blendFunction}setBlendFunction(t){this.blendFunction=t}getShaderCode(){return nbt.get(this.blendFunction)}},_$=class extends cd{constructor(t,e,{attributes:n=jb.NONE,blendFunction:i=Or.NORMAL,defines:r=new Map,uniforms:s=new Map,extensions:a=null,vertexShader:o=null}={}){super(),this.name=t,this.renderer=null,this.attributes=n,this.fragmentShader=e,this.vertexShader=o,this.defines=r,this.uniforms=s,this.extensions=a,this.blendMode=new ibt(i),this.blendMode.addEventListener("change",c=>this.setChanged()),this._inputColorSpace=Qg,this._outputColorSpace=om}get inputColorSpace(){return this._inputColorSpace}set inputColorSpace(t){this._inputColorSpace=t,this.setChanged()}get outputColorSpace(){return this._outputColorSpace}set outputColorSpace(t){this._outputColorSpace=t,this.setChanged()}set mainScene(t){}set mainCamera(t){}getName(){return this.name}setRenderer(t){this.renderer=t}getDefines(){return this.defines}getUniforms(){return this.uniforms}getExtensions(){return this.extensions}getBlendMode(){return this.blendMode}getAttributes(){return this.attributes}setAttributes(t){this.attributes=t,this.setChanged()}getFragmentShader(){return this.fragmentShader}setFragmentShader(t){this.fragmentShader=t,this.setChanged()}getVertexShader(){return this.vertexShader}setVertexShader(t){this.vertexShader=t,this.setChanged()}setChanged(){this.dispatchEvent({type:"change"})}setDepthTexture(t,e=uE){}update(t,e,n){}setSize(t,e){}initialize(t,e,n){}dispose(){for(const t of Object.keys(this)){const e=this[t];(e instanceof Vl||e instanceof Tl||e instanceof Ba||e instanceof Om)&&this[t].dispose()}}},jP={RED:0,GREEN:1,BLUE:2,ALPHA:3},mEe=class extends Om{constructor(t,e,n=null){super("RenderPass",t,e),this.needsSwap=!1,this.clearPass=new pEe,this.overrideMaterialManager=n===null?null:new Qse(n),this.ignoreBackground=!1,this.skipShadowMapUpdate=!1,this.selection=null}set mainScene(t){this.scene=t}set mainCamera(t){this.camera=t}get renderToScreen(){return super.renderToScreen}set renderToScreen(t){super.renderToScreen=t,this.clearPass.renderToScreen=t}get overrideMaterial(){const t=this.overrideMaterialManager;return t!==null?t.material:null}set overrideMaterial(t){const e=this.overrideMaterialManager;t!==null?e!==null?e.setMaterial(t):this.overrideMaterialManager=new Qse(t):e!==null&&(e.dispose(),this.overrideMaterialManager=null)}getOverrideMaterial(){return this.overrideMaterial}setOverrideMaterial(t){this.overrideMaterial=t}get clear(){return this.clearPass.enabled}set clear(t){this.clearPass.enabled=t}getSelection(){return this.selection}setSelection(t){this.selection=t}isBackgroundDisabled(){return this.ignoreBackground}setBackgroundDisabled(t){this.ignoreBackground=t}isShadowMapDisabled(){return this.skipShadowMapUpdate}setShadowMapDisabled(t){this.skipShadowMapUpdate=t}getClearPass(){return this.clearPass}render(t,e,n,i,r){const s=this.scene,a=this.camera,o=this.selection,c=a.layers.mask,l=s.background,u=t.shadowMap.autoUpdate,h=this.renderToScreen?null:e;o!==null&&a.layers.set(o.getLayer()),this.skipShadowMapUpdate&&(t.shadowMap.autoUpdate=!1),(this.ignoreBackground||this.clearPass.overrideClearColor!==null)&&(s.background=null),this.clearPass.enabled&&this.clearPass.render(t,e),t.setRenderTarget(h),this.overrideMaterialManager!==null?this.overrideMaterialManager.render(t,s,a):t.render(s,a),a.layers.mask=c,s.background=l,t.shadowMap.autoUpdate=u}},rbt=`#include <packing>
#ifdef GL_FRAGMENT_PRECISION_HIGH
uniform highp sampler2D depthBuffer;
#else
uniform mediump sampler2D depthBuffer;
#endif
#ifdef DOWNSAMPLE_NORMALS
uniform lowp sampler2D normalBuffer;
#endif
varying vec2 vUv0;varying vec2 vUv1;varying vec2 vUv2;varying vec2 vUv3;float readDepth(const in vec2 uv){
#if DEPTH_PACKING == 3201
return unpackRGBAToDepth(texture2D(depthBuffer,uv));
#else
return texture2D(depthBuffer,uv).r;
#endif
}int findBestDepth(const in float samples[4]){float c=(samples[0]+samples[1]+samples[2]+samples[3])*0.25;float distances[4];distances[0]=abs(c-samples[0]);distances[1]=abs(c-samples[1]);distances[2]=abs(c-samples[2]);distances[3]=abs(c-samples[3]);float maxDistance=max(max(distances[0],distances[1]),max(distances[2],distances[3]));int remaining[3];int rejected[3];int i,j,k;for(i=0,j=0,k=0;i<4;++i){if(distances[i]<maxDistance){remaining[j++]=i;}else{rejected[k++]=i;}}for(;j<3;++j){remaining[j]=rejected[--k];}vec3 s=vec3(samples[remaining[0]],samples[remaining[1]],samples[remaining[2]]);c=(s.x+s.y+s.z)/3.0;distances[0]=abs(c-s.x);distances[1]=abs(c-s.y);distances[2]=abs(c-s.z);float minDistance=min(distances[0],min(distances[1],distances[2]));for(i=0;i<3;++i){if(distances[i]==minDistance){break;}}return remaining[i];}void main(){float d[4];d[0]=readDepth(vUv0);d[1]=readDepth(vUv1);d[2]=readDepth(vUv2);d[3]=readDepth(vUv3);int index=findBestDepth(d);
#ifdef DOWNSAMPLE_NORMALS
vec3 n[4];n[0]=texture2D(normalBuffer,vUv0).rgb;n[1]=texture2D(normalBuffer,vUv1).rgb;n[2]=texture2D(normalBuffer,vUv2).rgb;n[3]=texture2D(normalBuffer,vUv3).rgb;
#else
vec3 n[4];n[0]=vec3(0.0);n[1]=vec3(0.0);n[2]=vec3(0.0);n[3]=vec3(0.0);
#endif
gl_FragColor=vec4(n[index],d[index]);}`,sbt="uniform vec2 texelSize;varying vec2 vUv0;varying vec2 vUv1;varying vec2 vUv2;varying vec2 vUv3;void main(){vec2 uv=position.xy*0.5+0.5;vUv0=uv;vUv1=vec2(uv.x,uv.y+texelSize.y);vUv2=vec2(uv.x+texelSize.x,uv.y);vUv3=uv+texelSize;gl_Position=vec4(position.xy,1.0,1.0);}",abt=class extends Hc{constructor(){super({name:"DepthDownsamplingMaterial",defines:{DEPTH_PACKING:"0"},uniforms:{depthBuffer:new Yi(null),normalBuffer:new Yi(null),texelSize:new Yi(new Rt)},blending:lp,toneMapped:!1,depthWrite:!1,depthTest:!1,fragmentShader:rbt,vertexShader:sbt})}set depthBuffer(t){this.uniforms.depthBuffer.value=t}set depthPacking(t){this.defines.DEPTH_PACKING=t.toFixed(0),this.needsUpdate=!0}setDepthBuffer(t,e=uE){this.depthBuffer=t,this.depthPacking=e}set normalBuffer(t){this.uniforms.normalBuffer.value=t,t!==null?this.defines.DOWNSAMPLE_NORMALS="1":delete this.defines.DOWNSAMPLE_NORMALS,this.needsUpdate=!0}setNormalBuffer(t){this.normalBuffer=t}setTexelSize(t,e){this.uniforms.texelSize.value.set(t,e)}setSize(t,e){this.uniforms.texelSize.value.set(1/t,1/e)}},obt=class extends Om{constructor({normalBuffer:t=null,resolutionScale:e=.5,width:n=uC.AUTO_SIZE,height:i=uC.AUTO_SIZE,resolutionX:r=n,resolutionY:s=i}={}){super("DepthDownsamplingPass");const a=new abt;a.normalBuffer=t,this.fullscreenMaterial=a,this.needsDepthTexture=!0,this.needsSwap=!1,this.renderTarget=new Vl(1,1,{minFilter:eo,magFilter:eo,depthBuffer:!1,type:hu}),this.renderTarget.texture.name="DepthDownsamplingPass.Target",this.renderTarget.texture.generateMipmaps=!1;const o=this.resolution=new uC(this,r,s,e);o.addEventListener("change",c=>this.setSize(o.baseWidth,o.baseHeight))}get texture(){return this.renderTarget.texture}getTexture(){return this.renderTarget.texture}getResolution(){return this.resolution}setDepthTexture(t,e=uE){this.fullscreenMaterial.depthBuffer=t,this.fullscreenMaterial.depthPacking=e}render(t,e,n,i,r){t.setRenderTarget(this.renderToScreen?null:this.renderTarget),t.render(this.scene,this.camera)}setSize(t,e){const n=this.resolution;n.setBaseSize(t,e),this.renderTarget.setSize(n.width,n.height),this.fullscreenMaterial.setSize(t,e)}initialize(t,e,n){const i=t.getContext();if(!(i.getExtension("EXT_color_buffer_float")||i.getExtension("EXT_color_buffer_half_float")))throw new Error("Rendering to float texture is not supported.")}},cbt=`#include <common>
#include <packing>
#include <dithering_pars_fragment>
#define packFloatToRGBA(v) packDepthToRGBA(v)
#define unpackRGBAToFloat(v) unpackRGBAToDepth(v)
#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D inputBuffer;
#else
uniform lowp sampler2D inputBuffer;
#endif
#if DEPTH_PACKING == 3201
uniform lowp sampler2D depthBuffer;
#elif defined(GL_FRAGMENT_PRECISION_HIGH)
uniform highp sampler2D depthBuffer;
#else
uniform mediump sampler2D depthBuffer;
#endif
uniform vec2 resolution;uniform vec2 texelSize;uniform float cameraNear;uniform float cameraFar;uniform float aspect;uniform float time;varying vec2 vUv;vec4 sRGBToLinear(const in vec4 value){return vec4(mix(pow(value.rgb*0.9478672986+vec3(0.0521327014),vec3(2.4)),value.rgb*0.0773993808,vec3(lessThanEqual(value.rgb,vec3(0.04045)))),value.a);}float readDepth(const in vec2 uv){
#if DEPTH_PACKING == 3201
return unpackRGBAToDepth(texture2D(depthBuffer,uv));
#else
return texture2D(depthBuffer,uv).r;
#endif
}float getViewZ(const in float depth){
#ifdef PERSPECTIVE_CAMERA
return perspectiveDepthToViewZ(depth,cameraNear,cameraFar);
#else
return orthographicDepthToViewZ(depth,cameraNear,cameraFar);
#endif
}vec3 RGBToHCV(const in vec3 RGB){vec4 P=mix(vec4(RGB.bg,-1.0,2.0/3.0),vec4(RGB.gb,0.0,-1.0/3.0),step(RGB.b,RGB.g));vec4 Q=mix(vec4(P.xyw,RGB.r),vec4(RGB.r,P.yzx),step(P.x,RGB.r));float C=Q.x-min(Q.w,Q.y);float H=abs((Q.w-Q.y)/(6.0*C+EPSILON)+Q.z);return vec3(H,C,Q.x);}vec3 RGBToHSL(const in vec3 RGB){vec3 HCV=RGBToHCV(RGB);float L=HCV.z-HCV.y*0.5;float S=HCV.y/(1.0-abs(L*2.0-1.0)+EPSILON);return vec3(HCV.x,S,L);}vec3 HueToRGB(const in float H){float R=abs(H*6.0-3.0)-1.0;float G=2.0-abs(H*6.0-2.0);float B=2.0-abs(H*6.0-4.0);return clamp(vec3(R,G,B),0.0,1.0);}vec3 HSLToRGB(const in vec3 HSL){vec3 RGB=HueToRGB(HSL.x);float C=(1.0-abs(2.0*HSL.z-1.0))*HSL.y;return(RGB-0.5)*C+HSL.z;}FRAGMENT_HEAD void main(){FRAGMENT_MAIN_UV vec4 color0=texture2D(inputBuffer,UV);vec4 color1=vec4(0.0);FRAGMENT_MAIN_IMAGE color0.a=clamp(color0.a,0.0,1.0);gl_FragColor=color0;
#ifdef ENCODE_OUTPUT
#include <colorspace_fragment>
#endif
#include <dithering_fragment>
}`,lbt="uniform vec2 resolution;uniform vec2 texelSize;uniform float cameraNear;uniform float cameraFar;uniform float aspect;uniform float time;varying vec2 vUv;VERTEX_HEAD void main(){vUv=position.xy*0.5+0.5;VERTEX_MAIN_SUPPORT gl_Position=vec4(position.xy,1.0,1.0);}",ubt=class extends Hc{constructor(t,e,n,i,r=!1){super({name:"EffectMaterial",defines:{THREE_REVISION:JN.replace(/\D+/g,""),DEPTH_PACKING:"0",ENCODE_OUTPUT:"1"},uniforms:{inputBuffer:new Yi(null),depthBuffer:new Yi(null),resolution:new Yi(new Rt),texelSize:new Yi(new Rt),cameraNear:new Yi(.3),cameraFar:new Yi(1e3),aspect:new Yi(1),time:new Yi(0)},blending:lp,toneMapped:!1,depthWrite:!1,depthTest:!1,dithering:r}),t&&this.setShaderParts(t),e&&this.setDefines(e),n&&this.setUniforms(n),this.copyCameraSettings(i)}set inputBuffer(t){this.uniforms.inputBuffer.value=t}setInputBuffer(t){this.uniforms.inputBuffer.value=t}get depthBuffer(){return this.uniforms.depthBuffer.value}set depthBuffer(t){this.uniforms.depthBuffer.value=t}get depthPacking(){return Number(this.defines.DEPTH_PACKING)}set depthPacking(t){this.defines.DEPTH_PACKING=t.toFixed(0),this.needsUpdate=!0}setDepthBuffer(t,e=uE){this.depthBuffer=t,this.depthPacking=e}setShaderData(t){this.setShaderParts(t.shaderParts),this.setDefines(t.defines),this.setUniforms(t.uniforms),this.setExtensions(t.extensions)}setShaderParts(t){return this.fragmentShader=cbt.replace(as.FRAGMENT_HEAD,t.get(as.FRAGMENT_HEAD)||"").replace(as.FRAGMENT_MAIN_UV,t.get(as.FRAGMENT_MAIN_UV)||"").replace(as.FRAGMENT_MAIN_IMAGE,t.get(as.FRAGMENT_MAIN_IMAGE)||""),this.vertexShader=lbt.replace(as.VERTEX_HEAD,t.get(as.VERTEX_HEAD)||"").replace(as.VERTEX_MAIN_SUPPORT,t.get(as.VERTEX_MAIN_SUPPORT)||""),this.needsUpdate=!0,this}setDefines(t){for(const e of t.entries())this.defines[e[0]]=e[1];return this.needsUpdate=!0,this}setUniforms(t){for(const e of t.entries())this.uniforms[e[0]]=e[1];return this}setExtensions(t){this.extensions={};for(const e of t)this.extensions[e]=!0;return this}get encodeOutput(){return this.defines.ENCODE_OUTPUT!==void 0}set encodeOutput(t){this.encodeOutput!==t&&(t?this.defines.ENCODE_OUTPUT="1":delete this.defines.ENCODE_OUTPUT,this.needsUpdate=!0)}isOutputEncodingEnabled(t){return this.encodeOutput}setOutputEncodingEnabled(t){this.encodeOutput=t}get time(){return this.uniforms.time.value}set time(t){this.uniforms.time.value=t}setDeltaTime(t){this.uniforms.time.value+=t}adoptCameraSettings(t){this.copyCameraSettings(t)}copyCameraSettings(t){t&&(this.uniforms.cameraNear.value=t.near,this.uniforms.cameraFar.value=t.far,t instanceof Pc?this.defines.PERSPECTIVE_CAMERA="1":delete this.defines.PERSPECTIVE_CAMERA,this.needsUpdate=!0)}setSize(t,e){const n=this.uniforms;n.resolution.value.set(t,e),n.texelSize.value.set(1/t,1/e),n.aspect.value=t/e}static get Section(){return as}};function eae(t,e,n){for(const i of e){const r="$1"+t+i.charAt(0).toUpperCase()+i.slice(1),s=new RegExp("([^\\.])(\\b"+i+"\\b)","g");for(const a of n.entries())a[1]!==null&&n.set(a[0],a[1].replace(s,r))}}function hbt(t,e,n){let i=e.getFragmentShader(),r=e.getVertexShader();const s=i!==void 0&&/mainImage/.test(i),a=i!==void 0&&/mainUv/.test(i);if(n.attributes|=e.getAttributes(),i===void 0)throw new Error(`Missing fragment shader (${e.name})`);if(a&&n.attributes&jb.CONVOLUTION)throw new Error(`Effects that transform UVs are incompatible with convolution effects (${e.name})`);if(!s&&!a)throw new Error(`Could not find mainImage or mainUv function (${e.name})`);{const o=/\w+\s+(\w+)\([\w\s,]*\)\s*{/g,c=n.shaderParts;let l=c.get(as.FRAGMENT_HEAD)||"",u=c.get(as.FRAGMENT_MAIN_UV)||"",h=c.get(as.FRAGMENT_MAIN_IMAGE)||"",f=c.get(as.VERTEX_HEAD)||"",d=c.get(as.VERTEX_MAIN_SUPPORT)||"";const p=new Set,g=new Set;if(a&&(u+=`	${t}MainUv(UV);
`,n.uvTransformation=!0),r!==null&&/mainSupport/.test(r)){const b=/mainSupport *\([\w\s]*?uv\s*?\)/.test(r);d+=`	${t}MainSupport(`,d+=b?`vUv);
`:`);
`;for(const T of r.matchAll(/(?:varying\s+\w+\s+([\S\s]*?);)/g))for(const x of T[1].split(/\s*,\s*/))n.varyings.add(x),p.add(x),g.add(x);for(const T of r.matchAll(o))g.add(T[1])}for(const b of i.matchAll(o))g.add(b[1]);for(const b of e.defines.keys())g.add(b.replace(/\([\w\s,]*\)/g,""));for(const b of e.uniforms.keys())g.add(b);g.delete("while"),g.delete("for"),g.delete("if"),e.uniforms.forEach((b,T)=>n.uniforms.set(t+T.charAt(0).toUpperCase()+T.slice(1),b)),e.defines.forEach((b,T)=>n.defines.set(t+T.charAt(0).toUpperCase()+T.slice(1),b));const y=new Map([["fragment",i],["vertex",r]]);eae(t,g,n.defines),eae(t,g,y),i=y.get("fragment"),r=y.get("vertex");const v=e.blendMode;if(n.blendModes.set(v.blendFunction,v),s){e.inputColorSpace!==null&&e.inputColorSpace!==n.colorSpace&&(h+=e.inputColorSpace===ba?`color0 = sRGBTransferOETF(color0);
	`:`color0 = sRGBToLinear(color0);
	`),e.outputColorSpace!==om?n.colorSpace=e.outputColorSpace:e.inputColorSpace!==null&&(n.colorSpace=e.inputColorSpace);const b=/MainImage *\([\w\s,]*?depth[\w\s,]*?\)/;h+=`${t}MainImage(color0, UV, `,n.attributes&jb.DEPTH&&b.test(i)&&(h+="depth, ",n.readDepth=!0),h+=`color1);
	`;const T=t+"BlendOpacity";n.uniforms.set(T,v.opacity),h+=`color0 = blend${v.blendFunction}(color0, color1, ${T});

	`,l+=`uniform float ${T};

`}if(l+=i+`
`,r!==null&&(f+=r+`
`),c.set(as.FRAGMENT_HEAD,l),c.set(as.FRAGMENT_MAIN_UV,u),c.set(as.FRAGMENT_MAIN_IMAGE,h),c.set(as.VERTEX_HEAD,f),c.set(as.VERTEX_MAIN_SUPPORT,d),e.extensions!==null)for(const b of e.extensions)n.extensions.add(b)}}var fbt=class extends Om{constructor(t,...e){super("EffectPass"),this.fullscreenMaterial=new ubt(null,null,null,t),this.listener=n=>this.handleEvent(n),this.effects=[],this.setEffects(e),this.skipRendering=!1,this.minTime=1,this.maxTime=Number.POSITIVE_INFINITY,this.timeScale=1}set mainScene(t){for(const e of this.effects)e.mainScene=t}set mainCamera(t){this.fullscreenMaterial.copyCameraSettings(t);for(const e of this.effects)e.mainCamera=t}get encodeOutput(){return this.fullscreenMaterial.encodeOutput}set encodeOutput(t){this.fullscreenMaterial.encodeOutput=t}get dithering(){return this.fullscreenMaterial.dithering}set dithering(t){const e=this.fullscreenMaterial;e.dithering=t,e.needsUpdate=!0}setEffects(t){for(const e of this.effects)e.removeEventListener("change",this.listener);this.effects=t.sort((e,n)=>n.attributes-e.attributes);for(const e of this.effects)e.addEventListener("change",this.listener)}updateMaterial(){const t=new Tyt;let e=0;for(const a of this.effects)if(a.blendMode.blendFunction===Or.DST)t.attributes|=a.getAttributes()&jb.DEPTH;else{if(t.attributes&a.getAttributes()&jb.CONVOLUTION)throw new Error(`Convolution effects cannot be merged (${a.name})`);hbt("e"+e++,a,t)}let n=t.shaderParts.get(as.FRAGMENT_HEAD),i=t.shaderParts.get(as.FRAGMENT_MAIN_IMAGE),r=t.shaderParts.get(as.FRAGMENT_MAIN_UV);const s=/\bblend\b/g;for(const a of t.blendModes.values())n+=a.getShaderCode().replace(s,`blend${a.blendFunction}`)+`
`;t.attributes&jb.DEPTH?(t.readDepth&&(i=`float depth = readDepth(UV);

	`+i),this.needsDepthTexture=this.getDepthTexture()===null):this.needsDepthTexture=!1,t.colorSpace===ba&&(i+=`color0 = sRGBToLinear(color0);
	`),t.uvTransformation?(r=`vec2 transformedUv = vUv;
`+r,t.defines.set("UV","transformedUv")):t.defines.set("UV","vUv"),t.shaderParts.set(as.FRAGMENT_HEAD,n),t.shaderParts.set(as.FRAGMENT_MAIN_IMAGE,i),t.shaderParts.set(as.FRAGMENT_MAIN_UV,r);for(const[a,o]of t.shaderParts)o!==null&&t.shaderParts.set(a,o.trim().replace(/^#/,`
#`));this.skipRendering=e===0,this.needsSwap=!this.skipRendering,this.fullscreenMaterial.setShaderData(t)}recompile(){this.updateMaterial()}getDepthTexture(){return this.fullscreenMaterial.depthBuffer}setDepthTexture(t,e=uE){this.fullscreenMaterial.depthBuffer=t,this.fullscreenMaterial.depthPacking=e;for(const n of this.effects)n.setDepthTexture(t,e)}render(t,e,n,i,r){for(const s of this.effects)s.update(t,e,i);if(!this.skipRendering||this.renderToScreen){const s=this.fullscreenMaterial;s.inputBuffer=e.texture,s.time+=i*this.timeScale,t.setRenderTarget(this.renderToScreen?null:n),t.render(this.scene,this.camera)}}setSize(t,e){this.fullscreenMaterial.setSize(t,e);for(const n of this.effects)n.setSize(t,e)}initialize(t,e,n){this.renderer=t;for(const i of this.effects)i.initialize(t,e,n);this.updateMaterial(),n!==void 0&&n!==El&&(this.fullscreenMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1")}dispose(){super.dispose();for(const t of this.effects)t.removeEventListener("change",this.listener),t.dispose()}handleEvent(t){switch(t.type){case"change":this.recompile();break}}},dbt=class extends Om{constructor(t,e,{renderTarget:n,resolutionScale:i=1,width:r=uC.AUTO_SIZE,height:s=uC.AUTO_SIZE,resolutionX:a=r,resolutionY:o=s}={}){super("NormalPass"),this.needsSwap=!1,this.renderPass=new mEe(t,e,new T7);const c=this.renderPass;c.ignoreBackground=!0,c.skipShadowMapUpdate=!0;const l=c.getClearPass();l.overrideClearColor=new yn(7829503),l.overrideClearAlpha=1,this.renderTarget=n,this.renderTarget===void 0&&(this.renderTarget=new Vl(1,1,{minFilter:eo,magFilter:eo}),this.renderTarget.texture.name="NormalPass.Target");const u=this.resolution=new uC(this,a,o,i);u.addEventListener("change",h=>this.setSize(u.baseWidth,u.baseHeight))}set mainScene(t){this.renderPass.mainScene=t}set mainCamera(t){this.renderPass.mainCamera=t}get texture(){return this.renderTarget.texture}getTexture(){return this.renderTarget.texture}getResolution(){return this.resolution}getResolutionScale(){return this.resolution.scale}setResolutionScale(t){this.resolution.scale=t}render(t,e,n,i,r){const s=this.renderToScreen?null:this.renderTarget;this.renderPass.render(t,s,s)}setSize(t,e){const n=this.resolution;n.setBaseSize(t,e),this.renderTarget.setSize(n.width,n.height)}};function eO(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}new Rt;new Rt;function gEe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var Pd=function t(e,n,i){var r=this;gEe(this,t),eO(this,"dot2",function(s,a){return r.x*s+r.y*a}),eO(this,"dot3",function(s,a,o){return r.x*s+r.y*a+r.z*o}),this.x=e,this.y=n,this.z=i},pbt=[new Pd(1,1,0),new Pd(-1,1,0),new Pd(1,-1,0),new Pd(-1,-1,0),new Pd(1,0,1),new Pd(-1,0,1),new Pd(1,0,-1),new Pd(-1,0,-1),new Pd(0,1,1),new Pd(0,-1,1),new Pd(0,1,-1),new Pd(0,-1,-1)],tae=[151,160,137,91,90,15,131,13,201,95,96,53,194,233,7,225,140,36,103,30,69,142,8,99,37,240,21,10,23,190,6,148,247,120,234,75,0,26,197,62,94,252,219,203,117,35,11,32,57,177,33,88,237,149,56,87,174,20,125,136,171,168,68,175,74,165,71,134,139,48,27,166,77,146,158,231,83,111,229,122,60,211,133,230,220,105,92,41,55,46,245,40,244,102,143,54,65,25,63,161,1,216,80,73,209,76,132,187,208,89,18,169,200,196,135,130,116,188,159,86,164,100,109,198,173,186,3,64,52,217,226,250,124,123,5,202,38,147,118,126,255,82,85,212,207,206,59,227,47,16,58,17,182,189,28,42,223,183,170,213,119,248,152,2,44,154,163,70,221,153,101,155,167,43,172,9,129,22,39,253,19,98,108,110,79,113,224,232,178,185,112,104,218,246,97,228,251,34,242,193,238,210,144,12,191,179,162,241,81,51,145,235,249,14,239,107,49,192,214,31,181,199,106,157,184,84,204,176,115,121,50,45,127,4,150,254,138,236,205,93,222,114,67,29,24,72,243,141,128,195,78,66,215,61,156,180],nae=new Array(512),iae=new Array(512),mbt=function(e){e>0&&e<1&&(e*=65536),e=Math.floor(e),e<256&&(e|=e<<8);for(var n=0;n<256;n++){var i;n&1?i=tae[n]^e&255:i=tae[n]^e>>8&255,nae[n]=nae[n+256]=i,iae[n]=iae[n+256]=pbt[i%12]}};mbt(0);function gbt(t){if(typeof t=="number")t=Math.abs(t);else if(typeof t=="string"){var e=t;t=0;for(var n=0;n<e.length;n++)t=(t+(n+1)*(e.charCodeAt(n)%96))%2147483647}return t===0&&(t=311),t}function rae(t){var e=gbt(t);return function(){var n=e*48271%2147483647;return e=n,n/2147483647}}var vbt=function t(e){var n=this;gEe(this,t),eO(this,"seed",0),eO(this,"init",function(i){n.seed=i,n.value=rae(i)}),eO(this,"value",rae(this.seed)),this.init(e)};new vbt(Math.random());const _bt=Fe.createContext(null),sae=t=>(t.getAttributes()&2)===2,ybt=Fe.memo(Fe.forwardRef(({children:t,camera:e,scene:n,resolutionScale:i,enabled:r=!0,renderPriority:s=1,autoClear:a=!0,depthBuffer:o,enableNormalPass:c,stencilBuffer:l,multisampling:u=8,frameBufferType:h=lE},f)=>{const{gl:d,scene:p,camera:g,size:y}=oh(),v=n||p,b=e||g,[T,x,M]=Fe.useMemo(()=>{const k=new Syt(d,{depthBuffer:o,stencilBuffer:l,multisampling:u,frameBufferType:h});k.addPass(new mEe(v,b));let P=null,U=null;return c&&(U=new dbt(v,b),U.enabled=!1,k.addPass(U),i!==void 0&&(P=new obt({normalBuffer:U.texture,resolutionScale:i}),P.enabled=!1,k.addPass(P))),[k,U,P]},[b,d,o,l,u,h,v,c,i]);Fe.useEffect(()=>T==null?void 0:T.setSize(y.width,y.height),[T,y]),gE((k,P)=>{if(r){const U=d.autoClear;d.autoClear=a,l&&!a&&d.clearStencil(),T.render(P),d.autoClear=U}},r?s:0);const R=Fe.useRef(null);Fe.useLayoutEffect(()=>{var U;const k=[],P=R.current.__r3f;if(P&&T){const G=P.children;for(let $=0;$<G.length;$++){const q=G[$].object;if(q instanceof _$){const Y=[q];if(!sae(q)){let V=null;for(;(V=(U=G[$+1])==null?void 0:U.object)instanceof _$&&!sae(V);)Y.push(V),$++}const ie=new fbt(b,...Y);k.push(ie)}else q instanceof Om&&k.push(q)}for(const $ of k)T==null||T.addPass($);x&&(x.enabled=!0),M&&(M.enabled=!0)}return()=>{for(const G of k)T==null||T.removePass(G);x&&(x.enabled=!1),M&&(M.enabled=!1)}},[T,t,b,x,M]),Fe.useEffect(()=>{const k=d.toneMapping;return d.toneMapping=hm,()=>{d.toneMapping=k}},[d]);const I=Fe.useMemo(()=>({composer:T,normalPass:x,downSamplingPass:M,resolutionScale:i,camera:b,scene:v}),[T,x,M,i,b,v]);return Fe.useImperativeHandle(f,()=>T,[T]),Me.jsx(_bt.Provider,{value:I,children:Me.jsx("group",{ref:R,children:t})})}));let bbt=0;const aae=new WeakMap,Ebt=(t,e)=>function({blendFunction:n=e==null?void 0:e.blendFunction,opacity:i=e==null?void 0:e.opacity,...r}){let s=aae.get(t);if(!s){const c=`@react-three/postprocessing/${t.name}-${bbt++}`;pue({[c]:t}),aae.set(t,s=c)}const a=oh(c=>c.camera),o=Ug.useMemo(()=>[...(e==null?void 0:e.args)??[],...r.args??[{...e,...r}]],[JSON.stringify(r)]);return Me.jsx(s,{camera:a,"blendMode-blendFunction":n,"blendMode-opacity-value":i,...r,args:o})};var Tp=typeof window<"u"?window:{screen:{},navigator:{}},dA=(Tp.matchMedia||function(){return{matches:!1}}).bind(Tp),Sbt={get passive(){return!0}},vEe=function(){};Tp.addEventListener&&Tp.addEventListener("p",vEe,Sbt);Tp.removeEventListener&&Tp.removeEventListener("p",vEe,!1);var CK="ontouchstart"in Tp,Tbt="TouchEvent"in Tp,xbt=CK||Tbt&&dA("(any-pointer: coarse)").matches,oae=(Tp.navigator.maxTouchPoints||0)>0||xbt,_Ee=Tp.navigator.userAgent||"",wbt=dA("(pointer: coarse)").matches&&/iPad|Macintosh/.test(_Ee)&&Math.min(Tp.screen.width||0,Tp.screen.height||0)>=768,yEe=(dA("(pointer: coarse)").matches||!dA("(pointer: fine)").matches&&CK)&&!/Windows.*Firefox/.test(_Ee),Cbt=dA("(any-pointer: fine)").matches||dA("(any-hover: hover)").matches||wbt||!CK,y$=oae&&(Cbt||!yEe)?"hybrid":oae?"touchOnly":"mouseOnly",Abt=y$==="mouseOnly"?"mouse":y$==="touchOnly"||yEe?"touch":"mouse";const Rbt=`  
vec3 halftone(vec3 texcolor, vec2 st, float frequency) {
  float n = 0.1 * snoise(st * 200.0); // Fractal noise
  n += 0.05 * snoise(st * 400.0);
  n += 0.025 * snoise(st * 800.0);

  // Perform a rough RGB-to-CMYK conversion
  vec4 cmyk;
  // CMY = 1-RGB
  cmyk.xyz = 1.0 - texcolor;
  // Black generation: K = min(C,M,Y)
  cmyk.w = min(cmyk.x, min(cmyk.y, cmyk.z)); 
  // Grey component replacement: subtract K from CMY
  cmyk.xyz -= cmyk.w; 

  // K based modifier
  float flex = pow(cmyk.w, 3.11);

  // Distance to nearest point in a grid of
  // (frequency x frequency) points over the unit square
  
  float t = 0.1 + 0.1 * n + 0.11 * flex + 0.1 * cmyk.y;

  // K component: 45 degrees screen angle
  vec2 Kst = frequency * mat2(0.707, -0.707, 0.707, 0.707) * st;
  vec2 Kuv = 2.0 * fract(Kst) - 1.0; 
  float k = aastep(0.0, sqrt(cmyk.w) + t - length(Kuv) + n);
  
  // C component: 15 degrees screen angle
  vec2 Cst = frequency*mat2(0.966, -0.259, 0.259, 0.966) * st;
  vec2 Cuv = 2.0 * fract(Cst) - 1.0;
  float c = aastep(0.0, sqrt(cmyk.x) + t - length(Cuv) + n);
  
  // M component: -15 degrees screen angle
  vec2 Mst = frequency * mat2(0.966, 0.259, -0.259, 0.966) * st;
  vec2 Muv = 2.0 * fract(Mst) - 1.0;
  float m = aastep(0.0, sqrt(cmyk.y) + t - length(Muv) + n);

  // Y component: 0 degrees screen angle
  vec2 Yst = frequency * st; // 0 deg 
  vec2 Yuv = 2.0 * fract(Yst) - 1.0;
  float y = aastep(0.0, sqrt(cmyk.z) + t - length(Yuv) + n);

  // CMY screen in RGB
  vec3 black = vec3(n + 0.01);
  vec3 rgbscreen = 1.0 - vec3(c,m,y) + n;
  
  // Blend in K for final color
  vec3 factor = mix(rgbscreen, black, 1.1 * k + 0.3 * n);

  // Blend with og color
  return mix(factor, texcolor, 0.777);
}

vec3 halftone(vec3 texcolor, vec2 st) {
  return halftone(texcolor, st, 412.321);
}
`,Mbt=`
float blendLighten(float base, float blend) {
	return max(blend,base);
}

vec3 blendLighten(vec3 base, vec3 blend) {
	return vec3(blendLighten(base.r,blend.r),blendLighten(base.g,blend.g),blendLighten(base.b,blend.b));
}

vec3 blendLighten(vec3 base, vec3 blend, float opacity) {
	return (blendLighten(base, blend) * opacity + base * (1.0 - opacity));
}

float blendDarken(float base, float blend) {
	return min(blend,base);
}

vec3 blendDarken(vec3 base, vec3 blend) {
	return vec3(blendDarken(base.r,blend.r),blendDarken(base.g,blend.g),blendDarken(base.b,blend.b));
}

vec3 blendDarken(vec3 base, vec3 blend, float opacity) {
	return (blendDarken(base, blend) * opacity + base * (1.0 - opacity));
}
`,Obt=`
float aastep(float threshold, float value) {
  float afwidth = length(vec2(dFdx(value), dFdy(value))) * 0.70710678118654757;
  return smoothstep(threshold-afwidth, threshold+afwidth, value);
}
`,Nbt=`
//
// Description : Array and textureless GLSL 2D simplex noise function.
//      Author : Ian McEwan, Ashima Arts.
//  Maintainer : ijm
//     Lastmod : 20110822 (ijm)
//     License : Copyright (C) 2011 Ashima Arts. All rights reserved.
//               Distributed under the MIT License. See LICENSE file.
//               https://github.com/ashima/webgl-noise
//

vec3 mod289(vec3 x) {
  return x - floor(x * (1.0 / 289.0)) * 289.0;
}

vec2 mod289(vec2 x) {
  return x - floor(x * (1.0 / 289.0)) * 289.0;
}

vec3 permute(vec3 x) {
  return mod289(((x*34.0)+1.0)*x);
}

float snoise(vec2 v) {
  const vec4 C = vec4(0.211324865405187,  // (3.0-sqrt(3.0))/6.0
                      0.366025403784439,  // 0.5*(sqrt(3.0)-1.0)
                     -0.577350269189626,  // -1.0 + 2.0 * C.x
                      0.024390243902439); // 1.0 / 41.0
// First corner
  vec2 i  = floor(v + dot(v, C.yy) );
  vec2 x0 = v -   i + dot(i, C.xx);

// Other corners
  vec2 i1;
  //i1.x = step( x0.y, x0.x ); // x0.x > x0.y ? 1.0 : 0.0
  //i1.y = 1.0 - i1.x;
  i1 = (x0.x > x0.y) ? vec2(1.0, 0.0) : vec2(0.0, 1.0);
  // x0 = x0 - 0.0 + 0.0 * C.xx ;
  // x1 = x0 - i1 + 1.0 * C.xx ;
  // x2 = x0 - 1.0 + 2.0 * C.xx ;
  vec4 x12 = x0.xyxy + C.xxzz;
  x12.xy -= i1;

// Permutations
  i = mod289(i); // Avoid truncation effects in permutation
  vec3 p = permute( permute( i.y + vec3(0.0, i1.y, 1.0 ))
    + i.x + vec3(0.0, i1.x, 1.0 ));

  vec3 m = max(0.5 - vec3(dot(x0,x0), dot(x12.xy,x12.xy), dot(x12.zw,x12.zw)), 0.0);
  m = m*m ;
  m = m*m ;

// Gradients: 41 points uniformly over a line, mapped onto a diamond.
// The ring size 17*17 = 289 is close to a multiple of 41 (41*7 = 287)

  vec3 x = 2.0 * fract(p * C.www) - 1.0;
  vec3 h = abs(x) - 0.5;
  vec3 ox = floor(x + 0.5);
  vec3 a0 = x - ox;

// Normalise gradients implicitly by scaling m
// Approximation of: m *= inversesqrt( a0*a0 + h*h );
  m *= 1.79284291400159 - 0.85373472095314 * ( a0*a0 + h*h );

// Compute final noise value at P
  vec3 g;
  g.x  = a0.x  * x0.x  + h.x  * x0.y;
  g.yz = a0.yz * x12.xz + h.yz * x12.yw;
  return 130.0 * dot(m, g);
}
`,Ibt=`
#ifdef ASPECT_CORRECTION
	uniform float scale;
#else
	uniform mat3 uvTransform;
#endif

varying vec2 vUv2;

void mainSupport(const in vec2 uv) {
	#ifdef ASPECT_CORRECTION
		vUv2 = uv * vec2(aspect, 1.0) * scale;
	#else
		vUv2 = (uvTransform * vec3(uv, 1.0)).xy;
	#endif
}
`,kbt=`
uniform float viewheight;
uniform sampler2D splat;

${Mbt}
${Obt}
${Nbt}
${Rbt}

float rectdistance(vec2 uv) {
  vec2 tl = vec2(-1.0);
  vec2 br = vec2(1.0);
  vec2 d = max(tl - uv, uv - br);
  return abs(length(max(vec2(0.0), d)) + min(0.0, max(d.x, d.y)));
}

vec2 bendy(const in vec2 xn, float dn, float sn) {
  // config
  float distortion = 0.0173 + dn; // 0.0173, 0.511
  float scale = 0.991 + sn; // 1.0, 0.7
  // calc
  vec3 xDistorted = vec3((1.0 + vec2(distortion, distortion) * dot(xn, xn)) * xn, 1.0);
  mat3 kk = mat3(
    vec3(1.0, 0.0, 0.0),
    vec3(0.0, 1.0, 0.0),
    vec3(0.0, 0.0, 1.0)
  );
  return (kk * xDistorted).xy * scale;
}

void mainImage(const in vec4 inputColor, const in vec2 uv, out vec4 outputColor) {
	#ifdef UV_TRANSFORM
		vec4 bright = texture2D(splat, vUv2);
		vec4 dark = texture2D(splat, 1.0 - vUv2);
	#else
		vec4 bright = texture2D(splat, uv);
		vec4 dark = texture2D(splat, 1.0 - uv);
	#endif
  
  float n = 0.1 * snoise(uv.st * 200.0); // Fractal noise
  n += 0.05 * snoise(uv.st * 400.0);
  n += 0.025 * snoise(uv.st * 800.0);

  vec2 xn = 2.0 * (uv.st - 0.5);
  float fz = 0.005;
  vec2 edge = bendy(xn, fz * n, -fz * n);
  vec2 bent = edge.xy * 0.5 + 0.5;
  
  float dx = rectdistance(xn);
  float bx = rectdistance(edge);

  // apply shape
  float doot = max(abs(edge.x), abs(edge.y));
  if (doot < 1.0) {
    // display
    outputColor = texture2D(inputBuffer, bent);

    // apply scratches
    outputColor.rgb = blendLighten(outputColor.rgb, bright.rgb, 0.079);
    outputColor.rgb = blendDarken(outputColor.rgb, dark.rgb, 0.0666);

    // apply halftones
    outputColor.rgb = halftone(outputColor.rgb, uv.st);
  
  } else if (doot > 1.004) {
    // display shell
    // rbgb 205 205 193
    vec3 matte = vec3(205.0 / 255.0, 205.0 / 255.0, 193.0 / 255.0);
    vec3 dkmatte = mix(matte, vec3(0.0), 0.5);
    float mx = pow(1.0 - bx, 16.0) + n;
    outputColor = vec4(mix(matte, dkmatte, mx), inputColor.a);

  } else {
    // border
    outputColor = vec4(mix(vec3(0.0), outputColor.rgb, 0.5), inputColor.a);
  }

  // apply inner shade
  if (doot >= 0.5 && doot < 1.0) {
    float sh = clamp(0.0, 1.0, 1.0 - bx - 0.7);
    vec3 shade = mix(outputColor.rgb, vec3(0.0), pow(sh, 4.0));
    outputColor = vec4(shade, inputColor.a);
  }

  // apply outer shade
  if (doot >= 0.97) {
    float sh = clamp(0.0, 1.0, bx * 24.0);
    vec3 dkout = mix(vec3(0.0), outputColor.rgb, 0.81);
    vec3 shade = mix(dkout, outputColor.rgb, sh);
    outputColor = vec4(shade, inputColor.a);
  }
}
`;class Dbt extends _${constructor({splat:e,viewheight:n}={}){super("CRTShapeEffect",kbt,{blendFunction:Or.NORMAL,attributes:jb.CONVOLUTION,defines:new Map([["TEXEL","texel"],["TEXTURE_PRECISION_HIGH","1"]]),uniforms:new Map([["splat",new Yi(e)],["viewheight",new Yi(n??128)]])})}get splat(){var e;return(e=this.uniforms.get("splat"))==null?void 0:e.value}set splat(e){const{splat:n,uniforms:i,defines:r}=this,s=i.get("splat"),a=i.get("uvTransform");n!==e&&s&&a&&(s.value=e,a.value=e.matrix,r.delete("TEXTURE_PRECISION_HIGH"),e!==null&&(e.matrixAutoUpdate?(r.set("UV_TRANSFORM","1"),this.setVertexShader(Ibt)):(r.delete("UV_TRANSFORM"),this.setVertexShader(null)),e.type!==El&&r.set("TEXTURE_PRECISION_HIGH","1"),(n===null||(n==null?void 0:n.type)!==e.type)&&this.setChanged()))}getTexture(){return this.splat}setTexture(e){this.splat=e}get aspectCorrection(){return this.defines.has("ASPECT_CORRECTION")}set aspectCorrection(e){this.aspectCorrection!==e&&(e?this.defines.set("ASPECT_CORRECTION","1"):this.defines.delete("ASPECT_CORRECTION"),this.setChanged())}get uvTransform(){const e=this.splat;return!!(e!=null&&e.matrixAutoUpdate)}set uvTransform(e){const n=this.splat;se(n)&&(n.matrixAutoUpdate=e)}setTextureSwizzleRGBA(e,n=e,i=e,r=e){const s="rgba";let a="";(e!==jP.RED||n!==jP.GREEN||i!==jP.BLUE||r!==jP.ALPHA)&&(a=[".",s[e],s[n],s[i],s[r]].join("")),this.defines.set("TEXEL","texel"+a),this.setChanged()}update(){var e;(e=this.splat)!=null&&e.matrixAutoUpdate&&this.splat.updateMatrix()}}const Pbt=Ebt(Dbt);new Ae;const Lbt=Fe.createContext([]);function p8(){return Fe.useContext(Lbt)}function cae(){}const Ubt=Ug.forwardRef(function({args:e,children:n,...i},r){const s=Ug.useRef(null);return Ug.useImperativeHandle(r,()=>s.current),Me.jsxs("mesh",{ref:s,...i,children:[Me.jsx("planeGeometry",{attach:"geometry",args:e}),n]})}),Qf=Ug.forwardRef(function({blocking:e=!1,cursor:n="default",x:i=0,y:r=0,z:s=0,width:a=1,height:o=1,opacity:c=1,visible:l=!0,color:u="white",...h},f){const d=a*.5,p=o*.5,g=[(i+d)*kn.DRAW_CHAR_WIDTH(),(r+p)*kn.DRAW_CHAR_HEIGHT(),s],y=p8();return Me.jsx(Ubt,{ref:f,args:[a*kn.DRAW_CHAR_WIDTH(),o*kn.DRAW_CHAR_HEIGHT()],userData:{blocking:e,cursor:n,clippingPlanes:y},onClick:e?cae:void 0,onPointerMove:e?cae:void 0,position:g,...h,children:Me.jsx("meshBasicMaterial",{color:u,opacity:c,visible:l,transparent:c!==1,clippingPlanes:y})})}),K3=new Ae;function lae(){const t=kn.DRAW_CHAR_WIDTH(),e=kn.DRAW_CHAR_HEIGHT(),n=Math.floor(K3.x/t),i=Math.floor((K3.y+e*.5)/e);return{x:n,y:Fr*.5+i}}function Bbt(){const t=Fs(u=>u.inspector),[e,n]=Fx(Sp(u=>[u.cursor,u.select])),i=Ane(e??0,fi),r=Ane(n??e??0,fi),s={x:Math.min(i.x,r.x),y:Math.min(i.y,r.y)},a={x:Math.max(i.x,r.x),y:Math.max(i.y,r.y)},o=a.x-s.x+1,c=a.y-s.y+1;function l(){Fx.getState().cursor&&EFe(je,nr(),s,a),Fx.setState(()=>({cursor:void 0,select:void 0}))}return Me.jsxs(Me.Fragment,{children:[t?Me.jsx(Qf,{visible:!0,x:0,y:0,z:-1,width:fi,height:Fr,color:"black",cursor:"pointer",onPointerDown:u=>{u.intersections[0].object.worldToLocal(K3.copy(u.intersections[0].point));const h=lae();Fx.setState(()=>({cursor:YT(h,fi)}))},onPointerMove:u=>{if(se(Fx.getState().cursor)){u.intersections[0].object.worldToLocal(K3.copy(u.intersections[0].point));const h=lae();Fx.setState(()=>({select:YT(h,fi)}))}},onPointerUp:l,onPointerOut:l,onPointerCancel:l}):Me.jsx(Qf,{visible:!0,x:0,y:0,z:-1,width:fi,height:Fr,color:"black"}),se(e)&&Me.jsxs(Me.Fragment,{children:[Me.jsx(Qf,{x:s.x+.25,y:s.y+.25,z:100,width:o-.5,height:c-.5,color:"black",opacity:.3}),Me.jsx(Qf,{x:s.x,y:s.y,z:101,width:o,height:c,color:"white",opacity:.25})]})]})}class Fbt{constructor(){this.encoder=new TextEncoder,this._pieces=[],this._parts=[]}append_buffer(e){this.flush(),this._parts.push(e)}append(e){this._pieces.push(e)}flush(){if(this._pieces.length>0){const e=new Uint8Array(this._pieces);this._parts.push(e),this._pieces=[]}}toArrayBuffer(){const e=[];for(const n of this._parts)e.push(n);return zbt(e).buffer}}function zbt(t){let e=0;for(const r of t)e+=r.byteLength;const n=new Uint8Array(e);let i=0;for(const r of t){const s=new Uint8Array(r.buffer,r.byteOffset,r.byteLength);n.set(s,i),i+=r.byteLength}return n}function bEe(t){return new Hbt(t).unpack()}function EEe(t){const e=new jbt,n=e.pack(t);return n instanceof Promise?n.then(()=>e.getBuffer()):e.getBuffer()}class Hbt{constructor(e){this.index=0,this.dataBuffer=e,this.dataView=new Uint8Array(this.dataBuffer),this.length=this.dataBuffer.byteLength}unpack(){const e=this.unpack_uint8();if(e<128)return e;if((e^224)<32)return(e^224)-32;let n;if((n=e^160)<=15)return this.unpack_raw(n);if((n=e^176)<=15)return this.unpack_string(n);if((n=e^144)<=15)return this.unpack_array(n);if((n=e^128)<=15)return this.unpack_map(n);switch(e){case 192:return null;case 193:return;case 194:return!1;case 195:return!0;case 202:return this.unpack_float();case 203:return this.unpack_double();case 204:return this.unpack_uint8();case 205:return this.unpack_uint16();case 206:return this.unpack_uint32();case 207:return this.unpack_uint64();case 208:return this.unpack_int8();case 209:return this.unpack_int16();case 210:return this.unpack_int32();case 211:return this.unpack_int64();case 212:return;case 213:return;case 214:return;case 215:return;case 216:return n=this.unpack_uint16(),this.unpack_string(n);case 217:return n=this.unpack_uint32(),this.unpack_string(n);case 218:return n=this.unpack_uint16(),this.unpack_raw(n);case 219:return n=this.unpack_uint32(),this.unpack_raw(n);case 220:return n=this.unpack_uint16(),this.unpack_array(n);case 221:return n=this.unpack_uint32(),this.unpack_array(n);case 222:return n=this.unpack_uint16(),this.unpack_map(n);case 223:return n=this.unpack_uint32(),this.unpack_map(n)}}unpack_uint8(){const e=this.dataView[this.index]&255;return this.index++,e}unpack_uint16(){const e=this.read(2),n=(e[0]&255)*256+(e[1]&255);return this.index+=2,n}unpack_uint32(){const e=this.read(4),n=((e[0]*256+e[1])*256+e[2])*256+e[3];return this.index+=4,n}unpack_uint64(){const e=this.read(8),n=((((((e[0]*256+e[1])*256+e[2])*256+e[3])*256+e[4])*256+e[5])*256+e[6])*256+e[7];return this.index+=8,n}unpack_int8(){const e=this.unpack_uint8();return e<128?e:e-256}unpack_int16(){const e=this.unpack_uint16();return e<32768?e:e-65536}unpack_int32(){const e=this.unpack_uint32();return e<2**31?e:e-2**32}unpack_int64(){const e=this.unpack_uint64();return e<2**63?e:e-2**64}unpack_raw(e){if(this.length<this.index+e)throw new Error(`BinaryPackFailure: index is out of range ${this.index} ${e} ${this.length}`);const n=this.dataBuffer.slice(this.index,this.index+e);return this.index+=e,n}unpack_string(e){const n=this.read(e);let i=0,r="",s,a;for(;i<e;)s=n[i],s<160?(a=s,i++):(s^192)<32?(a=(s&31)<<6|n[i+1]&63,i+=2):(s^224)<16?(a=(s&15)<<12|(n[i+1]&63)<<6|n[i+2]&63,i+=3):(a=(s&7)<<18|(n[i+1]&63)<<12|(n[i+2]&63)<<6|n[i+3]&63,i+=4),r+=String.fromCodePoint(a);return this.index+=e,r}unpack_array(e){const n=new Array(e);for(let i=0;i<e;i++)n[i]=this.unpack();return n}unpack_map(e){const n={};for(let i=0;i<e;i++){const r=this.unpack();n[r]=this.unpack()}return n}unpack_float(){const e=this.unpack_uint32(),n=e>>31,i=(e>>23&255)-127,r=e&8388607|8388608;return(n===0?1:-1)*r*2**(i-23)}unpack_double(){const e=this.unpack_uint32(),n=this.unpack_uint32(),i=e>>31,r=(e>>20&2047)-1023,a=(e&1048575|1048576)*2**(r-20)+n*2**(r-52);return(i===0?1:-1)*a}read(e){const n=this.index;if(n+e<=this.length)return this.dataView.subarray(n,n+e);throw new Error("BinaryPackFailure: read index out of range")}}class jbt{getBuffer(){return this._bufferBuilder.toArrayBuffer()}pack(e){if(typeof e=="string")this.pack_string(e);else if(typeof e=="number")Math.floor(e)===e?this.pack_integer(e):this.pack_double(e);else if(typeof e=="boolean")e===!0?this._bufferBuilder.append(195):e===!1&&this._bufferBuilder.append(194);else if(e===void 0)this._bufferBuilder.append(192);else if(typeof e=="object")if(e===null)this._bufferBuilder.append(192);else{const n=e.constructor;if(e instanceof Array){const i=this.pack_array(e);if(i instanceof Promise)return i.then(()=>this._bufferBuilder.flush())}else if(e instanceof ArrayBuffer)this.pack_bin(new Uint8Array(e));else if("BYTES_PER_ELEMENT"in e){const i=e;this.pack_bin(new Uint8Array(i.buffer,i.byteOffset,i.byteLength))}else if(e instanceof Date)this.pack_string(e.toString());else{if(e instanceof Blob)return e.arrayBuffer().then(i=>{this.pack_bin(new Uint8Array(i)),this._bufferBuilder.flush()});if(n==Object||n.toString().startsWith("class")){const i=this.pack_object(e);if(i instanceof Promise)return i.then(()=>this._bufferBuilder.flush())}else throw new Error(`Type "${n.toString()}" not yet supported`)}}else throw new Error(`Type "${typeof e}" not yet supported`);this._bufferBuilder.flush()}pack_bin(e){const n=e.length;if(n<=15)this.pack_uint8(160+n);else if(n<=65535)this._bufferBuilder.append(218),this.pack_uint16(n);else if(n<=4294967295)this._bufferBuilder.append(219),this.pack_uint32(n);else throw new Error("Invalid length");this._bufferBuilder.append_buffer(e)}pack_string(e){const n=this._textEncoder.encode(e),i=n.length;if(i<=15)this.pack_uint8(176+i);else if(i<=65535)this._bufferBuilder.append(216),this.pack_uint16(i);else if(i<=4294967295)this._bufferBuilder.append(217),this.pack_uint32(i);else throw new Error("Invalid length");this._bufferBuilder.append_buffer(n)}pack_array(e){const n=e.length;if(n<=15)this.pack_uint8(144+n);else if(n<=65535)this._bufferBuilder.append(220),this.pack_uint16(n);else if(n<=4294967295)this._bufferBuilder.append(221),this.pack_uint32(n);else throw new Error("Invalid length");const i=r=>{if(r<n){const s=this.pack(e[r]);return s instanceof Promise?s.then(()=>i(r+1)):i(r+1)}};return i(0)}pack_integer(e){if(e>=-32&&e<=127)this._bufferBuilder.append(e&255);else if(e>=0&&e<=255)this._bufferBuilder.append(204),this.pack_uint8(e);else if(e>=-128&&e<=127)this._bufferBuilder.append(208),this.pack_int8(e);else if(e>=0&&e<=65535)this._bufferBuilder.append(205),this.pack_uint16(e);else if(e>=-32768&&e<=32767)this._bufferBuilder.append(209),this.pack_int16(e);else if(e>=0&&e<=4294967295)this._bufferBuilder.append(206),this.pack_uint32(e);else if(e>=-2147483648&&e<=2147483647)this._bufferBuilder.append(210),this.pack_int32(e);else if(e>=-9223372036854776e3&&e<=9223372036854776e3)this._bufferBuilder.append(211),this.pack_int64(e);else if(e>=0&&e<=18446744073709552e3)this._bufferBuilder.append(207),this.pack_uint64(e);else throw new Error("Invalid integer")}pack_double(e){let n=0;e<0&&(n=1,e=-e);const i=Math.floor(Math.log(e)/Math.LN2),r=e/2**i-1,s=Math.floor(r*2**52),a=2**32,o=n<<31|i+1023<<20|s/a&1048575,c=s%a;this._bufferBuilder.append(203),this.pack_int32(o),this.pack_int32(c)}pack_object(e){const n=Object.keys(e),i=n.length;if(i<=15)this.pack_uint8(128+i);else if(i<=65535)this._bufferBuilder.append(222),this.pack_uint16(i);else if(i<=4294967295)this._bufferBuilder.append(223),this.pack_uint32(i);else throw new Error("Invalid length");const r=s=>{if(s<n.length){const a=n[s];if(e.hasOwnProperty(a)){this.pack(a);const o=this.pack(e[a]);if(o instanceof Promise)return o.then(()=>r(s+1))}return r(s+1)}};return r(0)}pack_uint8(e){this._bufferBuilder.append(e)}pack_uint16(e){this._bufferBuilder.append(e>>8),this._bufferBuilder.append(e&255)}pack_uint32(e){const n=e&4294967295;this._bufferBuilder.append((n&4278190080)>>>24),this._bufferBuilder.append((n&16711680)>>>16),this._bufferBuilder.append((n&65280)>>>8),this._bufferBuilder.append(n&255)}pack_uint64(e){const n=e/4294967296,i=e%2**32;this._bufferBuilder.append((n&4278190080)>>>24),this._bufferBuilder.append((n&16711680)>>>16),this._bufferBuilder.append((n&65280)>>>8),this._bufferBuilder.append(n&255),this._bufferBuilder.append((i&4278190080)>>>24),this._bufferBuilder.append((i&16711680)>>>16),this._bufferBuilder.append((i&65280)>>>8),this._bufferBuilder.append(i&255)}pack_int8(e){this._bufferBuilder.append(e&255)}pack_int16(e){this._bufferBuilder.append((e&65280)>>8),this._bufferBuilder.append(e&255)}pack_int32(e){this._bufferBuilder.append(e>>>24&255),this._bufferBuilder.append((e&16711680)>>>16),this._bufferBuilder.append((e&65280)>>>8),this._bufferBuilder.append(e&255)}pack_int64(e){const n=Math.floor(e/4294967296),i=e%2**32;this._bufferBuilder.append((n&4278190080)>>>24),this._bufferBuilder.append((n&16711680)>>>16),this._bufferBuilder.append((n&65280)>>>8),this._bufferBuilder.append(n&255),this._bufferBuilder.append((i&4278190080)>>>24),this._bufferBuilder.append((i&16711680)>>>16),this._bufferBuilder.append((i&65280)>>>8),this._bufferBuilder.append(i&255)}constructor(){this._bufferBuilder=new Fbt,this._textEncoder=new TextEncoder}}let SEe=!0,TEe=!0;function G2(t,e,n){const i=t.match(e);return i&&i.length>=n&&parseInt(i[n],10)}function B1(t,e,n){if(!t.RTCPeerConnection)return;const i=t.RTCPeerConnection.prototype,r=i.addEventListener;i.addEventListener=function(a,o){if(a!==e)return r.apply(this,arguments);const c=l=>{const u=n(l);u&&(o.handleEvent?o.handleEvent(u):o(u))};return this._eventMap=this._eventMap||{},this._eventMap[e]||(this._eventMap[e]=new Map),this._eventMap[e].set(o,c),r.apply(this,[a,c])};const s=i.removeEventListener;i.removeEventListener=function(a,o){if(a!==e||!this._eventMap||!this._eventMap[e])return s.apply(this,arguments);if(!this._eventMap[e].has(o))return s.apply(this,arguments);const c=this._eventMap[e].get(o);return this._eventMap[e].delete(o),this._eventMap[e].size===0&&delete this._eventMap[e],Object.keys(this._eventMap).length===0&&delete this._eventMap,s.apply(this,[a,c])},Object.defineProperty(i,"on"+e,{get(){return this["_on"+e]},set(a){this["_on"+e]&&(this.removeEventListener(e,this["_on"+e]),delete this["_on"+e]),a&&this.addEventListener(e,this["_on"+e]=a)},enumerable:!0,configurable:!0})}function Vbt(t){return typeof t!="boolean"?new Error("Argument type: "+typeof t+". Please use a boolean."):(SEe=t,t?"adapter.js logging disabled":"adapter.js logging enabled")}function Gbt(t){return typeof t!="boolean"?new Error("Argument type: "+typeof t+". Please use a boolean."):(TEe=!t,"adapter.js deprecation warnings "+(t?"disabled":"enabled"))}function xEe(){if(typeof window=="object"){if(SEe)return;typeof console<"u"&&typeof console.log=="function"&&console.log.apply(console,arguments)}}function AK(t,e){TEe&&console.warn(t+" is deprecated, please use "+e+" instead.")}function qbt(t){const e={browser:null,version:null};if(typeof t>"u"||!t.navigator||!t.navigator.userAgent)return e.browser="Not a browser.",e;const{navigator:n}=t;if(n.userAgentData&&n.userAgentData.brands){const i=n.userAgentData.brands.find(r=>r.brand==="Chromium");if(i)return{browser:"chrome",version:parseInt(i.version,10)}}if(n.mozGetUserMedia)e.browser="firefox",e.version=G2(n.userAgent,/Firefox\/(\d+)\./,1);else if(n.webkitGetUserMedia||t.isSecureContext===!1&&t.webkitRTCPeerConnection)e.browser="chrome",e.version=G2(n.userAgent,/Chrom(e|ium)\/(\d+)\./,2);else if(t.RTCPeerConnection&&n.userAgent.match(/AppleWebKit\/(\d+)\./))e.browser="safari",e.version=G2(n.userAgent,/AppleWebKit\/(\d+)\./,1),e.supportsUnifiedPlan=t.RTCRtpTransceiver&&"currentDirection"in t.RTCRtpTransceiver.prototype;else return e.browser="Not a supported browser.",e;return e}function uae(t){return Object.prototype.toString.call(t)==="[object Object]"}function wEe(t){return uae(t)?Object.keys(t).reduce(function(e,n){const i=uae(t[n]),r=i?wEe(t[n]):t[n],s=i&&!Object.keys(r).length;return r===void 0||s?e:Object.assign(e,{[n]:r})},{}):t}function b$(t,e,n){!e||n.has(e.id)||(n.set(e.id,e),Object.keys(e).forEach(i=>{i.endsWith("Id")?b$(t,t.get(e[i]),n):i.endsWith("Ids")&&e[i].forEach(r=>{b$(t,t.get(r),n)})}))}function hae(t,e,n){const i=n?"outbound-rtp":"inbound-rtp",r=new Map;if(e===null)return r;const s=[];return t.forEach(a=>{a.type==="track"&&a.trackIdentifier===e.id&&s.push(a)}),s.forEach(a=>{t.forEach(o=>{o.type===i&&o.trackId===a.id&&b$(t,o,r)})}),r}const fae=xEe;function CEe(t,e){const n=t&&t.navigator;if(!n.mediaDevices)return;const i=function(o){if(typeof o!="object"||o.mandatory||o.optional)return o;const c={};return Object.keys(o).forEach(l=>{if(l==="require"||l==="advanced"||l==="mediaSource")return;const u=typeof o[l]=="object"?o[l]:{ideal:o[l]};u.exact!==void 0&&typeof u.exact=="number"&&(u.min=u.max=u.exact);const h=function(f,d){return f?f+d.charAt(0).toUpperCase()+d.slice(1):d==="deviceId"?"sourceId":d};if(u.ideal!==void 0){c.optional=c.optional||[];let f={};typeof u.ideal=="number"?(f[h("min",l)]=u.ideal,c.optional.push(f),f={},f[h("max",l)]=u.ideal,c.optional.push(f)):(f[h("",l)]=u.ideal,c.optional.push(f))}u.exact!==void 0&&typeof u.exact!="number"?(c.mandatory=c.mandatory||{},c.mandatory[h("",l)]=u.exact):["min","max"].forEach(f=>{u[f]!==void 0&&(c.mandatory=c.mandatory||{},c.mandatory[h(f,l)]=u[f])})}),o.advanced&&(c.optional=(c.optional||[]).concat(o.advanced)),c},r=function(o,c){if(e.version>=61)return c(o);if(o=JSON.parse(JSON.stringify(o)),o&&typeof o.audio=="object"){const l=function(u,h,f){h in u&&!(f in u)&&(u[f]=u[h],delete u[h])};o=JSON.parse(JSON.stringify(o)),l(o.audio,"autoGainControl","googAutoGainControl"),l(o.audio,"noiseSuppression","googNoiseSuppression"),o.audio=i(o.audio)}if(o&&typeof o.video=="object"){let l=o.video.facingMode;l=l&&(typeof l=="object"?l:{ideal:l});const u=e.version<66;if(l&&(l.exact==="user"||l.exact==="environment"||l.ideal==="user"||l.ideal==="environment")&&!(n.mediaDevices.getSupportedConstraints&&n.mediaDevices.getSupportedConstraints().facingMode&&!u)){delete o.video.facingMode;let h;if(l.exact==="environment"||l.ideal==="environment"?h=["back","rear"]:(l.exact==="user"||l.ideal==="user")&&(h=["front"]),h)return n.mediaDevices.enumerateDevices().then(f=>{f=f.filter(p=>p.kind==="videoinput");let d=f.find(p=>h.some(g=>p.label.toLowerCase().includes(g)));return!d&&f.length&&h.includes("back")&&(d=f[f.length-1]),d&&(o.video.deviceId=l.exact?{exact:d.deviceId}:{ideal:d.deviceId}),o.video=i(o.video),fae("chrome: "+JSON.stringify(o)),c(o)})}o.video=i(o.video)}return fae("chrome: "+JSON.stringify(o)),c(o)},s=function(o){return e.version>=64?o:{name:{PermissionDeniedError:"NotAllowedError",PermissionDismissedError:"NotAllowedError",InvalidStateError:"NotAllowedError",DevicesNotFoundError:"NotFoundError",ConstraintNotSatisfiedError:"OverconstrainedError",TrackStartError:"NotReadableError",MediaDeviceFailedDueToShutdown:"NotAllowedError",MediaDeviceKillSwitchOn:"NotAllowedError",TabCaptureError:"AbortError",ScreenCaptureError:"AbortError",DeviceCaptureError:"AbortError"}[o.name]||o.name,message:o.message,constraint:o.constraint||o.constraintName,toString(){return this.name+(this.message&&": ")+this.message}}},a=function(o,c,l){r(o,u=>{n.webkitGetUserMedia(u,c,h=>{l&&l(s(h))})})};if(n.getUserMedia=a.bind(n),n.mediaDevices.getUserMedia){const o=n.mediaDevices.getUserMedia.bind(n.mediaDevices);n.mediaDevices.getUserMedia=function(c){return r(c,l=>o(l).then(u=>{if(l.audio&&!u.getAudioTracks().length||l.video&&!u.getVideoTracks().length)throw u.getTracks().forEach(h=>{h.stop()}),new DOMException("","NotFoundError");return u},u=>Promise.reject(s(u))))}}}function AEe(t){t.MediaStream=t.MediaStream||t.webkitMediaStream}function REe(t){if(typeof t=="object"&&t.RTCPeerConnection&&!("ontrack"in t.RTCPeerConnection.prototype)){Object.defineProperty(t.RTCPeerConnection.prototype,"ontrack",{get(){return this._ontrack},set(n){this._ontrack&&this.removeEventListener("track",this._ontrack),this.addEventListener("track",this._ontrack=n)},enumerable:!0,configurable:!0});const e=t.RTCPeerConnection.prototype.setRemoteDescription;t.RTCPeerConnection.prototype.setRemoteDescription=function(){return this._ontrackpoly||(this._ontrackpoly=i=>{i.stream.addEventListener("addtrack",r=>{let s;t.RTCPeerConnection.prototype.getReceivers?s=this.getReceivers().find(o=>o.track&&o.track.id===r.track.id):s={track:r.track};const a=new Event("track");a.track=r.track,a.receiver=s,a.transceiver={receiver:s},a.streams=[i.stream],this.dispatchEvent(a)}),i.stream.getTracks().forEach(r=>{let s;t.RTCPeerConnection.prototype.getReceivers?s=this.getReceivers().find(o=>o.track&&o.track.id===r.id):s={track:r};const a=new Event("track");a.track=r,a.receiver=s,a.transceiver={receiver:s},a.streams=[i.stream],this.dispatchEvent(a)})},this.addEventListener("addstream",this._ontrackpoly)),e.apply(this,arguments)}}else B1(t,"track",e=>(e.transceiver||Object.defineProperty(e,"transceiver",{value:{receiver:e.receiver}}),e))}function MEe(t){if(typeof t=="object"&&t.RTCPeerConnection&&!("getSenders"in t.RTCPeerConnection.prototype)&&"createDTMFSender"in t.RTCPeerConnection.prototype){const e=function(r,s){return{track:s,get dtmf(){return this._dtmf===void 0&&(s.kind==="audio"?this._dtmf=r.createDTMFSender(s):this._dtmf=null),this._dtmf},_pc:r}};if(!t.RTCPeerConnection.prototype.getSenders){t.RTCPeerConnection.prototype.getSenders=function(){return this._senders=this._senders||[],this._senders.slice()};const r=t.RTCPeerConnection.prototype.addTrack;t.RTCPeerConnection.prototype.addTrack=function(o,c){let l=r.apply(this,arguments);return l||(l=e(this,o),this._senders.push(l)),l};const s=t.RTCPeerConnection.prototype.removeTrack;t.RTCPeerConnection.prototype.removeTrack=function(o){s.apply(this,arguments);const c=this._senders.indexOf(o);c!==-1&&this._senders.splice(c,1)}}const n=t.RTCPeerConnection.prototype.addStream;t.RTCPeerConnection.prototype.addStream=function(s){this._senders=this._senders||[],n.apply(this,[s]),s.getTracks().forEach(a=>{this._senders.push(e(this,a))})};const i=t.RTCPeerConnection.prototype.removeStream;t.RTCPeerConnection.prototype.removeStream=function(s){this._senders=this._senders||[],i.apply(this,[s]),s.getTracks().forEach(a=>{const o=this._senders.find(c=>c.track===a);o&&this._senders.splice(this._senders.indexOf(o),1)})}}else if(typeof t=="object"&&t.RTCPeerConnection&&"getSenders"in t.RTCPeerConnection.prototype&&"createDTMFSender"in t.RTCPeerConnection.prototype&&t.RTCRtpSender&&!("dtmf"in t.RTCRtpSender.prototype)){const e=t.RTCPeerConnection.prototype.getSenders;t.RTCPeerConnection.prototype.getSenders=function(){const i=e.apply(this,[]);return i.forEach(r=>r._pc=this),i},Object.defineProperty(t.RTCRtpSender.prototype,"dtmf",{get(){return this._dtmf===void 0&&(this.track.kind==="audio"?this._dtmf=this._pc.createDTMFSender(this.track):this._dtmf=null),this._dtmf}})}}function OEe(t){if(!(typeof t=="object"&&t.RTCPeerConnection&&t.RTCRtpSender&&t.RTCRtpReceiver))return;if(!("getStats"in t.RTCRtpSender.prototype)){const n=t.RTCPeerConnection.prototype.getSenders;n&&(t.RTCPeerConnection.prototype.getSenders=function(){const s=n.apply(this,[]);return s.forEach(a=>a._pc=this),s});const i=t.RTCPeerConnection.prototype.addTrack;i&&(t.RTCPeerConnection.prototype.addTrack=function(){const s=i.apply(this,arguments);return s._pc=this,s}),t.RTCRtpSender.prototype.getStats=function(){const s=this;return this._pc.getStats().then(a=>hae(a,s.track,!0))}}if(!("getStats"in t.RTCRtpReceiver.prototype)){const n=t.RTCPeerConnection.prototype.getReceivers;n&&(t.RTCPeerConnection.prototype.getReceivers=function(){const r=n.apply(this,[]);return r.forEach(s=>s._pc=this),r}),B1(t,"track",i=>(i.receiver._pc=i.srcElement,i)),t.RTCRtpReceiver.prototype.getStats=function(){const r=this;return this._pc.getStats().then(s=>hae(s,r.track,!1))}}if(!("getStats"in t.RTCRtpSender.prototype&&"getStats"in t.RTCRtpReceiver.prototype))return;const e=t.RTCPeerConnection.prototype.getStats;t.RTCPeerConnection.prototype.getStats=function(){if(arguments.length>0&&arguments[0]instanceof t.MediaStreamTrack){const i=arguments[0];let r,s,a;return this.getSenders().forEach(o=>{o.track===i&&(r?a=!0:r=o)}),this.getReceivers().forEach(o=>(o.track===i&&(s?a=!0:s=o),o.track===i)),a||r&&s?Promise.reject(new DOMException("There are more than one sender or receiver for the track.","InvalidAccessError")):r?r.getStats():s?s.getStats():Promise.reject(new DOMException("There is no sender or receiver for the track.","InvalidAccessError"))}return e.apply(this,arguments)}}function NEe(t){t.RTCPeerConnection.prototype.getLocalStreams=function(){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},Object.keys(this._shimmedLocalStreams).map(a=>this._shimmedLocalStreams[a][0])};const e=t.RTCPeerConnection.prototype.addTrack;t.RTCPeerConnection.prototype.addTrack=function(a,o){if(!o)return e.apply(this,arguments);this._shimmedLocalStreams=this._shimmedLocalStreams||{};const c=e.apply(this,arguments);return this._shimmedLocalStreams[o.id]?this._shimmedLocalStreams[o.id].indexOf(c)===-1&&this._shimmedLocalStreams[o.id].push(c):this._shimmedLocalStreams[o.id]=[o,c],c};const n=t.RTCPeerConnection.prototype.addStream;t.RTCPeerConnection.prototype.addStream=function(a){this._shimmedLocalStreams=this._shimmedLocalStreams||{},a.getTracks().forEach(l=>{if(this.getSenders().find(h=>h.track===l))throw new DOMException("Track already exists.","InvalidAccessError")});const o=this.getSenders();n.apply(this,arguments);const c=this.getSenders().filter(l=>o.indexOf(l)===-1);this._shimmedLocalStreams[a.id]=[a].concat(c)};const i=t.RTCPeerConnection.prototype.removeStream;t.RTCPeerConnection.prototype.removeStream=function(a){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},delete this._shimmedLocalStreams[a.id],i.apply(this,arguments)};const r=t.RTCPeerConnection.prototype.removeTrack;t.RTCPeerConnection.prototype.removeTrack=function(a){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},a&&Object.keys(this._shimmedLocalStreams).forEach(o=>{const c=this._shimmedLocalStreams[o].indexOf(a);c!==-1&&this._shimmedLocalStreams[o].splice(c,1),this._shimmedLocalStreams[o].length===1&&delete this._shimmedLocalStreams[o]}),r.apply(this,arguments)}}function IEe(t,e){if(!t.RTCPeerConnection)return;if(t.RTCPeerConnection.prototype.addTrack&&e.version>=65)return NEe(t);const n=t.RTCPeerConnection.prototype.getLocalStreams;t.RTCPeerConnection.prototype.getLocalStreams=function(){const u=n.apply(this);return this._reverseStreams=this._reverseStreams||{},u.map(h=>this._reverseStreams[h.id])};const i=t.RTCPeerConnection.prototype.addStream;t.RTCPeerConnection.prototype.addStream=function(u){if(this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},u.getTracks().forEach(h=>{if(this.getSenders().find(d=>d.track===h))throw new DOMException("Track already exists.","InvalidAccessError")}),!this._reverseStreams[u.id]){const h=new t.MediaStream(u.getTracks());this._streams[u.id]=h,this._reverseStreams[h.id]=u,u=h}i.apply(this,[u])};const r=t.RTCPeerConnection.prototype.removeStream;t.RTCPeerConnection.prototype.removeStream=function(u){this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},r.apply(this,[this._streams[u.id]||u]),delete this._reverseStreams[this._streams[u.id]?this._streams[u.id].id:u.id],delete this._streams[u.id]},t.RTCPeerConnection.prototype.addTrack=function(u,h){if(this.signalingState==="closed")throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");const f=[].slice.call(arguments,1);if(f.length!==1||!f[0].getTracks().find(g=>g===u))throw new DOMException("The adapter.js addTrack polyfill only supports a single  stream which is associated with the specified track.","NotSupportedError");if(this.getSenders().find(g=>g.track===u))throw new DOMException("Track already exists.","InvalidAccessError");this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{};const p=this._streams[h.id];if(p)p.addTrack(u),Promise.resolve().then(()=>{this.dispatchEvent(new Event("negotiationneeded"))});else{const g=new t.MediaStream([u]);this._streams[h.id]=g,this._reverseStreams[g.id]=h,this.addStream(g)}return this.getSenders().find(g=>g.track===u)};function s(l,u){let h=u.sdp;return Object.keys(l._reverseStreams||[]).forEach(f=>{const d=l._reverseStreams[f],p=l._streams[d.id];h=h.replace(new RegExp(p.id,"g"),d.id)}),new RTCSessionDescription({type:u.type,sdp:h})}function a(l,u){let h=u.sdp;return Object.keys(l._reverseStreams||[]).forEach(f=>{const d=l._reverseStreams[f],p=l._streams[d.id];h=h.replace(new RegExp(d.id,"g"),p.id)}),new RTCSessionDescription({type:u.type,sdp:h})}["createOffer","createAnswer"].forEach(function(l){const u=t.RTCPeerConnection.prototype[l],h={[l](){const f=arguments;return arguments.length&&typeof arguments[0]=="function"?u.apply(this,[p=>{const g=s(this,p);f[0].apply(null,[g])},p=>{f[1]&&f[1].apply(null,p)},arguments[2]]):u.apply(this,arguments).then(p=>s(this,p))}};t.RTCPeerConnection.prototype[l]=h[l]});const o=t.RTCPeerConnection.prototype.setLocalDescription;t.RTCPeerConnection.prototype.setLocalDescription=function(){return!arguments.length||!arguments[0].type?o.apply(this,arguments):(arguments[0]=a(this,arguments[0]),o.apply(this,arguments))};const c=Object.getOwnPropertyDescriptor(t.RTCPeerConnection.prototype,"localDescription");Object.defineProperty(t.RTCPeerConnection.prototype,"localDescription",{get(){const l=c.get.apply(this);return l.type===""?l:s(this,l)}}),t.RTCPeerConnection.prototype.removeTrack=function(u){if(this.signalingState==="closed")throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");if(!u._pc)throw new DOMException("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.","TypeError");if(!(u._pc===this))throw new DOMException("Sender was not created by this connection.","InvalidAccessError");this._streams=this._streams||{};let f;Object.keys(this._streams).forEach(d=>{this._streams[d].getTracks().find(g=>u.track===g)&&(f=this._streams[d])}),f&&(f.getTracks().length===1?this.removeStream(this._reverseStreams[f.id]):f.removeTrack(u.track),this.dispatchEvent(new Event("negotiationneeded")))}}function E$(t,e){!t.RTCPeerConnection&&t.webkitRTCPeerConnection&&(t.RTCPeerConnection=t.webkitRTCPeerConnection),t.RTCPeerConnection&&e.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(n){const i=t.RTCPeerConnection.prototype[n],r={[n](){return arguments[0]=new(n==="addIceCandidate"?t.RTCIceCandidate:t.RTCSessionDescription)(arguments[0]),i.apply(this,arguments)}};t.RTCPeerConnection.prototype[n]=r[n]})}function kEe(t,e){B1(t,"negotiationneeded",n=>{const i=n.target;if(!((e.version<72||i.getConfiguration&&i.getConfiguration().sdpSemantics==="plan-b")&&i.signalingState!=="stable"))return n})}const dae=Object.freeze(Object.defineProperty({__proto__:null,fixNegotiationNeeded:kEe,shimAddTrackRemoveTrack:IEe,shimAddTrackRemoveTrackWithNative:NEe,shimGetSendersWithDtmf:MEe,shimGetUserMedia:CEe,shimMediaStream:AEe,shimOnTrack:REe,shimPeerConnection:E$,shimSenderReceiverGetStats:OEe},Symbol.toStringTag,{value:"Module"}));function DEe(t,e){const n=t&&t.navigator,i=t&&t.MediaStreamTrack;if(n.getUserMedia=function(r,s,a){AK("navigator.getUserMedia","navigator.mediaDevices.getUserMedia"),n.mediaDevices.getUserMedia(r).then(s,a)},!(e.version>55&&"autoGainControl"in n.mediaDevices.getSupportedConstraints())){const r=function(a,o,c){o in a&&!(c in a)&&(a[c]=a[o],delete a[o])},s=n.mediaDevices.getUserMedia.bind(n.mediaDevices);if(n.mediaDevices.getUserMedia=function(a){return typeof a=="object"&&typeof a.audio=="object"&&(a=JSON.parse(JSON.stringify(a)),r(a.audio,"autoGainControl","mozAutoGainControl"),r(a.audio,"noiseSuppression","mozNoiseSuppression")),s(a)},i&&i.prototype.getSettings){const a=i.prototype.getSettings;i.prototype.getSettings=function(){const o=a.apply(this,arguments);return r(o,"mozAutoGainControl","autoGainControl"),r(o,"mozNoiseSuppression","noiseSuppression"),o}}if(i&&i.prototype.applyConstraints){const a=i.prototype.applyConstraints;i.prototype.applyConstraints=function(o){return this.kind==="audio"&&typeof o=="object"&&(o=JSON.parse(JSON.stringify(o)),r(o,"autoGainControl","mozAutoGainControl"),r(o,"noiseSuppression","mozNoiseSuppression")),a.apply(this,[o])}}}}function $bt(t,e){t.navigator.mediaDevices&&"getDisplayMedia"in t.navigator.mediaDevices||t.navigator.mediaDevices&&(t.navigator.mediaDevices.getDisplayMedia=function(i){if(!(i&&i.video)){const r=new DOMException("getDisplayMedia without video constraints is undefined");return r.name="NotFoundError",r.code=8,Promise.reject(r)}return i.video===!0?i.video={mediaSource:e}:i.video.mediaSource=e,t.navigator.mediaDevices.getUserMedia(i)})}function PEe(t){typeof t=="object"&&t.RTCTrackEvent&&"receiver"in t.RTCTrackEvent.prototype&&!("transceiver"in t.RTCTrackEvent.prototype)&&Object.defineProperty(t.RTCTrackEvent.prototype,"transceiver",{get(){return{receiver:this.receiver}}})}function S$(t,e){if(typeof t!="object"||!(t.RTCPeerConnection||t.mozRTCPeerConnection))return;!t.RTCPeerConnection&&t.mozRTCPeerConnection&&(t.RTCPeerConnection=t.mozRTCPeerConnection),e.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(r){const s=t.RTCPeerConnection.prototype[r],a={[r](){return arguments[0]=new(r==="addIceCandidate"?t.RTCIceCandidate:t.RTCSessionDescription)(arguments[0]),s.apply(this,arguments)}};t.RTCPeerConnection.prototype[r]=a[r]});const n={inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"},i=t.RTCPeerConnection.prototype.getStats;t.RTCPeerConnection.prototype.getStats=function(){const[s,a,o]=arguments;return i.apply(this,[s||null]).then(c=>{if(e.version<53&&!a)try{c.forEach(l=>{l.type=n[l.type]||l.type})}catch(l){if(l.name!=="TypeError")throw l;c.forEach((u,h)=>{c.set(h,Object.assign({},u,{type:n[u.type]||u.type}))})}return c}).then(a,o)}}function LEe(t){if(!(typeof t=="object"&&t.RTCPeerConnection&&t.RTCRtpSender)||t.RTCRtpSender&&"getStats"in t.RTCRtpSender.prototype)return;const e=t.RTCPeerConnection.prototype.getSenders;e&&(t.RTCPeerConnection.prototype.getSenders=function(){const r=e.apply(this,[]);return r.forEach(s=>s._pc=this),r});const n=t.RTCPeerConnection.prototype.addTrack;n&&(t.RTCPeerConnection.prototype.addTrack=function(){const r=n.apply(this,arguments);return r._pc=this,r}),t.RTCRtpSender.prototype.getStats=function(){return this.track?this._pc.getStats(this.track):Promise.resolve(new Map)}}function UEe(t){if(!(typeof t=="object"&&t.RTCPeerConnection&&t.RTCRtpSender)||t.RTCRtpSender&&"getStats"in t.RTCRtpReceiver.prototype)return;const e=t.RTCPeerConnection.prototype.getReceivers;e&&(t.RTCPeerConnection.prototype.getReceivers=function(){const i=e.apply(this,[]);return i.forEach(r=>r._pc=this),i}),B1(t,"track",n=>(n.receiver._pc=n.srcElement,n)),t.RTCRtpReceiver.prototype.getStats=function(){return this._pc.getStats(this.track)}}function BEe(t){!t.RTCPeerConnection||"removeStream"in t.RTCPeerConnection.prototype||(t.RTCPeerConnection.prototype.removeStream=function(n){AK("removeStream","removeTrack"),this.getSenders().forEach(i=>{i.track&&n.getTracks().includes(i.track)&&this.removeTrack(i)})})}function FEe(t){t.DataChannel&&!t.RTCDataChannel&&(t.RTCDataChannel=t.DataChannel)}function zEe(t){if(!(typeof t=="object"&&t.RTCPeerConnection))return;const e=t.RTCPeerConnection.prototype.addTransceiver;e&&(t.RTCPeerConnection.prototype.addTransceiver=function(){this.setParametersPromises=[];let i=arguments[1]&&arguments[1].sendEncodings;i===void 0&&(i=[]),i=[...i];const r=i.length>0;r&&i.forEach(a=>{if("rid"in a&&!/^[a-z0-9]{0,16}$/i.test(a.rid))throw new TypeError("Invalid RID value provided.");if("scaleResolutionDownBy"in a&&!(parseFloat(a.scaleResolutionDownBy)>=1))throw new RangeError("scale_resolution_down_by must be >= 1.0");if("maxFramerate"in a&&!(parseFloat(a.maxFramerate)>=0))throw new RangeError("max_framerate must be >= 0.0")});const s=e.apply(this,arguments);if(r){const{sender:a}=s,o=a.getParameters();(!("encodings"in o)||o.encodings.length===1&&Object.keys(o.encodings[0]).length===0)&&(o.encodings=i,a.sendEncodings=i,this.setParametersPromises.push(a.setParameters(o).then(()=>{delete a.sendEncodings}).catch(()=>{delete a.sendEncodings})))}return s})}function HEe(t){if(!(typeof t=="object"&&t.RTCRtpSender))return;const e=t.RTCRtpSender.prototype.getParameters;e&&(t.RTCRtpSender.prototype.getParameters=function(){const i=e.apply(this,arguments);return"encodings"in i||(i.encodings=[].concat(this.sendEncodings||[{}])),i})}function jEe(t){if(!(typeof t=="object"&&t.RTCPeerConnection))return;const e=t.RTCPeerConnection.prototype.createOffer;t.RTCPeerConnection.prototype.createOffer=function(){return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then(()=>e.apply(this,arguments)).finally(()=>{this.setParametersPromises=[]}):e.apply(this,arguments)}}function VEe(t){if(!(typeof t=="object"&&t.RTCPeerConnection))return;const e=t.RTCPeerConnection.prototype.createAnswer;t.RTCPeerConnection.prototype.createAnswer=function(){return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then(()=>e.apply(this,arguments)).finally(()=>{this.setParametersPromises=[]}):e.apply(this,arguments)}}const pae=Object.freeze(Object.defineProperty({__proto__:null,shimAddTransceiver:zEe,shimCreateAnswer:VEe,shimCreateOffer:jEe,shimGetDisplayMedia:$bt,shimGetParameters:HEe,shimGetUserMedia:DEe,shimOnTrack:PEe,shimPeerConnection:S$,shimRTCDataChannel:FEe,shimReceiverGetStats:UEe,shimRemoveStream:BEe,shimSenderGetStats:LEe},Symbol.toStringTag,{value:"Module"}));function GEe(t){if(!(typeof t!="object"||!t.RTCPeerConnection)){if("getLocalStreams"in t.RTCPeerConnection.prototype||(t.RTCPeerConnection.prototype.getLocalStreams=function(){return this._localStreams||(this._localStreams=[]),this._localStreams}),!("addStream"in t.RTCPeerConnection.prototype)){const e=t.RTCPeerConnection.prototype.addTrack;t.RTCPeerConnection.prototype.addStream=function(i){this._localStreams||(this._localStreams=[]),this._localStreams.includes(i)||this._localStreams.push(i),i.getAudioTracks().forEach(r=>e.call(this,r,i)),i.getVideoTracks().forEach(r=>e.call(this,r,i))},t.RTCPeerConnection.prototype.addTrack=function(i,...r){return r&&r.forEach(s=>{this._localStreams?this._localStreams.includes(s)||this._localStreams.push(s):this._localStreams=[s]}),e.apply(this,arguments)}}"removeStream"in t.RTCPeerConnection.prototype||(t.RTCPeerConnection.prototype.removeStream=function(n){this._localStreams||(this._localStreams=[]);const i=this._localStreams.indexOf(n);if(i===-1)return;this._localStreams.splice(i,1);const r=n.getTracks();this.getSenders().forEach(s=>{r.includes(s.track)&&this.removeTrack(s)})})}}function qEe(t){if(!(typeof t!="object"||!t.RTCPeerConnection)&&("getRemoteStreams"in t.RTCPeerConnection.prototype||(t.RTCPeerConnection.prototype.getRemoteStreams=function(){return this._remoteStreams?this._remoteStreams:[]}),!("onaddstream"in t.RTCPeerConnection.prototype))){Object.defineProperty(t.RTCPeerConnection.prototype,"onaddstream",{get(){return this._onaddstream},set(n){this._onaddstream&&(this.removeEventListener("addstream",this._onaddstream),this.removeEventListener("track",this._onaddstreampoly)),this.addEventListener("addstream",this._onaddstream=n),this.addEventListener("track",this._onaddstreampoly=i=>{i.streams.forEach(r=>{if(this._remoteStreams||(this._remoteStreams=[]),this._remoteStreams.includes(r))return;this._remoteStreams.push(r);const s=new Event("addstream");s.stream=r,this.dispatchEvent(s)})})}});const e=t.RTCPeerConnection.prototype.setRemoteDescription;t.RTCPeerConnection.prototype.setRemoteDescription=function(){const i=this;return this._onaddstreampoly||this.addEventListener("track",this._onaddstreampoly=function(r){r.streams.forEach(s=>{if(i._remoteStreams||(i._remoteStreams=[]),i._remoteStreams.indexOf(s)>=0)return;i._remoteStreams.push(s);const a=new Event("addstream");a.stream=s,i.dispatchEvent(a)})}),e.apply(i,arguments)}}}function $Ee(t){if(typeof t!="object"||!t.RTCPeerConnection)return;const e=t.RTCPeerConnection.prototype,n=e.createOffer,i=e.createAnswer,r=e.setLocalDescription,s=e.setRemoteDescription,a=e.addIceCandidate;e.createOffer=function(l,u){const h=arguments.length>=2?arguments[2]:arguments[0],f=n.apply(this,[h]);return u?(f.then(l,u),Promise.resolve()):f},e.createAnswer=function(l,u){const h=arguments.length>=2?arguments[2]:arguments[0],f=i.apply(this,[h]);return u?(f.then(l,u),Promise.resolve()):f};let o=function(c,l,u){const h=r.apply(this,[c]);return u?(h.then(l,u),Promise.resolve()):h};e.setLocalDescription=o,o=function(c,l,u){const h=s.apply(this,[c]);return u?(h.then(l,u),Promise.resolve()):h},e.setRemoteDescription=o,o=function(c,l,u){const h=a.apply(this,[c]);return u?(h.then(l,u),Promise.resolve()):h},e.addIceCandidate=o}function WEe(t){const e=t&&t.navigator;if(e.mediaDevices&&e.mediaDevices.getUserMedia){const n=e.mediaDevices,i=n.getUserMedia.bind(n);e.mediaDevices.getUserMedia=r=>i(YEe(r))}!e.getUserMedia&&e.mediaDevices&&e.mediaDevices.getUserMedia&&(e.getUserMedia=(function(i,r,s){e.mediaDevices.getUserMedia(i).then(r,s)}).bind(e))}function YEe(t){return t&&t.video!==void 0?Object.assign({},t,{video:wEe(t.video)}):t}function XEe(t){if(!t.RTCPeerConnection)return;const e=t.RTCPeerConnection;t.RTCPeerConnection=function(i,r){if(i&&i.iceServers){const s=[];for(let a=0;a<i.iceServers.length;a++){let o=i.iceServers[a];o.urls===void 0&&o.url?(AK("RTCIceServer.url","RTCIceServer.urls"),o=JSON.parse(JSON.stringify(o)),o.urls=o.url,delete o.url,s.push(o)):s.push(i.iceServers[a])}i.iceServers=s}return new e(i,r)},t.RTCPeerConnection.prototype=e.prototype,"generateCertificate"in e&&Object.defineProperty(t.RTCPeerConnection,"generateCertificate",{get(){return e.generateCertificate}})}function KEe(t){typeof t=="object"&&t.RTCTrackEvent&&"receiver"in t.RTCTrackEvent.prototype&&!("transceiver"in t.RTCTrackEvent.prototype)&&Object.defineProperty(t.RTCTrackEvent.prototype,"transceiver",{get(){return{receiver:this.receiver}}})}function ZEe(t){const e=t.RTCPeerConnection.prototype.createOffer;t.RTCPeerConnection.prototype.createOffer=function(i){if(i){typeof i.offerToReceiveAudio<"u"&&(i.offerToReceiveAudio=!!i.offerToReceiveAudio);const r=this.getTransceivers().find(a=>a.receiver.track.kind==="audio");i.offerToReceiveAudio===!1&&r?r.direction==="sendrecv"?r.setDirection?r.setDirection("sendonly"):r.direction="sendonly":r.direction==="recvonly"&&(r.setDirection?r.setDirection("inactive"):r.direction="inactive"):i.offerToReceiveAudio===!0&&!r&&this.addTransceiver("audio",{direction:"recvonly"}),typeof i.offerToReceiveVideo<"u"&&(i.offerToReceiveVideo=!!i.offerToReceiveVideo);const s=this.getTransceivers().find(a=>a.receiver.track.kind==="video");i.offerToReceiveVideo===!1&&s?s.direction==="sendrecv"?s.setDirection?s.setDirection("sendonly"):s.direction="sendonly":s.direction==="recvonly"&&(s.setDirection?s.setDirection("inactive"):s.direction="inactive"):i.offerToReceiveVideo===!0&&!s&&this.addTransceiver("video",{direction:"recvonly"})}return e.apply(this,arguments)}}function JEe(t){typeof t!="object"||t.AudioContext||(t.AudioContext=t.webkitAudioContext)}const mae=Object.freeze(Object.defineProperty({__proto__:null,shimAudioContext:JEe,shimCallbacksAPI:$Ee,shimConstraints:YEe,shimCreateOfferLegacy:ZEe,shimGetUserMedia:WEe,shimLocalStreamsAPI:GEe,shimRTCIceServerUrls:XEe,shimRemoteStreamsAPI:qEe,shimTrackEventTransceiver:KEe},Symbol.toStringTag,{value:"Module"}));var QEe={exports:{}};(function(t){const e={};e.generateIdentifier=function(){return Math.random().toString(36).substring(2,12)},e.localCName=e.generateIdentifier(),e.splitLines=function(n){return n.trim().split(`
`).map(i=>i.trim())},e.splitSections=function(n){return n.split(`
m=`).map((r,s)=>(s>0?"m="+r:r).trim()+`\r
`)},e.getDescription=function(n){const i=e.splitSections(n);return i&&i[0]},e.getMediaSections=function(n){const i=e.splitSections(n);return i.shift(),i},e.matchPrefix=function(n,i){return e.splitLines(n).filter(r=>r.indexOf(i)===0)},e.parseCandidate=function(n){let i;n.indexOf("a=candidate:")===0?i=n.substring(12).split(" "):i=n.substring(10).split(" ");const r={foundation:i[0],component:{1:"rtp",2:"rtcp"}[i[1]]||i[1],protocol:i[2].toLowerCase(),priority:parseInt(i[3],10),ip:i[4],address:i[4],port:parseInt(i[5],10),type:i[7]};for(let s=8;s<i.length;s+=2)switch(i[s]){case"raddr":r.relatedAddress=i[s+1];break;case"rport":r.relatedPort=parseInt(i[s+1],10);break;case"tcptype":r.tcpType=i[s+1];break;case"ufrag":r.ufrag=i[s+1],r.usernameFragment=i[s+1];break;default:r[i[s]]===void 0&&(r[i[s]]=i[s+1]);break}return r},e.writeCandidate=function(n){const i=[];i.push(n.foundation);const r=n.component;r==="rtp"?i.push(1):r==="rtcp"?i.push(2):i.push(r),i.push(n.protocol.toUpperCase()),i.push(n.priority),i.push(n.address||n.ip),i.push(n.port);const s=n.type;return i.push("typ"),i.push(s),s!=="host"&&n.relatedAddress&&n.relatedPort&&(i.push("raddr"),i.push(n.relatedAddress),i.push("rport"),i.push(n.relatedPort)),n.tcpType&&n.protocol.toLowerCase()==="tcp"&&(i.push("tcptype"),i.push(n.tcpType)),(n.usernameFragment||n.ufrag)&&(i.push("ufrag"),i.push(n.usernameFragment||n.ufrag)),"candidate:"+i.join(" ")},e.parseIceOptions=function(n){return n.substring(14).split(" ")},e.parseRtpMap=function(n){let i=n.substring(9).split(" ");const r={payloadType:parseInt(i.shift(),10)};return i=i[0].split("/"),r.name=i[0],r.clockRate=parseInt(i[1],10),r.channels=i.length===3?parseInt(i[2],10):1,r.numChannels=r.channels,r},e.writeRtpMap=function(n){let i=n.payloadType;n.preferredPayloadType!==void 0&&(i=n.preferredPayloadType);const r=n.channels||n.numChannels||1;return"a=rtpmap:"+i+" "+n.name+"/"+n.clockRate+(r!==1?"/"+r:"")+`\r
`},e.parseExtmap=function(n){const i=n.substring(9).split(" ");return{id:parseInt(i[0],10),direction:i[0].indexOf("/")>0?i[0].split("/")[1]:"sendrecv",uri:i[1],attributes:i.slice(2).join(" ")}},e.writeExtmap=function(n){return"a=extmap:"+(n.id||n.preferredId)+(n.direction&&n.direction!=="sendrecv"?"/"+n.direction:"")+" "+n.uri+(n.attributes?" "+n.attributes:"")+`\r
`},e.parseFmtp=function(n){const i={};let r;const s=n.substring(n.indexOf(" ")+1).split(";");for(let a=0;a<s.length;a++)r=s[a].trim().split("="),i[r[0].trim()]=r[1];return i},e.writeFmtp=function(n){let i="",r=n.payloadType;if(n.preferredPayloadType!==void 0&&(r=n.preferredPayloadType),n.parameters&&Object.keys(n.parameters).length){const s=[];Object.keys(n.parameters).forEach(a=>{n.parameters[a]!==void 0?s.push(a+"="+n.parameters[a]):s.push(a)}),i+="a=fmtp:"+r+" "+s.join(";")+`\r
`}return i},e.parseRtcpFb=function(n){const i=n.substring(n.indexOf(" ")+1).split(" ");return{type:i.shift(),parameter:i.join(" ")}},e.writeRtcpFb=function(n){let i="",r=n.payloadType;return n.preferredPayloadType!==void 0&&(r=n.preferredPayloadType),n.rtcpFeedback&&n.rtcpFeedback.length&&n.rtcpFeedback.forEach(s=>{i+="a=rtcp-fb:"+r+" "+s.type+(s.parameter&&s.parameter.length?" "+s.parameter:"")+`\r
`}),i},e.parseSsrcMedia=function(n){const i=n.indexOf(" "),r={ssrc:parseInt(n.substring(7,i),10)},s=n.indexOf(":",i);return s>-1?(r.attribute=n.substring(i+1,s),r.value=n.substring(s+1)):r.attribute=n.substring(i+1),r},e.parseSsrcGroup=function(n){const i=n.substring(13).split(" ");return{semantics:i.shift(),ssrcs:i.map(r=>parseInt(r,10))}},e.getMid=function(n){const i=e.matchPrefix(n,"a=mid:")[0];if(i)return i.substring(6)},e.parseFingerprint=function(n){const i=n.substring(14).split(" ");return{algorithm:i[0].toLowerCase(),value:i[1].toUpperCase()}},e.getDtlsParameters=function(n,i){return{role:"auto",fingerprints:e.matchPrefix(n+i,"a=fingerprint:").map(e.parseFingerprint)}},e.writeDtlsParameters=function(n,i){let r="a=setup:"+i+`\r
`;return n.fingerprints.forEach(s=>{r+="a=fingerprint:"+s.algorithm+" "+s.value+`\r
`}),r},e.parseCryptoLine=function(n){const i=n.substring(9).split(" ");return{tag:parseInt(i[0],10),cryptoSuite:i[1],keyParams:i[2],sessionParams:i.slice(3)}},e.writeCryptoLine=function(n){return"a=crypto:"+n.tag+" "+n.cryptoSuite+" "+(typeof n.keyParams=="object"?e.writeCryptoKeyParams(n.keyParams):n.keyParams)+(n.sessionParams?" "+n.sessionParams.join(" "):"")+`\r
`},e.parseCryptoKeyParams=function(n){if(n.indexOf("inline:")!==0)return null;const i=n.substring(7).split("|");return{keyMethod:"inline",keySalt:i[0],lifeTime:i[1],mkiValue:i[2]?i[2].split(":")[0]:void 0,mkiLength:i[2]?i[2].split(":")[1]:void 0}},e.writeCryptoKeyParams=function(n){return n.keyMethod+":"+n.keySalt+(n.lifeTime?"|"+n.lifeTime:"")+(n.mkiValue&&n.mkiLength?"|"+n.mkiValue+":"+n.mkiLength:"")},e.getCryptoParameters=function(n,i){return e.matchPrefix(n+i,"a=crypto:").map(e.parseCryptoLine)},e.getIceParameters=function(n,i){const r=e.matchPrefix(n+i,"a=ice-ufrag:")[0],s=e.matchPrefix(n+i,"a=ice-pwd:")[0];return r&&s?{usernameFragment:r.substring(12),password:s.substring(10)}:null},e.writeIceParameters=function(n){let i="a=ice-ufrag:"+n.usernameFragment+`\r
a=ice-pwd:`+n.password+`\r
`;return n.iceLite&&(i+=`a=ice-lite\r
`),i},e.parseRtpParameters=function(n){const i={codecs:[],headerExtensions:[],fecMechanisms:[],rtcp:[]},s=e.splitLines(n)[0].split(" ");i.profile=s[2];for(let o=3;o<s.length;o++){const c=s[o],l=e.matchPrefix(n,"a=rtpmap:"+c+" ")[0];if(l){const u=e.parseRtpMap(l),h=e.matchPrefix(n,"a=fmtp:"+c+" ");switch(u.parameters=h.length?e.parseFmtp(h[0]):{},u.rtcpFeedback=e.matchPrefix(n,"a=rtcp-fb:"+c+" ").map(e.parseRtcpFb),i.codecs.push(u),u.name.toUpperCase()){case"RED":case"ULPFEC":i.fecMechanisms.push(u.name.toUpperCase());break}}}e.matchPrefix(n,"a=extmap:").forEach(o=>{i.headerExtensions.push(e.parseExtmap(o))});const a=e.matchPrefix(n,"a=rtcp-fb:* ").map(e.parseRtcpFb);return i.codecs.forEach(o=>{a.forEach(c=>{o.rtcpFeedback.find(u=>u.type===c.type&&u.parameter===c.parameter)||o.rtcpFeedback.push(c)})}),i},e.writeRtpDescription=function(n,i){let r="";r+="m="+n+" ",r+=i.codecs.length>0?"9":"0",r+=" "+(i.profile||"UDP/TLS/RTP/SAVPF")+" ",r+=i.codecs.map(a=>a.preferredPayloadType!==void 0?a.preferredPayloadType:a.payloadType).join(" ")+`\r
`,r+=`c=IN IP4 0.0.0.0\r
`,r+=`a=rtcp:9 IN IP4 0.0.0.0\r
`,i.codecs.forEach(a=>{r+=e.writeRtpMap(a),r+=e.writeFmtp(a),r+=e.writeRtcpFb(a)});let s=0;return i.codecs.forEach(a=>{a.maxptime>s&&(s=a.maxptime)}),s>0&&(r+="a=maxptime:"+s+`\r
`),i.headerExtensions&&i.headerExtensions.forEach(a=>{r+=e.writeExtmap(a)}),r},e.parseRtpEncodingParameters=function(n){const i=[],r=e.parseRtpParameters(n),s=r.fecMechanisms.indexOf("RED")!==-1,a=r.fecMechanisms.indexOf("ULPFEC")!==-1,o=e.matchPrefix(n,"a=ssrc:").map(f=>e.parseSsrcMedia(f)).filter(f=>f.attribute==="cname"),c=o.length>0&&o[0].ssrc;let l;const u=e.matchPrefix(n,"a=ssrc-group:FID").map(f=>f.substring(17).split(" ").map(p=>parseInt(p,10)));u.length>0&&u[0].length>1&&u[0][0]===c&&(l=u[0][1]),r.codecs.forEach(f=>{if(f.name.toUpperCase()==="RTX"&&f.parameters.apt){let d={ssrc:c,codecPayloadType:parseInt(f.parameters.apt,10)};c&&l&&(d.rtx={ssrc:l}),i.push(d),s&&(d=JSON.parse(JSON.stringify(d)),d.fec={ssrc:c,mechanism:a?"red+ulpfec":"red"},i.push(d))}}),i.length===0&&c&&i.push({ssrc:c});let h=e.matchPrefix(n,"b=");return h.length&&(h[0].indexOf("b=TIAS:")===0?h=parseInt(h[0].substring(7),10):h[0].indexOf("b=AS:")===0?h=parseInt(h[0].substring(5),10)*1e3*.95-50*40*8:h=void 0,i.forEach(f=>{f.maxBitrate=h})),i},e.parseRtcpParameters=function(n){const i={},r=e.matchPrefix(n,"a=ssrc:").map(o=>e.parseSsrcMedia(o)).filter(o=>o.attribute==="cname")[0];r&&(i.cname=r.value,i.ssrc=r.ssrc);const s=e.matchPrefix(n,"a=rtcp-rsize");i.reducedSize=s.length>0,i.compound=s.length===0;const a=e.matchPrefix(n,"a=rtcp-mux");return i.mux=a.length>0,i},e.writeRtcpParameters=function(n){let i="";return n.reducedSize&&(i+=`a=rtcp-rsize\r
`),n.mux&&(i+=`a=rtcp-mux\r
`),n.ssrc!==void 0&&n.cname&&(i+="a=ssrc:"+n.ssrc+" cname:"+n.cname+`\r
`),i},e.parseMsid=function(n){let i;const r=e.matchPrefix(n,"a=msid:");if(r.length===1)return i=r[0].substring(7).split(" "),{stream:i[0],track:i[1]};const s=e.matchPrefix(n,"a=ssrc:").map(a=>e.parseSsrcMedia(a)).filter(a=>a.attribute==="msid");if(s.length>0)return i=s[0].value.split(" "),{stream:i[0],track:i[1]}},e.parseSctpDescription=function(n){const i=e.parseMLine(n),r=e.matchPrefix(n,"a=max-message-size:");let s;r.length>0&&(s=parseInt(r[0].substring(19),10)),isNaN(s)&&(s=65536);const a=e.matchPrefix(n,"a=sctp-port:");if(a.length>0)return{port:parseInt(a[0].substring(12),10),protocol:i.fmt,maxMessageSize:s};const o=e.matchPrefix(n,"a=sctpmap:");if(o.length>0){const c=o[0].substring(10).split(" ");return{port:parseInt(c[0],10),protocol:c[1],maxMessageSize:s}}},e.writeSctpDescription=function(n,i){let r=[];return n.protocol!=="DTLS/SCTP"?r=["m="+n.kind+" 9 "+n.protocol+" "+i.protocol+`\r
`,`c=IN IP4 0.0.0.0\r
`,"a=sctp-port:"+i.port+`\r
`]:r=["m="+n.kind+" 9 "+n.protocol+" "+i.port+`\r
`,`c=IN IP4 0.0.0.0\r
`,"a=sctpmap:"+i.port+" "+i.protocol+` 65535\r
`],i.maxMessageSize!==void 0&&r.push("a=max-message-size:"+i.maxMessageSize+`\r
`),r.join("")},e.generateSessionId=function(){return Math.random().toString().substr(2,22)},e.writeSessionBoilerplate=function(n,i,r){let s;const a=i!==void 0?i:2;return n?s=n:s=e.generateSessionId(),`v=0\r
o=`+(r||"thisisadapterortc")+" "+s+" "+a+` IN IP4 127.0.0.1\r
s=-\r
t=0 0\r
`},e.getDirection=function(n,i){const r=e.splitLines(n);for(let s=0;s<r.length;s++)switch(r[s]){case"a=sendrecv":case"a=sendonly":case"a=recvonly":case"a=inactive":return r[s].substring(2)}return i?e.getDirection(i):"sendrecv"},e.getKind=function(n){return e.splitLines(n)[0].split(" ")[0].substring(2)},e.isRejected=function(n){return n.split(" ",2)[1]==="0"},e.parseMLine=function(n){const r=e.splitLines(n)[0].substring(2).split(" ");return{kind:r[0],port:parseInt(r[1],10),protocol:r[2],fmt:r.slice(3).join(" ")}},e.parseOLine=function(n){const r=e.matchPrefix(n,"o=")[0].substring(2).split(" ");return{username:r[0],sessionId:r[1],sessionVersion:parseInt(r[2],10),netType:r[3],addressType:r[4],address:r[5]}},e.isValidSDP=function(n){if(typeof n!="string"||n.length===0)return!1;const i=e.splitLines(n);for(let r=0;r<i.length;r++)if(i[r].length<2||i[r].charAt(1)!=="=")return!1;return!0},t.exports=e})(QEe);var eSe=QEe.exports;const hC=Yc(eSe),Wbt=fxe({__proto__:null,default:hC},[eSe]);function q2(t){if(!t.RTCIceCandidate||t.RTCIceCandidate&&"foundation"in t.RTCIceCandidate.prototype)return;const e=t.RTCIceCandidate;t.RTCIceCandidate=function(i){if(typeof i=="object"&&i.candidate&&i.candidate.indexOf("a=")===0&&(i=JSON.parse(JSON.stringify(i)),i.candidate=i.candidate.substring(2)),i.candidate&&i.candidate.length){const r=new e(i),s=hC.parseCandidate(i.candidate);for(const a in s)a in r||Object.defineProperty(r,a,{value:s[a]});return r.toJSON=function(){return{candidate:r.candidate,sdpMid:r.sdpMid,sdpMLineIndex:r.sdpMLineIndex,usernameFragment:r.usernameFragment}},r}return new e(i)},t.RTCIceCandidate.prototype=e.prototype,B1(t,"icecandidate",n=>(n.candidate&&Object.defineProperty(n,"candidate",{value:new t.RTCIceCandidate(n.candidate),writable:"false"}),n))}function T$(t){!t.RTCIceCandidate||t.RTCIceCandidate&&"relayProtocol"in t.RTCIceCandidate.prototype||B1(t,"icecandidate",e=>{if(e.candidate){const n=hC.parseCandidate(e.candidate.candidate);n.type==="relay"&&(e.candidate.relayProtocol={0:"tls",1:"tcp",2:"udp"}[n.priority>>24])}return e})}function $2(t,e){if(!t.RTCPeerConnection)return;"sctp"in t.RTCPeerConnection.prototype||Object.defineProperty(t.RTCPeerConnection.prototype,"sctp",{get(){return typeof this._sctp>"u"?null:this._sctp}});const n=function(o){if(!o||!o.sdp)return!1;const c=hC.splitSections(o.sdp);return c.shift(),c.some(l=>{const u=hC.parseMLine(l);return u&&u.kind==="application"&&u.protocol.indexOf("SCTP")!==-1})},i=function(o){const c=o.sdp.match(/mozilla...THIS_IS_SDPARTA-(\d+)/);if(c===null||c.length<2)return-1;const l=parseInt(c[1],10);return l!==l?-1:l},r=function(o){let c=65536;return e.browser==="firefox"&&(e.version<57?o===-1?c=16384:c=2147483637:e.version<60?c=e.version===57?65535:65536:c=2147483637),c},s=function(o,c){let l=65536;e.browser==="firefox"&&e.version===57&&(l=65535);const u=hC.matchPrefix(o.sdp,"a=max-message-size:");return u.length>0?l=parseInt(u[0].substring(19),10):e.browser==="firefox"&&c!==-1&&(l=2147483637),l},a=t.RTCPeerConnection.prototype.setRemoteDescription;t.RTCPeerConnection.prototype.setRemoteDescription=function(){if(this._sctp=null,e.browser==="chrome"&&e.version>=76){const{sdpSemantics:c}=this.getConfiguration();c==="plan-b"&&Object.defineProperty(this,"sctp",{get(){return typeof this._sctp>"u"?null:this._sctp},enumerable:!0,configurable:!0})}if(n(arguments[0])){const c=i(arguments[0]),l=r(c),u=s(arguments[0],c);let h;l===0&&u===0?h=Number.POSITIVE_INFINITY:l===0||u===0?h=Math.max(l,u):h=Math.min(l,u);const f={};Object.defineProperty(f,"maxMessageSize",{get(){return h}}),this._sctp=f}return a.apply(this,arguments)}}function W2(t){if(!(t.RTCPeerConnection&&"createDataChannel"in t.RTCPeerConnection.prototype))return;function e(i,r){const s=i.send;i.send=function(){const o=arguments[0],c=o.length||o.size||o.byteLength;if(i.readyState==="open"&&r.sctp&&c>r.sctp.maxMessageSize)throw new TypeError("Message too large (can send a maximum of "+r.sctp.maxMessageSize+" bytes)");return s.apply(i,arguments)}}const n=t.RTCPeerConnection.prototype.createDataChannel;t.RTCPeerConnection.prototype.createDataChannel=function(){const r=n.apply(this,arguments);return e(r,this),r},B1(t,"datachannel",i=>(e(i.channel,i.target),i))}function x$(t){if(!t.RTCPeerConnection||"connectionState"in t.RTCPeerConnection.prototype)return;const e=t.RTCPeerConnection.prototype;Object.defineProperty(e,"connectionState",{get(){return{completed:"connected",checking:"connecting"}[this.iceConnectionState]||this.iceConnectionState},enumerable:!0,configurable:!0}),Object.defineProperty(e,"onconnectionstatechange",{get(){return this._onconnectionstatechange||null},set(n){this._onconnectionstatechange&&(this.removeEventListener("connectionstatechange",this._onconnectionstatechange),delete this._onconnectionstatechange),n&&this.addEventListener("connectionstatechange",this._onconnectionstatechange=n)},enumerable:!0,configurable:!0}),["setLocalDescription","setRemoteDescription"].forEach(n=>{const i=e[n];e[n]=function(){return this._connectionstatechangepoly||(this._connectionstatechangepoly=r=>{const s=r.target;if(s._lastConnectionState!==s.connectionState){s._lastConnectionState=s.connectionState;const a=new Event("connectionstatechange",r);s.dispatchEvent(a)}return r},this.addEventListener("iceconnectionstatechange",this._connectionstatechangepoly)),i.apply(this,arguments)}})}function w$(t,e){if(!t.RTCPeerConnection||e.browser==="chrome"&&e.version>=71||e.browser==="safari"&&e.version>=605)return;const n=t.RTCPeerConnection.prototype.setRemoteDescription;t.RTCPeerConnection.prototype.setRemoteDescription=function(r){if(r&&r.sdp&&r.sdp.indexOf(`
a=extmap-allow-mixed`)!==-1){const s=r.sdp.split(`
`).filter(a=>a.trim()!=="a=extmap-allow-mixed").join(`
`);t.RTCSessionDescription&&r instanceof t.RTCSessionDescription?arguments[0]=new t.RTCSessionDescription({type:r.type,sdp:s}):r.sdp=s}return n.apply(this,arguments)}}function Y2(t,e){if(!(t.RTCPeerConnection&&t.RTCPeerConnection.prototype))return;const n=t.RTCPeerConnection.prototype.addIceCandidate;!n||n.length===0||(t.RTCPeerConnection.prototype.addIceCandidate=function(){return arguments[0]?(e.browser==="chrome"&&e.version<78||e.browser==="firefox"&&e.version<68||e.browser==="safari")&&arguments[0]&&arguments[0].candidate===""?Promise.resolve():n.apply(this,arguments):(arguments[1]&&arguments[1].apply(null),Promise.resolve())})}function X2(t,e){if(!(t.RTCPeerConnection&&t.RTCPeerConnection.prototype))return;const n=t.RTCPeerConnection.prototype.setLocalDescription;!n||n.length===0||(t.RTCPeerConnection.prototype.setLocalDescription=function(){let r=arguments[0]||{};if(typeof r!="object"||r.type&&r.sdp)return n.apply(this,arguments);if(r={type:r.type,sdp:r.sdp},!r.type)switch(this.signalingState){case"stable":case"have-local-offer":case"have-remote-pranswer":r.type="offer";break;default:r.type="answer";break}return r.sdp||r.type!=="offer"&&r.type!=="answer"?n.apply(this,[r]):(r.type==="offer"?this.createOffer:this.createAnswer).apply(this).then(a=>n.apply(this,[a]))})}const Ybt=Object.freeze(Object.defineProperty({__proto__:null,removeExtmapAllowMixed:w$,shimAddIceCandidateNullOrEmpty:Y2,shimConnectionState:x$,shimMaxMessageSize:$2,shimParameterlessSetLocalDescription:X2,shimRTCIceCandidate:q2,shimRTCIceCandidateRelayProtocol:T$,shimSendThrowTypeError:W2},Symbol.toStringTag,{value:"Module"}));function Xbt({window:t}={},e={shimChrome:!0,shimFirefox:!0,shimSafari:!0}){const n=xEe,i=qbt(t),r={browserDetails:i,commonShim:Ybt,extractVersion:G2,disableLog:Vbt,disableWarnings:Gbt,sdp:Wbt};switch(i.browser){case"chrome":if(!dae||!E$||!e.shimChrome)return n("Chrome shim is not included in this adapter release."),r;if(i.version===null)return n("Chrome shim can not determine version, not shimming."),r;n("adapter.js shimming chrome."),r.browserShim=dae,Y2(t,i),X2(t),CEe(t,i),AEe(t),E$(t,i),REe(t),IEe(t,i),MEe(t),OEe(t),kEe(t,i),q2(t),T$(t),x$(t),$2(t,i),W2(t),w$(t,i);break;case"firefox":if(!pae||!S$||!e.shimFirefox)return n("Firefox shim is not included in this adapter release."),r;n("adapter.js shimming firefox."),r.browserShim=pae,Y2(t,i),X2(t),DEe(t,i),S$(t,i),PEe(t),BEe(t),LEe(t),UEe(t),FEe(t),zEe(t),HEe(t),jEe(t),VEe(t),q2(t),x$(t),$2(t,i),W2(t);break;case"safari":if(!mae||!e.shimSafari)return n("Safari shim is not included in this adapter release."),r;n("adapter.js shimming safari."),r.browserShim=mae,Y2(t,i),X2(t),XEe(t),ZEe(t),$Ee(t),GEe(t),qEe(t),KEe(t),WEe(t),JEe(t),q2(t),T$(t),$2(t,i),W2(t),w$(t,i);break;default:n("Unsupported browser!");break}return r}const gae=Xbt({window:typeof window>"u"?void 0:window});function F1(t,e,n,i){Object.defineProperty(t,e,{get:n,set:i,enumerable:!0,configurable:!0})}class tSe{constructor(){this.chunkedMTU=16300,this._dataCount=1,this.chunk=e=>{const n=[],i=e.byteLength,r=Math.ceil(i/this.chunkedMTU);let s=0,a=0;for(;a<i;){const o=Math.min(i,a+this.chunkedMTU),c=e.slice(a,o),l={__peerData:this._dataCount,n:s,data:c,total:r};n.push(l),a=o,s++}return this._dataCount++,n}}}function Kbt(t){let e=0;for(const r of t)e+=r.byteLength;const n=new Uint8Array(e);let i=0;for(const r of t)n.set(r,i),i+=r.byteLength;return n}const Lj=gae.default||gae,WR=new class{isWebRTCSupported(){return typeof RTCPeerConnection<"u"}isBrowserSupported(){const t=this.getBrowser(),e=this.getVersion();return this.supportedBrowsers.includes(t)?t==="chrome"?e>=this.minChromeVersion:t==="firefox"?e>=this.minFirefoxVersion:t==="safari"?!this.isIOS&&e>=this.minSafariVersion:!1:!1}getBrowser(){return Lj.browserDetails.browser}getVersion(){return Lj.browserDetails.version||0}isUnifiedPlanSupported(){const t=this.getBrowser(),e=Lj.browserDetails.version||0;if(t==="chrome"&&e<this.minChromeVersion)return!1;if(t==="firefox"&&e>=this.minFirefoxVersion)return!0;if(!window.RTCRtpTransceiver||!("currentDirection"in RTCRtpTransceiver.prototype))return!1;let n,i=!1;try{n=new RTCPeerConnection,n.addTransceiver("audio"),i=!0}catch{}finally{n&&n.close()}return i}toString(){return`Supports:
    browser:${this.getBrowser()}
    version:${this.getVersion()}
    isIOS:${this.isIOS}
    isWebRTCSupported:${this.isWebRTCSupported()}
    isBrowserSupported:${this.isBrowserSupported()}
    isUnifiedPlanSupported:${this.isUnifiedPlanSupported()}`}constructor(){this.isIOS=typeof navigator<"u"?["iPad","iPhone","iPod"].includes(navigator.platform):!1,this.supportedBrowsers=["firefox","chrome","safari"],this.minFirefoxVersion=59,this.minChromeVersion=72,this.minSafariVersion=605}},Zbt=t=>!t||/^[A-Za-z0-9]+(?:[ _-][A-Za-z0-9]+)*$/.test(t),nSe=()=>Math.random().toString(36).slice(2),vae={iceServers:[{urls:"stun:stun.l.google.com:19302"},{urls:["turn:eu-0.turn.peerjs.com:3478","turn:us-0.turn.peerjs.com:3478"],username:"peerjs",credential:"peerjsp"}],sdpSemantics:"unified-plan"};class Jbt extends tSe{noop(){}blobToArrayBuffer(e,n){const i=new FileReader;return i.onload=function(r){r.target&&n(r.target.result)},i.readAsArrayBuffer(e),i}binaryStringToArrayBuffer(e){const n=new Uint8Array(e.length);for(let i=0;i<e.length;i++)n[i]=e.charCodeAt(i)&255;return n.buffer}isSecure(){return location.protocol==="https:"}constructor(...e){super(...e),this.CLOUD_HOST="0.peerjs.com",this.CLOUD_PORT=443,this.chunkedBrowsers={Chrome:1,chrome:1},this.defaultConfig=vae,this.browser=WR.getBrowser(),this.browserVersion=WR.getVersion(),this.pack=EEe,this.unpack=bEe,this.supports=function(){const n={browser:WR.isBrowserSupported(),webRTC:WR.isWebRTCSupported(),audioVideo:!1,data:!1,binaryBlob:!1,reliable:!1};if(!n.webRTC)return n;let i;try{i=new RTCPeerConnection(vae),n.audioVideo=!0;let r;try{r=i.createDataChannel("_PEERJSTEST",{ordered:!0}),n.data=!0,n.reliable=!!r.ordered;try{r.binaryType="blob",n.binaryBlob=!WR.isIOS}catch{}}catch{}finally{r&&r.close()}}catch{}finally{i&&i.close()}return n}(),this.validateId=Zbt,this.randomToken=nSe}}const Fh=new Jbt,Qbt="PeerJS: ";var _ae;(function(t){t[t.Disabled=0]="Disabled",t[t.Errors=1]="Errors",t[t.Warnings=2]="Warnings",t[t.All=3]="All"})(_ae||(_ae={}));class eEt{get logLevel(){return this._logLevel}set logLevel(e){this._logLevel=e}log(...e){this._logLevel>=3&&this._print(3,...e)}warn(...e){this._logLevel>=2&&this._print(2,...e)}error(...e){this._logLevel>=1&&this._print(1,...e)}setLogFunction(e){this._print=e}_print(e,...n){const i=[Qbt,...n];for(const r in i)i[r]instanceof Error&&(i[r]="("+i[r].name+") "+i[r].message);e>=3?console.log(...i):e>=2?console.warn("WARNING",...i):e>=1&&console.error("ERROR",...i)}constructor(){this._logLevel=0}}var jn=new eEt,RK={},tEt=Object.prototype.hasOwnProperty,uh="~";function LN(){}Object.create&&(LN.prototype=Object.create(null),new LN().__proto__||(uh=!1));function nEt(t,e,n){this.fn=t,this.context=e,this.once=n||!1}function iSe(t,e,n,i,r){if(typeof n!="function")throw new TypeError("The listener must be a function");var s=new nEt(n,i||t,r),a=uh?uh+e:e;return t._events[a]?t._events[a].fn?t._events[a]=[t._events[a],s]:t._events[a].push(s):(t._events[a]=s,t._eventsCount++),t}function K2(t,e){--t._eventsCount===0?t._events=new LN:delete t._events[e]}function Eu(){this._events=new LN,this._eventsCount=0}Eu.prototype.eventNames=function(){var e=[],n,i;if(this._eventsCount===0)return e;for(i in n=this._events)tEt.call(n,i)&&e.push(uh?i.slice(1):i);return Object.getOwnPropertySymbols?e.concat(Object.getOwnPropertySymbols(n)):e};Eu.prototype.listeners=function(e){var n=uh?uh+e:e,i=this._events[n];if(!i)return[];if(i.fn)return[i.fn];for(var r=0,s=i.length,a=new Array(s);r<s;r++)a[r]=i[r].fn;return a};Eu.prototype.listenerCount=function(e){var n=uh?uh+e:e,i=this._events[n];return i?i.fn?1:i.length:0};Eu.prototype.emit=function(e,n,i,r,s,a){var o=uh?uh+e:e;if(!this._events[o])return!1;var c=this._events[o],l=arguments.length,u,h;if(c.fn){switch(c.once&&this.removeListener(e,c.fn,void 0,!0),l){case 1:return c.fn.call(c.context),!0;case 2:return c.fn.call(c.context,n),!0;case 3:return c.fn.call(c.context,n,i),!0;case 4:return c.fn.call(c.context,n,i,r),!0;case 5:return c.fn.call(c.context,n,i,r,s),!0;case 6:return c.fn.call(c.context,n,i,r,s,a),!0}for(h=1,u=new Array(l-1);h<l;h++)u[h-1]=arguments[h];c.fn.apply(c.context,u)}else{var f=c.length,d;for(h=0;h<f;h++)switch(c[h].once&&this.removeListener(e,c[h].fn,void 0,!0),l){case 1:c[h].fn.call(c[h].context);break;case 2:c[h].fn.call(c[h].context,n);break;case 3:c[h].fn.call(c[h].context,n,i);break;case 4:c[h].fn.call(c[h].context,n,i,r);break;default:if(!u)for(d=1,u=new Array(l-1);d<l;d++)u[d-1]=arguments[d];c[h].fn.apply(c[h].context,u)}}return!0};Eu.prototype.on=function(e,n,i){return iSe(this,e,n,i,!1)};Eu.prototype.once=function(e,n,i){return iSe(this,e,n,i,!0)};Eu.prototype.removeListener=function(e,n,i,r){var s=uh?uh+e:e;if(!this._events[s])return this;if(!n)return K2(this,s),this;var a=this._events[s];if(a.fn)a.fn===n&&(!r||a.once)&&(!i||a.context===i)&&K2(this,s);else{for(var o=0,c=[],l=a.length;o<l;o++)(a[o].fn!==n||r&&!a[o].once||i&&a[o].context!==i)&&c.push(a[o]);c.length?this._events[s]=c.length===1?c[0]:c:K2(this,s)}return this};Eu.prototype.removeAllListeners=function(e){var n;return e?(n=uh?uh+e:e,this._events[n]&&K2(this,n)):(this._events=new LN,this._eventsCount=0),this};Eu.prototype.off=Eu.prototype.removeListener;Eu.prototype.addListener=Eu.prototype.on;Eu.prefixed=uh;Eu.EventEmitter=Eu;RK=Eu;var z1={};F1(z1,"ConnectionType",()=>Kg);F1(z1,"PeerErrorType",()=>go);F1(z1,"BaseConnectionErrorType",()=>UN);F1(z1,"DataConnectionErrorType",()=>BN);F1(z1,"SerializationType",()=>pA);F1(z1,"SocketEventType",()=>Lg);F1(z1,"ServerMessageType",()=>ul);var Kg;(function(t){t.Data="data",t.Media="media"})(Kg||(Kg={}));var go;(function(t){t.BrowserIncompatible="browser-incompatible",t.Disconnected="disconnected",t.InvalidID="invalid-id",t.InvalidKey="invalid-key",t.Network="network",t.PeerUnavailable="peer-unavailable",t.SslUnavailable="ssl-unavailable",t.ServerError="server-error",t.SocketError="socket-error",t.SocketClosed="socket-closed",t.UnavailableID="unavailable-id",t.WebRTC="webrtc"})(go||(go={}));var UN;(function(t){t.NegotiationFailed="negotiation-failed",t.ConnectionClosed="connection-closed"})(UN||(UN={}));var BN;(function(t){t.NotOpenYet="not-open-yet",t.MessageToBig="message-too-big"})(BN||(BN={}));var pA;(function(t){t.Binary="binary",t.BinaryUTF8="binary-utf8",t.JSON="json",t.None="raw"})(pA||(pA={}));var Lg;(function(t){t.Message="message",t.Disconnected="disconnected",t.Error="error",t.Close="close"})(Lg||(Lg={}));var ul;(function(t){t.Heartbeat="HEARTBEAT",t.Candidate="CANDIDATE",t.Offer="OFFER",t.Answer="ANSWER",t.Open="OPEN",t.Error="ERROR",t.IdTaken="ID-TAKEN",t.InvalidKey="INVALID-KEY",t.Leave="LEAVE",t.Expire="EXPIRE"})(ul||(ul={}));var MK={};MK=JSON.parse('{"name":"peerjs","version":"1.5.4","keywords":["peerjs","webrtc","p2p","rtc"],"description":"PeerJS client","homepage":"https://peerjs.com","bugs":{"url":"https://github.com/peers/peerjs/issues"},"repository":{"type":"git","url":"https://github.com/peers/peerjs"},"license":"MIT","contributors":["Michelle Bu <michelle@michellebu.com>","afrokick <devbyru@gmail.com>","ericz <really.ez@gmail.com>","Jairo <kidandcat@gmail.com>","Jonas Gloning <34194370+jonasgloning@users.noreply.github.com>","Jairo Caro-Accino Viciana <jairo@galax.be>","Carlos Caballero <carlos.caballero.gonzalez@gmail.com>","hc <hheennrryy@gmail.com>","Muhammad Asif <capripio@gmail.com>","PrashoonB <prashoonbhattacharjee@gmail.com>","Harsh Bardhan Mishra <47351025+HarshCasper@users.noreply.github.com>","akotynski <aleksanderkotbury@gmail.com>","lmb <i@lmb.io>","Jairooo <jairocaro@msn.com>","Moritz Stückler <moritz.stueckler@gmail.com>","Simon <crydotsnakegithub@gmail.com>","Denis Lukov <denismassters@gmail.com>","Philipp Hancke <fippo@andyet.net>","Hans Oksendahl <hansoksendahl@gmail.com>","Jess <jessachandler@gmail.com>","khankuan <khankuan@gmail.com>","DUODVK <kurmanov.work@gmail.com>","XiZhao <kwang1imsa@gmail.com>","Matthias Lohr <matthias@lohr.me>","=frank tree <=frnktrb@googlemail.com>","Andre Eckardt <aeckardt@outlook.com>","Chris Cowan <agentme49@gmail.com>","Alex Chuev <alex@chuev.com>","alxnull <alxnull@e.mail.de>","Yemel Jardi <angel.jardi@gmail.com>","Ben Parnell <benjaminparnell.94@gmail.com>","Benny Lichtner <bennlich@gmail.com>","fresheneesz <bitetrudpublic@gmail.com>","bob.barstead@exaptive.com <bob.barstead@exaptive.com>","chandika <chandika@gmail.com>","emersion <contact@emersion.fr>","Christopher Van <cvan@users.noreply.github.com>","eddieherm <edhermoso@gmail.com>","Eduardo Pinho <enet4mikeenet@gmail.com>","Evandro Zanatta <ezanatta@tray.net.br>","Gardner Bickford <gardner@users.noreply.github.com>","Gian Luca <gianluca.cecchi@cynny.com>","PatrickJS <github@gdi2290.com>","jonnyf <github@jonathanfoss.co.uk>","Hizkia Felix <hizkifw@gmail.com>","Hristo Oskov <hristo.oskov@gmail.com>","Isaac Madwed <i.madwed@gmail.com>","Ilya Konanykhin <ilya.konanykhin@gmail.com>","jasonbarry <jasbarry@me.com>","Jonathan Burke <jonathan.burke.1311@googlemail.com>","Josh Hamit <josh.hamit@gmail.com>","Jordan Austin <jrax86@gmail.com>","Joel Wetzell <jwetzell@yahoo.com>","xizhao <kevin.wang@cloudera.com>","Alberto Torres <kungfoobar@gmail.com>","Jonathan Mayol <mayoljonathan@gmail.com>","Jefferson Felix <me@jsfelix.dev>","Rolf Erik Lekang <me@rolflekang.com>","Kevin Mai-Husan Chia <mhchia@users.noreply.github.com>","Pepijn de Vos <pepijndevos@gmail.com>","JooYoung <qkdlql@naver.com>","Tobias Speicher <rootcommander@gmail.com>","Steve Blaurock <sblaurock@gmail.com>","Kyrylo Shegeda <shegeda@ualberta.ca>","Diwank Singh Tomer <singh@diwank.name>","Sören Balko <Soeren.Balko@gmail.com>","Arpit Solanki <solankiarpit1997@gmail.com>","Yuki Ito <yuki@gnnk.net>","Artur Zayats <zag2art@gmail.com>"],"funding":{"type":"opencollective","url":"https://opencollective.com/peer"},"collective":{"type":"opencollective","url":"https://opencollective.com/peer"},"files":["dist/*"],"sideEffects":["lib/global.ts","lib/supports.ts"],"main":"dist/bundler.cjs","module":"dist/bundler.mjs","browser-minified":"dist/peerjs.min.js","browser-unminified":"dist/peerjs.js","browser-minified-msgpack":"dist/serializer.msgpack.mjs","types":"dist/types.d.ts","engines":{"node":">= 14"},"targets":{"types":{"source":"lib/exports.ts"},"main":{"source":"lib/exports.ts","sourceMap":{"inlineSources":true}},"module":{"source":"lib/exports.ts","includeNodeModules":["eventemitter3"],"sourceMap":{"inlineSources":true}},"browser-minified":{"context":"browser","outputFormat":"global","optimize":true,"engines":{"browsers":"chrome >= 83, edge >= 83, firefox >= 80, safari >= 15"},"source":"lib/global.ts"},"browser-unminified":{"context":"browser","outputFormat":"global","optimize":false,"engines":{"browsers":"chrome >= 83, edge >= 83, firefox >= 80, safari >= 15"},"source":"lib/global.ts"},"browser-minified-msgpack":{"context":"browser","outputFormat":"esmodule","isLibrary":true,"optimize":true,"engines":{"browsers":"chrome >= 83, edge >= 83, firefox >= 102, safari >= 15"},"source":"lib/dataconnection/StreamConnection/MsgPack.ts"}},"scripts":{"contributors":"git-authors-cli --print=false && prettier --write package.json && git add package.json package-lock.json && git commit -m \\"chore(contributors): update and sort contributors list\\"","check":"tsc --noEmit && tsc -p e2e/tsconfig.json --noEmit","watch":"parcel watch","build":"rm -rf dist && parcel build","prepublishOnly":"npm run build","test":"jest","test:watch":"jest --watch","coverage":"jest --coverage --collectCoverageFrom=\\"./lib/**\\"","format":"prettier --write .","format:check":"prettier --check .","semantic-release":"semantic-release","e2e":"wdio run e2e/wdio.local.conf.ts","e2e:bstack":"wdio run e2e/wdio.bstack.conf.ts"},"devDependencies":{"@parcel/config-default":"^2.9.3","@parcel/packager-ts":"^2.9.3","@parcel/transformer-typescript-tsc":"^2.9.3","@parcel/transformer-typescript-types":"^2.9.3","@semantic-release/changelog":"^6.0.1","@semantic-release/git":"^10.0.1","@swc/core":"^1.3.27","@swc/jest":"^0.2.24","@types/jasmine":"^4.3.4","@wdio/browserstack-service":"^8.11.2","@wdio/cli":"^8.11.2","@wdio/globals":"^8.11.2","@wdio/jasmine-framework":"^8.11.2","@wdio/local-runner":"^8.11.2","@wdio/spec-reporter":"^8.11.2","@wdio/types":"^8.10.4","http-server":"^14.1.1","jest":"^29.3.1","jest-environment-jsdom":"^29.3.1","mock-socket":"^9.0.0","parcel":"^2.9.3","prettier":"^3.0.0","semantic-release":"^21.0.0","ts-node":"^10.9.1","typescript":"^5.0.0","wdio-geckodriver-service":"^5.0.1"},"dependencies":{"@msgpack/msgpack":"^2.8.0","eventemitter3":"^4.0.7","peerjs-js-binarypack":"^2.1.0","webrtc-adapter":"^9.0.0"},"alias":{"process":false,"buffer":false}}');class iEt extends RK.EventEmitter{constructor(e,n,i,r,s,a=5e3){super(),this.pingInterval=a,this._disconnected=!0,this._messagesQueue=[];const o=e?"wss://":"ws://";this._baseUrl=o+n+":"+i+r+"peerjs?key="+s}start(e,n){this._id=e;const i=`${this._baseUrl}&id=${e}&token=${n}`;this._socket||!this._disconnected||(this._socket=new WebSocket(i+"&version="+MK.version),this._disconnected=!1,this._socket.onmessage=r=>{let s;try{s=JSON.parse(r.data),jn.log("Server message received:",s)}catch{jn.log("Invalid server message",r.data);return}this.emit(Lg.Message,s)},this._socket.onclose=r=>{this._disconnected||(jn.log("Socket closed.",r),this._cleanup(),this._disconnected=!0,this.emit(Lg.Disconnected))},this._socket.onopen=()=>{this._disconnected||(this._sendQueuedMessages(),jn.log("Socket open"),this._scheduleHeartbeat())})}_scheduleHeartbeat(){this._wsPingTimer=setTimeout(()=>{this._sendHeartbeat()},this.pingInterval)}_sendHeartbeat(){if(!this._wsOpen()){jn.log("Cannot send heartbeat, because socket closed");return}const e=JSON.stringify({type:ul.Heartbeat});this._socket.send(e),this._scheduleHeartbeat()}_wsOpen(){return!!this._socket&&this._socket.readyState===1}_sendQueuedMessages(){const e=[...this._messagesQueue];this._messagesQueue=[];for(const n of e)this.send(n)}send(e){if(this._disconnected)return;if(!this._id){this._messagesQueue.push(e);return}if(!e.type){this.emit(Lg.Error,"Invalid message");return}if(!this._wsOpen())return;const n=JSON.stringify(e);this._socket.send(n)}close(){this._disconnected||(this._cleanup(),this._disconnected=!0)}_cleanup(){this._socket&&(this._socket.onopen=this._socket.onmessage=this._socket.onclose=null,this._socket.close(),this._socket=void 0),clearTimeout(this._wsPingTimer)}}class rSe{constructor(e){this.connection=e}startConnection(e){const n=this._startPeerConnection();if(this.connection.peerConnection=n,this.connection.type===Kg.Media&&e._stream&&this._addTracksToConnection(e._stream,n),e.originator){const i=this.connection,r={ordered:!!e.reliable},s=n.createDataChannel(i.label,r);i._initializeDataChannel(s),this._makeOffer()}else this.handleSDP("OFFER",e.sdp)}_startPeerConnection(){jn.log("Creating RTCPeerConnection.");const e=new RTCPeerConnection(this.connection.provider.options.config);return this._setupListeners(e),e}_setupListeners(e){const n=this.connection.peer,i=this.connection.connectionId,r=this.connection.type,s=this.connection.provider;jn.log("Listening for ICE candidates."),e.onicecandidate=a=>{!a.candidate||!a.candidate.candidate||(jn.log(`Received ICE candidates for ${n}:`,a.candidate),s.socket.send({type:ul.Candidate,payload:{candidate:a.candidate,type:r,connectionId:i},dst:n}))},e.oniceconnectionstatechange=()=>{switch(e.iceConnectionState){case"failed":jn.log("iceConnectionState is failed, closing connections to "+n),this.connection.emitError(UN.NegotiationFailed,"Negotiation of connection to "+n+" failed."),this.connection.close();break;case"closed":jn.log("iceConnectionState is closed, closing connections to "+n),this.connection.emitError(UN.ConnectionClosed,"Connection to "+n+" closed."),this.connection.close();break;case"disconnected":jn.log("iceConnectionState changed to disconnected on the connection with "+n);break;case"completed":e.onicecandidate=()=>{};break}this.connection.emit("iceStateChanged",e.iceConnectionState)},jn.log("Listening for data channel"),e.ondatachannel=a=>{jn.log("Received data channel");const o=a.channel;s.getConnection(n,i)._initializeDataChannel(o)},jn.log("Listening for remote stream"),e.ontrack=a=>{jn.log("Received remote stream");const o=a.streams[0],c=s.getConnection(n,i);if(c.type===Kg.Media){const l=c;this._addStreamToMediaConnection(o,l)}}}cleanup(){jn.log("Cleaning up PeerConnection to "+this.connection.peer);const e=this.connection.peerConnection;if(!e)return;this.connection.peerConnection=null,e.onicecandidate=e.oniceconnectionstatechange=e.ondatachannel=e.ontrack=()=>{};const n=e.signalingState!=="closed";let i=!1;const r=this.connection.dataChannel;r&&(i=!!r.readyState&&r.readyState!=="closed"),(n||i)&&e.close()}async _makeOffer(){const e=this.connection.peerConnection,n=this.connection.provider;try{const i=await e.createOffer(this.connection.options.constraints);jn.log("Created offer."),this.connection.options.sdpTransform&&typeof this.connection.options.sdpTransform=="function"&&(i.sdp=this.connection.options.sdpTransform(i.sdp)||i.sdp);try{await e.setLocalDescription(i),jn.log("Set localDescription:",i,`for:${this.connection.peer}`);let r={sdp:i,type:this.connection.type,connectionId:this.connection.connectionId,metadata:this.connection.metadata};if(this.connection.type===Kg.Data){const s=this.connection;r={...r,label:s.label,reliable:s.reliable,serialization:s.serialization}}n.socket.send({type:ul.Offer,payload:r,dst:this.connection.peer})}catch(r){r!="OperationError: Failed to set local offer sdp: Called in wrong state: kHaveRemoteOffer"&&(n.emitError(go.WebRTC,r),jn.log("Failed to setLocalDescription, ",r))}}catch(i){n.emitError(go.WebRTC,i),jn.log("Failed to createOffer, ",i)}}async _makeAnswer(){const e=this.connection.peerConnection,n=this.connection.provider;try{const i=await e.createAnswer();jn.log("Created answer."),this.connection.options.sdpTransform&&typeof this.connection.options.sdpTransform=="function"&&(i.sdp=this.connection.options.sdpTransform(i.sdp)||i.sdp);try{await e.setLocalDescription(i),jn.log("Set localDescription:",i,`for:${this.connection.peer}`),n.socket.send({type:ul.Answer,payload:{sdp:i,type:this.connection.type,connectionId:this.connection.connectionId},dst:this.connection.peer})}catch(r){n.emitError(go.WebRTC,r),jn.log("Failed to setLocalDescription, ",r)}}catch(i){n.emitError(go.WebRTC,i),jn.log("Failed to create answer, ",i)}}async handleSDP(e,n){n=new RTCSessionDescription(n);const i=this.connection.peerConnection,r=this.connection.provider;jn.log("Setting remote description",n);const s=this;try{await i.setRemoteDescription(n),jn.log(`Set remoteDescription:${e} for:${this.connection.peer}`),e==="OFFER"&&await s._makeAnswer()}catch(a){r.emitError(go.WebRTC,a),jn.log("Failed to setRemoteDescription, ",a)}}async handleCandidate(e){jn.log("handleCandidate:",e);try{await this.connection.peerConnection.addIceCandidate(e),jn.log(`Added ICE candidate for:${this.connection.peer}`)}catch(n){this.connection.provider.emitError(go.WebRTC,n),jn.log("Failed to handleCandidate, ",n)}}_addTracksToConnection(e,n){if(jn.log(`add tracks from stream ${e.id} to peer connection`),!n.addTrack)return jn.error("Your browser does't support RTCPeerConnection#addTrack. Ignored.");e.getTracks().forEach(i=>{n.addTrack(i,e)})}_addStreamToMediaConnection(e,n){jn.log(`add stream ${e.id} to media connection ${n.connectionId}`),n.addStream(e)}}class sSe extends RK.EventEmitter{emitError(e,n){jn.error("Error:",n),this.emit("error",new rEt(`${e}`,n))}}class rEt extends Error{constructor(e,n){typeof n=="string"?super(n):(super(),Object.assign(this,n)),this.type=e}}class aSe extends sSe{get open(){return this._open}constructor(e,n,i){super(),this.peer=e,this.provider=n,this.options=i,this._open=!1,this.metadata=i.metadata}}var X$;const oO=class oO extends aSe{get type(){return Kg.Media}get localStream(){return this._localStream}get remoteStream(){return this._remoteStream}constructor(e,n,i){super(e,n,i),this._localStream=this.options._stream,this.connectionId=this.options.connectionId||oO.ID_PREFIX+Fh.randomToken(),this._negotiator=new rSe(this),this._localStream&&this._negotiator.startConnection({_stream:this._localStream,originator:!0})}_initializeDataChannel(e){this.dataChannel=e,this.dataChannel.onopen=()=>{jn.log(`DC#${this.connectionId} dc connection success`),this.emit("willCloseOnRemote")},this.dataChannel.onclose=()=>{jn.log(`DC#${this.connectionId} dc closed for:`,this.peer),this.close()}}addStream(e){jn.log("Receiving stream",e),this._remoteStream=e,super.emit("stream",e)}handleMessage(e){const n=e.type,i=e.payload;switch(e.type){case ul.Answer:this._negotiator.handleSDP(n,i.sdp),this._open=!0;break;case ul.Candidate:this._negotiator.handleCandidate(i.candidate);break;default:jn.warn(`Unrecognized message type:${n} from peer:${this.peer}`);break}}answer(e,n={}){if(this._localStream){jn.warn("Local stream already exists on this MediaConnection. Are you answering a call twice?");return}this._localStream=e,n&&n.sdpTransform&&(this.options.sdpTransform=n.sdpTransform),this._negotiator.startConnection({...this.options._payload,_stream:e});const i=this.provider._getMessages(this.connectionId);for(const r of i)this.handleMessage(r);this._open=!0}close(){this._negotiator&&(this._negotiator.cleanup(),this._negotiator=null),this._localStream=null,this._remoteStream=null,this.provider&&(this.provider._removeConnection(this),this.provider=null),this.options&&this.options._stream&&(this.options._stream=null),this.open&&(this._open=!1,super.emit("close"))}};X$=new WeakMap,dR(oO,X$,oO.ID_PREFIX="mc_");let Z3=oO;class sEt{constructor(e){this._options=e}_buildRequest(e){const n=this._options.secure?"https":"http",{host:i,port:r,path:s,key:a}=this._options,o=new URL(`${n}://${i}:${r}${s}${a}/${e}`);return o.searchParams.set("ts",`${Date.now()}${Math.random()}`),o.searchParams.set("version",MK.version),fetch(o.href,{referrerPolicy:this._options.referrerPolicy})}async retrieveId(){try{const e=await this._buildRequest("id");if(e.status!==200)throw new Error(`Error. Status:${e.status}`);return e.text()}catch(e){jn.error("Error retrieving ID",e);let n="";throw this._options.path==="/"&&this._options.host!==Fh.CLOUD_HOST&&(n=" If you passed in a `path` to your self-hosted PeerServer, you'll also need to pass in that same path when creating a new Peer."),new Error("Could not get an ID from the server."+n)}}async listAllPeers(){try{const e=await this._buildRequest("peers");if(e.status!==200){if(e.status===401){let n="";throw this._options.host===Fh.CLOUD_HOST?n="It looks like you're using the cloud server. You can email team@peerjs.com to enable peer listing for your API key.":n="You need to enable `allow_discovery` on your self-hosted PeerServer to use this feature.",new Error("It doesn't look like you have permission to list peers IDs. "+n)}throw new Error(`Error. Status:${e.status}`)}return e.json()}catch(e){throw jn.error("Error retrieving list peers",e),new Error("Could not get list peers from the server."+e)}}}var K$,Z$;const nT=class nT extends aSe{get type(){return Kg.Data}constructor(e,n,i){super(e,n,i),this.connectionId=this.options.connectionId||nT.ID_PREFIX+nSe(),this.label=this.options.label||this.connectionId,this.reliable=!!this.options.reliable,this._negotiator=new rSe(this),this._negotiator.startConnection(this.options._payload||{originator:!0,reliable:this.reliable})}_initializeDataChannel(e){this.dataChannel=e,this.dataChannel.onopen=()=>{jn.log(`DC#${this.connectionId} dc connection success`),this._open=!0,this.emit("open")},this.dataChannel.onmessage=n=>{jn.log(`DC#${this.connectionId} dc onmessage:`,n.data)},this.dataChannel.onclose=()=>{jn.log(`DC#${this.connectionId} dc closed for:`,this.peer),this.close()}}close(e){if(e!=null&&e.flush){this.send({__peerData:{type:"close"}});return}this._negotiator&&(this._negotiator.cleanup(),this._negotiator=null),this.provider&&(this.provider._removeConnection(this),this.provider=null),this.dataChannel&&(this.dataChannel.onopen=null,this.dataChannel.onmessage=null,this.dataChannel.onclose=null,this.dataChannel=null),this.open&&(this._open=!1,super.emit("close"))}send(e,n=!1){if(!this.open){this.emitError(BN.NotOpenYet,"Connection is not open. You should listen for the `open` event before sending messages.");return}return this._send(e,n)}async handleMessage(e){const n=e.payload;switch(e.type){case ul.Answer:await this._negotiator.handleSDP(e.type,n.sdp);break;case ul.Candidate:await this._negotiator.handleCandidate(n.candidate);break;default:jn.warn("Unrecognized message type:",e.type,"from peer:",this.peer);break}}};K$=new WeakMap,Z$=new WeakMap,dR(nT,K$,nT.ID_PREFIX="dc_"),dR(nT,Z$,nT.MAX_BUFFERED_AMOUNT=8388608);let J3=nT;class OK extends J3{get bufferSize(){return this._bufferSize}_initializeDataChannel(e){super._initializeDataChannel(e),this.dataChannel.binaryType="arraybuffer",this.dataChannel.addEventListener("message",n=>this._handleDataMessage(n))}_bufferedSend(e){(this._buffering||!this._trySend(e))&&(this._buffer.push(e),this._bufferSize=this._buffer.length)}_trySend(e){if(!this.open)return!1;if(this.dataChannel.bufferedAmount>J3.MAX_BUFFERED_AMOUNT)return this._buffering=!0,setTimeout(()=>{this._buffering=!1,this._tryBuffer()},50),!1;try{this.dataChannel.send(e)}catch(n){return jn.error(`DC#:${this.connectionId} Error when sending:`,n),this._buffering=!0,this.close(),!1}return!0}_tryBuffer(){if(!this.open||this._buffer.length===0)return;const e=this._buffer[0];this._trySend(e)&&(this._buffer.shift(),this._bufferSize=this._buffer.length,this._tryBuffer())}close(e){if(e!=null&&e.flush){this.send({__peerData:{type:"close"}});return}this._buffer=[],this._bufferSize=0,super.close()}constructor(...e){super(...e),this._buffer=[],this._bufferSize=0,this._buffering=!1}}class Uj extends OK{close(e){super.close(e),this._chunkedData={}}constructor(e,n,i){super(e,n,i),this.chunker=new tSe,this.serialization=pA.Binary,this._chunkedData={}}_handleDataMessage({data:e}){const n=bEe(e),i=n.__peerData;if(i){if(i.type==="close"){this.close();return}this._handleChunk(n);return}this.emit("data",n)}_handleChunk(e){const n=e.__peerData,i=this._chunkedData[n]||{data:[],count:0,total:e.total};if(i.data[e.n]=new Uint8Array(e.data),i.count++,this._chunkedData[n]=i,i.total===i.count){delete this._chunkedData[n];const r=Kbt(i.data);this._handleDataMessage({data:r})}}_send(e,n){const i=EEe(e);if(i instanceof Promise)return this._send_blob(i);if(!n&&i.byteLength>this.chunker.chunkedMTU){this._sendChunks(i);return}this._bufferedSend(i)}async _send_blob(e){const n=await e;if(n.byteLength>this.chunker.chunkedMTU){this._sendChunks(n);return}this._bufferedSend(n)}_sendChunks(e){const n=this.chunker.chunk(e);jn.log(`DC#${this.connectionId} Try to send ${n.length} chunks...`);for(const i of n)this.send(i,!0)}}class aEt extends OK{_handleDataMessage({data:e}){super.emit("data",e)}_send(e,n){this._bufferedSend(e)}constructor(...e){super(...e),this.serialization=pA.None}}class oEt extends OK{_handleDataMessage({data:e}){const n=this.parse(this.decoder.decode(e)),i=n.__peerData;if(i&&i.type==="close"){this.close();return}this.emit("data",n)}_send(e,n){const i=this.encoder.encode(this.stringify(e));if(i.byteLength>=Fh.chunkedMTU){this.emitError(BN.MessageToBig,"Message too big for JSON channel");return}this._bufferedSend(i)}constructor(...e){super(...e),this.serialization=pA.JSON,this.encoder=new TextEncoder,this.decoder=new TextDecoder,this.stringify=JSON.stringify,this.parse=JSON.parse}}var J$;const cO=class cO extends sSe{get id(){return this._id}get options(){return this._options}get open(){return this._open}get socket(){return this._socket}get connections(){const e=Object.create(null);for(const[n,i]of this._connections)e[n]=i;return e}get destroyed(){return this._destroyed}get disconnected(){return this._disconnected}constructor(e,n){super(),this._serializers={raw:aEt,json:oEt,binary:Uj,"binary-utf8":Uj,default:Uj},this._id=null,this._lastServerId=null,this._destroyed=!1,this._disconnected=!1,this._open=!1,this._connections=new Map,this._lostMessages=new Map;let i;if(e&&e.constructor==Object?n=e:e&&(i=e.toString()),n={debug:0,host:Fh.CLOUD_HOST,port:Fh.CLOUD_PORT,path:"/",key:cO.DEFAULT_KEY,token:Fh.randomToken(),config:Fh.defaultConfig,referrerPolicy:"strict-origin-when-cross-origin",serializers:{},...n},this._options=n,this._serializers={...this._serializers,...this.options.serializers},this._options.host==="/"&&(this._options.host=window.location.hostname),this._options.path&&(this._options.path[0]!=="/"&&(this._options.path="/"+this._options.path),this._options.path[this._options.path.length-1]!=="/"&&(this._options.path+="/")),this._options.secure===void 0&&this._options.host!==Fh.CLOUD_HOST?this._options.secure=Fh.isSecure():this._options.host==Fh.CLOUD_HOST&&(this._options.secure=!0),this._options.logFunction&&jn.setLogFunction(this._options.logFunction),jn.logLevel=this._options.debug||0,this._api=new sEt(n),this._socket=this._createServerConnection(),!Fh.supports.audioVideo&&!Fh.supports.data){this._delayedAbort(go.BrowserIncompatible,"The current browser does not support WebRTC");return}if(i&&!Fh.validateId(i)){this._delayedAbort(go.InvalidID,`ID "${i}" is invalid`);return}i?this._initialize(i):this._api.retrieveId().then(r=>this._initialize(r)).catch(r=>this._abort(go.ServerError,r))}_createServerConnection(){const e=new iEt(this._options.secure,this._options.host,this._options.port,this._options.path,this._options.key,this._options.pingInterval);return e.on(Lg.Message,n=>{this._handleMessage(n)}),e.on(Lg.Error,n=>{this._abort(go.SocketError,n)}),e.on(Lg.Disconnected,()=>{this.disconnected||(this.emitError(go.Network,"Lost connection to server."),this.disconnect())}),e.on(Lg.Close,()=>{this.disconnected||this._abort(go.SocketClosed,"Underlying socket is already closed.")}),e}_initialize(e){this._id=e,this.socket.start(e,this._options.token)}_handleMessage(e){const n=e.type,i=e.payload,r=e.src;switch(n){case ul.Open:this._lastServerId=this.id,this._open=!0,this.emit("open",this.id);break;case ul.Error:this._abort(go.ServerError,i.msg);break;case ul.IdTaken:this._abort(go.UnavailableID,`ID "${this.id}" is taken`);break;case ul.InvalidKey:this._abort(go.InvalidKey,`API KEY "${this._options.key}" is invalid`);break;case ul.Leave:jn.log(`Received leave message from ${r}`),this._cleanupPeer(r),this._connections.delete(r);break;case ul.Expire:this.emitError(go.PeerUnavailable,`Could not connect to peer ${r}`);break;case ul.Offer:{const s=i.connectionId;let a=this.getConnection(r,s);if(a&&(a.close(),jn.warn(`Offer received for existing Connection ID:${s}`)),i.type===Kg.Media){const c=new Z3(r,this,{connectionId:s,_payload:i,metadata:i.metadata});a=c,this._addConnection(r,a),this.emit("call",c)}else if(i.type===Kg.Data){const c=new this._serializers[i.serialization](r,this,{connectionId:s,_payload:i,metadata:i.metadata,label:i.label,serialization:i.serialization,reliable:i.reliable});a=c,this._addConnection(r,a),this.emit("connection",c)}else{jn.warn(`Received malformed connection type:${i.type}`);return}const o=this._getMessages(s);for(const c of o)a.handleMessage(c);break}default:{if(!i){jn.warn(`You received a malformed message from ${r} of type ${n}`);return}const s=i.connectionId,a=this.getConnection(r,s);a&&a.peerConnection?a.handleMessage(e):s?this._storeMessage(s,e):jn.warn("You received an unrecognized message:",e);break}}}_storeMessage(e,n){this._lostMessages.has(e)||this._lostMessages.set(e,[]),this._lostMessages.get(e).push(n)}_getMessages(e){const n=this._lostMessages.get(e);return n?(this._lostMessages.delete(e),n):[]}connect(e,n={}){if(n={serialization:"default",...n},this.disconnected){jn.warn("You cannot connect to a new Peer because you called .disconnect() on this Peer and ended your connection with the server. You can create a new Peer to reconnect, or call reconnect on this peer if you believe its ID to still be available."),this.emitError(go.Disconnected,"Cannot connect to new Peer after disconnecting from server.");return}const i=new this._serializers[n.serialization](e,this,n);return this._addConnection(e,i),i}call(e,n,i={}){if(this.disconnected){jn.warn("You cannot connect to a new Peer because you called .disconnect() on this Peer and ended your connection with the server. You can create a new Peer to reconnect."),this.emitError(go.Disconnected,"Cannot connect to new Peer after disconnecting from server.");return}if(!n){jn.error("To call a peer, you must provide a stream from your browser's `getUserMedia`.");return}const r=new Z3(e,this,{...i,_stream:n});return this._addConnection(e,r),r}_addConnection(e,n){jn.log(`add connection ${n.type}:${n.connectionId} to peerId:${e}`),this._connections.has(e)||this._connections.set(e,[]),this._connections.get(e).push(n)}_removeConnection(e){const n=this._connections.get(e.peer);if(n){const i=n.indexOf(e);i!==-1&&n.splice(i,1)}this._lostMessages.delete(e.connectionId)}getConnection(e,n){const i=this._connections.get(e);if(!i)return null;for(const r of i)if(r.connectionId===n)return r;return null}_delayedAbort(e,n){setTimeout(()=>{this._abort(e,n)},0)}_abort(e,n){jn.error("Aborting!"),this.emitError(e,n),this._lastServerId?this.disconnect():this.destroy()}destroy(){this.destroyed||(jn.log(`Destroy peer with ID:${this.id}`),this.disconnect(),this._cleanup(),this._destroyed=!0,this.emit("close"))}_cleanup(){for(const e of this._connections.keys())this._cleanupPeer(e),this._connections.delete(e);this.socket.removeAllListeners()}_cleanupPeer(e){const n=this._connections.get(e);if(n)for(const i of n)i.close()}disconnect(){if(this.disconnected)return;const e=this.id;jn.log(`Disconnect peer with ID:${e}`),this._disconnected=!0,this._open=!1,this.socket.close(),this._lastServerId=e,this._id=null,this.emit("disconnected",e)}reconnect(){if(this.disconnected&&!this.destroyed)jn.log(`Attempting reconnection to server with ID ${this._lastServerId}`),this._disconnected=!1,this._initialize(this._lastServerId);else{if(this.destroyed)throw new Error("This peer cannot reconnect to the server. It has already been destroyed.");if(!this.disconnected&&!this.open)jn.error("In a hurry? We're still trying to make the initial connection!");else throw new Error(`Peer ${this.id} cannot reconnect because it is not disconnected from the server!`)}}listAllPeers(e=n=>{}){this._api.listAllPeers().then(n=>e(n)).catch(n=>this._abort(go.ServerError,n))}};J$=new WeakMap,dR(cO,J$,cO.DEFAULT_KEY="peerjs");let C$=cO;var cEt=C$;let cp,FN,zN;const HN={},mA={},jN={},A$={},oSe={};function cSe(t,e,n=!1){const i=hc().createMediaStreamSource(e),r=new yr(5);Ep(i,r),t===nr()?(console.info("setup local voice",t),FN=e):console.info("setup remote voice",t),r.toDestination(),jN[t]=r}function lSe(t,e){const n=document.createElement("video");n.autoplay=!0,n.srcObject=e,t===nr()?zN=e:console.info("setup remote screen",t),h_.getState().setscreen(t,n),oSe[t]=n}function R$(t){var e,n;(e=jN[t])==null||e.dispose(),(n=mA[t])==null||n.close(),delete jN[t],delete mA[t],delete A$[t],delete oSe[t]}function M$(t){console.info("mediaconnection.metadata",t.metadata),t.on("stream",e=>{t.metadata.screen?lSe(t.peer,e):cSe(t.peer,e)}),t.on("close",()=>{R$(t.peer)}),t.on("error",()=>{R$(t.peer)})}function NK(){se(cp)||(cp=new cEt(nr()),cp.on("call",t=>{t.answer(),M$(t),setTimeout(m8,1e3)}),cp.on("error",t=>{Ui(je,nr(),"usermedia",t.toString())}))}function uSe(){se(cp)&&(cp.destroy(),cp=void 0)}async function lEt(){try{return await navigator.mediaDevices.getUserMedia({audio:{echoCancellation:!1,noiseSuppression:!1}})}catch(t){Ui(je,nr(),"uservoice",t.toString())}}function uEt(){NK(),lEt().then(t=>{se(t)&&(cSe(nr(),t),m8())}).catch(t=>{Ui(je,nr(),"uservoice",t.toString())})}function hEt(){R$(nr()),FN=void 0,se(zN)||uSe()}async function fEt(){try{return await navigator.mediaDevices.getDisplayMedia({audio:!0,video:!0})}catch(t){Ui(je,nr(),"userscreenshare",t.toString())}}function dEt(){NK(),fEt().then(t=>{se(t)&&(lSe(nr(),t),m8())}).catch(t=>{Ui(je,nr(),"userscreen",t.toString())})}function pEt(){zN=void 0,se(FN)||uSe()}function mEt(t){NK(),se(cp)&&(HN[t]=!0)}function gEt(t){var e,n;se(cp)&&((e=mA[t])==null||e.close(),(n=jN[t])==null||n.dispose(),delete HN[t],delete mA[t],delete jN[t])}function m8(){if(!se(cp))return;const t=Object.keys(HN);if(se(FN))for(let e=0;e<t.length;++e){const n=t[e];if(n===nr())continue;const i=mA[n];if(!se(i)||!i.open){const r=cp.call(n,FN,{metadata:{voice:!0}});mA[n]=r,M$(r)}}if(se(zN))for(let e=0;e<t.length;++e){const n=t[e];if(n===nr())continue;const i=A$[n];if(!se(i)||!i.open){const r=cp.call(n,zN,{metadata:{screen:!0}});A$[n]=r,M$(r)}}}function hSe(t){const e={};for(let i=0;i<t.length;++i){const r=t[i];se(HN[r])||(e[r]=!0,mEt(r))}const n=Object.keys(HN);for(let i=0;i<n.length;++i){const r=n[i];se(e[r])||gEt(r)}m8()}function vEt(t,e,n,i){const r=e*n*4;for(let s=0,a=0;s<r;++a)t.image.data[s]=i[a]*255,s+=4;return t.needsUpdate=!0,t}function _Et(t,e){const n=new Uint8Array(4*t*e);return new up(n,t,e)}const yEt=new Hc({transparent:!1,side:dl,uniforms:{color:{value:new yn(0,0,0)},data:{value:null}},vertexShader:`
      #include <clipping_planes_pars_vertex>
  
      varying vec2 vUv;
    
      void main() {
        vec4 mvPosition = modelViewMatrix * vec4(position, 1.0);
        gl_Position = projectionMatrix * mvPosition;
        
        vUv = uv;
        
        #include <clipping_planes_vertex>
      }
    `,fragmentShader:`
      #include <clipping_planes_pars_fragment>
  
      uniform vec3 color;
      uniform sampler2D data;
  
      varying vec2 vUv;

      // adapted from https://www.shadertoy.com/view/Mlt3z8
      float bayerDither2x2( vec2 v ) {
        return mod( 3.0 * v.y + 2.0 * v.x, 4.0 );
      }

      float bayerDither4x4( vec2 v ) {
        vec2 P1 = mod( v, 2.0 );
        vec2 P2 = mod( floor( 0.5  * v ), 2.0 );
        return 4.0 * bayerDither2x2( P1 ) + bayerDither2x2( P2 );
      }

      void main() {
        #include <clipping_planes_fragment>
  
        float alpha = texture2D(data, vUv).r;
        if (alpha < 1.0) {
          vec2 ditherCoord = floor( mod( gl_FragCoord.xy, 4.0 ) );
          if ( bayerDither4x4( ditherCoord ) / 16.0 >= alpha ) {
            discard;
          }
        }

        gl_FragColor.rgba = vec4(color.xyz, 1.0);
      }
    `});function bEt(){return d8(yEt)}const Q3=[0,1,0],fSe=[1,1,0],eB=[1,0,0],dSe=[0,0,0],EEt=new Float32Array([...Q3,...eB,...fSe,...Q3,...dSe,...eB]),SEt=new Float32Array([...Q3.slice(0,2),...eB.slice(0,2),...fSe.slice(0,2),...Q3.slice(0,2),...dSe.slice(0,2),...eB.slice(0,2)]);function TEt(t,e,n,i,r,s){const a=e*n*4;for(let o=0,c=0;o<a;++c){const l=i[c]??0;t.image.data[o++]=l%Kh,t.image.data[o++]=Math.floor(l/Kh),t.image.data[o++]=r[c]??16,t.image.data[o++]=s[c]??16}return t.needsUpdate=!0,t}function xEt(t,e){const n=new Uint8Array(4*t*e),i=new up(n,t,e,tI,El);return i.internalFormat="RGBA8UI",i}function pSe(t,e,n){const i=e*kn.DRAW_CHAR_WIDTH(),r=n*kn.DRAW_CHAR_HEIGHT(),s=EEt.map((a,o)=>{switch(o%3){case 0:return a*i;case 1:return a*r;default:return a}});t.setAttribute("position",new rr(s,3)),t.setAttribute("uv",new rr(SEt,2)),t.computeBoundingBox(),t.computeBoundingSphere()}const wEt=yN(T1(PA)),yae=sC(DA(kI)),CEt=new Hc({transparent:!1,side:dl,uniforms:{time:zd,interval:f8,palette:new Yi(wEt),map:new Yi(yae),alt:new Yi(yae),data:new Yi(null),size:{value:new Rt},step:{value:new Rt},flip:new Yi(!0)},vertexShader:`
    #include <clipping_planes_pars_vertex>
    varying vec2 vUv;
    void main() {
      vec4 mvPosition = modelViewMatrix * vec4(position, 1.0);
      gl_Position = projectionMatrix * mvPosition;
      vUv = uv;
      #include <clipping_planes_vertex>
    }
  `,fragmentShader:`
    #include <clipping_planes_pars_fragment>

    uniform float time;
    uniform float interval;
    uniform sampler2D map;
    uniform sampler2D alt;
    uniform usampler2D data;
    uniform vec3 palette[16];
    uniform vec2 size;
    uniform vec2 step;
    uniform bool flip;
    varying vec2 vUv;

    void main() {
      #include <clipping_planes_fragment>

      uvec4 tiledata = texture(data, vUv);
      int colori = int(tiledata.z);
      int bgi = int(tiledata.w);

      vec2 charPosition = mod(vUv, size) / size;
      vec2 uv = vec2(charPosition.x * step.x, charPosition.y * step.y);
      vec3 color = palette[colori];

      uv.x += step.x * float(tiledata.x);
      uv.y += step.y * float(tiledata.y);
      if (flip) {
        uv.y = 1.0 - uv.y;
      }

      bool useAlt = mod(time, interval * 2.0) > interval;
      vec3 blip = useAlt ? texture(alt, uv).rgb : texture(map, uv).rgb;

      if (blip.r == 0.0) {
        if (bgi >= ${Jt.ONCLEAR}) {
          discard;
        }
        color = palette[bgi];
      }

      gl_FragColor.rgb = color;
      gl_FragColor.a = 1.0;
    }
  `});function AEt(){return d8(CEt)}function Dk({width:t,height:e,alphas:n}){const i=p8(),r=Fe.useRef(null),[s]=Fe.useState(()=>bEt());return Fe.useEffect(()=>{s.uniforms.data.value=_Et(t,e)},[s.uniforms.data,t,e]),Fe.useEffect(()=>{vEt(s.uniforms.data.value,t,e,n)},[s.uniforms.data.value,t,e,n]),Fe.useEffect(()=>{r.current&&(pSe(r.current,t,e),s.clipping=i.length>0,s.clippingPlanes=i,s.needsUpdate=!0)},[s,i,t,e]),Me.jsx("mesh",{material:s,children:Me.jsx("bufferGeometry",{ref:r})})}function REt({width:t,height:e,alpha:n}){const i=Fe.useMemo(()=>new Array(t*e).fill(n),[t,e,n]);return Me.jsx(Dk,{width:t,height:e,alphas:i})}const YR=new Ile,LS=new Rt;function VN({width:t,height:e,top:n,left:i,right:r,bottom:s,scale:a=.125,alpha:o=.25}){const c=Fe.useMemo(()=>{const l=new Array(t*e);YR.min.x=i,YR.min.y=n,YR.max.x=r,YR.max.y=s,LS.x=0,LS.y=0;for(let u=0;u<l.length;++u)l[u]=Rce.smootherstep(1-YR.distanceToPoint(LS)*a,0,1)*o,++LS.x,LS.x>=t&&(LS.x=0,++LS.y);return l},[t,e,n,i,r,s,a,o]);return Me.jsx(Dk,{width:t,height:e,alphas:c})}const MEt=F9,OEt=yN(T1(PA)),bae=sC(DA(kI)),NEt=new Hc({transparent:!1,side:dl,uniforms:{time:zd,interval:f8,smoothrate:new Yi(MEt),palette:new Yi(OEt),map:new Yi(bae),alt:new Yi(bae),dpr:new Yi(1),screenwidth:new Yi(1),screenheight:new Yi(1),pointSize:{value:new Rt(1,1)},rows:new Yi(1),step:new Yi(new Rt),flip:new Yi(!0)},vertexShader:`
    #include <clipping_planes_pars_vertex>

    attribute float visible;
    attribute vec4 charData;
    attribute vec3 lastPosition;
    attribute vec2 lastColor;
    attribute vec2 lastBg;
    attribute vec2 animShake;
    attribute vec2 animBounce;

    uniform float smoothrate;
    uniform float time;
    uniform float interval;
    uniform vec2 pointSize;
    uniform vec3 palette[16];
    uniform float dpr;
    uniform float screenwidth;
    uniform float screenheight;
    uniform float tindex;

    varying float vVisible;
    varying vec2 vCharData;
    varying vec3 vColor;
    varying vec4 vBg;

    float rand(float co) {
      return fract(sin(co*(91.3458)) * 47453.5453);
    }

    vec3 colorFromIndex(float index) {
      return palette[int(index)];
    }

    vec4 bgFromIndex(float index) {
      vec4 bg;
      if (int(index) >= 16) {
        return vec4(0.0, 0.0, 0.0, 0.0);
      }
      bg.rgb = colorFromIndex(index);
      bg.a = 1.0;
      return bg;
    }

    float animDelta(float startTime, float deltaMod, float maxDelta) {
      float delta = time - startTime;
      if (delta < 0.0) {
        return maxDelta;
      }
      return clamp(delta * deltaMod, 0.0, maxDelta);
    }

    void main() {
      vVisible = visible;

      float deltaPosition = clamp((time - lastPosition.z) * smoothrate, 0.0, 1.0);
      vec2 animPosition = mix(lastPosition.xy, position.xy, deltaPosition);

      float deltaShake = 1.0 - animDelta(animShake.y, smoothrate * 0.5, 1.0); 
      animPosition += vec2(
        deltaShake - rand(cos(time) + animShake.x) * deltaShake * 2.0,
        deltaShake - rand(sin(time) + animShake.x) * deltaShake * 2.0
      ) * 0.5;

      float deltaBounce = 1.0 - abs(1.0 - animDelta(animBounce.y, smoothrate, 2.0));
      animPosition.y -= smoothstep(0.0, 1.0, deltaBounce);

      float deltaColor = animDelta(lastColor.y, smoothrate, 1.0);
      vec3 sourceColor = colorFromIndex(lastColor.x);
      vec3 destColor = colorFromIndex(charData.z);
      vColor = mix(sourceColor, destColor, deltaColor);

      float deltaBg = animDelta(lastBg.y, smoothrate, 1.0);
      vec4 sourceBg = bgFromIndex(lastBg.x);
      vec4 destBg = bgFromIndex(charData.w);
      vBg = mix(sourceBg, destBg, deltaBg);

      vCharData.xy = charData.xy;

      // draw space
      float xpadding = (pointSize.y - pointSize.x);
      animPosition *= pointSize;
      animPosition.x += pointSize.x * 0.5;
      animPosition.x += xpadding * 0.5;
      animPosition.y += pointSize.y;

      // model space
      vec4 mvPosition = modelViewMatrix * vec4(animPosition, 0.0, 1.0);

      // transform to screenspace 
      gl_Position = projectionMatrix * mvPosition;

      // this handles things being scaled
      float ptaspect = (screenwidth / screenheight);
      float ptsize = pointSize.y + ptaspect;
      
      gl_PointSize = (screenheight * (ptsize + 0.5)) / gl_Position.w;
      gl_PointSize *= dpr;
      gl_Position.y -= ptsize - ptaspect;
      
      #include <clipping_planes_vertex>
    }
  `,fragmentShader:`
    #include <clipping_planes_pars_fragment>

    uniform float time;
    uniform float interval;
    uniform sampler2D map;
    uniform sampler2D alt;
    uniform float rows;
    uniform vec2 step;
    uniform vec2 pointSize;
    uniform bool flip;

    varying float vVisible;
    varying vec2 vCharData;
    varying vec3 vColor;
    varying vec4 vBg;

    void main() {
      #include <clipping_planes_fragment>

      float xscale = pointSize.y / pointSize.x;
      float px = gl_PointCoord.x * xscale;
      
      if (vVisible == 0.0 || px >= 1.0) {
        discard;
      }

      vec2 lookup = vec2(vCharData.x, vCharData.y);

      float py = gl_PointCoord.y;
      if (flip) {
        py = 1.0 - py;
      }
      vec2 idx = vec2(px, py);
      vec2 char = vec2(lookup.x * step.x, (rows - lookup.y) * step.y);
      vec2 uv = idx * step + char;

      bool useAlt = mod(time, interval * 2.0) > interval;
      vec3 blip = useAlt ? texture2D(alt, uv).rgb : texture2D(map, uv).rgb;

      if (blip.r == 0.0) {
        if (vBg.a < 0.001) {
          discard;
        } else {
          gl_FragColor = vBg;
        }
      } else {
        gl_FragColor.rgb = vColor;
        gl_FragColor.a = 1.0;
      }
    }
  `});function IEt(){return d8(NEt)}const kEt=F9,DEt=yN(T1(PA)),Eae=sC(DA(kI)),PEt=new Hc({transparent:!1,side:dl,uniforms:{time:zd,interval:f8,smoothrate:new Yi(kEt),palette:new Yi(DEt),map:new Yi(Eae),alt:new Yi(Eae),dpr:new Yi(1),screenwidth:new Yi(1),screenheight:new Yi(1),pointSize:{value:new Rt(1,1)},rows:new Yi(1),step:new Yi(new Rt),flip:new Yi(!0)},vertexShader:`
    #include <clipping_planes_pars_vertex>

    attribute float visible;
    attribute vec4 charData;
    attribute vec3 lastPosition;
    attribute vec2 lastColor;
    attribute vec2 lastBg;
    attribute vec2 animShake;
    attribute vec2 animBounce;

    uniform float smoothrate;
    uniform float time;
    uniform float interval;
    uniform vec2 pointSize;
    uniform vec3 palette[16];
    uniform float dpr;
    uniform float tindex;

    varying float vVisible;
    varying vec2 vCharData;
    varying vec3 vColor;
    varying vec4 vBg;

    float rand(float co) {
      return fract(sin(co*(91.3458)) * 47453.5453);
    }

    vec3 colorFromIndex(float index) {
      return palette[int(index)];
    }

    vec4 bgFromIndex(float index) {
      vec4 bg;
      if (int(index) >= 16) {
        return vec4(0.0, 0.0, 0.0, 0.0);
      }
      bg.rgb = colorFromIndex(index);
      bg.a = 1.0;
      return bg;
    }

    float animDelta(float startTime, float deltaMod, float maxDelta) {
      float delta = time - startTime;
      if (delta < 0.0) {
        return maxDelta;
      }
      return clamp(delta * deltaMod, 0.0, maxDelta);
    }

    void main() {
      vVisible = visible;

      float deltaPosition = clamp((time - lastPosition.z) * smoothrate, 0.0, 1.0);
      vec2 animPosition = mix(lastPosition.xy, position.xy, deltaPosition);

      float deltaShake = 1.0 - animDelta(animShake.y, smoothrate * 0.5, 1.0); 
      animPosition += vec2(
        deltaShake - rand(cos(time) + animShake.x) * deltaShake * 2.0,
        deltaShake - rand(sin(time) + animShake.x) * deltaShake * 2.0
      ) * 0.5;

      float deltaBounce = 1.0 - abs(1.0 - animDelta(animBounce.y, smoothrate, 2.0));
      animPosition.y -= smoothstep(0.0, 1.0, deltaBounce);

      float deltaColor = animDelta(lastColor.y, smoothrate, 1.0);
      vec3 sourceColor = colorFromIndex(lastColor.x);
      vec3 destColor = colorFromIndex(charData.z);
      vColor = mix(sourceColor, destColor, deltaColor);

      float deltaBg = animDelta(lastBg.y, smoothrate, 1.0);
      vec4 sourceBg = bgFromIndex(lastBg.x);
      vec4 destBg = bgFromIndex(charData.w);
      vBg = mix(sourceBg, destBg, deltaBg);

      vCharData.xy = charData.xy;

      animPosition = animPosition * pointSize;
      animPosition += pointSize * 0.5;
      animPosition.x += (pointSize.y - pointSize.x) * 0.5;

      vec4 mvPosition = modelViewMatrix * vec4(animPosition, 0.0, 1.0);
      gl_Position = projectionMatrix * mvPosition;      

      // this handles things being scaled
      gl_PointSize = pointSize.y * modelViewMatrix[0][0] * dpr;
      
      #include <clipping_planes_vertex>
    }
  `,fragmentShader:`
    #include <clipping_planes_pars_fragment>

    uniform float time;
    uniform float interval;
    uniform sampler2D map;
    uniform sampler2D alt;
    uniform float rows;
    uniform vec2 step;
    uniform vec2 pointSize;
    uniform bool flip;

    varying float vVisible;
    varying vec2 vCharData;
    varying vec3 vColor;
    varying vec4 vBg;

    void main() {
      #include <clipping_planes_fragment>

      float xscale = pointSize.y / pointSize.x;
      float px = gl_PointCoord.x * xscale;
      
      if (vVisible == 0.0 || px >= 1.0) {
        discard;
      }

      vec2 lookup = vec2(vCharData.x, vCharData.y);

      float py = gl_PointCoord.y;
      if (flip) {
        py = 1.0 - py;
      }
      vec2 idx = vec2(px, py);
      vec2 char = vec2(lookup.x * step.x, (rows - lookup.y) * step.y);
      vec2 uv = idx * step + char;

      bool useAlt = mod(time, interval * 2.0) > interval;
      vec3 blip = useAlt ? texture2D(alt, uv).rgb : texture2D(map, uv).rgb;

      if (blip.r == 0.0) {
        if (vBg.a < 1.0) {
          discard;
        } else {
          gl_FragColor = vBg;
        }
      } else {
        gl_FragColor.rgb = vColor;
        gl_FragColor.a = 1.0;
      }
    }
  `});function LEt(){return d8(PEt)}const Sae=2048;function mSe({sprites:t,fliptexture:e=!0,withbillboards:n=!1}){const{viewport:i}=oh(),r=h_(d=>d.palettedata),s=h_(d=>d.charsetdata),a=h_(d=>d.altcharsetdata),o=Fe.useMemo(()=>n?IEt():LEt(),[n]),c=p8(),l=Fe.useRef(null),u=Fe.useRef([]),{width:h=0,height:f=0}=(s==null?void 0:s.image)??{};return Fe.useMemo(()=>{var y;u.current.length===0&&(u.current=Array.from({length:Sae},()=>({id:"",x:0,y:0,char:0,color:0,bg:0})));const d={};for(let v=0;v<t.length;++v)d[t[v].id]=t[v];const p=new Set(u.current.map(v=>v.id));let g=0;for(let v=0;v<Sae;++v)if(u.current[v].id){const b=d[u.current[v].id];se(b)?u.current[v]={...b}:u.current[v].id=""}else if(g<t.length){for(;p.has((y=t[g])==null?void 0:y.id)===!0;)++g;g<t.length&&(u.current[v]={...t[g++]})}},[t]),Fe.useEffect(()=>{const{current:d}=l,{current:p}=u;if(!d||!p)return;let g=d.getAttribute("visible"),y=d.getAttribute("lastVisible"),v=d.getAttribute("position"),b=d.getAttribute("charData"),T=d.getAttribute("lastPosition"),x=d.getAttribute("lastColor"),M=d.getAttribute("lastBg"),R=d.getAttribute("animShake"),I=d.getAttribute("animBounce");if(!g||g.count!==p.length){g=new rr(new Float32Array(p.length),1),y=new rr(new Float32Array(p.length),1),v=new rr(new Float32Array(p.length*3),3),b=new rr(new Float32Array(p.length*4),4),T=new rr(new Float32Array(p.length*3),3),x=new rr(new Float32Array(p.length*2),2),M=new rr(new Float32Array(p.length*2),2),R=new rr(new Float32Array(p.length*2),2),I=new rr(new Float32Array(p.length*2),2);for(let k=0;k<p.length;++k){const P=p[k],U=P.id?1:0;g.setX(k,U),y.setX(k,U),v.setXY(k,P.x,P.y),b.setXYZW(k,P.char%Kh,Math.floor(P.char/Kh),P.color,P.bg),T.setXYZ(k,P.x,P.y,zd.value),x.setXY(k,P.color,zd.value),M.setXY(k,P.bg,zd.value),R.setXY(k,0,zd.value-1e6),I.setXY(k,0,zd.value-1e6)}d.setAttribute("visible",g),d.setAttribute("lastVisible",y),d.setAttribute("position",v),d.setAttribute("charData",b),d.setAttribute("lastPosition",T),d.setAttribute("lastColor",x),d.setAttribute("lastBg",M),d.setAttribute("animShake",R),d.setAttribute("animBounce",I)}else for(let k=0;k<p.length;++k){const P=p[k],U=v.getX(k),G=v.getY(k),$=b.getX(k),q=b.getY(k),Y=b.getZ(k),ie=b.getW(k);y.setX(k,g.getX(k)),y.needsUpdate=!0,g.setX(k,P.id?1:0),g.needsUpdate=!0;const V=y.getX(k)===0&&g.getX(k)===1;(V||U!==P.x||G!==P.y)&&(T.setXYZ(k,V?P.x:U,V?P.y:G,zd.value),T.needsUpdate=!0,v.setXY(k,P.x,P.y),v.needsUpdate=!0),(V||Y!==P.color)&&(x.setXY(k,V?P.color:Y,zd.value),x.needsUpdate=!0,b.setZ(k,P.color),b.needsUpdate=!0),(V||ie!==P.bg)&&(M.setXY(k,V?P.bg:ie,zd.value),M.needsUpdate=!0,b.setW(k,P.bg),b.needsUpdate=!0);const J=P.char%Kh,X=Math.floor(P.char/Kh);($!==J||q!==X)&&(b.setXY(k,J,X),b.needsUpdate=!0)}d.computeBoundingBox(),d.computeBoundingSphere()},[t]),Fe.useEffect(()=>{if(!s||!l.current)return;const d=Math.round(h/Gg),p=Math.round(f/qg);o.uniforms.palette.value=r,o.uniforms.map.value=s,o.uniforms.alt.value=a??s,o.uniforms.dpr.value=1,o.uniforms.screenwidth.value=i.width,o.uniforms.screenheight.value=i.height,o.uniforms.pointSize.value.x=kn.DRAW_CHAR_WIDTH(),o.uniforms.pointSize.value.y=kn.DRAW_CHAR_HEIGHT(),o.uniforms.rows.value=p-1,o.uniforms.step.value.x=1/d,o.uniforms.step.value.y=1/p,o.uniforms.flip.value=e,o.clipping=c.length>0,o.clippingPlanes=c,o.needsUpdate=!0},[r,s,a,o,h,f,e,c,n,i.width,i.height]),Me.jsx("points",{frustumCulled:!1,material:o,children:Me.jsx("bufferGeometry",{ref:l})})}function IK({width:t,height:e,char:n,color:i,bg:r,fliptexture:s=!0}){const a=h_(p=>p.palettedata),o=h_(p=>p.charsetdata),c=h_(p=>p.altcharsetdata),l=p8(),[u]=Fe.useState(()=>AEt()),h=Fe.useRef(null),{width:f=0,height:d=0}=(o==null?void 0:o.image)??{};return Fe.useEffect(()=>{t===0||e===0||(u.uniforms.data.value=xEt(t,e))},[u.uniforms.data,t,e]),Fe.useEffect(()=>{t===0||e===0||TEt(u.uniforms.data.value,t,e,n,i,r)},[u.uniforms.data.value,t,e,n,i,r]),Fe.useEffect(()=>{t===0||e===0||!h.current||!o||(pSe(h.current,t,e),u.uniforms.map.value=o,u.uniforms.alt.value=c??o,u.uniforms.palette.value=a,u.uniforms.size.value.x=1/t,u.uniforms.size.value.y=1/e,u.uniforms.step.value.x=1/Math.round(f/Gg),u.uniforms.step.value.y=1/Math.round(d/qg),u.uniforms.flip.value=s,u.clipping=l.length>0,u.clippingPlanes=l,u.needsUpdate=!0)},[a,o,c,u,t,e,f,d,s,l]),Me.jsx("mesh",{material:u,children:Me.jsx("bufferGeometry",{ref:h})})}function tO({id:t,z:e,from:n}){const i=h_(),r=xo(Sp(a=>{var o;return(o=a.gadget[n])==null?void 0:o.find(c=>c.id===t)})),s=(r==null?void 0:r.type)===$f.MEDIA?r:void 0;switch(Fe.useEffect(()=>{switch(s==null?void 0:s.mime){case"image/palette":Li(s.media)&&i.setpalette(Zw(Xb,h9,s.media));break;case"image/charset":Li(s.media)&&i.setcharset(Zw(Kh*Gg,ZO*qg,s.media));break;case"image/altcharset":Li(s.media)&&i.setaltcharset(Zw(Kh*Gg,ZO*qg,s.media));break;case"text/players":On(s.media)&&hSe(s.media.split(","));break}},[i,s]),r==null?void 0:r.type){default:case $f.BLANK:case $f.MEDIA:return null;case $f.TILES:return Me.jsx("group",{position:[0,0,e],children:Me.jsx(IK,{width:r.width,height:r.height,char:[...r.char],color:[...r.color],bg:[...r.bg]})},r.id);case $f.SPRITES:return Me.jsx("group",{position:[0,0,e],children:Me.jsx(mSe,{sprites:[...r.sprites]})},r.id);case $f.DITHER:return Me.jsx("group",{position:[0,0,e],children:Me.jsx(Dk,{width:r.width,height:r.height,alphas:[...r.alphas]})},r.id)}}function UEt({width:t,height:e}){const n=t*kn.DRAW_CHAR_WIDTH(),i=e*kn.DRAW_CHAR_HEIGHT(),r=Fe.useRef(null),s=Fe.useRef(null),a=Fe.useRef(null),o=Fe.useRef(null);gE((h,f)=>{if(!r.current||!s.current||!a.current||!o.current)return;const d=LU(xo.getState().gadget.layers??[]);se(s.current.userData.focusx)||(a.current.scale.setScalar(d.viewscale),s.current.userData={focusx:d.focusx,focusy:d.focusy,tfocusx:d.focusx,tfocusy:d.focusy,facing:d.facing},s.current.position.set(-d.focusx*kn.DRAW_CHAR_WIDTH(),-d.focusy*kn.DRAW_CHAR_HEIGHT(),0));const p=.25,g=s.current.userData.focusx,y=s.current.userData.focusy,v=g*kn.DRAW_CHAR_WIDTH(),b=y*kn.DRAW_CHAR_HEIGHT();X3(s.current.position,[-v,-b,0],p,f);const T=Math.abs(s.current.userData.focusx-s.current.userData.tfocusx),x=Math.abs(s.current.userData.focusy-s.current.userData.tfocusy);T<1&&x<1&&X3(a.current.scale,d.viewscale,p,f);const M=a.current.scale.x,R=1/M,k=Math.abs(M-d.viewscale)>.01,P=M<dm.MID,$=(M*kn.DRAW_CHAR_WIDTH()-kn.DRAW_CHAR_WIDTH())*R,q=kn.DRAW_CHAR_WIDTH()+$,V=(M*kn.DRAW_CHAR_HEIGHT()-kn.DRAW_CHAR_HEIGHT())*R,J=kn.DRAW_CHAR_HEIGHT()+V;o.current.position.set(v-g*q,b-y*J,0);const X=kn.DRAW_CHAR_WIDTH()*M,ee=kn.DRAW_CHAR_HEIGHT()*M,oe=n/X,fe=i/ee;if(k&&(s.current.userData.tfocusx=d.focusx+.5,s.current.userData.tfocusy=d.focusy+.5),r.current.position.set(n*.5,i*.5,0),!k)if(P)s.current.userData.tfocusx=d.focusx+.5,s.current.userData.tfocusy=d.focusy+.5;else{const ke=Math.round(oe*.25),St=Math.round(fe*.25),Mt=Math.round(s.current.userData.tfocusx-d.focusx);if(Math.abs(Mt)>=ke){const _e=Mt<0?ke:-ke;s.current.userData.tfocusx+=_e*2}const Ee=Math.round(s.current.userData.tfocusy-d.focusy);if(Math.abs(Ee)>=St){const _e=Ee<0?St:-St;s.current.userData.tfocusy+=_e*2}}const Re=Math.round(oe*.5),He=Math.round(fe*.5),Te=d.width-oe*.5,Le=d.height-fe*.5,we=-Math.round((oe-d.width)*.5),Ce=-Math.round((fe-d.height)*.5);we>=0?(s.current.userData.tfocusx<Re&&(k&&(s.current.userData.focusx=Re),s.current.userData.tfocusx=Re),s.current.userData.tfocusx>Te&&(k&&(s.current.userData.focusx=Te),s.current.userData.tfocusx=Te)):s.current.userData.tfocusx=Re+we,Ce>=0?(s.current.userData.tfocusy<He&&(k&&(s.current.userData.focusy=He),s.current.userData.tfocusy=He),s.current.userData.tfocusy>Le&&(k&&(s.current.userData.focusy=Le),s.current.userData.tfocusy=Le)):s.current.userData.tfocusy=He+Ce,p_(s.current.userData,"focusx",s.current.userData.tfocusx,p),p_(s.current.userData,"focusy",s.current.userData.tfocusy,p)}),xo(h=>{var f;return((f=h.gadget.over)==null?void 0:f.length)??0}),xo(h=>{var f;return((f=h.gadget.under)==null?void 0:f.length)??0}),xo(h=>{var f;return((f=h.gadget.layers)==null?void 0:f.length)??0});const{over:c=[],under:l=[],layers:u=[]}=xo.getState().gadget;return Me.jsx("group",{ref:r,children:Me.jsx("group",{ref:s,children:Me.jsx("group",{ref:a,children:Me.jsxs("group",{ref:o,children:[Me.jsx(Bbt,{}),l.map((h,f)=>Me.jsx(tO,{from:"under",id:h.id,z:f*2},h.id)),u.map((h,f)=>Me.jsx(tO,{from:"layers",id:h.id,z:l.length+f*2},h.id)),c.map((h,f)=>Me.jsx(tO,{from:"over",id:h.id,z:l.length+u.length+f*2},h.id))]})})})})}function BEt({id:t,z:e,from:n}){const i=h_(),r=xo(Sp(a=>{var o;return(o=a.gadget[n])==null?void 0:o.find(c=>c.id===t)})),s=(r==null?void 0:r.type)===$f.MEDIA?r:void 0;switch(Fe.useEffect(()=>{switch(s==null?void 0:s.mime){case"image/palette":Li(s.media)&&i.setpalette(Zw(Xb,h9,s.media));break;case"image/charset":Li(s.media)&&i.setcharset(Zw(Kh*Gg,ZO*qg,s.media));break;case"image/altcharset":Li(s.media)&&i.setaltcharset(Zw(Kh*Gg,ZO*qg,s.media));break;case"text/players":On(s.media)&&hSe(s.media.split(","));break}},[i,s]),r==null?void 0:r.type){default:case $f.BLANK:case $f.MEDIA:return null;case $f.TILES:return Me.jsx("group",{position:[0,0,e],children:Me.jsx(IK,{width:r.width,height:r.height,char:[...r.char],color:[...r.color],bg:[...r.bg]})},r.id);case $f.SPRITES:return Me.jsx("group",{position:[0,0,e],children:Me.jsx(mSe,{sprites:[...r.sprites],withbillboards:!0,fliptexture:!1})},r.id);case $f.DITHER:return Me.jsx("group",{position:[0,0,e],children:Me.jsx(Dk,{width:r.width,height:r.height,alphas:[...r.alphas]})},r.id)}}function FEt({viewwidth:t,viewheight:e,children:n}){return Me.jsxs("mesh",{position:[t*.5,e*.5,0],children:[Me.jsx("planeGeometry",{args:[t,e]}),Me.jsx("meshBasicMaterial",{transparent:!0,children:Me.jsx(hyt,{attach:"map",width:t,height:e,depthBuffer:!0,stencilBuffer:!1,generateMipmaps:!1,children:n})})]})}function Tae(t){switch(t){case dm.NEAR:return 160;default:case dm.MID:return 320;case dm.FAR:return 768}}function zEt(t){switch(t){case dm.NEAR:return 1;default:case dm.MID:return 1;case dm.FAR:return-1}}function HEt(t){switch(t){case dm.NEAR:return .888;default:case dm.MID:return .777;case dm.FAR:return .444}}function jEt({width:t,height:e}){const n=t*kn.DRAW_CHAR_WIDTH(),i=e*kn.DRAW_CHAR_HEIGHT(),r=Fe.useRef(null),s=Fe.useRef(null),a=Fe.useRef(null),o=Fe.useRef(null),c=Fe.useRef(null);gE((p,g)=>{if(!r.current||!s.current||!a.current||!o.current||!c.current)return;const y=LU(xo.getState().gadget.layers??[]),v=t*kn.DRAW_CHAR_WIDTH(),b=e*kn.DRAW_CHAR_HEIGHT(),T=fi*kn.DRAW_CHAR_WIDTH(),x=Fr*kn.DRAW_CHAR_HEIGHT();se(o.current.userData.focusx)||(o.current.userData={focusx:y.focusx,focusy:y.focusy,facing:y.facing,focusz:Tae(y.viewscale)}),s.current.position.x=0,s.current.position.y=b-x;const M=lr(v/T,1,10);a.current.position.x=v-T*M,a.current.position.y=0,a.current.scale.setScalar(M);const R=.125,I=zEt(y.viewscale),k=o.current.userData.focusx,P=o.current.userData.focusy,U=(k+.5)*-kn.DRAW_CHAR_WIDTH(),G=(P+I)*-kn.DRAW_CHAR_HEIGHT();X3(c.current.position,[0,0,Tae(y.viewscale)],R,g),K_t(r.current.rotation,[HEt(y.viewscale),0,0],R,g),X3(o.current.position,[U,G,0],R,g),p_(o.current.userData,"focusx",y.focusx,R),p_(o.current.userData,"focusy",y.focusy,R),r.current.position.y=I,r.current.rotation.z=y.facing}),xo(p=>{var g;return((g=p.gadget.over)==null?void 0:g.length)??0}),xo(p=>{var g;return((g=p.gadget.under)==null?void 0:g.length)??0}),xo(p=>{var g;return((g=p.gadget.layers)==null?void 0:g.length)??0});const{over:l=[],under:u=[],layers:h=[]}=xo.getState().gadget,f=u.length*2+2,d=f+2;return Me.jsxs(Me.Fragment,{children:[Me.jsx("group",{"position-z":f,children:Me.jsxs(FEt,{viewwidth:n,viewheight:i,children:[Me.jsx(nyt,{ref:c,makeDefault:!0,manual:!0,near:1,far:2e3,aspect:n/i}),Me.jsx("group",{ref:r,children:Me.jsx("group",{ref:o,children:h.map(p=>Me.jsx(BEt,{id:p.id,from:"layers",z:0},p.id))})})]})}),Me.jsx("group",{ref:a,children:u.map((p,g)=>Me.jsx(tO,{from:"under",id:p.id,z:g*2},p.id))}),Me.jsx("group",{ref:s,"position-z":d,children:l.map((p,g)=>Me.jsx(tO,{from:"over",id:p.id,z:g*2},p.id))})]})}var kK={};Object.defineProperty(kK,"__esModule",{value:!0});var gSe=kK.GamepadHelper=void 0;const Ya=class Ya{static getButtonValue(e,n){var i,r;return(r=(i=Ya.gamepads[e])==null?void 0:i.buttons[n])==null?void 0:r.value}static getAxisValue(e,n){var i;return(i=Ya.gamepads[e])==null?void 0:i.axes[n]}static update(){Ya.checkForNewGamepads(),!(!Ya.gamepads||Object.keys(Ya.gamepads).length<1)&&(Ya.gamepadsLastUpdate&&Object.keys(Ya.gamepadsLastUpdate).length>0&&Object.values(Ya.gamepads).forEach(e=>{var n;for(let i=0;i<e.buttons.length;i++){const r=(n=Ya.gamepadsLastUpdate[e.index])==null?void 0:n.buttons[i],s=e.buttons[i];(s==null?void 0:s.value)==1&&(r==null?void 0:r.value)==0?Ya.dispatchButtonDownEvent(e.index,i):(s==null?void 0:s.value)==0&&(r==null?void 0:r.value)==1&&Ya.dispatchButtonUpEvent(e.index,i)}}),Ya.gamepadsLastUpdate=Object.assign({},Ya.gamepads))}static checkForNewGamepads(){const e=navigator.getGamepads();for(const n of e)n&&(Ya.gamepads[n.index]||Ya.logOutput&&console.log("gamepad "+n.index+" connected"),Ya.gamepads[n.index]=n)}static dispatchButtonDownEvent(e,n){Ya.logOutput&&console.log(`gamepad ${e}: button ${n} is down`),document.dispatchEvent(new CustomEvent("gamepadbuttondown",{detail:{gamepad:e,button:n}}))}static dispatchButtonUpEvent(e,n){Ya.logOutput&&console.log(`gamepad ${e}: button ${n} is up`),document.dispatchEvent(new CustomEvent("gamepadbuttonup",{detail:{gamepad:e,button:n}}))}};Qn(Ya,"gamepads",{}),Qn(Ya,"gamepadsLastUpdate"),Qn(Ya,"logOutput",!1);let O$=Ya;gSe=kK.GamepadHelper=O$;var G_={};Object.defineProperty(G_,"__esModule",{value:!0});var VEt=typeof window<"u"&&/Mac|iPod|iPhone|iPad/.test(window.navigator.platform),Bj={alt:"altKey",control:"ctrlKey",meta:"metaKey",shift:"shiftKey"},vSe={add:"+",break:"pause",cmd:"meta",command:"meta",ctl:"control",ctrl:"control",del:"delete",down:"arrowdown",esc:"escape",ins:"insert",left:"arrowleft",mod:VEt?"meta":"control",opt:"alt",option:"alt",return:"enter",right:"arrowright",space:" ",spacebar:" ",up:"arrowup",win:"meta",windows:"meta"},DK={backspace:8,tab:9,enter:13,shift:16,control:17,alt:18,pause:19,capslock:20,escape:27," ":32,pageup:33,pagedown:34,end:35,home:36,arrowleft:37,arrowup:38,arrowright:39,arrowdown:40,insert:45,delete:46,meta:91,numlock:144,scrolllock:145,";":186,"=":187,",":188,"-":189,".":190,"/":191,"`":192,"[":219,"\\":220,"]":221,"'":222};for(var VP=1;VP<20;VP++)DK["f"+VP]=111+VP;function g8(t,e,n){e&&!("byKey"in e)&&(n=e,e=null),Array.isArray(t)||(t=[t]);var i=t.map(function(a){return _Se(a,e)}),r=function(o){return i.some(function(c){return ySe(c,o)})},s=n==null?r:r(n);return s}function GEt(t,e){return g8(t,e)}function qEt(t,e){return g8(t,{byKey:!0},e)}function _Se(t,e){var n=e&&e.byKey,i={};t=t.replace("++","+add");var r=t.split("+"),s=r.length;for(var a in Bj)i[Bj[a]]=!1;var o=!0,c=!1,l=void 0;try{for(var u=r[Symbol.iterator](),h;!(o=(h=u.next()).done);o=!0){var f=h.value,d=f.endsWith("?")&&f.length>1;d&&(f=f.slice(0,-1));var p=PK(f),g=Bj[p];if(f.length>1&&!g&&!vSe[f]&&!DK[p])throw new TypeError('Unknown modifier: "'+f+'"');(s===1||!g)&&(n?i.key=p:i.which=bSe(f)),g&&(i[g]=d?null:!0)}}catch(y){c=!0,l=y}finally{try{!o&&u.return&&u.return()}finally{if(c)throw l}}return i}function ySe(t,e){for(var n in t){var i=t[n],r=void 0;if(i!=null&&(n==="key"&&e.key!=null?r=e.key.toLowerCase():n==="which"?r=i===91&&e.which===93?91:e.which:r=e[n],!(r==null&&i===!1)&&r!==i))return!1}return!0}function bSe(t){t=PK(t);var e=DK[t]||t.toUpperCase().charCodeAt(0);return e}function PK(t){return t=t.toLowerCase(),t=vSe[t]||t,t}var xae=G_.default=g8;G_.isHotkey=g8;G_.isCodeHotkey=GEt;G_.isKeyHotkey=qEt;G_.parseHotkey=_Se;G_.compareHotkey=ySe;G_.toKeyCode=bSe;G_.toKeyName=PK;function ESe(t){return{all:t=t||new Map,on:function(e,n){var i=t.get(e);i?i.push(n):t.set(e,[n])},off:function(e,n){var i=t.get(e);i&&(n?i.splice(i.indexOf(n)>>>0,1):t.set(e,[]))},emit:function(e,n){var i=t.get(e);i&&i.slice().map(function(r){r(n)}),(i=t.get("*"))&&i.slice().map(function(r){r(e,n)})}}}const Og={[tn.NONE]:!1,[tn.ALT]:!1,[tn.CTRL]:!1,[tn.SHIFT]:!1,[tn.MOVE_UP]:!1,[tn.MOVE_DOWN]:!1,[tn.MOVE_LEFT]:!1,[tn.MOVE_RIGHT]:!1,[tn.OK_BUTTON]:!1,[tn.CANCEL_BUTTON]:!1,[tn.MENU_BUTTON]:!1};let Z2=0,wae=performance.now();const GN=200;function SSe(){const t=performance.now(),e=t-wae;if(Z2+=e,Z2>=GN){Z2%=GN;const n={alt:!!Og[tn.ALT],ctrl:!!Og[tn.CTRL],shift:!!Og[tn.SHIFT]};[tn.MOVE_UP,tn.MOVE_DOWN,tn.MOVE_LEFT,tn.MOVE_RIGHT,tn.OK_BUTTON,tn.CANCEL_BUTTON,tn.MENU_BUTTON].forEach(r=>{Og[r]&&xSe(r,n)})}wae=t,gSe.update(),setTimeout(SSe,100)}SSe();function Ku(t){Og[t]||(Z2=0,xSe(t,{alt:Og[tn.ALT],ctrl:Og[tn.CTRL],shift:Og[tn.SHIFT]})),Og[t]=!0}function Nc(t){Og[t]=!1}const wg={root:ESe(),ignorehotkeys:!1},TSe=Fe.createContext(wg.root);function v8(t){return{alt:t.altKey,ctrl:tE?t.metaKey:t.ctrlKey,shift:t.shiftKey}}function xSe(t,e){wg.root.emit(tn[t],e)}document.addEventListener("keydown",t=>{const e=si(t.key),n=v8(t),i=nr();switch(e){case"s":case"j":case"o":case"f":case"z":case"y":case"e":case"k":case"p":case"arrowleft":case"arrowright":case"arrowup":case"arrowdown":n.ctrl&&t.preventDefault();break;case"tab":t.preventDefault();break}switch(n.alt?Ku(tn.ALT):Nc(tn.ALT),n.ctrl?Ku(tn.CTRL):Nc(tn.CTRL),n.shift?Ku(tn.SHIFT):Nc(tn.SHIFT),e){case"arrowleft":Ku(tn.MOVE_LEFT);break;case"arrowright":Ku(tn.MOVE_RIGHT);break;case"arrowup":Ku(tn.MOVE_UP);break;case"arrowdown":Ku(tn.MOVE_DOWN);break;case"enter":Ku(tn.OK_BUTTON);break;case"esc":case"escape":Ku(tn.CANCEL_BUTTON);break;case"tab":Ku(tn.MENU_BUTTON);break;case"s":n.ctrl&&n_(je,i,"#save");break;case"j":n.ctrl&&n_(je,i,n.shift?"#jointab hush":"#jointab");break;case"o":n.ctrl&&n_(je,i,n.shift?"#joincode hush":"#joincode");break;case"p":n.ctrl&&xFe(je,i);break;case"l":break;case"f":n.ctrl&&n_(je,i,"#fork");break}wg.root.emit("keydown",t)},{capture:!0});document.addEventListener("keyup",t=>{const e=si(t.key),n=v8(t);switch(n.alt?Ku(tn.ALT):Nc(tn.ALT),n.ctrl?Ku(tn.CTRL):Nc(tn.CTRL),n.shift?Ku(tn.SHIFT):Nc(tn.SHIFT),e){case"meta":Nc(tn.MOVE_LEFT),Nc(tn.MOVE_RIGHT),Nc(tn.MOVE_UP),Nc(tn.MOVE_DOWN);break;case"arrowleft":Nc(tn.MOVE_LEFT);break;case"arrowright":Nc(tn.MOVE_RIGHT);break;case"arrowup":Nc(tn.MOVE_UP);break;case"arrowdown":Nc(tn.MOVE_DOWN);break;case"enter":Nc(tn.OK_BUTTON);break;case"esc":case"escape":Nc(tn.CANCEL_BUTTON);break;case"tab":Nc(tn.MENU_BUTTON);break}},{capture:!0});yE("userinput",["tock"],t=>{switch(t.target){case"up":pn(t.data)&&Nc(t.data);break;case"down":pn(t.data)&&Ku(t.data);break}});const $Et=0,WEt=1,YEt=2,XEt=3,KEt=4,ZEt=5,JEt=6,QEt=7,eSt=9,tSt=12,nSt=13,iSt=14,rSt=15,wSe={[$Et]:tn.OK_BUTTON,[WEt]:tn.CANCEL_BUTTON,[YEt]:tn.OK_BUTTON,[XEt]:tn.CANCEL_BUTTON,[KEt]:tn.ALT,[ZEt]:tn.CTRL,[JEt]:tn.SHIFT,[QEt]:tn.SHIFT,[eSt]:tn.MENU_BUTTON,[tSt]:tn.MOVE_UP,[nSt]:tn.MOVE_DOWN,[iSt]:tn.MOVE_LEFT,[rSt]:tn.MOVE_RIGHT};document.addEventListener("gamepadbuttondown",t=>{Ku(wSe[t.detail.button])});document.addEventListener("gamepadbuttonup",t=>{Nc(wSe[t.detail.button])});const Cae="keyup";function fC({hotkey:t,althotkey:e,children:n}){return Fe.useEffect(()=>{const i=xae(t,{byKey:!0}),r=se(e)?xae(e,{byKey:!0}):void 0;function s(a){wg.ignorehotkeys===!1&&(i(a)||r!=null&&r(a))&&n()}return document.addEventListener(Cae,s,!1),()=>document.removeEventListener(Cae,s,!1)},[t,e,n]),null}function dc(t){const e=Fe.useContext(TSe);return Fe.useEffect(()=>{const n=Object.entries(t);return n.forEach(([i,r])=>e.on(i,r)),()=>{n.forEach(([i,r])=>e.off(i,r))}},[e,t]),null}function H1({blockhotkeys:t,children:e}){const[n]=Fe.useState(()=>ESe());return Fe.useEffect(()=>{const i=wg.root,r=wg.ignorehotkeys;return wg.root=n,wg.ignorehotkeys=!!t,()=>{wg.root=i,wg.ignorehotkeys=r}},[n,t]),Me.jsx(TSe.Provider,{value:n,children:e})}function US(t,e,n){let i=0;n.alt&&(i|=Epe),n.ctrl&&(i|=Spe),n.shift&&(i|=Tpe),Nb(t)&&_Fe(je,t,e,i)}function sSt({width:t,height:e}){const n=nr();xo(s=>{var a;return((a=s.gadget.layers)==null?void 0:a.length)??0}),xo(s=>LU(s.gadget.layers??[]).graphics);const{layers:i=[]}=xo.getState().gadget,r=LU(i);return Me.jsxs(Me.Fragment,{children:[Me.jsx(dc,{MOVE_LEFT:s=>US(n,tn.MOVE_LEFT,s),MOVE_RIGHT:s=>US(n,tn.MOVE_RIGHT,s),MOVE_UP:s=>US(n,tn.MOVE_UP,s),MOVE_DOWN:s=>US(n,tn.MOVE_DOWN,s),OK_BUTTON:s=>US(n,tn.OK_BUTTON,s),CANCEL_BUTTON:s=>US(n,tn.CANCEL_BUTTON,s),MENU_BUTTON:s=>US(n,tn.MENU_BUTTON,s),keydown:s=>{const{key:a}=s;switch(si(a)){case"t":aFe(je,nr());break}}}),Me.jsx(Qf,{visible:!0,color:new yn(.076,.076,0),width:t,height:e,z:-3}),r.graphics==="flat"&&Me.jsx(UEt,{width:t,height:e}),r.graphics==="mode7"&&Me.jsx(jEt,{width:t,height:e})]})}const C0=Fe.createContext({sendmessage(){},sendclose(){},didclose(){}}),Aae={input:{color:"$white",active:"$yellow"}};function Mp(t){return t?Aae.input.active:Aae.input.color}function Pk(t,e){switch(t){case"touchkey":return`register:${t}:${e}`}return`vm:${t}:${e}`}function mM(t,e,n=0,i=""){return`${t.substring(0,e)}${i}${t.substring(e+n)}`}function hd(t,e){se(t)&&(e.x=1,e.y=t)}const Vy=32,CSe=8,N$=new Ae;function aSt(){const t=kn.DRAW_CHAR_WIDTH(),e=kn.DRAW_CHAR_HEIGHT(),n=Math.floor(N$.x/t),i=Math.floor(N$.y/e);return{x:Vy*.5+n,y:CSe*.5+i}}function oSt({chip:t,row:e,label:n,args:i,context:r}){hd(e,r);const[s]=[mu(i[0],"")],a=EE(t,s),c=ZI(a)??0,l=ud(),[u,h]=Fe.useState(!1);Fe.useLayoutEffect(()=>{h(!0)},[]);const f=`${c}`.padStart(3,"0"),d=n.trim(),p=r.x-1,g=r.y+2,y=[`$green${d} ${f}
$white`];for(let k=0;k<256;++k)if(k%Vy===0&&y.push(`
`),k===c){const P=l?"$green$onwhite":"$white$ongreen";y.push(`${P}$${k}$white$ondkblue`)}else y.push(`$${k}`);const v=y.join("");ri(v,r,!0);const b=Fe.useContext(C0),T=Fe.useCallback(()=>{c>=Vy&&pl(a,c-Vy)},[a,c]),x=Fe.useCallback(()=>{c>0&&pl(a,c-1)},[a,c]),M=Fe.useCallback(()=>{c<255&&pl(a,c+1)},[a,c]),R=Fe.useCallback(()=>{c<=255-Vy&&pl(a,c+Vy)},[a,c]),I=Fe.useCallback(()=>{b.sendclose()},[b]);return Me.jsx("group",{position:[p*kn.DRAW_CHAR_WIDTH(),g*kn.DRAW_CHAR_HEIGHT(),1],children:u&&Me.jsxs(H1,{blockhotkeys:!0,children:[Me.jsx(Qf,{blocking:!0,visible:!1,width:Vy,height:CSe,onClick:k=>{k.intersections[0].object.worldToLocal(N$.copy(k.intersections[0].point));const P=YT(aSt(),Vy);P>=0&&P<=255&&(pl(a,P),b.sendclose())}}),Me.jsx(dc,{MOVE_LEFT:x,MOVE_UP:T,MOVE_RIGHT:M,MOVE_DOWN:R,OK_BUTTON:I,CANCEL_BUTTON:I})]})})}const Gy=8,ASe=2,I$=new Ae;function cSt(){const t=kn.DRAW_CHAR_WIDTH(),e=kn.DRAW_CHAR_HEIGHT(),n=Math.floor(I$.x/t),i=Math.floor(I$.y/e);return{x:Gy*.5+n,y:ASe*.5+i}}function lSt({chip:t,row:e,label:n,args:i,context:r}){hd(e,r);const[s]=[mu(i[0],"")],a=EE(t,s),c=ZI(a)??0,l=ud(),[u,h]=Fe.useState(!1);Fe.useLayoutEffect(()=>{h(!0)},[]);const f=`${c}`.padStart(2,"0"),d=n.trim(),p=(Jt[c]||Jt[Jt.BLACK]).padEnd(12," ").toLowerCase(),g=r.x-1,y=r.y+2,v=[`$green${d} ${f} ${p}
$white`];for(let k=0;k<16;++k)if(k%Gy===0&&v.push(`
`),k===c){const P=k<8?"$white":"$black",U=l?P:`$${Jt[k]}`;v.push(`${U}$219`)}else v.push(`$${Jt[k]}$219`);v.push("$white"),ri(v.join(""),r,!0);const b=Fe.useContext(C0),T=Fe.useCallback(()=>{c>=Gy&&pl(a,c-Gy)},[a,c]),x=Fe.useCallback(()=>{c>0&&pl(a,c-1)},[a,c]),M=Fe.useCallback(()=>{c<15&&pl(a,c+1)},[a,c]),R=Fe.useCallback(()=>{c<=15-Gy&&pl(a,c+Gy)},[a,c]),I=Fe.useCallback(()=>{b.sendclose()},[b]);return Me.jsx("group",{position:[g*kn.DRAW_CHAR_WIDTH(),y*kn.DRAW_CHAR_HEIGHT(),1],children:u&&Me.jsxs(H1,{blockhotkeys:!0,children:[Me.jsx(Qf,{blocking:!0,visible:!1,width:Gy,height:ASe,onClick:k=>{k.intersections[0].object.worldToLocal(I$.copy(k.intersections[0].point));const P=cSt(),U=YT(P,Gy);U>=0&&U<=16&&(pl(a,U),b.sendclose())}}),Me.jsx(dc,{MOVE_LEFT:x,MOVE_UP:T,MOVE_RIGHT:M,MOVE_DOWN:R,OK_BUTTON:I,CANCEL_BUTTON:I})]})})}function uSt({item:t,row:e,context:n}){return hd(e,n),ri(`${t}${se(e)?`
`:""}`,n,!0),null}function hSt({chip:t,row:e,active:n,label:i,args:r,context:s}){hd(e,s);const[a,o]=[mu(r[0],""),r[1]],c=Mp(n);ri(`  $purple$16 ${c}${i}
`,s,!0);const l=Fe.useContext(C0),u=Fe.useCallback(()=>{l.sendmessage(Pk(t,a),o),l.sendclose()},[l,t,a,o]);return n&&Me.jsx(dc,{OK_BUTTON:u})}function fSt({chip:t,row:e,active:n,label:i,args:r,context:s}){var y;hd(e,s);const[a,o,c,l]=[mu(r[0],""),mu(r[1],((y=r[1])==null?void 0:y.toString())??""),mu(r[2],""),mu(r[3],"")],u=c||` ${o.toUpperCase()} `,h=Mp(n),f=s.x-.25,d=s.y-.25;ri(`${s.iseven?"$black$onltgray":"$black$ondkcyan"}${u}${h}$onclear ${i}${se(e)?`
`:""}`,s,!0);const p=Fe.useContext(C0),g=Fe.useCallback(()=>{p.sendmessage(Pk(t,a)),l||p.sendclose()},[t,p,a,l]);return Me.jsxs("group",{position:[f*kn.DRAW_CHAR_WIDTH(),d*kn.DRAW_CHAR_HEIGHT(),1],children:[Me.jsx(Qf,{visible:!1,width:u.length+.5,height:1.5,blocking:!0,onClick:g}),n&&Me.jsx(dc,{OK_BUTTON:g}),o&&Me.jsx(fC,{hotkey:o,children:g})]})}function dSt({chip:t,row:e,active:n,label:i,args:r,context:s}){hd(e,s);const[a,o]=[mu(r[0],""),r[1]],c=Mp(n);ri(`  $purple$16 ${c}${i}
`,s,!0);const l=Fe.useContext(C0),u=Fe.useCallback(()=>{l.sendmessage(Pk(t,a),o),l.sendclose()},[l,t,a,o]);return n&&Me.jsx(dc,{OK_BUTTON:u})}function pSt({chip:t,row:e,active:n,label:i,args:r,context:s}){hd(e,s);const[a,o]=[mu(r[0],""),r[1]],c=Mp(n);ri(`  $purple$16 ${c}${i}
`,s,!0);const l=Fe.useContext(C0),u=Fe.useCallback(()=>{l.sendmessage(Pk(t,a),o),l.sendclose()},[l,t,a,o]);return n&&Me.jsx(dc,{OK_BUTTON:u})}function mSt({chip:t,row:e,active:n,label:i,args:r,context:s}){hd(e,s);const[a,o,c]=[mu(r[0],""),hT(r[1],-1),hT(r[2],-1)];let l,u;o===-1?(l=0,u=31):c===-1?(l=0,u=o):(l=o,u=c);const h=EE(t,a),f=ZI(h),d=f??0,p=ud(),[g,y]=Fe.useState(""),[v,b]=Fe.useState(0),[T,x]=Fe.useState(!1);let M=`${d}`;const R=i.trim(),I=Mp(n);T&&(M=p?mM(g,v,1,"$219+"):g),s.writefullwidth=32,ri(`  # ${I}${R} $green${M}`,s,!1),s.writefullwidth=void 0,ri(`
`,s,!1);const k=Fe.useCallback(G=>{const $=G.alt?10:1;pl(h,Math.min(u,d+$))},[u,d,h]),P=Fe.useCallback(G=>{const $=G.alt?10:1;pl(h,Math.max(l,d-$))},[l,d,h]),U=Fe.useCallback(()=>{x(G=>{const $=!G;if($){const q=`${f}`;y(q),b(q.length)}else{const q=parseFloat(g),Y=isNaN(q)?0:q;pl(a,Math.min(u,Math.max(l,Y)))}return $})},[u,l,g,a,f]);return f!==void 0&&Me.jsxs(Me.Fragment,{children:[n&&!T&&Me.jsx(dc,{MOVE_LEFT:P,MOVE_RIGHT:k,OK_BUTTON:U}),T&&Me.jsxs(H1,{blockhotkeys:!0,children:[Me.jsx(fC,{hotkey:"ctrl+c",children:()=>{console.info("copy")}}),Me.jsx(fC,{hotkey:"ctrl+v",children:()=>{console.info("paste")}}),Me.jsx(fC,{hotkey:"ctrl+a",children:()=>{console.info("select all")}}),Me.jsx(dc,{MOVE_LEFT:()=>{b(G=>Math.max(0,G-1))},MOVE_RIGHT:()=>{b(G=>Math.min(g.length,G+1))},CANCEL_BUTTON:U,OK_BUTTON:U,keydown:G=>{switch(si(G.key)){case"delete":g.length>0&&y($=>mM($,v,1));break;case"backspace":v>0&&(y($=>mM($,v-1,1)),b($=>Math.max(0,$-1)));break}G.key.length===1&&g.length<s.width*.5&&(y($=>mM($,v,0,G.key)),b($=>$+1))}})]})]})}function gSt({chip:t,row:e,active:n,label:i,args:r,context:s}){hd(e,s);const[a,o,c]=[mu(r[0],""),mu(r[1],""),mu(r[2],"")];let l,u;o===""?(l="L ",u=" H"):c===""?(l="L ",u=` ${o}`):(l=`${o} `,u=` ${c}`);const h=0,f=8,d=EE(t,a),g=ZI(d)??0,y=ud(),v=i.trim(),b=Mp(n);ri(` $red $29 ${b}${v} `,s,!1);const x=mM("----:----",g,1,`$green${n?y?"$26":"$27":"$4"}${b}`).replaceAll("-","$7").replaceAll(":","$9");ri(`${b}${l}${x}${u} $green${g+1}
`,s,!1);const M=Fe.useCallback(I=>{const k=I.alt?10:1;pl(d,Math.min(f,g+k))},[f,g,d]),R=Fe.useCallback(I=>{const k=I.alt?10:1;pl(d,Math.max(h,g-k))},[h,g,d]);return Me.jsx(Me.Fragment,{children:n&&Me.jsx(dc,{MOVE_LEFT:R,MOVE_RIGHT:M})})}function vSt({chip:t,row:e,active:n,label:i,args:r,context:s}){hd(e,s);const[a,...o]=[mu(r[0],""),...r.slice(1)],c=[],l=[];for(let x=0;x<o.length;x+=2)c.push(o[x]),l.push(o[x+1]);const u=EE(t,a),f=`${ZI(u)??0}`;let d=l.indexOf(f);d<0&&(d=0);const p=ud(),g=i.trim(),y=Mp(n);ri(` $dkred ? ${y}${g} `,s,!1);const v=n?p?"$26":"$27":"/";ri(`${d+1}$green${v}${y}${l.length}`,s,!1),s.writefullwidth=32,ri(` $green${c[d]}`,s,!1),s.writefullwidth=void 0,ri(`
`,s,!1);const b=Fe.useCallback(()=>{const x=Math.min(0,d-1),M=parseFloat(l[x]);Number.isInteger(M)&&pl(u,M)},[d,u]),T=Fe.useCallback(()=>{const x=Math.max(l.length-1,d+1),M=parseFloat(l[x]);Number.isInteger(M)&&pl(u,M)},[d,u]);return Me.jsx(Me.Fragment,{children:n&&Me.jsx(dc,{MOVE_LEFT:b,MOVE_RIGHT:T})})}function _St({chip:t,row:e,active:n,label:i,args:r,context:s}){hd(e,s);const a=mu(r[0],""),o=EE(t,a),c=C0e(o),l=(c==null?void 0:c.toJSON())??"",u=ud(),[h,f]=Fe.useState(0),[d,p]=Fe.useState(!1),[g,y]=Fe.useState(void 0),v=`${l} `,b=i.trim(),T=Mp(n);ri(`$green  $20 ${T}${b} $green`,s,!1);const x=s.x,R=s.y*s.width;s.writefullwidth=32,ri(`${v}`,s,!1),s.writefullwidth=void 0,ri(`
`,s,!1);const I=se(g),k=s.width-x-2,P=I?Math.min(g,h):h;let U=I?Math.max(g,h):h;I&&(U!==P&&U===h&&--U,_N(x+P+R,x+U+R,15,8,s)),d&&u&&JF(x+h+R,"Û",s);function G(){se(c)&&(f(P),y(void 0),c.delete(P,U-P+1))}return Me.jsxs(Me.Fragment,{children:[n&&Me.jsx(dc,{OK_BUTTON:()=>{c&&(p(!0),f(c.length),y(void 0))}}),d&&Me.jsx(H1,{blockhotkeys:!0,children:Me.jsx(dc,{MOVE_LEFT:$=>{$.shift?se(g)||y(lr(h-1,0,l.length)):y(void 0),f(q=>lr(q-1,0,l.length))},MOVE_RIGHT:$=>{$.shift?se(g)||y(h):y(void 0),f(q=>lr(q+1,0,l.length))},CANCEL_BUTTON:()=>{p(!1),f(l.length),y(void 0)},OK_BUTTON:()=>p(!1),keydown:$=>{if(!c)return;const{key:q}=$,Y=si(q),ie={alt:$.altKey,ctrl:tE?$.metaKey:$.ctrlKey,shift:$.shiftKey},V=c.toJSON();switch(Y){case"delete":I?G():V.length>0&&c.delete(h,1);break;case"backspace":I?G():h>0&&(c.delete(h-1,1),f(J=>Math.max(0,J-1)));break;default:if(ie.ctrl)switch(Y){case"a":y(0),f(V.length);break;case"c":se(Pa())&&Pa().writeText(c.toJSON()).catch(J=>console.error(J));break;case"v":se(Pa())&&Pa().readText().then(J=>{I&&G(),c.insert(h,J),f(h+J.length)}).catch(J=>console.error(J));break;case"x":se(Pa())&&Pa().writeText(c.toJSON()).then(()=>G()).catch(J=>console.error(J));break}else ie.alt||q.length===1&&V.length<k&&(c.insert(h,q),f(J=>J+1));break}}})})]})}function ySt({chip:t,row:e,active:n,label:i,args:r,context:s}){hd(e,s);const[a]=[mu(r[0],"")],o="z",c=` ${o.toUpperCase()} `,l=Mp(n),u=s.x-.25,h=s.y-.25;ri(`${s.iseven?"$black$onltgray":"$black$ondkcyan"}${c}${l}$onclear ${i}${se(e)?`
`:""}`,s,!0);const f=Fe.useContext(C0),d=Fe.useCallback(()=>{f.sendmessage(Pk(t,a),void 0)},[f,t,a]);return Me.jsxs("group",{position:[u*kn.DRAW_CHAR_WIDTH(),h*kn.DRAW_CHAR_HEIGHT(),1],children:[Me.jsx(Qf,{visible:!1,width:c.length+.5,height:1.5,blocking:!0,onClick:d}),n&&Me.jsx(dc,{OK_BUTTON:d}),Me.jsx(fC,{hotkey:o,children:d})]})}function bSt({row:t,item:e,active:n}){const i=nr(),r=Cm();if(hd(t,r),r.iseven=r.y%2===0,typeof e=="string")return Me.jsx(uSt,{player:i,item:e,row:t,context:r});if(Li(e)){const[s,a,o,c,...l]=e;if(typeof s!="string"||typeof a!="string"||typeof o!="string")return null;const u={player:i,chip:s,row:t,active:n,label:a,args:[o,...l],context:r},h=On(c)?c:"";switch(si(h)){default:case"hyperlink":return Me.jsx(dSt,{...u});case"hk":case"hotkey":return Me.jsx(fSt,{...u});case"rn":case"range":return Me.jsx(gSt,{...u});case"sl":case"select":return Me.jsx(vSt,{...u});case"nm":case"number":return Me.jsx(mSt,{...u});case"tx":case"text":return Me.jsx(_St,{...u});case"copyit":return Me.jsx(hSt,{...u});case"linkit":return Me.jsx(pSt,{...u});case"zssedit":return Me.jsx(ySt,{...u});case"charedit":return Me.jsx(oSt,{...u});case"coloredit":return Me.jsx(lSt,{...u})}ZF(r)}return null}function Lk({store:t,children:e}){return Me.jsx(iX.Provider,{value:t,children:e})}function Uk({width:t,height:e}){const n=Fe.useContext(iX),[i,r,s]=l9(n,Sp(a=>[a.char,a.color,a.bg,a.render]));return t>0&&e>0&&Me.jsx(IK,{char:i.slice(),color:r.slice(),bg:s.slice(),width:t,height:e})}function LK({inline:t=!1,xmargin:e=1,ymargin:n=1,selected:i=-1,width:r,height:s,color:a,bg:o,text:c}){const l=nk(r,s,0,a,o),u=l.getState(),h={...CE(r,s,a,o,n,e,r-e,s-n),...l.getState(),x:e,y:n};return dve(u,0,a,o),Me.jsxs(Lk,{store:l,children:[Me.jsx(Uk,{width:r,height:s}),Me.jsx(Yy.Provider,{value:h,children:c.map((f,d)=>Me.jsx(bSt,{row:t?void 0:d,item:f,active:d===i},d))})]})}const ESt=2,SSt=14,RSe=SSt*ESt;function TSt(t){return cF(t,RSe*.5)}function xSt(t,e,n,i,r=1.235){function s(o){return Y_t(o,i)}p_(t.userData,e,n,r,i,RSe*12,s),t.position[e]=TSt(t.userData[e]);const a=n-t.position.y;return Math.abs(a)<.1}function wSt({name:t,width:e,height:n,context:i}){const r=pve();for(let l=1;l<e-1;++l)l>2&&l<e-1&&Uo(r,e,n,l,1,{char:205,color:15}),Uo(r,e,n,l,n-1,{char:205,color:15});Uo(r,e,n,e-2,0,{char:196,color:15}),Uo(r,e,n,1,0,{char:205,color:15}),Uo(r,e,n,2,0,{char:187,color:15}),Uo(r,e,n,2,1,{char:200,color:15});for(let l=1;l<n-1;++l)Uo(r,e,n,0,l,{char:179,color:15}),Uo(r,e,n,e-1,l,{char:179,color:15});for(let l=2;l<n-1;++l)Uo(r,e,n,1,l,{char:0,color:15}),Uo(r,e,n,e-2,l,{char:0,color:15});Uo(r,e,n,0,0,{char:213,color:15}),Uo(r,e,n,e-1,0,{char:191,color:15}),Uo(r,e,n,e-1,1,{char:181,color:15}),Uo(r,e,n,0,n-1,{char:212,color:15}),Uo(r,e,n,e-1,n-1,{char:190,color:15});const s=` ${t} `,a=tk(s,e,n),o=(a==null?void 0:a.x)??s.length,c=e-2;return i.x=2+Math.round(c*.5),i.x-=Math.round(o*.5),i.y++,ri(s,i,!0),null}function Rae({x:t,y:e,color:n,on:i=232,off:r=7,alt:s}){const a=ud(),o=pve(),c=Fe.useRef(0),l=se(s)?c.current%2===0?i:s:i;return Uo(o,o.width,o.height,t,e,{char:a?l:r,color:n}),o.changed(),a&&++c.current,null}function CSt({store:t,children:e}){return Me.jsx(hve.Provider,{value:t,children:e})}function ASt({width:t,height:e}){const n=Fe.useContext(hve),[i]=l9(n,Sp(r=>[r.dither,r.render]));return t>0&&e>0&&Me.jsx(Dk,{alphas:i.slice(),width:t,height:e})}function RSt({row:t,width:e,height:n,panelwidth:i,panelheight:r,children:s}){const a=IXe(i,r,0),o=[.001,.05,.1,.2],c=.4,{dither:l}=a.getState();NXe(l);for(let u=0;u<i;++u){Z5(l,i,r,u,t,c);for(let h=0;h<o.length;++h){const f=o.length-h;Z5(l,i,r,u,t-f,o[h]),Z5(l,i,r,u,t+f,o[h])}}return Me.jsxs(Me.Fragment,{children:[Me.jsx(Uk,{width:e,height:n}),Me.jsxs("group",{position:[2*kn.DRAW_CHAR_WIDTH(),2*kn.DRAW_CHAR_HEIGHT(),0],children:[Me.jsx(CSt,{store:a,children:Me.jsx(ASt,{width:i,height:r})}),s,Me.jsx(Rae,{x:1,y:1}),Me.jsx(Rae,{x:1,y:2+t,on:26,alt:27,off:45,color:12})]})]})}function UK({line:t,color:e,margin:n,y:i,leftedge:r,rightedge:s,context:a}){const o=ud(),l=`$${(Jt[e]??"").toLowerCase()} ${t.replaceAll(`
`,"").trim()} --=--`,u=tk(l,1e4,1),h=(u==null?void 0:u.measuredwidth)??1,[f,d]=Fe.useState(0);Fe.useEffect(()=>{d(p=>o?p:(p-1)%h)},[o,h]),a.disablewrap=!0,a.active.leftedge=n,a.active.rightedge=s-n;for(let p=r+n+f;p<=s;p+=h)a.x=p,a.y=i,ri(l,a,!1);return a.active.leftedge=0,a.active.rightedge=s,a.disablewrap=!1,null}function MSt({name:t,width:e,height:n,color:i,bg:r,text:s,shouldclose:a}){const{viewport:o}=oh(),c=e-3,l=n-3,u=nk(e,n,0,i,r),h=Fe.useContext(C0),f={...CE(e,n,i,r,0,0,e,n),...u.getState()},[d,p]=Fe.useState(()=>{const R=s.findIndex(I=>Li(I));return R>=0&&R<=8?R:0});let g=d-Math.floor(l*.5);g=Math.min(s.length-l,g),g=Math.max(0,g);const y=s.slice(g,g+l),v=d-g,b=Fe.useRef(null),T=Fe.useCallback(()=>{a&&h.didclose()},[a,h]),x=Fe.useCallback(R=>{const I=R.alt?10:1;p(k=>Math.max(0,k-I))},[p]),M=Fe.useCallback(R=>{const I=R.alt?10:1;p(k=>Math.min(s.length,k+I))},[p,s.length]);return Fe.useEffect(()=>{if(b.current&&!a){const R=o.height;b.current.position.y=R,b.current.userData.y=R,b.current.userData.vy=0}},[a]),gE(Fe.useCallback((R,I)=>{if(se(b.current)){const k=a?n*2*-kn.DRAW_CHAR_HEIGHT():0;xSt(b.current,"y",k,I)&&T()}},[a,T,n])),Me.jsx("group",{ref:b,"position-y":1e6,children:Me.jsxs(H1,{children:[Me.jsx(dc,{MOVE_UP:x,MOVE_DOWN:M,CANCEL_BUTTON:h.sendclose}),Me.jsxs(Lk,{store:u,children:[Me.jsx(wSt,{name:t,width:e,height:n,context:f}),Me.jsx(UK,{margin:3,color:Jt.BLUE,y:0,leftedge:0,rightedge:e-1,line:`
   up/down$white.SCROLL UP/DOWN   $blue
esc/cancel$white.CLOSE SCROLL   $blue
alt+up/down$white.JUMP 10 LINES   $blue
`,context:f}),Me.jsx(RSt,{row:v,width:e,height:n,panelwidth:c,panelheight:l,children:Me.jsx(LK,{name:t,width:c,height:l,xmargin:0,ymargin:0,color:i,bg:Jt.ONCLEAR,text:y,selected:v})})]})]})})}const Mae=new Rt,Oae=[153,5,42,94,24,25,26,27,16,17,30,31,234,227,227].map((t,e)=>[t,e%3===0?176:177,e%3===0?178:176]).flat();function OSt({context:t,width:e,height:n,drawstick:i}){const{islandscape:r,sidebaropen:s,showkeyboard:a}=Zh();if(dve(t,0,Jt.WHITE,Jt.ONCLEAR),!r){const o=e*n;for(let c=4*e;c<o;++c)t.char[c]=s?Oae[c%Oae.length]:0,t.color[c]=s?Jt.DKPURPLE:Jt.ONCLEAR}t.y=3;for(let o=0;o<3;++o)t.x=t.active.leftedge=1,ri("$YELLOW$176$176$176$176$176",t,!1),t.x=t.active.leftedge=e-7,ri(`$WHITE$176$176$176$176$176
`,t,!1);t.y=n-5;for(let o=0;o<3;++o)t.x=t.active.leftedge=1,ri("$GREEN$176$176$176$176$176",t,!1),t.x=t.active.leftedge=e-7,ri(`$RED$176$176$176$176$176
`,t,!1);if(t.y=n-5,t.active.leftedge=1,t.active.bg=Jt.ONCLEAR,a?(++t.y,t.x=Math.round((e-8)*.5),ri("$GREY$221",t,!1),t.x+=5,ri(`$GREY$222
`,t,!1),t.x=Math.round((e-6)*.5),ri("$GREY$221",t,!1),t.x+=3,ri(`$GREY$222
`,t,!1),t.x=Math.round((e-4)*.5),ri("$GREY$221",t,!1),++t.x,ri(`$GREY$222
`,t,!1)):(t.x=Math.round((e-4)*.5),ri("$GREY$221",t,!1),++t.x,ri(`$GREY$222
`,t,!1),t.x=Math.round((e-6)*.5),ri("$GREY$221",t,!1),t.x+=3,ri(`$GREY$222
`,t,!1),t.x=Math.round((e-8)*.5),ri("$GREY$221",t,!1),t.x+=5,ri(`$GREY$222
`,t,!1)),i.startx!==-1){t.active.leftedge=0,t.x=t.active.leftedge=i.startx-4,t.y=i.starty-3;for(let c=0;c<5;++c)ri(`$BLUE$176$176$176$176$176$176$176$176
`,t,!1);Mae.set(i.tipx-i.startx,i.tipy-i.starty);const o=pde(cF(mde(Mae.angle()),45));t.x=t.active.leftedge=Math.round(i.startx+Math.cos(o)*4)-2,t.y=Math.round(i.starty+Math.sin(o)*3)-2;for(let c=0;c<3;++c)ri(`$BLUE$177$177$177$177
`,t,!1)}return r||(t.active.leftedge=1,t.y=4,t.x=2,ri("$YELLOW?",t,!1),t.x=e-7,ri("$WHITEMENU",t,!1),t.y=n-4,t.x=2,ri("$GREENOKAY",t,!1),t.x=e-9,ri("$REDCANCEL",t,!1)),null}function NSt(t,e){switch(t){case 0:Hf.keyboard(e?"{Shift>}[ArrowLeft]{/Shift}":"[ArrowLeft]").catch(Zu);break;case 45:Hf.keyboard(e?"{Shift>}[ArrowLeft][ArrowUp]{/Shift}":"[ArrowLeft][ArrowUp]").catch(Zu);break;case 90:Hf.keyboard(e?"{Shift>}[ArrowUp]{/Shift}":"[ArrowUp]").catch(Zu);break;case 135:Hf.keyboard(e?"{Shift>}[ArrowRight][ArrowUp]{/Shift}":"[ArrowRight][ArrowUp]").catch(Zu);break;case 180:Hf.keyboard(e?"{Shift>}[ArrowRight]{/Shift}":"[ArrowRight]").catch(Zu);break;case 225:Hf.keyboard(e?"{Shift>}[ArrowRight][ArrowDown]{/Shift}":"[ArrowRight][ArrowDown]").catch(Zu);break;case 270:Hf.keyboard(e?"{Shift>}[ArrowDown]{/Shift}":"[ArrowDown]").catch(Zu);break;case 315:Hf.keyboard(e?"{Shift>}[ArrowLeft][ArrowDown]{/Shift}":"[ArrowLeft][ArrowDown]").catch(Zu);break;case 360:Hf.keyboard(e?"{Shift>}[ArrowLeft]{/Shift}":"[ArrowLeft]").catch(Zu);break}}const ISt=GN/1e3,XR=new Rt,Bw=new Ae;function KR(t,e){const n=kn.DRAW_CHAR_WIDTH(),i=kn.DRAW_CHAR_HEIGHT(),r=Bw.x+n*.5,s=Bw.y+i*.5;return{cx:Math.floor(t*.5)+Math.floor(r/n),cy:Math.floor(e*.5)+Math.floor(s/i)}}function kSt({width:t,height:e,player:n,onDrawStick:i}){const{islandscape:r}=Zh(),[s]=Fe.useState({startx:-1,starty:-1,tipx:-1,tipy:-1,pointerid:-1,presscount:0,inputacc:GN});function a(o,c){s.tipx===-1&&(nm(o,c,3,6,6,1)?oFe(je,n):nm(o,c,3,t-2,6,t-6)?Hf.keyboard("[Tab]").catch(Zu):nm(o,c,e-5,6,e-2,1)?Hf.keyboard("[Enter]").catch(Zu):nm(o,c,e-5,t-2,e-2,t-6)?Hf.keyboard("[Escape]").catch(Zu):r&&nm(o,c,6,t,e-6,t-5)||!r&&nm(o,c,0,t-12,3,12)?Zh.setState(l=>({...l,sidebaropen:!l.sidebaropen})):nm(o,c,e-4,t-12,e-2,12)&&Zh.setState({showkeyboard:!0})),s.startx=-1,s.starty=-1,s.tipx=-1,s.tipy=-1,s.pointerid=-1,i(s.startx,s.starty,s.tipx,s.tipy)}return gE((o,c)=>{if(s.inputacc+=c,s.inputacc>=ISt&&s.presscount>0){s.inputacc=0;const{cx:l,cy:u}=KR(t,e);if(XR.set(s.startx-l,s.starty-u),s.tipx!==-1||XR.length()>3){const h=cF(mde(XR.angle()),45);NSt(h,s.presscount>1)}}}),Me.jsx(Qf,{width:t,height:e,visible:!1,onPointerDown:o=>{if(NE(),++s.presscount,s.startx===-1){o.intersections[0].object.worldToLocal(Bw.copy(o.intersections[0].point));const{cx:c,cy:l}=KR(t,e);s.startx=c,s.starty=l,s.tipx=-1,s.tipy=-1,s.pointerid=o.pointerId,s.inputacc=GN}},onPointerMove:o=>{if(o.pointerId===s.pointerid){o.intersections[0].object.worldToLocal(Bw.copy(o.intersections[0].point));const{cx:c,cy:l}=KR(t,e);XR.set(s.startx-c,s.starty-l),(s.tipx!==-1||XR.length()>3)&&(s.tipx=c,s.tipy=l,i(s.startx,s.starty,s.tipx,s.tipy))}},onPointerCancel:o=>{if(--s.presscount,o.pointerId===s.pointerid){o.intersections[0].object.worldToLocal(Bw.copy(o.intersections[0].point));const{cx:c,cy:l}=KR(t,e);a(c,l)}},onPointerUp:o=>{if(--s.presscount,o.pointerId===s.pointerid){o.intersections[0].object.worldToLocal(Bw.copy(o.intersections[0].point));const{cx:c,cy:l}=KR(t,e);a(c,l)}}})}function DSt({width:t,height:e}){const n=nr(),[i,r]=Fe.useState({startx:-1,starty:-1,tipx:-1,tipy:-1}),s=nk(t,e,0,Jt.WHITE,Jt.ONCLEAR),a={...CE(t,e,Jt.WHITE,Jt.ONCLEAR),...s.getState()};return MXe(1,1,t-2,e-2,a),Me.jsxs(Lk,{store:s,children:[Me.jsx(OSt,{context:a,width:t,height:e,drawstick:i}),Me.jsx(kSt,{width:t,height:e,player:n,onDrawStick:(o,c,l,u)=>r({startx:o,starty:c,tipx:l,tipy:u})}),Me.jsx(VN,{width:t,height:e,top:5,left:0,right:5,bottom:e-6,alpha:.47135}),Me.jsx(VN,{width:t,height:e,top:5,left:t-6,right:t-1,bottom:e-6,alpha:.47135}),Me.jsx(Uk,{width:t,height:e})]})}const Nae=1.5,Iae=56,PSt=16,LSt=[[`
`],["[Escape]","$","1","2","3","4","5","6","7","8","9","0","&",`
`],[" ","Q","W","E","R","T","Y","U","I","O","P","-","+","*",`
`,`
`],["A","S","D","F","G","H","J","K","L","[Backspace]","_","=","%",`
`],[" ","Z","X","C","V","B","N","M","!","[Enter]","(",")","|",`
`],["                                          ","<",">","`",`
`],["[Space]","#","/","?",":","'",";",'"',"  ","[ArrowUp]",`
`],["         ","[Shift]","[Ctrl]","[Alt]","@","[ArrowLeft]","    ","[ArrowRight]",`
`],["                                      ","[ArrowDown]",`
`],["$greenz s s k e y s"]].flat();function USt(t){return t.replaceAll("{","").replaceAll("}","").replaceAll("[","").replaceAll("]","")}function BSt(t,e,n,i){let r=t,s=USt(t);switch(t){case"$":s=" $$ ";break;case";":s=" $59 ";break;case"[Escape]":s=" esc ";break;case"[ArrowUp]":s=" $30 ";break;case"[ArrowDown]":s=" $31 ";break;case"[ArrowRight]":s=" $16 ";break;case"[ArrowLeft]":s=" $17 ";break;case"[Backspace]":s=" del ";break;case"[Shift]":s=i?" SHIFT ":" shift ";break;case"[Ctrl]":s=n?" CTRL ":" ctrl ";break;case"[Alt]":s=e?" ALT ":" alt ";break;default:if(!i)r=r.toLowerCase(),s=s.toLowerCase();else switch(s){case"(":s="[";break;case")":s="]";break;case"<":s="{";break;case">":s="}";break;case"`":s="~";break}s=` ${s} `;break}return["touchkey","",r,"hk","",s]}function FSt({width:t,height:e}){const n=nr(),{showkeyboard:i,keyboardalt:r,keyboardctrl:s,keyboardshift:a}=Zh(),o=Fe.useRef(null),[c]=Fe.useState({}),l=16;return i&&Me.jsxs(Me.Fragment,{children:[Me.jsx(Qf,{blocking:!0,width:t,height:e,visible:!1,onPointerDown:u=>{NE(),c[u.pointerId]=u.point.x,se(o.current)&&(o.current.userData.x=o.current.position.x)},onPointerMove:u=>{const h=c[u.pointerId],f=u.point.x;if(se(h)&&o.current){const d=kn.DRAW_CHAR_WIDTH()*Nae,p=Math.round(cF(f-h,d)/d);o.current.position.x=lr(o.current.userData.x+p*d,Iae*-d+t*kn.DRAW_CHAR_WIDTH(),0)}},onPointerUp:u=>{delete c[u.pointerId]}}),Me.jsx(VN,{width:t,height:e,top:5,left:0,right:t-1,bottom:e-1,alpha:.753718}),Me.jsx("group",{position:[0,0,1],children:Me.jsx(Qf,{visible:!1,x:t*.5-l*.5,y:e-3.5,width:l,height:4,onClick:()=>{Zh.setState({showkeyboard:!1})}})}),Me.jsx("group",{ref:o,scale:Nae,children:Me.jsx(C0.Provider,{value:{sendmessage(u,h){je.emit(n,u,h)},sendclose(){},didclose(){}},children:Me.jsx(LK,{name:"keyboard",inline:!0,ymargin:1,color:Jt.WHITE,bg:Jt.ONCLEAR,width:Iae,height:PSt,text:LSt.map(u=>{switch(u){case`
`:return u;default:if(u.includes(" "))return u}return BSt(u,r,s,a)})})})})]})}function zSt({width:t,height:e}){const n=_8();return n.cols<10||n.rows<10?null:Me.jsxs(Me.Fragment,{children:[Me.jsx("group",{position:[0,0,800],children:Me.jsx(DSt,{width:t,height:e})}),Me.jsx("group",{position:[0,0,850],children:Me.jsx(FSt,{width:t,height:e})})]})}const MSe=Fe.createContext({cols:1,rows:1});function _8(){return Fe.useContext(MSe)}function HSt({children:t}){const{viewport:e}=oh(),{width:n,height:i}=e.getCurrentViewport(),{islandscape:r,showtouchcontrols:s}=Zh(),a=n/kn.DRAW_CHAR_WIDTH();let o=Math.floor(a);const c=i/kn.DRAW_CHAR_HEIGHT();let l=Math.floor(c);const u=(n-o*kn.DRAW_CHAR_WIDTH())*.5,h=(i-l*kn.DRAW_CHAR_HEIGHT())*.5;let f=0,d=0;const p=Math.round(a);let g=Math.round(c);if(s)if(r)f=5*kn.DRAW_CHAR_WIDTH(),o-=5*2;else{l=Math.round(l*.666);const y=l-4;g-=y,d=y*kn.DRAW_CHAR_HEIGHT()}return Fe.useEffect(()=>{Zh.setState(y=>({...y,insetcols:p,insetrows:g}))},[p,g]),Me.jsxs(MSe.Provider,{value:{cols:o,rows:l},children:[Me.jsx(eyt,{makeDefault:!0,near:1,far:2e3,position:[0,0,1e3]}),o>=10&&l>=10&&Me.jsx("group",{"scale-x":-1,"rotation-z":Math.PI,children:Me.jsxs("group",{position:[n*-.5+u,i*-.5+h,0],children:[Me.jsx("group",{position:[f,0,0],children:t}),s&&Me.jsx("group",{position:[0,d,0],children:Me.jsx(zSt,{width:p,height:g},p*g)})]})})]})}function kae({rect:t,islandscape:e=!0,sidebaropen:n=!0,shouldclose:i=!1}){switch(t.type){case 0:return Me.jsx("group",{"position-z":512,children:Me.jsx(LK,{name:t.name,width:t.width,height:t.height,color:14,bg:1,text:t.text,xmargin:e?1:n?3:10,ymargin:e&&!n?6:0})});case 1:return Me.jsx(MSt,{name:t.name,width:t.width,height:t.height,color:14,bg:1,text:t.text,shouldclose:i});case 2:return Me.jsx(sSt,{width:t.width,height:t.height})}return null}const Qx=20;function jSt(){const t=_8(),{islandscape:e,sidebaropen:n,insetrows:i,showtouchcontrols:r}=Zh(),s=xo(vte(p=>p.gadget.scroll??[])),a=s.length===0,[o,c]=Fe.useState(!1),l=xo(vte(p=>p.gadget.sidebar??[]));if(t.cols<10||t.rows<10)return null;const u={name:"main",type:2,x:0,y:0,text:[],width:t.cols,height:t.rows},h=[];if(l.length)if(r)if(e){const p=n?Qx+5:Qx,g=n?Qx:4,y={name:"sidebar",type:0,x:u.x+u.width-g,y:u.y,width:p,height:u.height,text:l};u.width-=g,h.push(y)}else{const p=n?i-7:i,g=n?p:4,y={name:"sidebar",type:0,x:0,y:u.y+u.height-g,width:u.width,height:p,text:l};u.height-=g,h.push(y)}else{const p={name:"sidebar",type:0,x:u.x+u.width-Qx,y:u.y,width:Qx,height:u.height,text:l};u.width-=Qx,h.push(p)}const f={name:"scroll",type:1,x:0,y:0,width:lr(50,24,u.width-2),height:lr(18,8,u.height-8),text:s};f.x=u.x+Math.floor((u.width-f.width)*.5),f.y=u.y+Math.floor((u.height-f.height)*.5),!a&&!o&&c(!0),h.unshift(u);const d=nr();return Me.jsxs(C0.Provider,{value:{sendmessage(p,g){je.emit(d,p,g)},sendclose(){WBe(je,d)},didclose(){c(!1)}},children:[Me.jsx("group",{position:[0,0,-512],children:h.map(p=>Me.jsx("group",{position:[p.x*kn.DRAW_CHAR_WIDTH(),p.y*kn.DRAW_CHAR_HEIGHT(),0],children:Me.jsx(kae,{islandscape:!r||e,sidebaropen:!r||n,rect:p})},p.name))}),o&&Me.jsxs(Ug.Fragment,{children:[Me.jsx("group",{position:[0,0,800],children:Me.jsx(REt,{width:t.cols,height:t.rows,alpha:.14})}),Me.jsx("group",{position:[f.x*kn.DRAW_CHAR_WIDTH(),f.y*kn.DRAW_CHAR_HEIGHT(),900],children:Me.jsx(kae,{rect:f,shouldclose:a})})]},"scroll")]})}const VSt=250,GSt=249,qN=Jt.BLUE,qSt=Jt.WHITE,$St=Jt.DKGRAY,BK=Jt.BLACK;function ZA(t){return t?Jt.ONCLEAR:Jt.DKBLUE}const OSe=Fe.createContext({sendmessage(){}});function MT(t,e,n,i,r){const s=wm(r);r.iseven=r.y%2===0,r.active.bg=e&&!t?BK:r.reset.bg,r.active.leftedge=s.left,r.active.rightedge=s.right,r.active.topedge=s.top,r.active.bottomedge=s.bottom,r.x=r.active.leftedge+n,r.y=r.active.topedge+i}function tT(t,e,n,i,r,s,a,o){const c=wm(r);r.iseven=r.y%2===0,r.active.color=Jt.WHITE,r.active.bg=r.reset.bg,r.active.leftedge=c.left+s,r.active.rightedge=c.right-s,r.active.topedge=c.top+a,r.active.bottomedge=c.bottom-o,r.x=r.active.leftedge+n,r.y=r.active.topedge+i}function WSt(t){let e=0;return t.split(/\r?\n/).map(i=>{const r=e,s=`${i}
`;return e+=s.length,{start:r,code:s,end:r+i.length}})}function YSt(t){return t.reduce((e,n)=>{const i=n.code.length;return i>e?i:e},0)}function XSt(t,e){for(let n=0;n<e.length;++n)if(t<=e[n].end)return n;return 0}function FK({bump:t,context:e}){const n=wm(e),{quickterminal:i}=Fs(),r=ZA(i);if(t&&n.top++,i){for(let s=n.top;s<=n.bottom;++s)for(let a=n.left;a<=n.right;++a)Uo(e,e.width,e.height,a,s,{char:0,color:qN,bg:r});return null}for(let s=n.top;s<=n.bottom;++s)for(let a=n.left;a<=n.right;++a){let o=0;(a+s)%2===0&&(o=Math.abs(Math.round(Math.cos(a*s*.01)))?VSt:GSt),Uo(e,e.width,e.height,a,s,{char:o,color:qN,bg:r})}return null}const Fj=Jt.WHITE,Fw=Jt.GREEN,Cc=Jt.YELLOW,KSt=Jt.CYAN,Gf=Jt.DKGREEN;Jt.DKGREEN;const Dae=Jt.DKCYAN,ZSt=Jt.GREEN,J2=Jt.BLUE,NSe=Jt.DKPURPLE,ISe=Jt.WHITE,JSt=Jt.DKRED,zj=Jt.DKYELLOW,QSt={[$C.tokenTypeIdx??0]:Fj,[pge.tokenTypeIdx??0]:Fj,[mge.tokenTypeIdx??0]:Fj,[GI.tokenTypeIdx??0]:J2,[eT.tokenTypeIdx??0]:Cc,[UF.tokenTypeIdx??0]:Fw,[$9.tokenTypeIdx??0]:KSt,[W9.tokenTypeIdx??0]:JSt,[Y9.tokenTypeIdx??0]:Cc,[X9.tokenTypeIdx??0]:Fw,[Sl.tokenTypeIdx??0]:Fw,[K9.tokenTypeIdx??0]:Fw,[Z9.tokenTypeIdx??0]:ISe,[J9.tokenTypeIdx??0]:Cc,[Q9.tokenTypeIdx??0]:Cc,[eY.tokenTypeIdx??0]:Cc,[tY.tokenTypeIdx??0]:Cc,[nY.tokenTypeIdx??0]:Cc,[iY.tokenTypeIdx??0]:Cc,[KU.tokenTypeIdx??0]:zj,[ZU.tokenTypeIdx??0]:zj,[JU.tokenTypeIdx??0]:zj,[QU.tokenTypeIdx??0]:Cc,[e3.tokenTypeIdx??0]:Cc,[rY.tokenTypeIdx??0]:Cc,[sY.tokenTypeIdx??0]:Cc,[t3.tokenTypeIdx??0]:Cc,[aY.tokenTypeIdx??0]:Cc,[oY.tokenTypeIdx??0]:Cc,[cY.tokenTypeIdx??0]:Cc,[lY.tokenTypeIdx??0]:Cc,[uY.tokenTypeIdx??0]:Cc,[hY.tokenTypeIdx??0]:ZSt,[n3.tokenTypeIdx??0]:Gf,[YM.tokenTypeIdx??0]:Dae,[i3.tokenTypeIdx??0]:Dae,[r3.tokenTypeIdx??0]:Gf,[fY.tokenTypeIdx??0]:Gf,[dY.tokenTypeIdx??0]:Gf,[pY.tokenTypeIdx??0]:Gf,[mY.tokenTypeIdx??0]:Gf,[gY.tokenTypeIdx??0]:Gf,[vY.tokenTypeIdx??0]:Gf};Jt.DKPURPLE;const eTt=Jt.DKYELLOW,tTt=NSe,nTt=Jt.CYAN,iTt=Jt.DKCYAN,rTt=Jt.RED,sTt=Jt.WHITE,aTt=Jt.LTGRAY,kSe=new Map;function pg(t,e){kSe.set(t,e)}function oTt(t){if(t.startsWith("play ")){const e=[];for(let n=0;n<t.length;++n)n<5?e.push(Gf):e.push(Bae(t[n]));return e.push(Jt.BLUE),e}else if(t.startsWith("bgplay ")){const e=[];for(let n=0;n<t.length;++n)n<7?e.push(Gf):e.push(Bae(t[n]));return e.push(Jt.BLUE),e}return kSe.get(t)??Jt.GREEN}const BS=Jt.GREEN,cTt=Jt.DKGREEN,mg=Jt.PURPLE,FS=Jt.DKCYAN,Pae=Jt.CYAN,Lae=Jt.YELLOW,Uae=Jt.DKYELLOW,DSe=new Map;function rs(t,e){DSe.set(t,e)}function Bae(t){return DSe.get(t)??Jt.GREEN}function lTt(){const t=Cm(),e=wm(t),[n,i,r]=Fs(Sp(v=>[v.quickterminal,v.editor.type,v.editor.title])),s=Jt.WHITE,a=ZA(n);for(let v=e.top;v<e.bottom;++v)Uo(t,t.width,t.height,e.left,v,{char:179,color:s,bg:a}),Uo(t,t.width,t.height,e.right,v,{char:179,color:s,bg:a});tT(!1,!1,0,0,t,0,0,0),ri("$213$205$187",t,!0),tT(!1,!1,t.width-3,0,t,0,0,0),ri("$196$196$191",t,!0);const o="$205".repeat(e.width-2);tT(!1,!1,0,e.height-1,t,0,0,0),ri(`$212${o}$190`,t,!0);const c=ud(),l="$205".repeat(e.width-4);tT(!1,!1,0,1,t,0,0,0),ri(`$179$${c?"7":"232"}$200${l}$181`,t,!0);const h=` ${`$blue[${i}] `}$green${r}$white `,f=tk(h,e.width,e.height),d=(f==null?void 0:f.measuredwidth)??1,p=e.width-2,g=2+Math.round(p*.5)-Math.round(d*.5);tT(!1,!1,g,1,t,0,0,0),ri(h,t,!0);const y=tE?`shift+${Uf}+z`:`${Uf}+y`;return Me.jsx(UK,{margin:3,color:Jt.BLUE,y:e.top,leftedge:0,rightedge:e.width-1,line:`
    esc/cancel$white.CLOSE   $blue
    tab$white.CHANGE LAYOUT   $blue
    hold shift$white.SELECT TEXT   $blue
    alt+up/down$white.JUMP 10 LINES   $blue
    alt+left/right$white.JUMP 10 COLS   $blue
    ${Uf}+up/down$white.JUMP TOP/BOTTOM   $blue
    ${Uf}+left/right$white.JUMP TO START/END OF LINE   $blue
    ${Uf}+a$white.SELECT ALL   $blue
    ${Uf}+c$white.COPY   $blue
    ${Uf}+x$white.CUT   $blue
    ${Uf}+v$white.PASTE   $blue
    ${Uf}+z$white.UNDO   $blue
    ${y}$white.REDO   $blue
    ${Uf}+p$white.TEST SELECTED CODE   $blue
    ${Uf}+k$white.PICK REFSHEET   $blue
    ${Uf}+e$white.COPY CODEPAGE TO CLIPBOARD AS JSON   $blue
    `,context:t})}const uTt=t=>{const e="nativeEvent"in t?t.nativeEvent:t;return{deltaX:e.deltaX||0,deltaY:e.deltaY||0,deltaZ:e.deltaZ||0,timeStamp:e.timeStamp}},hTt=t=>[t.deltaX,t.deltaY,t.deltaZ],GP=t=>{const e=hTt(t).map(Math.abs);return Math.max(...e)};var eb;(function(t){t.ALL_OTHER_CHECKS_FAILED="ALL_OTHER_CHECKS_FAILED",t.NO_PREVIOUS_EVENT_TO_COMPARE="NO_PREVIOUS_EVENT_TO_COMPARE",t.PAST_TIMESTAMP_EVENT="PAST_TIMESTAMP_EVENT",t.ENOUGH_TIME_PASSED="ENOUGH_TIME_PASSED",t.NON_DECREASING_DELTAS_OF_KNOWN_HUMAN="NON_DECREASING_DELTAS_OF_KNOWN_HUMAN",t.DELTA_MODULE_HAS_BEEN_INCREASING="DELTA_MODULE_HAS_BEEN_INCREASING"})(eb||(eb={}));class fTt{constructor({sensitivity:e=2,delay:n=100,increasingDeltasThreshold:i=3}={}){Qn(this,"sensitivity");Qn(this,"delay");Qn(this,"increasingDeltasThreshold");Qn(this,"previousEvents");this.sensitivity=Math.max(1,e),this.delay=Math.max(1,n),this.increasingDeltasThreshold=Math.max(2,i),this.previousEvents=[]}check(e){var s;if(!(("nativeEvent"in e?e.nativeEvent:e)instanceof Event))throw new Error(`"${e}" is not a valid event`);const i=uTt(e);if(GP(i)<this.sensitivity)return!1;const{isHuman:r}=this.isHuman(i);return r?this.previousEvents=[i]:i.timeStamp>(((s=this.previousEvents.at(-1))==null?void 0:s.timeStamp)||0)&&this.previousEvents.push(i),r}isHuman(e){const n=this.previousEvents.at(-1);if(!n)return{isHuman:!0,reason:eb.NO_PREVIOUS_EVENT_TO_COMPARE};if(e.timeStamp<n.timeStamp)return{isHuman:!1,reason:eb.PAST_TIMESTAMP_EVENT};if(e.timeStamp>n.timeStamp+this.delay)return{isHuman:!0,reason:eb.ENOUGH_TIME_PASSED};const s=GP(e),a=GP(n);if(s>=a){if(this.previousEvents.length===1)return{isHuman:!0,reason:eb.NON_DECREASING_DELTAS_OF_KNOWN_HUMAN};if(this.increasingDeltasThreshold<=2||this.previousEvents.length>=this.increasingDeltasThreshold&&this.previousEvents.slice(-this.increasingDeltasThreshold).map(GP).every((u,h,f)=>h===0||u>f[h-1]))return{isHuman:!0,reason:eb.DELTA_MODULE_HAS_BEEN_INCREASING}}return{isHuman:!1,reason:eb.ALL_OTHER_CHECKS_FAILED}}}const dTt=new fTt({sensitivity:tE?7:2}),Fae=4,pTt=.75;function mTt(t){const e=lr(t,-Fae,Fae);return Math.round(e*pTt)}function PSe({debug:t=!1,disabled:e=!1,blocking:n=!0,cursor:i="pointer",x:r=0,y:s=0,width:a=30,height:o=10,children:c,onScroll:l,...u}){return Me.jsxs("group",{...u,children:[Me.jsx(Qf,{blocking:n,cursor:i,visible:t,x:r,y:s,width:a,height:o,onWheel:h=>{e||!dTt.check(h)||l==null||l(mTt(h.deltaY))}}),c]})}function gTt({xcursor:t,ycursor:e,xoffset:n,yoffset:i,rows:r,codepage:s}){var Y,ie;const a=ud(),o=Cm(),c=Fe.useRef(),l=mo(),u=wm(o),h=Fs(V=>V.editor.path),f=nr(),d=se(s)?s.toJSON():"",p=r.length-1,g=t+1-n,y=e+2-i;if(se(s)){const V=((Y=c.current)==null?void 0:Y.x)!==g||((ie=c.current)==null?void 0:ie.y)!==y;if(a||V){const J=u.left+g,X=u.top+y;X>u.top+1&&X<u.bottom&&J>u.left&&J<u.right&&JF(J+X*o.width,"Ý",o)}}c.current={x:g,y};const v=r[p].end,b=r[e];let T=l.cursor,x=l.cursor,M=!1;se(l.select)&&(M=!0,T=Math.min(l.cursor,l.select),x=Math.max(l.cursor,l.select),l.cursor!==l.select&&--x);const R=x-T+1,I=M?d.substring(T,x+1):d;function k(V){V?se(l.select)||mo.setState({select:l.cursor}):mo.setState({select:void 0})}function P(V,J,X){J>0&&(s==null||s.delete(V,J)),se(X)&&(s==null||s.insert(V,X)),mo.setState({cursor:V+(X??"").length,select:void 0})}function U(){se(l.select)&&(mo.setState({cursor:T}),P(T,R))}function G(){mo.setState({cursor:v,select:void 0})}const $=Fe.useCallback(function(J){const X=Math.round(e+J);if(X<0)mo.setState({cursor:0});else if(X>p)mo.setState({cursor:v});else{const ee=r[X];mo.setState({cursor:ee.start+Math.min(t,ee.code.length-1)})}},[v,r,p,t,e]),q=Fe.useMemo(()=>s?new gWe(s):void 0,[s]);return Fe.useEffect(()=>{function V(X){X.stackItem.meta.set("cursor",l.cursor)}function J(X){if(X.stackItem.meta.has("cursor")){const ee=X.stackItem.meta.get("cursor");mo.setState({cursor:ee})}}return q==null||q.on("stack-item-added",V),q==null||q.on("stack-item-popped",J),()=>{q==null||q.off("stack-item-added",V),q==null||q.off("stack-item-popped",J)}},[q,l.cursor]),Me.jsxs(Me.Fragment,{children:[Me.jsx(PSe,{blocking:!0,x:u.left,y:u.top,width:u.width,height:u.height,onScroll:V=>$(V*.75)}),Me.jsx(dc,{keydown:V=>{if(!se(s))return;const{key:J}=V,X=si(J),ee=v8(V);switch(X){case"arrowleft":if(k(ee.shift),ee.ctrl)mo.setState({cursor:b.start});else{const oe=l.cursor-(ee.alt?10:1);mo.setState({cursor:lr(oe,0,v)})}break;case"arrowright":if(k(ee.shift),ee.ctrl)mo.setState({cursor:b.end});else{const oe=l.cursor+(ee.alt?10:1);mo.setState({cursor:lr(oe,0,v)})}break;case"arrowup":k(ee.shift),ee.ctrl?mo.setState({cursor:0}):$(ee.alt?-10:-1);break;case"arrowdown":k(ee.shift),ee.ctrl?mo.setState({cursor:v}):$(ee.alt?10:1);break;case"enter":se(s)&&(s.insert(l.cursor,`
`),mo.setState({cursor:l.cursor+1}));break;case"esc":case"escape":ee.shift||ee.alt||ee.ctrl?PU(je,f):lFe(je,f);break;case"tab":tpe(je,f,!ee.shift);break;case"delete":M?U():P(l.cursor,1);break;case"backspace":M?U():d.length>0&&P(Math.max(l.cursor-1,0),1);break;default:if(ee.ctrl)switch(X){case"e":yFe(je,f,h);break;case"k":bFe(je,f,h);break;case"z":tE&&ee.shift?q==null||q.redo():q==null||q.undo();break;case"y":tE||q==null||q.redo();break;case"a":mo.setState({cursor:v,select:0});break;case"c":se(Pa())?Pa().writeText(I).catch(oe=>Ui(je,f,"clipboard",oe)):G();break;case"v":se(Pa())?Pa().readText().then(oe=>{const fe=oe.replaceAll("\r","");M?P(T,R,fe):P(l.cursor,0,fe)}).catch(oe=>Ui(je,f,"clipboard",oe)):G();break;case"x":se(Pa())?Pa().writeText(I).then(()=>U()).catch(oe=>Ui(je,f,"clipboard",oe)):G();break;case"p":n_(je,f,I);break}else if(!ee.alt){if(J.length===1)if(M)P(T,R,J);else{const oe=l.cursor+J.length;s.insert(l.cursor,J),mo.setState({cursor:oe})}}break}}})]})}function vTt({ycursor:t,xoffset:e,yoffset:n,rows:i,codepage:r}){const s=ud(),a=Cm(),o=mo(),{editor:c,quickterminal:l}=Fs();if(!se(r)){const v=(s?"|":"-").repeat(3);return tT(!1,!1,0,0,a,1,2,1),ri(` ${v} LOADING ${v}`,a,!0),null}const u=c.refsheet.length>0,h=a.width-(u?28:3),f=wm(a);f.right=h;let d=o.cursor,p=o.cursor,g=!1;se(o.select)&&(g=!0,d=Math.min(o.cursor,o.select),p=Math.max(o.cursor,o.select),o.cursor!==o.select&&--p);const y=f.left+1;tT(!1,!1,-e,-n,a,1,2,1);for(let v=0;v<i.length;++v){if(a.y<=f.top+1){++a.y;continue}const b=i[v],T=v===t,x=b.code.replaceAll(`
`,"");a.x=y-e,a.iseven=a.y%2===0,a.active.bg=T?BK:ZA(l),a.disablewrap=!0,a.active.rightedge=h,cve(`${x} `,a,!1);const M=1+a.y*a.width;if(se(b.tokens))for(let R=0;R<b.tokens.length;++R){const I=b.tokens[R],k=(I.startColumn??1)-1-e,P=(I.endColumn??1)-1-e,U=QSt[I.tokenTypeIdx];if(se(U))switch(U){case J2:{const G=I.image.substring(1).split(" ");switch(bge("",G,!!I.payload).type){case cn.LOADER:case cn.BOARD:case cn.OBJECT:case cn.TERRAIN:case cn.CHARSET:case cn.PALETTE:{const[q]=G;fg(M,f.right,k,k+q.length,J2,a.active.bg,a),G.length>1&&fg(M,f.right,k+q.length+1,P,Fw,a.active.bg,a);break}case cn.CONST:{const[q]=G;fg(M,f.right,k,k+q.length,NSe,a.active.bg,a),G.length>1&&fg(M,f.right,k+q.length+1,P,ISe,a.active.bg,a);break}case cn.RANGE:case cn.SELECT:case cn.NUMBER:case cn.TEXT:case cn.LINK:case cn.HOTKEY:case cn.COPYIT:case cn.OPENIT:case cn.ZSSEDIT:case cn.CHAREDIT:case cn.COLOREDIT:{const[q]=G;fg(M,f.right,k,k+q.length,J2,a.active.bg,a);break}default:fg(M,f.right,k,P,Jt.DKRED,a.active.bg,a);break}break}case Fw:{const G=oTt(I.image);if(Li(G))for(let $=0;$<G.length;++$)fg(M,f.right,k+$,P+$,G[$],a.active.bg,a);else fg(M,f.right,k,P,G,a.active.bg,a);break}default:fg(M,f.right,k,P,U,a.active.bg,a);break}}if(g&&b.start<=p&&b.end>=d){const R=Math.max(b.start,d)-b.start-e,I=Math.min(b.end,p)-b.start-e,k=f.width-3,P=Math.max(0,R),U=Math.min(k,I);P<=k&&U>=y&&fg(M,f.right,P,U,qSt,$St,a)}if(++a.y,a.y>=f.bottom)break}if(u){let v=0;for(let b=f.top+2;b<f.bottom;++b){a.active.rightedge=a.width-2,a.active.leftedge=f.right+2,Uo(a,a.width,a.height,f.right+1,b,{char:179,color:qN,bg:Jt.DKBLUE});const T=c.refsheet[v++];se(T)&&(a.x=a.active.leftedge-1,a.y=b,ri(`$white$ondkblue ${T}`,a,!0))}}return a.disablewrap=!1,a.active.rightedge=a.width,null}function Hj(t){switch(t){case"stat":case"text":case"hyperlink":return!1;default:return!0}}function jj(){const t=nr(),[e]=Fs(Sp(U=>[U.editor])),[n,i,r,s,a,o,c,l,u,h]=xo(Sp(U=>[U.zsswords.cli,U.zsswords.loader,U.zsswords.runtime,U.zsswords.flags,U.zsswords.stats,U.zsswords.kinds,U.zsswords.altkinds,U.zsswords.colors,U.zsswords.dirs,U.zsswords.dirmods]));Fe.useEffect(()=>{n.filter(Hj).forEach(U=>pg(U,Gf)),i.filter(Hj).forEach(U=>pg(U,Gf)),r.filter(Hj).forEach(U=>pg(U,Gf)),s.forEach(U=>pg(U,eTt)),a.forEach(U=>pg(U,tTt)),o.forEach(U=>pg(U,nTt)),c.forEach(U=>pg(U,iTt)),l.forEach(U=>pg(U,rTt)),u.forEach(U=>pg(U,sTt)),h.forEach(U=>pg(U,aTt)),rs("a",BS),rs("b",BS),rs("c",BS),rs("d",BS),rs("e",BS),rs("f",BS),rs("g",BS),rs("x",cTt),rs("#",Uae),rs("!",Uae),rs("y",FS),rs("t",FS),rs("s",FS),rs("i",FS),rs("q",FS),rs("h",FS),rs("w",FS),rs("3",Pae),rs(".",Pae),rs("+",Lae),rs("-",Lae),rs("0",mg),rs("1",mg),rs("2",mg),rs("p",mg),rs("4",mg),rs("5",mg),rs("6",mg),rs("7",mg),rs("8",mg),rs("9",mg),rs(";",Cc)},[n,i,r,s,a,o,c,l,u,h]);const f=Cm(),d=mo(),p=C0e(npe(e.book,e.path)),g=wm(f);Fe.useEffect(()=>(SFe(je,t,e.book,e.path),()=>{TFe(je,t,e.book,e.path)}),[e.book,e.path,t]);const y=se(p)?p.toJSON():"",v=WSt(y),b=XSt(d.cursor,v),T=d.cursor-v[b].start,x=YSt(v),M=eve(y);if(se(M.tokens)){let U=!0;for(let G=0;G<M.tokens.length;++G){const $=M.tokens[G];$.tokenTypeIdx===GI.tokenTypeIdx&&($.payload=U,U=!1);const q=v[($.startLine??1)-1];se(q)&&(q.tokens=q.tokens??[],q.tokens.push($))}}if(se(M.errors))for(let U=0;U<M.errors.length;++U){const G=M.errors[U],$=v[(G.line??1)-1];se($)&&($.errors=$.errors??[],$.errors.push(G))}const R={rows:v,xcursor:T,ycursor:b,codepage:p,xoffset:d.xscroll,yoffset:d.yscroll},I=32,k=(Math.round(x/I)+1)*I,P=v.length;return Fe.useEffect(()=>{let U=d.xscroll;const G=T-U,$=g.width-3;let q=Math.round(lr(Math.abs(G)*.5,1,I));q<8&&(q=1),G>$-8&&(U+=q),G<8&&(U-=q);let Y=d.yscroll;const ie=b-Y,V=g.height-4,J=Math.round(V*.5);let X=Math.round(lr(Math.abs(ie)*.25,1,J));X<8&&(X=1),ie>V-4&&(Y+=X),ie<4&&(Y-=X),setTimeout(()=>mo.setState({xscroll:Math.round(lr(U,0,k)),yscroll:Math.round(lr(Y,0,P))}),16)},[T,k,d.xscroll,b,P,d.yscroll,g.width,g.height]),Me.jsxs(Me.Fragment,{children:[Me.jsx(FK,{bump:!0,context:f}),Me.jsx(lTt,{}),Me.jsx(vTt,{...R}),Me.jsx(gTt,{...R})]})}function _Tt({tapeycursor:t,logrowtotalheight:e}){const n=ud(),i=Cm(),{quickterminal:r}=Fs(),s=Lo(),a=nr(),o=wm(i),c=s.buffer[s.bufferindex];let l=s.xcursor,u=s.xcursor,h=!1;se(s.xselect)&&se(s.yselect)&&(h=!0,l=Math.min(s.xcursor,s.xselect),u=Math.max(s.xcursor,s.xselect),s.xcursor!==s.xselect&&--u);const f=u-l+1,d=s.ycursor===0,p=h?c.substring(l,u+1):c;function g(k,P,U){s.bufferindex>0&&Lo.setState({bufferindex:0}),s.buffer[0]=g9e(c,k,P,U),Lo.setState({buffer:s.buffer,xselect:void 0,xcursor:k+(U??"").length})}function y(k){const P=s.buffer.length-1,U=lr(k,0,P);Lo.setState({bufferindex:U,xcursor:s.buffer[U].length,ycursor:0,xselect:void 0,yselect:void 0})}function v(k){k?se(s.xselect)||Lo.setState({xselect:s.xcursor,yselect:s.ycursor}):Lo.setState({xselect:void 0,yselect:void 0})}function b(){se(s.xselect)&&(Lo.setState({xcursor:l,xselect:void 0,yselect:void 0}),g(l,f))}function T(){Lo.setState({xcursor:c.length,ycursor:0,xselect:void 0,yselect:void 0})}if(i.reset.bg=ZA(r),!r){MT(!1,!1,0,0,i);const k="main:0.48.11 - if lost try #help";i.x=o.right-k.length,ri(`$dkcyan${k}`,i,!0)}const x="$196",R="$205".repeat(o.width-6);MT(!1,!1,0,o.height-2,i),i.active.color=Jt.WHITE,ri(`  ${x}${R}${x}  `,i,!0);const I=c.padEnd(o.width," ");if(MT(!1,!1,0,o.height-1,i),i.active.color=Jt.WHITE,cve(I,i,!0),se(s.xselect)&&se(s.yselect)&&s.xcursor!==s.xselect){const k=Math.min(s.xcursor,s.xselect),P=Math.min(s.ycursor,s.yselect),U=Math.max(s.xcursor,s.xselect)-1,G=Math.max(s.ycursor,s.yselect);for(let $=P;$<=G;++$){const q=k+(o.bottom-$)*o.width,Y=U+(o.bottom-$)*o.width;_N(q,Y,15,8,i)}}if(n){const k=o.left+s.xcursor,P=o.top+t,U=k+P*i.width;JF(U,"Ý",i),_N(U,U,15,i.reset.bg,i)}return Fe.useEffect(()=>{let k=s.scroll;t<4&&k++,t>o.bottom-4&&k--,Lo.setState({scroll:Math.round(lr(k,0,e))})},[s.scroll,t,e,o.bottom]),Me.jsxs(Me.Fragment,{children:[Me.jsx(PSe,{blocking:!0,x:o.left,y:o.top,width:o.width,height:o.height,onScroll:k=>{v(!1),Lo.setState({ycursor:lr(Math.round(s.ycursor-k),0,e)})}}),Me.jsx(dc,{keydown:k=>{const{key:P}=k,U=si(P),G=v8(k);switch(U){case"arrowleft":v(G.shift),G.ctrl?Lo.setState({xcursor:0}):Lo.setState({xcursor:lr(s.xcursor-(G.alt?10:1),0,o.right)});break;case"arrowright":v(G.shift),G.ctrl?Lo.setState({xcursor:d?c.length:o.right}):Lo.setState({xcursor:lr(s.xcursor+(G.alt?10:1),0,o.right)});break;case"arrowup":G.ctrl?y(s.bufferindex+1):(v(G.shift),Lo.setState({ycursor:lr(Math.round(s.ycursor+(G.alt?10:1)),0,e)}));break;case"arrowdown":G.ctrl?y(s.bufferindex-1):(v(G.shift),Lo.setState({ycursor:lr(Math.round(s.ycursor-(G.alt?10:1)),0,e)}));break;case"enter":{const $=h?p:c;if($.length)if(d){const q=["",$,...s.buffer.slice(1).filter(Y=>Y!==$)];zht(q).catch(Y=>Ui(je,a,"input?",Y.message)),Lo.setState({xcursor:0,bufferindex:0,xselect:void 0,yselect:void 0,buffer:q}),n_(je,a,$),r&&PU(je,a)}else T();break}case"esc":case"escape":PU(je,a);break;case"tab":tpe(je,a,!G.shift);break;case"delete":d?h?b():c.length>0&&g(s.xcursor,1):T();break;case"backspace":d?h?b():s.xcursor>0&&g(s.xcursor-1,1):T();break;default:if(G.ctrl)switch(U){case"e":n_(je,a,"#export");break;case"a":Lo.setState({xselect:0,yselect:0,xcursor:c.length,ycursor:0});break;case"c":d&&se(Pa())?Pa().writeText(p).catch($=>console.error($)):T();break;case"v":d&&se(Pa())?Pa().readText().then($=>{try{const Y=JSON.parse($);if(On(Y.exported)&&se(Y.data)){Vg(je,a,void 0,"json",`file:${Y.exported}`,JSON.stringify(Y));return}}catch(Y){console.error(Y)}const q=$.replaceAll("\r","");h?g(l,f,q):g(s.xcursor,0,q)}).catch($=>console.error($)):T();break;case"x":d&&se(Pa())?Pa().writeText(p).then(()=>b()).catch($=>console.error($)):T();break}else G.alt||P.length===1&&(d&&s.xcursor<=c.length?h?(g(l,f,P),Lo.setState({xselect:void 0})):g(s.xcursor,0,P):T());break}}})]})}function yTt({blink:t,active:e,prefix:n,label:i,words:r,y:s}){const a=Cm(),o=Fe.useCallback(()=>{setTimeout(()=>{if(se(Pa())){const[,...l]=r,u=l.join(" ");Pa().writeText(u).then(()=>po(je,nr(),"copied!")).catch(h=>console.error(h))}},100)},[r]),c=Mp(!!e);return MT(!!t,!!e,0,s,a),ri(`${n} $purple$16 $yellowCOPYIT ${c}${i}`,a,!0),e&&Me.jsx(dc,{OK_BUTTON:o})}function bTt({blink:t,active:e,prefix:n,label:i,words:r,y:s}){const a=Cm(),o=Fe.useContext(OSe),c=Fe.useCallback(()=>{const[u,...h]=r;setTimeout(()=>{o.sendmessage(u,h)},100)},[r,o]),l=Mp(!!e);return MT(!!t,!!e,0,s,a),ri(`${n} $purple$16 ${l}${i}`,a,!0),e&&Me.jsx(dc,{OK_BUTTON:c})}function ETt({blink:t,active:e,prefix:n,label:i,words:r,y:s}){const a=Cm(),o=Fe.useCallback(()=>{const[,...l]=r,u=l.join(" ");setTimeout(()=>{window.open(u,"_blank")},100)},[r]),c=Mp(!!e);return MT(!!t,!!e,0,s,a),ri(`${n} $purple$16 $yellowOPENIT ${c}${i}`,a,!0),e&&Me.jsx(dc,{OK_BUTTON:o})}function LSe({blink:t,active:e,text:n,y:i}){const r=Cm(),{quickterminal:s}=Fs(),a=wm(r),o=n.startsWith("!");if(MT(!!t,!!e,0,i,r),r.reset.bg=e?BK:ZA(s),r.active.bottomedge=a.bottom,ri(o?"":n,r,!0),o){const[c,...l]=n.slice(1).split("!"),u=`${l.join("!")}`;let h="PRESS ME";const f=[],d=KF(u,!0);for(let v=0;v<d.tokens.length;v++){const b=d.tokens[v];switch(b.tokenType){case tX:h=b.image.slice(1);break;default:f.push(b.image);break}}const[p,...g]=f,y={blink:t,active:e,prefix:c,label:h,words:g,y:i};switch(si(p)){case"copyit":return Me.jsx(yTt,{...y,words:f});case"openit":return Me.jsx(ETt,{...y,words:f});default:case"hyperlink":return Me.jsx(bTt,{...y,words:f});case"hk":case"hotkey":return null;case"rn":case"range":return null;case"sl":case"select":return null;case"nm":case"number":return null;case"tx":case"text":return null;case"zssedit":return null;case"charedit":return null;case"coloredit":return null}}return null}function STt(t){const e=ud();return Me.jsx(LSe,{active:!0,blink:e,...t})}function Vj(){const t=nr(),[e]=Fs(Sp(d=>[d.editor.open])),n=Fs(Sp(d=>d.terminal.logs)),i=Cm(),r=Lo(),s=wm(i),a=n.map(d=>{const[,p,g,...y]=d;let v="$white";switch(p){case"debug":v="$yellow";break;case"error":v="$red";break}const b=y.map(M=>`${M}`).join(" "),T=b.startsWith("!"),x=`$onclear${v}${g}$white$180$blue`;return`${T?"!":""}${x}${b}`}),o=a.map(d=>{if(d.startsWith("!"))return 1;const p=tk(d,s.width,s.height);return(p==null?void 0:p.y)??1}),c=s.bottom-s.top-(e?0:2);let l=0,u=c+1;const h=o.map(d=>(u-=d,l+=d,u));++l;const f=s.bottom-r.ycursor+r.scroll;return Me.jsxs(Me.Fragment,{children:[Me.jsx(FK,{context:i}),Me.jsxs(OSe.Provider,{value:{sendmessage(d,p){const[g,y]=HY(d);if(g==="self"){const v=`#${y} ${p.join(" ")}`;n_(je,t,v)}else je.emit(t,`${g}:${y}`,p)}},children:[a.map((d,p)=>{const g=h[p]+r.scroll,y=o[p],v=g+y;return v<0||g>c?null:!e&&f>=g&&f<v?Me.jsx(STt,{text:d,y:g},p):Me.jsx(LSe,{text:d,y:g},p)}),!e&&Me.jsx(_Tt,{tapeycursor:f,logrowtotalheight:l})]})]})}function zae(t,e,n,i,r){return{...r,x:t,y:e,reset:{...fl(r.reset),topedge:e,leftedge:t,rightedge:n,bottomedge:i},active:{...fl(r.active),topedge:e,leftedge:t,rightedge:n,bottomedge:i}}}function TTt({context:t}){const[e,n]=Fs(Sp(h=>[h.layout,h.editor.open])),i=0,r=0,s=t.width-1,a=t.height-1,o=wm(t),c=Math.floor(o.height*.5),l=Fe.useMemo(()=>zae(r,i,s,c-1,t),[c,s,t]),u=Fe.useMemo(()=>zae(r,c,s,a,t),[c,s,a,t]);if(n)switch(e){case qf.SPLIT_Y:return Me.jsxs(Me.Fragment,{children:[Me.jsx(Yy.Provider,{value:l,children:Me.jsx(Vj,{})}),Me.jsx(Yy.Provider,{value:u,children:Me.jsx(jj,{})})]});case qf.SPLIT_Y_ALT:return Me.jsxs(Me.Fragment,{children:[Me.jsx(Yy.Provider,{value:l,children:Me.jsx(jj,{})}),Me.jsx(Yy.Provider,{value:u,children:Me.jsx(Vj,{})})]});default:return Me.jsx(Yy.Provider,{value:t,children:Me.jsx(jj,{})})}return Me.jsx(Yy.Provider,{value:t,children:Me.jsx(Vj,{})},"single")}function xTt(){const t=_8();let e=0,n=t.rows-2;const[i,r,s,a]=Fs(Sp(f=>[f.layout,f.quickterminal,f.terminal.open,f.editor.open]));switch(i){case qf.TOP:n=Math.floor(t.rows*.5);break;case qf.BOTTOM:n=Math.ceil(t.rows*.5),e=t.rows-n;break;default:case qf.FULL:break}const o=ZA(r),c=nk(t.cols,n,0,qN,o),l={...CE(t.cols,n,qN,o),...c.getState()};if(t.cols<10||t.rows<10)return null;const u=nr(),h=r||s||a;return Me.jsxs(Lk,{store:c,children:[h&&Me.jsx(VN,{width:t.cols,height:t.rows,top:e,left:0,right:t.cols-1,bottom:e+n-1}),h?Me.jsxs(H1,{blockhotkeys:!0,children:[Me.jsx(FK,{context:l}),Me.jsx(TTt,{context:l}),Me.jsx("group",{position:[0,e*kn.DRAW_CHAR_HEIGHT(),0],children:Me.jsx(Uk,{width:t.cols,height:n})})]}):Me.jsx(fC,{hotkey:"Shift+?",althotkey:"/",children:()=>sFe(je,u)})]})}function wTt({context:t}){return Me.jsx("group",{position:[0,0,999],children:Me.jsx(Uk,{width:t.width,height:t.height})})}function CTt(){const{toast:t}=Fs(),e=_8(),n=nk(e.cols,1,0,Jt.GREEN,Jt.ONCLEAR),i={...CE(e.cols,1,Jt.GREEN,Jt.ONCLEAR,0,0,e.cols-1,1),...n.getState()};if(e.cols<10||e.rows<10)return null;const r=e.cols-1;return Me.jsx(Lk,{store:n,children:t&&Me.jsxs(Me.Fragment,{children:[Me.jsx(UK,{margin:1,color:Jt.YELLOW,y:0,leftedge:0,rightedge:r,line:t,context:i}),Me.jsx("group",{position:[0,0,998],children:Me.jsx(VN,{alpha:.4,width:e.cols,height:10,top:0,left:0,right:r,bottom:0})}),Me.jsx(wTt,{context:i})]})})}const Hae=yE("gadgetclient",[],t=>{if(!Hae.session(t)||t.player!==nr())return;const{desync:e}=xo.getState();switch(t.target){case"paint":xo.setState({desync:!1,gadget:t.data});break;case"patch":e||xo.setState(n=>{let i;try{i=qW(t.data,n.gadget)}catch(s){i=s}if(se(i))return Hae.replynext(t,"desync"),{...n,desync:!0};const r=lF(n.gadget,t.data,!0,!1);return{...n,gadget:r.newDocument}});break}}),zK=Object.prototype.toString.call(typeof zn<"u"?zn:0)==="[object process]";var Dy,pi;(function(t){t[t.CRITICAL=0]="CRITICAL",t[t.ERROR=1]="ERROR",t[t.WARNING=2]="WARNING",t[t.INFO=3]="INFO",t[t.DEBUG=4]="DEBUG",t[t.TRACE=7]="TRACE"})(pi||(pi={}));function HK(t){if(typeof t=="number"){if(Object.prototype.hasOwnProperty.call(pi,t))return t;var e=Object.keys(pi).map(function(i){return parseInt(i,10)}).filter(function(i){return!isNaN(i)&&i<t});return e.length?Math.max.apply(Math,e):pi.WARNING}var n=t.replace(/\d+$/,"").toUpperCase();if(!Object.prototype.hasOwnProperty.call(pi,n))throw new Error("Unknown log level string: ".concat(t));return pi[n]}var ATt=zK?console.log.bind(console):console.debug.bind(console),USe=(Dy={},Dy[pi.CRITICAL]=console.error.bind(console),Dy[pi.ERROR]=console.error.bind(console),Dy[pi.WARNING]=console.warn.bind(console),Dy[pi.INFO]=console.info.bind(console),Dy[pi.DEBUG]=ATt.bind(console),Dy[pi.TRACE]=console.trace.bind(console),Dy);function IE(t){return function(e,n){Object.defineProperty(e,n,{get:function(){},set:function(i){Object.defineProperty(this,n,{value:i,writable:!0,enumerable:t})},enumerable:t})}}function k$(t){return Qa(this,void 0,Promise,function(){return qX(this,function(e){switch(e.label){case 0:return typeof t!="function"?[3,2]:[4,t()];case 1:return[2,e.sent()];case 2:return[2,t]}})})}function RTt(t){return typeof t=="function"?t():t}function BSe(t){var e,n,i;return qX(this,function(r){switch(r.label){case 0:e=0,n=1,r.label=1;case 1:return e<t?[4,e]:[3,3];case 2:return r.sent(),i=Xz([n,e+n],2),e=i[0],n=i[1],[3,1];case 3:return[4,t];case 4:return r.sent(),[3,3];case 5:return[2]}})}function qP(t,e){return Object.assign.apply(Object,l$([{}],Xz(t.map(e)),!1))}function D$(t,e){Object.entries(t).forEach(function(n){var i=Xz(n,2),r=i[0],s=i[1];return e(s,r)})}function FSe(t){return t==null}function $N(t,e){return FSe(t)?null:e(t)}function zSe(t,e){return FSe(t)?void 0:e(t)}function MTt(t){return Qa(this,void 0,Promise,function(){return qX(this,function(e){switch(e.label){case 0:return[4,new Promise(function(n){return setTimeout(n,t)})];case 1:return e.sent(),[2]}})})}function P$(){var t,e,n=new Promise(function(i,r){t=i,e=r});return{promise:n,resolve:t,reject:e}}function OTt(t,e,n){if(typeof t=="number"&&(t=t.toString()),e=e-t.length,e<=0)return t;n===void 0&&(n=" ");var i="";do(e&1)===1&&(i+=n),e>>=1,e&&(n+=n);while(e);return i+t}function OT(t,e,n){var i=t.split(e);return i.length<=n?i:l$(l$([],Xz(i.slice(0,n-1)),!1),[i.slice(n-1).join(e)],!1)}var NTt={},Gj,qj,tB=typeof zn>"u"?[]:(qj=(Gj=NTt.LOGGING)===null||Gj===void 0?void 0:Gj.split(";").map(function(t){var e=t.split("=",2),n=e[0],i=e[1];return i?[n==="default"?void 0:n.split(":"),HK(i)]:null}).filter(function(t){return!!t}).sort(function(t,e){var n,i,r=t[0],s=e[0];return((n=s==null?void 0:s.length)!==null&&n!==void 0?n:0)-((i=r==null?void 0:r.length)!==null&&i!==void 0?i:0)}))!==null&&qj!==void 0?qj:[],$j=tB.findIndex(function(t){var e=t[0];return!e}),HSe=void 0;$j!==-1&&(HSe=tB[$j][1],tB.splice($j));function ITt(t,e){return e.length<=t.length&&e.every(function(n,i){return n===t[i]})}function jSe(t){for(var e=t.split(":"),n=0,i=tB;n<i.length;n++){var r=i[n],s=r[0],a=r[1];if(ITt(e,s))return a}return HSe}var VSe=function(){function t(e){var n=e.name,i=e.minLevel,r=e.emoji,s=r===void 0?!1:r,a=e.colors,o=e.timestamps,c=o===void 0?zK:o,l,u;this._name=n,this._minLevel=(u=(l=zSe(i,function(h){return HK(h)}))!==null&&l!==void 0?l:jSe(n))!==null&&u!==void 0?u:pi.WARNING,this._emoji=s,this._colors=a,this._timestamps=c}return t.prototype.crit=function(e){this.log(pi.CRITICAL,e)},t.prototype.error=function(e){this.log(pi.ERROR,e)},t.prototype.warn=function(e){this.log(pi.WARNING,e)},t.prototype.info=function(e){this.log(pi.INFO,e)},t.prototype.debug=function(e){this.log(pi.DEBUG,e)},t.prototype.trace=function(e){this.log(pi.TRACE,e)},t}(),kTt=function(t){Abe(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.prototype.log=function(n,i){if(!(n>this._minLevel)){var r=USe[n],s="[".concat(this._name,"] ").concat(i);this._timestamps&&(s="[".concat(new Date().toISOString(),"] ").concat(i)),r(s)}},e}(VSe),DTt=function(){function t(e){var n=e.name,i=e.minLevel,r=e.custom,s;this._minLevel=(s=zSe(i,function(a){return HK(a)}))!==null&&s!==void 0?s:jSe(n),this._override=typeof r=="function"?{log:r}:r}return t.prototype.log=function(e,n){this._shouldLog(e)&&this._override.log(e,n)},t.prototype.crit=function(e){this._override.crit?this._shouldLog(pi.CRITICAL)&&this._override.crit(e):this.log(pi.CRITICAL,e)},t.prototype.error=function(e){this._override.error?this._shouldLog(pi.ERROR)&&this._override.error(e):this.log(pi.ERROR,e)},t.prototype.warn=function(e){this._override.warn?this._shouldLog(pi.WARNING)&&this._override.warn(e):this.log(pi.WARNING,e)},t.prototype.info=function(e){this._override.info?this._shouldLog(pi.INFO)&&this._override.info(e):this.log(pi.INFO,e)},t.prototype.debug=function(e){this._override.debug?this._shouldLog(pi.DEBUG)&&this._override.debug(e):this.log(pi.DEBUG,e)},t.prototype.trace=function(e){this._override.trace?this._shouldLog(pi.TRACE)&&this._override.trace(e):this.log(pi.TRACE,e)},t.prototype._shouldLog=function(e){return this._minLevel===void 0||this._minLevel>=e},t}(),Py,Ly,Uy,PTt=(Py={},Py[pi.CRITICAL]="🛑",Py[pi.ERROR]="❌",Py[pi.WARNING]="⚠️ ",Py[pi.INFO]="ℹ️ ",Py[pi.DEBUG]="🐞",Py[pi.TRACE]="🐾",Py),LTt={black:30,red:31,green:32,yellow:33,blue:34,magenta:35,cyan:36,white:37,blackBright:90,redBright:91,greenBright:92,yellowBright:93,blueBright:94,magentaBright:95,cyanBright:96,whiteBright:97},UTt={bgBlack:40,bgRed:41,bgGreen:42,bgYellow:43,bgBlue:44,bgMagenta:45,bgCyan:46,bgWhite:47,bgBlackBright:100,bgRedBright:101,bgGreenBright:102,bgYellowBright:103,bgBlueBright:104,bgMagentaBright:105,bgCyanBright:106,bgWhiteBright:107};function y8(t,e,n){return function(i){return"\x1B[".concat(t,"m").concat(n?n(i):i,"\x1B[").concat(e,"m")}}function Ng(t){return y8(LTt[t],39)}function ZR(t,e){return y8(UTt[t],49,e)}var BTt=(Ly={},Ly[pi.CRITICAL]=Ng("red"),Ly[pi.ERROR]=Ng("redBright"),Ly[pi.WARNING]=Ng("yellow"),Ly[pi.INFO]=Ng("blue"),Ly[pi.DEBUG]=Ng("magenta"),Ly[pi.TRACE]=y8(0,0),Ly),jae=(Uy={},Uy[pi.CRITICAL]=ZR("bgRed",Ng("white")),Uy[pi.ERROR]=ZR("bgRedBright",Ng("white")),Uy[pi.WARNING]=ZR("bgYellow",Ng("black")),Uy[pi.INFO]=ZR("bgBlue",Ng("white")),Uy[pi.DEBUG]=ZR("bgMagenta",Ng("black")),Uy[pi.TRACE]=y8(7,27),Uy),FTt=function(t){Abe(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.prototype.log=function(n,i){var r,s,a;if(!(n>this._minLevel)){var o=USe[n],c="";if(this._timestamps&&(c+="[".concat(new Date().toISOString(),"] ")),this._emoji){var l=PTt[n];c+="".concat(l," ")}var u=(a=(r=this._colors)!==null&&r!==void 0?r:(s=zn.stdout)===null||s===void 0?void 0:s.isTTY)!==null&&a!==void 0?a:!0;u?c+="".concat(jae[n](this._name)," ").concat(jae[n](pi[n])," ").concat(BTt[n](i)):c+="[".concat(this._name,":").concat(pi[n].toLowerCase(),"] ").concat(i),o(c)}},e}(VSe);function b8(t){return t.custom?new DTt(t):zK?new FTt(t):new kTt(t)}let zTt=class extends Error{constructor(...e){var n;super(...e),Object.setPrototypeOf(this,new.target.prototype),(n=Error.captureStackTrace)===null||n===void 0||n.call(Error,this,new.target.constructor)}get name(){return this.constructor.name}};class GSe extends zTt{}class HTt{constructor({logger:e,bucketSize:n,timeFrame:i,doRequest:r,getPartitionKey:s}){this._partitionedQueue=new Map,this._usedFromBucket=new Map,this._paused=!1,this._logger=b8({name:"rate-limiter",emoji:!0,...e}),this._bucketSize=n,this._timeFrame=i,this._callback=r,this._partitionKeyCallback=s}async request(e,n){return await new Promise((i,r)=>{var s,a;const o={req:e,resolve:i,reject:r,limitReachedBehavior:(s=n==null?void 0:n.limitReachedBehavior)!==null&&s!==void 0?s:"enqueue"},c=this._partitionKeyCallback(e),l=(a=this._usedFromBucket.get(c))!==null&&a!==void 0?a:0;if(l>=this._bucketSize||this._paused)switch(o.limitReachedBehavior){case"enqueue":{const u=this._getPartitionedQueue(c);u.push(o),l+u.length>=this._bucketSize?this._logger.warn(`Rate limit of ${this._bucketSize} for ${c?`partition ${c}`:"default partition"} was reached, waiting for ${this._paused?"the limiter to be unpaused":"a free bucket entry"}; queue size is ${u.length}`):this._logger.info(`Enqueueing request for ${c?`partition ${c}`:"default partition"} because the rate limiter is paused; queue size is ${u.length}`);break}case"null":{o.resolve(null),this._paused?this._logger.info(`Returning null for request for ${c?`partition ${c}`:"default partition"} because the rate limiter is paused`):this._logger.warn(`Rate limit of ${this._bucketSize} for ${c?`partition ${c}`:"default partition"} was reached, dropping request and returning null`);break}case"throw":{o.reject(new GSe(`Request dropped because ${this._paused?"the rate limiter is paused":`the rate limit for ${c?`partition ${c}`:"default partition"} was reached`}`));break}default:throw new Error("this should never happen")}else this._runRequest(o,c)})}clear(){this._partitionedQueue.clear()}pause(){this._paused=!0}resume(){this._paused=!1;for(const e of this._partitionedQueue.keys())this._runNextRequest(e)}_getPartitionedQueue(e){if(this._partitionedQueue.has(e))return this._partitionedQueue.get(e);const n=[];return this._partitionedQueue.set(e,n),n}async _runRequest(e,n){var i;const r=this._getPartitionedQueue(n);this._logger.debug(`doing a request for ${n?`partition ${n}`:"default partition"}, new queue length is ${r.length}`),this._usedFromBucket.set(n,((i=this._usedFromBucket.get(n))!==null&&i!==void 0?i:0)+1);const{req:s,resolve:a,reject:o}=e;try{a(await this._callback(s))}catch(c){o(c)}finally{setTimeout(()=>{const c=this._usedFromBucket.get(n)-1;this._usedFromBucket.set(n,c),r.length&&c<this._bucketSize&&this._runNextRequest(n)},this._timeFrame)}}_runNextRequest(e){if(this._paused)return;const i=this._getPartitionedQueue(e).shift();i&&this._runRequest(i,e)}}class L${constructor({logger:e,bucketSize:n,timeFrame:i,doRequest:r}){this._queue=[],this._usedFromBucket=0,this._paused=!1,this._logger=b8({name:"rate-limiter",emoji:!0,...e}),this._bucketSize=n,this._timeFrame=i,this._callback=r}async request(e,n){return await new Promise((i,r)=>{var s;const a={req:e,resolve:i,reject:r,limitReachedBehavior:(s=n==null?void 0:n.limitReachedBehavior)!==null&&s!==void 0?s:"enqueue"};if(this._usedFromBucket>=this._bucketSize||this._paused)switch(a.limitReachedBehavior){case"enqueue":{this._queue.push(a),this._usedFromBucket+this._queue.length>=this._bucketSize?this._logger.warn(`Rate limit of ${this._bucketSize} was reached, waiting for ${this._paused?"the limiter to be unpaused":"a free bucket entry"}; queue size is ${this._queue.length}`):this._logger.info(`Enqueueing request because the rate limiter is paused; queue size is ${this._queue.length}`);break}case"null":{a.resolve(null),this._logger.warn(`Rate limit of ${this._bucketSize} was reached, dropping request and returning null`),this._paused?this._logger.info("Returning null for request because the rate limiter is paused"):this._logger.warn(`Rate limit of ${this._bucketSize} was reached, dropping request and returning null`);break}case"throw":{a.reject(new GSe(`Request dropped because ${this._paused?"the rate limiter is paused":"the rate limit was reached"}`));break}default:throw new Error("this should never happen")}else this._runRequest(a)})}clear(){this._queue=[]}pause(){this._paused=!0}resume(){this._paused=!1,this._runNextRequest()}async _runRequest(e){this._logger.debug(`doing a request, new queue length is ${this._queue.length}`),this._usedFromBucket+=1;const{req:n,resolve:i,reject:r}=e;try{i(await this._callback(n))}catch(s){r(s)}finally{setTimeout(()=>{this._usedFromBucket-=1,this._queue.length&&this._usedFromBucket<this._bucketSize&&this._runNextRequest()},this._timeFrame)}}_runNextRequest(){if(this._paused)return;const e=this._queue.shift();e&&this._runRequest(e)}}class jTt extends L${constructor(e,n){super({...n,async doRequest(i,r){return await e.request(i,r)}})}}class VTt{constructor(e,n,i,r=!1){this.owner=e,this.event=n,this.listener=i,this._internal=r}unbind(){this.owner.removeListener(this)}}let Bk=class{constructor(){this._eventListeners=new Map,this._internalEventListeners=new Map}on(e,n){return this._addListener(!1,e,n)}addListener(e,n){return this._addListener(!1,e,n)}removeListener(e,n){this._removeListener(!1,e,n)}registerEvent(){const e=n=>this.addListener(e,n);return e}emit(e,...n){if(this._eventListeners.has(e))for(const i of this._eventListeners.get(e))i(...n);if(this._internalEventListeners.has(e))for(const i of this._internalEventListeners.get(e))i(...n)}registerInternalEvent(){const e=n=>this.addInternalListener(e,n);return e}addInternalListener(e,n){return this._addListener(!0,e,n)}removeInternalListener(e,n){this._removeListener(!0,e,n)}_addListener(e,n,i){const r=e?this._eventListeners:this._internalEventListeners;return r.has(n)?r.get(n).push(i):r.set(n,[i]),new VTt(this,n,i,e)}_removeListener(e,n,i){const r=e?this._eventListeners:this._internalEventListeners;if(!n)r.clear();else if(typeof n=="object"){const s=n;this._removeListener(s._internal,s.event,s.listener)}else{const s=n;if(r.has(s))if(i){const a=r.get(s);let o=0;for(;(o=a.indexOf(i))!==-1;)a.splice(o,1)}else r.delete(s)}}};const GTt=6e4;function qTt(t){return $N(t.expiresIn,e=>t.obtainmentTimestamp+e*1e3-GTt)}function Q2(t){var e;return(e=$N(qTt(t),n=>Date.now()>n))!==null&&e!==void 0?e:!1}var U$={exports:{}};(function(t,e){var n=typeof self<"u"?self:jl,i=function(){function s(){this.fetch=!1,this.DOMException=n.DOMException}return s.prototype=n,new s}();(function(s){(function(a){var o={searchParams:"URLSearchParams"in s,iterable:"Symbol"in s&&"iterator"in Symbol,blob:"FileReader"in s&&"Blob"in s&&function(){try{return new Blob,!0}catch{return!1}}(),formData:"FormData"in s,arrayBuffer:"ArrayBuffer"in s};function c(Y){return Y&&DataView.prototype.isPrototypeOf(Y)}if(o.arrayBuffer)var l=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],u=ArrayBuffer.isView||function(Y){return Y&&l.indexOf(Object.prototype.toString.call(Y))>-1};function h(Y){if(typeof Y!="string"&&(Y=String(Y)),/[^a-z0-9\-#$%&'*+.^_`|~]/i.test(Y))throw new TypeError("Invalid character in header field name");return Y.toLowerCase()}function f(Y){return typeof Y!="string"&&(Y=String(Y)),Y}function d(Y){var ie={next:function(){var V=Y.shift();return{done:V===void 0,value:V}}};return o.iterable&&(ie[Symbol.iterator]=function(){return ie}),ie}function p(Y){this.map={},Y instanceof p?Y.forEach(function(ie,V){this.append(V,ie)},this):Array.isArray(Y)?Y.forEach(function(ie){this.append(ie[0],ie[1])},this):Y&&Object.getOwnPropertyNames(Y).forEach(function(ie){this.append(ie,Y[ie])},this)}p.prototype.append=function(Y,ie){Y=h(Y),ie=f(ie);var V=this.map[Y];this.map[Y]=V?V+", "+ie:ie},p.prototype.delete=function(Y){delete this.map[h(Y)]},p.prototype.get=function(Y){return Y=h(Y),this.has(Y)?this.map[Y]:null},p.prototype.has=function(Y){return this.map.hasOwnProperty(h(Y))},p.prototype.set=function(Y,ie){this.map[h(Y)]=f(ie)},p.prototype.forEach=function(Y,ie){for(var V in this.map)this.map.hasOwnProperty(V)&&Y.call(ie,this.map[V],V,this)},p.prototype.keys=function(){var Y=[];return this.forEach(function(ie,V){Y.push(V)}),d(Y)},p.prototype.values=function(){var Y=[];return this.forEach(function(ie){Y.push(ie)}),d(Y)},p.prototype.entries=function(){var Y=[];return this.forEach(function(ie,V){Y.push([V,ie])}),d(Y)},o.iterable&&(p.prototype[Symbol.iterator]=p.prototype.entries);function g(Y){if(Y.bodyUsed)return Promise.reject(new TypeError("Already read"));Y.bodyUsed=!0}function y(Y){return new Promise(function(ie,V){Y.onload=function(){ie(Y.result)},Y.onerror=function(){V(Y.error)}})}function v(Y){var ie=new FileReader,V=y(ie);return ie.readAsArrayBuffer(Y),V}function b(Y){var ie=new FileReader,V=y(ie);return ie.readAsText(Y),V}function T(Y){for(var ie=new Uint8Array(Y),V=new Array(ie.length),J=0;J<ie.length;J++)V[J]=String.fromCharCode(ie[J]);return V.join("")}function x(Y){if(Y.slice)return Y.slice(0);var ie=new Uint8Array(Y.byteLength);return ie.set(new Uint8Array(Y)),ie.buffer}function M(){return this.bodyUsed=!1,this._initBody=function(Y){this._bodyInit=Y,Y?typeof Y=="string"?this._bodyText=Y:o.blob&&Blob.prototype.isPrototypeOf(Y)?this._bodyBlob=Y:o.formData&&FormData.prototype.isPrototypeOf(Y)?this._bodyFormData=Y:o.searchParams&&URLSearchParams.prototype.isPrototypeOf(Y)?this._bodyText=Y.toString():o.arrayBuffer&&o.blob&&c(Y)?(this._bodyArrayBuffer=x(Y.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):o.arrayBuffer&&(ArrayBuffer.prototype.isPrototypeOf(Y)||u(Y))?this._bodyArrayBuffer=x(Y):this._bodyText=Y=Object.prototype.toString.call(Y):this._bodyText="",this.headers.get("content-type")||(typeof Y=="string"?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):o.searchParams&&URLSearchParams.prototype.isPrototypeOf(Y)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},o.blob&&(this.blob=function(){var Y=g(this);if(Y)return Y;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?g(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(v)}),this.text=function(){var Y=g(this);if(Y)return Y;if(this._bodyBlob)return b(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(T(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},o.formData&&(this.formData=function(){return this.text().then(P)}),this.json=function(){return this.text().then(JSON.parse)},this}var R=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];function I(Y){var ie=Y.toUpperCase();return R.indexOf(ie)>-1?ie:Y}function k(Y,ie){ie=ie||{};var V=ie.body;if(Y instanceof k){if(Y.bodyUsed)throw new TypeError("Already read");this.url=Y.url,this.credentials=Y.credentials,ie.headers||(this.headers=new p(Y.headers)),this.method=Y.method,this.mode=Y.mode,this.signal=Y.signal,!V&&Y._bodyInit!=null&&(V=Y._bodyInit,Y.bodyUsed=!0)}else this.url=String(Y);if(this.credentials=ie.credentials||this.credentials||"same-origin",(ie.headers||!this.headers)&&(this.headers=new p(ie.headers)),this.method=I(ie.method||this.method||"GET"),this.mode=ie.mode||this.mode||null,this.signal=ie.signal||this.signal,this.referrer=null,(this.method==="GET"||this.method==="HEAD")&&V)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(V)}k.prototype.clone=function(){return new k(this,{body:this._bodyInit})};function P(Y){var ie=new FormData;return Y.trim().split("&").forEach(function(V){if(V){var J=V.split("="),X=J.shift().replace(/\+/g," "),ee=J.join("=").replace(/\+/g," ");ie.append(decodeURIComponent(X),decodeURIComponent(ee))}}),ie}function U(Y){var ie=new p,V=Y.replace(/\r?\n[\t ]+/g," ");return V.split(/\r?\n/).forEach(function(J){var X=J.split(":"),ee=X.shift().trim();if(ee){var oe=X.join(":").trim();ie.append(ee,oe)}}),ie}M.call(k.prototype);function G(Y,ie){ie||(ie={}),this.type="default",this.status=ie.status===void 0?200:ie.status,this.ok=this.status>=200&&this.status<300,this.statusText="statusText"in ie?ie.statusText:"OK",this.headers=new p(ie.headers),this.url=ie.url||"",this._initBody(Y)}M.call(G.prototype),G.prototype.clone=function(){return new G(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new p(this.headers),url:this.url})},G.error=function(){var Y=new G(null,{status:0,statusText:""});return Y.type="error",Y};var $=[301,302,303,307,308];G.redirect=function(Y,ie){if($.indexOf(ie)===-1)throw new RangeError("Invalid status code");return new G(null,{status:ie,headers:{location:Y}})},a.DOMException=s.DOMException;try{new a.DOMException}catch{a.DOMException=function(ie,V){this.message=ie,this.name=V;var J=Error(ie);this.stack=J.stack},a.DOMException.prototype=Object.create(Error.prototype),a.DOMException.prototype.constructor=a.DOMException}function q(Y,ie){return new Promise(function(V,J){var X=new k(Y,ie);if(X.signal&&X.signal.aborted)return J(new a.DOMException("Aborted","AbortError"));var ee=new XMLHttpRequest;function oe(){ee.abort()}ee.onload=function(){var fe={status:ee.status,statusText:ee.statusText,headers:U(ee.getAllResponseHeaders()||"")};fe.url="responseURL"in ee?ee.responseURL:fe.headers.get("X-Request-URL");var Re="response"in ee?ee.response:ee.responseText;V(new G(Re,fe))},ee.onerror=function(){J(new TypeError("Network request failed"))},ee.ontimeout=function(){J(new TypeError("Network request failed"))},ee.onabort=function(){J(new a.DOMException("Aborted","AbortError"))},ee.open(X.method,X.url,!0),X.credentials==="include"?ee.withCredentials=!0:X.credentials==="omit"&&(ee.withCredentials=!1),"responseType"in ee&&o.blob&&(ee.responseType="blob"),X.headers.forEach(function(fe,Re){ee.setRequestHeader(Re,fe)}),X.signal&&(X.signal.addEventListener("abort",oe),ee.onreadystatechange=function(){ee.readyState===4&&X.signal.removeEventListener("abort",oe)}),ee.send(typeof X._bodyInit>"u"?null:X._bodyInit)})}return q.polyfill=!0,s.fetch||(s.fetch=q,s.Headers=p,s.Request=k,s.Response=G),a.Headers=p,a.Request=k,a.Response=G,a.fetch=q,Object.defineProperty(a,"__esModule",{value:!0}),a})({})})(i),i.fetch.ponyfill=!0,delete i.fetch.polyfill;var r=i;e=r.fetch,e.default=r.fetch,e.fetch=r.fetch,e.Headers=r.Headers,e.Request=r.Request,e.Response=r.Response,t.exports=e})(U$,U$.exports);var qSe=U$.exports;const $Tt=Yc(qSe);var Wj=Object.prototype.hasOwnProperty,lw=Array.isArray,gg=function(){for(var t=[],e=0;e<256;++e)t.push("%"+((e<16?"0":"")+e.toString(16)).toUpperCase());return t}(),WTt=function(e){for(;e.length>1;){var n=e.pop(),i=n.obj[n.prop];if(lw(i)){for(var r=[],s=0;s<i.length;++s)typeof i[s]<"u"&&r.push(i[s]);n.obj[n.prop]=r}}},$Se=function(e,n){for(var i=n&&n.plainObjects?Object.create(null):{},r=0;r<e.length;++r)typeof e[r]<"u"&&(i[r]=e[r]);return i},YTt=function t(e,n,i){if(!n)return e;if(typeof n!="object"){if(lw(e))e.push(n);else if(e&&typeof e=="object")(i&&(i.plainObjects||i.allowPrototypes)||!Wj.call(Object.prototype,n))&&(e[n]=!0);else return[e,n];return e}if(!e||typeof e!="object")return[e].concat(n);var r=e;return lw(e)&&!lw(n)&&(r=$Se(e,i)),lw(e)&&lw(n)?(n.forEach(function(s,a){if(Wj.call(e,a)){var o=e[a];o&&typeof o=="object"&&s&&typeof s=="object"?e[a]=t(o,s,i):e.push(s)}else e[a]=s}),e):Object.keys(n).reduce(function(s,a){var o=n[a];return Wj.call(s,a)?s[a]=t(s[a],o,i):s[a]=o,s},r)},XTt=function(e,n){return Object.keys(n).reduce(function(i,r){return i[r]=n[r],i},e)},KTt=function(t,e,n){var i=t.replace(/\+/g," ");if(n==="iso-8859-1")return i.replace(/%[0-9a-f]{2}/gi,unescape);try{return decodeURIComponent(i)}catch{return i}},ZTt=function(e,n,i){if(e.length===0)return e;var r=e;if(typeof e=="symbol"?r=Symbol.prototype.toString.call(e):typeof e!="string"&&(r=String(e)),i==="iso-8859-1")return escape(r).replace(/%u[0-9a-f]{4}/gi,function(c){return"%26%23"+parseInt(c.slice(2),16)+"%3B"});for(var s="",a=0;a<r.length;++a){var o=r.charCodeAt(a);if(o===45||o===46||o===95||o===126||o>=48&&o<=57||o>=65&&o<=90||o>=97&&o<=122){s+=r.charAt(a);continue}if(o<128){s=s+gg[o];continue}if(o<2048){s=s+(gg[192|o>>6]+gg[128|o&63]);continue}if(o<55296||o>=57344){s=s+(gg[224|o>>12]+gg[128|o>>6&63]+gg[128|o&63]);continue}a+=1,o=65536+((o&1023)<<10|r.charCodeAt(a)&1023),s+=gg[240|o>>18]+gg[128|o>>12&63]+gg[128|o>>6&63]+gg[128|o&63]}return s},JTt=function(e){for(var n=[{obj:{o:e},prop:"o"}],i=[],r=0;r<n.length;++r)for(var s=n[r],a=s.obj[s.prop],o=Object.keys(a),c=0;c<o.length;++c){var l=o[c],u=a[l];typeof u=="object"&&u!==null&&i.indexOf(u)===-1&&(n.push({obj:a,prop:l}),i.push(u))}return WTt(n),e},QTt=function(e){return Object.prototype.toString.call(e)==="[object RegExp]"},e1t=function(e){return!e||typeof e!="object"?!1:!!(e.constructor&&e.constructor.isBuffer&&e.constructor.isBuffer(e))},t1t=function(e,n){return[].concat(e,n)},jK={arrayToObject:$Se,assign:XTt,combine:t1t,compact:JTt,decode:KTt,encode:ZTt,isBuffer:e1t,isRegExp:QTt,merge:YTt},n1t=String.prototype.replace,i1t=/%20/g,r1t=jK,Vae={RFC1738:"RFC1738",RFC3986:"RFC3986"},s1t=r1t.assign({default:Vae.RFC3986,formatters:{RFC1738:function(t){return n1t.call(t,i1t,"+")},RFC3986:function(t){return String(t)}}},Vae),WSe=jK,nO=s1t,a1t=Object.prototype.hasOwnProperty,Gae={brackets:function(e){return e+"[]"},comma:"comma",indices:function(e,n){return e+"["+n+"]"},repeat:function(e){return e}},dC=Array.isArray,o1t=Array.prototype.push,B$=function(t,e){o1t.apply(t,dC(e)?e:[e])},c1t=Date.prototype.toISOString,qae=nO.default,ou={addQueryPrefix:!1,allowDots:!1,charset:"utf-8",charsetSentinel:!1,delimiter:"&",encode:!0,encoder:WSe.encode,encodeValuesOnly:!1,format:qae,formatter:nO.formatters[qae],indices:!1,serializeDate:function(e){return c1t.call(e)},skipNulls:!1,strictNullHandling:!1},l1t=function(e){return typeof e=="string"||typeof e=="number"||typeof e=="boolean"||typeof e=="symbol"||typeof e=="bigint"},u1t=function t(e,n,i,r,s,a,o,c,l,u,h,f,d){var p=e;if(typeof o=="function"?p=o(n,p):p instanceof Date?p=u(p):i==="comma"&&dC(p)&&(p=p.join(",")),p===null){if(r)return a&&!f?a(n,ou.encoder,d,"key"):n;p=""}if(l1t(p)||WSe.isBuffer(p)){if(a){var g=f?n:a(n,ou.encoder,d,"key");return[h(g)+"="+h(a(p,ou.encoder,d,"value"))]}return[h(n)+"="+h(String(p))]}var y=[];if(typeof p>"u")return y;var v;if(dC(o))v=o;else{var b=Object.keys(p);v=c?b.sort(c):b}for(var T=0;T<v.length;++T){var x=v[T];s&&p[x]===null||(dC(p)?B$(y,t(p[x],typeof i=="function"?i(n,x):n,i,r,s,a,o,c,l,u,h,f,d)):B$(y,t(p[x],n+(l?"."+x:"["+x+"]"),i,r,s,a,o,c,l,u,h,f,d)))}return y},h1t=function(e){if(!e)return ou;if(e.encoder!==null&&e.encoder!==void 0&&typeof e.encoder!="function")throw new TypeError("Encoder has to be a function.");var n=e.charset||ou.charset;if(typeof e.charset<"u"&&e.charset!=="utf-8"&&e.charset!=="iso-8859-1")throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");var i=nO.default;if(typeof e.format<"u"){if(!a1t.call(nO.formatters,e.format))throw new TypeError("Unknown format option provided.");i=e.format}var r=nO.formatters[i],s=ou.filter;return(typeof e.filter=="function"||dC(e.filter))&&(s=e.filter),{addQueryPrefix:typeof e.addQueryPrefix=="boolean"?e.addQueryPrefix:ou.addQueryPrefix,allowDots:typeof e.allowDots>"u"?ou.allowDots:!!e.allowDots,charset:n,charsetSentinel:typeof e.charsetSentinel=="boolean"?e.charsetSentinel:ou.charsetSentinel,delimiter:typeof e.delimiter>"u"?ou.delimiter:e.delimiter,encode:typeof e.encode=="boolean"?e.encode:ou.encode,encoder:typeof e.encoder=="function"?e.encoder:ou.encoder,encodeValuesOnly:typeof e.encodeValuesOnly=="boolean"?e.encodeValuesOnly:ou.encodeValuesOnly,filter:s,formatter:r,serializeDate:typeof e.serializeDate=="function"?e.serializeDate:ou.serializeDate,skipNulls:typeof e.skipNulls=="boolean"?e.skipNulls:ou.skipNulls,sort:typeof e.sort=="function"?e.sort:null,strictNullHandling:typeof e.strictNullHandling=="boolean"?e.strictNullHandling:ou.strictNullHandling}},f1t=function(t,e){var n=t,i=h1t(e),r,s;typeof i.filter=="function"?(s=i.filter,n=s("",n)):dC(i.filter)&&(s=i.filter,r=s);var a=[];if(typeof n!="object"||n===null)return"";var o;e&&e.arrayFormat in Gae?o=e.arrayFormat:e&&"indices"in e?o=e.indices?"indices":"repeat":o="indices";var c=Gae[o];r||(r=Object.keys(n)),i.sort&&r.sort(i.sort);for(var l=0;l<r.length;++l){var u=r[l];i.skipNulls&&n[u]===null||B$(a,u1t(n[u],u,c,i.strictNullHandling,i.skipNulls,i.encode?i.encoder:null,i.filter,i.sort,i.allowDots,i.serializeDate,i.formatter,i.encodeValuesOnly,i.charset))}var h=a.join(i.delimiter),f=i.addQueryPrefix===!0?"?":"";return i.charsetSentinel&&(i.charset==="iso-8859-1"?f+="utf8=%26%2310003%3B&":f+="utf8=%E2%9C%93&"),h.length>0?f+h:""};const YSe=Yc(f1t);var d1t=jK;d1t.decode;const uw=Symbol("twurpleRawData");class p1t{constructor(e){this[uw]=e}}class j1 extends Error{constructor(e,n){var i;super(e,n),Object.setPrototypeOf(this,new.target.prototype),(i=Error.captureStackTrace)===null||i===void 0||i.call(Error,this,new.target.constructor)}get name(){return this.constructor.name}}function Fk(t,e,n){return i=>{const r=n?function(){return`[${e}#${this[n]} - please check https://twurple.js.org/reference/${t}/classes/${e}.html for available properties]`}:function(){return`[${e} - please check https://twurple.js.org/reference/${t}/classes/${e}.html for available properties]`};Object.defineProperty(i.prototype,Symbol.for("nodejs.util.inspect.custom"),{value:r,enumerable:!1})}}class $ae extends j1{constructor(e){super(`${e} - this should never happen, please file a bug in the GitHub issue tracker`)}}function Lv(t){return typeof t=="string"?t:typeof t=="number"?t.toString(10):t.id}class XSe extends j1{constructor(e,n,i,r,s,a){super(`Encountered HTTP status code ${e}: ${n}

URL: ${i}
Method: ${r}
Body:
${!a&&s.length>150?`${s.slice(0,147)}...`:s}`),this._statusCode=e,this._url=i,this._method=r,this._body=s}get statusCode(){return this._statusCode}get url(){return this._url}get method(){return this._method}get body(){return this._body}}async function m1t(t,e){var n;if(!t.ok){const i=t.headers.get("Content-Type")==="application/json",r=i?JSON.stringify(await t.json(),null,2):await t.text(),s=YSe(e.query,{arrayFormat:"repeat",addQueryPrefix:!0}),a=`${e.url}${s}`;throw new XSe(t.status,t.statusText,a,(n=e.method)!==null&&n!==void 0?n:"GET",r,i)}}async function g1t(t){if(t.status===204)return;const e=await t.text();if(e)return JSON.parse(e)}function v1t(t,e,n){switch(e){case"helix":return`https://api.twitch.tv/helix/${t.replace(/^\//,"")}`;case"auth":return`https://id.twitch.tv/oauth2/${t.replace(/^\//,"")}`;case"custom":return t;default:return t}}async function _1t(t,e,n,i,r={},s){var a,o;const c=(a=t.type)!==null&&a!==void 0?a:"helix",l=v1t(t.url,c),u=YSe(t.query,{arrayFormat:"repeat",addQueryPrefix:!0}),h=new qSe.Headers({Accept:"application/json"});let f;t.jsonBody&&(f=JSON.stringify(t.jsonBody),h.append("Content-Type","application/json")),e&&c!=="auth"&&h.append("Client-ID",e),n&&h.append("Authorization",`${c==="helix"?"Bearer":"OAuth"} ${n}`);const d={...r,method:(o=t.method)!==null&&o!==void 0?o:"GET",headers:h,body:f};return await $Tt(`${l}${u}`,d)}async function E8(t,e,n,i,r={}){const s=await _1t(t,e,n,i,r);return await m1t(s,t),await g1t(s)}class pC extends j1{constructor(e){super("Invalid token supplied",e)}}class eL extends j1{}function y1t(t,e,n,i){return{grant_type:"authorization_code",client_id:t,client_secret:e,code:n,redirect_uri:i}}function b1t(t,e){return{grant_type:"client_credentials",client_id:t,client_secret:e}}function E1t(t,e,n){return{grant_type:"refresh_token",client_id:t,client_secret:e,refresh_token:n}}let F$=class extends p1t{constructor(e){super(e),this._obtainmentDate=new Date}get clientId(){return this[uw].client_id}get userId(){var e;return(e=this[uw].user_id)!==null&&e!==void 0?e:null}get userName(){var e;return(e=this[uw].login)!==null&&e!==void 0?e:null}get scopes(){return this[uw].scopes}get expiryDate(){return $N(this[uw].expires_in,e=>new Date(this._obtainmentDate.getTime()+e*1e3))}};F$=ca([Fk("auth","TokenInfo","clientId")],F$);function VK(t){var e,n;return{accessToken:t.access_token,refreshToken:t.refresh_token||null,scope:(e=t.scope)!==null&&e!==void 0?e:[],expiresIn:(n=t.expires_in)!==null&&n!==void 0?n:null,obtainmentTimestamp:Date.now()}}async function S1t(t,e,n,i){return VK(await E8({type:"auth",url:"token",method:"POST",query:y1t(t,e,n,i)}))}async function T1t(t,e){return VK(await E8({type:"auth",url:"token",method:"POST",query:b1t(t,e)}))}async function Wae(t,e,n){return VK(await E8({type:"auth",url:"token",method:"POST",query:E1t(t,e,n)}))}async function WN(t,e){try{const n=await E8({type:"auth",url:"validate"},e,t);return new F$(n)}catch(n){throw n instanceof XSe&&n.statusCode===401?new pC({cause:n}):n}}const x1t=new Map([["channel_commercial",["channel:edit:commercial"]],["channel_editor",["channel:manage:broadcast"]],["channel_read",["channel:read:stream_key"]],["channel_subscriptions",["channel:read:subscriptions"]],["user_blocks_read",["user:read:blocked_users"]],["user_blocks_edit",["user:manage:blocked_users"]],["user_follows_edit",["user:edit:follows"]],["user_read",["user:read:email"]],["user_subscriptions",["user:read:subscriptions"]],["user:edit:broadcast",["channel:manage:broadcast","channel:manage:extensions"]]]);function w1t(t,e){if(e!=null&&e.length){const n=new Set(t.flatMap(i=>{var r;return[i,...(r=x1t.get(i))!==null&&r!==void 0?r:[]]}));if(e.every(i=>!n.has(i))){const i=e.join(", ");throw new Error(`This token does not have any of the requested scopes (${i}) and can not be upgraded.
If you need dynamically upgrading scopes, please implement the AuthProvider interface accordingly:

	https://twurple.js.org/reference/auth/interfaces/AuthProvider.html`)}}}function tL(t,e){for(const n of e)w1t(t,n)}async function C1t(t,e,n,i,r){if(r!=null&&r.length||!n){const s=await WN(e,t);if(!s.userId)throw new Error("Trying to use an app access token as a user access token");const a=i??s.scopes;return r&&tL(a,r.filter(o=>!!o)),[a,s.userId]}return[i,n]}class Yae{constructor(e){this._newTokenScopeSets=[],this._newTokenPromise=null,this._queuedScopeSets=[],this._queueExecutor=null,this._queuePromise=null,this._executor=e}async fetch(...e){var n;const i=e.filter(o=>!!o);if(this._newTokenPromise){if(!i.length)return await this._newTokenPromise;if(this._queueExecutor?this._queuedScopeSets.push(...i):this._queuedScopeSets=[...i],!this._queuePromise){const{promise:o,resolve:c,reject:l}=P$();this._queuePromise=o,this._queueExecutor=async()=>{var u;if(this._queuePromise){this._newTokenScopeSets=this._queuedScopeSets,this._queuedScopeSets=[],this._newTokenPromise=this._queuePromise,this._queuePromise=null,this._queueExecutor=null;try{c(await this._executor(this._newTokenScopeSets))}catch(h){l(h)}finally{this._newTokenPromise=null,this._newTokenScopeSets=[],(u=this._queueExecutor)===null||u===void 0||u.call(this)}}}}return await this._queuePromise}this._newTokenScopeSets=[...i];const{promise:r,resolve:s,reject:a}=P$();this._newTokenPromise=r;try{s(await this._executor(this._newTokenScopeSets))}catch(o){a(o)}finally{this._newTokenPromise=null,this._newTokenScopeSets=[],(n=this._queueExecutor)===null||n===void 0||n.call(this)}return await r}}class Xae extends j1{constructor(e){super(`The user context for the user ${e} has been disabled.
This happened because the access token became invalid (e.g. by expiry) and refreshing it failed (e.g. because the account's password was changed).

Use .addUser(), .addUserForToken() or .addUserForCode() for the same user context to re-enable the user with a new, valid token.`),this.userId=e}}class A1t extends j1{constructor(e){super(`User ${e} was removed while trying to fetch a token.

Make sure you're not executing any actions when you want to remove a user.`),this.userId=e}}class R1t extends j1{constructor(e){super(`Unknown intent: ${e}`),this.intent=e}}let oE=class extends Bk{constructor(e){var n;super(),this._userAccessTokens=new Map,this._userTokenFetchers=new Map,this._intentToUserId=new Map,this._userIdToIntents=new Map,this._cachedRefreshFailures=new Set,this.onRefresh=this.registerEvent(),this.onRefreshFailure=this.registerEvent(),this._clientId=e.clientId,this._clientSecret=e.clientSecret,this._redirectUri=e.redirectUri,this._appImpliedScopes=(n=e.appImpliedScopes)!==null&&n!==void 0?n:[],this._appTokenFetcher=new Yae(async i=>await this._fetchAppToken(i))}addUser(e,n,i){const r=Lv(e);if(!n.refreshToken)throw new Error(`Trying to add user ${r} without refresh token`);this._cachedRefreshFailures.delete(r),this._userAccessTokens.set(r,{...n,userId:r}),this._userTokenFetchers.has(r)||this._userTokenFetchers.set(r,new Yae(async s=>await this._fetchUserToken(r,s))),i&&this.addIntentsToUser(e,i)}async addUserForToken(e,n){let i=null;if(e.accessToken&&!Q2(e))try{const o=await WN(e.accessToken);i=[e,o]}catch(o){if(!(o instanceof pC))throw o}if(!i){if(!e.refreshToken)throw new pC;const o=await Wae(this._clientId,this._clientSecret,e.refreshToken),c=await WN(o.accessToken);this.emit(this.onRefresh,c.userId,o),i=[o,c]}const[r,s]=i;if(!s.userId)throw new eL("Could not determine a user ID for your token; you might be trying to disguise an app token as a user token.");const a=r.scope?r:{...r,scope:s.scopes};return this.addUser(s.userId,a,n),s.userId}async addUserForCode(e,n){if(!this._redirectUri)throw new Error("This method requires you to pass a `redirectUri` as a configuration property");const i=await S1t(this._clientId,this._clientSecret,e,this._redirectUri);return await this.addUserForToken(i,n)}hasUser(e){return this._userTokenFetchers.has(Lv(e))}removeUser(e){const n=Lv(e);if(this._userIdToIntents.has(n)){const i=this._userIdToIntents.get(n);for(const r of i)this._intentToUserId.delete(r);this._userIdToIntents.delete(n)}this._userAccessTokens.delete(n),this._userTokenFetchers.delete(n),this._cachedRefreshFailures.delete(n)}addIntentsToUser(e,n){const i=Lv(e);if(!this._userAccessTokens.has(i))throw new Error("Trying to add intents to a user that was not added to this provider");for(const r of n)this._intentToUserId.has(r)&&this._userIdToIntents.get(this._intentToUserId.get(r)).delete(r),this._intentToUserId.set(r,i),this._userIdToIntents.has(i)?this._userIdToIntents.get(i).add(r):this._userIdToIntents.set(i,new Set([r]))}getIntentsForUser(e){const n=Lv(e);return this._userIdToIntents.has(n)?Array.from(this._userIdToIntents.get(n)):[]}removeIntents(e){var n;for(const i of e)if(this._intentToUserId.has(i)){const r=this._intentToUserId.get(i);(n=this._userIdToIntents.get(r))===null||n===void 0||n.delete(i),this._intentToUserId.delete(i)}}async refreshAccessTokenForUser(e){const n=Lv(e);if(this._cachedRefreshFailures.has(n))throw new Xae(n);const i=this._userAccessTokens.get(n);if(!i)throw new Error("Trying to refresh token for user that was not added to the provider");const r=await this._refreshUserTokenWithCallback(n,i.refreshToken);return this._checkIntermediateUserRemoval(n),this._userAccessTokens.set(n,{...r,userId:n}),this.emit(this.onRefresh,n,r),{...r,userId:n}}async refreshAccessTokenForIntent(e){if(!this._intentToUserId.has(e))throw new R1t(e);const n=this._intentToUserId.get(e);return await this.refreshAccessTokenForUser(n)}get clientId(){return this._clientId}getCurrentScopesForUser(e){var n;const i=this._userAccessTokens.get(Lv(e));if(!i)throw new Error("Trying to get scopes for user that was not added to the provider");return(n=i.scope)!==null&&n!==void 0?n:[]}async getAccessTokenForUser(e,...n){const i=Lv(e),r=this._userTokenFetchers.get(i);if(!r)return null;if(this._cachedRefreshFailures.has(i))throw new Xae(i);return tL(this.getCurrentScopesForUser(i),n.filter(Boolean)),await r.fetch(...n)}async getAccessTokenForIntent(e,...n){if(!this._intentToUserId.has(e))return null;const i=this._intentToUserId.get(e),r=await this.getAccessTokenForUser(i,...n);if(!r)throw new $ae(`Found intent ${e} corresponding to user ID ${i} but no token was found`);return{...r,userId:i}}async getAnyAccessToken(e){if(e){const n=Lv(e);if(this._userAccessTokens.has(n)){const i=await this.getAccessTokenForUser(n);if(!i)throw new $ae(`Token for user ID ${n} exists but nothing was returned by getAccessTokenForUser`);return{...i,userId:n}}}return await this.getAppAccessToken()}async getAppAccessToken(e=!1){return e&&(this._appAccessToken=void 0),await this._appTokenFetcher.fetch(...this._appImpliedScopes.map(n=>[n]))}_checkIntermediateUserRemoval(e){if(!this._userTokenFetchers.has(e))throw this._cachedRefreshFailures.delete(e),new A1t(e)}async _fetchUserToken(e,n){const i=this._userAccessTokens.get(e);if(!i)throw new Error("Trying to get token for user that was not added to the provider");if(i.accessToken&&!Q2(i))try{if(i.scope)return tL(i.scope,n),i;const[s=[]]=await C1t(this._clientId,i.accessToken,e,i.scope,n),a={...i,scope:s};return this._checkIntermediateUserRemoval(e),this._userAccessTokens.set(e,a),a}catch(s){if(!(s instanceof pC))throw s}this._checkIntermediateUserRemoval(e);const r=await this.refreshAccessTokenForUser(e);return tL(r.scope,n),r}async _refreshUserTokenWithCallback(e,n){try{return await Wae(this.clientId,this._clientSecret,n)}catch(i){throw this._cachedRefreshFailures.add(e),this.emit(this.onRefreshFailure,e,i),i}}async _fetchAppToken(e){if(e.length>0)for(const n of e)if(this._appImpliedScopes.length){if(n.every(i=>!this._appImpliedScopes.includes(i)))throw new Error(`One of the scopes ${n.join(", ")} requested but only the scope ${this._appImpliedScopes.join(", ")} is implied`)}else throw new Error(`One of the scopes ${n.join(", ")} requested but the client credentials flow does not support scopes`);return!this._appAccessToken||Q2(this._appAccessToken)?await this._refreshAppToken():this._appAccessToken}async _refreshAppToken(){return this._appAccessToken=await T1t(this._clientId,this._clientSecret)}};ca([IE(!1)],oE.prototype,"_clientSecret",void 0);ca([IE(!1)],oE.prototype,"_userAccessTokens",void 0);ca([IE(!1)],oE.prototype,"_userTokenFetchers",void 0);ca([IE(!1)],oE.prototype,"_appAccessToken",void 0);ca([IE(!1)],oE.prototype,"_appTokenFetcher",void 0);oE=ca([Fk("auth","RefreshingAuthProvider","clientId")],oE);class M1t extends Bk{constructor({lineBased:e,logger:n,additionalOptions:i}={}){super(),this._currentLine="",this._connecting=!1,this._connected=!1,this.onReceive=this.registerEvent(),this.onConnect=this.registerEvent(),this.onDisconnect=this.registerEvent(),this.onEnd=this.registerEvent(),this._lineBased=e??!1,this._logger=n,this._additionalOptions=i}get isConnecting(){return this._connecting}get isConnected(){return this._connected}sendLine(e){this._connected&&(e=e.replace(/[\0\r\n]/g,""),this.sendRaw(`${e}\r
`))}assumeExternalDisconnect(){var e;(e=this._logger)===null||e===void 0||e.trace("AbstractConnection assumeExternalDisconnect"),this._connected=!1,this._connecting=!1,this.clearSocket(),this.emit(this.onDisconnect,!1)}receiveRaw(e){var n,i;if(!this._lineBased){this.emit(this.onReceive,e);return}const r=e.split(`\r
`);if(this._currentLine+=(n=r.shift())!==null&&n!==void 0?n:"",r.length){this.emit(this.onReceive,this._currentLine),this._currentLine=(i=r.pop())!==null&&i!==void 0?i:"";for(const s of r)this.emit(this.onReceive,s)}}}class O1t{constructor(){throw new Error("DirectConnection is not implemented in a browser environment")}}class N1t extends Bk{constructor(e,n,i={}){var r;super(),this._type=e,this._target=n,this._config=i,this._retryLimit=1/0,this._initialRetryLimit=3,this._connecting=!1,this._connectionRetryCount=0,this.onReceive=this.registerEvent(),this.onConnect=this.registerEvent(),this.onDisconnect=this.registerEvent(),this.onEnd=this.registerEvent(),this._retryLimit=(r=i.retryLimit)!==null&&r!==void 0?r:1/0,this._logger=i.logger}get isConnected(){var e,n;return(n=(e=this._currentConnection)===null||e===void 0?void 0:e.isConnected)!==null&&n!==void 0?n:!1}get isConnecting(){var e,n;return(n=(e=this._currentConnection)===null||e===void 0?void 0:e.isConnecting)!==null&&n!==void 0?n:this._connecting}get hasSocket(){var e,n;return(n=(e=this._currentConnection)===null||e===void 0?void 0:e.hasSocket)!==null&&n!==void 0?n:!1}sendLine(e){var n;(n=this._currentConnection)===null||n===void 0||n.sendLine(e)}connect(){if(this._currentConnection||this._connecting)throw new Error("Connection already present");this._connecting=!0,this._connectionRetryCount=0,this._tryConnect(!0)}disconnect(){var e;if((e=this._logger)===null||e===void 0||e.trace(`PersistentConnection disconnect currentConnectionExists:${(!!this._currentConnection).toString()} connecting:${this._connecting.toString()}`),this._connecting=!1,this._currentConnection){const n=this._currentConnection;this._currentConnection=void 0,n.disconnect()}}assumeExternalDisconnect(){var e,n;(e=this._logger)===null||e===void 0||e.trace("PersistentConnection assumeExternalDisconnect"),(n=this._currentConnection)===null||n===void 0||n.assumeExternalDisconnect()}reconnect(){this._reconnect(!0)}acknowledgeSuccessfulReconnect(){this._previousConnection&&(this._previousConnection.disconnect(),this._previousConnection=void 0)}_startTryingToConnect(e=!1){this._connecting=!0,this._connectionRetryCount=0,this._tryConnect(e)}_tryConnect(e=!1){var n,i;(n=this._logger)===null||n===void 0||n.trace(`PersistentConnection tryConnect currentConnectionExists:${(!!this._currentConnection).toString()} connecting:${this._connecting.toString()}`);const r=e?this._initialRetryLimit:this._retryLimit;(i=this._retryTimerGenerator)!==null&&i!==void 0||(this._retryTimerGenerator=BSe(120));const s=this._currentConnection=new this._type(RTt(this._target),this._config);s.onReceive(a=>this.emit(this.onReceive,a)),s.onConnect(()=>{this.emit(this.onConnect),this._connecting=!1,this._retryTimerGenerator=void 0}),s.onDisconnect((a,o)=>{var c,l,u;if(this.emit(this.onDisconnect,a,o),a)this.emit(this.onEnd,!0),this._connecting=!1,this._retryTimerGenerator=void 0,s.disconnect(),this._currentConnection===s&&(this._currentConnection=void 0),this._previousConnection===s&&(this._previousConnection=void 0);else if(this._connecting){if((c=this._logger)===null||c===void 0||c.debug(`Connection error caught: ${(l=o==null?void 0:o.message)!==null&&l!==void 0?l:"unknown error"}`),this._connectionRetryCount>=r)return;this._connectionRetryCount++;const h=this._retryTimerGenerator.next().value;h!==0&&((u=this._logger)===null||u===void 0||u.info(`Retrying in ${h} seconds`)),setTimeout(()=>{var f;this._connecting&&((f=this._logger)===null||f===void 0||f.info(e?"Retrying connection":"Trying to reconnect"),this._tryConnect())},h*1e3)}else this._reconnect()}),s.connect()}_reconnect(e=!1){e&&this._config.overlapManualReconnect?(this._previousConnection=this._currentConnection,this._currentConnection=void 0):this.disconnect(),this._startTryingToConnect(e)}}var hw=null;typeof WebSocket<"u"?hw=WebSocket:typeof MozWebSocket<"u"?hw=MozWebSocket:typeof um<"u"?hw=um.WebSocket||um.MozWebSocket:typeof window<"u"?hw=window.WebSocket||window.MozWebSocket:typeof self<"u"&&(hw=self.WebSocket||self.MozWebSocket);class I1t extends M1t{constructor(e,n){if(super(n),this._socket=null,this._closingOnDemand=!1,e.hostName&&e.port)this._url=`ws${e.secure?"s":""}://${e.hostName}:${e.port}`;else if(e.url)this._url=e.url;else throw new Error("WebSocketConnection requires either hostName & port or url to be set")}get hasSocket(){return!!this._socket}sendRaw(e){var n;(n=this._socket)===null||n===void 0||n.send(e)}connect(){var e,n;(e=this._logger)===null||e===void 0||e.trace("WebSocketConnection connect"),this._connecting=!0,this._socket=new hw(this._url,(n=this._additionalOptions)===null||n===void 0?void 0:n.wsOptions),this._socket.onopen=()=>{var i;(i=this._logger)===null||i===void 0||i.trace("WebSocketConnection onOpen"),this._connected=!0,this._connecting=!1,this._closingOnDemand=!1,this.emit(this.onConnect)},this._socket.onmessage=({data:i})=>{this.receiveRaw(i.toString())},this._socket.onerror=i=>{var r;(r=this._logger)===null||r===void 0||r.trace(`WebSocketConnection onError message:${i.message}`)},this._socket.onclose=i=>{var r;const s=this._connected,a=this._connecting;if((r=this._logger)===null||r===void 0||r.trace(`WebSocketConnection onClose wasConnected:${s.toString()} wasConnecting:${a.toString()} closingOnDemand:${this._closingOnDemand.toString()} wasClean:${i.wasClean.toString()}`),this._connected=!1,this._connecting=!1,this._closingOnDemand)this._closingOnDemand=!1,this.emit(this.onDisconnect,!0),this.emit(this.onEnd,!0);else{const o=new Error(`[${i.code}] ${i.reason}`);this.emit(this.onDisconnect,!1,o),this.emit(this.onEnd,!1,o)}this.clearSocket()}}disconnect(){var e,n;(e=this._logger)===null||e===void 0||e.trace("WebSocketConnection disconnect"),this._closingOnDemand=!0,(n=this._socket)===null||n===void 0||n.close()}clearSocket(){this._socket&&(this._socket.onopen=null,this._socket.onmessage=null,this._socket.onerror=null,this._socket.onclose=null,this._socket=null)}}function iO(t){var e,n,i;if(Array.isArray(t)){for(n=Array(e=t.length);e--;)n[e]=(i=t[e])&&typeof i=="object"?iO(i):i;return n}if(Object.prototype.toString.call(t)==="[object Object]"){n={};for(e in t)e==="__proto__"?Object.defineProperty(n,e,{value:iO(t[e]),configurable:!0,enumerable:!0,writable:!0}):n[e]=(i=t[e])&&typeof i=="object"?iO(i):i;return n}return t}const k1t={name:"away-notify"};class nB extends Error{constructor(e,n,i){super(`command "${e}" expected ${n} or more parameters, got ${i}`),this._command=e,this._expectedParams=n,this._actualParams=i,Object.setPrototypeOf(this,nB.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,nB)}get command(){return this._command}get expectedParams(){return this._expectedParams}get actualParams(){return this._actualParams}}class iB extends Error{constructor(e,n,i,r){var s;super(`required parameter "${n}" did not validate against ${(s=i.type)!==null&&s!==void 0?s:"regex"} validation: "${r}"`),this._command=e,this._paramName=n,this._paramSpec=i,this._givenValue=r,Object.setPrototypeOf(this,iB.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,iB)}get command(){return this._command}get paramName(){return this._paramName}get paramSpec(){return this._paramSpec}get givenValue(){return this._givenValue}}const mC={channelTypes:"#&",supportedUserModes:"iwso",supportedChannelModes:{prefix:"ov",list:"b",alwaysWithParam:"ovk",paramWhenSet:"l",noParam:"imnpst"},prefixes:[{modeChar:"v",prefix:"+"},{modeChar:"o",prefix:"@"}]};var KSe={exports:{}};(function(t){t.exports=e=>{if(typeof e!="string")throw new TypeError("Expected a string");return e.replace(/[|\\{}()[\]^$+*?.]/g,"\\$&").replace(/-/g,"\\x2d")},t.exports.default=t.exports})(KSe);var D1t=KSe.exports;const P1t=Yc(D1t);function z$(t,e="#&"){return new RegExp(`^[${P1t(e)}][^ \b\0
\r,]+$`).test(t)}const Kae={0:"\0",n:`
`,r:"\r","":""};function Zae(t){if(!t.startsWith("")||(t=t.substring(1),t.endsWith("")&&(t=t.slice(0,-1)),!t))return!1;t=t.replace(/\x10(.)/,(i,r)=>r in Kae?Kae[r]:"");let[e,n=""]=OT(t," ",2);return e=e?e.toUpperCase():"",{command:e,params:n}}const L1t={"\\":"\\",";":":","\n":"n","\r":"r"," ":"s"};function U1t(t){return t.replace(/[\\;\n\r ]/g,e=>`\\${L1t[e]}`)}function B1t(t){let e=`${t.nick}`;return t.user&&(e+=`!${t.user}`),t.host&&(e+=`@${t.host}`),e}function F1t(t,e,n,i,r=mC,s=!1){const a=new t(t.COMMAND,void 0,{serverProperties:r}),o={};if(a._paramSpec&&D$(a._paramSpec,(c,l)=>{if(!(s&&c.noServer)&&!(!s&&c.noClient)){if(l in e){const u=e[l];if(u!==void 0){if(t.checkParam(u,c,r))o[l]={value:u,trailing:!!c.trailing};else if(!c.optional)throw new Error(`required parameter "${l}" did not suit requirements: "${u}"`)}}if(!(l in o)&&!c.optional)throw new Error(`required parameter "${l}" not found in command "${t.COMMAND}"`)}}),a._parsedParams=o,a._paramSpec)for(const c of Object.keys(a._paramSpec))Object.defineProperty(a,c,{get(){var l,u;return(u=(l=this._parsedParams)===null||l===void 0?void 0:l[c])===null||u===void 0?void 0:u.value}});return a._initPrefixAndTags(n,i),a}class zt{static checkParam(e,n,i=mC){return!(n.type==="channel"&&!z$(e,i.channelTypes)||n.type==="channelList"&&!e.split(",").every(s=>z$(s,i.channelTypes))||n.match&&!n.match.test(e))}constructor(e,{params:n,tags:i,prefix:r,rawLine:s}={},{serverProperties:a=mC,isServer:o=!1,shouldParseParams:c=!0}={},l){this._params=[],this._serverProperties=mC,this._paramSpec=l,this._command=e,this._params=n,this._tags=i??new Map,this._prefix=r,this._serverProperties=a,this._raw=s,c&&this.parseParams(o)}getMinParamCount(e=!1){return this._paramSpec?Object.values(this._paramSpec).filter(n=>n.noServer&&e||n.noClient&&!e?!1:!n.optional).length:0}get paramCount(){var e,n;return(n=(e=this._params)===null||e===void 0?void 0:e.length)!==null&&n!==void 0?n:0}prefixToString(){return this._prefix?B1t(this._prefix):""}tagsToString(){return[...this._tags.entries()].map(([e,n])=>n?`${e}=${U1t(n)}`:e).join(";")}toString(e=!1,n=!1){const r=[n?this._buildCommandFromRawParams():this._buildCommandFromNamedParams()];if(e){const a=this.prefixToString();a&&r.unshift(`:${a}`)}const s=this.tagsToString();return s&&r.unshift(`@${s}`),r.join(" ")}_initPrefixAndTags(e,n){this._prefix=e,n&&(this._tags=n)}parseParams(e=!1){if(this._params){let n=this.getMinParamCount(e);if(n>this._params.length)throw new nB(this._command,n,this._params.length);const i=this._paramSpec;if(!i)return;let r=0;const s={};for(const[a,o]of Object.entries(i)){if(o.noServer&&e||o.noClient&&!e)continue;if(this._params.length-r<=n){if(o.optional)continue;if(this._params.length-r!==n)throw new Error("not enough parameters left for required parameters parsing (this is a library bug)")}let c=this._params[r];if(!c){if(o.optional)break;throw new Error("unexpected parameter underflow")}if(o.rest){const l=[];for(;this._params[r]&&!this._params[r].trailing;)l.push(this._params[r].value),++r;if(!l.length){if(o.optional)continue;throw new Error(`no parameters left for required rest parameter "${a}"`)}c={value:l.join(" "),trailing:!1}}if(zt.checkParam(c.value,o))s[a]={...c},o.optional||--n,o.rest||++r;else if(!o.optional)throw new iB(this._command,a,o,c.value);if(o.trailing)break}if(this._parsedParams=s,this._paramSpec)for(const a of Object.keys(this._paramSpec))Object.defineProperty(this,a,{get(){var o,c;return(c=(o=this._parsedParams)===null||o===void 0?void 0:o[a])===null||c===void 0?void 0:c.value}})}}get rawParamValues(){var e,n;return(n=(e=this._params)===null||e===void 0?void 0:e.map(i=>i.value))!==null&&n!==void 0?n:[]}get prefix(){return this._prefix}get command(){return this._command}get tags(){return this._tags}get rawLine(){return this._raw}isResponseTo(e){return!1}endsResponseTo(e){return!1}_acceptsInReplyCollection(e){return e.isResponseTo(this)}_buildCommandFromNamedParams(){const e=this._paramSpec?Object.keys(this._paramSpec):[];return[this._command,...e.map(n=>{var i;const r=(i=this._parsedParams)===null||i===void 0?void 0:i[n];if(r)return(r.trailing?":":"")+r.value}).filter(n=>n!==void 0)].join(" ")}_buildCommandFromRawParams(){var e,n;return[this._command,...(n=(e=this._params)===null||e===void 0?void 0:e.map(i=>`${i.trailing?":":""}${i.value}`))!==null&&n!==void 0?n:[]].join(" ")}}zt.COMMAND="";zt.SUPPORTS_CAPTURE=!1;class ZSe extends zt{constructor(e,n,i){super(e,n,i,{reference:{},type:{optional:!0},additionalParams:{optional:!0}})}}ZSe.COMMAND="BATCH";const z1t={name:"batch",messageTypes:[ZSe],usesTags:!0},H1t={name:"cap-notify"};class JSe extends zt{constructor(e,n,i){super(e,n,i,{newUser:{},newHost:{}})}}JSe.COMMAND="CHGHOST";const j1t={name:"chghost",messageTypes:[JSe]},V1t={name:"invite-notify"};class QSe extends zt{}QSe.COMMAND="ACK";const G1t={name:"labeled-response",messageTypes:[QSe],usesTags:!0},q1t={name:"message-tags",usesTags:!0},$1t={name:"multi-prefix"},W1t=Object.freeze(Object.defineProperty({__proto__:null,AwayNotify:k1t,Batch:z1t,CapNotify:H1t,ChgHost:j1t,InviteNotify:V1t,LabeledResponse:G1t,MessageTags:q1t,MultiPrefix:$1t},Symbol.toStringTag,{value:"Module"}));class Y1t{constructor(e,n,...i){this._client=e,this._originalMessage=n,this._messages=[],this._endEventHandlers=new Map,this._types=new Set(i)}untilEvent(e){this._cleanEndEventHandler(e);const n=this._client.on(e,()=>this.end());this._endEventHandlers.set(e,n)}async promise(){return this._promise||(this._promise=new Promise(e=>{this._promiseResolve=e})),await this._promise}collect(e){return this._originalMessage._acceptsInReplyCollection(e)?(this._messages.push(e),e.endsResponseTo(this._originalMessage)&&this.end(),!0):!1}end(){this._client.stopCollect(this),this._cleanEndEventHandlers(),this._promiseResolve&&this._promiseResolve(this._messages)}_cleanEndEventHandlers(){this._endEventHandlers.forEach(e=>{this._client.removeListener(e)}),this._endEventHandlers.clear()}_cleanEndEventHandler(e){this._endEventHandlers.has(e)&&(this._client.removeListener(this._endEventHandlers.get(e)),this._endEventHandlers.delete(e))}}class GK extends zt{constructor(e,n,i){super(e,n,i,{password:{}})}}GK.COMMAND="PASS";class rO extends zt{constructor(e,n,i){super(e,n,i,{nick:{}})}}rO.COMMAND="NICK";class qK extends zt{constructor(e,n,i){super(e,n,i,{user:{},mode:{},unused:{},realName:{trailing:!0}})}}qK.COMMAND="USER";class eTe extends zt{constructor(e,n,i){super(e,n,i,{name:{},password:{}})}}eTe.COMMAND="OPER";class $K extends zt{constructor(e,n,i){super(e,n,i,{text:{trailing:!0,optional:!0}})}}$K.COMMAND="QUIT";class tTe extends zt{constructor(e,n,i){super(e,n,i,{server:{},reason:{trailing:!0}})}}tTe.COMMAND="SQUIT";class YN extends zt{constructor(e,n,i){super(e,n,i,{channel:{type:"channel"},key:{optional:!0}})}}YN.COMMAND="JOIN";class XN extends zt{constructor(e,n,i){super(e,n,i,{channel:{type:"channel"},reason:{trailing:!0,optional:!0}})}}XN.COMMAND="PART";class rB extends Error{constructor(e){super(`Unknown channel mode character ${e}`),this._char=e,Object.setPrototypeOf(this,rB.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,rB)}get char(){return this._char}}class nTe extends zt{constructor(e,n,i){super(e,n,i,{target:{},modes:{rest:!0,optional:!0}})}get isChannel(){return z$(this.target,this._serverProperties.channelTypes)}separate(){const e=[],n=this.modes;if(!n)throw new Error("can't separate a channel mode request, just set actions");const i=n.split(" "),r=i.shift();let s="add";for(const a of r){let o=s;switch(a){case"+":{s="add";break}case"-":{s="remove";break}default:{let c=!1,l=!0;if(this.isChannel){if(this._serverProperties.supportedChannelModes.alwaysWithParam.includes(a)||this._serverProperties.supportedChannelModes.prefix.includes(a))c=!0;else if(this._serverProperties.supportedChannelModes.paramWhenSet.includes(a))s==="add"&&(c=!0);else if(this._serverProperties.supportedChannelModes.list.includes(a))i.length?c=!0:o="getList";else if(!this._serverProperties.supportedChannelModes.noParam.includes(a))throw new rB(a)}else l=this._serverProperties.supportedUserModes.includes(a);if(c&&!i.length)continue;e.push({prefix:this._prefix,action:o,letter:a,param:c?i.shift():void 0,known:l})}}}return e}}nTe.COMMAND="MODE";class iTe extends zt{constructor(e,n,i){super(e,n,i,{channel:{type:"channel"},newTopic:{optional:!0,trailing:!0}})}}iTe.COMMAND="TOPIC";class zk extends zt{constructor(e,n,i){super(e,n,i,{channel:{type:"channelList",optional:!0}})}}zk.COMMAND="NAMES";zk.SUPPORTS_CAPTURE=!0;class rTe extends zt{constructor(e,n,i){super(e,n,i,{channel:{optional:!0},server:{optional:!0}})}}rTe.COMMAND="LIST";class sTe extends zt{constructor(e,n,i){super(e,n,i,{target:{},channel:{type:"channel"}})}}sTe.COMMAND="INVITE";class aTe extends zt{constructor(e,n,i){super(e,n,i,{channel:{type:"channel"},target:{},reason:{trailing:!0,optional:!0}})}}aTe.COMMAND="KICK";class oTe extends zt{constructor(e,n,i){super(e,n,i,{server:{optional:!0}})}}oTe.COMMAND="TIME";class KN extends zt{constructor(e,n,i){super(e,n,i,{target:{},text:{trailing:!0}})}}KN.COMMAND="PRIVMSG";class S8 extends zt{constructor(e,n,i){super(e,n,i,{target:{},text:{trailing:!0}})}}S8.COMMAND="NOTICE";class T8 extends zt{constructor(e,n,i){super(e,n,i,{mask:{},flags:{optional:!0},extendedMask:{optional:!0,trailing:!0}})}}T8.COMMAND="WHO";class cTe extends zt{constructor(e,n,i){super(e,n,i,{server:{optional:!0},nickMask:{}})}}cTe.COMMAND="WHOIS";class lTe extends zt{constructor(e,n,i){super(e,n,i,{nick:{},count:{optional:!0},server:{optional:!0}})}}lTe.COMMAND="WHOWAS";class uTe extends zt{constructor(e,n,i){super(e,n,i,{target:{},reason:{trailing:!0,optional:!0}})}}uTe.COMMAND="KILL";class sB extends zt{constructor(e,n,i){super(e,n,i,{text:{trailing:!0}})}}sB.COMMAND="PING";class aB extends zt{constructor(e,n,i){super(e,n,i,{server:{noClient:!0},text:{trailing:!0}})}}aB.COMMAND="PONG";class hTe extends zt{constructor(e,n,i){super(e,n,i,{text:{trailing:!0}})}}hTe.COMMAND="ERROR";class fTe extends zt{constructor(e,n,i){super(e,n,i,{text:{trailing:!0,optional:!0}})}}fTe.COMMAND="AWAY";class dTe extends zt{}dTe.COMMAND="REHASH";class pTe extends zt{}pTe.COMMAND="RESTART";class mTe extends zt{constructor(e,n,i){super(e,n,i,{text:{trailing:!0}})}}mTe.COMMAND="WALLOPS";class gTe extends zt{constructor(e,n,i){super(e,n,i,{nicks:{rest:!0}})}}gTe.COMMAND="USERHOST";class vTe extends zt{constructor(e,n,i){super(e,n,i,{nicks:{rest:!0}})}}vTe.COMMAND="ISON";class Yd extends zt{constructor(e,n,i){super(e,n,i,{target:{match:/^(?:[a-z_\-\[\]\\^{}|`][a-z0-9_\-\[\]\\^{}|`]+|\*)$/i,optional:!0,noClient:!0},subCommand:{match:/^(?:LS|LIST|REQ|ACK|NAK|END|NEW|DEL)$/i},version:{match:/^\d+$/,optional:!0},continued:{match:/^\*$/,optional:!0},capabilities:{trailing:!0,optional:!0}})}isResponseTo(e){if(!(e instanceof Yd))return!1;switch(this.subCommand){case"ACK":case"NAK":return e.subCommand==="REQ"&&e.capabilities===this.capabilities.trim();case"LS":case"LIST":return e.subCommand===this.subCommand;default:return!1}}endsResponseTo(e){if(!(e instanceof Yd))return!1;switch(this.subCommand){case"LS":case"LIST":return!this.continued;default:return!0}}}Yd.COMMAND="CAP";Yd.SUPPORTS_CAPTURE=!0;class _Te extends zt{constructor(e,n,i){super(e,n,i,{target:{}})}}_Te.COMMAND="TAGMSG";const yTe=Object.freeze(Object.defineProperty({__proto__:null,Away:fTe,CapabilityNegotiation:Yd,ChannelInvite:sTe,ChannelJoin:YN,ChannelKick:aTe,ChannelList:rTe,ChannelPart:XN,ClientQuit:$K,ErrorMessage:hTe,IsOnQuery:vTe,Kill:uTe,Mode:nTe,Names:zk,NickChange:rO,Notice:S8,OperLogin:eTe,Password:GK,Ping:sB,Pong:aB,PrivateMessage:KN,Rehash:dTe,Restart:pTe,ServerQuit:tTe,TagMessage:_Te,Time:oTe,Topic:iTe,UserHostQuery:gTe,UserRegistration:qK,Wallops:mTe,WhoIsQuery:cTe,WhoQuery:T8,WhoWasQuery:lTe},Symbol.toStringTag,{value:"Module"}));class WK extends zt{constructor(e,n,i){super(e,n,i,{me:{},welcomeText:{trailing:!0}})}}WK.COMMAND="001";class bTe extends zt{constructor(e,n,i){super(e,n,i,{me:{},yourHost:{trailing:!0}})}}bTe.COMMAND="002";class ETe extends zt{constructor(e,n,i){super(e,n,i,{me:{},createdText:{trailing:!0}})}}ETe.COMMAND="003";class YK extends zt{constructor(e,n,i){super(e,n,i,{me:{},serverName:{},version:{},userModes:{},channelModes:{},channelModesWithParam:{optional:!0}})}}YK.COMMAND="004";class XK extends zt{constructor(e,n,i){super(e,n,i,{me:{},supports:{rest:!0},suffix:{trailing:!0}})}}XK.COMMAND="005";class STe extends zt{constructor(e,n,i){super(e,n,i,{me:{},modes:{}})}}STe.COMMAND="221";class TTe extends zt{constructor(e,n,i){super(e,n,i,{me:{},nick:{},text:{trailing:!0}})}}TTe.COMMAND="301";class xTe extends zt{constructor(e,n,i){super(e,n,i,{me:{},hosts:{trailing:!0}})}}xTe.COMMAND="302";class wTe extends zt{constructor(e,n,i){super(e,n,i,{me:{},suffix:{trailing:!0}})}}wTe.COMMAND="305";class CTe extends zt{constructor(e,n,i){super(e,n,i,{me:{},suffix:{trailing:!0}})}}CTe.COMMAND="306";class ATe extends zt{constructor(e,n,i){super(e,n,i,{me:{},nick:{},username:{},host:{},_unused:{},realname:{trailing:!0}})}}ATe.COMMAND="311";class RTe extends zt{constructor(e,n,i){super(e,n,i,{me:{},query:{},suffix:{trailing:!0}})}isResponseTo(e){return e instanceof T8}endsResponseTo(){return!0}}RTe.COMMAND="315";class MTe extends zt{constructor(e,n,i){super(e,n,i,{me:{},nickMask:{},suffix:{trailing:!0}})}}MTe.COMMAND="318";class OTe extends zt{constructor(e,n,i){super(e,n,i,{me:{},nick:{},channels:{trailing:!0}})}}OTe.COMMAND="319";class NTe extends zt{constructor(e,n,i){super(e,n,i,{me:{},channel:{type:"channel"},memberCount:{},topic:{trailing:!0}})}}NTe.COMMAND="322";class ITe extends zt{constructor(e,n,i){super(e,n,i,{me:{},suffix:{trailing:!0}})}}ITe.COMMAND="323";class kTe extends zt{constructor(e,n,i){super(e,n,i,{me:{},channel:{type:"channel"},modes:{rest:!0}})}}kTe.COMMAND="324";class DTe extends zt{constructor(e,n,i){super(e,n,i,{me:{},channel:{type:"channel"},suffix:{trailing:!0}})}}DTe.COMMAND="331";class PTe extends zt{constructor(e,n,i){super(e,n,i,{me:{},channel:{type:"channel"},topic:{trailing:!0}})}}PTe.COMMAND="332";class LTe extends zt{constructor(e,n,i){super(e,n,i,{me:{},channel:{type:"channel"},who:{},ts:{}})}}LTe.COMMAND="333";class UTe extends zt{constructor(e,n,i){super(e,n,i,{me:{},nick:{},channel:{type:"channel"}})}}UTe.COMMAND="341";class BTe extends zt{constructor(e,n,i){super(e,n,i,{me:{},channel:{type:"channel"},mask:{},creatorName:{optional:!0},timestamp:{optional:!0}})}}BTe.COMMAND="348";class FTe extends zt{constructor(e,n,i){super(e,n,i,{me:{},channel:{type:"channel"},suffix:{trailing:!0}})}}FTe.COMMAND="349";class zTe extends zt{constructor(e,n,i){super(e,n,i,{me:{},channel:{},user:{},host:{},server:{},nick:{},flags:{},hopsAndRealName:{trailing:!0}})}get isAway(){return this.flags.includes("G")}get isOper(){return this.flags.includes("*")}get isBot(){return this.flags.includes("B")}isResponseTo(e){return e instanceof T8}}zTe.COMMAND="352";class HTe extends zt{constructor(e,n,i){super(e,n,i,{me:{},channelType:{},channel:{type:"channel"},names:{trailing:!0}})}isResponseTo(e){return e instanceof zk}}HTe.COMMAND="353";class jTe extends zt{constructor(e,n,i){super(e,n,i,{me:{},channel:{},suffix:{trailing:!0}})}isResponseTo(e){return e instanceof zk}endsResponseTo(){return!0}}jTe.COMMAND="366";class VTe extends zt{constructor(e,n,i){super(e,n,i,{me:{},channel:{type:"channel"},mask:{},creatorName:{optional:!0},timestamp:{optional:!0}})}}VTe.COMMAND="367";class GTe extends zt{constructor(e,n,i){super(e,n,i,{me:{},channel:{type:"channel"},suffix:{trailing:!0}})}}GTe.COMMAND="368";class qTe extends zt{constructor(e,n,i){super(e,n,i,{me:{},line:{trailing:!0}})}}qTe.COMMAND="372";class $Te extends zt{constructor(e,n,i){super(e,n,i,{me:{},line:{trailing:!0}})}}$Te.COMMAND="375";class KK extends zt{constructor(e,n,i){super(e,n,i,{me:{},suffix:{trailing:!0}})}}KK.COMMAND="376";class WTe extends zt{constructor(e,n,i){super(e,n,i,{me:{},suffix:{trailing:!0}})}}WTe.COMMAND="381";class YTe extends zt{constructor(e,n,i){super(e,n,i,{me:{},server:{optional:!0},timestamp:{trailing:!0}})}}YTe.COMMAND="391";class XTe extends zt{constructor(e,n,i){super(e,n,i,{me:{},nick:{},suffix:{trailing:!0}})}}XTe.COMMAND="401";class KTe extends zt{constructor(e,n,i){super(e,n,i,{me:{},server:{},suffix:{trailing:!0}})}}KTe.COMMAND="402";class ZTe extends zt{constructor(e,n,i){super(e,n,i,{me:{},channel:{},suffix:{trailing:!0}})}}ZTe.COMMAND="403";class JTe extends zt{constructor(e,n,i){super(e,n,i,{me:{},channel:{type:"channel"},suffix:{trailing:!0}})}}JTe.COMMAND="404";class QTe extends zt{constructor(e,n,i){super(e,n,i,{me:{},channel:{type:"channel"},suffix:{trailing:!0}})}}QTe.COMMAND="405";class e1e extends zt{constructor(e,n,i){super(e,n,i,{me:{},subCommand:{},suffix:{trailing:!0}})}}e1e.COMMAND="410";class t1e extends zt{constructor(e,n,i){super(e,n,i,{me:{},originalCommand:{},suffix:{trailing:!0}})}isResponseTo(e){return e.command===this.originalCommand}endsResponseTo(){return!0}}t1e.COMMAND="421";class ZK extends zt{constructor(e,n,i){super(e,n,i,{me:{},suffix:{trailing:!0}})}}ZK.COMMAND="422";class n1e extends zt{constructor(e,n,i){super(e,n,i,{me:{},suffix:{trailing:!0}})}isResponseTo(e){return e.command==="NICK"}endsResponseTo(){return!0}}n1e.COMMAND="431";class i1e extends zt{constructor(e,n,i){super(e,n,i,{me:{},nick:{},suffix:{trailing:!0}})}isResponseTo(e){return e.command==="NICK"}endsResponseTo(){return!0}}i1e.COMMAND="432";class r1e extends zt{constructor(e,n,i){super(e,n,i,{me:{},nick:{},suffix:{trailing:!0}})}isResponseTo(e){return e.command==="NICK"}endsResponseTo(){return!0}}r1e.COMMAND="433";class s1e extends zt{constructor(e,n,i){super(e,n,i,{me:{},nick:{},suffix:{trailing:!0}})}isResponseTo(e){return e.command==="NICK"}endsResponseTo(){return!0}}s1e.COMMAND="436";class a1e extends zt{constructor(e,n,i){super(e,n,i,{me:{},nick:{},channel:{type:"channel"},suffix:{trailing:!0}})}isResponseTo(e){return e.command==="NICK"}endsResponseTo(){return!0}}a1e.COMMAND="441";class o1e extends zt{constructor(e,n,i){super(e,n,i,{me:{},channel:{type:"channel"},suffix:{trailing:!0}})}isResponseTo(e){return e.command==="NICK"}endsResponseTo(){return!0}}o1e.COMMAND="442";class c1e extends zt{constructor(e,n,i){super(e,n,i,{me:{},nick:{},channel:{type:"channel"},suffix:{trailing:!0}})}isResponseTo(e){return e.command==="NICK"}endsResponseTo(){return!0}}c1e.COMMAND="443";class l1e extends zt{constructor(e,n,i){super(e,n,i,{me:{},suffix:{trailing:!0}})}}l1e.COMMAND="451";class u1e extends zt{constructor(e,n,i){super(e,n,i,{me:{},originalCommand:{},suffix:{trailing:!0}})}}u1e.COMMAND="461";class JK extends zt{constructor(e,n,i){super(e,n,i,{me:{},suffix:{trailing:!0}})}}JK.COMMAND="462";class h1e extends zt{constructor(e,n,i){super(e,n,i,{me:{},channel:{type:"channel"},suffix:{trailing:!0}})}}h1e.COMMAND="471";class f1e extends zt{constructor(e,n,i){super(e,n,i,{me:{},char:{},suffix:{trailing:!0}})}}f1e.COMMAND="472";class d1e extends zt{constructor(e,n,i){super(e,n,i,{me:{},channel:{type:"channel"},suffix:{trailing:!0}})}}d1e.COMMAND="473";class p1e extends zt{constructor(e,n,i){super(e,n,i,{me:{},channel:{type:"channel"},suffix:{trailing:!0}})}}p1e.COMMAND="474";class m1e extends zt{constructor(e,n,i){super(e,n,i,{me:{},channel:{type:"channel"},suffix:{trailing:!0}})}}m1e.COMMAND="475";class g1e extends zt{constructor(e,n,i){super(e,n,i,{me:{},channel:{},suffix:{trailing:!0}})}}g1e.COMMAND="479";class v1e extends zt{constructor(e,n,i){super(e,n,i,{me:{},suffix:{trailing:!0}})}}v1e.COMMAND="481";class _1e extends zt{constructor(e,n,i){super(e,n,i,{me:{},channel:{},suffix:{trailing:!0}})}}_1e.COMMAND="482";class y1e extends zt{constructor(e,n,i){super(e,n,i,{me:{},suffix:{trailing:!0}})}}y1e.COMMAND="491";class b1e extends zt{constructor(e,n,i){super(e,n,i,{me:{},modeChar:{optional:!0,match:/^\w$/},suffix:{trailing:!0}})}}b1e.COMMAND="501";class E1e extends zt{constructor(e,n,i){super(e,n,i,{me:{},suffix:{trailing:!0}})}}E1e.COMMAND="502";const S1e=Object.freeze(Object.defineProperty({__proto__:null,Error401NoSuchNick:XTe,Error402NoSuchServer:KTe,Error403NoSuchChannel:ZTe,Error404CanNotSendToChan:JTe,Error405TooManyChannels:QTe,Error410InvalidCapCmd:e1e,Error421UnknownCommand:t1e,Error422NoMotd:ZK,Error431NoNickNameGiven:n1e,Error432ErroneusNickname:i1e,Error433NickNameInUse:r1e,Error436NickCollision:s1e,Error441UserNotInChannel:a1e,Error442NotOnChannel:o1e,Error443UserOnChannel:c1e,Error451NotRegistered:l1e,Error461NeedMoreParams:u1e,Error462AlreadyRegistered:JK,Error471ChannelIsFull:h1e,Error472UnknownMode:f1e,Error473InviteOnlyChan:d1e,Error474BannedFromChan:p1e,Error475BadChannelKey:m1e,Error479BadChanName:g1e,Error481NoPrivileges:v1e,Error482ChanOpPrivsNeeded:_1e,Error491NoOperHost:y1e,Error501UmodeUnknownFlag:b1e,Error502UsersDontMatch:E1e,Reply001Welcome:WK,Reply002YourHost:bTe,Reply003Created:ETe,Reply004ServerInfo:YK,Reply005Isupport:XK,Reply221UmodeIs:STe,Reply301Away:TTe,Reply302UserHost:xTe,Reply305UnAway:wTe,Reply306NowAway:CTe,Reply311WhoisUser:ATe,Reply315EndOfWho:RTe,Reply318EndOfWhois:MTe,Reply319WhoisChannels:OTe,Reply322List:NTe,Reply323ListEnd:ITe,Reply324ChannelModeIs:kTe,Reply331NoTopic:DTe,Reply332Topic:PTe,Reply333TopicWhoTime:LTe,Reply341Inviting:UTe,Reply348ExceptList:BTe,Reply349EndOfExceptList:FTe,Reply352WhoReply:zTe,Reply353NamesReply:HTe,Reply366EndOfNames:jTe,Reply367BanList:VTe,Reply368EndOfBanList:GTe,Reply372Motd:qTe,Reply375MotdStart:$Te,Reply376EndOfMotd:KK,Reply381YoureOper:WTe,Reply391Time:YTe},Symbol.toStringTag,{value:"Module"})),X1t=new Map([...Object.values(yTe),...Object.values(S1e)].map(t=>[t.COMMAND,t]));function K1t(t){const[e,n]=OT(t,"!",2);if(n){const[i,r]=OT(n,"@",2);return r?{nick:e,user:i,host:r}:{nick:e,host:i}}return{nick:e}}const Jae={":":";",n:`
`,r:"\r",s:" "};function Z1t(t){const e=new Map,n=t.split(";");for(const i of n){const[r,s]=OT(i,"=",2);r!==""&&e.set(r,s?s.replace(/\\(.?)/g,(a,o)=>Object.prototype.hasOwnProperty.call(Jae,o)?Jae[o]:o):"")}return e}function J1t(t,e=mC,n=X1t,i=!1,r=[],s=!0){const a=t.split(" ");let o,c;const l=[];let u,h;for(;a.length;){if([o]=a,o.startsWith("@")&&!u&&!c&&!h)u=Z1t(o.slice(1));else if(o.startsWith(":"))if(!h&&!c)o.length>1&&(h=K1t(o.slice(1)));else{l.push({value:a.join(" ").slice(1),trailing:!0});break}else c?l.push({value:o,trailing:!1}):c=o.toUpperCase();a.shift()}if(u||(u=new Map),!c)throw new Error(`line without command received: ${t}`);s&&(s=!r.includes(c));let f=zt;return n.has(c)&&(f=n.get(c)),new f(c,{params:l,tags:u,prefix:h,rawLine:t},{serverProperties:e,isServer:i,shouldParseParams:s})}class T1e extends Bk{constructor(e){super(),this._registered=!1,this._supportsCapabilities=!0,this._events=new Map,this._registeredMessageTypes=new Map,this.onConnect=this.registerEvent(),this.onRegister=this.registerEvent(),this.onDisconnect=this.registerEvent(),this.onPrivmsg=this.registerEvent(),this.onAction=this.registerEvent(),this.onNotice=this.registerEvent(),this.onNickChange=this.registerEvent(),this.onCtcp=this.registerEvent(),this.onCtcpReply=this.registerEvent(),this.onPasswordError=this.registerEvent(),this.onAnyMessage=this.registerEvent(),this._serverProperties=iO(mC),this._supportedFeatures={},this._collectors=[],this._clientCapabilities=new Map,this._serverCapabilities=new Map,this._negotiatedCapabilities=new Map,this._currentChannels=new Set,this._hasRegisteredBefore=!1,this._channelsFromLastRegister=new Set,this._initialConnectionSetupDone=!1;const{connection:n,credentials:i,channels:r,channelTypes:s,webSocket:a,logger:o={}}=e;this._options=e;const{pingOnInactivity:c=60,pingTimeout:l=10}=n;this._pingOnInactivity=c,this._pingTimeout=l,this._currentNick=i.nick,this._logger=b8({name:"ircv3",emoji:!0,...o}),this.registerCoreMessageTypes();const{hostName:u,secure:h,reconnect:f=!0}=n,d={hostName:u,port:this.port,secure:h},p={lineBased:!0,logger:this._logger,additionalOptions:e.connectionOptions},g=a?I1t:O1t;f?this._connection=new N1t(g,d,p):this._connection=new g(p,this._logger,e.connectionOptions);for(const y of Object.values(W1t))this.addCapability(y);this.addInternalListener(this.onRegister,async()=>{const y=this._hasRegisteredBefore,v=this._channelsFromLastRegister;this._hasRegisteredBefore=!0,this._channelsFromLastRegister=new Set;const b=y&&this._options.rejoinChannelsOnReconnect?v:await k$(r);if(b)for(const T of b)this.join(T)}),this.onTypedMessage(Yd,async({subCommand:y,capabilities:v})=>{const b=v.split(" ");switch(y.toUpperCase()){case"NEW":{this._logger.debug(`Server registered new capabilities: ${b.join(", ")}`);const T=qP(b,M=>{if(!M)return{};const[R,I]=OT(M,"=",2);return{[R]:{name:R,param:I||!0}}});for(const[M,R]of Object.entries(T))this._serverCapabilities.set(M,R);const x=Object.keys(T);await this._negotiateCapabilities(Array.from(this._clientCapabilities.entries()).filter(([M])=>x.includes(M)).map(([,M])=>M));break}case"DEL":{this._logger.debug(`Server removed capabilities: ${b.join(", ")}`);for(const T of b)this._serverCapabilities.delete(T),this._negotiatedCapabilities.delete(T)}}}),this.onTypedMessage(sB,({text:y})=>{this.sendMessage(aB,{text:y})}),this.onTypedMessage(WK,({me:y})=>this._handleReceivedClientNick(y)),this.onTypedMessage(YK,({userModes:y})=>{y&&(this._serverProperties.supportedUserModes=y)}),this.onTypedMessage(XK,({supports:y})=>{const v=qP(y.split(" "),b=>{const[T,x]=OT(b,"=",2);return{[T]:x||!0}});this._supportedFeatures={...this._supportedFeatures,...v}}),this.onTypedMessage(KK,({me:y})=>{this._registered||(this._handleReceivedClientNick(y),this._registered=!0,this.emit(this.onRegister))}),this.onTypedMessage(ZK,({me:y})=>{this._registered||(this._handleReceivedClientNick(y),this._registered=!0,this.emit(this.onRegister))}),this.onTypedMessage(JK,({me:y})=>{this._registered||(this._logger.warn("We thought we're not registered yet, but we actually are"),this._handleReceivedClientNick(y),this._registered=!0,this.emit(this.onRegister))}),this.onTypedMessage(KN,y=>{var v;const{target:b,text:T}=y,x=Zae(T),M=(v=y.prefix)===null||v===void 0?void 0:v.nick;x?x.command==="ACTION"?this.emit(this.onAction,b,M,x.params,y):this.emit(this.onCtcp,b,M,x.command,x.params,y):this.emit(this.onPrivmsg,b,M,T,y)}),this.onTypedMessage(rO,y=>{var v;const{nick:b}=y,T=(v=y.prefix)===null||v===void 0?void 0:v.nick;T===this._currentNick&&(this._currentNick=b),this.emit(this.onNickChange,T,b,y)}),this.onTypedMessage(S8,y=>{var v;const{target:b,text:T}=y,x=Zae(T),M=(v=y.prefix)===null||v===void 0?void 0:v.nick;x&&this.emit(this.onCtcpReply,b,M,x.command,x.params,y),this.emit(this.onNotice,b,M,T,y)}),this._options.manuallyAcknowledgeJoins||this.onTypedMessage(YN,({channel:y,prefix:v})=>{(v==null?void 0:v.nick)===this._currentNick&&this.acknowledgeJoin(y)}),this.onTypedMessage(XN,y=>{var v;((v=y.prefix)===null||v===void 0?void 0:v.nick)===this._currentNick&&(this._currentChannels.delete(y.channel),this._channelsFromLastRegister.delete(y.channel))}),this.addInternalListener(this.onRegister,()=>this._startPingCheckTimer()),this._desiredNick=i.nick,this._userName=i.userName,this._realName=i.realName,s&&(this._serverProperties.channelTypes=s)}receiveLine(e){var n;this._logger.debug(`Received message: ${e}`);let i;try{i=J1t(e,this._serverProperties,this._registeredMessageTypes,!0,this._options.nonConformingCommands)}catch(r){this._logger.error(`Error parsing message: ${r.message}`),this._logger.trace((n=r.stack)!==null&&n!==void 0?n:"No stack available");return}this._logger.trace(`Parsed message: ${JSON.stringify(i)}`),this._startPingCheckTimer(),this.emit(this.onAnyMessage,i),this._handleEvents(i)}get serverProperties(){return iO(this._serverProperties)}get port(){const{webSocket:e,connection:{port:n,secure:i}}=this._options;return n||(e?i?443:80:i?6697:6667)}pingCheck(){const e=Date.now(),n=e.toString(),i=this.onTypedMessage(aB,r=>{const{text:s}=r;s===n&&(this._logger.debug(`Current ping: ${Date.now()-e}ms`),this._pingTimeoutTimer&&clearTimeout(this._pingTimeoutTimer),this.removeMessageListener(i))});this._pingTimeoutTimer=setTimeout(()=>{this.removeMessageListener(i),this._options.connection.reconnect===!1?this._logger.error(`Disconnecting because the last ping took over ${this._pingTimeout} seconds`):this._logger.warn(`Reconnecting because the last ping took over ${this._pingTimeout} seconds`),this._connection.assumeExternalDisconnect()},this._pingTimeout*1e3),this.sendMessage(sB,{text:n})}reconnect(e){this.quit(e),this.connect()}registerMessageType(e){e.COMMAND!==""&&(this._logger.trace(`Registering message type ${e.COMMAND}`),this._registeredMessageTypes.set(e.COMMAND.toUpperCase(),e))}knowsCommand(e){return this._registeredMessageTypes.has(e.toUpperCase())}getCommandClass(e){return this._registeredMessageTypes.get(e.toUpperCase())}acknowledgeJoin(e){this._currentChannels.add(e),this._channelsFromLastRegister.add(e)}connect(){this._supportsCapabilities=!1,this._negotiatedCapabilities=new Map,this._currentChannels=new Set,this._currentNick=this._desiredNick,this._setupConnection(),this._logger.info(`Connecting to ${this._options.connection.hostName}:${this.port}`),this._connection.connect()}addCapability(e){if(this._clientCapabilities.set(e.name,e),e.messageTypes)for(const n of Object.values(e.messageTypes))this.registerMessageType(n)}async registerCapability(e){return this.addCapability(e),this._serverCapabilities.has(e.name)?await this._negotiateCapabilities([e]):[]}send(e){this.sendRaw(e.toString())}sendRaw(e){this._connection.isConnected&&(this._logger.debug(`Sending message: ${e}`),this._connection.sendLine(e))}onNamedMessage(e,n,i){this._events.has(e)||this._events.set(e,new Map);const r=this._events.get(e);if(!i)do i=`${e}:${OTt(Math.random()*1e4,4,"0")}`;while(r.has(i));return r.set(i,n),i}onTypedMessage(e,n,i){return this.onNamedMessage(e.COMMAND,n,i)}removeMessageListener(e){const[n]=e.split(":");this._events.has(n)&&this._events.get(n).delete(e)}createMessage(e,n,i){const r=i?new Map(Object.entries(i)):void 0;return F1t(e,n,void 0,r,this.serverProperties)}sendMessage(e,n,i){this.send(this.createMessage(e,n,i))}async sendMessageAndCaptureReply(e,n){if(!e.SUPPORTS_CAPTURE)throw new Error(`The command "${e.COMMAND}" does not support reply capture`);const i=this.createMessage(e,n),r=this.collect(i).promise();return this.send(i),await r}get isConnected(){return this._connection.isConnected}get isConnecting(){return this._connection.isConnecting}get isRegistered(){return this._registered}get currentNick(){return this._currentNick}get currentChannels(){return Array.from(this._currentChannels)}collect(e,...n){const i=new Y1t(this,e,...n);return this._collectors.push(i),i}stopCollect(e){this._collectors.splice(this._collectors.findIndex(n=>n===e),1)}join(e,n){this.sendMessage(YN,{channel:e,key:n})}part(e){this.sendMessage(XN,{channel:e})}quit(e){this.sendMessage($K,{text:e}),this.quitAbruptly()}quitAbruptly(){this._registered=!1,this._connection.disconnect()}say(e,n,i={}){this.sendMessage(KN,{target:e,text:n},i)}sendCtcp(e,n,i){this.say(e,`${n.toUpperCase()} ${i}`)}action(e,n){this.sendCtcp(e,"ACTION",n)}changeNick(e){this._currentNick!==e&&(this._desiredNick=e,this.isRegistered&&this.sendMessage(rO,{nick:e}))}registerCoreMessageTypes(){D$(yTe,e=>{this.registerMessageType(e)}),D$(S1e,e=>{this.registerMessageType(e)})}async _negotiateCapabilityBatch(e){return await Promise.all(e.filter(n=>n.length).map(async n=>await this._negotiateCapabilities(n)))}async _negotiateCapabilities(e){const n=qP(e,a=>({[a.name]:a})),r=(await this.sendMessageAndCaptureReply(Yd,{subCommand:"REQ",capabilities:e.map(a=>a.name).join(" ")})).shift();if(!r)throw new Error("capability negotiation failed unexpectedly without any reply");if(!(r instanceof Yd))throw new Error(`capability negotiation failed unexpectedly with "${r.command}" command`);const s=r.capabilities.split(" ").filter(a=>a);if(r.subCommand==="ACK"){this._logger.debug(`Successfully negotiated capabilities: ${s.join(", ")}`);const a=s.map(o=>n[o]);for(const o of a){const c=this._clientCapabilities.get(o.name);c.param=o.param,this._negotiatedCapabilities.set(c.name,c)}return a}return this._logger.warn(`Failed to negotiate capabilities: ${s.join(", ")}`),new Error("capabilities failed to negotiate")}_setupConnection(){this._initialConnectionSetupDone||(this._connection.onConnect(async()=>{var e,n;this._logger.info(`Connection to server ${this._options.connection.hostName}:${this.port} established`),this.emit(this.onConnect),this._logger.debug("Determining connection password");try{const[i]=await Promise.all([k$(this._options.credentials.password),this.sendMessageAndCaptureReply(Yd,{subCommand:"LS",version:"302"}).then(async r=>{if(!r.length||!(r[0]instanceof Yd))return this._logger.debug("Server does not support capabilities"),[];this._supportsCapabilities=!0;const s=r.map(o=>qP(o.capabilities.split(" "),c=>{if(!c)return{};const[l,u]=OT(c,"=",2);return{[l]:{name:l,param:u||!0}}}));this._serverCapabilities=new Map(Object.entries(Object.assign({},...s))),this._logger.debug(`Capabilities supported by server: ${Array.from(this._serverCapabilities.keys()).join(", ")}`);const a=s.map(o=>{const c=Object.keys(o);return Array.from(this._clientCapabilities.entries()).filter(([l])=>c.includes(l)).map(([,l])=>l)});return await this._negotiateCapabilityBatch(a)}).then(()=>{this.sendMessage(Yd,{subCommand:"END"})})]);i&&this.sendMessage(GK,{password:i}),this.sendMessage(rO,{nick:this._desiredNick}),this.sendMessage(qK,{user:(e=this._userName)!==null&&e!==void 0?e:this._desiredNick,mode:"8",unused:"*",realName:(n=this._realName)!==null&&n!==void 0?n:this._desiredNick})}catch(i){this.emit(this.onPasswordError,i),this.quit()}}),this._initialConnectionSetupDone=!0,this._connection.onReceive(e=>{this.receiveLine(e)}),this._connection.onDisconnect((e,n)=>{var i;if(this._registered=!1,this._pingCheckTimer&&clearTimeout(this._pingCheckTimer),this._pingTimeoutTimer&&clearTimeout(this._pingTimeoutTimer),e)this._logger.info("Disconnected");else{const r=(i=this._options.connection.reconnect)!==null&&i!==void 0?i:!0,s=n?`Disconnected unexpectedly: ${n.message}`:"Disconnected unexpectedly";r?this._logger.warn(`${s}; trying to reconnect`):this._logger.error(s)}this.emit(this.onDisconnect,e,n)}),this._connection.onEnd(e=>{e||this._logger.warn("No further retries will be made")}))}_handleReceivedClientNick(e){this._currentNick!==e&&(this._currentNick!==""&&this._logger.warn(`Mismatching nicks: passed ${this._currentNick}, but you're actually ${e}`),this._currentNick=e)}_handleEvents(e){this._collectors.some(i=>i.collect(e));const n=this._events.get(e.constructor.COMMAND);if(n)for(const i of n.values())i(e)}_startPingCheckTimer(){this._pingCheckTimer&&clearTimeout(this._pingCheckTimer),this._connection.isConnected?this._pingCheckTimer=setTimeout(()=>this.pingCheck(),this._pingOnInactivity*1e3):this._pingCheckTimer=void 0}}ca([IE(!1)],T1e.prototype,"_options",void 0);class QK extends zt{constructor(e,n,i){super(e,n,i,{channel:{type:"channel"},user:{trailing:!0,optional:!0}})}get date(){const e=this._tags.get("tmi-sent-ts");return new Date(Number(e))}get channelId(){return this._tags.get("room-id")}get targetUserId(){var e;return(e=this._tags.get("target-user-id"))!==null&&e!==void 0?e:null}}QK.COMMAND="CLEARCHAT";class x1e extends zt{}x1e.COMMAND="RECONNECT";class eZ extends zt{constructor(e,n,i){super(e,n,i,{channel:{type:"channel"}})}}eZ.COMMAND="ROOMSTATE";function Q1t(t){switch(typeof t){case"undefined":return"";case"object":{if(t===null)return"";if("cacheKey"in t)return t.cacheKey;const e=JSON.stringify(t);if(e!=="{}")return e}default:return t.toString()}}function w1e(t,e,n){return[t,...e.map(Q1t)].join("/")+(n?"/":"")}const Uv=Symbol("cache");function ext(t){var e,n;return n=class extends t{constructor(){super(...arguments),this[e]=new Map}getFromCache(i){if(this._cleanCache(),this[Uv].has(i)){const r=this[Uv].get(i);if(r)return r.value}}setCache(i,r,s){this[Uv].set(i,{value:r,expires:Date.now()+s*1e3})}removeFromCache(i,r){const s=this._getInternalCacheKey(i,r);r?this[Uv].forEach((a,o)=>{o.startsWith(s)&&this[Uv].delete(o)}):this[Uv].delete(s)}_cleanCache(){const i=Date.now();this[Uv].forEach((r,s)=>{r.expires<i&&this[Uv].delete(s)})}_getInternalCacheKey(i,r){if(typeof i=="string"){let s=i;return s.endsWith("/")||(s+="/"),s}else{const s=i.shift();return w1e(s,i,r)}}},e=Uv,n}function C1e(t=1/0){return function(e,n,i){if(i.get){const r=i.get;i.get=function(){const s=w1e(n,[]),a=this.getFromCache(s);if(a)return a;const o=r.call(this);return this.setCache(s,o,t),o}}return i}}var nL;let cE=nL=class{constructor(e,n){this._userName=e.toLowerCase(),this._userData=n?new Map(n):new Map}static _parseBadgesLike(e){return e?new Map(e.split(",").map(n=>{const i=n.indexOf("/");return i===-1?[n,""]:[n.slice(0,i),n.slice(i+1)]})):new Map}get userName(){return this._userName}get displayName(){var e;return(e=this._userData.get("display-name"))!==null&&e!==void 0?e:this._userName}get color(){return this._userData.get("color")}get badges(){const e=this._userData.get("badges");return nL._parseBadgesLike(e)}get badgeInfo(){const e=this._userData.get("badge-info");return nL._parseBadgesLike(e)}get userId(){return this._userData.get("user-id")}get userType(){return this._userData.get("user-type")}get isBroadcaster(){return this.badges.has("broadcaster")}get isSubscriber(){return this.badges.has("subscriber")||this.isFounder}get isFounder(){return this.badges.has("founder")}get isMod(){return this.badges.has("moderator")}get isVip(){const e=this._userData.get("vip");return e!=null&&e!=="0"}get isArtist(){return this.badges.has("artist-badge")}};ca([IE(!1)],cE.prototype,"_userData",void 0);ca([C1e()],cE.prototype,"badges",null);ca([C1e()],cE.prototype,"badgeInfo",null);cE=nL=ca([ext,Fk("chat","ChatUser","userId")],cE);function tZ(t){return t?new Map(t.split("/").map(e=>{const[n,i]=e.split(":",2);return i?[n,i.split(",")]:null}).filter(e=>e!==null)):new Map}class nZ extends zt{constructor(e,n,i){super(e,n,i,{channel:{type:"channel"},text:{trailing:!0,optional:!0}})}get id(){return this._tags.get("id")}get date(){const e=this._tags.get("tmi-sent-ts");return new Date(Number(e))}get userInfo(){return new cE(this._tags.get("login"),this._tags)}get channelId(){var e;return(e=this._tags.get("room-id"))!==null&&e!==void 0?e:null}get emoteOffsets(){return tZ(this._tags.get("emotes"))}}nZ.COMMAND="USERNOTICE";class A1e extends zt{constructor(e,n,i){super(e,n,i,{channel:{type:"channel"}})}}A1e.COMMAND="USERSTATE";class iZ extends zt{constructor(e,n,i){super(e,n,i,{target:{},text:{trailing:!0}})}get userInfo(){return new cE(this._prefix.nick,this._tags)}get emoteOffsets(){return tZ(this._tags.get("emotes"))}}iZ.COMMAND="WHISPER";const txt={name:"twitch.tv/commands",messageTypes:[QK,x1e,eZ,nZ,A1e,iZ]},nxt={name:"twitch.tv/membership"};class rZ extends zt{constructor(e,n,i){super(e,n,i,{channel:{type:"channel"},text:{trailing:!0}})}get date(){const e=this._tags.get("tmi-sent-ts");return new Date(Number(e))}get userName(){return this._tags.get("login")}get channelId(){return this._tags.get("room-id")}get targetMessageId(){return this._tags.get("target-msg-id")}}rZ.COMMAND="CLEARMSG";class R1e extends zt{}R1e.COMMAND="GLOBALUSERSTATE";const ixt={name:"twitch.tv/tags",messageTypes:[R1e,rZ]},rxt=["ONE","TWO","THREE","FOUR","FIVE","SIX","SEVEN","EIGHT","NINE","TEN"];let oB=class extends KN{get id(){return this._tags.get("id")}get date(){const e=this._tags.get("tmi-sent-ts");return new Date(Number(e))}get userInfo(){return new cE(this._prefix.nick,this._tags)}get channelId(){var e;return(e=this._tags.get("room-id"))!==null&&e!==void 0?e:null}get isCheer(){return this._tags.has("bits")}get isRedemption(){return!!this._tags.get("custom-reward-id")}get rewardId(){return this._tags.get("custom-reward-id")||null}get isFirst(){return this._tags.get("first-msg")==="1"}get isReturningChatter(){return this._tags.get("returning-chatter")==="1"}get isHighlight(){return this._tags.get("msg-id")==="highlighted-message"}get isReply(){return this._tags.has("reply-parent-msg-id")}get parentMessageId(){var e;return(e=this._tags.get("reply-parent-msg-id"))!==null&&e!==void 0?e:null}get parentMessageText(){var e;return(e=this._tags.get("reply-parent-msg-body"))!==null&&e!==void 0?e:null}get parentMessageUserId(){var e;return(e=this._tags.get("reply-parent-user-id"))!==null&&e!==void 0?e:null}get parentMessageUserName(){var e;return(e=this._tags.get("reply-parent-user-login"))!==null&&e!==void 0?e:null}get parentMessageUserDisplayName(){var e;return(e=this._tags.get("reply-parent-display-name"))!==null&&e!==void 0?e:null}get threadMessageId(){var e;return(e=this._tags.get("reply-thread-parent-msg-id"))!==null&&e!==void 0?e:null}get threadMessageUserId(){var e;return(e=this._tags.get("reply-thread-parent-user-id"))!==null&&e!==void 0?e:null}get bits(){var e;return Number((e=this._tags.get("bits"))!==null&&e!==void 0?e:0)}get emoteOffsets(){return tZ(this._tags.get("emotes"))}get isHypeChat(){return this._tags.has("pinned-chat-paid-amount")}get hypeChatAmount(){return $N(this._tags.get("pinned-chat-paid-amount"),Number)}get hypeChatDecimalPlaces(){return $N(this._tags.get("pinned-chat-paid-exponent"),Number)}get hypeChatLocalizedAmount(){const e=this.hypeChatAmount;return e?e/10**this.hypeChatDecimalPlaces:null}get hypeChatCurrency(){var e;return(e=this._tags.get("pinned-chat-paid-currency"))!==null&&e!==void 0?e:null}get hypeChatLevel(){const e=this._tags.get("pinned-chat-paid-level");return e?rxt.indexOf(e)+1:null}get hypeChatIsSystemMessage(){const e=this._tags.get("pinned-chat-paid-is-system-message");return e?!!Number(e):null}};oB=ca([Fk("chat","ChatMessage","id")],oB);function sxt(t){return t instanceof oB?t.tags.get("id"):t}function Qae(t,e){if(t.length<=e)return[t];t=t.trim();const n=[];let i=0,r=e;for(;i<t.length;){let s=t.lastIndexOf(" ",r);(s===-1||s<=i||t.length-i+1<=e)&&(s=i+e);const a=t.slice(i,s).trim();a.length&&n.push(a),i=s+(t[s]===" "?1:0),r=i+e}return n}const axt=/^[a-z0-9][a-z0-9_]{0,24}$/;function Ac(t){const e=t.replace(/^#/,"").toLowerCase();if(!axt.test(e))throw new Error(`"${e}" is not a valid user or channel name. It must be at most 25 characters long, can only include letters, numbers and underscores, and can not start with an underscore.`);return e}function $P(t){return`#${Ac(t)}`}var H$;let cB=H$=class extends Bk{constructor(e={}){var n,i,r,s,a;if(e.authProvider&&!e.authProvider.getAccessTokenForIntent)throw new eL("You can not connect to chat using an AuthProvider that does not support intents.\nTo get an anonymous, read-only connection, please don't pass an `AuthProvider` at all.\nTo get a read-write connection, please provide an auth provider that provides user access tokens via intents, such as `RefreshingAuthProvider`.");super(),this._authVerified=!1,this._authRetryCount=0,this.onConnect=this.registerEvent(),this.onDisconnect=this.registerEvent(),this.onTimeout=this.registerEvent(),this.onBan=this.registerEvent(),this.onBitsBadgeUpgrade=this.registerEvent(),this.onChatClear=this.registerEvent(),this.onEmoteOnly=this.registerEvent(),this.onFollowersOnly=this.registerEvent(),this.onJoin=this.registerEvent(),this.onJoinFailure=this.registerEvent(),this.onPart=this.registerEvent(),this.onMessageRemove=this.registerEvent(),this.onUniqueChat=this.registerEvent(),this.onRaid=this.registerEvent(),this.onRaidCancel=this.registerEvent(),this.onRitual=this.registerEvent(),this.onSlow=this.registerEvent(),this.onSubsOnly=this.registerEvent(),this.onSub=this.registerEvent(),this.onResub=this.registerEvent(),this.onSubGift=this.registerEvent(),this.onCommunitySub=this.registerEvent(),this.onSubExtend=this.registerEvent(),this.onRewardGift=this.registerEvent(),this.onPrimePaidUpgrade=this.registerEvent(),this.onGiftPaidUpgrade=this.registerEvent(),this.onPrimeCommunityGift=this.registerEvent(),this.onStandardPayForward=this.registerEvent(),this.onCommunityPayForward=this.registerEvent(),this.onAnnouncement=this.registerEvent(),this.onWhisper=this.registerEvent(),this.onNoPermission=this.registerEvent(),this.onMessageRatelimit=this.registerEvent(),this.onAuthenticationSuccess=this.registerEvent(),this.onAuthenticationFailure=this.registerEvent(),this.onTokenFetchFailure=this.registerEvent(),this.onMessageFailed=this.registerEvent(),this.onMessage=this.registerEvent(),this.onAction=this.registerEvent(),this._onJoinResult=this.registerInternalEvent(),this._ircClient=new T1e({connection:{hostName:(n=e.hostName)!==null&&n!==void 0?n:!((i=e.webSocket)!==null&&i!==void 0)||i?"irc-ws.chat.twitch.tv":"irc.chat.twitch.tv",secure:(r=e.ssl)!==null&&r!==void 0?r:!0},credentials:{nick:"",password:async()=>await this._getAuthToken()},webSocket:(s=e.webSocket)!==null&&s!==void 0?s:!0,connectionOptions:e.connectionOptions,logger:{name:"twurple:chat:irc",...e.logger},nonConformingCommands:["004"],manuallyAcknowledgeJoins:!0,rejoinChannelsOnReconnect:e.rejoinChannelsOnReconnect}),this._ircClient.onDisconnect((l,u)=>{this._messageRateLimiter.clear(),this._messageRateLimiter.pause(),this._joinRateLimiter.clear(),this._joinRateLimiter.pause(),this.emit(this.onDisconnect,l,u)}),this._ircClient.registerMessageType(oB),this._chatLogger=b8({name:"twurple:chat:twitch",...e.logger}),this._authProvider=e.authProvider,this._useLegacyScopes=!!e.legacyScopes,this._readOnly=!!e.readOnly,this._authIntents=[...(a=e.authIntents)!==null&&a!==void 0?a:[],"chat"];const o=async({type:l,text:u,channel:h,tags:f})=>{l==="say"?this._ircClient.say(h,u,f):this._ircClient.action(h,u)},c=async l=>{const{promise:u,resolve:h,reject:f}=P$();let d;const p=this.addInternalListener(this._onJoinResult,(g,y,v)=>{g===l&&(clearTimeout(d),v?f(v):h(),this.removeListener(p))});d=setTimeout(()=>{this.removeListener(p),this.emit(this._onJoinResult,l,void 0,"twurple_timeout"),f(new Error(`Did not receive a reply to join ${l} in time; assuming that the join failed`))},1e4),this._ircClient.join(l),await u};if(e.isAlwaysMod)this._messageRateLimiter=new L$({bucketSize:e.botLevel==="verified"?7500:100,timeFrame:32e3,doRequest:o});else{let l=20;e.botLevel==="verified"?l=7500:e.botLevel==="known"&&(l=50),this._messageRateLimiter=new jTt(new HTt({bucketSize:1,timeFrame:1200,logger:{minLevel:pi.ERROR},doRequest:o,getPartitionKey:({channel:u})=>u}),{bucketSize:l,timeFrame:32e3})}this._joinRateLimiter=new L$({bucketSize:e.botLevel==="verified"?2e3:20,timeFrame:11e3,doRequest:c}),this._messageRateLimiter.pause(),this._joinRateLimiter.pause(),this._ircClient.addCapability(ixt),this._ircClient.addCapability(txt),e.requestMembershipEvents&&this._ircClient.addCapability(nxt),this._ircClient.onConnect(()=>{this.emit(this.onConnect)}),this._ircClient.onRegister(async()=>{this._messageRateLimiter.resume(),this._joinRateLimiter.resume(),this._authVerified=!0,this._authRetryTimer=void 0,this._authRetryCount=0,this.emit(this.onAuthenticationSuccess);const l=await k$(e.channels);l&&await Promise.all(l.map(async u=>{var h;try{await this.join(u)}catch(f){this._chatLogger.warn(`Failed to join configured channel ${u}; original message: ${(h=f==null?void 0:f.message)!==null&&h!==void 0?h:f}`)}}))}),this._ircClient.onPasswordError(l=>{this._chatLogger.error(`Error fetching a token for connecting to the server: ${l.message}`),this.emit(this.onTokenFetchFailure,l)}),this._ircClient.onPrivmsg((l,u,h,f)=>{u!=="jtv"&&this.emit(this.onMessage,Ac(l),u,h,f)}),this._ircClient.onAction((l,u,h,f)=>{this.emit(this.onAction,Ac(l),u,h,f)}),this.addInternalListener(this._onJoinResult,(l,u,h)=>{h?this.emit(this.onJoinFailure,Ac(l),h):this._ircClient.acknowledgeJoin(l)}),this._ircClient.onTypedMessage(QK,l=>{const{channel:u,user:h,tags:f}=l,d=Ac(u);if(h){const p=f.get("ban-duration");p===void 0?this.emit(this.onBan,d,h,l):this.emit(this.onTimeout,d,h,Number(p),l)}else this.emit(this.onChatClear,d,l)}),this._ircClient.onTypedMessage(rZ,l=>{const{channel:u,targetMessageId:h}=l;this.emit(this.onMessageRemove,Ac(u),h,l)}),this._ircClient.onTypedMessage(YN,({prefix:l,channel:u})=>{this.emit(this.onJoin,Ac(u),l.nick)}),this._ircClient.onTypedMessage(XN,({prefix:l,channel:u})=>{this.emit(this.onPart,Ac(u),l.nick)}),this._ircClient.onTypedMessage(eZ,({channel:l,tags:u})=>{let h=!1;if(u.has("subs-only")&&u.has("slow")&&(this.emit(this._onJoinResult,l,u),h=!0),!h){const f=Ac(l);if(u.has("slow")){const d=Number(u.get("slow"));d?this.emit(this.onSlow,f,!0,d):this.emit(this.onSlow,f,!1)}if(u.has("followers-only")){const d=Number(u.get("followers-only"));d===-1?this.emit(this.onFollowersOnly,f,!1):this.emit(this.onFollowersOnly,f,!0,d)}}}),this._ircClient.onTypedMessage(nZ,l=>{const{channel:u,text:h,tags:f}=l,d=f.get("msg-id"),p=Ac(u);switch(d){case"sub":case"resub":{const g=d==="sub"?this.onSub:this.onResub,y=f.get("msg-param-sub-plan"),v=f.get("msg-param-streak-months"),b={userId:f.get("user-id"),displayName:f.get("display-name"),plan:y,planName:f.get("msg-param-sub-plan-name"),isPrime:y==="Prime",months:Number(f.get("msg-param-cumulative-months")),streak:v?Number(v):void 0,message:h};if(f.get("msg-param-was-gifted")==="true"){const x=f.get("msg-param-anon-gift")==="true",M=Number(f.get("msg-param-gift-months")),R=Number(f.get("msg-param-gift-month-being-redeemed"));x?b.originalGiftInfo={anonymous:!0,duration:M,redeemedMonth:R}:b.originalGiftInfo={anonymous:!1,duration:M,redeemedMonth:R,userId:f.get("msg-param-gifter-id"),userName:f.get("msg-param-gifter-login"),userDisplayName:f.get("msg-param-gifter-name")}}this.emit(g,p,f.get("login"),b,l);break}case"subgift":{const g=f.get("msg-param-sub-plan"),y=f.get("login"),v=y==="ananonymousgifter",b={userId:f.get("msg-param-recipient-id"),displayName:f.get("msg-param-recipient-display-name"),gifter:v?void 0:y,gifterUserId:v?void 0:f.get("user-id"),gifterDisplayName:v?void 0:f.get("display-name"),gifterGiftCount:v?void 0:Number(f.get("msg-param-sender-count")),giftDuration:Number(f.get("msg-param-gift-months")),plan:g,planName:f.get("msg-param-sub-plan-name"),isPrime:g==="Prime",months:Number(f.get("msg-param-months"))};this.emit(this.onSubGift,p,f.get("msg-param-recipient-user-name"),b,l);break}case"submysterygift":{const g=f.get("login"),y=g==="ananonymousgifter",v={gifter:y?void 0:g,gifterUserId:y?void 0:f.get("user-id"),gifterDisplayName:y?void 0:f.get("display-name"),gifterGiftCount:y?void 0:Number(f.get("msg-param-sender-count")),count:Number(f.get("msg-param-mass-gift-count")),plan:f.get("msg-param-sub-plan")};this.emit(this.onCommunitySub,p,f.get("login"),v,l);break}case"primepaidupgrade":{const g={userId:f.get("user-id"),displayName:f.get("display-name"),plan:f.get("msg-param-sub-plan")};this.emit(this.onPrimePaidUpgrade,p,f.get("login"),g,l);break}case"giftpaidupgrade":{const g={userId:f.get("user-id"),displayName:f.get("display-name"),gifter:f.get("msg-param-sender-login"),gifterDisplayName:f.get("msg-param-sender-name")};this.emit(this.onGiftPaidUpgrade,p,f.get("login"),g,l);break}case"standardpayforward":{const g=f.get("msg-param-prior-gifter-anonymous")==="true",y={userId:f.get("user-id"),displayName:f.get("display-name"),originalGifterUserId:g?void 0:f.get("msg-param-prior-gifter-id"),originalGifterDisplayName:g?void 0:f.get("msg-param-prior-gifter-display-name"),recipientUserId:f.get("msg-param-recipient-id"),recipientDisplayName:f.get("msg-param-recipient-display-name")};this.emit(this.onStandardPayForward,p,f.get("login"),y,l);break}case"communitypayforward":{const g=f.get("msg-param-prior-gifter-anonymous")==="true",y={userId:f.get("user-id"),displayName:f.get("display-name"),originalGifterUserId:g?void 0:f.get("msg-param-prior-gifter-id"),originalGifterDisplayName:g?void 0:f.get("msg-param-prior-gifter-display-name")};this.emit(this.onCommunityPayForward,p,f.get("login"),y,l);break}case"primecommunitygiftreceived":{const g={name:f.get("msg-param-gift-name"),gifter:f.get("login"),gifterDisplayName:f.get("display-name")};this.emit(this.onPrimeCommunityGift,p,f.get("msg-param-recipient"),g,l);break}case"raid":{const g={displayName:f.get("msg-param-displayName"),viewerCount:Number(f.get("msg-param-viewerCount"))};this.emit(this.onRaid,p,f.get("login"),g,l);break}case"unraid":{this.emit(this.onRaidCancel,p,l);break}case"ritual":{const g={ritualName:f.get("msg-param-ritual-name"),message:h};this.emit(this.onRitual,p,f.get("login"),g,l);break}case"bitsbadgetier":{const g={displayName:f.get("display-name"),threshold:Number(f.get("msg-param-threshold"))};this.emit(this.onBitsBadgeUpgrade,p,f.get("login"),g,l);break}case"extendsub":{const g={userId:f.get("user-id"),displayName:f.get("display-name"),plan:f.get("msg-param-sub-plan"),months:Number(f.get("msg-param-cumulative-months")),endMonth:Number(f.get("msg-param-sub-benefit-end-month"))};this.emit(this.onSubExtend,p,f.get("login"),g,l);break}case"rewardgift":{const g={domain:f.get("msg-param-domain"),gifterId:f.get("user-id"),gifterDisplayName:f.get("display-name"),count:Number(f.get("msg-param-selected-count")),gifterGiftCount:Number(f.get("msg-param-total-reward-count")),triggerType:f.get("msg-param-trigger-type")};this.emit(this.onRewardGift,p,f.get("login"),g,l);break}case"announcement":{const g={color:f.get("msg-param-color")};this.emit(this.onAnnouncement,p,f.get("login"),g,l);break}default:this._chatLogger.warn(`Unrecognized usernotice ID: ${d}`)}}),this._ircClient.onTypedMessage(iZ,l=>{this.emit(this.onWhisper,l.prefix.nick,l.text,l)}),this._ircClient.onTypedMessage(S8,async({target:l,text:u,tags:h})=>{const f=h.get("msg-id");switch(f){case"emote_only_on":{this.emit(this.onEmoteOnly,Ac(l),!0);break}case"emote_only_off":{this.emit(this.onEmoteOnly,Ac(l),!1);break}case"msg_channel_suspended":case"msg_banned":{this.emit(this._onJoinResult,l,void 0,f);break}case"r9k_on":{this.emit(this.onUniqueChat,Ac(l),!0);break}case"r9k_off":{this.emit(this.onUniqueChat,Ac(l),!1);break}case"subs_on":{this.emit(this.onSubsOnly,Ac(l),!0);break}case"subs_off":{this.emit(this.onSubsOnly,Ac(l),!1);break}case"cmds_available":break;case"followers_on":case"followers_on_zero":case"followers_off":case"slow_on":case"slow_off":break;case"timeout_success":break;case"unrecognized_cmd":break;case"no_permission":{this.emit(this.onNoPermission,Ac(l),u);break}case"msg_ratelimit":{this.emit(this.onMessageRatelimit,Ac(l),u);break}case"msg_duplicate":case"msg_emoteonly":case"msg_followersonly":case"msg_followersonly_followed":case"msg_followersonly_zero":case"msg_subsonly":case"msg_slowmode":case"msg_r9k":case"msg_verified_email":case"msg_timedout":case"msg_rejected_mandatory":case"msg_channel_blocked":{this.emit(this.onMessageFailed,Ac(l),f);break}case void 0:{if(u==="Login authentication failed"||u==="Improperly formatted AUTH"||u==="Invalid NICK"){this._authVerified=!1,this._authRetryTimer||(this._authRetryTimer=BSe(120),this._authRetryCount=0);const d=this._authRetryTimer.next().value,p=++this._authRetryCount;this.emit(this.onAuthenticationFailure,u,p),d!==0&&this._chatLogger.info(`Retrying authentication in ${d} seconds`),await MTt(d*1e3),this._ircClient.reconnect()}break}default:f.startsWith("usage_")||this._chatLogger.warn(`Unrecognized notice ID: '${f}'`)}})}connect(){this._authProvider||this._ircClient.changeNick(H$._generateJustinfanNick()),this._ircClient.connect()}get irc(){return this._ircClient}get isConnected(){return this._ircClient.isConnected}get isConnecting(){return this._ircClient.isConnecting}get currentChannels(){return this._ircClient.currentChannels}async say(e,n,i={},r){const s={};i.replyTo&&(s["reply-parent-msg-id"]=sxt(i.replyTo));const a=Qae(n,500);await Promise.all(a.map(async o=>await this._messageRateLimiter.request({type:"say",channel:$P(e),text:o,tags:s},r)))}async action(e,n,i){const r=Qae(n,490);await Promise.all(r.map(async s=>await this._messageRateLimiter.request({type:"action",channel:$P(e),text:s},i)))}async join(e){await this._joinRateLimiter.request($P(e))}part(e){this._ircClient.part($P(e))}quit(){this._ircClient.quitAbruptly()}reconnect(){this.quit(),this.connect()}async _getAuthToken(){var e,n;if(!this._authProvider){this._chatLogger.debug("No authProvider given; connecting anonymously");return}if(this._authToken&&!Q2(this._authToken)&&this._authVerified)return this._chatLogger.debug("AccessToken assumed to be correct from last connection"),`oauth:${this._authToken.accessToken}`;const i=this._getNecessaryScopes();let r,s=!1;for(const a of this._authIntents){try{if(this._authToken=await this._authProvider.getAccessTokenForIntent(a,i),!this._authToken)continue;s=!0;const o=await WN(this._authToken.accessToken);if(!o.userName)throw new eL("Could not determine a user name for your token; you might be trying to disguise an app token as a user token.");return this._ircClient.changeNick(o.userName),`oauth:${this._authToken.accessToken}`}catch(o){o instanceof pC?r=o:this._chatLogger.error(`Retrieving an access token failed: ${o.message}`)}this._chatLogger.warn("No valid token available; trying to refresh");try{if(this._authToken=await((n=(e=this._authProvider).refreshAccessTokenForIntent)===null||n===void 0?void 0:n.call(e,a)),this._authToken){const o=await WN(this._authToken.accessToken);if(!o.userName)throw new eL("Could not determine a user name for your token; you might be trying to disguise an app token as a user token.");return this._ircClient.changeNick(o.userName),`oauth:${this._authToken.accessToken}`}}catch(o){o instanceof pC?r=o:this._chatLogger.error(`Refreshing the access token failed: ${o.message}`)}}throw this._authVerified=!1,r??new Error(s?"Could not retrieve a valid token":`None of the queried intents (${this._authIntents.join(", ")}) are known by the auth provider${this._authProvider instanceof oE?".\nPlease add one of these to the user you want to connect with using the `addIntentToUser` method or the additional parameter to `addUser` or `addUserForToken`.":""}`)}_getNecessaryScopes(){return this._useLegacyScopes?["chat_login"]:this._readOnly?["chat:read"]:["chat:read","chat:edit"]}static _generateJustinfanNick(){return`justinfan${Math.floor(Math.random()*1e5).toString().padStart(5,"0")}`}};ca([IE(!1)],cB.prototype,"_authProvider",void 0);cB=H$=ca([Fk("chat","ChatClient")],cB);var M1e={exports:{}};(function(t,e){(function(n,i){t.exports=i()})(self,()=>(()=>{var n={9669:(a,o,c)=>{a.exports=c(1609)},5448:(a,o,c)=>{var l=c(4867),u=c(6026),h=c(4372),f=c(5327),d=c(4097),p=c(4109),g=c(7985),y=c(7874),v=c(2648),b=c(644),T=c(205);a.exports=function(x){return new Promise(function(M,R){var I,k=x.data,P=x.headers,U=x.responseType;function G(){x.cancelToken&&x.cancelToken.unsubscribe(I),x.signal&&x.signal.removeEventListener("abort",I)}l.isFormData(k)&&l.isStandardBrowserEnv()&&delete P["Content-Type"];var $=new XMLHttpRequest;if(x.auth){var q=x.auth.username||"",Y=x.auth.password?unescape(encodeURIComponent(x.auth.password)):"";P.Authorization="Basic "+btoa(q+":"+Y)}var ie=d(x.baseURL,x.url);function V(){if($){var ee="getAllResponseHeaders"in $?p($.getAllResponseHeaders()):null,oe={data:U&&U!=="text"&&U!=="json"?$.response:$.responseText,status:$.status,statusText:$.statusText,headers:ee,config:x,request:$};u(function(fe){M(fe),G()},function(fe){R(fe),G()},oe),$=null}}if($.open(x.method.toUpperCase(),f(ie,x.params,x.paramsSerializer),!0),$.timeout=x.timeout,"onloadend"in $?$.onloadend=V:$.onreadystatechange=function(){$&&$.readyState===4&&($.status!==0||$.responseURL&&$.responseURL.indexOf("file:")===0)&&setTimeout(V)},$.onabort=function(){$&&(R(new v("Request aborted",v.ECONNABORTED,x,$)),$=null)},$.onerror=function(){R(new v("Network Error",v.ERR_NETWORK,x,$,$)),$=null},$.ontimeout=function(){var ee=x.timeout?"timeout of "+x.timeout+"ms exceeded":"timeout exceeded",oe=x.transitional||y;x.timeoutErrorMessage&&(ee=x.timeoutErrorMessage),R(new v(ee,oe.clarifyTimeoutError?v.ETIMEDOUT:v.ECONNABORTED,x,$)),$=null},l.isStandardBrowserEnv()){var J=(x.withCredentials||g(ie))&&x.xsrfCookieName?h.read(x.xsrfCookieName):void 0;J&&(P[x.xsrfHeaderName]=J)}"setRequestHeader"in $&&l.forEach(P,function(ee,oe){k===void 0&&oe.toLowerCase()==="content-type"?delete P[oe]:$.setRequestHeader(oe,ee)}),l.isUndefined(x.withCredentials)||($.withCredentials=!!x.withCredentials),U&&U!=="json"&&($.responseType=x.responseType),typeof x.onDownloadProgress=="function"&&$.addEventListener("progress",x.onDownloadProgress),typeof x.onUploadProgress=="function"&&$.upload&&$.upload.addEventListener("progress",x.onUploadProgress),(x.cancelToken||x.signal)&&(I=function(ee){$&&(R(!ee||ee&&ee.type?new b:ee),$.abort(),$=null)},x.cancelToken&&x.cancelToken.subscribe(I),x.signal&&(x.signal.aborted?I():x.signal.addEventListener("abort",I))),k||(k=null);var X=T(ie);X&&["http","https","file"].indexOf(X)===-1?R(new v("Unsupported protocol "+X+":",v.ERR_BAD_REQUEST,x)):$.send(k)})}},1609:(a,o,c)=>{var l=c(4867),u=c(1849),h=c(321),f=c(7185),d=function p(g){var y=new h(g),v=u(h.prototype.request,y);return l.extend(v,h.prototype,y),l.extend(v,y),v.create=function(b){return p(f(g,b))},v}(c(5546));d.Axios=h,d.CanceledError=c(644),d.CancelToken=c(4972),d.isCancel=c(6502),d.VERSION=c(7288).version,d.toFormData=c(7675),d.AxiosError=c(2648),d.Cancel=d.CanceledError,d.all=function(p){return Promise.all(p)},d.spread=c(8713),d.isAxiosError=c(6268),a.exports=d,a.exports.default=d},4972:(a,o,c)=>{var l=c(644);function u(h){if(typeof h!="function")throw new TypeError("executor must be a function.");var f;this.promise=new Promise(function(p){f=p});var d=this;this.promise.then(function(p){if(d._listeners){var g,y=d._listeners.length;for(g=0;g<y;g++)d._listeners[g](p);d._listeners=null}}),this.promise.then=function(p){var g,y=new Promise(function(v){d.subscribe(v),g=v}).then(p);return y.cancel=function(){d.unsubscribe(g)},y},h(function(p){d.reason||(d.reason=new l(p),f(d.reason))})}u.prototype.throwIfRequested=function(){if(this.reason)throw this.reason},u.prototype.subscribe=function(h){this.reason?h(this.reason):this._listeners?this._listeners.push(h):this._listeners=[h]},u.prototype.unsubscribe=function(h){if(this._listeners){var f=this._listeners.indexOf(h);f!==-1&&this._listeners.splice(f,1)}},u.source=function(){var h;return{token:new u(function(f){h=f}),cancel:h}},a.exports=u},644:(a,o,c)=>{var l=c(2648);function u(h){l.call(this,h??"canceled",l.ERR_CANCELED),this.name="CanceledError"}c(4867).inherits(u,l,{__CANCEL__:!0}),a.exports=u},6502:a=>{a.exports=function(o){return!(!o||!o.__CANCEL__)}},321:(a,o,c)=>{var l=c(4867),u=c(5327),h=c(782),f=c(3572),d=c(7185),p=c(4097),g=c(4875),y=g.validators;function v(b){this.defaults=b,this.interceptors={request:new h,response:new h}}v.prototype.request=function(b,T){typeof b=="string"?(T=T||{}).url=b:T=b||{},(T=d(this.defaults,T)).method?T.method=T.method.toLowerCase():this.defaults.method?T.method=this.defaults.method.toLowerCase():T.method="get";var x=T.transitional;x!==void 0&&g.assertOptions(x,{silentJSONParsing:y.transitional(y.boolean),forcedJSONParsing:y.transitional(y.boolean),clarifyTimeoutError:y.transitional(y.boolean)},!1);var M=[],R=!0;this.interceptors.request.forEach(function(q){typeof q.runWhen=="function"&&q.runWhen(T)===!1||(R=R&&q.synchronous,M.unshift(q.fulfilled,q.rejected))});var I,k=[];if(this.interceptors.response.forEach(function(q){k.push(q.fulfilled,q.rejected)}),!R){var P=[f,void 0];for(Array.prototype.unshift.apply(P,M),P=P.concat(k),I=Promise.resolve(T);P.length;)I=I.then(P.shift(),P.shift());return I}for(var U=T;M.length;){var G=M.shift(),$=M.shift();try{U=G(U)}catch(q){$(q);break}}try{I=f(U)}catch(q){return Promise.reject(q)}for(;k.length;)I=I.then(k.shift(),k.shift());return I},v.prototype.getUri=function(b){b=d(this.defaults,b);var T=p(b.baseURL,b.url);return u(T,b.params,b.paramsSerializer)},l.forEach(["delete","get","head","options"],function(b){v.prototype[b]=function(T,x){return this.request(d(x||{},{method:b,url:T,data:(x||{}).data}))}}),l.forEach(["post","put","patch"],function(b){function T(x){return function(M,R,I){return this.request(d(I||{},{method:b,headers:x?{"Content-Type":"multipart/form-data"}:{},url:M,data:R}))}}v.prototype[b]=T(),v.prototype[b+"Form"]=T(!0)}),a.exports=v},2648:(a,o,c)=>{var l=c(4867);function u(d,p,g,y,v){Error.call(this),this.message=d,this.name="AxiosError",p&&(this.code=p),g&&(this.config=g),y&&(this.request=y),v&&(this.response=v)}l.inherits(u,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:this.config,code:this.code,status:this.response&&this.response.status?this.response.status:null}}});var h=u.prototype,f={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED"].forEach(function(d){f[d]={value:d}}),Object.defineProperties(u,f),Object.defineProperty(h,"isAxiosError",{value:!0}),u.from=function(d,p,g,y,v,b){var T=Object.create(h);return l.toFlatObject(d,T,function(x){return x!==Error.prototype}),u.call(T,d.message,p,g,y,v),T.name=d.name,b&&Object.assign(T,b),T},a.exports=u},782:(a,o,c)=>{var l=c(4867);function u(){this.handlers=[]}u.prototype.use=function(h,f,d){return this.handlers.push({fulfilled:h,rejected:f,synchronous:!!d&&d.synchronous,runWhen:d?d.runWhen:null}),this.handlers.length-1},u.prototype.eject=function(h){this.handlers[h]&&(this.handlers[h]=null)},u.prototype.forEach=function(h){l.forEach(this.handlers,function(f){f!==null&&h(f)})},a.exports=u},4097:(a,o,c)=>{var l=c(1793),u=c(7303);a.exports=function(h,f){return h&&!l(f)?u(h,f):f}},3572:(a,o,c)=>{var l=c(4867),u=c(8527),h=c(6502),f=c(5546),d=c(644);function p(g){if(g.cancelToken&&g.cancelToken.throwIfRequested(),g.signal&&g.signal.aborted)throw new d}a.exports=function(g){return p(g),g.headers=g.headers||{},g.data=u.call(g,g.data,g.headers,g.transformRequest),g.headers=l.merge(g.headers.common||{},g.headers[g.method]||{},g.headers),l.forEach(["delete","get","head","post","put","patch","common"],function(y){delete g.headers[y]}),(g.adapter||f.adapter)(g).then(function(y){return p(g),y.data=u.call(g,y.data,y.headers,g.transformResponse),y},function(y){return h(y)||(p(g),y&&y.response&&(y.response.data=u.call(g,y.response.data,y.response.headers,g.transformResponse))),Promise.reject(y)})}},7185:(a,o,c)=>{var l=c(4867);a.exports=function(u,h){h=h||{};var f={};function d(T,x){return l.isPlainObject(T)&&l.isPlainObject(x)?l.merge(T,x):l.isPlainObject(x)?l.merge({},x):l.isArray(x)?x.slice():x}function p(T){return l.isUndefined(h[T])?l.isUndefined(u[T])?void 0:d(void 0,u[T]):d(u[T],h[T])}function g(T){if(!l.isUndefined(h[T]))return d(void 0,h[T])}function y(T){return l.isUndefined(h[T])?l.isUndefined(u[T])?void 0:d(void 0,u[T]):d(void 0,h[T])}function v(T){return T in h?d(u[T],h[T]):T in u?d(void 0,u[T]):void 0}var b={url:g,method:g,data:g,baseURL:y,transformRequest:y,transformResponse:y,paramsSerializer:y,timeout:y,timeoutMessage:y,withCredentials:y,adapter:y,responseType:y,xsrfCookieName:y,xsrfHeaderName:y,onUploadProgress:y,onDownloadProgress:y,decompress:y,maxContentLength:y,maxBodyLength:y,beforeRedirect:y,transport:y,httpAgent:y,httpsAgent:y,cancelToken:y,socketPath:y,responseEncoding:y,validateStatus:v};return l.forEach(Object.keys(u).concat(Object.keys(h)),function(T){var x=b[T]||p,M=x(T);l.isUndefined(M)&&x!==v||(f[T]=M)}),f}},6026:(a,o,c)=>{var l=c(2648);a.exports=function(u,h,f){var d=f.config.validateStatus;f.status&&d&&!d(f.status)?h(new l("Request failed with status code "+f.status,[l.ERR_BAD_REQUEST,l.ERR_BAD_RESPONSE][Math.floor(f.status/100)-4],f.config,f.request,f)):u(f)}},8527:(a,o,c)=>{var l=c(4867),u=c(5546);a.exports=function(h,f,d){var p=this||u;return l.forEach(d,function(g){h=g.call(p,h,f)}),h}},5546:(a,o,c)=>{var l=c(4867),u=c(6016),h=c(2648),f=c(7874),d=c(7675),p={"Content-Type":"application/x-www-form-urlencoded"};function g(b,T){!l.isUndefined(b)&&l.isUndefined(b["Content-Type"])&&(b["Content-Type"]=T)}var y,v={transitional:f,adapter:((typeof XMLHttpRequest<"u"||typeof zn<"u"&&Object.prototype.toString.call(zn)==="[object process]")&&(y=c(5448)),y),transformRequest:[function(b,T){if(u(T,"Accept"),u(T,"Content-Type"),l.isFormData(b)||l.isArrayBuffer(b)||l.isBuffer(b)||l.isStream(b)||l.isFile(b)||l.isBlob(b))return b;if(l.isArrayBufferView(b))return b.buffer;if(l.isURLSearchParams(b))return g(T,"application/x-www-form-urlencoded;charset=utf-8"),b.toString();var x,M=l.isObject(b),R=T&&T["Content-Type"];if((x=l.isFileList(b))||M&&R==="multipart/form-data"){var I=this.env&&this.env.FormData;return d(x?{"files[]":b}:b,I&&new I)}return M||R==="application/json"?(g(T,"application/json"),function(k,P,U){if(l.isString(k))try{return(P||JSON.parse)(k),l.trim(k)}catch(G){if(G.name!=="SyntaxError")throw G}return(0,JSON.stringify)(k)}(b)):b}],transformResponse:[function(b){var T=this.transitional||v.transitional,x=T&&T.silentJSONParsing,M=T&&T.forcedJSONParsing,R=!x&&this.responseType==="json";if(R||M&&l.isString(b)&&b.length)try{return JSON.parse(b)}catch(I){if(R)throw I.name==="SyntaxError"?h.from(I,h.ERR_BAD_RESPONSE,this,null,this.response):I}return b}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:c(1623)},validateStatus:function(b){return b>=200&&b<300},headers:{common:{Accept:"application/json, text/plain, */*"}}};l.forEach(["delete","get","head"],function(b){v.headers[b]={}}),l.forEach(["post","put","patch"],function(b){v.headers[b]=l.merge(p)}),a.exports=v},7874:a=>{a.exports={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1}},7288:a=>{a.exports={version:"0.27.2"}},1849:a=>{a.exports=function(o,c){return function(){for(var l=new Array(arguments.length),u=0;u<l.length;u++)l[u]=arguments[u];return o.apply(c,l)}}},5327:(a,o,c)=>{var l=c(4867);function u(h){return encodeURIComponent(h).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}a.exports=function(h,f,d){if(!f)return h;var p;if(d)p=d(f);else if(l.isURLSearchParams(f))p=f.toString();else{var g=[];l.forEach(f,function(v,b){v!=null&&(l.isArray(v)?b+="[]":v=[v],l.forEach(v,function(T){l.isDate(T)?T=T.toISOString():l.isObject(T)&&(T=JSON.stringify(T)),g.push(u(b)+"="+u(T))}))}),p=g.join("&")}if(p){var y=h.indexOf("#");y!==-1&&(h=h.slice(0,y)),h+=(h.indexOf("?")===-1?"?":"&")+p}return h}},7303:a=>{a.exports=function(o,c){return c?o.replace(/\/+$/,"")+"/"+c.replace(/^\/+/,""):o}},4372:(a,o,c)=>{var l=c(4867);a.exports=l.isStandardBrowserEnv()?{write:function(u,h,f,d,p,g){var y=[];y.push(u+"="+encodeURIComponent(h)),l.isNumber(f)&&y.push("expires="+new Date(f).toGMTString()),l.isString(d)&&y.push("path="+d),l.isString(p)&&y.push("domain="+p),g===!0&&y.push("secure"),document.cookie=y.join("; ")},read:function(u){var h=document.cookie.match(new RegExp("(^|;\\s*)("+u+")=([^;]*)"));return h?decodeURIComponent(h[3]):null},remove:function(u){this.write(u,"",Date.now()-864e5)}}:{write:function(){},read:function(){return null},remove:function(){}}},1793:a=>{a.exports=function(o){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(o)}},6268:(a,o,c)=>{var l=c(4867);a.exports=function(u){return l.isObject(u)&&u.isAxiosError===!0}},7985:(a,o,c)=>{var l=c(4867);a.exports=l.isStandardBrowserEnv()?function(){var u,h=/(msie|trident)/i.test(navigator.userAgent),f=document.createElement("a");function d(p){var g=p;return h&&(f.setAttribute("href",g),g=f.href),f.setAttribute("href",g),{href:f.href,protocol:f.protocol?f.protocol.replace(/:$/,""):"",host:f.host,search:f.search?f.search.replace(/^\?/,""):"",hash:f.hash?f.hash.replace(/^#/,""):"",hostname:f.hostname,port:f.port,pathname:f.pathname.charAt(0)==="/"?f.pathname:"/"+f.pathname}}return u=d(window.location.href),function(p){var g=l.isString(p)?d(p):p;return g.protocol===u.protocol&&g.host===u.host}}():function(){return!0}},6016:(a,o,c)=>{var l=c(4867);a.exports=function(u,h){l.forEach(u,function(f,d){d!==h&&d.toUpperCase()===h.toUpperCase()&&(u[h]=f,delete u[d])})}},1623:a=>{a.exports=null},4109:(a,o,c)=>{var l=c(4867),u=["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"];a.exports=function(h){var f,d,p,g={};return h&&l.forEach(h.split(`
`),function(y){if(p=y.indexOf(":"),f=l.trim(y.substr(0,p)).toLowerCase(),d=l.trim(y.substr(p+1)),f){if(g[f]&&u.indexOf(f)>=0)return;g[f]=f==="set-cookie"?(g[f]?g[f]:[]).concat([d]):g[f]?g[f]+", "+d:d}}),g}},205:a=>{a.exports=function(o){var c=/^([-+\w]{1,25})(:?\/\/|:)/.exec(o);return c&&c[1]||""}},8713:a=>{a.exports=function(o){return function(c){return o.apply(null,c)}}},7675:(a,o,c)=>{var l=c(4867);a.exports=function(u,h){h=h||new FormData;var f=[];function d(p){return p===null?"":l.isDate(p)?p.toISOString():l.isArrayBuffer(p)||l.isTypedArray(p)?typeof Blob=="function"?new Blob([p]):Fl.from(p):p}return function p(g,y){if(l.isPlainObject(g)||l.isArray(g)){if(f.indexOf(g)!==-1)throw Error("Circular reference detected in "+y);f.push(g),l.forEach(g,function(v,b){if(!l.isUndefined(v)){var T,x=y?y+"."+b:b;if(v&&!y&&typeof v=="object"){if(l.endsWith(b,"{}"))v=JSON.stringify(v);else if(l.endsWith(b,"[]")&&(T=l.toArray(v)))return void T.forEach(function(M){!l.isUndefined(M)&&h.append(x,d(M))})}p(v,x)}}),f.pop()}else h.append(y,d(g))}(u),h}},4875:(a,o,c)=>{var l=c(7288).version,u=c(2648),h={};["object","boolean","number","function","string","symbol"].forEach(function(d,p){h[d]=function(g){return typeof g===d||"a"+(p<1?"n ":" ")+d}});var f={};h.transitional=function(d,p,g){function y(v,b){return"[Axios v"+l+"] Transitional option '"+v+"'"+b+(g?". "+g:"")}return function(v,b,T){if(d===!1)throw new u(y(b," has been removed"+(p?" in "+p:"")),u.ERR_DEPRECATED);return p&&!f[b]&&(f[b]=!0,console.warn(y(b," has been deprecated since v"+p+" and will be removed in the near future"))),!d||d(v,b,T)}},a.exports={assertOptions:function(d,p,g){if(typeof d!="object")throw new u("options must be an object",u.ERR_BAD_OPTION_VALUE);for(var y=Object.keys(d),v=y.length;v-- >0;){var b=y[v],T=p[b];if(T){var x=d[b],M=x===void 0||T(x,b,d);if(M!==!0)throw new u("option "+b+" must be "+M,u.ERR_BAD_OPTION_VALUE)}else if(g!==!0)throw new u("Unknown option "+b,u.ERR_BAD_OPTION)}},validators:h}},4867:(a,o,c)=>{var l,u=c(1849),h=Object.prototype.toString,f=(l=Object.create(null),function($){var q=h.call($);return l[q]||(l[q]=q.slice(8,-1).toLowerCase())});function d($){return $=$.toLowerCase(),function(q){return f(q)===$}}function p($){return Array.isArray($)}function g($){return $===void 0}var y=d("ArrayBuffer");function v($){return $!==null&&typeof $=="object"}function b($){if(f($)!=="object")return!1;var q=Object.getPrototypeOf($);return q===null||q===Object.prototype}var T=d("Date"),x=d("File"),M=d("Blob"),R=d("FileList");function I($){return h.call($)==="[object Function]"}var k=d("URLSearchParams");function P($,q){if($!=null)if(typeof $!="object"&&($=[$]),p($))for(var Y=0,ie=$.length;Y<ie;Y++)q.call(null,$[Y],Y,$);else for(var V in $)Object.prototype.hasOwnProperty.call($,V)&&q.call(null,$[V],V,$)}var U,G=(U=typeof Uint8Array<"u"&&Object.getPrototypeOf(Uint8Array),function($){return U&&$ instanceof U});a.exports={isArray:p,isArrayBuffer:y,isBuffer:function($){return $!==null&&!g($)&&$.constructor!==null&&!g($.constructor)&&typeof $.constructor.isBuffer=="function"&&$.constructor.isBuffer($)},isFormData:function($){var q="[object FormData]";return $&&(typeof FormData=="function"&&$ instanceof FormData||h.call($)===q||I($.toString)&&$.toString()===q)},isArrayBufferView:function($){return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?ArrayBuffer.isView($):$&&$.buffer&&y($.buffer)},isString:function($){return typeof $=="string"},isNumber:function($){return typeof $=="number"},isObject:v,isPlainObject:b,isUndefined:g,isDate:T,isFile:x,isBlob:M,isFunction:I,isStream:function($){return v($)&&I($.pipe)},isURLSearchParams:k,isStandardBrowserEnv:function(){return(typeof navigator>"u"||navigator.product!=="ReactNative"&&navigator.product!=="NativeScript"&&navigator.product!=="NS")&&typeof window<"u"&&typeof document<"u"},forEach:P,merge:function $(){var q={};function Y(J,X){b(q[X])&&b(J)?q[X]=$(q[X],J):b(J)?q[X]=$({},J):p(J)?q[X]=J.slice():q[X]=J}for(var ie=0,V=arguments.length;ie<V;ie++)P(arguments[ie],Y);return q},extend:function($,q,Y){return P(q,function(ie,V){$[V]=Y&&typeof ie=="function"?u(ie,Y):ie}),$},trim:function($){return $.trim?$.trim():$.replace(/^\s+|\s+$/g,"")},stripBOM:function($){return $.charCodeAt(0)===65279&&($=$.slice(1)),$},inherits:function($,q,Y,ie){$.prototype=Object.create(q.prototype,ie),$.prototype.constructor=$,Y&&Object.assign($.prototype,Y)},toFlatObject:function($,q,Y){var ie,V,J,X={};q=q||{};do{for(V=(ie=Object.getOwnPropertyNames($)).length;V-- >0;)X[J=ie[V]]||(q[J]=$[J],X[J]=!0);$=Object.getPrototypeOf($)}while($&&(!Y||Y($,q))&&$!==Object.prototype);return q},kindOf:f,kindOfTest:d,endsWith:function($,q,Y){$=String($),(Y===void 0||Y>$.length)&&(Y=$.length),Y-=q.length;var ie=$.indexOf(q,Y);return ie!==-1&&ie===Y},toArray:function($){if(!$)return null;var q=$.length;if(g(q))return null;for(var Y=new Array(q);q-- >0;)Y[q]=$[q];return Y},isTypedArray:G,isFileList:R}},1206:function(a){a.exports=function(o){var c={};function l(u){if(c[u])return c[u].exports;var h=c[u]={i:u,l:!1,exports:{}};return o[u].call(h.exports,h,h.exports,l),h.l=!0,h.exports}return l.m=o,l.c=c,l.d=function(u,h,f){l.o(u,h)||Object.defineProperty(u,h,{enumerable:!0,get:f})},l.r=function(u){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(u,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(u,"__esModule",{value:!0})},l.t=function(u,h){if(1&h&&(u=l(u)),8&h||4&h&&typeof u=="object"&&u&&u.__esModule)return u;var f=Object.create(null);if(l.r(f),Object.defineProperty(f,"default",{enumerable:!0,value:u}),2&h&&typeof u!="string")for(var d in u)l.d(f,d,(function(p){return u[p]}).bind(null,d));return f},l.n=function(u){var h=u&&u.__esModule?function(){return u.default}:function(){return u};return l.d(h,"a",h),h},l.o=function(u,h){return Object.prototype.hasOwnProperty.call(u,h)},l.p="",l(l.s=90)}({17:function(o,c,l){c.__esModule=!0,c.default=void 0;var u=l(18),h=function(){function f(){}return f.getFirstMatch=function(d,p){var g=p.match(d);return g&&g.length>0&&g[1]||""},f.getSecondMatch=function(d,p){var g=p.match(d);return g&&g.length>1&&g[2]||""},f.matchAndReturnConst=function(d,p,g){if(d.test(p))return g},f.getWindowsVersionName=function(d){switch(d){case"NT":return"NT";case"XP":case"NT 5.1":return"XP";case"NT 5.0":return"2000";case"NT 5.2":return"2003";case"NT 6.0":return"Vista";case"NT 6.1":return"7";case"NT 6.2":return"8";case"NT 6.3":return"8.1";case"NT 10.0":return"10";default:return}},f.getMacOSVersionName=function(d){var p=d.split(".").splice(0,2).map(function(g){return parseInt(g,10)||0});if(p.push(0),p[0]===10)switch(p[1]){case 5:return"Leopard";case 6:return"Snow Leopard";case 7:return"Lion";case 8:return"Mountain Lion";case 9:return"Mavericks";case 10:return"Yosemite";case 11:return"El Capitan";case 12:return"Sierra";case 13:return"High Sierra";case 14:return"Mojave";case 15:return"Catalina";default:return}},f.getAndroidVersionName=function(d){var p=d.split(".").splice(0,2).map(function(g){return parseInt(g,10)||0});if(p.push(0),!(p[0]===1&&p[1]<5))return p[0]===1&&p[1]<6?"Cupcake":p[0]===1&&p[1]>=6?"Donut":p[0]===2&&p[1]<2?"Eclair":p[0]===2&&p[1]===2?"Froyo":p[0]===2&&p[1]>2?"Gingerbread":p[0]===3?"Honeycomb":p[0]===4&&p[1]<1?"Ice Cream Sandwich":p[0]===4&&p[1]<4?"Jelly Bean":p[0]===4&&p[1]>=4?"KitKat":p[0]===5?"Lollipop":p[0]===6?"Marshmallow":p[0]===7?"Nougat":p[0]===8?"Oreo":p[0]===9?"Pie":void 0},f.getVersionPrecision=function(d){return d.split(".").length},f.compareVersions=function(d,p,g){g===void 0&&(g=!1);var y=f.getVersionPrecision(d),v=f.getVersionPrecision(p),b=Math.max(y,v),T=0,x=f.map([d,p],function(M){var R=b-f.getVersionPrecision(M),I=M+new Array(R+1).join(".0");return f.map(I.split("."),function(k){return new Array(20-k.length).join("0")+k}).reverse()});for(g&&(T=b-Math.min(y,v)),b-=1;b>=T;){if(x[0][b]>x[1][b])return 1;if(x[0][b]===x[1][b]){if(b===T)return 0;b-=1}else if(x[0][b]<x[1][b])return-1}},f.map=function(d,p){var g,y=[];if(Array.prototype.map)return Array.prototype.map.call(d,p);for(g=0;g<d.length;g+=1)y.push(p(d[g]));return y},f.find=function(d,p){var g,y;if(Array.prototype.find)return Array.prototype.find.call(d,p);for(g=0,y=d.length;g<y;g+=1){var v=d[g];if(p(v,g))return v}},f.assign=function(d){for(var p,g,y=d,v=arguments.length,b=new Array(v>1?v-1:0),T=1;T<v;T++)b[T-1]=arguments[T];if(Object.assign)return Object.assign.apply(Object,[d].concat(b));var x=function(){var M=b[p];typeof M=="object"&&M!==null&&Object.keys(M).forEach(function(R){y[R]=M[R]})};for(p=0,g=b.length;p<g;p+=1)x();return d},f.getBrowserAlias=function(d){return u.BROWSER_ALIASES_MAP[d]},f.getBrowserTypeByAlias=function(d){return u.BROWSER_MAP[d]||""},f}();c.default=h,o.exports=c.default},18:function(o,c,l){c.__esModule=!0,c.ENGINE_MAP=c.OS_MAP=c.PLATFORMS_MAP=c.BROWSER_MAP=c.BROWSER_ALIASES_MAP=void 0,c.BROWSER_ALIASES_MAP={"Amazon Silk":"amazon_silk","Android Browser":"android",Bada:"bada",BlackBerry:"blackberry",Chrome:"chrome",Chromium:"chromium",Electron:"electron",Epiphany:"epiphany",Firefox:"firefox",Focus:"focus",Generic:"generic","Google Search":"google_search",Googlebot:"googlebot","Internet Explorer":"ie","K-Meleon":"k_meleon",Maxthon:"maxthon","Microsoft Edge":"edge","MZ Browser":"mz","NAVER Whale Browser":"naver",Opera:"opera","Opera Coast":"opera_coast",PhantomJS:"phantomjs",Puffin:"puffin",QupZilla:"qupzilla",QQ:"qq",QQLite:"qqlite",Safari:"safari",Sailfish:"sailfish","Samsung Internet for Android":"samsung_internet",SeaMonkey:"seamonkey",Sleipnir:"sleipnir",Swing:"swing",Tizen:"tizen","UC Browser":"uc",Vivaldi:"vivaldi","WebOS Browser":"webos",WeChat:"wechat","Yandex Browser":"yandex",Roku:"roku"},c.BROWSER_MAP={amazon_silk:"Amazon Silk",android:"Android Browser",bada:"Bada",blackberry:"BlackBerry",chrome:"Chrome",chromium:"Chromium",electron:"Electron",epiphany:"Epiphany",firefox:"Firefox",focus:"Focus",generic:"Generic",googlebot:"Googlebot",google_search:"Google Search",ie:"Internet Explorer",k_meleon:"K-Meleon",maxthon:"Maxthon",edge:"Microsoft Edge",mz:"MZ Browser",naver:"NAVER Whale Browser",opera:"Opera",opera_coast:"Opera Coast",phantomjs:"PhantomJS",puffin:"Puffin",qupzilla:"QupZilla",qq:"QQ Browser",qqlite:"QQ Browser Lite",safari:"Safari",sailfish:"Sailfish",samsung_internet:"Samsung Internet for Android",seamonkey:"SeaMonkey",sleipnir:"Sleipnir",swing:"Swing",tizen:"Tizen",uc:"UC Browser",vivaldi:"Vivaldi",webos:"WebOS Browser",wechat:"WeChat",yandex:"Yandex Browser"},c.PLATFORMS_MAP={tablet:"tablet",mobile:"mobile",desktop:"desktop",tv:"tv"},c.OS_MAP={WindowsPhone:"Windows Phone",Windows:"Windows",MacOS:"macOS",iOS:"iOS",Android:"Android",WebOS:"WebOS",BlackBerry:"BlackBerry",Bada:"Bada",Tizen:"Tizen",Linux:"Linux",ChromeOS:"Chrome OS",PlayStation4:"PlayStation 4",Roku:"Roku"},c.ENGINE_MAP={EdgeHTML:"EdgeHTML",Blink:"Blink",Trident:"Trident",Presto:"Presto",Gecko:"Gecko",WebKit:"WebKit"}},90:function(o,c,l){c.__esModule=!0,c.default=void 0;var u,h=(u=l(91))&&u.__esModule?u:{default:u},f=l(18);function d(g,y){for(var v=0;v<y.length;v++){var b=y[v];b.enumerable=b.enumerable||!1,b.configurable=!0,"value"in b&&(b.writable=!0),Object.defineProperty(g,b.key,b)}}var p=function(){function g(){}var y,v,b;return g.getParser=function(T,x){if(x===void 0&&(x=!1),typeof T!="string")throw new Error("UserAgent should be a string");return new h.default(T,x)},g.parse=function(T){return new h.default(T).getResult()},y=g,b=[{key:"BROWSER_MAP",get:function(){return f.BROWSER_MAP}},{key:"ENGINE_MAP",get:function(){return f.ENGINE_MAP}},{key:"OS_MAP",get:function(){return f.OS_MAP}},{key:"PLATFORMS_MAP",get:function(){return f.PLATFORMS_MAP}}],(v=null)&&d(y.prototype,v),b&&d(y,b),g}();c.default=p,o.exports=c.default},91:function(o,c,l){c.__esModule=!0,c.default=void 0;var u=g(l(92)),h=g(l(93)),f=g(l(94)),d=g(l(95)),p=g(l(17));function g(v){return v&&v.__esModule?v:{default:v}}var y=function(){function v(T,x){if(x===void 0&&(x=!1),T==null||T==="")throw new Error("UserAgent parameter can't be empty");this._ua=T,this.parsedResult={},x!==!0&&this.parse()}var b=v.prototype;return b.getUA=function(){return this._ua},b.test=function(T){return T.test(this._ua)},b.parseBrowser=function(){var T=this;this.parsedResult.browser={};var x=p.default.find(u.default,function(M){if(typeof M.test=="function")return M.test(T);if(M.test instanceof Array)return M.test.some(function(R){return T.test(R)});throw new Error("Browser's test function is not valid")});return x&&(this.parsedResult.browser=x.describe(this.getUA())),this.parsedResult.browser},b.getBrowser=function(){return this.parsedResult.browser?this.parsedResult.browser:this.parseBrowser()},b.getBrowserName=function(T){return T?String(this.getBrowser().name).toLowerCase()||"":this.getBrowser().name||""},b.getBrowserVersion=function(){return this.getBrowser().version},b.getOS=function(){return this.parsedResult.os?this.parsedResult.os:this.parseOS()},b.parseOS=function(){var T=this;this.parsedResult.os={};var x=p.default.find(h.default,function(M){if(typeof M.test=="function")return M.test(T);if(M.test instanceof Array)return M.test.some(function(R){return T.test(R)});throw new Error("Browser's test function is not valid")});return x&&(this.parsedResult.os=x.describe(this.getUA())),this.parsedResult.os},b.getOSName=function(T){var x=this.getOS().name;return T?String(x).toLowerCase()||"":x||""},b.getOSVersion=function(){return this.getOS().version},b.getPlatform=function(){return this.parsedResult.platform?this.parsedResult.platform:this.parsePlatform()},b.getPlatformType=function(T){T===void 0&&(T=!1);var x=this.getPlatform().type;return T?String(x).toLowerCase()||"":x||""},b.parsePlatform=function(){var T=this;this.parsedResult.platform={};var x=p.default.find(f.default,function(M){if(typeof M.test=="function")return M.test(T);if(M.test instanceof Array)return M.test.some(function(R){return T.test(R)});throw new Error("Browser's test function is not valid")});return x&&(this.parsedResult.platform=x.describe(this.getUA())),this.parsedResult.platform},b.getEngine=function(){return this.parsedResult.engine?this.parsedResult.engine:this.parseEngine()},b.getEngineName=function(T){return T?String(this.getEngine().name).toLowerCase()||"":this.getEngine().name||""},b.parseEngine=function(){var T=this;this.parsedResult.engine={};var x=p.default.find(d.default,function(M){if(typeof M.test=="function")return M.test(T);if(M.test instanceof Array)return M.test.some(function(R){return T.test(R)});throw new Error("Browser's test function is not valid")});return x&&(this.parsedResult.engine=x.describe(this.getUA())),this.parsedResult.engine},b.parse=function(){return this.parseBrowser(),this.parseOS(),this.parsePlatform(),this.parseEngine(),this},b.getResult=function(){return p.default.assign({},this.parsedResult)},b.satisfies=function(T){var x=this,M={},R=0,I={},k=0;if(Object.keys(T).forEach(function(V){var J=T[V];typeof J=="string"?(I[V]=J,k+=1):typeof J=="object"&&(M[V]=J,R+=1)}),R>0){var P=Object.keys(M),U=p.default.find(P,function(V){return x.isOS(V)});if(U){var G=this.satisfies(M[U]);if(G!==void 0)return G}var $=p.default.find(P,function(V){return x.isPlatform(V)});if($){var q=this.satisfies(M[$]);if(q!==void 0)return q}}if(k>0){var Y=Object.keys(I),ie=p.default.find(Y,function(V){return x.isBrowser(V,!0)});if(ie!==void 0)return this.compareVersion(I[ie])}},b.isBrowser=function(T,x){x===void 0&&(x=!1);var M=this.getBrowserName().toLowerCase(),R=T.toLowerCase(),I=p.default.getBrowserTypeByAlias(R);return x&&I&&(R=I.toLowerCase()),R===M},b.compareVersion=function(T){var x=[0],M=T,R=!1,I=this.getBrowserVersion();if(typeof I=="string")return T[0]===">"||T[0]==="<"?(M=T.substr(1),T[1]==="="?(R=!0,M=T.substr(2)):x=[],T[0]===">"?x.push(1):x.push(-1)):T[0]==="="?M=T.substr(1):T[0]==="~"&&(R=!0,M=T.substr(1)),x.indexOf(p.default.compareVersions(I,M,R))>-1},b.isOS=function(T){return this.getOSName(!0)===String(T).toLowerCase()},b.isPlatform=function(T){return this.getPlatformType(!0)===String(T).toLowerCase()},b.isEngine=function(T){return this.getEngineName(!0)===String(T).toLowerCase()},b.is=function(T,x){return x===void 0&&(x=!1),this.isBrowser(T,x)||this.isOS(T)||this.isPlatform(T)},b.some=function(T){var x=this;return T===void 0&&(T=[]),T.some(function(M){return x.is(M)})},v}();c.default=y,o.exports=c.default},92:function(o,c,l){c.__esModule=!0,c.default=void 0;var u,h=(u=l(17))&&u.__esModule?u:{default:u},f=/version\/(\d+(\.?_?\d+)+)/i,d=[{test:[/googlebot/i],describe:function(p){var g={name:"Googlebot"},y=h.default.getFirstMatch(/googlebot\/(\d+(\.\d+))/i,p)||h.default.getFirstMatch(f,p);return y&&(g.version=y),g}},{test:[/opera/i],describe:function(p){var g={name:"Opera"},y=h.default.getFirstMatch(f,p)||h.default.getFirstMatch(/(?:opera)[\s/](\d+(\.?_?\d+)+)/i,p);return y&&(g.version=y),g}},{test:[/opr\/|opios/i],describe:function(p){var g={name:"Opera"},y=h.default.getFirstMatch(/(?:opr|opios)[\s/](\S+)/i,p)||h.default.getFirstMatch(f,p);return y&&(g.version=y),g}},{test:[/SamsungBrowser/i],describe:function(p){var g={name:"Samsung Internet for Android"},y=h.default.getFirstMatch(f,p)||h.default.getFirstMatch(/(?:SamsungBrowser)[\s/](\d+(\.?_?\d+)+)/i,p);return y&&(g.version=y),g}},{test:[/Whale/i],describe:function(p){var g={name:"NAVER Whale Browser"},y=h.default.getFirstMatch(f,p)||h.default.getFirstMatch(/(?:whale)[\s/](\d+(?:\.\d+)+)/i,p);return y&&(g.version=y),g}},{test:[/MZBrowser/i],describe:function(p){var g={name:"MZ Browser"},y=h.default.getFirstMatch(/(?:MZBrowser)[\s/](\d+(?:\.\d+)+)/i,p)||h.default.getFirstMatch(f,p);return y&&(g.version=y),g}},{test:[/focus/i],describe:function(p){var g={name:"Focus"},y=h.default.getFirstMatch(/(?:focus)[\s/](\d+(?:\.\d+)+)/i,p)||h.default.getFirstMatch(f,p);return y&&(g.version=y),g}},{test:[/swing/i],describe:function(p){var g={name:"Swing"},y=h.default.getFirstMatch(/(?:swing)[\s/](\d+(?:\.\d+)+)/i,p)||h.default.getFirstMatch(f,p);return y&&(g.version=y),g}},{test:[/coast/i],describe:function(p){var g={name:"Opera Coast"},y=h.default.getFirstMatch(f,p)||h.default.getFirstMatch(/(?:coast)[\s/](\d+(\.?_?\d+)+)/i,p);return y&&(g.version=y),g}},{test:[/opt\/\d+(?:.?_?\d+)+/i],describe:function(p){var g={name:"Opera Touch"},y=h.default.getFirstMatch(/(?:opt)[\s/](\d+(\.?_?\d+)+)/i,p)||h.default.getFirstMatch(f,p);return y&&(g.version=y),g}},{test:[/yabrowser/i],describe:function(p){var g={name:"Yandex Browser"},y=h.default.getFirstMatch(/(?:yabrowser)[\s/](\d+(\.?_?\d+)+)/i,p)||h.default.getFirstMatch(f,p);return y&&(g.version=y),g}},{test:[/ucbrowser/i],describe:function(p){var g={name:"UC Browser"},y=h.default.getFirstMatch(f,p)||h.default.getFirstMatch(/(?:ucbrowser)[\s/](\d+(\.?_?\d+)+)/i,p);return y&&(g.version=y),g}},{test:[/Maxthon|mxios/i],describe:function(p){var g={name:"Maxthon"},y=h.default.getFirstMatch(f,p)||h.default.getFirstMatch(/(?:Maxthon|mxios)[\s/](\d+(\.?_?\d+)+)/i,p);return y&&(g.version=y),g}},{test:[/epiphany/i],describe:function(p){var g={name:"Epiphany"},y=h.default.getFirstMatch(f,p)||h.default.getFirstMatch(/(?:epiphany)[\s/](\d+(\.?_?\d+)+)/i,p);return y&&(g.version=y),g}},{test:[/puffin/i],describe:function(p){var g={name:"Puffin"},y=h.default.getFirstMatch(f,p)||h.default.getFirstMatch(/(?:puffin)[\s/](\d+(\.?_?\d+)+)/i,p);return y&&(g.version=y),g}},{test:[/sleipnir/i],describe:function(p){var g={name:"Sleipnir"},y=h.default.getFirstMatch(f,p)||h.default.getFirstMatch(/(?:sleipnir)[\s/](\d+(\.?_?\d+)+)/i,p);return y&&(g.version=y),g}},{test:[/k-meleon/i],describe:function(p){var g={name:"K-Meleon"},y=h.default.getFirstMatch(f,p)||h.default.getFirstMatch(/(?:k-meleon)[\s/](\d+(\.?_?\d+)+)/i,p);return y&&(g.version=y),g}},{test:[/micromessenger/i],describe:function(p){var g={name:"WeChat"},y=h.default.getFirstMatch(/(?:micromessenger)[\s/](\d+(\.?_?\d+)+)/i,p)||h.default.getFirstMatch(f,p);return y&&(g.version=y),g}},{test:[/qqbrowser/i],describe:function(p){var g={name:/qqbrowserlite/i.test(p)?"QQ Browser Lite":"QQ Browser"},y=h.default.getFirstMatch(/(?:qqbrowserlite|qqbrowser)[/](\d+(\.?_?\d+)+)/i,p)||h.default.getFirstMatch(f,p);return y&&(g.version=y),g}},{test:[/msie|trident/i],describe:function(p){var g={name:"Internet Explorer"},y=h.default.getFirstMatch(/(?:msie |rv:)(\d+(\.?_?\d+)+)/i,p);return y&&(g.version=y),g}},{test:[/\sedg\//i],describe:function(p){var g={name:"Microsoft Edge"},y=h.default.getFirstMatch(/\sedg\/(\d+(\.?_?\d+)+)/i,p);return y&&(g.version=y),g}},{test:[/edg([ea]|ios)/i],describe:function(p){var g={name:"Microsoft Edge"},y=h.default.getSecondMatch(/edg([ea]|ios)\/(\d+(\.?_?\d+)+)/i,p);return y&&(g.version=y),g}},{test:[/vivaldi/i],describe:function(p){var g={name:"Vivaldi"},y=h.default.getFirstMatch(/vivaldi\/(\d+(\.?_?\d+)+)/i,p);return y&&(g.version=y),g}},{test:[/seamonkey/i],describe:function(p){var g={name:"SeaMonkey"},y=h.default.getFirstMatch(/seamonkey\/(\d+(\.?_?\d+)+)/i,p);return y&&(g.version=y),g}},{test:[/sailfish/i],describe:function(p){var g={name:"Sailfish"},y=h.default.getFirstMatch(/sailfish\s?browser\/(\d+(\.\d+)?)/i,p);return y&&(g.version=y),g}},{test:[/silk/i],describe:function(p){var g={name:"Amazon Silk"},y=h.default.getFirstMatch(/silk\/(\d+(\.?_?\d+)+)/i,p);return y&&(g.version=y),g}},{test:[/phantom/i],describe:function(p){var g={name:"PhantomJS"},y=h.default.getFirstMatch(/phantomjs\/(\d+(\.?_?\d+)+)/i,p);return y&&(g.version=y),g}},{test:[/slimerjs/i],describe:function(p){var g={name:"SlimerJS"},y=h.default.getFirstMatch(/slimerjs\/(\d+(\.?_?\d+)+)/i,p);return y&&(g.version=y),g}},{test:[/blackberry|\bbb\d+/i,/rim\stablet/i],describe:function(p){var g={name:"BlackBerry"},y=h.default.getFirstMatch(f,p)||h.default.getFirstMatch(/blackberry[\d]+\/(\d+(\.?_?\d+)+)/i,p);return y&&(g.version=y),g}},{test:[/(web|hpw)[o0]s/i],describe:function(p){var g={name:"WebOS Browser"},y=h.default.getFirstMatch(f,p)||h.default.getFirstMatch(/w(?:eb)?[o0]sbrowser\/(\d+(\.?_?\d+)+)/i,p);return y&&(g.version=y),g}},{test:[/bada/i],describe:function(p){var g={name:"Bada"},y=h.default.getFirstMatch(/dolfin\/(\d+(\.?_?\d+)+)/i,p);return y&&(g.version=y),g}},{test:[/tizen/i],describe:function(p){var g={name:"Tizen"},y=h.default.getFirstMatch(/(?:tizen\s?)?browser\/(\d+(\.?_?\d+)+)/i,p)||h.default.getFirstMatch(f,p);return y&&(g.version=y),g}},{test:[/qupzilla/i],describe:function(p){var g={name:"QupZilla"},y=h.default.getFirstMatch(/(?:qupzilla)[\s/](\d+(\.?_?\d+)+)/i,p)||h.default.getFirstMatch(f,p);return y&&(g.version=y),g}},{test:[/firefox|iceweasel|fxios/i],describe:function(p){var g={name:"Firefox"},y=h.default.getFirstMatch(/(?:firefox|iceweasel|fxios)[\s/](\d+(\.?_?\d+)+)/i,p);return y&&(g.version=y),g}},{test:[/electron/i],describe:function(p){var g={name:"Electron"},y=h.default.getFirstMatch(/(?:electron)\/(\d+(\.?_?\d+)+)/i,p);return y&&(g.version=y),g}},{test:[/MiuiBrowser/i],describe:function(p){var g={name:"Miui"},y=h.default.getFirstMatch(/(?:MiuiBrowser)[\s/](\d+(\.?_?\d+)+)/i,p);return y&&(g.version=y),g}},{test:[/chromium/i],describe:function(p){var g={name:"Chromium"},y=h.default.getFirstMatch(/(?:chromium)[\s/](\d+(\.?_?\d+)+)/i,p)||h.default.getFirstMatch(f,p);return y&&(g.version=y),g}},{test:[/chrome|crios|crmo/i],describe:function(p){var g={name:"Chrome"},y=h.default.getFirstMatch(/(?:chrome|crios|crmo)\/(\d+(\.?_?\d+)+)/i,p);return y&&(g.version=y),g}},{test:[/GSA/i],describe:function(p){var g={name:"Google Search"},y=h.default.getFirstMatch(/(?:GSA)\/(\d+(\.?_?\d+)+)/i,p);return y&&(g.version=y),g}},{test:function(p){var g=!p.test(/like android/i),y=p.test(/android/i);return g&&y},describe:function(p){var g={name:"Android Browser"},y=h.default.getFirstMatch(f,p);return y&&(g.version=y),g}},{test:[/playstation 4/i],describe:function(p){var g={name:"PlayStation 4"},y=h.default.getFirstMatch(f,p);return y&&(g.version=y),g}},{test:[/safari|applewebkit/i],describe:function(p){var g={name:"Safari"},y=h.default.getFirstMatch(f,p);return y&&(g.version=y),g}},{test:[/.*/i],describe:function(p){var g=p.search("\\(")!==-1?/^(.*)\/(.*)[ \t]\((.*)/:/^(.*)\/(.*) /;return{name:h.default.getFirstMatch(g,p),version:h.default.getSecondMatch(g,p)}}}];c.default=d,o.exports=c.default},93:function(o,c,l){c.__esModule=!0,c.default=void 0;var u,h=(u=l(17))&&u.__esModule?u:{default:u},f=l(18),d=[{test:[/Roku\/DVP/],describe:function(p){var g=h.default.getFirstMatch(/Roku\/DVP-(\d+\.\d+)/i,p);return{name:f.OS_MAP.Roku,version:g}}},{test:[/windows phone/i],describe:function(p){var g=h.default.getFirstMatch(/windows phone (?:os)?\s?(\d+(\.\d+)*)/i,p);return{name:f.OS_MAP.WindowsPhone,version:g}}},{test:[/windows /i],describe:function(p){var g=h.default.getFirstMatch(/Windows ((NT|XP)( \d\d?.\d)?)/i,p),y=h.default.getWindowsVersionName(g);return{name:f.OS_MAP.Windows,version:g,versionName:y}}},{test:[/Macintosh(.*?) FxiOS(.*?)\//],describe:function(p){var g={name:f.OS_MAP.iOS},y=h.default.getSecondMatch(/(Version\/)(\d[\d.]+)/,p);return y&&(g.version=y),g}},{test:[/macintosh/i],describe:function(p){var g=h.default.getFirstMatch(/mac os x (\d+(\.?_?\d+)+)/i,p).replace(/[_\s]/g,"."),y=h.default.getMacOSVersionName(g),v={name:f.OS_MAP.MacOS,version:g};return y&&(v.versionName=y),v}},{test:[/(ipod|iphone|ipad)/i],describe:function(p){var g=h.default.getFirstMatch(/os (\d+([_\s]\d+)*) like mac os x/i,p).replace(/[_\s]/g,".");return{name:f.OS_MAP.iOS,version:g}}},{test:function(p){var g=!p.test(/like android/i),y=p.test(/android/i);return g&&y},describe:function(p){var g=h.default.getFirstMatch(/android[\s/-](\d+(\.\d+)*)/i,p),y=h.default.getAndroidVersionName(g),v={name:f.OS_MAP.Android,version:g};return y&&(v.versionName=y),v}},{test:[/(web|hpw)[o0]s/i],describe:function(p){var g=h.default.getFirstMatch(/(?:web|hpw)[o0]s\/(\d+(\.\d+)*)/i,p),y={name:f.OS_MAP.WebOS};return g&&g.length&&(y.version=g),y}},{test:[/blackberry|\bbb\d+/i,/rim\stablet/i],describe:function(p){var g=h.default.getFirstMatch(/rim\stablet\sos\s(\d+(\.\d+)*)/i,p)||h.default.getFirstMatch(/blackberry\d+\/(\d+([_\s]\d+)*)/i,p)||h.default.getFirstMatch(/\bbb(\d+)/i,p);return{name:f.OS_MAP.BlackBerry,version:g}}},{test:[/bada/i],describe:function(p){var g=h.default.getFirstMatch(/bada\/(\d+(\.\d+)*)/i,p);return{name:f.OS_MAP.Bada,version:g}}},{test:[/tizen/i],describe:function(p){var g=h.default.getFirstMatch(/tizen[/\s](\d+(\.\d+)*)/i,p);return{name:f.OS_MAP.Tizen,version:g}}},{test:[/linux/i],describe:function(){return{name:f.OS_MAP.Linux}}},{test:[/CrOS/],describe:function(){return{name:f.OS_MAP.ChromeOS}}},{test:[/PlayStation 4/],describe:function(p){var g=h.default.getFirstMatch(/PlayStation 4[/\s](\d+(\.\d+)*)/i,p);return{name:f.OS_MAP.PlayStation4,version:g}}}];c.default=d,o.exports=c.default},94:function(o,c,l){c.__esModule=!0,c.default=void 0;var u,h=(u=l(17))&&u.__esModule?u:{default:u},f=l(18),d=[{test:[/googlebot/i],describe:function(){return{type:"bot",vendor:"Google"}}},{test:[/huawei/i],describe:function(p){var g=h.default.getFirstMatch(/(can-l01)/i,p)&&"Nova",y={type:f.PLATFORMS_MAP.mobile,vendor:"Huawei"};return g&&(y.model=g),y}},{test:[/nexus\s*(?:7|8|9|10).*/i],describe:function(){return{type:f.PLATFORMS_MAP.tablet,vendor:"Nexus"}}},{test:[/ipad/i],describe:function(){return{type:f.PLATFORMS_MAP.tablet,vendor:"Apple",model:"iPad"}}},{test:[/Macintosh(.*?) FxiOS(.*?)\//],describe:function(){return{type:f.PLATFORMS_MAP.tablet,vendor:"Apple",model:"iPad"}}},{test:[/kftt build/i],describe:function(){return{type:f.PLATFORMS_MAP.tablet,vendor:"Amazon",model:"Kindle Fire HD 7"}}},{test:[/silk/i],describe:function(){return{type:f.PLATFORMS_MAP.tablet,vendor:"Amazon"}}},{test:[/tablet(?! pc)/i],describe:function(){return{type:f.PLATFORMS_MAP.tablet}}},{test:function(p){var g=p.test(/ipod|iphone/i),y=p.test(/like (ipod|iphone)/i);return g&&!y},describe:function(p){var g=h.default.getFirstMatch(/(ipod|iphone)/i,p);return{type:f.PLATFORMS_MAP.mobile,vendor:"Apple",model:g}}},{test:[/nexus\s*[0-6].*/i,/galaxy nexus/i],describe:function(){return{type:f.PLATFORMS_MAP.mobile,vendor:"Nexus"}}},{test:[/[^-]mobi/i],describe:function(){return{type:f.PLATFORMS_MAP.mobile}}},{test:function(p){return p.getBrowserName(!0)==="blackberry"},describe:function(){return{type:f.PLATFORMS_MAP.mobile,vendor:"BlackBerry"}}},{test:function(p){return p.getBrowserName(!0)==="bada"},describe:function(){return{type:f.PLATFORMS_MAP.mobile}}},{test:function(p){return p.getBrowserName()==="windows phone"},describe:function(){return{type:f.PLATFORMS_MAP.mobile,vendor:"Microsoft"}}},{test:function(p){var g=Number(String(p.getOSVersion()).split(".")[0]);return p.getOSName(!0)==="android"&&g>=3},describe:function(){return{type:f.PLATFORMS_MAP.tablet}}},{test:function(p){return p.getOSName(!0)==="android"},describe:function(){return{type:f.PLATFORMS_MAP.mobile}}},{test:function(p){return p.getOSName(!0)==="macos"},describe:function(){return{type:f.PLATFORMS_MAP.desktop,vendor:"Apple"}}},{test:function(p){return p.getOSName(!0)==="windows"},describe:function(){return{type:f.PLATFORMS_MAP.desktop}}},{test:function(p){return p.getOSName(!0)==="linux"},describe:function(){return{type:f.PLATFORMS_MAP.desktop}}},{test:function(p){return p.getOSName(!0)==="playstation 4"},describe:function(){return{type:f.PLATFORMS_MAP.tv}}},{test:function(p){return p.getOSName(!0)==="roku"},describe:function(){return{type:f.PLATFORMS_MAP.tv}}}];c.default=d,o.exports=c.default},95:function(o,c,l){c.__esModule=!0,c.default=void 0;var u,h=(u=l(17))&&u.__esModule?u:{default:u},f=l(18),d=[{test:function(p){return p.getBrowserName(!0)==="microsoft edge"},describe:function(p){if(/\sedg\//i.test(p))return{name:f.ENGINE_MAP.Blink};var g=h.default.getFirstMatch(/edge\/(\d+(\.?_?\d+)+)/i,p);return{name:f.ENGINE_MAP.EdgeHTML,version:g}}},{test:[/trident/i],describe:function(p){var g={name:f.ENGINE_MAP.Trident},y=h.default.getFirstMatch(/trident\/(\d+(\.?_?\d+)+)/i,p);return y&&(g.version=y),g}},{test:function(p){return p.test(/presto/i)},describe:function(p){var g={name:f.ENGINE_MAP.Presto},y=h.default.getFirstMatch(/presto\/(\d+(\.?_?\d+)+)/i,p);return y&&(g.version=y),g}},{test:function(p){var g=p.test(/gecko/i),y=p.test(/like gecko/i);return g&&!y},describe:function(p){var g={name:f.ENGINE_MAP.Gecko},y=h.default.getFirstMatch(/gecko\/(\d+(\.?_?\d+)+)/i,p);return y&&(g.version=y),g}},{test:[/(apple)?webkit\/537\.36/i],describe:function(){return{name:f.ENGINE_MAP.Blink}}},{test:[/(apple)?webkit/i],describe:function(p){var g={name:f.ENGINE_MAP.WebKit},y=h.default.getFirstMatch(/webkit\/(\d+(\.?_?\d+)+)/i,p);return y&&(g.version=y),g}}];c.default=d,o.exports=c.default}})},6729:a=>{var o=Object.prototype.hasOwnProperty,c="~";function l(){}function u(p,g,y){this.fn=p,this.context=g,this.once=y||!1}function h(p,g,y,v,b){if(typeof y!="function")throw new TypeError("The listener must be a function");var T=new u(y,v||p,b),x=c?c+g:g;return p._events[x]?p._events[x].fn?p._events[x]=[p._events[x],T]:p._events[x].push(T):(p._events[x]=T,p._eventsCount++),p}function f(p,g){--p._eventsCount==0?p._events=new l:delete p._events[g]}function d(){this._events=new l,this._eventsCount=0}Object.create&&(l.prototype=Object.create(null),new l().__proto__||(c=!1)),d.prototype.eventNames=function(){var p,g,y=[];if(this._eventsCount===0)return y;for(g in p=this._events)o.call(p,g)&&y.push(c?g.slice(1):g);return Object.getOwnPropertySymbols?y.concat(Object.getOwnPropertySymbols(p)):y},d.prototype.listeners=function(p){var g=c?c+p:p,y=this._events[g];if(!y)return[];if(y.fn)return[y.fn];for(var v=0,b=y.length,T=new Array(b);v<b;v++)T[v]=y[v].fn;return T},d.prototype.listenerCount=function(p){var g=c?c+p:p,y=this._events[g];return y?y.fn?1:y.length:0},d.prototype.emit=function(p,g,y,v,b,T){var x=c?c+p:p;if(!this._events[x])return!1;var M,R,I=this._events[x],k=arguments.length;if(I.fn){switch(I.once&&this.removeListener(p,I.fn,void 0,!0),k){case 1:return I.fn.call(I.context),!0;case 2:return I.fn.call(I.context,g),!0;case 3:return I.fn.call(I.context,g,y),!0;case 4:return I.fn.call(I.context,g,y,v),!0;case 5:return I.fn.call(I.context,g,y,v,b),!0;case 6:return I.fn.call(I.context,g,y,v,b,T),!0}for(R=1,M=new Array(k-1);R<k;R++)M[R-1]=arguments[R];I.fn.apply(I.context,M)}else{var P,U=I.length;for(R=0;R<U;R++)switch(I[R].once&&this.removeListener(p,I[R].fn,void 0,!0),k){case 1:I[R].fn.call(I[R].context);break;case 2:I[R].fn.call(I[R].context,g);break;case 3:I[R].fn.call(I[R].context,g,y);break;case 4:I[R].fn.call(I[R].context,g,y,v);break;default:if(!M)for(P=1,M=new Array(k-1);P<k;P++)M[P-1]=arguments[P];I[R].fn.apply(I[R].context,M)}}return!0},d.prototype.on=function(p,g,y){return h(this,p,g,y,!1)},d.prototype.once=function(p,g,y){return h(this,p,g,y,!0)},d.prototype.removeListener=function(p,g,y,v){var b=c?c+p:p;if(!this._events[b])return this;if(!g)return f(this,b),this;var T=this._events[b];if(T.fn)T.fn!==g||v&&!T.once||y&&T.context!==y||f(this,b);else{for(var x=0,M=[],R=T.length;x<R;x++)(T[x].fn!==g||v&&!T[x].once||y&&T[x].context!==y)&&M.push(T[x]);M.length?this._events[b]=M.length===1?M[0]:M:f(this,b)}return this},d.prototype.removeAllListeners=function(p){var g;return p?(g=c?c+p:p,this._events[g]&&f(this,g)):(this._events=new l,this._eventsCount=0),this},d.prototype.off=d.prototype.removeListener,d.prototype.addListener=d.prototype.on,d.prefixed=c,d.EventEmitter=d,a.exports=d},1564:a=>{var o;o=()=>(()=>{var c={228:u=>{var h=Object.prototype.hasOwnProperty,f="~";function d(){}function p(b,T,x){this.fn=b,this.context=T,this.once=x||!1}function g(b,T,x,M,R){if(typeof x!="function")throw new TypeError("The listener must be a function");var I=new p(x,M||b,R),k=f?f+T:T;return b._events[k]?b._events[k].fn?b._events[k]=[b._events[k],I]:b._events[k].push(I):(b._events[k]=I,b._eventsCount++),b}function y(b,T){--b._eventsCount==0?b._events=new d:delete b._events[T]}function v(){this._events=new d,this._eventsCount=0}Object.create&&(d.prototype=Object.create(null),new d().__proto__||(f=!1)),v.prototype.eventNames=function(){var b,T,x=[];if(this._eventsCount===0)return x;for(T in b=this._events)h.call(b,T)&&x.push(f?T.slice(1):T);return Object.getOwnPropertySymbols?x.concat(Object.getOwnPropertySymbols(b)):x},v.prototype.listeners=function(b){var T=f?f+b:b,x=this._events[T];if(!x)return[];if(x.fn)return[x.fn];for(var M=0,R=x.length,I=new Array(R);M<R;M++)I[M]=x[M].fn;return I},v.prototype.listenerCount=function(b){var T=f?f+b:b,x=this._events[T];return x?x.fn?1:x.length:0},v.prototype.emit=function(b,T,x,M,R,I){var k=f?f+b:b;if(!this._events[k])return!1;var P,U,G=this._events[k],$=arguments.length;if(G.fn){switch(G.once&&this.removeListener(b,G.fn,void 0,!0),$){case 1:return G.fn.call(G.context),!0;case 2:return G.fn.call(G.context,T),!0;case 3:return G.fn.call(G.context,T,x),!0;case 4:return G.fn.call(G.context,T,x,M),!0;case 5:return G.fn.call(G.context,T,x,M,R),!0;case 6:return G.fn.call(G.context,T,x,M,R,I),!0}for(U=1,P=new Array($-1);U<$;U++)P[U-1]=arguments[U];G.fn.apply(G.context,P)}else{var q,Y=G.length;for(U=0;U<Y;U++)switch(G[U].once&&this.removeListener(b,G[U].fn,void 0,!0),$){case 1:G[U].fn.call(G[U].context);break;case 2:G[U].fn.call(G[U].context,T);break;case 3:G[U].fn.call(G[U].context,T,x);break;case 4:G[U].fn.call(G[U].context,T,x,M);break;default:if(!P)for(q=1,P=new Array($-1);q<$;q++)P[q-1]=arguments[q];G[U].fn.apply(G[U].context,P)}}return!0},v.prototype.on=function(b,T,x){return g(this,b,T,x,!1)},v.prototype.once=function(b,T,x){return g(this,b,T,x,!0)},v.prototype.removeListener=function(b,T,x,M){var R=f?f+b:b;if(!this._events[R])return this;if(!T)return y(this,R),this;var I=this._events[R];if(I.fn)I.fn!==T||M&&!I.once||x&&I.context!==x||y(this,R);else{for(var k=0,P=[],U=I.length;k<U;k++)(I[k].fn!==T||M&&!I[k].once||x&&I[k].context!==x)&&P.push(I[k]);P.length?this._events[R]=P.length===1?P[0]:P:y(this,R)}return this},v.prototype.removeAllListeners=function(b){var T;return b?(T=f?f+b:b,this._events[T]&&y(this,T)):(this._events=new d,this._eventsCount=0),this},v.prototype.off=v.prototype.removeListener,v.prototype.addListener=v.prototype.on,v.prefixed=f,v.EventEmitter=v,u.exports=v},815:function(u,h){var f,d,p=this&&this.__extends||(f=function(X,ee){return f=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(oe,fe){oe.__proto__=fe}||function(oe,fe){for(var Re in fe)Object.prototype.hasOwnProperty.call(fe,Re)&&(oe[Re]=fe[Re])},f(X,ee)},function(X,ee){if(typeof ee!="function"&&ee!==null)throw new TypeError("Class extends value "+String(ee)+" is not a constructor or null");function oe(){this.constructor=X}f(X,ee),X.prototype=ee===null?Object.create(ee):(oe.prototype=ee.prototype,new oe)});function g(X){return 60*X*60}function y(X){return 60*X*60*24}Object.defineProperty(h,"__esModule",{value:!0}),h.daysToSeconds=h.hoursToSeconds=h.ConfigurationHolder=h.ConfigurationManager=h.Env=void 0,function(X){X.BETA="beta",X.PROD="prod",X.CUSTOM="custom"}(d||(h.Env=d={})),h.hoursToSeconds=g,h.daysToSeconds=y;var v=function(X){function ee(oe){return X.call(this,oe)||this}return p(ee,X),ee}(Error),b="data",T="metrics",x=g(1),M=y(3),R=g(2),I="base64",k=function(){function X(ee,oe){var fe,Re,He,Te,Le,we,Ce,ke;if(!oe.fileKey)throw new Error("options.fileKey cannot be empty");var St=(fe=oe.clock)!==null&&fe!==void 0?fe:new ie,Mt=St.getMillis();switch(this.context=ee,this.fileKey=oe.fileKey,this.env=oe.standardEnv,oe.standardEnv){case d.BETA:this.fetchServer="beta.ivs-device-config-beta.live-video.net";break;case d.PROD:this.fetchServer="prod.ivs-device-config.live-video.net";break;case d.CUSTOM:if(!oe.customServer)throw new Error("Custom env requires options.customServer");this.fetchServer=oe.customServer;break;default:throw new Error("Invalid value for standardEnv: ".concat(oe.standardEnv))}this.trace=(Re=oe.trace)!==null&&Re!==void 0?Re:new $(this.env),this.fetch=(He=oe.fetch)!==null&&He!==void 0?He:new G(ee),this.storage=new Y("amazon_ivs_device_config_v1_"+oe.fileKey,ee.localStorage),this.state=new J(this.storage,"state"),this.refresh={refreshIntervalSeconds:(Te=oe.refresh.refreshIntervalSeconds)!==null&&Te!==void 0?Te:x,retryCount:(Le=oe.refresh.retryCount)!==null&&Le!==void 0?Le:3,retryIntervalSeconds:(we=oe.refresh.retryIntervalSeconds)!==null&&we!==void 0?we:10,maxCacheAgeSeconds:(Ce=oe.refresh.maxCacheAgeSeconds)!==null&&Ce!==void 0?Ce:M,stopRefreshAfterSeconds:(ke=oe.refresh.stopRefreshAfterSeconds)!==null&&ke!==void 0?ke:R,canRefreshNow:oe.refresh.canRefreshNow},this.clock=St,this.isInitialRefreshDone=!1;var Ee=0,_e=this.state.getState();_e&&_e.fetchServer===this.fetchServer&&_e.lastFetchWhenMs&&(Ee=_e.lastFetchWhenMs);var tt=St.getMillis(),de=(tt-Ee)/1e3;if(de<=this.refresh.maxCacheAgeSeconds){var Be=this.storage.getJson(b);Be&&Be.fetchServer===this.fetchServer&&this.setData(Be.json)}if(this.lastUseMs=tt,de>=this.refresh.refreshIntervalSeconds||Ee==0)this.trace.onTrace("Will start refresh right now"),this.fetchTask=this.context.setTimeout(this.startRefresh.bind(this),0);else{var Ie=Math.round(this.refresh.refreshIntervalSeconds-de);this.trace.onTrace("Will start refresh in "+Ie+" seconds"),this.fetchTask=this.context.setTimeout(this.startRefresh.bind(this),1e3*Ie),this.isInitialRefreshDone=!0}var rt=St.getMillis();this.initialLoadTime=rt-Mt}return X.getInstance=function(ee,oe){try{if(!(ee.fetch&&ee.setTimeout&&ee.clearTimeout&&ee.localStorage))return void console.log("Context needs to provide fetch, setTimeout, clearTimeout, localStorage")}catch(fe){return void console.error("Error checking for context properties "+fe)}if(this.gInstance){if(this.gInstance.fileKey!=oe.fileKey)throw new Error("Existing instance has file key ".concat(this.gInstance.fileKey,", now asking for ").concat(oe.fileKey));return this.gInstance}return this.gInstance=new X(ee,oe),this.gInstance},X.prototype.getConfigurationHolder=function(ee){var oe,fe=this,Re=this.clock.getMillis();this.lastUseMs=Re;var He=(oe=ee.analytics)!==null&&oe!==void 0?oe:new q(this.env);this.context.setTimeout(function(){fe.emitMetrics(He)});var Te=0,Le=this.state.getState();return Le&&Le.fetchServer===this.fetchServer&&Le.lastFetchWhenMs&&(Te=Le.lastFetchWhenMs),(Re-Te)/1e3<=this.refresh.maxCacheAgeSeconds?new P(He,this.properties):new P(He,void 0)},X.prototype.getFetchUrl=function(){var ee="https://".concat(this.fetchServer,"/").concat(this.fileKey,".json"),oe=new URL(ee);return oe.searchParams.set("version","1.0"),oe},X.clearInstance=function(){var ee;(ee=this.gInstance)===null||ee===void 0||ee.clearInstanceImpl(),this.gInstance=void 0},X.prototype.clearInstanceImpl=function(){this.context.clearTimeout(this.fetchTask),this.fetchTask=void 0,this.context.clearTimeout(this.retryTask),this.retryTask=void 0},X.prototype.startRefresh=function(){var ee=this;this.trace.onTrace("Starting refresh request..."),this.fetchTask=void 0,this.retryTask&&(this.context.clearTimeout(this.retryTask),this.retryTask=void 0);var oe=this.clock.getMillis();return(oe-this.lastUseMs)/1e3>this.refresh.stopRefreshAfterSeconds?(this.trace.onTrace("Actually will not refresh due to refresh timeout"),void(this.fetchTask=this.context.setTimeout(this.startRefresh.bind(this),1e3*this.refresh.refreshIntervalSeconds))):this.isInitialRefreshDone&&!this.refresh.canRefreshNow()?(this.trace.onTrace("Will not refresh due to callback having returned false"),void(this.fetchTask=this.context.setTimeout(this.startRefresh.bind(this),1e3*this.refresh.refreshIntervalSeconds))):void this.fetchData().then(function(fe){ee.processResponse(fe,oe)}).catch(function(fe){ee.exceptionMetrics(fe),ee.trace.onTrace("Fetch error: "+fe),ee.refresh.retryCount>0&&ee.scheduleRetry(1)}).finally(function(){ee.isInitialRefreshDone=!0,ee.fetchTask=ee.context.setTimeout(ee.startRefresh.bind(ee),1e3*ee.refresh.refreshIntervalSeconds)})},X.prototype.fetchData=function(){var ee=this.getFetchUrl(),oe=new Headers,fe=this.state.getState();return fe.fetchServer===this.fetchServer&&(fe.lastFetchWhenFullMs&&this.clock.getMillis()-fe.lastFetchWhenFullMs>1e3*g(24)?this.trace.onTrace("Forcing full refresh"):this.properties&&fe.lastFetchEtagHeader&&oe.set("If-None-Match",fe.lastFetchEtagHeader)),this.incrementMetrics("fetch_attempt_count"),this.fetch.fetchUrl(ee,oe)},X.prototype.processResponse=function(ee,oe){var fe={fetchServer:this.fetchServer,lastFetchWhenMs:this.clock.getMillis()},Re=ee.headers.get("etag");Re&&(fe.lastFetchEtagHeader=Re);try{if(ee.status<300&&ee.json)if(this.setData(ee.json)){this.trace.onTrace("Successfully parsed fetched data"),this.storage.setJson(b,{fetchServer:this.fetchServer,json:ee.json});var He=this.clock.getMillis();fe.lastFetchWhenFullMs=He,this.incrementMetricsWithDuration("success_new_data_count",He-oe)}else this.incrementMetrics("fail_invalid_data_count");else{if(ee.status!==304){var Te="Unexpected http fetch status: "+ee.status;throw this.trace.onTrace(Te),new v(Te)}this.trace.onTrace("Server said no change in data"),He=this.clock.getMillis(),this.incrementMetricsWithDuration("success_no_change_count",He-oe)}}finally{this.state.setState(fe)}},X.prototype.scheduleRetry=function(ee){var oe=this;this.retryTask&&this.context.clearTimeout(this.retryTask);var fe=ee*this.refresh.retryIntervalSeconds;this.retryTask=this.context.setTimeout(function(){oe.retryTask=void 0,oe.fetchRetry(ee)},1e3*fe)},X.prototype.fetchRetry=function(ee){var oe=this;this.trace.onTrace("Starting retry request ".concat(ee,"..."));var fe=this.clock.getMillis();this.fetchData().then(function(Re){oe.processResponse(Re,fe)}).catch(function(Re){oe.exceptionMetrics(Re),oe.trace.onTrace("Fetch error: "+Re),oe.refresh.retryCount>ee&&oe.scheduleRetry(ee+1)})},X.prototype.setData=function(ee){if(!ee)return!1;if(ee.version!=="1.0")return this.trace.onTrace("Data version is not 1.0, not applying"),!1;var oe=ee.properties;if(!oe||!Array.isArray(oe))return this.trace.onTrace("Data properties is not an array, not applying"),!1;for(var fe=new Map,Re=0,He=oe;Re<He.length;Re++){var Te=He[Re];if(Te.name&&Te.type&&this.isValidValueType(Te.type)){if(Te.value_string&&typeof Te.value_string!="string"){this.trace.onTrace("Invalid type of value.value_string "+typeof Te.value_string);continue}if(Te.value_number&&typeof Te.value_number!="number"){this.trace.onTrace("Invalid type of value.value_number "+typeof Te.value_number);continue}if(Te.value_boolean&&typeof Te.value_boolean!="boolean"){this.trace.onTrace("Invalid type of value.value_boolean "+typeof Te.value_boolean);continue}if(Te.value_json&&typeof Te.value_json!="string"){this.trace.onTrace("Invalid type of value.value_json "+typeof Te.value_json);continue}if(Te.value_analytics&&typeof Te.value_analytics!="string"){this.trace.onTrace("Invalid type of item.value_analytics "+typeof Te.value_analytics);continue}var Le=new V(Te.name,this.parseValueType(Te.type),Te.value_string,Te.value_number,Te.value_boolean,Te.value_json,Te.value_analytics,Te.encoding);fe.set(Le.name,Le)}}return fe.size!=0&&(this.properties=fe,!0)},X.prototype.isValidValueType=function(ee){return ee==="string"||ee==="number"||ee==="boolean"||ee=="json"},X.prototype.parseValueType=function(ee){switch(ee){case"string":return U.STRING;case"number":return U.NUMBER;case"boolean":return U.BOOLEAN;case"json":return U.JSON;default:throw new Error("Unsupported value type ".concat(ee))}},X.prototype.emitMetrics=function(ee){var oe,fe,Re,He,Te,Le,we,Ce,ke=(oe=this.storage.getJson(T))!==null&&oe!==void 0?oe:{},St={initial_load_time:this.initialLoadTime,fetch_attempt_count:(fe=ke.fetch_attempt_count)!==null&&fe!==void 0?fe:0,fetch_duration_average:(Re=ke.fetch_duration_average)!==null&&Re!==void 0?Re:0,success_no_change_count:(He=ke.success_no_change_count)!==null&&He!==void 0?He:0,success_new_data_count:(Te=ke.success_new_data_count)!==null&&Te!==void 0?Te:0,fail_exception_count:(Le=ke.fail_exception_count)!==null&&Le!==void 0?Le:0,fail_http_error_count:(we=ke.fail_http_error_count)!==null&&we!==void 0?we:0,fail_invalid_data_count:(Ce=ke.fail_invalid_data_count)!==null&&Ce!==void 0?Ce:0};ee.onMetrics(St),ke.fetch_attempt_count=0,ke.success_no_change_count=0,ke.success_new_data_count=0,ke.fail_exception_count=0,ke.fail_http_error_count=0,ke.fail_invalid_data_count=0,this.storage.setJson(T,ke)},X.prototype.exceptionMetrics=function(ee){ee instanceof v||ee.message.startsWith("http error")?this.incrementMetrics("fail_http_error_count"):this.incrementMetrics("fail_exception_count")},X.prototype.incrementMetrics=function(ee){var oe,fe,Re=(oe=this.storage.getJson(T))!==null&&oe!==void 0?oe:{};Re[ee]=((fe=Re[ee])!==null&&fe!==void 0?fe:0)+1,this.storage.setJson(T,Re)},X.prototype.incrementMetricsWithDuration=function(ee,oe){var fe,Re,He=(fe=this.storage.getJson(T))!==null&&fe!==void 0?fe:{};He[ee]=((Re=He[ee])!==null&&Re!==void 0?Re:0)+1,oe>0&&(He.fetch_duration_average!==void 0?He.fetch_duration_average=.9*He.fetch_duration_average+.1*oe|0:He.fetch_duration_average=oe),this.storage.setJson(T,He)},X}();h.ConfigurationManager=k;var P=function(){function X(ee,oe){this.analytics=ee,this.properties=oe}return X.prototype.getSize=function(){return this.properties?this.properties.size:-1},X.prototype.getStringValue=function(ee){var oe,fe;if(this.properties){var Re=this.properties.get(ee);if(Re){if(Re.type===U.STRING){var He=(oe=Re.valueString)!==null&&oe!==void 0?oe:"";return this.analytics.onValue(ee,(fe=Re.valueAnalytics)!==null&&fe!==void 0?fe:He),He}this.analytics.onError(ee,"Type is not string")}}else this.analytics.onTrace(ee,"Configuration is not available")},X.prototype.getNumberValue=function(ee){var oe,fe;if(this.properties){var Re=this.properties.get(ee);if(Re){if(Re.type===U.NUMBER){var He=(oe=Re.valueNumber)!==null&&oe!==void 0?oe:0;return this.analytics.onValue(ee,(fe=Re.valueAnalytics)!==null&&fe!==void 0?fe:He.toString()),He}this.analytics.onError(ee,"Type is not number")}}else this.analytics.onTrace(ee,"Configuration is not available")},X.prototype.getBooleanValue=function(ee){var oe,fe;if(this.properties){var Re=this.properties.get(ee);if(Re){if(Re.type===U.BOOLEAN){var He=(oe=Re.valueBoolean)!==null&&oe!==void 0&&oe;return this.analytics.onValue(ee,(fe=Re.valueAnalytics)!==null&&fe!==void 0?fe:He.toString()),He}this.analytics.onError(ee,"Type is not boolean")}}else this.analytics.onTrace(ee,"Configuration is not available")},X.prototype.getJsonValue=function(ee){var oe,fe;if(this.properties){var Re=this.properties.get(ee);if(Re){if(Re.type===U.JSON){var He=Re.valueJson;if(!He)return this.analytics.onValue(ee,(oe=Re.valueAnalytics)!==null&&oe!==void 0?oe:""),null;try{var Te=JSON.parse(He);return this.analytics.onValue(ee,(fe=Re.valueAnalytics)!==null&&fe!==void 0?fe:He),Te}catch{return void this.analytics.onError(ee,"Json parse error")}}this.analytics.onError(ee,"Type is not json")}}else this.analytics.onTrace(ee,"Configuration is not available")},X}();h.ConfigurationHolder=P;var U,G=function(){function X(ee){this.context=ee}return X.prototype.fetchUrl=function(ee,oe){var fe=this;return new Promise(function(Re,He){fe.context.fetch(ee,{headers:oe,cache:"no-store"}).then(function(Te){if(Te.status>=400)He(new v("http error ".concat(Te.status,", ").concat(Te.statusText)));else{var Le={status:Te.status,headers:Te.headers};Te.json().then(function(we){Le.json=we}).catch(function(){}).finally(function(){Re(Le)})}}).catch(function(Te){He(Te)})})},X}(),$=function(){function X(ee){this.env=ee}return X.prototype.onTrace=function(ee){this.env!=d.PROD&&console.log("Configuration: "+ee)},X}(),q=function(){function X(ee){this.env=ee}return X.prototype.onMetrics=function(ee){this.env!=d.PROD&&console.log("Metrics",ee)},X.prototype.onValue=function(ee,oe){this.env!=d.PROD&&console.log("Configuration for ".concat(ee,": value = ").concat(oe))},X.prototype.onError=function(ee,oe){this.env!=d.PROD&&console.error("Configuration for ".concat(ee,": error = ").concat(oe))},X.prototype.onTrace=function(ee,oe){this.env!=d.PROD&&console.log("Configuration for ".concat(ee,": trace = ").concat(oe))},X}(),Y=function(){function X(ee,oe){this.prefix=ee,this.storage=oe}return X.prototype.getJson=function(ee){var oe=this.prefix+"_"+ee;try{var fe=this.storage.getItem(oe);if(fe)return JSON.parse(fe)}catch(Re){console.error("Error getting local storage key ".concat(oe)+Re)}return null},X.prototype.setJson=function(ee,oe){var fe=this.prefix+"_"+ee;try{this.storage.setItem(fe,JSON.stringify(oe))}catch(Re){console.error("Error setting local storage key ".concat(fe,": ")+Re)}},X}(),ie=function(){function X(){}return X.prototype.getMillis=function(){return Date.now()},X}();(function(X){X[X.STRING=0]="STRING",X[X.NUMBER=1]="NUMBER",X[X.BOOLEAN=2]="BOOLEAN",X[X.JSON=3]="JSON"})(U||(U={}));var V=function(X,ee,oe,fe,Re,He,Te,Le){switch(this.name=X,this.type=ee,this.valueString=oe,this.valueNumber=fe,this.valueBoolean=Re,this.valueJson=He,this.valueAnalytics=Te,this.type){case U.STRING:Le===I&&oe&&(this.valueString=atob(oe));break;case U.JSON:Le===I&&He&&(this.valueJson=atob(He))}},J=function(){function X(ee,oe){var fe;this.storage=ee,this.key=oe,this.state=(fe=ee.getJson(oe))!==null&&fe!==void 0?fe:{}}return X.prototype.getState=function(){return this.state},X.prototype.setState=function(ee){Object.assign(this.state,ee),this.storage.setJson(this.key,this.state)},X}()},456:function(u,h,f){var d=this&&this.__createBinding||(Object.create?function(g,y,v,b){b===void 0&&(b=v);var T=Object.getOwnPropertyDescriptor(y,v);T&&!("get"in T?!y.__esModule:T.writable||T.configurable)||(T={enumerable:!0,get:function(){return y[v]}}),Object.defineProperty(g,b,T)}:function(g,y,v,b){b===void 0&&(b=v),g[b]=y[v]}),p=this&&this.__exportStar||function(g,y){for(var v in g)v==="default"||Object.prototype.hasOwnProperty.call(y,v)||d(y,g,v)};Object.defineProperty(h,"__esModule",{value:!0}),p(f(903),h)},903:function(u,h,f){var d=this&&this.__spreadArray||function(y,v,b){if(b||arguments.length===2)for(var T,x=0,M=v.length;x<M;x++)!T&&x in v||(T||(T=Array.prototype.slice.call(v,0,x)),T[x]=v[x]);return y.concat(T||Array.prototype.slice.call(v))};Object.defineProperty(h,"__esModule",{value:!0}),h.TypedEmitter=void 0;var p=f(228),g=function(){function y(v){var b=v.propagateErrors;this.emitter=new p.EventEmitter,this.propagateErrors=b!=null&&b}return y.prototype.on=function(v,b){b.call=this.wrapCall(v,b),this.emitter.on(v,b)},y.prototype.off=function(v,b){this.emitter.off(v,b)},y.prototype.emit=function(v){for(var b,T=[],x=1;x<arguments.length;x++)T[x-1]=arguments[x];(b=this.emitter).emit.apply(b,d([v],T,!1))},y.prototype.removeAllListeners=function(){this.emitter.removeAllListeners()},y.prototype.wrapCall=function(v,b){var T=this;return function(x){for(var M=[],R=1;R<arguments.length;R++)M[R-1]=arguments[R];if(T.propagateErrors)b.apply(x,M);else try{b.apply(x,M)}catch(P){var I="Error in callback for ".concat(v),k=b.name;return k&&(I+=" for function ".concat(k)),void console.error(I,P)}}},y}();h.TypedEmitter=g},987:function(u,h,f){var d,p=this&&this.__extends||(d=function(M,R){return d=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(I,k){I.__proto__=k}||function(I,k){for(var P in k)Object.prototype.hasOwnProperty.call(k,P)&&(I[P]=k[P])},d(M,R)},function(M,R){if(typeof R!="function"&&R!==null)throw new TypeError("Class extends value "+String(R)+" is not a constructor or null");function I(){this.constructor=M}d(M,R),M.prototype=R===null?Object.create(R):(I.prototype=R.prototype,new I)}),g=this&&this.__createBinding||(Object.create?function(M,R,I,k){k===void 0&&(k=I);var P=Object.getOwnPropertyDescriptor(R,I);P&&!("get"in P?!R.__esModule:P.writable||P.configurable)||(P={enumerable:!0,get:function(){return R[I]}}),Object.defineProperty(M,k,P)}:function(M,R,I,k){k===void 0&&(k=I),M[k]=R[I]}),y=this&&this.__setModuleDefault||(Object.create?function(M,R){Object.defineProperty(M,"default",{enumerable:!0,value:R})}:function(M,R){M.default=R}),v=this&&this.__importStar||function(M){if(M&&M.__esModule)return M;var R={};if(M!=null)for(var I in M)I!=="default"&&Object.prototype.hasOwnProperty.call(M,I)&&g(R,M,I);return y(R,M),R};Object.defineProperty(h,"__esModule",{value:!0}),h.createFsm=h.FsmWildcardState=h.RejectedTransitionError=h.InvalidStateTransitionError=void 0;var b=v(f(293)),T=function(M){function R(I,k){var P=M.call(this,"Invalid transition from '".concat(k,"' via event '").concat(I,"'"))||this;return P.name="InvalidStateTransitionError",P}return p(R,M),R}(Error);h.InvalidStateTransitionError=T;var x=function(M){function R(I,k,P){var U=M.call(this,"Transition from '".concat(k,"' via event '").concat(I,"' was rejected for: ").concat(P))||this;return U.name="RejectedTransitionError",U}return p(R,M),R}(Error);h.RejectedTransitionError=x,h.FsmWildcardState="*",h.createFsm=function(M){var R,I=M.transitions,k=M.callbacks,P=M.initialState,U=function(G){var $,q=($=I[G])===null||$===void 0?void 0:$.from;return!!q&&(typeof q=="string"?q===h.FsmWildcardState:q.includes(P))};return{canTransition:U,transition:function(G,$){var q,Y,ie,V,J,X;if(!U(G))return b.err(new T(String(P),String(G)));var ee=I[G];return ee.shouldTransition===void 0||ee.shouldTransition(P)?((Y=(q=k==null?void 0:k[P])===null||q===void 0?void 0:q.onExiting)===null||Y===void 0||Y.call(q),(ie=k==null?void 0:k.onStateExiting)===null||ie===void 0||ie.call(k,P),R=P,P=ee.to,(J=(V=k==null?void 0:k[P])===null||V===void 0?void 0:V.onChanged)===null||J===void 0||J.call(V,R,$),(X=k==null?void 0:k.onStateChanged)===null||X===void 0||X.call(k,R,P,$),b.ok(P)):b.err(new x(String(P),String(G),"shouldTransition returned false"))},previousState:function(){return R},currentState:function(){return P}}}},156:function(u,h,f){var d=this&&this.__createBinding||(Object.create?function(g,y,v,b){b===void 0&&(b=v);var T=Object.getOwnPropertyDescriptor(y,v);T&&!("get"in T?!y.__esModule:T.writable||T.configurable)||(T={enumerable:!0,get:function(){return y[v]}}),Object.defineProperty(g,b,T)}:function(g,y,v,b){b===void 0&&(b=v),g[b]=y[v]}),p=this&&this.__exportStar||function(g,y){for(var v in g)v==="default"||Object.prototype.hasOwnProperty.call(y,v)||d(y,g,v)};Object.defineProperty(h,"__esModule",{value:!0}),h.VERSION=void 0,h.VERSION="0.2.0",p(f(815),h),p(f(456),h),p(f(987),h),p(f(293),h)},293:(u,h)=>{Object.defineProperty(h,"__esModule",{value:!0}),h.getErr=h.getOk_or=h.getOk=h.isNotOk=h.isOk=h.err=h.ok=void 0,h.ok=function(f){return{ok:!0,value:f}},h.err=function(f){return{ok:!1,error:f}},h.isOk=function(f){return f.ok===!0},h.isNotOk=function(f){return!(0,h.isOk)(f)},h.getOk=function(f){return f.ok===!0?f.value:void 0},h.getOk_or=function(f,d){return f.ok===!0?f.value:d},h.getErr=function(f){return f.ok===!0?void 0:f.error}}},l={};return function u(h){var f=l[h];if(f!==void 0)return f.exports;var d=l[h]={exports:{}};return c[h].call(d.exports,d,d.exports,u),d.exports}(156)})(),a.exports=o()},1989:(a,o,c)=>{var l=c(1789),u=c(401),h=c(7667),f=c(1327),d=c(1866);function p(g){var y=-1,v=g==null?0:g.length;for(this.clear();++y<v;){var b=g[y];this.set(b[0],b[1])}}p.prototype.clear=l,p.prototype.delete=u,p.prototype.get=h,p.prototype.has=f,p.prototype.set=d,a.exports=p},8407:(a,o,c)=>{var l=c(7040),u=c(4125),h=c(2117),f=c(7518),d=c(4705);function p(g){var y=-1,v=g==null?0:g.length;for(this.clear();++y<v;){var b=g[y];this.set(b[0],b[1])}}p.prototype.clear=l,p.prototype.delete=u,p.prototype.get=h,p.prototype.has=f,p.prototype.set=d,a.exports=p},7071:(a,o,c)=>{var l=c(852)(c(5639),"Map");a.exports=l},3369:(a,o,c)=>{var l=c(4785),u=c(1285),h=c(6e3),f=c(9916),d=c(5265);function p(g){var y=-1,v=g==null?0:g.length;for(this.clear();++y<v;){var b=g[y];this.set(b[0],b[1])}}p.prototype.clear=l,p.prototype.delete=u,p.prototype.get=h,p.prototype.has=f,p.prototype.set=d,a.exports=p},6384:(a,o,c)=>{var l=c(8407),u=c(7465),h=c(3779),f=c(7599),d=c(4758),p=c(4309);function g(y){var v=this.__data__=new l(y);this.size=v.size}g.prototype.clear=u,g.prototype.delete=h,g.prototype.get=f,g.prototype.has=d,g.prototype.set=p,a.exports=g},2705:(a,o,c)=>{var l=c(5639).Symbol;a.exports=l},1149:(a,o,c)=>{var l=c(5639).Uint8Array;a.exports=l},6874:a=>{a.exports=function(o,c,l){switch(l.length){case 0:return o.call(c);case 1:return o.call(c,l[0]);case 2:return o.call(c,l[0],l[1]);case 3:return o.call(c,l[0],l[1],l[2])}return o.apply(c,l)}},4636:(a,o,c)=>{var l=c(2545),u=c(5694),h=c(1469),f=c(4144),d=c(5776),p=c(6719),g=Object.prototype.hasOwnProperty;a.exports=function(y,v){var b=h(y),T=!b&&u(y),x=!b&&!T&&f(y),M=!b&&!T&&!x&&p(y),R=b||T||x||M,I=R?l(y.length,String):[],k=I.length;for(var P in y)!v&&!g.call(y,P)||R&&(P=="length"||x&&(P=="offset"||P=="parent")||M&&(P=="buffer"||P=="byteLength"||P=="byteOffset")||d(P,k))||I.push(P);return I}},6556:(a,o,c)=>{var l=c(9465),u=c(7813);a.exports=function(h,f,d){(d!==void 0&&!u(h[f],d)||d===void 0&&!(f in h))&&l(h,f,d)}},4865:(a,o,c)=>{var l=c(9465),u=c(7813),h=Object.prototype.hasOwnProperty;a.exports=function(f,d,p){var g=f[d];h.call(f,d)&&u(g,p)&&(p!==void 0||d in f)||l(f,d,p)}},8470:(a,o,c)=>{var l=c(7813);a.exports=function(u,h){for(var f=u.length;f--;)if(l(u[f][0],h))return f;return-1}},9465:(a,o,c)=>{var l=c(8777);a.exports=function(u,h,f){h=="__proto__"&&l?l(u,h,{configurable:!0,enumerable:!0,value:f,writable:!0}):u[h]=f}},3118:(a,o,c)=>{var l=c(3218),u=Object.create,h=function(){function f(){}return function(d){if(!l(d))return{};if(u)return u(d);f.prototype=d;var p=new f;return f.prototype=void 0,p}}();a.exports=h},8483:(a,o,c)=>{var l=c(5063)();a.exports=l},4239:(a,o,c)=>{var l=c(2705),u=c(9607),h=c(2333),f="[object Null]",d="[object Undefined]",p=l?l.toStringTag:void 0;a.exports=function(g){return g==null?g===void 0?d:f:p&&p in Object(g)?u(g):h(g)}},9454:(a,o,c)=>{var l=c(4239),u=c(7005),h="[object Arguments]";a.exports=function(f){return u(f)&&l(f)==h}},8458:(a,o,c)=>{var l=c(3560),u=c(5346),h=c(3218),f=c(346),d=/^\[object .+?Constructor\]$/,p=Function.prototype,g=Object.prototype,y=p.toString,v=g.hasOwnProperty,b=RegExp("^"+y.call(v).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");a.exports=function(T){return!(!h(T)||u(T))&&(l(T)?b:d).test(f(T))}},8749:(a,o,c)=>{var l=c(4239),u=c(1780),h=c(7005),f={};f["[object Float32Array]"]=f["[object Float64Array]"]=f["[object Int8Array]"]=f["[object Int16Array]"]=f["[object Int32Array]"]=f["[object Uint8Array]"]=f["[object Uint8ClampedArray]"]=f["[object Uint16Array]"]=f["[object Uint32Array]"]=!0,f["[object Arguments]"]=f["[object Array]"]=f["[object ArrayBuffer]"]=f["[object Boolean]"]=f["[object DataView]"]=f["[object Date]"]=f["[object Error]"]=f["[object Function]"]=f["[object Map]"]=f["[object Number]"]=f["[object Object]"]=f["[object RegExp]"]=f["[object Set]"]=f["[object String]"]=f["[object WeakMap]"]=!1,a.exports=function(d){return h(d)&&u(d.length)&&!!f[l(d)]}},313:(a,o,c)=>{var l=c(3218),u=c(5726),h=c(3498),f=Object.prototype.hasOwnProperty;a.exports=function(d){if(!l(d))return h(d);var p=u(d),g=[];for(var y in d)(y!="constructor"||!p&&f.call(d,y))&&g.push(y);return g}},2980:(a,o,c)=>{var l=c(6384),u=c(6556),h=c(8483),f=c(9783),d=c(3218),p=c(1704),g=c(6390);a.exports=function y(v,b,T,x,M){v!==b&&h(b,function(R,I){if(M||(M=new l),d(R))f(v,b,I,T,y,x,M);else{var k=x?x(g(v,I),R,I+"",v,b,M):void 0;k===void 0&&(k=R),u(v,I,k)}},p)}},9783:(a,o,c)=>{var l=c(6556),u=c(4626),h=c(7133),f=c(278),d=c(8517),p=c(5694),g=c(1469),y=c(9246),v=c(4144),b=c(3560),T=c(3218),x=c(8630),M=c(6719),R=c(6390),I=c(9881);a.exports=function(k,P,U,G,$,q,Y){var ie=R(k,U),V=R(P,U),J=Y.get(V);if(J)l(k,U,J);else{var X=q?q(ie,V,U+"",k,P,Y):void 0,ee=X===void 0;if(ee){var oe=g(V),fe=!oe&&v(V),Re=!oe&&!fe&&M(V);X=V,oe||fe||Re?g(ie)?X=ie:y(ie)?X=f(ie):fe?(ee=!1,X=u(V,!0)):Re?(ee=!1,X=h(V,!0)):X=[]:x(V)||p(V)?(X=ie,p(ie)?X=I(ie):T(ie)&&!b(ie)||(X=d(V))):ee=!1}ee&&(Y.set(V,X),$(X,V,G,q,Y),Y.delete(V)),l(k,U,X)}}},5976:(a,o,c)=>{var l=c(6557),u=c(5357),h=c(61);a.exports=function(f,d){return h(u(f,d,l),f+"")}},6560:(a,o,c)=>{var l=c(5703),u=c(8777),h=c(6557),f=u?function(d,p){return u(d,"toString",{configurable:!0,enumerable:!1,value:l(p),writable:!0})}:h;a.exports=f},2545:a=>{a.exports=function(o,c){for(var l=-1,u=Array(o);++l<o;)u[l]=c(l);return u}},1717:a=>{a.exports=function(o){return function(c){return o(c)}}},4318:(a,o,c)=>{var l=c(1149);a.exports=function(u){var h=new u.constructor(u.byteLength);return new l(h).set(new l(u)),h}},4626:(a,o,c)=>{a=c.nmd(a);var l=c(5639),u=o&&!o.nodeType&&o,h=u&&a&&!a.nodeType&&a,f=h&&h.exports===u?l.Buffer:void 0,d=f?f.allocUnsafe:void 0;a.exports=function(p,g){if(g)return p.slice();var y=p.length,v=d?d(y):new p.constructor(y);return p.copy(v),v}},7133:(a,o,c)=>{var l=c(4318);a.exports=function(u,h){var f=h?l(u.buffer):u.buffer;return new u.constructor(f,u.byteOffset,u.length)}},278:a=>{a.exports=function(o,c){var l=-1,u=o.length;for(c||(c=Array(u));++l<u;)c[l]=o[l];return c}},8363:(a,o,c)=>{var l=c(4865),u=c(9465);a.exports=function(h,f,d,p){var g=!d;d||(d={});for(var y=-1,v=f.length;++y<v;){var b=f[y],T=p?p(d[b],h[b],b,d,h):void 0;T===void 0&&(T=h[b]),g?u(d,b,T):l(d,b,T)}return d}},4429:(a,o,c)=>{var l=c(5639)["__core-js_shared__"];a.exports=l},1463:(a,o,c)=>{var l=c(5976),u=c(6612);a.exports=function(h){return l(function(f,d){var p=-1,g=d.length,y=g>1?d[g-1]:void 0,v=g>2?d[2]:void 0;for(y=h.length>3&&typeof y=="function"?(g--,y):void 0,v&&u(d[0],d[1],v)&&(y=g<3?void 0:y,g=1),f=Object(f);++p<g;){var b=d[p];b&&h(f,b,p,y)}return f})}},5063:a=>{a.exports=function(o){return function(c,l,u){for(var h=-1,f=Object(c),d=u(c),p=d.length;p--;){var g=d[o?p:++h];if(l(f[g],g,f)===!1)break}return c}}},8777:(a,o,c)=>{var l=c(852),u=function(){try{var h=l(Object,"defineProperty");return h({},"",{}),h}catch{}}();a.exports=u},1957:(a,o,c)=>{var l=typeof c.g=="object"&&c.g&&c.g.Object===Object&&c.g;a.exports=l},5050:(a,o,c)=>{var l=c(7019);a.exports=function(u,h){var f=u.__data__;return l(h)?f[typeof h=="string"?"string":"hash"]:f.map}},852:(a,o,c)=>{var l=c(8458),u=c(7801);a.exports=function(h,f){var d=u(h,f);return l(d)?d:void 0}},5924:(a,o,c)=>{var l=c(5569)(Object.getPrototypeOf,Object);a.exports=l},9607:(a,o,c)=>{var l=c(2705),u=Object.prototype,h=u.hasOwnProperty,f=u.toString,d=l?l.toStringTag:void 0;a.exports=function(p){var g=h.call(p,d),y=p[d];try{p[d]=void 0;var v=!0}catch{}var b=f.call(p);return v&&(g?p[d]=y:delete p[d]),b}},7801:a=>{a.exports=function(o,c){return o==null?void 0:o[c]}},1789:(a,o,c)=>{var l=c(4536);a.exports=function(){this.__data__=l?l(null):{},this.size=0}},401:a=>{a.exports=function(o){var c=this.has(o)&&delete this.__data__[o];return this.size-=c?1:0,c}},7667:(a,o,c)=>{var l=c(4536),u="__lodash_hash_undefined__",h=Object.prototype.hasOwnProperty;a.exports=function(f){var d=this.__data__;if(l){var p=d[f];return p===u?void 0:p}return h.call(d,f)?d[f]:void 0}},1327:(a,o,c)=>{var l=c(4536),u=Object.prototype.hasOwnProperty;a.exports=function(h){var f=this.__data__;return l?f[h]!==void 0:u.call(f,h)}},1866:(a,o,c)=>{var l=c(4536),u="__lodash_hash_undefined__";a.exports=function(h,f){var d=this.__data__;return this.size+=this.has(h)?0:1,d[h]=l&&f===void 0?u:f,this}},8517:(a,o,c)=>{var l=c(3118),u=c(5924),h=c(5726);a.exports=function(f){return typeof f.constructor!="function"||h(f)?{}:l(u(f))}},5776:a=>{var o=9007199254740991,c=/^(?:0|[1-9]\d*)$/;a.exports=function(l,u){var h=typeof l;return!!(u=u??o)&&(h=="number"||h!="symbol"&&c.test(l))&&l>-1&&l%1==0&&l<u}},6612:(a,o,c)=>{var l=c(7813),u=c(8612),h=c(5776),f=c(3218);a.exports=function(d,p,g){if(!f(g))return!1;var y=typeof p;return!!(y=="number"?u(g)&&h(p,g.length):y=="string"&&p in g)&&l(g[p],d)}},7019:a=>{a.exports=function(o){var c=typeof o;return c=="string"||c=="number"||c=="symbol"||c=="boolean"?o!=="__proto__":o===null}},5346:(a,o,c)=>{var l,u=c(4429),h=(l=/[^.]+$/.exec(u&&u.keys&&u.keys.IE_PROTO||""))?"Symbol(src)_1."+l:"";a.exports=function(f){return!!h&&h in f}},5726:a=>{var o=Object.prototype;a.exports=function(c){var l=c&&c.constructor;return c===(typeof l=="function"&&l.prototype||o)}},7040:a=>{a.exports=function(){this.__data__=[],this.size=0}},4125:(a,o,c)=>{var l=c(8470),u=Array.prototype.splice;a.exports=function(h){var f=this.__data__,d=l(f,h);return!(d<0)&&(d==f.length-1?f.pop():u.call(f,d,1),--this.size,!0)}},2117:(a,o,c)=>{var l=c(8470);a.exports=function(u){var h=this.__data__,f=l(h,u);return f<0?void 0:h[f][1]}},7518:(a,o,c)=>{var l=c(8470);a.exports=function(u){return l(this.__data__,u)>-1}},4705:(a,o,c)=>{var l=c(8470);a.exports=function(u,h){var f=this.__data__,d=l(f,u);return d<0?(++this.size,f.push([u,h])):f[d][1]=h,this}},4785:(a,o,c)=>{var l=c(1989),u=c(8407),h=c(7071);a.exports=function(){this.size=0,this.__data__={hash:new l,map:new(h||u),string:new l}}},1285:(a,o,c)=>{var l=c(5050);a.exports=function(u){var h=l(this,u).delete(u);return this.size-=h?1:0,h}},6e3:(a,o,c)=>{var l=c(5050);a.exports=function(u){return l(this,u).get(u)}},9916:(a,o,c)=>{var l=c(5050);a.exports=function(u){return l(this,u).has(u)}},5265:(a,o,c)=>{var l=c(5050);a.exports=function(u,h){var f=l(this,u),d=f.size;return f.set(u,h),this.size+=f.size==d?0:1,this}},4536:(a,o,c)=>{var l=c(852)(Object,"create");a.exports=l},3498:a=>{a.exports=function(o){var c=[];if(o!=null)for(var l in Object(o))c.push(l);return c}},1167:(a,o,c)=>{a=c.nmd(a);var l=c(1957),u=o&&!o.nodeType&&o,h=u&&a&&!a.nodeType&&a,f=h&&h.exports===u&&l.process,d=function(){try{var p=h&&h.require&&h.require("util").types;return p||f&&f.binding&&f.binding("util")}catch{}}();a.exports=d},2333:a=>{var o=Object.prototype.toString;a.exports=function(c){return o.call(c)}},5569:a=>{a.exports=function(o,c){return function(l){return o(c(l))}}},5357:(a,o,c)=>{var l=c(6874),u=Math.max;a.exports=function(h,f,d){return f=u(f===void 0?h.length-1:f,0),function(){for(var p=arguments,g=-1,y=u(p.length-f,0),v=Array(y);++g<y;)v[g]=p[f+g];g=-1;for(var b=Array(f+1);++g<f;)b[g]=p[g];return b[f]=d(v),l(h,this,b)}}},5639:(a,o,c)=>{var l=c(1957),u=typeof self=="object"&&self&&self.Object===Object&&self,h=l||u||Function("return this")();a.exports=h},6390:a=>{a.exports=function(o,c){if((c!=="constructor"||typeof o[c]!="function")&&c!="__proto__")return o[c]}},61:(a,o,c)=>{var l=c(6560),u=c(1275)(l);a.exports=u},1275:a=>{var o=800,c=16,l=Date.now;a.exports=function(u){var h=0,f=0;return function(){var d=l(),p=c-(d-f);if(f=d,p>0){if(++h>=o)return arguments[0]}else h=0;return u.apply(void 0,arguments)}}},7465:(a,o,c)=>{var l=c(8407);a.exports=function(){this.__data__=new l,this.size=0}},3779:a=>{a.exports=function(o){var c=this.__data__,l=c.delete(o);return this.size=c.size,l}},7599:a=>{a.exports=function(o){return this.__data__.get(o)}},4758:a=>{a.exports=function(o){return this.__data__.has(o)}},4309:(a,o,c)=>{var l=c(8407),u=c(7071),h=c(3369),f=200;a.exports=function(d,p){var g=this.__data__;if(g instanceof l){var y=g.__data__;if(!u||y.length<f-1)return y.push([d,p]),this.size=++g.size,this;g=this.__data__=new h(y)}return g.set(d,p),this.size=g.size,this}},346:a=>{var o=Function.prototype.toString;a.exports=function(c){if(c!=null){try{return o.call(c)}catch{}try{return c+""}catch{}}return""}},5703:a=>{a.exports=function(o){return function(){return o}}},7813:a=>{a.exports=function(o,c){return o===c||o!=o&&c!=c}},6557:a=>{a.exports=function(o){return o}},5694:(a,o,c)=>{var l=c(9454),u=c(7005),h=Object.prototype,f=h.hasOwnProperty,d=h.propertyIsEnumerable,p=l(function(){return arguments}())?l:function(g){return u(g)&&f.call(g,"callee")&&!d.call(g,"callee")};a.exports=p},1469:a=>{var o=Array.isArray;a.exports=o},8612:(a,o,c)=>{var l=c(3560),u=c(1780);a.exports=function(h){return h!=null&&u(h.length)&&!l(h)}},9246:(a,o,c)=>{var l=c(8612),u=c(7005);a.exports=function(h){return u(h)&&l(h)}},4144:(a,o,c)=>{a=c.nmd(a);var l=c(5639),u=c(5062),h=o&&!o.nodeType&&o,f=h&&a&&!a.nodeType&&a,d=f&&f.exports===h?l.Buffer:void 0,p=(d?d.isBuffer:void 0)||u;a.exports=p},3560:(a,o,c)=>{var l=c(4239),u=c(3218),h="[object AsyncFunction]",f="[object Function]",d="[object GeneratorFunction]",p="[object Proxy]";a.exports=function(g){if(!u(g))return!1;var y=l(g);return y==f||y==d||y==h||y==p}},1780:a=>{var o=9007199254740991;a.exports=function(c){return typeof c=="number"&&c>-1&&c%1==0&&c<=o}},3218:a=>{a.exports=function(o){var c=typeof o;return o!=null&&(c=="object"||c=="function")}},7005:a=>{a.exports=function(o){return o!=null&&typeof o=="object"}},8630:(a,o,c)=>{var l=c(4239),u=c(5924),h=c(7005),f="[object Object]",d=Function.prototype,p=Object.prototype,g=d.toString,y=p.hasOwnProperty,v=g.call(Object);a.exports=function(b){if(!h(b)||l(b)!=f)return!1;var T=u(b);if(T===null)return!0;var x=y.call(T,"constructor")&&T.constructor;return typeof x=="function"&&x instanceof x&&g.call(x)==v}},6719:(a,o,c)=>{var l=c(8749),u=c(1717),h=c(1167),f=h&&h.isTypedArray,d=f?u(f):l;a.exports=d},1704:(a,o,c)=>{var l=c(4636),u=c(313),h=c(8612);a.exports=function(f){return h(f)?l(f,!0):u(f)}},6486:function(a,o,c){var l;a=c.nmd(a),(function(){var u,h="Expected a function",f="__lodash_hash_undefined__",d="__lodash_placeholder__",p=16,g=32,y=64,v=128,b=256,T=1/0,x=9007199254740991,M=NaN,R=4294967295,I=[["ary",v],["bind",1],["bindKey",2],["curry",8],["curryRight",p],["flip",512],["partial",g],["partialRight",y],["rearg",b]],k="[object Arguments]",P="[object Array]",U="[object Boolean]",G="[object Date]",$="[object Error]",q="[object Function]",Y="[object GeneratorFunction]",ie="[object Map]",V="[object Number]",J="[object Object]",X="[object Promise]",ee="[object RegExp]",oe="[object Set]",fe="[object String]",Re="[object Symbol]",He="[object WeakMap]",Te="[object ArrayBuffer]",Le="[object DataView]",we="[object Float32Array]",Ce="[object Float64Array]",ke="[object Int8Array]",St="[object Int16Array]",Mt="[object Int32Array]",Ee="[object Uint8Array]",_e="[object Uint8ClampedArray]",tt="[object Uint16Array]",de="[object Uint32Array]",Be=/\b__p \+= '';/g,Ie=/\b(__p \+=) '' \+/g,rt=/(__e\(.*?\)|\b__t\)) \+\n'';/g,ft=/&(?:amp|lt|gt|quot|#39);/g,gt=/[&<>"']/g,bt=RegExp(ft.source),be=RegExp(gt.source),ue=/<%-([\s\S]+?)%>/g,Xe=/<%([\s\S]+?)%>/g,it=/<%=([\s\S]+?)%>/g,$e=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Ue=/^\w*$/,qt=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Ot=/[\\^$.*+?()[\]{}|]/g,Yt=RegExp(Ot.source),ce=/^\s+/,j=/\s/,W=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,me=/\{\n\/\* \[wrapped with (.+)\] \*/,De=/,? & /,Ve=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,mt=/[()=,{}\[\]\/\s]/,xt=/\\(\\)?/g,Vn=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,qe=/\w*$/,Vt=/^[-+]0x[0-9a-f]+$/i,ht=/^0b[01]+$/i,Pt=/^\[object .+?Constructor\]$/,hn=/^0o[0-7]+$/i,an=/^(?:0|[1-9]\d*)$/,Ge=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,ot=/($^)/,At=/['\n\r\u2028\u2029\\]/g,Nt="\\ud800-\\udfff",Yn="\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff",sr="\\u2700-\\u27bf",Si="a-z\\xdf-\\xf6\\xf8-\\xff",ai="A-Z\\xc0-\\xd6\\xd8-\\xde",En="\\ufe0e\\ufe0f",sn="\\xac\\xb1\\xd7\\xf7\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf\\u2000-\\u206f \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",Ln="['’]",Nn="["+Nt+"]",di="["+sn+"]",hr="["+Yn+"]",ei="\\d+",Fa="["+sr+"]",xu="["+Si+"]",fd="[^"+Nt+sn+ei+sr+Si+ai+"]",Np="\\ud83c[\\udffb-\\udfff]",A0="[^"+Nt+"]",dd="(?:\\ud83c[\\udde6-\\uddff]){2}",pd="[\\ud800-\\udbff][\\udc00-\\udfff]",wu="["+ai+"]",ve="\\u200d",Ke="(?:"+xu+"|"+fd+")",vt="(?:"+wu+"|"+fd+")",_t="(?:['’](?:d|ll|m|re|s|t|ve))?",Qe="(?:['’](?:D|LL|M|RE|S|T|VE))?",Ht="(?:"+hr+"|"+Np+")?",nn="["+En+"]?",mn=nn+Ht+("(?:"+ve+"(?:"+[A0,dd,pd].join("|")+")"+nn+Ht+")*"),Sn="(?:"+[Fa,dd,pd].join("|")+")"+mn,oi="(?:"+[A0+hr+"?",hr,dd,pd,Nn].join("|")+")",ci=RegExp(Ln,"g"),Cn=RegExp(hr,"g"),gi=RegExp(Np+"(?="+Np+")|"+oi+mn,"g"),ar=RegExp([wu+"?"+xu+"+"+_t+"(?="+[di,wu,"$"].join("|")+")",vt+"+"+Qe+"(?="+[di,wu+Ke,"$"].join("|")+")",wu+"?"+Ke+"+"+_t,wu+"+"+Qe,"\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])","\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",ei,Sn].join("|"),"g"),Os=RegExp("["+ve+Nt+Yn+En+"]"),bs=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,Ki=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],Xn=-1,Ti={};Ti[we]=Ti[Ce]=Ti[ke]=Ti[St]=Ti[Mt]=Ti[Ee]=Ti[_e]=Ti[tt]=Ti[de]=!0,Ti[k]=Ti[P]=Ti[Te]=Ti[U]=Ti[Le]=Ti[G]=Ti[$]=Ti[q]=Ti[ie]=Ti[V]=Ti[J]=Ti[ee]=Ti[oe]=Ti[fe]=Ti[He]=!1;var Bn={};Bn[k]=Bn[P]=Bn[Te]=Bn[Le]=Bn[U]=Bn[G]=Bn[we]=Bn[Ce]=Bn[ke]=Bn[St]=Bn[Mt]=Bn[ie]=Bn[V]=Bn[J]=Bn[ee]=Bn[oe]=Bn[fe]=Bn[Re]=Bn[Ee]=Bn[_e]=Bn[tt]=Bn[de]=!0,Bn[$]=Bn[q]=Bn[He]=!1;var qo={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},$l=parseFloat,no=parseInt,mh=typeof c.g=="object"&&c.g&&c.g.Object===Object&&c.g,ls=typeof self=="object"&&self&&self.Object===Object&&self,bn=mh||ls||Function("return this")(),io=o&&!o.nodeType&&o,Vs=io&&a&&!a.nodeType&&a,qn=Vs&&Vs.exports===io,xl=qn&&mh.process,la=function(){try{var dt=Vs&&Vs.require&&Vs.require("util").types;return dt||xl&&xl.binding&&xl.binding("util")}catch{}}(),Ip=la&&la.isArrayBuffer,mf=la&&la.isDate,gh=la&&la.isMap,R0=la&&la.isRegExp,q_=la&&la.isSet,M0=la&&la.isTypedArray;function $o(dt,at,Ft){switch(Ft.length){case 0:return dt.call(at);case 1:return dt.call(at,Ft[0]);case 2:return dt.call(at,Ft[0],Ft[1]);case 3:return dt.call(at,Ft[0],Ft[1],Ft[2])}return dt.apply(at,Ft)}function O0(dt,at,Ft,dn){for(var Xt=-1,ji=dt==null?0:dt.length;++Xt<ji;){var ha=dt[Xt];at(dn,ha,Ft(ha),dt)}return dn}function Wo(dt,at){for(var Ft=-1,dn=dt==null?0:dt.length;++Ft<dn&&at(dt[Ft],Ft,dt)!==!1;);return dt}function G1(dt,at){for(var Ft=dt==null?0:dt.length;Ft--&&at(dt[Ft],Ft,dt)!==!1;);return dt}function kE(dt,at){for(var Ft=-1,dn=dt==null?0:dt.length;++Ft<dn;)if(!at(dt[Ft],Ft,dt))return!1;return!0}function Cu(dt,at){for(var Ft=-1,dn=dt==null?0:dt.length,Xt=0,ji=[];++Ft<dn;){var ha=dt[Ft];at(ha,Ft,dt)&&(ji[Xt++]=ha)}return ji}function Nm(dt,at){return!!(dt!=null&&dt.length)&&gd(dt,at,0)>-1}function gf(dt,at,Ft){for(var dn=-1,Xt=dt==null?0:dt.length;++dn<Xt;)if(Ft(at,dt[dn]))return!0;return!1}function xs(dt,at){for(var Ft=-1,dn=dt==null?0:dt.length,Xt=Array(dn);++Ft<dn;)Xt[Ft]=at(dt[Ft],Ft,dt);return Xt}function vh(dt,at){for(var Ft=-1,dn=at.length,Xt=dt.length;++Ft<dn;)dt[Xt+Ft]=at[Ft];return dt}function $_(dt,at,Ft,dn){var Xt=-1,ji=dt==null?0:dt.length;for(dn&&ji&&(Ft=dt[++Xt]);++Xt<ji;)Ft=at(Ft,dt[Xt],Xt,dt);return Ft}function DE(dt,at,Ft,dn){var Xt=dt==null?0:dt.length;for(dn&&Xt&&(Ft=dt[--Xt]);Xt--;)Ft=at(Ft,dt[Xt],Xt,dt);return Ft}function W_(dt,at){for(var Ft=-1,dn=dt==null?0:dt.length;++Ft<dn;)if(at(dt[Ft],Ft,dt))return!0;return!1}var q1=N0("length");function PE(dt,at,Ft){var dn;return Ft(dt,function(Xt,ji,ha){if(at(Xt,ji,ha))return dn=ji,!1}),dn}function md(dt,at,Ft,dn){for(var Xt=dt.length,ji=Ft+(dn?1:-1);dn?ji--:++ji<Xt;)if(at(dt[ji],ji,dt))return ji;return-1}function gd(dt,at,Ft){return at==at?function(dn,Xt,ji){for(var ha=ji-1,yh=dn.length;++ha<yh;)if(dn[ha]===Xt)return ha;return-1}(dt,at,Ft):md(dt,LE,Ft)}function Y_(dt,at,Ft,dn){for(var Xt=Ft-1,ji=dt.length;++Xt<ji;)if(dn(dt[Xt],at))return Xt;return-1}function LE(dt){return dt!=dt}function UE(dt,at){var Ft=dt==null?0:dt.length;return Ft?_h(dt,at)/Ft:M}function N0(dt){return function(at){return at==null?u:at[dt]}}function X_(dt){return function(at){return dt==null?u:dt[at]}}function BE(dt,at,Ft,dn,Xt){return Xt(dt,function(ji,ha,yh){Ft=dn?(dn=!1,ji):at(Ft,ji,ha,yh)}),Ft}function _h(dt,at){for(var Ft,dn=-1,Xt=dt.length;++dn<Xt;){var ji=at(dt[dn]);ji!==u&&(Ft=Ft===u?ji:Ft+ji)}return Ft}function Im(dt,at){for(var Ft=-1,dn=Array(dt);++Ft<dt;)dn[Ft]=at(Ft);return dn}function FE(dt){return dt&&dt.slice(0,k0(dt)+1).replace(ce,"")}function pc(dt){return function(at){return dt(at)}}function Ns(dt,at){return xs(at,function(Ft){return dt[Ft]})}function vf(dt,at){return dt.has(at)}function $1(dt,at){for(var Ft=-1,dn=dt.length;++Ft<dn&&gd(at,dt[Ft],0)>-1;);return Ft}function ua(dt,at){for(var Ft=dt.length;Ft--&&gd(at,dt[Ft],0)>-1;);return Ft}var W1=X_({À:"A",Á:"A",Â:"A",Ã:"A",Ä:"A",Å:"A",à:"a",á:"a",â:"a",ã:"a",ä:"a",å:"a",Ç:"C",ç:"c",Ð:"D",ð:"d",È:"E",É:"E",Ê:"E",Ë:"E",è:"e",é:"e",ê:"e",ë:"e",Ì:"I",Í:"I",Î:"I",Ï:"I",ì:"i",í:"i",î:"i",ï:"i",Ñ:"N",ñ:"n",Ò:"O",Ó:"O",Ô:"O",Õ:"O",Ö:"O",Ø:"O",ò:"o",ó:"o",ô:"o",õ:"o",ö:"o",ø:"o",Ù:"U",Ú:"U",Û:"U",Ü:"U",ù:"u",ú:"u",û:"u",ü:"u",Ý:"Y",ý:"y",ÿ:"y",Æ:"Ae",æ:"ae",Þ:"Th",þ:"th",ß:"ss",Ā:"A",Ă:"A",Ą:"A",ā:"a",ă:"a",ą:"a",Ć:"C",Ĉ:"C",Ċ:"C",Č:"C",ć:"c",ĉ:"c",ċ:"c",č:"c",Ď:"D",Đ:"D",ď:"d",đ:"d",Ē:"E",Ĕ:"E",Ė:"E",Ę:"E",Ě:"E",ē:"e",ĕ:"e",ė:"e",ę:"e",ě:"e",Ĝ:"G",Ğ:"G",Ġ:"G",Ģ:"G",ĝ:"g",ğ:"g",ġ:"g",ģ:"g",Ĥ:"H",Ħ:"H",ĥ:"h",ħ:"h",Ĩ:"I",Ī:"I",Ĭ:"I",Į:"I",İ:"I",ĩ:"i",ī:"i",ĭ:"i",į:"i",ı:"i",Ĵ:"J",ĵ:"j",Ķ:"K",ķ:"k",ĸ:"k",Ĺ:"L",Ļ:"L",Ľ:"L",Ŀ:"L",Ł:"L",ĺ:"l",ļ:"l",ľ:"l",ŀ:"l",ł:"l",Ń:"N",Ņ:"N",Ň:"N",Ŋ:"N",ń:"n",ņ:"n",ň:"n",ŋ:"n",Ō:"O",Ŏ:"O",Ő:"O",ō:"o",ŏ:"o",ő:"o",Ŕ:"R",Ŗ:"R",Ř:"R",ŕ:"r",ŗ:"r",ř:"r",Ś:"S",Ŝ:"S",Ş:"S",Š:"S",ś:"s",ŝ:"s",ş:"s",š:"s",Ţ:"T",Ť:"T",Ŧ:"T",ţ:"t",ť:"t",ŧ:"t",Ũ:"U",Ū:"U",Ŭ:"U",Ů:"U",Ű:"U",Ų:"U",ũ:"u",ū:"u",ŭ:"u",ů:"u",ű:"u",ų:"u",Ŵ:"W",ŵ:"w",Ŷ:"Y",ŷ:"y",Ÿ:"Y",Ź:"Z",Ż:"Z",Ž:"Z",ź:"z",ż:"z",ž:"z",Ĳ:"IJ",ĳ:"ij",Œ:"Oe",œ:"oe",ŉ:"'n",ſ:"s"}),I0=X_({"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"});function Y1(dt){return"\\"+qo[dt]}function vd(dt){return Os.test(dt)}function km(dt){var at=-1,Ft=Array(dt.size);return dt.forEach(function(dn,Xt){Ft[++at]=[Xt,dn]}),Ft}function ro(dt,at){return function(Ft){return dt(at(Ft))}}function mc(dt,at){for(var Ft=-1,dn=dt.length,Xt=0,ji=[];++Ft<dn;){var ha=dt[Ft];ha!==at&&ha!==d||(dt[Ft]=d,ji[Xt++]=Ft)}return ji}function Dm(dt){var at=-1,Ft=Array(dt.size);return dt.forEach(function(dn){Ft[++at]=dn}),Ft}function X1(dt){var at=-1,Ft=Array(dt.size);return dt.forEach(function(dn){Ft[++at]=[dn,dn]}),Ft}function wa(dt){return vd(dt)?function(at){for(var Ft=gi.lastIndex=0;gi.test(at);)++Ft;return Ft}(dt):q1(dt)}function Zs(dt){return vd(dt)?function(at){return at.match(gi)||[]}(dt):function(at){return at.split("")}(dt)}function k0(dt){for(var at=dt.length;at--&&j.test(dt.charAt(at)););return at}var _f=X_({"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"}),kp=function dt(at){var Ft,dn=(at=at==null?bn:kp.defaults(bn.Object(),at,kp.pick(bn,Ki))).Array,Xt=at.Date,ji=at.Error,ha=at.Function,yh=at.Math,Zi=at.Object,Wl=at.RegExp,bh=at.String,Kc=at.TypeError,Pm=dn.prototype,D0=ha.prototype,Au=Zi.prototype,Zc=at["__core-js_shared__"],za=D0.toString,Rr=Au.hasOwnProperty,P0=0,K_=(Ft=/[^.]+$/.exec(Zc&&Zc.keys&&Zc.keys.IE_PROTO||""))?"Symbol(src)_1."+Ft:"",_d=Au.toString,yd=za.call(Zi),Z_=bn._,K1=Wl("^"+za.call(Rr).replace(Ot,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Yo=qn?at.Buffer:u,yf=at.Symbol,Eh=at.Uint8Array,zE=Yo?Yo.allocUnsafe:u,Lm=ro(Zi.getPrototypeOf,Zi),Um=Zi.create,L0=Au.propertyIsEnumerable,bd=Pm.splice,U0=yf?yf.isConcatSpreadable:u,Ru=yf?yf.iterator:u,Hr=yf?yf.toStringTag:u,B0=function(){try{var E=Ol(Zi,"defineProperty");return E({},"",{}),E}catch{}}(),fn=at.clearTimeout!==bn.clearTimeout&&at.clearTimeout,fa=Xt&&Xt.now!==bn.Date.now&&Xt.now,F0=at.setTimeout!==bn.setTimeout&&at.setTimeout,Mu=yh.ceil,Jc=yh.floor,z0=Zi.getOwnPropertySymbols,Dp=Yo?Yo.isBuffer:u,Ca=at.isFinite,HE=Pm.join,gc=ro(Zi.keys,Zi),ws=yh.max,Js=yh.min,Ii=Xt.now,vc=at.parseInt,Co=yh.random,Pp=Pm.reverse,H0=Ol(at,"DataView"),Ao=Ol(at,"Map"),Bt=Ol(at,"Promise"),Aa=Ol(at,"Set"),Bm=Ol(at,"WeakMap"),Ed=Ol(Zi,"create"),bf=Bm&&new Bm,da={},j0=$p(H0),_c=$p(Ao),Z1=$p(Bt),wl=$p(Aa),Lp=$p(Bm),Yl=yf?yf.prototype:u,Sd=Yl?Yl.valueOf:u,Fm=Yl?Yl.toString:u;function ge(E){if(L(E)&&!Zn(E)&&!(E instanceof Fi)){if(E instanceof so)return E;if(Rr.call(E,"__wrapped__"))return aS(E)}return new so(E)}var Ef=function(){function E(){}return function(w){if(!O(w))return{};if(Um)return Um(w);E.prototype=w;var F=new E;return E.prototype=u,F}}();function Sh(){}function so(E,w){this.__wrapped__=E,this.__actions__=[],this.__chain__=!!w,this.__index__=0,this.__values__=u}function Fi(E){this.__wrapped__=E,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=R,this.__views__=[]}function Sf(E){var w=-1,F=E==null?0:E.length;for(this.clear();++w<F;){var Q=E[w];this.set(Q[0],Q[1])}}function Ou(E){var w=-1,F=E==null?0:E.length;for(this.clear();++w<F;){var Q=E[w];this.set(Q[0],Q[1])}}function Qc(E){var w=-1,F=E==null?0:E.length;for(this.clear();++w<F;){var Q=E[w];this.set(Q[0],Q[1])}}function Nu(E){var w=-1,F=E==null?0:E.length;for(this.__data__=new Qc;++w<F;)this.add(E[w])}function yc(E){var w=this.__data__=new Ou(E);this.size=w.size}function J_(E,w){var F=Zn(E),Q=!F&&Vr(E),le=!F&&!Q&&Rd(E),xe=!F&&!Q&&!le&&pe(E),Pe=F||Q||le||xe,We=Pe?Im(E.length,bh):[],ct=We.length;for(var kt in E)!w&&!Rr.call(E,kt)||Pe&&(kt=="length"||le&&(kt=="offset"||kt=="parent")||xe&&(kt=="buffer"||kt=="byteLength"||kt=="byteOffset")||Is(kt,ct))||We.push(kt);return We}function Xl(E){var w=E.length;return w?E[XE(0,w-1)]:u}function Q_(E,w){return uv(Sc(E),Tf(w,0,E.length))}function V0(E){return uv(Sc(E))}function G0(E,w,F){(F!==u&&!ks(E[w],F)||F===u&&!(w in E))&&Iu(E,w,F)}function Td(E,w,F){var Q=E[w];Rr.call(E,w)&&ks(Q,F)&&(F!==u||w in E)||Iu(E,w,F)}function Ro(E,w){for(var F=E.length;F--;)if(ks(E[F][0],w))return F;return-1}function jE(E,w,F,Q){return Cl(E,function(le,xe,Pe){w(Q,le,F(le),Pe)}),Q}function Xo(E,w){return E&&Bu(w,Tn(w),E)}function Iu(E,w,F){w=="__proto__"&&B0?B0(E,w,{configurable:!0,enumerable:!0,value:F,writable:!0}):E[w]=F}function q0(E,w){for(var F=-1,Q=w.length,le=dn(Q),xe=E==null;++F<Q;)le[F]=xe?u:Ri(E,w[F]);return le}function Tf(E,w,F){return E==E&&(F!==u&&(E=E<=F?E:F),w!==u&&(E=E>=w?E:w)),E}function bc(E,w,F,Q,le,xe){var Pe,We=1&w,ct=2&w,kt=4&w;if(F&&(Pe=le?F(E,Q,le,xe):F(E)),Pe!==u)return Pe;if(!O(E))return E;var Lt=Zn(E);if(Lt){if(Pe=function(Ut){var Qt=Ut.length,mi=new Ut.constructor(Qt);return Qt&&typeof Ut[0]=="string"&&Rr.call(Ut,"index")&&(mi.index=Ut.index,mi.input=Ut.input),mi}(E),!We)return Sc(E,Pe)}else{var Wt=ja(E),Rn=Wt==q||Wt==Y;if(Rd(E))return vi(E,We);if(Wt==J||Wt==k||Rn&&!le){if(Pe=ct||Rn?{}:sx(E),!We)return ct?function(Ut,Qt){return Bu(Ut,nS(Ut),Qt)}(E,function(Ut,Qt){return Ut&&Bu(Qt,$n(Qt),Ut)}(Pe,E)):function(Ut,Qt){return Bu(Ut,ov(Ut),Qt)}(E,Xo(Pe,E))}else{if(!Bn[Wt])return le?E:{};Pe=function(Ut,Qt,mi){var Gt=Ut.constructor;switch(Qt){case Te:return Wm(Ut);case U:case G:return new Gt(+Ut);case Le:return function(on,In){var ln=In?Wm(on.buffer):on.buffer;return new on.constructor(ln,on.byteOffset,on.byteLength)}(Ut,mi);case we:case Ce:case ke:case St:case Mt:case Ee:case _e:case tt:case de:return sy(Ut,mi);case ie:return new Gt;case V:case fe:return new Gt(Ut);case ee:return function(on){var In=new on.constructor(on.source,qe.exec(on));return In.lastIndex=on.lastIndex,In}(Ut);case oe:return new Gt;case Re:return Mn=Ut,Sd?Zi(Sd.call(Mn)):{}}var Mn}(E,Wt,We)}}xe||(xe=new yc);var Un=xe.get(E);if(Un)return Un;xe.set(E,Pe),K(E)?E.forEach(function(Ut){Pe.add(bc(Ut,w,F,Ut,E,xe))}):B(E)&&E.forEach(function(Ut,Qt){Pe.set(Qt,bc(Ut,w,F,Qt,E,xe))});var ni=Lt?u:(kt?ct?oy:eS:ct?$n:Tn)(E);return Wo(ni||E,function(Ut,Qt){ni&&(Ut=E[Qt=Ut]),Td(Pe,Qt,bc(Ut,w,F,Qt,E,xe))}),Pe}function us(E,w,F){var Q=F.length;if(E==null)return!Q;for(E=Zi(E);Q--;){var le=F[Q],xe=w[le],Pe=E[le];if(Pe===u&&!(le in E)||!xe(Pe))return!1}return!0}function ey(E,w,F){if(typeof E!="function")throw new Kc(h);return Zm(function(){E.apply(u,F)},w)}function xd(E,w,F,Q){var le=-1,xe=Nm,Pe=!0,We=E.length,ct=[],kt=w.length;if(!We)return ct;F&&(w=xs(w,pc(F))),Q?(xe=gf,Pe=!1):w.length>=200&&(xe=vf,Pe=!1,w=new Nu(w));e:for(;++le<We;){var Lt=E[le],Wt=F==null?Lt:F(Lt);if(Lt=Q||Lt!==0?Lt:0,Pe&&Wt==Wt){for(var Rn=kt;Rn--;)if(w[Rn]===Wt)continue e;ct.push(Lt)}else xe(w,Wt,Q)||ct.push(Lt)}return ct}ge.templateSettings={escape:ue,evaluate:Xe,interpolate:it,variable:"",imports:{_:ge}},ge.prototype=Sh.prototype,ge.prototype.constructor=ge,so.prototype=Ef(Sh.prototype),so.prototype.constructor=so,Fi.prototype=Ef(Sh.prototype),Fi.prototype.constructor=Fi,Sf.prototype.clear=function(){this.__data__=Ed?Ed(null):{},this.size=0},Sf.prototype.delete=function(E){var w=this.has(E)&&delete this.__data__[E];return this.size-=w?1:0,w},Sf.prototype.get=function(E){var w=this.__data__;if(Ed){var F=w[E];return F===f?u:F}return Rr.call(w,E)?w[E]:u},Sf.prototype.has=function(E){var w=this.__data__;return Ed?w[E]!==u:Rr.call(w,E)},Sf.prototype.set=function(E,w){var F=this.__data__;return this.size+=this.has(E)?0:1,F[E]=Ed&&w===u?f:w,this},Ou.prototype.clear=function(){this.__data__=[],this.size=0},Ou.prototype.delete=function(E){var w=this.__data__,F=Ro(w,E);return!(F<0)&&(F==w.length-1?w.pop():bd.call(w,F,1),--this.size,!0)},Ou.prototype.get=function(E){var w=this.__data__,F=Ro(w,E);return F<0?u:w[F][1]},Ou.prototype.has=function(E){return Ro(this.__data__,E)>-1},Ou.prototype.set=function(E,w){var F=this.__data__,Q=Ro(F,E);return Q<0?(++this.size,F.push([E,w])):F[Q][1]=w,this},Qc.prototype.clear=function(){this.size=0,this.__data__={hash:new Sf,map:new(Ao||Ou),string:new Sf}},Qc.prototype.delete=function(E){var w=cy(this,E).delete(E);return this.size-=w?1:0,w},Qc.prototype.get=function(E){return cy(this,E).get(E)},Qc.prototype.has=function(E){return cy(this,E).has(E)},Qc.prototype.set=function(E,w){var F=cy(this,E),Q=F.size;return F.set(E,w),this.size+=F.size==Q?0:1,this},Nu.prototype.add=Nu.prototype.push=function(E){return this.__data__.set(E,f),this},Nu.prototype.has=function(E){return this.__data__.has(E)},yc.prototype.clear=function(){this.__data__=new Ou,this.size=0},yc.prototype.delete=function(E){var w=this.__data__,F=w.delete(E);return this.size=w.size,F},yc.prototype.get=function(E){return this.__data__.get(E)},yc.prototype.has=function(E){return this.__data__.has(E)},yc.prototype.set=function(E,w){var F=this.__data__;if(F instanceof Ou){var Q=F.__data__;if(!Ao||Q.length<199)return Q.push([E,w]),this.size=++F.size,this;F=this.__data__=new Qc(Q)}return F.set(E,w),this.size=F.size,this};var Cl=tx(ku),$0=tx(qE,!0);function VE(E,w){var F=!0;return Cl(E,function(Q,le,xe){return F=!!w(Q,le,xe)}),F}function zm(E,w,F){for(var Q=-1,le=E.length;++Q<le;){var xe=E[Q],Pe=w(xe);if(Pe!=null&&(We===u?Pe==Pe&&!he(Pe):F(Pe,We)))var We=Pe,ct=xe}return ct}function Hm(E,w){var F=[];return Cl(E,function(Q,le,xe){w(Q,le,xe)&&F.push(Q)}),F}function Ha(E,w,F,Q,le){var xe=-1,Pe=E.length;for(F||(F=iS),le||(le=[]);++xe<Pe;){var We=E[xe];w>0&&F(We)?w>1?Ha(We,w-1,F,Q,le):vh(le,We):Q||(le[le.length]=We)}return le}var W0=nx(),GE=nx(!0);function ku(E,w){return E&&W0(E,w,Tn)}function qE(E,w){return E&&GE(E,w,Tn)}function Du(E,w){return Cu(w,function(F){return N(E[F])})}function Gs(E,w){for(var F=0,Q=(w=Ah(w,E)).length;E!=null&&F<Q;)E=E[ju(w[F++])];return F&&F==Q?E:u}function Kl(E,w,F){var Q=w(E);return Zn(E)?Q:vh(Q,F(E))}function pa(E){return E==null?E===u?"[object Undefined]":"[object Null]":Hr&&Hr in Zi(E)?function(w){var F=Rr.call(w,Hr),Q=w[Hr];try{w[Hr]=u;var le=!0}catch{}var xe=_d.call(w);return le&&(F?w[Hr]=Q:delete w[Hr]),xe}(E):function(w){return _d.call(w)}(E)}function jr(E,w){return E>w}function jm(E,w){return E!=null&&Rr.call(E,w)}function Vm(E,w){return E!=null&&w in Zi(E)}function ty(E,w,F){for(var Q=F?gf:Nm,le=E[0].length,xe=E.length,Pe=xe,We=dn(xe),ct=1/0,kt=[];Pe--;){var Lt=E[Pe];Pe&&w&&(Lt=xs(Lt,pc(w))),ct=Js(Lt.length,ct),We[Pe]=!F&&(w||le>=120&&Lt.length>=120)?new Nu(Pe&&Lt):u}Lt=E[0];var Wt=-1,Rn=We[0];e:for(;++Wt<le&&kt.length<ct;){var Un=Lt[Wt],ni=w?w(Un):Un;if(Un=F||Un!==0?Un:0,!(Rn?vf(Rn,ni):Q(kt,ni,F))){for(Pe=xe;--Pe;){var Ut=We[Pe];if(!(Ut?vf(Ut,ni):Q(E[Pe],ni,F)))continue e}Rn&&Rn.push(ni),kt.push(Un)}}return kt}function Ec(E,w,F){var Q=(E=sS(E,w=Ah(w,E)))==null?E:E[ju(No(w))];return Q==null?u:$o(Q,E,F)}function Y0(E){return L(E)&&pa(E)==k}function or(E,w,F,Q,le){return E===w||(E==null||w==null||!L(E)&&!L(w)?E!=E&&w!=w:function(xe,Pe,We,ct,kt,Lt){var Wt=Zn(xe),Rn=Zn(Pe),Un=Wt?P:ja(xe),ni=Rn?P:ja(Pe),Ut=(Un=Un==k?J:Un)==J,Qt=(ni=ni==k?J:ni)==J,mi=Un==ni;if(mi&&Rd(xe)){if(!Rd(Pe))return!1;Wt=!0,Ut=!1}if(mi&&!Ut)return Lt||(Lt=new yc),Wt||pe(xe)?QE(xe,Pe,We,ct,kt,Lt):function(ln,Fn,Cs,Ls,xc,kr,pr){switch(Cs){case Le:if(ln.byteLength!=Fn.byteLength||ln.byteOffset!=Fn.byteOffset)return!1;ln=ln.buffer,Fn=Fn.buffer;case Te:return!(ln.byteLength!=Fn.byteLength||!kr(new Eh(ln),new Eh(Fn)));case U:case G:case V:return ks(+ln,+Fn);case $:return ln.name==Fn.name&&ln.message==Fn.message;case ee:case fe:return ln==Fn+"";case ie:var wc=km;case oe:var Ql=1&Ls;if(wc||(wc=Dm),ln.size!=Fn.size&&!Ql)return!1;var vy=pr.get(ln);if(vy)return vy==Fn;Ls|=2,pr.set(ln,Fn);var eu=QE(wc(ln),wc(Fn),Ls,xc,kr,pr);return pr.delete(ln),eu;case Re:if(Sd)return Sd.call(ln)==Sd.call(Fn)}return!1}(xe,Pe,Un,We,ct,kt,Lt);if(!(1&We)){var Gt=Ut&&Rr.call(xe,"__wrapped__"),Mn=Qt&&Rr.call(Pe,"__wrapped__");if(Gt||Mn){var on=Gt?xe.value():xe,In=Mn?Pe.value():Pe;return Lt||(Lt=new yc),kt(on,In,We,ct,Lt)}}return mi?(Lt||(Lt=new yc),function(ln,Fn,Cs,Ls,xc,kr){var pr=1&Cs,wc=eS(ln),Ql=wc.length,vy=eS(Fn),eu=vy.length;if(Ql!=eu&&!pr)return!1;for(var Yp=Ql;Yp--;){var Of=wc[Yp];if(!(pr?Of in Fn:Rr.call(Fn,Of)))return!1}var Nf=kr.get(ln),dx=kr.get(Fn);if(Nf&&dx)return Nf==Fn&&dx==ln;var _y=!0;kr.set(ln,Fn),kr.set(Fn,ln);for(var vv=pr;++Yp<Ql;){var _v=ln[Of=wc[Yp]],If=Fn[Of];if(Ls)var mS=pr?Ls(If,_v,Of,Fn,ln,kr):Ls(_v,If,Of,ln,Fn,kr);if(!(mS===u?_v===If||xc(_v,If,Cs,Ls,kr):mS)){_y=!1;break}vv||(vv=Of=="constructor")}if(_y&&!vv){var Nd=ln.constructor,ag=Fn.constructor;Nd==ag||!("constructor"in ln)||!("constructor"in Fn)||typeof Nd=="function"&&Nd instanceof Nd&&typeof ag=="function"&&ag instanceof ag||(_y=!1)}return kr.delete(ln),kr.delete(Fn),_y}(xe,Pe,We,ct,kt,Lt)):!1}(E,w,F,Q,or,le))}function X0(E,w,F,Q){var le=F.length,xe=le,Pe=!Q;if(E==null)return!xe;for(E=Zi(E);le--;){var We=F[le];if(Pe&&We[2]?We[1]!==E[We[0]]:!(We[0]in E))return!1}for(;++le<xe;){var ct=(We=F[le])[0],kt=E[ct],Lt=We[1];if(Pe&&We[2]){if(kt===u&&!(ct in E))return!1}else{var Wt=new yc;if(Q)var Rn=Q(kt,Lt,ct,E,w,Wt);if(!(Rn===u?or(Lt,kt,3,Q,Wt):Rn))return!1}}return!0}function J1(E){return!(!O(E)||(w=E,K_&&K_ in w))&&(N(E)?K1:Pt).test($p(E));var w}function $E(E){return typeof E=="function"?E:E==null?ms:typeof E=="object"?Zn(E)?Th(E[0],E[1]):K0(E):Od(E)}function WE(E){if(!cv(E))return gc(E);var w=[];for(var F in Zi(E))Rr.call(E,F)&&F!="constructor"&&w.push(F);return w}function Q1(E){if(!O(E))return function(le){var xe=[];if(le!=null)for(var Pe in Zi(le))xe.push(Pe);return xe}(E);var w=cv(E),F=[];for(var Q in E)(Q!="constructor"||!w&&Rr.call(E,Q))&&F.push(Q);return F}function ny(E,w){return E<w}function Pu(E,w){var F=-1,Q=uo(E)?dn(E.length):[];return Cl(E,function(le,xe,Pe){Q[++F]=w(le,xe,Pe)}),Q}function K0(E){var w=ti(E);return w.length==1&&w[0][2]?ox(w[0][0],w[0][1]):function(F){return F===E||X0(F,E,w)}}function Th(E,w){return ly(E)&&ax(w)?ox(ju(E),w):function(F){var Q=Ri(F,E);return Q===u&&Q===w?Di(F,E):or(w,Q,3)}}function Z0(E,w,F,Q,le){E!==w&&W0(w,function(xe,Pe){if(le||(le=new yc),O(xe))(function(ct,kt,Lt,Wt,Rn,Un,ni){var Ut=lv(ct,Lt),Qt=lv(kt,Lt),mi=ni.get(Qt);if(mi)return void G0(ct,Lt,mi);var Gt=Un?Un(Ut,Qt,Lt+"",ct,kt,ni):u,Mn=Gt===u;if(Mn){var on=Zn(Qt),In=!on&&Rd(Qt),ln=!on&&!In&&pe(Qt);Gt=Qt,on||In||ln?Zn(Ut)?Gt=Ut:Ds(Ut)?Gt=Sc(Ut):In?(Mn=!1,Gt=vi(Qt,!0)):ln?(Mn=!1,Gt=sy(Qt,!0)):Gt=[]:te(Qt)||Vr(Qt)?(Gt=Ut,Vr(Ut)?Gt=Kt(Ut):O(Ut)&&!N(Ut)||(Gt=sx(Qt))):Mn=!1}Mn&&(ni.set(Qt,Gt),Rn(Gt,Qt,Wt,Un,ni),ni.delete(Qt)),G0(ct,Lt,Gt)})(E,w,Pe,F,Z0,Q,le);else{var We=Q?Q(lv(E,Pe),xe,Pe+"",E,w,le):u;We===u&&(We=xe),G0(E,Pe,We)}},$n)}function J0(E,w){var F=E.length;if(F)return Is(w+=w<0?F:0,F)?E[w]:u}function wd(E,w,F){w=w.length?xs(w,function(xe){return Zn(xe)?function(Pe){return Gs(Pe,xe.length===1?xe[0]:xe)}:xe}):[ms];var Q=-1;w=xs(w,pc(li()));var le=Pu(E,function(xe,Pe,We){var ct=xs(w,function(kt){return kt(xe)});return{criteria:ct,index:++Q,value:xe}});return function(xe,Pe){var We=xe.length;for(xe.sort(Pe);We--;)xe[We]=xe[We].value;return xe}(le,function(xe,Pe){return function(We,ct,kt){for(var Lt=-1,Wt=We.criteria,Rn=ct.criteria,Un=Wt.length,ni=kt.length;++Lt<Un;){var Ut=jp(Wt[Lt],Rn[Lt]);if(Ut)return Lt>=ni?Ut:Ut*(kt[Lt]=="desc"?-1:1)}return We.index-ct.index}(xe,Pe,F)})}function YE(E,w,F){for(var Q=-1,le=w.length,xe={};++Q<le;){var Pe=w[Q],We=Gs(E,Pe);F(We,Pe)&&Gm(xe,Ah(Pe,E),We)}return xe}function Q0(E,w,F,Q){var le=Q?Y_:gd,xe=-1,Pe=w.length,We=E;for(E===w&&(w=Sc(w)),F&&(We=xs(E,pc(F)));++xe<Pe;)for(var ct=0,kt=w[xe],Lt=F?F(kt):kt;(ct=le(We,Lt,ct,Q))>-1;)We!==E&&bd.call(We,ct,1),bd.call(E,ct,1);return E}function iy(E,w){for(var F=E?w.length:0,Q=F-1;F--;){var le=w[F];if(F==Q||le!==xe){var xe=le;Is(le)?bd.call(E,le,1):zp(E,le)}}return E}function XE(E,w){return E+Jc(Co()*(w-E+1))}function ry(E,w){var F="";if(!E||w<1||w>x)return F;do w%2&&(F+=E),(w=Jc(w/2))&&(E+=E);while(w);return F}function qi(E,w){return uy(Km(E,w,ms),E+"")}function ev(E){return Xl(fr(E))}function ex(E,w){var F=fr(E);return uv(F,Tf(w,0,F.length))}function Gm(E,w,F,Q){if(!O(E))return E;for(var le=-1,xe=(w=Ah(w,E)).length,Pe=xe-1,We=E;We!=null&&++le<xe;){var ct=ju(w[le]),kt=F;if(ct==="__proto__"||ct==="constructor"||ct==="prototype")return E;if(le!=Pe){var Lt=We[ct];(kt=Q?Q(Lt,ct,We):u)===u&&(kt=O(Lt)?Lt:Is(w[le+1])?[]:{})}Td(We,ct,kt),We=We[ct]}return E}var xf=bf?function(E,w){return bf.set(E,w),E}:ms,Vi=B0?function(E,w){return B0(E,"toString",{configurable:!0,enumerable:!1,value:Io(w),writable:!0})}:ms;function Up(E){return uv(fr(E))}function hs(E,w,F){var Q=-1,le=E.length;w<0&&(w=-w>le?0:le+w),(F=F>le?le:F)<0&&(F+=le),le=w>F?0:F-w>>>0,w>>>=0;for(var xe=dn(le);++Q<le;)xe[Q]=E[Q+w];return xe}function xh(E,w){var F;return Cl(E,function(Q,le,xe){return!(F=w(Q,le,xe))}),!!F}function Bp(E,w,F){var Q=0,le=E==null?Q:E.length;if(typeof w=="number"&&w==w&&le<=2147483647){for(;Q<le;){var xe=Q+le>>>1,Pe=E[xe];Pe!==null&&!he(Pe)&&(F?Pe<=w:Pe<w)?Q=xe+1:le=xe}return le}return qm(E,w,ms,F)}function qm(E,w,F,Q){var le=0,xe=E==null?0:E.length;if(xe===0)return 0;for(var Pe=(w=F(w))!=w,We=w===null,ct=he(w),kt=w===u;le<xe;){var Lt=Jc((le+xe)/2),Wt=F(E[Lt]),Rn=Wt!==u,Un=Wt===null,ni=Wt==Wt,Ut=he(Wt);if(Pe)var Qt=Q||ni;else Qt=kt?ni&&(Q||Rn):We?ni&&Rn&&(Q||!Un):ct?ni&&Rn&&!Un&&(Q||!Ut):!Un&&!Ut&&(Q?Wt<=w:Wt<w);Qt?le=Lt+1:xe=Lt}return Js(xe,4294967294)}function Fp(E,w){for(var F=-1,Q=E.length,le=0,xe=[];++F<Q;){var Pe=E[F],We=w?w(Pe):Pe;if(!F||!ks(We,ct)){var ct=We;xe[le++]=Pe===0?0:Pe}}return xe}function wh(E){return typeof E=="number"?E:he(E)?M:+E}function el(E){if(typeof E=="string")return E;if(Zn(E))return xs(E,el)+"";if(he(E))return Fm?Fm.call(E):"";var w=E+"";return w=="0"&&1/E==-1/0?"-0":w}function Ch(E,w,F){var Q=-1,le=Nm,xe=E.length,Pe=!0,We=[],ct=We;if(F)Pe=!1,le=gf;else if(xe>=200){var kt=w?null:eR(E);if(kt)return Dm(kt);Pe=!1,le=vf,ct=new Nu}else ct=w?[]:We;e:for(;++Q<xe;){var Lt=E[Q],Wt=w?w(Lt):Lt;if(Lt=F||Lt!==0?Lt:0,Pe&&Wt==Wt){for(var Rn=ct.length;Rn--;)if(ct[Rn]===Wt)continue e;w&&ct.push(Wt),We.push(Lt)}else le(ct,Wt,F)||(ct!==We&&ct.push(Wt),We.push(Lt))}return We}function zp(E,w){return(E=sS(E,w=Ah(w,E)))==null||delete E[ju(No(w))]}function KE(E,w,F,Q){return Gm(E,w,F(Gs(E,w)),Q)}function Lu(E,w,F,Q){for(var le=E.length,xe=Q?le:-1;(Q?xe--:++xe<le)&&w(E[xe],xe,E););return F?hs(E,Q?0:xe,Q?xe+1:le):hs(E,Q?xe+1:0,Q?le:xe)}function $m(E,w){var F=E;return F instanceof Fi&&(F=F.value()),$_(w,function(Q,le){return le.func.apply(le.thisArg,vh([Q],le.args))},F)}function tv(E,w,F){var Q=E.length;if(Q<2)return Q?Ch(E[0]):[];for(var le=-1,xe=dn(Q);++le<Q;)for(var Pe=E[le],We=-1;++We<Q;)We!=le&&(xe[le]=xd(xe[le]||Pe,E[We],w,F));return Ch(Ha(xe,1),w,F)}function Hp(E,w,F){for(var Q=-1,le=E.length,xe=w.length,Pe={};++Q<le;){var We=Q<xe?w[Q]:u;F(Pe,E[Q],We)}return Pe}function nv(E){return Ds(E)?E:[]}function Uu(E){return typeof E=="function"?E:ms}function Ah(E,w){return Zn(E)?E:ly(E,w)?[E]:hy(It(E))}var QA=qi;function ao(E,w,F){var Q=E.length;return F=F===u?Q:F,!w&&F>=Q?E:hs(E,w,F)}var ZE=fn||function(E){return bn.clearTimeout(E)};function vi(E,w){if(w)return E.slice();var F=E.length,Q=zE?zE(F):new E.constructor(F);return E.copy(Q),Q}function Wm(E){var w=new E.constructor(E.byteLength);return new Eh(w).set(new Eh(E)),w}function sy(E,w){var F=w?Wm(E.buffer):E.buffer;return new E.constructor(F,E.byteOffset,E.length)}function jp(E,w){if(E!==w){var F=E!==u,Q=E===null,le=E==E,xe=he(E),Pe=w!==u,We=w===null,ct=w==w,kt=he(w);if(!We&&!kt&&!xe&&E>w||xe&&Pe&&ct&&!We&&!kt||Q&&Pe&&ct||!F&&ct||!le)return 1;if(!Q&&!xe&&!kt&&E<w||kt&&F&&le&&!Q&&!xe||We&&F&&le||!Pe&&le||!ct)return-1}return 0}function wf(E,w,F,Q){for(var le=-1,xe=E.length,Pe=F.length,We=-1,ct=w.length,kt=ws(xe-Pe,0),Lt=dn(ct+kt),Wt=!Q;++We<ct;)Lt[We]=w[We];for(;++le<Pe;)(Wt||le<xe)&&(Lt[F[le]]=E[le]);for(;kt--;)Lt[We++]=E[le++];return Lt}function iv(E,w,F,Q){for(var le=-1,xe=E.length,Pe=-1,We=F.length,ct=-1,kt=w.length,Lt=ws(xe-We,0),Wt=dn(Lt+kt),Rn=!Q;++le<Lt;)Wt[le]=E[le];for(var Un=le;++ct<kt;)Wt[Un+ct]=w[ct];for(;++Pe<We;)(Rn||le<xe)&&(Wt[Un+F[Pe]]=E[le++]);return Wt}function Sc(E,w){var F=-1,Q=E.length;for(w||(w=dn(Q));++F<Q;)w[F]=E[F];return w}function Bu(E,w,F,Q){var le=!F;F||(F={});for(var xe=-1,Pe=w.length;++xe<Pe;){var We=w[xe],ct=Q?Q(F[We],E[We],We,F,E):u;ct===u&&(ct=E[We]),le?Iu(F,We,ct):Td(F,We,ct)}return F}function Cd(E,w){return function(F,Q){var le=Zn(F)?O0:jE,xe=w?w():{};return le(F,E,li(Q,2),xe)}}function Ym(E){return qi(function(w,F){var Q=-1,le=F.length,xe=le>1?F[le-1]:u,Pe=le>2?F[2]:u;for(xe=E.length>3&&typeof xe=="function"?(le--,xe):u,Pe&&Zo(F[0],F[1],Pe)&&(xe=le<3?u:xe,le=1),w=Zi(w);++Q<le;){var We=F[Q];We&&E(w,We,Q,xe)}return w})}function tx(E,w){return function(F,Q){if(F==null)return F;if(!uo(F))return E(F,Q);for(var le=F.length,xe=w?le:-1,Pe=Zi(F);(w?xe--:++xe<le)&&Q(Pe[xe],xe,Pe)!==!1;);return F}}function nx(E){return function(w,F,Q){for(var le=-1,xe=Zi(w),Pe=Q(w),We=Pe.length;We--;){var ct=Pe[E?We:++le];if(F(xe[ct],ct,xe)===!1)break}return w}}function ix(E){return function(w){var F=vd(w=It(w))?Zs(w):u,Q=F?F[0]:w.charAt(0),le=F?ao(F,1).join(""):w.slice(1);return Q[E]()+le}}function Vp(E){return function(w){return $_(Gi(ps(w).replace(ci,"")),E,"")}}function Gp(E){return function(){var w=arguments;switch(w.length){case 0:return new E;case 1:return new E(w[0]);case 2:return new E(w[0],w[1]);case 3:return new E(w[0],w[1],w[2]);case 4:return new E(w[0],w[1],w[2],w[3]);case 5:return new E(w[0],w[1],w[2],w[3],w[4]);case 6:return new E(w[0],w[1],w[2],w[3],w[4],w[5]);case 7:return new E(w[0],w[1],w[2],w[3],w[4],w[5],w[6])}var F=Ef(E.prototype),Q=E.apply(F,w);return O(Q)?Q:F}}function JE(E){return function(w,F,Q){var le=Zi(w);if(!uo(w)){var xe=li(F,3);w=Tn(w),F=function(We){return xe(le[We],We,le)}}var Pe=E(w,F,Q);return Pe>-1?le[xe?w[Pe]:Pe]:u}}function Xm(E){return Hu(function(w){var F=w.length,Q=F,le=so.prototype.thru;for(E&&w.reverse();Q--;){var xe=w[Q];if(typeof xe!="function")throw new Kc(h);if(le&&!Pe&&Cf(xe)=="wrapper")var Pe=new so([],!0)}for(Q=Pe?Q:F;++Q<F;){var We=Cf(xe=w[Q]),ct=We=="wrapper"?tS(xe):u;Pe=ct&&rS(ct[0])&&ct[1]==424&&!ct[4].length&&ct[9]==1?Pe[Cf(ct[0])].apply(Pe,ct[3]):xe.length==1&&rS(xe)?Pe[We]():Pe.thru(xe)}return function(){var kt=arguments,Lt=kt[0];if(Pe&&kt.length==1&&Zn(Lt))return Pe.plant(Lt).value();for(var Wt=0,Rn=F?w[Wt].apply(this,kt):Lt;++Wt<F;)Rn=w[Wt].call(this,Rn);return Rn}})}function rv(E,w,F,Q,le,xe,Pe,We,ct,kt){var Lt=w&v,Wt=1&w,Rn=2&w,Un=24&w,ni=512&w,Ut=Rn?u:Gp(E);return function Qt(){for(var mi=arguments.length,Gt=dn(mi),Mn=mi;Mn--;)Gt[Mn]=arguments[Mn];if(Un)var on=Ml(Qt),In=function(Ls,xc){for(var kr=Ls.length,pr=0;kr--;)Ls[kr]===xc&&++pr;return pr}(Gt,on);if(Q&&(Gt=wf(Gt,Q,le,Un)),xe&&(Gt=iv(Gt,xe,Pe,Un)),mi-=In,Un&&mi<kt){var ln=mc(Gt,on);return Al(E,w,rv,Qt.placeholder,F,Gt,ln,We,ct,kt-mi)}var Fn=Wt?F:this,Cs=Rn?Fn[E]:E;return mi=Gt.length,We?Gt=function(Ls,xc){for(var kr=Ls.length,pr=Js(xc.length,kr),wc=Sc(Ls);pr--;){var Ql=xc[pr];Ls[pr]=Is(Ql,kr)?wc[Ql]:u}return Ls}(Gt,We):ni&&mi>1&&Gt.reverse(),Lt&&ct<mi&&(Gt.length=ct),this&&this!==bn&&this instanceof Qt&&(Cs=Ut||Gp(Cs)),Cs.apply(Fn,Gt)}}function rx(E,w){return function(F,Q){return function(le,xe,Pe,We){return ku(le,function(ct,kt,Lt){xe(We,Pe(ct),kt,Lt)}),We}(F,E,w(Q),{})}}function ay(E,w){return function(F,Q){var le;if(F===u&&Q===u)return w;if(F!==u&&(le=F),Q!==u){if(le===u)return Q;typeof F=="string"||typeof Q=="string"?(F=el(F),Q=el(Q)):(F=wh(F),Q=wh(Q)),le=E(F,Q)}return le}}function sv(E){return Hu(function(w){return w=xs(w,pc(li())),qi(function(F){var Q=this;return E(w,function(le){return $o(le,Q,F)})})})}function Zl(E,w){var F=(w=w===u?" ":el(w)).length;if(F<2)return F?ry(w,E):w;var Q=ry(w,Mu(E/wa(w)));return vd(w)?ao(Zs(Q),0,E).join(""):Q.slice(0,E)}function Mo(E){return function(w,F,Q){return Q&&typeof Q!="number"&&Zo(w,F,Q)&&(F=Q=u),w=Oe(w),F===u?(F=w,w=0):F=Oe(F),function(le,xe,Pe,We){for(var ct=-1,kt=ws(Mu((xe-le)/(Pe||1)),0),Lt=dn(kt);kt--;)Lt[We?kt:++ct]=le,le+=Pe;return Lt}(w,F,Q=Q===u?w<F?1:-1:Oe(Q),E)}}function Fu(E){return function(w,F){return typeof w=="string"&&typeof F=="string"||(w=wt(w),F=wt(F)),E(w,F)}}function Al(E,w,F,Q,le,xe,Pe,We,ct,kt){var Lt=8&w;w|=Lt?g:y,4&(w&=~(Lt?y:g))||(w&=-4);var Wt=[E,w,le,Lt?xe:u,Lt?Pe:u,Lt?u:xe,Lt?u:Pe,We,ct,kt],Rn=F.apply(u,Wt);return rS(E)&&tl(Rn,Wt),Rn.placeholder=Q,Va(Rn,E,w)}function av(E){var w=yh[E];return function(F,Q){if(F=wt(F),(Q=Q==null?0:Js(ye(Q),292))&&Ca(F)){var le=(It(F)+"e").split("e");return+((le=(It(w(le[0]+"e"+(+le[1]+Q)))+"e").split("e"))[0]+"e"+(+le[1]-Q))}return w(F)}}var eR=Aa&&1/Dm(new Aa([,-0]))[1]==T?function(E){return new Aa(E)}:ho;function Ko(E){return function(w){var F=ja(w);return F==ie?km(w):F==oe?X1(w):function(Q,le){return xs(le,function(xe){return[xe,Q[xe]]})}(w,E(w))}}function oo(E,w,F,Q,le,xe,Pe,We){var ct=2&w;if(!ct&&typeof E!="function")throw new Kc(h);var kt=Q?Q.length:0;if(kt||(w&=-97,Q=le=u),Pe=Pe===u?Pe:ws(ye(Pe),0),We=We===u?We:ye(We),kt-=le?le.length:0,w&y){var Lt=Q,Wt=le;Q=le=u}var Rn=ct?u:tS(E),Un=[E,w,F,Q,le,Lt,Wt,xe,Pe,We];if(Rn&&function(Ut,Qt){var mi=Ut[1],Gt=Qt[1],Mn=mi|Gt,on=Mn<131,In=Gt==v&&mi==8||Gt==v&&mi==b&&Ut[7].length<=Qt[8]||Gt==384&&Qt[7].length<=Qt[8]&&mi==8;if(!on&&!In)return Ut;1&Gt&&(Ut[2]=Qt[2],Mn|=1&mi?0:4);var ln=Qt[3];if(ln){var Fn=Ut[3];Ut[3]=Fn?wf(Fn,ln,Qt[4]):ln,Ut[4]=Fn?mc(Ut[3],d):Qt[4]}(ln=Qt[5])&&(Fn=Ut[5],Ut[5]=Fn?iv(Fn,ln,Qt[6]):ln,Ut[6]=Fn?mc(Ut[5],d):Qt[6]),(ln=Qt[7])&&(Ut[7]=ln),Gt&v&&(Ut[8]=Ut[8]==null?Qt[8]:Js(Ut[8],Qt[8])),Ut[9]==null&&(Ut[9]=Qt[9]),Ut[0]=Qt[0],Ut[1]=Mn}(Un,Rn),E=Un[0],w=Un[1],F=Un[2],Q=Un[3],le=Un[4],!(We=Un[9]=Un[9]===u?ct?0:E.length:ws(Un[9]-kt,0))&&24&w&&(w&=-25),w&&w!=1)ni=w==8||w==p?function(Ut,Qt,mi){var Gt=Gp(Ut);return function Mn(){for(var on=arguments.length,In=dn(on),ln=on,Fn=Ml(Mn);ln--;)In[ln]=arguments[ln];var Cs=on<3&&In[0]!==Fn&&In[on-1]!==Fn?[]:mc(In,Fn);return(on-=Cs.length)<mi?Al(Ut,Qt,rv,Mn.placeholder,u,In,Cs,u,u,mi-on):$o(this&&this!==bn&&this instanceof Mn?Gt:Ut,this,In)}}(E,w,We):w!=g&&w!=33||le.length?rv.apply(u,Un):function(Ut,Qt,mi,Gt){var Mn=1&Qt,on=Gp(Ut);return function In(){for(var ln=-1,Fn=arguments.length,Cs=-1,Ls=Gt.length,xc=dn(Ls+Fn),kr=this&&this!==bn&&this instanceof In?on:Ut;++Cs<Ls;)xc[Cs]=Gt[Cs];for(;Fn--;)xc[Cs++]=arguments[++ln];return $o(kr,Mn?mi:this,xc)}}(E,w,F,Q);else var ni=function(Ut,Qt,mi){var Gt=1&Qt,Mn=Gp(Ut);return function on(){return(this&&this!==bn&&this instanceof on?Mn:Ut).apply(Gt?mi:this,arguments)}}(E,w,F);return Va((Rn?xf:tl)(ni,Un),E,w)}function zu(E,w,F,Q){return E===u||ks(E,Au[F])&&!Rr.call(Q,F)?w:E}function Rl(E,w,F,Q,le,xe){return O(E)&&O(w)&&(xe.set(w,E),Z0(E,w,u,Rl,xe),xe.delete(w)),E}function fs(E){return te(E)?u:E}function QE(E,w,F,Q,le,xe){var Pe=1&F,We=E.length,ct=w.length;if(We!=ct&&!(Pe&&ct>We))return!1;var kt=xe.get(E),Lt=xe.get(w);if(kt&&Lt)return kt==w&&Lt==E;var Wt=-1,Rn=!0,Un=2&F?new Nu:u;for(xe.set(E,w),xe.set(w,E);++Wt<We;){var ni=E[Wt],Ut=w[Wt];if(Q)var Qt=Pe?Q(Ut,ni,Wt,w,E,xe):Q(ni,Ut,Wt,E,w,xe);if(Qt!==u){if(Qt)continue;Rn=!1;break}if(Un){if(!W_(w,function(mi,Gt){if(!vf(Un,Gt)&&(ni===mi||le(ni,mi,F,Q,xe)))return Un.push(Gt)})){Rn=!1;break}}else if(ni!==Ut&&!le(ni,Ut,F,Q,xe)){Rn=!1;break}}return xe.delete(E),xe.delete(w),Rn}function Hu(E){return uy(Km(E,u,cx),E+"")}function eS(E){return Kl(E,Tn,ov)}function oy(E){return Kl(E,$n,nS)}var tS=bf?function(E){return bf.get(E)}:ho;function Cf(E){for(var w=E.name+"",F=da[w],Q=Rr.call(da,w)?F.length:0;Q--;){var le=F[Q],xe=le.func;if(xe==null||xe==E)return le.name}return w}function Ml(E){return(Rr.call(ge,"placeholder")?ge:E).placeholder}function li(){var E=ge.iteratee||nc;return E=E===nc?$E:E,arguments.length?E(arguments[0],arguments[1]):E}function cy(E,w){var F,Q,le=E.__data__;return((Q=typeof(F=w))=="string"||Q=="number"||Q=="symbol"||Q=="boolean"?F!=="__proto__":F===null)?le[typeof w=="string"?"string":"hash"]:le.map}function ti(E){for(var w=Tn(E),F=w.length;F--;){var Q=w[F],le=E[Q];w[F]=[Q,le,ax(le)]}return w}function Ol(E,w){var F=function(Q,le){return Q==null?u:Q[le]}(E,w);return J1(F)?F:u}var ov=z0?function(E){return E==null?[]:(E=Zi(E),Cu(z0(E),function(w){return L0.call(E,w)}))}:Mf,nS=z0?function(E){for(var w=[];E;)vh(w,ov(E)),E=Lm(E);return w}:Mf,ja=pa;function qp(E,w,F){for(var Q=-1,le=(w=Ah(w,E)).length,xe=!1;++Q<le;){var Pe=ju(w[Q]);if(!(xe=E!=null&&F(E,Pe)))break;E=E[Pe]}return xe||++Q!=le?xe:!!(le=E==null?0:E.length)&&A(le)&&Is(Pe,le)&&(Zn(E)||Vr(E))}function sx(E){return typeof E.constructor!="function"||cv(E)?{}:Ef(Lm(E))}function iS(E){return Zn(E)||Vr(E)||!!(U0&&E&&E[U0])}function Is(E,w){var F=typeof E;return!!(w=w??x)&&(F=="number"||F!="symbol"&&an.test(E))&&E>-1&&E%1==0&&E<w}function Zo(E,w,F){if(!O(F))return!1;var Q=typeof w;return!!(Q=="number"?uo(F)&&Is(w,F.length):Q=="string"&&w in F)&&ks(F[w],E)}function ly(E,w){if(Zn(E))return!1;var F=typeof E;return!(F!="number"&&F!="symbol"&&F!="boolean"&&E!=null&&!he(E))||Ue.test(E)||!$e.test(E)||w!=null&&E in Zi(w)}function rS(E){var w=Cf(E),F=ge[w];if(typeof F!="function"||!(w in Fi.prototype))return!1;if(E===F)return!0;var Q=tS(F);return!!Q&&E===Q[0]}(H0&&ja(new H0(new ArrayBuffer(1)))!=Le||Ao&&ja(new Ao)!=ie||Bt&&ja(Bt.resolve())!=X||Aa&&ja(new Aa)!=oe||Bm&&ja(new Bm)!=He)&&(ja=function(E){var w=pa(E),F=w==J?E.constructor:u,Q=F?$p(F):"";if(Q)switch(Q){case j0:return Le;case _c:return ie;case Z1:return X;case wl:return oe;case Lp:return He}return w});var tR=Zc?N:kh;function cv(E){var w=E&&E.constructor;return E===(typeof w=="function"&&w.prototype||Au)}function ax(E){return E==E&&!O(E)}function ox(E,w){return function(F){return F!=null&&F[E]===w&&(w!==u||E in Zi(F))}}function Km(E,w,F){return w=ws(w===u?E.length-1:w,0),function(){for(var Q=arguments,le=-1,xe=ws(Q.length-w,0),Pe=dn(xe);++le<xe;)Pe[le]=Q[w+le];le=-1;for(var We=dn(w+1);++le<w;)We[le]=Q[le];return We[w]=F(Pe),$o(E,this,We)}}function sS(E,w){return w.length<2?E:Gs(E,hs(w,0,-1))}function lv(E,w){if((w!=="constructor"||typeof E[w]!="function")&&w!="__proto__")return E[w]}var tl=Jm(xf),Zm=F0||function(E,w){return bn.setTimeout(E,w)},uy=Jm(Vi);function Va(E,w,F){var Q=w+"";return uy(E,function(le,xe){var Pe=xe.length;if(!Pe)return le;var We=Pe-1;return xe[We]=(Pe>1?"& ":"")+xe[We],xe=xe.join(Pe>2?", ":" "),le.replace(W,`{
/* [wrapped with `+xe+`] */
`)}(Q,function(le,xe){return Wo(I,function(Pe){var We="_."+Pe[0];xe&Pe[1]&&!Nm(le,We)&&le.push(We)}),le.sort()}(function(le){var xe=le.match(me);return xe?xe[1].split(De):[]}(Q),F)))}function Jm(E){var w=0,F=0;return function(){var Q=Ii(),le=16-(Q-F);if(F=Q,le>0){if(++w>=800)return arguments[0]}else w=0;return E.apply(u,arguments)}}function uv(E,w){var F=-1,Q=E.length,le=Q-1;for(w=w===u?Q:w;++F<w;){var xe=XE(F,le),Pe=E[xe];E[xe]=E[F],E[F]=Pe}return E.length=w,E}var hy=function(E){var w=ec(E,function(Q){return F.size===500&&F.clear(),Q}),F=w.cache;return w}(function(E){var w=[];return E.charCodeAt(0)===46&&w.push(""),E.replace(qt,function(F,Q,le,xe){w.push(le?xe.replace(xt,"$1"):Q||F)}),w});function ju(E){if(typeof E=="string"||he(E))return E;var w=E+"";return w=="0"&&1/E==-1/0?"-0":w}function $p(E){if(E!=null){try{return za.call(E)}catch{}try{return E+""}catch{}}return""}function aS(E){if(E instanceof Fi)return E.clone();var w=new so(E.__wrapped__,E.__chain__);return w.__actions__=Sc(E.__actions__),w.__index__=E.__index__,w.__values__=E.__values__,w}var Qm=qi(function(E,w){return Ds(E)?xd(E,Ha(w,1,Ds,!0)):[]}),Ga=qi(function(E,w){var F=No(w);return Ds(F)&&(F=u),Ds(E)?xd(E,Ha(w,1,Ds,!0),li(F,2)):[]}),eg=qi(function(E,w){var F=No(w);return Ds(F)&&(F=u),Ds(E)?xd(E,Ha(w,1,Ds,!0),u,F):[]});function ma(E,w,F){var Q=E==null?0:E.length;if(!Q)return-1;var le=F==null?0:ye(F);return le<0&&(le=ws(Q+le,0)),md(E,li(w,3),le)}function Rh(E,w,F){var Q=E==null?0:E.length;if(!Q)return-1;var le=Q-1;return F!==u&&(le=ye(F),le=F<0?ws(Q+le,0):Js(le,Q-1)),md(E,li(w,3),le,!0)}function cx(E){return E!=null&&E.length?Ha(E,1):[]}function tg(E){return E&&E.length?E[0]:u}var fy=qi(function(E){var w=xs(E,nv);return w.length&&w[0]===E[0]?ty(w):[]}),Jo=qi(function(E){var w=No(E),F=xs(E,nv);return w===No(F)?w=u:F.pop(),F.length&&F[0]===E[0]?ty(F,li(w,2)):[]}),Oo=qi(function(E){var w=No(E),F=xs(E,nv);return(w=typeof w=="function"?w:u)&&F.pop(),F.length&&F[0]===E[0]?ty(F,u,w):[]});function No(E){var w=E==null?0:E.length;return w?E[w-1]:u}var oS=qi(lx);function lx(E,w){return E&&E.length&&w&&w.length?Q0(E,w):E}var Af=Hu(function(E,w){var F=E==null?0:E.length,Q=q0(E,w);return iy(E,xs(w,function(le){return Is(le,F)?+le:le}).sort(jp)),Q});function Er(E){return E==null?E:Pp.call(E)}var nR=qi(function(E){return Ch(Ha(E,1,Ds,!0))}),iR=qi(function(E){var w=No(E);return Ds(w)&&(w=u),Ch(Ha(E,1,Ds,!0),li(w,2))}),rR=qi(function(E){var w=No(E);return w=typeof w=="function"?w:u,Ch(Ha(E,1,Ds,!0),u,w)});function ng(E){if(!E||!E.length)return[];var w=0;return E=Cu(E,function(F){if(Ds(F))return w=ws(F.length,w),!0}),Im(w,function(F){return xs(E,N0(F))})}function ig(E,w){if(!E||!E.length)return[];var F=ng(E);return w==null?F:xs(F,function(Q){return $o(w,u,Q)})}var hv=qi(function(E,w){return Ds(E)?xd(E,w):[]}),sR=qi(function(E){return tv(Cu(E,Ds))}),aR=qi(function(E){var w=No(E);return Ds(w)&&(w=u),tv(Cu(E,Ds),li(w,2))}),ux=qi(function(E){var w=No(E);return w=typeof w=="function"?w:u,tv(Cu(E,Ds),u,w)}),Vu=qi(ng),Gu=qi(function(E){var w=E.length,F=w>1?E[w-1]:u;return F=typeof F=="function"?(E.pop(),F):u,ig(E,F)});function co(E){var w=ge(E);return w.__chain__=!0,w}function Mh(E,w){return w(E)}var Rf=Hu(function(E){var w=E.length,F=w?E[0]:0,Q=this.__wrapped__,le=function(xe){return q0(xe,E)};return!(w>1||this.__actions__.length)&&Q instanceof Fi&&Is(F)?((Q=Q.slice(F,+F+(w?1:0))).__actions__.push({func:Mh,args:[le],thisArg:u}),new so(Q,this.__chain__).thru(function(xe){return w&&!xe.length&&xe.push(u),xe})):this.thru(le)}),Oh=Cd(function(E,w,F){Rr.call(E,F)?++E[F]:Iu(E,F,1)}),qs=JE(ma),Qo=JE(Rh);function cS(E,w){return(Zn(E)?Wo:Cl)(E,li(w,3))}function fv(E,w){return(Zn(E)?G1:$0)(E,li(w,3))}var lS=Cd(function(E,w,F){Rr.call(E,F)?E[F].push(w):Iu(E,F,[w])}),oR=qi(function(E,w,F){var Q=-1,le=typeof w=="function",xe=uo(E)?dn(E.length):[];return Cl(E,function(Pe){xe[++Q]=le?$o(w,Pe,F):Ec(Pe,w,F)}),xe}),hx=Cd(function(E,w,F){Iu(E,F,w)});function dy(E,w){return(Zn(E)?xs:Pu)(E,li(w,3))}var uS=Cd(function(E,w,F){E[F?0:1].push(w)},function(){return[[],[]]}),cR=qi(function(E,w){if(E==null)return[];var F=w.length;return F>1&&Zo(E,w[0],w[1])?w=[]:F>2&&Zo(w[0],w[1],w[2])&&(w=[w[0]]),wd(E,Ha(w,1),[])}),Ra=fa||function(){return bn.Date.now()};function rg(E,w,F){return w=F?u:w,w=E&&w==null?E.length:w,oo(E,v,u,u,u,u,w)}function py(E,w){var F;if(typeof w!="function")throw new Kc(h);return E=ye(E),function(){return--E>0&&(F=w.apply(this,arguments)),E<=1&&(w=u),F}}var hS=qi(function(E,w,F){var Q=1;if(F.length){var le=mc(F,Ml(hS));Q|=g}return oo(E,Q,w,F,le)}),fS=qi(function(E,w,F){var Q=3;if(F.length){var le=mc(F,Ml(fS));Q|=g}return oo(w,Q,E,F,le)});function dS(E,w,F){var Q,le,xe,Pe,We,ct,kt=0,Lt=!1,Wt=!1,Rn=!0;if(typeof E!="function")throw new Kc(h);function Un(Gt){var Mn=Q,on=le;return Q=le=u,kt=Gt,Pe=E.apply(on,Mn)}function ni(Gt){var Mn=Gt-ct;return ct===u||Mn>=w||Mn<0||Wt&&Gt-kt>=xe}function Ut(){var Gt=Ra();if(ni(Gt))return Qt(Gt);We=Zm(Ut,function(Mn){var on=w-(Mn-ct);return Wt?Js(on,xe-(Mn-kt)):on}(Gt))}function Qt(Gt){return We=u,Rn&&Q?Un(Gt):(Q=le=u,Pe)}function mi(){var Gt=Ra(),Mn=ni(Gt);if(Q=arguments,le=this,ct=Gt,Mn){if(We===u)return function(on){return kt=on,We=Zm(Ut,w),Lt?Un(on):Pe}(ct);if(Wt)return ZE(We),We=Zm(Ut,w),Un(ct)}return We===u&&(We=Zm(Ut,w)),Pe}return w=wt(w)||0,O(F)&&(Lt=!!F.leading,xe=(Wt="maxWait"in F)?ws(wt(F.maxWait)||0,w):xe,Rn="trailing"in F?!!F.trailing:Rn),mi.cancel=function(){We!==u&&ZE(We),kt=0,Q=ct=le=We=u},mi.flush=function(){return We===u?Pe:Qt(Ra())},mi}var lo=qi(function(E,w){return ey(E,1,w)}),Ad=qi(function(E,w,F){return ey(E,wt(w)||0,F)});function ec(E,w){if(typeof E!="function"||w!=null&&typeof w!="function")throw new Kc(h);var F=function(){var Q=arguments,le=w?w.apply(this,Q):Q[0],xe=F.cache;if(xe.has(le))return xe.get(le);var Pe=E.apply(this,Q);return F.cache=xe.set(le,Pe)||xe,Pe};return F.cache=new(ec.Cache||Qc),F}function tc(E){if(typeof E!="function")throw new Kc(h);return function(){var w=arguments;switch(w.length){case 0:return!E.call(this);case 1:return!E.call(this,w[0]);case 2:return!E.call(this,w[0],w[1]);case 3:return!E.call(this,w[0],w[1],w[2])}return!E.apply(this,w)}}ec.Cache=Qc;var lR=QA(function(E,w){var F=(w=w.length==1&&Zn(w[0])?xs(w[0],pc(li())):xs(Ha(w,1),pc(li()))).length;return qi(function(Q){for(var le=-1,xe=Js(Q.length,F);++le<xe;)Q[le]=w[le].call(this,Q[le]);return $o(E,this,Q)})}),my=qi(function(E,w){var F=mc(w,Ml(my));return oo(E,g,u,w,F)}),dv=qi(function(E,w){var F=mc(w,Ml(dv));return oo(E,y,u,w,F)}),qa=Hu(function(E,w){return oo(E,b,u,u,u,w)});function ks(E,w){return E===w||E!=E&&w!=w}var Nh=Fu(jr),uR=Fu(function(E,w){return E>=w}),Vr=Y0(function(){return arguments}())?Y0:function(E){return L(E)&&Rr.call(E,"callee")&&!L0.call(E,"callee")},Zn=dn.isArray,fx=Ip?pc(Ip):function(E){return L(E)&&pa(E)==Te};function uo(E){return E!=null&&A(E.length)&&!N(E)}function Ds(E){return L(E)&&uo(E)}var Rd=Dp||kh,sg=mf?pc(mf):function(E){return L(E)&&pa(E)==G};function pS(E){if(!L(E))return!1;var w=pa(E);return w==$||w=="[object DOMException]"||typeof E.message=="string"&&typeof E.name=="string"&&!te(E)}function N(E){if(!O(E))return!1;var w=pa(E);return w==q||w==Y||w=="[object AsyncFunction]"||w=="[object Proxy]"}function S(E){return typeof E=="number"&&E==ye(E)}function A(E){return typeof E=="number"&&E>-1&&E%1==0&&E<=x}function O(E){var w=typeof E;return E!=null&&(w=="object"||w=="function")}function L(E){return E!=null&&typeof E=="object"}var B=gh?pc(gh):function(E){return L(E)&&ja(E)==ie};function H(E){return typeof E=="number"||L(E)&&pa(E)==V}function te(E){if(!L(E)||pa(E)!=J)return!1;var w=Lm(E);if(w===null)return!0;var F=Rr.call(w,"constructor")&&w.constructor;return typeof F=="function"&&F instanceof F&&za.call(F)==yd}var re=R0?pc(R0):function(E){return L(E)&&pa(E)==ee},K=q_?pc(q_):function(E){return L(E)&&ja(E)==oe};function ae(E){return typeof E=="string"||!Zn(E)&&L(E)&&pa(E)==fe}function he(E){return typeof E=="symbol"||L(E)&&pa(E)==Re}var pe=M0?pc(M0):function(E){return L(E)&&A(E.length)&&!!Ti[pa(E)]},Ne=Fu(ny),Je=Fu(function(E,w){return E<=w});function Ye(E){if(!E)return[];if(uo(E))return ae(E)?Zs(E):Sc(E);if(Ru&&E[Ru])return function(F){for(var Q,le=[];!(Q=F.next()).done;)le.push(Q.value);return le}(E[Ru]());var w=ja(E);return(w==ie?km:w==oe?Dm:fr)(E)}function Oe(E){return E?(E=wt(E))===T||E===-1/0?17976931348623157e292*(E<0?-1:1):E==E?E:0:E===0?E:0}function ye(E){var w=Oe(E),F=w%1;return w==w?F?w-F:w:0}function lt(E){return E?Tf(ye(E),0,R):0}function wt(E){if(typeof E=="number")return E;if(he(E))return M;if(O(E)){var w=typeof E.valueOf=="function"?E.valueOf():E;E=O(w)?w+"":w}if(typeof E!="string")return E===0?E:+E;E=FE(E);var F=ht.test(E);return F||hn.test(E)?no(E.slice(2),F?2:8):Vt.test(E)?M:+E}function Kt(E){return Bu(E,$n(E))}function It(E){return E==null?"":el(E)}var Kn=Ym(function(E,w){if(cv(w)||uo(w))Bu(w,Tn(w),E);else for(var F in w)Rr.call(w,F)&&Td(E,F,w[F])}),wn=Ym(function(E,w){Bu(w,$n(w),E)}),_i=Ym(function(E,w,F,Q){Bu(w,$n(w),E,Q)}),zi=Ym(function(E,w,F,Q){Bu(w,Tn(w),E,Q)}),ki=Hu(q0),xi=qi(function(E,w){E=Zi(E);var F=-1,Q=w.length,le=Q>2?w[2]:u;for(le&&Zo(w[0],w[1],le)&&(Q=1);++F<Q;)for(var xe=w[F],Pe=$n(xe),We=-1,ct=Pe.length;++We<ct;){var kt=Pe[We],Lt=E[kt];(Lt===u||ks(Lt,Au[kt])&&!Rr.call(E,kt))&&(E[kt]=xe[kt])}return E}),yi=qi(function(E){return E.push(u,Rl),$o(Jr,u,E)});function Ri(E,w,F){var Q=E==null?u:Gs(E,w);return Q===u?F:Q}function Di(E,w){return E!=null&&qp(E,w,Vm)}var bi=rx(function(E,w,F){w!=null&&typeof w.toString!="function"&&(w=_d.call(w)),E[w]=F},Io(ms)),Mi=rx(function(E,w,F){w!=null&&typeof w.toString!="function"&&(w=_d.call(w)),Rr.call(E,w)?E[w].push(F):E[w]=[F]},li),ui=qi(Ec);function Tn(E){return uo(E)?J_(E):WE(E)}function $n(E){return uo(E)?J_(E,!0):Q1(E)}var $i=Ym(function(E,w,F){Z0(E,w,F)}),Jr=Ym(function(E,w,F,Q){Z0(E,w,F,Q)}),Es=Hu(function(E,w){var F={};if(E==null)return F;var Q=!1;w=xs(w,function(xe){return xe=Ah(xe,E),Q||(Q=xe.length>1),xe}),Bu(E,oy(E),F),Q&&(F=bc(F,7,fs));for(var le=w.length;le--;)zp(F,w[le]);return F}),Qr=Hu(function(E,w){return E==null?{}:function(F,Q){return YE(F,Q,function(le,xe){return Di(F,xe)})}(E,w)});function ds(E,w){if(E==null)return{};var F=xs(oy(E),function(Q){return[Q]});return w=li(w),YE(E,F,function(Q,le){return w(Q,le[0])})}var es=Ko(Tn),Ir=Ko($n);function fr(E){return E==null?[]:Ns(E,Tn(E))}var Wr=Vp(function(E,w,F){return w=w.toLowerCase(),E+(F?ts(w):w)});function ts(E){return Jn(It(E).toLowerCase())}function ps(E){return(E=It(E))&&E.replace(Ge,W1).replace(Cn,"")}var Qs=Vp(function(E,w,F){return E+(F?"-":"")+w.toLowerCase()}),ga=Vp(function(E,w,F){return E+(F?" ":"")+w.toLowerCase()}),Ss=ix("toLowerCase"),Ps=Vp(function(E,w,F){return E+(F?"_":"")+w.toLowerCase()}),dr=Vp(function(E,w,F){return E+(F?" ":"")+Jn(w)}),Ma=Vp(function(E,w,F){return E+(F?" ":"")+w.toUpperCase()}),Jn=ix("toUpperCase");function Gi(E,w,F){return E=It(E),(w=F?u:w)===u?function(Q){return bs.test(Q)}(E)?function(Q){return Q.match(ar)||[]}(E):function(Q){return Q.match(Ve)||[]}(E):E.match(w)||[]}var Mr=qi(function(E,w){try{return $o(E,u,w)}catch(F){return pS(F)?F:new ji(F)}}),$a=Hu(function(E,w){return Wo(w,function(F){F=ju(F),Iu(E,F,hS(E[F],E))}),E});function Io(E){return function(){return E}}var Tc=Xm(),nl=Xm(!0);function ms(E){return E}function nc(E){return $E(typeof E=="function"?E:bc(E,1))}var Ih=qi(function(E,w){return function(F){return Ec(F,E,w)}}),Jl=qi(function(E,w){return function(F){return Ec(E,F,w)}});function Oa(E,w,F){var Q=Tn(w),le=Du(w,Q);F!=null||O(w)&&(le.length||!Q.length)||(F=w,w=E,E=this,le=Du(w,Tn(w)));var xe=!(O(F)&&"chain"in F&&!F.chain),Pe=N(E);return Wo(le,function(We){var ct=w[We];E[We]=ct,Pe&&(E.prototype[We]=function(){var kt=this.__chain__;if(xe||kt){var Lt=E(this.__wrapped__);return(Lt.__actions__=Sc(this.__actions__)).push({func:ct,args:arguments,thisArg:E}),Lt.__chain__=kt,Lt}return ct.apply(E,vh([this.value()],arguments))})}),E}function ho(){}var ko=sv(xs),ic=sv(kE),Md=sv(W_);function Od(E){return ly(E)?N0(ju(E)):function(w){return function(F){return Gs(F,w)}}(E)}var Wp=Mo(),$s=Mo(!0);function Mf(){return[]}function kh(){return!1}var qu=ay(function(E,w){return E+w},0),Nl=av("ceil"),pv=ay(function(E,w){return E/w},1),gy=av("floor"),mv,Yr=ay(function(E,w){return E*w},1),gv=av("round"),Dh=ay(function(E,w){return E-w},0);return ge.after=function(E,w){if(typeof w!="function")throw new Kc(h);return E=ye(E),function(){if(--E<1)return w.apply(this,arguments)}},ge.ary=rg,ge.assign=Kn,ge.assignIn=wn,ge.assignInWith=_i,ge.assignWith=zi,ge.at=ki,ge.before=py,ge.bind=hS,ge.bindAll=$a,ge.bindKey=fS,ge.castArray=function(){if(!arguments.length)return[];var E=arguments[0];return Zn(E)?E:[E]},ge.chain=co,ge.chunk=function(E,w,F){w=(F?Zo(E,w,F):w===u)?1:ws(ye(w),0);var Q=E==null?0:E.length;if(!Q||w<1)return[];for(var le=0,xe=0,Pe=dn(Mu(Q/w));le<Q;)Pe[xe++]=hs(E,le,le+=w);return Pe},ge.compact=function(E){for(var w=-1,F=E==null?0:E.length,Q=0,le=[];++w<F;){var xe=E[w];xe&&(le[Q++]=xe)}return le},ge.concat=function(){var E=arguments.length;if(!E)return[];for(var w=dn(E-1),F=arguments[0],Q=E;Q--;)w[Q-1]=arguments[Q];return vh(Zn(F)?Sc(F):[F],Ha(w,1))},ge.cond=function(E){var w=E==null?0:E.length,F=li();return E=w?xs(E,function(Q){if(typeof Q[1]!="function")throw new Kc(h);return[F(Q[0]),Q[1]]}):[],qi(function(Q){for(var le=-1;++le<w;){var xe=E[le];if($o(xe[0],this,Q))return $o(xe[1],this,Q)}})},ge.conforms=function(E){return function(w){var F=Tn(w);return function(Q){return us(Q,w,F)}}(bc(E,1))},ge.constant=Io,ge.countBy=Oh,ge.create=function(E,w){var F=Ef(E);return w==null?F:Xo(F,w)},ge.curry=function E(w,F,Q){var le=oo(w,8,u,u,u,u,u,F=Q?u:F);return le.placeholder=E.placeholder,le},ge.curryRight=function E(w,F,Q){var le=oo(w,p,u,u,u,u,u,F=Q?u:F);return le.placeholder=E.placeholder,le},ge.debounce=dS,ge.defaults=xi,ge.defaultsDeep=yi,ge.defer=lo,ge.delay=Ad,ge.difference=Qm,ge.differenceBy=Ga,ge.differenceWith=eg,ge.drop=function(E,w,F){var Q=E==null?0:E.length;return Q?hs(E,(w=F||w===u?1:ye(w))<0?0:w,Q):[]},ge.dropRight=function(E,w,F){var Q=E==null?0:E.length;return Q?hs(E,0,(w=Q-(w=F||w===u?1:ye(w)))<0?0:w):[]},ge.dropRightWhile=function(E,w){return E&&E.length?Lu(E,li(w,3),!0,!0):[]},ge.dropWhile=function(E,w){return E&&E.length?Lu(E,li(w,3),!0):[]},ge.fill=function(E,w,F,Q){var le=E==null?0:E.length;return le?(F&&typeof F!="number"&&Zo(E,w,F)&&(F=0,Q=le),function(xe,Pe,We,ct){var kt=xe.length;for((We=ye(We))<0&&(We=-We>kt?0:kt+We),(ct=ct===u||ct>kt?kt:ye(ct))<0&&(ct+=kt),ct=We>ct?0:lt(ct);We<ct;)xe[We++]=Pe;return xe}(E,w,F,Q)):[]},ge.filter=function(E,w){return(Zn(E)?Cu:Hm)(E,li(w,3))},ge.flatMap=function(E,w){return Ha(dy(E,w),1)},ge.flatMapDeep=function(E,w){return Ha(dy(E,w),T)},ge.flatMapDepth=function(E,w,F){return F=F===u?1:ye(F),Ha(dy(E,w),F)},ge.flatten=cx,ge.flattenDeep=function(E){return E!=null&&E.length?Ha(E,T):[]},ge.flattenDepth=function(E,w){return E!=null&&E.length?Ha(E,w=w===u?1:ye(w)):[]},ge.flip=function(E){return oo(E,512)},ge.flow=Tc,ge.flowRight=nl,ge.fromPairs=function(E){for(var w=-1,F=E==null?0:E.length,Q={};++w<F;){var le=E[w];Q[le[0]]=le[1]}return Q},ge.functions=function(E){return E==null?[]:Du(E,Tn(E))},ge.functionsIn=function(E){return E==null?[]:Du(E,$n(E))},ge.groupBy=lS,ge.initial=function(E){return E!=null&&E.length?hs(E,0,-1):[]},ge.intersection=fy,ge.intersectionBy=Jo,ge.intersectionWith=Oo,ge.invert=bi,ge.invertBy=Mi,ge.invokeMap=oR,ge.iteratee=nc,ge.keyBy=hx,ge.keys=Tn,ge.keysIn=$n,ge.map=dy,ge.mapKeys=function(E,w){var F={};return w=li(w,3),ku(E,function(Q,le,xe){Iu(F,w(Q,le,xe),Q)}),F},ge.mapValues=function(E,w){var F={};return w=li(w,3),ku(E,function(Q,le,xe){Iu(F,le,w(Q,le,xe))}),F},ge.matches=function(E){return K0(bc(E,1))},ge.matchesProperty=function(E,w){return Th(E,bc(w,1))},ge.memoize=ec,ge.merge=$i,ge.mergeWith=Jr,ge.method=Ih,ge.methodOf=Jl,ge.mixin=Oa,ge.negate=tc,ge.nthArg=function(E){return E=ye(E),qi(function(w){return J0(w,E)})},ge.omit=Es,ge.omitBy=function(E,w){return ds(E,tc(li(w)))},ge.once=function(E){return py(2,E)},ge.orderBy=function(E,w,F,Q){return E==null?[]:(Zn(w)||(w=w==null?[]:[w]),Zn(F=Q?u:F)||(F=F==null?[]:[F]),wd(E,w,F))},ge.over=ko,ge.overArgs=lR,ge.overEvery=ic,ge.overSome=Md,ge.partial=my,ge.partialRight=dv,ge.partition=uS,ge.pick=Qr,ge.pickBy=ds,ge.property=Od,ge.propertyOf=function(E){return function(w){return E==null?u:Gs(E,w)}},ge.pull=oS,ge.pullAll=lx,ge.pullAllBy=function(E,w,F){return E&&E.length&&w&&w.length?Q0(E,w,li(F,2)):E},ge.pullAllWith=function(E,w,F){return E&&E.length&&w&&w.length?Q0(E,w,u,F):E},ge.pullAt=Af,ge.range=Wp,ge.rangeRight=$s,ge.rearg=qa,ge.reject=function(E,w){return(Zn(E)?Cu:Hm)(E,tc(li(w,3)))},ge.remove=function(E,w){var F=[];if(!E||!E.length)return F;var Q=-1,le=[],xe=E.length;for(w=li(w,3);++Q<xe;){var Pe=E[Q];w(Pe,Q,E)&&(F.push(Pe),le.push(Q))}return iy(E,le),F},ge.rest=function(E,w){if(typeof E!="function")throw new Kc(h);return qi(E,w=w===u?w:ye(w))},ge.reverse=Er,ge.sampleSize=function(E,w,F){return w=(F?Zo(E,w,F):w===u)?1:ye(w),(Zn(E)?Q_:ex)(E,w)},ge.set=function(E,w,F){return E==null?E:Gm(E,w,F)},ge.setWith=function(E,w,F,Q){return Q=typeof Q=="function"?Q:u,E==null?E:Gm(E,w,F,Q)},ge.shuffle=function(E){return(Zn(E)?V0:Up)(E)},ge.slice=function(E,w,F){var Q=E==null?0:E.length;return Q?(F&&typeof F!="number"&&Zo(E,w,F)?(w=0,F=Q):(w=w==null?0:ye(w),F=F===u?Q:ye(F)),hs(E,w,F)):[]},ge.sortBy=cR,ge.sortedUniq=function(E){return E&&E.length?Fp(E):[]},ge.sortedUniqBy=function(E,w){return E&&E.length?Fp(E,li(w,2)):[]},ge.split=function(E,w,F){return F&&typeof F!="number"&&Zo(E,w,F)&&(w=F=u),(F=F===u?R:F>>>0)?(E=It(E))&&(typeof w=="string"||w!=null&&!re(w))&&!(w=el(w))&&vd(E)?ao(Zs(E),0,F):E.split(w,F):[]},ge.spread=function(E,w){if(typeof E!="function")throw new Kc(h);return w=w==null?0:ws(ye(w),0),qi(function(F){var Q=F[w],le=ao(F,0,w);return Q&&vh(le,Q),$o(E,this,le)})},ge.tail=function(E){var w=E==null?0:E.length;return w?hs(E,1,w):[]},ge.take=function(E,w,F){return E&&E.length?hs(E,0,(w=F||w===u?1:ye(w))<0?0:w):[]},ge.takeRight=function(E,w,F){var Q=E==null?0:E.length;return Q?hs(E,(w=Q-(w=F||w===u?1:ye(w)))<0?0:w,Q):[]},ge.takeRightWhile=function(E,w){return E&&E.length?Lu(E,li(w,3),!1,!0):[]},ge.takeWhile=function(E,w){return E&&E.length?Lu(E,li(w,3)):[]},ge.tap=function(E,w){return w(E),E},ge.throttle=function(E,w,F){var Q=!0,le=!0;if(typeof E!="function")throw new Kc(h);return O(F)&&(Q="leading"in F?!!F.leading:Q,le="trailing"in F?!!F.trailing:le),dS(E,w,{leading:Q,maxWait:w,trailing:le})},ge.thru=Mh,ge.toArray=Ye,ge.toPairs=es,ge.toPairsIn=Ir,ge.toPath=function(E){return Zn(E)?xs(E,ju):he(E)?[E]:Sc(hy(It(E)))},ge.toPlainObject=Kt,ge.transform=function(E,w,F){var Q=Zn(E),le=Q||Rd(E)||pe(E);if(w=li(w,4),F==null){var xe=E&&E.constructor;F=le?Q?new xe:[]:O(E)&&N(xe)?Ef(Lm(E)):{}}return(le?Wo:ku)(E,function(Pe,We,ct){return w(F,Pe,We,ct)}),F},ge.unary=function(E){return rg(E,1)},ge.union=nR,ge.unionBy=iR,ge.unionWith=rR,ge.uniq=function(E){return E&&E.length?Ch(E):[]},ge.uniqBy=function(E,w){return E&&E.length?Ch(E,li(w,2)):[]},ge.uniqWith=function(E,w){return w=typeof w=="function"?w:u,E&&E.length?Ch(E,u,w):[]},ge.unset=function(E,w){return E==null||zp(E,w)},ge.unzip=ng,ge.unzipWith=ig,ge.update=function(E,w,F){return E==null?E:KE(E,w,Uu(F))},ge.updateWith=function(E,w,F,Q){return Q=typeof Q=="function"?Q:u,E==null?E:KE(E,w,Uu(F),Q)},ge.values=fr,ge.valuesIn=function(E){return E==null?[]:Ns(E,$n(E))},ge.without=hv,ge.words=Gi,ge.wrap=function(E,w){return my(Uu(w),E)},ge.xor=sR,ge.xorBy=aR,ge.xorWith=ux,ge.zip=Vu,ge.zipObject=function(E,w){return Hp(E||[],w||[],Td)},ge.zipObjectDeep=function(E,w){return Hp(E||[],w||[],Gm)},ge.zipWith=Gu,ge.entries=es,ge.entriesIn=Ir,ge.extend=wn,ge.extendWith=_i,Oa(ge,ge),ge.add=qu,ge.attempt=Mr,ge.camelCase=Wr,ge.capitalize=ts,ge.ceil=Nl,ge.clamp=function(E,w,F){return F===u&&(F=w,w=u),F!==u&&(F=(F=wt(F))==F?F:0),w!==u&&(w=(w=wt(w))==w?w:0),Tf(wt(E),w,F)},ge.clone=function(E){return bc(E,4)},ge.cloneDeep=function(E){return bc(E,5)},ge.cloneDeepWith=function(E,w){return bc(E,5,w=typeof w=="function"?w:u)},ge.cloneWith=function(E,w){return bc(E,4,w=typeof w=="function"?w:u)},ge.conformsTo=function(E,w){return w==null||us(E,w,Tn(w))},ge.deburr=ps,ge.defaultTo=function(E,w){return E==null||E!=E?w:E},ge.divide=pv,ge.endsWith=function(E,w,F){E=It(E),w=el(w);var Q=E.length,le=F=F===u?Q:Tf(ye(F),0,Q);return(F-=w.length)>=0&&E.slice(F,le)==w},ge.eq=ks,ge.escape=function(E){return(E=It(E))&&be.test(E)?E.replace(gt,I0):E},ge.escapeRegExp=function(E){return(E=It(E))&&Yt.test(E)?E.replace(Ot,"\\$&"):E},ge.every=function(E,w,F){var Q=Zn(E)?kE:VE;return F&&Zo(E,w,F)&&(w=u),Q(E,li(w,3))},ge.find=qs,ge.findIndex=ma,ge.findKey=function(E,w){return PE(E,li(w,3),ku)},ge.findLast=Qo,ge.findLastIndex=Rh,ge.findLastKey=function(E,w){return PE(E,li(w,3),qE)},ge.floor=gy,ge.forEach=cS,ge.forEachRight=fv,ge.forIn=function(E,w){return E==null?E:W0(E,li(w,3),$n)},ge.forInRight=function(E,w){return E==null?E:GE(E,li(w,3),$n)},ge.forOwn=function(E,w){return E&&ku(E,li(w,3))},ge.forOwnRight=function(E,w){return E&&qE(E,li(w,3))},ge.get=Ri,ge.gt=Nh,ge.gte=uR,ge.has=function(E,w){return E!=null&&qp(E,w,jm)},ge.hasIn=Di,ge.head=tg,ge.identity=ms,ge.includes=function(E,w,F,Q){E=uo(E)?E:fr(E),F=F&&!Q?ye(F):0;var le=E.length;return F<0&&(F=ws(le+F,0)),ae(E)?F<=le&&E.indexOf(w,F)>-1:!!le&&gd(E,w,F)>-1},ge.indexOf=function(E,w,F){var Q=E==null?0:E.length;if(!Q)return-1;var le=F==null?0:ye(F);return le<0&&(le=ws(Q+le,0)),gd(E,w,le)},ge.inRange=function(E,w,F){return w=Oe(w),F===u?(F=w,w=0):F=Oe(F),function(Q,le,xe){return Q>=Js(le,xe)&&Q<ws(le,xe)}(E=wt(E),w,F)},ge.invoke=ui,ge.isArguments=Vr,ge.isArray=Zn,ge.isArrayBuffer=fx,ge.isArrayLike=uo,ge.isArrayLikeObject=Ds,ge.isBoolean=function(E){return E===!0||E===!1||L(E)&&pa(E)==U},ge.isBuffer=Rd,ge.isDate=sg,ge.isElement=function(E){return L(E)&&E.nodeType===1&&!te(E)},ge.isEmpty=function(E){if(E==null)return!0;if(uo(E)&&(Zn(E)||typeof E=="string"||typeof E.splice=="function"||Rd(E)||pe(E)||Vr(E)))return!E.length;var w=ja(E);if(w==ie||w==oe)return!E.size;if(cv(E))return!WE(E).length;for(var F in E)if(Rr.call(E,F))return!1;return!0},ge.isEqual=function(E,w){return or(E,w)},ge.isEqualWith=function(E,w,F){var Q=(F=typeof F=="function"?F:u)?F(E,w):u;return Q===u?or(E,w,u,F):!!Q},ge.isError=pS,ge.isFinite=function(E){return typeof E=="number"&&Ca(E)},ge.isFunction=N,ge.isInteger=S,ge.isLength=A,ge.isMap=B,ge.isMatch=function(E,w){return E===w||X0(E,w,ti(w))},ge.isMatchWith=function(E,w,F){return F=typeof F=="function"?F:u,X0(E,w,ti(w),F)},ge.isNaN=function(E){return H(E)&&E!=+E},ge.isNative=function(E){if(tR(E))throw new ji("Unsupported core-js use. Try https://npms.io/search?q=ponyfill.");return J1(E)},ge.isNil=function(E){return E==null},ge.isNull=function(E){return E===null},ge.isNumber=H,ge.isObject=O,ge.isObjectLike=L,ge.isPlainObject=te,ge.isRegExp=re,ge.isSafeInteger=function(E){return S(E)&&E>=-9007199254740991&&E<=x},ge.isSet=K,ge.isString=ae,ge.isSymbol=he,ge.isTypedArray=pe,ge.isUndefined=function(E){return E===u},ge.isWeakMap=function(E){return L(E)&&ja(E)==He},ge.isWeakSet=function(E){return L(E)&&pa(E)=="[object WeakSet]"},ge.join=function(E,w){return E==null?"":HE.call(E,w)},ge.kebabCase=Qs,ge.last=No,ge.lastIndexOf=function(E,w,F){var Q=E==null?0:E.length;if(!Q)return-1;var le=Q;return F!==u&&(le=(le=ye(F))<0?ws(Q+le,0):Js(le,Q-1)),w==w?function(xe,Pe,We){for(var ct=We+1;ct--;)if(xe[ct]===Pe)return ct;return ct}(E,w,le):md(E,LE,le,!0)},ge.lowerCase=ga,ge.lowerFirst=Ss,ge.lt=Ne,ge.lte=Je,ge.max=function(E){return E&&E.length?zm(E,ms,jr):u},ge.maxBy=function(E,w){return E&&E.length?zm(E,li(w,2),jr):u},ge.mean=function(E){return UE(E,ms)},ge.meanBy=function(E,w){return UE(E,li(w,2))},ge.min=function(E){return E&&E.length?zm(E,ms,ny):u},ge.minBy=function(E,w){return E&&E.length?zm(E,li(w,2),ny):u},ge.stubArray=Mf,ge.stubFalse=kh,ge.stubObject=function(){return{}},ge.stubString=function(){return""},ge.stubTrue=function(){return!0},ge.multiply=Yr,ge.nth=function(E,w){return E&&E.length?J0(E,ye(w)):u},ge.noConflict=function(){return bn._===this&&(bn._=Z_),this},ge.noop=ho,ge.now=Ra,ge.pad=function(E,w,F){E=It(E);var Q=(w=ye(w))?wa(E):0;if(!w||Q>=w)return E;var le=(w-Q)/2;return Zl(Jc(le),F)+E+Zl(Mu(le),F)},ge.padEnd=function(E,w,F){E=It(E);var Q=(w=ye(w))?wa(E):0;return w&&Q<w?E+Zl(w-Q,F):E},ge.padStart=function(E,w,F){E=It(E);var Q=(w=ye(w))?wa(E):0;return w&&Q<w?Zl(w-Q,F)+E:E},ge.parseInt=function(E,w,F){return F||w==null?w=0:w&&(w=+w),vc(It(E).replace(ce,""),w||0)},ge.random=function(E,w,F){if(F&&typeof F!="boolean"&&Zo(E,w,F)&&(w=F=u),F===u&&(typeof w=="boolean"?(F=w,w=u):typeof E=="boolean"&&(F=E,E=u)),E===u&&w===u?(E=0,w=1):(E=Oe(E),w===u?(w=E,E=0):w=Oe(w)),E>w){var Q=E;E=w,w=Q}if(F||E%1||w%1){var le=Co();return Js(E+le*(w-E+$l("1e-"+((le+"").length-1))),w)}return XE(E,w)},ge.reduce=function(E,w,F){var Q=Zn(E)?$_:BE,le=arguments.length<3;return Q(E,li(w,4),F,le,Cl)},ge.reduceRight=function(E,w,F){var Q=Zn(E)?DE:BE,le=arguments.length<3;return Q(E,li(w,4),F,le,$0)},ge.repeat=function(E,w,F){return w=(F?Zo(E,w,F):w===u)?1:ye(w),ry(It(E),w)},ge.replace=function(){var E=arguments,w=It(E[0]);return E.length<3?w:w.replace(E[1],E[2])},ge.result=function(E,w,F){var Q=-1,le=(w=Ah(w,E)).length;for(le||(le=1,E=u);++Q<le;){var xe=E==null?u:E[ju(w[Q])];xe===u&&(Q=le,xe=F),E=N(xe)?xe.call(E):xe}return E},ge.round=gv,ge.runInContext=dt,ge.sample=function(E){return(Zn(E)?Xl:ev)(E)},ge.size=function(E){if(E==null)return 0;if(uo(E))return ae(E)?wa(E):E.length;var w=ja(E);return w==ie||w==oe?E.size:WE(E).length},ge.snakeCase=Ps,ge.some=function(E,w,F){var Q=Zn(E)?W_:xh;return F&&Zo(E,w,F)&&(w=u),Q(E,li(w,3))},ge.sortedIndex=function(E,w){return Bp(E,w)},ge.sortedIndexBy=function(E,w,F){return qm(E,w,li(F,2))},ge.sortedIndexOf=function(E,w){var F=E==null?0:E.length;if(F){var Q=Bp(E,w);if(Q<F&&ks(E[Q],w))return Q}return-1},ge.sortedLastIndex=function(E,w){return Bp(E,w,!0)},ge.sortedLastIndexBy=function(E,w,F){return qm(E,w,li(F,2),!0)},ge.sortedLastIndexOf=function(E,w){if(E!=null&&E.length){var F=Bp(E,w,!0)-1;if(ks(E[F],w))return F}return-1},ge.startCase=dr,ge.startsWith=function(E,w,F){return E=It(E),F=F==null?0:Tf(ye(F),0,E.length),w=el(w),E.slice(F,F+w.length)==w},ge.subtract=Dh,ge.sum=function(E){return E&&E.length?_h(E,ms):0},ge.sumBy=function(E,w){return E&&E.length?_h(E,li(w,2)):0},ge.template=function(E,w,F){var Q=ge.templateSettings;F&&Zo(E,w,F)&&(w=u),E=It(E),w=_i({},w,Q,zu);var le,xe,Pe=_i({},w.imports,Q.imports,zu),We=Tn(Pe),ct=Ns(Pe,We),kt=0,Lt=w.interpolate||ot,Wt="__p += '",Rn=Wl((w.escape||ot).source+"|"+Lt.source+"|"+(Lt===it?Vn:ot).source+"|"+(w.evaluate||ot).source+"|$","g"),Un="//# sourceURL="+(Rr.call(w,"sourceURL")?(w.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++Xn+"]")+`
`;E.replace(Rn,function(Qt,mi,Gt,Mn,on,In){return Gt||(Gt=Mn),Wt+=E.slice(kt,In).replace(At,Y1),mi&&(le=!0,Wt+=`' +
__e(`+mi+`) +
'`),on&&(xe=!0,Wt+=`';
`+on+`;
__p += '`),Gt&&(Wt+=`' +
((__t = (`+Gt+`)) == null ? '' : __t) +
'`),kt=In+Qt.length,Qt}),Wt+=`';
`;var ni=Rr.call(w,"variable")&&w.variable;if(ni){if(mt.test(ni))throw new ji("Invalid `variable` option passed into `_.template`")}else Wt=`with (obj) {
`+Wt+`
}
`;Wt=(xe?Wt.replace(Be,""):Wt).replace(Ie,"$1").replace(rt,"$1;"),Wt="function("+(ni||"obj")+`) {
`+(ni?"":`obj || (obj = {});
`)+"var __t, __p = ''"+(le?", __e = _.escape":"")+(xe?`, __j = Array.prototype.join;
function print() { __p += __j.call(arguments, '') }
`:`;
`)+Wt+`return __p
}`;var Ut=Mr(function(){return ha(We,Un+"return "+Wt).apply(u,ct)});if(Ut.source=Wt,pS(Ut))throw Ut;return Ut},ge.times=function(E,w){if((E=ye(E))<1||E>x)return[];var F=R,Q=Js(E,R);w=li(w),E-=R;for(var le=Im(Q,w);++F<E;)w(F);return le},ge.toFinite=Oe,ge.toInteger=ye,ge.toLength=lt,ge.toLower=function(E){return It(E).toLowerCase()},ge.toNumber=wt,ge.toSafeInteger=function(E){return E?Tf(ye(E),-9007199254740991,x):E===0?E:0},ge.toString=It,ge.toUpper=function(E){return It(E).toUpperCase()},ge.trim=function(E,w,F){if((E=It(E))&&(F||w===u))return FE(E);if(!E||!(w=el(w)))return E;var Q=Zs(E),le=Zs(w);return ao(Q,$1(Q,le),ua(Q,le)+1).join("")},ge.trimEnd=function(E,w,F){if((E=It(E))&&(F||w===u))return E.slice(0,k0(E)+1);if(!E||!(w=el(w)))return E;var Q=Zs(E);return ao(Q,0,ua(Q,Zs(w))+1).join("")},ge.trimStart=function(E,w,F){if((E=It(E))&&(F||w===u))return E.replace(ce,"");if(!E||!(w=el(w)))return E;var Q=Zs(E);return ao(Q,$1(Q,Zs(w))).join("")},ge.truncate=function(E,w){var F=30,Q="...";if(O(w)){var le="separator"in w?w.separator:le;F="length"in w?ye(w.length):F,Q="omission"in w?el(w.omission):Q}var xe=(E=It(E)).length;if(vd(E)){var Pe=Zs(E);xe=Pe.length}if(F>=xe)return E;var We=F-wa(Q);if(We<1)return Q;var ct=Pe?ao(Pe,0,We).join(""):E.slice(0,We);if(le===u)return ct+Q;if(Pe&&(We+=ct.length-We),re(le)){if(E.slice(We).search(le)){var kt,Lt=ct;for(le.global||(le=Wl(le.source,It(qe.exec(le))+"g")),le.lastIndex=0;kt=le.exec(Lt);)var Wt=kt.index;ct=ct.slice(0,Wt===u?We:Wt)}}else if(E.indexOf(el(le),We)!=We){var Rn=ct.lastIndexOf(le);Rn>-1&&(ct=ct.slice(0,Rn))}return ct+Q},ge.unescape=function(E){return(E=It(E))&&bt.test(E)?E.replace(ft,_f):E},ge.uniqueId=function(E){var w=++P0;return It(E)+w},ge.upperCase=Ma,ge.upperFirst=Jn,ge.each=cS,ge.eachRight=fv,ge.first=tg,Oa(ge,(mv={},ku(ge,function(E,w){Rr.call(ge.prototype,w)||(mv[w]=E)}),mv),{chain:!1}),ge.VERSION="4.17.21",Wo(["bind","bindKey","curry","curryRight","partial","partialRight"],function(E){ge[E].placeholder=ge}),Wo(["drop","take"],function(E,w){Fi.prototype[E]=function(F){F=F===u?1:ws(ye(F),0);var Q=this.__filtered__&&!w?new Fi(this):this.clone();return Q.__filtered__?Q.__takeCount__=Js(F,Q.__takeCount__):Q.__views__.push({size:Js(F,R),type:E+(Q.__dir__<0?"Right":"")}),Q},Fi.prototype[E+"Right"]=function(F){return this.reverse()[E](F).reverse()}}),Wo(["filter","map","takeWhile"],function(E,w){var F=w+1,Q=F==1||F==3;Fi.prototype[E]=function(le){var xe=this.clone();return xe.__iteratees__.push({iteratee:li(le,3),type:F}),xe.__filtered__=xe.__filtered__||Q,xe}}),Wo(["head","last"],function(E,w){var F="take"+(w?"Right":"");Fi.prototype[E]=function(){return this[F](1).value()[0]}}),Wo(["initial","tail"],function(E,w){var F="drop"+(w?"":"Right");Fi.prototype[E]=function(){return this.__filtered__?new Fi(this):this[F](1)}}),Fi.prototype.compact=function(){return this.filter(ms)},Fi.prototype.find=function(E){return this.filter(E).head()},Fi.prototype.findLast=function(E){return this.reverse().find(E)},Fi.prototype.invokeMap=qi(function(E,w){return typeof E=="function"?new Fi(this):this.map(function(F){return Ec(F,E,w)})}),Fi.prototype.reject=function(E){return this.filter(tc(li(E)))},Fi.prototype.slice=function(E,w){E=ye(E);var F=this;return F.__filtered__&&(E>0||w<0)?new Fi(F):(E<0?F=F.takeRight(-E):E&&(F=F.drop(E)),w!==u&&(F=(w=ye(w))<0?F.dropRight(-w):F.take(w-E)),F)},Fi.prototype.takeRightWhile=function(E){return this.reverse().takeWhile(E).reverse()},Fi.prototype.toArray=function(){return this.take(R)},ku(Fi.prototype,function(E,w){var F=/^(?:filter|find|map|reject)|While$/.test(w),Q=/^(?:head|last)$/.test(w),le=ge[Q?"take"+(w=="last"?"Right":""):w],xe=Q||/^find/.test(w);le&&(ge.prototype[w]=function(){var Pe=this.__wrapped__,We=Q?[1]:arguments,ct=Pe instanceof Fi,kt=We[0],Lt=ct||Zn(Pe),Wt=function(mi){var Gt=le.apply(ge,vh([mi],We));return Q&&Rn?Gt[0]:Gt};Lt&&F&&typeof kt=="function"&&kt.length!=1&&(ct=Lt=!1);var Rn=this.__chain__,Un=!!this.__actions__.length,ni=xe&&!Rn,Ut=ct&&!Un;if(!xe&&Lt){Pe=Ut?Pe:new Fi(this);var Qt=E.apply(Pe,We);return Qt.__actions__.push({func:Mh,args:[Wt],thisArg:u}),new so(Qt,Rn)}return ni&&Ut?E.apply(this,We):(Qt=this.thru(Wt),ni?Q?Qt.value()[0]:Qt.value():Qt)})}),Wo(["pop","push","shift","sort","splice","unshift"],function(E){var w=Pm[E],F=/^(?:push|sort|unshift)$/.test(E)?"tap":"thru",Q=/^(?:pop|shift)$/.test(E);ge.prototype[E]=function(){var le=arguments;if(Q&&!this.__chain__){var xe=this.value();return w.apply(Zn(xe)?xe:[],le)}return this[F](function(Pe){return w.apply(Zn(Pe)?Pe:[],le)})}}),ku(Fi.prototype,function(E,w){var F=ge[w];if(F){var Q=F.name+"";Rr.call(da,Q)||(da[Q]=[]),da[Q].push({name:w,func:F})}}),da[rv(u,2).name]=[{name:"wrapper",func:u}],Fi.prototype.clone=function(){var E=new Fi(this.__wrapped__);return E.__actions__=Sc(this.__actions__),E.__dir__=this.__dir__,E.__filtered__=this.__filtered__,E.__iteratees__=Sc(this.__iteratees__),E.__takeCount__=this.__takeCount__,E.__views__=Sc(this.__views__),E},Fi.prototype.reverse=function(){if(this.__filtered__){var E=new Fi(this);E.__dir__=-1,E.__filtered__=!0}else(E=this.clone()).__dir__*=-1;return E},Fi.prototype.value=function(){var E=this.__wrapped__.value(),w=this.__dir__,F=Zn(E),Q=w<0,le=F?E.length:0,xe=function(In,ln,Fn){for(var Cs=-1,Ls=Fn.length;++Cs<Ls;){var xc=Fn[Cs],kr=xc.size;switch(xc.type){case"drop":In+=kr;break;case"dropRight":ln-=kr;break;case"take":ln=Js(ln,In+kr);break;case"takeRight":In=ws(In,ln-kr)}}return{start:In,end:ln}}(0,le,this.__views__),Pe=xe.start,We=xe.end,ct=We-Pe,kt=Q?We:Pe-1,Lt=this.__iteratees__,Wt=Lt.length,Rn=0,Un=Js(ct,this.__takeCount__);if(!F||!Q&&le==ct&&Un==ct)return $m(E,this.__actions__);var ni=[];e:for(;ct--&&Rn<Un;){for(var Ut=-1,Qt=E[kt+=w];++Ut<Wt;){var mi=Lt[Ut],Gt=mi.iteratee,Mn=mi.type,on=Gt(Qt);if(Mn==2)Qt=on;else if(!on){if(Mn==1)continue e;break e}}ni[Rn++]=Qt}return ni},ge.prototype.at=Rf,ge.prototype.chain=function(){return co(this)},ge.prototype.commit=function(){return new so(this.value(),this.__chain__)},ge.prototype.next=function(){this.__values__===u&&(this.__values__=Ye(this.value()));var E=this.__index__>=this.__values__.length;return{done:E,value:E?u:this.__values__[this.__index__++]}},ge.prototype.plant=function(E){for(var w,F=this;F instanceof Sh;){var Q=aS(F);Q.__index__=0,Q.__values__=u,w?le.__wrapped__=Q:w=Q;var le=Q;F=F.__wrapped__}return le.__wrapped__=E,w},ge.prototype.reverse=function(){var E=this.__wrapped__;if(E instanceof Fi){var w=E;return this.__actions__.length&&(w=new Fi(this)),(w=w.reverse()).__actions__.push({func:Mh,args:[Er],thisArg:u}),new so(w,this.__chain__)}return this.thru(Er)},ge.prototype.toJSON=ge.prototype.valueOf=ge.prototype.value=function(){return $m(this.__wrapped__,this.__actions__)},ge.prototype.first=ge.prototype.head,Ru&&(ge.prototype[Ru]=function(){return this}),ge}();bn._=kp,(l=(function(){return kp}).call(o,c,o,a))===u||(a.exports=l)}).call(this)},2492:(a,o,c)=>{var l=c(2980),u=c(1463)(function(h,f,d){l(h,f,d)});a.exports=u},5062:a=>{a.exports=function(){return!1}},9881:(a,o,c)=>{var l=c(8363),u=c(1704);a.exports=function(h){return l(h,u(h))}},6692:a=>{var o=a.exports={v:[{name:"version",reg:/^(\d*)$/}],o:[{name:"origin",reg:/^(\S*) (\d*) (\d*) (\S*) IP(\d) (\S*)/,names:["username","sessionId","sessionVersion","netType","ipVer","address"],format:"%s %s %d %s IP%d %s"}],s:[{name:"name"}],i:[{name:"description"}],u:[{name:"uri"}],e:[{name:"email"}],p:[{name:"phone"}],z:[{name:"timezones"}],r:[{name:"repeats"}],t:[{name:"timing",reg:/^(\d*) (\d*)/,names:["start","stop"],format:"%d %d"}],c:[{name:"connection",reg:/^IN IP(\d) (\S*)/,names:["version","ip"],format:"IN IP%d %s"}],b:[{push:"bandwidth",reg:/^(TIAS|AS|CT|RR|RS):(\d*)/,names:["type","limit"],format:"%s:%s"}],m:[{reg:/^(\w*) (\d*) ([\w/]*)(?: (.*))?/,names:["type","port","protocol","payloads"],format:"%s %d %s %s"}],a:[{push:"rtp",reg:/^rtpmap:(\d*) ([\w\-.]*)(?:\s*\/(\d*)(?:\s*\/(\S*))?)?/,names:["payload","codec","rate","encoding"],format:function(c){return c.encoding?"rtpmap:%d %s/%s/%s":c.rate?"rtpmap:%d %s/%s":"rtpmap:%d %s"}},{push:"fmtp",reg:/^fmtp:(\d*) ([\S| ]*)/,names:["payload","config"],format:"fmtp:%d %s"},{name:"control",reg:/^control:(.*)/,format:"control:%s"},{name:"rtcp",reg:/^rtcp:(\d*)(?: (\S*) IP(\d) (\S*))?/,names:["port","netType","ipVer","address"],format:function(c){return c.address!=null?"rtcp:%d %s IP%d %s":"rtcp:%d"}},{push:"rtcpFbTrrInt",reg:/^rtcp-fb:(\*|\d*) trr-int (\d*)/,names:["payload","value"],format:"rtcp-fb:%s trr-int %d"},{push:"rtcpFb",reg:/^rtcp-fb:(\*|\d*) ([\w-_]*)(?: ([\w-_]*))?/,names:["payload","type","subtype"],format:function(c){return c.subtype!=null?"rtcp-fb:%s %s %s":"rtcp-fb:%s %s"}},{push:"ext",reg:/^extmap:(\d+)(?:\/(\w+))?(?: (urn:ietf:params:rtp-hdrext:encrypt))? (\S*)(?: (\S*))?/,names:["value","direction","encrypt-uri","uri","config"],format:function(c){return"extmap:%d"+(c.direction?"/%s":"%v")+(c["encrypt-uri"]?" %s":"%v")+" %s"+(c.config?" %s":"")}},{name:"extmapAllowMixed",reg:/^(extmap-allow-mixed)/},{push:"crypto",reg:/^crypto:(\d*) ([\w_]*) (\S*)(?: (\S*))?/,names:["id","suite","config","sessionConfig"],format:function(c){return c.sessionConfig!=null?"crypto:%d %s %s %s":"crypto:%d %s %s"}},{name:"setup",reg:/^setup:(\w*)/,format:"setup:%s"},{name:"connectionType",reg:/^connection:(new|existing)/,format:"connection:%s"},{name:"mid",reg:/^mid:([^\s]*)/,format:"mid:%s"},{name:"msid",reg:/^msid:(.*)/,format:"msid:%s"},{name:"ptime",reg:/^ptime:(\d*(?:\.\d*)*)/,format:"ptime:%d"},{name:"maxptime",reg:/^maxptime:(\d*(?:\.\d*)*)/,format:"maxptime:%d"},{name:"direction",reg:/^(sendrecv|recvonly|sendonly|inactive)/},{name:"icelite",reg:/^(ice-lite)/},{name:"iceUfrag",reg:/^ice-ufrag:(\S*)/,format:"ice-ufrag:%s"},{name:"icePwd",reg:/^ice-pwd:(\S*)/,format:"ice-pwd:%s"},{name:"fingerprint",reg:/^fingerprint:(\S*) (\S*)/,names:["type","hash"],format:"fingerprint:%s %s"},{push:"candidates",reg:/^candidate:(\S*) (\d*) (\S*) (\d*) (\S*) (\d*) typ (\S*)(?: raddr (\S*) rport (\d*))?(?: tcptype (\S*))?(?: generation (\d*))?(?: network-id (\d*))?(?: network-cost (\d*))?/,names:["foundation","component","transport","priority","ip","port","type","raddr","rport","tcptype","generation","network-id","network-cost"],format:function(c){var l="candidate:%s %d %s %d %s %d typ %s";return l+=c.raddr!=null?" raddr %s rport %d":"%v%v",l+=c.tcptype!=null?" tcptype %s":"%v",c.generation!=null&&(l+=" generation %d"),l+=c["network-id"]!=null?" network-id %d":"%v",l+=c["network-cost"]!=null?" network-cost %d":"%v"}},{name:"endOfCandidates",reg:/^(end-of-candidates)/},{name:"remoteCandidates",reg:/^remote-candidates:(.*)/,format:"remote-candidates:%s"},{name:"iceOptions",reg:/^ice-options:(\S*)/,format:"ice-options:%s"},{push:"ssrcs",reg:/^ssrc:(\d*) ([\w_-]*)(?::(.*))?/,names:["id","attribute","value"],format:function(c){var l="ssrc:%d";return c.attribute!=null&&(l+=" %s",c.value!=null&&(l+=":%s")),l}},{push:"ssrcGroups",reg:/^ssrc-group:([\x21\x23\x24\x25\x26\x27\x2A\x2B\x2D\x2E\w]*) (.*)/,names:["semantics","ssrcs"],format:"ssrc-group:%s %s"},{name:"msidSemantic",reg:/^msid-semantic:\s?(\w*) (\S*)/,names:["semantic","token"],format:"msid-semantic: %s %s"},{push:"groups",reg:/^group:(\w*) (.*)/,names:["type","mids"],format:"group:%s %s"},{name:"rtcpMux",reg:/^(rtcp-mux)/},{name:"rtcpRsize",reg:/^(rtcp-rsize)/},{name:"sctpmap",reg:/^sctpmap:([\w_/]*) (\S*)(?: (\S*))?/,names:["sctpmapNumber","app","maxMessageSize"],format:function(c){return c.maxMessageSize!=null?"sctpmap:%s %s %s":"sctpmap:%s %s"}},{name:"xGoogleFlag",reg:/^x-google-flag:([^\s]*)/,format:"x-google-flag:%s"},{push:"rids",reg:/^rid:([\d\w]+) (\w+)(?: ([\S| ]*))?/,names:["id","direction","params"],format:function(c){return c.params?"rid:%s %s %s":"rid:%s %s"}},{push:"imageattrs",reg:new RegExp("^imageattr:(\\d+|\\*)[\\s\\t]+(send|recv)[\\s\\t]+(\\*|\\[\\S+\\](?:[\\s\\t]+\\[\\S+\\])*)(?:[\\s\\t]+(recv|send)[\\s\\t]+(\\*|\\[\\S+\\](?:[\\s\\t]+\\[\\S+\\])*))?"),names:["pt","dir1","attrs1","dir2","attrs2"],format:function(c){return"imageattr:%s %s %s"+(c.dir2?" %s %s":"")}},{name:"simulcast",reg:new RegExp("^simulcast:(send|recv) ([a-zA-Z0-9\\-_~;,]+)(?:\\s?(send|recv) ([a-zA-Z0-9\\-_~;,]+))?$"),names:["dir1","list1","dir2","list2"],format:function(c){return"simulcast:%s %s"+(c.dir2?" %s %s":"")}},{name:"simulcast_03",reg:/^simulcast:[\s\t]+([\S+\s\t]+)$/,names:["value"],format:"simulcast: %s"},{name:"framerate",reg:/^framerate:(\d+(?:$|\.\d+))/,format:"framerate:%s"},{name:"sourceFilter",reg:/^source-filter: *(excl|incl) (\S*) (IP4|IP6|\*) (\S*) (.*)/,names:["filterMode","netType","addressTypes","destAddress","srcList"],format:"source-filter: %s %s %s %s %s"},{name:"bundleOnly",reg:/^(bundle-only)/},{name:"label",reg:/^label:(.+)/,format:"label:%s"},{name:"sctpPort",reg:/^sctp-port:(\d+)$/,format:"sctp-port:%s"},{name:"maxMessageSize",reg:/^max-message-size:(\d+)$/,format:"max-message-size:%s"},{push:"tsRefClocks",reg:/^ts-refclk:([^\s=]*)(?:=(\S*))?/,names:["clksrc","clksrcExt"],format:function(c){return"ts-refclk:%s"+(c.clksrcExt!=null?"=%s":"")}},{name:"mediaClk",reg:/^mediaclk:(?:id=(\S*))? *([^\s=]*)(?:=(\S*))?(?: *rate=(\d+)\/(\d+))?/,names:["id","mediaClockName","mediaClockValue","rateNumerator","rateDenominator"],format:function(c){var l="mediaclk:";return l+=c.id!=null?"id=%s %s":"%v%s",l+=c.mediaClockValue!=null?"=%s":"",l+=c.rateNumerator!=null?" rate=%s":"",l+=c.rateDenominator!=null?"/%s":""}},{name:"keywords",reg:/^keywds:(.+)$/,format:"keywds:%s"},{name:"content",reg:/^content:(.+)/,format:"content:%s"},{name:"bfcpFloorCtrl",reg:/^floorctrl:(c-only|s-only|c-s)/,format:"floorctrl:%s"},{name:"bfcpConfId",reg:/^confid:(\d+)/,format:"confid:%s"},{name:"bfcpUserId",reg:/^userid:(\d+)/,format:"userid:%s"},{name:"bfcpFloorId",reg:/^floorid:(.+) (?:m-stream|mstrm):(.+)/,names:["id","mStream"],format:"floorid:%s mstrm:%s"},{push:"invalid",names:["value"]}]};Object.keys(o).forEach(function(c){o[c].forEach(function(l){l.reg||(l.reg=/(.*)/),l.format||(l.format="%s")})})},766:(a,o,c)=>{var l=c(962),u=c(8627);o.cW=u,o.Qc=l.parse,o.rz=l.parseParams,l.parseFmtpConfig,l.parsePayloads,l.parseRemoteCandidates,l.parseImageAttributes,l.parseSimulcastStreamList},962:(a,o,c)=>{var l=function(p){return String(Number(p))===p?Number(p):p},u=function(p,g,y){var v=p.name&&p.names;p.push&&!g[p.push]?g[p.push]=[]:v&&!g[p.name]&&(g[p.name]={});var b=p.push?{}:v?g[p.name]:g;(function(T,x,M,R){if(R&&!M)x[R]=l(T[1]);else for(var I=0;I<M.length;I+=1)T[I+1]!=null&&(x[M[I]]=l(T[I+1]))})(y.match(p.reg),b,p.names,p.name),p.push&&g[p.push].push(b)},h=c(6692),f=RegExp.prototype.test.bind(/^([a-z])=(.*)/);o.parse=function(p){var g={},y=[],v=g;return p.split(/(\r\n|\r|\n)/).filter(f).forEach(function(b){var T=b[0],x=b.slice(2);T==="m"&&(y.push({rtp:[],fmtp:[]}),v=y[y.length-1]);for(var M=0;M<(h[T]||[]).length;M+=1){var R=h[T][M];if(R.reg.test(x))return u(R,v,x)}}),g.media=y,g};var d=function(p,g){var y=g.split(/=(.+)/,2);return y.length===2?p[y[0]]=l(y[1]):y.length===1&&g.length>1&&(p[y[0]]=void 0),p};o.parseParams=function(p){return p.split(/;\s?/).reduce(d,{})},o.parseFmtpConfig=o.parseParams,o.parsePayloads=function(p){return p.toString().split(" ").map(Number)},o.parseRemoteCandidates=function(p){for(var g=[],y=p.split(" ").map(l),v=0;v<y.length;v+=3)g.push({component:y[v],ip:y[v+1],port:y[v+2]});return g},o.parseImageAttributes=function(p){return p.split(" ").map(function(g){return g.substring(1,g.length-1).split(",").reduce(d,{})})},o.parseSimulcastStreamList=function(p){return p.split(";").map(function(g){return g.split(",").map(function(y){var v,b=!1;return y[0]!=="~"?v=l(y):(v=l(y.substring(1,y.length)),b=!0),{scid:v,paused:b}})})}},8627:(a,o,c)=>{var l=c(6692),u=/%[sdv%]/g,h=function(g){var y=1,v=arguments,b=v.length;return g.replace(u,function(T){if(y>=b)return T;var x=v[y];switch(y+=1,T){case"%%":return"%";case"%s":return String(x);case"%d":return Number(x);case"%v":return""}})},f=function(g,y,v){var b=[g+"="+(y.format instanceof Function?y.format(y.push?v:v[y.name]):y.format)];if(y.names)for(var T=0;T<y.names.length;T+=1){var x=y.names[T];y.name?b.push(v[y.name][x]):b.push(v[y.names[T]])}else b.push(v[y.name]);return h.apply(null,b)},d=["v","o","s","i","u","e","p","c","b","t","r","z","a"],p=["i","c","b","a"];a.exports=function(g,y){y=y||{},g.version==null&&(g.version=0),g.name==null&&(g.name=" "),g.media.forEach(function(x){x.payloads==null&&(x.payloads="")});var v=y.outerOrder||d,b=y.innerOrder||p,T=[];return v.forEach(function(x){l[x].forEach(function(M){M.name in g&&g[M.name]!=null?T.push(f(x,M,g)):M.push in g&&g[M.push]!=null&&g[M.push].forEach(function(R){T.push(f(x,M,R))})})}),g.media.forEach(function(x){T.push(f("m",l.m[0],x)),b.forEach(function(M){l[M].forEach(function(R){R.name in x&&x[R.name]!=null?T.push(f(M,R,x)):R.push in x&&x[R.push]!=null&&x[R.push].forEach(function(I){T.push(f(M,R,I))})})})}),T.join(`\r
`)+`\r
`}},7539:a=>{const o={generateIdentifier:function(){return Math.random().toString(36).substring(2,12)}};o.localCName=o.generateIdentifier(),o.splitLines=function(c){return c.trim().split(`
`).map(l=>l.trim())},o.splitSections=function(c){return c.split(`
m=`).map((l,u)=>(u>0?"m="+l:l).trim()+`\r
`)},o.getDescription=function(c){const l=o.splitSections(c);return l&&l[0]},o.getMediaSections=function(c){const l=o.splitSections(c);return l.shift(),l},o.matchPrefix=function(c,l){return o.splitLines(c).filter(u=>u.indexOf(l)===0)},o.parseCandidate=function(c){let l;l=c.indexOf("a=candidate:")===0?c.substring(12).split(" "):c.substring(10).split(" ");const u={foundation:l[0],component:{1:"rtp",2:"rtcp"}[l[1]]||l[1],protocol:l[2].toLowerCase(),priority:parseInt(l[3],10),ip:l[4],address:l[4],port:parseInt(l[5],10),type:l[7]};for(let h=8;h<l.length;h+=2)switch(l[h]){case"raddr":u.relatedAddress=l[h+1];break;case"rport":u.relatedPort=parseInt(l[h+1],10);break;case"tcptype":u.tcpType=l[h+1];break;case"ufrag":u.ufrag=l[h+1],u.usernameFragment=l[h+1];break;default:u[l[h]]===void 0&&(u[l[h]]=l[h+1])}return u},o.writeCandidate=function(c){const l=[];l.push(c.foundation);const u=c.component;u==="rtp"?l.push(1):u==="rtcp"?l.push(2):l.push(u),l.push(c.protocol.toUpperCase()),l.push(c.priority),l.push(c.address||c.ip),l.push(c.port);const h=c.type;return l.push("typ"),l.push(h),h!=="host"&&c.relatedAddress&&c.relatedPort&&(l.push("raddr"),l.push(c.relatedAddress),l.push("rport"),l.push(c.relatedPort)),c.tcpType&&c.protocol.toLowerCase()==="tcp"&&(l.push("tcptype"),l.push(c.tcpType)),(c.usernameFragment||c.ufrag)&&(l.push("ufrag"),l.push(c.usernameFragment||c.ufrag)),"candidate:"+l.join(" ")},o.parseIceOptions=function(c){return c.substring(14).split(" ")},o.parseRtpMap=function(c){let l=c.substring(9).split(" ");const u={payloadType:parseInt(l.shift(),10)};return l=l[0].split("/"),u.name=l[0],u.clockRate=parseInt(l[1],10),u.channels=l.length===3?parseInt(l[2],10):1,u.numChannels=u.channels,u},o.writeRtpMap=function(c){let l=c.payloadType;c.preferredPayloadType!==void 0&&(l=c.preferredPayloadType);const u=c.channels||c.numChannels||1;return"a=rtpmap:"+l+" "+c.name+"/"+c.clockRate+(u!==1?"/"+u:"")+`\r
`},o.parseExtmap=function(c){const l=c.substring(9).split(" ");return{id:parseInt(l[0],10),direction:l[0].indexOf("/")>0?l[0].split("/")[1]:"sendrecv",uri:l[1],attributes:l.slice(2).join(" ")}},o.writeExtmap=function(c){return"a=extmap:"+(c.id||c.preferredId)+(c.direction&&c.direction!=="sendrecv"?"/"+c.direction:"")+" "+c.uri+(c.attributes?" "+c.attributes:"")+`\r
`},o.parseFmtp=function(c){const l={};let u;const h=c.substring(c.indexOf(" ")+1).split(";");for(let f=0;f<h.length;f++)u=h[f].trim().split("="),l[u[0].trim()]=u[1];return l},o.writeFmtp=function(c){let l="",u=c.payloadType;if(c.preferredPayloadType!==void 0&&(u=c.preferredPayloadType),c.parameters&&Object.keys(c.parameters).length){const h=[];Object.keys(c.parameters).forEach(f=>{c.parameters[f]!==void 0?h.push(f+"="+c.parameters[f]):h.push(f)}),l+="a=fmtp:"+u+" "+h.join(";")+`\r
`}return l},o.parseRtcpFb=function(c){const l=c.substring(c.indexOf(" ")+1).split(" ");return{type:l.shift(),parameter:l.join(" ")}},o.writeRtcpFb=function(c){let l="",u=c.payloadType;return c.preferredPayloadType!==void 0&&(u=c.preferredPayloadType),c.rtcpFeedback&&c.rtcpFeedback.length&&c.rtcpFeedback.forEach(h=>{l+="a=rtcp-fb:"+u+" "+h.type+(h.parameter&&h.parameter.length?" "+h.parameter:"")+`\r
`}),l},o.parseSsrcMedia=function(c){const l=c.indexOf(" "),u={ssrc:parseInt(c.substring(7,l),10)},h=c.indexOf(":",l);return h>-1?(u.attribute=c.substring(l+1,h),u.value=c.substring(h+1)):u.attribute=c.substring(l+1),u},o.parseSsrcGroup=function(c){const l=c.substring(13).split(" ");return{semantics:l.shift(),ssrcs:l.map(u=>parseInt(u,10))}},o.getMid=function(c){const l=o.matchPrefix(c,"a=mid:")[0];if(l)return l.substring(6)},o.parseFingerprint=function(c){const l=c.substring(14).split(" ");return{algorithm:l[0].toLowerCase(),value:l[1].toUpperCase()}},o.getDtlsParameters=function(c,l){return{role:"auto",fingerprints:o.matchPrefix(c+l,"a=fingerprint:").map(o.parseFingerprint)}},o.writeDtlsParameters=function(c,l){let u="a=setup:"+l+`\r
`;return c.fingerprints.forEach(h=>{u+="a=fingerprint:"+h.algorithm+" "+h.value+`\r
`}),u},o.parseCryptoLine=function(c){const l=c.substring(9).split(" ");return{tag:parseInt(l[0],10),cryptoSuite:l[1],keyParams:l[2],sessionParams:l.slice(3)}},o.writeCryptoLine=function(c){return"a=crypto:"+c.tag+" "+c.cryptoSuite+" "+(typeof c.keyParams=="object"?o.writeCryptoKeyParams(c.keyParams):c.keyParams)+(c.sessionParams?" "+c.sessionParams.join(" "):"")+`\r
`},o.parseCryptoKeyParams=function(c){if(c.indexOf("inline:")!==0)return null;const l=c.substring(7).split("|");return{keyMethod:"inline",keySalt:l[0],lifeTime:l[1],mkiValue:l[2]?l[2].split(":")[0]:void 0,mkiLength:l[2]?l[2].split(":")[1]:void 0}},o.writeCryptoKeyParams=function(c){return c.keyMethod+":"+c.keySalt+(c.lifeTime?"|"+c.lifeTime:"")+(c.mkiValue&&c.mkiLength?"|"+c.mkiValue+":"+c.mkiLength:"")},o.getCryptoParameters=function(c,l){return o.matchPrefix(c+l,"a=crypto:").map(o.parseCryptoLine)},o.getIceParameters=function(c,l){const u=o.matchPrefix(c+l,"a=ice-ufrag:")[0],h=o.matchPrefix(c+l,"a=ice-pwd:")[0];return u&&h?{usernameFragment:u.substring(12),password:h.substring(10)}:null},o.writeIceParameters=function(c){let l="a=ice-ufrag:"+c.usernameFragment+`\r
a=ice-pwd:`+c.password+`\r
`;return c.iceLite&&(l+=`a=ice-lite\r
`),l},o.parseRtpParameters=function(c){const l={codecs:[],headerExtensions:[],fecMechanisms:[],rtcp:[]},u=o.splitLines(c)[0].split(" ");l.profile=u[2];for(let f=3;f<u.length;f++){const d=u[f],p=o.matchPrefix(c,"a=rtpmap:"+d+" ")[0];if(p){const g=o.parseRtpMap(p),y=o.matchPrefix(c,"a=fmtp:"+d+" ");switch(g.parameters=y.length?o.parseFmtp(y[0]):{},g.rtcpFeedback=o.matchPrefix(c,"a=rtcp-fb:"+d+" ").map(o.parseRtcpFb),l.codecs.push(g),g.name.toUpperCase()){case"RED":case"ULPFEC":l.fecMechanisms.push(g.name.toUpperCase())}}}o.matchPrefix(c,"a=extmap:").forEach(f=>{l.headerExtensions.push(o.parseExtmap(f))});const h=o.matchPrefix(c,"a=rtcp-fb:* ").map(o.parseRtcpFb);return l.codecs.forEach(f=>{h.forEach(d=>{f.rtcpFeedback.find(p=>p.type===d.type&&p.parameter===d.parameter)||f.rtcpFeedback.push(d)})}),l},o.writeRtpDescription=function(c,l){let u="";u+="m="+c+" ",u+=l.codecs.length>0?"9":"0",u+=" "+(l.profile||"UDP/TLS/RTP/SAVPF")+" ",u+=l.codecs.map(f=>f.preferredPayloadType!==void 0?f.preferredPayloadType:f.payloadType).join(" ")+`\r
`,u+=`c=IN IP4 0.0.0.0\r
`,u+=`a=rtcp:9 IN IP4 0.0.0.0\r
`,l.codecs.forEach(f=>{u+=o.writeRtpMap(f),u+=o.writeFmtp(f),u+=o.writeRtcpFb(f)});let h=0;return l.codecs.forEach(f=>{f.maxptime>h&&(h=f.maxptime)}),h>0&&(u+="a=maxptime:"+h+`\r
`),l.headerExtensions&&l.headerExtensions.forEach(f=>{u+=o.writeExtmap(f)}),u},o.parseRtpEncodingParameters=function(c){const l=[],u=o.parseRtpParameters(c),h=u.fecMechanisms.indexOf("RED")!==-1,f=u.fecMechanisms.indexOf("ULPFEC")!==-1,d=o.matchPrefix(c,"a=ssrc:").map(b=>o.parseSsrcMedia(b)).filter(b=>b.attribute==="cname"),p=d.length>0&&d[0].ssrc;let g;const y=o.matchPrefix(c,"a=ssrc-group:FID").map(b=>b.substring(17).split(" ").map(T=>parseInt(T,10)));y.length>0&&y[0].length>1&&y[0][0]===p&&(g=y[0][1]),u.codecs.forEach(b=>{if(b.name.toUpperCase()==="RTX"&&b.parameters.apt){let T={ssrc:p,codecPayloadType:parseInt(b.parameters.apt,10)};p&&g&&(T.rtx={ssrc:g}),l.push(T),h&&(T=JSON.parse(JSON.stringify(T)),T.fec={ssrc:p,mechanism:f?"red+ulpfec":"red"},l.push(T))}}),l.length===0&&p&&l.push({ssrc:p});let v=o.matchPrefix(c,"b=");return v.length&&(v=v[0].indexOf("b=TIAS:")===0?parseInt(v[0].substring(7),10):v[0].indexOf("b=AS:")===0?1e3*parseInt(v[0].substring(5),10)*.95-16e3:void 0,l.forEach(b=>{b.maxBitrate=v})),l},o.parseRtcpParameters=function(c){const l={},u=o.matchPrefix(c,"a=ssrc:").map(d=>o.parseSsrcMedia(d)).filter(d=>d.attribute==="cname")[0];u&&(l.cname=u.value,l.ssrc=u.ssrc);const h=o.matchPrefix(c,"a=rtcp-rsize");l.reducedSize=h.length>0,l.compound=h.length===0;const f=o.matchPrefix(c,"a=rtcp-mux");return l.mux=f.length>0,l},o.writeRtcpParameters=function(c){let l="";return c.reducedSize&&(l+=`a=rtcp-rsize\r
`),c.mux&&(l+=`a=rtcp-mux\r
`),c.ssrc!==void 0&&c.cname&&(l+="a=ssrc:"+c.ssrc+" cname:"+c.cname+`\r
`),l},o.parseMsid=function(c){let l;const u=o.matchPrefix(c,"a=msid:");if(u.length===1)return l=u[0].substring(7).split(" "),{stream:l[0],track:l[1]};const h=o.matchPrefix(c,"a=ssrc:").map(f=>o.parseSsrcMedia(f)).filter(f=>f.attribute==="msid");return h.length>0?(l=h[0].value.split(" "),{stream:l[0],track:l[1]}):void 0},o.parseSctpDescription=function(c){const l=o.parseMLine(c),u=o.matchPrefix(c,"a=max-message-size:");let h;u.length>0&&(h=parseInt(u[0].substring(19),10)),isNaN(h)&&(h=65536);const f=o.matchPrefix(c,"a=sctp-port:");if(f.length>0)return{port:parseInt(f[0].substring(12),10),protocol:l.fmt,maxMessageSize:h};const d=o.matchPrefix(c,"a=sctpmap:");if(d.length>0){const p=d[0].substring(10).split(" ");return{port:parseInt(p[0],10),protocol:p[1],maxMessageSize:h}}},o.writeSctpDescription=function(c,l){let u=[];return u=c.protocol!=="DTLS/SCTP"?["m="+c.kind+" 9 "+c.protocol+" "+l.protocol+`\r
`,`c=IN IP4 0.0.0.0\r
`,"a=sctp-port:"+l.port+`\r
`]:["m="+c.kind+" 9 "+c.protocol+" "+l.port+`\r
`,`c=IN IP4 0.0.0.0\r
`,"a=sctpmap:"+l.port+" "+l.protocol+` 65535\r
`],l.maxMessageSize!==void 0&&u.push("a=max-message-size:"+l.maxMessageSize+`\r
`),u.join("")},o.generateSessionId=function(){return Math.random().toString().substr(2,22)},o.writeSessionBoilerplate=function(c,l,u){let h;const f=l!==void 0?l:2;return h=c||o.generateSessionId(),`v=0\r
o=`+(u||"thisisadapterortc")+" "+h+" "+f+` IN IP4 127.0.0.1\r
s=-\r
t=0 0\r
`},o.getDirection=function(c,l){const u=o.splitLines(c);for(let h=0;h<u.length;h++)switch(u[h]){case"a=sendrecv":case"a=sendonly":case"a=recvonly":case"a=inactive":return u[h].substring(2)}return l?o.getDirection(l):"sendrecv"},o.getKind=function(c){return o.splitLines(c)[0].split(" ")[0].substring(2)},o.isRejected=function(c){return c.split(" ",2)[1]==="0"},o.parseMLine=function(c){const l=o.splitLines(c)[0].substring(2).split(" ");return{kind:l[0],port:parseInt(l[1],10),protocol:l[2],fmt:l.slice(3).join(" ")}},o.parseOLine=function(c){const l=o.matchPrefix(c,"o=")[0].substring(2).split(" ");return{username:l[0],sessionId:l[1],sessionVersion:parseInt(l[2],10),netType:l[3],addressType:l[4],address:l[5]}},o.isValidSDP=function(c){if(typeof c!="string"||c.length===0)return!1;const l=o.splitLines(c);for(let u=0;u<l.length;u++)if(l[u].length<2||l[u].charAt(1)!=="=")return!1;return!0},a.exports=o},477:a=>{a.exports=function(o,c,l,u){var h=self||window;try{try{var f;try{f=new h.Blob([o])}catch{(f=new(h.BlobBuilder||h.WebKitBlobBuilder||h.MozBlobBuilder||h.MSBlobBuilder)).append(o),f=f.getBlob()}var d=h.URL||h.webkitURL,p=d.createObjectURL(f),g=new h[c](p,l);return d.revokeObjectURL(p),g}catch{return new h[c]("data:application/javascript,".concat(encodeURIComponent(o)),l)}}catch{if(!u)throw Error("Inline worker is not supported");return new h[c](u,l)}}},8520:(a,o,c)=>{var l;(function(u){(function(h){var f=typeof globalThis=="object"?globalThis:typeof c.g=="object"?c.g:typeof self=="object"?self:typeof this=="object"?this:function(){try{return Function("return this;")()}catch{}}()||function(){try{return(0,eval)("(function() { return this; })()")}catch{}}(),d=p(u);function p(g,y){return function(v,b){Object.defineProperty(g,v,{configurable:!0,writable:!0,value:b}),y&&y(v,b)}}f.Reflect!==void 0&&(d=p(f.Reflect,d)),function(g,y){var v=Object.prototype.hasOwnProperty,b=typeof Symbol=="function",T=b&&Symbol.toPrimitive!==void 0?Symbol.toPrimitive:"@@toPrimitive",x=b&&Symbol.iterator!==void 0?Symbol.iterator:"@@iterator",M=typeof Object.create=="function",R={__proto__:[]}instanceof Array,I=!M&&!R,k={create:M?function(){return an(Object.create(null))}:R?function(){return an({__proto__:null})}:function(){return an({})},has:I?function(Ge,ot){return v.call(Ge,ot)}:function(Ge,ot){return ot in Ge},get:I?function(Ge,ot){return v.call(Ge,ot)?Ge[ot]:void 0}:function(Ge,ot){return Ge[ot]}},P=Object.getPrototypeOf(Function),U=typeof Map=="function"&&typeof Map.prototype.entries=="function"?Map:ht(),G=typeof Set=="function"&&typeof Set.prototype.entries=="function"?Set:Pt(),$=typeof WeakMap=="function"?WeakMap:hn(),q=b?Symbol.for("@reflect-metadata:registry"):void 0,Y=xt(),ie=Vn(Y);function V(Ge,ot,At,Nt){if(Ie(At)){if(!$e(Ge))throw new TypeError;if(!qt(ot))throw new TypeError;return we(Ge,ot)}if(!$e(Ge))throw new TypeError;if(!gt(ot))throw new TypeError;if(!gt(Nt)&&!Ie(Nt)&&!rt(Nt))throw new TypeError;return rt(Nt)&&(Nt=void 0),Ce(Ge,ot,At=it(At),Nt)}function J(Ge,ot){function At(Nt,Yn){if(!gt(Nt))throw new TypeError;if(!Ie(Yn)&&!Ot(Yn))throw new TypeError;_e(Ge,ot,Nt,Yn)}return At}function X(Ge,ot,At,Nt){if(!gt(At))throw new TypeError;return Ie(Nt)||(Nt=it(Nt)),_e(Ge,ot,At,Nt)}function ee(Ge,ot,At){if(!gt(ot))throw new TypeError;return Ie(At)||(At=it(At)),ke(Ge,ot,At)}function oe(Ge,ot,At){if(!gt(ot))throw new TypeError;return Ie(At)||(At=it(At)),St(Ge,ot,At)}function fe(Ge,ot,At){if(!gt(ot))throw new TypeError;return Ie(At)||(At=it(At)),Mt(Ge,ot,At)}function Re(Ge,ot,At){if(!gt(ot))throw new TypeError;return Ie(At)||(At=it(At)),Ee(Ge,ot,At)}function He(Ge,ot){if(!gt(Ge))throw new TypeError;return Ie(ot)||(ot=it(ot)),tt(Ge,ot)}function Te(Ge,ot){if(!gt(Ge))throw new TypeError;return Ie(ot)||(ot=it(ot)),de(Ge,ot)}function Le(Ge,ot,At){if(!gt(ot))throw new TypeError;if(Ie(At)||(At=it(At)),!gt(ot))throw new TypeError;Ie(At)||(At=it(At));var Nt=Vt(ot,At,!1);return!Ie(Nt)&&Nt.OrdinaryDeleteMetadata(Ge,ot,At)}function we(Ge,ot){for(var At=Ge.length-1;At>=0;--At){var Nt=(0,Ge[At])(ot);if(!Ie(Nt)&&!rt(Nt)){if(!qt(Nt))throw new TypeError;ot=Nt}}return ot}function Ce(Ge,ot,At,Nt){for(var Yn=Ge.length-1;Yn>=0;--Yn){var sr=(0,Ge[Yn])(ot,At,Nt);if(!Ie(sr)&&!rt(sr)){if(!gt(sr))throw new TypeError;Nt=sr}}return Nt}function ke(Ge,ot,At){if(St(Ge,ot,At))return!0;var Nt=Ve(ot);return!rt(Nt)&&ke(Ge,Nt,At)}function St(Ge,ot,At){var Nt=Vt(ot,At,!1);return!Ie(Nt)&&ue(Nt.OrdinaryHasOwnMetadata(Ge,ot,At))}function Mt(Ge,ot,At){if(St(Ge,ot,At))return Ee(Ge,ot,At);var Nt=Ve(ot);return rt(Nt)?void 0:Mt(Ge,Nt,At)}function Ee(Ge,ot,At){var Nt=Vt(ot,At,!1);if(!Ie(Nt))return Nt.OrdinaryGetOwnMetadata(Ge,ot,At)}function _e(Ge,ot,At,Nt){Vt(At,Nt,!0).OrdinaryDefineOwnMetadata(Ge,ot,At,Nt)}function tt(Ge,ot){var At=de(Ge,ot),Nt=Ve(Ge);if(Nt===null)return At;var Yn=tt(Nt,ot);if(Yn.length<=0)return At;if(At.length<=0)return Yn;for(var sr=new G,Si=[],ai=0,En=At;ai<En.length;ai++){var sn=En[ai];sr.has(sn)||(sr.add(sn),Si.push(sn))}for(var Ln=0,Nn=Yn;Ln<Nn.length;Ln++)sn=Nn[Ln],sr.has(sn)||(sr.add(sn),Si.push(sn));return Si}function de(Ge,ot){var At=Vt(Ge,ot,!1);return At?At.OrdinaryOwnMetadataKeys(Ge,ot):[]}function Be(Ge){if(Ge===null)return 1;switch(typeof Ge){case"undefined":return 0;case"boolean":return 2;case"string":return 3;case"symbol":return 4;case"number":return 5;case"object":return Ge===null?1:6;default:return 6}}function Ie(Ge){return Ge===void 0}function rt(Ge){return Ge===null}function ft(Ge){return typeof Ge=="symbol"}function gt(Ge){return typeof Ge=="object"?Ge!==null:typeof Ge=="function"}function bt(Ge,ot){switch(Be(Ge)){case 0:case 1:case 2:case 3:case 4:case 5:return Ge}var At="string",Nt=ce(Ge,T);if(Nt!==void 0){var Yn=Nt.call(Ge,At);if(gt(Yn))throw new TypeError;return Yn}return be(Ge)}function be(Ge,ot){var At,Nt;{var Yn=Ge.toString;if(Ue(Yn)&&!gt(Nt=Yn.call(Ge))||Ue(At=Ge.valueOf)&&!gt(Nt=At.call(Ge)))return Nt}throw new TypeError}function ue(Ge){return!!Ge}function Xe(Ge){return""+Ge}function it(Ge){var ot=bt(Ge);return ft(ot)?ot:Xe(ot)}function $e(Ge){return Array.isArray?Array.isArray(Ge):Ge instanceof Object?Ge instanceof Array:Object.prototype.toString.call(Ge)==="[object Array]"}function Ue(Ge){return typeof Ge=="function"}function qt(Ge){return typeof Ge=="function"}function Ot(Ge){switch(Be(Ge)){case 3:case 4:return!0;default:return!1}}function Yt(Ge,ot){return Ge===ot||Ge!=Ge&&ot!=ot}function ce(Ge,ot){var At=Ge[ot];if(At!=null){if(!Ue(At))throw new TypeError;return At}}function j(Ge){var ot=ce(Ge,x);if(!Ue(ot))throw new TypeError;var At=ot.call(Ge);if(!gt(At))throw new TypeError;return At}function W(Ge){return Ge.value}function me(Ge){var ot=Ge.next();return!ot.done&&ot}function De(Ge){var ot=Ge.return;ot&&ot.call(Ge)}function Ve(Ge){var ot=Object.getPrototypeOf(Ge);if(typeof Ge!="function"||Ge===P||ot!==P)return ot;var At=Ge.prototype,Nt=At&&Object.getPrototypeOf(At);if(Nt==null||Nt===Object.prototype)return ot;var Yn=Nt.constructor;return typeof Yn!="function"||Yn===Ge?ot:Yn}function mt(){var Ge,ot,At,Nt;Ie(q)||y.Reflect===void 0||q in y.Reflect||typeof y.Reflect.defineMetadata!="function"||(Ge=qe(y.Reflect));var Yn=new $,sr={registerProvider:Si,getProvider:En,setProvider:Ln};return sr;function Si(Nn){if(!Object.isExtensible(sr))throw new Error("Cannot add provider to a frozen registry.");switch(!0){case Ge===Nn:break;case Ie(ot):ot=Nn;break;case ot===Nn:break;case Ie(At):At=Nn;break;case At===Nn:break;default:Nt===void 0&&(Nt=new G),Nt.add(Nn)}}function ai(Nn,di){if(!Ie(ot)){if(ot.isProviderFor(Nn,di))return ot;if(!Ie(At)){if(At.isProviderFor(Nn,di))return ot;if(!Ie(Nt))for(var hr=j(Nt);;){var ei=me(hr);if(!ei)return;var Fa=W(ei);if(Fa.isProviderFor(Nn,di))return De(hr),Fa}}}if(!Ie(Ge)&&Ge.isProviderFor(Nn,di))return Ge}function En(Nn,di){var hr,ei=Yn.get(Nn);return Ie(ei)||(hr=ei.get(di)),Ie(hr)&&(Ie(hr=ai(Nn,di))||(Ie(ei)&&(ei=new U,Yn.set(Nn,ei)),ei.set(di,hr))),hr}function sn(Nn){if(Ie(Nn))throw new TypeError;return ot===Nn||At===Nn||!Ie(Nt)&&Nt.has(Nn)}function Ln(Nn,di,hr){if(!sn(hr))throw new Error("Metadata provider not registered.");var ei=En(Nn,di);if(ei!==hr){if(!Ie(ei))return!1;var Fa=Yn.get(Nn);Ie(Fa)&&(Fa=new U,Yn.set(Nn,Fa)),Fa.set(di,hr)}return!0}}function xt(){var Ge;return!Ie(q)&&gt(y.Reflect)&&Object.isExtensible(y.Reflect)&&(Ge=y.Reflect[q]),Ie(Ge)&&(Ge=mt()),!Ie(q)&&gt(y.Reflect)&&Object.isExtensible(y.Reflect)&&Object.defineProperty(y.Reflect,q,{enumerable:!1,configurable:!1,writable:!1,value:Ge}),Ge}function Vn(Ge){var ot=new $,At={isProviderFor:function(sn,Ln){var Nn=ot.get(sn);return!Ie(Nn)&&Nn.has(Ln)},OrdinaryDefineOwnMetadata:Si,OrdinaryHasOwnMetadata:Yn,OrdinaryGetOwnMetadata:sr,OrdinaryOwnMetadataKeys:ai,OrdinaryDeleteMetadata:En};return Y.registerProvider(At),At;function Nt(sn,Ln,Nn){var di=ot.get(sn),hr=!1;if(Ie(di)){if(!Nn)return;di=new U,ot.set(sn,di),hr=!0}var ei=di.get(Ln);if(Ie(ei)){if(!Nn)return;if(ei=new U,di.set(Ln,ei),!Ge.setProvider(sn,Ln,At))throw di.delete(Ln),hr&&ot.delete(sn),new Error("Wrong provider for target.")}return ei}function Yn(sn,Ln,Nn){var di=Nt(Ln,Nn,!1);return!Ie(di)&&ue(di.has(sn))}function sr(sn,Ln,Nn){var di=Nt(Ln,Nn,!1);if(!Ie(di))return di.get(sn)}function Si(sn,Ln,Nn,di){Nt(Nn,di,!0).set(sn,Ln)}function ai(sn,Ln){var Nn=[],di=Nt(sn,Ln,!1);if(Ie(di))return Nn;for(var hr=j(di.keys()),ei=0;;){var Fa=me(hr);if(!Fa)return Nn.length=ei,Nn;var xu=W(Fa);try{Nn[ei]=xu}catch(fd){try{De(hr)}finally{throw fd}}ei++}}function En(sn,Ln,Nn){var di=Nt(Ln,Nn,!1);if(Ie(di)||!di.delete(sn))return!1;if(di.size===0){var hr=ot.get(Ln);Ie(hr)||(hr.delete(Nn),hr.size===0&&ot.delete(hr))}return!0}}function qe(Ge){var ot=Ge.defineMetadata,At=Ge.hasOwnMetadata,Nt=Ge.getOwnMetadata,Yn=Ge.getOwnMetadataKeys,sr=Ge.deleteMetadata,Si=new $;return{isProviderFor:function(ai,En){var sn=Si.get(ai);return!(Ie(sn)||!sn.has(En))||!!Yn(ai,En).length&&(Ie(sn)&&(sn=new G,Si.set(ai,sn)),sn.add(En),!0)},OrdinaryDefineOwnMetadata:ot,OrdinaryHasOwnMetadata:At,OrdinaryGetOwnMetadata:Nt,OrdinaryOwnMetadataKeys:Yn,OrdinaryDeleteMetadata:sr}}function Vt(Ge,ot,At){var Nt=Y.getProvider(Ge,ot);if(!Ie(Nt))return Nt;if(At){if(Y.setProvider(Ge,ot,ie))return ie;throw new Error("Illegal state.")}}function ht(){var Ge={},ot=[],At=function(){function Si(ai,En,sn){this._index=0,this._keys=ai,this._values=En,this._selector=sn}return Si.prototype["@@iterator"]=function(){return this},Si.prototype[x]=function(){return this},Si.prototype.next=function(){var ai=this._index;if(ai>=0&&ai<this._keys.length){var En=this._selector(this._keys[ai],this._values[ai]);return ai+1>=this._keys.length?(this._index=-1,this._keys=ot,this._values=ot):this._index++,{value:En,done:!1}}return{value:void 0,done:!0}},Si.prototype.throw=function(ai){throw this._index>=0&&(this._index=-1,this._keys=ot,this._values=ot),ai},Si.prototype.return=function(ai){return this._index>=0&&(this._index=-1,this._keys=ot,this._values=ot),{value:ai,done:!0}},Si}();return function(){function Si(){this._keys=[],this._values=[],this._cacheKey=Ge,this._cacheIndex=-2}return Object.defineProperty(Si.prototype,"size",{get:function(){return this._keys.length},enumerable:!0,configurable:!0}),Si.prototype.has=function(ai){return this._find(ai,!1)>=0},Si.prototype.get=function(ai){var En=this._find(ai,!1);return En>=0?this._values[En]:void 0},Si.prototype.set=function(ai,En){var sn=this._find(ai,!0);return this._values[sn]=En,this},Si.prototype.delete=function(ai){var En=this._find(ai,!1);if(En>=0){for(var sn=this._keys.length,Ln=En+1;Ln<sn;Ln++)this._keys[Ln-1]=this._keys[Ln],this._values[Ln-1]=this._values[Ln];return this._keys.length--,this._values.length--,Yt(ai,this._cacheKey)&&(this._cacheKey=Ge,this._cacheIndex=-2),!0}return!1},Si.prototype.clear=function(){this._keys.length=0,this._values.length=0,this._cacheKey=Ge,this._cacheIndex=-2},Si.prototype.keys=function(){return new At(this._keys,this._values,Nt)},Si.prototype.values=function(){return new At(this._keys,this._values,Yn)},Si.prototype.entries=function(){return new At(this._keys,this._values,sr)},Si.prototype["@@iterator"]=function(){return this.entries()},Si.prototype[x]=function(){return this.entries()},Si.prototype._find=function(ai,En){if(!Yt(this._cacheKey,ai)){this._cacheIndex=-1;for(var sn=0;sn<this._keys.length;sn++)if(Yt(this._keys[sn],ai)){this._cacheIndex=sn;break}}return this._cacheIndex<0&&En&&(this._cacheIndex=this._keys.length,this._keys.push(ai),this._values.push(void 0)),this._cacheIndex},Si}();function Nt(Si,ai){return Si}function Yn(Si,ai){return ai}function sr(Si,ai){return[Si,ai]}}function Pt(){return function(){function Ge(){this._map=new U}return Object.defineProperty(Ge.prototype,"size",{get:function(){return this._map.size},enumerable:!0,configurable:!0}),Ge.prototype.has=function(ot){return this._map.has(ot)},Ge.prototype.add=function(ot){return this._map.set(ot,ot),this},Ge.prototype.delete=function(ot){return this._map.delete(ot)},Ge.prototype.clear=function(){this._map.clear()},Ge.prototype.keys=function(){return this._map.keys()},Ge.prototype.values=function(){return this._map.keys()},Ge.prototype.entries=function(){return this._map.entries()},Ge.prototype["@@iterator"]=function(){return this.keys()},Ge.prototype[x]=function(){return this.keys()},Ge}()}function hn(){var Ge=16,ot=k.create(),At=Nt();return function(){function En(){this._key=Nt()}return En.prototype.has=function(sn){var Ln=Yn(sn,!1);return Ln!==void 0&&k.has(Ln,this._key)},En.prototype.get=function(sn){var Ln=Yn(sn,!1);return Ln!==void 0?k.get(Ln,this._key):void 0},En.prototype.set=function(sn,Ln){return Yn(sn,!0)[this._key]=Ln,this},En.prototype.delete=function(sn){var Ln=Yn(sn,!1);return Ln!==void 0&&delete Ln[this._key]},En.prototype.clear=function(){this._key=Nt()},En}();function Nt(){var En;do En="@@WeakMap@@"+ai();while(k.has(ot,En));return ot[En]=!0,En}function Yn(En,sn){if(!v.call(En,At)){if(!sn)return;Object.defineProperty(En,At,{value:k.create()})}return En[At]}function sr(En,sn){for(var Ln=0;Ln<sn;++Ln)En[Ln]=255*Math.random()|0;return En}function Si(En){if(typeof Uint8Array=="function"){var sn=new Uint8Array(En);return typeof crypto<"u"?crypto.getRandomValues(sn):typeof msCrypto<"u"?msCrypto.getRandomValues(sn):sr(sn,En),sn}return sr(new Array(En),En)}function ai(){var En=Si(Ge);En[6]=79&En[6]|64,En[8]=191&En[8]|128;for(var sn="",Ln=0;Ln<Ge;++Ln){var Nn=En[Ln];Ln!==4&&Ln!==6&&Ln!==8||(sn+="-"),Nn<16&&(sn+="0"),sn+=Nn.toString(16).toLowerCase()}return sn}}function an(Ge){return Ge.__=void 0,delete Ge.__,Ge}g("decorate",V),g("metadata",J),g("defineMetadata",X),g("hasMetadata",ee),g("hasOwnMetadata",oe),g("getMetadata",fe),g("getOwnMetadata",Re),g("getMetadataKeys",He),g("getOwnMetadataKeys",Te),g("deleteMetadata",Le)}(d,f),f.Reflect===void 0&&(f.Reflect=u)})()})(l||(l={}))}},i={};function r(a){var o=i[a];if(o!==void 0)return o.exports;var c=i[a]={id:a,loaded:!1,exports:{}};return n[a].call(c.exports,c,c.exports,r),c.loaded=!0,c.exports}r.n=a=>{var o=a&&a.__esModule?()=>a.default:()=>a;return r.d(o,{a:o}),o},r.d=(a,o)=>{for(var c in o)r.o(o,c)&&!r.o(a,c)&&Object.defineProperty(a,c,{enumerable:!0,get:o[c]})},r.g=function(){if(typeof globalThis=="object")return globalThis;try{return this||new Function("return this")()}catch{if(typeof window=="object")return window}}(),r.o=(a,o)=>Object.prototype.hasOwnProperty.call(a,o),r.r=a=>{typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(a,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(a,"__esModule",{value:!0})},r.nmd=a=>(a.paths=[],a.children||(a.children=[]),a);var s={};return(()=>{r.r(s),r.d(s,{BASIC_FULL_HD_LANDSCAPE:()=>Ti,BASIC_FULL_HD_PORTRAIT:()=>Bn,BASIC_LANDSCAPE:()=>Ki,BASIC_PORTRAIT:()=>Xn,BroadcastClientError:()=>xt,BroadcastClientEvents:()=>wa,ConnectionState:()=>at,Errors:()=>u,InitialLayerPreference:()=>Kl,JitterBufferMinDelay:()=>Gs,LOG_LEVEL:()=>W,LocalStageStream:()=>lS,LocalStageStreamEvents:()=>Rf,LogLevels:()=>W,RemoteStageStream:()=>fS,RemoteStageStreamEvents:()=>co,STANDARD_LANDSCAPE:()=>qo,STANDARD_PORTRAIT:()=>$l,Stage:()=>Rd,StageConnectionState:()=>fs,StageErrorCategory:()=>Af,StageErrorCode:()=>Er,StageEvents:()=>Vr,StageLeftReason:()=>sg,StageParticipantPublishState:()=>qs,StageParticipantSubscribeState:()=>Qo,StageStream:()=>fv,StageStreamLayerSelectedReason:()=>Mh,StreamType:()=>Xt,SubscribeType:()=>Oo,__version:()=>B0,create:()=>Hr,default:()=>pS,isSupported:()=>j});var a={};r.r(a),r.d(a,{fixNegotiationNeeded:()=>ee,shimAddTrackRemoveTrack:()=>J,shimAddTrackRemoveTrackWithNative:()=>V,shimGetDisplayMedia:()=>U,shimGetSendersWithDtmf:()=>q,shimGetStats:()=>Y,shimGetUserMedia:()=>P,shimMediaStream:()=>G,shimOnTrack:()=>$,shimPeerConnection:()=>X,shimSenderReceiverGetStats:()=>ie});var o={};r.r(o),r.d(o,{shimAddTransceiver:()=>ke,shimCreateAnswer:()=>Ee,shimCreateOffer:()=>Mt,shimGetDisplayMedia:()=>fe,shimGetParameters:()=>St,shimGetUserMedia:()=>oe,shimOnTrack:()=>Re,shimPeerConnection:()=>He,shimRTCDataChannel:()=>Ce,shimReceiverGetStats:()=>Le,shimRemoveStream:()=>we,shimSenderGetStats:()=>Te});var c={};r.r(c),r.d(c,{shimAudioContext:()=>bt,shimCallbacksAPI:()=>de,shimConstraints:()=>Ie,shimCreateOfferLegacy:()=>gt,shimGetUserMedia:()=>Be,shimLocalStreamsAPI:()=>_e,shimRTCIceServerUrls:()=>rt,shimRemoteStreamsAPI:()=>tt,shimTrackEventTransceiver:()=>ft});var l={};r.r(l),r.d(l,{removeExtmapAllowMixed:()=>Ot,shimAddIceCandidateNullOrEmpty:()=>Yt,shimConnectionState:()=>qt,shimMaxMessageSize:()=>$e,shimParameterlessSetLocalDescription:()=>ce,shimRTCIceCandidate:()=>Xe,shimRTCIceCandidateRelayProtocol:()=>it,shimSendThrowTypeError:()=>Ue});var u={};r.r(u),r.d(u,{ADD_DEVICE_COMPOSITION_INDEX_MISSING_ERROR:()=>an,ADD_DEVICE_COMPOSITION_MISSING_ERROR:()=>hn,ADD_DEVICE_CONSTRAINTS_ERROR:()=>At,ADD_DEVICE_DEVICE_ERROR:()=>ht,ADD_DEVICE_NAME_EXISTS_ERROR:()=>Pt,ADD_DEVICE_NAME_MISSING_ERROR:()=>Ge,ADD_DEVICE_UNSUPPORTED:()=>ot,BROADCAST_CONFIGURATION_ERROR:()=>hr,BROADCAST_ERROR:()=>Vn,CAMERA_ERROR:()=>qe,CLIENT_INVALID_ERROR:()=>A0,EXCHANGE_POSITION_DEVICE_NOT_FOUND_ERROR:()=>En,FAILED_TO_ADD_IMAGE_ERROR:()=>sn,INGEST_ENDPOINT_TYPE_ERROR:()=>Fa,INGEST_ENDPOINT_URL_ERROR:()=>xu,INPUT_ERROR:()=>Vt,INVALID_STREAM_KEY:()=>di,LOGGER_TYPE_ERROR:()=>Np,LOG_LEVEL_TYPE_ERROR:()=>fd,NETWORK_RECONNECT_CONFIGURATION_ERROR:()=>dd,NETWORK_RECONNECT_CONFIGURATION_INVALID_TIMEOUT_ERROR:()=>pd,PEER_CONNECTION_ERROR:()=>Nn,PEER_SETUP_ERROR:()=>Ln,REMOVE_DEVICE_NOT_FOUND_ERROR:()=>Nt,REMOVE_IMAGE_NOT_FOUND_ERROR:()=>Yn,STAGE_TOKEN_TYPE_ERROR:()=>ve,STAGE_WHIP_OVERRIDE_ERROR:()=>Ke,STREAM_CONFIGURATION_ERROR:()=>ei,STREAM_KEY_INVALID_CHAR_ERROR:()=>wu,UPDATE_VIDEO_DEVICE_COMPOSITION_INDEX_MISSING_ERROR:()=>Si,UPDATE_VIDEO_DEVICE_COMPOSITION_MISSING_ERROR:()=>sr,UPDATE_VIDEO_DEVICE_COMPOSITION_NAME_NOT_FOUND_ERROR:()=>ai});var h={};r.r(h),r.d(h,{BASIC_FULL_HD_LANDSCAPE:()=>Ti,BASIC_FULL_HD_PORTRAIT:()=>Bn,BASIC_LANDSCAPE:()=>Ki,BASIC_PORTRAIT:()=>Xn,BroadcastClientError:()=>xt,BroadcastClientEvents:()=>wa,ConnectionState:()=>at,Errors:()=>u,LOG_LEVEL:()=>W,LogLevels:()=>W,STANDARD_LANDSCAPE:()=>qo,STANDARD_PORTRAIT:()=>$l,__version:()=>B0,create:()=>Hr,isSupported:()=>j});let f=!0,d=!0;function p(N,S,A){const O=N.match(S);return O&&O.length>=A&&parseInt(O[A],10)}function g(N,S,A){if(!N.RTCPeerConnection)return;const O=N.RTCPeerConnection.prototype,L=O.addEventListener;O.addEventListener=function(H,te){if(H!==S)return L.apply(this,arguments);const re=K=>{const ae=A(K);ae&&(te.handleEvent?te.handleEvent(ae):te(ae))};return this._eventMap=this._eventMap||{},this._eventMap[S]||(this._eventMap[S]=new Map),this._eventMap[S].set(te,re),L.apply(this,[H,re])};const B=O.removeEventListener;O.removeEventListener=function(H,te){if(H!==S||!this._eventMap||!this._eventMap[S])return B.apply(this,arguments);if(!this._eventMap[S].has(te))return B.apply(this,arguments);const re=this._eventMap[S].get(te);return this._eventMap[S].delete(te),this._eventMap[S].size===0&&delete this._eventMap[S],Object.keys(this._eventMap).length===0&&delete this._eventMap,B.apply(this,[H,re])},Object.defineProperty(O,"on"+S,{get(){return this["_on"+S]},set(H){this["_on"+S]&&(this.removeEventListener(S,this["_on"+S]),delete this["_on"+S]),H&&this.addEventListener(S,this["_on"+S]=H)},enumerable:!0,configurable:!0})}function y(N){return typeof N!="boolean"?new Error("Argument type: "+typeof N+". Please use a boolean."):(f=N,N?"adapter.js logging disabled":"adapter.js logging enabled")}function v(N){return typeof N!="boolean"?new Error("Argument type: "+typeof N+". Please use a boolean."):(d=!N,"adapter.js deprecation warnings "+(N?"disabled":"enabled"))}function b(){if(typeof window=="object"){if(f)return;typeof console<"u"&&typeof console.log=="function"&&console.log.apply(console,arguments)}}function T(N,S){d&&console.warn(N+" is deprecated, please use "+S+" instead.")}function x(N){return Object.prototype.toString.call(N)==="[object Object]"}function M(N){return x(N)?Object.keys(N).reduce(function(S,A){const O=x(N[A]),L=O?M(N[A]):N[A],B=O&&!Object.keys(L).length;return L===void 0||B?S:Object.assign(S,{[A]:L})},{}):N}function R(N,S,A){S&&!A.has(S.id)&&(A.set(S.id,S),Object.keys(S).forEach(O=>{O.endsWith("Id")?R(N,N.get(S[O]),A):O.endsWith("Ids")&&S[O].forEach(L=>{R(N,N.get(L),A)})}))}function I(N,S,A){const O=A?"outbound-rtp":"inbound-rtp",L=new Map;if(S===null)return L;const B=[];return N.forEach(H=>{H.type==="track"&&H.trackIdentifier===S.id&&B.push(H)}),B.forEach(H=>{N.forEach(te=>{te.type===O&&te.trackId===H.id&&R(N,te,L)})}),L}const k=b;function P(N,S){const A=N&&N.navigator;if(!A.mediaDevices)return;const O=function(H){if(typeof H!="object"||H.mandatory||H.optional)return H;const te={};return Object.keys(H).forEach(re=>{if(re==="require"||re==="advanced"||re==="mediaSource")return;const K=typeof H[re]=="object"?H[re]:{ideal:H[re]};K.exact!==void 0&&typeof K.exact=="number"&&(K.min=K.max=K.exact);const ae=function(he,pe){return he?he+pe.charAt(0).toUpperCase()+pe.slice(1):pe==="deviceId"?"sourceId":pe};if(K.ideal!==void 0){te.optional=te.optional||[];let he={};typeof K.ideal=="number"?(he[ae("min",re)]=K.ideal,te.optional.push(he),he={},he[ae("max",re)]=K.ideal,te.optional.push(he)):(he[ae("",re)]=K.ideal,te.optional.push(he))}K.exact!==void 0&&typeof K.exact!="number"?(te.mandatory=te.mandatory||{},te.mandatory[ae("",re)]=K.exact):["min","max"].forEach(he=>{K[he]!==void 0&&(te.mandatory=te.mandatory||{},te.mandatory[ae(he,re)]=K[he])})}),H.advanced&&(te.optional=(te.optional||[]).concat(H.advanced)),te},L=function(H,te){if(S.version>=61)return te(H);if((H=JSON.parse(JSON.stringify(H)))&&typeof H.audio=="object"){const re=function(K,ae,he){ae in K&&!(he in K)&&(K[he]=K[ae],delete K[ae])};re((H=JSON.parse(JSON.stringify(H))).audio,"autoGainControl","googAutoGainControl"),re(H.audio,"noiseSuppression","googNoiseSuppression"),H.audio=O(H.audio)}if(H&&typeof H.video=="object"){let re=H.video.facingMode;re=re&&(typeof re=="object"?re:{ideal:re});const K=S.version<66;if(re&&(re.exact==="user"||re.exact==="environment"||re.ideal==="user"||re.ideal==="environment")&&(!A.mediaDevices.getSupportedConstraints||!A.mediaDevices.getSupportedConstraints().facingMode||K)){let ae;if(delete H.video.facingMode,re.exact==="environment"||re.ideal==="environment"?ae=["back","rear"]:re.exact!=="user"&&re.ideal!=="user"||(ae=["front"]),ae)return A.mediaDevices.enumerateDevices().then(he=>{let pe=(he=he.filter(Ne=>Ne.kind==="videoinput")).find(Ne=>ae.some(Je=>Ne.label.toLowerCase().includes(Je)));return!pe&&he.length&&ae.includes("back")&&(pe=he[he.length-1]),pe&&(H.video.deviceId=re.exact?{exact:pe.deviceId}:{ideal:pe.deviceId}),H.video=O(H.video),k("chrome: "+JSON.stringify(H)),te(H)})}H.video=O(H.video)}return k("chrome: "+JSON.stringify(H)),te(H)},B=function(H){return S.version>=64?H:{name:{PermissionDeniedError:"NotAllowedError",PermissionDismissedError:"NotAllowedError",InvalidStateError:"NotAllowedError",DevicesNotFoundError:"NotFoundError",ConstraintNotSatisfiedError:"OverconstrainedError",TrackStartError:"NotReadableError",MediaDeviceFailedDueToShutdown:"NotAllowedError",MediaDeviceKillSwitchOn:"NotAllowedError",TabCaptureError:"AbortError",ScreenCaptureError:"AbortError",DeviceCaptureError:"AbortError"}[H.name]||H.name,message:H.message,constraint:H.constraint||H.constraintName,toString(){return this.name+(this.message&&": ")+this.message}}};if(A.getUserMedia=(function(H,te,re){L(H,K=>{A.webkitGetUserMedia(K,te,ae=>{re&&re(B(ae))})})}).bind(A),A.mediaDevices.getUserMedia){const H=A.mediaDevices.getUserMedia.bind(A.mediaDevices);A.mediaDevices.getUserMedia=function(te){return L(te,re=>H(re).then(K=>{if(re.audio&&!K.getAudioTracks().length||re.video&&!K.getVideoTracks().length)throw K.getTracks().forEach(ae=>{ae.stop()}),new DOMException("","NotFoundError");return K},K=>Promise.reject(B(K))))}}}function U(N,S){N.navigator.mediaDevices&&"getDisplayMedia"in N.navigator.mediaDevices||N.navigator.mediaDevices&&(typeof S=="function"?N.navigator.mediaDevices.getDisplayMedia=function(A){return S(A).then(O=>{const L=A.video&&A.video.width,B=A.video&&A.video.height,H=A.video&&A.video.frameRate;return A.video={mandatory:{chromeMediaSource:"desktop",chromeMediaSourceId:O,maxFrameRate:H||3}},L&&(A.video.mandatory.maxWidth=L),B&&(A.video.mandatory.maxHeight=B),N.navigator.mediaDevices.getUserMedia(A)})}:console.error("shimGetDisplayMedia: getSourceId argument is not a function"))}function G(N){N.MediaStream=N.MediaStream||N.webkitMediaStream}function $(N){if(typeof N=="object"&&N.RTCPeerConnection&&!("ontrack"in N.RTCPeerConnection.prototype)){Object.defineProperty(N.RTCPeerConnection.prototype,"ontrack",{get(){return this._ontrack},set(A){this._ontrack&&this.removeEventListener("track",this._ontrack),this.addEventListener("track",this._ontrack=A)},enumerable:!0,configurable:!0});const S=N.RTCPeerConnection.prototype.setRemoteDescription;N.RTCPeerConnection.prototype.setRemoteDescription=function(){return this._ontrackpoly||(this._ontrackpoly=A=>{A.stream.addEventListener("addtrack",O=>{let L;L=N.RTCPeerConnection.prototype.getReceivers?this.getReceivers().find(H=>H.track&&H.track.id===O.track.id):{track:O.track};const B=new Event("track");B.track=O.track,B.receiver=L,B.transceiver={receiver:L},B.streams=[A.stream],this.dispatchEvent(B)}),A.stream.getTracks().forEach(O=>{let L;L=N.RTCPeerConnection.prototype.getReceivers?this.getReceivers().find(H=>H.track&&H.track.id===O.id):{track:O};const B=new Event("track");B.track=O,B.receiver=L,B.transceiver={receiver:L},B.streams=[A.stream],this.dispatchEvent(B)})},this.addEventListener("addstream",this._ontrackpoly)),S.apply(this,arguments)}}else g(N,"track",S=>(S.transceiver||Object.defineProperty(S,"transceiver",{value:{receiver:S.receiver}}),S))}function q(N){if(typeof N=="object"&&N.RTCPeerConnection&&!("getSenders"in N.RTCPeerConnection.prototype)&&"createDTMFSender"in N.RTCPeerConnection.prototype){const S=function(L,B){return{track:B,get dtmf(){return this._dtmf===void 0&&(B.kind==="audio"?this._dtmf=L.createDTMFSender(B):this._dtmf=null),this._dtmf},_pc:L}};if(!N.RTCPeerConnection.prototype.getSenders){N.RTCPeerConnection.prototype.getSenders=function(){return this._senders=this._senders||[],this._senders.slice()};const L=N.RTCPeerConnection.prototype.addTrack;N.RTCPeerConnection.prototype.addTrack=function(H,te){let re=L.apply(this,arguments);return re||(re=S(this,H),this._senders.push(re)),re};const B=N.RTCPeerConnection.prototype.removeTrack;N.RTCPeerConnection.prototype.removeTrack=function(H){B.apply(this,arguments);const te=this._senders.indexOf(H);te!==-1&&this._senders.splice(te,1)}}const A=N.RTCPeerConnection.prototype.addStream;N.RTCPeerConnection.prototype.addStream=function(L){this._senders=this._senders||[],A.apply(this,[L]),L.getTracks().forEach(B=>{this._senders.push(S(this,B))})};const O=N.RTCPeerConnection.prototype.removeStream;N.RTCPeerConnection.prototype.removeStream=function(L){this._senders=this._senders||[],O.apply(this,[L]),L.getTracks().forEach(B=>{const H=this._senders.find(te=>te.track===B);H&&this._senders.splice(this._senders.indexOf(H),1)})}}else if(typeof N=="object"&&N.RTCPeerConnection&&"getSenders"in N.RTCPeerConnection.prototype&&"createDTMFSender"in N.RTCPeerConnection.prototype&&N.RTCRtpSender&&!("dtmf"in N.RTCRtpSender.prototype)){const S=N.RTCPeerConnection.prototype.getSenders;N.RTCPeerConnection.prototype.getSenders=function(){const A=S.apply(this,[]);return A.forEach(O=>O._pc=this),A},Object.defineProperty(N.RTCRtpSender.prototype,"dtmf",{get(){return this._dtmf===void 0&&(this.track.kind==="audio"?this._dtmf=this._pc.createDTMFSender(this.track):this._dtmf=null),this._dtmf}})}}function Y(N){if(!N.RTCPeerConnection)return;const S=N.RTCPeerConnection.prototype.getStats;N.RTCPeerConnection.prototype.getStats=function(){const[A,O,L]=arguments;if(arguments.length>0&&typeof A=="function")return S.apply(this,arguments);if(S.length===0&&(arguments.length===0||typeof A!="function"))return S.apply(this,[]);const B=function(te){const re={};return te.result().forEach(K=>{const ae={id:K.id,timestamp:K.timestamp,type:{localcandidate:"local-candidate",remotecandidate:"remote-candidate"}[K.type]||K.type};K.names().forEach(he=>{ae[he]=K.stat(he)}),re[ae.id]=ae}),re},H=function(te){return new Map(Object.keys(te).map(re=>[re,te[re]]))};if(arguments.length>=2){const te=function(re){O(H(B(re)))};return S.apply(this,[te,A])}return new Promise((te,re)=>{S.apply(this,[function(K){te(H(B(K)))},re])}).then(O,L)}}function ie(N){if(!(typeof N=="object"&&N.RTCPeerConnection&&N.RTCRtpSender&&N.RTCRtpReceiver))return;if(!("getStats"in N.RTCRtpSender.prototype)){const A=N.RTCPeerConnection.prototype.getSenders;A&&(N.RTCPeerConnection.prototype.getSenders=function(){const L=A.apply(this,[]);return L.forEach(B=>B._pc=this),L});const O=N.RTCPeerConnection.prototype.addTrack;O&&(N.RTCPeerConnection.prototype.addTrack=function(){const L=O.apply(this,arguments);return L._pc=this,L}),N.RTCRtpSender.prototype.getStats=function(){const L=this;return this._pc.getStats().then(B=>I(B,L.track,!0))}}if(!("getStats"in N.RTCRtpReceiver.prototype)){const A=N.RTCPeerConnection.prototype.getReceivers;A&&(N.RTCPeerConnection.prototype.getReceivers=function(){const O=A.apply(this,[]);return O.forEach(L=>L._pc=this),O}),g(N,"track",O=>(O.receiver._pc=O.srcElement,O)),N.RTCRtpReceiver.prototype.getStats=function(){const O=this;return this._pc.getStats().then(L=>I(L,O.track,!1))}}if(!("getStats"in N.RTCRtpSender.prototype)||!("getStats"in N.RTCRtpReceiver.prototype))return;const S=N.RTCPeerConnection.prototype.getStats;N.RTCPeerConnection.prototype.getStats=function(){if(arguments.length>0&&arguments[0]instanceof N.MediaStreamTrack){const A=arguments[0];let O,L,B;return this.getSenders().forEach(H=>{H.track===A&&(O?B=!0:O=H)}),this.getReceivers().forEach(H=>(H.track===A&&(L?B=!0:L=H),H.track===A)),B||O&&L?Promise.reject(new DOMException("There are more than one sender or receiver for the track.","InvalidAccessError")):O?O.getStats():L?L.getStats():Promise.reject(new DOMException("There is no sender or receiver for the track.","InvalidAccessError"))}return S.apply(this,arguments)}}function V(N){N.RTCPeerConnection.prototype.getLocalStreams=function(){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},Object.keys(this._shimmedLocalStreams).map(B=>this._shimmedLocalStreams[B][0])};const S=N.RTCPeerConnection.prototype.addTrack;N.RTCPeerConnection.prototype.addTrack=function(B,H){if(!H)return S.apply(this,arguments);this._shimmedLocalStreams=this._shimmedLocalStreams||{};const te=S.apply(this,arguments);return this._shimmedLocalStreams[H.id]?this._shimmedLocalStreams[H.id].indexOf(te)===-1&&this._shimmedLocalStreams[H.id].push(te):this._shimmedLocalStreams[H.id]=[H,te],te};const A=N.RTCPeerConnection.prototype.addStream;N.RTCPeerConnection.prototype.addStream=function(B){this._shimmedLocalStreams=this._shimmedLocalStreams||{},B.getTracks().forEach(re=>{if(this.getSenders().find(K=>K.track===re))throw new DOMException("Track already exists.","InvalidAccessError")});const H=this.getSenders();A.apply(this,arguments);const te=this.getSenders().filter(re=>H.indexOf(re)===-1);this._shimmedLocalStreams[B.id]=[B].concat(te)};const O=N.RTCPeerConnection.prototype.removeStream;N.RTCPeerConnection.prototype.removeStream=function(B){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},delete this._shimmedLocalStreams[B.id],O.apply(this,arguments)};const L=N.RTCPeerConnection.prototype.removeTrack;N.RTCPeerConnection.prototype.removeTrack=function(B){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},B&&Object.keys(this._shimmedLocalStreams).forEach(H=>{const te=this._shimmedLocalStreams[H].indexOf(B);te!==-1&&this._shimmedLocalStreams[H].splice(te,1),this._shimmedLocalStreams[H].length===1&&delete this._shimmedLocalStreams[H]}),L.apply(this,arguments)}}function J(N,S){if(!N.RTCPeerConnection)return;if(N.RTCPeerConnection.prototype.addTrack&&S.version>=65)return V(N);const A=N.RTCPeerConnection.prototype.getLocalStreams;N.RTCPeerConnection.prototype.getLocalStreams=function(){const re=A.apply(this);return this._reverseStreams=this._reverseStreams||{},re.map(K=>this._reverseStreams[K.id])};const O=N.RTCPeerConnection.prototype.addStream;N.RTCPeerConnection.prototype.addStream=function(re){if(this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},re.getTracks().forEach(K=>{if(this.getSenders().find(ae=>ae.track===K))throw new DOMException("Track already exists.","InvalidAccessError")}),!this._reverseStreams[re.id]){const K=new N.MediaStream(re.getTracks());this._streams[re.id]=K,this._reverseStreams[K.id]=re,re=K}O.apply(this,[re])};const L=N.RTCPeerConnection.prototype.removeStream;function B(re,K){let ae=K.sdp;return Object.keys(re._reverseStreams||[]).forEach(he=>{const pe=re._reverseStreams[he],Ne=re._streams[pe.id];ae=ae.replace(new RegExp(Ne.id,"g"),pe.id)}),new RTCSessionDescription({type:K.type,sdp:ae})}N.RTCPeerConnection.prototype.removeStream=function(re){this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},L.apply(this,[this._streams[re.id]||re]),delete this._reverseStreams[this._streams[re.id]?this._streams[re.id].id:re.id],delete this._streams[re.id]},N.RTCPeerConnection.prototype.addTrack=function(re,K){if(this.signalingState==="closed")throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");const ae=[].slice.call(arguments,1);if(ae.length!==1||!ae[0].getTracks().find(pe=>pe===re))throw new DOMException("The adapter.js addTrack polyfill only supports a single  stream which is associated with the specified track.","NotSupportedError");if(this.getSenders().find(pe=>pe.track===re))throw new DOMException("Track already exists.","InvalidAccessError");this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{};const he=this._streams[K.id];if(he)he.addTrack(re),Promise.resolve().then(()=>{this.dispatchEvent(new Event("negotiationneeded"))});else{const pe=new N.MediaStream([re]);this._streams[K.id]=pe,this._reverseStreams[pe.id]=K,this.addStream(pe)}return this.getSenders().find(pe=>pe.track===re)},["createOffer","createAnswer"].forEach(function(re){const K=N.RTCPeerConnection.prototype[re],ae={[re](){const he=arguments;return arguments.length&&typeof arguments[0]=="function"?K.apply(this,[pe=>{const Ne=B(this,pe);he[0].apply(null,[Ne])},pe=>{he[1]&&he[1].apply(null,pe)},arguments[2]]):K.apply(this,arguments).then(pe=>B(this,pe))}};N.RTCPeerConnection.prototype[re]=ae[re]});const H=N.RTCPeerConnection.prototype.setLocalDescription;N.RTCPeerConnection.prototype.setLocalDescription=function(){return arguments.length&&arguments[0].type?(arguments[0]=function(re,K){let ae=K.sdp;return Object.keys(re._reverseStreams||[]).forEach(he=>{const pe=re._reverseStreams[he],Ne=re._streams[pe.id];ae=ae.replace(new RegExp(pe.id,"g"),Ne.id)}),new RTCSessionDescription({type:K.type,sdp:ae})}(this,arguments[0]),H.apply(this,arguments)):H.apply(this,arguments)};const te=Object.getOwnPropertyDescriptor(N.RTCPeerConnection.prototype,"localDescription");Object.defineProperty(N.RTCPeerConnection.prototype,"localDescription",{get(){const re=te.get.apply(this);return re.type===""?re:B(this,re)}}),N.RTCPeerConnection.prototype.removeTrack=function(re){if(this.signalingState==="closed")throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");if(!re._pc)throw new DOMException("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.","TypeError");if(re._pc!==this)throw new DOMException("Sender was not created by this connection.","InvalidAccessError");let K;this._streams=this._streams||{},Object.keys(this._streams).forEach(ae=>{this._streams[ae].getTracks().find(he=>re.track===he)&&(K=this._streams[ae])}),K&&(K.getTracks().length===1?this.removeStream(this._reverseStreams[K.id]):K.removeTrack(re.track),this.dispatchEvent(new Event("negotiationneeded")))}}function X(N,S){!N.RTCPeerConnection&&N.webkitRTCPeerConnection&&(N.RTCPeerConnection=N.webkitRTCPeerConnection),N.RTCPeerConnection&&S.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(A){const O=N.RTCPeerConnection.prototype[A],L={[A](){return arguments[0]=new(A==="addIceCandidate"?N.RTCIceCandidate:N.RTCSessionDescription)(arguments[0]),O.apply(this,arguments)}};N.RTCPeerConnection.prototype[A]=L[A]})}function ee(N,S){g(N,"negotiationneeded",A=>{const O=A.target;if(!(S.version<72||O.getConfiguration&&O.getConfiguration().sdpSemantics==="plan-b")||O.signalingState==="stable")return A})}function oe(N,S){const A=N&&N.navigator,O=N&&N.MediaStreamTrack;if(A.getUserMedia=function(L,B,H){T("navigator.getUserMedia","navigator.mediaDevices.getUserMedia"),A.mediaDevices.getUserMedia(L).then(B,H)},!(S.version>55&&"autoGainControl"in A.mediaDevices.getSupportedConstraints())){const L=function(H,te,re){te in H&&!(re in H)&&(H[re]=H[te],delete H[te])},B=A.mediaDevices.getUserMedia.bind(A.mediaDevices);if(A.mediaDevices.getUserMedia=function(H){return typeof H=="object"&&typeof H.audio=="object"&&(H=JSON.parse(JSON.stringify(H)),L(H.audio,"autoGainControl","mozAutoGainControl"),L(H.audio,"noiseSuppression","mozNoiseSuppression")),B(H)},O&&O.prototype.getSettings){const H=O.prototype.getSettings;O.prototype.getSettings=function(){const te=H.apply(this,arguments);return L(te,"mozAutoGainControl","autoGainControl"),L(te,"mozNoiseSuppression","noiseSuppression"),te}}if(O&&O.prototype.applyConstraints){const H=O.prototype.applyConstraints;O.prototype.applyConstraints=function(te){return this.kind==="audio"&&typeof te=="object"&&(te=JSON.parse(JSON.stringify(te)),L(te,"autoGainControl","mozAutoGainControl"),L(te,"noiseSuppression","mozNoiseSuppression")),H.apply(this,[te])}}}}function fe(N,S){N.navigator.mediaDevices&&"getDisplayMedia"in N.navigator.mediaDevices||N.navigator.mediaDevices&&(N.navigator.mediaDevices.getDisplayMedia=function(A){if(!A||!A.video){const O=new DOMException("getDisplayMedia without video constraints is undefined");return O.name="NotFoundError",O.code=8,Promise.reject(O)}return A.video===!0?A.video={mediaSource:S}:A.video.mediaSource=S,N.navigator.mediaDevices.getUserMedia(A)})}function Re(N){typeof N=="object"&&N.RTCTrackEvent&&"receiver"in N.RTCTrackEvent.prototype&&!("transceiver"in N.RTCTrackEvent.prototype)&&Object.defineProperty(N.RTCTrackEvent.prototype,"transceiver",{get(){return{receiver:this.receiver}}})}function He(N,S){if(typeof N!="object"||!N.RTCPeerConnection&&!N.mozRTCPeerConnection)return;!N.RTCPeerConnection&&N.mozRTCPeerConnection&&(N.RTCPeerConnection=N.mozRTCPeerConnection),S.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(L){const B=N.RTCPeerConnection.prototype[L],H={[L](){return arguments[0]=new(L==="addIceCandidate"?N.RTCIceCandidate:N.RTCSessionDescription)(arguments[0]),B.apply(this,arguments)}};N.RTCPeerConnection.prototype[L]=H[L]});const A={inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"},O=N.RTCPeerConnection.prototype.getStats;N.RTCPeerConnection.prototype.getStats=function(){const[L,B,H]=arguments;return O.apply(this,[L||null]).then(te=>{if(S.version<53&&!B)try{te.forEach(re=>{re.type=A[re.type]||re.type})}catch(re){if(re.name!=="TypeError")throw re;te.forEach((K,ae)=>{te.set(ae,Object.assign({},K,{type:A[K.type]||K.type}))})}return te}).then(B,H)}}function Te(N){if(typeof N!="object"||!N.RTCPeerConnection||!N.RTCRtpSender||N.RTCRtpSender&&"getStats"in N.RTCRtpSender.prototype)return;const S=N.RTCPeerConnection.prototype.getSenders;S&&(N.RTCPeerConnection.prototype.getSenders=function(){const O=S.apply(this,[]);return O.forEach(L=>L._pc=this),O});const A=N.RTCPeerConnection.prototype.addTrack;A&&(N.RTCPeerConnection.prototype.addTrack=function(){const O=A.apply(this,arguments);return O._pc=this,O}),N.RTCRtpSender.prototype.getStats=function(){return this.track?this._pc.getStats(this.track):Promise.resolve(new Map)}}function Le(N){if(typeof N!="object"||!N.RTCPeerConnection||!N.RTCRtpSender||N.RTCRtpSender&&"getStats"in N.RTCRtpReceiver.prototype)return;const S=N.RTCPeerConnection.prototype.getReceivers;S&&(N.RTCPeerConnection.prototype.getReceivers=function(){const A=S.apply(this,[]);return A.forEach(O=>O._pc=this),A}),g(N,"track",A=>(A.receiver._pc=A.srcElement,A)),N.RTCRtpReceiver.prototype.getStats=function(){return this._pc.getStats(this.track)}}function we(N){N.RTCPeerConnection&&!("removeStream"in N.RTCPeerConnection.prototype)&&(N.RTCPeerConnection.prototype.removeStream=function(S){T("removeStream","removeTrack"),this.getSenders().forEach(A=>{A.track&&S.getTracks().includes(A.track)&&this.removeTrack(A)})})}function Ce(N){N.DataChannel&&!N.RTCDataChannel&&(N.RTCDataChannel=N.DataChannel)}function ke(N){if(typeof N!="object"||!N.RTCPeerConnection)return;const S=N.RTCPeerConnection.prototype.addTransceiver;S&&(N.RTCPeerConnection.prototype.addTransceiver=function(){this.setParametersPromises=[];let A=arguments[1]&&arguments[1].sendEncodings;A===void 0&&(A=[]),A=[...A];const O=A.length>0;O&&A.forEach(B=>{if("rid"in B&&!/^[a-z0-9]{0,16}$/i.test(B.rid))throw new TypeError("Invalid RID value provided.");if("scaleResolutionDownBy"in B&&!(parseFloat(B.scaleResolutionDownBy)>=1))throw new RangeError("scale_resolution_down_by must be >= 1.0");if("maxFramerate"in B&&!(parseFloat(B.maxFramerate)>=0))throw new RangeError("max_framerate must be >= 0.0")});const L=S.apply(this,arguments);if(O){const{sender:B}=L,H=B.getParameters();(!("encodings"in H)||H.encodings.length===1&&Object.keys(H.encodings[0]).length===0)&&(H.encodings=A,B.sendEncodings=A,this.setParametersPromises.push(B.setParameters(H).then(()=>{delete B.sendEncodings}).catch(()=>{delete B.sendEncodings})))}return L})}function St(N){if(typeof N!="object"||!N.RTCRtpSender)return;const S=N.RTCRtpSender.prototype.getParameters;S&&(N.RTCRtpSender.prototype.getParameters=function(){const A=S.apply(this,arguments);return"encodings"in A||(A.encodings=[].concat(this.sendEncodings||[{}])),A})}function Mt(N){if(typeof N!="object"||!N.RTCPeerConnection)return;const S=N.RTCPeerConnection.prototype.createOffer;N.RTCPeerConnection.prototype.createOffer=function(){return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then(()=>S.apply(this,arguments)).finally(()=>{this.setParametersPromises=[]}):S.apply(this,arguments)}}function Ee(N){if(typeof N!="object"||!N.RTCPeerConnection)return;const S=N.RTCPeerConnection.prototype.createAnswer;N.RTCPeerConnection.prototype.createAnswer=function(){return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then(()=>S.apply(this,arguments)).finally(()=>{this.setParametersPromises=[]}):S.apply(this,arguments)}}function _e(N){if(typeof N=="object"&&N.RTCPeerConnection){if("getLocalStreams"in N.RTCPeerConnection.prototype||(N.RTCPeerConnection.prototype.getLocalStreams=function(){return this._localStreams||(this._localStreams=[]),this._localStreams}),!("addStream"in N.RTCPeerConnection.prototype)){const S=N.RTCPeerConnection.prototype.addTrack;N.RTCPeerConnection.prototype.addStream=function(A){this._localStreams||(this._localStreams=[]),this._localStreams.includes(A)||this._localStreams.push(A),A.getAudioTracks().forEach(O=>S.call(this,O,A)),A.getVideoTracks().forEach(O=>S.call(this,O,A))},N.RTCPeerConnection.prototype.addTrack=function(A,...O){return O&&O.forEach(L=>{this._localStreams?this._localStreams.includes(L)||this._localStreams.push(L):this._localStreams=[L]}),S.apply(this,arguments)}}"removeStream"in N.RTCPeerConnection.prototype||(N.RTCPeerConnection.prototype.removeStream=function(S){this._localStreams||(this._localStreams=[]);const A=this._localStreams.indexOf(S);if(A===-1)return;this._localStreams.splice(A,1);const O=S.getTracks();this.getSenders().forEach(L=>{O.includes(L.track)&&this.removeTrack(L)})})}}function tt(N){if(typeof N=="object"&&N.RTCPeerConnection&&("getRemoteStreams"in N.RTCPeerConnection.prototype||(N.RTCPeerConnection.prototype.getRemoteStreams=function(){return this._remoteStreams?this._remoteStreams:[]}),!("onaddstream"in N.RTCPeerConnection.prototype))){Object.defineProperty(N.RTCPeerConnection.prototype,"onaddstream",{get(){return this._onaddstream},set(A){this._onaddstream&&(this.removeEventListener("addstream",this._onaddstream),this.removeEventListener("track",this._onaddstreampoly)),this.addEventListener("addstream",this._onaddstream=A),this.addEventListener("track",this._onaddstreampoly=O=>{O.streams.forEach(L=>{if(this._remoteStreams||(this._remoteStreams=[]),this._remoteStreams.includes(L))return;this._remoteStreams.push(L);const B=new Event("addstream");B.stream=L,this.dispatchEvent(B)})})}});const S=N.RTCPeerConnection.prototype.setRemoteDescription;N.RTCPeerConnection.prototype.setRemoteDescription=function(){const A=this;return this._onaddstreampoly||this.addEventListener("track",this._onaddstreampoly=function(O){O.streams.forEach(L=>{if(A._remoteStreams||(A._remoteStreams=[]),A._remoteStreams.indexOf(L)>=0)return;A._remoteStreams.push(L);const B=new Event("addstream");B.stream=L,A.dispatchEvent(B)})}),S.apply(A,arguments)}}}function de(N){if(typeof N!="object"||!N.RTCPeerConnection)return;const S=N.RTCPeerConnection.prototype,A=S.createOffer,O=S.createAnswer,L=S.setLocalDescription,B=S.setRemoteDescription,H=S.addIceCandidate;S.createOffer=function(re,K){const ae=arguments.length>=2?arguments[2]:arguments[0],he=A.apply(this,[ae]);return K?(he.then(re,K),Promise.resolve()):he},S.createAnswer=function(re,K){const ae=arguments.length>=2?arguments[2]:arguments[0],he=O.apply(this,[ae]);return K?(he.then(re,K),Promise.resolve()):he};let te=function(re,K,ae){const he=L.apply(this,[re]);return ae?(he.then(K,ae),Promise.resolve()):he};S.setLocalDescription=te,te=function(re,K,ae){const he=B.apply(this,[re]);return ae?(he.then(K,ae),Promise.resolve()):he},S.setRemoteDescription=te,te=function(re,K,ae){const he=H.apply(this,[re]);return ae?(he.then(K,ae),Promise.resolve()):he},S.addIceCandidate=te}function Be(N){const S=N&&N.navigator;if(S.mediaDevices&&S.mediaDevices.getUserMedia){const A=S.mediaDevices,O=A.getUserMedia.bind(A);S.mediaDevices.getUserMedia=L=>O(Ie(L))}!S.getUserMedia&&S.mediaDevices&&S.mediaDevices.getUserMedia&&(S.getUserMedia=(function(A,O,L){S.mediaDevices.getUserMedia(A).then(O,L)}).bind(S))}function Ie(N){return N&&N.video!==void 0?Object.assign({},N,{video:M(N.video)}):N}function rt(N){if(!N.RTCPeerConnection)return;const S=N.RTCPeerConnection;N.RTCPeerConnection=function(A,O){if(A&&A.iceServers){const L=[];for(let B=0;B<A.iceServers.length;B++){let H=A.iceServers[B];H.urls===void 0&&H.url?(T("RTCIceServer.url","RTCIceServer.urls"),H=JSON.parse(JSON.stringify(H)),H.urls=H.url,delete H.url,L.push(H)):L.push(A.iceServers[B])}A.iceServers=L}return new S(A,O)},N.RTCPeerConnection.prototype=S.prototype,"generateCertificate"in S&&Object.defineProperty(N.RTCPeerConnection,"generateCertificate",{get:()=>S.generateCertificate})}function ft(N){typeof N=="object"&&N.RTCTrackEvent&&"receiver"in N.RTCTrackEvent.prototype&&!("transceiver"in N.RTCTrackEvent.prototype)&&Object.defineProperty(N.RTCTrackEvent.prototype,"transceiver",{get(){return{receiver:this.receiver}}})}function gt(N){const S=N.RTCPeerConnection.prototype.createOffer;N.RTCPeerConnection.prototype.createOffer=function(A){if(A){A.offerToReceiveAudio!==void 0&&(A.offerToReceiveAudio=!!A.offerToReceiveAudio);const O=this.getTransceivers().find(B=>B.receiver.track.kind==="audio");A.offerToReceiveAudio===!1&&O?O.direction==="sendrecv"?O.setDirection?O.setDirection("sendonly"):O.direction="sendonly":O.direction==="recvonly"&&(O.setDirection?O.setDirection("inactive"):O.direction="inactive"):A.offerToReceiveAudio!==!0||O||this.addTransceiver("audio",{direction:"recvonly"}),A.offerToReceiveVideo!==void 0&&(A.offerToReceiveVideo=!!A.offerToReceiveVideo);const L=this.getTransceivers().find(B=>B.receiver.track.kind==="video");A.offerToReceiveVideo===!1&&L?L.direction==="sendrecv"?L.setDirection?L.setDirection("sendonly"):L.direction="sendonly":L.direction==="recvonly"&&(L.setDirection?L.setDirection("inactive"):L.direction="inactive"):A.offerToReceiveVideo!==!0||L||this.addTransceiver("video",{direction:"recvonly"})}return S.apply(this,arguments)}}function bt(N){typeof N!="object"||N.AudioContext||(N.AudioContext=N.webkitAudioContext)}var be=r(7539),ue=r.n(be);function Xe(N){if(!N.RTCIceCandidate||N.RTCIceCandidate&&"foundation"in N.RTCIceCandidate.prototype)return;const S=N.RTCIceCandidate;N.RTCIceCandidate=function(A){if(typeof A=="object"&&A.candidate&&A.candidate.indexOf("a=")===0&&((A=JSON.parse(JSON.stringify(A))).candidate=A.candidate.substring(2)),A.candidate&&A.candidate.length){const O=new S(A),L=ue().parseCandidate(A.candidate);for(const B in L)B in O||Object.defineProperty(O,B,{value:L[B]});return O.toJSON=function(){return{candidate:O.candidate,sdpMid:O.sdpMid,sdpMLineIndex:O.sdpMLineIndex,usernameFragment:O.usernameFragment}},O}return new S(A)},N.RTCIceCandidate.prototype=S.prototype,g(N,"icecandidate",A=>(A.candidate&&Object.defineProperty(A,"candidate",{value:new N.RTCIceCandidate(A.candidate),writable:"false"}),A))}function it(N){!N.RTCIceCandidate||N.RTCIceCandidate&&"relayProtocol"in N.RTCIceCandidate.prototype||g(N,"icecandidate",S=>{if(S.candidate){const A=ue().parseCandidate(S.candidate.candidate);A.type==="relay"&&(S.candidate.relayProtocol={0:"tls",1:"tcp",2:"udp"}[A.priority>>24])}return S})}function $e(N,S){if(!N.RTCPeerConnection)return;"sctp"in N.RTCPeerConnection.prototype||Object.defineProperty(N.RTCPeerConnection.prototype,"sctp",{get(){return this._sctp===void 0?null:this._sctp}});const A=N.RTCPeerConnection.prototype.setRemoteDescription;N.RTCPeerConnection.prototype.setRemoteDescription=function(){if(this._sctp=null,S.browser==="chrome"&&S.version>=76){const{sdpSemantics:O}=this.getConfiguration();O==="plan-b"&&Object.defineProperty(this,"sctp",{get(){return this._sctp===void 0?null:this._sctp},enumerable:!0,configurable:!0})}if(function(O){if(!O||!O.sdp)return!1;const L=ue().splitSections(O.sdp);return L.shift(),L.some(B=>{const H=ue().parseMLine(B);return H&&H.kind==="application"&&H.protocol.indexOf("SCTP")!==-1})}(arguments[0])){const O=function(re){const K=re.sdp.match(/mozilla...THIS_IS_SDPARTA-(\d+)/);if(K===null||K.length<2)return-1;const ae=parseInt(K[1],10);return ae!=ae?-1:ae}(arguments[0]),L=function(re){let K=65536;return S.browser==="firefox"&&(K=S.version<57?re===-1?16384:2147483637:S.version<60?S.version===57?65535:65536:2147483637),K}(O),B=function(re,K){let ae=65536;S.browser==="firefox"&&S.version===57&&(ae=65535);const he=ue().matchPrefix(re.sdp,"a=max-message-size:");return he.length>0?ae=parseInt(he[0].substring(19),10):S.browser==="firefox"&&K!==-1&&(ae=2147483637),ae}(arguments[0],O);let H;H=L===0&&B===0?Number.POSITIVE_INFINITY:L===0||B===0?Math.max(L,B):Math.min(L,B);const te={};Object.defineProperty(te,"maxMessageSize",{get:()=>H}),this._sctp=te}return A.apply(this,arguments)}}function Ue(N){if(!N.RTCPeerConnection||!("createDataChannel"in N.RTCPeerConnection.prototype))return;function S(O,L){const B=O.send;O.send=function(){const H=arguments[0],te=H.length||H.size||H.byteLength;if(O.readyState==="open"&&L.sctp&&te>L.sctp.maxMessageSize)throw new TypeError("Message too large (can send a maximum of "+L.sctp.maxMessageSize+" bytes)");return B.apply(O,arguments)}}const A=N.RTCPeerConnection.prototype.createDataChannel;N.RTCPeerConnection.prototype.createDataChannel=function(){const O=A.apply(this,arguments);return S(O,this),O},g(N,"datachannel",O=>(S(O.channel,O.target),O))}function qt(N){if(!N.RTCPeerConnection||"connectionState"in N.RTCPeerConnection.prototype)return;const S=N.RTCPeerConnection.prototype;Object.defineProperty(S,"connectionState",{get(){return{completed:"connected",checking:"connecting"}[this.iceConnectionState]||this.iceConnectionState},enumerable:!0,configurable:!0}),Object.defineProperty(S,"onconnectionstatechange",{get(){return this._onconnectionstatechange||null},set(A){this._onconnectionstatechange&&(this.removeEventListener("connectionstatechange",this._onconnectionstatechange),delete this._onconnectionstatechange),A&&this.addEventListener("connectionstatechange",this._onconnectionstatechange=A)},enumerable:!0,configurable:!0}),["setLocalDescription","setRemoteDescription"].forEach(A=>{const O=S[A];S[A]=function(){return this._connectionstatechangepoly||(this._connectionstatechangepoly=L=>{const B=L.target;if(B._lastConnectionState!==B.connectionState){B._lastConnectionState=B.connectionState;const H=new Event("connectionstatechange",L);B.dispatchEvent(H)}return L},this.addEventListener("iceconnectionstatechange",this._connectionstatechangepoly)),O.apply(this,arguments)}})}function Ot(N,S){if(!N.RTCPeerConnection||S.browser==="chrome"&&S.version>=71||S.browser==="safari"&&S.version>=605)return;const A=N.RTCPeerConnection.prototype.setRemoteDescription;N.RTCPeerConnection.prototype.setRemoteDescription=function(O){if(O&&O.sdp&&O.sdp.indexOf(`
a=extmap-allow-mixed`)!==-1){const L=O.sdp.split(`
`).filter(B=>B.trim()!=="a=extmap-allow-mixed").join(`
`);N.RTCSessionDescription&&O instanceof N.RTCSessionDescription?arguments[0]=new N.RTCSessionDescription({type:O.type,sdp:L}):O.sdp=L}return A.apply(this,arguments)}}function Yt(N,S){if(!N.RTCPeerConnection||!N.RTCPeerConnection.prototype)return;const A=N.RTCPeerConnection.prototype.addIceCandidate;A&&A.length!==0&&(N.RTCPeerConnection.prototype.addIceCandidate=function(){return arguments[0]?(S.browser==="chrome"&&S.version<78||S.browser==="firefox"&&S.version<68||S.browser==="safari")&&arguments[0]&&arguments[0].candidate===""?Promise.resolve():A.apply(this,arguments):(arguments[1]&&arguments[1].apply(null),Promise.resolve())})}function ce(N,S){if(!N.RTCPeerConnection||!N.RTCPeerConnection.prototype)return;const A=N.RTCPeerConnection.prototype.setLocalDescription;A&&A.length!==0&&(N.RTCPeerConnection.prototype.setLocalDescription=function(){let O=arguments[0]||{};if(typeof O!="object"||O.type&&O.sdp)return A.apply(this,arguments);if(O={type:O.type,sdp:O.sdp},!O.type)switch(this.signalingState){case"stable":case"have-local-offer":case"have-remote-pranswer":O.type="offer";break;default:O.type="answer"}return O.sdp||O.type!=="offer"&&O.type!=="answer"?A.apply(this,[O]):(O.type==="offer"?this.createOffer:this.createAnswer).apply(this).then(L=>A.apply(this,[L]))})}(function({window:N}={},S={shimChrome:!0,shimFirefox:!0,shimSafari:!0}){const A=b,O=function(B){const H={browser:null,version:null};if(B===void 0||!B.navigator||!B.navigator.userAgent)return H.browser="Not a browser.",H;const{navigator:te}=B;if(te.mozGetUserMedia)H.browser="firefox",H.version=p(te.userAgent,/Firefox\/(\d+)\./,1);else if(te.webkitGetUserMedia||B.isSecureContext===!1&&B.webkitRTCPeerConnection)H.browser="chrome",H.version=p(te.userAgent,/Chrom(e|ium)\/(\d+)\./,2);else{if(!B.RTCPeerConnection||!te.userAgent.match(/AppleWebKit\/(\d+)\./))return H.browser="Not a supported browser.",H;H.browser="safari",H.version=p(te.userAgent,/AppleWebKit\/(\d+)\./,1),H.supportsUnifiedPlan=B.RTCRtpTransceiver&&"currentDirection"in B.RTCRtpTransceiver.prototype}return H}(N),L={browserDetails:O,commonShim:l,extractVersion:p,disableLog:y,disableWarnings:v,sdp:be};switch(O.browser){case"chrome":if(!a||!X||!S.shimChrome)return A("Chrome shim is not included in this adapter release."),L;if(O.version===null)return A("Chrome shim can not determine version, not shimming."),L;A("adapter.js shimming chrome."),L.browserShim=a,Yt(N,O),ce(N),P(N,O),G(N),X(N,O),$(N),J(N,O),q(N),Y(N),ie(N),ee(N,O),Xe(N),it(N),qt(N),$e(N,O),Ue(N),Ot(N,O);break;case"firefox":if(!o||!He||!S.shimFirefox)return A("Firefox shim is not included in this adapter release."),L;A("adapter.js shimming firefox."),L.browserShim=o,Yt(N,O),ce(N),oe(N,O),He(N,O),Re(N),we(N),Te(N),Le(N),Ce(N),ke(N),St(N),Mt(N),Ee(N),Xe(N),qt(N),$e(N,O),Ue(N);break;case"safari":if(!c||!S.shimSafari)return A("Safari shim is not included in this adapter release."),L;A("adapter.js shimming safari."),L.browserShim=c,Yt(N,O),ce(N),rt(N),gt(N),de(N),_e(N),tt(N),ft(N),Be(N),bt(N),Xe(N),it(N),$e(N,O),Ue(N),Ot(N,O);break;default:A("Unsupported browser!")}})({window:typeof window>"u"?void 0:window}),r(8520);const j=()=>typeof RTCPeerConnection=="function";var W,me;(function(N){N[N.TRACE=0]="TRACE",N[N.DEBUG=1]="DEBUG",N[N.INFO=2]="INFO",N[N.WARN=3]="WARN",N[N.ERROR=4]="ERROR",N[N.SILENT=5]="SILENT"})(W||(W={})),function(N){N.SPADE="SPADE",N.TIME="Time",N.WEBRTC="WebRTC",N.EMITTER="Emitter",N.MEDIA="Media",N.SUBSCRIPTION="StageSubscription",N.PUBLICATION="StagePublication",N.CONNECTION="StageConnection",N.SOCKET="StageSocket",N.BROADCAST_STAGE_CLIENT="BroadcastStageClient",N.STAGE="Stage",N.REMOTE_PARTICIPANT="RemoteParticipant",N.LOCAL_PARTICIPANT="LocalParticipant",N.CONFIGURATION="Configuration",N.REMOTE_PLAYBACK="RemotePlaybackController",N.REMOTE_STAGE_STREAM="RemoteStageStream"}(me||(me={}));const De=1007,Ve=12e4,mt=3e5;class xt extends Error{constructor({name:S,message:A,code:O,details:L,cause:B,params:H}){super(A),Error.captureStackTrace&&Error.captureStackTrace(this,xt),this.name=S||"BroadcastClientError",this.message=A,this.code=O,this.details=L,this.cause=B,this.params=H}}const Vn={name:"BroadcastError",code:1e3,message:"Unable to broadcast"},qe={name:"CameraError",code:2e3,message:"Camera could not be captured"},Vt={name:"InputError",code:3e3,message:"Input could not be attached"},ht={name:"AddDeviceError",code:4e3,message:"Device is missing"},Pt={name:"AddDeviceNameExistsError",code:4001,message:"Name is already registered"},hn={name:"AddDeviceCompositionMissingError",code:4002,message:"VideoComposition is missing"},an={name:"AddDeviceCompositionIndexMissingError",code:4003,message:`VideoComposition's "index" property is missing`},Ge={name:"AddDeviceNameMissingError",code:4004,message:"Name property is missing"},ot={name:"AddDeviceUnsupported",code:4005,message:"Unsupported device"},At={name:"AddDeviceConstraintsError",code:4006,message:"Constraints error"},Nt={name:"RemoveDeviceNotFoundError",code:5e3,message:"Device not found"},Yn={name:"RemoveImageNotFoundError",code:6e3,message:"Image not found"},sr={name:"UpdateVideoDeviceCompositionMissingError",code:7e3,message:"VideoComposition is missing"},Si={name:"UpdateVideoDeviceCompositionIndexMissingError",code:7001,message:`VideoComposition's "index" property is missing`},ai={name:"UpdateVideoDeviceCompositionNameMissingError",code:7002,message:"Video device with that name is not found"},En={name:"ExchangePositionDeviceNotFoundError",code:8e3,message:"Device with that name is not found"},sn={name:"FailedToAddImageError",code:9e3,message:"Failed to add image"},Ln={name:"PeerSetupError",code:1e4,message:"Unexpected return value from setup request"},Nn={name:"PeerConnectionError",code:10001,message:"Peer connection has failed."},di={name:"InvalidStreamKey",code:10003,message:"Invalid Stream Key."},hr={name:"BroadcastConfigurationError",code:11e3,message:"Error when configuring broadcast client"},ei={name:"StreamConfigurationError",code:12e3,message:"Error when configuring stream"},Fa={name:"IngestEndpointTypeError",code:13e3,message:"Ingest endpoint must be a string"},xu={name:"IngestEndpointUrlError",code:13001,message:"Ingest endpoint must be a valid https or rtmps URL"},fd={name:"LogLevelTypeError",code:14e3,message:"Log Level must be a valid integer between [0..5]"},Np={name:"LoggerTypeError",code:15e3,message:"Logger must be an object"},A0={name:"ClientInvalidError",code:16e3,message:"Client is no longer valid, possibly due to delete() invocation."},dd={name:"NetworkReconnectConfigurationError",code:17e3,message:"Error when configuring network reconnect"},pd={name:"NetworkReconnectConfigurationInvalidTimeoutError",code:17001,message:"Network reconnect timeout value must be a number between [10000, 300000]"},wu={name:"StreamKeyInvalidCharError",code:18e3,message:"Streamkey must contain only [A-Za-z0-9_-] characters"},ve={name:"StageTokenTypeError",code:19e3,message:"Stage token must be a string"},Ke={name:"StageWhipUrlOverrideError",code:19001,message:"Stage WHIP override URL must be a string starting with http"};var vt,_t,Qe,Ht,nn,mn,Sn,oi,ci,Cn=function(N,S,A,O){if(A==="a"&&!O)throw new TypeError("Private accessor was defined without a getter");if(typeof S=="function"?N!==S||!O:!S.has(N))throw new TypeError("Cannot read private member from an object whose class did not declare it");return A==="m"?O:A==="a"?O.call(N):O?O.value:S.get(N)},gi=function(N,S,A,O,L){if(typeof S=="function"?N!==S||!L:!S.has(N))throw new TypeError("Cannot write private member to an object whose class did not declare it");return S.set(N,A),A};const ar=1920,Os=1080,bs=W.ERROR,Ki={maxResolution:{width:852,height:480},maxFramerate:30,maxBitrate:1500},Xn={maxResolution:{width:480,height:852},maxFramerate:30,maxBitrate:1500},Ti={maxResolution:{width:1920,height:1080},maxFramerate:30,maxBitrate:3500},Bn={maxResolution:{width:1080,height:1920},maxFramerate:30,maxBitrate:3500},qo={maxResolution:{width:1920,height:1080},maxFramerate:30,maxBitrate:8500},$l={maxResolution:{width:1080,height:1920},maxFramerate:30,maxBitrate:8500},no={reconnect:!1,timeout:Ve};function mh(N){var S,A;if(typeof N!="string"&&N!==void 0)throw new xt(Fa);if(N){if(N.startsWith("https"))return N;{const O=/(?<protocol>(rtmps|https):\/\/)?(?<id>.+)\.(?<environment>(?=\S*['-])([a-zA-Z'-]+))\.live-video\.net.*/.exec(N);if(((S=O==null?void 0:O.groups)===null||S===void 0?void 0:S.protocol)==="rtmps"&&console.warn("rtmps server url detected; please pass in the ingest endpoint (no rtmps:// protocol) instead"),(A=O==null?void 0:O.groups)===null||A===void 0?void 0:A.id)return`https://${O.groups.id}.webrtc.live-video.net:4443`;throw new xt(xu)}}return""}class ls{constructor(S,A,O=Ki,L,B=no){this.LOG_LEVEL=W,this.BASIC_LANDSCAPE=Ki,this.BASIC_PORTRAIT=Xn,this.BASIC_FULL_HD_LANDSCAPE=Ti,this.BASIC_FULL_HD_PORTRAIT=Bn,this.STANDARD_LANDSCAPE=qo,this.STANDARD_PORTRAIT=$l,vt.set(this,void 0),_t.set(this,void 0),Qe.set(this,Ki),Ht.set(this,void 0),nn.set(this,no),mn.set(this,H=>{if(!H)throw new xt(Object.assign(Object.assign({},ei),{details:"missing stream configuration"}));if(!(H.maxBitrate<=8500&&H.maxBitrate>=200))throw new xt(Object.assign(Object.assign({},ei),{details:"maxBitrate must be between 200 and 8500"}));if(!(H.maxFramerate<=60&&H.maxFramerate>=10))throw new xt(Object.assign(Object.assign({},ei),{details:"maxFramerate must be between 10 and 60"}));const te=H.maxResolution.width,re=H.maxResolution.height;if(te>ar||re>ar||te<160||re<160||te===ar&&re>Os||re===ar&&te>Os)throw new xt(Object.assign(Object.assign({},ei),{details:"maxResolution values must be between 1080x1920 or 1920x1080"}))}),Sn.set(this,H=>{if(!H)return;const te=Number(H),re=Number.isInteger(te),K=te>=W.TRACE,ae=te<=W.SILENT;if(!re||!K||!ae)throw new xt(fd)}),oi.set(this,H=>{if(H&&typeof H!="object")throw new xt(Np)}),ci.set(this,H=>{if(!H)return;if(typeof H!="object"||typeof H.reconnect!="boolean")throw new xt(dd);const{timeout:te}=H;if(te!==void 0&&(Number.isNaN(te)||typeof te!="number"||te<1e4||te>mt))throw new xt(pd)}),Cn(this,oi,"f").call(this,L),Cn(this,Sn,"f").call(this,A),Cn(this,mn,"f").call(this,O),gi(this,vt,S),gi(this,_t,A),gi(this,Qe,O),gi(this,Ht,L),gi(this,nn,B)}get ingestEndpoint(){return Cn(this,vt,"f")}set ingestEndpoint(S){gi(this,vt,mh(S))}get streamConfig(){return Cn(this,Qe,"f")}set streamConfig(S){Cn(this,mn,"f").call(this,S),gi(this,Qe,S)}get logLevel(){return Cn(this,_t,"f")}set logLevel(S){Cn(this,Sn,"f").call(this,S),gi(this,_t,S)}get logger(){return Cn(this,Ht,"f")}set logger(S){Cn(this,oi,"f").call(this,S),gi(this,Ht,S)}get networkReconnectConfig(){return Cn(this,nn,"f")}set networkReconnectConfig(S){Cn(this,ci,"f").call(this,S),gi(this,nn,S)}}vt=new WeakMap,_t=new WeakMap,Qe=new WeakMap,Ht=new WeakMap,nn=new WeakMap,mn=new WeakMap,Sn=new WeakMap,oi=new WeakMap,ci=new WeakMap;var bn,io=r(6729),Vs=r(1206);(function(N){N.PUBLISHED_VIDEO_STATS="ivs_broadcast_webrtc_published_video_stats",N.PUBLISHED_VIDEO_STATS_WINDOW="ivs_broadcast_webrtc_published_video_stats_window",N.PUBLISHED_AUDIO_STATS="ivs_broadcast_webrtc_published_audio_stats",N.PUBLISHED_AUDIO_STATS_WINDOW="ivs_broadcast_webrtc_published_audio_stats_window",N.SUBSCRIBED_VIDEO_STATS="ivs_broadcast_webrtc_subscribed_video_stats",N.SUBSCRIBED_VIDEO_STATS_WINDOW="ivs_broadcast_webrtc_sbcrbd_video_stats_window",N.SUBSCRIBED_AUDIO_STATS="ivs_broadcast_webrtc_subscribed_audio_stats",N.SUBSCRIBED_AUDIO_STATS_WINDOW="ivs_broadcast_webrtc_sbcrbd_audio_stats_window",N.PUBLISH="ivs_broadcast_multihost_publish",N.UNPUBLISH="ivs_broadcast_multihost_unpublish",N.SUBSCRIBE="ivs_broadcast_multihost_subscribe",N.UNSUBSCRIBE="ivs_broadcast_multihost_unsubscribe",N.PUBLISH_STARTED="ivs_broadcast_multihost_publish_started",N.PUBLISH_FAILED="ivs_broadcast_multihost_publish_failed",N.PUBLISH_ENDED="ivs_broadcast_multihost_publish_ended",N.STATE_UPDATED="ivs_broadcast_multihost_event_state_updated",N.SUBSCRIBE_STARTED="ivs_broadcast_multihost_subscribe_started",N.SUBSCRIBE_FAILED="ivs_broadcast_multihost_subscribe_failed",N.SUBSCRIBE_ENDED="ivs_broadcast_multihost_subscribe_ended",N.FIRST_FRAME="ivs_broadcast_multihost_first_frame",N.JOIN="ivs_broadcast_multihost_join",N.JOIN_ATTEMPT="ivs_broadcast_multihost_event_connect_attempt",N.JOIN_ATTEMPT_FAILED="ivs_broadcast_multihost_event_connect_failed",N.JOIN_ENDED="ivs_broadcast_multihost_join_ended",N.LEAVE="ivs_broadcast_multihost_leave",N.REASSIGNMENT_REQUEST="ivs_broadcast_multihost_reassignment_request",N.SERVER_REQUEST="ivs_broadcast_multihost_server_request",N.TRACE="ivs_broadcast_stage_trace",N.ERROR="ivs_broadcast_error",N.MINUTE="ivs_broadcast_multihost_minute",N.CONNECTION_STATE="ivs_broadcast_webrtc_connection_state",N.ICE_GATHERING_STATE="ivs_broadcast_webrtc_gathering_state",N.EDP_CONNECTED="ivs_broadcast_multihost_event_connected",N.EDP_DISCONNECTED="ivs_broadcast_multihost_event_disconnected",N.EDP_PONG="ivs_broadcast_multihost_edp_rtt",N.SIMULCAST_LAYER_INFO="ivs_broadcast_simulcast_layer_info",N.MULTIHOST_CONFIGURATION="ivs_broadcast_multihost_configuration",N.MULTIHOST_SUBSCRIBE_CONFIGURATION="ivs_broadcast_multihost_subscribe_configuration",N.PLAYBACK_LAYER_REQUEST="ivs_broadcast_multihost_playback_layer_request",N.PLAYBACK_LAYER_STATE="ivs_broadcast_multihost_playback_layer_state"})(bn||(bn={}));class qn{constructor(S,A,O,L){let B="unknown";if(A.stageARN&&A.stageARN.startsWith("arn:aws:ivs:")){const H=A.stageARN.split(":");H.length===6&&(B=H[4])}this.event=S,this.properties={client_time:new Date().toISOString(),customer_id:B,device_software:window.navigator.userAgent,multihost_id:A.stageARN,participant_id:A.participantID,participant_user_id:A.userID,platform:"web",sdk_version:"1.19.0",stage_arn:A.stageARN,trace_id:O.value},A.attrGsRole&&(this.properties.token_attribute_0=A.attrGsRole),A.attrGsSessionId&&(this.properties.token_attribute_1=A.attrGsSessionId),this.critical=L}}class xl extends qn{constructor(S){super(bn.ERROR,S.token,S.traceId,!0),Object.assign(this.properties,{code:S.code,tag:S.tag,description:S.message,remote_participant_id:S.remoteParticipantId,request_uuid:S.requestUUID,is_nominal:S.nominal,is_fatal:S.fatal,details:S.details,location:S.location})}}const la="IVS_CLIENT_OVERRIDES";function Ip(N){const S=window[la];return typeof S=="object"?S[N]:N==="logLevel"?window.STAGES_LOG_LEVEL:N==="appLabel"?window.IVS_APP_LABEL:N==="whipUrl"?window.IVS_DATA_PLANE_ENDPOINT:void 0}function mf(N){const S=Ip(N);if(typeof S=="string")return S}function gh(N){const S=Ip(N);if(typeof S=="boolean")return S}function R0(){const N=Ip("logLevel");if(typeof N=="number"&&Object.values(W).includes(N))return N}function q_(){return gh("disableXdp")}function M0(){return gh("enableXdpPublish")}function $o(){return gh("preferMainProfile")}function O0(){return gh("enableInitialLayerOnSdp")}var Wo=function(N,S,A,O){return new(A||(A=Promise))(function(L,B){function H(K){try{re(O.next(K))}catch(ae){B(ae)}}function te(K){try{re(O.throw(K))}catch(ae){B(ae)}}function re(K){var ae;K.done?L(K.value):(ae=K.value,ae instanceof A?ae:new A(function(he){he(ae)})).then(H,te)}re((O=O.apply(N,[])).next())})};const G1=4;class kE{constructor(S="https://broadcast.stats.live-video.net/"){this.spadeUrl=S}send(S,A=!1){return Wo(this,void 0,void 0,function*(){const O=Date.now();for(const te of S)te.properties.batch_time_millis=O;const L=this.b64EncodeUnicode(JSON.stringify(S)),B={"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"},H=`data=${L}`;A?navigator.sendBeacon(this.spadeUrl,H):Wo(this,void 0,void 0,function*(){try{yield function(te,re,K={},ae=""){return Wo(this,void 0,void 0,function*(){const he=new XMLHttpRequest;return he.open(te,re,!0),K&&Object.keys(K).forEach(pe=>{K.hasOwnProperty(pe)&&he.setRequestHeader(pe,K[pe])}),new Promise((pe,Ne)=>{he.onreadystatechange=()=>{he.readyState===G1&&(he.status>=200&&he.status<300?pe(he.responseText):Ne(new Error(`Spade ${te} ${re} responded ${he.status}
${he.responseText}`)))},he.send(ae)})})}("POST",this.spadeUrl,B,H)}catch{}})})}b64EncodeUnicode(S){return btoa(encodeURIComponent(S).replace(/%([0-9A-F]{2})/g,(A,O)=>String.fromCharCode(+`0x${O}`)))}}function Cu(N){if(!N)throw new Error("SpadeClient is not defined")}function Nm(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,N=>{const S=16*Math.random()|0;return(N==="x"?S:3&S|8).toString(16)})}class gf{constructor(){this.sharedProperties={},this.spadeClient={},this.queuedEvents=[],this.genSessionId();const S=function(){const O=mf("analyticsPostUrl");if(O!==void 0)return O}()||"https://broadcast.stats.live-video.net/",A=function(){const O=mf("appLabel");if(O!==void 0)return O.substring(0,64)}();this.spadeClient=new kE(S),this.initSharedProperties({appLabel:A})}start(){this.flushInterval||(this.flushInterval=window.setInterval(()=>{this.flushEvents()},1e3))}stop(S){let A=!1;clearInterval(this.flushInterval),this.flushInterval=void 0,S&&(this.queuedEvents=this.queuedEvents.filter(O=>O.critical),A=!0),this.flushEvents(A),this.genSessionId()}trackEvent(S,A=!1){let O=this.sharedProperties;A&&(O={global_session_id:gf.globalSessionId,session_id:this.sharedProperties.session_id,browser:this.sharedProperties.browser,browser_family:this.sharedProperties.browser_family,browser_version:this.sharedProperties.browser_version,os_name:this.sharedProperties.os_name,os_version:this.sharedProperties.os_version}),"data"in S?(S.data.properties=Object.assign({},O,S.data.properties),this.queuedEvents.push(S.data)):(S.properties=Object.assign({},O,S.properties),this.queuedEvents.push(S))}trackEventNoSharedProps(S){this.trackEvent(S,!0)}trackErrorAndThrow(S){throw this.trackError(S),S}trackError(S){this.trackEvent(new xl(S))}batchEvents(S){Cu(this.spadeClient);const A=S.map(O=>(O.data.properties=Object.assign({},this.sharedProperties,O.data.properties),O.data));this.spadeClient.send(A)}initSharedProperties({appLabel:S}){const A=Vs.getParser(navigator.userAgent),O=this.parseSemver(String(A.getBrowserVersion()));this.sharedProperties={browser:navigator.appVersion,browser_family:A.getBrowserName().toLowerCase(),browser_version:`${O.major}.${O.minor}`,customer_id:"ivs",host:window.location.hostname,os_name:A.getOSName(),os_version:String(A.getOSVersion()),platform:"web",global_session_id:gf.globalSessionId,session_id:this.sessionId,sdk_version:"1.19.0",user_agent:navigator.userAgent},S&&(this.sharedProperties.app_label=S)}genSessionId(){this.sessionId=Nm(),this.sharedProperties.session_id=this.sessionId}flushEvents(S=!1){Cu(this.spadeClient),this.queuedEvents.length>0&&this.spadeClient.send(this.queuedEvents,S),this.queuedEvents=[]}parseSemver(S){const A=/^(\d+)\.(\d+)\.(\d+)[+|-]?(.*)?$/.exec(S)||/^(\d+)\.(\d+)[+|-]?(.*)?$/.exec(S)||/^(\d+)$/.exec(S)||[];return{major:parseInt(A[1],10)||0,minor:parseInt(A[2],10)||0,patch:parseInt(A[3],10)||0}}getSessionId(){return this.sessionId}}gf.globalSessionId=Nm();class xs{constructor(S,A){this.transformProperties=(L,B)=>({sum:L.sum,median:L.median(),min:L.min,max:L.max,p90:L.percentile(.9),event_count:L.data.length,period:B});const O=this.transformProperties(S,A);this.data={event:Ns.CONGESTION_TIME,properties:O}}}class vh{constructor(S,A,O){this.transformProperties=(B,H,te)=>({duration:(B.getTime()-((H==null?void 0:H.getTime())||0))/1e3,ecn_negotiated:!1,ingest_session_id:te});const L=this.transformProperties(S,A,O);this.data={event:Ns.CONNECTION_ESTABLISHED,properties:L}}}class $_{constructor(S,A){this.transformProperties=(L,B)=>({sum:L.sum,median:L.median(),min:L.min,max:L.max,p90:L.percentile(.9),event_count:L.data.length,period:B});const O=this.transformProperties(S,A);this.data={event:Ns.CONNECTION_RTT,properties:O}}}class DE{constructor(S){this.transformProperties=O=>{var L;return{is_fatal:(L=O.isFatal)!==null&&L!==void 0&&L,value:O.value,code:O.code,description:O.description}};const A=this.transformProperties(S);this.data={event:Ns.ERROR,properties:A}}}class W_{constructor(S,A){this.transformProperties=(L,B)=>({type:L,input_device_id:B.deviceId,position:B.facingMode||"unknown"});const O=this.transformProperties(S,A);this.data={event:Ns.INPUT_DEVICE_ATTACHED,properties:O}}}class q1{constructor(S,A){this.transformProperties=(L,B)=>({type:L,input_device_id:B.deviceId,position:B.facingMode||"unknown"});const O=this.transformProperties(S,A);this.data={event:Ns.INPUT_DEVICE_DETACHED,properties:O}}}class PE{constructor(S,A){this.transformProperties=(L,B)=>({sum:L.sum,median:L.median(),min:L.min,max:L.max,p90:L.percentile(.9),event_count:L.data.length,period:B});const O=this.transformProperties(S,A);this.data={event:Ns.MEASURED_BITRATE,properties:O}}}class md{constructor(S,A){this.transformProperties=(L,B)=>({minutes_logged:Math.round((L.timestamp-B)/6e4)});const O=this.transformProperties(S,A);this.data={event:Ns.MINUTE_BROADCAST,properties:O}}}class gd{constructor(S,A){this.transformProperties=(L,B)=>({sum:L.sum,median:L.median(),min:L.min,max:L.max,p90:L.percentile(.9),event_count:L.data.length,period:B});const O=this.transformProperties(S,A);this.data={event:Ns.RECOMMENDED_BITRATE,properties:O}}}class Y_{constructor(S){this.transformProperties=O=>({codec:O.mimeType,bitrate:0,sample_rate:O.clockRate,channel_count:O.channels});const A=this.transformProperties(S);this.data={event:Ns.SESSION_AUDIO_ENCODER_CONFIGURED,properties:A}}}class LE{constructor(S){this.transformProperties=O=>({codec:"audio",bitrate:32e3,sample_rate:O.sampleRate,channel_count:O.channelCount});const A=this.transformProperties(S);this.data={event:Ns.SESSION_AUDIO_PROPERTIES,properties:A}}}class UE{constructor(S,A,O){this.transformProperties=(B,H,te)=>({codec:te.mimeType,codec_profile:H.profile,codec_level:H.level,rate_mode:"vbr",initial_bitrate:0,keyframe_interval:2,width:B.width,height:B.height,bframe_count:0,target_fps:B.frameRate});const L=this.transformProperties(S,A,O);this.data={event:Ns.SESSION_VIDEO_ENCODER_CONFIGURED,properties:L}}}class N0{constructor(S){this.transformProperties=O=>({codec:"video",initial_bitrate:32e3,min_bitrate:0,max_bitrate:0,keyframe_interval:2,width:O.width,height:O.height,auto_bitrate_enabled:!0,bframes_enabled:!1,target_fps:O.frameRate});const A=this.transformProperties(S);this.data={event:Ns.SESSION_VIDEO_PROPERTIES,properties:A}}}class X_{constructor(S,A){this.transformProperties=(L,B)=>({sum:L.sum,median:L.median(),min:L.min,max:L.max,p90:L.percentile(.9),event_count:L.data.length,period:B});const O=this.transformProperties(S,A);this.data={event:Ns.SOURCE_AUDIO_LATENCY,properties:O}}}class BE{constructor(S,A){this.transformProperties=(L,B)=>({sum:L.sum,median:L.median(),min:L.min,max:L.max,p90:L.percentile(.9),event_count:L.data.length,period:B});const O=this.transformProperties(S,A);this.data={event:Ns.SOURCE_VIDEO_LATENCY,properties:O}}}class _h{constructor(S,A){this.transformProperties=({protocol:L,hostname:B,port:H},te)=>({protocol:L,endpoint_host:B,endpoint_port:H,reason:te});const O=this.transformProperties(S,A);this.data={event:Ns.START_BROADCAST,properties:O}}}class Im{constructor(S){this.transformProperties=({protocol:O,hostname:L,port:B})=>({protocol:O,endpoint_host:L,endpoint_port:B});const A=this.transformProperties(S);this.data={event:Ns.STOP_BROADCAST,properties:A}}}class FE{constructor(S){this.transformProperties=O=>({bytes_sent:O.bytesSent,header_bytes_sent:O.headerBytesSent,nack_count:O.nackCount,packets_sent:O.packetsSent,retransmitted_bytes_sent:O.retransmittedBytesSent,retransmitted_packets_sent:O.retransmittedPacketsSent});const A=this.transformProperties(S);this.data={event:Ns.WEBRTC_AUDIO_STATS,properties:A}}}class pc{constructor(S){this.transformProperties=O=>({bytes_sent:O.bytesSent,fir_count:O.firCount,frames_encoded:O.framesEncoded,frames_sent:O.framesSent,header_bytes_sent:O.headerBytesSent,huge_frames_sent:O.hugeFramesSent,key_frames_encoded:O.keyFramesEncoded,nack_count:O.nackCount,packets_sent:O.packetsSent,pli_count:O.pliCount,quality_limitation_reason:O.qualityLimitationReason,quality_limitation_resolution_changes:O.qualityLimitationResolutionChanges,retransmitted_bytes_sent:O.retransmittedBytesSent,retransmitted_packets_sent:O.retransmittedPacketsSent,total_encode_time:O.totalEncodeTime,total_encoded_bytes_target:O.totalEncodedBytesTarget,total_packet_send_delay:O.totalPacketSendDelay});const A=this.transformProperties(S);this.data={event:Ns.WEBRTC_VIDEO_STATS,properties:A}}}var Ns,vf;(function(N){N.START_BROADCAST="ivs_broadcast_start_broadcast",N.STOP_BROADCAST="ivs_broadcast_stop_broadcast",N.MINUTE_BROADCAST="ivs_broadcast_minute_broadcast",N.WEBRTC_AUDIO_STATS="ivs_broadcast_webrtc_audio_stats",N.WEBRTC_VIDEO_STATS="ivs_broadcast_webrtc_video_stats",N.WEBRTC_AUDIO_STATS_WINDOW="ivs_broadcast_webrtc_audio_stats_window",N.WEBRTC_VIDEO_STATS_WINDOW="ivs_broadcast_webrtc_video_stats_window",N.CONNECTION_ESTABLISHED="ivs_broadcast_connection_established",N.SESSION_VIDEO_PROPERTIES="ivs_broadcast_session_video_properties",N.SESSION_AUDIO_PROPERTIES="ivs_broadcast_session_audio_properties",N.SESSION_VIDEO_ENCODER_CONFIGURED="ivs_broadcast_session_video_encoder_configured",N.SESSION_AUDIO_ENCODER_CONFIGURED="ivs_broadcast_session_audio_encoder_configured",N.SOURCE_AUDIO_LATENCY="ivs_broadcast_source_audio_latency",N.SOURCE_VIDEO_LATENCY="ivs_broadcast_source_video_latency",N.INPUT_DEVICE_ATTACHED="ivs_broadcast_input_device_attached",N.INPUT_DEVICE_DETACHED="ivs_broadcast_input_device_detached",N.CONGESTION_TIME="ivs_broadcast_congestion_time",N.BUFFER_DURATION="ivs_broadcast_buffer_duration",N.MEASURED_BITRATE="ivs_broadcast_measured_bitrate",N.RECOMMENDED_BITRATE="ivs_broadcast_recommended_bitrate",N.CONNECTION_RTT="ivs_broadcast_connection_rtt",N.ERROR="ivs_broadcast_error"})(Ns||(Ns={})),function(N){N.USER_INITIATED="user-initiated",N.NETWORK_DISCONNECT="network-disconnect"}(vf||(vf={}));const $1={[W.INFO]:"#528bff",[W.WARN]:"#ffb31a",[W.DEBUG]:"#00f593",[W.ERROR]:"#ff4f4d",[W.TRACE]:"",[W.SILENT]:"",[me.SPADE]:"#a970ff",[me.TIME]:"#53535f",[me.WEBRTC]:"#0e9bd8",[me.SUBSCRIPTION]:"#ffc400",[me.CONNECTION]:"#ff5edb",[me.SOCKET]:"#8585ff",[me.EMITTER]:"#adadb8",[me.LOCAL_PARTICIPANT]:"#1DD21D",[me.STAGE]:"#EC9806",[me.REMOTE_PARTICIPANT]:"#0680EC",details:"#808080"},ua=({label:N})=>`background: ${$1[N]||"#333333"}; color: white; padding: 3px; margin-left: 3px;`,W1=Object.entries(W),I0=(N,S,A)=>{const O=ua({label:N}),[L]=W1.find(([,Je])=>Je===Number(N))||[],B=`%c${L}`,H=ua({label:S}),te=`%c${S}`,re=ua({label:me.TIME}),K=`%c[${new Date().toISOString()}]`,ae=ua({label:"details"}),he=`%c[${A}]`,pe=[K,B,te],Ne=[re,O,H];return A&&(pe.push(he),Ne.push(ae)),[pe.join(""),...Ne]},Y1={debug(N){console.groupCollapsed(...I0(W.DEBUG,N.scope,N.label)),console.debug(N.msg,Object.assign(Object.assign({},N),{level:"debug"})),console.groupEnd()},info(N){console.groupCollapsed(...I0(W.INFO,N.scope,N.label)),console.info(N.msg,Object.assign(Object.assign({},N),{level:"info"})),console.groupEnd()},warn(N){console.groupCollapsed(...I0(W.WARN,N.scope,N.label)),console.warn(N.msg,Object.assign(Object.assign({},N),{level:"warn"})),console.groupEnd()},error(N){console.groupCollapsed(...I0(W.ERROR,N.scope,N.label)),console.error(N),console.groupEnd()}};var vd=function(N,S){var A={};for(var O in N)Object.prototype.hasOwnProperty.call(N,O)&&S.indexOf(O)<0&&(A[O]=N[O]);if(N!=null&&typeof Object.getOwnPropertySymbols=="function"){var L=0;for(O=Object.getOwnPropertySymbols(N);L<O.length;L++)S.indexOf(O[L])<0&&Object.prototype.propertyIsEnumerable.call(N,O[L])&&(A[O[L]]=N[O[L]])}return A};Object.entries(W);class km{constructor(S=bs,A=Y1){this.logLevel=S,this.loggerInstance=A}debug(S){var A,O;this.logLevel>W.DEBUG||(O=(A=this.loggerInstance).debug)===null||O===void 0||O.call(A,JSON.parse(JSON.stringify(Object.assign(Object.assign({},S),{level:"debug"}))))}info(S){var A,O;this.logLevel>W.INFO||(O=(A=this.loggerInstance).info)===null||O===void 0||O.call(A,JSON.parse(JSON.stringify(Object.assign(Object.assign({},S),{level:"info"}))))}warn(S){var A,O;this.logLevel>W.WARN||(O=(A=this.loggerInstance).warn)===null||O===void 0||O.call(A,JSON.parse(JSON.stringify(Object.assign(Object.assign({},S),{level:"warn"}))))}error(S){var A,O,{err:L}=S,B=vd(S,["err"]);this.logLevel>W.ERROR||(O=(A=this.loggerInstance).error)===null||O===void 0||O.call(A,Object.assign({err:L},B))}}class ro{constructor(S,A){this.logger=S,this.scope=A}debug(S){var A,O;(O=(A=this.logger).debug)===null||O===void 0||O.call(A,JSON.parse(JSON.stringify(Object.assign(Object.assign({},S),{scope:this.scope}))))}info(S){var A,O;(O=(A=this.logger).info)===null||O===void 0||O.call(A,JSON.parse(JSON.stringify(Object.assign(Object.assign({},S),{scope:this.scope}))))}warn(S){var A,O;(O=(A=this.logger).warn)===null||O===void 0||O.call(A,JSON.parse(JSON.stringify(Object.assign(Object.assign({},S),{scope:this.scope}))))}error(S){var A,O,{err:L}=S,B=vd(S,["err"]);(O=(A=this.logger).error)===null||O===void 0||O.call(A,Object.assign(Object.assign({err:L},B),{scope:this.scope}))}unwrap(){return this.logger}}class mc{constructor(){this.min=0,this.max=0,this.sum=0,this.data=[]}push(S){(this.min===0||S<this.min)&&(this.min=S),S>=this.max&&(this.max=S),this.data.push(S),this.sum+=S}median(){this.data.sort();const S=this.data.length>>1;return this.data.length%2==0?this.data[S-1]+this.data[S]>>1:this.data[S]}percentile(S){if(this.data.length===0)return 0;if(S<=0)return this.data[0];if(S>=1)return this.data[this.data.length-1];const A=(this.data.length-1)*S,O=Math.floor(A),L=O+1,B=A%1;return L>=this.data.length?this.data[O]:this.data[O]*(1-B)+this.data[L]*B}}var Dm=function(N,S,A,O){return new(A||(A=Promise))(function(L,B){function H(K){try{re(O.next(K))}catch(ae){B(ae)}}function te(K){try{re(O.throw(K))}catch(ae){B(ae)}}function re(K){var ae;K.done?L(K.value):(ae=K.value,ae instanceof A?ae:new A(function(he){he(ae)})).then(H,te)}re((O=O.apply(N,[])).next())})};class X1{constructor(S,A,O,L){this.peerClient=S,this.broadcastCanvasManager=A,this.analyticsTracker=L,this.logger=new ro(O,me.EMITTER),this.previousBytesSent=0,this.startTimestamp=0,this.initializeSamples()}start(){this.logger.info({msg:"start emitter"}),this.collectSamplesTimerId=window.setInterval(()=>{this.collectSamples()},1e3),this.trackSamplesTimerId=window.setInterval(()=>{this.trackSamples()},3e4),this.trackPeerConnectionStatsTimerId=window.setInterval(()=>{this.trackPeerConnectionStats()},6e4),this.trackSamples()}stop(){clearInterval(this.collectSamplesTimerId),clearInterval(this.trackSamplesTimerId),clearInterval(this.trackPeerConnectionStatsTimerId),this.collectSamplesTimerId=void 0,this.trackSamplesTimerId=void 0,this.trackPeerConnectionStatsTimerId=void 0}trackPeerConnectionStats(){return Dm(this,void 0,void 0,function*(){(yield this.peerClient.getReports()).forEach(S=>{if(S.type==="outbound-rtp")switch(S.kind){case"audio":this.analyticsTracker.trackEvent(new FE(S));break;case"video":{const A=new pc(S),O=new md(S,this.startTimestamp);this.analyticsTracker.batchEvents([A,O]);break}default:this.logger.warn({msg:"unknown report kind: ",reportKind:S.kind})}})})}collectSamples(){return Dm(this,void 0,void 0,function*(){let S=0;this.audioLatencySamples.push(this.broadcastCanvasManager.getAudioLatency()),this.videoLatencySamples.push(this.broadcastCanvasManager.getVideoLatency()),(yield this.peerClient.getReports()).forEach(O=>{switch(O.type){case"candidate-pair":O.nominated&&(this.rttSamples.push(O.currentRoundTripTime),this.recommendedBitrateSamples.push(O.availableOutgoingBitrate));break;case"outbound-rtp":S+=O.bytesSent||0,this.startTimestamp===0&&O.kind==="video"&&(this.startTimestamp=O.timestamp)}});const A=8*Math.round(S-this.previousBytesSent);this.previousBytesSent=S,this.measuredBitrateSamples.push(A)})}trackSamples(){const A=new X_(this.audioLatencySamples,30),O=new BE(this.videoLatencySamples,30),L=new xs(this.congestionTimeSamples,30),B=new PE(this.measuredBitrateSamples,30),H=new gd(this.recommendedBitrateSamples,30),te=new $_(this.rttSamples,30);this.analyticsTracker.batchEvents([A,O,L,B,H,te]),this.initializeSamples()}initializeSamples(){this.audioLatencySamples=new mc,this.videoLatencySamples=new mc,this.congestionTimeSamples=new mc,this.measuredBitrateSamples=new mc,this.recommendedBitrateSamples=new mc,this.rttSamples=new mc}}const wa={CONNECTION_STATE_CHANGE:"connectionStateChange",ERROR:"clientError",ACTIVE_STATE_CHANGE:"activeStateChange"},Zs="connectionStateChange",k0="sdpNegotiated",_f="clientError",kp="seiMessageReceived",dt="transformError";var at;(function(N){N.CLOSED="closed",N.COMPLETED="completed",N.CONNECTED="connected",N.CONNECTING="connecting",N.DISCONNECTED="disconnected",N.FAILED="failed",N.IDLE="idle",N.NEW="new",N.NONE="none"})(at||(at={}));const Ft=N=>{const S=B=>{var H;return!((H=B.deviceId)===null||H===void 0)&&H.startsWith("web-contents-media-stream")?"tab":void 0},A=B=>{var H;return!((H=B.deviceId)===null||H===void 0)&&H.startsWith("window")&&B.displaySurface==="window"?"window":void 0},O=B=>{var H;return!((H=B.deviceId)===null||H===void 0)&&H.startsWith("screen")&&B.displaySurface==="monitor"?"screen":void 0};return(S(L=N)||A(L)||O(L)?void 0:"camera")||O(N)||A(N)||S(N)||"unknown";var L};function dn(N,S){return N.find(A=>A.kind===S)}var Xt;(function(N){N.VIDEO="video",N.AUDIO="audio"})(Xt||(Xt={}));class ji{constructor(){this.mediaTracks=new Map([[Xt.VIDEO,void 0],[Xt.AUDIO,void 0]])}setTrack(S,A){this.mediaTracks.set(S,A)}getTrack(S){return this.mediaTracks.get(S)}}class ha{constructor(){this.levelAsymmetryAllowed=!1,this.packetisationMode=!1,this.profile="",this.level=0}extractVideoSdpFmtpLine(S){return S?(S.split("\r").join(";").split(`
`).join(";").split(" ").join(";").split(";").map(A=>A.trim()).filter(Boolean).forEach(A=>{const O=A.split("=");if(O.length===2)switch(O[0]){case"level-asymmetry-allowed":O[1]==="1"?this.levelAsymmetryAllowed=!0:this.levelAsymmetryAllowed=!1;break;case"packetization-mode":O[1]==="1"?this.packetisationMode=!0:this.packetisationMode=!1;break;case"profile-level-id":this.profile=this.getProfileFromId(O[1]),this.level=this.getLevelFromId(O[1])}}),{levelAsymmetryAllowed:this.levelAsymmetryAllowed,packetisationMode:this.packetisationMode,profile:this.profile,level:this.level}):{levelAsymmetryAllowed:this.levelAsymmetryAllowed,packetisationMode:this.packetisationMode,profile:this.profile,level:this.level}}getProfileFromId(S){const A=S.substr(0,2),O=S.substr(2,2);switch(A.substr(0,2)){case"42":return"baseline";case"4d":return"main";case"58":return"extended";case"64":return"high";case"6e":return O==="00"?"high 10":"high 10 intra";case"7a":return O==="00"?"high 42":"high 42 intra";case"f4":return O==="00"?"high 44":"high 44 intra";default:return"unknown"}}getLevelFromId(S){return parseInt(S.substr(4,2),16)}}function yh(N){return btoa(JSON.stringify(N))}var Zi,Wl=function(N,S,A,O){return new(A||(A=Promise))(function(L,B){function H(K){try{re(O.next(K))}catch(ae){B(ae)}}function te(K){try{re(O.throw(K))}catch(ae){B(ae)}}function re(K){var ae;K.done?L(K.value):(ae=K.value,ae instanceof A?ae:new A(function(he){he(ae)})).then(H,te)}re((O=O.apply(N,[])).next())})};(function(N){N.IDLE="idle",N.EXECUTING="executing",N.RECONNECTING="reconnecting"})(Zi||(Zi={}));class bh{constructor(S,A=12e4,O,L){this.state=Zi.IDLE,this.failureCallback=()=>{},this.peerClient=S,this.timeout=A,this.logger=O,this.emitter=L}onFailure(S){this.failureCallback=S}setStartConfig(S,A){this.ingestEndpoint=S,this.streamKey=A}execute(){const{id:S}=this;this.state===Zi.IDLE&&(this.state=Zi.EXECUTING,this.emitter.emit(wa.CONNECTION_STATE_CHANGE,at.CONNECTING),this.logger.info({msg:"Starting execution of reconnect strategy.",id:S}),this.startTimeoutTimer(this.timeout),this.executeStrategy())}startTimeoutTimer(S){this.timeoutTimerId=window.setTimeout(()=>{this.state!==Zi.IDLE&&(this.logger.info({msg:"Reconnect strategy timed out."}),this.stop(),this.emitter.emit(wa.CONNECTION_STATE_CHANGE,at.FAILED),this.failureCallback())},S)}stop(){this.state=Zi.IDLE,clearTimeout(this.timeoutTimerId),this.stopStrategy()}reconnect(){return Wl(this,void 0,void 0,function*(){if(this.ingestEndpoint&&this.streamKey){const S=this.peerClient.getConnectionState();try{this.logger.info({msg:"Attempting reconnect."}),S===at.CONNECTED?this.logger.info({msg:"Already connected! Stopping reconnect strategy."}):(yield this.peerClient.start(this.ingestEndpoint,this.streamKey),this.logger.info({msg:"Reconnect succeeded!"})),this.stop()}catch(A){throw this.logger.error({err:A}),A}}})}isActive(){return this.state!==Zi.IDLE}}class Kc extends bh{constructor(){super(...arguments),this.id="ExponentialBackoffStrategy"}executeStrategy(){let S=5e3;const A=()=>Wl(this,void 0,void 0,function*(){if(this.state===Zi.EXECUTING)try{this.state=Zi.RECONNECTING,yield this.reconnect()}catch{this.logger.warn({msg:"Attempted reconnect failed. Trying again in: ",nextRetry:S}),this.state=Zi.EXECUTING,this.currentTimeoutId=window.setTimeout(A,S),S*=2}});this.currentTimeoutId=window.setTimeout(A,0)}stopStrategy(){clearTimeout(this.currentTimeoutId)}}class Pm extends bh{constructor(){super(...arguments),this.id="NetworkApiStrategy",this.onConnectionChange=()=>Wl(this,void 0,void 0,function*(){if(navigator.onLine&&this.state===Zi.EXECUTING){this.state=Zi.RECONNECTING;try{yield this.reconnect()}catch{this.logger.warn({msg:"Attempted reconnect failed."}),this.state=Zi.EXECUTING}}})}executeStrategy(){navigator.connection.addEventListener("change",this.onConnectionChange),this.onConnectionChange()}stopStrategy(){navigator.connection.removeEventListener("change",this.onConnectionChange)}}class D0{static create(S,A=no,O,L){const{reconnect:B,timeout:H}=A;if(B){const te=Vs.getParser(navigator.userAgent).getBrowserName().toLowerCase();return["edge","chrome"].includes(te)&&navigator.connection?new Pm(S,H,O,L):new Kc(S,H,O,L)}}}var Au,Zc=function(N,S,A,O){return new(A||(A=Promise))(function(L,B){function H(K){try{re(O.next(K))}catch(ae){B(ae)}}function te(K){try{re(O.throw(K))}catch(ae){B(ae)}}function re(K){var ae;K.done?L(K.value):(ae=K.value,ae instanceof A?ae:new A(function(he){he(ae)})).then(H,te)}re((O=O.apply(N,[])).next())})},za=function(N,S,A,O){if(A==="a"&&!O)throw new TypeError("Private accessor was defined without a getter");if(typeof S=="function"?N!==S||!O:!S.has(N))throw new TypeError("Cannot read private member from an object whose class did not declare it");return A==="m"?O:A==="a"?O.call(N):O?O.value:S.get(N)};const Rr=N=>!!N;function P0(N){if(!N)throw new Error("PeerConnection is not defined")}const K_={bundlePolicy:"max-bundle",rtcpMuxPolicy:"require",enableDtlsSrtp:{exact:!0},enableRtpDataChannels:{exact:!1},optional:[{googHighStartBitrate:{exact:0}},{googPayloadPadding:{exact:!0}},{googScreencastMinBitrate:{exact:100}},{googCpuOveruseDetection:{exact:!0}},{googCpuOveruseEncodeUsage:{exact:!0}},{googCpuUnderuseThreshold:{exact:55}},{googCpuOveruseThreshold:{exact:85}},{enableDscp:{exact:!0}}]};class _d{constructor(S,A,O,L,B){this.config=S,this.emitter=A,this.mediaStreamManager=O,this.analyticsTracker=B,this.establishConnection=(H,te)=>Zc(this,void 0,void 0,function*(){var re,K,ae;P0(this.peerConnection);try{const he=yield this.peerConnection.createOffer({offerToReceiveAudio:!1,offerToReceiveVideo:!1});yield this.handleLocalDescription(he),yield this.sendSetupRequest(H,te,he)}catch(he){if(he instanceof Error){(re=(ae=he).code)!==null&&re!==void 0||(ae.code=Ln.code);const pe=new xt(Object.assign(Object.assign({},Ln),{name:he.name,message:he.message,code:he==null?void 0:he.code,cause:he}));throw!((K=this.reconnectStrategy)===null||K===void 0)&&K.isActive()||this.handleError(he.code,he.message),this.stop(),pe}}}),this.getSessionId=()=>this.ingestSessionId,this.getConnectionState=()=>{var H;if(!this.peerConnection)return at.NONE;const te=(H=this.reconnectStrategy)===null||H===void 0?void 0:H.isActive(),re=this.peerConnection.connectionState||this.peerConnection.iceConnectionState;switch(re){case"new":return at.NEW;case"closed":return at.CLOSED;case"disconnected":return te?at.CONNECTING:at.DISCONNECTED;case"failed":return te?at.CONNECTING:at.FAILED;case"idle":return at.IDLE;case"checking":case"connecting":return at.CONNECTING;case"completed":case"connected":return at.CONNECTED;default:return this.logger.warn({msg:"Unhandled connection state:",rawState:re}),at.IDLE}},this.onConnectionStateChange=()=>{var H;const te=this.getConnectionState();switch(te){case at.CONNECTED:{this.emitter.emit(wa.CONNECTION_STATE_CHANGE,te);const re=new Date;this.analyticsTracker.trackEvent(new vh(re,this.connectionStartDate,this.ingestSessionId));const K=this.mediaStreamManager.getTrack(Xt.AUDIO),ae=this.mediaStreamManager.getTrack(Xt.VIDEO);if(ae){const he=ae.getSettings();this.analyticsTracker.trackEvent(new N0(he))}if(K){const he=K.getSettings();this.analyticsTracker.trackEvent(new LE(he))}(((H=this.peerConnection)===null||H===void 0?void 0:H.getSenders())||[]).forEach(he=>{var pe;(((pe=he.getParameters())===null||pe===void 0?void 0:pe.codecs)||[]).forEach(Ne=>{var Je;switch((Je=he.track)===null||Je===void 0?void 0:Je.kind){case"video":{if(!ae)break;const Ye=new ha().extractVideoSdpFmtpLine(Ne.sdpFmtpLine),Oe=ae.getSettings();this.analyticsTracker.trackEvent(new UE(Oe,Ye,Ne));break}case"audio":if(!K)break;this.analyticsTracker.trackEvent(new Y_(Ne))}})});break}case at.CONNECTING:this.emitter.emit(wa.CONNECTION_STATE_CHANGE,te),this.connectionStartDate=new Date,this.disconnectionStartDate=void 0;break;case at.FAILED:this.reconnectStrategy?this.reconnectStrategy.execute():(this.emitter.emit(wa.CONNECTION_STATE_CHANGE,te),this.handleTerminalConnectionFailure());break;case at.DISCONNECTED:this.emitter.emit(wa.CONNECTION_STATE_CHANGE,te),this.disconnectionStartDate=new Date;break;default:this.emitter.emit(wa.CONNECTION_STATE_CHANGE,te)}},this.handleLocalDescription=H=>Zc(this,void 0,void 0,function*(){var te;return(te=this.peerConnection)===null||te===void 0?void 0:te.setLocalDescription(H)}),Au.set(this,H=>{if(typeof H!="string")throw new xt(Fa);try{new URL(H)}catch{throw new xt(xu)}}),this.logger=new ro(L,me.WEBRTC),this.createReconnectStrategy(S)}start(S,A){var O;return Zc(this,void 0,void 0,function*(){za(this,Au,"f").call(this,S);const L=[this.mediaStreamManager.getTrack(Xt.VIDEO),this.mediaStreamManager.getTrack(Xt.AUDIO)].filter(Rr);if(this.createPeerConnection(),this.addTracks({tracks:L}),this.reconnectStrategy&&this.reconnectStrategy.setStartConfig(S,A),yield this.establishConnection(S,A),!((O=this.reconnectStrategy)===null||O===void 0)&&O.isActive()){const B=new URL(S);this.analyticsTracker.trackEvent(new _h({protocol:"webrtc",hostname:B.hostname,port:B.port},vf.NETWORK_DISCONNECT))}})}stop(){var S,A,O,L;this.stateCheckInterval&&(clearInterval(this.stateCheckInterval),this.stateCheckInterval=void 0),this.stopStreamDataChannel&&this.stopStreamDataChannel.readyState==="open"&&this.stopStreamDataChannel.send(" "),[at.NEW,at.CONNECTING,at.CONNECTED].includes(this.getConnectionState())&&this.emitter.emit(wa.CONNECTION_STATE_CHANGE,at.CLOSED),(S=this.peerConnection)===null||S===void 0||S.close(),(A=this.peerConnection)===null||A===void 0||A.removeEventListener("connectionstatechange",this.onConnectionStateChange),(O=this.peerConnection)===null||O===void 0||O.removeEventListener("iceconnectionstatechange",this.onConnectionStateChange),this.ingestSessionId=void 0,(L=this.reconnectStrategy)===null||L===void 0||L.stop()}addTracks(S){var A;if(P0(this.peerConnection),!S)return;const O=this.peerConnection.getSenders().map(B=>{var H;return(H=B.track)===null||H===void 0?void 0:H.id}),L=S.tracks.filter(B=>!O.includes(B.id));for(const B of L)(A=this.peerConnection)===null||A===void 0||A.addTrack(B)}getReports(){var S;return Zc(this,void 0,void 0,function*(){try{const A=(yield(S=this.peerConnection)===null||S===void 0?void 0:S.getStats())||[],O=[];return A.forEach(L=>{O.push(L)}),O}catch{return[]}})}sendSetupRequest(S,A,O){var L;return Zc(this,void 0,void 0,function*(){const B=yield fetch(`${S}/v1/offer`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(Object.assign({offer:yh(O),streamKey:A},this.config.streamConfig))});if(!B.ok)throw function(te){let re=new xt(Object.assign({},Ln));return(te==null?void 0:te.code)===De&&(re=new xt(Object.assign({},di))),te!=null&&te.message&&(re.message=te.message),re}(yield B.json());const H=yield B.json();H!=null&&H.answer&&(yield(L=this.peerConnection)===null||L===void 0?void 0:L.setRemoteDescription(function(te){return JSON.parse(atob(te))}(H.answer)),this.ingestSessionId=H.ingestSessionId)})}handleTerminalConnectionFailure(){const S=new xt(Nn);this.handleError(S.code,S.message)}handleError(S,A){this.analyticsTracker.trackEvent(new DE({code:S,description:A,isFatal:!0})),this.emitter.emit(wa.ERROR,{code:S,message:A})}createPeerConnection(){var S;const A=this.getConnectionState(),O=A!==at.NONE,L=A!==at.CLOSED,B=(S=this.reconnectStrategy)===null||S===void 0?void 0:S.isActive();O&&L&&!B||(this.stateCheckInterval&&(clearInterval(this.stateCheckInterval),this.stateCheckInterval=void 0),this.stateCheckInterval=window.setInterval(()=>{const H=this.getConnectionState();if(this.reconnectStrategy&&H===at.DISCONNECTED&&this.disconnectionStartDate){const te=Date.now()-this.disconnectionStartDate.getTime();this.logger.info({msg:"Time since disconnected:",timeSinceDisconnect:te}),te>1e4&&(this.disconnectionStartDate=void 0,this.reconnectStrategy.execute())}else H===at.CLOSED&&(this.handleTerminalConnectionFailure(),clearInterval(this.stateCheckInterval),this.stateCheckInterval=void 0)},1e3),this.peerConnection=new RTCPeerConnection(K_),this.stopStreamDataChannel=this.peerConnection.createDataChannel("stopStream"),this.peerConnection.addEventListener("connectionstatechange",this.onConnectionStateChange),this.peerConnection.addEventListener("iceconnectionstatechange",this.onConnectionStateChange))}createReconnectStrategy(S){if(this.reconnectStrategy=D0.create(this,S.networkReconnectConfig,this.logger,this.emitter),this.reconnectStrategy){this.reconnectStrategy.onFailure(this.handleTerminalConnectionFailure.bind(this));const A=this.reconnectStrategy.id;this.logger.info({msg:"Using reconnect strategy:",strategyId:A})}}}Au=new WeakMap;var yd,Z_=r(2492);(function(N){N.CONFIG="config",N.UPDATE="update",N.START="start",N.STOP="stop"})(yd||(yd={}));var K1=r(477),Yo=r.n(K1);function yf(){return Yo()(`/*! For license information please see scheduler.worker.worker.js.LICENSE.txt */
(()=>{"use strict";var t;!function(t){t.CONFIG="config",t.UPDATE="update",t.START="start",t.STOP="stop"}(t||(t={}));const i=self;const s=new class Scheduler{constructor(){this.config={frameRate:60,isRunning:!1}}setConfig(t){this.config=Object.assign(Object.assign({},this.config),t),this.config.isRunning&&(this.stop(),this.start())}start(){this.config.isRunning||(this.intervalId=setInterval((()=>{i.postMessage({type:t.UPDATE})}),1e3/this.config.frameRate),this.config.isRunning=!0)}stop(){this.config.isRunning&&(clearInterval(this.intervalId),this.intervalId=void 0,this.config.isRunning=!1)}};i.addEventListener("message",(function(i){var n;if(null===(n=null==i?void 0:i.data)||void 0===n?void 0:n.type)switch(i.data.type){case t.CONFIG:s.setConfig(i.data.payload||{});break;case t.START:s.start();break;case t.STOP:s.stop()}}))})();`,"Worker",void 0,void 0)}var Eh=function(N,S,A,O){return new(A||(A=Promise))(function(L,B){function H(K){try{re(O.next(K))}catch(ae){B(ae)}}function te(K){try{re(O.throw(K))}catch(ae){B(ae)}}function re(K){var ae;K.done?L(K.value):(ae=K.value,ae instanceof A?ae:new A(function(he){he(ae)})).then(H,te)}re((O=O.apply(N,[])).next())})};class zE{constructor(S,A,O){this.config=S,this.mediaStreamManager=A,this.analyticsTracker=O,this.handleWorkerEvent=te=>{var re;((re=te.data)===null||re===void 0?void 0:re.type)===yd.UPDATE&&this.drawComposite()},this.mixer={video:[],audio:[]},this.schedulerWorker=new yf,this.running=!1,this.compositeEl=document.createElement("canvas"),this.compositeEl.height=this.config.streamConfig.maxResolution.height,this.compositeEl.width=this.config.streamConfig.maxResolution.width;const L=this.compositeEl.getContext("2d");if(L===null)throw new xt(Object.assign({},Vn));this.compositeContext=L,this.compositeStream=this.compositeEl.captureStream(typeof CanvasCaptureMediaStreamTrack!==void 0?0:30);const B=dn(this.compositeStream.getTracks(),Xt.VIDEO);this.audioContext=new AudioContext,this.unlockAudioContext(),this.audioDestination=this.audioContext.createMediaStreamDestination(),this.setupSilence();const H=dn(this.audioDestination.stream.getTracks(),Xt.AUDIO);B&&this.mediaStreamManager.setTrack(Xt.VIDEO,B),H&&this.mediaStreamManager.setTrack(Xt.AUDIO,H),this.schedulerWorker.addEventListener("message",this.handleWorkerEvent),this.schedulerWorker.postMessage({type:yd.CONFIG,payload:{frameRate:this.config.streamConfig.maxFramerate}}),this.previewElement=null,this.previewCtx=null,this.nextMix=new Date().getTime()}attachPreview(S){this.previewElement=S;const{width:A,height:O}=this.config.streamConfig.maxResolution;this.previewElement.width=A,this.previewElement.height=O,this.previewCtx=this.previewElement.getContext("2d")}detachPreview(){this.previewElement=null,this.previewCtx=null}setupSilence(){const S=this.audioContext.createConstantSource(),A=this.audioContext.createGain();A.gain.value=.001,S.connect(A),A.connect(this.audioDestination),S.start()}unlockAudioContext(){if(this.audioContext.state!=="suspended")return;const S=document.body,A=["touchstart","touchend","mousedown","keydown"],O=()=>{A.forEach(B=>{S.removeEventListener(B,L)})},L=()=>{this.audioContext.resume().then(O)};A.forEach(B=>{S.addEventListener(B,L,!1)})}getTracks(){return[this.mediaStreamManager.getTrack(Xt.VIDEO),this.mediaStreamManager.getTrack(Xt.AUDIO)]}getCanvasVideoTrack(){return this.mediaStreamManager.getTrack(Xt.VIDEO)}getAudioInputDevice(S){if(typeof S!="string")return;const A=this.mixer.audio.find(O=>{if(O.name===S)return O.source});return A==null?void 0:A.source}getVideoInputDevice(S){if(typeof S=="string")return this.mixer.video.find(A=>A.name===S)}getCanvasDimensions(){return{height:this.compositeEl.height,width:this.compositeEl.width}}addVideoInputDevice(S,A,O){var L;return Eh(this,void 0,void 0,function*(){if(typeof S!="object")throw new xt(Object.assign({},ht));if(!A||typeof A!="string")throw new xt(Object.assign({},Ge));if(this.mixer.video.some(pe=>pe.name===A))throw new xt(Object.assign({},Pt));if(!O)throw new xt(Object.assign({},hn));if(typeof O.index!="number")throw new xt(Object.assign({},an));const B=function(){const pe=document.createElement("video");return pe.autoplay=!0,pe.muted=!0,pe.setAttribute("playsinline",""),pe.setAttribute("webkit-playsinline",""),pe}(),H=S.getVideoTracks(),[te]=H;if(!H.length)throw new xt(Object.assign({},qe));const re=te.getConstraints(),K=Z_({},re,{frameRate:this.config.streamConfig.maxFramerate});try{yield te.applyConstraints(K)}catch(pe){let Ne="Unknown constraints error";pe instanceof Error&&(Ne=pe.message),this.analyticsTracker.trackEvent(new DE({description:`${At.message}: ${Ne}`,isFatal:!1,code:At.code}))}const ae=()=>Eh(this,void 0,void 0,function*(){let pe=0;for(;pe<5;)try{return void(yield B.play())}catch(Ne){if(!(Ne instanceof Error))throw new Error("unknown error trying to add video to broadcast");pe++,yield new Promise(Je=>setTimeout(Je,150))}throw new Error("Error playing video, tries exceeded")}),he=new MediaStream([te]);B.srcObject=he;try{yield ae();const pe={name:A,element:B,position:O,source:he,render:!0},Ne=((L=te.getSettings)===null||L===void 0?void 0:L.call(te))||{};this.analyticsTracker.trackEvent(new W_(Ft(Ne),Ne)),this.mixer.video.push(pe)}catch(pe){throw new xt(Object.assign(Object.assign({},qe),{cause:pe}))}})}addImageSource(S,A,O){var L;return Eh(this,void 0,void 0,function*(){if(!S)throw new xt(Object.assign({},ht));if(!A||typeof A!="string")throw new xt(Object.assign({},Ge));if(S.tagName==="image")throw new xt(Object.assign({},ot));if(this.mixer.video.some(H=>H.name===A))throw new xt(Object.assign({},Pt));if(!O)throw new xt(Object.assign({},hn));if(typeof O.index!="number")throw new xt(Object.assign({},an));if(S instanceof Image){const H=(L=S.src)===null||L===void 0?void 0:L.slice();try{const te=S.src?new URL(S.src):{};if(te.host&&te.hostname){const re=yield fetch(S.src).then(ae=>Eh(this,void 0,void 0,function*(){return ae.blob()})),K=yield new Promise(ae=>{const he=new FileReader;he.onload=()=>{ae(he.result)},he.readAsDataURL(re)});S.src=K}}catch{throw new xt(Object.assign(Object.assign({},sn),{params:{details:`Image URL: ${H}`}}))}}const B={name:A,element:S,position:O,render:!0};this.mixer.video.push(B)})}addAudioInputDevice(S,A){return Eh(this,void 0,void 0,function*(){if(typeof S!="object")throw new xt(Object.assign({},ht));if(!A||typeof A!="string")throw new xt(Object.assign({},Ge));if(this.mixer.audio.some(te=>te.name===A))throw new xt(Object.assign({},Pt));const O=S.getAudioTracks();if(!O.length)throw new xt(Object.assign({},Vt));const L=this.audioContext.createMediaStreamSource(new MediaStream(O)),B=this.audioContext.createGain();B.gain.value=1,L.connect(B),B.connect(this.audioDestination);const H={name:A,source:S,audioTrackSource:L,gainNode:B};this.analyticsTracker.trackEvent(new W_("audio",{deviceId:S.id})),this.mixer.audio.push(H)})}removeImage(S){const A=this.mixer.video.findIndex(O=>O.name===S);if(A<0)throw new xt(Object.assign({},Yn));this.mixer.video.splice(A,1)}removeVideoInputDevice(S){var A;const O=this.removeDevice(S,this.mixer.video);if(!O)throw new xt(Object.assign({},Nt));{const L=dn(O.source.getTracks(),Xt.VIDEO);if(!L)throw new xt(Object.assign({},Nt));O.element.srcObject=null,L.stop();const B=((A=L==null?void 0:L.getSettings)===null||A===void 0?void 0:A.call(L))||{};this.analyticsTracker.trackEvent(new q1(Ft(B),B))}}removeAudioInputDevice(S){const A=this.removeDevice(S,this.mixer.audio);if(A!=null&&A.audioTrackSource){for(const O of A.source.getTracks())O.stop(),this.analyticsTracker.trackEvent(new q1("audio",{deviceId:O.id}));A.gainNode.disconnect(this.audioDestination)}else if(!A)throw new xt(Object.assign({},Nt))}updateVideoDeviceComposition(S,A){if(!S||typeof S!="string")throw new xt(Object.assign({},ai));if(!A)throw new xt(Object.assign({},sr));if(typeof A.index!="number")throw new xt(Object.assign({},Si));this.mixer.video.forEach((O,L)=>{O.name===S&&(O.position=A)})}exchangeVideoDevicePositions(S,A){const O=this.getVideoInputDevice(S),L=this.getVideoInputDevice(A);if(!O)throw new xt(Object.assign(Object.assign({},En),{params:{details:`device with name: "${S}" not found`}}));if(!L)throw new xt(Object.assign(Object.assign({},En),{params:{details:`device with name: "${A}" not found`}}));const B=Object.assign({},O.position),H=Object.assign({},L.position);for(const te of this.mixer.video)te.name===S&&(Lm(H.x)?te.position=Object.assign(Object.assign({},te.position),H):te.position={index:H.index}),te.name===A&&(Lm(B.x)?te.position=Object.assign(Object.assign({},te.position),B):te.position={index:B.index})}start(){this.running||(this.running=!0,this.schedulerWorker.postMessage({type:yd.CONFIG,payload:{frameRate:this.config.streamConfig.maxFramerate}}),this.schedulerWorker.postMessage({type:yd.START}))}stop(){this.running&&(this.running=!1,this.schedulerWorker.removeEventListener("message",this.handleWorkerEvent))}isCapturing(){return this.running}getAudioLatency(){return this.audioContext.baseLatency}getVideoLatency(){var S;return((S=this.mediaStreamManager.getTrack(Xt.VIDEO))===null||S===void 0?void 0:S.getConstraints().latency)||0}disableVideo(){this.mixer.video.forEach(S=>{S.render=!1})}enableVideo(){this.mixer.video.forEach(S=>{S.render=!0})}disableAudio(){this.mixer.audio.forEach(S=>{S.audioTrackSource&&(S.gainNode.gain.value=0)})}enableAudio(){this.mixer.audio.forEach(S=>{S.audioTrackSource&&(S.gainNode.gain.value=1)})}getDrawRegion(S,A,O){var L,B,H,te;let re=(L=S.position.x)!==null&&L!==void 0?L:0,K=(B=S.position.y)!==null&&B!==void 0?B:0;const ae=(H=S.position.width)!==null&&H!==void 0?H:A-re,he=(te=S.position.height)!==null&&te!==void 0?te:O-K,pe=ae/he;let Ne=S.element.width,Je=S.element.height;S.element instanceof HTMLVideoElement&&(Ne=S.element.videoWidth,Je=S.element.videoHeight);const Ye=Ne/Je;let Oe=ae,ye=he;return Ye>pe?(Oe=ae,ye=2*Math.round(ae/Ye/2),K+=(he-ye)/2):Ye<pe&&(ye=he,Oe=2*Math.round(he*Ye/2),re+=(ae-Oe)/2),{x:re,y:K,width:Oe,height:ye}}drawComposite(){if(!this.shouldMix(new Date))return;this.compositeContext.clearRect(0,0,this.compositeEl.width,this.compositeEl.height),this.drawBlackScreen();const S=this.mixer.video.filter(A=>A.render);S.sort((A,O)=>A.position.index-O.position.index);for(const A of S){const{x:O,y:L,width:B,height:H}=this.getDrawRegion(A,this.compositeEl.width,this.compositeEl.height);this.compositeContext.drawImage(A.element,O,L,B,H)}this.previewElement&&this.previewCtx&&this.previewCtx.drawImage(this.compositeEl,0,0,this.previewElement.width,this.previewElement.height),this.requestCanvasCapture()}requestCanvasCapture(){typeof CanvasCaptureMediaStreamTrack!==void 0&&(typeof this.compositeStream.requestFrame=="function"?this.compositeStream.requestFrame():this.mediaStreamManager.getTrack(Xt.VIDEO).requestFrame())}drawBlackScreen(){this.compositeContext.fillStyle="#000000",this.compositeContext.fillRect(0,0,this.compositeEl.width,this.compositeEl.height)}removeDevice(S,A){const O=A.findIndex(L=>(B=>B.name===S)(L));if(!(O<0))return A.splice(O,1)[0]}shouldMix(S){if(S.getTime()<this.nextMix)return!1;for(;this.nextMix<=S.getTime();)this.nextMix+=1e3/this.config.streamConfig.maxFramerate;return!0}}function Lm(N){return Number.isSafeInteger(N)}var Um,L0,bd=function(N,S,A,O){return new(A||(A=Promise))(function(L,B){function H(K){try{re(O.next(K))}catch(ae){B(ae)}}function te(K){try{re(O.throw(K))}catch(ae){B(ae)}}function re(K){var ae;K.done?L(K.value):(ae=K.value,ae instanceof A?ae:new A(function(he){he(ae)})).then(H,te)}re((O=O.apply(N,[])).next())})},U0=function(N,S,A,O){if(A==="a"&&!O)throw new TypeError("Private accessor was defined without a getter");if(typeof S=="function"?N!==S||!O:!S.has(N))throw new TypeError("Cannot read private member from an object whose class did not declare it");return A==="m"?O:A==="a"?O.call(N):O?O.value:S.get(N)};class Ru{constructor(S){this.config=S,Um.add(this),this.emitter=new io,this.isValid=!0,this.emitter.on(wa.ERROR,this.stopBroadcast),this.config.ingestEndpoint&&(this.url=new URL(this.config.ingestEndpoint)),this.analyticsTracker=new gf,this.mediaStreamManager=new ji;const A=new km(S.logLevel,S.logger);this.peerClient=new _d(this.config,this.emitter,this.mediaStreamManager,A,this.analyticsTracker),this.broadcastCanvasManager=new zE(S,this.mediaStreamManager,this.analyticsTracker),this.peerStatsTracker=new X1(this.peerClient,this.broadcastCanvasManager,A,this.analyticsTracker),this.broadcastCanvasManager.start(),Object.getOwnPropertyNames(Ru.prototype).forEach(O=>{this[O]=new Proxy(this[O],{apply:(L,B,H)=>{if(!B.isValid)throw new xt(Object.assign({},A0));return Reflect.apply(L,B,H)}})}),window.addEventListener("beforeunload",()=>{this.analyticsTracker.stop(!0)})}delete(){this.isValid=!1,this.peerClient.stop(),this.broadcastCanvasManager.stop(),this.emitter.removeAllListeners()}startBroadcast(S,A){return bd(this,void 0,void 0,function*(){U0(this,Um,"m",L0).call(this,S);const O=mh(A||this.config.ingestEndpoint);this.analyticsTracker.start(),this.peerStatsTracker.start(),yield this.peerClient.start(O,S),this.emitter.emit(wa.ACTIVE_STATE_CHANGE,!0),this.url=new URL(O),this.url&&this.analyticsTracker.trackEvent(new _h({protocol:"webrtc",hostname:this.url.hostname,port:this.url.port},vf.USER_INITIATED))})}stopBroadcast(){var S,A,O;this.url&&this.analyticsTracker.trackEvent(new Im({protocol:"webrtc",hostname:this.url.hostname,port:this.url.port})),(S=this.peerStatsTracker)===null||S===void 0||S.stop(),(A=this.peerClient)===null||A===void 0||A.stop(),(O=this.emitter)===null||O===void 0||O.emit(wa.ACTIVE_STATE_CHANGE,!1)}getCanvasDimensions(){return this.broadcastCanvasManager.getCanvasDimensions()}addVideoInputDevice(S,A,O){return bd(this,void 0,void 0,function*(){return this.broadcastCanvasManager.addVideoInputDevice(S,A,O)})}addImageSource(S,A,O){return bd(this,void 0,void 0,function*(){return this.broadcastCanvasManager.addImageSource(S,A,O)})}addAudioInputDevice(S,A){return bd(this,void 0,void 0,function*(){return this.broadcastCanvasManager.addAudioInputDevice(S,A)})}removeVideoInputDevice(S){this.broadcastCanvasManager.removeVideoInputDevice(S)}removeAudioInputDevice(S){this.broadcastCanvasManager.removeAudioInputDevice(S)}removeImage(S){this.broadcastCanvasManager.removeImage(S)}updateVideoDeviceComposition(S,A){this.broadcastCanvasManager.updateVideoDeviceComposition(S,A)}exchangeVideoDevicePositions(S,A){this.broadcastCanvasManager.exchangeVideoDevicePositions(S,A)}getAudioInputDevice(S){return this.broadcastCanvasManager.getAudioInputDevice(S)}getVideoInputDevice(S){return this.broadcastCanvasManager.getVideoInputDevice(S)}getConnectionState(){return this.peerClient.getConnectionState()}getSessionId(){return this.peerClient.getSessionId()}on(S,A){this.emitter.on(S,A)}off(S,A){this.emitter.off(S,A)}getAudioContext(){return this.broadcastCanvasManager.audioContext}attachPreview(S){this.broadcastCanvasManager.attachPreview(S)}detachPreview(){this.broadcastCanvasManager.detachPreview()}disableVideo(){this.broadcastCanvasManager.disableVideo()}enableVideo(){this.broadcastCanvasManager.enableVideo()}disableAudio(){this.broadcastCanvasManager.disableAudio()}enableAudio(){this.broadcastCanvasManager.enableAudio()}}function Hr(N){return new Ru(function(S){const A=new ls;return A.streamConfig=S.streamConfig,A.ingestEndpoint=S.ingestEndpoint,A.logger=S.logger,A.logLevel=S.logLevel,A.networkReconnectConfig=S.networkReconnectConfig,A}(N))}Um=new WeakSet,L0=function(N){if(typeof N!="string"||!/^[a-zA-Z0-9_-]+$/.test(N))throw new xt(wu)};const B0="1.19.0";var fn,fa=r(6486);(function(N){N.PUBLISH="publish",N.SUBSCRIBE="subscribe",N.JOIN="join",N.LEAVE="leave"})(fn||(fn={}));const F0=2;class Mu extends qn{constructor(S){super(bn.LEAVE,S.token,S.traceId,!1),Object.assign(this.properties,{action:fn.LEAVE,event_endpoint:S.eventEndpoint,whip_endpoint:S.whipEndpoint,reason:S.reason}),this.critical=!0}}class Jc{constructor(){this.emitter=new io}on(S,A,O){A.call=function(L,B){return function(H,...te){try{B.apply(H,te)}catch(re){let K=`Error in callback for ${L}`;const ae=B.name;return ae&&(K+=` for function ${ae}`),void console.error(`${K}
`,re)}}}(S,A),this.emitter.on(S,A,O)}off(S,A,O){this.emitter.off(S,A,O)}emit(S,...A){this.emitter.emit(S,...A)}removeAllListeners(){this.emitter.removeAllListeners()}}function z0(N){const S="0123456789abcdef";let A="";for(let O=0;O<N;O+=1)A+=S.charAt(Math.floor(Math.random()*S.length));return A}class Dp{constructor(){const S=z0;this.value=`${S(8)}-${S(4)}-${S(4)}-${S(4)}-${S(12)}`}}function Ca(){return new Dp}class HE{constructor(){const S=(Date.now()/1e3|0).toString(16);this.value=`1-${S}-${z0(24)}`}}function gc(){return new HE}var ws=r(9669),Js=r.n(ws);class Ii extends xt{constructor({token:S,traceId:A,code:O,tag:L,location:B,message:H,details:te,remoteParticipantId:re,requestUUID:K,fatal:ae,nominal:he,action:pe}){super({name:"StageClientError",message:H,code:O}),Error.captureStackTrace&&Error.captureStackTrace(this,Ii),this.action=pe,this.token=S,this.traceId=A,this.code=O,this.tag=L,this.location=B,this.message=H,this.details=te,this.remoteParticipantId=re,this.requestUUID=K,this.fatal=ae,this.nominal=he}}const vc={JOIN_RELATED:"signalling_session",PUBLISH_RELATED:"webrtc_sink",UNPUBLISH_RELATED:"webrtc_unsink",SUBSCRIBE_RELATED:"webrtc_source"};function Co(N,S){switch(N){case fn.PUBLISH:return vc.PUBLISH_RELATED;case fn.SUBSCRIBE:return`webrtc_source:${S}`;default:return"unknown"}}function Pp(N,S){var A,O,L,B;const H={code:N.code,message:`${N.message}: ${S.name} ${S.message}`,fatal:(A=N.fatal)!==null&&A!==void 0&&A,nominal:(O=N.nominal)!==null&&O!==void 0&&O};return S instanceof Ii&&(H.fatal=(L=S.fatal)!==null&&L!==void 0&&L,H.nominal=(B=S.nominal)!==null&&B!==void 0&&B),H}function H0(N,S){if(N===0)return Bt.UNKNOWN_SERVER_ERROR;if(!(N<400))if(N>=400&&N<=403)switch(S){case Ao.TokenExpired:return Bt.EXPIRED_TOKEN;case Ao.NoPermissions:return Bt.TOKEN_PERMISSIONS_DENIED;case Ao.StageAtCapacity:return Bt.STAGE_AT_CAPACITY;case Ao.NoMatchingCodec:return Bt.NO_MATCHING_CODEC;default:return Bt.UNKNOWN_SERVER_ERROR}else{if(N===404)return S===Ao.RemoteStreamNotFound?Bt.REMOTE_STREAM_NOT_FOUND:Bt.UNKNOWN_SERVER_ERROR;if(N===412)return S===Ao.AbortedMHCPError?Bt.MHCP_ABORTED:Bt.UNKNOWN_SERVER_ERROR;if(N===429)return S===Ao.StageAuthThrottled?Bt.STAGE_AUTH_THROTTLED:Bt.WHIP_TOO_MANY_REQUESTS;if(N!==500)return Bt.UNKNOWN_SERVER_ERROR;switch(S){case Ao.InternalMHCPError:return Bt.INTERNAL_MHCP_ERROR;case Ao.UnreachableMHCP:return Bt.UNREACHABLE_MHCP;case Ao.InvalidSessionStatus:return Bt.INVALID_SESSION_STATUS;default:return Bt.INTERNAL_SERVER_ERROR}}}var Ao;(function(N){N[N.Unspecified=2001]="Unspecified",N[N.TokenExpired=2002]="TokenExpired",N[N.NoPermissions=2003]="NoPermissions",N[N.RemoteStreamNotFound=2004]="RemoteStreamNotFound",N[N.StageAtCapacity=2005]="StageAtCapacity",N[N.InternalMHCPError=2006]="InternalMHCPError",N[N.UncategorizedMHCPError=2007]="UncategorizedMHCPError",N[N.UnreachableMHCP=2008]="UnreachableMHCP",N[N.InvalidSessionStatus=2010]="InvalidSessionStatus",N[N.PostWithoutOptions=2011]="PostWithoutOptions",N[N.AbortedMHCPError=2012]="AbortedMHCPError",N[N.StageAuthThrottled=2013]="StageAuthThrottled",N[N.NoMatchingCodec=2014]="NoMatchingCodec"})(Ao||(Ao={}));const Bt={MALFORMED_TOKEN:{code:1e3,message:"Token is malformed",fatal:!0,nominal:!0},EXPIRED_TOKEN:{code:1001,message:"Token expired and is no longer valid",fatal:!0,nominal:!0},UNPUBLISH_FAILURE:{code:1013,message:"Failed to unpublish",fatal:!1,nominal:!1},UNSUBSCRIBE_FAILURE:{code:1014,message:"Failed to unsubscribe",fatal:!1,nominal:!1},PUBLISH_FAILURE:{code:1015,message:"Failed to publish",fatal:!1,nominal:!1},SUBSCRIBE_FAILURE:{code:1016,message:"Failed to subscribe",fatal:!1,nominal:!1},JOIN_FAILURE:{code:1017,message:"Failed to join",fatal:!0,nominal:!1},JOIN_TIMED_OUT:{code:1019,message:"Join timed out",fatal:!0,nominal:!1},PUBLISH_TIMED_OUT:{code:1020,message:"Publish timed out",fatal:!1,nominal:!1},SUBSCRIBE_TIMED_OUT:{code:1021,message:"Subscribe timed out",fatal:!1,nominal:!1},NO_CANDIDATES:{code:1022,message:"No ICE candidates",fatal:!1,nominal:!1},OPERATION_ABORTED:{code:1023,message:"Request aborted",fatal:!1,nominal:!0},STAGE_AT_CAPACITY:{code:1024,message:"Stage at capacity",fatal:!0,nominal:!0},INTERNAL_SERVER_ERROR:{code:1025,message:"Internal server error",fatal:!0,nominal:!1},TOKEN_PERMISSIONS_DENIED:{code:1026,message:"Token permissions are not valid for the operation",fatal:!0,nominal:!1},REMOTE_STREAM_NOT_FOUND:{code:1027,message:"Contributor group (PUBLISH) or remote stream (SUBSCRIBE) not found",fatal:!0,nominal:!1},INTERNAL_MHCP_ERROR:{code:1028,message:"Authorization failed due to internal MHCP error",fatal:!0,nominal:!1},UNCATEGORIZED_MHCP_ERROR:{code:1029,message:"Authorization failed due to uncategorized MHCP error",fatal:!0,nominal:!1},UNREACHABLE_MHCP:{code:1030,message:"Authorization failed due to MHCP unreachable",fatal:!0,nominal:!1},INVALID_SESSION_STATUS:{code:1031,message:"Stream has already been published (PUBLISH) or subscribed to (SUBSCRIBE)",fatal:!0,nominal:!1},POST_WITHOUT_OPTIONS:{code:1032,message:"Cannot POST without OPTIONS in mandatory TURN",fatal:!0,nominal:!1},MHCP_ABORTED:{code:1033,message:"Publisher state conflict",fatal:!0,nominal:!1},STAGE_AUTH_THROTTLED:{code:1034,message:"Too many requests",fatal:!1,nominal:!1},NO_MATCHING_CODEC:{code:1035,message:"No matching codec found",fatal:!0,nominal:!1},CHIME_MEETING_NOT_FOUND:{code:1098,message:"Meeting or Attendee was deleted",fatal:!0,nominal:!0},UNKNOWN_SERVER_ERROR:{code:1099,message:"Service error code unknown or not found",fatal:!0,nominal:!1},XDP_CONNECTION_LOST:{code:1221,message:"Connection lost during SDP exchange",fatal:!1,nominal:!1},XDP_INVALID_ANSWER_MSG:{code:1222,message:"Invalid answer message received by client",fatal:!1,nominal:!1},XDP_TIMEOUT:{code:1223,message:"Failed to receive SDP answer within timeout period",fatal:!1,nominal:!1},XDP_UNEXPECTED_ERROR:{code:1224,message:"Unexpected error encountered",fatal:!1,nominal:!1},WEBSOCKET_MESSAGE_PARSE_FAILURE:{code:1204,message:"Failed to parse websocket message",fatal:!1,nominal:!1},WHIP_SESSION_RESOURCE_DELETED:{code:1206,message:"WHIP signaling session resource not found",fatal:!0,nominal:!0},WHIP_TOO_MANY_REQUESTS:{code:1207,message:"WHIP endpoint received too many requests",fatal:!1,nominal:!1},WHIP_OPTIONS_FAILURE:{code:1501,message:"Failed to get ICE Servers from OPTIONS",fatal:!1,nominal:!1},WHIP_POST_FAILURE:{code:1502,message:"WHIP post failure",fatal:!1,nominal:!1},WHIP_DELETE_FAILURE:{code:1503,message:"WHIP delete failure",fatal:!1,nominal:!1},WHIP_URL_MISSING:{code:1504,message:"WHIP delete failure",fatal:!1,nominal:!1},WHEP_SET_LAYER_REQUEST_FAILED:{code:1510,message:"Set layer request failed for reason: Unknown",fatal:!1,nominal:!1},WHEP_SET_LAYER_REQUEST_THROTTLED:{code:1511,message:"Too many set layer requests",fatal:!1,nominal:!0},WHEP_GET_LAYER_STATE_FAILED:{code:1512,message:"Get layer state failed for reason: Unknown",fatal:!1,nominal:!1},WHEP_GET_LAYER_STATE_THROTTLED:{code:1513,message:"Too many get layer state requests",fatal:!1,nominal:!0},EVENT_PLANE_WS_CREATE_FAILED:{code:1300,message:"Error creating WebSocket",fatal:!0,nominal:!1},EVENT_PLANE_WS_UNEXPECTED_CLOSE:{code:1302,message:"Unexpectedly not connected to event plane",fatal:!1,nominal:!1},EVENT_PLANE_PING_SEND_FAIL:{code:1303,message:"Ping send fail",fatal:!1,nominal:!1},EVENT_PLANE_PONG_TIMEOUT:{code:1304,message:"Pong timed out",fatal:!1,nominal:!1},EVENT_PLANE_WS_CLOSE_BEFORE_OPEN:{code:1305,message:"Connect attempt closed by server",fatal:!1,nominal:!1},PEER_CONNECTION_NETWORK_FAILURE:{code:1400,message:"PeerConnection is lost due to unknown network error",fatal:!1,nominal:!1},CREATE_OFFER_FAILURE:{code:1402,message:"Failed to set local description",fatal:!1,nominal:!1},CREATE_PEER_CONNECTION_FAILURE:{code:1403,message:"Failed to create a peer connection",fatal:!1,nominal:!1},ICE_CANDIDATE_ERROR:{code:1404,message:"ICE candidate error",fatal:!1,nominal:!1},SET_ANSWER_FAILURE:{code:1405,message:"Failed to set remote answer",fatal:!1,nominal:!1},NETWORK_FAILURE:{code:1406,message:"Failed due to network problem",fatal:!1,nominal:!1},REASSIGNMENT_REQUEST_INVALID_LOCAL_PARTICIPANT_ID:{code:1470,message:"Invalid participant id in the reassignment message",fatal:!1,nominal:!1},REASSIGNMENT_REQUEST_INVALID_REMOTE_PARTICIPANT_ID:{code:1471,message:"Invalid remote participant id in the reassignment message",fatal:!1,nominal:!1},REASSIGNMENT_REQUEST_INVALID_REMOTE_PEER_CONNECTION_STATE:{code:1472,message:"Invalid subscriber peer connection state for reassignment",fatal:!1,nominal:!1},REASSIGNMENT_REQUEST_ALREADY_IN_PROGRESS:{code:1473,message:"Request rejected because client is already processing a previous reassignment request",fatal:!1,nominal:!1},UNEXPECTED_ERROR:{code:9999,message:"Encountered unexpected error condition. Expected StageClientError type.",fatal:!1,nominal:!1},TRANSFORM_UNEXPECTED_ERROR:{code:1480,message:"Unexpected error occurred during transform execution",fatal:!1,nominal:!1},TRANSFORM_TOO_MANY_ERRORS:{code:1481,message:"Transformer encountered too many consecutive errors",fatal:!1,nominal:!1},TRANSFORM_NOT_SUPPORTED_BY_PLATFORM:{code:1482,message:"Transforms are not supported by this platform",fatal:!1,nominal:!1},CODEC_HANDLE_INCOMPATIBLE_UNEXPECTED_ERROR:{code:1490,message:"Unexpected error occurred when handling incompatible codecs",fatal:!1,nominal:!1}};var Aa;(function(N){N.UNPUBLISH="unpublish",N.UNSUBSCRIBE="unsubscribe",N.UNLOAD="unload",N.CONNECTION_FAIL="connection fail",N.REASSIGNMENT="reassignment"})(Aa||(Aa={}));const Bm="stageJoined",Ed="stageParticipantJoined",bf="stageParticipantLeft",da="stageParticipantKicked",j0="stageParticipantUpdated",_c="localPublishingChanged",Z1="stageRefresh",wl="stateChange",Lp="error",Yl="reassignmentRequest",Sd="incompatibleCodecs",Fm="connectionStateChange",ge="stageStreamUpdate",Ef="error",Sh="stageStreamSeiMessageReceived",so="transformError",Fi="reassignmentStarted",Sf="reassignmentSuccess",Ou="reassignmentFailed",Qc="open",Nu="closed",yc="messageParseError",J_="refresh",Xl="error",Q_="stageStateMessage",V0="sdpAnswer",G0="disconnectMessage",Td="reassignmentMessage",Ro="incompatibleCodecs";function jE(N){return A=function(O){return O.replace(/-/g,"+").replace(/_/g,"/").padEnd(O.length+(4-O.length%4)%4,"=")}(N),window.atob(A);var A}class Xo{constructor(S,A){this.analyticsTracker=A,this.rawToken=S;const O=S.split(".");if(O.length!==3)throw Error(`Token format incorrect. length: ${O.length}`);try{this.header=JSON.parse(jE(O[0]))}catch(H){const te=H instanceof Error?`: ${H.message}`:"";throw Error(`Error parsing Stage Token header${te}`)}try{this.claims=JSON.parse(jE(O[1]))}catch(H){const te=H instanceof Error?`: ${H.message}`:"";throw Error(`Error parsing Stage Token claims${te}`)}this.signature=O[2];const{claims:L}=this;this.stageARN=L.resource,this.participantID=L.jti,this.eventsURL=L.events_url,this.whipURL=mf("whipUrl")||L.whip_url,this.userID=L.user_id,this.expirationTime=L.exp,this.topic=L.topic,this.parseVersionFlags(L.version);const{attributes:B}=L;B&&(this.attrGsRole=B.gs_role,this.attrGsSessionId=B.gs_session_id)}getPublishEndpoint(){let S="";return this.whipURL&&this.participantID&&(S=`${this.whipURL}/publish/${this.participantID}`),S}getSubscribeEndpoint(S){let A="";return this.whipURL&&(A=`${this.whipURL}/subscribe/${S}`),A}assertTokenIsUnexpired(S,A,O,L){(!this.expirationTime||Date.now()/1e3>=this.expirationTime)&&this.analyticsTracker.trackErrorAndThrow(new Ii(Object.assign(Object.assign({},Bt.EXPIRED_TOKEN),{action:fn.JOIN,location:O,tag:A,token:this,traceId:S,remoteParticipantId:L,message:Bt.EXPIRED_TOKEN.message,details:`Token expired at ${this.expirationTime} and is no longer valid`})))}parseVersionFlags(S){if(!S)return;const A=S.split(".");A.length===2&&(this.versionFlags=parseInt(A[1],10))}shouldSendSilentAudio(){return this.versionFlags===void 0||(this.versionFlags&F0)!=0}}function Iu(N,S){return new Xo(N,S)}class q0{constructor(S,A){this.throttleDuration=0,this.throttled=!1,this.timeout=0,this.unthrottle=()=>{this.trailing&&this.trailingFn&&this.trailingFn(...this.trailingFnArgs),this.clear()},this.throttleDuration=S,this.trailing=!(A&&A.skipTrailing)}invoke(S,...A){return this.throttled?(this.trailingFn=S,this.trailingFnArgs=A,!1):(this.throttled=!0,this.timeout=window.setTimeout(this.unthrottle,this.throttleDuration),S(...A),!0)}clear(){clearTimeout(this.timeout),this.timeout=0,this.throttled=!1,delete this.trailingFn,delete this.trailingFnArgs}}class Tf extends qn{constructor(S,A,O,L,B,H,te,re){super(bn.SERVER_REQUEST,A,te,!0),Object.assign(this.properties,{action:S,http_method:L,remote_participant_id:H,request_uuid:B,url:O,transport:re})}}const bc="draft-ietf-wish-whip-04";var us,ey=function(N,S,A,O){return new(A||(A=Promise))(function(L,B){function H(K){try{re(O.next(K))}catch(ae){B(ae)}}function te(K){try{re(O.throw(K))}catch(ae){B(ae)}}function re(K){var ae;K.done?L(K.value):(ae=K.value,ae instanceof A?ae:new A(function(he){he(ae)})).then(H,te)}re((O=O.apply(N,[])).next())})};function xd(N,S){return ey(this,void 0,void 0,function*(){N.validateStatus=O=>O>=200&&O<300||O===403;const A=yield Js()(N);if(A.status===403){if(A.data.code===2003)throw new ws.AxiosError("Request failed with status code 403","ERR_BAD_REQUEST",N,A.request,A);return N.url===A.request.responseURL?(N.validateStatus=O=>O>=200&&O<300,Js()(N)):(N.url=A.request.responseURL,S<5?xd(N,S+1):(N.validateStatus=O=>O>=200&&O<300,Js()(N)))}return A})}function Cl(N){return ey(this,void 0,void 0,function*(){return xd(N,0)})}function $0(){}function VE(N){switch(N){case"new":return at.NEW;case"closed":return at.CLOSED;case"disconnected":return at.DISCONNECTED;case"failed":return at.FAILED;case"idle":return at.IDLE;case"checking":case"connecting":return at.CONNECTING;case"completed":case"connected":return at.CONNECTED;default:throw new Error(`unknown connecion state: ${N}`)}}function zm(N,S,A){let O=document.createElement(S);const L=()=>{O&&(O.removeEventListener("loadeddata",B),O.removeEventListener("error",L),O.srcObject=null,O.src="",O=null)},B=()=>{L(),A(S)};return O.addEventListener("loadeddata",B),O.addEventListener("error",L),O.srcObject=N,L}class Hm extends qn{constructor(S,A,O,L,B){super(bn.TRACE,S,A,!1),Object.assign(this.properties,{action:L,message:O,remote_participant_id:B})}}class Ha extends qn{constructor(S,A,O,L,B){super(bn.CONNECTION_STATE,A,O,!1),Object.assign(this.properties,{action:S,remote_participant_id:B,state:L})}}class W0 extends qn{constructor(S,A,O,L,B){super(bn.ICE_GATHERING_STATE,A,O,!1),Object.assign(this.properties,{action:S,remote_participant_id:B,state:L})}}(function(N){N.POST="post",N.CONNECTED="connected",N.ICE_GATHERING="icegathering",N.SDP_EXCHANGE="sdpExchange",N.SET_REMOTE_DESC="setRemoteDesc",N.PEER_CONNECTION="peerConnection"})(us||(us={}));const GE="start",ku="stop";class qE{constructor(S,A){this.marks={},this.optionsDuration=0,this.postDuration=0,this.timeToCandidate=0,this.timeToConnected=0,this.sdpExchangeDuration=0,this.sdpExchangeTransport="",this.setRemoteDescDuration=0,this.peerConnectionDuration=0,this.action=S,this.traceId=A}markActionStart(){this.markStart(us.CONNECTED)}markPostStart(){this.markStart(us.POST)}markPostStop(){this.markStop(us.POST),this.postDuration=this.measure(us.POST)}markIceGatheringStart(){this.markStart(us.ICE_GATHERING)}markIceGatheringStop(){this.markStop(us.ICE_GATHERING),this.timeToCandidate=this.measure(us.ICE_GATHERING)}markActionStop(){this.markStop(us.CONNECTED),this.timeToConnected=this.measure(us.CONNECTED),this.markStop(us.PEER_CONNECTION),this.peerConnectionDuration=this.measure(us.PEER_CONNECTION)}markSetRemoteDescStart(){this.markStart(us.SET_REMOTE_DESC)}markSetRemoteDescStop(){const S=us.SET_REMOTE_DESC;this.markStop(S),this.setRemoteDescDuration=this.measure(S),this.markStart(us.PEER_CONNECTION)}markSdpExchangeStart(){this.markStart(us.SDP_EXCHANGE)}markSdpExchangeStop(){const S=us.SDP_EXCHANGE;this.markStop(S),this.sdpExchangeDuration=this.measure(S)}setTransport(S){this.sdpExchangeTransport=S}markStart(S){this.marks[`${this.namespace}.${S}.${GE}`]=performance.now()}markStop(S){this.marks[`${this.namespace}.${S}.${ku}`]=performance.now()}measure(S){const A=`${this.namespace}.${S}.${GE}`,O=`${this.namespace}.${S}.${ku}`,L=this.marks[A],B=this.marks[O];return L===void 0||B===void 0?0:B-L}get namespace(){return`ivswb.peerclient.${this.action}.${this.traceId.value}`}getMeasurements(){const{optionsDuration:S,postDuration:A,timeToCandidate:O,timeToConnected:L,sdpExchangeDuration:B,sdpExchangeTransport:H,setRemoteDescDuration:te,peerConnectionDuration:re}=this;return{optionsDuration:S,postDuration:A,timeToCandidate:O,timeToConnected:L,sdpExchangeDuration:B,sdpExchangeTransport:H,setRemoteDescDuration:te,peerConnectionDuration:re}}resetMeasurements(S){this.traceId=S,this.marks={},this.optionsDuration=0,this.postDuration=0,this.timeToCandidate=0,this.timeToConnected=0,this.sdpExchangeDuration=0,this.sdpExchangeTransport="",this.setRemoteDescDuration=0,this.peerConnectionDuration=0}}var Du,Gs,Kl;(function(N){N.VIDEO="video",N.AUDIO="audio"})(Du||(Du={})),function(N){N.DEFAULT="default",N.LOW="low",N.MEDIUM="medium",N.HIGH="high"}(Gs||(Gs={})),function(N){N.LOWEST_QUALITY="lowest_quality",N.HIGHEST_QUALITY="highest_quality"}(Kl||(Kl={}));var pa=r(766);class jr{constructor(S){this.sdp=S}static splitLines(S){return S.trim().split(`
`).map(A=>A.trim())}static splitSections(S){return S.split(`
m=`).map((A,O)=>(O>0?`m=${A}`:A).trim()+jr.CRLF)}getUniqueRtpHeaderExtensionId(S){const A=[];for(const L of S)if(/^a=extmap:/.test(L.trim())){const B=+L.split("a=extmap:")[1].split(" ")[0];A.includes(B)||A.push(B)}A.sort((L,B)=>L-B);let O=0;for(const L of A){if(L-O>1)return O+1;O=L}return O===14?-1:O+1}withVideoLayersAllocationRtpHeaderExtension(S){const A="http://www.webrtc.org/experiments/rtp-hdrext/video-layers-allocation00",O=S?S.getRtpHeaderExtensionId(A):-1,L=O===-1?this.getUniqueRtpHeaderExtensionId(jr.splitLines(this.sdp)):O,B=jr.splitSections(this.sdp),H=[];for(let re of B){if(/^m=video/.test(re)&&jr.getRtpHeaderExtensionIdInSection(re,A)===-1){const K=jr.splitLines(re),ae=[];if(L===-1||this.hasRtpHeaderExtensionId(L)){H.push(re);continue}for(const he of K)if(ae.push(he),/^a=sendrecv/.test(he.trim())){const pe=`a=extmap:${L} ${A}`;ae.push(pe)}re=ae.join(jr.CRLF)+jr.CRLF}else if(O!==-1&&/^m=video/.test(re)&&jr.getRtpHeaderExtensionIdInSection(re,A)!==O){const K=jr.splitLines(re),ae=[];for(const he of K){if(/^a=extmap:/.test(he.trim())&&he.split("a=extmap:")[1].split(" ")[1]===A){if(!this.hasRtpHeaderExtensionId(O)){const pe=`a=extmap:${O} ${A}`;ae.push(pe)}continue}ae.push(he)}re=ae.join(jr.CRLF)+jr.CRLF}H.push(re)}const te=H.join("");return new jr(te)}withOpusAudioConfig(S,A){const O=pa.Qc(this.sdp);for(const L of O.media)if(L.type==="audio"){const{payload:B}=L.rtp.find(K=>K.codec==="opus");if(!B)continue;let H=L.fmtp.find(K=>K.payload===B);H||(H={payload:B,config:""});const te=pa.rz(H.config);if(te.maxaveragebitrate=S,typeof A=="boolean"){const K=A?1:0;te["sprop-stereo"]=K,te.stereo=K}let re="";for(const K of Object.keys(te))re+=`${K}=${te[K]}; `;H.config=re.trim()}return new jr(pa.cW(O))}static getRtpHeaderExtensionIdInSection(S,A){const O=jr.splitLines(S);for(const L of O)if(/^a=extmap:/.test(L.trim())){const B=L.split("a=extmap:")[1].split(" "),H=+B[0];if(B[1]===A)return H}return-1}getRtpHeaderExtensionId(S){const A=jr.splitSections(this.sdp);for(const O of A)if(/^m=video/.test(O)){const L=jr.getRtpHeaderExtensionIdInSection(O,S);if(L!==-1)return L}return-1}hasRtpHeaderExtensionId(S){const A=jr.splitLines(this.sdp);for(const O of A)if(/^a=extmap:/.test(O.trim())&&+O.split("a=extmap:")[1].split(" ")[0]===S)return!0;return!1}hasAudioNacksEnabled(){var S,A,O;return((O=(A=((S=pa.Qc(this.sdp).media.filter(L=>L.type==="audio")[0])!==null&&S!==void 0?S:{}).rtcpFb)===null||A===void 0?void 0:A.filter(L=>L.type==="nack"))!==null&&O!==void 0?O:[]).length>0}}jr.CRLF=`\r
`,jr.rfc7587LowestBitrate=6e3,jr.rfc7587HighestBitrate=51e4;const jm=200,Vm=2500,ty=10,Ec=30,Y0=12,or=128,X0={[Gs.DEFAULT]:0,[Gs.LOW]:50,[Gs.MEDIUM]:150,[Gs.HIGH]:250},J1={[Gs.DEFAULT]:0,[Gs.LOW]:100,[Gs.MEDIUM]:200,[Gs.HIGH]:300},$E=()=>({minBitrate:jm,maxBitrate:Vm,maxFramerate:Ec,simulcast:{enabled:!1},maxAudioBitrateKbps:64,stereo:!1});var WE=function(N,S,A,O){return new(A||(A=Promise))(function(L,B){function H(K){try{re(O.next(K))}catch(ae){B(ae)}}function te(K){try{re(O.throw(K))}catch(ae){B(ae)}}function re(K){var ae;K.done?L(K.value):(ae=K.value,ae instanceof A?ae:new A(function(he){he(ae)})).then(H,te)}re((O=O.apply(N,[])).next())})};const Q1="H264",ny=N=>{const S=N==null?void 0:N.split("/");if((S==null?void 0:S.length)===2)return S[1]},Pu=(N,S)=>{const A=ny(N);if(N===void 0||A===void 0)return;const O={mimeSubtype:A};if(S){const L=(B=>{const H=B.split(";"),te=new Map;for(const re of H){const[K,ae]=re.split("=");te.set(K,ae)}return te})(S);switch(A){case Q1:{const B=L.get("profile-level-id");B&&((H,te)=>{if(te.length<6)return;const re=te.substring(0,4),K=parseInt(te.substring(4,6),16);H.profile=re,H.level=K})(O,B);break}case"H265":((B,H)=>{const te=H.get("profile-id")||"0",re=H.get("tier-flag")||"0",K=parseInt(H.get("level-id")||"0",10),ae=[re,te].join("_");B.profile=ae,B.level=K})(O,L)}}return O},K0=(N,S)=>N.sort((A,O)=>{if(ny(A.mimeType)===Q1){const L=Pu(A.mimeType,A.sdpFmtpLine);if((L==null?void 0:L.profile)===S)return-1}return 0}),Th=(N,S)=>{var A;const O=Pu(N.mimeType,N.sdpFmtpLine);return(O==null?void 0:O.mimeSubtype.toLowerCase())===S.mime.toLowerCase()&&((A=O==null?void 0:O.profile)===null||A===void 0?void 0:A.toLowerCase().indexOf(S.config.toLowerCase()))===0},Z0=(N,S)=>S.filter(A=>!A.mimeType.endsWith("rtx")).filter(A=>A.mimeType.indexOf("packetization-mode=0")===-1).find(A=>N.reduce((O,L)=>O&&Th(A,L)===!1,!0));class J0 extends qn{constructor(S,A,O,L,B,H,te,re,K){var ae,he;super(bn.PUBLISHED_VIDEO_STATS,S,A,!1),Object.assign(this.properties,Object.assign({action:fn.PUBLISH,node:(ae=O==null?void 0:O.node)!==null&&ae!==void 0?ae:"",cluster:(he=O==null?void 0:O.cluster)!==null&&he!==void 0?he:""},((pe,Ne,Je,Ye,Oe,ye)=>{var lt,wt,Kt,It,Kn,wn,_i,zi,ki,xi,yi,Ri,Di,bi,Mi,ui,Tn,$n,$i,Jr,Es,Qr,ds,es,Ir,fr,Wr,ts,ps,Qs,ga;const Ss=(wt=(lt=pe==null?void 0:pe.qualityLimitationDurations)===null||lt===void 0?void 0:lt.cpu)!==null&&wt!==void 0?wt:0,Ps=(It=(Kt=pe==null?void 0:pe.qualityLimitationDurations)===null||Kt===void 0?void 0:Kt.bandwidth)!==null&&It!==void 0?It:0,dr=Math.max((Kn=pe==null?void 0:pe.bytesSent)!==null&&Kn!==void 0?Kn:0,0),Ma=8*dr/(ye??1),Jn=Math.max((wn=Ne==null?void 0:Ne.packetsLost)!==null&&wn!==void 0?wn:0,0),Gi=Math.max((_i=pe==null?void 0:pe.packetsSent)!==null&&_i!==void 0?_i:0,0),Mr=Jn/Math.max(Gi,1),$a=Pu(Ye==null?void 0:Ye.mimeType,Ye==null?void 0:Ye.sdpFmtpLine);return{active:!!(pe!=null&&pe.framesPerSecond)&&pe.framesPerSecond!==0,bytes_sent:dr,codec_mime_type:$a==null?void 0:$a.mimeSubtype,codec_profile:$a==null?void 0:$a.profile,codec_level:$a==null?void 0:$a.level,configured_bitrate:Oe==null?void 0:Oe.max_bitrate,connection_bandwidth:(zi=Je==null?void 0:Je.availableOutgoingBitrate)!==null&&zi!==void 0?zi:0,encode_bitrate:Ma,encoder_implementation:(ki=pe==null?void 0:pe.encoderImplementation)!==null&&ki!==void 0?ki:"unknown",fir_count:(xi=pe==null?void 0:pe.firCount)!==null&&xi!==void 0?xi:0,fraction_packets_lost:Mr,frame_height:Math.max((yi=pe==null?void 0:pe.frameHeight)!==null&&yi!==void 0?yi:0,0),frame_width:Math.max((Ri=pe==null?void 0:pe.frameWidth)!==null&&Ri!==void 0?Ri:0,0),frames_encoded:(Di=pe==null?void 0:pe.framesEncoded)!==null&&Di!==void 0?Di:0,frames_per_second:Math.max((bi=pe==null?void 0:pe.framesPerSecond)!==null&&bi!==void 0?bi:0,0),frames_sent:(Mi=pe==null?void 0:pe.framesSent)!==null&&Mi!==void 0?Mi:0,header_bytes_sent:(ui=pe==null?void 0:pe.headerBytesSent)!==null&&ui!==void 0?ui:0,huge_frames_sent:(Tn=pe==null?void 0:pe.hugeFramesSent)!==null&&Tn!==void 0?Tn:0,key_frames_encoded:($n=pe==null?void 0:pe.keyFramesEncoded)!==null&&$n!==void 0?$n:0,nack_count:($i=pe==null?void 0:pe.nackCount)!==null&&$i!==void 0?$i:0,packets_lost:Jn,packets_sent:Gi,power_efficient_encoder:(Jr=pe==null?void 0:pe.powerEfficientEncoder)!==null&&Jr!==void 0&&Jr,pli_count:(Es=pe==null?void 0:pe.pliCount)!==null&&Es!==void 0?Es:0,quality_limitation_reason:(Qr=pe==null?void 0:pe.qualityLimitationReason)!==null&&Qr!==void 0?Qr:"none",quality_limitation_resolution_changes:(ds=pe==null?void 0:pe.qualityLimitationResolutionChanges)!==null&&ds!==void 0?ds:0,quality_limitation_cpu_duration:Ss,quality_limitation_bandwidth_duration:Ps,retransmitted_bytes_sent:(es=pe==null?void 0:pe.retransmittedBytesSent)!==null&&es!==void 0?es:0,retransmitted_packets_sent:(Ir=pe==null?void 0:pe.retransmittedPacketsSent)!==null&&Ir!==void 0?Ir:0,rid:(fr=pe==null?void 0:pe.rid)!==null&&fr!==void 0?fr:"no-rid",scalability_mode:(Wr=pe==null?void 0:pe.scalabilityMode)!==null&&Wr!==void 0?Wr:"unknown",target_bitrate:Math.max((ts=pe==null?void 0:pe.targetBitrate)!==null&&ts!==void 0?ts:0,0),total_encode_time:(ps=pe==null?void 0:pe.totalEncodeTime)!==null&&ps!==void 0?ps:0,total_encoded_bytes_target:(Qs=pe==null?void 0:pe.totalEncodedBytesTarget)!==null&&Qs!==void 0?Qs:0,total_packet_send_delay:(ga=pe==null?void 0:pe.totalPacketSendDelay)!==null&&ga!==void 0?ga:0}})(L,B,H,te,re,K)))}}class wd extends qn{constructor(S,A,O,L,B,H,te,re,K,ae){var he,pe,Ne,Je;super(bn.PUBLISHED_VIDEO_STATS_WINDOW,S,A,!1);const Ye=Math.max(((he=L==null?void 0:L.timestamp)!==null&&he!==void 0?he:0)-((pe=B==null?void 0:B.timestamp)!==null&&pe!==void 0?pe:0),0);Object.assign(this.properties,Object.assign({action:fn.PUBLISH,node:(Ne=O==null?void 0:O.node)!==null&&Ne!==void 0?Ne:"",cluster:(Je=O==null?void 0:O.cluster)!==null&&Je!==void 0?Je:"",window_size_ms:Ye},((Oe,ye,lt,wt,Kt,It,Kn,wn)=>{var _i,zi,ki,xi,yi,Ri,Di,bi,Mi,ui,Tn,$n,$i,Jr,Es,Qr,ds,es,Ir,fr,Wr,ts,ps,Qs,ga,Ss,Ps,dr,Ma,Jn,Gi,Mr,$a,Io,Tc,nl,ms,nc,Ih,Jl,Oa,ho,ko,ic,Md,Od,Wp,$s,Mf,kh,qu,Nl;const pv=(zi=(_i=Oe==null?void 0:Oe.qualityLimitationDurations)===null||_i===void 0?void 0:_i.cpu)!==null&&zi!==void 0?zi:0,gy=(xi=(ki=ye==null?void 0:ye.qualityLimitationDurations)===null||ki===void 0?void 0:ki.cpu)!==null&&xi!==void 0?xi:0,mv=(Ri=(yi=Oe==null?void 0:Oe.qualityLimitationDurations)===null||yi===void 0?void 0:yi.bandwidth)!==null&&Ri!==void 0?Ri:0,Yr=(bi=(Di=ye==null?void 0:ye.qualityLimitationDurations)===null||Di===void 0?void 0:Di.bandwidth)!==null&&bi!==void 0?bi:0,gv=Math.max(((Mi=Oe==null?void 0:Oe.bytesSent)!==null&&Mi!==void 0?Mi:0)-((ui=ye==null?void 0:ye.bytesSent)!==null&&ui!==void 0?ui:0),0),Dh=8*gv/(typeof wn!="number"?1:wn/1e3),E=Math.max(((Tn=lt==null?void 0:lt.packetsLost)!==null&&Tn!==void 0?Tn:0)-(($n=wt==null?void 0:wt.packetsLost)!==null&&$n!==void 0?$n:0),0),w=Math.max((($i=Oe==null?void 0:Oe.packetsSent)!==null&&$i!==void 0?$i:0)-((Jr=ye==null?void 0:ye.packetsSent)!==null&&Jr!==void 0?Jr:0),0),F=E/Math.max(w,1),Q=Pu(It==null?void 0:It.mimeType,It==null?void 0:It.sdpFmtpLine);return{active:!!(Oe!=null&&Oe.framesPerSecond)&&(Oe==null?void 0:Oe.framesPerSecond)!==0,bytes_sent:gv,codec_mime_type:Q==null?void 0:Q.mimeSubtype,codec_profile:Q==null?void 0:Q.profile,codec_level:Q==null?void 0:Q.level,configured_bitrate:Kn==null?void 0:Kn.max_bitrate,connection_bandwidth:(Es=Kt==null?void 0:Kt.availableOutgoingBitrate)!==null&&Es!==void 0?Es:0,encode_bitrate:Dh,encoder_implementation:(Qr=Oe==null?void 0:Oe.encoderImplementation)!==null&&Qr!==void 0?Qr:"unknown",fir_count:Math.max(((ds=Oe==null?void 0:Oe.firCount)!==null&&ds!==void 0?ds:0)-((es=ye==null?void 0:ye.firCount)!==null&&es!==void 0?es:0),0),fraction_packets_lost:F,frame_height:Math.max((Ir=Oe==null?void 0:Oe.frameHeight)!==null&&Ir!==void 0?Ir:0,0),frame_width:Math.max((fr=Oe==null?void 0:Oe.frameWidth)!==null&&fr!==void 0?fr:0,0),frames_encoded:Math.max(((Wr=Oe==null?void 0:Oe.framesEncoded)!==null&&Wr!==void 0?Wr:0)-((ts=ye==null?void 0:ye.framesEncoded)!==null&&ts!==void 0?ts:0),0),frames_per_second:Math.max((ps=Oe==null?void 0:Oe.framesPerSecond)!==null&&ps!==void 0?ps:0,0),frames_sent:Math.max(((Qs=Oe==null?void 0:Oe.framesSent)!==null&&Qs!==void 0?Qs:0)-((ga=ye==null?void 0:ye.framesSent)!==null&&ga!==void 0?ga:0),0),header_bytes_sent:Math.max(((Ss=Oe==null?void 0:Oe.headerBytesSent)!==null&&Ss!==void 0?Ss:0)-((Ps=ye==null?void 0:ye.headerBytesSent)!==null&&Ps!==void 0?Ps:0),0),huge_frames_sent:Math.max(((dr=Oe==null?void 0:Oe.hugeFramesSent)!==null&&dr!==void 0?dr:0)-((Ma=ye==null?void 0:ye.hugeFramesSent)!==null&&Ma!==void 0?Ma:0),0),key_frames_encoded:Math.max(((Jn=Oe==null?void 0:Oe.keyFramesEncoded)!==null&&Jn!==void 0?Jn:0)-((Gi=ye==null?void 0:ye.keyFramesEncoded)!==null&&Gi!==void 0?Gi:0),0),nack_count:Math.max(((Mr=Oe==null?void 0:Oe.nackCount)!==null&&Mr!==void 0?Mr:0)-(($a=ye==null?void 0:ye.nackCount)!==null&&$a!==void 0?$a:0),0),packets_lost:E,packets_sent:w,power_efficient_encoder:(Io=Oe==null?void 0:Oe.powerEfficientEncoder)!==null&&Io!==void 0&&Io,pli_count:Math.max(((Tc=Oe==null?void 0:Oe.pliCount)!==null&&Tc!==void 0?Tc:0)-((nl=ye==null?void 0:ye.pliCount)!==null&&nl!==void 0?nl:0),0),quality_limitation_reason:(ms=Oe==null?void 0:Oe.qualityLimitationReason)!==null&&ms!==void 0?ms:"none",quality_limitation_resolution_changes:Math.max(((nc=Oe==null?void 0:Oe.qualityLimitationResolutionChanges)!==null&&nc!==void 0?nc:0)-((Ih=ye==null?void 0:ye.qualityLimitationResolutionChanges)!==null&&Ih!==void 0?Ih:0),0),quality_limitation_cpu_duration:Math.max(pv-gy,0),quality_limitation_bandwidth_duration:Math.max(mv-Yr,0),retransmitted_bytes_sent:Math.max(((Jl=Oe==null?void 0:Oe.retransmittedBytesSent)!==null&&Jl!==void 0?Jl:0)-((Oa=ye==null?void 0:ye.retransmittedBytesSent)!==null&&Oa!==void 0?Oa:0),0),rid:(ho=Oe==null?void 0:Oe.rid)!==null&&ho!==void 0?ho:"no-rid",retransmitted_packets_sent:Math.max(((ko=Oe==null?void 0:Oe.retransmittedPacketsSent)!==null&&ko!==void 0?ko:0)-((ic=ye==null?void 0:ye.retransmittedPacketsSent)!==null&&ic!==void 0?ic:0),0),scalability_mode:(Md=Oe==null?void 0:Oe.scalabilityMode)!==null&&Md!==void 0?Md:"unknown",target_bitrate:Math.max((Od=Oe==null?void 0:Oe.targetBitrate)!==null&&Od!==void 0?Od:0,0),total_encode_time:Math.max(((Wp=Oe==null?void 0:Oe.totalEncodeTime)!==null&&Wp!==void 0?Wp:0)-(($s=ye==null?void 0:ye.totalEncodeTime)!==null&&$s!==void 0?$s:0),0),total_encoded_bytes_target:Math.max(((Mf=Oe==null?void 0:Oe.totalEncodedBytesTarget)!==null&&Mf!==void 0?Mf:0)-((kh=ye==null?void 0:ye.totalEncodedBytesTarget)!==null&&kh!==void 0?kh:0),0),total_packet_send_delay:Math.max(((qu=Oe==null?void 0:Oe.totalPacketSendDelay)!==null&&qu!==void 0?qu:0)-((Nl=ye==null?void 0:ye.totalPacketSendDelay)!==null&&Nl!==void 0?Nl:0),0)}})(L,B,H,te,re,K,ae,Ye)))}}class YE extends qn{constructor(S,A,O,L,B,H,te,re,K,ae){var he,pe;super(bn.PUBLISHED_AUDIO_STATS,S,A,!1),Object.assign(this.properties,Object.assign({action:fn.PUBLISH,node:(he=O==null?void 0:O.node)!==null&&he!==void 0?he:"",cluster:(pe=O==null?void 0:O.cluster)!==null&&pe!==void 0?pe:""},((Ne,Je,Ye,Oe,ye,lt,wt)=>{var Kt,It,Kn,wn,_i,zi,ki,xi,yi,Ri,Di;const bi=Math.max((Kt=Ne==null?void 0:Ne.bytesSent)!==null&&Kt!==void 0?Kt:0,0),Mi=8*bi/(lt??1),ui=Math.max((It=Je==null?void 0:Je.packetsLost)!==null&&It!==void 0?It:0,0),Tn=Math.max((Kn=Ne==null?void 0:Ne.packetsSent)!==null&&Kn!==void 0?Kn:0,0),$n=ui/Math.max(Tn,1),$i=Pu(Oe==null?void 0:Oe.mimeType,Oe==null?void 0:Oe.sdpFmtpLine);return{audio_nacks_enabled:(wn=wt==null?void 0:wt.audioNacks)!==null&&wn!==void 0&&wn,bytes_sent:bi,codec_mime_type:$i==null?void 0:$i.mimeSubtype,configured_bitrate:(_i=ye==null?void 0:ye.max_audio_bitrate_bps)!==null&&_i!==void 0?_i:0,connection_bandwidth:(zi=Ye==null?void 0:Ye.availableOutgoingBitrate)!==null&&zi!==void 0?zi:0,encode_bitrate:Mi,fraction_packets_lost:$n,header_bytes_sent:(ki=Ne==null?void 0:Ne.headerBytesSent)!==null&&ki!==void 0?ki:0,nack_count:(xi=Ne==null?void 0:Ne.nackCount)!==null&&xi!==void 0?xi:0,packets_lost:ui,packets_sent:Tn,retransmitted_bytes_sent:(yi=Ne==null?void 0:Ne.retransmittedBytesSent)!==null&&yi!==void 0?yi:0,retransmitted_packets_sent:(Ri=Ne==null?void 0:Ne.retransmittedPacketsSent)!==null&&Ri!==void 0?Ri:0,target_bitrate:(Di=Ne==null?void 0:Ne.targetBitrate)!==null&&Di!==void 0?Di:0}})(L,B,H,te,re,K,ae)))}}class Q0 extends qn{constructor(S,A,O,L,B,H,te,re,K,ae,he){var pe,Ne,Je,Ye;super(bn.PUBLISHED_AUDIO_STATS_WINDOW,S,A,!1);const Oe=Math.max(((pe=L==null?void 0:L.timestamp)!==null&&pe!==void 0?pe:0)-((Ne=B==null?void 0:B.timestamp)!==null&&Ne!==void 0?Ne:0),0);Object.assign(this.properties,Object.assign({action:fn.PUBLISH,node:(Je=O==null?void 0:O.node)!==null&&Je!==void 0?Je:"",cluster:(Ye=O==null?void 0:O.cluster)!==null&&Ye!==void 0?Ye:"",window_size_ms:Oe},((ye,lt,wt,Kt,It,Kn,wn,_i,zi)=>{var ki,xi,yi,Ri,Di,bi,Mi,ui,Tn,$n,$i,Jr,Es,Qr,ds,es,Ir,fr,Wr,ts;const ps=Math.max(((ki=ye==null?void 0:ye.bytesSent)!==null&&ki!==void 0?ki:0)-((xi=lt==null?void 0:lt.bytesSent)!==null&&xi!==void 0?xi:0),0),Qs=8*ps/(typeof _i!="number"?1:_i/1e3),ga=Math.max(((yi=wt==null?void 0:wt.packetsLost)!==null&&yi!==void 0?yi:0)-((Ri=Kt==null?void 0:Kt.packetsLost)!==null&&Ri!==void 0?Ri:0),0),Ss=Math.max(((Di=ye==null?void 0:ye.packetsSent)!==null&&Di!==void 0?Di:0)-((bi=lt==null?void 0:lt.packetsSent)!==null&&bi!==void 0?bi:0),0),Ps=ga/Math.max(Ss,1),dr=Pu(Kn==null?void 0:Kn.mimeType,Kn==null?void 0:Kn.sdpFmtpLine);return{audio_nacks_enabled:(Mi=zi==null?void 0:zi.audioNacks)!==null&&Mi!==void 0&&Mi,bytes_sent:ps,codec_mime_type:dr==null?void 0:dr.mimeSubtype,configured_bitrate:(ui=wn==null?void 0:wn.max_audio_bitrate_bps)!==null&&ui!==void 0?ui:0,connection_bandwidth:(Tn=It==null?void 0:It.availableOutgoingBitrate)!==null&&Tn!==void 0?Tn:0,encode_bitrate:Qs,fraction_packets_lost:Ps,header_bytes_sent:Math.max((($n=ye==null?void 0:ye.headerBytesSent)!==null&&$n!==void 0?$n:0)-(($i=lt==null?void 0:lt.headerBytesSent)!==null&&$i!==void 0?$i:0),0),nack_count:Math.max(((Jr=ye==null?void 0:ye.nackCount)!==null&&Jr!==void 0?Jr:0)-((Es=lt==null?void 0:lt.nackCount)!==null&&Es!==void 0?Es:0),0),packets_lost:ga,packets_sent:Math.max(((Qr=ye==null?void 0:ye.packetsSent)!==null&&Qr!==void 0?Qr:0)-((ds=lt==null?void 0:lt.packetsSent)!==null&&ds!==void 0?ds:0),0),retransmitted_bytes_sent:Math.max(((es=ye==null?void 0:ye.retransmittedBytesSent)!==null&&es!==void 0?es:0)-((Ir=lt==null?void 0:lt.retransmittedBytesSent)!==null&&Ir!==void 0?Ir:0),0),retransmitted_packets_sent:Math.max(((fr=ye==null?void 0:ye.retransmittedPacketsSent)!==null&&fr!==void 0?fr:0)-((Wr=lt==null?void 0:lt.retransmittedPacketsSent)!==null&&Wr!==void 0?Wr:0),0),target_bitrate:Math.max((ts=ye==null?void 0:ye.targetBitrate)!==null&&ts!==void 0?ts:0,0)}})(L,B,H,te,re,K,ae,Oe,he)))}}class iy extends qn{constructor(S,A,O,L,B,H,te,re){var K,ae;super(bn.SUBSCRIBED_VIDEO_STATS,S,A,!1),Object.assign(this.properties,Object.assign({action:fn.SUBSCRIBE,node:(K=L==null?void 0:L.node)!==null&&K!==void 0?K:"",cluster:(ae=L==null?void 0:L.cluster)!==null&&ae!==void 0?ae:"",remote_participant_id:O},((he,pe,Ne,Je)=>{var Ye,Oe,ye,lt,wt,Kt,It,Kn,wn,_i,zi,ki,xi,yi,Ri,Di,bi,Mi,ui,Tn,$n,$i,Jr;let Es=0;he!=null&&he.jitterBufferDelay&&(he!=null&&he.jitterBufferEmittedCount)&&he.jitterBufferEmittedCount>0&&(Es=he.jitterBufferDelay/he.jitterBufferEmittedCount);const Qr=Je??1,ds=Math.max((Ye=he==null?void 0:he.bytesReceived)!==null&&Ye!==void 0?Ye:0,0),es=8*ds/Qr;let Ir=0;he!=null&&he.totalDecodeTime&&(he!=null&&he.framesDecoded)&&(Ir=he.totalDecodeTime/Math.max(he==null?void 0:he.framesDecoded,1));const fr=Math.max((Oe=he==null?void 0:he.packetsLost)!==null&&Oe!==void 0?Oe:0,0),Wr=Math.max((ye=he==null?void 0:he.packetsReceived)!==null&&ye!==void 0?ye:0,0),ts=fr/Math.max(Wr+fr,1),ps=Pu(Ne==null?void 0:Ne.mimeType,Ne==null?void 0:Ne.sdpFmtpLine);return{bytes_received:ds,codec_mime_type:ps==null?void 0:ps.mimeSubtype,codec_profile:ps==null?void 0:ps.profile,codec_level:ps==null?void 0:ps.level,connection_bandwidth:(lt=pe==null?void 0:pe.availableIncomingBitrate)!==null&&lt!==void 0?lt:0,decode_bitrate:es,decoder_implementation:(wt=he==null?void 0:he.decoderImplementation)!==null&&wt!==void 0?wt:"unknown",fir_count:Math.max((Kt=he==null?void 0:he.firCount)!==null&&Kt!==void 0?Kt:0,0),fraction_packets_lost:ts,frame_decode_time_avg:Ir,frame_height:Math.max((It=he==null?void 0:he.frameHeight)!==null&&It!==void 0?It:0,0),frame_width:Math.max((Kn=he==null?void 0:he.frameWidth)!==null&&Kn!==void 0?Kn:0,0),frames_decoded:Math.max((wn=he==null?void 0:he.framesDecoded)!==null&&wn!==void 0?wn:0,0),frames_dropped:Math.max((_i=he==null?void 0:he.framesDropped)!==null&&_i!==void 0?_i:0,0),frames_received:Math.max((zi=he==null?void 0:he.framesReceived)!==null&&zi!==void 0?zi:0,0),freeze_count:Math.max((ki=he==null?void 0:he.freezeCount)!==null&&ki!==void 0?ki:0,0),frames_rendered:Math.max((xi=he==null?void 0:he.framesRendered)!==null&&xi!==void 0?xi:0,0),frames_per_second:Math.max((yi=he==null?void 0:he.framesPerSecond)!==null&&yi!==void 0?yi:0,0),header_bytes_received:Math.max((Ri=he==null?void 0:he.headerBytesReceived)!==null&&Ri!==void 0?Ri:0,0),jitter_buffer_delay_avg:Es,key_frames_decoded:Math.max((Di=he==null?void 0:he.keyFramesDecoded)!==null&&Di!==void 0?Di:0,0),nack_count:Math.max((bi=he==null?void 0:he.nackCount)!==null&&bi!==void 0?bi:0,0),packets_discarded:Math.max((Mi=he==null?void 0:he.packetsDiscarded)!==null&&Mi!==void 0?Mi:0,0),packets_lost:fr,packets_received:Wr,pause_count:Math.max((ui=he==null?void 0:he.pauseCount)!==null&&ui!==void 0?ui:0,0),pli_count:Math.max((Tn=he==null?void 0:he.pliCount)!==null&&Tn!==void 0?Tn:0,0),power_efficient_decoder:($n=he==null?void 0:he.powerEfficientDecoder)!==null&&$n!==void 0&&$n,total_freezes_duration:Math.max(($i=he==null?void 0:he.totalFreezesDuration)!==null&&$i!==void 0?$i:0,0),total_pauses_duration:Math.max((Jr=he==null?void 0:he.totalPausesDuration)!==null&&Jr!==void 0?Jr:0,0)}})(B,H,te,re)))}}class XE extends qn{constructor(S,A,O,L,B,H,te,re,K,ae,he){var pe,Ne,Je,Ye;super(bn.SUBSCRIBED_VIDEO_STATS_WINDOW,S,A,!1);const Oe=Math.max(((pe=B==null?void 0:B.timestamp)!==null&&pe!==void 0?pe:0)-((Ne=H==null?void 0:H.timestamp)!==null&&Ne!==void 0?Ne:0),0);Object.assign(this.properties,Object.assign({action:fn.SUBSCRIBE,node:(Je=L==null?void 0:L.node)!==null&&Je!==void 0?Je:"",cluster:(Ye=L==null?void 0:L.cluster)!==null&&Ye!==void 0?Ye:"",window_size_ms:Oe,remote_participant_id:O},((ye,lt,wt,Kt,It,Kn,wn,_i)=>{var zi,ki,xi,yi,Ri,Di,bi,Mi,ui,Tn,$n,$i,Jr,Es,Qr,ds,es,Ir,fr,Wr,ts,ps,Qs,ga,Ss,Ps,dr,Ma,Jn,Gi,Mr,$a,Io,Tc,nl,ms,nc,Ih,Jl,Oa,ho,ko,ic;let Md=0,Od=0;if(ye!=null&&ye.jitterBufferEmittedCount&&(lt!=null&&lt.jitterBufferEmittedCount)&&ye.jitterBufferEmittedCount>lt.jitterBufferEmittedCount){ye!=null&&ye.jitterBufferDelay&&(lt!=null&&lt.jitterBufferDelay)&&(Md=(ye.jitterBufferDelay-lt.jitterBufferDelay)/(ye.jitterBufferEmittedCount-lt.jitterBufferEmittedCount));const Dh=lt==null?void 0:lt.jitterBufferMinimumDelay,E=ye==null?void 0:ye.jitterBufferMinimumDelay;Dh&&E&&(Od=(E-Dh)/(ye.jitterBufferEmittedCount-lt.jitterBufferEmittedCount))}const Wp=Math.max(((zi=ye==null?void 0:ye.bytesReceived)!==null&&zi!==void 0?zi:0)-((ki=lt==null?void 0:lt.bytesReceived)!==null&&ki!==void 0?ki:0),0),$s=typeof It!="number"?1:It/1e3,Mf=8*Wp/$s,kh=Math.max(((xi=ye==null?void 0:ye.totalDecodeTime)!==null&&xi!==void 0?xi:0)-((yi=lt==null?void 0:lt.totalDecodeTime)!==null&&yi!==void 0?yi:0),0),qu=Math.max(((Ri=ye==null?void 0:ye.framesDecoded)!==null&&Ri!==void 0?Ri:0)-((Di=lt==null?void 0:lt.framesDecoded)!==null&&Di!==void 0?Di:0),0),Nl=kh/Math.max(qu,1),pv=Math.max(((bi=ye==null?void 0:ye.packetsLost)!==null&&bi!==void 0?bi:0)-((Mi=lt==null?void 0:lt.packetsLost)!==null&&Mi!==void 0?Mi:0),0),gy=Math.max(((ui=ye==null?void 0:ye.packetsReceived)!==null&&ui!==void 0?ui:0)-((Tn=lt==null?void 0:lt.packetsReceived)!==null&&Tn!==void 0?Tn:0),0),mv=pv/Math.max(gy+pv,1),Yr=Pu(Kt==null?void 0:Kt.mimeType,Kt==null?void 0:Kt.sdpFmtpLine),gv=8*(_i||0)/$s;return{bytes_received:Wp,codec_mime_type:Yr==null?void 0:Yr.mimeSubtype,codec_profile:Yr==null?void 0:Yr.profile,codec_level:Yr==null?void 0:Yr.level,connection_bandwidth:($n=wt==null?void 0:wt.availableIncomingBitrate)!==null&&$n!==void 0?$n:0,decode_bitrate:Mf,decoder_implementation:($i=ye==null?void 0:ye.decoderImplementation)!==null&&$i!==void 0?$i:"unknown",fir_count:Math.max(((Jr=ye==null?void 0:ye.firCount)!==null&&Jr!==void 0?Jr:0)-((Es=lt==null?void 0:lt.firCount)!==null&&Es!==void 0?Es:0),0),fraction_packets_lost:mv,frame_decode_time_avg:Nl,frame_height:Math.max((Qr=ye==null?void 0:ye.frameHeight)!==null&&Qr!==void 0?Qr:0,0),frame_width:Math.max((ds=ye==null?void 0:ye.frameWidth)!==null&&ds!==void 0?ds:0,0),frames_decoded:Math.max(((es=ye==null?void 0:ye.framesDecoded)!==null&&es!==void 0?es:0)-((Ir=lt==null?void 0:lt.framesDecoded)!==null&&Ir!==void 0?Ir:0),0),frames_dropped:Math.max(((fr=ye==null?void 0:ye.framesDropped)!==null&&fr!==void 0?fr:0)-((Wr=lt==null?void 0:lt.framesDropped)!==null&&Wr!==void 0?Wr:0),0),frames_received:Math.max(((ts=ye==null?void 0:ye.framesReceived)!==null&&ts!==void 0?ts:0)-((ps=lt==null?void 0:lt.framesReceived)!==null&&ps!==void 0?ps:0),0),freeze_count:Math.max(((Qs=ye==null?void 0:ye.freezeCount)!==null&&Qs!==void 0?Qs:0)-((ga=lt==null?void 0:lt.freezeCount)!==null&&ga!==void 0?ga:0),0),frames_rendered:Math.max((Ss=ye==null?void 0:ye.framesRendered)!==null&&Ss!==void 0?Ss:0,0),frames_per_second:Math.max((Ps=ye==null?void 0:ye.framesPerSecond)!==null&&Ps!==void 0?Ps:0,0),header_bytes_received:Math.max(((dr=ye==null?void 0:ye.headerBytesReceived)!==null&&dr!==void 0?dr:0)-((Ma=lt==null?void 0:lt.headerBytesReceived)!==null&&Ma!==void 0?Ma:0),0),configured_jitter_buffer_min_delay_ms:Kn??0,jitter_buffer_min_obtainable_delay:Od,jitter_buffer_delay_avg:Md,key_frames_decoded:Math.max(((Jn=ye==null?void 0:ye.keyFramesDecoded)!==null&&Jn!==void 0?Jn:0)-((Gi=lt==null?void 0:lt.keyFramesDecoded)!==null&&Gi!==void 0?Gi:0),0),nack_count:Math.max(((Mr=ye==null?void 0:ye.nackCount)!==null&&Mr!==void 0?Mr:0)-(($a=lt==null?void 0:lt.nackCount)!==null&&$a!==void 0?$a:0),0),packets_discarded:Math.max(((Io=ye==null?void 0:ye.packetsDiscarded)!==null&&Io!==void 0?Io:0)-((Tc=lt==null?void 0:lt.packetsDiscarded)!==null&&Tc!==void 0?Tc:0),0),packets_lost:pv,packets_received:gy,pause_count:Math.max(((nl=ye==null?void 0:ye.pauseCount)!==null&&nl!==void 0?nl:0)-((ms=lt==null?void 0:lt.pauseCount)!==null&&ms!==void 0?ms:0),0),pli_count:Math.max(((nc=ye==null?void 0:ye.pliCount)!==null&&nc!==void 0?nc:0)-((Ih=lt==null?void 0:lt.pliCount)!==null&&Ih!==void 0?Ih:0),0),power_efficient_decoder:(Jl=ye==null?void 0:ye.powerEfficientDecoder)!==null&&Jl!==void 0&&Jl,total_freezes_duration:Math.max(((Oa=ye==null?void 0:ye.totalFreezesDuration)!==null&&Oa!==void 0?Oa:0)-((ho=lt==null?void 0:lt.totalFreezesDuration)!==null&&ho!==void 0?ho:0),0),total_pauses_duration:Math.max(((ko=ye==null?void 0:ye.totalPausesDuration)!==null&&ko!==void 0?ko:0)-((ic=lt==null?void 0:lt.totalPausesDuration)!==null&&ic!==void 0?ic:0),0),sei_read_count:wn,sei_bytes_received:_i,sei_bitrate:gv}})(B,H,te,re,Oe,K,ae,he)))}}class ry extends qn{constructor(S,A,O,L,B,H,te,re,K){var ae,he;super(bn.SUBSCRIBED_AUDIO_STATS,S,A,!1),Object.assign(this.properties,Object.assign({action:fn.SUBSCRIBE,node:(ae=L==null?void 0:L.node)!==null&&ae!==void 0?ae:"",cluster:(he=L==null?void 0:L.cluster)!==null&&he!==void 0?he:"",remote_participant_id:O},((pe,Ne,Je,Ye,Oe)=>{var ye,lt,wt,Kt,It,Kn,wn,_i,zi,ki,xi,yi,Ri,Di,bi,Mi,ui;let Tn=0;pe!=null&&pe.jitterBufferDelay&&(pe!=null&&pe.jitterBufferEmittedCount)&&pe.jitterBufferEmittedCount>0&&(Tn=pe.jitterBufferDelay/pe.jitterBufferEmittedCount);const $n=Ye??1,$i=Math.max((ye=pe==null?void 0:pe.bytesReceived)!==null&&ye!==void 0?ye:0,0),Jr=8*$i/$n,Es=Math.max((lt=pe==null?void 0:pe.packetsLost)!==null&&lt!==void 0?lt:0,0),Qr=Math.max((wt=pe==null?void 0:pe.packetsReceived)!==null&&wt!==void 0?wt:0,0),ds=Es/Math.max(Qr+Es,1),es=Math.max((Kt=pe==null?void 0:pe.concealedSamples)!==null&&Kt!==void 0?Kt:0,0),Ir=Math.max((It=pe==null?void 0:pe.totalSamplesReceived)!==null&&It!==void 0?It:0,0),fr=es/Math.max(Ir,1),Wr=Pu(Je==null?void 0:Je.mimeType,Je==null?void 0:Je.sdpFmtpLine);return{audio_level:(Kn=pe==null?void 0:pe.audioLevel)!==null&&Kn!==void 0?Kn:0,audio_nacks_enabled:(wn=Oe==null?void 0:Oe.audioNacks)!==null&&wn!==void 0&&wn,bytes_received:$i,codec_mime_type:Wr==null?void 0:Wr.mimeSubtype,connection_bandwidth:(_i=Ne==null?void 0:Ne.availableIncomingBitrate)!==null&&_i!==void 0?_i:0,concealed_samples:es,concealment_events:Math.max((zi=pe==null?void 0:pe.concealmentEvents)!==null&&zi!==void 0?zi:0,0),silent_concealed_samples:Math.max((ki=pe==null?void 0:pe.silentConcealedSamples)!==null&&ki!==void 0?ki:0,0),decode_bitrate:Jr,fraction_audio_concealed:fr,fraction_packets_lost:ds,header_bytes_received:Math.max((xi=pe==null?void 0:pe.headerBytesReceived)!==null&&xi!==void 0?xi:0,0),inserted_samples_for_deceleration:Math.max((yi=pe==null?void 0:pe.insertedSamplesForDeceleration)!==null&&yi!==void 0?yi:0,0),jitter_buffer_delay_avg:Tn,packets_discarded:Math.max((Ri=pe==null?void 0:pe.packetsDiscarded)!==null&&Ri!==void 0?Ri:0,0),retransmitted_packets_received:Math.max((Di=pe==null?void 0:pe.retransmittedPacketsReceived)!==null&&Di!==void 0?Di:0,0),retransmitted_bytes_received:Math.max((bi=pe==null?void 0:pe.retransmittedBytesReceived)!==null&&bi!==void 0?bi:0,0),packets_lost:Es,packets_received:Qr,nack_count:Math.max((Mi=pe==null?void 0:pe.nackCount)!==null&&Mi!==void 0?Mi:0,0),removed_samples_for_acceleration:Math.max((ui=pe==null?void 0:pe.removedSamplesForAcceleration)!==null&&ui!==void 0?ui:0,0),total_samples_received:Ir}})(B,H,te,re,K)))}}class qi extends qn{constructor(S,A,O,L,B,H,te,re,K,ae){var he,pe,Ne,Je;super(bn.SUBSCRIBED_AUDIO_STATS_WINDOW,S,A,!1);const Ye=Math.max(((he=B==null?void 0:B.timestamp)!==null&&he!==void 0?he:0)-((pe=H==null?void 0:H.timestamp)!==null&&pe!==void 0?pe:0),0);Object.assign(this.properties,Object.assign({action:fn.SUBSCRIBE,window_size_ms:Ye,node:(Ne=L==null?void 0:L.node)!==null&&Ne!==void 0?Ne:"",cluster:(Je=L==null?void 0:L.cluster)!==null&&Je!==void 0?Je:"",remote_participant_id:O},((Oe,ye,lt,wt,Kt,It,Kn)=>{var wn,_i,zi,ki,xi,yi,Ri,Di,bi,Mi,ui,Tn,$n,$i,Jr,Es,Qr,ds,es,Ir,fr,Wr,ts,ps,Qs,ga,Ss,Ps,dr,Ma,Jn;let Gi=0,Mr=0;if(Oe!=null&&Oe.jitterBufferEmittedCount&&(ye!=null&&ye.jitterBufferEmittedCount)&&Oe.jitterBufferEmittedCount>ye.jitterBufferEmittedCount){Oe!=null&&Oe.jitterBufferDelay&&(ye!=null&&ye.jitterBufferDelay)&&(Gi=(Oe.jitterBufferDelay-ye.jitterBufferDelay)/(Oe.jitterBufferEmittedCount-ye.jitterBufferEmittedCount));const ko=ye==null?void 0:ye.jitterBufferMinimumDelay,ic=Oe==null?void 0:Oe.jitterBufferMinimumDelay;ko&&ic&&(Mr=(ic-ko)/(Oe.jitterBufferEmittedCount-ye.jitterBufferEmittedCount))}const $a=typeof Kt!="number"?1:Kt/1e3,Io=Math.max(((wn=Oe==null?void 0:Oe.bytesReceived)!==null&&wn!==void 0?wn:0)-((_i=ye==null?void 0:ye.bytesReceived)!==null&&_i!==void 0?_i:0),0),Tc=8*Io/$a,nl=Math.max(((zi=Oe==null?void 0:Oe.packetsLost)!==null&&zi!==void 0?zi:0)-((ki=ye==null?void 0:ye.packetsLost)!==null&&ki!==void 0?ki:0),0),ms=Math.max(((xi=Oe==null?void 0:Oe.packetsReceived)!==null&&xi!==void 0?xi:0)-((yi=ye==null?void 0:ye.packetsReceived)!==null&&yi!==void 0?yi:0),0),nc=nl/Math.max(ms+nl,1),Ih=Math.max(((Ri=Oe==null?void 0:Oe.concealedSamples)!==null&&Ri!==void 0?Ri:0)-((Di=ye==null?void 0:ye.concealedSamples)!==null&&Di!==void 0?Di:0),0),Jl=Math.max(((bi=Oe==null?void 0:Oe.totalSamplesReceived)!==null&&bi!==void 0?bi:0)-((Mi=ye==null?void 0:ye.totalSamplesReceived)!==null&&Mi!==void 0?Mi:0),0),Oa=Ih/Math.max(Jl,1),ho=Pu(wt==null?void 0:wt.mimeType,wt==null?void 0:wt.sdpFmtpLine);return{audio_level:(ui=Oe==null?void 0:Oe.audioLevel)!==null&&ui!==void 0?ui:0,audio_nacks_enabled:(Tn=It==null?void 0:It.audioNacks)!==null&&Tn!==void 0&&Tn,bytes_received:Io,codec_mime_type:ho==null?void 0:ho.mimeSubtype,connection_bandwidth:($n=lt==null?void 0:lt.availableIncomingBitrate)!==null&&$n!==void 0?$n:0,decode_bitrate:Tc,concealed_samples:Ih,concealment_events:Math.max((($i=Oe==null?void 0:Oe.concealmentEvents)!==null&&$i!==void 0?$i:0)-((Jr=ye==null?void 0:ye.concealmentEvents)!==null&&Jr!==void 0?Jr:0),0),silent_concealed_samples:Math.max(((Es=Oe==null?void 0:Oe.silentConcealedSamples)!==null&&Es!==void 0?Es:0)-((Qr=ye==null?void 0:ye.silentConcealedSamples)!==null&&Qr!==void 0?Qr:0),0),fraction_audio_concealed:Oa,fraction_packets_lost:nc,header_bytes_received:Math.max(((ds=Oe==null?void 0:Oe.headerBytesReceived)!==null&&ds!==void 0?ds:0)-((es=ye==null?void 0:ye.headerBytesReceived)!==null&&es!==void 0?es:0),0),inserted_samples_for_deceleration:Math.max(((Ir=Oe==null?void 0:Oe.insertedSamplesForDeceleration)!==null&&Ir!==void 0?Ir:0)-((fr=ye==null?void 0:ye.insertedSamplesForDeceleration)!==null&&fr!==void 0?fr:0),0),configured_jitter_buffer_min_delay_ms:Kn??0,jitter_buffer_min_obtainable_delay:Mr,jitter_buffer_delay_avg:Gi,packets_discarded:Math.max(((Wr=Oe==null?void 0:Oe.packetsDiscarded)!==null&&Wr!==void 0?Wr:0)-((ts=ye==null?void 0:ye.packetsDiscarded)!==null&&ts!==void 0?ts:0),0),packets_lost:nl,packets_received:ms,nack_count:Math.max(((ps=Oe==null?void 0:Oe.nackCount)!==null&&ps!==void 0?ps:0)-((Qs=ye==null?void 0:ye.nackCount)!==null&&Qs!==void 0?Qs:0),0),removed_samples_for_acceleration:Math.max(((ga=Oe==null?void 0:Oe.removedSamplesForAcceleration)!==null&&ga!==void 0?ga:0)-((Ss=ye==null?void 0:ye.removedSamplesForAcceleration)!==null&&Ss!==void 0?Ss:0),0),retransmitted_packets_received:Math.max(((Ps=Oe==null?void 0:Oe.retransmittedPacketsReceived)!==null&&Ps!==void 0?Ps:0)-((dr=ye==null?void 0:ye.retransmittedPacketsReceived)!==null&&dr!==void 0?dr:0),0),retransmitted_bytes_received:Math.max(((Ma=Oe==null?void 0:Oe.retransmittedBytesReceived)!==null&&Ma!==void 0?Ma:0)-((Jn=ye==null?void 0:ye.retransmittedBytesReceived)!==null&&Jn!==void 0?Jn:0),0),total_samples_received:Jl}})(B,H,te,re,Ye,K,ae)))}}class ev extends qn{constructor(S,A,O,L,B=fn.PUBLISH,H=!1,te=""){super(bn.SIMULCAST_LAYER_INFO,S,A,!1),Object.assign(this.properties,{rid:O,active:L,selected:H,source:B===fn.PUBLISH?"publisher":"subscriber",remote_participant_id:te})}}class ex extends qn{constructor(S,A,O,L){super(bn.MULTIHOST_CONFIGURATION,S,A,!1),Object.assign(this.properties,Object.assign(Object.assign({},O),{action:L}))}}class Gm extends qn{constructor(S,A,O){super(bn.MULTIHOST_SUBSCRIBE_CONFIGURATION,S,A,!1),Object.assign(this.properties,Object.assign({},O))}}var xf,Vi,Up;(function(N){N.Mobile="mobile",N.Tablet="tablet",N.Desktop="desktop",N.Tv="tv"})(xf||(xf={})),function(N){N.IOS="iOS",N.MacOS="macOS",N.Windows="Windows",N.Android="Android"}(Vi||(Vi={})),function(N){N.Safari="Safari",N.Firefox="Firefox",N.Chrome="Chrome",N.IE="Internet Explorer",N.Edge="Microsoft Edge"}(Up||(Up={}));const hs=function(N){const S=xh(N);return{platform:{isMobile:Bp(xf.Mobile,S),isTablet:Bp(xf.Tablet,S),isDesktop:Bp(xf.Desktop,S),isTv:Bp(xf.Tv,S)},os:{name:Fp(S),version:qm(S),isIOS:wh(Vi.IOS,S),isMacOS:wh(Vi.MacOS,S),isWindows:wh(Vi.Windows,S),isAndroid:wh(Vi.Android,S)},browser:{name:Ch(S),version:el(S),isSafari:zp(Up.Safari,S),isFirefox:zp(Up.Firefox,S),isChrome:zp(Up.Chrome,S),isIE:zp(Up.IE,S),isEdge:zp(Up.Edge,S)}}}(window.navigator.userAgent);function xh(N){try{return Vs.getParser(N||window.navigator.userAgent)}catch{}}function Bp(N,S){return()=>(S||(S=xh()),!(!S||S.getPlatformType(!0)!==N.toLowerCase()))}function qm(N){return()=>(N||(N=xh()),N&&N.getOSVersion()||"")}function Fp(N){return()=>(N||(N=xh()),N&&N.getOSName()||"")}function wh(N,S){return()=>(S||(S=xh()),!(!S||S.getOSName(!0)!==N.toLowerCase()))}function el(N){return()=>(N||(N=xh()),N&&N.getBrowserVersion()||"")}function Ch(N){return()=>(N||(N=xh()),N&&N.getBrowserName()||"")}function zp(N,S){return()=>(S||(S=xh()),!(!S||S.getBrowserName().toLowerCase()!==N.toLowerCase()))}const KE={active:!1,maxBitrate:2e5,rid:"low",maxFramerate:15,scaleResolutionDownBy:4},Lu={width:320,height:180},$m={active:!1,maxBitrate:7e5,rid:"mid",maxFramerate:20,scaleResolutionDownBy:2},tv={width:640,height:360},Hp={active:!1,maxBitrate:17e5,rid:"hi",maxFramerate:30,scaleResolutionDownBy:1},nv={width:1280,height:720};function Uu(N){const{config:S}=N;return[{maxBitrate:S.maxBitrateBps}]}function Ah(N,S){var A,O;const L=S==null?void 0:S.track,B=S==null?void 0:S.config;if(N&&L){const H=(0,fa.cloneDeep)([{encodingParams:KE,targetResolution:Lu},{encodingParams:$m,targetResolution:tv},{encodingParams:Hp,targetResolution:nv}]),{height:te,width:re}=L.getSettings(),K=te&&re?{width:re,height:te}:void 0;for(const pe of H){pe.encodingParams.active=!0;let Ne=1;K&&(Ne=Math.floor(Math.sqrt(K.width*K.height/(pe.targetResolution.width*pe.targetResolution.height))),Ne=Math.max(Ne,1)),pe.encodingParams.scaleResolutionDownBy=Ne}let ae=(A=B==null?void 0:B.maxBitrateBps)!==null&&A!==void 0?A:Hp.maxBitrate;const he=(O=B==null?void 0:B.maxFramerate)!==null&&O!==void 0?O:Hp.maxFramerate;return ae<$m.maxBitrate&&(ae=Hp.maxBitrate),H[2].encodingParams.maxBitrate=ae,H[2].encodingParams.maxFramerate=he,H[2].encodingParams.scaleResolutionDownBy=1,H.map(pe=>pe.encodingParams)}return B?[{maxBitrate:B.maxBitrateBps,maxFramerate:B.maxFramerate}]:[{maxBitrate:ao(Vm),maxFramerate:Ec}]}const QA=1e3;function ao(N){return N*QA}const ZE=(N,...S)=>{const A=S.map(O=>typeof O!="object").filter(Boolean).length>0;if(typeof N=="object"&&!A)return(0,fa.merge)({},N,...S)},vi=N=>Wm(N),Wm=N=>(0,fa.cloneDeep)(N),sy=N=>{switch(N){case Kl.HIGHEST_QUALITY:return"highest";case Kl.LOWEST_QUALITY:default:return"lowest"}};var jp=function(N,S,A,O){return new(A||(A=Promise))(function(L,B){function H(K){try{re(O.next(K))}catch(ae){B(ae)}}function te(K){try{re(O.throw(K))}catch(ae){B(ae)}}function re(K){var ae;K.done?L(K.value):(ae=K.value,ae instanceof A?ae:new A(function(he){he(ae)})).then(H,te)}re((O=O.apply(N,[])).next())})};const wf="no-rid";class iv{constructor(S,A,O,L,B,H){this.analyticsTracker=B,this.receiveVideoTransformer=H,this.simulcastEnabled=!1,this.simulcastState={low:!1,mid:!1,hi:!1},this.sdp=new jr(""),this.sdpFeatures={audioNacks:!1},this.multihostConfiguration=iv.defaultMultihostConfiguration(),this.prevOutboundVideoStats=new Map,this.prevInboundVideoStats=new Map,this.prevRemoteInboundStats=new Map,this.sfuResource={node:"",cluster:""},this.connectionStartedTimestamp=Date.now(),this.prevVideoReceiverTransformerStats={seiReadCnt:0,seiBytesRead:0},this.onPeerConnectionStateChange=()=>{switch(this.getConnectionState()){case at.CONNECTED:this.connectionStartedTimestamp=Date.now(),this.setupIntervals();break;case at.FAILED:this.flushStats()}},this.action=S,this.token=A,this.traceId=O,this.identifier=L}static defaultMultihostConfiguration(){return{video_codec:"unknown",width:0,height:0,max_bitrate:0,min_bitrate:0,target_fps:0,echo_cancellation:!1,auto_gain:!1,noise_suppression:!1,enable_simulcast:!1,max_audio_bitrate_bps:ao(or)}}set sdpAnswer(S){try{this.sdp=new jr(S),this.sdpFeatures.audioNacks=this.sdp.hasAudioNacksEnabled()}catch{}}start(S,A=!1){this.peerConnection=S,this.simulcastEnabled=A,this.prevOutboundAudioStats=void 0,this.prevOutboundVideoStats=new Map,this.prevRemoteInboundStats=new Map,this.peerConnection.addEventListener("connectionstatechange",this.onPeerConnectionStateChange)}stop(){var S;clearInterval(this.uploadStatsInterval),this.uploadStatsInterval=void 0,(S=this.peerConnection)===null||S===void 0||S.removeEventListener("connectionstatechange",this.onPeerConnectionStateChange)}updateSfuResource(S){this.sfuResource=S}updateMultihostConfiguration(S,A){var O,L,B,H,te,re;return jp(this,void 0,void 0,function*(){if(this.action!==fn.PUBLISH||!this.peerConnection)return;const K=iv.defaultMultihostConfiguration();if(A){const ae=this.peerConnection.getSenders().filter(pe=>pe.track!==null&&pe.track.kind==="video");ae.length>0&&(yield ae[0].getStats()).forEach(pe=>{pe.type==="codec"&&(K.video_codec=pe.mimeType)});const he=A.track.getSettings();K.width=(O=he.width)!==null&&O!==void 0?O:0,K.height=(L=he.height)!==null&&L!==void 0?L:0,K.target_fps=(B=he.frameRate)!==null&&B!==void 0?B:0,A.config?(K.max_bitrate=A.config.maxBitrateBps,K.min_bitrate=A.config.minBitrateBps,K.enable_simulcast=A.config.simulcastEnabled):(K.max_bitrate=ao(Vm),K.min_bitrate=ao(jm),K.enable_simulcast=!1)}if(S){const ae=S.track.getSettings();K.auto_gain=(H=ae.autoGainControl)!==null&&H!==void 0&&H,K.echo_cancellation=(te=ae.echoCancellation)!==null&&te!==void 0&&te,K.noise_suppression=(re=ae.noiseSuppression)!==null&&re!==void 0&&re,K.max_audio_bitrate_bps=S.config.maxBitrateBps,K.stereo=S.config.stereo}(0,fa.isEqual)(K,this.multihostConfiguration)||(this.analyticsTracker.trackEventNoSharedProps(new ex(this.token,this.traceId,K,this.action)),this.multihostConfiguration=K)})}updateJitterBufferMinDelay(S){this.jitterBufferMinDelayInMs=S}setupIntervals(){this.action===fn.PUBLISH&&this.simulcastEnabled&&!this.pollSimulcastLayerInterval&&(this.pollSimulcastLayers(),this.pollSimulcastLayerInterval=this.startInterval(this.pollSimulcastLayers,5e3)),this.uploadStatsInterval||(this.uploadStats(),this.uploadStatsInterval=this.startInterval(this.uploadStats,1e4))}startInterval(S,A){return setInterval(S.bind(this),A)}getConnectionState(){var S;if(!this.peerConnection)return at.NONE;const A=(S=this.peerConnection.connectionState)!==null&&S!==void 0?S:this.peerConnection.iceConnectionState;try{return VE(A)}catch{return at.IDLE}}pollSimulcastLayers(){var S;return jp(this,void 0,void 0,function*(){if(this.getConnectionState()===at.CONNECTED){const A=yield(S=this.peerConnection)===null||S===void 0?void 0:S.getStats();if(!A)return;A.forEach(O=>{var L;if(O.type==="outbound-rtp"){const B=((L=O.framesPerSecond)!==null&&L!==void 0?L:0)!==0;switch(O.rid){case"low":B!==this.simulcastState.low&&(this.simulcastState.low=B,this.analyticsTracker.trackEventNoSharedProps(new ev(this.token,this.traceId,O.rid,B)));break;case"mid":B!==this.simulcastState.mid&&(this.simulcastState.mid=B,this.analyticsTracker.trackEventNoSharedProps(new ev(this.token,this.traceId,O.rid,B)));break;case"hi":B!==this.simulcastState.hi&&(this.simulcastState.hi=B,this.analyticsTracker.trackEventNoSharedProps(new ev(this.token,this.traceId,O.rid,B)))}}})}})}flushStats(){var S;return jp(this,void 0,void 0,function*(){const A=yield(S=this.peerConnection)===null||S===void 0?void 0:S.getStats();A&&(this.action===fn.PUBLISH?this.uploadPublisherStats(A):this.action===fn.SUBSCRIBE&&this.uploadSubscriberStats(A))})}uploadStats(){var S;return jp(this,void 0,void 0,function*(){if(this.getConnectionState()===at.CONNECTED){const A=yield(S=this.peerConnection)===null||S===void 0?void 0:S.getStats();if(!A)return;this.action===fn.PUBLISH?this.uploadPublisherStats(A):this.action===fn.SUBSCRIBE&&this.uploadSubscriberStats(A)}})}uploadPublisherStats(S){const A={audio:{},video:[]},O=new Map,L=(Date.now()-this.connectionStartedTimestamp)/1e3,B=Object.assign({},this.multihostConfiguration);S.forEach(H=>{if(H.type==="outbound-rtp"){const te=S.get(H.remoteId),re=this.prevRemoteInboundStats.get(H.remoteId);switch(te&&this.prevRemoteInboundStats.set(te.id,te),H.kind){case"audio":A.audio=this.updateOutboundAudio(H),A.audio.remoteInbound=te,A.audio.prevRemoteInbound=re,A.audio.codec=O.get(H.codecId);break;case"video":A.video.push(Object.assign({},this.updateOutboundVideo(H),{remoteInbound:te,prevRemoteInbound:re,codec:O.get(H.codecId)}))}}H.type==="candidate-pair"&&H.nominated&&(A.candidatePair=H),H.type==="codec"&&O.set(H.id,H)}),this.analyticsTracker.trackEventNoSharedProps(new YE(this.token,this.traceId,this.sfuResource,A.audio.outbound,A.audio.remoteInbound,A.candidatePair,A.audio.codec,B,L,this.sdpFeatures)),A.audio.prevOutbound&&this.analyticsTracker.trackEventNoSharedProps(new Q0(this.token,this.traceId,this.sfuResource,A.audio.outbound,A.audio.prevOutbound,A.audio.remoteInbound,A.audio.prevRemoteInbound,A.candidatePair,A.audio.codec,B,this.sdpFeatures)),A.video.forEach(H=>{this.analyticsTracker.trackEventNoSharedProps(new J0(this.token,this.traceId,this.sfuResource,H.outbound,H.remoteInbound,A.candidatePair,H.codec,B,L)),H.prevOutbound&&this.analyticsTracker.trackEventNoSharedProps(new wd(this.token,this.traceId,this.sfuResource,H.outbound,H.prevOutbound,H.remoteInbound,H.prevRemoteInbound,A.candidatePair,H.codec,B))})}uploadSubscriberStats(S){var A;const O={audio:{},video:{}},L=new Map,B=(Date.now()-this.connectionStartedTimestamp)/1e3,H=(A=this.jitterBufferMinDelayInMs)!==null&&A!==void 0?A:0,{seiReadCnt:te,seiBytesRead:re}=this.updateAndDiffSinceLastUpdate(this.receiveVideoTransformer.getReceiverStats());S.forEach(K=>{if(K.type==="inbound-rtp")switch(K.kind){case"audio":O.audio=this.updateInboundAudio(K),O.audio.codec=L.get(K.codecId);break;case"video":O.video=this.updateInboundVideo(K),O.video.codec=L.get(K.codecId)}K.type==="candidate-pair"&&K.nominated&&(O.candidatePair=K),K.type==="codec"&&L.set(K.id,K)}),this.analyticsTracker.trackEventNoSharedProps(new ry(this.token,this.traceId,this.identifier,this.sfuResource,O.audio.inbound,O.candidatePair,O.audio.codec,B,this.sdpFeatures)),O.audio.prevInbound&&this.analyticsTracker.trackEventNoSharedProps(new qi(this.token,this.traceId,this.identifier,this.sfuResource,O.audio.inbound,O.audio.prevInbound,O.candidatePair,O.audio.codec,this.sdpFeatures,H)),this.analyticsTracker.trackEventNoSharedProps(new iy(this.token,this.traceId,this.identifier,this.sfuResource,O.video.inbound,O.candidatePair,O.video.codec,B)),O.video.prevInbound&&this.analyticsTracker.trackEventNoSharedProps(new XE(this.token,this.traceId,this.identifier,this.sfuResource,O.video.inbound,O.video.prevInbound,O.candidatePair,O.video.codec,H,te,re))}updateAndDiffSinceLastUpdate(S){const A=this.prevVideoReceiverTransformerStats,O=S.seiReadCnt-A.seiReadCnt,L=S.seiBytesRead-A.seiBytesRead;return this.prevVideoReceiverTransformerStats={seiReadCnt:S.seiReadCnt,seiBytesRead:S.seiBytesRead},{seiReadCnt:O,seiBytesRead:L}}updateOutboundAudio(S){const A=S,O=this.prevOutboundAudioStats,L=S.id===(O==null?void 0:O.id)?O:void 0;return this.prevOutboundAudioStats=S,{outbound:A,prevOutbound:L}}updateInboundAudio(S){const A=S,O=this.prevInboundAudioStats,L=S.id===(O==null?void 0:O.id)?O:void 0;return this.prevInboundAudioStats=S,{inbound:A,prevInbound:L}}updateInboundVideo(S){const A=S,O=this.prevInboundVideoStats.get(wf),L=S.id===(O==null?void 0:O.id)?O:void 0;return this.prevInboundVideoStats.set(wf,S),{inbound:A,prevInbound:L}}updateOutboundVideo(S){const A=S,O=this.getPrevOutboundVideo(S),L=S.id===(O==null?void 0:O.id)?O:void 0;return this.setPrevVideoStat(S),{outbound:A,prevOutbound:L}}getPrevOutboundVideo(S){return this.simulcastEnabled&&S.rid&&this.prevOutboundVideoStats.has(S.rid)?this.prevOutboundVideoStats.get(S.rid):!this.simulcastEnabled&&this.prevOutboundVideoStats.has(wf)?this.prevOutboundVideoStats.get(wf):void 0}setPrevVideoStat(S){this.simulcastEnabled&&S.rid?this.prevOutboundVideoStats.set(S.rid,S):this.simulcastEnabled||this.prevOutboundVideoStats.set(wf,S)}}class Sc extends qn{constructor(S,A,O,L,B){super(bn.MINUTE,S,A,!1),Object.assign(this.properties,{action:L?fn.PUBLISH:fn.SUBSCRIBE,is_publishing:L,minutes_logged:O,subscribed_number:B})}}class Bu extends qn{constructor(S){super(bn.PUBLISH,S.token,S.traceId,!1),Object.assign(this.properties,{action:fn.PUBLISH,remote_participant_id:S.token.participantID})}}class Cd extends qn{constructor(S){super(bn.UNPUBLISH,S.token,S.traceId,!0),Object.assign(this.properties,{action:fn.PUBLISH,remote_participant_id:S.token.participantID})}}class Ym extends qn{constructor(S){var A,O,L,B;super(bn.SUBSCRIBE,S.token,S.traceId,!1),Object.assign(this.properties,{action:fn.SUBSCRIBE,remote_participant_id:S.subscribedId,subscribed_id:S.subscribedId,is_edp_connected:S.isEdpConnected,is_reassignment:S.isReassignment,node:(O=(A=S.preAttemptSfuResource)===null||A===void 0?void 0:A.node)!==null&&O!==void 0?O:"",cluster:(B=(L=S.preAttemptSfuResource)===null||L===void 0?void 0:L.cluster)!==null&&B!==void 0?B:""})}}class tx extends qn{constructor(S){super(bn.UNSUBSCRIBE,S.token,S.traceId,!0),Object.assign(this.properties,{action:fn.SUBSCRIBE,remote_participant_id:S.unsubscribedId,unsubscribed_id:S.unsubscribedId})}}class nx extends qn{constructor(S){var A,O,L,B;super(bn.PUBLISH_STARTED,S.token,S.traceId,!1),Object.assign(this.properties,{action:fn.PUBLISH,options_duration:S.optionsDuration,post_duration:S.postDuration,remote_participant_id:S.token.participantID,time_to_candidate:S.timeToCandidate,total_duration:S.totalDuration,edp_initial_connect_duration:S.edpInitialConnectDuration,edp_initial_connect_retry_times:S.edpInitialConnectRetries,edp_initial_state_duration:S.edpInitialStateDuration,edp_state_update_count:S.edpStateUpdateCount,sdp_exchange_duration:S.sdpExchangeDuration,sdp_exchange_transport:S.sdpExchangeTransport,set_remote_desc_duration:S.setRemoteDescDuration,peer_connection_duration:S.peerConnectionDuration,node:(O=(A=S.sfuResource)===null||A===void 0?void 0:A.node)!==null&&O!==void 0?O:"",cluster:(B=(L=S.sfuResource)===null||L===void 0?void 0:L.cluster)!==null&&B!==void 0?B:"",publish_retry_times:S.publishRetries,total_duration_with_retries:S.totalDurationWithRetries})}}class ix extends qn{constructor(S){super(bn.PUBLISH_FAILED,S.token,S.traceId,!1),Object.assign(this.properties,{action:fn.PUBLISH,code:S.code,message:S.message,fatal:S.fatal,nominal:S.nominal})}}class Vp extends qn{constructor(S){super(bn.PUBLISH_ENDED,S.token,S.traceId,!0),Object.assign(this.properties,{action:fn.PUBLISH,remote_participant_id:S.token.participantID,unpublish_successful:S.isUnpublishSuccessful,reason:S.reason})}}class Gp extends qn{constructor(S){var A,O,L,B;super(bn.SUBSCRIBE_STARTED,S.token,S.traceId,!1),Object.assign(this.properties,{action:fn.SUBSCRIBE,options_duration:S.optionsDuration,post_duration:S.postDuration,remote_participant_id:S.remoteParticipantId,time_to_candidate:S.timeToCandidate,total_duration:S.totalDuration,edp_initial_connect_duration:S.edpInitialConnectDuration,edp_initial_connect_retry_times:S.edpInitialConnectRetries,edp_initial_state_duration:S.edpInitialStateDuration,edp_initial_state_publishing_count:S.edpInitialStatePublishingCount,edp_state_update_count:S.edpStateUpdateCount,sdp_exchange_duration:S.sdpExchangeDuration,sdp_exchange_transport:S.sdpExchangeTransport,set_remote_desc_duration:S.setRemoteDescDuration,peer_connection_duration:S.peerConnectionDuration,node:(O=(A=S.sfuResource)===null||A===void 0?void 0:A.node)!==null&&O!==void 0?O:"",cluster:(B=(L=S.sfuResource)===null||L===void 0?void 0:L.cluster)!==null&&B!==void 0?B:"",total_duration_with_retries:S.totalDurationWithRetries,subscribe_retry_times:S.subscribeRetryTimes,is_reassignment:S.isReassignment})}}class JE extends qn{constructor(S){super(bn.SUBSCRIBE_FAILED,S.token,S.traceId,!1),Object.assign(this.properties,{action:fn.SUBSCRIBE,remote_participant_id:S.remoteParticipantId,code:S.code,message:S.message,fatal:S.fatal,nominal:S.nominal,is_reassignment:S.isReassignment})}}class Xm extends qn{constructor(S){super(bn.SUBSCRIBE_ENDED,S.token,S.traceId,!0),Object.assign(this.properties,{action:fn.SUBSCRIBE,remote_participant_id:S.remoteParticipantId,unsubscribe_successful:S.isUnsubscribeSuccessful,reason:S.reason}),this.critical=!0}}class rv extends qn{constructor(S){super(bn.STATE_UPDATED,S.token,S.traceId,!1),Object.assign(this.properties,{audio_muted:S.isAudioMuted,is_disconnected:S.isDisconnected,is_publishing:S.isPublishing,other_participant_id:S.otherParticipantId,other_participant_user_id:S.otherParticipantUserId,video_stopped:S.isVideoStopped})}}class rx extends qn{constructor(S){var A,O,L,B,H;super(bn.FIRST_FRAME,S.token,S.traceId,!1),Object.assign(this.properties,{action:fn.SUBSCRIBE,remote_participant_id:S.remoteParticipantId,edp_initial_connect_duration:S.edpInitialConnectDuration,edp_initial_connect_retry_times:S.edpInitialConnectRetries,edp_initial_state_duration:S.edpInitialStateDuration,edp_initial_state_publishing_count:S.edpInitialStatePublishingCount,edp_state_update_count:S.edpStateUpdateCount,sdp_exchange_duration:S.sdpExchangeDuration,sdp_exchange_transport:S.sdpExchangeTransport,set_remote_desc_duration:S.setRemoteDescDuration,peer_connection_duration:S.peerConnectionDuration,node:(O=(A=S.sfuResource)===null||A===void 0?void 0:A.node)!==null&&O!==void 0?O:"",cluster:(B=(L=S.sfuResource)===null||L===void 0?void 0:L.cluster)!==null&&B!==void 0?B:"",video_was_paused:S.videoWasPaused,first_frame_duration:S.firstFrameDuration,total_duration_with_retries:S.totalDurationWithRetries,subscribe_retry_times:S.subscribeRetryTimes,media_type:S.mediaType,configured_jitter_buffer_min_delay_ms:(H=S.currentJitterBufferMinDelayInMs)!==null&&H!==void 0?H:0})}}class ay extends qn{constructor(S){super(bn.EDP_PONG,S.token,S.traceId,!1),Object.assign(this.properties,{event_endpoint:S.eventEndpoint,protocol:S.protocol,edp_rtt:S.edpRttMs})}}class sv extends qn{constructor(S){super(bn.JOIN,S.token,S.traceId,!1),Object.assign(this.properties,{action:fn.JOIN,event_endpoint:S.eventEndpoint,whip_endpoint:S.whipEndpoint})}}class Zl extends qn{constructor(S){super(bn.JOIN_ATTEMPT,S.token,S.traceId,!1),Object.assign(this.properties,{action:fn.JOIN,event_endpoint:S.eventEndpoint,whip_endpoint:S.whipEndpoint})}}class Mo extends qn{constructor(S){super(bn.JOIN_ATTEMPT_FAILED,S.token,S.traceId,!1),Object.assign(this.properties,{action:fn.JOIN,event_endpoint:S.eventEndpoint,whip_endpoint:S.whipEndpoint,code:S.code,message:S.message,fatal:S.fatal,nominal:S.nominal,connect_retry_times:S.retryCnt})}}class Fu extends qn{constructor(S){super(bn.EDP_DISCONNECTED,S.token,S.traceId,!1),Object.assign(this.properties,{event_endpoint:S.eventEndpoint,protocol:S.protocol}),this.critical=!0}}class Al extends qn{constructor(S){super(bn.EDP_CONNECTED,S.token,S.traceId,!1),Object.assign(this.properties,{event_endpoint:S.eventEndpoint,protocol:S.protocol,connect_retry_times:S.numRetries}),this.critical=!0}}var av;(function(N){N.MESSAGE="message",N.RESPONSE="response"})(av||(av={}));class eR{constructor(S,A,O){this.token=S,this.analyticsTracker=O,this.protocol="",this.connecting=!1,this.closing=!1,this.windowUnloading=!1,this.latestPingTimestamp=0,this.pongCount=0,this.latestSequenceNumber=0,this.nextConnectionAttempt=0,this.pingInterval=0,this.pongTimeout=0,this.connectTimeout=0,this.beforeUnload=()=>{this.emitter.emit(Nu,"beforeunload"),this.windowUnloading=!0},this.sendSdpOffer=(L,B,H,te,re,K,ae,he)=>{var pe;const Ne={type:"aws:ivs:SDP_OFFER",payload:{whipUrl:B,requestId:te,traceId:H,platform:"web",sdk:"1.19.0",whipVersion:bc,content:L,contentType:"application/sdp"}};re&&(Ne.payload.forceNode=re),K&&(Ne.payload.assignmentToken=K),ae&&(Ne.payload.multiCodec=ae);const Je=O0()===void 0,Ye=O0()||Je;he&&Ye&&(Ne.payload.initialLayerPref=sy(he)),(pe=this.socket)===null||pe===void 0||pe.send(JSON.stringify(Ne))},this.getRetryCount=()=>Math.max(this.connectionAttempts-1,0),this.trackJoinEnded=()=>{this.analyticsTracker.trackEventNoSharedProps(new Fu({token:this.token,eventEndpoint:this.token.eventsURL,traceId:this.traceId,protocol:this.protocol}))},this.logger=new ro(A,me.SOCKET),this.emitter=new io.EventEmitter,this.connectionAttempts=0,this.sentPing=!1,this.receivedPong=!1,this.traceId=gc(),this.id=`[${Ca().value}] `,window.addEventListener("beforeunload",this.beforeUnload)}connect(S,A,O=!1){this.logger.debug({msg:`${this.id}connecting to ${this.addr}`}),this.addr=S,this.traceId=A,O&&!this.connecting&&(window.clearTimeout(this.connectTimeout),this.connectTimeout=window.setTimeout(this.connectTimedOut.bind(this),1e4)),this.attemptConnect(A)}attemptConnect(S){this.traceId=S||gc(),this.connectionAttempts++,this.trackJoinAttempt(this.connectionAttempts);const{topic:A,rawToken:O}=this.token;this.connecting=!0,this.closing=!1;try{const L=encodeURIComponent(this.traceId.value);this.socket=this.createWebSocket(`${this.addr}?topic=${A}/publishers&traceid=${L}`,O),this.socket.onmessage=this.onMessage.bind(this),this.socket.onerror=this.onError.bind(this),this.socket.onclose=this.onClose.bind(this),this.socket.onopen=this.onOpen.bind(this),this.protocol=this.socket.protocol}catch(L){const B=L instanceof Error?L.message:void 0,H=this.createError(Bt.EVENT_PLANE_WS_CREATE_FAILED,B);this.trackJoinFailed(H,this.getRetryCount()),this.emitter.emit(Xl,H)}}send(S){var A;this.logger.debug({msg:`${this.id}sending ${JSON.stringify(S)}`}),this.isReady()?(A=this.socket)===null||A===void 0||A.send(JSON.stringify(S)):this.logger.warn({msg:"Trying to send data over stage socket that is not ready"})}close(){this.logger.debug({msg:`${this.id}closing`});const S=this.connecting,A=this.socket&&this.socket.readyState===this.socket.OPEN,O=this.socket&&this.socket.readyState===this.socket.CLOSING,L=this.getRetryCount();if(this.closing=!0,this.connecting=!1,this.cleanPingPongTimeouts(),window.clearTimeout(this.nextConnectionAttempt),window.clearTimeout(this.connectTimeout),this.connectionAttempts=0,this.connectTimeout=0,this.socket){if(this.socket.close(),this.socket.onmessage=null,this.socket.onerror=null,this.socket.onclose=null,this.socket.onopen=null,A)this.trackJoinEnded(),this.emitter.emit(Nu,"intentional-close");else if(S&&!O){const B=this.createError(Bt.OPERATION_ABORTED);this.trackJoinFailed(B,L),this.analyticsTracker.trackError(B),this.emitter.emit(Xl,B)}}}removeAllListeners(){window.removeEventListener("beforeunload",this.beforeUnload),this.emitter.removeAllListeners()}createWebSocket(S,A){return new WebSocket(S,A)}createError(S,A){return new Ii(Object.assign({action:fn.JOIN,traceId:this.traceId,token:this.token,location:"StageSocket.connection",tag:vc.JOIN_RELATED,details:A},S))}on(S,A){this.emitter.on(S,A)}off(S,A){this.emitter.off(S,A)}isReady(){return this.logger.debug({msg:`${this.id}isReady called`}),!!this.socket&&this.socket.readyState===this.socket.OPEN}onMessage(S){this.logger.debug({msg:`${this.id}received message: ${S.data}`});try{const A=JSON.parse(S.data);switch(A.type){case"STAGE_STATE":case"aws:ivs:STAGE_STATE":{const O=A.payload.sequenceNumber;O>this.latestSequenceNumber&&(this.latestSequenceNumber===0&&M0()&&this.connectTimeout>0&&this.triggerSocketOpen(A),this.emitter.emit(Q_,A),this.latestSequenceNumber=O);break}case"PONG":this.receivedPong=!0,this.pongCount%2==0&&this.analyticsTracker.trackEventNoSharedProps(new ay({token:this.token,eventEndpoint:this.token.eventsURL,protocol:this.protocol,traceId:this.traceId,edpRttMs:performance.now()-this.latestPingTimestamp})),this.pongCount++;break;case"REFRESH":this.emitter.emit(J_);break;case"aws:ivs:SDP_ANSWER":this.emitter.emit(V0,A.payload);break;case"aws:ivs:DISCONNECT":this.emitter.emit(G0,A.payload);break;case"aws:ivs:REASSIGN":this.emitter.emit(Td,A.payload);break;case"aws:ivs:INCOMPATIBLE_CODECS":this.emitter.emit(Ro,A.payload);break;default:(0,fa.noop)()}}catch(A){this.logger.debug({msg:`onMessage JSON Parse error: ${A}`}),this.emitter.emit(yc,A)}}onError(S){this.logger.debug({msg:`${this.id}error: ${JSON.stringify(S)}`})}onClose(S){if(this.logger.debug({msg:`${this.id}onClose triggered with code (closing = ${this.closing}, connecting = ${this.connecting})`}),this.cleanPingPongTimeouts(),this.closing)this.closing=!1;else if(!this.windowUnloading)if(this.connecting){let A=Math.pow(2,this.connectionAttempts-1);A>64&&(A=64),this.logger.debug({msg:`${this.id}reconnecting in ${A} seconds`}),window.clearTimeout(this.nextConnectionAttempt),this.nextConnectionAttempt=window.setTimeout(this.attemptConnect.bind(this),1e3*A);const O=this.createError(Bt.EVENT_PLANE_WS_CLOSE_BEFORE_OPEN,`code: ${S==null?void 0:S.code}, reason: ${S==null?void 0:S.reason}, wasClean: ${S==null?void 0:S.wasClean}`);this.trackJoinFailed(O,this.getRetryCount()),this.analyticsTracker.trackError(O)}else{this.logger.debug({msg:`${this.id}unexpected close`}),this.emitter.emit(Nu,"unknown");const A=this.createError(Bt.EVENT_PLANE_WS_UNEXPECTED_CLOSE,`code: ${S==null?void 0:S.code}, reason: ${S==null?void 0:S.reason}, wasClean: ${S==null?void 0:S.wasClean}`);this.trackJoinEnded(),this.emitter.emit(Xl,A)}}onOpen(){this.logger.debug({msg:`${this.id} socket opened`}),this.clearConnectionAttemptTimeouts(),M0()?this.connectTimeout=window.setTimeout(()=>{this.triggerSocketOpen()},1e4):this.triggerSocketOpen()}clearConnectionAttemptTimeouts(){window.clearTimeout(this.nextConnectionAttempt),window.clearTimeout(this.connectTimeout),this.nextConnectionAttempt=0,this.connectTimeout=0}triggerSocketOpen(S){this.clearConnectionAttemptTimeouts();const A=this.getRetryCount();this.connectionAttempts=0,this.connecting=!1,this.trackJoinStarted(),this.emitter.emit(Qc,{retryCnt:A,traceId:this.traceId,initialStageState:S}),this.pingInterval=window.setInterval(this.ping.bind(this),3e4)}ping(){var S;this.logger.debug({msg:`${this.id}sending PING`});try{this.latestPingTimestamp=performance.now(),(S=this.socket)===null||S===void 0||S.send(JSON.stringify({type:"PING"})),this.sentPing=!0,this.receivedPong=!1,this.pongTimeout&&clearTimeout(this.pongTimeout),this.pongTimeout=window.setTimeout(this.pongTimedOut.bind(this),5e3)}catch(A){const O=A instanceof Error?A.message:void 0,L=this.createError(Bt.EVENT_PLANE_PING_SEND_FAIL,O);this.emitter.emit(Xl,L)}}connectTimedOut(){const S=this.socket&&this.socket.readyState===this.socket.CONNECTING;this.connecting=!1,this.logger.debug({msg:`${this.id}Connect timed out!`});const A=this.createError(Bt.JOIN_TIMED_OUT);S&&this.trackJoinFailed(A,this.getRetryCount()),this.createError(Bt.JOIN_TIMED_OUT),this.emitter.emit(Xl,A),this.close()}pongTimedOut(){if(this.sentPing&&!this.receivedPong){this.logger.debug({msg:`${this.id}Pong timed out!`});const S=this.createError(Bt.EVENT_PLANE_PONG_TIMEOUT);this.emitter.emit(Xl,S)}}cleanPingPongTimeouts(){this.sentPing=this.receivedPong=!1,window.clearTimeout(this.pongTimeout),window.clearInterval(this.pingInterval)}trackJoinAttempt(S){const{token:A,traceId:O}=this;this.analyticsTracker.trackEvent(new Zl({token:A,eventEndpoint:(A==null?void 0:A.eventsURL)||"",whipEndpoint:(A==null?void 0:A.whipURL)||"",traceId:O}))}trackJoinFailed(S,A){const{token:O,traceId:L,code:B,message:H,fatal:te,nominal:re}=S;this.analyticsTracker.trackEvent(new Mo({token:O,eventEndpoint:O.eventsURL,whipEndpoint:O.whipURL,traceId:L,code:B,message:H,fatal:te,nominal:re,retryCnt:A}))}trackJoinStarted(){this.analyticsTracker.trackEventNoSharedProps(new Al({token:this.token,eventEndpoint:this.token.eventsURL,numRetries:this.getRetryCount(),protocol:this.protocol,traceId:this.traceId}))}}var Ko=function(N,S,A,O){return new(A||(A=Promise))(function(L,B){function H(K){try{re(O.next(K))}catch(ae){B(ae)}}function te(K){try{re(O.throw(K))}catch(ae){B(ae)}}function re(K){var ae;K.done?L(K.value):(ae=K.value,ae instanceof A?ae:new A(function(he){he(ae)})).then(H,te)}re((O=O.apply(N,[])).next())})},oo,zu,Rl,fs;(function(N){N.SDP_EXCHANGE="xdp",N.JITTER_BUFFER_MIN_DELAY_MS="jit_buf_min_delay_ms"})(oo||(oo={})),function(N){N.USER_INITIATED="user-initiated",N.CLIENT_RECONNECT="reconnect",N.TOKEN_REUSED="token-reused",N.UNKNOWN="unknown",N.PARTICIPANT_DISCONNECTED="participant-disconnected",N.STAGE_DELETED="stage-deleted"}(zu||(zu={})),function(N){N[N.NOT_CONNECTED=0]="NOT_CONNECTED",N[N.CONNECTION_LOST=1]="CONNECTION_LOST",N[N.TIMEDOUT=2]="TIMEDOUT",N[N.ABORTED=3]="ABORTED",N[N.INVALID_MESSAGE=4]="INVALID_MESSAGE",N[N.UNEXPECTED_ERROR=5]="UNEXPECTED_ERROR"}(Rl||(Rl={})),function(N){N.DISCONNECTED="disconnected",N.CONNECTING="connecting",N.CONNECTED="connected",N.ERRORED="errored"}(fs||(fs={}));class QE extends Jc{constructor(S,A,O){super(),this.token=S,this.nonScopedLogger=A,this.analyticsTracker=O,this.participants=new Map,this.disconnected=[],this.state={value:fs.DISCONNECTED,context:{connectStartTime:0,hasConnected:!1}},this.features={sdpExchange:!1},this.stats=this.resetStats(),this.stageMinutesLogged=0,this.isStagePublishing=!1,this.onConnecting=(L,B)=>{this.logger.debug({msg:"onConnecting",context:L,event:B}),L.connectStartTime=performance.now();const H=B.type==="RECONNECT";H&&this.stageSocket.close();const{eventsURL:te}=this.token;this.emit(wl,fs.CONNECTING),this.state.value=fs.CONNECTING;const re=!H;this.stageSocket.connect(te,this.traceId,re)},this.onConnected=(L,B)=>{this.logger.debug({msg:"onConnected",context:L,event:B}),L.hasConnected=!0,this.emit(Bm),this.emit(wl,fs.CONNECTED),this.state.value=fs.CONNECTED},this.onDisconnected=(L,B)=>{this.logger.debug({msg:"onDisconnected",context:L}),this.state.value=fs.DISCONNECTED,this.stopStageMinuteLoggedInterval(!0),this.stageSocket.close(),L.hasConnected=!1,this.participants=new Map,this.disconnected=[],this.stageSocket.removeAllListeners(),this.resetStats(),this.emit(wl,fs.DISCONNECTED,B)},this.onErrored=(L,B)=>{this.logger.error({msg:"Connection failure occurred",err:B.payload.error}),this.emit(wl,fs.ERRORED),this.emit(Lp,B.payload.error),this.state.value=fs.ERRORED,L.hasConnected?this.processStateUpdate({type:"RECONNECT"}):this.stageSocket.close()},this.processStateUpdate=L=>{const B=this.state.value,H=this.state.context;switch(B){case fs.DISCONNECTED:L.type==="CONNECT"&&this.onConnecting(H,L);break;case fs.CONNECTING:L.type==="RECONNECT"?this.onConnecting(H,L):L.type==="DISCONNECT"?this.onDisconnected(H,L.reason):L.type==="CONNECT_SUCCESS"?this.onConnected(H,L):L.type==="ERROR"&&this.onErrored(H,L);break;case fs.CONNECTED:L.type==="RECONNECT"?this.onConnecting(H,L):L.type==="DISCONNECT"?this.onDisconnected(H,L.reason):L.type==="ERROR"&&this.onErrored(H,L);break;case fs.ERRORED:L.type==="RECONNECT"?this.onConnecting(H,L):L.type==="DISCONNECT"&&this.onDisconnected(H,L.reason)}},this.measureConnect=(L,B)=>{const H=this.stats.edpConnectCount,te=H+1,re=performance.now(),K=re-B;return Object.assign(this.stats,{edpConnectCount:te,edpConnectDuration:K}),H===0&&Object.assign(this.stats,{edpInitialStartConnectTime:B,edpInitialFinishConnectTime:re,edpInitialConnectDuration:K,edpInitialConnectRetries:L}),this.stats},this.measureStateUpdate=L=>{const{edpInitialFinishConnectTime:B}=this.stats,H=this.stats.edpStateUpdateCount,te=H+1;return Object.assign(this.stats,{edpStateUpdateCount:te}),H===0&&Object.assign(this.stats,{edpInitialStateDuration:performance.now()-B,edpInitialStatePublishingCount:L}),this.stats},this.trackMessageParseError=L=>{this.logger.error({msg:"Message Parse Error occurred",err:L.err});const B=new Ii({token:L.token,traceId:L.traceId,code:Bt.WEBSOCKET_MESSAGE_PARSE_FAILURE.code,tag:L.tag,location:L.location,message:L.message,details:L.err.message});this.analyticsTracker.trackEvent(new xl(B))},this.trackStageSocketMessageParseError=(L,B,H)=>{this.trackMessageParseError({token:L,traceId:B,tag:vc.JOIN_RELATED,location:"StageConnection.onMessage",message:Bt.WEBSOCKET_MESSAGE_PARSE_FAILURE.message,err:H})},this.trackStageStateMessageParseError=(L,B,H,te)=>{this.trackMessageParseError({token:L,traceId:B,tag:vc.JOIN_RELATED,location:"StageConnection.onStageStateMessage",message:te,err:H})},this.onDisconnectMessage=L=>{this.analyticsTracker.trackEventNoSharedProps(new Hm(this.token,this.traceId,`DISCONNECT message received: ${L.code}:${L.reason}`,fn.JOIN));let B=zu.UNKNOWN;if(L.code==="PARTICIPANT_DISCONNECTED")B=zu.PARTICIPANT_DISCONNECTED;else if(L.code==="STAGE_DELETED")B=zu.STAGE_DELETED;else if(L.code==="TOKEN_REUSED"&&(B=zu.TOKEN_REUSED,gh("disableTokenReuseMessage")))return void console.warn("Token reuse is detected, but skipping as feature is disabled");console.warn(`Disconnecting client due to: ${L.reason}`),this.processStateUpdate({type:"DISCONNECT",reason:B})},this.onReassignmentMessage=L=>{this.emit(Yl,L)},this.onIncompatibleCodecsMessage=L=>{this.emit(Sd,L)},this.onStageStateMessage=(L,B,H)=>{var te,re;this.logger.debug({msg:"State Stage Message occurred",state:H});const K=H.payload,ae=(te=K.participants)!==null&&te!==void 0?te:[],he=(re=K.disconnected)!==null&&re!==void 0?re:[],pe=[],Ne=[];this.measureStateUpdate(ae.length),this.enableFeaturesBasedOnServerFeatures(K.serverFeatures||[]);const Je=(Ye,Oe)=>{this.analyticsTracker.trackEventNoSharedProps(new rv({token:L,otherParticipantId:Ye.id,otherParticipantUserId:Ye.userId,isAudioMuted:Ye.audioMuted,isVideoStopped:Ye.videoStopped,isPublishing:Ye.isPublishing,isDisconnected:Oe,traceId:B}))};this.participants.forEach(Ye=>{const Oe=ae.find(ye=>ye.id===Ye.id);if(Oe){let ye=!0,lt=!1;["isPublishing","id","audioMuted","joinedAt","userId","videoStopped"].forEach(wt=>{ye=ye&&Oe[wt.toString()]===Ye[wt.toString()],ye||(Ye[wt.toString()]=Oe[wt.toString()],lt=!0)}),Object.keys(Ye.attributes).forEach(wt=>{ye=ye&&Oe.attributes[wt]===Ye.attributes[wt],ye||(Ye.attributes=Oe.attributes,lt=!0)}),lt&&(Je(Ye,!1),this.emit(j0,Oe))}else Ne.push(Ye)}),ae.forEach(Ye=>{this.participants.get(Ye.id)||pe.push(Ye)}),Ne.forEach(Ye=>{this.participants.delete(Ye.id),Je(Ye,!0),this.emit(bf,Ye)}),pe.forEach(Ye=>{this.participants.set(Ye.id,Ye),Je(Ye,!1),this.emit(Ed,Ye)}),he.forEach(Ye=>{this.disconnected.find(Oe=>Oe.id===Ye.id)||(this.disconnected.push(Ye),Ye.status==="KICKED"&&this.emit(da,Ye))}),this.disconnected=he},this.nonScopedLogger=A,this.logger=new ro(A,me.CONNECTION),this.stageSocket=new eR(S,this.nonScopedLogger,O),this.token=S,this.traceId=gc()}resetStats(){return this.stats={isConnected:!1,edpInitialStartConnectTime:0,edpInitialFinishConnectTime:0,edpConnectCount:0,edpInitialConnectDuration:0,edpConnectDuration:0,edpInitialStateDuration:0,edpInitialStatePublishingCount:0,edpStateUpdateCount:0,edpInitialConnectRetries:0},this.stats}connect(S){return Ko(this,void 0,void 0,function*(){return this.logger.debug({msg:"connect invoked",token:this.token,traceId:S}),this.traceId=S,this.state.value!==fs.DISCONNECTED&&(this.logger.debug({msg:"Disconnecting previous connection"}),this.processStateUpdate({type:"DISCONNECT",reason:zu.CLIENT_RECONNECT})),new Promise((A,O)=>{this.stageSocket.on(Qc,L=>{var B,H;const{retryCnt:te,initialStageState:re}=L;re&&this.enableFeaturesBasedOnServerFeatures((H=(B=re.payload)===null||B===void 0?void 0:B.serverFeatures)!==null&&H!==void 0?H:[]),this.traceId=L.traceId||gc(),this.measureConnect(te,this.state.context.connectStartTime),this.processStateUpdate({type:"CONNECT_SUCCESS"}),this.startStageMinuteLoggedInterval(this.token,this.traceId),A(this.traceId)}),this.stageSocket.on(Xl,L=>{O(L),this.processStateUpdate({type:"ERROR",payload:{error:L}})}),this.stageSocket.on(J_,()=>{this.logger.debug({msg:"Refresh event occurred"}),this.emit(Z1),this.processStateUpdate({type:"RECONNECT"})}),this.stageSocket.on(Q_,L=>this.onStageStateMessage(this.token,this.traceId,L)),this.stageSocket.on(yc,L=>this.trackStageSocketMessageParseError(this.token,this.traceId,L)),this.stageSocket.on(G0,this.onDisconnectMessage),this.stageSocket.on(Td,this.onReassignmentMessage),this.stageSocket.on(Ro,this.onIncompatibleCodecsMessage),this.stageSocket.on(Nu,L=>{this.stopStageMinuteLoggedInterval()}),this.processStateUpdate({type:"CONNECT",payload:{token:this.token,traceId:S}})})})}disconnect(){return this.logger.debug({msg:"disconnect invoked"}),this.processStateUpdate({type:"DISCONNECT",reason:zu.USER_INITIATED}),this.traceId}getParticipant(S){return this.participants.get(S)}listConnectedParticipants(){const S=[];return this.participants.forEach(A=>{A.subscribed&&S.push(A)}),S}listAvailableParticipants(){return Array.from(this.participants.values())}emitStageState(S,A){this.stageSocket.send({audioMuted:S,type:"SET_STATE",version:"0",videoStopped:A})}setStagePublishing(S){this.isStagePublishing=S,this.emit(_c,this.isStagePublishing)}getIsStagePublishing(){return this.isStagePublishing}startStageMinuteLoggedInterval(S,A){this.uploadStageMinutesBroadcastInterval||(this.analyticsTracker.trackEvent(new Sc(S,A,this.stageMinutesLogged,this.isStagePublishing,0)),this.stageMinutesLogged++,this.uploadStageMinutesBroadcastInterval=setInterval(()=>{this.analyticsTracker.trackEvent(new Sc(S,A??gc(),this.stageMinutesLogged,this.isStagePublishing,0)),this.stageMinutesLogged++},6e4))}stopStageMinuteLoggedInterval(S=!1){this.uploadStageMinutesBroadcastInterval&&(clearInterval(this.uploadStageMinutesBroadcastInterval),this.uploadStageMinutesBroadcastInterval=void 0),S&&(this.stageMinutesLogged=0)}enableFeaturesBasedOnServerFeatures(S){const A=(H,te)=>{this.trackStageStateMessageParseError(this.token,this.traceId,te,`Could not parse "${H}" from the Eevee server features list`)},O=S.includes(oo.SDP_EXCHANGE);this.features.sdpExchange!==O&&(this.logger.debug({msg:`XDP SDP exchange feature toggled: ${O}`}),this.features.sdpExchange=O);const L=S.find(H=>H.indexOf(oo.JITTER_BUFFER_MIN_DELAY_MS)!==-1),B=H=>{this.logger.debug({msg:`jitterBufferMinDelay feature updated to: ${H}`}),this.features.jitterBufferMinDelayInMs=H};if(L!==void 0)try{const H=L.split("=")[1],te=parseInt(H,10);if(isNaN(te))throw new Error("Unable to parse - result is NaN");if(te<0)throw new Error("Unable to apply - result is negative");this.features.jitterBufferMinDelayInMs!==void 0&&this.features.jitterBufferMinDelayInMs===te||B(te)}catch(H){A(L,H),B(void 0)}else B(void 0)}isConnected(){return this.state.value===fs.CONNECTED}supportsSdpExchange(){return this.features.sdpExchange}jitterBufferMinDelayInMs(){return this.features.jitterBufferMinDelayInMs}getConnectionStats(){return Object.assign({},this.stats,{isConnected:this.isConnected()})}exchangeSdp(S,A,O,L,B,H,te,re,K){return Ko(this,void 0,void 0,function*(){return this.isConnected()?new Promise((ae,he)=>{const pe=window.setTimeout(()=>{Ne(),he(Rl.TIMEDOUT)},8e3),Ne=()=>{window.clearTimeout(pe),this.stageSocket.off(V0,Je),this.stageSocket.off(Xl,Ye)},Je=Oe=>{Oe.requestId===L&&(Ne(),ae(Oe))},Ye=()=>{Ne(),he(Rl.CONNECTION_LOST)};B==null||B.addEventListener("abort",()=>{Ne(),he(Rl.ABORTED)}),this.stageSocket.on(V0,Je),this.stageSocket.on(Xl,Ye),this.stageSocket.sendSdpOffer(S,A,O,L,H,te,re,K)}):Promise.reject(Rl.NOT_CONNECTED)})}}class Hu{constructor(S){this.token=S}}var eS=function(N,S,A,O){return new(A||(A=Promise))(function(L,B){function H(K){try{re(O.next(K))}catch(ae){B(ae)}}function te(K){try{re(O.throw(K))}catch(ae){B(ae)}}function re(K){var ae;K.done?L(K.value):(ae=K.value,ae instanceof A?ae:new A(function(he){he(ae)})).then(H,te)}re((O=O.apply(N,[])).next())})};const oy={[Rl.ABORTED]:Bt.OPERATION_ABORTED,[Rl.NOT_CONNECTED]:Bt.EVENT_PLANE_WS_UNEXPECTED_CLOSE,[Rl.CONNECTION_LOST]:Bt.XDP_CONNECTION_LOST,[Rl.TIMEDOUT]:Bt.XDP_TIMEOUT,[Rl.INVALID_MESSAGE]:Bt.XDP_INVALID_ANSWER_MSG,[Rl.UNEXPECTED_ERROR]:Bt.XDP_UNEXPECTED_ERROR};class tS extends Hu{constructor(S,A,O,L){super(S),this.token=S,this.stageConnection=A,this.contextData=O,this.analyticsTracker=L}exchange(S){return eS(this,void 0,void 0,function*(){const A=Ca(),{action:O}=this.contextData,{sdpOffer:L,url:B,traceId:H,forceNode:te,assignmentToken:re,multiCodec:K,abortController:ae,initialLayerPreference:he}=S;let pe;this.trackAttempt(B,A,H);try{pe=yield this.stageConnection.exchangeSdp(L,B,H.value,A.value,ae==null?void 0:ae.signal,te,re,K,he)}catch(Kt){if(typeof Kt=="number")throw this.createClientSideErrorFromReasonCode(Kt,H,A,O)}if(!pe)return;const{httpStatusCode:Ne,errorCode:Je,location:Ye,content:Oe,sessionDeleteLink:ye,subscriberControlLink:lt,videoLayersLink:wt}=pe;if(Ne>=200&&Ne<300)return{sdpAnswer:Oe,url:B,location:Ye,sessionDeleteLink:ye,mediaControls:lt,layerControls:wt};throw this.createServerSideError(H,A,Ne,Je,O)})}trackAttempt(S,A,O){const{remoteParticipantId:L,action:B}=this.contextData;this.analyticsTracker.trackEventNoSharedProps(new Tf(B,this.token,S,"POST",A.value,L,O,"xdp"))}createServerSideError(S,A,O,L,B){const H=this.baseErrorProps(S,A);let te=H0(O,L);return te||(te=Bt.UNKNOWN_SERVER_ERROR),new Ii(Object.assign(Object.assign({action:B},H),te))}baseErrorProps(S,A){const{remoteParticipantId:O,action:L}=this.contextData;return{token:this.token,traceId:S,tag:Co(L,O),location:"EdpSdpExchanger.exchange",requestUUID:A,remoteParticipantId:O}}createClientSideErrorFromReasonCode(S,A,O,L){const B=this.baseErrorProps(A,O),H=oy[S];return new Ii(H?Object.assign(Object.assign({action:L},B),H):Object.assign(Object.assign({action:L},B),Bt.XDP_INVALID_ANSWER_MSG))}getTransport(){return"sdp"}}const Cf=new RegExp("^(?:[a-z+]+:)?//","i");function Ml(N){return Cf.test(N)}var li=function(N,S,A,O){return new(A||(A=Promise))(function(L,B){function H(K){try{re(O.next(K))}catch(ae){B(ae)}}function te(K){try{re(O.throw(K))}catch(ae){B(ae)}}function re(K){var ae;K.done?L(K.value):(ae=K.value,ae instanceof A?ae:new A(function(he){he(ae)})).then(H,te)}re((O=O.apply(N,[])).next())})};class cy extends Hu{constructor(S,A,O){super(S),this.contextData=A,this.analyticsTracker=O}exchange(S){return li(this,void 0,void 0,function*(){const A=Ca(),{token:O}=this,{action:L,remoteParticipantId:B}=this.contextData,{sdpOffer:H,url:te,traceId:re,forceNode:K,assignmentToken:ae,multiCodec:he,abortController:pe,initialLayerPreference:Ne}=S;try{const Ye="POST",Oe="http";this.analyticsTracker.trackEventNoSharedProps(new Tf(L,O,te,Ye,A.value,B,re,Oe));const ye={data:H,headers:{Authorization:`Bearer ${O.rawToken}`,"Content-Type":"application/sdp","X-Stages-Platform":"web","X-Stages-Request-ID":A.value,"X-Stages-SDK":"1.19.0","X-Stages-Session-ID":this.analyticsTracker.getSessionId(),"X-Stages-Trace-ID":re.value,"X-Stages-WHIP-Version":bc,"X-Stages-Options":(Je=JSON.stringify({cap:["sau"]}),btoa(Je).replace(/[^A-Za-z0-9+/]/g,""))},method:Ye,responseType:"text",url:te,signal:pe==null?void 0:pe.signal,params:{}};K&&(ye.params.force_node=K),ae&&(ye.params.assignment_token=ae),he&&(ye.params.multi_codec=!0);const lt=O0()===void 0,wt=O0()||lt;Ne&&ye.headers&&wt&&(ye.headers["X-Stages-Initial-Layer-Pref"]=sy(Ne));const{data:Kt,headers:It,request:Kn}=yield Cl(ye),wn=this.parseWhipResource(te,It.location,It.link);return{url:Kn.responseURL,sdpAnswer:Kt,location:wn==null?void 0:wn.location,sessionDeleteLink:wn==null?void 0:wn.sessionDeleteLink,mediaControls:wn==null?void 0:wn.mediaControls,layerControls:wn==null?void 0:wn.layerControls}}catch(Ye){if(Js().isCancel(Ye))throw new Ii(Object.assign(Object.assign({},Pp(Bt.OPERATION_ABORTED,Ye)),{action:L,token:O,traceId:re,tag:Co(L,B),location:"StagePeerClient.start",requestUUID:A,remoteParticipantId:B}));const Oe=function(ye,lt){var wt;return ye instanceof ws.AxiosError&&ye.response&&typeof ye.response.status=="number"?ye instanceof ws.AxiosError&&ye.code==="ERR_NETWORK"?Bt.NETWORK_FAILURE:H0(Number(ye.response.status),(wt=ye.response.data)===null||wt===void 0?void 0:wt.code)||lt:lt}(Ye,Bt.WHIP_POST_FAILURE);throw new Ii(Object.assign(Object.assign({},Pp(Oe,Ye)),{action:L,token:O,traceId:re,tag:Co(L,B),location:"StagePeerClient.start",requestUUID:A,remoteParticipantId:B}))}var Je})}parseWhipResource(S,A,O){const L=new URL(S);let B;return B=function(H,te,re){if(!re)return H;if(H||(H={}),Ml(re))return H.location=re,H;const K=te.port?`:${te.port}`:"";return H.location=`${te.protocol}//${te.hostname}${K}${re}`,H}(B,L,A),B=function(H,te,re){if(!re)return H;H||(H={});const K=H;return re.split(",").forEach(ae=>{const he=/<(.+)>;\s?rel="([a-z:-]+)"/.exec(ae);if((he==null?void 0:he.length)!==3)return;let pe;if(Ml(he[1]))pe=he[1];else{const Ne=te.port?`:${te.port}`:"";pe=`${te.protocol}//${te.hostname}${Ne}${he[1]}`}switch(he[2]){case"urn:ietf:params:whip:ivs-stages:session-delete":K.sessionDeleteLink=pe;break;case"urn:ietf:params:whep:core:playback-controls":K.mediaControls=pe;break;case"urn:ietf:params:whep:ext:core:layer":K.layerControls=pe;break;default:return}}),K}(B,L,O),B}getTransport(){return"http"}}var ti=r(1564);function Ol(N){return N.track.kind===Du.AUDIO}function ov(N){return N.track.kind===Du.VIDEO&&typeof N.config=="object"}const nS=(N,S)=>function(A){return A.kind===Du.AUDIO}(N)?((A,O)=>{var L;const B={maxBitrateBps:ao((L=O==null?void 0:O.maxAudioBitrateKbps)!==null&&L!==void 0?L:64)},H=O==null?void 0:O.stereo;return typeof H=="boolean"&&(B.stereo=H),{track:A,config:B}})(N,S):((A,O)=>{var L,B,H,te;const re=(L=O==null?void 0:O.minBitrate)!==null&&L!==void 0?L:jm,K=(B=O==null?void 0:O.maxBitrate)!==null&&B!==void 0?B:Vm,ae=(H=O==null?void 0:O.maxFramerate)!==null&&H!==void 0?H:Ec,he=!!(!((te=O==null?void 0:O.simulcast)===null||te===void 0)&&te.enabled);return{track:A,config:{minBitrateBps:ao(re),maxBitrateBps:ao(K),maxFramerate:ae,simulcastEnabled:he,inBandMessagingEnabled:!1}}})(N,S),ja=(N,S)=>{if(typeof N=="number")return N;const A=S?X0:J1;return A[N]!==void 0?A[N]:0};function qp(N){if(N<jm||N>Vm)throw new Error(`Stage bitrate must be between ${jm} kbps and ${Vm} kbps`)}function sx(N,S){const A=$E();let O=Object.assign({},A,(0,fa.cloneDeep)(S));return O=function(L,B){var H,te,re;const K=Object.assign({},(0,fa.cloneDeep)(B)),ae=!hs.browser.isChrome()&&!hs.browser.isEdge(),he=(re=(te=(H=L.getSettings)===null||H===void 0?void 0:H.call(L))===null||te===void 0?void 0:te.displaySurface)!==null&&re!==void 0&&re,pe=ao(K.maxBitrate)<$m.maxBitrate;return(ae||he||pe)&&(K.simulcast.enabled=!1),K}(N,O),qp(O.maxBitrate),qp(O.minBitrate),function(L){if(L&&(L>Ec||L<ty))throw new Error(`framerate cannot exceed ${Ec} fps`)}(O.maxFramerate),function(L){if(L<Y0||L>or)throw new Error(`Stage audio bitrate must be between ${Y0} kbps and ${or} kbps`)}(O.maxAudioBitrateKbps),function(L){if(typeof L!="boolean")throw new Error("Stage stereo prop must be a boolean")}(O.stereo),O}function iS({stageErrorValue:N,action:S,token:A,traceId:O,tag:L,identifier:B,details:H}){return new Ii(Object.assign(Object.assign({},N),{token:A,traceId:O,location:"peer-client",tag:L,action:S,remoteParticipantId:B,details:H}))}var Is;function Zo(N){var S;return!((S=N==null?void 0:N.sender)===null||S===void 0)&&S.createEncodedStreams?Is.INSERTABLE_STREAMS:window.RTCRtpSender&&"transform"in RTCRtpSender.prototype&&window.RTCRtpScriptTransform?Is.ENCODED_TRANSFORMS:Is.NONE}function ly(N){var S;return!((S=N==null?void 0:N.receiver)===null||S===void 0)&&S.createEncodedStreams?Is.INSERTABLE_STREAMS:window.RTCRtpReceiver&&"transform"in RTCRtpReceiver.prototype&&window.RTCRtpScriptTransform?Is.ENCODED_TRANSFORMS:Is.NONE}function rS(N){let S=[];const A=new Map;function O(L){const B="0123456789abcdef";let H="";for(let te=0;te<L;te+=1)H+=B.charAt(Math.floor(Math.random()*B.length));return H}return{add(L){const B=O,H=`${B(8)}-${B(4)}-${B(4)}-${B(4)}-${B(12)}`,te=Date.now();return S.push({id:H,enqueuedAt:te,payload:L}),H},poll(L){return A.has(L)||A.set(L,[]),A.size>=N&&(A.forEach(B=>{B.push(...S)}),S=[]),(A.get(L)||[]).splice(0,1)}}}function tR(N,S){return S.type==="sei"?function(A,O){const te=new Uint8Array([1,2,1,8,1,2,3,4,2,2,2,4,4,3,2,1]);function re(he,pe,Ne){return Ne+pe.length<=he.byteLength&&pe.every((Je,Ye)=>he.getUint8(Ne+Ye)===Je)}function K(he,pe){const Ne=function(Ye,Oe){return new Uint8Array([0,0,1,6,5,...Oe,...Ye])}(he,function(Ye){const Oe=[];for(;Ye>=255;)Oe.push(255),Ye-=255;return Oe.push(Ye),new Uint8Array(Oe)}(pe.length+he.length)),Je=function(Ye){const Oe=[...Ye];let ye=3;for(;ye<Oe.length-2;)Oe[ye]!==0||Oe[ye+1]!==0||Oe[ye+2]!==0&&Oe[ye+2]!==1&&Oe[ye+2]!==2&&Oe[ye+2]!==3?ye+=1:(Oe.splice(ye+2,0,3),ye+=3);return Oe}(new Uint8Array([...Ne,...pe,128]));return new Uint8Array(Je)}function ae(he,pe){const Ne=function(Je){const Ye=new DataView(Je);for(let Oe=0;Oe<Ye.byteLength-4;Oe++)if(re(Ye,[0,0,1],Oe)){const ye=31&Ye.getUint8(Oe+3);if(ye>=1&&ye<=5)return Oe}return-1}(A.data);if(Ne>=0){const Je=new ArrayBuffer(A.data.byteLength+pe.byteLength),Ye=new Uint8Array(Je);return Ye.set(new Uint8Array(A.data.slice(0,Ne)),0),Ye.set(pe,Ne),Ye.set(new Uint8Array(A.data.slice(Ne)),Ne+pe.byteLength),Je}return he}return function(){for(let he=0;he<O.length;he+=1){const pe=K(te,new Uint8Array(O[he]));A.data=ae(A.data,pe)}return A}()}(N,S.payloads||[]):N}function cv(N,S){const{type:A,transformerId:O}=S;if(A==="sei"){const L=function(te){function ae(Ne,Je,Ye){return Ye+Je.length<Ne.byteLength&&Je.every((Oe,ye)=>Ne.getUint8(Ye+ye)===Oe)}function he(Ne){const Je=[];let Ye=0;for(;Ye<Ne.length;)Ne[Ye]===0&&Ne[Ye+1]===0&&Ne[Ye+2]===3?(Je.push(Ne[Ye]),Je.push(Ne[Ye+1]),Ye+=3):(Je.push(Ne[Ye]),Ye+=1);return new Uint8Array(Je)}function pe(Ne){let Je=2;const Ye=Ne.byteLength;for(;Je<Ye;){let Oe=0;for(;Je<Ye&&Ne[Je]===255;)Oe+=255,Je++;Oe+=Ne[Je],Je++;const ye=Math.min(Je+Oe,Ye),lt=new Uint8Array(Ne.slice(Je,ye));return{uuid:lt.slice(0,16),payload:lt.slice(16)}}}return{messages:function(Ne){const Je=new DataView(Ne.data),Ye=[];let Oe=0;if(!ae(Je,[0,0,1],0)&&!ae(Je,[0,0,0,1],0))return[];for(;Oe<Je.byteLength-5;)if(ae(Je,[0,0,1],Oe)){const ye=Oe+3;Oe=ye;const lt=31&Je.getUint8(Oe),wt=31&Je.getUint8(Oe+1);if(lt===6&&wt===5){for(;Oe<Je.byteLength&&!ae(Je,[0,0,1],Oe);)Oe++;const Kt=Oe,It=pe(he(new Uint8Array(Ne.data.slice(ye,Kt))));It&&Ye.push(Object.assign(Object.assign({},It),{timestamp:Ne.timestamp,type:Ne.type}))}else Oe++}else Oe++;return Ye}(te),frame:te}}(N),{frame:B,messages:H}=L;return{success:!0,frame:B,type:A,transformerId:O,seiResult:H}}return{success:!0,frame:N,transformerId:O,type:A}}function ax(){let N;const S=L=>(B,H)=>{const te=B.getMetadata().synchronizationSource,re=(N?N.poll(te):[]).map(K=>K.payload);H.enqueue("<SEND_TRANSFORMER_IMPL>"(B,Object.assign(Object.assign({},L),{payloads:re})))},A=L=>(B,H)=>{try{const te="<RECEIVE_TRANSFORMER_IMPL>"(B,L);H.enqueue(te.frame),self.postMessage(Object.assign(Object.assign({success:te.success},L),{seiResult:te.seiResult}))}catch{self.postMessage(Object.assign({success:!1},L))}};function O(L,B,H,te){const re=new TransformStream({transform:L==="video/send"?S(B):A(B)});H.pipeThrough(re).pipeTo(te)}return self.onrtctransform=L=>{const B=L.transformer;B&&O(B.options.method,B.options,B.readable,B.writable)},self.onmessage=L=>{var B;const{operation:H,transformerId:te}=L.data;H==="insert"?(N||(N="<CREATE_MESSAGE_QUEUE>"(1)),N.add((B=L.data)===null||B===void 0?void 0:B.payload)):H!=="video/receive"&&H!=="video/send"||O(H,{method:H,transformerId:te,type:"sei"},L.data.readable,L.data.writable)},{videoReceiveTransform:A,videoSendTransform:S}}(function(N){N.NONE="none",N.ENCODED_TRANSFORMS="encodedTransforms",N.INSERTABLE_STREAMS="insertableStreams"})(Is||(Is={}));const ox=()=>{let N=ax.toString();return N=N.replace('"<SEND_TRANSFORMER_IMPL>"',tR.toString()),N=N.replace('"<RECEIVE_TRANSFORMER_IMPL>"',cv.toString()),N=N.replace('"<CREATE_MESSAGE_QUEUE>"',rS.toString()),N},Km=(()=>{let N;return{getWorker:()=>(N||(N=function(){const S=new Blob([`(${ox()})()`],{type:"text/javascript"}),A=URL.createObjectURL(S);return new Worker(A)}()),N),destroy:()=>{N&&N.terminate(),N=void 0}}})(),sS="seiMessageReceived",lv="error";var tl;(function(N){N.CREATED="created",N.INITIALIZED="initialized",N.DESTROYED="destroyed"})(tl||(tl={}));class Zm extends Jc{constructor({enabled:S}){super(),this.state=tl.CREATED,this.transformerId=Ca().value,this.prevResultWasError=!1,this.consecutiveErrorResults=0,this.seiReadCnt=0,this.seiBytesRead=0,this.onMessage=A=>{this.onTransformResult(A.data)},S||this.destroy()}initializeInsertableStreams(S){var A;this.worker=Km.getWorker();const O=S.receiver.createEncodedStreams(),{readable:L,writable:B}=O;(A=this.worker)===null||A===void 0||A.postMessage({operation:"video/receive",transformerId:this.transformerId,readable:L,writable:B},[L,B]),this.worker.addEventListener("message",this.onMessage)}initializeEncodedTransforms(S){this.worker=Km.getWorker();const A={method:"video/receive",type:"sei",transformerId:this.transformerId};S.receiver.transform=new RTCRtpScriptTransform(this.worker,A),this.worker.addEventListener("message",this.onMessage)}initialize(S,A){if(this.state!==tl.CREATED)return!1;const O=ly(S);if(O===Is.NONE)return!1;if(A&&O===Is.INSERTABLE_STREAMS)this.initializeInsertableStreams(S);else{if(A||O!==Is.ENCODED_TRANSFORMS)return!1;this.initializeEncodedTransforms(S)}return this.transceiver=S,this.state=tl.INITIALIZED,!0}onTransceiverAdd(S){return this.initialize(S,!0)}onTrackEvent(S){return S.track.kind==="video"&&this.initialize(S.transceiver,!1)}static isSupported(S){return ly(S)!==Is.NONE}onTransformResult(S){return S.transformerId===this.transformerId&&(S.success?(this.prevResultWasError=!1,this.consecutiveErrorResults=0,!!S.seiResult&&(S.seiResult.forEach(A=>{const{payload:O,uuid:L}=A;this.updateReadStats(A),this.emit(sS,{uuid:L,payload:O})}),S.seiResult.length>0)):(this.prevResultWasError&&this.consecutiveErrorResults++,this.consecutiveErrorResults>=300&&this.onError(S,Bt.TRANSFORM_TOO_MANY_ERRORS),this.prevResultWasError=!0,this.onError(S,Bt.TRANSFORM_UNEXPECTED_ERROR),!1))}updateReadStats(S){this.seiReadCnt++,this.seiBytesRead+=S.payload.byteLength}getReceiverStats(){const{seiBytesRead:S,seiReadCnt:A}=this;return{seiReadCnt:A,seiBytesRead:S}}onError(S,A){const{type:O}=S;this.emit(lv,{type:O,stageErrorValue:A})}destroy(){var S,A;this.state!==tl.DESTROYED&&(this.removeAllListeners(),(S=this.worker)===null||S===void 0||S.removeEventListener("message",this.onMessage),!((A=this.transceiver)===null||A===void 0)&&A.receiver&&(this.transceiver.receiver.transform=null),this.state=tl.DESTROYED)}getState(){return this.state}}class uy{constructor({enabled:S}){this.state=tl.CREATED,this.transformerId=Ca().value,S||this.destroy()}initializeInsertableStreams(S,A){var O;this.worker=Km.getWorker();const L=S.sender.createEncodedStreams(),{readable:B,writable:H}=L;(O=this.worker)===null||O===void 0||O.postMessage({operation:"video/send",transformerId:this.transformerId,readable:B,writable:H},[B,H])}initializeEncodedTransforms(S,A){this.worker=Km.getWorker();const O={method:"video/send",type:"sei",transformerId:this.transformerId,encodingLayers:A};S.sender.transform=new RTCRtpScriptTransform(this.worker,O)}initialize(S){var A;if(this.state!==tl.CREATED)return!1;const O=Zo(S);if(O===Is.NONE)return!1;const L=S.sender.getParameters(),B=((A=L==null?void 0:L.encodings)===null||A===void 0?void 0:A.length)||1;if(O===Is.INSERTABLE_STREAMS)this.initializeInsertableStreams(S,B);else{if(O!==Is.ENCODED_TRANSFORMS)return!1;this.initializeEncodedTransforms(S,B)}return this.transceiver=S,this.state=tl.INITIALIZED,!0}static isSupported(S){return Zo(S)!==Is.NONE}sendSeiMessage(S){var A;this.state===tl.INITIALIZED&&this.transceiver&&((A=this.worker)===null||A===void 0||A.postMessage({operation:"insert",transformerId:this.transformerId,payload:S}))}onTransceiverAdd(S){return this.initialize(S)}onTrackEvent(S){return!1}destroy(){var S;this.state!==tl.DESTROYED&&(!((S=this.transceiver)===null||S===void 0)&&S.receiver&&(this.transceiver.receiver.transform=null),this.state=tl.DESTROYED)}getState(){return this.state}}var Va=function(N,S,A,O){return new(A||(A=Promise))(function(L,B){function H(K){try{re(O.next(K))}catch(ae){B(ae)}}function te(K){try{re(O.throw(K))}catch(ae){B(ae)}}function re(K){var ae;K.done?L(K.value):(ae=K.value,ae instanceof A?ae:new A(function(he){he(ae)})).then(H,te)}re((O=O.apply(N,[])).next())})};let Jm=null;class uv extends Jc{constructor(S,A,O,L,B,H,te,re,K){var ae,he;if(super(),this.analyticsTracker=H,this.sfuResource={node:"",cluster:""},this.stageCapabilities={simulcastNegotiated:!1},this.incompatibleCodecs=new Set,this.connect=({audioOnly:pe=!1,traceId:Ne,iceRestartOptions:Je})=>Va(this,void 0,void 0,function*(){const{token:Ye,tag:Oe,identifier:ye,action:lt}=this,wt=!!Je,Kt=new AbortController;let It,Kn,wn;this.abortController=Kt,this.traceId=Ne,this.perfTracker.resetMeasurements(Ne);const _i=()=>{It&&this.off(_f,It),Kn&&this.off(Zs,Kn)},zi=new Promise((ki,xi)=>{const yi=function({action:bi,token:Mi,traceId:ui,tag:Tn,identifier:$n}){const $i=bi===fn.SUBSCRIBE?Bt.SUBSCRIBE_TIMED_OUT:Bt.PUBLISH_TIMED_OUT;return new Ii(Object.assign(Object.assign({},$i),{action:bi,token:Mi,traceId:ui,tag:Tn,location:"connect",remoteParticipantId:$n}))}({action:lt,token:Ye,traceId:Ne,tag:Oe,identifier:ye}),Ri=function({action:bi,token:Mi,traceId:ui,tag:Tn}){const $n=Bt.OPERATION_ABORTED;return new Ii(Object.assign(Object.assign({},$n),{token:Mi,traceId:ui,location:"peer-client.connect",tag:Tn,action:bi}))}({action:lt,token:Ye,traceId:Ne,tag:Oe}),Di=setTimeout(()=>{this.stop(),this.analyticsTracker.trackError(yi),xi(yi)},1e4);It=bi=>{clearTimeout(Di),wt||this.stop(),xi(bi)},Kn=bi=>{if(bi===at.CONNECTED)clearTimeout(Di),ki();else if(bi===at.FAILED){const Mi=function({action:ui,token:Tn,traceId:$n,tag:$i}){return new Ii(Object.assign(Object.assign({},Bt.PEER_CONNECTION_NETWORK_FAILURE),{token:Tn,traceId:$n,location:"peer-client.connect",tag:$i,action:ui}))}({action:lt,token:Ye,traceId:Ne,tag:Oe});clearTimeout(Di),xi(Mi)}},this.on(_f,It),this.on(Zs,Kn),wn=()=>{clearTimeout(Di)},Kt.signal.aborted&&(clearTimeout(Di),xi(Ri)),Kt.signal.addEventListener("abort",()=>{clearTimeout(Di),xi(Ri)})});try{const ki=yield Promise.all([Va(this,void 0,void 0,function*(){wt||(yield this.start(),this.mediaStream=yield this.initializePeerConnection(pe));const yi=Je==null?void 0:Je.assignmentToken,Ri=Je==null?void 0:Je.nodeOverride;return yield this.exchangeSdp({iceRestart:wt,nodeOverride:Ri,assignmentToken:yi,abortController:Kt}),this.mediaStream}),zi]);this.statsReporter.traceId=Ne;const xi=ki[0];if(this.abortController=void 0,!wt&&lt===fn.PUBLISH)try{yield this.verifyOrUpdateTransceiverSync()}catch(yi){this.logger.error({err:yi,msg:"error syncing transceivers"})}return{mediaStream:xi}}catch(ki){throw wn&&wn(),ki}finally{_i()}}),this.disconnect=(pe=!1)=>Va(this,void 0,void 0,function*(){var Ne;const{token:Je,action:Ye}=this;(Ne=this.abortController)===null||Ne===void 0||Ne.abort(),this.stop(),pe?this.cleanup(Ye,Je.participantID,Je,pe):yield this.cleanup(Ye,Je.participantID,Je,pe)}),this.onTrack=pe=>{const{token:Ne,action:Je,traceId:Ye,identifier:Oe}=this;this.trace(Ne,Ye,`onTrack: ${pe.track.kind}`,Je,Oe),this.videoSenderTransformer.onTrackEvent(pe),this.videoReceiverTransformer.onTrackEvent(pe)},this.onIceGatheringStateChange=()=>{var pe,Ne,Je;const{token:Ye,action:Oe,traceId:ye,identifier:lt}=this;if(((pe=this.peerConnection)===null||pe===void 0?void 0:pe.iceGatheringState)==="gathering"?this.perfTracker.markIceGatheringStart():((Ne=this.peerConnection)===null||Ne===void 0?void 0:Ne.iceGatheringState)==="complete"&&this.perfTracker.markIceGatheringStop(),this.peerConnection){const wt=this.peerConnection.iceGatheringState,Kt=new W0(Oe,Ye,ye,wt,lt);this.analyticsTracker.trackEventNoSharedProps(Kt)}this.trace(Ye,ye,`ICE gathering state change: ${(Je=this.peerConnection)===null||Je===void 0?void 0:Je.iceGatheringState}`,Oe,lt)},this.onSelectedCandidatePairChange=()=>{var pe,Ne;const{token:Je,action:Ye,traceId:Oe,identifier:ye}=this,lt=(Ne=(pe=this.peerConnection)===null||pe===void 0?void 0:pe.getReceivers()[0].transport)===null||Ne===void 0?void 0:Ne.iceTransport,wt=lt==null?void 0:lt.getSelectedCandidatePair();if(wt){const{local:Kt,remote:It}=wt,Kn=`Selected candidate pair change (local, remote): ${Kt==null?void 0:Kt.candidate}, ${It==null?void 0:It.candidate}`;this.logger.debug({msg:Kn}),this.trace(Je,Oe,Kn,Ye,ye)}},this.onIceCandidate=pe=>Va(this,void 0,void 0,function*(){var Ne,Je;const{identifier:Ye,action:Oe,traceId:ye}=this,lt=(Ne=pe.target.localDescription)===null||Ne===void 0?void 0:Ne.sdp.includes("relay");this.analyticsTracker.trackEventNoSharedProps(new Hm(this.token,ye,`ice candidate: hasRelay = ${lt}, candidate = ${(Je=pe.candidate)===null||Je===void 0?void 0:Je.candidate}`,Oe,Ye))}),this.onMute=()=>Va(this,void 0,void 0,function*(){const{token:pe,action:Ne,traceId:Je,identifier:Ye}=this;this.trace(pe,Je,"Track has muted",Ne,Ye)}),this.onUnMute=()=>Va(this,void 0,void 0,function*(){const{token:pe,action:Ne,traceId:Je,identifier:Ye}=this;this.trace(pe,Je,"Track has unmuted",Ne,Ye)}),this.fetchAndSetRemoteDescription=pe=>Va(this,void 0,void 0,function*(){var Ne,Je,Ye,Oe;const ye=(Je=(Ne=this.peerConnection)===null||Ne===void 0?void 0:Ne.localDescription)===null||Je===void 0?void 0:Je.sdp;ye||this.logger.warn({msg:"Unexpected state: No SDP offer when attempting to fetch remote description"});const{token:lt,traceId:wt,action:Kt,identifier:It,tag:Kn}=this,{endpointURL:wn,nodeOverride:_i,assignmentToken:zi,multiCodec:ki,abortController:xi}=pe;let yi;this.perfTracker.markPostStart(),this.perfTracker.markSdpExchangeStart();try{this.perfTracker.setTransport(this.sdpExchanger.getTransport());const ui=_i||mf("node")||mf("dataPlaneEndpoint");yi=yield this.sdpExchanger.exchange({sdpOffer:ye,url:wn,traceId:wt,forceNode:ui,assignmentToken:zi,multiCodec:ki,abortController:xi,initialLayerPreference:(Ye=this.simulcastSubscribeConfig)===null||Ye===void 0?void 0:Ye.initialLayerPreference})}catch(ui){let Tn=ui;Tn instanceof Ii||(Tn=new Ii(Object.assign(Object.assign({},Bt.UNEXPECTED_ERROR),{action:Kt,token:lt,traceId:wt,tag:Kn,details:ui instanceof Error?ui.message:"",location:"sdp-exchange"}))),Tn instanceof Ii&&(this.analyticsTracker.trackError(Tn),this.emit(_f,Tn))}if(this.perfTracker.markSdpExchangeStop(),!yi)return;const{location:Ri,sessionDeleteLink:Di,mediaControls:bi}=yi;let Mi=yi.sdpAnswer;try{Mi=this.mungeSdpAnswer(Mi),yi.sdpAnswer=Mi}catch(ui){this.logger.error({err:ui,msg:"Error while attempting to munge SDP, keeping original answer"})}this.statsReporter.sdpAnswer=Mi,this.emit(k0,yi),Ri&&(this.whipResource={location:Ri,sessionDeleteLink:Di,mediaControls:bi},this.sfuResource=function(ui){const Tn=ui.match(/https:\/\/([^/]+)\//);if(Tn){const $n=Tn[1].split(".");if($n[0].includes("video-rtx"))return{node:`${$n[0]}.${$n[1]}`,cluster:$n[1]}}}(Ri)||{node:"",cluster:""},this.statsReporter.updateSfuResource(this.sfuResource));try{this.perfTracker.markSetRemoteDescStart(),yield(Oe=this.peerConnection)===null||Oe===void 0?void 0:Oe.setRemoteDescription({sdp:Mi,type:"answer"}),this.perfTracker.markSetRemoteDescStop(),this.perfTracker.markPostStop()}catch(ui){const Tn=new Ii(Object.assign(Object.assign({},Bt.SET_ANSWER_FAILURE),{action:Kt,token:lt,traceId:wt,tag:Co(Kt,It),location:"setRemoteDescription",remoteParticipantId:It,details:ui instanceof Error?ui.message:""}));this.analyticsTracker.trackError(Tn),this.emit(_f,Tn)}}),this.cleanup=(pe,Ne,Je,Ye=!1)=>Va(this,void 0,void 0,function*(){var Oe,ye,lt;const wt=Ca();if(this.toggleStageConnectionListeners(!1),this.currentJitterBufferMinDelayInMs=void 0,this.stageConnection=void 0,!(!((Oe=this.whipResource)===null||Oe===void 0)&&Oe.location))return this.trace(Je,this.traceId,"whipResource location not known, exiting cleanup",pe,Ne),void this.analyticsTracker.trackError(new Ii(Object.assign(Object.assign({},Bt.WHIP_URL_MISSING),{action:pe,token:Je,traceId:this.traceId,tag:Co(pe,Ne),location:pe===fn.SUBSCRIBE?"unsubscribe":"unpublish",requestUUID:wt,remoteParticipantId:Ne})));let Kt=this.whipResource.location;if(this.trace(Je,this.traceId,`use hostnamecachedurl: ${Kt}`,pe,Ne),Ye){if(!((lt=this.whipResource)===null||lt===void 0)&&lt.sessionDeleteLink){Kt=this.whipResource.sessionDeleteLink,this.trace(Je,this.traceId,`DELETE via session-delete beacon path: ${Kt}`,pe,Ne);try{navigator.sendBeacon(Kt,JSON.stringify({authorization:Je.rawToken}))}catch(It){this.analyticsTracker.trackErrorAndThrow(new Ii(Object.assign(Object.assign({},Pp(Bt.WHIP_DELETE_FAILURE,It)),{action:pe,token:Je,traceId:this.traceId,tag:Co(pe,Ne),location:fn.SUBSCRIBE?"unsubscribe":"unpublish",requestUUID:wt,remoteParticipantId:Ne})))}}}else try{yield Js().delete(Kt,{headers:{Authorization:`Bearer ${Je.rawToken}`,"X-Stages-Platform":"web","X-Stages-Request-ID":wt.value,"X-Stages-SDK":"1.19.0","X-Stages-Session-ID":this.analyticsTracker.getSessionId(),"X-Stages-Trace-ID":this.traceId.value,"X-Stages-WHIP-Version":bc}})}catch(It){((ye=It.response)===null||ye===void 0?void 0:ye.status)===404?this.trace(Je,this.traceId,`DELETE returned 404, ignoring, action = ${pe}, uuid = ${wt.value}`,pe,Ne):this.analyticsTracker.trackErrorAndThrow(new Ii(Object.assign(Object.assign({},Pp(Bt.WHIP_DELETE_FAILURE,It)),{action:pe,token:Je,traceId:this.traceId,tag:Co(pe,Ne),location:fn.SUBSCRIBE?"unsubscribe":"unpublish",requestUUID:wt,remoteParticipantId:Ne})))}}),this.getConnectionState=()=>{if(!this.peerConnection)return at.NONE;const pe=this.peerConnection.connectionState||this.peerConnection.iceConnectionState;try{return VE(pe)}catch{return this.logger.warn({msg:"Unhandled connection state:",rawState:pe}),at.IDLE}},this.onIceCandidateError=pe=>{const{token:Ne,traceId:Je,tag:Ye}=this;if(pe.errorCode!==701){const Oe=new Ii(Object.assign(Object.assign({},Bt.ICE_CANDIDATE_ERROR),{action:this.action,token:Ne,traceId:Je,tag:Ye,location:"onIceCandidateError",remoteParticipantId:this.identifier}));this.analyticsTracker.trackError(Oe),this.emit(_f,Oe)}},this.onIceConnectionStateChange=()=>{var pe;const{token:Ne,traceId:Je,action:Ye,identifier:Oe}=this;this.trace(Ne,Je,`ICE connection state change: ${(pe=this.peerConnection)===null||pe===void 0?void 0:pe.iceConnectionState}`,Ye,Oe),this.onConnectionStateChange()},this.createVideoReceiverTransformer=({enabled:pe})=>{const Ne=new Zm({enabled:pe}),{token:Je,tag:Ye,identifier:Oe,action:ye,traceId:lt}=this;Ne.on(sS,It=>{this.emit(kp,It)});const wt=function(It,Kn){let wn=0;return function(..._i){const zi=Date.now();zi-wn>=Kn&&(wn=zi,It(..._i))}}(It=>{const Kn=`Transform error occurred: ${It.type}`,wn=iS({traceId:lt,token:Je,tag:Ye,identifier:Oe,action:ye,details:Kn,stageErrorValue:Bt.TRANSFORM_UNEXPECTED_ERROR});this.logger.warn({err:wn,msg:"Error encountered when transforming receiver",error:It})},1e3),Kt=It=>{const Kn=`Too many errors occurred: ${It.type}`,wn=iS({traceId:lt,token:Je,tag:Ye,identifier:Oe,action:ye,details:Kn,stageErrorValue:Bt.TRANSFORM_TOO_MANY_ERRORS});this.logger.error({err:wn,msg:"Too many errors encountered when transforming receiver. Shutting down transformer.",error:It}),Ne.destroy(),this.analyticsTracker.trackError(wn),this.emit(dt,wn)};return Ne.on(lv,It=>{It.stageErrorValue.code!==Bt.TRANSFORM_TOO_MANY_ERRORS.code?wt(It):Kt(It)}),Ne},this.onConnectionStateChange=()=>{var pe;if(this.peerConnection){const Je=this.peerConnection.connectionState||this.peerConnection.iceConnectionState,{token:Ye,traceId:Oe,identifier:ye,action:lt}=this,wt=new Ha(lt,Ye,Oe,Je,ye);this.analyticsTracker.trackEventNoSharedProps(wt),this.trace(Ye,Oe,`connection state change: ${Je}`,lt,ye)}const Ne=this.getConnectionState();switch(Ne){case at.CONNECTED:this.perfTracker.markActionStop(),this.emit(Zs,Ne),this.statsReporter.updateMultihostConfiguration(this.audioTrackForPub,this.videoTrackForPub),(pe=this.peerConnection)===null||pe===void 0||pe.getTransceivers().forEach(Je=>{var Ye,Oe;!((Oe=(Ye=Je.receiver)===null||Ye===void 0?void 0:Ye.transport)===null||Oe===void 0)&&Oe.iceTransport&&Je.receiver.transport.iceTransport.addEventListener("selectedcandidatepairchange",this.onSelectedCandidatePairChange)});break;case at.FAILED:this.emit(Zs,Ne),this.handleConnectionFailure();break;default:this.emit(Zs,Ne)}},this.onIncompatibleCodecs=pe=>Va(this,void 0,void 0,function*(){if(pe.forEach(Ye=>{let Oe=!1;this.incompatibleCodecs.forEach(ye=>{ye.config===Ye.config&&ye.mime===Ye.mime&&(Oe=!0)}),Oe||this.incompatibleCodecs.add(Ye)}),this.peerConnection)try{yield(Ne=this.peerConnection,Je=[...this.incompatibleCodecs],WE(void 0,void 0,void 0,function*(){var Ye;for(const Oe of Ne.getSenders()){const ye=Oe.getParameters();if(ye.codecs.length>1){const lt=ye.codecs[0];let wt=!1;for(const Kt of Je)Th(lt,Kt)&&(wt=!0);if(wt){const Kt=Z0(Je,ye.codecs);(Ye=ye.encodings)===null||Ye===void 0||Ye.forEach(It=>{It.active&&(It.codec=Kt)}),yield Oe.setParameters(ye)}}}}))}catch(Ye){const{token:Oe,action:ye,traceId:lt,identifier:wt}=this,Kt=new Ii(Object.assign(Object.assign({},Bt.CODEC_HANDLE_INCOMPATIBLE_UNEXPECTED_ERROR),{action:ye,token:Oe,traceId:lt,tag:Co(ye,wt),location:"onIncompatibleCodecs",remoteParticipantId:wt,details:Ye instanceof Error?Ye.message:""}));this.analyticsTracker.trackError(Kt),this.emit(_f,Kt)}var Ne,Je}),this.token=S,this.logger=new ro(A,me.WEBRTC),this.action=O,this.tag=L,this.traceId=B,O===fn.SUBSCRIBE&&!te)throw new Error("Subscribe action provided without subscriber Id");this.inBandMessagingEnabled=O===fn.SUBSCRIBE?!!(!((ae=K==null?void 0:K.inBandMessaging)===null||ae===void 0)&&ae.enabled):(he=gh("enableInBandMessaging"))!==null&&he!==void 0&&he,this.jitterBufferConfig=K==null?void 0:K.jitterBuffer,this.simulcastSubscribeConfig=K==null?void 0:K.simulcast,this.subscriberId=te,this.stageConnection=re,this.videoSenderTransformer=new uy({enabled:this.action===fn.PUBLISH&&this.inBandMessagingEnabled}),this.videoReceiverTransformer=this.createVideoReceiverTransformer({enabled:this.action===fn.SUBSCRIBE&&this.inBandMessagingEnabled}),this.perfTracker=new qE(this.action,this.traceId),this.statsReporter=new iv(O,S,B,this.identifier,this.analyticsTracker,this.videoReceiverTransformer),this.sdpExchanger=function(pe){const{connection:Ne,token:Je,action:Ye,identifier:Oe,tracker:ye}=pe,lt=Ne&&Ne.supportsSdpExchange(),wt=Ye===fn.SUBSCRIBE&&lt&&!q_(),Kt=Ye===fn.PUBLISH&&lt&&M0()&&!q_();return wt||Kt?new tS(Je,Ne,{action:Ye,remoteParticipantId:Oe},ye):new cy(Je,{action:Ye,remoteParticipantId:Oe},ye)}({connection:re,action:O,token:S,identifier:this.identifier,tracker:H}),this.handlePublishingChangedBinding=this.handlePublishingChanged.bind(this),this.toggleStageConnectionListeners(!0)}get videoMediaId(){var S,A;return(A=(S=this.videoTransceiver)===null||S===void 0?void 0:S.mid)!==null&&A!==void 0?A:null}toggleStageConnectionListeners(S){var A,O;S?(A=this.stageConnection)===null||A===void 0||A.on(_c,this.handlePublishingChangedBinding):(O=this.stageConnection)===null||O===void 0||O.off(_c,this.handlePublishingChangedBinding)}updateSubscribeConfig(S){var A,O;this.jitterBufferConfig=S.jitterBuffer,this.simulcastSubscribeConfig=S.simulcast,this.action===fn.SUBSCRIBE&&(this.inBandMessagingEnabled=S.inBandMessaging.enabled),this.applyJitterBufferMinDelayConditionally((O=(A=this.stageConnection)===null||A===void 0?void 0:A.getIsStagePublishing())!==null&&O!==void 0&&O)}verifyOrUpdateTransceiverSync(){var S,A;return Va(this,void 0,void 0,function*(){if(this.videoTrackForPub){const O=this.getTransceiverForKind("video");O?this.videoTrackForPub.track.id!==((S=O.sender.track)===null||S===void 0?void 0:S.id)&&(this.logger.debug({msg:"found out of sync video transceiver... updating"}),yield this.replaceOrUpdateTrack(this.videoTrackForPub)):this.logger.warn({msg:"missing transceiver for video"})}if(this.audioTrackForPub){const O=this.getTransceiverForKind("audio");O?this.audioTrackForPub.track.id!==((A=O.sender.track)===null||A===void 0?void 0:A.id)&&(this.logger.debug({msg:"found out of sync audio transceiver... updating"}),yield this.replaceOrUpdateTrack(this.audioTrackForPub)):this.logger.warn({msg:"missing transceiver for audio"})}})}start(){var S,A,O;return Va(this,void 0,void 0,function*(){const{token:L,action:B,traceId:H,identifier:te}=this;B!==fn.PUBLISH||L.claims.capabilities.allow_publish||this.analyticsTracker.trackErrorAndThrow(new Ii(Object.assign(Object.assign({},Pp(Bt.TOKEN_PERMISSIONS_DENIED,new Error("Cannot publish with subscribe only token"))),{action:B,token:L,traceId:H,tag:Co(B,te),location:"StagePeerClient.start",remoteParticipantId:te})));const re=function({action:K,identifier:ae,token:he,analyticsTracker:pe}){let Ne="";const Je=Iu(he,pe);switch(K){case fn.PUBLISH:Ne=Je.getPublishEndpoint();break;case fn.SUBSCRIBE:ae&&(Ne=Je.getSubscribeEndpoint(ae))}return Ne}({action:B,identifier:te,token:L.rawToken,analyticsTracker:this.analyticsTracker});try{this.perfTracker.markActionStart(),this.stageCapabilities={simulcastNegotiated:(O=(A=(S=this.videoTrackForPub)===null||S===void 0?void 0:S.config)===null||A===void 0?void 0:A.simulcastEnabled)!==null&&O!==void 0&&O},this.endpointURL=re,this.peerConnection=new RTCPeerConnection({iceTransportPolicy:"all"}),this.statsReporter.start(this.peerConnection,this.stageCapabilities.simulcastNegotiated),this.peerConnection.addEventListener("connectionstatechange",this.onConnectionStateChange),this.peerConnection.addEventListener("iceconnectionstatechange",this.onIceConnectionStateChange),this.peerConnection.addEventListener("icecandidateerror",this.onIceCandidateError),this.peerConnection.addEventListener("icegatheringstatechange",this.onIceGatheringStateChange),this.peerConnection.addEventListener("icecandidate",this.onIceCandidate),this.peerConnection.addEventListener("track",this.onTrack),this.peerConnection.addEventListener("mute",this.onMute),this.peerConnection.addEventListener("unmute",this.onUnMute),this.trace(L,H,"peer connection created",B,te)}catch(K){const ae=new Ii(Object.assign(Object.assign({action:B},Pp(Bt.CREATE_PEER_CONNECTION_FAILURE,K)),{token:L,traceId:H,tag:Co(B,te),location:"StagePeerClient.start",remoteParticipantId:te}));B===fn.PUBLISH&&this.emit(Zs,at.FAILED),this.emit(_f,ae),this.analyticsTracker.trackErrorAndThrow(ae)}})}mungeSdpOffer(S,A,O){if(O.simulcastNegotiated&&(S=new jr(S).withVideoLayersAllocationRtpHeaderExtension().sdp),A===fn.SUBSCRIBE)S=new jr(S).withOpusAudioConfig(ao(or),!0).sdp;else if(A===fn.PUBLISH&&O.audioConfig){const{maxBitrateBps:L,stereo:B}=O.audioConfig;S=new jr(S).withOpusAudioConfig(L,B).sdp}return S}mungeSdpAnswer(S){return hs.browser.isFirefox()&&this.audioTrackForPub&&this.action===fn.PUBLISH&&(S=new jr(S).withOpusAudioConfig(this.audioTrackForPub.config.maxBitrateBps,void 0).sdp),S}stop(){var S,A,O,L,B,H,te,re,K;this.statsReporter.stop(),this.videoReceiverTransformer.destroy(),this.videoSenderTransformer.destroy(),(S=this.peerConnection)===null||S===void 0||S.removeEventListener("connectionstatechange",this.onConnectionStateChange),(A=this.peerConnection)===null||A===void 0||A.removeEventListener("iceconnectionstatechange",this.onIceConnectionStateChange),(O=this.peerConnection)===null||O===void 0||O.removeEventListener("icecandidateerror",this.onIceCandidateError),(L=this.peerConnection)===null||L===void 0||L.removeEventListener("icegatheringstatechange",this.onIceGatheringStateChange),(B=this.peerConnection)===null||B===void 0||B.removeEventListener("track",this.onTrack),(H=this.peerConnection)===null||H===void 0||H.removeEventListener("mute",this.onMute),(te=this.peerConnection)===null||te===void 0||te.removeEventListener("unmute",this.onUnMute),(re=this.peerConnection)===null||re===void 0||re.removeEventListener("icecandidate",this.onIceCandidate),(K=this.peerConnection)===null||K===void 0||K.close()}getTransceiverForKind(S){if(!this.peerConnection)return;const A=this.peerConnection.getTransceivers();return S==="audio"?A.find(O=>O.mid==="0"):S==="video"?A.find(O=>O.mid==="1"):void 0}removeTrack(S){return Va(this,void 0,void 0,function*(){if(S==="audio"||S==="video")if(this.peerConnection)try{const A=this.getTransceiverForKind(S);if(!A)return void this.logger.warn({msg:`tried removing track type ${S} but couldn't find transceiver`});yield A.sender.replaceTrack(null),S===Du.AUDIO?this.audioTrackForPub=void 0:this.videoTrackForPub=void 0,yield this.statsReporter.updateMultihostConfiguration(this.audioTrackForPub,this.videoTrackForPub)}catch(A){this.logger.warn({msg:"error replacing track",err:A})}else S===Du.AUDIO?this.audioTrackForPub=void 0:this.videoTrackForPub=void 0;else this.logger.warn({msg:"RemoveTrack called with invalid track type",trackType:S})})}replaceOrUpdateTrack(S){return Va(this,void 0,void 0,function*(){if(S.track){if(Ol(S)?this.audioTrackForPub=S:ov(S)&&(this.videoTrackForPub=S),this.peerConnection)try{const A=this.getTransceiverForKind(S.track.kind);if(!A)return void this.logger.warn({msg:`tried replacing track type ${S.track.kind} but couldn't find transceiver`,track:S.track});if(ov(S)){const O=A.sender.getParameters(),L=Ah(this.stageCapabilities.simulcastNegotiated,S);O.encodings=O.encodings.map(B=>{var H;const te=(H=B.rid)!==null&&H!==void 0?H:"",re=L.find(K=>{var ae;return((ae=K.rid)!==null&&ae!==void 0?ae:"")===te});return re?Object.assign(Object.assign({},B),re):B}),yield A.sender.setParameters(O)}else if(Ol(S)){const O=A.sender.getParameters(),L=Uu(S)[0];O.encodings=O.encodings.map(B=>Object.assign(Object.assign({},B),L)),yield A.sender.setParameters(O)}yield A.sender.replaceTrack(S.track),yield this.statsReporter.updateMultihostConfiguration(this.audioTrackForPub,this.videoTrackForPub)}catch(A){this.logger.warn({msg:"error replacing track",err:A})}}else this.logger.warn({msg:"Unexpected call to replaceOrUpdateTrack with no track"})})}initializePeerConnection(S=!1){var A,O,L;return Va(this,void 0,void 0,function*(){const{traceId:B,token:H,action:te,identifier:re}=this;P0(this.peerConnection);let K=new MediaStream;if(te===fn.PUBLISH){this.audioTrackForPub||(this.audioTrackForPub={track:this.getSilentAudio(),config:{maxBitrateBps:ao(Y0),stereo:!1}});const ae=this.peerConnection.getTransceivers(),he=[];ae.forEach(ye=>{var lt;he.concat((lt=ye.sender.track)===null||lt===void 0?void 0:lt.id)}),K=new MediaStream([this.audioTrackForPub.track,(A=this.videoTrackForPub)===null||A===void 0?void 0:A.track].filter(ye=>!!ye&&!he.includes(ye.id)));const pe=K.getAudioTracks()[0]||"audio",Ne=K.getVideoTracks()[0]||"video",Je={direction:"sendonly",streams:[K],sendEncodings:Uu(this.audioTrackForPub)},Ye={direction:"sendrecv",streams:[K],sendEncodings:Ah(this.stageCapabilities.simulcastNegotiated,this.videoTrackForPub)};this.peerConnection.addTransceiver(pe,Je),this.trace(H,B,`track added, type: ${pe.kind||pe}`,te,re);const Oe=this.peerConnection.addTransceiver(Ne,Ye);this.trace(H,B,`track added, type: ${Ne.kind||Ne}`,te,re),this.inBandMessagingEnabled&&!uy.isSupported(Oe)&&this.handleTransformNotSupported(),this.videoSenderTransformer.onTransceiverAdd(Oe)}else te===fn.SUBSCRIBE&&(H.shouldSendSilentAudio()?this.peerConnection.addTransceiver(this.getSilentAudio(),{direction:"sendrecv"}):this.peerConnection.addTransceiver("audio",{direction:"recvonly"}),this.trace(H,B,"track added, type: audio",te,re),S||(this.videoTransceiver=this.peerConnection.addTransceiver("video",{direction:"recvonly"}),this.trace(H,B,"track added, type: video",te,re),this.inBandMessagingEnabled&&!Zm.isSupported(this.videoTransceiver)&&this.handleTransformNotSupported(),this.videoReceiverTransformer.onTransceiverAdd(this.videoTransceiver)),this.peerConnection.getTransceivers().forEach(ae=>{ae.receiver?(this.logger.info({msg:"dbg: Subscribe succeeded, adding media track to participant mediaStream"}),K==null||K.addTrack(ae.receiver.track)):this.logger.info({msg:"dbg: Subscribe succeeded, but Transceiver were negotiated without Receiver"})}),this.applyJitterBufferMinDelayConditionally((L=(O=this.stageConnection)===null||O===void 0?void 0:O.getIsStagePublishing())!==null&&L!==void 0&&L));return K})}handlePublishingChanged(S){this.logger.debug({msg:`[handlePublishingChanged (${this.subscriberId})] isStagePublishing: ${S}, currentMinDelay: ${this.currentJitterBufferMinDelayInMs}`}),this.action===fn.SUBSCRIBE&&this.applyJitterBufferMinDelayConditionally(S)}applyJitterBufferMinDelayConditionally(S){const A=this.currentJitterBufferMinDelayInMs,O=this.calcJitterBufferMinDelay(S,this.jitterBufferConfig);if(S){if(A===void 0||A>O){const L=`[applyJitterBufferMinDelayConditionally (${this.subscriberId})] participant is publishing and min delay is unset or > configured; attempting to update to ${O}`;this.logger.debug({msg:L}),this.trace(this.token,this.traceId,L,this.action,this.identifier),this.applyAndTrackJitterBufferMinDelay(O)}}else if(A===void 0||O!==A){const L=`[applyJitterBufferMinDelayConditionally (${this.subscriberId})] participant is subscribe-only and min delay is unset or != configured; attempting to update to ${O}`;this.logger.debug({msg:L}),this.trace(this.token,this.traceId,L,this.action,this.identifier),this.applyAndTrackJitterBufferMinDelay(O)}}calcJitterBufferMinDelay(S,A){var O,L,B;let H=0;if(!(()=>{const te=RTCRtpReceiver.prototype;return!(!te||typeof te!="object")&&("jitterBufferTarget"in te||"playoutDelayHint"in te)})())return 0;if(S)H=ja((O=A==null?void 0:A.minDelayWhenPublishing)!==null&&O!==void 0?O:Gs.DEFAULT,S);else{H=ja((L=A==null?void 0:A.minDelayWhenSubscribeOnly)!==null&&L!==void 0?L:Gs.DEFAULT,S);const te=(B=this.stageConnection)===null||B===void 0?void 0:B.jitterBufferMinDelayInMs();(A==null?void 0:A.minDelayWhenSubscribeOnly)===Gs.DEFAULT&&te!==void 0&&(H=te,this.logger.debug({msg:`[calcJitterBufferMinDelay] overriding min delay with remote value: ${H}`}))}return H}applyAndTrackJitterBufferMinDelay(S){var A,O;this.currentJitterBufferMinDelayInMs=S,this.statsReporter.updateJitterBufferMinDelay(S),S!==void 0&&((O=(A=this.peerConnection)===null||A===void 0?void 0:A.getTransceivers())===null||O===void 0||O.forEach(L=>{L.receiver&&this.applyJitterBufferMinDelay(L.receiver,S)}))}applyJitterBufferMinDelay(S,A){let O="Unable to set jitter buffer min delay";if("jitterBufferTarget"in S)O=`setting jitterBufferTarget to: ${A} for track: ${S.track.kind}`,this.logger.debug({msg:O}),S.jitterBufferTarget=A;else if("playoutDelayHint"in S){const L=A/1e3;O=`setting playoutDelayHint to: ${A} for track: ${S.track.kind}`,this.logger.debug({msg:O}),S.playoutDelayHint=L}else this.logger.warn({msg:O});this.trace(this.token,this.traceId,O,this.action,this.identifier)}exchangeSdp(S){var A;return Va(this,void 0,void 0,function*(){const{traceId:O,token:L,action:B,identifier:H,tag:te,endpointURL:re}=this,{iceRestart:K=!1,nodeOverride:ae,assignmentToken:he,abortController:pe}=S;let Ne;this.logger.debug({msg:`Exchanging SDP: ${O.value}, iceRestart=${K}, nodeOverride=${ae}, assignmentToken=${he}`}),P0(this.peerConnection),B===fn.PUBLISH&&$o()&&(this.logger.debug({msg:"Applying publisher codec preference for main profile."}),((Ye,Oe)=>{var ye,lt;const wt=(ye=RTCRtpReceiver.getCapabilities("video"))===null||ye===void 0?void 0:ye.codecs;if(!wt)return;let Kt=wt;Kt=K0(wt,"42e0"),Oe.preferMainProfile&&(Kt=K0(wt,"4d00")),(lt=Ye.getTransceivers().find(It=>It.receiver.track.kind==="video"))===null||lt===void 0||lt.setCodecPreferences(Kt)})(this.peerConnection,{preferMainProfile:$o()}));try{this.trace(L,O,"Creating offer",B,H),Ne=yield this.peerConnection.createOffer({iceRestart:K})}catch(Ye){const Oe=new Ii(Object.assign(Object.assign({},Pp(Bt.CREATE_OFFER_FAILURE,Ye)),{action:B,token:L,traceId:O,tag:te,location:"exchangeSdp",remoteParticipantId:H}));this.emit(_f,Oe),this.analyticsTracker.trackErrorAndThrow(Oe)}Ne.sdp&&(Ne.sdp=this.mungeSdpOffer(Ne.sdp,B,{simulcastNegotiated:this.stageCapabilities.simulcastNegotiated,audioConfig:(A=this.audioTrackForPub)===null||A===void 0?void 0:A.config})),this.trace(L,O,"Setting local description",B,H),yield this.peerConnection.setLocalDescription(Ne),this.trace(L,O,"local description set",B,H),re||this.logger.warn({msg:"Unexpected state: No endpointURL specified for fetching of remote description."});const Je=B===fn.PUBLISH&&$o()||B===fn.SUBSCRIBE&&gh("multiCodecAnswer");yield this.fetchAndSetRemoteDescription({endpointURL:re,nodeOverride:ae,assignmentToken:he,multiCodec:Je,abortController:pe})})}getReports(){var S;return Va(this,void 0,void 0,function*(){try{const A=(yield(S=this.peerConnection)===null||S===void 0?void 0:S.getStats())||[],O=[];return A.forEach(L=>{O.push(L)}),O}catch{return[]}})}requestRTCStats(S){return Va(this,void 0,void 0,function*(){if(this.peerConnection)return this.peerConnection.getStats(S)})}get identifier(){return this.subscriberId||this.token.participantID}handleTransformNotSupported(){const{token:S,tag:A,identifier:O,action:L,traceId:B}=this,H=iS({traceId:B,token:S,tag:A,identifier:O,action:L,stageErrorValue:Bt.TRANSFORM_NOT_SUPPORTED_BY_PLATFORM});this.logger.error({err:H,msg:"Transforms not supported by this platform"}),this.analyticsTracker.trackError(H),this.emit(dt,H)}handleConnectionFailure(){return Va(this,void 0,void 0,function*(){const{token:S,traceId:A,tag:O}=this;this.analyticsTracker.trackError(new Ii(Object.assign(Object.assign({},Bt.PEER_CONNECTION_NETWORK_FAILURE),{action:this.action,token:S,traceId:A,tag:O,location:"onIceCandidateError",remoteParticipantId:this.identifier})))})}getSilentAudio(){Jm||(Jm=new AudioContext);const S=Jm.createOscillator(),A=Jm.createGain();S.connect(A);const O=Jm.createMediaStreamDestination();return A.connect(O),A.gain.value=0,S.start(),O.stream.getAudioTracks()[0]}getActionMeasurements(){return this.perfTracker.getMeasurements()}initTracksToPublish(S){this.videoTrackForPub=S.find(ov),this.audioTrackForPub=S.find(Ol)}getSfuResource(){return this.sfuResource}getExpectedJitterBufferMinDelayInMs(){var S,A;return this.calcJitterBufferMinDelay((A=(S=this.stageConnection)===null||S===void 0?void 0:S.getIsStagePublishing())!==null&&A!==void 0&&A,this.jitterBufferConfig)}trace(S,A,O,L,B){this.analyticsTracker.trackEventNoSharedProps(new Hm(S,A,O,L,B))}sendSeiMessage(S){var A;this.action===fn.PUBLISH&&((A=this.videoSenderTransformer)===null||A===void 0||A.sendSeiMessage(S))}}const hy=fn.SUBSCRIBE;class ju{constructor(S,A,O){this.analyticsTracker=S,this.token=A,this.remoteId=O,this.action=hy}trackAttempt({stageConnectionStats:S,isReassignment:A=!1,traceIdOverride:O,preAttemptSfuResource:L}){const{action:B,analyticsTracker:H,token:te,remoteId:re}=this,K=O||gc();return H.trackEvent(new Ym({token:this.token,subscribedId:this.remoteId,traceId:K,isEdpConnected:S.isConnected,isReassignment:A,preAttemptSfuResource:L})),{getTraceId:()=>K,trackSubscribeStarted({totalDurationWithRetries:ae,retryTimes:he,sfuResource:pe,peerClientPerfStats:Ne}){const{optionsDuration:Je,postDuration:Ye,timeToCandidate:Oe,timeToConnected:ye,sdpExchangeDuration:lt,sdpExchangeTransport:wt,setRemoteDescDuration:Kt,peerConnectionDuration:It}=Ne,{edpInitialConnectDuration:Kn,edpInitialConnectRetries:wn,edpInitialStateDuration:_i,edpInitialStatePublishingCount:zi,edpStateUpdateCount:ki}=S;H.trackEvent(new Gp({token:te,traceId:K,remoteParticipantId:re,optionsDuration:Je,postDuration:Ye,timeToCandidate:Oe,totalDuration:ye,edpInitialConnectDuration:Kn,edpInitialConnectRetries:wn,edpInitialStateDuration:_i,edpInitialStatePublishingCount:zi,edpStateUpdateCount:ki,sdpExchangeDuration:lt,sdpExchangeTransport:wt,setRemoteDescDuration:Kt,peerConnectionDuration:It,sfuResource:pe,totalDurationWithRetries:ae,subscribeRetryTimes:he,isReassignment:A}))},trackSubscribeFirstFrame:({peerClientPerfStats:ae,totalDurationWithRetries:he,sfuResource:pe,retryTimes:Ne,currentJitterBufferMinDelayInMs:Je,mediaType:Ye,firstFrameDuration:Oe})=>{const{sdpExchangeDuration:ye,sdpExchangeTransport:lt,setRemoteDescDuration:wt,peerConnectionDuration:Kt}=ae,{edpInitialConnectDuration:It,edpInitialConnectRetries:Kn,edpInitialStateDuration:wn,edpInitialStatePublishingCount:_i,edpStateUpdateCount:zi}=S;this.analyticsTracker.trackEvent(new rx({token:this.token,traceId:K,remoteParticipantId:re,edpInitialConnectDuration:It,edpInitialConnectRetries:Kn,edpInitialStateDuration:wn,edpInitialStatePublishingCount:_i,edpStateUpdateCount:zi,sdpExchangeDuration:ye,sdpExchangeTransport:lt,setRemoteDescDuration:wt,peerConnectionDuration:Kt,videoWasPaused:!1,firstFrameDuration:Oe,mediaType:Ye,sfuResource:pe,totalDurationWithRetries:he,subscribeRetryTimes:Ne,currentJitterBufferMinDelayInMs:Je}))},trackSubscribeFailed(ae,he){const pe=((Ye,Oe,ye)=>{if(Ye instanceof Ii)return Ye;let lt="";return Ye instanceof ws.AxiosError&&(lt+=`AxiosError - ${Ye.code}`),new Ii(Object.assign(Object.assign(Object.assign({},Bt.SUBSCRIBE_FAILURE),{action:hy,token:Oe,traceId:ye,tag:vc.SUBSCRIBE_RELATED,location:"subscribe",details:`${lt} ${Ye==null?void 0:Ye.message}`}),{fatal:!0}))})(ae,te,K);H.trackEvent(new JE({token:te,traceId:K,remoteParticipantId:re,code:pe.code,message:pe.message,fatal:pe.fatal,nominal:pe.nominal,isReassignment:A}));const{isConnected:Ne}=S,Je=new Ii(Object.assign(Object.assign({},Bt.SUBSCRIBE_FAILURE),{action:B,token:te,traceId:K,tag:Co(fn.SUBSCRIBE,re),location:"subscribe",remoteParticipantId:re,isEdpConnected:Ne,details:he}));return ae instanceof Ii&&(Je.fatal=ae.fatal,Je.nominal=ae.nominal,Je.location=`subscribe > ${ae.location}`),H.trackError(Je),pe},trackUnsubscribe:()=>{H.trackEvent(new tx({token:te,unsubscribedId:re,traceId:K}))},trackEndSucceeded:ae=>{H.trackEvent(new Xm({token:te,traceId:K,remoteParticipantId:re,isUnsubscribeSuccessful:!0,reason:ae}))},trackEndFailed:ae=>{const he=new Ii(Object.assign(Object.assign({},Bt.UNSUBSCRIBE_FAILURE),{token:te,traceId:K,tag:Co(fn.SUBSCRIBE,re),location:"unsubscribe",remoteParticipantId:re}));return ae!==Aa.UNLOAD&&ae!==Aa.UNSUBSCRIBE||H.trackError(he),H.trackEvent(new Xm({token:te,traceId:K,remoteParticipantId:re,isUnsubscribeSuccessful:!0,reason:ae})),he}}}}class $p extends qn{constructor(S,A,O,L,B,H){super(bn.PLAYBACK_LAYER_REQUEST,S,A,!1),Object.assign(this.properties,{media_type:O,remote_participant_id:L,track_id:B,layer_id:H})}}class aS extends qn{constructor(S,A,O,L,B,H=1){super(bn.PLAYBACK_LAYER_STATE,S,A,!1),Object.assign(this.properties,{media_type:O,remote_participant_id:L,track_id:B,request_count:H})}}var Qm,Ga,eg,ma;(function(N){N.PAUSE="pause",N.PLAY="play"})(Qm||(Qm={})),function(N){N.IDLE="idle",N.ACTIVE="active",N.ERRORED="errored",N.DESTROYED="destroyed"}(Ga||(Ga={})),function(N){N.SUCCESS="success"}(eg||(eg={})),function(N){N.FAILED="failed",N.DESTROYED="destroyed",N.THROTTLED="throttled"}(ma||(ma={}));var Rh=function(N,S,A,O){return new(A||(A=Promise))(function(L,B){function H(K){try{re(O.next(K))}catch(ae){B(ae)}}function te(K){try{re(O.throw(K))}catch(ae){B(ae)}}function re(K){var ae;K.done?L(K.value):(ae=K.value,ae instanceof A?ae:new A(function(he){he(ae)})).then(H,te)}re((O=O.apply(N,[])).next())})};class cx{constructor(S){this.state=Ga.IDLE,this.mid=null,this.playbackEndpoint=null,this.layersEndpoint=null,this.stopVideo=()=>Rh(this,void 0,void 0,function*(){return this.state!==Ga.ACTIVE?(this.logCommandSkipped("stopVideo"),this.mapSkippedResultFromState(this.state)):this.sendPlaybackRequest(Qm.PAUSE)}),this.startVideo=()=>Rh(this,void 0,void 0,function*(){return this.state!==Ga.ACTIVE?(this.logCommandSkipped("startVideo"),this.mapSkippedResultFromState(this.state)):this.sendPlaybackRequest(Qm.PLAY)}),this.setLayer=A=>Rh(this,void 0,void 0,function*(){return this.state!==Ga.ACTIVE?(this.logCommandSkipped("setLayer"),this.mapSkippedResultFromState(this.state)):this.sendLayerRequest(A)}),this.unsetLayer=()=>Rh(this,void 0,void 0,function*(){return this.state!==Ga.ACTIVE?(this.logCommandSkipped("unsetLayer"),this.mapSkippedResultFromState(this.state)):this.sendLayerRequest()}),this.getLayers=()=>Rh(this,void 0,void 0,function*(){return this.state!==Ga.ACTIVE?(this.logCommandSkipped("getLayers"),this.mapSkippedResultFromState(this.state)):this.sendLayerStateRequest()}),this.sendPlaybackRequest=A=>Rh(this,void 0,void 0,function*(){if(!this.mid)return this.logger.warn({msg:"mid is unexpectedly undefined"}),(0,ti.err)(ma.FAILED);if(!this.playbackEndpoint)return this.logger.warn({msg:"Playback endpoint is unset and required for playback control requests"}),(0,ti.err)(ma.FAILED);this.logger.info({msg:`Sending ${A} request to ${this.playbackEndpoint}`});const O=A===Qm.PAUSE?{pause:[this.mid]}:{play:[this.mid]},L=this.createPostWhepRequest(O);return fetch(this.playbackEndpoint,L).then(B=>B.status>=300?(new Error(`Error sending media controls request: ${B.status}:${B.statusText}`),this.logger.error({err:ti.err}),(0,ti.err)(ma.FAILED)):(this.logger.debug({msg:`Request to ${A} was successful: ${B.status}`}),(0,ti.ok)(eg.SUCCESS))).catch(B=>(this.logger.error({err:B,msg:"Error sending media controls request"}),(0,ti.err)(ma.FAILED)))}),this.sendLayerRequest=A=>Rh(this,void 0,void 0,function*(){if(!this.mid)return this.logger.warn({msg:"mid is unexpectedly undefined"}),(0,ti.err)(ma.FAILED);if(!this.layersEndpoint)return this.logger.warn({msg:"Layers endpoint is unset and required for layer requests"}),(0,ti.err)(ma.FAILED);const O=typeof A=="string",L=O?{mediaId:this.mid,encodingId:A}:{},B=O?`set : ${A}`:"unset layer";this.logger.info({msg:`sendLayerRequest for ${B} at ${this.layersEndpoint}`});const H=this.createPostWhepRequest(L);return this.trackLayerRequest(A??"auto"),fetch(this.layersEndpoint,H).then(te=>this.state===Ga.DESTROYED?(0,ti.err)(ma.DESTROYED):te.status>=300?this.handleLayerRequestError(te.status,te.statusText):(this.logger.debug({msg:`Request to ${B} was successful: ${te.status}`}),(0,ti.ok)(eg.SUCCESS))).catch(te=>this.handleLayerRequestError(0,te.message))}),this.sendLayerStateRequest=()=>Rh(this,void 0,void 0,function*(){if(!this.mid)return this.logger.warn({msg:"mid is unexpectedly undefined"}),(0,ti.err)(ma.FAILED);if(!this.layersEndpoint)return this.logger.warn({msg:"Layers endpoint is unset and required for layer requests"}),(0,ti.err)(ma.FAILED);this.logger.info({msg:`sendLayerStateRequest for ${this.mid} at ${this.layersEndpoint}`});const A=this.createGetWhepRequest();return this.trackLayerStateRequest(),fetch(this.layersEndpoint,A).then(O=>Rh(this,void 0,void 0,function*(){var L;if(this.state===Ga.DESTROYED)return(0,ti.err)(ma.DESTROYED);if(O.status>=300)return this.handleLayerStateRequestError(O.status,O.statusText);const B=yield O.json(),H=(L=B==null?void 0:B.layers)!==null&&L!==void 0?L:[],te=JSON.stringify(H,null,2);return this.logger.debug({msg:`sendLayerStateRequest was successful: ${te}`}),(0,ti.ok)(H)})).catch(O=>this.handleLayerStateRequestError(0,O.message))}),this.logger=new ro(S.logger,me.REMOTE_PLAYBACK),this.token=S.token,this.traceId=S.traceId,this.analyticsTracker=S.analyticsTracker,this.remoteParticipantId=S.remoteParticipantId}set mediaId(S){if(this.state!==Ga.DESTROYED){if(this.mid=S,this.mid===null)return this.logger.info({msg:"media id is unset, controller is transitioning to idle state"}),void(this.state=Ga.IDLE);(this.playbackEndpoint||this.layersEndpoint)&&(this.state=Ga.ACTIVE)}else this.logCommandSkipped("set mediaId")}set endpoints(S){var A,O;if(this.state!==Ga.DESTROYED){if(this.playbackEndpoint=(A=S.playback)!==null&&A!==void 0?A:null,this.layersEndpoint=(O=S.layers)!==null&&O!==void 0?O:null,!this.playbackEndpoint||!this.layersEndpoint){const L={playbackEndpoint:this.playbackEndpoint,layersEndpoint:this.layersEndpoint};return this.logger.info({msg:`no endpoints are set, transitioning to idle state: ${JSON.stringify(L,null)}`}),void(this.state=Ga.IDLE)}this.mid&&(this.state=Ga.ACTIVE)}else this.logCommandSkipped("set endpoints")}destroy(){this.state=Ga.DESTROYED,this.mid=null,this.playbackEndpoint=null,this.layersEndpoint=null}logCommandSkipped(S="command"){this.logger.info({msg:`skipping ${S}, controller state invalid: ${this.state}`})}mapSkippedResultFromState(S){return S===Ga.DESTROYED?(0,ti.err)(ma.DESTROYED):(0,ti.err)(ma.FAILED)}createPostWhepRequest(S){return{method:"POST",headers:this.createRequestHeaders(),body:JSON.stringify(S)}}createGetWhepRequest(){return{method:"GET",headers:this.createRequestHeaders()}}createRequestHeaders(){var S,A;return{Authorization:`Bearer ${this.token.rawToken}`,"Content-Type":"application/json","X-Stages-Platform":"web","X-Stages-Request-ID":Ca().value,"X-Stages-SDK":"1.19.0","X-Stages-Session-ID":this.analyticsTracker.getSessionId(),"X-Stages-Trace-ID":(A=(S=this.traceId)===null||S===void 0?void 0:S.value)!==null&&A!==void 0?A:"","X-Stages-WHIP-Version":bc}}trackLayerRequest(S){var A;this.analyticsTracker.trackEventNoSharedProps(new $p(this.token,this.traceId,Xt.VIDEO,this.remoteParticipantId,(A=this.mid)!==null&&A!==void 0?A:"unknown",S))}trackLayerStateRequest(S=1){var A;this.analyticsTracker.trackEventNoSharedProps(new aS(this.token,this.traceId,Xt.VIDEO,this.remoteParticipantId,(A=this.mid)!==null&&A!==void 0?A:"unknown",S))}handleLayerRequestError(S,A){const O=`sendLayerRequest failed for reason: ${S} ${A}`;let L,B;return S===429?(L=ma.THROTTLED,B=Bt.WHEP_SET_LAYER_REQUEST_THROTTLED):(L=ma.FAILED,B=Bt.WHEP_SET_LAYER_REQUEST_FAILED),this.trackRequestError(B,O),(0,ti.err)(L)}handleLayerStateRequestError(S,A){const O=`sendLayerStateRequest failed for reason: ${S} ${A}`;let L,B;return S===429?(L=ma.THROTTLED,B=Bt.WHEP_GET_LAYER_STATE_THROTTLED):(L=ma.FAILED,B=Bt.WHEP_GET_LAYER_STATE_FAILED),this.trackRequestError(B,O),(0,ti.err)(L)}trackRequestError(S,A){const O=new Error(A);this.logger.error({err:O}),S.message=A;const L=this.createError(S);this.analyticsTracker.trackError(L)}createError(S,A){return new Ii(Object.assign({action:fn.SUBSCRIBE,traceId:this.traceId,token:this.token,location:"RemotePlaybackController",tag:vc.SUBSCRIBE_RELATED,details:A},S))}}var tg,fy,Jo,Oo,No=function(N,S,A,O){return new(A||(A=Promise))(function(L,B){function H(K){try{re(O.next(K))}catch(ae){B(ae)}}function te(K){try{re(O.throw(K))}catch(ae){B(ae)}}function re(K){var ae;K.done?L(K.value):(ae=K.value,ae instanceof A?ae:new A(function(he){he(ae)})).then(H,te)}re((O=O.apply(N,[])).next())})},oS=function(N,S,A,O){if(A==="a"&&!O)throw new TypeError("Private accessor was defined without a getter");if(typeof S=="function"?N!==S||!O:!S.has(N))throw new TypeError("Cannot read private member from an object whose class did not declare it");return A==="m"?O:A==="a"?O.call(N):O?O.value:S.get(N)};(function(N){N.DISCONNECTED="disconnected",N.CONNECTING="connecting",N.CONNECTED="connected",N.ERRORED="errored"})(Jo||(Jo={})),function(N){N.NONE="none",N.AUDIO_ONLY="audio_only",N.AUDIO_VIDEO="audio_video"}(Oo||(Oo={}));class lx extends Jc{constructor(S,A,O,L,B,H,te){super(),this.id=S,this.token=A,this.stageConnection=O,this.nonScopedLogger=L,this.analyticsTracker=B,this.desiredSubscribeType=H,tg.add(this),this.isSubscriptionActive=!1,this.subscriptionState={connectionState:Jo.DISCONNECTED,subscribeInProgress:!1},this.previousSignalState={isTargetPublishing:!1},this.failedRetries=0,this.startConnectingTimestamp=-1,this.throttler=new q0(1e3),this.cleanupFirstFrameTracking=$0,this.actualSubscribeType=Oo.NONE,this.action=fn.SUBSCRIBE,this.updateDesiredSubscribeType=K=>{this.desiredSubscribeType=K,this.attemptToActualizeSubscribeType()},this.updateSubscribeConfig=K=>{this.peerClient.updateSubscribeConfig(K)},this.getDesiredSubscribeType=()=>this.desiredSubscribeType,this.attemptToActualizeSubscribeType=()=>{const K=this.actualSubscribeType,ae=this.desiredSubscribeType;this.logger.debug({msg:`Attempt to actualize subscribe type to ${ae}`}),this.subscriptionState.connectionState===Jo.CONNECTED&&ae!==Oo.NONE&&K!==ae&&this.applyVideoControlsBySubscribeType(ae,K)},this.onParticipantUpdated=K=>{oS(this,tg,"m",fy).call(this,K)&&(this.logger.debug({msg:"onParticipantUpdated",participant:K}),this.processStateUpdate({isTargetPublishing:K.isPublishing}))},this.onParticipantJoined=K=>{oS(this,tg,"m",fy).call(this,K)&&(this.logger.debug({msg:"onParticipantJoined",participant:K}),this.processStateUpdate({isTargetPublishing:K.isPublishing}))},this.onParticipantLeft=K=>{oS(this,tg,"m",fy).call(this,K)&&(this.logger.debug({msg:"onParticipantLeft",participant:K}),this.processStateUpdate({isTargetPublishing:!1}))},this.requestRTCStats=K=>No(this,void 0,void 0,function*(){return this.peerClient.requestRTCStats(K)}),this.trySubscribe=K=>No(this,void 0,void 0,function*(){if(this.logger.debug({msg:`Subscribe attempt started: ${K}`}),!this.isSubscriptionActive)return this.logger.warn({msg:"Subscribe attempt invalid: Subscription is inactive"}),!1;this.logger.debug({msg:"Subscribe attempt is valid."}),this.startConnectingTimestamp<0&&(this.startConnectingTimestamp=performance.now()),this.subscriptionState.connectionState!==Jo.ERRORED&&(this.logger.debug({msg:"Updating state to CONNECTING"}),this.updateState({connectionState:Jo.CONNECTING}));const ae=this.stageConnection.getConnectionStats(),he=this.peerClient.getExpectedJitterBufferMinDelayInMs(),pe=this.peerClient.getSfuResource();this.attemptTracker=this.subscribeTracker.trackAttempt({stageConnectionStats:ae,preAttemptSfuResource:pe});try{this.remotePlaybackController.traceId=this.attemptTracker.getTraceId();const{mediaStream:Ne}=yield this.subscribe(this.attemptTracker.getTraceId()),Je=performance.now()-this.startConnectingTimestamp,Ye=this.peerClient.getSfuResource();this.remotePlaybackController.mediaId=this.peerClient.videoMediaId;const Oe=this.failedRetries;this.attemptToActualizeSubscribeType();const ye=this.peerClient.getActionMeasurements();if(this.attemptTracker.trackSubscribeStarted({sfuResource:Ye,totalDurationWithRetries:Je,retryTimes:Oe,peerClientPerfStats:ye}),Ne){this.cleanupFirstFrameTracking();const lt=this.actualSubscribeType,wt=this.attemptTracker,Kt=(It,Kn)=>{wt.trackSubscribeFirstFrame({peerClientPerfStats:ye,sfuResource:Ye,totalDurationWithRetries:Je,retryTimes:Oe,currentJitterBufferMinDelayInMs:he,mediaType:Kn,firstFrameDuration:It})};this.cleanupFirstFrameTracking=this.measureFirstFrameDuration({mediaStream:Ne,subscribeType:lt,callback:Kt})}return this.throttler.clear(),this.failedRetries=0,this.startConnectingTimestamp=-1,Ne&&this.emit(ge,Ne,this.remotePlaybackController),this.logger.debug({msg:"Subscribe attempt succeeded"}),!0}catch(Ne){const Je=this.attemptTracker.trackSubscribeFailed(Ne);this.logger.error({log:"Subscribe attempt failed",err:Ne}),this.onTrySubscribeFailure(Je,K)}return!1});const re=gc();this.peerClient=new uv(A,this.nonScopedLogger,this.action,Co(this.action,S),re,B,S,O,te),this.logger=new ro(L,me.SUBSCRIPTION),this.subscribeTracker=new ju(this.analyticsTracker,A,S),this.remotePlaybackController=new cx({token:A,analyticsTracker:B,traceId:re,logger:this.nonScopedLogger,remoteParticipantId:this.id})}applyVideoControlsBySubscribeType(S,A){try{S===Oo.AUDIO_ONLY?this.remotePlaybackController.stopVideo().catch(O=>{this.logger.error({err:O,msg:"Remote playback request to stop video failed"})}):S===Oo.AUDIO_VIDEO&&this.remotePlaybackController.startVideo().catch(O=>{this.logger.error({err:O,msg:"Remote playback request to start video failed"})}),this.actualSubscribeType=S,this.logger.debug({msg:`Desired subscribe type actualized from ${A} to ${S}.`})}catch(O){this.logger.error({err:O,msg:`Error updating subscribe type from ${A} to ${S}.`})}}onPeerClientConnectionStateChange(S){const A=this.stageConnection.getParticipant(this.id);this.logger.debug({msg:`onPeerClientConnectionStateChange: ${S}`,state:S,targetParticipant:A}),this.processStateUpdate({peerClientState:S})}onPeerClientTransformError(S){this.emit(so,S)}processStateUpdate(S){const A=this.previousSignalState,O=Object.assign({},A,S);this.isSubscriptionActive?(O.isTargetPublishing?S.peerClientState===at.CONNECTED?this.updateState({connectionState:Jo.CONNECTED,subscribeInProgress:!0}):S.peerClientState===at.FAILED&&this.subscriptionState.subscribeInProgress&&(this.attemptTracker&&this.attemptTracker.trackEndFailed(Aa.CONNECTION_FAIL),this.updateState({subscribeInProgress:!1})):(A.isTargetPublishing&&this.subscriptionState.subscribeInProgress&&(this.logger.debug({msg:"Scheduling an unsubscribe on the event loop"}),this.unsubscribe()),this.throttler.clear(),this.updateState({connectionState:Jo.DISCONNECTED})),(!A.isTargetPublishing&&S.isTargetPublishing||S.peerClientState===at.FAILED)&&this.throttledTrySubscribe("onSignalState change: isTargetPublishing is now true"),Object.assign(this.previousSignalState,S)):this.logger.warn({msg:"Unexpected processStateUpdate when subscription is inactive"})}onTrySubscribeFailure(S,A){this.logger.debug({msg:"Changing/keeping state FAILED"});const O=S.fatal,L=S.code===Bt.OPERATION_ABORTED.code,B=this.failedRetries<=4;if(!L&&!O&&B){const H=1e3*Math.pow(2,this.failedRetries);this.logger.debug({msg:`Retrying in ${H}ms`}),this.failedRetries++,this.nextAttemptTimerId=window.setTimeout(()=>No(this,void 0,void 0,function*(){this.throttledTrySubscribe(A)}),H)}else this.updateState({connectionState:Jo.ERRORED}),this.emit(Ef,S),this.onTerminalFailure()}onTerminalFailure(){this.previousSignalState.isTargetPublishing=!1,this.startConnectingTimestamp=-1,this.failedRetries=0}start(){this.isSubscriptionActive=!0,this.peerClient.on(Zs,this.onPeerClientConnectionStateChange,this),this.peerClient.on(k0,A=>{this.remotePlaybackController.endpoints={playback:A.mediaControls,layers:A.layerControls}}),this.peerClient.on(kp,A=>{this.emit(Sh,A)}),this.peerClient.on(dt,this.onPeerClientTransformError,this),this.stageConnection.on(j0,this.onParticipantUpdated),this.stageConnection.on(Ed,this.onParticipantJoined),this.stageConnection.on(bf,this.onParticipantLeft),this.stageConnection.on(da,this.onParticipantLeft);let S=!0;if(this.stageConnection.isConnected()){const A=this.stageConnection.getParticipant(this.id);S=!!(A!=null&&A.isPublishing)}this.processStateUpdate({isTargetPublishing:S})}throttledTrySubscribe(S){return this.throttler.invoke(this.trySubscribe,S)}updateState(S){S.subscribeInProgress!==void 0&&(this.subscriptionState.subscribeInProgress=S.subscribeInProgress),S.connectionState&&this.subscriptionState.connectionState!==S.connectionState&&(this.subscriptionState.connectionState=S.connectionState,this.emit(Fm,this.subscriptionState.connectionState))}stop(S=!1){this.peerClient.off(Zs,this.onPeerClientConnectionStateChange,this),this.peerClient.off(dt,this.onPeerClientTransformError,this),this.unsubscribe(S),this.throttler.clear(),this.stageConnection.off(j0,this.onParticipantUpdated),this.stageConnection.off(Ed,this.onParticipantJoined),this.stageConnection.off(bf,this.onParticipantLeft),this.stageConnection.off(da,this.onParticipantLeft),this.isSubscriptionActive=!1,this.updateState({connectionState:Jo.DISCONNECTED})}isActive(){return this.isSubscriptionActive}subscribe(S,A){return No(this,void 0,void 0,function*(){const{token:O,id:L}=this;O.assertTokenIsUnexpired(S,Co(fn.SUBSCRIBE,L),"subscribe",L);const{mediaStream:B}=yield this.peerClient.connect({audioOnly:A,traceId:S});return{peerClient:this.peerClient,mediaStream:B}})}unsubscribe(S=!1){return No(this,void 0,void 0,function*(){if(window.clearTimeout(this.nextAttemptTimerId),this.remotePlaybackController.destroy(),!this.isSubscriptionActive||!this.attemptTracker||this.subscriptionState.connectionState===Jo.DISCONNECTED)return;this.cleanupFirstFrameTracking(),this.attemptTracker.trackUnsubscribe();const A=S?Aa.UNLOAD:Aa.UNSUBSCRIBE;try{S?this.peerClient.disconnect(S):yield this.peerClient.disconnect(S),this.updateState({subscribeInProgress:!1}),this.attemptTracker.trackEndSucceeded(A)}catch{this.attemptTracker.trackEndFailed(A)}})}triggerIceRestart(S){var A;return No(this,void 0,void 0,function*(){const O=this.stageConnection.getConnectionStats(),L=this.peerClient.getSfuResource(),B=this.subscribeTracker.trackAttempt({stageConnectionStats:O,isReassignment:!0,traceIdOverride:S.traceId,preAttemptSfuResource:L}),H=performance.now();try{this.emit(Fi),this.logger.debug({msg:`Triggering attempt. Current node: ${this.peerClient.getSfuResource().node}`}),yield this.peerClient.connect({iceRestartOptions:S,traceId:S.traceId}),this.logger.debug({msg:`Successful ICE restart attempt. Current node: ${this.peerClient.getSfuResource().node}`});const te=performance.now()-H,re=this.peerClient.getSfuResource(),K=this.peerClient.getActionMeasurements();(A=this.attemptTracker)===null||A===void 0||A.trackEndSucceeded(Aa.REASSIGNMENT),this.applyVideoControlsBySubscribeType(this.actualSubscribeType,this.actualSubscribeType),B.trackSubscribeStarted({totalDurationWithRetries:te,sfuResource:re,retryTimes:0,peerClientPerfStats:K}),this.emit(Sf)}catch(te){this.emit(Ou),this.logger.error({msg:"ICE restart attempt failed",err:te});const re=this.peerClient.getSfuResource(),K=B.trackSubscribeFailed(te,`iceRestart=true, startNode=${L.node}, endNode=${re==null?void 0:re.node}`);throw K.code===Bt.SUBSCRIBE_TIMED_OUT.code&&this.onTrySubscribeFailure(K,"ice restart timeout"),te}})}measureFirstFrameDuration({mediaStream:S,subscribeType:A,callback:O}){const L=performance.now(),B=re=>{const K=performance.now()-L;O(K,re),re==="audio"?te():H()};let H=$0,te=$0;return A!==Oo.AUDIO_ONLY&&(H=function(re,K){return zm(re,"video",K)}(S,B)),te=function(re,K){return zm(re,"audio",K)}(S,B),()=>{H(),te()}}}var Af,Er;tg=new WeakSet,fy=function(N){return N.id===this.id},function(N){N.JOIN_ERROR="JOIN_ERROR",N.PUBLISH_ERROR="PUBLISH_ERROR",N.SUBSCRIBE_ERROR="SUBSCRIBE_ERROR"}(Af||(Af={})),function(N){N[N.TOKEN_MALFORMED=1]="TOKEN_MALFORMED",N[N.TOKEN_EXPIRED=2]="TOKEN_EXPIRED",N[N.TIMEOUT=3]="TIMEOUT",N[N.FAILED=4]="FAILED",N[N.CANCELED=5]="CANCELED",N[N.STAGE_AT_CAPACITY=6]="STAGE_AT_CAPACITY",N[N.CODEC_MISMATCH=7]="CODEC_MISMATCH",N[N.TOKEN_NOT_ALLOWED=8]="TOKEN_NOT_ALLOWED"}(Er||(Er={}));const nR={[Er.TOKEN_MALFORMED]:"Token is malformed",[Er.TOKEN_EXPIRED]:"Token expired and is no longer valid",[Er.TIMEOUT]:"Operation timed out",[Er.FAILED]:"Operation failed",[Er.CANCELED]:"Operation canceled",[Er.STAGE_AT_CAPACITY]:"Stage at capacity",[Er.CODEC_MISMATCH]:"Client codec is not supported",[Er.TOKEN_NOT_ALLOWED]:"Token not allowed to perform operation"},iR={[Bt.EXPIRED_TOKEN.code]:Er.TOKEN_EXPIRED,[Bt.MALFORMED_TOKEN.code]:Er.TOKEN_MALFORMED,[Bt.TOKEN_PERMISSIONS_DENIED.code]:Er.TOKEN_NOT_ALLOWED,[Bt.OPERATION_ABORTED.code]:Er.CANCELED,[Bt.JOIN_TIMED_OUT.code]:Er.TIMEOUT,[Bt.EVENT_PLANE_WS_CREATE_FAILED.code]:Er.FAILED,[Bt.EVENT_PLANE_PONG_TIMEOUT.code]:Er.FAILED,[Bt.EVENT_PLANE_WS_UNEXPECTED_CLOSE.code]:Er.FAILED,[Bt.PUBLISH_TIMED_OUT.code]:Er.TIMEOUT,[Bt.PUBLISH_FAILURE.code]:Er.FAILED,[Bt.SUBSCRIBE_TIMED_OUT.code]:Er.TIMEOUT,[Bt.SUBSCRIBE_FAILURE.code]:Er.FAILED,[Bt.STAGE_AT_CAPACITY.code]:Er.STAGE_AT_CAPACITY,[Bt.NO_MATCHING_CODEC.code]:Er.CODEC_MISMATCH,[Bt.NETWORK_FAILURE.code]:Er.FAILED,[Bt.INTERNAL_SERVER_ERROR.code]:Er.FAILED,[Bt.REMOTE_STREAM_NOT_FOUND.code]:Er.FAILED,[Bt.INTERNAL_MHCP_ERROR.code]:Er.FAILED,[Bt.UNREACHABLE_MHCP.code]:Er.FAILED,[Bt.INVALID_SESSION_STATUS.code]:Er.FAILED,[Bt.MHCP_ABORTED.code]:Er.FAILED};class rR extends Error{constructor(S,A,O){super(),this.code=S,this.category=A,this.message=O,this.name="StageError",this.errorDetails=[],this.message=`[${A}] ${O}`}addDetails(S){this.errorDetails.push(S)}get details(){return this.errorDetails.length?JSON.stringify(this.errorDetails):""}toString(){return`
${this.message}
details - ${this.details}
        `.trim()}}var ng,ig,hv;(function(N){N.ERROR="error"})(ng||(ng={}));class sR extends Jc{constructor(){super(...arguments),this.handleError=(S,A,O=!0)=>{let L;if(S instanceof Ii){const B=iR[S.code];B&&(L=function(H,te,re){var K,ae;const he=nR[H],pe=new rR(H,te,he);return pe.addDetails({stageErrorMessage:he,stageErrorCode:H,stageErrorCategory:te,stageArn:(K=re.token)===null||K===void 0?void 0:K.stageARN,traceId:(ae=re.traceId)===null||ae===void 0?void 0:ae.value,causeCode:re.code,causeDetails:re.details,causeMessage:re.message,causeLocation:re.location}),pe}(B,A,S))}if(L)return O&&this.emit(ng.ERROR,L),L}}}(function(N){N.INTERNAL="internal",N.API="api"})(ig||(ig={})),function(N){N.ADDITIVE="additive",N.REPLACE="replace"}(hv||(hv={}));class aR{constructor(S){this.logger=new ro(S.logger,me.CONNECTION),this.subscribeConfig={defaults:S.subscribeDefaults,participants:{}}}handleSubscribeConfigUpdate(S,A,O,L=hv.REPLACE){A=(ae=>{const he=Wm(ae);if(he.jitterBuffer!==void 0){const pe=Ne=>{if(typeof Ne=="number"){if(Ne<0)return 0;if(Ne>4e3)return 4e3}return Ne};he.jitterBuffer.minDelayWhenPublishing!==void 0&&(he.jitterBuffer.minDelayWhenPublishing=pe(he.jitterBuffer.minDelayWhenPublishing)),he.jitterBuffer.minDelayWhenSubscribeOnly!==void 0&&(he.jitterBuffer.minDelayWhenSubscribeOnly=pe(he.jitterBuffer.minDelayWhenSubscribeOnly))}return he})(A),this.subscribeConfig.participants[S]===void 0&&(this.subscribeConfig.participants[S]={internalOverrides:{},apiOverrides:{},lastMerged:this.subscribeConfig.defaults});const B=this.subscribeConfig.participants[S];switch(O){case ig.INTERNAL:B.internalOverrides=this.handleSubscribeConfigLevelMerging(B.internalOverrides,A,L);break;case ig.API:B.apiOverrides=this.handleSubscribeConfigLevelMerging(B.apiOverrides,A,L);break;default:(function(ae){throw new Error(`Unknown case kind: ${ae}`)})(O)}const H=ZE(this.subscribeConfig.defaults,B.internalOverrides,B.apiOverrides);if(H===void 0)return this.logger.warn({msg:`Unable to merge subscribe configs for participant: ${S} | ${B}, ${A}`}),!1;const te=(re=B.lastMerged,K=H,(typeof re=="object"&&typeof K=="object"&&(0,fa.isEqual)(re,K))===!1);var re,K;return B.lastMerged=H,this.subscribeConfig.participants[S]=B,te}handleExternalSubscribeConfigUpdate(S,A,O,L=hv.REPLACE){const B=(H=>{const te={};return typeof H!="object"?ti.err(new Error("Invalid input")):(H.jitterBuffer!==void 0&&(te.jitterBuffer={},H.jitterBuffer.minDelay!==void 0&&(te.jitterBuffer.minDelayWhenSubscribeOnly=H.jitterBuffer.minDelay)),H.inBandMessaging!==void 0&&(te.inBandMessaging={enabled:H.inBandMessaging.enabled===!0}),H.simulcast!==void 0&&(te.simulcast={},H.simulcast.initialLayerPreference!==void 0&&(te.simulcast.initialLayerPreference=H.simulcast.initialLayerPreference)),ti.ok(te))})(A);return B.ok===!0&&this.handleSubscribeConfigUpdate(S,B.value,O,L)}handleSubscribeConfigLevelMerging(S,A,O){if(O===hv.REPLACE)return A;{const L=ZE(S,A);return L===void 0?(this.logger.warn({msg:`Unable to merge '${S}' and '${A}' with type ${O}`}),S):L}}getSubscribeConfigSnapshot(S){return this.subscribeConfig.participants[S]===void 0?vi(this.subscribeConfig.defaults):vi(this.subscribeConfig.participants[S].lastMerged)}}class ux extends qn{constructor(S){super(bn.REASSIGNMENT_REQUEST,S.token,S.traceId,!1),Object.assign(this.properties,{target_local_participant_id:S.targetLocalParticipantId,target_remote_participant_id:S.targetRemoteParticipantId}),this.critical=!0}}var Vu,Gu,co,Mh,Rf,Oh,qs,Qo,cS=function(N,S,A,O){return new(A||(A=Promise))(function(L,B){function H(K){try{re(O.next(K))}catch(ae){B(ae)}}function te(K){try{re(O.throw(K))}catch(ae){B(ae)}}function re(K){var ae;K.done?L(K.value):(ae=K.value,ae instanceof A?ae:new A(function(he){he(ae)})).then(H,te)}re((O=O.apply(N,[])).next())})};class fv extends Jc{constructor(S,A){super(),this.setGetStats=O=>{this.getInternalStats=O},this.getStats=()=>cS(this,void 0,void 0,function*(){return this.requestRTCStats()}),this.requestRTCStats=()=>cS(this,void 0,void 0,function*(){if(this.getInternalStats)return this.getInternalStats(this.mediaStreamTrack)}),this.getInternalStats=A,this.id=S.id,this.isMuted=!S.enabled,this.mediaStreamTrack=S,this.streamType=this.mediaStreamTrack.kind==="audio"?Xt.AUDIO:Xt.VIDEO}cleanup(){this.removeAllListeners(),this.getInternalStats=void 0}}(function(N){N.IDLE="IDLE",N.INITIALIZING="INITIALIZING",N.ACTIVE="ACTIVE",N.CONTROLS_PAUSED="CONTROLS_PAUSED",N.DESTROYED="DESTROYED"})(Vu||(Vu={})),function(N){N.LAYERS_CHANGED="LAYERS_CHANGED",N.LAYER_SELECTED="LAYER_SELECTED",N.ADAPTION_CHANGED="ADAPTION_CHANGED"}(Gu||(Gu={})),function(N){N.LAYERS_CHANGED="LAYERS_CHANGED",N.LAYER_SELECTED="LAYER_SELECTED",N.ADAPTION_CHANGED="ADAPTION_CHANGED"}(co||(co={})),function(N){N.UNAVAILABLE="unavailable",N.SELECTED="selected"}(Mh||(Mh={})),function(N){N.LOCAL_STREAM_MUTE_CHANGED="localStreamMutedChanged"}(Rf||(Rf={}));class lS extends fv{constructor(S,A){super(S),this.setMuted=O=>{O!==this.isMuted&&(this.mediaStreamTrack.enabled=!O,this.isMuted=O,this.emit(Rf.LOCAL_STREAM_MUTE_CHANGED,this))},this.mediaConfig=sx(S,A)}}class oR{constructor(S,A){this.strategy=S,this.logger=A}setStrategy(S){this.strategy=S}stageStreamsToPublish(){let S=[];try{S=this.strategy.stageStreamsToPublish(),S=S.filter(L=>L instanceof lS)}catch(L){return this.logger.warn({msg:"error executing stageStreamsToPublish treating this as a no-op",err:L}),console.error("Error executing stageStreamsToPublish",L),ti.err(L)}let A=0,O=0;for(const L of S)L.mediaStreamTrack.kind==="audio"?A++:L.mediaStreamTrack.kind==="video"&&O++;if(A>1||O>1){const L=Error("stageStreamsToPublish strategy function returned more than 1 video or audio stream and as a result will not publish",{cause:"UserStrategy"});return ti.err(L)}return ti.ok(S)}shouldPublishParticipant(S){try{return ti.ok(this.strategy.shouldPublishParticipant(S))}catch(A){return this.logger.warn({msg:"error executing shouldPublishParticipant treating this as a no-op",err:A}),console.error("Error executing shouldPublishParticipant",A),ti.err(A)}}shouldSubscribeToParticipant(S){try{return ti.ok(this.strategy.shouldSubscribeToParticipant(S))}catch(A){return this.logger.warn({msg:"error executing shouldSubscribeToParticipant. Treating it as a no-op",err:A}),console.error("Error executing shouldSubscribeToParticipant",A),ti.err(A)}}subscribeConfiguration(S){var A,O;try{return ti.ok((O=(A=this.strategy).subscribeConfiguration)===null||O===void 0?void 0:O.call(A,S))}catch(L){return this.logger.warn({msg:"error executing subscribeConfiguration. Treating it as a no-op",err:L}),console.error("Error executing subscribeConfiguration",L),ti.err(L)}}preferredLayerForStream(S,A){var O,L;try{return ti.ok((L=(O=this.strategy).preferredLayerForStream)===null||L===void 0?void 0:L.call(O,S,A))}catch(B){return this.logger.warn({msg:"error executing preferredLayerForStream. Treating it as a no-op",err:B}),console.error("Error executing preferredLayerForStream",B),ti.err(B)}}}class hx extends Jc{constructor(S,A){super(),this.audioMuted=!0,this.videoStopped=!0,this.publishState=qs.NOT_PUBLISHED,this.logger=A,this.info=S,this.audioMuted=S.audioMuted,this.videoStopped=S.videoStopped}}(function(N){N.PUBLISH="publish",N.SUBSCRIBE="subscribe"})(Oh||(Oh={})),function(N){N.NOT_PUBLISHED="not_published",N.ATTEMPTING_PUBLISH="attempting_publish",N.PUBLISHED="published",N.ERRORED="errored"}(qs||(qs={})),function(N){N.NOT_SUBSCRIBED="not_subscribed",N.ATTEMPTING_SUBSCRIBE="attempting_subscribe",N.SUBSCRIBED="subscribed",N.ERRORED="errored"}(Qo||(Qo={}));const dy=1e3;function uS(N){return N.map(S=>S.remote)}function cR(N){return{label:N.encodingId,bitrateBps:N.bitrate*dy,width:N.width,height:N.height,framesPerSecond:N.framesPerSecond,selected:N.selected}}function Ra(N,S){const A=N.width*N.height,O=S.width*S.height;return A>O||N.bitrateBps>S.bitrateBps||N.framesPerSecond>S.framesPerSecond?1:A===O||N.bitrateBps===S.bitrateBps||N.framesPerSecond>S.framesPerSecond?0:-1}var rg,py,hS=function(N,S,A,O){return new(A||(A=Promise))(function(L,B){function H(K){try{re(O.next(K))}catch(ae){B(ae)}}function te(K){try{re(O.throw(K))}catch(ae){B(ae)}}function re(K){var ae;K.done?L(K.value):(ae=K.value,ae instanceof A?ae:new A(function(he){he(ae)})).then(H,te)}re((O=O.apply(N,[])).next())})};class fS extends Jc{constructor(S){super(),this.setGetStats=()=>{},this.requestRTCStats=()=>this.internalStream.requestRTCStats(),this.getStats=()=>hS(this,void 0,void 0,function*(){return this.internalStream.requestRTCStats()}),this.setMuted=A=>{this.internalStream.setMuted(A)},this.getLayers=()=>this.internalStream.layers,this.getSelectedLayer=()=>this.internalStream.selectedLayer,this.getLowestQualityLayer=()=>this.internalStream.lowestQualityLayer,this.getHighestQualityLayer=()=>this.internalStream.highestQualityLayer,this.internalStream=S,this.internalStream.on(Gu.ADAPTION_CHANGED,A=>{this.emit(co.ADAPTION_CHANGED,A)}),this.internalStream.on(Gu.LAYERS_CHANGED,A=>{this.emit(co.LAYERS_CHANGED,A)}),this.internalStream.on(Gu.LAYER_SELECTED,(A,O)=>{this.emit(co.LAYER_SELECTED,A,O)})}get id(){return this.internalStream.id}get participantInfo(){return this.internalStream.participantInfo}get streamType(){return this.internalStream.streamType}get mediaStreamTrack(){return this.internalStream.mediaStreamTrack}get isMuted(){return this.internalStream.isMuted}set isMuted(S){this.internalStream.setMuted(S)}get isAdapting(){return this.internalStream.isAdapting}cleanup(){this.removeAllListeners()}}class dS extends fv{constructor({track:S,info:A,getStats:O,remotePlaybackController:L,analyticsTracker:B,token:H}){super(S,O),this.setMuted=re=>{this.isMuted=re},this.setLayer=re=>{const K=(0,fa.cloneDeep)(re);if(this.queueLayerUpdateForValidState(K))return void this.logger.debug({msg:`setLayer:${K} queued, skipping for now`});const ae=function(pe,Ne){if(!pe)return(0,ti.ok)(void 0);const Je=typeof pe=="string"?pe:pe.label,Ye=Ne.filter(Oe=>Oe.label===Je)[0];return Ye?(0,ti.ok)(Ye):(0,ti.err)(`Provided layer with id ${Je} does not exist`)}(K,this._layers);if(!ae.ok){const pe=ae.error;return void this.logger.error({err:pe,msg:"Unable to select layer, skipping skipping selection"})}const he=ae.value;if(this.isNextUpdateAdaptionOnly(he))return this.logger.warn({msg:"setLayer:dynamic"}),void this.handleDynamicUpdate();this.isFirstLayerUpdate()||!this.isRepeatLayerSelection(he)||this.isAdapting?he&&(this.logger.warn({msg:`setLayer:${JSON.stringify(he)} `}),this.handleManualUpdate(he)):this.logger.debug({msg:"Setting the same layer, same adaption state, skipping selection"})},this.state=Vu.INITIALIZING,this.prevState=Vu.IDLE,this.analyticsTracker=B,this.token=H,this.id=S.id,this.info=A,this.mediaStreamTrack=S,this.remotePlaybackController=L,this.layerPollingTimeoutId=null,this.weakRemoteMap=new WeakMap,this.weakRemoteKey={id:"remote"},this.commandMap=new Map,this._isAdapting=!0,this._layers=[],this._selectedLayer=null;const te=R0();this.logger=new ro(new km(te),me.REMOTE_STAGE_STREAM),this.streamType===Xt.AUDIO?this.isMuted=A.audioMuted:this.isMuted=A.videoStopped,this.initializeLayerPolling(),this.pollInternalLayers()}transitionStateTo(S){this.state!==S&&(this.prevState=this.state,this.state=S)}initializeLayerPolling(){this.streamType!==Xt.AUDIO?(this.logger.debug({msg:"Setting up RemoteStageStream, requesting initial layers"}),this.layerPollingTimeoutId=setInterval(()=>{this.pollInternalLayers()},3e3)):this.logger.debug({msg:"Skipping initializing polling for audio streams"})}startLayerPolling(){this.layerPollingTimeoutId===null?this.initializeLayerPolling():this.logger.debug({msg:"Skipping start polling request, already started"})}stopLayerPolling(){this.layerPollingTimeoutId!==null?(clearInterval(this.layerPollingTimeoutId),this.layerPollingTimeoutId=null):this.logger.debug({msg:"Skipping stop polling request, already stopped"})}pollInternalLayers(){this.streamType!==Xt.AUDIO?this.remotePlaybackController.getLayers().then(S=>{if(this.isStateValidForLayerUpdates()){if(!S.ok)throw Error(S.error);this.updateInternalLayersFromRemote(S.value),this.transitionStateTo(Vu.ACTIVE),this.flushCommandQueue()}else this.logger.warn({msg:"Stream controls have been paused, skipping getLayers"})}).catch(S=>{this.logger.error({err:S,msg:"Error calling getLayers, returning current layers"})}):this.logger.debug({msg:"Skipping layer poll request for audio stream"})}updateInternalLayersFromRemote(S){const A=this._layers,O=S.map(cR).sort(Ra),L=!(0,fa.isEqual)(O,A);this._layers=O;const B=this._selectedLayer,H=this._layers.filter(re=>re.selected)[0],te=!(0,fa.isEqual)(H,B);B&&(B.selected=!1),this._selectedLayer=H,te&&(this.trackLayerUpdate(B),this.trackLayerUpdate(H)),this.isCommandQueueEmpty()&&(L&&this.emitLayersChanged(),te&&this.emitLayerSelected(H))}flushCommandQueue(){if(this.isCommandQueueEmpty())return;const S=Array.from(this.commandMap.keys());this.logger.debug({msg:`Flushing active commands from map ${S}`});for(const A of this.commandMap.keys()){const O=this.commandMap.get(A);O==null||O()}this.commandMap.clear()}queueLayerUpdateForValidState(S){if(!S)return this.commandMap.delete("setLayer"),!1;if(this.state===Vu.INITIALIZING){const A=this.setLayer.bind(this,S);return this.commandMap.set("setLayer",A),!0}return!1}handleDynamicUpdate(){if(!this.isStateValidForLayerUpdates())return void this.logger.warn({msg:"Stream controls have been paused, skipping dynamic mode transition"});const S=this._isAdapting;this._isAdapting=!0,this.emitAdaptionChanged(),this.remotePlaybackController.unsetLayer().then(A=>{if(!this.isStateValidForLayerUpdates())return this.logger.warn({msg:"Stream controls have been paused, skipping dynamic mode transition"}),void this.resetAdaptionStateOnError(S,`Stream in invalid state: ${this.state}`);A.ok?this.logger.debug({msg:"Layer successfully unset, restarting dynamic adaption"}):this.resetAdaptionStateOnError(S,A.error)}).catch(()=>{})}resetAdaptionStateOnError(S,A){this._isAdapting=S,this.emitAdaptionChanged(),this.logger.error({err:A,msg:"Error unsetting layer, reverting adaption state"})}handleManualUpdate(S){if(!this.isStateValidForLayerUpdates())return void this.logger.warn({msg:"Stream controls have been paused, skipping manual updates"});const A=this._isAdapting,O=this._selectedLayer;O&&(O.selected=!1),this._isAdapting=!1,this._selectedLayer=S,S.selected=!0,A!==this._isAdapting&&this.emitAdaptionChanged(),this.updateLocalLayerStateBeforeRemote(S,O),this.trackLayerUpdate(O),this.trackLayerUpdate(S),this.emitLayersChanged(),this.emitLayerSelected(S),this.remotePlaybackController.setLayer(S.label).then(L=>{if(!this.isStateValidForLayerUpdates()){this.logger.warn({msg:"Stream controls have been paused, skipping dynamic mode transition"});const B=`Stream in invalid state: ${this.state}`;return this.resetAdaptionStateOnError(A,B),void this.resetLayerOnError(O,S,B)}if(!L.ok){const B=L.error;return this.resetAdaptionStateOnError(A,B),void this.resetLayerOnError(O,S,B)}this.logger.debug({msg:`Layer successfully selected: ${S.label}`})}).catch(()=>{})}applyExistingControlState(){var S;this._isAdapting?this.remotePlaybackController.unsetLayer().then(()=>{}).catch(()=>{}):!((S=this._selectedLayer)===null||S===void 0)&&S.label&&this.remotePlaybackController.setLayer(this._selectedLayer.label).then(()=>{}).catch(()=>{})}resetLayerOnError(S,A,O){A&&(A.selected=!1),S&&(S.selected=!0),this._selectedLayer=S,this.logger.error({err:O,msg:"Error unsetting layer, leaving current selection in place"}),this.updateLocalLayerStateBeforeRemote(S,A),this.emitLayersChanged(),S!==null&&this.emitLayerSelected(S,Mh.UNAVAILABLE),this.trackLayerUpdate(A),this.trackLayerUpdate(S)}updateLocalLayerStateBeforeRemote(S,A){this._layers=this._layers.map(O=>O.label===(S==null?void 0:S.label)?S:O.label===(A==null?void 0:A.label)?A:O).sort(Ra)}trackLayerUpdate(S){var A,O;this.analyticsTracker.trackEventNoSharedProps(new ev(this.token,gc(),(A=S==null?void 0:S.label)!==null&&A!==void 0?A:"auto",!0,fn.SUBSCRIBE,(O=S==null?void 0:S.selected)!==null&&O!==void 0&&O,this.info.id))}isNextUpdateAdaptionOnly(S){return S===void 0&&this.isFirstLayerUpdate()||S===void 0&&!this.isAdapting}isFirstLayerUpdate(){return this._selectedLayer===null}isRepeatLayerSelection(S){var A;return((A=this._selectedLayer)===null||A===void 0?void 0:A.label)===(S==null?void 0:S.label)}isStateValidForLayerUpdates(){return this.state===Vu.ACTIVE||this.state===Vu.INITIALIZING}isCommandQueueEmpty(){return this.commandMap.size===0}emitLayerSelected(S,A=Mh.SELECTED){this.logger.debug({msg:`Emitting layers selected ${JSON.stringify(S,null,2)}`}),this.emit(Gu.LAYER_SELECTED,(0,fa.cloneDeep)(S),A)}emitLayersChanged(){this.emit(Gu.LAYERS_CHANGED,(0,fa.cloneDeep)(this._layers))}emitAdaptionChanged(){this.emit(Gu.ADAPTION_CHANGED,this._isAdapting)}get remote(){const S=this.weakRemoteMap.get(this.weakRemoteKey);if(S)return S;const A=new fS(this);return this.weakRemoteMap.set(this.weakRemoteKey,A),A}get participantInfo(){return(0,fa.cloneDeep)(this.info)}get isAdapting(){return this._isAdapting}get layers(){return(0,fa.cloneDeep)(this._layers)}get selectedLayer(){var S;return(0,fa.cloneDeep)((S=this._selectedLayer)!==null&&S!==void 0?S:void 0)}get highestQualityLayer(){return(0,fa.cloneDeep)(this.layers[this.layers.length-1])}get lowestQualityLayer(){return(0,fa.cloneDeep)(this.layers[0])}pauseControls(){this.transitionStateTo(Vu.CONTROLS_PAUSED),this.stopLayerPolling()}resumeControls(){this.applyExistingControlState(),this.startLayerPolling(),this.transitionStateTo(Vu.ACTIVE)}cleanup(){this.transitionStateTo(Vu.DESTROYED),super.cleanup(),this.stopLayerPolling(),this._layers=[],this._selectedLayer=null,this._isAdapting=!0,this.commandMap.clear()}}(function(N){N.STATE_CHANGE="stateChange",N.MEDIA_STREAM_ADDED="mediaStreamAdded",N.MEDIA_STREAM_REMOVED="mediaStreamRemoved",N.MEDIA_STREAM_MUTE_CHANGED="mediaStreamMuteChanged",N.ERROR="error"})(rg||(rg={})),function(N){N.SUBSCRIPTION_STATE_CHANGE="subscriptionStateChange",N.MEDIA_STREAM_SEI_MESSAGE_RECEIVED="mediaStreamSeiMessageReceived"}(py||(py={}));const lo=Object.assign(Object.assign({},rg),py);var Ad;(function(N){N.PUBLICATION_STATE_CHANGE="publicationStateChange"})(Ad||(Ad={}));const ec=Object.assign(Object.assign({},rg),Ad);var tc=function(N,S,A,O){return new(A||(A=Promise))(function(L,B){function H(K){try{re(O.next(K))}catch(ae){B(ae)}}function te(K){try{re(O.throw(K))}catch(ae){B(ae)}}function re(K){var ae;K.done?L(K.value):(ae=K.value,ae instanceof A?ae:new A(function(he){he(ae)})).then(H,te)}re((O=O.apply(N,[])).next())})};class lR extends hx{constructor(S,A,O,L,B,H,te,re=!1){super(S,new ro(L,me.REMOTE_PARTICIPANT)),this.subscribeState=Qo.NOT_SUBSCRIBED,this.reassigning=!1,this.streams=[],this.left=!1,this.onSubscriptionStateChange=K=>{this.logger.debug({msg:"subscriptionStateChange",state:K}),K===Jo.DISCONNECTED?this.updateSubscriptionState(Qo.NOT_SUBSCRIBED):K===Jo.CONNECTED?this.updateSubscriptionState(Qo.SUBSCRIBED):K===Jo.CONNECTING?this.updateSubscriptionState(Qo.ATTEMPTING_SUBSCRIBE):K===Jo.ERRORED?this.updateSubscriptionState(Qo.ERRORED):this.logger.warn({msg:"FIXME onSubscriptionStateChange UNHANDLED STATE",state:K})},this.onSubscriptionMediaStream=(K,ae)=>{this.logger.debug({msg:"onSubscriptionMediaStream",stream:K});let he=K.getTracks().map(pe=>{const Ne=new dS({track:pe,info:this.info,getStats:this.subscription.requestRTCStats,remotePlaybackController:ae,analyticsTracker:this.analyticsTracker,token:this.token});return this.streams.push(Ne),Ne});this.subscription.getDesiredSubscribeType()===Oo.AUDIO_ONLY&&(he=he.filter(pe=>pe.streamType!==Xt.VIDEO)),this.emit(lo.MEDIA_STREAM_ADDED,he)},this.onSubscriptionError=K=>{this.emit(lo.ERROR,K)},this.onSubscriptionSeiMessageReceived=K=>{this.emit(lo.MEDIA_STREAM_SEI_MESSAGE_RECEIVED,K)},this.onSubscriptionTransformError=K=>{this.emit(lo.ERROR,K)},this.onSubscriptionReassignmentStart=()=>{for(const K of this.streams)K.pauseControls()},this.onSubscriptionReassignmentDone=()=>{for(const K of this.streams)K.resumeControls()},this.updateSubscribeStateIfNecessary=(K,ae)=>{if(!this.info.capabilities.has(Oh.SUBSCRIBE))return;ae!==void 0&&this.subscription.updateSubscribeConfig(ae);const he=K!==Oo.NONE&&this.publishState===qs.PUBLISHED,pe=this.subscribeState!==Qo.NOT_SUBSCRIBED&&this.subscribeState!==Qo.ERRORED;if(he&&!pe)this.subscription.updateDesiredSubscribeType(K),this.subscribe();else if(!he&&pe)this.unsubscribe(),this.subscription.updateDesiredSubscribeType(K);else if(this.subscribeState===Qo.SUBSCRIBED&&this.subscription.getDesiredSubscribeType()!==K)try{K===Oo.AUDIO_ONLY?this.emit(lo.MEDIA_STREAM_REMOVED,this.streams.filter(Ne=>Ne.streamType===Xt.VIDEO)):K===Oo.AUDIO_VIDEO&&this.emit(lo.MEDIA_STREAM_ADDED,this.streams.filter(Ne=>Ne.streamType===Xt.VIDEO)),this.subscription.updateDesiredSubscribeType(K)}catch(Ne){this.logger.error({err:Ne,msg:"error updating subscribe type"})}},this.updatePublishState=K=>{const ae=K&&this.publishState===qs.PUBLISHED,he=!K&&this.publishState===qs.NOT_PUBLISHED;return!ae&&!he&&(this.info.isPublishing=K,this.publishState=K?qs.PUBLISHED:qs.NOT_PUBLISHED,!0)},this.updateStreamState=(K,ae)=>{this.audioMuted!==K&&(this.audioMuted=K,this.info.audioMuted=K,this.updateStreamMuteState(Xt.AUDIO,K)),this.videoStopped!==ae&&(this.videoStopped=ae,this.info.videoStopped=ae,this.updateStreamMuteState(Xt.VIDEO,ae))},this.updateStreamMuteState=(K,ae)=>{const he=this.streams.find(pe=>pe.streamType===K);he?(he.setMuted(ae),this.emit(lo.MEDIA_STREAM_MUTE_CHANGED,he)):this.logger.warn({msg:`tried to update mute state for ${K} stream on participant ${this.info.id} that didn't exist`})},this.cleanup=()=>{for(const K of this.streams)K.remote.removeAllListeners(),K.removeAllListeners();this.removeAllListeners()},this.quickUnsubscribe=()=>this.subscribeState!==Qo.NOT_SUBSCRIBED&&this.subscription.stop(!0),this.getDesiredSubscribeType=()=>this.subscription.getDesiredSubscribeType(),this.isReassigning=()=>this.reassigning,this.analyticsTracker=te,this.token=A,this.createSubscription=()=>{const K=new lx(S.id,A,O,L,te,B,H);return K.on(Fm,this.onSubscriptionStateChange),K.on(ge,this.onSubscriptionMediaStream),K.on(Ef,this.onSubscriptionError),K.on(Sh,this.onSubscriptionSeiMessageReceived),K.on(so,this.onSubscriptionTransformError),K.on(Fi,this.onSubscriptionReassignmentStart),K.on(Sf,this.onSubscriptionReassignmentDone),K.on(Ou,this.onSubscriptionReassignmentDone),K},this.subscription=this.createSubscription(),re&&(this.publishState=qs.PUBLISHED)}updateSubscriptionState(S){S!==this.subscribeState&&(this.subscribeState=S,this.emit(lo.SUBSCRIPTION_STATE_CHANGE,this.subscribeState))}participantLeave(){this.left=!0}subscribe(){this.left?this.logger.warn({msg:"tried to subscribe to a participant that left"}):(this.updateSubscriptionState(Qo.ATTEMPTING_SUBSCRIBE),this.logger.debug({msg:"subscribe"}),this.subscription.start())}unsubscribe(){if(this.subscribeState===Qo.NOT_SUBSCRIBED)return;this.logger.debug({msg:"unsubscribe"}),this.subscription.stop(),this.subscription.off(Fm,this.onSubscriptionStateChange),this.subscription.off(ge,this.onSubscriptionMediaStream),this.subscription.off(Ef,this.onSubscriptionError),this.subscription.off(so,this.onSubscriptionTransformError);const S=this.getDesiredSubscribeType();this.subscription=this.createSubscription(),S===Oo.AUDIO_ONLY?this.emit(lo.MEDIA_STREAM_REMOVED,this.streams.filter(A=>A.streamType===Xt.AUDIO)):this.emit(lo.MEDIA_STREAM_REMOVED,this.streams),this.updateSubscriptionState(Qo.NOT_SUBSCRIBED),this.streams.forEach(A=>{A.cleanup()}),this.streams=[]}triggerIceRestart(S){return tc(this,void 0,void 0,function*(){this.reassigning=!0;try{yield this.subscription.triggerIceRestart(S)}finally{this.reassigning=!1}})}}const my=fn.PUBLISH;class dv{constructor(S,A){this.analyticsTracker=S,this.token=A,this.action=my,this.traceId=gc()}trackPublish(S){const{action:A,traceId:O,analyticsTracker:L,token:B}=this;return L.trackEvent(new Bu({token:B,traceId:O})),{getTraceId:()=>O,trackPublishStarted({totalDurationWithRetries:H,retryTimes:te,sfuResource:re,peerClientPerfStats:K}){const{optionsDuration:ae,postDuration:he,timeToCandidate:pe,timeToConnected:Ne,sdpExchangeDuration:Je,sdpExchangeTransport:Ye,setRemoteDescDuration:Oe,peerConnectionDuration:ye}=K,{edpInitialConnectDuration:lt,edpInitialConnectRetries:wt,edpInitialStateDuration:Kt,edpStateUpdateCount:It}=S;L.trackEvent(new nx({token:B,traceId:O,optionsDuration:ae,postDuration:he,timeToCandidate:pe,totalDuration:Ne,edpInitialConnectDuration:lt,edpInitialConnectRetries:wt,edpInitialStateDuration:Kt,edpStateUpdateCount:It,sdpExchangeDuration:Je,sdpExchangeTransport:Ye,setRemoteDescDuration:Oe,peerConnectionDuration:ye,publishRetries:te,totalDurationWithRetries:H,sfuResource:re}))},trackPublishFailed(H){const te=((K,ae,he)=>{if(K instanceof Ii)return K;let pe="";return K instanceof ws.AxiosError&&(pe+=`AxiosError - ${K.code}`),new Ii(Object.assign(Object.assign(Object.assign({},Bt.PUBLISH_FAILURE),{action:my,token:ae,traceId:he,tag:vc.PUBLISH_RELATED,location:"publish",details:`${pe} ${K.message}`}),{fatal:!0}))})(H,B,O);L.trackEvent(new ix({token:B,traceId:O,code:te.code,message:te.message,fatal:te.fatal,nominal:te.nominal}));const re=new Ii(Object.assign(Object.assign({},Bt.PUBLISH_FAILURE),{action:A,token:B,traceId:O,tag:vc.PUBLISH_RELATED,location:"publish"}));return H instanceof Ii&&(re.fatal=H.fatal,re.nominal=H.nominal,re.location=`publish > ${H.location}`),L.trackError(re),te},trackUnpublish:()=>{L.trackEvent(new Cd({token:B,traceId:O}))},trackEndSucceeded:H=>{L.trackEvent(new Vp({token:B,isUnpublishSuccessful:!0,traceId:O,reason:H}))},trackEndFailed:H=>{const te=new Ii(Object.assign(Object.assign({},Bt.UNPUBLISH_FAILURE),{token:B,traceId:O,tag:vc.UNPUBLISH_RELATED,location:"unpublish"}));return H!==Aa.UNLOAD&&H!==Aa.UNPUBLISH||this.analyticsTracker.trackError(te),L.trackEvent(new Vp({token:B,isUnpublishSuccessful:!1,traceId:O,reason:H})),te}}}}var qa,ks,Nh=function(N,S,A,O){return new(A||(A=Promise))(function(L,B){function H(K){try{re(O.next(K))}catch(ae){B(ae)}}function te(K){try{re(O.throw(K))}catch(ae){B(ae)}}function re(K){var ae;K.done?L(K.value):(ae=K.value,ae instanceof A?ae:new A(function(he){he(ae)})).then(H,te)}re((O=O.apply(N,[])).next())})};(function(N){N.DISCONNECTED="disconnected",N.CONNECTING="connecting",N.CONNECTED="connected",N.ERRORED="errored"})(qa||(qa={})),function(N){N.STATE_CHANGE="stateChange",N.ERROR="error",N.TRANSFORM_ERROR="transformError"}(ks||(ks={}));class uR extends Jc{constructor(S,A,O,L){super(),this.token=S,this.stageConnection=A,this.nonScopedLogger=O,this.analyticsTracker=L,this.tracksToPublish=[],this.publicationState=qa.DISCONNECTED,this.latestPubAttemptNum=0,this.startConnectingTimestamp=-1,this.action=fn.PUBLISH,this.start=B=>{this.publicationState===qa.DISCONNECTED||this.publicationState===qa.ERRORED?(this.tracksToPublish=B,this.latestPubAttemptNum=0,this.processStateUpdate()):this.logger.warn({msg:"publication cannot be started if not in disconnected or error state"})},this.requestRTCStats=B=>Nh(this,void 0,void 0,function*(){return this.peerClient.requestRTCStats(B)}),this.stop=(B=!1)=>Nh(this,void 0,void 0,function*(){this.peerClient.off(Zs,this.onPeerClientConnectionStateChange,this),this.peerClient.off(dt,this.onPeerClientTransformError,this),yield this.unpublish(B),this.updateState(qa.DISCONNECTED)}),this.processStateUpdate=B=>{const{publicationState:H}=this;H===qa.DISCONNECTED||H===qa.ERRORED?this.latestPubAttemptNum===0&&(this.startConnectingTimestamp=performance.now(),this.updateState(qa.CONNECTING),this.tryPublish()):H===qa.CONNECTING?B===at.CONNECTED&&this.updateState(qa.CONNECTED):H===qa.CONNECTED&&B===at.FAILED&&(this.attemptTracker&&this.attemptTracker.trackEndFailed(Aa.CONNECTION_FAIL),this.latestPubAttemptNum===0&&(this.startConnectingTimestamp=performance.now(),this.updateState(qa.CONNECTING),this.tryPublish()))},this.updateState=B=>{this.publicationState=B,this.emit(ks.STATE_CHANGE,B)},this.tryPublish=()=>Nh(this,void 0,void 0,function*(){if(this.latestPubAttemptNum++,this.latestPubAttemptNum<=4){const B=this.stageConnection.getConnectionStats();this.attemptTracker=this.publishTracker.trackPublish(B);try{this.logger.debug({msg:`attempting to publish, attemptNum: ${this.latestPubAttemptNum}`}),yield this.publish(this.tracksToPublish,this.attemptTracker.getTraceId()),this.logger.debug({msg:"publish succeeded!"});const H=this.peerClient.getSfuResource(),te=this.latestPubAttemptNum-1,re=performance.now()-this.startConnectingTimestamp,K=this.peerClient.getActionMeasurements();this.attemptTracker.trackPublishStarted({sfuResource:H,totalDurationWithRetries:re,retryTimes:te,peerClientPerfStats:K}),this.latestPubAttemptNum=0}catch(H){this.logger.error({msg:"publish failed!",err:H});const te=this.attemptTracker.trackPublishFailed(H),re=te.code===Bt.OPERATION_ABORTED.code,K=te.fatal,ae=this.latestPubAttemptNum===4;if(re)return;if(K||ae)return this.logger.error({msg:`Stopping attempts: isFatal=${K}, isLastAttempt=${ae}`,err:H}),this.updateState(qa.ERRORED),void this.emit(ks.ERROR,te);const he=1e3*Math.pow(2,this.latestPubAttemptNum);this.logger.debug({msg:`attempt failed, retrying in ${he}ms`}),this.nextAttemptTimerId=window.setTimeout(()=>{this.tryPublish()},he)}}}),this.publish=(B,H)=>Nh(this,void 0,void 0,function*(){this.peerClient.initTracksToPublish(B),yield this.peerClient.connect({audioOnly:!1,traceId:H})}),this.unpublish=(B=!1)=>Nh(this,void 0,void 0,function*(){if(window.clearTimeout(this.nextAttemptTimerId),this.publicationState===qa.DISCONNECTED||this.publicationState===qa.ERRORED||!this.attemptTracker)return;this.attemptTracker.trackUnpublish();const H=B?Aa.UNLOAD:Aa.UNPUBLISH;try{B?this.peerClient.disconnect(B):yield this.peerClient.disconnect(B),this.attemptTracker.trackEndSucceeded(H)}catch{this.attemptTracker.trackEndFailed(H)}}),this.replaceOrUpdateTrack=B=>Nh(this,void 0,void 0,function*(){this.tracksToPublish.find(H=>H.track.kind===B.track.kind)?this.tracksToPublish=this.tracksToPublish.map(H=>H.track.kind===B.track.kind?B:H):this.tracksToPublish.push(B),yield this.peerClient.replaceOrUpdateTrack(B)}),this.onPeerClientConnectionStateChange=B=>{this.logger.debug({msg:`onPeerClientConnectionStateChange: ${B}`,state:B}),this.processStateUpdate(B)},this.onPeerClientTransformError=B=>{this.emit(ks.TRANSFORM_ERROR,B)},this.onIncompatibleCodecs=B=>Nh(this,void 0,void 0,function*(){yield this.peerClient.onIncompatibleCodecs(B)}),this.sendSeiMessage=B=>{this.peerClient.sendSeiMessage(B)},this.peerClient=new uv(S,this.nonScopedLogger,this.action,Co(this.action),gc(),this.analyticsTracker,void 0,A,void 0),this.logger=new ro(O,me.PUBLICATION),this.peerClient.on(Zs,this.onPeerClientConnectionStateChange,this),this.peerClient.on(dt,this.onPeerClientTransformError,this),this.publishTracker=new dv(this.analyticsTracker,this.token)}removeTrack(S){return Nh(this,void 0,void 0,function*(){this.tracksToPublish=this.tracksToPublish.filter(A=>A.track.kind!==S),yield this.peerClient.removeTrack(S)})}}var Vr,Zn=function(N,S,A,O){return new(A||(A=Promise))(function(L,B){function H(K){try{re(O.next(K))}catch(ae){B(ae)}}function te(K){try{re(O.throw(K))}catch(ae){B(ae)}}function re(K){var ae;K.done?L(K.value):(ae=K.value,ae instanceof A?ae:new A(function(he){he(ae)})).then(H,te)}re((O=O.apply(N,[])).next())})};class fx extends hx{constructor(S,A,O,L,B){super(S,new ro(O,me.LOCAL_PARTICIPANT)),this.onPublicationStateChange=H=>{switch(this.logger.debug({msg:"publicationStateChange",state:H}),H){case"connected":this.connection.setStagePublishing(!0),this.updatePublishState(qs.PUBLISHED);break;case"connecting":this.updatePublishState(qs.ATTEMPTING_PUBLISH);break;case"errored":this.updatePublishState(qs.ERRORED),this.connection.setStagePublishing(!1);break;default:return void this.logger.warn({msg:"FIXME onPublicationStateChange UNHANDLED STATE",state:H})}},this.onPublicationError=H=>{this.emit(ec.ERROR,H)},this.updatePublishState=H=>{this.info.isPublishing=H===qs.PUBLISHED,this.publishState=H,this.emit(ec.PUBLICATION_STATE_CHANGE,this.publishState)},this.handleMute=H=>{H.streamType===Xt.AUDIO&&(this.audioMuted=H.isMuted,this.info.audioMuted=H.isMuted),H.streamType===Xt.VIDEO&&(this.videoStopped=H.isMuted,this.info.videoStopped=H.isMuted),this.connection.emitStageState(this.audioMuted,this.videoStopped),this.emit(ec.MEDIA_STREAM_MUTE_CHANGED,H)},this.publish=H=>{this.logger.debug({msg:"publish"}),H.forEach(re=>{re&&(this.setupStreamListener(re),re.streamType===Xt.AUDIO?(this.audioStream=re,this.audioMuted=!re.mediaStreamTrack.enabled,this.info.audioMuted=this.audioMuted):re.streamType===Xt.VIDEO&&(this.videoStream=re,this.videoStopped=!re.mediaStreamTrack.enabled,this.info.videoStopped=this.videoStopped),re.setGetStats(this.publication.requestRTCStats))}),this.connection.emitStageState(this.audioMuted,this.videoStopped);const te=H.map(re=>nS(re.mediaStreamTrack,re.mediaConfig));this.publication.start(te)},this.cleanup=()=>this.removeAllListeners(),this.quickUnpublish=()=>this.publishState!==qs.NOT_PUBLISHED&&this.publishState!==qs.ERRORED&&void this.publication.stop(!0),this.onIncompatibleCodecs=H=>Zn(this,void 0,void 0,function*(){yield this.publication.onIncompatibleCodecs(H)}),this.sendSeiMessage=H=>{this.publication.sendSeiMessage(H)},this.sendSeiMessageString=H=>{const te=new TextEncoder().encode(H);this.publication.sendSeiMessage(te)},this.connection=L,this.createPublication=()=>{const H=new uR(A,L,O,B);return H.on(ks.STATE_CHANGE,this.onPublicationStateChange),H.on(ks.ERROR,this.onPublicationError),H.on(ks.TRANSFORM_ERROR,this.onPublicationError),H},this.publication=this.createPublication()}setupStreamListener(S){S.on(Rf.LOCAL_STREAM_MUTE_CHANGED,this.handleMute)}removeTrack(S){var A,O;S.streamType===Xt.AUDIO?((A=this.audioStream)===null||A===void 0||A.off(Rf.LOCAL_STREAM_MUTE_CHANGED,this.handleMute),this.audioStream=void 0,this.audioMuted=!0,this.info.audioMuted=!0):S.streamType===Xt.VIDEO&&((O=this.videoStream)===null||O===void 0||O.off(Rf.LOCAL_STREAM_MUTE_CHANGED,this.handleMute),this.videoStream=void 0,this.videoStopped=!0,this.info.videoStopped=!0),this.connection.emitStageState(this.audioMuted,this.videoStopped),this.publication.removeTrack(S.streamType)}replaceOrAddTrack(S){return Zn(this,void 0,void 0,function*(){this.setupStreamListener(S),S.setGetStats(this.publication.requestRTCStats),S.streamType===Xt.AUDIO?(this.audioStream=S,this.audioMuted=!S.mediaStreamTrack.enabled):S.streamType===Xt.VIDEO&&(this.videoStream=S,this.videoStopped=!S.mediaStreamTrack.enabled),this.connection.emitStageState(this.audioMuted,this.videoStopped);const A=nS(S.mediaStreamTrack,S.mediaConfig);yield this.publication.replaceOrUpdateTrack(A)})}unpublish(){if(this.publishState===qs.NOT_PUBLISHED||this.publishState===qs.ERRORED)return;this.logger.debug({msg:"unpublish"}),this.connection.setStagePublishing(!1),this.publication.stop(),this.publication.off(ks.STATE_CHANGE,this.onPublicationStateChange),this.publication.off(ks.ERROR,this.onPublicationError),this.publication.off(ks.TRANSFORM_ERROR,this.onPublicationError);const S=[this.audioStream,this.videoStream].filter(A=>!!A);S.forEach(A=>{A.cleanup()}),this.audioStream=void 0,this.videoStream=void 0,this.emit(ec.MEDIA_STREAM_REMOVED,S),this.updatePublishState(qs.NOT_PUBLISHED),this.publication=this.createPublication()}}(function(N){N.STAGE_CONNECTION_STATE_CHANGED="stageConnectionStateChanged",N.STAGE_PARTICIPANT_JOINED="stageParticipantJoined",N.STAGE_PARTICIPANT_LEFT="stageParticipantLeft",N.STAGE_PARTICIPANT_STREAMS_ADDED="stageParticipantStreamsAdded",N.STAGE_PARTICIPANT_STREAMS_REMOVED="stageParticipantStreamsRemoved",N.STAGE_STREAM_MUTE_CHANGED="stageStreamMuteChanged",N.STAGE_STREAM_SEI_MESSAGE_RECEIVED="stageStreamSeiMessageReceived",N.STAGE_STREAM_LAYERS_CHANGED="stageStreamLayersChanged",N.STAGE_STREAM_LAYER_SELECTED="stageStreamLayerSelected",N.STAGE_STREAM_ADAPTION_CHANGED="stageStreamAdaptionChanged",N.STAGE_PARTICIPANT_SUBSCRIBE_STATE_CHANGED="stageParticipantSubscribeStateChanged",N.STAGE_PARTICIPANT_PUBLISH_STATE_CHANGED="stageParticipantPublishStateChanged",N.ERROR="error",N.STAGE_LEFT="stageLeft"})(Vr||(Vr={}));var uo=function(N,S,A,O){return new(A||(A=Promise))(function(L,B){function H(K){try{re(O.next(K))}catch(ae){B(ae)}}function te(K){try{re(O.throw(K))}catch(ae){B(ae)}}function re(K){var ae;K.done?L(K.value):(ae=K.value,ae instanceof A?ae:new A(function(he){he(ae)})).then(H,te)}re((O=O.apply(N,[])).next())})};const Ds=N=>!!N;class Rd extends Jc{constructor(S,A){super(),this.connectionState=fs.DISCONNECTED,this.participants=new Map,this.connectionStateErrored=!1,this.onConnectionStateChanged=(L,B)=>{var H,te;if(this.connectionState=L,L===fs.ERRORED&&(this.connectionStateErrored=!0),L===fs.CONNECTED&&this.localParticipant&&this.localParticipant.publishState!==qs.NOT_PUBLISHED&&this.stageConnection.emitStageState((H=this.localParticipant)===null||H===void 0?void 0:H.audioMuted,(te=this.localParticipant)===null||te===void 0?void 0:te.videoStopped),L===fs.CONNECTED&&this.connectionStateErrored&&(this.connectionStateErrored=!1,this.refreshStrategy()),L===fs.DISCONNECTED){if(B&&B!==zu.CLIENT_RECONNECT&&B!==zu.USER_INITIATED){let re=sg.UNKNOWN;(function(K){return Object.values(sg).includes(K)})(B)?re=B:this.logger.warn({msg:`DISCONNECTED reason is not a StageLeftReason: ${B}`}),this.cleanup(re)}}else this.emit(Vr.STAGE_CONNECTION_STATE_CHANGED,this.connectionState)},this.setupLocalParticipantOnce=()=>{var L;this.localParticipant?this.analyticsTracker.trackEventNoSharedProps(new Hm(this.token,(L=this.joinTraceId)!==null&&L!==void 0?L:new HE,"reusing local participant from repeat join",fn.JOIN,"")):this.createLocalParticipant()},this.createLocalParticipant=()=>{const L=function(B){var H,te;const re=new Set;return B.token.claims.capabilities.allow_publish&&re.add(Oh.PUBLISH),B.token.claims.capabilities.allow_subscribe&&re.add(Oh.SUBSCRIBE),{id:B.token.participantID,userId:(H=B.token.userID)!==null&&H!==void 0?H:"",attributes:(te=B.token.claims.attributes)!==null&&te!==void 0?te:{},capabilities:re,isLocal:!0,userInfo:{},videoStopped:B.videoStopped,audioMuted:B.audioMuted,isPublishing:B.isPublishing}}({token:this.token,videoStopped:!0,audioMuted:!0,isPublishing:!1});this.localParticipant=new fx(L,this.token,this.logger.unwrap(),this.stageConnection,this.analyticsTracker),this.localParticipant.on(ec.PUBLICATION_STATE_CHANGE,B=>{this.onPublishStateChanged(this.localParticipant.info,B)}),this.localParticipant.on(ec.MEDIA_STREAM_REMOVED,this.onLocalStreamsRemoved),this.localParticipant.on(ec.MEDIA_STREAM_MUTE_CHANGED,B=>{this.localParticipant?this.onStreamMuteChange(this.localParticipant.info,B):this.logger.warn({msg:"tried to emit a stream mute change event for undefined local participant"})}),this.localParticipant.on(ec.ERROR,B=>{this.errorManager.handleError(B,Af.PUBLISH_ERROR)}),this.emit(Vr.STAGE_PARTICIPANT_JOINED,L)},this.onRemoteParticipantJoined=L=>{var B;if(L.id!==((B=this.localParticipant)===null||B===void 0?void 0:B.info.id)){const H=function(ae){return{id:ae.id,userId:ae.userId,attributes:ae.attributes,capabilities:new Set([Oh.SUBSCRIBE]),isLocal:!1,userInfo:{},videoStopped:ae.videoStopped,audioMuted:ae.audioMuted,isPublishing:ae.isPublishing}}(L);if(this.participants.has(H.id))return void this.logger.warn({msg:"Remote participant already tracked"});let te=Oo.NONE;H.capabilities.has(Oh.SUBSCRIBE)&&(te=ti.getOk_or(this.strategyWrapper.shouldSubscribeToParticipant(H),te),this.updateManagerWithExternalSubscribeConfig(H,"joined"));const re=this.configManager.getSubscribeConfigSnapshot(H.id),K=new lR(H,this.token,this.stageConnection,this.logger.unwrap(),te,re,this.analyticsTracker,L.isPublishing);this.participants.set(H.id,K),this.setupRemoteParticipantListeners(K),this.emit(Vr.STAGE_PARTICIPANT_JOINED,K.info),K.updateSubscribeStateIfNecessary(te)}},this.setupRemoteParticipantListeners=L=>{L.on(lo.SUBSCRIPTION_STATE_CHANGE,B=>{this.onParticipantSubscribeStateChanged(L.info.id,B)}),L.on(lo.MEDIA_STREAM_ADDED,B=>{const H=this.participants.get(L.info.id);if(H){for(const te of B)this.setupRemoteParticipantStreamEvents(H.info,te);this.emit(Vr.STAGE_PARTICIPANT_STREAMS_ADDED,H.info,uS(B)),this.updateStreamLayerForParticipant(L)}else this.logger.warn({msg:"Got stream add for participant no longer being tracked"})}),L.on(lo.MEDIA_STREAM_REMOVED,B=>{const H=this.participants.get(L.info.id);H?this.emit(Vr.STAGE_PARTICIPANT_STREAMS_REMOVED,H.info,uS(B)):this.logger.warn({msg:"Got stream remove for participant no longer being tracked"})}),L.on(lo.MEDIA_STREAM_MUTE_CHANGED,B=>{this.onStreamMuteChange(L.info,B.remote)}),L.on(lo.ERROR,B=>{this.errorManager.handleError(B,Af.SUBSCRIBE_ERROR)}),L.on(lo.MEDIA_STREAM_SEI_MESSAGE_RECEIVED,B=>{this.onSeiMessageReceived(L.info,B)})},this.onRemoteParticipantLeft=L=>{if(this.connectionState!==fs.CONNECTED)return;const B=this.participants.get(L);B?(B.participantLeave(),B.unsubscribe(),B.cleanup(),this.participants.delete(L),this.emitParticipantLeave(B.info)):this.logger.warn({msg:"Remote participant no longer tracked"})},this.emitParticipantLeave=L=>{this.emit(Vr.STAGE_PARTICIPANT_LEFT,L)},this.onRemoteParticipantStateChanged=L=>{const B=this.participants.get(L.id);if(!B)return void this.logger.warn({msg:"Remote participant updated but not tracked"});B.updatePublishState(L.isPublishing)&&this.onPublishStateChanged(B.info,B.publishState),B.updateStreamState(L.audioMuted,L.videoStopped);const H=this.strategyWrapper.shouldSubscribeToParticipant(B.info);if(ti.isNotOk(H))return;this.updateManagerWithExternalSubscribeConfig(B.info,"updated");const te=this.configManager.getSubscribeConfigSnapshot(B.info.id),re=ti.getOk_or(H,Oo.NONE);B.updateSubscribeStateIfNecessary(re,te)},this.onPublishStateChanged=(L,B)=>{this.emit(Vr.STAGE_PARTICIPANT_PUBLISH_STATE_CHANGED,L,B)},this.onParticipantSubscribeStateChanged=(L,B)=>{const H=this.participants.get(L);H?this.emit(Vr.STAGE_PARTICIPANT_SUBSCRIBE_STATE_CHANGED,H.info,B):this.logger.warn({msg:"Remote participant subscribe state changed but not tracked"})},this.onLocalStreamsAdded=L=>{this.localParticipant&&this.emit(Vr.STAGE_PARTICIPANT_STREAMS_ADDED,this.localParticipant.info,L)},this.onLocalStreamsRemoved=L=>{this.localParticipant&&this.emit(Vr.STAGE_PARTICIPANT_STREAMS_REMOVED,this.localParticipant.info,L)},this.onStreamMuteChange=(L,B)=>{this.emit(Vr.STAGE_STREAM_MUTE_CHANGED,L,B)},this.onSeiMessageReceived=(L,B)=>{this.emit(Vr.STAGE_STREAM_SEI_MESSAGE_RECEIVED,L,B)},this.leave=()=>{this.cleanup(sg.USER_INITIATED)},this.onBeforeUnloadCleanup=()=>{var L;this.participants.forEach(B=>{B.quickUnsubscribe()}),(L=this.localParticipant)===null||L===void 0||L.quickUnpublish(),this.stageConnection.disconnect(),this.emit(Vr.STAGE_CONNECTION_STATE_CHANGED,fs.DISCONNECTED),this.analyticsTracker.stop(!0)},this.cleanup=L=>{if(!this.localParticipant)return;this.analyticsTracker.trackEventNoSharedProps(new Mu({token:this.token,eventEndpoint:this.token.eventsURL,whipEndpoint:this.token.whipURL,traceId:this.joinTraceId,reason:L})),this.localParticipant.unpublish(),this.localParticipant.cleanup();const B=this.localParticipant.info;this.localParticipant=void 0,this.emitParticipantLeave(B);const H=this.participants.entries();for(const[te,re]of H)re.unsubscribe(),this.participants.delete(te),re.cleanup(),this.emitParticipantLeave(re.info);Km.destroy(),this.stageConnection.disconnect(),this.emit(Vr.STAGE_CONNECTION_STATE_CHANGED,fs.DISCONNECTED),this.emit(Vr.STAGE_LEFT,L),this.stageConnection.removeAllListeners(),this.stageConnection=new QE(this.token,this.logger.unwrap(),this.analyticsTracker),this.setupListeners(),this.analyticsTracker.stop(!1),window.removeEventListener("beforeunload",this.onBeforeUnloadCleanup)},this.refreshStrategy=()=>{this.participants.forEach(L=>{if(L.info.capabilities.has(Oh.SUBSCRIBE)){const B=this.strategyWrapper.shouldSubscribeToParticipant(L.info);if(ti.isNotOk(B))return;const H=ti.getOk_or(B,Oo.NONE);this.updateManagerWithExternalSubscribeConfig(L.info,"updated");const te=this.configManager.getSubscribeConfigSnapshot(L.info.id);L.updateSubscribeStateIfNecessary(H,te),this.updateStreamLayerForParticipant(L)}}),this.updateStreamsToPublishIfNecessary()},this.updateStreamsToPublishIfNecessary=()=>{var L;if(!this.localParticipant||!(!((L=this.localParticipant)===null||L===void 0)&&L.info.capabilities.has(Oh.PUBLISH)))return;const B=this.localParticipant.publishState!==qs.NOT_PUBLISHED&&this.localParticipant.publishState!==qs.ERRORED,H=this.strategyWrapper.shouldPublishParticipant(this.localParticipant.info);if(ti.isNotOk(H))return;let te=ti.getOk_or(H,!1);if(!B&&!te)return;if(B&&!te)return void this.localParticipant.unpublish();const re=this.strategyWrapper.stageStreamsToPublish();if(ti.isNotOk(re)){const ae=ti.getErr(re);if(ae instanceof Error&&ae.cause==="UserStrategy")throw ae;return}const K=ti.getOk_or(re,[]);te=te&&K.length>0,!B&&te?(this.localParticipant.publish(K),this.onLocalStreamsAdded(K)):this.syncTracksToPublish(K)},this.syncTracksToPublish=L=>{var B;if(!this.localParticipant)return;const H=this.localParticipant.audioStream,te=this.localParticipant.videoStream,{updates:re,streamsToAdd:K,streamsToRemove:ae}=this.determineStreamUpdates(H,te,L);if(re.length){for(const he of re)he.newStream?(B=this.localParticipant)===null||B===void 0||B.replaceOrAddTrack(he.newStream):he.oldStream&&this.localParticipant.removeTrack(he.oldStream);ae.length!==0&&this.onLocalStreamsRemoved(ae),K.length!==0&&this.onLocalStreamsAdded(K)}},this.determineStreamUpdates=(L,B,H=[])=>{const te=[],re=H.slice(0,2);if(re.sort((he,pe)=>he.streamType===Xt.AUDIO?-1:1),re.length===0)L&&te.push({oldStream:L}),B&&te.push({oldStream:B});else if(re.length===1){const he=re[0];he.streamType===Xt.AUDIO?B&&te.push({oldStream:B}):he.streamType===Xt.VIDEO&&L&&te.push({oldStream:L})}re.forEach(he=>{var pe,Ne;he.streamType===Xt.AUDIO?L?L.id===he.id&&(0,fa.isEqual)(L.mediaConfig,he.mediaConfig)||(!!(!((pe=L.mediaConfig)===null||pe===void 0)&&pe.stereo)!=!!(!((Ne=he.mediaConfig)===null||Ne===void 0)&&Ne.stereo)&&this.logger.warn({msg:"Ignoring change to audio stream's stereo configuration. Re-publish to change stereo configuraiton."}),te.push({oldStream:L,newStream:he})):te.push({newStream:he}):he.streamType===Xt.VIDEO&&(B?B.id===he.id&&(0,fa.isEqual)(B.mediaConfig,he.mediaConfig)||te.push({oldStream:B,newStream:he}):te.push({newStream:he}))});const K=te.map(he=>he.newStream).filter(Ds),ae=te.map(he=>he.oldStream).filter(Ds);return{updates:te,streamsToAdd:K,streamsToRemove:ae}},this.onReassignmentMessage=L=>uo(this,void 0,void 0,function*(){if(gh("disableReassignments"))return void this.logger.debug({msg:"REASSIGN message ignored: disableReassignments is configured"});if(!hs.browser.isChrome())return void this.logger.debug({msg:"REASSIGN message ignored: browser is not chrome"});const B=gc();this.trackReassignmentRequest(L,B);const H=this.participants.get(L.remoteParticipantId),te=this.token.participantID,re=function(K,{localParticipantId:ae,remoteParticipant:he}){const{participantId:pe}=K;if(ae!==pe)return ti.err(Object.assign(Object.assign({},Bt.REASSIGNMENT_REQUEST_INVALID_LOCAL_PARTICIPANT_ID),{details:`Invalid participantId received: ${pe}`}));if(!he)return ti.err(Object.assign(Object.assign({},Bt.REASSIGNMENT_REQUEST_INVALID_REMOTE_PARTICIPANT_ID),{details:`Invalid remoteParticipantId received: ${he}`}));if(he.isReassigning())return ti.err(Bt.REASSIGNMENT_REQUEST_ALREADY_IN_PROGRESS);const Ne=he.subscription.peerClient.getConnectionState();return[at.CONNECTED,at.DISCONNECTED].includes(Ne)?ti.ok(he):ti.err(Object.assign(Object.assign({},Bt.REASSIGNMENT_REQUEST_INVALID_REMOTE_PEER_CONNECTION_STATE),{details:`connectionState: ${Ne}`}))}(L,{localParticipantId:te,remoteParticipant:H});if(!re.ok)this.trackReassignmentRequestRejected(re.error,B);else try{const{token:K,nodeOverride:ae}=L;yield re.value.triggerIceRestart({assignmentToken:K,traceId:B,nodeOverride:ae})}catch(K){this.logger.error({msg:"Reassignment failed.",err:K})}}),this.onIncompatibleCodecsMessage=L=>uo(this,void 0,void 0,function*(){var B;yield(B=this.localParticipant)===null||B===void 0?void 0:B.onIncompatibleCodecs(L.codecs)}),this.analyticsTracker=new gf;const O=R0();this.logger=new ro(new km(O),me.STAGE),this.strategyWrapper=new oR(A,this.logger),this.configManager=new aR({logger:this.logger.unwrap(),subscribeDefaults:{jitterBuffer:{minDelayWhenPublishing:Gs.DEFAULT,minDelayWhenSubscribeOnly:Gs.DEFAULT},inBandMessaging:{enabled:!1},simulcast:{initialLayerPreference:Kl.LOWEST_QUALITY}}}),this.errorManager=new sR;try{this.token=Iu(S,this.analyticsTracker)}catch(L){const B=new Ii(Object.assign({action:fn.JOIN,token:S,traceId:gc(),tag:vc.JOIN_RELATED,location:"Stage.constructor"},Bt.MALFORMED_TOKEN));throw L instanceof Error&&(B.details=L.message),this.errorManager.handleError(B,Af.JOIN_ERROR)||L}this.stageConnection=new QE(this.token,this.logger.unwrap(),this.analyticsTracker),this.setupListeners()}setupListeners(){this.stageConnection.on(wl,(S,A)=>{this.onConnectionStateChanged(S,A)}),this.stageConnection.on(Ed,S=>{this.onRemoteParticipantJoined(S)}),this.stageConnection.on(bf,S=>{this.onRemoteParticipantLeft(S.id)}),this.stageConnection.on(j0,S=>{var A;S.id!==((A=this.localParticipant)===null||A===void 0?void 0:A.info.id)&&this.onRemoteParticipantStateChanged(S)}),this.stageConnection.on(Yl,S=>uo(this,void 0,void 0,function*(){yield this.onReassignmentMessage(S)})),this.stageConnection.on(Sd,S=>uo(this,void 0,void 0,function*(){yield this.onIncompatibleCodecsMessage(S)})),this.stageConnection.on(Lp,S=>{S instanceof Ii&&this.analyticsTracker.trackError(S),this.errorManager.handleError(S,Af.JOIN_ERROR)}),this.errorManager.on(ng.ERROR,S=>{this.emit(Vr.ERROR,S)})}setupRemoteParticipantStreamEvents(S,A){const O=A.remote;A.on(Gu.ADAPTION_CHANGED,L=>{this.emit(Vr.STAGE_STREAM_ADAPTION_CHANGED,S,O,L)}),A.on(Gu.LAYERS_CHANGED,L=>{this.emit(Vr.STAGE_STREAM_LAYERS_CHANGED,S,O,L)}),A.on(Gu.LAYER_SELECTED,(L,B)=>{this.emit(Vr.STAGE_STREAM_LAYER_SELECTED,S,O,L,B)}),A.layers.length>0&&(this.emit(Vr.STAGE_STREAM_LAYERS_CHANGED,S,O,O.getLayers()),this.emit(Vr.STAGE_STREAM_LAYER_SELECTED,S,O,O.getSelectedLayer(),Mh.SELECTED))}join(){return uo(this,void 0,void 0,function*(){this.analyticsTracker.start(),this.joinTraceId=gc(),this.analyticsTracker.trackEvent(new sv({token:this.token,eventEndpoint:this.token.eventsURL,whipEndpoint:this.token.whipURL,traceId:this.joinTraceId}));try{this.token.assertTokenIsUnexpired(gc(),vc.JOIN_RELATED,"join")}catch(S){throw this.errorManager.handleError(S,Af.JOIN_ERROR)||S}try{this.joinTraceId=yield this.stageConnection.connect(this.joinTraceId),this.connectionState===fs.CONNECTED&&(this.setupLocalParticipantOnce(),this.updateStreamsToPublishIfNecessary()),window.addEventListener("beforeunload",this.onBeforeUnloadCleanup)}catch(S){throw this.logger.error({err:S,msg:"error joining stage"}),this.errorManager.handleError(S,Af.JOIN_ERROR,!1)||S}})}replaceStrategy(S){this.strategyWrapper.setStrategy(S),this.refreshStrategy()}updateManagerWithExternalSubscribeConfig(S,A){const O=ti.getOk(this.strategyWrapper.subscribeConfiguration(S));if(O===void 0)return;const L=S.id;if(this.configManager.handleExternalSubscribeConfigUpdate(L,O,ig.API)){const B=this.configManager.getSubscribeConfigSnapshot(L);this.analyticsTracker.trackEventNoSharedProps(new Gm(this.token,this.joinTraceId,{trigger:A==="joined"?"initial":"ad-hoc",remote_participant_id:L,min_delay_when_publishing:ja(B.jitterBuffer.minDelayWhenPublishing,!0),min_delay_when_subscribe_only:ja(B.jitterBuffer.minDelayWhenSubscribeOnly,!1),in_band_messaging_enabled:B.inBandMessaging.enabled,simulcast_initial_layer_preference:B.simulcast.initialLayerPreference}))}}updateStreamLayerForParticipant(S){S.streams.forEach(A=>{if(A.streamType==="audio")return;const O=this.strategyWrapper.preferredLayerForStream(S.info,A.remote),L=ti.getOk_or(O,void 0);A.setLayer(L)})}trackReassignmentRequestRejected(S,A){const{token:O}=this,L=new Ii(Object.assign(Object.assign({},S),{token:O,action:fn.JOIN,traceId:A,tag:vc.SUBSCRIBE_RELATED,location:"publish"}));this.logger.error({err:L,msg:"Reassignment request rejected."}),this.analyticsTracker.trackError(L)}trackReassignmentRequest(S,A){const{token:O}=this;this.analyticsTracker.trackEvent(new ux({token:O,traceId:A,targetLocalParticipantId:S.participantId,targetRemoteParticipantId:S.remoteParticipantId}))}}var sg;(function(N){N.UNKNOWN="unknown",N.USER_INITIATED="user-initiated",N.TOKEN_REUSED="token-reused",N.PARTICIPANT_DISCONNECTED="participant-disconnected",N.STAGE_DELETED="stage-deleted"})(sg||(sg={}));const pS=h})(),s})())})(M1e);var oxt=M1e.exports;const zS=Yc(oxt),O1e="0123456789abcdefABCDEF";O1e.split("").map(t=>t.codePointAt(0));Array(256).fill(!0).map((t,e)=>{const n=String.fromCodePoint(e),i=O1e.indexOf(n);return i<0?void 0:i<16?i:i-6});new TextEncoder;new TextDecoder;function ew(t,e){const n=Math.min(t.length,e.length);for(let i=0;i<n;++i)if(t[i]!==e[i])return t[i]<e[i]?-1:1;return t.length===e.length?0:t.length>e.length?1:-1}var cxt=(t,e,n=Math.min(t.length,e.length))=>{for(let i=0;i<n;i++){const r=t[i],s=e[i];if(r!==s)return 8*n-(i*8+Math.clz32(r^s)-24)}return 0},lxt=class{constructor(t,e){this.id=t,this.bucketSize=e.bucketSize||20,this.buckets=new Array(t.length*8+1).fill(void 0).map(()=>[]),this.compare=e.compare||(()=>0),this.getId=e.getId}get length(){return this.buckets.reduce((t,e)=>t+e.length,0)}*[Symbol.iterator](){for(const t of this.buckets)for(const e of t)yield e}add(t,e=this.getBitwiseDistance(this.getId(t))){if(this.has(this.getId(t),e))return!1;if(this.buckets[e].length<this.bucketSize)return this.buckets[e].push(t),!0;const n=this.buckets[e].slice(0);n.push(t);const i=n.sort(this.compare);this.buckets[e]=i.slice(0,this.bucketSize);const r=i.at(-1);return ew(this.getId(t),this.getId(r))!==0}clear(){for(let t=0;t<this.buckets.length;t++)this.buckets[t]=[]}listClosestToId(t,e=this.buckets.length*this.bucketSize){const n=this.getBitwiseDistance(t);return this.getNodes(n,e)}get(t){const e=this.buckets[t].shift();return e&&this.buckets[t].push(e),e}getById(t,e=this.getBitwiseDistance(t)){const n=this.buckets[e].findIndex(r=>ew(this.getId(r),t)===0);if(n===-1)return;const i=this.buckets[e][n];return this.buckets[e]=this.buckets[e].splice(n,1).concat(i),i}getBitwiseDistance(t){return cxt(this.id,t)}getNodes(t,e,n=0){const i=(n%2===0?1:-1)*Math.ceil(n/2);if(Math.abs(i)>Math.max(t,this.buckets.length-1-t))return[];const r=t+i;if(0>r||r>this.buckets.length-1)return this.getNodes(t,e,n+1);const s=this.buckets[r].slice(0,e);return s.length>=e?(this.buckets[r]=this.buckets[r].slice(s.length).concat(this.buckets[r].slice(0,s.length)),s):s.concat(this.getNodes(t,e-s.length,n+1))}has(t,e=this.getBitwiseDistance(t)){return!!this.buckets[e].find(n=>ew(this.getId(n),t)===0)}peek(t){return this.buckets[t].at(0)}peekById(t,e=this.getBitwiseDistance(t)){return this.buckets[e].find(n=>ew(this.getId(n),t)===0)}update(t,e=this.getBitwiseDistance(this.getId(t))){const n=this.buckets[e].findIndex(i=>ew(this.getId(i),this.getId(t))===0);return n===-1?!1:(this.buckets[e][n]=t,!0)}remove(t,e=this.getBitwiseDistance(t)){const n=this.buckets[e].findIndex(i=>ew(this.getId(i),t)===0);return n===-1?!1:(this.buckets[e].splice(n,1),!0)}},N1e={exports:{}};(function(t){var e=function(){function n(f,d){return d!=null&&f instanceof d}var i;try{i=Map}catch{i=function(){}}var r;try{r=Set}catch{r=function(){}}var s;try{s=Promise}catch{s=function(){}}function a(f,d,p,g,y){typeof d=="object"&&(p=d.depth,g=d.prototype,y=d.includeNonEnumerable,d=d.circular);var v=[],b=[],T=typeof Fl<"u";typeof d>"u"&&(d=!0),typeof p>"u"&&(p=1/0);function x(M,R){if(M===null)return null;if(R===0)return M;var I,k;if(typeof M!="object")return M;if(n(M,i))I=new i;else if(n(M,r))I=new r;else if(n(M,s))I=new s(function(J,X){M.then(function(ee){J(x(ee,R-1))},function(ee){X(x(ee,R-1))})});else if(a.__isArray(M))I=[];else if(a.__isRegExp(M))I=new RegExp(M.source,h(M)),M.lastIndex&&(I.lastIndex=M.lastIndex);else if(a.__isDate(M))I=new Date(M.getTime());else{if(T&&Fl.isBuffer(M))return Fl.allocUnsafe?I=Fl.allocUnsafe(M.length):I=new Fl(M.length),M.copy(I),I;n(M,Error)?I=Object.create(M):typeof g>"u"?(k=Object.getPrototypeOf(M),I=Object.create(k)):(I=Object.create(g),k=g)}if(d){var P=v.indexOf(M);if(P!=-1)return b[P];v.push(M),b.push(I)}n(M,i)&&M.forEach(function(J,X){var ee=x(X,R-1),oe=x(J,R-1);I.set(ee,oe)}),n(M,r)&&M.forEach(function(J){var X=x(J,R-1);I.add(X)});for(var U in M){var G;k&&(G=Object.getOwnPropertyDescriptor(k,U)),!(G&&G.set==null)&&(I[U]=x(M[U],R-1))}if(Object.getOwnPropertySymbols)for(var $=Object.getOwnPropertySymbols(M),U=0;U<$.length;U++){var q=$[U],Y=Object.getOwnPropertyDescriptor(M,q);Y&&!Y.enumerable&&!y||(I[q]=x(M[q],R-1),Y.enumerable||Object.defineProperty(I,q,{enumerable:!1}))}if(y)for(var ie=Object.getOwnPropertyNames(M),U=0;U<ie.length;U++){var V=ie[U],Y=Object.getOwnPropertyDescriptor(M,V);Y&&Y.enumerable||(I[V]=x(M[V],R-1),Object.defineProperty(I,V,{enumerable:!1}))}return I}return x(f,p)}a.clonePrototype=function(d){if(d===null)return null;var p=function(){};return p.prototype=d,new p};function o(f){return Object.prototype.toString.call(f)}a.__objToStr=o;function c(f){return typeof f=="object"&&o(f)==="[object Date]"}a.__isDate=c;function l(f){return typeof f=="object"&&o(f)==="[object Array]"}a.__isArray=l;function u(f){return typeof f=="object"&&o(f)==="[object RegExp]"}a.__isRegExp=u;function h(f){var d="";return f.global&&(d+="g"),f.ignoreCase&&(d+="i"),f.multiline&&(d+="m"),d}return a.__getRegExpFlags=h,a}();t.exports&&(t.exports=e)})(N1e);var uxt=N1e.exports,j$={exports:{}},Yj,eoe;function hxt(){if(eoe)return Yj;eoe=1;var t=1e3,e=t*60,n=e*60,i=n*24,r=i*7,s=i*365.25;Yj=function(u,h){h=h||{};var f=typeof u;if(f==="string"&&u.length>0)return a(u);if(f==="number"&&isFinite(u))return h.long?c(u):o(u);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(u))};function a(u){if(u=String(u),!(u.length>100)){var h=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(u);if(h){var f=parseFloat(h[1]),d=(h[2]||"ms").toLowerCase();switch(d){case"years":case"year":case"yrs":case"yr":case"y":return f*s;case"weeks":case"week":case"w":return f*r;case"days":case"day":case"d":return f*i;case"hours":case"hour":case"hrs":case"hr":case"h":return f*n;case"minutes":case"minute":case"mins":case"min":case"m":return f*e;case"seconds":case"second":case"secs":case"sec":case"s":return f*t;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return f;default:return}}}}function o(u){var h=Math.abs(u);return h>=i?Math.round(u/i)+"d":h>=n?Math.round(u/n)+"h":h>=e?Math.round(u/e)+"m":h>=t?Math.round(u/t)+"s":u+"ms"}function c(u){var h=Math.abs(u);return h>=i?l(u,h,i,"day"):h>=n?l(u,h,n,"hour"):h>=e?l(u,h,e,"minute"):h>=t?l(u,h,t,"second"):u+" ms"}function l(u,h,f,d){var p=h>=f*1.5;return Math.round(u/f)+" "+d+(p?"s":"")}return Yj}function fxt(t){n.debug=n,n.default=n,n.coerce=c,n.disable=s,n.enable=r,n.enabled=a,n.humanize=hxt(),n.destroy=l,Object.keys(t).forEach(u=>{n[u]=t[u]}),n.names=[],n.skips=[],n.formatters={};function e(u){let h=0;for(let f=0;f<u.length;f++)h=(h<<5)-h+u.charCodeAt(f),h|=0;return n.colors[Math.abs(h)%n.colors.length]}n.selectColor=e;function n(u){let h,f=null,d,p;function g(...y){if(!g.enabled)return;const v=g,b=Number(new Date),T=b-(h||b);v.diff=T,v.prev=h,v.curr=b,h=b,y[0]=n.coerce(y[0]),typeof y[0]!="string"&&y.unshift("%O");let x=0;y[0]=y[0].replace(/%([a-zA-Z%])/g,(R,I)=>{if(R==="%%")return"%";x++;const k=n.formatters[I];if(typeof k=="function"){const P=y[x];R=k.call(v,P),y.splice(x,1),x--}return R}),n.formatArgs.call(v,y),(v.log||n.log).apply(v,y)}return g.namespace=u,g.useColors=n.useColors(),g.color=n.selectColor(u),g.extend=i,g.destroy=n.destroy,Object.defineProperty(g,"enabled",{enumerable:!0,configurable:!1,get:()=>f!==null?f:(d!==n.namespaces&&(d=n.namespaces,p=n.enabled(u)),p),set:y=>{f=y}}),typeof n.init=="function"&&n.init(g),g}function i(u,h){const f=n(this.namespace+(typeof h>"u"?":":h)+u);return f.log=this.log,f}function r(u){n.save(u),n.namespaces=u,n.names=[],n.skips=[];let h;const f=(typeof u=="string"?u:"").split(/[\s,]+/),d=f.length;for(h=0;h<d;h++)f[h]&&(u=f[h].replace(/\*/g,".*?"),u[0]==="-"?n.skips.push(new RegExp("^"+u.slice(1)+"$")):n.names.push(new RegExp("^"+u+"$")))}function s(){const u=[...n.names.map(o),...n.skips.map(o).map(h=>"-"+h)].join(",");return n.enable(""),u}function a(u){if(u[u.length-1]==="*")return!0;let h,f;for(h=0,f=n.skips.length;h<f;h++)if(n.skips[h].test(u))return!1;for(h=0,f=n.names.length;h<f;h++)if(n.names[h].test(u))return!0;return!1}function o(u){return u.toString().substring(2,u.toString().length-2).replace(/\.\*\?$/,"*")}function c(u){return u instanceof Error?u.stack||u.message:u}function l(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")}return n.enable(n.load()),n}var dxt=fxt;(function(t,e){var n={};e.formatArgs=r,e.save=s,e.load=a,e.useColors=i,e.storage=o(),e.destroy=(()=>{let l=!1;return()=>{l||(l=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})(),e.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"];function i(){if(typeof window<"u"&&window.process&&(window.process.type==="renderer"||window.process.__nwjs))return!0;if(typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))return!1;let l;return typeof document<"u"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window<"u"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator<"u"&&navigator.userAgent&&(l=navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/))&&parseInt(l[1],10)>=31||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)}function r(l){if(l[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+l[0]+(this.useColors?"%c ":" ")+"+"+t.exports.humanize(this.diff),!this.useColors)return;const u="color: "+this.color;l.splice(1,0,u,"color: inherit");let h=0,f=0;l[0].replace(/%[a-zA-Z%]/g,d=>{d!=="%%"&&(h++,d==="%c"&&(f=h))}),l.splice(f,0,u)}e.log=console.debug||console.log||(()=>{});function s(l){try{l?e.storage.setItem("debug",l):e.storage.removeItem("debug")}catch{}}function a(){let l;try{l=e.storage.getItem("debug")}catch{}return!l&&typeof zn<"u"&&"env"in zn&&(l=n.DEBUG),l}function o(){try{return localStorage}catch{}}t.exports=dxt(e);const{formatters:c}=t.exports;c.j=function(l){try{return JSON.stringify(l)}catch(u){return"[UnexpectedJSONParseError]: "+u.message}}})(j$,j$.exports);var x8=j$.exports,pxt=function(){if(typeof globalThis>"u")return null;var e={RTCPeerConnection:globalThis.RTCPeerConnection||globalThis.mozRTCPeerConnection||globalThis.webkitRTCPeerConnection,RTCSessionDescription:globalThis.RTCSessionDescription||globalThis.mozRTCSessionDescription||globalThis.webkitRTCSessionDescription,RTCIceCandidate:globalThis.RTCIceCandidate||globalThis.mozRTCIceCandidate||globalThis.webkitRTCIceCandidate};return e.RTCPeerConnection?e:null},V$={exports:{}},G$={exports:{}};const Hk=koe(jqe);/*! safe-buffer. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> */(function(t,e){var n=Hk,i=n.Buffer;function r(a,o){for(var c in a)o[c]=a[c]}i.from&&i.alloc&&i.allocUnsafe&&i.allocUnsafeSlow?t.exports=n:(r(n,e),e.Buffer=s);function s(a,o,c){return i(a,o,c)}s.prototype=Object.create(i.prototype),r(i,s),s.from=function(a,o,c){if(typeof a=="number")throw new TypeError("Argument must not be a number");return i(a,o,c)},s.alloc=function(a,o,c){if(typeof a!="number")throw new TypeError("Argument must be a number");var l=i(a);return o!==void 0?typeof c=="string"?l.fill(o,c):l.fill(o):l.fill(0),l},s.allocUnsafe=function(a){if(typeof a!="number")throw new TypeError("Argument must be a number");return i(a)},s.allocUnsafeSlow=function(a){if(typeof a!="number")throw new TypeError("Argument must be a number");return n.SlowBuffer(a)}})(G$,G$.exports);var I1e=G$.exports,Xj=65536,mxt=4294967295;function gxt(){throw new Error(`Secure random number generation is not supported by this browser.
Use Chrome, Firefox or Internet Explorer 11`)}var vxt=I1e.Buffer,lB=jl.crypto||jl.msCrypto;lB&&lB.getRandomValues?V$.exports=_xt:V$.exports=gxt;function _xt(t,e){if(t>mxt)throw new RangeError("requested too many random bytes");var n=vxt.allocUnsafe(t);if(t>0)if(t>Xj)for(var i=0;i<t;i+=Xj)lB.getRandomValues(n.slice(i,i+Xj));else lB.getRandomValues(n);return typeof e=="function"?zn.nextTick(function(){e(null,n)}):n}var w8=V$.exports,q$={exports:{}},sZ={exports:{}},gC=typeof Reflect=="object"?Reflect:null,toe=gC&&typeof gC.apply=="function"?gC.apply:function(e,n,i){return Function.prototype.apply.call(e,n,i)},iL;gC&&typeof gC.ownKeys=="function"?iL=gC.ownKeys:Object.getOwnPropertySymbols?iL=function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:iL=function(e){return Object.getOwnPropertyNames(e)};function yxt(t){console&&console.warn&&console.warn(t)}var k1e=Number.isNaN||function(e){return e!==e};function js(){js.init.call(this)}sZ.exports=js;sZ.exports.once=Txt;js.EventEmitter=js;js.prototype._events=void 0;js.prototype._eventsCount=0;js.prototype._maxListeners=void 0;var noe=10;function C8(t){if(typeof t!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof t)}Object.defineProperty(js,"defaultMaxListeners",{enumerable:!0,get:function(){return noe},set:function(t){if(typeof t!="number"||t<0||k1e(t))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+t+".");noe=t}});js.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0};js.prototype.setMaxListeners=function(e){if(typeof e!="number"||e<0||k1e(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this};function D1e(t){return t._maxListeners===void 0?js.defaultMaxListeners:t._maxListeners}js.prototype.getMaxListeners=function(){return D1e(this)};js.prototype.emit=function(e){for(var n=[],i=1;i<arguments.length;i++)n.push(arguments[i]);var r=e==="error",s=this._events;if(s!==void 0)r=r&&s.error===void 0;else if(!r)return!1;if(r){var a;if(n.length>0&&(a=n[0]),a instanceof Error)throw a;var o=new Error("Unhandled error."+(a?" ("+a.message+")":""));throw o.context=a,o}var c=s[e];if(c===void 0)return!1;if(typeof c=="function")toe(c,this,n);else for(var l=c.length,u=F1e(c,l),i=0;i<l;++i)toe(u[i],this,n);return!0};function P1e(t,e,n,i){var r,s,a;if(C8(n),s=t._events,s===void 0?(s=t._events=Object.create(null),t._eventsCount=0):(s.newListener!==void 0&&(t.emit("newListener",e,n.listener?n.listener:n),s=t._events),a=s[e]),a===void 0)a=s[e]=n,++t._eventsCount;else if(typeof a=="function"?a=s[e]=i?[n,a]:[a,n]:i?a.unshift(n):a.push(n),r=D1e(t),r>0&&a.length>r&&!a.warned){a.warned=!0;var o=new Error("Possible EventEmitter memory leak detected. "+a.length+" "+String(e)+" listeners added. Use emitter.setMaxListeners() to increase limit");o.name="MaxListenersExceededWarning",o.emitter=t,o.type=e,o.count=a.length,yxt(o)}return t}js.prototype.addListener=function(e,n){return P1e(this,e,n,!1)};js.prototype.on=js.prototype.addListener;js.prototype.prependListener=function(e,n){return P1e(this,e,n,!0)};function bxt(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function L1e(t,e,n){var i={fired:!1,wrapFn:void 0,target:t,type:e,listener:n},r=bxt.bind(i);return r.listener=n,i.wrapFn=r,r}js.prototype.once=function(e,n){return C8(n),this.on(e,L1e(this,e,n)),this};js.prototype.prependOnceListener=function(e,n){return C8(n),this.prependListener(e,L1e(this,e,n)),this};js.prototype.removeListener=function(e,n){var i,r,s,a,o;if(C8(n),r=this._events,r===void 0)return this;if(i=r[e],i===void 0)return this;if(i===n||i.listener===n)--this._eventsCount===0?this._events=Object.create(null):(delete r[e],r.removeListener&&this.emit("removeListener",e,i.listener||n));else if(typeof i!="function"){for(s=-1,a=i.length-1;a>=0;a--)if(i[a]===n||i[a].listener===n){o=i[a].listener,s=a;break}if(s<0)return this;s===0?i.shift():Ext(i,s),i.length===1&&(r[e]=i[0]),r.removeListener!==void 0&&this.emit("removeListener",e,o||n)}return this};js.prototype.off=js.prototype.removeListener;js.prototype.removeAllListeners=function(e){var n,i,r;if(i=this._events,i===void 0)return this;if(i.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):i[e]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete i[e]),this;if(arguments.length===0){var s=Object.keys(i),a;for(r=0;r<s.length;++r)a=s[r],a!=="removeListener"&&this.removeAllListeners(a);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(n=i[e],typeof n=="function")this.removeListener(e,n);else if(n!==void 0)for(r=n.length-1;r>=0;r--)this.removeListener(e,n[r]);return this};function U1e(t,e,n){var i=t._events;if(i===void 0)return[];var r=i[e];return r===void 0?[]:typeof r=="function"?n?[r.listener||r]:[r]:n?Sxt(r):F1e(r,r.length)}js.prototype.listeners=function(e){return U1e(this,e,!0)};js.prototype.rawListeners=function(e){return U1e(this,e,!1)};js.listenerCount=function(t,e){return typeof t.listenerCount=="function"?t.listenerCount(e):B1e.call(t,e)};js.prototype.listenerCount=B1e;function B1e(t){var e=this._events;if(e!==void 0){var n=e[t];if(typeof n=="function")return 1;if(n!==void 0)return n.length}return 0}js.prototype.eventNames=function(){return this._eventsCount>0?iL(this._events):[]};function F1e(t,e){for(var n=new Array(e),i=0;i<e;++i)n[i]=t[i];return n}function Ext(t,e){for(;e+1<t.length;e++)t[e]=t[e+1];t.pop()}function Sxt(t){for(var e=new Array(t.length),n=0;n<e.length;++n)e[n]=t[n].listener||t[n];return e}function Txt(t,e){return new Promise(function(n,i){function r(a){t.removeListener(e,s),i(a)}function s(){typeof t.removeListener=="function"&&t.removeListener("error",r),n([].slice.call(arguments))}z1e(t,e,s,{once:!0}),e!=="error"&&xxt(t,r,{once:!0})})}function xxt(t,e,n){typeof t.on=="function"&&z1e(t,"error",e,n)}function z1e(t,e,n,i){if(typeof t.on=="function")i.once?t.once(e,n):t.on(e,n);else if(typeof t.addEventListener=="function")t.addEventListener(e,function r(s){i.once&&t.removeEventListener(e,r),n(s)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof t)}var jk=sZ.exports;const _At=Yc(jk);var H1e=jk.EventEmitter,Kj,ioe;function wxt(){if(ioe)return Kj;ioe=1;function t(p,g){var y=Object.keys(p);if(Object.getOwnPropertySymbols){var v=Object.getOwnPropertySymbols(p);g&&(v=v.filter(function(b){return Object.getOwnPropertyDescriptor(p,b).enumerable})),y.push.apply(y,v)}return y}function e(p){for(var g=1;g<arguments.length;g++){var y=arguments[g]!=null?arguments[g]:{};g%2?t(Object(y),!0).forEach(function(v){n(p,v,y[v])}):Object.getOwnPropertyDescriptors?Object.defineProperties(p,Object.getOwnPropertyDescriptors(y)):t(Object(y)).forEach(function(v){Object.defineProperty(p,v,Object.getOwnPropertyDescriptor(y,v))})}return p}function n(p,g,y){return g=a(g),g in p?Object.defineProperty(p,g,{value:y,enumerable:!0,configurable:!0,writable:!0}):p[g]=y,p}function i(p,g){if(!(p instanceof g))throw new TypeError("Cannot call a class as a function")}function r(p,g){for(var y=0;y<g.length;y++){var v=g[y];v.enumerable=v.enumerable||!1,v.configurable=!0,"value"in v&&(v.writable=!0),Object.defineProperty(p,a(v.key),v)}}function s(p,g,y){return g&&r(p.prototype,g),Object.defineProperty(p,"prototype",{writable:!1}),p}function a(p){var g=o(p,"string");return typeof g=="symbol"?g:String(g)}function o(p,g){if(typeof p!="object"||p===null)return p;var y=p[Symbol.toPrimitive];if(y!==void 0){var v=y.call(p,g||"default");if(typeof v!="object")return v;throw new TypeError("@@toPrimitive must return a primitive value.")}return(g==="string"?String:Number)(p)}var c=Hk,l=c.Buffer,u=n1,h=u.inspect,f=h&&h.custom||"inspect";function d(p,g,y){l.prototype.copy.call(p,g,y)}return Kj=function(){function p(){i(this,p),this.head=null,this.tail=null,this.length=0}return s(p,[{key:"push",value:function(y){var v={data:y,next:null};this.length>0?this.tail.next=v:this.head=v,this.tail=v,++this.length}},{key:"unshift",value:function(y){var v={data:y,next:this.head};this.length===0&&(this.tail=v),this.head=v,++this.length}},{key:"shift",value:function(){if(this.length!==0){var y=this.head.data;return this.length===1?this.head=this.tail=null:this.head=this.head.next,--this.length,y}}},{key:"clear",value:function(){this.head=this.tail=null,this.length=0}},{key:"join",value:function(y){if(this.length===0)return"";for(var v=this.head,b=""+v.data;v=v.next;)b+=y+v.data;return b}},{key:"concat",value:function(y){if(this.length===0)return l.alloc(0);for(var v=l.allocUnsafe(y>>>0),b=this.head,T=0;b;)d(b.data,v,T),T+=b.data.length,b=b.next;return v}},{key:"consume",value:function(y,v){var b;return y<this.head.data.length?(b=this.head.data.slice(0,y),this.head.data=this.head.data.slice(y)):y===this.head.data.length?b=this.shift():b=v?this._getString(y):this._getBuffer(y),b}},{key:"first",value:function(){return this.head.data}},{key:"_getString",value:function(y){var v=this.head,b=1,T=v.data;for(y-=T.length;v=v.next;){var x=v.data,M=y>x.length?x.length:y;if(M===x.length?T+=x:T+=x.slice(0,y),y-=M,y===0){M===x.length?(++b,v.next?this.head=v.next:this.head=this.tail=null):(this.head=v,v.data=x.slice(M));break}++b}return this.length-=b,T}},{key:"_getBuffer",value:function(y){var v=l.allocUnsafe(y),b=this.head,T=1;for(b.data.copy(v),y-=b.data.length;b=b.next;){var x=b.data,M=y>x.length?x.length:y;if(x.copy(v,v.length-y,0,M),y-=M,y===0){M===x.length?(++T,b.next?this.head=b.next:this.head=this.tail=null):(this.head=b,b.data=x.slice(M));break}++T}return this.length-=T,v}},{key:f,value:function(y,v){return h(this,e(e({},v),{},{depth:0,customInspect:!1}))}}]),p}(),Kj}function Cxt(t,e){var n=this,i=this._readableState&&this._readableState.destroyed,r=this._writableState&&this._writableState.destroyed;return i||r?(e?e(t):t&&(this._writableState?this._writableState.errorEmitted||(this._writableState.errorEmitted=!0,zn.nextTick($$,this,t)):zn.nextTick($$,this,t)),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(t||null,function(s){!e&&s?n._writableState?n._writableState.errorEmitted?zn.nextTick(rL,n):(n._writableState.errorEmitted=!0,zn.nextTick(roe,n,s)):zn.nextTick(roe,n,s):e?(zn.nextTick(rL,n),e(s)):zn.nextTick(rL,n)}),this)}function roe(t,e){$$(t,e),rL(t)}function rL(t){t._writableState&&!t._writableState.emitClose||t._readableState&&!t._readableState.emitClose||t.emit("close")}function Axt(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finalCalled=!1,this._writableState.prefinished=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)}function $$(t,e){t.emit("error",e)}function Rxt(t,e){var n=t._readableState,i=t._writableState;n&&n.autoDestroy||i&&i.autoDestroy?t.destroy(e):t.emit("error",e)}var j1e={destroy:Cxt,undestroy:Axt,errorOrDestroy:Rxt},V1={};function Mxt(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t,t.__proto__=e}var V1e={};function Op(t,e,n){n||(n=Error);function i(s,a,o){return typeof e=="string"?e:e(s,a,o)}var r=function(s){Mxt(a,s);function a(o,c,l){return s.call(this,i(o,c,l))||this}return a}(n);r.prototype.name=n.name,r.prototype.code=t,V1e[t]=r}function soe(t,e){if(Array.isArray(t)){var n=t.length;return t=t.map(function(i){return String(i)}),n>2?"one of ".concat(e," ").concat(t.slice(0,n-1).join(", "),", or ")+t[n-1]:n===2?"one of ".concat(e," ").concat(t[0]," or ").concat(t[1]):"of ".concat(e," ").concat(t[0])}else return"of ".concat(e," ").concat(String(t))}function Oxt(t,e,n){return t.substr(0,e.length)===e}function Nxt(t,e,n){return(n===void 0||n>t.length)&&(n=t.length),t.substring(n-e.length,n)===e}function Ixt(t,e,n){return typeof n!="number"&&(n=0),n+e.length>t.length?!1:t.indexOf(e,n)!==-1}Op("ERR_INVALID_OPT_VALUE",function(t,e){return'The value "'+e+'" is invalid for option "'+t+'"'},TypeError);Op("ERR_INVALID_ARG_TYPE",function(t,e,n){var i;typeof e=="string"&&Oxt(e,"not ")?(i="must not be",e=e.replace(/^not /,"")):i="must be";var r;if(Nxt(t," argument"))r="The ".concat(t," ").concat(i," ").concat(soe(e,"type"));else{var s=Ixt(t,".")?"property":"argument";r='The "'.concat(t,'" ').concat(s," ").concat(i," ").concat(soe(e,"type"))}return r+=". Received type ".concat(typeof n),r},TypeError);Op("ERR_STREAM_PUSH_AFTER_EOF","stream.push() after EOF");Op("ERR_METHOD_NOT_IMPLEMENTED",function(t){return"The "+t+" method is not implemented"});Op("ERR_STREAM_PREMATURE_CLOSE","Premature close");Op("ERR_STREAM_DESTROYED",function(t){return"Cannot call "+t+" after a stream was destroyed"});Op("ERR_MULTIPLE_CALLBACK","Callback called multiple times");Op("ERR_STREAM_CANNOT_PIPE","Cannot pipe, not readable");Op("ERR_STREAM_WRITE_AFTER_END","write after end");Op("ERR_STREAM_NULL_VALUES","May not write null values to stream",TypeError);Op("ERR_UNKNOWN_ENCODING",function(t){return"Unknown encoding: "+t},TypeError);Op("ERR_STREAM_UNSHIFT_AFTER_END_EVENT","stream.unshift() after end event");V1.codes=V1e;var kxt=V1.codes.ERR_INVALID_OPT_VALUE;function Dxt(t,e,n){return t.highWaterMark!=null?t.highWaterMark:e?t[n]:null}function Pxt(t,e,n,i){var r=Dxt(e,i,n);if(r!=null){if(!(isFinite(r)&&Math.floor(r)===r)||r<0){var s=i?n:"highWaterMark";throw new kxt(s,r)}return Math.floor(r)}return t.objectMode?16:16*1024}var G1e={getHighWaterMark:Pxt},W$={exports:{}};typeof Object.create=="function"?W$.exports=function(e,n){n&&(e.super_=n,e.prototype=Object.create(n.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}))}:W$.exports=function(e,n){if(n){e.super_=n;var i=function(){};i.prototype=n.prototype,e.prototype=new i,e.prototype.constructor=e}};var Vk=W$.exports,Lxt=Uxt;function Uxt(t,e){if(Zj("noDeprecation"))return t;var n=!1;function i(){if(!n){if(Zj("throwDeprecation"))throw new Error(e);Zj("traceDeprecation")?console.trace(e):console.warn(e),n=!0}return t.apply(this,arguments)}return i}function Zj(t){try{if(!jl.localStorage)return!1}catch{return!1}var e=jl.localStorage[t];return e==null?!1:String(e).toLowerCase()==="true"}var Jj,aoe;function q1e(){if(aoe)return Jj;aoe=1,Jj=k;function t(we){var Ce=this;this.next=null,this.entry=null,this.finish=function(){Le(Ce,we)}}var e;k.WritableState=R;var n={deprecate:Lxt},i=H1e,r=Hk.Buffer,s=(typeof jl<"u"?jl:typeof window<"u"?window:typeof self<"u"?self:{}).Uint8Array||function(){};function a(we){return r.from(we)}function o(we){return r.isBuffer(we)||we instanceof s}var c=j1e,l=G1e,u=l.getHighWaterMark,h=V1.codes,f=h.ERR_INVALID_ARG_TYPE,d=h.ERR_METHOD_NOT_IMPLEMENTED,p=h.ERR_MULTIPLE_CALLBACK,g=h.ERR_STREAM_CANNOT_PIPE,y=h.ERR_STREAM_DESTROYED,v=h.ERR_STREAM_NULL_VALUES,b=h.ERR_STREAM_WRITE_AFTER_END,T=h.ERR_UNKNOWN_ENCODING,x=c.errorOrDestroy;Vk(k,i);function M(){}function R(we,Ce,ke){e=e||gA(),we=we||{},typeof ke!="boolean"&&(ke=Ce instanceof e),this.objectMode=!!we.objectMode,ke&&(this.objectMode=this.objectMode||!!we.writableObjectMode),this.highWaterMark=u(this,we,"writableHighWaterMark",ke),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var St=we.decodeStrings===!1;this.decodeStrings=!St,this.defaultEncoding=we.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(Mt){V(Ce,Mt)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.emitClose=we.emitClose!==!1,this.autoDestroy=!!we.autoDestroy,this.bufferedRequestCount=0,this.corkedRequestsFree=new t(this)}R.prototype.getBuffer=function(){for(var Ce=this.bufferedRequest,ke=[];Ce;)ke.push(Ce),Ce=Ce.next;return ke},function(){try{Object.defineProperty(R.prototype,"buffer",{get:n.deprecate(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch{}}();var I;typeof Symbol=="function"&&Symbol.hasInstance&&typeof Function.prototype[Symbol.hasInstance]=="function"?(I=Function.prototype[Symbol.hasInstance],Object.defineProperty(k,Symbol.hasInstance,{value:function(Ce){return I.call(this,Ce)?!0:this!==k?!1:Ce&&Ce._writableState instanceof R}})):I=function(Ce){return Ce instanceof this};function k(we){e=e||gA();var Ce=this instanceof e;if(!Ce&&!I.call(k,this))return new k(we);this._writableState=new R(we,this,Ce),this.writable=!0,we&&(typeof we.write=="function"&&(this._write=we.write),typeof we.writev=="function"&&(this._writev=we.writev),typeof we.destroy=="function"&&(this._destroy=we.destroy),typeof we.final=="function"&&(this._final=we.final)),i.call(this)}k.prototype.pipe=function(){x(this,new g)};function P(we,Ce){var ke=new b;x(we,ke),zn.nextTick(Ce,ke)}function U(we,Ce,ke,St){var Mt;return ke===null?Mt=new v:typeof ke!="string"&&!Ce.objectMode&&(Mt=new f("chunk",["string","Buffer"],ke)),Mt?(x(we,Mt),zn.nextTick(St,Mt),!1):!0}k.prototype.write=function(we,Ce,ke){var St=this._writableState,Mt=!1,Ee=!St.objectMode&&o(we);return Ee&&!r.isBuffer(we)&&(we=a(we)),typeof Ce=="function"&&(ke=Ce,Ce=null),Ee?Ce="buffer":Ce||(Ce=St.defaultEncoding),typeof ke!="function"&&(ke=M),St.ending?P(this,ke):(Ee||U(this,St,we,ke))&&(St.pendingcb++,Mt=$(this,St,Ee,we,Ce,ke)),Mt},k.prototype.cork=function(){this._writableState.corked++},k.prototype.uncork=function(){var we=this._writableState;we.corked&&(we.corked--,!we.writing&&!we.corked&&!we.bufferProcessing&&we.bufferedRequest&&ee(this,we))},k.prototype.setDefaultEncoding=function(Ce){if(typeof Ce=="string"&&(Ce=Ce.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((Ce+"").toLowerCase())>-1))throw new T(Ce);return this._writableState.defaultEncoding=Ce,this},Object.defineProperty(k.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}});function G(we,Ce,ke){return!we.objectMode&&we.decodeStrings!==!1&&typeof Ce=="string"&&(Ce=r.from(Ce,ke)),Ce}Object.defineProperty(k.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}});function $(we,Ce,ke,St,Mt,Ee){if(!ke){var _e=G(Ce,St,Mt);St!==_e&&(ke=!0,Mt="buffer",St=_e)}var tt=Ce.objectMode?1:St.length;Ce.length+=tt;var de=Ce.length<Ce.highWaterMark;if(de||(Ce.needDrain=!0),Ce.writing||Ce.corked){var Be=Ce.lastBufferedRequest;Ce.lastBufferedRequest={chunk:St,encoding:Mt,isBuf:ke,callback:Ee,next:null},Be?Be.next=Ce.lastBufferedRequest:Ce.bufferedRequest=Ce.lastBufferedRequest,Ce.bufferedRequestCount+=1}else q(we,Ce,!1,tt,St,Mt,Ee);return de}function q(we,Ce,ke,St,Mt,Ee,_e){Ce.writelen=St,Ce.writecb=_e,Ce.writing=!0,Ce.sync=!0,Ce.destroyed?Ce.onwrite(new y("write")):ke?we._writev(Mt,Ce.onwrite):we._write(Mt,Ee,Ce.onwrite),Ce.sync=!1}function Y(we,Ce,ke,St,Mt){--Ce.pendingcb,ke?(zn.nextTick(Mt,St),zn.nextTick(He,we,Ce),we._writableState.errorEmitted=!0,x(we,St)):(Mt(St),we._writableState.errorEmitted=!0,x(we,St),He(we,Ce))}function ie(we){we.writing=!1,we.writecb=null,we.length-=we.writelen,we.writelen=0}function V(we,Ce){var ke=we._writableState,St=ke.sync,Mt=ke.writecb;if(typeof Mt!="function")throw new p;if(ie(ke),Ce)Y(we,ke,St,Ce,Mt);else{var Ee=oe(ke)||we.destroyed;!Ee&&!ke.corked&&!ke.bufferProcessing&&ke.bufferedRequest&&ee(we,ke),St?zn.nextTick(J,we,ke,Ee,Mt):J(we,ke,Ee,Mt)}}function J(we,Ce,ke,St){ke||X(we,Ce),Ce.pendingcb--,St(),He(we,Ce)}function X(we,Ce){Ce.length===0&&Ce.needDrain&&(Ce.needDrain=!1,we.emit("drain"))}function ee(we,Ce){Ce.bufferProcessing=!0;var ke=Ce.bufferedRequest;if(we._writev&&ke&&ke.next){var St=Ce.bufferedRequestCount,Mt=new Array(St),Ee=Ce.corkedRequestsFree;Ee.entry=ke;for(var _e=0,tt=!0;ke;)Mt[_e]=ke,ke.isBuf||(tt=!1),ke=ke.next,_e+=1;Mt.allBuffers=tt,q(we,Ce,!0,Ce.length,Mt,"",Ee.finish),Ce.pendingcb++,Ce.lastBufferedRequest=null,Ee.next?(Ce.corkedRequestsFree=Ee.next,Ee.next=null):Ce.corkedRequestsFree=new t(Ce),Ce.bufferedRequestCount=0}else{for(;ke;){var de=ke.chunk,Be=ke.encoding,Ie=ke.callback,rt=Ce.objectMode?1:de.length;if(q(we,Ce,!1,rt,de,Be,Ie),ke=ke.next,Ce.bufferedRequestCount--,Ce.writing)break}ke===null&&(Ce.lastBufferedRequest=null)}Ce.bufferedRequest=ke,Ce.bufferProcessing=!1}k.prototype._write=function(we,Ce,ke){ke(new d("_write()"))},k.prototype._writev=null,k.prototype.end=function(we,Ce,ke){var St=this._writableState;return typeof we=="function"?(ke=we,we=null,Ce=null):typeof Ce=="function"&&(ke=Ce,Ce=null),we!=null&&this.write(we,Ce),St.corked&&(St.corked=1,this.uncork()),St.ending||Te(this,St,ke),this},Object.defineProperty(k.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}});function oe(we){return we.ending&&we.length===0&&we.bufferedRequest===null&&!we.finished&&!we.writing}function fe(we,Ce){we._final(function(ke){Ce.pendingcb--,ke&&x(we,ke),Ce.prefinished=!0,we.emit("prefinish"),He(we,Ce)})}function Re(we,Ce){!Ce.prefinished&&!Ce.finalCalled&&(typeof we._final=="function"&&!Ce.destroyed?(Ce.pendingcb++,Ce.finalCalled=!0,zn.nextTick(fe,we,Ce)):(Ce.prefinished=!0,we.emit("prefinish")))}function He(we,Ce){var ke=oe(Ce);if(ke&&(Re(we,Ce),Ce.pendingcb===0&&(Ce.finished=!0,we.emit("finish"),Ce.autoDestroy))){var St=we._readableState;(!St||St.autoDestroy&&St.endEmitted)&&we.destroy()}return ke}function Te(we,Ce,ke){Ce.ending=!0,He(we,Ce),ke&&(Ce.finished?zn.nextTick(ke):we.once("finish",ke)),Ce.ended=!0,we.writable=!1}function Le(we,Ce,ke){var St=we.entry;for(we.entry=null;St;){var Mt=St.callback;Ce.pendingcb--,Mt(ke),St=St.next}Ce.corkedRequestsFree.next=we}return Object.defineProperty(k.prototype,"destroyed",{enumerable:!1,get:function(){return this._writableState===void 0?!1:this._writableState.destroyed},set:function(Ce){this._writableState&&(this._writableState.destroyed=Ce)}}),k.prototype.destroy=c.destroy,k.prototype._undestroy=c.undestroy,k.prototype._destroy=function(we,Ce){Ce(we)},Jj}var Qj,ooe;function gA(){if(ooe)return Qj;ooe=1;var t=Object.keys||function(l){var u=[];for(var h in l)u.push(h);return u};Qj=a;var e=W1e(),n=q1e();Vk(a,e);for(var i=t(n.prototype),r=0;r<i.length;r++){var s=i[r];a.prototype[s]||(a.prototype[s]=n.prototype[s])}function a(l){if(!(this instanceof a))return new a(l);e.call(this,l),n.call(this,l),this.allowHalfOpen=!0,l&&(l.readable===!1&&(this.readable=!1),l.writable===!1&&(this.writable=!1),l.allowHalfOpen===!1&&(this.allowHalfOpen=!1,this.once("end",o)))}Object.defineProperty(a.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Object.defineProperty(a.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(a.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}});function o(){this._writableState.ended||zn.nextTick(c,this)}function c(l){l.end()}return Object.defineProperty(a.prototype,"destroyed",{enumerable:!1,get:function(){return this._readableState===void 0||this._writableState===void 0?!1:this._readableState.destroyed&&this._writableState.destroyed},set:function(u){this._readableState===void 0||this._writableState===void 0||(this._readableState.destroyed=u,this._writableState.destroyed=u)}}),Qj}var eV={},coe;function loe(){if(coe)return eV;coe=1;var t=I1e.Buffer,e=t.isEncoding||function(v){switch(v=""+v,v&&v.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function n(v){if(!v)return"utf8";for(var b;;)switch(v){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return v;default:if(b)return;v=(""+v).toLowerCase(),b=!0}}function i(v){var b=n(v);if(typeof b!="string"&&(t.isEncoding===e||!e(v)))throw new Error("Unknown encoding: "+v);return b||v}eV.StringDecoder=r;function r(v){this.encoding=i(v);var b;switch(this.encoding){case"utf16le":this.text=h,this.end=f,b=4;break;case"utf8":this.fillLast=c,b=4;break;case"base64":this.text=d,this.end=p,b=3;break;default:this.write=g,this.end=y;return}this.lastNeed=0,this.lastTotal=0,this.lastChar=t.allocUnsafe(b)}r.prototype.write=function(v){if(v.length===0)return"";var b,T;if(this.lastNeed){if(b=this.fillLast(v),b===void 0)return"";T=this.lastNeed,this.lastNeed=0}else T=0;return T<v.length?b?b+this.text(v,T):this.text(v,T):b||""},r.prototype.end=u,r.prototype.text=l,r.prototype.fillLast=function(v){if(this.lastNeed<=v.length)return v.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);v.copy(this.lastChar,this.lastTotal-this.lastNeed,0,v.length),this.lastNeed-=v.length};function s(v){return v<=127?0:v>>5===6?2:v>>4===14?3:v>>3===30?4:v>>6===2?-1:-2}function a(v,b,T){var x=b.length-1;if(x<T)return 0;var M=s(b[x]);return M>=0?(M>0&&(v.lastNeed=M-1),M):--x<T||M===-2?0:(M=s(b[x]),M>=0?(M>0&&(v.lastNeed=M-2),M):--x<T||M===-2?0:(M=s(b[x]),M>=0?(M>0&&(M===2?M=0:v.lastNeed=M-3),M):0))}function o(v,b,T){if((b[0]&192)!==128)return v.lastNeed=0,"�";if(v.lastNeed>1&&b.length>1){if((b[1]&192)!==128)return v.lastNeed=1,"�";if(v.lastNeed>2&&b.length>2&&(b[2]&192)!==128)return v.lastNeed=2,"�"}}function c(v){var b=this.lastTotal-this.lastNeed,T=o(this,v);if(T!==void 0)return T;if(this.lastNeed<=v.length)return v.copy(this.lastChar,b,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);v.copy(this.lastChar,b,0,v.length),this.lastNeed-=v.length}function l(v,b){var T=a(this,v,b);if(!this.lastNeed)return v.toString("utf8",b);this.lastTotal=T;var x=v.length-(T-this.lastNeed);return v.copy(this.lastChar,0,x),v.toString("utf8",b,x)}function u(v){var b=v&&v.length?this.write(v):"";return this.lastNeed?b+"�":b}function h(v,b){if((v.length-b)%2===0){var T=v.toString("utf16le",b);if(T){var x=T.charCodeAt(T.length-1);if(x>=55296&&x<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=v[v.length-2],this.lastChar[1]=v[v.length-1],T.slice(0,-1)}return T}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=v[v.length-1],v.toString("utf16le",b,v.length-1)}function f(v){var b=v&&v.length?this.write(v):"";if(this.lastNeed){var T=this.lastTotal-this.lastNeed;return b+this.lastChar.toString("utf16le",0,T)}return b}function d(v,b){var T=(v.length-b)%3;return T===0?v.toString("base64",b):(this.lastNeed=3-T,this.lastTotal=3,T===1?this.lastChar[0]=v[v.length-1]:(this.lastChar[0]=v[v.length-2],this.lastChar[1]=v[v.length-1]),v.toString("base64",b,v.length-T))}function p(v){var b=v&&v.length?this.write(v):"";return this.lastNeed?b+this.lastChar.toString("base64",0,3-this.lastNeed):b}function g(v){return v.toString(this.encoding)}function y(v){return v&&v.length?this.write(v):""}return eV}var uoe=V1.codes.ERR_STREAM_PREMATURE_CLOSE;function Bxt(t){var e=!1;return function(){if(!e){e=!0;for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];t.apply(this,i)}}}function Fxt(){}function zxt(t){return t.setHeader&&typeof t.abort=="function"}function $1e(t,e,n){if(typeof e=="function")return $1e(t,null,e);e||(e={}),n=Bxt(n||Fxt);var i=e.readable||e.readable!==!1&&t.readable,r=e.writable||e.writable!==!1&&t.writable,s=function(){t.writable||o()},a=t._writableState&&t._writableState.finished,o=function(){r=!1,a=!0,i||n.call(t)},c=t._readableState&&t._readableState.endEmitted,l=function(){i=!1,c=!0,r||n.call(t)},u=function(p){n.call(t,p)},h=function(){var p;if(i&&!c)return(!t._readableState||!t._readableState.ended)&&(p=new uoe),n.call(t,p);if(r&&!a)return(!t._writableState||!t._writableState.ended)&&(p=new uoe),n.call(t,p)},f=function(){t.req.on("finish",o)};return zxt(t)?(t.on("complete",o),t.on("abort",h),t.req?f():t.on("request",f)):r&&!t._writableState&&(t.on("end",s),t.on("close",s)),t.on("end",l),t.on("finish",o),e.error!==!1&&t.on("error",u),t.on("close",h),function(){t.removeListener("complete",o),t.removeListener("abort",h),t.removeListener("request",f),t.req&&t.req.removeListener("finish",o),t.removeListener("end",s),t.removeListener("close",s),t.removeListener("finish",o),t.removeListener("end",l),t.removeListener("error",u),t.removeListener("close",h)}}var aZ=$1e,tV,hoe;function Hxt(){if(hoe)return tV;hoe=1;var t;function e(T,x,M){return x=n(x),x in T?Object.defineProperty(T,x,{value:M,enumerable:!0,configurable:!0,writable:!0}):T[x]=M,T}function n(T){var x=i(T,"string");return typeof x=="symbol"?x:String(x)}function i(T,x){if(typeof T!="object"||T===null)return T;var M=T[Symbol.toPrimitive];if(M!==void 0){var R=M.call(T,x||"default");if(typeof R!="object")return R;throw new TypeError("@@toPrimitive must return a primitive value.")}return(x==="string"?String:Number)(T)}var r=aZ,s=Symbol("lastResolve"),a=Symbol("lastReject"),o=Symbol("error"),c=Symbol("ended"),l=Symbol("lastPromise"),u=Symbol("handlePromise"),h=Symbol("stream");function f(T,x){return{value:T,done:x}}function d(T){var x=T[s];if(x!==null){var M=T[h].read();M!==null&&(T[l]=null,T[s]=null,T[a]=null,x(f(M,!1)))}}function p(T){zn.nextTick(d,T)}function g(T,x){return function(M,R){T.then(function(){if(x[c]){M(f(void 0,!0));return}x[u](M,R)},R)}}var y=Object.getPrototypeOf(function(){}),v=Object.setPrototypeOf((t={get stream(){return this[h]},next:function(){var x=this,M=this[o];if(M!==null)return Promise.reject(M);if(this[c])return Promise.resolve(f(void 0,!0));if(this[h].destroyed)return new Promise(function(P,U){zn.nextTick(function(){x[o]?U(x[o]):P(f(void 0,!0))})});var R=this[l],I;if(R)I=new Promise(g(R,this));else{var k=this[h].read();if(k!==null)return Promise.resolve(f(k,!1));I=new Promise(this[u])}return this[l]=I,I}},e(t,Symbol.asyncIterator,function(){return this}),e(t,"return",function(){var x=this;return new Promise(function(M,R){x[h].destroy(null,function(I){if(I){R(I);return}M(f(void 0,!0))})})}),t),y),b=function(x){var M,R=Object.create(v,(M={},e(M,h,{value:x,writable:!0}),e(M,s,{value:null,writable:!0}),e(M,a,{value:null,writable:!0}),e(M,o,{value:null,writable:!0}),e(M,c,{value:x._readableState.endEmitted,writable:!0}),e(M,u,{value:function(k,P){var U=R[h].read();U?(R[l]=null,R[s]=null,R[a]=null,k(f(U,!1))):(R[s]=k,R[a]=P)},writable:!0}),M));return R[l]=null,r(x,function(I){if(I&&I.code!=="ERR_STREAM_PREMATURE_CLOSE"){var k=R[a];k!==null&&(R[l]=null,R[s]=null,R[a]=null,k(I)),R[o]=I;return}var P=R[s];P!==null&&(R[l]=null,R[s]=null,R[a]=null,P(f(void 0,!0))),R[c]=!0}),x.on("readable",p.bind(null,R)),R};return tV=b,tV}var nV,foe;function jxt(){return foe||(foe=1,nV=function(){throw new Error("Readable.from is not available in the browser")}),nV}var iV,doe;function W1e(){if(doe)return iV;doe=1,iV=P;var t;P.ReadableState=k,jk.EventEmitter;var e=function(_e,tt){return _e.listeners(tt).length},n=H1e,i=Hk.Buffer,r=(typeof jl<"u"?jl:typeof window<"u"?window:typeof self<"u"?self:{}).Uint8Array||function(){};function s(Ee){return i.from(Ee)}function a(Ee){return i.isBuffer(Ee)||Ee instanceof r}var o=n1,c;o&&o.debuglog?c=o.debuglog("stream"):c=function(){};var l=wxt(),u=j1e,h=G1e,f=h.getHighWaterMark,d=V1.codes,p=d.ERR_INVALID_ARG_TYPE,g=d.ERR_STREAM_PUSH_AFTER_EOF,y=d.ERR_METHOD_NOT_IMPLEMENTED,v=d.ERR_STREAM_UNSHIFT_AFTER_END_EVENT,b,T,x;Vk(P,n);var M=u.errorOrDestroy,R=["error","close","destroy","pause","resume"];function I(Ee,_e,tt){if(typeof Ee.prependListener=="function")return Ee.prependListener(_e,tt);!Ee._events||!Ee._events[_e]?Ee.on(_e,tt):Array.isArray(Ee._events[_e])?Ee._events[_e].unshift(tt):Ee._events[_e]=[tt,Ee._events[_e]]}function k(Ee,_e,tt){t=t||gA(),Ee=Ee||{},typeof tt!="boolean"&&(tt=_e instanceof t),this.objectMode=!!Ee.objectMode,tt&&(this.objectMode=this.objectMode||!!Ee.readableObjectMode),this.highWaterMark=f(this,Ee,"readableHighWaterMark",tt),this.buffer=new l,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.paused=!0,this.emitClose=Ee.emitClose!==!1,this.autoDestroy=!!Ee.autoDestroy,this.destroyed=!1,this.defaultEncoding=Ee.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,Ee.encoding&&(b||(b=loe().StringDecoder),this.decoder=new b(Ee.encoding),this.encoding=Ee.encoding)}function P(Ee){if(t=t||gA(),!(this instanceof P))return new P(Ee);var _e=this instanceof t;this._readableState=new k(Ee,this,_e),this.readable=!0,Ee&&(typeof Ee.read=="function"&&(this._read=Ee.read),typeof Ee.destroy=="function"&&(this._destroy=Ee.destroy)),n.call(this)}Object.defineProperty(P.prototype,"destroyed",{enumerable:!1,get:function(){return this._readableState===void 0?!1:this._readableState.destroyed},set:function(_e){this._readableState&&(this._readableState.destroyed=_e)}}),P.prototype.destroy=u.destroy,P.prototype._undestroy=u.undestroy,P.prototype._destroy=function(Ee,_e){_e(Ee)},P.prototype.push=function(Ee,_e){var tt=this._readableState,de;return tt.objectMode?de=!0:typeof Ee=="string"&&(_e=_e||tt.defaultEncoding,_e!==tt.encoding&&(Ee=i.from(Ee,_e),_e=""),de=!0),U(this,Ee,_e,!1,de)},P.prototype.unshift=function(Ee){return U(this,Ee,null,!0,!1)};function U(Ee,_e,tt,de,Be){c("readableAddChunk",_e);var Ie=Ee._readableState;if(_e===null)Ie.reading=!1,V(Ee,Ie);else{var rt;if(Be||(rt=$(Ie,_e)),rt)M(Ee,rt);else if(Ie.objectMode||_e&&_e.length>0)if(typeof _e!="string"&&!Ie.objectMode&&Object.getPrototypeOf(_e)!==i.prototype&&(_e=s(_e)),de)Ie.endEmitted?M(Ee,new v):G(Ee,Ie,_e,!0);else if(Ie.ended)M(Ee,new g);else{if(Ie.destroyed)return!1;Ie.reading=!1,Ie.decoder&&!tt?(_e=Ie.decoder.write(_e),Ie.objectMode||_e.length!==0?G(Ee,Ie,_e,!1):ee(Ee,Ie)):G(Ee,Ie,_e,!1)}else de||(Ie.reading=!1,ee(Ee,Ie))}return!Ie.ended&&(Ie.length<Ie.highWaterMark||Ie.length===0)}function G(Ee,_e,tt,de){_e.flowing&&_e.length===0&&!_e.sync?(_e.awaitDrain=0,Ee.emit("data",tt)):(_e.length+=_e.objectMode?1:tt.length,de?_e.buffer.unshift(tt):_e.buffer.push(tt),_e.needReadable&&J(Ee)),ee(Ee,_e)}function $(Ee,_e){var tt;return!a(_e)&&typeof _e!="string"&&_e!==void 0&&!Ee.objectMode&&(tt=new p("chunk",["string","Buffer","Uint8Array"],_e)),tt}P.prototype.isPaused=function(){return this._readableState.flowing===!1},P.prototype.setEncoding=function(Ee){b||(b=loe().StringDecoder);var _e=new b(Ee);this._readableState.decoder=_e,this._readableState.encoding=this._readableState.decoder.encoding;for(var tt=this._readableState.buffer.head,de="";tt!==null;)de+=_e.write(tt.data),tt=tt.next;return this._readableState.buffer.clear(),de!==""&&this._readableState.buffer.push(de),this._readableState.length=de.length,this};var q=1073741824;function Y(Ee){return Ee>=q?Ee=q:(Ee--,Ee|=Ee>>>1,Ee|=Ee>>>2,Ee|=Ee>>>4,Ee|=Ee>>>8,Ee|=Ee>>>16,Ee++),Ee}function ie(Ee,_e){return Ee<=0||_e.length===0&&_e.ended?0:_e.objectMode?1:Ee!==Ee?_e.flowing&&_e.length?_e.buffer.head.data.length:_e.length:(Ee>_e.highWaterMark&&(_e.highWaterMark=Y(Ee)),Ee<=_e.length?Ee:_e.ended?_e.length:(_e.needReadable=!0,0))}P.prototype.read=function(Ee){c("read",Ee),Ee=parseInt(Ee,10);var _e=this._readableState,tt=Ee;if(Ee!==0&&(_e.emittedReadable=!1),Ee===0&&_e.needReadable&&((_e.highWaterMark!==0?_e.length>=_e.highWaterMark:_e.length>0)||_e.ended))return c("read: emitReadable",_e.length,_e.ended),_e.length===0&&_e.ended?ke(this):J(this),null;if(Ee=ie(Ee,_e),Ee===0&&_e.ended)return _e.length===0&&ke(this),null;var de=_e.needReadable;c("need readable",de),(_e.length===0||_e.length-Ee<_e.highWaterMark)&&(de=!0,c("length less than watermark",de)),_e.ended||_e.reading?(de=!1,c("reading or ended",de)):de&&(c("do read"),_e.reading=!0,_e.sync=!0,_e.length===0&&(_e.needReadable=!0),this._read(_e.highWaterMark),_e.sync=!1,_e.reading||(Ee=ie(tt,_e)));var Be;return Ee>0?Be=Ce(Ee,_e):Be=null,Be===null?(_e.needReadable=_e.length<=_e.highWaterMark,Ee=0):(_e.length-=Ee,_e.awaitDrain=0),_e.length===0&&(_e.ended||(_e.needReadable=!0),tt!==Ee&&_e.ended&&ke(this)),Be!==null&&this.emit("data",Be),Be};function V(Ee,_e){if(c("onEofChunk"),!_e.ended){if(_e.decoder){var tt=_e.decoder.end();tt&&tt.length&&(_e.buffer.push(tt),_e.length+=_e.objectMode?1:tt.length)}_e.ended=!0,_e.sync?J(Ee):(_e.needReadable=!1,_e.emittedReadable||(_e.emittedReadable=!0,X(Ee)))}}function J(Ee){var _e=Ee._readableState;c("emitReadable",_e.needReadable,_e.emittedReadable),_e.needReadable=!1,_e.emittedReadable||(c("emitReadable",_e.flowing),_e.emittedReadable=!0,zn.nextTick(X,Ee))}function X(Ee){var _e=Ee._readableState;c("emitReadable_",_e.destroyed,_e.length,_e.ended),!_e.destroyed&&(_e.length||_e.ended)&&(Ee.emit("readable"),_e.emittedReadable=!1),_e.needReadable=!_e.flowing&&!_e.ended&&_e.length<=_e.highWaterMark,we(Ee)}function ee(Ee,_e){_e.readingMore||(_e.readingMore=!0,zn.nextTick(oe,Ee,_e))}function oe(Ee,_e){for(;!_e.reading&&!_e.ended&&(_e.length<_e.highWaterMark||_e.flowing&&_e.length===0);){var tt=_e.length;if(c("maybeReadMore read 0"),Ee.read(0),tt===_e.length)break}_e.readingMore=!1}P.prototype._read=function(Ee){M(this,new y("_read()"))},P.prototype.pipe=function(Ee,_e){var tt=this,de=this._readableState;switch(de.pipesCount){case 0:de.pipes=Ee;break;case 1:de.pipes=[de.pipes,Ee];break;default:de.pipes.push(Ee);break}de.pipesCount+=1,c("pipe count=%d opts=%j",de.pipesCount,_e);var Be=(!_e||_e.end!==!1)&&Ee!==zn.stdout&&Ee!==zn.stderr,Ie=Be?ft:Ue;de.endEmitted?zn.nextTick(Ie):tt.once("end",Ie),Ee.on("unpipe",rt);function rt(qt,Ot){c("onunpipe"),qt===tt&&Ot&&Ot.hasUnpiped===!1&&(Ot.hasUnpiped=!0,be())}function ft(){c("onend"),Ee.end()}var gt=fe(tt);Ee.on("drain",gt);var bt=!1;function be(){c("cleanup"),Ee.removeListener("close",it),Ee.removeListener("finish",$e),Ee.removeListener("drain",gt),Ee.removeListener("error",Xe),Ee.removeListener("unpipe",rt),tt.removeListener("end",ft),tt.removeListener("end",Ue),tt.removeListener("data",ue),bt=!0,de.awaitDrain&&(!Ee._writableState||Ee._writableState.needDrain)&&gt()}tt.on("data",ue);function ue(qt){c("ondata");var Ot=Ee.write(qt);c("dest.write",Ot),Ot===!1&&((de.pipesCount===1&&de.pipes===Ee||de.pipesCount>1&&Mt(de.pipes,Ee)!==-1)&&!bt&&(c("false write response, pause",de.awaitDrain),de.awaitDrain++),tt.pause())}function Xe(qt){c("onerror",qt),Ue(),Ee.removeListener("error",Xe),e(Ee,"error")===0&&M(Ee,qt)}I(Ee,"error",Xe);function it(){Ee.removeListener("finish",$e),Ue()}Ee.once("close",it);function $e(){c("onfinish"),Ee.removeListener("close",it),Ue()}Ee.once("finish",$e);function Ue(){c("unpipe"),tt.unpipe(Ee)}return Ee.emit("pipe",tt),de.flowing||(c("pipe resume"),tt.resume()),Ee};function fe(Ee){return function(){var tt=Ee._readableState;c("pipeOnDrain",tt.awaitDrain),tt.awaitDrain&&tt.awaitDrain--,tt.awaitDrain===0&&e(Ee,"data")&&(tt.flowing=!0,we(Ee))}}P.prototype.unpipe=function(Ee){var _e=this._readableState,tt={hasUnpiped:!1};if(_e.pipesCount===0)return this;if(_e.pipesCount===1)return Ee&&Ee!==_e.pipes?this:(Ee||(Ee=_e.pipes),_e.pipes=null,_e.pipesCount=0,_e.flowing=!1,Ee&&Ee.emit("unpipe",this,tt),this);if(!Ee){var de=_e.pipes,Be=_e.pipesCount;_e.pipes=null,_e.pipesCount=0,_e.flowing=!1;for(var Ie=0;Ie<Be;Ie++)de[Ie].emit("unpipe",this,{hasUnpiped:!1});return this}var rt=Mt(_e.pipes,Ee);return rt===-1?this:(_e.pipes.splice(rt,1),_e.pipesCount-=1,_e.pipesCount===1&&(_e.pipes=_e.pipes[0]),Ee.emit("unpipe",this,tt),this)},P.prototype.on=function(Ee,_e){var tt=n.prototype.on.call(this,Ee,_e),de=this._readableState;return Ee==="data"?(de.readableListening=this.listenerCount("readable")>0,de.flowing!==!1&&this.resume()):Ee==="readable"&&!de.endEmitted&&!de.readableListening&&(de.readableListening=de.needReadable=!0,de.flowing=!1,de.emittedReadable=!1,c("on readable",de.length,de.reading),de.length?J(this):de.reading||zn.nextTick(He,this)),tt},P.prototype.addListener=P.prototype.on,P.prototype.removeListener=function(Ee,_e){var tt=n.prototype.removeListener.call(this,Ee,_e);return Ee==="readable"&&zn.nextTick(Re,this),tt},P.prototype.removeAllListeners=function(Ee){var _e=n.prototype.removeAllListeners.apply(this,arguments);return(Ee==="readable"||Ee===void 0)&&zn.nextTick(Re,this),_e};function Re(Ee){var _e=Ee._readableState;_e.readableListening=Ee.listenerCount("readable")>0,_e.resumeScheduled&&!_e.paused?_e.flowing=!0:Ee.listenerCount("data")>0&&Ee.resume()}function He(Ee){c("readable nexttick read 0"),Ee.read(0)}P.prototype.resume=function(){var Ee=this._readableState;return Ee.flowing||(c("resume"),Ee.flowing=!Ee.readableListening,Te(this,Ee)),Ee.paused=!1,this};function Te(Ee,_e){_e.resumeScheduled||(_e.resumeScheduled=!0,zn.nextTick(Le,Ee,_e))}function Le(Ee,_e){c("resume",_e.reading),_e.reading||Ee.read(0),_e.resumeScheduled=!1,Ee.emit("resume"),we(Ee),_e.flowing&&!_e.reading&&Ee.read(0)}P.prototype.pause=function(){return c("call pause flowing=%j",this._readableState.flowing),this._readableState.flowing!==!1&&(c("pause"),this._readableState.flowing=!1,this.emit("pause")),this._readableState.paused=!0,this};function we(Ee){var _e=Ee._readableState;for(c("flow",_e.flowing);_e.flowing&&Ee.read()!==null;);}P.prototype.wrap=function(Ee){var _e=this,tt=this._readableState,de=!1;Ee.on("end",function(){if(c("wrapped end"),tt.decoder&&!tt.ended){var rt=tt.decoder.end();rt&&rt.length&&_e.push(rt)}_e.push(null)}),Ee.on("data",function(rt){if(c("wrapped data"),tt.decoder&&(rt=tt.decoder.write(rt)),!(tt.objectMode&&rt==null)&&!(!tt.objectMode&&(!rt||!rt.length))){var ft=_e.push(rt);ft||(de=!0,Ee.pause())}});for(var Be in Ee)this[Be]===void 0&&typeof Ee[Be]=="function"&&(this[Be]=function(ft){return function(){return Ee[ft].apply(Ee,arguments)}}(Be));for(var Ie=0;Ie<R.length;Ie++)Ee.on(R[Ie],this.emit.bind(this,R[Ie]));return this._read=function(rt){c("wrapped _read",rt),de&&(de=!1,Ee.resume())},this},typeof Symbol=="function"&&(P.prototype[Symbol.asyncIterator]=function(){return T===void 0&&(T=Hxt()),T(this)}),Object.defineProperty(P.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),Object.defineProperty(P.prototype,"readableBuffer",{enumerable:!1,get:function(){return this._readableState&&this._readableState.buffer}}),Object.defineProperty(P.prototype,"readableFlowing",{enumerable:!1,get:function(){return this._readableState.flowing},set:function(_e){this._readableState&&(this._readableState.flowing=_e)}}),P._fromList=Ce,Object.defineProperty(P.prototype,"readableLength",{enumerable:!1,get:function(){return this._readableState.length}});function Ce(Ee,_e){if(_e.length===0)return null;var tt;return _e.objectMode?tt=_e.buffer.shift():!Ee||Ee>=_e.length?(_e.decoder?tt=_e.buffer.join(""):_e.buffer.length===1?tt=_e.buffer.first():tt=_e.buffer.concat(_e.length),_e.buffer.clear()):tt=_e.buffer.consume(Ee,_e.decoder),tt}function ke(Ee){var _e=Ee._readableState;c("endReadable",_e.endEmitted),_e.endEmitted||(_e.ended=!0,zn.nextTick(St,_e,Ee))}function St(Ee,_e){if(c("endReadableNT",Ee.endEmitted,Ee.length),!Ee.endEmitted&&Ee.length===0&&(Ee.endEmitted=!0,_e.readable=!1,_e.emit("end"),Ee.autoDestroy)){var tt=_e._writableState;(!tt||tt.autoDestroy&&tt.finished)&&_e.destroy()}}typeof Symbol=="function"&&(P.from=function(Ee,_e){return x===void 0&&(x=jxt()),x(P,Ee,_e)});function Mt(Ee,_e){for(var tt=0,de=Ee.length;tt<de;tt++)if(Ee[tt]===_e)return tt;return-1}return iV}var Y1e=O_,A8=V1.codes,Vxt=A8.ERR_METHOD_NOT_IMPLEMENTED,Gxt=A8.ERR_MULTIPLE_CALLBACK,qxt=A8.ERR_TRANSFORM_ALREADY_TRANSFORMING,$xt=A8.ERR_TRANSFORM_WITH_LENGTH_0,R8=gA();Vk(O_,R8);function Wxt(t,e){var n=this._transformState;n.transforming=!1;var i=n.writecb;if(i===null)return this.emit("error",new Gxt);n.writechunk=null,n.writecb=null,e!=null&&this.push(e),i(t);var r=this._readableState;r.reading=!1,(r.needReadable||r.length<r.highWaterMark)&&this._read(r.highWaterMark)}function O_(t){if(!(this instanceof O_))return new O_(t);R8.call(this,t),this._transformState={afterTransform:Wxt.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,t&&(typeof t.transform=="function"&&(this._transform=t.transform),typeof t.flush=="function"&&(this._flush=t.flush)),this.on("prefinish",Yxt)}function Yxt(){var t=this;typeof this._flush=="function"&&!this._readableState.destroyed?this._flush(function(e,n){poe(t,e,n)}):poe(this,null,null)}O_.prototype.push=function(t,e){return this._transformState.needTransform=!1,R8.prototype.push.call(this,t,e)};O_.prototype._transform=function(t,e,n){n(new Vxt("_transform()"))};O_.prototype._write=function(t,e,n){var i=this._transformState;if(i.writecb=n,i.writechunk=t,i.writeencoding=e,!i.transforming){var r=this._readableState;(i.needTransform||r.needReadable||r.length<r.highWaterMark)&&this._read(r.highWaterMark)}};O_.prototype._read=function(t){var e=this._transformState;e.writechunk!==null&&!e.transforming?(e.transforming=!0,this._transform(e.writechunk,e.writeencoding,e.afterTransform)):e.needTransform=!0};O_.prototype._destroy=function(t,e){R8.prototype._destroy.call(this,t,function(n){e(n)})};function poe(t,e,n){if(e)return t.emit("error",e);if(n!=null&&t.push(n),t._writableState.length)throw new $xt;if(t._transformState.transforming)throw new qxt;return t.push(null)}var Xxt=ZN,X1e=Y1e;Vk(ZN,X1e);function ZN(t){if(!(this instanceof ZN))return new ZN(t);X1e.call(this,t)}ZN.prototype._transform=function(t,e,n){n(null,t)};var rV;function Kxt(t){var e=!1;return function(){e||(e=!0,t.apply(void 0,arguments))}}var K1e=V1.codes,Zxt=K1e.ERR_MISSING_ARGS,Jxt=K1e.ERR_STREAM_DESTROYED;function moe(t){if(t)throw t}function Qxt(t){return t.setHeader&&typeof t.abort=="function"}function ewt(t,e,n,i){i=Kxt(i);var r=!1;t.on("close",function(){r=!0}),rV===void 0&&(rV=aZ),rV(t,{readable:e,writable:n},function(a){if(a)return i(a);r=!0,i()});var s=!1;return function(a){if(!r&&!s){if(s=!0,Qxt(t))return t.abort();if(typeof t.destroy=="function")return t.destroy();i(a||new Jxt("pipe"))}}}function goe(t){t()}function twt(t,e){return t.pipe(e)}function nwt(t){return!t.length||typeof t[t.length-1]!="function"?moe:t.pop()}function iwt(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];var i=nwt(e);if(Array.isArray(e[0])&&(e=e[0]),e.length<2)throw new Zxt("streams");var r,s=e.map(function(a,o){var c=o<e.length-1,l=o>0;return ewt(a,c,l,function(u){r||(r=u),u&&s.forEach(goe),!c&&(s.forEach(goe),i(r))})});return e.reduce(twt)}var rwt=iwt;(function(t,e){e=t.exports=W1e(),e.Stream=e,e.Readable=e,e.Writable=q1e(),e.Duplex=gA(),e.Transform=Y1e,e.PassThrough=Xxt,e.finished=aZ,e.pipeline=rwt})(q$,q$.exports);var Z1e=q$.exports;/*! queue-microtask. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> */let voe;var J1e=typeof queueMicrotask=="function"?queueMicrotask.bind(typeof window<"u"?window:jl):t=>(voe||(voe=Promise.resolve())).then(t).catch(e=>setTimeout(()=>{throw e},0));function _oe(t,e){for(const n in e)Object.defineProperty(t,n,{value:e[n],enumerable:!0,configurable:!0});return t}function swt(t,e,n){if(!t||typeof t=="string")throw new TypeError("Please pass an Error to err-code");n||(n={}),typeof e=="object"&&(n=e,e=""),e&&(n.code=e);try{return _oe(t,n)}catch{n.message=t.message,n.stack=t.stack;const r=function(){};return r.prototype=Object.create(Object.getPrototypeOf(t)),_oe(new r,n)}}var awt=swt;/*! simple-peer. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> */const owt=x8("simple-peer"),Q1e=pxt,yoe=w8,cwt=Z1e,sV=J1e,Dr=awt,{Buffer:lwt}=Hk,aV=64*1024,uwt=5*1e3,hwt=5*1e3;function boe(t){return t.replace(/a=ice-options:trickle\s\n/g,"")}function fwt(t){console.warn(t)}let M8=class Y$ extends cwt.Duplex{constructor(e){if(e=Object.assign({allowHalfOpen:!1},e),super(e),this._id=yoe(4).toString("hex").slice(0,7),this._debug("new peer %o",e),this.channelName=e.initiator?e.channelName||yoe(20).toString("hex"):null,this.initiator=e.initiator||!1,this.channelConfig=e.channelConfig||Y$.channelConfig,this.channelNegotiated=this.channelConfig.negotiated,this.config=Object.assign({},Y$.config,e.config),this.offerOptions=e.offerOptions||{},this.answerOptions=e.answerOptions||{},this.sdpTransform=e.sdpTransform||(n=>n),this.streams=e.streams||(e.stream?[e.stream]:[]),this.trickle=e.trickle!==void 0?e.trickle:!0,this.allowHalfTrickle=e.allowHalfTrickle!==void 0?e.allowHalfTrickle:!1,this.iceCompleteTimeout=e.iceCompleteTimeout||uwt,this.destroyed=!1,this.destroying=!1,this._connected=!1,this.remoteAddress=void 0,this.remoteFamily=void 0,this.remotePort=void 0,this.localAddress=void 0,this.localFamily=void 0,this.localPort=void 0,this._wrtc=e.wrtc&&typeof e.wrtc=="object"?e.wrtc:Q1e(),!this._wrtc)throw Dr(typeof window>"u"?new Error("No WebRTC support: Specify `opts.wrtc` option in this environment"):new Error("No WebRTC support: Not a supported browser"),"ERR_WEBRTC_SUPPORT");this._pcReady=!1,this._channelReady=!1,this._iceComplete=!1,this._iceCompleteTimer=null,this._channel=null,this._pendingCandidates=[],this._isNegotiating=!1,this._firstNegotiation=!0,this._batchedNegotiation=!1,this._queuedNegotiation=!1,this._sendersAwaitingStable=[],this._senderMap=new Map,this._closingInterval=null,this._remoteTracks=[],this._remoteStreams=[],this._chunk=null,this._cb=null,this._interval=null;try{this._pc=new this._wrtc.RTCPeerConnection(this.config)}catch(n){this.destroy(Dr(n,"ERR_PC_CONSTRUCTOR"));return}this._isReactNativeWebrtc=typeof this._pc._peerConnectionId=="number",this._pc.oniceconnectionstatechange=()=>{this._onIceStateChange()},this._pc.onicegatheringstatechange=()=>{this._onIceStateChange()},this._pc.onconnectionstatechange=()=>{this._onConnectionStateChange()},this._pc.onsignalingstatechange=()=>{this._onSignalingStateChange()},this._pc.onicecandidate=n=>{this._onIceCandidate(n)},typeof this._pc.peerIdentity=="object"&&this._pc.peerIdentity.catch(n=>{this.destroy(Dr(n,"ERR_PC_PEER_IDENTITY"))}),this.initiator||this.channelNegotiated?this._setupData({channel:this._pc.createDataChannel(this.channelName,this.channelConfig)}):this._pc.ondatachannel=n=>{this._setupData(n)},this.streams&&this.streams.forEach(n=>{this.addStream(n)}),this._pc.ontrack=n=>{this._onTrack(n)},this._debug("initial negotiation"),this._needsNegotiation(),this._onFinishBound=()=>{this._onFinish()},this.once("finish",this._onFinishBound)}get bufferSize(){return this._channel&&this._channel.bufferedAmount||0}get connected(){return this._connected&&this._channel.readyState==="open"}address(){return{port:this.localPort,family:this.localFamily,address:this.localAddress}}signal(e){if(!this.destroying){if(this.destroyed)throw Dr(new Error("cannot signal after peer is destroyed"),"ERR_DESTROYED");if(typeof e=="string")try{e=JSON.parse(e)}catch{e={}}this._debug("signal()"),e.renegotiate&&this.initiator&&(this._debug("got request to renegotiate"),this._needsNegotiation()),e.transceiverRequest&&this.initiator&&(this._debug("got request for transceiver"),this.addTransceiver(e.transceiverRequest.kind,e.transceiverRequest.init)),e.candidate&&(this._pc.remoteDescription&&this._pc.remoteDescription.type?this._addIceCandidate(e.candidate):this._pendingCandidates.push(e.candidate)),e.sdp&&this._pc.setRemoteDescription(new this._wrtc.RTCSessionDescription(e)).then(()=>{this.destroyed||(this._pendingCandidates.forEach(n=>{this._addIceCandidate(n)}),this._pendingCandidates=[],this._pc.remoteDescription.type==="offer"&&this._createAnswer())}).catch(n=>{this.destroy(Dr(n,"ERR_SET_REMOTE_DESCRIPTION"))}),!e.sdp&&!e.candidate&&!e.renegotiate&&!e.transceiverRequest&&this.destroy(Dr(new Error("signal() called with invalid signal data"),"ERR_SIGNALING"))}}_addIceCandidate(e){const n=new this._wrtc.RTCIceCandidate(e);this._pc.addIceCandidate(n).catch(i=>{!n.address||n.address.endsWith(".local")?fwt("Ignoring unsupported ICE candidate."):this.destroy(Dr(i,"ERR_ADD_ICE_CANDIDATE"))})}send(e){if(!this.destroying){if(this.destroyed)throw Dr(new Error("cannot send after peer is destroyed"),"ERR_DESTROYED");this._channel.send(e)}}addTransceiver(e,n){if(!this.destroying){if(this.destroyed)throw Dr(new Error("cannot addTransceiver after peer is destroyed"),"ERR_DESTROYED");if(this._debug("addTransceiver()"),this.initiator)try{this._pc.addTransceiver(e,n),this._needsNegotiation()}catch(i){this.destroy(Dr(i,"ERR_ADD_TRANSCEIVER"))}else this.emit("signal",{type:"transceiverRequest",transceiverRequest:{kind:e,init:n}})}}addStream(e){if(!this.destroying){if(this.destroyed)throw Dr(new Error("cannot addStream after peer is destroyed"),"ERR_DESTROYED");this._debug("addStream()"),e.getTracks().forEach(n=>{this.addTrack(n,e)})}}addTrack(e,n){if(this.destroying)return;if(this.destroyed)throw Dr(new Error("cannot addTrack after peer is destroyed"),"ERR_DESTROYED");this._debug("addTrack()");const i=this._senderMap.get(e)||new Map;let r=i.get(n);if(!r)r=this._pc.addTrack(e,n),i.set(n,r),this._senderMap.set(e,i),this._needsNegotiation();else throw r.removed?Dr(new Error("Track has been removed. You should enable/disable tracks that you want to re-add."),"ERR_SENDER_REMOVED"):Dr(new Error("Track has already been added to that stream."),"ERR_SENDER_ALREADY_ADDED")}replaceTrack(e,n,i){if(this.destroying)return;if(this.destroyed)throw Dr(new Error("cannot replaceTrack after peer is destroyed"),"ERR_DESTROYED");this._debug("replaceTrack()");const r=this._senderMap.get(e),s=r?r.get(i):null;if(!s)throw Dr(new Error("Cannot replace track that was never added."),"ERR_TRACK_NOT_ADDED");n&&this._senderMap.set(n,r),s.replaceTrack!=null?s.replaceTrack(n):this.destroy(Dr(new Error("replaceTrack is not supported in this browser"),"ERR_UNSUPPORTED_REPLACETRACK"))}removeTrack(e,n){if(this.destroying)return;if(this.destroyed)throw Dr(new Error("cannot removeTrack after peer is destroyed"),"ERR_DESTROYED");this._debug("removeSender()");const i=this._senderMap.get(e),r=i?i.get(n):null;if(!r)throw Dr(new Error("Cannot remove track that was never added."),"ERR_TRACK_NOT_ADDED");try{r.removed=!0,this._pc.removeTrack(r)}catch(s){s.name==="NS_ERROR_UNEXPECTED"?this._sendersAwaitingStable.push(r):this.destroy(Dr(s,"ERR_REMOVE_TRACK"))}this._needsNegotiation()}removeStream(e){if(!this.destroying){if(this.destroyed)throw Dr(new Error("cannot removeStream after peer is destroyed"),"ERR_DESTROYED");this._debug("removeSenders()"),e.getTracks().forEach(n=>{this.removeTrack(n,e)})}}_needsNegotiation(){this._debug("_needsNegotiation"),!this._batchedNegotiation&&(this._batchedNegotiation=!0,sV(()=>{this._batchedNegotiation=!1,this.initiator||!this._firstNegotiation?(this._debug("starting batched negotiation"),this.negotiate()):this._debug("non-initiator initial negotiation request discarded"),this._firstNegotiation=!1}))}negotiate(){if(!this.destroying){if(this.destroyed)throw Dr(new Error("cannot negotiate after peer is destroyed"),"ERR_DESTROYED");this.initiator?this._isNegotiating?(this._queuedNegotiation=!0,this._debug("already negotiating, queueing")):(this._debug("start negotiation"),setTimeout(()=>{this._createOffer()},0)):this._isNegotiating?(this._queuedNegotiation=!0,this._debug("already negotiating, queueing")):(this._debug("requesting negotiation from initiator"),this.emit("signal",{type:"renegotiate",renegotiate:!0})),this._isNegotiating=!0}}destroy(e){this._destroy(e,()=>{})}_destroy(e,n){this.destroyed||this.destroying||(this.destroying=!0,this._debug("destroying (error: %s)",e&&(e.message||e)),sV(()=>{if(this.destroyed=!0,this.destroying=!1,this._debug("destroy (error: %s)",e&&(e.message||e)),this.readable=this.writable=!1,this._readableState.ended||this.push(null),this._writableState.finished||this.end(),this._connected=!1,this._pcReady=!1,this._channelReady=!1,this._remoteTracks=null,this._remoteStreams=null,this._senderMap=null,clearInterval(this._closingInterval),this._closingInterval=null,clearInterval(this._interval),this._interval=null,this._chunk=null,this._cb=null,this._onFinishBound&&this.removeListener("finish",this._onFinishBound),this._onFinishBound=null,this._channel){try{this._channel.close()}catch{}this._channel.onmessage=null,this._channel.onopen=null,this._channel.onclose=null,this._channel.onerror=null}if(this._pc){try{this._pc.close()}catch{}this._pc.oniceconnectionstatechange=null,this._pc.onicegatheringstatechange=null,this._pc.onsignalingstatechange=null,this._pc.onicecandidate=null,this._pc.ontrack=null,this._pc.ondatachannel=null}this._pc=null,this._channel=null,e&&this.emit("error",e),this.emit("close"),n()}))}_setupData(e){if(!e.channel)return this.destroy(Dr(new Error("Data channel event is missing `channel` property"),"ERR_DATA_CHANNEL"));this._channel=e.channel,this._channel.binaryType="arraybuffer",typeof this._channel.bufferedAmountLowThreshold=="number"&&(this._channel.bufferedAmountLowThreshold=aV),this.channelName=this._channel.label,this._channel.onmessage=i=>{this._onChannelMessage(i)},this._channel.onbufferedamountlow=()=>{this._onChannelBufferedAmountLow()},this._channel.onopen=()=>{this._onChannelOpen()},this._channel.onclose=()=>{this._onChannelClose()},this._channel.onerror=i=>{const r=i.error instanceof Error?i.error:new Error(`Datachannel error: ${i.message} ${i.filename}:${i.lineno}:${i.colno}`);this.destroy(Dr(r,"ERR_DATA_CHANNEL"))};let n=!1;this._closingInterval=setInterval(()=>{this._channel&&this._channel.readyState==="closing"?(n&&this._onChannelClose(),n=!0):n=!1},hwt)}_read(){}_write(e,n,i){if(this.destroyed)return i(Dr(new Error("cannot write after peer is destroyed"),"ERR_DATA_CHANNEL"));if(this._connected){try{this.send(e)}catch(r){return this.destroy(Dr(r,"ERR_DATA_CHANNEL"))}this._channel.bufferedAmount>aV?(this._debug("start backpressure: bufferedAmount %d",this._channel.bufferedAmount),this._cb=i):i(null)}else this._debug("write before connect"),this._chunk=e,this._cb=i}_onFinish(){if(this.destroyed)return;const e=()=>{setTimeout(()=>this.destroy(),1e3)};this._connected?e():this.once("connect",e)}_startIceCompleteTimeout(){this.destroyed||this._iceCompleteTimer||(this._debug("started iceComplete timeout"),this._iceCompleteTimer=setTimeout(()=>{this._iceComplete||(this._iceComplete=!0,this._debug("iceComplete timeout completed"),this.emit("iceTimeout"),this.emit("_iceComplete"))},this.iceCompleteTimeout))}_createOffer(){this.destroyed||this._pc.createOffer(this.offerOptions).then(e=>{if(this.destroyed)return;!this.trickle&&!this.allowHalfTrickle&&(e.sdp=boe(e.sdp)),e.sdp=this.sdpTransform(e.sdp);const n=()=>{if(this.destroyed)return;const s=this._pc.localDescription||e;this._debug("signal"),this.emit("signal",{type:s.type,sdp:s.sdp})},i=()=>{this._debug("createOffer success"),!this.destroyed&&(this.trickle||this._iceComplete?n():this.once("_iceComplete",n))},r=s=>{this.destroy(Dr(s,"ERR_SET_LOCAL_DESCRIPTION"))};this._pc.setLocalDescription(e).then(i).catch(r)}).catch(e=>{this.destroy(Dr(e,"ERR_CREATE_OFFER"))})}_requestMissingTransceivers(){this._pc.getTransceivers&&this._pc.getTransceivers().forEach(e=>{!e.mid&&e.sender.track&&!e.requested&&(e.requested=!0,this.addTransceiver(e.sender.track.kind))})}_createAnswer(){this.destroyed||this._pc.createAnswer(this.answerOptions).then(e=>{if(this.destroyed)return;!this.trickle&&!this.allowHalfTrickle&&(e.sdp=boe(e.sdp)),e.sdp=this.sdpTransform(e.sdp);const n=()=>{if(this.destroyed)return;const s=this._pc.localDescription||e;this._debug("signal"),this.emit("signal",{type:s.type,sdp:s.sdp}),this.initiator||this._requestMissingTransceivers()},i=()=>{this.destroyed||(this.trickle||this._iceComplete?n():this.once("_iceComplete",n))},r=s=>{this.destroy(Dr(s,"ERR_SET_LOCAL_DESCRIPTION"))};this._pc.setLocalDescription(e).then(i).catch(r)}).catch(e=>{this.destroy(Dr(e,"ERR_CREATE_ANSWER"))})}_onConnectionStateChange(){this.destroyed||this._pc.connectionState==="failed"&&this.destroy(Dr(new Error("Connection failed."),"ERR_CONNECTION_FAILURE"))}_onIceStateChange(){if(this.destroyed)return;const e=this._pc.iceConnectionState,n=this._pc.iceGatheringState;this._debug("iceStateChange (connection: %s) (gathering: %s)",e,n),this.emit("iceStateChange",e,n),(e==="connected"||e==="completed")&&(this._pcReady=!0,this._maybeReady()),e==="failed"&&this.destroy(Dr(new Error("Ice connection failed."),"ERR_ICE_CONNECTION_FAILURE")),e==="closed"&&this.destroy(Dr(new Error("Ice connection closed."),"ERR_ICE_CONNECTION_CLOSED"))}getStats(e){const n=i=>(Object.prototype.toString.call(i.values)==="[object Array]"&&i.values.forEach(r=>{Object.assign(i,r)}),i);this._pc.getStats.length===0||this._isReactNativeWebrtc?this._pc.getStats().then(i=>{const r=[];i.forEach(s=>{r.push(n(s))}),e(null,r)},i=>e(i)):this._pc.getStats.length>0?this._pc.getStats(i=>{if(this.destroyed)return;const r=[];i.result().forEach(s=>{const a={};s.names().forEach(o=>{a[o]=s.stat(o)}),a.id=s.id,a.type=s.type,a.timestamp=s.timestamp,r.push(n(a))}),e(null,r)},i=>e(i)):e(null,[])}_maybeReady(){if(this._debug("maybeReady pc %s channel %s",this._pcReady,this._channelReady),this._connected||this._connecting||!this._pcReady||!this._channelReady)return;this._connecting=!0;const e=()=>{this.destroyed||this.getStats((n,i)=>{if(this.destroyed)return;n&&(i=[]);const r={},s={},a={};let o=!1;i.forEach(l=>{(l.type==="remotecandidate"||l.type==="remote-candidate")&&(r[l.id]=l),(l.type==="localcandidate"||l.type==="local-candidate")&&(s[l.id]=l),(l.type==="candidatepair"||l.type==="candidate-pair")&&(a[l.id]=l)});const c=l=>{o=!0;let u=s[l.localCandidateId];u&&(u.ip||u.address)?(this.localAddress=u.ip||u.address,this.localPort=Number(u.port)):u&&u.ipAddress?(this.localAddress=u.ipAddress,this.localPort=Number(u.portNumber)):typeof l.googLocalAddress=="string"&&(u=l.googLocalAddress.split(":"),this.localAddress=u[0],this.localPort=Number(u[1])),this.localAddress&&(this.localFamily=this.localAddress.includes(":")?"IPv6":"IPv4");let h=r[l.remoteCandidateId];h&&(h.ip||h.address)?(this.remoteAddress=h.ip||h.address,this.remotePort=Number(h.port)):h&&h.ipAddress?(this.remoteAddress=h.ipAddress,this.remotePort=Number(h.portNumber)):typeof l.googRemoteAddress=="string"&&(h=l.googRemoteAddress.split(":"),this.remoteAddress=h[0],this.remotePort=Number(h[1])),this.remoteAddress&&(this.remoteFamily=this.remoteAddress.includes(":")?"IPv6":"IPv4"),this._debug("connect local: %s:%s remote: %s:%s",this.localAddress,this.localPort,this.remoteAddress,this.remotePort)};if(i.forEach(l=>{l.type==="transport"&&l.selectedCandidatePairId&&c(a[l.selectedCandidatePairId]),(l.type==="googCandidatePair"&&l.googActiveConnection==="true"||(l.type==="candidatepair"||l.type==="candidate-pair")&&l.selected)&&c(l)}),!o&&(!Object.keys(a).length||Object.keys(s).length)){setTimeout(e,100);return}else this._connecting=!1,this._connected=!0;if(this._chunk){try{this.send(this._chunk)}catch(u){return this.destroy(Dr(u,"ERR_DATA_CHANNEL"))}this._chunk=null,this._debug('sent chunk from "write before connect"');const l=this._cb;this._cb=null,l(null)}typeof this._channel.bufferedAmountLowThreshold!="number"&&(this._interval=setInterval(()=>this._onInterval(),150),this._interval.unref&&this._interval.unref()),this._debug("connect"),this.emit("connect")})};e()}_onInterval(){!this._cb||!this._channel||this._channel.bufferedAmount>aV||this._onChannelBufferedAmountLow()}_onSignalingStateChange(){this.destroyed||(this._pc.signalingState==="stable"&&(this._isNegotiating=!1,this._debug("flushing sender queue",this._sendersAwaitingStable),this._sendersAwaitingStable.forEach(e=>{this._pc.removeTrack(e),this._queuedNegotiation=!0}),this._sendersAwaitingStable=[],this._queuedNegotiation?(this._debug("flushing negotiation queue"),this._queuedNegotiation=!1,this._needsNegotiation()):(this._debug("negotiated"),this.emit("negotiated"))),this._debug("signalingStateChange %s",this._pc.signalingState),this.emit("signalingStateChange",this._pc.signalingState))}_onIceCandidate(e){this.destroyed||(e.candidate&&this.trickle?this.emit("signal",{type:"candidate",candidate:{candidate:e.candidate.candidate,sdpMLineIndex:e.candidate.sdpMLineIndex,sdpMid:e.candidate.sdpMid}}):!e.candidate&&!this._iceComplete&&(this._iceComplete=!0,this.emit("_iceComplete")),e.candidate&&this._startIceCompleteTimeout())}_onChannelMessage(e){if(this.destroyed)return;let n=e.data;n instanceof ArrayBuffer&&(n=lwt.from(n)),this.push(n)}_onChannelBufferedAmountLow(){if(this.destroyed||!this._cb)return;this._debug("ending backpressure: bufferedAmount %d",this._channel.bufferedAmount);const e=this._cb;this._cb=null,e(null)}_onChannelOpen(){this._connected||this.destroyed||(this._debug("on channel open"),this._channelReady=!0,this._maybeReady())}_onChannelClose(){this.destroyed||(this._debug("on channel close"),this.destroy())}_onTrack(e){this.destroyed||e.streams.forEach(n=>{this._debug("on track"),this.emit("track",e.track,n),this._remoteTracks.push({track:e.track,stream:n}),!this._remoteStreams.some(i=>i.id===n.id)&&(this._remoteStreams.push(n),sV(()=>{this._debug("on stream"),this.emit("stream",n)}))})}_debug(){const e=[].slice.call(arguments);e[0]="["+this._id+"] "+e[0],owt.apply(null,e)}};M8.WEBRTC_SUPPORT=!!Q1e();M8.config={iceServers:[{urls:["stun:stun.l.google.com:19302","stun:global.stun.twilio.com:3478"]}],sdpSemantics:"unified-plan"};M8.channelConfig={};var dwt=M8;const pwt=x8("simple-websocket"),mwt=w8,gwt=Z1e,Eoe=J1e,sO=n1,gM=typeof sO!="function"?WebSocket:sO,Soe=64*1024;let exe=class extends gwt.Duplex{constructor(e={}){if(typeof e=="string"&&(e={url:e}),e=Object.assign({allowHalfOpen:!1},e),super(e),e.url==null&&e.socket==null)throw new Error("Missing required `url` or `socket` option");if(e.url!=null&&e.socket!=null)throw new Error("Must specify either `url` or `socket` option, not both");if(this._id=mwt(4).toString("hex").slice(0,7),this._debug("new websocket: %o",e),this.connected=!1,this.destroyed=!1,this._chunk=null,this._cb=null,this._interval=null,e.socket)this.url=e.socket.url,this._ws=e.socket,this.connected=e.socket.readyState===gM.OPEN;else{this.url=e.url;try{typeof sO=="function"?this._ws=new gM(e.url,null,{...e,encoding:void 0}):this._ws=new gM(e.url)}catch(n){Eoe(()=>this.destroy(n));return}}this._ws.binaryType="arraybuffer",e.socket&&this.connected?Eoe(()=>this._handleOpen()):this._ws.onopen=()=>this._handleOpen(),this._ws.onmessage=n=>this._handleMessage(n),this._ws.onclose=()=>this._handleClose(),this._ws.onerror=n=>this._handleError(n),this._handleFinishBound=()=>this._handleFinish(),this.once("finish",this._handleFinishBound)}send(e){this._ws.send(e)}destroy(e){this._destroy(e,()=>{})}_destroy(e,n){if(!this.destroyed){if(this._debug("destroy (error: %s)",e&&(e.message||e)),this.readable=this.writable=!1,this._readableState.ended||this.push(null),this._writableState.finished||this.end(),this.connected=!1,this.destroyed=!0,clearInterval(this._interval),this._interval=null,this._chunk=null,this._cb=null,this._handleFinishBound&&this.removeListener("finish",this._handleFinishBound),this._handleFinishBound=null,this._ws){const i=this._ws,r=()=>{i.onclose=null};if(i.readyState===gM.CLOSED)r();else try{i.onclose=r,i.close()}catch{r()}i.onopen=null,i.onmessage=null,i.onerror=()=>{}}this._ws=null,e&&this.emit("error",e),this.emit("close"),n()}}_read(){}_write(e,n,i){if(this.destroyed)return i(new Error("cannot write after socket is destroyed"));if(this.connected){try{this.send(e)}catch(r){return this.destroy(r)}typeof sO!="function"&&this._ws.bufferedAmount>Soe?(this._debug("start backpressure: bufferedAmount %d",this._ws.bufferedAmount),this._cb=i):i(null)}else this._debug("write before connect"),this._chunk=e,this._cb=i}_handleOpen(){if(!(this.connected||this.destroyed)){if(this.connected=!0,this._chunk){try{this.send(this._chunk)}catch(n){return this.destroy(n)}this._chunk=null,this._debug('sent chunk from "write before connect"');const e=this._cb;this._cb=null,e(null)}typeof sO!="function"&&(this._interval=setInterval(()=>this._onInterval(),150),this._interval.unref&&this._interval.unref()),this._debug("connect"),this.emit("connect")}}_handleMessage(e){if(this.destroyed)return;let n=e.data;n instanceof ArrayBuffer&&(n=Fl.from(n)),this.push(n)}_handleClose(){this.destroyed||(this._debug("on close"),this.destroy())}_handleError(e){this.destroy(new Error(`Error connecting to ${this.url}`))}_handleFinish(){if(this.destroyed)return;const e=()=>{setTimeout(()=>this.destroy(),1e3)};this.connected?e():this.once("connect",e)}_onInterval(){if(!this._cb||!this._ws||this._ws.bufferedAmount>Soe)return;this._debug("ending backpressure: bufferedAmount %d",this._ws.bufferedAmount);const e=this._cb;this._cb=null,e(null)}_debug(){const e=[].slice.call(arguments);e[0]="["+this._id+"] "+e[0],pwt.apply(null,e)}};exe.WEBSOCKET_SUPPORT=!!gM;var vwt=exe,txe={};(function(t){t.DEFAULT_ANNOUNCE_PEERS=50,t.MAX_ANNOUNCE_PEERS=82,t.binaryToHex=n=>(typeof n!="string"&&(n=String(n)),Fl.from(n,"binary").toString("hex")),t.hexToBinary=n=>(typeof n!="string"&&(n=String(n)),Fl.from(n,"hex").toString("binary")),t.parseUrl=n=>{const i=new URL(n.replace(/^udp:/,"http:"));return n.match(/^udp:/)&&Object.defineProperties(i,{href:{value:i.href.replace(/^http/,"udp")},protocol:{value:i.protocol.replace(/^http/,"udp")},origin:{value:i.origin.replace(/^http/,"udp")}}),i},Object.assign(t,n1)})(txe);const _wt=jk;let ywt=class extends _wt{constructor(e,n){super(),this.client=e,this.announceUrl=n,this.interval=null,this.destroyed=!1}setInterval(e){e==null&&(e=this.DEFAULT_ANNOUNCE_INTERVAL),clearInterval(this.interval),e&&(this.interval=setInterval(()=>{this.announce(this.client._defaultAnnounceOpts())},e),this.interval.unref&&this.interval.unref())}};var bwt=ywt;const Ewt=uxt,Jp=x8("bittorrent-tracker:websocket-tracker"),Swt=dwt,Twt=w8,xwt=vwt,wwt=n1,By=txe,Cwt=bwt,Bv={},Awt=10*1e3,Rwt=60*60*1e3,Mwt=5*60*1e3,Owt=50*1e3;let oZ=class extends Cwt{constructor(e,n){super(e,n),Jp("new websocket tracker %s",n),this.peers={},this.socket=null,this.reconnecting=!1,this.retries=0,this.reconnectTimer=null,this.expectingResponse=!1,this._openSocket()}announce(e){if(this.destroyed||this.reconnecting)return;if(!this.socket.connected){this.socket.once("connect",()=>{this.announce(e)});return}const n=Object.assign({},e,{action:"announce",info_hash:this.client._infoHashBinary,peer_id:this.client._peerIdBinary});if(this._trackerId&&(n.trackerid=this._trackerId),e.event==="stopped"||e.event==="completed")this._send(n);else{const i=Math.min(e.numwant,5);this._generateOffers(i,r=>{n.numwant=i,n.offers=r,this._send(n)})}}scrape(e){if(this.destroyed||this.reconnecting)return;if(!this.socket.connected){this.socket.once("connect",()=>{this.scrape(e)});return}const i={action:"scrape",info_hash:Array.isArray(e.infoHash)&&e.infoHash.length>0?e.infoHash.map(r=>r.toString("binary")):e.infoHash&&e.infoHash.toString("binary")||this.client._infoHashBinary};this._send(i)}destroy(e=Toe){if(this.destroyed)return e(null);this.destroyed=!0,clearInterval(this.interval),clearTimeout(this.reconnectTimer);for(const s in this.peers){const a=this.peers[s];clearTimeout(a.trackerTimeout),a.destroy()}if(this.peers=null,this.socket&&(this.socket.removeListener("connect",this._onSocketConnectBound),this.socket.removeListener("data",this._onSocketDataBound),this.socket.removeListener("close",this._onSocketCloseBound),this.socket.removeListener("error",this._onSocketErrorBound),this.socket=null),this._onSocketConnectBound=null,this._onSocketErrorBound=null,this._onSocketDataBound=null,this._onSocketCloseBound=null,Bv[this.announceUrl]&&(Bv[this.announceUrl].consumers-=1),Bv[this.announceUrl].consumers>0)return e();let n=Bv[this.announceUrl];delete Bv[this.announceUrl],n.on("error",Toe),n.once("close",e);let i;if(!this.expectingResponse)return r();i=setTimeout(r,By.DESTROY_TIMEOUT),n.once("data",r);function r(){i&&(clearTimeout(i),i=null),n.removeListener("data",r),n.destroy(),n=null}}_openSocket(){if(this.destroyed=!1,this.peers||(this.peers={}),this._onSocketConnectBound=()=>{this._onSocketConnect()},this._onSocketErrorBound=e=>{this._onSocketError(e)},this._onSocketDataBound=e=>{this._onSocketData(e)},this._onSocketCloseBound=()=>{this._onSocketClose()},this.socket=Bv[this.announceUrl],this.socket)Bv[this.announceUrl].consumers+=1,this.socket.connected&&this._onSocketConnectBound();else{const e=new URL(this.announceUrl);let n;this.client._proxyOpts&&(n=e.protocol==="wss:"?this.client._proxyOpts.httpsAgent:this.client._proxyOpts.httpAgent,!n&&this.client._proxyOpts.socksProxy&&(n=new wwt.Agent(Ewt(this.client._proxyOpts.socksProxy),e.protocol==="wss:"))),this.socket=Bv[this.announceUrl]=new xwt({url:this.announceUrl,agent:n}),this.socket.consumers=1,this.socket.once("connect",this._onSocketConnectBound)}this.socket.on("data",this._onSocketDataBound),this.socket.once("close",this._onSocketCloseBound),this.socket.once("error",this._onSocketErrorBound)}_onSocketConnect(){this.destroyed||this.reconnecting&&(this.reconnecting=!1,this.retries=0,this.announce(this.client._defaultAnnounceOpts()))}_onSocketData(e){if(!this.destroyed){this.expectingResponse=!1;try{e=JSON.parse(e)}catch{this.client.emit("warning",new Error("Invalid tracker response"));return}e.action==="announce"?this._onAnnounceResponse(e):e.action==="scrape"?this._onScrapeResponse(e):this._onSocketError(new Error(`invalid action in WS response: ${e.action}`))}}_onAnnounceResponse(e){if(e.info_hash!==this.client._infoHashBinary){Jp("ignoring websocket data from %s for %s (looking for %s: reused socket)",this.announceUrl,By.binaryToHex(e.info_hash),this.client.infoHash);return}if(e.peer_id&&e.peer_id===this.client._peerIdBinary)return;Jp("received %s from %s for %s",JSON.stringify(e),this.announceUrl,this.client.infoHash);const n=e["failure reason"];if(n)return this.client.emit("warning",new Error(n));const i=e["warning message"];i&&this.client.emit("warning",new Error(i));const r=e.interval||e["min interval"];r&&this.setInterval(r*1e3);const s=e["tracker id"];if(s&&(this._trackerId=s),e.complete!=null){const o=Object.assign({},e,{announce:this.announceUrl,infoHash:By.binaryToHex(e.info_hash)});this.client.emit("update",o)}let a;if(e.offer&&e.peer_id&&(Jp("creating peer (from remote offer)"),a=this._createPeer(),a.id=By.binaryToHex(e.peer_id),a.once("signal",o=>{const c={action:"announce",info_hash:this.client._infoHashBinary,peer_id:this.client._peerIdBinary,to_peer_id:e.peer_id,answer:o,offer_id:e.offer_id};this._trackerId&&(c.trackerid=this._trackerId),this._send(c)}),this.client.emit("peer",a),a.signal(e.offer)),e.answer&&e.peer_id){const o=By.binaryToHex(e.offer_id);a=this.peers[o],a?(a.id=By.binaryToHex(e.peer_id),this.client.emit("peer",a),a.signal(e.answer),clearTimeout(a.trackerTimeout),a.trackerTimeout=null,delete this.peers[o]):Jp(`got unexpected answer: ${JSON.stringify(e.answer)}`)}}_onScrapeResponse(e){e=e.files||{};const n=Object.keys(e);if(n.length===0){this.client.emit("warning",new Error("invalid scrape response"));return}n.forEach(i=>{const r=Object.assign(e[i],{announce:this.announceUrl,infoHash:By.binaryToHex(i)});this.client.emit("scrape",r)})}_onSocketClose(){this.destroyed||(this.destroy(),this._startReconnectTimer())}_onSocketError(e){this.destroyed||(this.destroy(),this.client.emit("warning",e),this._startReconnectTimer())}_startReconnectTimer(){const e=Math.floor(Math.random()*Mwt)+Math.min(Math.pow(2,this.retries)*Awt,Rwt);this.reconnecting=!0,clearTimeout(this.reconnectTimer),this.reconnectTimer=setTimeout(()=>{this.retries++,this._openSocket()},e),this.reconnectTimer.unref&&this.reconnectTimer.unref(),Jp("reconnecting socket in %s ms",e)}_send(e){if(this.destroyed)return;this.expectingResponse=!0;const n=JSON.stringify(e);Jp("send %s",n),this.socket.send(n)}_generateOffers(e,n){const i=this,r=[];Jp("generating %s offers",e);for(let o=0;o<e;++o)s();a();function s(){const o=Twt(20).toString("hex");Jp("creating peer (from _generateOffers)");const c=i.peers[o]=i._createPeer({initiator:!0});c.once("signal",l=>{r.push({offer:l,offer_id:By.hexToBinary(o)}),a()}),c.trackerTimeout=setTimeout(()=>{Jp("tracker timeout: destroying peer"),c.trackerTimeout=null,delete i.peers[o],c.destroy()},Owt),c.trackerTimeout.unref&&c.trackerTimeout.unref()}function a(){r.length===e&&(Jp("generated %s offers",e),n(r))}}_createPeer(e){const n=this;e=Object.assign({trickle:!1,config:n.client._rtcConfig,wrtc:n.client._wrtc},e);const i=new Swt(e);return i.once("error",r),i.once("connect",s),i;function r(a){n.client.emit("warning",new Error(`Connection error: ${a.message}`)),i.destroy()}function s(){i.removeListener("error",r),i.removeListener("connect",s)}}};oZ.prototype.DEFAULT_ANNOUNCE_INTERVAL=30*1e3;oZ._socketPool=Bv;function Toe(){}var Nwt=oZ,cZ={exports:{}},nxe={exports:{}};(function(t,e){(function(i,r){t.exports=r()})(typeof self<"u"?self:jl,function(){return function(n){var i={};function r(s){if(i[s])return i[s].exports;var a=i[s]={i:s,l:!1,exports:{}};return n[s].call(a.exports,a,a.exports,r),a.l=!0,a.exports}return r.m=n,r.c=i,r.d=function(s,a,o){r.o(s,a)||Object.defineProperty(s,a,{configurable:!1,enumerable:!0,get:o})},r.n=function(s){var a=s&&s.__esModule?function(){return s.default}:function(){return s};return r.d(a,"a",a),a},r.o=function(s,a){return Object.prototype.hasOwnProperty.call(s,a)},r.p="",r(r.s=3)}([function(n,i,r){function s(y,v){if(!(y instanceof v))throw new TypeError("Cannot call a class as a function")}var a=r(5),o=r(1),c=o.toHex,l=o.ceilHeapSize,u=r(6),h=function(y){for(y+=9;y%64>0;y+=1);return y},f=function(y,v){var b=new Uint8Array(y.buffer),T=v%4,x=v-T;switch(T){case 0:b[x+3]=0;case 1:b[x+2]=0;case 2:b[x+1]=0;case 3:b[x+0]=0}for(var M=(v>>2)+1;M<y.length;M++)y[M]=0},d=function(y,v,b){y[v>>2]|=128<<24-(v%4<<3),y[((v>>2)+2&-16)+14]=b/(1<<29)|0,y[((v>>2)+2&-16)+15]=b<<3},p=function(y,v){var b=new Int32Array(y,v+320,5),T=new Int32Array(5),x=new DataView(T.buffer);return x.setInt32(0,b[0],!1),x.setInt32(4,b[1],!1),x.setInt32(8,b[2],!1),x.setInt32(12,b[3],!1),x.setInt32(16,b[4],!1),T},g=function(){function y(v){if(s(this,y),v=v||64*1024,v%64>0)throw new Error("Chunk size must be a multiple of 128 bit");this._offset=0,this._maxChunkLen=v,this._padMaxChunkLen=h(v),this._heap=new ArrayBuffer(l(this._padMaxChunkLen+320+20)),this._h32=new Int32Array(this._heap),this._h8=new Int8Array(this._heap),this._core=new a({Int32Array},{},this._heap)}return y.prototype._initState=function(b,T){this._offset=0;var x=new Int32Array(b,T+320,5);x[0]=1732584193,x[1]=-271733879,x[2]=-1732584194,x[3]=271733878,x[4]=-1009589776},y.prototype._padChunk=function(b,T){var x=h(b),M=new Int32Array(this._heap,0,x>>2);return f(M,b),d(M,b,T),x},y.prototype._write=function(b,T,x,M){u(b,this._h8,this._h32,T,x,M||0)},y.prototype._coreCall=function(b,T,x,M,R){var I=x;this._write(b,T,x),R&&(I=this._padChunk(x,M)),this._core.hash(I,this._padMaxChunkLen)},y.prototype.rawDigest=function(b){var T=b.byteLength||b.length||b.size||0;this._initState(this._heap,this._padMaxChunkLen);var x=0,M=this._maxChunkLen;for(x=0;T>x+M;x+=M)this._coreCall(b,x,M,T,!1);return this._coreCall(b,x,T-x,T,!0),p(this._heap,this._padMaxChunkLen)},y.prototype.digest=function(b){return c(this.rawDigest(b).buffer)},y.prototype.digestFromString=function(b){return this.digest(b)},y.prototype.digestFromBuffer=function(b){return this.digest(b)},y.prototype.digestFromArrayBuffer=function(b){return this.digest(b)},y.prototype.resetState=function(){return this._initState(this._heap,this._padMaxChunkLen),this},y.prototype.append=function(b){var T=0,x=b.byteLength||b.length||b.size||0,M=this._offset%this._maxChunkLen,R=void 0;for(this._offset+=x;T<x;)R=Math.min(x-T,this._maxChunkLen-M),this._write(b,T,R,M),M+=R,T+=R,M===this._maxChunkLen&&(this._core.hash(this._maxChunkLen,this._padMaxChunkLen),M=0);return this},y.prototype.getState=function(){var b=this._offset%this._maxChunkLen,T=void 0;if(b)T=this._heap.slice(0);else{var x=new Int32Array(this._heap,this._padMaxChunkLen+320,5);T=x.buffer.slice(x.byteOffset,x.byteOffset+x.byteLength)}return{offset:this._offset,heap:T}},y.prototype.setState=function(b){if(this._offset=b.offset,b.heap.byteLength===20){var T=new Int32Array(this._heap,this._padMaxChunkLen+320,5);T.set(new Int32Array(b.heap))}else this._h32.set(new Int32Array(b.heap));return this},y.prototype.rawEnd=function(){var b=this._offset,T=b%this._maxChunkLen,x=this._padChunk(T,b);this._core.hash(x,this._padMaxChunkLen);var M=p(this._heap,this._padMaxChunkLen);return this._initState(this._heap,this._padMaxChunkLen),M},y.prototype.end=function(){return c(this.rawEnd().buffer)},y}();n.exports=g,n.exports._core=a},function(n,i){for(var r=new Array(256),s=0;s<256;s++)r[s]=(s<16?"0":"")+s.toString(16);n.exports.toHex=function(a){for(var o=new Uint8Array(a),c=new Array(a.byteLength),l=0;l<c.length;l++)c[l]=r[o[l]];return c.join("")},n.exports.ceilHeapSize=function(a){var o=0;if(a<=65536)return 65536;if(a<16777216)for(o=1;o<a;o=o<<1);else for(o=16777216;o<a;o+=16777216);return o},n.exports.isDedicatedWorkerScope=function(a){var o="WorkerGlobalScope"in a&&a instanceof a.WorkerGlobalScope,c="SharedWorkerGlobalScope"in a&&a instanceof a.SharedWorkerGlobalScope,l="ServiceWorkerGlobalScope"in a&&a instanceof a.ServiceWorkerGlobalScope;return o&&!c&&!l}},function(n,i,r){n.exports=function(){var s=r(0),a=function(l,u,h){try{return h(null,l.digest(u))}catch(f){return h(f)}},o=function(l,u,h,f,d){var p=new self.FileReader;p.onloadend=function(){if(p.error)return d(p.error);var y=p.result;u+=p.result.byteLength;try{l.append(y)}catch(v){d(v);return}u<f.size?o(l,u,h,f,d):d(null,l.end())},p.readAsArrayBuffer(f.slice(u,u+h))},c=!0;return self.onmessage=function(l){if(c){var u=l.data.data,h=l.data.file,f=l.data.id;if(!(typeof f>"u")&&!(!h&&!u)){var d=l.data.blockSize||4*1024*1024,p=new s(d);p.resetState();var g=function(y,v){y?self.postMessage({id:f,error:y.name}):self.postMessage({id:f,hash:v})};u&&a(p,u,g),h&&o(p,0,d,h,g)}}},function(){c=!1}}},function(n,i,r){var s=r(4),a=r(0),o=r(7),c=r(2),l=r(1),u=l.isDedicatedWorkerScope,h=typeof self<"u"&&u(self);a.disableWorkerBehaviour=h?c():function(){},a.createWorker=function(){var f=s(2),d=f.terminate;return f.terminate=function(){URL.revokeObjectURL(f.objectURL),d.call(f)},f},a.createHash=o,n.exports=a},function(n,i,r){function s(f){var d={};function p(y){if(d[y])return d[y].exports;var v=d[y]={i:y,l:!1,exports:{}};return f[y].call(v.exports,v,v.exports,p),v.l=!0,v.exports}p.m=f,p.c=d,p.i=function(y){return y},p.d=function(y,v,b){p.o(y,v)||Object.defineProperty(y,v,{configurable:!1,enumerable:!0,get:b})},p.r=function(y){Object.defineProperty(y,"__esModule",{value:!0})},p.n=function(y){var v=y&&y.__esModule?function(){return y.default}:function(){return y};return p.d(v,"a",v),v},p.o=function(y,v){return Object.prototype.hasOwnProperty.call(y,v)},p.p="/",p.oe=function(y){throw console.error(y),y};var g=p(p.s=ENTRY_MODULE);return g.default||g}var a="[\\.|\\-|\\+|\\w|/|@]+",o="\\((/\\*.*?\\*/)?s?.*?("+a+").*?\\)";function c(f){return(f+"").replace(/[.?*+^$[\]\\(){}|-]/g,"\\$&")}function l(f,d,p){var g={};g[p]=[];var y=d.toString(),v=y.match(/^function\s?\(\w+,\s*\w+,\s*(\w+)\)/);if(!v)return g;for(var b=v[1],T=new RegExp("(\\\\n|\\W)"+c(b)+o,"g"),x;x=T.exec(y);)x[3]!=="dll-reference"&&g[p].push(x[3]);for(T=new RegExp("\\("+c(b)+'\\("(dll-reference\\s('+a+'))"\\)\\)'+o,"g");x=T.exec(y);)f[x[2]]||(g[p].push(x[1]),f[x[2]]=r(x[1]).m),g[x[2]]=g[x[2]]||[],g[x[2]].push(x[4]);return g}function u(f){var d=Object.keys(f);return d.reduce(function(p,g){return p||f[g].length>0},!1)}function h(f,d){for(var p={main:[d]},g={main:[]},y={main:{}};u(p);)for(var v=Object.keys(p),b=0;b<v.length;b++){var T=v[b],x=p[T],M=x.pop();if(y[T]=y[T]||{},!(y[T][M]||!f[T][M])){y[T][M]=!0,g[T]=g[T]||[],g[T].push(M);for(var R=l(f,f[T][M],T),I=Object.keys(R),k=0;k<I.length;k++)p[I[k]]=p[I[k]]||[],p[I[k]]=p[I[k]].concat(R[I[k]])}}return g}n.exports=function(f,d){d=d||{};var p={main:r.m},g=d.all?{main:Object.keys(p)}:h(p,f),y="";Object.keys(g).filter(function(M){return M!=="main"}).forEach(function(M){for(var R=0;g[M][R];)R++;g[M].push(R),p[M][R]="(function(module, exports, __webpack_require__) { module.exports = __webpack_require__; })",y=y+"var "+M+" = ("+s.toString().replace("ENTRY_MODULE",JSON.stringify(R))+")({"+g[M].map(function(I){return""+JSON.stringify(I)+": "+p[M][I].toString()}).join(",")+`});
`}),y=y+"("+s.toString().replace("ENTRY_MODULE",JSON.stringify(f))+")({"+g.main.map(function(M){return""+JSON.stringify(M)+": "+p.main[M].toString()}).join(",")+"})(self);";var v=new window.Blob([y],{type:"text/javascript"});if(d.bare)return v;var b=window.URL||window.webkitURL||window.mozURL||window.msURL,T=b.createObjectURL(v),x=new window.Worker(T);return x.objectURL=T,x}},function(n,i){n.exports=function(s,a,o){var c=new s.Int32Array(o);function l(u,h){u=u|0,h=h|0;var f=0,d=0,p=0,g=0,y=0,v=0,b=0,T=0,x=0,M=0,R=0,I=0,k=0,P=0;for(p=c[h+320>>2]|0,y=c[h+324>>2]|0,b=c[h+328>>2]|0,x=c[h+332>>2]|0,R=c[h+336>>2]|0,f=0;(f|0)<(u|0);f=f+64|0){for(g=p,v=y,T=b,M=x,I=R,d=0;(d|0)<64;d=d+4|0)P=c[f+d>>2]|0,k=((p<<5|p>>>27)+(y&b|~y&x)|0)+((P+R|0)+1518500249|0)|0,R=x,x=b,b=y<<30|y>>>2,y=p,p=k,c[u+d>>2]=P;for(d=u+64|0;(d|0)<(u+80|0);d=d+4|0)P=(c[d-12>>2]^c[d-32>>2]^c[d-56>>2]^c[d-64>>2])<<1|(c[d-12>>2]^c[d-32>>2]^c[d-56>>2]^c[d-64>>2])>>>31,k=((p<<5|p>>>27)+(y&b|~y&x)|0)+((P+R|0)+1518500249|0)|0,R=x,x=b,b=y<<30|y>>>2,y=p,p=k,c[d>>2]=P;for(d=u+80|0;(d|0)<(u+160|0);d=d+4|0)P=(c[d-12>>2]^c[d-32>>2]^c[d-56>>2]^c[d-64>>2])<<1|(c[d-12>>2]^c[d-32>>2]^c[d-56>>2]^c[d-64>>2])>>>31,k=((p<<5|p>>>27)+(y^b^x)|0)+((P+R|0)+1859775393|0)|0,R=x,x=b,b=y<<30|y>>>2,y=p,p=k,c[d>>2]=P;for(d=u+160|0;(d|0)<(u+240|0);d=d+4|0)P=(c[d-12>>2]^c[d-32>>2]^c[d-56>>2]^c[d-64>>2])<<1|(c[d-12>>2]^c[d-32>>2]^c[d-56>>2]^c[d-64>>2])>>>31,k=((p<<5|p>>>27)+(y&b|y&x|b&x)|0)+((P+R|0)-1894007588|0)|0,R=x,x=b,b=y<<30|y>>>2,y=p,p=k,c[d>>2]=P;for(d=u+240|0;(d|0)<(u+320|0);d=d+4|0)P=(c[d-12>>2]^c[d-32>>2]^c[d-56>>2]^c[d-64>>2])<<1|(c[d-12>>2]^c[d-32>>2]^c[d-56>>2]^c[d-64>>2])>>>31,k=((p<<5|p>>>27)+(y^b^x)|0)+((P+R|0)-899497514|0)|0,R=x,x=b,b=y<<30|y>>>2,y=p,p=k,c[d>>2]=P;p=p+g|0,y=y+v|0,b=b+T|0,x=x+M|0,R=R+I|0}c[h+320>>2]=p,c[h+324>>2]=y,c[h+328>>2]=b,c[h+332>>2]=x,c[h+336>>2]=R}return{hash:l}}},function(n,i){var r=this,s=void 0;typeof self<"u"&&typeof self.FileReaderSync<"u"&&(s=new self.FileReaderSync);var a=function(l,u,h,f,d,p){var g=void 0,y=p%4,v=(d+y)%4,b=d-v;switch(y){case 0:u[p]=l.charCodeAt(f+3);case 1:u[p+1-(y<<1)|0]=l.charCodeAt(f+2);case 2:u[p+2-(y<<1)|0]=l.charCodeAt(f+1);case 3:u[p+3-(y<<1)|0]=l.charCodeAt(f)}if(!(d<v+(4-y))){for(g=4-y;g<b;g=g+4|0)h[p+g>>2]=l.charCodeAt(f+g)<<24|l.charCodeAt(f+g+1)<<16|l.charCodeAt(f+g+2)<<8|l.charCodeAt(f+g+3);switch(v){case 3:u[p+b+1|0]=l.charCodeAt(f+b+2);case 2:u[p+b+2|0]=l.charCodeAt(f+b+1);case 1:u[p+b+3|0]=l.charCodeAt(f+b)}}},o=function(l,u,h,f,d,p){var g=void 0,y=p%4,v=(d+y)%4,b=d-v;switch(y){case 0:u[p]=l[f+3];case 1:u[p+1-(y<<1)|0]=l[f+2];case 2:u[p+2-(y<<1)|0]=l[f+1];case 3:u[p+3-(y<<1)|0]=l[f]}if(!(d<v+(4-y))){for(g=4-y;g<b;g=g+4|0)h[p+g>>2|0]=l[f+g]<<24|l[f+g+1]<<16|l[f+g+2]<<8|l[f+g+3];switch(v){case 3:u[p+b+1|0]=l[f+b+2];case 2:u[p+b+2|0]=l[f+b+1];case 1:u[p+b+3|0]=l[f+b]}}},c=function(l,u,h,f,d,p){var g=void 0,y=p%4,v=(d+y)%4,b=d-v,T=new Uint8Array(s.readAsArrayBuffer(l.slice(f,f+d)));switch(y){case 0:u[p]=T[3];case 1:u[p+1-(y<<1)|0]=T[2];case 2:u[p+2-(y<<1)|0]=T[1];case 3:u[p+3-(y<<1)|0]=T[0]}if(!(d<v+(4-y))){for(g=4-y;g<b;g=g+4|0)h[p+g>>2|0]=T[g]<<24|T[g+1]<<16|T[g+2]<<8|T[g+3];switch(v){case 3:u[p+b+1|0]=T[b+2];case 2:u[p+b+2|0]=T[b+1];case 1:u[p+b+3|0]=T[b]}}};n.exports=function(l,u,h,f,d,p){if(typeof l=="string")return a(l,u,h,f,d,p);if(l instanceof Array||r&&r.Buffer&&r.Buffer.isBuffer(l))return o(l,u,h,f,d,p);if(l instanceof ArrayBuffer)return o(new Uint8Array(l),u,h,f,d,p);if(l.buffer instanceof ArrayBuffer)return o(new Uint8Array(l.buffer,l.byteOffset,l.byteLength),u,h,f,d,p);if(l instanceof Blob)return c(l,u,h,f,d,p);throw new Error("Unsupported data type.")}},function(n,i,r){var s=function(){function h(f,d){for(var p=0;p<d.length;p++){var g=d[p];g.enumerable=g.enumerable||!1,g.configurable=!0,"value"in g&&(g.writable=!0),Object.defineProperty(f,g.key,g)}}return function(f,d,p){return d&&h(f.prototype,d),p&&h(f,p),f}}();function a(h,f){if(!(h instanceof f))throw new TypeError("Cannot call a class as a function")}var o=r(0),c=r(1),l=c.toHex,u=function(){function h(){a(this,h),this._rusha=new o,this._rusha.resetState()}return h.prototype.update=function(d){return this._rusha.append(d),this},h.prototype.digest=function(d){var p=this._rusha.rawEnd().buffer;if(!d)return p;if(d==="hex")return l(p);throw new Error("unsupported digest encoding")},s(h,[{key:"state",get:function(){return this._rusha.getState()},set:function(f){this._rusha.setState(f)}}]),h}();n.exports=function(){return new u}}])})})(nxe);var ixe=nxe.exports;const Iwt=ixe;let uB,sL,aL;function kwt(){uB=Iwt.createWorker(),sL=1,aL={},uB.onmessage=function(e){const n=e.data.id,i=aL[n];delete aL[n],e.data.error!=null?i(new Error("Rusha worker error: "+e.data.error)):i(null,e.data.hash)}}function Dwt(t,e){uB||kwt(),aL[sL]=e,uB.postMessage({id:sL,data:t}),sL+=1}var Pwt=Dwt;const Lwt=ixe,Uwt=Pwt,Bwt=new Lwt,xoe=typeof window<"u"?window:self,woe=xoe.crypto||xoe.msCrypto||{};let aO=woe.subtle||woe.webkitSubtle;function oL(t){return Bwt.digest(t)}try{aO.digest({name:"sha-1"},new Uint8Array).catch(function(){aO=!1})}catch{aO=!1}function Fwt(t,e){if(!aO){typeof window<"u"?Uwt(t,function(i,r){if(i){e(oL(t));return}e(r)}):queueMicrotask(()=>e(oL(t)));return}typeof t=="string"&&(t=zwt(t)),aO.digest({name:"sha-1"},t).then(function(i){e(Hwt(new Uint8Array(i)))},function(){e(oL(t))})}function zwt(t){const e=t.length,n=new Uint8Array(e);for(let i=0;i<e;i++)n[i]=t.charCodeAt(i);return n}function Hwt(t){const e=t.length,n=[];for(let i=0;i<e;i++){const r=t[i];n.push((r>>>4).toString(16)),n.push((r&15).toString(16))}return n.join("")}cZ.exports=Fwt;cZ.exports.sync=oL;var jwt=cZ.exports;const Coe=Nwt,Vwt=w8,Gwt=jk,qwt=jwt,JR=x8("p2pt"),Aoe="^",Roe=16e3;class $wt extends Gwt{constructor(e=[],n=""){super(),this.announceURLs=e,this.trackers={},this.peers={},this.msgChunks={},this.responseWaiting={},n&&this.setIdentifier(n),this._peerIdBuffer=Vwt(20),this._peerId=this._peerIdBuffer.toString("hex"),this._peerIdBinary=this._peerIdBuffer.toString("binary"),JR("my peer id: "+this._peerId)}setIdentifier(e){this.identifierString=e,this.infoHash=qwt.sync(e).toLowerCase(),this._infoHashBuffer=Fl.from(this.infoHash,"hex"),this._infoHashBinary=this._infoHashBuffer.toString("binary")}start(){this.on("peer",e=>{let n=!1;this.peers[e.id]||(n=!0,this.peers[e.id]={},this.responseWaiting[e.id]={}),e.on("connect",()=>{this.peers[e.id][e.channelName]=e,n&&this.emit("peerconnect",e)}),e.on("data",i=>{if(this.emit("data",e,i),i=i.toString(),JR("got a message from "+e.id),i[0]===Aoe)try{i=JSON.parse(i.slice(1)),e.respond=this._peerRespond(e,i.id);let r=this._chunkHandler(i);r!==!1&&(i.o&&(r=JSON.parse(r)),this.responseWaiting[e.id][i.id]?(this.responseWaiting[e.id][i.id]([e,r]),delete this.responseWaiting[e.id][i.id]):this.emit("msg",e,r),this._destroyChunks(i.id))}catch(r){console.log(r)}}),e.on("error",i=>{this._removePeer(e),JR("Error in connection : "+i)}),e.on("close",()=>{this._removePeer(e),JR("Connection closed with "+e.id)})}),this.on("update",e=>{const n=this.trackers[this.announceURLs.indexOf(e.announce)];this.emit("trackerconnect",n,this.getTrackerStats())}),this.on("warning",e=>{this.emit("trackerwarning",e,this.getTrackerStats())}),this._fetchPeers()}addTracker(e){if(this.announceURLs.indexOf(e)!==-1)throw new Error("Tracker already added");const n=this.announceURLs.push(e);this.trackers[n]=new Coe(this,e),this.trackers[n].announce(this._defaultAnnounceOpts())}removeTracker(e){const n=this.announceURLs.indexOf(e);if(n===-1)throw new Error("Tracker does not exist");this.trackers[n].peers=[],this.trackers[n].destroy(),delete this.trackers[n],delete this.announceURLs[n]}_removePeer(e){if(!this.peers[e.id])return!1;delete this.peers[e.id][e.channelName],Object.keys(this.peers[e.id]).length===0&&(this.emit("peerclose",e),delete this.responseWaiting[e.id],delete this.peers[e.id])}send(e,n,i=""){return new Promise((r,s)=>{const a={id:i!==""?i:Math.floor(Math.random()*1e5+1e5),msg:n};typeof n=="object"&&(a.msg=JSON.stringify(n),a.o=1);try{if(!e.connected){for(const l in this.peers[e.id])if(e=this.peers[e.id][l],e.connected)break}this.responseWaiting[e.id]||(this.responseWaiting[e.id]={}),this.responseWaiting[e.id][a.id]=r}catch(l){return s(Error("Connection to peer closed"+l))}let o=0,c="";for(;a.msg.length>0;)a.c=o,c=a.msg.slice(Roe),a.msg=a.msg.slice(0,Roe),c||(a.last=!0),e.send(Aoe+JSON.stringify(a)),a.msg=c,o++;JR("sent a message to "+e.id)})}requestMorePeers(){return new Promise(e=>{for(const n in this.trackers)this.trackers[n].announce(this._defaultAnnounceOpts());e(this.peers)})}getTrackerStats(){let e=0;for(const n in this.trackers)this.trackers[n].socket&&this.trackers[n].socket.connected&&e++;return{connected:e,total:this.announceURLs.length}}destroy(){let e;for(e in this.peers)for(const n in this.peers[e])this.peers[e][n].destroy();for(e in this.trackers)this.trackers[e].destroy()}_peerRespond(e,n){return i=>this.send(e,i,n)}_chunkHandler(e){return this.msgChunks[e.id]||(this.msgChunks[e.id]=[]),this.msgChunks[e.id][e.c]=e.msg,e.last?this.msgChunks[e.id].join(""):!1}_destroyChunks(e){delete this.msgChunks[e]}_defaultAnnounceOpts(e={}){return e.numwant==null&&(e.numwant=50),e.uploaded==null&&(e.uploaded=0),e.downloaded==null&&(e.downloaded=0),e}_fetchPeers(){for(const e in this.announceURLs)this.trackers[e]=new Coe(this,this.announceURLs[e]),this.trackers[e].announce(this._defaultAnnounceOpts())}}var Wwt=$wt;const Ywt=Yc(Wwt),Xwt=`
wss://tracker.btorrent.xyz
wss://tracker.webtorrent.dev
wss://tracker.openwebtorrent.com
`.split(`
`).map(t=>t.trim()).filter(t=>t);function JA(t){return JO(t)}const Kwt="hubworld_787c04233659d187faa51e93440ae0babdfa5f89",dp=new Ywt(Xwt,Kwt),Gk=new lxt(JA(dp._peerId),{getId(t){return t.id}});dp.on("peerconnect",t=>{Ci(je,nr(),`remote connected ${t.id}`),Gk.add({id:JA(t.id),peer:t})});dp.on("peerclose",t=>{Ci(je,nr(),`remote closed ${t.id}`),Gk.remove(JA(t.id))});let cL="";const Moe=new Map;dp.on("msg",(t,e)=>{const n=Date.now(),i=Moe.get(e.topic)??new Map;if("pub"in e){e.topic===cL&&(tb==null||tb.forward({...e.gme,session:je.session()}));for(const[r,s]of i)if(n-s>1e3*60)i.delete(r);else{const[o]=Gk.listClosestToId(JA(r),1);se(o)&&dp.send(o.peer,e).catch(console.error)}}else"sub"in e&&(i.set(e.sub,n),e.topic===cL&&dp._peerId===cL?(tb==null||tb.forward({...e.gme,session:je.session()}),Jwt()):se(e.gme)&&axe(e.topic,e.sub,e.gme));Moe.set(e.topic,i)});dp.on("trackerconnect",(t,e)=>{Ci(je,nr(),`looking for players ${JFe(t.announceUrl)} [${e.connected}]`)});let Ooe=!1,tb,rxe;function Zwt(t){function e(){pFe(je,t)}e(),rxe=setInterval(e,5*1e3)}function Jwt(){clearInterval(rxe)}function sxe(t){Ooe||(Ooe=!0,cL=t,dp.start(),Ci(je,nr(),`connecting to hubworld for ${t}`))}function Qwt(t,e){const[n]=Gk.listClosestToId(JA(t),1);se(n)&&dp.send(n.peer,{topic:t,pub:!0,gme:e}).catch(()=>{})}function Noe(t,e){const n=dp._peerId;sxe(n),qBe(je,nr(),t,n),e&&GBe(je,nr(),n),tb=wX(i=>{Rht(i)&&Aht(i)===!1&&Qwt(n,i)})}function axe(t,e,n){const[i]=Gk.listClosestToId(JA(t),1);se(i)&&dp.send(i.peer,{topic:t,sub:e,gme:n}).catch(console.error)}function eCt(t,e){sxe(t),tb=wX(n=>{Aye(n)&&Mht()===!1&&axe(t,dp._peerId,n)}),setTimeout(()=>Zwt(e),1e3)}let vg,au;async function tCt(t,e,n,i,r,s){let a;switch(si(r)){case"get":{a=await fetch(i);break}case"post:json":{const l=[];for(let u=0;u<s.length;u+=2)l.push([s[u],s[u+1]]);a=await fetch(i,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(ALe(l))});break}}if(!(a!=null&&a.ok))return;const o=`fetch:${n}`,[c]=(a.headers.get("content-type")??"").split(";");switch(c){case"text/plain":{const l=await a.text();Ci(je,t,JSON.stringify(l)),Vg(je,t,e,"text",o,l);break}case"application/json":{const l=await a.json();Ci(je,t,JSON.stringify(l)),Vg(je,t,e,"json",o,l);break}case"application/octet-stream":{const l=await a.arrayBuffer();Vg(je,t,e,"binary",o,new Uint8Array(l));break}}}const ta=yE("bridge",[],t=>{if(!ta.session(t))return;const e=nr();switch(t.target){default:if(t.player!==e)return;break}switch(t.target){case"fetch":if(Li(t.data)){const[n,i,r,s,a]=t.data;cu(je,t.player,async()=>{await tCt(t.player,n,i,r,s,a)})}break;case"start":Noe(!!t.data,!1);break;case"tab":Noe(!!t.data,!0);break;case"tabopen":On(t.data)&&window.open(`${location.origin}/join/#${t.data}`,"_blank","noopener,noreferrer");break;case"join":On(t.data)&&eCt(t.data,t.player);break;case"showjoincode":cu(ta,t.player,async()=>{if(Li(t.data)){const[n,i]=t.data,r=`${location.origin}/join/#${i}`,s=await _pe(r);n?GG(ta,t.player,s,"secret join url",!1):GG(ta,t.player,s,s)}});break;case"talkstart":uEt();break;case"talkstop":hEt();break;case"mediastart":dEt();break;case"mediastop":pEt();break;case"chatstart":se(vg)?Ui(ta,t.player,"bridge","chat is already started"):On(t.data)&&(Ci(ta,t.player,`connecting to ${t.data}`),vg=new cB({channels:[t.data]}),vg.connect(),vg.onConnect(()=>{Ci(ta,t.player,"connected")}),vg.onDisconnect(()=>{Ci(ta,t.player,"disconnected")}),vg.onMessage((n,i,r)=>{Vg(ta,t.player,void 0,"text",`chat:message:${t.data}`,`${i}:${r}`)}),vg.onAction((n,i,r)=>{Vg(ta,t.player,void 0,"text",`chat:action:${t.data}`,`${i}:${r}`)}));break;case"chatstop":se(vg)?(vg.quit(),vg=void 0,Ci(ta,t.player,"chat stopped")):Ui(ta,t.player,"bridge","chat is already stoped");break;case"streamstart":cu(ta,t.player,async()=>{if(se(au))Ui(ta,t.player,"bridge","stream is already open");else{const n=window.innerHeight>window.innerWidth;au=zS.create({streamConfig:n?zS.STANDARD_PORTRAIT:zS.STANDARD_LANDSCAPE,logLevel:zS.LOG_LEVEL.DEBUG}),au.on(zS.BroadcastClientEvents.ACTIVE_STATE_CHANGE,function(s){console.info({activestate:s})}),au.on(zS.BroadcastClientEvents.CONNECTION_STATE_CHANGE,function(s){Ci(ta,t.player,s)}),au.on(zS.BroadcastClientEvents.ERROR,function(s){Ui(ta,t.player,"bridge",s),au=void 0});const i=document.querySelector("canvas");if(se(i))await au.addImageSource(i,"video",{index:1});else{Ui(ta,t.player,"video","unabled to find canvas element"),au=void 0;return}const r=W_t();if(se(r))await au.addAudioInputDevice(r.stream,"audio");else{Ui(ta,t.player,"video","unable create media audio node destination"),au=void 0;return}Ci(ta,t.player,"created client")}On(t.data)&&se(au)&&(Gd(ta,t.player,"broadcasting in"),cr(ta,t.player,"3","..."),await Bd(1e3),cr(ta,t.player,"2","..."),await Bd(1e3),cr(ta,t.player,"1","..."),await Bd(1e3),Gd(ta,t.player,"GOING LIVE"),await au.startBroadcast(t.data,"https://g.webrtc.live-video.net:4443"))});break;case"streamstop":se(au)?(au.stopBroadcast(),au.delete(),au=void 0,Ci(ta,t.player,"stream stopped")):Ui(ta,t.player,"bridge","stream already stopped");break}});function nCt(){const{viewport:t}=oh(),{width:e,height:n}=t.getCurrentViewport(),[i]=Fe.useState(()=>new ryt);Fe.useEffect(()=>{if(!nqe)return;document.body.appendChild(i.dom),i.showPanel(0),i.dom.style.cssText="position:fixed;bottom:0;left:0;";const u=cDe(()=>i.begin()),h=lDe(()=>i.end());return()=>{document.body.removeChild(i.dom),u(),h()}},[i]);const r=uyt(),a=Math.min(e,n)<600||sqe;kn.DRAW_CHAR_SCALE=a?1:2;const o=e>n,c=aqe||y$==="touchOnly"||Abt==="touch",l=!rqe&&!a&&!c&&r&&r.tier>2&&!r.isMobile;return Fe.useEffect(()=>{Zh.setState(u=>({...u,islowrez:a,islandscape:o,showtouchcontrols:c}))},[a,o,c]),Me.jsxs(Me.Fragment,{children:[Me.jsx(H1,{children:Me.jsxs(HSt,{children:[Me.jsx(jSt,{}),Me.jsx(xTt,{}),Me.jsx(CTt,{})]})}),l&&Me.jsx(ybt,{children:Me.jsx(Pbt,{viewheight:n})})]})}document.addEventListener("keydown",()=>{NE()});window.addEventListener("touchstart",()=>{NE()});window.addEventListener("click",()=>{NE()});window.addEventListener("dragover",t=>{t.preventDefault()});window.addEventListener("contextmenu",t=>{NE(),t.preventDefault()});window.addEventListener("paste",t=>{var n;if(!((n=t.clipboardData)!=null&&n.files.length))return;NE(),t.preventDefault(),[...t.clipboardData.files].forEach(i=>Vg(je,nr(),void 0,"file",`file:${i.name}`,i))});window.addEventListener("drop",t=>{var e,n;NE(),t.preventDefault(),(e=t.dataTransfer)!=null&&e.items?[...t.dataTransfer.items].forEach(r=>{if(r.kind==="file"){const s=r.getAsFile();se(s)&&Vg(je,nr(),void 0,"file",s.name,s)}}):[...((n=t.dataTransfer)==null?void 0:n.files)??[]].forEach(r=>Vg(je,nr(),void 0,"file",r.name,r))});function iCt(){return Me.jsx(nCt,{})}eLe();const WP=new Ae,Ioe=new Ae,rCt=t=>({...Tue(t),filter:e=>{const n=e.filter(a=>!(!a.object.visible||(a.object.userData.clippingPlanes??[]).some(c=>(c.projectPoint(a.point,WP),Ioe.subVectors(a.point,WP).normalize().round(),WP.copy(c.normal).round(),WP.equals(Ioe)===!1)))),i=n.findIndex(a=>a.object.userData.blocking),r=i===-1?n:n.slice(0,i+1);let s="default";return r.some(a=>a.object.userData.cursor?(s=a.object.userData.cursor,!0):!1),document.querySelectorAll("html, body").forEach(a=>{a.style.cursor=s}),r}});let oV;function sCt(t,e){const n=document.getElementById("frame");if(!se(n))return;const i=Tee(t),r=Tee(e);n.style.width=`${i}px`,n.style.height=`${r}px`,se(oV)||(oV=Z2e.createRoot(n),oV.render(Me.jsx(gDe,{flat:!0,linear:!0,dpr:1,shadows:!1,events:rCt,gl:{alpha:!0,stencil:!1,antialias:!1,preserveDrawingBuffer:!0},onCreated:({gl:s})=>{s.localClippingEnabled=!0},children:Me.jsx(iCt,{})})))}const oxe=_De(sCt,256);window.addEventListener("resize",()=>oxe(window.innerWidth,window.innerHeight));oxe(window.innerWidth,window.innerHeight);export{Fl as B,_At as a,PYe as b,jl as c,zn as p,n1 as r};
