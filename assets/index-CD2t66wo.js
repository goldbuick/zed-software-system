var Kwe=Object.defineProperty;var Xwe=t=>{throw TypeError(t)};var Zwe=(t,e,n)=>e in t?Kwe(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;var fi=(t,e,n)=>Zwe(t,typeof e!="symbol"?e+"":e,n);var GR=(t,e,n)=>e.has(t)?Xwe("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(t):e.set(t,n);function Jwe(t,e){for(var n=0;n<e.length;n++){const i=e[n];if(typeof i!="string"&&!Array.isArray(i)){for(const r in i)if(r!=="default"&&!(r in t)){const s=Object.getOwnPropertyDescriptor(i,r);s&&Object.defineProperty(t,r,s.get?s:{enumerable:!0,get:()=>i[r]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))i(r);new MutationObserver(r=>{for(const s of r)if(s.type==="childList")for(const a of s.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&i(a)}).observe(document,{childList:!0,subtree:!0});function n(r){const s={};return r.integrity&&(s.integrity=r.integrity),r.referrerPolicy&&(s.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?s.credentials="include":r.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function i(r){if(r.ep)return;r.ep=!0;const s=n(r);fetch(r.href,s)}})();var Ml=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function il(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function $ce(t){if(t.__esModule)return t;var e=t.default;if(typeof e=="function"){var n=function i(){return this instanceof i?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};n.prototype=e.prototype}else n={};return Object.defineProperty(n,"__esModule",{value:!0}),Object.keys(t).forEach(function(i){var r=Object.getOwnPropertyDescriptor(t,i);Object.defineProperty(n,i,r.get?r:{enumerable:!0,get:function(){return t[i]}})}),n}var Wce={exports:{}},KB={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Qwe=Symbol.for("react.transitional.element"),eCe=Symbol.for("react.fragment");function Yce(t,e,n){var i=null;if(n!==void 0&&(i=""+n),e.key!==void 0&&(i=""+e.key),"key"in e){n={};for(var r in e)r!=="key"&&(n[r]=e[r])}else n=e;return e=n.ref,{$$typeof:Qwe,type:t,key:i,ref:e!==void 0?e:null,props:n}}KB.Fragment=eCe;KB.jsx=Yce;KB.jsxs=Yce;Wce.exports=KB;var be=Wce.exports;function tCe(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var Kce={exports:{}},Xo=Kce.exports={},Ng,Ig;function GV(){throw new Error("setTimeout has not been defined")}function qV(){throw new Error("clearTimeout has not been defined")}(function(){try{typeof setTimeout=="function"?Ng=setTimeout:Ng=GV}catch{Ng=GV}try{typeof clearTimeout=="function"?Ig=clearTimeout:Ig=qV}catch{Ig=qV}})();function Xce(t){if(Ng===setTimeout)return setTimeout(t,0);if((Ng===GV||!Ng)&&setTimeout)return Ng=setTimeout,setTimeout(t,0);try{return Ng(t,0)}catch{try{return Ng.call(null,t,0)}catch{return Ng.call(this,t,0)}}}function nCe(t){if(Ig===clearTimeout)return clearTimeout(t);if((Ig===qV||!Ig)&&clearTimeout)return Ig=clearTimeout,clearTimeout(t);try{return Ig(t)}catch{try{return Ig.call(null,t)}catch{return Ig.call(this,t)}}}var e_=[],lC=!1,mT,I2=-1;function iCe(){!lC||!mT||(lC=!1,mT.length?e_=mT.concat(e_):I2=-1,e_.length&&Zce())}function Zce(){if(!lC){var t=Xce(iCe);lC=!0;for(var e=e_.length;e;){for(mT=e_,e_=[];++I2<e;)mT&&mT[I2].run();I2=-1,e=e_.length}mT=null,lC=!1,nCe(t)}}Xo.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];e_.push(new Jce(t,e)),e_.length===1&&!lC&&Xce(Zce)};function Jce(t,e){this.fun=t,this.array=e}Jce.prototype.run=function(){this.fun.apply(null,this.array)};Xo.title="browser";Xo.browser=!0;Xo.env={};Xo.argv=[];Xo.version="";Xo.versions={};function z_(){}Xo.on=z_;Xo.addListener=z_;Xo.once=z_;Xo.off=z_;Xo.removeListener=z_;Xo.removeAllListeners=z_;Xo.emit=z_;Xo.prependListener=z_;Xo.prependOnceListener=z_;Xo.listeners=function(t){return[]};Xo.binding=function(t){throw new Error("process.binding is not supported")};Xo.cwd=function(){return"/"};Xo.chdir=function(t){throw new Error("process.chdir is not supported")};Xo.umask=function(){return 0};var rCe=Kce.exports;const Gn=tCe(rCe);/**
 * @license
 * Copyright 2010-2025 Three.js Authors
 * SPDX-License-Identifier: MIT
 */const WA="176",sCe={LEFT:0,MIDDLE:1,RIGHT:2,ROTATE:0,DOLLY:1,PAN:2},aCe={ROTATE:0,PAN:1,DOLLY_PAN:2,DOLLY_ROTATE:3},Qce=0,$V=1,ele=2,oCe=3,tle=0,XB=1,ZM=2,lm=3,r0=0,$c=1,Vc=2,Eu=0,AT=1,WV=2,YV=3,KV=4,nle=5,db=100,ile=101,rle=102,sle=103,ale=104,ole=200,cle=201,lle=202,ule=203,$L=204,WL=205,hle=206,dle=207,fle=208,ple=209,mle=210,gle=211,vle=212,_le=213,yle=214,YL=0,KL=1,XL=2,YT=3,ZL=4,JL=5,QL=6,eU=7,NI=0,ble=1,Ele=2,Em=0,Sle=1,Tle=2,xle=3,j7=4,wle=5,Cle=6,Ale=7,XV="attached",Rle="detached",ZB=300,T_=301,eE=302,VO=303,GO=304,YA=306,UC=1e3,cp=1001,qO=1002,Va=1003,H7=1004,cCe=1004,Bw=1005,lCe=1005,Ca=1006,JM=1007,uCe=1007,Hg=1008,hCe=1008,lo=1009,V7=1010,G7=1011,BC=1012,JB=1013,s0=1014,vu=1015,SE=1016,QB=1017,eF=1018,KT=1020,q7=35902,$7=1021,W7=1022,Wc=1023,FC=1026,XT=1027,KA=1028,II=1029,tF=1030,nF=1031,dCe=1032,kI=1033,QM=33776,eO=33777,tO=33778,nO=33779,tU=35840,nU=35841,iU=35842,rU=35843,sU=36196,aU=37492,oU=37496,cU=37808,lU=37809,uU=37810,hU=37811,dU=37812,fU=37813,pU=37814,mU=37815,gU=37816,vU=37817,_U=37818,yU=37819,bU=37820,EU=37821,iO=36492,SU=36494,TU=36495,Y7=36283,xU=36284,wU=36285,CU=36286,Mle=2200,Ole=2201,Nle=2202,$O=2300,AU=2301,k2=2302,gT=2400,vT=2401,WO=2402,iF=2500,K7=2501,fCe=0,pCe=1,mCe=2,TE=3200,Ile=3201,gCe=3202,vCe=3203,xE=0,kle=1,gm="",ls="srgb",a0="srgb-linear",YO="linear",Ns="srgb",_Ce=0,JS=7680,yCe=7681,bCe=7682,ECe=7683,SCe=34055,TCe=34056,xCe=5386,wCe=512,CCe=513,ACe=514,RCe=515,MCe=516,OCe=517,NCe=518,ZV=519,Ple=512,Dle=513,Lle=514,X7=515,Ule=516,Ble=517,Fle=518,zle=519,KO=35044,JV=35048,ICe=35040,kCe=35045,PCe=35049,DCe=35041,LCe=35046,UCe=35050,BCe=35042,FCe="100",QV="300 es",lp=2e3,XO=2001,zCe={COMPUTE:"compute",RENDER:"render"},jCe={PERSPECTIVE:"perspective",LINEAR:"linear",FLAT:"flat"},HCe={NORMAL:"normal",CENTROID:"centroid",SAMPLE:"sample",FLAT_FIRST:"flat first",FLAT_EITHER:"flat either"};class _f{addEventListener(e,n){this._listeners===void 0&&(this._listeners={});const i=this._listeners;i[e]===void 0&&(i[e]=[]),i[e].indexOf(n)===-1&&i[e].push(n)}hasEventListener(e,n){const i=this._listeners;return i===void 0?!1:i[e]!==void 0&&i[e].indexOf(n)!==-1}removeEventListener(e,n){const i=this._listeners;if(i===void 0)return;const r=i[e];if(r!==void 0){const s=r.indexOf(n);s!==-1&&r.splice(s,1)}}dispatchEvent(e){const n=this._listeners;if(n===void 0)return;const i=n[e.type];if(i!==void 0){e.target=this;const r=i.slice(0);for(let s=0,a=r.length;s<a;s++)r[s].call(this,e);e.target=null}}}const cu=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"];let QZ=1234567;const RT=Math.PI/180,zC=180/Math.PI;function cf(){const t=Math.random()*4294967295|0,e=Math.random()*4294967295|0,n=Math.random()*4294967295|0,i=Math.random()*4294967295|0;return(cu[t&255]+cu[t>>8&255]+cu[t>>16&255]+cu[t>>24&255]+"-"+cu[e&255]+cu[e>>8&255]+"-"+cu[e>>16&15|64]+cu[e>>24&255]+"-"+cu[n&63|128]+cu[n>>8&255]+"-"+cu[n>>16&255]+cu[n>>24&255]+cu[i&255]+cu[i>>8&255]+cu[i>>16&255]+cu[i>>24&255]).toLowerCase()}function Ki(t,e,n){return Math.max(e,Math.min(n,t))}function Z7(t,e){return(t%e+e)%e}function VCe(t,e,n,i,r){return i+(t-e)*(r-i)/(n-e)}function GCe(t,e,n){return t!==e?(n-t)/(e-t):0}function rO(t,e,n){return(1-n)*t+n*e}function qCe(t,e,n,i){return rO(t,e,1-Math.exp(-n*i))}function $Ce(t,e=1){return e-Math.abs(Z7(t,e*2)-e)}function WCe(t,e,n){return t<=e?0:t>=n?1:(t=(t-e)/(n-e),t*t*(3-2*t))}function YCe(t,e,n){return t<=e?0:t>=n?1:(t=(t-e)/(n-e),t*t*t*(t*(t*6-15)+10))}function KCe(t,e){return t+Math.floor(Math.random()*(e-t+1))}function XCe(t,e){return t+Math.random()*(e-t)}function ZCe(t){return t*(.5-Math.random())}function JCe(t){t!==void 0&&(QZ=t);let e=QZ+=1831565813;return e=Math.imul(e^e>>>15,e|1),e^=e+Math.imul(e^e>>>7,e|61),((e^e>>>14)>>>0)/4294967296}function QCe(t){return t*RT}function eAe(t){return t*zC}function tAe(t){return(t&t-1)===0&&t!==0}function nAe(t){return Math.pow(2,Math.ceil(Math.log(t)/Math.LN2))}function iAe(t){return Math.pow(2,Math.floor(Math.log(t)/Math.LN2))}function rAe(t,e,n,i,r){const s=Math.cos,a=Math.sin,o=s(n/2),c=a(n/2),l=s((e+i)/2),u=a((e+i)/2),h=s((e-i)/2),d=a((e-i)/2),f=s((i-e)/2),p=a((i-e)/2);switch(r){case"XYX":t.set(o*u,c*h,c*d,o*l);break;case"YZY":t.set(c*d,o*u,c*h,o*l);break;case"ZXZ":t.set(c*h,c*d,o*u,o*l);break;case"XZX":t.set(o*u,c*p,c*f,o*l);break;case"YXY":t.set(c*f,o*u,c*p,o*l);break;case"ZYZ":t.set(c*p,c*f,o*u,o*l);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+r)}}function oh(t,e){switch(e.constructor){case Float32Array:return t;case Uint32Array:return t/4294967295;case Uint16Array:return t/65535;case Uint8Array:return t/255;case Int32Array:return Math.max(t/2147483647,-1);case Int16Array:return Math.max(t/32767,-1);case Int8Array:return Math.max(t/127,-1);default:throw new Error("Invalid component type.")}}function ir(t,e){switch(e.constructor){case Float32Array:return t;case Uint32Array:return Math.round(t*4294967295);case Uint16Array:return Math.round(t*65535);case Uint8Array:return Math.round(t*255);case Int32Array:return Math.round(t*2147483647);case Int16Array:return Math.round(t*32767);case Int8Array:return Math.round(t*127);default:throw new Error("Invalid component type.")}}const jle={DEG2RAD:RT,RAD2DEG:zC,generateUUID:cf,clamp:Ki,euclideanModulo:Z7,mapLinear:VCe,inverseLerp:GCe,lerp:rO,damp:qCe,pingpong:$Ce,smoothstep:WCe,smootherstep:YCe,randInt:KCe,randFloat:XCe,randFloatSpread:ZCe,seededRandom:JCe,degToRad:QCe,radToDeg:eAe,isPowerOfTwo:tAe,ceilPowerOfTwo:nAe,floorPowerOfTwo:iAe,setQuaternionFromProperEuler:rAe,normalize:ir,denormalize:oh};class xt{constructor(e=0,n=0){xt.prototype.isVector2=!0,this.x=e,this.y=n}get width(){return this.x}set width(e){this.x=e}get height(){return this.y}set height(e){this.y=e}set(e,n){return this.x=e,this.y=n,this}setScalar(e){return this.x=e,this.y=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setComponent(e,n){switch(e){case 0:this.x=n;break;case 1:this.y=n;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y)}copy(e){return this.x=e.x,this.y=e.y,this}add(e){return this.x+=e.x,this.y+=e.y,this}addScalar(e){return this.x+=e,this.y+=e,this}addVectors(e,n){return this.x=e.x+n.x,this.y=e.y+n.y,this}addScaledVector(e,n){return this.x+=e.x*n,this.y+=e.y*n,this}sub(e){return this.x-=e.x,this.y-=e.y,this}subScalar(e){return this.x-=e,this.y-=e,this}subVectors(e,n){return this.x=e.x-n.x,this.y=e.y-n.y,this}multiply(e){return this.x*=e.x,this.y*=e.y,this}multiplyScalar(e){return this.x*=e,this.y*=e,this}divide(e){return this.x/=e.x,this.y/=e.y,this}divideScalar(e){return this.multiplyScalar(1/e)}applyMatrix3(e){const n=this.x,i=this.y,r=e.elements;return this.x=r[0]*n+r[3]*i+r[6],this.y=r[1]*n+r[4]*i+r[7],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this}clamp(e,n){return this.x=Ki(this.x,e.x,n.x),this.y=Ki(this.y,e.y,n.y),this}clampScalar(e,n){return this.x=Ki(this.x,e,n),this.y=Ki(this.y,e,n),this}clampLength(e,n){const i=this.length();return this.divideScalar(i||1).multiplyScalar(Ki(i,e,n))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(e){return this.x*e.x+this.y*e.y}cross(e){return this.x*e.y-this.y*e.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}angleTo(e){const n=Math.sqrt(this.lengthSq()*e.lengthSq());if(n===0)return Math.PI/2;const i=this.dot(e)/n;return Math.acos(Ki(i,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const n=this.x-e.x,i=this.y-e.y;return n*n+i*i}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,n){return this.x+=(e.x-this.x)*n,this.y+=(e.y-this.y)*n,this}lerpVectors(e,n,i){return this.x=e.x+(n.x-e.x)*i,this.y=e.y+(n.y-e.y)*i,this}equals(e){return e.x===this.x&&e.y===this.y}fromArray(e,n=0){return this.x=e[n],this.y=e[n+1],this}toArray(e=[],n=0){return e[n]=this.x,e[n+1]=this.y,e}fromBufferAttribute(e,n){return this.x=e.getX(n),this.y=e.getY(n),this}rotateAround(e,n){const i=Math.cos(n),r=Math.sin(n),s=this.x-e.x,a=this.y-e.y;return this.x=s*i-a*r+e.x,this.y=s*r+a*i+e.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}}class Qi{constructor(e,n,i,r,s,a,o,c,l){Qi.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1],e!==void 0&&this.set(e,n,i,r,s,a,o,c,l)}set(e,n,i,r,s,a,o,c,l){const u=this.elements;return u[0]=e,u[1]=r,u[2]=o,u[3]=n,u[4]=s,u[5]=c,u[6]=i,u[7]=a,u[8]=l,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(e){const n=this.elements,i=e.elements;return n[0]=i[0],n[1]=i[1],n[2]=i[2],n[3]=i[3],n[4]=i[4],n[5]=i[5],n[6]=i[6],n[7]=i[7],n[8]=i[8],this}extractBasis(e,n,i){return e.setFromMatrix3Column(this,0),n.setFromMatrix3Column(this,1),i.setFromMatrix3Column(this,2),this}setFromMatrix4(e){const n=e.elements;return this.set(n[0],n[4],n[8],n[1],n[5],n[9],n[2],n[6],n[10]),this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,n){const i=e.elements,r=n.elements,s=this.elements,a=i[0],o=i[3],c=i[6],l=i[1],u=i[4],h=i[7],d=i[2],f=i[5],p=i[8],g=r[0],_=r[3],v=r[6],b=r[1],S=r[4],x=r[7],M=r[2],R=r[5],I=r[8];return s[0]=a*g+o*b+c*M,s[3]=a*_+o*S+c*R,s[6]=a*v+o*x+c*I,s[1]=l*g+u*b+h*M,s[4]=l*_+u*S+h*R,s[7]=l*v+u*x+h*I,s[2]=d*g+f*b+p*M,s[5]=d*_+f*S+p*R,s[8]=d*v+f*x+p*I,this}multiplyScalar(e){const n=this.elements;return n[0]*=e,n[3]*=e,n[6]*=e,n[1]*=e,n[4]*=e,n[7]*=e,n[2]*=e,n[5]*=e,n[8]*=e,this}determinant(){const e=this.elements,n=e[0],i=e[1],r=e[2],s=e[3],a=e[4],o=e[5],c=e[6],l=e[7],u=e[8];return n*a*u-n*o*l-i*s*u+i*o*c+r*s*l-r*a*c}invert(){const e=this.elements,n=e[0],i=e[1],r=e[2],s=e[3],a=e[4],o=e[5],c=e[6],l=e[7],u=e[8],h=u*a-o*l,d=o*c-u*s,f=l*s-a*c,p=n*h+i*d+r*f;if(p===0)return this.set(0,0,0,0,0,0,0,0,0);const g=1/p;return e[0]=h*g,e[1]=(r*l-u*i)*g,e[2]=(o*i-r*a)*g,e[3]=d*g,e[4]=(u*n-r*c)*g,e[5]=(r*s-o*n)*g,e[6]=f*g,e[7]=(i*c-l*n)*g,e[8]=(a*n-i*s)*g,this}transpose(){let e;const n=this.elements;return e=n[1],n[1]=n[3],n[3]=e,e=n[2],n[2]=n[6],n[6]=e,e=n[5],n[5]=n[7],n[7]=e,this}getNormalMatrix(e){return this.setFromMatrix4(e).invert().transpose()}transposeIntoArray(e){const n=this.elements;return e[0]=n[0],e[1]=n[3],e[2]=n[6],e[3]=n[1],e[4]=n[4],e[5]=n[7],e[6]=n[2],e[7]=n[5],e[8]=n[8],this}setUvTransform(e,n,i,r,s,a,o){const c=Math.cos(s),l=Math.sin(s);return this.set(i*c,i*l,-i*(c*a+l*o)+a+e,-r*l,r*c,-r*(-l*a+c*o)+o+n,0,0,1),this}scale(e,n){return this.premultiply(f5.makeScale(e,n)),this}rotate(e){return this.premultiply(f5.makeRotation(-e)),this}translate(e,n){return this.premultiply(f5.makeTranslation(e,n)),this}makeTranslation(e,n){return e.isVector2?this.set(1,0,e.x,0,1,e.y,0,0,1):this.set(1,0,e,0,1,n,0,0,1),this}makeRotation(e){const n=Math.cos(e),i=Math.sin(e);return this.set(n,-i,0,i,n,0,0,0,1),this}makeScale(e,n){return this.set(e,0,0,0,n,0,0,0,1),this}equals(e){const n=this.elements,i=e.elements;for(let r=0;r<9;r++)if(n[r]!==i[r])return!1;return!0}fromArray(e,n=0){for(let i=0;i<9;i++)this.elements[i]=e[i+n];return this}toArray(e=[],n=0){const i=this.elements;return e[n]=i[0],e[n+1]=i[1],e[n+2]=i[2],e[n+3]=i[3],e[n+4]=i[4],e[n+5]=i[5],e[n+6]=i[6],e[n+7]=i[7],e[n+8]=i[8],e}clone(){return new this.constructor().fromArray(this.elements)}}const f5=new Qi;function Hle(t){for(let e=t.length-1;e>=0;--e)if(t[e]>=65535)return!0;return!1}const sAe={Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array};function Fw(t,e){return new sAe[t](e)}function ZO(t){return document.createElementNS("http://www.w3.org/1999/xhtml",t)}function Vle(){const t=ZO("canvas");return t.style.display="block",t}const eJ={};function P2(t){t in eJ||(eJ[t]=!0,console.warn(t))}function aAe(t,e,n){return new Promise(function(i,r){function s(){switch(t.clientWaitSync(e,t.SYNC_FLUSH_COMMANDS_BIT,0)){case t.WAIT_FAILED:r();break;case t.TIMEOUT_EXPIRED:setTimeout(s,n);break;default:i()}}setTimeout(s,n)})}function oAe(t){const e=t.elements;e[2]=.5*e[2]+.5*e[3],e[6]=.5*e[6]+.5*e[7],e[10]=.5*e[10]+.5*e[11],e[14]=.5*e[14]+.5*e[15]}function cAe(t){const e=t.elements;e[11]===-1?(e[10]=-e[10]-1,e[14]=-e[14]):(e[10]=-e[10],e[14]=-e[14]+1)}const tJ=new Qi().set(.4123908,.3575843,.1804808,.212639,.7151687,.0721923,.0193308,.1191948,.9505322),nJ=new Qi().set(3.2409699,-1.5373832,-.4986108,-.9692436,1.8759675,.0415551,.0556301,-.203977,1.0569715);function lAe(){const t={enabled:!0,workingColorSpace:a0,spaces:{},convert:function(r,s,a){return this.enabled===!1||s===a||!s||!a||(this.spaces[s].transfer===Ns&&(r.r=h_(r.r),r.g=h_(r.g),r.b=h_(r.b)),this.spaces[s].primaries!==this.spaces[a].primaries&&(r.applyMatrix3(this.spaces[s].toXYZ),r.applyMatrix3(this.spaces[a].fromXYZ)),this.spaces[a].transfer===Ns&&(r.r=uC(r.r),r.g=uC(r.g),r.b=uC(r.b))),r},fromWorkingColorSpace:function(r,s){return this.convert(r,this.workingColorSpace,s)},toWorkingColorSpace:function(r,s){return this.convert(r,s,this.workingColorSpace)},getPrimaries:function(r){return this.spaces[r].primaries},getTransfer:function(r){return r===gm?YO:this.spaces[r].transfer},getLuminanceCoefficients:function(r,s=this.workingColorSpace){return r.fromArray(this.spaces[s].luminanceCoefficients)},define:function(r){Object.assign(this.spaces,r)},_getMatrix:function(r,s,a){return r.copy(this.spaces[s].toXYZ).multiply(this.spaces[a].fromXYZ)},_getDrawingBufferColorSpace:function(r){return this.spaces[r].outputColorSpaceConfig.drawingBufferColorSpace},_getUnpackColorSpace:function(r=this.workingColorSpace){return this.spaces[r].workingColorSpaceConfig.unpackColorSpace}},e=[.64,.33,.3,.6,.15,.06],n=[.2126,.7152,.0722],i=[.3127,.329];return t.define({[a0]:{primaries:e,whitePoint:i,transfer:YO,toXYZ:tJ,fromXYZ:nJ,luminanceCoefficients:n,workingColorSpaceConfig:{unpackColorSpace:ls},outputColorSpaceConfig:{drawingBufferColorSpace:ls}},[ls]:{primaries:e,whitePoint:i,transfer:Ns,toXYZ:tJ,fromXYZ:nJ,luminanceCoefficients:n,outputColorSpaceConfig:{drawingBufferColorSpace:ls}}}),t}const Br=lAe();function h_(t){return t<.04045?t*.0773993808:Math.pow(t*.9478672986+.0521327014,2.4)}function uC(t){return t<.0031308?t*12.92:1.055*Math.pow(t,.41666)-.055}let Ux;class Gle{static getDataURL(e,n="image/png"){if(/^data:/i.test(e.src)||typeof HTMLCanvasElement>"u")return e.src;let i;if(e instanceof HTMLCanvasElement)i=e;else{Ux===void 0&&(Ux=ZO("canvas")),Ux.width=e.width,Ux.height=e.height;const r=Ux.getContext("2d");e instanceof ImageData?r.putImageData(e,0,0):r.drawImage(e,0,0,e.width,e.height),i=Ux}return i.toDataURL(n)}static sRGBToLinear(e){if(typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&e instanceof ImageBitmap){const n=ZO("canvas");n.width=e.width,n.height=e.height;const i=n.getContext("2d");i.drawImage(e,0,0,e.width,e.height);const r=i.getImageData(0,0,e.width,e.height),s=r.data;for(let a=0;a<s.length;a++)s[a]=h_(s[a]/255)*255;return i.putImageData(r,0,0),n}else if(e.data){const n=e.data.slice(0);for(let i=0;i<n.length;i++)n instanceof Uint8Array||n instanceof Uint8ClampedArray?n[i]=Math.floor(h_(n[i]/255)*255):n[i]=h_(n[i]);return{data:n,width:e.width,height:e.height}}else return console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),e}}let uAe=0,Eb=class{constructor(e=null){this.isSource=!0,Object.defineProperty(this,"id",{value:uAe++}),this.uuid=cf(),this.data=e,this.dataReady=!0,this.version=0}set needsUpdate(e){e===!0&&this.version++}toJSON(e){const n=e===void 0||typeof e=="string";if(!n&&e.images[this.uuid]!==void 0)return e.images[this.uuid];const i={uuid:this.uuid,url:""},r=this.data;if(r!==null){let s;if(Array.isArray(r)){s=[];for(let a=0,o=r.length;a<o;a++)r[a].isDataTexture?s.push(p5(r[a].image)):s.push(p5(r[a]))}else s=p5(r);i.url=s}return n||(e.images[this.uuid]=i),i}};function p5(t){return typeof HTMLImageElement<"u"&&t instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&t instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&t instanceof ImageBitmap?Gle.getDataURL(t):t.data?{data:Array.from(t.data),width:t.width,height:t.height,type:t.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}let hAe=0;class Ga extends _f{constructor(e=Ga.DEFAULT_IMAGE,n=Ga.DEFAULT_MAPPING,i=cp,r=cp,s=Ca,a=Hg,o=Wc,c=lo,l=Ga.DEFAULT_ANISOTROPY,u=gm){super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:hAe++}),this.uuid=cf(),this.name="",this.source=new Eb(e),this.mipmaps=[],this.mapping=n,this.channel=0,this.wrapS=i,this.wrapT=r,this.magFilter=s,this.minFilter=a,this.anisotropy=l,this.format=o,this.internalFormat=null,this.type=c,this.offset=new xt(0,0),this.repeat=new xt(1,1),this.center=new xt(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new Qi,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.colorSpace=u,this.userData={},this.version=0,this.onUpdate=null,this.renderTarget=null,this.isRenderTargetTexture=!1,this.isTextureArray=!1,this.pmremVersion=0}get image(){return this.source.data}set image(e=null){this.source.data=e}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return new this.constructor().copy(this)}copy(e){return this.name=e.name,this.source=e.source,this.mipmaps=e.mipmaps.slice(0),this.mapping=e.mapping,this.channel=e.channel,this.wrapS=e.wrapS,this.wrapT=e.wrapT,this.magFilter=e.magFilter,this.minFilter=e.minFilter,this.anisotropy=e.anisotropy,this.format=e.format,this.internalFormat=e.internalFormat,this.type=e.type,this.offset.copy(e.offset),this.repeat.copy(e.repeat),this.center.copy(e.center),this.rotation=e.rotation,this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrix.copy(e.matrix),this.generateMipmaps=e.generateMipmaps,this.premultiplyAlpha=e.premultiplyAlpha,this.flipY=e.flipY,this.unpackAlignment=e.unpackAlignment,this.colorSpace=e.colorSpace,this.renderTarget=e.renderTarget,this.isRenderTargetTexture=e.isRenderTargetTexture,this.isTextureArray=e.isTextureArray,this.userData=JSON.parse(JSON.stringify(e.userData)),this.needsUpdate=!0,this}toJSON(e){const n=e===void 0||typeof e=="string";if(!n&&e.textures[this.uuid]!==void 0)return e.textures[this.uuid];const i={metadata:{version:4.6,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(e).uuid,mapping:this.mapping,channel:this.channel,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,internalFormat:this.internalFormat,type:this.type,colorSpace:this.colorSpace,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,generateMipmaps:this.generateMipmaps,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return Object.keys(this.userData).length>0&&(i.userData=this.userData),n||(e.textures[this.uuid]=i),i}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(e){if(this.mapping!==ZB)return e;if(e.applyMatrix3(this.matrix),e.x<0||e.x>1)switch(this.wrapS){case UC:e.x=e.x-Math.floor(e.x);break;case cp:e.x=e.x<0?0:1;break;case qO:Math.abs(Math.floor(e.x)%2)===1?e.x=Math.ceil(e.x)-e.x:e.x=e.x-Math.floor(e.x);break}if(e.y<0||e.y>1)switch(this.wrapT){case UC:e.y=e.y-Math.floor(e.y);break;case cp:e.y=e.y<0?0:1;break;case qO:Math.abs(Math.floor(e.y)%2)===1?e.y=Math.ceil(e.y)-e.y:e.y=e.y-Math.floor(e.y);break}return this.flipY&&(e.y=1-e.y),e}set needsUpdate(e){e===!0&&(this.version++,this.source.needsUpdate=!0)}set needsPMREMUpdate(e){e===!0&&this.pmremVersion++}}Ga.DEFAULT_IMAGE=null;Ga.DEFAULT_MAPPING=ZB;Ga.DEFAULT_ANISOTROPY=1;class zr{constructor(e=0,n=0,i=0,r=1){zr.prototype.isVector4=!0,this.x=e,this.y=n,this.z=i,this.w=r}get width(){return this.z}set width(e){this.z=e}get height(){return this.w}set height(e){this.w=e}set(e,n,i,r){return this.x=e,this.y=n,this.z=i,this.w=r,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this.w=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setW(e){return this.w=e,this}setComponent(e,n){switch(e){case 0:this.x=n;break;case 1:this.y=n;break;case 2:this.z=n;break;case 3:this.w=n;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=e.w!==void 0?e.w:1,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this}addVectors(e,n){return this.x=e.x+n.x,this.y=e.y+n.y,this.z=e.z+n.z,this.w=e.w+n.w,this}addScaledVector(e,n){return this.x+=e.x*n,this.y+=e.y*n,this.z+=e.z*n,this.w+=e.w*n,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this}subVectors(e,n){return this.x=e.x-n.x,this.y=e.y-n.y,this.z=e.z-n.z,this.w=e.w-n.w,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this.w*=e.w,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this}applyMatrix4(e){const n=this.x,i=this.y,r=this.z,s=this.w,a=e.elements;return this.x=a[0]*n+a[4]*i+a[8]*r+a[12]*s,this.y=a[1]*n+a[5]*i+a[9]*r+a[13]*s,this.z=a[2]*n+a[6]*i+a[10]*r+a[14]*s,this.w=a[3]*n+a[7]*i+a[11]*r+a[15]*s,this}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this.w/=e.w,this}divideScalar(e){return this.multiplyScalar(1/e)}setAxisAngleFromQuaternion(e){this.w=2*Math.acos(e.w);const n=Math.sqrt(1-e.w*e.w);return n<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/n,this.y=e.y/n,this.z=e.z/n),this}setAxisAngleFromRotationMatrix(e){let n,i,r,s;const c=e.elements,l=c[0],u=c[4],h=c[8],d=c[1],f=c[5],p=c[9],g=c[2],_=c[6],v=c[10];if(Math.abs(u-d)<.01&&Math.abs(h-g)<.01&&Math.abs(p-_)<.01){if(Math.abs(u+d)<.1&&Math.abs(h+g)<.1&&Math.abs(p+_)<.1&&Math.abs(l+f+v-3)<.1)return this.set(1,0,0,0),this;n=Math.PI;const S=(l+1)/2,x=(f+1)/2,M=(v+1)/2,R=(u+d)/4,I=(h+g)/4,k=(p+_)/4;return S>x&&S>M?S<.01?(i=0,r=.707106781,s=.707106781):(i=Math.sqrt(S),r=R/i,s=I/i):x>M?x<.01?(i=.707106781,r=0,s=.707106781):(r=Math.sqrt(x),i=R/r,s=k/r):M<.01?(i=.707106781,r=.707106781,s=0):(s=Math.sqrt(M),i=I/s,r=k/s),this.set(i,r,s,n),this}let b=Math.sqrt((_-p)*(_-p)+(h-g)*(h-g)+(d-u)*(d-u));return Math.abs(b)<.001&&(b=1),this.x=(_-p)/b,this.y=(h-g)/b,this.z=(d-u)/b,this.w=Math.acos((l+f+v-1)/2),this}setFromMatrixPosition(e){const n=e.elements;return this.x=n[12],this.y=n[13],this.z=n[14],this.w=n[15],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this}clamp(e,n){return this.x=Ki(this.x,e.x,n.x),this.y=Ki(this.y,e.y,n.y),this.z=Ki(this.z,e.z,n.z),this.w=Ki(this.w,e.w,n.w),this}clampScalar(e,n){return this.x=Ki(this.x,e,n),this.y=Ki(this.y,e,n),this.z=Ki(this.z,e,n),this.w=Ki(this.w,e,n),this}clampLength(e,n){const i=this.length();return this.divideScalar(i||1).multiplyScalar(Ki(i,e,n))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this.w=Math.trunc(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,n){return this.x+=(e.x-this.x)*n,this.y+=(e.y-this.y)*n,this.z+=(e.z-this.z)*n,this.w+=(e.w-this.w)*n,this}lerpVectors(e,n,i){return this.x=e.x+(n.x-e.x)*i,this.y=e.y+(n.y-e.y)*i,this.z=e.z+(n.z-e.z)*i,this.w=e.w+(n.w-e.w)*i,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w}fromArray(e,n=0){return this.x=e[n],this.y=e[n+1],this.z=e[n+2],this.w=e[n+3],this}toArray(e=[],n=0){return e[n]=this.x,e[n+1]=this.y,e[n+2]=this.z,e[n+3]=this.w,e}fromBufferAttribute(e,n){return this.x=e.getX(n),this.y=e.getY(n),this.z=e.getZ(n),this.w=e.getW(n),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}}class rF extends _f{constructor(e=1,n=1,i={}){super(),this.isRenderTarget=!0,this.width=e,this.height=n,this.depth=i.depth?i.depth:1,this.scissor=new zr(0,0,e,n),this.scissorTest=!1,this.viewport=new zr(0,0,e,n);const r={width:e,height:n,depth:this.depth};i=Object.assign({generateMipmaps:!1,internalFormat:null,minFilter:Ca,depthBuffer:!0,stencilBuffer:!1,resolveDepthBuffer:!0,resolveStencilBuffer:!0,depthTexture:null,samples:0,count:1,multiview:!1},i);const s=new Ga(r,i.mapping,i.wrapS,i.wrapT,i.magFilter,i.minFilter,i.format,i.type,i.anisotropy,i.colorSpace);s.flipY=!1,s.generateMipmaps=i.generateMipmaps,s.internalFormat=i.internalFormat,this.textures=[];const a=i.count;for(let o=0;o<a;o++)this.textures[o]=s.clone(),this.textures[o].isRenderTargetTexture=!0,this.textures[o].renderTarget=this;this.depthBuffer=i.depthBuffer,this.stencilBuffer=i.stencilBuffer,this.resolveDepthBuffer=i.resolveDepthBuffer,this.resolveStencilBuffer=i.resolveStencilBuffer,this._depthTexture=null,this.depthTexture=i.depthTexture,this.samples=i.samples,this.multiview=i.multiview}get texture(){return this.textures[0]}set texture(e){this.textures[0]=e}set depthTexture(e){this._depthTexture!==null&&(this._depthTexture.renderTarget=null),e!==null&&(e.renderTarget=this),this._depthTexture=e}get depthTexture(){return this._depthTexture}setSize(e,n,i=1){if(this.width!==e||this.height!==n||this.depth!==i){this.width=e,this.height=n,this.depth=i;for(let r=0,s=this.textures.length;r<s;r++)this.textures[r].image.width=e,this.textures[r].image.height=n,this.textures[r].image.depth=i;this.dispose()}this.viewport.set(0,0,e,n),this.scissor.set(0,0,e,n)}clone(){return new this.constructor().copy(this)}copy(e){this.width=e.width,this.height=e.height,this.depth=e.depth,this.scissor.copy(e.scissor),this.scissorTest=e.scissorTest,this.viewport.copy(e.viewport),this.textures.length=0;for(let n=0,i=e.textures.length;n<i;n++){this.textures[n]=e.textures[n].clone(),this.textures[n].isRenderTargetTexture=!0,this.textures[n].renderTarget=this;const r=Object.assign({},e.textures[n].image);this.textures[n].source=new Eb(r)}return this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,this.resolveDepthBuffer=e.resolveDepthBuffer,this.resolveStencilBuffer=e.resolveStencilBuffer,e.depthTexture!==null&&(this.depthTexture=e.depthTexture.clone()),this.samples=e.samples,this}dispose(){this.dispatchEvent({type:"dispose"})}}class Ko extends rF{constructor(e=1,n=1,i={}){super(e,n,i),this.isWebGLRenderTarget=!0}}class PI extends Ga{constructor(e=null,n=1,i=1,r=1){super(null),this.isDataArrayTexture=!0,this.image={data:e,width:n,height:i,depth:r},this.magFilter=Va,this.minFilter=Va,this.wrapR=cp,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1,this.layerUpdates=new Set}addLayerUpdate(e){this.layerUpdates.add(e)}clearLayerUpdates(){this.layerUpdates.clear()}}class dAe extends Ko{constructor(e=1,n=1,i=1,r={}){super(e,n,r),this.isWebGLArrayRenderTarget=!0,this.depth=i,this.texture=new PI(null,e,n,i),this.texture.isRenderTargetTexture=!0}}class sF extends Ga{constructor(e=null,n=1,i=1,r=1){super(null),this.isData3DTexture=!0,this.image={data:e,width:n,height:i,depth:r},this.magFilter=Va,this.minFilter=Va,this.wrapR=cp,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class fAe extends Ko{constructor(e=1,n=1,i=1,r={}){super(e,n,r),this.isWebGL3DRenderTarget=!0,this.depth=i,this.texture=new sF(null,e,n,i),this.texture.isRenderTargetTexture=!0}}class mh{constructor(e=0,n=0,i=0,r=1){this.isQuaternion=!0,this._x=e,this._y=n,this._z=i,this._w=r}static slerpFlat(e,n,i,r,s,a,o){let c=i[r+0],l=i[r+1],u=i[r+2],h=i[r+3];const d=s[a+0],f=s[a+1],p=s[a+2],g=s[a+3];if(o===0){e[n+0]=c,e[n+1]=l,e[n+2]=u,e[n+3]=h;return}if(o===1){e[n+0]=d,e[n+1]=f,e[n+2]=p,e[n+3]=g;return}if(h!==g||c!==d||l!==f||u!==p){let _=1-o;const v=c*d+l*f+u*p+h*g,b=v>=0?1:-1,S=1-v*v;if(S>Number.EPSILON){const M=Math.sqrt(S),R=Math.atan2(M,v*b);_=Math.sin(_*R)/M,o=Math.sin(o*R)/M}const x=o*b;if(c=c*_+d*x,l=l*_+f*x,u=u*_+p*x,h=h*_+g*x,_===1-o){const M=1/Math.sqrt(c*c+l*l+u*u+h*h);c*=M,l*=M,u*=M,h*=M}}e[n]=c,e[n+1]=l,e[n+2]=u,e[n+3]=h}static multiplyQuaternionsFlat(e,n,i,r,s,a){const o=i[r],c=i[r+1],l=i[r+2],u=i[r+3],h=s[a],d=s[a+1],f=s[a+2],p=s[a+3];return e[n]=o*p+u*h+c*f-l*d,e[n+1]=c*p+u*d+l*h-o*f,e[n+2]=l*p+u*f+o*d-c*h,e[n+3]=u*p-o*h-c*d-l*f,e}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get w(){return this._w}set w(e){this._w=e,this._onChangeCallback()}set(e,n,i,r){return this._x=e,this._y=n,this._z=i,this._w=r,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this}setFromEuler(e,n=!0){const i=e._x,r=e._y,s=e._z,a=e._order,o=Math.cos,c=Math.sin,l=o(i/2),u=o(r/2),h=o(s/2),d=c(i/2),f=c(r/2),p=c(s/2);switch(a){case"XYZ":this._x=d*u*h+l*f*p,this._y=l*f*h-d*u*p,this._z=l*u*p+d*f*h,this._w=l*u*h-d*f*p;break;case"YXZ":this._x=d*u*h+l*f*p,this._y=l*f*h-d*u*p,this._z=l*u*p-d*f*h,this._w=l*u*h+d*f*p;break;case"ZXY":this._x=d*u*h-l*f*p,this._y=l*f*h+d*u*p,this._z=l*u*p+d*f*h,this._w=l*u*h-d*f*p;break;case"ZYX":this._x=d*u*h-l*f*p,this._y=l*f*h+d*u*p,this._z=l*u*p-d*f*h,this._w=l*u*h+d*f*p;break;case"YZX":this._x=d*u*h+l*f*p,this._y=l*f*h+d*u*p,this._z=l*u*p-d*f*h,this._w=l*u*h-d*f*p;break;case"XZY":this._x=d*u*h-l*f*p,this._y=l*f*h-d*u*p,this._z=l*u*p+d*f*h,this._w=l*u*h+d*f*p;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+a)}return n===!0&&this._onChangeCallback(),this}setFromAxisAngle(e,n){const i=n/2,r=Math.sin(i);return this._x=e.x*r,this._y=e.y*r,this._z=e.z*r,this._w=Math.cos(i),this._onChangeCallback(),this}setFromRotationMatrix(e){const n=e.elements,i=n[0],r=n[4],s=n[8],a=n[1],o=n[5],c=n[9],l=n[2],u=n[6],h=n[10],d=i+o+h;if(d>0){const f=.5/Math.sqrt(d+1);this._w=.25/f,this._x=(u-c)*f,this._y=(s-l)*f,this._z=(a-r)*f}else if(i>o&&i>h){const f=2*Math.sqrt(1+i-o-h);this._w=(u-c)/f,this._x=.25*f,this._y=(r+a)/f,this._z=(s+l)/f}else if(o>h){const f=2*Math.sqrt(1+o-i-h);this._w=(s-l)/f,this._x=(r+a)/f,this._y=.25*f,this._z=(c+u)/f}else{const f=2*Math.sqrt(1+h-i-o);this._w=(a-r)/f,this._x=(s+l)/f,this._y=(c+u)/f,this._z=.25*f}return this._onChangeCallback(),this}setFromUnitVectors(e,n){let i=e.dot(n)+1;return i<Number.EPSILON?(i=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0,this._w=i):(this._x=0,this._y=-e.z,this._z=e.y,this._w=i)):(this._x=e.y*n.z-e.z*n.y,this._y=e.z*n.x-e.x*n.z,this._z=e.x*n.y-e.y*n.x,this._w=i),this.normalize()}angleTo(e){return 2*Math.acos(Math.abs(Ki(this.dot(e),-1,1)))}rotateTowards(e,n){const i=this.angleTo(e);if(i===0)return this;const r=Math.min(1,n/i);return this.slerp(e,r),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let e=this.length();return e===0?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this}multiply(e){return this.multiplyQuaternions(this,e)}premultiply(e){return this.multiplyQuaternions(e,this)}multiplyQuaternions(e,n){const i=e._x,r=e._y,s=e._z,a=e._w,o=n._x,c=n._y,l=n._z,u=n._w;return this._x=i*u+a*o+r*l-s*c,this._y=r*u+a*c+s*o-i*l,this._z=s*u+a*l+i*c-r*o,this._w=a*u-i*o-r*c-s*l,this._onChangeCallback(),this}slerp(e,n){if(n===0)return this;if(n===1)return this.copy(e);const i=this._x,r=this._y,s=this._z,a=this._w;let o=a*e._w+i*e._x+r*e._y+s*e._z;if(o<0?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,o=-o):this.copy(e),o>=1)return this._w=a,this._x=i,this._y=r,this._z=s,this;const c=1-o*o;if(c<=Number.EPSILON){const f=1-n;return this._w=f*a+n*this._w,this._x=f*i+n*this._x,this._y=f*r+n*this._y,this._z=f*s+n*this._z,this.normalize(),this}const l=Math.sqrt(c),u=Math.atan2(l,o),h=Math.sin((1-n)*u)/l,d=Math.sin(n*u)/l;return this._w=a*h+this._w*d,this._x=i*h+this._x*d,this._y=r*h+this._y*d,this._z=s*h+this._z*d,this._onChangeCallback(),this}slerpQuaternions(e,n,i){return this.copy(e).slerp(n,i)}random(){const e=2*Math.PI*Math.random(),n=2*Math.PI*Math.random(),i=Math.random(),r=Math.sqrt(1-i),s=Math.sqrt(i);return this.set(r*Math.sin(e),r*Math.cos(e),s*Math.sin(n),s*Math.cos(n))}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w}fromArray(e,n=0){return this._x=e[n],this._y=e[n+1],this._z=e[n+2],this._w=e[n+3],this._onChangeCallback(),this}toArray(e=[],n=0){return e[n]=this._x,e[n+1]=this._y,e[n+2]=this._z,e[n+3]=this._w,e}fromBufferAttribute(e,n){return this._x=e.getX(n),this._y=e.getY(n),this._z=e.getZ(n),this._w=e.getW(n),this._onChangeCallback(),this}toJSON(){return this.toArray()}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}}class Oe{constructor(e=0,n=0,i=0){Oe.prototype.isVector3=!0,this.x=e,this.y=n,this.z=i}set(e,n,i){return i===void 0&&(i=this.z),this.x=e,this.y=n,this.z=i,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setComponent(e,n){switch(e){case 0:this.x=n;break;case 1:this.y=n;break;case 2:this.z=n;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this}addVectors(e,n){return this.x=e.x+n.x,this.y=e.y+n.y,this.z=e.z+n.z,this}addScaledVector(e,n){return this.x+=e.x*n,this.y+=e.y*n,this.z+=e.z*n,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this}subVectors(e,n){return this.x=e.x-n.x,this.y=e.y-n.y,this.z=e.z-n.z,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this}multiplyVectors(e,n){return this.x=e.x*n.x,this.y=e.y*n.y,this.z=e.z*n.z,this}applyEuler(e){return this.applyQuaternion(iJ.setFromEuler(e))}applyAxisAngle(e,n){return this.applyQuaternion(iJ.setFromAxisAngle(e,n))}applyMatrix3(e){const n=this.x,i=this.y,r=this.z,s=e.elements;return this.x=s[0]*n+s[3]*i+s[6]*r,this.y=s[1]*n+s[4]*i+s[7]*r,this.z=s[2]*n+s[5]*i+s[8]*r,this}applyNormalMatrix(e){return this.applyMatrix3(e).normalize()}applyMatrix4(e){const n=this.x,i=this.y,r=this.z,s=e.elements,a=1/(s[3]*n+s[7]*i+s[11]*r+s[15]);return this.x=(s[0]*n+s[4]*i+s[8]*r+s[12])*a,this.y=(s[1]*n+s[5]*i+s[9]*r+s[13])*a,this.z=(s[2]*n+s[6]*i+s[10]*r+s[14])*a,this}applyQuaternion(e){const n=this.x,i=this.y,r=this.z,s=e.x,a=e.y,o=e.z,c=e.w,l=2*(a*r-o*i),u=2*(o*n-s*r),h=2*(s*i-a*n);return this.x=n+c*l+a*h-o*u,this.y=i+c*u+o*l-s*h,this.z=r+c*h+s*u-a*l,this}project(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)}unproject(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)}transformDirection(e){const n=this.x,i=this.y,r=this.z,s=e.elements;return this.x=s[0]*n+s[4]*i+s[8]*r,this.y=s[1]*n+s[5]*i+s[9]*r,this.z=s[2]*n+s[6]*i+s[10]*r,this.normalize()}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this}divideScalar(e){return this.multiplyScalar(1/e)}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this}clamp(e,n){return this.x=Ki(this.x,e.x,n.x),this.y=Ki(this.y,e.y,n.y),this.z=Ki(this.z,e.z,n.z),this}clampScalar(e,n){return this.x=Ki(this.x,e,n),this.y=Ki(this.y,e,n),this.z=Ki(this.z,e,n),this}clampLength(e,n){const i=this.length();return this.divideScalar(i||1).multiplyScalar(Ki(i,e,n))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,n){return this.x+=(e.x-this.x)*n,this.y+=(e.y-this.y)*n,this.z+=(e.z-this.z)*n,this}lerpVectors(e,n,i){return this.x=e.x+(n.x-e.x)*i,this.y=e.y+(n.y-e.y)*i,this.z=e.z+(n.z-e.z)*i,this}cross(e){return this.crossVectors(this,e)}crossVectors(e,n){const i=e.x,r=e.y,s=e.z,a=n.x,o=n.y,c=n.z;return this.x=r*c-s*o,this.y=s*a-i*c,this.z=i*o-r*a,this}projectOnVector(e){const n=e.lengthSq();if(n===0)return this.set(0,0,0);const i=e.dot(this)/n;return this.copy(e).multiplyScalar(i)}projectOnPlane(e){return m5.copy(this).projectOnVector(e),this.sub(m5)}reflect(e){return this.sub(m5.copy(e).multiplyScalar(2*this.dot(e)))}angleTo(e){const n=Math.sqrt(this.lengthSq()*e.lengthSq());if(n===0)return Math.PI/2;const i=this.dot(e)/n;return Math.acos(Ki(i,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const n=this.x-e.x,i=this.y-e.y,r=this.z-e.z;return n*n+i*i+r*r}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)}setFromSpherical(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)}setFromSphericalCoords(e,n,i){const r=Math.sin(n)*e;return this.x=r*Math.sin(i),this.y=Math.cos(n)*e,this.z=r*Math.cos(i),this}setFromCylindrical(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)}setFromCylindricalCoords(e,n,i){return this.x=e*Math.sin(n),this.y=i,this.z=e*Math.cos(n),this}setFromMatrixPosition(e){const n=e.elements;return this.x=n[12],this.y=n[13],this.z=n[14],this}setFromMatrixScale(e){const n=this.setFromMatrixColumn(e,0).length(),i=this.setFromMatrixColumn(e,1).length(),r=this.setFromMatrixColumn(e,2).length();return this.x=n,this.y=i,this.z=r,this}setFromMatrixColumn(e,n){return this.fromArray(e.elements,n*4)}setFromMatrix3Column(e,n){return this.fromArray(e.elements,n*3)}setFromEuler(e){return this.x=e._x,this.y=e._y,this.z=e._z,this}setFromColor(e){return this.x=e.r,this.y=e.g,this.z=e.b,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z}fromArray(e,n=0){return this.x=e[n],this.y=e[n+1],this.z=e[n+2],this}toArray(e=[],n=0){return e[n]=this.x,e[n+1]=this.y,e[n+2]=this.z,e}fromBufferAttribute(e,n){return this.x=e.getX(n),this.y=e.getY(n),this.z=e.getZ(n),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){const e=Math.random()*Math.PI*2,n=Math.random()*2-1,i=Math.sqrt(1-n*n);return this.x=i*Math.cos(e),this.y=n,this.z=i*Math.sin(e),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}}const m5=new Oe,iJ=new mh;class Su{constructor(e=new Oe(1/0,1/0,1/0),n=new Oe(-1/0,-1/0,-1/0)){this.isBox3=!0,this.min=e,this.max=n}set(e,n){return this.min.copy(e),this.max.copy(n),this}setFromArray(e){this.makeEmpty();for(let n=0,i=e.length;n<i;n+=3)this.expandByPoint(im.fromArray(e,n));return this}setFromBufferAttribute(e){this.makeEmpty();for(let n=0,i=e.count;n<i;n++)this.expandByPoint(im.fromBufferAttribute(e,n));return this}setFromPoints(e){this.makeEmpty();for(let n=0,i=e.length;n<i;n++)this.expandByPoint(e[n]);return this}setFromCenterAndSize(e,n){const i=im.copy(n).multiplyScalar(.5);return this.min.copy(e).sub(i),this.max.copy(e).add(i),this}setFromObject(e,n=!1){return this.makeEmpty(),this.expandByObject(e,n)}clone(){return new this.constructor().copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(e){return this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}expandByObject(e,n=!1){e.updateWorldMatrix(!1,!1);const i=e.geometry;if(i!==void 0){const s=i.getAttribute("position");if(n===!0&&s!==void 0&&e.isInstancedMesh!==!0)for(let a=0,o=s.count;a<o;a++)e.isMesh===!0?e.getVertexPosition(a,im):im.fromBufferAttribute(s,a),im.applyMatrix4(e.matrixWorld),this.expandByPoint(im);else e.boundingBox!==void 0?(e.boundingBox===null&&e.computeBoundingBox(),CP.copy(e.boundingBox)):(i.boundingBox===null&&i.computeBoundingBox(),CP.copy(i.boundingBox)),CP.applyMatrix4(e.matrixWorld),this.union(CP)}const r=e.children;for(let s=0,a=r.length;s<a;s++)this.expandByObject(r[s],n);return this}containsPoint(e){return e.x>=this.min.x&&e.x<=this.max.x&&e.y>=this.min.y&&e.y<=this.max.y&&e.z>=this.min.z&&e.z<=this.max.z}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z}getParameter(e,n){return n.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(e){return e.max.x>=this.min.x&&e.min.x<=this.max.x&&e.max.y>=this.min.y&&e.min.y<=this.max.y&&e.max.z>=this.min.z&&e.min.z<=this.max.z}intersectsSphere(e){return this.clampPoint(e.center,im),im.distanceToSquared(e.center)<=e.radius*e.radius}intersectsPlane(e){let n,i;return e.normal.x>0?(n=e.normal.x*this.min.x,i=e.normal.x*this.max.x):(n=e.normal.x*this.max.x,i=e.normal.x*this.min.x),e.normal.y>0?(n+=e.normal.y*this.min.y,i+=e.normal.y*this.max.y):(n+=e.normal.y*this.max.y,i+=e.normal.y*this.min.y),e.normal.z>0?(n+=e.normal.z*this.min.z,i+=e.normal.z*this.max.z):(n+=e.normal.z*this.max.z,i+=e.normal.z*this.min.z),n<=-e.constant&&i>=-e.constant}intersectsTriangle(e){if(this.isEmpty())return!1;this.getCenter(qR),AP.subVectors(this.max,qR),Bx.subVectors(e.a,qR),Fx.subVectors(e.b,qR),zx.subVectors(e.c,qR),Oy.subVectors(Fx,Bx),Ny.subVectors(zx,Fx),NS.subVectors(Bx,zx);let n=[0,-Oy.z,Oy.y,0,-Ny.z,Ny.y,0,-NS.z,NS.y,Oy.z,0,-Oy.x,Ny.z,0,-Ny.x,NS.z,0,-NS.x,-Oy.y,Oy.x,0,-Ny.y,Ny.x,0,-NS.y,NS.x,0];return!g5(n,Bx,Fx,zx,AP)||(n=[1,0,0,0,1,0,0,0,1],!g5(n,Bx,Fx,zx,AP))?!1:(RP.crossVectors(Oy,Ny),n=[RP.x,RP.y,RP.z],g5(n,Bx,Fx,zx,AP))}clampPoint(e,n){return n.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return this.clampPoint(e,im).distanceTo(e)}getBoundingSphere(e){return this.isEmpty()?e.makeEmpty():(this.getCenter(e.center),e.radius=this.getSize(im).length()*.5),e}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}applyMatrix4(e){return this.isEmpty()?this:(xv[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),xv[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),xv[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),xv[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),xv[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),xv[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),xv[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),xv[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(xv),this)}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}const xv=[new Oe,new Oe,new Oe,new Oe,new Oe,new Oe,new Oe,new Oe],im=new Oe,CP=new Su,Bx=new Oe,Fx=new Oe,zx=new Oe,Oy=new Oe,Ny=new Oe,NS=new Oe,qR=new Oe,AP=new Oe,RP=new Oe,IS=new Oe;function g5(t,e,n,i,r){for(let s=0,a=t.length-3;s<=a;s+=3){IS.fromArray(t,s);const o=r.x*Math.abs(IS.x)+r.y*Math.abs(IS.y)+r.z*Math.abs(IS.z),c=e.dot(IS),l=n.dot(IS),u=i.dot(IS);if(Math.max(-Math.max(c,l,u),Math.min(c,l,u))>o)return!1}return!0}const pAe=new Su,$R=new Oe,v5=new Oe;class Kl{constructor(e=new Oe,n=-1){this.isSphere=!0,this.center=e,this.radius=n}set(e,n){return this.center.copy(e),this.radius=n,this}setFromPoints(e,n){const i=this.center;n!==void 0?i.copy(n):pAe.setFromPoints(e).getCenter(i);let r=0;for(let s=0,a=e.length;s<a;s++)r=Math.max(r,i.distanceToSquared(e[s]));return this.radius=Math.sqrt(r),this}copy(e){return this.center.copy(e.center),this.radius=e.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(e){return e.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(e){return e.distanceTo(this.center)-this.radius}intersectsSphere(e){const n=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=n*n}intersectsBox(e){return e.intersectsSphere(this)}intersectsPlane(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius}clampPoint(e,n){const i=this.center.distanceToSquared(e);return n.copy(e),i>this.radius*this.radius&&(n.sub(this.center).normalize(),n.multiplyScalar(this.radius).add(this.center)),n}getBoundingBox(e){return this.isEmpty()?(e.makeEmpty(),e):(e.set(this.center,this.center),e.expandByScalar(this.radius),e)}applyMatrix4(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this}translate(e){return this.center.add(e),this}expandByPoint(e){if(this.isEmpty())return this.center.copy(e),this.radius=0,this;$R.subVectors(e,this.center);const n=$R.lengthSq();if(n>this.radius*this.radius){const i=Math.sqrt(n),r=(i-this.radius)*.5;this.center.addScaledVector($R,r/i),this.radius+=r}return this}union(e){return e.isEmpty()?this:this.isEmpty()?(this.copy(e),this):(this.center.equals(e.center)===!0?this.radius=Math.max(this.radius,e.radius):(v5.subVectors(e.center,this.center).setLength(e.radius),this.expandByPoint($R.copy(e.center).add(v5)),this.expandByPoint($R.copy(e.center).sub(v5))),this)}equals(e){return e.center.equals(this.center)&&e.radius===this.radius}clone(){return new this.constructor().copy(this)}}const wv=new Oe,_5=new Oe,MP=new Oe,Iy=new Oe,y5=new Oe,OP=new Oe,b5=new Oe;class XA{constructor(e=new Oe,n=new Oe(0,0,-1)){this.origin=e,this.direction=n}set(e,n){return this.origin.copy(e),this.direction.copy(n),this}copy(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this}at(e,n){return n.copy(this.origin).addScaledVector(this.direction,e)}lookAt(e){return this.direction.copy(e).sub(this.origin).normalize(),this}recast(e){return this.origin.copy(this.at(e,wv)),this}closestPointToPoint(e,n){n.subVectors(e,this.origin);const i=n.dot(this.direction);return i<0?n.copy(this.origin):n.copy(this.origin).addScaledVector(this.direction,i)}distanceToPoint(e){return Math.sqrt(this.distanceSqToPoint(e))}distanceSqToPoint(e){const n=wv.subVectors(e,this.origin).dot(this.direction);return n<0?this.origin.distanceToSquared(e):(wv.copy(this.origin).addScaledVector(this.direction,n),wv.distanceToSquared(e))}distanceSqToSegment(e,n,i,r){_5.copy(e).add(n).multiplyScalar(.5),MP.copy(n).sub(e).normalize(),Iy.copy(this.origin).sub(_5);const s=e.distanceTo(n)*.5,a=-this.direction.dot(MP),o=Iy.dot(this.direction),c=-Iy.dot(MP),l=Iy.lengthSq(),u=Math.abs(1-a*a);let h,d,f,p;if(u>0)if(h=a*c-o,d=a*o-c,p=s*u,h>=0)if(d>=-p)if(d<=p){const g=1/u;h*=g,d*=g,f=h*(h+a*d+2*o)+d*(a*h+d+2*c)+l}else d=s,h=Math.max(0,-(a*d+o)),f=-h*h+d*(d+2*c)+l;else d=-s,h=Math.max(0,-(a*d+o)),f=-h*h+d*(d+2*c)+l;else d<=-p?(h=Math.max(0,-(-a*s+o)),d=h>0?-s:Math.min(Math.max(-s,-c),s),f=-h*h+d*(d+2*c)+l):d<=p?(h=0,d=Math.min(Math.max(-s,-c),s),f=d*(d+2*c)+l):(h=Math.max(0,-(a*s+o)),d=h>0?s:Math.min(Math.max(-s,-c),s),f=-h*h+d*(d+2*c)+l);else d=a>0?-s:s,h=Math.max(0,-(a*d+o)),f=-h*h+d*(d+2*c)+l;return i&&i.copy(this.origin).addScaledVector(this.direction,h),r&&r.copy(_5).addScaledVector(MP,d),f}intersectSphere(e,n){wv.subVectors(e.center,this.origin);const i=wv.dot(this.direction),r=wv.dot(wv)-i*i,s=e.radius*e.radius;if(r>s)return null;const a=Math.sqrt(s-r),o=i-a,c=i+a;return c<0?null:o<0?this.at(c,n):this.at(o,n)}intersectsSphere(e){return this.distanceSqToPoint(e.center)<=e.radius*e.radius}distanceToPlane(e){const n=e.normal.dot(this.direction);if(n===0)return e.distanceToPoint(this.origin)===0?0:null;const i=-(this.origin.dot(e.normal)+e.constant)/n;return i>=0?i:null}intersectPlane(e,n){const i=this.distanceToPlane(e);return i===null?null:this.at(i,n)}intersectsPlane(e){const n=e.distanceToPoint(this.origin);return n===0||e.normal.dot(this.direction)*n<0}intersectBox(e,n){let i,r,s,a,o,c;const l=1/this.direction.x,u=1/this.direction.y,h=1/this.direction.z,d=this.origin;return l>=0?(i=(e.min.x-d.x)*l,r=(e.max.x-d.x)*l):(i=(e.max.x-d.x)*l,r=(e.min.x-d.x)*l),u>=0?(s=(e.min.y-d.y)*u,a=(e.max.y-d.y)*u):(s=(e.max.y-d.y)*u,a=(e.min.y-d.y)*u),i>a||s>r||((s>i||isNaN(i))&&(i=s),(a<r||isNaN(r))&&(r=a),h>=0?(o=(e.min.z-d.z)*h,c=(e.max.z-d.z)*h):(o=(e.max.z-d.z)*h,c=(e.min.z-d.z)*h),i>c||o>r)||((o>i||i!==i)&&(i=o),(c<r||r!==r)&&(r=c),r<0)?null:this.at(i>=0?i:r,n)}intersectsBox(e){return this.intersectBox(e,wv)!==null}intersectTriangle(e,n,i,r,s){y5.subVectors(n,e),OP.subVectors(i,e),b5.crossVectors(y5,OP);let a=this.direction.dot(b5),o;if(a>0){if(r)return null;o=1}else if(a<0)o=-1,a=-a;else return null;Iy.subVectors(this.origin,e);const c=o*this.direction.dot(OP.crossVectors(Iy,OP));if(c<0)return null;const l=o*this.direction.dot(y5.cross(Iy));if(l<0||c+l>a)return null;const u=-o*Iy.dot(b5);return u<0?null:this.at(u/a,s)}applyMatrix4(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this}equals(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}clone(){return new this.constructor().copy(this)}}class gi{constructor(e,n,i,r,s,a,o,c,l,u,h,d,f,p,g,_){gi.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],e!==void 0&&this.set(e,n,i,r,s,a,o,c,l,u,h,d,f,p,g,_)}set(e,n,i,r,s,a,o,c,l,u,h,d,f,p,g,_){const v=this.elements;return v[0]=e,v[4]=n,v[8]=i,v[12]=r,v[1]=s,v[5]=a,v[9]=o,v[13]=c,v[2]=l,v[6]=u,v[10]=h,v[14]=d,v[3]=f,v[7]=p,v[11]=g,v[15]=_,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return new gi().fromArray(this.elements)}copy(e){const n=this.elements,i=e.elements;return n[0]=i[0],n[1]=i[1],n[2]=i[2],n[3]=i[3],n[4]=i[4],n[5]=i[5],n[6]=i[6],n[7]=i[7],n[8]=i[8],n[9]=i[9],n[10]=i[10],n[11]=i[11],n[12]=i[12],n[13]=i[13],n[14]=i[14],n[15]=i[15],this}copyPosition(e){const n=this.elements,i=e.elements;return n[12]=i[12],n[13]=i[13],n[14]=i[14],this}setFromMatrix3(e){const n=e.elements;return this.set(n[0],n[3],n[6],0,n[1],n[4],n[7],0,n[2],n[5],n[8],0,0,0,0,1),this}extractBasis(e,n,i){return e.setFromMatrixColumn(this,0),n.setFromMatrixColumn(this,1),i.setFromMatrixColumn(this,2),this}makeBasis(e,n,i){return this.set(e.x,n.x,i.x,0,e.y,n.y,i.y,0,e.z,n.z,i.z,0,0,0,0,1),this}extractRotation(e){const n=this.elements,i=e.elements,r=1/jx.setFromMatrixColumn(e,0).length(),s=1/jx.setFromMatrixColumn(e,1).length(),a=1/jx.setFromMatrixColumn(e,2).length();return n[0]=i[0]*r,n[1]=i[1]*r,n[2]=i[2]*r,n[3]=0,n[4]=i[4]*s,n[5]=i[5]*s,n[6]=i[6]*s,n[7]=0,n[8]=i[8]*a,n[9]=i[9]*a,n[10]=i[10]*a,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,this}makeRotationFromEuler(e){const n=this.elements,i=e.x,r=e.y,s=e.z,a=Math.cos(i),o=Math.sin(i),c=Math.cos(r),l=Math.sin(r),u=Math.cos(s),h=Math.sin(s);if(e.order==="XYZ"){const d=a*u,f=a*h,p=o*u,g=o*h;n[0]=c*u,n[4]=-c*h,n[8]=l,n[1]=f+p*l,n[5]=d-g*l,n[9]=-o*c,n[2]=g-d*l,n[6]=p+f*l,n[10]=a*c}else if(e.order==="YXZ"){const d=c*u,f=c*h,p=l*u,g=l*h;n[0]=d+g*o,n[4]=p*o-f,n[8]=a*l,n[1]=a*h,n[5]=a*u,n[9]=-o,n[2]=f*o-p,n[6]=g+d*o,n[10]=a*c}else if(e.order==="ZXY"){const d=c*u,f=c*h,p=l*u,g=l*h;n[0]=d-g*o,n[4]=-a*h,n[8]=p+f*o,n[1]=f+p*o,n[5]=a*u,n[9]=g-d*o,n[2]=-a*l,n[6]=o,n[10]=a*c}else if(e.order==="ZYX"){const d=a*u,f=a*h,p=o*u,g=o*h;n[0]=c*u,n[4]=p*l-f,n[8]=d*l+g,n[1]=c*h,n[5]=g*l+d,n[9]=f*l-p,n[2]=-l,n[6]=o*c,n[10]=a*c}else if(e.order==="YZX"){const d=a*c,f=a*l,p=o*c,g=o*l;n[0]=c*u,n[4]=g-d*h,n[8]=p*h+f,n[1]=h,n[5]=a*u,n[9]=-o*u,n[2]=-l*u,n[6]=f*h+p,n[10]=d-g*h}else if(e.order==="XZY"){const d=a*c,f=a*l,p=o*c,g=o*l;n[0]=c*u,n[4]=-h,n[8]=l*u,n[1]=d*h+g,n[5]=a*u,n[9]=f*h-p,n[2]=p*h-f,n[6]=o*u,n[10]=g*h+d}return n[3]=0,n[7]=0,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,this}makeRotationFromQuaternion(e){return this.compose(mAe,e,gAe)}lookAt(e,n,i){const r=this.elements;return Hd.subVectors(e,n),Hd.lengthSq()===0&&(Hd.z=1),Hd.normalize(),ky.crossVectors(i,Hd),ky.lengthSq()===0&&(Math.abs(i.z)===1?Hd.x+=1e-4:Hd.z+=1e-4,Hd.normalize(),ky.crossVectors(i,Hd)),ky.normalize(),NP.crossVectors(Hd,ky),r[0]=ky.x,r[4]=NP.x,r[8]=Hd.x,r[1]=ky.y,r[5]=NP.y,r[9]=Hd.y,r[2]=ky.z,r[6]=NP.z,r[10]=Hd.z,this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,n){const i=e.elements,r=n.elements,s=this.elements,a=i[0],o=i[4],c=i[8],l=i[12],u=i[1],h=i[5],d=i[9],f=i[13],p=i[2],g=i[6],_=i[10],v=i[14],b=i[3],S=i[7],x=i[11],M=i[15],R=r[0],I=r[4],k=r[8],P=r[12],U=r[1],V=r[5],$=r[9],q=r[13],Y=r[2],te=r[6],G=r[10],J=r[14],K=r[3],X=r[7],ae=r[11],ce=r[15];return s[0]=a*R+o*U+c*Y+l*K,s[4]=a*I+o*V+c*te+l*X,s[8]=a*k+o*$+c*G+l*ae,s[12]=a*P+o*q+c*J+l*ce,s[1]=u*R+h*U+d*Y+f*K,s[5]=u*I+h*V+d*te+f*X,s[9]=u*k+h*$+d*G+f*ae,s[13]=u*P+h*q+d*J+f*ce,s[2]=p*R+g*U+_*Y+v*K,s[6]=p*I+g*V+_*te+v*X,s[10]=p*k+g*$+_*G+v*ae,s[14]=p*P+g*q+_*J+v*ce,s[3]=b*R+S*U+x*Y+M*K,s[7]=b*I+S*V+x*te+M*X,s[11]=b*k+S*$+x*G+M*ae,s[15]=b*P+S*q+x*J+M*ce,this}multiplyScalar(e){const n=this.elements;return n[0]*=e,n[4]*=e,n[8]*=e,n[12]*=e,n[1]*=e,n[5]*=e,n[9]*=e,n[13]*=e,n[2]*=e,n[6]*=e,n[10]*=e,n[14]*=e,n[3]*=e,n[7]*=e,n[11]*=e,n[15]*=e,this}determinant(){const e=this.elements,n=e[0],i=e[4],r=e[8],s=e[12],a=e[1],o=e[5],c=e[9],l=e[13],u=e[2],h=e[6],d=e[10],f=e[14],p=e[3],g=e[7],_=e[11],v=e[15];return p*(+s*c*h-r*l*h-s*o*d+i*l*d+r*o*f-i*c*f)+g*(+n*c*f-n*l*d+s*a*d-r*a*f+r*l*u-s*c*u)+_*(+n*l*h-n*o*f-s*a*h+i*a*f+s*o*u-i*l*u)+v*(-r*o*u-n*c*h+n*o*d+r*a*h-i*a*d+i*c*u)}transpose(){const e=this.elements;let n;return n=e[1],e[1]=e[4],e[4]=n,n=e[2],e[2]=e[8],e[8]=n,n=e[6],e[6]=e[9],e[9]=n,n=e[3],e[3]=e[12],e[12]=n,n=e[7],e[7]=e[13],e[13]=n,n=e[11],e[11]=e[14],e[14]=n,this}setPosition(e,n,i){const r=this.elements;return e.isVector3?(r[12]=e.x,r[13]=e.y,r[14]=e.z):(r[12]=e,r[13]=n,r[14]=i),this}invert(){const e=this.elements,n=e[0],i=e[1],r=e[2],s=e[3],a=e[4],o=e[5],c=e[6],l=e[7],u=e[8],h=e[9],d=e[10],f=e[11],p=e[12],g=e[13],_=e[14],v=e[15],b=h*_*l-g*d*l+g*c*f-o*_*f-h*c*v+o*d*v,S=p*d*l-u*_*l-p*c*f+a*_*f+u*c*v-a*d*v,x=u*g*l-p*h*l+p*o*f-a*g*f-u*o*v+a*h*v,M=p*h*c-u*g*c-p*o*d+a*g*d+u*o*_-a*h*_,R=n*b+i*S+r*x+s*M;if(R===0)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const I=1/R;return e[0]=b*I,e[1]=(g*d*s-h*_*s-g*r*f+i*_*f+h*r*v-i*d*v)*I,e[2]=(o*_*s-g*c*s+g*r*l-i*_*l-o*r*v+i*c*v)*I,e[3]=(h*c*s-o*d*s-h*r*l+i*d*l+o*r*f-i*c*f)*I,e[4]=S*I,e[5]=(u*_*s-p*d*s+p*r*f-n*_*f-u*r*v+n*d*v)*I,e[6]=(p*c*s-a*_*s-p*r*l+n*_*l+a*r*v-n*c*v)*I,e[7]=(a*d*s-u*c*s+u*r*l-n*d*l-a*r*f+n*c*f)*I,e[8]=x*I,e[9]=(p*h*s-u*g*s-p*i*f+n*g*f+u*i*v-n*h*v)*I,e[10]=(a*g*s-p*o*s+p*i*l-n*g*l-a*i*v+n*o*v)*I,e[11]=(u*o*s-a*h*s-u*i*l+n*h*l+a*i*f-n*o*f)*I,e[12]=M*I,e[13]=(u*g*r-p*h*r+p*i*d-n*g*d-u*i*_+n*h*_)*I,e[14]=(p*o*r-a*g*r-p*i*c+n*g*c+a*i*_-n*o*_)*I,e[15]=(a*h*r-u*o*r+u*i*c-n*h*c-a*i*d+n*o*d)*I,this}scale(e){const n=this.elements,i=e.x,r=e.y,s=e.z;return n[0]*=i,n[4]*=r,n[8]*=s,n[1]*=i,n[5]*=r,n[9]*=s,n[2]*=i,n[6]*=r,n[10]*=s,n[3]*=i,n[7]*=r,n[11]*=s,this}getMaxScaleOnAxis(){const e=this.elements,n=e[0]*e[0]+e[1]*e[1]+e[2]*e[2],i=e[4]*e[4]+e[5]*e[5]+e[6]*e[6],r=e[8]*e[8]+e[9]*e[9]+e[10]*e[10];return Math.sqrt(Math.max(n,i,r))}makeTranslation(e,n,i){return e.isVector3?this.set(1,0,0,e.x,0,1,0,e.y,0,0,1,e.z,0,0,0,1):this.set(1,0,0,e,0,1,0,n,0,0,1,i,0,0,0,1),this}makeRotationX(e){const n=Math.cos(e),i=Math.sin(e);return this.set(1,0,0,0,0,n,-i,0,0,i,n,0,0,0,0,1),this}makeRotationY(e){const n=Math.cos(e),i=Math.sin(e);return this.set(n,0,i,0,0,1,0,0,-i,0,n,0,0,0,0,1),this}makeRotationZ(e){const n=Math.cos(e),i=Math.sin(e);return this.set(n,-i,0,0,i,n,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(e,n){const i=Math.cos(n),r=Math.sin(n),s=1-i,a=e.x,o=e.y,c=e.z,l=s*a,u=s*o;return this.set(l*a+i,l*o-r*c,l*c+r*o,0,l*o+r*c,u*o+i,u*c-r*a,0,l*c-r*o,u*c+r*a,s*c*c+i,0,0,0,0,1),this}makeScale(e,n,i){return this.set(e,0,0,0,0,n,0,0,0,0,i,0,0,0,0,1),this}makeShear(e,n,i,r,s,a){return this.set(1,i,s,0,e,1,a,0,n,r,1,0,0,0,0,1),this}compose(e,n,i){const r=this.elements,s=n._x,a=n._y,o=n._z,c=n._w,l=s+s,u=a+a,h=o+o,d=s*l,f=s*u,p=s*h,g=a*u,_=a*h,v=o*h,b=c*l,S=c*u,x=c*h,M=i.x,R=i.y,I=i.z;return r[0]=(1-(g+v))*M,r[1]=(f+x)*M,r[2]=(p-S)*M,r[3]=0,r[4]=(f-x)*R,r[5]=(1-(d+v))*R,r[6]=(_+b)*R,r[7]=0,r[8]=(p+S)*I,r[9]=(_-b)*I,r[10]=(1-(d+g))*I,r[11]=0,r[12]=e.x,r[13]=e.y,r[14]=e.z,r[15]=1,this}decompose(e,n,i){const r=this.elements;let s=jx.set(r[0],r[1],r[2]).length();const a=jx.set(r[4],r[5],r[6]).length(),o=jx.set(r[8],r[9],r[10]).length();this.determinant()<0&&(s=-s),e.x=r[12],e.y=r[13],e.z=r[14],rm.copy(this);const l=1/s,u=1/a,h=1/o;return rm.elements[0]*=l,rm.elements[1]*=l,rm.elements[2]*=l,rm.elements[4]*=u,rm.elements[5]*=u,rm.elements[6]*=u,rm.elements[8]*=h,rm.elements[9]*=h,rm.elements[10]*=h,n.setFromRotationMatrix(rm),i.x=s,i.y=a,i.z=o,this}makePerspective(e,n,i,r,s,a,o=lp){const c=this.elements,l=2*s/(n-e),u=2*s/(i-r),h=(n+e)/(n-e),d=(i+r)/(i-r);let f,p;if(o===lp)f=-(a+s)/(a-s),p=-2*a*s/(a-s);else if(o===XO)f=-a/(a-s),p=-a*s/(a-s);else throw new Error("THREE.Matrix4.makePerspective(): Invalid coordinate system: "+o);return c[0]=l,c[4]=0,c[8]=h,c[12]=0,c[1]=0,c[5]=u,c[9]=d,c[13]=0,c[2]=0,c[6]=0,c[10]=f,c[14]=p,c[3]=0,c[7]=0,c[11]=-1,c[15]=0,this}makeOrthographic(e,n,i,r,s,a,o=lp){const c=this.elements,l=1/(n-e),u=1/(i-r),h=1/(a-s),d=(n+e)*l,f=(i+r)*u;let p,g;if(o===lp)p=(a+s)*h,g=-2*h;else if(o===XO)p=s*h,g=-1*h;else throw new Error("THREE.Matrix4.makeOrthographic(): Invalid coordinate system: "+o);return c[0]=2*l,c[4]=0,c[8]=0,c[12]=-d,c[1]=0,c[5]=2*u,c[9]=0,c[13]=-f,c[2]=0,c[6]=0,c[10]=g,c[14]=-p,c[3]=0,c[7]=0,c[11]=0,c[15]=1,this}equals(e){const n=this.elements,i=e.elements;for(let r=0;r<16;r++)if(n[r]!==i[r])return!1;return!0}fromArray(e,n=0){for(let i=0;i<16;i++)this.elements[i]=e[i+n];return this}toArray(e=[],n=0){const i=this.elements;return e[n]=i[0],e[n+1]=i[1],e[n+2]=i[2],e[n+3]=i[3],e[n+4]=i[4],e[n+5]=i[5],e[n+6]=i[6],e[n+7]=i[7],e[n+8]=i[8],e[n+9]=i[9],e[n+10]=i[10],e[n+11]=i[11],e[n+12]=i[12],e[n+13]=i[13],e[n+14]=i[14],e[n+15]=i[15],e}}const jx=new Oe,rm=new gi,mAe=new Oe(0,0,0),gAe=new Oe(1,1,1),ky=new Oe,NP=new Oe,Hd=new Oe,rJ=new gi,sJ=new mh;class dd{constructor(e=0,n=0,i=0,r=dd.DEFAULT_ORDER){this.isEuler=!0,this._x=e,this._y=n,this._z=i,this._order=r}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get order(){return this._order}set order(e){this._order=e,this._onChangeCallback()}set(e,n,i,r=this._order){return this._x=e,this._y=n,this._z=i,this._order=r,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(e){return this._x=e._x,this._y=e._y,this._z=e._z,this._order=e._order,this._onChangeCallback(),this}setFromRotationMatrix(e,n=this._order,i=!0){const r=e.elements,s=r[0],a=r[4],o=r[8],c=r[1],l=r[5],u=r[9],h=r[2],d=r[6],f=r[10];switch(n){case"XYZ":this._y=Math.asin(Ki(o,-1,1)),Math.abs(o)<.9999999?(this._x=Math.atan2(-u,f),this._z=Math.atan2(-a,s)):(this._x=Math.atan2(d,l),this._z=0);break;case"YXZ":this._x=Math.asin(-Ki(u,-1,1)),Math.abs(u)<.9999999?(this._y=Math.atan2(o,f),this._z=Math.atan2(c,l)):(this._y=Math.atan2(-h,s),this._z=0);break;case"ZXY":this._x=Math.asin(Ki(d,-1,1)),Math.abs(d)<.9999999?(this._y=Math.atan2(-h,f),this._z=Math.atan2(-a,l)):(this._y=0,this._z=Math.atan2(c,s));break;case"ZYX":this._y=Math.asin(-Ki(h,-1,1)),Math.abs(h)<.9999999?(this._x=Math.atan2(d,f),this._z=Math.atan2(c,s)):(this._x=0,this._z=Math.atan2(-a,l));break;case"YZX":this._z=Math.asin(Ki(c,-1,1)),Math.abs(c)<.9999999?(this._x=Math.atan2(-u,l),this._y=Math.atan2(-h,s)):(this._x=0,this._y=Math.atan2(o,f));break;case"XZY":this._z=Math.asin(-Ki(a,-1,1)),Math.abs(a)<.9999999?(this._x=Math.atan2(d,l),this._y=Math.atan2(o,s)):(this._x=Math.atan2(-u,f),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+n)}return this._order=n,i===!0&&this._onChangeCallback(),this}setFromQuaternion(e,n,i){return rJ.makeRotationFromQuaternion(e),this.setFromRotationMatrix(rJ,n,i)}setFromVector3(e,n=this._order){return this.set(e.x,e.y,e.z,n)}reorder(e){return sJ.setFromEuler(this),this.setFromQuaternion(sJ,e)}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._order===this._order}fromArray(e){return this._x=e[0],this._y=e[1],this._z=e[2],e[3]!==void 0&&(this._order=e[3]),this._onChangeCallback(),this}toArray(e=[],n=0){return e[n]=this._x,e[n+1]=this._y,e[n+2]=this._z,e[n+3]=this._order,e}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}}dd.DEFAULT_ORDER="XYZ";class jC{constructor(){this.mask=1}set(e){this.mask=(1<<e|0)>>>0}enable(e){this.mask|=1<<e|0}enableAll(){this.mask=-1}toggle(e){this.mask^=1<<e|0}disable(e){this.mask&=~(1<<e|0)}disableAll(){this.mask=0}test(e){return(this.mask&e.mask)!==0}isEnabled(e){return(this.mask&(1<<e|0))!==0}}let vAe=0;const aJ=new Oe,Hx=new mh,Cv=new gi,IP=new Oe,WR=new Oe,_Ae=new Oe,yAe=new mh,oJ=new Oe(1,0,0),cJ=new Oe(0,1,0),lJ=new Oe(0,0,1),uJ={type:"added"},bAe={type:"removed"},Vx={type:"childadded",child:null},E5={type:"childremoved",child:null};class Wr extends _f{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:vAe++}),this.uuid=cf(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=Wr.DEFAULT_UP.clone();const e=new Oe,n=new dd,i=new mh,r=new Oe(1,1,1);function s(){i.setFromEuler(n,!1)}function a(){n.setFromQuaternion(i,void 0,!1)}n._onChange(s),i._onChange(a),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:e},rotation:{configurable:!0,enumerable:!0,value:n},quaternion:{configurable:!0,enumerable:!0,value:i},scale:{configurable:!0,enumerable:!0,value:r},modelViewMatrix:{value:new gi},normalMatrix:{value:new Qi}}),this.matrix=new gi,this.matrixWorld=new gi,this.matrixAutoUpdate=Wr.DEFAULT_MATRIX_AUTO_UPDATE,this.matrixWorldAutoUpdate=Wr.DEFAULT_MATRIX_WORLD_AUTO_UPDATE,this.matrixWorldNeedsUpdate=!1,this.layers=new jC,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.customDepthMaterial=void 0,this.customDistanceMaterial=void 0,this.userData={}}onBeforeShadow(){}onAfterShadow(){}onBeforeRender(){}onAfterRender(){}applyMatrix4(e){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(e),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(e){return this.quaternion.premultiply(e),this}setRotationFromAxisAngle(e,n){this.quaternion.setFromAxisAngle(e,n)}setRotationFromEuler(e){this.quaternion.setFromEuler(e,!0)}setRotationFromMatrix(e){this.quaternion.setFromRotationMatrix(e)}setRotationFromQuaternion(e){this.quaternion.copy(e)}rotateOnAxis(e,n){return Hx.setFromAxisAngle(e,n),this.quaternion.multiply(Hx),this}rotateOnWorldAxis(e,n){return Hx.setFromAxisAngle(e,n),this.quaternion.premultiply(Hx),this}rotateX(e){return this.rotateOnAxis(oJ,e)}rotateY(e){return this.rotateOnAxis(cJ,e)}rotateZ(e){return this.rotateOnAxis(lJ,e)}translateOnAxis(e,n){return aJ.copy(e).applyQuaternion(this.quaternion),this.position.add(aJ.multiplyScalar(n)),this}translateX(e){return this.translateOnAxis(oJ,e)}translateY(e){return this.translateOnAxis(cJ,e)}translateZ(e){return this.translateOnAxis(lJ,e)}localToWorld(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(this.matrixWorld)}worldToLocal(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(Cv.copy(this.matrixWorld).invert())}lookAt(e,n,i){e.isVector3?IP.copy(e):IP.set(e,n,i);const r=this.parent;this.updateWorldMatrix(!0,!1),WR.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?Cv.lookAt(WR,IP,this.up):Cv.lookAt(IP,WR,this.up),this.quaternion.setFromRotationMatrix(Cv),r&&(Cv.extractRotation(r.matrixWorld),Hx.setFromRotationMatrix(Cv),this.quaternion.premultiply(Hx.invert()))}add(e){if(arguments.length>1){for(let n=0;n<arguments.length;n++)this.add(arguments[n]);return this}return e===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",e),this):(e&&e.isObject3D?(e.removeFromParent(),e.parent=this,this.children.push(e),e.dispatchEvent(uJ),Vx.child=e,this.dispatchEvent(Vx),Vx.child=null):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",e),this)}remove(e){if(arguments.length>1){for(let i=0;i<arguments.length;i++)this.remove(arguments[i]);return this}const n=this.children.indexOf(e);return n!==-1&&(e.parent=null,this.children.splice(n,1),e.dispatchEvent(bAe),E5.child=e,this.dispatchEvent(E5),E5.child=null),this}removeFromParent(){const e=this.parent;return e!==null&&e.remove(this),this}clear(){return this.remove(...this.children)}attach(e){return this.updateWorldMatrix(!0,!1),Cv.copy(this.matrixWorld).invert(),e.parent!==null&&(e.parent.updateWorldMatrix(!0,!1),Cv.multiply(e.parent.matrixWorld)),e.applyMatrix4(Cv),e.removeFromParent(),e.parent=this,this.children.push(e),e.updateWorldMatrix(!1,!0),e.dispatchEvent(uJ),Vx.child=e,this.dispatchEvent(Vx),Vx.child=null,this}getObjectById(e){return this.getObjectByProperty("id",e)}getObjectByName(e){return this.getObjectByProperty("name",e)}getObjectByProperty(e,n){if(this[e]===n)return this;for(let i=0,r=this.children.length;i<r;i++){const a=this.children[i].getObjectByProperty(e,n);if(a!==void 0)return a}}getObjectsByProperty(e,n,i=[]){this[e]===n&&i.push(this);const r=this.children;for(let s=0,a=r.length;s<a;s++)r[s].getObjectsByProperty(e,n,i);return i}getWorldPosition(e){return this.updateWorldMatrix(!0,!1),e.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(WR,e,_Ae),e}getWorldScale(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(WR,yAe,e),e}getWorldDirection(e){this.updateWorldMatrix(!0,!1);const n=this.matrixWorld.elements;return e.set(n[8],n[9],n[10]).normalize()}raycast(){}traverse(e){e(this);const n=this.children;for(let i=0,r=n.length;i<r;i++)n[i].traverse(e)}traverseVisible(e){if(this.visible===!1)return;e(this);const n=this.children;for(let i=0,r=n.length;i<r;i++)n[i].traverseVisible(e)}traverseAncestors(e){const n=this.parent;n!==null&&(e(n),n.traverseAncestors(e))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(this.matrixWorldAutoUpdate===!0&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix)),this.matrixWorldNeedsUpdate=!1,e=!0);const n=this.children;for(let i=0,r=n.length;i<r;i++)n[i].updateMatrixWorld(e)}updateWorldMatrix(e,n){const i=this.parent;if(e===!0&&i!==null&&i.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),this.matrixWorldAutoUpdate===!0&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix)),n===!0){const r=this.children;for(let s=0,a=r.length;s<a;s++)r[s].updateWorldMatrix(!1,!0)}}toJSON(e){const n=e===void 0||typeof e=="string",i={};n&&(e={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},i.metadata={version:4.6,type:"Object",generator:"Object3D.toJSON"});const r={};r.uuid=this.uuid,r.type=this.type,this.name!==""&&(r.name=this.name),this.castShadow===!0&&(r.castShadow=!0),this.receiveShadow===!0&&(r.receiveShadow=!0),this.visible===!1&&(r.visible=!1),this.frustumCulled===!1&&(r.frustumCulled=!1),this.renderOrder!==0&&(r.renderOrder=this.renderOrder),Object.keys(this.userData).length>0&&(r.userData=this.userData),r.layers=this.layers.mask,r.matrix=this.matrix.toArray(),r.up=this.up.toArray(),this.matrixAutoUpdate===!1&&(r.matrixAutoUpdate=!1),this.isInstancedMesh&&(r.type="InstancedMesh",r.count=this.count,r.instanceMatrix=this.instanceMatrix.toJSON(),this.instanceColor!==null&&(r.instanceColor=this.instanceColor.toJSON())),this.isBatchedMesh&&(r.type="BatchedMesh",r.perObjectFrustumCulled=this.perObjectFrustumCulled,r.sortObjects=this.sortObjects,r.drawRanges=this._drawRanges,r.reservedRanges=this._reservedRanges,r.geometryInfo=this._geometryInfo.map(o=>({...o,boundingBox:o.boundingBox?{min:o.boundingBox.min.toArray(),max:o.boundingBox.max.toArray()}:void 0,boundingSphere:o.boundingSphere?{radius:o.boundingSphere.radius,center:o.boundingSphere.center.toArray()}:void 0})),r.instanceInfo=this._instanceInfo.map(o=>({...o})),r.availableInstanceIds=this._availableInstanceIds.slice(),r.availableGeometryIds=this._availableGeometryIds.slice(),r.nextIndexStart=this._nextIndexStart,r.nextVertexStart=this._nextVertexStart,r.geometryCount=this._geometryCount,r.maxInstanceCount=this._maxInstanceCount,r.maxVertexCount=this._maxVertexCount,r.maxIndexCount=this._maxIndexCount,r.geometryInitialized=this._geometryInitialized,r.matricesTexture=this._matricesTexture.toJSON(e),r.indirectTexture=this._indirectTexture.toJSON(e),this._colorsTexture!==null&&(r.colorsTexture=this._colorsTexture.toJSON(e)),this.boundingSphere!==null&&(r.boundingSphere={center:this.boundingSphere.center.toArray(),radius:this.boundingSphere.radius}),this.boundingBox!==null&&(r.boundingBox={min:this.boundingBox.min.toArray(),max:this.boundingBox.max.toArray()}));function s(o,c){return o[c.uuid]===void 0&&(o[c.uuid]=c.toJSON(e)),c.uuid}if(this.isScene)this.background&&(this.background.isColor?r.background=this.background.toJSON():this.background.isTexture&&(r.background=this.background.toJSON(e).uuid)),this.environment&&this.environment.isTexture&&this.environment.isRenderTargetTexture!==!0&&(r.environment=this.environment.toJSON(e).uuid);else if(this.isMesh||this.isLine||this.isPoints){r.geometry=s(e.geometries,this.geometry);const o=this.geometry.parameters;if(o!==void 0&&o.shapes!==void 0){const c=o.shapes;if(Array.isArray(c))for(let l=0,u=c.length;l<u;l++){const h=c[l];s(e.shapes,h)}else s(e.shapes,c)}}if(this.isSkinnedMesh&&(r.bindMode=this.bindMode,r.bindMatrix=this.bindMatrix.toArray(),this.skeleton!==void 0&&(s(e.skeletons,this.skeleton),r.skeleton=this.skeleton.uuid)),this.material!==void 0)if(Array.isArray(this.material)){const o=[];for(let c=0,l=this.material.length;c<l;c++)o.push(s(e.materials,this.material[c]));r.material=o}else r.material=s(e.materials,this.material);if(this.children.length>0){r.children=[];for(let o=0;o<this.children.length;o++)r.children.push(this.children[o].toJSON(e).object)}if(this.animations.length>0){r.animations=[];for(let o=0;o<this.animations.length;o++){const c=this.animations[o];r.animations.push(s(e.animations,c))}}if(n){const o=a(e.geometries),c=a(e.materials),l=a(e.textures),u=a(e.images),h=a(e.shapes),d=a(e.skeletons),f=a(e.animations),p=a(e.nodes);o.length>0&&(i.geometries=o),c.length>0&&(i.materials=c),l.length>0&&(i.textures=l),u.length>0&&(i.images=u),h.length>0&&(i.shapes=h),d.length>0&&(i.skeletons=d),f.length>0&&(i.animations=f),p.length>0&&(i.nodes=p)}return i.object=r,i;function a(o){const c=[];for(const l in o){const u=o[l];delete u.metadata,c.push(u)}return c}}clone(e){return new this.constructor().copy(this,e)}copy(e,n=!0){if(this.name=e.name,this.up.copy(e.up),this.position.copy(e.position),this.rotation.order=e.rotation.order,this.quaternion.copy(e.quaternion),this.scale.copy(e.scale),this.matrix.copy(e.matrix),this.matrixWorld.copy(e.matrixWorld),this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrixWorldAutoUpdate=e.matrixWorldAutoUpdate,this.matrixWorldNeedsUpdate=e.matrixWorldNeedsUpdate,this.layers.mask=e.layers.mask,this.visible=e.visible,this.castShadow=e.castShadow,this.receiveShadow=e.receiveShadow,this.frustumCulled=e.frustumCulled,this.renderOrder=e.renderOrder,this.animations=e.animations.slice(),this.userData=JSON.parse(JSON.stringify(e.userData)),n===!0)for(let i=0;i<e.children.length;i++){const r=e.children[i];this.add(r.clone())}return this}}Wr.DEFAULT_UP=new Oe(0,1,0);Wr.DEFAULT_MATRIX_AUTO_UPDATE=!0;Wr.DEFAULT_MATRIX_WORLD_AUTO_UPDATE=!0;const sm=new Oe,Av=new Oe,S5=new Oe,Rv=new Oe,Gx=new Oe,qx=new Oe,hJ=new Oe,T5=new Oe,x5=new Oe,w5=new Oe,C5=new zr,A5=new zr,R5=new zr;class td{constructor(e=new Oe,n=new Oe,i=new Oe){this.a=e,this.b=n,this.c=i}static getNormal(e,n,i,r){r.subVectors(i,n),sm.subVectors(e,n),r.cross(sm);const s=r.lengthSq();return s>0?r.multiplyScalar(1/Math.sqrt(s)):r.set(0,0,0)}static getBarycoord(e,n,i,r,s){sm.subVectors(r,n),Av.subVectors(i,n),S5.subVectors(e,n);const a=sm.dot(sm),o=sm.dot(Av),c=sm.dot(S5),l=Av.dot(Av),u=Av.dot(S5),h=a*l-o*o;if(h===0)return s.set(0,0,0),null;const d=1/h,f=(l*c-o*u)*d,p=(a*u-o*c)*d;return s.set(1-f-p,p,f)}static containsPoint(e,n,i,r){return this.getBarycoord(e,n,i,r,Rv)===null?!1:Rv.x>=0&&Rv.y>=0&&Rv.x+Rv.y<=1}static getInterpolation(e,n,i,r,s,a,o,c){return this.getBarycoord(e,n,i,r,Rv)===null?(c.x=0,c.y=0,"z"in c&&(c.z=0),"w"in c&&(c.w=0),null):(c.setScalar(0),c.addScaledVector(s,Rv.x),c.addScaledVector(a,Rv.y),c.addScaledVector(o,Rv.z),c)}static getInterpolatedAttribute(e,n,i,r,s,a){return C5.setScalar(0),A5.setScalar(0),R5.setScalar(0),C5.fromBufferAttribute(e,n),A5.fromBufferAttribute(e,i),R5.fromBufferAttribute(e,r),a.setScalar(0),a.addScaledVector(C5,s.x),a.addScaledVector(A5,s.y),a.addScaledVector(R5,s.z),a}static isFrontFacing(e,n,i,r){return sm.subVectors(i,n),Av.subVectors(e,n),sm.cross(Av).dot(r)<0}set(e,n,i){return this.a.copy(e),this.b.copy(n),this.c.copy(i),this}setFromPointsAndIndices(e,n,i,r){return this.a.copy(e[n]),this.b.copy(e[i]),this.c.copy(e[r]),this}setFromAttributeAndIndices(e,n,i,r){return this.a.fromBufferAttribute(e,n),this.b.fromBufferAttribute(e,i),this.c.fromBufferAttribute(e,r),this}clone(){return new this.constructor().copy(this)}copy(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this}getArea(){return sm.subVectors(this.c,this.b),Av.subVectors(this.a,this.b),sm.cross(Av).length()*.5}getMidpoint(e){return e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(e){return td.getNormal(this.a,this.b,this.c,e)}getPlane(e){return e.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(e,n){return td.getBarycoord(e,this.a,this.b,this.c,n)}getInterpolation(e,n,i,r,s){return td.getInterpolation(e,this.a,this.b,this.c,n,i,r,s)}containsPoint(e){return td.containsPoint(e,this.a,this.b,this.c)}isFrontFacing(e){return td.isFrontFacing(this.a,this.b,this.c,e)}intersectsBox(e){return e.intersectsTriangle(this)}closestPointToPoint(e,n){const i=this.a,r=this.b,s=this.c;let a,o;Gx.subVectors(r,i),qx.subVectors(s,i),T5.subVectors(e,i);const c=Gx.dot(T5),l=qx.dot(T5);if(c<=0&&l<=0)return n.copy(i);x5.subVectors(e,r);const u=Gx.dot(x5),h=qx.dot(x5);if(u>=0&&h<=u)return n.copy(r);const d=c*h-u*l;if(d<=0&&c>=0&&u<=0)return a=c/(c-u),n.copy(i).addScaledVector(Gx,a);w5.subVectors(e,s);const f=Gx.dot(w5),p=qx.dot(w5);if(p>=0&&f<=p)return n.copy(s);const g=f*l-c*p;if(g<=0&&l>=0&&p<=0)return o=l/(l-p),n.copy(i).addScaledVector(qx,o);const _=u*p-f*h;if(_<=0&&h-u>=0&&f-p>=0)return hJ.subVectors(s,r),o=(h-u)/(h-u+(f-p)),n.copy(r).addScaledVector(hJ,o);const v=1/(_+g+d);return a=g*v,o=d*v,n.copy(i).addScaledVector(Gx,a).addScaledVector(qx,o)}equals(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}}const qle={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},Py={h:0,s:0,l:0},kP={h:0,s:0,l:0};function M5(t,e,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?t+(e-t)*6*n:n<1/2?e:n<2/3?t+(e-t)*6*(2/3-n):t}class bn{constructor(e,n,i){return this.isColor=!0,this.r=1,this.g=1,this.b=1,this.set(e,n,i)}set(e,n,i){if(n===void 0&&i===void 0){const r=e;r&&r.isColor?this.copy(r):typeof r=="number"?this.setHex(r):typeof r=="string"&&this.setStyle(r)}else this.setRGB(e,n,i);return this}setScalar(e){return this.r=e,this.g=e,this.b=e,this}setHex(e,n=ls){return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(e&255)/255,Br.toWorkingColorSpace(this,n),this}setRGB(e,n,i,r=Br.workingColorSpace){return this.r=e,this.g=n,this.b=i,Br.toWorkingColorSpace(this,r),this}setHSL(e,n,i,r=Br.workingColorSpace){if(e=Z7(e,1),n=Ki(n,0,1),i=Ki(i,0,1),n===0)this.r=this.g=this.b=i;else{const s=i<=.5?i*(1+n):i+n-i*n,a=2*i-s;this.r=M5(a,s,e+1/3),this.g=M5(a,s,e),this.b=M5(a,s,e-1/3)}return Br.toWorkingColorSpace(this,r),this}setStyle(e,n=ls){function i(s){s!==void 0&&parseFloat(s)<1&&console.warn("THREE.Color: Alpha component of "+e+" will be ignored.")}let r;if(r=/^(\w+)\(([^\)]*)\)/.exec(e)){let s;const a=r[1],o=r[2];switch(a){case"rgb":case"rgba":if(s=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(o))return i(s[4]),this.setRGB(Math.min(255,parseInt(s[1],10))/255,Math.min(255,parseInt(s[2],10))/255,Math.min(255,parseInt(s[3],10))/255,n);if(s=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(o))return i(s[4]),this.setRGB(Math.min(100,parseInt(s[1],10))/100,Math.min(100,parseInt(s[2],10))/100,Math.min(100,parseInt(s[3],10))/100,n);break;case"hsl":case"hsla":if(s=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(o))return i(s[4]),this.setHSL(parseFloat(s[1])/360,parseFloat(s[2])/100,parseFloat(s[3])/100,n);break;default:console.warn("THREE.Color: Unknown color model "+e)}}else if(r=/^\#([A-Fa-f\d]+)$/.exec(e)){const s=r[1],a=s.length;if(a===3)return this.setRGB(parseInt(s.charAt(0),16)/15,parseInt(s.charAt(1),16)/15,parseInt(s.charAt(2),16)/15,n);if(a===6)return this.setHex(parseInt(s,16),n);console.warn("THREE.Color: Invalid hex color "+e)}else if(e&&e.length>0)return this.setColorName(e,n);return this}setColorName(e,n=ls){const i=qle[e.toLowerCase()];return i!==void 0?this.setHex(i,n):console.warn("THREE.Color: Unknown color "+e),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(e){return this.r=e.r,this.g=e.g,this.b=e.b,this}copySRGBToLinear(e){return this.r=h_(e.r),this.g=h_(e.g),this.b=h_(e.b),this}copyLinearToSRGB(e){return this.r=uC(e.r),this.g=uC(e.g),this.b=uC(e.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(e=ls){return Br.fromWorkingColorSpace(lu.copy(this),e),Math.round(Ki(lu.r*255,0,255))*65536+Math.round(Ki(lu.g*255,0,255))*256+Math.round(Ki(lu.b*255,0,255))}getHexString(e=ls){return("000000"+this.getHex(e).toString(16)).slice(-6)}getHSL(e,n=Br.workingColorSpace){Br.fromWorkingColorSpace(lu.copy(this),n);const i=lu.r,r=lu.g,s=lu.b,a=Math.max(i,r,s),o=Math.min(i,r,s);let c,l;const u=(o+a)/2;if(o===a)c=0,l=0;else{const h=a-o;switch(l=u<=.5?h/(a+o):h/(2-a-o),a){case i:c=(r-s)/h+(r<s?6:0);break;case r:c=(s-i)/h+2;break;case s:c=(i-r)/h+4;break}c/=6}return e.h=c,e.s=l,e.l=u,e}getRGB(e,n=Br.workingColorSpace){return Br.fromWorkingColorSpace(lu.copy(this),n),e.r=lu.r,e.g=lu.g,e.b=lu.b,e}getStyle(e=ls){Br.fromWorkingColorSpace(lu.copy(this),e);const n=lu.r,i=lu.g,r=lu.b;return e!==ls?`color(${e} ${n.toFixed(3)} ${i.toFixed(3)} ${r.toFixed(3)})`:`rgb(${Math.round(n*255)},${Math.round(i*255)},${Math.round(r*255)})`}offsetHSL(e,n,i){return this.getHSL(Py),this.setHSL(Py.h+e,Py.s+n,Py.l+i)}add(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this}addColors(e,n){return this.r=e.r+n.r,this.g=e.g+n.g,this.b=e.b+n.b,this}addScalar(e){return this.r+=e,this.g+=e,this.b+=e,this}sub(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this}multiply(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this}multiplyScalar(e){return this.r*=e,this.g*=e,this.b*=e,this}lerp(e,n){return this.r+=(e.r-this.r)*n,this.g+=(e.g-this.g)*n,this.b+=(e.b-this.b)*n,this}lerpColors(e,n,i){return this.r=e.r+(n.r-e.r)*i,this.g=e.g+(n.g-e.g)*i,this.b=e.b+(n.b-e.b)*i,this}lerpHSL(e,n){this.getHSL(Py),e.getHSL(kP);const i=rO(Py.h,kP.h,n),r=rO(Py.s,kP.s,n),s=rO(Py.l,kP.l,n);return this.setHSL(i,r,s),this}setFromVector3(e){return this.r=e.x,this.g=e.y,this.b=e.z,this}applyMatrix3(e){const n=this.r,i=this.g,r=this.b,s=e.elements;return this.r=s[0]*n+s[3]*i+s[6]*r,this.g=s[1]*n+s[4]*i+s[7]*r,this.b=s[2]*n+s[5]*i+s[8]*r,this}equals(e){return e.r===this.r&&e.g===this.g&&e.b===this.b}fromArray(e,n=0){return this.r=e[n],this.g=e[n+1],this.b=e[n+2],this}toArray(e=[],n=0){return e[n]=this.r,e[n+1]=this.g,e[n+2]=this.b,e}fromBufferAttribute(e,n){return this.r=e.getX(n),this.g=e.getY(n),this.b=e.getZ(n),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}}const lu=new bn;bn.NAMES=qle;let EAe=0;class rl extends _f{constructor(){super(),this.isMaterial=!0,Object.defineProperty(this,"id",{value:EAe++}),this.uuid=cf(),this.name="",this.type="Material",this.blending=AT,this.side=r0,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.alphaHash=!1,this.blendSrc=$L,this.blendDst=WL,this.blendEquation=db,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.blendColor=new bn(0,0,0),this.blendAlpha=0,this.depthFunc=YT,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=ZV,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=JS,this.stencilZFail=JS,this.stencilZPass=JS,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.forceSinglePass=!1,this.allowOverride=!0,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(e){this._alphaTest>0!=e>0&&this.version++,this._alphaTest=e}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(e){if(e!==void 0)for(const n in e){const i=e[n];if(i===void 0){console.warn(`THREE.Material: parameter '${n}' has value of undefined.`);continue}const r=this[n];if(r===void 0){console.warn(`THREE.Material: '${n}' is not a property of THREE.${this.type}.`);continue}r&&r.isColor?r.set(i):r&&r.isVector3&&i&&i.isVector3?r.copy(i):this[n]=i}}toJSON(e){const n=e===void 0||typeof e=="string";n&&(e={textures:{},images:{}});const i={metadata:{version:4.6,type:"Material",generator:"Material.toJSON"}};i.uuid=this.uuid,i.type=this.type,this.name!==""&&(i.name=this.name),this.color&&this.color.isColor&&(i.color=this.color.getHex()),this.roughness!==void 0&&(i.roughness=this.roughness),this.metalness!==void 0&&(i.metalness=this.metalness),this.sheen!==void 0&&(i.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(i.sheenColor=this.sheenColor.getHex()),this.sheenRoughness!==void 0&&(i.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(i.emissive=this.emissive.getHex()),this.emissiveIntensity!==void 0&&this.emissiveIntensity!==1&&(i.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(i.specular=this.specular.getHex()),this.specularIntensity!==void 0&&(i.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(i.specularColor=this.specularColor.getHex()),this.shininess!==void 0&&(i.shininess=this.shininess),this.clearcoat!==void 0&&(i.clearcoat=this.clearcoat),this.clearcoatRoughness!==void 0&&(i.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(i.clearcoatMap=this.clearcoatMap.toJSON(e).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(i.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(e).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(i.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(e).uuid,i.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.dispersion!==void 0&&(i.dispersion=this.dispersion),this.iridescence!==void 0&&(i.iridescence=this.iridescence),this.iridescenceIOR!==void 0&&(i.iridescenceIOR=this.iridescenceIOR),this.iridescenceThicknessRange!==void 0&&(i.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&(i.iridescenceMap=this.iridescenceMap.toJSON(e).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(i.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(e).uuid),this.anisotropy!==void 0&&(i.anisotropy=this.anisotropy),this.anisotropyRotation!==void 0&&(i.anisotropyRotation=this.anisotropyRotation),this.anisotropyMap&&this.anisotropyMap.isTexture&&(i.anisotropyMap=this.anisotropyMap.toJSON(e).uuid),this.map&&this.map.isTexture&&(i.map=this.map.toJSON(e).uuid),this.matcap&&this.matcap.isTexture&&(i.matcap=this.matcap.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(i.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(i.lightMap=this.lightMap.toJSON(e).uuid,i.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(i.aoMap=this.aoMap.toJSON(e).uuid,i.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(i.bumpMap=this.bumpMap.toJSON(e).uuid,i.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(i.normalMap=this.normalMap.toJSON(e).uuid,i.normalMapType=this.normalMapType,i.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(i.displacementMap=this.displacementMap.toJSON(e).uuid,i.displacementScale=this.displacementScale,i.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(i.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(i.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(i.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(i.specularMap=this.specularMap.toJSON(e).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(i.specularIntensityMap=this.specularIntensityMap.toJSON(e).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(i.specularColorMap=this.specularColorMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(i.envMap=this.envMap.toJSON(e).uuid,this.combine!==void 0&&(i.combine=this.combine)),this.envMapRotation!==void 0&&(i.envMapRotation=this.envMapRotation.toArray()),this.envMapIntensity!==void 0&&(i.envMapIntensity=this.envMapIntensity),this.reflectivity!==void 0&&(i.reflectivity=this.reflectivity),this.refractionRatio!==void 0&&(i.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(i.gradientMap=this.gradientMap.toJSON(e).uuid),this.transmission!==void 0&&(i.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(i.transmissionMap=this.transmissionMap.toJSON(e).uuid),this.thickness!==void 0&&(i.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(i.thicknessMap=this.thicknessMap.toJSON(e).uuid),this.attenuationDistance!==void 0&&this.attenuationDistance!==1/0&&(i.attenuationDistance=this.attenuationDistance),this.attenuationColor!==void 0&&(i.attenuationColor=this.attenuationColor.getHex()),this.size!==void 0&&(i.size=this.size),this.shadowSide!==null&&(i.shadowSide=this.shadowSide),this.sizeAttenuation!==void 0&&(i.sizeAttenuation=this.sizeAttenuation),this.blending!==AT&&(i.blending=this.blending),this.side!==r0&&(i.side=this.side),this.vertexColors===!0&&(i.vertexColors=!0),this.opacity<1&&(i.opacity=this.opacity),this.transparent===!0&&(i.transparent=!0),this.blendSrc!==$L&&(i.blendSrc=this.blendSrc),this.blendDst!==WL&&(i.blendDst=this.blendDst),this.blendEquation!==db&&(i.blendEquation=this.blendEquation),this.blendSrcAlpha!==null&&(i.blendSrcAlpha=this.blendSrcAlpha),this.blendDstAlpha!==null&&(i.blendDstAlpha=this.blendDstAlpha),this.blendEquationAlpha!==null&&(i.blendEquationAlpha=this.blendEquationAlpha),this.blendColor&&this.blendColor.isColor&&(i.blendColor=this.blendColor.getHex()),this.blendAlpha!==0&&(i.blendAlpha=this.blendAlpha),this.depthFunc!==YT&&(i.depthFunc=this.depthFunc),this.depthTest===!1&&(i.depthTest=this.depthTest),this.depthWrite===!1&&(i.depthWrite=this.depthWrite),this.colorWrite===!1&&(i.colorWrite=this.colorWrite),this.stencilWriteMask!==255&&(i.stencilWriteMask=this.stencilWriteMask),this.stencilFunc!==ZV&&(i.stencilFunc=this.stencilFunc),this.stencilRef!==0&&(i.stencilRef=this.stencilRef),this.stencilFuncMask!==255&&(i.stencilFuncMask=this.stencilFuncMask),this.stencilFail!==JS&&(i.stencilFail=this.stencilFail),this.stencilZFail!==JS&&(i.stencilZFail=this.stencilZFail),this.stencilZPass!==JS&&(i.stencilZPass=this.stencilZPass),this.stencilWrite===!0&&(i.stencilWrite=this.stencilWrite),this.rotation!==void 0&&this.rotation!==0&&(i.rotation=this.rotation),this.polygonOffset===!0&&(i.polygonOffset=!0),this.polygonOffsetFactor!==0&&(i.polygonOffsetFactor=this.polygonOffsetFactor),this.polygonOffsetUnits!==0&&(i.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth!==void 0&&this.linewidth!==1&&(i.linewidth=this.linewidth),this.dashSize!==void 0&&(i.dashSize=this.dashSize),this.gapSize!==void 0&&(i.gapSize=this.gapSize),this.scale!==void 0&&(i.scale=this.scale),this.dithering===!0&&(i.dithering=!0),this.alphaTest>0&&(i.alphaTest=this.alphaTest),this.alphaHash===!0&&(i.alphaHash=!0),this.alphaToCoverage===!0&&(i.alphaToCoverage=!0),this.premultipliedAlpha===!0&&(i.premultipliedAlpha=!0),this.forceSinglePass===!0&&(i.forceSinglePass=!0),this.wireframe===!0&&(i.wireframe=!0),this.wireframeLinewidth>1&&(i.wireframeLinewidth=this.wireframeLinewidth),this.wireframeLinecap!=="round"&&(i.wireframeLinecap=this.wireframeLinecap),this.wireframeLinejoin!=="round"&&(i.wireframeLinejoin=this.wireframeLinejoin),this.flatShading===!0&&(i.flatShading=!0),this.visible===!1&&(i.visible=!1),this.toneMapped===!1&&(i.toneMapped=!1),this.fog===!1&&(i.fog=!1),Object.keys(this.userData).length>0&&(i.userData=this.userData);function r(s){const a=[];for(const o in s){const c=s[o];delete c.metadata,a.push(c)}return a}if(n){const s=r(e.textures),a=r(e.images);s.length>0&&(i.textures=s),a.length>0&&(i.images=a)}return i}clone(){return new this.constructor().copy(this)}copy(e){this.name=e.name,this.blending=e.blending,this.side=e.side,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.blendColor.copy(e.blendColor),this.blendAlpha=e.blendAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.stencilWriteMask=e.stencilWriteMask,this.stencilFunc=e.stencilFunc,this.stencilRef=e.stencilRef,this.stencilFuncMask=e.stencilFuncMask,this.stencilFail=e.stencilFail,this.stencilZFail=e.stencilZFail,this.stencilZPass=e.stencilZPass,this.stencilWrite=e.stencilWrite;const n=e.clippingPlanes;let i=null;if(n!==null){const r=n.length;i=new Array(r);for(let s=0;s!==r;++s)i[s]=n[s].clone()}return this.clippingPlanes=i,this.clipIntersection=e.clipIntersection,this.clipShadows=e.clipShadows,this.shadowSide=e.shadowSide,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.alphaHash=e.alphaHash,this.alphaToCoverage=e.alphaToCoverage,this.premultipliedAlpha=e.premultipliedAlpha,this.forceSinglePass=e.forceSinglePass,this.visible=e.visible,this.toneMapped=e.toneMapped,this.userData=JSON.parse(JSON.stringify(e.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(e){e===!0&&this.version++}}class wE extends rl{constructor(e){super(),this.isMeshBasicMaterial=!0,this.type="MeshBasicMaterial",this.color=new bn(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new dd,this.combine=NI,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}const Yv=SAe();function SAe(){const t=new ArrayBuffer(4),e=new Float32Array(t),n=new Uint32Array(t),i=new Uint32Array(512),r=new Uint32Array(512);for(let c=0;c<256;++c){const l=c-127;l<-27?(i[c]=0,i[c|256]=32768,r[c]=24,r[c|256]=24):l<-14?(i[c]=1024>>-l-14,i[c|256]=1024>>-l-14|32768,r[c]=-l-1,r[c|256]=-l-1):l<=15?(i[c]=l+15<<10,i[c|256]=l+15<<10|32768,r[c]=13,r[c|256]=13):l<128?(i[c]=31744,i[c|256]=64512,r[c]=24,r[c|256]=24):(i[c]=31744,i[c|256]=64512,r[c]=13,r[c|256]=13)}const s=new Uint32Array(2048),a=new Uint32Array(64),o=new Uint32Array(64);for(let c=1;c<1024;++c){let l=c<<13,u=0;for(;!(l&8388608);)l<<=1,u-=8388608;l&=-8388609,u+=947912704,s[c]=l|u}for(let c=1024;c<2048;++c)s[c]=939524096+(c-1024<<13);for(let c=1;c<31;++c)a[c]=c<<23;a[31]=1199570944,a[32]=2147483648;for(let c=33;c<63;++c)a[c]=2147483648+(c-32<<23);a[63]=3347054592;for(let c=1;c<64;++c)c!==32&&(o[c]=1024);return{floatView:e,uint32View:n,baseTable:i,shiftTable:r,mantissaTable:s,exponentTable:a,offsetTable:o}}function qh(t){Math.abs(t)>65504&&console.warn("THREE.DataUtils.toHalfFloat(): Value out of range."),t=Ki(t,-65504,65504),Yv.floatView[0]=t;const e=Yv.uint32View[0],n=e>>23&511;return Yv.baseTable[n]+((e&8388607)>>Yv.shiftTable[n])}function IM(t){const e=t>>10;return Yv.uint32View[0]=Yv.mantissaTable[Yv.offsetTable[e]+(t&1023)]+Yv.exponentTable[e],Yv.floatView[0]}class TAe{static toHalfFloat(e){return qh(e)}static fromHalfFloat(e){return IM(e)}}const hc=new Oe,PP=new xt;let xAe=0;class ar{constructor(e,n,i=!1){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,Object.defineProperty(this,"id",{value:xAe++}),this.name="",this.array=e,this.itemSize=n,this.count=e!==void 0?e.length/n:0,this.normalized=i,this.usage=KO,this.updateRanges=[],this.gpuType=vu,this.version=0}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}setUsage(e){return this.usage=e,this}addUpdateRange(e,n){this.updateRanges.push({start:e,count:n})}clearUpdateRanges(){this.updateRanges.length=0}copy(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.usage=e.usage,this.gpuType=e.gpuType,this}copyAt(e,n,i){e*=this.itemSize,i*=n.itemSize;for(let r=0,s=this.itemSize;r<s;r++)this.array[e+r]=n.array[i+r];return this}copyArray(e){return this.array.set(e),this}applyMatrix3(e){if(this.itemSize===2)for(let n=0,i=this.count;n<i;n++)PP.fromBufferAttribute(this,n),PP.applyMatrix3(e),this.setXY(n,PP.x,PP.y);else if(this.itemSize===3)for(let n=0,i=this.count;n<i;n++)hc.fromBufferAttribute(this,n),hc.applyMatrix3(e),this.setXYZ(n,hc.x,hc.y,hc.z);return this}applyMatrix4(e){for(let n=0,i=this.count;n<i;n++)hc.fromBufferAttribute(this,n),hc.applyMatrix4(e),this.setXYZ(n,hc.x,hc.y,hc.z);return this}applyNormalMatrix(e){for(let n=0,i=this.count;n<i;n++)hc.fromBufferAttribute(this,n),hc.applyNormalMatrix(e),this.setXYZ(n,hc.x,hc.y,hc.z);return this}transformDirection(e){for(let n=0,i=this.count;n<i;n++)hc.fromBufferAttribute(this,n),hc.transformDirection(e),this.setXYZ(n,hc.x,hc.y,hc.z);return this}set(e,n=0){return this.array.set(e,n),this}getComponent(e,n){let i=this.array[e*this.itemSize+n];return this.normalized&&(i=oh(i,this.array)),i}setComponent(e,n,i){return this.normalized&&(i=ir(i,this.array)),this.array[e*this.itemSize+n]=i,this}getX(e){let n=this.array[e*this.itemSize];return this.normalized&&(n=oh(n,this.array)),n}setX(e,n){return this.normalized&&(n=ir(n,this.array)),this.array[e*this.itemSize]=n,this}getY(e){let n=this.array[e*this.itemSize+1];return this.normalized&&(n=oh(n,this.array)),n}setY(e,n){return this.normalized&&(n=ir(n,this.array)),this.array[e*this.itemSize+1]=n,this}getZ(e){let n=this.array[e*this.itemSize+2];return this.normalized&&(n=oh(n,this.array)),n}setZ(e,n){return this.normalized&&(n=ir(n,this.array)),this.array[e*this.itemSize+2]=n,this}getW(e){let n=this.array[e*this.itemSize+3];return this.normalized&&(n=oh(n,this.array)),n}setW(e,n){return this.normalized&&(n=ir(n,this.array)),this.array[e*this.itemSize+3]=n,this}setXY(e,n,i){return e*=this.itemSize,this.normalized&&(n=ir(n,this.array),i=ir(i,this.array)),this.array[e+0]=n,this.array[e+1]=i,this}setXYZ(e,n,i,r){return e*=this.itemSize,this.normalized&&(n=ir(n,this.array),i=ir(i,this.array),r=ir(r,this.array)),this.array[e+0]=n,this.array[e+1]=i,this.array[e+2]=r,this}setXYZW(e,n,i,r,s){return e*=this.itemSize,this.normalized&&(n=ir(n,this.array),i=ir(i,this.array),r=ir(r,this.array),s=ir(s,this.array)),this.array[e+0]=n,this.array[e+1]=i,this.array[e+2]=r,this.array[e+3]=s,this}onUpload(e){return this.onUploadCallback=e,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){const e={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};return this.name!==""&&(e.name=this.name),this.usage!==KO&&(e.usage=this.usage),e}}class wAe extends ar{constructor(e,n,i){super(new Int8Array(e),n,i)}}class CAe extends ar{constructor(e,n,i){super(new Uint8Array(e),n,i)}}class AAe extends ar{constructor(e,n,i){super(new Uint8ClampedArray(e),n,i)}}class RAe extends ar{constructor(e,n,i){super(new Int16Array(e),n,i)}}class J7 extends ar{constructor(e,n,i){super(new Uint16Array(e),n,i)}}class MAe extends ar{constructor(e,n,i){super(new Int32Array(e),n,i)}}class Q7 extends ar{constructor(e,n,i){super(new Uint32Array(e),n,i)}}class OAe extends ar{constructor(e,n,i){super(new Uint16Array(e),n,i),this.isFloat16BufferAttribute=!0}getX(e){let n=IM(this.array[e*this.itemSize]);return this.normalized&&(n=oh(n,this.array)),n}setX(e,n){return this.normalized&&(n=ir(n,this.array)),this.array[e*this.itemSize]=qh(n),this}getY(e){let n=IM(this.array[e*this.itemSize+1]);return this.normalized&&(n=oh(n,this.array)),n}setY(e,n){return this.normalized&&(n=ir(n,this.array)),this.array[e*this.itemSize+1]=qh(n),this}getZ(e){let n=IM(this.array[e*this.itemSize+2]);return this.normalized&&(n=oh(n,this.array)),n}setZ(e,n){return this.normalized&&(n=ir(n,this.array)),this.array[e*this.itemSize+2]=qh(n),this}getW(e){let n=IM(this.array[e*this.itemSize+3]);return this.normalized&&(n=oh(n,this.array)),n}setW(e,n){return this.normalized&&(n=ir(n,this.array)),this.array[e*this.itemSize+3]=qh(n),this}setXY(e,n,i){return e*=this.itemSize,this.normalized&&(n=ir(n,this.array),i=ir(i,this.array)),this.array[e+0]=qh(n),this.array[e+1]=qh(i),this}setXYZ(e,n,i,r){return e*=this.itemSize,this.normalized&&(n=ir(n,this.array),i=ir(i,this.array),r=ir(r,this.array)),this.array[e+0]=qh(n),this.array[e+1]=qh(i),this.array[e+2]=qh(r),this}setXYZW(e,n,i,r,s){return e*=this.itemSize,this.normalized&&(n=ir(n,this.array),i=ir(i,this.array),r=ir(r,this.array),s=ir(s,this.array)),this.array[e+0]=qh(n),this.array[e+1]=qh(i),this.array[e+2]=qh(r),this.array[e+3]=qh(s),this}}class qn extends ar{constructor(e,n,i){super(new Float32Array(e),n,i)}}let NAe=0;const Hf=new gi,O5=new Wr,$x=new Oe,Vd=new Su,YR=new Su,pl=new Oe;class tr extends _f{constructor(){super(),this.isBufferGeometry=!0,Object.defineProperty(this,"id",{value:NAe++}),this.uuid=cf(),this.name="",this.type="BufferGeometry",this.index=null,this.indirect=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(e){return Array.isArray(e)?this.index=new(Hle(e)?Q7:J7)(e,1):this.index=e,this}setIndirect(e){return this.indirect=e,this}getIndirect(){return this.indirect}getAttribute(e){return this.attributes[e]}setAttribute(e,n){return this.attributes[e]=n,this}deleteAttribute(e){return delete this.attributes[e],this}hasAttribute(e){return this.attributes[e]!==void 0}addGroup(e,n,i=0){this.groups.push({start:e,count:n,materialIndex:i})}clearGroups(){this.groups=[]}setDrawRange(e,n){this.drawRange.start=e,this.drawRange.count=n}applyMatrix4(e){const n=this.attributes.position;n!==void 0&&(n.applyMatrix4(e),n.needsUpdate=!0);const i=this.attributes.normal;if(i!==void 0){const s=new Qi().getNormalMatrix(e);i.applyNormalMatrix(s),i.needsUpdate=!0}const r=this.attributes.tangent;return r!==void 0&&(r.transformDirection(e),r.needsUpdate=!0),this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this}applyQuaternion(e){return Hf.makeRotationFromQuaternion(e),this.applyMatrix4(Hf),this}rotateX(e){return Hf.makeRotationX(e),this.applyMatrix4(Hf),this}rotateY(e){return Hf.makeRotationY(e),this.applyMatrix4(Hf),this}rotateZ(e){return Hf.makeRotationZ(e),this.applyMatrix4(Hf),this}translate(e,n,i){return Hf.makeTranslation(e,n,i),this.applyMatrix4(Hf),this}scale(e,n,i){return Hf.makeScale(e,n,i),this.applyMatrix4(Hf),this}lookAt(e){return O5.lookAt(e),O5.updateMatrix(),this.applyMatrix4(O5.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter($x).negate(),this.translate($x.x,$x.y,$x.z),this}setFromPoints(e){const n=this.getAttribute("position");if(n===void 0){const i=[];for(let r=0,s=e.length;r<s;r++){const a=e[r];i.push(a.x,a.y,a.z||0)}this.setAttribute("position",new qn(i,3))}else{const i=Math.min(e.length,n.count);for(let r=0;r<i;r++){const s=e[r];n.setXYZ(r,s.x,s.y,s.z||0)}e.length>n.count&&console.warn("THREE.BufferGeometry: Buffer size too small for points data. Use .dispose() and create a new geometry."),n.needsUpdate=!0}return this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new Su);const e=this.attributes.position,n=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){console.error("THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box.",this),this.boundingBox.set(new Oe(-1/0,-1/0,-1/0),new Oe(1/0,1/0,1/0));return}if(e!==void 0){if(this.boundingBox.setFromBufferAttribute(e),n)for(let i=0,r=n.length;i<r;i++){const s=n[i];Vd.setFromBufferAttribute(s),this.morphTargetsRelative?(pl.addVectors(this.boundingBox.min,Vd.min),this.boundingBox.expandByPoint(pl),pl.addVectors(this.boundingBox.max,Vd.max),this.boundingBox.expandByPoint(pl)):(this.boundingBox.expandByPoint(Vd.min),this.boundingBox.expandByPoint(Vd.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new Kl);const e=this.attributes.position,n=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){console.error("THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere.",this),this.boundingSphere.set(new Oe,1/0);return}if(e){const i=this.boundingSphere.center;if(Vd.setFromBufferAttribute(e),n)for(let s=0,a=n.length;s<a;s++){const o=n[s];YR.setFromBufferAttribute(o),this.morphTargetsRelative?(pl.addVectors(Vd.min,YR.min),Vd.expandByPoint(pl),pl.addVectors(Vd.max,YR.max),Vd.expandByPoint(pl)):(Vd.expandByPoint(YR.min),Vd.expandByPoint(YR.max))}Vd.getCenter(i);let r=0;for(let s=0,a=e.count;s<a;s++)pl.fromBufferAttribute(e,s),r=Math.max(r,i.distanceToSquared(pl));if(n)for(let s=0,a=n.length;s<a;s++){const o=n[s],c=this.morphTargetsRelative;for(let l=0,u=o.count;l<u;l++)pl.fromBufferAttribute(o,l),c&&($x.fromBufferAttribute(e,l),pl.add($x)),r=Math.max(r,i.distanceToSquared(pl))}this.boundingSphere.radius=Math.sqrt(r),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){const e=this.index,n=this.attributes;if(e===null||n.position===void 0||n.normal===void 0||n.uv===void 0){console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");return}const i=n.position,r=n.normal,s=n.uv;this.hasAttribute("tangent")===!1&&this.setAttribute("tangent",new ar(new Float32Array(4*i.count),4));const a=this.getAttribute("tangent"),o=[],c=[];for(let k=0;k<i.count;k++)o[k]=new Oe,c[k]=new Oe;const l=new Oe,u=new Oe,h=new Oe,d=new xt,f=new xt,p=new xt,g=new Oe,_=new Oe;function v(k,P,U){l.fromBufferAttribute(i,k),u.fromBufferAttribute(i,P),h.fromBufferAttribute(i,U),d.fromBufferAttribute(s,k),f.fromBufferAttribute(s,P),p.fromBufferAttribute(s,U),u.sub(l),h.sub(l),f.sub(d),p.sub(d);const V=1/(f.x*p.y-p.x*f.y);isFinite(V)&&(g.copy(u).multiplyScalar(p.y).addScaledVector(h,-f.y).multiplyScalar(V),_.copy(h).multiplyScalar(f.x).addScaledVector(u,-p.x).multiplyScalar(V),o[k].add(g),o[P].add(g),o[U].add(g),c[k].add(_),c[P].add(_),c[U].add(_))}let b=this.groups;b.length===0&&(b=[{start:0,count:e.count}]);for(let k=0,P=b.length;k<P;++k){const U=b[k],V=U.start,$=U.count;for(let q=V,Y=V+$;q<Y;q+=3)v(e.getX(q+0),e.getX(q+1),e.getX(q+2))}const S=new Oe,x=new Oe,M=new Oe,R=new Oe;function I(k){M.fromBufferAttribute(r,k),R.copy(M);const P=o[k];S.copy(P),S.sub(M.multiplyScalar(M.dot(P))).normalize(),x.crossVectors(R,P);const V=x.dot(c[k])<0?-1:1;a.setXYZW(k,S.x,S.y,S.z,V)}for(let k=0,P=b.length;k<P;++k){const U=b[k],V=U.start,$=U.count;for(let q=V,Y=V+$;q<Y;q+=3)I(e.getX(q+0)),I(e.getX(q+1)),I(e.getX(q+2))}}computeVertexNormals(){const e=this.index,n=this.getAttribute("position");if(n!==void 0){let i=this.getAttribute("normal");if(i===void 0)i=new ar(new Float32Array(n.count*3),3),this.setAttribute("normal",i);else for(let d=0,f=i.count;d<f;d++)i.setXYZ(d,0,0,0);const r=new Oe,s=new Oe,a=new Oe,o=new Oe,c=new Oe,l=new Oe,u=new Oe,h=new Oe;if(e)for(let d=0,f=e.count;d<f;d+=3){const p=e.getX(d+0),g=e.getX(d+1),_=e.getX(d+2);r.fromBufferAttribute(n,p),s.fromBufferAttribute(n,g),a.fromBufferAttribute(n,_),u.subVectors(a,s),h.subVectors(r,s),u.cross(h),o.fromBufferAttribute(i,p),c.fromBufferAttribute(i,g),l.fromBufferAttribute(i,_),o.add(u),c.add(u),l.add(u),i.setXYZ(p,o.x,o.y,o.z),i.setXYZ(g,c.x,c.y,c.z),i.setXYZ(_,l.x,l.y,l.z)}else for(let d=0,f=n.count;d<f;d+=3)r.fromBufferAttribute(n,d+0),s.fromBufferAttribute(n,d+1),a.fromBufferAttribute(n,d+2),u.subVectors(a,s),h.subVectors(r,s),u.cross(h),i.setXYZ(d+0,u.x,u.y,u.z),i.setXYZ(d+1,u.x,u.y,u.z),i.setXYZ(d+2,u.x,u.y,u.z);this.normalizeNormals(),i.needsUpdate=!0}}normalizeNormals(){const e=this.attributes.normal;for(let n=0,i=e.count;n<i;n++)pl.fromBufferAttribute(e,n),pl.normalize(),e.setXYZ(n,pl.x,pl.y,pl.z)}toNonIndexed(){function e(o,c){const l=o.array,u=o.itemSize,h=o.normalized,d=new l.constructor(c.length*u);let f=0,p=0;for(let g=0,_=c.length;g<_;g++){o.isInterleavedBufferAttribute?f=c[g]*o.data.stride+o.offset:f=c[g]*u;for(let v=0;v<u;v++)d[p++]=l[f++]}return new ar(d,u,h)}if(this.index===null)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;const n=new tr,i=this.index.array,r=this.attributes;for(const o in r){const c=r[o],l=e(c,i);n.setAttribute(o,l)}const s=this.morphAttributes;for(const o in s){const c=[],l=s[o];for(let u=0,h=l.length;u<h;u++){const d=l[u],f=e(d,i);c.push(f)}n.morphAttributes[o]=c}n.morphTargetsRelative=this.morphTargetsRelative;const a=this.groups;for(let o=0,c=a.length;o<c;o++){const l=a[o];n.addGroup(l.start,l.count,l.materialIndex)}return n}toJSON(){const e={metadata:{version:4.6,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,this.name!==""&&(e.name=this.name),Object.keys(this.userData).length>0&&(e.userData=this.userData),this.parameters!==void 0){const c=this.parameters;for(const l in c)c[l]!==void 0&&(e[l]=c[l]);return e}e.data={attributes:{}};const n=this.index;n!==null&&(e.data.index={type:n.array.constructor.name,array:Array.prototype.slice.call(n.array)});const i=this.attributes;for(const c in i){const l=i[c];e.data.attributes[c]=l.toJSON(e.data)}const r={};let s=!1;for(const c in this.morphAttributes){const l=this.morphAttributes[c],u=[];for(let h=0,d=l.length;h<d;h++){const f=l[h];u.push(f.toJSON(e.data))}u.length>0&&(r[c]=u,s=!0)}s&&(e.data.morphAttributes=r,e.data.morphTargetsRelative=this.morphTargetsRelative);const a=this.groups;a.length>0&&(e.data.groups=JSON.parse(JSON.stringify(a)));const o=this.boundingSphere;return o!==null&&(e.data.boundingSphere={center:o.center.toArray(),radius:o.radius}),e}clone(){return new this.constructor().copy(this)}copy(e){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const n={};this.name=e.name;const i=e.index;i!==null&&this.setIndex(i.clone());const r=e.attributes;for(const l in r){const u=r[l];this.setAttribute(l,u.clone(n))}const s=e.morphAttributes;for(const l in s){const u=[],h=s[l];for(let d=0,f=h.length;d<f;d++)u.push(h[d].clone(n));this.morphAttributes[l]=u}this.morphTargetsRelative=e.morphTargetsRelative;const a=e.groups;for(let l=0,u=a.length;l<u;l++){const h=a[l];this.addGroup(h.start,h.count,h.materialIndex)}const o=e.boundingBox;o!==null&&(this.boundingBox=o.clone());const c=e.boundingSphere;return c!==null&&(this.boundingSphere=c.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,this}dispose(){this.dispatchEvent({type:"dispose"})}}const dJ=new gi,kS=new XA,DP=new Kl,fJ=new Oe,LP=new Oe,UP=new Oe,BP=new Oe,N5=new Oe,FP=new Oe,pJ=new Oe,zP=new Oe;class Io extends Wr{constructor(e=new tr,n=new wE){super(),this.isMesh=!0,this.type="Mesh",this.geometry=e,this.material=n,this.morphTargetDictionary=void 0,this.morphTargetInfluences=void 0,this.updateMorphTargets()}copy(e,n){return super.copy(e,n),e.morphTargetInfluences!==void 0&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),e.morphTargetDictionary!==void 0&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}updateMorphTargets(){const n=this.geometry.morphAttributes,i=Object.keys(n);if(i.length>0){const r=n[i[0]];if(r!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let s=0,a=r.length;s<a;s++){const o=r[s].name||String(s);this.morphTargetInfluences.push(0),this.morphTargetDictionary[o]=s}}}}getVertexPosition(e,n){const i=this.geometry,r=i.attributes.position,s=i.morphAttributes.position,a=i.morphTargetsRelative;n.fromBufferAttribute(r,e);const o=this.morphTargetInfluences;if(s&&o){FP.set(0,0,0);for(let c=0,l=s.length;c<l;c++){const u=o[c],h=s[c];u!==0&&(N5.fromBufferAttribute(h,e),a?FP.addScaledVector(N5,u):FP.addScaledVector(N5.sub(n),u))}n.add(FP)}return n}raycast(e,n){const i=this.geometry,r=this.material,s=this.matrixWorld;r!==void 0&&(i.boundingSphere===null&&i.computeBoundingSphere(),DP.copy(i.boundingSphere),DP.applyMatrix4(s),kS.copy(e.ray).recast(e.near),!(DP.containsPoint(kS.origin)===!1&&(kS.intersectSphere(DP,fJ)===null||kS.origin.distanceToSquared(fJ)>(e.far-e.near)**2))&&(dJ.copy(s).invert(),kS.copy(e.ray).applyMatrix4(dJ),!(i.boundingBox!==null&&kS.intersectsBox(i.boundingBox)===!1)&&this._computeIntersections(e,n,kS)))}_computeIntersections(e,n,i){let r;const s=this.geometry,a=this.material,o=s.index,c=s.attributes.position,l=s.attributes.uv,u=s.attributes.uv1,h=s.attributes.normal,d=s.groups,f=s.drawRange;if(o!==null)if(Array.isArray(a))for(let p=0,g=d.length;p<g;p++){const _=d[p],v=a[_.materialIndex],b=Math.max(_.start,f.start),S=Math.min(o.count,Math.min(_.start+_.count,f.start+f.count));for(let x=b,M=S;x<M;x+=3){const R=o.getX(x),I=o.getX(x+1),k=o.getX(x+2);r=jP(this,v,e,i,l,u,h,R,I,k),r&&(r.faceIndex=Math.floor(x/3),r.face.materialIndex=_.materialIndex,n.push(r))}}else{const p=Math.max(0,f.start),g=Math.min(o.count,f.start+f.count);for(let _=p,v=g;_<v;_+=3){const b=o.getX(_),S=o.getX(_+1),x=o.getX(_+2);r=jP(this,a,e,i,l,u,h,b,S,x),r&&(r.faceIndex=Math.floor(_/3),n.push(r))}}else if(c!==void 0)if(Array.isArray(a))for(let p=0,g=d.length;p<g;p++){const _=d[p],v=a[_.materialIndex],b=Math.max(_.start,f.start),S=Math.min(c.count,Math.min(_.start+_.count,f.start+f.count));for(let x=b,M=S;x<M;x+=3){const R=x,I=x+1,k=x+2;r=jP(this,v,e,i,l,u,h,R,I,k),r&&(r.faceIndex=Math.floor(x/3),r.face.materialIndex=_.materialIndex,n.push(r))}}else{const p=Math.max(0,f.start),g=Math.min(c.count,f.start+f.count);for(let _=p,v=g;_<v;_+=3){const b=_,S=_+1,x=_+2;r=jP(this,a,e,i,l,u,h,b,S,x),r&&(r.faceIndex=Math.floor(_/3),n.push(r))}}}}function IAe(t,e,n,i,r,s,a,o){let c;if(e.side===$c?c=i.intersectTriangle(a,s,r,!0,o):c=i.intersectTriangle(r,s,a,e.side===r0,o),c===null)return null;zP.copy(o),zP.applyMatrix4(t.matrixWorld);const l=n.ray.origin.distanceTo(zP);return l<n.near||l>n.far?null:{distance:l,point:zP.clone(),object:t}}function jP(t,e,n,i,r,s,a,o,c,l){t.getVertexPosition(o,LP),t.getVertexPosition(c,UP),t.getVertexPosition(l,BP);const u=IAe(t,e,n,i,LP,UP,BP,pJ);if(u){const h=new Oe;td.getBarycoord(pJ,LP,UP,BP,h),r&&(u.uv=td.getInterpolatedAttribute(r,o,c,l,h,new xt)),s&&(u.uv1=td.getInterpolatedAttribute(s,o,c,l,h,new xt)),a&&(u.normal=td.getInterpolatedAttribute(a,o,c,l,h,new Oe),u.normal.dot(i.direction)>0&&u.normal.multiplyScalar(-1));const d={a:o,b:c,c:l,normal:new Oe,materialIndex:0};td.getNormal(LP,UP,BP,d.normal),u.face=d,u.barycoord=h}return u}class P1 extends tr{constructor(e=1,n=1,i=1,r=1,s=1,a=1){super(),this.type="BoxGeometry",this.parameters={width:e,height:n,depth:i,widthSegments:r,heightSegments:s,depthSegments:a};const o=this;r=Math.floor(r),s=Math.floor(s),a=Math.floor(a);const c=[],l=[],u=[],h=[];let d=0,f=0;p("z","y","x",-1,-1,i,n,e,a,s,0),p("z","y","x",1,-1,i,n,-e,a,s,1),p("x","z","y",1,1,e,i,n,r,a,2),p("x","z","y",1,-1,e,i,-n,r,a,3),p("x","y","z",1,-1,e,n,i,r,s,4),p("x","y","z",-1,-1,e,n,-i,r,s,5),this.setIndex(c),this.setAttribute("position",new qn(l,3)),this.setAttribute("normal",new qn(u,3)),this.setAttribute("uv",new qn(h,2));function p(g,_,v,b,S,x,M,R,I,k,P){const U=x/I,V=M/k,$=x/2,q=M/2,Y=R/2,te=I+1,G=k+1;let J=0,K=0;const X=new Oe;for(let ae=0;ae<G;ae++){const ce=ae*V-q;for(let Me=0;Me<te;Me++){const Fe=Me*U-$;X[g]=Fe*b,X[_]=ce*S,X[v]=Y,l.push(X.x,X.y,X.z),X[g]=0,X[_]=0,X[v]=R>0?1:-1,u.push(X.x,X.y,X.z),h.push(Me/I),h.push(1-ae/k),J+=1}}for(let ae=0;ae<k;ae++)for(let ce=0;ce<I;ce++){const Me=d+ce+te*ae,Fe=d+ce+te*(ae+1),Te=d+(ce+1)+te*(ae+1),Re=d+(ce+1)+te*ae;c.push(Me,Fe,Re),c.push(Fe,Te,Re),K+=6}o.addGroup(f,K,P),f+=K,d+=J}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new P1(e.width,e.height,e.depth,e.widthSegments,e.heightSegments,e.depthSegments)}}function HC(t){const e={};for(const n in t){e[n]={};for(const i in t[n]){const r=t[n][i];r&&(r.isColor||r.isMatrix3||r.isMatrix4||r.isVector2||r.isVector3||r.isVector4||r.isTexture||r.isQuaternion)?r.isRenderTargetTexture?(console.warn("UniformsUtils: Textures of render targets cannot be cloned via cloneUniforms() or mergeUniforms()."),e[n][i]=null):e[n][i]=r.clone():Array.isArray(r)?e[n][i]=r.slice():e[n][i]=r}}return e}function th(t){const e={};for(let n=0;n<t.length;n++){const i=HC(t[n]);for(const r in i)e[r]=i[r]}return e}function kAe(t){const e=[];for(let n=0;n<t.length;n++)e.push(t[n].clone());return e}function $le(t){const e=t.getRenderTarget();return e===null?t.outputColorSpace:e.isXRRenderTarget===!0?e.texture.colorSpace:Br.workingColorSpace}const Wle={clone:HC,merge:th};var PAe=`void main() {
	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}`,DAe=`void main() {
	gl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );
}`;class qa extends rl{constructor(e){super(),this.isShaderMaterial=!0,this.type="ShaderMaterial",this.defines={},this.uniforms={},this.uniformsGroups=[],this.vertexShader=PAe,this.fragmentShader=DAe,this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.forceSinglePass=!0,this.extensions={clipCullDistance:!1,multiDraw:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv1:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,e!==void 0&&this.setValues(e)}copy(e){return super.copy(e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=HC(e.uniforms),this.uniformsGroups=kAe(e.uniformsGroups),this.defines=Object.assign({},e.defines),this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.fog=e.fog,this.lights=e.lights,this.clipping=e.clipping,this.extensions=Object.assign({},e.extensions),this.glslVersion=e.glslVersion,this}toJSON(e){const n=super.toJSON(e);n.glslVersion=this.glslVersion,n.uniforms={};for(const r in this.uniforms){const a=this.uniforms[r].value;a&&a.isTexture?n.uniforms[r]={type:"t",value:a.toJSON(e).uuid}:a&&a.isColor?n.uniforms[r]={type:"c",value:a.getHex()}:a&&a.isVector2?n.uniforms[r]={type:"v2",value:a.toArray()}:a&&a.isVector3?n.uniforms[r]={type:"v3",value:a.toArray()}:a&&a.isVector4?n.uniforms[r]={type:"v4",value:a.toArray()}:a&&a.isMatrix3?n.uniforms[r]={type:"m3",value:a.toArray()}:a&&a.isMatrix4?n.uniforms[r]={type:"m4",value:a.toArray()}:n.uniforms[r]={value:a}}Object.keys(this.defines).length>0&&(n.defines=this.defines),n.vertexShader=this.vertexShader,n.fragmentShader=this.fragmentShader,n.lights=this.lights,n.clipping=this.clipping;const i={};for(const r in this.extensions)this.extensions[r]===!0&&(i[r]=!0);return Object.keys(i).length>0&&(n.extensions=i),n}}class DI extends Wr{constructor(){super(),this.isCamera=!0,this.type="Camera",this.matrixWorldInverse=new gi,this.projectionMatrix=new gi,this.projectionMatrixInverse=new gi,this.coordinateSystem=lp}copy(e,n){return super.copy(e,n),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this.coordinateSystem=e.coordinateSystem,this}getWorldDirection(e){return super.getWorldDirection(e).negate()}updateMatrixWorld(e){super.updateMatrixWorld(e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(e,n){super.updateWorldMatrix(e,n),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return new this.constructor().copy(this)}}const Dy=new Oe,mJ=new xt,gJ=new xt;let Hc=class extends DI{constructor(e=50,n=1,i=.1,r=2e3){super(),this.isPerspectiveCamera=!0,this.type="PerspectiveCamera",this.fov=e,this.zoom=1,this.near=i,this.far=r,this.focus=10,this.aspect=n,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(e,n){return super.copy(e,n),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=e.view===null?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this}setFocalLength(e){const n=.5*this.getFilmHeight()/e;this.fov=zC*2*Math.atan(n),this.updateProjectionMatrix()}getFocalLength(){const e=Math.tan(RT*.5*this.fov);return .5*this.getFilmHeight()/e}getEffectiveFOV(){return zC*2*Math.atan(Math.tan(RT*.5*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}getViewBounds(e,n,i){Dy.set(-1,-1,.5).applyMatrix4(this.projectionMatrixInverse),n.set(Dy.x,Dy.y).multiplyScalar(-e/Dy.z),Dy.set(1,1,.5).applyMatrix4(this.projectionMatrixInverse),i.set(Dy.x,Dy.y).multiplyScalar(-e/Dy.z)}getViewSize(e,n){return this.getViewBounds(e,mJ,gJ),n.subVectors(gJ,mJ)}setViewOffset(e,n,i,r,s,a){this.aspect=e/n,this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=n,this.view.offsetX=i,this.view.offsetY=r,this.view.width=s,this.view.height=a,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=this.near;let n=e*Math.tan(RT*.5*this.fov)/this.zoom,i=2*n,r=this.aspect*i,s=-.5*r;const a=this.view;if(this.view!==null&&this.view.enabled){const c=a.fullWidth,l=a.fullHeight;s+=a.offsetX*r/c,n-=a.offsetY*i/l,r*=a.width/c,i*=a.height/l}const o=this.filmOffset;o!==0&&(s+=e*o/this.getFilmWidth()),this.projectionMatrix.makePerspective(s,s+r,n,n-i,e,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const n=super.toJSON(e);return n.object.fov=this.fov,n.object.zoom=this.zoom,n.object.near=this.near,n.object.far=this.far,n.object.focus=this.focus,n.object.aspect=this.aspect,this.view!==null&&(n.object.view=Object.assign({},this.view)),n.object.filmGauge=this.filmGauge,n.object.filmOffset=this.filmOffset,n}};const Wx=-90,Yx=1;class Yle extends Wr{constructor(e,n,i){super(),this.type="CubeCamera",this.renderTarget=i,this.coordinateSystem=null,this.activeMipmapLevel=0;const r=new Hc(Wx,Yx,e,n);r.layers=this.layers,this.add(r);const s=new Hc(Wx,Yx,e,n);s.layers=this.layers,this.add(s);const a=new Hc(Wx,Yx,e,n);a.layers=this.layers,this.add(a);const o=new Hc(Wx,Yx,e,n);o.layers=this.layers,this.add(o);const c=new Hc(Wx,Yx,e,n);c.layers=this.layers,this.add(c);const l=new Hc(Wx,Yx,e,n);l.layers=this.layers,this.add(l)}updateCoordinateSystem(){const e=this.coordinateSystem,n=this.children.concat(),[i,r,s,a,o,c]=n;for(const l of n)this.remove(l);if(e===lp)i.up.set(0,1,0),i.lookAt(1,0,0),r.up.set(0,1,0),r.lookAt(-1,0,0),s.up.set(0,0,-1),s.lookAt(0,1,0),a.up.set(0,0,1),a.lookAt(0,-1,0),o.up.set(0,1,0),o.lookAt(0,0,1),c.up.set(0,1,0),c.lookAt(0,0,-1);else if(e===XO)i.up.set(0,-1,0),i.lookAt(-1,0,0),r.up.set(0,-1,0),r.lookAt(1,0,0),s.up.set(0,0,1),s.lookAt(0,1,0),a.up.set(0,0,-1),a.lookAt(0,-1,0),o.up.set(0,-1,0),o.lookAt(0,0,1),c.up.set(0,-1,0),c.lookAt(0,0,-1);else throw new Error("THREE.CubeCamera.updateCoordinateSystem(): Invalid coordinate system: "+e);for(const l of n)this.add(l),l.updateMatrixWorld()}update(e,n){this.parent===null&&this.updateMatrixWorld();const{renderTarget:i,activeMipmapLevel:r}=this;this.coordinateSystem!==e.coordinateSystem&&(this.coordinateSystem=e.coordinateSystem,this.updateCoordinateSystem());const[s,a,o,c,l,u]=this.children,h=e.getRenderTarget(),d=e.getActiveCubeFace(),f=e.getActiveMipmapLevel(),p=e.xr.enabled;e.xr.enabled=!1;const g=i.texture.generateMipmaps;i.texture.generateMipmaps=!1,e.setRenderTarget(i,0,r),e.render(n,s),e.setRenderTarget(i,1,r),e.render(n,a),e.setRenderTarget(i,2,r),e.render(n,o),e.setRenderTarget(i,3,r),e.render(n,c),e.setRenderTarget(i,4,r),e.render(n,l),i.texture.generateMipmaps=g,e.setRenderTarget(i,5,r),e.render(n,u),e.setRenderTarget(h,d,f),e.xr.enabled=p,i.texture.needsPMREMUpdate=!0}}class LI extends Ga{constructor(e=[],n=T_,i,r,s,a,o,c,l,u){super(e,n,i,r,s,a,o,c,l,u),this.isCubeTexture=!0,this.flipY=!1}get images(){return this.image}set images(e){this.image=e}}class Kle extends Ko{constructor(e=1,n={}){super(e,e,n),this.isWebGLCubeRenderTarget=!0;const i={width:e,height:e,depth:1},r=[i,i,i,i,i,i];this.texture=new LI(r,n.mapping,n.wrapS,n.wrapT,n.magFilter,n.minFilter,n.format,n.type,n.anisotropy,n.colorSpace),this.texture.isRenderTargetTexture=!0,this.texture.generateMipmaps=n.generateMipmaps!==void 0?n.generateMipmaps:!1,this.texture.minFilter=n.minFilter!==void 0?n.minFilter:Ca}fromEquirectangularTexture(e,n){this.texture.type=n.type,this.texture.colorSpace=n.colorSpace,this.texture.generateMipmaps=n.generateMipmaps,this.texture.minFilter=n.minFilter,this.texture.magFilter=n.magFilter;const i={uniforms:{tEquirect:{value:null}},vertexShader:`

				varying vec3 vWorldDirection;

				vec3 transformDirection( in vec3 dir, in mat4 matrix ) {

					return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );

				}

				void main() {

					vWorldDirection = transformDirection( position, modelMatrix );

					#include <begin_vertex>
					#include <project_vertex>

				}
			`,fragmentShader:`

				uniform sampler2D tEquirect;

				varying vec3 vWorldDirection;

				#include <common>

				void main() {

					vec3 direction = normalize( vWorldDirection );

					vec2 sampleUV = equirectUv( direction );

					gl_FragColor = texture2D( tEquirect, sampleUV );

				}
			`},r=new P1(5,5,5),s=new qa({name:"CubemapFromEquirect",uniforms:HC(i.uniforms),vertexShader:i.vertexShader,fragmentShader:i.fragmentShader,side:$c,blending:Eu});s.uniforms.tEquirect.value=n;const a=new Io(r,s),o=n.minFilter;return n.minFilter===Hg&&(n.minFilter=Ca),new Yle(1,10,this).update(e,a),n.minFilter=o,a.geometry.dispose(),a.material.dispose(),this}clear(e,n=!0,i=!0,r=!0){const s=e.getRenderTarget();for(let a=0;a<6;a++)e.setRenderTarget(this,a),e.clear(n,i,r);e.setRenderTarget(s)}}class _T extends Wr{constructor(){super(),this.isGroup=!0,this.type="Group"}}const LAe={type:"move"};class D2{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return this._hand===null&&(this._hand=new _T,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return this._targetRay===null&&(this._targetRay=new _T,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new Oe,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new Oe),this._targetRay}getGripSpace(){return this._grip===null&&(this._grip=new _T,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new Oe,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new Oe),this._grip}dispatchEvent(e){return this._targetRay!==null&&this._targetRay.dispatchEvent(e),this._grip!==null&&this._grip.dispatchEvent(e),this._hand!==null&&this._hand.dispatchEvent(e),this}connect(e){if(e&&e.hand){const n=this._hand;if(n)for(const i of e.hand.values())this._getHandJoint(n,i)}return this.dispatchEvent({type:"connected",data:e}),this}disconnect(e){return this.dispatchEvent({type:"disconnected",data:e}),this._targetRay!==null&&(this._targetRay.visible=!1),this._grip!==null&&(this._grip.visible=!1),this._hand!==null&&(this._hand.visible=!1),this}update(e,n,i){let r=null,s=null,a=null;const o=this._targetRay,c=this._grip,l=this._hand;if(e&&n.session.visibilityState!=="visible-blurred"){if(l&&e.hand){a=!0;for(const g of e.hand.values()){const _=n.getJointPose(g,i),v=this._getHandJoint(l,g);_!==null&&(v.matrix.fromArray(_.transform.matrix),v.matrix.decompose(v.position,v.rotation,v.scale),v.matrixWorldNeedsUpdate=!0,v.jointRadius=_.radius),v.visible=_!==null}const u=l.joints["index-finger-tip"],h=l.joints["thumb-tip"],d=u.position.distanceTo(h.position),f=.02,p=.005;l.inputState.pinching&&d>f+p?(l.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:e.handedness,target:this})):!l.inputState.pinching&&d<=f-p&&(l.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:e.handedness,target:this}))}else c!==null&&e.gripSpace&&(s=n.getPose(e.gripSpace,i),s!==null&&(c.matrix.fromArray(s.transform.matrix),c.matrix.decompose(c.position,c.rotation,c.scale),c.matrixWorldNeedsUpdate=!0,s.linearVelocity?(c.hasLinearVelocity=!0,c.linearVelocity.copy(s.linearVelocity)):c.hasLinearVelocity=!1,s.angularVelocity?(c.hasAngularVelocity=!0,c.angularVelocity.copy(s.angularVelocity)):c.hasAngularVelocity=!1));o!==null&&(r=n.getPose(e.targetRaySpace,i),r===null&&s!==null&&(r=s),r!==null&&(o.matrix.fromArray(r.transform.matrix),o.matrix.decompose(o.position,o.rotation,o.scale),o.matrixWorldNeedsUpdate=!0,r.linearVelocity?(o.hasLinearVelocity=!0,o.linearVelocity.copy(r.linearVelocity)):o.hasLinearVelocity=!1,r.angularVelocity?(o.hasAngularVelocity=!0,o.angularVelocity.copy(r.angularVelocity)):o.hasAngularVelocity=!1,this.dispatchEvent(LAe)))}return o!==null&&(o.visible=r!==null),c!==null&&(c.visible=s!==null),l!==null&&(l.visible=a!==null),this}_getHandJoint(e,n){if(e.joints[n.jointName]===void 0){const i=new _T;i.matrixAutoUpdate=!1,i.visible=!1,e.joints[n.jointName]=i,e.add(i)}return e.joints[n.jointName]}}class aF{constructor(e,n=25e-5){this.isFogExp2=!0,this.name="",this.color=new bn(e),this.density=n}clone(){return new aF(this.color,this.density)}toJSON(){return{type:"FogExp2",name:this.name,color:this.color.getHex(),density:this.density}}}class oF{constructor(e,n=1,i=1e3){this.isFog=!0,this.name="",this.color=new bn(e),this.near=n,this.far=i}clone(){return new oF(this.color,this.near,this.far)}toJSON(){return{type:"Fog",name:this.name,color:this.color.getHex(),near:this.near,far:this.far}}}class VC extends Wr{constructor(){super(),this.isScene=!0,this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.backgroundBlurriness=0,this.backgroundIntensity=1,this.backgroundRotation=new dd,this.environmentIntensity=1,this.environmentRotation=new dd,this.overrideMaterial=null,typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(e,n){return super.copy(e,n),e.background!==null&&(this.background=e.background.clone()),e.environment!==null&&(this.environment=e.environment.clone()),e.fog!==null&&(this.fog=e.fog.clone()),this.backgroundBlurriness=e.backgroundBlurriness,this.backgroundIntensity=e.backgroundIntensity,this.backgroundRotation.copy(e.backgroundRotation),this.environmentIntensity=e.environmentIntensity,this.environmentRotation.copy(e.environmentRotation),e.overrideMaterial!==null&&(this.overrideMaterial=e.overrideMaterial.clone()),this.matrixAutoUpdate=e.matrixAutoUpdate,this}toJSON(e){const n=super.toJSON(e);return this.fog!==null&&(n.object.fog=this.fog.toJSON()),this.backgroundBlurriness>0&&(n.object.backgroundBlurriness=this.backgroundBlurriness),this.backgroundIntensity!==1&&(n.object.backgroundIntensity=this.backgroundIntensity),n.object.backgroundRotation=this.backgroundRotation.toArray(),this.environmentIntensity!==1&&(n.object.environmentIntensity=this.environmentIntensity),n.object.environmentRotation=this.environmentRotation.toArray(),n}}class cF{constructor(e,n){this.isInterleavedBuffer=!0,this.array=e,this.stride=n,this.count=e!==void 0?e.length/n:0,this.usage=KO,this.updateRanges=[],this.version=0,this.uuid=cf()}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}setUsage(e){return this.usage=e,this}addUpdateRange(e,n){this.updateRanges.push({start:e,count:n})}clearUpdateRanges(){this.updateRanges.length=0}copy(e){return this.array=new e.array.constructor(e.array),this.count=e.count,this.stride=e.stride,this.usage=e.usage,this}copyAt(e,n,i){e*=this.stride,i*=n.stride;for(let r=0,s=this.stride;r<s;r++)this.array[e+r]=n.array[i+r];return this}set(e,n=0){return this.array.set(e,n),this}clone(e){e.arrayBuffers===void 0&&(e.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=cf()),e.arrayBuffers[this.array.buffer._uuid]===void 0&&(e.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);const n=new this.array.constructor(e.arrayBuffers[this.array.buffer._uuid]),i=new this.constructor(n,this.stride);return i.setUsage(this.usage),i}onUpload(e){return this.onUploadCallback=e,this}toJSON(e){return e.arrayBuffers===void 0&&(e.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=cf()),e.arrayBuffers[this.array.buffer._uuid]===void 0&&(e.arrayBuffers[this.array.buffer._uuid]=Array.from(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}}const Qu=new Oe;class ZT{constructor(e,n,i,r=!1){this.isInterleavedBufferAttribute=!0,this.name="",this.data=e,this.itemSize=n,this.offset=i,this.normalized=r}get count(){return this.data.count}get array(){return this.data.array}set needsUpdate(e){this.data.needsUpdate=e}applyMatrix4(e){for(let n=0,i=this.data.count;n<i;n++)Qu.fromBufferAttribute(this,n),Qu.applyMatrix4(e),this.setXYZ(n,Qu.x,Qu.y,Qu.z);return this}applyNormalMatrix(e){for(let n=0,i=this.count;n<i;n++)Qu.fromBufferAttribute(this,n),Qu.applyNormalMatrix(e),this.setXYZ(n,Qu.x,Qu.y,Qu.z);return this}transformDirection(e){for(let n=0,i=this.count;n<i;n++)Qu.fromBufferAttribute(this,n),Qu.transformDirection(e),this.setXYZ(n,Qu.x,Qu.y,Qu.z);return this}getComponent(e,n){let i=this.array[e*this.data.stride+this.offset+n];return this.normalized&&(i=oh(i,this.array)),i}setComponent(e,n,i){return this.normalized&&(i=ir(i,this.array)),this.data.array[e*this.data.stride+this.offset+n]=i,this}setX(e,n){return this.normalized&&(n=ir(n,this.array)),this.data.array[e*this.data.stride+this.offset]=n,this}setY(e,n){return this.normalized&&(n=ir(n,this.array)),this.data.array[e*this.data.stride+this.offset+1]=n,this}setZ(e,n){return this.normalized&&(n=ir(n,this.array)),this.data.array[e*this.data.stride+this.offset+2]=n,this}setW(e,n){return this.normalized&&(n=ir(n,this.array)),this.data.array[e*this.data.stride+this.offset+3]=n,this}getX(e){let n=this.data.array[e*this.data.stride+this.offset];return this.normalized&&(n=oh(n,this.array)),n}getY(e){let n=this.data.array[e*this.data.stride+this.offset+1];return this.normalized&&(n=oh(n,this.array)),n}getZ(e){let n=this.data.array[e*this.data.stride+this.offset+2];return this.normalized&&(n=oh(n,this.array)),n}getW(e){let n=this.data.array[e*this.data.stride+this.offset+3];return this.normalized&&(n=oh(n,this.array)),n}setXY(e,n,i){return e=e*this.data.stride+this.offset,this.normalized&&(n=ir(n,this.array),i=ir(i,this.array)),this.data.array[e+0]=n,this.data.array[e+1]=i,this}setXYZ(e,n,i,r){return e=e*this.data.stride+this.offset,this.normalized&&(n=ir(n,this.array),i=ir(i,this.array),r=ir(r,this.array)),this.data.array[e+0]=n,this.data.array[e+1]=i,this.data.array[e+2]=r,this}setXYZW(e,n,i,r,s){return e=e*this.data.stride+this.offset,this.normalized&&(n=ir(n,this.array),i=ir(i,this.array),r=ir(r,this.array),s=ir(s,this.array)),this.data.array[e+0]=n,this.data.array[e+1]=i,this.data.array[e+2]=r,this.data.array[e+3]=s,this}clone(e){if(e===void 0){console.log("THREE.InterleavedBufferAttribute.clone(): Cloning an interleaved buffer attribute will de-interleave buffer data.");const n=[];for(let i=0;i<this.count;i++){const r=i*this.data.stride+this.offset;for(let s=0;s<this.itemSize;s++)n.push(this.data.array[r+s])}return new ar(new this.array.constructor(n),this.itemSize,this.normalized)}else return e.interleavedBuffers===void 0&&(e.interleavedBuffers={}),e.interleavedBuffers[this.data.uuid]===void 0&&(e.interleavedBuffers[this.data.uuid]=this.data.clone(e)),new ZT(e.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)}toJSON(e){if(e===void 0){console.log("THREE.InterleavedBufferAttribute.toJSON(): Serializing an interleaved buffer attribute will de-interleave buffer data.");const n=[];for(let i=0;i<this.count;i++){const r=i*this.data.stride+this.offset;for(let s=0;s<this.itemSize;s++)n.push(this.data.array[r+s])}return{itemSize:this.itemSize,type:this.array.constructor.name,array:n,normalized:this.normalized}}else return e.interleavedBuffers===void 0&&(e.interleavedBuffers={}),e.interleavedBuffers[this.data.uuid]===void 0&&(e.interleavedBuffers[this.data.uuid]=this.data.toJSON(e)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}}class eW extends rl{constructor(e){super(),this.isSpriteMaterial=!0,this.type="SpriteMaterial",this.color=new bn(16777215),this.map=null,this.alphaMap=null,this.rotation=0,this.sizeAttenuation=!0,this.transparent=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.rotation=e.rotation,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}}let Kx;const KR=new Oe,Xx=new Oe,Zx=new Oe,Jx=new xt,XR=new xt,Xle=new gi,HP=new Oe,ZR=new Oe,VP=new Oe,vJ=new xt,I5=new xt,_J=new xt;class Zle extends Wr{constructor(e=new eW){if(super(),this.isSprite=!0,this.type="Sprite",Kx===void 0){Kx=new tr;const n=new Float32Array([-.5,-.5,0,0,0,.5,-.5,0,1,0,.5,.5,0,1,1,-.5,.5,0,0,1]),i=new cF(n,5);Kx.setIndex([0,1,2,0,2,3]),Kx.setAttribute("position",new ZT(i,3,0,!1)),Kx.setAttribute("uv",new ZT(i,2,3,!1))}this.geometry=Kx,this.material=e,this.center=new xt(.5,.5)}raycast(e,n){e.camera===null&&console.error('THREE.Sprite: "Raycaster.camera" needs to be set in order to raycast against sprites.'),Xx.setFromMatrixScale(this.matrixWorld),Xle.copy(e.camera.matrixWorld),this.modelViewMatrix.multiplyMatrices(e.camera.matrixWorldInverse,this.matrixWorld),Zx.setFromMatrixPosition(this.modelViewMatrix),e.camera.isPerspectiveCamera&&this.material.sizeAttenuation===!1&&Xx.multiplyScalar(-Zx.z);const i=this.material.rotation;let r,s;i!==0&&(s=Math.cos(i),r=Math.sin(i));const a=this.center;GP(HP.set(-.5,-.5,0),Zx,a,Xx,r,s),GP(ZR.set(.5,-.5,0),Zx,a,Xx,r,s),GP(VP.set(.5,.5,0),Zx,a,Xx,r,s),vJ.set(0,0),I5.set(1,0),_J.set(1,1);let o=e.ray.intersectTriangle(HP,ZR,VP,!1,KR);if(o===null&&(GP(ZR.set(-.5,.5,0),Zx,a,Xx,r,s),I5.set(0,1),o=e.ray.intersectTriangle(HP,VP,ZR,!1,KR),o===null))return;const c=e.ray.origin.distanceTo(KR);c<e.near||c>e.far||n.push({distance:c,point:KR.clone(),uv:td.getInterpolation(KR,HP,ZR,VP,vJ,I5,_J,new xt),face:null,object:this})}copy(e,n){return super.copy(e,n),e.center!==void 0&&this.center.copy(e.center),this.material=e.material,this}}function GP(t,e,n,i,r,s){Jx.subVectors(t,n).addScalar(.5).multiply(i),r!==void 0?(XR.x=s*Jx.x-r*Jx.y,XR.y=r*Jx.x+s*Jx.y):XR.copy(Jx),t.copy(e),t.x+=XR.x,t.y+=XR.y,t.applyMatrix4(Xle)}const qP=new Oe,yJ=new Oe;class Jle extends Wr{constructor(){super(),this.isLOD=!0,this._currentLevel=0,this.type="LOD",Object.defineProperties(this,{levels:{enumerable:!0,value:[]}}),this.autoUpdate=!0}copy(e){super.copy(e,!1);const n=e.levels;for(let i=0,r=n.length;i<r;i++){const s=n[i];this.addLevel(s.object.clone(),s.distance,s.hysteresis)}return this.autoUpdate=e.autoUpdate,this}addLevel(e,n=0,i=0){n=Math.abs(n);const r=this.levels;let s;for(s=0;s<r.length&&!(n<r[s].distance);s++);return r.splice(s,0,{distance:n,hysteresis:i,object:e}),this.add(e),this}removeLevel(e){const n=this.levels;for(let i=0;i<n.length;i++)if(n[i].distance===e){const r=n.splice(i,1);return this.remove(r[0].object),!0}return!1}getCurrentLevel(){return this._currentLevel}getObjectForDistance(e){const n=this.levels;if(n.length>0){let i,r;for(i=1,r=n.length;i<r;i++){let s=n[i].distance;if(n[i].object.visible&&(s-=s*n[i].hysteresis),e<s)break}return n[i-1].object}return null}raycast(e,n){if(this.levels.length>0){qP.setFromMatrixPosition(this.matrixWorld);const r=e.ray.origin.distanceTo(qP);this.getObjectForDistance(r).raycast(e,n)}}update(e){const n=this.levels;if(n.length>1){qP.setFromMatrixPosition(e.matrixWorld),yJ.setFromMatrixPosition(this.matrixWorld);const i=qP.distanceTo(yJ)/e.zoom;n[0].object.visible=!0;let r,s;for(r=1,s=n.length;r<s;r++){let a=n[r].distance;if(n[r].object.visible&&(a-=a*n[r].hysteresis),i>=a)n[r-1].object.visible=!1,n[r].object.visible=!0;else break}for(this._currentLevel=r-1;r<s;r++)n[r].object.visible=!1}}toJSON(e){const n=super.toJSON(e);this.autoUpdate===!1&&(n.object.autoUpdate=!1),n.object.levels=[];const i=this.levels;for(let r=0,s=i.length;r<s;r++){const a=i[r];n.object.levels.push({object:a.object.uuid,distance:a.distance,hysteresis:a.hysteresis})}return n}}const bJ=new Oe,EJ=new zr,SJ=new zr,UAe=new Oe,TJ=new gi,$P=new Oe,k5=new Kl,xJ=new gi,P5=new XA;class Qle extends Io{constructor(e,n){super(e,n),this.isSkinnedMesh=!0,this.type="SkinnedMesh",this.bindMode=XV,this.bindMatrix=new gi,this.bindMatrixInverse=new gi,this.boundingBox=null,this.boundingSphere=null}computeBoundingBox(){const e=this.geometry;this.boundingBox===null&&(this.boundingBox=new Su),this.boundingBox.makeEmpty();const n=e.getAttribute("position");for(let i=0;i<n.count;i++)this.getVertexPosition(i,$P),this.boundingBox.expandByPoint($P)}computeBoundingSphere(){const e=this.geometry;this.boundingSphere===null&&(this.boundingSphere=new Kl),this.boundingSphere.makeEmpty();const n=e.getAttribute("position");for(let i=0;i<n.count;i++)this.getVertexPosition(i,$P),this.boundingSphere.expandByPoint($P)}copy(e,n){return super.copy(e,n),this.bindMode=e.bindMode,this.bindMatrix.copy(e.bindMatrix),this.bindMatrixInverse.copy(e.bindMatrixInverse),this.skeleton=e.skeleton,e.boundingBox!==null&&(this.boundingBox=e.boundingBox.clone()),e.boundingSphere!==null&&(this.boundingSphere=e.boundingSphere.clone()),this}raycast(e,n){const i=this.material,r=this.matrixWorld;i!==void 0&&(this.boundingSphere===null&&this.computeBoundingSphere(),k5.copy(this.boundingSphere),k5.applyMatrix4(r),e.ray.intersectsSphere(k5)!==!1&&(xJ.copy(r).invert(),P5.copy(e.ray).applyMatrix4(xJ),!(this.boundingBox!==null&&P5.intersectsBox(this.boundingBox)===!1)&&this._computeIntersections(e,n,P5)))}getVertexPosition(e,n){return super.getVertexPosition(e,n),this.applyBoneTransform(e,n),n}bind(e,n){this.skeleton=e,n===void 0&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),n=this.matrixWorld),this.bindMatrix.copy(n),this.bindMatrixInverse.copy(n).invert()}pose(){this.skeleton.pose()}normalizeSkinWeights(){const e=new zr,n=this.geometry.attributes.skinWeight;for(let i=0,r=n.count;i<r;i++){e.fromBufferAttribute(n,i);const s=1/e.manhattanLength();s!==1/0?e.multiplyScalar(s):e.set(1,0,0,0),n.setXYZW(i,e.x,e.y,e.z,e.w)}}updateMatrixWorld(e){super.updateMatrixWorld(e),this.bindMode===XV?this.bindMatrixInverse.copy(this.matrixWorld).invert():this.bindMode===Rle?this.bindMatrixInverse.copy(this.bindMatrix).invert():console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)}applyBoneTransform(e,n){const i=this.skeleton,r=this.geometry;EJ.fromBufferAttribute(r.attributes.skinIndex,e),SJ.fromBufferAttribute(r.attributes.skinWeight,e),bJ.copy(n).applyMatrix4(this.bindMatrix),n.set(0,0,0);for(let s=0;s<4;s++){const a=SJ.getComponent(s);if(a!==0){const o=EJ.getComponent(s);TJ.multiplyMatrices(i.bones[o].matrixWorld,i.boneInverses[o]),n.addScaledVector(UAe.copy(bJ).applyMatrix4(TJ),a)}}return n.applyMatrix4(this.bindMatrixInverse)}}class tW extends Wr{constructor(){super(),this.isBone=!0,this.type="Bone"}}class lf extends Ga{constructor(e=null,n=1,i=1,r,s,a,o,c,l=Va,u=Va,h,d){super(null,a,o,c,l,u,r,s,h,d),this.isDataTexture=!0,this.image={data:e,width:n,height:i},this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}const wJ=new gi,BAe=new gi;class lF{constructor(e=[],n=[]){this.uuid=cf(),this.bones=e.slice(0),this.boneInverses=n,this.boneMatrices=null,this.boneTexture=null,this.init()}init(){const e=this.bones,n=this.boneInverses;if(this.boneMatrices=new Float32Array(e.length*16),n.length===0)this.calculateInverses();else if(e.length!==n.length){console.warn("THREE.Skeleton: Number of inverse bone matrices does not match amount of bones."),this.boneInverses=[];for(let i=0,r=this.bones.length;i<r;i++)this.boneInverses.push(new gi)}}calculateInverses(){this.boneInverses.length=0;for(let e=0,n=this.bones.length;e<n;e++){const i=new gi;this.bones[e]&&i.copy(this.bones[e].matrixWorld).invert(),this.boneInverses.push(i)}}pose(){for(let e=0,n=this.bones.length;e<n;e++){const i=this.bones[e];i&&i.matrixWorld.copy(this.boneInverses[e]).invert()}for(let e=0,n=this.bones.length;e<n;e++){const i=this.bones[e];i&&(i.parent&&i.parent.isBone?(i.matrix.copy(i.parent.matrixWorld).invert(),i.matrix.multiply(i.matrixWorld)):i.matrix.copy(i.matrixWorld),i.matrix.decompose(i.position,i.quaternion,i.scale))}}update(){const e=this.bones,n=this.boneInverses,i=this.boneMatrices,r=this.boneTexture;for(let s=0,a=e.length;s<a;s++){const o=e[s]?e[s].matrixWorld:BAe;wJ.multiplyMatrices(o,n[s]),wJ.toArray(i,s*16)}r!==null&&(r.needsUpdate=!0)}clone(){return new lF(this.bones,this.boneInverses)}computeBoneTexture(){let e=Math.sqrt(this.bones.length*4);e=Math.ceil(e/4)*4,e=Math.max(e,4);const n=new Float32Array(e*e*4);n.set(this.boneMatrices);const i=new lf(n,e,e,Wc,vu);return i.needsUpdate=!0,this.boneMatrices=n,this.boneTexture=i,this}getBoneByName(e){for(let n=0,i=this.bones.length;n<i;n++){const r=this.bones[n];if(r.name===e)return r}}dispose(){this.boneTexture!==null&&(this.boneTexture.dispose(),this.boneTexture=null)}fromJSON(e,n){this.uuid=e.uuid;for(let i=0,r=e.bones.length;i<r;i++){const s=e.bones[i];let a=n[s];a===void 0&&(console.warn("THREE.Skeleton: No bone found with UUID:",s),a=new tW),this.bones.push(a),this.boneInverses.push(new gi().fromArray(e.boneInverses[i]))}return this.init(),this}toJSON(){const e={metadata:{version:4.6,type:"Skeleton",generator:"Skeleton.toJSON"},bones:[],boneInverses:[]};e.uuid=this.uuid;const n=this.bones,i=this.boneInverses;for(let r=0,s=n.length;r<s;r++){const a=n[r];e.bones.push(a.uuid);const o=i[r];e.boneInverses.push(o.toArray())}return e}}class GC extends ar{constructor(e,n,i,r=1){super(e,n,i),this.isInstancedBufferAttribute=!0,this.meshPerAttribute=r}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}toJSON(){const e=super.toJSON();return e.meshPerAttribute=this.meshPerAttribute,e.isInstancedBufferAttribute=!0,e}}const Qx=new gi,CJ=new gi,WP=[],AJ=new Su,FAe=new gi,JR=new Io,QR=new Kl;class eue extends Io{constructor(e,n,i){super(e,n),this.isInstancedMesh=!0,this.instanceMatrix=new GC(new Float32Array(i*16),16),this.instanceColor=null,this.morphTexture=null,this.count=i,this.boundingBox=null,this.boundingSphere=null;for(let r=0;r<i;r++)this.setMatrixAt(r,FAe)}computeBoundingBox(){const e=this.geometry,n=this.count;this.boundingBox===null&&(this.boundingBox=new Su),e.boundingBox===null&&e.computeBoundingBox(),this.boundingBox.makeEmpty();for(let i=0;i<n;i++)this.getMatrixAt(i,Qx),AJ.copy(e.boundingBox).applyMatrix4(Qx),this.boundingBox.union(AJ)}computeBoundingSphere(){const e=this.geometry,n=this.count;this.boundingSphere===null&&(this.boundingSphere=new Kl),e.boundingSphere===null&&e.computeBoundingSphere(),this.boundingSphere.makeEmpty();for(let i=0;i<n;i++)this.getMatrixAt(i,Qx),QR.copy(e.boundingSphere).applyMatrix4(Qx),this.boundingSphere.union(QR)}copy(e,n){return super.copy(e,n),this.instanceMatrix.copy(e.instanceMatrix),e.morphTexture!==null&&(this.morphTexture=e.morphTexture.clone()),e.instanceColor!==null&&(this.instanceColor=e.instanceColor.clone()),this.count=e.count,e.boundingBox!==null&&(this.boundingBox=e.boundingBox.clone()),e.boundingSphere!==null&&(this.boundingSphere=e.boundingSphere.clone()),this}getColorAt(e,n){n.fromArray(this.instanceColor.array,e*3)}getMatrixAt(e,n){n.fromArray(this.instanceMatrix.array,e*16)}getMorphAt(e,n){const i=n.morphTargetInfluences,r=this.morphTexture.source.data.data,s=i.length+1,a=e*s+1;for(let o=0;o<i.length;o++)i[o]=r[a+o]}raycast(e,n){const i=this.matrixWorld,r=this.count;if(JR.geometry=this.geometry,JR.material=this.material,JR.material!==void 0&&(this.boundingSphere===null&&this.computeBoundingSphere(),QR.copy(this.boundingSphere),QR.applyMatrix4(i),e.ray.intersectsSphere(QR)!==!1))for(let s=0;s<r;s++){this.getMatrixAt(s,Qx),CJ.multiplyMatrices(i,Qx),JR.matrixWorld=CJ,JR.raycast(e,WP);for(let a=0,o=WP.length;a<o;a++){const c=WP[a];c.instanceId=s,c.object=this,n.push(c)}WP.length=0}}setColorAt(e,n){this.instanceColor===null&&(this.instanceColor=new GC(new Float32Array(this.instanceMatrix.count*3).fill(1),3)),n.toArray(this.instanceColor.array,e*3)}setMatrixAt(e,n){n.toArray(this.instanceMatrix.array,e*16)}setMorphAt(e,n){const i=n.morphTargetInfluences,r=i.length+1;this.morphTexture===null&&(this.morphTexture=new lf(new Float32Array(r*this.count),r,this.count,KA,vu));const s=this.morphTexture.source.data.data;let a=0;for(let l=0;l<i.length;l++)a+=i[l];const o=this.geometry.morphTargetsRelative?1:1-a,c=r*e;s[c]=o,s.set(i,c+1)}updateMorphTargets(){}dispose(){this.dispatchEvent({type:"dispose"}),this.morphTexture!==null&&(this.morphTexture.dispose(),this.morphTexture=null)}}const D5=new Oe,zAe=new Oe,jAe=new Qi;class nb{constructor(e=new Oe(1,0,0),n=0){this.isPlane=!0,this.normal=e,this.constant=n}set(e,n){return this.normal.copy(e),this.constant=n,this}setComponents(e,n,i,r){return this.normal.set(e,n,i),this.constant=r,this}setFromNormalAndCoplanarPoint(e,n){return this.normal.copy(e),this.constant=-n.dot(this.normal),this}setFromCoplanarPoints(e,n,i){const r=D5.subVectors(i,n).cross(zAe.subVectors(e,n)).normalize();return this.setFromNormalAndCoplanarPoint(r,e),this}copy(e){return this.normal.copy(e.normal),this.constant=e.constant,this}normalize(){const e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(e){return this.normal.dot(e)+this.constant}distanceToSphere(e){return this.distanceToPoint(e.center)-e.radius}projectPoint(e,n){return n.copy(e).addScaledVector(this.normal,-this.distanceToPoint(e))}intersectLine(e,n){const i=e.delta(D5),r=this.normal.dot(i);if(r===0)return this.distanceToPoint(e.start)===0?n.copy(e.start):null;const s=-(e.start.dot(this.normal)+this.constant)/r;return s<0||s>1?null:n.copy(e.start).addScaledVector(i,s)}intersectsLine(e){const n=this.distanceToPoint(e.start),i=this.distanceToPoint(e.end);return n<0&&i>0||i<0&&n>0}intersectsBox(e){return e.intersectsPlane(this)}intersectsSphere(e){return e.intersectsPlane(this)}coplanarPoint(e){return e.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(e,n){const i=n||jAe.getNormalMatrix(e),r=this.coplanarPoint(D5).applyMatrix4(e),s=this.normal.applyMatrix3(i).normalize();return this.constant=-r.dot(s),this}translate(e){return this.constant-=e.dot(this.normal),this}equals(e){return e.normal.equals(this.normal)&&e.constant===this.constant}clone(){return new this.constructor().copy(this)}}const PS=new Kl,YP=new Oe;class ZA{constructor(e=new nb,n=new nb,i=new nb,r=new nb,s=new nb,a=new nb){this.planes=[e,n,i,r,s,a]}set(e,n,i,r,s,a){const o=this.planes;return o[0].copy(e),o[1].copy(n),o[2].copy(i),o[3].copy(r),o[4].copy(s),o[5].copy(a),this}copy(e){const n=this.planes;for(let i=0;i<6;i++)n[i].copy(e.planes[i]);return this}setFromProjectionMatrix(e,n=lp){const i=this.planes,r=e.elements,s=r[0],a=r[1],o=r[2],c=r[3],l=r[4],u=r[5],h=r[6],d=r[7],f=r[8],p=r[9],g=r[10],_=r[11],v=r[12],b=r[13],S=r[14],x=r[15];if(i[0].setComponents(c-s,d-l,_-f,x-v).normalize(),i[1].setComponents(c+s,d+l,_+f,x+v).normalize(),i[2].setComponents(c+a,d+u,_+p,x+b).normalize(),i[3].setComponents(c-a,d-u,_-p,x-b).normalize(),i[4].setComponents(c-o,d-h,_-g,x-S).normalize(),n===lp)i[5].setComponents(c+o,d+h,_+g,x+S).normalize();else if(n===XO)i[5].setComponents(o,h,g,S).normalize();else throw new Error("THREE.Frustum.setFromProjectionMatrix(): Invalid coordinate system: "+n);return this}intersectsObject(e){if(e.boundingSphere!==void 0)e.boundingSphere===null&&e.computeBoundingSphere(),PS.copy(e.boundingSphere).applyMatrix4(e.matrixWorld);else{const n=e.geometry;n.boundingSphere===null&&n.computeBoundingSphere(),PS.copy(n.boundingSphere).applyMatrix4(e.matrixWorld)}return this.intersectsSphere(PS)}intersectsSprite(e){return PS.center.set(0,0,0),PS.radius=.7071067811865476,PS.applyMatrix4(e.matrixWorld),this.intersectsSphere(PS)}intersectsSphere(e){const n=this.planes,i=e.center,r=-e.radius;for(let s=0;s<6;s++)if(n[s].distanceToPoint(i)<r)return!1;return!0}intersectsBox(e){const n=this.planes;for(let i=0;i<6;i++){const r=n[i];if(YP.x=r.normal.x>0?e.max.x:e.min.x,YP.y=r.normal.y>0?e.max.y:e.min.y,YP.z=r.normal.z>0?e.max.z:e.min.z,r.distanceToPoint(YP)<0)return!1}return!0}containsPoint(e){const n=this.planes;for(let i=0;i<6;i++)if(n[i].distanceToPoint(e)<0)return!1;return!0}clone(){return new this.constructor().copy(this)}}const yg=new gi,bg=new ZA;class uF{constructor(){this.coordinateSystem=lp}intersectsObject(e,n){if(!n.isArrayCamera||n.cameras.length===0)return!1;for(let i=0;i<n.cameras.length;i++){const r=n.cameras[i];if(yg.multiplyMatrices(r.projectionMatrix,r.matrixWorldInverse),bg.setFromProjectionMatrix(yg,this.coordinateSystem),bg.intersectsObject(e))return!0}return!1}intersectsSprite(e,n){if(!n||!n.cameras||n.cameras.length===0)return!1;for(let i=0;i<n.cameras.length;i++){const r=n.cameras[i];if(yg.multiplyMatrices(r.projectionMatrix,r.matrixWorldInverse),bg.setFromProjectionMatrix(yg,this.coordinateSystem),bg.intersectsSprite(e))return!0}return!1}intersectsSphere(e,n){if(!n||!n.cameras||n.cameras.length===0)return!1;for(let i=0;i<n.cameras.length;i++){const r=n.cameras[i];if(yg.multiplyMatrices(r.projectionMatrix,r.matrixWorldInverse),bg.setFromProjectionMatrix(yg,this.coordinateSystem),bg.intersectsSphere(e))return!0}return!1}intersectsBox(e,n){if(!n||!n.cameras||n.cameras.length===0)return!1;for(let i=0;i<n.cameras.length;i++){const r=n.cameras[i];if(yg.multiplyMatrices(r.projectionMatrix,r.matrixWorldInverse),bg.setFromProjectionMatrix(yg,this.coordinateSystem),bg.intersectsBox(e))return!0}return!1}containsPoint(e,n){if(!n||!n.cameras||n.cameras.length===0)return!1;for(let i=0;i<n.cameras.length;i++){const r=n.cameras[i];if(yg.multiplyMatrices(r.projectionMatrix,r.matrixWorldInverse),bg.setFromProjectionMatrix(yg,this.coordinateSystem),bg.containsPoint(e))return!0}return!1}clone(){return new uF}}function L5(t,e){return t-e}function HAe(t,e){return t.z-e.z}function VAe(t,e){return e.z-t.z}class GAe{constructor(){this.index=0,this.pool=[],this.list=[]}push(e,n,i,r){const s=this.pool,a=this.list;this.index>=s.length&&s.push({start:-1,count:-1,z:-1,index:-1});const o=s[this.index];a.push(o),this.index++,o.start=e,o.count=n,o.z=i,o.index=r}reset(){this.list.length=0,this.index=0}}const Vh=new gi,qAe=new bn(1,1,1),RJ=new ZA,$Ae=new uF,KP=new Su,DS=new Kl,eM=new Oe,MJ=new Oe,WAe=new Oe,U5=new GAe,uu=new Io,XP=[];function YAe(t,e,n=0){const i=e.itemSize;if(t.isInterleavedBufferAttribute||t.array.constructor!==e.array.constructor){const r=t.count;for(let s=0;s<r;s++)for(let a=0;a<i;a++)e.setComponent(s+n,a,t.getComponent(s,a))}else e.array.set(t.array,n*i);e.needsUpdate=!0}function LS(t,e){if(t.constructor!==e.constructor){const n=Math.min(t.length,e.length);for(let i=0;i<n;i++)e[i]=t[i]}else{const n=Math.min(t.length,e.length);e.set(new t.constructor(t.buffer,0,n))}}class tue extends Io{constructor(e,n,i=n*2,r){super(new tr,r),this.isBatchedMesh=!0,this.perObjectFrustumCulled=!0,this.sortObjects=!0,this.boundingBox=null,this.boundingSphere=null,this.customSort=null,this._instanceInfo=[],this._geometryInfo=[],this._availableInstanceIds=[],this._availableGeometryIds=[],this._nextIndexStart=0,this._nextVertexStart=0,this._geometryCount=0,this._visibilityChanged=!0,this._geometryInitialized=!1,this._maxInstanceCount=e,this._maxVertexCount=n,this._maxIndexCount=i,this._multiDrawCounts=new Int32Array(e),this._multiDrawStarts=new Int32Array(e),this._multiDrawCount=0,this._multiDrawInstances=null,this._matricesTexture=null,this._indirectTexture=null,this._colorsTexture=null,this._initMatricesTexture(),this._initIndirectTexture()}get maxInstanceCount(){return this._maxInstanceCount}get instanceCount(){return this._instanceInfo.length-this._availableInstanceIds.length}get unusedVertexCount(){return this._maxVertexCount-this._nextVertexStart}get unusedIndexCount(){return this._maxIndexCount-this._nextIndexStart}_initMatricesTexture(){let e=Math.sqrt(this._maxInstanceCount*4);e=Math.ceil(e/4)*4,e=Math.max(e,4);const n=new Float32Array(e*e*4),i=new lf(n,e,e,Wc,vu);this._matricesTexture=i}_initIndirectTexture(){let e=Math.sqrt(this._maxInstanceCount);e=Math.ceil(e);const n=new Uint32Array(e*e),i=new lf(n,e,e,II,s0);this._indirectTexture=i}_initColorsTexture(){let e=Math.sqrt(this._maxInstanceCount);e=Math.ceil(e);const n=new Float32Array(e*e*4).fill(1),i=new lf(n,e,e,Wc,vu);i.colorSpace=Br.workingColorSpace,this._colorsTexture=i}_initializeGeometry(e){const n=this.geometry,i=this._maxVertexCount,r=this._maxIndexCount;if(this._geometryInitialized===!1){for(const s in e.attributes){const a=e.getAttribute(s),{array:o,itemSize:c,normalized:l}=a,u=new o.constructor(i*c),h=new ar(u,c,l);n.setAttribute(s,h)}if(e.getIndex()!==null){const s=i>65535?new Uint32Array(r):new Uint16Array(r);n.setIndex(new ar(s,1))}this._geometryInitialized=!0}}_validateGeometry(e){const n=this.geometry;if(!!e.getIndex()!=!!n.getIndex())throw new Error('THREE.BatchedMesh: All geometries must consistently have "index".');for(const i in n.attributes){if(!e.hasAttribute(i))throw new Error(`THREE.BatchedMesh: Added geometry missing "${i}". All geometries must have consistent attributes.`);const r=e.getAttribute(i),s=n.getAttribute(i);if(r.itemSize!==s.itemSize||r.normalized!==s.normalized)throw new Error("THREE.BatchedMesh: All attributes must have a consistent itemSize and normalized value.")}}validateInstanceId(e){const n=this._instanceInfo;if(e<0||e>=n.length||n[e].active===!1)throw new Error(`THREE.BatchedMesh: Invalid instanceId ${e}. Instance is either out of range or has been deleted.`)}validateGeometryId(e){const n=this._geometryInfo;if(e<0||e>=n.length||n[e].active===!1)throw new Error(`THREE.BatchedMesh: Invalid geometryId ${e}. Geometry is either out of range or has been deleted.`)}setCustomSort(e){return this.customSort=e,this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new Su);const e=this.boundingBox,n=this._instanceInfo;e.makeEmpty();for(let i=0,r=n.length;i<r;i++){if(n[i].active===!1)continue;const s=n[i].geometryIndex;this.getMatrixAt(i,Vh),this.getBoundingBoxAt(s,KP).applyMatrix4(Vh),e.union(KP)}}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new Kl);const e=this.boundingSphere,n=this._instanceInfo;e.makeEmpty();for(let i=0,r=n.length;i<r;i++){if(n[i].active===!1)continue;const s=n[i].geometryIndex;this.getMatrixAt(i,Vh),this.getBoundingSphereAt(s,DS).applyMatrix4(Vh),e.union(DS)}}addInstance(e){if(this._instanceInfo.length>=this.maxInstanceCount&&this._availableInstanceIds.length===0)throw new Error("THREE.BatchedMesh: Maximum item count reached.");const i={visible:!0,active:!0,geometryIndex:e};let r=null;this._availableInstanceIds.length>0?(this._availableInstanceIds.sort(L5),r=this._availableInstanceIds.shift(),this._instanceInfo[r]=i):(r=this._instanceInfo.length,this._instanceInfo.push(i));const s=this._matricesTexture;Vh.identity().toArray(s.image.data,r*16),s.needsUpdate=!0;const a=this._colorsTexture;return a&&(qAe.toArray(a.image.data,r*4),a.needsUpdate=!0),this._visibilityChanged=!0,r}addGeometry(e,n=-1,i=-1){this._initializeGeometry(e),this._validateGeometry(e);const r={vertexStart:-1,vertexCount:-1,reservedVertexCount:-1,indexStart:-1,indexCount:-1,reservedIndexCount:-1,start:-1,count:-1,boundingBox:null,boundingSphere:null,active:!0},s=this._geometryInfo;r.vertexStart=this._nextVertexStart,r.reservedVertexCount=n===-1?e.getAttribute("position").count:n;const a=e.getIndex();if(a!==null&&(r.indexStart=this._nextIndexStart,r.reservedIndexCount=i===-1?a.count:i),r.indexStart!==-1&&r.indexStart+r.reservedIndexCount>this._maxIndexCount||r.vertexStart+r.reservedVertexCount>this._maxVertexCount)throw new Error("THREE.BatchedMesh: Reserved space request exceeds the maximum buffer size.");let c;return this._availableGeometryIds.length>0?(this._availableGeometryIds.sort(L5),c=this._availableGeometryIds.shift(),s[c]=r):(c=this._geometryCount,this._geometryCount++,s.push(r)),this.setGeometryAt(c,e),this._nextIndexStart=r.indexStart+r.reservedIndexCount,this._nextVertexStart=r.vertexStart+r.reservedVertexCount,c}setGeometryAt(e,n){if(e>=this._geometryCount)throw new Error("THREE.BatchedMesh: Maximum geometry count reached.");this._validateGeometry(n);const i=this.geometry,r=i.getIndex()!==null,s=i.getIndex(),a=n.getIndex(),o=this._geometryInfo[e];if(r&&a.count>o.reservedIndexCount||n.attributes.position.count>o.reservedVertexCount)throw new Error("THREE.BatchedMesh: Reserved space not large enough for provided geometry.");const c=o.vertexStart,l=o.reservedVertexCount;o.vertexCount=n.getAttribute("position").count;for(const u in i.attributes){const h=n.getAttribute(u),d=i.getAttribute(u);YAe(h,d,c);const f=h.itemSize;for(let p=h.count,g=l;p<g;p++){const _=c+p;for(let v=0;v<f;v++)d.setComponent(_,v,0)}d.needsUpdate=!0,d.addUpdateRange(c*f,l*f)}if(r){const u=o.indexStart,h=o.reservedIndexCount;o.indexCount=n.getIndex().count;for(let d=0;d<a.count;d++)s.setX(u+d,c+a.getX(d));for(let d=a.count,f=h;d<f;d++)s.setX(u+d,c);s.needsUpdate=!0,s.addUpdateRange(u,o.reservedIndexCount)}return o.start=r?o.indexStart:o.vertexStart,o.count=r?o.indexCount:o.vertexCount,o.boundingBox=null,n.boundingBox!==null&&(o.boundingBox=n.boundingBox.clone()),o.boundingSphere=null,n.boundingSphere!==null&&(o.boundingSphere=n.boundingSphere.clone()),this._visibilityChanged=!0,e}deleteGeometry(e){const n=this._geometryInfo;if(e>=n.length||n[e].active===!1)return this;const i=this._instanceInfo;for(let r=0,s=i.length;r<s;r++)i[r].active&&i[r].geometryIndex===e&&this.deleteInstance(r);return n[e].active=!1,this._availableGeometryIds.push(e),this._visibilityChanged=!0,this}deleteInstance(e){return this.validateInstanceId(e),this._instanceInfo[e].active=!1,this._availableInstanceIds.push(e),this._visibilityChanged=!0,this}optimize(){let e=0,n=0;const i=this._geometryInfo,r=i.map((a,o)=>o).sort((a,o)=>i[a].vertexStart-i[o].vertexStart),s=this.geometry;for(let a=0,o=i.length;a<o;a++){const c=r[a],l=i[c];if(l.active!==!1){if(s.index!==null){if(l.indexStart!==n){const{indexStart:u,vertexStart:h,reservedIndexCount:d}=l,f=s.index,p=f.array,g=e-h;for(let _=u;_<u+d;_++)p[_]=p[_]+g;f.array.copyWithin(n,u,u+d),f.addUpdateRange(n,d),l.indexStart=n}n+=l.reservedIndexCount}if(l.vertexStart!==e){const{vertexStart:u,reservedVertexCount:h}=l,d=s.attributes;for(const f in d){const p=d[f],{array:g,itemSize:_}=p;g.copyWithin(e*_,u*_,(u+h)*_),p.addUpdateRange(e*_,h*_)}l.vertexStart=e}e+=l.reservedVertexCount,l.start=s.index?l.indexStart:l.vertexStart,this._nextIndexStart=s.index?l.indexStart+l.reservedIndexCount:0,this._nextVertexStart=l.vertexStart+l.reservedVertexCount}}return this}getBoundingBoxAt(e,n){if(e>=this._geometryCount)return null;const i=this.geometry,r=this._geometryInfo[e];if(r.boundingBox===null){const s=new Su,a=i.index,o=i.attributes.position;for(let c=r.start,l=r.start+r.count;c<l;c++){let u=c;a&&(u=a.getX(u)),s.expandByPoint(eM.fromBufferAttribute(o,u))}r.boundingBox=s}return n.copy(r.boundingBox),n}getBoundingSphereAt(e,n){if(e>=this._geometryCount)return null;const i=this.geometry,r=this._geometryInfo[e];if(r.boundingSphere===null){const s=new Kl;this.getBoundingBoxAt(e,KP),KP.getCenter(s.center);const a=i.index,o=i.attributes.position;let c=0;for(let l=r.start,u=r.start+r.count;l<u;l++){let h=l;a&&(h=a.getX(h)),eM.fromBufferAttribute(o,h),c=Math.max(c,s.center.distanceToSquared(eM))}s.radius=Math.sqrt(c),r.boundingSphere=s}return n.copy(r.boundingSphere),n}setMatrixAt(e,n){this.validateInstanceId(e);const i=this._matricesTexture,r=this._matricesTexture.image.data;return n.toArray(r,e*16),i.needsUpdate=!0,this}getMatrixAt(e,n){return this.validateInstanceId(e),n.fromArray(this._matricesTexture.image.data,e*16)}setColorAt(e,n){return this.validateInstanceId(e),this._colorsTexture===null&&this._initColorsTexture(),n.toArray(this._colorsTexture.image.data,e*4),this._colorsTexture.needsUpdate=!0,this}getColorAt(e,n){return this.validateInstanceId(e),n.fromArray(this._colorsTexture.image.data,e*4)}setVisibleAt(e,n){return this.validateInstanceId(e),this._instanceInfo[e].visible===n?this:(this._instanceInfo[e].visible=n,this._visibilityChanged=!0,this)}getVisibleAt(e){return this.validateInstanceId(e),this._instanceInfo[e].visible}setGeometryIdAt(e,n){return this.validateInstanceId(e),this.validateGeometryId(n),this._instanceInfo[e].geometryIndex=n,this}getGeometryIdAt(e){return this.validateInstanceId(e),this._instanceInfo[e].geometryIndex}getGeometryRangeAt(e,n={}){this.validateGeometryId(e);const i=this._geometryInfo[e];return n.vertexStart=i.vertexStart,n.vertexCount=i.vertexCount,n.reservedVertexCount=i.reservedVertexCount,n.indexStart=i.indexStart,n.indexCount=i.indexCount,n.reservedIndexCount=i.reservedIndexCount,n.start=i.start,n.count=i.count,n}setInstanceCount(e){const n=this._availableInstanceIds,i=this._instanceInfo;for(n.sort(L5);n[n.length-1]===i.length;)i.pop(),n.pop();if(e<i.length)throw new Error(`BatchedMesh: Instance ids outside the range ${e} are being used. Cannot shrink instance count.`);const r=new Int32Array(e),s=new Int32Array(e);LS(this._multiDrawCounts,r),LS(this._multiDrawStarts,s),this._multiDrawCounts=r,this._multiDrawStarts=s,this._maxInstanceCount=e;const a=this._indirectTexture,o=this._matricesTexture,c=this._colorsTexture;a.dispose(),this._initIndirectTexture(),LS(a.image.data,this._indirectTexture.image.data),o.dispose(),this._initMatricesTexture(),LS(o.image.data,this._matricesTexture.image.data),c&&(c.dispose(),this._initColorsTexture(),LS(c.image.data,this._colorsTexture.image.data))}setGeometrySize(e,n){const i=[...this._geometryInfo].filter(o=>o.active);if(Math.max(...i.map(o=>o.vertexStart+o.reservedVertexCount))>e)throw new Error(`BatchedMesh: Geometry vertex values are being used outside the range ${n}. Cannot shrink further.`);if(this.geometry.index&&Math.max(...i.map(c=>c.indexStart+c.reservedIndexCount))>n)throw new Error(`BatchedMesh: Geometry index values are being used outside the range ${n}. Cannot shrink further.`);const s=this.geometry;s.dispose(),this._maxVertexCount=e,this._maxIndexCount=n,this._geometryInitialized&&(this._geometryInitialized=!1,this.geometry=new tr,this._initializeGeometry(s));const a=this.geometry;s.index&&LS(s.index.array,a.index.array);for(const o in s.attributes)LS(s.attributes[o].array,a.attributes[o].array)}raycast(e,n){const i=this._instanceInfo,r=this._geometryInfo,s=this.matrixWorld,a=this.geometry;uu.material=this.material,uu.geometry.index=a.index,uu.geometry.attributes=a.attributes,uu.geometry.boundingBox===null&&(uu.geometry.boundingBox=new Su),uu.geometry.boundingSphere===null&&(uu.geometry.boundingSphere=new Kl);for(let o=0,c=i.length;o<c;o++){if(!i[o].visible||!i[o].active)continue;const l=i[o].geometryIndex,u=r[l];uu.geometry.setDrawRange(u.start,u.count),this.getMatrixAt(o,uu.matrixWorld).premultiply(s),this.getBoundingBoxAt(l,uu.geometry.boundingBox),this.getBoundingSphereAt(l,uu.geometry.boundingSphere),uu.raycast(e,XP);for(let h=0,d=XP.length;h<d;h++){const f=XP[h];f.object=this,f.batchId=o,n.push(f)}XP.length=0}uu.material=null,uu.geometry.index=null,uu.geometry.attributes={},uu.geometry.setDrawRange(0,1/0)}copy(e){return super.copy(e),this.geometry=e.geometry.clone(),this.perObjectFrustumCulled=e.perObjectFrustumCulled,this.sortObjects=e.sortObjects,this.boundingBox=e.boundingBox!==null?e.boundingBox.clone():null,this.boundingSphere=e.boundingSphere!==null?e.boundingSphere.clone():null,this._geometryInfo=e._geometryInfo.map(n=>({...n,boundingBox:n.boundingBox!==null?n.boundingBox.clone():null,boundingSphere:n.boundingSphere!==null?n.boundingSphere.clone():null})),this._instanceInfo=e._instanceInfo.map(n=>({...n})),this._availableInstanceIds=e._availableInstanceIds.slice(),this._availableGeometryIds=e._availableGeometryIds.slice(),this._nextIndexStart=e._nextIndexStart,this._nextVertexStart=e._nextVertexStart,this._geometryCount=e._geometryCount,this._maxInstanceCount=e._maxInstanceCount,this._maxVertexCount=e._maxVertexCount,this._maxIndexCount=e._maxIndexCount,this._geometryInitialized=e._geometryInitialized,this._multiDrawCounts=e._multiDrawCounts.slice(),this._multiDrawStarts=e._multiDrawStarts.slice(),this._indirectTexture=e._indirectTexture.clone(),this._indirectTexture.image.data=this._indirectTexture.image.data.slice(),this._matricesTexture=e._matricesTexture.clone(),this._matricesTexture.image.data=this._matricesTexture.image.data.slice(),this._colorsTexture!==null&&(this._colorsTexture=e._colorsTexture.clone(),this._colorsTexture.image.data=this._colorsTexture.image.data.slice()),this}dispose(){this.geometry.dispose(),this._matricesTexture.dispose(),this._matricesTexture=null,this._indirectTexture.dispose(),this._indirectTexture=null,this._colorsTexture!==null&&(this._colorsTexture.dispose(),this._colorsTexture=null)}onBeforeRender(e,n,i,r,s){if(!this._visibilityChanged&&!this.perObjectFrustumCulled&&!this.sortObjects)return;const a=r.getIndex(),o=a===null?1:a.array.BYTES_PER_ELEMENT,c=this._instanceInfo,l=this._multiDrawStarts,u=this._multiDrawCounts,h=this._geometryInfo,d=this.perObjectFrustumCulled,f=this._indirectTexture,p=f.image.data,g=i.isArrayCamera?$Ae:RJ;d&&!i.isArrayCamera&&(Vh.multiplyMatrices(i.projectionMatrix,i.matrixWorldInverse).multiply(this.matrixWorld),RJ.setFromProjectionMatrix(Vh,e.coordinateSystem));let _=0;if(this.sortObjects){Vh.copy(this.matrixWorld).invert(),eM.setFromMatrixPosition(i.matrixWorld).applyMatrix4(Vh),MJ.set(0,0,-1).transformDirection(i.matrixWorld).transformDirection(Vh);for(let S=0,x=c.length;S<x;S++)if(c[S].visible&&c[S].active){const M=c[S].geometryIndex;this.getMatrixAt(S,Vh),this.getBoundingSphereAt(M,DS).applyMatrix4(Vh);let R=!1;if(d&&(R=!g.intersectsSphere(DS,i)),!R){const I=h[M],k=WAe.subVectors(DS.center,eM).dot(MJ);U5.push(I.start,I.count,k,S)}}const v=U5.list,b=this.customSort;b===null?v.sort(s.transparent?VAe:HAe):b.call(this,v,i);for(let S=0,x=v.length;S<x;S++){const M=v[S];l[_]=M.start*o,u[_]=M.count,p[_]=M.index,_++}U5.reset()}else for(let v=0,b=c.length;v<b;v++)if(c[v].visible&&c[v].active){const S=c[v].geometryIndex;let x=!1;if(d&&(this.getMatrixAt(v,Vh),this.getBoundingSphereAt(S,DS).applyMatrix4(Vh),x=!g.intersectsSphere(DS,i)),!x){const M=h[S];l[_]=M.start*o,u[_]=M.count,p[_]=v,_++}}f.needsUpdate=!0,this._multiDrawCount=_,this._visibilityChanged=!1}onBeforeShadow(e,n,i,r,s,a){this.onBeforeRender(e,null,r,s,a)}}class yh extends rl{constructor(e){super(),this.isLineBasicMaterial=!0,this.type="LineBasicMaterial",this.color=new bn(16777215),this.map=null,this.linewidth=1,this.linecap="round",this.linejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.linewidth=e.linewidth,this.linecap=e.linecap,this.linejoin=e.linejoin,this.fog=e.fog,this}}const RU=new Oe,MU=new Oe,OJ=new gi,tM=new XA,ZP=new Kl,B5=new Oe,NJ=new Oe;class tE extends Wr{constructor(e=new tr,n=new yh){super(),this.isLine=!0,this.type="Line",this.geometry=e,this.material=n,this.morphTargetDictionary=void 0,this.morphTargetInfluences=void 0,this.updateMorphTargets()}copy(e,n){return super.copy(e,n),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}computeLineDistances(){const e=this.geometry;if(e.index===null){const n=e.attributes.position,i=[0];for(let r=1,s=n.count;r<s;r++)RU.fromBufferAttribute(n,r-1),MU.fromBufferAttribute(n,r),i[r]=i[r-1],i[r]+=RU.distanceTo(MU);e.setAttribute("lineDistance",new qn(i,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}raycast(e,n){const i=this.geometry,r=this.matrixWorld,s=e.params.Line.threshold,a=i.drawRange;if(i.boundingSphere===null&&i.computeBoundingSphere(),ZP.copy(i.boundingSphere),ZP.applyMatrix4(r),ZP.radius+=s,e.ray.intersectsSphere(ZP)===!1)return;OJ.copy(r).invert(),tM.copy(e.ray).applyMatrix4(OJ);const o=s/((this.scale.x+this.scale.y+this.scale.z)/3),c=o*o,l=this.isLineSegments?2:1,u=i.index,d=i.attributes.position;if(u!==null){const f=Math.max(0,a.start),p=Math.min(u.count,a.start+a.count);for(let g=f,_=p-1;g<_;g+=l){const v=u.getX(g),b=u.getX(g+1),S=JP(this,e,tM,c,v,b,g);S&&n.push(S)}if(this.isLineLoop){const g=u.getX(p-1),_=u.getX(f),v=JP(this,e,tM,c,g,_,p-1);v&&n.push(v)}}else{const f=Math.max(0,a.start),p=Math.min(d.count,a.start+a.count);for(let g=f,_=p-1;g<_;g+=l){const v=JP(this,e,tM,c,g,g+1,g);v&&n.push(v)}if(this.isLineLoop){const g=JP(this,e,tM,c,p-1,f,p-1);g&&n.push(g)}}}updateMorphTargets(){const n=this.geometry.morphAttributes,i=Object.keys(n);if(i.length>0){const r=n[i[0]];if(r!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let s=0,a=r.length;s<a;s++){const o=r[s].name||String(s);this.morphTargetInfluences.push(0),this.morphTargetDictionary[o]=s}}}}}function JP(t,e,n,i,r,s,a){const o=t.geometry.attributes.position;if(RU.fromBufferAttribute(o,r),MU.fromBufferAttribute(o,s),n.distanceSqToSegment(RU,MU,B5,NJ)>i)return;B5.applyMatrix4(t.matrixWorld);const l=e.ray.origin.distanceTo(B5);if(!(l<e.near||l>e.far))return{distance:l,point:NJ.clone().applyMatrix4(t.matrixWorld),index:a,face:null,faceIndex:null,barycoord:null,object:t}}const IJ=new Oe,kJ=new Oe;class g0 extends tE{constructor(e,n){super(e,n),this.isLineSegments=!0,this.type="LineSegments"}computeLineDistances(){const e=this.geometry;if(e.index===null){const n=e.attributes.position,i=[];for(let r=0,s=n.count;r<s;r+=2)IJ.fromBufferAttribute(n,r),kJ.fromBufferAttribute(n,r+1),i[r]=r===0?0:i[r-1],i[r+1]=i[r]+IJ.distanceTo(kJ);e.setAttribute("lineDistance",new qn(i,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}}class nue extends tE{constructor(e,n){super(e,n),this.isLineLoop=!0,this.type="LineLoop"}}class nW extends rl{constructor(e){super(),this.isPointsMaterial=!0,this.type="PointsMaterial",this.color=new bn(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.size=e.size,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}}const PJ=new gi,eG=new XA,QP=new Kl,eD=new Oe;class iue extends Wr{constructor(e=new tr,n=new nW){super(),this.isPoints=!0,this.type="Points",this.geometry=e,this.material=n,this.morphTargetDictionary=void 0,this.morphTargetInfluences=void 0,this.updateMorphTargets()}copy(e,n){return super.copy(e,n),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}raycast(e,n){const i=this.geometry,r=this.matrixWorld,s=e.params.Points.threshold,a=i.drawRange;if(i.boundingSphere===null&&i.computeBoundingSphere(),QP.copy(i.boundingSphere),QP.applyMatrix4(r),QP.radius+=s,e.ray.intersectsSphere(QP)===!1)return;PJ.copy(r).invert(),eG.copy(e.ray).applyMatrix4(PJ);const o=s/((this.scale.x+this.scale.y+this.scale.z)/3),c=o*o,l=i.index,h=i.attributes.position;if(l!==null){const d=Math.max(0,a.start),f=Math.min(l.count,a.start+a.count);for(let p=d,g=f;p<g;p++){const _=l.getX(p);eD.fromBufferAttribute(h,_),DJ(eD,_,c,r,e,n,this)}}else{const d=Math.max(0,a.start),f=Math.min(h.count,a.start+a.count);for(let p=d,g=f;p<g;p++)eD.fromBufferAttribute(h,p),DJ(eD,p,c,r,e,n,this)}}updateMorphTargets(){const n=this.geometry.morphAttributes,i=Object.keys(n);if(i.length>0){const r=n[i[0]];if(r!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let s=0,a=r.length;s<a;s++){const o=r[s].name||String(s);this.morphTargetInfluences.push(0),this.morphTargetDictionary[o]=s}}}}}function DJ(t,e,n,i,r,s,a){const o=eG.distanceSqToPoint(t);if(o<n){const c=new Oe;eG.closestPointToPoint(t,c),c.applyMatrix4(i);const l=r.ray.origin.distanceTo(c);if(l<r.near||l>r.far)return;s.push({distance:l,distanceToRay:Math.sqrt(o),point:c,index:e,face:null,faceIndex:null,barycoord:null,object:a})}}class rue extends Ga{constructor(e,n,i,r,s=Ca,a=Ca,o,c,l){super(e,n,i,r,s,a,o,c,l),this.isVideoTexture=!0,this.generateMipmaps=!1;const u=this;function h(){u.needsUpdate=!0,e.requestVideoFrameCallback(h)}"requestVideoFrameCallback"in e&&e.requestVideoFrameCallback(h)}clone(){return new this.constructor(this.image).copy(this)}update(){const e=this.image;"requestVideoFrameCallback"in e===!1&&e.readyState>=e.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}}class KAe extends rue{constructor(e,n,i,r,s,a,o,c){super({},e,n,i,r,s,a,o,c),this.isVideoFrameTexture=!0}update(){}clone(){return new this.constructor().copy(this)}setFrame(e){this.image=e,this.needsUpdate=!0}}class XAe extends Ga{constructor(e,n){super({width:e,height:n}),this.isFramebufferTexture=!0,this.magFilter=Va,this.minFilter=Va,this.generateMipmaps=!1,this.needsUpdate=!0}}class hF extends Ga{constructor(e,n,i,r,s,a,o,c,l,u,h,d){super(null,a,o,c,l,u,r,s,h,d),this.isCompressedTexture=!0,this.image={width:n,height:i},this.mipmaps=e,this.flipY=!1,this.generateMipmaps=!1}}class ZAe extends hF{constructor(e,n,i,r,s,a){super(e,n,i,s,a),this.isCompressedArrayTexture=!0,this.image.depth=r,this.wrapR=cp,this.layerUpdates=new Set}addLayerUpdate(e){this.layerUpdates.add(e)}clearLayerUpdates(){this.layerUpdates.clear()}}class JAe extends hF{constructor(e,n,i){super(void 0,e[0].width,e[0].height,n,i,T_),this.isCompressedCubeTexture=!0,this.isCubeTexture=!0,this.image=e}}class sue extends Ga{constructor(e,n,i,r,s,a,o,c,l){super(e,n,i,r,s,a,o,c,l),this.isCanvasTexture=!0,this.needsUpdate=!0}}class JA extends Ga{constructor(e,n,i=s0,r,s,a,o=Va,c=Va,l,u=FC){if(u!==FC&&u!==XT)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");super(null,r,s,a,o,c,u,i,l),this.isDepthTexture=!0,this.image={width:e,height:n},this.flipY=!1,this.generateMipmaps=!1,this.compareFunction=null}copy(e){return super.copy(e),this.source=new Eb(Object.assign({},e.image)),this.compareFunction=e.compareFunction,this}toJSON(e){const n=super.toJSON(e);return this.compareFunction!==null&&(n.compareFunction=this.compareFunction),n}}class QAe extends JA{constructor(e=1,n=1,i=1){super(e,n),this.isDepthArrayTexture=!0,this.image={width:e,height:n,depth:i},this.flipY=!1,this.generateMipmaps=!1,this.compareFunction=null,this.layerUpdates=new Set}addLayerUpdate(e){this.layerUpdates.add(e)}clearLayerUpdates(){this.layerUpdates.clear()}}class dF extends tr{constructor(e=1,n=1,i=4,r=8,s=1){super(),this.type="CapsuleGeometry",this.parameters={radius:e,height:n,capSegments:i,radialSegments:r,heightSegments:s},n=Math.max(0,n),i=Math.max(1,Math.floor(i)),r=Math.max(3,Math.floor(r)),s=Math.max(1,Math.floor(s));const a=[],o=[],c=[],l=[],u=n/2,h=Math.PI/2*e,d=n,f=2*h+d,p=i*2+s,g=r+1,_=new Oe,v=new Oe;for(let b=0;b<=p;b++){let S=0,x=0,M=0,R=0;if(b<=i){const P=b/i,U=P*Math.PI/2;x=-u-e*Math.cos(U),M=e*Math.sin(U),R=-e*Math.cos(U),S=P*h}else if(b<=i+s){const P=(b-i)/s;x=-u+P*n,M=e,R=0,S=h+P*d}else{const P=(b-i-s)/i,U=P*Math.PI/2;x=u+e*Math.sin(U),M=e*Math.cos(U),R=e*Math.sin(U),S=h+d+P*h}const I=Math.max(0,Math.min(1,S/f));let k=0;b===0?k=.5/r:b===p&&(k=-.5/r);for(let P=0;P<=r;P++){const U=P/r,V=U*Math.PI*2,$=Math.sin(V),q=Math.cos(V);v.x=-M*q,v.y=x,v.z=M*$,o.push(v.x,v.y,v.z),_.set(-M*q,R,M*$),_.normalize(),c.push(_.x,_.y,_.z),l.push(U+k,I)}if(b>0){const P=(b-1)*g;for(let U=0;U<r;U++){const V=P+U,$=P+U+1,q=b*g+U,Y=b*g+U+1;a.push(V,$,q),a.push($,Y,q)}}}this.setIndex(a),this.setAttribute("position",new qn(o,3)),this.setAttribute("normal",new qn(c,3)),this.setAttribute("uv",new qn(l,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new dF(e.radius,e.height,e.capSegments,e.radialSegments,e.heightSegments)}}class fF extends tr{constructor(e=1,n=32,i=0,r=Math.PI*2){super(),this.type="CircleGeometry",this.parameters={radius:e,segments:n,thetaStart:i,thetaLength:r},n=Math.max(3,n);const s=[],a=[],o=[],c=[],l=new Oe,u=new xt;a.push(0,0,0),o.push(0,0,1),c.push(.5,.5);for(let h=0,d=3;h<=n;h++,d+=3){const f=i+h/n*r;l.x=e*Math.cos(f),l.y=e*Math.sin(f),a.push(l.x,l.y,l.z),o.push(0,0,1),u.x=(a[d]/e+1)/2,u.y=(a[d+1]/e+1)/2,c.push(u.x,u.y)}for(let h=1;h<=n;h++)s.push(h,h+1,0);this.setIndex(s),this.setAttribute("position",new qn(a,3)),this.setAttribute("normal",new qn(o,3)),this.setAttribute("uv",new qn(c,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new fF(e.radius,e.segments,e.thetaStart,e.thetaLength)}}class UI extends tr{constructor(e=1,n=1,i=1,r=32,s=1,a=!1,o=0,c=Math.PI*2){super(),this.type="CylinderGeometry",this.parameters={radiusTop:e,radiusBottom:n,height:i,radialSegments:r,heightSegments:s,openEnded:a,thetaStart:o,thetaLength:c};const l=this;r=Math.floor(r),s=Math.floor(s);const u=[],h=[],d=[],f=[];let p=0;const g=[],_=i/2;let v=0;b(),a===!1&&(e>0&&S(!0),n>0&&S(!1)),this.setIndex(u),this.setAttribute("position",new qn(h,3)),this.setAttribute("normal",new qn(d,3)),this.setAttribute("uv",new qn(f,2));function b(){const x=new Oe,M=new Oe;let R=0;const I=(n-e)/i;for(let k=0;k<=s;k++){const P=[],U=k/s,V=U*(n-e)+e;for(let $=0;$<=r;$++){const q=$/r,Y=q*c+o,te=Math.sin(Y),G=Math.cos(Y);M.x=V*te,M.y=-U*i+_,M.z=V*G,h.push(M.x,M.y,M.z),x.set(te,I,G).normalize(),d.push(x.x,x.y,x.z),f.push(q,1-U),P.push(p++)}g.push(P)}for(let k=0;k<r;k++)for(let P=0;P<s;P++){const U=g[P][k],V=g[P+1][k],$=g[P+1][k+1],q=g[P][k+1];(e>0||P!==0)&&(u.push(U,V,q),R+=3),(n>0||P!==s-1)&&(u.push(V,$,q),R+=3)}l.addGroup(v,R,0),v+=R}function S(x){const M=p,R=new xt,I=new Oe;let k=0;const P=x===!0?e:n,U=x===!0?1:-1;for(let $=1;$<=r;$++)h.push(0,_*U,0),d.push(0,U,0),f.push(.5,.5),p++;const V=p;for(let $=0;$<=r;$++){const Y=$/r*c+o,te=Math.cos(Y),G=Math.sin(Y);I.x=P*G,I.y=_*U,I.z=P*te,h.push(I.x,I.y,I.z),d.push(0,U,0),R.x=te*.5+.5,R.y=G*.5*U+.5,f.push(R.x,R.y),p++}for(let $=0;$<r;$++){const q=M+$,Y=V+$;x===!0?u.push(Y,Y+1,q):u.push(Y+1,Y,q),k+=3}l.addGroup(v,k,x===!0?1:2),v+=k}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new UI(e.radiusTop,e.radiusBottom,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}}class BI extends UI{constructor(e=1,n=1,i=32,r=1,s=!1,a=0,o=Math.PI*2){super(0,e,n,i,r,s,a,o),this.type="ConeGeometry",this.parameters={radius:e,height:n,radialSegments:i,heightSegments:r,openEnded:s,thetaStart:a,thetaLength:o}}static fromJSON(e){return new BI(e.radius,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}}class CE extends tr{constructor(e=[],n=[],i=1,r=0){super(),this.type="PolyhedronGeometry",this.parameters={vertices:e,indices:n,radius:i,detail:r};const s=[],a=[];o(r),l(i),u(),this.setAttribute("position",new qn(s,3)),this.setAttribute("normal",new qn(s.slice(),3)),this.setAttribute("uv",new qn(a,2)),r===0?this.computeVertexNormals():this.normalizeNormals();function o(b){const S=new Oe,x=new Oe,M=new Oe;for(let R=0;R<n.length;R+=3)f(n[R+0],S),f(n[R+1],x),f(n[R+2],M),c(S,x,M,b)}function c(b,S,x,M){const R=M+1,I=[];for(let k=0;k<=R;k++){I[k]=[];const P=b.clone().lerp(x,k/R),U=S.clone().lerp(x,k/R),V=R-k;for(let $=0;$<=V;$++)$===0&&k===R?I[k][$]=P:I[k][$]=P.clone().lerp(U,$/V)}for(let k=0;k<R;k++)for(let P=0;P<2*(R-k)-1;P++){const U=Math.floor(P/2);P%2===0?(d(I[k][U+1]),d(I[k+1][U]),d(I[k][U])):(d(I[k][U+1]),d(I[k+1][U+1]),d(I[k+1][U]))}}function l(b){const S=new Oe;for(let x=0;x<s.length;x+=3)S.x=s[x+0],S.y=s[x+1],S.z=s[x+2],S.normalize().multiplyScalar(b),s[x+0]=S.x,s[x+1]=S.y,s[x+2]=S.z}function u(){const b=new Oe;for(let S=0;S<s.length;S+=3){b.x=s[S+0],b.y=s[S+1],b.z=s[S+2];const x=_(b)/2/Math.PI+.5,M=v(b)/Math.PI+.5;a.push(x,1-M)}p(),h()}function h(){for(let b=0;b<a.length;b+=6){const S=a[b+0],x=a[b+2],M=a[b+4],R=Math.max(S,x,M),I=Math.min(S,x,M);R>.9&&I<.1&&(S<.2&&(a[b+0]+=1),x<.2&&(a[b+2]+=1),M<.2&&(a[b+4]+=1))}}function d(b){s.push(b.x,b.y,b.z)}function f(b,S){const x=b*3;S.x=e[x+0],S.y=e[x+1],S.z=e[x+2]}function p(){const b=new Oe,S=new Oe,x=new Oe,M=new Oe,R=new xt,I=new xt,k=new xt;for(let P=0,U=0;P<s.length;P+=9,U+=6){b.set(s[P+0],s[P+1],s[P+2]),S.set(s[P+3],s[P+4],s[P+5]),x.set(s[P+6],s[P+7],s[P+8]),R.set(a[U+0],a[U+1]),I.set(a[U+2],a[U+3]),k.set(a[U+4],a[U+5]),M.copy(b).add(S).add(x).divideScalar(3);const V=_(M);g(R,U+0,b,V),g(I,U+2,S,V),g(k,U+4,x,V)}}function g(b,S,x,M){M<0&&b.x===1&&(a[S]=b.x-1),x.x===0&&x.z===0&&(a[S]=M/2/Math.PI+.5)}function _(b){return Math.atan2(b.z,-b.x)}function v(b){return Math.atan2(-b.y,Math.sqrt(b.x*b.x+b.z*b.z))}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new CE(e.vertices,e.indices,e.radius,e.details)}}class pF extends CE{constructor(e=1,n=0){const i=(1+Math.sqrt(5))/2,r=1/i,s=[-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-r,-i,0,-r,i,0,r,-i,0,r,i,-r,-i,0,-r,i,0,r,-i,0,r,i,0,-i,0,-r,i,0,-r,-i,0,r,i,0,r],a=[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9];super(s,a,e,n),this.type="DodecahedronGeometry",this.parameters={radius:e,detail:n}}static fromJSON(e){return new pF(e.radius,e.detail)}}const tD=new Oe,nD=new Oe,F5=new Oe,iD=new td;class aue extends tr{constructor(e=null,n=1){if(super(),this.type="EdgesGeometry",this.parameters={geometry:e,thresholdAngle:n},e!==null){const r=Math.pow(10,4),s=Math.cos(RT*n),a=e.getIndex(),o=e.getAttribute("position"),c=a?a.count:o.count,l=[0,0,0],u=["a","b","c"],h=new Array(3),d={},f=[];for(let p=0;p<c;p+=3){a?(l[0]=a.getX(p),l[1]=a.getX(p+1),l[2]=a.getX(p+2)):(l[0]=p,l[1]=p+1,l[2]=p+2);const{a:g,b:_,c:v}=iD;if(g.fromBufferAttribute(o,l[0]),_.fromBufferAttribute(o,l[1]),v.fromBufferAttribute(o,l[2]),iD.getNormal(F5),h[0]=`${Math.round(g.x*r)},${Math.round(g.y*r)},${Math.round(g.z*r)}`,h[1]=`${Math.round(_.x*r)},${Math.round(_.y*r)},${Math.round(_.z*r)}`,h[2]=`${Math.round(v.x*r)},${Math.round(v.y*r)},${Math.round(v.z*r)}`,!(h[0]===h[1]||h[1]===h[2]||h[2]===h[0]))for(let b=0;b<3;b++){const S=(b+1)%3,x=h[b],M=h[S],R=iD[u[b]],I=iD[u[S]],k=`${x}_${M}`,P=`${M}_${x}`;P in d&&d[P]?(F5.dot(d[P].normal)<=s&&(f.push(R.x,R.y,R.z),f.push(I.x,I.y,I.z)),d[P]=null):k in d||(d[k]={index0:l[b],index1:l[S],normal:F5.clone()})}}for(const p in d)if(d[p]){const{index0:g,index1:_}=d[p];tD.fromBufferAttribute(o,g),nD.fromBufferAttribute(o,_),f.push(tD.x,tD.y,tD.z),f.push(nD.x,nD.y,nD.z)}this.setAttribute("position",new qn(f,3))}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}}class km{constructor(){this.type="Curve",this.arcLengthDivisions=200,this.needsUpdate=!1,this.cacheArcLengths=null}getPoint(){console.warn("THREE.Curve: .getPoint() not implemented.")}getPointAt(e,n){const i=this.getUtoTmapping(e);return this.getPoint(i,n)}getPoints(e=5){const n=[];for(let i=0;i<=e;i++)n.push(this.getPoint(i/e));return n}getSpacedPoints(e=5){const n=[];for(let i=0;i<=e;i++)n.push(this.getPointAt(i/e));return n}getLength(){const e=this.getLengths();return e[e.length-1]}getLengths(e=this.arcLengthDivisions){if(this.cacheArcLengths&&this.cacheArcLengths.length===e+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;const n=[];let i,r=this.getPoint(0),s=0;n.push(0);for(let a=1;a<=e;a++)i=this.getPoint(a/e),s+=i.distanceTo(r),n.push(s),r=i;return this.cacheArcLengths=n,n}updateArcLengths(){this.needsUpdate=!0,this.getLengths()}getUtoTmapping(e,n=null){const i=this.getLengths();let r=0;const s=i.length;let a;n?a=n:a=e*i[s-1];let o=0,c=s-1,l;for(;o<=c;)if(r=Math.floor(o+(c-o)/2),l=i[r]-a,l<0)o=r+1;else if(l>0)c=r-1;else{c=r;break}if(r=c,i[r]===a)return r/(s-1);const u=i[r],d=i[r+1]-u,f=(a-u)/d;return(r+f)/(s-1)}getTangent(e,n){let r=e-1e-4,s=e+1e-4;r<0&&(r=0),s>1&&(s=1);const a=this.getPoint(r),o=this.getPoint(s),c=n||(a.isVector2?new xt:new Oe);return c.copy(o).sub(a).normalize(),c}getTangentAt(e,n){const i=this.getUtoTmapping(e);return this.getTangent(i,n)}computeFrenetFrames(e,n=!1){const i=new Oe,r=[],s=[],a=[],o=new Oe,c=new gi;for(let f=0;f<=e;f++){const p=f/e;r[f]=this.getTangentAt(p,new Oe)}s[0]=new Oe,a[0]=new Oe;let l=Number.MAX_VALUE;const u=Math.abs(r[0].x),h=Math.abs(r[0].y),d=Math.abs(r[0].z);u<=l&&(l=u,i.set(1,0,0)),h<=l&&(l=h,i.set(0,1,0)),d<=l&&i.set(0,0,1),o.crossVectors(r[0],i).normalize(),s[0].crossVectors(r[0],o),a[0].crossVectors(r[0],s[0]);for(let f=1;f<=e;f++){if(s[f]=s[f-1].clone(),a[f]=a[f-1].clone(),o.crossVectors(r[f-1],r[f]),o.length()>Number.EPSILON){o.normalize();const p=Math.acos(Ki(r[f-1].dot(r[f]),-1,1));s[f].applyMatrix4(c.makeRotationAxis(o,p))}a[f].crossVectors(r[f],s[f])}if(n===!0){let f=Math.acos(Ki(s[0].dot(s[e]),-1,1));f/=e,r[0].dot(o.crossVectors(s[0],s[e]))>0&&(f=-f);for(let p=1;p<=e;p++)s[p].applyMatrix4(c.makeRotationAxis(r[p],f*p)),a[p].crossVectors(r[p],s[p])}return{tangents:r,normals:s,binormals:a}}clone(){return new this.constructor().copy(this)}copy(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}toJSON(){const e={metadata:{version:4.6,type:"Curve",generator:"Curve.toJSON"}};return e.arcLengthDivisions=this.arcLengthDivisions,e.type=this.type,e}fromJSON(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}}class mF extends km{constructor(e=0,n=0,i=1,r=1,s=0,a=Math.PI*2,o=!1,c=0){super(),this.isEllipseCurve=!0,this.type="EllipseCurve",this.aX=e,this.aY=n,this.xRadius=i,this.yRadius=r,this.aStartAngle=s,this.aEndAngle=a,this.aClockwise=o,this.aRotation=c}getPoint(e,n=new xt){const i=n,r=Math.PI*2;let s=this.aEndAngle-this.aStartAngle;const a=Math.abs(s)<Number.EPSILON;for(;s<0;)s+=r;for(;s>r;)s-=r;s<Number.EPSILON&&(a?s=0:s=r),this.aClockwise===!0&&!a&&(s===r?s=-r:s=s-r);const o=this.aStartAngle+e*s;let c=this.aX+this.xRadius*Math.cos(o),l=this.aY+this.yRadius*Math.sin(o);if(this.aRotation!==0){const u=Math.cos(this.aRotation),h=Math.sin(this.aRotation),d=c-this.aX,f=l-this.aY;c=d*u-f*h+this.aX,l=d*h+f*u+this.aY}return i.set(c,l)}copy(e){return super.copy(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}toJSON(){const e=super.toJSON();return e.aX=this.aX,e.aY=this.aY,e.xRadius=this.xRadius,e.yRadius=this.yRadius,e.aStartAngle=this.aStartAngle,e.aEndAngle=this.aEndAngle,e.aClockwise=this.aClockwise,e.aRotation=this.aRotation,e}fromJSON(e){return super.fromJSON(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}}class oue extends mF{constructor(e,n,i,r,s,a){super(e,n,i,i,r,s,a),this.isArcCurve=!0,this.type="ArcCurve"}}function iW(){let t=0,e=0,n=0,i=0;function r(s,a,o,c){t=s,e=o,n=-3*s+3*a-2*o-c,i=2*s-2*a+o+c}return{initCatmullRom:function(s,a,o,c,l){r(a,o,l*(o-s),l*(c-a))},initNonuniformCatmullRom:function(s,a,o,c,l,u,h){let d=(a-s)/l-(o-s)/(l+u)+(o-a)/u,f=(o-a)/u-(c-a)/(u+h)+(c-o)/h;d*=u,f*=u,r(a,o,d,f)},calc:function(s){const a=s*s,o=a*s;return t+e*s+n*a+i*o}}}const rD=new Oe,z5=new iW,j5=new iW,H5=new iW;class cue extends km{constructor(e=[],n=!1,i="centripetal",r=.5){super(),this.isCatmullRomCurve3=!0,this.type="CatmullRomCurve3",this.points=e,this.closed=n,this.curveType=i,this.tension=r}getPoint(e,n=new Oe){const i=n,r=this.points,s=r.length,a=(s-(this.closed?0:1))*e;let o=Math.floor(a),c=a-o;this.closed?o+=o>0?0:(Math.floor(Math.abs(o)/s)+1)*s:c===0&&o===s-1&&(o=s-2,c=1);let l,u;this.closed||o>0?l=r[(o-1)%s]:(rD.subVectors(r[0],r[1]).add(r[0]),l=rD);const h=r[o%s],d=r[(o+1)%s];if(this.closed||o+2<s?u=r[(o+2)%s]:(rD.subVectors(r[s-1],r[s-2]).add(r[s-1]),u=rD),this.curveType==="centripetal"||this.curveType==="chordal"){const f=this.curveType==="chordal"?.5:.25;let p=Math.pow(l.distanceToSquared(h),f),g=Math.pow(h.distanceToSquared(d),f),_=Math.pow(d.distanceToSquared(u),f);g<1e-4&&(g=1),p<1e-4&&(p=g),_<1e-4&&(_=g),z5.initNonuniformCatmullRom(l.x,h.x,d.x,u.x,p,g,_),j5.initNonuniformCatmullRom(l.y,h.y,d.y,u.y,p,g,_),H5.initNonuniformCatmullRom(l.z,h.z,d.z,u.z,p,g,_)}else this.curveType==="catmullrom"&&(z5.initCatmullRom(l.x,h.x,d.x,u.x,this.tension),j5.initCatmullRom(l.y,h.y,d.y,u.y,this.tension),H5.initCatmullRom(l.z,h.z,d.z,u.z,this.tension));return i.set(z5.calc(c),j5.calc(c),H5.calc(c)),i}copy(e){super.copy(e),this.points=[];for(let n=0,i=e.points.length;n<i;n++){const r=e.points[n];this.points.push(r.clone())}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}toJSON(){const e=super.toJSON();e.points=[];for(let n=0,i=this.points.length;n<i;n++){const r=this.points[n];e.points.push(r.toArray())}return e.closed=this.closed,e.curveType=this.curveType,e.tension=this.tension,e}fromJSON(e){super.fromJSON(e),this.points=[];for(let n=0,i=e.points.length;n<i;n++){const r=e.points[n];this.points.push(new Oe().fromArray(r))}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}}function LJ(t,e,n,i,r){const s=(i-e)*.5,a=(r-n)*.5,o=t*t,c=t*o;return(2*n-2*i+s+a)*c+(-3*n+3*i-2*s-a)*o+s*t+n}function eRe(t,e){const n=1-t;return n*n*e}function tRe(t,e){return 2*(1-t)*t*e}function nRe(t,e){return t*t*e}function sO(t,e,n,i){return eRe(t,e)+tRe(t,n)+nRe(t,i)}function iRe(t,e){const n=1-t;return n*n*n*e}function rRe(t,e){const n=1-t;return 3*n*n*t*e}function sRe(t,e){return 3*(1-t)*t*t*e}function aRe(t,e){return t*t*t*e}function aO(t,e,n,i,r){return iRe(t,e)+rRe(t,n)+sRe(t,i)+aRe(t,r)}class rW extends km{constructor(e=new xt,n=new xt,i=new xt,r=new xt){super(),this.isCubicBezierCurve=!0,this.type="CubicBezierCurve",this.v0=e,this.v1=n,this.v2=i,this.v3=r}getPoint(e,n=new xt){const i=n,r=this.v0,s=this.v1,a=this.v2,o=this.v3;return i.set(aO(e,r.x,s.x,a.x,o.x),aO(e,r.y,s.y,a.y,o.y)),i}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}}class lue extends km{constructor(e=new Oe,n=new Oe,i=new Oe,r=new Oe){super(),this.isCubicBezierCurve3=!0,this.type="CubicBezierCurve3",this.v0=e,this.v1=n,this.v2=i,this.v3=r}getPoint(e,n=new Oe){const i=n,r=this.v0,s=this.v1,a=this.v2,o=this.v3;return i.set(aO(e,r.x,s.x,a.x,o.x),aO(e,r.y,s.y,a.y,o.y),aO(e,r.z,s.z,a.z,o.z)),i}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}}class sW extends km{constructor(e=new xt,n=new xt){super(),this.isLineCurve=!0,this.type="LineCurve",this.v1=e,this.v2=n}getPoint(e,n=new xt){const i=n;return e===1?i.copy(this.v2):(i.copy(this.v2).sub(this.v1),i.multiplyScalar(e).add(this.v1)),i}getPointAt(e,n){return this.getPoint(e,n)}getTangent(e,n=new xt){return n.subVectors(this.v2,this.v1).normalize()}getTangentAt(e,n){return this.getTangent(e,n)}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class uue extends km{constructor(e=new Oe,n=new Oe){super(),this.isLineCurve3=!0,this.type="LineCurve3",this.v1=e,this.v2=n}getPoint(e,n=new Oe){const i=n;return e===1?i.copy(this.v2):(i.copy(this.v2).sub(this.v1),i.multiplyScalar(e).add(this.v1)),i}getPointAt(e,n){return this.getPoint(e,n)}getTangent(e,n=new Oe){return n.subVectors(this.v2,this.v1).normalize()}getTangentAt(e,n){return this.getTangent(e,n)}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class aW extends km{constructor(e=new xt,n=new xt,i=new xt){super(),this.isQuadraticBezierCurve=!0,this.type="QuadraticBezierCurve",this.v0=e,this.v1=n,this.v2=i}getPoint(e,n=new xt){const i=n,r=this.v0,s=this.v1,a=this.v2;return i.set(sO(e,r.x,s.x,a.x),sO(e,r.y,s.y,a.y)),i}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class oW extends km{constructor(e=new Oe,n=new Oe,i=new Oe){super(),this.isQuadraticBezierCurve3=!0,this.type="QuadraticBezierCurve3",this.v0=e,this.v1=n,this.v2=i}getPoint(e,n=new Oe){const i=n,r=this.v0,s=this.v1,a=this.v2;return i.set(sO(e,r.x,s.x,a.x),sO(e,r.y,s.y,a.y),sO(e,r.z,s.z,a.z)),i}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class cW extends km{constructor(e=[]){super(),this.isSplineCurve=!0,this.type="SplineCurve",this.points=e}getPoint(e,n=new xt){const i=n,r=this.points,s=(r.length-1)*e,a=Math.floor(s),o=s-a,c=r[a===0?a:a-1],l=r[a],u=r[a>r.length-2?r.length-1:a+1],h=r[a>r.length-3?r.length-1:a+2];return i.set(LJ(o,c.x,l.x,u.x,h.x),LJ(o,c.y,l.y,u.y,h.y)),i}copy(e){super.copy(e),this.points=[];for(let n=0,i=e.points.length;n<i;n++){const r=e.points[n];this.points.push(r.clone())}return this}toJSON(){const e=super.toJSON();e.points=[];for(let n=0,i=this.points.length;n<i;n++){const r=this.points[n];e.points.push(r.toArray())}return e}fromJSON(e){super.fromJSON(e),this.points=[];for(let n=0,i=e.points.length;n<i;n++){const r=e.points[n];this.points.push(new xt().fromArray(r))}return this}}var OU=Object.freeze({__proto__:null,ArcCurve:oue,CatmullRomCurve3:cue,CubicBezierCurve:rW,CubicBezierCurve3:lue,EllipseCurve:mF,LineCurve:sW,LineCurve3:uue,QuadraticBezierCurve:aW,QuadraticBezierCurve3:oW,SplineCurve:cW});class hue extends km{constructor(){super(),this.type="CurvePath",this.curves=[],this.autoClose=!1}add(e){this.curves.push(e)}closePath(){const e=this.curves[0].getPoint(0),n=this.curves[this.curves.length-1].getPoint(1);if(!e.equals(n)){const i=e.isVector2===!0?"LineCurve":"LineCurve3";this.curves.push(new OU[i](n,e))}return this}getPoint(e,n){const i=e*this.getLength(),r=this.getCurveLengths();let s=0;for(;s<r.length;){if(r[s]>=i){const a=r[s]-i,o=this.curves[s],c=o.getLength(),l=c===0?0:1-a/c;return o.getPointAt(l,n)}s++}return null}getLength(){const e=this.getCurveLengths();return e[e.length-1]}updateArcLengths(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()}getCurveLengths(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;const e=[];let n=0;for(let i=0,r=this.curves.length;i<r;i++)n+=this.curves[i].getLength(),e.push(n);return this.cacheLengths=e,e}getSpacedPoints(e=40){const n=[];for(let i=0;i<=e;i++)n.push(this.getPoint(i/e));return this.autoClose&&n.push(n[0]),n}getPoints(e=12){const n=[];let i;for(let r=0,s=this.curves;r<s.length;r++){const a=s[r],o=a.isEllipseCurve?e*2:a.isLineCurve||a.isLineCurve3?1:a.isSplineCurve?e*a.points.length:e,c=a.getPoints(o);for(let l=0;l<c.length;l++){const u=c[l];i&&i.equals(u)||(n.push(u),i=u)}}return this.autoClose&&n.length>1&&!n[n.length-1].equals(n[0])&&n.push(n[0]),n}copy(e){super.copy(e),this.curves=[];for(let n=0,i=e.curves.length;n<i;n++){const r=e.curves[n];this.curves.push(r.clone())}return this.autoClose=e.autoClose,this}toJSON(){const e=super.toJSON();e.autoClose=this.autoClose,e.curves=[];for(let n=0,i=this.curves.length;n<i;n++){const r=this.curves[n];e.curves.push(r.toJSON())}return e}fromJSON(e){super.fromJSON(e),this.autoClose=e.autoClose,this.curves=[];for(let n=0,i=e.curves.length;n<i;n++){const r=e.curves[n];this.curves.push(new OU[r.type]().fromJSON(r))}return this}}class NU extends hue{constructor(e){super(),this.type="Path",this.currentPoint=new xt,e&&this.setFromPoints(e)}setFromPoints(e){this.moveTo(e[0].x,e[0].y);for(let n=1,i=e.length;n<i;n++)this.lineTo(e[n].x,e[n].y);return this}moveTo(e,n){return this.currentPoint.set(e,n),this}lineTo(e,n){const i=new sW(this.currentPoint.clone(),new xt(e,n));return this.curves.push(i),this.currentPoint.set(e,n),this}quadraticCurveTo(e,n,i,r){const s=new aW(this.currentPoint.clone(),new xt(e,n),new xt(i,r));return this.curves.push(s),this.currentPoint.set(i,r),this}bezierCurveTo(e,n,i,r,s,a){const o=new rW(this.currentPoint.clone(),new xt(e,n),new xt(i,r),new xt(s,a));return this.curves.push(o),this.currentPoint.set(s,a),this}splineThru(e){const n=[this.currentPoint.clone()].concat(e),i=new cW(n);return this.curves.push(i),this.currentPoint.copy(e[e.length-1]),this}arc(e,n,i,r,s,a){const o=this.currentPoint.x,c=this.currentPoint.y;return this.absarc(e+o,n+c,i,r,s,a),this}absarc(e,n,i,r,s,a){return this.absellipse(e,n,i,i,r,s,a),this}ellipse(e,n,i,r,s,a,o,c){const l=this.currentPoint.x,u=this.currentPoint.y;return this.absellipse(e+l,n+u,i,r,s,a,o,c),this}absellipse(e,n,i,r,s,a,o,c){const l=new mF(e,n,i,r,s,a,o,c);if(this.curves.length>0){const h=l.getPoint(0);h.equals(this.currentPoint)||this.lineTo(h.x,h.y)}this.curves.push(l);const u=l.getPoint(1);return this.currentPoint.copy(u),this}copy(e){return super.copy(e),this.currentPoint.copy(e.currentPoint),this}toJSON(){const e=super.toJSON();return e.currentPoint=this.currentPoint.toArray(),e}fromJSON(e){return super.fromJSON(e),this.currentPoint.fromArray(e.currentPoint),this}}class MT extends NU{constructor(e){super(e),this.uuid=cf(),this.type="Shape",this.holes=[]}getPointsHoles(e){const n=[];for(let i=0,r=this.holes.length;i<r;i++)n[i]=this.holes[i].getPoints(e);return n}extractPoints(e){return{shape:this.getPoints(e),holes:this.getPointsHoles(e)}}copy(e){super.copy(e),this.holes=[];for(let n=0,i=e.holes.length;n<i;n++){const r=e.holes[n];this.holes.push(r.clone())}return this}toJSON(){const e=super.toJSON();e.uuid=this.uuid,e.holes=[];for(let n=0,i=this.holes.length;n<i;n++){const r=this.holes[n];e.holes.push(r.toJSON())}return e}fromJSON(e){super.fromJSON(e),this.uuid=e.uuid,this.holes=[];for(let n=0,i=e.holes.length;n<i;n++){const r=e.holes[n];this.holes.push(new NU().fromJSON(r))}return this}}function oRe(t,e,n=2){const i=e&&e.length,r=i?e[0]*n:t.length;let s=due(t,0,r,n,!0);const a=[];if(!s||s.next===s.prev)return a;let o,c,l;if(i&&(s=dRe(t,e,s,n)),t.length>80*n){o=1/0,c=1/0;let u=-1/0,h=-1/0;for(let d=n;d<r;d+=n){const f=t[d],p=t[d+1];f<o&&(o=f),p<c&&(c=p),f>u&&(u=f),p>h&&(h=p)}l=Math.max(u-o,h-c),l=l!==0?32767/l:0}return JO(s,a,n,o,c,l,0),a}function due(t,e,n,i,r){let s;if(r===TRe(t,e,n,i)>0)for(let a=e;a<n;a+=i)s=UJ(a/i|0,t[a],t[a+1],s);else for(let a=n-i;a>=e;a-=i)s=UJ(a/i|0,t[a],t[a+1],s);return s&&qC(s,s.next)&&(eN(s),s=s.next),s}function JT(t,e){if(!t)return t;e||(e=t);let n=t,i;do if(i=!1,!n.steiner&&(qC(n,n.next)||ao(n.prev,n,n.next)===0)){if(eN(n),n=e=n.prev,n===n.next)break;i=!0}else n=n.next;while(i||n!==e);return e}function JO(t,e,n,i,r,s,a){if(!t)return;!a&&s&&vRe(t,i,r,s);let o=t;for(;t.prev!==t.next;){const c=t.prev,l=t.next;if(s?lRe(t,i,r,s):cRe(t)){e.push(c.i,t.i,l.i),eN(t),t=l.next,o=l.next;continue}if(t=l,t===o){a?a===1?(t=uRe(JT(t),e),JO(t,e,n,i,r,s,2)):a===2&&hRe(t,e,n,i,r,s):JO(JT(t),e,n,i,r,s,1);break}}}function cRe(t){const e=t.prev,n=t,i=t.next;if(ao(e,n,i)>=0)return!1;const r=e.x,s=n.x,a=i.x,o=e.y,c=n.y,l=i.y,u=Math.min(r,s,a),h=Math.min(o,c,l),d=Math.max(r,s,a),f=Math.max(o,c,l);let p=i.next;for(;p!==e;){if(p.x>=u&&p.x<=d&&p.y>=h&&p.y<=f&&kM(r,o,s,c,a,l,p.x,p.y)&&ao(p.prev,p,p.next)>=0)return!1;p=p.next}return!0}function lRe(t,e,n,i){const r=t.prev,s=t,a=t.next;if(ao(r,s,a)>=0)return!1;const o=r.x,c=s.x,l=a.x,u=r.y,h=s.y,d=a.y,f=Math.min(o,c,l),p=Math.min(u,h,d),g=Math.max(o,c,l),_=Math.max(u,h,d),v=tG(f,p,e,n,i),b=tG(g,_,e,n,i);let S=t.prevZ,x=t.nextZ;for(;S&&S.z>=v&&x&&x.z<=b;){if(S.x>=f&&S.x<=g&&S.y>=p&&S.y<=_&&S!==r&&S!==a&&kM(o,u,c,h,l,d,S.x,S.y)&&ao(S.prev,S,S.next)>=0||(S=S.prevZ,x.x>=f&&x.x<=g&&x.y>=p&&x.y<=_&&x!==r&&x!==a&&kM(o,u,c,h,l,d,x.x,x.y)&&ao(x.prev,x,x.next)>=0))return!1;x=x.nextZ}for(;S&&S.z>=v;){if(S.x>=f&&S.x<=g&&S.y>=p&&S.y<=_&&S!==r&&S!==a&&kM(o,u,c,h,l,d,S.x,S.y)&&ao(S.prev,S,S.next)>=0)return!1;S=S.prevZ}for(;x&&x.z<=b;){if(x.x>=f&&x.x<=g&&x.y>=p&&x.y<=_&&x!==r&&x!==a&&kM(o,u,c,h,l,d,x.x,x.y)&&ao(x.prev,x,x.next)>=0)return!1;x=x.nextZ}return!0}function uRe(t,e){let n=t;do{const i=n.prev,r=n.next.next;!qC(i,r)&&pue(i,n,n.next,r)&&QO(i,r)&&QO(r,i)&&(e.push(i.i,n.i,r.i),eN(n),eN(n.next),n=t=r),n=n.next}while(n!==t);return JT(n)}function hRe(t,e,n,i,r,s){let a=t;do{let o=a.next.next;for(;o!==a.prev;){if(a.i!==o.i&&bRe(a,o)){let c=mue(a,o);a=JT(a,a.next),c=JT(c,c.next),JO(a,e,n,i,r,s,0),JO(c,e,n,i,r,s,0);return}o=o.next}a=a.next}while(a!==t)}function dRe(t,e,n,i){const r=[];for(let s=0,a=e.length;s<a;s++){const o=e[s]*i,c=s<a-1?e[s+1]*i:t.length,l=due(t,o,c,i,!1);l===l.next&&(l.steiner=!0),r.push(yRe(l))}r.sort(fRe);for(let s=0;s<r.length;s++)n=pRe(r[s],n);return n}function fRe(t,e){let n=t.x-e.x;if(n===0&&(n=t.y-e.y,n===0)){const i=(t.next.y-t.y)/(t.next.x-t.x),r=(e.next.y-e.y)/(e.next.x-e.x);n=i-r}return n}function pRe(t,e){const n=mRe(t,e);if(!n)return e;const i=mue(n,t);return JT(i,i.next),JT(n,n.next)}function mRe(t,e){let n=e;const i=t.x,r=t.y;let s=-1/0,a;if(qC(t,n))return n;do{if(qC(t,n.next))return n.next;if(r<=n.y&&r>=n.next.y&&n.next.y!==n.y){const h=n.x+(r-n.y)*(n.next.x-n.x)/(n.next.y-n.y);if(h<=i&&h>s&&(s=h,a=n.x<n.next.x?n:n.next,h===i))return a}n=n.next}while(n!==e);if(!a)return null;const o=a,c=a.x,l=a.y;let u=1/0;n=a;do{if(i>=n.x&&n.x>=c&&i!==n.x&&fue(r<l?i:s,r,c,l,r<l?s:i,r,n.x,n.y)){const h=Math.abs(r-n.y)/(i-n.x);QO(n,t)&&(h<u||h===u&&(n.x>a.x||n.x===a.x&&gRe(a,n)))&&(a=n,u=h)}n=n.next}while(n!==o);return a}function gRe(t,e){return ao(t.prev,t,e.prev)<0&&ao(e.next,t,t.next)<0}function vRe(t,e,n,i){let r=t;do r.z===0&&(r.z=tG(r.x,r.y,e,n,i)),r.prevZ=r.prev,r.nextZ=r.next,r=r.next;while(r!==t);r.prevZ.nextZ=null,r.prevZ=null,_Re(r)}function _Re(t){let e,n=1;do{let i=t,r;t=null;let s=null;for(e=0;i;){e++;let a=i,o=0;for(let l=0;l<n&&(o++,a=a.nextZ,!!a);l++);let c=n;for(;o>0||c>0&&a;)o!==0&&(c===0||!a||i.z<=a.z)?(r=i,i=i.nextZ,o--):(r=a,a=a.nextZ,c--),s?s.nextZ=r:t=r,r.prevZ=s,s=r;i=a}s.nextZ=null,n*=2}while(e>1);return t}function tG(t,e,n,i,r){return t=(t-n)*r|0,e=(e-i)*r|0,t=(t|t<<8)&16711935,t=(t|t<<4)&252645135,t=(t|t<<2)&858993459,t=(t|t<<1)&1431655765,e=(e|e<<8)&16711935,e=(e|e<<4)&252645135,e=(e|e<<2)&858993459,e=(e|e<<1)&1431655765,t|e<<1}function yRe(t){let e=t,n=t;do(e.x<n.x||e.x===n.x&&e.y<n.y)&&(n=e),e=e.next;while(e!==t);return n}function fue(t,e,n,i,r,s,a,o){return(r-a)*(e-o)>=(t-a)*(s-o)&&(t-a)*(i-o)>=(n-a)*(e-o)&&(n-a)*(s-o)>=(r-a)*(i-o)}function kM(t,e,n,i,r,s,a,o){return!(t===a&&e===o)&&fue(t,e,n,i,r,s,a,o)}function bRe(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!ERe(t,e)&&(QO(t,e)&&QO(e,t)&&SRe(t,e)&&(ao(t.prev,t,e.prev)||ao(t,e.prev,e))||qC(t,e)&&ao(t.prev,t,t.next)>0&&ao(e.prev,e,e.next)>0)}function ao(t,e,n){return(e.y-t.y)*(n.x-e.x)-(e.x-t.x)*(n.y-e.y)}function qC(t,e){return t.x===e.x&&t.y===e.y}function pue(t,e,n,i){const r=aD(ao(t,e,n)),s=aD(ao(t,e,i)),a=aD(ao(n,i,t)),o=aD(ao(n,i,e));return!!(r!==s&&a!==o||r===0&&sD(t,n,e)||s===0&&sD(t,i,e)||a===0&&sD(n,t,i)||o===0&&sD(n,e,i))}function sD(t,e,n){return e.x<=Math.max(t.x,n.x)&&e.x>=Math.min(t.x,n.x)&&e.y<=Math.max(t.y,n.y)&&e.y>=Math.min(t.y,n.y)}function aD(t){return t>0?1:t<0?-1:0}function ERe(t,e){let n=t;do{if(n.i!==t.i&&n.next.i!==t.i&&n.i!==e.i&&n.next.i!==e.i&&pue(n,n.next,t,e))return!0;n=n.next}while(n!==t);return!1}function QO(t,e){return ao(t.prev,t,t.next)<0?ao(t,e,t.next)>=0&&ao(t,t.prev,e)>=0:ao(t,e,t.prev)<0||ao(t,t.next,e)<0}function SRe(t,e){let n=t,i=!1;const r=(t.x+e.x)/2,s=(t.y+e.y)/2;do n.y>s!=n.next.y>s&&n.next.y!==n.y&&r<(n.next.x-n.x)*(s-n.y)/(n.next.y-n.y)+n.x&&(i=!i),n=n.next;while(n!==t);return i}function mue(t,e){const n=nG(t.i,t.x,t.y),i=nG(e.i,e.x,e.y),r=t.next,s=e.prev;return t.next=e,e.prev=t,n.next=r,r.prev=n,i.next=n,n.prev=i,s.next=i,i.prev=s,i}function UJ(t,e,n,i){const r=nG(t,e,n);return i?(r.next=i.next,r.prev=i,i.next.prev=r,i.next=r):(r.prev=r,r.next=r),r}function eN(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function nG(t,e,n){return{i:t,x:e,y:n,prev:null,next:null,z:0,prevZ:null,nextZ:null,steiner:!1}}function TRe(t,e,n,i){let r=0;for(let s=e,a=n-i;s<n;s+=i)r+=(t[a]-t[s])*(t[s+1]+t[a+1]),a=s;return r}class xRe{static triangulate(e,n,i=2){return oRe(e,n,i)}}class ym{static area(e){const n=e.length;let i=0;for(let r=n-1,s=0;s<n;r=s++)i+=e[r].x*e[s].y-e[s].x*e[r].y;return i*.5}static isClockWise(e){return ym.area(e)<0}static triangulateShape(e,n){const i=[],r=[],s=[];BJ(e),FJ(i,e);let a=e.length;n.forEach(BJ);for(let c=0;c<n.length;c++)r.push(a),a+=n[c].length,FJ(i,n[c]);const o=xRe.triangulate(i,r);for(let c=0;c<o.length;c+=3)s.push(o.slice(c,c+3));return s}}function BJ(t){const e=t.length;e>2&&t[e-1].equals(t[0])&&t.pop()}function FJ(t,e){for(let n=0;n<e.length;n++)t.push(e[n].x),t.push(e[n].y)}class gF extends tr{constructor(e=new MT([new xt(.5,.5),new xt(-.5,.5),new xt(-.5,-.5),new xt(.5,-.5)]),n={}){super(),this.type="ExtrudeGeometry",this.parameters={shapes:e,options:n},e=Array.isArray(e)?e:[e];const i=this,r=[],s=[];for(let o=0,c=e.length;o<c;o++){const l=e[o];a(l)}this.setAttribute("position",new qn(r,3)),this.setAttribute("uv",new qn(s,2)),this.computeVertexNormals();function a(o){const c=[],l=n.curveSegments!==void 0?n.curveSegments:12,u=n.steps!==void 0?n.steps:1,h=n.depth!==void 0?n.depth:1;let d=n.bevelEnabled!==void 0?n.bevelEnabled:!0,f=n.bevelThickness!==void 0?n.bevelThickness:.2,p=n.bevelSize!==void 0?n.bevelSize:f-.1,g=n.bevelOffset!==void 0?n.bevelOffset:0,_=n.bevelSegments!==void 0?n.bevelSegments:3;const v=n.extrudePath,b=n.UVGenerator!==void 0?n.UVGenerator:wRe;let S,x=!1,M,R,I,k;v&&(S=v.getSpacedPoints(u),x=!0,d=!1,M=v.computeFrenetFrames(u,!1),R=new Oe,I=new Oe,k=new Oe),d||(_=0,f=0,p=0,g=0);const P=o.extractPoints(l);let U=P.shape;const V=P.holes;if(!ym.isClockWise(U)){U=U.reverse();for(let pe=0,ze=V.length;pe<ze;pe++){const Le=V[pe];ym.isClockWise(Le)&&(V[pe]=Le.reverse())}}function q(pe){const Le=10000000000000001e-36;let rt=pe[0];for(let dt=1;dt<=pe.length;dt++){const pt=dt%pe.length,bt=pe[pt],we=bt.x-rt.x,he=bt.y-rt.y,$e=we*we+he*he,et=Math.max(Math.abs(bt.x),Math.abs(bt.y),Math.abs(rt.x),Math.abs(rt.y)),Et=Le*et*et;if($e<=Et){pe.splice(pt,1),dt--;continue}rt=bt}}q(U),V.forEach(q);const Y=V.length,te=U;for(let pe=0;pe<Y;pe++){const ze=V[pe];U=U.concat(ze)}function G(pe,ze,Le){return ze||console.error("THREE.ExtrudeGeometry: vec does not exist"),pe.clone().addScaledVector(ze,Le)}const J=U.length;function K(pe,ze,Le){let rt,dt,pt;const bt=pe.x-ze.x,we=pe.y-ze.y,he=Le.x-pe.x,$e=Le.y-pe.y,et=bt*bt+we*we,Et=bt*$e-we*he;if(Math.abs(Et)>Number.EPSILON){const ct=Math.sqrt(et),tn=Math.sqrt(he*he+$e*$e),Ht=ze.x-we/ct,pn=ze.y+bt/ct,le=Le.x-$e/tn,z=Le.y+he/tn,W=((le-Ht)*$e-(z-pn)*he)/(bt*$e-we*he);rt=Ht+bt*W-pe.x,dt=pn+we*W-pe.y;const fe=rt*rt+dt*dt;if(fe<=2)return new xt(rt,dt);pt=Math.sqrt(fe/2)}else{let ct=!1;bt>Number.EPSILON?he>Number.EPSILON&&(ct=!0):bt<-Number.EPSILON?he<-Number.EPSILON&&(ct=!0):Math.sign(we)===Math.sign($e)&&(ct=!0),ct?(rt=-we,dt=bt,pt=Math.sqrt(et)):(rt=bt,dt=we,pt=Math.sqrt(et/2))}return new xt(rt/pt,dt/pt)}const X=[];for(let pe=0,ze=te.length,Le=ze-1,rt=pe+1;pe<ze;pe++,Le++,rt++)Le===ze&&(Le=0),rt===ze&&(rt=0),X[pe]=K(te[pe],te[Le],te[rt]);const ae=[];let ce,Me=X.concat();for(let pe=0,ze=Y;pe<ze;pe++){const Le=V[pe];ce=[];for(let rt=0,dt=Le.length,pt=dt-1,bt=rt+1;rt<dt;rt++,pt++,bt++)pt===dt&&(pt=0),bt===dt&&(bt=0),ce[rt]=K(Le[rt],Le[pt],Le[bt]);ae.push(ce),Me=Me.concat(ce)}let Fe;if(_===0)Fe=ym.triangulateShape(te,V);else{const pe=[],ze=[];for(let Le=0;Le<_;Le++){const rt=Le/_,dt=f*Math.cos(rt*Math.PI/2),pt=p*Math.sin(rt*Math.PI/2)+g;for(let bt=0,we=te.length;bt<we;bt++){const he=G(te[bt],X[bt],pt);gt(he.x,he.y,-dt),rt===0&&pe.push(he)}for(let bt=0,we=Y;bt<we;bt++){const he=V[bt];ce=ae[bt];const $e=[];for(let et=0,Et=he.length;et<Et;et++){const ct=G(he[et],ce[et],pt);gt(ct.x,ct.y,-dt),rt===0&&$e.push(ct)}rt===0&&ze.push($e)}}Fe=ym.triangulateShape(pe,ze)}const Te=Fe.length,Re=p+g;for(let pe=0;pe<J;pe++){const ze=d?G(U[pe],Me[pe],Re):U[pe];x?(I.copy(M.normals[0]).multiplyScalar(ze.x),R.copy(M.binormals[0]).multiplyScalar(ze.y),k.copy(S[0]).add(I).add(R),gt(k.x,k.y,k.z)):gt(ze.x,ze.y,0)}for(let pe=1;pe<=u;pe++)for(let ze=0;ze<J;ze++){const Le=d?G(U[ze],Me[ze],Re):U[ze];x?(I.copy(M.normals[pe]).multiplyScalar(Le.x),R.copy(M.binormals[pe]).multiplyScalar(Le.y),k.copy(S[pe]).add(I).add(R),gt(k.x,k.y,k.z)):gt(Le.x,Le.y,h/u*pe)}for(let pe=_-1;pe>=0;pe--){const ze=pe/_,Le=f*Math.cos(ze*Math.PI/2),rt=p*Math.sin(ze*Math.PI/2)+g;for(let dt=0,pt=te.length;dt<pt;dt++){const bt=G(te[dt],X[dt],rt);gt(bt.x,bt.y,h+Le)}for(let dt=0,pt=V.length;dt<pt;dt++){const bt=V[dt];ce=ae[dt];for(let we=0,he=bt.length;we<he;we++){const $e=G(bt[we],ce[we],rt);x?gt($e.x,$e.y+S[u-1].y,S[u-1].x+Le):gt($e.x,$e.y,h+Le)}}}ge(),_e();function ge(){const pe=r.length/3;if(d){let ze=0,Le=J*ze;for(let rt=0;rt<Te;rt++){const dt=Fe[rt];wt(dt[2]+Le,dt[1]+Le,dt[0]+Le)}ze=u+_*2,Le=J*ze;for(let rt=0;rt<Te;rt++){const dt=Fe[rt];wt(dt[0]+Le,dt[1]+Le,dt[2]+Le)}}else{for(let ze=0;ze<Te;ze++){const Le=Fe[ze];wt(Le[2],Le[1],Le[0])}for(let ze=0;ze<Te;ze++){const Le=Fe[ze];wt(Le[0]+J*u,Le[1]+J*u,Le[2]+J*u)}}i.addGroup(pe,r.length/3-pe,0)}function _e(){const pe=r.length/3;let ze=0;ke(te,ze),ze+=te.length;for(let Le=0,rt=V.length;Le<rt;Le++){const dt=V[Le];ke(dt,ze),ze+=dt.length}i.addGroup(pe,r.length/3-pe,1)}function ke(pe,ze){let Le=pe.length;for(;--Le>=0;){const rt=Le;let dt=Le-1;dt<0&&(dt=pe.length-1);for(let pt=0,bt=u+_*2;pt<bt;pt++){const we=J*pt,he=J*(pt+1),$e=ze+rt+we,et=ze+dt+we,Et=ze+dt+he,ct=ze+rt+he;ye($e,et,Et,ct)}}}function gt(pe,ze,Le){c.push(pe),c.push(ze),c.push(Le)}function wt(pe,ze,Le){Se(pe),Se(ze),Se(Le);const rt=r.length/3,dt=b.generateTopUV(i,r,rt-3,rt-2,rt-1);Qe(dt[0]),Qe(dt[1]),Qe(dt[2])}function ye(pe,ze,Le,rt){Se(pe),Se(ze),Se(rt),Se(ze),Se(Le),Se(rt);const dt=r.length/3,pt=b.generateSideWallUV(i,r,dt-6,dt-3,dt-2,dt-1);Qe(pt[0]),Qe(pt[1]),Qe(pt[3]),Qe(pt[1]),Qe(pt[2]),Qe(pt[3])}function Se(pe){r.push(c[pe*3+0]),r.push(c[pe*3+1]),r.push(c[pe*3+2])}function Qe(pe){s.push(pe.x),s.push(pe.y)}}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){const e=super.toJSON(),n=this.parameters.shapes,i=this.parameters.options;return CRe(n,i,e)}static fromJSON(e,n){const i=[];for(let s=0,a=e.shapes.length;s<a;s++){const o=n[e.shapes[s]];i.push(o)}const r=e.options.extrudePath;return r!==void 0&&(e.options.extrudePath=new OU[r.type]().fromJSON(r)),new gF(i,e.options)}}const wRe={generateTopUV:function(t,e,n,i,r){const s=e[n*3],a=e[n*3+1],o=e[i*3],c=e[i*3+1],l=e[r*3],u=e[r*3+1];return[new xt(s,a),new xt(o,c),new xt(l,u)]},generateSideWallUV:function(t,e,n,i,r,s){const a=e[n*3],o=e[n*3+1],c=e[n*3+2],l=e[i*3],u=e[i*3+1],h=e[i*3+2],d=e[r*3],f=e[r*3+1],p=e[r*3+2],g=e[s*3],_=e[s*3+1],v=e[s*3+2];return Math.abs(o-u)<Math.abs(a-l)?[new xt(a,1-c),new xt(l,1-h),new xt(d,1-p),new xt(g,1-v)]:[new xt(o,1-c),new xt(u,1-h),new xt(f,1-p),new xt(_,1-v)]}};function CRe(t,e,n){if(n.shapes=[],Array.isArray(t))for(let i=0,r=t.length;i<r;i++){const s=t[i];n.shapes.push(s.uuid)}else n.shapes.push(t.uuid);return n.options=Object.assign({},e),e.extrudePath!==void 0&&(n.options.extrudePath=e.extrudePath.toJSON()),n}class vF extends CE{constructor(e=1,n=0){const i=(1+Math.sqrt(5))/2,r=[-1,i,0,1,i,0,-1,-i,0,1,-i,0,0,-1,i,0,1,i,0,-1,-i,0,1,-i,i,0,-1,i,0,1,-i,0,-1,-i,0,1],s=[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1];super(r,s,e,n),this.type="IcosahedronGeometry",this.parameters={radius:e,detail:n}}static fromJSON(e){return new vF(e.radius,e.detail)}}class _F extends tr{constructor(e=[new xt(0,-.5),new xt(.5,0),new xt(0,.5)],n=12,i=0,r=Math.PI*2){super(),this.type="LatheGeometry",this.parameters={points:e,segments:n,phiStart:i,phiLength:r},n=Math.floor(n),r=Ki(r,0,Math.PI*2);const s=[],a=[],o=[],c=[],l=[],u=1/n,h=new Oe,d=new xt,f=new Oe,p=new Oe,g=new Oe;let _=0,v=0;for(let b=0;b<=e.length-1;b++)switch(b){case 0:_=e[b+1].x-e[b].x,v=e[b+1].y-e[b].y,f.x=v*1,f.y=-_,f.z=v*0,g.copy(f),f.normalize(),c.push(f.x,f.y,f.z);break;case e.length-1:c.push(g.x,g.y,g.z);break;default:_=e[b+1].x-e[b].x,v=e[b+1].y-e[b].y,f.x=v*1,f.y=-_,f.z=v*0,p.copy(f),f.x+=g.x,f.y+=g.y,f.z+=g.z,f.normalize(),c.push(f.x,f.y,f.z),g.copy(p)}for(let b=0;b<=n;b++){const S=i+b*u*r,x=Math.sin(S),M=Math.cos(S);for(let R=0;R<=e.length-1;R++){h.x=e[R].x*x,h.y=e[R].y,h.z=e[R].x*M,a.push(h.x,h.y,h.z),d.x=b/n,d.y=R/(e.length-1),o.push(d.x,d.y);const I=c[3*R+0]*x,k=c[3*R+1],P=c[3*R+0]*M;l.push(I,k,P)}}for(let b=0;b<n;b++)for(let S=0;S<e.length-1;S++){const x=S+b*e.length,M=x,R=x+e.length,I=x+e.length+1,k=x+1;s.push(M,R,k),s.push(I,k,R)}this.setIndex(s),this.setAttribute("position",new qn(a,3)),this.setAttribute("uv",new qn(o,2)),this.setAttribute("normal",new qn(l,3))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new _F(e.points,e.segments,e.phiStart,e.phiLength)}}class FI extends CE{constructor(e=1,n=0){const i=[1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],r=[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2];super(i,r,e,n),this.type="OctahedronGeometry",this.parameters={radius:e,detail:n}}static fromJSON(e){return new FI(e.radius,e.detail)}}class QA extends tr{constructor(e=1,n=1,i=1,r=1){super(),this.type="PlaneGeometry",this.parameters={width:e,height:n,widthSegments:i,heightSegments:r};const s=e/2,a=n/2,o=Math.floor(i),c=Math.floor(r),l=o+1,u=c+1,h=e/o,d=n/c,f=[],p=[],g=[],_=[];for(let v=0;v<u;v++){const b=v*d-a;for(let S=0;S<l;S++){const x=S*h-s;p.push(x,-b,0),g.push(0,0,1),_.push(S/o),_.push(1-v/c)}}for(let v=0;v<c;v++)for(let b=0;b<o;b++){const S=b+l*v,x=b+l*(v+1),M=b+1+l*(v+1),R=b+1+l*v;f.push(S,x,R),f.push(x,M,R)}this.setIndex(f),this.setAttribute("position",new qn(p,3)),this.setAttribute("normal",new qn(g,3)),this.setAttribute("uv",new qn(_,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new QA(e.width,e.height,e.widthSegments,e.heightSegments)}}class yF extends tr{constructor(e=.5,n=1,i=32,r=1,s=0,a=Math.PI*2){super(),this.type="RingGeometry",this.parameters={innerRadius:e,outerRadius:n,thetaSegments:i,phiSegments:r,thetaStart:s,thetaLength:a},i=Math.max(3,i),r=Math.max(1,r);const o=[],c=[],l=[],u=[];let h=e;const d=(n-e)/r,f=new Oe,p=new xt;for(let g=0;g<=r;g++){for(let _=0;_<=i;_++){const v=s+_/i*a;f.x=h*Math.cos(v),f.y=h*Math.sin(v),c.push(f.x,f.y,f.z),l.push(0,0,1),p.x=(f.x/n+1)/2,p.y=(f.y/n+1)/2,u.push(p.x,p.y)}h+=d}for(let g=0;g<r;g++){const _=g*(i+1);for(let v=0;v<i;v++){const b=v+_,S=b,x=b+i+1,M=b+i+2,R=b+1;o.push(S,x,R),o.push(x,M,R)}}this.setIndex(o),this.setAttribute("position",new qn(c,3)),this.setAttribute("normal",new qn(l,3)),this.setAttribute("uv",new qn(u,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new yF(e.innerRadius,e.outerRadius,e.thetaSegments,e.phiSegments,e.thetaStart,e.thetaLength)}}class bF extends tr{constructor(e=new MT([new xt(0,.5),new xt(-.5,-.5),new xt(.5,-.5)]),n=12){super(),this.type="ShapeGeometry",this.parameters={shapes:e,curveSegments:n};const i=[],r=[],s=[],a=[];let o=0,c=0;if(Array.isArray(e)===!1)l(e);else for(let u=0;u<e.length;u++)l(e[u]),this.addGroup(o,c,u),o+=c,c=0;this.setIndex(i),this.setAttribute("position",new qn(r,3)),this.setAttribute("normal",new qn(s,3)),this.setAttribute("uv",new qn(a,2));function l(u){const h=r.length/3,d=u.extractPoints(n);let f=d.shape;const p=d.holes;ym.isClockWise(f)===!1&&(f=f.reverse());for(let _=0,v=p.length;_<v;_++){const b=p[_];ym.isClockWise(b)===!0&&(p[_]=b.reverse())}const g=ym.triangulateShape(f,p);for(let _=0,v=p.length;_<v;_++){const b=p[_];f=f.concat(b)}for(let _=0,v=f.length;_<v;_++){const b=f[_];r.push(b.x,b.y,0),s.push(0,0,1),a.push(b.x,b.y)}for(let _=0,v=g.length;_<v;_++){const b=g[_],S=b[0]+h,x=b[1]+h,M=b[2]+h;i.push(S,x,M),c+=3}}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){const e=super.toJSON(),n=this.parameters.shapes;return ARe(n,e)}static fromJSON(e,n){const i=[];for(let r=0,s=e.shapes.length;r<s;r++){const a=n[e.shapes[r]];i.push(a)}return new bF(i,e.curveSegments)}}function ARe(t,e){if(e.shapes=[],Array.isArray(t))for(let n=0,i=t.length;n<i;n++){const r=t[n];e.shapes.push(r.uuid)}else e.shapes.push(t.uuid);return e}class zI extends tr{constructor(e=1,n=32,i=16,r=0,s=Math.PI*2,a=0,o=Math.PI){super(),this.type="SphereGeometry",this.parameters={radius:e,widthSegments:n,heightSegments:i,phiStart:r,phiLength:s,thetaStart:a,thetaLength:o},n=Math.max(3,Math.floor(n)),i=Math.max(2,Math.floor(i));const c=Math.min(a+o,Math.PI);let l=0;const u=[],h=new Oe,d=new Oe,f=[],p=[],g=[],_=[];for(let v=0;v<=i;v++){const b=[],S=v/i;let x=0;v===0&&a===0?x=.5/n:v===i&&c===Math.PI&&(x=-.5/n);for(let M=0;M<=n;M++){const R=M/n;h.x=-e*Math.cos(r+R*s)*Math.sin(a+S*o),h.y=e*Math.cos(a+S*o),h.z=e*Math.sin(r+R*s)*Math.sin(a+S*o),p.push(h.x,h.y,h.z),d.copy(h).normalize(),g.push(d.x,d.y,d.z),_.push(R+x,1-S),b.push(l++)}u.push(b)}for(let v=0;v<i;v++)for(let b=0;b<n;b++){const S=u[v][b+1],x=u[v][b],M=u[v+1][b],R=u[v+1][b+1];(v!==0||a>0)&&f.push(S,x,R),(v!==i-1||c<Math.PI)&&f.push(x,M,R)}this.setIndex(f),this.setAttribute("position",new qn(p,3)),this.setAttribute("normal",new qn(g,3)),this.setAttribute("uv",new qn(_,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new zI(e.radius,e.widthSegments,e.heightSegments,e.phiStart,e.phiLength,e.thetaStart,e.thetaLength)}}class EF extends CE{constructor(e=1,n=0){const i=[1,1,1,-1,-1,1,-1,1,-1,1,-1,-1],r=[2,1,0,0,3,2,1,3,0,2,3,1];super(i,r,e,n),this.type="TetrahedronGeometry",this.parameters={radius:e,detail:n}}static fromJSON(e){return new EF(e.radius,e.detail)}}class SF extends tr{constructor(e=1,n=.4,i=12,r=48,s=Math.PI*2){super(),this.type="TorusGeometry",this.parameters={radius:e,tube:n,radialSegments:i,tubularSegments:r,arc:s},i=Math.floor(i),r=Math.floor(r);const a=[],o=[],c=[],l=[],u=new Oe,h=new Oe,d=new Oe;for(let f=0;f<=i;f++)for(let p=0;p<=r;p++){const g=p/r*s,_=f/i*Math.PI*2;h.x=(e+n*Math.cos(_))*Math.cos(g),h.y=(e+n*Math.cos(_))*Math.sin(g),h.z=n*Math.sin(_),o.push(h.x,h.y,h.z),u.x=e*Math.cos(g),u.y=e*Math.sin(g),d.subVectors(h,u).normalize(),c.push(d.x,d.y,d.z),l.push(p/r),l.push(f/i)}for(let f=1;f<=i;f++)for(let p=1;p<=r;p++){const g=(r+1)*f+p-1,_=(r+1)*(f-1)+p-1,v=(r+1)*(f-1)+p,b=(r+1)*f+p;a.push(g,_,b),a.push(_,v,b)}this.setIndex(a),this.setAttribute("position",new qn(o,3)),this.setAttribute("normal",new qn(c,3)),this.setAttribute("uv",new qn(l,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new SF(e.radius,e.tube,e.radialSegments,e.tubularSegments,e.arc)}}class TF extends tr{constructor(e=1,n=.4,i=64,r=8,s=2,a=3){super(),this.type="TorusKnotGeometry",this.parameters={radius:e,tube:n,tubularSegments:i,radialSegments:r,p:s,q:a},i=Math.floor(i),r=Math.floor(r);const o=[],c=[],l=[],u=[],h=new Oe,d=new Oe,f=new Oe,p=new Oe,g=new Oe,_=new Oe,v=new Oe;for(let S=0;S<=i;++S){const x=S/i*s*Math.PI*2;b(x,s,a,e,f),b(x+.01,s,a,e,p),_.subVectors(p,f),v.addVectors(p,f),g.crossVectors(_,v),v.crossVectors(g,_),g.normalize(),v.normalize();for(let M=0;M<=r;++M){const R=M/r*Math.PI*2,I=-n*Math.cos(R),k=n*Math.sin(R);h.x=f.x+(I*v.x+k*g.x),h.y=f.y+(I*v.y+k*g.y),h.z=f.z+(I*v.z+k*g.z),c.push(h.x,h.y,h.z),d.subVectors(h,f).normalize(),l.push(d.x,d.y,d.z),u.push(S/i),u.push(M/r)}}for(let S=1;S<=i;S++)for(let x=1;x<=r;x++){const M=(r+1)*(S-1)+(x-1),R=(r+1)*S+(x-1),I=(r+1)*S+x,k=(r+1)*(S-1)+x;o.push(M,R,k),o.push(R,I,k)}this.setIndex(o),this.setAttribute("position",new qn(c,3)),this.setAttribute("normal",new qn(l,3)),this.setAttribute("uv",new qn(u,2));function b(S,x,M,R,I){const k=Math.cos(S),P=Math.sin(S),U=M/x*S,V=Math.cos(U);I.x=R*(2+V)*.5*k,I.y=R*(2+V)*P*.5,I.z=R*Math.sin(U)*.5}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new TF(e.radius,e.tube,e.tubularSegments,e.radialSegments,e.p,e.q)}}class xF extends tr{constructor(e=new oW(new Oe(-1,-1,0),new Oe(-1,1,0),new Oe(1,1,0)),n=64,i=1,r=8,s=!1){super(),this.type="TubeGeometry",this.parameters={path:e,tubularSegments:n,radius:i,radialSegments:r,closed:s};const a=e.computeFrenetFrames(n,s);this.tangents=a.tangents,this.normals=a.normals,this.binormals=a.binormals;const o=new Oe,c=new Oe,l=new xt;let u=new Oe;const h=[],d=[],f=[],p=[];g(),this.setIndex(p),this.setAttribute("position",new qn(h,3)),this.setAttribute("normal",new qn(d,3)),this.setAttribute("uv",new qn(f,2));function g(){for(let S=0;S<n;S++)_(S);_(s===!1?n:0),b(),v()}function _(S){u=e.getPointAt(S/n,u);const x=a.normals[S],M=a.binormals[S];for(let R=0;R<=r;R++){const I=R/r*Math.PI*2,k=Math.sin(I),P=-Math.cos(I);c.x=P*x.x+k*M.x,c.y=P*x.y+k*M.y,c.z=P*x.z+k*M.z,c.normalize(),d.push(c.x,c.y,c.z),o.x=u.x+i*c.x,o.y=u.y+i*c.y,o.z=u.z+i*c.z,h.push(o.x,o.y,o.z)}}function v(){for(let S=1;S<=n;S++)for(let x=1;x<=r;x++){const M=(r+1)*(S-1)+(x-1),R=(r+1)*S+(x-1),I=(r+1)*S+x,k=(r+1)*(S-1)+x;p.push(M,R,k),p.push(R,I,k)}}function b(){for(let S=0;S<=n;S++)for(let x=0;x<=r;x++)l.x=S/n,l.y=x/r,f.push(l.x,l.y)}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){const e=super.toJSON();return e.path=this.parameters.path.toJSON(),e}static fromJSON(e){return new xF(new OU[e.path.type]().fromJSON(e.path),e.tubularSegments,e.radius,e.radialSegments,e.closed)}}class gue extends tr{constructor(e=null){if(super(),this.type="WireframeGeometry",this.parameters={geometry:e},e!==null){const n=[],i=new Set,r=new Oe,s=new Oe;if(e.index!==null){const a=e.attributes.position,o=e.index;let c=e.groups;c.length===0&&(c=[{start:0,count:o.count,materialIndex:0}]);for(let l=0,u=c.length;l<u;++l){const h=c[l],d=h.start,f=h.count;for(let p=d,g=d+f;p<g;p+=3)for(let _=0;_<3;_++){const v=o.getX(p+_),b=o.getX(p+(_+1)%3);r.fromBufferAttribute(a,v),s.fromBufferAttribute(a,b),zJ(r,s,i)===!0&&(n.push(r.x,r.y,r.z),n.push(s.x,s.y,s.z))}}}else{const a=e.attributes.position;for(let o=0,c=a.count/3;o<c;o++)for(let l=0;l<3;l++){const u=3*o+l,h=3*o+(l+1)%3;r.fromBufferAttribute(a,u),s.fromBufferAttribute(a,h),zJ(r,s,i)===!0&&(n.push(r.x,r.y,r.z),n.push(s.x,s.y,s.z))}}this.setAttribute("position",new qn(n,3))}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}}function zJ(t,e,n){const i=`${t.x},${t.y},${t.z}-${e.x},${e.y},${e.z}`,r=`${e.x},${e.y},${e.z}-${t.x},${t.y},${t.z}`;return n.has(i)===!0||n.has(r)===!0?!1:(n.add(i),n.add(r),!0)}var jJ=Object.freeze({__proto__:null,BoxGeometry:P1,CapsuleGeometry:dF,CircleGeometry:fF,ConeGeometry:BI,CylinderGeometry:UI,DodecahedronGeometry:pF,EdgesGeometry:aue,ExtrudeGeometry:gF,IcosahedronGeometry:vF,LatheGeometry:_F,OctahedronGeometry:FI,PlaneGeometry:QA,PolyhedronGeometry:CE,RingGeometry:yF,ShapeGeometry:bF,SphereGeometry:zI,TetrahedronGeometry:EF,TorusGeometry:SF,TorusKnotGeometry:TF,TubeGeometry:xF,WireframeGeometry:gue});class vue extends rl{constructor(e){super(),this.isShadowMaterial=!0,this.type="ShadowMaterial",this.color=new bn(0),this.transparent=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.fog=e.fog,this}}class _ue extends qa{constructor(e){super(e),this.isRawShaderMaterial=!0,this.type="RawShaderMaterial"}}class lW extends rl{constructor(e){super(),this.isMeshStandardMaterial=!0,this.type="MeshStandardMaterial",this.defines={STANDARD:""},this.color=new bn(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new bn(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=xE,this.normalScale=new xt(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new dd,this.envMapIntensity=1,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.defines={STANDARD:""},this.color.copy(e.color),this.roughness=e.roughness,this.metalness=e.metalness,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.roughnessMap=e.roughnessMap,this.metalnessMap=e.metalnessMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.envMapIntensity=e.envMapIntensity,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class yue extends lW{constructor(e){super(),this.isMeshPhysicalMaterial=!0,this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.anisotropyRotation=0,this.anisotropyMap=null,this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new xt(1,1),this.clearcoatNormalMap=null,this.ior=1.5,Object.defineProperty(this,"reflectivity",{get:function(){return Ki(2.5*(this.ior-1)/(this.ior+1),0,1)},set:function(n){this.ior=(1+.4*n)/(1-.4*n)}}),this.iridescenceMap=null,this.iridescenceIOR=1.3,this.iridescenceThicknessRange=[100,400],this.iridescenceThicknessMap=null,this.sheenColor=new bn(0),this.sheenColorMap=null,this.sheenRoughness=1,this.sheenRoughnessMap=null,this.transmissionMap=null,this.thickness=0,this.thicknessMap=null,this.attenuationDistance=1/0,this.attenuationColor=new bn(1,1,1),this.specularIntensity=1,this.specularIntensityMap=null,this.specularColor=new bn(1,1,1),this.specularColorMap=null,this._anisotropy=0,this._clearcoat=0,this._dispersion=0,this._iridescence=0,this._sheen=0,this._transmission=0,this.setValues(e)}get anisotropy(){return this._anisotropy}set anisotropy(e){this._anisotropy>0!=e>0&&this.version++,this._anisotropy=e}get clearcoat(){return this._clearcoat}set clearcoat(e){this._clearcoat>0!=e>0&&this.version++,this._clearcoat=e}get iridescence(){return this._iridescence}set iridescence(e){this._iridescence>0!=e>0&&this.version++,this._iridescence=e}get dispersion(){return this._dispersion}set dispersion(e){this._dispersion>0!=e>0&&this.version++,this._dispersion=e}get sheen(){return this._sheen}set sheen(e){this._sheen>0!=e>0&&this.version++,this._sheen=e}get transmission(){return this._transmission}set transmission(e){this._transmission>0!=e>0&&this.version++,this._transmission=e}copy(e){return super.copy(e),this.defines={STANDARD:"",PHYSICAL:""},this.anisotropy=e.anisotropy,this.anisotropyRotation=e.anisotropyRotation,this.anisotropyMap=e.anisotropyMap,this.clearcoat=e.clearcoat,this.clearcoatMap=e.clearcoatMap,this.clearcoatRoughness=e.clearcoatRoughness,this.clearcoatRoughnessMap=e.clearcoatRoughnessMap,this.clearcoatNormalMap=e.clearcoatNormalMap,this.clearcoatNormalScale.copy(e.clearcoatNormalScale),this.dispersion=e.dispersion,this.ior=e.ior,this.iridescence=e.iridescence,this.iridescenceMap=e.iridescenceMap,this.iridescenceIOR=e.iridescenceIOR,this.iridescenceThicknessRange=[...e.iridescenceThicknessRange],this.iridescenceThicknessMap=e.iridescenceThicknessMap,this.sheen=e.sheen,this.sheenColor.copy(e.sheenColor),this.sheenColorMap=e.sheenColorMap,this.sheenRoughness=e.sheenRoughness,this.sheenRoughnessMap=e.sheenRoughnessMap,this.transmission=e.transmission,this.transmissionMap=e.transmissionMap,this.thickness=e.thickness,this.thicknessMap=e.thicknessMap,this.attenuationDistance=e.attenuationDistance,this.attenuationColor.copy(e.attenuationColor),this.specularIntensity=e.specularIntensity,this.specularIntensityMap=e.specularIntensityMap,this.specularColor.copy(e.specularColor),this.specularColorMap=e.specularColorMap,this}}class bue extends rl{constructor(e){super(),this.isMeshPhongMaterial=!0,this.type="MeshPhongMaterial",this.color=new bn(16777215),this.specular=new bn(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new bn(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=xE,this.normalScale=new xt(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new dd,this.combine=NI,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.specular.copy(e.specular),this.shininess=e.shininess,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class Eue extends rl{constructor(e){super(),this.isMeshToonMaterial=!0,this.defines={TOON:""},this.type="MeshToonMaterial",this.color=new bn(16777215),this.map=null,this.gradientMap=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new bn(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=xE,this.normalScale=new xt(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.gradientMap=e.gradientMap,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}class uW extends rl{constructor(e){super(),this.isMeshNormalMaterial=!0,this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=xE,this.normalScale=new xt(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.flatShading=!1,this.setValues(e)}copy(e){return super.copy(e),this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.flatShading=e.flatShading,this}}class Sue extends rl{constructor(e){super(),this.isMeshLambertMaterial=!0,this.type="MeshLambertMaterial",this.color=new bn(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new bn(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=xE,this.normalScale=new xt(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new dd,this.combine=NI,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class hW extends rl{constructor(e){super(),this.isMeshDepthMaterial=!0,this.type="MeshDepthMaterial",this.depthPacking=TE,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.setValues(e)}copy(e){return super.copy(e),this.depthPacking=e.depthPacking,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this}}class dW extends rl{constructor(e){super(),this.isMeshDistanceMaterial=!0,this.type="MeshDistanceMaterial",this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.setValues(e)}copy(e){return super.copy(e),this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this}}class Tue extends rl{constructor(e){super(),this.isMeshMatcapMaterial=!0,this.defines={MATCAP:""},this.type="MeshMatcapMaterial",this.color=new bn(16777215),this.matcap=null,this.map=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=xE,this.normalScale=new xt(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.defines={MATCAP:""},this.color.copy(e.color),this.matcap=e.matcap,this.map=e.map,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.flatShading=e.flatShading,this.fog=e.fog,this}}class xue extends yh{constructor(e){super(),this.isLineDashedMaterial=!0,this.type="LineDashedMaterial",this.scale=1,this.dashSize=3,this.gapSize=1,this.setValues(e)}copy(e){return super.copy(e),this.scale=e.scale,this.dashSize=e.dashSize,this.gapSize=e.gapSize,this}}function yT(t,e){return!t||t.constructor===e?t:typeof e.BYTES_PER_ELEMENT=="number"?new e(t):Array.prototype.slice.call(t)}function wue(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)}function Cue(t){function e(r,s){return t[r]-t[s]}const n=t.length,i=new Array(n);for(let r=0;r!==n;++r)i[r]=r;return i.sort(e),i}function iG(t,e,n){const i=t.length,r=new t.constructor(i);for(let s=0,a=0;a!==i;++s){const o=n[s]*e;for(let c=0;c!==e;++c)r[a++]=t[o+c]}return r}function fW(t,e,n,i){let r=1,s=t[0];for(;s!==void 0&&s[i]===void 0;)s=t[r++];if(s===void 0)return;let a=s[i];if(a!==void 0)if(Array.isArray(a))do a=s[i],a!==void 0&&(e.push(s.time),n.push(...a)),s=t[r++];while(s!==void 0);else if(a.toArray!==void 0)do a=s[i],a!==void 0&&(e.push(s.time),a.toArray(n,n.length)),s=t[r++];while(s!==void 0);else do a=s[i],a!==void 0&&(e.push(s.time),n.push(a)),s=t[r++];while(s!==void 0)}function RRe(t,e,n,i,r=30){const s=t.clone();s.name=e;const a=[];for(let c=0;c<s.tracks.length;++c){const l=s.tracks[c],u=l.getValueSize(),h=[],d=[];for(let f=0;f<l.times.length;++f){const p=l.times[f]*r;if(!(p<n||p>=i)){h.push(l.times[f]);for(let g=0;g<u;++g)d.push(l.values[f*u+g])}}h.length!==0&&(l.times=yT(h,l.times.constructor),l.values=yT(d,l.values.constructor),a.push(l))}s.tracks=a;let o=1/0;for(let c=0;c<s.tracks.length;++c)o>s.tracks[c].times[0]&&(o=s.tracks[c].times[0]);for(let c=0;c<s.tracks.length;++c)s.tracks[c].shift(-1*o);return s.resetDuration(),s}function MRe(t,e=0,n=t,i=30){i<=0&&(i=30);const r=n.tracks.length,s=e/i;for(let a=0;a<r;++a){const o=n.tracks[a],c=o.ValueTypeName;if(c==="bool"||c==="string")continue;const l=t.tracks.find(function(v){return v.name===o.name&&v.ValueTypeName===c});if(l===void 0)continue;let u=0;const h=o.getValueSize();o.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(u=h/3);let d=0;const f=l.getValueSize();l.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(d=f/3);const p=o.times.length-1;let g;if(s<=o.times[0]){const v=u,b=h-u;g=o.values.slice(v,b)}else if(s>=o.times[p]){const v=p*h+u,b=v+h-u;g=o.values.slice(v,b)}else{const v=o.createInterpolant(),b=u,S=h-u;v.evaluate(s),g=v.resultBuffer.slice(b,S)}c==="quaternion"&&new mh().fromArray(g).normalize().conjugate().toArray(g);const _=l.times.length;for(let v=0;v<_;++v){const b=v*f+d;if(c==="quaternion")mh.multiplyQuaternionsFlat(l.values,b,g,0,l.values,b);else{const S=f-d*2;for(let x=0;x<S;++x)l.values[b+x]-=g[x]}}}return t.blendMode=K7,t}class ORe{static convertArray(e,n){return yT(e,n)}static isTypedArray(e){return wue(e)}static getKeyframeOrder(e){return Cue(e)}static sortedArray(e,n,i){return iG(e,n,i)}static flattenJSON(e,n,i,r){fW(e,n,i,r)}static subclip(e,n,i,r,s=30){return RRe(e,n,i,r,s)}static makeClipAdditive(e,n=0,i=e,r=30){return MRe(e,n,i,r)}}class jI{constructor(e,n,i,r){this.parameterPositions=e,this._cachedIndex=0,this.resultBuffer=r!==void 0?r:new n.constructor(i),this.sampleValues=n,this.valueSize=i,this.settings=null,this.DefaultSettings_={}}evaluate(e){const n=this.parameterPositions;let i=this._cachedIndex,r=n[i],s=n[i-1];e:{t:{let a;n:{i:if(!(e<r)){for(let o=i+2;;){if(r===void 0){if(e<s)break i;return i=n.length,this._cachedIndex=i,this.copySampleValue_(i-1)}if(i===o)break;if(s=r,r=n[++i],e<r)break t}a=n.length;break n}if(!(e>=s)){const o=n[1];e<o&&(i=2,s=o);for(let c=i-2;;){if(s===void 0)return this._cachedIndex=0,this.copySampleValue_(0);if(i===c)break;if(r=s,s=n[--i-1],e>=s)break t}a=i,i=0;break n}break e}for(;i<a;){const o=i+a>>>1;e<n[o]?a=o:i=o+1}if(r=n[i],s=n[i-1],s===void 0)return this._cachedIndex=0,this.copySampleValue_(0);if(r===void 0)return i=n.length,this._cachedIndex=i,this.copySampleValue_(i-1)}this._cachedIndex=i,this.intervalChanged_(i,s,r)}return this.interpolate_(i,s,e,r)}getSettings_(){return this.settings||this.DefaultSettings_}copySampleValue_(e){const n=this.resultBuffer,i=this.sampleValues,r=this.valueSize,s=e*r;for(let a=0;a!==r;++a)n[a]=i[s+a];return n}interpolate_(){throw new Error("call to abstract method")}intervalChanged_(){}}class Aue extends jI{constructor(e,n,i,r){super(e,n,i,r),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0,this.DefaultSettings_={endingStart:gT,endingEnd:gT}}intervalChanged_(e,n,i){const r=this.parameterPositions;let s=e-2,a=e+1,o=r[s],c=r[a];if(o===void 0)switch(this.getSettings_().endingStart){case vT:s=e,o=2*n-i;break;case WO:s=r.length-2,o=n+r[s]-r[s+1];break;default:s=e,o=i}if(c===void 0)switch(this.getSettings_().endingEnd){case vT:a=e,c=2*i-n;break;case WO:a=1,c=i+r[1]-r[0];break;default:a=e-1,c=n}const l=(i-n)*.5,u=this.valueSize;this._weightPrev=l/(n-o),this._weightNext=l/(c-i),this._offsetPrev=s*u,this._offsetNext=a*u}interpolate_(e,n,i,r){const s=this.resultBuffer,a=this.sampleValues,o=this.valueSize,c=e*o,l=c-o,u=this._offsetPrev,h=this._offsetNext,d=this._weightPrev,f=this._weightNext,p=(i-n)/(r-n),g=p*p,_=g*p,v=-d*_+2*d*g-d*p,b=(1+d)*_+(-1.5-2*d)*g+(-.5+d)*p+1,S=(-1-f)*_+(1.5+f)*g+.5*p,x=f*_-f*g;for(let M=0;M!==o;++M)s[M]=v*a[u+M]+b*a[l+M]+S*a[c+M]+x*a[h+M];return s}}class pW extends jI{constructor(e,n,i,r){super(e,n,i,r)}interpolate_(e,n,i,r){const s=this.resultBuffer,a=this.sampleValues,o=this.valueSize,c=e*o,l=c-o,u=(i-n)/(r-n),h=1-u;for(let d=0;d!==o;++d)s[d]=a[l+d]*h+a[c+d]*u;return s}}class Rue extends jI{constructor(e,n,i,r){super(e,n,i,r)}interpolate_(e){return this.copySampleValue_(e-1)}}class Np{constructor(e,n,i,r){if(e===void 0)throw new Error("THREE.KeyframeTrack: track name is undefined");if(n===void 0||n.length===0)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+e);this.name=e,this.times=yT(n,this.TimeBufferType),this.values=yT(i,this.ValueBufferType),this.setInterpolation(r||this.DefaultInterpolation)}static toJSON(e){const n=e.constructor;let i;if(n.toJSON!==this.toJSON)i=n.toJSON(e);else{i={name:e.name,times:yT(e.times,Array),values:yT(e.values,Array)};const r=e.getInterpolation();r!==e.DefaultInterpolation&&(i.interpolation=r)}return i.type=e.ValueTypeName,i}InterpolantFactoryMethodDiscrete(e){return new Rue(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodLinear(e){return new pW(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodSmooth(e){return new Aue(this.times,this.values,this.getValueSize(),e)}setInterpolation(e){let n;switch(e){case $O:n=this.InterpolantFactoryMethodDiscrete;break;case AU:n=this.InterpolantFactoryMethodLinear;break;case k2:n=this.InterpolantFactoryMethodSmooth;break}if(n===void 0){const i="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(this.createInterpolant===void 0)if(e!==this.DefaultInterpolation)this.setInterpolation(this.DefaultInterpolation);else throw new Error(i);return console.warn("THREE.KeyframeTrack:",i),this}return this.createInterpolant=n,this}getInterpolation(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return $O;case this.InterpolantFactoryMethodLinear:return AU;case this.InterpolantFactoryMethodSmooth:return k2}}getValueSize(){return this.values.length/this.times.length}shift(e){if(e!==0){const n=this.times;for(let i=0,r=n.length;i!==r;++i)n[i]+=e}return this}scale(e){if(e!==1){const n=this.times;for(let i=0,r=n.length;i!==r;++i)n[i]*=e}return this}trim(e,n){const i=this.times,r=i.length;let s=0,a=r-1;for(;s!==r&&i[s]<e;)++s;for(;a!==-1&&i[a]>n;)--a;if(++a,s!==0||a!==r){s>=a&&(a=Math.max(a,1),s=a-1);const o=this.getValueSize();this.times=i.slice(s,a),this.values=this.values.slice(s*o,a*o)}return this}validate(){let e=!0;const n=this.getValueSize();n-Math.floor(n)!==0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),e=!1);const i=this.times,r=this.values,s=i.length;s===0&&(console.error("THREE.KeyframeTrack: Track is empty.",this),e=!1);let a=null;for(let o=0;o!==s;o++){const c=i[o];if(typeof c=="number"&&isNaN(c)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,o,c),e=!1;break}if(a!==null&&a>c){console.error("THREE.KeyframeTrack: Out of order keys.",this,o,c,a),e=!1;break}a=c}if(r!==void 0&&wue(r))for(let o=0,c=r.length;o!==c;++o){const l=r[o];if(isNaN(l)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,o,l),e=!1;break}}return e}optimize(){const e=this.times.slice(),n=this.values.slice(),i=this.getValueSize(),r=this.getInterpolation()===k2,s=e.length-1;let a=1;for(let o=1;o<s;++o){let c=!1;const l=e[o],u=e[o+1];if(l!==u&&(o!==1||l!==e[0]))if(r)c=!0;else{const h=o*i,d=h-i,f=h+i;for(let p=0;p!==i;++p){const g=n[h+p];if(g!==n[d+p]||g!==n[f+p]){c=!0;break}}}if(c){if(o!==a){e[a]=e[o];const h=o*i,d=a*i;for(let f=0;f!==i;++f)n[d+f]=n[h+f]}++a}}if(s>0){e[a]=e[s];for(let o=s*i,c=a*i,l=0;l!==i;++l)n[c+l]=n[o+l];++a}return a!==e.length?(this.times=e.slice(0,a),this.values=n.slice(0,a*i)):(this.times=e,this.values=n),this}clone(){const e=this.times.slice(),n=this.values.slice(),i=this.constructor,r=new i(this.name,e,n);return r.createInterpolant=this.createInterpolant,r}}Np.prototype.ValueTypeName="";Np.prototype.TimeBufferType=Float32Array;Np.prototype.ValueBufferType=Float32Array;Np.prototype.DefaultInterpolation=AU;class D1 extends Np{constructor(e,n,i){super(e,n,i)}}D1.prototype.ValueTypeName="bool";D1.prototype.ValueBufferType=Array;D1.prototype.DefaultInterpolation=$O;D1.prototype.InterpolantFactoryMethodLinear=void 0;D1.prototype.InterpolantFactoryMethodSmooth=void 0;class mW extends Np{constructor(e,n,i,r){super(e,n,i,r)}}mW.prototype.ValueTypeName="color";class tN extends Np{constructor(e,n,i,r){super(e,n,i,r)}}tN.prototype.ValueTypeName="number";class Mue extends jI{constructor(e,n,i,r){super(e,n,i,r)}interpolate_(e,n,i,r){const s=this.resultBuffer,a=this.sampleValues,o=this.valueSize,c=(i-n)/(r-n);let l=e*o;for(let u=l+o;l!==u;l+=4)mh.slerpFlat(s,0,a,l-o,a,l,c);return s}}class HI extends Np{constructor(e,n,i,r){super(e,n,i,r)}InterpolantFactoryMethodLinear(e){return new Mue(this.times,this.values,this.getValueSize(),e)}}HI.prototype.ValueTypeName="quaternion";HI.prototype.InterpolantFactoryMethodSmooth=void 0;class L1 extends Np{constructor(e,n,i){super(e,n,i)}}L1.prototype.ValueTypeName="string";L1.prototype.ValueBufferType=Array;L1.prototype.DefaultInterpolation=$O;L1.prototype.InterpolantFactoryMethodLinear=void 0;L1.prototype.InterpolantFactoryMethodSmooth=void 0;class nN extends Np{constructor(e,n,i,r){super(e,n,i,r)}}nN.prototype.ValueTypeName="vector";class iN{constructor(e="",n=-1,i=[],r=iF){this.name=e,this.tracks=i,this.duration=n,this.blendMode=r,this.uuid=cf(),this.duration<0&&this.resetDuration()}static parse(e){const n=[],i=e.tracks,r=1/(e.fps||1);for(let a=0,o=i.length;a!==o;++a)n.push(IRe(i[a]).scale(r));const s=new this(e.name,e.duration,n,e.blendMode);return s.uuid=e.uuid,s}static toJSON(e){const n=[],i=e.tracks,r={name:e.name,duration:e.duration,tracks:n,uuid:e.uuid,blendMode:e.blendMode};for(let s=0,a=i.length;s!==a;++s)n.push(Np.toJSON(i[s]));return r}static CreateFromMorphTargetSequence(e,n,i,r){const s=n.length,a=[];for(let o=0;o<s;o++){let c=[],l=[];c.push((o+s-1)%s,o,(o+1)%s),l.push(0,1,0);const u=Cue(c);c=iG(c,1,u),l=iG(l,1,u),!r&&c[0]===0&&(c.push(s),l.push(l[0])),a.push(new tN(".morphTargetInfluences["+n[o].name+"]",c,l).scale(1/i))}return new this(e,-1,a)}static findByName(e,n){let i=e;if(!Array.isArray(e)){const r=e;i=r.geometry&&r.geometry.animations||r.animations}for(let r=0;r<i.length;r++)if(i[r].name===n)return i[r];return null}static CreateClipsFromMorphTargetSequences(e,n,i){const r={},s=/^([\w-]*?)([\d]+)$/;for(let o=0,c=e.length;o<c;o++){const l=e[o],u=l.name.match(s);if(u&&u.length>1){const h=u[1];let d=r[h];d||(r[h]=d=[]),d.push(l)}}const a=[];for(const o in r)a.push(this.CreateFromMorphTargetSequence(o,r[o],n,i));return a}static parseAnimation(e,n){if(console.warn("THREE.AnimationClip: parseAnimation() is deprecated and will be removed with r185"),!e)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;const i=function(h,d,f,p,g){if(f.length!==0){const _=[],v=[];fW(f,_,v,p),_.length!==0&&g.push(new h(d,_,v))}},r=[],s=e.name||"default",a=e.fps||30,o=e.blendMode;let c=e.length||-1;const l=e.hierarchy||[];for(let h=0;h<l.length;h++){const d=l[h].keys;if(!(!d||d.length===0))if(d[0].morphTargets){const f={};let p;for(p=0;p<d.length;p++)if(d[p].morphTargets)for(let g=0;g<d[p].morphTargets.length;g++)f[d[p].morphTargets[g]]=-1;for(const g in f){const _=[],v=[];for(let b=0;b!==d[p].morphTargets.length;++b){const S=d[p];_.push(S.time),v.push(S.morphTarget===g?1:0)}r.push(new tN(".morphTargetInfluence["+g+"]",_,v))}c=f.length*a}else{const f=".bones["+n[h].name+"]";i(nN,f+".position",d,"pos",r),i(HI,f+".quaternion",d,"rot",r),i(nN,f+".scale",d,"scl",r)}}return r.length===0?null:new this(s,c,r,o)}resetDuration(){const e=this.tracks;let n=0;for(let i=0,r=e.length;i!==r;++i){const s=this.tracks[i];n=Math.max(n,s.times[s.times.length-1])}return this.duration=n,this}trim(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].trim(0,this.duration);return this}validate(){let e=!0;for(let n=0;n<this.tracks.length;n++)e=e&&this.tracks[n].validate();return e}optimize(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].optimize();return this}clone(){const e=[];for(let n=0;n<this.tracks.length;n++)e.push(this.tracks[n].clone());return new this.constructor(this.name,this.duration,e,this.blendMode)}toJSON(){return this.constructor.toJSON(this)}}function NRe(t){switch(t.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return tN;case"vector":case"vector2":case"vector3":case"vector4":return nN;case"color":return mW;case"quaternion":return HI;case"bool":case"boolean":return D1;case"string":return L1}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+t)}function IRe(t){if(t.type===void 0)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");const e=NRe(t.type);if(t.times===void 0){const n=[],i=[];fW(t.keys,n,i,"value"),t.times=n,t.values=i}return e.parse!==void 0?e.parse(t):new e(t.name,t.times,t.values,t.interpolation)}const t_={enabled:!1,files:{},add:function(t,e){this.enabled!==!1&&(this.files[t]=e)},get:function(t){if(this.enabled!==!1)return this.files[t]},remove:function(t){delete this.files[t]},clear:function(){this.files={}}};class gW{constructor(e,n,i){const r=this;let s=!1,a=0,o=0,c;const l=[];this.onStart=void 0,this.onLoad=e,this.onProgress=n,this.onError=i,this.itemStart=function(u){o++,s===!1&&r.onStart!==void 0&&r.onStart(u,a,o),s=!0},this.itemEnd=function(u){a++,r.onProgress!==void 0&&r.onProgress(u,a,o),a===o&&(s=!1,r.onLoad!==void 0&&r.onLoad())},this.itemError=function(u){r.onError!==void 0&&r.onError(u)},this.resolveURL=function(u){return c?c(u):u},this.setURLModifier=function(u){return c=u,this},this.addHandler=function(u,h){return l.push(u,h),this},this.removeHandler=function(u){const h=l.indexOf(u);return h!==-1&&l.splice(h,2),this},this.getHandler=function(u){for(let h=0,d=l.length;h<d;h+=2){const f=l[h],p=l[h+1];if(f.global&&(f.lastIndex=0),f.test(u))return p}return null}}}const Oue=new gW;class Ed{constructor(e){this.manager=e!==void 0?e:Oue,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}load(){}loadAsync(e,n){const i=this;return new Promise(function(r,s){i.load(e,r,n,s)})}parse(){}setCrossOrigin(e){return this.crossOrigin=e,this}setWithCredentials(e){return this.withCredentials=e,this}setPath(e){return this.path=e,this}setResourcePath(e){return this.resourcePath=e,this}setRequestHeader(e){return this.requestHeader=e,this}}Ed.DEFAULT_MATERIAL_NAME="__DEFAULT";const Mv={};class kRe extends Error{constructor(e,n){super(e),this.response=n}}class x_ extends Ed{constructor(e){super(e),this.mimeType="",this.responseType=""}load(e,n,i,r){e===void 0&&(e=""),this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);const s=t_.get(e);if(s!==void 0)return this.manager.itemStart(e),setTimeout(()=>{n&&n(s),this.manager.itemEnd(e)},0),s;if(Mv[e]!==void 0){Mv[e].push({onLoad:n,onProgress:i,onError:r});return}Mv[e]=[],Mv[e].push({onLoad:n,onProgress:i,onError:r});const a=new Request(e,{headers:new Headers(this.requestHeader),credentials:this.withCredentials?"include":"same-origin"}),o=this.mimeType,c=this.responseType;fetch(a).then(l=>{if(l.status===200||l.status===0){if(l.status===0&&console.warn("THREE.FileLoader: HTTP Status 0 received."),typeof ReadableStream>"u"||l.body===void 0||l.body.getReader===void 0)return l;const u=Mv[e],h=l.body.getReader(),d=l.headers.get("X-File-Size")||l.headers.get("Content-Length"),f=d?parseInt(d):0,p=f!==0;let g=0;const _=new ReadableStream({start(v){b();function b(){h.read().then(({done:S,value:x})=>{if(S)v.close();else{g+=x.byteLength;const M=new ProgressEvent("progress",{lengthComputable:p,loaded:g,total:f});for(let R=0,I=u.length;R<I;R++){const k=u[R];k.onProgress&&k.onProgress(M)}v.enqueue(x),b()}},S=>{v.error(S)})}}});return new Response(_)}else throw new kRe(`fetch for "${l.url}" responded with ${l.status}: ${l.statusText}`,l)}).then(l=>{switch(c){case"arraybuffer":return l.arrayBuffer();case"blob":return l.blob();case"document":return l.text().then(u=>new DOMParser().parseFromString(u,o));case"json":return l.json();default:if(o==="")return l.text();{const h=/charset="?([^;"\s]*)"?/i.exec(o),d=h&&h[1]?h[1].toLowerCase():void 0,f=new TextDecoder(d);return l.arrayBuffer().then(p=>f.decode(p))}}}).then(l=>{t_.add(e,l);const u=Mv[e];delete Mv[e];for(let h=0,d=u.length;h<d;h++){const f=u[h];f.onLoad&&f.onLoad(l)}}).catch(l=>{const u=Mv[e];if(u===void 0)throw this.manager.itemError(e),l;delete Mv[e];for(let h=0,d=u.length;h<d;h++){const f=u[h];f.onError&&f.onError(l)}this.manager.itemError(e)}).finally(()=>{this.manager.itemEnd(e)}),this.manager.itemStart(e)}setResponseType(e){return this.responseType=e,this}setMimeType(e){return this.mimeType=e,this}}class PRe extends Ed{constructor(e){super(e)}load(e,n,i,r){const s=this,a=new x_(this.manager);a.setPath(this.path),a.setRequestHeader(this.requestHeader),a.setWithCredentials(this.withCredentials),a.load(e,function(o){try{n(s.parse(JSON.parse(o)))}catch(c){r?r(c):console.error(c),s.manager.itemError(e)}},i,r)}parse(e){const n=[];for(let i=0;i<e.length;i++){const r=iN.parse(e[i]);n.push(r)}return n}}class DRe extends Ed{constructor(e){super(e)}load(e,n,i,r){const s=this,a=[],o=new hF,c=new x_(this.manager);c.setPath(this.path),c.setResponseType("arraybuffer"),c.setRequestHeader(this.requestHeader),c.setWithCredentials(s.withCredentials);let l=0;function u(h){c.load(e[h],function(d){const f=s.parse(d,!0);a[h]={width:f.width,height:f.height,format:f.format,mipmaps:f.mipmaps},l+=1,l===6&&(f.mipmapCount===1&&(o.minFilter=Ca),o.image=a,o.format=f.format,o.needsUpdate=!0,n&&n(o))},i,r)}if(Array.isArray(e))for(let h=0,d=e.length;h<d;++h)u(h);else c.load(e,function(h){const d=s.parse(h,!0);if(d.isCubemap){const f=d.mipmaps.length/d.mipmapCount;for(let p=0;p<f;p++){a[p]={mipmaps:[]};for(let g=0;g<d.mipmapCount;g++)a[p].mipmaps.push(d.mipmaps[p*d.mipmapCount+g]),a[p].format=d.format,a[p].width=d.width,a[p].height=d.height}o.image=a}else o.image.width=d.width,o.image.height=d.height,o.mipmaps=d.mipmaps;d.mipmapCount===1&&(o.minFilter=Ca),o.format=d.format,o.needsUpdate=!0,n&&n(o)},i,r);return o}}class rN extends Ed{constructor(e){super(e)}load(e,n,i,r){this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);const s=this,a=t_.get(e);if(a!==void 0)return s.manager.itemStart(e),setTimeout(function(){n&&n(a),s.manager.itemEnd(e)},0),a;const o=ZO("img");function c(){u(),t_.add(e,this),n&&n(this),s.manager.itemEnd(e)}function l(h){u(),r&&r(h),s.manager.itemError(e),s.manager.itemEnd(e)}function u(){o.removeEventListener("load",c,!1),o.removeEventListener("error",l,!1)}return o.addEventListener("load",c,!1),o.addEventListener("error",l,!1),e.slice(0,5)!=="data:"&&this.crossOrigin!==void 0&&(o.crossOrigin=this.crossOrigin),s.manager.itemStart(e),o.src=e,o}}class LRe extends Ed{constructor(e){super(e)}load(e,n,i,r){const s=new LI;s.colorSpace=ls;const a=new rN(this.manager);a.setCrossOrigin(this.crossOrigin),a.setPath(this.path);let o=0;function c(l){a.load(e[l],function(u){s.images[l]=u,o++,o===6&&(s.needsUpdate=!0,n&&n(s))},void 0,r)}for(let l=0;l<e.length;++l)c(l);return s}}class URe extends Ed{constructor(e){super(e)}load(e,n,i,r){const s=this,a=new lf,o=new x_(this.manager);return o.setResponseType("arraybuffer"),o.setRequestHeader(this.requestHeader),o.setPath(this.path),o.setWithCredentials(s.withCredentials),o.load(e,function(c){let l;try{l=s.parse(c)}catch(u){if(r!==void 0)r(u);else{console.error(u);return}}l.image!==void 0?a.image=l.image:l.data!==void 0&&(a.image.width=l.width,a.image.height=l.height,a.image.data=l.data),a.wrapS=l.wrapS!==void 0?l.wrapS:cp,a.wrapT=l.wrapT!==void 0?l.wrapT:cp,a.magFilter=l.magFilter!==void 0?l.magFilter:Ca,a.minFilter=l.minFilter!==void 0?l.minFilter:Ca,a.anisotropy=l.anisotropy!==void 0?l.anisotropy:1,l.colorSpace!==void 0&&(a.colorSpace=l.colorSpace),l.flipY!==void 0&&(a.flipY=l.flipY),l.format!==void 0&&(a.format=l.format),l.type!==void 0&&(a.type=l.type),l.mipmaps!==void 0&&(a.mipmaps=l.mipmaps,a.minFilter=Hg),l.mipmapCount===1&&(a.minFilter=Ca),l.generateMipmaps!==void 0&&(a.generateMipmaps=l.generateMipmaps),a.needsUpdate=!0,n&&n(a,l)},i,r),a}}class BRe extends Ed{constructor(e){super(e)}load(e,n,i,r){const s=new Ga,a=new rN(this.manager);return a.setCrossOrigin(this.crossOrigin),a.setPath(this.path),a.load(e,function(o){s.image=o,s.needsUpdate=!0,n!==void 0&&n(s)},i,r),s}}class AE extends Wr{constructor(e,n=1){super(),this.isLight=!0,this.type="Light",this.color=new bn(e),this.intensity=n}dispose(){}copy(e,n){return super.copy(e,n),this.color.copy(e.color),this.intensity=e.intensity,this}toJSON(e){const n=super.toJSON(e);return n.object.color=this.color.getHex(),n.object.intensity=this.intensity,this.groundColor!==void 0&&(n.object.groundColor=this.groundColor.getHex()),this.distance!==void 0&&(n.object.distance=this.distance),this.angle!==void 0&&(n.object.angle=this.angle),this.decay!==void 0&&(n.object.decay=this.decay),this.penumbra!==void 0&&(n.object.penumbra=this.penumbra),this.shadow!==void 0&&(n.object.shadow=this.shadow.toJSON()),this.target!==void 0&&(n.object.target=this.target.uuid),n}}class Nue extends AE{constructor(e,n,i){super(e,i),this.isHemisphereLight=!0,this.type="HemisphereLight",this.position.copy(Wr.DEFAULT_UP),this.updateMatrix(),this.groundColor=new bn(n)}copy(e,n){return super.copy(e,n),this.groundColor.copy(e.groundColor),this}}const V5=new gi,HJ=new Oe,VJ=new Oe;class vW{constructor(e){this.camera=e,this.intensity=1,this.bias=0,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new xt(512,512),this.mapType=lo,this.map=null,this.mapPass=null,this.matrix=new gi,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new ZA,this._frameExtents=new xt(1,1),this._viewportCount=1,this._viewports=[new zr(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(e){const n=this.camera,i=this.matrix;HJ.setFromMatrixPosition(e.matrixWorld),n.position.copy(HJ),VJ.setFromMatrixPosition(e.target.matrixWorld),n.lookAt(VJ),n.updateMatrixWorld(),V5.multiplyMatrices(n.projectionMatrix,n.matrixWorldInverse),this._frustum.setFromProjectionMatrix(V5),i.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),i.multiply(V5)}getViewport(e){return this._viewports[e]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(e){return this.camera=e.camera.clone(),this.intensity=e.intensity,this.bias=e.bias,this.radius=e.radius,this.autoUpdate=e.autoUpdate,this.needsUpdate=e.needsUpdate,this.normalBias=e.normalBias,this.blurSamples=e.blurSamples,this.mapSize.copy(e.mapSize),this}clone(){return new this.constructor().copy(this)}toJSON(){const e={};return this.intensity!==1&&(e.intensity=this.intensity),this.bias!==0&&(e.bias=this.bias),this.normalBias!==0&&(e.normalBias=this.normalBias),this.radius!==1&&(e.radius=this.radius),(this.mapSize.x!==512||this.mapSize.y!==512)&&(e.mapSize=this.mapSize.toArray()),e.camera=this.camera.toJSON(!1).object,delete e.camera.matrix,e}}class FRe extends vW{constructor(){super(new Hc(50,1,.5,500)),this.isSpotLightShadow=!0,this.focus=1}updateMatrices(e){const n=this.camera,i=zC*2*e.angle*this.focus,r=this.mapSize.width/this.mapSize.height,s=e.distance||n.far;(i!==n.fov||r!==n.aspect||s!==n.far)&&(n.fov=i,n.aspect=r,n.far=s,n.updateProjectionMatrix()),super.updateMatrices(e)}copy(e){return super.copy(e),this.focus=e.focus,this}}class Iue extends AE{constructor(e,n,i=0,r=Math.PI/3,s=0,a=2){super(e,n),this.isSpotLight=!0,this.type="SpotLight",this.position.copy(Wr.DEFAULT_UP),this.updateMatrix(),this.target=new Wr,this.distance=i,this.angle=r,this.penumbra=s,this.decay=a,this.map=null,this.shadow=new FRe}get power(){return this.intensity*Math.PI}set power(e){this.intensity=e/Math.PI}dispose(){this.shadow.dispose()}copy(e,n){return super.copy(e,n),this.distance=e.distance,this.angle=e.angle,this.penumbra=e.penumbra,this.decay=e.decay,this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}const GJ=new gi,nM=new Oe,G5=new Oe;class zRe extends vW{constructor(){super(new Hc(90,1,.5,500)),this.isPointLightShadow=!0,this._frameExtents=new xt(4,2),this._viewportCount=6,this._viewports=[new zr(2,1,1,1),new zr(0,1,1,1),new zr(3,1,1,1),new zr(1,1,1,1),new zr(3,0,1,1),new zr(1,0,1,1)],this._cubeDirections=[new Oe(1,0,0),new Oe(-1,0,0),new Oe(0,0,1),new Oe(0,0,-1),new Oe(0,1,0),new Oe(0,-1,0)],this._cubeUps=[new Oe(0,1,0),new Oe(0,1,0),new Oe(0,1,0),new Oe(0,1,0),new Oe(0,0,1),new Oe(0,0,-1)]}updateMatrices(e,n=0){const i=this.camera,r=this.matrix,s=e.distance||i.far;s!==i.far&&(i.far=s,i.updateProjectionMatrix()),nM.setFromMatrixPosition(e.matrixWorld),i.position.copy(nM),G5.copy(i.position),G5.add(this._cubeDirections[n]),i.up.copy(this._cubeUps[n]),i.lookAt(G5),i.updateMatrixWorld(),r.makeTranslation(-nM.x,-nM.y,-nM.z),GJ.multiplyMatrices(i.projectionMatrix,i.matrixWorldInverse),this._frustum.setFromProjectionMatrix(GJ)}}class kue extends AE{constructor(e,n,i=0,r=2){super(e,n),this.isPointLight=!0,this.type="PointLight",this.distance=i,this.decay=r,this.shadow=new zRe}get power(){return this.intensity*4*Math.PI}set power(e){this.intensity=e/(4*Math.PI)}dispose(){this.shadow.dispose()}copy(e,n){return super.copy(e,n),this.distance=e.distance,this.decay=e.decay,this.shadow=e.shadow.clone(),this}}let VI=class extends DI{constructor(e=-1,n=1,i=1,r=-1,s=.1,a=2e3){super(),this.isOrthographicCamera=!0,this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=e,this.right=n,this.top=i,this.bottom=r,this.near=s,this.far=a,this.updateProjectionMatrix()}copy(e,n){return super.copy(e,n),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=e.view===null?null:Object.assign({},e.view),this}setViewOffset(e,n,i,r,s,a){this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=n,this.view.offsetX=i,this.view.offsetY=r,this.view.width=s,this.view.height=a,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=(this.right-this.left)/(2*this.zoom),n=(this.top-this.bottom)/(2*this.zoom),i=(this.right+this.left)/2,r=(this.top+this.bottom)/2;let s=i-e,a=i+e,o=r+n,c=r-n;if(this.view!==null&&this.view.enabled){const l=(this.right-this.left)/this.view.fullWidth/this.zoom,u=(this.top-this.bottom)/this.view.fullHeight/this.zoom;s+=l*this.view.offsetX,a=s+l*this.view.width,o-=u*this.view.offsetY,c=o-u*this.view.height}this.projectionMatrix.makeOrthographic(s,a,o,c,this.near,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const n=super.toJSON(e);return n.object.zoom=this.zoom,n.object.left=this.left,n.object.right=this.right,n.object.top=this.top,n.object.bottom=this.bottom,n.object.near=this.near,n.object.far=this.far,this.view!==null&&(n.object.view=Object.assign({},this.view)),n}};class jRe extends vW{constructor(){super(new VI(-5,5,5,-5,.5,500)),this.isDirectionalLightShadow=!0}}class Pue extends AE{constructor(e,n){super(e,n),this.isDirectionalLight=!0,this.type="DirectionalLight",this.position.copy(Wr.DEFAULT_UP),this.updateMatrix(),this.target=new Wr,this.shadow=new jRe}dispose(){this.shadow.dispose()}copy(e){return super.copy(e),this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}class Due extends AE{constructor(e,n){super(e,n),this.isAmbientLight=!0,this.type="AmbientLight"}}class Lue extends AE{constructor(e,n,i=10,r=10){super(e,n),this.isRectAreaLight=!0,this.type="RectAreaLight",this.width=i,this.height=r}get power(){return this.intensity*this.width*this.height*Math.PI}set power(e){this.intensity=e/(this.width*this.height*Math.PI)}copy(e){return super.copy(e),this.width=e.width,this.height=e.height,this}toJSON(e){const n=super.toJSON(e);return n.object.width=this.width,n.object.height=this.height,n}}class Uue{constructor(){this.isSphericalHarmonics3=!0,this.coefficients=[];for(let e=0;e<9;e++)this.coefficients.push(new Oe)}set(e){for(let n=0;n<9;n++)this.coefficients[n].copy(e[n]);return this}zero(){for(let e=0;e<9;e++)this.coefficients[e].set(0,0,0);return this}getAt(e,n){const i=e.x,r=e.y,s=e.z,a=this.coefficients;return n.copy(a[0]).multiplyScalar(.282095),n.addScaledVector(a[1],.488603*r),n.addScaledVector(a[2],.488603*s),n.addScaledVector(a[3],.488603*i),n.addScaledVector(a[4],1.092548*(i*r)),n.addScaledVector(a[5],1.092548*(r*s)),n.addScaledVector(a[6],.315392*(3*s*s-1)),n.addScaledVector(a[7],1.092548*(i*s)),n.addScaledVector(a[8],.546274*(i*i-r*r)),n}getIrradianceAt(e,n){const i=e.x,r=e.y,s=e.z,a=this.coefficients;return n.copy(a[0]).multiplyScalar(.886227),n.addScaledVector(a[1],2*.511664*r),n.addScaledVector(a[2],2*.511664*s),n.addScaledVector(a[3],2*.511664*i),n.addScaledVector(a[4],2*.429043*i*r),n.addScaledVector(a[5],2*.429043*r*s),n.addScaledVector(a[6],.743125*s*s-.247708),n.addScaledVector(a[7],2*.429043*i*s),n.addScaledVector(a[8],.429043*(i*i-r*r)),n}add(e){for(let n=0;n<9;n++)this.coefficients[n].add(e.coefficients[n]);return this}addScaledSH(e,n){for(let i=0;i<9;i++)this.coefficients[i].addScaledVector(e.coefficients[i],n);return this}scale(e){for(let n=0;n<9;n++)this.coefficients[n].multiplyScalar(e);return this}lerp(e,n){for(let i=0;i<9;i++)this.coefficients[i].lerp(e.coefficients[i],n);return this}equals(e){for(let n=0;n<9;n++)if(!this.coefficients[n].equals(e.coefficients[n]))return!1;return!0}copy(e){return this.set(e.coefficients)}clone(){return new this.constructor().copy(this)}fromArray(e,n=0){const i=this.coefficients;for(let r=0;r<9;r++)i[r].fromArray(e,n+r*3);return this}toArray(e=[],n=0){const i=this.coefficients;for(let r=0;r<9;r++)i[r].toArray(e,n+r*3);return e}static getBasisAt(e,n){const i=e.x,r=e.y,s=e.z;n[0]=.282095,n[1]=.488603*r,n[2]=.488603*s,n[3]=.488603*i,n[4]=1.092548*i*r,n[5]=1.092548*r*s,n[6]=.315392*(3*s*s-1),n[7]=1.092548*i*s,n[8]=.546274*(i*i-r*r)}}class Bue extends AE{constructor(e=new Uue,n=1){super(void 0,n),this.isLightProbe=!0,this.sh=e}copy(e){return super.copy(e),this.sh.copy(e.sh),this}fromJSON(e){return this.intensity=e.intensity,this.sh.fromArray(e.sh),this}toJSON(e){const n=super.toJSON(e);return n.object.sh=this.sh.toArray(),n}}class wF extends Ed{constructor(e){super(e),this.textures={}}load(e,n,i,r){const s=this,a=new x_(s.manager);a.setPath(s.path),a.setRequestHeader(s.requestHeader),a.setWithCredentials(s.withCredentials),a.load(e,function(o){try{n(s.parse(JSON.parse(o)))}catch(c){r?r(c):console.error(c),s.manager.itemError(e)}},i,r)}parse(e){const n=this.textures;function i(s){return n[s]===void 0&&console.warn("THREE.MaterialLoader: Undefined texture",s),n[s]}const r=this.createMaterialFromType(e.type);if(e.uuid!==void 0&&(r.uuid=e.uuid),e.name!==void 0&&(r.name=e.name),e.color!==void 0&&r.color!==void 0&&r.color.setHex(e.color),e.roughness!==void 0&&(r.roughness=e.roughness),e.metalness!==void 0&&(r.metalness=e.metalness),e.sheen!==void 0&&(r.sheen=e.sheen),e.sheenColor!==void 0&&(r.sheenColor=new bn().setHex(e.sheenColor)),e.sheenRoughness!==void 0&&(r.sheenRoughness=e.sheenRoughness),e.emissive!==void 0&&r.emissive!==void 0&&r.emissive.setHex(e.emissive),e.specular!==void 0&&r.specular!==void 0&&r.specular.setHex(e.specular),e.specularIntensity!==void 0&&(r.specularIntensity=e.specularIntensity),e.specularColor!==void 0&&r.specularColor!==void 0&&r.specularColor.setHex(e.specularColor),e.shininess!==void 0&&(r.shininess=e.shininess),e.clearcoat!==void 0&&(r.clearcoat=e.clearcoat),e.clearcoatRoughness!==void 0&&(r.clearcoatRoughness=e.clearcoatRoughness),e.dispersion!==void 0&&(r.dispersion=e.dispersion),e.iridescence!==void 0&&(r.iridescence=e.iridescence),e.iridescenceIOR!==void 0&&(r.iridescenceIOR=e.iridescenceIOR),e.iridescenceThicknessRange!==void 0&&(r.iridescenceThicknessRange=e.iridescenceThicknessRange),e.transmission!==void 0&&(r.transmission=e.transmission),e.thickness!==void 0&&(r.thickness=e.thickness),e.attenuationDistance!==void 0&&(r.attenuationDistance=e.attenuationDistance),e.attenuationColor!==void 0&&r.attenuationColor!==void 0&&r.attenuationColor.setHex(e.attenuationColor),e.anisotropy!==void 0&&(r.anisotropy=e.anisotropy),e.anisotropyRotation!==void 0&&(r.anisotropyRotation=e.anisotropyRotation),e.fog!==void 0&&(r.fog=e.fog),e.flatShading!==void 0&&(r.flatShading=e.flatShading),e.blending!==void 0&&(r.blending=e.blending),e.combine!==void 0&&(r.combine=e.combine),e.side!==void 0&&(r.side=e.side),e.shadowSide!==void 0&&(r.shadowSide=e.shadowSide),e.opacity!==void 0&&(r.opacity=e.opacity),e.transparent!==void 0&&(r.transparent=e.transparent),e.alphaTest!==void 0&&(r.alphaTest=e.alphaTest),e.alphaHash!==void 0&&(r.alphaHash=e.alphaHash),e.depthFunc!==void 0&&(r.depthFunc=e.depthFunc),e.depthTest!==void 0&&(r.depthTest=e.depthTest),e.depthWrite!==void 0&&(r.depthWrite=e.depthWrite),e.colorWrite!==void 0&&(r.colorWrite=e.colorWrite),e.blendSrc!==void 0&&(r.blendSrc=e.blendSrc),e.blendDst!==void 0&&(r.blendDst=e.blendDst),e.blendEquation!==void 0&&(r.blendEquation=e.blendEquation),e.blendSrcAlpha!==void 0&&(r.blendSrcAlpha=e.blendSrcAlpha),e.blendDstAlpha!==void 0&&(r.blendDstAlpha=e.blendDstAlpha),e.blendEquationAlpha!==void 0&&(r.blendEquationAlpha=e.blendEquationAlpha),e.blendColor!==void 0&&r.blendColor!==void 0&&r.blendColor.setHex(e.blendColor),e.blendAlpha!==void 0&&(r.blendAlpha=e.blendAlpha),e.stencilWriteMask!==void 0&&(r.stencilWriteMask=e.stencilWriteMask),e.stencilFunc!==void 0&&(r.stencilFunc=e.stencilFunc),e.stencilRef!==void 0&&(r.stencilRef=e.stencilRef),e.stencilFuncMask!==void 0&&(r.stencilFuncMask=e.stencilFuncMask),e.stencilFail!==void 0&&(r.stencilFail=e.stencilFail),e.stencilZFail!==void 0&&(r.stencilZFail=e.stencilZFail),e.stencilZPass!==void 0&&(r.stencilZPass=e.stencilZPass),e.stencilWrite!==void 0&&(r.stencilWrite=e.stencilWrite),e.wireframe!==void 0&&(r.wireframe=e.wireframe),e.wireframeLinewidth!==void 0&&(r.wireframeLinewidth=e.wireframeLinewidth),e.wireframeLinecap!==void 0&&(r.wireframeLinecap=e.wireframeLinecap),e.wireframeLinejoin!==void 0&&(r.wireframeLinejoin=e.wireframeLinejoin),e.rotation!==void 0&&(r.rotation=e.rotation),e.linewidth!==void 0&&(r.linewidth=e.linewidth),e.dashSize!==void 0&&(r.dashSize=e.dashSize),e.gapSize!==void 0&&(r.gapSize=e.gapSize),e.scale!==void 0&&(r.scale=e.scale),e.polygonOffset!==void 0&&(r.polygonOffset=e.polygonOffset),e.polygonOffsetFactor!==void 0&&(r.polygonOffsetFactor=e.polygonOffsetFactor),e.polygonOffsetUnits!==void 0&&(r.polygonOffsetUnits=e.polygonOffsetUnits),e.dithering!==void 0&&(r.dithering=e.dithering),e.alphaToCoverage!==void 0&&(r.alphaToCoverage=e.alphaToCoverage),e.premultipliedAlpha!==void 0&&(r.premultipliedAlpha=e.premultipliedAlpha),e.forceSinglePass!==void 0&&(r.forceSinglePass=e.forceSinglePass),e.visible!==void 0&&(r.visible=e.visible),e.toneMapped!==void 0&&(r.toneMapped=e.toneMapped),e.userData!==void 0&&(r.userData=e.userData),e.vertexColors!==void 0&&(typeof e.vertexColors=="number"?r.vertexColors=e.vertexColors>0:r.vertexColors=e.vertexColors),e.uniforms!==void 0)for(const s in e.uniforms){const a=e.uniforms[s];switch(r.uniforms[s]={},a.type){case"t":r.uniforms[s].value=i(a.value);break;case"c":r.uniforms[s].value=new bn().setHex(a.value);break;case"v2":r.uniforms[s].value=new xt().fromArray(a.value);break;case"v3":r.uniforms[s].value=new Oe().fromArray(a.value);break;case"v4":r.uniforms[s].value=new zr().fromArray(a.value);break;case"m3":r.uniforms[s].value=new Qi().fromArray(a.value);break;case"m4":r.uniforms[s].value=new gi().fromArray(a.value);break;default:r.uniforms[s].value=a.value}}if(e.defines!==void 0&&(r.defines=e.defines),e.vertexShader!==void 0&&(r.vertexShader=e.vertexShader),e.fragmentShader!==void 0&&(r.fragmentShader=e.fragmentShader),e.glslVersion!==void 0&&(r.glslVersion=e.glslVersion),e.extensions!==void 0)for(const s in e.extensions)r.extensions[s]=e.extensions[s];if(e.lights!==void 0&&(r.lights=e.lights),e.clipping!==void 0&&(r.clipping=e.clipping),e.size!==void 0&&(r.size=e.size),e.sizeAttenuation!==void 0&&(r.sizeAttenuation=e.sizeAttenuation),e.map!==void 0&&(r.map=i(e.map)),e.matcap!==void 0&&(r.matcap=i(e.matcap)),e.alphaMap!==void 0&&(r.alphaMap=i(e.alphaMap)),e.bumpMap!==void 0&&(r.bumpMap=i(e.bumpMap)),e.bumpScale!==void 0&&(r.bumpScale=e.bumpScale),e.normalMap!==void 0&&(r.normalMap=i(e.normalMap)),e.normalMapType!==void 0&&(r.normalMapType=e.normalMapType),e.normalScale!==void 0){let s=e.normalScale;Array.isArray(s)===!1&&(s=[s,s]),r.normalScale=new xt().fromArray(s)}return e.displacementMap!==void 0&&(r.displacementMap=i(e.displacementMap)),e.displacementScale!==void 0&&(r.displacementScale=e.displacementScale),e.displacementBias!==void 0&&(r.displacementBias=e.displacementBias),e.roughnessMap!==void 0&&(r.roughnessMap=i(e.roughnessMap)),e.metalnessMap!==void 0&&(r.metalnessMap=i(e.metalnessMap)),e.emissiveMap!==void 0&&(r.emissiveMap=i(e.emissiveMap)),e.emissiveIntensity!==void 0&&(r.emissiveIntensity=e.emissiveIntensity),e.specularMap!==void 0&&(r.specularMap=i(e.specularMap)),e.specularIntensityMap!==void 0&&(r.specularIntensityMap=i(e.specularIntensityMap)),e.specularColorMap!==void 0&&(r.specularColorMap=i(e.specularColorMap)),e.envMap!==void 0&&(r.envMap=i(e.envMap)),e.envMapRotation!==void 0&&r.envMapRotation.fromArray(e.envMapRotation),e.envMapIntensity!==void 0&&(r.envMapIntensity=e.envMapIntensity),e.reflectivity!==void 0&&(r.reflectivity=e.reflectivity),e.refractionRatio!==void 0&&(r.refractionRatio=e.refractionRatio),e.lightMap!==void 0&&(r.lightMap=i(e.lightMap)),e.lightMapIntensity!==void 0&&(r.lightMapIntensity=e.lightMapIntensity),e.aoMap!==void 0&&(r.aoMap=i(e.aoMap)),e.aoMapIntensity!==void 0&&(r.aoMapIntensity=e.aoMapIntensity),e.gradientMap!==void 0&&(r.gradientMap=i(e.gradientMap)),e.clearcoatMap!==void 0&&(r.clearcoatMap=i(e.clearcoatMap)),e.clearcoatRoughnessMap!==void 0&&(r.clearcoatRoughnessMap=i(e.clearcoatRoughnessMap)),e.clearcoatNormalMap!==void 0&&(r.clearcoatNormalMap=i(e.clearcoatNormalMap)),e.clearcoatNormalScale!==void 0&&(r.clearcoatNormalScale=new xt().fromArray(e.clearcoatNormalScale)),e.iridescenceMap!==void 0&&(r.iridescenceMap=i(e.iridescenceMap)),e.iridescenceThicknessMap!==void 0&&(r.iridescenceThicknessMap=i(e.iridescenceThicknessMap)),e.transmissionMap!==void 0&&(r.transmissionMap=i(e.transmissionMap)),e.thicknessMap!==void 0&&(r.thicknessMap=i(e.thicknessMap)),e.anisotropyMap!==void 0&&(r.anisotropyMap=i(e.anisotropyMap)),e.sheenColorMap!==void 0&&(r.sheenColorMap=i(e.sheenColorMap)),e.sheenRoughnessMap!==void 0&&(r.sheenRoughnessMap=i(e.sheenRoughnessMap)),r}setTextures(e){return this.textures=e,this}createMaterialFromType(e){return wF.createMaterialFromType(e)}static createMaterialFromType(e){const n={ShadowMaterial:vue,SpriteMaterial:eW,RawShaderMaterial:_ue,ShaderMaterial:qa,PointsMaterial:nW,MeshPhysicalMaterial:yue,MeshStandardMaterial:lW,MeshPhongMaterial:bue,MeshToonMaterial:Eue,MeshNormalMaterial:uW,MeshLambertMaterial:Sue,MeshDepthMaterial:hW,MeshDistanceMaterial:dW,MeshBasicMaterial:wE,MeshMatcapMaterial:Tue,LineDashedMaterial:xue,LineBasicMaterial:yh,Material:rl};return new n[e]}}class rG{static extractUrlBase(e){const n=e.lastIndexOf("/");return n===-1?"./":e.slice(0,n+1)}static resolveURL(e,n){return typeof e!="string"||e===""?"":(/^https?:\/\//i.test(n)&&/^\//.test(e)&&(n=n.replace(/(^https?:\/\/[^\/]+).*/i,"$1")),/^(https?:)?\/\//i.test(e)||/^data:.*,.*$/i.test(e)||/^blob:.*$/i.test(e)?e:n+e)}}class Fue extends tr{constructor(){super(),this.isInstancedBufferGeometry=!0,this.type="InstancedBufferGeometry",this.instanceCount=1/0}copy(e){return super.copy(e),this.instanceCount=e.instanceCount,this}toJSON(){const e=super.toJSON();return e.instanceCount=this.instanceCount,e.isInstancedBufferGeometry=!0,e}}class zue extends Ed{constructor(e){super(e)}load(e,n,i,r){const s=this,a=new x_(s.manager);a.setPath(s.path),a.setRequestHeader(s.requestHeader),a.setWithCredentials(s.withCredentials),a.load(e,function(o){try{n(s.parse(JSON.parse(o)))}catch(c){r?r(c):console.error(c),s.manager.itemError(e)}},i,r)}parse(e){const n={},i={};function r(f,p){if(n[p]!==void 0)return n[p];const _=f.interleavedBuffers[p],v=s(f,_.buffer),b=Fw(_.type,v),S=new cF(b,_.stride);return S.uuid=_.uuid,n[p]=S,S}function s(f,p){if(i[p]!==void 0)return i[p];const _=f.arrayBuffers[p],v=new Uint32Array(_).buffer;return i[p]=v,v}const a=e.isInstancedBufferGeometry?new Fue:new tr,o=e.data.index;if(o!==void 0){const f=Fw(o.type,o.array);a.setIndex(new ar(f,1))}const c=e.data.attributes;for(const f in c){const p=c[f];let g;if(p.isInterleavedBufferAttribute){const _=r(e.data,p.data);g=new ZT(_,p.itemSize,p.offset,p.normalized)}else{const _=Fw(p.type,p.array),v=p.isInstancedBufferAttribute?GC:ar;g=new v(_,p.itemSize,p.normalized)}p.name!==void 0&&(g.name=p.name),p.usage!==void 0&&g.setUsage(p.usage),a.setAttribute(f,g)}const l=e.data.morphAttributes;if(l)for(const f in l){const p=l[f],g=[];for(let _=0,v=p.length;_<v;_++){const b=p[_];let S;if(b.isInterleavedBufferAttribute){const x=r(e.data,b.data);S=new ZT(x,b.itemSize,b.offset,b.normalized)}else{const x=Fw(b.type,b.array);S=new ar(x,b.itemSize,b.normalized)}b.name!==void 0&&(S.name=b.name),g.push(S)}a.morphAttributes[f]=g}e.data.morphTargetsRelative&&(a.morphTargetsRelative=!0);const h=e.data.groups||e.data.drawcalls||e.data.offsets;if(h!==void 0)for(let f=0,p=h.length;f!==p;++f){const g=h[f];a.addGroup(g.start,g.count,g.materialIndex)}const d=e.data.boundingSphere;if(d!==void 0){const f=new Oe;d.center!==void 0&&f.fromArray(d.center),a.boundingSphere=new Kl(f,d.radius)}return e.name&&(a.name=e.name),e.userData&&(a.userData=e.userData),a}}class HRe extends Ed{constructor(e){super(e)}load(e,n,i,r){const s=this,a=this.path===""?rG.extractUrlBase(e):this.path;this.resourcePath=this.resourcePath||a;const o=new x_(this.manager);o.setPath(this.path),o.setRequestHeader(this.requestHeader),o.setWithCredentials(this.withCredentials),o.load(e,function(c){let l=null;try{l=JSON.parse(c)}catch(h){r!==void 0&&r(h),console.error("THREE:ObjectLoader: Can't parse "+e+".",h.message);return}const u=l.metadata;if(u===void 0||u.type===void 0||u.type.toLowerCase()==="geometry"){r!==void 0&&r(new Error("THREE.ObjectLoader: Can't load "+e)),console.error("THREE.ObjectLoader: Can't load "+e);return}s.parse(l,n)},i,r)}async loadAsync(e,n){const i=this,r=this.path===""?rG.extractUrlBase(e):this.path;this.resourcePath=this.resourcePath||r;const s=new x_(this.manager);s.setPath(this.path),s.setRequestHeader(this.requestHeader),s.setWithCredentials(this.withCredentials);const a=await s.loadAsync(e,n),o=JSON.parse(a),c=o.metadata;if(c===void 0||c.type===void 0||c.type.toLowerCase()==="geometry")throw new Error("THREE.ObjectLoader: Can't load "+e);return await i.parseAsync(o)}parse(e,n){const i=this.parseAnimations(e.animations),r=this.parseShapes(e.shapes),s=this.parseGeometries(e.geometries,r),a=this.parseImages(e.images,function(){n!==void 0&&n(l)}),o=this.parseTextures(e.textures,a),c=this.parseMaterials(e.materials,o),l=this.parseObject(e.object,s,c,o,i),u=this.parseSkeletons(e.skeletons,l);if(this.bindSkeletons(l,u),this.bindLightTargets(l),n!==void 0){let h=!1;for(const d in a)if(a[d].data instanceof HTMLImageElement){h=!0;break}h===!1&&n(l)}return l}async parseAsync(e){const n=this.parseAnimations(e.animations),i=this.parseShapes(e.shapes),r=this.parseGeometries(e.geometries,i),s=await this.parseImagesAsync(e.images),a=this.parseTextures(e.textures,s),o=this.parseMaterials(e.materials,a),c=this.parseObject(e.object,r,o,a,n),l=this.parseSkeletons(e.skeletons,c);return this.bindSkeletons(c,l),this.bindLightTargets(c),c}parseShapes(e){const n={};if(e!==void 0)for(let i=0,r=e.length;i<r;i++){const s=new MT().fromJSON(e[i]);n[s.uuid]=s}return n}parseSkeletons(e,n){const i={},r={};if(n.traverse(function(s){s.isBone&&(r[s.uuid]=s)}),e!==void 0)for(let s=0,a=e.length;s<a;s++){const o=new lF().fromJSON(e[s],r);i[o.uuid]=o}return i}parseGeometries(e,n){const i={};if(e!==void 0){const r=new zue;for(let s=0,a=e.length;s<a;s++){let o;const c=e[s];switch(c.type){case"BufferGeometry":case"InstancedBufferGeometry":o=r.parse(c);break;default:c.type in jJ?o=jJ[c.type].fromJSON(c,n):console.warn(`THREE.ObjectLoader: Unsupported geometry type "${c.type}"`)}o.uuid=c.uuid,c.name!==void 0&&(o.name=c.name),c.userData!==void 0&&(o.userData=c.userData),i[c.uuid]=o}}return i}parseMaterials(e,n){const i={},r={};if(e!==void 0){const s=new wF;s.setTextures(n);for(let a=0,o=e.length;a<o;a++){const c=e[a];i[c.uuid]===void 0&&(i[c.uuid]=s.parse(c)),r[c.uuid]=i[c.uuid]}}return r}parseAnimations(e){const n={};if(e!==void 0)for(let i=0;i<e.length;i++){const r=e[i],s=iN.parse(r);n[s.uuid]=s}return n}parseImages(e,n){const i=this,r={};let s;function a(c){return i.manager.itemStart(c),s.load(c,function(){i.manager.itemEnd(c)},void 0,function(){i.manager.itemError(c),i.manager.itemEnd(c)})}function o(c){if(typeof c=="string"){const l=c,u=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(l)?l:i.resourcePath+l;return a(u)}else return c.data?{data:Fw(c.type,c.data),width:c.width,height:c.height}:null}if(e!==void 0&&e.length>0){const c=new gW(n);s=new rN(c),s.setCrossOrigin(this.crossOrigin);for(let l=0,u=e.length;l<u;l++){const h=e[l],d=h.url;if(Array.isArray(d)){const f=[];for(let p=0,g=d.length;p<g;p++){const _=d[p],v=o(_);v!==null&&(v instanceof HTMLImageElement?f.push(v):f.push(new lf(v.data,v.width,v.height)))}r[h.uuid]=new Eb(f)}else{const f=o(h.url);r[h.uuid]=new Eb(f)}}}return r}async parseImagesAsync(e){const n=this,i={};let r;async function s(a){if(typeof a=="string"){const o=a,c=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(o)?o:n.resourcePath+o;return await r.loadAsync(c)}else return a.data?{data:Fw(a.type,a.data),width:a.width,height:a.height}:null}if(e!==void 0&&e.length>0){r=new rN(this.manager),r.setCrossOrigin(this.crossOrigin);for(let a=0,o=e.length;a<o;a++){const c=e[a],l=c.url;if(Array.isArray(l)){const u=[];for(let h=0,d=l.length;h<d;h++){const f=l[h],p=await s(f);p!==null&&(p instanceof HTMLImageElement?u.push(p):u.push(new lf(p.data,p.width,p.height)))}i[c.uuid]=new Eb(u)}else{const u=await s(c.url);i[c.uuid]=new Eb(u)}}}return i}parseTextures(e,n){function i(s,a){return typeof s=="number"?s:(console.warn("THREE.ObjectLoader.parseTexture: Constant should be in numeric form.",s),a[s])}const r={};if(e!==void 0)for(let s=0,a=e.length;s<a;s++){const o=e[s];o.image===void 0&&console.warn('THREE.ObjectLoader: No "image" specified for',o.uuid),n[o.image]===void 0&&console.warn("THREE.ObjectLoader: Undefined image",o.image);const c=n[o.image],l=c.data;let u;Array.isArray(l)?(u=new LI,l.length===6&&(u.needsUpdate=!0)):(l&&l.data?u=new lf:u=new Ga,l&&(u.needsUpdate=!0)),u.source=c,u.uuid=o.uuid,o.name!==void 0&&(u.name=o.name),o.mapping!==void 0&&(u.mapping=i(o.mapping,VRe)),o.channel!==void 0&&(u.channel=o.channel),o.offset!==void 0&&u.offset.fromArray(o.offset),o.repeat!==void 0&&u.repeat.fromArray(o.repeat),o.center!==void 0&&u.center.fromArray(o.center),o.rotation!==void 0&&(u.rotation=o.rotation),o.wrap!==void 0&&(u.wrapS=i(o.wrap[0],qJ),u.wrapT=i(o.wrap[1],qJ)),o.format!==void 0&&(u.format=o.format),o.internalFormat!==void 0&&(u.internalFormat=o.internalFormat),o.type!==void 0&&(u.type=o.type),o.colorSpace!==void 0&&(u.colorSpace=o.colorSpace),o.minFilter!==void 0&&(u.minFilter=i(o.minFilter,$J)),o.magFilter!==void 0&&(u.magFilter=i(o.magFilter,$J)),o.anisotropy!==void 0&&(u.anisotropy=o.anisotropy),o.flipY!==void 0&&(u.flipY=o.flipY),o.generateMipmaps!==void 0&&(u.generateMipmaps=o.generateMipmaps),o.premultiplyAlpha!==void 0&&(u.premultiplyAlpha=o.premultiplyAlpha),o.unpackAlignment!==void 0&&(u.unpackAlignment=o.unpackAlignment),o.compareFunction!==void 0&&(u.compareFunction=o.compareFunction),o.userData!==void 0&&(u.userData=o.userData),r[o.uuid]=u}return r}parseObject(e,n,i,r,s){let a;function o(d){return n[d]===void 0&&console.warn("THREE.ObjectLoader: Undefined geometry",d),n[d]}function c(d){if(d!==void 0){if(Array.isArray(d)){const f=[];for(let p=0,g=d.length;p<g;p++){const _=d[p];i[_]===void 0&&console.warn("THREE.ObjectLoader: Undefined material",_),f.push(i[_])}return f}return i[d]===void 0&&console.warn("THREE.ObjectLoader: Undefined material",d),i[d]}}function l(d){return r[d]===void 0&&console.warn("THREE.ObjectLoader: Undefined texture",d),r[d]}let u,h;switch(e.type){case"Scene":a=new VC,e.background!==void 0&&(Number.isInteger(e.background)?a.background=new bn(e.background):a.background=l(e.background)),e.environment!==void 0&&(a.environment=l(e.environment)),e.fog!==void 0&&(e.fog.type==="Fog"?a.fog=new oF(e.fog.color,e.fog.near,e.fog.far):e.fog.type==="FogExp2"&&(a.fog=new aF(e.fog.color,e.fog.density)),e.fog.name!==""&&(a.fog.name=e.fog.name)),e.backgroundBlurriness!==void 0&&(a.backgroundBlurriness=e.backgroundBlurriness),e.backgroundIntensity!==void 0&&(a.backgroundIntensity=e.backgroundIntensity),e.backgroundRotation!==void 0&&a.backgroundRotation.fromArray(e.backgroundRotation),e.environmentIntensity!==void 0&&(a.environmentIntensity=e.environmentIntensity),e.environmentRotation!==void 0&&a.environmentRotation.fromArray(e.environmentRotation);break;case"PerspectiveCamera":a=new Hc(e.fov,e.aspect,e.near,e.far),e.focus!==void 0&&(a.focus=e.focus),e.zoom!==void 0&&(a.zoom=e.zoom),e.filmGauge!==void 0&&(a.filmGauge=e.filmGauge),e.filmOffset!==void 0&&(a.filmOffset=e.filmOffset),e.view!==void 0&&(a.view=Object.assign({},e.view));break;case"OrthographicCamera":a=new VI(e.left,e.right,e.top,e.bottom,e.near,e.far),e.zoom!==void 0&&(a.zoom=e.zoom),e.view!==void 0&&(a.view=Object.assign({},e.view));break;case"AmbientLight":a=new Due(e.color,e.intensity);break;case"DirectionalLight":a=new Pue(e.color,e.intensity),a.target=e.target||"";break;case"PointLight":a=new kue(e.color,e.intensity,e.distance,e.decay);break;case"RectAreaLight":a=new Lue(e.color,e.intensity,e.width,e.height);break;case"SpotLight":a=new Iue(e.color,e.intensity,e.distance,e.angle,e.penumbra,e.decay),a.target=e.target||"";break;case"HemisphereLight":a=new Nue(e.color,e.groundColor,e.intensity);break;case"LightProbe":a=new Bue().fromJSON(e);break;case"SkinnedMesh":u=o(e.geometry),h=c(e.material),a=new Qle(u,h),e.bindMode!==void 0&&(a.bindMode=e.bindMode),e.bindMatrix!==void 0&&a.bindMatrix.fromArray(e.bindMatrix),e.skeleton!==void 0&&(a.skeleton=e.skeleton);break;case"Mesh":u=o(e.geometry),h=c(e.material),a=new Io(u,h);break;case"InstancedMesh":u=o(e.geometry),h=c(e.material);const d=e.count,f=e.instanceMatrix,p=e.instanceColor;a=new eue(u,h,d),a.instanceMatrix=new GC(new Float32Array(f.array),16),p!==void 0&&(a.instanceColor=new GC(new Float32Array(p.array),p.itemSize));break;case"BatchedMesh":u=o(e.geometry),h=c(e.material),a=new tue(e.maxInstanceCount,e.maxVertexCount,e.maxIndexCount,h),a.geometry=u,a.perObjectFrustumCulled=e.perObjectFrustumCulled,a.sortObjects=e.sortObjects,a._drawRanges=e.drawRanges,a._reservedRanges=e.reservedRanges,a._geometryInfo=e.geometryInfo.map(g=>{let _=null,v=null;return g.boundingBox!==void 0&&(_=new Su,_.min.fromArray(g.boundingBox.min),_.max.fromArray(g.boundingBox.max)),g.boundingSphere!==void 0&&(v=new Kl,v.radius=g.boundingSphere.radius,v.center.fromArray(g.boundingSphere.center)),{...g,boundingBox:_,boundingSphere:v}}),a._instanceInfo=e.instanceInfo,a._availableInstanceIds=e._availableInstanceIds,a._availableGeometryIds=e._availableGeometryIds,a._nextIndexStart=e.nextIndexStart,a._nextVertexStart=e.nextVertexStart,a._geometryCount=e.geometryCount,a._maxInstanceCount=e.maxInstanceCount,a._maxVertexCount=e.maxVertexCount,a._maxIndexCount=e.maxIndexCount,a._geometryInitialized=e.geometryInitialized,a._matricesTexture=l(e.matricesTexture.uuid),a._indirectTexture=l(e.indirectTexture.uuid),e.colorsTexture!==void 0&&(a._colorsTexture=l(e.colorsTexture.uuid)),e.boundingSphere!==void 0&&(a.boundingSphere=new Kl,a.boundingSphere.center.fromArray(e.boundingSphere.center),a.boundingSphere.radius=e.boundingSphere.radius),e.boundingBox!==void 0&&(a.boundingBox=new Su,a.boundingBox.min.fromArray(e.boundingBox.min),a.boundingBox.max.fromArray(e.boundingBox.max));break;case"LOD":a=new Jle;break;case"Line":a=new tE(o(e.geometry),c(e.material));break;case"LineLoop":a=new nue(o(e.geometry),c(e.material));break;case"LineSegments":a=new g0(o(e.geometry),c(e.material));break;case"PointCloud":case"Points":a=new iue(o(e.geometry),c(e.material));break;case"Sprite":a=new Zle(c(e.material));break;case"Group":a=new _T;break;case"Bone":a=new tW;break;default:a=new Wr}if(a.uuid=e.uuid,e.name!==void 0&&(a.name=e.name),e.matrix!==void 0?(a.matrix.fromArray(e.matrix),e.matrixAutoUpdate!==void 0&&(a.matrixAutoUpdate=e.matrixAutoUpdate),a.matrixAutoUpdate&&a.matrix.decompose(a.position,a.quaternion,a.scale)):(e.position!==void 0&&a.position.fromArray(e.position),e.rotation!==void 0&&a.rotation.fromArray(e.rotation),e.quaternion!==void 0&&a.quaternion.fromArray(e.quaternion),e.scale!==void 0&&a.scale.fromArray(e.scale)),e.up!==void 0&&a.up.fromArray(e.up),e.castShadow!==void 0&&(a.castShadow=e.castShadow),e.receiveShadow!==void 0&&(a.receiveShadow=e.receiveShadow),e.shadow&&(e.shadow.intensity!==void 0&&(a.shadow.intensity=e.shadow.intensity),e.shadow.bias!==void 0&&(a.shadow.bias=e.shadow.bias),e.shadow.normalBias!==void 0&&(a.shadow.normalBias=e.shadow.normalBias),e.shadow.radius!==void 0&&(a.shadow.radius=e.shadow.radius),e.shadow.mapSize!==void 0&&a.shadow.mapSize.fromArray(e.shadow.mapSize),e.shadow.camera!==void 0&&(a.shadow.camera=this.parseObject(e.shadow.camera))),e.visible!==void 0&&(a.visible=e.visible),e.frustumCulled!==void 0&&(a.frustumCulled=e.frustumCulled),e.renderOrder!==void 0&&(a.renderOrder=e.renderOrder),e.userData!==void 0&&(a.userData=e.userData),e.layers!==void 0&&(a.layers.mask=e.layers),e.children!==void 0){const d=e.children;for(let f=0;f<d.length;f++)a.add(this.parseObject(d[f],n,i,r,s))}if(e.animations!==void 0){const d=e.animations;for(let f=0;f<d.length;f++){const p=d[f];a.animations.push(s[p])}}if(e.type==="LOD"){e.autoUpdate!==void 0&&(a.autoUpdate=e.autoUpdate);const d=e.levels;for(let f=0;f<d.length;f++){const p=d[f],g=a.getObjectByProperty("uuid",p.object);g!==void 0&&a.addLevel(g,p.distance,p.hysteresis)}}return a}bindSkeletons(e,n){Object.keys(n).length!==0&&e.traverse(function(i){if(i.isSkinnedMesh===!0&&i.skeleton!==void 0){const r=n[i.skeleton];r===void 0?console.warn("THREE.ObjectLoader: No skeleton found with UUID:",i.skeleton):i.bind(r,i.bindMatrix)}})}bindLightTargets(e){e.traverse(function(n){if(n.isDirectionalLight||n.isSpotLight){const i=n.target,r=e.getObjectByProperty("uuid",i);r!==void 0?n.target=r:n.target=new Wr}})}}const VRe={UVMapping:ZB,CubeReflectionMapping:T_,CubeRefractionMapping:eE,EquirectangularReflectionMapping:VO,EquirectangularRefractionMapping:GO,CubeUVReflectionMapping:YA},qJ={RepeatWrapping:UC,ClampToEdgeWrapping:cp,MirroredRepeatWrapping:qO},$J={NearestFilter:Va,NearestMipmapNearestFilter:H7,NearestMipmapLinearFilter:Bw,LinearFilter:Ca,LinearMipmapNearestFilter:JM,LinearMipmapLinearFilter:Hg};class GRe extends Ed{constructor(e){super(e),this.isImageBitmapLoader=!0,typeof createImageBitmap>"u"&&console.warn("THREE.ImageBitmapLoader: createImageBitmap() not supported."),typeof fetch>"u"&&console.warn("THREE.ImageBitmapLoader: fetch() not supported."),this.options={premultiplyAlpha:"none"}}setOptions(e){return this.options=e,this}load(e,n,i,r){e===void 0&&(e=""),this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);const s=this,a=t_.get(e);if(a!==void 0){if(s.manager.itemStart(e),a.then){a.then(l=>{n&&n(l),s.manager.itemEnd(e)}).catch(l=>{r&&r(l)});return}return setTimeout(function(){n&&n(a),s.manager.itemEnd(e)},0),a}const o={};o.credentials=this.crossOrigin==="anonymous"?"same-origin":"include",o.headers=this.requestHeader;const c=fetch(e,o).then(function(l){return l.blob()}).then(function(l){return createImageBitmap(l,Object.assign(s.options,{colorSpaceConversion:"none"}))}).then(function(l){return t_.add(e,l),n&&n(l),s.manager.itemEnd(e),l}).catch(function(l){r&&r(l),t_.remove(e),s.manager.itemError(e),s.manager.itemEnd(e)});t_.add(e,c),s.manager.itemStart(e)}}let oD,_W=class{static getContext(){return oD===void 0&&(oD=new(window.AudioContext||window.webkitAudioContext)),oD}static setContext(e){oD=e}};class qRe extends Ed{constructor(e){super(e)}load(e,n,i,r){const s=this,a=new x_(this.manager);a.setResponseType("arraybuffer"),a.setPath(this.path),a.setRequestHeader(this.requestHeader),a.setWithCredentials(this.withCredentials),a.load(e,function(c){try{const l=c.slice(0);_W.getContext().decodeAudioData(l,function(h){n(h)}).catch(o)}catch(l){o(l)}},i,r);function o(c){r?r(c):console.error(c),s.manager.itemError(e)}}}const WJ=new gi,YJ=new gi,US=new gi;class $Re{constructor(){this.type="StereoCamera",this.aspect=1,this.eyeSep=.064,this.cameraL=new Hc,this.cameraL.layers.enable(1),this.cameraL.matrixAutoUpdate=!1,this.cameraR=new Hc,this.cameraR.layers.enable(2),this.cameraR.matrixAutoUpdate=!1,this._cache={focus:null,fov:null,aspect:null,near:null,far:null,zoom:null,eyeSep:null}}update(e){const n=this._cache;if(n.focus!==e.focus||n.fov!==e.fov||n.aspect!==e.aspect*this.aspect||n.near!==e.near||n.far!==e.far||n.zoom!==e.zoom||n.eyeSep!==this.eyeSep){n.focus=e.focus,n.fov=e.fov,n.aspect=e.aspect*this.aspect,n.near=e.near,n.far=e.far,n.zoom=e.zoom,n.eyeSep=this.eyeSep,US.copy(e.projectionMatrix);const r=n.eyeSep/2,s=r*n.near/n.focus,a=n.near*Math.tan(RT*n.fov*.5)/n.zoom;let o,c;YJ.elements[12]=-r,WJ.elements[12]=r,o=-a*n.aspect+s,c=a*n.aspect+s,US.elements[0]=2*n.near/(c-o),US.elements[8]=(c+o)/(c-o),this.cameraL.projectionMatrix.copy(US),o=-a*n.aspect-s,c=a*n.aspect-s,US.elements[0]=2*n.near/(c-o),US.elements[8]=(c+o)/(c-o),this.cameraR.projectionMatrix.copy(US)}this.cameraL.matrixWorld.copy(e.matrixWorld).multiply(YJ),this.cameraR.matrixWorld.copy(e.matrixWorld).multiply(WJ)}}class jue extends Hc{constructor(e=[]){super(),this.isArrayCamera=!0,this.isMultiViewCamera=!1,this.cameras=e}}let yW=class{constructor(e=!0){this.autoStart=e,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}start(){this.startTime=KJ(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0}stop(){this.getElapsedTime(),this.running=!1,this.autoStart=!1}getElapsedTime(){return this.getDelta(),this.elapsedTime}getDelta(){let e=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){const n=KJ();e=(n-this.oldTime)/1e3,this.oldTime=n,this.elapsedTime+=e}return e}};function KJ(){return performance.now()}const BS=new Oe,XJ=new mh,WRe=new Oe,FS=new Oe;class YRe extends Wr{constructor(){super(),this.type="AudioListener",this.context=_W.getContext(),this.gain=this.context.createGain(),this.gain.connect(this.context.destination),this.filter=null,this.timeDelta=0,this._clock=new yW}getInput(){return this.gain}removeFilter(){return this.filter!==null&&(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination),this.gain.connect(this.context.destination),this.filter=null),this}getFilter(){return this.filter}setFilter(e){return this.filter!==null?(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination)):this.gain.disconnect(this.context.destination),this.filter=e,this.gain.connect(this.filter),this.filter.connect(this.context.destination),this}getMasterVolume(){return this.gain.gain.value}setMasterVolume(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this}updateMatrixWorld(e){super.updateMatrixWorld(e);const n=this.context.listener,i=this.up;if(this.timeDelta=this._clock.getDelta(),this.matrixWorld.decompose(BS,XJ,WRe),FS.set(0,0,-1).applyQuaternion(XJ),n.positionX){const r=this.context.currentTime+this.timeDelta;n.positionX.linearRampToValueAtTime(BS.x,r),n.positionY.linearRampToValueAtTime(BS.y,r),n.positionZ.linearRampToValueAtTime(BS.z,r),n.forwardX.linearRampToValueAtTime(FS.x,r),n.forwardY.linearRampToValueAtTime(FS.y,r),n.forwardZ.linearRampToValueAtTime(FS.z,r),n.upX.linearRampToValueAtTime(i.x,r),n.upY.linearRampToValueAtTime(i.y,r),n.upZ.linearRampToValueAtTime(i.z,r)}else n.setPosition(BS.x,BS.y,BS.z),n.setOrientation(FS.x,FS.y,FS.z,i.x,i.y,i.z)}}class Hue extends Wr{constructor(e){super(),this.type="Audio",this.listener=e,this.context=e.context,this.gain=this.context.createGain(),this.gain.connect(e.getInput()),this.autoplay=!1,this.buffer=null,this.detune=0,this.loop=!1,this.loopStart=0,this.loopEnd=0,this.offset=0,this.duration=void 0,this.playbackRate=1,this.isPlaying=!1,this.hasPlaybackControl=!0,this.source=null,this.sourceType="empty",this._startedAt=0,this._progress=0,this._connected=!1,this.filters=[]}getOutput(){return this.gain}setNodeSource(e){return this.hasPlaybackControl=!1,this.sourceType="audioNode",this.source=e,this.connect(),this}setMediaElementSource(e){return this.hasPlaybackControl=!1,this.sourceType="mediaNode",this.source=this.context.createMediaElementSource(e),this.connect(),this}setMediaStreamSource(e){return this.hasPlaybackControl=!1,this.sourceType="mediaStreamNode",this.source=this.context.createMediaStreamSource(e),this.connect(),this}setBuffer(e){return this.buffer=e,this.sourceType="buffer",this.autoplay&&this.play(),this}play(e=0){if(this.isPlaying===!0){console.warn("THREE.Audio: Audio is already playing.");return}if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}this._startedAt=this.context.currentTime+e;const n=this.context.createBufferSource();return n.buffer=this.buffer,n.loop=this.loop,n.loopStart=this.loopStart,n.loopEnd=this.loopEnd,n.onended=this.onEnded.bind(this),n.start(this._startedAt,this._progress+this.offset,this.duration),this.isPlaying=!0,this.source=n,this.setDetune(this.detune),this.setPlaybackRate(this.playbackRate),this.connect()}pause(){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.isPlaying===!0&&(this._progress+=Math.max(this.context.currentTime-this._startedAt,0)*this.playbackRate,this.loop===!0&&(this._progress=this._progress%(this.duration||this.buffer.duration)),this.source.stop(),this.source.onended=null,this.isPlaying=!1),this}stop(e=0){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this._progress=0,this.source!==null&&(this.source.stop(this.context.currentTime+e),this.source.onended=null),this.isPlaying=!1,this}connect(){if(this.filters.length>0){this.source.connect(this.filters[0]);for(let e=1,n=this.filters.length;e<n;e++)this.filters[e-1].connect(this.filters[e]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this._connected=!0,this}disconnect(){if(this._connected!==!1){if(this.filters.length>0){this.source.disconnect(this.filters[0]);for(let e=1,n=this.filters.length;e<n;e++)this.filters[e-1].disconnect(this.filters[e]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this._connected=!1,this}}getFilters(){return this.filters}setFilters(e){return e||(e=[]),this._connected===!0?(this.disconnect(),this.filters=e.slice(),this.connect()):this.filters=e.slice(),this}setDetune(e){return this.detune=e,this.isPlaying===!0&&this.source.detune!==void 0&&this.source.detune.setTargetAtTime(this.detune,this.context.currentTime,.01),this}getDetune(){return this.detune}getFilter(){return this.getFilters()[0]}setFilter(e){return this.setFilters(e?[e]:[])}setPlaybackRate(e){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.playbackRate=e,this.isPlaying===!0&&this.source.playbackRate.setTargetAtTime(this.playbackRate,this.context.currentTime,.01),this}getPlaybackRate(){return this.playbackRate}onEnded(){this.isPlaying=!1,this._progress=0}getLoop(){return this.hasPlaybackControl===!1?(console.warn("THREE.Audio: this Audio has no playback control."),!1):this.loop}setLoop(e){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.loop=e,this.isPlaying===!0&&(this.source.loop=this.loop),this}setLoopStart(e){return this.loopStart=e,this}setLoopEnd(e){return this.loopEnd=e,this}getVolume(){return this.gain.gain.value}setVolume(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this}copy(e,n){return super.copy(e,n),e.sourceType!=="buffer"?(console.warn("THREE.Audio: Audio source type cannot be copied."),this):(this.autoplay=e.autoplay,this.buffer=e.buffer,this.detune=e.detune,this.loop=e.loop,this.loopStart=e.loopStart,this.loopEnd=e.loopEnd,this.offset=e.offset,this.duration=e.duration,this.playbackRate=e.playbackRate,this.hasPlaybackControl=e.hasPlaybackControl,this.sourceType=e.sourceType,this.filters=e.filters.slice(),this)}clone(e){return new this.constructor(this.listener).copy(this,e)}}const zS=new Oe,ZJ=new mh,KRe=new Oe,jS=new Oe;class XRe extends Hue{constructor(e){super(e),this.panner=this.context.createPanner(),this.panner.panningModel="HRTF",this.panner.connect(this.gain)}connect(){return super.connect(),this.panner.connect(this.gain),this}disconnect(){return super.disconnect(),this.panner.disconnect(this.gain),this}getOutput(){return this.panner}getRefDistance(){return this.panner.refDistance}setRefDistance(e){return this.panner.refDistance=e,this}getRolloffFactor(){return this.panner.rolloffFactor}setRolloffFactor(e){return this.panner.rolloffFactor=e,this}getDistanceModel(){return this.panner.distanceModel}setDistanceModel(e){return this.panner.distanceModel=e,this}getMaxDistance(){return this.panner.maxDistance}setMaxDistance(e){return this.panner.maxDistance=e,this}setDirectionalCone(e,n,i){return this.panner.coneInnerAngle=e,this.panner.coneOuterAngle=n,this.panner.coneOuterGain=i,this}updateMatrixWorld(e){if(super.updateMatrixWorld(e),this.hasPlaybackControl===!0&&this.isPlaying===!1)return;this.matrixWorld.decompose(zS,ZJ,KRe),jS.set(0,0,1).applyQuaternion(ZJ);const n=this.panner;if(n.positionX){const i=this.context.currentTime+this.listener.timeDelta;n.positionX.linearRampToValueAtTime(zS.x,i),n.positionY.linearRampToValueAtTime(zS.y,i),n.positionZ.linearRampToValueAtTime(zS.z,i),n.orientationX.linearRampToValueAtTime(jS.x,i),n.orientationY.linearRampToValueAtTime(jS.y,i),n.orientationZ.linearRampToValueAtTime(jS.z,i)}else n.setPosition(zS.x,zS.y,zS.z),n.setOrientation(jS.x,jS.y,jS.z)}}class ZRe{constructor(e,n=2048){this.analyser=e.context.createAnalyser(),this.analyser.fftSize=n,this.data=new Uint8Array(this.analyser.frequencyBinCount),e.getOutput().connect(this.analyser)}getFrequencyData(){return this.analyser.getByteFrequencyData(this.data),this.data}getAverageFrequency(){let e=0;const n=this.getFrequencyData();for(let i=0;i<n.length;i++)e+=n[i];return e/n.length}}class Vue{constructor(e,n,i){this.binding=e,this.valueSize=i;let r,s,a;switch(n){case"quaternion":r=this._slerp,s=this._slerpAdditive,a=this._setAdditiveIdentityQuaternion,this.buffer=new Float64Array(i*6),this._workIndex=5;break;case"string":case"bool":r=this._select,s=this._select,a=this._setAdditiveIdentityOther,this.buffer=new Array(i*5);break;default:r=this._lerp,s=this._lerpAdditive,a=this._setAdditiveIdentityNumeric,this.buffer=new Float64Array(i*5)}this._mixBufferRegion=r,this._mixBufferRegionAdditive=s,this._setIdentity=a,this._origIndex=3,this._addIndex=4,this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,this.useCount=0,this.referenceCount=0}accumulate(e,n){const i=this.buffer,r=this.valueSize,s=e*r+r;let a=this.cumulativeWeight;if(a===0){for(let o=0;o!==r;++o)i[s+o]=i[o];a=n}else{a+=n;const o=n/a;this._mixBufferRegion(i,s,0,o,r)}this.cumulativeWeight=a}accumulateAdditive(e){const n=this.buffer,i=this.valueSize,r=i*this._addIndex;this.cumulativeWeightAdditive===0&&this._setIdentity(),this._mixBufferRegionAdditive(n,r,0,e,i),this.cumulativeWeightAdditive+=e}apply(e){const n=this.valueSize,i=this.buffer,r=e*n+n,s=this.cumulativeWeight,a=this.cumulativeWeightAdditive,o=this.binding;if(this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,s<1){const c=n*this._origIndex;this._mixBufferRegion(i,r,c,1-s,n)}a>0&&this._mixBufferRegionAdditive(i,r,this._addIndex*n,1,n);for(let c=n,l=n+n;c!==l;++c)if(i[c]!==i[c+n]){o.setValue(i,r);break}}saveOriginalState(){const e=this.binding,n=this.buffer,i=this.valueSize,r=i*this._origIndex;e.getValue(n,r);for(let s=i,a=r;s!==a;++s)n[s]=n[r+s%i];this._setIdentity(),this.cumulativeWeight=0,this.cumulativeWeightAdditive=0}restoreOriginalState(){const e=this.valueSize*3;this.binding.setValue(this.buffer,e)}_setAdditiveIdentityNumeric(){const e=this._addIndex*this.valueSize,n=e+this.valueSize;for(let i=e;i<n;i++)this.buffer[i]=0}_setAdditiveIdentityQuaternion(){this._setAdditiveIdentityNumeric(),this.buffer[this._addIndex*this.valueSize+3]=1}_setAdditiveIdentityOther(){const e=this._origIndex*this.valueSize,n=this._addIndex*this.valueSize;for(let i=0;i<this.valueSize;i++)this.buffer[n+i]=this.buffer[e+i]}_select(e,n,i,r,s){if(r>=.5)for(let a=0;a!==s;++a)e[n+a]=e[i+a]}_slerp(e,n,i,r){mh.slerpFlat(e,n,e,n,e,i,r)}_slerpAdditive(e,n,i,r,s){const a=this._workIndex*s;mh.multiplyQuaternionsFlat(e,a,e,n,e,i),mh.slerpFlat(e,n,e,n,e,a,r)}_lerp(e,n,i,r,s){const a=1-r;for(let o=0;o!==s;++o){const c=n+o;e[c]=e[c]*a+e[i+o]*r}}_lerpAdditive(e,n,i,r,s){for(let a=0;a!==s;++a){const o=n+a;e[o]=e[o]+e[i+a]*r}}}const bW="\\[\\]\\.:\\/",JRe=new RegExp("["+bW+"]","g"),EW="[^"+bW+"]",QRe="[^"+bW.replace("\\.","")+"]",eMe=/((?:WC+[\/:])*)/.source.replace("WC",EW),tMe=/(WCOD+)?/.source.replace("WCOD",QRe),nMe=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",EW),iMe=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",EW),rMe=new RegExp("^"+eMe+tMe+nMe+iMe+"$"),sMe=["material","materials","bones","map"];class aMe{constructor(e,n,i){const r=i||Jr.parseTrackName(n);this._targetGroup=e,this._bindings=e.subscribe_(n,r)}getValue(e,n){this.bind();const i=this._targetGroup.nCachedObjects_,r=this._bindings[i];r!==void 0&&r.getValue(e,n)}setValue(e,n){const i=this._bindings;for(let r=this._targetGroup.nCachedObjects_,s=i.length;r!==s;++r)i[r].setValue(e,n)}bind(){const e=this._bindings;for(let n=this._targetGroup.nCachedObjects_,i=e.length;n!==i;++n)e[n].bind()}unbind(){const e=this._bindings;for(let n=this._targetGroup.nCachedObjects_,i=e.length;n!==i;++n)e[n].unbind()}}class Jr{constructor(e,n,i){this.path=n,this.parsedPath=i||Jr.parseTrackName(n),this.node=Jr.findNode(e,this.parsedPath.nodeName),this.rootNode=e,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}static create(e,n,i){return e&&e.isAnimationObjectGroup?new Jr.Composite(e,n,i):new Jr(e,n,i)}static sanitizeNodeName(e){return e.replace(/\s/g,"_").replace(JRe,"")}static parseTrackName(e){const n=rMe.exec(e);if(n===null)throw new Error("PropertyBinding: Cannot parse trackName: "+e);const i={nodeName:n[2],objectName:n[3],objectIndex:n[4],propertyName:n[5],propertyIndex:n[6]},r=i.nodeName&&i.nodeName.lastIndexOf(".");if(r!==void 0&&r!==-1){const s=i.nodeName.substring(r+1);sMe.indexOf(s)!==-1&&(i.nodeName=i.nodeName.substring(0,r),i.objectName=s)}if(i.propertyName===null||i.propertyName.length===0)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+e);return i}static findNode(e,n){if(n===void 0||n===""||n==="."||n===-1||n===e.name||n===e.uuid)return e;if(e.skeleton){const i=e.skeleton.getBoneByName(n);if(i!==void 0)return i}if(e.children){const i=function(s){for(let a=0;a<s.length;a++){const o=s[a];if(o.name===n||o.uuid===n)return o;const c=i(o.children);if(c)return c}return null},r=i(e.children);if(r)return r}return null}_getValue_unavailable(){}_setValue_unavailable(){}_getValue_direct(e,n){e[n]=this.targetObject[this.propertyName]}_getValue_array(e,n){const i=this.resolvedProperty;for(let r=0,s=i.length;r!==s;++r)e[n++]=i[r]}_getValue_arrayElement(e,n){e[n]=this.resolvedProperty[this.propertyIndex]}_getValue_toArray(e,n){this.resolvedProperty.toArray(e,n)}_setValue_direct(e,n){this.targetObject[this.propertyName]=e[n]}_setValue_direct_setNeedsUpdate(e,n){this.targetObject[this.propertyName]=e[n],this.targetObject.needsUpdate=!0}_setValue_direct_setMatrixWorldNeedsUpdate(e,n){this.targetObject[this.propertyName]=e[n],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_array(e,n){const i=this.resolvedProperty;for(let r=0,s=i.length;r!==s;++r)i[r]=e[n++]}_setValue_array_setNeedsUpdate(e,n){const i=this.resolvedProperty;for(let r=0,s=i.length;r!==s;++r)i[r]=e[n++];this.targetObject.needsUpdate=!0}_setValue_array_setMatrixWorldNeedsUpdate(e,n){const i=this.resolvedProperty;for(let r=0,s=i.length;r!==s;++r)i[r]=e[n++];this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_arrayElement(e,n){this.resolvedProperty[this.propertyIndex]=e[n]}_setValue_arrayElement_setNeedsUpdate(e,n){this.resolvedProperty[this.propertyIndex]=e[n],this.targetObject.needsUpdate=!0}_setValue_arrayElement_setMatrixWorldNeedsUpdate(e,n){this.resolvedProperty[this.propertyIndex]=e[n],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_fromArray(e,n){this.resolvedProperty.fromArray(e,n)}_setValue_fromArray_setNeedsUpdate(e,n){this.resolvedProperty.fromArray(e,n),this.targetObject.needsUpdate=!0}_setValue_fromArray_setMatrixWorldNeedsUpdate(e,n){this.resolvedProperty.fromArray(e,n),this.targetObject.matrixWorldNeedsUpdate=!0}_getValue_unbound(e,n){this.bind(),this.getValue(e,n)}_setValue_unbound(e,n){this.bind(),this.setValue(e,n)}bind(){let e=this.node;const n=this.parsedPath,i=n.objectName,r=n.propertyName;let s=n.propertyIndex;if(e||(e=Jr.findNode(this.rootNode,n.nodeName),this.node=e),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!e){console.warn("THREE.PropertyBinding: No target node found for track: "+this.path+".");return}if(i){let l=n.objectIndex;switch(i){case"materials":if(!e.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!e.material.materials){console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);return}e=e.material.materials;break;case"bones":if(!e.skeleton){console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);return}e=e.skeleton.bones;for(let u=0;u<e.length;u++)if(e[u].name===l){l=u;break}break;case"map":if("map"in e){e=e.map;break}if(!e.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!e.material.map){console.error("THREE.PropertyBinding: Can not bind to material.map as node.material does not have a map.",this);return}e=e.material.map;break;default:if(e[i]===void 0){console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);return}e=e[i]}if(l!==void 0){if(e[l]===void 0){console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,e);return}e=e[l]}}const a=e[r];if(a===void 0){const l=n.nodeName;console.error("THREE.PropertyBinding: Trying to update property for track: "+l+"."+r+" but it wasn't found.",e);return}let o=this.Versioning.None;this.targetObject=e,e.isMaterial===!0?o=this.Versioning.NeedsUpdate:e.isObject3D===!0&&(o=this.Versioning.MatrixWorldNeedsUpdate);let c=this.BindingType.Direct;if(s!==void 0){if(r==="morphTargetInfluences"){if(!e.geometry){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);return}if(!e.geometry.morphAttributes){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);return}e.morphTargetDictionary[s]!==void 0&&(s=e.morphTargetDictionary[s])}c=this.BindingType.ArrayElement,this.resolvedProperty=a,this.propertyIndex=s}else a.fromArray!==void 0&&a.toArray!==void 0?(c=this.BindingType.HasFromToArray,this.resolvedProperty=a):Array.isArray(a)?(c=this.BindingType.EntireArray,this.resolvedProperty=a):this.propertyName=r;this.getValue=this.GetterByBindingType[c],this.setValue=this.SetterByBindingTypeAndVersioning[c][o]}unbind(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}Jr.Composite=aMe;Jr.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3};Jr.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2};Jr.prototype.GetterByBindingType=[Jr.prototype._getValue_direct,Jr.prototype._getValue_array,Jr.prototype._getValue_arrayElement,Jr.prototype._getValue_toArray];Jr.prototype.SetterByBindingTypeAndVersioning=[[Jr.prototype._setValue_direct,Jr.prototype._setValue_direct_setNeedsUpdate,Jr.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[Jr.prototype._setValue_array,Jr.prototype._setValue_array_setNeedsUpdate,Jr.prototype._setValue_array_setMatrixWorldNeedsUpdate],[Jr.prototype._setValue_arrayElement,Jr.prototype._setValue_arrayElement_setNeedsUpdate,Jr.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[Jr.prototype._setValue_fromArray,Jr.prototype._setValue_fromArray_setNeedsUpdate,Jr.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]];class oMe{constructor(){this.isAnimationObjectGroup=!0,this.uuid=cf(),this._objects=Array.prototype.slice.call(arguments),this.nCachedObjects_=0;const e={};this._indicesByUUID=e;for(let i=0,r=arguments.length;i!==r;++i)e[arguments[i].uuid]=i;this._paths=[],this._parsedPaths=[],this._bindings=[],this._bindingsIndicesByPath={};const n=this;this.stats={objects:{get total(){return n._objects.length},get inUse(){return this.total-n.nCachedObjects_}},get bindingsPerObject(){return n._bindings.length}}}add(){const e=this._objects,n=this._indicesByUUID,i=this._paths,r=this._parsedPaths,s=this._bindings,a=s.length;let o,c=e.length,l=this.nCachedObjects_;for(let u=0,h=arguments.length;u!==h;++u){const d=arguments[u],f=d.uuid;let p=n[f];if(p===void 0){p=c++,n[f]=p,e.push(d);for(let g=0,_=a;g!==_;++g)s[g].push(new Jr(d,i[g],r[g]))}else if(p<l){o=e[p];const g=--l,_=e[g];n[_.uuid]=p,e[p]=_,n[f]=g,e[g]=d;for(let v=0,b=a;v!==b;++v){const S=s[v],x=S[g];let M=S[p];S[p]=x,M===void 0&&(M=new Jr(d,i[v],r[v])),S[g]=M}}else e[p]!==o&&console.error("THREE.AnimationObjectGroup: Different objects with the same UUID detected. Clean the caches or recreate your infrastructure when reloading scenes.")}this.nCachedObjects_=l}remove(){const e=this._objects,n=this._indicesByUUID,i=this._bindings,r=i.length;let s=this.nCachedObjects_;for(let a=0,o=arguments.length;a!==o;++a){const c=arguments[a],l=c.uuid,u=n[l];if(u!==void 0&&u>=s){const h=s++,d=e[h];n[d.uuid]=u,e[u]=d,n[l]=h,e[h]=c;for(let f=0,p=r;f!==p;++f){const g=i[f],_=g[h],v=g[u];g[u]=_,g[h]=v}}}this.nCachedObjects_=s}uncache(){const e=this._objects,n=this._indicesByUUID,i=this._bindings,r=i.length;let s=this.nCachedObjects_,a=e.length;for(let o=0,c=arguments.length;o!==c;++o){const l=arguments[o],u=l.uuid,h=n[u];if(h!==void 0)if(delete n[u],h<s){const d=--s,f=e[d],p=--a,g=e[p];n[f.uuid]=h,e[h]=f,n[g.uuid]=d,e[d]=g,e.pop();for(let _=0,v=r;_!==v;++_){const b=i[_],S=b[d],x=b[p];b[h]=S,b[d]=x,b.pop()}}else{const d=--a,f=e[d];d>0&&(n[f.uuid]=h),e[h]=f,e.pop();for(let p=0,g=r;p!==g;++p){const _=i[p];_[h]=_[d],_.pop()}}}this.nCachedObjects_=s}subscribe_(e,n){const i=this._bindingsIndicesByPath;let r=i[e];const s=this._bindings;if(r!==void 0)return s[r];const a=this._paths,o=this._parsedPaths,c=this._objects,l=c.length,u=this.nCachedObjects_,h=new Array(l);r=s.length,i[e]=r,a.push(e),o.push(n),s.push(h);for(let d=u,f=c.length;d!==f;++d){const p=c[d];h[d]=new Jr(p,e,n)}return h}unsubscribe_(e){const n=this._bindingsIndicesByPath,i=n[e];if(i!==void 0){const r=this._paths,s=this._parsedPaths,a=this._bindings,o=a.length-1,c=a[o],l=e[o];n[l]=i,a[i]=c,a.pop(),s[i]=s[o],s.pop(),r[i]=r[o],r.pop()}}}class Gue{constructor(e,n,i=null,r=n.blendMode){this._mixer=e,this._clip=n,this._localRoot=i,this.blendMode=r;const s=n.tracks,a=s.length,o=new Array(a),c={endingStart:gT,endingEnd:gT};for(let l=0;l!==a;++l){const u=s[l].createInterpolant(null);o[l]=u,u.settings=c}this._interpolantSettings=c,this._interpolants=o,this._propertyBindings=new Array(a),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=Ole,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}play(){return this._mixer._activateAction(this),this}stop(){return this._mixer._deactivateAction(this),this.reset()}reset(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()}isRunning(){return this.enabled&&!this.paused&&this.timeScale!==0&&this._startTime===null&&this._mixer._isActiveAction(this)}isScheduled(){return this._mixer._isActiveAction(this)}startAt(e){return this._startTime=e,this}setLoop(e,n){return this.loop=e,this.repetitions=n,this}setEffectiveWeight(e){return this.weight=e,this._effectiveWeight=this.enabled?e:0,this.stopFading()}getEffectiveWeight(){return this._effectiveWeight}fadeIn(e){return this._scheduleFading(e,0,1)}fadeOut(e){return this._scheduleFading(e,1,0)}crossFadeFrom(e,n,i=!1){if(e.fadeOut(n),this.fadeIn(n),i===!0){const r=this._clip.duration,s=e._clip.duration,a=s/r,o=r/s;e.warp(1,a,n),this.warp(o,1,n)}return this}crossFadeTo(e,n,i=!1){return e.crossFadeFrom(this,n,i)}stopFading(){const e=this._weightInterpolant;return e!==null&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}setEffectiveTimeScale(e){return this.timeScale=e,this._effectiveTimeScale=this.paused?0:e,this.stopWarping()}getEffectiveTimeScale(){return this._effectiveTimeScale}setDuration(e){return this.timeScale=this._clip.duration/e,this.stopWarping()}syncWith(e){return this.time=e.time,this.timeScale=e.timeScale,this.stopWarping()}halt(e){return this.warp(this._effectiveTimeScale,0,e)}warp(e,n,i){const r=this._mixer,s=r.time,a=this.timeScale;let o=this._timeScaleInterpolant;o===null&&(o=r._lendControlInterpolant(),this._timeScaleInterpolant=o);const c=o.parameterPositions,l=o.sampleValues;return c[0]=s,c[1]=s+i,l[0]=e/a,l[1]=n/a,this}stopWarping(){const e=this._timeScaleInterpolant;return e!==null&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}getMixer(){return this._mixer}getClip(){return this._clip}getRoot(){return this._localRoot||this._mixer._root}_update(e,n,i,r){if(!this.enabled){this._updateWeight(e);return}const s=this._startTime;if(s!==null){const c=(e-s)*i;c<0||i===0?n=0:(this._startTime=null,n=i*c)}n*=this._updateTimeScale(e);const a=this._updateTime(n),o=this._updateWeight(e);if(o>0){const c=this._interpolants,l=this._propertyBindings;switch(this.blendMode){case K7:for(let u=0,h=c.length;u!==h;++u)c[u].evaluate(a),l[u].accumulateAdditive(o);break;case iF:default:for(let u=0,h=c.length;u!==h;++u)c[u].evaluate(a),l[u].accumulate(r,o)}}}_updateWeight(e){let n=0;if(this.enabled){n=this.weight;const i=this._weightInterpolant;if(i!==null){const r=i.evaluate(e)[0];n*=r,e>i.parameterPositions[1]&&(this.stopFading(),r===0&&(this.enabled=!1))}}return this._effectiveWeight=n,n}_updateTimeScale(e){let n=0;if(!this.paused){n=this.timeScale;const i=this._timeScaleInterpolant;if(i!==null){const r=i.evaluate(e)[0];n*=r,e>i.parameterPositions[1]&&(this.stopWarping(),n===0?this.paused=!0:this.timeScale=n)}}return this._effectiveTimeScale=n,n}_updateTime(e){const n=this._clip.duration,i=this.loop;let r=this.time+e,s=this._loopCount;const a=i===Nle;if(e===0)return s===-1?r:a&&(s&1)===1?n-r:r;if(i===Mle){s===-1&&(this._loopCount=0,this._setEndings(!0,!0,!1));e:{if(r>=n)r=n;else if(r<0)r=0;else{this.time=r;break e}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=r,this._mixer.dispatchEvent({type:"finished",action:this,direction:e<0?-1:1})}}else{if(s===-1&&(e>=0?(s=0,this._setEndings(!0,this.repetitions===0,a)):this._setEndings(this.repetitions===0,!0,a)),r>=n||r<0){const o=Math.floor(r/n);r-=n*o,s+=Math.abs(o);const c=this.repetitions-s;if(c<=0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,r=e>0?n:0,this.time=r,this._mixer.dispatchEvent({type:"finished",action:this,direction:e>0?1:-1});else{if(c===1){const l=e<0;this._setEndings(l,!l,a)}else this._setEndings(!1,!1,a);this._loopCount=s,this.time=r,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:o})}}else this.time=r;if(a&&(s&1)===1)return n-r}return r}_setEndings(e,n,i){const r=this._interpolantSettings;i?(r.endingStart=vT,r.endingEnd=vT):(e?r.endingStart=this.zeroSlopeAtStart?vT:gT:r.endingStart=WO,n?r.endingEnd=this.zeroSlopeAtEnd?vT:gT:r.endingEnd=WO)}_scheduleFading(e,n,i){const r=this._mixer,s=r.time;let a=this._weightInterpolant;a===null&&(a=r._lendControlInterpolant(),this._weightInterpolant=a);const o=a.parameterPositions,c=a.sampleValues;return o[0]=s,c[0]=n,o[1]=s+e,c[1]=i,this}}const cMe=new Float32Array(1);class lMe extends _f{constructor(e){super(),this._root=e,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1}_bindAction(e,n){const i=e._localRoot||this._root,r=e._clip.tracks,s=r.length,a=e._propertyBindings,o=e._interpolants,c=i.uuid,l=this._bindingsByRootAndName;let u=l[c];u===void 0&&(u={},l[c]=u);for(let h=0;h!==s;++h){const d=r[h],f=d.name;let p=u[f];if(p!==void 0)++p.referenceCount,a[h]=p;else{if(p=a[h],p!==void 0){p._cacheIndex===null&&(++p.referenceCount,this._addInactiveBinding(p,c,f));continue}const g=n&&n._propertyBindings[h].binding.parsedPath;p=new Vue(Jr.create(i,f,g),d.ValueTypeName,d.getValueSize()),++p.referenceCount,this._addInactiveBinding(p,c,f),a[h]=p}o[h].resultBuffer=p.buffer}}_activateAction(e){if(!this._isActiveAction(e)){if(e._cacheIndex===null){const i=(e._localRoot||this._root).uuid,r=e._clip.uuid,s=this._actionsByClip[r];this._bindAction(e,s&&s.knownActions[0]),this._addInactiveAction(e,r,i)}const n=e._propertyBindings;for(let i=0,r=n.length;i!==r;++i){const s=n[i];s.useCount++===0&&(this._lendBinding(s),s.saveOriginalState())}this._lendAction(e)}}_deactivateAction(e){if(this._isActiveAction(e)){const n=e._propertyBindings;for(let i=0,r=n.length;i!==r;++i){const s=n[i];--s.useCount===0&&(s.restoreOriginalState(),this._takeBackBinding(s))}this._takeBackAction(e)}}_initMemoryManager(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;const e=this;this.stats={actions:{get total(){return e._actions.length},get inUse(){return e._nActiveActions}},bindings:{get total(){return e._bindings.length},get inUse(){return e._nActiveBindings}},controlInterpolants:{get total(){return e._controlInterpolants.length},get inUse(){return e._nActiveControlInterpolants}}}}_isActiveAction(e){const n=e._cacheIndex;return n!==null&&n<this._nActiveActions}_addInactiveAction(e,n,i){const r=this._actions,s=this._actionsByClip;let a=s[n];if(a===void 0)a={knownActions:[e],actionByRoot:{}},e._byClipCacheIndex=0,s[n]=a;else{const o=a.knownActions;e._byClipCacheIndex=o.length,o.push(e)}e._cacheIndex=r.length,r.push(e),a.actionByRoot[i]=e}_removeInactiveAction(e){const n=this._actions,i=n[n.length-1],r=e._cacheIndex;i._cacheIndex=r,n[r]=i,n.pop(),e._cacheIndex=null;const s=e._clip.uuid,a=this._actionsByClip,o=a[s],c=o.knownActions,l=c[c.length-1],u=e._byClipCacheIndex;l._byClipCacheIndex=u,c[u]=l,c.pop(),e._byClipCacheIndex=null;const h=o.actionByRoot,d=(e._localRoot||this._root).uuid;delete h[d],c.length===0&&delete a[s],this._removeInactiveBindingsForAction(e)}_removeInactiveBindingsForAction(e){const n=e._propertyBindings;for(let i=0,r=n.length;i!==r;++i){const s=n[i];--s.referenceCount===0&&this._removeInactiveBinding(s)}}_lendAction(e){const n=this._actions,i=e._cacheIndex,r=this._nActiveActions++,s=n[r];e._cacheIndex=r,n[r]=e,s._cacheIndex=i,n[i]=s}_takeBackAction(e){const n=this._actions,i=e._cacheIndex,r=--this._nActiveActions,s=n[r];e._cacheIndex=r,n[r]=e,s._cacheIndex=i,n[i]=s}_addInactiveBinding(e,n,i){const r=this._bindingsByRootAndName,s=this._bindings;let a=r[n];a===void 0&&(a={},r[n]=a),a[i]=e,e._cacheIndex=s.length,s.push(e)}_removeInactiveBinding(e){const n=this._bindings,i=e.binding,r=i.rootNode.uuid,s=i.path,a=this._bindingsByRootAndName,o=a[r],c=n[n.length-1],l=e._cacheIndex;c._cacheIndex=l,n[l]=c,n.pop(),delete o[s],Object.keys(o).length===0&&delete a[r]}_lendBinding(e){const n=this._bindings,i=e._cacheIndex,r=this._nActiveBindings++,s=n[r];e._cacheIndex=r,n[r]=e,s._cacheIndex=i,n[i]=s}_takeBackBinding(e){const n=this._bindings,i=e._cacheIndex,r=--this._nActiveBindings,s=n[r];e._cacheIndex=r,n[r]=e,s._cacheIndex=i,n[i]=s}_lendControlInterpolant(){const e=this._controlInterpolants,n=this._nActiveControlInterpolants++;let i=e[n];return i===void 0&&(i=new pW(new Float32Array(2),new Float32Array(2),1,cMe),i.__cacheIndex=n,e[n]=i),i}_takeBackControlInterpolant(e){const n=this._controlInterpolants,i=e.__cacheIndex,r=--this._nActiveControlInterpolants,s=n[r];e.__cacheIndex=r,n[r]=e,s.__cacheIndex=i,n[i]=s}clipAction(e,n,i){const r=n||this._root,s=r.uuid;let a=typeof e=="string"?iN.findByName(r,e):e;const o=a!==null?a.uuid:e,c=this._actionsByClip[o];let l=null;if(i===void 0&&(a!==null?i=a.blendMode:i=iF),c!==void 0){const h=c.actionByRoot[s];if(h!==void 0&&h.blendMode===i)return h;l=c.knownActions[0],a===null&&(a=l._clip)}if(a===null)return null;const u=new Gue(this,a,n,i);return this._bindAction(u,l),this._addInactiveAction(u,o,s),u}existingAction(e,n){const i=n||this._root,r=i.uuid,s=typeof e=="string"?iN.findByName(i,e):e,a=s?s.uuid:e,o=this._actionsByClip[a];return o!==void 0&&o.actionByRoot[r]||null}stopAllAction(){const e=this._actions,n=this._nActiveActions;for(let i=n-1;i>=0;--i)e[i].stop();return this}update(e){e*=this.timeScale;const n=this._actions,i=this._nActiveActions,r=this.time+=e,s=Math.sign(e),a=this._accuIndex^=1;for(let l=0;l!==i;++l)n[l]._update(r,e,s,a);const o=this._bindings,c=this._nActiveBindings;for(let l=0;l!==c;++l)o[l].apply(a);return this}setTime(e){this.time=0;for(let n=0;n<this._actions.length;n++)this._actions[n].time=0;return this.update(e)}getRoot(){return this._root}uncacheClip(e){const n=this._actions,i=e.uuid,r=this._actionsByClip,s=r[i];if(s!==void 0){const a=s.knownActions;for(let o=0,c=a.length;o!==c;++o){const l=a[o];this._deactivateAction(l);const u=l._cacheIndex,h=n[n.length-1];l._cacheIndex=null,l._byClipCacheIndex=null,h._cacheIndex=u,n[u]=h,n.pop(),this._removeInactiveBindingsForAction(l)}delete r[i]}}uncacheRoot(e){const n=e.uuid,i=this._actionsByClip;for(const a in i){const o=i[a].actionByRoot,c=o[n];c!==void 0&&(this._deactivateAction(c),this._removeInactiveAction(c))}const r=this._bindingsByRootAndName,s=r[n];if(s!==void 0)for(const a in s){const o=s[a];o.restoreOriginalState(),this._removeInactiveBinding(o)}}uncacheAction(e,n){const i=this.existingAction(e,n);i!==null&&(this._deactivateAction(i),this._removeInactiveAction(i))}}class uMe extends rF{constructor(e=1,n=1,i=1,r={}){super(e,n,r),this.isRenderTarget3D=!0,this.depth=i,this.texture=new sF(null,e,n,i),this.texture.isRenderTargetTexture=!0}}class hMe extends rF{constructor(e=1,n=1,i=1,r={}){super(e,n,r),this.isRenderTargetArray=!0,this.depth=i,this.texture=new PI(null,e,n,i),this.texture.isRenderTargetTexture=!0}}class vn{constructor(e){this.value=e}clone(){return new vn(this.value.clone===void 0?this.value:this.value.clone())}}let dMe=0;class fMe extends _f{constructor(){super(),this.isUniformsGroup=!0,Object.defineProperty(this,"id",{value:dMe++}),this.name="",this.usage=KO,this.uniforms=[]}add(e){return this.uniforms.push(e),this}remove(e){const n=this.uniforms.indexOf(e);return n!==-1&&this.uniforms.splice(n,1),this}setName(e){return this.name=e,this}setUsage(e){return this.usage=e,this}dispose(){this.dispatchEvent({type:"dispose"})}copy(e){this.name=e.name,this.usage=e.usage;const n=e.uniforms;this.uniforms.length=0;for(let i=0,r=n.length;i<r;i++){const s=Array.isArray(n[i])?n[i]:[n[i]];for(let a=0;a<s.length;a++)this.uniforms.push(s[a].clone())}return this}clone(){return new this.constructor().copy(this)}}class pMe extends cF{constructor(e,n,i=1){super(e,n),this.isInstancedInterleavedBuffer=!0,this.meshPerAttribute=i}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}clone(e){const n=super.clone(e);return n.meshPerAttribute=this.meshPerAttribute,n}toJSON(e){const n=super.toJSON(e);return n.isInstancedInterleavedBuffer=!0,n.meshPerAttribute=this.meshPerAttribute,n}}class mMe{constructor(e,n,i,r,s){this.isGLBufferAttribute=!0,this.name="",this.buffer=e,this.type=n,this.itemSize=i,this.elementSize=r,this.count=s,this.version=0}set needsUpdate(e){e===!0&&this.version++}setBuffer(e){return this.buffer=e,this}setType(e,n){return this.type=e,this.elementSize=n,this}setItemSize(e){return this.itemSize=e,this}setCount(e){return this.count=e,this}}const JJ=new gi;class SW{constructor(e,n,i=0,r=1/0){this.ray=new XA(e,n),this.near=i,this.far=r,this.camera=null,this.layers=new jC,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}}}set(e,n){this.ray.set(e,n)}setFromCamera(e,n){n.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(n.matrixWorld),this.ray.direction.set(e.x,e.y,.5).unproject(n).sub(this.ray.origin).normalize(),this.camera=n):n.isOrthographicCamera?(this.ray.origin.set(e.x,e.y,(n.near+n.far)/(n.near-n.far)).unproject(n),this.ray.direction.set(0,0,-1).transformDirection(n.matrixWorld),this.camera=n):console.error("THREE.Raycaster: Unsupported camera type: "+n.type)}setFromXRController(e){return JJ.identity().extractRotation(e.matrixWorld),this.ray.origin.setFromMatrixPosition(e.matrixWorld),this.ray.direction.set(0,0,-1).applyMatrix4(JJ),this}intersectObject(e,n=!0,i=[]){return sG(e,this,i,n),i.sort(QJ),i}intersectObjects(e,n=!0,i=[]){for(let r=0,s=e.length;r<s;r++)sG(e[r],this,i,n);return i.sort(QJ),i}}function QJ(t,e){return t.distance-e.distance}function sG(t,e,n,i){let r=!0;if(t.layers.test(e.layers)&&t.raycast(e,n)===!1&&(r=!1),r===!0&&i===!0){const s=t.children;for(let a=0,o=s.length;a<o;a++)sG(s[a],e,n,!0)}}class gMe{constructor(e=1,n=0,i=0){this.radius=e,this.phi=n,this.theta=i}set(e,n,i){return this.radius=e,this.phi=n,this.theta=i,this}copy(e){return this.radius=e.radius,this.phi=e.phi,this.theta=e.theta,this}makeSafe(){return this.phi=Ki(this.phi,1e-6,Math.PI-1e-6),this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,n,i){return this.radius=Math.sqrt(e*e+n*n+i*i),this.radius===0?(this.theta=0,this.phi=0):(this.theta=Math.atan2(e,i),this.phi=Math.acos(Ki(n/this.radius,-1,1))),this}clone(){return new this.constructor().copy(this)}}class vMe{constructor(e=1,n=0,i=0){this.radius=e,this.theta=n,this.y=i}set(e,n,i){return this.radius=e,this.theta=n,this.y=i,this}copy(e){return this.radius=e.radius,this.theta=e.theta,this.y=e.y,this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,n,i){return this.radius=Math.sqrt(e*e+i*i),this.theta=Math.atan2(e,i),this.y=n,this}clone(){return new this.constructor().copy(this)}}class TW{constructor(e,n,i,r){TW.prototype.isMatrix2=!0,this.elements=[1,0,0,1],e!==void 0&&this.set(e,n,i,r)}identity(){return this.set(1,0,0,1),this}fromArray(e,n=0){for(let i=0;i<4;i++)this.elements[i]=e[i+n];return this}set(e,n,i,r){const s=this.elements;return s[0]=e,s[2]=n,s[1]=i,s[3]=r,this}}const eQ=new xt;class que{constructor(e=new xt(1/0,1/0),n=new xt(-1/0,-1/0)){this.isBox2=!0,this.min=e,this.max=n}set(e,n){return this.min.copy(e),this.max.copy(n),this}setFromPoints(e){this.makeEmpty();for(let n=0,i=e.length;n<i;n++)this.expandByPoint(e[n]);return this}setFromCenterAndSize(e,n){const i=eQ.copy(n).multiplyScalar(.5);return this.min.copy(e).sub(i),this.max.copy(e).add(i),this}clone(){return new this.constructor().copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y}getCenter(e){return this.isEmpty()?e.set(0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}containsPoint(e){return e.x>=this.min.x&&e.x<=this.max.x&&e.y>=this.min.y&&e.y<=this.max.y}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y}getParameter(e,n){return n.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y))}intersectsBox(e){return e.max.x>=this.min.x&&e.min.x<=this.max.x&&e.max.y>=this.min.y&&e.min.y<=this.max.y}clampPoint(e,n){return n.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return this.clampPoint(e,eQ).distanceTo(e)}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}const tQ=new Oe,cD=new Oe;class _Me{constructor(e=new Oe,n=new Oe){this.start=e,this.end=n}set(e,n){return this.start.copy(e),this.end.copy(n),this}copy(e){return this.start.copy(e.start),this.end.copy(e.end),this}getCenter(e){return e.addVectors(this.start,this.end).multiplyScalar(.5)}delta(e){return e.subVectors(this.end,this.start)}distanceSq(){return this.start.distanceToSquared(this.end)}distance(){return this.start.distanceTo(this.end)}at(e,n){return this.delta(n).multiplyScalar(e).add(this.start)}closestPointToPointParameter(e,n){tQ.subVectors(e,this.start),cD.subVectors(this.end,this.start);const i=cD.dot(cD);let s=cD.dot(tQ)/i;return n&&(s=Ki(s,0,1)),s}closestPointToPoint(e,n,i){const r=this.closestPointToPointParameter(e,n);return this.delta(i).multiplyScalar(r).add(this.start)}applyMatrix4(e){return this.start.applyMatrix4(e),this.end.applyMatrix4(e),this}equals(e){return e.start.equals(this.start)&&e.end.equals(this.end)}clone(){return new this.constructor().copy(this)}}const nQ=new Oe;class yMe extends Wr{constructor(e,n){super(),this.light=e,this.matrixAutoUpdate=!1,this.color=n,this.type="SpotLightHelper";const i=new tr,r=[0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1];for(let a=0,o=1,c=32;a<c;a++,o++){const l=a/c*Math.PI*2,u=o/c*Math.PI*2;r.push(Math.cos(l),Math.sin(l),1,Math.cos(u),Math.sin(u),1)}i.setAttribute("position",new qn(r,3));const s=new yh({fog:!1,toneMapped:!1});this.cone=new g0(i,s),this.add(this.cone),this.update()}dispose(){this.cone.geometry.dispose(),this.cone.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.light.target.updateWorldMatrix(!0,!1),this.parent?(this.parent.updateWorldMatrix(!0),this.matrix.copy(this.parent.matrixWorld).invert().multiply(this.light.matrixWorld)):this.matrix.copy(this.light.matrixWorld),this.matrixWorld.copy(this.light.matrixWorld);const e=this.light.distance?this.light.distance:1e3,n=e*Math.tan(this.light.angle);this.cone.scale.set(n,n,e),nQ.setFromMatrixPosition(this.light.target.matrixWorld),this.cone.lookAt(nQ),this.color!==void 0?this.cone.material.color.set(this.color):this.cone.material.color.copy(this.light.color)}}const Ly=new Oe,lD=new gi,q5=new gi;class bMe extends g0{constructor(e){const n=$ue(e),i=new tr,r=[],s=[],a=new bn(0,0,1),o=new bn(0,1,0);for(let l=0;l<n.length;l++){const u=n[l];u.parent&&u.parent.isBone&&(r.push(0,0,0),r.push(0,0,0),s.push(a.r,a.g,a.b),s.push(o.r,o.g,o.b))}i.setAttribute("position",new qn(r,3)),i.setAttribute("color",new qn(s,3));const c=new yh({vertexColors:!0,depthTest:!1,depthWrite:!1,toneMapped:!1,transparent:!0});super(i,c),this.isSkeletonHelper=!0,this.type="SkeletonHelper",this.root=e,this.bones=n,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1}updateMatrixWorld(e){const n=this.bones,i=this.geometry,r=i.getAttribute("position");q5.copy(this.root.matrixWorld).invert();for(let s=0,a=0;s<n.length;s++){const o=n[s];o.parent&&o.parent.isBone&&(lD.multiplyMatrices(q5,o.matrixWorld),Ly.setFromMatrixPosition(lD),r.setXYZ(a,Ly.x,Ly.y,Ly.z),lD.multiplyMatrices(q5,o.parent.matrixWorld),Ly.setFromMatrixPosition(lD),r.setXYZ(a+1,Ly.x,Ly.y,Ly.z),a+=2)}i.getAttribute("position").needsUpdate=!0,super.updateMatrixWorld(e)}dispose(){this.geometry.dispose(),this.material.dispose()}}function $ue(t){const e=[];t.isBone===!0&&e.push(t);for(let n=0;n<t.children.length;n++)e.push(...$ue(t.children[n]));return e}class EMe extends Io{constructor(e,n,i){const r=new zI(n,4,2),s=new wE({wireframe:!0,fog:!1,toneMapped:!1});super(r,s),this.light=e,this.color=i,this.type="PointLightHelper",this.matrix=this.light.matrixWorld,this.matrixAutoUpdate=!1,this.update()}dispose(){this.geometry.dispose(),this.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.color!==void 0?this.material.color.set(this.color):this.material.color.copy(this.light.color)}}const SMe=new Oe,iQ=new bn,rQ=new bn;class TMe extends Wr{constructor(e,n,i){super(),this.light=e,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=i,this.type="HemisphereLightHelper";const r=new FI(n);r.rotateY(Math.PI*.5),this.material=new wE({wireframe:!0,fog:!1,toneMapped:!1}),this.color===void 0&&(this.material.vertexColors=!0);const s=r.getAttribute("position"),a=new Float32Array(s.count*3);r.setAttribute("color",new ar(a,3)),this.add(new Io(r,this.material)),this.update()}dispose(){this.children[0].geometry.dispose(),this.children[0].material.dispose()}update(){const e=this.children[0];if(this.color!==void 0)this.material.color.set(this.color);else{const n=e.geometry.getAttribute("color");iQ.copy(this.light.color),rQ.copy(this.light.groundColor);for(let i=0,r=n.count;i<r;i++){const s=i<r/2?iQ:rQ;n.setXYZ(i,s.r,s.g,s.b)}n.needsUpdate=!0}this.light.updateWorldMatrix(!0,!1),e.lookAt(SMe.setFromMatrixPosition(this.light.matrixWorld).negate())}}class xMe extends g0{constructor(e=10,n=10,i=4473924,r=8947848){i=new bn(i),r=new bn(r);const s=n/2,a=e/n,o=e/2,c=[],l=[];for(let d=0,f=0,p=-o;d<=n;d++,p+=a){c.push(-o,0,p,o,0,p),c.push(p,0,-o,p,0,o);const g=d===s?i:r;g.toArray(l,f),f+=3,g.toArray(l,f),f+=3,g.toArray(l,f),f+=3,g.toArray(l,f),f+=3}const u=new tr;u.setAttribute("position",new qn(c,3)),u.setAttribute("color",new qn(l,3));const h=new yh({vertexColors:!0,toneMapped:!1});super(u,h),this.type="GridHelper"}dispose(){this.geometry.dispose(),this.material.dispose()}}class wMe extends g0{constructor(e=10,n=16,i=8,r=64,s=4473924,a=8947848){s=new bn(s),a=new bn(a);const o=[],c=[];if(n>1)for(let h=0;h<n;h++){const d=h/n*(Math.PI*2),f=Math.sin(d)*e,p=Math.cos(d)*e;o.push(0,0,0),o.push(f,0,p);const g=h&1?s:a;c.push(g.r,g.g,g.b),c.push(g.r,g.g,g.b)}for(let h=0;h<i;h++){const d=h&1?s:a,f=e-e/i*h;for(let p=0;p<r;p++){let g=p/r*(Math.PI*2),_=Math.sin(g)*f,v=Math.cos(g)*f;o.push(_,0,v),c.push(d.r,d.g,d.b),g=(p+1)/r*(Math.PI*2),_=Math.sin(g)*f,v=Math.cos(g)*f,o.push(_,0,v),c.push(d.r,d.g,d.b)}}const l=new tr;l.setAttribute("position",new qn(o,3)),l.setAttribute("color",new qn(c,3));const u=new yh({vertexColors:!0,toneMapped:!1});super(l,u),this.type="PolarGridHelper"}dispose(){this.geometry.dispose(),this.material.dispose()}}const sQ=new Oe,uD=new Oe,aQ=new Oe;class CMe extends Wr{constructor(e,n,i){super(),this.light=e,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=i,this.type="DirectionalLightHelper",n===void 0&&(n=1);let r=new tr;r.setAttribute("position",new qn([-n,n,0,n,n,0,n,-n,0,-n,-n,0,-n,n,0],3));const s=new yh({fog:!1,toneMapped:!1});this.lightPlane=new tE(r,s),this.add(this.lightPlane),r=new tr,r.setAttribute("position",new qn([0,0,0,0,0,1],3)),this.targetLine=new tE(r,s),this.add(this.targetLine),this.update()}dispose(){this.lightPlane.geometry.dispose(),this.lightPlane.material.dispose(),this.targetLine.geometry.dispose(),this.targetLine.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.light.target.updateWorldMatrix(!0,!1),sQ.setFromMatrixPosition(this.light.matrixWorld),uD.setFromMatrixPosition(this.light.target.matrixWorld),aQ.subVectors(uD,sQ),this.lightPlane.lookAt(uD),this.color!==void 0?(this.lightPlane.material.color.set(this.color),this.targetLine.material.color.set(this.color)):(this.lightPlane.material.color.copy(this.light.color),this.targetLine.material.color.copy(this.light.color)),this.targetLine.lookAt(uD),this.targetLine.scale.z=aQ.length()}}const hD=new Oe,Eo=new DI;class AMe extends g0{constructor(e){const n=new tr,i=new yh({color:16777215,vertexColors:!0,toneMapped:!1}),r=[],s=[],a={};o("n1","n2"),o("n2","n4"),o("n4","n3"),o("n3","n1"),o("f1","f2"),o("f2","f4"),o("f4","f3"),o("f3","f1"),o("n1","f1"),o("n2","f2"),o("n3","f3"),o("n4","f4"),o("p","n1"),o("p","n2"),o("p","n3"),o("p","n4"),o("u1","u2"),o("u2","u3"),o("u3","u1"),o("c","t"),o("p","c"),o("cn1","cn2"),o("cn3","cn4"),o("cf1","cf2"),o("cf3","cf4");function o(p,g){c(p),c(g)}function c(p){r.push(0,0,0),s.push(0,0,0),a[p]===void 0&&(a[p]=[]),a[p].push(r.length/3-1)}n.setAttribute("position",new qn(r,3)),n.setAttribute("color",new qn(s,3)),super(n,i),this.type="CameraHelper",this.camera=e,this.camera.updateProjectionMatrix&&this.camera.updateProjectionMatrix(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=a,this.update();const l=new bn(16755200),u=new bn(16711680),h=new bn(43775),d=new bn(16777215),f=new bn(3355443);this.setColors(l,u,h,d,f)}setColors(e,n,i,r,s){const o=this.geometry.getAttribute("color");o.setXYZ(0,e.r,e.g,e.b),o.setXYZ(1,e.r,e.g,e.b),o.setXYZ(2,e.r,e.g,e.b),o.setXYZ(3,e.r,e.g,e.b),o.setXYZ(4,e.r,e.g,e.b),o.setXYZ(5,e.r,e.g,e.b),o.setXYZ(6,e.r,e.g,e.b),o.setXYZ(7,e.r,e.g,e.b),o.setXYZ(8,e.r,e.g,e.b),o.setXYZ(9,e.r,e.g,e.b),o.setXYZ(10,e.r,e.g,e.b),o.setXYZ(11,e.r,e.g,e.b),o.setXYZ(12,e.r,e.g,e.b),o.setXYZ(13,e.r,e.g,e.b),o.setXYZ(14,e.r,e.g,e.b),o.setXYZ(15,e.r,e.g,e.b),o.setXYZ(16,e.r,e.g,e.b),o.setXYZ(17,e.r,e.g,e.b),o.setXYZ(18,e.r,e.g,e.b),o.setXYZ(19,e.r,e.g,e.b),o.setXYZ(20,e.r,e.g,e.b),o.setXYZ(21,e.r,e.g,e.b),o.setXYZ(22,e.r,e.g,e.b),o.setXYZ(23,e.r,e.g,e.b),o.setXYZ(24,n.r,n.g,n.b),o.setXYZ(25,n.r,n.g,n.b),o.setXYZ(26,n.r,n.g,n.b),o.setXYZ(27,n.r,n.g,n.b),o.setXYZ(28,n.r,n.g,n.b),o.setXYZ(29,n.r,n.g,n.b),o.setXYZ(30,n.r,n.g,n.b),o.setXYZ(31,n.r,n.g,n.b),o.setXYZ(32,i.r,i.g,i.b),o.setXYZ(33,i.r,i.g,i.b),o.setXYZ(34,i.r,i.g,i.b),o.setXYZ(35,i.r,i.g,i.b),o.setXYZ(36,i.r,i.g,i.b),o.setXYZ(37,i.r,i.g,i.b),o.setXYZ(38,r.r,r.g,r.b),o.setXYZ(39,r.r,r.g,r.b),o.setXYZ(40,s.r,s.g,s.b),o.setXYZ(41,s.r,s.g,s.b),o.setXYZ(42,s.r,s.g,s.b),o.setXYZ(43,s.r,s.g,s.b),o.setXYZ(44,s.r,s.g,s.b),o.setXYZ(45,s.r,s.g,s.b),o.setXYZ(46,s.r,s.g,s.b),o.setXYZ(47,s.r,s.g,s.b),o.setXYZ(48,s.r,s.g,s.b),o.setXYZ(49,s.r,s.g,s.b),o.needsUpdate=!0}update(){const e=this.geometry,n=this.pointMap,i=1,r=1;Eo.projectionMatrixInverse.copy(this.camera.projectionMatrixInverse);const s=this.camera.coordinateSystem===lp?-1:0;jo("c",n,e,Eo,0,0,s),jo("t",n,e,Eo,0,0,1),jo("n1",n,e,Eo,-1,-1,s),jo("n2",n,e,Eo,i,-1,s),jo("n3",n,e,Eo,-1,r,s),jo("n4",n,e,Eo,i,r,s),jo("f1",n,e,Eo,-1,-1,1),jo("f2",n,e,Eo,i,-1,1),jo("f3",n,e,Eo,-1,r,1),jo("f4",n,e,Eo,i,r,1),jo("u1",n,e,Eo,i*.7,r*1.1,s),jo("u2",n,e,Eo,-1*.7,r*1.1,s),jo("u3",n,e,Eo,0,r*2,s),jo("cf1",n,e,Eo,-1,0,1),jo("cf2",n,e,Eo,i,0,1),jo("cf3",n,e,Eo,0,-1,1),jo("cf4",n,e,Eo,0,r,1),jo("cn1",n,e,Eo,-1,0,s),jo("cn2",n,e,Eo,i,0,s),jo("cn3",n,e,Eo,0,-1,s),jo("cn4",n,e,Eo,0,r,s),e.getAttribute("position").needsUpdate=!0}dispose(){this.geometry.dispose(),this.material.dispose()}}function jo(t,e,n,i,r,s,a){hD.set(r,s,a).unproject(i);const o=e[t];if(o!==void 0){const c=n.getAttribute("position");for(let l=0,u=o.length;l<u;l++)c.setXYZ(o[l],hD.x,hD.y,hD.z)}}const dD=new Su;class RMe extends g0{constructor(e,n=16776960){const i=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),r=new Float32Array(8*3),s=new tr;s.setIndex(new ar(i,1)),s.setAttribute("position",new ar(r,3)),super(s,new yh({color:n,toneMapped:!1})),this.object=e,this.type="BoxHelper",this.matrixAutoUpdate=!1,this.update()}update(){if(this.object!==void 0&&dD.setFromObject(this.object),dD.isEmpty())return;const e=dD.min,n=dD.max,i=this.geometry.attributes.position,r=i.array;r[0]=n.x,r[1]=n.y,r[2]=n.z,r[3]=e.x,r[4]=n.y,r[5]=n.z,r[6]=e.x,r[7]=e.y,r[8]=n.z,r[9]=n.x,r[10]=e.y,r[11]=n.z,r[12]=n.x,r[13]=n.y,r[14]=e.z,r[15]=e.x,r[16]=n.y,r[17]=e.z,r[18]=e.x,r[19]=e.y,r[20]=e.z,r[21]=n.x,r[22]=e.y,r[23]=e.z,i.needsUpdate=!0,this.geometry.computeBoundingSphere()}setFromObject(e){return this.object=e,this.update(),this}copy(e,n){return super.copy(e,n),this.object=e.object,this}dispose(){this.geometry.dispose(),this.material.dispose()}}class MMe extends g0{constructor(e,n=16776960){const i=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),r=[1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1],s=new tr;s.setIndex(new ar(i,1)),s.setAttribute("position",new qn(r,3)),super(s,new yh({color:n,toneMapped:!1})),this.box=e,this.type="Box3Helper",this.geometry.computeBoundingSphere()}updateMatrixWorld(e){const n=this.box;n.isEmpty()||(n.getCenter(this.position),n.getSize(this.scale),this.scale.multiplyScalar(.5),super.updateMatrixWorld(e))}dispose(){this.geometry.dispose(),this.material.dispose()}}class OMe extends tE{constructor(e,n=1,i=16776960){const r=i,s=[1,-1,0,-1,1,0,-1,-1,0,1,1,0,-1,1,0,-1,-1,0,1,-1,0,1,1,0],a=new tr;a.setAttribute("position",new qn(s,3)),a.computeBoundingSphere(),super(a,new yh({color:r,toneMapped:!1})),this.type="PlaneHelper",this.plane=e,this.size=n;const o=[1,1,0,-1,1,0,-1,-1,0,1,1,0,-1,-1,0,1,-1,0],c=new tr;c.setAttribute("position",new qn(o,3)),c.computeBoundingSphere(),this.add(new Io(c,new wE({color:r,opacity:.2,transparent:!0,depthWrite:!1,toneMapped:!1})))}updateMatrixWorld(e){this.position.set(0,0,0),this.scale.set(.5*this.size,.5*this.size,1),this.lookAt(this.plane.normal),this.translateZ(-this.plane.constant),super.updateMatrixWorld(e)}dispose(){this.geometry.dispose(),this.material.dispose(),this.children[0].geometry.dispose(),this.children[0].material.dispose()}}const oQ=new Oe;let fD,$5;class NMe extends Wr{constructor(e=new Oe(0,0,1),n=new Oe(0,0,0),i=1,r=16776960,s=i*.2,a=s*.2){super(),this.type="ArrowHelper",fD===void 0&&(fD=new tr,fD.setAttribute("position",new qn([0,0,0,0,1,0],3)),$5=new BI(.5,1,5,1),$5.translate(0,-.5,0)),this.position.copy(n),this.line=new tE(fD,new yh({color:r,toneMapped:!1})),this.line.matrixAutoUpdate=!1,this.add(this.line),this.cone=new Io($5,new wE({color:r,toneMapped:!1})),this.cone.matrixAutoUpdate=!1,this.add(this.cone),this.setDirection(e),this.setLength(i,s,a)}setDirection(e){if(e.y>.99999)this.quaternion.set(0,0,0,1);else if(e.y<-.99999)this.quaternion.set(1,0,0,0);else{oQ.set(e.z,0,-e.x).normalize();const n=Math.acos(e.y);this.quaternion.setFromAxisAngle(oQ,n)}}setLength(e,n=e*.2,i=n*.2){this.line.scale.set(1,Math.max(1e-4,e-n),1),this.line.updateMatrix(),this.cone.scale.set(i,n,i),this.cone.position.y=e,this.cone.updateMatrix()}setColor(e){this.line.material.color.set(e),this.cone.material.color.set(e)}copy(e){return super.copy(e,!1),this.line.copy(e.line),this.cone.copy(e.cone),this}dispose(){this.line.geometry.dispose(),this.line.material.dispose(),this.cone.geometry.dispose(),this.cone.material.dispose()}}class IMe extends g0{constructor(e=1){const n=[0,0,0,e,0,0,0,0,0,0,e,0,0,0,0,0,0,e],i=[1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1],r=new tr;r.setAttribute("position",new qn(n,3)),r.setAttribute("color",new qn(i,3));const s=new yh({vertexColors:!0,toneMapped:!1});super(r,s),this.type="AxesHelper"}setColors(e,n,i){const r=new bn,s=this.geometry.attributes.color.array;return r.set(e),r.toArray(s,0),r.toArray(s,3),r.set(n),r.toArray(s,6),r.toArray(s,9),r.set(i),r.toArray(s,12),r.toArray(s,15),this.geometry.attributes.color.needsUpdate=!0,this}dispose(){this.geometry.dispose(),this.material.dispose()}}class kMe{constructor(){this.type="ShapePath",this.color=new bn,this.subPaths=[],this.currentPath=null}moveTo(e,n){return this.currentPath=new NU,this.subPaths.push(this.currentPath),this.currentPath.moveTo(e,n),this}lineTo(e,n){return this.currentPath.lineTo(e,n),this}quadraticCurveTo(e,n,i,r){return this.currentPath.quadraticCurveTo(e,n,i,r),this}bezierCurveTo(e,n,i,r,s,a){return this.currentPath.bezierCurveTo(e,n,i,r,s,a),this}splineThru(e){return this.currentPath.splineThru(e),this}toShapes(e){function n(v){const b=[];for(let S=0,x=v.length;S<x;S++){const M=v[S],R=new MT;R.curves=M.curves,b.push(R)}return b}function i(v,b){const S=b.length;let x=!1;for(let M=S-1,R=0;R<S;M=R++){let I=b[M],k=b[R],P=k.x-I.x,U=k.y-I.y;if(Math.abs(U)>Number.EPSILON){if(U<0&&(I=b[R],P=-P,k=b[M],U=-U),v.y<I.y||v.y>k.y)continue;if(v.y===I.y){if(v.x===I.x)return!0}else{const V=U*(v.x-I.x)-P*(v.y-I.y);if(V===0)return!0;if(V<0)continue;x=!x}}else{if(v.y!==I.y)continue;if(k.x<=v.x&&v.x<=I.x||I.x<=v.x&&v.x<=k.x)return!0}}return x}const r=ym.isClockWise,s=this.subPaths;if(s.length===0)return[];let a,o,c;const l=[];if(s.length===1)return o=s[0],c=new MT,c.curves=o.curves,l.push(c),l;let u=!r(s[0].getPoints());u=e?!u:u;const h=[],d=[];let f=[],p=0,g;d[p]=void 0,f[p]=[];for(let v=0,b=s.length;v<b;v++)o=s[v],g=o.getPoints(),a=r(g),a=e?!a:a,a?(!u&&d[p]&&p++,d[p]={s:new MT,p:g},d[p].s.curves=o.curves,u&&p++,f[p]=[]):f[p].push({h:o,p:g[0]});if(!d[0])return n(s);if(d.length>1){let v=!1,b=0;for(let S=0,x=d.length;S<x;S++)h[S]=[];for(let S=0,x=d.length;S<x;S++){const M=f[S];for(let R=0;R<M.length;R++){const I=M[R];let k=!0;for(let P=0;P<d.length;P++)i(I.p,d[P].p)&&(S!==P&&b++,k?(k=!1,h[P].push(I)):v=!0);k&&h[S].push(I)}}b>0&&v===!1&&(f=h)}let _;for(let v=0,b=d.length;v<b;v++){c=d[v].s,l.push(c),_=f[v];for(let S=0,x=_.length;S<x;S++)c.holes.push(_[S].h)}return l}}let PMe=class extends _f{constructor(e,n=null){super(),this.object=e,this.domElement=n,this.enabled=!0,this.state=-1,this.keys={},this.mouseButtons={LEFT:null,MIDDLE:null,RIGHT:null},this.touches={ONE:null,TWO:null}}connect(e){if(e===void 0){console.warn("THREE.Controls: connect() now requires an element.");return}this.domElement!==null&&this.disconnect(),this.domElement=e}disconnect(){}dispose(){}update(){}};function DMe(t,e){const n=t.image&&t.image.width?t.image.width/t.image.height:1;return n>e?(t.repeat.x=1,t.repeat.y=n/e,t.offset.x=0,t.offset.y=(1-t.repeat.y)/2):(t.repeat.x=e/n,t.repeat.y=1,t.offset.x=(1-t.repeat.x)/2,t.offset.y=0),t}function LMe(t,e){const n=t.image&&t.image.width?t.image.width/t.image.height:1;return n>e?(t.repeat.x=e/n,t.repeat.y=1,t.offset.x=(1-t.repeat.x)/2,t.offset.y=0):(t.repeat.x=1,t.repeat.y=n/e,t.offset.x=0,t.offset.y=(1-t.repeat.y)/2),t}function UMe(t){return t.repeat.x=1,t.repeat.y=1,t.offset.x=0,t.offset.y=0,t}function aG(t,e,n,i){const r=BMe(i);switch(n){case $7:return t*e;case KA:return t*e/r.components*r.byteLength;case II:return t*e/r.components*r.byteLength;case tF:return t*e*2/r.components*r.byteLength;case nF:return t*e*2/r.components*r.byteLength;case W7:return t*e*3/r.components*r.byteLength;case Wc:return t*e*4/r.components*r.byteLength;case kI:return t*e*4/r.components*r.byteLength;case QM:case eO:return Math.floor((t+3)/4)*Math.floor((e+3)/4)*8;case tO:case nO:return Math.floor((t+3)/4)*Math.floor((e+3)/4)*16;case nU:case rU:return Math.max(t,16)*Math.max(e,8)/4;case tU:case iU:return Math.max(t,8)*Math.max(e,8)/2;case sU:case aU:return Math.floor((t+3)/4)*Math.floor((e+3)/4)*8;case oU:return Math.floor((t+3)/4)*Math.floor((e+3)/4)*16;case cU:return Math.floor((t+3)/4)*Math.floor((e+3)/4)*16;case lU:return Math.floor((t+4)/5)*Math.floor((e+3)/4)*16;case uU:return Math.floor((t+4)/5)*Math.floor((e+4)/5)*16;case hU:return Math.floor((t+5)/6)*Math.floor((e+4)/5)*16;case dU:return Math.floor((t+5)/6)*Math.floor((e+5)/6)*16;case fU:return Math.floor((t+7)/8)*Math.floor((e+4)/5)*16;case pU:return Math.floor((t+7)/8)*Math.floor((e+5)/6)*16;case mU:return Math.floor((t+7)/8)*Math.floor((e+7)/8)*16;case gU:return Math.floor((t+9)/10)*Math.floor((e+4)/5)*16;case vU:return Math.floor((t+9)/10)*Math.floor((e+5)/6)*16;case _U:return Math.floor((t+9)/10)*Math.floor((e+7)/8)*16;case yU:return Math.floor((t+9)/10)*Math.floor((e+9)/10)*16;case bU:return Math.floor((t+11)/12)*Math.floor((e+9)/10)*16;case EU:return Math.floor((t+11)/12)*Math.floor((e+11)/12)*16;case iO:case SU:case TU:return Math.ceil(t/4)*Math.ceil(e/4)*16;case Y7:case xU:return Math.ceil(t/4)*Math.ceil(e/4)*8;case wU:case CU:return Math.ceil(t/4)*Math.ceil(e/4)*16}throw new Error(`Unable to determine texture byte length for ${n} format.`)}function BMe(t){switch(t){case lo:case V7:return{byteLength:1,components:1};case BC:case G7:case SE:return{byteLength:2,components:1};case QB:case eF:return{byteLength:2,components:4};case s0:case JB:case vu:return{byteLength:4,components:1};case q7:return{byteLength:4,components:3}}throw new Error(`Unknown texture type ${t}.`)}class FMe{static contain(e,n){return DMe(e,n)}static cover(e,n){return LMe(e,n)}static fill(e){return UMe(e)}static getByteLength(e,n,i,r){return aG(e,n,i,r)}}typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:WA}}));typeof window<"u"&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=WA);/**
 * @license
 * Copyright 2010-2025 Three.js Authors
 * SPDX-License-Identifier: MIT
 */function Wue(){let t=null,e=!1,n=null,i=null;function r(s,a){n(s,a),i=t.requestAnimationFrame(r)}return{start:function(){e!==!0&&n!==null&&(i=t.requestAnimationFrame(r),e=!0)},stop:function(){t.cancelAnimationFrame(i),e=!1},setAnimationLoop:function(s){n=s},setContext:function(s){t=s}}}function zMe(t){const e=new WeakMap;function n(o,c){const l=o.array,u=o.usage,h=l.byteLength,d=t.createBuffer();t.bindBuffer(c,d),t.bufferData(c,l,u),o.onUploadCallback();let f;if(l instanceof Float32Array)f=t.FLOAT;else if(l instanceof Uint16Array)o.isFloat16BufferAttribute?f=t.HALF_FLOAT:f=t.UNSIGNED_SHORT;else if(l instanceof Int16Array)f=t.SHORT;else if(l instanceof Uint32Array)f=t.UNSIGNED_INT;else if(l instanceof Int32Array)f=t.INT;else if(l instanceof Int8Array)f=t.BYTE;else if(l instanceof Uint8Array)f=t.UNSIGNED_BYTE;else if(l instanceof Uint8ClampedArray)f=t.UNSIGNED_BYTE;else throw new Error("THREE.WebGLAttributes: Unsupported buffer data format: "+l);return{buffer:d,type:f,bytesPerElement:l.BYTES_PER_ELEMENT,version:o.version,size:h}}function i(o,c,l){const u=c.array,h=c.updateRanges;if(t.bindBuffer(l,o),h.length===0)t.bufferSubData(l,0,u);else{h.sort((f,p)=>f.start-p.start);let d=0;for(let f=1;f<h.length;f++){const p=h[d],g=h[f];g.start<=p.start+p.count+1?p.count=Math.max(p.count,g.start+g.count-p.start):(++d,h[d]=g)}h.length=d+1;for(let f=0,p=h.length;f<p;f++){const g=h[f];t.bufferSubData(l,g.start*u.BYTES_PER_ELEMENT,u,g.start,g.count)}c.clearUpdateRanges()}c.onUploadCallback()}function r(o){return o.isInterleavedBufferAttribute&&(o=o.data),e.get(o)}function s(o){o.isInterleavedBufferAttribute&&(o=o.data);const c=e.get(o);c&&(t.deleteBuffer(c.buffer),e.delete(o))}function a(o,c){if(o.isInterleavedBufferAttribute&&(o=o.data),o.isGLBufferAttribute){const u=e.get(o);(!u||u.version<o.version)&&e.set(o,{buffer:o.buffer,type:o.type,bytesPerElement:o.elementSize,version:o.version});return}const l=e.get(o);if(l===void 0)e.set(o,n(o,c));else if(l.version<o.version){if(l.size!==o.array.byteLength)throw new Error("THREE.WebGLAttributes: The size of the buffer attribute's array buffer does not match the original size. Resizing buffer attributes is not supported.");i(l.buffer,o,c),l.version=o.version}}return{get:r,remove:s,update:a}}var jMe=`#ifdef USE_ALPHAHASH
	if ( diffuseColor.a < getAlphaHashThreshold( vPosition ) ) discard;
#endif`,HMe=`#ifdef USE_ALPHAHASH
	const float ALPHA_HASH_SCALE = 0.05;
	float hash2D( vec2 value ) {
		return fract( 1.0e4 * sin( 17.0 * value.x + 0.1 * value.y ) * ( 0.1 + abs( sin( 13.0 * value.y + value.x ) ) ) );
	}
	float hash3D( vec3 value ) {
		return hash2D( vec2( hash2D( value.xy ), value.z ) );
	}
	float getAlphaHashThreshold( vec3 position ) {
		float maxDeriv = max(
			length( dFdx( position.xyz ) ),
			length( dFdy( position.xyz ) )
		);
		float pixScale = 1.0 / ( ALPHA_HASH_SCALE * maxDeriv );
		vec2 pixScales = vec2(
			exp2( floor( log2( pixScale ) ) ),
			exp2( ceil( log2( pixScale ) ) )
		);
		vec2 alpha = vec2(
			hash3D( floor( pixScales.x * position.xyz ) ),
			hash3D( floor( pixScales.y * position.xyz ) )
		);
		float lerpFactor = fract( log2( pixScale ) );
		float x = ( 1.0 - lerpFactor ) * alpha.x + lerpFactor * alpha.y;
		float a = min( lerpFactor, 1.0 - lerpFactor );
		vec3 cases = vec3(
			x * x / ( 2.0 * a * ( 1.0 - a ) ),
			( x - 0.5 * a ) / ( 1.0 - a ),
			1.0 - ( ( 1.0 - x ) * ( 1.0 - x ) / ( 2.0 * a * ( 1.0 - a ) ) )
		);
		float threshold = ( x < ( 1.0 - a ) )
			? ( ( x < a ) ? cases.x : cases.y )
			: cases.z;
		return clamp( threshold , 1.0e-6, 1.0 );
	}
#endif`,VMe=`#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, vAlphaMapUv ).g;
#endif`,GMe=`#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,qMe=`#ifdef USE_ALPHATEST
	#ifdef ALPHA_TO_COVERAGE
	diffuseColor.a = smoothstep( alphaTest, alphaTest + fwidth( diffuseColor.a ), diffuseColor.a );
	if ( diffuseColor.a == 0.0 ) discard;
	#else
	if ( diffuseColor.a < alphaTest ) discard;
	#endif
#endif`,$Me=`#ifdef USE_ALPHATEST
	uniform float alphaTest;
#endif`,WMe=`#ifdef USE_AOMAP
	float ambientOcclusion = ( texture2D( aoMap, vAoMapUv ).r - 1.0 ) * aoMapIntensity + 1.0;
	reflectedLight.indirectDiffuse *= ambientOcclusion;
	#if defined( USE_CLEARCOAT ) 
		clearcoatSpecularIndirect *= ambientOcclusion;
	#endif
	#if defined( USE_SHEEN ) 
		sheenSpecularIndirect *= ambientOcclusion;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD )
		float dotNV = saturate( dot( geometryNormal, geometryViewDir ) );
		reflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );
	#endif
#endif`,YMe=`#ifdef USE_AOMAP
	uniform sampler2D aoMap;
	uniform float aoMapIntensity;
#endif`,KMe=`#ifdef USE_BATCHING
	#if ! defined( GL_ANGLE_multi_draw )
	#define gl_DrawID _gl_DrawID
	uniform int _gl_DrawID;
	#endif
	uniform highp sampler2D batchingTexture;
	uniform highp usampler2D batchingIdTexture;
	mat4 getBatchingMatrix( const in float i ) {
		int size = textureSize( batchingTexture, 0 ).x;
		int j = int( i ) * 4;
		int x = j % size;
		int y = j / size;
		vec4 v1 = texelFetch( batchingTexture, ivec2( x, y ), 0 );
		vec4 v2 = texelFetch( batchingTexture, ivec2( x + 1, y ), 0 );
		vec4 v3 = texelFetch( batchingTexture, ivec2( x + 2, y ), 0 );
		vec4 v4 = texelFetch( batchingTexture, ivec2( x + 3, y ), 0 );
		return mat4( v1, v2, v3, v4 );
	}
	float getIndirectIndex( const in int i ) {
		int size = textureSize( batchingIdTexture, 0 ).x;
		int x = i % size;
		int y = i / size;
		return float( texelFetch( batchingIdTexture, ivec2( x, y ), 0 ).r );
	}
#endif
#ifdef USE_BATCHING_COLOR
	uniform sampler2D batchingColorTexture;
	vec3 getBatchingColor( const in float i ) {
		int size = textureSize( batchingColorTexture, 0 ).x;
		int j = int( i );
		int x = j % size;
		int y = j / size;
		return texelFetch( batchingColorTexture, ivec2( x, y ), 0 ).rgb;
	}
#endif`,XMe=`#ifdef USE_BATCHING
	mat4 batchingMatrix = getBatchingMatrix( getIndirectIndex( gl_DrawID ) );
#endif`,ZMe=`vec3 transformed = vec3( position );
#ifdef USE_ALPHAHASH
	vPosition = vec3( position );
#endif`,JMe=`vec3 objectNormal = vec3( normal );
#ifdef USE_TANGENT
	vec3 objectTangent = vec3( tangent.xyz );
#endif`,QMe=`float G_BlinnPhong_Implicit( ) {
	return 0.25;
}
float D_BlinnPhong( const in float shininess, const in float dotNH ) {
	return RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );
}
vec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( specularColor, 1.0, dotVH );
	float G = G_BlinnPhong_Implicit( );
	float D = D_BlinnPhong( shininess, dotNH );
	return F * ( G * D );
} // validated`,eOe=`#ifdef USE_IRIDESCENCE
	const mat3 XYZ_TO_REC709 = mat3(
		 3.2404542, -0.9692660,  0.0556434,
		-1.5371385,  1.8760108, -0.2040259,
		-0.4985314,  0.0415560,  1.0572252
	);
	vec3 Fresnel0ToIor( vec3 fresnel0 ) {
		vec3 sqrtF0 = sqrt( fresnel0 );
		return ( vec3( 1.0 ) + sqrtF0 ) / ( vec3( 1.0 ) - sqrtF0 );
	}
	vec3 IorToFresnel0( vec3 transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - vec3( incidentIor ) ) / ( transmittedIor + vec3( incidentIor ) ) );
	}
	float IorToFresnel0( float transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - incidentIor ) / ( transmittedIor + incidentIor ));
	}
	vec3 evalSensitivity( float OPD, vec3 shift ) {
		float phase = 2.0 * PI * OPD * 1.0e-9;
		vec3 val = vec3( 5.4856e-13, 4.4201e-13, 5.2481e-13 );
		vec3 pos = vec3( 1.6810e+06, 1.7953e+06, 2.2084e+06 );
		vec3 var = vec3( 4.3278e+09, 9.3046e+09, 6.6121e+09 );
		vec3 xyz = val * sqrt( 2.0 * PI * var ) * cos( pos * phase + shift ) * exp( - pow2( phase ) * var );
		xyz.x += 9.7470e-14 * sqrt( 2.0 * PI * 4.5282e+09 ) * cos( 2.2399e+06 * phase + shift[ 0 ] ) * exp( - 4.5282e+09 * pow2( phase ) );
		xyz /= 1.0685e-7;
		vec3 rgb = XYZ_TO_REC709 * xyz;
		return rgb;
	}
	vec3 evalIridescence( float outsideIOR, float eta2, float cosTheta1, float thinFilmThickness, vec3 baseF0 ) {
		vec3 I;
		float iridescenceIOR = mix( outsideIOR, eta2, smoothstep( 0.0, 0.03, thinFilmThickness ) );
		float sinTheta2Sq = pow2( outsideIOR / iridescenceIOR ) * ( 1.0 - pow2( cosTheta1 ) );
		float cosTheta2Sq = 1.0 - sinTheta2Sq;
		if ( cosTheta2Sq < 0.0 ) {
			return vec3( 1.0 );
		}
		float cosTheta2 = sqrt( cosTheta2Sq );
		float R0 = IorToFresnel0( iridescenceIOR, outsideIOR );
		float R12 = F_Schlick( R0, 1.0, cosTheta1 );
		float T121 = 1.0 - R12;
		float phi12 = 0.0;
		if ( iridescenceIOR < outsideIOR ) phi12 = PI;
		float phi21 = PI - phi12;
		vec3 baseIOR = Fresnel0ToIor( clamp( baseF0, 0.0, 0.9999 ) );		vec3 R1 = IorToFresnel0( baseIOR, iridescenceIOR );
		vec3 R23 = F_Schlick( R1, 1.0, cosTheta2 );
		vec3 phi23 = vec3( 0.0 );
		if ( baseIOR[ 0 ] < iridescenceIOR ) phi23[ 0 ] = PI;
		if ( baseIOR[ 1 ] < iridescenceIOR ) phi23[ 1 ] = PI;
		if ( baseIOR[ 2 ] < iridescenceIOR ) phi23[ 2 ] = PI;
		float OPD = 2.0 * iridescenceIOR * thinFilmThickness * cosTheta2;
		vec3 phi = vec3( phi21 ) + phi23;
		vec3 R123 = clamp( R12 * R23, 1e-5, 0.9999 );
		vec3 r123 = sqrt( R123 );
		vec3 Rs = pow2( T121 ) * R23 / ( vec3( 1.0 ) - R123 );
		vec3 C0 = R12 + Rs;
		I = C0;
		vec3 Cm = Rs - T121;
		for ( int m = 1; m <= 2; ++ m ) {
			Cm *= r123;
			vec3 Sm = 2.0 * evalSensitivity( float( m ) * OPD, float( m ) * phi );
			I += Cm * Sm;
		}
		return max( I, vec3( 0.0 ) );
	}
#endif`,tOe=`#ifdef USE_BUMPMAP
	uniform sampler2D bumpMap;
	uniform float bumpScale;
	vec2 dHdxy_fwd() {
		vec2 dSTdx = dFdx( vBumpMapUv );
		vec2 dSTdy = dFdy( vBumpMapUv );
		float Hll = bumpScale * texture2D( bumpMap, vBumpMapUv ).x;
		float dBx = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdx ).x - Hll;
		float dBy = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdy ).x - Hll;
		return vec2( dBx, dBy );
	}
	vec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {
		vec3 vSigmaX = normalize( dFdx( surf_pos.xyz ) );
		vec3 vSigmaY = normalize( dFdy( surf_pos.xyz ) );
		vec3 vN = surf_norm;
		vec3 R1 = cross( vSigmaY, vN );
		vec3 R2 = cross( vN, vSigmaX );
		float fDet = dot( vSigmaX, R1 ) * faceDirection;
		vec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );
		return normalize( abs( fDet ) * surf_norm - vGrad );
	}
#endif`,nOe=`#if NUM_CLIPPING_PLANES > 0
	vec4 plane;
	#ifdef ALPHA_TO_COVERAGE
		float distanceToPlane, distanceGradient;
		float clipOpacity = 1.0;
		#pragma unroll_loop_start
		for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			distanceToPlane = - dot( vClipPosition, plane.xyz ) + plane.w;
			distanceGradient = fwidth( distanceToPlane ) / 2.0;
			clipOpacity *= smoothstep( - distanceGradient, distanceGradient, distanceToPlane );
			if ( clipOpacity == 0.0 ) discard;
		}
		#pragma unroll_loop_end
		#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
			float unionClipOpacity = 1.0;
			#pragma unroll_loop_start
			for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
				plane = clippingPlanes[ i ];
				distanceToPlane = - dot( vClipPosition, plane.xyz ) + plane.w;
				distanceGradient = fwidth( distanceToPlane ) / 2.0;
				unionClipOpacity *= 1.0 - smoothstep( - distanceGradient, distanceGradient, distanceToPlane );
			}
			#pragma unroll_loop_end
			clipOpacity *= 1.0 - unionClipOpacity;
		#endif
		diffuseColor.a *= clipOpacity;
		if ( diffuseColor.a == 0.0 ) discard;
	#else
		#pragma unroll_loop_start
		for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			if ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;
		}
		#pragma unroll_loop_end
		#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
			bool clipped = true;
			#pragma unroll_loop_start
			for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
				plane = clippingPlanes[ i ];
				clipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;
			}
			#pragma unroll_loop_end
			if ( clipped ) discard;
		#endif
	#endif
#endif`,iOe=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
	uniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];
#endif`,rOe=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
#endif`,sOe=`#if NUM_CLIPPING_PLANES > 0
	vClipPosition = - mvPosition.xyz;
#endif`,aOe=`#if defined( USE_COLOR_ALPHA )
	diffuseColor *= vColor;
#elif defined( USE_COLOR )
	diffuseColor.rgb *= vColor;
#endif`,oOe=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR )
	varying vec3 vColor;
#endif`,cOe=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR ) || defined( USE_BATCHING_COLOR )
	varying vec3 vColor;
#endif`,lOe=`#if defined( USE_COLOR_ALPHA )
	vColor = vec4( 1.0 );
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR ) || defined( USE_BATCHING_COLOR )
	vColor = vec3( 1.0 );
#endif
#ifdef USE_COLOR
	vColor *= color;
#endif
#ifdef USE_INSTANCING_COLOR
	vColor.xyz *= instanceColor.xyz;
#endif
#ifdef USE_BATCHING_COLOR
	vec3 batchingColor = getBatchingColor( getIndirectIndex( gl_DrawID ) );
	vColor.xyz *= batchingColor.xyz;
#endif`,uOe=`#define PI 3.141592653589793
#define PI2 6.283185307179586
#define PI_HALF 1.5707963267948966
#define RECIPROCAL_PI 0.3183098861837907
#define RECIPROCAL_PI2 0.15915494309189535
#define EPSILON 1e-6
#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
#define whiteComplement( a ) ( 1.0 - saturate( a ) )
float pow2( const in float x ) { return x*x; }
vec3 pow2( const in vec3 x ) { return x*x; }
float pow3( const in float x ) { return x*x*x; }
float pow4( const in float x ) { float x2 = x*x; return x2*x2; }
float max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }
float average( const in vec3 v ) { return dot( v, vec3( 0.3333333 ) ); }
highp float rand( const in vec2 uv ) {
	const highp float a = 12.9898, b = 78.233, c = 43758.5453;
	highp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );
	return fract( sin( sn ) * c );
}
#ifdef HIGH_PRECISION
	float precisionSafeLength( vec3 v ) { return length( v ); }
#else
	float precisionSafeLength( vec3 v ) {
		float maxComponent = max3( abs( v ) );
		return length( v / maxComponent ) * maxComponent;
	}
#endif
struct IncidentLight {
	vec3 color;
	vec3 direction;
	bool visible;
};
struct ReflectedLight {
	vec3 directDiffuse;
	vec3 directSpecular;
	vec3 indirectDiffuse;
	vec3 indirectSpecular;
};
#ifdef USE_ALPHAHASH
	varying vec3 vPosition;
#endif
vec3 transformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );
}
vec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );
}
mat3 transposeMat3( const in mat3 m ) {
	mat3 tmp;
	tmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );
	tmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );
	tmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );
	return tmp;
}
bool isPerspectiveMatrix( mat4 m ) {
	return m[ 2 ][ 3 ] == - 1.0;
}
vec2 equirectUv( in vec3 dir ) {
	float u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;
	float v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;
	return vec2( u, v );
}
vec3 BRDF_Lambert( const in vec3 diffuseColor ) {
	return RECIPROCAL_PI * diffuseColor;
}
vec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
}
float F_Schlick( const in float f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
} // validated`,hOe=`#ifdef ENVMAP_TYPE_CUBE_UV
	#define cubeUV_minMipLevel 4.0
	#define cubeUV_minTileSize 16.0
	float getFace( vec3 direction ) {
		vec3 absDirection = abs( direction );
		float face = - 1.0;
		if ( absDirection.x > absDirection.z ) {
			if ( absDirection.x > absDirection.y )
				face = direction.x > 0.0 ? 0.0 : 3.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		} else {
			if ( absDirection.z > absDirection.y )
				face = direction.z > 0.0 ? 2.0 : 5.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		}
		return face;
	}
	vec2 getUV( vec3 direction, float face ) {
		vec2 uv;
		if ( face == 0.0 ) {
			uv = vec2( direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 1.0 ) {
			uv = vec2( - direction.x, - direction.z ) / abs( direction.y );
		} else if ( face == 2.0 ) {
			uv = vec2( - direction.x, direction.y ) / abs( direction.z );
		} else if ( face == 3.0 ) {
			uv = vec2( - direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 4.0 ) {
			uv = vec2( - direction.x, direction.z ) / abs( direction.y );
		} else {
			uv = vec2( direction.x, direction.y ) / abs( direction.z );
		}
		return 0.5 * ( uv + 1.0 );
	}
	vec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {
		float face = getFace( direction );
		float filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );
		mipInt = max( mipInt, cubeUV_minMipLevel );
		float faceSize = exp2( mipInt );
		highp vec2 uv = getUV( direction, face ) * ( faceSize - 2.0 ) + 1.0;
		if ( face > 2.0 ) {
			uv.y += faceSize;
			face -= 3.0;
		}
		uv.x += face * faceSize;
		uv.x += filterInt * 3.0 * cubeUV_minTileSize;
		uv.y += 4.0 * ( exp2( CUBEUV_MAX_MIP ) - faceSize );
		uv.x *= CUBEUV_TEXEL_WIDTH;
		uv.y *= CUBEUV_TEXEL_HEIGHT;
		#ifdef texture2DGradEXT
			return texture2DGradEXT( envMap, uv, vec2( 0.0 ), vec2( 0.0 ) ).rgb;
		#else
			return texture2D( envMap, uv ).rgb;
		#endif
	}
	#define cubeUV_r0 1.0
	#define cubeUV_m0 - 2.0
	#define cubeUV_r1 0.8
	#define cubeUV_m1 - 1.0
	#define cubeUV_r4 0.4
	#define cubeUV_m4 2.0
	#define cubeUV_r5 0.305
	#define cubeUV_m5 3.0
	#define cubeUV_r6 0.21
	#define cubeUV_m6 4.0
	float roughnessToMip( float roughness ) {
		float mip = 0.0;
		if ( roughness >= cubeUV_r1 ) {
			mip = ( cubeUV_r0 - roughness ) * ( cubeUV_m1 - cubeUV_m0 ) / ( cubeUV_r0 - cubeUV_r1 ) + cubeUV_m0;
		} else if ( roughness >= cubeUV_r4 ) {
			mip = ( cubeUV_r1 - roughness ) * ( cubeUV_m4 - cubeUV_m1 ) / ( cubeUV_r1 - cubeUV_r4 ) + cubeUV_m1;
		} else if ( roughness >= cubeUV_r5 ) {
			mip = ( cubeUV_r4 - roughness ) * ( cubeUV_m5 - cubeUV_m4 ) / ( cubeUV_r4 - cubeUV_r5 ) + cubeUV_m4;
		} else if ( roughness >= cubeUV_r6 ) {
			mip = ( cubeUV_r5 - roughness ) * ( cubeUV_m6 - cubeUV_m5 ) / ( cubeUV_r5 - cubeUV_r6 ) + cubeUV_m5;
		} else {
			mip = - 2.0 * log2( 1.16 * roughness );		}
		return mip;
	}
	vec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {
		float mip = clamp( roughnessToMip( roughness ), cubeUV_m0, CUBEUV_MAX_MIP );
		float mipF = fract( mip );
		float mipInt = floor( mip );
		vec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );
		if ( mipF == 0.0 ) {
			return vec4( color0, 1.0 );
		} else {
			vec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );
			return vec4( mix( color0, color1, mipF ), 1.0 );
		}
	}
#endif`,dOe=`vec3 transformedNormal = objectNormal;
#ifdef USE_TANGENT
	vec3 transformedTangent = objectTangent;
#endif
#ifdef USE_BATCHING
	mat3 bm = mat3( batchingMatrix );
	transformedNormal /= vec3( dot( bm[ 0 ], bm[ 0 ] ), dot( bm[ 1 ], bm[ 1 ] ), dot( bm[ 2 ], bm[ 2 ] ) );
	transformedNormal = bm * transformedNormal;
	#ifdef USE_TANGENT
		transformedTangent = bm * transformedTangent;
	#endif
#endif
#ifdef USE_INSTANCING
	mat3 im = mat3( instanceMatrix );
	transformedNormal /= vec3( dot( im[ 0 ], im[ 0 ] ), dot( im[ 1 ], im[ 1 ] ), dot( im[ 2 ], im[ 2 ] ) );
	transformedNormal = im * transformedNormal;
	#ifdef USE_TANGENT
		transformedTangent = im * transformedTangent;
	#endif
#endif
transformedNormal = normalMatrix * transformedNormal;
#ifdef FLIP_SIDED
	transformedNormal = - transformedNormal;
#endif
#ifdef USE_TANGENT
	transformedTangent = ( modelViewMatrix * vec4( transformedTangent, 0.0 ) ).xyz;
	#ifdef FLIP_SIDED
		transformedTangent = - transformedTangent;
	#endif
#endif`,fOe=`#ifdef USE_DISPLACEMENTMAP
	uniform sampler2D displacementMap;
	uniform float displacementScale;
	uniform float displacementBias;
#endif`,pOe=`#ifdef USE_DISPLACEMENTMAP
	transformed += normalize( objectNormal ) * ( texture2D( displacementMap, vDisplacementMapUv ).x * displacementScale + displacementBias );
#endif`,mOe=`#ifdef USE_EMISSIVEMAP
	vec4 emissiveColor = texture2D( emissiveMap, vEmissiveMapUv );
	#ifdef DECODE_VIDEO_TEXTURE_EMISSIVE
		emissiveColor = sRGBTransferEOTF( emissiveColor );
	#endif
	totalEmissiveRadiance *= emissiveColor.rgb;
#endif`,gOe=`#ifdef USE_EMISSIVEMAP
	uniform sampler2D emissiveMap;
#endif`,vOe="gl_FragColor = linearToOutputTexel( gl_FragColor );",_Oe=`vec4 LinearTransferOETF( in vec4 value ) {
	return value;
}
vec4 sRGBTransferEOTF( in vec4 value ) {
	return vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.a );
}
vec4 sRGBTransferOETF( in vec4 value ) {
	return vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );
}`,yOe=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vec3 cameraToFrag;
		if ( isOrthographic ) {
			cameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToFrag = normalize( vWorldPosition - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vec3 reflectVec = reflect( cameraToFrag, worldNormal );
		#else
			vec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );
		#endif
	#else
		vec3 reflectVec = vReflect;
	#endif
	#ifdef ENVMAP_TYPE_CUBE
		vec4 envColor = textureCube( envMap, envMapRotation * vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );
	#else
		vec4 envColor = vec4( 0.0 );
	#endif
	#ifdef ENVMAP_BLENDING_MULTIPLY
		outgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_MIX )
		outgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_ADD )
		outgoingLight += envColor.xyz * specularStrength * reflectivity;
	#endif
#endif`,bOe=`#ifdef USE_ENVMAP
	uniform float envMapIntensity;
	uniform float flipEnvMap;
	uniform mat3 envMapRotation;
	#ifdef ENVMAP_TYPE_CUBE
		uniform samplerCube envMap;
	#else
		uniform sampler2D envMap;
	#endif
	
#endif`,EOe=`#ifdef USE_ENVMAP
	uniform float reflectivity;
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		varying vec3 vWorldPosition;
		uniform float refractionRatio;
	#else
		varying vec3 vReflect;
	#endif
#endif`,SOe=`#ifdef USE_ENVMAP
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		
		varying vec3 vWorldPosition;
	#else
		varying vec3 vReflect;
		uniform float refractionRatio;
	#endif
#endif`,TOe=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vWorldPosition = worldPosition.xyz;
	#else
		vec3 cameraToVertex;
		if ( isOrthographic ) {
			cameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToVertex = normalize( worldPosition.xyz - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vReflect = reflect( cameraToVertex, worldNormal );
		#else
			vReflect = refract( cameraToVertex, worldNormal, refractionRatio );
		#endif
	#endif
#endif`,xOe=`#ifdef USE_FOG
	vFogDepth = - mvPosition.z;
#endif`,wOe=`#ifdef USE_FOG
	varying float vFogDepth;
#endif`,COe=`#ifdef USE_FOG
	#ifdef FOG_EXP2
		float fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );
	#else
		float fogFactor = smoothstep( fogNear, fogFar, vFogDepth );
	#endif
	gl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );
#endif`,AOe=`#ifdef USE_FOG
	uniform vec3 fogColor;
	varying float vFogDepth;
	#ifdef FOG_EXP2
		uniform float fogDensity;
	#else
		uniform float fogNear;
		uniform float fogFar;
	#endif
#endif`,ROe=`#ifdef USE_GRADIENTMAP
	uniform sampler2D gradientMap;
#endif
vec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {
	float dotNL = dot( normal, lightDirection );
	vec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );
	#ifdef USE_GRADIENTMAP
		return vec3( texture2D( gradientMap, coord ).r );
	#else
		vec2 fw = fwidth( coord ) * 0.5;
		return mix( vec3( 0.7 ), vec3( 1.0 ), smoothstep( 0.7 - fw.x, 0.7 + fw.x, coord.x ) );
	#endif
}`,MOe=`#ifdef USE_LIGHTMAP
	uniform sampler2D lightMap;
	uniform float lightMapIntensity;
#endif`,OOe=`LambertMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularStrength = specularStrength;`,NOe=`varying vec3 vViewPosition;
struct LambertMaterial {
	vec3 diffuseColor;
	float specularStrength;
};
void RE_Direct_Lambert( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Lambert( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Lambert
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Lambert`,IOe=`uniform bool receiveShadow;
uniform vec3 ambientLightColor;
#if defined( USE_LIGHT_PROBES )
	uniform vec3 lightProbe[ 9 ];
#endif
vec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {
	float x = normal.x, y = normal.y, z = normal.z;
	vec3 result = shCoefficients[ 0 ] * 0.886227;
	result += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;
	result += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;
	result += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;
	result += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;
	result += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;
	result += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );
	result += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;
	result += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );
	return result;
}
vec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {
	vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
	vec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );
	return irradiance;
}
vec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {
	vec3 irradiance = ambientLightColor;
	return irradiance;
}
float getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {
	float distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );
	if ( cutoffDistance > 0.0 ) {
		distanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );
	}
	return distanceFalloff;
}
float getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {
	return smoothstep( coneCosine, penumbraCosine, angleCosine );
}
#if NUM_DIR_LIGHTS > 0
	struct DirectionalLight {
		vec3 direction;
		vec3 color;
	};
	uniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];
	void getDirectionalLightInfo( const in DirectionalLight directionalLight, out IncidentLight light ) {
		light.color = directionalLight.color;
		light.direction = directionalLight.direction;
		light.visible = true;
	}
#endif
#if NUM_POINT_LIGHTS > 0
	struct PointLight {
		vec3 position;
		vec3 color;
		float distance;
		float decay;
	};
	uniform PointLight pointLights[ NUM_POINT_LIGHTS ];
	void getPointLightInfo( const in PointLight pointLight, const in vec3 geometryPosition, out IncidentLight light ) {
		vec3 lVector = pointLight.position - geometryPosition;
		light.direction = normalize( lVector );
		float lightDistance = length( lVector );
		light.color = pointLight.color;
		light.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );
		light.visible = ( light.color != vec3( 0.0 ) );
	}
#endif
#if NUM_SPOT_LIGHTS > 0
	struct SpotLight {
		vec3 position;
		vec3 direction;
		vec3 color;
		float distance;
		float decay;
		float coneCos;
		float penumbraCos;
	};
	uniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];
	void getSpotLightInfo( const in SpotLight spotLight, const in vec3 geometryPosition, out IncidentLight light ) {
		vec3 lVector = spotLight.position - geometryPosition;
		light.direction = normalize( lVector );
		float angleCos = dot( light.direction, spotLight.direction );
		float spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );
		if ( spotAttenuation > 0.0 ) {
			float lightDistance = length( lVector );
			light.color = spotLight.color * spotAttenuation;
			light.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );
			light.visible = ( light.color != vec3( 0.0 ) );
		} else {
			light.color = vec3( 0.0 );
			light.visible = false;
		}
	}
#endif
#if NUM_RECT_AREA_LIGHTS > 0
	struct RectAreaLight {
		vec3 color;
		vec3 position;
		vec3 halfWidth;
		vec3 halfHeight;
	};
	uniform sampler2D ltc_1;	uniform sampler2D ltc_2;
	uniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];
#endif
#if NUM_HEMI_LIGHTS > 0
	struct HemisphereLight {
		vec3 direction;
		vec3 skyColor;
		vec3 groundColor;
	};
	uniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];
	vec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {
		float dotNL = dot( normal, hemiLight.direction );
		float hemiDiffuseWeight = 0.5 * dotNL + 0.5;
		vec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );
		return irradiance;
	}
#endif`,kOe=`#ifdef USE_ENVMAP
	vec3 getIBLIrradiance( const in vec3 normal ) {
		#ifdef ENVMAP_TYPE_CUBE_UV
			vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, envMapRotation * worldNormal, 1.0 );
			return PI * envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	vec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {
		#ifdef ENVMAP_TYPE_CUBE_UV
			vec3 reflectVec = reflect( - viewDir, normal );
			reflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );
			reflectVec = inverseTransformDirection( reflectVec, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, envMapRotation * reflectVec, roughness );
			return envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	#ifdef USE_ANISOTROPY
		vec3 getIBLAnisotropyRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness, const in vec3 bitangent, const in float anisotropy ) {
			#ifdef ENVMAP_TYPE_CUBE_UV
				vec3 bentNormal = cross( bitangent, viewDir );
				bentNormal = normalize( cross( bentNormal, bitangent ) );
				bentNormal = normalize( mix( bentNormal, normal, pow2( pow2( 1.0 - anisotropy * ( 1.0 - roughness ) ) ) ) );
				return getIBLRadiance( viewDir, bentNormal, roughness );
			#else
				return vec3( 0.0 );
			#endif
		}
	#endif
#endif`,POe=`ToonMaterial material;
material.diffuseColor = diffuseColor.rgb;`,DOe=`varying vec3 vViewPosition;
struct ToonMaterial {
	vec3 diffuseColor;
};
void RE_Direct_Toon( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	vec3 irradiance = getGradientIrradiance( geometryNormal, directLight.direction ) * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Toon
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Toon`,LOe=`BlinnPhongMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularColor = specular;
material.specularShininess = shininess;
material.specularStrength = specularStrength;`,UOe=`varying vec3 vViewPosition;
struct BlinnPhongMaterial {
	vec3 diffuseColor;
	vec3 specularColor;
	float specularShininess;
	float specularStrength;
};
void RE_Direct_BlinnPhong( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
	reflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometryViewDir, geometryNormal, material.specularColor, material.specularShininess ) * material.specularStrength;
}
void RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_BlinnPhong
#define RE_IndirectDiffuse		RE_IndirectDiffuse_BlinnPhong`,BOe=`PhysicalMaterial material;
material.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );
vec3 dxy = max( abs( dFdx( nonPerturbedNormal ) ), abs( dFdy( nonPerturbedNormal ) ) );
float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );
material.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;
material.roughness = min( material.roughness, 1.0 );
#ifdef IOR
	material.ior = ior;
	#ifdef USE_SPECULAR
		float specularIntensityFactor = specularIntensity;
		vec3 specularColorFactor = specularColor;
		#ifdef USE_SPECULAR_COLORMAP
			specularColorFactor *= texture2D( specularColorMap, vSpecularColorMapUv ).rgb;
		#endif
		#ifdef USE_SPECULAR_INTENSITYMAP
			specularIntensityFactor *= texture2D( specularIntensityMap, vSpecularIntensityMapUv ).a;
		#endif
		material.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );
	#else
		float specularIntensityFactor = 1.0;
		vec3 specularColorFactor = vec3( 1.0 );
		material.specularF90 = 1.0;
	#endif
	material.specularColor = mix( min( pow2( ( material.ior - 1.0 ) / ( material.ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );
#else
	material.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );
	material.specularF90 = 1.0;
#endif
#ifdef USE_CLEARCOAT
	material.clearcoat = clearcoat;
	material.clearcoatRoughness = clearcoatRoughness;
	material.clearcoatF0 = vec3( 0.04 );
	material.clearcoatF90 = 1.0;
	#ifdef USE_CLEARCOATMAP
		material.clearcoat *= texture2D( clearcoatMap, vClearcoatMapUv ).x;
	#endif
	#ifdef USE_CLEARCOAT_ROUGHNESSMAP
		material.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vClearcoatRoughnessMapUv ).y;
	#endif
	material.clearcoat = saturate( material.clearcoat );	material.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );
	material.clearcoatRoughness += geometryRoughness;
	material.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );
#endif
#ifdef USE_DISPERSION
	material.dispersion = dispersion;
#endif
#ifdef USE_IRIDESCENCE
	material.iridescence = iridescence;
	material.iridescenceIOR = iridescenceIOR;
	#ifdef USE_IRIDESCENCEMAP
		material.iridescence *= texture2D( iridescenceMap, vIridescenceMapUv ).r;
	#endif
	#ifdef USE_IRIDESCENCE_THICKNESSMAP
		material.iridescenceThickness = (iridescenceThicknessMaximum - iridescenceThicknessMinimum) * texture2D( iridescenceThicknessMap, vIridescenceThicknessMapUv ).g + iridescenceThicknessMinimum;
	#else
		material.iridescenceThickness = iridescenceThicknessMaximum;
	#endif
#endif
#ifdef USE_SHEEN
	material.sheenColor = sheenColor;
	#ifdef USE_SHEEN_COLORMAP
		material.sheenColor *= texture2D( sheenColorMap, vSheenColorMapUv ).rgb;
	#endif
	material.sheenRoughness = clamp( sheenRoughness, 0.07, 1.0 );
	#ifdef USE_SHEEN_ROUGHNESSMAP
		material.sheenRoughness *= texture2D( sheenRoughnessMap, vSheenRoughnessMapUv ).a;
	#endif
#endif
#ifdef USE_ANISOTROPY
	#ifdef USE_ANISOTROPYMAP
		mat2 anisotropyMat = mat2( anisotropyVector.x, anisotropyVector.y, - anisotropyVector.y, anisotropyVector.x );
		vec3 anisotropyPolar = texture2D( anisotropyMap, vAnisotropyMapUv ).rgb;
		vec2 anisotropyV = anisotropyMat * normalize( 2.0 * anisotropyPolar.rg - vec2( 1.0 ) ) * anisotropyPolar.b;
	#else
		vec2 anisotropyV = anisotropyVector;
	#endif
	material.anisotropy = length( anisotropyV );
	if( material.anisotropy == 0.0 ) {
		anisotropyV = vec2( 1.0, 0.0 );
	} else {
		anisotropyV /= material.anisotropy;
		material.anisotropy = saturate( material.anisotropy );
	}
	material.alphaT = mix( pow2( material.roughness ), 1.0, pow2( material.anisotropy ) );
	material.anisotropyT = tbn[ 0 ] * anisotropyV.x + tbn[ 1 ] * anisotropyV.y;
	material.anisotropyB = tbn[ 1 ] * anisotropyV.x - tbn[ 0 ] * anisotropyV.y;
#endif`,FOe=`struct PhysicalMaterial {
	vec3 diffuseColor;
	float roughness;
	vec3 specularColor;
	float specularF90;
	float dispersion;
	#ifdef USE_CLEARCOAT
		float clearcoat;
		float clearcoatRoughness;
		vec3 clearcoatF0;
		float clearcoatF90;
	#endif
	#ifdef USE_IRIDESCENCE
		float iridescence;
		float iridescenceIOR;
		float iridescenceThickness;
		vec3 iridescenceFresnel;
		vec3 iridescenceF0;
	#endif
	#ifdef USE_SHEEN
		vec3 sheenColor;
		float sheenRoughness;
	#endif
	#ifdef IOR
		float ior;
	#endif
	#ifdef USE_TRANSMISSION
		float transmission;
		float transmissionAlpha;
		float thickness;
		float attenuationDistance;
		vec3 attenuationColor;
	#endif
	#ifdef USE_ANISOTROPY
		float anisotropy;
		float alphaT;
		vec3 anisotropyT;
		vec3 anisotropyB;
	#endif
};
vec3 clearcoatSpecularDirect = vec3( 0.0 );
vec3 clearcoatSpecularIndirect = vec3( 0.0 );
vec3 sheenSpecularDirect = vec3( 0.0 );
vec3 sheenSpecularIndirect = vec3(0.0 );
vec3 Schlick_to_F0( const in vec3 f, const in float f90, const in float dotVH ) {
    float x = clamp( 1.0 - dotVH, 0.0, 1.0 );
    float x2 = x * x;
    float x5 = clamp( x * x2 * x2, 0.0, 0.9999 );
    return ( f - vec3( f90 ) * x5 ) / ( 1.0 - x5 );
}
float V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {
	float a2 = pow2( alpha );
	float gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );
	float gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );
	return 0.5 / max( gv + gl, EPSILON );
}
float D_GGX( const in float alpha, const in float dotNH ) {
	float a2 = pow2( alpha );
	float denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;
	return RECIPROCAL_PI * a2 / pow2( denom );
}
#ifdef USE_ANISOTROPY
	float V_GGX_SmithCorrelated_Anisotropic( const in float alphaT, const in float alphaB, const in float dotTV, const in float dotBV, const in float dotTL, const in float dotBL, const in float dotNV, const in float dotNL ) {
		float gv = dotNL * length( vec3( alphaT * dotTV, alphaB * dotBV, dotNV ) );
		float gl = dotNV * length( vec3( alphaT * dotTL, alphaB * dotBL, dotNL ) );
		float v = 0.5 / ( gv + gl );
		return saturate(v);
	}
	float D_GGX_Anisotropic( const in float alphaT, const in float alphaB, const in float dotNH, const in float dotTH, const in float dotBH ) {
		float a2 = alphaT * alphaB;
		highp vec3 v = vec3( alphaB * dotTH, alphaT * dotBH, a2 * dotNH );
		highp float v2 = dot( v, v );
		float w2 = a2 / v2;
		return RECIPROCAL_PI * a2 * pow2 ( w2 );
	}
#endif
#ifdef USE_CLEARCOAT
	vec3 BRDF_GGX_Clearcoat( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material) {
		vec3 f0 = material.clearcoatF0;
		float f90 = material.clearcoatF90;
		float roughness = material.clearcoatRoughness;
		float alpha = pow2( roughness );
		vec3 halfDir = normalize( lightDir + viewDir );
		float dotNL = saturate( dot( normal, lightDir ) );
		float dotNV = saturate( dot( normal, viewDir ) );
		float dotNH = saturate( dot( normal, halfDir ) );
		float dotVH = saturate( dot( viewDir, halfDir ) );
		vec3 F = F_Schlick( f0, f90, dotVH );
		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
		float D = D_GGX( alpha, dotNH );
		return F * ( V * D );
	}
#endif
vec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material ) {
	vec3 f0 = material.specularColor;
	float f90 = material.specularF90;
	float roughness = material.roughness;
	float alpha = pow2( roughness );
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( f0, f90, dotVH );
	#ifdef USE_IRIDESCENCE
		F = mix( F, material.iridescenceFresnel, material.iridescence );
	#endif
	#ifdef USE_ANISOTROPY
		float dotTL = dot( material.anisotropyT, lightDir );
		float dotTV = dot( material.anisotropyT, viewDir );
		float dotTH = dot( material.anisotropyT, halfDir );
		float dotBL = dot( material.anisotropyB, lightDir );
		float dotBV = dot( material.anisotropyB, viewDir );
		float dotBH = dot( material.anisotropyB, halfDir );
		float V = V_GGX_SmithCorrelated_Anisotropic( material.alphaT, alpha, dotTV, dotBV, dotTL, dotBL, dotNV, dotNL );
		float D = D_GGX_Anisotropic( material.alphaT, alpha, dotNH, dotTH, dotBH );
	#else
		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
		float D = D_GGX( alpha, dotNH );
	#endif
	return F * ( V * D );
}
vec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {
	const float LUT_SIZE = 64.0;
	const float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;
	const float LUT_BIAS = 0.5 / LUT_SIZE;
	float dotNV = saturate( dot( N, V ) );
	vec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );
	uv = uv * LUT_SCALE + LUT_BIAS;
	return uv;
}
float LTC_ClippedSphereFormFactor( const in vec3 f ) {
	float l = length( f );
	return max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );
}
vec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {
	float x = dot( v1, v2 );
	float y = abs( x );
	float a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;
	float b = 3.4175940 + ( 4.1616724 + y ) * y;
	float v = a / b;
	float theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;
	return cross( v1, v2 ) * theta_sintheta;
}
vec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {
	vec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];
	vec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];
	vec3 lightNormal = cross( v1, v2 );
	if( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );
	vec3 T1, T2;
	T1 = normalize( V - N * dot( V, N ) );
	T2 = - cross( N, T1 );
	mat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );
	vec3 coords[ 4 ];
	coords[ 0 ] = mat * ( rectCoords[ 0 ] - P );
	coords[ 1 ] = mat * ( rectCoords[ 1 ] - P );
	coords[ 2 ] = mat * ( rectCoords[ 2 ] - P );
	coords[ 3 ] = mat * ( rectCoords[ 3 ] - P );
	coords[ 0 ] = normalize( coords[ 0 ] );
	coords[ 1 ] = normalize( coords[ 1 ] );
	coords[ 2 ] = normalize( coords[ 2 ] );
	coords[ 3 ] = normalize( coords[ 3 ] );
	vec3 vectorFormFactor = vec3( 0.0 );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );
	float result = LTC_ClippedSphereFormFactor( vectorFormFactor );
	return vec3( result );
}
#if defined( USE_SHEEN )
float D_Charlie( float roughness, float dotNH ) {
	float alpha = pow2( roughness );
	float invAlpha = 1.0 / alpha;
	float cos2h = dotNH * dotNH;
	float sin2h = max( 1.0 - cos2h, 0.0078125 );
	return ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );
}
float V_Neubelt( float dotNV, float dotNL ) {
	return saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );
}
vec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float D = D_Charlie( sheenRoughness, dotNH );
	float V = V_Neubelt( dotNV, dotNL );
	return sheenColor * ( D * V );
}
#endif
float IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	float r2 = roughness * roughness;
	float a = roughness < 0.25 ? -339.2 * r2 + 161.4 * roughness - 25.9 : -8.48 * r2 + 14.3 * roughness - 9.95;
	float b = roughness < 0.25 ? 44.0 * r2 - 23.7 * roughness + 3.26 : 1.97 * r2 - 3.27 * roughness + 0.72;
	float DG = exp( a * dotNV + b ) + ( roughness < 0.25 ? 0.0 : 0.1 * ( roughness - 0.25 ) );
	return saturate( DG * RECIPROCAL_PI );
}
vec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	const vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );
	const vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );
	vec4 r = roughness * c0 + c1;
	float a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;
	vec2 fab = vec2( - 1.04, 1.04 ) * a004 + r.zw;
	return fab;
}
vec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	return specularColor * fab.x + specularF90 * fab.y;
}
#ifdef USE_IRIDESCENCE
void computeMultiscatteringIridescence( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float iridescence, const in vec3 iridescenceF0, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#else
void computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#endif
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	#ifdef USE_IRIDESCENCE
		vec3 Fr = mix( specularColor, iridescenceF0, iridescence );
	#else
		vec3 Fr = specularColor;
	#endif
	vec3 FssEss = Fr * fab.x + specularF90 * fab.y;
	float Ess = fab.x + fab.y;
	float Ems = 1.0 - Ess;
	vec3 Favg = Fr + ( 1.0 - Fr ) * 0.047619;	vec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );
	singleScatter += FssEss;
	multiScatter += Fms * Ems;
}
#if NUM_RECT_AREA_LIGHTS > 0
	void RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
		vec3 normal = geometryNormal;
		vec3 viewDir = geometryViewDir;
		vec3 position = geometryPosition;
		vec3 lightPos = rectAreaLight.position;
		vec3 halfWidth = rectAreaLight.halfWidth;
		vec3 halfHeight = rectAreaLight.halfHeight;
		vec3 lightColor = rectAreaLight.color;
		float roughness = material.roughness;
		vec3 rectCoords[ 4 ];
		rectCoords[ 0 ] = lightPos + halfWidth - halfHeight;		rectCoords[ 1 ] = lightPos - halfWidth - halfHeight;
		rectCoords[ 2 ] = lightPos - halfWidth + halfHeight;
		rectCoords[ 3 ] = lightPos + halfWidth + halfHeight;
		vec2 uv = LTC_Uv( normal, viewDir, roughness );
		vec4 t1 = texture2D( ltc_1, uv );
		vec4 t2 = texture2D( ltc_2, uv );
		mat3 mInv = mat3(
			vec3( t1.x, 0, t1.y ),
			vec3(    0, 1,    0 ),
			vec3( t1.z, 0, t1.w )
		);
		vec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );
		reflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );
		reflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );
	}
#endif
void RE_Direct_Physical( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	#ifdef USE_CLEARCOAT
		float dotNLcc = saturate( dot( geometryClearcoatNormal, directLight.direction ) );
		vec3 ccIrradiance = dotNLcc * directLight.color;
		clearcoatSpecularDirect += ccIrradiance * BRDF_GGX_Clearcoat( directLight.direction, geometryViewDir, geometryClearcoatNormal, material );
	#endif
	#ifdef USE_SHEEN
		sheenSpecularDirect += irradiance * BRDF_Sheen( directLight.direction, geometryViewDir, geometryNormal, material.sheenColor, material.sheenRoughness );
	#endif
	reflectedLight.directSpecular += irradiance * BRDF_GGX( directLight.direction, geometryViewDir, geometryNormal, material );
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {
	#ifdef USE_CLEARCOAT
		clearcoatSpecularIndirect += clearcoatRadiance * EnvironmentBRDF( geometryClearcoatNormal, geometryViewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );
	#endif
	#ifdef USE_SHEEN
		sheenSpecularIndirect += irradiance * material.sheenColor * IBLSheenBRDF( geometryNormal, geometryViewDir, material.sheenRoughness );
	#endif
	vec3 singleScattering = vec3( 0.0 );
	vec3 multiScattering = vec3( 0.0 );
	vec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;
	#ifdef USE_IRIDESCENCE
		computeMultiscatteringIridescence( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness, singleScattering, multiScattering );
	#else
		computeMultiscattering( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );
	#endif
	vec3 totalScattering = singleScattering + multiScattering;
	vec3 diffuse = material.diffuseColor * ( 1.0 - max( max( totalScattering.r, totalScattering.g ), totalScattering.b ) );
	reflectedLight.indirectSpecular += radiance * singleScattering;
	reflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;
	reflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;
}
#define RE_Direct				RE_Direct_Physical
#define RE_Direct_RectArea		RE_Direct_RectArea_Physical
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Physical
#define RE_IndirectSpecular		RE_IndirectSpecular_Physical
float computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {
	return saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );
}`,zOe=`
vec3 geometryPosition = - vViewPosition;
vec3 geometryNormal = normal;
vec3 geometryViewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );
vec3 geometryClearcoatNormal = vec3( 0.0 );
#ifdef USE_CLEARCOAT
	geometryClearcoatNormal = clearcoatNormal;
#endif
#ifdef USE_IRIDESCENCE
	float dotNVi = saturate( dot( normal, geometryViewDir ) );
	if ( material.iridescenceThickness == 0.0 ) {
		material.iridescence = 0.0;
	} else {
		material.iridescence = saturate( material.iridescence );
	}
	if ( material.iridescence > 0.0 ) {
		material.iridescenceFresnel = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.specularColor );
		material.iridescenceF0 = Schlick_to_F0( material.iridescenceFresnel, 1.0, dotNVi );
	}
#endif
IncidentLight directLight;
#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )
	PointLight pointLight;
	#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
		pointLight = pointLights[ i ];
		getPointLightInfo( pointLight, geometryPosition, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )
		pointLightShadow = pointLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowIntensity, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )
	SpotLight spotLight;
	vec4 spotColor;
	vec3 spotLightCoord;
	bool inSpotLightMap;
	#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {
		spotLight = spotLights[ i ];
		getSpotLightInfo( spotLight, geometryPosition, directLight );
		#if ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#define SPOT_LIGHT_MAP_INDEX UNROLLED_LOOP_INDEX
		#elif ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		#define SPOT_LIGHT_MAP_INDEX NUM_SPOT_LIGHT_MAPS
		#else
		#define SPOT_LIGHT_MAP_INDEX ( UNROLLED_LOOP_INDEX - NUM_SPOT_LIGHT_SHADOWS + NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#endif
		#if ( SPOT_LIGHT_MAP_INDEX < NUM_SPOT_LIGHT_MAPS )
			spotLightCoord = vSpotLightCoord[ i ].xyz / vSpotLightCoord[ i ].w;
			inSpotLightMap = all( lessThan( abs( spotLightCoord * 2. - 1. ), vec3( 1.0 ) ) );
			spotColor = texture2D( spotLightMap[ SPOT_LIGHT_MAP_INDEX ], spotLightCoord.xy );
			directLight.color = inSpotLightMap ? directLight.color * spotColor.rgb : directLight.color;
		#endif
		#undef SPOT_LIGHT_MAP_INDEX
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		spotLightShadow = spotLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowIntensity, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )
	DirectionalLight directionalLight;
	#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
		directionalLight = directionalLights[ i ];
		getDirectionalLightInfo( directionalLight, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )
		directionalLightShadow = directionalLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowIntensity, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )
	RectAreaLight rectAreaLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {
		rectAreaLight = rectAreaLights[ i ];
		RE_Direct_RectArea( rectAreaLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if defined( RE_IndirectDiffuse )
	vec3 iblIrradiance = vec3( 0.0 );
	vec3 irradiance = getAmbientLightIrradiance( ambientLightColor );
	#if defined( USE_LIGHT_PROBES )
		irradiance += getLightProbeIrradiance( lightProbe, geometryNormal );
	#endif
	#if ( NUM_HEMI_LIGHTS > 0 )
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {
			irradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometryNormal );
		}
		#pragma unroll_loop_end
	#endif
#endif
#if defined( RE_IndirectSpecular )
	vec3 radiance = vec3( 0.0 );
	vec3 clearcoatRadiance = vec3( 0.0 );
#endif`,jOe=`#if defined( RE_IndirectDiffuse )
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
		vec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;
		irradiance += lightMapIrradiance;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )
		iblIrradiance += getIBLIrradiance( geometryNormal );
	#endif
#endif
#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )
	#ifdef USE_ANISOTROPY
		radiance += getIBLAnisotropyRadiance( geometryViewDir, geometryNormal, material.roughness, material.anisotropyB, material.anisotropy );
	#else
		radiance += getIBLRadiance( geometryViewDir, geometryNormal, material.roughness );
	#endif
	#ifdef USE_CLEARCOAT
		clearcoatRadiance += getIBLRadiance( geometryViewDir, geometryClearcoatNormal, material.clearcoatRoughness );
	#endif
#endif`,HOe=`#if defined( RE_IndirectDiffuse )
	RE_IndirectDiffuse( irradiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
#endif
#if defined( RE_IndirectSpecular )
	RE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
#endif`,VOe=`#if defined( USE_LOGDEPTHBUF )
	gl_FragDepth = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;
#endif`,GOe=`#if defined( USE_LOGDEPTHBUF )
	uniform float logDepthBufFC;
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,qOe=`#ifdef USE_LOGDEPTHBUF
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,$Oe=`#ifdef USE_LOGDEPTHBUF
	vFragDepth = 1.0 + gl_Position.w;
	vIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );
#endif`,WOe=`#ifdef USE_MAP
	vec4 sampledDiffuseColor = texture2D( map, vMapUv );
	#ifdef DECODE_VIDEO_TEXTURE
		sampledDiffuseColor = sRGBTransferEOTF( sampledDiffuseColor );
	#endif
	diffuseColor *= sampledDiffuseColor;
#endif`,YOe=`#ifdef USE_MAP
	uniform sampler2D map;
#endif`,KOe=`#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
	#if defined( USE_POINTS_UV )
		vec2 uv = vUv;
	#else
		vec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;
	#endif
#endif
#ifdef USE_MAP
	diffuseColor *= texture2D( map, uv );
#endif
#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, uv ).g;
#endif`,XOe=`#if defined( USE_POINTS_UV )
	varying vec2 vUv;
#else
	#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
		uniform mat3 uvTransform;
	#endif
#endif
#ifdef USE_MAP
	uniform sampler2D map;
#endif
#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,ZOe=`float metalnessFactor = metalness;
#ifdef USE_METALNESSMAP
	vec4 texelMetalness = texture2D( metalnessMap, vMetalnessMapUv );
	metalnessFactor *= texelMetalness.b;
#endif`,JOe=`#ifdef USE_METALNESSMAP
	uniform sampler2D metalnessMap;
#endif`,QOe=`#ifdef USE_INSTANCING_MORPH
	float morphTargetInfluences[ MORPHTARGETS_COUNT ];
	float morphTargetBaseInfluence = texelFetch( morphTexture, ivec2( 0, gl_InstanceID ), 0 ).r;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		morphTargetInfluences[i] =  texelFetch( morphTexture, ivec2( i + 1, gl_InstanceID ), 0 ).r;
	}
#endif`,eNe=`#if defined( USE_MORPHCOLORS )
	vColor *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		#if defined( USE_COLOR_ALPHA )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ) * morphTargetInfluences[ i ];
		#elif defined( USE_COLOR )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ).rgb * morphTargetInfluences[ i ];
		#endif
	}
#endif`,tNe=`#ifdef USE_MORPHNORMALS
	objectNormal *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		if ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1 ).xyz * morphTargetInfluences[ i ];
	}
#endif`,nNe=`#ifdef USE_MORPHTARGETS
	#ifndef USE_INSTANCING_MORPH
		uniform float morphTargetBaseInfluence;
		uniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];
	#endif
	uniform sampler2DArray morphTargetsTexture;
	uniform ivec2 morphTargetsTextureSize;
	vec4 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset ) {
		int texelIndex = vertexIndex * MORPHTARGETS_TEXTURE_STRIDE + offset;
		int y = texelIndex / morphTargetsTextureSize.x;
		int x = texelIndex - y * morphTargetsTextureSize.x;
		ivec3 morphUV = ivec3( x, y, morphTargetIndex );
		return texelFetch( morphTargetsTexture, morphUV, 0 );
	}
#endif`,iNe=`#ifdef USE_MORPHTARGETS
	transformed *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		if ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0 ).xyz * morphTargetInfluences[ i ];
	}
#endif`,rNe=`float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;
#ifdef FLAT_SHADED
	vec3 fdx = dFdx( vViewPosition );
	vec3 fdy = dFdy( vViewPosition );
	vec3 normal = normalize( cross( fdx, fdy ) );
#else
	vec3 normal = normalize( vNormal );
	#ifdef DOUBLE_SIDED
		normal *= faceDirection;
	#endif
#endif
#if defined( USE_NORMALMAP_TANGENTSPACE ) || defined( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY )
	#ifdef USE_TANGENT
		mat3 tbn = mat3( normalize( vTangent ), normalize( vBitangent ), normal );
	#else
		mat3 tbn = getTangentFrame( - vViewPosition, normal,
		#if defined( USE_NORMALMAP )
			vNormalMapUv
		#elif defined( USE_CLEARCOAT_NORMALMAP )
			vClearcoatNormalMapUv
		#else
			vUv
		#endif
		);
	#endif
	#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )
		tbn[0] *= faceDirection;
		tbn[1] *= faceDirection;
	#endif
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	#ifdef USE_TANGENT
		mat3 tbn2 = mat3( normalize( vTangent ), normalize( vBitangent ), normal );
	#else
		mat3 tbn2 = getTangentFrame( - vViewPosition, normal, vClearcoatNormalMapUv );
	#endif
	#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )
		tbn2[0] *= faceDirection;
		tbn2[1] *= faceDirection;
	#endif
#endif
vec3 nonPerturbedNormal = normal;`,sNe=`#ifdef USE_NORMALMAP_OBJECTSPACE
	normal = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;
	#ifdef FLIP_SIDED
		normal = - normal;
	#endif
	#ifdef DOUBLE_SIDED
		normal = normal * faceDirection;
	#endif
	normal = normalize( normalMatrix * normal );
#elif defined( USE_NORMALMAP_TANGENTSPACE )
	vec3 mapN = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;
	mapN.xy *= normalScale;
	normal = normalize( tbn * mapN );
#elif defined( USE_BUMPMAP )
	normal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );
#endif`,aNe=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,oNe=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,cNe=`#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
	#ifdef USE_TANGENT
		vTangent = normalize( transformedTangent );
		vBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );
	#endif
#endif`,lNe=`#ifdef USE_NORMALMAP
	uniform sampler2D normalMap;
	uniform vec2 normalScale;
#endif
#ifdef USE_NORMALMAP_OBJECTSPACE
	uniform mat3 normalMatrix;
#endif
#if ! defined ( USE_TANGENT ) && ( defined ( USE_NORMALMAP_TANGENTSPACE ) || defined ( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY ) )
	mat3 getTangentFrame( vec3 eye_pos, vec3 surf_norm, vec2 uv ) {
		vec3 q0 = dFdx( eye_pos.xyz );
		vec3 q1 = dFdy( eye_pos.xyz );
		vec2 st0 = dFdx( uv.st );
		vec2 st1 = dFdy( uv.st );
		vec3 N = surf_norm;
		vec3 q1perp = cross( q1, N );
		vec3 q0perp = cross( N, q0 );
		vec3 T = q1perp * st0.x + q0perp * st1.x;
		vec3 B = q1perp * st0.y + q0perp * st1.y;
		float det = max( dot( T, T ), dot( B, B ) );
		float scale = ( det == 0.0 ) ? 0.0 : inversesqrt( det );
		return mat3( T * scale, B * scale, N );
	}
#endif`,uNe=`#ifdef USE_CLEARCOAT
	vec3 clearcoatNormal = nonPerturbedNormal;
#endif`,hNe=`#ifdef USE_CLEARCOAT_NORMALMAP
	vec3 clearcoatMapN = texture2D( clearcoatNormalMap, vClearcoatNormalMapUv ).xyz * 2.0 - 1.0;
	clearcoatMapN.xy *= clearcoatNormalScale;
	clearcoatNormal = normalize( tbn2 * clearcoatMapN );
#endif`,dNe=`#ifdef USE_CLEARCOATMAP
	uniform sampler2D clearcoatMap;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform sampler2D clearcoatNormalMap;
	uniform vec2 clearcoatNormalScale;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform sampler2D clearcoatRoughnessMap;
#endif`,fNe=`#ifdef USE_IRIDESCENCEMAP
	uniform sampler2D iridescenceMap;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform sampler2D iridescenceThicknessMap;
#endif`,pNe=`#ifdef OPAQUE
diffuseColor.a = 1.0;
#endif
#ifdef USE_TRANSMISSION
diffuseColor.a *= material.transmissionAlpha;
#endif
gl_FragColor = vec4( outgoingLight, diffuseColor.a );`,mNe=`vec3 packNormalToRGB( const in vec3 normal ) {
	return normalize( normal ) * 0.5 + 0.5;
}
vec3 unpackRGBToNormal( const in vec3 rgb ) {
	return 2.0 * rgb.xyz - 1.0;
}
const float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;const float ShiftRight8 = 1. / 256.;
const float Inv255 = 1. / 255.;
const vec4 PackFactors = vec4( 1.0, 256.0, 256.0 * 256.0, 256.0 * 256.0 * 256.0 );
const vec2 UnpackFactors2 = vec2( UnpackDownscale, 1.0 / PackFactors.g );
const vec3 UnpackFactors3 = vec3( UnpackDownscale / PackFactors.rg, 1.0 / PackFactors.b );
const vec4 UnpackFactors4 = vec4( UnpackDownscale / PackFactors.rgb, 1.0 / PackFactors.a );
vec4 packDepthToRGBA( const in float v ) {
	if( v <= 0.0 )
		return vec4( 0., 0., 0., 0. );
	if( v >= 1.0 )
		return vec4( 1., 1., 1., 1. );
	float vuf;
	float af = modf( v * PackFactors.a, vuf );
	float bf = modf( vuf * ShiftRight8, vuf );
	float gf = modf( vuf * ShiftRight8, vuf );
	return vec4( vuf * Inv255, gf * PackUpscale, bf * PackUpscale, af );
}
vec3 packDepthToRGB( const in float v ) {
	if( v <= 0.0 )
		return vec3( 0., 0., 0. );
	if( v >= 1.0 )
		return vec3( 1., 1., 1. );
	float vuf;
	float bf = modf( v * PackFactors.b, vuf );
	float gf = modf( vuf * ShiftRight8, vuf );
	return vec3( vuf * Inv255, gf * PackUpscale, bf );
}
vec2 packDepthToRG( const in float v ) {
	if( v <= 0.0 )
		return vec2( 0., 0. );
	if( v >= 1.0 )
		return vec2( 1., 1. );
	float vuf;
	float gf = modf( v * 256., vuf );
	return vec2( vuf * Inv255, gf );
}
float unpackRGBAToDepth( const in vec4 v ) {
	return dot( v, UnpackFactors4 );
}
float unpackRGBToDepth( const in vec3 v ) {
	return dot( v, UnpackFactors3 );
}
float unpackRGToDepth( const in vec2 v ) {
	return v.r * UnpackFactors2.r + v.g * UnpackFactors2.g;
}
vec4 pack2HalfToRGBA( const in vec2 v ) {
	vec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );
	return vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );
}
vec2 unpackRGBATo2Half( const in vec4 v ) {
	return vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );
}
float viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {
	return ( viewZ + near ) / ( near - far );
}
float orthographicDepthToViewZ( const in float depth, const in float near, const in float far ) {
	return depth * ( near - far ) - near;
}
float viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {
	return ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );
}
float perspectiveDepthToViewZ( const in float depth, const in float near, const in float far ) {
	return ( near * far ) / ( ( far - near ) * depth - far );
}`,gNe=`#ifdef PREMULTIPLIED_ALPHA
	gl_FragColor.rgb *= gl_FragColor.a;
#endif`,vNe=`vec4 mvPosition = vec4( transformed, 1.0 );
#ifdef USE_BATCHING
	mvPosition = batchingMatrix * mvPosition;
#endif
#ifdef USE_INSTANCING
	mvPosition = instanceMatrix * mvPosition;
#endif
mvPosition = modelViewMatrix * mvPosition;
gl_Position = projectionMatrix * mvPosition;`,_Ne=`#ifdef DITHERING
	gl_FragColor.rgb = dithering( gl_FragColor.rgb );
#endif`,yNe=`#ifdef DITHERING
	vec3 dithering( vec3 color ) {
		float grid_position = rand( gl_FragCoord.xy );
		vec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );
		dither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );
		return color + dither_shift_RGB;
	}
#endif`,bNe=`float roughnessFactor = roughness;
#ifdef USE_ROUGHNESSMAP
	vec4 texelRoughness = texture2D( roughnessMap, vRoughnessMapUv );
	roughnessFactor *= texelRoughness.g;
#endif`,ENe=`#ifdef USE_ROUGHNESSMAP
	uniform sampler2D roughnessMap;
#endif`,SNe=`#if NUM_SPOT_LIGHT_COORDS > 0
	varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#if NUM_SPOT_LIGHT_MAPS > 0
	uniform sampler2D spotLightMap[ NUM_SPOT_LIGHT_MAPS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		uniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];
		struct SpotLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
	float texture2DCompare( sampler2D depths, vec2 uv, float compare ) {
		return step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );
	}
	vec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {
		return unpackRGBATo2Half( texture2D( shadow, uv ) );
	}
	float VSMShadow (sampler2D shadow, vec2 uv, float compare ){
		float occlusion = 1.0;
		vec2 distribution = texture2DDistribution( shadow, uv );
		float hard_shadow = step( compare , distribution.x );
		if (hard_shadow != 1.0 ) {
			float distance = compare - distribution.x ;
			float variance = max( 0.00000, distribution.y * distribution.y );
			float softness_probability = variance / (variance + distance * distance );			softness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );			occlusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );
		}
		return occlusion;
	}
	float getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowIntensity, float shadowBias, float shadowRadius, vec4 shadowCoord ) {
		float shadow = 1.0;
		shadowCoord.xyz /= shadowCoord.w;
		shadowCoord.z += shadowBias;
		bool inFrustum = shadowCoord.x >= 0.0 && shadowCoord.x <= 1.0 && shadowCoord.y >= 0.0 && shadowCoord.y <= 1.0;
		bool frustumTest = inFrustum && shadowCoord.z <= 1.0;
		if ( frustumTest ) {
		#if defined( SHADOWMAP_TYPE_PCF )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx0 = - texelSize.x * shadowRadius;
			float dy0 = - texelSize.y * shadowRadius;
			float dx1 = + texelSize.x * shadowRadius;
			float dy1 = + texelSize.y * shadowRadius;
			float dx2 = dx0 / 2.0;
			float dy2 = dy0 / 2.0;
			float dx3 = dx1 / 2.0;
			float dy3 = dy1 / 2.0;
			shadow = (
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )
			) * ( 1.0 / 17.0 );
		#elif defined( SHADOWMAP_TYPE_PCF_SOFT )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx = texelSize.x;
			float dy = texelSize.y;
			vec2 uv = shadowCoord.xy;
			vec2 f = fract( uv * shadowMapSize + 0.5 );
			uv -= f * texelSize;
			shadow = (
				texture2DCompare( shadowMap, uv, shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),
						  f.x ),
					 mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),
						  f.x ),
					 f.y )
			) * ( 1.0 / 9.0 );
		#elif defined( SHADOWMAP_TYPE_VSM )
			shadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );
		#else
			shadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );
		#endif
		}
		return mix( 1.0, shadow, shadowIntensity );
	}
	vec2 cubeToUV( vec3 v, float texelSizeY ) {
		vec3 absV = abs( v );
		float scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );
		absV *= scaleToCube;
		v *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );
		vec2 planar = v.xy;
		float almostATexel = 1.5 * texelSizeY;
		float almostOne = 1.0 - almostATexel;
		if ( absV.z >= almostOne ) {
			if ( v.z > 0.0 )
				planar.x = 4.0 - v.x;
		} else if ( absV.x >= almostOne ) {
			float signX = sign( v.x );
			planar.x = v.z * signX + 2.0 * signX;
		} else if ( absV.y >= almostOne ) {
			float signY = sign( v.y );
			planar.x = v.x + 2.0 * signY + 2.0;
			planar.y = v.z * signY - 2.0;
		}
		return vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );
	}
	float getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowIntensity, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {
		float shadow = 1.0;
		vec3 lightToPosition = shadowCoord.xyz;
		
		float lightToPositionLength = length( lightToPosition );
		if ( lightToPositionLength - shadowCameraFar <= 0.0 && lightToPositionLength - shadowCameraNear >= 0.0 ) {
			float dp = ( lightToPositionLength - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );			dp += shadowBias;
			vec3 bd3D = normalize( lightToPosition );
			vec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );
			#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )
				vec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;
				shadow = (
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )
				) * ( 1.0 / 9.0 );
			#else
				shadow = texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );
			#endif
		}
		return mix( 1.0, shadow, shadowIntensity );
	}
#endif`,TNe=`#if NUM_SPOT_LIGHT_COORDS > 0
	uniform mat4 spotLightMatrix[ NUM_SPOT_LIGHT_COORDS ];
	varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		struct SpotLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
#endif`,xNe=`#if ( defined( USE_SHADOWMAP ) && ( NUM_DIR_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0 ) ) || ( NUM_SPOT_LIGHT_COORDS > 0 )
	vec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
	vec4 shadowWorldPosition;
#endif
#if defined( USE_SHADOWMAP )
	#if NUM_DIR_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );
			vDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );
			vPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
#endif
#if NUM_SPOT_LIGHT_COORDS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_COORDS; i ++ ) {
		shadowWorldPosition = worldPosition;
		#if ( defined( USE_SHADOWMAP ) && UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
			shadowWorldPosition.xyz += shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias;
		#endif
		vSpotLightCoord[ i ] = spotLightMatrix[ i ] * shadowWorldPosition;
	}
	#pragma unroll_loop_end
#endif`,wNe=`float getShadowMask() {
	float shadow = 1.0;
	#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
		directionalLight = directionalLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowIntensity, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {
		spotLight = spotLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowIntensity, spotLight.shadowBias, spotLight.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
		pointLight = pointLightShadows[ i ];
		shadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowIntensity, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#endif
	return shadow;
}`,CNe=`#ifdef USE_SKINNING
	mat4 boneMatX = getBoneMatrix( skinIndex.x );
	mat4 boneMatY = getBoneMatrix( skinIndex.y );
	mat4 boneMatZ = getBoneMatrix( skinIndex.z );
	mat4 boneMatW = getBoneMatrix( skinIndex.w );
#endif`,ANe=`#ifdef USE_SKINNING
	uniform mat4 bindMatrix;
	uniform mat4 bindMatrixInverse;
	uniform highp sampler2D boneTexture;
	mat4 getBoneMatrix( const in float i ) {
		int size = textureSize( boneTexture, 0 ).x;
		int j = int( i ) * 4;
		int x = j % size;
		int y = j / size;
		vec4 v1 = texelFetch( boneTexture, ivec2( x, y ), 0 );
		vec4 v2 = texelFetch( boneTexture, ivec2( x + 1, y ), 0 );
		vec4 v3 = texelFetch( boneTexture, ivec2( x + 2, y ), 0 );
		vec4 v4 = texelFetch( boneTexture, ivec2( x + 3, y ), 0 );
		return mat4( v1, v2, v3, v4 );
	}
#endif`,RNe=`#ifdef USE_SKINNING
	vec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );
	vec4 skinned = vec4( 0.0 );
	skinned += boneMatX * skinVertex * skinWeight.x;
	skinned += boneMatY * skinVertex * skinWeight.y;
	skinned += boneMatZ * skinVertex * skinWeight.z;
	skinned += boneMatW * skinVertex * skinWeight.w;
	transformed = ( bindMatrixInverse * skinned ).xyz;
#endif`,MNe=`#ifdef USE_SKINNING
	mat4 skinMatrix = mat4( 0.0 );
	skinMatrix += skinWeight.x * boneMatX;
	skinMatrix += skinWeight.y * boneMatY;
	skinMatrix += skinWeight.z * boneMatZ;
	skinMatrix += skinWeight.w * boneMatW;
	skinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;
	objectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;
	#ifdef USE_TANGENT
		objectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#endif
#endif`,ONe=`float specularStrength;
#ifdef USE_SPECULARMAP
	vec4 texelSpecular = texture2D( specularMap, vSpecularMapUv );
	specularStrength = texelSpecular.r;
#else
	specularStrength = 1.0;
#endif`,NNe=`#ifdef USE_SPECULARMAP
	uniform sampler2D specularMap;
#endif`,INe=`#if defined( TONE_MAPPING )
	gl_FragColor.rgb = toneMapping( gl_FragColor.rgb );
#endif`,kNe=`#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
uniform float toneMappingExposure;
vec3 LinearToneMapping( vec3 color ) {
	return saturate( toneMappingExposure * color );
}
vec3 ReinhardToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	return saturate( color / ( vec3( 1.0 ) + color ) );
}
vec3 CineonToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	color = max( vec3( 0.0 ), color - 0.004 );
	return pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );
}
vec3 RRTAndODTFit( vec3 v ) {
	vec3 a = v * ( v + 0.0245786 ) - 0.000090537;
	vec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;
	return a / b;
}
vec3 ACESFilmicToneMapping( vec3 color ) {
	const mat3 ACESInputMat = mat3(
		vec3( 0.59719, 0.07600, 0.02840 ),		vec3( 0.35458, 0.90834, 0.13383 ),
		vec3( 0.04823, 0.01566, 0.83777 )
	);
	const mat3 ACESOutputMat = mat3(
		vec3(  1.60475, -0.10208, -0.00327 ),		vec3( -0.53108,  1.10813, -0.07276 ),
		vec3( -0.07367, -0.00605,  1.07602 )
	);
	color *= toneMappingExposure / 0.6;
	color = ACESInputMat * color;
	color = RRTAndODTFit( color );
	color = ACESOutputMat * color;
	return saturate( color );
}
const mat3 LINEAR_REC2020_TO_LINEAR_SRGB = mat3(
	vec3( 1.6605, - 0.1246, - 0.0182 ),
	vec3( - 0.5876, 1.1329, - 0.1006 ),
	vec3( - 0.0728, - 0.0083, 1.1187 )
);
const mat3 LINEAR_SRGB_TO_LINEAR_REC2020 = mat3(
	vec3( 0.6274, 0.0691, 0.0164 ),
	vec3( 0.3293, 0.9195, 0.0880 ),
	vec3( 0.0433, 0.0113, 0.8956 )
);
vec3 agxDefaultContrastApprox( vec3 x ) {
	vec3 x2 = x * x;
	vec3 x4 = x2 * x2;
	return + 15.5 * x4 * x2
		- 40.14 * x4 * x
		+ 31.96 * x4
		- 6.868 * x2 * x
		+ 0.4298 * x2
		+ 0.1191 * x
		- 0.00232;
}
vec3 AgXToneMapping( vec3 color ) {
	const mat3 AgXInsetMatrix = mat3(
		vec3( 0.856627153315983, 0.137318972929847, 0.11189821299995 ),
		vec3( 0.0951212405381588, 0.761241990602591, 0.0767994186031903 ),
		vec3( 0.0482516061458583, 0.101439036467562, 0.811302368396859 )
	);
	const mat3 AgXOutsetMatrix = mat3(
		vec3( 1.1271005818144368, - 0.1413297634984383, - 0.14132976349843826 ),
		vec3( - 0.11060664309660323, 1.157823702216272, - 0.11060664309660294 ),
		vec3( - 0.016493938717834573, - 0.016493938717834257, 1.2519364065950405 )
	);
	const float AgxMinEv = - 12.47393;	const float AgxMaxEv = 4.026069;
	color *= toneMappingExposure;
	color = LINEAR_SRGB_TO_LINEAR_REC2020 * color;
	color = AgXInsetMatrix * color;
	color = max( color, 1e-10 );	color = log2( color );
	color = ( color - AgxMinEv ) / ( AgxMaxEv - AgxMinEv );
	color = clamp( color, 0.0, 1.0 );
	color = agxDefaultContrastApprox( color );
	color = AgXOutsetMatrix * color;
	color = pow( max( vec3( 0.0 ), color ), vec3( 2.2 ) );
	color = LINEAR_REC2020_TO_LINEAR_SRGB * color;
	color = clamp( color, 0.0, 1.0 );
	return color;
}
vec3 NeutralToneMapping( vec3 color ) {
	const float StartCompression = 0.8 - 0.04;
	const float Desaturation = 0.15;
	color *= toneMappingExposure;
	float x = min( color.r, min( color.g, color.b ) );
	float offset = x < 0.08 ? x - 6.25 * x * x : 0.04;
	color -= offset;
	float peak = max( color.r, max( color.g, color.b ) );
	if ( peak < StartCompression ) return color;
	float d = 1. - StartCompression;
	float newPeak = 1. - d * d / ( peak + d - StartCompression );
	color *= newPeak / peak;
	float g = 1. - 1. / ( Desaturation * ( peak - newPeak ) + 1. );
	return mix( color, vec3( newPeak ), g );
}
vec3 CustomToneMapping( vec3 color ) { return color; }`,PNe=`#ifdef USE_TRANSMISSION
	material.transmission = transmission;
	material.transmissionAlpha = 1.0;
	material.thickness = thickness;
	material.attenuationDistance = attenuationDistance;
	material.attenuationColor = attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		material.transmission *= texture2D( transmissionMap, vTransmissionMapUv ).r;
	#endif
	#ifdef USE_THICKNESSMAP
		material.thickness *= texture2D( thicknessMap, vThicknessMapUv ).g;
	#endif
	vec3 pos = vWorldPosition;
	vec3 v = normalize( cameraPosition - pos );
	vec3 n = inverseTransformDirection( normal, viewMatrix );
	vec4 transmitted = getIBLVolumeRefraction(
		n, v, material.roughness, material.diffuseColor, material.specularColor, material.specularF90,
		pos, modelMatrix, viewMatrix, projectionMatrix, material.dispersion, material.ior, material.thickness,
		material.attenuationColor, material.attenuationDistance );
	material.transmissionAlpha = mix( material.transmissionAlpha, transmitted.a, material.transmission );
	totalDiffuse = mix( totalDiffuse, transmitted.rgb, material.transmission );
#endif`,DNe=`#ifdef USE_TRANSMISSION
	uniform float transmission;
	uniform float thickness;
	uniform float attenuationDistance;
	uniform vec3 attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		uniform sampler2D transmissionMap;
	#endif
	#ifdef USE_THICKNESSMAP
		uniform sampler2D thicknessMap;
	#endif
	uniform vec2 transmissionSamplerSize;
	uniform sampler2D transmissionSamplerMap;
	uniform mat4 modelMatrix;
	uniform mat4 projectionMatrix;
	varying vec3 vWorldPosition;
	float w0( float a ) {
		return ( 1.0 / 6.0 ) * ( a * ( a * ( - a + 3.0 ) - 3.0 ) + 1.0 );
	}
	float w1( float a ) {
		return ( 1.0 / 6.0 ) * ( a *  a * ( 3.0 * a - 6.0 ) + 4.0 );
	}
	float w2( float a ){
		return ( 1.0 / 6.0 ) * ( a * ( a * ( - 3.0 * a + 3.0 ) + 3.0 ) + 1.0 );
	}
	float w3( float a ) {
		return ( 1.0 / 6.0 ) * ( a * a * a );
	}
	float g0( float a ) {
		return w0( a ) + w1( a );
	}
	float g1( float a ) {
		return w2( a ) + w3( a );
	}
	float h0( float a ) {
		return - 1.0 + w1( a ) / ( w0( a ) + w1( a ) );
	}
	float h1( float a ) {
		return 1.0 + w3( a ) / ( w2( a ) + w3( a ) );
	}
	vec4 bicubic( sampler2D tex, vec2 uv, vec4 texelSize, float lod ) {
		uv = uv * texelSize.zw + 0.5;
		vec2 iuv = floor( uv );
		vec2 fuv = fract( uv );
		float g0x = g0( fuv.x );
		float g1x = g1( fuv.x );
		float h0x = h0( fuv.x );
		float h1x = h1( fuv.x );
		float h0y = h0( fuv.y );
		float h1y = h1( fuv.y );
		vec2 p0 = ( vec2( iuv.x + h0x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
		vec2 p1 = ( vec2( iuv.x + h1x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
		vec2 p2 = ( vec2( iuv.x + h0x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
		vec2 p3 = ( vec2( iuv.x + h1x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
		return g0( fuv.y ) * ( g0x * textureLod( tex, p0, lod ) + g1x * textureLod( tex, p1, lod ) ) +
			g1( fuv.y ) * ( g0x * textureLod( tex, p2, lod ) + g1x * textureLod( tex, p3, lod ) );
	}
	vec4 textureBicubic( sampler2D sampler, vec2 uv, float lod ) {
		vec2 fLodSize = vec2( textureSize( sampler, int( lod ) ) );
		vec2 cLodSize = vec2( textureSize( sampler, int( lod + 1.0 ) ) );
		vec2 fLodSizeInv = 1.0 / fLodSize;
		vec2 cLodSizeInv = 1.0 / cLodSize;
		vec4 fSample = bicubic( sampler, uv, vec4( fLodSizeInv, fLodSize ), floor( lod ) );
		vec4 cSample = bicubic( sampler, uv, vec4( cLodSizeInv, cLodSize ), ceil( lod ) );
		return mix( fSample, cSample, fract( lod ) );
	}
	vec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {
		vec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );
		vec3 modelScale;
		modelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );
		modelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );
		modelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );
		return normalize( refractionVector ) * thickness * modelScale;
	}
	float applyIorToRoughness( const in float roughness, const in float ior ) {
		return roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );
	}
	vec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {
		float lod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );
		return textureBicubic( transmissionSamplerMap, fragCoord.xy, lod );
	}
	vec3 volumeAttenuation( const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {
		if ( isinf( attenuationDistance ) ) {
			return vec3( 1.0 );
		} else {
			vec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;
			vec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );			return transmittance;
		}
	}
	vec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,
		const in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,
		const in mat4 viewMatrix, const in mat4 projMatrix, const in float dispersion, const in float ior, const in float thickness,
		const in vec3 attenuationColor, const in float attenuationDistance ) {
		vec4 transmittedLight;
		vec3 transmittance;
		#ifdef USE_DISPERSION
			float halfSpread = ( ior - 1.0 ) * 0.025 * dispersion;
			vec3 iors = vec3( ior - halfSpread, ior, ior + halfSpread );
			for ( int i = 0; i < 3; i ++ ) {
				vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, iors[ i ], modelMatrix );
				vec3 refractedRayExit = position + transmissionRay;
				vec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );
				vec2 refractionCoords = ndcPos.xy / ndcPos.w;
				refractionCoords += 1.0;
				refractionCoords /= 2.0;
				vec4 transmissionSample = getTransmissionSample( refractionCoords, roughness, iors[ i ] );
				transmittedLight[ i ] = transmissionSample[ i ];
				transmittedLight.a += transmissionSample.a;
				transmittance[ i ] = diffuseColor[ i ] * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance )[ i ];
			}
			transmittedLight.a /= 3.0;
		#else
			vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );
			vec3 refractedRayExit = position + transmissionRay;
			vec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );
			vec2 refractionCoords = ndcPos.xy / ndcPos.w;
			refractionCoords += 1.0;
			refractionCoords /= 2.0;
			transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );
			transmittance = diffuseColor * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance );
		#endif
		vec3 attenuatedColor = transmittance * transmittedLight.rgb;
		vec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );
		float transmittanceFactor = ( transmittance.r + transmittance.g + transmittance.b ) / 3.0;
		return vec4( ( 1.0 - F ) * attenuatedColor, 1.0 - ( 1.0 - transmittedLight.a ) * transmittanceFactor );
	}
#endif`,LNe=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	varying vec2 vUv;
#endif
#ifdef USE_MAP
	varying vec2 vMapUv;
#endif
#ifdef USE_ALPHAMAP
	varying vec2 vAlphaMapUv;
#endif
#ifdef USE_LIGHTMAP
	varying vec2 vLightMapUv;
#endif
#ifdef USE_AOMAP
	varying vec2 vAoMapUv;
#endif
#ifdef USE_BUMPMAP
	varying vec2 vBumpMapUv;
#endif
#ifdef USE_NORMALMAP
	varying vec2 vNormalMapUv;
#endif
#ifdef USE_EMISSIVEMAP
	varying vec2 vEmissiveMapUv;
#endif
#ifdef USE_METALNESSMAP
	varying vec2 vMetalnessMapUv;
#endif
#ifdef USE_ROUGHNESSMAP
	varying vec2 vRoughnessMapUv;
#endif
#ifdef USE_ANISOTROPYMAP
	varying vec2 vAnisotropyMapUv;
#endif
#ifdef USE_CLEARCOATMAP
	varying vec2 vClearcoatMapUv;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	varying vec2 vClearcoatNormalMapUv;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	varying vec2 vClearcoatRoughnessMapUv;
#endif
#ifdef USE_IRIDESCENCEMAP
	varying vec2 vIridescenceMapUv;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	varying vec2 vIridescenceThicknessMapUv;
#endif
#ifdef USE_SHEEN_COLORMAP
	varying vec2 vSheenColorMapUv;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	varying vec2 vSheenRoughnessMapUv;
#endif
#ifdef USE_SPECULARMAP
	varying vec2 vSpecularMapUv;
#endif
#ifdef USE_SPECULAR_COLORMAP
	varying vec2 vSpecularColorMapUv;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	varying vec2 vSpecularIntensityMapUv;
#endif
#ifdef USE_TRANSMISSIONMAP
	uniform mat3 transmissionMapTransform;
	varying vec2 vTransmissionMapUv;
#endif
#ifdef USE_THICKNESSMAP
	uniform mat3 thicknessMapTransform;
	varying vec2 vThicknessMapUv;
#endif`,UNe=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	varying vec2 vUv;
#endif
#ifdef USE_MAP
	uniform mat3 mapTransform;
	varying vec2 vMapUv;
#endif
#ifdef USE_ALPHAMAP
	uniform mat3 alphaMapTransform;
	varying vec2 vAlphaMapUv;
#endif
#ifdef USE_LIGHTMAP
	uniform mat3 lightMapTransform;
	varying vec2 vLightMapUv;
#endif
#ifdef USE_AOMAP
	uniform mat3 aoMapTransform;
	varying vec2 vAoMapUv;
#endif
#ifdef USE_BUMPMAP
	uniform mat3 bumpMapTransform;
	varying vec2 vBumpMapUv;
#endif
#ifdef USE_NORMALMAP
	uniform mat3 normalMapTransform;
	varying vec2 vNormalMapUv;
#endif
#ifdef USE_DISPLACEMENTMAP
	uniform mat3 displacementMapTransform;
	varying vec2 vDisplacementMapUv;
#endif
#ifdef USE_EMISSIVEMAP
	uniform mat3 emissiveMapTransform;
	varying vec2 vEmissiveMapUv;
#endif
#ifdef USE_METALNESSMAP
	uniform mat3 metalnessMapTransform;
	varying vec2 vMetalnessMapUv;
#endif
#ifdef USE_ROUGHNESSMAP
	uniform mat3 roughnessMapTransform;
	varying vec2 vRoughnessMapUv;
#endif
#ifdef USE_ANISOTROPYMAP
	uniform mat3 anisotropyMapTransform;
	varying vec2 vAnisotropyMapUv;
#endif
#ifdef USE_CLEARCOATMAP
	uniform mat3 clearcoatMapTransform;
	varying vec2 vClearcoatMapUv;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform mat3 clearcoatNormalMapTransform;
	varying vec2 vClearcoatNormalMapUv;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform mat3 clearcoatRoughnessMapTransform;
	varying vec2 vClearcoatRoughnessMapUv;
#endif
#ifdef USE_SHEEN_COLORMAP
	uniform mat3 sheenColorMapTransform;
	varying vec2 vSheenColorMapUv;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	uniform mat3 sheenRoughnessMapTransform;
	varying vec2 vSheenRoughnessMapUv;
#endif
#ifdef USE_IRIDESCENCEMAP
	uniform mat3 iridescenceMapTransform;
	varying vec2 vIridescenceMapUv;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform mat3 iridescenceThicknessMapTransform;
	varying vec2 vIridescenceThicknessMapUv;
#endif
#ifdef USE_SPECULARMAP
	uniform mat3 specularMapTransform;
	varying vec2 vSpecularMapUv;
#endif
#ifdef USE_SPECULAR_COLORMAP
	uniform mat3 specularColorMapTransform;
	varying vec2 vSpecularColorMapUv;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	uniform mat3 specularIntensityMapTransform;
	varying vec2 vSpecularIntensityMapUv;
#endif
#ifdef USE_TRANSMISSIONMAP
	uniform mat3 transmissionMapTransform;
	varying vec2 vTransmissionMapUv;
#endif
#ifdef USE_THICKNESSMAP
	uniform mat3 thicknessMapTransform;
	varying vec2 vThicknessMapUv;
#endif`,BNe=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	vUv = vec3( uv, 1 ).xy;
#endif
#ifdef USE_MAP
	vMapUv = ( mapTransform * vec3( MAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ALPHAMAP
	vAlphaMapUv = ( alphaMapTransform * vec3( ALPHAMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_LIGHTMAP
	vLightMapUv = ( lightMapTransform * vec3( LIGHTMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_AOMAP
	vAoMapUv = ( aoMapTransform * vec3( AOMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_BUMPMAP
	vBumpMapUv = ( bumpMapTransform * vec3( BUMPMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_NORMALMAP
	vNormalMapUv = ( normalMapTransform * vec3( NORMALMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_DISPLACEMENTMAP
	vDisplacementMapUv = ( displacementMapTransform * vec3( DISPLACEMENTMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_EMISSIVEMAP
	vEmissiveMapUv = ( emissiveMapTransform * vec3( EMISSIVEMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_METALNESSMAP
	vMetalnessMapUv = ( metalnessMapTransform * vec3( METALNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ROUGHNESSMAP
	vRoughnessMapUv = ( roughnessMapTransform * vec3( ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ANISOTROPYMAP
	vAnisotropyMapUv = ( anisotropyMapTransform * vec3( ANISOTROPYMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOATMAP
	vClearcoatMapUv = ( clearcoatMapTransform * vec3( CLEARCOATMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	vClearcoatNormalMapUv = ( clearcoatNormalMapTransform * vec3( CLEARCOAT_NORMALMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	vClearcoatRoughnessMapUv = ( clearcoatRoughnessMapTransform * vec3( CLEARCOAT_ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_IRIDESCENCEMAP
	vIridescenceMapUv = ( iridescenceMapTransform * vec3( IRIDESCENCEMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	vIridescenceThicknessMapUv = ( iridescenceThicknessMapTransform * vec3( IRIDESCENCE_THICKNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SHEEN_COLORMAP
	vSheenColorMapUv = ( sheenColorMapTransform * vec3( SHEEN_COLORMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	vSheenRoughnessMapUv = ( sheenRoughnessMapTransform * vec3( SHEEN_ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULARMAP
	vSpecularMapUv = ( specularMapTransform * vec3( SPECULARMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULAR_COLORMAP
	vSpecularColorMapUv = ( specularColorMapTransform * vec3( SPECULAR_COLORMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	vSpecularIntensityMapUv = ( specularIntensityMapTransform * vec3( SPECULAR_INTENSITYMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_TRANSMISSIONMAP
	vTransmissionMapUv = ( transmissionMapTransform * vec3( TRANSMISSIONMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_THICKNESSMAP
	vThicknessMapUv = ( thicknessMapTransform * vec3( THICKNESSMAP_UV, 1 ) ).xy;
#endif`,FNe=`#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION ) || NUM_SPOT_LIGHT_COORDS > 0
	vec4 worldPosition = vec4( transformed, 1.0 );
	#ifdef USE_BATCHING
		worldPosition = batchingMatrix * worldPosition;
	#endif
	#ifdef USE_INSTANCING
		worldPosition = instanceMatrix * worldPosition;
	#endif
	worldPosition = modelMatrix * worldPosition;
#endif`;const zNe=`varying vec2 vUv;
uniform mat3 uvTransform;
void main() {
	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	gl_Position = vec4( position.xy, 1.0, 1.0 );
}`,jNe=`uniform sampler2D t2D;
uniform float backgroundIntensity;
varying vec2 vUv;
void main() {
	vec4 texColor = texture2D( t2D, vUv );
	#ifdef DECODE_VIDEO_TEXTURE
		texColor = vec4( mix( pow( texColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), texColor.rgb * 0.0773993808, vec3( lessThanEqual( texColor.rgb, vec3( 0.04045 ) ) ) ), texColor.w );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,HNe=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,VNe=`#ifdef ENVMAP_TYPE_CUBE
	uniform samplerCube envMap;
#elif defined( ENVMAP_TYPE_CUBE_UV )
	uniform sampler2D envMap;
#endif
uniform float flipEnvMap;
uniform float backgroundBlurriness;
uniform float backgroundIntensity;
uniform mat3 backgroundRotation;
varying vec3 vWorldDirection;
#include <cube_uv_reflection_fragment>
void main() {
	#ifdef ENVMAP_TYPE_CUBE
		vec4 texColor = textureCube( envMap, backgroundRotation * vec3( flipEnvMap * vWorldDirection.x, vWorldDirection.yz ) );
	#elif defined( ENVMAP_TYPE_CUBE_UV )
		vec4 texColor = textureCubeUV( envMap, backgroundRotation * vWorldDirection, backgroundBlurriness );
	#else
		vec4 texColor = vec4( 0.0, 0.0, 0.0, 1.0 );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,GNe=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,qNe=`uniform samplerCube tCube;
uniform float tFlip;
uniform float opacity;
varying vec3 vWorldDirection;
void main() {
	vec4 texColor = textureCube( tCube, vec3( tFlip * vWorldDirection.x, vWorldDirection.yz ) );
	gl_FragColor = texColor;
	gl_FragColor.a *= opacity;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,$Ne=`#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
varying vec2 vHighPrecisionZW;
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <skinbase_vertex>
	#include <morphinstance_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vHighPrecisionZW = gl_Position.zw;
}`,WNe=`#if DEPTH_PACKING == 3200
	uniform float opacity;
#endif
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
varying vec2 vHighPrecisionZW;
void main() {
	vec4 diffuseColor = vec4( 1.0 );
	#include <clipping_planes_fragment>
	#if DEPTH_PACKING == 3200
		diffuseColor.a = opacity;
	#endif
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <logdepthbuf_fragment>
	float fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;
	#if DEPTH_PACKING == 3200
		gl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );
	#elif DEPTH_PACKING == 3201
		gl_FragColor = packDepthToRGBA( fragCoordZ );
	#elif DEPTH_PACKING == 3202
		gl_FragColor = vec4( packDepthToRGB( fragCoordZ ), 1.0 );
	#elif DEPTH_PACKING == 3203
		gl_FragColor = vec4( packDepthToRG( fragCoordZ ), 0.0, 1.0 );
	#endif
}`,YNe=`#define DISTANCE
varying vec3 vWorldPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <skinbase_vertex>
	#include <morphinstance_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <clipping_planes_vertex>
	vWorldPosition = worldPosition.xyz;
}`,KNe=`#define DISTANCE
uniform vec3 referencePosition;
uniform float nearDistance;
uniform float farDistance;
varying vec3 vWorldPosition;
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <clipping_planes_pars_fragment>
void main () {
	vec4 diffuseColor = vec4( 1.0 );
	#include <clipping_planes_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	float dist = length( vWorldPosition - referencePosition );
	dist = ( dist - nearDistance ) / ( farDistance - nearDistance );
	dist = saturate( dist );
	gl_FragColor = packDepthToRGBA( dist );
}`,XNe=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
}`,ZNe=`uniform sampler2D tEquirect;
varying vec3 vWorldDirection;
#include <common>
void main() {
	vec3 direction = normalize( vWorldDirection );
	vec2 sampleUV = equirectUv( direction );
	gl_FragColor = texture2D( tEquirect, sampleUV );
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,JNe=`uniform float scale;
attribute float lineDistance;
varying float vLineDistance;
#include <common>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	vLineDistance = scale * lineDistance;
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,QNe=`uniform vec3 diffuse;
uniform float opacity;
uniform float dashSize;
uniform float totalSize;
varying float vLineDistance;
#include <common>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	if ( mod( vLineDistance, totalSize ) > dashSize ) {
		discard;
	}
	vec3 outgoingLight = vec3( 0.0 );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,eIe=`#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinbase_vertex>
		#include <skinnormal_vertex>
		#include <defaultnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <fog_vertex>
}`,tIe=`uniform vec3 diffuse;
uniform float opacity;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
		reflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity * RECIPROCAL_PI;
	#else
		reflectedLight.indirectDiffuse += vec3( 1.0 );
	#endif
	#include <aomap_fragment>
	reflectedLight.indirectDiffuse *= diffuseColor.rgb;
	vec3 outgoingLight = reflectedLight.indirectDiffuse;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,nIe=`#define LAMBERT
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,iIe=`#define LAMBERT
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_lambert_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_lambert_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,rIe=`#define MATCAP
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <displacementmap_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
	vViewPosition = - mvPosition.xyz;
}`,sIe=`#define MATCAP
uniform vec3 diffuse;
uniform float opacity;
uniform sampler2D matcap;
varying vec3 vViewPosition;
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	vec3 viewDir = normalize( vViewPosition );
	vec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );
	vec3 y = cross( viewDir, x );
	vec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;
	#ifdef USE_MATCAP
		vec4 matcapColor = texture2D( matcap, uv );
	#else
		vec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 );
	#endif
	vec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,aIe=`#define NORMAL
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	varying vec3 vViewPosition;
#endif
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphinstance_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	vViewPosition = - mvPosition.xyz;
#endif
}`,oIe=`#define NORMAL
uniform float opacity;
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	varying vec3 vViewPosition;
#endif
#include <packing>
#include <uv_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( 0.0, 0.0, 0.0, opacity );
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	gl_FragColor = vec4( packNormalToRGB( normal ), diffuseColor.a );
	#ifdef OPAQUE
		gl_FragColor.a = 1.0;
	#endif
}`,cIe=`#define PHONG
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphinstance_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,lIe=`#define PHONG
uniform vec3 diffuse;
uniform vec3 emissive;
uniform vec3 specular;
uniform float shininess;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_phong_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_phong_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,uIe=`#define STANDARD
varying vec3 vViewPosition;
#ifdef USE_TRANSMISSION
	varying vec3 vWorldPosition;
#endif
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
#ifdef USE_TRANSMISSION
	vWorldPosition = worldPosition.xyz;
#endif
}`,hIe=`#define STANDARD
#ifdef PHYSICAL
	#define IOR
	#define USE_SPECULAR
#endif
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float roughness;
uniform float metalness;
uniform float opacity;
#ifdef IOR
	uniform float ior;
#endif
#ifdef USE_SPECULAR
	uniform float specularIntensity;
	uniform vec3 specularColor;
	#ifdef USE_SPECULAR_COLORMAP
		uniform sampler2D specularColorMap;
	#endif
	#ifdef USE_SPECULAR_INTENSITYMAP
		uniform sampler2D specularIntensityMap;
	#endif
#endif
#ifdef USE_CLEARCOAT
	uniform float clearcoat;
	uniform float clearcoatRoughness;
#endif
#ifdef USE_DISPERSION
	uniform float dispersion;
#endif
#ifdef USE_IRIDESCENCE
	uniform float iridescence;
	uniform float iridescenceIOR;
	uniform float iridescenceThicknessMinimum;
	uniform float iridescenceThicknessMaximum;
#endif
#ifdef USE_SHEEN
	uniform vec3 sheenColor;
	uniform float sheenRoughness;
	#ifdef USE_SHEEN_COLORMAP
		uniform sampler2D sheenColorMap;
	#endif
	#ifdef USE_SHEEN_ROUGHNESSMAP
		uniform sampler2D sheenRoughnessMap;
	#endif
#endif
#ifdef USE_ANISOTROPY
	uniform vec2 anisotropyVector;
	#ifdef USE_ANISOTROPYMAP
		uniform sampler2D anisotropyMap;
	#endif
#endif
varying vec3 vViewPosition;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <iridescence_fragment>
#include <cube_uv_reflection_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_physical_pars_fragment>
#include <fog_pars_fragment>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_physical_pars_fragment>
#include <transmission_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <clearcoat_pars_fragment>
#include <iridescence_pars_fragment>
#include <roughnessmap_pars_fragment>
#include <metalnessmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <roughnessmap_fragment>
	#include <metalnessmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <clearcoat_normal_fragment_begin>
	#include <clearcoat_normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_physical_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;
	vec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;
	#include <transmission_fragment>
	vec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;
	#ifdef USE_SHEEN
		float sheenEnergyComp = 1.0 - 0.157 * max3( material.sheenColor );
		outgoingLight = outgoingLight * sheenEnergyComp + sheenSpecularDirect + sheenSpecularIndirect;
	#endif
	#ifdef USE_CLEARCOAT
		float dotNVcc = saturate( dot( geometryClearcoatNormal, geometryViewDir ) );
		vec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );
		outgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + ( clearcoatSpecularDirect + clearcoatSpecularIndirect ) * material.clearcoat;
	#endif
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,dIe=`#define TOON
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,fIe=`#define TOON
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <gradientmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_toon_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_toon_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,pIe=`uniform float size;
uniform float scale;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
#ifdef USE_POINTS_UV
	varying vec2 vUv;
	uniform mat3 uvTransform;
#endif
void main() {
	#ifdef USE_POINTS_UV
		vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	#endif
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	gl_PointSize = size;
	#ifdef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );
	#endif
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <fog_vertex>
}`,mIe=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <color_pars_fragment>
#include <map_particle_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	#include <logdepthbuf_fragment>
	#include <map_particle_fragment>
	#include <color_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,gIe=`#include <common>
#include <batching_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <shadowmap_pars_vertex>
void main() {
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphinstance_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,vIe=`uniform vec3 color;
uniform float opacity;
#include <common>
#include <packing>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <logdepthbuf_pars_fragment>
#include <shadowmap_pars_fragment>
#include <shadowmask_pars_fragment>
void main() {
	#include <logdepthbuf_fragment>
	gl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
}`,_Ie=`uniform float rotation;
uniform vec2 center;
#include <common>
#include <uv_pars_vertex>
#include <fog_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	vec4 mvPosition = modelViewMatrix[ 3 ];
	vec2 scale = vec2( length( modelMatrix[ 0 ].xyz ), length( modelMatrix[ 1 ].xyz ) );
	#ifndef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) scale *= - mvPosition.z;
	#endif
	vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;
	vec2 rotatedPosition;
	rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;
	rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;
	mvPosition.xy += rotatedPosition;
	gl_Position = projectionMatrix * mvPosition;
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,yIe=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
}`,rr={alphahash_fragment:jMe,alphahash_pars_fragment:HMe,alphamap_fragment:VMe,alphamap_pars_fragment:GMe,alphatest_fragment:qMe,alphatest_pars_fragment:$Me,aomap_fragment:WMe,aomap_pars_fragment:YMe,batching_pars_vertex:KMe,batching_vertex:XMe,begin_vertex:ZMe,beginnormal_vertex:JMe,bsdfs:QMe,iridescence_fragment:eOe,bumpmap_pars_fragment:tOe,clipping_planes_fragment:nOe,clipping_planes_pars_fragment:iOe,clipping_planes_pars_vertex:rOe,clipping_planes_vertex:sOe,color_fragment:aOe,color_pars_fragment:oOe,color_pars_vertex:cOe,color_vertex:lOe,common:uOe,cube_uv_reflection_fragment:hOe,defaultnormal_vertex:dOe,displacementmap_pars_vertex:fOe,displacementmap_vertex:pOe,emissivemap_fragment:mOe,emissivemap_pars_fragment:gOe,colorspace_fragment:vOe,colorspace_pars_fragment:_Oe,envmap_fragment:yOe,envmap_common_pars_fragment:bOe,envmap_pars_fragment:EOe,envmap_pars_vertex:SOe,envmap_physical_pars_fragment:kOe,envmap_vertex:TOe,fog_vertex:xOe,fog_pars_vertex:wOe,fog_fragment:COe,fog_pars_fragment:AOe,gradientmap_pars_fragment:ROe,lightmap_pars_fragment:MOe,lights_lambert_fragment:OOe,lights_lambert_pars_fragment:NOe,lights_pars_begin:IOe,lights_toon_fragment:POe,lights_toon_pars_fragment:DOe,lights_phong_fragment:LOe,lights_phong_pars_fragment:UOe,lights_physical_fragment:BOe,lights_physical_pars_fragment:FOe,lights_fragment_begin:zOe,lights_fragment_maps:jOe,lights_fragment_end:HOe,logdepthbuf_fragment:VOe,logdepthbuf_pars_fragment:GOe,logdepthbuf_pars_vertex:qOe,logdepthbuf_vertex:$Oe,map_fragment:WOe,map_pars_fragment:YOe,map_particle_fragment:KOe,map_particle_pars_fragment:XOe,metalnessmap_fragment:ZOe,metalnessmap_pars_fragment:JOe,morphinstance_vertex:QOe,morphcolor_vertex:eNe,morphnormal_vertex:tNe,morphtarget_pars_vertex:nNe,morphtarget_vertex:iNe,normal_fragment_begin:rNe,normal_fragment_maps:sNe,normal_pars_fragment:aNe,normal_pars_vertex:oNe,normal_vertex:cNe,normalmap_pars_fragment:lNe,clearcoat_normal_fragment_begin:uNe,clearcoat_normal_fragment_maps:hNe,clearcoat_pars_fragment:dNe,iridescence_pars_fragment:fNe,opaque_fragment:pNe,packing:mNe,premultiplied_alpha_fragment:gNe,project_vertex:vNe,dithering_fragment:_Ne,dithering_pars_fragment:yNe,roughnessmap_fragment:bNe,roughnessmap_pars_fragment:ENe,shadowmap_pars_fragment:SNe,shadowmap_pars_vertex:TNe,shadowmap_vertex:xNe,shadowmask_pars_fragment:wNe,skinbase_vertex:CNe,skinning_pars_vertex:ANe,skinning_vertex:RNe,skinnormal_vertex:MNe,specularmap_fragment:ONe,specularmap_pars_fragment:NNe,tonemapping_fragment:INe,tonemapping_pars_fragment:kNe,transmission_fragment:PNe,transmission_pars_fragment:DNe,uv_pars_fragment:LNe,uv_pars_vertex:UNe,uv_vertex:BNe,worldpos_vertex:FNe,background_vert:zNe,background_frag:jNe,backgroundCube_vert:HNe,backgroundCube_frag:VNe,cube_vert:GNe,cube_frag:qNe,depth_vert:$Ne,depth_frag:WNe,distanceRGBA_vert:YNe,distanceRGBA_frag:KNe,equirect_vert:XNe,equirect_frag:ZNe,linedashed_vert:JNe,linedashed_frag:QNe,meshbasic_vert:eIe,meshbasic_frag:tIe,meshlambert_vert:nIe,meshlambert_frag:iIe,meshmatcap_vert:rIe,meshmatcap_frag:sIe,meshnormal_vert:aIe,meshnormal_frag:oIe,meshphong_vert:cIe,meshphong_frag:lIe,meshphysical_vert:uIe,meshphysical_frag:hIe,meshtoon_vert:dIe,meshtoon_frag:fIe,points_vert:pIe,points_frag:mIe,shadow_vert:gIe,shadow_frag:vIe,sprite_vert:_Ie,sprite_frag:yIe},En={common:{diffuse:{value:new bn(16777215)},opacity:{value:1},map:{value:null},mapTransform:{value:new Qi},alphaMap:{value:null},alphaMapTransform:{value:new Qi},alphaTest:{value:0}},specularmap:{specularMap:{value:null},specularMapTransform:{value:new Qi}},envmap:{envMap:{value:null},envMapRotation:{value:new Qi},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1},aoMapTransform:{value:new Qi}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1},lightMapTransform:{value:new Qi}},bumpmap:{bumpMap:{value:null},bumpMapTransform:{value:new Qi},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalMapTransform:{value:new Qi},normalScale:{value:new xt(1,1)}},displacementmap:{displacementMap:{value:null},displacementMapTransform:{value:new Qi},displacementScale:{value:1},displacementBias:{value:0}},emissivemap:{emissiveMap:{value:null},emissiveMapTransform:{value:new Qi}},metalnessmap:{metalnessMap:{value:null},metalnessMapTransform:{value:new Qi}},roughnessmap:{roughnessMap:{value:null},roughnessMapTransform:{value:new Qi}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new bn(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotLightMap:{value:[]},spotShadowMap:{value:[]},spotLightMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new bn(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaMapTransform:{value:new Qi},alphaTest:{value:0},uvTransform:{value:new Qi}},sprite:{diffuse:{value:new bn(16777215)},opacity:{value:1},center:{value:new xt(.5,.5)},rotation:{value:0},map:{value:null},mapTransform:{value:new Qi},alphaMap:{value:null},alphaMapTransform:{value:new Qi},alphaTest:{value:0}}},dm={basic:{uniforms:th([En.common,En.specularmap,En.envmap,En.aomap,En.lightmap,En.fog]),vertexShader:rr.meshbasic_vert,fragmentShader:rr.meshbasic_frag},lambert:{uniforms:th([En.common,En.specularmap,En.envmap,En.aomap,En.lightmap,En.emissivemap,En.bumpmap,En.normalmap,En.displacementmap,En.fog,En.lights,{emissive:{value:new bn(0)}}]),vertexShader:rr.meshlambert_vert,fragmentShader:rr.meshlambert_frag},phong:{uniforms:th([En.common,En.specularmap,En.envmap,En.aomap,En.lightmap,En.emissivemap,En.bumpmap,En.normalmap,En.displacementmap,En.fog,En.lights,{emissive:{value:new bn(0)},specular:{value:new bn(1118481)},shininess:{value:30}}]),vertexShader:rr.meshphong_vert,fragmentShader:rr.meshphong_frag},standard:{uniforms:th([En.common,En.envmap,En.aomap,En.lightmap,En.emissivemap,En.bumpmap,En.normalmap,En.displacementmap,En.roughnessmap,En.metalnessmap,En.fog,En.lights,{emissive:{value:new bn(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:rr.meshphysical_vert,fragmentShader:rr.meshphysical_frag},toon:{uniforms:th([En.common,En.aomap,En.lightmap,En.emissivemap,En.bumpmap,En.normalmap,En.displacementmap,En.gradientmap,En.fog,En.lights,{emissive:{value:new bn(0)}}]),vertexShader:rr.meshtoon_vert,fragmentShader:rr.meshtoon_frag},matcap:{uniforms:th([En.common,En.bumpmap,En.normalmap,En.displacementmap,En.fog,{matcap:{value:null}}]),vertexShader:rr.meshmatcap_vert,fragmentShader:rr.meshmatcap_frag},points:{uniforms:th([En.points,En.fog]),vertexShader:rr.points_vert,fragmentShader:rr.points_frag},dashed:{uniforms:th([En.common,En.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:rr.linedashed_vert,fragmentShader:rr.linedashed_frag},depth:{uniforms:th([En.common,En.displacementmap]),vertexShader:rr.depth_vert,fragmentShader:rr.depth_frag},normal:{uniforms:th([En.common,En.bumpmap,En.normalmap,En.displacementmap,{opacity:{value:1}}]),vertexShader:rr.meshnormal_vert,fragmentShader:rr.meshnormal_frag},sprite:{uniforms:th([En.sprite,En.fog]),vertexShader:rr.sprite_vert,fragmentShader:rr.sprite_frag},background:{uniforms:{uvTransform:{value:new Qi},t2D:{value:null},backgroundIntensity:{value:1}},vertexShader:rr.background_vert,fragmentShader:rr.background_frag},backgroundCube:{uniforms:{envMap:{value:null},flipEnvMap:{value:-1},backgroundBlurriness:{value:0},backgroundIntensity:{value:1},backgroundRotation:{value:new Qi}},vertexShader:rr.backgroundCube_vert,fragmentShader:rr.backgroundCube_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:rr.cube_vert,fragmentShader:rr.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:rr.equirect_vert,fragmentShader:rr.equirect_frag},distanceRGBA:{uniforms:th([En.common,En.displacementmap,{referencePosition:{value:new Oe},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:rr.distanceRGBA_vert,fragmentShader:rr.distanceRGBA_frag},shadow:{uniforms:th([En.lights,En.fog,{color:{value:new bn(0)},opacity:{value:1}}]),vertexShader:rr.shadow_vert,fragmentShader:rr.shadow_frag}};dm.physical={uniforms:th([dm.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatMapTransform:{value:new Qi},clearcoatNormalMap:{value:null},clearcoatNormalMapTransform:{value:new Qi},clearcoatNormalScale:{value:new xt(1,1)},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatRoughnessMapTransform:{value:new Qi},dispersion:{value:0},iridescence:{value:0},iridescenceMap:{value:null},iridescenceMapTransform:{value:new Qi},iridescenceIOR:{value:1.3},iridescenceThicknessMinimum:{value:100},iridescenceThicknessMaximum:{value:400},iridescenceThicknessMap:{value:null},iridescenceThicknessMapTransform:{value:new Qi},sheen:{value:0},sheenColor:{value:new bn(0)},sheenColorMap:{value:null},sheenColorMapTransform:{value:new Qi},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},sheenRoughnessMapTransform:{value:new Qi},transmission:{value:0},transmissionMap:{value:null},transmissionMapTransform:{value:new Qi},transmissionSamplerSize:{value:new xt},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},thicknessMapTransform:{value:new Qi},attenuationDistance:{value:0},attenuationColor:{value:new bn(0)},specularColor:{value:new bn(1,1,1)},specularColorMap:{value:null},specularColorMapTransform:{value:new Qi},specularIntensity:{value:1},specularIntensityMap:{value:null},specularIntensityMapTransform:{value:new Qi},anisotropyVector:{value:new xt},anisotropyMap:{value:null},anisotropyMapTransform:{value:new Qi}}]),vertexShader:rr.meshphysical_vert,fragmentShader:rr.meshphysical_frag};const pD={r:0,b:0,g:0},HS=new dd,bIe=new gi;function EIe(t,e,n,i,r,s,a){const o=new bn(0);let c=s===!0?0:1,l,u,h=null,d=0,f=null;function p(S){let x=S.isScene===!0?S.background:null;return x&&x.isTexture&&(x=(S.backgroundBlurriness>0?n:e).get(x)),x}function g(S){let x=!1;const M=p(S);M===null?v(o,c):M&&M.isColor&&(v(M,1),x=!0);const R=t.xr.getEnvironmentBlendMode();R==="additive"?i.buffers.color.setClear(0,0,0,1,a):R==="alpha-blend"&&i.buffers.color.setClear(0,0,0,0,a),(t.autoClear||x)&&(i.buffers.depth.setTest(!0),i.buffers.depth.setMask(!0),i.buffers.color.setMask(!0),t.clear(t.autoClearColor,t.autoClearDepth,t.autoClearStencil))}function _(S,x){const M=p(x);M&&(M.isCubeTexture||M.mapping===YA)?(u===void 0&&(u=new Io(new P1(1,1,1),new qa({name:"BackgroundCubeMaterial",uniforms:HC(dm.backgroundCube.uniforms),vertexShader:dm.backgroundCube.vertexShader,fragmentShader:dm.backgroundCube.fragmentShader,side:$c,depthTest:!1,depthWrite:!1,fog:!1,allowOverride:!1})),u.geometry.deleteAttribute("normal"),u.geometry.deleteAttribute("uv"),u.onBeforeRender=function(R,I,k){this.matrixWorld.copyPosition(k.matrixWorld)},Object.defineProperty(u.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),r.update(u)),HS.copy(x.backgroundRotation),HS.x*=-1,HS.y*=-1,HS.z*=-1,M.isCubeTexture&&M.isRenderTargetTexture===!1&&(HS.y*=-1,HS.z*=-1),u.material.uniforms.envMap.value=M,u.material.uniforms.flipEnvMap.value=M.isCubeTexture&&M.isRenderTargetTexture===!1?-1:1,u.material.uniforms.backgroundBlurriness.value=x.backgroundBlurriness,u.material.uniforms.backgroundIntensity.value=x.backgroundIntensity,u.material.uniforms.backgroundRotation.value.setFromMatrix4(bIe.makeRotationFromEuler(HS)),u.material.toneMapped=Br.getTransfer(M.colorSpace)!==Ns,(h!==M||d!==M.version||f!==t.toneMapping)&&(u.material.needsUpdate=!0,h=M,d=M.version,f=t.toneMapping),u.layers.enableAll(),S.unshift(u,u.geometry,u.material,0,0,null)):M&&M.isTexture&&(l===void 0&&(l=new Io(new QA(2,2),new qa({name:"BackgroundMaterial",uniforms:HC(dm.background.uniforms),vertexShader:dm.background.vertexShader,fragmentShader:dm.background.fragmentShader,side:r0,depthTest:!1,depthWrite:!1,fog:!1,allowOverride:!1})),l.geometry.deleteAttribute("normal"),Object.defineProperty(l.material,"map",{get:function(){return this.uniforms.t2D.value}}),r.update(l)),l.material.uniforms.t2D.value=M,l.material.uniforms.backgroundIntensity.value=x.backgroundIntensity,l.material.toneMapped=Br.getTransfer(M.colorSpace)!==Ns,M.matrixAutoUpdate===!0&&M.updateMatrix(),l.material.uniforms.uvTransform.value.copy(M.matrix),(h!==M||d!==M.version||f!==t.toneMapping)&&(l.material.needsUpdate=!0,h=M,d=M.version,f=t.toneMapping),l.layers.enableAll(),S.unshift(l,l.geometry,l.material,0,0,null))}function v(S,x){S.getRGB(pD,$le(t)),i.buffers.color.setClear(pD.r,pD.g,pD.b,x,a)}function b(){u!==void 0&&(u.geometry.dispose(),u.material.dispose(),u=void 0),l!==void 0&&(l.geometry.dispose(),l.material.dispose(),l=void 0)}return{getClearColor:function(){return o},setClearColor:function(S,x=1){o.set(S),c=x,v(o,c)},getClearAlpha:function(){return c},setClearAlpha:function(S){c=S,v(o,c)},render:g,addToRenderList:_,dispose:b}}function SIe(t,e){const n=t.getParameter(t.MAX_VERTEX_ATTRIBS),i={},r=d(null);let s=r,a=!1;function o(U,V,$,q,Y){let te=!1;const G=h(q,$,V);s!==G&&(s=G,l(s.object)),te=f(U,q,$,Y),te&&p(U,q,$,Y),Y!==null&&e.update(Y,t.ELEMENT_ARRAY_BUFFER),(te||a)&&(a=!1,x(U,V,$,q),Y!==null&&t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,e.get(Y).buffer))}function c(){return t.createVertexArray()}function l(U){return t.bindVertexArray(U)}function u(U){return t.deleteVertexArray(U)}function h(U,V,$){const q=$.wireframe===!0;let Y=i[U.id];Y===void 0&&(Y={},i[U.id]=Y);let te=Y[V.id];te===void 0&&(te={},Y[V.id]=te);let G=te[q];return G===void 0&&(G=d(c()),te[q]=G),G}function d(U){const V=[],$=[],q=[];for(let Y=0;Y<n;Y++)V[Y]=0,$[Y]=0,q[Y]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:V,enabledAttributes:$,attributeDivisors:q,object:U,attributes:{},index:null}}function f(U,V,$,q){const Y=s.attributes,te=V.attributes;let G=0;const J=$.getAttributes();for(const K in J)if(J[K].location>=0){const ae=Y[K];let ce=te[K];if(ce===void 0&&(K==="instanceMatrix"&&U.instanceMatrix&&(ce=U.instanceMatrix),K==="instanceColor"&&U.instanceColor&&(ce=U.instanceColor)),ae===void 0||ae.attribute!==ce||ce&&ae.data!==ce.data)return!0;G++}return s.attributesNum!==G||s.index!==q}function p(U,V,$,q){const Y={},te=V.attributes;let G=0;const J=$.getAttributes();for(const K in J)if(J[K].location>=0){let ae=te[K];ae===void 0&&(K==="instanceMatrix"&&U.instanceMatrix&&(ae=U.instanceMatrix),K==="instanceColor"&&U.instanceColor&&(ae=U.instanceColor));const ce={};ce.attribute=ae,ae&&ae.data&&(ce.data=ae.data),Y[K]=ce,G++}s.attributes=Y,s.attributesNum=G,s.index=q}function g(){const U=s.newAttributes;for(let V=0,$=U.length;V<$;V++)U[V]=0}function _(U){v(U,0)}function v(U,V){const $=s.newAttributes,q=s.enabledAttributes,Y=s.attributeDivisors;$[U]=1,q[U]===0&&(t.enableVertexAttribArray(U),q[U]=1),Y[U]!==V&&(t.vertexAttribDivisor(U,V),Y[U]=V)}function b(){const U=s.newAttributes,V=s.enabledAttributes;for(let $=0,q=V.length;$<q;$++)V[$]!==U[$]&&(t.disableVertexAttribArray($),V[$]=0)}function S(U,V,$,q,Y,te,G){G===!0?t.vertexAttribIPointer(U,V,$,Y,te):t.vertexAttribPointer(U,V,$,q,Y,te)}function x(U,V,$,q){g();const Y=q.attributes,te=$.getAttributes(),G=V.defaultAttributeValues;for(const J in te){const K=te[J];if(K.location>=0){let X=Y[J];if(X===void 0&&(J==="instanceMatrix"&&U.instanceMatrix&&(X=U.instanceMatrix),J==="instanceColor"&&U.instanceColor&&(X=U.instanceColor)),X!==void 0){const ae=X.normalized,ce=X.itemSize,Me=e.get(X);if(Me===void 0)continue;const Fe=Me.buffer,Te=Me.type,Re=Me.bytesPerElement,ge=Te===t.INT||Te===t.UNSIGNED_INT||X.gpuType===JB;if(X.isInterleavedBufferAttribute){const _e=X.data,ke=_e.stride,gt=X.offset;if(_e.isInstancedInterleavedBuffer){for(let wt=0;wt<K.locationSize;wt++)v(K.location+wt,_e.meshPerAttribute);U.isInstancedMesh!==!0&&q._maxInstanceCount===void 0&&(q._maxInstanceCount=_e.meshPerAttribute*_e.count)}else for(let wt=0;wt<K.locationSize;wt++)_(K.location+wt);t.bindBuffer(t.ARRAY_BUFFER,Fe);for(let wt=0;wt<K.locationSize;wt++)S(K.location+wt,ce/K.locationSize,Te,ae,ke*Re,(gt+ce/K.locationSize*wt)*Re,ge)}else{if(X.isInstancedBufferAttribute){for(let _e=0;_e<K.locationSize;_e++)v(K.location+_e,X.meshPerAttribute);U.isInstancedMesh!==!0&&q._maxInstanceCount===void 0&&(q._maxInstanceCount=X.meshPerAttribute*X.count)}else for(let _e=0;_e<K.locationSize;_e++)_(K.location+_e);t.bindBuffer(t.ARRAY_BUFFER,Fe);for(let _e=0;_e<K.locationSize;_e++)S(K.location+_e,ce/K.locationSize,Te,ae,ce*Re,ce/K.locationSize*_e*Re,ge)}}else if(G!==void 0){const ae=G[J];if(ae!==void 0)switch(ae.length){case 2:t.vertexAttrib2fv(K.location,ae);break;case 3:t.vertexAttrib3fv(K.location,ae);break;case 4:t.vertexAttrib4fv(K.location,ae);break;default:t.vertexAttrib1fv(K.location,ae)}}}}b()}function M(){k();for(const U in i){const V=i[U];for(const $ in V){const q=V[$];for(const Y in q)u(q[Y].object),delete q[Y];delete V[$]}delete i[U]}}function R(U){if(i[U.id]===void 0)return;const V=i[U.id];for(const $ in V){const q=V[$];for(const Y in q)u(q[Y].object),delete q[Y];delete V[$]}delete i[U.id]}function I(U){for(const V in i){const $=i[V];if($[U.id]===void 0)continue;const q=$[U.id];for(const Y in q)u(q[Y].object),delete q[Y];delete $[U.id]}}function k(){P(),a=!0,s!==r&&(s=r,l(s.object))}function P(){r.geometry=null,r.program=null,r.wireframe=!1}return{setup:o,reset:k,resetDefaultState:P,dispose:M,releaseStatesOfGeometry:R,releaseStatesOfProgram:I,initAttributes:g,enableAttribute:_,disableUnusedAttributes:b}}function TIe(t,e,n){let i;function r(l){i=l}function s(l,u){t.drawArrays(i,l,u),n.update(u,i,1)}function a(l,u,h){h!==0&&(t.drawArraysInstanced(i,l,u,h),n.update(u,i,h))}function o(l,u,h){if(h===0)return;e.get("WEBGL_multi_draw").multiDrawArraysWEBGL(i,l,0,u,0,h);let f=0;for(let p=0;p<h;p++)f+=u[p];n.update(f,i,1)}function c(l,u,h,d){if(h===0)return;const f=e.get("WEBGL_multi_draw");if(f===null)for(let p=0;p<l.length;p++)a(l[p],u[p],d[p]);else{f.multiDrawArraysInstancedWEBGL(i,l,0,u,0,d,0,h);let p=0;for(let g=0;g<h;g++)p+=u[g]*d[g];n.update(p,i,1)}}this.setMode=r,this.render=s,this.renderInstances=a,this.renderMultiDraw=o,this.renderMultiDrawInstances=c}function xIe(t,e,n,i){let r;function s(){if(r!==void 0)return r;if(e.has("EXT_texture_filter_anisotropic")===!0){const I=e.get("EXT_texture_filter_anisotropic");r=t.getParameter(I.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else r=0;return r}function a(I){return!(I!==Wc&&i.convert(I)!==t.getParameter(t.IMPLEMENTATION_COLOR_READ_FORMAT))}function o(I){const k=I===SE&&(e.has("EXT_color_buffer_half_float")||e.has("EXT_color_buffer_float"));return!(I!==lo&&i.convert(I)!==t.getParameter(t.IMPLEMENTATION_COLOR_READ_TYPE)&&I!==vu&&!k)}function c(I){if(I==="highp"){if(t.getShaderPrecisionFormat(t.VERTEX_SHADER,t.HIGH_FLOAT).precision>0&&t.getShaderPrecisionFormat(t.FRAGMENT_SHADER,t.HIGH_FLOAT).precision>0)return"highp";I="mediump"}return I==="mediump"&&t.getShaderPrecisionFormat(t.VERTEX_SHADER,t.MEDIUM_FLOAT).precision>0&&t.getShaderPrecisionFormat(t.FRAGMENT_SHADER,t.MEDIUM_FLOAT).precision>0?"mediump":"lowp"}let l=n.precision!==void 0?n.precision:"highp";const u=c(l);u!==l&&(console.warn("THREE.WebGLRenderer:",l,"not supported, using",u,"instead."),l=u);const h=n.logarithmicDepthBuffer===!0,d=n.reverseDepthBuffer===!0&&e.has("EXT_clip_control"),f=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS),p=t.getParameter(t.MAX_VERTEX_TEXTURE_IMAGE_UNITS),g=t.getParameter(t.MAX_TEXTURE_SIZE),_=t.getParameter(t.MAX_CUBE_MAP_TEXTURE_SIZE),v=t.getParameter(t.MAX_VERTEX_ATTRIBS),b=t.getParameter(t.MAX_VERTEX_UNIFORM_VECTORS),S=t.getParameter(t.MAX_VARYING_VECTORS),x=t.getParameter(t.MAX_FRAGMENT_UNIFORM_VECTORS),M=p>0,R=t.getParameter(t.MAX_SAMPLES);return{isWebGL2:!0,getMaxAnisotropy:s,getMaxPrecision:c,textureFormatReadable:a,textureTypeReadable:o,precision:l,logarithmicDepthBuffer:h,reverseDepthBuffer:d,maxTextures:f,maxVertexTextures:p,maxTextureSize:g,maxCubemapSize:_,maxAttributes:v,maxVertexUniforms:b,maxVaryings:S,maxFragmentUniforms:x,vertexTextures:M,maxSamples:R}}function wIe(t){const e=this;let n=null,i=0,r=!1,s=!1;const a=new nb,o=new Qi,c={value:null,needsUpdate:!1};this.uniform=c,this.numPlanes=0,this.numIntersection=0,this.init=function(h,d){const f=h.length!==0||d||i!==0||r;return r=d,i=h.length,f},this.beginShadows=function(){s=!0,u(null)},this.endShadows=function(){s=!1},this.setGlobalState=function(h,d){n=u(h,d,0)},this.setState=function(h,d,f){const p=h.clippingPlanes,g=h.clipIntersection,_=h.clipShadows,v=t.get(h);if(!r||p===null||p.length===0||s&&!_)s?u(null):l();else{const b=s?0:i,S=b*4;let x=v.clippingState||null;c.value=x,x=u(p,d,S,f);for(let M=0;M!==S;++M)x[M]=n[M];v.clippingState=x,this.numIntersection=g?this.numPlanes:0,this.numPlanes+=b}};function l(){c.value!==n&&(c.value=n,c.needsUpdate=i>0),e.numPlanes=i,e.numIntersection=0}function u(h,d,f,p){const g=h!==null?h.length:0;let _=null;if(g!==0){if(_=c.value,p!==!0||_===null){const v=f+g*4,b=d.matrixWorldInverse;o.getNormalMatrix(b),(_===null||_.length<v)&&(_=new Float32Array(v));for(let S=0,x=f;S!==g;++S,x+=4)a.copy(h[S]).applyMatrix4(b,o),a.normal.toArray(_,x),_[x+3]=a.constant}c.value=_,c.needsUpdate=!0}return e.numPlanes=g,e.numIntersection=0,_}}function CIe(t){let e=new WeakMap;function n(a,o){return o===VO?a.mapping=T_:o===GO&&(a.mapping=eE),a}function i(a){if(a&&a.isTexture){const o=a.mapping;if(o===VO||o===GO)if(e.has(a)){const c=e.get(a).texture;return n(c,a.mapping)}else{const c=a.image;if(c&&c.height>0){const l=new Kle(c.height);return l.fromEquirectangularTexture(t,a),e.set(a,l),a.addEventListener("dispose",r),n(l.texture,a.mapping)}else return null}}return a}function r(a){const o=a.target;o.removeEventListener("dispose",r);const c=e.get(o);c!==void 0&&(e.delete(o),c.dispose())}function s(){e=new WeakMap}return{get:i,dispose:s}}const zw=4,cQ=[.125,.215,.35,.446,.526,.582],uT=20,W5=new VI,lQ=new bn;let Y5=null,K5=0,X5=0,Z5=!1;const QS=(1+Math.sqrt(5))/2,ew=1/QS,uQ=[new Oe(-QS,ew,0),new Oe(QS,ew,0),new Oe(-ew,0,QS),new Oe(ew,0,QS),new Oe(0,QS,-ew),new Oe(0,QS,ew),new Oe(-1,1,-1),new Oe(1,1,-1),new Oe(-1,1,1),new Oe(1,1,1)],AIe=new Oe;class oG{constructor(e){this._renderer=e,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._lodPlanes=[],this._sizeLods=[],this._sigmas=[],this._blurMaterial=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._compileMaterial(this._blurMaterial)}fromScene(e,n=0,i=.1,r=100,s={}){const{size:a=256,position:o=AIe}=s;Y5=this._renderer.getRenderTarget(),K5=this._renderer.getActiveCubeFace(),X5=this._renderer.getActiveMipmapLevel(),Z5=this._renderer.xr.enabled,this._renderer.xr.enabled=!1,this._setSize(a);const c=this._allocateTargets();return c.depthBuffer=!0,this._sceneToCubeUV(e,i,r,c,o),n>0&&this._blur(c,0,0,n),this._applyPMREM(c),this._cleanup(c),c}fromEquirectangular(e,n=null){return this._fromTexture(e,n)}fromCubemap(e,n=null){return this._fromTexture(e,n)}compileCubemapShader(){this._cubemapMaterial===null&&(this._cubemapMaterial=fQ(),this._compileMaterial(this._cubemapMaterial))}compileEquirectangularShader(){this._equirectMaterial===null&&(this._equirectMaterial=dQ(),this._compileMaterial(this._equirectMaterial))}dispose(){this._dispose(),this._cubemapMaterial!==null&&this._cubemapMaterial.dispose(),this._equirectMaterial!==null&&this._equirectMaterial.dispose()}_setSize(e){this._lodMax=Math.floor(Math.log2(e)),this._cubeSize=Math.pow(2,this._lodMax)}_dispose(){this._blurMaterial!==null&&this._blurMaterial.dispose(),this._pingPongRenderTarget!==null&&this._pingPongRenderTarget.dispose();for(let e=0;e<this._lodPlanes.length;e++)this._lodPlanes[e].dispose()}_cleanup(e){this._renderer.setRenderTarget(Y5,K5,X5),this._renderer.xr.enabled=Z5,e.scissorTest=!1,mD(e,0,0,e.width,e.height)}_fromTexture(e,n){e.mapping===T_||e.mapping===eE?this._setSize(e.image.length===0?16:e.image[0].width||e.image[0].image.width):this._setSize(e.image.width/4),Y5=this._renderer.getRenderTarget(),K5=this._renderer.getActiveCubeFace(),X5=this._renderer.getActiveMipmapLevel(),Z5=this._renderer.xr.enabled,this._renderer.xr.enabled=!1;const i=n||this._allocateTargets();return this._textureToCubeUV(e,i),this._applyPMREM(i),this._cleanup(i),i}_allocateTargets(){const e=3*Math.max(this._cubeSize,112),n=4*this._cubeSize,i={magFilter:Ca,minFilter:Ca,generateMipmaps:!1,type:SE,format:Wc,colorSpace:a0,depthBuffer:!1},r=hQ(e,n,i);if(this._pingPongRenderTarget===null||this._pingPongRenderTarget.width!==e||this._pingPongRenderTarget.height!==n){this._pingPongRenderTarget!==null&&this._dispose(),this._pingPongRenderTarget=hQ(e,n,i);const{_lodMax:s}=this;({sizeLods:this._sizeLods,lodPlanes:this._lodPlanes,sigmas:this._sigmas}=RIe(s)),this._blurMaterial=MIe(s,e,n)}return r}_compileMaterial(e){const n=new Io(this._lodPlanes[0],e);this._renderer.compile(n,W5)}_sceneToCubeUV(e,n,i,r,s){const c=new Hc(90,1,n,i),l=[1,-1,1,1,1,1],u=[1,1,1,-1,-1,-1],h=this._renderer,d=h.autoClear,f=h.toneMapping;h.getClearColor(lQ),h.toneMapping=Em,h.autoClear=!1;const p=new wE({name:"PMREM.Background",side:$c,depthWrite:!1,depthTest:!1}),g=new Io(new P1,p);let _=!1;const v=e.background;v?v.isColor&&(p.color.copy(v),e.background=null,_=!0):(p.color.copy(lQ),_=!0);for(let b=0;b<6;b++){const S=b%3;S===0?(c.up.set(0,l[b],0),c.position.set(s.x,s.y,s.z),c.lookAt(s.x+u[b],s.y,s.z)):S===1?(c.up.set(0,0,l[b]),c.position.set(s.x,s.y,s.z),c.lookAt(s.x,s.y+u[b],s.z)):(c.up.set(0,l[b],0),c.position.set(s.x,s.y,s.z),c.lookAt(s.x,s.y,s.z+u[b]));const x=this._cubeSize;mD(r,S*x,b>2?x:0,x,x),h.setRenderTarget(r),_&&h.render(g,c),h.render(e,c)}g.geometry.dispose(),g.material.dispose(),h.toneMapping=f,h.autoClear=d,e.background=v}_textureToCubeUV(e,n){const i=this._renderer,r=e.mapping===T_||e.mapping===eE;r?(this._cubemapMaterial===null&&(this._cubemapMaterial=fQ()),this._cubemapMaterial.uniforms.flipEnvMap.value=e.isRenderTargetTexture===!1?-1:1):this._equirectMaterial===null&&(this._equirectMaterial=dQ());const s=r?this._cubemapMaterial:this._equirectMaterial,a=new Io(this._lodPlanes[0],s),o=s.uniforms;o.envMap.value=e;const c=this._cubeSize;mD(n,0,0,3*c,2*c),i.setRenderTarget(n),i.render(a,W5)}_applyPMREM(e){const n=this._renderer,i=n.autoClear;n.autoClear=!1;const r=this._lodPlanes.length;for(let s=1;s<r;s++){const a=Math.sqrt(this._sigmas[s]*this._sigmas[s]-this._sigmas[s-1]*this._sigmas[s-1]),o=uQ[(r-s-1)%uQ.length];this._blur(e,s-1,s,a,o)}n.autoClear=i}_blur(e,n,i,r,s){const a=this._pingPongRenderTarget;this._halfBlur(e,a,n,i,r,"latitudinal",s),this._halfBlur(a,e,i,i,r,"longitudinal",s)}_halfBlur(e,n,i,r,s,a,o){const c=this._renderer,l=this._blurMaterial;a!=="latitudinal"&&a!=="longitudinal"&&console.error("blur direction must be either latitudinal or longitudinal!");const u=3,h=new Io(this._lodPlanes[r],l),d=l.uniforms,f=this._sizeLods[i]-1,p=isFinite(s)?Math.PI/(2*f):2*Math.PI/(2*uT-1),g=s/p,_=isFinite(s)?1+Math.floor(u*g):uT;_>uT&&console.warn(`sigmaRadians, ${s}, is too large and will clip, as it requested ${_} samples when the maximum is set to ${uT}`);const v=[];let b=0;for(let I=0;I<uT;++I){const k=I/g,P=Math.exp(-k*k/2);v.push(P),I===0?b+=P:I<_&&(b+=2*P)}for(let I=0;I<v.length;I++)v[I]=v[I]/b;d.envMap.value=e.texture,d.samples.value=_,d.weights.value=v,d.latitudinal.value=a==="latitudinal",o&&(d.poleAxis.value=o);const{_lodMax:S}=this;d.dTheta.value=p,d.mipInt.value=S-i;const x=this._sizeLods[r],M=3*x*(r>S-zw?r-S+zw:0),R=4*(this._cubeSize-x);mD(n,M,R,3*x,2*x),c.setRenderTarget(n),c.render(h,W5)}}function RIe(t){const e=[],n=[],i=[];let r=t;const s=t-zw+1+cQ.length;for(let a=0;a<s;a++){const o=Math.pow(2,r);n.push(o);let c=1/o;a>t-zw?c=cQ[a-t+zw-1]:a===0&&(c=0),i.push(c);const l=1/(o-2),u=-l,h=1+l,d=[u,u,h,u,h,h,u,u,h,h,u,h],f=6,p=6,g=3,_=2,v=1,b=new Float32Array(g*p*f),S=new Float32Array(_*p*f),x=new Float32Array(v*p*f);for(let R=0;R<f;R++){const I=R%3*2/3-1,k=R>2?0:-1,P=[I,k,0,I+2/3,k,0,I+2/3,k+1,0,I,k,0,I+2/3,k+1,0,I,k+1,0];b.set(P,g*p*R),S.set(d,_*p*R);const U=[R,R,R,R,R,R];x.set(U,v*p*R)}const M=new tr;M.setAttribute("position",new ar(b,g)),M.setAttribute("uv",new ar(S,_)),M.setAttribute("faceIndex",new ar(x,v)),e.push(M),r>zw&&r--}return{lodPlanes:e,sizeLods:n,sigmas:i}}function hQ(t,e,n){const i=new Ko(t,e,n);return i.texture.mapping=YA,i.texture.name="PMREM.cubeUv",i.scissorTest=!0,i}function mD(t,e,n,i,r){t.viewport.set(e,n,i,r),t.scissor.set(e,n,i,r)}function MIe(t,e,n){const i=new Float32Array(uT),r=new Oe(0,1,0);return new qa({name:"SphericalGaussianBlur",defines:{n:uT,CUBEUV_TEXEL_WIDTH:1/e,CUBEUV_TEXEL_HEIGHT:1/n,CUBEUV_MAX_MIP:`${t}.0`},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:i},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:r}},vertexShader:xW(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;
			uniform int samples;
			uniform float weights[ n ];
			uniform bool latitudinal;
			uniform float dTheta;
			uniform float mipInt;
			uniform vec3 poleAxis;

			#define ENVMAP_TYPE_CUBE_UV
			#include <cube_uv_reflection_fragment>

			vec3 getSample( float theta, vec3 axis ) {

				float cosTheta = cos( theta );
				// Rodrigues' axis-angle rotation
				vec3 sampleDirection = vOutputDirection * cosTheta
					+ cross( axis, vOutputDirection ) * sin( theta )
					+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );

				return bilinearCubeUV( envMap, sampleDirection, mipInt );

			}

			void main() {

				vec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );

				if ( all( equal( axis, vec3( 0.0 ) ) ) ) {

					axis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );

				}

				axis = normalize( axis );

				gl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );
				gl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );

				for ( int i = 1; i < n; i++ ) {

					if ( i >= samples ) {

						break;

					}

					float theta = dTheta * float( i );
					gl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );
					gl_FragColor.rgb += weights[ i ] * getSample( theta, axis );

				}

			}
		`,blending:Eu,depthTest:!1,depthWrite:!1})}function dQ(){return new qa({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null}},vertexShader:xW(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;

			#include <common>

			void main() {

				vec3 outputDirection = normalize( vOutputDirection );
				vec2 uv = equirectUv( outputDirection );

				gl_FragColor = vec4( texture2D ( envMap, uv ).rgb, 1.0 );

			}
		`,blending:Eu,depthTest:!1,depthWrite:!1})}function fQ(){return new qa({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},flipEnvMap:{value:-1}},vertexShader:xW(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			uniform float flipEnvMap;

			varying vec3 vOutputDirection;

			uniform samplerCube envMap;

			void main() {

				gl_FragColor = textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );

			}
		`,blending:Eu,depthTest:!1,depthWrite:!1})}function xW(){return`

		precision mediump float;
		precision mediump int;

		attribute float faceIndex;

		varying vec3 vOutputDirection;

		// RH coordinate system; PMREM face-indexing convention
		vec3 getDirection( vec2 uv, float face ) {

			uv = 2.0 * uv - 1.0;

			vec3 direction = vec3( uv, 1.0 );

			if ( face == 0.0 ) {

				direction = direction.zyx; // ( 1, v, u ) pos x

			} else if ( face == 1.0 ) {

				direction = direction.xzy;
				direction.xz *= -1.0; // ( -u, 1, -v ) pos y

			} else if ( face == 2.0 ) {

				direction.x *= -1.0; // ( -u, v, 1 ) pos z

			} else if ( face == 3.0 ) {

				direction = direction.zyx;
				direction.xz *= -1.0; // ( -1, v, -u ) neg x

			} else if ( face == 4.0 ) {

				direction = direction.xzy;
				direction.xy *= -1.0; // ( -u, -1, v ) neg y

			} else if ( face == 5.0 ) {

				direction.z *= -1.0; // ( u, v, -1 ) neg z

			}

			return direction;

		}

		void main() {

			vOutputDirection = getDirection( uv, faceIndex );
			gl_Position = vec4( position, 1.0 );

		}
	`}function OIe(t){let e=new WeakMap,n=null;function i(o){if(o&&o.isTexture){const c=o.mapping,l=c===VO||c===GO,u=c===T_||c===eE;if(l||u){let h=e.get(o);const d=h!==void 0?h.texture.pmremVersion:0;if(o.isRenderTargetTexture&&o.pmremVersion!==d)return n===null&&(n=new oG(t)),h=l?n.fromEquirectangular(o,h):n.fromCubemap(o,h),h.texture.pmremVersion=o.pmremVersion,e.set(o,h),h.texture;if(h!==void 0)return h.texture;{const f=o.image;return l&&f&&f.height>0||u&&f&&r(f)?(n===null&&(n=new oG(t)),h=l?n.fromEquirectangular(o):n.fromCubemap(o),h.texture.pmremVersion=o.pmremVersion,e.set(o,h),o.addEventListener("dispose",s),h.texture):null}}}return o}function r(o){let c=0;const l=6;for(let u=0;u<l;u++)o[u]!==void 0&&c++;return c===l}function s(o){const c=o.target;c.removeEventListener("dispose",s);const l=e.get(c);l!==void 0&&(e.delete(c),l.dispose())}function a(){e=new WeakMap,n!==null&&(n.dispose(),n=null)}return{get:i,dispose:a}}function NIe(t){const e={};function n(i){if(e[i]!==void 0)return e[i];let r;switch(i){case"WEBGL_depth_texture":r=t.getExtension("WEBGL_depth_texture")||t.getExtension("MOZ_WEBGL_depth_texture")||t.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":r=t.getExtension("EXT_texture_filter_anisotropic")||t.getExtension("MOZ_EXT_texture_filter_anisotropic")||t.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":r=t.getExtension("WEBGL_compressed_texture_s3tc")||t.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||t.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":r=t.getExtension("WEBGL_compressed_texture_pvrtc")||t.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:r=t.getExtension(i)}return e[i]=r,r}return{has:function(i){return n(i)!==null},init:function(){n("EXT_color_buffer_float"),n("WEBGL_clip_cull_distance"),n("OES_texture_float_linear"),n("EXT_color_buffer_half_float"),n("WEBGL_multisampled_render_to_texture"),n("WEBGL_render_shared_exponent")},get:function(i){const r=n(i);return r===null&&P2("THREE.WebGLRenderer: "+i+" extension not supported."),r}}}function IIe(t,e,n,i){const r={},s=new WeakMap;function a(h){const d=h.target;d.index!==null&&e.remove(d.index);for(const p in d.attributes)e.remove(d.attributes[p]);d.removeEventListener("dispose",a),delete r[d.id];const f=s.get(d);f&&(e.remove(f),s.delete(d)),i.releaseStatesOfGeometry(d),d.isInstancedBufferGeometry===!0&&delete d._maxInstanceCount,n.memory.geometries--}function o(h,d){return r[d.id]===!0||(d.addEventListener("dispose",a),r[d.id]=!0,n.memory.geometries++),d}function c(h){const d=h.attributes;for(const f in d)e.update(d[f],t.ARRAY_BUFFER)}function l(h){const d=[],f=h.index,p=h.attributes.position;let g=0;if(f!==null){const b=f.array;g=f.version;for(let S=0,x=b.length;S<x;S+=3){const M=b[S+0],R=b[S+1],I=b[S+2];d.push(M,R,R,I,I,M)}}else if(p!==void 0){const b=p.array;g=p.version;for(let S=0,x=b.length/3-1;S<x;S+=3){const M=S+0,R=S+1,I=S+2;d.push(M,R,R,I,I,M)}}else return;const _=new(Hle(d)?Q7:J7)(d,1);_.version=g;const v=s.get(h);v&&e.remove(v),s.set(h,_)}function u(h){const d=s.get(h);if(d){const f=h.index;f!==null&&d.version<f.version&&l(h)}else l(h);return s.get(h)}return{get:o,update:c,getWireframeAttribute:u}}function kIe(t,e,n){let i;function r(d){i=d}let s,a;function o(d){s=d.type,a=d.bytesPerElement}function c(d,f){t.drawElements(i,f,s,d*a),n.update(f,i,1)}function l(d,f,p){p!==0&&(t.drawElementsInstanced(i,f,s,d*a,p),n.update(f,i,p))}function u(d,f,p){if(p===0)return;e.get("WEBGL_multi_draw").multiDrawElementsWEBGL(i,f,0,s,d,0,p);let _=0;for(let v=0;v<p;v++)_+=f[v];n.update(_,i,1)}function h(d,f,p,g){if(p===0)return;const _=e.get("WEBGL_multi_draw");if(_===null)for(let v=0;v<d.length;v++)l(d[v]/a,f[v],g[v]);else{_.multiDrawElementsInstancedWEBGL(i,f,0,s,d,0,g,0,p);let v=0;for(let b=0;b<p;b++)v+=f[b]*g[b];n.update(v,i,1)}}this.setMode=r,this.setIndex=o,this.render=c,this.renderInstances=l,this.renderMultiDraw=u,this.renderMultiDrawInstances=h}function PIe(t){const e={geometries:0,textures:0},n={frame:0,calls:0,triangles:0,points:0,lines:0};function i(s,a,o){switch(n.calls++,a){case t.TRIANGLES:n.triangles+=o*(s/3);break;case t.LINES:n.lines+=o*(s/2);break;case t.LINE_STRIP:n.lines+=o*(s-1);break;case t.LINE_LOOP:n.lines+=o*s;break;case t.POINTS:n.points+=o*s;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",a);break}}function r(){n.calls=0,n.triangles=0,n.points=0,n.lines=0}return{memory:e,render:n,programs:null,autoReset:!0,reset:r,update:i}}function DIe(t,e,n){const i=new WeakMap,r=new zr;function s(a,o,c){const l=a.morphTargetInfluences,u=o.morphAttributes.position||o.morphAttributes.normal||o.morphAttributes.color,h=u!==void 0?u.length:0;let d=i.get(o);if(d===void 0||d.count!==h){let P=function(){I.dispose(),i.delete(o),o.removeEventListener("dispose",P)};d!==void 0&&d.texture.dispose();const f=o.morphAttributes.position!==void 0,p=o.morphAttributes.normal!==void 0,g=o.morphAttributes.color!==void 0,_=o.morphAttributes.position||[],v=o.morphAttributes.normal||[],b=o.morphAttributes.color||[];let S=0;f===!0&&(S=1),p===!0&&(S=2),g===!0&&(S=3);let x=o.attributes.position.count*S,M=1;x>e.maxTextureSize&&(M=Math.ceil(x/e.maxTextureSize),x=e.maxTextureSize);const R=new Float32Array(x*M*4*h),I=new PI(R,x,M,h);I.type=vu,I.needsUpdate=!0;const k=S*4;for(let U=0;U<h;U++){const V=_[U],$=v[U],q=b[U],Y=x*M*4*U;for(let te=0;te<V.count;te++){const G=te*k;f===!0&&(r.fromBufferAttribute(V,te),R[Y+G+0]=r.x,R[Y+G+1]=r.y,R[Y+G+2]=r.z,R[Y+G+3]=0),p===!0&&(r.fromBufferAttribute($,te),R[Y+G+4]=r.x,R[Y+G+5]=r.y,R[Y+G+6]=r.z,R[Y+G+7]=0),g===!0&&(r.fromBufferAttribute(q,te),R[Y+G+8]=r.x,R[Y+G+9]=r.y,R[Y+G+10]=r.z,R[Y+G+11]=q.itemSize===4?r.w:1)}}d={count:h,texture:I,size:new xt(x,M)},i.set(o,d),o.addEventListener("dispose",P)}if(a.isInstancedMesh===!0&&a.morphTexture!==null)c.getUniforms().setValue(t,"morphTexture",a.morphTexture,n);else{let f=0;for(let g=0;g<l.length;g++)f+=l[g];const p=o.morphTargetsRelative?1:1-f;c.getUniforms().setValue(t,"morphTargetBaseInfluence",p),c.getUniforms().setValue(t,"morphTargetInfluences",l)}c.getUniforms().setValue(t,"morphTargetsTexture",d.texture,n),c.getUniforms().setValue(t,"morphTargetsTextureSize",d.size)}return{update:s}}function LIe(t,e,n,i){let r=new WeakMap;function s(c){const l=i.render.frame,u=c.geometry,h=e.get(c,u);if(r.get(h)!==l&&(e.update(h),r.set(h,l)),c.isInstancedMesh&&(c.hasEventListener("dispose",o)===!1&&c.addEventListener("dispose",o),r.get(c)!==l&&(n.update(c.instanceMatrix,t.ARRAY_BUFFER),c.instanceColor!==null&&n.update(c.instanceColor,t.ARRAY_BUFFER),r.set(c,l))),c.isSkinnedMesh){const d=c.skeleton;r.get(d)!==l&&(d.update(),r.set(d,l))}return h}function a(){r=new WeakMap}function o(c){const l=c.target;l.removeEventListener("dispose",o),n.remove(l.instanceMatrix),l.instanceColor!==null&&n.remove(l.instanceColor)}return{update:s,dispose:a}}const Yue=new Ga,pQ=new JA(1,1),Kue=new PI,Xue=new sF,Zue=new LI,mQ=[],gQ=[],vQ=new Float32Array(16),_Q=new Float32Array(9),yQ=new Float32Array(4);function eR(t,e,n){const i=t[0];if(i<=0||i>0)return t;const r=e*n;let s=mQ[r];if(s===void 0&&(s=new Float32Array(r),mQ[r]=s),e!==0){i.toArray(s,0);for(let a=1,o=0;a!==e;++a)o+=n,t[a].toArray(s,o)}return s}function Xc(t,e){if(t.length!==e.length)return!1;for(let n=0,i=t.length;n<i;n++)if(t[n]!==e[n])return!1;return!0}function Zc(t,e){for(let n=0,i=e.length;n<i;n++)t[n]=e[n]}function CF(t,e){let n=gQ[e];n===void 0&&(n=new Int32Array(e),gQ[e]=n);for(let i=0;i!==e;++i)n[i]=t.allocateTextureUnit();return n}function UIe(t,e){const n=this.cache;n[0]!==e&&(t.uniform1f(this.addr,e),n[0]=e)}function BIe(t,e){const n=this.cache;if(e.x!==void 0)(n[0]!==e.x||n[1]!==e.y)&&(t.uniform2f(this.addr,e.x,e.y),n[0]=e.x,n[1]=e.y);else{if(Xc(n,e))return;t.uniform2fv(this.addr,e),Zc(n,e)}}function FIe(t,e){const n=this.cache;if(e.x!==void 0)(n[0]!==e.x||n[1]!==e.y||n[2]!==e.z)&&(t.uniform3f(this.addr,e.x,e.y,e.z),n[0]=e.x,n[1]=e.y,n[2]=e.z);else if(e.r!==void 0)(n[0]!==e.r||n[1]!==e.g||n[2]!==e.b)&&(t.uniform3f(this.addr,e.r,e.g,e.b),n[0]=e.r,n[1]=e.g,n[2]=e.b);else{if(Xc(n,e))return;t.uniform3fv(this.addr,e),Zc(n,e)}}function zIe(t,e){const n=this.cache;if(e.x!==void 0)(n[0]!==e.x||n[1]!==e.y||n[2]!==e.z||n[3]!==e.w)&&(t.uniform4f(this.addr,e.x,e.y,e.z,e.w),n[0]=e.x,n[1]=e.y,n[2]=e.z,n[3]=e.w);else{if(Xc(n,e))return;t.uniform4fv(this.addr,e),Zc(n,e)}}function jIe(t,e){const n=this.cache,i=e.elements;if(i===void 0){if(Xc(n,e))return;t.uniformMatrix2fv(this.addr,!1,e),Zc(n,e)}else{if(Xc(n,i))return;yQ.set(i),t.uniformMatrix2fv(this.addr,!1,yQ),Zc(n,i)}}function HIe(t,e){const n=this.cache,i=e.elements;if(i===void 0){if(Xc(n,e))return;t.uniformMatrix3fv(this.addr,!1,e),Zc(n,e)}else{if(Xc(n,i))return;_Q.set(i),t.uniformMatrix3fv(this.addr,!1,_Q),Zc(n,i)}}function VIe(t,e){const n=this.cache,i=e.elements;if(i===void 0){if(Xc(n,e))return;t.uniformMatrix4fv(this.addr,!1,e),Zc(n,e)}else{if(Xc(n,i))return;vQ.set(i),t.uniformMatrix4fv(this.addr,!1,vQ),Zc(n,i)}}function GIe(t,e){const n=this.cache;n[0]!==e&&(t.uniform1i(this.addr,e),n[0]=e)}function qIe(t,e){const n=this.cache;if(e.x!==void 0)(n[0]!==e.x||n[1]!==e.y)&&(t.uniform2i(this.addr,e.x,e.y),n[0]=e.x,n[1]=e.y);else{if(Xc(n,e))return;t.uniform2iv(this.addr,e),Zc(n,e)}}function $Ie(t,e){const n=this.cache;if(e.x!==void 0)(n[0]!==e.x||n[1]!==e.y||n[2]!==e.z)&&(t.uniform3i(this.addr,e.x,e.y,e.z),n[0]=e.x,n[1]=e.y,n[2]=e.z);else{if(Xc(n,e))return;t.uniform3iv(this.addr,e),Zc(n,e)}}function WIe(t,e){const n=this.cache;if(e.x!==void 0)(n[0]!==e.x||n[1]!==e.y||n[2]!==e.z||n[3]!==e.w)&&(t.uniform4i(this.addr,e.x,e.y,e.z,e.w),n[0]=e.x,n[1]=e.y,n[2]=e.z,n[3]=e.w);else{if(Xc(n,e))return;t.uniform4iv(this.addr,e),Zc(n,e)}}function YIe(t,e){const n=this.cache;n[0]!==e&&(t.uniform1ui(this.addr,e),n[0]=e)}function KIe(t,e){const n=this.cache;if(e.x!==void 0)(n[0]!==e.x||n[1]!==e.y)&&(t.uniform2ui(this.addr,e.x,e.y),n[0]=e.x,n[1]=e.y);else{if(Xc(n,e))return;t.uniform2uiv(this.addr,e),Zc(n,e)}}function XIe(t,e){const n=this.cache;if(e.x!==void 0)(n[0]!==e.x||n[1]!==e.y||n[2]!==e.z)&&(t.uniform3ui(this.addr,e.x,e.y,e.z),n[0]=e.x,n[1]=e.y,n[2]=e.z);else{if(Xc(n,e))return;t.uniform3uiv(this.addr,e),Zc(n,e)}}function ZIe(t,e){const n=this.cache;if(e.x!==void 0)(n[0]!==e.x||n[1]!==e.y||n[2]!==e.z||n[3]!==e.w)&&(t.uniform4ui(this.addr,e.x,e.y,e.z,e.w),n[0]=e.x,n[1]=e.y,n[2]=e.z,n[3]=e.w);else{if(Xc(n,e))return;t.uniform4uiv(this.addr,e),Zc(n,e)}}function JIe(t,e,n){const i=this.cache,r=n.allocateTextureUnit();i[0]!==r&&(t.uniform1i(this.addr,r),i[0]=r);let s;this.type===t.SAMPLER_2D_SHADOW?(pQ.compareFunction=X7,s=pQ):s=Yue,n.setTexture2D(e||s,r)}function QIe(t,e,n){const i=this.cache,r=n.allocateTextureUnit();i[0]!==r&&(t.uniform1i(this.addr,r),i[0]=r),n.setTexture3D(e||Xue,r)}function eke(t,e,n){const i=this.cache,r=n.allocateTextureUnit();i[0]!==r&&(t.uniform1i(this.addr,r),i[0]=r),n.setTextureCube(e||Zue,r)}function tke(t,e,n){const i=this.cache,r=n.allocateTextureUnit();i[0]!==r&&(t.uniform1i(this.addr,r),i[0]=r),n.setTexture2DArray(e||Kue,r)}function nke(t){switch(t){case 5126:return UIe;case 35664:return BIe;case 35665:return FIe;case 35666:return zIe;case 35674:return jIe;case 35675:return HIe;case 35676:return VIe;case 5124:case 35670:return GIe;case 35667:case 35671:return qIe;case 35668:case 35672:return $Ie;case 35669:case 35673:return WIe;case 5125:return YIe;case 36294:return KIe;case 36295:return XIe;case 36296:return ZIe;case 35678:case 36198:case 36298:case 36306:case 35682:return JIe;case 35679:case 36299:case 36307:return QIe;case 35680:case 36300:case 36308:case 36293:return eke;case 36289:case 36303:case 36311:case 36292:return tke}}function ike(t,e){t.uniform1fv(this.addr,e)}function rke(t,e){const n=eR(e,this.size,2);t.uniform2fv(this.addr,n)}function ske(t,e){const n=eR(e,this.size,3);t.uniform3fv(this.addr,n)}function ake(t,e){const n=eR(e,this.size,4);t.uniform4fv(this.addr,n)}function oke(t,e){const n=eR(e,this.size,4);t.uniformMatrix2fv(this.addr,!1,n)}function cke(t,e){const n=eR(e,this.size,9);t.uniformMatrix3fv(this.addr,!1,n)}function lke(t,e){const n=eR(e,this.size,16);t.uniformMatrix4fv(this.addr,!1,n)}function uke(t,e){t.uniform1iv(this.addr,e)}function hke(t,e){t.uniform2iv(this.addr,e)}function dke(t,e){t.uniform3iv(this.addr,e)}function fke(t,e){t.uniform4iv(this.addr,e)}function pke(t,e){t.uniform1uiv(this.addr,e)}function mke(t,e){t.uniform2uiv(this.addr,e)}function gke(t,e){t.uniform3uiv(this.addr,e)}function vke(t,e){t.uniform4uiv(this.addr,e)}function _ke(t,e,n){const i=this.cache,r=e.length,s=CF(n,r);Xc(i,s)||(t.uniform1iv(this.addr,s),Zc(i,s));for(let a=0;a!==r;++a)n.setTexture2D(e[a]||Yue,s[a])}function yke(t,e,n){const i=this.cache,r=e.length,s=CF(n,r);Xc(i,s)||(t.uniform1iv(this.addr,s),Zc(i,s));for(let a=0;a!==r;++a)n.setTexture3D(e[a]||Xue,s[a])}function bke(t,e,n){const i=this.cache,r=e.length,s=CF(n,r);Xc(i,s)||(t.uniform1iv(this.addr,s),Zc(i,s));for(let a=0;a!==r;++a)n.setTextureCube(e[a]||Zue,s[a])}function Eke(t,e,n){const i=this.cache,r=e.length,s=CF(n,r);Xc(i,s)||(t.uniform1iv(this.addr,s),Zc(i,s));for(let a=0;a!==r;++a)n.setTexture2DArray(e[a]||Kue,s[a])}function Ske(t){switch(t){case 5126:return ike;case 35664:return rke;case 35665:return ske;case 35666:return ake;case 35674:return oke;case 35675:return cke;case 35676:return lke;case 5124:case 35670:return uke;case 35667:case 35671:return hke;case 35668:case 35672:return dke;case 35669:case 35673:return fke;case 5125:return pke;case 36294:return mke;case 36295:return gke;case 36296:return vke;case 35678:case 36198:case 36298:case 36306:case 35682:return _ke;case 35679:case 36299:case 36307:return yke;case 35680:case 36300:case 36308:case 36293:return bke;case 36289:case 36303:case 36311:case 36292:return Eke}}class Tke{constructor(e,n,i){this.id=e,this.addr=i,this.cache=[],this.type=n.type,this.setValue=nke(n.type)}}class xke{constructor(e,n,i){this.id=e,this.addr=i,this.cache=[],this.type=n.type,this.size=n.size,this.setValue=Ske(n.type)}}class wke{constructor(e){this.id=e,this.seq=[],this.map={}}setValue(e,n,i){const r=this.seq;for(let s=0,a=r.length;s!==a;++s){const o=r[s];o.setValue(e,n[o.id],i)}}}const J5=/(\w+)(\])?(\[|\.)?/g;function bQ(t,e){t.seq.push(e),t.map[e.id]=e}function Cke(t,e,n){const i=t.name,r=i.length;for(J5.lastIndex=0;;){const s=J5.exec(i),a=J5.lastIndex;let o=s[1];const c=s[2]==="]",l=s[3];if(c&&(o=o|0),l===void 0||l==="["&&a+2===r){bQ(n,l===void 0?new Tke(o,t,e):new xke(o,t,e));break}else{let h=n.map[o];h===void 0&&(h=new wke(o),bQ(n,h)),n=h}}}class L2{constructor(e,n){this.seq=[],this.map={};const i=e.getProgramParameter(n,e.ACTIVE_UNIFORMS);for(let r=0;r<i;++r){const s=e.getActiveUniform(n,r),a=e.getUniformLocation(n,s.name);Cke(s,a,this)}}setValue(e,n,i,r){const s=this.map[n];s!==void 0&&s.setValue(e,i,r)}setOptional(e,n,i){const r=n[i];r!==void 0&&this.setValue(e,i,r)}static upload(e,n,i,r){for(let s=0,a=n.length;s!==a;++s){const o=n[s],c=i[o.id];c.needsUpdate!==!1&&o.setValue(e,c.value,r)}}static seqWithValue(e,n){const i=[];for(let r=0,s=e.length;r!==s;++r){const a=e[r];a.id in n&&i.push(a)}return i}}function EQ(t,e,n){const i=t.createShader(e);return t.shaderSource(i,n),t.compileShader(i),i}const Ake=37297;let Rke=0;function Mke(t,e){const n=t.split(`
`),i=[],r=Math.max(e-6,0),s=Math.min(e+6,n.length);for(let a=r;a<s;a++){const o=a+1;i.push(`${o===e?">":" "} ${o}: ${n[a]}`)}return i.join(`
`)}const SQ=new Qi;function Oke(t){Br._getMatrix(SQ,Br.workingColorSpace,t);const e=`mat3( ${SQ.elements.map(n=>n.toFixed(4))} )`;switch(Br.getTransfer(t)){case YO:return[e,"LinearTransferOETF"];case Ns:return[e,"sRGBTransferOETF"];default:return console.warn("THREE.WebGLProgram: Unsupported color space: ",t),[e,"LinearTransferOETF"]}}function TQ(t,e,n){const i=t.getShaderParameter(e,t.COMPILE_STATUS),r=t.getShaderInfoLog(e).trim();if(i&&r==="")return"";const s=/ERROR: 0:(\d+)/.exec(r);if(s){const a=parseInt(s[1]);return n.toUpperCase()+`

`+r+`

`+Mke(t.getShaderSource(e),a)}else return r}function Nke(t,e){const n=Oke(e);return[`vec4 ${t}( vec4 value ) {`,`	return ${n[1]}( vec4( value.rgb * ${n[0]}, value.a ) );`,"}"].join(`
`)}function Ike(t,e){let n;switch(e){case Sle:n="Linear";break;case Tle:n="Reinhard";break;case xle:n="Cineon";break;case j7:n="ACESFilmic";break;case Cle:n="AgX";break;case Ale:n="Neutral";break;case wle:n="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",e),n="Linear"}return"vec3 "+t+"( vec3 color ) { return "+n+"ToneMapping( color ); }"}const gD=new Oe;function kke(){Br.getLuminanceCoefficients(gD);const t=gD.x.toFixed(4),e=gD.y.toFixed(4),n=gD.z.toFixed(4);return["float luminance( const in vec3 rgb ) {",`	const vec3 weights = vec3( ${t}, ${e}, ${n} );`,"	return dot( weights, rgb );","}"].join(`
`)}function Pke(t){return[t.extensionClipCullDistance?"#extension GL_ANGLE_clip_cull_distance : require":"",t.extensionMultiDraw?"#extension GL_ANGLE_multi_draw : require":""].filter(PM).join(`
`)}function Dke(t){const e=[];for(const n in t){const i=t[n];i!==!1&&e.push("#define "+n+" "+i)}return e.join(`
`)}function Lke(t,e){const n={},i=t.getProgramParameter(e,t.ACTIVE_ATTRIBUTES);for(let r=0;r<i;r++){const s=t.getActiveAttrib(e,r),a=s.name;let o=1;s.type===t.FLOAT_MAT2&&(o=2),s.type===t.FLOAT_MAT3&&(o=3),s.type===t.FLOAT_MAT4&&(o=4),n[a]={type:s.type,location:t.getAttribLocation(e,a),locationSize:o}}return n}function PM(t){return t!==""}function xQ(t,e){const n=e.numSpotLightShadows+e.numSpotLightMaps-e.numSpotLightShadowsWithMaps;return t.replace(/NUM_DIR_LIGHTS/g,e.numDirLights).replace(/NUM_SPOT_LIGHTS/g,e.numSpotLights).replace(/NUM_SPOT_LIGHT_MAPS/g,e.numSpotLightMaps).replace(/NUM_SPOT_LIGHT_COORDS/g,n).replace(/NUM_RECT_AREA_LIGHTS/g,e.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,e.numPointLights).replace(/NUM_HEMI_LIGHTS/g,e.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,e.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS/g,e.numSpotLightShadowsWithMaps).replace(/NUM_SPOT_LIGHT_SHADOWS/g,e.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,e.numPointLightShadows)}function wQ(t,e){return t.replace(/NUM_CLIPPING_PLANES/g,e.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,e.numClippingPlanes-e.numClipIntersection)}const Uke=/^[ \t]*#include +<([\w\d./]+)>/gm;function cG(t){return t.replace(Uke,Fke)}const Bke=new Map;function Fke(t,e){let n=rr[e];if(n===void 0){const i=Bke.get(e);if(i!==void 0)n=rr[i],console.warn('THREE.WebGLRenderer: Shader chunk "%s" has been deprecated. Use "%s" instead.',e,i);else throw new Error("Can not resolve #include <"+e+">")}return cG(n)}const zke=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function CQ(t){return t.replace(zke,jke)}function jke(t,e,n,i){let r="";for(let s=parseInt(e);s<parseInt(n);s++)r+=i.replace(/\[\s*i\s*\]/g,"[ "+s+" ]").replace(/UNROLLED_LOOP_INDEX/g,s);return r}function AQ(t){let e=`precision ${t.precision} float;
	precision ${t.precision} int;
	precision ${t.precision} sampler2D;
	precision ${t.precision} samplerCube;
	precision ${t.precision} sampler3D;
	precision ${t.precision} sampler2DArray;
	precision ${t.precision} sampler2DShadow;
	precision ${t.precision} samplerCubeShadow;
	precision ${t.precision} sampler2DArrayShadow;
	precision ${t.precision} isampler2D;
	precision ${t.precision} isampler3D;
	precision ${t.precision} isamplerCube;
	precision ${t.precision} isampler2DArray;
	precision ${t.precision} usampler2D;
	precision ${t.precision} usampler3D;
	precision ${t.precision} usamplerCube;
	precision ${t.precision} usampler2DArray;
	`;return t.precision==="highp"?e+=`
#define HIGH_PRECISION`:t.precision==="mediump"?e+=`
#define MEDIUM_PRECISION`:t.precision==="lowp"&&(e+=`
#define LOW_PRECISION`),e}function Hke(t){let e="SHADOWMAP_TYPE_BASIC";return t.shadowMapType===XB?e="SHADOWMAP_TYPE_PCF":t.shadowMapType===ZM?e="SHADOWMAP_TYPE_PCF_SOFT":t.shadowMapType===lm&&(e="SHADOWMAP_TYPE_VSM"),e}function Vke(t){let e="ENVMAP_TYPE_CUBE";if(t.envMap)switch(t.envMapMode){case T_:case eE:e="ENVMAP_TYPE_CUBE";break;case YA:e="ENVMAP_TYPE_CUBE_UV";break}return e}function Gke(t){let e="ENVMAP_MODE_REFLECTION";if(t.envMap)switch(t.envMapMode){case eE:e="ENVMAP_MODE_REFRACTION";break}return e}function qke(t){let e="ENVMAP_BLENDING_NONE";if(t.envMap)switch(t.combine){case NI:e="ENVMAP_BLENDING_MULTIPLY";break;case ble:e="ENVMAP_BLENDING_MIX";break;case Ele:e="ENVMAP_BLENDING_ADD";break}return e}function $ke(t){const e=t.envMapCubeUVHeight;if(e===null)return null;const n=Math.log2(e)-2,i=1/e;return{texelWidth:1/(3*Math.max(Math.pow(2,n),7*16)),texelHeight:i,maxMip:n}}function Wke(t,e,n,i){const r=t.getContext(),s=n.defines;let a=n.vertexShader,o=n.fragmentShader;const c=Hke(n),l=Vke(n),u=Gke(n),h=qke(n),d=$ke(n),f=Pke(n),p=Dke(s),g=r.createProgram();let _,v,b=n.glslVersion?"#version "+n.glslVersion+`
`:"";n.isRawShaderMaterial?(_=["#define SHADER_TYPE "+n.shaderType,"#define SHADER_NAME "+n.shaderName,p].filter(PM).join(`
`),_.length>0&&(_+=`
`),v=["#define SHADER_TYPE "+n.shaderType,"#define SHADER_NAME "+n.shaderName,p].filter(PM).join(`
`),v.length>0&&(v+=`
`)):(_=[AQ(n),"#define SHADER_TYPE "+n.shaderType,"#define SHADER_NAME "+n.shaderName,p,n.extensionClipCullDistance?"#define USE_CLIP_DISTANCE":"",n.batching?"#define USE_BATCHING":"",n.batchingColor?"#define USE_BATCHING_COLOR":"",n.instancing?"#define USE_INSTANCING":"",n.instancingColor?"#define USE_INSTANCING_COLOR":"",n.instancingMorph?"#define USE_INSTANCING_MORPH":"",n.useFog&&n.fog?"#define USE_FOG":"",n.useFog&&n.fogExp2?"#define FOG_EXP2":"",n.map?"#define USE_MAP":"",n.envMap?"#define USE_ENVMAP":"",n.envMap?"#define "+u:"",n.lightMap?"#define USE_LIGHTMAP":"",n.aoMap?"#define USE_AOMAP":"",n.bumpMap?"#define USE_BUMPMAP":"",n.normalMap?"#define USE_NORMALMAP":"",n.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",n.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",n.displacementMap?"#define USE_DISPLACEMENTMAP":"",n.emissiveMap?"#define USE_EMISSIVEMAP":"",n.anisotropy?"#define USE_ANISOTROPY":"",n.anisotropyMap?"#define USE_ANISOTROPYMAP":"",n.clearcoatMap?"#define USE_CLEARCOATMAP":"",n.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",n.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",n.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",n.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",n.specularMap?"#define USE_SPECULARMAP":"",n.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",n.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",n.roughnessMap?"#define USE_ROUGHNESSMAP":"",n.metalnessMap?"#define USE_METALNESSMAP":"",n.alphaMap?"#define USE_ALPHAMAP":"",n.alphaHash?"#define USE_ALPHAHASH":"",n.transmission?"#define USE_TRANSMISSION":"",n.transmissionMap?"#define USE_TRANSMISSIONMAP":"",n.thicknessMap?"#define USE_THICKNESSMAP":"",n.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",n.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",n.mapUv?"#define MAP_UV "+n.mapUv:"",n.alphaMapUv?"#define ALPHAMAP_UV "+n.alphaMapUv:"",n.lightMapUv?"#define LIGHTMAP_UV "+n.lightMapUv:"",n.aoMapUv?"#define AOMAP_UV "+n.aoMapUv:"",n.emissiveMapUv?"#define EMISSIVEMAP_UV "+n.emissiveMapUv:"",n.bumpMapUv?"#define BUMPMAP_UV "+n.bumpMapUv:"",n.normalMapUv?"#define NORMALMAP_UV "+n.normalMapUv:"",n.displacementMapUv?"#define DISPLACEMENTMAP_UV "+n.displacementMapUv:"",n.metalnessMapUv?"#define METALNESSMAP_UV "+n.metalnessMapUv:"",n.roughnessMapUv?"#define ROUGHNESSMAP_UV "+n.roughnessMapUv:"",n.anisotropyMapUv?"#define ANISOTROPYMAP_UV "+n.anisotropyMapUv:"",n.clearcoatMapUv?"#define CLEARCOATMAP_UV "+n.clearcoatMapUv:"",n.clearcoatNormalMapUv?"#define CLEARCOAT_NORMALMAP_UV "+n.clearcoatNormalMapUv:"",n.clearcoatRoughnessMapUv?"#define CLEARCOAT_ROUGHNESSMAP_UV "+n.clearcoatRoughnessMapUv:"",n.iridescenceMapUv?"#define IRIDESCENCEMAP_UV "+n.iridescenceMapUv:"",n.iridescenceThicknessMapUv?"#define IRIDESCENCE_THICKNESSMAP_UV "+n.iridescenceThicknessMapUv:"",n.sheenColorMapUv?"#define SHEEN_COLORMAP_UV "+n.sheenColorMapUv:"",n.sheenRoughnessMapUv?"#define SHEEN_ROUGHNESSMAP_UV "+n.sheenRoughnessMapUv:"",n.specularMapUv?"#define SPECULARMAP_UV "+n.specularMapUv:"",n.specularColorMapUv?"#define SPECULAR_COLORMAP_UV "+n.specularColorMapUv:"",n.specularIntensityMapUv?"#define SPECULAR_INTENSITYMAP_UV "+n.specularIntensityMapUv:"",n.transmissionMapUv?"#define TRANSMISSIONMAP_UV "+n.transmissionMapUv:"",n.thicknessMapUv?"#define THICKNESSMAP_UV "+n.thicknessMapUv:"",n.vertexTangents&&n.flatShading===!1?"#define USE_TANGENT":"",n.vertexColors?"#define USE_COLOR":"",n.vertexAlphas?"#define USE_COLOR_ALPHA":"",n.vertexUv1s?"#define USE_UV1":"",n.vertexUv2s?"#define USE_UV2":"",n.vertexUv3s?"#define USE_UV3":"",n.pointsUvs?"#define USE_POINTS_UV":"",n.flatShading?"#define FLAT_SHADED":"",n.skinning?"#define USE_SKINNING":"",n.morphTargets?"#define USE_MORPHTARGETS":"",n.morphNormals&&n.flatShading===!1?"#define USE_MORPHNORMALS":"",n.morphColors?"#define USE_MORPHCOLORS":"",n.morphTargetsCount>0?"#define MORPHTARGETS_TEXTURE_STRIDE "+n.morphTextureStride:"",n.morphTargetsCount>0?"#define MORPHTARGETS_COUNT "+n.morphTargetsCount:"",n.doubleSided?"#define DOUBLE_SIDED":"",n.flipSided?"#define FLIP_SIDED":"",n.shadowMapEnabled?"#define USE_SHADOWMAP":"",n.shadowMapEnabled?"#define "+c:"",n.sizeAttenuation?"#define USE_SIZEATTENUATION":"",n.numLightProbes>0?"#define USE_LIGHT_PROBES":"",n.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",n.reverseDepthBuffer?"#define USE_REVERSEDEPTHBUF":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","	attribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","	attribute vec3 instanceColor;","#endif","#ifdef USE_INSTANCING_MORPH","	uniform sampler2D morphTexture;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_UV1","	attribute vec2 uv1;","#endif","#ifdef USE_UV2","	attribute vec2 uv2;","#endif","#ifdef USE_UV3","	attribute vec2 uv3;","#endif","#ifdef USE_TANGENT","	attribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","	attribute vec4 color;","#elif defined( USE_COLOR )","	attribute vec3 color;","#endif","#ifdef USE_SKINNING","	attribute vec4 skinIndex;","	attribute vec4 skinWeight;","#endif",`
`].filter(PM).join(`
`),v=[AQ(n),"#define SHADER_TYPE "+n.shaderType,"#define SHADER_NAME "+n.shaderName,p,n.useFog&&n.fog?"#define USE_FOG":"",n.useFog&&n.fogExp2?"#define FOG_EXP2":"",n.alphaToCoverage?"#define ALPHA_TO_COVERAGE":"",n.map?"#define USE_MAP":"",n.matcap?"#define USE_MATCAP":"",n.envMap?"#define USE_ENVMAP":"",n.envMap?"#define "+l:"",n.envMap?"#define "+u:"",n.envMap?"#define "+h:"",d?"#define CUBEUV_TEXEL_WIDTH "+d.texelWidth:"",d?"#define CUBEUV_TEXEL_HEIGHT "+d.texelHeight:"",d?"#define CUBEUV_MAX_MIP "+d.maxMip+".0":"",n.lightMap?"#define USE_LIGHTMAP":"",n.aoMap?"#define USE_AOMAP":"",n.bumpMap?"#define USE_BUMPMAP":"",n.normalMap?"#define USE_NORMALMAP":"",n.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",n.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",n.emissiveMap?"#define USE_EMISSIVEMAP":"",n.anisotropy?"#define USE_ANISOTROPY":"",n.anisotropyMap?"#define USE_ANISOTROPYMAP":"",n.clearcoat?"#define USE_CLEARCOAT":"",n.clearcoatMap?"#define USE_CLEARCOATMAP":"",n.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",n.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",n.dispersion?"#define USE_DISPERSION":"",n.iridescence?"#define USE_IRIDESCENCE":"",n.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",n.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",n.specularMap?"#define USE_SPECULARMAP":"",n.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",n.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",n.roughnessMap?"#define USE_ROUGHNESSMAP":"",n.metalnessMap?"#define USE_METALNESSMAP":"",n.alphaMap?"#define USE_ALPHAMAP":"",n.alphaTest?"#define USE_ALPHATEST":"",n.alphaHash?"#define USE_ALPHAHASH":"",n.sheen?"#define USE_SHEEN":"",n.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",n.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",n.transmission?"#define USE_TRANSMISSION":"",n.transmissionMap?"#define USE_TRANSMISSIONMAP":"",n.thicknessMap?"#define USE_THICKNESSMAP":"",n.vertexTangents&&n.flatShading===!1?"#define USE_TANGENT":"",n.vertexColors||n.instancingColor||n.batchingColor?"#define USE_COLOR":"",n.vertexAlphas?"#define USE_COLOR_ALPHA":"",n.vertexUv1s?"#define USE_UV1":"",n.vertexUv2s?"#define USE_UV2":"",n.vertexUv3s?"#define USE_UV3":"",n.pointsUvs?"#define USE_POINTS_UV":"",n.gradientMap?"#define USE_GRADIENTMAP":"",n.flatShading?"#define FLAT_SHADED":"",n.doubleSided?"#define DOUBLE_SIDED":"",n.flipSided?"#define FLIP_SIDED":"",n.shadowMapEnabled?"#define USE_SHADOWMAP":"",n.shadowMapEnabled?"#define "+c:"",n.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",n.numLightProbes>0?"#define USE_LIGHT_PROBES":"",n.decodeVideoTexture?"#define DECODE_VIDEO_TEXTURE":"",n.decodeVideoTextureEmissive?"#define DECODE_VIDEO_TEXTURE_EMISSIVE":"",n.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",n.reverseDepthBuffer?"#define USE_REVERSEDEPTHBUF":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",n.toneMapping!==Em?"#define TONE_MAPPING":"",n.toneMapping!==Em?rr.tonemapping_pars_fragment:"",n.toneMapping!==Em?Ike("toneMapping",n.toneMapping):"",n.dithering?"#define DITHERING":"",n.opaque?"#define OPAQUE":"",rr.colorspace_pars_fragment,Nke("linearToOutputTexel",n.outputColorSpace),kke(),n.useDepthPacking?"#define DEPTH_PACKING "+n.depthPacking:"",`
`].filter(PM).join(`
`)),a=cG(a),a=xQ(a,n),a=wQ(a,n),o=cG(o),o=xQ(o,n),o=wQ(o,n),a=CQ(a),o=CQ(o),n.isRawShaderMaterial!==!0&&(b=`#version 300 es
`,_=[f,"#define attribute in","#define varying out","#define texture2D texture"].join(`
`)+`
`+_,v=["#define varying in",n.glslVersion===QV?"":"layout(location = 0) out highp vec4 pc_fragColor;",n.glslVersion===QV?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join(`
`)+`
`+v);const S=b+_+a,x=b+v+o,M=EQ(r,r.VERTEX_SHADER,S),R=EQ(r,r.FRAGMENT_SHADER,x);r.attachShader(g,M),r.attachShader(g,R),n.index0AttributeName!==void 0?r.bindAttribLocation(g,0,n.index0AttributeName):n.morphTargets===!0&&r.bindAttribLocation(g,0,"position"),r.linkProgram(g);function I(V){if(t.debug.checkShaderErrors){const $=r.getProgramInfoLog(g).trim(),q=r.getShaderInfoLog(M).trim(),Y=r.getShaderInfoLog(R).trim();let te=!0,G=!0;if(r.getProgramParameter(g,r.LINK_STATUS)===!1)if(te=!1,typeof t.debug.onShaderError=="function")t.debug.onShaderError(r,g,M,R);else{const J=TQ(r,M,"vertex"),K=TQ(r,R,"fragment");console.error("THREE.WebGLProgram: Shader Error "+r.getError()+" - VALIDATE_STATUS "+r.getProgramParameter(g,r.VALIDATE_STATUS)+`

Material Name: `+V.name+`
Material Type: `+V.type+`

Program Info Log: `+$+`
`+J+`
`+K)}else $!==""?console.warn("THREE.WebGLProgram: Program Info Log:",$):(q===""||Y==="")&&(G=!1);G&&(V.diagnostics={runnable:te,programLog:$,vertexShader:{log:q,prefix:_},fragmentShader:{log:Y,prefix:v}})}r.deleteShader(M),r.deleteShader(R),k=new L2(r,g),P=Lke(r,g)}let k;this.getUniforms=function(){return k===void 0&&I(this),k};let P;this.getAttributes=function(){return P===void 0&&I(this),P};let U=n.rendererExtensionParallelShaderCompile===!1;return this.isReady=function(){return U===!1&&(U=r.getProgramParameter(g,Ake)),U},this.destroy=function(){i.releaseStatesOfProgram(this),r.deleteProgram(g),this.program=void 0},this.type=n.shaderType,this.name=n.shaderName,this.id=Rke++,this.cacheKey=e,this.usedTimes=1,this.program=g,this.vertexShader=M,this.fragmentShader=R,this}let Yke=0;class Kke{constructor(){this.shaderCache=new Map,this.materialCache=new Map}update(e){const n=e.vertexShader,i=e.fragmentShader,r=this._getShaderStage(n),s=this._getShaderStage(i),a=this._getShaderCacheForMaterial(e);return a.has(r)===!1&&(a.add(r),r.usedTimes++),a.has(s)===!1&&(a.add(s),s.usedTimes++),this}remove(e){const n=this.materialCache.get(e);for(const i of n)i.usedTimes--,i.usedTimes===0&&this.shaderCache.delete(i.code);return this.materialCache.delete(e),this}getVertexShaderID(e){return this._getShaderStage(e.vertexShader).id}getFragmentShaderID(e){return this._getShaderStage(e.fragmentShader).id}dispose(){this.shaderCache.clear(),this.materialCache.clear()}_getShaderCacheForMaterial(e){const n=this.materialCache;let i=n.get(e);return i===void 0&&(i=new Set,n.set(e,i)),i}_getShaderStage(e){const n=this.shaderCache;let i=n.get(e);return i===void 0&&(i=new Xke(e),n.set(e,i)),i}}class Xke{constructor(e){this.id=Yke++,this.code=e,this.usedTimes=0}}function Zke(t,e,n,i,r,s,a){const o=new jC,c=new Kke,l=new Set,u=[],h=r.logarithmicDepthBuffer,d=r.vertexTextures;let f=r.precision;const p={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"};function g(P){return l.add(P),P===0?"uv":`uv${P}`}function _(P,U,V,$,q){const Y=$.fog,te=q.geometry,G=P.isMeshStandardMaterial?$.environment:null,J=(P.isMeshStandardMaterial?n:e).get(P.envMap||G),K=J&&J.mapping===YA?J.image.height:null,X=p[P.type];P.precision!==null&&(f=r.getMaxPrecision(P.precision),f!==P.precision&&console.warn("THREE.WebGLProgram.getParameters:",P.precision,"not supported, using",f,"instead."));const ae=te.morphAttributes.position||te.morphAttributes.normal||te.morphAttributes.color,ce=ae!==void 0?ae.length:0;let Me=0;te.morphAttributes.position!==void 0&&(Me=1),te.morphAttributes.normal!==void 0&&(Me=2),te.morphAttributes.color!==void 0&&(Me=3);let Fe,Te,Re,ge;if(X){const Ot=dm[X];Fe=Ot.vertexShader,Te=Ot.fragmentShader}else Fe=P.vertexShader,Te=P.fragmentShader,c.update(P),Re=c.getVertexShaderID(P),ge=c.getFragmentShaderID(P);const _e=t.getRenderTarget(),ke=t.state.buffers.depth.getReversed(),gt=q.isInstancedMesh===!0,wt=q.isBatchedMesh===!0,ye=!!P.map,Se=!!P.matcap,Qe=!!J,pe=!!P.aoMap,ze=!!P.lightMap,Le=!!P.bumpMap,rt=!!P.normalMap,dt=!!P.displacementMap,pt=!!P.emissiveMap,bt=!!P.metalnessMap,we=!!P.roughnessMap,he=P.anisotropy>0,$e=P.clearcoat>0,et=P.dispersion>0,Et=P.iridescence>0,ct=P.sheen>0,tn=P.transmission>0,Ht=he&&!!P.anisotropyMap,pn=$e&&!!P.clearcoatMap,le=$e&&!!P.clearcoatNormalMap,z=$e&&!!P.clearcoatRoughnessMap,W=Et&&!!P.iridescenceMap,fe=Et&&!!P.iridescenceThicknessMap,Ne=ct&&!!P.sheenColorMap,Be=ct&&!!P.sheenRoughnessMap,tt=!!P.specularMap,Tt=!!P.specularColorMap,Cn=!!P.specularIntensityMap,je=tn&&!!P.transmissionMap,zt=tn&&!!P.thicknessMap,ht=!!P.gradientMap,Pt=!!P.alphaMap,hn=P.alphaTest>0,on=!!P.alphaHash,Ve=!!P.extensions;let at=Em;P.toneMapped&&(_e===null||_e.isXRRenderTarget===!0)&&(at=t.toneMapping);const Mt={shaderID:X,shaderType:P.type,shaderName:P.name,vertexShader:Fe,fragmentShader:Te,defines:P.defines,customVertexShaderID:Re,customFragmentShaderID:ge,isRawShaderMaterial:P.isRawShaderMaterial===!0,glslVersion:P.glslVersion,precision:f,batching:wt,batchingColor:wt&&q._colorsTexture!==null,instancing:gt,instancingColor:gt&&q.instanceColor!==null,instancingMorph:gt&&q.morphTexture!==null,supportsVertexTextures:d,outputColorSpace:_e===null?t.outputColorSpace:_e.isXRRenderTarget===!0?_e.texture.colorSpace:a0,alphaToCoverage:!!P.alphaToCoverage,map:ye,matcap:Se,envMap:Qe,envMapMode:Qe&&J.mapping,envMapCubeUVHeight:K,aoMap:pe,lightMap:ze,bumpMap:Le,normalMap:rt,displacementMap:d&&dt,emissiveMap:pt,normalMapObjectSpace:rt&&P.normalMapType===kle,normalMapTangentSpace:rt&&P.normalMapType===xE,metalnessMap:bt,roughnessMap:we,anisotropy:he,anisotropyMap:Ht,clearcoat:$e,clearcoatMap:pn,clearcoatNormalMap:le,clearcoatRoughnessMap:z,dispersion:et,iridescence:Et,iridescenceMap:W,iridescenceThicknessMap:fe,sheen:ct,sheenColorMap:Ne,sheenRoughnessMap:Be,specularMap:tt,specularColorMap:Tt,specularIntensityMap:Cn,transmission:tn,transmissionMap:je,thicknessMap:zt,gradientMap:ht,opaque:P.transparent===!1&&P.blending===AT&&P.alphaToCoverage===!1,alphaMap:Pt,alphaTest:hn,alphaHash:on,combine:P.combine,mapUv:ye&&g(P.map.channel),aoMapUv:pe&&g(P.aoMap.channel),lightMapUv:ze&&g(P.lightMap.channel),bumpMapUv:Le&&g(P.bumpMap.channel),normalMapUv:rt&&g(P.normalMap.channel),displacementMapUv:dt&&g(P.displacementMap.channel),emissiveMapUv:pt&&g(P.emissiveMap.channel),metalnessMapUv:bt&&g(P.metalnessMap.channel),roughnessMapUv:we&&g(P.roughnessMap.channel),anisotropyMapUv:Ht&&g(P.anisotropyMap.channel),clearcoatMapUv:pn&&g(P.clearcoatMap.channel),clearcoatNormalMapUv:le&&g(P.clearcoatNormalMap.channel),clearcoatRoughnessMapUv:z&&g(P.clearcoatRoughnessMap.channel),iridescenceMapUv:W&&g(P.iridescenceMap.channel),iridescenceThicknessMapUv:fe&&g(P.iridescenceThicknessMap.channel),sheenColorMapUv:Ne&&g(P.sheenColorMap.channel),sheenRoughnessMapUv:Be&&g(P.sheenRoughnessMap.channel),specularMapUv:tt&&g(P.specularMap.channel),specularColorMapUv:Tt&&g(P.specularColorMap.channel),specularIntensityMapUv:Cn&&g(P.specularIntensityMap.channel),transmissionMapUv:je&&g(P.transmissionMap.channel),thicknessMapUv:zt&&g(P.thicknessMap.channel),alphaMapUv:Pt&&g(P.alphaMap.channel),vertexTangents:!!te.attributes.tangent&&(rt||he),vertexColors:P.vertexColors,vertexAlphas:P.vertexColors===!0&&!!te.attributes.color&&te.attributes.color.itemSize===4,pointsUvs:q.isPoints===!0&&!!te.attributes.uv&&(ye||Pt),fog:!!Y,useFog:P.fog===!0,fogExp2:!!Y&&Y.isFogExp2,flatShading:P.flatShading===!0,sizeAttenuation:P.sizeAttenuation===!0,logarithmicDepthBuffer:h,reverseDepthBuffer:ke,skinning:q.isSkinnedMesh===!0,morphTargets:te.morphAttributes.position!==void 0,morphNormals:te.morphAttributes.normal!==void 0,morphColors:te.morphAttributes.color!==void 0,morphTargetsCount:ce,morphTextureStride:Me,numDirLights:U.directional.length,numPointLights:U.point.length,numSpotLights:U.spot.length,numSpotLightMaps:U.spotLightMap.length,numRectAreaLights:U.rectArea.length,numHemiLights:U.hemi.length,numDirLightShadows:U.directionalShadowMap.length,numPointLightShadows:U.pointShadowMap.length,numSpotLightShadows:U.spotShadowMap.length,numSpotLightShadowsWithMaps:U.numSpotLightShadowsWithMaps,numLightProbes:U.numLightProbes,numClippingPlanes:a.numPlanes,numClipIntersection:a.numIntersection,dithering:P.dithering,shadowMapEnabled:t.shadowMap.enabled&&V.length>0,shadowMapType:t.shadowMap.type,toneMapping:at,decodeVideoTexture:ye&&P.map.isVideoTexture===!0&&Br.getTransfer(P.map.colorSpace)===Ns,decodeVideoTextureEmissive:pt&&P.emissiveMap.isVideoTexture===!0&&Br.getTransfer(P.emissiveMap.colorSpace)===Ns,premultipliedAlpha:P.premultipliedAlpha,doubleSided:P.side===Vc,flipSided:P.side===$c,useDepthPacking:P.depthPacking>=0,depthPacking:P.depthPacking||0,index0AttributeName:P.index0AttributeName,extensionClipCullDistance:Ve&&P.extensions.clipCullDistance===!0&&i.has("WEBGL_clip_cull_distance"),extensionMultiDraw:(Ve&&P.extensions.multiDraw===!0||wt)&&i.has("WEBGL_multi_draw"),rendererExtensionParallelShaderCompile:i.has("KHR_parallel_shader_compile"),customProgramCacheKey:P.customProgramCacheKey()};return Mt.vertexUv1s=l.has(1),Mt.vertexUv2s=l.has(2),Mt.vertexUv3s=l.has(3),l.clear(),Mt}function v(P){const U=[];if(P.shaderID?U.push(P.shaderID):(U.push(P.customVertexShaderID),U.push(P.customFragmentShaderID)),P.defines!==void 0)for(const V in P.defines)U.push(V),U.push(P.defines[V]);return P.isRawShaderMaterial===!1&&(b(U,P),S(U,P),U.push(t.outputColorSpace)),U.push(P.customProgramCacheKey),U.join()}function b(P,U){P.push(U.precision),P.push(U.outputColorSpace),P.push(U.envMapMode),P.push(U.envMapCubeUVHeight),P.push(U.mapUv),P.push(U.alphaMapUv),P.push(U.lightMapUv),P.push(U.aoMapUv),P.push(U.bumpMapUv),P.push(U.normalMapUv),P.push(U.displacementMapUv),P.push(U.emissiveMapUv),P.push(U.metalnessMapUv),P.push(U.roughnessMapUv),P.push(U.anisotropyMapUv),P.push(U.clearcoatMapUv),P.push(U.clearcoatNormalMapUv),P.push(U.clearcoatRoughnessMapUv),P.push(U.iridescenceMapUv),P.push(U.iridescenceThicknessMapUv),P.push(U.sheenColorMapUv),P.push(U.sheenRoughnessMapUv),P.push(U.specularMapUv),P.push(U.specularColorMapUv),P.push(U.specularIntensityMapUv),P.push(U.transmissionMapUv),P.push(U.thicknessMapUv),P.push(U.combine),P.push(U.fogExp2),P.push(U.sizeAttenuation),P.push(U.morphTargetsCount),P.push(U.morphAttributeCount),P.push(U.numDirLights),P.push(U.numPointLights),P.push(U.numSpotLights),P.push(U.numSpotLightMaps),P.push(U.numHemiLights),P.push(U.numRectAreaLights),P.push(U.numDirLightShadows),P.push(U.numPointLightShadows),P.push(U.numSpotLightShadows),P.push(U.numSpotLightShadowsWithMaps),P.push(U.numLightProbes),P.push(U.shadowMapType),P.push(U.toneMapping),P.push(U.numClippingPlanes),P.push(U.numClipIntersection),P.push(U.depthPacking)}function S(P,U){o.disableAll(),U.supportsVertexTextures&&o.enable(0),U.instancing&&o.enable(1),U.instancingColor&&o.enable(2),U.instancingMorph&&o.enable(3),U.matcap&&o.enable(4),U.envMap&&o.enable(5),U.normalMapObjectSpace&&o.enable(6),U.normalMapTangentSpace&&o.enable(7),U.clearcoat&&o.enable(8),U.iridescence&&o.enable(9),U.alphaTest&&o.enable(10),U.vertexColors&&o.enable(11),U.vertexAlphas&&o.enable(12),U.vertexUv1s&&o.enable(13),U.vertexUv2s&&o.enable(14),U.vertexUv3s&&o.enable(15),U.vertexTangents&&o.enable(16),U.anisotropy&&o.enable(17),U.alphaHash&&o.enable(18),U.batching&&o.enable(19),U.dispersion&&o.enable(20),U.batchingColor&&o.enable(21),P.push(o.mask),o.disableAll(),U.fog&&o.enable(0),U.useFog&&o.enable(1),U.flatShading&&o.enable(2),U.logarithmicDepthBuffer&&o.enable(3),U.reverseDepthBuffer&&o.enable(4),U.skinning&&o.enable(5),U.morphTargets&&o.enable(6),U.morphNormals&&o.enable(7),U.morphColors&&o.enable(8),U.premultipliedAlpha&&o.enable(9),U.shadowMapEnabled&&o.enable(10),U.doubleSided&&o.enable(11),U.flipSided&&o.enable(12),U.useDepthPacking&&o.enable(13),U.dithering&&o.enable(14),U.transmission&&o.enable(15),U.sheen&&o.enable(16),U.opaque&&o.enable(17),U.pointsUvs&&o.enable(18),U.decodeVideoTexture&&o.enable(19),U.decodeVideoTextureEmissive&&o.enable(20),U.alphaToCoverage&&o.enable(21),P.push(o.mask)}function x(P){const U=p[P.type];let V;if(U){const $=dm[U];V=Wle.clone($.uniforms)}else V=P.uniforms;return V}function M(P,U){let V;for(let $=0,q=u.length;$<q;$++){const Y=u[$];if(Y.cacheKey===U){V=Y,++V.usedTimes;break}}return V===void 0&&(V=new Wke(t,U,P,s),u.push(V)),V}function R(P){if(--P.usedTimes===0){const U=u.indexOf(P);u[U]=u[u.length-1],u.pop(),P.destroy()}}function I(P){c.remove(P)}function k(){c.dispose()}return{getParameters:_,getProgramCacheKey:v,getUniforms:x,acquireProgram:M,releaseProgram:R,releaseShaderCache:I,programs:u,dispose:k}}function Jke(){let t=new WeakMap;function e(a){return t.has(a)}function n(a){let o=t.get(a);return o===void 0&&(o={},t.set(a,o)),o}function i(a){t.delete(a)}function r(a,o,c){t.get(a)[o]=c}function s(){t=new WeakMap}return{has:e,get:n,remove:i,update:r,dispose:s}}function Qke(t,e){return t.groupOrder!==e.groupOrder?t.groupOrder-e.groupOrder:t.renderOrder!==e.renderOrder?t.renderOrder-e.renderOrder:t.material.id!==e.material.id?t.material.id-e.material.id:t.z!==e.z?t.z-e.z:t.id-e.id}function RQ(t,e){return t.groupOrder!==e.groupOrder?t.groupOrder-e.groupOrder:t.renderOrder!==e.renderOrder?t.renderOrder-e.renderOrder:t.z!==e.z?e.z-t.z:t.id-e.id}function MQ(){const t=[];let e=0;const n=[],i=[],r=[];function s(){e=0,n.length=0,i.length=0,r.length=0}function a(h,d,f,p,g,_){let v=t[e];return v===void 0?(v={id:h.id,object:h,geometry:d,material:f,groupOrder:p,renderOrder:h.renderOrder,z:g,group:_},t[e]=v):(v.id=h.id,v.object=h,v.geometry=d,v.material=f,v.groupOrder=p,v.renderOrder=h.renderOrder,v.z=g,v.group=_),e++,v}function o(h,d,f,p,g,_){const v=a(h,d,f,p,g,_);f.transmission>0?i.push(v):f.transparent===!0?r.push(v):n.push(v)}function c(h,d,f,p,g,_){const v=a(h,d,f,p,g,_);f.transmission>0?i.unshift(v):f.transparent===!0?r.unshift(v):n.unshift(v)}function l(h,d){n.length>1&&n.sort(h||Qke),i.length>1&&i.sort(d||RQ),r.length>1&&r.sort(d||RQ)}function u(){for(let h=e,d=t.length;h<d;h++){const f=t[h];if(f.id===null)break;f.id=null,f.object=null,f.geometry=null,f.material=null,f.group=null}}return{opaque:n,transmissive:i,transparent:r,init:s,push:o,unshift:c,finish:u,sort:l}}function ePe(){let t=new WeakMap;function e(i,r){const s=t.get(i);let a;return s===void 0?(a=new MQ,t.set(i,[a])):r>=s.length?(a=new MQ,s.push(a)):a=s[r],a}function n(){t=new WeakMap}return{get:e,dispose:n}}function tPe(){const t={};return{get:function(e){if(t[e.id]!==void 0)return t[e.id];let n;switch(e.type){case"DirectionalLight":n={direction:new Oe,color:new bn};break;case"SpotLight":n={position:new Oe,direction:new Oe,color:new bn,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":n={position:new Oe,color:new bn,distance:0,decay:0};break;case"HemisphereLight":n={direction:new Oe,skyColor:new bn,groundColor:new bn};break;case"RectAreaLight":n={color:new bn,position:new Oe,halfWidth:new Oe,halfHeight:new Oe};break}return t[e.id]=n,n}}}function nPe(){const t={};return{get:function(e){if(t[e.id]!==void 0)return t[e.id];let n;switch(e.type){case"DirectionalLight":n={shadowIntensity:1,shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new xt};break;case"SpotLight":n={shadowIntensity:1,shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new xt};break;case"PointLight":n={shadowIntensity:1,shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new xt,shadowCameraNear:1,shadowCameraFar:1e3};break}return t[e.id]=n,n}}}let iPe=0;function rPe(t,e){return(e.castShadow?2:0)-(t.castShadow?2:0)+(e.map?1:0)-(t.map?1:0)}function sPe(t){const e=new tPe,n=nPe(),i={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1,numSpotMaps:-1,numLightProbes:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotLightMap:[],spotShadow:[],spotShadowMap:[],spotLightMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[],numSpotLightShadowsWithMaps:0,numLightProbes:0};for(let l=0;l<9;l++)i.probe.push(new Oe);const r=new Oe,s=new gi,a=new gi;function o(l){let u=0,h=0,d=0;for(let P=0;P<9;P++)i.probe[P].set(0,0,0);let f=0,p=0,g=0,_=0,v=0,b=0,S=0,x=0,M=0,R=0,I=0;l.sort(rPe);for(let P=0,U=l.length;P<U;P++){const V=l[P],$=V.color,q=V.intensity,Y=V.distance,te=V.shadow&&V.shadow.map?V.shadow.map.texture:null;if(V.isAmbientLight)u+=$.r*q,h+=$.g*q,d+=$.b*q;else if(V.isLightProbe){for(let G=0;G<9;G++)i.probe[G].addScaledVector(V.sh.coefficients[G],q);I++}else if(V.isDirectionalLight){const G=e.get(V);if(G.color.copy(V.color).multiplyScalar(V.intensity),V.castShadow){const J=V.shadow,K=n.get(V);K.shadowIntensity=J.intensity,K.shadowBias=J.bias,K.shadowNormalBias=J.normalBias,K.shadowRadius=J.radius,K.shadowMapSize=J.mapSize,i.directionalShadow[f]=K,i.directionalShadowMap[f]=te,i.directionalShadowMatrix[f]=V.shadow.matrix,b++}i.directional[f]=G,f++}else if(V.isSpotLight){const G=e.get(V);G.position.setFromMatrixPosition(V.matrixWorld),G.color.copy($).multiplyScalar(q),G.distance=Y,G.coneCos=Math.cos(V.angle),G.penumbraCos=Math.cos(V.angle*(1-V.penumbra)),G.decay=V.decay,i.spot[g]=G;const J=V.shadow;if(V.map&&(i.spotLightMap[M]=V.map,M++,J.updateMatrices(V),V.castShadow&&R++),i.spotLightMatrix[g]=J.matrix,V.castShadow){const K=n.get(V);K.shadowIntensity=J.intensity,K.shadowBias=J.bias,K.shadowNormalBias=J.normalBias,K.shadowRadius=J.radius,K.shadowMapSize=J.mapSize,i.spotShadow[g]=K,i.spotShadowMap[g]=te,x++}g++}else if(V.isRectAreaLight){const G=e.get(V);G.color.copy($).multiplyScalar(q),G.halfWidth.set(V.width*.5,0,0),G.halfHeight.set(0,V.height*.5,0),i.rectArea[_]=G,_++}else if(V.isPointLight){const G=e.get(V);if(G.color.copy(V.color).multiplyScalar(V.intensity),G.distance=V.distance,G.decay=V.decay,V.castShadow){const J=V.shadow,K=n.get(V);K.shadowIntensity=J.intensity,K.shadowBias=J.bias,K.shadowNormalBias=J.normalBias,K.shadowRadius=J.radius,K.shadowMapSize=J.mapSize,K.shadowCameraNear=J.camera.near,K.shadowCameraFar=J.camera.far,i.pointShadow[p]=K,i.pointShadowMap[p]=te,i.pointShadowMatrix[p]=V.shadow.matrix,S++}i.point[p]=G,p++}else if(V.isHemisphereLight){const G=e.get(V);G.skyColor.copy(V.color).multiplyScalar(q),G.groundColor.copy(V.groundColor).multiplyScalar(q),i.hemi[v]=G,v++}}_>0&&(t.has("OES_texture_float_linear")===!0?(i.rectAreaLTC1=En.LTC_FLOAT_1,i.rectAreaLTC2=En.LTC_FLOAT_2):(i.rectAreaLTC1=En.LTC_HALF_1,i.rectAreaLTC2=En.LTC_HALF_2)),i.ambient[0]=u,i.ambient[1]=h,i.ambient[2]=d;const k=i.hash;(k.directionalLength!==f||k.pointLength!==p||k.spotLength!==g||k.rectAreaLength!==_||k.hemiLength!==v||k.numDirectionalShadows!==b||k.numPointShadows!==S||k.numSpotShadows!==x||k.numSpotMaps!==M||k.numLightProbes!==I)&&(i.directional.length=f,i.spot.length=g,i.rectArea.length=_,i.point.length=p,i.hemi.length=v,i.directionalShadow.length=b,i.directionalShadowMap.length=b,i.pointShadow.length=S,i.pointShadowMap.length=S,i.spotShadow.length=x,i.spotShadowMap.length=x,i.directionalShadowMatrix.length=b,i.pointShadowMatrix.length=S,i.spotLightMatrix.length=x+M-R,i.spotLightMap.length=M,i.numSpotLightShadowsWithMaps=R,i.numLightProbes=I,k.directionalLength=f,k.pointLength=p,k.spotLength=g,k.rectAreaLength=_,k.hemiLength=v,k.numDirectionalShadows=b,k.numPointShadows=S,k.numSpotShadows=x,k.numSpotMaps=M,k.numLightProbes=I,i.version=iPe++)}function c(l,u){let h=0,d=0,f=0,p=0,g=0;const _=u.matrixWorldInverse;for(let v=0,b=l.length;v<b;v++){const S=l[v];if(S.isDirectionalLight){const x=i.directional[h];x.direction.setFromMatrixPosition(S.matrixWorld),r.setFromMatrixPosition(S.target.matrixWorld),x.direction.sub(r),x.direction.transformDirection(_),h++}else if(S.isSpotLight){const x=i.spot[f];x.position.setFromMatrixPosition(S.matrixWorld),x.position.applyMatrix4(_),x.direction.setFromMatrixPosition(S.matrixWorld),r.setFromMatrixPosition(S.target.matrixWorld),x.direction.sub(r),x.direction.transformDirection(_),f++}else if(S.isRectAreaLight){const x=i.rectArea[p];x.position.setFromMatrixPosition(S.matrixWorld),x.position.applyMatrix4(_),a.identity(),s.copy(S.matrixWorld),s.premultiply(_),a.extractRotation(s),x.halfWidth.set(S.width*.5,0,0),x.halfHeight.set(0,S.height*.5,0),x.halfWidth.applyMatrix4(a),x.halfHeight.applyMatrix4(a),p++}else if(S.isPointLight){const x=i.point[d];x.position.setFromMatrixPosition(S.matrixWorld),x.position.applyMatrix4(_),d++}else if(S.isHemisphereLight){const x=i.hemi[g];x.direction.setFromMatrixPosition(S.matrixWorld),x.direction.transformDirection(_),g++}}}return{setup:o,setupView:c,state:i}}function OQ(t){const e=new sPe(t),n=[],i=[];function r(u){l.camera=u,n.length=0,i.length=0}function s(u){n.push(u)}function a(u){i.push(u)}function o(){e.setup(n)}function c(u){e.setupView(n,u)}const l={lightsArray:n,shadowsArray:i,camera:null,lights:e,transmissionRenderTarget:{}};return{init:r,state:l,setupLights:o,setupLightsView:c,pushLight:s,pushShadow:a}}function aPe(t){let e=new WeakMap;function n(r,s=0){const a=e.get(r);let o;return a===void 0?(o=new OQ(t),e.set(r,[o])):s>=a.length?(o=new OQ(t),a.push(o)):o=a[s],o}function i(){e=new WeakMap}return{get:n,dispose:i}}const oPe=`void main() {
	gl_Position = vec4( position, 1.0 );
}`,cPe=`uniform sampler2D shadow_pass;
uniform vec2 resolution;
uniform float radius;
#include <packing>
void main() {
	const float samples = float( VSM_SAMPLES );
	float mean = 0.0;
	float squared_mean = 0.0;
	float uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );
	float uvStart = samples <= 1.0 ? 0.0 : - 1.0;
	for ( float i = 0.0; i < samples; i ++ ) {
		float uvOffset = uvStart + i * uvStride;
		#ifdef HORIZONTAL_PASS
			vec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ) );
			mean += distribution.x;
			squared_mean += distribution.y * distribution.y + distribution.x * distribution.x;
		#else
			float depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ) );
			mean += depth;
			squared_mean += depth * depth;
		#endif
	}
	mean = mean / samples;
	squared_mean = squared_mean / samples;
	float std_dev = sqrt( squared_mean - mean * mean );
	gl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );
}`;function lPe(t,e,n){let i=new ZA;const r=new xt,s=new xt,a=new zr,o=new hW({depthPacking:Ile}),c=new dW,l={},u=n.maxTextureSize,h={[r0]:$c,[$c]:r0,[Vc]:Vc},d=new qa({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new xt},radius:{value:4}},vertexShader:oPe,fragmentShader:cPe}),f=d.clone();f.defines.HORIZONTAL_PASS=1;const p=new tr;p.setAttribute("position",new ar(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));const g=new Io(p,d),_=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=XB;let v=this.type;this.render=function(R,I,k){if(_.enabled===!1||_.autoUpdate===!1&&_.needsUpdate===!1||R.length===0)return;const P=t.getRenderTarget(),U=t.getActiveCubeFace(),V=t.getActiveMipmapLevel(),$=t.state;$.setBlending(Eu),$.buffers.color.setClear(1,1,1,1),$.buffers.depth.setTest(!0),$.setScissorTest(!1);const q=v!==lm&&this.type===lm,Y=v===lm&&this.type!==lm;for(let te=0,G=R.length;te<G;te++){const J=R[te],K=J.shadow;if(K===void 0){console.warn("THREE.WebGLShadowMap:",J,"has no shadow.");continue}if(K.autoUpdate===!1&&K.needsUpdate===!1)continue;r.copy(K.mapSize);const X=K.getFrameExtents();if(r.multiply(X),s.copy(K.mapSize),(r.x>u||r.y>u)&&(r.x>u&&(s.x=Math.floor(u/X.x),r.x=s.x*X.x,K.mapSize.x=s.x),r.y>u&&(s.y=Math.floor(u/X.y),r.y=s.y*X.y,K.mapSize.y=s.y)),K.map===null||q===!0||Y===!0){const ce=this.type!==lm?{minFilter:Va,magFilter:Va}:{};K.map!==null&&K.map.dispose(),K.map=new Ko(r.x,r.y,ce),K.map.texture.name=J.name+".shadowMap",K.camera.updateProjectionMatrix()}t.setRenderTarget(K.map),t.clear();const ae=K.getViewportCount();for(let ce=0;ce<ae;ce++){const Me=K.getViewport(ce);a.set(s.x*Me.x,s.y*Me.y,s.x*Me.z,s.y*Me.w),$.viewport(a),K.updateMatrices(J,ce),i=K.getFrustum(),x(I,k,K.camera,J,this.type)}K.isPointLightShadow!==!0&&this.type===lm&&b(K,k),K.needsUpdate=!1}v=this.type,_.needsUpdate=!1,t.setRenderTarget(P,U,V)};function b(R,I){const k=e.update(g);d.defines.VSM_SAMPLES!==R.blurSamples&&(d.defines.VSM_SAMPLES=R.blurSamples,f.defines.VSM_SAMPLES=R.blurSamples,d.needsUpdate=!0,f.needsUpdate=!0),R.mapPass===null&&(R.mapPass=new Ko(r.x,r.y)),d.uniforms.shadow_pass.value=R.map.texture,d.uniforms.resolution.value=R.mapSize,d.uniforms.radius.value=R.radius,t.setRenderTarget(R.mapPass),t.clear(),t.renderBufferDirect(I,null,k,d,g,null),f.uniforms.shadow_pass.value=R.mapPass.texture,f.uniforms.resolution.value=R.mapSize,f.uniforms.radius.value=R.radius,t.setRenderTarget(R.map),t.clear(),t.renderBufferDirect(I,null,k,f,g,null)}function S(R,I,k,P){let U=null;const V=k.isPointLight===!0?R.customDistanceMaterial:R.customDepthMaterial;if(V!==void 0)U=V;else if(U=k.isPointLight===!0?c:o,t.localClippingEnabled&&I.clipShadows===!0&&Array.isArray(I.clippingPlanes)&&I.clippingPlanes.length!==0||I.displacementMap&&I.displacementScale!==0||I.alphaMap&&I.alphaTest>0||I.map&&I.alphaTest>0||I.alphaToCoverage===!0){const $=U.uuid,q=I.uuid;let Y=l[$];Y===void 0&&(Y={},l[$]=Y);let te=Y[q];te===void 0&&(te=U.clone(),Y[q]=te,I.addEventListener("dispose",M)),U=te}if(U.visible=I.visible,U.wireframe=I.wireframe,P===lm?U.side=I.shadowSide!==null?I.shadowSide:I.side:U.side=I.shadowSide!==null?I.shadowSide:h[I.side],U.alphaMap=I.alphaMap,U.alphaTest=I.alphaToCoverage===!0?.5:I.alphaTest,U.map=I.map,U.clipShadows=I.clipShadows,U.clippingPlanes=I.clippingPlanes,U.clipIntersection=I.clipIntersection,U.displacementMap=I.displacementMap,U.displacementScale=I.displacementScale,U.displacementBias=I.displacementBias,U.wireframeLinewidth=I.wireframeLinewidth,U.linewidth=I.linewidth,k.isPointLight===!0&&U.isMeshDistanceMaterial===!0){const $=t.properties.get(U);$.light=k}return U}function x(R,I,k,P,U){if(R.visible===!1)return;if(R.layers.test(I.layers)&&(R.isMesh||R.isLine||R.isPoints)&&(R.castShadow||R.receiveShadow&&U===lm)&&(!R.frustumCulled||i.intersectsObject(R))){R.modelViewMatrix.multiplyMatrices(k.matrixWorldInverse,R.matrixWorld);const q=e.update(R),Y=R.material;if(Array.isArray(Y)){const te=q.groups;for(let G=0,J=te.length;G<J;G++){const K=te[G],X=Y[K.materialIndex];if(X&&X.visible){const ae=S(R,X,P,U);R.onBeforeShadow(t,R,I,k,q,ae,K),t.renderBufferDirect(k,null,q,ae,R,K),R.onAfterShadow(t,R,I,k,q,ae,K)}}}else if(Y.visible){const te=S(R,Y,P,U);R.onBeforeShadow(t,R,I,k,q,te,null),t.renderBufferDirect(k,null,q,te,R,null),R.onAfterShadow(t,R,I,k,q,te,null)}}const $=R.children;for(let q=0,Y=$.length;q<Y;q++)x($[q],I,k,P,U)}function M(R){R.target.removeEventListener("dispose",M);for(const k in l){const P=l[k],U=R.target.uuid;U in P&&(P[U].dispose(),delete P[U])}}}const uPe={[YL]:KL,[XL]:QL,[ZL]:eU,[YT]:JL,[KL]:YL,[QL]:XL,[eU]:ZL,[JL]:YT};function hPe(t,e){function n(){let je=!1;const zt=new zr;let ht=null;const Pt=new zr(0,0,0,0);return{setMask:function(hn){ht!==hn&&!je&&(t.colorMask(hn,hn,hn,hn),ht=hn)},setLocked:function(hn){je=hn},setClear:function(hn,on,Ve,at,Mt){Mt===!0&&(hn*=at,on*=at,Ve*=at),zt.set(hn,on,Ve,at),Pt.equals(zt)===!1&&(t.clearColor(hn,on,Ve,at),Pt.copy(zt))},reset:function(){je=!1,ht=null,Pt.set(-1,0,0,0)}}}function i(){let je=!1,zt=!1,ht=null,Pt=null,hn=null;return{setReversed:function(on){if(zt!==on){const Ve=e.get("EXT_clip_control");on?Ve.clipControlEXT(Ve.LOWER_LEFT_EXT,Ve.ZERO_TO_ONE_EXT):Ve.clipControlEXT(Ve.LOWER_LEFT_EXT,Ve.NEGATIVE_ONE_TO_ONE_EXT),zt=on;const at=hn;hn=null,this.setClear(at)}},getReversed:function(){return zt},setTest:function(on){on?_e(t.DEPTH_TEST):ke(t.DEPTH_TEST)},setMask:function(on){ht!==on&&!je&&(t.depthMask(on),ht=on)},setFunc:function(on){if(zt&&(on=uPe[on]),Pt!==on){switch(on){case YL:t.depthFunc(t.NEVER);break;case KL:t.depthFunc(t.ALWAYS);break;case XL:t.depthFunc(t.LESS);break;case YT:t.depthFunc(t.LEQUAL);break;case ZL:t.depthFunc(t.EQUAL);break;case JL:t.depthFunc(t.GEQUAL);break;case QL:t.depthFunc(t.GREATER);break;case eU:t.depthFunc(t.NOTEQUAL);break;default:t.depthFunc(t.LEQUAL)}Pt=on}},setLocked:function(on){je=on},setClear:function(on){hn!==on&&(zt&&(on=1-on),t.clearDepth(on),hn=on)},reset:function(){je=!1,ht=null,Pt=null,hn=null,zt=!1}}}function r(){let je=!1,zt=null,ht=null,Pt=null,hn=null,on=null,Ve=null,at=null,Mt=null;return{setTest:function(Ot){je||(Ot?_e(t.STENCIL_TEST):ke(t.STENCIL_TEST))},setMask:function(Ot){zt!==Ot&&!je&&(t.stencilMask(Ot),zt=Ot)},setFunc:function(Ot,Zn,or){(ht!==Ot||Pt!==Zn||hn!==or)&&(t.stencilFunc(Ot,Zn,or),ht=Ot,Pt=Zn,hn=or)},setOp:function(Ot,Zn,or){(on!==Ot||Ve!==Zn||at!==or)&&(t.stencilOp(Ot,Zn,or),on=Ot,Ve=Zn,at=or)},setLocked:function(Ot){je=Ot},setClear:function(Ot){Mt!==Ot&&(t.clearStencil(Ot),Mt=Ot)},reset:function(){je=!1,zt=null,ht=null,Pt=null,hn=null,on=null,Ve=null,at=null,Mt=null}}}const s=new n,a=new i,o=new r,c=new WeakMap,l=new WeakMap;let u={},h={},d=new WeakMap,f=[],p=null,g=!1,_=null,v=null,b=null,S=null,x=null,M=null,R=null,I=new bn(0,0,0),k=0,P=!1,U=null,V=null,$=null,q=null,Y=null;const te=t.getParameter(t.MAX_COMBINED_TEXTURE_IMAGE_UNITS);let G=!1,J=0;const K=t.getParameter(t.VERSION);K.indexOf("WebGL")!==-1?(J=parseFloat(/^WebGL (\d)/.exec(K)[1]),G=J>=1):K.indexOf("OpenGL ES")!==-1&&(J=parseFloat(/^OpenGL ES (\d)/.exec(K)[1]),G=J>=2);let X=null,ae={};const ce=t.getParameter(t.SCISSOR_BOX),Me=t.getParameter(t.VIEWPORT),Fe=new zr().fromArray(ce),Te=new zr().fromArray(Me);function Re(je,zt,ht,Pt){const hn=new Uint8Array(4),on=t.createTexture();t.bindTexture(je,on),t.texParameteri(je,t.TEXTURE_MIN_FILTER,t.NEAREST),t.texParameteri(je,t.TEXTURE_MAG_FILTER,t.NEAREST);for(let Ve=0;Ve<ht;Ve++)je===t.TEXTURE_3D||je===t.TEXTURE_2D_ARRAY?t.texImage3D(zt,0,t.RGBA,1,1,Pt,0,t.RGBA,t.UNSIGNED_BYTE,hn):t.texImage2D(zt+Ve,0,t.RGBA,1,1,0,t.RGBA,t.UNSIGNED_BYTE,hn);return on}const ge={};ge[t.TEXTURE_2D]=Re(t.TEXTURE_2D,t.TEXTURE_2D,1),ge[t.TEXTURE_CUBE_MAP]=Re(t.TEXTURE_CUBE_MAP,t.TEXTURE_CUBE_MAP_POSITIVE_X,6),ge[t.TEXTURE_2D_ARRAY]=Re(t.TEXTURE_2D_ARRAY,t.TEXTURE_2D_ARRAY,1,1),ge[t.TEXTURE_3D]=Re(t.TEXTURE_3D,t.TEXTURE_3D,1,1),s.setClear(0,0,0,1),a.setClear(1),o.setClear(0),_e(t.DEPTH_TEST),a.setFunc(YT),Le(!1),rt($V),_e(t.CULL_FACE),pe(Eu);function _e(je){u[je]!==!0&&(t.enable(je),u[je]=!0)}function ke(je){u[je]!==!1&&(t.disable(je),u[je]=!1)}function gt(je,zt){return h[je]!==zt?(t.bindFramebuffer(je,zt),h[je]=zt,je===t.DRAW_FRAMEBUFFER&&(h[t.FRAMEBUFFER]=zt),je===t.FRAMEBUFFER&&(h[t.DRAW_FRAMEBUFFER]=zt),!0):!1}function wt(je,zt){let ht=f,Pt=!1;if(je){ht=d.get(zt),ht===void 0&&(ht=[],d.set(zt,ht));const hn=je.textures;if(ht.length!==hn.length||ht[0]!==t.COLOR_ATTACHMENT0){for(let on=0,Ve=hn.length;on<Ve;on++)ht[on]=t.COLOR_ATTACHMENT0+on;ht.length=hn.length,Pt=!0}}else ht[0]!==t.BACK&&(ht[0]=t.BACK,Pt=!0);Pt&&t.drawBuffers(ht)}function ye(je){return p!==je?(t.useProgram(je),p=je,!0):!1}const Se={[db]:t.FUNC_ADD,[ile]:t.FUNC_SUBTRACT,[rle]:t.FUNC_REVERSE_SUBTRACT};Se[sle]=t.MIN,Se[ale]=t.MAX;const Qe={[ole]:t.ZERO,[cle]:t.ONE,[lle]:t.SRC_COLOR,[$L]:t.SRC_ALPHA,[mle]:t.SRC_ALPHA_SATURATE,[fle]:t.DST_COLOR,[hle]:t.DST_ALPHA,[ule]:t.ONE_MINUS_SRC_COLOR,[WL]:t.ONE_MINUS_SRC_ALPHA,[ple]:t.ONE_MINUS_DST_COLOR,[dle]:t.ONE_MINUS_DST_ALPHA,[gle]:t.CONSTANT_COLOR,[vle]:t.ONE_MINUS_CONSTANT_COLOR,[_le]:t.CONSTANT_ALPHA,[yle]:t.ONE_MINUS_CONSTANT_ALPHA};function pe(je,zt,ht,Pt,hn,on,Ve,at,Mt,Ot){if(je===Eu){g===!0&&(ke(t.BLEND),g=!1);return}if(g===!1&&(_e(t.BLEND),g=!0),je!==nle){if(je!==_||Ot!==P){if((v!==db||x!==db)&&(t.blendEquation(t.FUNC_ADD),v=db,x=db),Ot)switch(je){case AT:t.blendFuncSeparate(t.ONE,t.ONE_MINUS_SRC_ALPHA,t.ONE,t.ONE_MINUS_SRC_ALPHA);break;case WV:t.blendFunc(t.ONE,t.ONE);break;case YV:t.blendFuncSeparate(t.ZERO,t.ONE_MINUS_SRC_COLOR,t.ZERO,t.ONE);break;case KV:t.blendFuncSeparate(t.ZERO,t.SRC_COLOR,t.ZERO,t.SRC_ALPHA);break;default:console.error("THREE.WebGLState: Invalid blending: ",je);break}else switch(je){case AT:t.blendFuncSeparate(t.SRC_ALPHA,t.ONE_MINUS_SRC_ALPHA,t.ONE,t.ONE_MINUS_SRC_ALPHA);break;case WV:t.blendFunc(t.SRC_ALPHA,t.ONE);break;case YV:t.blendFuncSeparate(t.ZERO,t.ONE_MINUS_SRC_COLOR,t.ZERO,t.ONE);break;case KV:t.blendFunc(t.ZERO,t.SRC_COLOR);break;default:console.error("THREE.WebGLState: Invalid blending: ",je);break}b=null,S=null,M=null,R=null,I.set(0,0,0),k=0,_=je,P=Ot}return}hn=hn||zt,on=on||ht,Ve=Ve||Pt,(zt!==v||hn!==x)&&(t.blendEquationSeparate(Se[zt],Se[hn]),v=zt,x=hn),(ht!==b||Pt!==S||on!==M||Ve!==R)&&(t.blendFuncSeparate(Qe[ht],Qe[Pt],Qe[on],Qe[Ve]),b=ht,S=Pt,M=on,R=Ve),(at.equals(I)===!1||Mt!==k)&&(t.blendColor(at.r,at.g,at.b,Mt),I.copy(at),k=Mt),_=je,P=!1}function ze(je,zt){je.side===Vc?ke(t.CULL_FACE):_e(t.CULL_FACE);let ht=je.side===$c;zt&&(ht=!ht),Le(ht),je.blending===AT&&je.transparent===!1?pe(Eu):pe(je.blending,je.blendEquation,je.blendSrc,je.blendDst,je.blendEquationAlpha,je.blendSrcAlpha,je.blendDstAlpha,je.blendColor,je.blendAlpha,je.premultipliedAlpha),a.setFunc(je.depthFunc),a.setTest(je.depthTest),a.setMask(je.depthWrite),s.setMask(je.colorWrite);const Pt=je.stencilWrite;o.setTest(Pt),Pt&&(o.setMask(je.stencilWriteMask),o.setFunc(je.stencilFunc,je.stencilRef,je.stencilFuncMask),o.setOp(je.stencilFail,je.stencilZFail,je.stencilZPass)),pt(je.polygonOffset,je.polygonOffsetFactor,je.polygonOffsetUnits),je.alphaToCoverage===!0?_e(t.SAMPLE_ALPHA_TO_COVERAGE):ke(t.SAMPLE_ALPHA_TO_COVERAGE)}function Le(je){U!==je&&(je?t.frontFace(t.CW):t.frontFace(t.CCW),U=je)}function rt(je){je!==Qce?(_e(t.CULL_FACE),je!==V&&(je===$V?t.cullFace(t.BACK):je===ele?t.cullFace(t.FRONT):t.cullFace(t.FRONT_AND_BACK))):ke(t.CULL_FACE),V=je}function dt(je){je!==$&&(G&&t.lineWidth(je),$=je)}function pt(je,zt,ht){je?(_e(t.POLYGON_OFFSET_FILL),(q!==zt||Y!==ht)&&(t.polygonOffset(zt,ht),q=zt,Y=ht)):ke(t.POLYGON_OFFSET_FILL)}function bt(je){je?_e(t.SCISSOR_TEST):ke(t.SCISSOR_TEST)}function we(je){je===void 0&&(je=t.TEXTURE0+te-1),X!==je&&(t.activeTexture(je),X=je)}function he(je,zt,ht){ht===void 0&&(X===null?ht=t.TEXTURE0+te-1:ht=X);let Pt=ae[ht];Pt===void 0&&(Pt={type:void 0,texture:void 0},ae[ht]=Pt),(Pt.type!==je||Pt.texture!==zt)&&(X!==ht&&(t.activeTexture(ht),X=ht),t.bindTexture(je,zt||ge[je]),Pt.type=je,Pt.texture=zt)}function $e(){const je=ae[X];je!==void 0&&je.type!==void 0&&(t.bindTexture(je.type,null),je.type=void 0,je.texture=void 0)}function et(){try{t.compressedTexImage2D(...arguments)}catch(je){console.error("THREE.WebGLState:",je)}}function Et(){try{t.compressedTexImage3D(...arguments)}catch(je){console.error("THREE.WebGLState:",je)}}function ct(){try{t.texSubImage2D(...arguments)}catch(je){console.error("THREE.WebGLState:",je)}}function tn(){try{t.texSubImage3D(...arguments)}catch(je){console.error("THREE.WebGLState:",je)}}function Ht(){try{t.compressedTexSubImage2D(...arguments)}catch(je){console.error("THREE.WebGLState:",je)}}function pn(){try{t.compressedTexSubImage3D(...arguments)}catch(je){console.error("THREE.WebGLState:",je)}}function le(){try{t.texStorage2D(...arguments)}catch(je){console.error("THREE.WebGLState:",je)}}function z(){try{t.texStorage3D(...arguments)}catch(je){console.error("THREE.WebGLState:",je)}}function W(){try{t.texImage2D(...arguments)}catch(je){console.error("THREE.WebGLState:",je)}}function fe(){try{t.texImage3D(...arguments)}catch(je){console.error("THREE.WebGLState:",je)}}function Ne(je){Fe.equals(je)===!1&&(t.scissor(je.x,je.y,je.z,je.w),Fe.copy(je))}function Be(je){Te.equals(je)===!1&&(t.viewport(je.x,je.y,je.z,je.w),Te.copy(je))}function tt(je,zt){let ht=l.get(zt);ht===void 0&&(ht=new WeakMap,l.set(zt,ht));let Pt=ht.get(je);Pt===void 0&&(Pt=t.getUniformBlockIndex(zt,je.name),ht.set(je,Pt))}function Tt(je,zt){const Pt=l.get(zt).get(je);c.get(zt)!==Pt&&(t.uniformBlockBinding(zt,Pt,je.__bindingPointIndex),c.set(zt,Pt))}function Cn(){t.disable(t.BLEND),t.disable(t.CULL_FACE),t.disable(t.DEPTH_TEST),t.disable(t.POLYGON_OFFSET_FILL),t.disable(t.SCISSOR_TEST),t.disable(t.STENCIL_TEST),t.disable(t.SAMPLE_ALPHA_TO_COVERAGE),t.blendEquation(t.FUNC_ADD),t.blendFunc(t.ONE,t.ZERO),t.blendFuncSeparate(t.ONE,t.ZERO,t.ONE,t.ZERO),t.blendColor(0,0,0,0),t.colorMask(!0,!0,!0,!0),t.clearColor(0,0,0,0),t.depthMask(!0),t.depthFunc(t.LESS),a.setReversed(!1),t.clearDepth(1),t.stencilMask(4294967295),t.stencilFunc(t.ALWAYS,0,4294967295),t.stencilOp(t.KEEP,t.KEEP,t.KEEP),t.clearStencil(0),t.cullFace(t.BACK),t.frontFace(t.CCW),t.polygonOffset(0,0),t.activeTexture(t.TEXTURE0),t.bindFramebuffer(t.FRAMEBUFFER,null),t.bindFramebuffer(t.DRAW_FRAMEBUFFER,null),t.bindFramebuffer(t.READ_FRAMEBUFFER,null),t.useProgram(null),t.lineWidth(1),t.scissor(0,0,t.canvas.width,t.canvas.height),t.viewport(0,0,t.canvas.width,t.canvas.height),u={},X=null,ae={},h={},d=new WeakMap,f=[],p=null,g=!1,_=null,v=null,b=null,S=null,x=null,M=null,R=null,I=new bn(0,0,0),k=0,P=!1,U=null,V=null,$=null,q=null,Y=null,Fe.set(0,0,t.canvas.width,t.canvas.height),Te.set(0,0,t.canvas.width,t.canvas.height),s.reset(),a.reset(),o.reset()}return{buffers:{color:s,depth:a,stencil:o},enable:_e,disable:ke,bindFramebuffer:gt,drawBuffers:wt,useProgram:ye,setBlending:pe,setMaterial:ze,setFlipSided:Le,setCullFace:rt,setLineWidth:dt,setPolygonOffset:pt,setScissorTest:bt,activeTexture:we,bindTexture:he,unbindTexture:$e,compressedTexImage2D:et,compressedTexImage3D:Et,texImage2D:W,texImage3D:fe,updateUBOMapping:tt,uniformBlockBinding:Tt,texStorage2D:le,texStorage3D:z,texSubImage2D:ct,texSubImage3D:tn,compressedTexSubImage2D:Ht,compressedTexSubImage3D:pn,scissor:Ne,viewport:Be,reset:Cn}}function dPe(t,e,n,i,r,s,a){const o=e.has("WEBGL_multisampled_render_to_texture")?e.get("WEBGL_multisampled_render_to_texture"):null,c=typeof navigator>"u"?!1:/OculusBrowser/g.test(navigator.userAgent),l=new xt,u=new WeakMap;let h;const d=new WeakMap;let f=!1;try{f=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")!==null}catch{}function p(we,he){return f?new OffscreenCanvas(we,he):ZO("canvas")}function g(we,he,$e){let et=1;const Et=bt(we);if((Et.width>$e||Et.height>$e)&&(et=$e/Math.max(Et.width,Et.height)),et<1)if(typeof HTMLImageElement<"u"&&we instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&we instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&we instanceof ImageBitmap||typeof VideoFrame<"u"&&we instanceof VideoFrame){const ct=Math.floor(et*Et.width),tn=Math.floor(et*Et.height);h===void 0&&(h=p(ct,tn));const Ht=he?p(ct,tn):h;return Ht.width=ct,Ht.height=tn,Ht.getContext("2d").drawImage(we,0,0,ct,tn),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+Et.width+"x"+Et.height+") to ("+ct+"x"+tn+")."),Ht}else return"data"in we&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+Et.width+"x"+Et.height+")."),we;return we}function _(we){return we.generateMipmaps}function v(we){t.generateMipmap(we)}function b(we){return we.isWebGLCubeRenderTarget?t.TEXTURE_CUBE_MAP:we.isWebGL3DRenderTarget?t.TEXTURE_3D:we.isWebGLArrayRenderTarget||we.isCompressedArrayTexture?t.TEXTURE_2D_ARRAY:t.TEXTURE_2D}function S(we,he,$e,et,Et=!1){if(we!==null){if(t[we]!==void 0)return t[we];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+we+"'")}let ct=he;if(he===t.RED&&($e===t.FLOAT&&(ct=t.R32F),$e===t.HALF_FLOAT&&(ct=t.R16F),$e===t.UNSIGNED_BYTE&&(ct=t.R8)),he===t.RED_INTEGER&&($e===t.UNSIGNED_BYTE&&(ct=t.R8UI),$e===t.UNSIGNED_SHORT&&(ct=t.R16UI),$e===t.UNSIGNED_INT&&(ct=t.R32UI),$e===t.BYTE&&(ct=t.R8I),$e===t.SHORT&&(ct=t.R16I),$e===t.INT&&(ct=t.R32I)),he===t.RG&&($e===t.FLOAT&&(ct=t.RG32F),$e===t.HALF_FLOAT&&(ct=t.RG16F),$e===t.UNSIGNED_BYTE&&(ct=t.RG8)),he===t.RG_INTEGER&&($e===t.UNSIGNED_BYTE&&(ct=t.RG8UI),$e===t.UNSIGNED_SHORT&&(ct=t.RG16UI),$e===t.UNSIGNED_INT&&(ct=t.RG32UI),$e===t.BYTE&&(ct=t.RG8I),$e===t.SHORT&&(ct=t.RG16I),$e===t.INT&&(ct=t.RG32I)),he===t.RGB_INTEGER&&($e===t.UNSIGNED_BYTE&&(ct=t.RGB8UI),$e===t.UNSIGNED_SHORT&&(ct=t.RGB16UI),$e===t.UNSIGNED_INT&&(ct=t.RGB32UI),$e===t.BYTE&&(ct=t.RGB8I),$e===t.SHORT&&(ct=t.RGB16I),$e===t.INT&&(ct=t.RGB32I)),he===t.RGBA_INTEGER&&($e===t.UNSIGNED_BYTE&&(ct=t.RGBA8UI),$e===t.UNSIGNED_SHORT&&(ct=t.RGBA16UI),$e===t.UNSIGNED_INT&&(ct=t.RGBA32UI),$e===t.BYTE&&(ct=t.RGBA8I),$e===t.SHORT&&(ct=t.RGBA16I),$e===t.INT&&(ct=t.RGBA32I)),he===t.RGB&&$e===t.UNSIGNED_INT_5_9_9_9_REV&&(ct=t.RGB9_E5),he===t.RGBA){const tn=Et?YO:Br.getTransfer(et);$e===t.FLOAT&&(ct=t.RGBA32F),$e===t.HALF_FLOAT&&(ct=t.RGBA16F),$e===t.UNSIGNED_BYTE&&(ct=tn===Ns?t.SRGB8_ALPHA8:t.RGBA8),$e===t.UNSIGNED_SHORT_4_4_4_4&&(ct=t.RGBA4),$e===t.UNSIGNED_SHORT_5_5_5_1&&(ct=t.RGB5_A1)}return(ct===t.R16F||ct===t.R32F||ct===t.RG16F||ct===t.RG32F||ct===t.RGBA16F||ct===t.RGBA32F)&&e.get("EXT_color_buffer_float"),ct}function x(we,he){let $e;return we?he===null||he===s0||he===KT?$e=t.DEPTH24_STENCIL8:he===vu?$e=t.DEPTH32F_STENCIL8:he===BC&&($e=t.DEPTH24_STENCIL8,console.warn("DepthTexture: 16 bit depth attachment is not supported with stencil. Using 24-bit attachment.")):he===null||he===s0||he===KT?$e=t.DEPTH_COMPONENT24:he===vu?$e=t.DEPTH_COMPONENT32F:he===BC&&($e=t.DEPTH_COMPONENT16),$e}function M(we,he){return _(we)===!0||we.isFramebufferTexture&&we.minFilter!==Va&&we.minFilter!==Ca?Math.log2(Math.max(he.width,he.height))+1:we.mipmaps!==void 0&&we.mipmaps.length>0?we.mipmaps.length:we.isCompressedTexture&&Array.isArray(we.image)?he.mipmaps.length:1}function R(we){const he=we.target;he.removeEventListener("dispose",R),k(he),he.isVideoTexture&&u.delete(he)}function I(we){const he=we.target;he.removeEventListener("dispose",I),U(he)}function k(we){const he=i.get(we);if(he.__webglInit===void 0)return;const $e=we.source,et=d.get($e);if(et){const Et=et[he.__cacheKey];Et.usedTimes--,Et.usedTimes===0&&P(we),Object.keys(et).length===0&&d.delete($e)}i.remove(we)}function P(we){const he=i.get(we);t.deleteTexture(he.__webglTexture);const $e=we.source,et=d.get($e);delete et[he.__cacheKey],a.memory.textures--}function U(we){const he=i.get(we);if(we.depthTexture&&(we.depthTexture.dispose(),i.remove(we.depthTexture)),we.isWebGLCubeRenderTarget)for(let et=0;et<6;et++){if(Array.isArray(he.__webglFramebuffer[et]))for(let Et=0;Et<he.__webglFramebuffer[et].length;Et++)t.deleteFramebuffer(he.__webglFramebuffer[et][Et]);else t.deleteFramebuffer(he.__webglFramebuffer[et]);he.__webglDepthbuffer&&t.deleteRenderbuffer(he.__webglDepthbuffer[et])}else{if(Array.isArray(he.__webglFramebuffer))for(let et=0;et<he.__webglFramebuffer.length;et++)t.deleteFramebuffer(he.__webglFramebuffer[et]);else t.deleteFramebuffer(he.__webglFramebuffer);if(he.__webglDepthbuffer&&t.deleteRenderbuffer(he.__webglDepthbuffer),he.__webglMultisampledFramebuffer&&t.deleteFramebuffer(he.__webglMultisampledFramebuffer),he.__webglColorRenderbuffer)for(let et=0;et<he.__webglColorRenderbuffer.length;et++)he.__webglColorRenderbuffer[et]&&t.deleteRenderbuffer(he.__webglColorRenderbuffer[et]);he.__webglDepthRenderbuffer&&t.deleteRenderbuffer(he.__webglDepthRenderbuffer)}const $e=we.textures;for(let et=0,Et=$e.length;et<Et;et++){const ct=i.get($e[et]);ct.__webglTexture&&(t.deleteTexture(ct.__webglTexture),a.memory.textures--),i.remove($e[et])}i.remove(we)}let V=0;function $(){V=0}function q(){const we=V;return we>=r.maxTextures&&console.warn("THREE.WebGLTextures: Trying to use "+we+" texture units while this GPU supports only "+r.maxTextures),V+=1,we}function Y(we){const he=[];return he.push(we.wrapS),he.push(we.wrapT),he.push(we.wrapR||0),he.push(we.magFilter),he.push(we.minFilter),he.push(we.anisotropy),he.push(we.internalFormat),he.push(we.format),he.push(we.type),he.push(we.generateMipmaps),he.push(we.premultiplyAlpha),he.push(we.flipY),he.push(we.unpackAlignment),he.push(we.colorSpace),he.join()}function te(we,he){const $e=i.get(we);if(we.isVideoTexture&&dt(we),we.isRenderTargetTexture===!1&&we.version>0&&$e.__version!==we.version){const et=we.image;if(et===null)console.warn("THREE.WebGLRenderer: Texture marked for update but no image data found.");else if(et.complete===!1)console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete");else{Te($e,we,he);return}}n.bindTexture(t.TEXTURE_2D,$e.__webglTexture,t.TEXTURE0+he)}function G(we,he){const $e=i.get(we);if(we.version>0&&$e.__version!==we.version){Te($e,we,he);return}n.bindTexture(t.TEXTURE_2D_ARRAY,$e.__webglTexture,t.TEXTURE0+he)}function J(we,he){const $e=i.get(we);if(we.version>0&&$e.__version!==we.version){Te($e,we,he);return}n.bindTexture(t.TEXTURE_3D,$e.__webglTexture,t.TEXTURE0+he)}function K(we,he){const $e=i.get(we);if(we.version>0&&$e.__version!==we.version){Re($e,we,he);return}n.bindTexture(t.TEXTURE_CUBE_MAP,$e.__webglTexture,t.TEXTURE0+he)}const X={[UC]:t.REPEAT,[cp]:t.CLAMP_TO_EDGE,[qO]:t.MIRRORED_REPEAT},ae={[Va]:t.NEAREST,[H7]:t.NEAREST_MIPMAP_NEAREST,[Bw]:t.NEAREST_MIPMAP_LINEAR,[Ca]:t.LINEAR,[JM]:t.LINEAR_MIPMAP_NEAREST,[Hg]:t.LINEAR_MIPMAP_LINEAR},ce={[Ple]:t.NEVER,[zle]:t.ALWAYS,[Dle]:t.LESS,[X7]:t.LEQUAL,[Lle]:t.EQUAL,[Fle]:t.GEQUAL,[Ule]:t.GREATER,[Ble]:t.NOTEQUAL};function Me(we,he){if(he.type===vu&&e.has("OES_texture_float_linear")===!1&&(he.magFilter===Ca||he.magFilter===JM||he.magFilter===Bw||he.magFilter===Hg||he.minFilter===Ca||he.minFilter===JM||he.minFilter===Bw||he.minFilter===Hg)&&console.warn("THREE.WebGLRenderer: Unable to use linear filtering with floating point textures. OES_texture_float_linear not supported on this device."),t.texParameteri(we,t.TEXTURE_WRAP_S,X[he.wrapS]),t.texParameteri(we,t.TEXTURE_WRAP_T,X[he.wrapT]),(we===t.TEXTURE_3D||we===t.TEXTURE_2D_ARRAY)&&t.texParameteri(we,t.TEXTURE_WRAP_R,X[he.wrapR]),t.texParameteri(we,t.TEXTURE_MAG_FILTER,ae[he.magFilter]),t.texParameteri(we,t.TEXTURE_MIN_FILTER,ae[he.minFilter]),he.compareFunction&&(t.texParameteri(we,t.TEXTURE_COMPARE_MODE,t.COMPARE_REF_TO_TEXTURE),t.texParameteri(we,t.TEXTURE_COMPARE_FUNC,ce[he.compareFunction])),e.has("EXT_texture_filter_anisotropic")===!0){if(he.magFilter===Va||he.minFilter!==Bw&&he.minFilter!==Hg||he.type===vu&&e.has("OES_texture_float_linear")===!1)return;if(he.anisotropy>1||i.get(he).__currentAnisotropy){const $e=e.get("EXT_texture_filter_anisotropic");t.texParameterf(we,$e.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(he.anisotropy,r.getMaxAnisotropy())),i.get(he).__currentAnisotropy=he.anisotropy}}}function Fe(we,he){let $e=!1;we.__webglInit===void 0&&(we.__webglInit=!0,he.addEventListener("dispose",R));const et=he.source;let Et=d.get(et);Et===void 0&&(Et={},d.set(et,Et));const ct=Y(he);if(ct!==we.__cacheKey){Et[ct]===void 0&&(Et[ct]={texture:t.createTexture(),usedTimes:0},a.memory.textures++,$e=!0),Et[ct].usedTimes++;const tn=Et[we.__cacheKey];tn!==void 0&&(Et[we.__cacheKey].usedTimes--,tn.usedTimes===0&&P(he)),we.__cacheKey=ct,we.__webglTexture=Et[ct].texture}return $e}function Te(we,he,$e){let et=t.TEXTURE_2D;(he.isDataArrayTexture||he.isCompressedArrayTexture)&&(et=t.TEXTURE_2D_ARRAY),he.isData3DTexture&&(et=t.TEXTURE_3D);const Et=Fe(we,he),ct=he.source;n.bindTexture(et,we.__webglTexture,t.TEXTURE0+$e);const tn=i.get(ct);if(ct.version!==tn.__version||Et===!0){n.activeTexture(t.TEXTURE0+$e);const Ht=Br.getPrimaries(Br.workingColorSpace),pn=he.colorSpace===gm?null:Br.getPrimaries(he.colorSpace),le=he.colorSpace===gm||Ht===pn?t.NONE:t.BROWSER_DEFAULT_WEBGL;t.pixelStorei(t.UNPACK_FLIP_Y_WEBGL,he.flipY),t.pixelStorei(t.UNPACK_PREMULTIPLY_ALPHA_WEBGL,he.premultiplyAlpha),t.pixelStorei(t.UNPACK_ALIGNMENT,he.unpackAlignment),t.pixelStorei(t.UNPACK_COLORSPACE_CONVERSION_WEBGL,le);let z=g(he.image,!1,r.maxTextureSize);z=pt(he,z);const W=s.convert(he.format,he.colorSpace),fe=s.convert(he.type);let Ne=S(he.internalFormat,W,fe,he.colorSpace,he.isVideoTexture);Me(et,he);let Be;const tt=he.mipmaps,Tt=he.isVideoTexture!==!0,Cn=tn.__version===void 0||Et===!0,je=ct.dataReady,zt=M(he,z);if(he.isDepthTexture)Ne=x(he.format===XT,he.type),Cn&&(Tt?n.texStorage2D(t.TEXTURE_2D,1,Ne,z.width,z.height):n.texImage2D(t.TEXTURE_2D,0,Ne,z.width,z.height,0,W,fe,null));else if(he.isDataTexture)if(tt.length>0){Tt&&Cn&&n.texStorage2D(t.TEXTURE_2D,zt,Ne,tt[0].width,tt[0].height);for(let ht=0,Pt=tt.length;ht<Pt;ht++)Be=tt[ht],Tt?je&&n.texSubImage2D(t.TEXTURE_2D,ht,0,0,Be.width,Be.height,W,fe,Be.data):n.texImage2D(t.TEXTURE_2D,ht,Ne,Be.width,Be.height,0,W,fe,Be.data);he.generateMipmaps=!1}else Tt?(Cn&&n.texStorage2D(t.TEXTURE_2D,zt,Ne,z.width,z.height),je&&n.texSubImage2D(t.TEXTURE_2D,0,0,0,z.width,z.height,W,fe,z.data)):n.texImage2D(t.TEXTURE_2D,0,Ne,z.width,z.height,0,W,fe,z.data);else if(he.isCompressedTexture)if(he.isCompressedArrayTexture){Tt&&Cn&&n.texStorage3D(t.TEXTURE_2D_ARRAY,zt,Ne,tt[0].width,tt[0].height,z.depth);for(let ht=0,Pt=tt.length;ht<Pt;ht++)if(Be=tt[ht],he.format!==Wc)if(W!==null)if(Tt){if(je)if(he.layerUpdates.size>0){const hn=aG(Be.width,Be.height,he.format,he.type);for(const on of he.layerUpdates){const Ve=Be.data.subarray(on*hn/Be.data.BYTES_PER_ELEMENT,(on+1)*hn/Be.data.BYTES_PER_ELEMENT);n.compressedTexSubImage3D(t.TEXTURE_2D_ARRAY,ht,0,0,on,Be.width,Be.height,1,W,Ve)}he.clearLayerUpdates()}else n.compressedTexSubImage3D(t.TEXTURE_2D_ARRAY,ht,0,0,0,Be.width,Be.height,z.depth,W,Be.data)}else n.compressedTexImage3D(t.TEXTURE_2D_ARRAY,ht,Ne,Be.width,Be.height,z.depth,0,Be.data,0,0);else console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()");else Tt?je&&n.texSubImage3D(t.TEXTURE_2D_ARRAY,ht,0,0,0,Be.width,Be.height,z.depth,W,fe,Be.data):n.texImage3D(t.TEXTURE_2D_ARRAY,ht,Ne,Be.width,Be.height,z.depth,0,W,fe,Be.data)}else{Tt&&Cn&&n.texStorage2D(t.TEXTURE_2D,zt,Ne,tt[0].width,tt[0].height);for(let ht=0,Pt=tt.length;ht<Pt;ht++)Be=tt[ht],he.format!==Wc?W!==null?Tt?je&&n.compressedTexSubImage2D(t.TEXTURE_2D,ht,0,0,Be.width,Be.height,W,Be.data):n.compressedTexImage2D(t.TEXTURE_2D,ht,Ne,Be.width,Be.height,0,Be.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):Tt?je&&n.texSubImage2D(t.TEXTURE_2D,ht,0,0,Be.width,Be.height,W,fe,Be.data):n.texImage2D(t.TEXTURE_2D,ht,Ne,Be.width,Be.height,0,W,fe,Be.data)}else if(he.isDataArrayTexture)if(Tt){if(Cn&&n.texStorage3D(t.TEXTURE_2D_ARRAY,zt,Ne,z.width,z.height,z.depth),je)if(he.layerUpdates.size>0){const ht=aG(z.width,z.height,he.format,he.type);for(const Pt of he.layerUpdates){const hn=z.data.subarray(Pt*ht/z.data.BYTES_PER_ELEMENT,(Pt+1)*ht/z.data.BYTES_PER_ELEMENT);n.texSubImage3D(t.TEXTURE_2D_ARRAY,0,0,0,Pt,z.width,z.height,1,W,fe,hn)}he.clearLayerUpdates()}else n.texSubImage3D(t.TEXTURE_2D_ARRAY,0,0,0,0,z.width,z.height,z.depth,W,fe,z.data)}else n.texImage3D(t.TEXTURE_2D_ARRAY,0,Ne,z.width,z.height,z.depth,0,W,fe,z.data);else if(he.isData3DTexture)Tt?(Cn&&n.texStorage3D(t.TEXTURE_3D,zt,Ne,z.width,z.height,z.depth),je&&n.texSubImage3D(t.TEXTURE_3D,0,0,0,0,z.width,z.height,z.depth,W,fe,z.data)):n.texImage3D(t.TEXTURE_3D,0,Ne,z.width,z.height,z.depth,0,W,fe,z.data);else if(he.isFramebufferTexture){if(Cn)if(Tt)n.texStorage2D(t.TEXTURE_2D,zt,Ne,z.width,z.height);else{let ht=z.width,Pt=z.height;for(let hn=0;hn<zt;hn++)n.texImage2D(t.TEXTURE_2D,hn,Ne,ht,Pt,0,W,fe,null),ht>>=1,Pt>>=1}}else if(tt.length>0){if(Tt&&Cn){const ht=bt(tt[0]);n.texStorage2D(t.TEXTURE_2D,zt,Ne,ht.width,ht.height)}for(let ht=0,Pt=tt.length;ht<Pt;ht++)Be=tt[ht],Tt?je&&n.texSubImage2D(t.TEXTURE_2D,ht,0,0,W,fe,Be):n.texImage2D(t.TEXTURE_2D,ht,Ne,W,fe,Be);he.generateMipmaps=!1}else if(Tt){if(Cn){const ht=bt(z);n.texStorage2D(t.TEXTURE_2D,zt,Ne,ht.width,ht.height)}je&&n.texSubImage2D(t.TEXTURE_2D,0,0,0,W,fe,z)}else n.texImage2D(t.TEXTURE_2D,0,Ne,W,fe,z);_(he)&&v(et),tn.__version=ct.version,he.onUpdate&&he.onUpdate(he)}we.__version=he.version}function Re(we,he,$e){if(he.image.length!==6)return;const et=Fe(we,he),Et=he.source;n.bindTexture(t.TEXTURE_CUBE_MAP,we.__webglTexture,t.TEXTURE0+$e);const ct=i.get(Et);if(Et.version!==ct.__version||et===!0){n.activeTexture(t.TEXTURE0+$e);const tn=Br.getPrimaries(Br.workingColorSpace),Ht=he.colorSpace===gm?null:Br.getPrimaries(he.colorSpace),pn=he.colorSpace===gm||tn===Ht?t.NONE:t.BROWSER_DEFAULT_WEBGL;t.pixelStorei(t.UNPACK_FLIP_Y_WEBGL,he.flipY),t.pixelStorei(t.UNPACK_PREMULTIPLY_ALPHA_WEBGL,he.premultiplyAlpha),t.pixelStorei(t.UNPACK_ALIGNMENT,he.unpackAlignment),t.pixelStorei(t.UNPACK_COLORSPACE_CONVERSION_WEBGL,pn);const le=he.isCompressedTexture||he.image[0].isCompressedTexture,z=he.image[0]&&he.image[0].isDataTexture,W=[];for(let Pt=0;Pt<6;Pt++)!le&&!z?W[Pt]=g(he.image[Pt],!0,r.maxCubemapSize):W[Pt]=z?he.image[Pt].image:he.image[Pt],W[Pt]=pt(he,W[Pt]);const fe=W[0],Ne=s.convert(he.format,he.colorSpace),Be=s.convert(he.type),tt=S(he.internalFormat,Ne,Be,he.colorSpace),Tt=he.isVideoTexture!==!0,Cn=ct.__version===void 0||et===!0,je=Et.dataReady;let zt=M(he,fe);Me(t.TEXTURE_CUBE_MAP,he);let ht;if(le){Tt&&Cn&&n.texStorage2D(t.TEXTURE_CUBE_MAP,zt,tt,fe.width,fe.height);for(let Pt=0;Pt<6;Pt++){ht=W[Pt].mipmaps;for(let hn=0;hn<ht.length;hn++){const on=ht[hn];he.format!==Wc?Ne!==null?Tt?je&&n.compressedTexSubImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+Pt,hn,0,0,on.width,on.height,Ne,on.data):n.compressedTexImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+Pt,hn,tt,on.width,on.height,0,on.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):Tt?je&&n.texSubImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+Pt,hn,0,0,on.width,on.height,Ne,Be,on.data):n.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+Pt,hn,tt,on.width,on.height,0,Ne,Be,on.data)}}}else{if(ht=he.mipmaps,Tt&&Cn){ht.length>0&&zt++;const Pt=bt(W[0]);n.texStorage2D(t.TEXTURE_CUBE_MAP,zt,tt,Pt.width,Pt.height)}for(let Pt=0;Pt<6;Pt++)if(z){Tt?je&&n.texSubImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+Pt,0,0,0,W[Pt].width,W[Pt].height,Ne,Be,W[Pt].data):n.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+Pt,0,tt,W[Pt].width,W[Pt].height,0,Ne,Be,W[Pt].data);for(let hn=0;hn<ht.length;hn++){const Ve=ht[hn].image[Pt].image;Tt?je&&n.texSubImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+Pt,hn+1,0,0,Ve.width,Ve.height,Ne,Be,Ve.data):n.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+Pt,hn+1,tt,Ve.width,Ve.height,0,Ne,Be,Ve.data)}}else{Tt?je&&n.texSubImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+Pt,0,0,0,Ne,Be,W[Pt]):n.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+Pt,0,tt,Ne,Be,W[Pt]);for(let hn=0;hn<ht.length;hn++){const on=ht[hn];Tt?je&&n.texSubImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+Pt,hn+1,0,0,Ne,Be,on.image[Pt]):n.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+Pt,hn+1,tt,Ne,Be,on.image[Pt])}}}_(he)&&v(t.TEXTURE_CUBE_MAP),ct.__version=Et.version,he.onUpdate&&he.onUpdate(he)}we.__version=he.version}function ge(we,he,$e,et,Et,ct){const tn=s.convert($e.format,$e.colorSpace),Ht=s.convert($e.type),pn=S($e.internalFormat,tn,Ht,$e.colorSpace),le=i.get(he),z=i.get($e);if(z.__renderTarget=he,!le.__hasExternalTextures){const W=Math.max(1,he.width>>ct),fe=Math.max(1,he.height>>ct);Et===t.TEXTURE_3D||Et===t.TEXTURE_2D_ARRAY?n.texImage3D(Et,ct,pn,W,fe,he.depth,0,tn,Ht,null):n.texImage2D(Et,ct,pn,W,fe,0,tn,Ht,null)}n.bindFramebuffer(t.FRAMEBUFFER,we),rt(he)?o.framebufferTexture2DMultisampleEXT(t.FRAMEBUFFER,et,Et,z.__webglTexture,0,Le(he)):(Et===t.TEXTURE_2D||Et>=t.TEXTURE_CUBE_MAP_POSITIVE_X&&Et<=t.TEXTURE_CUBE_MAP_NEGATIVE_Z)&&t.framebufferTexture2D(t.FRAMEBUFFER,et,Et,z.__webglTexture,ct),n.bindFramebuffer(t.FRAMEBUFFER,null)}function _e(we,he,$e){if(t.bindRenderbuffer(t.RENDERBUFFER,we),he.depthBuffer){const et=he.depthTexture,Et=et&&et.isDepthTexture?et.type:null,ct=x(he.stencilBuffer,Et),tn=he.stencilBuffer?t.DEPTH_STENCIL_ATTACHMENT:t.DEPTH_ATTACHMENT,Ht=Le(he);rt(he)?o.renderbufferStorageMultisampleEXT(t.RENDERBUFFER,Ht,ct,he.width,he.height):$e?t.renderbufferStorageMultisample(t.RENDERBUFFER,Ht,ct,he.width,he.height):t.renderbufferStorage(t.RENDERBUFFER,ct,he.width,he.height),t.framebufferRenderbuffer(t.FRAMEBUFFER,tn,t.RENDERBUFFER,we)}else{const et=he.textures;for(let Et=0;Et<et.length;Et++){const ct=et[Et],tn=s.convert(ct.format,ct.colorSpace),Ht=s.convert(ct.type),pn=S(ct.internalFormat,tn,Ht,ct.colorSpace),le=Le(he);$e&&rt(he)===!1?t.renderbufferStorageMultisample(t.RENDERBUFFER,le,pn,he.width,he.height):rt(he)?o.renderbufferStorageMultisampleEXT(t.RENDERBUFFER,le,pn,he.width,he.height):t.renderbufferStorage(t.RENDERBUFFER,pn,he.width,he.height)}}t.bindRenderbuffer(t.RENDERBUFFER,null)}function ke(we,he){if(he&&he.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(n.bindFramebuffer(t.FRAMEBUFFER,we),!(he.depthTexture&&he.depthTexture.isDepthTexture))throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");const et=i.get(he.depthTexture);et.__renderTarget=he,(!et.__webglTexture||he.depthTexture.image.width!==he.width||he.depthTexture.image.height!==he.height)&&(he.depthTexture.image.width=he.width,he.depthTexture.image.height=he.height,he.depthTexture.needsUpdate=!0),te(he.depthTexture,0);const Et=et.__webglTexture,ct=Le(he);if(he.depthTexture.format===FC)rt(he)?o.framebufferTexture2DMultisampleEXT(t.FRAMEBUFFER,t.DEPTH_ATTACHMENT,t.TEXTURE_2D,Et,0,ct):t.framebufferTexture2D(t.FRAMEBUFFER,t.DEPTH_ATTACHMENT,t.TEXTURE_2D,Et,0);else if(he.depthTexture.format===XT)rt(he)?o.framebufferTexture2DMultisampleEXT(t.FRAMEBUFFER,t.DEPTH_STENCIL_ATTACHMENT,t.TEXTURE_2D,Et,0,ct):t.framebufferTexture2D(t.FRAMEBUFFER,t.DEPTH_STENCIL_ATTACHMENT,t.TEXTURE_2D,Et,0);else throw new Error("Unknown depthTexture format")}function gt(we){const he=i.get(we),$e=we.isWebGLCubeRenderTarget===!0;if(he.__boundDepthTexture!==we.depthTexture){const et=we.depthTexture;if(he.__depthDisposeCallback&&he.__depthDisposeCallback(),et){const Et=()=>{delete he.__boundDepthTexture,delete he.__depthDisposeCallback,et.removeEventListener("dispose",Et)};et.addEventListener("dispose",Et),he.__depthDisposeCallback=Et}he.__boundDepthTexture=et}if(we.depthTexture&&!he.__autoAllocateDepthBuffer){if($e)throw new Error("target.depthTexture not supported in Cube render targets");const et=we.texture.mipmaps;et&&et.length>0?ke(he.__webglFramebuffer[0],we):ke(he.__webglFramebuffer,we)}else if($e){he.__webglDepthbuffer=[];for(let et=0;et<6;et++)if(n.bindFramebuffer(t.FRAMEBUFFER,he.__webglFramebuffer[et]),he.__webglDepthbuffer[et]===void 0)he.__webglDepthbuffer[et]=t.createRenderbuffer(),_e(he.__webglDepthbuffer[et],we,!1);else{const Et=we.stencilBuffer?t.DEPTH_STENCIL_ATTACHMENT:t.DEPTH_ATTACHMENT,ct=he.__webglDepthbuffer[et];t.bindRenderbuffer(t.RENDERBUFFER,ct),t.framebufferRenderbuffer(t.FRAMEBUFFER,Et,t.RENDERBUFFER,ct)}}else{const et=we.texture.mipmaps;if(et&&et.length>0?n.bindFramebuffer(t.FRAMEBUFFER,he.__webglFramebuffer[0]):n.bindFramebuffer(t.FRAMEBUFFER,he.__webglFramebuffer),he.__webglDepthbuffer===void 0)he.__webglDepthbuffer=t.createRenderbuffer(),_e(he.__webglDepthbuffer,we,!1);else{const Et=we.stencilBuffer?t.DEPTH_STENCIL_ATTACHMENT:t.DEPTH_ATTACHMENT,ct=he.__webglDepthbuffer;t.bindRenderbuffer(t.RENDERBUFFER,ct),t.framebufferRenderbuffer(t.FRAMEBUFFER,Et,t.RENDERBUFFER,ct)}}n.bindFramebuffer(t.FRAMEBUFFER,null)}function wt(we,he,$e){const et=i.get(we);he!==void 0&&ge(et.__webglFramebuffer,we,we.texture,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,0),$e!==void 0&&gt(we)}function ye(we){const he=we.texture,$e=i.get(we),et=i.get(he);we.addEventListener("dispose",I);const Et=we.textures,ct=we.isWebGLCubeRenderTarget===!0,tn=Et.length>1;if(tn||(et.__webglTexture===void 0&&(et.__webglTexture=t.createTexture()),et.__version=he.version,a.memory.textures++),ct){$e.__webglFramebuffer=[];for(let Ht=0;Ht<6;Ht++)if(he.mipmaps&&he.mipmaps.length>0){$e.__webglFramebuffer[Ht]=[];for(let pn=0;pn<he.mipmaps.length;pn++)$e.__webglFramebuffer[Ht][pn]=t.createFramebuffer()}else $e.__webglFramebuffer[Ht]=t.createFramebuffer()}else{if(he.mipmaps&&he.mipmaps.length>0){$e.__webglFramebuffer=[];for(let Ht=0;Ht<he.mipmaps.length;Ht++)$e.__webglFramebuffer[Ht]=t.createFramebuffer()}else $e.__webglFramebuffer=t.createFramebuffer();if(tn)for(let Ht=0,pn=Et.length;Ht<pn;Ht++){const le=i.get(Et[Ht]);le.__webglTexture===void 0&&(le.__webglTexture=t.createTexture(),a.memory.textures++)}if(we.samples>0&&rt(we)===!1){$e.__webglMultisampledFramebuffer=t.createFramebuffer(),$e.__webglColorRenderbuffer=[],n.bindFramebuffer(t.FRAMEBUFFER,$e.__webglMultisampledFramebuffer);for(let Ht=0;Ht<Et.length;Ht++){const pn=Et[Ht];$e.__webglColorRenderbuffer[Ht]=t.createRenderbuffer(),t.bindRenderbuffer(t.RENDERBUFFER,$e.__webglColorRenderbuffer[Ht]);const le=s.convert(pn.format,pn.colorSpace),z=s.convert(pn.type),W=S(pn.internalFormat,le,z,pn.colorSpace,we.isXRRenderTarget===!0),fe=Le(we);t.renderbufferStorageMultisample(t.RENDERBUFFER,fe,W,we.width,we.height),t.framebufferRenderbuffer(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0+Ht,t.RENDERBUFFER,$e.__webglColorRenderbuffer[Ht])}t.bindRenderbuffer(t.RENDERBUFFER,null),we.depthBuffer&&($e.__webglDepthRenderbuffer=t.createRenderbuffer(),_e($e.__webglDepthRenderbuffer,we,!0)),n.bindFramebuffer(t.FRAMEBUFFER,null)}}if(ct){n.bindTexture(t.TEXTURE_CUBE_MAP,et.__webglTexture),Me(t.TEXTURE_CUBE_MAP,he);for(let Ht=0;Ht<6;Ht++)if(he.mipmaps&&he.mipmaps.length>0)for(let pn=0;pn<he.mipmaps.length;pn++)ge($e.__webglFramebuffer[Ht][pn],we,he,t.COLOR_ATTACHMENT0,t.TEXTURE_CUBE_MAP_POSITIVE_X+Ht,pn);else ge($e.__webglFramebuffer[Ht],we,he,t.COLOR_ATTACHMENT0,t.TEXTURE_CUBE_MAP_POSITIVE_X+Ht,0);_(he)&&v(t.TEXTURE_CUBE_MAP),n.unbindTexture()}else if(tn){for(let Ht=0,pn=Et.length;Ht<pn;Ht++){const le=Et[Ht],z=i.get(le);n.bindTexture(t.TEXTURE_2D,z.__webglTexture),Me(t.TEXTURE_2D,le),ge($e.__webglFramebuffer,we,le,t.COLOR_ATTACHMENT0+Ht,t.TEXTURE_2D,0),_(le)&&v(t.TEXTURE_2D)}n.unbindTexture()}else{let Ht=t.TEXTURE_2D;if((we.isWebGL3DRenderTarget||we.isWebGLArrayRenderTarget)&&(Ht=we.isWebGL3DRenderTarget?t.TEXTURE_3D:t.TEXTURE_2D_ARRAY),n.bindTexture(Ht,et.__webglTexture),Me(Ht,he),he.mipmaps&&he.mipmaps.length>0)for(let pn=0;pn<he.mipmaps.length;pn++)ge($e.__webglFramebuffer[pn],we,he,t.COLOR_ATTACHMENT0,Ht,pn);else ge($e.__webglFramebuffer,we,he,t.COLOR_ATTACHMENT0,Ht,0);_(he)&&v(Ht),n.unbindTexture()}we.depthBuffer&&gt(we)}function Se(we){const he=we.textures;for(let $e=0,et=he.length;$e<et;$e++){const Et=he[$e];if(_(Et)){const ct=b(we),tn=i.get(Et).__webglTexture;n.bindTexture(ct,tn),v(ct),n.unbindTexture()}}}const Qe=[],pe=[];function ze(we){if(we.samples>0){if(rt(we)===!1){const he=we.textures,$e=we.width,et=we.height;let Et=t.COLOR_BUFFER_BIT;const ct=we.stencilBuffer?t.DEPTH_STENCIL_ATTACHMENT:t.DEPTH_ATTACHMENT,tn=i.get(we),Ht=he.length>1;if(Ht)for(let le=0;le<he.length;le++)n.bindFramebuffer(t.FRAMEBUFFER,tn.__webglMultisampledFramebuffer),t.framebufferRenderbuffer(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0+le,t.RENDERBUFFER,null),n.bindFramebuffer(t.FRAMEBUFFER,tn.__webglFramebuffer),t.framebufferTexture2D(t.DRAW_FRAMEBUFFER,t.COLOR_ATTACHMENT0+le,t.TEXTURE_2D,null,0);n.bindFramebuffer(t.READ_FRAMEBUFFER,tn.__webglMultisampledFramebuffer);const pn=we.texture.mipmaps;pn&&pn.length>0?n.bindFramebuffer(t.DRAW_FRAMEBUFFER,tn.__webglFramebuffer[0]):n.bindFramebuffer(t.DRAW_FRAMEBUFFER,tn.__webglFramebuffer);for(let le=0;le<he.length;le++){if(we.resolveDepthBuffer&&(we.depthBuffer&&(Et|=t.DEPTH_BUFFER_BIT),we.stencilBuffer&&we.resolveStencilBuffer&&(Et|=t.STENCIL_BUFFER_BIT)),Ht){t.framebufferRenderbuffer(t.READ_FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.RENDERBUFFER,tn.__webglColorRenderbuffer[le]);const z=i.get(he[le]).__webglTexture;t.framebufferTexture2D(t.DRAW_FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,z,0)}t.blitFramebuffer(0,0,$e,et,0,0,$e,et,Et,t.NEAREST),c===!0&&(Qe.length=0,pe.length=0,Qe.push(t.COLOR_ATTACHMENT0+le),we.depthBuffer&&we.resolveDepthBuffer===!1&&(Qe.push(ct),pe.push(ct),t.invalidateFramebuffer(t.DRAW_FRAMEBUFFER,pe)),t.invalidateFramebuffer(t.READ_FRAMEBUFFER,Qe))}if(n.bindFramebuffer(t.READ_FRAMEBUFFER,null),n.bindFramebuffer(t.DRAW_FRAMEBUFFER,null),Ht)for(let le=0;le<he.length;le++){n.bindFramebuffer(t.FRAMEBUFFER,tn.__webglMultisampledFramebuffer),t.framebufferRenderbuffer(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0+le,t.RENDERBUFFER,tn.__webglColorRenderbuffer[le]);const z=i.get(he[le]).__webglTexture;n.bindFramebuffer(t.FRAMEBUFFER,tn.__webglFramebuffer),t.framebufferTexture2D(t.DRAW_FRAMEBUFFER,t.COLOR_ATTACHMENT0+le,t.TEXTURE_2D,z,0)}n.bindFramebuffer(t.DRAW_FRAMEBUFFER,tn.__webglMultisampledFramebuffer)}else if(we.depthBuffer&&we.resolveDepthBuffer===!1&&c){const he=we.stencilBuffer?t.DEPTH_STENCIL_ATTACHMENT:t.DEPTH_ATTACHMENT;t.invalidateFramebuffer(t.DRAW_FRAMEBUFFER,[he])}}}function Le(we){return Math.min(r.maxSamples,we.samples)}function rt(we){const he=i.get(we);return we.samples>0&&e.has("WEBGL_multisampled_render_to_texture")===!0&&he.__useRenderToTexture!==!1}function dt(we){const he=a.render.frame;u.get(we)!==he&&(u.set(we,he),we.update())}function pt(we,he){const $e=we.colorSpace,et=we.format,Et=we.type;return we.isCompressedTexture===!0||we.isVideoTexture===!0||$e!==a0&&$e!==gm&&(Br.getTransfer($e)===Ns?(et!==Wc||Et!==lo)&&console.warn("THREE.WebGLTextures: sRGB encoded textures have to use RGBAFormat and UnsignedByteType."):console.error("THREE.WebGLTextures: Unsupported texture color space:",$e)),he}function bt(we){return typeof HTMLImageElement<"u"&&we instanceof HTMLImageElement?(l.width=we.naturalWidth||we.width,l.height=we.naturalHeight||we.height):typeof VideoFrame<"u"&&we instanceof VideoFrame?(l.width=we.displayWidth,l.height=we.displayHeight):(l.width=we.width,l.height=we.height),l}this.allocateTextureUnit=q,this.resetTextureUnits=$,this.setTexture2D=te,this.setTexture2DArray=G,this.setTexture3D=J,this.setTextureCube=K,this.rebindTextures=wt,this.setupRenderTarget=ye,this.updateRenderTargetMipmap=Se,this.updateMultisampleRenderTarget=ze,this.setupDepthRenderbuffer=gt,this.setupFrameBufferTexture=ge,this.useMultisampledRTT=rt}function Jue(t,e){function n(i,r=gm){let s;const a=Br.getTransfer(r);if(i===lo)return t.UNSIGNED_BYTE;if(i===QB)return t.UNSIGNED_SHORT_4_4_4_4;if(i===eF)return t.UNSIGNED_SHORT_5_5_5_1;if(i===q7)return t.UNSIGNED_INT_5_9_9_9_REV;if(i===V7)return t.BYTE;if(i===G7)return t.SHORT;if(i===BC)return t.UNSIGNED_SHORT;if(i===JB)return t.INT;if(i===s0)return t.UNSIGNED_INT;if(i===vu)return t.FLOAT;if(i===SE)return t.HALF_FLOAT;if(i===$7)return t.ALPHA;if(i===W7)return t.RGB;if(i===Wc)return t.RGBA;if(i===FC)return t.DEPTH_COMPONENT;if(i===XT)return t.DEPTH_STENCIL;if(i===KA)return t.RED;if(i===II)return t.RED_INTEGER;if(i===tF)return t.RG;if(i===nF)return t.RG_INTEGER;if(i===kI)return t.RGBA_INTEGER;if(i===QM||i===eO||i===tO||i===nO)if(a===Ns)if(s=e.get("WEBGL_compressed_texture_s3tc_srgb"),s!==null){if(i===QM)return s.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(i===eO)return s.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(i===tO)return s.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(i===nO)return s.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else return null;else if(s=e.get("WEBGL_compressed_texture_s3tc"),s!==null){if(i===QM)return s.COMPRESSED_RGB_S3TC_DXT1_EXT;if(i===eO)return s.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(i===tO)return s.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(i===nO)return s.COMPRESSED_RGBA_S3TC_DXT5_EXT}else return null;if(i===tU||i===nU||i===iU||i===rU)if(s=e.get("WEBGL_compressed_texture_pvrtc"),s!==null){if(i===tU)return s.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(i===nU)return s.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(i===iU)return s.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(i===rU)return s.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}else return null;if(i===sU||i===aU||i===oU)if(s=e.get("WEBGL_compressed_texture_etc"),s!==null){if(i===sU||i===aU)return a===Ns?s.COMPRESSED_SRGB8_ETC2:s.COMPRESSED_RGB8_ETC2;if(i===oU)return a===Ns?s.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:s.COMPRESSED_RGBA8_ETC2_EAC}else return null;if(i===cU||i===lU||i===uU||i===hU||i===dU||i===fU||i===pU||i===mU||i===gU||i===vU||i===_U||i===yU||i===bU||i===EU)if(s=e.get("WEBGL_compressed_texture_astc"),s!==null){if(i===cU)return a===Ns?s.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:s.COMPRESSED_RGBA_ASTC_4x4_KHR;if(i===lU)return a===Ns?s.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:s.COMPRESSED_RGBA_ASTC_5x4_KHR;if(i===uU)return a===Ns?s.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:s.COMPRESSED_RGBA_ASTC_5x5_KHR;if(i===hU)return a===Ns?s.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:s.COMPRESSED_RGBA_ASTC_6x5_KHR;if(i===dU)return a===Ns?s.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:s.COMPRESSED_RGBA_ASTC_6x6_KHR;if(i===fU)return a===Ns?s.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:s.COMPRESSED_RGBA_ASTC_8x5_KHR;if(i===pU)return a===Ns?s.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:s.COMPRESSED_RGBA_ASTC_8x6_KHR;if(i===mU)return a===Ns?s.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:s.COMPRESSED_RGBA_ASTC_8x8_KHR;if(i===gU)return a===Ns?s.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:s.COMPRESSED_RGBA_ASTC_10x5_KHR;if(i===vU)return a===Ns?s.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:s.COMPRESSED_RGBA_ASTC_10x6_KHR;if(i===_U)return a===Ns?s.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:s.COMPRESSED_RGBA_ASTC_10x8_KHR;if(i===yU)return a===Ns?s.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:s.COMPRESSED_RGBA_ASTC_10x10_KHR;if(i===bU)return a===Ns?s.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:s.COMPRESSED_RGBA_ASTC_12x10_KHR;if(i===EU)return a===Ns?s.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:s.COMPRESSED_RGBA_ASTC_12x12_KHR}else return null;if(i===iO||i===SU||i===TU)if(s=e.get("EXT_texture_compression_bptc"),s!==null){if(i===iO)return a===Ns?s.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:s.COMPRESSED_RGBA_BPTC_UNORM_EXT;if(i===SU)return s.COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT;if(i===TU)return s.COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT}else return null;if(i===Y7||i===xU||i===wU||i===CU)if(s=e.get("EXT_texture_compression_rgtc"),s!==null){if(i===iO)return s.COMPRESSED_RED_RGTC1_EXT;if(i===xU)return s.COMPRESSED_SIGNED_RED_RGTC1_EXT;if(i===wU)return s.COMPRESSED_RED_GREEN_RGTC2_EXT;if(i===CU)return s.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT}else return null;return i===KT?t.UNSIGNED_INT_24_8:t[i]!==void 0?t[i]:null}return{convert:n}}const fPe=`
void main() {

	gl_Position = vec4( position, 1.0 );

}`,pPe=`
uniform sampler2DArray depthColor;
uniform float depthWidth;
uniform float depthHeight;

void main() {

	vec2 coord = vec2( gl_FragCoord.x / depthWidth, gl_FragCoord.y / depthHeight );

	if ( coord.x >= 1.0 ) {

		gl_FragDepth = texture( depthColor, vec3( coord.x - 1.0, coord.y, 1 ) ).r;

	} else {

		gl_FragDepth = texture( depthColor, vec3( coord.x, coord.y, 0 ) ).r;

	}

}`;class mPe{constructor(){this.texture=null,this.mesh=null,this.depthNear=0,this.depthFar=0}init(e,n,i){if(this.texture===null){const r=new Ga,s=e.properties.get(r);s.__webglTexture=n.texture,(n.depthNear!==i.depthNear||n.depthFar!==i.depthFar)&&(this.depthNear=n.depthNear,this.depthFar=n.depthFar),this.texture=r}}getMesh(e){if(this.texture!==null&&this.mesh===null){const n=e.cameras[0].viewport,i=new qa({vertexShader:fPe,fragmentShader:pPe,uniforms:{depthColor:{value:this.texture},depthWidth:{value:n.z},depthHeight:{value:n.w}}});this.mesh=new Io(new QA(20,20),i)}return this.mesh}reset(){this.texture=null,this.mesh=null}getDepthTexture(){return this.texture}}class gPe extends _f{constructor(e,n){super();const i=this;let r=null,s=1,a=null,o="local-floor",c=1,l=null,u=null,h=null,d=null,f=null,p=null;const g=new mPe,_=n.getContextAttributes();let v=null,b=null;const S=[],x=[],M=new xt;let R=null;const I=new Hc;I.viewport=new zr;const k=new Hc;k.viewport=new zr;const P=[I,k],U=new jue;let V=null,$=null;this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getController=function(Te){let Re=S[Te];return Re===void 0&&(Re=new D2,S[Te]=Re),Re.getTargetRaySpace()},this.getControllerGrip=function(Te){let Re=S[Te];return Re===void 0&&(Re=new D2,S[Te]=Re),Re.getGripSpace()},this.getHand=function(Te){let Re=S[Te];return Re===void 0&&(Re=new D2,S[Te]=Re),Re.getHandSpace()};function q(Te){const Re=x.indexOf(Te.inputSource);if(Re===-1)return;const ge=S[Re];ge!==void 0&&(ge.update(Te.inputSource,Te.frame,l||a),ge.dispatchEvent({type:Te.type,data:Te.inputSource}))}function Y(){r.removeEventListener("select",q),r.removeEventListener("selectstart",q),r.removeEventListener("selectend",q),r.removeEventListener("squeeze",q),r.removeEventListener("squeezestart",q),r.removeEventListener("squeezeend",q),r.removeEventListener("end",Y),r.removeEventListener("inputsourceschange",te);for(let Te=0;Te<S.length;Te++){const Re=x[Te];Re!==null&&(x[Te]=null,S[Te].disconnect(Re))}V=null,$=null,g.reset(),e.setRenderTarget(v),f=null,d=null,h=null,r=null,b=null,Fe.stop(),i.isPresenting=!1,e.setPixelRatio(R),e.setSize(M.width,M.height,!1),i.dispatchEvent({type:"sessionend"})}this.setFramebufferScaleFactor=function(Te){s=Te,i.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(Te){o=Te,i.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return l||a},this.setReferenceSpace=function(Te){l=Te},this.getBaseLayer=function(){return d!==null?d:f},this.getBinding=function(){return h},this.getFrame=function(){return p},this.getSession=function(){return r},this.setSession=async function(Te){if(r=Te,r!==null){if(v=e.getRenderTarget(),r.addEventListener("select",q),r.addEventListener("selectstart",q),r.addEventListener("selectend",q),r.addEventListener("squeeze",q),r.addEventListener("squeezestart",q),r.addEventListener("squeezeend",q),r.addEventListener("end",Y),r.addEventListener("inputsourceschange",te),_.xrCompatible!==!0&&await n.makeXRCompatible(),R=e.getPixelRatio(),e.getSize(M),typeof XRWebGLBinding<"u"&&"createProjectionLayer"in XRWebGLBinding.prototype){let ge=null,_e=null,ke=null;_.depth&&(ke=_.stencil?n.DEPTH24_STENCIL8:n.DEPTH_COMPONENT24,ge=_.stencil?XT:FC,_e=_.stencil?KT:s0);const gt={colorFormat:n.RGBA8,depthFormat:ke,scaleFactor:s};h=new XRWebGLBinding(r,n),d=h.createProjectionLayer(gt),r.updateRenderState({layers:[d]}),e.setPixelRatio(1),e.setSize(d.textureWidth,d.textureHeight,!1),b=new Ko(d.textureWidth,d.textureHeight,{format:Wc,type:lo,depthTexture:new JA(d.textureWidth,d.textureHeight,_e,void 0,void 0,void 0,void 0,void 0,void 0,ge),stencilBuffer:_.stencil,colorSpace:e.outputColorSpace,samples:_.antialias?4:0,resolveDepthBuffer:d.ignoreDepthValues===!1,resolveStencilBuffer:d.ignoreDepthValues===!1})}else{const ge={antialias:_.antialias,alpha:!0,depth:_.depth,stencil:_.stencil,framebufferScaleFactor:s};f=new XRWebGLLayer(r,n,ge),r.updateRenderState({baseLayer:f}),e.setPixelRatio(1),e.setSize(f.framebufferWidth,f.framebufferHeight,!1),b=new Ko(f.framebufferWidth,f.framebufferHeight,{format:Wc,type:lo,colorSpace:e.outputColorSpace,stencilBuffer:_.stencil,resolveDepthBuffer:f.ignoreDepthValues===!1,resolveStencilBuffer:f.ignoreDepthValues===!1})}b.isXRRenderTarget=!0,this.setFoveation(c),l=null,a=await r.requestReferenceSpace(o),Fe.setContext(r),Fe.start(),i.isPresenting=!0,i.dispatchEvent({type:"sessionstart"})}},this.getEnvironmentBlendMode=function(){if(r!==null)return r.environmentBlendMode},this.getDepthTexture=function(){return g.getDepthTexture()};function te(Te){for(let Re=0;Re<Te.removed.length;Re++){const ge=Te.removed[Re],_e=x.indexOf(ge);_e>=0&&(x[_e]=null,S[_e].disconnect(ge))}for(let Re=0;Re<Te.added.length;Re++){const ge=Te.added[Re];let _e=x.indexOf(ge);if(_e===-1){for(let gt=0;gt<S.length;gt++)if(gt>=x.length){x.push(ge),_e=gt;break}else if(x[gt]===null){x[gt]=ge,_e=gt;break}if(_e===-1)break}const ke=S[_e];ke&&ke.connect(ge)}}const G=new Oe,J=new Oe;function K(Te,Re,ge){G.setFromMatrixPosition(Re.matrixWorld),J.setFromMatrixPosition(ge.matrixWorld);const _e=G.distanceTo(J),ke=Re.projectionMatrix.elements,gt=ge.projectionMatrix.elements,wt=ke[14]/(ke[10]-1),ye=ke[14]/(ke[10]+1),Se=(ke[9]+1)/ke[5],Qe=(ke[9]-1)/ke[5],pe=(ke[8]-1)/ke[0],ze=(gt[8]+1)/gt[0],Le=wt*pe,rt=wt*ze,dt=_e/(-pe+ze),pt=dt*-pe;if(Re.matrixWorld.decompose(Te.position,Te.quaternion,Te.scale),Te.translateX(pt),Te.translateZ(dt),Te.matrixWorld.compose(Te.position,Te.quaternion,Te.scale),Te.matrixWorldInverse.copy(Te.matrixWorld).invert(),ke[10]===-1)Te.projectionMatrix.copy(Re.projectionMatrix),Te.projectionMatrixInverse.copy(Re.projectionMatrixInverse);else{const bt=wt+dt,we=ye+dt,he=Le-pt,$e=rt+(_e-pt),et=Se*ye/we*bt,Et=Qe*ye/we*bt;Te.projectionMatrix.makePerspective(he,$e,et,Et,bt,we),Te.projectionMatrixInverse.copy(Te.projectionMatrix).invert()}}function X(Te,Re){Re===null?Te.matrixWorld.copy(Te.matrix):Te.matrixWorld.multiplyMatrices(Re.matrixWorld,Te.matrix),Te.matrixWorldInverse.copy(Te.matrixWorld).invert()}this.updateCamera=function(Te){if(r===null)return;let Re=Te.near,ge=Te.far;g.texture!==null&&(g.depthNear>0&&(Re=g.depthNear),g.depthFar>0&&(ge=g.depthFar)),U.near=k.near=I.near=Re,U.far=k.far=I.far=ge,(V!==U.near||$!==U.far)&&(r.updateRenderState({depthNear:U.near,depthFar:U.far}),V=U.near,$=U.far),I.layers.mask=Te.layers.mask|2,k.layers.mask=Te.layers.mask|4,U.layers.mask=I.layers.mask|k.layers.mask;const _e=Te.parent,ke=U.cameras;X(U,_e);for(let gt=0;gt<ke.length;gt++)X(ke[gt],_e);ke.length===2?K(U,I,k):U.projectionMatrix.copy(I.projectionMatrix),ae(Te,U,_e)};function ae(Te,Re,ge){ge===null?Te.matrix.copy(Re.matrixWorld):(Te.matrix.copy(ge.matrixWorld),Te.matrix.invert(),Te.matrix.multiply(Re.matrixWorld)),Te.matrix.decompose(Te.position,Te.quaternion,Te.scale),Te.updateMatrixWorld(!0),Te.projectionMatrix.copy(Re.projectionMatrix),Te.projectionMatrixInverse.copy(Re.projectionMatrixInverse),Te.isPerspectiveCamera&&(Te.fov=zC*2*Math.atan(1/Te.projectionMatrix.elements[5]),Te.zoom=1)}this.getCamera=function(){return U},this.getFoveation=function(){if(!(d===null&&f===null))return c},this.setFoveation=function(Te){c=Te,d!==null&&(d.fixedFoveation=Te),f!==null&&f.fixedFoveation!==void 0&&(f.fixedFoveation=Te)},this.hasDepthSensing=function(){return g.texture!==null},this.getDepthSensingMesh=function(){return g.getMesh(U)};let ce=null;function Me(Te,Re){if(u=Re.getViewerPose(l||a),p=Re,u!==null){const ge=u.views;f!==null&&(e.setRenderTargetFramebuffer(b,f.framebuffer),e.setRenderTarget(b));let _e=!1;ge.length!==U.cameras.length&&(U.cameras.length=0,_e=!0);for(let wt=0;wt<ge.length;wt++){const ye=ge[wt];let Se=null;if(f!==null)Se=f.getViewport(ye);else{const pe=h.getViewSubImage(d,ye);Se=pe.viewport,wt===0&&(e.setRenderTargetTextures(b,pe.colorTexture,pe.depthStencilTexture),e.setRenderTarget(b))}let Qe=P[wt];Qe===void 0&&(Qe=new Hc,Qe.layers.enable(wt),Qe.viewport=new zr,P[wt]=Qe),Qe.matrix.fromArray(ye.transform.matrix),Qe.matrix.decompose(Qe.position,Qe.quaternion,Qe.scale),Qe.projectionMatrix.fromArray(ye.projectionMatrix),Qe.projectionMatrixInverse.copy(Qe.projectionMatrix).invert(),Qe.viewport.set(Se.x,Se.y,Se.width,Se.height),wt===0&&(U.matrix.copy(Qe.matrix),U.matrix.decompose(U.position,U.quaternion,U.scale)),_e===!0&&U.cameras.push(Qe)}const ke=r.enabledFeatures;if(ke&&ke.includes("depth-sensing")&&r.depthUsage=="gpu-optimized"&&h){const wt=h.getDepthInformation(ge[0]);wt&&wt.isValid&&wt.texture&&g.init(e,wt,r.renderState)}}for(let ge=0;ge<S.length;ge++){const _e=x[ge],ke=S[ge];_e!==null&&ke!==void 0&&ke.update(_e,Re,l||a)}ce&&ce(Te,Re),Re.detectedPlanes&&i.dispatchEvent({type:"planesdetected",data:Re}),p=null}const Fe=new Wue;Fe.setAnimationLoop(Me),this.setAnimationLoop=function(Te){ce=Te},this.dispose=function(){}}}const VS=new dd,vPe=new gi;function _Pe(t,e){function n(_,v){_.matrixAutoUpdate===!0&&_.updateMatrix(),v.value.copy(_.matrix)}function i(_,v){v.color.getRGB(_.fogColor.value,$le(t)),v.isFog?(_.fogNear.value=v.near,_.fogFar.value=v.far):v.isFogExp2&&(_.fogDensity.value=v.density)}function r(_,v,b,S,x){v.isMeshBasicMaterial||v.isMeshLambertMaterial?s(_,v):v.isMeshToonMaterial?(s(_,v),h(_,v)):v.isMeshPhongMaterial?(s(_,v),u(_,v)):v.isMeshStandardMaterial?(s(_,v),d(_,v),v.isMeshPhysicalMaterial&&f(_,v,x)):v.isMeshMatcapMaterial?(s(_,v),p(_,v)):v.isMeshDepthMaterial?s(_,v):v.isMeshDistanceMaterial?(s(_,v),g(_,v)):v.isMeshNormalMaterial?s(_,v):v.isLineBasicMaterial?(a(_,v),v.isLineDashedMaterial&&o(_,v)):v.isPointsMaterial?c(_,v,b,S):v.isSpriteMaterial?l(_,v):v.isShadowMaterial?(_.color.value.copy(v.color),_.opacity.value=v.opacity):v.isShaderMaterial&&(v.uniformsNeedUpdate=!1)}function s(_,v){_.opacity.value=v.opacity,v.color&&_.diffuse.value.copy(v.color),v.emissive&&_.emissive.value.copy(v.emissive).multiplyScalar(v.emissiveIntensity),v.map&&(_.map.value=v.map,n(v.map,_.mapTransform)),v.alphaMap&&(_.alphaMap.value=v.alphaMap,n(v.alphaMap,_.alphaMapTransform)),v.bumpMap&&(_.bumpMap.value=v.bumpMap,n(v.bumpMap,_.bumpMapTransform),_.bumpScale.value=v.bumpScale,v.side===$c&&(_.bumpScale.value*=-1)),v.normalMap&&(_.normalMap.value=v.normalMap,n(v.normalMap,_.normalMapTransform),_.normalScale.value.copy(v.normalScale),v.side===$c&&_.normalScale.value.negate()),v.displacementMap&&(_.displacementMap.value=v.displacementMap,n(v.displacementMap,_.displacementMapTransform),_.displacementScale.value=v.displacementScale,_.displacementBias.value=v.displacementBias),v.emissiveMap&&(_.emissiveMap.value=v.emissiveMap,n(v.emissiveMap,_.emissiveMapTransform)),v.specularMap&&(_.specularMap.value=v.specularMap,n(v.specularMap,_.specularMapTransform)),v.alphaTest>0&&(_.alphaTest.value=v.alphaTest);const b=e.get(v),S=b.envMap,x=b.envMapRotation;S&&(_.envMap.value=S,VS.copy(x),VS.x*=-1,VS.y*=-1,VS.z*=-1,S.isCubeTexture&&S.isRenderTargetTexture===!1&&(VS.y*=-1,VS.z*=-1),_.envMapRotation.value.setFromMatrix4(vPe.makeRotationFromEuler(VS)),_.flipEnvMap.value=S.isCubeTexture&&S.isRenderTargetTexture===!1?-1:1,_.reflectivity.value=v.reflectivity,_.ior.value=v.ior,_.refractionRatio.value=v.refractionRatio),v.lightMap&&(_.lightMap.value=v.lightMap,_.lightMapIntensity.value=v.lightMapIntensity,n(v.lightMap,_.lightMapTransform)),v.aoMap&&(_.aoMap.value=v.aoMap,_.aoMapIntensity.value=v.aoMapIntensity,n(v.aoMap,_.aoMapTransform))}function a(_,v){_.diffuse.value.copy(v.color),_.opacity.value=v.opacity,v.map&&(_.map.value=v.map,n(v.map,_.mapTransform))}function o(_,v){_.dashSize.value=v.dashSize,_.totalSize.value=v.dashSize+v.gapSize,_.scale.value=v.scale}function c(_,v,b,S){_.diffuse.value.copy(v.color),_.opacity.value=v.opacity,_.size.value=v.size*b,_.scale.value=S*.5,v.map&&(_.map.value=v.map,n(v.map,_.uvTransform)),v.alphaMap&&(_.alphaMap.value=v.alphaMap,n(v.alphaMap,_.alphaMapTransform)),v.alphaTest>0&&(_.alphaTest.value=v.alphaTest)}function l(_,v){_.diffuse.value.copy(v.color),_.opacity.value=v.opacity,_.rotation.value=v.rotation,v.map&&(_.map.value=v.map,n(v.map,_.mapTransform)),v.alphaMap&&(_.alphaMap.value=v.alphaMap,n(v.alphaMap,_.alphaMapTransform)),v.alphaTest>0&&(_.alphaTest.value=v.alphaTest)}function u(_,v){_.specular.value.copy(v.specular),_.shininess.value=Math.max(v.shininess,1e-4)}function h(_,v){v.gradientMap&&(_.gradientMap.value=v.gradientMap)}function d(_,v){_.metalness.value=v.metalness,v.metalnessMap&&(_.metalnessMap.value=v.metalnessMap,n(v.metalnessMap,_.metalnessMapTransform)),_.roughness.value=v.roughness,v.roughnessMap&&(_.roughnessMap.value=v.roughnessMap,n(v.roughnessMap,_.roughnessMapTransform)),v.envMap&&(_.envMapIntensity.value=v.envMapIntensity)}function f(_,v,b){_.ior.value=v.ior,v.sheen>0&&(_.sheenColor.value.copy(v.sheenColor).multiplyScalar(v.sheen),_.sheenRoughness.value=v.sheenRoughness,v.sheenColorMap&&(_.sheenColorMap.value=v.sheenColorMap,n(v.sheenColorMap,_.sheenColorMapTransform)),v.sheenRoughnessMap&&(_.sheenRoughnessMap.value=v.sheenRoughnessMap,n(v.sheenRoughnessMap,_.sheenRoughnessMapTransform))),v.clearcoat>0&&(_.clearcoat.value=v.clearcoat,_.clearcoatRoughness.value=v.clearcoatRoughness,v.clearcoatMap&&(_.clearcoatMap.value=v.clearcoatMap,n(v.clearcoatMap,_.clearcoatMapTransform)),v.clearcoatRoughnessMap&&(_.clearcoatRoughnessMap.value=v.clearcoatRoughnessMap,n(v.clearcoatRoughnessMap,_.clearcoatRoughnessMapTransform)),v.clearcoatNormalMap&&(_.clearcoatNormalMap.value=v.clearcoatNormalMap,n(v.clearcoatNormalMap,_.clearcoatNormalMapTransform),_.clearcoatNormalScale.value.copy(v.clearcoatNormalScale),v.side===$c&&_.clearcoatNormalScale.value.negate())),v.dispersion>0&&(_.dispersion.value=v.dispersion),v.iridescence>0&&(_.iridescence.value=v.iridescence,_.iridescenceIOR.value=v.iridescenceIOR,_.iridescenceThicknessMinimum.value=v.iridescenceThicknessRange[0],_.iridescenceThicknessMaximum.value=v.iridescenceThicknessRange[1],v.iridescenceMap&&(_.iridescenceMap.value=v.iridescenceMap,n(v.iridescenceMap,_.iridescenceMapTransform)),v.iridescenceThicknessMap&&(_.iridescenceThicknessMap.value=v.iridescenceThicknessMap,n(v.iridescenceThicknessMap,_.iridescenceThicknessMapTransform))),v.transmission>0&&(_.transmission.value=v.transmission,_.transmissionSamplerMap.value=b.texture,_.transmissionSamplerSize.value.set(b.width,b.height),v.transmissionMap&&(_.transmissionMap.value=v.transmissionMap,n(v.transmissionMap,_.transmissionMapTransform)),_.thickness.value=v.thickness,v.thicknessMap&&(_.thicknessMap.value=v.thicknessMap,n(v.thicknessMap,_.thicknessMapTransform)),_.attenuationDistance.value=v.attenuationDistance,_.attenuationColor.value.copy(v.attenuationColor)),v.anisotropy>0&&(_.anisotropyVector.value.set(v.anisotropy*Math.cos(v.anisotropyRotation),v.anisotropy*Math.sin(v.anisotropyRotation)),v.anisotropyMap&&(_.anisotropyMap.value=v.anisotropyMap,n(v.anisotropyMap,_.anisotropyMapTransform))),_.specularIntensity.value=v.specularIntensity,_.specularColor.value.copy(v.specularColor),v.specularColorMap&&(_.specularColorMap.value=v.specularColorMap,n(v.specularColorMap,_.specularColorMapTransform)),v.specularIntensityMap&&(_.specularIntensityMap.value=v.specularIntensityMap,n(v.specularIntensityMap,_.specularIntensityMapTransform))}function p(_,v){v.matcap&&(_.matcap.value=v.matcap)}function g(_,v){const b=e.get(v).light;_.referencePosition.value.setFromMatrixPosition(b.matrixWorld),_.nearDistance.value=b.shadow.camera.near,_.farDistance.value=b.shadow.camera.far}return{refreshFogUniforms:i,refreshMaterialUniforms:r}}function yPe(t,e,n,i){let r={},s={},a=[];const o=t.getParameter(t.MAX_UNIFORM_BUFFER_BINDINGS);function c(b,S){const x=S.program;i.uniformBlockBinding(b,x)}function l(b,S){let x=r[b.id];x===void 0&&(p(b),x=u(b),r[b.id]=x,b.addEventListener("dispose",_));const M=S.program;i.updateUBOMapping(b,M);const R=e.render.frame;s[b.id]!==R&&(d(b),s[b.id]=R)}function u(b){const S=h();b.__bindingPointIndex=S;const x=t.createBuffer(),M=b.__size,R=b.usage;return t.bindBuffer(t.UNIFORM_BUFFER,x),t.bufferData(t.UNIFORM_BUFFER,M,R),t.bindBuffer(t.UNIFORM_BUFFER,null),t.bindBufferBase(t.UNIFORM_BUFFER,S,x),x}function h(){for(let b=0;b<o;b++)if(a.indexOf(b)===-1)return a.push(b),b;return console.error("THREE.WebGLRenderer: Maximum number of simultaneously usable uniforms groups reached."),0}function d(b){const S=r[b.id],x=b.uniforms,M=b.__cache;t.bindBuffer(t.UNIFORM_BUFFER,S);for(let R=0,I=x.length;R<I;R++){const k=Array.isArray(x[R])?x[R]:[x[R]];for(let P=0,U=k.length;P<U;P++){const V=k[P];if(f(V,R,P,M)===!0){const $=V.__offset,q=Array.isArray(V.value)?V.value:[V.value];let Y=0;for(let te=0;te<q.length;te++){const G=q[te],J=g(G);typeof G=="number"||typeof G=="boolean"?(V.__data[0]=G,t.bufferSubData(t.UNIFORM_BUFFER,$+Y,V.__data)):G.isMatrix3?(V.__data[0]=G.elements[0],V.__data[1]=G.elements[1],V.__data[2]=G.elements[2],V.__data[3]=0,V.__data[4]=G.elements[3],V.__data[5]=G.elements[4],V.__data[6]=G.elements[5],V.__data[7]=0,V.__data[8]=G.elements[6],V.__data[9]=G.elements[7],V.__data[10]=G.elements[8],V.__data[11]=0):(G.toArray(V.__data,Y),Y+=J.storage/Float32Array.BYTES_PER_ELEMENT)}t.bufferSubData(t.UNIFORM_BUFFER,$,V.__data)}}}t.bindBuffer(t.UNIFORM_BUFFER,null)}function f(b,S,x,M){const R=b.value,I=S+"_"+x;if(M[I]===void 0)return typeof R=="number"||typeof R=="boolean"?M[I]=R:M[I]=R.clone(),!0;{const k=M[I];if(typeof R=="number"||typeof R=="boolean"){if(k!==R)return M[I]=R,!0}else if(k.equals(R)===!1)return k.copy(R),!0}return!1}function p(b){const S=b.uniforms;let x=0;const M=16;for(let I=0,k=S.length;I<k;I++){const P=Array.isArray(S[I])?S[I]:[S[I]];for(let U=0,V=P.length;U<V;U++){const $=P[U],q=Array.isArray($.value)?$.value:[$.value];for(let Y=0,te=q.length;Y<te;Y++){const G=q[Y],J=g(G),K=x%M,X=K%J.boundary,ae=K+X;x+=X,ae!==0&&M-ae<J.storage&&(x+=M-ae),$.__data=new Float32Array(J.storage/Float32Array.BYTES_PER_ELEMENT),$.__offset=x,x+=J.storage}}}const R=x%M;return R>0&&(x+=M-R),b.__size=x,b.__cache={},this}function g(b){const S={boundary:0,storage:0};return typeof b=="number"||typeof b=="boolean"?(S.boundary=4,S.storage=4):b.isVector2?(S.boundary=8,S.storage=8):b.isVector3||b.isColor?(S.boundary=16,S.storage=12):b.isVector4?(S.boundary=16,S.storage=16):b.isMatrix3?(S.boundary=48,S.storage=48):b.isMatrix4?(S.boundary=64,S.storage=64):b.isTexture?console.warn("THREE.WebGLRenderer: Texture samplers can not be part of an uniforms group."):console.warn("THREE.WebGLRenderer: Unsupported uniform value type.",b),S}function _(b){const S=b.target;S.removeEventListener("dispose",_);const x=a.indexOf(S.__bindingPointIndex);a.splice(x,1),t.deleteBuffer(r[S.id]),delete r[S.id],delete s[S.id]}function v(){for(const b in r)t.deleteBuffer(r[b]);a=[],r={},s={}}return{bind:c,update:l,dispose:v}}class Que{constructor(e={}){const{canvas:n=Vle(),context:i=null,depth:r=!0,stencil:s=!1,alpha:a=!1,antialias:o=!1,premultipliedAlpha:c=!0,preserveDrawingBuffer:l=!1,powerPreference:u="default",failIfMajorPerformanceCaveat:h=!1,reverseDepthBuffer:d=!1}=e;this.isWebGLRenderer=!0;let f;if(i!==null){if(typeof WebGLRenderingContext<"u"&&i instanceof WebGLRenderingContext)throw new Error("THREE.WebGLRenderer: WebGL 1 is not supported since r163.");f=i.getContextAttributes().alpha}else f=a;const p=new Uint32Array(4),g=new Int32Array(4);let _=null,v=null;const b=[],S=[];this.domElement=n,this.debug={checkShaderErrors:!0,onShaderError:null},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.toneMapping=Em,this.toneMappingExposure=1,this.transmissionResolutionScale=1;const x=this;let M=!1;this._outputColorSpace=ls;let R=0,I=0,k=null,P=-1,U=null;const V=new zr,$=new zr;let q=null;const Y=new bn(0);let te=0,G=n.width,J=n.height,K=1,X=null,ae=null;const ce=new zr(0,0,G,J),Me=new zr(0,0,G,J);let Fe=!1;const Te=new ZA;let Re=!1,ge=!1;const _e=new gi,ke=new gi,gt=new Oe,wt=new zr,ye={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};let Se=!1;function Qe(){return k===null?K:1}let pe=i;function ze(Ee,We){return n.getContext(Ee,We)}try{const Ee={alpha:!0,depth:r,stencil:s,antialias:o,premultipliedAlpha:c,preserveDrawingBuffer:l,powerPreference:u,failIfMajorPerformanceCaveat:h};if("setAttribute"in n&&n.setAttribute("data-engine",`three.js r${WA}`),n.addEventListener("webglcontextlost",Pt,!1),n.addEventListener("webglcontextrestored",hn,!1),n.addEventListener("webglcontextcreationerror",on,!1),pe===null){const We="webgl2";if(pe=ze(We,Ee),pe===null)throw ze(We)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}}catch(Ee){throw console.error("THREE.WebGLRenderer: "+Ee.message),Ee}let Le,rt,dt,pt,bt,we,he,$e,et,Et,ct,tn,Ht,pn,le,z,W,fe,Ne,Be,tt,Tt,Cn,je;function zt(){Le=new NIe(pe),Le.init(),Tt=new Jue(pe,Le),rt=new xIe(pe,Le,e,Tt),dt=new hPe(pe,Le),rt.reverseDepthBuffer&&d&&dt.buffers.depth.setReversed(!0),pt=new PIe(pe),bt=new Jke,we=new dPe(pe,Le,dt,bt,rt,Tt,pt),he=new CIe(x),$e=new OIe(x),et=new zMe(pe),Cn=new SIe(pe,et),Et=new IIe(pe,et,pt,Cn),ct=new LIe(pe,Et,et,pt),Ne=new DIe(pe,rt,we),z=new wIe(bt),tn=new Zke(x,he,$e,Le,rt,Cn,z),Ht=new _Pe(x,bt),pn=new ePe,le=new aPe(Le),fe=new EIe(x,he,$e,dt,ct,f,c),W=new lPe(x,ct,rt),je=new yPe(pe,pt,rt,dt),Be=new TIe(pe,Le,pt),tt=new kIe(pe,Le,pt),pt.programs=tn.programs,x.capabilities=rt,x.extensions=Le,x.properties=bt,x.renderLists=pn,x.shadowMap=W,x.state=dt,x.info=pt}zt();const ht=new gPe(x,pe);this.xr=ht,this.getContext=function(){return pe},this.getContextAttributes=function(){return pe.getContextAttributes()},this.forceContextLoss=function(){const Ee=Le.get("WEBGL_lose_context");Ee&&Ee.loseContext()},this.forceContextRestore=function(){const Ee=Le.get("WEBGL_lose_context");Ee&&Ee.restoreContext()},this.getPixelRatio=function(){return K},this.setPixelRatio=function(Ee){Ee!==void 0&&(K=Ee,this.setSize(G,J,!1))},this.getSize=function(Ee){return Ee.set(G,J)},this.setSize=function(Ee,We,vt=!0){if(ht.isPresenting){console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting.");return}G=Ee,J=We,n.width=Math.floor(Ee*K),n.height=Math.floor(We*K),vt===!0&&(n.style.width=Ee+"px",n.style.height=We+"px"),this.setViewport(0,0,Ee,We)},this.getDrawingBufferSize=function(Ee){return Ee.set(G*K,J*K).floor()},this.setDrawingBufferSize=function(Ee,We,vt){G=Ee,J=We,K=vt,n.width=Math.floor(Ee*vt),n.height=Math.floor(We*vt),this.setViewport(0,0,Ee,We)},this.getCurrentViewport=function(Ee){return Ee.copy(V)},this.getViewport=function(Ee){return Ee.copy(ce)},this.setViewport=function(Ee,We,vt,_t){Ee.isVector4?ce.set(Ee.x,Ee.y,Ee.z,Ee.w):ce.set(Ee,We,vt,_t),dt.viewport(V.copy(ce).multiplyScalar(K).round())},this.getScissor=function(Ee){return Ee.copy(Me)},this.setScissor=function(Ee,We,vt,_t){Ee.isVector4?Me.set(Ee.x,Ee.y,Ee.z,Ee.w):Me.set(Ee,We,vt,_t),dt.scissor($.copy(Me).multiplyScalar(K).round())},this.getScissorTest=function(){return Fe},this.setScissorTest=function(Ee){dt.setScissorTest(Fe=Ee)},this.setOpaqueSort=function(Ee){X=Ee},this.setTransparentSort=function(Ee){ae=Ee},this.getClearColor=function(Ee){return Ee.copy(fe.getClearColor())},this.setClearColor=function(){fe.setClearColor(...arguments)},this.getClearAlpha=function(){return fe.getClearAlpha()},this.setClearAlpha=function(){fe.setClearAlpha(...arguments)},this.clear=function(Ee=!0,We=!0,vt=!0){let _t=0;if(Ee){let Ze=!1;if(k!==null){const Vt=k.texture.format;Ze=Vt===kI||Vt===nF||Vt===II}if(Ze){const Vt=k.texture.type,rn=Vt===lo||Vt===s0||Vt===BC||Vt===KT||Vt===QB||Vt===eF,_n=fe.getClearColor(),wn=fe.getClearAlpha(),ci=_n.r,li=_n.g,Nn=_n.b;rn?(p[0]=ci,p[1]=li,p[2]=Nn,p[3]=wn,pe.clearBufferuiv(pe.COLOR,0,p)):(g[0]=ci,g[1]=li,g[2]=Nn,g[3]=wn,pe.clearBufferiv(pe.COLOR,0,g))}else _t|=pe.COLOR_BUFFER_BIT}We&&(_t|=pe.DEPTH_BUFFER_BIT),vt&&(_t|=pe.STENCIL_BUFFER_BIT,this.state.buffers.stencil.setMask(4294967295)),pe.clear(_t)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){n.removeEventListener("webglcontextlost",Pt,!1),n.removeEventListener("webglcontextrestored",hn,!1),n.removeEventListener("webglcontextcreationerror",on,!1),fe.dispose(),pn.dispose(),le.dispose(),bt.dispose(),he.dispose(),$e.dispose(),ct.dispose(),Cn.dispose(),je.dispose(),tn.dispose(),ht.dispose(),ht.removeEventListener("sessionstart",wi),ht.removeEventListener("sessionend",ai),xn.stop()};function Pt(Ee){Ee.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),M=!0}function hn(){console.log("THREE.WebGLRenderer: Context Restored."),M=!1;const Ee=pt.autoReset,We=W.enabled,vt=W.autoUpdate,_t=W.needsUpdate,Ze=W.type;zt(),pt.autoReset=Ee,W.enabled=We,W.autoUpdate=vt,W.needsUpdate=_t,W.type=Ze}function on(Ee){console.error("THREE.WebGLRenderer: A WebGL context could not be created. Reason: ",Ee.statusMessage)}function Ve(Ee){const We=Ee.target;We.removeEventListener("dispose",Ve),at(We)}function at(Ee){Mt(Ee),bt.remove(Ee)}function Mt(Ee){const We=bt.get(Ee).programs;We!==void 0&&(We.forEach(function(vt){tn.releaseProgram(vt)}),Ee.isShaderMaterial&&tn.releaseShaderCache(Ee))}this.renderBufferDirect=function(Ee,We,vt,_t,Ze,Vt){We===null&&(We=ye);const rn=Ze.isMesh&&Ze.matrixWorld.determinant()<0,_n=Ef(Ee,We,vt,_t,Ze);dt.setMaterial(_t,rn);let wn=vt.index,ci=1;if(_t.wireframe===!0){if(wn=Et.getWireframeAttribute(vt),wn===void 0)return;ci=2}const li=vt.drawRange,Nn=vt.attributes.position;let yi=li.start*ci,cr=(li.start+li.count)*ci;Vt!==null&&(yi=Math.max(yi,Vt.start*ci),cr=Math.min(cr,(Vt.start+Vt.count)*ci)),wn!==null?(yi=Math.max(yi,0),cr=Math.min(cr,wn.count)):Nn!=null&&(yi=Math.max(yi,0),cr=Math.min(cr,Nn.count));const Ds=cr-yi;if(Ds<0||Ds===1/0)return;Cn.setup(Ze,_t,_n,vt,wn);let xs,Zi=Be;if(wn!==null&&(xs=et.get(wn),Zi=tt,Zi.setIndex(xs)),Ze.isMesh)_t.wireframe===!0?(dt.setLineWidth(_t.wireframeLinewidth*Qe()),Zi.setMode(pe.LINES)):Zi.setMode(pe.TRIANGLES);else if(Ze.isLine){let Jn=_t.linewidth;Jn===void 0&&(Jn=1),dt.setLineWidth(Jn*Qe()),Ze.isLineSegments?Zi.setMode(pe.LINES):Ze.isLineLoop?Zi.setMode(pe.LINE_LOOP):Zi.setMode(pe.LINE_STRIP)}else Ze.isPoints?Zi.setMode(pe.POINTS):Ze.isSprite&&Zi.setMode(pe.TRIANGLES);if(Ze.isBatchedMesh)if(Ze._multiDrawInstances!==null)P2("THREE.WebGLRenderer: renderMultiDrawInstances has been deprecated and will be removed in r184. Append to renderMultiDraw arguments and use indirection."),Zi.renderMultiDrawInstances(Ze._multiDrawStarts,Ze._multiDrawCounts,Ze._multiDrawCount,Ze._multiDrawInstances);else if(Le.get("WEBGL_multi_draw"))Zi.renderMultiDraw(Ze._multiDrawStarts,Ze._multiDrawCounts,Ze._multiDrawCount);else{const Jn=Ze._multiDrawStarts,Ci=Ze._multiDrawCounts,Hn=Ze._multiDrawCount,Jo=wn?et.get(wn).bytesPerElement:1,Ql=bt.get(_t).currentProgram.getUniforms();for(let uo=0;uo<Hn;uo++)Ql.setValue(pe,"_gl_DrawID",uo),Zi.render(Jn[uo]/Jo,Ci[uo])}else if(Ze.isInstancedMesh)Zi.renderInstances(yi,Ds,Ze.count);else if(vt.isInstancedBufferGeometry){const Jn=vt._maxInstanceCount!==void 0?vt._maxInstanceCount:1/0,Ci=Math.min(vt.instanceCount,Jn);Zi.renderInstances(yi,Ds,Ci)}else Zi.render(yi,Ds)};function Ot(Ee,We,vt){Ee.transparent===!0&&Ee.side===Vc&&Ee.forceSinglePass===!1?(Ee.side=$c,Ee.needsUpdate=!0,ni(Ee,We,vt),Ee.side=r0,Ee.needsUpdate=!0,ni(Ee,We,vt),Ee.side=Vc):ni(Ee,We,vt)}this.compile=function(Ee,We,vt=null){vt===null&&(vt=Ee),v=le.get(vt),v.init(We),S.push(v),vt.traverseVisible(function(Ze){Ze.isLight&&Ze.layers.test(We.layers)&&(v.pushLight(Ze),Ze.castShadow&&v.pushShadow(Ze))}),Ee!==vt&&Ee.traverseVisible(function(Ze){Ze.isLight&&Ze.layers.test(We.layers)&&(v.pushLight(Ze),Ze.castShadow&&v.pushShadow(Ze))}),v.setupLights();const _t=new Set;return Ee.traverse(function(Ze){if(!(Ze.isMesh||Ze.isPoints||Ze.isLine||Ze.isSprite))return;const Vt=Ze.material;if(Vt)if(Array.isArray(Vt))for(let rn=0;rn<Vt.length;rn++){const _n=Vt[rn];Ot(_n,vt,Ze),_t.add(_n)}else Ot(Vt,vt,Ze),_t.add(Vt)}),v=S.pop(),_t},this.compileAsync=function(Ee,We,vt=null){const _t=this.compile(Ee,We,vt);return new Promise(Ze=>{function Vt(){if(_t.forEach(function(rn){bt.get(rn).currentProgram.isReady()&&_t.delete(rn)}),_t.size===0){Ze(Ee);return}setTimeout(Vt,10)}Le.get("KHR_parallel_shader_compile")!==null?Vt():setTimeout(Vt,10)})};let Zn=null;function or(Ee){Zn&&Zn(Ee)}function wi(){xn.stop()}function ai(){xn.start()}const xn=new Wue;xn.setAnimationLoop(or),typeof self<"u"&&xn.setContext(self),this.setAnimationLoop=function(Ee){Zn=Ee,ht.setAnimationLoop(Ee),Ee===null?xn.stop():xn.start()},ht.addEventListener("sessionstart",wi),ht.addEventListener("sessionend",ai),this.render=function(Ee,We){if(We!==void 0&&We.isCamera!==!0){console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");return}if(M===!0)return;if(Ee.matrixWorldAutoUpdate===!0&&Ee.updateMatrixWorld(),We.parent===null&&We.matrixWorldAutoUpdate===!0&&We.updateMatrixWorld(),ht.enabled===!0&&ht.isPresenting===!0&&(ht.cameraAutoUpdate===!0&&ht.updateCamera(We),We=ht.getCamera()),Ee.isScene===!0&&Ee.onBeforeRender(x,Ee,We,k),v=le.get(Ee,S.length),v.init(We),S.push(v),ke.multiplyMatrices(We.projectionMatrix,We.matrixWorldInverse),Te.setFromProjectionMatrix(ke),ge=this.localClippingEnabled,Re=z.init(this.clippingPlanes,ge),_=pn.get(Ee,b.length),_.init(),b.push(_),ht.enabled===!0&&ht.isPresenting===!0){const Vt=x.xr.getDepthSensingMesh();Vt!==null&&sn(Vt,We,-1/0,x.sortObjects)}sn(Ee,We,0,x.sortObjects),_.finish(),x.sortObjects===!0&&_.sort(X,ae),Se=ht.enabled===!1||ht.isPresenting===!1||ht.hasDepthSensing()===!1,Se&&fe.addToRenderList(_,Ee),this.info.render.frame++,Re===!0&&z.beginShadows();const vt=v.state.shadowsArray;W.render(vt,Ee,We),Re===!0&&z.endShadows(),this.info.autoReset===!0&&this.info.reset();const _t=_.opaque,Ze=_.transmissive;if(v.setupLights(),We.isArrayCamera){const Vt=We.cameras;if(Ze.length>0)for(let rn=0,_n=Vt.length;rn<_n;rn++){const wn=Vt[rn];Un(_t,Ze,Ee,wn)}Se&&fe.render(Ee);for(let rn=0,_n=Vt.length;rn<_n;rn++){const wn=Vt[rn];zn(_,Ee,wn,wn.viewport)}}else Ze.length>0&&Un(_t,Ze,Ee,We),Se&&fe.render(Ee),zn(_,Ee,We);k!==null&&I===0&&(we.updateMultisampleRenderTarget(k),we.updateRenderTargetMipmap(k)),Ee.isScene===!0&&Ee.onAfterRender(x,Ee,We),Cn.resetDefaultState(),P=-1,U=null,S.pop(),S.length>0?(v=S[S.length-1],Re===!0&&z.setGlobalState(x.clippingPlanes,v.state.camera)):v=null,b.pop(),b.length>0?_=b[b.length-1]:_=null};function sn(Ee,We,vt,_t){if(Ee.visible===!1)return;if(Ee.layers.test(We.layers)){if(Ee.isGroup)vt=Ee.renderOrder;else if(Ee.isLOD)Ee.autoUpdate===!0&&Ee.update(We);else if(Ee.isLight)v.pushLight(Ee),Ee.castShadow&&v.pushShadow(Ee);else if(Ee.isSprite){if(!Ee.frustumCulled||Te.intersectsSprite(Ee)){_t&&wt.setFromMatrixPosition(Ee.matrixWorld).applyMatrix4(ke);const rn=ct.update(Ee),_n=Ee.material;_n.visible&&_.push(Ee,rn,_n,vt,wt.z,null)}}else if((Ee.isMesh||Ee.isLine||Ee.isPoints)&&(!Ee.frustumCulled||Te.intersectsObject(Ee))){const rn=ct.update(Ee),_n=Ee.material;if(_t&&(Ee.boundingSphere!==void 0?(Ee.boundingSphere===null&&Ee.computeBoundingSphere(),wt.copy(Ee.boundingSphere.center)):(rn.boundingSphere===null&&rn.computeBoundingSphere(),wt.copy(rn.boundingSphere.center)),wt.applyMatrix4(Ee.matrixWorld).applyMatrix4(ke)),Array.isArray(_n)){const wn=rn.groups;for(let ci=0,li=wn.length;ci<li;ci++){const Nn=wn[ci],yi=_n[Nn.materialIndex];yi&&yi.visible&&_.push(Ee,rn,yi,vt,wt.z,Nn)}}else _n.visible&&_.push(Ee,rn,_n,vt,wt.z,null)}}const Vt=Ee.children;for(let rn=0,_n=Vt.length;rn<_n;rn++)sn(Vt[rn],We,vt,_t)}function zn(Ee,We,vt,_t){const Ze=Ee.opaque,Vt=Ee.transmissive,rn=Ee.transparent;v.setupLightsView(vt),Re===!0&&z.setGlobalState(x.clippingPlanes,vt),_t&&dt.viewport(V.copy(_t)),Ze.length>0&&pi(Ze,We,vt),Vt.length>0&&pi(Vt,We,vt),rn.length>0&&pi(rn,We,vt),dt.buffers.depth.setTest(!0),dt.buffers.depth.setMask(!0),dt.buffers.color.setMask(!0),dt.setPolygonOffset(!1)}function Un(Ee,We,vt,_t){if((vt.isScene===!0?vt.overrideMaterial:null)!==null)return;v.state.transmissionRenderTarget[_t.id]===void 0&&(v.state.transmissionRenderTarget[_t.id]=new Ko(1,1,{generateMipmaps:!0,type:Le.has("EXT_color_buffer_half_float")||Le.has("EXT_color_buffer_float")?SE:lo,minFilter:Hg,samples:4,stencilBuffer:s,resolveDepthBuffer:!1,resolveStencilBuffer:!1,colorSpace:Br.workingColorSpace}));const Vt=v.state.transmissionRenderTarget[_t.id],rn=_t.viewport||V;Vt.setSize(rn.z*x.transmissionResolutionScale,rn.w*x.transmissionResolutionScale);const _n=x.getRenderTarget();x.setRenderTarget(Vt),x.getClearColor(Y),te=x.getClearAlpha(),te<1&&x.setClearColor(16777215,.5),x.clear(),Se&&fe.render(vt);const wn=x.toneMapping;x.toneMapping=Em;const ci=_t.viewport;if(_t.viewport!==void 0&&(_t.viewport=void 0),v.setupLightsView(_t),Re===!0&&z.setGlobalState(x.clippingPlanes,_t),pi(Ee,vt,_t),we.updateMultisampleRenderTarget(Vt),we.updateRenderTargetMipmap(Vt),Le.has("WEBGL_multisampled_render_to_texture")===!1){let li=!1;for(let Nn=0,yi=We.length;Nn<yi;Nn++){const cr=We[Nn],Ds=cr.object,xs=cr.geometry,Zi=cr.material,Jn=cr.group;if(Zi.side===Vc&&Ds.layers.test(_t.layers)){const Ci=Zi.side;Zi.side=$c,Zi.needsUpdate=!0,dr(Ds,vt,_t,xs,Zi,Jn),Zi.side=Ci,Zi.needsUpdate=!0,li=!0}}li===!0&&(we.updateMultisampleRenderTarget(Vt),we.updateRenderTargetMipmap(Vt))}x.setRenderTarget(_n),x.setClearColor(Y,te),ci!==void 0&&(_t.viewport=ci),x.toneMapping=wn}function pi(Ee,We,vt){const _t=We.isScene===!0?We.overrideMaterial:null;for(let Ze=0,Vt=Ee.length;Ze<Vt;Ze++){const rn=Ee[Ze],_n=rn.object,wn=rn.geometry,ci=rn.group;let li=rn.material;li.allowOverride===!0&&_t!==null&&(li=_t),_n.layers.test(vt.layers)&&dr(_n,We,vt,wn,li,ci)}}function dr(Ee,We,vt,_t,Ze,Vt){Ee.onBeforeRender(x,We,vt,_t,Ze,Vt),Ee.modelViewMatrix.multiplyMatrices(vt.matrixWorldInverse,Ee.matrixWorld),Ee.normalMatrix.getNormalMatrix(Ee.modelViewMatrix),Ze.onBeforeRender(x,We,vt,_t,Ee,Vt),Ze.transparent===!0&&Ze.side===Vc&&Ze.forceSinglePass===!1?(Ze.side=$c,Ze.needsUpdate=!0,x.renderBufferDirect(vt,We,_t,Ze,Ee,Vt),Ze.side=r0,Ze.needsUpdate=!0,x.renderBufferDirect(vt,We,_t,Ze,Ee,Vt),Ze.side=Vc):x.renderBufferDirect(vt,We,_t,Ze,Ee,Vt),Ee.onAfterRender(x,We,vt,_t,Ze,Vt)}function ni(Ee,We,vt){We.isScene!==!0&&(We=ye);const _t=bt.get(Ee),Ze=v.state.lights,Vt=v.state.shadowsArray,rn=Ze.state.version,_n=tn.getParameters(Ee,Ze.state,Vt,We,vt),wn=tn.getProgramCacheKey(_n);let ci=_t.programs;_t.environment=Ee.isMeshStandardMaterial?We.environment:null,_t.fog=We.fog,_t.envMap=(Ee.isMeshStandardMaterial?$e:he).get(Ee.envMap||_t.environment),_t.envMapRotation=_t.environment!==null&&Ee.envMap===null?We.environmentRotation:Ee.envMapRotation,ci===void 0&&(Ee.addEventListener("dispose",Ve),ci=new Map,_t.programs=ci);let li=ci.get(wn);if(li!==void 0){if(_t.currentProgram===li&&_t.lightsStateVersion===rn)return Nu(Ee,_n),li}else _n.uniforms=tn.getUniforms(Ee),Ee.onBeforeCompile(_n,x),li=tn.acquireProgram(_n,wn),ci.set(wn,li),_t.uniforms=_n.uniforms;const Nn=_t.uniforms;return(!Ee.isShaderMaterial&&!Ee.isRawShaderMaterial||Ee.clipping===!0)&&(Nn.clippingPlanes=z.uniform),Nu(Ee,_n),_t.needsLights=I0(Ee),_t.lightsStateVersion=rn,_t.needsLights&&(Nn.ambientLightColor.value=Ze.state.ambient,Nn.lightProbe.value=Ze.state.probe,Nn.directionalLights.value=Ze.state.directional,Nn.directionalLightShadows.value=Ze.state.directionalShadow,Nn.spotLights.value=Ze.state.spot,Nn.spotLightShadows.value=Ze.state.spotShadow,Nn.rectAreaLights.value=Ze.state.rectArea,Nn.ltc_1.value=Ze.state.rectAreaLTC1,Nn.ltc_2.value=Ze.state.rectAreaLTC2,Nn.pointLights.value=Ze.state.point,Nn.pointLightShadows.value=Ze.state.pointShadow,Nn.hemisphereLights.value=Ze.state.hemi,Nn.directionalShadowMap.value=Ze.state.directionalShadowMap,Nn.directionalShadowMatrix.value=Ze.state.directionalShadowMatrix,Nn.spotShadowMap.value=Ze.state.spotShadowMap,Nn.spotLightMatrix.value=Ze.state.spotLightMatrix,Nn.spotLightMap.value=Ze.state.spotLightMap,Nn.pointShadowMap.value=Ze.state.pointShadowMap,Nn.pointShadowMatrix.value=Ze.state.pointShadowMatrix),_t.currentProgram=li,_t.uniformsList=null,li}function $a(Ee){if(Ee.uniformsList===null){const We=Ee.currentProgram.getUniforms();Ee.uniformsList=L2.seqWithValue(We.seq,Ee.uniforms)}return Ee.uniformsList}function Nu(Ee,We){const vt=bt.get(Ee);vt.outputColorSpace=We.outputColorSpace,vt.batching=We.batching,vt.batchingColor=We.batchingColor,vt.instancing=We.instancing,vt.instancingColor=We.instancingColor,vt.instancingMorph=We.instancingMorph,vt.skinning=We.skinning,vt.morphTargets=We.morphTargets,vt.morphNormals=We.morphNormals,vt.morphColors=We.morphColors,vt.morphTargetsCount=We.morphTargetsCount,vt.numClippingPlanes=We.numClippingPlanes,vt.numIntersection=We.numClipIntersection,vt.vertexAlphas=We.vertexAlphas,vt.vertexTangents=We.vertexTangents,vt.toneMapping=We.toneMapping}function Ef(Ee,We,vt,_t,Ze){We.isScene!==!0&&(We=ye),we.resetTextureUnits();const Vt=We.fog,rn=_t.isMeshStandardMaterial?We.environment:null,_n=k===null?x.outputColorSpace:k.isXRRenderTarget===!0?k.texture.colorSpace:a0,wn=(_t.isMeshStandardMaterial?$e:he).get(_t.envMap||rn),ci=_t.vertexColors===!0&&!!vt.attributes.color&&vt.attributes.color.itemSize===4,li=!!vt.attributes.tangent&&(!!_t.normalMap||_t.anisotropy>0),Nn=!!vt.morphAttributes.position,yi=!!vt.morphAttributes.normal,cr=!!vt.morphAttributes.color;let Ds=Em;_t.toneMapped&&(k===null||k.isXRRenderTarget===!0)&&(Ds=x.toneMapping);const xs=vt.morphAttributes.position||vt.morphAttributes.normal||vt.morphAttributes.color,Zi=xs!==void 0?xs.length:0,Jn=bt.get(_t),Ci=v.state.lights;if(Re===!0&&(ge===!0||Ee!==U)){const Ws=Ee===U&&_t.id===P;z.setState(_t,Ee,Ws)}let Hn=!1;_t.version===Jn.__version?(Jn.needsLights&&Jn.lightsStateVersion!==Ci.state.version||Jn.outputColorSpace!==_n||Ze.isBatchedMesh&&Jn.batching===!1||!Ze.isBatchedMesh&&Jn.batching===!0||Ze.isBatchedMesh&&Jn.batchingColor===!0&&Ze.colorTexture===null||Ze.isBatchedMesh&&Jn.batchingColor===!1&&Ze.colorTexture!==null||Ze.isInstancedMesh&&Jn.instancing===!1||!Ze.isInstancedMesh&&Jn.instancing===!0||Ze.isSkinnedMesh&&Jn.skinning===!1||!Ze.isSkinnedMesh&&Jn.skinning===!0||Ze.isInstancedMesh&&Jn.instancingColor===!0&&Ze.instanceColor===null||Ze.isInstancedMesh&&Jn.instancingColor===!1&&Ze.instanceColor!==null||Ze.isInstancedMesh&&Jn.instancingMorph===!0&&Ze.morphTexture===null||Ze.isInstancedMesh&&Jn.instancingMorph===!1&&Ze.morphTexture!==null||Jn.envMap!==wn||_t.fog===!0&&Jn.fog!==Vt||Jn.numClippingPlanes!==void 0&&(Jn.numClippingPlanes!==z.numPlanes||Jn.numIntersection!==z.numIntersection)||Jn.vertexAlphas!==ci||Jn.vertexTangents!==li||Jn.morphTargets!==Nn||Jn.morphNormals!==yi||Jn.morphColors!==cr||Jn.toneMapping!==Ds||Jn.morphTargetsCount!==Zi)&&(Hn=!0):(Hn=!0,Jn.__version=_t.version);let Jo=Jn.currentProgram;Hn===!0&&(Jo=ni(_t,We,Ze));let Ql=!1,uo=!1,Th=!1;const ds=Jo.getUniforms(),Sn=Jn.uniforms;if(dt.useProgram(Jo.program)&&(Ql=!0,uo=!0,Th=!0),_t.id!==P&&(P=_t.id,uo=!0),Ql||U!==Ee){dt.buffers.depth.getReversed()?(_e.copy(Ee.projectionMatrix),oAe(_e),cAe(_e),ds.setValue(pe,"projectionMatrix",_e)):ds.setValue(pe,"projectionMatrix",Ee.projectionMatrix),ds.setValue(pe,"viewMatrix",Ee.matrixWorldInverse);const Yn=ds.map.cameraPosition;Yn!==void 0&&Yn.setValue(pe,gt.setFromMatrixPosition(Ee.matrixWorld)),rt.logarithmicDepthBuffer&&ds.setValue(pe,"logDepthBufFC",2/(Math.log(Ee.far+1)/Math.LN2)),(_t.isMeshPhongMaterial||_t.isMeshToonMaterial||_t.isMeshLambertMaterial||_t.isMeshBasicMaterial||_t.isMeshStandardMaterial||_t.isShaderMaterial)&&ds.setValue(pe,"isOrthographic",Ee.isOrthographicCamera===!0),U!==Ee&&(U=Ee,uo=!0,Th=!0)}if(Ze.isSkinnedMesh){ds.setOptional(pe,Ze,"bindMatrix"),ds.setOptional(pe,Ze,"bindMatrixInverse");const Ws=Ze.skeleton;Ws&&(Ws.boneTexture===null&&Ws.computeBoneTexture(),ds.setValue(pe,"boneTexture",Ws.boneTexture,we))}Ze.isBatchedMesh&&(ds.setOptional(pe,Ze,"batchingTexture"),ds.setValue(pe,"batchingTexture",Ze._matricesTexture,we),ds.setOptional(pe,Ze,"batchingIdTexture"),ds.setValue(pe,"batchingIdTexture",Ze._indirectTexture,we),ds.setOptional(pe,Ze,"batchingColorTexture"),Ze._colorsTexture!==null&&ds.setValue(pe,"batchingColorTexture",Ze._colorsTexture,we));const ho=vt.morphAttributes;if((ho.position!==void 0||ho.normal!==void 0||ho.color!==void 0)&&Ne.update(Ze,vt,Jo),(uo||Jn.receiveShadow!==Ze.receiveShadow)&&(Jn.receiveShadow=Ze.receiveShadow,ds.setValue(pe,"receiveShadow",Ze.receiveShadow)),_t.isMeshGouraudMaterial&&_t.envMap!==null&&(Sn.envMap.value=wn,Sn.flipEnvMap.value=wn.isCubeTexture&&wn.isRenderTargetTexture===!1?-1:1),_t.isMeshStandardMaterial&&_t.envMap===null&&We.environment!==null&&(Sn.envMapIntensity.value=We.environmentIntensity),uo&&(ds.setValue(pe,"toneMappingExposure",x.toneMappingExposure),Jn.needsLights&&Fp(Sn,Th),Vt&&_t.fog===!0&&Ht.refreshFogUniforms(Sn,Vt),Ht.refreshMaterialUniforms(Sn,_t,K,J,v.state.transmissionRenderTarget[Ee.id]),L2.upload(pe,$a(Jn),Sn,we)),_t.isShaderMaterial&&_t.uniformsNeedUpdate===!0&&(L2.upload(pe,$a(Jn),Sn,we),_t.uniformsNeedUpdate=!1),_t.isSpriteMaterial&&ds.setValue(pe,"center",Ze.center),ds.setValue(pe,"modelViewMatrix",Ze.modelViewMatrix),ds.setValue(pe,"normalMatrix",Ze.normalMatrix),ds.setValue(pe,"modelMatrix",Ze.matrixWorld),_t.isShaderMaterial||_t.isRawShaderMaterial){const Ws=_t.uniformsGroups;for(let Yn=0,Il=Ws.length;Yn<Il;Yn++){const ma=Ws[Yn];je.update(ma,Jo),je.bind(ma,Jo)}}return Jo}function Fp(Ee,We){Ee.ambientLightColor.needsUpdate=We,Ee.lightProbe.needsUpdate=We,Ee.directionalLights.needsUpdate=We,Ee.directionalLightShadows.needsUpdate=We,Ee.pointLights.needsUpdate=We,Ee.pointLightShadows.needsUpdate=We,Ee.spotLights.needsUpdate=We,Ee.spotLightShadows.needsUpdate=We,Ee.rectAreaLights.needsUpdate=We,Ee.hemisphereLights.needsUpdate=We}function I0(Ee){return Ee.isMeshLambertMaterial||Ee.isMeshToonMaterial||Ee.isMeshPhongMaterial||Ee.isMeshStandardMaterial||Ee.isShadowMaterial||Ee.isShaderMaterial&&Ee.lights===!0}this.getActiveCubeFace=function(){return R},this.getActiveMipmapLevel=function(){return I},this.getRenderTarget=function(){return k},this.setRenderTargetTextures=function(Ee,We,vt){const _t=bt.get(Ee);_t.__autoAllocateDepthBuffer=Ee.resolveDepthBuffer===!1,_t.__autoAllocateDepthBuffer===!1&&(_t.__useRenderToTexture=!1),bt.get(Ee.texture).__webglTexture=We,bt.get(Ee.depthTexture).__webglTexture=_t.__autoAllocateDepthBuffer?void 0:vt,_t.__hasExternalTextures=!0},this.setRenderTargetFramebuffer=function(Ee,We){const vt=bt.get(Ee);vt.__webglFramebuffer=We,vt.__useDefaultFramebuffer=We===void 0};const Sf=pe.createFramebuffer();this.setRenderTarget=function(Ee,We=0,vt=0){k=Ee,R=We,I=vt;let _t=!0,Ze=null,Vt=!1,rn=!1;if(Ee){const wn=bt.get(Ee);if(wn.__useDefaultFramebuffer!==void 0)dt.bindFramebuffer(pe.FRAMEBUFFER,null),_t=!1;else if(wn.__webglFramebuffer===void 0)we.setupRenderTarget(Ee);else if(wn.__hasExternalTextures)we.rebindTextures(Ee,bt.get(Ee.texture).__webglTexture,bt.get(Ee.depthTexture).__webglTexture);else if(Ee.depthBuffer){const Nn=Ee.depthTexture;if(wn.__boundDepthTexture!==Nn){if(Nn!==null&&bt.has(Nn)&&(Ee.width!==Nn.image.width||Ee.height!==Nn.image.height))throw new Error("WebGLRenderTarget: Attached DepthTexture is initialized to the incorrect size.");we.setupDepthRenderbuffer(Ee)}}const ci=Ee.texture;(ci.isData3DTexture||ci.isDataArrayTexture||ci.isCompressedArrayTexture)&&(rn=!0);const li=bt.get(Ee).__webglFramebuffer;Ee.isWebGLCubeRenderTarget?(Array.isArray(li[We])?Ze=li[We][vt]:Ze=li[We],Vt=!0):Ee.samples>0&&we.useMultisampledRTT(Ee)===!1?Ze=bt.get(Ee).__webglMultisampledFramebuffer:Array.isArray(li)?Ze=li[vt]:Ze=li,V.copy(Ee.viewport),$.copy(Ee.scissor),q=Ee.scissorTest}else V.copy(ce).multiplyScalar(K).floor(),$.copy(Me).multiplyScalar(K).floor(),q=Fe;if(vt!==0&&(Ze=Sf),dt.bindFramebuffer(pe.FRAMEBUFFER,Ze)&&_t&&dt.drawBuffers(Ee,Ze),dt.viewport(V),dt.scissor($),dt.setScissorTest(q),Vt){const wn=bt.get(Ee.texture);pe.framebufferTexture2D(pe.FRAMEBUFFER,pe.COLOR_ATTACHMENT0,pe.TEXTURE_CUBE_MAP_POSITIVE_X+We,wn.__webglTexture,vt)}else if(rn){const wn=bt.get(Ee.texture),ci=We;pe.framebufferTextureLayer(pe.FRAMEBUFFER,pe.COLOR_ATTACHMENT0,wn.__webglTexture,vt,ci)}else if(Ee!==null&&vt!==0){const wn=bt.get(Ee.texture);pe.framebufferTexture2D(pe.FRAMEBUFFER,pe.COLOR_ATTACHMENT0,pe.TEXTURE_2D,wn.__webglTexture,vt)}P=-1},this.readRenderTargetPixels=function(Ee,We,vt,_t,Ze,Vt,rn){if(!(Ee&&Ee.isWebGLRenderTarget)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");return}let _n=bt.get(Ee).__webglFramebuffer;if(Ee.isWebGLCubeRenderTarget&&rn!==void 0&&(_n=_n[rn]),_n){dt.bindFramebuffer(pe.FRAMEBUFFER,_n);try{const wn=Ee.texture,ci=wn.format,li=wn.type;if(!rt.textureFormatReadable(ci)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");return}if(!rt.textureTypeReadable(li)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");return}We>=0&&We<=Ee.width-_t&&vt>=0&&vt<=Ee.height-Ze&&pe.readPixels(We,vt,_t,Ze,Tt.convert(ci),Tt.convert(li),Vt)}finally{const wn=k!==null?bt.get(k).__webglFramebuffer:null;dt.bindFramebuffer(pe.FRAMEBUFFER,wn)}}},this.readRenderTargetPixelsAsync=async function(Ee,We,vt,_t,Ze,Vt,rn){if(!(Ee&&Ee.isWebGLRenderTarget))throw new Error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");let _n=bt.get(Ee).__webglFramebuffer;if(Ee.isWebGLCubeRenderTarget&&rn!==void 0&&(_n=_n[rn]),_n)if(We>=0&&We<=Ee.width-_t&&vt>=0&&vt<=Ee.height-Ze){dt.bindFramebuffer(pe.FRAMEBUFFER,_n);const wn=Ee.texture,ci=wn.format,li=wn.type;if(!rt.textureFormatReadable(ci))throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: renderTarget is not in RGBA or implementation defined format.");if(!rt.textureTypeReadable(li))throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: renderTarget is not in UnsignedByteType or implementation defined type.");const Nn=pe.createBuffer();pe.bindBuffer(pe.PIXEL_PACK_BUFFER,Nn),pe.bufferData(pe.PIXEL_PACK_BUFFER,Vt.byteLength,pe.STREAM_READ),pe.readPixels(We,vt,_t,Ze,Tt.convert(ci),Tt.convert(li),0);const yi=k!==null?bt.get(k).__webglFramebuffer:null;dt.bindFramebuffer(pe.FRAMEBUFFER,yi);const cr=pe.fenceSync(pe.SYNC_GPU_COMMANDS_COMPLETE,0);return pe.flush(),await aAe(pe,cr,4),pe.bindBuffer(pe.PIXEL_PACK_BUFFER,Nn),pe.getBufferSubData(pe.PIXEL_PACK_BUFFER,0,Vt),pe.deleteBuffer(Nn),pe.deleteSync(cr),Vt}else throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: requested read bounds are out of range.")},this.copyFramebufferToTexture=function(Ee,We=null,vt=0){const _t=Math.pow(2,-vt),Ze=Math.floor(Ee.image.width*_t),Vt=Math.floor(Ee.image.height*_t),rn=We!==null?We.x:0,_n=We!==null?We.y:0;we.setTexture2D(Ee,0),pe.copyTexSubImage2D(pe.TEXTURE_2D,vt,0,0,rn,_n,Ze,Vt),dt.unbindTexture()};const Tf=pe.createFramebuffer(),Iu=pe.createFramebuffer();this.copyTextureToTexture=function(Ee,We,vt=null,_t=null,Ze=0,Vt=null){Vt===null&&(Ze!==0?(P2("WebGLRenderer: copyTextureToTexture function signature has changed to support src and dst mipmap levels."),Vt=Ze,Ze=0):Vt=0);let rn,_n,wn,ci,li,Nn,yi,cr,Ds;const xs=Ee.isCompressedTexture?Ee.mipmaps[Vt]:Ee.image;if(vt!==null)rn=vt.max.x-vt.min.x,_n=vt.max.y-vt.min.y,wn=vt.isBox3?vt.max.z-vt.min.z:1,ci=vt.min.x,li=vt.min.y,Nn=vt.isBox3?vt.min.z:0;else{const ho=Math.pow(2,-Ze);rn=Math.floor(xs.width*ho),_n=Math.floor(xs.height*ho),Ee.isDataArrayTexture?wn=xs.depth:Ee.isData3DTexture?wn=Math.floor(xs.depth*ho):wn=1,ci=0,li=0,Nn=0}_t!==null?(yi=_t.x,cr=_t.y,Ds=_t.z):(yi=0,cr=0,Ds=0);const Zi=Tt.convert(We.format),Jn=Tt.convert(We.type);let Ci;We.isData3DTexture?(we.setTexture3D(We,0),Ci=pe.TEXTURE_3D):We.isDataArrayTexture||We.isCompressedArrayTexture?(we.setTexture2DArray(We,0),Ci=pe.TEXTURE_2D_ARRAY):(we.setTexture2D(We,0),Ci=pe.TEXTURE_2D),pe.pixelStorei(pe.UNPACK_FLIP_Y_WEBGL,We.flipY),pe.pixelStorei(pe.UNPACK_PREMULTIPLY_ALPHA_WEBGL,We.premultiplyAlpha),pe.pixelStorei(pe.UNPACK_ALIGNMENT,We.unpackAlignment);const Hn=pe.getParameter(pe.UNPACK_ROW_LENGTH),Jo=pe.getParameter(pe.UNPACK_IMAGE_HEIGHT),Ql=pe.getParameter(pe.UNPACK_SKIP_PIXELS),uo=pe.getParameter(pe.UNPACK_SKIP_ROWS),Th=pe.getParameter(pe.UNPACK_SKIP_IMAGES);pe.pixelStorei(pe.UNPACK_ROW_LENGTH,xs.width),pe.pixelStorei(pe.UNPACK_IMAGE_HEIGHT,xs.height),pe.pixelStorei(pe.UNPACK_SKIP_PIXELS,ci),pe.pixelStorei(pe.UNPACK_SKIP_ROWS,li),pe.pixelStorei(pe.UNPACK_SKIP_IMAGES,Nn);const ds=Ee.isDataArrayTexture||Ee.isData3DTexture,Sn=We.isDataArrayTexture||We.isData3DTexture;if(Ee.isDepthTexture){const ho=bt.get(Ee),Ws=bt.get(We),Yn=bt.get(ho.__renderTarget),Il=bt.get(Ws.__renderTarget);dt.bindFramebuffer(pe.READ_FRAMEBUFFER,Yn.__webglFramebuffer),dt.bindFramebuffer(pe.DRAW_FRAMEBUFFER,Il.__webglFramebuffer);for(let ma=0;ma<wn;ma++)ds&&(pe.framebufferTextureLayer(pe.READ_FRAMEBUFFER,pe.COLOR_ATTACHMENT0,bt.get(Ee).__webglTexture,Ze,Nn+ma),pe.framebufferTextureLayer(pe.DRAW_FRAMEBUFFER,pe.COLOR_ATTACHMENT0,bt.get(We).__webglTexture,Vt,Ds+ma)),pe.blitFramebuffer(ci,li,rn,_n,yi,cr,rn,_n,pe.DEPTH_BUFFER_BIT,pe.NEAREST);dt.bindFramebuffer(pe.READ_FRAMEBUFFER,null),dt.bindFramebuffer(pe.DRAW_FRAMEBUFFER,null)}else if(Ze!==0||Ee.isRenderTargetTexture||bt.has(Ee)){const ho=bt.get(Ee),Ws=bt.get(We);dt.bindFramebuffer(pe.READ_FRAMEBUFFER,Tf),dt.bindFramebuffer(pe.DRAW_FRAMEBUFFER,Iu);for(let Yn=0;Yn<wn;Yn++)ds?pe.framebufferTextureLayer(pe.READ_FRAMEBUFFER,pe.COLOR_ATTACHMENT0,ho.__webglTexture,Ze,Nn+Yn):pe.framebufferTexture2D(pe.READ_FRAMEBUFFER,pe.COLOR_ATTACHMENT0,pe.TEXTURE_2D,ho.__webglTexture,Ze),Sn?pe.framebufferTextureLayer(pe.DRAW_FRAMEBUFFER,pe.COLOR_ATTACHMENT0,Ws.__webglTexture,Vt,Ds+Yn):pe.framebufferTexture2D(pe.DRAW_FRAMEBUFFER,pe.COLOR_ATTACHMENT0,pe.TEXTURE_2D,Ws.__webglTexture,Vt),Ze!==0?pe.blitFramebuffer(ci,li,rn,_n,yi,cr,rn,_n,pe.COLOR_BUFFER_BIT,pe.NEAREST):Sn?pe.copyTexSubImage3D(Ci,Vt,yi,cr,Ds+Yn,ci,li,rn,_n):pe.copyTexSubImage2D(Ci,Vt,yi,cr,ci,li,rn,_n);dt.bindFramebuffer(pe.READ_FRAMEBUFFER,null),dt.bindFramebuffer(pe.DRAW_FRAMEBUFFER,null)}else Sn?Ee.isDataTexture||Ee.isData3DTexture?pe.texSubImage3D(Ci,Vt,yi,cr,Ds,rn,_n,wn,Zi,Jn,xs.data):We.isCompressedArrayTexture?pe.compressedTexSubImage3D(Ci,Vt,yi,cr,Ds,rn,_n,wn,Zi,xs.data):pe.texSubImage3D(Ci,Vt,yi,cr,Ds,rn,_n,wn,Zi,Jn,xs):Ee.isDataTexture?pe.texSubImage2D(pe.TEXTURE_2D,Vt,yi,cr,rn,_n,Zi,Jn,xs.data):Ee.isCompressedTexture?pe.compressedTexSubImage2D(pe.TEXTURE_2D,Vt,yi,cr,xs.width,xs.height,Zi,xs.data):pe.texSubImage2D(pe.TEXTURE_2D,Vt,yi,cr,rn,_n,Zi,Jn,xs);pe.pixelStorei(pe.UNPACK_ROW_LENGTH,Hn),pe.pixelStorei(pe.UNPACK_IMAGE_HEIGHT,Jo),pe.pixelStorei(pe.UNPACK_SKIP_PIXELS,Ql),pe.pixelStorei(pe.UNPACK_SKIP_ROWS,uo),pe.pixelStorei(pe.UNPACK_SKIP_IMAGES,Th),Vt===0&&We.generateMipmaps&&pe.generateMipmap(Ci),dt.unbindTexture()},this.copyTextureToTexture3D=function(Ee,We,vt=null,_t=null,Ze=0){return P2('WebGLRenderer: copyTextureToTexture3D function has been deprecated. Use "copyTextureToTexture" instead.'),this.copyTextureToTexture(Ee,We,vt,_t,Ze)},this.initRenderTarget=function(Ee){bt.get(Ee).__webglFramebuffer===void 0&&we.setupRenderTarget(Ee)},this.initTexture=function(Ee){Ee.isCubeTexture?we.setTextureCube(Ee,0):Ee.isData3DTexture?we.setTexture3D(Ee,0):Ee.isDataArrayTexture||Ee.isCompressedArrayTexture?we.setTexture2DArray(Ee,0):we.setTexture2D(Ee,0),dt.unbindTexture()},this.resetState=function(){R=0,I=0,k=null,dt.reset(),Cn.reset()},typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}get coordinateSystem(){return lp}get outputColorSpace(){return this._outputColorSpace}set outputColorSpace(e){this._outputColorSpace=e;const n=this.getContext();n.drawingBufferColorSpace=Br._getDrawingBufferColorSpace(e),n.unpackColorSpace=Br._getUnpackColorSpace()}}const bPe=Object.freeze(Object.defineProperty({__proto__:null,ACESFilmicToneMapping:j7,AddEquation:db,AddOperation:Ele,AdditiveAnimationBlendMode:K7,AdditiveBlending:WV,AgXToneMapping:Cle,AlphaFormat:$7,AlwaysCompare:zle,AlwaysDepth:KL,AlwaysStencilFunc:ZV,AmbientLight:Due,AnimationAction:Gue,AnimationClip:iN,AnimationLoader:PRe,AnimationMixer:lMe,AnimationObjectGroup:oMe,AnimationUtils:ORe,ArcCurve:oue,ArrayCamera:jue,ArrowHelper:NMe,AttachedBindMode:XV,Audio:Hue,AudioAnalyser:ZRe,AudioContext:_W,AudioListener:YRe,AudioLoader:qRe,AxesHelper:IMe,BackSide:$c,BasicDepthPacking:TE,BasicShadowMap:tle,BatchedMesh:tue,Bone:tW,BooleanKeyframeTrack:D1,Box2:que,Box3:Su,Box3Helper:MMe,BoxGeometry:P1,BoxHelper:RMe,BufferAttribute:ar,BufferGeometry:tr,BufferGeometryLoader:zue,ByteType:V7,Cache:t_,Camera:DI,CameraHelper:AMe,CanvasTexture:sue,CapsuleGeometry:dF,CatmullRomCurve3:cue,CineonToneMapping:xle,CircleGeometry:fF,ClampToEdgeWrapping:cp,Clock:yW,Color:bn,ColorKeyframeTrack:mW,ColorManagement:Br,CompressedArrayTexture:ZAe,CompressedCubeTexture:JAe,CompressedTexture:hF,CompressedTextureLoader:DRe,ConeGeometry:BI,ConstantAlphaFactor:_le,ConstantColorFactor:gle,Controls:PMe,CubeCamera:Yle,CubeReflectionMapping:T_,CubeRefractionMapping:eE,CubeTexture:LI,CubeTextureLoader:LRe,CubeUVReflectionMapping:YA,CubicBezierCurve:rW,CubicBezierCurve3:lue,CubicInterpolant:Aue,CullFaceBack:$V,CullFaceFront:ele,CullFaceFrontBack:oCe,CullFaceNone:Qce,Curve:km,CurvePath:hue,CustomBlending:nle,CustomToneMapping:wle,CylinderGeometry:UI,Cylindrical:vMe,Data3DTexture:sF,DataArrayTexture:PI,DataTexture:lf,DataTextureLoader:URe,DataUtils:TAe,DecrementStencilOp:ECe,DecrementWrapStencilOp:TCe,DefaultLoadingManager:Oue,DepthArrayTexture:QAe,DepthFormat:FC,DepthStencilFormat:XT,DepthTexture:JA,DetachedBindMode:Rle,DirectionalLight:Pue,DirectionalLightHelper:CMe,DiscreteInterpolant:Rue,DodecahedronGeometry:pF,DoubleSide:Vc,DstAlphaFactor:hle,DstColorFactor:fle,DynamicCopyUsage:UCe,DynamicDrawUsage:JV,DynamicReadUsage:PCe,EdgesGeometry:aue,EllipseCurve:mF,EqualCompare:Lle,EqualDepth:ZL,EqualStencilFunc:ACe,EquirectangularReflectionMapping:VO,EquirectangularRefractionMapping:GO,Euler:dd,EventDispatcher:_f,ExtrudeGeometry:gF,FileLoader:x_,Float16BufferAttribute:OAe,Float32BufferAttribute:qn,FloatType:vu,Fog:oF,FogExp2:aF,FramebufferTexture:XAe,FrontSide:r0,Frustum:ZA,FrustumArray:uF,GLBufferAttribute:mMe,GLSL1:FCe,GLSL3:QV,GreaterCompare:Ule,GreaterDepth:QL,GreaterEqualCompare:Fle,GreaterEqualDepth:JL,GreaterEqualStencilFunc:NCe,GreaterStencilFunc:MCe,GridHelper:xMe,Group:_T,HalfFloatType:SE,HemisphereLight:Nue,HemisphereLightHelper:TMe,IcosahedronGeometry:vF,ImageBitmapLoader:GRe,ImageLoader:rN,ImageUtils:Gle,IncrementStencilOp:bCe,IncrementWrapStencilOp:SCe,InstancedBufferAttribute:GC,InstancedBufferGeometry:Fue,InstancedInterleavedBuffer:pMe,InstancedMesh:eue,Int16BufferAttribute:RAe,Int32BufferAttribute:MAe,Int8BufferAttribute:wAe,IntType:JB,InterleavedBuffer:cF,InterleavedBufferAttribute:ZT,Interpolant:jI,InterpolateDiscrete:$O,InterpolateLinear:AU,InterpolateSmooth:k2,InterpolationSamplingMode:HCe,InterpolationSamplingType:jCe,InvertStencilOp:xCe,KeepStencilOp:JS,KeyframeTrack:Np,LOD:Jle,LatheGeometry:_F,Layers:jC,LessCompare:Dle,LessDepth:XL,LessEqualCompare:X7,LessEqualDepth:YT,LessEqualStencilFunc:RCe,LessStencilFunc:CCe,Light:AE,LightProbe:Bue,Line:tE,Line3:_Me,LineBasicMaterial:yh,LineCurve:sW,LineCurve3:uue,LineDashedMaterial:xue,LineLoop:nue,LineSegments:g0,LinearFilter:Ca,LinearInterpolant:pW,LinearMipMapLinearFilter:hCe,LinearMipMapNearestFilter:uCe,LinearMipmapLinearFilter:Hg,LinearMipmapNearestFilter:JM,LinearSRGBColorSpace:a0,LinearToneMapping:Sle,LinearTransfer:YO,Loader:Ed,LoaderUtils:rG,LoadingManager:gW,LoopOnce:Mle,LoopPingPong:Nle,LoopRepeat:Ole,MOUSE:sCe,Material:rl,MaterialLoader:wF,MathUtils:jle,Matrix2:TW,Matrix3:Qi,Matrix4:gi,MaxEquation:ale,Mesh:Io,MeshBasicMaterial:wE,MeshDepthMaterial:hW,MeshDistanceMaterial:dW,MeshLambertMaterial:Sue,MeshMatcapMaterial:Tue,MeshNormalMaterial:uW,MeshPhongMaterial:bue,MeshPhysicalMaterial:yue,MeshStandardMaterial:lW,MeshToonMaterial:Eue,MinEquation:sle,MirroredRepeatWrapping:qO,MixOperation:ble,MultiplyBlending:KV,MultiplyOperation:NI,NearestFilter:Va,NearestMipMapLinearFilter:lCe,NearestMipMapNearestFilter:cCe,NearestMipmapLinearFilter:Bw,NearestMipmapNearestFilter:H7,NeutralToneMapping:Ale,NeverCompare:Ple,NeverDepth:YL,NeverStencilFunc:wCe,NoBlending:Eu,NoColorSpace:gm,NoToneMapping:Em,NormalAnimationBlendMode:iF,NormalBlending:AT,NotEqualCompare:Ble,NotEqualDepth:eU,NotEqualStencilFunc:OCe,NumberKeyframeTrack:tN,Object3D:Wr,ObjectLoader:HRe,ObjectSpaceNormalMap:kle,OctahedronGeometry:FI,OneFactor:cle,OneMinusConstantAlphaFactor:yle,OneMinusConstantColorFactor:vle,OneMinusDstAlphaFactor:dle,OneMinusDstColorFactor:ple,OneMinusSrcAlphaFactor:WL,OneMinusSrcColorFactor:ule,OrthographicCamera:VI,PCFShadowMap:XB,PCFSoftShadowMap:ZM,PMREMGenerator:oG,Path:NU,PerspectiveCamera:Hc,Plane:nb,PlaneGeometry:QA,PlaneHelper:OMe,PointLight:kue,PointLightHelper:EMe,Points:iue,PointsMaterial:nW,PolarGridHelper:wMe,PolyhedronGeometry:CE,PositionalAudio:XRe,PropertyBinding:Jr,PropertyMixer:Vue,QuadraticBezierCurve:aW,QuadraticBezierCurve3:oW,Quaternion:mh,QuaternionKeyframeTrack:HI,QuaternionLinearInterpolant:Mue,RED_GREEN_RGTC2_Format:wU,RED_RGTC1_Format:Y7,REVISION:WA,RGBADepthPacking:Ile,RGBAFormat:Wc,RGBAIntegerFormat:kI,RGBA_ASTC_10x10_Format:yU,RGBA_ASTC_10x5_Format:gU,RGBA_ASTC_10x6_Format:vU,RGBA_ASTC_10x8_Format:_U,RGBA_ASTC_12x10_Format:bU,RGBA_ASTC_12x12_Format:EU,RGBA_ASTC_4x4_Format:cU,RGBA_ASTC_5x4_Format:lU,RGBA_ASTC_5x5_Format:uU,RGBA_ASTC_6x5_Format:hU,RGBA_ASTC_6x6_Format:dU,RGBA_ASTC_8x5_Format:fU,RGBA_ASTC_8x6_Format:pU,RGBA_ASTC_8x8_Format:mU,RGBA_BPTC_Format:iO,RGBA_ETC2_EAC_Format:oU,RGBA_PVRTC_2BPPV1_Format:rU,RGBA_PVRTC_4BPPV1_Format:iU,RGBA_S3TC_DXT1_Format:eO,RGBA_S3TC_DXT3_Format:tO,RGBA_S3TC_DXT5_Format:nO,RGBDepthPacking:gCe,RGBFormat:W7,RGBIntegerFormat:dCe,RGB_BPTC_SIGNED_Format:SU,RGB_BPTC_UNSIGNED_Format:TU,RGB_ETC1_Format:sU,RGB_ETC2_Format:aU,RGB_PVRTC_2BPPV1_Format:nU,RGB_PVRTC_4BPPV1_Format:tU,RGB_S3TC_DXT1_Format:QM,RGDepthPacking:vCe,RGFormat:tF,RGIntegerFormat:nF,RawShaderMaterial:_ue,Ray:XA,Raycaster:SW,RectAreaLight:Lue,RedFormat:KA,RedIntegerFormat:II,ReinhardToneMapping:Tle,RenderTarget:rF,RenderTarget3D:uMe,RenderTargetArray:hMe,RepeatWrapping:UC,ReplaceStencilOp:yCe,ReverseSubtractEquation:rle,RingGeometry:yF,SIGNED_RED_GREEN_RGTC2_Format:CU,SIGNED_RED_RGTC1_Format:xU,SRGBColorSpace:ls,SRGBTransfer:Ns,Scene:VC,ShaderChunk:rr,ShaderLib:dm,ShaderMaterial:qa,ShadowMaterial:vue,Shape:MT,ShapeGeometry:bF,ShapePath:kMe,ShapeUtils:ym,ShortType:G7,Skeleton:lF,SkeletonHelper:bMe,SkinnedMesh:Qle,Source:Eb,Sphere:Kl,SphereGeometry:zI,Spherical:gMe,SphericalHarmonics3:Uue,SplineCurve:cW,SpotLight:Iue,SpotLightHelper:yMe,Sprite:Zle,SpriteMaterial:eW,SrcAlphaFactor:$L,SrcAlphaSaturateFactor:mle,SrcColorFactor:lle,StaticCopyUsage:LCe,StaticDrawUsage:KO,StaticReadUsage:kCe,StereoCamera:$Re,StreamCopyUsage:BCe,StreamDrawUsage:ICe,StreamReadUsage:DCe,StringKeyframeTrack:L1,SubtractEquation:ile,SubtractiveBlending:YV,TOUCH:aCe,TangentSpaceNormalMap:xE,TetrahedronGeometry:EF,Texture:Ga,TextureLoader:BRe,TextureUtils:FMe,TimestampQuery:zCe,TorusGeometry:SF,TorusKnotGeometry:TF,Triangle:td,TriangleFanDrawMode:mCe,TriangleStripDrawMode:pCe,TrianglesDrawMode:fCe,TubeGeometry:xF,UVMapping:ZB,Uint16BufferAttribute:J7,Uint32BufferAttribute:Q7,Uint8BufferAttribute:CAe,Uint8ClampedBufferAttribute:AAe,Uniform:vn,UniformsGroup:fMe,UniformsLib:En,UniformsUtils:Wle,UnsignedByteType:lo,UnsignedInt248Type:KT,UnsignedInt5999Type:q7,UnsignedIntType:s0,UnsignedShort4444Type:QB,UnsignedShort5551Type:eF,UnsignedShortType:BC,VSMShadowMap:lm,Vector2:xt,Vector3:Oe,Vector4:zr,VectorKeyframeTrack:nN,VideoFrameTexture:KAe,VideoTexture:rue,WebGL3DRenderTarget:fAe,WebGLArrayRenderTarget:dAe,WebGLCoordinateSystem:lp,WebGLCubeRenderTarget:Kle,WebGLRenderTarget:Ko,WebGLRenderer:Que,WebGLUtils:Jue,WebGPUCoordinateSystem:XO,WebXRController:D2,WireframeGeometry:gue,WrapAroundEnding:WO,ZeroCurvatureEnding:gT,ZeroFactor:ole,ZeroSlopeEnding:vT,ZeroStencilOp:_Ce,createCanvasElement:Vle},Symbol.toStringTag,{value:"Module"}));var ehe={exports:{}},hr={},wW=Symbol.for("react.transitional.element"),EPe=Symbol.for("react.portal"),SPe=Symbol.for("react.fragment"),TPe=Symbol.for("react.strict_mode"),xPe=Symbol.for("react.profiler"),wPe=Symbol.for("react.consumer"),CPe=Symbol.for("react.context"),APe=Symbol.for("react.forward_ref"),RPe=Symbol.for("react.suspense"),MPe=Symbol.for("react.memo"),the=Symbol.for("react.lazy"),NQ=Symbol.iterator;function OPe(t){return t===null||typeof t!="object"?null:(t=NQ&&t[NQ]||t["@@iterator"],typeof t=="function"?t:null)}var nhe={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},ihe=Object.assign,rhe={};function tR(t,e,n){this.props=t,this.context=e,this.refs=rhe,this.updater=n||nhe}tR.prototype.isReactComponent={};tR.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};tR.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function she(){}she.prototype=tR.prototype;function CW(t,e,n){this.props=t,this.context=e,this.refs=rhe,this.updater=n||nhe}var AW=CW.prototype=new she;AW.constructor=CW;ihe(AW,tR.prototype);AW.isPureReactComponent=!0;var IQ=Array.isArray,ja={H:null,A:null,T:null,S:null,V:null},ahe=Object.prototype.hasOwnProperty;function RW(t,e,n,i,r,s){return n=s.ref,{$$typeof:wW,type:t,key:e,ref:n!==void 0?n:null,props:s}}function NPe(t,e){return RW(t.type,e,void 0,void 0,void 0,t.props)}function MW(t){return typeof t=="object"&&t!==null&&t.$$typeof===wW}function IPe(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var kQ=/\/+/g;function Q5(t,e){return typeof t=="object"&&t!==null&&t.key!=null?IPe(""+t.key):e.toString(36)}function PQ(){}function kPe(t){switch(t.status){case"fulfilled":return t.value;case"rejected":throw t.reason;default:switch(typeof t.status=="string"?t.then(PQ,PQ):(t.status="pending",t.then(function(e){t.status==="pending"&&(t.status="fulfilled",t.value=e)},function(e){t.status==="pending"&&(t.status="rejected",t.reason=e)})),t.status){case"fulfilled":return t.value;case"rejected":throw t.reason}}throw t}function ww(t,e,n,i,r){var s=typeof t;(s==="undefined"||s==="boolean")&&(t=null);var a=!1;if(t===null)a=!0;else switch(s){case"bigint":case"string":case"number":a=!0;break;case"object":switch(t.$$typeof){case wW:case EPe:a=!0;break;case the:return a=t._init,ww(a(t._payload),e,n,i,r)}}if(a)return r=r(t),a=i===""?"."+Q5(t,0):i,IQ(r)?(n="",a!=null&&(n=a.replace(kQ,"$&/")+"/"),ww(r,e,n,"",function(l){return l})):r!=null&&(MW(r)&&(r=NPe(r,n+(r.key==null||t&&t.key===r.key?"":(""+r.key).replace(kQ,"$&/")+"/")+a)),e.push(r)),1;a=0;var o=i===""?".":i+":";if(IQ(t))for(var c=0;c<t.length;c++)i=t[c],s=o+Q5(i,c),a+=ww(i,e,n,s,r);else if(c=OPe(t),typeof c=="function")for(t=c.call(t),c=0;!(i=t.next()).done;)i=i.value,s=o+Q5(i,c++),a+=ww(i,e,n,s,r);else if(s==="object"){if(typeof t.then=="function")return ww(kPe(t),e,n,i,r);throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.")}return a}function vD(t,e,n){if(t==null)return t;var i=[],r=0;return ww(t,i,"","",function(s){return e.call(n,s,r++)}),i}function PPe(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var DQ=typeof reportError=="function"?reportError:function(t){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var e=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof t=="object"&&t!==null&&typeof t.message=="string"?String(t.message):String(t),error:t});if(!window.dispatchEvent(e))return}else if(typeof Gn=="object"&&typeof Gn.emit=="function"){Gn.emit("uncaughtException",t);return}console.error(t)};function DPe(){}hr.Children={map:vD,forEach:function(t,e,n){vD(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return vD(t,function(){e++}),e},toArray:function(t){return vD(t,function(e){return e})||[]},only:function(t){if(!MW(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};hr.Component=tR;hr.Fragment=SPe;hr.Profiler=xPe;hr.PureComponent=CW;hr.StrictMode=TPe;hr.Suspense=RPe;hr.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=ja;hr.__COMPILER_RUNTIME={__proto__:null,c:function(t){return ja.H.useMemoCache(t)}};hr.cache=function(t){return function(){return t.apply(null,arguments)}};hr.cloneElement=function(t,e,n){if(t==null)throw Error("The argument must be a React element, but you passed "+t+".");var i=ihe({},t.props),r=t.key,s=void 0;if(e!=null)for(a in e.ref!==void 0&&(s=void 0),e.key!==void 0&&(r=""+e.key),e)!ahe.call(e,a)||a==="key"||a==="__self"||a==="__source"||a==="ref"&&e.ref===void 0||(i[a]=e[a]);var a=arguments.length-2;if(a===1)i.children=n;else if(1<a){for(var o=Array(a),c=0;c<a;c++)o[c]=arguments[c+2];i.children=o}return RW(t.type,r,void 0,void 0,s,i)};hr.createContext=function(t){return t={$$typeof:CPe,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null},t.Provider=t,t.Consumer={$$typeof:wPe,_context:t},t};hr.createElement=function(t,e,n){var i,r={},s=null;if(e!=null)for(i in e.key!==void 0&&(s=""+e.key),e)ahe.call(e,i)&&i!=="key"&&i!=="__self"&&i!=="__source"&&(r[i]=e[i]);var a=arguments.length-2;if(a===1)r.children=n;else if(1<a){for(var o=Array(a),c=0;c<a;c++)o[c]=arguments[c+2];r.children=o}if(t&&t.defaultProps)for(i in a=t.defaultProps,a)r[i]===void 0&&(r[i]=a[i]);return RW(t,s,void 0,void 0,null,r)};hr.createRef=function(){return{current:null}};hr.forwardRef=function(t){return{$$typeof:APe,render:t}};hr.isValidElement=MW;hr.lazy=function(t){return{$$typeof:the,_payload:{_status:-1,_result:t},_init:PPe}};hr.memo=function(t,e){return{$$typeof:MPe,type:t,compare:e===void 0?null:e}};hr.startTransition=function(t){var e=ja.T,n={};ja.T=n;try{var i=t(),r=ja.S;r!==null&&r(n,i),typeof i=="object"&&i!==null&&typeof i.then=="function"&&i.then(DPe,DQ)}catch(s){DQ(s)}finally{ja.T=e}};hr.unstable_useCacheRefresh=function(){return ja.H.useCacheRefresh()};hr.use=function(t){return ja.H.use(t)};hr.useActionState=function(t,e,n){return ja.H.useActionState(t,e,n)};hr.useCallback=function(t,e){return ja.H.useCallback(t,e)};hr.useContext=function(t){return ja.H.useContext(t)};hr.useDebugValue=function(){};hr.useDeferredValue=function(t,e){return ja.H.useDeferredValue(t,e)};hr.useEffect=function(t,e,n){var i=ja.H;if(typeof n=="function")throw Error("useEffect CRUD overload is not enabled in this build of React.");return i.useEffect(t,e)};hr.useId=function(){return ja.H.useId()};hr.useImperativeHandle=function(t,e,n){return ja.H.useImperativeHandle(t,e,n)};hr.useInsertionEffect=function(t,e){return ja.H.useInsertionEffect(t,e)};hr.useLayoutEffect=function(t,e){return ja.H.useLayoutEffect(t,e)};hr.useMemo=function(t,e){return ja.H.useMemo(t,e)};hr.useOptimistic=function(t,e){return ja.H.useOptimistic(t,e)};hr.useReducer=function(t,e,n){return ja.H.useReducer(t,e,n)};hr.useRef=function(t){return ja.H.useRef(t)};hr.useState=function(t){return ja.H.useState(t)};hr.useSyncExternalStore=function(t,e,n){return ja.H.useSyncExternalStore(t,e,n)};hr.useTransition=function(){return ja.H.useTransition()};hr.version="19.1.0";ehe.exports=hr;var De=ehe.exports;const Sm=il(De);var ohe={exports:{}},RE={};/**
 * @license React
 * react-reconciler-constants.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */RE.ConcurrentRoot=1;RE.ContinuousEventPriority=8;RE.DefaultEventPriority=32;RE.DiscreteEventPriority=2;RE.IdleEventPriority=268435456;RE.LegacyRoot=0;RE.NoEventPriority=0;ohe.exports=RE;var U2=ohe.exports,che={exports:{}},lhe={},uhe={exports:{}},hhe={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var $C=De;function LPe(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var UPe=typeof Object.is=="function"?Object.is:LPe,BPe=$C.useState,FPe=$C.useEffect,zPe=$C.useLayoutEffect,jPe=$C.useDebugValue;function HPe(t,e){var n=e(),i=BPe({inst:{value:n,getSnapshot:e}}),r=i[0].inst,s=i[1];return zPe(function(){r.value=n,r.getSnapshot=e,ej(r)&&s({inst:r})},[t,n,e]),FPe(function(){return ej(r)&&s({inst:r}),t(function(){ej(r)&&s({inst:r})})},[t]),jPe(n),n}function ej(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!UPe(t,n)}catch{return!0}}function VPe(t,e){return e()}var GPe=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?VPe:HPe;hhe.useSyncExternalStore=$C.useSyncExternalStore!==void 0?$C.useSyncExternalStore:GPe;uhe.exports=hhe;var qPe=uhe.exports;/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var AF=De,$Pe=qPe;function WPe(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var YPe=typeof Object.is=="function"?Object.is:WPe,KPe=$Pe.useSyncExternalStore,XPe=AF.useRef,ZPe=AF.useEffect,JPe=AF.useMemo,QPe=AF.useDebugValue;lhe.useSyncExternalStoreWithSelector=function(t,e,n,i,r){var s=XPe(null);if(s.current===null){var a={hasValue:!1,value:null};s.current=a}else a=s.current;s=JPe(function(){function c(f){if(!l){if(l=!0,u=f,f=i(f),r!==void 0&&a.hasValue){var p=a.value;if(r(p,f))return h=p}return h=f}if(p=h,YPe(u,f))return p;var g=i(f);return r!==void 0&&r(p,g)?(u=f,p):(u=f,h=g)}var l=!1,u,h,d=n===void 0?null:n;return[function(){return c(e())},d===null?void 0:function(){return c(d())}]},[e,n,i,r]);var o=KPe(t,s[0],s[1]);return ZPe(function(){a.hasValue=!0,a.value=o},[o]),QPe(o),o};che.exports=lhe;var eDe=che.exports;const tDe=il(eDe),LQ=t=>{let e;const n=new Set,i=(l,u)=>{const h=typeof l=="function"?l(e):l;if(!Object.is(h,e)){const d=e;e=u??(typeof h!="object"||h===null)?h:Object.assign({},e,h),n.forEach(f=>f(e,d))}},r=()=>e,o={setState:i,getState:r,getInitialState:()=>c,subscribe:l=>(n.add(l),()=>n.delete(l))},c=e=t(i,r,o);return o},nDe=t=>t?LQ(t):LQ,{useSyncExternalStoreWithSelector:iDe}=tDe,rDe=t=>t;function sDe(t,e=rDe,n){const i=iDe(t.subscribe,t.getState,t.getInitialState,e,n);return Sm.useDebugValue(i),i}const UQ=(t,e)=>{const n=nDe(t),i=(r,s=e)=>sDe(n,r,s);return Object.assign(i,n),i},dhe=(t,e)=>t?UQ(t,e):UQ;var fhe={exports:{}},phe={exports:{}},mhe={exports:{}},ghe={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(G,J){var K=G.length;G.push(J);e:for(;0<K;){var X=K-1>>>1,ae=G[X];if(0<r(ae,J))G[X]=J,G[K]=ae,K=X;else break e}}function n(G){return G.length===0?null:G[0]}function i(G){if(G.length===0)return null;var J=G[0],K=G.pop();if(K!==J){G[0]=K;e:for(var X=0,ae=G.length,ce=ae>>>1;X<ce;){var Me=2*(X+1)-1,Fe=G[Me],Te=Me+1,Re=G[Te];if(0>r(Fe,K))Te<ae&&0>r(Re,Fe)?(G[X]=Re,G[Te]=K,X=Te):(G[X]=Fe,G[Me]=K,X=Me);else if(Te<ae&&0>r(Re,K))G[X]=Re,G[Te]=K,X=Te;else break e}}return J}function r(G,J){var K=G.sortIndex-J.sortIndex;return K!==0?K:G.id-J.id}if(t.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var s=performance;t.unstable_now=function(){return s.now()}}else{var a=Date,o=a.now();t.unstable_now=function(){return a.now()-o}}var c=[],l=[],u=1,h=null,d=3,f=!1,p=!1,g=!1,_=typeof setTimeout=="function"?setTimeout:null,v=typeof clearTimeout=="function"?clearTimeout:null,b=typeof setImmediate<"u"?setImmediate:null;function S(G){for(var J=n(l);J!==null;){if(J.callback===null)i(l);else if(J.startTime<=G)i(l),J.sortIndex=J.expirationTime,e(c,J);else break;J=n(l)}}function x(G){if(g=!1,S(G),!p)if(n(c)!==null)p=!0,Y();else{var J=n(l);J!==null&&te(x,J.startTime-G)}}var M=!1,R=-1,I=5,k=-1;function P(){return!(t.unstable_now()-k<I)}function U(){if(M){var G=t.unstable_now();k=G;var J=!0;try{e:{p=!1,g&&(g=!1,v(R),R=-1),f=!0;var K=d;try{t:{for(S(G),h=n(c);h!==null&&!(h.expirationTime>G&&P());){var X=h.callback;if(typeof X=="function"){h.callback=null,d=h.priorityLevel;var ae=X(h.expirationTime<=G);if(G=t.unstable_now(),typeof ae=="function"){h.callback=ae,S(G),J=!0;break t}h===n(c)&&i(c),S(G)}else i(c);h=n(c)}if(h!==null)J=!0;else{var ce=n(l);ce!==null&&te(x,ce.startTime-G),J=!1}}break e}finally{h=null,d=K,f=!1}J=void 0}}finally{J?V():M=!1}}}var V;if(typeof b=="function")V=function(){b(U)};else if(typeof MessageChannel<"u"){var $=new MessageChannel,q=$.port2;$.port1.onmessage=U,V=function(){q.postMessage(null)}}else V=function(){_(U,0)};function Y(){M||(M=!0,V())}function te(G,J){R=_(function(){G(t.unstable_now())},J)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(G){G.callback=null},t.unstable_continueExecution=function(){p||f||(p=!0,Y())},t.unstable_forceFrameRate=function(G){0>G||125<G?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):I=0<G?Math.floor(1e3/G):5},t.unstable_getCurrentPriorityLevel=function(){return d},t.unstable_getFirstCallbackNode=function(){return n(c)},t.unstable_next=function(G){switch(d){case 1:case 2:case 3:var J=3;break;default:J=d}var K=d;d=J;try{return G()}finally{d=K}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(G,J){switch(G){case 1:case 2:case 3:case 4:case 5:break;default:G=3}var K=d;d=G;try{return J()}finally{d=K}},t.unstable_scheduleCallback=function(G,J,K){var X=t.unstable_now();switch(typeof K=="object"&&K!==null?(K=K.delay,K=typeof K=="number"&&0<K?X+K:X):K=X,G){case 1:var ae=-1;break;case 2:ae=250;break;case 5:ae=1073741823;break;case 4:ae=1e4;break;default:ae=5e3}return ae=K+ae,G={id:u++,callback:J,priorityLevel:G,startTime:K,expirationTime:ae,sortIndex:-1},K>X?(G.sortIndex=K,e(l,G),n(c)===null&&G===n(l)&&(g?(v(R),R=-1):g=!0,te(x,K-X))):(G.sortIndex=ae,e(c,G),p||f||(p=!0,Y())),G},t.unstable_shouldYield=P,t.unstable_wrapCallback=function(G){var J=d;return function(){var K=d;d=J;try{return G.apply(this,arguments)}finally{d=K}}}})(ghe);mhe.exports=ghe;var lG=mhe.exports;(function(t){t.exports=function(e){function n(m,y,C,D){return new Hu(m,y,C,D)}function i(){}function r(m){var y="https://react.dev/errors/"+m;if(1<arguments.length){y+="?args[]="+encodeURIComponent(arguments[1]);for(var C=2;C<arguments.length;C++)y+="&args[]="+encodeURIComponent(arguments[C])}return"Minified React error #"+m+"; visit "+y+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function s(m){return m===null||typeof m!="object"?null:(m=mo&&m[mo]||m["@@iterator"],typeof m=="function"?m:null)}function a(m){if(m==null)return null;if(typeof m=="function")return m.$$typeof===hS?null:m.displayName||m.name||null;if(typeof m=="string")return m;switch(m){case kh:return"Fragment";case Wp:return"Portal";case Ph:return"Profiler";case ul:return"StrictMode";case av:return"Suspense";case Kp:return"SuspenseList"}if(typeof m=="object")switch(m.$$typeof){case Vu:return(m.displayName||"Context")+".Provider";case uS:return(m._context.displayName||"Context")+".Consumer";case rg:var y=m.render;return m=m.displayName,m||(m=y.displayName||y.name||"",m=m!==""?"ForwardRef("+m+")":"ForwardRef"),m;case ov:return y=m.displayName||null,y!==null?y:a(m.type)||"Memo";case Gu:y=m._payload,m=m._init;try{return a(m(y))}catch{}}return null}function o(m){if(sg===void 0)try{throw Error()}catch(C){var y=C.stack.trim().match(/\n( *(at )?)/);sg=y&&y[1]||"",my=-1<C.stack.indexOf(`
    at`)?" (<anonymous>)":-1<C.stack.indexOf("@")?"@unknown:0:0":""}return`
`+sg+m+my}function c(m,y){if(!m||Xp)return"";Xp=!0;var C=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var D={DetermineComponentFrameRoot:function(){try{if(y){var Rn=function(){throw Error()};if(Object.defineProperty(Rn.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(Rn,[])}catch(nr){var In=nr}Reflect.construct(m,[],Rn)}else{try{Rn.call()}catch(nr){In=nr}m.call(Rn.prototype)}}else{try{throw Error()}catch(nr){In=nr}(Rn=m())&&typeof Rn.catch=="function"&&Rn.catch(function(){})}}catch(nr){if(nr&&In&&typeof nr.stack=="string")return[nr.stack,In.stack]}return[null,null]}};D.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var j=Object.getOwnPropertyDescriptor(D.DetermineComponentFrameRoot,"name");j&&j.configurable&&Object.defineProperty(D.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var Q=D.DetermineComponentFrameRoot(),Ce=Q[0],He=Q[1];if(Ce&&He){var ut=Ce.split(`
`),kt=He.split(`
`);for(j=D=0;D<ut.length&&!ut[D].includes("DetermineComponentFrameRoot");)D++;for(;j<kt.length&&!kt[j].includes("DetermineComponentFrameRoot");)j++;if(D===ut.length||j===kt.length)for(D=ut.length-1,j=kt.length-1;1<=D&&0<=j&&ut[D]!==kt[j];)j--;for(;1<=D&&0<=j;D--,j--)if(ut[D]!==kt[j]){if(D!==1||j!==1)do if(D--,j--,0>j||ut[D]!==kt[j]){var nn=`
`+ut[D].replace(" at new "," at ");return m.displayName&&nn.includes("<anonymous>")&&(nn=nn.replace("<anonymous>",m.displayName)),nn}while(1<=D&&0<=j);break}}}finally{Xp=!1,Error.prepareStackTrace=C}return(C=m?m.displayName||m.name:"")?o(C):""}function l(m){switch(m.tag){case 26:case 27:case 5:return o(m.type);case 16:return o("Lazy");case 13:return o("Suspense");case 19:return o("SuspenseList");case 0:case 15:return m=c(m.type,!1),m;case 11:return m=c(m.type.render,!1),m;case 1:return m=c(m.type,!0),m;default:return""}}function u(m){try{var y="";do y+=l(m),m=m.return;while(m);return y}catch(C){return`
Error generating stack: `+C.message+`
`+C.stack}}function h(m){var y=m,C=m;if(m.alternate)for(;y.return;)y=y.return;else{m=y;do y=m,y.flags&4098&&(C=y.return),m=y.return;while(m)}return y.tag===3?C:null}function d(m){if(h(m)!==m)throw Error(r(188))}function f(m){var y=m.alternate;if(!y){if(y=h(m),y===null)throw Error(r(188));return y!==m?null:m}for(var C=m,D=y;;){var j=C.return;if(j===null)break;var Q=j.alternate;if(Q===null){if(D=j.return,D!==null){C=D;continue}break}if(j.child===Q.child){for(Q=j.child;Q;){if(Q===C)return d(j),m;if(Q===D)return d(j),y;Q=Q.sibling}throw Error(r(188))}if(C.return!==D.return)C=j,D=Q;else{for(var Ce=!1,He=j.child;He;){if(He===C){Ce=!0,C=j,D=Q;break}if(He===D){Ce=!0,D=j,C=Q;break}He=He.sibling}if(!Ce){for(He=Q.child;He;){if(He===C){Ce=!0,C=Q,D=j;break}if(He===D){Ce=!0,D=Q,C=j;break}He=He.sibling}if(!Ce)throw Error(r(189))}}if(C.alternate!==D)throw Error(r(190))}if(C.tag!==3)throw Error(r(188));return C.stateNode.current===C?m:y}function p(m){var y=m.tag;if(y===5||y===26||y===27||y===6)return m;for(m=m.child;m!==null;){if(y=p(m),y!==null)return y;m=m.sibling}return null}function g(m){var y=m.tag;if(y===5||y===26||y===27||y===6)return m;for(m=m.child;m!==null;){if(m.tag!==4&&(y=g(m),y!==null))return y;m=m.sibling}return null}function _(m){return{current:m}}function v(m){0>Lf||(m.current=_o[Lf],_o[Lf]=null,Lf--)}function b(m,y){Lf++,_o[Lf]=m.current,m.current=y}function S(m){return m>>>=0,m===0?32:31-(zR(m)/wy|0)|0}function x(m){var y=m&42;if(y!==0)return y;switch(m&-m){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return m&4194176;case 4194304:case 8388608:case 16777216:case 33554432:return m&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return m}}function M(m,y){var C=m.pendingLanes;if(C===0)return 0;var D=0,j=m.suspendedLanes,Q=m.pingedLanes,Ce=m.warmLanes;m=m.finishedLanes!==0;var He=C&134217727;return He!==0?(C=He&~j,C!==0?D=x(C):(Q&=He,Q!==0?D=x(Q):m||(Ce=He&~Ce,Ce!==0&&(D=x(Ce))))):(He=C&~j,He!==0?D=x(He):Q!==0?D=x(Q):m||(Ce=C&~Ce,Ce!==0&&(D=x(Ce)))),D===0?0:y!==0&&y!==D&&!(y&j)&&(j=D&-D,Ce=y&-y,j>=Ce||j===32&&(Ce&4194176)!==0)?y:D}function R(m,y){return(m.pendingLanes&~(m.suspendedLanes&~m.pingedLanes)&y)===0}function I(m,y){switch(m){case 1:case 2:case 4:case 8:return y+250;case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return y+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function k(){var m=_v;return _v<<=1,!(_v&4194176)&&(_v=128),m}function P(){var m=Ja;return Ja<<=1,!(Ja&62914560)&&(Ja=4194304),m}function U(m){for(var y=[],C=0;31>C;C++)y.push(m);return y}function V(m,y){m.pendingLanes|=y,y!==268435456&&(m.suspendedLanes=0,m.pingedLanes=0,m.warmLanes=0)}function $(m,y,C,D,j,Q){var Ce=m.pendingLanes;m.pendingLanes=C,m.suspendedLanes=0,m.pingedLanes=0,m.warmLanes=0,m.expiredLanes&=C,m.entangledLanes&=C,m.errorRecoveryDisabledLanes&=C,m.shellSuspendCounter=0;var He=m.entanglements,ut=m.expirationTimes,kt=m.hiddenUpdates;for(C=Ce&~C;0<C;){var nn=31-cc(C),Rn=1<<nn;He[nn]=0,ut[nn]=-1;var In=kt[nn];if(In!==null)for(kt[nn]=null,nn=0;nn<In.length;nn++){var nr=In[nn];nr!==null&&(nr.lane&=-536870913)}C&=~Rn}D!==0&&q(m,D,0),Q!==0&&j===0&&m.tag!==0&&(m.suspendedLanes|=Q&~(Ce&~y))}function q(m,y,C){m.pendingLanes|=y,m.suspendedLanes&=~y;var D=31-cc(y);m.entangledLanes|=y,m.entanglements[D]=m.entanglements[D]|1073741824|C&4194218}function Y(m,y){var C=m.entangledLanes|=y;for(m=m.entanglements;C;){var D=31-cc(C),j=1<<D;j&y|m[D]&y&&(m[D]|=y),C&=~j}}function te(m){return m&=-m,2<m?8<m?m&134217727?32:268435456:8:2}function G(m){if(T&&typeof T.onCommitFiberRoot=="function")try{T.onCommitFiberRoot(N,m,void 0,(m.current.flags&128)===128)}catch{}}function J(m){if(typeof vg=="function"&&RS(m),T&&typeof T.setStrictMode=="function")try{T.setStrictMode(N,m)}catch{}}function K(m,y){return m===y&&(m!==0||1/m===1/y)||m!==m&&y!==y}function X(m,y){if(typeof m=="object"&&m!==null){var C=O.get(m);return C!==void 0?C:(y={value:m,source:y,stack:u(y)},O.set(m,y),y)}return{value:m,source:y,stack:u(y)}}function ae(m,y){L[B++]=ne,L[B++]=H,H=m,ne=y}function ce(m,y,C){se[Z++]=de,se[Z++]=me,se[Z++]=oe,oe=m;var D=de;m=me;var j=32-cc(D)-1;D&=~(1<<j),C+=1;var Q=32-cc(y)+j;if(30<Q){var Ce=j-j%5;Q=(D&(1<<Ce)-1).toString(32),D>>=Ce,j-=Ce,de=1<<32-cc(y)+j|C<<j|D,me=Q+m}else de=1<<Q|C<<j|D,me=m}function Me(m){m.return!==null&&(ae(m,1),ce(m,1,0))}function Fe(m){for(;m===H;)H=L[--B],L[B]=null,ne=L[--B],L[B]=null;for(;m===oe;)oe=se[--Z],se[Z]=null,me=se[--Z],se[Z]=null,de=se[--Z],se[Z]=null}function Te(m,y){b(qe,y),b(Xe,m),b(Pe,null),m=ag(y),v(Pe),b(Pe,m)}function Re(){v(Pe),v(Xe),v(qe)}function ge(m){m.memoizedState!==null&&b(Ie,m);var y=Pe.current,C=xx(y,m.type);y!==C&&(b(Xe,m),b(Pe,C))}function _e(m){Xe.current===m&&(v(Pe),v(Xe)),Ie.current===m&&(v(Ie),ru?Ul._currentValue=Dd:Ul._currentValue2=Dd)}function ke(m){var y=Error(r(418,""));throw Qe(X(y,m)),Qn}function gt(m,y){if(!Dl)throw Error(r(175));kR(m.stateNode,m.type,m.memoizedProps,y,m)||ke(m)}function wt(m){for(xe=m.return;xe;)switch(xe.tag){case 3:case 27:Nt=!0;return;case 5:case 13:Nt=!1;return;default:xe=xe.return}}function ye(m){if(!Dl||m!==xe)return!1;if(!At)return wt(m),At=!0,!1;var y=!1;if(ka?m.tag!==3&&m.tag!==27&&(m.tag!==5||kx(m.type)&&!og(m.type,m.memoizedProps))&&(y=!0):m.tag!==3&&(m.tag!==5||kx(m.type)&&!og(m.type,m.memoizedProps))&&(y=!0),y&&lt&&ke(m),wt(m),m.tag===13){if(!Dl)throw Error(r(316));if(m=m.memoizedState,m=m!==null?m.dehydrated:null,!m)throw Error(r(317));lt=pg(m)}else lt=xe?sc(m.stateNode):null;return!0}function Se(){Dl&&(lt=xe=null,At=!1)}function Qe(m){Jt===null?Jt=[m]:Jt.push(m)}function pe(){for(var m=Ei,y=Fi=Ei=0;y<m;){var C=On[y];On[y++]=null;var D=On[y];On[y++]=null;var j=On[y];On[y++]=null;var Q=On[y];if(On[y++]=null,D!==null&&j!==null){var Ce=D.pending;Ce===null?j.next=j:(j.next=Ce.next,Ce.next=j),D.pending=j}Q!==0&&dt(C,j,Q)}}function ze(m,y,C,D){On[Ei++]=m,On[Ei++]=y,On[Ei++]=C,On[Ei++]=D,Fi|=D,m.lanes|=D,m=m.alternate,m!==null&&(m.lanes|=D)}function Le(m,y,C,D){return ze(m,y,C,D),pt(m)}function rt(m,y){return ze(m,null,null,y),pt(m)}function dt(m,y,C){m.lanes|=C;var D=m.alternate;D!==null&&(D.lanes|=C);for(var j=!1,Q=m.return;Q!==null;)Q.childLanes|=C,D=Q.alternate,D!==null&&(D.childLanes|=C),Q.tag===22&&(m=Q.stateNode,m===null||m._visibility&1||(j=!0)),m=Q,Q=Q.return;j&&y!==null&&m.tag===3&&(Q=m.stateNode,j=31-cc(C),Q=Q.hiddenUpdates,m=Q[j],m===null?Q[j]=[y]:m.push(y),y.lane=C|536870912)}function pt(m){if(50<HR)throw HR=0,d5=null,Error(r(185));for(var y=m.return;y!==null;)m=y,y=m.return;return m.tag===3?m.stateNode:null}function bt(m){m!==Ai&&m.next===null&&(Ai===null?Pi=Ai=m:Ai=Ai.next=m),Oi=!0,Si||(Si=!0,ct(he))}function we(m,y){if(!Di&&Oi){Di=!0;do for(var C=!1,D=Pi;D!==null;){if(m!==0){var j=D.pendingLanes;if(j===0)var Q=0;else{var Ce=D.suspendedLanes,He=D.pingedLanes;Q=(1<<31-cc(42|m)+1)-1,Q&=j&~(Ce&~He),Q=Q&201326677?Q&201326677|1:Q?Q|2:0}Q!==0&&(C=!0,Et(D,Q))}else Q=Bn,Q=M(D,D===Dn?Q:0),!(Q&3)||R(D,Q)||(C=!0,Et(D,Q));D=D.next}while(C);Di=!1}}function he(){Oi=Si=!1;var m=0;Ti!==0&&(Ll()&&(m=Ti),Ti=0);for(var y=ei(),C=null,D=Pi;D!==null;){var j=D.next,Q=$e(D,y);Q===0?(D.next=null,C===null?Pi=j:C.next=j,j===null&&(Ai=C)):(C=D,(m!==0||Q&3)&&(Oi=!0)),D=j}we(m)}function $e(m,y){for(var C=m.suspendedLanes,D=m.pingedLanes,j=m.expirationTimes,Q=m.pendingLanes&-62914561;0<Q;){var Ce=31-cc(Q),He=1<<Ce,ut=j[Ce];ut===-1?(!(He&C)||He&D)&&(j[Ce]=I(He,y)):ut<=y&&(m.expiredLanes|=He),Q&=~He}if(y=Dn,C=Bn,C=M(m,m===y?C:0),D=m.callbackNode,C===0||m===y&&ln===2||m.cancelPendingCommit!==null)return D!==null&&D!==null&&Fh(D),m.callbackNode=null,m.callbackPriority=0;if(!(C&3)||R(m,C)){if(y=C&-C,y===m.callbackPriority)return y;switch(D!==null&&Fh(D),te(C)){case 2:case 8:C=yo;break;case 32:C=Fs;break;case 268435456:C=Uf;break;default:C=Fs}return D=et.bind(null,m),C=Bs(C,D),m.callbackPriority=y,m.callbackNode=C,y}return D!==null&&D!==null&&Fh(D),m.callbackPriority=2,m.callbackNode=null,2}function et(m,y){var C=m.callbackNode;if(Oc()&&m.callbackNode!==C)return null;var D=Bn;return D=M(m,m===Dn?D:0),D===0?null:(Fu(m,D,y),$e(m,ei()),m.callbackNode!=null&&m.callbackNode===C?et.bind(null,m):null)}function Et(m,y){if(Oc())return null;Fu(m,y,!0)}function ct(m){_y?ii(function(){$t&6?Bs(Dx,m):m()}):Bs(Dx,m)}function tn(){return Ti===0&&(Ti=k()),Ti}function Ht(m,y){if(Ni===null){var C=Ni=[];hi=0,An=tn(),Kn={status:"pending",value:void 0,then:function(D){C.push(D)}}}return hi++,y.then(pn,pn),y}function pn(){if(--hi===0&&Ni!==null){Kn!==null&&(Kn.status="fulfilled");var m=Ni;Ni=null,An=0,Kn=null;for(var y=0;y<m.length;y++)(0,m[y])()}}function le(m,y){var C=[],D={status:"pending",value:null,reason:null,then:function(j){C.push(j)}};return m.then(function(){D.status="fulfilled",D.value=y;for(var j=0;j<C.length;j++)(0,C[j])(y)},function(j){for(D.status="rejected",D.reason=j,j=0;j<C.length;j++)(0,C[j])(void 0)}),D}function z(m){m.updateQueue={baseState:m.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function W(m,y){m=m.updateQueue,y.updateQueue===m&&(y.updateQueue={baseState:m.baseState,firstBaseUpdate:m.firstBaseUpdate,lastBaseUpdate:m.lastBaseUpdate,shared:m.shared,callbacks:null})}function fe(m){return{lane:m,tag:0,payload:null,callback:null,next:null}}function Ne(m,y,C){var D=m.updateQueue;if(D===null)return null;if(D=D.shared,$t&2){var j=D.pending;return j===null?y.next=y:(y.next=j.next,j.next=y),D.pending=y,y=pt(m),dt(m,null,C),y}return ze(m,D,y,C),pt(m)}function Be(m,y,C){if(y=y.updateQueue,y!==null&&(y=y.shared,(C&4194176)!==0)){var D=y.lanes;D&=m.pendingLanes,C|=D,y.lanes=C,Y(m,C)}}function tt(m,y){var C=m.updateQueue,D=m.alternate;if(D!==null&&(D=D.updateQueue,C===D)){var j=null,Q=null;if(C=C.firstBaseUpdate,C!==null){do{var Ce={lane:C.lane,tag:C.tag,payload:C.payload,callback:null,next:null};Q===null?j=Q=Ce:Q=Q.next=Ce,C=C.next}while(C!==null);Q===null?j=Q=y:Q=Q.next=y}else j=Q=y;C={baseState:D.baseState,firstBaseUpdate:j,lastBaseUpdate:Q,shared:D.shared,callbacks:D.callbacks},m.updateQueue=C;return}m=C.lastBaseUpdate,m===null?C.firstBaseUpdate=y:m.next=y,C.lastBaseUpdate=y}function Tt(){if(ts){var m=Kn;if(m!==null)throw m}}function Cn(m,y,C,D){ts=!1;var j=m.updateQueue;Wi=!1;var Q=j.firstBaseUpdate,Ce=j.lastBaseUpdate,He=j.shared.pending;if(He!==null){j.shared.pending=null;var ut=He,kt=ut.next;ut.next=null,Ce===null?Q=kt:Ce.next=kt,Ce=ut;var nn=m.alternate;nn!==null&&(nn=nn.updateQueue,He=nn.lastBaseUpdate,He!==Ce&&(He===null?nn.firstBaseUpdate=kt:He.next=kt,nn.lastBaseUpdate=ut))}if(Q!==null){var Rn=j.baseState;Ce=0,nn=kt=ut=null,He=Q;do{var In=He.lane&-536870913,nr=In!==He.lane;if(nr?(Bn&In)===In:(D&In)===In){In!==0&&In===An&&(ts=!0),nn!==null&&(nn=nn.next={lane:0,tag:He.tag,payload:He.payload,callback:null,next:null});e:{var jf=m,VR=He;In=y;var OS=C;switch(VR.tag){case 1:if(jf=VR.payload,typeof jf=="function"){Rn=jf.call(OS,Rn,In);break e}Rn=jf;break e;case 3:jf.flags=jf.flags&-65537|128;case 0:if(jf=VR.payload,In=typeof jf=="function"?jf.call(OS,Rn,In):jf,In==null)break e;Rn=Ih({},Rn,In);break e;case 2:Wi=!0}}In=He.callback,In!==null&&(m.flags|=64,nr&&(m.flags|=8192),nr=j.callbacks,nr===null?j.callbacks=[In]:nr.push(In))}else nr={lane:In,tag:He.tag,payload:He.payload,callback:He.callback,next:null},nn===null?(kt=nn=nr,ut=Rn):nn=nn.next=nr,Ce|=In;if(He=He.next,He===null){if(He=j.shared.pending,He===null)break;nr=He,He=nr.next,nr.next=null,j.lastBaseUpdate=nr,j.shared.pending=null}}while(!0);nn===null&&(ut=Rn),j.baseState=ut,j.firstBaseUpdate=kt,j.lastBaseUpdate=nn,Q===null&&(j.shared.lanes=0),Pc|=Ce,m.lanes=Ce,m.memoizedState=Rn}}function je(m,y){if(typeof m!="function")throw Error(r(191,m));m.call(y)}function zt(m,y){var C=m.callbacks;if(C!==null)for(m.callbacks=null,m=0;m<C.length;m++)je(C[m],y)}function ht(m,y){if(A(m,y))return!0;if(typeof m!="object"||m===null||typeof y!="object"||y===null)return!1;var C=Object.keys(m),D=Object.keys(y);if(C.length!==D.length)return!1;for(D=0;D<C.length;D++){var j=C[D];if(!ws.call(y,j)||!A(m[j],y[j]))return!1}return!0}function Pt(m){return m=m.status,m==="fulfilled"||m==="rejected"}function hn(){}function on(m,y,C){switch(C=m[C],C===void 0?m.push(y):C!==y&&(y.then(hn,hn),y=C),y.status){case"fulfilled":return y.value;case"rejected":throw m=y.reason,m===ns?Error(r(483)):m;default:if(typeof y.status=="string")y.then(hn,hn);else{if(m=Dn,m!==null&&100<m.shellSuspendCounter)throw Error(r(482));m=y,m.status="pending",m.then(function(D){if(y.status==="pending"){var j=y;j.status="fulfilled",j.value=D}},function(D){if(y.status==="pending"){var j=y;j.status="rejected",j.reason=D}})}switch(y.status){case"fulfilled":return y.value;case"rejected":throw m=y.reason,m===ns?Error(r(483)):m}throw kr=y,ns}}function Ve(){if(kr===null)throw Error(r(459));var m=kr;return kr=null,m}function at(m){var y=Kr;return Kr+=1,fr===null&&(fr=[]),on(fr,m,y)}function Mt(m,y){y=y.props.ref,m.ref=y!==void 0?y:null}function Ot(m,y){throw y.$$typeof===$p?Error(r(525)):(m=Object.prototype.toString.call(y),Error(r(31,m==="[object Object]"?"object with keys {"+Object.keys(y).join(", ")+"}":m)))}function Zn(m){var y=m._init;return y(m._payload)}function or(m){function y(St,it){if(m){var Ct=St.deletions;Ct===null?(St.deletions=[it],St.flags|=16):Ct.push(it)}}function C(St,it){if(!m)return null;for(;it!==null;)y(St,it),it=it.sibling;return null}function D(St){for(var it=new Map;St!==null;)St.key!==null?it.set(St.key,St):it.set(St.index,St),St=St.sibling;return it}function j(St,it){return St=Nh(St,it),St.index=0,St.sibling=null,St}function Q(St,it,Ct){return St.index=Ct,m?(Ct=St.alternate,Ct!==null?(Ct=Ct.index,Ct<it?(St.flags|=33554434,it):Ct):(St.flags|=33554434,it)):(St.flags|=1048576,it)}function Ce(St){return m&&St.alternate===null&&(St.flags|=33554434),St}function He(St,it,Ct,Qt){return it===null||it.tag!==6?(it=rv(Ct,St.mode,Qt),it.return=St,it):(it=j(it,Ct),it.return=St,it)}function ut(St,it,Ct,Qt){var di=Ct.type;return di===kh?nn(St,it,Ct.props.children,Qt,Ct.key):it!==null&&(it.elementType===di||typeof di=="object"&&di!==null&&di.$$typeof===Gu&&Zn(di)===it.type)?(it=j(it,Ct.props),Mt(it,Ct),it.return=St,it):(it=iv(Ct.type,Ct.key,Ct.props,null,St.mode,Qt),Mt(it,Ct),it.return=St,it)}function kt(St,it,Ct,Qt){return it===null||it.tag!==4||it.stateNode.containerInfo!==Ct.containerInfo||it.stateNode.implementation!==Ct.implementation?(it=fy(Ct,St.mode,Qt),it.return=St,it):(it=j(it,Ct.children||[]),it.return=St,it)}function nn(St,it,Ct,Qt,di){return it===null||it.tag!==7?(it=Pf(Ct,St.mode,Qt,di),it.return=St,it):(it=j(it,Ct),it.return=St,it)}function Rn(St,it,Ct){if(typeof it=="string"&&it!==""||typeof it=="number"||typeof it=="bigint")return it=rv(""+it,St.mode,Ct),it.return=St,it;if(typeof it=="object"&&it!==null){switch(it.$$typeof){case ig:return Ct=iv(it.type,it.key,it.props,null,St.mode,Ct),Mt(Ct,it),Ct.return=St,Ct;case Wp:return it=fy(it,St.mode,Ct),it.return=St,it;case Gu:var Qt=it._init;return it=Qt(it._payload),Rn(St,it,Ct)}if(Pd(it)||s(it))return it=Pf(it,St.mode,Ct,null),it.return=St,it;if(typeof it.then=="function")return Rn(St,at(it),Ct);if(it.$$typeof===Vu)return Rn(St,Mr(St,it),Ct);Ot(St,it)}return null}function In(St,it,Ct,Qt){var di=it!==null?it.key:null;if(typeof Ct=="string"&&Ct!==""||typeof Ct=="number"||typeof Ct=="bigint")return di!==null?null:He(St,it,""+Ct,Qt);if(typeof Ct=="object"&&Ct!==null){switch(Ct.$$typeof){case ig:return Ct.key===di?ut(St,it,Ct,Qt):null;case Wp:return Ct.key===di?kt(St,it,Ct,Qt):null;case Gu:return di=Ct._init,Ct=di(Ct._payload),In(St,it,Ct,Qt)}if(Pd(Ct)||s(Ct))return di!==null?null:nn(St,it,Ct,Qt,null);if(typeof Ct.then=="function")return In(St,it,at(Ct),Qt);if(Ct.$$typeof===Vu)return In(St,it,Mr(St,Ct),Qt);Ot(St,Ct)}return null}function nr(St,it,Ct,Qt,di){if(typeof Qt=="string"&&Qt!==""||typeof Qt=="number"||typeof Qt=="bigint")return St=St.get(Ct)||null,He(it,St,""+Qt,di);if(typeof Qt=="object"&&Qt!==null){switch(Qt.$$typeof){case ig:return St=St.get(Qt.key===null?Ct:Qt.key)||null,ut(it,St,Qt,di);case Wp:return St=St.get(Qt.key===null?Ct:Qt.key)||null,kt(it,St,Qt,di);case Gu:var Ta=Qt._init;return Qt=Ta(Qt._payload),nr(St,it,Ct,Qt,di)}if(Pd(Qt)||s(Qt))return St=St.get(Ct)||null,nn(it,St,Qt,di,null);if(typeof Qt.then=="function")return nr(St,it,Ct,at(Qt),di);if(Qt.$$typeof===Vu)return nr(St,it,Ct,Mr(it,Qt),di);Ot(it,Qt)}return null}function jf(St,it,Ct,Qt){for(var di=null,Ta=null,zi=it,ss=it=0,fl=null;zi!==null&&ss<Ct.length;ss++){zi.index>ss?(fl=zi,zi=null):fl=zi.sibling;var as=In(St,zi,Ct[ss],Qt);if(as===null){zi===null&&(zi=fl);break}m&&zi&&as.alternate===null&&y(St,zi),it=Q(as,it,ss),Ta===null?di=as:Ta.sibling=as,Ta=as,zi=fl}if(ss===Ct.length)return C(St,zi),At&&ae(St,ss),di;if(zi===null){for(;ss<Ct.length;ss++)zi=Rn(St,Ct[ss],Qt),zi!==null&&(it=Q(zi,it,ss),Ta===null?di=zi:Ta.sibling=zi,Ta=zi);return At&&ae(St,ss),di}for(zi=D(zi);ss<Ct.length;ss++)fl=nr(zi,St,ss,Ct[ss],Qt),fl!==null&&(m&&fl.alternate!==null&&zi.delete(fl.key===null?ss:fl.key),it=Q(fl,it,ss),Ta===null?di=fl:Ta.sibling=fl,Ta=fl);return m&&zi.forEach(function(My){return y(St,My)}),At&&ae(St,ss),di}function VR(St,it,Ct,Qt){if(Ct==null)throw Error(r(151));for(var di=null,Ta=null,zi=it,ss=it=0,fl=null,as=Ct.next();zi!==null&&!as.done;ss++,as=Ct.next()){zi.index>ss?(fl=zi,zi=null):fl=zi.sibling;var My=In(St,zi,as.value,Qt);if(My===null){zi===null&&(zi=fl);break}m&&zi&&My.alternate===null&&y(St,zi),it=Q(My,it,ss),Ta===null?di=My:Ta.sibling=My,Ta=My,zi=fl}if(as.done)return C(St,zi),At&&ae(St,ss),di;if(zi===null){for(;!as.done;ss++,as=Ct.next())as=Rn(St,as.value,Qt),as!==null&&(it=Q(as,it,ss),Ta===null?di=as:Ta.sibling=as,Ta=as);return At&&ae(St,ss),di}for(zi=D(zi);!as.done;ss++,as=Ct.next())as=nr(zi,St,ss,as.value,Qt),as!==null&&(m&&as.alternate!==null&&zi.delete(as.key===null?ss:as.key),it=Q(as,it,ss),Ta===null?di=as:Ta.sibling=as,Ta=as);return m&&zi.forEach(function(Ywe){return y(St,Ywe)}),At&&ae(St,ss),di}function OS(St,it,Ct,Qt){if(typeof Ct=="object"&&Ct!==null&&Ct.type===kh&&Ct.key===null&&(Ct=Ct.props.children),typeof Ct=="object"&&Ct!==null){switch(Ct.$$typeof){case ig:e:{for(var di=Ct.key;it!==null;){if(it.key===di){if(di=Ct.type,di===kh){if(it.tag===7){C(St,it.sibling),Qt=j(it,Ct.props.children),Qt.return=St,St=Qt;break e}}else if(it.elementType===di||typeof di=="object"&&di!==null&&di.$$typeof===Gu&&Zn(di)===it.type){C(St,it.sibling),Qt=j(it,Ct.props),Mt(Qt,Ct),Qt.return=St,St=Qt;break e}C(St,it);break}else y(St,it);it=it.sibling}Ct.type===kh?(Qt=Pf(Ct.props.children,St.mode,Qt,Ct.key),Qt.return=St,St=Qt):(Qt=iv(Ct.type,Ct.key,Ct.props,null,St.mode,Qt),Mt(Qt,Ct),Qt.return=St,St=Qt)}return Ce(St);case Wp:e:{for(di=Ct.key;it!==null;){if(it.key===di)if(it.tag===4&&it.stateNode.containerInfo===Ct.containerInfo&&it.stateNode.implementation===Ct.implementation){C(St,it.sibling),Qt=j(it,Ct.children||[]),Qt.return=St,St=Qt;break e}else{C(St,it);break}else y(St,it);it=it.sibling}Qt=fy(Ct,St.mode,Qt),Qt.return=St,St=Qt}return Ce(St);case Gu:return di=Ct._init,Ct=di(Ct._payload),OS(St,it,Ct,Qt)}if(Pd(Ct))return jf(St,it,Ct,Qt);if(s(Ct)){if(di=s(Ct),typeof di!="function")throw Error(r(150));return Ct=di.call(Ct),VR(St,it,Ct,Qt)}if(typeof Ct.then=="function")return OS(St,it,at(Ct),Qt);if(Ct.$$typeof===Vu)return OS(St,it,Mr(St,Ct),Qt);Ot(St,Ct)}return typeof Ct=="string"&&Ct!==""||typeof Ct=="number"||typeof Ct=="bigint"?(Ct=""+Ct,it!==null&&it.tag===6?(C(St,it.sibling),Qt=j(it,Ct),Qt.return=St,St=Qt):(C(St,it),Qt=rv(Ct,St.mode,Qt),Qt.return=St,St=Qt),Ce(St)):C(St,it)}return function(St,it,Ct,Qt){try{Kr=0;var di=OS(St,it,Ct,Qt);return fr=null,di}catch(zi){if(zi===ns)throw zi;var Ta=n(29,zi,null,St.mode);return Ta.lanes=Qt,Ta.return=St,Ta}finally{}}}function wi(m,y){m=Pr,b(Sa,m),b(ia,y),Pr=m|y.baseLanes}function ai(){b(Sa,Pr),b(ia,ia.current)}function xn(){Pr=Sa.current,v(ia),v(Sa)}function sn(m){var y=m.alternate;b(pr,pr.current&1),b(Cs,m),zs===null&&(y===null||ia.current!==null||y.memoizedState!==null)&&(zs=m)}function zn(m){if(m.tag===22){if(b(pr,pr.current),b(Cs,m),zs===null){var y=m.alternate;y!==null&&y.memoizedState!==null&&(zs=m)}}else Un()}function Un(){b(pr,pr.current),b(Cs,Cs.current)}function pi(m){v(Cs),zs===m&&(zs=null),v(pr)}function dr(m){for(var y=m;y!==null;){if(y.tag===13){var C=y.memoizedState;if(C!==null&&(C=C.dehydrated,C===null||dg(C)||Ea(C)))return y}else if(y.tag===19&&y.memoizedProps.revealOrder!==void 0){if(y.flags&128)return y}else if(y.child!==null){y.child.return=y,y=y.child;continue}if(y===m)break;for(;y.sibling===null;){if(y.return===null||y.return===m)return null;y=y.return}y.sibling.return=y.return,y=y.sibling}return null}function ni(){throw Error(r(321))}function $a(m,y){if(y===null)return!1;for(var C=0;C<y.length&&C<m.length;C++)if(!A(m[C],y[C]))return!1;return!0}function Nu(m,y,C,D,j,Q){return Pa=Q,ti=y,y.memoizedState=null,y.updateQueue=null,y.lanes=0,bi.H=m===null||m.memoizedState===null?bo:zo,Ic=!1,Q=C(D,j),Ic=!1,Fo&&(Q=Fp(y,C,D,j)),Ef(m),Q}function Ef(m){bi.H=Da;var y=qi!==null&&qi.next!==null;if(Pa=0,Or=qi=ti=null,Qa=!1,_s=0,lc=null,y)throw Error(r(300));m===null||Xs||(m=m.dependencies,m!==null&&Pu(m)&&(Xs=!0))}function Fp(m,y,C,D){ti=m;var j=0;do{if(Fo&&(lc=null),_s=0,Fo=!1,25<=j)throw Error(r(301));if(j+=1,Or=qi=null,m.updateQueue!=null){var Q=m.updateQueue;Q.lastEffect=null,Q.events=null,Q.stores=null,Q.memoCache!=null&&(Q.memoCache.index=0)}bi.H=uc,Q=y(C,D)}while(Fo);return Q}function I0(){var m=bi.H,y=m.useState()[0];return y=typeof y.then=="function"?vt(y):y,m=m.useState()[0],(qi!==null?qi.memoizedState:null)!==m&&(ti.flags|=1024),y}function Sf(){var m=dl!==0;return dl=0,m}function Tf(m,y,C){y.updateQueue=m.updateQueue,y.flags&=-2053,m.lanes&=~C}function Iu(m){if(Qa){for(m=m.memoizedState;m!==null;){var y=m.queue;y!==null&&(y.pending=null),m=m.next}Qa=!1}Pa=0,Or=qi=ti=null,Fo=!1,_s=dl=0,lc=null}function Ee(){var m={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Or===null?ti.memoizedState=Or=m:Or=Or.next=m,Or}function We(){if(qi===null){var m=ti.alternate;m=m!==null?m.memoizedState:null}else m=qi.next;var y=Or===null?ti.memoizedState:Or.next;if(y!==null)Or=y,qi=m;else{if(m===null)throw ti.alternate===null?Error(r(467)):Error(r(310));qi=m,m={memoizedState:qi.memoizedState,baseState:qi.baseState,baseQueue:qi.baseQueue,queue:qi.queue,next:null},Or===null?ti.memoizedState=Or=m:Or=Or.next=m}return Or}function vt(m){var y=_s;return _s+=1,lc===null&&(lc=[]),m=on(lc,m,y),y=ti,(Or===null?y.memoizedState:Or.next)===null&&(y=y.alternate,bi.H=y===null||y.memoizedState===null?bo:zo),m}function _t(m){if(m!==null&&typeof m=="object"){if(typeof m.then=="function")return vt(m);if(m.$$typeof===Vu)return Wa(m)}throw Error(r(438,String(m)))}function Ze(m){var y=null,C=ti.updateQueue;if(C!==null&&(y=C.memoCache),y==null){var D=ti.alternate;D!==null&&(D=D.updateQueue,D!==null&&(D=D.memoCache,D!=null&&(y={data:D.data.map(function(j){return j.slice()}),index:0})))}if(y==null&&(y={data:[],index:0}),C===null&&(C=su(),ti.updateQueue=C),C.memoCache=y,C=y.data[y.index],C===void 0)for(C=y.data[y.index]=Array(m),D=0;D<m;D++)C[D]=OR;return y.index++,C}function Vt(m,y){return typeof y=="function"?y(m):y}function rn(m){var y=We();return _n(y,qi,m)}function _n(m,y,C){var D=m.queue;if(D===null)throw Error(r(311));D.lastRenderedReducer=C;var j=m.baseQueue,Q=D.pending;if(Q!==null){if(j!==null){var Ce=j.next;j.next=Q.next,Q.next=Ce}y.baseQueue=j=Q,D.pending=null}if(Q=m.baseState,j===null)m.memoizedState=Q;else{y=j.next;var He=Ce=null,ut=null,kt=y,nn=!1;do{var Rn=kt.lane&-536870913;if(Rn!==kt.lane?(Bn&Rn)===Rn:(Pa&Rn)===Rn){var In=kt.revertLane;if(In===0)ut!==null&&(ut=ut.next={lane:0,revertLane:0,action:kt.action,hasEagerState:kt.hasEagerState,eagerState:kt.eagerState,next:null}),Rn===An&&(nn=!0);else if((Pa&In)===In){kt=kt.next,In===An&&(nn=!0);continue}else Rn={lane:0,revertLane:kt.revertLane,action:kt.action,hasEagerState:kt.hasEagerState,eagerState:kt.eagerState,next:null},ut===null?(He=ut=Rn,Ce=Q):ut=ut.next=Rn,ti.lanes|=In,Pc|=In;Rn=kt.action,Ic&&C(Q,Rn),Q=kt.hasEagerState?kt.eagerState:C(Q,Rn)}else In={lane:Rn,revertLane:kt.revertLane,action:kt.action,hasEagerState:kt.hasEagerState,eagerState:kt.eagerState,next:null},ut===null?(He=ut=In,Ce=Q):ut=ut.next=In,ti.lanes|=Rn,Pc|=Rn;kt=kt.next}while(kt!==null&&kt!==y);if(ut===null?Ce=Q:ut.next=He,!A(Q,m.memoizedState)&&(Xs=!0,nn&&(C=Kn,C!==null)))throw C;m.memoizedState=Q,m.baseState=Ce,m.baseQueue=ut,D.lastRenderedState=Q}return j===null&&(D.lanes=0),[m.memoizedState,D.dispatch]}function wn(m){var y=We(),C=y.queue;if(C===null)throw Error(r(311));C.lastRenderedReducer=m;var D=C.dispatch,j=C.pending,Q=y.memoizedState;if(j!==null){C.pending=null;var Ce=j=j.next;do Q=m(Q,Ce.action),Ce=Ce.next;while(Ce!==j);A(Q,y.memoizedState)||(Xs=!0),y.memoizedState=Q,y.baseQueue===null&&(y.baseState=Q),C.lastRenderedState=Q}return[Q,D]}function ci(m,y,C){var D=ti,j=We(),Q=At;if(Q){if(C===void 0)throw Error(r(407));C=C()}else C=y();var Ce=!A((qi||j).memoizedState,C);if(Ce&&(j.memoizedState=C,Xs=!0),j=j.queue,k0(yi.bind(null,D,j,m),[m]),j.getSnapshot!==y||Ce||Or!==null&&Or.memoizedState.tag&1){if(D.flags|=2048,Il(9,Nn.bind(null,D,j,C,y),{destroy:void 0},null),Dn===null)throw Error(r(349));Q||Pa&60||li(D,y,C)}return C}function li(m,y,C){m.flags|=16384,m={getSnapshot:y,value:C},y=ti.updateQueue,y===null?(y=su(),ti.updateQueue=y,y.stores=[m]):(C=y.stores,C===null?y.stores=[m]:C.push(m))}function Nn(m,y,C,D){y.value=C,y.getSnapshot=D,cr(y)&&Ds(m)}function yi(m,y,C){return C(function(){cr(y)&&Ds(m)})}function cr(m){var y=m.getSnapshot;m=m.value;try{var C=y();return!A(m,C)}catch{return!0}}function Ds(m){var y=rt(m,2);y!==null&&nc(y,m,2)}function xs(m){var y=Ee();if(typeof m=="function"){var C=m;if(m=C(),Ic){J(!0);try{C()}finally{J(!1)}}}return y.memoizedState=y.baseState=m,y.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Vt,lastRenderedState:m},y}function Zi(m,y,C,D){return m.baseState=C,_n(m,qi,typeof D=="function"?D:Vt)}function Jn(m,y,C,D,j){if(ry(m))throw Error(r(485));if(m=y.action,m!==null){var Q={payload:j,action:m,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(Ce){Q.listeners.push(Ce)}};bi.T!==null?C(!0):Q.isTransition=!1,D(Q),C=y.pending,C===null?(Q.next=y.pending=Q,Ci(y,Q)):(Q.next=C.next,y.pending=C.next=Q)}}function Ci(m,y){var C=y.action,D=y.payload,j=m.state;if(y.isTransition){var Q=bi.T,Ce={};bi.T=Ce;try{var He=C(j,D),ut=bi.S;ut!==null&&ut(Ce,He),Hn(m,y,He)}catch(kt){Ql(m,y,kt)}finally{bi.T=Q}}else try{Q=C(j,D),Hn(m,y,Q)}catch(kt){Ql(m,y,kt)}}function Hn(m,y,C){C!==null&&typeof C=="object"&&typeof C.then=="function"?C.then(function(D){Jo(m,y,D)},function(D){return Ql(m,y,D)}):Jo(m,y,C)}function Jo(m,y,C){y.status="fulfilled",y.value=C,uo(y),m.state=C,y=m.pending,y!==null&&(C=y.next,C===y?m.pending=null:(C=C.next,y.next=C,Ci(m,C)))}function Ql(m,y,C){var D=m.pending;if(m.pending=null,D!==null){D=D.next;do y.status="rejected",y.reason=C,uo(y),y=y.next;while(y!==D)}m.action=null}function uo(m){m=m.listeners;for(var y=0;y<m.length;y++)(0,m[y])()}function Th(m,y){return y}function ds(m,y){if(At){var C=Dn.formState;if(C!==null){e:{var D=ti;if(At){if(lt){var j=fg(lt,Nt);if(j){lt=sc(j),D=Sy(j);break e}}ke(D)}D=!1}D&&(y=C[0])}}C=Ee(),C.memoizedState=C.baseState=y,D={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Th,lastRenderedState:y},C.queue=D,C=KE.bind(null,ti,D),D.dispatch=C,D=xs(!1);var Q=wf.bind(null,ti,!1,D.queue);return D=Ee(),j={state:y,dispatch:null,action:m,pending:null},D.queue=j,C=Jn.bind(null,ti,j,Q,C),j.dispatch=C,D.memoizedState=m,[y,C,!1]}function Sn(m){var y=We();return ho(y,qi,m)}function ho(m,y,C){y=_n(m,y,Th)[0],m=rn(Vt)[0],y=typeof y=="object"&&y!==null&&typeof y.then=="function"?vt(y):y;var D=We(),j=D.queue,Q=j.dispatch;return C!==D.memoizedState&&(ti.flags|=2048,Il(9,Ws.bind(null,j,C),{destroy:void 0},null)),[y,Q,m]}function Ws(m,y){m.action=y}function Yn(m){var y=We(),C=qi;if(C!==null)return ho(y,C,m);We(),y=y.memoizedState,C=We();var D=C.queue.dispatch;return C.memoizedState=m,[y,D,!1]}function Il(m,y,C,D){return m={tag:m,create:y,inst:C,deps:D,next:null},y=ti.updateQueue,y===null&&(y=su(),ti.updateQueue=y),C=y.lastEffect,C===null?y.lastEffect=m.next=m:(D=C.next,C.next=m,m.next=D,y.lastEffect=m),m}function ma(){return We().memoizedState}function zp(m,y,C,D){var j=Ee();ti.flags|=m,j.memoizedState=Il(1|y,C,{destroy:void 0},D===void 0?null:D)}function xd(m,y,C,D){var j=We();D=D===void 0?null:D;var Q=j.memoizedState.inst;qi!==null&&D!==null&&$a(D,qi.memoizedState.deps)?j.memoizedState=Il(y,C,Q,D):(ti.flags|=m,j.memoizedState=Il(1|y,C,Q,D))}function xh(m,y){zp(8390656,8,m,y)}function k0(m,y){xd(2048,8,m,y)}function ty(m,y){return xd(4,2,m,y)}function P0(m,y){return xd(4,4,m,y)}function Qo(m,y){if(typeof y=="function"){m=m();var C=y(m);return function(){typeof C=="function"?C():y(null)}}if(y!=null)return m=m(),y.current=m,function(){y.current=null}}function D0(m,y,C){C=C!=null?C.concat([m]):null,xd(4,4,Qo.bind(null,y,m),C)}function ec(){}function fx(m,y){var C=We();y=y===void 0?null:y;var D=C.memoizedState;return y!==null&&$a(y,D[1])?D[0]:(C.memoizedState=[m,y],m)}function WE(m,y){var C=We();y=y===void 0?null:y;var D=C.memoizedState;if(y!==null&&$a(y,D[1]))return D[0];if(D=m(),Ic){J(!0);try{m()}finally{J(!1)}}return C.memoizedState=[D,y],D}function ku(m,y,C){return C===void 0||Pa&1073741824?m.memoizedState=y:(m.memoizedState=C,m=nS(),ti.lanes|=m,Pc|=m,C)}function Vm(m,y,C,D){return A(C,y)?C:ia.current!==null?(m=ku(m,C,D),A(m,y)||(Xs=!0),m):Pa&42?(m=nS(),ti.lanes|=m,Pc|=m,y):(Xs=!0,m.memoizedState=C)}function wd(m,y,C,D,j){var Q=go();ic(Q!==0&&8>Q?Q:8);var Ce=bi.T,He={};bi.T=He,wf(m,!1,y,C);try{var ut=j(),kt=bi.S;if(kt!==null&&kt(He,ut),ut!==null&&typeof ut=="object"&&typeof ut.then=="function"){var nn=le(ut,D);xf(m,y,nn,Do(m))}else xf(m,y,D,Do(m))}catch(Rn){xf(m,y,{then:function(){},status:"rejected",reason:Rn},Do())}finally{ic(Q),bi.T=Ce}}function Rs(m){var y=m.memoizedState;if(y!==null)return y;y={memoizedState:Dd,baseState:Dd,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Vt,lastRenderedState:Dd},next:null};var C={};return y.next={memoizedState:C,baseState:C,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Vt,lastRenderedState:C},next:null},m.memoizedState=y,m=m.alternate,m!==null&&(m.memoizedState=y),y}function wh(){return Wa(Ul)}function ny(){return We().memoizedState}function YE(){return We().memoizedState}function iy(m){for(var y=m.return;y!==null;){switch(y.tag){case 24:case 3:var C=Do();m=fe(C);var D=Ne(y,m,C);D!==null&&(nc(D,y,C),Be(D,y,C)),y={cache:ay()},m.payload=y;return}y=y.return}}function px(m,y,C){var D=Do();C={lane:D,revertLane:0,action:C,hasEagerState:!1,eagerState:null,next:null},ry(m)?XE(y,C):(C=Le(m,y,C,D),C!==null&&(nc(C,m,D),ZE(C,y,D)))}function KE(m,y,C){var D=Do();xf(m,y,C,D)}function xf(m,y,C,D){var j={lane:D,revertLane:0,action:C,hasEagerState:!1,eagerState:null,next:null};if(ry(m))XE(y,j);else{var Q=m.alternate;if(m.lanes===0&&(Q===null||Q.lanes===0)&&(Q=y.lastRenderedReducer,Q!==null))try{var Ce=y.lastRenderedState,He=Q(Ce,C);if(j.hasEagerState=!0,j.eagerState=He,A(He,Ce))return ze(m,y,j,0),Dn===null&&pe(),!1}catch{}finally{}if(C=Le(m,y,j,D),C!==null)return nc(C,m,D),ZE(C,y,D),!0}return!1}function wf(m,y,C,D){if(D={lane:2,revertLane:tn(),action:D,hasEagerState:!1,eagerState:null,next:null},ry(m)){if(y)throw Error(r(479))}else y=Le(m,C,D,2),y!==null&&nc(y,m,2)}function ry(m){var y=m.alternate;return m===ti||y!==null&&y===ti}function XE(m,y){Fo=Qa=!0;var C=m.pending;C===null?y.next=y:(y.next=C.next,C.next=y),m.pending=y}function ZE(m,y,C){if(C&4194176){var D=y.lanes;D&=m.pendingLanes,C|=D,y.lanes=C,Y(m,C)}}function L0(m,y,C,D){y=m.memoizedState,C=C(D,y),C=C==null?y:Ih({},y,C),m.memoizedState=C,m.lanes===0&&(m.updateQueue.baseState=C)}function sy(m,y,C,D,j,Q,Ce){return m=m.stateNode,typeof m.shouldComponentUpdate=="function"?m.shouldComponentUpdate(D,Q,Ce):y.prototype&&y.prototype.isPureReactComponent?!ht(C,D)||!ht(j,Q):!0}function JE(m,y,C,D){m=y.state,typeof y.componentWillReceiveProps=="function"&&y.componentWillReceiveProps(C,D),typeof y.UNSAFE_componentWillReceiveProps=="function"&&y.UNSAFE_componentWillReceiveProps(C,D),y.state!==m&&Bf.enqueueReplaceState(y,y.state,null)}function Ch(m,y){var C=y;if("ref"in y){C={};for(var D in y)D!=="ref"&&(C[D]=y[D])}if(m=m.defaultProps){C===y&&(C=Ih({},C));for(var j in m)C[j]===void 0&&(C[j]=m[j])}return C}function Gm(m,y){try{var C=m.onUncaughtError;C(y.value,{componentStack:y.stack})}catch(D){setTimeout(function(){throw D})}}function QE(m,y,C){try{var D=m.onCaughtError;D(C.value,{componentStack:C.stack,errorBoundary:y.tag===1?y.stateNode:null})}catch(j){setTimeout(function(){throw j})}}function Tc(m,y,C){return C=fe(C),C.tag=3,C.payload={element:null},C.callback=function(){Gm(m,y)},C}function Ls(m){return m=fe(m),m.tag=3,m}function Cd(m,y,C,D){var j=C.type.getDerivedStateFromError;if(typeof j=="function"){var Q=D.value;m.payload=function(){return j(Q)},m.callback=function(){QE(y,C,D)}}var Ce=C.stateNode;Ce!==null&&typeof Ce.componentDidCatch=="function"&&(m.callback=function(){QE(y,C,D),typeof j!="function"&&(jd===null?jd=new Set([this]):jd.add(this));var He=D.stack;this.componentDidCatch(D.value,{componentStack:He!==null?He:""})})}function mx(m,y,C,D,j){if(C.flags|=32768,D!==null&&typeof D=="object"&&typeof D.then=="function"){if(y=C.alternate,y!==null&&F0(y,C,j,!0),C=Cs.current,C!==null){switch(C.tag){case 13:return zs===null?Ya():C.alternate===null&&mr===0&&(mr=3),C.flags&=-257,C.flags|=65536,C.lanes=j,D===is?C.flags|=16384:(y=C.updateQueue,y===null?C.updateQueue=new Set([D]):y.add(D),ev(m,D,j)),!1;case 22:return C.flags|=65536,D===is?C.flags|=16384:(y=C.updateQueue,y===null?(y={transitions:null,markerInstances:null,retryQueue:new Set([D])},C.updateQueue=y):(C=y.retryQueue,C===null?y.retryQueue=new Set([D]):C.add(D)),ev(m,D,j)),!1}throw Error(r(435,C.tag))}return ev(m,D,j),Ya(),!1}if(At)return y=Cs.current,y!==null?(!(y.flags&65536)&&(y.flags|=256),y.flags|=65536,y.lanes=j,D!==Qn&&(m=Error(r(422),{cause:D}),Qe(X(m,C)))):(D!==Qn&&(y=Error(r(423),{cause:D}),Qe(X(y,C))),m=m.current.alternate,m.flags|=65536,j&=-j,m.lanes|=j,D=X(D,C),j=Tc(m.stateNode,D,j),tt(m,j),mr!==4&&(mr=2)),!1;var Q=Error(r(520),{cause:D});if(Q=X(Q,C),Fd===null?Fd=[Q]:Fd.push(Q),mr!==4&&(mr=2),y===null)return!0;D=X(D,C),C=y;do{switch(C.tag){case 3:return C.flags|=65536,m=j&-j,C.lanes|=m,m=Tc(C.stateNode,D,m),tt(C,m),!1;case 1:if(y=C.type,Q=C.stateNode,(C.flags&128)===0&&(typeof y.getDerivedStateFromError=="function"||Q!==null&&typeof Q.componentDidCatch=="function"&&(jd===null||!jd.has(Q))))return C.flags|=65536,j&=-j,C.lanes|=j,j=Ls(j),Cd(j,m,C,D),tt(C,j),!1}C=C.return}while(C!==null);return!1}function ga(m,y,C,D){y.child=m===null?vs(y,null,C,D):rs(y,m.child,C,D)}function gx(m,y,C,D,j){C=C.render;var Q=y.ref;if("ref"in D){var Ce={};for(var He in D)He!=="ref"&&(Ce[He]=D[He])}else Ce=D;return ol(y),D=Nu(m,y,C,Ce,Q,j),He=Sf(),m!==null&&!Xs?(Tf(m,y,j),Hi(m,y,j)):(At&&He&&Me(y),y.flags|=1,ga(m,y,D,j),y.child)}function U0(m,y,C,D,j){if(m===null){var Q=C.type;return typeof Q=="function"&&!tv(Q)&&Q.defaultProps===void 0&&C.compare===null?(y.tag=15,y.type=Q,vx(m,y,Q,D,j)):(m=iv(C.type,null,D,y,y.mode,j),m.ref=y.ref,m.return=y,y.child=m)}if(Q=m.child,!va(m,j)){var Ce=Q.memoizedProps;if(C=C.compare,C=C!==null?C:ht,C(Ce,D)&&m.ref===y.ref)return Hi(m,y,j)}return y.flags|=1,m=Nh(Q,D),m.ref=y.ref,m.return=y,y.child=m}function vx(m,y,C,D,j){if(m!==null){var Q=m.memoizedProps;if(ht(Q,D)&&m.ref===y.ref)if(Xs=!1,y.pendingProps=D=Q,va(m,j))m.flags&131072&&(Xs=!0);else return y.lanes=m.lanes,Hi(m,y,j)}return xc(m,y,C,D,j)}function Cf(m,y,C){var D=y.pendingProps,j=D.children,Q=(y.stateNode._pendingVisibility&2)!==0,Ce=m!==null?m.memoizedState:null;if(fo(m,y),D.mode==="hidden"||Q){if(y.flags&128){if(D=Ce!==null?Ce.baseLanes|C:C,m!==null){for(j=y.child=m.child,Q=0;j!==null;)Q=Q|j.lanes|j.childLanes,j=j.sibling;y.childLanes=Q&~D}else y.childLanes=0,y.child=null;return qm(m,y,D,C)}if(C&536870912)y.memoizedState={baseLanes:0,cachePool:null},m!==null&&oy(y,Ce!==null?Ce.cachePool:null),Ce!==null?wi(y,Ce):ai(),zn(y);else return y.lanes=y.childLanes=536870912,qm(m,y,Ce!==null?Ce.baseLanes|C:C,C)}else Ce!==null?(oy(y,Ce.cachePool),wi(y,Ce),Un(),y.memoizedState=null):(m!==null&&oy(y,null),ai(),Un());return ga(m,y,j,C),y.child}function qm(m,y,C,D){var j=Rf();return j=j===null?null:{parent:ru?Xr._currentValue:Xr._currentValue2,pool:j},y.memoizedState={baseLanes:C,cachePool:j},m!==null&&oy(y,null),ai(),zn(y),m!==null&&F0(m,y,D,!0),null}function fo(m,y){var C=y.ref;if(C===null)m!==null&&m.ref!==null&&(y.flags|=2097664);else{if(typeof C!="function"&&typeof C!="object")throw Error(r(284));(m===null||m.ref!==C)&&(y.flags|=2097664)}}function xc(m,y,C,D,j){return ol(y),C=Nu(m,y,C,D,void 0,j),D=Sf(),m!==null&&!Xs?(Tf(m,y,j),Hi(m,y,j)):(At&&D&&Me(y),y.flags|=1,ga(m,y,C,j),y.child)}function $m(m,y,C,D,j,Q){return ol(y),y.updateQueue=null,C=Fp(y,D,C,j),Ef(m),D=Sf(),m!==null&&!Xs?(Tf(m,y,Q),Hi(m,y,Q)):(At&&D&&Me(y),y.flags|=1,ga(m,y,C,Q),y.child)}function _x(m,y,C,D,j){if(ol(y),y.stateNode===null){var Q=oc,Ce=C.contextType;typeof Ce=="object"&&Ce!==null&&(Q=Wa(Ce)),Q=new C(D,Q),y.memoizedState=Q.state!==null&&Q.state!==void 0?Q.state:null,Q.updater=Bf,y.stateNode=Q,Q._reactInternals=y,Q=y.stateNode,Q.props=D,Q.state=y.memoizedState,Q.refs={},z(y),Ce=C.contextType,Q.context=typeof Ce=="object"&&Ce!==null?Wa(Ce):oc,Q.state=y.memoizedState,Ce=C.getDerivedStateFromProps,typeof Ce=="function"&&(L0(y,C,Ce,D),Q.state=y.memoizedState),typeof C.getDerivedStateFromProps=="function"||typeof Q.getSnapshotBeforeUpdate=="function"||typeof Q.UNSAFE_componentWillMount!="function"&&typeof Q.componentWillMount!="function"||(Ce=Q.state,typeof Q.componentWillMount=="function"&&Q.componentWillMount(),typeof Q.UNSAFE_componentWillMount=="function"&&Q.UNSAFE_componentWillMount(),Ce!==Q.state&&Bf.enqueueReplaceState(Q,Q.state,null),Cn(y,D,Q,j),Tt(),Q.state=y.memoizedState),typeof Q.componentDidMount=="function"&&(y.flags|=4194308),D=!0}else if(m===null){Q=y.stateNode;var He=y.memoizedProps,ut=Ch(C,He);Q.props=ut;var kt=Q.context,nn=C.contextType;Ce=oc,typeof nn=="object"&&nn!==null&&(Ce=Wa(nn));var Rn=C.getDerivedStateFromProps;nn=typeof Rn=="function"||typeof Q.getSnapshotBeforeUpdate=="function",He=y.pendingProps!==He,nn||typeof Q.UNSAFE_componentWillReceiveProps!="function"&&typeof Q.componentWillReceiveProps!="function"||(He||kt!==Ce)&&JE(y,Q,D,Ce),Wi=!1;var In=y.memoizedState;Q.state=In,Cn(y,D,Q,j),Tt(),kt=y.memoizedState,He||In!==kt||Wi?(typeof Rn=="function"&&(L0(y,C,Rn,D),kt=y.memoizedState),(ut=Wi||sy(y,C,ut,D,In,kt,Ce))?(nn||typeof Q.UNSAFE_componentWillMount!="function"&&typeof Q.componentWillMount!="function"||(typeof Q.componentWillMount=="function"&&Q.componentWillMount(),typeof Q.UNSAFE_componentWillMount=="function"&&Q.UNSAFE_componentWillMount()),typeof Q.componentDidMount=="function"&&(y.flags|=4194308)):(typeof Q.componentDidMount=="function"&&(y.flags|=4194308),y.memoizedProps=D,y.memoizedState=kt),Q.props=D,Q.state=kt,Q.context=Ce,D=ut):(typeof Q.componentDidMount=="function"&&(y.flags|=4194308),D=!1)}else{Q=y.stateNode,W(m,y),Ce=y.memoizedProps,nn=Ch(C,Ce),Q.props=nn,Rn=y.pendingProps,In=Q.context,kt=C.contextType,ut=oc,typeof kt=="object"&&kt!==null&&(ut=Wa(kt)),He=C.getDerivedStateFromProps,(kt=typeof He=="function"||typeof Q.getSnapshotBeforeUpdate=="function")||typeof Q.UNSAFE_componentWillReceiveProps!="function"&&typeof Q.componentWillReceiveProps!="function"||(Ce!==Rn||In!==ut)&&JE(y,Q,D,ut),Wi=!1,In=y.memoizedState,Q.state=In,Cn(y,D,Q,j),Tt();var nr=y.memoizedState;Ce!==Rn||In!==nr||Wi||m!==null&&m.dependencies!==null&&Pu(m.dependencies)?(typeof He=="function"&&(L0(y,C,He,D),nr=y.memoizedState),(nn=Wi||sy(y,C,nn,D,In,nr,ut)||m!==null&&m.dependencies!==null&&Pu(m.dependencies))?(kt||typeof Q.UNSAFE_componentWillUpdate!="function"&&typeof Q.componentWillUpdate!="function"||(typeof Q.componentWillUpdate=="function"&&Q.componentWillUpdate(D,nr,ut),typeof Q.UNSAFE_componentWillUpdate=="function"&&Q.UNSAFE_componentWillUpdate(D,nr,ut)),typeof Q.componentDidUpdate=="function"&&(y.flags|=4),typeof Q.getSnapshotBeforeUpdate=="function"&&(y.flags|=1024)):(typeof Q.componentDidUpdate!="function"||Ce===m.memoizedProps&&In===m.memoizedState||(y.flags|=4),typeof Q.getSnapshotBeforeUpdate!="function"||Ce===m.memoizedProps&&In===m.memoizedState||(y.flags|=1024),y.memoizedProps=D,y.memoizedState=nr),Q.props=D,Q.state=nr,Q.context=ut,D=nn):(typeof Q.componentDidUpdate!="function"||Ce===m.memoizedProps&&In===m.memoizedState||(y.flags|=4),typeof Q.getSnapshotBeforeUpdate!="function"||Ce===m.memoizedProps&&In===m.memoizedState||(y.flags|=1024),D=!1)}return Q=D,fo(m,y),D=(y.flags&128)!==0,Q||D?(Q=y.stateNode,C=D&&typeof C.getDerivedStateFromError!="function"?null:Q.render(),y.flags|=1,m!==null&&D?(y.child=rs(y,m.child,null,j),y.child=rs(y,null,C,j)):ga(m,y,C,j),y.memoizedState=Q.state,m=y.child):m=Hi(m,y,j),m}function Oa(m,y,C,D){return Se(),y.flags|=256,ga(m,y,C,D),y.child}function ta(m){return{baseLanes:m,cachePool:yx()}}function B0(m,y,C){return m=m!==null?m.childLanes&~C:0,y&&(m|=ou),m}function Ad(m,y,C){var D=y.pendingProps,j=!1,Q=(y.flags&128)!==0,Ce;if((Ce=Q)||(Ce=m!==null&&m.memoizedState===null?!1:(pr.current&2)!==0),Ce&&(j=!0,y.flags&=-129),Ce=(y.flags&32)!==0,y.flags&=-33,m===null){if(At){if(j?sn(y):Un(),At){var He=lt,ut;(ut=He)&&(He=Sr(He,Nt),He!==null?(y.memoizedState={dehydrated:He,treeContext:oe!==null?{id:de,overflow:me}:null,retryLane:536870912},ut=n(18,null,null,0),ut.stateNode=He,ut.return=y,y.child=ut,xe=y,lt=null,ut=!0):ut=!1),ut||ke(y)}if(He=y.memoizedState,He!==null&&(He=He.dehydrated,He!==null))return Ea(He)?y.lanes=16:y.lanes=536870912,null;pi(y)}return He=D.children,D=D.fallback,j?(Un(),j=y.mode,He=ft({mode:"hidden",children:He},j),D=Pf(D,j,C,null),He.return=y,D.return=y,He.sibling=D,y.child=He,j=y.child,j.memoizedState=ta(C),j.childLanes=B0(m,Ce,C),y.memoizedState=Bd,D):(sn(y),jp(y,He))}if(ut=m.memoizedState,ut!==null&&(He=ut.dehydrated,He!==null)){if(Q)y.flags&256?(sn(y),y.flags&=-257,y=st(m,y,C)):y.memoizedState!==null?(Un(),y.child=m.child,y.flags|=128,y=null):(Un(),j=D.fallback,He=y.mode,D=ft({mode:"visible",children:D.children},He),j=Pf(j,He,C,null),j.flags|=2,D.return=y,j.return=y,D.sibling=j,y.child=D,rs(y,m.child,null,C),D=y.child,D.memoizedState=ta(C),D.childLanes=B0(m,Ce,C),y.memoizedState=Bd,y=j);else if(sn(y),Ea(He))Ce=Lh(He).digest,D=Error(r(419)),D.stack="",D.digest=Ce,Qe({value:D,source:null,stack:null}),y=st(m,y,C);else if(Xs||F0(m,y,C,!1),Ce=(C&m.childLanes)!==0,Xs||Ce){if(Ce=Dn,Ce!==null){if(D=C&-C,D&42)D=1;else switch(D){case 2:D=1;break;case 8:D=4;break;case 32:D=16;break;case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:D=64;break;case 268435456:D=134217728;break;default:D=0}if(D=D&(Ce.suspendedLanes|C)?0:D,D!==0&&D!==ut.retryLane)throw ut.retryLane=D,rt(m,D),nc(Ce,m,D),tm}dg(He)||Ya(),y=st(m,y,C)}else dg(He)?(y.flags|=128,y.child=m.child,y=oS.bind(null,m),Nx(He,y),y=null):(m=ut.treeContext,Dl&&(lt=ES(He),xe=y,At=!0,Jt=null,Nt=!1,m!==null&&(se[Z++]=de,se[Z++]=me,se[Z++]=oe,de=m.id,me=m.overflow,oe=y)),y=jp(y,D.children),y.flags|=4096);return y}return j?(Un(),j=D.fallback,He=y.mode,ut=m.child,Q=ut.sibling,D=Nh(ut,{mode:"hidden",children:D.children}),D.subtreeFlags=ut.subtreeFlags&31457280,Q!==null?j=Nh(Q,j):(j=Pf(j,He,C,null),j.flags|=2),j.return=y,D.return=y,D.sibling=j,y.child=D,D=j,j=y.child,He=m.child.memoizedState,He===null?He=ta(C):(ut=He.cachePool,ut!==null?(Q=ru?Xr._currentValue:Xr._currentValue2,ut=ut.parent!==Q?{parent:Q,pool:Q}:ut):ut=yx(),He={baseLanes:He.baseLanes|C,cachePool:ut}),j.memoizedState=He,j.childLanes=B0(m,Ce,C),y.memoizedState=Bd,D):(sn(y),C=m.child,m=C.sibling,C=Nh(C,{mode:"visible",children:D.children}),C.return=y,C.sibling=null,m!==null&&(Ce=y.deletions,Ce===null?(y.deletions=[m],y.flags|=16):Ce.push(m)),y.child=C,y.memoizedState=null,C)}function jp(m,y){return y=ft({mode:"visible",children:y},m.mode),y.return=m,m.child=y}function ft(m,y){return cS(m,y,0,null)}function st(m,y,C){return rs(y,m.child,null,C),m=jp(y,y.pendingProps.children),m.flags|=2,y.memoizedState=null,m}function Bt(m,y,C){m.lanes|=y;var D=m.alternate;D!==null&&(D.lanes|=y),al(m.return,y,C)}function fn(m,y,C,D,j){var Q=m.memoizedState;Q===null?m.memoizedState={isBackwards:y,rendering:null,renderingStartTime:0,last:D,tail:C,tailMode:j}:(Q.isBackwards=y,Q.rendering=null,Q.renderingStartTime=0,Q.last=D,Q.tail=C,Q.tailMode=j)}function Zt(m,y,C){var D=y.pendingProps,j=D.revealOrder,Q=D.tail;if(ga(m,y,D.children,C),D=pr.current,D&2)D=D&1|2,y.flags|=128;else{if(m!==null&&m.flags&128)e:for(m=y.child;m!==null;){if(m.tag===13)m.memoizedState!==null&&Bt(m,C,y);else if(m.tag===19)Bt(m,C,y);else if(m.child!==null){m.child.return=m,m=m.child;continue}if(m===y)break e;for(;m.sibling===null;){if(m.return===null||m.return===y)break e;m=m.return}m.sibling.return=m.return,m=m.sibling}D&=1}switch(b(pr,D),j){case"forwards":for(C=y.child,j=null;C!==null;)m=C.alternate,m!==null&&dr(m)===null&&(j=C),C=C.sibling;C=j,C===null?(j=y.child,y.child=null):(j=C.sibling,C.sibling=null),fn(y,!1,j,C,Q);break;case"backwards":for(C=null,j=y.child,y.child=null;j!==null;){if(m=j.alternate,m!==null&&dr(m)===null){y.child=j;break}m=j.sibling,j.sibling=C,C=j,j=m}fn(y,!0,C,null,Q);break;case"together":fn(y,!1,null,null,void 0);break;default:y.memoizedState=null}return y.child}function Hi(m,y,C){if(m!==null&&(y.dependencies=m.dependencies),Pc|=y.lanes,!(C&y.childLanes))if(m!==null){if(F0(m,y,C,!1),(C&y.childLanes)===0)return null}else return null;if(m!==null&&y.child!==m.child)throw Error(r(153));if(y.child!==null){for(m=y.child,C=Nh(m,m.pendingProps),y.child=C,C.return=y;m.sibling!==null;)m=m.sibling,C=C.sibling=Nh(m,m.pendingProps),C.return=y;C.sibling=null}return y.child}function va(m,y){return m.lanes&y?!0:(m=m.dependencies,!!(m!==null&&Pu(m)))}function Ah(m,y,C){switch(y.tag){case 3:Te(y,y.stateNode.containerInfo),eu(y,Xr,m.memoizedState.cache),Se();break;case 27:case 5:ge(y);break;case 4:Te(y,y.stateNode.containerInfo);break;case 10:eu(y,y.type,y.memoizedProps.value);break;case 13:var D=y.memoizedState;if(D!==null)return D.dehydrated!==null?(sn(y),y.flags|=128,null):C&y.child.childLanes?Ad(m,y,C):(sn(y),m=Hi(m,y,C),m!==null?m.sibling:null);sn(y);break;case 19:var j=(m.flags&128)!==0;if(D=(C&y.childLanes)!==0,D||(F0(m,y,C,!1),D=(C&y.childLanes)!==0),j){if(D)return Zt(m,y,C);y.flags|=128}if(j=y.memoizedState,j!==null&&(j.rendering=null,j.tail=null,j.lastEffect=null),b(pr,pr.current),D)break;return null;case 22:case 23:return y.lanes=0,Cf(m,y,C);case 24:eu(y,Xr,m.memoizedState.cache)}return Hi(m,y,C)}function Ji(m,y,C){if(m!==null)if(m.memoizedProps!==y.pendingProps)Xs=!0;else{if(!va(m,C)&&!(y.flags&128))return Xs=!1,Ah(m,y,C);Xs=!!(m.flags&131072)}else Xs=!1,At&&y.flags&1048576&&ce(y,ne,y.index);switch(y.lanes=0,y.tag){case 16:e:{m=y.pendingProps;var D=y.elementType,j=D._init;if(D=j(D._payload),y.type=D,typeof D=="function")tv(D)?(m=Ch(D,m),y.tag=1,y=_x(null,y,D,m,C)):(y.tag=0,y=xc(null,y,D,m,C));else{if(D!=null){if(j=D.$$typeof,j===rg){y.tag=11,y=gx(null,y,D,m,C);break e}else if(j===ov){y.tag=14,y=U0(null,y,D,m,C);break e}}throw y=a(D)||D,Error(r(306,y,""))}}return y;case 0:return xc(m,y,y.type,y.pendingProps,C);case 1:return D=y.type,j=Ch(D,y.pendingProps),_x(m,y,D,j,C);case 3:e:{if(Te(y,y.stateNode.containerInfo),m===null)throw Error(r(387));var Q=y.pendingProps;j=y.memoizedState,D=j.element,W(m,y),Cn(y,Q,null,C);var Ce=y.memoizedState;if(Q=Ce.cache,eu(y,Xr,Q),Q!==j.cache&&Wm(y,[Xr],C,!0),Tt(),Q=Ce.element,Dl&&j.isDehydrated)if(j={element:Q,isDehydrated:!1,cache:Ce.cache},y.updateQueue.baseState=j,y.memoizedState=j,y.flags&256){y=Oa(m,y,Q,C);break e}else if(Q!==D){D=X(Error(r(424)),y),Qe(D),y=Oa(m,y,Q,C);break e}else for(Dl&&(lt=Bo(y.stateNode.containerInfo),xe=y,At=!0,Jt=null,Nt=!0),C=vs(y,null,Q,C),y.child=C;C;)C.flags=C.flags&-3|4096,C=C.sibling;else{if(Se(),Q===D){y=Hi(m,y,C);break e}ga(m,y,Q,C)}y=y.child}return y;case 26:if(vo)return fo(m,y),m===null?(C=Bh(y.type,null,y.pendingProps,null))?y.memoizedState=C:At||(y.stateNode=BR(y.type,y.pendingProps,qe.current,y)):y.memoizedState=Bh(y.type,m.memoizedProps,y.pendingProps,m.memoizedState),null;case 27:if(ka)return ge(y),m===null&&ka&&At&&(D=y.stateNode=gg(y.type,y.pendingProps,qe.current,Pe.current,!1),xe=y,Nt=!0,lt=Uo(D)),D=y.pendingProps.children,m!==null||At?ga(m,y,D,C):y.child=rs(y,null,D,C),fo(m,y),y.child;case 5:return m===null&&At&&(Xu(y.type,y.pendingProps,Pe.current),(j=D=lt)&&(D=Ix(D,y.type,y.pendingProps,Nt),D!==null?(y.stateNode=D,xe=y,lt=Uo(D),Nt=!1,j=!0):j=!1),j||ke(y)),ge(y),j=y.type,Q=y.pendingProps,Ce=m!==null?m.memoizedProps:null,D=Q.children,og(j,Q)?D=null:Ce!==null&&og(j,Ce)&&(y.flags|=32),y.memoizedState!==null&&(j=Nu(m,y,I0,null,null,C),ru?Ul._currentValue=j:Ul._currentValue2=j),fo(m,y),ga(m,y,D,C),y.child;case 6:return m===null&&At&&(Zu(y.pendingProps,Pe.current),(m=C=lt)&&(C=Ld(C,y.pendingProps,Nt),C!==null?(y.stateNode=C,xe=y,lt=null,m=!0):m=!1),m||ke(y)),null;case 13:return Ad(m,y,C);case 4:return Te(y,y.stateNode.containerInfo),D=y.pendingProps,m===null?y.child=rs(y,null,D,C):ga(m,y,D,C),y.child;case 11:return gx(m,y,y.type,y.pendingProps,C);case 7:return ga(m,y,y.pendingProps,C),y.child;case 8:return ga(m,y,y.pendingProps.children,C),y.child;case 12:return ga(m,y,y.pendingProps.children,C),y.child;case 10:return D=y.pendingProps,eu(y,y.type,D.value),ga(m,y,D.children,C),y.child;case 9:return j=y.type._context,D=y.pendingProps.children,ol(y),j=Wa(j),D=D(j),y.flags|=1,ga(m,y,D,C),y.child;case 14:return U0(m,y,y.type,y.pendingProps,C);case 15:return vx(m,y,y.type,y.pendingProps,C);case 19:return Zt(m,y,C);case 22:return Cf(m,y,C);case 24:return ol(y),D=Wa(Xr),m===null?(j=Rf(),j===null&&(j=Dn,Q=ay(),j.pooledCache=Q,Q.refCount++,Q!==null&&(j.pooledCacheLanes|=C),j=Q),y.memoizedState={parent:D,cache:j},z(y),eu(y,Xr,j)):(m.lanes&C&&(W(m,y),Cn(y,null,null,C),Tt()),j=m.memoizedState,Q=y.memoizedState,j.parent!==D?(j={parent:D,cache:D},y.memoizedState=j,y.lanes===0&&(y.memoizedState=y.updateQueue.baseState=j),eu(y,Xr,D)):(D=Q.cache,eu(y,Xr,D),D!==j.cache&&Wm(y,[Xr],C,!0))),ga(m,y,y.pendingProps.children,C),y.child;case 29:throw y.pendingProps}throw Error(r(156,y.tag))}function eu(m,y,C){ru?(b(jh,y._currentValue),y._currentValue=C):(b(jh,y._currentValue2),y._currentValue2=C)}function Rh(m){var y=jh.current;ru?m._currentValue=y:m._currentValue2=y,v(jh)}function al(m,y,C){for(;m!==null;){var D=m.alternate;if((m.childLanes&y)!==y?(m.childLanes|=y,D!==null&&(D.childLanes|=y)):D!==null&&(D.childLanes&y)!==y&&(D.childLanes|=y),m===C)break;m=m.return}}function Wm(m,y,C,D){var j=m.child;for(j!==null&&(j.return=m);j!==null;){var Q=j.dependencies;if(Q!==null){var Ce=j.child;Q=Q.firstContext;e:for(;Q!==null;){var He=Q;Q=j;for(var ut=0;ut<y.length;ut++)if(He.context===y[ut]){Q.lanes|=C,He=Q.alternate,He!==null&&(He.lanes|=C),al(Q.return,C,m),D||(Ce=null);break e}Q=He.next}}else if(j.tag===18){if(Ce=j.return,Ce===null)throw Error(r(341));Ce.lanes|=C,Q=Ce.alternate,Q!==null&&(Q.lanes|=C),al(Ce,C,m),Ce=null}else Ce=j.child;if(Ce!==null)Ce.return=j;else for(Ce=j;Ce!==null;){if(Ce===m){Ce=null;break}if(j=Ce.sibling,j!==null){j.return=Ce.return,Ce=j;break}Ce=Ce.return}j=Ce}}function F0(m,y,C,D){m=null;for(var j=y,Q=!1;j!==null;){if(!Q){if(j.flags&524288)Q=!0;else if(j.flags&262144)break}if(j.tag===10){var Ce=j.alternate;if(Ce===null)throw Error(r(387));if(Ce=Ce.memoizedProps,Ce!==null){var He=j.type;A(j.pendingProps.value,Ce.value)||(m!==null?m.push(He):m=[He])}}else if(j===Ie.current){if(Ce=j.alternate,Ce===null)throw Error(r(387));Ce.memoizedState.memoizedState!==j.memoizedState.memoizedState&&(m!==null?m.push(Ul):m=[Ul])}j=j.return}m!==null&&Wm(y,m,C,D),y.flags|=262144}function Pu(m){for(m=m.firstContext;m!==null;){var y=m.context;if(!A(ru?y._currentValue:y._currentValue2,m.memoizedValue))return!0;m=m.next}return!1}function ol(m){Ju=m,Fl=null,m=m.dependencies,m!==null&&(m.firstContext=null)}function Wa(m){return z0(Ju,m)}function Mr(m,y){return Ju===null&&ol(m),z0(m,y)}function z0(m,y){var C=ru?y._currentValue:y._currentValue2;if(y={context:y,memoizedValue:C,next:null},Fl===null){if(m===null)throw Error(r(308));Fl=y,m.dependencies={lanes:0,firstContext:y},m.flags|=524288}else Fl=Fl.next=y;return C}function ay(){return{controller:new yv,data:new Map,refCount:0}}function Af(m){m.refCount--,m.refCount===0&&Cy(bv,function(){m.controller.abort()})}function Rf(){var m=Hh.current;return m!==null?m:Dn.pooledCache}function oy(m,y){y===null?b(Hh,Hh.current):b(Hh,y.pool)}function yx(){var m=Rf();return m===null?null:{parent:ru?Xr._currentValue:Xr._currentValue2,pool:m}}function tc(m){m.flags|=4}function Rd(m,y){if(m!==null&&m.child===y.child)return!1;if(y.flags&16)return!0;for(m=y.child;m!==null;){if(m.flags&13878||m.subtreeFlags&13878)return!0;m=m.sibling}return!1}function Mh(m,y,C,D){if(Lo)for(C=y.child;C!==null;){if(C.tag===5||C.tag===6)Jp(m,C.stateNode);else if(!(C.tag===4||ka&&C.tag===27)&&C.child!==null){C.child.return=C,C=C.child;continue}if(C===y)break;for(;C.sibling===null;){if(C.return===null||C.return===y)return;C=C.return}C.sibling.return=C.return,C=C.sibling}else if($u)for(var j=y.child;j!==null;){if(j.tag===5){var Q=j.stateNode;C&&D&&(Q=hg(Q,j.type,j.memoizedProps)),Jp(m,Q)}else if(j.tag===6)Q=j.stateNode,C&&D&&(Q=Za(Q,j.memoizedProps)),Jp(m,Q);else if(j.tag!==4){if(j.tag===22&&j.memoizedState!==null)Q=j.child,Q!==null&&(Q.return=j),Mh(m,j,!0,!0);else if(j.child!==null){j.child.return=j,j=j.child;continue}}if(j===y)break;for(;j.sibling===null;){if(j.return===null||j.return===y)return;j=j.return}j.sibling.return=j.return,j=j.sibling}}function eS(m,y,C,D){if($u)for(var j=y.child;j!==null;){if(j.tag===5){var Q=j.stateNode;C&&D&&(Q=hg(Q,j.type,j.memoizedProps)),Ku(m,Q)}else if(j.tag===6)Q=j.stateNode,C&&D&&(Q=Za(Q,j.memoizedProps)),Ku(m,Q);else if(j.tag!==4){if(j.tag===22&&j.memoizedState!==null)Q=j.child,Q!==null&&(Q.return=j),eS(m,j,!(j.memoizedProps!==null&&j.memoizedProps.mode==="manual"),!0);else if(j.child!==null){j.child.return=j,j=j.child;continue}}if(j===y)break;for(;j.sibling===null;){if(j.return===null||j.return===y)return;j=j.return}j.sibling.return=j.return,j=j.sibling}}function Ym(m,y){if($u&&Rd(m,y)){m=y.stateNode;var C=m.containerInfo,D=Ey();eS(D,y,!1,!1),m.pendingChildren=D,tc(y),em(C,D)}}function Km(m,y,C,D){if(Lo)m.memoizedProps!==D&&tc(y);else if($u){var j=m.stateNode,Q=m.memoizedProps;if((m=Rd(m,y))||Q!==D){var Ce=Pe.current;Q=mv(j,C,Q,D,!m,null),Q===j?y.stateNode=j:(dS(Q,C,D,Ce)&&tc(y),y.stateNode=Q,m?Mh(Q,y,!1,!1):tc(y))}else y.stateNode=j}}function j0(m,y,C){if(fS(y,C)){if(m.flags|=16777216,!Yu(y,C))if(iS())m.flags|=8192;else throw kr=is,gs}else m.flags&=-16777217}function Mf(m,y){if(Ty(y)){if(m.flags|=16777216,!xS(y))if(iS())m.flags|=8192;else throw kr=is,gs}else m.flags&=-16777217}function H0(m,y){y!==null&&(m.flags|=4),m.flags&16384&&(y=m.tag!==22?P():536870912,m.lanes|=y,nm|=y)}function Du(m,y){if(!At)switch(m.tailMode){case"hidden":y=m.tail;for(var C=null;y!==null;)y.alternate!==null&&(C=y),y=y.sibling;C===null?m.tail=null:C.sibling=null;break;case"collapsed":C=m.tail;for(var D=null;C!==null;)C.alternate!==null&&(D=C),C=C.sibling;D===null?y||m.tail===null?m.tail=null:m.tail.sibling=null:D.sibling=null}}function Vr(m){var y=m.alternate!==null&&m.alternate.child===m.child,C=0,D=0;if(y)for(var j=m.child;j!==null;)C|=j.lanes|j.childLanes,D|=j.subtreeFlags&31457280,D|=j.flags&31457280,j.return=m,j=j.sibling;else for(j=m.child;j!==null;)C|=j.lanes|j.childLanes,D|=j.subtreeFlags,D|=j.flags,j.return=m,j=j.sibling;return m.subtreeFlags|=D,m.childLanes=C,y}function V0(m,y,C){var D=y.pendingProps;switch(Fe(y),y.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Vr(y),null;case 1:return Vr(y),null;case 3:return C=y.stateNode,D=null,m!==null&&(D=m.memoizedState.cache),y.memoizedState.cache!==D&&(y.flags|=2048),Rh(Xr),Re(),C.pendingContext&&(C.context=C.pendingContext,C.pendingContext=null),(m===null||m.child===null)&&(ye(y)?tc(y):m===null||m.memoizedState.isDehydrated&&!(y.flags&256)||(y.flags|=1024,Jt!==null&&(X0(Jt),Jt=null))),Ym(m,y),Vr(y),null;case 26:if(vo){C=y.type;var j=y.memoizedState;return m===null?(tc(y),j!==null?(Vr(y),Mf(y,j)):(Vr(y),j0(y,C,D))):j?j!==m.memoizedState?(tc(y),Vr(y),Mf(y,j)):(Vr(y),y.flags&=-16777217):(Lo?m.memoizedProps!==D&&tc(y):Km(m,y,C,D),Vr(y),j0(y,C,D)),null}case 27:if(ka){if(_e(y),C=qe.current,j=y.type,m!==null&&y.stateNode!=null)Lo?m.memoizedProps!==D&&tc(y):Km(m,y,j,D);else{if(!D){if(y.stateNode===null)throw Error(r(166));return Vr(y),null}m=Pe.current,ye(y)?gt(y,m):(m=gg(j,D,C,m,!0),y.stateNode=m,tc(y))}return Vr(y),null}case 5:if(_e(y),C=y.type,m!==null&&y.stateNode!=null)Km(m,y,C,D);else{if(!D){if(y.stateNode===null)throw Error(r(166));return Vr(y),null}m=Pe.current,ye(y)?gt(y,m):(j=Zp(C,D,qe.current,m,y),Mh(j,y,!1,!1),y.stateNode=j,dS(j,C,D,m)&&tc(y))}return Vr(y),j0(y,y.type,y.pendingProps),null;case 6:if(m&&y.stateNode!=null)C=m.memoizedProps,Lo?C!==D&&tc(y):$u&&(C!==D?(y.stateNode=lv(D,qe.current,Pe.current,y),tc(y)):y.stateNode=m.stateNode);else{if(typeof D!="string"&&y.stateNode===null)throw Error(r(166));if(m=qe.current,C=Pe.current,ye(y)){if(!Dl)throw Error(r(176));if(m=y.stateNode,C=y.memoizedProps,D=null,j=xe,j!==null)switch(j.tag){case 27:case 5:D=j.memoizedProps}PR(m,C,y,D)||ke(y)}else y.stateNode=lv(D,m,C,y)}return Vr(y),null;case 13:if(D=y.memoizedState,m===null||m.memoizedState!==null&&m.memoizedState.dehydrated!==null){if(j=ye(y),D!==null&&D.dehydrated!==null){if(m===null){if(!j)throw Error(r(318));if(!Dl)throw Error(r(344));if(j=y.memoizedState,j=j!==null?j.dehydrated:null,!j)throw Error(r(317));DR(j,y)}else Se(),!(y.flags&128)&&(y.memoizedState=null),y.flags|=4;Vr(y),j=!1}else Jt!==null&&(X0(Jt),Jt=null),j=!0;if(!j)return y.flags&256?(pi(y),y):(pi(y),null)}if(pi(y),y.flags&128)return y.lanes=C,y;if(C=D!==null,m=m!==null&&m.memoizedState!==null,C){D=y.child,j=null,D.alternate!==null&&D.alternate.memoizedState!==null&&D.alternate.memoizedState.cachePool!==null&&(j=D.alternate.memoizedState.cachePool.pool);var Q=null;D.memoizedState!==null&&D.memoizedState.cachePool!==null&&(Q=D.memoizedState.cachePool.pool),Q!==j&&(D.flags|=2048)}return C!==m&&C&&(y.child.flags|=8192),H0(y,y.updateQueue),Vr(y),null;case 4:return Re(),Ym(m,y),m===null&&NR(y.stateNode.containerInfo),Vr(y),null;case 10:return Rh(y.type),Vr(y),null;case 19:if(v(pr),j=y.memoizedState,j===null)return Vr(y),null;if(D=(y.flags&128)!==0,Q=j.rendering,Q===null)if(D)Du(j,!1);else{if(mr!==0||m!==null&&m.flags&128)for(m=y.child;m!==null;){if(Q=dr(m),Q!==null){for(y.flags|=128,Du(j,!1),m=Q.updateQueue,y.updateQueue=m,H0(y,m),y.subtreeFlags=0,m=C,C=y.child;C!==null;)nv(C,m),C=C.sibling;return b(pr,pr.current&1|2),y.child}m=m.sibling}j.tail!==null&&ei()>Sv&&(y.flags|=128,D=!0,Du(j,!1),y.lanes=4194304)}else{if(!D)if(m=dr(Q),m!==null){if(y.flags|=128,D=!0,m=m.updateQueue,y.updateQueue=m,H0(y,m),Du(j,!0),j.tail===null&&j.tailMode==="hidden"&&!Q.alternate&&!At)return Vr(y),null}else 2*ei()-j.renderingStartTime>Sv&&C!==536870912&&(y.flags|=128,D=!0,Du(j,!1),y.lanes=4194304);j.isBackwards?(Q.sibling=y.child,y.child=Q):(m=j.last,m!==null?m.sibling=Q:y.child=Q,j.last=Q)}return j.tail!==null?(y=j.tail,j.rendering=y,j.tail=y.sibling,j.renderingStartTime=ei(),y.sibling=null,m=pr.current,b(pr,D?m&1|2:m&1),y):(Vr(y),null);case 22:case 23:return pi(y),xn(),D=y.memoizedState!==null,m!==null?m.memoizedState!==null!==D&&(y.flags|=8192):D&&(y.flags|=8192),D?C&536870912&&!(y.flags&128)&&(Vr(y),y.subtreeFlags&6&&(y.flags|=8192)):Vr(y),C=y.updateQueue,C!==null&&H0(y,C.retryQueue),C=null,m!==null&&m.memoizedState!==null&&m.memoizedState.cachePool!==null&&(C=m.memoizedState.cachePool.pool),D=null,y.memoizedState!==null&&y.memoizedState.cachePool!==null&&(D=y.memoizedState.cachePool.pool),D!==C&&(y.flags|=2048),m!==null&&v(Hh),null;case 24:return C=null,m!==null&&(C=m.memoizedState.cache),y.memoizedState.cache!==C&&(y.flags|=2048),Rh(Xr),Vr(y),null;case 25:return null}throw Error(r(156,y.tag))}function dn(m,y){switch(Fe(y),y.tag){case 1:return m=y.flags,m&65536?(y.flags=m&-65537|128,y):null;case 3:return Rh(Xr),Re(),m=y.flags,m&65536&&!(m&128)?(y.flags=m&-65537|128,y):null;case 26:case 27:case 5:return _e(y),null;case 13:if(pi(y),m=y.memoizedState,m!==null&&m.dehydrated!==null){if(y.alternate===null)throw Error(r(340));Se()}return m=y.flags,m&65536?(y.flags=m&-65537|128,y):null;case 19:return v(pr),null;case 4:return Re(),null;case 10:return Rh(y.type),null;case 22:case 23:return pi(y),xn(),m!==null&&v(Hh),m=y.flags,m&65536?(y.flags=m&-65537|128,y):null;case 24:return Rh(Xr),null;case 25:return null;default:return null}}function _a(m,y){switch(Fe(y),y.tag){case 3:Rh(Xr),Re();break;case 26:case 27:case 5:_e(y);break;case 4:Re();break;case 13:pi(y);break;case 19:v(pr);break;case 10:Rh(y.type);break;case 22:case 23:pi(y),xn(),m!==null&&v(Hh);break;case 24:Rh(Xr)}}function G0(m,y){try{var C=y.updateQueue,D=C!==null?C.lastEffect:null;if(D!==null){var j=D.next;C=j;do{if((C.tag&m)===m){D=void 0;var Q=C.create,Ce=C.inst;D=Q(),Ce.destroy=D}C=C.next}while(C!==j)}}catch(He){lr(y,y.return,He)}}function Lu(m,y,C){try{var D=y.updateQueue,j=D!==null?D.lastEffect:null;if(j!==null){var Q=j.next;D=Q;do{if((D.tag&m)===m){var Ce=D.inst,He=Ce.destroy;if(He!==void 0){Ce.destroy=void 0,j=y;var ut=C;try{He()}catch(kt){lr(j,ut,kt)}}}D=D.next}while(D!==Q)}}catch(kt){lr(y,y.return,kt)}}function cl(m){var y=m.updateQueue;if(y!==null){var C=m.stateNode;try{zt(y,C)}catch(D){lr(m,m.return,D)}}}function q0(m,y,C){C.props=Ch(m.type,m.memoizedProps),C.state=m.memoizedState;try{C.componentWillUnmount()}catch(D){lr(m,y,D)}}function Hp(m,y){try{var C=m.ref;if(C!==null){var D=m.stateNode;switch(m.tag){case 26:case 27:case 5:var j=Df(D);break;default:j=D}typeof C=="function"?m.refCleanup=C(j):C.current=j}}catch(Q){lr(m,y,Q)}}function Na(m,y){var C=m.ref,D=m.refCleanup;if(C!==null)if(typeof D=="function")try{D()}catch(j){lr(m,y,j)}finally{m.refCleanup=null,m=m.alternate,m!=null&&(m.refCleanup=null)}else if(typeof C=="function")try{C(null)}catch(j){lr(m,y,j)}else C.current=null}function tS(m){var y=m.type,C=m.memoizedProps,D=m.stateNode;try{IR(D,y,C,m)}catch(j){lr(m,m.return,j)}}function wc(m,y,C){try{fv(m.stateNode,m.type,C,y,m)}catch(D){lr(m,m.return,D)}}function Ms(m){return m.tag===5||m.tag===3||(vo?m.tag===26:!1)||(ka?m.tag===27:!1)||m.tag===4}function na(m){e:for(;;){for(;m.sibling===null;){if(m.return===null||Ms(m.return))return null;m=m.return}for(m.sibling.return=m.return,m=m.sibling;m.tag!==5&&m.tag!==6&&(!ka||m.tag!==27)&&m.tag!==18;){if(m.flags&2||m.child===null||m.tag===4)continue e;m.child.return=m,m=m.child}if(!(m.flags&2))return m.stateNode}}function ki(m,y,C){var D=m.tag;if(D===5||D===6)m=m.stateNode,y?Ox(C,m,y):yy(C,m);else if(!(D===4||ka&&D===27)&&(m=m.child,m!==null))for(ki(m,y,C),m=m.sibling;m!==null;)ki(m,y,C),m=m.sibling}function Cc(m,y,C){var D=m.tag;if(D===5||D===6)m=m.stateNode,y?Mx(C,m,y):rc(C,m);else if(!(D===4||ka&&D===27)&&(m=m.child,m!==null))for(Cc(m,y,C),m=m.sibling;m!==null;)Cc(m,y,C),m=m.sibling}function ko(m,y,C){m=m.containerInfo;try{bS(m,C)}catch(D){lr(y,y.return,D)}}function Vp(m,y){for(wx(m.containerInfo),ue=y;ue!==null;)if(m=ue,y=m.child,(m.subtreeFlags&1028)!==0&&y!==null)y.return=m,ue=y;else for(;ue!==null;){m=ue;var C=m.alternate;switch(y=m.flags,m.tag){case 0:break;case 11:case 15:break;case 1:if(y&1024&&C!==null){y=void 0;var D=m,j=C.memoizedProps;C=C.memoizedState;var Q=D.stateNode;try{var Ce=Ch(D.type,j,D.elementType===D.type);y=Q.getSnapshotBeforeUpdate(Ce,C),Q.__reactInternalSnapshotBeforeUpdate=y}catch(He){lr(D,D.return,He)}}break;case 3:y&1024&&Lo&&ug(m.stateNode.containerInfo);break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if(y&1024)throw Error(r(163))}if(y=m.sibling,y!==null){y.return=m.return,ue=y;break}ue=m.return}return Ce=Ae,Ae=!1,Ce}function $0(m,y,C){var D=C.flags;switch(C.tag){case 0:case 11:case 15:kl(m,C),D&4&&G0(5,C);break;case 1:if(kl(m,C),D&4)if(m=C.stateNode,y===null)try{m.componentDidMount()}catch(He){lr(C,C.return,He)}else{var j=Ch(C.type,y.memoizedProps);y=y.memoizedState;try{m.componentDidUpdate(j,y,m.__reactInternalSnapshotBeforeUpdate)}catch(He){lr(C,C.return,He)}}D&64&&cl(C),D&512&&Hp(C,C.return);break;case 3:if(kl(m,C),D&64&&(D=C.updateQueue,D!==null)){if(m=null,C.child!==null)switch(C.child.tag){case 27:case 5:m=Df(C.child.stateNode);break;case 1:m=C.child.stateNode}try{zt(D,m)}catch(He){lr(C,C.return,He)}}break;case 26:if(vo){kl(m,C),D&512&&Hp(C,C.return);break}case 27:case 5:kl(m,C),y===null&&D&4&&tS(C),D&512&&Hp(C,C.return);break;case 12:kl(m,C);break;case 13:kl(m,C),D&4&&Xm(m,C);break;case 22:if(j=C.memoizedState!==null||E,!j){y=y!==null&&y.memoizedState!==null||w;var Q=E,Ce=w;E=j,(w=y)&&!Ce?tu(m,C,(C.subtreeFlags&8772)!==0):kl(m,C),E=Q,w=Ce}D&512&&(C.memoizedProps.mode==="manual"?Hp(C,C.return):Na(C,C.return));break;default:kl(m,C)}}function Po(m){var y=m.alternate;y!==null&&(m.alternate=null,Po(y)),m.child=null,m.deletions=null,m.sibling=null,m.tag===5&&(y=m.stateNode,y!==null&&ms(y)),m.stateNode=null,m.return=null,m.dependencies=null,m.memoizedProps=null,m.memoizedState=null,m.pendingProps=null,m.stateNode=null,m.updateQueue=null}function Ut(m,y,C){for(C=C.child;C!==null;)Ia(m,y,C),C=C.sibling}function Ia(m,y,C){if(T&&typeof T.onCommitFiberUnmount=="function")try{T.onCommitFiberUnmount(N,C)}catch{}switch(C.tag){case 26:if(vo){w||Na(C,y),Ut(m,y,C),C.memoizedState?ac(C.memoizedState):C.stateNode&&TS(C.stateNode);break}case 27:if(ka){w||Na(C,y);var D=Ue,j=Ge;Ue=C.stateNode,Ut(m,y,C),CS(C.stateNode),Ue=D,Ge=j;break}case 5:w||Na(C,y);case 6:if(Lo){if(D=Ue,j=Ge,Ue=null,Ut(m,y,C),Ue=D,Ge=j,Ue!==null)if(Ge)try{yS(Ue,C.stateNode)}catch(Q){lr(C,y,Q)}else try{cg(Ue,C.stateNode)}catch(Q){lr(C,y,Q)}}else Ut(m,y,C);break;case 18:Lo&&Ue!==null&&(Ge?UR(Ue,C.stateNode):LR(Ue,C.stateNode));break;case 4:Lo?(D=Ue,j=Ge,Ue=C.stateNode.containerInfo,Ge=!0,Ut(m,y,C),Ue=D,Ge=j):($u&&ko(C.stateNode,C,Ey()),Ut(m,y,C));break;case 0:case 11:case 14:case 15:w||Lu(2,C,y),w||Lu(4,C,y),Ut(m,y,C);break;case 1:w||(Na(C,y),D=C.stateNode,typeof D.componentWillUnmount=="function"&&q0(C,y,D)),Ut(m,y,C);break;case 21:Ut(m,y,C);break;case 22:w||Na(C,y),w=(D=w)||C.memoizedState!==null,Ut(m,y,C),w=D;break;default:Ut(m,y,C)}}function Xm(m,y){if(Dl&&y.memoizedState===null&&(m=y.alternate,m!==null&&(m=m.memoizedState,m!==null&&(m=m.dehydrated,m!==null))))try{gv(m)}catch(C){lr(y,y.return,C)}}function Of(m){switch(m.tag){case 13:case 19:var y=m.stateNode;return y===null&&(y=m.stateNode=new ee),y;case 22:return m=m.stateNode,y=m._retryCache,y===null&&(y=m._retryCache=new ee),y;default:throw Error(r(435,m.tag))}}function Md(m,y){var C=Of(m);y.forEach(function(D){var j=Sx.bind(null,m,D);C.has(D)||(C.add(D),D.then(j,j))})}function ya(m,y){var C=y.deletions;if(C!==null)for(var D=0;D<C.length;D++){var j=C[D],Q=m,Ce=y;if(Lo){var He=Ce;e:for(;He!==null;){switch(He.tag){case 27:case 5:Ue=He.stateNode,Ge=!1;break e;case 3:Ue=He.stateNode.containerInfo,Ge=!0;break e;case 4:Ue=He.stateNode.containerInfo,Ge=!0;break e}He=He.return}if(Ue===null)throw Error(r(160));Ia(Q,Ce,j),Ue=null,Ge=!1}else Ia(Q,Ce,j);Q=j.alternate,Q!==null&&(Q.return=null),j.return=null}if(y.subtreeFlags&13878)for(y=y.child;y!==null;)W0(y,m),y=y.sibling}function W0(m,y){var C=m.alternate,D=m.flags;switch(m.tag){case 0:case 11:case 14:case 15:ya(y,m),Ac(m),D&4&&(Lu(3,m,m.return),G0(3,m),Lu(5,m,m.return));break;case 1:ya(y,m),Ac(m),D&512&&(w||C===null||Na(C,C.return)),D&64&&E&&(m=m.updateQueue,m!==null&&(D=m.callbacks,D!==null&&(C=m.shared.hiddenCallbacks,m.shared.hiddenCallbacks=C===null?D:C.concat(D))));break;case 26:if(vo){var j=ot;ya(y,m),Ac(m),D&512&&(w||C===null||Na(C,C.return)),D&4&&(D=C!==null?C.memoizedState:null,y=m.memoizedState,C===null?y===null?m.stateNode===null?m.stateNode=SS(j,m.type,m.memoizedProps,m):vv(j,m.type,m.stateNode):m.stateNode=Ks(j,y,m.memoizedProps):D!==y?(D===null?C.stateNode!==null&&TS(C.stateNode):ac(D),y===null?vv(j,m.type,m.stateNode):Ks(j,y,m.memoizedProps)):y===null&&m.stateNode!==null&&wc(m,m.memoizedProps,C.memoizedProps));break}case 27:if(ka&&D&4&&m.alternate===null){j=m.stateNode;var Q=m.memoizedProps;try{xy(j),wS(m.type,Q,j,m)}catch(nn){lr(m,m.return,nn)}}case 5:if(ya(y,m),Ac(m),D&512&&(w||C===null||Na(C,C.return)),Lo){if(m.flags&32){y=m.stateNode;try{pv(y)}catch(nn){lr(m,m.return,nn)}}D&4&&m.stateNode!=null&&(y=m.memoizedProps,wc(m,y,C!==null?C.memoizedProps:y)),D&1024&&(F=!0)}break;case 6:if(ya(y,m),Ac(m),D&4&&Lo){if(m.stateNode===null)throw Error(r(162));D=m.memoizedProps,C=C!==null?C.memoizedProps:D,y=m.stateNode;try{_S(y,C,D)}catch(nn){lr(m,m.return,nn)}}break;case 3:if(vo?(Px(),j=ot,ot=Ud(y.containerInfo),ya(y,m),ot=j):ya(y,m),Ac(m),D&4){if(Lo&&Dl&&C!==null&&C.memoizedState.isDehydrated)try{mg(y.containerInfo)}catch(nn){lr(m,m.return,nn)}if($u){D=y.containerInfo,C=y.pendingChildren;try{bS(D,C)}catch(nn){lr(m,m.return,nn)}}}F&&(F=!1,bx(m));break;case 4:vo?(C=ot,ot=Ud(m.stateNode.containerInfo),ya(y,m),Ac(m),ot=C):(ya(y,m),Ac(m)),D&4&&$u&&ko(m.stateNode,m,m.stateNode.pendingChildren);break;case 12:ya(y,m),Ac(m);break;case 13:ya(y,m),Ac(m),m.child.flags&8192&&m.memoizedState!==null!=(C!==null&&C.memoizedState!==null)&&(Ry=ei()),D&4&&(D=m.updateQueue,D!==null&&(m.updateQueue=null,Md(m,D)));break;case 22:D&512&&(w||C===null||Na(C,C.return)),j=m.memoizedState!==null;var Ce=C!==null&&C.memoizedState!==null,He=E,ut=w;if(E=He||j,w=ut||Ce,ya(y,m),w=ut,E=He,Ac(m),y=m.stateNode,y._current=m,y._visibility&=-3,y._visibility|=y._pendingVisibility&2,D&8192&&(y._visibility=j?y._visibility&-2:y._visibility|1,j&&(y=E||w,C===null||Ce||y||Gp(m)),Lo&&(m.memoizedProps===null||m.memoizedProps.mode!=="manual"))){e:if(C=null,Lo)for(y=m;;){if(y.tag===5||vo&&y.tag===26||ka&&y.tag===27){if(C===null){Ce=C=y;try{Q=Ce.stateNode,j?hl(Q):by(Ce.stateNode,Ce.memoizedProps)}catch(nn){lr(Ce,Ce.return,nn)}}}else if(y.tag===6){if(C===null){Ce=y;try{var kt=Ce.stateNode;j?lg(kt):Xa(kt,Ce.memoizedProps)}catch(nn){lr(Ce,Ce.return,nn)}}}else if((y.tag!==22&&y.tag!==23||y.memoizedState===null||y===m)&&y.child!==null){y.child.return=y,y=y.child;continue}if(y===m)break e;for(;y.sibling===null;){if(y.return===null||y.return===m)break e;C===y&&(C=null),y=y.return}C===y&&(C=null),y.sibling.return=y.return,y=y.sibling}}D&4&&(D=m.updateQueue,D!==null&&(C=D.retryQueue,C!==null&&(D.retryQueue=null,Md(m,C))));break;case 19:ya(y,m),Ac(m),D&4&&(D=m.updateQueue,D!==null&&(m.updateQueue=null,Md(m,D)));break;case 21:break;default:ya(y,m),Ac(m)}}function Ac(m){var y=m.flags;if(y&2){try{if(Lo&&(!ka||m.tag!==27)){e:{for(var C=m.return;C!==null;){if(Ms(C)){var D=C;break e}C=C.return}throw Error(r(160))}switch(D.tag){case 27:if(ka){var j=D.stateNode,Q=na(m);Cc(m,Q,j);break}case 5:var Ce=D.stateNode;D.flags&32&&(pv(Ce),D.flags&=-33);var He=na(m);Cc(m,He,Ce);break;case 3:case 4:var ut=D.stateNode.containerInfo,kt=na(m);ki(m,kt,ut);break;default:throw Error(r(161))}}}catch(nn){lr(m,m.return,nn)}m.flags&=-3}y&4096&&(m.flags&=-4097)}function bx(m){if(m.subtreeFlags&1024)for(m=m.child;m!==null;){var y=m;bx(y),y.tag===5&&y.flags&1024&&ui(y.stateNode),m=m.sibling}}function kl(m,y){if(y.subtreeFlags&8772)for(y=y.child;y!==null;)$0(m,y.alternate,y),y=y.sibling}function Gp(m){for(m=m.child;m!==null;){var y=m;switch(y.tag){case 0:case 11:case 14:case 15:Lu(4,y,y.return),Gp(y);break;case 1:Na(y,y.return);var C=y.stateNode;typeof C.componentWillUnmount=="function"&&q0(y,y.return,C),Gp(y);break;case 26:case 27:case 5:Na(y,y.return),Gp(y);break;case 22:Na(y,y.return),y.memoizedState===null&&Gp(y);break;default:Gp(y)}m=m.sibling}}function tu(m,y,C){for(C=C&&(y.subtreeFlags&8772)!==0,y=y.child;y!==null;){var D=y.alternate,j=m,Q=y,Ce=Q.flags;switch(Q.tag){case 0:case 11:case 15:tu(j,Q,C),G0(4,Q);break;case 1:if(tu(j,Q,C),D=Q,j=D.stateNode,typeof j.componentDidMount=="function")try{j.componentDidMount()}catch(kt){lr(D,D.return,kt)}if(D=Q,j=D.updateQueue,j!==null){var He=D.stateNode;try{var ut=j.shared.hiddenCallbacks;if(ut!==null)for(j.shared.hiddenCallbacks=null,j=0;j<ut.length;j++)je(ut[j],He)}catch(kt){lr(D,D.return,kt)}}C&&Ce&64&&cl(Q),Hp(Q,Q.return);break;case 26:case 27:case 5:tu(j,Q,C),C&&D===null&&Ce&4&&tS(Q),Hp(Q,Q.return);break;case 12:tu(j,Q,C);break;case 13:tu(j,Q,C),C&&Ce&4&&Xm(j,Q);break;case 22:Q.memoizedState===null&&tu(j,Q,C),Hp(Q,Q.return);break;default:tu(j,Q,C)}y=y.sibling}}function Nf(m,y){var C=null;m!==null&&m.memoizedState!==null&&m.memoizedState.cachePool!==null&&(C=m.memoizedState.cachePool.pool),m=null,y.memoizedState!==null&&y.memoizedState.cachePool!==null&&(m=y.memoizedState.cachePool.pool),m!==C&&(m!=null&&m.refCount++,C!=null&&Af(C))}function Zm(m,y){m=null,y.alternate!==null&&(m=y.alternate.memoizedState.cache),y=y.memoizedState.cache,y!==m&&(y.refCount++,m!=null&&Af(m))}function ve(m,y,C,D){if(y.subtreeFlags&10256)for(y=y.child;y!==null;)Od(m,y,C,D),y=y.sibling}function Od(m,y,C,D){var j=y.flags;switch(y.tag){case 0:case 11:case 15:ve(m,y,C,D),j&2048&&G0(9,y);break;case 3:ve(m,y,C,D),j&2048&&(m=null,y.alternate!==null&&(m=y.alternate.memoizedState.cache),y=y.memoizedState.cache,y!==m&&(y.refCount++,m!=null&&Af(m)));break;case 12:if(j&2048){ve(m,y,C,D),m=y.stateNode;try{var Q=y.memoizedProps,Ce=Q.id,He=Q.onPostCommit;typeof He=="function"&&He(Ce,y.alternate===null?"mount":"update",m.passiveEffectDuration,-0)}catch(ut){lr(y,y.return,ut)}}else ve(m,y,C,D);break;case 23:break;case 22:Q=y.stateNode,y.memoizedState!==null?Q._visibility&4?ve(m,y,C,D):po(m,y):Q._visibility&4?ve(m,y,C,D):(Q._visibility|=4,Oh(m,y,C,D,(y.subtreeFlags&10256)!==0)),j&2048&&Nf(y.alternate,y);break;case 24:ve(m,y,C,D),j&2048&&Zm(y.alternate,y);break;default:ve(m,y,C,D)}}function Oh(m,y,C,D,j){for(j=j&&(y.subtreeFlags&10256)!==0,y=y.child;y!==null;){var Q=m,Ce=y,He=C,ut=D,kt=Ce.flags;switch(Ce.tag){case 0:case 11:case 15:Oh(Q,Ce,He,ut,j),G0(8,Ce);break;case 23:break;case 22:var nn=Ce.stateNode;Ce.memoizedState!==null?nn._visibility&4?Oh(Q,Ce,He,ut,j):po(Q,Ce):(nn._visibility|=4,Oh(Q,Ce,He,ut,j)),j&&kt&2048&&Nf(Ce.alternate,Ce);break;case 24:Oh(Q,Ce,He,ut,j),j&&kt&2048&&Zm(Ce.alternate,Ce);break;default:Oh(Q,Ce,He,ut,j)}y=y.sibling}}function po(m,y){if(y.subtreeFlags&10256)for(y=y.child;y!==null;){var C=m,D=y,j=D.flags;switch(D.tag){case 22:po(C,D),j&2048&&Nf(D.alternate,D);break;case 24:po(C,D),j&2048&&Zm(D.alternate,D);break;default:po(C,D)}y=y.sibling}}function Bi(m){if(m.subtreeFlags&It)for(m=m.child;m!==null;)Nd(m),m=m.sibling}function Nd(m){switch(m.tag){case 26:Bi(m),m.flags&It&&(m.memoizedState!==null?FR(ot,m.memoizedState,m.memoizedProps):vy(m.type,m.memoizedProps));break;case 5:Bi(m),m.flags&It&&vy(m.type,m.memoizedProps);break;case 3:case 4:if(vo){var y=ot;ot=Ud(m.stateNode.containerInfo),Bi(m),ot=y}else Bi(m);break;case 22:m.memoizedState===null&&(y=m.alternate,y!==null&&y.memoizedState!==null?(y=It,It=16777216,Bi(m),It=y):Bi(m));break;default:Bi(m)}}function Uu(m){var y=m.alternate;if(y!==null&&(m=y.child,m!==null)){y.child=null;do y=m.sibling,m.sibling=null,m=y;while(m!==null)}}function ll(m){var y=m.deletions;if(m.flags&16){if(y!==null)for(var C=0;C<y.length;C++){var D=y[C];ue=D,cy(D,m)}Uu(m)}if(m.subtreeFlags&10256)for(m=m.child;m!==null;)Bu(m),m=m.sibling}function Bu(m){switch(m.tag){case 0:case 11:case 15:ll(m),m.flags&2048&&Lu(9,m,m.return);break;case 3:ll(m);break;case 12:ll(m);break;case 22:var y=m.stateNode;m.memoizedState!==null&&y._visibility&4&&(m.return===null||m.return.tag!==13)?(y._visibility&=-5,Rc(m)):ll(m);break;default:ll(m)}}function Rc(m){var y=m.deletions;if(m.flags&16){if(y!==null)for(var C=0;C<y.length;C++){var D=y[C];ue=D,cy(D,m)}Uu(m)}for(m=m.child;m!==null;){switch(y=m,y.tag){case 0:case 11:case 15:Lu(8,y,y.return),Rc(y);break;case 22:C=y.stateNode,C._visibility&4&&(C._visibility&=-5,Rc(y));break;default:Rc(y)}m=m.sibling}}function cy(m,y){for(;ue!==null;){var C=ue;switch(C.tag){case 0:case 11:case 15:Lu(8,C,y);break;case 23:case 22:if(C.memoizedState!==null&&C.memoizedState.cachePool!==null){var D=C.memoizedState.cachePool.pool;D!=null&&D.refCount++}break;case 24:Af(C.memoizedState.cache)}if(D=C.child,D!==null)D.return=C,ue=D;else e:for(C=m;ue!==null;){D=ue;var j=D.sibling,Q=D.return;if(Po(D),D===C){ue=null;break e}if(j!==null){j.return=Q,ue=j;break e}ue=Q}}}function nu(m){var y=hv(m);if(y!=null){if(typeof y.memoizedProps["data-testname"]!="string")throw Error(r(364));return y}if(m=dv(m),m===null)throw Error(r(362));return m.stateNode.current}function ly(m,y){var C=m.tag;switch(y.$$typeof){case Xt:if(m.type===y.value)return!0;break;case Pn:e:{for(y=y.value,m=[m,0],C=0;C<m.length;){var D=m[C++],j=D.tag,Q=m[C++],Ce=y[Q];if(j!==5&&j!==26&&j!==27||!Qp(D)){for(;Ce!=null&&ly(D,Ce);)Q++,Ce=y[Q];if(Q===y.length){y=!0;break e}else for(D=D.child;D!==null;)m.push(D,Q),D=D.sibling}}y=!1}return y;case jn:if((C===5||C===26||C===27)&&Rx(m.stateNode,y.value))return!0;break;case Lt:if((C===5||C===6||C===26||C===27)&&(m=Ka(m),m!==null&&0<=m.indexOf(y.value)))return!0;break;case ri:if((C===5||C===26||C===27)&&(m=m.memoizedProps["data-testname"],typeof m=="string"&&m.toLowerCase()===y.value.toLowerCase()))return!0;break;default:throw Error(r(365))}return!1}function Y0(m){switch(m.$$typeof){case Xt:return"<"+(a(m.value)||"Unknown")+">";case Pn:return":has("+(Y0(m)||"")+")";case jn:return'[role="'+m.value+'"]';case Lt:return'"'+m.value+'"';case ri:return'[data-testname="'+m.value+'"]';default:throw Error(r(365))}}function K0(m,y){var C=[];m=[m,0];for(var D=0;D<m.length;){var j=m[D++],Q=j.tag,Ce=m[D++],He=y[Ce];if(Q!==5&&Q!==26&&Q!==27||!Qp(j)){for(;He!=null&&ly(j,He);)Ce++,He=y[Ce];if(Ce===y.length)C.push(j);else for(j=j.child;j!==null;)m.push(j,Ce),j=j.sibling}}return C}function If(m,y){if(!Bl)throw Error(r(363));m=nu(m),m=K0(m,y),y=[],m=Array.from(m);for(var C=0;C<m.length;){var D=m[C++],j=D.tag;if(j===5||j===26||j===27)Qp(D)||y.push(D.stateNode);else for(D=D.child;D!==null;)m.push(D),D=D.sibling}return y}function Do(){if($t&2&&Bn!==0)return Bn&-Bn;if(bi.T!==null){var m=An;return m!==0?m:tn()}return Wu()}function nS(){ou===0&&(ou=!(Bn&536870912)||At?k():536870912);var m=Cs.current;return m!==null&&(m.flags|=32),ou}function nc(m,y,C){(m===Dn&&ln===2||m.cancelPendingCommit!==null)&&(Pl(m,0),fs(m,Bn,ou,!1)),V(m,C),(!($t&2)||m!==Dn)&&(m===Dn&&(!($t&2)&&(au|=C),mr===4&&fs(m,Bn,ou,!1)),bt(m))}function Fu(m,y,C){if($t&6)throw Error(r(327));var D=!C&&(y&60)===0&&(y&m.expiredLanes)===0||R(m,y),j=D?zu(m,y):J0(m,y,!0),Q=D;do{if(j===0){js&&!D&&fs(m,y,0,!1);break}else if(j===6)fs(m,y,0,!Os);else{if(C=m.current.alternate,Q&&!Mc(C)){j=J0(m,y,!1),Q=!1;continue}if(j===2){if(Q=y,m.errorRecoveryDisabledLanes&Q)var Ce=0;else Ce=m.pendingLanes&-536870913,Ce=Ce!==0?Ce:Ce&536870912?536870912:0;if(Ce!==0){y=Ce;e:{var He=m;j=Fd;var ut=Dl&&He.current.memoizedState.isDehydrated;if(ut&&(Pl(He,Ce).flags|=256),Ce=J0(He,Ce,!1),Ce!==2){if(kc&&!ut){He.errorRecoveryDisabledLanes|=Q,au|=Q,j=4;break e}Q=zd,zd=j,Q!==null&&X0(Q)}j=Ce}if(Q=!1,j!==2)continue}}if(j===1){Pl(m,0),fs(m,y,0,!0);break}e:{switch(D=m,j){case 0:case 1:throw Error(r(345));case 4:if((y&4194176)===y){fs(D,y,ou,!Os);break e}break;case 2:zd=null;break;case 3:case 5:break;default:throw Error(r(329))}if(D.finishedWork=C,D.finishedLanes=y,(y&62914560)===y&&(Q=Ry+300-ei(),10<Q)){if(fs(D,y,ou,!Os),M(D,0)!==0)break e;D.timeoutHandle=Ax(Id.bind(null,D,C,zd,Tv,Lx,y,ou,au,nm,Os,2,-0,0),Q);break e}Id(D,C,zd,Tv,Lx,y,ou,au,nm,Os,0,-0,0)}}break}while(!0);bt(m)}function X0(m){zd===null?zd=m:zd.push.apply(zd,m)}function Id(m,y,C,D,j,Q,Ce,He,ut,kt,nn,Rn,In){var nr=y.subtreeFlags;if((nr&8192||(nr&16785408)===16785408)&&(pS(),Nd(y),y=mS(),y!==null)){m.cancelPendingCommit=y(eg.bind(null,m,C,D,j,Ce,He,ut,1,Rn,In)),fs(m,Q,Ce,!kt);return}eg(m,C,D,j,Ce,He,ut,nn,Rn,In)}function Mc(m){for(var y=m;;){var C=y.tag;if((C===0||C===11||C===15)&&y.flags&16384&&(C=y.updateQueue,C!==null&&(C=C.stores,C!==null)))for(var D=0;D<C.length;D++){var j=C[D],Q=j.getSnapshot;j=j.value;try{if(!A(Q(),j))return!1}catch{return!1}}if(C=y.child,y.subtreeFlags&16384&&C!==null)C.return=y,y=C;else{if(y===m)break;for(;y.sibling===null;){if(y.return===null||y.return===m)return!0;y=y.return}y.sibling.return=y.return,y=y.sibling}}return!0}function fs(m,y,C,D){y&=~Ay,y&=~au,m.suspendedLanes|=y,m.pingedLanes&=~y,D&&(m.warmLanes|=y),D=m.expirationTimes;for(var j=y;0<j;){var Q=31-cc(j),Ce=1<<Q;D[Q]=-1,j&=~Ce}C!==0&&q(m,C,y)}function uy(){return $t&6?!0:(we(0),!1)}function kf(){if(cn!==null){if(ln===0)var m=cn.return;else m=cn,Fl=Ju=null,Iu(m),fr=null,Kr=0,m=cn;for(;m!==null;)_a(m.alternate,m),m=m.return;cn=null}}function Pl(m,y){m.finishedWork=null,m.finishedLanes=0;var C=m.timeoutHandle;C!==uv&&(m.timeoutHandle=uv,gy(C)),C=m.cancelPendingCommit,C!==null&&(m.cancelPendingCommit=null,C()),kf(),Dn=m,cn=C=Nh(m.current,null),Bn=y,ln=0,Vn=null,Os=!1,js=R(m,y),kc=!1,nm=ou=Ay=au=Pc=mr=0,zd=Fd=null,Lx=!1,y&8&&(y|=y&32);var D=m.entangledLanes;if(D!==0)for(m=m.entanglements,D&=y;0<D;){var j=31-cc(D),Q=1<<j;y|=m[j],D&=~Q}return Pr=y,pe(),C}function Z0(m,y){ti=null,bi.H=Da,y===ns?(y=Ve(),ln=3):y===gs?(y=Ve(),ln=4):ln=y===tm?8:y!==null&&typeof y=="object"&&typeof y.then=="function"?6:1,Vn=y,cn===null&&(mr=1,Gm(m,X(y,m.current)))}function iS(){var m=Cs.current;return m===null?!0:(Bn&4194176)===Bn?zs===null:(Bn&62914560)===Bn||Bn&536870912?m===zs:!1}function Jm(){var m=bi.H;return bi.H=Da,m===null?Da:m}function Qm(){var m=bi.A;return bi.A=Dt,m}function Ya(){mr=4,Os||(Bn&4194176)!==Bn&&Cs.current!==null||(js=!0),!(Pc&134217727)&&!(au&134217727)||Dn===null||fs(Dn,Bn,ou,!1)}function J0(m,y,C){var D=$t;$t|=2;var j=Jm(),Q=Qm();(Dn!==m||Bn!==y)&&(Tv=null,Pl(m,y)),y=!1;var Ce=mr;e:do try{if(ln!==0&&cn!==null){var He=cn,ut=Vn;switch(ln){case 8:kf(),Ce=6;break e;case 3:case 2:case 6:Cs.current===null&&(y=!0);var kt=ln;if(ln=0,Vn=null,iu(m,He,ut,kt),C&&js){Ce=0;break e}break;default:kt=ln,ln=0,Vn=null,iu(m,He,ut,kt)}}rS(),Ce=mr;break}catch(nn){Z0(m,nn)}while(!0);return y&&m.shellSuspendCounter++,Fl=Ju=null,$t=D,bi.H=j,bi.A=Q,cn===null&&(Dn=null,Bn=0,pe()),Ce}function rS(){for(;cn!==null;)ju(cn)}function zu(m,y){var C=$t;$t|=2;var D=Jm(),j=Qm();Dn!==m||Bn!==y?(Tv=null,Sv=ei()+500,Pl(m,y)):js=R(m,y);e:do try{if(ln!==0&&cn!==null){y=cn;var Q=Vn;t:switch(ln){case 1:ln=0,Vn=null,iu(m,y,Q,1);break;case 2:if(Pt(Q)){ln=0,Vn=null,Ys(y);break}y=function(){ln===2&&Dn===m&&(ln=7),bt(m)},Q.then(y,y);break e;case 3:ln=7;break e;case 4:ln=5;break e;case 7:Pt(Q)?(ln=0,Vn=null,Ys(y)):(ln=0,Vn=null,iu(m,y,Q,7));break;case 5:var Ce=null;switch(cn.tag){case 26:Ce=cn.memoizedState;case 5:case 27:var He=cn,ut=He.type,kt=He.pendingProps;if(Ce?xS(Ce):Yu(ut,kt)){ln=0,Vn=null;var nn=He.sibling;if(nn!==null)cn=nn;else{var Rn=He.return;Rn!==null?(cn=Rn,ba(Rn)):cn=null}break t}}ln=0,Vn=null,iu(m,y,Q,5);break;case 6:ln=0,Vn=null,iu(m,y,Q,6);break;case 8:kf(),mr=6;break e;default:throw Error(r(462))}}sS();break}catch(In){Z0(m,In)}while(!0);return Fl=Ju=null,bi.H=D,bi.A=j,$t=C,cn!==null?0:(Dn=null,Bn=0,pe(),mr)}function sS(){for(;cn!==null&&!jR();)ju(cn)}function ju(m){var y=Ji(m.alternate,m,Pr);m.memoizedProps=m.pendingProps,y===null?ba(m):cn=y}function Ys(m){var y=m,C=y.alternate;switch(y.tag){case 15:case 0:y=$m(C,y,y.pendingProps,y.type,void 0,Bn);break;case 11:y=$m(C,y,y.pendingProps,y.type.render,y.ref,Bn);break;case 5:Iu(y);default:_a(C,y),y=cn=nv(y,Pr),y=Ji(C,y,Pr)}m.memoizedProps=m.pendingProps,y===null?ba(m):cn=y}function iu(m,y,C,D){Fl=Ju=null,Iu(y),fr=null,Kr=0;var j=y.return;try{if(mx(m,j,y,C,Bn)){mr=1,Gm(m,X(C,m.current)),cn=null;return}}catch(Q){if(j!==null)throw cn=j,Q;mr=1,Gm(m,X(C,m.current)),cn=null;return}y.flags&32768?(At||D===1?m=!0:js||Bn&536870912?m=!1:(Os=m=!0,(D===2||D===3||D===6)&&(D=Cs.current,D!==null&&D.tag===13&&(D.flags|=16384))),Gr(y,m)):ba(y)}function ba(m){var y=m;do{if(y.flags&32768){Gr(y,Os);return}m=y.return;var C=V0(y.alternate,y,Pr);if(C!==null){cn=C;return}if(y=y.sibling,y!==null){cn=y;return}cn=y=m}while(y!==null);mr===0&&(mr=5)}function Gr(m,y){do{var C=dn(m.alternate,m);if(C!==null){C.flags&=32767,cn=C;return}if(C=m.return,C!==null&&(C.flags|=32768,C.subtreeFlags=0,C.deletions=null),!y&&(m=m.sibling,m!==null)){cn=m;return}cn=m=C}while(m!==null);mr=6,cn=null}function eg(m,y,C,D,j,Q,Ce,He,ut,kt){var nn=bi.T,Rn=go();try{ic(2),bi.T=null,tg(m,y,C,D,Rn,j,Q,Ce,He,ut,kt)}finally{bi.T=nn,ic(Rn)}}function tg(m,y,C,D,j,Q,Ce,He){do Oc();while(zf!==null);if($t&6)throw Error(r(327));var ut=m.finishedWork;if(D=m.finishedLanes,ut===null)return null;if(m.finishedWork=null,m.finishedLanes=0,ut===m.current)throw Error(r(177));m.callbackNode=null,m.callbackPriority=0,m.cancelPendingCommit=null;var kt=ut.lanes|ut.childLanes;if(kt|=Fi,$(m,D,kt,Q,Ce,He),m===Dn&&(cn=Dn=null,Bn=0),!(ut.subtreeFlags&10256)&&!(ut.flags&10256)||MS||(MS=!0,u5=kt,h5=C,dy(Fs,function(){return Oc(),null})),C=(ut.flags&15990)!==0,ut.subtreeFlags&15990||C?(C=bi.T,bi.T=null,Q=go(),ic(2),Ce=$t,$t|=4,Vp(m,ut),W0(ut,m),Cx(m.containerInfo),m.current=ut,$0(m,ut.alternate,ut),qr(),$t=Ce,ic(Q),bi.T=C):m.current=ut,MS?(MS=!1,zf=m,_g=D):hy(m,kt),kt=m.pendingLanes,kt===0&&(jd=null),G(ut.stateNode),bt(m),y!==null)for(j=m.onRecoverableError,ut=0;ut<y.length;ut++)kt=y[ut],j(kt.value,{componentStack:kt.stack});return _g&3&&Oc(),kt=m.pendingLanes,D&4194218&&kt&42?m===d5?HR++:(HR=0,d5=m):HR=0,we(0),null}function hy(m,y){(m.pooledCacheLanes&=y)===0&&(y=m.pooledCache,y!=null&&(m.pooledCache=null,Af(y)))}function Oc(){if(zf!==null){var m=zf,y=u5;u5=0;var C=te(_g),D=32>C?32:C;C=bi.T;var j=go();try{if(ic(D),bi.T=null,zf===null)var Q=!1;else{D=h5,h5=null;var Ce=zf,He=_g;if(zf=null,_g=0,$t&6)throw Error(r(331));var ut=$t;if($t|=4,Bu(Ce.current),Od(Ce,Ce.current,He,D),$t=ut,we(0,!1),T&&typeof T.onPostCommitFiberRoot=="function")try{T.onPostCommitFiberRoot(N,Ce)}catch{}Q=!0}return Q}finally{ic(j),bi.T=C,hy(m,y)}}return!1}function Q0(m,y,C){y=X(C,y),y=Tc(m.stateNode,y,2),m=Ne(m,y,2),m!==null&&(V(m,2),bt(m))}function lr(m,y,C){if(m.tag===3)Q0(m,m,C);else for(;y!==null;){if(y.tag===3){Q0(y,m,C);break}else if(y.tag===1){var D=y.stateNode;if(typeof y.type.getDerivedStateFromError=="function"||typeof D.componentDidCatch=="function"&&(jd===null||!jd.has(D))){m=X(C,m),C=Ls(2),D=Ne(y,C,2),D!==null&&(Cd(C,D,y,m),V(D,2),bt(D));break}}y=y.return}}function ev(m,y,C){var D=m.pingCache;if(D===null){D=m.pingCache=new _i;var j=new Set;D.set(y,j)}else j=D.get(y),j===void 0&&(j=new Set,D.set(y,j));j.has(C)||(kc=!0,j.add(C),m=Ex.bind(null,m,y,C),y.then(m,m))}function Ex(m,y,C){var D=m.pingCache;D!==null&&D.delete(y),m.pingedLanes|=m.suspendedLanes&C,m.warmLanes&=~C,Dn===m&&(Bn&C)===C&&(mr===4||mr===3&&(Bn&62914560)===Bn&&300>ei()-Ry?!($t&2)&&Pl(m,0):Ay|=C,nm===Bn&&(nm=0)),bt(m)}function aS(m,y){y===0&&(y=P()),m=rt(m,y),m!==null&&(V(m,y),bt(m))}function oS(m){var y=m.memoizedState,C=0;y!==null&&(C=y.retryLane),aS(m,C)}function Sx(m,y){var C=0;switch(m.tag){case 13:var D=m.stateNode,j=m.memoizedState;j!==null&&(C=j.retryLane);break;case 19:D=m.stateNode;break;case 22:D=m.stateNode._retryCache;break;default:throw Error(r(314))}D!==null&&D.delete(y),aS(m,C)}function dy(m,y){return Bs(m,y)}function Hu(m,y,C,D){this.tag=m,this.key=C,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=y,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=D,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function tv(m){return m=m.prototype,!(!m||!m.isReactComponent)}function Nh(m,y){var C=m.alternate;return C===null?(C=n(m.tag,y,m.key,m.mode),C.elementType=m.elementType,C.type=m.type,C.stateNode=m.stateNode,C.alternate=m,m.alternate=C):(C.pendingProps=y,C.type=m.type,C.flags=0,C.subtreeFlags=0,C.deletions=null),C.flags=m.flags&31457280,C.childLanes=m.childLanes,C.lanes=m.lanes,C.child=m.child,C.memoizedProps=m.memoizedProps,C.memoizedState=m.memoizedState,C.updateQueue=m.updateQueue,y=m.dependencies,C.dependencies=y===null?null:{lanes:y.lanes,firstContext:y.firstContext},C.sibling=m.sibling,C.index=m.index,C.ref=m.ref,C.refCleanup=m.refCleanup,C}function nv(m,y){m.flags&=31457282;var C=m.alternate;return C===null?(m.childLanes=0,m.lanes=y,m.child=null,m.subtreeFlags=0,m.memoizedProps=null,m.memoizedState=null,m.updateQueue=null,m.dependencies=null,m.stateNode=null):(m.childLanes=C.childLanes,m.lanes=C.lanes,m.child=C.child,m.subtreeFlags=0,m.deletions=null,m.memoizedProps=C.memoizedProps,m.memoizedState=C.memoizedState,m.updateQueue=C.updateQueue,m.type=C.type,y=C.dependencies,m.dependencies=y===null?null:{lanes:y.lanes,firstContext:y.firstContext}),m}function iv(m,y,C,D,j,Q){var Ce=0;if(D=m,typeof m=="function")tv(m)&&(Ce=1);else if(typeof m=="string")Ce=vo&&ka?Uh(m,C,Pe.current)?26:AS(m)?27:5:vo?Uh(m,C,Pe.current)?26:5:ka&&AS(m)?27:5;else e:switch(m){case kh:return Pf(C.children,j,Q,y);case ul:Ce=8,j|=24;break;case Ph:return m=n(12,C,y,j|2),m.elementType=Ph,m.lanes=Q,m;case av:return m=n(13,C,y,j),m.elementType=av,m.lanes=Q,m;case Kp:return m=n(19,C,y,j),m.elementType=Kp,m.lanes=Q,m;case Dh:return cS(C,j,Q,y);default:if(typeof m=="object"&&m!==null)switch(m.$$typeof){case Yp:case Vu:Ce=10;break e;case uS:Ce=9;break e;case rg:Ce=11;break e;case ov:Ce=14;break e;case Gu:Ce=16,D=null;break e}Ce=29,C=Error(r(130,m===null?"null":typeof m,"")),D=null}return y=n(Ce,C,y,j),y.elementType=m,y.type=D,y.lanes=Q,y}function Pf(m,y,C,D){return m=n(7,m,D,y),m.lanes=C,m}function cS(m,y,C,D){m=n(22,m,D,y),m.elementType=Dh,m.lanes=C;var j={_visibility:1,_pendingVisibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null,_current:null,detach:function(){var Q=j._current;if(Q===null)throw Error(r(456));if(!(j._pendingVisibility&2)){var Ce=rt(Q,2);Ce!==null&&(j._pendingVisibility|=2,nc(Ce,Q,2))}},attach:function(){var Q=j._current;if(Q===null)throw Error(r(456));if(j._pendingVisibility&2){var Ce=rt(Q,2);Ce!==null&&(j._pendingVisibility&=-3,nc(Ce,Q,2))}}};return m.stateNode=j,m}function rv(m,y,C){return m=n(6,m,null,y),m.lanes=C,m}function fy(m,y,C){return y=n(4,m.children!==null?m.children:[],m.key,y),y.lanes=C,y.stateNode={containerInfo:m.containerInfo,pendingChildren:null,implementation:m.implementation},y}function lS(m,y,C,D,j,Q,Ce,He){this.tag=1,this.containerInfo=m,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=uv,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=U(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.finishedLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=U(0),this.hiddenUpdates=U(null),this.identifierPrefix=D,this.onUncaughtError=j,this.onCaughtError=Q,this.onRecoverableError=Ce,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=He,this.incompleteTransitions=new Map}function py(m,y,C,D,j,Q,Ce,He,ut,kt,nn,Rn){return m=new lS(m,y,C,Ce,He,ut,kt,Rn),y=1,Q===!0&&(y|=24),Q=n(3,null,null,y),m.current=Q,Q.stateNode=m,y=ay(),y.refCount++,m.pooledCache=y,y.refCount++,Q.memoizedState={element:D,isDehydrated:C,cache:y},z(Q),m}function $i(m){return m?(m=oc,m):oc}function sv(m){var y=m._reactInternals;if(y===void 0)throw typeof m.render=="function"?Error(r(188)):(m=Object.keys(m).join(","),Error(r(268,m)));return m=f(y),m=m!==null?p(m):null,m===null?null:Df(m.stateNode)}function Tx(m,y,C,D,j,Q){j=$i(j),D.context===null?D.context=j:D.pendingContext=j,D=fe(y),D.payload={element:C},Q=Q===void 0?null:Q,Q!==null&&(D.callback=Q),C=Ne(m,D,y),C!==null&&(nc(C,m,y),Be(C,m,y))}function ng(m,y){if(m=m.memoizedState,m!==null&&m.dehydrated!==null){var C=m.retryLane;m.retryLane=C!==0&&C<y?C:y}}function kd(m,y){ng(m,y),(m=m.alternate)&&ng(m,y)}var Vi={},qp=De,ps=lG,Ih=Object.assign,$p=Symbol.for("react.element"),ig=Symbol.for("react.transitional.element"),Wp=Symbol.for("react.portal"),kh=Symbol.for("react.fragment"),ul=Symbol.for("react.strict_mode"),Ph=Symbol.for("react.profiler"),Yp=Symbol.for("react.provider"),uS=Symbol.for("react.consumer"),Vu=Symbol.for("react.context"),rg=Symbol.for("react.forward_ref"),av=Symbol.for("react.suspense"),Kp=Symbol.for("react.suspense_list"),ov=Symbol.for("react.memo"),Gu=Symbol.for("react.lazy"),Dh=Symbol.for("react.offscreen"),OR=Symbol.for("react.memo_cache_sentinel"),mo=Symbol.iterator,hS=Symbol.for("react.client.reference"),bi=qp.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,sg,my,Xp=!1,Pd=Array.isArray,cv=e.rendererVersion,Nc=e.rendererPackageName,qu=e.extraDevToolsConfig,Df=e.getPublicInstance,ag=e.getRootHostContext,xx=e.getChildHostContext,wx=e.prepareForCommit,Cx=e.resetAfterCommit,Zp=e.createInstance,Jp=e.appendInitialChild,dS=e.finalizeInitialChildren,og=e.shouldSetTextContent,lv=e.createTextInstance,Ax=e.scheduleTimeout,gy=e.cancelTimeout,uv=e.noTimeout,ru=e.isPrimaryRenderer;e.warnsIfNotActing;var Lo=e.supportsMutation,$u=e.supportsPersistence,Dl=e.supportsHydration,hv=e.getInstanceFromNode;e.beforeActiveInstanceBlur,e.afterActiveInstanceBlur;var NR=e.preparePortalMount;e.prepareScopeUpdate,e.getInstanceFromScope;var ic=e.setCurrentUpdatePriority,go=e.getCurrentUpdatePriority,Wu=e.resolveUpdatePriority;e.resolveEventType,e.resolveEventTimeStamp;var Ll=e.shouldAttemptEagerTransition,ms=e.detachDeletedInstance;e.requestPostPaintCallback;var fS=e.maySuspendCommit,Yu=e.preloadInstance,pS=e.startSuspendingCommit,vy=e.suspendInstance,mS=e.waitForCommitToBeReady,Dd=e.NotPendingTransition,Ul=e.HostTransitionContext,ui=e.resetFormInstance;e.bindToConsole;var _y=e.supportsMicrotasks,ii=e.scheduleMicrotask,Bl=e.supportsTestSelectors,dv=e.findFiberRoot,gS=e.getBoundingRect,Ka=e.getTextContent,Qp=e.isHiddenSubtree,Rx=e.matchAccessibilityRole,vS=e.setFocusIfFocusable,Us=e.setupIntersectionObserver,rc=e.appendChild,yy=e.appendChildToContainer,_S=e.commitTextUpdate,IR=e.commitMount,fv=e.commitUpdate,Mx=e.insertBefore,Ox=e.insertInContainerBefore,cg=e.removeChild,yS=e.removeChildFromContainer,pv=e.resetTextContent,hl=e.hideInstance,lg=e.hideTextInstance,by=e.unhideInstance,Xa=e.unhideTextInstance,ug=e.clearContainer,mv=e.cloneInstance,Ey=e.createContainerChildSet,Ku=e.appendChildToContainerChildSet,em=e.finalizeContainerChildren,bS=e.replaceContainerChildren,hg=e.cloneHiddenInstance,Za=e.cloneHiddenTextInstance,dg=e.isSuspenseInstancePending,Ea=e.isSuspenseInstanceFallback,Lh=e.getSuspenseInstanceFallbackErrorDetails,Nx=e.registerSuspenseInstanceRetry,fg=e.canHydrateFormStateMarker,Sy=e.isFormStateMarkerMatching,sc=e.getNextHydratableSibling,Uo=e.getFirstHydratableChild,Bo=e.getFirstHydratableChildWithinContainer,ES=e.getFirstHydratableChildWithinSuspenseInstance,Ix=e.canHydrateInstance,Ld=e.canHydrateTextInstance,Sr=e.canHydrateSuspenseInstance,kR=e.hydrateInstance,PR=e.hydrateTextInstance,DR=e.hydrateSuspenseInstance,pg=e.getNextHydratableInstanceAfterSuspenseInstance,mg=e.commitHydratedContainer,gv=e.commitHydratedSuspenseInstance,LR=e.clearSuspenseBoundary,UR=e.clearSuspenseBoundaryFromContainer,kx=e.shouldDeleteUnhydratedTailInstances;e.diffHydratedPropsForDevWarnings,e.diffHydratedTextForDevWarnings,e.describeHydratableInstanceForDevWarnings;var Xu=e.validateHydratableInstance,Zu=e.validateHydratableTextInstance,vo=e.supportsResources,Uh=e.isHostHoistableType,Ud=e.getHoistableRoot,Bh=e.getResource,Ks=e.acquireResource,ac=e.releaseResource,SS=e.hydrateHoistable,vv=e.mountHoistable,TS=e.unmountHoistable,BR=e.createHoistableInstance,Px=e.prepareToCommitHoistables,Ty=e.mayResourceSuspendCommit,xS=e.preloadResource,FR=e.suspendResource,ka=e.supportsSingletons,gg=e.resolveSingletonInstance,xy=e.clearSingleton,wS=e.acquireSingletonInstance,CS=e.releaseSingletonInstance,AS=e.isHostSingletonType,_o=[],Lf=-1,oc={},cc=Math.clz32?Math.clz32:S,zR=Math.log,wy=Math.LN2,_v=128,Ja=4194304,Bs=ps.unstable_scheduleCallback,Fh=ps.unstable_cancelCallback,jR=ps.unstable_shouldYield,qr=ps.unstable_requestPaint,ei=ps.unstable_now,Dx=ps.unstable_ImmediatePriority,yo=ps.unstable_UserBlockingPriority,Fs=ps.unstable_NormalPriority,Uf=ps.unstable_IdlePriority,vg=ps.log,RS=ps.unstable_setDisableYieldValue,N=null,T=null,A=typeof Object.is=="function"?Object.is:K,O=new WeakMap,L=[],B=0,H=null,ne=0,se=[],Z=0,oe=null,de=1,me="",Pe=_(null),Xe=_(null),qe=_(null),Ie=_(null),xe=null,lt=null,At=!1,Jt=null,Nt=!1,Qn=Error(r(519)),On=[],Ei=0,Fi=0,Pi=null,Ai=null,Si=!1,Oi=!1,Di=!1,Ti=0,Ni=null,hi=0,An=0,Kn=null,Wi=!1,ts=!1,ws=Object.prototype.hasOwnProperty,ns=Error(r(460)),gs=Error(r(474)),is={then:function(){}},kr=null,fr=null,Kr=0,rs=or(!0),vs=or(!1),ia=_(null),Sa=_(0),Cs=_(null),zs=null,pr=_(0),Pa=0,ti=null,qi=null,Or=null,Qa=!1,Fo=!1,Ic=!1,dl=0,_s=0,lc=null,zh=0,su=function(){return{lastEffect:null,events:null,stores:null,memoCache:null}},Da={readContext:Wa,use:_t,useCallback:ni,useContext:ni,useEffect:ni,useImperativeHandle:ni,useLayoutEffect:ni,useInsertionEffect:ni,useMemo:ni,useReducer:ni,useRef:ni,useState:ni,useDebugValue:ni,useDeferredValue:ni,useTransition:ni,useSyncExternalStore:ni,useId:ni};Da.useCacheRefresh=ni,Da.useMemoCache=ni,Da.useHostTransitionStatus=ni,Da.useFormState=ni,Da.useActionState=ni,Da.useOptimistic=ni;var bo={readContext:Wa,use:_t,useCallback:function(m,y){return Ee().memoizedState=[m,y===void 0?null:y],m},useContext:Wa,useEffect:xh,useImperativeHandle:function(m,y,C){C=C!=null?C.concat([m]):null,zp(4194308,4,Qo.bind(null,y,m),C)},useLayoutEffect:function(m,y){return zp(4194308,4,m,y)},useInsertionEffect:function(m,y){zp(4,2,m,y)},useMemo:function(m,y){var C=Ee();y=y===void 0?null:y;var D=m();if(Ic){J(!0);try{m()}finally{J(!1)}}return C.memoizedState=[D,y],D},useReducer:function(m,y,C){var D=Ee();if(C!==void 0){var j=C(y);if(Ic){J(!0);try{C(y)}finally{J(!1)}}}else j=y;return D.memoizedState=D.baseState=j,m={pending:null,lanes:0,dispatch:null,lastRenderedReducer:m,lastRenderedState:j},D.queue=m,m=m.dispatch=px.bind(null,ti,m),[D.memoizedState,m]},useRef:function(m){var y=Ee();return m={current:m},y.memoizedState=m},useState:function(m){m=xs(m);var y=m.queue,C=KE.bind(null,ti,y);return y.dispatch=C,[m.memoizedState,C]},useDebugValue:ec,useDeferredValue:function(m,y){var C=Ee();return ku(C,m,y)},useTransition:function(){var m=xs(!1);return m=wd.bind(null,ti,m.queue,!0,!1),Ee().memoizedState=m,[!1,m]},useSyncExternalStore:function(m,y,C){var D=ti,j=Ee();if(At){if(C===void 0)throw Error(r(407));C=C()}else{if(C=y(),Dn===null)throw Error(r(349));Bn&60||li(D,y,C)}j.memoizedState=C;var Q={value:C,getSnapshot:y};return j.queue=Q,xh(yi.bind(null,D,Q,m),[m]),D.flags|=2048,Il(9,Nn.bind(null,D,Q,C,y),{destroy:void 0},null),C},useId:function(){var m=Ee(),y=Dn.identifierPrefix;if(At){var C=me,D=de;C=(D&~(1<<32-cc(D)-1)).toString(32)+C,y=":"+y+"R"+C,C=dl++,0<C&&(y+="H"+C.toString(32)),y+=":"}else C=zh++,y=":"+y+"r"+C.toString(32)+":";return m.memoizedState=y},useCacheRefresh:function(){return Ee().memoizedState=iy.bind(null,ti)}};bo.useMemoCache=Ze,bo.useHostTransitionStatus=wh,bo.useFormState=ds,bo.useActionState=ds,bo.useOptimistic=function(m){var y=Ee();y.memoizedState=y.baseState=m;var C={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return y.queue=C,y=wf.bind(null,ti,!0,C),C.dispatch=y,[m,y]};var zo={readContext:Wa,use:_t,useCallback:fx,useContext:Wa,useEffect:k0,useImperativeHandle:D0,useInsertionEffect:ty,useLayoutEffect:P0,useMemo:WE,useReducer:rn,useRef:ma,useState:function(){return rn(Vt)},useDebugValue:ec,useDeferredValue:function(m,y){var C=We();return Vm(C,qi.memoizedState,m,y)},useTransition:function(){var m=rn(Vt)[0],y=We().memoizedState;return[typeof m=="boolean"?m:vt(m),y]},useSyncExternalStore:ci,useId:ny};zo.useCacheRefresh=YE,zo.useMemoCache=Ze,zo.useHostTransitionStatus=wh,zo.useFormState=Sn,zo.useActionState=Sn,zo.useOptimistic=function(m,y){var C=We();return Zi(C,qi,m,y)};var uc={readContext:Wa,use:_t,useCallback:fx,useContext:Wa,useEffect:k0,useImperativeHandle:D0,useInsertionEffect:ty,useLayoutEffect:P0,useMemo:WE,useReducer:wn,useRef:ma,useState:function(){return wn(Vt)},useDebugValue:ec,useDeferredValue:function(m,y){var C=We();return qi===null?ku(C,m,y):Vm(C,qi.memoizedState,m,y)},useTransition:function(){var m=wn(Vt)[0],y=We().memoizedState;return[typeof m=="boolean"?m:vt(m),y]},useSyncExternalStore:ci,useId:ny};uc.useCacheRefresh=YE,uc.useMemoCache=Ze,uc.useHostTransitionStatus=wh,uc.useFormState=Yn,uc.useActionState=Yn,uc.useOptimistic=function(m,y){var C=We();return qi!==null?Zi(C,qi,m,y):(C.baseState=m,[m,C.queue.dispatch])};var Bf={isMounted:function(m){return(m=m._reactInternals)?h(m)===m:!1},enqueueSetState:function(m,y,C){m=m._reactInternals;var D=Do(),j=fe(D);j.payload=y,C!=null&&(j.callback=C),y=Ne(m,j,D),y!==null&&(nc(y,m,D),Be(y,m,D))},enqueueReplaceState:function(m,y,C){m=m._reactInternals;var D=Do(),j=fe(D);j.tag=1,j.payload=y,C!=null&&(j.callback=C),y=Ne(m,j,D),y!==null&&(nc(y,m,D),Be(y,m,D))},enqueueForceUpdate:function(m,y){m=m._reactInternals;var C=Do(),D=fe(C);D.tag=2,y!=null&&(D.callback=y),y=Ne(m,D,C),y!==null&&(nc(y,m,C),Be(y,m,C))}},Ff=typeof reportError=="function"?reportError:function(m){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var y=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof m=="object"&&m!==null&&typeof m.message=="string"?String(m.message):String(m),error:m});if(!window.dispatchEvent(y))return}else if(typeof Gn=="object"&&typeof Gn.emit=="function"){Gn.emit("uncaughtException",m);return}console.error(m)},tm=Error(r(461)),Xs=!1,Bd={dehydrated:null,treeContext:null,retryLane:0},jh=_(null),Ju=null,Fl=null,yv=typeof AbortController<"u"?AbortController:function(){var m=[],y=this.signal={aborted:!1,addEventListener:function(C,D){m.push(D)}};this.abort=function(){y.aborted=!0,m.forEach(function(C){return C()})}},Cy=ps.unstable_scheduleCallback,bv=ps.unstable_NormalPriority,Xr={$$typeof:Vu,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0},Ev=bi.S;bi.S=function(m,y){typeof y=="object"&&y!==null&&typeof y.then=="function"&&Ht(m,y),Ev!==null&&Ev(m,y)};var Hh=_(null),E=!1,w=!1,F=!1,ee=typeof WeakSet=="function"?WeakSet:Set,ue=null,Ae=!1,Ue=null,Ge=!1,ot=null,It=8192,Dt={getCacheForType:function(m){var y=Wa(Xr),C=y.data.get(m);return C===void 0&&(C=m(),y.data.set(m,C)),C}},Xt=0,Pn=1,jn=2,ri=3,Lt=4;if(typeof Symbol=="function"&&Symbol.for){var en=Symbol.for;Xt=en("selector.component"),Pn=en("selector.has_pseudo_class"),jn=en("selector.role"),ri=en("selector.test_id"),Lt=en("selector.text")}var _i=typeof WeakMap=="function"?WeakMap:Map,$t=0,Dn=null,cn=null,Bn=0,ln=0,Vn=null,Os=!1,js=!1,kc=!1,Pr=0,mr=0,Pc=0,au=0,Ay=0,ou=0,nm=0,Fd=null,zd=null,Lx=!1,Ry=0,Sv=1/0,Tv=null,jd=null,MS=!1,zf=null,_g=0,u5=0,h5=null,HR=0,d5=null;return Vi.attemptContinuousHydration=function(m){if(m.tag===13){var y=rt(m,67108864);y!==null&&nc(y,m,67108864),kd(m,67108864)}},Vi.attemptHydrationAtCurrentPriority=function(m){if(m.tag===13){var y=Do(),C=rt(m,y);C!==null&&nc(C,m,y),kd(m,y)}},Vi.attemptSynchronousHydration=function(m){switch(m.tag){case 3:if(m=m.stateNode,m.current.memoizedState.isDehydrated){var y=x(m.pendingLanes);if(y!==0){for(m.pendingLanes|=2,m.entangledLanes|=2;y;){var C=1<<31-cc(y);m.entanglements[1]|=C,y&=~C}bt(m),!($t&6)&&(Sv=ei()+500,we(0))}}break;case 13:y=rt(m,2),y!==null&&nc(y,m,2),uy(),kd(m,2)}},Vi.batchedUpdates=function(m,y){return m(y)},Vi.createComponentSelector=function(m){return{$$typeof:Xt,value:m}},Vi.createContainer=function(m,y,C,D,j,Q,Ce,He,ut,kt){return py(m,y,!1,null,C,D,Q,Ce,He,ut,kt,null)},Vi.createHasPseudoClassSelector=function(m){return{$$typeof:Pn,value:m}},Vi.createHydrationContainer=function(m,y,C,D,j,Q,Ce,He,ut,kt,nn,Rn,In){return m=py(C,D,!0,m,j,Q,He,ut,kt,nn,Rn,In),m.context=$i(null),C=m.current,D=Do(),j=fe(D),j.callback=y??null,Ne(C,j,D),m.current.lanes=D,V(m,D),bt(m),m},Vi.createPortal=function(m,y,C){var D=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Wp,key:D==null?null:""+D,children:m,containerInfo:y,implementation:C}},Vi.createRoleSelector=function(m){return{$$typeof:jn,value:m}},Vi.createTestNameSelector=function(m){return{$$typeof:ri,value:m}},Vi.createTextSelector=function(m){return{$$typeof:Lt,value:m}},Vi.defaultOnCaughtError=function(m){console.error(m)},Vi.defaultOnRecoverableError=function(m){Ff(m)},Vi.defaultOnUncaughtError=function(m){Ff(m)},Vi.deferredUpdates=function(m){var y=bi.T,C=go();try{return ic(32),bi.T=null,m()}finally{ic(C),bi.T=y}},Vi.discreteUpdates=function(m,y,C,D,j){var Q=bi.T,Ce=go();try{return ic(2),bi.T=null,m(y,C,D,j)}finally{ic(Ce),bi.T=Q,$t===0&&(Sv=ei()+500)}},Vi.findAllNodes=If,Vi.findBoundingRects=function(m,y){if(!Bl)throw Error(r(363));y=If(m,y),m=[];for(var C=0;C<y.length;C++)m.push(gS(y[C]));for(y=m.length-1;0<y;y--){C=m[y];for(var D=C.x,j=D+C.width,Q=C.y,Ce=Q+C.height,He=y-1;0<=He;He--)if(y!==He){var ut=m[He],kt=ut.x,nn=kt+ut.width,Rn=ut.y,In=Rn+ut.height;if(D>=kt&&Q>=Rn&&j<=nn&&Ce<=In){m.splice(y,1);break}else if(D!==kt||C.width!==ut.width||In<Q||Rn>Ce){if(!(Q!==Rn||C.height!==ut.height||nn<D||kt>j)){kt>D&&(ut.width+=kt-D,ut.x=D),nn<j&&(ut.width=j-kt),m.splice(y,1);break}}else{Rn>Q&&(ut.height+=Rn-Q,ut.y=Q),In<Ce&&(ut.height=Ce-Rn),m.splice(y,1);break}}}return m},Vi.findHostInstance=sv,Vi.findHostInstanceWithNoPortals=function(m){return m=f(m),m=m!==null?g(m):null,m===null?null:Df(m.stateNode)},Vi.findHostInstanceWithWarning=function(m){return sv(m)},Vi.flushPassiveEffects=Oc,Vi.flushSyncFromReconciler=function(m){var y=$t;$t|=1;var C=bi.T,D=go();try{if(ic(2),bi.T=null,m)return m()}finally{ic(D),bi.T=C,$t=y,!($t&6)&&we(0)}},Vi.flushSyncWork=uy,Vi.focusWithin=function(m,y){if(!Bl)throw Error(r(363));for(m=nu(m),y=K0(m,y),y=Array.from(y),m=0;m<y.length;){var C=y[m++],D=C.tag;if(!Qp(C)){if((D===5||D===26||D===27)&&vS(C.stateNode))return!0;for(C=C.child;C!==null;)y.push(C),C=C.sibling}}return!1},Vi.getFindAllNodesFailureDescription=function(m,y){if(!Bl)throw Error(r(363));var C=0,D=[];m=[nu(m),0];for(var j=0;j<m.length;){var Q=m[j++],Ce=Q.tag,He=m[j++],ut=y[He];if((Ce!==5&&Ce!==26&&Ce!==27||!Qp(Q))&&(ly(Q,ut)&&(D.push(Y0(ut)),He++,He>C&&(C=He)),He<y.length))for(Q=Q.child;Q!==null;)m.push(Q,He),Q=Q.sibling}if(C<y.length){for(m=[];C<y.length;C++)m.push(Y0(y[C]));return`findAllNodes was able to match part of the selector:
  `+(D.join(" > ")+`

No matching component was found for:
  `)+m.join(" > ")}return null},Vi.getPublicRootInstance=function(m){if(m=m.current,!m.child)return null;switch(m.child.tag){case 27:case 5:return Df(m.child.stateNode);default:return m.child.stateNode}},Vi.injectIntoDevTools=function(){var m={bundleType:0,version:cv,rendererPackageName:Nc,currentDispatcherRef:bi,findFiberByHostInstance:hv,reconcilerVersion:"19.0.0"};if(qu!==null&&(m.rendererConfig=qu),typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u")m=!1;else{var y=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(y.isDisabled||!y.supportsFiber)m=!0;else{try{N=y.inject(m),T=y}catch{}m=!!y.checkDCE}}return m},Vi.isAlreadyRendering=function(){return!1},Vi.observeVisibleRects=function(m,y,C,D){if(!Bl)throw Error(r(363));m=If(m,y);var j=Us(m,C,D).disconnect;return{disconnect:function(){j()}}},Vi.shouldError=function(){return null},Vi.shouldSuspend=function(){return!1},Vi.startHostTransition=function(m,y,C,D){if(m.tag!==5)throw Error(r(476));var j=Rs(m).queue;wd(m,j,y,Dd,C===null?i:function(){var Q=Rs(m).next.queue;return xf(m,Q,{},Do()),C(D)})},Vi.updateContainer=function(m,y,C,D){var j=y.current,Q=Do();return Tx(j,Q,m,y,C,D),Q},Vi.updateContainerSync=function(m,y,C,D){return y.tag===0&&Oc(),Tx(y.current,2,m,y,C,D),2},Vi},t.exports.default=t.exports,Object.defineProperty(t.exports,"__esModule",{value:!0})})(phe);var aDe=phe.exports;fhe.exports=aDe;var oDe=fhe.exports;const cDe=il(oDe),lDe=t=>typeof t=="object"&&typeof t.then=="function",_D=[];function uDe(t,e,n=(i,r)=>i===r){if(t===e)return!0;if(!t||!e)return!1;const i=t.length;if(e.length!==i)return!1;for(let r=0;r<i;r++)if(!n(t[r],e[r]))return!1;return!0}function hDe(t,e=null,n=!1,i={}){e===null&&(e=[t]);for(const s of _D)if(uDe(e,s.keys,s.equal)){if(n)return;if(Object.prototype.hasOwnProperty.call(s,"error"))throw s.error;if(Object.prototype.hasOwnProperty.call(s,"response"))return i.lifespan&&i.lifespan>0&&(s.timeout&&clearTimeout(s.timeout),s.timeout=setTimeout(s.remove,i.lifespan)),s.response;if(!n)throw s.promise}const r={keys:e,equal:i.equal,remove:()=>{const s=_D.indexOf(r);s!==-1&&_D.splice(s,1)},promise:(lDe(t)?t:t(...e)).then(s=>{r.response=s,i.lifespan&&i.lifespan>0&&(r.timeout=setTimeout(r.remove,i.lifespan))}).catch(s=>r.error=s)};if(_D.push(r),!n)throw r.promise}const dDe=(t,e,n)=>hDe(t,e,!1,n);function OW(t,e,n){if(!t)return;if(n(t)===!0)return t;let i=e?t.return:t.child;for(;i;){const r=OW(i,e,n);if(r)return r;i=e?null:i.sibling}}function vhe(t){try{return Object.defineProperties(t,{_currentRenderer:{get(){return null},set(){}},_currentRenderer2:{get(){return null},set(){}}})}catch{return t}}const NW=vhe(De.createContext(null));let _he=class extends De.Component{render(){return De.createElement(NW.Provider,{value:this._reactInternals},this.props.children)}};function yhe(){const t=De.useContext(NW);if(t===null)throw new Error("its-fine: useFiber must be called within a <FiberProvider />!");const e=De.useId();return De.useMemo(()=>{for(const n of[t,t==null?void 0:t.alternate]){if(!n)continue;const i=OW(n,!1,r=>{let s=r.memoizedState;for(;s;){if(s.memoizedState===e)return!0;s=s.next}});if(i)return i}},[t,e])}const fDe=Symbol.for("react.context"),pDe=t=>t!==null&&typeof t=="object"&&"$$typeof"in t&&t.$$typeof===fDe;function mDe(){const t=yhe(),[e]=De.useState(()=>new Map);e.clear();let n=t;for(;n;){const i=n.type;pDe(i)&&i!==NW&&!e.has(i)&&e.set(i,De.use(vhe(i))),n=n.return}return e}function gDe(){const t=mDe();return De.useMemo(()=>Array.from(t.keys()).reduce((e,n)=>i=>De.createElement(e,null,De.createElement(n.Provider,{...i,value:t.get(n)})),e=>De.createElement(_he,{...e})),[t])}function bhe(t){let e=t.root;for(;e.getState().previousRoot;)e=e.getState().previousRoot;return e}const Ehe=t=>t&&t.isOrthographicCamera,vDe=t=>t&&t.hasOwnProperty("current"),_De=t=>t!=null&&(typeof t=="string"||typeof t=="number"||t.isColor),GI=((t,e)=>typeof window<"u"&&(((t=window.document)==null?void 0:t.createElement)||((e=window.navigator)==null?void 0:e.product)==="ReactNative"))()?De.useLayoutEffect:De.useEffect;function IW(t){const e=De.useRef(t);return GI(()=>void(e.current=t),[t]),e}function yDe(){const t=yhe(),e=gDe();return De.useMemo(()=>({children:n})=>{const r=!!OW(t,!0,s=>s.type===De.StrictMode)?De.StrictMode:De.Fragment;return be.jsx(r,{children:be.jsx(e,{children:n})})},[t,e])}function bDe({set:t}){return GI(()=>(t(new Promise(()=>null)),()=>t(!1)),[t]),null}const EDe=(t=>(t=class extends De.Component{constructor(...n){super(...n),this.state={error:!1}}componentDidCatch(n){this.props.set(n)}render(){return this.state.error?null:this.props.children}},t.getDerivedStateFromError=()=>({error:!0}),t))();function She(t){var e;const n=typeof window<"u"?(e=window.devicePixelRatio)!=null?e:2:1;return Array.isArray(t)?Math.min(Math.max(t[0],n),t[1]):t}function tw(t){var e;return(e=t.__r3f)==null?void 0:e.root.getState()}const no={obj:t=>t===Object(t)&&!no.arr(t)&&typeof t!="function",fun:t=>typeof t=="function",str:t=>typeof t=="string",num:t=>typeof t=="number",boo:t=>typeof t=="boolean",und:t=>t===void 0,nul:t=>t===null,arr:t=>Array.isArray(t),equ(t,e,{arrays:n="shallow",objects:i="reference",strict:r=!0}={}){if(typeof t!=typeof e||!!t!=!!e)return!1;if(no.str(t)||no.num(t)||no.boo(t))return t===e;const s=no.obj(t);if(s&&i==="reference")return t===e;const a=no.arr(t);if(a&&n==="reference")return t===e;if((a||s)&&t===e)return!0;let o;for(o in t)if(!(o in e))return!1;if(s&&n==="shallow"&&i==="shallow"){for(o in r?e:t)if(!no.equ(t[o],e[o],{strict:r,objects:"reference"}))return!1}else for(o in r?e:t)if(t[o]!==e[o])return!1;if(no.und(o)){if(a&&t.length===0&&e.length===0||s&&Object.keys(t).length===0&&Object.keys(e).length===0)return!0;if(t!==e)return!1}return!0}};function SDe(t){t.type!=="Scene"&&(t.dispose==null||t.dispose());for(const e in t){const n=t[e];(n==null?void 0:n.type)!=="Scene"&&(n==null||n.dispose==null||n.dispose())}}const The=["children","key","ref"];function TDe(t){const e={};for(const n in t)The.includes(n)||(e[n]=t[n]);return e}function IU(t,e,n,i){const r=t;let s=r==null?void 0:r.__r3f;return s||(s={root:e,type:n,parent:null,children:[],props:TDe(i),object:r,eventCount:0,handlers:{},isHidden:!1},r&&(r.__r3f=s)),s}function sN(t,e){let n=t[e];if(!e.includes("-"))return{root:t,key:e,target:n};n=t;for(const r of e.split("-")){var i;e=r,t=n,n=(i=n)==null?void 0:i[e]}return{root:t,key:e,target:n}}const BQ=/-\d+$/;function kU(t,e){if(no.str(e.props.attach)){if(BQ.test(e.props.attach)){const r=e.props.attach.replace(BQ,""),{root:s,key:a}=sN(t.object,r);Array.isArray(s[a])||(s[a]=[])}const{root:n,key:i}=sN(t.object,e.props.attach);e.previousAttach=n[i],n[i]=e.object}else no.fun(e.props.attach)&&(e.previousAttach=e.props.attach(t.object,e.object))}function PU(t,e){if(no.str(e.props.attach)){const{root:n,key:i}=sN(t.object,e.props.attach),r=e.previousAttach;r===void 0?delete n[i]:n[i]=r}else e.previousAttach==null||e.previousAttach(t.object,e.object);delete e.previousAttach}const uG=[...The,"args","dispose","attach","object","onUpdate","dispose"],FQ=new Map;function xDe(t){let e=FQ.get(t.constructor);try{e||(e=new t.constructor,FQ.set(t.constructor,e))}catch{}return e}function wDe(t,e){const n={};for(const i in e)if(!uG.includes(i)&&!no.equ(e[i],t.props[i])){n[i]=e[i];for(const r in e)r.startsWith(`${i}-`)&&(n[r]=e[r])}for(const i in t.props){if(uG.includes(i)||e.hasOwnProperty(i))continue;const{root:r,key:s}=sN(t.object,i);if(r.constructor&&r.constructor.length===0){const a=xDe(r);no.und(a)||(n[s]=a[s])}else n[s]=0}return n}const CDe=["map","emissiveMap","sheenColorMap","specularColorMap","envMap"],ADe=/^on(Pointer|Click|DoubleClick|ContextMenu|Wheel)/;function fb(t,e){var n;const i=t.__r3f,r=i&&bhe(i).getState(),s=i==null?void 0:i.eventCount;for(const o in e){let c=e[o];if(uG.includes(o))continue;if(i&&ADe.test(o)){typeof c=="function"?i.handlers[o]=c:delete i.handlers[o],i.eventCount=Object.keys(i.handlers).length;continue}if(c===void 0)continue;let{root:l,key:u,target:h}=sN(t,o);if(h instanceof jC&&c instanceof jC)h.mask=c.mask;else if(h instanceof bn&&_De(c))h.set(c);else if(h!==null&&typeof h=="object"&&typeof h.set=="function"&&typeof h.copy=="function"&&c!=null&&c.constructor&&h.constructor===c.constructor)h.copy(c);else if(h!==null&&typeof h=="object"&&typeof h.set=="function"&&Array.isArray(c))typeof h.fromArray=="function"?h.fromArray(c):h.set(...c);else if(h!==null&&typeof h=="object"&&typeof h.set=="function"&&typeof c=="number")typeof h.setScalar=="function"?h.setScalar(c):h.set(c);else{var a;l[u]=c,r&&!r.linear&&CDe.includes(u)&&(a=l[u])!=null&&a.isTexture&&l[u].format===Wc&&l[u].type===lo&&(l[u].colorSpace=ls)}}if(i!=null&&i.parent&&r!=null&&r.internal&&(n=i.object)!=null&&n.isObject3D&&s!==i.eventCount){const o=i.object,c=r.internal.interaction.indexOf(o);c>-1&&r.internal.interaction.splice(c,1),i.eventCount&&o.raycast!==null&&r.internal.interaction.push(o)}return i&&i.props.attach===void 0&&(i.object.isBufferGeometry?i.props.attach="geometry":i.object.isMaterial&&(i.props.attach="material")),i&&nR(i),t}function nR(t){var e;if(!t.parent)return;t.props.onUpdate==null||t.props.onUpdate(t.object);const n=(e=t.root)==null||e.getState==null?void 0:e.getState();n&&n.internal.frames===0&&n.invalidate()}function xhe(t,e){t.manual||(Ehe(t)?(t.left=e.width/-2,t.right=e.width/2,t.top=e.height/2,t.bottom=e.height/-2):t.aspect=e.width/e.height,t.updateProjectionMatrix())}const Zh=t=>t==null?void 0:t.isObject3D;function yD(t){return(t.eventObject||t.object).uuid+"/"+t.index+t.instanceId}function whe(t,e,n,i){const r=n.get(e);r&&(n.delete(e),n.size===0&&(t.delete(i),r.target.releasePointerCapture(i)))}function RDe(t,e){const{internal:n}=t.getState();n.interaction=n.interaction.filter(i=>i!==e),n.initialHits=n.initialHits.filter(i=>i!==e),n.hovered.forEach((i,r)=>{(i.eventObject===e||i.object===e)&&n.hovered.delete(r)}),n.capturedMap.forEach((i,r)=>{whe(n.capturedMap,e,i,r)})}function MDe(t){function e(c){const{internal:l}=t.getState(),u=c.offsetX-l.initialClick[0],h=c.offsetY-l.initialClick[1];return Math.round(Math.sqrt(u*u+h*h))}function n(c){return c.filter(l=>["Move","Over","Enter","Out","Leave"].some(u=>{var h;return(h=l.__r3f)==null?void 0:h.handlers["onPointer"+u]}))}function i(c,l){const u=t.getState(),h=new Set,d=[],f=l?l(u.internal.interaction):u.internal.interaction;for(let v=0;v<f.length;v++){const b=tw(f[v]);b&&(b.raycaster.camera=void 0)}u.previousRoot||u.events.compute==null||u.events.compute(c,u);function p(v){const b=tw(v);if(!b||!b.events.enabled||b.raycaster.camera===null)return[];if(b.raycaster.camera===void 0){var S;b.events.compute==null||b.events.compute(c,b,(S=b.previousRoot)==null?void 0:S.getState()),b.raycaster.camera===void 0&&(b.raycaster.camera=null)}return b.raycaster.camera?b.raycaster.intersectObject(v,!0):[]}let g=f.flatMap(p).sort((v,b)=>{const S=tw(v.object),x=tw(b.object);return!S||!x?v.distance-b.distance:x.events.priority-S.events.priority||v.distance-b.distance}).filter(v=>{const b=yD(v);return h.has(b)?!1:(h.add(b),!0)});u.events.filter&&(g=u.events.filter(g,u));for(const v of g){let b=v.object;for(;b;){var _;(_=b.__r3f)!=null&&_.eventCount&&d.push({...v,eventObject:b}),b=b.parent}}if("pointerId"in c&&u.internal.capturedMap.has(c.pointerId))for(let v of u.internal.capturedMap.get(c.pointerId).values())h.has(yD(v.intersection))||d.push(v.intersection);return d}function r(c,l,u,h){if(c.length){const d={stopped:!1};for(const f of c){let p=tw(f.object);if(p||f.object.traverseAncestors(g=>{const _=tw(g);if(_)return p=_,!1}),p){const{raycaster:g,pointer:_,camera:v,internal:b}=p,S=new Oe(_.x,_.y,0).unproject(v),x=P=>{var U,V;return(U=(V=b.capturedMap.get(P))==null?void 0:V.has(f.eventObject))!=null?U:!1},M=P=>{const U={intersection:f,target:l.target};b.capturedMap.has(P)?b.capturedMap.get(P).set(f.eventObject,U):b.capturedMap.set(P,new Map([[f.eventObject,U]])),l.target.setPointerCapture(P)},R=P=>{const U=b.capturedMap.get(P);U&&whe(b.capturedMap,f.eventObject,U,P)};let I={};for(let P in l){let U=l[P];typeof U!="function"&&(I[P]=U)}let k={...f,...I,pointer:_,intersections:c,stopped:d.stopped,delta:u,unprojectedPoint:S,ray:g.ray,camera:v,stopPropagation(){const P="pointerId"in l&&b.capturedMap.get(l.pointerId);if((!P||P.has(f.eventObject))&&(k.stopped=d.stopped=!0,b.hovered.size&&Array.from(b.hovered.values()).find(U=>U.eventObject===f.eventObject))){const U=c.slice(0,c.indexOf(f));s([...U,f])}},target:{hasPointerCapture:x,setPointerCapture:M,releasePointerCapture:R},currentTarget:{hasPointerCapture:x,setPointerCapture:M,releasePointerCapture:R},nativeEvent:l};if(h(k),d.stopped===!0)break}}}return c}function s(c){const{internal:l}=t.getState();for(const u of l.hovered.values())if(!c.length||!c.find(h=>h.object===u.object&&h.index===u.index&&h.instanceId===u.instanceId)){const d=u.eventObject.__r3f;if(l.hovered.delete(yD(u)),d!=null&&d.eventCount){const f=d.handlers,p={...u,intersections:c};f.onPointerOut==null||f.onPointerOut(p),f.onPointerLeave==null||f.onPointerLeave(p)}}}function a(c,l){for(let u=0;u<l.length;u++){const h=l[u].__r3f;h==null||h.handlers.onPointerMissed==null||h.handlers.onPointerMissed(c)}}function o(c){switch(c){case"onPointerLeave":case"onPointerCancel":return()=>s([]);case"onLostPointerCapture":return l=>{const{internal:u}=t.getState();"pointerId"in l&&u.capturedMap.has(l.pointerId)&&requestAnimationFrame(()=>{u.capturedMap.has(l.pointerId)&&(u.capturedMap.delete(l.pointerId),s([]))})}}return function(u){const{onPointerMissed:h,internal:d}=t.getState();d.lastEvent.current=u;const f=c==="onPointerMove",p=c==="onClick"||c==="onContextMenu"||c==="onDoubleClick",_=i(u,f?n:void 0),v=p?e(u):0;c==="onPointerDown"&&(d.initialClick=[u.offsetX,u.offsetY],d.initialHits=_.map(S=>S.eventObject)),p&&!_.length&&v<=2&&(a(u,d.interaction),h&&h(u)),f&&s(_);function b(S){const x=S.eventObject,M=x.__r3f;if(!(M!=null&&M.eventCount))return;const R=M.handlers;if(f){if(R.onPointerOver||R.onPointerEnter||R.onPointerOut||R.onPointerLeave){const I=yD(S),k=d.hovered.get(I);k?k.stopped&&S.stopPropagation():(d.hovered.set(I,S),R.onPointerOver==null||R.onPointerOver(S),R.onPointerEnter==null||R.onPointerEnter(S))}R.onPointerMove==null||R.onPointerMove(S)}else{const I=R[c];I?(!p||d.initialHits.includes(x))&&(a(u,d.interaction.filter(k=>!d.initialHits.includes(k))),I(S)):p&&d.initialHits.includes(x)&&a(u,d.interaction.filter(k=>!d.initialHits.includes(k)))}}r(_,u,v,b)}}return{handlePointer:o}}const zQ=t=>!!(t!=null&&t.render),kW=De.createContext(null),ODe=(t,e)=>{const n=dhe((o,c)=>{const l=new Oe,u=new Oe,h=new Oe;function d(v=c().camera,b=u,S=c().size){const{width:x,height:M,top:R,left:I}=S,k=x/M;b.isVector3?h.copy(b):h.set(...b);const P=v.getWorldPosition(l).distanceTo(h);if(Ehe(v))return{width:x/v.zoom,height:M/v.zoom,top:R,left:I,factor:1,distance:P,aspect:k};{const U=v.fov*Math.PI/180,V=2*Math.tan(U/2)*P,$=V*(x/M);return{width:$,height:V,top:R,left:I,factor:x/$,distance:P,aspect:k}}}let f;const p=v=>o(b=>({performance:{...b.performance,current:v}})),g=new xt;return{set:o,get:c,gl:null,camera:null,raycaster:null,events:{priority:1,enabled:!0,connected:!1},scene:null,xr:null,invalidate:(v=1)=>t(c(),v),advance:(v,b)=>e(v,b,c()),legacy:!1,linear:!1,flat:!1,controls:null,clock:new yW,pointer:g,mouse:g,frameloop:"always",onPointerMissed:void 0,performance:{current:1,min:.5,max:1,debounce:200,regress:()=>{const v=c();f&&clearTimeout(f),v.performance.current!==v.performance.min&&p(v.performance.min),f=setTimeout(()=>p(c().performance.max),v.performance.debounce)}},size:{width:0,height:0,top:0,left:0},viewport:{initialDpr:0,dpr:0,width:0,height:0,top:0,left:0,aspect:0,distance:0,factor:0,getCurrentViewport:d},setEvents:v=>o(b=>({...b,events:{...b.events,...v}})),setSize:(v,b,S=0,x=0)=>{const M=c().camera,R={width:v,height:b,top:S,left:x};o(I=>({size:R,viewport:{...I.viewport,...d(M,u,R)}}))},setDpr:v=>o(b=>{const S=She(v);return{viewport:{...b.viewport,dpr:S,initialDpr:b.viewport.initialDpr||S}}}),setFrameloop:(v="always")=>{const b=c().clock;b.stop(),b.elapsedTime=0,v!=="never"&&(b.start(),b.elapsedTime=0),o(()=>({frameloop:v}))},previousRoot:void 0,internal:{interaction:[],hovered:new Map,subscribers:[],initialClick:[0,0],initialHits:[],capturedMap:new Map,lastEvent:De.createRef(),active:!1,frames:0,priority:0,subscribe:(v,b,S)=>{const x=c().internal;return x.priority=x.priority+(b>0?1:0),x.subscribers.push({ref:v,priority:b,store:S}),x.subscribers=x.subscribers.sort((M,R)=>M.priority-R.priority),()=>{const M=c().internal;M!=null&&M.subscribers&&(M.priority=M.priority-(b>0?1:0),M.subscribers=M.subscribers.filter(R=>R.ref!==v))}}}}}),i=n.getState();let r=i.size,s=i.viewport.dpr,a=i.camera;return n.subscribe(()=>{const{camera:o,size:c,viewport:l,gl:u,set:h}=n.getState();if(c.width!==r.width||c.height!==r.height||l.dpr!==s){r=c,s=l.dpr,xhe(o,c),l.dpr>0&&u.setPixelRatio(l.dpr);const d=typeof HTMLCanvasElement<"u"&&u.domElement instanceof HTMLCanvasElement;u.setSize(c.width,c.height,d)}o!==a&&(a=o,h(d=>({viewport:{...d.viewport,...d.viewport.getCurrentViewport(o)}})))}),n.subscribe(o=>t(o)),n};function PW(){const t=De.useContext(kW);if(!t)throw new Error("R3F: Hooks can only be used within the Canvas component!");return t}function Tu(t=n=>n,e){return PW()(t,e)}function Pm(t,e=0){const n=PW(),i=n.getState().internal.subscribe,r=IW(t);return GI(()=>i(r,e,n),[e,i,n]),null}function NDe(t){const e=cDe(t);return e.injectIntoDevTools({bundleType:(typeof Gn<"u",0),rendererPackageName:"@react-three/fiber",version:De.version}),e}const Che=0,WC={},IDe=/^three(?=[A-Z])/,RF=t=>`${t[0].toUpperCase()}${t.slice(1)}`;let kDe=0;const PDe=t=>typeof t=="function";function DW(t){if(PDe(t)){const e=`${kDe++}`;return WC[e]=t,e}else Object.assign(WC,t)}function Ahe(t,e){const n=RF(t),i=WC[n];if(t!=="primitive"&&!i)throw new Error(`R3F: ${n} is not part of the THREE namespace! Did you forget to extend? See: https://docs.pmnd.rs/react-three-fiber/api/objects#using-3rd-party-objects-declaratively`);if(t==="primitive"&&!e.object)throw new Error("R3F: Primitives without 'object' are invalid!");if(e.args!==void 0&&!Array.isArray(e.args))throw new Error("R3F: The args prop must be an array!")}function DDe(t,e,n){var i;return t=RF(t)in WC?t:t.replace(IDe,""),Ahe(t,e),t==="primitive"&&(i=e.object)!=null&&i.__r3f&&delete e.object.__r3f,IU(e.object,n,t,e)}function LDe(t){if(!t.isHidden){var e;t.props.attach&&(e=t.parent)!=null&&e.object?PU(t.parent,t):Zh(t.object)&&(t.object.visible=!1),t.isHidden=!0,nR(t)}}function Rhe(t){if(t.isHidden){var e;t.props.attach&&(e=t.parent)!=null&&e.object?kU(t.parent,t):Zh(t.object)&&t.props.visible!==!1&&(t.object.visible=!0),t.isHidden=!1,nR(t)}}function LW(t,e,n){const i=e.root.getState();if(!(!t.parent&&t.object!==i.scene)){if(!e.object){var r,s;const a=WC[RF(e.type)];e.object=(r=e.props.object)!=null?r:new a(...(s=e.props.args)!=null?s:[]),e.object.__r3f=e}if(fb(e.object,e.props),e.props.attach)kU(t,e);else if(Zh(e.object)&&Zh(t.object)){const a=t.object.children.indexOf(n==null?void 0:n.object);if(n&&a!==-1){const o=t.object.children.indexOf(e.object);if(o!==-1){t.object.children.splice(o,1);const c=o<a?a-1:a;t.object.children.splice(c,0,e.object)}else e.object.parent=t.object,t.object.children.splice(a,0,e.object),e.object.dispatchEvent({type:"added"}),t.object.dispatchEvent({type:"childadded",child:e.object})}else t.object.add(e.object)}for(const a of e.children)LW(e,a);nR(e)}}function tj(t,e){e&&(e.parent=t,t.children.push(e),LW(t,e))}function jQ(t,e,n){if(!e||!n)return;e.parent=t;const i=t.children.indexOf(n);i!==-1?t.children.splice(i,0,e):t.children.push(e),LW(t,e,n)}function Mhe(t){if(typeof t.dispose=="function"){const e=()=>{try{t.dispose()}catch{}};typeof IS_REACT_ACT_ENVIRONMENT<"u"?e():lG.unstable_scheduleCallback(lG.unstable_IdlePriority,e)}}function hG(t,e,n){if(!e)return;e.parent=null;const i=t.children.indexOf(e);i!==-1&&t.children.splice(i,1),e.props.attach?PU(t,e):Zh(e.object)&&Zh(t.object)&&(t.object.remove(e.object),RDe(bhe(e),e.object));const r=e.props.dispose!==null&&n!==!1;for(let s=e.children.length-1;s>=0;s--){const a=e.children[s];hG(e,a,r)}e.children.length=0,delete e.object.__r3f,r&&e.type!=="primitive"&&e.object.type!=="Scene"&&Mhe(e.object),n===void 0&&nR(e)}function UDe(t,e){for(const n of[t,t.alternate])if(n!==null)if(typeof n.ref=="function"){n.refCleanup==null||n.refCleanup();const i=n.ref(e);typeof i=="function"&&(n.refCleanup=i)}else n.ref&&(n.ref.current=e)}const B2=[];function BDe(){for(const[n]of B2){const i=n.parent;if(i){n.props.attach?PU(i,n):Zh(n.object)&&Zh(i.object)&&i.object.remove(n.object);for(const r of n.children)r.props.attach?PU(n,r):Zh(r.object)&&Zh(n.object)&&n.object.remove(r.object)}n.isHidden&&Rhe(n),n.object.__r3f&&delete n.object.__r3f,n.type!=="primitive"&&Mhe(n.object)}for(const[n,i,r]of B2){n.props=i;const s=n.parent;if(s){var t,e;const a=WC[RF(n.type)];n.object=(t=n.props.object)!=null?t:new a(...(e=n.props.args)!=null?e:[]),n.object.__r3f=n,UDe(r,n.object),fb(n.object,n.props),n.props.attach?kU(s,n):Zh(n.object)&&Zh(s.object)&&s.object.add(n.object);for(const o of n.children)o.props.attach?kU(n,o):Zh(o.object)&&Zh(n.object)&&n.object.add(o.object);nR(n)}}B2.length=0}const nj=()=>{},HQ={};let bD=Che;const FDe=0,zDe=4,DU=NDe({isPrimaryRenderer:!1,warnsIfNotActing:!1,supportsMutation:!0,supportsPersistence:!1,supportsHydration:!1,createInstance:DDe,removeChild:hG,appendChild:tj,appendInitialChild:tj,insertBefore:jQ,appendChildToContainer(t,e){const n=t.getState().scene.__r3f;!e||!n||tj(n,e)},removeChildFromContainer(t,e){const n=t.getState().scene.__r3f;!e||!n||hG(n,e)},insertInContainerBefore(t,e,n){const i=t.getState().scene.__r3f;!e||!n||!i||jQ(i,e,n)},getRootHostContext:()=>HQ,getChildHostContext:()=>HQ,commitUpdate(t,e,n,i,r){var s,a,o;Ahe(e,i);let c=!1;if((t.type==="primitive"&&n.object!==i.object||((s=i.args)==null?void 0:s.length)!==((a=n.args)==null?void 0:a.length)||(o=i.args)!=null&&o.some((u,h)=>{var d;return u!==((d=n.args)==null?void 0:d[h])}))&&(c=!0),c)B2.push([t,{...i},r]);else{const u=wDe(t,i);Object.keys(u).length&&(Object.assign(t.props,u),fb(t.object,u))}(r.sibling===null||(r.flags&zDe)===FDe)&&BDe()},finalizeInitialChildren:()=>!1,commitMount(){},getPublicInstance:t=>t==null?void 0:t.object,prepareForCommit:()=>null,preparePortalMount:t=>IU(t.getState().scene,t,"",{}),resetAfterCommit:()=>{},shouldSetTextContent:()=>!1,clearContainer:()=>!1,hideInstance:LDe,unhideInstance:Rhe,createTextInstance:nj,hideTextInstance:nj,unhideTextInstance:nj,scheduleTimeout:typeof setTimeout=="function"?setTimeout:void 0,cancelTimeout:typeof clearTimeout=="function"?clearTimeout:void 0,noTimeout:-1,getInstanceFromNode:()=>null,beforeActiveInstanceBlur(){},afterActiveInstanceBlur(){},detachDeletedInstance(){},prepareScopeUpdate(){},getInstanceFromScope:()=>null,shouldAttemptEagerTransition:()=>!1,trackSchedulerEvent:()=>{},resolveEventType:()=>null,resolveEventTimeStamp:()=>-1.1,requestPostPaintCallback(){},maySuspendCommit:()=>!1,preloadInstance:()=>!0,startSuspendingCommit(){},suspendInstance(){},waitForCommitToBeReady:()=>null,NotPendingTransition:null,HostTransitionContext:De.createContext(null),setCurrentUpdatePriority(t){bD=t},getCurrentUpdatePriority(){return bD},resolveUpdatePriority(){var t;if(bD!==Che)return bD;switch(typeof window<"u"&&((t=window.event)==null?void 0:t.type)){case"click":case"contextmenu":case"dblclick":case"pointercancel":case"pointerdown":case"pointerup":return U2.DiscreteEventPriority;case"pointermove":case"pointerout":case"pointerover":case"pointerenter":case"pointerleave":case"wheel":return U2.ContinuousEventPriority;default:return U2.DefaultEventPriority}},resetFormInstance(){}}),QT=new Map,nw={objects:"shallow",strict:!1};function jDe(t,e){if(!e&&typeof HTMLCanvasElement<"u"&&t instanceof HTMLCanvasElement&&t.parentElement){const{width:n,height:i,top:r,left:s}=t.parentElement.getBoundingClientRect();return{width:n,height:i,top:r,left:s}}else if(!e&&typeof OffscreenCanvas<"u"&&t instanceof OffscreenCanvas)return{width:t.width,height:t.height,top:0,left:0};return{width:0,height:0,top:0,left:0,...e}}function HDe(t){const e=QT.get(t),n=e==null?void 0:e.fiber,i=e==null?void 0:e.store;e&&console.warn("R3F.createRoot should only be called once!");const r=typeof reportError=="function"?reportError:console.error,s=i||ODe(pG,GQ),a=n||DU.createContainer(s,U2.ConcurrentRoot,null,!1,null,"",r,r,r,null);e||QT.set(t,{fiber:a,store:s});let o,c,l=!1,u=null;return{async configure(h={}){let d;u=new Promise(ce=>d=ce);let{gl:f,size:p,scene:g,events:_,onCreated:v,shadows:b=!1,linear:S=!1,flat:x=!1,legacy:M=!1,orthographic:R=!1,frameloop:I="always",dpr:k=[1,2],performance:P,raycaster:U,camera:V,onPointerMissed:$}=h,q=s.getState(),Y=q.gl;if(!q.gl){const ce={canvas:t,powerPreference:"high-performance",antialias:!0,alpha:!0},Me=typeof f=="function"?await f(ce):f;zQ(Me)?Y=Me:Y=new Que({...ce,...f}),q.set({gl:Y})}let te=q.raycaster;te||q.set({raycaster:te=new SW});const{params:G,...J}=U||{};if(no.equ(J,te,nw)||fb(te,{...J}),no.equ(G,te.params,nw)||fb(te,{params:{...te.params,...G}}),!q.camera||q.camera===c&&!no.equ(c,V,nw)){c=V;const ce=V==null?void 0:V.isCamera,Me=ce?V:R?new VI(0,0,0,0,.1,1e3):new Hc(75,0,.1,1e3);ce||(Me.position.z=5,V&&(fb(Me,V),Me.manual||("aspect"in V||"left"in V||"right"in V||"bottom"in V||"top"in V)&&(Me.manual=!0,Me.updateProjectionMatrix())),!q.camera&&!(V!=null&&V.rotation)&&Me.lookAt(0,0,0)),q.set({camera:Me}),te.camera=Me}if(!q.scene){let ce;g!=null&&g.isScene?(ce=g,IU(ce,s,"",{})):(ce=new VC,IU(ce,s,"",{}),g&&fb(ce,g)),q.set({scene:ce})}_&&!q.events.handlers&&q.set({events:_(s)});const K=jDe(t,p);if(no.equ(K,q.size,nw)||q.setSize(K.width,K.height,K.top,K.left),k&&q.viewport.dpr!==She(k)&&q.setDpr(k),q.frameloop!==I&&q.setFrameloop(I),q.onPointerMissed||q.set({onPointerMissed:$}),P&&!no.equ(P,q.performance,nw)&&q.set(ce=>({performance:{...ce.performance,...P}})),!q.xr){var X;const ce=(Te,Re)=>{const ge=s.getState();ge.frameloop!=="never"&&GQ(Te,!0,ge,Re)},Me=()=>{const Te=s.getState();Te.gl.xr.enabled=Te.gl.xr.isPresenting,Te.gl.xr.setAnimationLoop(Te.gl.xr.isPresenting?ce:null),Te.gl.xr.isPresenting||pG(Te)},Fe={connect(){const Te=s.getState().gl;Te.xr.addEventListener("sessionstart",Me),Te.xr.addEventListener("sessionend",Me)},disconnect(){const Te=s.getState().gl;Te.xr.removeEventListener("sessionstart",Me),Te.xr.removeEventListener("sessionend",Me)}};typeof((X=Y.xr)==null?void 0:X.addEventListener)=="function"&&Fe.connect(),q.set({xr:Fe})}if(Y.shadowMap){const ce=Y.shadowMap.enabled,Me=Y.shadowMap.type;if(Y.shadowMap.enabled=!!b,no.boo(b))Y.shadowMap.type=ZM;else if(no.str(b)){var ae;const Fe={basic:tle,percentage:XB,soft:ZM,variance:lm};Y.shadowMap.type=(ae=Fe[b])!=null?ae:ZM}else no.obj(b)&&Object.assign(Y.shadowMap,b);(ce!==Y.shadowMap.enabled||Me!==Y.shadowMap.type)&&(Y.shadowMap.needsUpdate=!0)}return Br.enabled=!M,l||(Y.outputColorSpace=S?a0:ls,Y.toneMapping=x?Em:j7),q.legacy!==M&&q.set(()=>({legacy:M})),q.linear!==S&&q.set(()=>({linear:S})),q.flat!==x&&q.set(()=>({flat:x})),f&&!no.fun(f)&&!zQ(f)&&!no.equ(f,Y,nw)&&fb(Y,f),o=v,l=!0,d(),this},render(h){return!l&&!u&&this.configure(),u.then(()=>{DU.updateContainer(be.jsx(VDe,{store:s,children:h,onCreated:o,rootElement:t}),a,null,()=>{})}),s},unmount(){Ohe(t)}}}function VDe({store:t,children:e,onCreated:n,rootElement:i}){return GI(()=>{const r=t.getState();r.set(s=>({internal:{...s.internal,active:!0}})),n&&n(r),t.getState().events.connected||r.events.connect==null||r.events.connect(i)},[]),be.jsx(kW.Provider,{value:t,children:e})}function Ohe(t,e){const n=QT.get(t),i=n==null?void 0:n.fiber;if(i){const r=n==null?void 0:n.store.getState();r&&(r.internal.active=!1),DU.updateContainer(null,i,null,()=>{r&&setTimeout(()=>{try{var s,a,o,c;r.events.disconnect==null||r.events.disconnect(),(s=r.gl)==null||(a=s.renderLists)==null||a.dispose==null||a.dispose(),(o=r.gl)==null||o.forceContextLoss==null||o.forceContextLoss(),(c=r.gl)!=null&&c.xr&&r.xr.disconnect(),SDe(r.scene),QT.delete(t)}catch{}},500)})}}function GDe(t,e,n){return be.jsx(qDe,{children:t,container:e,state:n})}function qDe({state:t={},children:e,container:n}){const{events:i,size:r,...s}=t,a=PW(),[o]=De.useState(()=>new SW),[c]=De.useState(()=>new xt),l=IW((h,d)=>{let f;if(d.camera&&r){const p=d.camera;f=h.viewport.getCurrentViewport(p,new Oe,r),p!==h.camera&&xhe(p,r)}return{...h,...d,scene:n,raycaster:o,pointer:c,mouse:c,previousRoot:a,events:{...h.events,...d.events,...i},size:{...h.size,...r},viewport:{...h.viewport,...f},setEvents:p=>d.set(g=>({...g,events:{...g.events,...p}}))}}),u=De.useMemo(()=>{const h=dhe((f,p)=>({...s,set:f,get:p})),d=f=>h.setState(p=>l.current(f,p));return d(a.getState()),a.subscribe(d),h},[a,n]);return be.jsx(be.Fragment,{children:DU.createPortal(be.jsx(kW.Provider,{value:u,children:e}),u,null)})}function Nhe(t,e){const n={callback:t};return e.add(n),()=>void e.delete(n)}const Ihe=new Set,khe=new Set,$De=new Set,WDe=t=>Nhe(t,Ihe),YDe=t=>Nhe(t,khe);function ij(t,e){if(t.size)for(const{callback:n}of t.values())n(e)}function oO(t,e){switch(t){case"before":return ij(Ihe,e);case"after":return ij(khe,e);case"tail":return ij($De,e)}}let rj,sj;function dG(t,e,n){let i=e.clock.getDelta();e.frameloop==="never"&&typeof t=="number"&&(i=t-e.clock.elapsedTime,e.clock.oldTime=e.clock.elapsedTime,e.clock.elapsedTime=t),rj=e.internal.subscribers;for(let r=0;r<rj.length;r++)sj=rj[r],sj.ref.current(sj.store.getState(),i,n);return!e.internal.priority&&e.gl.render&&e.gl.render(e.scene,e.camera),e.internal.frames=Math.max(0,e.internal.frames-1),e.frameloop==="always"?1:e.internal.frames}let LU=!1,fG=!1,aj,VQ,iw;function Phe(t){VQ=requestAnimationFrame(Phe),LU=!0,aj=0,oO("before",t),fG=!0;for(const n of QT.values()){var e;iw=n.store.getState(),iw.internal.active&&(iw.frameloop==="always"||iw.internal.frames>0)&&!((e=iw.gl.xr)!=null&&e.isPresenting)&&(aj+=dG(t,iw))}if(fG=!1,oO("after",t),aj===0)return oO("tail",t),LU=!1,cancelAnimationFrame(VQ)}function pG(t,e=1){var n;if(!t)return QT.forEach(i=>pG(i.store.getState(),e));(n=t.gl.xr)!=null&&n.isPresenting||!t.internal.active||t.frameloop==="never"||(e>1?t.internal.frames=Math.min(60,t.internal.frames+e):fG?t.internal.frames=2:t.internal.frames=1,LU||(LU=!0,requestAnimationFrame(Phe)))}function GQ(t,e=!0,n,i){if(e&&oO("before",t),n)dG(t,n,i);else for(const r of QT.values())dG(t,r.store.getState());e&&oO("after",t)}const oj={onClick:["click",!1],onContextMenu:["contextmenu",!1],onDoubleClick:["dblclick",!1],onWheel:["wheel",!0],onPointerDown:["pointerdown",!0],onPointerUp:["pointerup",!0],onPointerLeave:["pointerleave",!0],onPointerMove:["pointermove",!0],onPointerCancel:["pointercancel",!0],onLostPointerCapture:["lostpointercapture",!0]};function Dhe(t){const{handlePointer:e}=MDe(t);return{priority:1,enabled:!0,compute(n,i,r){i.pointer.set(n.offsetX/i.size.width*2-1,-(n.offsetY/i.size.height)*2+1),i.raycaster.setFromCamera(i.pointer,i.camera)},connected:void 0,handlers:Object.keys(oj).reduce((n,i)=>({...n,[i]:e(i)}),{}),update:()=>{var n;const{events:i,internal:r}=t.getState();(n=r.lastEvent)!=null&&n.current&&i.handlers&&i.handlers.onPointerMove(r.lastEvent.current)},connect:n=>{const{set:i,events:r}=t.getState();if(r.disconnect==null||r.disconnect(),i(s=>({events:{...s.events,connected:n}})),r.handlers)for(const s in r.handlers){const a=r.handlers[s],[o,c]=oj[s];n.addEventListener(o,a,{passive:c})}},disconnect:()=>{const{set:n,events:i}=t.getState();if(i.connected){if(i.handlers)for(const r in i.handlers){const s=i.handlers[r],[a]=oj[r];i.connected.removeEventListener(a,s)}n(r=>({events:{...r.events,connected:void 0}}))}}}}function qQ(t,e){let n;return(...i)=>{window.clearTimeout(n),n=window.setTimeout(()=>t(...i),e)}}function KDe({debounce:t,scroll:e,polyfill:n,offsetSize:i}={debounce:0,scroll:!1,offsetSize:!1}){const r=n||(typeof window>"u"?class{}:window.ResizeObserver);if(!r)throw new Error("This browser does not support ResizeObserver out of the box. See: https://github.com/react-spring/react-use-measure/#resize-observer-polyfills");const[s,a]=De.useState({left:0,top:0,width:0,height:0,bottom:0,right:0,x:0,y:0}),o=De.useRef({element:null,scrollContainers:null,resizeObserver:null,lastBounds:s,orientationHandler:null}),c=t?typeof t=="number"?t:t.scroll:null,l=t?typeof t=="number"?t:t.resize:null,u=De.useRef(!1);De.useEffect(()=>(u.current=!0,()=>void(u.current=!1)));const[h,d,f]=De.useMemo(()=>{const v=()=>{if(!o.current.element)return;const{left:b,top:S,width:x,height:M,bottom:R,right:I,x:k,y:P}=o.current.element.getBoundingClientRect(),U={left:b,top:S,width:x,height:M,bottom:R,right:I,x:k,y:P};o.current.element instanceof HTMLElement&&i&&(U.height=o.current.element.offsetHeight,U.width=o.current.element.offsetWidth),Object.freeze(U),u.current&&!QDe(o.current.lastBounds,U)&&a(o.current.lastBounds=U)};return[v,l?qQ(v,l):v,c?qQ(v,c):v]},[a,i,c,l]);function p(){o.current.scrollContainers&&(o.current.scrollContainers.forEach(v=>v.removeEventListener("scroll",f,!0)),o.current.scrollContainers=null),o.current.resizeObserver&&(o.current.resizeObserver.disconnect(),o.current.resizeObserver=null),o.current.orientationHandler&&("orientation"in screen&&"removeEventListener"in screen.orientation?screen.orientation.removeEventListener("change",o.current.orientationHandler):"onorientationchange"in window&&window.removeEventListener("orientationchange",o.current.orientationHandler))}function g(){o.current.element&&(o.current.resizeObserver=new r(f),o.current.resizeObserver.observe(o.current.element),e&&o.current.scrollContainers&&o.current.scrollContainers.forEach(v=>v.addEventListener("scroll",f,{capture:!0,passive:!0})),o.current.orientationHandler=()=>{f()},"orientation"in screen&&"addEventListener"in screen.orientation?screen.orientation.addEventListener("change",o.current.orientationHandler):"onorientationchange"in window&&window.addEventListener("orientationchange",o.current.orientationHandler))}const _=v=>{!v||v===o.current.element||(p(),o.current.element=v,o.current.scrollContainers=Lhe(v),g())};return ZDe(f,!!e),XDe(d),De.useEffect(()=>{p(),g()},[e,f,d]),De.useEffect(()=>p,[]),[_,s,h]}function XDe(t){De.useEffect(()=>{const e=t;return window.addEventListener("resize",e),()=>void window.removeEventListener("resize",e)},[t])}function ZDe(t,e){De.useEffect(()=>{if(e){const n=t;return window.addEventListener("scroll",n,{capture:!0,passive:!0}),()=>void window.removeEventListener("scroll",n,!0)}},[t,e])}function Lhe(t){const e=[];if(!t||t===document.body)return e;const{overflow:n,overflowX:i,overflowY:r}=window.getComputedStyle(t);return[n,i,r].some(s=>s==="auto"||s==="scroll")&&e.push(t),[...e,...Lhe(t.parentElement)]}const JDe=["x","y","top","bottom","left","right","width","height"],QDe=(t,e)=>JDe.every(n=>t[n]===e[n]);function e2e({ref:t,children:e,fallback:n,resize:i,style:r,gl:s,events:a=Dhe,eventSource:o,eventPrefix:c,shadows:l,linear:u,flat:h,legacy:d,orthographic:f,frameloop:p,dpr:g,performance:_,raycaster:v,camera:b,scene:S,onPointerMissed:x,onCreated:M,...R}){De.useMemo(()=>DW(bPe),[]);const I=yDe(),[k,P]=KDe({scroll:!0,debounce:{scroll:50,resize:0},...i}),U=De.useRef(null),V=De.useRef(null);De.useImperativeHandle(t,()=>U.current);const $=IW(x),[q,Y]=De.useState(!1),[te,G]=De.useState(!1);if(q)throw q;if(te)throw te;const J=De.useRef(null);GI(()=>{const X=U.current;if(P.width>0&&P.height>0&&X){J.current||(J.current=HDe(X));async function ae(){await J.current.configure({gl:s,scene:S,events:a,shadows:l,linear:u,flat:h,legacy:d,orthographic:f,frameloop:p,dpr:g,performance:_,raycaster:v,camera:b,size:P,onPointerMissed:(...ce)=>$.current==null?void 0:$.current(...ce),onCreated:ce=>{ce.events.connect==null||ce.events.connect(o?vDe(o)?o.current:o:V.current),c&&ce.setEvents({compute:(Me,Fe)=>{const Te=Me[c+"X"],Re=Me[c+"Y"];Fe.pointer.set(Te/Fe.size.width*2-1,-(Re/Fe.size.height)*2+1),Fe.raycaster.setFromCamera(Fe.pointer,Fe.camera)}}),M==null||M(ce)}}),J.current.render(be.jsx(I,{children:be.jsx(EDe,{set:G,children:be.jsx(De.Suspense,{fallback:be.jsx(bDe,{set:Y}),children:e??null})})}))}ae()}}),De.useEffect(()=>{const X=U.current;if(X)return()=>Ohe(X)},[]);const K=o?"none":"auto";return be.jsx("div",{ref:V,style:{position:"relative",width:"100%",height:"100%",overflow:"hidden",pointerEvents:K,...r},...R,children:be.jsx("div",{ref:k,style:{width:"100%",height:"100%"},children:be.jsx("canvas",{ref:U,style:{display:"block"},children:n})})})}function t2e(t){return be.jsx(_he,{children:be.jsx(e2e,{...t})})}var UW={exports:{}};function Uhe(t,e=100,n={}){if(typeof t!="function")throw new TypeError(`Expected the first parameter to be a function, got \`${typeof t}\`.`);if(e<0)throw new RangeError("`wait` must not be negative.");const{immediate:i}=typeof n=="boolean"?{immediate:n}:n;let r,s,a,o,c;function l(){const d=r,f=s;return r=void 0,s=void 0,c=t.apply(d,f),c}function u(){const d=Date.now()-o;d<e&&d>=0?a=setTimeout(u,e-d):(a=void 0,i||(c=l()))}const h=function(...d){if(r&&this!==r&&Object.getPrototypeOf(this)===Object.getPrototypeOf(r))throw new Error("Debounced method called with different contexts of the same prototype.");r=this,s=d,o=Date.now();const f=i&&!a;return a||(a=setTimeout(u,e)),f&&(c=l()),c};return Object.defineProperty(h,"isPending",{get(){return a!==void 0}}),h.clear=()=>{a&&(clearTimeout(a),a=void 0)},h.flush=()=>{a&&h.trigger()},h.trigger=()=>{c=l(),h.clear()},h}UW.exports.debounce=Uhe;UW.exports=Uhe;var n2e=UW.exports;const i2e=il(n2e);var Bhe={exports:{}},MF={},Fhe={exports:{}},zhe={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(G,J){var K=G.length;G.push(J);e:for(;0<K;){var X=K-1>>>1,ae=G[X];if(0<r(ae,J))G[X]=J,G[K]=ae,K=X;else break e}}function n(G){return G.length===0?null:G[0]}function i(G){if(G.length===0)return null;var J=G[0],K=G.pop();if(K!==J){G[0]=K;e:for(var X=0,ae=G.length,ce=ae>>>1;X<ce;){var Me=2*(X+1)-1,Fe=G[Me],Te=Me+1,Re=G[Te];if(0>r(Fe,K))Te<ae&&0>r(Re,Fe)?(G[X]=Re,G[Te]=K,X=Te):(G[X]=Fe,G[Me]=K,X=Me);else if(Te<ae&&0>r(Re,K))G[X]=Re,G[Te]=K,X=Te;else break e}}return J}function r(G,J){var K=G.sortIndex-J.sortIndex;return K!==0?K:G.id-J.id}if(t.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var s=performance;t.unstable_now=function(){return s.now()}}else{var a=Date,o=a.now();t.unstable_now=function(){return a.now()-o}}var c=[],l=[],u=1,h=null,d=3,f=!1,p=!1,g=!1,_=!1,v=typeof setTimeout=="function"?setTimeout:null,b=typeof clearTimeout=="function"?clearTimeout:null,S=typeof setImmediate<"u"?setImmediate:null;function x(G){for(var J=n(l);J!==null;){if(J.callback===null)i(l);else if(J.startTime<=G)i(l),J.sortIndex=J.expirationTime,e(c,J);else break;J=n(l)}}function M(G){if(g=!1,x(G),!p)if(n(c)!==null)p=!0,R||(R=!0,$());else{var J=n(l);J!==null&&te(M,J.startTime-G)}}var R=!1,I=-1,k=5,P=-1;function U(){return _?!0:!(t.unstable_now()-P<k)}function V(){if(_=!1,R){var G=t.unstable_now();P=G;var J=!0;try{e:{p=!1,g&&(g=!1,b(I),I=-1),f=!0;var K=d;try{t:{for(x(G),h=n(c);h!==null&&!(h.expirationTime>G&&U());){var X=h.callback;if(typeof X=="function"){h.callback=null,d=h.priorityLevel;var ae=X(h.expirationTime<=G);if(G=t.unstable_now(),typeof ae=="function"){h.callback=ae,x(G),J=!0;break t}h===n(c)&&i(c),x(G)}else i(c);h=n(c)}if(h!==null)J=!0;else{var ce=n(l);ce!==null&&te(M,ce.startTime-G),J=!1}}break e}finally{h=null,d=K,f=!1}J=void 0}}finally{J?$():R=!1}}}var $;if(typeof S=="function")$=function(){S(V)};else if(typeof MessageChannel<"u"){var q=new MessageChannel,Y=q.port2;q.port1.onmessage=V,$=function(){Y.postMessage(null)}}else $=function(){v(V,0)};function te(G,J){I=v(function(){G(t.unstable_now())},J)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(G){G.callback=null},t.unstable_forceFrameRate=function(G){0>G||125<G?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):k=0<G?Math.floor(1e3/G):5},t.unstable_getCurrentPriorityLevel=function(){return d},t.unstable_next=function(G){switch(d){case 1:case 2:case 3:var J=3;break;default:J=d}var K=d;d=J;try{return G()}finally{d=K}},t.unstable_requestPaint=function(){_=!0},t.unstable_runWithPriority=function(G,J){switch(G){case 1:case 2:case 3:case 4:case 5:break;default:G=3}var K=d;d=G;try{return J()}finally{d=K}},t.unstable_scheduleCallback=function(G,J,K){var X=t.unstable_now();switch(typeof K=="object"&&K!==null?(K=K.delay,K=typeof K=="number"&&0<K?X+K:X):K=X,G){case 1:var ae=-1;break;case 2:ae=250;break;case 5:ae=1073741823;break;case 4:ae=1e4;break;default:ae=5e3}return ae=K+ae,G={id:u++,callback:J,priorityLevel:G,startTime:K,expirationTime:ae,sortIndex:-1},K>X?(G.sortIndex=K,e(l,G),n(c)===null&&G===n(l)&&(g?(b(I),I=-1):g=!0,te(M,K-X))):(G.sortIndex=ae,e(c,G),p||f||(p=!0,R||(R=!0,$()))),G},t.unstable_shouldYield=U,t.unstable_wrapCallback=function(G){var J=d;return function(){var K=d;d=J;try{return G.apply(this,arguments)}finally{d=K}}}})(zhe);Fhe.exports=zhe;var r2e=Fhe.exports,jhe={exports:{}},bh={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var s2e=De;function Hhe(t){var e="https://react.dev/errors/"+t;if(1<arguments.length){e+="?args[]="+encodeURIComponent(arguments[1]);for(var n=2;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n])}return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function Uy(){}var lh={d:{f:Uy,r:function(){throw Error(Hhe(522))},D:Uy,C:Uy,L:Uy,m:Uy,X:Uy,S:Uy,M:Uy},p:0,findDOMNode:null},a2e=Symbol.for("react.portal");function o2e(t,e,n){var i=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:a2e,key:i==null?null:""+i,children:t,containerInfo:e,implementation:n}}var cO=s2e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function OF(t,e){if(t==="font")return"";if(typeof e=="string")return e==="use-credentials"?e:""}bh.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=lh;bh.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)throw Error(Hhe(299));return o2e(t,e,null,n)};bh.flushSync=function(t){var e=cO.T,n=lh.p;try{if(cO.T=null,lh.p=2,t)return t()}finally{cO.T=e,lh.p=n,lh.d.f()}};bh.preconnect=function(t,e){typeof t=="string"&&(e?(e=e.crossOrigin,e=typeof e=="string"?e==="use-credentials"?e:"":void 0):e=null,lh.d.C(t,e))};bh.prefetchDNS=function(t){typeof t=="string"&&lh.d.D(t)};bh.preinit=function(t,e){if(typeof t=="string"&&e&&typeof e.as=="string"){var n=e.as,i=OF(n,e.crossOrigin),r=typeof e.integrity=="string"?e.integrity:void 0,s=typeof e.fetchPriority=="string"?e.fetchPriority:void 0;n==="style"?lh.d.S(t,typeof e.precedence=="string"?e.precedence:void 0,{crossOrigin:i,integrity:r,fetchPriority:s}):n==="script"&&lh.d.X(t,{crossOrigin:i,integrity:r,fetchPriority:s,nonce:typeof e.nonce=="string"?e.nonce:void 0})}};bh.preinitModule=function(t,e){if(typeof t=="string")if(typeof e=="object"&&e!==null){if(e.as==null||e.as==="script"){var n=OF(e.as,e.crossOrigin);lh.d.M(t,{crossOrigin:n,integrity:typeof e.integrity=="string"?e.integrity:void 0,nonce:typeof e.nonce=="string"?e.nonce:void 0})}}else e==null&&lh.d.M(t)};bh.preload=function(t,e){if(typeof t=="string"&&typeof e=="object"&&e!==null&&typeof e.as=="string"){var n=e.as,i=OF(n,e.crossOrigin);lh.d.L(t,n,{crossOrigin:i,integrity:typeof e.integrity=="string"?e.integrity:void 0,nonce:typeof e.nonce=="string"?e.nonce:void 0,type:typeof e.type=="string"?e.type:void 0,fetchPriority:typeof e.fetchPriority=="string"?e.fetchPriority:void 0,referrerPolicy:typeof e.referrerPolicy=="string"?e.referrerPolicy:void 0,imageSrcSet:typeof e.imageSrcSet=="string"?e.imageSrcSet:void 0,imageSizes:typeof e.imageSizes=="string"?e.imageSizes:void 0,media:typeof e.media=="string"?e.media:void 0})}};bh.preloadModule=function(t,e){if(typeof t=="string")if(e){var n=OF(e.as,e.crossOrigin);lh.d.m(t,{as:typeof e.as=="string"&&e.as!=="script"?e.as:void 0,crossOrigin:n,integrity:typeof e.integrity=="string"?e.integrity:void 0})}else lh.d.m(t)};bh.requestFormReset=function(t){lh.d.r(t)};bh.unstable_batchedUpdates=function(t,e){return t(e)};bh.useFormState=function(t,e,n){return cO.H.useFormState(t,e,n)};bh.useFormStatus=function(){return cO.H.useHostTransitionStatus()};bh.version="19.1.0";function Vhe(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(Vhe)}catch(t){console.error(t)}}Vhe(),jhe.exports=bh;var c2e=jhe.exports,Jc=r2e,Ghe=De,l2e=c2e;function Gt(t){var e="https://react.dev/errors/"+t;if(1<arguments.length){e+="?args[]="+encodeURIComponent(arguments[1]);for(var n=2;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n])}return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function qhe(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function qI(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function $he(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function $Q(t){if(qI(t)!==t)throw Error(Gt(188))}function u2e(t){var e=t.alternate;if(!e){if(e=qI(t),e===null)throw Error(Gt(188));return e!==t?null:t}for(var n=t,i=e;;){var r=n.return;if(r===null)break;var s=r.alternate;if(s===null){if(i=r.return,i!==null){n=i;continue}break}if(r.child===s.child){for(s=r.child;s;){if(s===n)return $Q(r),t;if(s===i)return $Q(r),e;s=s.sibling}throw Error(Gt(188))}if(n.return!==i.return)n=r,i=s;else{for(var a=!1,o=r.child;o;){if(o===n){a=!0,n=r,i=s;break}if(o===i){a=!0,i=r,n=s;break}o=o.sibling}if(!a){for(o=s.child;o;){if(o===n){a=!0,n=s,i=r;break}if(o===i){a=!0,i=s,n=r;break}o=o.sibling}if(!a)throw Error(Gt(189))}}if(n.alternate!==i)throw Error(Gt(190))}if(n.tag!==3)throw Error(Gt(188));return n.stateNode.current===n?t:e}function Whe(t){var e=t.tag;if(e===5||e===26||e===27||e===6)return t;for(t=t.child;t!==null;){if(e=Whe(t),e!==null)return e;t=t.sibling}return null}var Ma=Object.assign,h2e=Symbol.for("react.element"),ED=Symbol.for("react.transitional.element"),DM=Symbol.for("react.portal"),jw=Symbol.for("react.fragment"),Yhe=Symbol.for("react.strict_mode"),mG=Symbol.for("react.profiler"),d2e=Symbol.for("react.provider"),Khe=Symbol.for("react.consumer"),n_=Symbol.for("react.context"),BW=Symbol.for("react.forward_ref"),gG=Symbol.for("react.suspense"),vG=Symbol.for("react.suspense_list"),FW=Symbol.for("react.memo"),ib=Symbol.for("react.lazy"),_G=Symbol.for("react.activity"),f2e=Symbol.for("react.memo_cache_sentinel"),WQ=Symbol.iterator;function iM(t){return t===null||typeof t!="object"?null:(t=WQ&&t[WQ]||t["@@iterator"],typeof t=="function"?t:null)}var p2e=Symbol.for("react.client.reference");function yG(t){if(t==null)return null;if(typeof t=="function")return t.$$typeof===p2e?null:t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case jw:return"Fragment";case mG:return"Profiler";case Yhe:return"StrictMode";case gG:return"Suspense";case vG:return"SuspenseList";case _G:return"Activity"}if(typeof t=="object")switch(t.$$typeof){case DM:return"Portal";case n_:return(t.displayName||"Context")+".Provider";case Khe:return(t._context.displayName||"Context")+".Consumer";case BW:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case FW:return e=t.displayName||null,e!==null?e:yG(t.type)||"Memo";case ib:e=t._payload,t=t._init;try{return yG(t(e))}catch{}}return null}var LM=Array.isArray,Ui=Ghe.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Ts=l2e.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,OT={pending:!1,data:null,method:null,action:null},bG=[],Hw=-1;function v0(t){return{current:t}}function Cl(t){0>Hw||(t.current=bG[Hw],bG[Hw]=null,Hw--)}function Ha(t,e){Hw++,bG[Hw]=t.current,t.current=e}var Yg=v0(null),aN=v0(null),Nb=v0(null),UU=v0(null);function BU(t,e){switch(Ha(Nb,e),Ha(aN,t),Ha(Yg,null),e.nodeType){case 9:case 11:t=(t=e.documentElement)&&(t=t.namespaceURI)?Jee(t):0;break;default:if(t=e.tagName,e=e.namespaceURI)e=Jee(e),t=dpe(e,t);else switch(t){case"svg":t=1;break;case"math":t=2;break;default:t=0}}Cl(Yg),Ha(Yg,t)}function YC(){Cl(Yg),Cl(aN),Cl(Nb)}function EG(t){t.memoizedState!==null&&Ha(UU,t);var e=Yg.current,n=dpe(e,t.type);e!==n&&(Ha(aN,t),Ha(Yg,n))}function FU(t){aN.current===t&&(Cl(Yg),Cl(aN)),UU.current===t&&(Cl(UU),gN._currentValue=OT)}var SG=Object.prototype.hasOwnProperty,zW=Jc.unstable_scheduleCallback,cj=Jc.unstable_cancelCallback,m2e=Jc.unstable_shouldYield,g2e=Jc.unstable_requestPaint,Kg=Jc.unstable_now,v2e=Jc.unstable_getCurrentPriorityLevel,Xhe=Jc.unstable_ImmediatePriority,Zhe=Jc.unstable_UserBlockingPriority,zU=Jc.unstable_NormalPriority,_2e=Jc.unstable_LowPriority,Jhe=Jc.unstable_IdlePriority,y2e=Jc.log,b2e=Jc.unstable_setDisableYieldValue,$I=null,uf=null;function Sb(t){if(typeof y2e=="function"&&b2e(t),uf&&typeof uf.setStrictMode=="function")try{uf.setStrictMode($I,t)}catch{}}var hf=Math.clz32?Math.clz32:T2e,E2e=Math.log,S2e=Math.LN2;function T2e(t){return t>>>=0,t===0?32:31-(E2e(t)/S2e|0)|0}var SD=256,TD=4194304;function eT(t){var e=t&42;if(e!==0)return e;switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194048;case 4194304:case 8388608:case 16777216:case 33554432:return t&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return t}}function NF(t,e,n){var i=t.pendingLanes;if(i===0)return 0;var r=0,s=t.suspendedLanes,a=t.pingedLanes;t=t.warmLanes;var o=i&134217727;return o!==0?(i=o&~s,i!==0?r=eT(i):(a&=o,a!==0?r=eT(a):n||(n=o&~t,n!==0&&(r=eT(n))))):(o=i&~s,o!==0?r=eT(o):a!==0?r=eT(a):n||(n=i&~t,n!==0&&(r=eT(n)))),r===0?0:e!==0&&e!==r&&!(e&s)&&(s=r&-r,n=e&-e,s>=n||s===32&&(n&4194048)!==0)?e:r}function WI(t,e){return(t.pendingLanes&~(t.suspendedLanes&~t.pingedLanes)&e)===0}function x2e(t,e){switch(t){case 1:case 2:case 4:case 8:case 64:return e+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Qhe(){var t=SD;return SD<<=1,!(SD&4194048)&&(SD=256),t}function ede(){var t=TD;return TD<<=1,!(TD&62914560)&&(TD=4194304),t}function lj(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function YI(t,e){t.pendingLanes|=e,e!==268435456&&(t.suspendedLanes=0,t.pingedLanes=0,t.warmLanes=0)}function w2e(t,e,n,i,r,s){var a=t.pendingLanes;t.pendingLanes=n,t.suspendedLanes=0,t.pingedLanes=0,t.warmLanes=0,t.expiredLanes&=n,t.entangledLanes&=n,t.errorRecoveryDisabledLanes&=n,t.shellSuspendCounter=0;var o=t.entanglements,c=t.expirationTimes,l=t.hiddenUpdates;for(n=a&~n;0<n;){var u=31-hf(n),h=1<<u;o[u]=0,c[u]=-1;var d=l[u];if(d!==null)for(l[u]=null,u=0;u<d.length;u++){var f=d[u];f!==null&&(f.lane&=-536870913)}n&=~h}i!==0&&tde(t,i,0),s!==0&&r===0&&t.tag!==0&&(t.suspendedLanes|=s&~(a&~e))}function tde(t,e,n){t.pendingLanes|=e,t.suspendedLanes&=~e;var i=31-hf(e);t.entangledLanes|=e,t.entanglements[i]=t.entanglements[i]|1073741824|n&4194090}function nde(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var i=31-hf(n),r=1<<i;r&e|t[i]&e&&(t[i]|=e),n&=~r}}function jW(t){switch(t){case 2:t=1;break;case 8:t=4;break;case 32:t=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:t=128;break;case 268435456:t=134217728;break;default:t=0}return t}function HW(t){return t&=-t,2<t?8<t?t&134217727?32:268435456:8:2}function ide(){var t=Ts.p;return t!==0?t:(t=window.event,t===void 0?32:Spe(t.type))}function C2e(t,e){var n=Ts.p;try{return Ts.p=t,e()}finally{Ts.p=n}}var ME=Math.random().toString(36).slice(2),_u="__reactFiber$"+ME,fd="__reactProps$"+ME,iR="__reactContainer$"+ME,TG="__reactEvents$"+ME,A2e="__reactListeners$"+ME,R2e="__reactHandles$"+ME,YQ="__reactResources$"+ME,KI="__reactMarker$"+ME;function VW(t){delete t[_u],delete t[fd],delete t[TG],delete t[A2e],delete t[R2e]}function Vw(t){var e=t[_u];if(e)return e;for(var n=t.parentNode;n;){if(e=n[iR]||n[_u]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=tte(t);t!==null;){if(n=t[_u])return n;t=tte(t)}return e}t=n,n=t.parentNode}return null}function rR(t){if(t=t[_u]||t[iR]){var e=t.tag;if(e===5||e===6||e===13||e===26||e===27||e===3)return t}return null}function UM(t){var e=t.tag;if(e===5||e===26||e===27||e===6)return t.stateNode;throw Error(Gt(33))}function hC(t){var e=t[YQ];return e||(e=t[YQ]={hoistableStyles:new Map,hoistableScripts:new Map}),e}function Sl(t){t[KI]=!0}var rde=new Set,sde={};function U1(t,e){KC(t,e),KC(t+"Capture",e)}function KC(t,e){for(sde[t]=e,t=0;t<e.length;t++)rde.add(e[t])}var M2e=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),KQ={},XQ={};function O2e(t){return SG.call(XQ,t)?!0:SG.call(KQ,t)?!1:M2e.test(t)?XQ[t]=!0:(KQ[t]=!0,!1)}function F2(t,e,n){if(O2e(e))if(n===null)t.removeAttribute(e);else{switch(typeof n){case"undefined":case"function":case"symbol":t.removeAttribute(e);return;case"boolean":var i=e.toLowerCase().slice(0,5);if(i!=="data-"&&i!=="aria-"){t.removeAttribute(e);return}}t.setAttribute(e,""+n)}}function xD(t,e,n){if(n===null)t.removeAttribute(e);else{switch(typeof n){case"undefined":case"function":case"symbol":case"boolean":t.removeAttribute(e);return}t.setAttribute(e,""+n)}}function Ov(t,e,n,i){if(i===null)t.removeAttribute(n);else{switch(typeof i){case"undefined":case"function":case"symbol":case"boolean":t.removeAttribute(n);return}t.setAttributeNS(e,n,""+i)}}var uj,ZQ;function Cw(t){if(uj===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);uj=e&&e[1]||"",ZQ=-1<n.stack.indexOf(`
    at`)?" (<anonymous>)":-1<n.stack.indexOf("@")?"@unknown:0:0":""}return`
`+uj+t+ZQ}var hj=!1;function dj(t,e){if(!t||hj)return"";hj=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var i={DetermineComponentFrameRoot:function(){try{if(e){var h=function(){throw Error()};if(Object.defineProperty(h.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(h,[])}catch(f){var d=f}Reflect.construct(t,[],h)}else{try{h.call()}catch(f){d=f}t.call(h.prototype)}}else{try{throw Error()}catch(f){d=f}(h=t())&&typeof h.catch=="function"&&h.catch(function(){})}}catch(f){if(f&&d&&typeof f.stack=="string")return[f.stack,d.stack]}return[null,null]}};i.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var r=Object.getOwnPropertyDescriptor(i.DetermineComponentFrameRoot,"name");r&&r.configurable&&Object.defineProperty(i.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var s=i.DetermineComponentFrameRoot(),a=s[0],o=s[1];if(a&&o){var c=a.split(`
`),l=o.split(`
`);for(r=i=0;i<c.length&&!c[i].includes("DetermineComponentFrameRoot");)i++;for(;r<l.length&&!l[r].includes("DetermineComponentFrameRoot");)r++;if(i===c.length||r===l.length)for(i=c.length-1,r=l.length-1;1<=i&&0<=r&&c[i]!==l[r];)r--;for(;1<=i&&0<=r;i--,r--)if(c[i]!==l[r]){if(i!==1||r!==1)do if(i--,r--,0>r||c[i]!==l[r]){var u=`
`+c[i].replace(" at new "," at ");return t.displayName&&u.includes("<anonymous>")&&(u=u.replace("<anonymous>",t.displayName)),u}while(1<=i&&0<=r);break}}}finally{hj=!1,Error.prepareStackTrace=n}return(n=t?t.displayName||t.name:"")?Cw(n):""}function N2e(t){switch(t.tag){case 26:case 27:case 5:return Cw(t.type);case 16:return Cw("Lazy");case 13:return Cw("Suspense");case 19:return Cw("SuspenseList");case 0:case 15:return dj(t.type,!1);case 11:return dj(t.type.render,!1);case 1:return dj(t.type,!0);case 31:return Cw("Activity");default:return""}}function JQ(t){try{var e="";do e+=N2e(t),t=t.return;while(t);return e}catch(n){return`
Error generating stack: `+n.message+`
`+n.stack}}function Zf(t){switch(typeof t){case"bigint":case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function ade(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function I2e(t){var e=ade(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),i=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var r=n.get,s=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return r.call(this)},set:function(a){i=""+a,s.call(this,a)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return i},setValue:function(a){i=""+a},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function jU(t){t._valueTracker||(t._valueTracker=I2e(t))}function ode(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),i="";return t&&(i=ade(t)?t.checked?"true":"false":t.value),t=i,t!==n?(e.setValue(t),!0):!1}function HU(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}var k2e=/[\n"\\]/g;function np(t){return t.replace(k2e,function(e){return"\\"+e.charCodeAt(0).toString(16)+" "})}function xG(t,e,n,i,r,s,a,o){t.name="",a!=null&&typeof a!="function"&&typeof a!="symbol"&&typeof a!="boolean"?t.type=a:t.removeAttribute("type"),e!=null?a==="number"?(e===0&&t.value===""||t.value!=e)&&(t.value=""+Zf(e)):t.value!==""+Zf(e)&&(t.value=""+Zf(e)):a!=="submit"&&a!=="reset"||t.removeAttribute("value"),e!=null?wG(t,a,Zf(e)):n!=null?wG(t,a,Zf(n)):i!=null&&t.removeAttribute("value"),r==null&&s!=null&&(t.defaultChecked=!!s),r!=null&&(t.checked=r&&typeof r!="function"&&typeof r!="symbol"),o!=null&&typeof o!="function"&&typeof o!="symbol"&&typeof o!="boolean"?t.name=""+Zf(o):t.removeAttribute("name")}function cde(t,e,n,i,r,s,a,o){if(s!=null&&typeof s!="function"&&typeof s!="symbol"&&typeof s!="boolean"&&(t.type=s),e!=null||n!=null){if(!(s!=="submit"&&s!=="reset"||e!=null))return;n=n!=null?""+Zf(n):"",e=e!=null?""+Zf(e):n,o||e===t.value||(t.value=e),t.defaultValue=e}i=i??r,i=typeof i!="function"&&typeof i!="symbol"&&!!i,t.checked=o?t.checked:!!i,t.defaultChecked=!!i,a!=null&&typeof a!="function"&&typeof a!="symbol"&&typeof a!="boolean"&&(t.name=a)}function wG(t,e,n){e==="number"&&HU(t.ownerDocument)===t||t.defaultValue===""+n||(t.defaultValue=""+n)}function dC(t,e,n,i){if(t=t.options,e){e={};for(var r=0;r<n.length;r++)e["$"+n[r]]=!0;for(n=0;n<t.length;n++)r=e.hasOwnProperty("$"+t[n].value),t[n].selected!==r&&(t[n].selected=r),r&&i&&(t[n].defaultSelected=!0)}else{for(n=""+Zf(n),e=null,r=0;r<t.length;r++){if(t[r].value===n){t[r].selected=!0,i&&(t[r].defaultSelected=!0);return}e!==null||t[r].disabled||(e=t[r])}e!==null&&(e.selected=!0)}}function lde(t,e,n){if(e!=null&&(e=""+Zf(e),e!==t.value&&(t.value=e),n==null)){t.defaultValue!==e&&(t.defaultValue=e);return}t.defaultValue=n!=null?""+Zf(n):""}function ude(t,e,n,i){if(e==null){if(i!=null){if(n!=null)throw Error(Gt(92));if(LM(i)){if(1<i.length)throw Error(Gt(93));i=i[0]}n=i}n==null&&(n=""),e=n}n=Zf(e),t.defaultValue=n,i=t.textContent,i===n&&i!==""&&i!==null&&(t.value=i)}function XC(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var P2e=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function QQ(t,e,n){var i=e.indexOf("--")===0;n==null||typeof n=="boolean"||n===""?i?t.setProperty(e,""):e==="float"?t.cssFloat="":t[e]="":i?t.setProperty(e,n):typeof n!="number"||n===0||P2e.has(e)?e==="float"?t.cssFloat=n:t[e]=(""+n).trim():t[e]=n+"px"}function hde(t,e,n){if(e!=null&&typeof e!="object")throw Error(Gt(62));if(t=t.style,n!=null){for(var i in n)!n.hasOwnProperty(i)||e!=null&&e.hasOwnProperty(i)||(i.indexOf("--")===0?t.setProperty(i,""):i==="float"?t.cssFloat="":t[i]="");for(var r in e)i=e[r],e.hasOwnProperty(r)&&n[r]!==i&&QQ(t,r,i)}else for(var s in e)e.hasOwnProperty(s)&&QQ(t,s,e[s])}function GW(t){if(t.indexOf("-")===-1)return!1;switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var D2e=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),L2e=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function z2(t){return L2e.test(""+t)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":t}var CG=null;function qW(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var Gw=null,fC=null;function eee(t){var e=rR(t);if(e&&(t=e.stateNode)){var n=t[fd]||null;e:switch(t=e.stateNode,e.type){case"input":if(xG(t,n.value,n.defaultValue,n.defaultValue,n.checked,n.defaultChecked,n.type,n.name),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll('input[name="'+np(""+e)+'"][type="radio"]'),e=0;e<n.length;e++){var i=n[e];if(i!==t&&i.form===t.form){var r=i[fd]||null;if(!r)throw Error(Gt(90));xG(i,r.value,r.defaultValue,r.defaultValue,r.checked,r.defaultChecked,r.type,r.name)}}for(e=0;e<n.length;e++)i=n[e],i.form===t.form&&ode(i)}break e;case"textarea":lde(t,n.value,n.defaultValue);break e;case"select":e=n.value,e!=null&&dC(t,!!n.multiple,e,!1)}}}var fj=!1;function dde(t,e,n){if(fj)return t(e,n);fj=!0;try{var i=t(e);return i}finally{if(fj=!1,(Gw!==null||fC!==null)&&(jF(),Gw&&(e=Gw,t=fC,fC=Gw=null,eee(e),t)))for(e=0;e<t.length;e++)eee(t[e])}}function oN(t,e){var n=t.stateNode;if(n===null)return null;var i=n[fd]||null;if(i===null)return null;n=i[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(i=!i.disabled)||(t=t.type,i=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!i;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(Gt(231,e,typeof n));return n}var w_=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),AG=!1;if(w_)try{var rM={};Object.defineProperty(rM,"passive",{get:function(){AG=!0}}),window.addEventListener("test",rM,rM),window.removeEventListener("test",rM,rM)}catch{AG=!1}var Tb=null,$W=null,j2=null;function fde(){if(j2)return j2;var t,e=$W,n=e.length,i,r="value"in Tb?Tb.value:Tb.textContent,s=r.length;for(t=0;t<n&&e[t]===r[t];t++);var a=n-t;for(i=1;i<=a&&e[n-i]===r[s-i];i++);return j2=r.slice(t,1<i?1-i:void 0)}function H2(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function wD(){return!0}function tee(){return!1}function Sd(t){function e(n,i,r,s,a){this._reactName=n,this._targetInst=r,this.type=i,this.nativeEvent=s,this.target=a,this.currentTarget=null;for(var o in t)t.hasOwnProperty(o)&&(n=t[o],this[o]=n?n(s):s[o]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?wD:tee,this.isPropagationStopped=tee,this}return Ma(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=wD)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=wD)},persist:function(){},isPersistent:wD}),e}var B1={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},IF=Sd(B1),XI=Ma({},B1,{view:0,detail:0}),U2e=Sd(XI),pj,mj,sM,kF=Ma({},XI,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:WW,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==sM&&(sM&&t.type==="mousemove"?(pj=t.screenX-sM.screenX,mj=t.screenY-sM.screenY):mj=pj=0,sM=t),pj)},movementY:function(t){return"movementY"in t?t.movementY:mj}}),nee=Sd(kF),B2e=Ma({},kF,{dataTransfer:0}),F2e=Sd(B2e),z2e=Ma({},XI,{relatedTarget:0}),gj=Sd(z2e),j2e=Ma({},B1,{animationName:0,elapsedTime:0,pseudoElement:0}),H2e=Sd(j2e),V2e=Ma({},B1,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),G2e=Sd(V2e),q2e=Ma({},B1,{data:0}),iee=Sd(q2e),$2e={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},W2e={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Y2e={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function K2e(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=Y2e[t])?!!e[t]:!1}function WW(){return K2e}var X2e=Ma({},XI,{key:function(t){if(t.key){var e=$2e[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=H2(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?W2e[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:WW,charCode:function(t){return t.type==="keypress"?H2(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?H2(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),Z2e=Sd(X2e),J2e=Ma({},kF,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),ree=Sd(J2e),Q2e=Ma({},XI,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:WW}),eLe=Sd(Q2e),tLe=Ma({},B1,{propertyName:0,elapsedTime:0,pseudoElement:0}),nLe=Sd(tLe),iLe=Ma({},kF,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),rLe=Sd(iLe),sLe=Ma({},B1,{newState:0,oldState:0}),aLe=Sd(sLe),oLe=[9,13,27,32],YW=w_&&"CompositionEvent"in window,lO=null;w_&&"documentMode"in document&&(lO=document.documentMode);var cLe=w_&&"TextEvent"in window&&!lO,pde=w_&&(!YW||lO&&8<lO&&11>=lO),see=" ",aee=!1;function mde(t,e){switch(t){case"keyup":return oLe.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function gde(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var qw=!1;function lLe(t,e){switch(t){case"compositionend":return gde(e);case"keypress":return e.which!==32?null:(aee=!0,see);case"textInput":return t=e.data,t===see&&aee?null:t;default:return null}}function uLe(t,e){if(qw)return t==="compositionend"||!YW&&mde(t,e)?(t=fde(),j2=$W=Tb=null,qw=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return pde&&e.locale!=="ko"?null:e.data;default:return null}}var hLe={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function oee(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!hLe[t.type]:e==="textarea"}function vde(t,e,n,i){Gw?fC?fC.push(i):fC=[i]:Gw=i,e=a3(e,"onChange"),0<e.length&&(n=new IF("onChange","change",null,n,i),t.push({event:n,listeners:e}))}var uO=null,cN=null;function dLe(t){lpe(t,0)}function PF(t){var e=UM(t);if(ode(e))return t}function cee(t,e){if(t==="change")return e}var _de=!1;if(w_){var vj;if(w_){var _j="oninput"in document;if(!_j){var lee=document.createElement("div");lee.setAttribute("oninput","return;"),_j=typeof lee.oninput=="function"}vj=_j}else vj=!1;_de=vj&&(!document.documentMode||9<document.documentMode)}function uee(){uO&&(uO.detachEvent("onpropertychange",yde),cN=uO=null)}function yde(t){if(t.propertyName==="value"&&PF(cN)){var e=[];vde(e,cN,t,qW(t)),dde(dLe,e)}}function fLe(t,e,n){t==="focusin"?(uee(),uO=e,cN=n,uO.attachEvent("onpropertychange",yde)):t==="focusout"&&uee()}function pLe(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return PF(cN)}function mLe(t,e){if(t==="click")return PF(e)}function gLe(t,e){if(t==="input"||t==="change")return PF(e)}function vLe(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var gf=typeof Object.is=="function"?Object.is:vLe;function lN(t,e){if(gf(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),i=Object.keys(e);if(n.length!==i.length)return!1;for(i=0;i<n.length;i++){var r=n[i];if(!SG.call(e,r)||!gf(t[r],e[r]))return!1}return!0}function hee(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function dee(t,e){var n=hee(t);t=0;for(var i;n;){if(n.nodeType===3){if(i=t+n.textContent.length,t<=e&&i>=e)return{node:n,offset:e-t};t=i}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=hee(n)}}function bde(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?bde(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function Ede(t){t=t!=null&&t.ownerDocument!=null&&t.ownerDocument.defaultView!=null?t.ownerDocument.defaultView:window;for(var e=HU(t.document);e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=HU(t.document)}return e}function KW(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}var _Le=w_&&"documentMode"in document&&11>=document.documentMode,$w=null,RG=null,hO=null,MG=!1;function fee(t,e,n){var i=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;MG||$w==null||$w!==HU(i)||(i=$w,"selectionStart"in i&&KW(i)?i={start:i.selectionStart,end:i.selectionEnd}:(i=(i.ownerDocument&&i.ownerDocument.defaultView||window).getSelection(),i={anchorNode:i.anchorNode,anchorOffset:i.anchorOffset,focusNode:i.focusNode,focusOffset:i.focusOffset}),hO&&lN(hO,i)||(hO=i,i=a3(RG,"onSelect"),0<i.length&&(e=new IF("onSelect","select",null,e,n),t.push({event:e,listeners:i}),e.target=$w)))}function GS(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var Ww={animationend:GS("Animation","AnimationEnd"),animationiteration:GS("Animation","AnimationIteration"),animationstart:GS("Animation","AnimationStart"),transitionrun:GS("Transition","TransitionRun"),transitionstart:GS("Transition","TransitionStart"),transitioncancel:GS("Transition","TransitionCancel"),transitionend:GS("Transition","TransitionEnd")},yj={},Sde={};w_&&(Sde=document.createElement("div").style,"AnimationEvent"in window||(delete Ww.animationend.animation,delete Ww.animationiteration.animation,delete Ww.animationstart.animation),"TransitionEvent"in window||delete Ww.transitionend.transition);function F1(t){if(yj[t])return yj[t];if(!Ww[t])return t;var e=Ww[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in Sde)return yj[t]=e[n];return t}var Tde=F1("animationend"),xde=F1("animationiteration"),wde=F1("animationstart"),yLe=F1("transitionrun"),bLe=F1("transitionstart"),ELe=F1("transitioncancel"),Cde=F1("transitionend"),Ade=new Map,OG="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");OG.push("scrollEnd");function Dm(t,e){Ade.set(t,e),U1(e,[t])}var pee=new WeakMap;function ip(t,e){if(typeof t=="object"&&t!==null){var n=pee.get(t);return n!==void 0?n:(e={value:t,source:e,stack:JQ(e)},pee.set(t,e),e)}return{value:t,source:e,stack:JQ(e)}}var Yf=[],Yw=0,XW=0;function DF(){for(var t=Yw,e=XW=Yw=0;e<t;){var n=Yf[e];Yf[e++]=null;var i=Yf[e];Yf[e++]=null;var r=Yf[e];Yf[e++]=null;var s=Yf[e];if(Yf[e++]=null,i!==null&&r!==null){var a=i.pending;a===null?r.next=r:(r.next=a.next,a.next=r),i.pending=r}s!==0&&Rde(n,r,s)}}function LF(t,e,n,i){Yf[Yw++]=t,Yf[Yw++]=e,Yf[Yw++]=n,Yf[Yw++]=i,XW|=i,t.lanes|=i,t=t.alternate,t!==null&&(t.lanes|=i)}function ZW(t,e,n,i){return LF(t,e,n,i),VU(t)}function sR(t,e){return LF(t,null,null,e),VU(t)}function Rde(t,e,n){t.lanes|=n;var i=t.alternate;i!==null&&(i.lanes|=n);for(var r=!1,s=t.return;s!==null;)s.childLanes|=n,i=s.alternate,i!==null&&(i.childLanes|=n),s.tag===22&&(t=s.stateNode,t===null||t._visibility&1||(r=!0)),t=s,s=s.return;return t.tag===3?(s=t.stateNode,r&&e!==null&&(r=31-hf(n),t=s.hiddenUpdates,i=t[r],i===null?t[r]=[e]:i.push(e),e.lane=n|536870912),s):null}function VU(t){if(50<EO)throw EO=0,ZG=null,Error(Gt(185));for(var e=t.return;e!==null;)t=e,e=t.return;return t.tag===3?t.stateNode:null}var Kw={};function SLe(t,e,n,i){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=i,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function nf(t,e,n,i){return new SLe(t,e,n,i)}function JW(t){return t=t.prototype,!(!t||!t.isReactComponent)}function d_(t,e){var n=t.alternate;return n===null?(n=nf(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&65011712,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n.refCleanup=t.refCleanup,n}function Mde(t,e){t.flags&=65011714;var n=t.alternate;return n===null?(t.childLanes=0,t.lanes=e,t.child=null,t.subtreeFlags=0,t.memoizedProps=null,t.memoizedState=null,t.updateQueue=null,t.dependencies=null,t.stateNode=null):(t.childLanes=n.childLanes,t.lanes=n.lanes,t.child=n.child,t.subtreeFlags=0,t.deletions=null,t.memoizedProps=n.memoizedProps,t.memoizedState=n.memoizedState,t.updateQueue=n.updateQueue,t.type=n.type,e=n.dependencies,t.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),t}function V2(t,e,n,i,r,s){var a=0;if(i=t,typeof t=="function")JW(t)&&(a=1);else if(typeof t=="string")a=xUe(t,n,Yg.current)?26:t==="html"||t==="head"||t==="body"?27:5;else e:switch(t){case _G:return t=nf(31,n,e,r),t.elementType=_G,t.lanes=s,t;case jw:return NT(n.children,r,s,e);case Yhe:a=8,r|=24;break;case mG:return t=nf(12,n,e,r|2),t.elementType=mG,t.lanes=s,t;case gG:return t=nf(13,n,e,r),t.elementType=gG,t.lanes=s,t;case vG:return t=nf(19,n,e,r),t.elementType=vG,t.lanes=s,t;default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case d2e:case n_:a=10;break e;case Khe:a=9;break e;case BW:a=11;break e;case FW:a=14;break e;case ib:a=16,i=null;break e}a=29,n=Error(Gt(130,t===null?"null":typeof t,"")),i=null}return e=nf(a,n,e,r),e.elementType=t,e.type=i,e.lanes=s,e}function NT(t,e,n,i){return t=nf(7,t,i,e),t.lanes=n,t}function bj(t,e,n){return t=nf(6,t,null,e),t.lanes=n,t}function Ej(t,e,n){return e=nf(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}var Xw=[],Zw=0,GU=null,qU=0,Jf=[],Qf=0,IT=null,i_=1,r_="";function tT(t,e){Xw[Zw++]=qU,Xw[Zw++]=GU,GU=t,qU=e}function Ode(t,e,n){Jf[Qf++]=i_,Jf[Qf++]=r_,Jf[Qf++]=IT,IT=t;var i=i_;t=r_;var r=32-hf(i)-1;i&=~(1<<r),n+=1;var s=32-hf(e)+r;if(30<s){var a=r-r%5;s=(i&(1<<a)-1).toString(32),i>>=a,r-=a,i_=1<<32-hf(e)+r|n<<r|i,r_=s+t}else i_=1<<s|n<<r|i,r_=t}function QW(t){t.return!==null&&(tT(t,1),Ode(t,1,0))}function e9(t){for(;t===GU;)GU=Xw[--Zw],Xw[Zw]=null,qU=Xw[--Zw],Xw[Zw]=null;for(;t===IT;)IT=Jf[--Qf],Jf[Qf]=null,r_=Jf[--Qf],Jf[Qf]=null,i_=Jf[--Qf],Jf[Qf]=null}var ch=null,Ao=null,Es=!1,kT=null,Lg=!1,NG=Error(Gt(519));function e1(t){var e=Error(Gt(418,""));throw uN(ip(e,t)),NG}function mee(t){var e=t.stateNode,n=t.type,i=t.memoizedProps;switch(e[_u]=t,e[fd]=i,n){case"dialog":Ar("cancel",e),Ar("close",e);break;case"iframe":case"object":case"embed":Ar("load",e);break;case"video":case"audio":for(n=0;n<fN.length;n++)Ar(fN[n],e);break;case"source":Ar("error",e);break;case"img":case"image":case"link":Ar("error",e),Ar("load",e);break;case"details":Ar("toggle",e);break;case"input":Ar("invalid",e),cde(e,i.value,i.defaultValue,i.checked,i.defaultChecked,i.type,i.name,!0),jU(e);break;case"select":Ar("invalid",e);break;case"textarea":Ar("invalid",e),ude(e,i.value,i.defaultValue,i.children),jU(e)}n=i.children,typeof n!="string"&&typeof n!="number"&&typeof n!="bigint"||e.textContent===""+n||i.suppressHydrationWarning===!0||hpe(e.textContent,n)?(i.popover!=null&&(Ar("beforetoggle",e),Ar("toggle",e)),i.onScroll!=null&&Ar("scroll",e),i.onScrollEnd!=null&&Ar("scrollend",e),i.onClick!=null&&(e.onclick=GF),e=!0):e=!1,e||e1(t)}function gee(t){for(ch=t.return;ch;)switch(ch.tag){case 5:case 13:Lg=!1;return;case 27:case 3:Lg=!0;return;default:ch=ch.return}}function aM(t){if(t!==ch)return!1;if(!Es)return gee(t),Es=!0,!1;var e=t.tag,n;if((n=e!==3&&e!==27)&&((n=e===5)&&(n=t.type,n=!(n!=="form"&&n!=="button")||iq(t.type,t.memoizedProps)),n=!n),n&&Ao&&e1(t),gee(t),e===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(Gt(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8)if(n=t.data,n==="/$"){if(e===0){Ao=Tm(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++;t=t.nextSibling}Ao=null}}else e===27?(e=Ao,OE(t.type)?(t=aq,aq=null,Ao=t):Ao=e):Ao=ch?Tm(t.stateNode.nextSibling):null;return!0}function ZI(){Ao=ch=null,Es=!1}function vee(){var t=kT;return t!==null&&(Kh===null?Kh=t:Kh.push.apply(Kh,t),kT=null),t}function uN(t){kT===null?kT=[t]:kT.push(t)}var IG=v0(null),z1=null,s_=null;function pb(t,e,n){Ha(IG,e._currentValue),e._currentValue=n}function f_(t){t._currentValue=IG.current,Cl(IG)}function kG(t,e,n){for(;t!==null;){var i=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,i!==null&&(i.childLanes|=e)):i!==null&&(i.childLanes&e)!==e&&(i.childLanes|=e),t===n)break;t=t.return}}function PG(t,e,n,i){var r=t.child;for(r!==null&&(r.return=t);r!==null;){var s=r.dependencies;if(s!==null){var a=r.child;s=s.firstContext;e:for(;s!==null;){var o=s;s=r;for(var c=0;c<e.length;c++)if(o.context===e[c]){s.lanes|=n,o=s.alternate,o!==null&&(o.lanes|=n),kG(s.return,n,t),i||(a=null);break e}s=o.next}}else if(r.tag===18){if(a=r.return,a===null)throw Error(Gt(341));a.lanes|=n,s=a.alternate,s!==null&&(s.lanes|=n),kG(a,n,t),a=null}else a=r.child;if(a!==null)a.return=r;else for(a=r;a!==null;){if(a===t){a=null;break}if(r=a.sibling,r!==null){r.return=a.return,a=r;break}a=a.return}r=a}}function JI(t,e,n,i){t=null;for(var r=e,s=!1;r!==null;){if(!s){if(r.flags&524288)s=!0;else if(r.flags&262144)break}if(r.tag===10){var a=r.alternate;if(a===null)throw Error(Gt(387));if(a=a.memoizedProps,a!==null){var o=r.type;gf(r.pendingProps.value,a.value)||(t!==null?t.push(o):t=[o])}}else if(r===UU.current){if(a=r.alternate,a===null)throw Error(Gt(387));a.memoizedState.memoizedState!==r.memoizedState.memoizedState&&(t!==null?t.push(gN):t=[gN])}r=r.return}t!==null&&PG(e,t,n,i),e.flags|=262144}function $U(t){for(t=t.firstContext;t!==null;){if(!gf(t.context._currentValue,t.memoizedValue))return!0;t=t.next}return!1}function t1(t){z1=t,s_=null,t=t.dependencies,t!==null&&(t.firstContext=null)}function yu(t){return Nde(z1,t)}function CD(t,e){return z1===null&&t1(t),Nde(t,e)}function Nde(t,e){var n=e._currentValue;if(e={context:e,memoizedValue:n,next:null},s_===null){if(t===null)throw Error(Gt(308));s_=e,t.dependencies={lanes:0,firstContext:e},t.flags|=524288}else s_=s_.next=e;return n}var TLe=typeof AbortController<"u"?AbortController:function(){var t=[],e=this.signal={aborted:!1,addEventListener:function(n,i){t.push(i)}};this.abort=function(){e.aborted=!0,t.forEach(function(n){return n()})}},xLe=Jc.unstable_scheduleCallback,wLe=Jc.unstable_NormalPriority,zc={$$typeof:n_,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function t9(){return{controller:new TLe,data:new Map,refCount:0}}function QI(t){t.refCount--,t.refCount===0&&xLe(wLe,function(){t.controller.abort()})}var dO=null,DG=0,ZC=0,pC=null;function CLe(t,e){if(dO===null){var n=dO=[];DG=0,ZC=x9(),pC={status:"pending",value:void 0,then:function(i){n.push(i)}}}return DG++,e.then(_ee,_ee),e}function _ee(){if(--DG===0&&dO!==null){pC!==null&&(pC.status="fulfilled");var t=dO;dO=null,ZC=0,pC=null;for(var e=0;e<t.length;e++)(0,t[e])()}}function ALe(t,e){var n=[],i={status:"pending",value:null,reason:null,then:function(r){n.push(r)}};return t.then(function(){i.status="fulfilled",i.value=e;for(var r=0;r<n.length;r++)(0,n[r])(e)},function(r){for(i.status="rejected",i.reason=r,r=0;r<n.length;r++)(0,n[r])(void 0)}),i}var yee=Ui.S;Ui.S=function(t,e){typeof e=="object"&&e!==null&&typeof e.then=="function"&&CLe(t,e),yee!==null&&yee(t,e)};var PT=v0(null);function n9(){var t=PT.current;return t!==null?t:da.pooledCache}function G2(t,e){e===null?Ha(PT,PT.current):Ha(PT,e.pool)}function Ide(){var t=n9();return t===null?null:{parent:zc._currentValue,pool:t}}var ek=Error(Gt(460)),kde=Error(Gt(474)),UF=Error(Gt(542)),LG={then:function(){}};function bee(t){return t=t.status,t==="fulfilled"||t==="rejected"}function AD(){}function Pde(t,e,n){switch(n=t[n],n===void 0?t.push(e):n!==e&&(e.then(AD,AD),e=n),e.status){case"fulfilled":return e.value;case"rejected":throw t=e.reason,See(t),t;default:if(typeof e.status=="string")e.then(AD,AD);else{if(t=da,t!==null&&100<t.shellSuspendCounter)throw Error(Gt(482));t=e,t.status="pending",t.then(function(i){if(e.status==="pending"){var r=e;r.status="fulfilled",r.value=i}},function(i){if(e.status==="pending"){var r=e;r.status="rejected",r.reason=i}})}switch(e.status){case"fulfilled":return e.value;case"rejected":throw t=e.reason,See(t),t}throw fO=e,ek}}var fO=null;function Eee(){if(fO===null)throw Error(Gt(459));var t=fO;return fO=null,t}function See(t){if(t===ek||t===UF)throw Error(Gt(483))}var rb=!1;function i9(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function UG(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,callbacks:null})}function Ib(t){return{lane:t,tag:0,payload:null,callback:null,next:null}}function kb(t,e,n){var i=t.updateQueue;if(i===null)return null;if(i=i.shared,Ps&2){var r=i.pending;return r===null?e.next=e:(e.next=r.next,r.next=e),i.pending=e,e=VU(t),Rde(t,null,n),e}return LF(t,i,e,n),VU(t)}function pO(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194048)!==0)){var i=e.lanes;i&=t.pendingLanes,n|=i,e.lanes=n,nde(t,n)}}function Sj(t,e){var n=t.updateQueue,i=t.alternate;if(i!==null&&(i=i.updateQueue,n===i)){var r=null,s=null;if(n=n.firstBaseUpdate,n!==null){do{var a={lane:n.lane,tag:n.tag,payload:n.payload,callback:null,next:null};s===null?r=s=a:s=s.next=a,n=n.next}while(n!==null);s===null?r=s=e:s=s.next=e}else r=s=e;n={baseState:i.baseState,firstBaseUpdate:r,lastBaseUpdate:s,shared:i.shared,callbacks:i.callbacks},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}var BG=!1;function mO(){if(BG){var t=pC;if(t!==null)throw t}}function gO(t,e,n,i){BG=!1;var r=t.updateQueue;rb=!1;var s=r.firstBaseUpdate,a=r.lastBaseUpdate,o=r.shared.pending;if(o!==null){r.shared.pending=null;var c=o,l=c.next;c.next=null,a===null?s=l:a.next=l,a=c;var u=t.alternate;u!==null&&(u=u.updateQueue,o=u.lastBaseUpdate,o!==a&&(o===null?u.firstBaseUpdate=l:o.next=l,u.lastBaseUpdate=c))}if(s!==null){var h=r.baseState;a=0,u=l=c=null,o=s;do{var d=o.lane&-536870913,f=d!==o.lane;if(f?($r&d)===d:(i&d)===d){d!==0&&d===ZC&&(BG=!0),u!==null&&(u=u.next={lane:0,tag:o.tag,payload:o.payload,callback:null,next:null});e:{var p=t,g=o;d=e;var _=n;switch(g.tag){case 1:if(p=g.payload,typeof p=="function"){h=p.call(_,h,d);break e}h=p;break e;case 3:p.flags=p.flags&-65537|128;case 0:if(p=g.payload,d=typeof p=="function"?p.call(_,h,d):p,d==null)break e;h=Ma({},h,d);break e;case 2:rb=!0}}d=o.callback,d!==null&&(t.flags|=64,f&&(t.flags|=8192),f=r.callbacks,f===null?r.callbacks=[d]:f.push(d))}else f={lane:d,tag:o.tag,payload:o.payload,callback:o.callback,next:null},u===null?(l=u=f,c=h):u=u.next=f,a|=d;if(o=o.next,o===null){if(o=r.shared.pending,o===null)break;f=o,o=f.next,f.next=null,r.lastBaseUpdate=f,r.shared.pending=null}}while(!0);u===null&&(c=h),r.baseState=c,r.firstBaseUpdate=l,r.lastBaseUpdate=u,s===null&&(r.shared.lanes=0),rE|=a,t.lanes=a,t.memoizedState=h}}function Dde(t,e){if(typeof t!="function")throw Error(Gt(191,t));t.call(e)}function Lde(t,e){var n=t.callbacks;if(n!==null)for(t.callbacks=null,t=0;t<n.length;t++)Dde(n[t],e)}var JC=v0(null),WU=v0(0);function Tee(t,e){t=R_,Ha(WU,t),Ha(JC,e),R_=t|e.baseLanes}function FG(){Ha(WU,R_),Ha(JC,JC.current)}function r9(){R_=WU.current,Cl(JC),Cl(WU)}var nE=0,yr=null,Gs=null,vc=null,YU=!1,mC=!1,n1=!1,KU=0,hN=0,gC=null,RLe=0;function Ho(){throw Error(Gt(321))}function s9(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!gf(t[n],e[n]))return!1;return!0}function a9(t,e,n,i,r,s){return nE=s,yr=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,Ui.H=t===null||t.memoizedState===null?ffe:pfe,n1=!1,s=n(i,r),n1=!1,mC&&(s=Bde(e,n,i,r)),Ude(t),s}function Ude(t){Ui.H=XU;var e=Gs!==null&&Gs.next!==null;if(nE=0,vc=Gs=yr=null,YU=!1,hN=0,gC=null,e)throw Error(Gt(300));t===null||xl||(t=t.dependencies,t!==null&&$U(t)&&(xl=!0))}function Bde(t,e,n,i){yr=t;var r=0;do{if(mC&&(gC=null),hN=0,mC=!1,25<=r)throw Error(Gt(301));if(r+=1,vc=Gs=null,t.updateQueue!=null){var s=t.updateQueue;s.lastEffect=null,s.events=null,s.stores=null,s.memoCache!=null&&(s.memoCache.index=0)}Ui.H=DLe,s=e(n,i)}while(mC);return s}function MLe(){var t=Ui.H,e=t.useState()[0];return e=typeof e.then=="function"?tk(e):e,t=t.useState()[0],(Gs!==null?Gs.memoizedState:null)!==t&&(yr.flags|=1024),e}function o9(){var t=KU!==0;return KU=0,t}function c9(t,e,n){e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~n}function l9(t){if(YU){for(t=t.memoizedState;t!==null;){var e=t.queue;e!==null&&(e.pending=null),t=t.next}YU=!1}nE=0,vc=Gs=yr=null,mC=!1,hN=KU=0,gC=null}function $h(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return vc===null?yr.memoizedState=vc=t:vc=vc.next=t,vc}function Ec(){if(Gs===null){var t=yr.alternate;t=t!==null?t.memoizedState:null}else t=Gs.next;var e=vc===null?yr.memoizedState:vc.next;if(e!==null)vc=e,Gs=t;else{if(t===null)throw yr.alternate===null?Error(Gt(467)):Error(Gt(310));Gs=t,t={memoizedState:Gs.memoizedState,baseState:Gs.baseState,baseQueue:Gs.baseQueue,queue:Gs.queue,next:null},vc===null?yr.memoizedState=vc=t:vc=vc.next=t}return vc}function u9(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function tk(t){var e=hN;return hN+=1,gC===null&&(gC=[]),t=Pde(gC,t,e),e=yr,(vc===null?e.memoizedState:vc.next)===null&&(e=e.alternate,Ui.H=e===null||e.memoizedState===null?ffe:pfe),t}function BF(t){if(t!==null&&typeof t=="object"){if(typeof t.then=="function")return tk(t);if(t.$$typeof===n_)return yu(t)}throw Error(Gt(438,String(t)))}function h9(t){var e=null,n=yr.updateQueue;if(n!==null&&(e=n.memoCache),e==null){var i=yr.alternate;i!==null&&(i=i.updateQueue,i!==null&&(i=i.memoCache,i!=null&&(e={data:i.data.map(function(r){return r.slice()}),index:0})))}if(e==null&&(e={data:[],index:0}),n===null&&(n=u9(),yr.updateQueue=n),n.memoCache=e,n=e.data[e.index],n===void 0)for(n=e.data[e.index]=Array(t),i=0;i<t;i++)n[i]=f2e;return e.index++,n}function C_(t,e){return typeof e=="function"?e(t):e}function q2(t){var e=Ec();return d9(e,Gs,t)}function d9(t,e,n){var i=t.queue;if(i===null)throw Error(Gt(311));i.lastRenderedReducer=n;var r=t.baseQueue,s=i.pending;if(s!==null){if(r!==null){var a=r.next;r.next=s.next,s.next=a}e.baseQueue=r=s,i.pending=null}if(s=t.baseState,r===null)t.memoizedState=s;else{e=r.next;var o=a=null,c=null,l=e,u=!1;do{var h=l.lane&-536870913;if(h!==l.lane?($r&h)===h:(nE&h)===h){var d=l.revertLane;if(d===0)c!==null&&(c=c.next={lane:0,revertLane:0,action:l.action,hasEagerState:l.hasEagerState,eagerState:l.eagerState,next:null}),h===ZC&&(u=!0);else if((nE&d)===d){l=l.next,d===ZC&&(u=!0);continue}else h={lane:0,revertLane:l.revertLane,action:l.action,hasEagerState:l.hasEagerState,eagerState:l.eagerState,next:null},c===null?(o=c=h,a=s):c=c.next=h,yr.lanes|=d,rE|=d;h=l.action,n1&&n(s,h),s=l.hasEagerState?l.eagerState:n(s,h)}else d={lane:h,revertLane:l.revertLane,action:l.action,hasEagerState:l.hasEagerState,eagerState:l.eagerState,next:null},c===null?(o=c=d,a=s):c=c.next=d,yr.lanes|=h,rE|=h;l=l.next}while(l!==null&&l!==e);if(c===null?a=s:c.next=o,!gf(s,t.memoizedState)&&(xl=!0,u&&(n=pC,n!==null)))throw n;t.memoizedState=s,t.baseState=a,t.baseQueue=c,i.lastRenderedState=s}return r===null&&(i.lanes=0),[t.memoizedState,i.dispatch]}function Tj(t){var e=Ec(),n=e.queue;if(n===null)throw Error(Gt(311));n.lastRenderedReducer=t;var i=n.dispatch,r=n.pending,s=e.memoizedState;if(r!==null){n.pending=null;var a=r=r.next;do s=t(s,a.action),a=a.next;while(a!==r);gf(s,e.memoizedState)||(xl=!0),e.memoizedState=s,e.baseQueue===null&&(e.baseState=s),n.lastRenderedState=s}return[s,i]}function Fde(t,e,n){var i=yr,r=Ec(),s=Es;if(s){if(n===void 0)throw Error(Gt(407));n=n()}else n=e();var a=!gf((Gs||r).memoizedState,n);a&&(r.memoizedState=n,xl=!0),r=r.queue;var o=Hde.bind(null,i,r,t);if(nk(2048,8,o,[t]),r.getSnapshot!==e||a||vc!==null&&vc.memoizedState.tag&1){if(i.flags|=2048,QC(9,FF(),jde.bind(null,i,r,n,e),null),da===null)throw Error(Gt(349));s||nE&124||zde(i,e,n)}return n}function zde(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=yr.updateQueue,e===null?(e=u9(),yr.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function jde(t,e,n,i){e.value=n,e.getSnapshot=i,Vde(e)&&Gde(t)}function Hde(t,e,n){return n(function(){Vde(e)&&Gde(t)})}function Vde(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!gf(t,n)}catch{return!0}}function Gde(t){var e=sR(t,2);e!==null&&ff(e,t,2)}function zG(t){var e=$h();if(typeof t=="function"){var n=t;if(t=n(),n1){Sb(!0);try{n()}finally{Sb(!1)}}}return e.memoizedState=e.baseState=t,e.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:C_,lastRenderedState:t},e}function qde(t,e,n,i){return t.baseState=n,d9(t,Gs,typeof i=="function"?i:C_)}function OLe(t,e,n,i,r){if(zF(t))throw Error(Gt(485));if(t=e.action,t!==null){var s={payload:r,action:t,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(a){s.listeners.push(a)}};Ui.T!==null?n(!0):s.isTransition=!1,i(s),n=e.pending,n===null?(s.next=e.pending=s,$de(e,s)):(s.next=n.next,e.pending=n.next=s)}}function $de(t,e){var n=e.action,i=e.payload,r=t.state;if(e.isTransition){var s=Ui.T,a={};Ui.T=a;try{var o=n(r,i),c=Ui.S;c!==null&&c(a,o),xee(t,e,o)}catch(l){jG(t,e,l)}finally{Ui.T=s}}else try{s=n(r,i),xee(t,e,s)}catch(l){jG(t,e,l)}}function xee(t,e,n){n!==null&&typeof n=="object"&&typeof n.then=="function"?n.then(function(i){wee(t,e,i)},function(i){return jG(t,e,i)}):wee(t,e,n)}function wee(t,e,n){e.status="fulfilled",e.value=n,Wde(e),t.state=n,e=t.pending,e!==null&&(n=e.next,n===e?t.pending=null:(n=n.next,e.next=n,$de(t,n)))}function jG(t,e,n){var i=t.pending;if(t.pending=null,i!==null){i=i.next;do e.status="rejected",e.reason=n,Wde(e),e=e.next;while(e!==i)}t.action=null}function Wde(t){t=t.listeners;for(var e=0;e<t.length;e++)(0,t[e])()}function Yde(t,e){return e}function Cee(t,e){if(Es){var n=da.formState;if(n!==null){e:{var i=yr;if(Es){if(Ao){t:{for(var r=Ao,s=Lg;r.nodeType!==8;){if(!s){r=null;break t}if(r=Tm(r.nextSibling),r===null){r=null;break t}}s=r.data,r=s==="F!"||s==="F"?r:null}if(r){Ao=Tm(r.nextSibling),i=r.data==="F!";break e}}e1(i)}i=!1}i&&(e=n[0])}}return n=$h(),n.memoizedState=n.baseState=e,i={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Yde,lastRenderedState:e},n.queue=i,n=ufe.bind(null,yr,i),i.dispatch=n,i=zG(!1),s=g9.bind(null,yr,!1,i.queue),i=$h(),r={state:e,dispatch:null,action:t,pending:null},i.queue=r,n=OLe.bind(null,yr,r,s,n),r.dispatch=n,i.memoizedState=t,[e,n,!1]}function Aee(t){var e=Ec();return Kde(e,Gs,t)}function Kde(t,e,n){if(e=d9(t,e,Yde)[0],t=q2(C_)[0],typeof e=="object"&&e!==null&&typeof e.then=="function")try{var i=tk(e)}catch(a){throw a===ek?UF:a}else i=e;e=Ec();var r=e.queue,s=r.dispatch;return n!==e.memoizedState&&(yr.flags|=2048,QC(9,FF(),NLe.bind(null,r,n),null)),[i,s,t]}function NLe(t,e){t.action=e}function Ree(t){var e=Ec(),n=Gs;if(n!==null)return Kde(e,n,t);Ec(),e=e.memoizedState,n=Ec();var i=n.queue.dispatch;return n.memoizedState=t,[e,i,!1]}function QC(t,e,n,i){return t={tag:t,create:n,deps:i,inst:e,next:null},e=yr.updateQueue,e===null&&(e=u9(),yr.updateQueue=e),n=e.lastEffect,n===null?e.lastEffect=t.next=t:(i=n.next,n.next=t,t.next=i,e.lastEffect=t),t}function FF(){return{destroy:void 0,resource:void 0}}function Xde(){return Ec().memoizedState}function $2(t,e,n,i){var r=$h();i=i===void 0?null:i,yr.flags|=t,r.memoizedState=QC(1|e,FF(),n,i)}function nk(t,e,n,i){var r=Ec();i=i===void 0?null:i;var s=r.memoizedState.inst;Gs!==null&&i!==null&&s9(i,Gs.memoizedState.deps)?r.memoizedState=QC(e,s,n,i):(yr.flags|=t,r.memoizedState=QC(1|e,s,n,i))}function Mee(t,e){$2(8390656,8,t,e)}function Zde(t,e){nk(2048,8,t,e)}function Jde(t,e){return nk(4,2,t,e)}function Qde(t,e){return nk(4,4,t,e)}function efe(t,e){if(typeof e=="function"){t=t();var n=e(t);return function(){typeof n=="function"?n():e(null)}}if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function tfe(t,e,n){n=n!=null?n.concat([t]):null,nk(4,4,efe.bind(null,e,t),n)}function f9(){}function nfe(t,e){var n=Ec();e=e===void 0?null:e;var i=n.memoizedState;return e!==null&&s9(e,i[1])?i[0]:(n.memoizedState=[t,e],t)}function ife(t,e){var n=Ec();e=e===void 0?null:e;var i=n.memoizedState;if(e!==null&&s9(e,i[1]))return i[0];if(i=t(),n1){Sb(!0);try{t()}finally{Sb(!1)}}return n.memoizedState=[i,e],i}function p9(t,e,n){return n===void 0||nE&1073741824?t.memoizedState=e:(t.memoizedState=n,t=Wfe(),yr.lanes|=t,rE|=t,n)}function rfe(t,e,n,i){return gf(n,e)?n:JC.current!==null?(t=p9(t,n,i),gf(t,e)||(xl=!0),t):nE&42?(t=Wfe(),yr.lanes|=t,rE|=t,e):(xl=!0,t.memoizedState=n)}function sfe(t,e,n,i,r){var s=Ts.p;Ts.p=s!==0&&8>s?s:8;var a=Ui.T,o={};Ui.T=o,g9(t,!1,e,n);try{var c=r(),l=Ui.S;if(l!==null&&l(o,c),c!==null&&typeof c=="object"&&typeof c.then=="function"){var u=ALe(c,i);vO(t,e,u,df(t))}else vO(t,e,i,df(t))}catch(h){vO(t,e,{then:function(){},status:"rejected",reason:h},df())}finally{Ts.p=s,Ui.T=a}}function ILe(){}function HG(t,e,n,i){if(t.tag!==5)throw Error(Gt(476));var r=afe(t).queue;sfe(t,r,e,OT,n===null?ILe:function(){return ofe(t),n(i)})}function afe(t){var e=t.memoizedState;if(e!==null)return e;e={memoizedState:OT,baseState:OT,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:C_,lastRenderedState:OT},next:null};var n={};return e.next={memoizedState:n,baseState:n,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:C_,lastRenderedState:n},next:null},t.memoizedState=e,t=t.alternate,t!==null&&(t.memoizedState=e),e}function ofe(t){var e=afe(t).next.queue;vO(t,e,{},df())}function m9(){return yu(gN)}function cfe(){return Ec().memoizedState}function lfe(){return Ec().memoizedState}function kLe(t){for(var e=t.return;e!==null;){switch(e.tag){case 24:case 3:var n=df();t=Ib(n);var i=kb(e,t,n);i!==null&&(ff(i,e,n),pO(i,e,n)),e={cache:t9()},t.payload=e;return}e=e.return}}function PLe(t,e,n){var i=df();n={lane:i,revertLane:0,action:n,hasEagerState:!1,eagerState:null,next:null},zF(t)?hfe(e,n):(n=ZW(t,e,n,i),n!==null&&(ff(n,t,i),dfe(n,e,i)))}function ufe(t,e,n){var i=df();vO(t,e,n,i)}function vO(t,e,n,i){var r={lane:i,revertLane:0,action:n,hasEagerState:!1,eagerState:null,next:null};if(zF(t))hfe(e,r);else{var s=t.alternate;if(t.lanes===0&&(s===null||s.lanes===0)&&(s=e.lastRenderedReducer,s!==null))try{var a=e.lastRenderedState,o=s(a,n);if(r.hasEagerState=!0,r.eagerState=o,gf(o,a))return LF(t,e,r,0),da===null&&DF(),!1}catch{}finally{}if(n=ZW(t,e,r,i),n!==null)return ff(n,t,i),dfe(n,e,i),!0}return!1}function g9(t,e,n,i){if(i={lane:2,revertLane:x9(),action:i,hasEagerState:!1,eagerState:null,next:null},zF(t)){if(e)throw Error(Gt(479))}else e=ZW(t,n,i,2),e!==null&&ff(e,t,2)}function zF(t){var e=t.alternate;return t===yr||e!==null&&e===yr}function hfe(t,e){mC=YU=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function dfe(t,e,n){if(n&4194048){var i=e.lanes;i&=t.pendingLanes,n|=i,e.lanes=n,nde(t,n)}}var XU={readContext:yu,use:BF,useCallback:Ho,useContext:Ho,useEffect:Ho,useImperativeHandle:Ho,useLayoutEffect:Ho,useInsertionEffect:Ho,useMemo:Ho,useReducer:Ho,useRef:Ho,useState:Ho,useDebugValue:Ho,useDeferredValue:Ho,useTransition:Ho,useSyncExternalStore:Ho,useId:Ho,useHostTransitionStatus:Ho,useFormState:Ho,useActionState:Ho,useOptimistic:Ho,useMemoCache:Ho,useCacheRefresh:Ho},ffe={readContext:yu,use:BF,useCallback:function(t,e){return $h().memoizedState=[t,e===void 0?null:e],t},useContext:yu,useEffect:Mee,useImperativeHandle:function(t,e,n){n=n!=null?n.concat([t]):null,$2(4194308,4,efe.bind(null,e,t),n)},useLayoutEffect:function(t,e){return $2(4194308,4,t,e)},useInsertionEffect:function(t,e){$2(4,2,t,e)},useMemo:function(t,e){var n=$h();e=e===void 0?null:e;var i=t();if(n1){Sb(!0);try{t()}finally{Sb(!1)}}return n.memoizedState=[i,e],i},useReducer:function(t,e,n){var i=$h();if(n!==void 0){var r=n(e);if(n1){Sb(!0);try{n(e)}finally{Sb(!1)}}}else r=e;return i.memoizedState=i.baseState=r,t={pending:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:r},i.queue=t,t=t.dispatch=PLe.bind(null,yr,t),[i.memoizedState,t]},useRef:function(t){var e=$h();return t={current:t},e.memoizedState=t},useState:function(t){t=zG(t);var e=t.queue,n=ufe.bind(null,yr,e);return e.dispatch=n,[t.memoizedState,n]},useDebugValue:f9,useDeferredValue:function(t,e){var n=$h();return p9(n,t,e)},useTransition:function(){var t=zG(!1);return t=sfe.bind(null,yr,t.queue,!0,!1),$h().memoizedState=t,[!1,t]},useSyncExternalStore:function(t,e,n){var i=yr,r=$h();if(Es){if(n===void 0)throw Error(Gt(407));n=n()}else{if(n=e(),da===null)throw Error(Gt(349));$r&124||zde(i,e,n)}r.memoizedState=n;var s={value:n,getSnapshot:e};return r.queue=s,Mee(Hde.bind(null,i,s,t),[t]),i.flags|=2048,QC(9,FF(),jde.bind(null,i,s,n,e),null),n},useId:function(){var t=$h(),e=da.identifierPrefix;if(Es){var n=r_,i=i_;n=(i&~(1<<32-hf(i)-1)).toString(32)+n,e=""+e+"R"+n,n=KU++,0<n&&(e+="H"+n.toString(32)),e+=""}else n=RLe++,e=""+e+"r"+n.toString(32)+"";return t.memoizedState=e},useHostTransitionStatus:m9,useFormState:Cee,useActionState:Cee,useOptimistic:function(t){var e=$h();e.memoizedState=e.baseState=t;var n={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return e.queue=n,e=g9.bind(null,yr,!0,n),n.dispatch=e,[t,e]},useMemoCache:h9,useCacheRefresh:function(){return $h().memoizedState=kLe.bind(null,yr)}},pfe={readContext:yu,use:BF,useCallback:nfe,useContext:yu,useEffect:Zde,useImperativeHandle:tfe,useInsertionEffect:Jde,useLayoutEffect:Qde,useMemo:ife,useReducer:q2,useRef:Xde,useState:function(){return q2(C_)},useDebugValue:f9,useDeferredValue:function(t,e){var n=Ec();return rfe(n,Gs.memoizedState,t,e)},useTransition:function(){var t=q2(C_)[0],e=Ec().memoizedState;return[typeof t=="boolean"?t:tk(t),e]},useSyncExternalStore:Fde,useId:cfe,useHostTransitionStatus:m9,useFormState:Aee,useActionState:Aee,useOptimistic:function(t,e){var n=Ec();return qde(n,Gs,t,e)},useMemoCache:h9,useCacheRefresh:lfe},DLe={readContext:yu,use:BF,useCallback:nfe,useContext:yu,useEffect:Zde,useImperativeHandle:tfe,useInsertionEffect:Jde,useLayoutEffect:Qde,useMemo:ife,useReducer:Tj,useRef:Xde,useState:function(){return Tj(C_)},useDebugValue:f9,useDeferredValue:function(t,e){var n=Ec();return Gs===null?p9(n,t,e):rfe(n,Gs.memoizedState,t,e)},useTransition:function(){var t=Tj(C_)[0],e=Ec().memoizedState;return[typeof t=="boolean"?t:tk(t),e]},useSyncExternalStore:Fde,useId:cfe,useHostTransitionStatus:m9,useFormState:Ree,useActionState:Ree,useOptimistic:function(t,e){var n=Ec();return Gs!==null?qde(n,Gs,t,e):(n.baseState=t,[t,n.queue.dispatch])},useMemoCache:h9,useCacheRefresh:lfe},vC=null,dN=0;function RD(t){var e=dN;return dN+=1,vC===null&&(vC=[]),Pde(vC,t,e)}function oM(t,e){e=e.props.ref,t.ref=e!==void 0?e:null}function MD(t,e){throw e.$$typeof===h2e?Error(Gt(525)):(t=Object.prototype.toString.call(e),Error(Gt(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)))}function Oee(t){var e=t._init;return e(t._payload)}function mfe(t){function e(v,b){if(t){var S=v.deletions;S===null?(v.deletions=[b],v.flags|=16):S.push(b)}}function n(v,b){if(!t)return null;for(;b!==null;)e(v,b),b=b.sibling;return null}function i(v){for(var b=new Map;v!==null;)v.key!==null?b.set(v.key,v):b.set(v.index,v),v=v.sibling;return b}function r(v,b){return v=d_(v,b),v.index=0,v.sibling=null,v}function s(v,b,S){return v.index=S,t?(S=v.alternate,S!==null?(S=S.index,S<b?(v.flags|=67108866,b):S):(v.flags|=67108866,b)):(v.flags|=1048576,b)}function a(v){return t&&v.alternate===null&&(v.flags|=67108866),v}function o(v,b,S,x){return b===null||b.tag!==6?(b=bj(S,v.mode,x),b.return=v,b):(b=r(b,S),b.return=v,b)}function c(v,b,S,x){var M=S.type;return M===jw?u(v,b,S.props.children,x,S.key):b!==null&&(b.elementType===M||typeof M=="object"&&M!==null&&M.$$typeof===ib&&Oee(M)===b.type)?(b=r(b,S.props),oM(b,S),b.return=v,b):(b=V2(S.type,S.key,S.props,null,v.mode,x),oM(b,S),b.return=v,b)}function l(v,b,S,x){return b===null||b.tag!==4||b.stateNode.containerInfo!==S.containerInfo||b.stateNode.implementation!==S.implementation?(b=Ej(S,v.mode,x),b.return=v,b):(b=r(b,S.children||[]),b.return=v,b)}function u(v,b,S,x,M){return b===null||b.tag!==7?(b=NT(S,v.mode,x,M),b.return=v,b):(b=r(b,S),b.return=v,b)}function h(v,b,S){if(typeof b=="string"&&b!==""||typeof b=="number"||typeof b=="bigint")return b=bj(""+b,v.mode,S),b.return=v,b;if(typeof b=="object"&&b!==null){switch(b.$$typeof){case ED:return S=V2(b.type,b.key,b.props,null,v.mode,S),oM(S,b),S.return=v,S;case DM:return b=Ej(b,v.mode,S),b.return=v,b;case ib:var x=b._init;return b=x(b._payload),h(v,b,S)}if(LM(b)||iM(b))return b=NT(b,v.mode,S,null),b.return=v,b;if(typeof b.then=="function")return h(v,RD(b),S);if(b.$$typeof===n_)return h(v,CD(v,b),S);MD(v,b)}return null}function d(v,b,S,x){var M=b!==null?b.key:null;if(typeof S=="string"&&S!==""||typeof S=="number"||typeof S=="bigint")return M!==null?null:o(v,b,""+S,x);if(typeof S=="object"&&S!==null){switch(S.$$typeof){case ED:return S.key===M?c(v,b,S,x):null;case DM:return S.key===M?l(v,b,S,x):null;case ib:return M=S._init,S=M(S._payload),d(v,b,S,x)}if(LM(S)||iM(S))return M!==null?null:u(v,b,S,x,null);if(typeof S.then=="function")return d(v,b,RD(S),x);if(S.$$typeof===n_)return d(v,b,CD(v,S),x);MD(v,S)}return null}function f(v,b,S,x,M){if(typeof x=="string"&&x!==""||typeof x=="number"||typeof x=="bigint")return v=v.get(S)||null,o(b,v,""+x,M);if(typeof x=="object"&&x!==null){switch(x.$$typeof){case ED:return v=v.get(x.key===null?S:x.key)||null,c(b,v,x,M);case DM:return v=v.get(x.key===null?S:x.key)||null,l(b,v,x,M);case ib:var R=x._init;return x=R(x._payload),f(v,b,S,x,M)}if(LM(x)||iM(x))return v=v.get(S)||null,u(b,v,x,M,null);if(typeof x.then=="function")return f(v,b,S,RD(x),M);if(x.$$typeof===n_)return f(v,b,S,CD(b,x),M);MD(b,x)}return null}function p(v,b,S,x){for(var M=null,R=null,I=b,k=b=0,P=null;I!==null&&k<S.length;k++){I.index>k?(P=I,I=null):P=I.sibling;var U=d(v,I,S[k],x);if(U===null){I===null&&(I=P);break}t&&I&&U.alternate===null&&e(v,I),b=s(U,b,k),R===null?M=U:R.sibling=U,R=U,I=P}if(k===S.length)return n(v,I),Es&&tT(v,k),M;if(I===null){for(;k<S.length;k++)I=h(v,S[k],x),I!==null&&(b=s(I,b,k),R===null?M=I:R.sibling=I,R=I);return Es&&tT(v,k),M}for(I=i(I);k<S.length;k++)P=f(I,v,k,S[k],x),P!==null&&(t&&P.alternate!==null&&I.delete(P.key===null?k:P.key),b=s(P,b,k),R===null?M=P:R.sibling=P,R=P);return t&&I.forEach(function(V){return e(v,V)}),Es&&tT(v,k),M}function g(v,b,S,x){if(S==null)throw Error(Gt(151));for(var M=null,R=null,I=b,k=b=0,P=null,U=S.next();I!==null&&!U.done;k++,U=S.next()){I.index>k?(P=I,I=null):P=I.sibling;var V=d(v,I,U.value,x);if(V===null){I===null&&(I=P);break}t&&I&&V.alternate===null&&e(v,I),b=s(V,b,k),R===null?M=V:R.sibling=V,R=V,I=P}if(U.done)return n(v,I),Es&&tT(v,k),M;if(I===null){for(;!U.done;k++,U=S.next())U=h(v,U.value,x),U!==null&&(b=s(U,b,k),R===null?M=U:R.sibling=U,R=U);return Es&&tT(v,k),M}for(I=i(I);!U.done;k++,U=S.next())U=f(I,v,k,U.value,x),U!==null&&(t&&U.alternate!==null&&I.delete(U.key===null?k:U.key),b=s(U,b,k),R===null?M=U:R.sibling=U,R=U);return t&&I.forEach(function($){return e(v,$)}),Es&&tT(v,k),M}function _(v,b,S,x){if(typeof S=="object"&&S!==null&&S.type===jw&&S.key===null&&(S=S.props.children),typeof S=="object"&&S!==null){switch(S.$$typeof){case ED:e:{for(var M=S.key;b!==null;){if(b.key===M){if(M=S.type,M===jw){if(b.tag===7){n(v,b.sibling),x=r(b,S.props.children),x.return=v,v=x;break e}}else if(b.elementType===M||typeof M=="object"&&M!==null&&M.$$typeof===ib&&Oee(M)===b.type){n(v,b.sibling),x=r(b,S.props),oM(x,S),x.return=v,v=x;break e}n(v,b);break}else e(v,b);b=b.sibling}S.type===jw?(x=NT(S.props.children,v.mode,x,S.key),x.return=v,v=x):(x=V2(S.type,S.key,S.props,null,v.mode,x),oM(x,S),x.return=v,v=x)}return a(v);case DM:e:{for(M=S.key;b!==null;){if(b.key===M)if(b.tag===4&&b.stateNode.containerInfo===S.containerInfo&&b.stateNode.implementation===S.implementation){n(v,b.sibling),x=r(b,S.children||[]),x.return=v,v=x;break e}else{n(v,b);break}else e(v,b);b=b.sibling}x=Ej(S,v.mode,x),x.return=v,v=x}return a(v);case ib:return M=S._init,S=M(S._payload),_(v,b,S,x)}if(LM(S))return p(v,b,S,x);if(iM(S)){if(M=iM(S),typeof M!="function")throw Error(Gt(150));return S=M.call(S),g(v,b,S,x)}if(typeof S.then=="function")return _(v,b,RD(S),x);if(S.$$typeof===n_)return _(v,b,CD(v,S),x);MD(v,S)}return typeof S=="string"&&S!==""||typeof S=="number"||typeof S=="bigint"?(S=""+S,b!==null&&b.tag===6?(n(v,b.sibling),x=r(b,S),x.return=v,v=x):(n(v,b),x=bj(S,v.mode,x),x.return=v,v=x),a(v)):n(v,b)}return function(v,b,S,x){try{dN=0;var M=_(v,b,S,x);return vC=null,M}catch(I){if(I===ek||I===UF)throw I;var R=nf(29,I,null,v.mode);return R.lanes=x,R.return=v,R}finally{}}}var eA=mfe(!0),gfe=mfe(!1),Ep=v0(null),Xg=null;function mb(t){var e=t.alternate;Ha(Gc,Gc.current&1),Ha(Ep,t),Xg===null&&(e===null||JC.current!==null||e.memoizedState!==null)&&(Xg=t)}function vfe(t){if(t.tag===22){if(Ha(Gc,Gc.current),Ha(Ep,t),Xg===null){var e=t.alternate;e!==null&&e.memoizedState!==null&&(Xg=t)}}else gb()}function gb(){Ha(Gc,Gc.current),Ha(Ep,Ep.current)}function a_(t){Cl(Ep),Xg===t&&(Xg=null),Cl(Gc)}var Gc=v0(0);function ZU(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||sq(n)))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}function xj(t,e,n,i){e=t.memoizedState,n=n(i,e),n=n==null?e:Ma({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var VG={enqueueSetState:function(t,e,n){t=t._reactInternals;var i=df(),r=Ib(i);r.payload=e,n!=null&&(r.callback=n),e=kb(t,r,i),e!==null&&(ff(e,t,i),pO(e,t,i))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var i=df(),r=Ib(i);r.tag=1,r.payload=e,n!=null&&(r.callback=n),e=kb(t,r,i),e!==null&&(ff(e,t,i),pO(e,t,i))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=df(),i=Ib(n);i.tag=2,e!=null&&(i.callback=e),e=kb(t,i,n),e!==null&&(ff(e,t,n),pO(e,t,n))}};function Nee(t,e,n,i,r,s,a){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(i,s,a):e.prototype&&e.prototype.isPureReactComponent?!lN(n,i)||!lN(r,s):!0}function Iee(t,e,n,i){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,i),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,i),e.state!==t&&VG.enqueueReplaceState(e,e.state,null)}function i1(t,e){var n=e;if("ref"in e){n={};for(var i in e)i!=="ref"&&(n[i]=e[i])}if(t=t.defaultProps){n===e&&(n=Ma({},n));for(var r in t)n[r]===void 0&&(n[r]=t[r])}return n}var JU=typeof reportError=="function"?reportError:function(t){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var e=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof t=="object"&&t!==null&&typeof t.message=="string"?String(t.message):String(t),error:t});if(!window.dispatchEvent(e))return}else if(typeof Gn=="object"&&typeof Gn.emit=="function"){Gn.emit("uncaughtException",t);return}console.error(t)};function _fe(t){JU(t)}function yfe(t){console.error(t)}function bfe(t){JU(t)}function QU(t,e){try{var n=t.onUncaughtError;n(e.value,{componentStack:e.stack})}catch(i){setTimeout(function(){throw i})}}function kee(t,e,n){try{var i=t.onCaughtError;i(n.value,{componentStack:n.stack,errorBoundary:e.tag===1?e.stateNode:null})}catch(r){setTimeout(function(){throw r})}}function GG(t,e,n){return n=Ib(n),n.tag=3,n.payload={element:null},n.callback=function(){QU(t,e)},n}function Efe(t){return t=Ib(t),t.tag=3,t}function Sfe(t,e,n,i){var r=n.type.getDerivedStateFromError;if(typeof r=="function"){var s=i.value;t.payload=function(){return r(s)},t.callback=function(){kee(e,n,i)}}var a=n.stateNode;a!==null&&typeof a.componentDidCatch=="function"&&(t.callback=function(){kee(e,n,i),typeof r!="function"&&(Pb===null?Pb=new Set([this]):Pb.add(this));var o=i.stack;this.componentDidCatch(i.value,{componentStack:o!==null?o:""})})}function LLe(t,e,n,i,r){if(n.flags|=32768,i!==null&&typeof i=="object"&&typeof i.then=="function"){if(e=n.alternate,e!==null&&JI(e,n,r,!0),n=Ep.current,n!==null){switch(n.tag){case 13:return Xg===null?JG():n.alternate===null&&Ro===0&&(Ro=3),n.flags&=-257,n.flags|=65536,n.lanes=r,i===LG?n.flags|=16384:(e=n.updateQueue,e===null?n.updateQueue=new Set([i]):e.add(i),Dj(t,i,r)),!1;case 22:return n.flags|=65536,i===LG?n.flags|=16384:(e=n.updateQueue,e===null?(e={transitions:null,markerInstances:null,retryQueue:new Set([i])},n.updateQueue=e):(n=e.retryQueue,n===null?e.retryQueue=new Set([i]):n.add(i)),Dj(t,i,r)),!1}throw Error(Gt(435,n.tag))}return Dj(t,i,r),JG(),!1}if(Es)return e=Ep.current,e!==null?(!(e.flags&65536)&&(e.flags|=256),e.flags|=65536,e.lanes=r,i!==NG&&(t=Error(Gt(422),{cause:i}),uN(ip(t,n)))):(i!==NG&&(e=Error(Gt(423),{cause:i}),uN(ip(e,n))),t=t.current.alternate,t.flags|=65536,r&=-r,t.lanes|=r,i=ip(i,n),r=GG(t.stateNode,i,r),Sj(t,r),Ro!==4&&(Ro=2)),!1;var s=Error(Gt(520),{cause:i});if(s=ip(s,n),bO===null?bO=[s]:bO.push(s),Ro!==4&&(Ro=2),e===null)return!0;i=ip(i,n),n=e;do{switch(n.tag){case 3:return n.flags|=65536,t=r&-r,n.lanes|=t,t=GG(n.stateNode,i,t),Sj(n,t),!1;case 1:if(e=n.type,s=n.stateNode,(n.flags&128)===0&&(typeof e.getDerivedStateFromError=="function"||s!==null&&typeof s.componentDidCatch=="function"&&(Pb===null||!Pb.has(s))))return n.flags|=65536,r&=-r,n.lanes|=r,r=Efe(r),Sfe(r,t,n,i),Sj(n,r),!1}n=n.return}while(n!==null);return!1}var Tfe=Error(Gt(461)),xl=!1;function ql(t,e,n,i){e.child=t===null?gfe(e,null,n,i):eA(e,t.child,n,i)}function Pee(t,e,n,i,r){n=n.render;var s=e.ref;if("ref"in i){var a={};for(var o in i)o!=="ref"&&(a[o]=i[o])}else a=i;return t1(e),i=a9(t,e,n,a,s,r),o=o9(),t!==null&&!xl?(c9(t,e,r),A_(t,e,r)):(Es&&o&&QW(e),e.flags|=1,ql(t,e,i,r),e.child)}function Dee(t,e,n,i,r){if(t===null){var s=n.type;return typeof s=="function"&&!JW(s)&&s.defaultProps===void 0&&n.compare===null?(e.tag=15,e.type=s,xfe(t,e,s,i,r)):(t=V2(n.type,null,i,e,e.mode,r),t.ref=e.ref,t.return=e,e.child=t)}if(s=t.child,!v9(t,r)){var a=s.memoizedProps;if(n=n.compare,n=n!==null?n:lN,n(a,i)&&t.ref===e.ref)return A_(t,e,r)}return e.flags|=1,t=d_(s,i),t.ref=e.ref,t.return=e,e.child=t}function xfe(t,e,n,i,r){if(t!==null){var s=t.memoizedProps;if(lN(s,i)&&t.ref===e.ref)if(xl=!1,e.pendingProps=i=s,v9(t,r))t.flags&131072&&(xl=!0);else return e.lanes=t.lanes,A_(t,e,r)}return qG(t,e,n,i,r)}function wfe(t,e,n){var i=e.pendingProps,r=i.children,s=t!==null?t.memoizedState:null;if(i.mode==="hidden"){if(e.flags&128){if(i=s!==null?s.baseLanes|n:n,t!==null){for(r=e.child=t.child,s=0;r!==null;)s=s|r.lanes|r.childLanes,r=r.sibling;e.childLanes=s&~i}else e.childLanes=0,e.child=null;return Lee(t,e,i,n)}if(n&536870912)e.memoizedState={baseLanes:0,cachePool:null},t!==null&&G2(e,s!==null?s.cachePool:null),s!==null?Tee(e,s):FG(),vfe(e);else return e.lanes=e.childLanes=536870912,Lee(t,e,s!==null?s.baseLanes|n:n,n)}else s!==null?(G2(e,s.cachePool),Tee(e,s),gb(),e.memoizedState=null):(t!==null&&G2(e,null),FG(),gb());return ql(t,e,r,n),e.child}function Lee(t,e,n,i){var r=n9();return r=r===null?null:{parent:zc._currentValue,pool:r},e.memoizedState={baseLanes:n,cachePool:r},t!==null&&G2(e,null),FG(),vfe(e),t!==null&&JI(t,e,i,!0),null}function W2(t,e){var n=e.ref;if(n===null)t!==null&&t.ref!==null&&(e.flags|=4194816);else{if(typeof n!="function"&&typeof n!="object")throw Error(Gt(284));(t===null||t.ref!==n)&&(e.flags|=4194816)}}function qG(t,e,n,i,r){return t1(e),n=a9(t,e,n,i,void 0,r),i=o9(),t!==null&&!xl?(c9(t,e,r),A_(t,e,r)):(Es&&i&&QW(e),e.flags|=1,ql(t,e,n,r),e.child)}function Uee(t,e,n,i,r,s){return t1(e),e.updateQueue=null,n=Bde(e,i,n,r),Ude(t),i=o9(),t!==null&&!xl?(c9(t,e,s),A_(t,e,s)):(Es&&i&&QW(e),e.flags|=1,ql(t,e,n,s),e.child)}function Bee(t,e,n,i,r){if(t1(e),e.stateNode===null){var s=Kw,a=n.contextType;typeof a=="object"&&a!==null&&(s=yu(a)),s=new n(i,s),e.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,s.updater=VG,e.stateNode=s,s._reactInternals=e,s=e.stateNode,s.props=i,s.state=e.memoizedState,s.refs={},i9(e),a=n.contextType,s.context=typeof a=="object"&&a!==null?yu(a):Kw,s.state=e.memoizedState,a=n.getDerivedStateFromProps,typeof a=="function"&&(xj(e,n,a,i),s.state=e.memoizedState),typeof n.getDerivedStateFromProps=="function"||typeof s.getSnapshotBeforeUpdate=="function"||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(a=s.state,typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount(),a!==s.state&&VG.enqueueReplaceState(s,s.state,null),gO(e,i,s,r),mO(),s.state=e.memoizedState),typeof s.componentDidMount=="function"&&(e.flags|=4194308),i=!0}else if(t===null){s=e.stateNode;var o=e.memoizedProps,c=i1(n,o);s.props=c;var l=s.context,u=n.contextType;a=Kw,typeof u=="object"&&u!==null&&(a=yu(u));var h=n.getDerivedStateFromProps;u=typeof h=="function"||typeof s.getSnapshotBeforeUpdate=="function",o=e.pendingProps!==o,u||typeof s.UNSAFE_componentWillReceiveProps!="function"&&typeof s.componentWillReceiveProps!="function"||(o||l!==a)&&Iee(e,s,i,a),rb=!1;var d=e.memoizedState;s.state=d,gO(e,i,s,r),mO(),l=e.memoizedState,o||d!==l||rb?(typeof h=="function"&&(xj(e,n,h,i),l=e.memoizedState),(c=rb||Nee(e,n,c,i,d,l,a))?(u||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount()),typeof s.componentDidMount=="function"&&(e.flags|=4194308)):(typeof s.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=i,e.memoizedState=l),s.props=i,s.state=l,s.context=a,i=c):(typeof s.componentDidMount=="function"&&(e.flags|=4194308),i=!1)}else{s=e.stateNode,UG(t,e),a=e.memoizedProps,u=i1(n,a),s.props=u,h=e.pendingProps,d=s.context,l=n.contextType,c=Kw,typeof l=="object"&&l!==null&&(c=yu(l)),o=n.getDerivedStateFromProps,(l=typeof o=="function"||typeof s.getSnapshotBeforeUpdate=="function")||typeof s.UNSAFE_componentWillReceiveProps!="function"&&typeof s.componentWillReceiveProps!="function"||(a!==h||d!==c)&&Iee(e,s,i,c),rb=!1,d=e.memoizedState,s.state=d,gO(e,i,s,r),mO();var f=e.memoizedState;a!==h||d!==f||rb||t!==null&&t.dependencies!==null&&$U(t.dependencies)?(typeof o=="function"&&(xj(e,n,o,i),f=e.memoizedState),(u=rb||Nee(e,n,u,i,d,f,c)||t!==null&&t.dependencies!==null&&$U(t.dependencies))?(l||typeof s.UNSAFE_componentWillUpdate!="function"&&typeof s.componentWillUpdate!="function"||(typeof s.componentWillUpdate=="function"&&s.componentWillUpdate(i,f,c),typeof s.UNSAFE_componentWillUpdate=="function"&&s.UNSAFE_componentWillUpdate(i,f,c)),typeof s.componentDidUpdate=="function"&&(e.flags|=4),typeof s.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof s.componentDidUpdate!="function"||a===t.memoizedProps&&d===t.memoizedState||(e.flags|=4),typeof s.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&d===t.memoizedState||(e.flags|=1024),e.memoizedProps=i,e.memoizedState=f),s.props=i,s.state=f,s.context=c,i=u):(typeof s.componentDidUpdate!="function"||a===t.memoizedProps&&d===t.memoizedState||(e.flags|=4),typeof s.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&d===t.memoizedState||(e.flags|=1024),i=!1)}return s=i,W2(t,e),i=(e.flags&128)!==0,s||i?(s=e.stateNode,n=i&&typeof n.getDerivedStateFromError!="function"?null:s.render(),e.flags|=1,t!==null&&i?(e.child=eA(e,t.child,null,r),e.child=eA(e,null,n,r)):ql(t,e,n,r),e.memoizedState=s.state,t=e.child):t=A_(t,e,r),t}function Fee(t,e,n,i){return ZI(),e.flags|=256,ql(t,e,n,i),e.child}var wj={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function Cj(t){return{baseLanes:t,cachePool:Ide()}}function Aj(t,e,n){return t=t!==null?t.childLanes&~n:0,e&&(t|=up),t}function Cfe(t,e,n){var i=e.pendingProps,r=!1,s=(e.flags&128)!==0,a;if((a=s)||(a=t!==null&&t.memoizedState===null?!1:(Gc.current&2)!==0),a&&(r=!0,e.flags&=-129),a=(e.flags&32)!==0,e.flags&=-33,t===null){if(Es){if(r?mb(e):gb(),Es){var o=Ao,c;if(c=o){e:{for(c=o,o=Lg;c.nodeType!==8;){if(!o){o=null;break e}if(c=Tm(c.nextSibling),c===null){o=null;break e}}o=c}o!==null?(e.memoizedState={dehydrated:o,treeContext:IT!==null?{id:i_,overflow:r_}:null,retryLane:536870912,hydrationErrors:null},c=nf(18,null,null,0),c.stateNode=o,c.return=e,e.child=c,ch=e,Ao=null,c=!0):c=!1}c||e1(e)}if(o=e.memoizedState,o!==null&&(o=o.dehydrated,o!==null))return sq(o)?e.lanes=32:e.lanes=536870912,null;a_(e)}return o=i.children,i=i.fallback,r?(gb(),r=e.mode,o=e3({mode:"hidden",children:o},r),i=NT(i,r,n,null),o.return=e,i.return=e,o.sibling=i,e.child=o,r=e.child,r.memoizedState=Cj(n),r.childLanes=Aj(t,a,n),e.memoizedState=wj,i):(mb(e),$G(e,o))}if(c=t.memoizedState,c!==null&&(o=c.dehydrated,o!==null)){if(s)e.flags&256?(mb(e),e.flags&=-257,e=Rj(t,e,n)):e.memoizedState!==null?(gb(),e.child=t.child,e.flags|=128,e=null):(gb(),r=i.fallback,o=e.mode,i=e3({mode:"visible",children:i.children},o),r=NT(r,o,n,null),r.flags|=2,i.return=e,r.return=e,i.sibling=r,e.child=i,eA(e,t.child,null,n),i=e.child,i.memoizedState=Cj(n),i.childLanes=Aj(t,a,n),e.memoizedState=wj,e=r);else if(mb(e),sq(o)){if(a=o.nextSibling&&o.nextSibling.dataset,a)var l=a.dgst;a=l,i=Error(Gt(419)),i.stack="",i.digest=a,uN({value:i,source:null,stack:null}),e=Rj(t,e,n)}else if(xl||JI(t,e,n,!1),a=(n&t.childLanes)!==0,xl||a){if(a=da,a!==null&&(i=n&-n,i=i&42?1:jW(i),i=i&(a.suspendedLanes|n)?0:i,i!==0&&i!==c.retryLane))throw c.retryLane=i,sR(t,i),ff(a,t,i),Tfe;o.data==="$?"||JG(),e=Rj(t,e,n)}else o.data==="$?"?(e.flags|=192,e.child=t.child,e=null):(t=c.treeContext,Ao=Tm(o.nextSibling),ch=e,Es=!0,kT=null,Lg=!1,t!==null&&(Jf[Qf++]=i_,Jf[Qf++]=r_,Jf[Qf++]=IT,i_=t.id,r_=t.overflow,IT=e),e=$G(e,i.children),e.flags|=4096);return e}return r?(gb(),r=i.fallback,o=e.mode,c=t.child,l=c.sibling,i=d_(c,{mode:"hidden",children:i.children}),i.subtreeFlags=c.subtreeFlags&65011712,l!==null?r=d_(l,r):(r=NT(r,o,n,null),r.flags|=2),r.return=e,i.return=e,i.sibling=r,e.child=i,i=r,r=e.child,o=t.child.memoizedState,o===null?o=Cj(n):(c=o.cachePool,c!==null?(l=zc._currentValue,c=c.parent!==l?{parent:l,pool:l}:c):c=Ide(),o={baseLanes:o.baseLanes|n,cachePool:c}),r.memoizedState=o,r.childLanes=Aj(t,a,n),e.memoizedState=wj,i):(mb(e),n=t.child,t=n.sibling,n=d_(n,{mode:"visible",children:i.children}),n.return=e,n.sibling=null,t!==null&&(a=e.deletions,a===null?(e.deletions=[t],e.flags|=16):a.push(t)),e.child=n,e.memoizedState=null,n)}function $G(t,e){return e=e3({mode:"visible",children:e},t.mode),e.return=t,t.child=e}function e3(t,e){return t=nf(22,t,null,e),t.lanes=0,t.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null},t}function Rj(t,e,n){return eA(e,t.child,null,n),t=$G(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function zee(t,e,n){t.lanes|=e;var i=t.alternate;i!==null&&(i.lanes|=e),kG(t.return,e,n)}function Mj(t,e,n,i,r){var s=t.memoizedState;s===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:i,tail:n,tailMode:r}:(s.isBackwards=e,s.rendering=null,s.renderingStartTime=0,s.last=i,s.tail=n,s.tailMode=r)}function Afe(t,e,n){var i=e.pendingProps,r=i.revealOrder,s=i.tail;if(ql(t,e,i.children,n),i=Gc.current,i&2)i=i&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&zee(t,n,e);else if(t.tag===19)zee(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}i&=1}switch(Ha(Gc,i),r){case"forwards":for(n=e.child,r=null;n!==null;)t=n.alternate,t!==null&&ZU(t)===null&&(r=n),n=n.sibling;n=r,n===null?(r=e.child,e.child=null):(r=n.sibling,n.sibling=null),Mj(e,!1,r,n,s);break;case"backwards":for(n=null,r=e.child,e.child=null;r!==null;){if(t=r.alternate,t!==null&&ZU(t)===null){e.child=r;break}t=r.sibling,r.sibling=n,n=r,r=t}Mj(e,!0,n,null,s);break;case"together":Mj(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function A_(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),rE|=e.lanes,!(n&e.childLanes))if(t!==null){if(JI(t,e,n,!1),(n&e.childLanes)===0)return null}else return null;if(t!==null&&e.child!==t.child)throw Error(Gt(153));if(e.child!==null){for(t=e.child,n=d_(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=d_(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function v9(t,e){return t.lanes&e?!0:(t=t.dependencies,!!(t!==null&&$U(t)))}function ULe(t,e,n){switch(e.tag){case 3:BU(e,e.stateNode.containerInfo),pb(e,zc,t.memoizedState.cache),ZI();break;case 27:case 5:EG(e);break;case 4:BU(e,e.stateNode.containerInfo);break;case 10:pb(e,e.type,e.memoizedProps.value);break;case 13:var i=e.memoizedState;if(i!==null)return i.dehydrated!==null?(mb(e),e.flags|=128,null):n&e.child.childLanes?Cfe(t,e,n):(mb(e),t=A_(t,e,n),t!==null?t.sibling:null);mb(e);break;case 19:var r=(t.flags&128)!==0;if(i=(n&e.childLanes)!==0,i||(JI(t,e,n,!1),i=(n&e.childLanes)!==0),r){if(i)return Afe(t,e,n);e.flags|=128}if(r=e.memoizedState,r!==null&&(r.rendering=null,r.tail=null,r.lastEffect=null),Ha(Gc,Gc.current),i)break;return null;case 22:case 23:return e.lanes=0,wfe(t,e,n);case 24:pb(e,zc,t.memoizedState.cache)}return A_(t,e,n)}function Rfe(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps)xl=!0;else{if(!v9(t,n)&&!(e.flags&128))return xl=!1,ULe(t,e,n);xl=!!(t.flags&131072)}else xl=!1,Es&&e.flags&1048576&&Ode(e,qU,e.index);switch(e.lanes=0,e.tag){case 16:e:{t=e.pendingProps;var i=e.elementType,r=i._init;if(i=r(i._payload),e.type=i,typeof i=="function")JW(i)?(t=i1(i,t),e.tag=1,e=Bee(null,e,i,t,n)):(e.tag=0,e=qG(null,e,i,t,n));else{if(i!=null){if(r=i.$$typeof,r===BW){e.tag=11,e=Pee(null,e,i,t,n);break e}else if(r===FW){e.tag=14,e=Dee(null,e,i,t,n);break e}}throw e=yG(i)||i,Error(Gt(306,e,""))}}return e;case 0:return qG(t,e,e.type,e.pendingProps,n);case 1:return i=e.type,r=i1(i,e.pendingProps),Bee(t,e,i,r,n);case 3:e:{if(BU(e,e.stateNode.containerInfo),t===null)throw Error(Gt(387));i=e.pendingProps;var s=e.memoizedState;r=s.element,UG(t,e),gO(e,i,null,n);var a=e.memoizedState;if(i=a.cache,pb(e,zc,i),i!==s.cache&&PG(e,[zc],n,!0),mO(),i=a.element,s.isDehydrated)if(s={element:i,isDehydrated:!1,cache:a.cache},e.updateQueue.baseState=s,e.memoizedState=s,e.flags&256){e=Fee(t,e,i,n);break e}else if(i!==r){r=ip(Error(Gt(424)),e),uN(r),e=Fee(t,e,i,n);break e}else{switch(t=e.stateNode.containerInfo,t.nodeType){case 9:t=t.body;break;default:t=t.nodeName==="HTML"?t.ownerDocument.body:t}for(Ao=Tm(t.firstChild),ch=e,Es=!0,kT=null,Lg=!0,n=gfe(e,null,i,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling}else{if(ZI(),i===r){e=A_(t,e,n);break e}ql(t,e,i,n)}e=e.child}return e;case 26:return W2(t,e),t===null?(n=ite(e.type,null,e.pendingProps,null))?e.memoizedState=n:Es||(n=e.type,t=e.pendingProps,i=o3(Nb.current).createElement(n),i[_u]=e,i[fd]=t,Xl(i,n,t),Sl(i),e.stateNode=i):e.memoizedState=ite(e.type,t.memoizedProps,e.pendingProps,t.memoizedState),null;case 27:return EG(e),t===null&&Es&&(i=e.stateNode=ppe(e.type,e.pendingProps,Nb.current),ch=e,Lg=!0,r=Ao,OE(e.type)?(aq=r,Ao=Tm(i.firstChild)):Ao=r),ql(t,e,e.pendingProps.children,n),W2(t,e),t===null&&(e.flags|=4194304),e.child;case 5:return t===null&&Es&&((r=i=Ao)&&(i=hUe(i,e.type,e.pendingProps,Lg),i!==null?(e.stateNode=i,ch=e,Ao=Tm(i.firstChild),Lg=!1,r=!0):r=!1),r||e1(e)),EG(e),r=e.type,s=e.pendingProps,a=t!==null?t.memoizedProps:null,i=s.children,iq(r,s)?i=null:a!==null&&iq(r,a)&&(e.flags|=32),e.memoizedState!==null&&(r=a9(t,e,MLe,null,null,n),gN._currentValue=r),W2(t,e),ql(t,e,i,n),e.child;case 6:return t===null&&Es&&((t=n=Ao)&&(n=dUe(n,e.pendingProps,Lg),n!==null?(e.stateNode=n,ch=e,Ao=null,t=!0):t=!1),t||e1(e)),null;case 13:return Cfe(t,e,n);case 4:return BU(e,e.stateNode.containerInfo),i=e.pendingProps,t===null?e.child=eA(e,null,i,n):ql(t,e,i,n),e.child;case 11:return Pee(t,e,e.type,e.pendingProps,n);case 7:return ql(t,e,e.pendingProps,n),e.child;case 8:return ql(t,e,e.pendingProps.children,n),e.child;case 12:return ql(t,e,e.pendingProps.children,n),e.child;case 10:return i=e.pendingProps,pb(e,e.type,i.value),ql(t,e,i.children,n),e.child;case 9:return r=e.type._context,i=e.pendingProps.children,t1(e),r=yu(r),i=i(r),e.flags|=1,ql(t,e,i,n),e.child;case 14:return Dee(t,e,e.type,e.pendingProps,n);case 15:return xfe(t,e,e.type,e.pendingProps,n);case 19:return Afe(t,e,n);case 31:return i=e.pendingProps,n=e.mode,i={mode:i.mode,children:i.children},t===null?(n=e3(i,n),n.ref=e.ref,e.child=n,n.return=e,e=n):(n=d_(t.child,i),n.ref=e.ref,e.child=n,n.return=e,e=n),e;case 22:return wfe(t,e,n);case 24:return t1(e),i=yu(zc),t===null?(r=n9(),r===null&&(r=da,s=t9(),r.pooledCache=s,s.refCount++,s!==null&&(r.pooledCacheLanes|=n),r=s),e.memoizedState={parent:i,cache:r},i9(e),pb(e,zc,r)):(t.lanes&n&&(UG(t,e),gO(e,null,null,n),mO()),r=t.memoizedState,s=e.memoizedState,r.parent!==i?(r={parent:i,cache:i},e.memoizedState=r,e.lanes===0&&(e.memoizedState=e.updateQueue.baseState=r),pb(e,zc,i)):(i=s.cache,pb(e,zc,i),i!==r.cache&&PG(e,[zc],n,!0))),ql(t,e,e.pendingProps.children,n),e.child;case 29:throw e.pendingProps}throw Error(Gt(156,e.tag))}function Nv(t){t.flags|=4}function jee(t,e){if(e.type!=="stylesheet"||e.state.loading&4)t.flags&=-16777217;else if(t.flags|=16777216,!vpe(e)){if(e=Ep.current,e!==null&&(($r&4194048)===$r?Xg!==null:($r&62914560)!==$r&&!($r&536870912)||e!==Xg))throw fO=LG,kde;t.flags|=8192}}function OD(t,e){e!==null&&(t.flags|=4),t.flags&16384&&(e=t.tag!==22?ede():536870912,t.lanes|=e,tA|=e)}function cM(t,e){if(!Es)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var i=null;n!==null;)n.alternate!==null&&(i=n),n=n.sibling;i===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:i.sibling=null}}function eo(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,i=0;if(e)for(var r=t.child;r!==null;)n|=r.lanes|r.childLanes,i|=r.subtreeFlags&65011712,i|=r.flags&65011712,r.return=t,r=r.sibling;else for(r=t.child;r!==null;)n|=r.lanes|r.childLanes,i|=r.subtreeFlags,i|=r.flags,r.return=t,r=r.sibling;return t.subtreeFlags|=i,t.childLanes=n,e}function BLe(t,e,n){var i=e.pendingProps;switch(e9(e),e.tag){case 31:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return eo(e),null;case 1:return eo(e),null;case 3:return n=e.stateNode,i=null,t!==null&&(i=t.memoizedState.cache),e.memoizedState.cache!==i&&(e.flags|=2048),f_(zc),YC(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(t===null||t.child===null)&&(aM(e)?Nv(e):t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,vee())),eo(e),null;case 26:return n=e.memoizedState,t===null?(Nv(e),n!==null?(eo(e),jee(e,n)):(eo(e),e.flags&=-16777217)):n?n!==t.memoizedState?(Nv(e),eo(e),jee(e,n)):(eo(e),e.flags&=-16777217):(t.memoizedProps!==i&&Nv(e),eo(e),e.flags&=-16777217),null;case 27:FU(e),n=Nb.current;var r=e.type;if(t!==null&&e.stateNode!=null)t.memoizedProps!==i&&Nv(e);else{if(!i){if(e.stateNode===null)throw Error(Gt(166));return eo(e),null}t=Yg.current,aM(e)?mee(e):(t=ppe(r,i,n),e.stateNode=t,Nv(e))}return eo(e),null;case 5:if(FU(e),n=e.type,t!==null&&e.stateNode!=null)t.memoizedProps!==i&&Nv(e);else{if(!i){if(e.stateNode===null)throw Error(Gt(166));return eo(e),null}if(t=Yg.current,aM(e))mee(e);else{switch(r=o3(Nb.current),t){case 1:t=r.createElementNS("http://www.w3.org/2000/svg",n);break;case 2:t=r.createElementNS("http://www.w3.org/1998/Math/MathML",n);break;default:switch(n){case"svg":t=r.createElementNS("http://www.w3.org/2000/svg",n);break;case"math":t=r.createElementNS("http://www.w3.org/1998/Math/MathML",n);break;case"script":t=r.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild);break;case"select":t=typeof i.is=="string"?r.createElement("select",{is:i.is}):r.createElement("select"),i.multiple?t.multiple=!0:i.size&&(t.size=i.size);break;default:t=typeof i.is=="string"?r.createElement(n,{is:i.is}):r.createElement(n)}}t[_u]=e,t[fd]=i;e:for(r=e.child;r!==null;){if(r.tag===5||r.tag===6)t.appendChild(r.stateNode);else if(r.tag!==4&&r.tag!==27&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===e)break e;for(;r.sibling===null;){if(r.return===null||r.return===e)break e;r=r.return}r.sibling.return=r.return,r=r.sibling}e.stateNode=t;e:switch(Xl(t,n,i),n){case"button":case"input":case"select":case"textarea":t=!!i.autoFocus;break e;case"img":t=!0;break e;default:t=!1}t&&Nv(e)}}return eo(e),e.flags&=-16777217,null;case 6:if(t&&e.stateNode!=null)t.memoizedProps!==i&&Nv(e);else{if(typeof i!="string"&&e.stateNode===null)throw Error(Gt(166));if(t=Nb.current,aM(e)){if(t=e.stateNode,n=e.memoizedProps,i=null,r=ch,r!==null)switch(r.tag){case 27:case 5:i=r.memoizedProps}t[_u]=e,t=!!(t.nodeValue===n||i!==null&&i.suppressHydrationWarning===!0||hpe(t.nodeValue,n)),t||e1(e)}else t=o3(t).createTextNode(i),t[_u]=e,e.stateNode=t}return eo(e),null;case 13:if(i=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(r=aM(e),i!==null&&i.dehydrated!==null){if(t===null){if(!r)throw Error(Gt(318));if(r=e.memoizedState,r=r!==null?r.dehydrated:null,!r)throw Error(Gt(317));r[_u]=e}else ZI(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;eo(e),r=!1}else r=vee(),t!==null&&t.memoizedState!==null&&(t.memoizedState.hydrationErrors=r),r=!0;if(!r)return e.flags&256?(a_(e),e):(a_(e),null)}if(a_(e),e.flags&128)return e.lanes=n,e;if(n=i!==null,t=t!==null&&t.memoizedState!==null,n){i=e.child,r=null,i.alternate!==null&&i.alternate.memoizedState!==null&&i.alternate.memoizedState.cachePool!==null&&(r=i.alternate.memoizedState.cachePool.pool);var s=null;i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(s=i.memoizedState.cachePool.pool),s!==r&&(i.flags|=2048)}return n!==t&&n&&(e.child.flags|=8192),OD(e,e.updateQueue),eo(e),null;case 4:return YC(),t===null&&w9(e.stateNode.containerInfo),eo(e),null;case 10:return f_(e.type),eo(e),null;case 19:if(Cl(Gc),r=e.memoizedState,r===null)return eo(e),null;if(i=(e.flags&128)!==0,s=r.rendering,s===null)if(i)cM(r,!1);else{if(Ro!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(s=ZU(t),s!==null){for(e.flags|=128,cM(r,!1),t=s.updateQueue,e.updateQueue=t,OD(e,t),e.subtreeFlags=0,t=n,n=e.child;n!==null;)Mde(n,t),n=n.sibling;return Ha(Gc,Gc.current&1|2),e.child}t=t.sibling}r.tail!==null&&Kg()>n3&&(e.flags|=128,i=!0,cM(r,!1),e.lanes=4194304)}else{if(!i)if(t=ZU(s),t!==null){if(e.flags|=128,i=!0,t=t.updateQueue,e.updateQueue=t,OD(e,t),cM(r,!0),r.tail===null&&r.tailMode==="hidden"&&!s.alternate&&!Es)return eo(e),null}else 2*Kg()-r.renderingStartTime>n3&&n!==536870912&&(e.flags|=128,i=!0,cM(r,!1),e.lanes=4194304);r.isBackwards?(s.sibling=e.child,e.child=s):(t=r.last,t!==null?t.sibling=s:e.child=s,r.last=s)}return r.tail!==null?(e=r.tail,r.rendering=e,r.tail=e.sibling,r.renderingStartTime=Kg(),e.sibling=null,t=Gc.current,Ha(Gc,i?t&1|2:t&1),e):(eo(e),null);case 22:case 23:return a_(e),r9(),i=e.memoizedState!==null,t!==null?t.memoizedState!==null!==i&&(e.flags|=8192):i&&(e.flags|=8192),i?n&536870912&&!(e.flags&128)&&(eo(e),e.subtreeFlags&6&&(e.flags|=8192)):eo(e),n=e.updateQueue,n!==null&&OD(e,n.retryQueue),n=null,t!==null&&t.memoizedState!==null&&t.memoizedState.cachePool!==null&&(n=t.memoizedState.cachePool.pool),i=null,e.memoizedState!==null&&e.memoizedState.cachePool!==null&&(i=e.memoizedState.cachePool.pool),i!==n&&(e.flags|=2048),t!==null&&Cl(PT),null;case 24:return n=null,t!==null&&(n=t.memoizedState.cache),e.memoizedState.cache!==n&&(e.flags|=2048),f_(zc),eo(e),null;case 25:return null;case 30:return null}throw Error(Gt(156,e.tag))}function FLe(t,e){switch(e9(e),e.tag){case 1:return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return f_(zc),YC(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 26:case 27:case 5:return FU(e),null;case 13:if(a_(e),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(Gt(340));ZI()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return Cl(Gc),null;case 4:return YC(),null;case 10:return f_(e.type),null;case 22:case 23:return a_(e),r9(),t!==null&&Cl(PT),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 24:return f_(zc),null;case 25:return null;default:return null}}function Mfe(t,e){switch(e9(e),e.tag){case 3:f_(zc),YC();break;case 26:case 27:case 5:FU(e);break;case 4:YC();break;case 13:a_(e);break;case 19:Cl(Gc);break;case 10:f_(e.type);break;case 22:case 23:a_(e),r9(),t!==null&&Cl(PT);break;case 24:f_(zc)}}function ik(t,e){try{var n=e.updateQueue,i=n!==null?n.lastEffect:null;if(i!==null){var r=i.next;n=r;do{if((n.tag&t)===t){i=void 0;var s=n.create,a=n.inst;i=s(),a.destroy=i}n=n.next}while(n!==r)}}catch(o){Qs(e,e.return,o)}}function iE(t,e,n){try{var i=e.updateQueue,r=i!==null?i.lastEffect:null;if(r!==null){var s=r.next;i=s;do{if((i.tag&t)===t){var a=i.inst,o=a.destroy;if(o!==void 0){a.destroy=void 0,r=e;var c=n,l=o;try{l()}catch(u){Qs(r,c,u)}}}i=i.next}while(i!==s)}}catch(u){Qs(e,e.return,u)}}function Ofe(t){var e=t.updateQueue;if(e!==null){var n=t.stateNode;try{Lde(e,n)}catch(i){Qs(t,t.return,i)}}}function Nfe(t,e,n){n.props=i1(t.type,t.memoizedProps),n.state=t.memoizedState;try{n.componentWillUnmount()}catch(i){Qs(t,e,i)}}function _O(t,e){try{var n=t.ref;if(n!==null){switch(t.tag){case 26:case 27:case 5:var i=t.stateNode;break;case 30:i=t.stateNode;break;default:i=t.stateNode}typeof n=="function"?t.refCleanup=n(i):n.current=i}}catch(r){Qs(t,e,r)}}function Vg(t,e){var n=t.ref,i=t.refCleanup;if(n!==null)if(typeof i=="function")try{i()}catch(r){Qs(t,e,r)}finally{t.refCleanup=null,t=t.alternate,t!=null&&(t.refCleanup=null)}else if(typeof n=="function")try{n(null)}catch(r){Qs(t,e,r)}else n.current=null}function Ife(t){var e=t.type,n=t.memoizedProps,i=t.stateNode;try{e:switch(e){case"button":case"input":case"select":case"textarea":n.autoFocus&&i.focus();break e;case"img":n.src?i.src=n.src:n.srcSet&&(i.srcset=n.srcSet)}}catch(r){Qs(t,t.return,r)}}function Oj(t,e,n){try{var i=t.stateNode;aUe(i,t.type,n,e),i[fd]=e}catch(r){Qs(t,t.return,r)}}function kfe(t){return t.tag===5||t.tag===3||t.tag===26||t.tag===27&&OE(t.type)||t.tag===4}function Nj(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||kfe(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.tag===27&&OE(t.type)||t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function WG(t,e,n){var i=t.tag;if(i===5||i===6)t=t.stateNode,e?(n.nodeType===9?n.body:n.nodeName==="HTML"?n.ownerDocument.body:n).insertBefore(t,e):(e=n.nodeType===9?n.body:n.nodeName==="HTML"?n.ownerDocument.body:n,e.appendChild(t),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=GF));else if(i!==4&&(i===27&&OE(t.type)&&(n=t.stateNode,e=null),t=t.child,t!==null))for(WG(t,e,n),t=t.sibling;t!==null;)WG(t,e,n),t=t.sibling}function t3(t,e,n){var i=t.tag;if(i===5||i===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(i!==4&&(i===27&&OE(t.type)&&(n=t.stateNode),t=t.child,t!==null))for(t3(t,e,n),t=t.sibling;t!==null;)t3(t,e,n),t=t.sibling}function Pfe(t){var e=t.stateNode,n=t.memoizedProps;try{for(var i=t.type,r=e.attributes;r.length;)e.removeAttributeNode(r[0]);Xl(e,i,n),e[_u]=t,e[fd]=n}catch(s){Qs(t,t.return,s)}}var Kv=!1,qo=!1,Ij=!1,Hee=typeof WeakSet=="function"?WeakSet:Set,yl=null;function zLe(t,e){if(t=t.containerInfo,tq=h3,t=Ede(t),KW(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var i=n.getSelection&&n.getSelection();if(i&&i.rangeCount!==0){n=i.anchorNode;var r=i.anchorOffset,s=i.focusNode;i=i.focusOffset;try{n.nodeType,s.nodeType}catch{n=null;break e}var a=0,o=-1,c=-1,l=0,u=0,h=t,d=null;t:for(;;){for(var f;h!==n||r!==0&&h.nodeType!==3||(o=a+r),h!==s||i!==0&&h.nodeType!==3||(c=a+i),h.nodeType===3&&(a+=h.nodeValue.length),(f=h.firstChild)!==null;)d=h,h=f;for(;;){if(h===t)break t;if(d===n&&++l===r&&(o=a),d===s&&++u===i&&(c=a),(f=h.nextSibling)!==null)break;h=d,d=h.parentNode}h=f}n=o===-1||c===-1?null:{start:o,end:c}}else n=null}n=n||{start:0,end:0}}else n=null;for(nq={focusedElem:t,selectionRange:n},h3=!1,yl=e;yl!==null;)if(e=yl,t=e.child,(e.subtreeFlags&1024)!==0&&t!==null)t.return=e,yl=t;else for(;yl!==null;){switch(e=yl,s=e.alternate,t=e.flags,e.tag){case 0:break;case 11:case 15:break;case 1:if(t&1024&&s!==null){t=void 0,n=e,r=s.memoizedProps,s=s.memoizedState,i=n.stateNode;try{var p=i1(n.type,r,n.elementType===n.type);t=i.getSnapshotBeforeUpdate(p,s),i.__reactInternalSnapshotBeforeUpdate=t}catch(g){Qs(n,n.return,g)}}break;case 3:if(t&1024){if(t=e.stateNode.containerInfo,n=t.nodeType,n===9)rq(t);else if(n===1)switch(t.nodeName){case"HEAD":case"HTML":case"BODY":rq(t);break;default:t.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if(t&1024)throw Error(Gt(163))}if(t=e.sibling,t!==null){t.return=e.return,yl=t;break}yl=e.return}}function Dfe(t,e,n){var i=n.flags;switch(n.tag){case 0:case 11:case 15:By(t,n),i&4&&ik(5,n);break;case 1:if(By(t,n),i&4)if(t=n.stateNode,e===null)try{t.componentDidMount()}catch(a){Qs(n,n.return,a)}else{var r=i1(n.type,e.memoizedProps);e=e.memoizedState;try{t.componentDidUpdate(r,e,t.__reactInternalSnapshotBeforeUpdate)}catch(a){Qs(n,n.return,a)}}i&64&&Ofe(n),i&512&&_O(n,n.return);break;case 3:if(By(t,n),i&64&&(t=n.updateQueue,t!==null)){if(e=null,n.child!==null)switch(n.child.tag){case 27:case 5:e=n.child.stateNode;break;case 1:e=n.child.stateNode}try{Lde(t,e)}catch(a){Qs(n,n.return,a)}}break;case 27:e===null&&i&4&&Pfe(n);case 26:case 5:By(t,n),e===null&&i&4&&Ife(n),i&512&&_O(n,n.return);break;case 12:By(t,n);break;case 13:By(t,n),i&4&&Bfe(t,n),i&64&&(t=n.memoizedState,t!==null&&(t=t.dehydrated,t!==null&&(n=KLe.bind(null,n),fUe(t,n))));break;case 22:if(i=n.memoizedState!==null||Kv,!i){e=e!==null&&e.memoizedState!==null||qo,r=Kv;var s=qo;Kv=i,(qo=e)&&!s?Xy(t,n,(n.subtreeFlags&8772)!==0):By(t,n),Kv=r,qo=s}break;case 30:break;default:By(t,n)}}function Lfe(t){var e=t.alternate;e!==null&&(t.alternate=null,Lfe(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&VW(e)),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}var Ua=null,Wh=!1;function Iv(t,e,n){for(n=n.child;n!==null;)Ufe(t,e,n),n=n.sibling}function Ufe(t,e,n){if(uf&&typeof uf.onCommitFiberUnmount=="function")try{uf.onCommitFiberUnmount($I,n)}catch{}switch(n.tag){case 26:qo||Vg(n,e),Iv(t,e,n),n.memoizedState?n.memoizedState.count--:n.stateNode&&(n=n.stateNode,n.parentNode.removeChild(n));break;case 27:qo||Vg(n,e);var i=Ua,r=Wh;OE(n.type)&&(Ua=n.stateNode,Wh=!1),Iv(t,e,n),SO(n.stateNode),Ua=i,Wh=r;break;case 5:qo||Vg(n,e);case 6:if(i=Ua,r=Wh,Ua=null,Iv(t,e,n),Ua=i,Wh=r,Ua!==null)if(Wh)try{(Ua.nodeType===9?Ua.body:Ua.nodeName==="HTML"?Ua.ownerDocument.body:Ua).removeChild(n.stateNode)}catch(s){Qs(n,e,s)}else try{Ua.removeChild(n.stateNode)}catch(s){Qs(n,e,s)}break;case 18:Ua!==null&&(Wh?(t=Ua,ete(t.nodeType===9?t.body:t.nodeName==="HTML"?t.ownerDocument.body:t,n.stateNode),yN(t)):ete(Ua,n.stateNode));break;case 4:i=Ua,r=Wh,Ua=n.stateNode.containerInfo,Wh=!0,Iv(t,e,n),Ua=i,Wh=r;break;case 0:case 11:case 14:case 15:qo||iE(2,n,e),qo||iE(4,n,e),Iv(t,e,n);break;case 1:qo||(Vg(n,e),i=n.stateNode,typeof i.componentWillUnmount=="function"&&Nfe(n,e,i)),Iv(t,e,n);break;case 21:Iv(t,e,n);break;case 22:qo=(i=qo)||n.memoizedState!==null,Iv(t,e,n),qo=i;break;default:Iv(t,e,n)}}function Bfe(t,e){if(e.memoizedState===null&&(t=e.alternate,t!==null&&(t=t.memoizedState,t!==null&&(t=t.dehydrated,t!==null))))try{yN(t)}catch(n){Qs(e,e.return,n)}}function jLe(t){switch(t.tag){case 13:case 19:var e=t.stateNode;return e===null&&(e=t.stateNode=new Hee),e;case 22:return t=t.stateNode,e=t._retryCache,e===null&&(e=t._retryCache=new Hee),e;default:throw Error(Gt(435,t.tag))}}function kj(t,e){var n=jLe(t);e.forEach(function(i){var r=XLe.bind(null,t,i);n.has(i)||(n.add(i),i.then(r,r))})}function Gd(t,e){var n=e.deletions;if(n!==null)for(var i=0;i<n.length;i++){var r=n[i],s=t,a=e,o=a;e:for(;o!==null;){switch(o.tag){case 27:if(OE(o.type)){Ua=o.stateNode,Wh=!1;break e}break;case 5:Ua=o.stateNode,Wh=!1;break e;case 3:case 4:Ua=o.stateNode.containerInfo,Wh=!0;break e}o=o.return}if(Ua===null)throw Error(Gt(160));Ufe(s,a,r),Ua=null,Wh=!1,s=r.alternate,s!==null&&(s.return=null),r.return=null}if(e.subtreeFlags&13878)for(e=e.child;e!==null;)Ffe(e,t),e=e.sibling}var um=null;function Ffe(t,e){var n=t.alternate,i=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:Gd(e,t),qd(t),i&4&&(iE(3,t,t.return),ik(3,t),iE(5,t,t.return));break;case 1:Gd(e,t),qd(t),i&512&&(qo||n===null||Vg(n,n.return)),i&64&&Kv&&(t=t.updateQueue,t!==null&&(i=t.callbacks,i!==null&&(n=t.shared.hiddenCallbacks,t.shared.hiddenCallbacks=n===null?i:n.concat(i))));break;case 26:var r=um;if(Gd(e,t),qd(t),i&512&&(qo||n===null||Vg(n,n.return)),i&4){var s=n!==null?n.memoizedState:null;if(i=t.memoizedState,n===null)if(i===null)if(t.stateNode===null){e:{i=t.type,n=t.memoizedProps,r=r.ownerDocument||r;t:switch(i){case"title":s=r.getElementsByTagName("title")[0],(!s||s[KI]||s[_u]||s.namespaceURI==="http://www.w3.org/2000/svg"||s.hasAttribute("itemprop"))&&(s=r.createElement(i),r.head.insertBefore(s,r.querySelector("head > title"))),Xl(s,i,n),s[_u]=t,Sl(s),i=s;break e;case"link":var a=ste("link","href",r).get(i+(n.href||""));if(a){for(var o=0;o<a.length;o++)if(s=a[o],s.getAttribute("href")===(n.href==null||n.href===""?null:n.href)&&s.getAttribute("rel")===(n.rel==null?null:n.rel)&&s.getAttribute("title")===(n.title==null?null:n.title)&&s.getAttribute("crossorigin")===(n.crossOrigin==null?null:n.crossOrigin)){a.splice(o,1);break t}}s=r.createElement(i),Xl(s,i,n),r.head.appendChild(s);break;case"meta":if(a=ste("meta","content",r).get(i+(n.content||""))){for(o=0;o<a.length;o++)if(s=a[o],s.getAttribute("content")===(n.content==null?null:""+n.content)&&s.getAttribute("name")===(n.name==null?null:n.name)&&s.getAttribute("property")===(n.property==null?null:n.property)&&s.getAttribute("http-equiv")===(n.httpEquiv==null?null:n.httpEquiv)&&s.getAttribute("charset")===(n.charSet==null?null:n.charSet)){a.splice(o,1);break t}}s=r.createElement(i),Xl(s,i,n),r.head.appendChild(s);break;default:throw Error(Gt(468,i))}s[_u]=t,Sl(s),i=s}t.stateNode=i}else ate(r,t.type,t.stateNode);else t.stateNode=rte(r,i,t.memoizedProps);else s!==i?(s===null?n.stateNode!==null&&(n=n.stateNode,n.parentNode.removeChild(n)):s.count--,i===null?ate(r,t.type,t.stateNode):rte(r,i,t.memoizedProps)):i===null&&t.stateNode!==null&&Oj(t,t.memoizedProps,n.memoizedProps)}break;case 27:Gd(e,t),qd(t),i&512&&(qo||n===null||Vg(n,n.return)),n!==null&&i&4&&Oj(t,t.memoizedProps,n.memoizedProps);break;case 5:if(Gd(e,t),qd(t),i&512&&(qo||n===null||Vg(n,n.return)),t.flags&32){r=t.stateNode;try{XC(r,"")}catch(f){Qs(t,t.return,f)}}i&4&&t.stateNode!=null&&(r=t.memoizedProps,Oj(t,r,n!==null?n.memoizedProps:r)),i&1024&&(Ij=!0);break;case 6:if(Gd(e,t),qd(t),i&4){if(t.stateNode===null)throw Error(Gt(162));i=t.memoizedProps,n=t.stateNode;try{n.nodeValue=i}catch(f){Qs(t,t.return,f)}}break;case 3:if(X2=null,r=um,um=c3(e.containerInfo),Gd(e,t),um=r,qd(t),i&4&&n!==null&&n.memoizedState.isDehydrated)try{yN(e.containerInfo)}catch(f){Qs(t,t.return,f)}Ij&&(Ij=!1,zfe(t));break;case 4:i=um,um=c3(t.stateNode.containerInfo),Gd(e,t),qd(t),um=i;break;case 12:Gd(e,t),qd(t);break;case 13:Gd(e,t),qd(t),t.child.flags&8192&&t.memoizedState!==null!=(n!==null&&n.memoizedState!==null)&&(S9=Kg()),i&4&&(i=t.updateQueue,i!==null&&(t.updateQueue=null,kj(t,i)));break;case 22:r=t.memoizedState!==null;var c=n!==null&&n.memoizedState!==null,l=Kv,u=qo;if(Kv=l||r,qo=u||c,Gd(e,t),qo=u,Kv=l,qd(t),i&8192)e:for(e=t.stateNode,e._visibility=r?e._visibility&-2:e._visibility|1,r&&(n===null||c||Kv||qo||nT(t)),n=null,e=t;;){if(e.tag===5||e.tag===26){if(n===null){c=n=e;try{if(s=c.stateNode,r)a=s.style,typeof a.setProperty=="function"?a.setProperty("display","none","important"):a.display="none";else{o=c.stateNode;var h=c.memoizedProps.style,d=h!=null&&h.hasOwnProperty("display")?h.display:null;o.style.display=d==null||typeof d=="boolean"?"":(""+d).trim()}}catch(f){Qs(c,c.return,f)}}}else if(e.tag===6){if(n===null){c=e;try{c.stateNode.nodeValue=r?"":c.memoizedProps}catch(f){Qs(c,c.return,f)}}}else if((e.tag!==22&&e.tag!==23||e.memoizedState===null||e===t)&&e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;n===e&&(n=null),e=e.return}n===e&&(n=null),e.sibling.return=e.return,e=e.sibling}i&4&&(i=t.updateQueue,i!==null&&(n=i.retryQueue,n!==null&&(i.retryQueue=null,kj(t,n))));break;case 19:Gd(e,t),qd(t),i&4&&(i=t.updateQueue,i!==null&&(t.updateQueue=null,kj(t,i)));break;case 30:break;case 21:break;default:Gd(e,t),qd(t)}}function qd(t){var e=t.flags;if(e&2){try{for(var n,i=t.return;i!==null;){if(kfe(i)){n=i;break}i=i.return}if(n==null)throw Error(Gt(160));switch(n.tag){case 27:var r=n.stateNode,s=Nj(t);t3(t,s,r);break;case 5:var a=n.stateNode;n.flags&32&&(XC(a,""),n.flags&=-33);var o=Nj(t);t3(t,o,a);break;case 3:case 4:var c=n.stateNode.containerInfo,l=Nj(t);WG(t,l,c);break;default:throw Error(Gt(161))}}catch(u){Qs(t,t.return,u)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function zfe(t){if(t.subtreeFlags&1024)for(t=t.child;t!==null;){var e=t;zfe(e),e.tag===5&&e.flags&1024&&e.stateNode.reset(),t=t.sibling}}function By(t,e){if(e.subtreeFlags&8772)for(e=e.child;e!==null;)Dfe(t,e.alternate,e),e=e.sibling}function nT(t){for(t=t.child;t!==null;){var e=t;switch(e.tag){case 0:case 11:case 14:case 15:iE(4,e,e.return),nT(e);break;case 1:Vg(e,e.return);var n=e.stateNode;typeof n.componentWillUnmount=="function"&&Nfe(e,e.return,n),nT(e);break;case 27:SO(e.stateNode);case 26:case 5:Vg(e,e.return),nT(e);break;case 22:e.memoizedState===null&&nT(e);break;case 30:nT(e);break;default:nT(e)}t=t.sibling}}function Xy(t,e,n){for(n=n&&(e.subtreeFlags&8772)!==0,e=e.child;e!==null;){var i=e.alternate,r=t,s=e,a=s.flags;switch(s.tag){case 0:case 11:case 15:Xy(r,s,n),ik(4,s);break;case 1:if(Xy(r,s,n),i=s,r=i.stateNode,typeof r.componentDidMount=="function")try{r.componentDidMount()}catch(l){Qs(i,i.return,l)}if(i=s,r=i.updateQueue,r!==null){var o=i.stateNode;try{var c=r.shared.hiddenCallbacks;if(c!==null)for(r.shared.hiddenCallbacks=null,r=0;r<c.length;r++)Dde(c[r],o)}catch(l){Qs(i,i.return,l)}}n&&a&64&&Ofe(s),_O(s,s.return);break;case 27:Pfe(s);case 26:case 5:Xy(r,s,n),n&&i===null&&a&4&&Ife(s),_O(s,s.return);break;case 12:Xy(r,s,n);break;case 13:Xy(r,s,n),n&&a&4&&Bfe(r,s);break;case 22:s.memoizedState===null&&Xy(r,s,n),_O(s,s.return);break;case 30:break;default:Xy(r,s,n)}e=e.sibling}}function _9(t,e){var n=null;t!==null&&t.memoizedState!==null&&t.memoizedState.cachePool!==null&&(n=t.memoizedState.cachePool.pool),t=null,e.memoizedState!==null&&e.memoizedState.cachePool!==null&&(t=e.memoizedState.cachePool.pool),t!==n&&(t!=null&&t.refCount++,n!=null&&QI(n))}function y9(t,e){t=null,e.alternate!==null&&(t=e.alternate.memoizedState.cache),e=e.memoizedState.cache,e!==t&&(e.refCount++,t!=null&&QI(t))}function Eg(t,e,n,i){if(e.subtreeFlags&10256)for(e=e.child;e!==null;)jfe(t,e,n,i),e=e.sibling}function jfe(t,e,n,i){var r=e.flags;switch(e.tag){case 0:case 11:case 15:Eg(t,e,n,i),r&2048&&ik(9,e);break;case 1:Eg(t,e,n,i);break;case 3:Eg(t,e,n,i),r&2048&&(t=null,e.alternate!==null&&(t=e.alternate.memoizedState.cache),e=e.memoizedState.cache,e!==t&&(e.refCount++,t!=null&&QI(t)));break;case 12:if(r&2048){Eg(t,e,n,i),t=e.stateNode;try{var s=e.memoizedProps,a=s.id,o=s.onPostCommit;typeof o=="function"&&o(a,e.alternate===null?"mount":"update",t.passiveEffectDuration,-0)}catch(c){Qs(e,e.return,c)}}else Eg(t,e,n,i);break;case 13:Eg(t,e,n,i);break;case 23:break;case 22:s=e.stateNode,a=e.alternate,e.memoizedState!==null?s._visibility&2?Eg(t,e,n,i):yO(t,e):s._visibility&2?Eg(t,e,n,i):(s._visibility|=2,Aw(t,e,n,i,(e.subtreeFlags&10256)!==0)),r&2048&&_9(a,e);break;case 24:Eg(t,e,n,i),r&2048&&y9(e.alternate,e);break;default:Eg(t,e,n,i)}}function Aw(t,e,n,i,r){for(r=r&&(e.subtreeFlags&10256)!==0,e=e.child;e!==null;){var s=t,a=e,o=n,c=i,l=a.flags;switch(a.tag){case 0:case 11:case 15:Aw(s,a,o,c,r),ik(8,a);break;case 23:break;case 22:var u=a.stateNode;a.memoizedState!==null?u._visibility&2?Aw(s,a,o,c,r):yO(s,a):(u._visibility|=2,Aw(s,a,o,c,r)),r&&l&2048&&_9(a.alternate,a);break;case 24:Aw(s,a,o,c,r),r&&l&2048&&y9(a.alternate,a);break;default:Aw(s,a,o,c,r)}e=e.sibling}}function yO(t,e){if(e.subtreeFlags&10256)for(e=e.child;e!==null;){var n=t,i=e,r=i.flags;switch(i.tag){case 22:yO(n,i),r&2048&&_9(i.alternate,i);break;case 24:yO(n,i),r&2048&&y9(i.alternate,i);break;default:yO(n,i)}e=e.sibling}}var BM=8192;function rw(t){if(t.subtreeFlags&BM)for(t=t.child;t!==null;)Hfe(t),t=t.sibling}function Hfe(t){switch(t.tag){case 26:rw(t),t.flags&BM&&t.memoizedState!==null&&CUe(um,t.memoizedState,t.memoizedProps);break;case 5:rw(t);break;case 3:case 4:var e=um;um=c3(t.stateNode.containerInfo),rw(t),um=e;break;case 22:t.memoizedState===null&&(e=t.alternate,e!==null&&e.memoizedState!==null?(e=BM,BM=16777216,rw(t),BM=e):rw(t));break;default:rw(t)}}function Vfe(t){var e=t.alternate;if(e!==null&&(t=e.child,t!==null)){e.child=null;do e=t.sibling,t.sibling=null,t=e;while(t!==null)}}function lM(t){var e=t.deletions;if(t.flags&16){if(e!==null)for(var n=0;n<e.length;n++){var i=e[n];yl=i,qfe(i,t)}Vfe(t)}if(t.subtreeFlags&10256)for(t=t.child;t!==null;)Gfe(t),t=t.sibling}function Gfe(t){switch(t.tag){case 0:case 11:case 15:lM(t),t.flags&2048&&iE(9,t,t.return);break;case 3:lM(t);break;case 12:lM(t);break;case 22:var e=t.stateNode;t.memoizedState!==null&&e._visibility&2&&(t.return===null||t.return.tag!==13)?(e._visibility&=-3,Y2(t)):lM(t);break;default:lM(t)}}function Y2(t){var e=t.deletions;if(t.flags&16){if(e!==null)for(var n=0;n<e.length;n++){var i=e[n];yl=i,qfe(i,t)}Vfe(t)}for(t=t.child;t!==null;){switch(e=t,e.tag){case 0:case 11:case 15:iE(8,e,e.return),Y2(e);break;case 22:n=e.stateNode,n._visibility&2&&(n._visibility&=-3,Y2(e));break;default:Y2(e)}t=t.sibling}}function qfe(t,e){for(;yl!==null;){var n=yl;switch(n.tag){case 0:case 11:case 15:iE(8,n,e);break;case 23:case 22:if(n.memoizedState!==null&&n.memoizedState.cachePool!==null){var i=n.memoizedState.cachePool.pool;i!=null&&i.refCount++}break;case 24:QI(n.memoizedState.cache)}if(i=n.child,i!==null)i.return=n,yl=i;else e:for(n=t;yl!==null;){i=yl;var r=i.sibling,s=i.return;if(Lfe(i),i===n){yl=null;break e}if(r!==null){r.return=s,yl=r;break e}yl=s}}}var HLe={getCacheForType:function(t){var e=yu(zc),n=e.data.get(t);return n===void 0&&(n=t(),e.data.set(t,n)),n}},VLe=typeof WeakMap=="function"?WeakMap:Map,Ps=0,da=null,Rr=null,$r=0,Is=0,Xd=null,xb=!1,aR=!1,b9=!1,R_=0,Ro=0,rE=0,DT=0,E9=0,up=0,tA=0,bO=null,Kh=null,YG=!1,S9=0,n3=1/0,i3=null,Pb=null,Wl=0,Db=null,nA=null,_C=0,KG=0,XG=null,$fe=null,EO=0,ZG=null;function df(){if(Ps&2&&$r!==0)return $r&-$r;if(Ui.T!==null){var t=ZC;return t!==0?t:x9()}return ide()}function Wfe(){up===0&&(up=!($r&536870912)||Es?Qhe():536870912);var t=Ep.current;return t!==null&&(t.flags|=32),up}function ff(t,e,n){(t===da&&(Is===2||Is===9)||t.cancelPendingCommit!==null)&&(iA(t,0),wb(t,$r,up,!1)),YI(t,n),(!(Ps&2)||t!==da)&&(t===da&&(!(Ps&2)&&(DT|=n),Ro===4&&wb(t,$r,up,!1)),_0(t))}function Yfe(t,e,n){if(Ps&6)throw Error(Gt(327));var i=!n&&(e&124)===0&&(e&t.expiredLanes)===0||WI(t,e),r=i?$Le(t,e):Pj(t,e,!0),s=i;do{if(r===0){aR&&!i&&wb(t,e,0,!1);break}else{if(n=t.current.alternate,s&&!GLe(n)){r=Pj(t,e,!1),s=!1;continue}if(r===2){if(s=e,t.errorRecoveryDisabledLanes&s)var a=0;else a=t.pendingLanes&-536870913,a=a!==0?a:a&536870912?536870912:0;if(a!==0){e=a;e:{var o=t;r=bO;var c=o.current.memoizedState.isDehydrated;if(c&&(iA(o,a).flags|=256),a=Pj(o,a,!1),a!==2){if(b9&&!c){o.errorRecoveryDisabledLanes|=s,DT|=s,r=4;break e}s=Kh,Kh=r,s!==null&&(Kh===null?Kh=s:Kh.push.apply(Kh,s))}r=a}if(s=!1,r!==2)continue}}if(r===1){iA(t,0),wb(t,e,0,!0);break}e:{switch(i=t,s=r,s){case 0:case 1:throw Error(Gt(345));case 4:if((e&4194048)!==e)break;case 6:wb(i,e,up,!xb);break e;case 2:Kh=null;break;case 3:case 5:break;default:throw Error(Gt(329))}if((e&62914560)===e&&(r=S9+300-Kg(),10<r)){if(wb(i,e,up,!xb),NF(i,0,!0)!==0)break e;i.timeoutHandle=fpe(Vee.bind(null,i,n,Kh,i3,YG,e,up,DT,tA,xb,s,2,-0,0),r);break e}Vee(i,n,Kh,i3,YG,e,up,DT,tA,xb,s,0,-0,0)}}break}while(!0);_0(t)}function Vee(t,e,n,i,r,s,a,o,c,l,u,h,d,f){if(t.timeoutHandle=-1,h=e.subtreeFlags,(h&8192||(h&16785408)===16785408)&&(mN={stylesheets:null,count:0,unsuspend:wUe},Hfe(e),h=AUe(),h!==null)){t.cancelPendingCommit=h(qee.bind(null,t,e,s,n,i,r,a,o,c,u,1,d,f)),wb(t,s,a,!l);return}qee(t,e,s,n,i,r,a,o,c)}function GLe(t){for(var e=t;;){var n=e.tag;if((n===0||n===11||n===15)&&e.flags&16384&&(n=e.updateQueue,n!==null&&(n=n.stores,n!==null)))for(var i=0;i<n.length;i++){var r=n[i],s=r.getSnapshot;r=r.value;try{if(!gf(s(),r))return!1}catch{return!1}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function wb(t,e,n,i){e&=~E9,e&=~DT,t.suspendedLanes|=e,t.pingedLanes&=~e,i&&(t.warmLanes|=e),i=t.expirationTimes;for(var r=e;0<r;){var s=31-hf(r),a=1<<s;i[s]=-1,r&=~a}n!==0&&tde(t,n,e)}function jF(){return Ps&6?!0:(rk(0),!1)}function T9(){if(Rr!==null){if(Is===0)var t=Rr.return;else t=Rr,s_=z1=null,l9(t),vC=null,dN=0,t=Rr;for(;t!==null;)Mfe(t.alternate,t),t=t.return;Rr=null}}function iA(t,e){var n=t.timeoutHandle;n!==-1&&(t.timeoutHandle=-1,cUe(n)),n=t.cancelPendingCommit,n!==null&&(t.cancelPendingCommit=null,n()),T9(),da=t,Rr=n=d_(t.current,null),$r=e,Is=0,Xd=null,xb=!1,aR=WI(t,e),b9=!1,tA=up=E9=DT=rE=Ro=0,Kh=bO=null,YG=!1,e&8&&(e|=e&32);var i=t.entangledLanes;if(i!==0)for(t=t.entanglements,i&=e;0<i;){var r=31-hf(i),s=1<<r;e|=t[r],i&=~s}return R_=e,DF(),n}function Kfe(t,e){yr=null,Ui.H=XU,e===ek||e===UF?(e=Eee(),Is=3):e===kde?(e=Eee(),Is=4):Is=e===Tfe?8:e!==null&&typeof e=="object"&&typeof e.then=="function"?6:1,Xd=e,Rr===null&&(Ro=1,QU(t,ip(e,t.current)))}function Xfe(){var t=Ui.H;return Ui.H=XU,t===null?XU:t}function Zfe(){var t=Ui.A;return Ui.A=HLe,t}function JG(){Ro=4,xb||($r&4194048)!==$r&&Ep.current!==null||(aR=!0),!(rE&134217727)&&!(DT&134217727)||da===null||wb(da,$r,up,!1)}function Pj(t,e,n){var i=Ps;Ps|=2;var r=Xfe(),s=Zfe();(da!==t||$r!==e)&&(i3=null,iA(t,e)),e=!1;var a=Ro;e:do try{if(Is!==0&&Rr!==null){var o=Rr,c=Xd;switch(Is){case 8:T9(),a=6;break e;case 3:case 2:case 9:case 6:Ep.current===null&&(e=!0);var l=Is;if(Is=0,Xd=null,Jw(t,o,c,l),n&&aR){a=0;break e}break;default:l=Is,Is=0,Xd=null,Jw(t,o,c,l)}}qLe(),a=Ro;break}catch(u){Kfe(t,u)}while(!0);return e&&t.shellSuspendCounter++,s_=z1=null,Ps=i,Ui.H=r,Ui.A=s,Rr===null&&(da=null,$r=0,DF()),a}function qLe(){for(;Rr!==null;)Jfe(Rr)}function $Le(t,e){var n=Ps;Ps|=2;var i=Xfe(),r=Zfe();da!==t||$r!==e?(i3=null,n3=Kg()+500,iA(t,e)):aR=WI(t,e);e:do try{if(Is!==0&&Rr!==null){e=Rr;var s=Xd;t:switch(Is){case 1:Is=0,Xd=null,Jw(t,e,s,1);break;case 2:case 9:if(bee(s)){Is=0,Xd=null,Gee(e);break}e=function(){Is!==2&&Is!==9||da!==t||(Is=7),_0(t)},s.then(e,e);break e;case 3:Is=7;break e;case 4:Is=5;break e;case 7:bee(s)?(Is=0,Xd=null,Gee(e)):(Is=0,Xd=null,Jw(t,e,s,7));break;case 5:var a=null;switch(Rr.tag){case 26:a=Rr.memoizedState;case 5:case 27:var o=Rr;if(!a||vpe(a)){Is=0,Xd=null;var c=o.sibling;if(c!==null)Rr=c;else{var l=o.return;l!==null?(Rr=l,HF(l)):Rr=null}break t}}Is=0,Xd=null,Jw(t,e,s,5);break;case 6:Is=0,Xd=null,Jw(t,e,s,6);break;case 8:T9(),Ro=6;break e;default:throw Error(Gt(462))}}WLe();break}catch(u){Kfe(t,u)}while(!0);return s_=z1=null,Ui.H=i,Ui.A=r,Ps=n,Rr!==null?0:(da=null,$r=0,DF(),Ro)}function WLe(){for(;Rr!==null&&!m2e();)Jfe(Rr)}function Jfe(t){var e=Rfe(t.alternate,t,R_);t.memoizedProps=t.pendingProps,e===null?HF(t):Rr=e}function Gee(t){var e=t,n=e.alternate;switch(e.tag){case 15:case 0:e=Uee(n,e,e.pendingProps,e.type,void 0,$r);break;case 11:e=Uee(n,e,e.pendingProps,e.type.render,e.ref,$r);break;case 5:l9(e);default:Mfe(n,e),e=Rr=Mde(e,R_),e=Rfe(n,e,R_)}t.memoizedProps=t.pendingProps,e===null?HF(t):Rr=e}function Jw(t,e,n,i){s_=z1=null,l9(e),vC=null,dN=0;var r=e.return;try{if(LLe(t,r,e,n,$r)){Ro=1,QU(t,ip(n,t.current)),Rr=null;return}}catch(s){if(r!==null)throw Rr=r,s;Ro=1,QU(t,ip(n,t.current)),Rr=null;return}e.flags&32768?(Es||i===1?t=!0:aR||$r&536870912?t=!1:(xb=t=!0,(i===2||i===9||i===3||i===6)&&(i=Ep.current,i!==null&&i.tag===13&&(i.flags|=16384))),Qfe(e,t)):HF(e)}function HF(t){var e=t;do{if(e.flags&32768){Qfe(e,xb);return}t=e.return;var n=BLe(e.alternate,e,R_);if(n!==null){Rr=n;return}if(e=e.sibling,e!==null){Rr=e;return}Rr=e=t}while(e!==null);Ro===0&&(Ro=5)}function Qfe(t,e){do{var n=FLe(t.alternate,t);if(n!==null){n.flags&=32767,Rr=n;return}if(n=t.return,n!==null&&(n.flags|=32768,n.subtreeFlags=0,n.deletions=null),!e&&(t=t.sibling,t!==null)){Rr=t;return}Rr=t=n}while(t!==null);Ro=6,Rr=null}function qee(t,e,n,i,r,s,a,o,c){t.cancelPendingCommit=null;do VF();while(Wl!==0);if(Ps&6)throw Error(Gt(327));if(e!==null){if(e===t.current)throw Error(Gt(177));if(s=e.lanes|e.childLanes,s|=XW,w2e(t,n,s,a,o,c),t===da&&(Rr=da=null,$r=0),nA=e,Db=t,_C=n,KG=s,XG=r,$fe=i,e.subtreeFlags&10256||e.flags&10256?(t.callbackNode=null,t.callbackPriority=0,ZLe(zU,function(){return rpe(),null})):(t.callbackNode=null,t.callbackPriority=0),i=(e.flags&13878)!==0,e.subtreeFlags&13878||i){i=Ui.T,Ui.T=null,r=Ts.p,Ts.p=2,a=Ps,Ps|=4;try{zLe(t,e,n)}finally{Ps=a,Ts.p=r,Ui.T=i}}Wl=1,epe(),tpe(),npe()}}function epe(){if(Wl===1){Wl=0;var t=Db,e=nA,n=(e.flags&13878)!==0;if(e.subtreeFlags&13878||n){n=Ui.T,Ui.T=null;var i=Ts.p;Ts.p=2;var r=Ps;Ps|=4;try{Ffe(e,t);var s=nq,a=Ede(t.containerInfo),o=s.focusedElem,c=s.selectionRange;if(a!==o&&o&&o.ownerDocument&&bde(o.ownerDocument.documentElement,o)){if(c!==null&&KW(o)){var l=c.start,u=c.end;if(u===void 0&&(u=l),"selectionStart"in o)o.selectionStart=l,o.selectionEnd=Math.min(u,o.value.length);else{var h=o.ownerDocument||document,d=h&&h.defaultView||window;if(d.getSelection){var f=d.getSelection(),p=o.textContent.length,g=Math.min(c.start,p),_=c.end===void 0?g:Math.min(c.end,p);!f.extend&&g>_&&(a=_,_=g,g=a);var v=dee(o,g),b=dee(o,_);if(v&&b&&(f.rangeCount!==1||f.anchorNode!==v.node||f.anchorOffset!==v.offset||f.focusNode!==b.node||f.focusOffset!==b.offset)){var S=h.createRange();S.setStart(v.node,v.offset),f.removeAllRanges(),g>_?(f.addRange(S),f.extend(b.node,b.offset)):(S.setEnd(b.node,b.offset),f.addRange(S))}}}}for(h=[],f=o;f=f.parentNode;)f.nodeType===1&&h.push({element:f,left:f.scrollLeft,top:f.scrollTop});for(typeof o.focus=="function"&&o.focus(),o=0;o<h.length;o++){var x=h[o];x.element.scrollLeft=x.left,x.element.scrollTop=x.top}}h3=!!tq,nq=tq=null}finally{Ps=r,Ts.p=i,Ui.T=n}}t.current=e,Wl=2}}function tpe(){if(Wl===2){Wl=0;var t=Db,e=nA,n=(e.flags&8772)!==0;if(e.subtreeFlags&8772||n){n=Ui.T,Ui.T=null;var i=Ts.p;Ts.p=2;var r=Ps;Ps|=4;try{Dfe(t,e.alternate,e)}finally{Ps=r,Ts.p=i,Ui.T=n}}Wl=3}}function npe(){if(Wl===4||Wl===3){Wl=0,g2e();var t=Db,e=nA,n=_C,i=$fe;e.subtreeFlags&10256||e.flags&10256?Wl=5:(Wl=0,nA=Db=null,ipe(t,t.pendingLanes));var r=t.pendingLanes;if(r===0&&(Pb=null),HW(n),e=e.stateNode,uf&&typeof uf.onCommitFiberRoot=="function")try{uf.onCommitFiberRoot($I,e,void 0,(e.current.flags&128)===128)}catch{}if(i!==null){e=Ui.T,r=Ts.p,Ts.p=2,Ui.T=null;try{for(var s=t.onRecoverableError,a=0;a<i.length;a++){var o=i[a];s(o.value,{componentStack:o.stack})}}finally{Ui.T=e,Ts.p=r}}_C&3&&VF(),_0(t),r=t.pendingLanes,n&4194090&&r&42?t===ZG?EO++:(EO=0,ZG=t):EO=0,rk(0)}}function ipe(t,e){(t.pooledCacheLanes&=e)===0&&(e=t.pooledCache,e!=null&&(t.pooledCache=null,QI(e)))}function VF(t){return epe(),tpe(),npe(),rpe()}function rpe(){if(Wl!==5)return!1;var t=Db,e=KG;KG=0;var n=HW(_C),i=Ui.T,r=Ts.p;try{Ts.p=32>n?32:n,Ui.T=null,n=XG,XG=null;var s=Db,a=_C;if(Wl=0,nA=Db=null,_C=0,Ps&6)throw Error(Gt(331));var o=Ps;if(Ps|=4,Gfe(s.current),jfe(s,s.current,a,n),Ps=o,rk(0,!1),uf&&typeof uf.onPostCommitFiberRoot=="function")try{uf.onPostCommitFiberRoot($I,s)}catch{}return!0}finally{Ts.p=r,Ui.T=i,ipe(t,e)}}function $ee(t,e,n){e=ip(n,e),e=GG(t.stateNode,e,2),t=kb(t,e,2),t!==null&&(YI(t,2),_0(t))}function Qs(t,e,n){if(t.tag===3)$ee(t,t,n);else for(;e!==null;){if(e.tag===3){$ee(e,t,n);break}else if(e.tag===1){var i=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof i.componentDidCatch=="function"&&(Pb===null||!Pb.has(i))){t=ip(n,t),n=Efe(2),i=kb(e,n,2),i!==null&&(Sfe(n,i,e,t),YI(i,2),_0(i));break}}e=e.return}}function Dj(t,e,n){var i=t.pingCache;if(i===null){i=t.pingCache=new VLe;var r=new Set;i.set(e,r)}else r=i.get(e),r===void 0&&(r=new Set,i.set(e,r));r.has(n)||(b9=!0,r.add(n),t=YLe.bind(null,t,e,n),e.then(t,t))}function YLe(t,e,n){var i=t.pingCache;i!==null&&i.delete(e),t.pingedLanes|=t.suspendedLanes&n,t.warmLanes&=~n,da===t&&($r&n)===n&&(Ro===4||Ro===3&&($r&62914560)===$r&&300>Kg()-S9?!(Ps&2)&&iA(t,0):E9|=n,tA===$r&&(tA=0)),_0(t)}function spe(t,e){e===0&&(e=ede()),t=sR(t,e),t!==null&&(YI(t,e),_0(t))}function KLe(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),spe(t,n)}function XLe(t,e){var n=0;switch(t.tag){case 13:var i=t.stateNode,r=t.memoizedState;r!==null&&(n=r.retryLane);break;case 19:i=t.stateNode;break;case 22:i=t.stateNode._retryCache;break;default:throw Error(Gt(314))}i!==null&&i.delete(e),spe(t,n)}function ZLe(t,e){return zW(t,e)}var r3=null,Rw=null,QG=!1,s3=!1,Lj=!1,LT=0;function _0(t){t!==Rw&&t.next===null&&(Rw===null?r3=Rw=t:Rw=Rw.next=t),s3=!0,QG||(QG=!0,QLe())}function rk(t,e){if(!Lj&&s3){Lj=!0;do for(var n=!1,i=r3;i!==null;){if(t!==0){var r=i.pendingLanes;if(r===0)var s=0;else{var a=i.suspendedLanes,o=i.pingedLanes;s=(1<<31-hf(42|t)+1)-1,s&=r&~(a&~o),s=s&201326741?s&201326741|1:s?s|2:0}s!==0&&(n=!0,Wee(i,s))}else s=$r,s=NF(i,i===da?s:0,i.cancelPendingCommit!==null||i.timeoutHandle!==-1),!(s&3)||WI(i,s)||(n=!0,Wee(i,s));i=i.next}while(n);Lj=!1}}function JLe(){ape()}function ape(){s3=QG=!1;var t=0;LT!==0&&(oUe()&&(t=LT),LT=0);for(var e=Kg(),n=null,i=r3;i!==null;){var r=i.next,s=ope(i,e);s===0?(i.next=null,n===null?r3=r:n.next=r,r===null&&(Rw=n)):(n=i,(t!==0||s&3)&&(s3=!0)),i=r}rk(t)}function ope(t,e){for(var n=t.suspendedLanes,i=t.pingedLanes,r=t.expirationTimes,s=t.pendingLanes&-62914561;0<s;){var a=31-hf(s),o=1<<a,c=r[a];c===-1?(!(o&n)||o&i)&&(r[a]=x2e(o,e)):c<=e&&(t.expiredLanes|=o),s&=~o}if(e=da,n=$r,n=NF(t,t===e?n:0,t.cancelPendingCommit!==null||t.timeoutHandle!==-1),i=t.callbackNode,n===0||t===e&&(Is===2||Is===9)||t.cancelPendingCommit!==null)return i!==null&&i!==null&&cj(i),t.callbackNode=null,t.callbackPriority=0;if(!(n&3)||WI(t,n)){if(e=n&-n,e===t.callbackPriority)return e;switch(i!==null&&cj(i),HW(n)){case 2:case 8:n=Zhe;break;case 32:n=zU;break;case 268435456:n=Jhe;break;default:n=zU}return i=cpe.bind(null,t),n=zW(n,i),t.callbackPriority=e,t.callbackNode=n,e}return i!==null&&i!==null&&cj(i),t.callbackPriority=2,t.callbackNode=null,2}function cpe(t,e){if(Wl!==0&&Wl!==5)return t.callbackNode=null,t.callbackPriority=0,null;var n=t.callbackNode;if(VF()&&t.callbackNode!==n)return null;var i=$r;return i=NF(t,t===da?i:0,t.cancelPendingCommit!==null||t.timeoutHandle!==-1),i===0?null:(Yfe(t,i,e),ope(t,Kg()),t.callbackNode!=null&&t.callbackNode===n?cpe.bind(null,t):null)}function Wee(t,e){if(VF())return null;Yfe(t,e,!0)}function QLe(){lUe(function(){Ps&6?zW(Xhe,JLe):ape()})}function x9(){return LT===0&&(LT=Qhe()),LT}function Yee(t){return t==null||typeof t=="symbol"||typeof t=="boolean"?null:typeof t=="function"?t:z2(""+t)}function Kee(t,e){var n=e.ownerDocument.createElement("input");return n.name=e.name,n.value=e.value,t.id&&n.setAttribute("form",t.id),e.parentNode.insertBefore(n,e),t=new FormData(t),n.parentNode.removeChild(n),t}function eUe(t,e,n,i,r){if(e==="submit"&&n&&n.stateNode===r){var s=Yee((r[fd]||null).action),a=i.submitter;a&&(e=(e=a[fd]||null)?Yee(e.formAction):a.getAttribute("formAction"),e!==null&&(s=e,a=null));var o=new IF("action","action",null,i,r);t.push({event:o,listeners:[{instance:null,listener:function(){if(i.defaultPrevented){if(LT!==0){var c=a?Kee(r,a):new FormData(r);HG(n,{pending:!0,data:c,method:r.method,action:s},null,c)}}else typeof s=="function"&&(o.preventDefault(),c=a?Kee(r,a):new FormData(r),HG(n,{pending:!0,data:c,method:r.method,action:s},s,c))},currentTarget:r}]})}}for(var Uj=0;Uj<OG.length;Uj++){var Bj=OG[Uj],tUe=Bj.toLowerCase(),nUe=Bj[0].toUpperCase()+Bj.slice(1);Dm(tUe,"on"+nUe)}Dm(Tde,"onAnimationEnd");Dm(xde,"onAnimationIteration");Dm(wde,"onAnimationStart");Dm("dblclick","onDoubleClick");Dm("focusin","onFocus");Dm("focusout","onBlur");Dm(yLe,"onTransitionRun");Dm(bLe,"onTransitionStart");Dm(ELe,"onTransitionCancel");Dm(Cde,"onTransitionEnd");KC("onMouseEnter",["mouseout","mouseover"]);KC("onMouseLeave",["mouseout","mouseover"]);KC("onPointerEnter",["pointerout","pointerover"]);KC("onPointerLeave",["pointerout","pointerover"]);U1("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));U1("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));U1("onBeforeInput",["compositionend","keypress","textInput","paste"]);U1("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));U1("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));U1("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var fN="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),iUe=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(fN));function lpe(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var i=t[n],r=i.event;i=i.listeners;e:{var s=void 0;if(e)for(var a=i.length-1;0<=a;a--){var o=i[a],c=o.instance,l=o.currentTarget;if(o=o.listener,c!==s&&r.isPropagationStopped())break e;s=o,r.currentTarget=l;try{s(r)}catch(u){JU(u)}r.currentTarget=null,s=c}else for(a=0;a<i.length;a++){if(o=i[a],c=o.instance,l=o.currentTarget,o=o.listener,c!==s&&r.isPropagationStopped())break e;s=o,r.currentTarget=l;try{s(r)}catch(u){JU(u)}r.currentTarget=null,s=c}}}}function Ar(t,e){var n=e[TG];n===void 0&&(n=e[TG]=new Set);var i=t+"__bubble";n.has(i)||(upe(e,t,2,!1),n.add(i))}function Fj(t,e,n){var i=0;e&&(i|=4),upe(n,t,i,e)}var ND="_reactListening"+Math.random().toString(36).slice(2);function w9(t){if(!t[ND]){t[ND]=!0,rde.forEach(function(n){n!=="selectionchange"&&(iUe.has(n)||Fj(n,!1,t),Fj(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[ND]||(e[ND]=!0,Fj("selectionchange",!1,e))}}function upe(t,e,n,i){switch(Spe(e)){case 2:var r=OUe;break;case 8:r=NUe;break;default:r=M9}n=r.bind(null,e,n,t),r=void 0,!AG||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(r=!0),i?r!==void 0?t.addEventListener(e,n,{capture:!0,passive:r}):t.addEventListener(e,n,!0):r!==void 0?t.addEventListener(e,n,{passive:r}):t.addEventListener(e,n,!1)}function zj(t,e,n,i,r){var s=i;if(!(e&1)&&!(e&2)&&i!==null)e:for(;;){if(i===null)return;var a=i.tag;if(a===3||a===4){var o=i.stateNode.containerInfo;if(o===r)break;if(a===4)for(a=i.return;a!==null;){var c=a.tag;if((c===3||c===4)&&a.stateNode.containerInfo===r)return;a=a.return}for(;o!==null;){if(a=Vw(o),a===null)return;if(c=a.tag,c===5||c===6||c===26||c===27){i=s=a;continue e}o=o.parentNode}}i=i.return}dde(function(){var l=s,u=qW(n),h=[];e:{var d=Ade.get(t);if(d!==void 0){var f=IF,p=t;switch(t){case"keypress":if(H2(n)===0)break e;case"keydown":case"keyup":f=Z2e;break;case"focusin":p="focus",f=gj;break;case"focusout":p="blur",f=gj;break;case"beforeblur":case"afterblur":f=gj;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":f=nee;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":f=F2e;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":f=eLe;break;case Tde:case xde:case wde:f=H2e;break;case Cde:f=nLe;break;case"scroll":case"scrollend":f=U2e;break;case"wheel":f=rLe;break;case"copy":case"cut":case"paste":f=G2e;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":f=ree;break;case"toggle":case"beforetoggle":f=aLe}var g=(e&4)!==0,_=!g&&(t==="scroll"||t==="scrollend"),v=g?d!==null?d+"Capture":null:d;g=[];for(var b=l,S;b!==null;){var x=b;if(S=x.stateNode,x=x.tag,x!==5&&x!==26&&x!==27||S===null||v===null||(x=oN(b,v),x!=null&&g.push(pN(b,x,S))),_)break;b=b.return}0<g.length&&(d=new f(d,p,null,n,u),h.push({event:d,listeners:g}))}}if(!(e&7)){e:{if(d=t==="mouseover"||t==="pointerover",f=t==="mouseout"||t==="pointerout",d&&n!==CG&&(p=n.relatedTarget||n.fromElement)&&(Vw(p)||p[iR]))break e;if((f||d)&&(d=u.window===u?u:(d=u.ownerDocument)?d.defaultView||d.parentWindow:window,f?(p=n.relatedTarget||n.toElement,f=l,p=p?Vw(p):null,p!==null&&(_=qI(p),g=p.tag,p!==_||g!==5&&g!==27&&g!==6)&&(p=null)):(f=null,p=l),f!==p)){if(g=nee,x="onMouseLeave",v="onMouseEnter",b="mouse",(t==="pointerout"||t==="pointerover")&&(g=ree,x="onPointerLeave",v="onPointerEnter",b="pointer"),_=f==null?d:UM(f),S=p==null?d:UM(p),d=new g(x,b+"leave",f,n,u),d.target=_,d.relatedTarget=S,x=null,Vw(u)===l&&(g=new g(v,b+"enter",p,n,u),g.target=S,g.relatedTarget=_,x=g),_=x,f&&p)t:{for(g=f,v=p,b=0,S=g;S;S=sw(S))b++;for(S=0,x=v;x;x=sw(x))S++;for(;0<b-S;)g=sw(g),b--;for(;0<S-b;)v=sw(v),S--;for(;b--;){if(g===v||v!==null&&g===v.alternate)break t;g=sw(g),v=sw(v)}g=null}else g=null;f!==null&&Xee(h,d,f,g,!1),p!==null&&_!==null&&Xee(h,_,p,g,!0)}}e:{if(d=l?UM(l):window,f=d.nodeName&&d.nodeName.toLowerCase(),f==="select"||f==="input"&&d.type==="file")var M=cee;else if(oee(d))if(_de)M=gLe;else{M=pLe;var R=fLe}else f=d.nodeName,!f||f.toLowerCase()!=="input"||d.type!=="checkbox"&&d.type!=="radio"?l&&GW(l.elementType)&&(M=cee):M=mLe;if(M&&(M=M(t,l))){vde(h,M,n,u);break e}R&&R(t,d,l),t==="focusout"&&l&&d.type==="number"&&l.memoizedProps.value!=null&&wG(d,"number",d.value)}switch(R=l?UM(l):window,t){case"focusin":(oee(R)||R.contentEditable==="true")&&($w=R,RG=l,hO=null);break;case"focusout":hO=RG=$w=null;break;case"mousedown":MG=!0;break;case"contextmenu":case"mouseup":case"dragend":MG=!1,fee(h,n,u);break;case"selectionchange":if(_Le)break;case"keydown":case"keyup":fee(h,n,u)}var I;if(YW)e:{switch(t){case"compositionstart":var k="onCompositionStart";break e;case"compositionend":k="onCompositionEnd";break e;case"compositionupdate":k="onCompositionUpdate";break e}k=void 0}else qw?mde(t,n)&&(k="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(k="onCompositionStart");k&&(pde&&n.locale!=="ko"&&(qw||k!=="onCompositionStart"?k==="onCompositionEnd"&&qw&&(I=fde()):(Tb=u,$W="value"in Tb?Tb.value:Tb.textContent,qw=!0)),R=a3(l,k),0<R.length&&(k=new iee(k,t,null,n,u),h.push({event:k,listeners:R}),I?k.data=I:(I=gde(n),I!==null&&(k.data=I)))),(I=cLe?lLe(t,n):uLe(t,n))&&(k=a3(l,"onBeforeInput"),0<k.length&&(R=new iee("onBeforeInput","beforeinput",null,n,u),h.push({event:R,listeners:k}),R.data=I)),eUe(h,t,l,n,u)}lpe(h,e)})}function pN(t,e,n){return{instance:t,listener:e,currentTarget:n}}function a3(t,e){for(var n=e+"Capture",i=[];t!==null;){var r=t,s=r.stateNode;if(r=r.tag,r!==5&&r!==26&&r!==27||s===null||(r=oN(t,n),r!=null&&i.unshift(pN(t,r,s)),r=oN(t,e),r!=null&&i.push(pN(t,r,s))),t.tag===3)return i;t=t.return}return[]}function sw(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5&&t.tag!==27);return t||null}function Xee(t,e,n,i,r){for(var s=e._reactName,a=[];n!==null&&n!==i;){var o=n,c=o.alternate,l=o.stateNode;if(o=o.tag,c!==null&&c===i)break;o!==5&&o!==26&&o!==27||l===null||(c=l,r?(l=oN(n,s),l!=null&&a.unshift(pN(n,l,c))):r||(l=oN(n,s),l!=null&&a.push(pN(n,l,c)))),n=n.return}a.length!==0&&t.push({event:e,listeners:a})}var rUe=/\r\n?/g,sUe=/\u0000|\uFFFD/g;function Zee(t){return(typeof t=="string"?t:""+t).replace(rUe,`
`).replace(sUe,"")}function hpe(t,e){return e=Zee(e),Zee(t)===e}function GF(){}function Vs(t,e,n,i,r,s){switch(n){case"children":typeof i=="string"?e==="body"||e==="textarea"&&i===""||XC(t,i):(typeof i=="number"||typeof i=="bigint")&&e!=="body"&&XC(t,""+i);break;case"className":xD(t,"class",i);break;case"tabIndex":xD(t,"tabindex",i);break;case"dir":case"role":case"viewBox":case"width":case"height":xD(t,n,i);break;case"style":hde(t,i,s);break;case"data":if(e!=="object"){xD(t,"data",i);break}case"src":case"href":if(i===""&&(e!=="a"||n!=="href")){t.removeAttribute(n);break}if(i==null||typeof i=="function"||typeof i=="symbol"||typeof i=="boolean"){t.removeAttribute(n);break}i=z2(""+i),t.setAttribute(n,i);break;case"action":case"formAction":if(typeof i=="function"){t.setAttribute(n,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof s=="function"&&(n==="formAction"?(e!=="input"&&Vs(t,e,"name",r.name,r,null),Vs(t,e,"formEncType",r.formEncType,r,null),Vs(t,e,"formMethod",r.formMethod,r,null),Vs(t,e,"formTarget",r.formTarget,r,null)):(Vs(t,e,"encType",r.encType,r,null),Vs(t,e,"method",r.method,r,null),Vs(t,e,"target",r.target,r,null)));if(i==null||typeof i=="symbol"||typeof i=="boolean"){t.removeAttribute(n);break}i=z2(""+i),t.setAttribute(n,i);break;case"onClick":i!=null&&(t.onclick=GF);break;case"onScroll":i!=null&&Ar("scroll",t);break;case"onScrollEnd":i!=null&&Ar("scrollend",t);break;case"dangerouslySetInnerHTML":if(i!=null){if(typeof i!="object"||!("__html"in i))throw Error(Gt(61));if(n=i.__html,n!=null){if(r.children!=null)throw Error(Gt(60));t.innerHTML=n}}break;case"multiple":t.multiple=i&&typeof i!="function"&&typeof i!="symbol";break;case"muted":t.muted=i&&typeof i!="function"&&typeof i!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(i==null||typeof i=="function"||typeof i=="boolean"||typeof i=="symbol"){t.removeAttribute("xlink:href");break}n=z2(""+i),t.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",n);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":i!=null&&typeof i!="function"&&typeof i!="symbol"?t.setAttribute(n,""+i):t.removeAttribute(n);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":i&&typeof i!="function"&&typeof i!="symbol"?t.setAttribute(n,""):t.removeAttribute(n);break;case"capture":case"download":i===!0?t.setAttribute(n,""):i!==!1&&i!=null&&typeof i!="function"&&typeof i!="symbol"?t.setAttribute(n,i):t.removeAttribute(n);break;case"cols":case"rows":case"size":case"span":i!=null&&typeof i!="function"&&typeof i!="symbol"&&!isNaN(i)&&1<=i?t.setAttribute(n,i):t.removeAttribute(n);break;case"rowSpan":case"start":i==null||typeof i=="function"||typeof i=="symbol"||isNaN(i)?t.removeAttribute(n):t.setAttribute(n,i);break;case"popover":Ar("beforetoggle",t),Ar("toggle",t),F2(t,"popover",i);break;case"xlinkActuate":Ov(t,"http://www.w3.org/1999/xlink","xlink:actuate",i);break;case"xlinkArcrole":Ov(t,"http://www.w3.org/1999/xlink","xlink:arcrole",i);break;case"xlinkRole":Ov(t,"http://www.w3.org/1999/xlink","xlink:role",i);break;case"xlinkShow":Ov(t,"http://www.w3.org/1999/xlink","xlink:show",i);break;case"xlinkTitle":Ov(t,"http://www.w3.org/1999/xlink","xlink:title",i);break;case"xlinkType":Ov(t,"http://www.w3.org/1999/xlink","xlink:type",i);break;case"xmlBase":Ov(t,"http://www.w3.org/XML/1998/namespace","xml:base",i);break;case"xmlLang":Ov(t,"http://www.w3.org/XML/1998/namespace","xml:lang",i);break;case"xmlSpace":Ov(t,"http://www.w3.org/XML/1998/namespace","xml:space",i);break;case"is":F2(t,"is",i);break;case"innerText":case"textContent":break;default:(!(2<n.length)||n[0]!=="o"&&n[0]!=="O"||n[1]!=="n"&&n[1]!=="N")&&(n=D2e.get(n)||n,F2(t,n,i))}}function eq(t,e,n,i,r,s){switch(n){case"style":hde(t,i,s);break;case"dangerouslySetInnerHTML":if(i!=null){if(typeof i!="object"||!("__html"in i))throw Error(Gt(61));if(n=i.__html,n!=null){if(r.children!=null)throw Error(Gt(60));t.innerHTML=n}}break;case"children":typeof i=="string"?XC(t,i):(typeof i=="number"||typeof i=="bigint")&&XC(t,""+i);break;case"onScroll":i!=null&&Ar("scroll",t);break;case"onScrollEnd":i!=null&&Ar("scrollend",t);break;case"onClick":i!=null&&(t.onclick=GF);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!sde.hasOwnProperty(n))e:{if(n[0]==="o"&&n[1]==="n"&&(r=n.endsWith("Capture"),e=n.slice(2,r?n.length-7:void 0),s=t[fd]||null,s=s!=null?s[n]:null,typeof s=="function"&&t.removeEventListener(e,s,r),typeof i=="function")){typeof s!="function"&&s!==null&&(n in t?t[n]=null:t.hasAttribute(n)&&t.removeAttribute(n)),t.addEventListener(e,i,r);break e}n in t?t[n]=i:i===!0?t.setAttribute(n,""):F2(t,n,i)}}}function Xl(t,e,n){switch(e){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Ar("error",t),Ar("load",t);var i=!1,r=!1,s;for(s in n)if(n.hasOwnProperty(s)){var a=n[s];if(a!=null)switch(s){case"src":i=!0;break;case"srcSet":r=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(Gt(137,e));default:Vs(t,e,s,a,n,null)}}r&&Vs(t,e,"srcSet",n.srcSet,n,null),i&&Vs(t,e,"src",n.src,n,null);return;case"input":Ar("invalid",t);var o=s=a=r=null,c=null,l=null;for(i in n)if(n.hasOwnProperty(i)){var u=n[i];if(u!=null)switch(i){case"name":r=u;break;case"type":a=u;break;case"checked":c=u;break;case"defaultChecked":l=u;break;case"value":s=u;break;case"defaultValue":o=u;break;case"children":case"dangerouslySetInnerHTML":if(u!=null)throw Error(Gt(137,e));break;default:Vs(t,e,i,u,n,null)}}cde(t,s,o,c,l,a,r,!1),jU(t);return;case"select":Ar("invalid",t),i=a=s=null;for(r in n)if(n.hasOwnProperty(r)&&(o=n[r],o!=null))switch(r){case"value":s=o;break;case"defaultValue":a=o;break;case"multiple":i=o;default:Vs(t,e,r,o,n,null)}e=s,n=a,t.multiple=!!i,e!=null?dC(t,!!i,e,!1):n!=null&&dC(t,!!i,n,!0);return;case"textarea":Ar("invalid",t),s=r=i=null;for(a in n)if(n.hasOwnProperty(a)&&(o=n[a],o!=null))switch(a){case"value":i=o;break;case"defaultValue":r=o;break;case"children":s=o;break;case"dangerouslySetInnerHTML":if(o!=null)throw Error(Gt(91));break;default:Vs(t,e,a,o,n,null)}ude(t,i,r,s),jU(t);return;case"option":for(c in n)if(n.hasOwnProperty(c)&&(i=n[c],i!=null))switch(c){case"selected":t.selected=i&&typeof i!="function"&&typeof i!="symbol";break;default:Vs(t,e,c,i,n,null)}return;case"dialog":Ar("beforetoggle",t),Ar("toggle",t),Ar("cancel",t),Ar("close",t);break;case"iframe":case"object":Ar("load",t);break;case"video":case"audio":for(i=0;i<fN.length;i++)Ar(fN[i],t);break;case"image":Ar("error",t),Ar("load",t);break;case"details":Ar("toggle",t);break;case"embed":case"source":case"link":Ar("error",t),Ar("load",t);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(l in n)if(n.hasOwnProperty(l)&&(i=n[l],i!=null))switch(l){case"children":case"dangerouslySetInnerHTML":throw Error(Gt(137,e));default:Vs(t,e,l,i,n,null)}return;default:if(GW(e)){for(u in n)n.hasOwnProperty(u)&&(i=n[u],i!==void 0&&eq(t,e,u,i,n,void 0));return}}for(o in n)n.hasOwnProperty(o)&&(i=n[o],i!=null&&Vs(t,e,o,i,n,null))}function aUe(t,e,n,i){switch(e){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var r=null,s=null,a=null,o=null,c=null,l=null,u=null;for(f in n){var h=n[f];if(n.hasOwnProperty(f)&&h!=null)switch(f){case"checked":break;case"value":break;case"defaultValue":c=h;default:i.hasOwnProperty(f)||Vs(t,e,f,null,i,h)}}for(var d in i){var f=i[d];if(h=n[d],i.hasOwnProperty(d)&&(f!=null||h!=null))switch(d){case"type":s=f;break;case"name":r=f;break;case"checked":l=f;break;case"defaultChecked":u=f;break;case"value":a=f;break;case"defaultValue":o=f;break;case"children":case"dangerouslySetInnerHTML":if(f!=null)throw Error(Gt(137,e));break;default:f!==h&&Vs(t,e,d,f,i,h)}}xG(t,a,o,c,l,u,s,r);return;case"select":f=a=o=d=null;for(s in n)if(c=n[s],n.hasOwnProperty(s)&&c!=null)switch(s){case"value":break;case"multiple":f=c;default:i.hasOwnProperty(s)||Vs(t,e,s,null,i,c)}for(r in i)if(s=i[r],c=n[r],i.hasOwnProperty(r)&&(s!=null||c!=null))switch(r){case"value":d=s;break;case"defaultValue":o=s;break;case"multiple":a=s;default:s!==c&&Vs(t,e,r,s,i,c)}e=o,n=a,i=f,d!=null?dC(t,!!n,d,!1):!!i!=!!n&&(e!=null?dC(t,!!n,e,!0):dC(t,!!n,n?[]:"",!1));return;case"textarea":f=d=null;for(o in n)if(r=n[o],n.hasOwnProperty(o)&&r!=null&&!i.hasOwnProperty(o))switch(o){case"value":break;case"children":break;default:Vs(t,e,o,null,i,r)}for(a in i)if(r=i[a],s=n[a],i.hasOwnProperty(a)&&(r!=null||s!=null))switch(a){case"value":d=r;break;case"defaultValue":f=r;break;case"children":break;case"dangerouslySetInnerHTML":if(r!=null)throw Error(Gt(91));break;default:r!==s&&Vs(t,e,a,r,i,s)}lde(t,d,f);return;case"option":for(var p in n)if(d=n[p],n.hasOwnProperty(p)&&d!=null&&!i.hasOwnProperty(p))switch(p){case"selected":t.selected=!1;break;default:Vs(t,e,p,null,i,d)}for(c in i)if(d=i[c],f=n[c],i.hasOwnProperty(c)&&d!==f&&(d!=null||f!=null))switch(c){case"selected":t.selected=d&&typeof d!="function"&&typeof d!="symbol";break;default:Vs(t,e,c,d,i,f)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var g in n)d=n[g],n.hasOwnProperty(g)&&d!=null&&!i.hasOwnProperty(g)&&Vs(t,e,g,null,i,d);for(l in i)if(d=i[l],f=n[l],i.hasOwnProperty(l)&&d!==f&&(d!=null||f!=null))switch(l){case"children":case"dangerouslySetInnerHTML":if(d!=null)throw Error(Gt(137,e));break;default:Vs(t,e,l,d,i,f)}return;default:if(GW(e)){for(var _ in n)d=n[_],n.hasOwnProperty(_)&&d!==void 0&&!i.hasOwnProperty(_)&&eq(t,e,_,void 0,i,d);for(u in i)d=i[u],f=n[u],!i.hasOwnProperty(u)||d===f||d===void 0&&f===void 0||eq(t,e,u,d,i,f);return}}for(var v in n)d=n[v],n.hasOwnProperty(v)&&d!=null&&!i.hasOwnProperty(v)&&Vs(t,e,v,null,i,d);for(h in i)d=i[h],f=n[h],!i.hasOwnProperty(h)||d===f||d==null&&f==null||Vs(t,e,h,d,i,f)}var tq=null,nq=null;function o3(t){return t.nodeType===9?t:t.ownerDocument}function Jee(t){switch(t){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function dpe(t,e){if(t===0)switch(e){case"svg":return 1;case"math":return 2;default:return 0}return t===1&&e==="foreignObject"?0:t}function iq(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.children=="bigint"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var jj=null;function oUe(){var t=window.event;return t&&t.type==="popstate"?t===jj?!1:(jj=t,!0):(jj=null,!1)}var fpe=typeof setTimeout=="function"?setTimeout:void 0,cUe=typeof clearTimeout=="function"?clearTimeout:void 0,Qee=typeof Promise=="function"?Promise:void 0,lUe=typeof queueMicrotask=="function"?queueMicrotask:typeof Qee<"u"?function(t){return Qee.resolve(null).then(t).catch(uUe)}:fpe;function uUe(t){setTimeout(function(){throw t})}function OE(t){return t==="head"}function ete(t,e){var n=e,i=0,r=0;do{var s=n.nextSibling;if(t.removeChild(n),s&&s.nodeType===8)if(n=s.data,n==="/$"){if(0<i&&8>i){n=i;var a=t.ownerDocument;if(n&1&&SO(a.documentElement),n&2&&SO(a.body),n&4)for(n=a.head,SO(n),a=n.firstChild;a;){var o=a.nextSibling,c=a.nodeName;a[KI]||c==="SCRIPT"||c==="STYLE"||c==="LINK"&&a.rel.toLowerCase()==="stylesheet"||n.removeChild(a),a=o}}if(r===0){t.removeChild(s),yN(e);return}r--}else n==="$"||n==="$?"||n==="$!"?r++:i=n.charCodeAt(0)-48;else i=0;n=s}while(n);yN(e)}function rq(t){var e=t.firstChild;for(e&&e.nodeType===10&&(e=e.nextSibling);e;){var n=e;switch(e=e.nextSibling,n.nodeName){case"HTML":case"HEAD":case"BODY":rq(n),VW(n);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(n.rel.toLowerCase()==="stylesheet")continue}t.removeChild(n)}}function hUe(t,e,n,i){for(;t.nodeType===1;){var r=n;if(t.nodeName.toLowerCase()!==e.toLowerCase()){if(!i&&(t.nodeName!=="INPUT"||t.type!=="hidden"))break}else if(i){if(!t[KI])switch(e){case"meta":if(!t.hasAttribute("itemprop"))break;return t;case"link":if(s=t.getAttribute("rel"),s==="stylesheet"&&t.hasAttribute("data-precedence"))break;if(s!==r.rel||t.getAttribute("href")!==(r.href==null||r.href===""?null:r.href)||t.getAttribute("crossorigin")!==(r.crossOrigin==null?null:r.crossOrigin)||t.getAttribute("title")!==(r.title==null?null:r.title))break;return t;case"style":if(t.hasAttribute("data-precedence"))break;return t;case"script":if(s=t.getAttribute("src"),(s!==(r.src==null?null:r.src)||t.getAttribute("type")!==(r.type==null?null:r.type)||t.getAttribute("crossorigin")!==(r.crossOrigin==null?null:r.crossOrigin))&&s&&t.hasAttribute("async")&&!t.hasAttribute("itemprop"))break;return t;default:return t}}else if(e==="input"&&t.type==="hidden"){var s=r.name==null?null:""+r.name;if(r.type==="hidden"&&t.getAttribute("name")===s)return t}else return t;if(t=Tm(t.nextSibling),t===null)break}return null}function dUe(t,e,n){if(e==="")return null;for(;t.nodeType!==3;)if((t.nodeType!==1||t.nodeName!=="INPUT"||t.type!=="hidden")&&!n||(t=Tm(t.nextSibling),t===null))return null;return t}function sq(t){return t.data==="$!"||t.data==="$?"&&t.ownerDocument.readyState==="complete"}function fUe(t,e){var n=t.ownerDocument;if(t.data!=="$?"||n.readyState==="complete")e();else{var i=function(){e(),n.removeEventListener("DOMContentLoaded",i)};n.addEventListener("DOMContentLoaded",i),t._reactRetry=i}}function Tm(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?"||e==="F!"||e==="F")break;if(e==="/$")return null}}return t}var aq=null;function tte(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}function ppe(t,e,n){switch(e=o3(n),t){case"html":if(t=e.documentElement,!t)throw Error(Gt(452));return t;case"head":if(t=e.head,!t)throw Error(Gt(453));return t;case"body":if(t=e.body,!t)throw Error(Gt(454));return t;default:throw Error(Gt(451))}}function SO(t){for(var e=t.attributes;e.length;)t.removeAttributeNode(e[0]);VW(t)}var Sp=new Map,nte=new Set;function c3(t){return typeof t.getRootNode=="function"?t.getRootNode():t.nodeType===9?t:t.ownerDocument}var j_=Ts.d;Ts.d={f:pUe,r:mUe,D:gUe,C:vUe,L:_Ue,m:yUe,X:EUe,S:bUe,M:SUe};function pUe(){var t=j_.f(),e=jF();return t||e}function mUe(t){var e=rR(t);e!==null&&e.tag===5&&e.type==="form"?ofe(e):j_.r(t)}var oR=typeof document>"u"?null:document;function mpe(t,e,n){var i=oR;if(i&&typeof e=="string"&&e){var r=np(e);r='link[rel="'+t+'"][href="'+r+'"]',typeof n=="string"&&(r+='[crossorigin="'+n+'"]'),nte.has(r)||(nte.add(r),t={rel:t,crossOrigin:n,href:e},i.querySelector(r)===null&&(e=i.createElement("link"),Xl(e,"link",t),Sl(e),i.head.appendChild(e)))}}function gUe(t){j_.D(t),mpe("dns-prefetch",t,null)}function vUe(t,e){j_.C(t,e),mpe("preconnect",t,e)}function _Ue(t,e,n){j_.L(t,e,n);var i=oR;if(i&&t&&e){var r='link[rel="preload"][as="'+np(e)+'"]';e==="image"&&n&&n.imageSrcSet?(r+='[imagesrcset="'+np(n.imageSrcSet)+'"]',typeof n.imageSizes=="string"&&(r+='[imagesizes="'+np(n.imageSizes)+'"]')):r+='[href="'+np(t)+'"]';var s=r;switch(e){case"style":s=rA(t);break;case"script":s=cR(t)}Sp.has(s)||(t=Ma({rel:"preload",href:e==="image"&&n&&n.imageSrcSet?void 0:t,as:e},n),Sp.set(s,t),i.querySelector(r)!==null||e==="style"&&i.querySelector(sk(s))||e==="script"&&i.querySelector(ak(s))||(e=i.createElement("link"),Xl(e,"link",t),Sl(e),i.head.appendChild(e)))}}function yUe(t,e){j_.m(t,e);var n=oR;if(n&&t){var i=e&&typeof e.as=="string"?e.as:"script",r='link[rel="modulepreload"][as="'+np(i)+'"][href="'+np(t)+'"]',s=r;switch(i){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":s=cR(t)}if(!Sp.has(s)&&(t=Ma({rel:"modulepreload",href:t},e),Sp.set(s,t),n.querySelector(r)===null)){switch(i){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(n.querySelector(ak(s)))return}i=n.createElement("link"),Xl(i,"link",t),Sl(i),n.head.appendChild(i)}}}function bUe(t,e,n){j_.S(t,e,n);var i=oR;if(i&&t){var r=hC(i).hoistableStyles,s=rA(t);e=e||"default";var a=r.get(s);if(!a){var o={loading:0,preload:null};if(a=i.querySelector(sk(s)))o.loading=5;else{t=Ma({rel:"stylesheet",href:t,"data-precedence":e},n),(n=Sp.get(s))&&C9(t,n);var c=a=i.createElement("link");Sl(c),Xl(c,"link",t),c._p=new Promise(function(l,u){c.onload=l,c.onerror=u}),c.addEventListener("load",function(){o.loading|=1}),c.addEventListener("error",function(){o.loading|=2}),o.loading|=4,K2(a,e,i)}a={type:"stylesheet",instance:a,count:1,state:o},r.set(s,a)}}}function EUe(t,e){j_.X(t,e);var n=oR;if(n&&t){var i=hC(n).hoistableScripts,r=cR(t),s=i.get(r);s||(s=n.querySelector(ak(r)),s||(t=Ma({src:t,async:!0},e),(e=Sp.get(r))&&A9(t,e),s=n.createElement("script"),Sl(s),Xl(s,"link",t),n.head.appendChild(s)),s={type:"script",instance:s,count:1,state:null},i.set(r,s))}}function SUe(t,e){j_.M(t,e);var n=oR;if(n&&t){var i=hC(n).hoistableScripts,r=cR(t),s=i.get(r);s||(s=n.querySelector(ak(r)),s||(t=Ma({src:t,async:!0,type:"module"},e),(e=Sp.get(r))&&A9(t,e),s=n.createElement("script"),Sl(s),Xl(s,"link",t),n.head.appendChild(s)),s={type:"script",instance:s,count:1,state:null},i.set(r,s))}}function ite(t,e,n,i){var r=(r=Nb.current)?c3(r):null;if(!r)throw Error(Gt(446));switch(t){case"meta":case"title":return null;case"style":return typeof n.precedence=="string"&&typeof n.href=="string"?(e=rA(n.href),n=hC(r).hoistableStyles,i=n.get(e),i||(i={type:"style",instance:null,count:0,state:null},n.set(e,i)),i):{type:"void",instance:null,count:0,state:null};case"link":if(n.rel==="stylesheet"&&typeof n.href=="string"&&typeof n.precedence=="string"){t=rA(n.href);var s=hC(r).hoistableStyles,a=s.get(t);if(a||(r=r.ownerDocument||r,a={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},s.set(t,a),(s=r.querySelector(sk(t)))&&!s._p&&(a.instance=s,a.state.loading=5),Sp.has(t)||(n={rel:"preload",as:"style",href:n.href,crossOrigin:n.crossOrigin,integrity:n.integrity,media:n.media,hrefLang:n.hrefLang,referrerPolicy:n.referrerPolicy},Sp.set(t,n),s||TUe(r,t,n,a.state))),e&&i===null)throw Error(Gt(528,""));return a}if(e&&i!==null)throw Error(Gt(529,""));return null;case"script":return e=n.async,n=n.src,typeof n=="string"&&e&&typeof e!="function"&&typeof e!="symbol"?(e=cR(n),n=hC(r).hoistableScripts,i=n.get(e),i||(i={type:"script",instance:null,count:0,state:null},n.set(e,i)),i):{type:"void",instance:null,count:0,state:null};default:throw Error(Gt(444,t))}}function rA(t){return'href="'+np(t)+'"'}function sk(t){return'link[rel="stylesheet"]['+t+"]"}function gpe(t){return Ma({},t,{"data-precedence":t.precedence,precedence:null})}function TUe(t,e,n,i){t.querySelector('link[rel="preload"][as="style"]['+e+"]")?i.loading=1:(e=t.createElement("link"),i.preload=e,e.addEventListener("load",function(){return i.loading|=1}),e.addEventListener("error",function(){return i.loading|=2}),Xl(e,"link",n),Sl(e),t.head.appendChild(e))}function cR(t){return'[src="'+np(t)+'"]'}function ak(t){return"script[async]"+t}function rte(t,e,n){if(e.count++,e.instance===null)switch(e.type){case"style":var i=t.querySelector('style[data-href~="'+np(n.href)+'"]');if(i)return e.instance=i,Sl(i),i;var r=Ma({},n,{"data-href":n.href,"data-precedence":n.precedence,href:null,precedence:null});return i=(t.ownerDocument||t).createElement("style"),Sl(i),Xl(i,"style",r),K2(i,n.precedence,t),e.instance=i;case"stylesheet":r=rA(n.href);var s=t.querySelector(sk(r));if(s)return e.state.loading|=4,e.instance=s,Sl(s),s;i=gpe(n),(r=Sp.get(r))&&C9(i,r),s=(t.ownerDocument||t).createElement("link"),Sl(s);var a=s;return a._p=new Promise(function(o,c){a.onload=o,a.onerror=c}),Xl(s,"link",i),e.state.loading|=4,K2(s,n.precedence,t),e.instance=s;case"script":return s=cR(n.src),(r=t.querySelector(ak(s)))?(e.instance=r,Sl(r),r):(i=n,(r=Sp.get(s))&&(i=Ma({},n),A9(i,r)),t=t.ownerDocument||t,r=t.createElement("script"),Sl(r),Xl(r,"link",i),t.head.appendChild(r),e.instance=r);case"void":return null;default:throw Error(Gt(443,e.type))}else e.type==="stylesheet"&&!(e.state.loading&4)&&(i=e.instance,e.state.loading|=4,K2(i,n.precedence,t));return e.instance}function K2(t,e,n){for(var i=n.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),r=i.length?i[i.length-1]:null,s=r,a=0;a<i.length;a++){var o=i[a];if(o.dataset.precedence===e)s=o;else if(s!==r)break}s?s.parentNode.insertBefore(t,s.nextSibling):(e=n.nodeType===9?n.head:n,e.insertBefore(t,e.firstChild))}function C9(t,e){t.crossOrigin==null&&(t.crossOrigin=e.crossOrigin),t.referrerPolicy==null&&(t.referrerPolicy=e.referrerPolicy),t.title==null&&(t.title=e.title)}function A9(t,e){t.crossOrigin==null&&(t.crossOrigin=e.crossOrigin),t.referrerPolicy==null&&(t.referrerPolicy=e.referrerPolicy),t.integrity==null&&(t.integrity=e.integrity)}var X2=null;function ste(t,e,n){if(X2===null){var i=new Map,r=X2=new Map;r.set(n,i)}else r=X2,i=r.get(n),i||(i=new Map,r.set(n,i));if(i.has(t))return i;for(i.set(t,null),n=n.getElementsByTagName(t),r=0;r<n.length;r++){var s=n[r];if(!(s[KI]||s[_u]||t==="link"&&s.getAttribute("rel")==="stylesheet")&&s.namespaceURI!=="http://www.w3.org/2000/svg"){var a=s.getAttribute(e)||"";a=t+a;var o=i.get(a);o?o.push(s):i.set(a,[s])}}return i}function ate(t,e,n){t=t.ownerDocument||t,t.head.insertBefore(n,e==="title"?t.querySelector("head > title"):null)}function xUe(t,e,n){if(n===1||e.itemProp!=null)return!1;switch(t){case"meta":case"title":return!0;case"style":if(typeof e.precedence!="string"||typeof e.href!="string"||e.href==="")break;return!0;case"link":if(typeof e.rel!="string"||typeof e.href!="string"||e.href===""||e.onLoad||e.onError)break;switch(e.rel){case"stylesheet":return t=e.disabled,typeof e.precedence=="string"&&t==null;default:return!0}case"script":if(e.async&&typeof e.async!="function"&&typeof e.async!="symbol"&&!e.onLoad&&!e.onError&&e.src&&typeof e.src=="string")return!0}return!1}function vpe(t){return!(t.type==="stylesheet"&&!(t.state.loading&3))}var mN=null;function wUe(){}function CUe(t,e,n){if(mN===null)throw Error(Gt(475));var i=mN;if(e.type==="stylesheet"&&(typeof n.media!="string"||matchMedia(n.media).matches!==!1)&&!(e.state.loading&4)){if(e.instance===null){var r=rA(n.href),s=t.querySelector(sk(r));if(s){t=s._p,t!==null&&typeof t=="object"&&typeof t.then=="function"&&(i.count++,i=l3.bind(i),t.then(i,i)),e.state.loading|=4,e.instance=s,Sl(s);return}s=t.ownerDocument||t,n=gpe(n),(r=Sp.get(r))&&C9(n,r),s=s.createElement("link"),Sl(s);var a=s;a._p=new Promise(function(o,c){a.onload=o,a.onerror=c}),Xl(s,"link",n),e.instance=s}i.stylesheets===null&&(i.stylesheets=new Map),i.stylesheets.set(e,t),(t=e.state.preload)&&!(e.state.loading&3)&&(i.count++,e=l3.bind(i),t.addEventListener("load",e),t.addEventListener("error",e))}}function AUe(){if(mN===null)throw Error(Gt(475));var t=mN;return t.stylesheets&&t.count===0&&oq(t,t.stylesheets),0<t.count?function(e){var n=setTimeout(function(){if(t.stylesheets&&oq(t,t.stylesheets),t.unsuspend){var i=t.unsuspend;t.unsuspend=null,i()}},6e4);return t.unsuspend=e,function(){t.unsuspend=null,clearTimeout(n)}}:null}function l3(){if(this.count--,this.count===0){if(this.stylesheets)oq(this,this.stylesheets);else if(this.unsuspend){var t=this.unsuspend;this.unsuspend=null,t()}}}var u3=null;function oq(t,e){t.stylesheets=null,t.unsuspend!==null&&(t.count++,u3=new Map,e.forEach(RUe,t),u3=null,l3.call(t))}function RUe(t,e){if(!(e.state.loading&4)){var n=u3.get(t);if(n)var i=n.get(null);else{n=new Map,u3.set(t,n);for(var r=t.querySelectorAll("link[data-precedence],style[data-precedence]"),s=0;s<r.length;s++){var a=r[s];(a.nodeName==="LINK"||a.getAttribute("media")!=="not all")&&(n.set(a.dataset.precedence,a),i=a)}i&&n.set(null,i)}r=e.instance,a=r.getAttribute("data-precedence"),s=n.get(a)||i,s===i&&n.set(null,r),n.set(a,r),this.count++,i=l3.bind(this),r.addEventListener("load",i),r.addEventListener("error",i),s?s.parentNode.insertBefore(r,s.nextSibling):(t=t.nodeType===9?t.head:t,t.insertBefore(r,t.firstChild)),e.state.loading|=4}}var gN={$$typeof:n_,Provider:null,Consumer:null,_currentValue:OT,_currentValue2:OT,_threadCount:0};function MUe(t,e,n,i,r,s,a,o){this.tag=1,this.containerInfo=t,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=lj(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=lj(0),this.hiddenUpdates=lj(null),this.identifierPrefix=i,this.onUncaughtError=r,this.onCaughtError=s,this.onRecoverableError=a,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=o,this.incompleteTransitions=new Map}function _pe(t,e,n,i,r,s,a,o,c,l,u,h){return t=new MUe(t,e,n,a,o,c,l,h),e=1,s===!0&&(e|=24),s=nf(3,null,null,e),t.current=s,s.stateNode=t,e=t9(),e.refCount++,t.pooledCache=e,e.refCount++,s.memoizedState={element:i,isDehydrated:n,cache:e},i9(s),t}function ype(t){return t?(t=Kw,t):Kw}function bpe(t,e,n,i,r,s){r=ype(r),i.context===null?i.context=r:i.pendingContext=r,i=Ib(e),i.payload={element:n},s=s===void 0?null:s,s!==null&&(i.callback=s),n=kb(t,i,e),n!==null&&(ff(n,t,e),pO(n,t,e))}function ote(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function R9(t,e){ote(t,e),(t=t.alternate)&&ote(t,e)}function Epe(t){if(t.tag===13){var e=sR(t,67108864);e!==null&&ff(e,t,67108864),R9(t,67108864)}}var h3=!0;function OUe(t,e,n,i){var r=Ui.T;Ui.T=null;var s=Ts.p;try{Ts.p=2,M9(t,e,n,i)}finally{Ts.p=s,Ui.T=r}}function NUe(t,e,n,i){var r=Ui.T;Ui.T=null;var s=Ts.p;try{Ts.p=8,M9(t,e,n,i)}finally{Ts.p=s,Ui.T=r}}function M9(t,e,n,i){if(h3){var r=cq(i);if(r===null)zj(t,e,i,d3,n),cte(t,i);else if(kUe(r,t,e,n,i))i.stopPropagation();else if(cte(t,i),e&4&&-1<IUe.indexOf(t)){for(;r!==null;){var s=rR(r);if(s!==null)switch(s.tag){case 3:if(s=s.stateNode,s.current.memoizedState.isDehydrated){var a=eT(s.pendingLanes);if(a!==0){var o=s;for(o.pendingLanes|=2,o.entangledLanes|=2;a;){var c=1<<31-hf(a);o.entanglements[1]|=c,a&=~c}_0(s),!(Ps&6)&&(n3=Kg()+500,rk(0))}}break;case 13:o=sR(s,2),o!==null&&ff(o,s,2),jF(),R9(s,2)}if(s=cq(i),s===null&&zj(t,e,i,d3,n),s===r)break;r=s}r!==null&&i.stopPropagation()}else zj(t,e,i,null,n)}}function cq(t){return t=qW(t),O9(t)}var d3=null;function O9(t){if(d3=null,t=Vw(t),t!==null){var e=qI(t);if(e===null)t=null;else{var n=e.tag;if(n===13){if(t=$he(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null)}}return d3=t,null}function Spe(t){switch(t){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(v2e()){case Xhe:return 2;case Zhe:return 8;case zU:case _2e:return 32;case Jhe:return 268435456;default:return 32}default:return 32}}var lq=!1,Lb=null,Ub=null,Bb=null,vN=new Map,_N=new Map,vb=[],IUe="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function cte(t,e){switch(t){case"focusin":case"focusout":Lb=null;break;case"dragenter":case"dragleave":Ub=null;break;case"mouseover":case"mouseout":Bb=null;break;case"pointerover":case"pointerout":vN.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":_N.delete(e.pointerId)}}function uM(t,e,n,i,r,s){return t===null||t.nativeEvent!==s?(t={blockedOn:e,domEventName:n,eventSystemFlags:i,nativeEvent:s,targetContainers:[r]},e!==null&&(e=rR(e),e!==null&&Epe(e)),t):(t.eventSystemFlags|=i,e=t.targetContainers,r!==null&&e.indexOf(r)===-1&&e.push(r),t)}function kUe(t,e,n,i,r){switch(e){case"focusin":return Lb=uM(Lb,t,e,n,i,r),!0;case"dragenter":return Ub=uM(Ub,t,e,n,i,r),!0;case"mouseover":return Bb=uM(Bb,t,e,n,i,r),!0;case"pointerover":var s=r.pointerId;return vN.set(s,uM(vN.get(s)||null,t,e,n,i,r)),!0;case"gotpointercapture":return s=r.pointerId,_N.set(s,uM(_N.get(s)||null,t,e,n,i,r)),!0}return!1}function Tpe(t){var e=Vw(t.target);if(e!==null){var n=qI(e);if(n!==null){if(e=n.tag,e===13){if(e=$he(n),e!==null){t.blockedOn=e,C2e(t.priority,function(){if(n.tag===13){var i=df();i=jW(i);var r=sR(n,i);r!==null&&ff(r,n,i),R9(n,i)}});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function Z2(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=cq(t.nativeEvent);if(n===null){n=t.nativeEvent;var i=new n.constructor(n.type,n);CG=i,n.target.dispatchEvent(i),CG=null}else return e=rR(n),e!==null&&Epe(e),t.blockedOn=n,!1;e.shift()}return!0}function lte(t,e,n){Z2(t)&&n.delete(e)}function PUe(){lq=!1,Lb!==null&&Z2(Lb)&&(Lb=null),Ub!==null&&Z2(Ub)&&(Ub=null),Bb!==null&&Z2(Bb)&&(Bb=null),vN.forEach(lte),_N.forEach(lte)}function ID(t,e){t.blockedOn===e&&(t.blockedOn=null,lq||(lq=!0,Jc.unstable_scheduleCallback(Jc.unstable_NormalPriority,PUe)))}var kD=null;function ute(t){kD!==t&&(kD=t,Jc.unstable_scheduleCallback(Jc.unstable_NormalPriority,function(){kD===t&&(kD=null);for(var e=0;e<t.length;e+=3){var n=t[e],i=t[e+1],r=t[e+2];if(typeof i!="function"){if(O9(i||n)===null)continue;break}var s=rR(n);s!==null&&(t.splice(e,3),e-=3,HG(s,{pending:!0,data:r,method:n.method,action:i},i,r))}}))}function yN(t){function e(c){return ID(c,t)}Lb!==null&&ID(Lb,t),Ub!==null&&ID(Ub,t),Bb!==null&&ID(Bb,t),vN.forEach(e),_N.forEach(e);for(var n=0;n<vb.length;n++){var i=vb[n];i.blockedOn===t&&(i.blockedOn=null)}for(;0<vb.length&&(n=vb[0],n.blockedOn===null);)Tpe(n),n.blockedOn===null&&vb.shift();if(n=(t.ownerDocument||t).$$reactFormReplay,n!=null)for(i=0;i<n.length;i+=3){var r=n[i],s=n[i+1],a=r[fd]||null;if(typeof s=="function")a||ute(n);else if(a){var o=null;if(s&&s.hasAttribute("formAction")){if(r=s,a=s[fd]||null)o=a.formAction;else if(O9(r)!==null)continue}else o=a.action;typeof o=="function"?n[i+1]=o:(n.splice(i,3),i-=3),ute(n)}}}function N9(t){this._internalRoot=t}qF.prototype.render=N9.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(Gt(409));var n=e.current,i=df();bpe(n,i,t,e,null,null)};qF.prototype.unmount=N9.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;bpe(t.current,2,null,t,null,null),jF(),e[iR]=null}};function qF(t){this._internalRoot=t}qF.prototype.unstable_scheduleHydration=function(t){if(t){var e=ide();t={blockedOn:null,target:t,priority:e};for(var n=0;n<vb.length&&e!==0&&e<vb[n].priority;n++);vb.splice(n,0,t),n===0&&Tpe(t)}};var hte=Ghe.version;if(hte!=="19.1.0")throw Error(Gt(527,hte,"19.1.0"));Ts.findDOMNode=function(t){var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(Gt(188)):(t=Object.keys(t).join(","),Error(Gt(268,t)));return t=u2e(e),t=t!==null?Whe(t):null,t=t===null?null:t.stateNode,t};var DUe={bundleType:0,version:"19.1.0",rendererPackageName:"react-dom",currentDispatcherRef:Ui,reconcilerVersion:"19.1.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var PD=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!PD.isDisabled&&PD.supportsFiber)try{$I=PD.inject(DUe),uf=PD}catch{}}MF.createRoot=function(t,e){if(!qhe(t))throw Error(Gt(299));var n=!1,i="",r=_fe,s=yfe,a=bfe,o=null;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(i=e.identifierPrefix),e.onUncaughtError!==void 0&&(r=e.onUncaughtError),e.onCaughtError!==void 0&&(s=e.onCaughtError),e.onRecoverableError!==void 0&&(a=e.onRecoverableError),e.unstable_transitionCallbacks!==void 0&&(o=e.unstable_transitionCallbacks)),e=_pe(t,1,!1,null,null,n,i,r,s,a,o,null),t[iR]=e.current,w9(t),new N9(e)};MF.hydrateRoot=function(t,e,n){if(!qhe(t))throw Error(Gt(299));var i=!1,r="",s=_fe,a=yfe,o=bfe,c=null,l=null;return n!=null&&(n.unstable_strictMode===!0&&(i=!0),n.identifierPrefix!==void 0&&(r=n.identifierPrefix),n.onUncaughtError!==void 0&&(s=n.onUncaughtError),n.onCaughtError!==void 0&&(a=n.onCaughtError),n.onRecoverableError!==void 0&&(o=n.onRecoverableError),n.unstable_transitionCallbacks!==void 0&&(c=n.unstable_transitionCallbacks),n.formState!==void 0&&(l=n.formState)),e=_pe(t,1,!0,e,n??null,i,r,s,a,o,c,l),e.context=ype(null),n=e.current,i=df(),i=jW(i),r=Ib(i),r.callback=null,kb(n,r,i),n=i,e.current.lanes=n,YI(e,n),_0(e),t[iR]=e.current,w9(t),new qF(e)};MF.version="19.1.0";function xpe(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(xpe)}catch(t){console.error(t)}}xpe(),Bhe.exports=MF;var LUe=Bhe.exports;/*! unmute-ios-audio. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> */var UUe=BUe;const dte=["auxclick","click","contextmenu","dblclick","keydown","keyup","mousedown","mouseup","touchend"];function BUe(){const t=window.webkitAudioContext;if(!(navigator.maxTouchPoints>0&&t!=null))return;let n="blocked",i="blocked",r,s,a;const o=new t().sampleRate,c=l(o);dte.forEach(p=>{window.addEventListener(p,u,{capture:!0,passive:!0})});function l(p){const g=new ArrayBuffer(10),_=new DataView(g);return _.setUint32(0,p,!0),_.setUint32(4,p,!0),_.setUint16(8,1,!0),`data:audio/wav;base64,UklGRisAAABXQVZFZm10IBAAAAABAAEA${window.btoa(String.fromCharCode(...new Uint8Array(g))).slice(0,13)}AgAZGF0YQcAAACAgICAgICAAAA=`}function u(p){n==="blocked"&&(n="pending",h()),i==="blocked"&&(i="pending",d())}function h(){r=document.createElement("audio"),r.setAttribute("x-webkit-airplay","deny"),r.preload="auto",r.loop=!0,r.src=c,r.load(),r.play().then(()=>{n="allowed",f()},()=>{n="blocked",r.pause(),r.removeAttribute("src"),r.load(),r=null})}function d(){s=new t,a=s.createBufferSource(),a.buffer=s.createBuffer(1,1,22050),a.connect(s.destination),a.start(),s.state==="running"?(i="allowed",f()):(i="blocked",a.disconnect(s.destination),a=null,s.close(),s=null)}function f(){n!=="allowed"||i!=="allowed"||dte.forEach(p=>{window.removeEventListener(p,u,{capture:!0,passive:!0})})}}const FUe=il(UUe);var wpe={exports:{}};(function(t,e){(function(n,i){t.exports=i()})(Ml,function(){return n.importState=function(r){var s=new n;return s.importState(r),s},n;function n(){return function(r){var s=0,a=0,o=0,c=1;r.length==0&&(r=[+new Date]);var l=i();s=l(" "),a=l(" "),o=l(" ");for(var u=0;u<r.length;u++)s-=l(r[u]),s<0&&(s+=1),a-=l(r[u]),a<0&&(a+=1),o-=l(r[u]),o<0&&(o+=1);l=null;var h=function(){var d=2091639*s+c*23283064365386963e-26;return s=a,a=o,o=d-(c=d|0)};return h.next=h,h.uint32=function(){return h()*4294967296},h.fract53=function(){return h()+(h()*2097152|0)*11102230246251565e-32},h.version="Alea 0.9",h.args=r,h.exportState=function(){return[s,a,o,c]},h.importState=function(d){s=+d[0]||0,a=+d[1]||0,o=+d[2]||0,c=+d[3]||0},h}(Array.prototype.slice.call(arguments))}function i(){var r=4022871197,s=function(a){a=a.toString();for(var o=0;o<a.length;o++){r+=a.charCodeAt(o);var c=.02519603282416938*r;r=c>>>0,c-=r,c*=r,r=c>>>0,c-=r,r+=c*4294967296}return(r>>>0)*23283064365386963e-26};return s.version="Mash 0.9",s}})})(wpe);var zUe=wpe.exports;const I9=il(zUe);new xt;new xt;function er(t,e,n){return Math.max(e,Math.min(n,t))}function jUe(t,e){return er(t-Math.floor(t/e)*e,0,e)}function HUe(t,e){var n=jUe(e-t,Math.PI*2);return n>Math.PI&&(n-=Math.PI*2),n}function Cpe(t){return t/180*Math.PI}function Ape(t){return t*180/Math.PI}const VUe=I9("089fad0j9awfem09wavefc09uwaef");function fte(t){return 2*Math.floor(t/2)}function $F(t,e){return Math.round(t/e)*e}function GUe(){return VUe()}function qUe(t){return I9(t)()}function rf(t,e){const n=Math.min(t,e),r=Math.max(t,e)-n+1;return n+Math.floor(GUe()*r)}function Rpe(t,e,n){const i=Math.min(e,n),s=Math.max(e,n)-i+1;return i+Math.floor(qUe(t)*s)}/*!
 * https://github.com/Starcounter-Jack/JSON-Patch
 * (c) 2017-2022 Joachim Wester
 * MIT licensed
 */var $Ue=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var s in r)r.hasOwnProperty(s)&&(i[s]=r[s])},t(e,n)};return function(e,n){t(e,n);function i(){this.constructor=e}e.prototype=n===null?Object.create(n):(i.prototype=n.prototype,new i)}}(),WUe=Object.prototype.hasOwnProperty;function uq(t,e){return WUe.call(t,e)}function hq(t){if(Array.isArray(t)){for(var e=new Array(t.length),n=0;n<e.length;n++)e[n]=""+n;return e}if(Object.keys)return Object.keys(t);var i=[];for(var r in t)uq(t,r)&&i.push(r);return i}function sd(t){switch(typeof t){case"object":return JSON.parse(JSON.stringify(t));case"undefined":return null;default:return t}}function dq(t){for(var e=0,n=t.length,i;e<n;){if(i=t.charCodeAt(e),i>=48&&i<=57){e++;continue}return!1}return!0}function iT(t){return t.indexOf("/")===-1&&t.indexOf("~")===-1?t:t.replace(/~/g,"~0").replace(/\//g,"~1")}function Mpe(t){return t.replace(/~1/g,"/").replace(/~0/g,"~")}function fq(t){if(t===void 0)return!0;if(t){if(Array.isArray(t)){for(var e=0,n=t.length;e<n;e++)if(fq(t[e]))return!0}else if(typeof t=="object"){for(var i=hq(t),r=i.length,s=0;s<r;s++)if(fq(t[i[s]]))return!0}}return!1}function pte(t,e){var n=[t];for(var i in e){var r=typeof e[i]=="object"?JSON.stringify(e[i],null,2):e[i];typeof r<"u"&&n.push(i+": "+r)}return n.join(`
`)}var Ope=function(t){$Ue(e,t);function e(n,i,r,s,a){var o=this.constructor,c=t.call(this,pte(n,{name:i,index:r,operation:s,tree:a}))||this;return c.name=i,c.index=r,c.operation=s,c.tree=a,Object.setPrototypeOf(c,o.prototype),c.message=pte(n,{name:i,index:r,operation:s,tree:a}),c}return e}(Error),Co=Ope,YUe=sd,Qw={add:function(t,e,n){return t[e]=this.value,{newDocument:n}},remove:function(t,e,n){var i=t[e];return delete t[e],{newDocument:n,removed:i}},replace:function(t,e,n){var i=t[e];return t[e]=this.value,{newDocument:n,removed:i}},move:function(t,e,n){var i=f3(n,this.path);i&&(i=sd(i));var r=UT(n,{op:"remove",path:this.from}).removed;return UT(n,{op:"add",path:this.path,value:r}),{newDocument:n,removed:i}},copy:function(t,e,n){var i=f3(n,this.from);return UT(n,{op:"add",path:this.path,value:sd(i)}),{newDocument:n}},test:function(t,e,n){return{newDocument:n,test:bN(t[e],this.value)}},_get:function(t,e,n){return this.value=t[e],{newDocument:n}}},KUe={add:function(t,e,n){return dq(e)?t.splice(e,0,this.value):t[e]=this.value,{newDocument:n,index:e}},remove:function(t,e,n){var i=t.splice(e,1);return{newDocument:n,removed:i[0]}},replace:function(t,e,n){var i=t[e];return t[e]=this.value,{newDocument:n,removed:i}},move:Qw.move,copy:Qw.copy,test:Qw.test,_get:Qw._get};function f3(t,e){if(e=="")return t;var n={op:"_get",path:e};return UT(t,n),n.value}function UT(t,e,n,i,r,s){if(n===void 0&&(n=!1),i===void 0&&(i=!0),r===void 0&&(r=!0),s===void 0&&(s=0),n&&(typeof n=="function"?n(e,0,t,e.path):p3(e,0)),e.path===""){var a={newDocument:t};if(e.op==="add")return a.newDocument=e.value,a;if(e.op==="replace")return a.newDocument=e.value,a.removed=t,a;if(e.op==="move"||e.op==="copy")return a.newDocument=f3(t,e.from),e.op==="move"&&(a.removed=t),a;if(e.op==="test"){if(a.test=bN(t,e.value),a.test===!1)throw new Co("Test operation failed","TEST_OPERATION_FAILED",s,e,t);return a.newDocument=t,a}else{if(e.op==="remove")return a.removed=t,a.newDocument=null,a;if(e.op==="_get")return e.value=t,a;if(n)throw new Co("Operation `op` property is not one of operations defined in RFC-6902","OPERATION_OP_INVALID",s,e,t);return a}}else{i||(t=sd(t));var o=e.path||"",c=o.split("/"),l=t,u=1,h=c.length,d=void 0,f=void 0,p=void 0;for(typeof n=="function"?p=n:p=p3;;){if(f=c[u],f&&f.indexOf("~")!=-1&&(f=Mpe(f)),r&&(f=="__proto__"||f=="prototype"&&u>0&&c[u-1]=="constructor"))throw new TypeError("JSON-Patch: modifying `__proto__` or `constructor/prototype` prop is banned for security reasons, if this was on purpose, please set `banPrototypeModifications` flag false and pass it to this function. More info in fast-json-patch README");if(n&&d===void 0&&(l[f]===void 0?d=c.slice(0,u).join("/"):u==h-1&&(d=e.path),d!==void 0&&p(e,0,t,d)),u++,Array.isArray(l)){if(f==="-")f=l.length;else{if(n&&!dq(f))throw new Co("Expected an unsigned base-10 integer value, making the new referenced value the array element with the zero-based index","OPERATION_PATH_ILLEGAL_ARRAY_INDEX",s,e,t);dq(f)&&(f=~~f)}if(u>=h){if(n&&e.op==="add"&&f>l.length)throw new Co("The specified index MUST NOT be greater than the number of elements in the array","OPERATION_VALUE_OUT_OF_BOUNDS",s,e,t);var a=KUe[e.op].call(e,l,f,t);if(a.test===!1)throw new Co("Test operation failed","TEST_OPERATION_FAILED",s,e,t);return a}}else if(u>=h){var a=Qw[e.op].call(e,l,f,t);if(a.test===!1)throw new Co("Test operation failed","TEST_OPERATION_FAILED",s,e,t);return a}if(l=l[f],n&&u<h&&(!l||typeof l!="object"))throw new Co("Cannot perform operation at the desired path","OPERATION_PATH_UNRESOLVABLE",s,e,t)}}}function WF(t,e,n,i,r){if(i===void 0&&(i=!0),r===void 0&&(r=!0),n&&!Array.isArray(e))throw new Co("Patch sequence must be an array","SEQUENCE_NOT_AN_ARRAY");i||(t=sd(t));for(var s=new Array(e.length),a=0,o=e.length;a<o;a++)s[a]=UT(t,e[a],n,!0,r,a),t=s[a].newDocument;return s.newDocument=t,s}function XUe(t,e,n){var i=UT(t,e);if(i.test===!1)throw new Co("Test operation failed","TEST_OPERATION_FAILED",n,e,t);return i.newDocument}function p3(t,e,n,i){if(typeof t!="object"||t===null||Array.isArray(t))throw new Co("Operation is not an object","OPERATION_NOT_AN_OBJECT",e,t,n);if(Qw[t.op]){if(typeof t.path!="string")throw new Co("Operation `path` property is not a string","OPERATION_PATH_INVALID",e,t,n);if(t.path.indexOf("/")!==0&&t.path.length>0)throw new Co('Operation `path` property must start with "/"',"OPERATION_PATH_INVALID",e,t,n);if((t.op==="move"||t.op==="copy")&&typeof t.from!="string")throw new Co("Operation `from` property is not present (applicable in `move` and `copy` operations)","OPERATION_FROM_REQUIRED",e,t,n);if((t.op==="add"||t.op==="replace"||t.op==="test")&&t.value===void 0)throw new Co("Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)","OPERATION_VALUE_REQUIRED",e,t,n);if((t.op==="add"||t.op==="replace"||t.op==="test")&&fq(t.value))throw new Co("Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)","OPERATION_VALUE_CANNOT_CONTAIN_UNDEFINED",e,t,n);if(n){if(t.op=="add"){var r=t.path.split("/").length,s=i.split("/").length;if(r!==s+1&&r!==s)throw new Co("Cannot perform an `add` operation at the desired path","OPERATION_PATH_CANNOT_ADD",e,t,n)}else if(t.op==="replace"||t.op==="remove"||t.op==="_get"){if(t.path!==i)throw new Co("Cannot perform the operation at a path that does not exist","OPERATION_PATH_UNRESOLVABLE",e,t,n)}else if(t.op==="move"||t.op==="copy"){var a={op:"_get",path:t.from,value:void 0},o=k9([a],n);if(o&&o.name==="OPERATION_PATH_UNRESOLVABLE")throw new Co("Cannot perform the operation from a path that does not exist","OPERATION_FROM_UNRESOLVABLE",e,t,n)}}}else throw new Co("Operation `op` property is not one of operations defined in RFC-6902","OPERATION_OP_INVALID",e,t,n)}function k9(t,e,n){try{if(!Array.isArray(t))throw new Co("Patch sequence must be an array","SEQUENCE_NOT_AN_ARRAY");if(e)WF(sd(e),sd(t),n||!0);else{n=n||p3;for(var i=0;i<t.length;i++)n(t[i],i,e,void 0)}}catch(r){if(r instanceof Co)return r;throw r}}function bN(t,e){if(t===e)return!0;if(t&&e&&typeof t=="object"&&typeof e=="object"){var n=Array.isArray(t),i=Array.isArray(e),r,s,a;if(n&&i){if(s=t.length,s!=e.length)return!1;for(r=s;r--!==0;)if(!bN(t[r],e[r]))return!1;return!0}if(n!=i)return!1;var o=Object.keys(t);if(s=o.length,s!==Object.keys(e).length)return!1;for(r=s;r--!==0;)if(!e.hasOwnProperty(o[r]))return!1;for(r=s;r--!==0;)if(a=o[r],!bN(t[a],e[a]))return!1;return!0}return t!==t&&e!==e}const ZUe=Object.freeze(Object.defineProperty({__proto__:null,JsonPatchError:Co,_areEquals:bN,applyOperation:UT,applyPatch:WF,applyReducer:XUe,deepClone:YUe,getValueByPointer:f3,validate:k9,validator:p3},Symbol.toStringTag,{value:"Module"}));/*!
 * https://github.com/Starcounter-Jack/JSON-Patch
 * (c) 2017-2021 Joachim Wester
 * MIT license
 */var P9=new WeakMap,JUe=function(){function t(e){this.observers=new Map,this.obj=e}return t}(),QUe=function(){function t(e,n){this.callback=e,this.observer=n}return t}();function e3e(t){return P9.get(t)}function t3e(t,e){return t.observers.get(e)}function n3e(t,e){t.observers.delete(e.callback)}function i3e(t,e){e.unobserve()}function r3e(t,e){var n=[],i,r=e3e(t);if(!r)r=new JUe(t),P9.set(t,r);else{var s=t3e(r,e);i=s&&s.observer}if(i)return i;if(i={},r.value=sd(t),e){i.callback=e,i.next=null;var a=function(){pq(i)},o=function(){clearTimeout(i.next),i.next=setTimeout(a)};typeof window<"u"&&(window.addEventListener("mouseup",o),window.addEventListener("keyup",o),window.addEventListener("mousedown",o),window.addEventListener("keydown",o),window.addEventListener("change",o))}return i.patches=n,i.object=t,i.unobserve=function(){pq(i),clearTimeout(i.next),n3e(r,i),typeof window<"u"&&(window.removeEventListener("mouseup",o),window.removeEventListener("keyup",o),window.removeEventListener("mousedown",o),window.removeEventListener("keydown",o),window.removeEventListener("change",o))},r.observers.set(e,new QUe(e,i)),i}function pq(t,e){e===void 0&&(e=!1);var n=P9.get(t.object);D9(n.value,t.object,t.patches,"",e),t.patches.length&&WF(n.value,t.patches);var i=t.patches;return i.length>0&&(t.patches=[],t.callback&&t.callback(i)),i}function D9(t,e,n,i,r){if(e!==t){typeof e.toJSON=="function"&&(e=e.toJSON());for(var s=hq(e),a=hq(t),o=!1,c=a.length-1;c>=0;c--){var l=a[c],u=t[l];if(uq(e,l)&&!(e[l]===void 0&&u!==void 0&&Array.isArray(e)===!1)){var h=e[l];typeof u=="object"&&u!=null&&typeof h=="object"&&h!=null&&Array.isArray(u)===Array.isArray(h)?D9(u,h,n,i+"/"+iT(l),r):u!==h&&(r&&n.push({op:"test",path:i+"/"+iT(l),value:sd(u)}),n.push({op:"replace",path:i+"/"+iT(l),value:sd(h)}))}else Array.isArray(t)===Array.isArray(e)?(r&&n.push({op:"test",path:i+"/"+iT(l),value:sd(u)}),n.push({op:"remove",path:i+"/"+iT(l)}),o=!0):(r&&n.push({op:"test",path:i,value:t}),n.push({op:"replace",path:i,value:e}))}if(!(!o&&s.length==a.length))for(var c=0;c<s.length;c++){var l=s[c];!uq(t,l)&&e[l]!==void 0&&n.push({op:"add",path:i+"/"+iT(l),value:sd(e[l])})}}}function s3e(t,e,n){n===void 0&&(n=!1);var i=[];return D9(t,e,i,"",n),i}const a3e=Object.freeze(Object.defineProperty({__proto__:null,compare:s3e,generate:pq,observe:r3e,unobserve:i3e},Symbol.toStringTag,{value:"Module"}));Object.assign({},ZUe,a3e,{JsonPatchError:Ope,deepClone:sd,escapePathComponent:iT,unescapePathComponent:Mpe});var o3e=typeof Element<"u",c3e=typeof Map=="function",l3e=typeof Set=="function",u3e=typeof ArrayBuffer=="function"&&!!ArrayBuffer.isView;function J2(t,e){if(t===e)return!0;if(t&&e&&typeof t=="object"&&typeof e=="object"){if(t.constructor!==e.constructor)return!1;var n,i,r;if(Array.isArray(t)){if(n=t.length,n!=e.length)return!1;for(i=n;i--!==0;)if(!J2(t[i],e[i]))return!1;return!0}var s;if(c3e&&t instanceof Map&&e instanceof Map){if(t.size!==e.size)return!1;for(s=t.entries();!(i=s.next()).done;)if(!e.has(i.value[0]))return!1;for(s=t.entries();!(i=s.next()).done;)if(!J2(i.value[1],e.get(i.value[0])))return!1;return!0}if(l3e&&t instanceof Set&&e instanceof Set){if(t.size!==e.size)return!1;for(s=t.entries();!(i=s.next()).done;)if(!e.has(i.value[0]))return!1;return!0}if(u3e&&ArrayBuffer.isView(t)&&ArrayBuffer.isView(e)){if(n=t.length,n!=e.length)return!1;for(i=n;i--!==0;)if(t[i]!==e[i])return!1;return!0}if(t.constructor===RegExp)return t.source===e.source&&t.flags===e.flags;if(t.valueOf!==Object.prototype.valueOf&&typeof t.valueOf=="function"&&typeof e.valueOf=="function")return t.valueOf()===e.valueOf();if(t.toString!==Object.prototype.toString&&typeof t.toString=="function"&&typeof e.toString=="function")return t.toString()===e.toString();if(r=Object.keys(t),n=r.length,n!==Object.keys(e).length)return!1;for(i=n;i--!==0;)if(!Object.prototype.hasOwnProperty.call(e,r[i]))return!1;if(o3e&&t instanceof Element)return!1;for(i=n;i--!==0;)if(!((r[i]==="_owner"||r[i]==="__v"||r[i]==="__o")&&t.$$typeof)&&!J2(t[r[i]],e[r[i]]))return!1;return!0}return t!==t&&e!==e}var h3e=function(e,n){try{return J2(e,n)}catch(i){if((i.message||"").match(/stack|recursion/i))return console.warn("react-fast-compare cannot handle circular refs"),!1;throw i}};const hT=il(h3e);function re(t){return t!=null}const d3e=Object.fromEntries,M_=Object.keys;function ro(t){return sd(t)}function f3e(t){return typeof t=="boolean"}function an(t){return typeof t=="number"&&isNaN(t)===!1}function Tn(t){return typeof t=="string"}function ji(t){return Array.isArray(t)}function ih(t){return t}/*! pako 2.1.0 https://github.com/nodeca/pako @license (MIT AND Zlib) */const p3e=4,mte=0,gte=1,m3e=2;function lR(t){let e=t.length;for(;--e>=0;)t[e]=0}const g3e=0,Npe=1,v3e=2,_3e=3,y3e=258,L9=29,ok=256,EN=ok+1+L9,yC=30,U9=19,Ipe=2*EN+1,bT=15,Hj=16,b3e=7,B9=256,kpe=16,Ppe=17,Dpe=18,mq=new Uint8Array([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0]),Q2=new Uint8Array([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13]),E3e=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7]),Lpe=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),S3e=512,qv=new Array((EN+2)*2);lR(qv);const TO=new Array(yC*2);lR(TO);const SN=new Array(S3e);lR(SN);const TN=new Array(y3e-_3e+1);lR(TN);const F9=new Array(L9);lR(F9);const m3=new Array(yC);lR(m3);function Vj(t,e,n,i,r){this.static_tree=t,this.extra_bits=e,this.extra_base=n,this.elems=i,this.max_length=r,this.has_stree=t&&t.length}let Upe,Bpe,Fpe;function Gj(t,e){this.dyn_tree=t,this.max_code=0,this.stat_desc=e}const zpe=t=>t<256?SN[t]:SN[256+(t>>>7)],xN=(t,e)=>{t.pending_buf[t.pending++]=e&255,t.pending_buf[t.pending++]=e>>>8&255},ad=(t,e,n)=>{t.bi_valid>Hj-n?(t.bi_buf|=e<<t.bi_valid&65535,xN(t,t.bi_buf),t.bi_buf=e>>Hj-t.bi_valid,t.bi_valid+=n-Hj):(t.bi_buf|=e<<t.bi_valid&65535,t.bi_valid+=n)},Ug=(t,e,n)=>{ad(t,n[e*2],n[e*2+1])},jpe=(t,e)=>{let n=0;do n|=t&1,t>>>=1,n<<=1;while(--e>0);return n>>>1},T3e=t=>{t.bi_valid===16?(xN(t,t.bi_buf),t.bi_buf=0,t.bi_valid=0):t.bi_valid>=8&&(t.pending_buf[t.pending++]=t.bi_buf&255,t.bi_buf>>=8,t.bi_valid-=8)},x3e=(t,e)=>{const n=e.dyn_tree,i=e.max_code,r=e.stat_desc.static_tree,s=e.stat_desc.has_stree,a=e.stat_desc.extra_bits,o=e.stat_desc.extra_base,c=e.stat_desc.max_length;let l,u,h,d,f,p,g=0;for(d=0;d<=bT;d++)t.bl_count[d]=0;for(n[t.heap[t.heap_max]*2+1]=0,l=t.heap_max+1;l<Ipe;l++)u=t.heap[l],d=n[n[u*2+1]*2+1]+1,d>c&&(d=c,g++),n[u*2+1]=d,!(u>i)&&(t.bl_count[d]++,f=0,u>=o&&(f=a[u-o]),p=n[u*2],t.opt_len+=p*(d+f),s&&(t.static_len+=p*(r[u*2+1]+f)));if(g!==0){do{for(d=c-1;t.bl_count[d]===0;)d--;t.bl_count[d]--,t.bl_count[d+1]+=2,t.bl_count[c]--,g-=2}while(g>0);for(d=c;d!==0;d--)for(u=t.bl_count[d];u!==0;)h=t.heap[--l],!(h>i)&&(n[h*2+1]!==d&&(t.opt_len+=(d-n[h*2+1])*n[h*2],n[h*2+1]=d),u--)}},Hpe=(t,e,n)=>{const i=new Array(bT+1);let r=0,s,a;for(s=1;s<=bT;s++)r=r+n[s-1]<<1,i[s]=r;for(a=0;a<=e;a++){let o=t[a*2+1];o!==0&&(t[a*2]=jpe(i[o]++,o))}},w3e=()=>{let t,e,n,i,r;const s=new Array(bT+1);for(n=0,i=0;i<L9-1;i++)for(F9[i]=n,t=0;t<1<<mq[i];t++)TN[n++]=i;for(TN[n-1]=i,r=0,i=0;i<16;i++)for(m3[i]=r,t=0;t<1<<Q2[i];t++)SN[r++]=i;for(r>>=7;i<yC;i++)for(m3[i]=r<<7,t=0;t<1<<Q2[i]-7;t++)SN[256+r++]=i;for(e=0;e<=bT;e++)s[e]=0;for(t=0;t<=143;)qv[t*2+1]=8,t++,s[8]++;for(;t<=255;)qv[t*2+1]=9,t++,s[9]++;for(;t<=279;)qv[t*2+1]=7,t++,s[7]++;for(;t<=287;)qv[t*2+1]=8,t++,s[8]++;for(Hpe(qv,EN+1,s),t=0;t<yC;t++)TO[t*2+1]=5,TO[t*2]=jpe(t,5);Upe=new Vj(qv,mq,ok+1,EN,bT),Bpe=new Vj(TO,Q2,0,yC,bT),Fpe=new Vj(new Array(0),E3e,0,U9,b3e)},Vpe=t=>{let e;for(e=0;e<EN;e++)t.dyn_ltree[e*2]=0;for(e=0;e<yC;e++)t.dyn_dtree[e*2]=0;for(e=0;e<U9;e++)t.bl_tree[e*2]=0;t.dyn_ltree[B9*2]=1,t.opt_len=t.static_len=0,t.sym_next=t.matches=0},Gpe=t=>{t.bi_valid>8?xN(t,t.bi_buf):t.bi_valid>0&&(t.pending_buf[t.pending++]=t.bi_buf),t.bi_buf=0,t.bi_valid=0},vte=(t,e,n,i)=>{const r=e*2,s=n*2;return t[r]<t[s]||t[r]===t[s]&&i[e]<=i[n]},qj=(t,e,n)=>{const i=t.heap[n];let r=n<<1;for(;r<=t.heap_len&&(r<t.heap_len&&vte(e,t.heap[r+1],t.heap[r],t.depth)&&r++,!vte(e,i,t.heap[r],t.depth));)t.heap[n]=t.heap[r],n=r,r<<=1;t.heap[n]=i},_te=(t,e,n)=>{let i,r,s=0,a,o;if(t.sym_next!==0)do i=t.pending_buf[t.sym_buf+s++]&255,i+=(t.pending_buf[t.sym_buf+s++]&255)<<8,r=t.pending_buf[t.sym_buf+s++],i===0?Ug(t,r,e):(a=TN[r],Ug(t,a+ok+1,e),o=mq[a],o!==0&&(r-=F9[a],ad(t,r,o)),i--,a=zpe(i),Ug(t,a,n),o=Q2[a],o!==0&&(i-=m3[a],ad(t,i,o)));while(s<t.sym_next);Ug(t,B9,e)},gq=(t,e)=>{const n=e.dyn_tree,i=e.stat_desc.static_tree,r=e.stat_desc.has_stree,s=e.stat_desc.elems;let a,o,c=-1,l;for(t.heap_len=0,t.heap_max=Ipe,a=0;a<s;a++)n[a*2]!==0?(t.heap[++t.heap_len]=c=a,t.depth[a]=0):n[a*2+1]=0;for(;t.heap_len<2;)l=t.heap[++t.heap_len]=c<2?++c:0,n[l*2]=1,t.depth[l]=0,t.opt_len--,r&&(t.static_len-=i[l*2+1]);for(e.max_code=c,a=t.heap_len>>1;a>=1;a--)qj(t,n,a);l=s;do a=t.heap[1],t.heap[1]=t.heap[t.heap_len--],qj(t,n,1),o=t.heap[1],t.heap[--t.heap_max]=a,t.heap[--t.heap_max]=o,n[l*2]=n[a*2]+n[o*2],t.depth[l]=(t.depth[a]>=t.depth[o]?t.depth[a]:t.depth[o])+1,n[a*2+1]=n[o*2+1]=l,t.heap[1]=l++,qj(t,n,1);while(t.heap_len>=2);t.heap[--t.heap_max]=t.heap[1],x3e(t,e),Hpe(n,c,t.bl_count)},yte=(t,e,n)=>{let i,r=-1,s,a=e[0*2+1],o=0,c=7,l=4;for(a===0&&(c=138,l=3),e[(n+1)*2+1]=65535,i=0;i<=n;i++)s=a,a=e[(i+1)*2+1],!(++o<c&&s===a)&&(o<l?t.bl_tree[s*2]+=o:s!==0?(s!==r&&t.bl_tree[s*2]++,t.bl_tree[kpe*2]++):o<=10?t.bl_tree[Ppe*2]++:t.bl_tree[Dpe*2]++,o=0,r=s,a===0?(c=138,l=3):s===a?(c=6,l=3):(c=7,l=4))},bte=(t,e,n)=>{let i,r=-1,s,a=e[0*2+1],o=0,c=7,l=4;for(a===0&&(c=138,l=3),i=0;i<=n;i++)if(s=a,a=e[(i+1)*2+1],!(++o<c&&s===a)){if(o<l)do Ug(t,s,t.bl_tree);while(--o!==0);else s!==0?(s!==r&&(Ug(t,s,t.bl_tree),o--),Ug(t,kpe,t.bl_tree),ad(t,o-3,2)):o<=10?(Ug(t,Ppe,t.bl_tree),ad(t,o-3,3)):(Ug(t,Dpe,t.bl_tree),ad(t,o-11,7));o=0,r=s,a===0?(c=138,l=3):s===a?(c=6,l=3):(c=7,l=4)}},C3e=t=>{let e;for(yte(t,t.dyn_ltree,t.l_desc.max_code),yte(t,t.dyn_dtree,t.d_desc.max_code),gq(t,t.bl_desc),e=U9-1;e>=3&&t.bl_tree[Lpe[e]*2+1]===0;e--);return t.opt_len+=3*(e+1)+5+5+4,e},A3e=(t,e,n,i)=>{let r;for(ad(t,e-257,5),ad(t,n-1,5),ad(t,i-4,4),r=0;r<i;r++)ad(t,t.bl_tree[Lpe[r]*2+1],3);bte(t,t.dyn_ltree,e-1),bte(t,t.dyn_dtree,n-1)},R3e=t=>{let e=4093624447,n;for(n=0;n<=31;n++,e>>>=1)if(e&1&&t.dyn_ltree[n*2]!==0)return mte;if(t.dyn_ltree[9*2]!==0||t.dyn_ltree[10*2]!==0||t.dyn_ltree[13*2]!==0)return gte;for(n=32;n<ok;n++)if(t.dyn_ltree[n*2]!==0)return gte;return mte};let Ete=!1;const M3e=t=>{Ete||(w3e(),Ete=!0),t.l_desc=new Gj(t.dyn_ltree,Upe),t.d_desc=new Gj(t.dyn_dtree,Bpe),t.bl_desc=new Gj(t.bl_tree,Fpe),t.bi_buf=0,t.bi_valid=0,Vpe(t)},qpe=(t,e,n,i)=>{ad(t,(g3e<<1)+(i?1:0),3),Gpe(t),xN(t,n),xN(t,~n),n&&t.pending_buf.set(t.window.subarray(e,e+n),t.pending),t.pending+=n},O3e=t=>{ad(t,Npe<<1,3),Ug(t,B9,qv),T3e(t)},N3e=(t,e,n,i)=>{let r,s,a=0;t.level>0?(t.strm.data_type===m3e&&(t.strm.data_type=R3e(t)),gq(t,t.l_desc),gq(t,t.d_desc),a=C3e(t),r=t.opt_len+3+7>>>3,s=t.static_len+3+7>>>3,s<=r&&(r=s)):r=s=n+5,n+4<=r&&e!==-1?qpe(t,e,n,i):t.strategy===p3e||s===r?(ad(t,(Npe<<1)+(i?1:0),3),_te(t,qv,TO)):(ad(t,(v3e<<1)+(i?1:0),3),A3e(t,t.l_desc.max_code+1,t.d_desc.max_code+1,a+1),_te(t,t.dyn_ltree,t.dyn_dtree)),Vpe(t),i&&Gpe(t)},I3e=(t,e,n)=>(t.pending_buf[t.sym_buf+t.sym_next++]=e,t.pending_buf[t.sym_buf+t.sym_next++]=e>>8,t.pending_buf[t.sym_buf+t.sym_next++]=n,e===0?t.dyn_ltree[n*2]++:(t.matches++,e--,t.dyn_ltree[(TN[n]+ok+1)*2]++,t.dyn_dtree[zpe(e)*2]++),t.sym_next===t.sym_end);var k3e=M3e,P3e=qpe,D3e=N3e,L3e=I3e,U3e=O3e,B3e={_tr_init:k3e,_tr_stored_block:P3e,_tr_flush_block:D3e,_tr_tally:L3e,_tr_align:U3e};const F3e=(t,e,n,i)=>{let r=t&65535|0,s=t>>>16&65535|0,a=0;for(;n!==0;){a=n>2e3?2e3:n,n-=a;do r=r+e[i++]|0,s=s+r|0;while(--a);r%=65521,s%=65521}return r|s<<16|0};var wN=F3e;const z3e=()=>{let t,e=[];for(var n=0;n<256;n++){t=n;for(var i=0;i<8;i++)t=t&1?3988292384^t>>>1:t>>>1;e[n]=t}return e},j3e=new Uint32Array(z3e()),H3e=(t,e,n,i)=>{const r=j3e,s=i+n;t^=-1;for(let a=i;a<s;a++)t=t>>>8^r[(t^e[a])&255];return t^-1};var vl=H3e,r1={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},j1={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8};const{_tr_init:V3e,_tr_stored_block:vq,_tr_flush_block:G3e,_tr_tally:Fb,_tr_align:q3e}=B3e,{Z_NO_FLUSH:zb,Z_PARTIAL_FLUSH:$3e,Z_FULL_FLUSH:W3e,Z_FINISH:rp,Z_BLOCK:Ste,Z_OK:Gl,Z_STREAM_END:Tte,Z_STREAM_ERROR:Zg,Z_DATA_ERROR:Y3e,Z_BUF_ERROR:$j,Z_DEFAULT_COMPRESSION:K3e,Z_FILTERED:X3e,Z_HUFFMAN_ONLY:DD,Z_RLE:Z3e,Z_FIXED:J3e,Z_DEFAULT_STRATEGY:Q3e,Z_UNKNOWN:eBe,Z_DEFLATED:YF}=j1,tBe=9,nBe=15,iBe=8,rBe=29,sBe=256,_q=sBe+1+rBe,aBe=30,oBe=19,cBe=2*_q+1,lBe=15,Ur=3,Cb=258,Jg=Cb+Ur+1,uBe=32,sA=42,z9=57,yq=69,bq=73,Eq=91,Sq=103,ET=113,FM=666,uh=1,uR=2,s1=3,hR=4,hBe=3,ST=(t,e)=>(t.msg=r1[e],e),xte=t=>t*2-(t>4?9:0),_b=t=>{let e=t.length;for(;--e>=0;)t[e]=0},dBe=t=>{let e,n,i,r=t.w_size;e=t.hash_size,i=e;do n=t.head[--i],t.head[i]=n>=r?n-r:0;while(--e);e=r,i=e;do n=t.prev[--i],t.prev[i]=n>=r?n-r:0;while(--e)};let fBe=(t,e,n)=>(e<<t.hash_shift^n)&t.hash_mask,jb=fBe;const $d=t=>{const e=t.state;let n=e.pending;n>t.avail_out&&(n=t.avail_out),n!==0&&(t.output.set(e.pending_buf.subarray(e.pending_out,e.pending_out+n),t.next_out),t.next_out+=n,e.pending_out+=n,t.total_out+=n,t.avail_out-=n,e.pending-=n,e.pending===0&&(e.pending_out=0))},sf=(t,e)=>{G3e(t,t.block_start>=0?t.block_start:-1,t.strstart-t.block_start,e),t.block_start=t.strstart,$d(t.strm)},ys=(t,e)=>{t.pending_buf[t.pending++]=e},hM=(t,e)=>{t.pending_buf[t.pending++]=e>>>8&255,t.pending_buf[t.pending++]=e&255},Tq=(t,e,n,i)=>{let r=t.avail_in;return r>i&&(r=i),r===0?0:(t.avail_in-=r,e.set(t.input.subarray(t.next_in,t.next_in+r),n),t.state.wrap===1?t.adler=wN(t.adler,e,r,n):t.state.wrap===2&&(t.adler=vl(t.adler,e,r,n)),t.next_in+=r,t.total_in+=r,r)},$pe=(t,e)=>{let n=t.max_chain_length,i=t.strstart,r,s,a=t.prev_length,o=t.nice_match;const c=t.strstart>t.w_size-Jg?t.strstart-(t.w_size-Jg):0,l=t.window,u=t.w_mask,h=t.prev,d=t.strstart+Cb;let f=l[i+a-1],p=l[i+a];t.prev_length>=t.good_match&&(n>>=2),o>t.lookahead&&(o=t.lookahead);do if(r=e,!(l[r+a]!==p||l[r+a-1]!==f||l[r]!==l[i]||l[++r]!==l[i+1])){i+=2,r++;do;while(l[++i]===l[++r]&&l[++i]===l[++r]&&l[++i]===l[++r]&&l[++i]===l[++r]&&l[++i]===l[++r]&&l[++i]===l[++r]&&l[++i]===l[++r]&&l[++i]===l[++r]&&i<d);if(s=Cb-(d-i),i=d-Cb,s>a){if(t.match_start=e,a=s,s>=o)break;f=l[i+a-1],p=l[i+a]}}while((e=h[e&u])>c&&--n!==0);return a<=t.lookahead?a:t.lookahead},aA=t=>{const e=t.w_size;let n,i,r;do{if(i=t.window_size-t.lookahead-t.strstart,t.strstart>=e+(e-Jg)&&(t.window.set(t.window.subarray(e,e+e-i),0),t.match_start-=e,t.strstart-=e,t.block_start-=e,t.insert>t.strstart&&(t.insert=t.strstart),dBe(t),i+=e),t.strm.avail_in===0)break;if(n=Tq(t.strm,t.window,t.strstart+t.lookahead,i),t.lookahead+=n,t.lookahead+t.insert>=Ur)for(r=t.strstart-t.insert,t.ins_h=t.window[r],t.ins_h=jb(t,t.ins_h,t.window[r+1]);t.insert&&(t.ins_h=jb(t,t.ins_h,t.window[r+Ur-1]),t.prev[r&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=r,r++,t.insert--,!(t.lookahead+t.insert<Ur)););}while(t.lookahead<Jg&&t.strm.avail_in!==0)},Wpe=(t,e)=>{let n=t.pending_buf_size-5>t.w_size?t.w_size:t.pending_buf_size-5,i,r,s,a=0,o=t.strm.avail_in;do{if(i=65535,s=t.bi_valid+42>>3,t.strm.avail_out<s||(s=t.strm.avail_out-s,r=t.strstart-t.block_start,i>r+t.strm.avail_in&&(i=r+t.strm.avail_in),i>s&&(i=s),i<n&&(i===0&&e!==rp||e===zb||i!==r+t.strm.avail_in)))break;a=e===rp&&i===r+t.strm.avail_in?1:0,vq(t,0,0,a),t.pending_buf[t.pending-4]=i,t.pending_buf[t.pending-3]=i>>8,t.pending_buf[t.pending-2]=~i,t.pending_buf[t.pending-1]=~i>>8,$d(t.strm),r&&(r>i&&(r=i),t.strm.output.set(t.window.subarray(t.block_start,t.block_start+r),t.strm.next_out),t.strm.next_out+=r,t.strm.avail_out-=r,t.strm.total_out+=r,t.block_start+=r,i-=r),i&&(Tq(t.strm,t.strm.output,t.strm.next_out,i),t.strm.next_out+=i,t.strm.avail_out-=i,t.strm.total_out+=i)}while(a===0);return o-=t.strm.avail_in,o&&(o>=t.w_size?(t.matches=2,t.window.set(t.strm.input.subarray(t.strm.next_in-t.w_size,t.strm.next_in),0),t.strstart=t.w_size,t.insert=t.strstart):(t.window_size-t.strstart<=o&&(t.strstart-=t.w_size,t.window.set(t.window.subarray(t.w_size,t.w_size+t.strstart),0),t.matches<2&&t.matches++,t.insert>t.strstart&&(t.insert=t.strstart)),t.window.set(t.strm.input.subarray(t.strm.next_in-o,t.strm.next_in),t.strstart),t.strstart+=o,t.insert+=o>t.w_size-t.insert?t.w_size-t.insert:o),t.block_start=t.strstart),t.high_water<t.strstart&&(t.high_water=t.strstart),a?hR:e!==zb&&e!==rp&&t.strm.avail_in===0&&t.strstart===t.block_start?uR:(s=t.window_size-t.strstart,t.strm.avail_in>s&&t.block_start>=t.w_size&&(t.block_start-=t.w_size,t.strstart-=t.w_size,t.window.set(t.window.subarray(t.w_size,t.w_size+t.strstart),0),t.matches<2&&t.matches++,s+=t.w_size,t.insert>t.strstart&&(t.insert=t.strstart)),s>t.strm.avail_in&&(s=t.strm.avail_in),s&&(Tq(t.strm,t.window,t.strstart,s),t.strstart+=s,t.insert+=s>t.w_size-t.insert?t.w_size-t.insert:s),t.high_water<t.strstart&&(t.high_water=t.strstart),s=t.bi_valid+42>>3,s=t.pending_buf_size-s>65535?65535:t.pending_buf_size-s,n=s>t.w_size?t.w_size:s,r=t.strstart-t.block_start,(r>=n||(r||e===rp)&&e!==zb&&t.strm.avail_in===0&&r<=s)&&(i=r>s?s:r,a=e===rp&&t.strm.avail_in===0&&i===r?1:0,vq(t,t.block_start,i,a),t.block_start+=i,$d(t.strm)),a?s1:uh)},Wj=(t,e)=>{let n,i;for(;;){if(t.lookahead<Jg){if(aA(t),t.lookahead<Jg&&e===zb)return uh;if(t.lookahead===0)break}if(n=0,t.lookahead>=Ur&&(t.ins_h=jb(t,t.ins_h,t.window[t.strstart+Ur-1]),n=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart),n!==0&&t.strstart-n<=t.w_size-Jg&&(t.match_length=$pe(t,n)),t.match_length>=Ur)if(i=Fb(t,t.strstart-t.match_start,t.match_length-Ur),t.lookahead-=t.match_length,t.match_length<=t.max_lazy_match&&t.lookahead>=Ur){t.match_length--;do t.strstart++,t.ins_h=jb(t,t.ins_h,t.window[t.strstart+Ur-1]),n=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart;while(--t.match_length!==0);t.strstart++}else t.strstart+=t.match_length,t.match_length=0,t.ins_h=t.window[t.strstart],t.ins_h=jb(t,t.ins_h,t.window[t.strstart+1]);else i=Fb(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++;if(i&&(sf(t,!1),t.strm.avail_out===0))return uh}return t.insert=t.strstart<Ur-1?t.strstart:Ur-1,e===rp?(sf(t,!0),t.strm.avail_out===0?s1:hR):t.sym_next&&(sf(t,!1),t.strm.avail_out===0)?uh:uR},aw=(t,e)=>{let n,i,r;for(;;){if(t.lookahead<Jg){if(aA(t),t.lookahead<Jg&&e===zb)return uh;if(t.lookahead===0)break}if(n=0,t.lookahead>=Ur&&(t.ins_h=jb(t,t.ins_h,t.window[t.strstart+Ur-1]),n=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart),t.prev_length=t.match_length,t.prev_match=t.match_start,t.match_length=Ur-1,n!==0&&t.prev_length<t.max_lazy_match&&t.strstart-n<=t.w_size-Jg&&(t.match_length=$pe(t,n),t.match_length<=5&&(t.strategy===X3e||t.match_length===Ur&&t.strstart-t.match_start>4096)&&(t.match_length=Ur-1)),t.prev_length>=Ur&&t.match_length<=t.prev_length){r=t.strstart+t.lookahead-Ur,i=Fb(t,t.strstart-1-t.prev_match,t.prev_length-Ur),t.lookahead-=t.prev_length-1,t.prev_length-=2;do++t.strstart<=r&&(t.ins_h=jb(t,t.ins_h,t.window[t.strstart+Ur-1]),n=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart);while(--t.prev_length!==0);if(t.match_available=0,t.match_length=Ur-1,t.strstart++,i&&(sf(t,!1),t.strm.avail_out===0))return uh}else if(t.match_available){if(i=Fb(t,0,t.window[t.strstart-1]),i&&sf(t,!1),t.strstart++,t.lookahead--,t.strm.avail_out===0)return uh}else t.match_available=1,t.strstart++,t.lookahead--}return t.match_available&&(i=Fb(t,0,t.window[t.strstart-1]),t.match_available=0),t.insert=t.strstart<Ur-1?t.strstart:Ur-1,e===rp?(sf(t,!0),t.strm.avail_out===0?s1:hR):t.sym_next&&(sf(t,!1),t.strm.avail_out===0)?uh:uR},pBe=(t,e)=>{let n,i,r,s;const a=t.window;for(;;){if(t.lookahead<=Cb){if(aA(t),t.lookahead<=Cb&&e===zb)return uh;if(t.lookahead===0)break}if(t.match_length=0,t.lookahead>=Ur&&t.strstart>0&&(r=t.strstart-1,i=a[r],i===a[++r]&&i===a[++r]&&i===a[++r])){s=t.strstart+Cb;do;while(i===a[++r]&&i===a[++r]&&i===a[++r]&&i===a[++r]&&i===a[++r]&&i===a[++r]&&i===a[++r]&&i===a[++r]&&r<s);t.match_length=Cb-(s-r),t.match_length>t.lookahead&&(t.match_length=t.lookahead)}if(t.match_length>=Ur?(n=Fb(t,1,t.match_length-Ur),t.lookahead-=t.match_length,t.strstart+=t.match_length,t.match_length=0):(n=Fb(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++),n&&(sf(t,!1),t.strm.avail_out===0))return uh}return t.insert=0,e===rp?(sf(t,!0),t.strm.avail_out===0?s1:hR):t.sym_next&&(sf(t,!1),t.strm.avail_out===0)?uh:uR},mBe=(t,e)=>{let n;for(;;){if(t.lookahead===0&&(aA(t),t.lookahead===0)){if(e===zb)return uh;break}if(t.match_length=0,n=Fb(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++,n&&(sf(t,!1),t.strm.avail_out===0))return uh}return t.insert=0,e===rp?(sf(t,!0),t.strm.avail_out===0?s1:hR):t.sym_next&&(sf(t,!1),t.strm.avail_out===0)?uh:uR};function Sg(t,e,n,i,r){this.good_length=t,this.max_lazy=e,this.nice_length=n,this.max_chain=i,this.func=r}const zM=[new Sg(0,0,0,0,Wpe),new Sg(4,4,8,4,Wj),new Sg(4,5,16,8,Wj),new Sg(4,6,32,32,Wj),new Sg(4,4,16,16,aw),new Sg(8,16,32,32,aw),new Sg(8,16,128,128,aw),new Sg(8,32,128,256,aw),new Sg(32,128,258,1024,aw),new Sg(32,258,258,4096,aw)],gBe=t=>{t.window_size=2*t.w_size,_b(t.head),t.max_lazy_match=zM[t.level].max_lazy,t.good_match=zM[t.level].good_length,t.nice_match=zM[t.level].nice_length,t.max_chain_length=zM[t.level].max_chain,t.strstart=0,t.block_start=0,t.lookahead=0,t.insert=0,t.match_length=t.prev_length=Ur-1,t.match_available=0,t.ins_h=0};function vBe(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=YF,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new Uint16Array(cBe*2),this.dyn_dtree=new Uint16Array((2*aBe+1)*2),this.bl_tree=new Uint16Array((2*oBe+1)*2),_b(this.dyn_ltree),_b(this.dyn_dtree),_b(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new Uint16Array(lBe+1),this.heap=new Uint16Array(2*_q+1),_b(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new Uint16Array(2*_q+1),_b(this.depth),this.sym_buf=0,this.lit_bufsize=0,this.sym_next=0,this.sym_end=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}const ck=t=>{if(!t)return 1;const e=t.state;return!e||e.strm!==t||e.status!==sA&&e.status!==z9&&e.status!==yq&&e.status!==bq&&e.status!==Eq&&e.status!==Sq&&e.status!==ET&&e.status!==FM?1:0},Ype=t=>{if(ck(t))return ST(t,Zg);t.total_in=t.total_out=0,t.data_type=eBe;const e=t.state;return e.pending=0,e.pending_out=0,e.wrap<0&&(e.wrap=-e.wrap),e.status=e.wrap===2?z9:e.wrap?sA:ET,t.adler=e.wrap===2?0:1,e.last_flush=-2,V3e(e),Gl},Kpe=t=>{const e=Ype(t);return e===Gl&&gBe(t.state),e},_Be=(t,e)=>ck(t)||t.state.wrap!==2?Zg:(t.state.gzhead=e,Gl),Xpe=(t,e,n,i,r,s)=>{if(!t)return Zg;let a=1;if(e===K3e&&(e=6),i<0?(a=0,i=-i):i>15&&(a=2,i-=16),r<1||r>tBe||n!==YF||i<8||i>15||e<0||e>9||s<0||s>J3e||i===8&&a!==1)return ST(t,Zg);i===8&&(i=9);const o=new vBe;return t.state=o,o.strm=t,o.status=sA,o.wrap=a,o.gzhead=null,o.w_bits=i,o.w_size=1<<o.w_bits,o.w_mask=o.w_size-1,o.hash_bits=r+7,o.hash_size=1<<o.hash_bits,o.hash_mask=o.hash_size-1,o.hash_shift=~~((o.hash_bits+Ur-1)/Ur),o.window=new Uint8Array(o.w_size*2),o.head=new Uint16Array(o.hash_size),o.prev=new Uint16Array(o.w_size),o.lit_bufsize=1<<r+6,o.pending_buf_size=o.lit_bufsize*4,o.pending_buf=new Uint8Array(o.pending_buf_size),o.sym_buf=o.lit_bufsize,o.sym_end=(o.lit_bufsize-1)*3,o.level=e,o.strategy=s,o.method=n,Kpe(t)},yBe=(t,e)=>Xpe(t,e,YF,nBe,iBe,Q3e),bBe=(t,e)=>{if(ck(t)||e>Ste||e<0)return t?ST(t,Zg):Zg;const n=t.state;if(!t.output||t.avail_in!==0&&!t.input||n.status===FM&&e!==rp)return ST(t,t.avail_out===0?$j:Zg);const i=n.last_flush;if(n.last_flush=e,n.pending!==0){if($d(t),t.avail_out===0)return n.last_flush=-1,Gl}else if(t.avail_in===0&&xte(e)<=xte(i)&&e!==rp)return ST(t,$j);if(n.status===FM&&t.avail_in!==0)return ST(t,$j);if(n.status===sA&&n.wrap===0&&(n.status=ET),n.status===sA){let r=YF+(n.w_bits-8<<4)<<8,s=-1;if(n.strategy>=DD||n.level<2?s=0:n.level<6?s=1:n.level===6?s=2:s=3,r|=s<<6,n.strstart!==0&&(r|=uBe),r+=31-r%31,hM(n,r),n.strstart!==0&&(hM(n,t.adler>>>16),hM(n,t.adler&65535)),t.adler=1,n.status=ET,$d(t),n.pending!==0)return n.last_flush=-1,Gl}if(n.status===z9){if(t.adler=0,ys(n,31),ys(n,139),ys(n,8),n.gzhead)ys(n,(n.gzhead.text?1:0)+(n.gzhead.hcrc?2:0)+(n.gzhead.extra?4:0)+(n.gzhead.name?8:0)+(n.gzhead.comment?16:0)),ys(n,n.gzhead.time&255),ys(n,n.gzhead.time>>8&255),ys(n,n.gzhead.time>>16&255),ys(n,n.gzhead.time>>24&255),ys(n,n.level===9?2:n.strategy>=DD||n.level<2?4:0),ys(n,n.gzhead.os&255),n.gzhead.extra&&n.gzhead.extra.length&&(ys(n,n.gzhead.extra.length&255),ys(n,n.gzhead.extra.length>>8&255)),n.gzhead.hcrc&&(t.adler=vl(t.adler,n.pending_buf,n.pending,0)),n.gzindex=0,n.status=yq;else if(ys(n,0),ys(n,0),ys(n,0),ys(n,0),ys(n,0),ys(n,n.level===9?2:n.strategy>=DD||n.level<2?4:0),ys(n,hBe),n.status=ET,$d(t),n.pending!==0)return n.last_flush=-1,Gl}if(n.status===yq){if(n.gzhead.extra){let r=n.pending,s=(n.gzhead.extra.length&65535)-n.gzindex;for(;n.pending+s>n.pending_buf_size;){let o=n.pending_buf_size-n.pending;if(n.pending_buf.set(n.gzhead.extra.subarray(n.gzindex,n.gzindex+o),n.pending),n.pending=n.pending_buf_size,n.gzhead.hcrc&&n.pending>r&&(t.adler=vl(t.adler,n.pending_buf,n.pending-r,r)),n.gzindex+=o,$d(t),n.pending!==0)return n.last_flush=-1,Gl;r=0,s-=o}let a=new Uint8Array(n.gzhead.extra);n.pending_buf.set(a.subarray(n.gzindex,n.gzindex+s),n.pending),n.pending+=s,n.gzhead.hcrc&&n.pending>r&&(t.adler=vl(t.adler,n.pending_buf,n.pending-r,r)),n.gzindex=0}n.status=bq}if(n.status===bq){if(n.gzhead.name){let r=n.pending,s;do{if(n.pending===n.pending_buf_size){if(n.gzhead.hcrc&&n.pending>r&&(t.adler=vl(t.adler,n.pending_buf,n.pending-r,r)),$d(t),n.pending!==0)return n.last_flush=-1,Gl;r=0}n.gzindex<n.gzhead.name.length?s=n.gzhead.name.charCodeAt(n.gzindex++)&255:s=0,ys(n,s)}while(s!==0);n.gzhead.hcrc&&n.pending>r&&(t.adler=vl(t.adler,n.pending_buf,n.pending-r,r)),n.gzindex=0}n.status=Eq}if(n.status===Eq){if(n.gzhead.comment){let r=n.pending,s;do{if(n.pending===n.pending_buf_size){if(n.gzhead.hcrc&&n.pending>r&&(t.adler=vl(t.adler,n.pending_buf,n.pending-r,r)),$d(t),n.pending!==0)return n.last_flush=-1,Gl;r=0}n.gzindex<n.gzhead.comment.length?s=n.gzhead.comment.charCodeAt(n.gzindex++)&255:s=0,ys(n,s)}while(s!==0);n.gzhead.hcrc&&n.pending>r&&(t.adler=vl(t.adler,n.pending_buf,n.pending-r,r))}n.status=Sq}if(n.status===Sq){if(n.gzhead.hcrc){if(n.pending+2>n.pending_buf_size&&($d(t),n.pending!==0))return n.last_flush=-1,Gl;ys(n,t.adler&255),ys(n,t.adler>>8&255),t.adler=0}if(n.status=ET,$d(t),n.pending!==0)return n.last_flush=-1,Gl}if(t.avail_in!==0||n.lookahead!==0||e!==zb&&n.status!==FM){let r=n.level===0?Wpe(n,e):n.strategy===DD?mBe(n,e):n.strategy===Z3e?pBe(n,e):zM[n.level].func(n,e);if((r===s1||r===hR)&&(n.status=FM),r===uh||r===s1)return t.avail_out===0&&(n.last_flush=-1),Gl;if(r===uR&&(e===$3e?q3e(n):e!==Ste&&(vq(n,0,0,!1),e===W3e&&(_b(n.head),n.lookahead===0&&(n.strstart=0,n.block_start=0,n.insert=0))),$d(t),t.avail_out===0))return n.last_flush=-1,Gl}return e!==rp?Gl:n.wrap<=0?Tte:(n.wrap===2?(ys(n,t.adler&255),ys(n,t.adler>>8&255),ys(n,t.adler>>16&255),ys(n,t.adler>>24&255),ys(n,t.total_in&255),ys(n,t.total_in>>8&255),ys(n,t.total_in>>16&255),ys(n,t.total_in>>24&255)):(hM(n,t.adler>>>16),hM(n,t.adler&65535)),$d(t),n.wrap>0&&(n.wrap=-n.wrap),n.pending!==0?Gl:Tte)},EBe=t=>{if(ck(t))return Zg;const e=t.state.status;return t.state=null,e===ET?ST(t,Y3e):Gl},SBe=(t,e)=>{let n=e.length;if(ck(t))return Zg;const i=t.state,r=i.wrap;if(r===2||r===1&&i.status!==sA||i.lookahead)return Zg;if(r===1&&(t.adler=wN(t.adler,e,n,0)),i.wrap=0,n>=i.w_size){r===0&&(_b(i.head),i.strstart=0,i.block_start=0,i.insert=0);let c=new Uint8Array(i.w_size);c.set(e.subarray(n-i.w_size,n),0),e=c,n=i.w_size}const s=t.avail_in,a=t.next_in,o=t.input;for(t.avail_in=n,t.next_in=0,t.input=e,aA(i);i.lookahead>=Ur;){let c=i.strstart,l=i.lookahead-(Ur-1);do i.ins_h=jb(i,i.ins_h,i.window[c+Ur-1]),i.prev[c&i.w_mask]=i.head[i.ins_h],i.head[i.ins_h]=c,c++;while(--l);i.strstart=c,i.lookahead=Ur-1,aA(i)}return i.strstart+=i.lookahead,i.block_start=i.strstart,i.insert=i.lookahead,i.lookahead=0,i.match_length=i.prev_length=Ur-1,i.match_available=0,t.next_in=a,t.input=o,t.avail_in=s,i.wrap=r,Gl};var TBe=yBe,xBe=Xpe,wBe=Kpe,CBe=Ype,ABe=_Be,RBe=bBe,MBe=EBe,OBe=SBe,NBe="pako deflate (from Nodeca project)",xO={deflateInit:TBe,deflateInit2:xBe,deflateReset:wBe,deflateResetKeep:CBe,deflateSetHeader:ABe,deflate:RBe,deflateEnd:MBe,deflateSetDictionary:OBe,deflateInfo:NBe};const IBe=(t,e)=>Object.prototype.hasOwnProperty.call(t,e);var kBe=function(t){const e=Array.prototype.slice.call(arguments,1);for(;e.length;){const n=e.shift();if(n){if(typeof n!="object")throw new TypeError(n+"must be non-object");for(const i in n)IBe(n,i)&&(t[i]=n[i])}}return t},PBe=t=>{let e=0;for(let i=0,r=t.length;i<r;i++)e+=t[i].length;const n=new Uint8Array(e);for(let i=0,r=0,s=t.length;i<s;i++){let a=t[i];n.set(a,r),r+=a.length}return n},KF={assign:kBe,flattenChunks:PBe};let Zpe=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{Zpe=!1}const CN=new Uint8Array(256);for(let t=0;t<256;t++)CN[t]=t>=252?6:t>=248?5:t>=240?4:t>=224?3:t>=192?2:1;CN[254]=CN[254]=1;var DBe=t=>{if(typeof TextEncoder=="function"&&TextEncoder.prototype.encode)return new TextEncoder().encode(t);let e,n,i,r,s,a=t.length,o=0;for(r=0;r<a;r++)n=t.charCodeAt(r),(n&64512)===55296&&r+1<a&&(i=t.charCodeAt(r+1),(i&64512)===56320&&(n=65536+(n-55296<<10)+(i-56320),r++)),o+=n<128?1:n<2048?2:n<65536?3:4;for(e=new Uint8Array(o),s=0,r=0;s<o;r++)n=t.charCodeAt(r),(n&64512)===55296&&r+1<a&&(i=t.charCodeAt(r+1),(i&64512)===56320&&(n=65536+(n-55296<<10)+(i-56320),r++)),n<128?e[s++]=n:n<2048?(e[s++]=192|n>>>6,e[s++]=128|n&63):n<65536?(e[s++]=224|n>>>12,e[s++]=128|n>>>6&63,e[s++]=128|n&63):(e[s++]=240|n>>>18,e[s++]=128|n>>>12&63,e[s++]=128|n>>>6&63,e[s++]=128|n&63);return e};const LBe=(t,e)=>{if(e<65534&&t.subarray&&Zpe)return String.fromCharCode.apply(null,t.length===e?t:t.subarray(0,e));let n="";for(let i=0;i<e;i++)n+=String.fromCharCode(t[i]);return n};var UBe=(t,e)=>{const n=e||t.length;if(typeof TextDecoder=="function"&&TextDecoder.prototype.decode)return new TextDecoder().decode(t.subarray(0,e));let i,r;const s=new Array(n*2);for(r=0,i=0;i<n;){let a=t[i++];if(a<128){s[r++]=a;continue}let o=CN[a];if(o>4){s[r++]=65533,i+=o-1;continue}for(a&=o===2?31:o===3?15:7;o>1&&i<n;)a=a<<6|t[i++]&63,o--;if(o>1){s[r++]=65533;continue}a<65536?s[r++]=a:(a-=65536,s[r++]=55296|a>>10&1023,s[r++]=56320|a&1023)}return LBe(s,r)},BBe=(t,e)=>{e=e||t.length,e>t.length&&(e=t.length);let n=e-1;for(;n>=0&&(t[n]&192)===128;)n--;return n<0||n===0?e:n+CN[t[n]]>e?n:e},AN={string2buf:DBe,buf2string:UBe,utf8border:BBe};function FBe(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}var Jpe=FBe;const Qpe=Object.prototype.toString,{Z_NO_FLUSH:zBe,Z_SYNC_FLUSH:jBe,Z_FULL_FLUSH:HBe,Z_FINISH:VBe,Z_OK:g3,Z_STREAM_END:GBe,Z_DEFAULT_COMPRESSION:qBe,Z_DEFAULT_STRATEGY:$Be,Z_DEFLATED:WBe}=j1;function lk(t){this.options=KF.assign({level:qBe,method:WBe,chunkSize:16384,windowBits:15,memLevel:8,strategy:$Be},t||{});let e=this.options;e.raw&&e.windowBits>0?e.windowBits=-e.windowBits:e.gzip&&e.windowBits>0&&e.windowBits<16&&(e.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new Jpe,this.strm.avail_out=0;let n=xO.deflateInit2(this.strm,e.level,e.method,e.windowBits,e.memLevel,e.strategy);if(n!==g3)throw new Error(r1[n]);if(e.header&&xO.deflateSetHeader(this.strm,e.header),e.dictionary){let i;if(typeof e.dictionary=="string"?i=AN.string2buf(e.dictionary):Qpe.call(e.dictionary)==="[object ArrayBuffer]"?i=new Uint8Array(e.dictionary):i=e.dictionary,n=xO.deflateSetDictionary(this.strm,i),n!==g3)throw new Error(r1[n]);this._dict_set=!0}}lk.prototype.push=function(t,e){const n=this.strm,i=this.options.chunkSize;let r,s;if(this.ended)return!1;for(e===~~e?s=e:s=e===!0?VBe:zBe,typeof t=="string"?n.input=AN.string2buf(t):Qpe.call(t)==="[object ArrayBuffer]"?n.input=new Uint8Array(t):n.input=t,n.next_in=0,n.avail_in=n.input.length;;){if(n.avail_out===0&&(n.output=new Uint8Array(i),n.next_out=0,n.avail_out=i),(s===jBe||s===HBe)&&n.avail_out<=6){this.onData(n.output.subarray(0,n.next_out)),n.avail_out=0;continue}if(r=xO.deflate(n,s),r===GBe)return n.next_out>0&&this.onData(n.output.subarray(0,n.next_out)),r=xO.deflateEnd(this.strm),this.onEnd(r),this.ended=!0,r===g3;if(n.avail_out===0){this.onData(n.output);continue}if(s>0&&n.next_out>0){this.onData(n.output.subarray(0,n.next_out)),n.avail_out=0;continue}if(n.avail_in===0)break}return!0};lk.prototype.onData=function(t){this.chunks.push(t)};lk.prototype.onEnd=function(t){t===g3&&(this.result=KF.flattenChunks(this.chunks)),this.chunks=[],this.err=t,this.msg=this.strm.msg};function j9(t,e){const n=new lk(e);if(n.push(t,!0),n.err)throw n.msg||r1[n.err];return n.result}function YBe(t,e){return e=e||{},e.raw=!0,j9(t,e)}function KBe(t,e){return e=e||{},e.gzip=!0,j9(t,e)}var XBe=lk,ZBe=j9,JBe=YBe,QBe=KBe,eFe=j1,tFe={Deflate:XBe,deflate:ZBe,deflateRaw:JBe,gzip:QBe,constants:eFe};const LD=16209,nFe=16191;var iFe=function(e,n){let i,r,s,a,o,c,l,u,h,d,f,p,g,_,v,b,S,x,M,R,I,k,P,U;const V=e.state;i=e.next_in,P=e.input,r=i+(e.avail_in-5),s=e.next_out,U=e.output,a=s-(n-e.avail_out),o=s+(e.avail_out-257),c=V.dmax,l=V.wsize,u=V.whave,h=V.wnext,d=V.window,f=V.hold,p=V.bits,g=V.lencode,_=V.distcode,v=(1<<V.lenbits)-1,b=(1<<V.distbits)-1;e:do{p<15&&(f+=P[i++]<<p,p+=8,f+=P[i++]<<p,p+=8),S=g[f&v];t:for(;;){if(x=S>>>24,f>>>=x,p-=x,x=S>>>16&255,x===0)U[s++]=S&65535;else if(x&16){M=S&65535,x&=15,x&&(p<x&&(f+=P[i++]<<p,p+=8),M+=f&(1<<x)-1,f>>>=x,p-=x),p<15&&(f+=P[i++]<<p,p+=8,f+=P[i++]<<p,p+=8),S=_[f&b];n:for(;;){if(x=S>>>24,f>>>=x,p-=x,x=S>>>16&255,x&16){if(R=S&65535,x&=15,p<x&&(f+=P[i++]<<p,p+=8,p<x&&(f+=P[i++]<<p,p+=8)),R+=f&(1<<x)-1,R>c){e.msg="invalid distance too far back",V.mode=LD;break e}if(f>>>=x,p-=x,x=s-a,R>x){if(x=R-x,x>u&&V.sane){e.msg="invalid distance too far back",V.mode=LD;break e}if(I=0,k=d,h===0){if(I+=l-x,x<M){M-=x;do U[s++]=d[I++];while(--x);I=s-R,k=U}}else if(h<x){if(I+=l+h-x,x-=h,x<M){M-=x;do U[s++]=d[I++];while(--x);if(I=0,h<M){x=h,M-=x;do U[s++]=d[I++];while(--x);I=s-R,k=U}}}else if(I+=h-x,x<M){M-=x;do U[s++]=d[I++];while(--x);I=s-R,k=U}for(;M>2;)U[s++]=k[I++],U[s++]=k[I++],U[s++]=k[I++],M-=3;M&&(U[s++]=k[I++],M>1&&(U[s++]=k[I++]))}else{I=s-R;do U[s++]=U[I++],U[s++]=U[I++],U[s++]=U[I++],M-=3;while(M>2);M&&(U[s++]=U[I++],M>1&&(U[s++]=U[I++]))}}else if(x&64){e.msg="invalid distance code",V.mode=LD;break e}else{S=_[(S&65535)+(f&(1<<x)-1)];continue n}break}}else if(x&64)if(x&32){V.mode=nFe;break e}else{e.msg="invalid literal/length code",V.mode=LD;break e}else{S=g[(S&65535)+(f&(1<<x)-1)];continue t}break}}while(i<r&&s<o);M=p>>3,i-=M,p-=M<<3,f&=(1<<p)-1,e.next_in=i,e.next_out=s,e.avail_in=i<r?5+(r-i):5-(i-r),e.avail_out=s<o?257+(o-s):257-(s-o),V.hold=f,V.bits=p};const ow=15,wte=852,Cte=592,Ate=0,Yj=1,Rte=2,rFe=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),sFe=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),aFe=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),oFe=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]),cFe=(t,e,n,i,r,s,a,o)=>{const c=o.bits;let l=0,u=0,h=0,d=0,f=0,p=0,g=0,_=0,v=0,b=0,S,x,M,R,I,k=null,P;const U=new Uint16Array(ow+1),V=new Uint16Array(ow+1);let $=null,q,Y,te;for(l=0;l<=ow;l++)U[l]=0;for(u=0;u<i;u++)U[e[n+u]]++;for(f=c,d=ow;d>=1&&U[d]===0;d--);if(f>d&&(f=d),d===0)return r[s++]=1<<24|64<<16|0,r[s++]=1<<24|64<<16|0,o.bits=1,0;for(h=1;h<d&&U[h]===0;h++);for(f<h&&(f=h),_=1,l=1;l<=ow;l++)if(_<<=1,_-=U[l],_<0)return-1;if(_>0&&(t===Ate||d!==1))return-1;for(V[1]=0,l=1;l<ow;l++)V[l+1]=V[l]+U[l];for(u=0;u<i;u++)e[n+u]!==0&&(a[V[e[n+u]]++]=u);if(t===Ate?(k=$=a,P=20):t===Yj?(k=rFe,$=sFe,P=257):(k=aFe,$=oFe,P=0),b=0,u=0,l=h,I=s,p=f,g=0,M=-1,v=1<<f,R=v-1,t===Yj&&v>wte||t===Rte&&v>Cte)return 1;for(;;){q=l-g,a[u]+1<P?(Y=0,te=a[u]):a[u]>=P?(Y=$[a[u]-P],te=k[a[u]-P]):(Y=96,te=0),S=1<<l-g,x=1<<p,h=x;do x-=S,r[I+(b>>g)+x]=q<<24|Y<<16|te|0;while(x!==0);for(S=1<<l-1;b&S;)S>>=1;if(S!==0?(b&=S-1,b+=S):b=0,u++,--U[l]===0){if(l===d)break;l=e[n+a[u]]}if(l>f&&(b&R)!==M){for(g===0&&(g=f),I+=h,p=l-g,_=1<<p;p+g<d&&(_-=U[p+g],!(_<=0));)p++,_<<=1;if(v+=1<<p,t===Yj&&v>wte||t===Rte&&v>Cte)return 1;M=b&R,r[M]=f<<24|p<<16|I-s|0}}return b!==0&&(r[I+b]=l-g<<24|64<<16|0),o.bits=f,0};var wO=cFe;const lFe=0,eme=1,tme=2,{Z_FINISH:Mte,Z_BLOCK:uFe,Z_TREES:UD,Z_OK:a1,Z_STREAM_END:hFe,Z_NEED_DICT:dFe,Z_STREAM_ERROR:Tp,Z_DATA_ERROR:nme,Z_MEM_ERROR:ime,Z_BUF_ERROR:fFe,Z_DEFLATED:Ote}=j1,XF=16180,Nte=16181,Ite=16182,kte=16183,Pte=16184,Dte=16185,Lte=16186,Ute=16187,Bte=16188,Fte=16189,v3=16190,kv=16191,Kj=16192,zte=16193,Xj=16194,jte=16195,Hte=16196,Vte=16197,Gte=16198,BD=16199,FD=16200,qte=16201,$te=16202,Wte=16203,Yte=16204,Kte=16205,Zj=16206,Xte=16207,Zte=16208,La=16209,rme=16210,sme=16211,pFe=852,mFe=592,gFe=15,vFe=gFe,Jte=t=>(t>>>24&255)+(t>>>8&65280)+((t&65280)<<8)+((t&255)<<24);function _Fe(){this.strm=null,this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}const H1=t=>{if(!t)return 1;const e=t.state;return!e||e.strm!==t||e.mode<XF||e.mode>sme?1:0},ame=t=>{if(H1(t))return Tp;const e=t.state;return t.total_in=t.total_out=e.total=0,t.msg="",e.wrap&&(t.adler=e.wrap&1),e.mode=XF,e.last=0,e.havedict=0,e.flags=-1,e.dmax=32768,e.head=null,e.hold=0,e.bits=0,e.lencode=e.lendyn=new Int32Array(pFe),e.distcode=e.distdyn=new Int32Array(mFe),e.sane=1,e.back=-1,a1},ome=t=>{if(H1(t))return Tp;const e=t.state;return e.wsize=0,e.whave=0,e.wnext=0,ame(t)},cme=(t,e)=>{let n;if(H1(t))return Tp;const i=t.state;return e<0?(n=0,e=-e):(n=(e>>4)+5,e<48&&(e&=15)),e&&(e<8||e>15)?Tp:(i.window!==null&&i.wbits!==e&&(i.window=null),i.wrap=n,i.wbits=e,ome(t))},lme=(t,e)=>{if(!t)return Tp;const n=new _Fe;t.state=n,n.strm=t,n.window=null,n.mode=XF;const i=cme(t,e);return i!==a1&&(t.state=null),i},yFe=t=>lme(t,vFe);let Qte=!0,Jj,Qj;const bFe=t=>{if(Qte){Jj=new Int32Array(512),Qj=new Int32Array(32);let e=0;for(;e<144;)t.lens[e++]=8;for(;e<256;)t.lens[e++]=9;for(;e<280;)t.lens[e++]=7;for(;e<288;)t.lens[e++]=8;for(wO(eme,t.lens,0,288,Jj,0,t.work,{bits:9}),e=0;e<32;)t.lens[e++]=5;wO(tme,t.lens,0,32,Qj,0,t.work,{bits:5}),Qte=!1}t.lencode=Jj,t.lenbits=9,t.distcode=Qj,t.distbits=5},ume=(t,e,n,i)=>{let r;const s=t.state;return s.window===null&&(s.wsize=1<<s.wbits,s.wnext=0,s.whave=0,s.window=new Uint8Array(s.wsize)),i>=s.wsize?(s.window.set(e.subarray(n-s.wsize,n),0),s.wnext=0,s.whave=s.wsize):(r=s.wsize-s.wnext,r>i&&(r=i),s.window.set(e.subarray(n-i,n-i+r),s.wnext),i-=r,i?(s.window.set(e.subarray(n-i,n),0),s.wnext=i,s.whave=s.wsize):(s.wnext+=r,s.wnext===s.wsize&&(s.wnext=0),s.whave<s.wsize&&(s.whave+=r))),0},EFe=(t,e)=>{let n,i,r,s,a,o,c,l,u,h,d,f,p,g,_=0,v,b,S,x,M,R,I,k;const P=new Uint8Array(4);let U,V;const $=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(H1(t)||!t.output||!t.input&&t.avail_in!==0)return Tp;n=t.state,n.mode===kv&&(n.mode=Kj),a=t.next_out,r=t.output,c=t.avail_out,s=t.next_in,i=t.input,o=t.avail_in,l=n.hold,u=n.bits,h=o,d=c,k=a1;e:for(;;)switch(n.mode){case XF:if(n.wrap===0){n.mode=Kj;break}for(;u<16;){if(o===0)break e;o--,l+=i[s++]<<u,u+=8}if(n.wrap&2&&l===35615){n.wbits===0&&(n.wbits=15),n.check=0,P[0]=l&255,P[1]=l>>>8&255,n.check=vl(n.check,P,2,0),l=0,u=0,n.mode=Nte;break}if(n.head&&(n.head.done=!1),!(n.wrap&1)||(((l&255)<<8)+(l>>8))%31){t.msg="incorrect header check",n.mode=La;break}if((l&15)!==Ote){t.msg="unknown compression method",n.mode=La;break}if(l>>>=4,u-=4,I=(l&15)+8,n.wbits===0&&(n.wbits=I),I>15||I>n.wbits){t.msg="invalid window size",n.mode=La;break}n.dmax=1<<n.wbits,n.flags=0,t.adler=n.check=1,n.mode=l&512?Fte:kv,l=0,u=0;break;case Nte:for(;u<16;){if(o===0)break e;o--,l+=i[s++]<<u,u+=8}if(n.flags=l,(n.flags&255)!==Ote){t.msg="unknown compression method",n.mode=La;break}if(n.flags&57344){t.msg="unknown header flags set",n.mode=La;break}n.head&&(n.head.text=l>>8&1),n.flags&512&&n.wrap&4&&(P[0]=l&255,P[1]=l>>>8&255,n.check=vl(n.check,P,2,0)),l=0,u=0,n.mode=Ite;case Ite:for(;u<32;){if(o===0)break e;o--,l+=i[s++]<<u,u+=8}n.head&&(n.head.time=l),n.flags&512&&n.wrap&4&&(P[0]=l&255,P[1]=l>>>8&255,P[2]=l>>>16&255,P[3]=l>>>24&255,n.check=vl(n.check,P,4,0)),l=0,u=0,n.mode=kte;case kte:for(;u<16;){if(o===0)break e;o--,l+=i[s++]<<u,u+=8}n.head&&(n.head.xflags=l&255,n.head.os=l>>8),n.flags&512&&n.wrap&4&&(P[0]=l&255,P[1]=l>>>8&255,n.check=vl(n.check,P,2,0)),l=0,u=0,n.mode=Pte;case Pte:if(n.flags&1024){for(;u<16;){if(o===0)break e;o--,l+=i[s++]<<u,u+=8}n.length=l,n.head&&(n.head.extra_len=l),n.flags&512&&n.wrap&4&&(P[0]=l&255,P[1]=l>>>8&255,n.check=vl(n.check,P,2,0)),l=0,u=0}else n.head&&(n.head.extra=null);n.mode=Dte;case Dte:if(n.flags&1024&&(f=n.length,f>o&&(f=o),f&&(n.head&&(I=n.head.extra_len-n.length,n.head.extra||(n.head.extra=new Uint8Array(n.head.extra_len)),n.head.extra.set(i.subarray(s,s+f),I)),n.flags&512&&n.wrap&4&&(n.check=vl(n.check,i,f,s)),o-=f,s+=f,n.length-=f),n.length))break e;n.length=0,n.mode=Lte;case Lte:if(n.flags&2048){if(o===0)break e;f=0;do I=i[s+f++],n.head&&I&&n.length<65536&&(n.head.name+=String.fromCharCode(I));while(I&&f<o);if(n.flags&512&&n.wrap&4&&(n.check=vl(n.check,i,f,s)),o-=f,s+=f,I)break e}else n.head&&(n.head.name=null);n.length=0,n.mode=Ute;case Ute:if(n.flags&4096){if(o===0)break e;f=0;do I=i[s+f++],n.head&&I&&n.length<65536&&(n.head.comment+=String.fromCharCode(I));while(I&&f<o);if(n.flags&512&&n.wrap&4&&(n.check=vl(n.check,i,f,s)),o-=f,s+=f,I)break e}else n.head&&(n.head.comment=null);n.mode=Bte;case Bte:if(n.flags&512){for(;u<16;){if(o===0)break e;o--,l+=i[s++]<<u,u+=8}if(n.wrap&4&&l!==(n.check&65535)){t.msg="header crc mismatch",n.mode=La;break}l=0,u=0}n.head&&(n.head.hcrc=n.flags>>9&1,n.head.done=!0),t.adler=n.check=0,n.mode=kv;break;case Fte:for(;u<32;){if(o===0)break e;o--,l+=i[s++]<<u,u+=8}t.adler=n.check=Jte(l),l=0,u=0,n.mode=v3;case v3:if(n.havedict===0)return t.next_out=a,t.avail_out=c,t.next_in=s,t.avail_in=o,n.hold=l,n.bits=u,dFe;t.adler=n.check=1,n.mode=kv;case kv:if(e===uFe||e===UD)break e;case Kj:if(n.last){l>>>=u&7,u-=u&7,n.mode=Zj;break}for(;u<3;){if(o===0)break e;o--,l+=i[s++]<<u,u+=8}switch(n.last=l&1,l>>>=1,u-=1,l&3){case 0:n.mode=zte;break;case 1:if(bFe(n),n.mode=BD,e===UD){l>>>=2,u-=2;break e}break;case 2:n.mode=Hte;break;case 3:t.msg="invalid block type",n.mode=La}l>>>=2,u-=2;break;case zte:for(l>>>=u&7,u-=u&7;u<32;){if(o===0)break e;o--,l+=i[s++]<<u,u+=8}if((l&65535)!==(l>>>16^65535)){t.msg="invalid stored block lengths",n.mode=La;break}if(n.length=l&65535,l=0,u=0,n.mode=Xj,e===UD)break e;case Xj:n.mode=jte;case jte:if(f=n.length,f){if(f>o&&(f=o),f>c&&(f=c),f===0)break e;r.set(i.subarray(s,s+f),a),o-=f,s+=f,c-=f,a+=f,n.length-=f;break}n.mode=kv;break;case Hte:for(;u<14;){if(o===0)break e;o--,l+=i[s++]<<u,u+=8}if(n.nlen=(l&31)+257,l>>>=5,u-=5,n.ndist=(l&31)+1,l>>>=5,u-=5,n.ncode=(l&15)+4,l>>>=4,u-=4,n.nlen>286||n.ndist>30){t.msg="too many length or distance symbols",n.mode=La;break}n.have=0,n.mode=Vte;case Vte:for(;n.have<n.ncode;){for(;u<3;){if(o===0)break e;o--,l+=i[s++]<<u,u+=8}n.lens[$[n.have++]]=l&7,l>>>=3,u-=3}for(;n.have<19;)n.lens[$[n.have++]]=0;if(n.lencode=n.lendyn,n.lenbits=7,U={bits:n.lenbits},k=wO(lFe,n.lens,0,19,n.lencode,0,n.work,U),n.lenbits=U.bits,k){t.msg="invalid code lengths set",n.mode=La;break}n.have=0,n.mode=Gte;case Gte:for(;n.have<n.nlen+n.ndist;){for(;_=n.lencode[l&(1<<n.lenbits)-1],v=_>>>24,b=_>>>16&255,S=_&65535,!(v<=u);){if(o===0)break e;o--,l+=i[s++]<<u,u+=8}if(S<16)l>>>=v,u-=v,n.lens[n.have++]=S;else{if(S===16){for(V=v+2;u<V;){if(o===0)break e;o--,l+=i[s++]<<u,u+=8}if(l>>>=v,u-=v,n.have===0){t.msg="invalid bit length repeat",n.mode=La;break}I=n.lens[n.have-1],f=3+(l&3),l>>>=2,u-=2}else if(S===17){for(V=v+3;u<V;){if(o===0)break e;o--,l+=i[s++]<<u,u+=8}l>>>=v,u-=v,I=0,f=3+(l&7),l>>>=3,u-=3}else{for(V=v+7;u<V;){if(o===0)break e;o--,l+=i[s++]<<u,u+=8}l>>>=v,u-=v,I=0,f=11+(l&127),l>>>=7,u-=7}if(n.have+f>n.nlen+n.ndist){t.msg="invalid bit length repeat",n.mode=La;break}for(;f--;)n.lens[n.have++]=I}}if(n.mode===La)break;if(n.lens[256]===0){t.msg="invalid code -- missing end-of-block",n.mode=La;break}if(n.lenbits=9,U={bits:n.lenbits},k=wO(eme,n.lens,0,n.nlen,n.lencode,0,n.work,U),n.lenbits=U.bits,k){t.msg="invalid literal/lengths set",n.mode=La;break}if(n.distbits=6,n.distcode=n.distdyn,U={bits:n.distbits},k=wO(tme,n.lens,n.nlen,n.ndist,n.distcode,0,n.work,U),n.distbits=U.bits,k){t.msg="invalid distances set",n.mode=La;break}if(n.mode=BD,e===UD)break e;case BD:n.mode=FD;case FD:if(o>=6&&c>=258){t.next_out=a,t.avail_out=c,t.next_in=s,t.avail_in=o,n.hold=l,n.bits=u,iFe(t,d),a=t.next_out,r=t.output,c=t.avail_out,s=t.next_in,i=t.input,o=t.avail_in,l=n.hold,u=n.bits,n.mode===kv&&(n.back=-1);break}for(n.back=0;_=n.lencode[l&(1<<n.lenbits)-1],v=_>>>24,b=_>>>16&255,S=_&65535,!(v<=u);){if(o===0)break e;o--,l+=i[s++]<<u,u+=8}if(b&&!(b&240)){for(x=v,M=b,R=S;_=n.lencode[R+((l&(1<<x+M)-1)>>x)],v=_>>>24,b=_>>>16&255,S=_&65535,!(x+v<=u);){if(o===0)break e;o--,l+=i[s++]<<u,u+=8}l>>>=x,u-=x,n.back+=x}if(l>>>=v,u-=v,n.back+=v,n.length=S,b===0){n.mode=Kte;break}if(b&32){n.back=-1,n.mode=kv;break}if(b&64){t.msg="invalid literal/length code",n.mode=La;break}n.extra=b&15,n.mode=qte;case qte:if(n.extra){for(V=n.extra;u<V;){if(o===0)break e;o--,l+=i[s++]<<u,u+=8}n.length+=l&(1<<n.extra)-1,l>>>=n.extra,u-=n.extra,n.back+=n.extra}n.was=n.length,n.mode=$te;case $te:for(;_=n.distcode[l&(1<<n.distbits)-1],v=_>>>24,b=_>>>16&255,S=_&65535,!(v<=u);){if(o===0)break e;o--,l+=i[s++]<<u,u+=8}if(!(b&240)){for(x=v,M=b,R=S;_=n.distcode[R+((l&(1<<x+M)-1)>>x)],v=_>>>24,b=_>>>16&255,S=_&65535,!(x+v<=u);){if(o===0)break e;o--,l+=i[s++]<<u,u+=8}l>>>=x,u-=x,n.back+=x}if(l>>>=v,u-=v,n.back+=v,b&64){t.msg="invalid distance code",n.mode=La;break}n.offset=S,n.extra=b&15,n.mode=Wte;case Wte:if(n.extra){for(V=n.extra;u<V;){if(o===0)break e;o--,l+=i[s++]<<u,u+=8}n.offset+=l&(1<<n.extra)-1,l>>>=n.extra,u-=n.extra,n.back+=n.extra}if(n.offset>n.dmax){t.msg="invalid distance too far back",n.mode=La;break}n.mode=Yte;case Yte:if(c===0)break e;if(f=d-c,n.offset>f){if(f=n.offset-f,f>n.whave&&n.sane){t.msg="invalid distance too far back",n.mode=La;break}f>n.wnext?(f-=n.wnext,p=n.wsize-f):p=n.wnext-f,f>n.length&&(f=n.length),g=n.window}else g=r,p=a-n.offset,f=n.length;f>c&&(f=c),c-=f,n.length-=f;do r[a++]=g[p++];while(--f);n.length===0&&(n.mode=FD);break;case Kte:if(c===0)break e;r[a++]=n.length,c--,n.mode=FD;break;case Zj:if(n.wrap){for(;u<32;){if(o===0)break e;o--,l|=i[s++]<<u,u+=8}if(d-=c,t.total_out+=d,n.total+=d,n.wrap&4&&d&&(t.adler=n.check=n.flags?vl(n.check,r,d,a-d):wN(n.check,r,d,a-d)),d=c,n.wrap&4&&(n.flags?l:Jte(l))!==n.check){t.msg="incorrect data check",n.mode=La;break}l=0,u=0}n.mode=Xte;case Xte:if(n.wrap&&n.flags){for(;u<32;){if(o===0)break e;o--,l+=i[s++]<<u,u+=8}if(n.wrap&4&&l!==(n.total&4294967295)){t.msg="incorrect length check",n.mode=La;break}l=0,u=0}n.mode=Zte;case Zte:k=hFe;break e;case La:k=nme;break e;case rme:return ime;case sme:default:return Tp}return t.next_out=a,t.avail_out=c,t.next_in=s,t.avail_in=o,n.hold=l,n.bits=u,(n.wsize||d!==t.avail_out&&n.mode<La&&(n.mode<Zj||e!==Mte))&&ume(t,t.output,t.next_out,d-t.avail_out),h-=t.avail_in,d-=t.avail_out,t.total_in+=h,t.total_out+=d,n.total+=d,n.wrap&4&&d&&(t.adler=n.check=n.flags?vl(n.check,r,d,t.next_out-d):wN(n.check,r,d,t.next_out-d)),t.data_type=n.bits+(n.last?64:0)+(n.mode===kv?128:0)+(n.mode===BD||n.mode===Xj?256:0),(h===0&&d===0||e===Mte)&&k===a1&&(k=fFe),k},SFe=t=>{if(H1(t))return Tp;let e=t.state;return e.window&&(e.window=null),t.state=null,a1},TFe=(t,e)=>{if(H1(t))return Tp;const n=t.state;return n.wrap&2?(n.head=e,e.done=!1,a1):Tp},xFe=(t,e)=>{const n=e.length;let i,r,s;return H1(t)||(i=t.state,i.wrap!==0&&i.mode!==v3)?Tp:i.mode===v3&&(r=1,r=wN(r,e,n,0),r!==i.check)?nme:(s=ume(t,e,n,n),s?(i.mode=rme,ime):(i.havedict=1,a1))};var wFe=ome,CFe=cme,AFe=ame,RFe=yFe,MFe=lme,OFe=EFe,NFe=SFe,IFe=TFe,kFe=xFe,PFe="pako inflate (from Nodeca project)",$v={inflateReset:wFe,inflateReset2:CFe,inflateResetKeep:AFe,inflateInit:RFe,inflateInit2:MFe,inflate:OFe,inflateEnd:NFe,inflateGetHeader:IFe,inflateSetDictionary:kFe,inflateInfo:PFe};function DFe(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}var LFe=DFe;const hme=Object.prototype.toString,{Z_NO_FLUSH:UFe,Z_FINISH:BFe,Z_OK:RN,Z_STREAM_END:eH,Z_NEED_DICT:tH,Z_STREAM_ERROR:FFe,Z_DATA_ERROR:ene,Z_MEM_ERROR:zFe}=j1;function uk(t){this.options=KF.assign({chunkSize:1024*64,windowBits:15,to:""},t||{});const e=this.options;e.raw&&e.windowBits>=0&&e.windowBits<16&&(e.windowBits=-e.windowBits,e.windowBits===0&&(e.windowBits=-15)),e.windowBits>=0&&e.windowBits<16&&!(t&&t.windowBits)&&(e.windowBits+=32),e.windowBits>15&&e.windowBits<48&&(e.windowBits&15||(e.windowBits|=15)),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new Jpe,this.strm.avail_out=0;let n=$v.inflateInit2(this.strm,e.windowBits);if(n!==RN)throw new Error(r1[n]);if(this.header=new LFe,$v.inflateGetHeader(this.strm,this.header),e.dictionary&&(typeof e.dictionary=="string"?e.dictionary=AN.string2buf(e.dictionary):hme.call(e.dictionary)==="[object ArrayBuffer]"&&(e.dictionary=new Uint8Array(e.dictionary)),e.raw&&(n=$v.inflateSetDictionary(this.strm,e.dictionary),n!==RN)))throw new Error(r1[n])}uk.prototype.push=function(t,e){const n=this.strm,i=this.options.chunkSize,r=this.options.dictionary;let s,a,o;if(this.ended)return!1;for(e===~~e?a=e:a=e===!0?BFe:UFe,hme.call(t)==="[object ArrayBuffer]"?n.input=new Uint8Array(t):n.input=t,n.next_in=0,n.avail_in=n.input.length;;){for(n.avail_out===0&&(n.output=new Uint8Array(i),n.next_out=0,n.avail_out=i),s=$v.inflate(n,a),s===tH&&r&&(s=$v.inflateSetDictionary(n,r),s===RN?s=$v.inflate(n,a):s===ene&&(s=tH));n.avail_in>0&&s===eH&&n.state.wrap>0&&t[n.next_in]!==0;)$v.inflateReset(n),s=$v.inflate(n,a);switch(s){case FFe:case ene:case tH:case zFe:return this.onEnd(s),this.ended=!0,!1}if(o=n.avail_out,n.next_out&&(n.avail_out===0||s===eH))if(this.options.to==="string"){let c=AN.utf8border(n.output,n.next_out),l=n.next_out-c,u=AN.buf2string(n.output,c);n.next_out=l,n.avail_out=i-l,l&&n.output.set(n.output.subarray(c,c+l),0),this.onData(u)}else this.onData(n.output.length===n.next_out?n.output:n.output.subarray(0,n.next_out));if(!(s===RN&&o===0)){if(s===eH)return s=$v.inflateEnd(this.strm),this.onEnd(s),this.ended=!0,!0;if(n.avail_in===0)break}}return!0};uk.prototype.onData=function(t){this.chunks.push(t)};uk.prototype.onEnd=function(t){t===RN&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=KF.flattenChunks(this.chunks)),this.chunks=[],this.err=t,this.msg=this.strm.msg};function H9(t,e){const n=new uk(e);if(n.push(t),n.err)throw n.msg||r1[n.err];return n.result}function jFe(t,e){return e=e||{},e.raw=!0,H9(t,e)}var HFe=uk,VFe=H9,GFe=jFe,qFe=H9,$Fe=j1,WFe={Inflate:HFe,inflate:VFe,inflateRaw:GFe,ungzip:qFe,constants:$Fe};const{Deflate:YFe,deflate:KFe,deflateRaw:XFe,gzip:ZFe}=tFe,{Inflate:JFe,inflate:QFe,inflateRaw:e4e,ungzip:t4e}=WFe;var n4e=YFe,i4e=KFe,r4e=XFe,s4e=ZFe,a4e=JFe,o4e=QFe,c4e=e4e,l4e=t4e,u4e=j1,h4e={Deflate:n4e,deflate:i4e,deflateRaw:r4e,gzip:s4e,Inflate:a4e,inflate:o4e,inflateRaw:c4e,ungzip:l4e,constants:u4e};function tne(t){let e=t.r.toString(16),n=t.g.toString(16),i=t.b.toString(16);return e.length<2&&(e="0"+e),n.length<2&&(n="0"+n),i.length<2&&(i="0"+i),e+n+i}const d4e=t=>new Promise((e,n)=>{try{const i=h4e.inflate(t),r=f4e(i);e(r)}catch(i){n(i)}}),f4e=t=>{const e=new DataView(t.buffer),n={version:e.getUint32(0,!0),layers:[]},i=e.getUint32(4,!0);let r=8;for(let s=0;s<i;s++){const a={width:0,height:0,raster:[]};a.width=e.getUint32(r,!0),r+=4,a.height=e.getUint32(r,!0),r+=4,a.raster=Array(a.height*a.width);for(let o=0;o<a.width;o++)for(let c=0;c<a.height;c++){const l={asciiCode:e.getUint32(r,!0),transparent:!1,color:{r:0,g:0,b:0,hex:""},bg:{r:0,g:0,b:0,hex:""}};r+=4,l.color.r=e.getUint8(r++),l.color.g=e.getUint8(r++),l.color.b=e.getUint8(r++),l.color.hex=tne(l.color),l.bg.r=e.getUint8(r++),l.bg.g=e.getUint8(r++),l.bg.b=e.getUint8(r++),l.bg.hex=tne(l.bg),l.transparent=l.bg.r===255&&l.bg.g===0&&l.bg.b===255,a.raster[o+a.width*c]=l}n.layers.push(a)}return n};function p4e(t){return typeof t=="object"&&Tn(t.session)&&Tn(t.player)&&Tn(t.id)&&Tn(t.sender)&&Tn(t.target)}function Mi(t,e,n,...i){return t.emit(e,"error",[`$red${n}$blue>>`,...i]),!1}function m4e(t,e,...n){return t.emit(e,"info",n),!0}function xr(t,e,...n){return t.emit(e,"log",n),!0}function g4e(t,e,n){t.emit(e,"toast",n)}function v4e(t,e,n){t.emit(e,"bridge:streamstart",n)}function _4e(t,e){t.emit(e,"bridge:streamstop",void 0)}function y4e(t,e,n){t.emit(e,"bridge:chatstart",n)}function b4e(t,e){t.emit(e,"bridge:chatstop")}function E4e(t,e,n,i,r,s,a){t.emit(e,"bridge:fetch",[n,i,r,s,a])}function S4e(t,e){t.emit(e,"bridge:talkstart",e)}function T4e(t,e){t.emit(e,"bridge:talkstop",e)}function x4e(t,e){t.emit(e,"bridge:mediastart",e)}function w4e(t,e){t.emit(e,"bridge:mediastop",e)}function C4e(t,e,n){t.emit(e,"bridge:join",n)}function A4e(t,e,n){t.emit(e,"bridge:start",n)}function R4e(t,e,n){t.emit(e,"bridge:tab",n)}function M4e(t,e,n){t.emit(e,"bridge:tabopen",n)}function O4e(t,e,n,i){t.emit(e,"bridge:showjoincode",[n,i])}function N4e(t,e){t.emit(e,"gadgetserver:desync")}function I4e(t,e){t.emit(e,"gadgetserver:clearscroll")}function nne(t,e,n,i){t.emit(e,"register:downloadjsonfile",[n,i])}function k4e(t,e){t.emit(e,"register:dev",void 0)}function P4e(t,e){t.emit(e,"register:share",void 0)}function D4e(t,e){t.emit(e,"register:nuke",void 0)}function L4e(t,e){t.emit(e,"synth:audioenabled",void 0)}function U4e(t,e,n,i){t.emit(e,"synth:tts",[n,i])}function B4e(t,e,n){t.emit(e,"synth:tta",[n])}function Zy(t,e,n,i,r){t.emit(e,"synth:play",[n,i,r])}function F4e(t,e,n){t.emit(e,"synth:bpm",n)}function z4e(t,e,n){t.emit(e,"synth:playvolume",n)}function j4e(t,e,n){t.emit(e,"synth:bgplayvolume",n)}function H4e(t,e,n){t.emit(e,"synth:ttsvolume",n)}function nH(t,e,n,i,r){t.emit(e,"synth:voice",[n,i,r])}function dme(t,e,n,i,r,s){t.emit(e,"synth:voicefx",[n,i,r,s])}function V4e(t,e,n,i){t.emit(e,"register:config",[n,i])}function G4e(t,e){t.emit(e,"register:configshow")}function q4e(t,e){t.emit(e,"register:inspector")}function $4e(t,e){t.emit(e,"register:terminal:open")}function W4e(t,e){t.emit(e,"register:terminal:quickopen")}function _3(t,e){t.emit(e,"register:terminal:close")}function Y4e(t,e){t.emit(e,"register:terminal:toggle")}function fme(t,e,n){t.emit(e,"register:terminal:inclayout",n)}function pme(t,e){t.emit(e,"register:terminal:full")}function K4e(t,e,n,i,r,s){t.emit(e,"register:editor:open",[n,i,r,s])}function X4e(t,e){t.emit(e,"register:editor:close")}function Z4e(t,e){t.emit(e,"vm:operator")}function J4e(t,e){t.emit(e,"vm:zsswords")}function Q4e(t,e,n){t.emit(e,"vm:halt",n)}function e6e(t,e,n,i){t.emit(e,"vm:books",[n,i])}function t6e(t,e){t.emit(e,"vm:search")}function n6e(t,e){t.emit(e,"vm:login")}function i6e(t,e){t.emit(e,"vm:local")}function r6e(t,e){t.emit(e,"vm:logout")}function mme(t,e){t.emit(e,"vm:doot")}function gme(t,e,n,i){t.emit(e,"vm:input",[n,i])}function s6e(t,e,n){t.emit(e,"vm:copyjsonfile",n)}function a6e(t,e){t.emit(e,"vm:refscroll")}function o6e(t,e,n,i){t.emit(e,"vm:inspect",[n,i])}function vme(t,e){const[n,i]=e;return`${t}:${[n,i].filter(re).join(":")}`}function c6e(t,e,n,i){t.emit(e,"vm:codewatch",[n,i])}function l6e(t,e,n,i){t.emit(e,"vm:coderelease",[n,i])}function o_(t,e,n){t.emit(e,"vm:cli",n)}function u6e(t,e){t.emit(e,"vm:clirepeatlast")}function h6e(t,e,n){t.emit(e,"vm:clirepeatslot",n)}function d6e(t,e){t.emit(e,"vm:restart")}function f6e(t,e,n){t.emit(e,"vm:synthsend",n)}function p6e(t,e){t.emit(e,"vm:flush")}function m6e(t,e){t.emit(e,"vm:fork")}function g6e(t,e){return{filename:t,cursor:0,lines:e.split(`
`)}}function v6e(t,e){return{filename:t,json:e}}function _6e(t,e){return{filename:t,cursor:0,bytes:e,dataview:new DataView(e.buffer)}}function y6e(t,e){const n={filename:t,cursor:0,content:void 0};return d4e(e).then(i=>{n.content=i}).catch(()=>{}),n}function xm(t,e,n,i,r,s){let a;switch(i){case"file":a=s;break;case"text":a=g6e(r,s);break;case"json":a=v6e(r,s);break;case"binary":a=_6e(r,s);break;case"rexpaint":a=y6e(r,s);break}setTimeout(()=>{t.emit(e,"vm:loader",[n,i,r,a])},1)}var _me={};(function(t){var e=Ml&&Ml.__spreadArray||function(l,u,h){if(h||arguments.length===2)for(var d=0,f=u.length,p;d<f;d++)(p||!(d in u))&&(p||(p=Array.prototype.slice.call(u,0,d)),p[d]=u[d]);return l.concat(p||Array.prototype.slice.call(u))};Object.defineProperty(t,"__esModule",{value:!0}),t.minLength=t.maxLength=t.poolSize=t.humanId=t.adverbs=t.verbs=t.nouns=t.adjectives=void 0,t.adjectives=["afraid","all","angry","beige","big","better","bitter","blue","brave","breezy","bright","brown","bumpy","busy","calm","chatty","chilly","chubby","clean","clear","clever","cold","crazy","cruel","cuddly","curly","curvy","cute","common","cold","cool","cyan","dark","deep","dirty","dry","dull","eager","early","easy","eight","eighty","eleven","empty","every","evil","fair","famous","fast","fancy","few","fine","fifty","five","flat","fluffy","floppy","forty","four","free","fresh","fruity","full","funny","fuzzy","gentle","giant","gold","good","great","green","grumpy","happy","heavy","hip","honest","hot","huge","hungry","icy","itchy","khaki","kind","large","late","lazy","lemon","legal","light","little","long","loose","loud","lovely","lucky","major","many","mean","metal","mighty","modern","moody","nasty","neat","new","nice","nine","ninety","odd","old","olive","open","orange","pink","plain","plenty","polite","poor","pretty","proud","public","puny","petite","purple","quick","quiet","rare","real","ready","red","rich","ripe","rotten","rude","sad","salty","seven","shaggy","shaky","sharp","shiny","short","shy","silent","silly","silver","six","sixty","slick","slimy","slow","small","smart","smooth","social","soft","solid","some","sour","spicy","spotty","stale","strong","stupid","sweet","swift","tall","tame","tangy","tasty","ten","tender","thick","thin","thirty","three","tidy","tiny","tired","tough","tricky","true","twelve","twenty","two","upset","vast","violet","warm","weak","wet","whole","wicked","wide","wild","wise","witty","yellow","young","yummy"],t.nouns=["apes","animals","areas","bars","banks","baths","breads","bushes","cloths","clowns","clubs","hoops","loops","memes","papers","parks","paths","showers","sides","signs","sites","streets","teeth","tires","webs","actors","ads","adults","aliens","ants","apples","baboons","badgers","bags","bananas","bats","beans","bears","beds","beers","bees","berries","bikes","birds","boats","bobcats","books","bottles","boxes","brooms","buckets","bugs","buses","buttons","camels","cases","cameras","candies","candles","carpets","carrots","carrots","cars","cats","chairs","chefs","chicken","clocks","clouds","coats","cobras","coins","corners","colts","comics","cooks","cougars","regions","results","cows","crabs","crabs","crews","cups","cities","cycles","dancers","days","deer","dingos","dodos","dogs","dolls","donkeys","donuts","doodles","doors","dots","dragons","drinks","dryers","ducks","ducks","eagles","ears","eels","eggs","ends","mammals","emus","experts","eyes","facts","falcons","fans","feet","files","flies","flowers","forks","foxes","friends","frogs","games","garlics","geckos","geese","ghosts","ghosts","gifts","glasses","goats","grapes","groups","guests","hairs","hands","hats","heads","hornets","horses","hotels","hounds","houses","humans","icons","ideas","impalas","insects","islands","items","jars","jeans","jobs","jokes","keys","kids","kings","kiwis","knives","lamps","lands","laws","lemons","lies","lights","lines","lions","lizards","llamas","mails","mangos","maps","masks","meals","melons","mice","mirrors","moments","moles","monkeys","months","moons","moose","mugs","nails","needles","news","nights","numbers","olives","onions","oranges","otters","owls","pandas","pans","pants","papayas","parents","parts","parrots","paws","peaches","pears","peas","pens","pets","phones","pianos","pigs","pillows","places","planes","planets","plants","plums","poems","poets","points","pots","pugs","pumas","queens","rabbits","radios","rats","ravens","readers","rice","rings","rivers","rockets","rocks","rooms","roses","rules","schools","bats","seals","seas","sheep","shirts","shoes","shrimps","singers","sloths","snails","snakes","socks","spiders","spies","spoons","squids","stars","states","steaks","wings","suits","suns","swans","symbols","tables","taxes","taxis","teams","terms","things","ties","tigers","times","tips","toes","towns","tools","toys","trains","trams","trees","turkeys","turtles","vans","views","walls","walls","wasps","waves","ways","weeks","windows","wolves","women","wombats","words","worlds","worms","yaks","years","zebras","zoos"],t.verbs=["accept","act","add","admire","agree","allow","appear","argue","arrive","ask","attack","attend","bake","bathe","battle","beam","beg","begin","behave","bet","boil","bow","brake","brush","build","burn","buy","call","camp","care","carry","change","cheat","check","cheer","chew","clap","clean","cough","count","cover","crash","create","cross","cry","cut","dance","decide","deny","design","dig","divide","do","double","doubt","draw","dream","dress","drive","drop","drum","eat","end","enter","enjoy","exist","fail","fall","feel","fetch","film","find","fix","flash","float","flow","fly","fold","follow","fry","give","glow","go","grab","greet","grin","grow","guess","hammer","hang","happen","heal","hear","help","hide","hope","hug","hunt","invent","invite","itch","jam","jog","join","joke","judge","juggle","jump","kick","kiss","kneel","knock","know","laugh","lay","lead","learn","leave","lick","like","lie","listen","live","look","lose","love","make","march","marry","mate","matter","melt","mix","move","nail","notice","obey","occur","open","own","pay","peel","play","poke","post","press","prove","pull","pump","pick","punch","push","raise","read","refuse","relate","relax","remain","repair","repeat","reply","report","rescue","rest","retire","return","rhyme","ring","roll","rule","run","rush","say","scream","see","search","sell","send","serve","shake","share","shave","shine","show","shop","shout","sin","sink","sing","sip","sit","sleep","slide","smash","smell","smile","smoke","sneeze","sniff","sort","speak","spend","stand","start","stay","stick","stop","stare","study","strive","swim","switch","take","talk","tan","tap","taste","teach","tease","tell","thank","think","throw","tickle","tie","trade","train","travel","try","turn","type","unite","vanish","visit","wait","walk","warn","wash","watch","wave","wear","win","wink","wish","wonder","work","worry","write","yawn","yell"],t.adverbs=["bravely","brightly","busily","daily","freely","hungrily","joyously","knowlingly","lazily","oddly","mysteriously","noisily","politely","quickly","quietly","rapidly","safely","sleepily","slowly","truly","yearly"];function n(l){return l[Math.floor(Math.random()*l.length)]}function i(l){return l.reduce(function(u,h){return u.length>h.length?u:h})}function r(l){return l.reduce(function(u,h){return u.length<h.length?u:h})}function s(l){l===void 0&&(l={}),typeof l=="string"&&(l={separator:l}),typeof l=="boolean"&&(l={capitalize:l});var u=l.separator,h=u===void 0?"":u,d=l.capitalize,f=d===void 0?!0:d,p=l.adjectiveCount,g=p===void 0?1:p,_=l.addAdverb,v=_===void 0?!1:_,b=e(e(e([],e([],Array(g),!0).map(function(S){return n(t.adjectives)}),!0),[n(t.nouns),n(t.verbs)],!1),v?[n(t.adverbs)]:[],!0);return f&&(b=b.map(function(S){return S.charAt(0).toUpperCase()+S.substr(1)})),b.join(h)}t.humanId=s;function a(l){l===void 0&&(l={});var u=l.adjectiveCount,h=u===void 0?1:u,d=l.addAdverb,f=d===void 0?!1:d;return t.adjectives.length*h*t.nouns.length*t.verbs.length*(f?t.adverbs.length:1)}t.poolSize=a;function o(l){l===void 0&&(l={});var u=l.adjectiveCount,h=u===void 0?1:u,d=l.addAdverb,f=d===void 0?!1:d,p=l.separator,g=p===void 0?"":p;return i(t.adjectives).length*h+h*g.length+i(t.nouns).length+g.length+i(t.verbs).length+(f?i(t.adverbs).length+g.length:0)}t.maxLength=o;function c(l){l===void 0&&(l={});var u=l.adjectiveCount,h=u===void 0?1:u,d=l.addAdverb,f=d===void 0?!1:d,p=l.separator,g=p===void 0?"":p;return r(t.adjectives).length*h+h*g.length+r(t.nouns).length+g.length+r(t.verbs).length+(f?r(t.adverbs).length+g.length:0)}t.minLength=c,t.default=s})(_me);const V9=il(_me);function oA(t){return new Promise((e,n)=>{t.oncomplete=t.onsuccess=()=>e(t.result),t.onabort=t.onerror=()=>n(t.error)})}function b6e(t,e){const n=indexedDB.open(t);n.onupgradeneeded=()=>n.result.createObjectStore(e);const i=oA(n);return(r,s)=>i.then(a=>s(a.transaction(e,r).objectStore(e)))}let iH;function G9(){return iH||(iH=b6e("keyval-store","keyval")),iH}function E6e(t,e=G9()){return e("readonly",n=>oA(n.get(t)))}function S6e(t,e,n=G9()){return n("readwrite",i=>new Promise((r,s)=>{i.get(t).onsuccess=function(){try{i.put(e(this.result),t),r(oA(i.transaction))}catch(a){s(a)}}}))}function T6e(t,e){return t.openCursor().onsuccess=function(){this.result&&(e(this.result),this.result.continue())},oA(t.transaction)}function x6e(t=G9()){return t("readonly",e=>{if(e.getAll&&e.getAllKeys)return Promise.all([oA(e.getAllKeys()),oA(e.getAll())]).then(([i,r])=>i.map((s,a)=>[s,r[a]]));const n=[];return t("readonly",i=>T6e(i,r=>n.push([r.key,r.value])).then(()=>n))})}const rH=new Set,MN={emit(t,e,n,i,r){MN.invoke(H6e(t,e,n,i,r))},invoke(t){rH.forEach(e=>e.handle(t))},connect(t){rH.add(t)},disconnect(t){rH.delete(t)}},w6e="useandom-26T198340PX75pxJACKVERYMINDBUSHWOLF_GQZbfghjklqvwyzrict";let C6e=t=>crypto.getRandomValues(new Uint8Array(t)),A6e=(t,e,n)=>{let i=(2<<Math.log2(t.length-1))-1,r=-~(1.6*i*e/t.length);return(s=e)=>{let a="";for(;;){let o=n(r),c=r;for(;c--;)if(a+=t[o[c]&i]||"",a.length===s)return a}}},yme=(t,e=21)=>A6e(t,e,C6e),R6e=(t=21)=>{let e="",n=crypto.getRandomValues(new Uint8Array(t));for(;t--;)e+=w6e[n[t]&63];return e};var bme="abcdefghijklmnopqrstuvwxyz",Eme="ABCDEFGHIJKLMNOPQRSTUVWXYZ",Sme="0123456789",M6e="346789ABCDEFGHJKLMNPQRTUVWXYabcdefghijkmnpqrtwxyz",O6e="6789BCDFGHJKLMNPQRTWbcdfghjkmnpqrtwz";const N6e=Sme,I6e=bme,k6e=Eme;var P6e=N6e+I6e+k6e,xq={lowercase:bme,uppercase:Eme,numbers:Sme,nolookalikes:M6e,nolookalikesSafe:O6e,alphanumeric:P6e};function wo(){return`sid_${R6e(12).replaceAll("-",".")}`}const D6e=yme(xq.numbers,4),L6e=yme(`${xq.numbers}${xq.lowercase}`,16);function U6e(){return`pid_${D6e()}_${L6e()}`}function o1(t){return(t==null?void 0:t.startsWith("pid_"))??!1}function B6e(){return V9({capitalize:!1,adjectiveCount:1})}function F6e(){return V9({addAdverb:!1,capitalize:!1,adjectiveCount:0})}const z6e=20,ine="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";function j6e(t){const e=I9(t),n=[];for(let i=0;i<z6e;++i)n.push(ine[Math.floor(e()*ine.length)]);return n.join("")}var qt=(t=>(t[t.BLACK=0]="BLACK",t[t.DKBLUE=1]="DKBLUE",t[t.DKGREEN=2]="DKGREEN",t[t.DKCYAN=3]="DKCYAN",t[t.DKRED=4]="DKRED",t[t.DKPURPLE=5]="DKPURPLE",t[t.DKYELLOW=6]="DKYELLOW",t[t.LTGRAY=7]="LTGRAY",t[t.DKGRAY=8]="DKGRAY",t[t.BLUE=9]="BLUE",t[t.GREEN=10]="GREEN",t[t.CYAN=11]="CYAN",t[t.RED=12]="RED",t[t.PURPLE=13]="PURPLE",t[t.YELLOW=14]="YELLOW",t[t.WHITE=15]="WHITE",t[t.ONBLACK=16]="ONBLACK",t[t.ONDKBLUE=17]="ONDKBLUE",t[t.ONDKGREEN=18]="ONDKGREEN",t[t.ONDKCYAN=19]="ONDKCYAN",t[t.ONDKRED=20]="ONDKRED",t[t.ONDKPURPLE=21]="ONDKPURPLE",t[t.ONDKYELLOW=22]="ONDKYELLOW",t[t.ONLTGRAY=23]="ONLTGRAY",t[t.ONDKGRAY=24]="ONDKGRAY",t[t.ONBLUE=25]="ONBLUE",t[t.ONGREEN=26]="ONGREEN",t[t.ONCYAN=27]="ONCYAN",t[t.ONRED=28]="ONRED",t[t.ONPURPLE=29]="ONPURPLE",t[t.ONYELLOW=30]="ONYELLOW",t[t.ONWHITE=31]="ONWHITE",t[t.ONCLEAR=32]="ONCLEAR",t))(qt||{}),Qr=(t=>(t[t.ISWALK=0]="ISWALK",t[t.ISSOLID=1]="ISSOLID",t[t.ISSWIM=2]="ISSWIM",t[t.ISBULLET=3]="ISBULLET",t))(Qr||{}),c1=(t=>(t[t.ISTERRAIN=0]="ISTERRAIN",t[t.ISOBJECT=1]="ISOBJECT",t))(c1||{}),Yt=(t=>(t[t.IDLE=0]="IDLE",t[t.NORTH=1]="NORTH",t[t.SOUTH=2]="SOUTH",t[t.WEST=3]="WEST",t[t.EAST=4]="EAST",t[t.BY=5]="BY",t[t.AT=6]="AT",t[t.FLOW=7]="FLOW",t[t.SEEK=8]="SEEK",t[t.RNDNS=9]="RNDNS",t[t.RNDNE=10]="RNDNE",t[t.RND=11]="RND",t[t.CW=12]="CW",t[t.CCW=13]="CCW",t[t.OPP=14]="OPP",t[t.RNDP=15]="RNDP",t[t.AWAY=16]="AWAY",t[t.TOWARD=17]="TOWARD",t[t.PLAYER=18]="PLAYER",t[t.FIND=19]="FIND",t[t.FLEE=20]="FLEE",t[t.TO=21]="TO",t[t.MID=22]="MID",t[t.OVER=23]="OVER",t[t.UNDER=24]="UNDER",t))(Yt||{}),gn=(t=>(t[t.LOADER=0]="LOADER",t[t.BOARD=1]="BOARD",t[t.OBJECT=2]="OBJECT",t[t.TERRAIN=3]="TERRAIN",t[t.CHARSET=4]="CHARSET",t[t.PALETTE=5]="PALETTE",t[t.CONST=6]="CONST",t[t.RANGE=7]="RANGE",t[t.SELECT=8]="SELECT",t[t.NUMBER=9]="NUMBER",t[t.TEXT=10]="TEXT",t[t.HOTKEY=11]="HOTKEY",t[t.COPYIT=12]="COPYIT",t[t.OPENIT=13]="OPENIT",t[t.ZSSEDIT=14]="ZSSEDIT",t[t.CHAREDIT=15]="CHAREDIT",t[t.COLOREDIT=16]="COLOREDIT",t))(gn||{});function Wn(t){return(t==null?void 0:t.toLowerCase().trim())??""}function H6e(t,e,n,i,r){return{session:t,player:e,id:wo(),sender:n,target:i,data:r}}function O_(t){const[e,...n]=t.split(":");return{target:e,path:n.join(":")}}function NE(t,e=[],n=ih,i=""){const r=wo(),s=Wn(t),a=e.map(Wn);let o=i;const c={id(){return r},name(){return t},session(l){return re(l)?l.session===o?l.session:"":o},topics(){return e},emit(l,u,h){MN.emit(o,l,r,u,h)},reply(l,u,h){c.emit(l.player,`${l.sender}:${u}`,h)},replynext(l,u,h){setTimeout(()=>c.emit(l.player,`${l.sender}:${u}`,h),64)},handle(l){const{target:u,path:h}=O_(l.target),d=Wn(u);!o&&d==="ready"&&(o=l.session),d==="bridge"&&re(l.session)&&(o=l.session),a.findIndex(f=>f==="all"||f===d)!==-1&&n(l),(r===u||d==="all"||s===d)&&n({...l,target:h})}};return MN.connect(c),c}var dT=(t=>(t[t.Border=-1]="Border",t[t.Data=0]="Data",t[t.Function=1]="Function",t[t.Position=2]="Position",t[t.Timing=3]="Timing",t[t.Alignment=4]="Alignment",t))(dT||{}),V6e=Object.defineProperty,G6e=(t,e,n)=>e in t?V6e(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,zD=(t,e,n)=>(G6e(t,typeof e!="symbol"?e+"":e,n),n);const q6e=[0,1],Tme=[1,0],xme=[2,3],wme=[3,2],$6e={L:q6e,M:Tme,Q:xme,H:wme},W6e=/^[0-9]*$/,Y6e=/^[A-Z0-9 $%*+.\/:-]*$/,sH="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ $%*+-./:",q9=1,$9=40,rne=3,K6e=3,jD=40,X6e=10,Cme=[[-1,7,10,15,20,26,18,20,24,30,18,20,24,26,30,22,24,28,30,28,28,28,28,30,30,26,28,30,30,30,30,30,30,30,30,30,30,30,30,30,30],[-1,10,16,26,18,24,16,18,22,22,26,30,22,22,24,24,28,28,26,26,26,26,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28],[-1,13,22,18,26,18,24,18,22,20,24,28,26,24,20,30,24,28,28,26,30,28,30,30,30,30,28,30,30,30,30,30,30,30,30,30,30,30,30,30,30],[-1,17,28,22,16,22,28,26,26,24,28,24,28,22,24,24,30,28,28,26,28,30,24,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30]],Ame=[[-1,1,1,1,1,1,2,2,2,2,4,4,4,4,4,6,6,6,6,7,8,8,9,9,10,12,12,12,13,14,15,16,17,18,19,19,20,21,22,24,25],[-1,1,1,1,2,2,4,4,4,5,5,5,8,9,9,10,10,11,13,14,16,17,17,18,20,21,23,25,26,28,29,31,33,35,37,38,40,43,45,47,49],[-1,1,1,2,2,4,4,6,6,8,8,8,10,12,16,12,17,16,18,21,20,23,23,25,27,29,34,34,35,38,40,43,45,48,51,53,56,59,62,65,68],[-1,1,1,2,4,4,4,5,6,8,8,11,11,16,16,18,16,19,21,25,25,25,34,30,32,35,37,40,42,45,48,51,54,57,60,63,66,70,74,77,81]];class Z6e{constructor(e,n,i,r){if(this.version=e,this.ecc=n,zD(this,"size"),zD(this,"mask"),zD(this,"modules",[]),zD(this,"types",[]),e<q9||e>$9)throw new RangeError("Version value out of range");if(r<-1||r>7)throw new RangeError("Mask value out of range");this.size=e*4+17;const s=Array.from({length:this.size},()=>!1);for(let o=0;o<this.size;o++)this.modules.push(s.slice()),this.types.push(s.map(()=>0));this.drawFunctionPatterns();const a=this.addEccAndInterleave(i);if(this.drawCodewords(a),r===-1){let o=1e9;for(let c=0;c<8;c++){this.applyMask(c),this.drawFormatBits(c);const l=this.getPenaltyScore();l<o&&(r=c,o=l),this.applyMask(c)}}this.mask=r,this.applyMask(r),this.drawFormatBits(r)}getModule(e,n){return e>=0&&e<this.size&&n>=0&&n<this.size&&this.modules[n][e]}drawFunctionPatterns(){for(let i=0;i<this.size;i++)this.setFunctionModule(6,i,i%2===0,dT.Timing),this.setFunctionModule(i,6,i%2===0,dT.Timing);this.drawFinderPattern(3,3),this.drawFinderPattern(this.size-4,3),this.drawFinderPattern(3,this.size-4);const e=this.getAlignmentPatternPositions(),n=e.length;for(let i=0;i<n;i++)for(let r=0;r<n;r++)i===0&&r===0||i===0&&r===n-1||i===n-1&&r===0||this.drawAlignmentPattern(e[i],e[r]);this.drawFormatBits(0),this.drawVersion()}drawFormatBits(e){const n=this.ecc[1]<<3|e;let i=n;for(let s=0;s<10;s++)i=i<<1^(i>>>9)*1335;const r=(n<<10|i)^21522;for(let s=0;s<=5;s++)this.setFunctionModule(8,s,Pv(r,s));this.setFunctionModule(8,7,Pv(r,6)),this.setFunctionModule(8,8,Pv(r,7)),this.setFunctionModule(7,8,Pv(r,8));for(let s=9;s<15;s++)this.setFunctionModule(14-s,8,Pv(r,s));for(let s=0;s<8;s++)this.setFunctionModule(this.size-1-s,8,Pv(r,s));for(let s=8;s<15;s++)this.setFunctionModule(8,this.size-15+s,Pv(r,s));this.setFunctionModule(8,this.size-8,!0)}drawVersion(){if(this.version<7)return;let e=this.version;for(let i=0;i<12;i++)e=e<<1^(e>>>11)*7973;const n=this.version<<12|e;for(let i=0;i<18;i++){const r=Pv(n,i),s=this.size-11+i%3,a=Math.floor(i/3);this.setFunctionModule(s,a,r),this.setFunctionModule(a,s,r)}}drawFinderPattern(e,n){for(let i=-4;i<=4;i++)for(let r=-4;r<=4;r++){const s=Math.max(Math.abs(r),Math.abs(i)),a=e+r,o=n+i;a>=0&&a<this.size&&o>=0&&o<this.size&&this.setFunctionModule(a,o,s!==2&&s!==4,dT.Position)}}drawAlignmentPattern(e,n){for(let i=-2;i<=2;i++)for(let r=-2;r<=2;r++)this.setFunctionModule(e+r,n+i,Math.max(Math.abs(r),Math.abs(i))!==1,dT.Alignment)}setFunctionModule(e,n,i,r=dT.Function){this.modules[n][e]=i,this.types[n][e]=r}addEccAndInterleave(e){const n=this.version,i=this.ecc;if(e.length!==eL(n,i))throw new RangeError("Invalid argument");const r=Ame[i[0]][n],s=Cme[i[0]][n],a=Math.floor(wq(n)/8),o=r-a%r,c=Math.floor(a/r),l=[],u=aze(s);for(let d=0,f=0;d<r;d++){const p=e.slice(f,f+c-s+(d<o?0:1));f+=p.length;const g=oze(p,u);d<o&&p.push(0),l.push(p.concat(g))}const h=[];for(let d=0;d<l[0].length;d++)l.forEach((f,p)=>{(d!==c-s||p>=o)&&h.push(f[d])});return h}drawCodewords(e){if(e.length!==Math.floor(wq(this.version)/8))throw new RangeError("Invalid argument");let n=0;for(let i=this.size-1;i>=1;i-=2){i===6&&(i=5);for(let r=0;r<this.size;r++)for(let s=0;s<2;s++){const a=i-s,c=(i+1&2)===0?this.size-1-r:r;!this.types[c][a]&&n<e.length*8&&(this.modules[c][a]=Pv(e[n>>>3],7-(n&7)),n++)}}}applyMask(e){if(e<0||e>7)throw new RangeError("Mask value out of range");for(let n=0;n<this.size;n++)for(let i=0;i<this.size;i++){let r;switch(e){case 0:r=(i+n)%2===0;break;case 1:r=n%2===0;break;case 2:r=i%3===0;break;case 3:r=(i+n)%3===0;break;case 4:r=(Math.floor(i/3)+Math.floor(n/2))%2===0;break;case 5:r=i*n%2+i*n%3===0;break;case 6:r=(i*n%2+i*n%3)%2===0;break;case 7:r=((i+n)%2+i*n%3)%2===0;break;default:throw new Error("Unreachable")}!this.types[n][i]&&r&&(this.modules[n][i]=!this.modules[n][i])}}getPenaltyScore(){let e=0;for(let s=0;s<this.size;s++){let a=!1,o=0;const c=[0,0,0,0,0,0,0];for(let l=0;l<this.size;l++)this.modules[s][l]===a?(o++,o===5?e+=rne:o>5&&e++):(this.finderPenaltyAddHistory(o,c),a||(e+=this.finderPenaltyCountPatterns(c)*jD),a=this.modules[s][l],o=1);e+=this.finderPenaltyTerminateAndCount(a,o,c)*jD}for(let s=0;s<this.size;s++){let a=!1,o=0;const c=[0,0,0,0,0,0,0];for(let l=0;l<this.size;l++)this.modules[l][s]===a?(o++,o===5?e+=rne:o>5&&e++):(this.finderPenaltyAddHistory(o,c),a||(e+=this.finderPenaltyCountPatterns(c)*jD),a=this.modules[l][s],o=1);e+=this.finderPenaltyTerminateAndCount(a,o,c)*jD}for(let s=0;s<this.size-1;s++)for(let a=0;a<this.size-1;a++){const o=this.modules[s][a];o===this.modules[s][a+1]&&o===this.modules[s+1][a]&&o===this.modules[s+1][a+1]&&(e+=K6e)}let n=0;for(const s of this.modules)n=s.reduce((a,o)=>a+(o?1:0),n);const i=this.size*this.size,r=Math.ceil(Math.abs(n*20-i*10)/i)-1;return e+=r*X6e,e}getAlignmentPatternPositions(){if(this.version===1)return[];{const e=Math.floor(this.version/7)+2,n=this.version===32?26:Math.ceil((this.version*4+4)/(e*2-2))*2,i=[6];for(let r=this.size-7;i.length<e;r-=n)i.splice(1,0,r);return i}}finderPenaltyCountPatterns(e){const n=e[1],i=n>0&&e[2]===n&&e[3]===n*3&&e[4]===n&&e[5]===n;return(i&&e[0]>=n*4&&e[6]>=n?1:0)+(i&&e[6]>=n*4&&e[0]>=n?1:0)}finderPenaltyTerminateAndCount(e,n,i){return e&&(this.finderPenaltyAddHistory(n,i),n=0),n+=this.size,this.finderPenaltyAddHistory(n,i),this.finderPenaltyCountPatterns(i)}finderPenaltyAddHistory(e,n){n[0]===0&&(e+=this.size),n.pop(),n.unshift(e)}}function Xv(t,e,n){if(e<0||e>31||t>>>e)throw new RangeError("Value out of range");for(let i=e-1;i>=0;i--)n.push(t>>>i&1)}function Pv(t,e){return(t>>>e&1)!==0}class W9{constructor(e,n,i){if(this.mode=e,this.numChars=n,this.bitData=i,n<0)throw new RangeError("Invalid argument");this.bitData=i.slice()}getData(){return this.bitData.slice()}}const J6e=[1,10,12,14],Q6e=[2,9,11,13],eze=[4,8,16,16];function Rme(t,e){return t[Math.floor((e+7)/17)+1]}function Mme(t){const e=[];for(const n of t)Xv(n,8,e);return new W9(eze,t.length,e)}function tze(t){if(!Ome(t))throw new RangeError("String contains non-numeric characters");const e=[];for(let n=0;n<t.length;){const i=Math.min(t.length-n,3);Xv(Number.parseInt(t.substring(n,n+i),10),i*3+1,e),n+=i}return new W9(J6e,t.length,e)}function nze(t){if(!Nme(t))throw new RangeError("String contains unencodable characters in alphanumeric mode");const e=[];let n;for(n=0;n+2<=t.length;n+=2){let i=sH.indexOf(t.charAt(n))*45;i+=sH.indexOf(t.charAt(n+1)),Xv(i,11,e)}return n<t.length&&Xv(sH.indexOf(t.charAt(n)),6,e),new W9(Q6e,t.length,e)}function ize(t){return t===""?[]:Ome(t)?[tze(t)]:Nme(t)?[nze(t)]:[Mme(sze(t))]}function Ome(t){return W6e.test(t)}function Nme(t){return Y6e.test(t)}function rze(t,e){let n=0;for(const i of t){const r=Rme(i.mode,e);if(i.numChars>=1<<r)return Number.POSITIVE_INFINITY;n+=4+r+i.bitData.length}return n}function sze(t){t=encodeURI(t);const e=[];for(let n=0;n<t.length;n++)t.charAt(n)!=="%"?e.push(t.charCodeAt(n)):(e.push(Number.parseInt(t.substring(n+1,n+3),16)),n+=2);return e}function wq(t){if(t<q9||t>$9)throw new RangeError("Version number out of range");let e=(16*t+128)*t+64;if(t>=2){const n=Math.floor(t/7)+2;e-=(25*n-10)*n-55,t>=7&&(e-=36)}return e}function eL(t,e){return Math.floor(wq(t)/8)-Cme[e[0]][t]*Ame[e[0]][t]}function aze(t){if(t<1||t>255)throw new RangeError("Degree out of range");const e=[];for(let i=0;i<t-1;i++)e.push(0);e.push(1);let n=1;for(let i=0;i<t;i++){for(let r=0;r<e.length;r++)e[r]=Cq(e[r],n),r+1<e.length&&(e[r]^=e[r+1]);n=Cq(n,2)}return e}function oze(t,e){const n=e.map(i=>0);for(const i of t){const r=i^n.shift();n.push(0),e.forEach((s,a)=>n[a]^=Cq(s,r))}return n}function Cq(t,e){if(t>>>8||e>>>8)throw new RangeError("Byte out of range");let n=0;for(let i=7;i>=0;i--)n=n<<1^(n>>>7)*285,n^=(e>>>i&1)*t;return n}function cze(t,e,n=1,i=40,r=-1,s=!0){if(!(q9<=n&&n<=i&&i<=$9)||r<-1||r>7)throw new RangeError("Invalid value");let a,o;for(a=n;;a++){const h=eL(a,e)*8,d=rze(t,a);if(d<=h){o=d;break}if(a>=i)throw new RangeError("Data too long")}for(const h of[Tme,xme,wme])s&&o<=eL(a,h)*8&&(e=h);const c=[];for(const h of t){Xv(h.mode[0],4,c),Xv(h.numChars,Rme(h.mode,a),c);for(const d of h.getData())c.push(d)}const l=eL(a,e)*8;Xv(0,Math.min(4,l-c.length),c),Xv(0,(8-c.length%8)%8,c);for(let h=236;c.length<l;h^=253)Xv(h,8,c);const u=Array.from({length:Math.ceil(c.length/8)},()=>0);return c.forEach((h,d)=>u[d>>>3]|=h<<7-(d&7)),new Z6e(a,e,u,r)}function lze(t,e){var h;const{ecc:n="L",boostEcc:i=!1,minVersion:r=1,maxVersion:s=40,maskPattern:a=-1,border:o=1}=e||{},c=typeof t=="string"?ize(t):Array.isArray(t)?[Mme(t)]:void 0;if(!c)throw new Error(`uqr only supports encoding string and binary data, but got: ${typeof t}`);const l=cze(c,$6e[n],r,s,a,i),u=uze({version:l.version,maskPattern:l.mask,size:l.size,data:l.modules,types:l.types},o);return e!=null&&e.invert&&(u.data=u.data.map(d=>d.map(f=>!f))),(h=e==null?void 0:e.onEncoded)==null||h.call(e,u),u}function uze(t,e=1){if(!e)return t;const{size:n}=t,i=n+e*2;t.size=i,t.data.forEach(s=>{for(let a=0;a<e;a++)s.unshift(!1),s.push(!1)});for(let s=0;s<e;s++)t.data.unshift(Array.from({length:i},a=>!1)),t.data.push(Array.from({length:i},a=>!1));const r=dT.Border;t.types.forEach(s=>{for(let a=0;a<e;a++)s.unshift(r),s.push(r)});for(let s=0;s<e;s++)t.types.unshift(Array.from({length:i},a=>r)),t.types.push(Array.from({length:i},a=>r));return t}function hze(t,e,n,i=!1){return e<0||n<0||e>=t.length||n>=t.length?i:t[n][e]}function dze(t,e={}){const n={WHITE_ALL:"",WHITE_BLACK:"",BLACK_WHITE:"",BLACK_ALL:" "},i=lze(t,e),r=!1,s=!0,a=(l,u)=>hze(i.data,l,u,!0),o=[];let c="";for(let l=0;l<i.size;l+=2){for(let u=0;u<i.size;u++)a(u,l)===r&&a(u,l+1)===r?c+=n.WHITE_ALL:a(u,l)===r&&a(u,l+1)===s?c+=n.WHITE_BLACK:a(u,l)===s&&a(u,l+1)===r?c+=n.BLACK_WHITE:c+=n.BLACK_ALL;o.push(c),c=""}return o.join(`
`)}const sE="$dkpurple",fze="$196",pze="$205";function Zs(t,e,n){m4e(t,e,n)}function mze(t,e,n){const i=fze.repeat(n);Zs(t,e,`${sE}${i}`)}function Y9(t,e,n){const i=pze.repeat(n);Zs(t,e,`${sE}${i}`)}function Bg(t,e,n){Zs(t,e,`${sE} ${" ".repeat(n.length)} `),mze(t,e,n.length+2),Zs(t,e,`${sE} $white${n} `),Y9(t,e,n.length+2)}function rT(t,e,n){Zs(t,e,`${sE} ${" ".repeat(n.length)} `),Zs(t,e,`${sE} $gray${n} `),Y9(t,e,n.length+2)}function hp(t,e,n,i){Zs(t,e,`${sE} $white${n} $blue${i}`)}function Hl(t,e,n){Zs(t,e,`${sE}$blue${n}`)}function gze(t,e,n,i){Zs(t,e,`!${n};${i}`)}function Aq(t,e,n,i,r=!0){if(r){const s=dze(n).split(`
`),a={32:32,9600:223,9604:220,9608:219};for(let o=0;o<s.length;o++){const c=[...s[o]].map(l=>`$${a[l.charCodeAt(0)]}`).join("");Zs(t,e,c)}}Zs(t,e,`!copyit ${n};${i}`),pme(t,e)}function vze(t,e,n,i){Zs(t,e,`!openit ${n};${i}`)}async function Ime(t){const e=new FormData;e.append("url",t);const n=new Request("https://bytes.zed.cafe",{method:"POST",body:e});return await(await fetch(n)).text()}function kme(){return window.location.href.includes("/join/")}function Rq(){return window.location.href.includes("/locked/")}const sne=t=>{let e;const n=new Set,i=(l,u)=>{const h=typeof l=="function"?l(e):l;if(!Object.is(h,e)){const d=e;e=u??(typeof h!="object"||h===null)?h:Object.assign({},e,h),n.forEach(f=>f(e,d))}},r=()=>e,o={setState:i,getState:r,getInitialState:()=>c,subscribe:l=>(n.add(l),()=>n.delete(l))},c=e=t(i,r,o);return o},K9=t=>t?sne(t):sne,_ze=t=>t;function X9(t,e=_ze){const n=Sm.useSyncExternalStore(t.subscribe,()=>e(t.getState()),()=>e(t.getInitialState()));return Sm.useDebugValue(n),n}const ane=t=>{const e=K9(t),n=i=>X9(e,i);return Object.assign(n,e),n},IE=t=>t?ane(t):ane;function one(t){const e=De.useRef();return n=>{const i=t(n);return(e.current===void 0||i===void 0?e.current===i:hT(e.current,i))?e.current:e.current=i}}const jr=IE(()=>({desync:!1,zsswords:{cli:[],loader:[],runtime:[],flags:[],stats:[],kinds:[],altkinds:[],colors:[],dirs:[],dirmods:[]},gadget:{id:"",layers:[],scroll:[],sidebar:[]}})),y3=128;var vm=(t=>(t[t.TOP=0]="TOP",t[t.FULL=1]="FULL",t[t.BOTTOM=2]="BOTTOM",t[t.SPLIT_X=3]="SPLIT_X",t[t.MAX=4]="MAX",t))(vm||{});const As=IE(()=>({layout:0,inspector:Rq(),quickterminal:!1,toast:"",terminal:{open:!0,info:[],logs:[]},editor:{open:!1,book:"",path:[],type:"",title:""}})),Vo=IE(()=>({scroll:0,xcursor:0,ycursor:0,xselect:void 0,yselect:void 0,bufferindex:0,buffer:[""]})),So=IE(()=>({id:"",xscroll:0,yscroll:0,cursor:0,select:void 0})),cw=IE(()=>({cursor:void 0,select:void 0}));function yze(t){const e=document.createElement("canvas");if(e.width=(t==null?void 0:t.width)||1,e.height=(t==null?void 0:t.height)||1,t){const n=e.getContext("2d"),i=n==null?void 0:n.getImageData(0,0,t.width,t.height);if(i&&n){let r=0;const{data:s}=i;for(let a=0;a<s.length;a+=4){const o=t.bits[r];s[a]=o,s[a+1]=o,s[a+2]=o,s[a+3]=255,r+=1}n.putImageData(i,0,0)}}return e}function Pme(t,e){return{width:t,height:e,size:t*e,bits:new Uint8Array(t*e).fill(0)}}function aH(t,e,n){return{width:t,height:e,size:t*e,bits:new Uint8Array(n)}}const kn=60,ur=25,hk=kn*ur;var Xn=(t=>(t[t.ERROR=0]="ERROR",t[t.LOADER=1]="LOADER",t[t.BOARD=2]="BOARD",t[t.OBJECT=3]="OBJECT",t[t.TERRAIN=4]="TERRAIN",t[t.CHARSET=5]="CHARSET",t[t.PALETTE=6]="PALETTE",t))(Xn||{});const Mq=14,l1=3,p_=8,m_=14,dp=16,Oq=16,Dme=16;var ks=(t=>(t[t.BLANK=0]="BLANK",t[t.TILES=1]="TILES",t[t.SPRITES=2]="SPRITES",t[t.DITHER=3]="DITHER",t[t.MEDIA=4]="MEDIA",t[t.CONTROL=5]="CONTROL",t))(ks||{}),Sc=(t=>(t[t.FAR=1]="FAR",t[t.MID=1.5]="MID",t[t.NEAR=3]="NEAR",t))(Sc||{});function cA(t){let e=0,n=0,i=kn*.5,r=ur*.5,s=1.5,a="flat",o=0;return t.forEach(c=>{switch(c.type){case 1:e=Math.max(e,c.width),n=Math.max(n,c.height);break;case 3:e=Math.max(e,c.width),n=Math.max(n,c.height);break;case 5:i=c.focusx,r=c.focusy,s=c.viewscale,a=c.graphics,o=c.facing;break}}),{width:e,height:n,focusx:i,focusy:r,viewscale:s,graphics:a,facing:o}}function kE(t,e){return`${t}:${e}`}const Z9=1,J9=16,Q9=256;var Ft=(t=>(t[t.NONE=0]="NONE",t[t.ALT=1]="ALT",t[t.CTRL=2]="CTRL",t[t.SHIFT=3]="SHIFT",t[t.MOVE_UP=4]="MOVE_UP",t[t.MOVE_DOWN=5]="MOVE_DOWN",t[t.MOVE_LEFT=6]="MOVE_LEFT",t[t.MOVE_RIGHT=7]="MOVE_RIGHT",t[t.OK_BUTTON=8]="OK_BUTTON",t[t.CANCEL_BUTTON=9]="CANCEL_BUTTON",t[t.MENU_BUTTON=10]="MENU_BUTTON",t))(Ft||{});function PE(t){const e=Math.floor(t.length/l1);if(e*l1!==t.length)return;const n=Pme(3,e);for(let i=0;i<n.bits.length;++i)n.bits[i]=t[i];return n}function bze(t,e){return t&1<<e?255:0}function V1(t){const e=Math.floor(t.length/Mq);if(e*Mq!==t.length)return;const n=Math.ceil(e/dp),i=p_*dp,r=Pme(i,m_*n);let s=0,a=0,o=0;for(let c=0;c<t.length;++c){const l=a*m_+o,u=t[c];for(let h=0;h<p_;++h){const d=s*p_+h;r.bits[d+l*i]=bze(u,7-h)}++o,o===m_&&(o=0,++s,s===dp&&(s=0,++a))}return r}/* Common package for dealing with hex/string/uint8 conversions (and sha1 hashing)
*
* @author   Jimmy Wrting <jimmy@warting.se> (https://jimmy.warting.se/opensource)
* @license  MIT
*/const cne="0123456789abcdef",Lme=[],b3=[];for(let t=0;t<256;t++)Lme[t]=cne[t>>4&15]+cne[t&15],t<16&&(t<10?b3[48+t]=t:b3[87+t]=t);const Ume=t=>{const e=t.length;let n="",i=0;for(;i<e;)n+=Lme[t[i++]];return n},ON=t=>{const e=t.length>>1,n=e<<1,i=new Uint8Array(e);let r=0,s=0;for(;s<n;)i[r++]=b3[t.charCodeAt(s++)]<<4|b3[t.charCodeAt(s++)];return i};var lne="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Eze=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(var HD=0;HD<lne.length;HD++)Eze[lne.charCodeAt(HD)]=HD;new TextDecoder;new TextEncoder;const une=typeof window<"u"?window:self,hne=une.crypto||une.msCrypto||{};hne.subtle||hne.webkitSubtle;const dR=ON("000000000000000000000000000000007e81a58181bd99817e00000000007effdbffffc3e7ff7e0000000000006cfefefefe7c381000000000000010387cfe7c3810000000000000183c3ce7e7e718183c0000000000183c7effff7e18183c0000000000000000183c3c180000000000ffffffffffe7c3c3e7ffffffffff000000003c664242663c00000000ffffffffc399bdbd99c3ffffffff00001e0e1a3278cccccc7800000000003c6666663c187e181800000000003f333f30303070f0e000000000007f637f63636367e7e6c0000000001818db3ce73cdb1818000000000080c0e0f8fef8e0c080000000000002060e3efe3e0e06020000000000183c7e1818187e3c18000000000066666666666600666600000000007fdbdbdb7b1b1b1b1b000000007cc660386cc6c66c380cc67c000000000000000000fefefe0000000000183c7e1818187e3c187e00000000183c7e18181818181800000000001818181818187e3c1800000000000000180cfe0c180000000000000000003060fe603000000000000000000000c0c0c0fe000000000000000000286cfe6c2800000000000000001038387c7cfefe00000000000000fefe7c7c3838100000000000000000000000000000000000000000183c3c3c1818001818000000006666662400000000000000000000006c6cfe6c6c6cfe6c6c00000018187cc6c2c07c0686c67c18180000000000c2c60c183066c60000000000386c6c3876dccccc76000000003030306000000000000000000000000c183030303030180c000000000030180c0c0c0c0c183000000000000000663cff3c6600000000000000000018187e181800000000000000000000000000181818300000000000000000fe000000000000000000000000000000001818000000000002060c183060c0800000000000007cc6cedef6e6c6c67c000000000018387818181818187e00000000007cc6060c183060c6fe00000000007cc606063c0606c67c00000000000c1c3c6cccfe0c0c1e0000000000fec0c0c0fc0606c67c00000000003860c0c0fcc6c6c67c0000000000fec6060c183030303000000000007cc6c6c67cc6c6c67c00000000007cc6c6c67e06060c78000000000000181800000018180000000000000018180000001818300000000000060c18306030180c0600000000000000007e00007e000000000000006030180c060c18306000000000007cc6c60c181800181800000000007cc6c6dedededcc07c000000000010386cc6c6fec6c6c60000000000fc6666667c666666fc00000000003c66c2c0c0c0c2663c0000000000f86c66666666666cf80000000000fe66626878686266fe0000000000fe66626878686060f000000000003c66c2c0c0dec6663a0000000000c6c6c6c6fec6c6c6c600000000003c181818181818183c00000000001e0c0c0c0c0ccccc780000000000e6666c6c786c6c66e60000000000f060606060606266fe0000000000c6eefefed6c6c6c6c60000000000c6e6f6fedecec6c6c60000000000386cc6c6c6c6c66c380000000000fc6666667c606060f000000000007cc6c6c6c6d6de7c0c0e00000000fc6666667c6c6666e600000000007cc6c660380cc6c67c00000000007e7e5a18181818183c0000000000c6c6c6c6c6c6c6c67c0000000000c6c6c6c6c6c66c38100000000000c6c6c6c6d6d6fe7c6c0000000000c6c66c3838386cc6c60000000000666666663c1818183c0000000000fec68c183060c2c6fe00000000003c303030303030303c000000000080c0e070381c0e060200000000003c0c0c0c0c0c0c0c3c00000010386cc600000000000000000000000000000000000000000000ff0030301800000000000000000000000000000000780c7ccccc760000000000e06060786c6666667c00000000000000007cc6c0c0c67c00000000001c0c0c3c6ccccccc7600000000000000007cc6fec0c67c0000000000386c6460f0606060f0000000000000000076cccccc7c0ccc78000000e060606c76666666e6000000000018180038181818183c00000000000606000e0606060666663c000000e06060666c786c66e6000000000038181818181818183c0000000000000000ecfed6d6d6c60000000000000000dc666666666600000000000000007cc6c6c6c67c0000000000000000dc6666667c6060f000000000000076cccccc7c0c0c1e000000000000dc76666060f000000000000000007cc6701cc67c0000000000103030fc303030361c0000000000000000cccccccccc760000000000000000666666663c180000000000000000c6c6d6d6fe6c0000000000000000c66c38386cc60000000000000000c6c6c6c67e060cf8000000000000fecc183066fe00000000000e181818701818180e00000000001818181800181818180000000000701818180e18181870000000000076dc000000000000000000000000000010386cc6c6fe0000000000003c66c2c0c0c2663c0c067c000000cccc00cccccccccc76000000000c1830007cc6fec0c67c0000000010386c00780c7ccccc760000000000cccc00780c7ccccc760000000060301800780c7ccccc7600000000386c3800780c7ccccc76000000000000003c6660663c0c063c00000010386c007cc6fec0c67c0000000000cccc007cc6fec0c67c00000000603018007cc6fec0c67c000000000066660038181818183c00000000183c660038181818183c000000006030180038181818183c00000000c6c610386cc6c6fec6c6000000386c3800386cc6c6fec6c600000018306000fe66607c6066fe00000000000000cc76367ed8d86e00000000003e6cccccfeccccccce0000000010386c007cc6c6c6c67c0000000000c6c6007cc6c6c6c67c00000000603018007cc6c6c6c67c000000003078cc00cccccccccc760000000060301800cccccccccc760000000000c6c600c6c6c6c67e060c780000c6c6386cc6c6c6c66c3800000000c6c600c6c6c6c6c6c67c0000000018183c666060663c181800000000386c6460f0606060e6fc000000000066663c187e187e181800000000f8ccccf8c4ccdeccccc6000000000e1b1818187e18181818d870000018306000780c7ccccc76000000000c18300038181818183c00000000183060007cc6c6c6c67c0000000018306000cccccccccc76000000000076dc00dc666666666600000076dc00c6e6f6fedecec6c6000000003c6c6c3e007e0000000000000000386c6c38007c000000000000000000303000303060c6c67c000000000000000000fec0c0c000000000000000000000fe0606060000000000c0c0c6ccd83060dc860c183e0000c0c0c6ccd83066ce9e3e060600000018180018183c3c3c1800000000000000366cd86c36000000000000000000d86c366cd80000000000114411441144114411441144114455aa55aa55aa55aa55aa55aa55aadd77dd77dd77dd77dd77dd77dd77181818181818181818181818181818181818181818f81818181818181818181818f818f818181818181836363636363636f636363636363600000000000000fe3636363636360000000000f818f81818181818183636363636f606f636363636363636363636363636363636363636360000000000fe06f63636363636363636363636f606fe00000000000036363636363636fe0000000000001818181818f818f800000000000000000000000000f8181818181818181818181818181f00000000000018181818181818ff00000000000000000000000000ff181818181818181818181818181f18181818181800000000000000ff00000000000018181818181818ff18181818181818181818181f181f1818181818183636363636363637363636363636363636363637303f00000000000000000000003f30373636363636363636363636f700ff0000000000000000000000ff00f736363636363636363636363730373636363636360000000000ff00ff0000000000003636363636f700f73636363636361818181818ff00ff00000000000036363636363636ff0000000000000000000000ff00ff18181818181800000000000000ff363636363636363636363636363f00000000000018181818181f181f00000000000000000000001f181f181818181818000000000000003f36363636363636363636363636ff3636363636361818181818ff18ff18181818181818181818181818f8000000000000000000000000001f181818181818ffffffffffffffffffffffffffff00000000000000fffffffffffffff0f0f0f0f0f0f0f0f0f0f0f0f0f00f0f0f0f0f0f0f0f0f0f0f0f0f0fffffffffffffff00000000000000000000000076dcd8d8dc76000000000000007cc6fcc6c6fcc0c040000000fec6c6c0c0c0c0c0c000000000000000fe6c6c6c6c6c6c0000000000fec66030183060c6fe00000000000000007ed8d8d8d87000000000000000666666667c6060c000000000000076dc181818181800000000007e183c6666663c187e0000000000386cc6c6fec6c66c380000000000386cc6c6c66c6c6cee00000000001e30180c3e6666663c00000000000000007edbdb7e0000000000000003067edbdbf37e60c000000000001c3060607c6060301c0000000000007cc6c6c6c6c6c6c6000000000000fe0000fe0000fe0000000000000018187e18180000ff000000000030180c060c1830007e00000000000c18306030180c007e00000000000e1b1b1818181818181818181818181818181818d8d8700000000000001818007e001818000000000000000076dc0076dc000000000000386c6c3800000000000000000000000000000018180000000000000000000000000018000000000000000f0c0c0c0c0cec6c3c1c00000000d86c6c6c6c6c000000000000000070d83060c8f800000000000000000000007c7c7c7c7c7c000000000000000000000000000000000000"),G1=ON("00000000002a002a00002a2a2a00002a002a2a15002a2a2a15151515153f153f15153f3f3f15153f153f3f3f153f3f3f"),bm=globalThis||void 0||self;var Bme=typeof bm=="object"&&bm&&bm.Object===Object&&bm,Sze=typeof self=="object"&&self&&self.Object===Object&&self,y0=Bme||Sze||Function("return this")(),xp=y0.Symbol,Fme=Object.prototype,Tze=Fme.hasOwnProperty,xze=Fme.toString,dM=xp?xp.toStringTag:void 0;function wze(t){var e=Tze.call(t,dM),n=t[dM];try{t[dM]=void 0;var i=!0}catch{}var r=xze.call(t);return i&&(e?t[dM]=n:delete t[dM]),r}var Cze=Object.prototype,Aze=Cze.toString;function Rze(t){return Aze.call(t)}var Mze="[object Null]",Oze="[object Undefined]",dne=xp?xp.toStringTag:void 0;function DE(t){return t==null?t===void 0?Oze:Mze:dne&&dne in Object(t)?wze(t):Rze(t)}function Am(t){return t!=null&&typeof t=="object"}var Nze="[object Symbol]";function ZF(t){return typeof t=="symbol"||Am(t)&&DE(t)==Nze}function JF(t,e){for(var n=-1,i=t==null?0:t.length,r=Array(i);++n<i;)r[n]=e(t[n],n,t);return r}var Yr=Array.isArray,Ize=1/0,fne=xp?xp.prototype:void 0,pne=fne?fne.toString:void 0;function zme(t){if(typeof t=="string")return t;if(Yr(t))return JF(t,zme)+"";if(ZF(t))return pne?pne.call(t):"";var e=t+"";return e=="0"&&1/t==-Ize?"-0":e}var kze=/\s/;function Pze(t){for(var e=t.length;e--&&kze.test(t.charAt(e)););return e}var Dze=/^\s+/;function Lze(t){return t&&t.slice(0,Pze(t)+1).replace(Dze,"")}function wp(t){var e=typeof t;return t!=null&&(e=="object"||e=="function")}var mne=NaN,Uze=/^[-+]0x[0-9a-f]+$/i,Bze=/^0b[01]+$/i,Fze=/^0o[0-7]+$/i,zze=parseInt;function jze(t){if(typeof t=="number")return t;if(ZF(t))return mne;if(wp(t)){var e=typeof t.valueOf=="function"?t.valueOf():t;t=wp(e)?e+"":e}if(typeof t!="string")return t===0?t:+t;t=Lze(t);var n=Bze.test(t);return n||Fze.test(t)?zze(t.slice(2),n?2:8):Uze.test(t)?mne:+t}var gne=1/0,Hze=17976931348623157e292;function Vze(t){if(!t)return t===0?t:0;if(t=jze(t),t===gne||t===-gne){var e=t<0?-1:1;return e*Hze}return t===t?t:0}function QF(t){var e=Vze(t),n=e%1;return e===e?n?e-n:e:0}function lA(t){return t}var Gze="[object AsyncFunction]",qze="[object Function]",$ze="[object GeneratorFunction]",Wze="[object Proxy]";function H_(t){if(!wp(t))return!1;var e=DE(t);return e==qze||e==$ze||e==Gze||e==Wze}var oH=y0["__core-js_shared__"],vne=function(){var t=/[^.]+$/.exec(oH&&oH.keys&&oH.keys.IE_PROTO||"");return t?"Symbol(src)_1."+t:""}();function Yze(t){return!!vne&&vne in t}var Kze=Function.prototype,Xze=Kze.toString;function q1(t){if(t!=null){try{return Xze.call(t)}catch{}try{return t+""}catch{}}return""}var Zze=/[\\^$.*+?()[\]{}|]/g,Jze=/^\[object .+?Constructor\]$/,Qze=Function.prototype,e8e=Object.prototype,t8e=Qze.toString,n8e=e8e.hasOwnProperty,i8e=RegExp("^"+t8e.call(n8e).replace(Zze,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function r8e(t){if(!wp(t)||Yze(t))return!1;var e=H_(t)?i8e:Jze;return e.test(q1(t))}function s8e(t,e){return t==null?void 0:t[e]}function $1(t,e){var n=s8e(t,e);return r8e(n)?n:void 0}var Nq=$1(y0,"WeakMap"),_ne=Object.create,a8e=function(){function t(){}return function(e){if(!wp(e))return{};if(_ne)return _ne(e);t.prototype=e;var n=new t;return t.prototype=void 0,n}}();function o8e(t,e,n){switch(n.length){case 0:return t.call(e);case 1:return t.call(e,n[0]);case 2:return t.call(e,n[0],n[1]);case 3:return t.call(e,n[0],n[1],n[2])}return t.apply(e,n)}function Bc(){}function c8e(t,e){var n=-1,i=t.length;for(e||(e=Array(i));++n<i;)e[n]=t[n];return e}var l8e=800,u8e=16,h8e=Date.now;function d8e(t){var e=0,n=0;return function(){var i=h8e(),r=u8e-(i-n);if(n=i,r>0){if(++e>=l8e)return arguments[0]}else e=0;return t.apply(void 0,arguments)}}function f8e(t){return function(){return t}}var E3=function(){try{var t=$1(Object,"defineProperty");return t({},"",{}),t}catch{}}(),p8e=E3?function(t,e){return E3(t,"toString",{configurable:!0,enumerable:!1,value:f8e(e),writable:!0})}:lA,m8e=d8e(p8e);function jme(t,e){for(var n=-1,i=t==null?0:t.length;++n<i&&e(t[n],n,t)!==!1;);return t}function Hme(t,e,n,i){for(var r=t.length,s=n+-1;++s<r;)if(e(t[s],s,t))return s;return-1}function g8e(t){return t!==t}function v8e(t,e,n){for(var i=n-1,r=t.length;++i<r;)if(t[i]===e)return i;return-1}function eY(t,e,n){return e===e?v8e(t,e,n):Hme(t,g8e,n)}function Vme(t,e){var n=t==null?0:t.length;return!!n&&eY(t,e,0)>-1}var _8e=9007199254740991,y8e=/^(?:0|[1-9]\d*)$/;function e4(t,e){var n=typeof t;return e=e??_8e,!!e&&(n=="number"||n!="symbol"&&y8e.test(t))&&t>-1&&t%1==0&&t<e}function tY(t,e,n){e=="__proto__"&&E3?E3(t,e,{configurable:!0,enumerable:!0,value:n,writable:!0}):t[e]=n}function dk(t,e){return t===e||t!==t&&e!==e}var b8e=Object.prototype,E8e=b8e.hasOwnProperty;function t4(t,e,n){var i=t[e];(!(E8e.call(t,e)&&dk(i,n))||n===void 0&&!(e in t))&&tY(t,e,n)}function nY(t,e,n,i){var r=!n;n||(n={});for(var s=-1,a=e.length;++s<a;){var o=e[s],c=void 0;c===void 0&&(c=t[o]),r?tY(n,o,c):t4(n,o,c)}return n}var yne=Math.max;function S8e(t,e,n){return e=yne(e===void 0?t.length-1:e,0),function(){for(var i=arguments,r=-1,s=yne(i.length-e,0),a=Array(s);++r<s;)a[r]=i[e+r];r=-1;for(var o=Array(e+1);++r<e;)o[r]=i[r];return o[e]=n(a),o8e(t,this,o)}}function iY(t,e){return m8e(S8e(t,e,lA),t+"")}var T8e=9007199254740991;function rY(t){return typeof t=="number"&&t>-1&&t%1==0&&t<=T8e}function b0(t){return t!=null&&rY(t.length)&&!H_(t)}function Gme(t,e,n){if(!wp(n))return!1;var i=typeof e;return(i=="number"?b0(n)&&e4(e,n.length):i=="string"&&e in n)?dk(n[e],t):!1}function x8e(t){return iY(function(e,n){var i=-1,r=n.length,s=r>1?n[r-1]:void 0,a=r>2?n[2]:void 0;for(s=t.length>3&&typeof s=="function"?(r--,s):void 0,a&&Gme(n[0],n[1],a)&&(s=r<3?void 0:s,r=1),e=Object(e);++i<r;){var o=n[i];o&&t(e,o,i,s)}return e})}var w8e=Object.prototype;function fk(t){var e=t&&t.constructor,n=typeof e=="function"&&e.prototype||w8e;return t===n}function C8e(t,e){for(var n=-1,i=Array(t);++n<t;)i[n]=e(n);return i}var A8e="[object Arguments]";function bne(t){return Am(t)&&DE(t)==A8e}var qme=Object.prototype,R8e=qme.hasOwnProperty,M8e=qme.propertyIsEnumerable,n4=bne(function(){return arguments}())?bne:function(t){return Am(t)&&R8e.call(t,"callee")&&!M8e.call(t,"callee")};function O8e(){return!1}var $me=typeof exports=="object"&&exports&&!exports.nodeType&&exports,Ene=$me&&typeof module=="object"&&module&&!module.nodeType&&module,N8e=Ene&&Ene.exports===$me,Sne=N8e?y0.Buffer:void 0,I8e=Sne?Sne.isBuffer:void 0,NN=I8e||O8e,k8e="[object Arguments]",P8e="[object Array]",D8e="[object Boolean]",L8e="[object Date]",U8e="[object Error]",B8e="[object Function]",F8e="[object Map]",z8e="[object Number]",j8e="[object Object]",H8e="[object RegExp]",V8e="[object Set]",G8e="[object String]",q8e="[object WeakMap]",$8e="[object ArrayBuffer]",W8e="[object DataView]",Y8e="[object Float32Array]",K8e="[object Float64Array]",X8e="[object Int8Array]",Z8e="[object Int16Array]",J8e="[object Int32Array]",Q8e="[object Uint8Array]",e5e="[object Uint8ClampedArray]",t5e="[object Uint16Array]",n5e="[object Uint32Array]",xa={};xa[Y8e]=xa[K8e]=xa[X8e]=xa[Z8e]=xa[J8e]=xa[Q8e]=xa[e5e]=xa[t5e]=xa[n5e]=!0;xa[k8e]=xa[P8e]=xa[$8e]=xa[D8e]=xa[W8e]=xa[L8e]=xa[U8e]=xa[B8e]=xa[F8e]=xa[z8e]=xa[j8e]=xa[H8e]=xa[V8e]=xa[G8e]=xa[q8e]=!1;function i5e(t){return Am(t)&&rY(t.length)&&!!xa[DE(t)]}function i4(t){return function(e){return t(e)}}var Wme=typeof exports=="object"&&exports&&!exports.nodeType&&exports,CO=Wme&&typeof module=="object"&&module&&!module.nodeType&&module,r5e=CO&&CO.exports===Wme,cH=r5e&&Bme.process,aE=function(){try{var t=CO&&CO.require&&CO.require("util").types;return t||cH&&cH.binding&&cH.binding("util")}catch{}}(),Tne=aE&&aE.isTypedArray,sY=Tne?i4(Tne):i5e,s5e=Object.prototype,a5e=s5e.hasOwnProperty;function Yme(t,e){var n=Yr(t),i=!n&&n4(t),r=!n&&!i&&NN(t),s=!n&&!i&&!r&&sY(t),a=n||i||r||s,o=a?C8e(t.length,String):[],c=o.length;for(var l in t)(e||a5e.call(t,l))&&!(a&&(l=="length"||r&&(l=="offset"||l=="parent")||s&&(l=="buffer"||l=="byteLength"||l=="byteOffset")||e4(l,c)))&&o.push(l);return o}function Kme(t,e){return function(n){return t(e(n))}}var o5e=Kme(Object.keys,Object),c5e=Object.prototype,l5e=c5e.hasOwnProperty;function Xme(t){if(!fk(t))return o5e(t);var e=[];for(var n in Object(t))l5e.call(t,n)&&n!="constructor"&&e.push(n);return e}function Cp(t){return b0(t)?Yme(t):Xme(t)}var u5e=Object.prototype,h5e=u5e.hasOwnProperty,pd=x8e(function(t,e){if(fk(e)||b0(e)){nY(e,Cp(e),t);return}for(var n in e)h5e.call(e,n)&&t4(t,n,e[n])});function d5e(t){var e=[];if(t!=null)for(var n in Object(t))e.push(n);return e}var f5e=Object.prototype,p5e=f5e.hasOwnProperty;function m5e(t){if(!wp(t))return d5e(t);var e=fk(t),n=[];for(var i in t)i=="constructor"&&(e||!p5e.call(t,i))||n.push(i);return n}function Zme(t){return b0(t)?Yme(t,!0):m5e(t)}var g5e=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,v5e=/^\w*$/;function aY(t,e){if(Yr(t))return!1;var n=typeof t;return n=="number"||n=="symbol"||n=="boolean"||t==null||ZF(t)?!0:v5e.test(t)||!g5e.test(t)||e!=null&&t in Object(e)}var IN=$1(Object,"create");function _5e(){this.__data__=IN?IN(null):{},this.size=0}function y5e(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e}var b5e="__lodash_hash_undefined__",E5e=Object.prototype,S5e=E5e.hasOwnProperty;function T5e(t){var e=this.__data__;if(IN){var n=e[t];return n===b5e?void 0:n}return S5e.call(e,t)?e[t]:void 0}var x5e=Object.prototype,w5e=x5e.hasOwnProperty;function C5e(t){var e=this.__data__;return IN?e[t]!==void 0:w5e.call(e,t)}var A5e="__lodash_hash_undefined__";function R5e(t,e){var n=this.__data__;return this.size+=this.has(t)?0:1,n[t]=IN&&e===void 0?A5e:e,this}function u1(t){var e=-1,n=t==null?0:t.length;for(this.clear();++e<n;){var i=t[e];this.set(i[0],i[1])}}u1.prototype.clear=_5e;u1.prototype.delete=y5e;u1.prototype.get=T5e;u1.prototype.has=C5e;u1.prototype.set=R5e;function M5e(){this.__data__=[],this.size=0}function r4(t,e){for(var n=t.length;n--;)if(dk(t[n][0],e))return n;return-1}var O5e=Array.prototype,N5e=O5e.splice;function I5e(t){var e=this.__data__,n=r4(e,t);if(n<0)return!1;var i=e.length-1;return n==i?e.pop():N5e.call(e,n,1),--this.size,!0}function k5e(t){var e=this.__data__,n=r4(e,t);return n<0?void 0:e[n][1]}function P5e(t){return r4(this.__data__,t)>-1}function D5e(t,e){var n=this.__data__,i=r4(n,t);return i<0?(++this.size,n.push([t,e])):n[i][1]=e,this}function V_(t){var e=-1,n=t==null?0:t.length;for(this.clear();++e<n;){var i=t[e];this.set(i[0],i[1])}}V_.prototype.clear=M5e;V_.prototype.delete=I5e;V_.prototype.get=k5e;V_.prototype.has=P5e;V_.prototype.set=D5e;var kN=$1(y0,"Map");function L5e(){this.size=0,this.__data__={hash:new u1,map:new(kN||V_),string:new u1}}function U5e(t){var e=typeof t;return e=="string"||e=="number"||e=="symbol"||e=="boolean"?t!=="__proto__":t===null}function s4(t,e){var n=t.__data__;return U5e(e)?n[typeof e=="string"?"string":"hash"]:n.map}function B5e(t){var e=s4(this,t).delete(t);return this.size-=e?1:0,e}function F5e(t){return s4(this,t).get(t)}function z5e(t){return s4(this,t).has(t)}function j5e(t,e){var n=s4(this,t),i=n.size;return n.set(t,e),this.size+=n.size==i?0:1,this}function G_(t){var e=-1,n=t==null?0:t.length;for(this.clear();++e<n;){var i=t[e];this.set(i[0],i[1])}}G_.prototype.clear=L5e;G_.prototype.delete=B5e;G_.prototype.get=F5e;G_.prototype.has=z5e;G_.prototype.set=j5e;var H5e="Expected a function";function oY(t,e){if(typeof t!="function"||e!=null&&typeof e!="function")throw new TypeError(H5e);var n=function(){var i=arguments,r=e?e.apply(this,i):i[0],s=n.cache;if(s.has(r))return s.get(r);var a=t.apply(this,i);return n.cache=s.set(r,a)||s,a};return n.cache=new(oY.Cache||G_),n}oY.Cache=G_;var V5e=500;function G5e(t){var e=oY(t,function(i){return n.size===V5e&&n.clear(),i}),n=e.cache;return e}var q5e=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,$5e=/\\(\\)?/g,W5e=G5e(function(t){var e=[];return t.charCodeAt(0)===46&&e.push(""),t.replace(q5e,function(n,i,r,s){e.push(r?s.replace($5e,"$1"):i||n)}),e});function Jme(t){return t==null?"":zme(t)}function a4(t,e){return Yr(t)?t:aY(t,e)?[t]:W5e(Jme(t))}var Y5e=1/0;function pk(t){if(typeof t=="string"||ZF(t))return t;var e=t+"";return e=="0"&&1/t==-Y5e?"-0":e}function cY(t,e){e=a4(e,t);for(var n=0,i=e.length;t!=null&&n<i;)t=t[pk(e[n++])];return n&&n==i?t:void 0}function K5e(t,e,n){var i=t==null?void 0:cY(t,e);return i===void 0?n:i}function lY(t,e){for(var n=-1,i=e.length,r=t.length;++n<i;)t[r+n]=e[n];return t}var xne=xp?xp.isConcatSpreadable:void 0;function X5e(t){return Yr(t)||n4(t)||!!(xne&&t&&t[xne])}function uY(t,e,n,i,r){var s=-1,a=t.length;for(n||(n=X5e),r||(r=[]);++s<a;){var o=t[s];n(o)?lY(r,o):i||(r[r.length]=o)}return r}function ld(t){var e=t==null?0:t.length;return e?uY(t):[]}var Qme=Kme(Object.getPrototypeOf,Object);function hY(t,e,n){var i=-1,r=t.length;e<0&&(e=-e>r?0:r+e),n=n>r?r:n,n<0&&(n+=r),r=e>n?0:n-e>>>0,e>>>=0;for(var s=Array(r);++i<r;)s[i]=t[i+e];return s}function Z5e(t,e,n){var i=t.length;return n=n===void 0?i:n,!e&&n>=i?t:hY(t,e,n)}var J5e="\\ud800-\\udfff",Q5e="\\u0300-\\u036f",eje="\\ufe20-\\ufe2f",tje="\\u20d0-\\u20ff",nje=Q5e+eje+tje,ije="\\ufe0e\\ufe0f",rje="\\u200d",sje=RegExp("["+rje+J5e+nje+ije+"]");function ege(t){return sje.test(t)}function aje(t){return t.split("")}var tge="\\ud800-\\udfff",oje="\\u0300-\\u036f",cje="\\ufe20-\\ufe2f",lje="\\u20d0-\\u20ff",uje=oje+cje+lje,hje="\\ufe0e\\ufe0f",dje="["+tge+"]",Iq="["+uje+"]",kq="\\ud83c[\\udffb-\\udfff]",fje="(?:"+Iq+"|"+kq+")",nge="[^"+tge+"]",ige="(?:\\ud83c[\\udde6-\\uddff]){2}",rge="[\\ud800-\\udbff][\\udc00-\\udfff]",pje="\\u200d",sge=fje+"?",age="["+hje+"]?",mje="(?:"+pje+"(?:"+[nge,ige,rge].join("|")+")"+age+sge+")*",gje=age+sge+mje,vje="(?:"+[nge+Iq+"?",Iq,ige,rge,dje].join("|")+")",_je=RegExp(kq+"(?="+kq+")|"+vje+gje,"g");function yje(t){return t.match(_je)||[]}function bje(t){return ege(t)?yje(t):aje(t)}function Eje(t){return function(e){e=Jme(e);var n=ege(e)?bje(e):void 0,i=n?n[0]:e.charAt(0),r=n?Z5e(n,1).join(""):e.slice(1);return i[t]()+r}}var oge=Eje("toUpperCase");function Sje(t,e,n,i){var r=-1,s=t==null?0:t.length;for(i&&s&&(n=t[++r]);++r<s;)n=e(n,t[r],r,t);return n}function Tje(){this.__data__=new V_,this.size=0}function xje(t){var e=this.__data__,n=e.delete(t);return this.size=e.size,n}function wje(t){return this.__data__.get(t)}function Cje(t){return this.__data__.has(t)}var Aje=200;function Rje(t,e){var n=this.__data__;if(n instanceof V_){var i=n.__data__;if(!kN||i.length<Aje-1)return i.push([t,e]),this.size=++n.size,this;n=this.__data__=new G_(i)}return n.set(t,e),this.size=n.size,this}function Qg(t){var e=this.__data__=new V_(t);this.size=e.size}Qg.prototype.clear=Tje;Qg.prototype.delete=xje;Qg.prototype.get=wje;Qg.prototype.has=Cje;Qg.prototype.set=Rje;function Mje(t,e){return t&&nY(e,Cp(e),t)}var cge=typeof exports=="object"&&exports&&!exports.nodeType&&exports,wne=cge&&typeof module=="object"&&module&&!module.nodeType&&module,Oje=wne&&wne.exports===cge,Cne=Oje?y0.Buffer:void 0,Ane=Cne?Cne.allocUnsafe:void 0;function Nje(t,e){var n=t.length,i=Ane?Ane(n):new t.constructor(n);return t.copy(i),i}function dY(t,e){for(var n=-1,i=t==null?0:t.length,r=0,s=[];++n<i;){var a=t[n];e(a,n,t)&&(s[r++]=a)}return s}function lge(){return[]}var Ije=Object.prototype,kje=Ije.propertyIsEnumerable,Rne=Object.getOwnPropertySymbols,fY=Rne?function(t){return t==null?[]:(t=Object(t),dY(Rne(t),function(e){return kje.call(t,e)}))}:lge;function Pje(t,e){return nY(t,fY(t),e)}var Dje=Object.getOwnPropertySymbols,Lje=Dje?function(t){for(var e=[];t;)lY(e,fY(t)),t=Qme(t);return e}:lge;function uge(t,e,n){var i=e(t);return Yr(t)?i:lY(i,n(t))}function Pq(t){return uge(t,Cp,fY)}function Uje(t){return uge(t,Zme,Lje)}var Dq=$1(y0,"DataView"),Lq=$1(y0,"Promise"),bC=$1(y0,"Set"),Mne="[object Map]",Bje="[object Object]",One="[object Promise]",Nne="[object Set]",Ine="[object WeakMap]",kne="[object DataView]",Fje=q1(Dq),zje=q1(kN),jje=q1(Lq),Hje=q1(bC),Vje=q1(Nq),ep=DE;(Dq&&ep(new Dq(new ArrayBuffer(1)))!=kne||kN&&ep(new kN)!=Mne||Lq&&ep(Lq.resolve())!=One||bC&&ep(new bC)!=Nne||Nq&&ep(new Nq)!=Ine)&&(ep=function(t){var e=DE(t),n=e==Bje?t.constructor:void 0,i=n?q1(n):"";if(i)switch(i){case Fje:return kne;case zje:return Mne;case jje:return One;case Hje:return Nne;case Vje:return Ine}return e});var Gje=Object.prototype,qje=Gje.hasOwnProperty;function $je(t){var e=t.length,n=new t.constructor(e);return e&&typeof t[0]=="string"&&qje.call(t,"index")&&(n.index=t.index,n.input=t.input),n}var S3=y0.Uint8Array;function Wje(t){var e=new t.constructor(t.byteLength);return new S3(e).set(new S3(t)),e}function Yje(t,e){var n=t.buffer;return new t.constructor(n,t.byteOffset,t.byteLength)}var Kje=/\w*$/;function Xje(t){var e=new t.constructor(t.source,Kje.exec(t));return e.lastIndex=t.lastIndex,e}var Pne=xp?xp.prototype:void 0,Dne=Pne?Pne.valueOf:void 0;function Zje(t){return Dne?Object(Dne.call(t)):{}}function Jje(t,e){var n=t.buffer;return new t.constructor(n,t.byteOffset,t.length)}var Qje="[object Boolean]",eHe="[object Date]",tHe="[object Map]",nHe="[object Number]",iHe="[object RegExp]",rHe="[object Set]",sHe="[object String]",aHe="[object Symbol]",oHe="[object ArrayBuffer]",cHe="[object DataView]",lHe="[object Float32Array]",uHe="[object Float64Array]",hHe="[object Int8Array]",dHe="[object Int16Array]",fHe="[object Int32Array]",pHe="[object Uint8Array]",mHe="[object Uint8ClampedArray]",gHe="[object Uint16Array]",vHe="[object Uint32Array]";function _He(t,e,n){var i=t.constructor;switch(e){case oHe:return Wje(t);case Qje:case eHe:return new i(+t);case cHe:return Yje(t);case lHe:case uHe:case hHe:case dHe:case fHe:case pHe:case mHe:case gHe:case vHe:return Jje(t);case tHe:return new i;case nHe:case sHe:return new i(t);case iHe:return Xje(t);case rHe:return new i;case aHe:return Zje(t)}}function yHe(t){return typeof t.constructor=="function"&&!fk(t)?a8e(Qme(t)):{}}var bHe="[object Map]";function EHe(t){return Am(t)&&ep(t)==bHe}var Lne=aE&&aE.isMap,SHe=Lne?i4(Lne):EHe,THe="[object Set]";function xHe(t){return Am(t)&&ep(t)==THe}var Une=aE&&aE.isSet,wHe=Une?i4(Une):xHe,hge="[object Arguments]",CHe="[object Array]",AHe="[object Boolean]",RHe="[object Date]",MHe="[object Error]",dge="[object Function]",OHe="[object GeneratorFunction]",NHe="[object Map]",IHe="[object Number]",fge="[object Object]",kHe="[object RegExp]",PHe="[object Set]",DHe="[object String]",LHe="[object Symbol]",UHe="[object WeakMap]",BHe="[object ArrayBuffer]",FHe="[object DataView]",zHe="[object Float32Array]",jHe="[object Float64Array]",HHe="[object Int8Array]",VHe="[object Int16Array]",GHe="[object Int32Array]",qHe="[object Uint8Array]",$He="[object Uint8ClampedArray]",WHe="[object Uint16Array]",YHe="[object Uint32Array]",oa={};oa[hge]=oa[CHe]=oa[BHe]=oa[FHe]=oa[AHe]=oa[RHe]=oa[zHe]=oa[jHe]=oa[HHe]=oa[VHe]=oa[GHe]=oa[NHe]=oa[IHe]=oa[fge]=oa[kHe]=oa[PHe]=oa[DHe]=oa[LHe]=oa[qHe]=oa[$He]=oa[WHe]=oa[YHe]=!0;oa[MHe]=oa[dge]=oa[UHe]=!1;function tL(t,e,n,i,r,s){var a;if(a!==void 0)return a;if(!wp(t))return t;var o=Yr(t);if(o)return a=$je(t),c8e(t,a);var c=ep(t),l=c==dge||c==OHe;if(NN(t))return Nje(t);if(c==fge||c==hge||l&&!r)return a=l?{}:yHe(t),Pje(t,Mje(a,t));if(!oa[c])return r?t:{};a=_He(t,c),s||(s=new Qg);var u=s.get(t);if(u)return u;s.set(t,a),wHe(t)?t.forEach(function(f){a.add(tL(f,e,n,f,t,s))}):SHe(t)&&t.forEach(function(f,p){a.set(p,tL(f,e,n,p,t,s))});var h=Pq,d=o?void 0:h(t);return jme(d||t,function(f,p){d&&(p=f,f=t[p]),t4(a,p,tL(f,e,n,p,t,s))}),a}var KHe=4;function Zl(t){return tL(t,KHe)}function mk(t){for(var e=-1,n=t==null?0:t.length,i=0,r=[];++e<n;){var s=t[e];s&&(r[i++]=s)}return r}var XHe="__lodash_hash_undefined__";function ZHe(t){return this.__data__.set(t,XHe),this}function JHe(t){return this.__data__.has(t)}function uA(t){var e=-1,n=t==null?0:t.length;for(this.__data__=new G_;++e<n;)this.add(t[e])}uA.prototype.add=uA.prototype.push=ZHe;uA.prototype.has=JHe;function pge(t,e){for(var n=-1,i=t==null?0:t.length;++n<i;)if(e(t[n],n,t))return!0;return!1}function pY(t,e){return t.has(e)}var QHe=1,eVe=2;function mge(t,e,n,i,r,s){var a=n&QHe,o=t.length,c=e.length;if(o!=c&&!(a&&c>o))return!1;var l=s.get(t),u=s.get(e);if(l&&u)return l==e&&u==t;var h=-1,d=!0,f=n&eVe?new uA:void 0;for(s.set(t,e),s.set(e,t);++h<o;){var p=t[h],g=e[h];if(i)var _=a?i(g,p,h,e,t,s):i(p,g,h,t,e,s);if(_!==void 0){if(_)continue;d=!1;break}if(f){if(!pge(e,function(v,b){if(!pY(f,b)&&(p===v||r(p,v,n,i,s)))return f.push(b)})){d=!1;break}}else if(!(p===g||r(p,g,n,i,s))){d=!1;break}}return s.delete(t),s.delete(e),d}function tVe(t){var e=-1,n=Array(t.size);return t.forEach(function(i,r){n[++e]=[r,i]}),n}function mY(t){var e=-1,n=Array(t.size);return t.forEach(function(i){n[++e]=i}),n}var nVe=1,iVe=2,rVe="[object Boolean]",sVe="[object Date]",aVe="[object Error]",oVe="[object Map]",cVe="[object Number]",lVe="[object RegExp]",uVe="[object Set]",hVe="[object String]",dVe="[object Symbol]",fVe="[object ArrayBuffer]",pVe="[object DataView]",Bne=xp?xp.prototype:void 0,lH=Bne?Bne.valueOf:void 0;function mVe(t,e,n,i,r,s,a){switch(n){case pVe:if(t.byteLength!=e.byteLength||t.byteOffset!=e.byteOffset)return!1;t=t.buffer,e=e.buffer;case fVe:return!(t.byteLength!=e.byteLength||!s(new S3(t),new S3(e)));case rVe:case sVe:case cVe:return dk(+t,+e);case aVe:return t.name==e.name&&t.message==e.message;case lVe:case hVe:return t==e+"";case oVe:var o=tVe;case uVe:var c=i&nVe;if(o||(o=mY),t.size!=e.size&&!c)return!1;var l=a.get(t);if(l)return l==e;i|=iVe,a.set(t,e);var u=mge(o(t),o(e),i,r,s,a);return a.delete(t),u;case dVe:if(lH)return lH.call(t)==lH.call(e)}return!1}var gVe=1,vVe=Object.prototype,_Ve=vVe.hasOwnProperty;function yVe(t,e,n,i,r,s){var a=n&gVe,o=Pq(t),c=o.length,l=Pq(e),u=l.length;if(c!=u&&!a)return!1;for(var h=c;h--;){var d=o[h];if(!(a?d in e:_Ve.call(e,d)))return!1}var f=s.get(t),p=s.get(e);if(f&&p)return f==e&&p==t;var g=!0;s.set(t,e),s.set(e,t);for(var _=a;++h<c;){d=o[h];var v=t[d],b=e[d];if(i)var S=a?i(b,v,d,e,t,s):i(v,b,d,t,e,s);if(!(S===void 0?v===b||r(v,b,n,i,s):S)){g=!1;break}_||(_=d=="constructor")}if(g&&!_){var x=t.constructor,M=e.constructor;x!=M&&"constructor"in t&&"constructor"in e&&!(typeof x=="function"&&x instanceof x&&typeof M=="function"&&M instanceof M)&&(g=!1)}return s.delete(t),s.delete(e),g}var bVe=1,Fne="[object Arguments]",zne="[object Array]",VD="[object Object]",EVe=Object.prototype,jne=EVe.hasOwnProperty;function SVe(t,e,n,i,r,s){var a=Yr(t),o=Yr(e),c=a?zne:ep(t),l=o?zne:ep(e);c=c==Fne?VD:c,l=l==Fne?VD:l;var u=c==VD,h=l==VD,d=c==l;if(d&&NN(t)){if(!NN(e))return!1;a=!0,u=!1}if(d&&!u)return s||(s=new Qg),a||sY(t)?mge(t,e,n,i,r,s):mVe(t,e,c,n,i,r,s);if(!(n&bVe)){var f=u&&jne.call(t,"__wrapped__"),p=h&&jne.call(e,"__wrapped__");if(f||p){var g=f?t.value():t,_=p?e.value():e;return s||(s=new Qg),r(g,_,n,i,s)}}return d?(s||(s=new Qg),yVe(t,e,n,i,r,s)):!1}function gY(t,e,n,i,r){return t===e?!0:t==null||e==null||!Am(t)&&!Am(e)?t!==t&&e!==e:SVe(t,e,n,i,gY,r)}var TVe=1,xVe=2;function wVe(t,e,n,i){var r=n.length,s=r;if(t==null)return!s;for(t=Object(t);r--;){var a=n[r];if(a[2]?a[1]!==t[a[0]]:!(a[0]in t))return!1}for(;++r<s;){a=n[r];var o=a[0],c=t[o],l=a[1];if(a[2]){if(c===void 0&&!(o in t))return!1}else{var u=new Qg,h;if(!(h===void 0?gY(l,c,TVe|xVe,i,u):h))return!1}}return!0}function gge(t){return t===t&&!wp(t)}function CVe(t){for(var e=Cp(t),n=e.length;n--;){var i=e[n],r=t[i];e[n]=[i,r,gge(r)]}return e}function vge(t,e){return function(n){return n==null?!1:n[t]===e&&(e!==void 0||t in Object(n))}}function AVe(t){var e=CVe(t);return e.length==1&&e[0][2]?vge(e[0][0],e[0][1]):function(n){return n===t||wVe(n,t,e)}}function RVe(t,e){return t!=null&&e in Object(t)}function _ge(t,e,n){e=a4(e,t);for(var i=-1,r=e.length,s=!1;++i<r;){var a=pk(e[i]);if(!(s=t!=null&&n(t,a)))break;t=t[a]}return s||++i!=r?s:(r=t==null?0:t.length,!!r&&rY(r)&&e4(a,r)&&(Yr(t)||n4(t)))}function MVe(t,e){return t!=null&&_ge(t,e,RVe)}var OVe=1,NVe=2;function IVe(t,e){return aY(t)&&gge(e)?vge(pk(t),e):function(n){var i=K5e(n,t);return i===void 0&&i===e?MVe(n,t):gY(e,i,OVe|NVe)}}function kVe(t){return function(e){return e==null?void 0:e[t]}}function PVe(t){return function(e){return cY(e,t)}}function DVe(t){return aY(t)?kVe(pk(t)):PVe(t)}function E0(t){return typeof t=="function"?t:t==null?lA:typeof t=="object"?Yr(t)?IVe(t[0],t[1]):AVe(t):DVe(t)}function LVe(t,e,n,i){for(var r=-1,s=t==null?0:t.length;++r<s;){var a=t[r];e(i,a,n(a),t)}return i}function UVe(t){return function(e,n,i){for(var r=-1,s=Object(e),a=i(e),o=a.length;o--;){var c=a[++r];if(n(s[c],c,s)===!1)break}return e}}var BVe=UVe();function FVe(t,e){return t&&BVe(t,e,Cp)}function zVe(t,e){return function(n,i){if(n==null)return n;if(!b0(n))return t(n,i);for(var r=n.length,s=-1,a=Object(n);++s<r&&i(a[s],s,a)!==!1;);return n}}var W1=zVe(FVe);function jVe(t,e,n,i){return W1(t,function(r,s,a){e(i,r,n(r),a)}),i}function HVe(t,e){return function(n,i){var r=Yr(n)?LVe:jVe,s=e?e():{};return r(n,t,E0(i),s)}}var yge=Object.prototype,VVe=yge.hasOwnProperty,vY=iY(function(t,e){t=Object(t);var n=-1,i=e.length,r=i>2?e[2]:void 0;for(r&&Gme(e[0],e[1],r)&&(i=1);++n<i;)for(var s=e[n],a=Zme(s),o=-1,c=a.length;++o<c;){var l=a[o],u=t[l];(u===void 0||dk(u,yge[l])&&!VVe.call(t,l))&&(t[l]=s[l])}return t});function Hne(t){return Am(t)&&b0(t)}var GVe=200;function qVe(t,e,n,i){var r=-1,s=Vme,a=!0,o=t.length,c=[],l=e.length;if(!o)return c;e.length>=GVe&&(s=pY,a=!1,e=new uA(e));e:for(;++r<o;){var u=t[r],h=u;if(u=u!==0?u:0,a&&h===h){for(var d=l;d--;)if(e[d]===h)continue e;c.push(u)}else s(e,h,i)||c.push(u)}return c}var o4=iY(function(t,e){return Hne(t)?qVe(t,uY(e,1,Hne,!0)):[]});function hA(t){var e=t==null?0:t.length;return e?t[e-1]:void 0}function Vl(t,e,n){var i=t==null?0:t.length;return i?(e=e===void 0?1:QF(e),hY(t,e<0?0:e,i)):[]}function PN(t,e,n){var i=t==null?0:t.length;return i?(e=e===void 0?1:QF(e),e=i-e,hY(t,0,e<0?0:e)):[]}function $Ve(t){return typeof t=="function"?t:lA}function Ii(t,e){var n=Yr(t)?jme:W1;return n(t,$Ve(e))}function WVe(t,e){for(var n=-1,i=t==null?0:t.length;++n<i;)if(!e(t[n],n,t))return!1;return!0}function YVe(t,e){var n=!0;return W1(t,function(i,r,s){return n=!!e(i,r,s),n}),n}function wm(t,e,n){var i=Yr(t)?WVe:YVe;return i(t,E0(e))}function bge(t,e){var n=[];return W1(t,function(i,r,s){e(i,r,s)&&n.push(i)}),n}function Ip(t,e){var n=Yr(t)?dY:bge;return n(t,E0(e))}function KVe(t){return function(e,n,i){var r=Object(e);if(!b0(e)){var s=E0(n);e=Cp(e),n=function(o){return s(r[o],o,r)}}var a=t(e,n,i);return a>-1?r[s?e[a]:a]:void 0}}var XVe=Math.max;function ZVe(t,e,n){var i=t==null?0:t.length;if(!i)return-1;var r=n==null?0:QF(n);return r<0&&(r=XVe(i+r,0)),Hme(t,E0(e),r)}var dA=KVe(ZVe);function Rm(t){return t&&t.length?t[0]:void 0}function JVe(t,e){var n=-1,i=b0(t)?Array(t.length):[];return W1(t,function(r,s,a){i[++n]=e(r,s,a)}),i}function Fn(t,e){var n=Yr(t)?JF:JVe;return n(t,E0(e))}function vp(t,e){return uY(Fn(t,e))}var QVe=Object.prototype,eGe=QVe.hasOwnProperty,Ege=HVe(function(t,e,n){eGe.call(t,n)?t[n].push(e):tY(t,n,[e])}),tGe=Object.prototype,nGe=tGe.hasOwnProperty;function iGe(t,e){return t!=null&&nGe.call(t,e)}function xi(t,e){return t!=null&&_ge(t,e,iGe)}var rGe="[object String]";function md(t){return typeof t=="string"||!Yr(t)&&Am(t)&&DE(t)==rGe}function sGe(t,e){return JF(e,function(n){return t[n]})}function _c(t){return t==null?[]:sGe(t,Cp(t))}var aGe=Math.max;function Eh(t,e,n,i){t=b0(t)?t:_c(t),n=n&&!i?QF(n):0;var r=t.length;return n<0&&(n=aGe(r+n,0)),md(t)?n<=r&&t.indexOf(e,n)>-1:!!r&&eY(t,e,n)>-1}function Vne(t,e,n){var i=t==null?0:t.length;if(!i)return-1;var r=0;return eY(t,e,r)}var oGe="[object Map]",cGe="[object Set]",lGe=Object.prototype,uGe=lGe.hasOwnProperty;function ha(t){if(t==null)return!0;if(b0(t)&&(Yr(t)||typeof t=="string"||typeof t.splice=="function"||NN(t)||sY(t)||n4(t)))return!t.length;var e=ep(t);if(e==oGe||e==cGe)return!t.size;if(fk(t))return!Xme(t).length;for(var n in t)if(uGe.call(t,n))return!1;return!0}var hGe="[object RegExp]";function dGe(t){return Am(t)&&DE(t)==hGe}var Gne=aE&&aE.isRegExp,N_=Gne?i4(Gne):dGe;function I_(t){return t===void 0}var fGe="Expected a function";function pGe(t){if(typeof t!="function")throw new TypeError(fGe);return function(){var e=arguments;switch(e.length){case 0:return!t.call(this);case 1:return!t.call(this,e[0]);case 2:return!t.call(this,e[0],e[1]);case 3:return!t.call(this,e[0],e[1],e[2])}return!t.apply(this,e)}}function mGe(t,e,n,i){if(!wp(t))return t;e=a4(e,t);for(var r=-1,s=e.length,a=s-1,o=t;o!=null&&++r<s;){var c=pk(e[r]),l=n;if(c==="__proto__"||c==="constructor"||c==="prototype")return t;if(r!=a){var u=o[c];l=void 0,l===void 0&&(l=wp(u)?u:e4(e[r+1])?[]:{})}t4(o,c,l),o=o[c]}return t}function gGe(t,e,n){for(var i=-1,r=e.length,s={};++i<r;){var a=e[i],o=cY(t,a);n(o,a)&&mGe(s,a4(a,t),o)}return s}function Lm(t,e){if(t==null)return{};var n=JF(Uje(t),function(i){return[i]});return e=E0(e),gGe(t,n,function(i,r){return e(i,r[0])})}function vGe(t,e,n,i,r){return r(t,function(s,a,o){n=i?(i=!1,s):e(n,s,a,o)}),n}function gd(t,e,n){var i=Yr(t)?Sje:vGe,r=arguments.length<3;return i(t,E0(e),n,r,W1)}function c4(t,e){var n=Yr(t)?dY:bge;return n(t,pGe(E0(e)))}function _Ge(t,e){var n;return W1(t,function(i,r,s){return n=e(i,r,s),!n}),!!n}function _Y(t,e,n){var i=Yr(t)?pge:_Ge;return i(t,E0(e))}var yGe=1/0,bGe=bC&&1/mY(new bC([,-0]))[1]==yGe?function(t){return new bC(t)}:Bc,EGe=200;function SGe(t,e,n){var i=-1,r=Vme,s=t.length,a=!0,o=[],c=o;if(s>=EGe){var l=bGe(t);if(l)return mY(l);a=!1,r=pY,c=new uA}else c=o;e:for(;++i<s;){var u=t[i],h=u;if(u=u!==0?u:0,a&&h===h){for(var d=c.length;d--;)if(c[d]===h)continue e;o.push(u)}else r(c,h,n)||(c!==o&&c.push(h),o.push(u))}return o}function l4(t){return t&&t.length?SGe(t):[]}function Uq(t){console&&console.error&&console.error(`Error: ${t}`)}function Sge(t){console&&console.warn&&console.warn(`Warning: ${t}`)}function Tge(t){const e=new Date().getTime(),n=t();return{time:new Date().getTime()-e,value:n}}function xge(t){function e(){}e.prototype=t;const n=new e;function i(){return typeof n.bar}return i(),i(),t}function TGe(t){return xGe(t)?t.LABEL:t.name}function xGe(t){return md(t.LABEL)&&t.LABEL!==""}class S0{get definition(){return this._definition}set definition(e){this._definition=e}constructor(e){this._definition=e}accept(e){e.visit(this),Ii(this.definition,n=>{n.accept(e)})}}class vd extends S0{constructor(e){super([]),this.idx=1,pd(this,Lm(e,n=>n!==void 0))}set definition(e){}get definition(){return this.referencedRule!==void 0?this.referencedRule.definition:[]}accept(e){e.visit(this)}}class fR extends S0{constructor(e){super(e.definition),this.orgText="",pd(this,Lm(e,n=>n!==void 0))}}class _d extends S0{constructor(e){super(e.definition),this.ignoreAmbiguities=!1,pd(this,Lm(e,n=>n!==void 0))}}class ud extends S0{constructor(e){super(e.definition),this.idx=1,pd(this,Lm(e,n=>n!==void 0))}}class T0 extends S0{constructor(e){super(e.definition),this.idx=1,pd(this,Lm(e,n=>n!==void 0))}}class x0 extends S0{constructor(e){super(e.definition),this.idx=1,pd(this,Lm(e,n=>n!==void 0))}}class qc extends S0{constructor(e){super(e.definition),this.idx=1,pd(this,Lm(e,n=>n!==void 0))}}class Um extends S0{constructor(e){super(e.definition),this.idx=1,pd(this,Lm(e,n=>n!==void 0))}}class Bm extends S0{get definition(){return this._definition}set definition(e){this._definition=e}constructor(e){super(e.definition),this.idx=1,this.ignoreAmbiguities=!1,this.hasPredicates=!1,pd(this,Lm(e,n=>n!==void 0))}}class co{constructor(e){this.idx=1,pd(this,Lm(e,n=>n!==void 0))}accept(e){e.visit(this)}}function wGe(t){return Fn(t,nL)}function nL(t){function e(n){return Fn(n,nL)}if(t instanceof vd){const n={type:"NonTerminal",name:t.nonTerminalName,idx:t.idx};return md(t.label)&&(n.label=t.label),n}else{if(t instanceof _d)return{type:"Alternative",definition:e(t.definition)};if(t instanceof ud)return{type:"Option",idx:t.idx,definition:e(t.definition)};if(t instanceof T0)return{type:"RepetitionMandatory",idx:t.idx,definition:e(t.definition)};if(t instanceof x0)return{type:"RepetitionMandatoryWithSeparator",idx:t.idx,separator:nL(new co({terminalType:t.separator})),definition:e(t.definition)};if(t instanceof Um)return{type:"RepetitionWithSeparator",idx:t.idx,separator:nL(new co({terminalType:t.separator})),definition:e(t.definition)};if(t instanceof qc)return{type:"Repetition",idx:t.idx,definition:e(t.definition)};if(t instanceof Bm)return{type:"Alternation",idx:t.idx,definition:e(t.definition)};if(t instanceof co){const n={type:"Terminal",name:t.terminalType.name,label:TGe(t.terminalType),idx:t.idx};md(t.label)&&(n.terminalLabel=t.label);const i=t.terminalType.PATTERN;return t.terminalType.PATTERN&&(n.pattern=N_(i)?i.source:i),n}else{if(t instanceof fR)return{type:"Rule",name:t.name,orgText:t.orgText,definition:e(t.definition)};throw Error("non exhaustive match")}}}class Y1{visit(e){const n=e;switch(n.constructor){case vd:return this.visitNonTerminal(n);case _d:return this.visitAlternative(n);case ud:return this.visitOption(n);case T0:return this.visitRepetitionMandatory(n);case x0:return this.visitRepetitionMandatoryWithSeparator(n);case Um:return this.visitRepetitionWithSeparator(n);case qc:return this.visitRepetition(n);case Bm:return this.visitAlternation(n);case co:return this.visitTerminal(n);case fR:return this.visitRule(n);default:throw Error("non exhaustive match")}}visitNonTerminal(e){}visitAlternative(e){}visitOption(e){}visitRepetition(e){}visitRepetitionMandatory(e){}visitRepetitionMandatoryWithSeparator(e){}visitRepetitionWithSeparator(e){}visitAlternation(e){}visitTerminal(e){}visitRule(e){}}function CGe(t){return t instanceof _d||t instanceof ud||t instanceof qc||t instanceof T0||t instanceof x0||t instanceof Um||t instanceof co||t instanceof fR}function T3(t,e=[]){return t instanceof ud||t instanceof qc||t instanceof Um?!0:t instanceof Bm?_Y(t.definition,i=>T3(i,e)):t instanceof vd&&Eh(e,t)?!1:t instanceof S0?(t instanceof vd&&e.push(t),wm(t.definition,i=>T3(i,e))):!1}function AGe(t){return t instanceof Bm}function kg(t){if(t instanceof vd)return"SUBRULE";if(t instanceof ud)return"OPTION";if(t instanceof Bm)return"OR";if(t instanceof T0)return"AT_LEAST_ONE";if(t instanceof x0)return"AT_LEAST_ONE_SEP";if(t instanceof Um)return"MANY_SEP";if(t instanceof qc)return"MANY";if(t instanceof co)return"CONSUME";throw Error("non exhaustive match")}class u4{walk(e,n=[]){Ii(e.definition,(i,r)=>{const s=Vl(e.definition,r+1);if(i instanceof vd)this.walkProdRef(i,s,n);else if(i instanceof co)this.walkTerminal(i,s,n);else if(i instanceof _d)this.walkFlat(i,s,n);else if(i instanceof ud)this.walkOption(i,s,n);else if(i instanceof T0)this.walkAtLeastOne(i,s,n);else if(i instanceof x0)this.walkAtLeastOneSep(i,s,n);else if(i instanceof Um)this.walkManySep(i,s,n);else if(i instanceof qc)this.walkMany(i,s,n);else if(i instanceof Bm)this.walkOr(i,s,n);else throw Error("non exhaustive match")})}walkTerminal(e,n,i){}walkProdRef(e,n,i){}walkFlat(e,n,i){const r=n.concat(i);this.walk(e,r)}walkOption(e,n,i){const r=n.concat(i);this.walk(e,r)}walkAtLeastOne(e,n,i){const r=[new ud({definition:e.definition})].concat(n,i);this.walk(e,r)}walkAtLeastOneSep(e,n,i){const r=qne(e,n,i);this.walk(e,r)}walkMany(e,n,i){const r=[new ud({definition:e.definition})].concat(n,i);this.walk(e,r)}walkManySep(e,n,i){const r=qne(e,n,i);this.walk(e,r)}walkOr(e,n,i){const r=n.concat(i);Ii(e.definition,s=>{const a=new _d({definition:[s]});this.walk(a,r)})}}function qne(t,e,n){return[new ud({definition:[new co({terminalType:t.separator})].concat(t.definition)})].concat(e,n)}function gk(t){if(t instanceof vd)return gk(t.referencedRule);if(t instanceof co)return OGe(t);if(CGe(t))return RGe(t);if(AGe(t))return MGe(t);throw Error("non exhaustive match")}function RGe(t){let e=[];const n=t.definition;let i=0,r=n.length>i,s,a=!0;for(;r&&a;)s=n[i],a=T3(s),e=e.concat(gk(s)),i=i+1,r=n.length>i;return l4(e)}function MGe(t){const e=Fn(t.definition,n=>gk(n));return l4(ld(e))}function OGe(t){return[t.terminalType]}const wge="_~IN~_";class NGe extends u4{constructor(e){super(),this.topProd=e,this.follows={}}startWalking(){return this.walk(this.topProd),this.follows}walkTerminal(e,n,i){}walkProdRef(e,n,i){const r=kGe(e.referencedRule,e.idx)+this.topProd.name,s=n.concat(i),a=new _d({definition:s}),o=gk(a);this.follows[r]=o}}function IGe(t){const e={};return Ii(t,n=>{const i=new NGe(n).startWalking();pd(e,i)}),e}function kGe(t,e){return t.name+e+wge}function Li(t){return t.charCodeAt(0)}function uH(t,e){Array.isArray(t)?t.forEach(function(n){e.push(n)}):e.push(t)}function fM(t,e){if(t[e]===!0)throw"duplicate flag "+e;t[e],t[e]=!0}function lw(t){if(t===void 0)throw Error("Internal Error - Should never get here!");return!0}function PGe(){throw Error("Internal Error - Should never get here!")}function $ne(t){return t.type==="Character"}const x3=[];for(let t=Li("0");t<=Li("9");t++)x3.push(t);const w3=[Li("_")].concat(x3);for(let t=Li("a");t<=Li("z");t++)w3.push(t);for(let t=Li("A");t<=Li("Z");t++)w3.push(t);const Wne=[Li(" "),Li("\f"),Li(`
`),Li("\r"),Li("	"),Li("\v"),Li("	"),Li(""),Li(""),Li(""),Li(""),Li(""),Li(""),Li(""),Li(""),Li(""),Li(""),Li(""),Li(""),Li(""),Li("\u2028"),Li("\u2029"),Li(""),Li(""),Li(""),Li("\uFEFF")],DGe=/[0-9a-fA-F]/,GD=/[0-9]/,LGe=/[1-9]/;class UGe{constructor(){this.idx=0,this.input="",this.groupIdx=0}saveState(){return{idx:this.idx,input:this.input,groupIdx:this.groupIdx}}restoreState(e){this.idx=e.idx,this.input=e.input,this.groupIdx=e.groupIdx}pattern(e){this.idx=0,this.input=e,this.groupIdx=0,this.consumeChar("/");const n=this.disjunction();this.consumeChar("/");const i={type:"Flags",loc:{begin:this.idx,end:e.length},global:!1,ignoreCase:!1,multiLine:!1,unicode:!1,sticky:!1};for(;this.isRegExpFlag();)switch(this.popChar()){case"g":fM(i,"global");break;case"i":fM(i,"ignoreCase");break;case"m":fM(i,"multiLine");break;case"u":fM(i,"unicode");break;case"y":fM(i,"sticky");break}if(this.idx!==this.input.length)throw Error("Redundant input: "+this.input.substring(this.idx));return{type:"Pattern",flags:i,value:n,loc:this.loc(0)}}disjunction(){const e=[],n=this.idx;for(e.push(this.alternative());this.peekChar()==="|";)this.consumeChar("|"),e.push(this.alternative());return{type:"Disjunction",value:e,loc:this.loc(n)}}alternative(){const e=[],n=this.idx;for(;this.isTerm();)e.push(this.term());return{type:"Alternative",value:e,loc:this.loc(n)}}term(){return this.isAssertion()?this.assertion():this.atom()}assertion(){const e=this.idx;switch(this.popChar()){case"^":return{type:"StartAnchor",loc:this.loc(e)};case"$":return{type:"EndAnchor",loc:this.loc(e)};case"\\":switch(this.popChar()){case"b":return{type:"WordBoundary",loc:this.loc(e)};case"B":return{type:"NonWordBoundary",loc:this.loc(e)}}throw Error("Invalid Assertion Escape");case"(":this.consumeChar("?");let n;switch(this.popChar()){case"=":n="Lookahead";break;case"!":n="NegativeLookahead";break}lw(n);const i=this.disjunction();return this.consumeChar(")"),{type:n,value:i,loc:this.loc(e)}}return PGe()}quantifier(e=!1){let n;const i=this.idx;switch(this.popChar()){case"*":n={atLeast:0,atMost:1/0};break;case"+":n={atLeast:1,atMost:1/0};break;case"?":n={atLeast:0,atMost:1};break;case"{":const r=this.integerIncludingZero();switch(this.popChar()){case"}":n={atLeast:r,atMost:r};break;case",":let s;this.isDigit()?(s=this.integerIncludingZero(),n={atLeast:r,atMost:s}):n={atLeast:r,atMost:1/0},this.consumeChar("}");break}if(e===!0&&n===void 0)return;lw(n);break}if(!(e===!0&&n===void 0)&&lw(n))return this.peekChar(0)==="?"?(this.consumeChar("?"),n.greedy=!1):n.greedy=!0,n.type="Quantifier",n.loc=this.loc(i),n}atom(){let e;const n=this.idx;switch(this.peekChar()){case".":e=this.dotAll();break;case"\\":e=this.atomEscape();break;case"[":e=this.characterClass();break;case"(":e=this.group();break}if(e===void 0&&this.isPatternCharacter()&&(e=this.patternCharacter()),lw(e))return e.loc=this.loc(n),this.isQuantifier()&&(e.quantifier=this.quantifier()),e}dotAll(){return this.consumeChar("."),{type:"Set",complement:!0,value:[Li(`
`),Li("\r"),Li("\u2028"),Li("\u2029")]}}atomEscape(){switch(this.consumeChar("\\"),this.peekChar()){case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":return this.decimalEscapeAtom();case"d":case"D":case"s":case"S":case"w":case"W":return this.characterClassEscape();case"f":case"n":case"r":case"t":case"v":return this.controlEscapeAtom();case"c":return this.controlLetterEscapeAtom();case"0":return this.nulCharacterAtom();case"x":return this.hexEscapeSequenceAtom();case"u":return this.regExpUnicodeEscapeSequenceAtom();default:return this.identityEscapeAtom()}}decimalEscapeAtom(){return{type:"GroupBackReference",value:this.positiveInteger()}}characterClassEscape(){let e,n=!1;switch(this.popChar()){case"d":e=x3;break;case"D":e=x3,n=!0;break;case"s":e=Wne;break;case"S":e=Wne,n=!0;break;case"w":e=w3;break;case"W":e=w3,n=!0;break}if(lw(e))return{type:"Set",value:e,complement:n}}controlEscapeAtom(){let e;switch(this.popChar()){case"f":e=Li("\f");break;case"n":e=Li(`
`);break;case"r":e=Li("\r");break;case"t":e=Li("	");break;case"v":e=Li("\v");break}if(lw(e))return{type:"Character",value:e}}controlLetterEscapeAtom(){this.consumeChar("c");const e=this.popChar();if(/[a-zA-Z]/.test(e)===!1)throw Error("Invalid ");return{type:"Character",value:e.toUpperCase().charCodeAt(0)-64}}nulCharacterAtom(){return this.consumeChar("0"),{type:"Character",value:Li("\0")}}hexEscapeSequenceAtom(){return this.consumeChar("x"),this.parseHexDigits(2)}regExpUnicodeEscapeSequenceAtom(){return this.consumeChar("u"),this.parseHexDigits(4)}identityEscapeAtom(){const e=this.popChar();return{type:"Character",value:Li(e)}}classPatternCharacterAtom(){switch(this.peekChar()){case`
`:case"\r":case"\u2028":case"\u2029":case"\\":case"]":throw Error("TBD");default:const e=this.popChar();return{type:"Character",value:Li(e)}}}characterClass(){const e=[];let n=!1;for(this.consumeChar("["),this.peekChar(0)==="^"&&(this.consumeChar("^"),n=!0);this.isClassAtom();){const i=this.classAtom();if(i.type,$ne(i)&&this.isRangeDash()){this.consumeChar("-");const r=this.classAtom();if(r.type,$ne(r)){if(r.value<i.value)throw Error("Range out of order in character class");e.push({from:i.value,to:r.value})}else uH(i.value,e),e.push(Li("-")),uH(r.value,e)}else uH(i.value,e)}return this.consumeChar("]"),{type:"Set",complement:n,value:e}}classAtom(){switch(this.peekChar()){case"]":case`
`:case"\r":case"\u2028":case"\u2029":throw Error("TBD");case"\\":return this.classEscape();default:return this.classPatternCharacterAtom()}}classEscape(){switch(this.consumeChar("\\"),this.peekChar()){case"b":return this.consumeChar("b"),{type:"Character",value:Li("\b")};case"d":case"D":case"s":case"S":case"w":case"W":return this.characterClassEscape();case"f":case"n":case"r":case"t":case"v":return this.controlEscapeAtom();case"c":return this.controlLetterEscapeAtom();case"0":return this.nulCharacterAtom();case"x":return this.hexEscapeSequenceAtom();case"u":return this.regExpUnicodeEscapeSequenceAtom();default:return this.identityEscapeAtom()}}group(){let e=!0;switch(this.consumeChar("("),this.peekChar(0)){case"?":this.consumeChar("?"),this.consumeChar(":"),e=!1;break;default:this.groupIdx++;break}const n=this.disjunction();this.consumeChar(")");const i={type:"Group",capturing:e,value:n};return e&&(i.idx=this.groupIdx),i}positiveInteger(){let e=this.popChar();if(LGe.test(e)===!1)throw Error("Expecting a positive integer");for(;GD.test(this.peekChar(0));)e+=this.popChar();return parseInt(e,10)}integerIncludingZero(){let e=this.popChar();if(GD.test(e)===!1)throw Error("Expecting an integer");for(;GD.test(this.peekChar(0));)e+=this.popChar();return parseInt(e,10)}patternCharacter(){const e=this.popChar();switch(e){case`
`:case"\r":case"\u2028":case"\u2029":case"^":case"$":case"\\":case".":case"*":case"+":case"?":case"(":case")":case"[":case"|":throw Error("TBD");default:return{type:"Character",value:Li(e)}}}isRegExpFlag(){switch(this.peekChar(0)){case"g":case"i":case"m":case"u":case"y":return!0;default:return!1}}isRangeDash(){return this.peekChar()==="-"&&this.isClassAtom(1)}isDigit(){return GD.test(this.peekChar(0))}isClassAtom(e=0){switch(this.peekChar(e)){case"]":case`
`:case"\r":case"\u2028":case"\u2029":return!1;default:return!0}}isTerm(){return this.isAtom()||this.isAssertion()}isAtom(){if(this.isPatternCharacter())return!0;switch(this.peekChar(0)){case".":case"\\":case"[":case"(":return!0;default:return!1}}isAssertion(){switch(this.peekChar(0)){case"^":case"$":return!0;case"\\":switch(this.peekChar(1)){case"b":case"B":return!0;default:return!1}case"(":return this.peekChar(1)==="?"&&(this.peekChar(2)==="="||this.peekChar(2)==="!");default:return!1}}isQuantifier(){const e=this.saveState();try{return this.quantifier(!0)!==void 0}catch{return!1}finally{this.restoreState(e)}}isPatternCharacter(){switch(this.peekChar()){case"^":case"$":case"\\":case".":case"*":case"+":case"?":case"(":case")":case"[":case"|":case"/":case`
`:case"\r":case"\u2028":case"\u2029":return!1;default:return!0}}parseHexDigits(e){let n="";for(let r=0;r<e;r++){const s=this.popChar();if(DGe.test(s)===!1)throw Error("Expecting a HexDecimal digits");n+=s}return{type:"Character",value:parseInt(n,16)}}peekChar(e=0){return this.input[this.idx+e]}popChar(){const e=this.peekChar(0);return this.consumeChar(void 0),e}consumeChar(e){if(e!==void 0&&this.input[this.idx]!==e)throw Error("Expected: '"+e+"' but found: '"+this.input[this.idx]+"' at offset: "+this.idx);if(this.idx>=this.input.length)throw Error("Unexpected end of input");this.idx++}loc(e){return{begin:e,end:this.idx}}}class yY{visitChildren(e){for(const n in e){const i=e[n];e.hasOwnProperty(n)&&(i.type!==void 0?this.visit(i):Array.isArray(i)&&i.forEach(r=>{this.visit(r)},this))}}visit(e){switch(e.type){case"Pattern":this.visitPattern(e);break;case"Flags":this.visitFlags(e);break;case"Disjunction":this.visitDisjunction(e);break;case"Alternative":this.visitAlternative(e);break;case"StartAnchor":this.visitStartAnchor(e);break;case"EndAnchor":this.visitEndAnchor(e);break;case"WordBoundary":this.visitWordBoundary(e);break;case"NonWordBoundary":this.visitNonWordBoundary(e);break;case"Lookahead":this.visitLookahead(e);break;case"NegativeLookahead":this.visitNegativeLookahead(e);break;case"Character":this.visitCharacter(e);break;case"Set":this.visitSet(e);break;case"Group":this.visitGroup(e);break;case"GroupBackReference":this.visitGroupBackReference(e);break;case"Quantifier":this.visitQuantifier(e);break}this.visitChildren(e)}visitPattern(e){}visitFlags(e){}visitDisjunction(e){}visitAlternative(e){}visitStartAnchor(e){}visitEndAnchor(e){}visitWordBoundary(e){}visitNonWordBoundary(e){}visitLookahead(e){}visitNegativeLookahead(e){}visitCharacter(e){}visitSet(e){}visitGroup(e){}visitGroupBackReference(e){}visitQuantifier(e){}}let iL={};const BGe=new UGe;function h4(t){const e=t.toString();if(iL.hasOwnProperty(e))return iL[e];{const n=BGe.pattern(e);return iL[e]=n,n}}function FGe(){iL={}}const Cge="Complement Sets are not supported for first char optimization",C3=`Unable to use "first char" lexer optimizations:
`;function zGe(t,e=!1){try{const n=h4(t);return Bq(n.value,{},n.flags.ignoreCase)}catch(n){if(n.message===Cge)e&&Sge(`${C3}	Unable to optimize: < ${t.toString()} >
	Complement Sets cannot be automatically optimized.
	This will disable the lexer's first char optimizations.
	See: https://chevrotain.io/docs/guide/resolving_lexer_errors.html#COMPLEMENT for details.`);else{let i="";e&&(i=`
	This will disable the lexer's first char optimizations.
	See: https://chevrotain.io/docs/guide/resolving_lexer_errors.html#REGEXP_PARSING for details.`),Uq(`${C3}
	Failed parsing: < ${t.toString()} >
	Using the @chevrotain/regexp-to-ast library
	Please open an issue at: https://github.com/chevrotain/chevrotain/issues`+i)}}return[]}function Bq(t,e,n){switch(t.type){case"Disjunction":for(let r=0;r<t.value.length;r++)Bq(t.value[r],e,n);break;case"Alternative":const i=t.value;for(let r=0;r<i.length;r++){const s=i[r];switch(s.type){case"EndAnchor":case"GroupBackReference":case"Lookahead":case"NegativeLookahead":case"StartAnchor":case"WordBoundary":case"NonWordBoundary":continue}const a=s;switch(a.type){case"Character":qD(a.value,e,n);break;case"Set":if(a.complement===!0)throw Error(Cge);Ii(a.value,c=>{if(typeof c=="number")qD(c,e,n);else{const l=c;if(n===!0)for(let u=l.from;u<=l.to;u++)qD(u,e,n);else{for(let u=l.from;u<=l.to&&u<HM;u++)qD(u,e,n);if(l.to>=HM){const u=l.from>=HM?l.from:HM,h=l.to,d=oE(u),f=oE(h);for(let p=d;p<=f;p++)e[p]=p}}}});break;case"Group":Bq(a.value,e,n);break;default:throw Error("Non Exhaustive Match")}const o=a.quantifier!==void 0&&a.quantifier.atLeast===0;if(a.type==="Group"&&Fq(a)===!1||a.type!=="Group"&&o===!1)break}break;default:throw Error("non exhaustive match!")}return _c(e)}function qD(t,e,n){const i=oE(t);e[i]=i,n===!0&&jGe(t,e)}function jGe(t,e){const n=String.fromCharCode(t),i=n.toUpperCase();if(i!==n){const r=oE(i.charCodeAt(0));e[r]=r}else{const r=n.toLowerCase();if(r!==n){const s=oE(r.charCodeAt(0));e[s]=s}}}function Yne(t,e){return dA(t.value,n=>{if(typeof n=="number")return Eh(e,n);{const i=n;return dA(e,r=>i.from<=r&&r<=i.to)!==void 0}})}function Fq(t){const e=t.quantifier;return e&&e.atLeast===0?!0:t.value?Yr(t.value)?wm(t.value,Fq):Fq(t.value):!1}class HGe extends yY{constructor(e){super(),this.targetCharCodes=e,this.found=!1}visitChildren(e){if(this.found!==!0){switch(e.type){case"Lookahead":this.visitLookahead(e);return;case"NegativeLookahead":this.visitNegativeLookahead(e);return}super.visitChildren(e)}}visitCharacter(e){Eh(this.targetCharCodes,e.value)&&(this.found=!0)}visitSet(e){e.complement?Yne(e,this.targetCharCodes)===void 0&&(this.found=!0):Yne(e,this.targetCharCodes)!==void 0&&(this.found=!0)}}function bY(t,e){if(e instanceof RegExp){const n=h4(e),i=new HGe(t);return i.visit(n),i.found}else return dA(e,n=>Eh(t,n.charCodeAt(0)))!==void 0}const h1="PATTERN",jM="defaultMode",$D="modes";let Age=typeof new RegExp("(?:)").sticky=="boolean";function VGe(t,e){e=vY(e,{useSticky:Age,debug:!1,safeMode:!1,positionTracking:"full",lineTerminatorCharacters:["\r",`
`],tracer:(b,S)=>S()});const n=e.tracer;n("initCharCodeToOptimizedIndexMap",()=>{dqe()});let i;n("Reject Lexer.NA",()=>{i=c4(t,b=>b[h1]===Kc.NA)});let r=!1,s;n("Transform Patterns",()=>{r=!1,s=Fn(i,b=>{const S=b[h1];if(N_(S)){const x=S.source;return x.length===1&&x!=="^"&&x!=="$"&&x!=="."&&!S.ignoreCase?x:x.length===2&&x[0]==="\\"&&!Eh(["d","D","s","S","t","r","n","t","0","c","b","B","f","v","w","W"],x[1])?x[1]:e.useSticky?Xne(S):Kne(S)}else{if(H_(S))return r=!0,{exec:S};if(typeof S=="object")return r=!0,S;if(typeof S=="string"){if(S.length===1)return S;{const x=S.replace(/[\\^$.*+?()[\]{}|]/g,"\\$&"),M=new RegExp(x);return e.useSticky?Xne(M):Kne(M)}}else throw Error("non exhaustive match")}})});let a,o,c,l,u;n("misc mapping",()=>{a=Fn(i,b=>b.tokenTypeIdx),o=Fn(i,b=>{const S=b.GROUP;if(S!==Kc.SKIPPED){if(md(S))return S;if(I_(S))return!1;throw Error("non exhaustive match")}}),c=Fn(i,b=>{const S=b.LONGER_ALT;if(S)return Yr(S)?Fn(S,M=>Vne(i,M)):[Vne(i,S)]}),l=Fn(i,b=>b.PUSH_MODE),u=Fn(i,b=>xi(b,"POP_MODE"))});let h;n("Line Terminator Handling",()=>{const b=Oge(e.lineTerminatorCharacters);h=Fn(i,S=>!1),e.positionTracking!=="onlyOffset"&&(h=Fn(i,S=>xi(S,"LINE_BREAKS")?!!S.LINE_BREAKS:Mge(S,b)===!1&&bY(b,S.PATTERN)))});let d,f,p,g;n("Misc Mapping #2",()=>{d=Fn(i,Rge),f=Fn(s,lqe),p=gd(i,(b,S)=>{const x=S.GROUP;return md(x)&&x!==Kc.SKIPPED&&(b[x]=[]),b},{}),g=Fn(s,(b,S)=>({pattern:s[S],longerAlt:c[S],canLineTerminator:h[S],isCustom:d[S],short:f[S],group:o[S],push:l[S],pop:u[S],tokenTypeIdx:a[S],tokenType:i[S]}))});let _=!0,v=[];return e.safeMode||n("First Char Optimization",()=>{v=gd(i,(b,S,x)=>{if(typeof S.PATTERN=="string"){const M=S.PATTERN.charCodeAt(0),R=oE(M);hH(b,R,g[x])}else if(Yr(S.START_CHARS_HINT)){let M;Ii(S.START_CHARS_HINT,R=>{const I=typeof R=="string"?R.charCodeAt(0):R,k=oE(I);M!==k&&(M=k,hH(b,k,g[x]))})}else if(N_(S.PATTERN))if(S.PATTERN.unicode)_=!1,e.ensureOptimizations&&Uq(`${C3}	Unable to analyze < ${S.PATTERN.toString()} > pattern.
	The regexp unicode flag is not currently supported by the regexp-to-ast library.
	This will disable the lexer's first char optimizations.
	For details See: https://chevrotain.io/docs/guide/resolving_lexer_errors.html#UNICODE_OPTIMIZE`);else{const M=zGe(S.PATTERN,e.ensureOptimizations);ha(M)&&(_=!1),Ii(M,R=>{hH(b,R,g[x])})}else e.ensureOptimizations&&Uq(`${C3}	TokenType: <${S.name}> is using a custom token pattern without providing <start_chars_hint> parameter.
	This will disable the lexer's first char optimizations.
	For details See: https://chevrotain.io/docs/guide/resolving_lexer_errors.html#CUSTOM_OPTIMIZE`),_=!1;return b},[])}),{emptyGroups:p,patternIdxToConfig:g,charCodeToPatternIdxToConfig:v,hasCustom:r,canBeOptimized:_}}function GGe(t,e){let n=[];const i=$Ge(t);n=n.concat(i.errors);const r=WGe(i.valid),s=r.valid;return n=n.concat(r.errors),n=n.concat(qGe(s)),n=n.concat(tqe(s)),n=n.concat(nqe(s,e)),n=n.concat(iqe(s)),n}function qGe(t){let e=[];const n=Ip(t,i=>N_(i[h1]));return e=e.concat(KGe(n)),e=e.concat(JGe(n)),e=e.concat(QGe(n)),e=e.concat(eqe(n)),e=e.concat(XGe(n)),e}function $Ge(t){const e=Ip(t,r=>!xi(r,h1)),n=Fn(e,r=>({message:"Token Type: ->"+r.name+"<- missing static 'PATTERN' property",type:No.MISSING_PATTERN,tokenTypes:[r]})),i=o4(t,e);return{errors:n,valid:i}}function WGe(t){const e=Ip(t,r=>{const s=r[h1];return!N_(s)&&!H_(s)&&!xi(s,"exec")&&!md(s)}),n=Fn(e,r=>({message:"Token Type: ->"+r.name+"<- static 'PATTERN' can only be a RegExp, a Function matching the {CustomPatternMatcherFunc} type or an Object matching the {ICustomPattern} interface.",type:No.INVALID_PATTERN,tokenTypes:[r]})),i=o4(t,e);return{errors:n,valid:i}}const YGe=/[^\\][$]/;function KGe(t){class e extends yY{constructor(){super(...arguments),this.found=!1}visitEndAnchor(s){this.found=!0}}const n=Ip(t,r=>{const s=r.PATTERN;try{const a=h4(s),o=new e;return o.visit(a),o.found}catch{return YGe.test(s.source)}});return Fn(n,r=>({message:`Unexpected RegExp Anchor Error:
	Token Type: ->`+r.name+`<- static 'PATTERN' cannot contain end of input anchor '$'
	See chevrotain.io/docs/guide/resolving_lexer_errors.html#ANCHORS	for details.`,type:No.EOI_ANCHOR_FOUND,tokenTypes:[r]}))}function XGe(t){const e=Ip(t,i=>i.PATTERN.test(""));return Fn(e,i=>({message:"Token Type: ->"+i.name+"<- static 'PATTERN' must not match an empty string",type:No.EMPTY_MATCH_PATTERN,tokenTypes:[i]}))}const ZGe=/[^\\[][\^]|^\^/;function JGe(t){class e extends yY{constructor(){super(...arguments),this.found=!1}visitStartAnchor(s){this.found=!0}}const n=Ip(t,r=>{const s=r.PATTERN;try{const a=h4(s),o=new e;return o.visit(a),o.found}catch{return ZGe.test(s.source)}});return Fn(n,r=>({message:`Unexpected RegExp Anchor Error:
	Token Type: ->`+r.name+`<- static 'PATTERN' cannot contain start of input anchor '^'
	See https://chevrotain.io/docs/guide/resolving_lexer_errors.html#ANCHORS	for details.`,type:No.SOI_ANCHOR_FOUND,tokenTypes:[r]}))}function QGe(t){const e=Ip(t,i=>{const r=i[h1];return r instanceof RegExp&&(r.multiline||r.global)});return Fn(e,i=>({message:"Token Type: ->"+i.name+"<- static 'PATTERN' may NOT contain global('g') or multiline('m')",type:No.UNSUPPORTED_FLAGS_FOUND,tokenTypes:[i]}))}function eqe(t){const e=[];let n=Fn(t,s=>gd(t,(a,o)=>(s.PATTERN.source===o.PATTERN.source&&!Eh(e,o)&&o.PATTERN!==Kc.NA&&(e.push(o),a.push(o)),a),[]));n=mk(n);const i=Ip(n,s=>s.length>1);return Fn(i,s=>{const a=Fn(s,c=>c.name);return{message:`The same RegExp pattern ->${Rm(s).PATTERN}<-has been used in all of the following Token Types: ${a.join(", ")} <-`,type:No.DUPLICATE_PATTERNS_FOUND,tokenTypes:s}})}function tqe(t){const e=Ip(t,i=>{if(!xi(i,"GROUP"))return!1;const r=i.GROUP;return r!==Kc.SKIPPED&&r!==Kc.NA&&!md(r)});return Fn(e,i=>({message:"Token Type: ->"+i.name+"<- static 'GROUP' can only be Lexer.SKIPPED/Lexer.NA/A String",type:No.INVALID_GROUP_TYPE_FOUND,tokenTypes:[i]}))}function nqe(t,e){const n=Ip(t,r=>r.PUSH_MODE!==void 0&&!Eh(e,r.PUSH_MODE));return Fn(n,r=>({message:`Token Type: ->${r.name}<- static 'PUSH_MODE' value cannot refer to a Lexer Mode ->${r.PUSH_MODE}<-which does not exist`,type:No.PUSH_MODE_DOES_NOT_EXIST,tokenTypes:[r]}))}function iqe(t){const e=[],n=gd(t,(i,r,s)=>{const a=r.PATTERN;return a===Kc.NA||(md(a)?i.push({str:a,idx:s,tokenType:r}):N_(a)&&sqe(a)&&i.push({str:a.source,idx:s,tokenType:r})),i},[]);return Ii(t,(i,r)=>{Ii(n,({str:s,idx:a,tokenType:o})=>{if(r<a&&rqe(s,i.PATTERN)){const c=`Token: ->${o.name}<- can never be matched.
Because it appears AFTER the Token Type ->${i.name}<-in the lexer's definition.
See https://chevrotain.io/docs/guide/resolving_lexer_errors.html#UNREACHABLE`;e.push({message:c,type:No.UNREACHABLE_PATTERN,tokenTypes:[i,o]})}})}),e}function rqe(t,e){if(N_(e)){const n=e.exec(t);return n!==null&&n.index===0}else{if(H_(e))return e(t,0,[],{});if(xi(e,"exec"))return e.exec(t,0,[],{});if(typeof e=="string")return e===t;throw Error("non exhaustive match")}}function sqe(t){return dA([".","\\","[","]","|","^","$","(",")","?","*","+","{"],n=>t.source.indexOf(n)!==-1)===void 0}function Kne(t){const e=t.ignoreCase?"i":"";return new RegExp(`^(?:${t.source})`,e)}function Xne(t){const e=t.ignoreCase?"iy":"y";return new RegExp(`${t.source}`,e)}function aqe(t,e,n){const i=[];return xi(t,jM)||i.push({message:"A MultiMode Lexer cannot be initialized without a <"+jM+`> property in its definition
`,type:No.MULTI_MODE_LEXER_WITHOUT_DEFAULT_MODE}),xi(t,$D)||i.push({message:"A MultiMode Lexer cannot be initialized without a <"+$D+`> property in its definition
`,type:No.MULTI_MODE_LEXER_WITHOUT_MODES_PROPERTY}),xi(t,$D)&&xi(t,jM)&&!xi(t.modes,t.defaultMode)&&i.push({message:`A MultiMode Lexer cannot be initialized with a ${jM}: <${t.defaultMode}>which does not exist
`,type:No.MULTI_MODE_LEXER_DEFAULT_MODE_VALUE_DOES_NOT_EXIST}),xi(t,$D)&&Ii(t.modes,(r,s)=>{Ii(r,(a,o)=>{if(I_(a))i.push({message:`A Lexer cannot be initialized using an undefined Token Type. Mode:<${s}> at index: <${o}>
`,type:No.LEXER_DEFINITION_CANNOT_CONTAIN_UNDEFINED});else if(xi(a,"LONGER_ALT")){const c=Yr(a.LONGER_ALT)?a.LONGER_ALT:[a.LONGER_ALT];Ii(c,l=>{!I_(l)&&!Eh(r,l)&&i.push({message:`A MultiMode Lexer cannot be initialized with a longer_alt <${l.name}> on token <${a.name}> outside of mode <${s}>
`,type:No.MULTI_MODE_LEXER_LONGER_ALT_NOT_IN_CURRENT_MODE})})}})}),i}function oqe(t,e,n){const i=[];let r=!1;const s=mk(ld(_c(t.modes))),a=c4(s,c=>c[h1]===Kc.NA),o=Oge(n);return e&&Ii(a,c=>{const l=Mge(c,o);if(l!==!1){const h={message:hqe(c,l),type:l.issue,tokenType:c};i.push(h)}else xi(c,"LINE_BREAKS")?c.LINE_BREAKS===!0&&(r=!0):bY(o,c.PATTERN)&&(r=!0)}),e&&!r&&i.push({message:`Warning: No LINE_BREAKS Found.
	This Lexer has been defined to track line and column information,
	But none of the Token Types can be identified as matching a line terminator.
	See https://chevrotain.io/docs/guide/resolving_lexer_errors.html#LINE_BREAKS 
	for details.`,type:No.NO_LINE_BREAKS_FLAGS}),i}function cqe(t){const e={},n=Cp(t);return Ii(n,i=>{const r=t[i];if(Yr(r))e[i]=[];else throw Error("non exhaustive match")}),e}function Rge(t){const e=t.PATTERN;if(N_(e))return!1;if(H_(e))return!0;if(xi(e,"exec"))return!0;if(md(e))return!1;throw Error("non exhaustive match")}function lqe(t){return md(t)&&t.length===1?t.charCodeAt(0):!1}const uqe={test:function(t){const e=t.length;for(let n=this.lastIndex;n<e;n++){const i=t.charCodeAt(n);if(i===10)return this.lastIndex=n+1,!0;if(i===13)return t.charCodeAt(n+1)===10?this.lastIndex=n+2:this.lastIndex=n+1,!0}return!1},lastIndex:0};function Mge(t,e){if(xi(t,"LINE_BREAKS"))return!1;if(N_(t.PATTERN)){try{bY(e,t.PATTERN)}catch(n){return{issue:No.IDENTIFY_TERMINATOR,errMsg:n.message}}return!1}else{if(md(t.PATTERN))return!1;if(Rge(t))return{issue:No.CUSTOM_LINE_BREAK};throw Error("non exhaustive match")}}function hqe(t,e){if(e.issue===No.IDENTIFY_TERMINATOR)return`Warning: unable to identify line terminator usage in pattern.
	The problem is in the <${t.name}> Token Type
	 Root cause: ${e.errMsg}.
	For details See: https://chevrotain.io/docs/guide/resolving_lexer_errors.html#IDENTIFY_TERMINATOR`;if(e.issue===No.CUSTOM_LINE_BREAK)return`Warning: A Custom Token Pattern should specify the <line_breaks> option.
	The problem is in the <${t.name}> Token Type
	For details See: https://chevrotain.io/docs/guide/resolving_lexer_errors.html#CUSTOM_LINE_BREAK`;throw Error("non exhaustive match")}function Oge(t){return Fn(t,n=>md(n)?n.charCodeAt(0):n)}function hH(t,e,n){t[e]===void 0?t[e]=[n]:t[e].push(n)}const HM=256;let rL=[];function oE(t){return t<HM?t:rL[t]}function dqe(){if(ha(rL)){rL=new Array(65536);for(let t=0;t<65536;t++)rL[t]=t>255?255+~~(t/255):t}}function vk(t,e){const n=t.tokenTypeIdx;return n===e.tokenTypeIdx?!0:e.isParent===!0&&e.categoryMatchesMap[n]===!0}function A3(t,e){return t.tokenTypeIdx===e.tokenTypeIdx}let Zne=1;const Nge={};function _k(t){const e=fqe(t);pqe(e),gqe(e),mqe(e),Ii(e,n=>{n.isParent=n.categoryMatches.length>0})}function fqe(t){let e=Zl(t),n=t,i=!0;for(;i;){n=mk(ld(Fn(n,s=>s.CATEGORIES)));const r=o4(n,e);e=e.concat(r),ha(r)?i=!1:n=r}return e}function pqe(t){Ii(t,e=>{kge(e)||(Nge[Zne]=e,e.tokenTypeIdx=Zne++),Jne(e)&&!Yr(e.CATEGORIES)&&(e.CATEGORIES=[e.CATEGORIES]),Jne(e)||(e.CATEGORIES=[]),vqe(e)||(e.categoryMatches=[]),_qe(e)||(e.categoryMatchesMap={})})}function mqe(t){Ii(t,e=>{e.categoryMatches=[],Ii(e.categoryMatchesMap,(n,i)=>{e.categoryMatches.push(Nge[i].tokenTypeIdx)})})}function gqe(t){Ii(t,e=>{Ige([],e)})}function Ige(t,e){Ii(t,n=>{e.categoryMatchesMap[n.tokenTypeIdx]=!0}),Ii(e.CATEGORIES,n=>{const i=t.concat(e);Eh(i,n)||Ige(i,n)})}function kge(t){return xi(t,"tokenTypeIdx")}function Jne(t){return xi(t,"CATEGORIES")}function vqe(t){return xi(t,"categoryMatches")}function _qe(t){return xi(t,"categoryMatchesMap")}function yqe(t){return xi(t,"tokenTypeIdx")}const bqe={buildUnableToPopLexerModeMessage(t){return`Unable to pop Lexer Mode after encountering Token ->${t.image}<- The Mode Stack is empty`},buildUnexpectedCharactersMessage(t,e,n,i,r){return`unexpected character: ->${t.charAt(e)}<- at offset: ${e}, skipped ${n} characters.`}};var No;(function(t){t[t.MISSING_PATTERN=0]="MISSING_PATTERN",t[t.INVALID_PATTERN=1]="INVALID_PATTERN",t[t.EOI_ANCHOR_FOUND=2]="EOI_ANCHOR_FOUND",t[t.UNSUPPORTED_FLAGS_FOUND=3]="UNSUPPORTED_FLAGS_FOUND",t[t.DUPLICATE_PATTERNS_FOUND=4]="DUPLICATE_PATTERNS_FOUND",t[t.INVALID_GROUP_TYPE_FOUND=5]="INVALID_GROUP_TYPE_FOUND",t[t.PUSH_MODE_DOES_NOT_EXIST=6]="PUSH_MODE_DOES_NOT_EXIST",t[t.MULTI_MODE_LEXER_WITHOUT_DEFAULT_MODE=7]="MULTI_MODE_LEXER_WITHOUT_DEFAULT_MODE",t[t.MULTI_MODE_LEXER_WITHOUT_MODES_PROPERTY=8]="MULTI_MODE_LEXER_WITHOUT_MODES_PROPERTY",t[t.MULTI_MODE_LEXER_DEFAULT_MODE_VALUE_DOES_NOT_EXIST=9]="MULTI_MODE_LEXER_DEFAULT_MODE_VALUE_DOES_NOT_EXIST",t[t.LEXER_DEFINITION_CANNOT_CONTAIN_UNDEFINED=10]="LEXER_DEFINITION_CANNOT_CONTAIN_UNDEFINED",t[t.SOI_ANCHOR_FOUND=11]="SOI_ANCHOR_FOUND",t[t.EMPTY_MATCH_PATTERN=12]="EMPTY_MATCH_PATTERN",t[t.NO_LINE_BREAKS_FLAGS=13]="NO_LINE_BREAKS_FLAGS",t[t.UNREACHABLE_PATTERN=14]="UNREACHABLE_PATTERN",t[t.IDENTIFY_TERMINATOR=15]="IDENTIFY_TERMINATOR",t[t.CUSTOM_LINE_BREAK=16]="CUSTOM_LINE_BREAK",t[t.MULTI_MODE_LEXER_LONGER_ALT_NOT_IN_CURRENT_MODE=17]="MULTI_MODE_LEXER_LONGER_ALT_NOT_IN_CURRENT_MODE"})(No||(No={}));const VM={deferDefinitionErrorsHandling:!1,positionTracking:"full",lineTerminatorsPattern:/\n|\r\n?/g,lineTerminatorCharacters:[`
`,"\r"],ensureOptimizations:!1,safeMode:!1,errorMessageProvider:bqe,traceInitPerf:!1,skipValidations:!1,recoveryEnabled:!0};Object.freeze(VM);let Kc=class{constructor(e,n=VM){if(this.lexerDefinition=e,this.lexerDefinitionErrors=[],this.lexerDefinitionWarning=[],this.patternIdxToConfig={},this.charCodeToPatternIdxToConfig={},this.modes=[],this.emptyGroups={},this.trackStartLines=!0,this.trackEndLines=!0,this.hasCustom=!1,this.canModeBeOptimized={},this.TRACE_INIT=(r,s)=>{if(this.traceInitPerf===!0){this.traceInitIndent++;const a=new Array(this.traceInitIndent+1).join("	");this.traceInitIndent<this.traceInitMaxIdent&&console.log(`${a}--> <${r}>`);const{time:o,value:c}=Tge(s),l=o>10?console.warn:console.log;return this.traceInitIndent<this.traceInitMaxIdent&&l(`${a}<-- <${r}> time: ${o}ms`),this.traceInitIndent--,c}else return s()},typeof n=="boolean")throw Error(`The second argument to the Lexer constructor is now an ILexerConfig Object.
a boolean 2nd argument is no longer supported`);this.config=pd({},VM,n);const i=this.config.traceInitPerf;i===!0?(this.traceInitMaxIdent=1/0,this.traceInitPerf=!0):typeof i=="number"&&(this.traceInitMaxIdent=i,this.traceInitPerf=!0),this.traceInitIndent=-1,this.TRACE_INIT("Lexer Constructor",()=>{let r,s=!0;this.TRACE_INIT("Lexer Config handling",()=>{if(this.config.lineTerminatorsPattern===VM.lineTerminatorsPattern)this.config.lineTerminatorsPattern=uqe;else if(this.config.lineTerminatorCharacters===VM.lineTerminatorCharacters)throw Error(`Error: Missing <lineTerminatorCharacters> property on the Lexer config.
	For details See: https://chevrotain.io/docs/guide/resolving_lexer_errors.html#MISSING_LINE_TERM_CHARS`);if(n.safeMode&&n.ensureOptimizations)throw Error('"safeMode" and "ensureOptimizations" flags are mutually exclusive.');this.trackStartLines=/full|onlyStart/i.test(this.config.positionTracking),this.trackEndLines=/full/i.test(this.config.positionTracking),Yr(e)?r={modes:{defaultMode:Zl(e)},defaultMode:jM}:(s=!1,r=Zl(e))}),this.config.skipValidations===!1&&(this.TRACE_INIT("performRuntimeChecks",()=>{this.lexerDefinitionErrors=this.lexerDefinitionErrors.concat(aqe(r,this.trackStartLines,this.config.lineTerminatorCharacters))}),this.TRACE_INIT("performWarningRuntimeChecks",()=>{this.lexerDefinitionWarning=this.lexerDefinitionWarning.concat(oqe(r,this.trackStartLines,this.config.lineTerminatorCharacters))})),r.modes=r.modes?r.modes:{},Ii(r.modes,(o,c)=>{r.modes[c]=c4(o,l=>I_(l))});const a=Cp(r.modes);if(Ii(r.modes,(o,c)=>{this.TRACE_INIT(`Mode: <${c}> processing`,()=>{if(this.modes.push(c),this.config.skipValidations===!1&&this.TRACE_INIT("validatePatterns",()=>{this.lexerDefinitionErrors=this.lexerDefinitionErrors.concat(GGe(o,a))}),ha(this.lexerDefinitionErrors)){_k(o);let l;this.TRACE_INIT("analyzeTokenTypes",()=>{l=VGe(o,{lineTerminatorCharacters:this.config.lineTerminatorCharacters,positionTracking:n.positionTracking,ensureOptimizations:n.ensureOptimizations,safeMode:n.safeMode,tracer:this.TRACE_INIT})}),this.patternIdxToConfig[c]=l.patternIdxToConfig,this.charCodeToPatternIdxToConfig[c]=l.charCodeToPatternIdxToConfig,this.emptyGroups=pd({},this.emptyGroups,l.emptyGroups),this.hasCustom=l.hasCustom||this.hasCustom,this.canModeBeOptimized[c]=l.canBeOptimized}})}),this.defaultMode=r.defaultMode,!ha(this.lexerDefinitionErrors)&&!this.config.deferDefinitionErrorsHandling){const c=Fn(this.lexerDefinitionErrors,l=>l.message).join(`-----------------------
`);throw new Error(`Errors detected in definition of Lexer:
`+c)}Ii(this.lexerDefinitionWarning,o=>{Sge(o.message)}),this.TRACE_INIT("Choosing sub-methods implementations",()=>{if(Age?(this.chopInput=lA,this.match=this.matchWithTest):(this.updateLastIndex=Bc,this.match=this.matchWithExec),s&&(this.handleModes=Bc),this.trackStartLines===!1&&(this.computeNewColumn=lA),this.trackEndLines===!1&&(this.updateTokenEndLineColumnLocation=Bc),/full/i.test(this.config.positionTracking))this.createTokenInstance=this.createFullToken;else if(/onlyStart/i.test(this.config.positionTracking))this.createTokenInstance=this.createStartOnlyToken;else if(/onlyOffset/i.test(this.config.positionTracking))this.createTokenInstance=this.createOffsetOnlyToken;else throw Error(`Invalid <positionTracking> config option: "${this.config.positionTracking}"`);this.hasCustom?(this.addToken=this.addTokenUsingPush,this.handlePayload=this.handlePayloadWithCustom):(this.addToken=this.addTokenUsingMemberAccess,this.handlePayload=this.handlePayloadNoCustom)}),this.TRACE_INIT("Failed Optimization Warnings",()=>{const o=gd(this.canModeBeOptimized,(c,l,u)=>(l===!1&&c.push(u),c),[]);if(n.ensureOptimizations&&!ha(o))throw Error(`Lexer Modes: < ${o.join(", ")} > cannot be optimized.
	 Disable the "ensureOptimizations" lexer config flag to silently ignore this and run the lexer in an un-optimized mode.
	 Or inspect the console log for details on how to resolve these issues.`)}),this.TRACE_INIT("clearRegExpParserCache",()=>{FGe()}),this.TRACE_INIT("toFastProperties",()=>{xge(this)})})}tokenize(e,n=this.defaultMode){if(!ha(this.lexerDefinitionErrors)){const r=Fn(this.lexerDefinitionErrors,s=>s.message).join(`-----------------------
`);throw new Error(`Unable to Tokenize because Errors detected in definition of Lexer:
`+r)}return this.tokenizeInternal(e,n)}tokenizeInternal(e,n){let i,r,s,a,o,c,l,u,h,d,f,p,g,_,v;const b=e,S=b.length;let x=0,M=0;const R=this.hasCustom?0:Math.floor(e.length/10),I=new Array(R),k=[];let P=this.trackStartLines?1:void 0,U=this.trackStartLines?1:void 0;const V=cqe(this.emptyGroups),$=this.trackStartLines,q=this.config.lineTerminatorsPattern;let Y=0,te=[],G=[];const J=[],K=[];Object.freeze(K);let X;function ae(){return te}function ce(ge){const _e=oE(ge),ke=G[_e];return ke===void 0?K:ke}const Me=ge=>{if(J.length===1&&ge.tokenType.PUSH_MODE===void 0){const _e=this.config.errorMessageProvider.buildUnableToPopLexerModeMessage(ge);k.push({offset:ge.startOffset,line:ge.startLine,column:ge.startColumn,length:ge.image.length,message:_e})}else{J.pop();const _e=hA(J);te=this.patternIdxToConfig[_e],G=this.charCodeToPatternIdxToConfig[_e],Y=te.length;const ke=this.canModeBeOptimized[_e]&&this.config.safeMode===!1;G&&ke?X=ce:X=ae}};function Fe(ge){J.push(ge),G=this.charCodeToPatternIdxToConfig[ge],te=this.patternIdxToConfig[ge],Y=te.length,Y=te.length;const _e=this.canModeBeOptimized[ge]&&this.config.safeMode===!1;G&&_e?X=ce:X=ae}Fe.call(this,n);let Te;const Re=this.config.recoveryEnabled;for(;x<S;){c=null;const ge=b.charCodeAt(x),_e=X(ge),ke=_e.length;for(i=0;i<ke;i++){Te=_e[i];const gt=Te.pattern;l=null;const wt=Te.short;if(wt!==!1?ge===wt&&(c=gt):Te.isCustom===!0?(v=gt.exec(b,x,I,V),v!==null?(c=v[0],v.payload!==void 0&&(l=v.payload)):c=null):(this.updateLastIndex(gt,x),c=this.match(gt,e,x)),c!==null){if(o=Te.longerAlt,o!==void 0){const ye=o.length;for(s=0;s<ye;s++){const Se=te[o[s]],Qe=Se.pattern;if(u=null,Se.isCustom===!0?(v=Qe.exec(b,x,I,V),v!==null?(a=v[0],v.payload!==void 0&&(u=v.payload)):a=null):(this.updateLastIndex(Qe,x),a=this.match(Qe,e,x)),a&&a.length>c.length){c=a,l=u,Te=Se;break}}}break}}if(c!==null){if(h=c.length,d=Te.group,d!==void 0&&(f=Te.tokenTypeIdx,p=this.createTokenInstance(c,x,f,Te.tokenType,P,U,h),this.handlePayload(p,l),d===!1?M=this.addToken(I,M,p):V[d].push(p)),e=this.chopInput(e,h),x=x+h,U=this.computeNewColumn(U,h),$===!0&&Te.canLineTerminator===!0){let gt=0,wt,ye;q.lastIndex=0;do wt=q.test(c),wt===!0&&(ye=q.lastIndex-1,gt++);while(wt===!0);gt!==0&&(P=P+gt,U=h-ye,this.updateTokenEndLineColumnLocation(p,d,ye,gt,P,U,h))}this.handleModes(Te,Me,Fe,p)}else{const gt=x,wt=P,ye=U;let Se=Re===!1;for(;Se===!1&&x<S;)for(e=this.chopInput(e,1),x++,r=0;r<Y;r++){const Qe=te[r],pe=Qe.pattern,ze=Qe.short;if(ze!==!1?b.charCodeAt(x)===ze&&(Se=!0):Qe.isCustom===!0?Se=pe.exec(b,x,I,V)!==null:(this.updateLastIndex(pe,x),Se=pe.exec(e)!==null),Se===!0)break}if(g=x-gt,U=this.computeNewColumn(U,g),_=this.config.errorMessageProvider.buildUnexpectedCharactersMessage(b,gt,g,wt,ye),k.push({offset:gt,line:wt,column:ye,length:g,message:_}),Re===!1)break}}return this.hasCustom||(I.length=M),{tokens:I,groups:V,errors:k}}handleModes(e,n,i,r){if(e.pop===!0){const s=e.push;n(r),s!==void 0&&i.call(this,s)}else e.push!==void 0&&i.call(this,e.push)}chopInput(e,n){return e.substring(n)}updateLastIndex(e,n){e.lastIndex=n}updateTokenEndLineColumnLocation(e,n,i,r,s,a,o){let c,l;n!==void 0&&(c=i===o-1,l=c?-1:0,r===1&&c===!0||(e.endLine=s+l,e.endColumn=a-1+-l))}computeNewColumn(e,n){return e+n}createOffsetOnlyToken(e,n,i,r){return{image:e,startOffset:n,tokenTypeIdx:i,tokenType:r}}createStartOnlyToken(e,n,i,r,s,a){return{image:e,startOffset:n,startLine:s,startColumn:a,tokenTypeIdx:i,tokenType:r}}createFullToken(e,n,i,r,s,a,o){return{image:e,startOffset:n,endOffset:n+o-1,startLine:s,endLine:s,startColumn:a,endColumn:a+o-1,tokenTypeIdx:i,tokenType:r}}addTokenUsingPush(e,n,i){return e.push(i),n}addTokenUsingMemberAccess(e,n,i){return e[n]=i,n++,n}handlePayloadNoCustom(e,n){}handlePayloadWithCustom(e,n){n!==null&&(e.payload=n)}matchWithTest(e,n,i){return e.test(n)===!0?n.substring(i,e.lastIndex):null}matchWithExec(e,n){const i=e.exec(n);return i!==null?i[0]:null}};Kc.SKIPPED="This marks a skipped Token pattern, this means each token identified by it willbe consumed and then thrown into oblivion, this can be used to for example to completely ignore whitespace.";Kc.NA=/NOT_APPLICABLE/;function AO(t){return Pge(t)?t.LABEL:t.name}function Pge(t){return md(t.LABEL)&&t.LABEL!==""}const Eqe="parent",Qne="categories",eie="label",tie="group",nie="push_mode",iie="pop_mode",rie="longer_alt",sie="line_breaks",aie="start_chars_hint";function yf(t){return Sqe(t)}function Sqe(t){const e=t.pattern,n={};if(n.name=t.name,I_(e)||(n.PATTERN=e),xi(t,Eqe))throw`The parent property is no longer supported.
See: https://github.com/chevrotain/chevrotain/issues/564#issuecomment-349062346 for details.`;return xi(t,Qne)&&(n.CATEGORIES=t[Qne]),_k([n]),xi(t,eie)&&(n.LABEL=t[eie]),xi(t,tie)&&(n.GROUP=t[tie]),xi(t,iie)&&(n.POP_MODE=t[iie]),xi(t,nie)&&(n.PUSH_MODE=t[nie]),xi(t,rie)&&(n.LONGER_ALT=t[rie]),xi(t,sie)&&(n.LINE_BREAKS=t[sie]),xi(t,aie)&&(n.START_CHARS_HINT=t[aie]),n}const d1=yf({name:"EOF",pattern:Kc.NA});_k([d1]);function yk(t,e,n,i,r,s,a,o){return{image:e,startOffset:n,endOffset:i,startLine:r,endLine:s,startColumn:a,endColumn:o,tokenTypeIdx:t.tokenTypeIdx,tokenType:t}}function Tqe(t,e){return vk(t,e)}const Dge={buildMismatchTokenMessage({expected:t,actual:e,previous:n,ruleName:i}){return`Expecting ${Pge(t)?`--> ${AO(t)} <--`:`token of type --> ${t.name} <--`} but found --> '${e.image}' <--`},buildNotAllInputParsedMessage({firstRedundant:t,ruleName:e}){return"Redundant input, expecting EOF but found: "+t.image},buildNoViableAltMessage({expectedPathsPerAlt:t,actual:e,previous:n,customUserDescription:i,ruleName:r}){const s="Expecting: ",o=`
but found: '`+Rm(e).image+"'";if(i)return s+i+o;{const c=gd(t,(d,f)=>d.concat(f),[]),l=Fn(c,d=>`[${Fn(d,f=>AO(f)).join(", ")}]`),h=`one of these possible Token sequences:
${Fn(l,(d,f)=>`  ${f+1}. ${d}`).join(`
`)}`;return s+h+o}},buildEarlyExitMessage({expectedIterationPaths:t,actual:e,customUserDescription:n,ruleName:i}){const r="Expecting: ",a=`
but found: '`+Rm(e).image+"'";if(n)return r+n+a;{const c=`expecting at least one iteration which starts with one of these possible Token sequences::
  <${Fn(t,l=>`[${Fn(l,u=>AO(u)).join(",")}]`).join(" ,")}>`;return r+c+a}}};Object.freeze(Dge);const xqe={buildRuleNotFoundError(t,e){return"Invalid grammar, reference to a rule which is not defined: ->"+e.nonTerminalName+`<-
inside top level rule: ->`+t.name+"<-"}},TT={buildDuplicateFoundError(t,e){function n(u){return u instanceof co?u.terminalType.name:u instanceof vd?u.nonTerminalName:""}const i=t.name,r=Rm(e),s=r.idx,a=kg(r),o=n(r),c=s>0;let l=`->${a}${c?s:""}<- ${o?`with argument: ->${o}<-`:""}
                  appears more than once (${e.length} times) in the top level rule: ->${i}<-.                  
                  For further details see: https://chevrotain.io/docs/FAQ.html#NUMERICAL_SUFFIXES 
                  `;return l=l.replace(/[ \t]+/g," "),l=l.replace(/\s\s+/g,`
`),l},buildNamespaceConflictError(t){return`Namespace conflict found in grammar.
The grammar has both a Terminal(Token) and a Non-Terminal(Rule) named: <${t.name}>.
To resolve this make sure each Terminal and Non-Terminal names are unique
This is easy to accomplish by using the convention that Terminal names start with an uppercase letter
and Non-Terminal names start with a lower case letter.`},buildAlternationPrefixAmbiguityError(t){const e=Fn(t.prefixPath,r=>AO(r)).join(", "),n=t.alternation.idx===0?"":t.alternation.idx;return`Ambiguous alternatives: <${t.ambiguityIndices.join(" ,")}> due to common lookahead prefix
in <OR${n}> inside <${t.topLevelRule.name}> Rule,
<${e}> may appears as a prefix path in all these alternatives.
See: https://chevrotain.io/docs/guide/resolving_grammar_errors.html#COMMON_PREFIX
For Further details.`},buildAlternationAmbiguityError(t){const e=Fn(t.prefixPath,r=>AO(r)).join(", "),n=t.alternation.idx===0?"":t.alternation.idx;let i=`Ambiguous Alternatives Detected: <${t.ambiguityIndices.join(" ,")}> in <OR${n}> inside <${t.topLevelRule.name}> Rule,
<${e}> may appears as a prefix path in all these alternatives.
`;return i=i+`See: https://chevrotain.io/docs/guide/resolving_grammar_errors.html#AMBIGUOUS_ALTERNATIVES
For Further details.`,i},buildEmptyRepetitionError(t){let e=kg(t.repetition);return t.repetition.idx!==0&&(e+=t.repetition.idx),`The repetition <${e}> within Rule <${t.topLevelRule.name}> can never consume any tokens.
This could lead to an infinite loop.`},buildTokenNameError(t){return"deprecated"},buildEmptyAlternationError(t){return`Ambiguous empty alternative: <${t.emptyChoiceIdx+1}> in <OR${t.alternation.idx}> inside <${t.topLevelRule.name}> Rule.
Only the last alternative may be an empty alternative.`},buildTooManyAlternativesError(t){return`An Alternation cannot have more than 256 alternatives:
<OR${t.alternation.idx}> inside <${t.topLevelRule.name}> Rule.
 has ${t.alternation.definition.length+1} alternatives.`},buildLeftRecursionError(t){const e=t.topLevelRule.name,n=Fn(t.leftRecursionPath,s=>s.name),i=`${e} --> ${n.concat([e]).join(" --> ")}`;return`Left Recursion found in grammar.
rule: <${e}> can be invoked from itself (directly or indirectly)
without consuming any Tokens. The grammar path that causes this is: 
 ${i}
 To fix this refactor your grammar to remove the left recursion.
see: https://en.wikipedia.org/wiki/LL_parser#Left_factoring.`},buildInvalidRuleNameError(t){return"deprecated"},buildDuplicateRuleNameError(t){let e;return t.topLevelRule instanceof fR?e=t.topLevelRule.name:e=t.topLevelRule,`Duplicate definition, rule: ->${e}<- is already defined in the grammar: ->${t.grammarName}<-`}};function wqe(t,e){const n=new Cqe(t,e);return n.resolveRefs(),n.errors}class Cqe extends Y1{constructor(e,n){super(),this.nameToTopRule=e,this.errMsgProvider=n,this.errors=[]}resolveRefs(){Ii(_c(this.nameToTopRule),e=>{this.currTopLevel=e,e.accept(this)})}visitNonTerminal(e){const n=this.nameToTopRule[e.nonTerminalName];if(n)e.referencedRule=n;else{const i=this.errMsgProvider.buildRuleNotFoundError(this.currTopLevel,e);this.errors.push({message:i,type:gh.UNRESOLVED_SUBRULE_REF,ruleName:this.currTopLevel.name,unresolvedRefName:e.nonTerminalName})}}}class Aqe extends u4{constructor(e,n){super(),this.topProd=e,this.path=n,this.possibleTokTypes=[],this.nextProductionName="",this.nextProductionOccurrence=0,this.found=!1,this.isAtEndOfPath=!1}startWalking(){if(this.found=!1,this.path.ruleStack[0]!==this.topProd.name)throw Error("The path does not start with the walker's top Rule!");return this.ruleStack=Zl(this.path.ruleStack).reverse(),this.occurrenceStack=Zl(this.path.occurrenceStack).reverse(),this.ruleStack.pop(),this.occurrenceStack.pop(),this.updateExpectedNext(),this.walk(this.topProd),this.possibleTokTypes}walk(e,n=[]){this.found||super.walk(e,n)}walkProdRef(e,n,i){if(e.referencedRule.name===this.nextProductionName&&e.idx===this.nextProductionOccurrence){const r=n.concat(i);this.updateExpectedNext(),this.walk(e.referencedRule,r)}}updateExpectedNext(){ha(this.ruleStack)?(this.nextProductionName="",this.nextProductionOccurrence=0,this.isAtEndOfPath=!0):(this.nextProductionName=this.ruleStack.pop(),this.nextProductionOccurrence=this.occurrenceStack.pop())}}class Rqe extends Aqe{constructor(e,n){super(e,n),this.path=n,this.nextTerminalName="",this.nextTerminalOccurrence=0,this.nextTerminalName=this.path.lastTok.name,this.nextTerminalOccurrence=this.path.lastTokOccurrence}walkTerminal(e,n,i){if(this.isAtEndOfPath&&e.terminalType.name===this.nextTerminalName&&e.idx===this.nextTerminalOccurrence&&!this.found){const r=n.concat(i),s=new _d({definition:r});this.possibleTokTypes=gk(s),this.found=!0}}}class d4 extends u4{constructor(e,n){super(),this.topRule=e,this.occurrence=n,this.result={token:void 0,occurrence:void 0,isEndOfRule:void 0}}startWalking(){return this.walk(this.topRule),this.result}}class Mqe extends d4{walkMany(e,n,i){if(e.idx===this.occurrence){const r=Rm(n.concat(i));this.result.isEndOfRule=r===void 0,r instanceof co&&(this.result.token=r.terminalType,this.result.occurrence=r.idx)}else super.walkMany(e,n,i)}}class oie extends d4{walkManySep(e,n,i){if(e.idx===this.occurrence){const r=Rm(n.concat(i));this.result.isEndOfRule=r===void 0,r instanceof co&&(this.result.token=r.terminalType,this.result.occurrence=r.idx)}else super.walkManySep(e,n,i)}}class Oqe extends d4{walkAtLeastOne(e,n,i){if(e.idx===this.occurrence){const r=Rm(n.concat(i));this.result.isEndOfRule=r===void 0,r instanceof co&&(this.result.token=r.terminalType,this.result.occurrence=r.idx)}else super.walkAtLeastOne(e,n,i)}}class cie extends d4{walkAtLeastOneSep(e,n,i){if(e.idx===this.occurrence){const r=Rm(n.concat(i));this.result.isEndOfRule=r===void 0,r instanceof co&&(this.result.token=r.terminalType,this.result.occurrence=r.idx)}else super.walkAtLeastOneSep(e,n,i)}}function zq(t,e,n=[]){n=Zl(n);let i=[],r=0;function s(o){return o.concat(Vl(t,r+1))}function a(o){const c=zq(s(o),e,n);return i.concat(c)}for(;n.length<e&&r<t.length;){const o=t[r];if(o instanceof _d)return a(o.definition);if(o instanceof vd)return a(o.definition);if(o instanceof ud)i=a(o.definition);else if(o instanceof T0){const c=o.definition.concat([new qc({definition:o.definition})]);return a(c)}else if(o instanceof x0){const c=[new _d({definition:o.definition}),new qc({definition:[new co({terminalType:o.separator})].concat(o.definition)})];return a(c)}else if(o instanceof Um){const c=o.definition.concat([new qc({definition:[new co({terminalType:o.separator})].concat(o.definition)})]);i=a(c)}else if(o instanceof qc){const c=o.definition.concat([new qc({definition:o.definition})]);i=a(c)}else{if(o instanceof Bm)return Ii(o.definition,c=>{ha(c.definition)===!1&&(i=a(c.definition))}),i;if(o instanceof co)n.push(o.terminalType);else throw Error("non exhaustive match")}r++}return i.push({partialPath:n,suffixDef:Vl(t,r)}),i}function Lge(t,e,n,i){const r="EXIT_NONE_TERMINAL",s=[r],a="EXIT_ALTERNATIVE";let o=!1;const c=e.length,l=c-i-1,u=[],h=[];for(h.push({idx:-1,def:t,ruleStack:[],occurrenceStack:[]});!ha(h);){const d=h.pop();if(d===a){o&&hA(h).idx<=l&&h.pop();continue}const f=d.def,p=d.idx,g=d.ruleStack,_=d.occurrenceStack;if(ha(f))continue;const v=f[0];if(v===r){const b={idx:p,def:Vl(f),ruleStack:PN(g),occurrenceStack:PN(_)};h.push(b)}else if(v instanceof co)if(p<c-1){const b=p+1,S=e[b];if(n(S,v.terminalType)){const x={idx:b,def:Vl(f),ruleStack:g,occurrenceStack:_};h.push(x)}}else if(p===c-1)u.push({nextTokenType:v.terminalType,nextTokenOccurrence:v.idx,ruleStack:g,occurrenceStack:_}),o=!0;else throw Error("non exhaustive match");else if(v instanceof vd){const b=Zl(g);b.push(v.nonTerminalName);const S=Zl(_);S.push(v.idx);const x={idx:p,def:v.definition.concat(s,Vl(f)),ruleStack:b,occurrenceStack:S};h.push(x)}else if(v instanceof ud){const b={idx:p,def:Vl(f),ruleStack:g,occurrenceStack:_};h.push(b),h.push(a);const S={idx:p,def:v.definition.concat(Vl(f)),ruleStack:g,occurrenceStack:_};h.push(S)}else if(v instanceof T0){const b=new qc({definition:v.definition,idx:v.idx}),S=v.definition.concat([b],Vl(f)),x={idx:p,def:S,ruleStack:g,occurrenceStack:_};h.push(x)}else if(v instanceof x0){const b=new co({terminalType:v.separator}),S=new qc({definition:[b].concat(v.definition),idx:v.idx}),x=v.definition.concat([S],Vl(f)),M={idx:p,def:x,ruleStack:g,occurrenceStack:_};h.push(M)}else if(v instanceof Um){const b={idx:p,def:Vl(f),ruleStack:g,occurrenceStack:_};h.push(b),h.push(a);const S=new co({terminalType:v.separator}),x=new qc({definition:[S].concat(v.definition),idx:v.idx}),M=v.definition.concat([x],Vl(f)),R={idx:p,def:M,ruleStack:g,occurrenceStack:_};h.push(R)}else if(v instanceof qc){const b={idx:p,def:Vl(f),ruleStack:g,occurrenceStack:_};h.push(b),h.push(a);const S=new qc({definition:v.definition,idx:v.idx}),x=v.definition.concat([S],Vl(f)),M={idx:p,def:x,ruleStack:g,occurrenceStack:_};h.push(M)}else if(v instanceof Bm)for(let b=v.definition.length-1;b>=0;b--){const S=v.definition[b],x={idx:p,def:S.definition.concat(Vl(f)),ruleStack:g,occurrenceStack:_};h.push(x),h.push(a)}else if(v instanceof _d)h.push({idx:p,def:v.definition.concat(Vl(f)),ruleStack:g,occurrenceStack:_});else if(v instanceof fR)h.push(Nqe(v,p,g,_));else throw Error("non exhaustive match")}return u}function Nqe(t,e,n,i){const r=Zl(n);r.push(t.name);const s=Zl(i);return s.push(1),{idx:e,def:t.definition,ruleStack:r,occurrenceStack:s}}var Mo;(function(t){t[t.OPTION=0]="OPTION",t[t.REPETITION=1]="REPETITION",t[t.REPETITION_MANDATORY=2]="REPETITION_MANDATORY",t[t.REPETITION_MANDATORY_WITH_SEPARATOR=3]="REPETITION_MANDATORY_WITH_SEPARATOR",t[t.REPETITION_WITH_SEPARATOR=4]="REPETITION_WITH_SEPARATOR",t[t.ALTERNATION=5]="ALTERNATION"})(Mo||(Mo={}));function Uge(t){if(t instanceof ud||t==="Option")return Mo.OPTION;if(t instanceof qc||t==="Repetition")return Mo.REPETITION;if(t instanceof T0||t==="RepetitionMandatory")return Mo.REPETITION_MANDATORY;if(t instanceof x0||t==="RepetitionMandatoryWithSeparator")return Mo.REPETITION_MANDATORY_WITH_SEPARATOR;if(t instanceof Um||t==="RepetitionWithSeparator")return Mo.REPETITION_WITH_SEPARATOR;if(t instanceof Bm||t==="Alternation")return Mo.ALTERNATION;throw Error("non exhaustive match")}function Iqe(t,e,n,i,r,s){const a=EY(t,e,n),o=zge(a)?A3:vk;return s(a,i,o,r)}function kqe(t,e,n,i,r,s){const a=SY(t,e,r,n),o=zge(a)?A3:vk;return s(a[0],o,i)}function Pqe(t,e,n,i){const r=t.length,s=wm(t,a=>wm(a,o=>o.length===1));if(e)return function(a){const o=Fn(a,c=>c.GATE);for(let c=0;c<r;c++){const l=t[c],u=l.length,h=o[c];if(!(h!==void 0&&h.call(this)===!1))e:for(let d=0;d<u;d++){const f=l[d],p=f.length;for(let g=0;g<p;g++){const _=this.LA(g+1);if(n(_,f[g])===!1)continue e}return c}}};if(s&&!i){const a=Fn(t,c=>ld(c)),o=gd(a,(c,l,u)=>(Ii(l,h=>{xi(c,h.tokenTypeIdx)||(c[h.tokenTypeIdx]=u),Ii(h.categoryMatches,d=>{xi(c,d)||(c[d]=u)})}),c),{});return function(){const c=this.LA(1);return o[c.tokenTypeIdx]}}else return function(){for(let a=0;a<r;a++){const o=t[a],c=o.length;e:for(let l=0;l<c;l++){const u=o[l],h=u.length;for(let d=0;d<h;d++){const f=this.LA(d+1);if(n(f,u[d])===!1)continue e}return a}}}}function Dqe(t,e,n){const i=wm(t,s=>s.length===1),r=t.length;if(i&&!n){const s=ld(t);if(s.length===1&&ha(s[0].categoryMatches)){const o=s[0].tokenTypeIdx;return function(){return this.LA(1).tokenTypeIdx===o}}else{const a=gd(s,(o,c,l)=>(o[c.tokenTypeIdx]=!0,Ii(c.categoryMatches,u=>{o[u]=!0}),o),[]);return function(){const o=this.LA(1);return a[o.tokenTypeIdx]===!0}}}else return function(){e:for(let s=0;s<r;s++){const a=t[s],o=a.length;for(let c=0;c<o;c++){const l=this.LA(c+1);if(e(l,a[c])===!1)continue e}return!0}return!1}}class Lqe extends u4{constructor(e,n,i){super(),this.topProd=e,this.targetOccurrence=n,this.targetProdType=i}startWalking(){return this.walk(this.topProd),this.restDef}checkIsTarget(e,n,i,r){return e.idx===this.targetOccurrence&&this.targetProdType===n?(this.restDef=i.concat(r),!0):!1}walkOption(e,n,i){this.checkIsTarget(e,Mo.OPTION,n,i)||super.walkOption(e,n,i)}walkAtLeastOne(e,n,i){this.checkIsTarget(e,Mo.REPETITION_MANDATORY,n,i)||super.walkOption(e,n,i)}walkAtLeastOneSep(e,n,i){this.checkIsTarget(e,Mo.REPETITION_MANDATORY_WITH_SEPARATOR,n,i)||super.walkOption(e,n,i)}walkMany(e,n,i){this.checkIsTarget(e,Mo.REPETITION,n,i)||super.walkOption(e,n,i)}walkManySep(e,n,i){this.checkIsTarget(e,Mo.REPETITION_WITH_SEPARATOR,n,i)||super.walkOption(e,n,i)}}class Bge extends Y1{constructor(e,n,i){super(),this.targetOccurrence=e,this.targetProdType=n,this.targetRef=i,this.result=[]}checkIsTarget(e,n){e.idx===this.targetOccurrence&&this.targetProdType===n&&(this.targetRef===void 0||e===this.targetRef)&&(this.result=e.definition)}visitOption(e){this.checkIsTarget(e,Mo.OPTION)}visitRepetition(e){this.checkIsTarget(e,Mo.REPETITION)}visitRepetitionMandatory(e){this.checkIsTarget(e,Mo.REPETITION_MANDATORY)}visitRepetitionMandatoryWithSeparator(e){this.checkIsTarget(e,Mo.REPETITION_MANDATORY_WITH_SEPARATOR)}visitRepetitionWithSeparator(e){this.checkIsTarget(e,Mo.REPETITION_WITH_SEPARATOR)}visitAlternation(e){this.checkIsTarget(e,Mo.ALTERNATION)}}function lie(t){const e=new Array(t);for(let n=0;n<t;n++)e[n]=[];return e}function dH(t){let e=[""];for(let n=0;n<t.length;n++){const i=t[n],r=[];for(let s=0;s<e.length;s++){const a=e[s];r.push(a+"_"+i.tokenTypeIdx);for(let o=0;o<i.categoryMatches.length;o++){const c="_"+i.categoryMatches[o];r.push(a+c)}}e=r}return e}function Uqe(t,e,n){for(let i=0;i<t.length;i++){if(i===n)continue;const r=t[i];for(let s=0;s<e.length;s++){const a=e[s];if(r[a]===!0)return!1}}return!0}function Fge(t,e){const n=Fn(t,a=>zq([a],1)),i=lie(n.length),r=Fn(n,a=>{const o={};return Ii(a,c=>{const l=dH(c.partialPath);Ii(l,u=>{o[u]=!0})}),o});let s=n;for(let a=1;a<=e;a++){const o=s;s=lie(o.length);for(let c=0;c<o.length;c++){const l=o[c];for(let u=0;u<l.length;u++){const h=l[u].partialPath,d=l[u].suffixDef,f=dH(h);if(Uqe(r,f,c)||ha(d)||h.length===e){const g=i[c];if(jq(g,h)===!1){g.push(h);for(let _=0;_<f.length;_++){const v=f[_];r[c][v]=!0}}}else{const g=zq(d,a+1,h);s[c]=s[c].concat(g),Ii(g,_=>{const v=dH(_.partialPath);Ii(v,b=>{r[c][b]=!0})})}}}}return i}function EY(t,e,n,i){const r=new Bge(t,Mo.ALTERNATION,i);return e.accept(r),Fge(r.result,n)}function SY(t,e,n,i){const r=new Bge(t,n);e.accept(r);const s=r.result,o=new Lqe(e,t,n).startWalking(),c=new _d({definition:s}),l=new _d({definition:o});return Fge([c,l],i)}function jq(t,e){e:for(let n=0;n<t.length;n++){const i=t[n];if(i.length===e.length){for(let r=0;r<i.length;r++){const s=e[r],a=i[r];if((s===a||a.categoryMatchesMap[s.tokenTypeIdx]!==void 0)===!1)continue e}return!0}}return!1}function Bqe(t,e){return t.length<e.length&&wm(t,(n,i)=>{const r=e[i];return n===r||r.categoryMatchesMap[n.tokenTypeIdx]})}function zge(t){return wm(t,e=>wm(e,n=>wm(n,i=>ha(i.categoryMatches))))}function Fqe(t){const e=t.lookaheadStrategy.validate({rules:t.rules,tokenTypes:t.tokenTypes,grammarName:t.grammarName});return Fn(e,n=>Object.assign({type:gh.CUSTOM_LOOKAHEAD_VALIDATION},n))}function zqe(t,e,n,i){const r=vp(t,c=>jqe(c,n)),s=Qqe(t,e,n),a=vp(t,c=>Kqe(c,n)),o=vp(t,c=>Gqe(c,t,i,n));return r.concat(s,a,o)}function jqe(t,e){const n=new Vqe;t.accept(n);const i=n.allProductions,r=Ege(i,Hqe),s=Lm(r,o=>o.length>1);return Fn(_c(s),o=>{const c=Rm(o),l=e.buildDuplicateFoundError(t,o),u=kg(c),h={message:l,type:gh.DUPLICATE_PRODUCTIONS,ruleName:t.name,dslName:u,occurrence:c.idx},d=jge(c);return d&&(h.parameter=d),h})}function Hqe(t){return`${kg(t)}_#_${t.idx}_#_${jge(t)}`}function jge(t){return t instanceof co?t.terminalType.name:t instanceof vd?t.nonTerminalName:""}class Vqe extends Y1{constructor(){super(...arguments),this.allProductions=[]}visitNonTerminal(e){this.allProductions.push(e)}visitOption(e){this.allProductions.push(e)}visitRepetitionWithSeparator(e){this.allProductions.push(e)}visitRepetitionMandatory(e){this.allProductions.push(e)}visitRepetitionMandatoryWithSeparator(e){this.allProductions.push(e)}visitRepetition(e){this.allProductions.push(e)}visitAlternation(e){this.allProductions.push(e)}visitTerminal(e){this.allProductions.push(e)}}function Gqe(t,e,n,i){const r=[];if(gd(e,(a,o)=>o.name===t.name?a+1:a,0)>1){const a=i.buildDuplicateRuleNameError({topLevelRule:t,grammarName:n});r.push({message:a,type:gh.DUPLICATE_RULE_NAME,ruleName:t.name})}return r}function qqe(t,e,n){const i=[];let r;return Eh(e,t)||(r=`Invalid rule override, rule: ->${t}<- cannot be overridden in the grammar: ->${n}<-as it is not defined in any of the super grammars `,i.push({message:r,type:gh.INVALID_RULE_OVERRIDE,ruleName:t})),i}function Hge(t,e,n,i=[]){const r=[],s=sL(e.definition);if(ha(s))return[];{const a=t.name;Eh(s,t)&&r.push({message:n.buildLeftRecursionError({topLevelRule:t,leftRecursionPath:i}),type:gh.LEFT_RECURSION,ruleName:a});const c=o4(s,i.concat([t])),l=vp(c,u=>{const h=Zl(i);return h.push(u),Hge(t,u,n,h)});return r.concat(l)}}function sL(t){let e=[];if(ha(t))return e;const n=Rm(t);if(n instanceof vd)e.push(n.referencedRule);else if(n instanceof _d||n instanceof ud||n instanceof T0||n instanceof x0||n instanceof Um||n instanceof qc)e=e.concat(sL(n.definition));else if(n instanceof Bm)e=ld(Fn(n.definition,s=>sL(s.definition)));else if(!(n instanceof co))throw Error("non exhaustive match");const i=T3(n),r=t.length>1;if(i&&r){const s=Vl(t);return e.concat(sL(s))}else return e}class TY extends Y1{constructor(){super(...arguments),this.alternations=[]}visitAlternation(e){this.alternations.push(e)}}function $qe(t,e){const n=new TY;t.accept(n);const i=n.alternations;return vp(i,s=>{const a=PN(s.definition);return vp(a,(o,c)=>{const l=Lge([o],[],vk,1);return ha(l)?[{message:e.buildEmptyAlternationError({topLevelRule:t,alternation:s,emptyChoiceIdx:c}),type:gh.NONE_LAST_EMPTY_ALT,ruleName:t.name,occurrence:s.idx,alternative:c+1}]:[]})})}function Wqe(t,e,n){const i=new TY;t.accept(i);let r=i.alternations;return r=c4(r,a=>a.ignoreAmbiguities===!0),vp(r,a=>{const o=a.idx,c=a.maxLookahead||e,l=EY(o,t,c,a),u=Zqe(l,a,t,n),h=Jqe(l,a,t,n);return u.concat(h)})}class Yqe extends Y1{constructor(){super(...arguments),this.allProductions=[]}visitRepetitionWithSeparator(e){this.allProductions.push(e)}visitRepetitionMandatory(e){this.allProductions.push(e)}visitRepetitionMandatoryWithSeparator(e){this.allProductions.push(e)}visitRepetition(e){this.allProductions.push(e)}}function Kqe(t,e){const n=new TY;t.accept(n);const i=n.alternations;return vp(i,s=>s.definition.length>255?[{message:e.buildTooManyAlternativesError({topLevelRule:t,alternation:s}),type:gh.TOO_MANY_ALTS,ruleName:t.name,occurrence:s.idx}]:[])}function Xqe(t,e,n){const i=[];return Ii(t,r=>{const s=new Yqe;r.accept(s);const a=s.allProductions;Ii(a,o=>{const c=Uge(o),l=o.maxLookahead||e,u=o.idx,d=SY(u,r,c,l)[0];if(ha(ld(d))){const f=n.buildEmptyRepetitionError({topLevelRule:r,repetition:o});i.push({message:f,type:gh.NO_NON_EMPTY_LOOKAHEAD,ruleName:r.name})}})}),i}function Zqe(t,e,n,i){const r=[],s=gd(t,(o,c,l)=>(e.definition[l].ignoreAmbiguities===!0||Ii(c,u=>{const h=[l];Ii(t,(d,f)=>{l!==f&&jq(d,u)&&e.definition[f].ignoreAmbiguities!==!0&&h.push(f)}),h.length>1&&!jq(r,u)&&(r.push(u),o.push({alts:h,path:u}))}),o),[]);return Fn(s,o=>{const c=Fn(o.alts,u=>u+1);return{message:i.buildAlternationAmbiguityError({topLevelRule:n,alternation:e,ambiguityIndices:c,prefixPath:o.path}),type:gh.AMBIGUOUS_ALTS,ruleName:n.name,occurrence:e.idx,alternatives:o.alts}})}function Jqe(t,e,n,i){const r=gd(t,(a,o,c)=>{const l=Fn(o,u=>({idx:c,path:u}));return a.concat(l)},[]);return mk(vp(r,a=>{if(e.definition[a.idx].ignoreAmbiguities===!0)return[];const c=a.idx,l=a.path,u=Ip(r,d=>e.definition[d.idx].ignoreAmbiguities!==!0&&d.idx<c&&Bqe(d.path,l));return Fn(u,d=>{const f=[d.idx+1,c+1],p=e.idx===0?"":e.idx;return{message:i.buildAlternationPrefixAmbiguityError({topLevelRule:n,alternation:e,ambiguityIndices:f,prefixPath:d.path}),type:gh.AMBIGUOUS_PREFIX_ALTS,ruleName:n.name,occurrence:p,alternatives:f}})}))}function Qqe(t,e,n){const i=[],r=Fn(e,s=>s.name);return Ii(t,s=>{const a=s.name;if(Eh(r,a)){const o=n.buildNamespaceConflictError(s);i.push({message:o,type:gh.CONFLICT_TOKENS_RULES_NAMESPACE,ruleName:a})}}),i}function e$e(t){const e=vY(t,{errMsgProvider:xqe}),n={};return Ii(t.rules,i=>{n[i.name]=i}),wqe(n,e.errMsgProvider)}function t$e(t){return t=vY(t,{errMsgProvider:TT}),zqe(t.rules,t.tokenTypes,t.errMsgProvider,t.grammarName)}const Vge="MismatchedTokenException",Gge="NoViableAltException",qge="EarlyExitException",$ge="NotAllInputParsedException",Wge=[Vge,Gge,qge,$ge];Object.freeze(Wge);function R3(t){return Eh(Wge,t.name)}class f4 extends Error{constructor(e,n){super(e),this.token=n,this.resyncedTokens=[],Object.setPrototypeOf(this,new.target.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor)}}class Yge extends f4{constructor(e,n,i){super(e,n),this.previousToken=i,this.name=Vge}}class n$e extends f4{constructor(e,n,i){super(e,n),this.previousToken=i,this.name=Gge}}class i$e extends f4{constructor(e,n){super(e,n),this.name=$ge}}class r$e extends f4{constructor(e,n,i){super(e,n),this.previousToken=i,this.name=qge}}const fH={},Kge="InRuleRecoveryException";class s$e extends Error{constructor(e){super(e),this.name=Kge}}class a$e{initRecoverable(e){this.firstAfterRepMap={},this.resyncFollows={},this.recoveryEnabled=xi(e,"recoveryEnabled")?e.recoveryEnabled:k_.recoveryEnabled,this.recoveryEnabled&&(this.attemptInRepetitionRecovery=o$e)}getTokenToInsert(e){const n=yk(e,"",NaN,NaN,NaN,NaN,NaN,NaN);return n.isInsertedInRecovery=!0,n}canTokenTypeBeInsertedInRecovery(e){return!0}canTokenTypeBeDeletedInRecovery(e){return!0}tryInRepetitionRecovery(e,n,i,r){const s=this.findReSyncTokenType(),a=this.exportLexerState(),o=[];let c=!1;const l=this.LA(1);let u=this.LA(1);const h=()=>{const d=this.LA(0),f=this.errorMessageProvider.buildMismatchTokenMessage({expected:r,actual:l,previous:d,ruleName:this.getCurrRuleFullName()}),p=new Yge(f,l,this.LA(0));p.resyncedTokens=PN(o),this.SAVE_ERROR(p)};for(;!c;)if(this.tokenMatcher(u,r)){h();return}else if(i.call(this)){h(),e.apply(this,n);return}else this.tokenMatcher(u,s)?c=!0:(u=this.SKIP_TOKEN(),this.addToResyncTokens(u,o));this.importLexerState(a)}shouldInRepetitionRecoveryBeTried(e,n,i){return!(i===!1||this.tokenMatcher(this.LA(1),e)||this.isBackTracking()||this.canPerformInRuleRecovery(e,this.getFollowsForInRuleRecovery(e,n)))}getFollowsForInRuleRecovery(e,n){const i=this.getCurrentGrammarPath(e,n);return this.getNextPossibleTokenTypes(i)}tryInRuleRecovery(e,n){if(this.canRecoverWithSingleTokenInsertion(e,n))return this.getTokenToInsert(e);if(this.canRecoverWithSingleTokenDeletion(e)){const i=this.SKIP_TOKEN();return this.consumeToken(),i}throw new s$e("sad sad panda")}canPerformInRuleRecovery(e,n){return this.canRecoverWithSingleTokenInsertion(e,n)||this.canRecoverWithSingleTokenDeletion(e)}canRecoverWithSingleTokenInsertion(e,n){if(!this.canTokenTypeBeInsertedInRecovery(e)||ha(n))return!1;const i=this.LA(1);return dA(n,s=>this.tokenMatcher(i,s))!==void 0}canRecoverWithSingleTokenDeletion(e){return this.canTokenTypeBeDeletedInRecovery(e)?this.tokenMatcher(this.LA(2),e):!1}isInCurrentRuleReSyncSet(e){const n=this.getCurrFollowKey(),i=this.getFollowSetFromFollowKey(n);return Eh(i,e)}findReSyncTokenType(){const e=this.flattenFollowSet();let n=this.LA(1),i=2;for(;;){const r=dA(e,s=>Tqe(n,s));if(r!==void 0)return r;n=this.LA(i),i++}}getCurrFollowKey(){if(this.RULE_STACK.length===1)return fH;const e=this.getLastExplicitRuleShortName(),n=this.getLastExplicitRuleOccurrenceIndex(),i=this.getPreviousExplicitRuleShortName();return{ruleName:this.shortRuleNameToFullName(e),idxInCallingRule:n,inRule:this.shortRuleNameToFullName(i)}}buildFullFollowKeyStack(){const e=this.RULE_STACK,n=this.RULE_OCCURRENCE_STACK;return Fn(e,(i,r)=>r===0?fH:{ruleName:this.shortRuleNameToFullName(i),idxInCallingRule:n[r],inRule:this.shortRuleNameToFullName(e[r-1])})}flattenFollowSet(){const e=Fn(this.buildFullFollowKeyStack(),n=>this.getFollowSetFromFollowKey(n));return ld(e)}getFollowSetFromFollowKey(e){if(e===fH)return[d1];const n=e.ruleName+e.idxInCallingRule+wge+e.inRule;return this.resyncFollows[n]}addToResyncTokens(e,n){return this.tokenMatcher(e,d1)||n.push(e),n}reSyncTo(e){const n=[];let i=this.LA(1);for(;this.tokenMatcher(i,e)===!1;)i=this.SKIP_TOKEN(),this.addToResyncTokens(i,n);return PN(n)}attemptInRepetitionRecovery(e,n,i,r,s,a,o){}getCurrentGrammarPath(e,n){const i=this.getHumanReadableRuleStack(),r=Zl(this.RULE_OCCURRENCE_STACK);return{ruleStack:i,occurrenceStack:r,lastTok:e,lastTokOccurrence:n}}getHumanReadableRuleStack(){return Fn(this.RULE_STACK,e=>this.shortRuleNameToFullName(e))}}function o$e(t,e,n,i,r,s,a){const o=this.getKeyForAutomaticLookahead(i,r);let c=this.firstAfterRepMap[o];if(c===void 0){const d=this.getCurrRuleFullName(),f=this.getGAstProductions()[d];c=new s(f,r).startWalking(),this.firstAfterRepMap[o]=c}let l=c.token,u=c.occurrence;const h=c.isEndOfRule;this.RULE_STACK.length===1&&h&&l===void 0&&(l=d1,u=1),!(l===void 0||u===void 0)&&this.shouldInRepetitionRecoveryBeTried(l,u,a)&&this.tryInRepetitionRecovery(t,e,n,l)}const c$e=4,LE=8,Xge=1<<LE,Zge=2<<LE,Hq=3<<LE,Vq=4<<LE,Gq=5<<LE,aL=6<<LE;function pH(t,e,n){return n|e|t}class l$e{constructor(e){var n;this.maxLookahead=(n=e==null?void 0:e.maxLookahead)!==null&&n!==void 0?n:k_.maxLookahead}validate(e){const n=this.validateNoLeftRecursion(e.rules);if(ha(n)){const i=this.validateEmptyOrAlternatives(e.rules),r=this.validateAmbiguousAlternationAlternatives(e.rules,this.maxLookahead),s=this.validateSomeNonEmptyLookaheadPath(e.rules,this.maxLookahead);return[...n,...i,...r,...s]}return n}validateNoLeftRecursion(e){return vp(e,n=>Hge(n,n,TT))}validateEmptyOrAlternatives(e){return vp(e,n=>$qe(n,TT))}validateAmbiguousAlternationAlternatives(e,n){return vp(e,i=>Wqe(i,n,TT))}validateSomeNonEmptyLookaheadPath(e,n){return Xqe(e,n,TT)}buildLookaheadForAlternation(e){return Iqe(e.prodOccurrence,e.rule,e.maxLookahead,e.hasPredicates,e.dynamicTokensEnabled,Pqe)}buildLookaheadForOptional(e){return kqe(e.prodOccurrence,e.rule,e.maxLookahead,e.dynamicTokensEnabled,Uge(e.prodType),Dqe)}}class u$e{initLooksAhead(e){this.dynamicTokensEnabled=xi(e,"dynamicTokensEnabled")?e.dynamicTokensEnabled:k_.dynamicTokensEnabled,this.maxLookahead=xi(e,"maxLookahead")?e.maxLookahead:k_.maxLookahead,this.lookaheadStrategy=xi(e,"lookaheadStrategy")?e.lookaheadStrategy:new l$e({maxLookahead:this.maxLookahead}),this.lookAheadFuncsCache=new Map}preComputeLookaheadFunctions(e){Ii(e,n=>{this.TRACE_INIT(`${n.name} Rule Lookahead`,()=>{const{alternation:i,repetition:r,option:s,repetitionMandatory:a,repetitionMandatoryWithSeparator:o,repetitionWithSeparator:c}=d$e(n);Ii(i,l=>{const u=l.idx===0?"":l.idx;this.TRACE_INIT(`${kg(l)}${u}`,()=>{const h=this.lookaheadStrategy.buildLookaheadForAlternation({prodOccurrence:l.idx,rule:n,maxLookahead:l.maxLookahead||this.maxLookahead,hasPredicates:l.hasPredicates,dynamicTokensEnabled:this.dynamicTokensEnabled}),d=pH(this.fullRuleNameToShort[n.name],Xge,l.idx);this.setLaFuncCache(d,h)})}),Ii(r,l=>{this.computeLookaheadFunc(n,l.idx,Hq,"Repetition",l.maxLookahead,kg(l))}),Ii(s,l=>{this.computeLookaheadFunc(n,l.idx,Zge,"Option",l.maxLookahead,kg(l))}),Ii(a,l=>{this.computeLookaheadFunc(n,l.idx,Vq,"RepetitionMandatory",l.maxLookahead,kg(l))}),Ii(o,l=>{this.computeLookaheadFunc(n,l.idx,aL,"RepetitionMandatoryWithSeparator",l.maxLookahead,kg(l))}),Ii(c,l=>{this.computeLookaheadFunc(n,l.idx,Gq,"RepetitionWithSeparator",l.maxLookahead,kg(l))})})})}computeLookaheadFunc(e,n,i,r,s,a){this.TRACE_INIT(`${a}${n===0?"":n}`,()=>{const o=this.lookaheadStrategy.buildLookaheadForOptional({prodOccurrence:n,rule:e,maxLookahead:s||this.maxLookahead,dynamicTokensEnabled:this.dynamicTokensEnabled,prodType:r}),c=pH(this.fullRuleNameToShort[e.name],i,n);this.setLaFuncCache(c,o)})}getKeyForAutomaticLookahead(e,n){const i=this.getLastExplicitRuleShortName();return pH(i,e,n)}getLaFuncFromCache(e){return this.lookAheadFuncsCache.get(e)}setLaFuncCache(e,n){this.lookAheadFuncsCache.set(e,n)}}class h$e extends Y1{constructor(){super(...arguments),this.dslMethods={option:[],alternation:[],repetition:[],repetitionWithSeparator:[],repetitionMandatory:[],repetitionMandatoryWithSeparator:[]}}reset(){this.dslMethods={option:[],alternation:[],repetition:[],repetitionWithSeparator:[],repetitionMandatory:[],repetitionMandatoryWithSeparator:[]}}visitOption(e){this.dslMethods.option.push(e)}visitRepetitionWithSeparator(e){this.dslMethods.repetitionWithSeparator.push(e)}visitRepetitionMandatory(e){this.dslMethods.repetitionMandatory.push(e)}visitRepetitionMandatoryWithSeparator(e){this.dslMethods.repetitionMandatoryWithSeparator.push(e)}visitRepetition(e){this.dslMethods.repetition.push(e)}visitAlternation(e){this.dslMethods.alternation.push(e)}}const WD=new h$e;function d$e(t){WD.reset(),t.accept(WD);const e=WD.dslMethods;return WD.reset(),e}function uie(t,e){isNaN(t.startOffset)===!0?(t.startOffset=e.startOffset,t.endOffset=e.endOffset):t.endOffset<e.endOffset&&(t.endOffset=e.endOffset)}function hie(t,e){isNaN(t.startOffset)===!0?(t.startOffset=e.startOffset,t.startColumn=e.startColumn,t.startLine=e.startLine,t.endOffset=e.endOffset,t.endColumn=e.endColumn,t.endLine=e.endLine):t.endOffset<e.endOffset&&(t.endOffset=e.endOffset,t.endColumn=e.endColumn,t.endLine=e.endLine)}function f$e(t,e,n){t.children[n]===void 0?t.children[n]=[e]:t.children[n].push(e)}function p$e(t,e,n){t.children[e]===void 0?t.children[e]=[n]:t.children[e].push(n)}const m$e="name";function Jge(t,e){Object.defineProperty(t,m$e,{enumerable:!1,configurable:!0,writable:!1,value:e})}function g$e(t,e){const n=Cp(t),i=n.length;for(let r=0;r<i;r++){const s=n[r],a=t[s],o=a.length;for(let c=0;c<o;c++){const l=a[c];l.tokenTypeIdx===void 0&&this[l.name](l.children,e)}}}function v$e(t,e){const n=function(){};Jge(n,t+"BaseSemantics");const i={visit:function(r,s){if(Yr(r)&&(r=r[0]),!I_(r))return this[r.name](r.children,s)},validateVisitor:function(){const r=y$e(this,e);if(!ha(r)){const s=Fn(r,a=>a.msg);throw Error(`Errors Detected in CST Visitor <${this.constructor.name}>:
	${s.join(`

`).replace(/\n/g,`
	`)}`)}}};return n.prototype=i,n.prototype.constructor=n,n._RULE_NAMES=e,n}function _$e(t,e,n){const i=function(){};Jge(i,t+"BaseSemanticsWithDefaults");const r=Object.create(n.prototype);return Ii(e,s=>{r[s]=g$e}),i.prototype=r,i.prototype.constructor=i,i}var qq;(function(t){t[t.REDUNDANT_METHOD=0]="REDUNDANT_METHOD",t[t.MISSING_METHOD=1]="MISSING_METHOD"})(qq||(qq={}));function y$e(t,e){return b$e(t,e)}function b$e(t,e){const n=Ip(e,r=>H_(t[r])===!1),i=Fn(n,r=>({msg:`Missing visitor method: <${r}> on ${t.constructor.name} CST Visitor.`,type:qq.MISSING_METHOD,methodName:r}));return mk(i)}class E$e{initTreeBuilder(e){if(this.CST_STACK=[],this.outputCst=e.outputCst,this.nodeLocationTracking=xi(e,"nodeLocationTracking")?e.nodeLocationTracking:k_.nodeLocationTracking,!this.outputCst)this.cstInvocationStateUpdate=Bc,this.cstFinallyStateUpdate=Bc,this.cstPostTerminal=Bc,this.cstPostNonTerminal=Bc,this.cstPostRule=Bc;else if(/full/i.test(this.nodeLocationTracking))this.recoveryEnabled?(this.setNodeLocationFromToken=hie,this.setNodeLocationFromNode=hie,this.cstPostRule=Bc,this.setInitialNodeLocation=this.setInitialNodeLocationFullRecovery):(this.setNodeLocationFromToken=Bc,this.setNodeLocationFromNode=Bc,this.cstPostRule=this.cstPostRuleFull,this.setInitialNodeLocation=this.setInitialNodeLocationFullRegular);else if(/onlyOffset/i.test(this.nodeLocationTracking))this.recoveryEnabled?(this.setNodeLocationFromToken=uie,this.setNodeLocationFromNode=uie,this.cstPostRule=Bc,this.setInitialNodeLocation=this.setInitialNodeLocationOnlyOffsetRecovery):(this.setNodeLocationFromToken=Bc,this.setNodeLocationFromNode=Bc,this.cstPostRule=this.cstPostRuleOnlyOffset,this.setInitialNodeLocation=this.setInitialNodeLocationOnlyOffsetRegular);else if(/none/i.test(this.nodeLocationTracking))this.setNodeLocationFromToken=Bc,this.setNodeLocationFromNode=Bc,this.cstPostRule=Bc,this.setInitialNodeLocation=Bc;else throw Error(`Invalid <nodeLocationTracking> config option: "${e.nodeLocationTracking}"`)}setInitialNodeLocationOnlyOffsetRecovery(e){e.location={startOffset:NaN,endOffset:NaN}}setInitialNodeLocationOnlyOffsetRegular(e){e.location={startOffset:this.LA(1).startOffset,endOffset:NaN}}setInitialNodeLocationFullRecovery(e){e.location={startOffset:NaN,startLine:NaN,startColumn:NaN,endOffset:NaN,endLine:NaN,endColumn:NaN}}setInitialNodeLocationFullRegular(e){const n=this.LA(1);e.location={startOffset:n.startOffset,startLine:n.startLine,startColumn:n.startColumn,endOffset:NaN,endLine:NaN,endColumn:NaN}}cstInvocationStateUpdate(e){const n={name:e,children:Object.create(null)};this.setInitialNodeLocation(n),this.CST_STACK.push(n)}cstFinallyStateUpdate(){this.CST_STACK.pop()}cstPostRuleFull(e){const n=this.LA(0),i=e.location;i.startOffset<=n.startOffset?(i.endOffset=n.endOffset,i.endLine=n.endLine,i.endColumn=n.endColumn):(i.startOffset=NaN,i.startLine=NaN,i.startColumn=NaN)}cstPostRuleOnlyOffset(e){const n=this.LA(0),i=e.location;i.startOffset<=n.startOffset?i.endOffset=n.endOffset:i.startOffset=NaN}cstPostTerminal(e,n){const i=this.CST_STACK[this.CST_STACK.length-1];f$e(i,n,e),this.setNodeLocationFromToken(i.location,n)}cstPostNonTerminal(e,n){const i=this.CST_STACK[this.CST_STACK.length-1];p$e(i,n,e),this.setNodeLocationFromNode(i.location,e.location)}getBaseCstVisitorConstructor(){if(I_(this.baseCstVisitorConstructor)){const e=v$e(this.className,Cp(this.gastProductionsCache));return this.baseCstVisitorConstructor=e,e}return this.baseCstVisitorConstructor}getBaseCstVisitorConstructorWithDefaults(){if(I_(this.baseCstVisitorWithDefaultsConstructor)){const e=_$e(this.className,Cp(this.gastProductionsCache),this.getBaseCstVisitorConstructor());return this.baseCstVisitorWithDefaultsConstructor=e,e}return this.baseCstVisitorWithDefaultsConstructor}getLastExplicitRuleShortName(){const e=this.RULE_STACK;return e[e.length-1]}getPreviousExplicitRuleShortName(){const e=this.RULE_STACK;return e[e.length-2]}getLastExplicitRuleOccurrenceIndex(){const e=this.RULE_OCCURRENCE_STACK;return e[e.length-1]}}class S$e{initLexerAdapter(){this.tokVector=[],this.tokVectorLength=0,this.currIdx=-1}set input(e){if(this.selfAnalysisDone!==!0)throw Error("Missing <performSelfAnalysis> invocation at the end of the Parser's constructor.");this.reset(),this.tokVector=e,this.tokVectorLength=e.length}get input(){return this.tokVector}SKIP_TOKEN(){return this.currIdx<=this.tokVector.length-2?(this.consumeToken(),this.LA(1)):O3}LA(e){const n=this.currIdx+e;return n<0||this.tokVectorLength<=n?O3:this.tokVector[n]}consumeToken(){this.currIdx++}exportLexerState(){return this.currIdx}importLexerState(e){this.currIdx=e}resetLexerState(){this.currIdx=-1}moveToTerminatedState(){this.currIdx=this.tokVector.length-1}getLexerPosition(){return this.exportLexerState()}}class T$e{ACTION(e){return e.call(this)}consume(e,n,i){return this.consumeInternal(n,e,i)}subrule(e,n,i){return this.subruleInternal(n,e,i)}option(e,n){return this.optionInternal(n,e)}or(e,n){return this.orInternal(n,e)}many(e,n){return this.manyInternal(e,n)}atLeastOne(e,n){return this.atLeastOneInternal(e,n)}CONSUME(e,n){return this.consumeInternal(e,0,n)}CONSUME1(e,n){return this.consumeInternal(e,1,n)}CONSUME2(e,n){return this.consumeInternal(e,2,n)}CONSUME3(e,n){return this.consumeInternal(e,3,n)}CONSUME4(e,n){return this.consumeInternal(e,4,n)}CONSUME5(e,n){return this.consumeInternal(e,5,n)}CONSUME6(e,n){return this.consumeInternal(e,6,n)}CONSUME7(e,n){return this.consumeInternal(e,7,n)}CONSUME8(e,n){return this.consumeInternal(e,8,n)}CONSUME9(e,n){return this.consumeInternal(e,9,n)}SUBRULE(e,n){return this.subruleInternal(e,0,n)}SUBRULE1(e,n){return this.subruleInternal(e,1,n)}SUBRULE2(e,n){return this.subruleInternal(e,2,n)}SUBRULE3(e,n){return this.subruleInternal(e,3,n)}SUBRULE4(e,n){return this.subruleInternal(e,4,n)}SUBRULE5(e,n){return this.subruleInternal(e,5,n)}SUBRULE6(e,n){return this.subruleInternal(e,6,n)}SUBRULE7(e,n){return this.subruleInternal(e,7,n)}SUBRULE8(e,n){return this.subruleInternal(e,8,n)}SUBRULE9(e,n){return this.subruleInternal(e,9,n)}OPTION(e){return this.optionInternal(e,0)}OPTION1(e){return this.optionInternal(e,1)}OPTION2(e){return this.optionInternal(e,2)}OPTION3(e){return this.optionInternal(e,3)}OPTION4(e){return this.optionInternal(e,4)}OPTION5(e){return this.optionInternal(e,5)}OPTION6(e){return this.optionInternal(e,6)}OPTION7(e){return this.optionInternal(e,7)}OPTION8(e){return this.optionInternal(e,8)}OPTION9(e){return this.optionInternal(e,9)}OR(e){return this.orInternal(e,0)}OR1(e){return this.orInternal(e,1)}OR2(e){return this.orInternal(e,2)}OR3(e){return this.orInternal(e,3)}OR4(e){return this.orInternal(e,4)}OR5(e){return this.orInternal(e,5)}OR6(e){return this.orInternal(e,6)}OR7(e){return this.orInternal(e,7)}OR8(e){return this.orInternal(e,8)}OR9(e){return this.orInternal(e,9)}MANY(e){this.manyInternal(0,e)}MANY1(e){this.manyInternal(1,e)}MANY2(e){this.manyInternal(2,e)}MANY3(e){this.manyInternal(3,e)}MANY4(e){this.manyInternal(4,e)}MANY5(e){this.manyInternal(5,e)}MANY6(e){this.manyInternal(6,e)}MANY7(e){this.manyInternal(7,e)}MANY8(e){this.manyInternal(8,e)}MANY9(e){this.manyInternal(9,e)}MANY_SEP(e){this.manySepFirstInternal(0,e)}MANY_SEP1(e){this.manySepFirstInternal(1,e)}MANY_SEP2(e){this.manySepFirstInternal(2,e)}MANY_SEP3(e){this.manySepFirstInternal(3,e)}MANY_SEP4(e){this.manySepFirstInternal(4,e)}MANY_SEP5(e){this.manySepFirstInternal(5,e)}MANY_SEP6(e){this.manySepFirstInternal(6,e)}MANY_SEP7(e){this.manySepFirstInternal(7,e)}MANY_SEP8(e){this.manySepFirstInternal(8,e)}MANY_SEP9(e){this.manySepFirstInternal(9,e)}AT_LEAST_ONE(e){this.atLeastOneInternal(0,e)}AT_LEAST_ONE1(e){return this.atLeastOneInternal(1,e)}AT_LEAST_ONE2(e){this.atLeastOneInternal(2,e)}AT_LEAST_ONE3(e){this.atLeastOneInternal(3,e)}AT_LEAST_ONE4(e){this.atLeastOneInternal(4,e)}AT_LEAST_ONE5(e){this.atLeastOneInternal(5,e)}AT_LEAST_ONE6(e){this.atLeastOneInternal(6,e)}AT_LEAST_ONE7(e){this.atLeastOneInternal(7,e)}AT_LEAST_ONE8(e){this.atLeastOneInternal(8,e)}AT_LEAST_ONE9(e){this.atLeastOneInternal(9,e)}AT_LEAST_ONE_SEP(e){this.atLeastOneSepFirstInternal(0,e)}AT_LEAST_ONE_SEP1(e){this.atLeastOneSepFirstInternal(1,e)}AT_LEAST_ONE_SEP2(e){this.atLeastOneSepFirstInternal(2,e)}AT_LEAST_ONE_SEP3(e){this.atLeastOneSepFirstInternal(3,e)}AT_LEAST_ONE_SEP4(e){this.atLeastOneSepFirstInternal(4,e)}AT_LEAST_ONE_SEP5(e){this.atLeastOneSepFirstInternal(5,e)}AT_LEAST_ONE_SEP6(e){this.atLeastOneSepFirstInternal(6,e)}AT_LEAST_ONE_SEP7(e){this.atLeastOneSepFirstInternal(7,e)}AT_LEAST_ONE_SEP8(e){this.atLeastOneSepFirstInternal(8,e)}AT_LEAST_ONE_SEP9(e){this.atLeastOneSepFirstInternal(9,e)}RULE(e,n,i=N3){if(Eh(this.definedRulesNames,e)){const a={message:TT.buildDuplicateRuleNameError({topLevelRule:e,grammarName:this.className}),type:gh.DUPLICATE_RULE_NAME,ruleName:e};this.definitionErrors.push(a)}this.definedRulesNames.push(e);const r=this.defineRule(e,n,i);return this[e]=r,r}OVERRIDE_RULE(e,n,i=N3){const r=qqe(e,this.definedRulesNames,this.className);this.definitionErrors=this.definitionErrors.concat(r);const s=this.defineRule(e,n,i);return this[e]=s,s}BACKTRACK(e,n){return function(){this.isBackTrackingStack.push(1);const i=this.saveRecogState();try{return e.apply(this,n),!0}catch(r){if(R3(r))return!1;throw r}finally{this.reloadRecogState(i),this.isBackTrackingStack.pop()}}}getGAstProductions(){return this.gastProductionsCache}getSerializedGastProductions(){return wGe(_c(this.gastProductionsCache))}}class x$e{initRecognizerEngine(e,n){if(this.className=this.constructor.name,this.shortRuleNameToFull={},this.fullRuleNameToShort={},this.ruleShortNameIdx=256,this.tokenMatcher=A3,this.subruleIdx=0,this.definedRulesNames=[],this.tokensMap={},this.isBackTrackingStack=[],this.RULE_STACK=[],this.RULE_OCCURRENCE_STACK=[],this.gastProductionsCache={},xi(n,"serializedGrammar"))throw Error(`The Parser's configuration can no longer contain a <serializedGrammar> property.
	See: https://chevrotain.io/docs/changes/BREAKING_CHANGES.html#_6-0-0
	For Further details.`);if(Yr(e)){if(ha(e))throw Error(`A Token Vocabulary cannot be empty.
	Note that the first argument for the parser constructor
	is no longer a Token vector (since v4.0).`);if(typeof e[0].startOffset=="number")throw Error(`The Parser constructor no longer accepts a token vector as the first argument.
	See: https://chevrotain.io/docs/changes/BREAKING_CHANGES.html#_4-0-0
	For Further details.`)}if(Yr(e))this.tokensMap=gd(e,(s,a)=>(s[a.name]=a,s),{});else if(xi(e,"modes")&&wm(ld(_c(e.modes)),yqe)){const s=ld(_c(e.modes)),a=l4(s);this.tokensMap=gd(a,(o,c)=>(o[c.name]=c,o),{})}else if(wp(e))this.tokensMap=Zl(e);else throw new Error("<tokensDictionary> argument must be An Array of Token constructors, A dictionary of Token constructors or an IMultiModeLexerDefinition");this.tokensMap.EOF=d1;const i=xi(e,"modes")?ld(_c(e.modes)):_c(e),r=wm(i,s=>ha(s.categoryMatches));this.tokenMatcher=r?A3:vk,_k(_c(this.tokensMap))}defineRule(e,n,i){if(this.selfAnalysisDone)throw Error(`Grammar rule <${e}> may not be defined after the 'performSelfAnalysis' method has been called'
Make sure that all grammar rule definitions are done before 'performSelfAnalysis' is called.`);const r=xi(i,"resyncEnabled")?i.resyncEnabled:N3.resyncEnabled,s=xi(i,"recoveryValueFunc")?i.recoveryValueFunc:N3.recoveryValueFunc,a=this.ruleShortNameIdx<<c$e+LE;this.ruleShortNameIdx++,this.shortRuleNameToFull[a]=e,this.fullRuleNameToShort[e]=a;let o;return this.outputCst===!0?o=function(...u){try{this.ruleInvocationStateUpdate(a,e,this.subruleIdx),n.apply(this,u);const h=this.CST_STACK[this.CST_STACK.length-1];return this.cstPostRule(h),h}catch(h){return this.invokeRuleCatch(h,r,s)}finally{this.ruleFinallyStateUpdate()}}:o=function(...u){try{return this.ruleInvocationStateUpdate(a,e,this.subruleIdx),n.apply(this,u)}catch(h){return this.invokeRuleCatch(h,r,s)}finally{this.ruleFinallyStateUpdate()}},Object.assign(o,{ruleName:e,originalGrammarAction:n})}invokeRuleCatch(e,n,i){const r=this.RULE_STACK.length===1,s=n&&!this.isBackTracking()&&this.recoveryEnabled;if(R3(e)){const a=e;if(s){const o=this.findReSyncTokenType();if(this.isInCurrentRuleReSyncSet(o))if(a.resyncedTokens=this.reSyncTo(o),this.outputCst){const c=this.CST_STACK[this.CST_STACK.length-1];return c.recoveredNode=!0,c}else return i(e);else{if(this.outputCst){const c=this.CST_STACK[this.CST_STACK.length-1];c.recoveredNode=!0,a.partialCstResult=c}throw a}}else{if(r)return this.moveToTerminatedState(),i(e);throw a}}else throw e}optionInternal(e,n){const i=this.getKeyForAutomaticLookahead(Zge,n);return this.optionInternalLogic(e,n,i)}optionInternalLogic(e,n,i){let r=this.getLaFuncFromCache(i),s;if(typeof e!="function"){s=e.DEF;const a=e.GATE;if(a!==void 0){const o=r;r=()=>a.call(this)&&o.call(this)}}else s=e;if(r.call(this)===!0)return s.call(this)}atLeastOneInternal(e,n){const i=this.getKeyForAutomaticLookahead(Vq,e);return this.atLeastOneInternalLogic(e,n,i)}atLeastOneInternalLogic(e,n,i){let r=this.getLaFuncFromCache(i),s;if(typeof n!="function"){s=n.DEF;const a=n.GATE;if(a!==void 0){const o=r;r=()=>a.call(this)&&o.call(this)}}else s=n;if(r.call(this)===!0){let a=this.doSingleRepetition(s);for(;r.call(this)===!0&&a===!0;)a=this.doSingleRepetition(s)}else throw this.raiseEarlyExitException(e,Mo.REPETITION_MANDATORY,n.ERR_MSG);this.attemptInRepetitionRecovery(this.atLeastOneInternal,[e,n],r,Vq,e,Oqe)}atLeastOneSepFirstInternal(e,n){const i=this.getKeyForAutomaticLookahead(aL,e);this.atLeastOneSepFirstInternalLogic(e,n,i)}atLeastOneSepFirstInternalLogic(e,n,i){const r=n.DEF,s=n.SEP;if(this.getLaFuncFromCache(i).call(this)===!0){r.call(this);const o=()=>this.tokenMatcher(this.LA(1),s);for(;this.tokenMatcher(this.LA(1),s)===!0;)this.CONSUME(s),r.call(this);this.attemptInRepetitionRecovery(this.repetitionSepSecondInternal,[e,s,o,r,cie],o,aL,e,cie)}else throw this.raiseEarlyExitException(e,Mo.REPETITION_MANDATORY_WITH_SEPARATOR,n.ERR_MSG)}manyInternal(e,n){const i=this.getKeyForAutomaticLookahead(Hq,e);return this.manyInternalLogic(e,n,i)}manyInternalLogic(e,n,i){let r=this.getLaFuncFromCache(i),s;if(typeof n!="function"){s=n.DEF;const o=n.GATE;if(o!==void 0){const c=r;r=()=>o.call(this)&&c.call(this)}}else s=n;let a=!0;for(;r.call(this)===!0&&a===!0;)a=this.doSingleRepetition(s);this.attemptInRepetitionRecovery(this.manyInternal,[e,n],r,Hq,e,Mqe,a)}manySepFirstInternal(e,n){const i=this.getKeyForAutomaticLookahead(Gq,e);this.manySepFirstInternalLogic(e,n,i)}manySepFirstInternalLogic(e,n,i){const r=n.DEF,s=n.SEP;if(this.getLaFuncFromCache(i).call(this)===!0){r.call(this);const o=()=>this.tokenMatcher(this.LA(1),s);for(;this.tokenMatcher(this.LA(1),s)===!0;)this.CONSUME(s),r.call(this);this.attemptInRepetitionRecovery(this.repetitionSepSecondInternal,[e,s,o,r,oie],o,Gq,e,oie)}}repetitionSepSecondInternal(e,n,i,r,s){for(;i();)this.CONSUME(n),r.call(this);this.attemptInRepetitionRecovery(this.repetitionSepSecondInternal,[e,n,i,r,s],i,aL,e,s)}doSingleRepetition(e){const n=this.getLexerPosition();return e.call(this),this.getLexerPosition()>n}orInternal(e,n){const i=this.getKeyForAutomaticLookahead(Xge,n),r=Yr(e)?e:e.DEF,a=this.getLaFuncFromCache(i).call(this,r);if(a!==void 0)return r[a].ALT.call(this);this.raiseNoAltException(n,e.ERR_MSG)}ruleFinallyStateUpdate(){if(this.RULE_STACK.pop(),this.RULE_OCCURRENCE_STACK.pop(),this.cstFinallyStateUpdate(),this.RULE_STACK.length===0&&this.isAtEndOfInput()===!1){const e=this.LA(1),n=this.errorMessageProvider.buildNotAllInputParsedMessage({firstRedundant:e,ruleName:this.getCurrRuleFullName()});this.SAVE_ERROR(new i$e(n,e))}}subruleInternal(e,n,i){let r;try{const s=i!==void 0?i.ARGS:void 0;return this.subruleIdx=n,r=e.apply(this,s),this.cstPostNonTerminal(r,i!==void 0&&i.LABEL!==void 0?i.LABEL:e.ruleName),r}catch(s){throw this.subruleInternalError(s,i,e.ruleName)}}subruleInternalError(e,n,i){throw R3(e)&&e.partialCstResult!==void 0&&(this.cstPostNonTerminal(e.partialCstResult,n!==void 0&&n.LABEL!==void 0?n.LABEL:i),delete e.partialCstResult),e}consumeInternal(e,n,i){let r;try{const s=this.LA(1);this.tokenMatcher(s,e)===!0?(this.consumeToken(),r=s):this.consumeInternalError(e,s,i)}catch(s){r=this.consumeInternalRecovery(e,n,s)}return this.cstPostTerminal(i!==void 0&&i.LABEL!==void 0?i.LABEL:e.name,r),r}consumeInternalError(e,n,i){let r;const s=this.LA(0);throw i!==void 0&&i.ERR_MSG?r=i.ERR_MSG:r=this.errorMessageProvider.buildMismatchTokenMessage({expected:e,actual:n,previous:s,ruleName:this.getCurrRuleFullName()}),this.SAVE_ERROR(new Yge(r,n,s))}consumeInternalRecovery(e,n,i){if(this.recoveryEnabled&&i.name==="MismatchedTokenException"&&!this.isBackTracking()){const r=this.getFollowsForInRuleRecovery(e,n);try{return this.tryInRuleRecovery(e,r)}catch(s){throw s.name===Kge?i:s}}else throw i}saveRecogState(){const e=this.errors,n=Zl(this.RULE_STACK);return{errors:e,lexerState:this.exportLexerState(),RULE_STACK:n,CST_STACK:this.CST_STACK}}reloadRecogState(e){this.errors=e.errors,this.importLexerState(e.lexerState),this.RULE_STACK=e.RULE_STACK}ruleInvocationStateUpdate(e,n,i){this.RULE_OCCURRENCE_STACK.push(i),this.RULE_STACK.push(e),this.cstInvocationStateUpdate(n)}isBackTracking(){return this.isBackTrackingStack.length!==0}getCurrRuleFullName(){const e=this.getLastExplicitRuleShortName();return this.shortRuleNameToFull[e]}shortRuleNameToFullName(e){return this.shortRuleNameToFull[e]}isAtEndOfInput(){return this.tokenMatcher(this.LA(1),d1)}reset(){this.resetLexerState(),this.subruleIdx=0,this.isBackTrackingStack=[],this.errors=[],this.RULE_STACK=[],this.CST_STACK=[],this.RULE_OCCURRENCE_STACK=[]}}class w$e{initErrorHandler(e){this._errors=[],this.errorMessageProvider=xi(e,"errorMessageProvider")?e.errorMessageProvider:k_.errorMessageProvider}SAVE_ERROR(e){if(R3(e))return e.context={ruleStack:this.getHumanReadableRuleStack(),ruleOccurrenceStack:Zl(this.RULE_OCCURRENCE_STACK)},this._errors.push(e),e;throw Error("Trying to save an Error which is not a RecognitionException")}get errors(){return Zl(this._errors)}set errors(e){this._errors=e}raiseEarlyExitException(e,n,i){const r=this.getCurrRuleFullName(),s=this.getGAstProductions()[r],o=SY(e,s,n,this.maxLookahead)[0],c=[];for(let u=1;u<=this.maxLookahead;u++)c.push(this.LA(u));const l=this.errorMessageProvider.buildEarlyExitMessage({expectedIterationPaths:o,actual:c,previous:this.LA(0),customUserDescription:i,ruleName:r});throw this.SAVE_ERROR(new r$e(l,this.LA(1),this.LA(0)))}raiseNoAltException(e,n){const i=this.getCurrRuleFullName(),r=this.getGAstProductions()[i],s=EY(e,r,this.maxLookahead),a=[];for(let l=1;l<=this.maxLookahead;l++)a.push(this.LA(l));const o=this.LA(0),c=this.errorMessageProvider.buildNoViableAltMessage({expectedPathsPerAlt:s,actual:a,previous:o,customUserDescription:n,ruleName:this.getCurrRuleFullName()});throw this.SAVE_ERROR(new n$e(c,this.LA(1),o))}}class C$e{initContentAssist(){}computeContentAssist(e,n){const i=this.gastProductionsCache[e];if(I_(i))throw Error(`Rule ->${e}<- does not exist in this grammar.`);return Lge([i],n,this.tokenMatcher,this.maxLookahead)}getNextPossibleTokenTypes(e){const n=Rm(e.ruleStack),r=this.getGAstProductions()[n];return new Rqe(r,e).startWalking()}}const p4={description:"This Object indicates the Parser is during Recording Phase"};Object.freeze(p4);const die=!0,fie=Math.pow(2,LE)-1,Qge=yf({name:"RECORDING_PHASE_TOKEN",pattern:Kc.NA});_k([Qge]);const e0e=yk(Qge,`This IToken indicates the Parser is in Recording Phase
	See: https://chevrotain.io/docs/guide/internals.html#grammar-recording for details`,-1,-1,-1,-1,-1,-1);Object.freeze(e0e);const A$e={name:`This CSTNode indicates the Parser is in Recording Phase
	See: https://chevrotain.io/docs/guide/internals.html#grammar-recording for details`,children:{}};class R$e{initGastRecorder(e){this.recordingProdStack=[],this.RECORDING_PHASE=!1}enableRecording(){this.RECORDING_PHASE=!0,this.TRACE_INIT("Enable Recording",()=>{for(let e=0;e<10;e++){const n=e>0?e:"";this[`CONSUME${n}`]=function(i,r){return this.consumeInternalRecord(i,e,r)},this[`SUBRULE${n}`]=function(i,r){return this.subruleInternalRecord(i,e,r)},this[`OPTION${n}`]=function(i){return this.optionInternalRecord(i,e)},this[`OR${n}`]=function(i){return this.orInternalRecord(i,e)},this[`MANY${n}`]=function(i){this.manyInternalRecord(e,i)},this[`MANY_SEP${n}`]=function(i){this.manySepFirstInternalRecord(e,i)},this[`AT_LEAST_ONE${n}`]=function(i){this.atLeastOneInternalRecord(e,i)},this[`AT_LEAST_ONE_SEP${n}`]=function(i){this.atLeastOneSepFirstInternalRecord(e,i)}}this.consume=function(e,n,i){return this.consumeInternalRecord(n,e,i)},this.subrule=function(e,n,i){return this.subruleInternalRecord(n,e,i)},this.option=function(e,n){return this.optionInternalRecord(n,e)},this.or=function(e,n){return this.orInternalRecord(n,e)},this.many=function(e,n){this.manyInternalRecord(e,n)},this.atLeastOne=function(e,n){this.atLeastOneInternalRecord(e,n)},this.ACTION=this.ACTION_RECORD,this.BACKTRACK=this.BACKTRACK_RECORD,this.LA=this.LA_RECORD})}disableRecording(){this.RECORDING_PHASE=!1,this.TRACE_INIT("Deleting Recording methods",()=>{const e=this;for(let n=0;n<10;n++){const i=n>0?n:"";delete e[`CONSUME${i}`],delete e[`SUBRULE${i}`],delete e[`OPTION${i}`],delete e[`OR${i}`],delete e[`MANY${i}`],delete e[`MANY_SEP${i}`],delete e[`AT_LEAST_ONE${i}`],delete e[`AT_LEAST_ONE_SEP${i}`]}delete e.consume,delete e.subrule,delete e.option,delete e.or,delete e.many,delete e.atLeastOne,delete e.ACTION,delete e.BACKTRACK,delete e.LA})}ACTION_RECORD(e){}BACKTRACK_RECORD(e,n){return()=>!0}LA_RECORD(e){return O3}topLevelRuleRecord(e,n){try{const i=new fR({definition:[],name:e});return i.name=e,this.recordingProdStack.push(i),n.call(this),this.recordingProdStack.pop(),i}catch(i){if(i.KNOWN_RECORDER_ERROR!==!0)try{i.message=i.message+`
	 This error was thrown during the "grammar recording phase" For more info see:
	https://chevrotain.io/docs/guide/internals.html#grammar-recording`}catch{throw i}throw i}}optionInternalRecord(e,n){return pM.call(this,ud,e,n)}atLeastOneInternalRecord(e,n){pM.call(this,T0,n,e)}atLeastOneSepFirstInternalRecord(e,n){pM.call(this,x0,n,e,die)}manyInternalRecord(e,n){pM.call(this,qc,n,e)}manySepFirstInternalRecord(e,n){pM.call(this,Um,n,e,die)}orInternalRecord(e,n){return M$e.call(this,e,n)}subruleInternalRecord(e,n,i){if(M3(n),!e||xi(e,"ruleName")===!1){const o=new Error(`<SUBRULE${pie(n)}> argument is invalid expecting a Parser method reference but got: <${JSON.stringify(e)}>
 inside top level rule: <${this.recordingProdStack[0].name}>`);throw o.KNOWN_RECORDER_ERROR=!0,o}const r=hA(this.recordingProdStack),s=e.ruleName,a=new vd({idx:n,nonTerminalName:s,label:i==null?void 0:i.LABEL,referencedRule:void 0});return r.definition.push(a),this.outputCst?A$e:p4}consumeInternalRecord(e,n,i){if(M3(n),!kge(e)){const a=new Error(`<CONSUME${pie(n)}> argument is invalid expecting a TokenType reference but got: <${JSON.stringify(e)}>
 inside top level rule: <${this.recordingProdStack[0].name}>`);throw a.KNOWN_RECORDER_ERROR=!0,a}const r=hA(this.recordingProdStack),s=new co({idx:n,terminalType:e,label:i==null?void 0:i.LABEL});return r.definition.push(s),e0e}}function pM(t,e,n,i=!1){M3(n);const r=hA(this.recordingProdStack),s=H_(e)?e:e.DEF,a=new t({definition:[],idx:n});return i&&(a.separator=e.SEP),xi(e,"MAX_LOOKAHEAD")&&(a.maxLookahead=e.MAX_LOOKAHEAD),this.recordingProdStack.push(a),s.call(this),r.definition.push(a),this.recordingProdStack.pop(),p4}function M$e(t,e){M3(e);const n=hA(this.recordingProdStack),i=Yr(t)===!1,r=i===!1?t:t.DEF,s=new Bm({definition:[],idx:e,ignoreAmbiguities:i&&t.IGNORE_AMBIGUITIES===!0});xi(t,"MAX_LOOKAHEAD")&&(s.maxLookahead=t.MAX_LOOKAHEAD);const a=_Y(r,o=>H_(o.GATE));return s.hasPredicates=a,n.definition.push(s),Ii(r,o=>{const c=new _d({definition:[]});s.definition.push(c),xi(o,"IGNORE_AMBIGUITIES")?c.ignoreAmbiguities=o.IGNORE_AMBIGUITIES:xi(o,"GATE")&&(c.ignoreAmbiguities=!0),this.recordingProdStack.push(c),o.ALT.call(this),this.recordingProdStack.pop()}),p4}function pie(t){return t===0?"":`${t}`}function M3(t){if(t<0||t>fie){const e=new Error(`Invalid DSL Method idx value: <${t}>
	Idx value must be a none negative value smaller than ${fie+1}`);throw e.KNOWN_RECORDER_ERROR=!0,e}}class O$e{initPerformanceTracer(e){if(xi(e,"traceInitPerf")){const n=e.traceInitPerf,i=typeof n=="number";this.traceInitMaxIdent=i?n:1/0,this.traceInitPerf=i?n>0:n}else this.traceInitMaxIdent=0,this.traceInitPerf=k_.traceInitPerf;this.traceInitIndent=-1}TRACE_INIT(e,n){if(this.traceInitPerf===!0){this.traceInitIndent++;const i=new Array(this.traceInitIndent+1).join("	");this.traceInitIndent<this.traceInitMaxIdent&&console.log(`${i}--> <${e}>`);const{time:r,value:s}=Tge(n),a=r>10?console.warn:console.log;return this.traceInitIndent<this.traceInitMaxIdent&&a(`${i}<-- <${e}> time: ${r}ms`),this.traceInitIndent--,s}else return n()}}function N$e(t,e){e.forEach(n=>{const i=n.prototype;Object.getOwnPropertyNames(i).forEach(r=>{if(r==="constructor")return;const s=Object.getOwnPropertyDescriptor(i,r);s&&(s.get||s.set)?Object.defineProperty(t.prototype,r,s):t.prototype[r]=n.prototype[r]})})}const O3=yk(d1,"",NaN,NaN,NaN,NaN,NaN,NaN);Object.freeze(O3);const k_=Object.freeze({recoveryEnabled:!1,maxLookahead:3,dynamicTokensEnabled:!1,outputCst:!0,errorMessageProvider:Dge,nodeLocationTracking:"none",traceInitPerf:!1,skipValidations:!1}),N3=Object.freeze({recoveryValueFunc:()=>{},resyncEnabled:!0});var gh;(function(t){t[t.INVALID_RULE_NAME=0]="INVALID_RULE_NAME",t[t.DUPLICATE_RULE_NAME=1]="DUPLICATE_RULE_NAME",t[t.INVALID_RULE_OVERRIDE=2]="INVALID_RULE_OVERRIDE",t[t.DUPLICATE_PRODUCTIONS=3]="DUPLICATE_PRODUCTIONS",t[t.UNRESOLVED_SUBRULE_REF=4]="UNRESOLVED_SUBRULE_REF",t[t.LEFT_RECURSION=5]="LEFT_RECURSION",t[t.NONE_LAST_EMPTY_ALT=6]="NONE_LAST_EMPTY_ALT",t[t.AMBIGUOUS_ALTS=7]="AMBIGUOUS_ALTS",t[t.CONFLICT_TOKENS_RULES_NAMESPACE=8]="CONFLICT_TOKENS_RULES_NAMESPACE",t[t.INVALID_TOKEN_NAME=9]="INVALID_TOKEN_NAME",t[t.NO_NON_EMPTY_LOOKAHEAD=10]="NO_NON_EMPTY_LOOKAHEAD",t[t.AMBIGUOUS_PREFIX_ALTS=11]="AMBIGUOUS_PREFIX_ALTS",t[t.TOO_MANY_ALTS=12]="TOO_MANY_ALTS",t[t.CUSTOM_LOOKAHEAD_VALIDATION=13]="CUSTOM_LOOKAHEAD_VALIDATION"})(gh||(gh={}));let xY=class t0e{static performSelfAnalysis(e){throw Error("The **static** `performSelfAnalysis` method has been deprecated.	\nUse the **instance** method with the same name instead.")}performSelfAnalysis(){this.TRACE_INIT("performSelfAnalysis",()=>{let e;this.selfAnalysisDone=!0;const n=this.className;this.TRACE_INIT("toFastProps",()=>{xge(this)}),this.TRACE_INIT("Grammar Recording",()=>{try{this.enableRecording(),Ii(this.definedRulesNames,r=>{const a=this[r].originalGrammarAction;let o;this.TRACE_INIT(`${r} Rule`,()=>{o=this.topLevelRuleRecord(r,a)}),this.gastProductionsCache[r]=o})}finally{this.disableRecording()}});let i=[];if(this.TRACE_INIT("Grammar Resolving",()=>{i=e$e({rules:_c(this.gastProductionsCache)}),this.definitionErrors=this.definitionErrors.concat(i)}),this.TRACE_INIT("Grammar Validations",()=>{if(ha(i)&&this.skipValidations===!1){const r=t$e({rules:_c(this.gastProductionsCache),tokenTypes:_c(this.tokensMap),errMsgProvider:TT,grammarName:n}),s=Fqe({lookaheadStrategy:this.lookaheadStrategy,rules:_c(this.gastProductionsCache),tokenTypes:_c(this.tokensMap),grammarName:n});this.definitionErrors=this.definitionErrors.concat(r,s)}}),ha(this.definitionErrors)&&(this.recoveryEnabled&&this.TRACE_INIT("computeAllProdsFollows",()=>{const r=IGe(_c(this.gastProductionsCache));this.resyncFollows=r}),this.TRACE_INIT("ComputeLookaheadFunctions",()=>{var r,s;(s=(r=this.lookaheadStrategy).initialize)===null||s===void 0||s.call(r,{rules:_c(this.gastProductionsCache)}),this.preComputeLookaheadFunctions(_c(this.gastProductionsCache))})),!t0e.DEFER_DEFINITION_ERRORS_HANDLING&&!ha(this.definitionErrors))throw e=Fn(this.definitionErrors,r=>r.message),new Error(`Parser Definition Errors detected:
 ${e.join(`
-------------------------------
`)}`)})}constructor(e,n){this.definitionErrors=[],this.selfAnalysisDone=!1;const i=this;if(i.initErrorHandler(n),i.initLexerAdapter(),i.initLooksAhead(n),i.initRecognizerEngine(e,n),i.initRecoverable(n),i.initTreeBuilder(n),i.initContentAssist(),i.initGastRecorder(n),i.initPerformanceTracer(n),xi(n,"ignoredIssues"))throw new Error(`The <ignoredIssues> IParserConfig property has been deprecated.
	Please use the <IGNORE_AMBIGUITIES> flag on the relevant DSL method instead.
	See: https://chevrotain.io/docs/guide/resolving_grammar_errors.html#IGNORING_AMBIGUITIES
	For further details.`);this.skipValidations=xi(n,"skipValidations")?n.skipValidations:k_.skipValidations}};xY.DEFER_DEFINITION_ERRORS_HANDLING=!1;N$e(xY,[a$e,u$e,E$e,S$e,x$e,T$e,w$e,C$e,R$e,O$e]);class I$e extends xY{constructor(e,n=k_){const i=Zl(n);i.outputCst=!0,super(e,i)}}function k$e(t){const e=new P$e,n=_c(t);return Fn(n,i=>e.visitRule(i))}class P$e extends Y1{visitRule(e){const n=this.visitEach(e.definition),i=Ege(n,s=>s.propertyName),r=Fn(i,(s,a)=>{const o=!_Y(s,l=>!l.canBeNull);let c=s[0].type;return s.length>1&&(c=Fn(s,l=>l.type)),{name:a,type:c,optional:o}});return{name:e.name,properties:r}}visitAlternative(e){return this.visitEachAndOverrideWith(e.definition,{canBeNull:!0})}visitOption(e){return this.visitEachAndOverrideWith(e.definition,{canBeNull:!0})}visitRepetition(e){return this.visitEachAndOverrideWith(e.definition,{canBeNull:!0})}visitRepetitionMandatory(e){return this.visitEach(e.definition)}visitRepetitionMandatoryWithSeparator(e){return this.visitEach(e.definition).concat({propertyName:e.separator.name,canBeNull:!0,type:YD(e.separator)})}visitRepetitionWithSeparator(e){return this.visitEachAndOverrideWith(e.definition,{canBeNull:!0}).concat({propertyName:e.separator.name,canBeNull:!0,type:YD(e.separator)})}visitAlternation(e){return this.visitEachAndOverrideWith(e.definition,{canBeNull:!0})}visitTerminal(e){return[{propertyName:e.label||e.terminalType.name,canBeNull:!1,type:YD(e)}]}visitNonTerminal(e){return[{propertyName:e.label||e.nonTerminalName,canBeNull:!1,type:YD(e)}]}visitEachAndOverrideWith(e,n){return Fn(this.visitEach(e),i=>pd({},i,n))}visitEach(e){return ld(Fn(e,n=>this.visit(n)))}}function YD(t){return t instanceof vd?{kind:"rule",name:t.referencedRule.name}:{kind:"token"}}function D$e(t,e){let n=[];return n=n.concat('import type { CstNode, ICstVisitor, IToken } from "chevrotain";'),n=n.concat(ld(Fn(t,i=>L$e(i)))),e.includeVisitorInterface&&(n=n.concat(z$e(e.visitorInterfaceName,t))),n.join(`

`)+`
`}function L$e(t){const e=U$e(t),n=B$e(t);return[e,n]}function U$e(t){const e=n0e(t.name),n=wY(t.name);return`export interface ${e} extends CstNode {
  name: "${t.name}";
  children: ${n};
}`}function B$e(t){return`export type ${wY(t.name)} = {
  ${Fn(t.properties,n=>F$e(n)).join(`
  `)}
};`}function F$e(t){const e=H$e(t.type);return`${t.name}${t.optional?"?":""}: ${e}[];`}function z$e(t,e){return`export interface ${t}<IN, OUT> extends ICstVisitor<IN, OUT> {
  ${Fn(e,n=>j$e(n)).join(`
  `)}
}`}function j$e(t){const e=wY(t.name);return`${t.name}(children: ${e}, param?: IN): OUT;`}function H$e(t){if(Yr(t)){const e=l4(Fn(t,i=>mie(i)));return"("+gd(e,(i,r)=>i+" | "+r)+")"}else return mie(t)}function mie(t){return t.kind==="token"?"IToken":n0e(t.name)}function n0e(t){return oge(t)+"CstNode"}function wY(t){return oge(t)+"CstChildren"}const V$e={includeVisitorInterface:!0,visitorInterfaceName:"ICstNodeVisitor"};function G$e(t,e){const n=Object.assign(Object.assign({},V$e),e),i=k$e(t);return D$e(i,n)}const o0=!!JSON.parse("false"),q$e=!!JSON.parse("false"),$$e=!!JSON.parse("false"),W$e=!!JSON.parse("false");JSON.parse("false");JSON.parse("false");JSON.parse("false");JSON.parse("false");const Kt={HALT_AT_COUNT:256,DRAW_CHAR_SCALE:2,DRAW_CHAR_WIDTH(){return p_*Kt.DRAW_CHAR_SCALE},DRAW_CHAR_HEIGHT(){return m_*Kt.DRAW_CHAR_SCALE}};function CY(t,e,n){typeof t!="number"&&(t=0,e=0,n=1),typeof e!="number"&&(e=t,t=0,n=1),typeof n!="number"&&(n=1);const i=[],r=Math.min(t,e),s=Math.max(t,e);for(let a=r;a<=s;a+=n)i.push(a);return i}function Y$e(t){return t[rf(0,t.length-1)]}function K$e(t,e){return e[Rpe(t,0,e.length-1)]}function io(...t){return Y$e(t.flat())}function X$e(t,...e){return K$e(t,e.flat())}function Z$e(t){return[...new Set(t)].filter(re)}function J$e(t,e){return t%e}function Q$e(t,e){return Math.floor(t/e)}function I3(t,e){return{x:J$e(t,e),y:Q$e(t,e)}}function rh(t,e){return t.x+t.y*e}function hm(t,e,n,i,r,s){return t>=s&&t<=i&&e>=n&&e<=r}function gie(t,e,n,i){const r=[],s=Math.abs(n-t),a=Math.abs(i-e),o=t<n?1:-1,c=e<i?1:-1;let l=s-a;for(r.push({x:t,y:e});t!==n||e!==i;){const u=2*l;u>-a&&(l-=a,t+=o),u<s&&(l+=s,e+=c),r.push({x:t,y:e})}return r}const e7e=66.666,AY=Math.round(1e3/e7e),t7e=3;function Kf(t){return new Promise(e=>setTimeout(e,t))}function fA(t){return re(t)&&re(t.x)&&re(t.y)}function fc(t,e){switch(e){case Yt.NORTH:--t.y;break;case Yt.SOUTH:++t.y;break;case Yt.WEST:--t.x;break;case Yt.EAST:++t.x;break}return t}function GM(t,e){return t<0?Yt.WEST:t>0?Yt.EAST:e<0?Yt.NORTH:e>0?Yt.SOUTH:Yt.IDLE}function Vv(t,e){return GM(e.x-t.x,e.y-t.y)}const i0e={idle:"IDLE",up:"NORTH",down:"SOUTH",left:"WEST",right:"EAST",by:"BY",at:"AT",flow:"FLOW",seek:"SEEK",rndns:"RNDNS",rndne:"RNDNE",rnd:"RND",cw:"CW",ccw:"CCW",opp:"OPP",rndp:"RNDP",away:"AWAY",toward:"TOWARD",player:"PLAYER",find:"FIND",flee:"FLEE",to:"TO",i:"IDLE",u:"NORTH",north:"NORTH",n:"NORTH",d:"SOUTH",south:"SOUTH",s:"SOUTH",l:"WEST",west:"WEST",w:"WEST",r:"EAST",east:"EAST",e:"EAST",over:"OVER",under:"UNDER"};function P_(t){return ji(t)&&r0e(t[0])}function r0e(t){return re(Yt[t])&&Tn(t)}function n7e(t){const e=Yt[t];return re(e)?e:Yt.IDLE}function RY(t){if(Tn(t))return i0e[Wn(t)]}function i7e(t){if(P_(t))return t;if(r0e(t))return[t];const e=RY(t);if(re(e))return[e]}function vie(t){const e=ie.words[t],n=i7e(e);return P_(n)?[n,t+1]:[void 0,t]}function s0e(t){var r,s;const e=[];let[n,i]=vie(t);for(;P_(n);){switch(e.push(...n),n[0]){case"AT":case"BY":case"AWAY":case"TOWARD":{const[c,l,u]=Rt(ie.words,i,[Ke.NUMBER,Ke.NUMBER]);e.push(c,l),i=u;break}case"FLEE":case"FIND":{const[c,l]=Rt(ie.words,i,[Ke.DIR]);e.push(c.destpt.x,c.destpt.y),i=l;break}case"TO":{const[c,l,u]=Rt(ie.words,i,[Ke.DIR,Ke.DIR]),h=((r=ie.element)==null?void 0:r.x)??0,d=((s=ie.element)==null?void 0:s.y)??0;c.destpt.x-=h,c.destpt.y-=d,l.destpt.x-=h,l.destpt.y-=d,e.push(h+c.destpt.x+l.destpt.x,d+c.destpt.y+l.destpt.y),i=u;break}}switch(n[0]){case"CW":case"CCW":case"OPP":case"RNDP":case"OVER":case"UNDER":break;default:return[e,i]}const[a,o]=vie(i);n=a,i=o}return e.length?[e,i]:[void 0,t]}function pA(t){return ji(t)&&typeof t[0]=="string"}function r7e(t){const e=ie.words[t];return Tn(e)?[e,t+1]:[void 0,t]}function _ie(t){const e=ie.words[t];if(pA(e))return[e,t+1];const[n,i]=NK(t),[r,s]=r7e(i);return Tn(r)?[[r,n],s]:[void 0,t]}function k3(t){if(!pA(t))return;const[e]=t;return e}function MY(t){if(!pA(t))return;const[,e]=t,n=re(e)?y_e(e):void 0;return re(n)?n:void 0}function a0e(t){if(!pA(t))return;const[,e]=t,n=re(e)?b_e(e):void 0;return re(n)?n:void 0}var sl={},m4={};m4.byteLength=o7e;m4.toByteArray=l7e;m4.fromByteArray=d7e;var Fg=[],Wf=[],s7e=typeof Uint8Array<"u"?Uint8Array:Array,mH="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";for(var uw=0,a7e=mH.length;uw<a7e;++uw)Fg[uw]=mH[uw],Wf[mH.charCodeAt(uw)]=uw;Wf[45]=62;Wf[95]=63;function o0e(t){var e=t.length;if(e%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var n=t.indexOf("=");n===-1&&(n=e);var i=n===e?0:4-n%4;return[n,i]}function o7e(t){var e=o0e(t),n=e[0],i=e[1];return(n+i)*3/4-i}function c7e(t,e,n){return(e+n)*3/4-n}function l7e(t){var e,n=o0e(t),i=n[0],r=n[1],s=new s7e(c7e(t,i,r)),a=0,o=r>0?i-4:i,c;for(c=0;c<o;c+=4)e=Wf[t.charCodeAt(c)]<<18|Wf[t.charCodeAt(c+1)]<<12|Wf[t.charCodeAt(c+2)]<<6|Wf[t.charCodeAt(c+3)],s[a++]=e>>16&255,s[a++]=e>>8&255,s[a++]=e&255;return r===2&&(e=Wf[t.charCodeAt(c)]<<2|Wf[t.charCodeAt(c+1)]>>4,s[a++]=e&255),r===1&&(e=Wf[t.charCodeAt(c)]<<10|Wf[t.charCodeAt(c+1)]<<4|Wf[t.charCodeAt(c+2)]>>2,s[a++]=e>>8&255,s[a++]=e&255),s}function u7e(t){return Fg[t>>18&63]+Fg[t>>12&63]+Fg[t>>6&63]+Fg[t&63]}function h7e(t,e,n){for(var i,r=[],s=e;s<n;s+=3)i=(t[s]<<16&16711680)+(t[s+1]<<8&65280)+(t[s+2]&255),r.push(u7e(i));return r.join("")}function d7e(t){for(var e,n=t.length,i=n%3,r=[],s=16383,a=0,o=n-i;a<o;a+=s)r.push(h7e(t,a,a+s>o?o:a+s));return i===1?(e=t[n-1],r.push(Fg[e>>2]+Fg[e<<4&63]+"==")):i===2&&(e=(t[n-2]<<8)+t[n-1],r.push(Fg[e>>10]+Fg[e>>4&63]+Fg[e<<2&63]+"=")),r.join("")}var OY={};/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */OY.read=function(t,e,n,i,r){var s,a,o=r*8-i-1,c=(1<<o)-1,l=c>>1,u=-7,h=n?r-1:0,d=n?-1:1,f=t[e+h];for(h+=d,s=f&(1<<-u)-1,f>>=-u,u+=o;u>0;s=s*256+t[e+h],h+=d,u-=8);for(a=s&(1<<-u)-1,s>>=-u,u+=i;u>0;a=a*256+t[e+h],h+=d,u-=8);if(s===0)s=1-l;else{if(s===c)return a?NaN:(f?-1:1)*(1/0);a=a+Math.pow(2,i),s=s-l}return(f?-1:1)*a*Math.pow(2,s-i)};OY.write=function(t,e,n,i,r,s){var a,o,c,l=s*8-r-1,u=(1<<l)-1,h=u>>1,d=r===23?Math.pow(2,-24)-Math.pow(2,-77):0,f=i?0:s-1,p=i?1:-1,g=e<0||e===0&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(o=isNaN(e)?1:0,a=u):(a=Math.floor(Math.log(e)/Math.LN2),e*(c=Math.pow(2,-a))<1&&(a--,c*=2),a+h>=1?e+=d/c:e+=d*Math.pow(2,1-h),e*c>=2&&(a++,c/=2),a+h>=u?(o=0,a=u):a+h>=1?(o=(e*c-1)*Math.pow(2,r),a=a+h):(o=e*Math.pow(2,h-1)*Math.pow(2,r),a=0));r>=8;t[n+f]=o&255,f+=p,o/=256,r-=8);for(a=a<<r|o,l+=r;l>0;t[n+f]=a&255,f+=p,a/=256,l-=8);t[n+f-p]|=g*128};/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */(function(t){const e=m4,n=OY,i=typeof Symbol=="function"&&typeof Symbol.for=="function"?Symbol.for("nodejs.util.inspect.custom"):null;t.Buffer=u,t.SlowBuffer=M,t.INSPECT_MAX_BYTES=50;const r=2147483647;t.kMaxLength=r;const{Uint8Array:s,ArrayBuffer:a,SharedArrayBuffer:o}=globalThis;u.TYPED_ARRAY_SUPPORT=c(),!u.TYPED_ARRAY_SUPPORT&&typeof console<"u"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function c(){try{const le=new s(1),z={foo:function(){return 42}};return Object.setPrototypeOf(z,s.prototype),Object.setPrototypeOf(le,z),le.foo()===42}catch{return!1}}Object.defineProperty(u.prototype,"parent",{enumerable:!0,get:function(){if(u.isBuffer(this))return this.buffer}}),Object.defineProperty(u.prototype,"offset",{enumerable:!0,get:function(){if(u.isBuffer(this))return this.byteOffset}});function l(le){if(le>r)throw new RangeError('The value "'+le+'" is invalid for option "size"');const z=new s(le);return Object.setPrototypeOf(z,u.prototype),z}function u(le,z,W){if(typeof le=="number"){if(typeof z=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return p(le)}return h(le,z,W)}u.poolSize=8192;function h(le,z,W){if(typeof le=="string")return g(le,z);if(a.isView(le))return v(le);if(le==null)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof le);if(Et(le,a)||le&&Et(le.buffer,a)||typeof o<"u"&&(Et(le,o)||le&&Et(le.buffer,o)))return b(le,z,W);if(typeof le=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');const fe=le.valueOf&&le.valueOf();if(fe!=null&&fe!==le)return u.from(fe,z,W);const Ne=S(le);if(Ne)return Ne;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof le[Symbol.toPrimitive]=="function")return u.from(le[Symbol.toPrimitive]("string"),z,W);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof le)}u.from=function(le,z,W){return h(le,z,W)},Object.setPrototypeOf(u.prototype,s.prototype),Object.setPrototypeOf(u,s);function d(le){if(typeof le!="number")throw new TypeError('"size" argument must be of type number');if(le<0)throw new RangeError('The value "'+le+'" is invalid for option "size"')}function f(le,z,W){return d(le),le<=0?l(le):z!==void 0?typeof W=="string"?l(le).fill(z,W):l(le).fill(z):l(le)}u.alloc=function(le,z,W){return f(le,z,W)};function p(le){return d(le),l(le<0?0:x(le)|0)}u.allocUnsafe=function(le){return p(le)},u.allocUnsafeSlow=function(le){return p(le)};function g(le,z){if((typeof z!="string"||z==="")&&(z="utf8"),!u.isEncoding(z))throw new TypeError("Unknown encoding: "+z);const W=R(le,z)|0;let fe=l(W);const Ne=fe.write(le,z);return Ne!==W&&(fe=fe.slice(0,Ne)),fe}function _(le){const z=le.length<0?0:x(le.length)|0,W=l(z);for(let fe=0;fe<z;fe+=1)W[fe]=le[fe]&255;return W}function v(le){if(Et(le,s)){const z=new s(le);return b(z.buffer,z.byteOffset,z.byteLength)}return _(le)}function b(le,z,W){if(z<0||le.byteLength<z)throw new RangeError('"offset" is outside of buffer bounds');if(le.byteLength<z+(W||0))throw new RangeError('"length" is outside of buffer bounds');let fe;return z===void 0&&W===void 0?fe=new s(le):W===void 0?fe=new s(le,z):fe=new s(le,z,W),Object.setPrototypeOf(fe,u.prototype),fe}function S(le){if(u.isBuffer(le)){const z=x(le.length)|0,W=l(z);return W.length===0||le.copy(W,0,0,z),W}if(le.length!==void 0)return typeof le.length!="number"||ct(le.length)?l(0):_(le);if(le.type==="Buffer"&&Array.isArray(le.data))return _(le.data)}function x(le){if(le>=r)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+r.toString(16)+" bytes");return le|0}function M(le){return+le!=le&&(le=0),u.alloc(+le)}u.isBuffer=function(z){return z!=null&&z._isBuffer===!0&&z!==u.prototype},u.compare=function(z,W){if(Et(z,s)&&(z=u.from(z,z.offset,z.byteLength)),Et(W,s)&&(W=u.from(W,W.offset,W.byteLength)),!u.isBuffer(z)||!u.isBuffer(W))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(z===W)return 0;let fe=z.length,Ne=W.length;for(let Be=0,tt=Math.min(fe,Ne);Be<tt;++Be)if(z[Be]!==W[Be]){fe=z[Be],Ne=W[Be];break}return fe<Ne?-1:Ne<fe?1:0},u.isEncoding=function(z){switch(String(z).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},u.concat=function(z,W){if(!Array.isArray(z))throw new TypeError('"list" argument must be an Array of Buffers');if(z.length===0)return u.alloc(0);let fe;if(W===void 0)for(W=0,fe=0;fe<z.length;++fe)W+=z[fe].length;const Ne=u.allocUnsafe(W);let Be=0;for(fe=0;fe<z.length;++fe){let tt=z[fe];if(Et(tt,s))Be+tt.length>Ne.length?(u.isBuffer(tt)||(tt=u.from(tt)),tt.copy(Ne,Be)):s.prototype.set.call(Ne,tt,Be);else if(u.isBuffer(tt))tt.copy(Ne,Be);else throw new TypeError('"list" argument must be an Array of Buffers');Be+=tt.length}return Ne};function R(le,z){if(u.isBuffer(le))return le.length;if(a.isView(le)||Et(le,a))return le.byteLength;if(typeof le!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof le);const W=le.length,fe=arguments.length>2&&arguments[2]===!0;if(!fe&&W===0)return 0;let Ne=!1;for(;;)switch(z){case"ascii":case"latin1":case"binary":return W;case"utf8":case"utf-8":return bt(le).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return W*2;case"hex":return W>>>1;case"base64":return $e(le).length;default:if(Ne)return fe?-1:bt(le).length;z=(""+z).toLowerCase(),Ne=!0}}u.byteLength=R;function I(le,z,W){let fe=!1;if((z===void 0||z<0)&&(z=0),z>this.length||((W===void 0||W>this.length)&&(W=this.length),W<=0)||(W>>>=0,z>>>=0,W<=z))return"";for(le||(le="utf8");;)switch(le){case"hex":return Me(this,z,W);case"utf8":case"utf-8":return J(this,z,W);case"ascii":return ae(this,z,W);case"latin1":case"binary":return ce(this,z,W);case"base64":return G(this,z,W);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return Fe(this,z,W);default:if(fe)throw new TypeError("Unknown encoding: "+le);le=(le+"").toLowerCase(),fe=!0}}u.prototype._isBuffer=!0;function k(le,z,W){const fe=le[z];le[z]=le[W],le[W]=fe}u.prototype.swap16=function(){const z=this.length;if(z%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let W=0;W<z;W+=2)k(this,W,W+1);return this},u.prototype.swap32=function(){const z=this.length;if(z%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let W=0;W<z;W+=4)k(this,W,W+3),k(this,W+1,W+2);return this},u.prototype.swap64=function(){const z=this.length;if(z%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let W=0;W<z;W+=8)k(this,W,W+7),k(this,W+1,W+6),k(this,W+2,W+5),k(this,W+3,W+4);return this},u.prototype.toString=function(){const z=this.length;return z===0?"":arguments.length===0?J(this,0,z):I.apply(this,arguments)},u.prototype.toLocaleString=u.prototype.toString,u.prototype.equals=function(z){if(!u.isBuffer(z))throw new TypeError("Argument must be a Buffer");return this===z?!0:u.compare(this,z)===0},u.prototype.inspect=function(){let z="";const W=t.INSPECT_MAX_BYTES;return z=this.toString("hex",0,W).replace(/(.{2})/g,"$1 ").trim(),this.length>W&&(z+=" ... "),"<Buffer "+z+">"},i&&(u.prototype[i]=u.prototype.inspect),u.prototype.compare=function(z,W,fe,Ne,Be){if(Et(z,s)&&(z=u.from(z,z.offset,z.byteLength)),!u.isBuffer(z))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof z);if(W===void 0&&(W=0),fe===void 0&&(fe=z?z.length:0),Ne===void 0&&(Ne=0),Be===void 0&&(Be=this.length),W<0||fe>z.length||Ne<0||Be>this.length)throw new RangeError("out of range index");if(Ne>=Be&&W>=fe)return 0;if(Ne>=Be)return-1;if(W>=fe)return 1;if(W>>>=0,fe>>>=0,Ne>>>=0,Be>>>=0,this===z)return 0;let tt=Be-Ne,Tt=fe-W;const Cn=Math.min(tt,Tt),je=this.slice(Ne,Be),zt=z.slice(W,fe);for(let ht=0;ht<Cn;++ht)if(je[ht]!==zt[ht]){tt=je[ht],Tt=zt[ht];break}return tt<Tt?-1:Tt<tt?1:0};function P(le,z,W,fe,Ne){if(le.length===0)return-1;if(typeof W=="string"?(fe=W,W=0):W>2147483647?W=2147483647:W<-2147483648&&(W=-2147483648),W=+W,ct(W)&&(W=Ne?0:le.length-1),W<0&&(W=le.length+W),W>=le.length){if(Ne)return-1;W=le.length-1}else if(W<0)if(Ne)W=0;else return-1;if(typeof z=="string"&&(z=u.from(z,fe)),u.isBuffer(z))return z.length===0?-1:U(le,z,W,fe,Ne);if(typeof z=="number")return z=z&255,typeof s.prototype.indexOf=="function"?Ne?s.prototype.indexOf.call(le,z,W):s.prototype.lastIndexOf.call(le,z,W):U(le,[z],W,fe,Ne);throw new TypeError("val must be string, number or Buffer")}function U(le,z,W,fe,Ne){let Be=1,tt=le.length,Tt=z.length;if(fe!==void 0&&(fe=String(fe).toLowerCase(),fe==="ucs2"||fe==="ucs-2"||fe==="utf16le"||fe==="utf-16le")){if(le.length<2||z.length<2)return-1;Be=2,tt/=2,Tt/=2,W/=2}function Cn(zt,ht){return Be===1?zt[ht]:zt.readUInt16BE(ht*Be)}let je;if(Ne){let zt=-1;for(je=W;je<tt;je++)if(Cn(le,je)===Cn(z,zt===-1?0:je-zt)){if(zt===-1&&(zt=je),je-zt+1===Tt)return zt*Be}else zt!==-1&&(je-=je-zt),zt=-1}else for(W+Tt>tt&&(W=tt-Tt),je=W;je>=0;je--){let zt=!0;for(let ht=0;ht<Tt;ht++)if(Cn(le,je+ht)!==Cn(z,ht)){zt=!1;break}if(zt)return je}return-1}u.prototype.includes=function(z,W,fe){return this.indexOf(z,W,fe)!==-1},u.prototype.indexOf=function(z,W,fe){return P(this,z,W,fe,!0)},u.prototype.lastIndexOf=function(z,W,fe){return P(this,z,W,fe,!1)};function V(le,z,W,fe){W=Number(W)||0;const Ne=le.length-W;fe?(fe=Number(fe),fe>Ne&&(fe=Ne)):fe=Ne;const Be=z.length;fe>Be/2&&(fe=Be/2);let tt;for(tt=0;tt<fe;++tt){const Tt=parseInt(z.substr(tt*2,2),16);if(ct(Tt))return tt;le[W+tt]=Tt}return tt}function $(le,z,W,fe){return et(bt(z,le.length-W),le,W,fe)}function q(le,z,W,fe){return et(we(z),le,W,fe)}function Y(le,z,W,fe){return et($e(z),le,W,fe)}function te(le,z,W,fe){return et(he(z,le.length-W),le,W,fe)}u.prototype.write=function(z,W,fe,Ne){if(W===void 0)Ne="utf8",fe=this.length,W=0;else if(fe===void 0&&typeof W=="string")Ne=W,fe=this.length,W=0;else if(isFinite(W))W=W>>>0,isFinite(fe)?(fe=fe>>>0,Ne===void 0&&(Ne="utf8")):(Ne=fe,fe=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");const Be=this.length-W;if((fe===void 0||fe>Be)&&(fe=Be),z.length>0&&(fe<0||W<0)||W>this.length)throw new RangeError("Attempt to write outside buffer bounds");Ne||(Ne="utf8");let tt=!1;for(;;)switch(Ne){case"hex":return V(this,z,W,fe);case"utf8":case"utf-8":return $(this,z,W,fe);case"ascii":case"latin1":case"binary":return q(this,z,W,fe);case"base64":return Y(this,z,W,fe);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return te(this,z,W,fe);default:if(tt)throw new TypeError("Unknown encoding: "+Ne);Ne=(""+Ne).toLowerCase(),tt=!0}},u.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function G(le,z,W){return z===0&&W===le.length?e.fromByteArray(le):e.fromByteArray(le.slice(z,W))}function J(le,z,W){W=Math.min(le.length,W);const fe=[];let Ne=z;for(;Ne<W;){const Be=le[Ne];let tt=null,Tt=Be>239?4:Be>223?3:Be>191?2:1;if(Ne+Tt<=W){let Cn,je,zt,ht;switch(Tt){case 1:Be<128&&(tt=Be);break;case 2:Cn=le[Ne+1],(Cn&192)===128&&(ht=(Be&31)<<6|Cn&63,ht>127&&(tt=ht));break;case 3:Cn=le[Ne+1],je=le[Ne+2],(Cn&192)===128&&(je&192)===128&&(ht=(Be&15)<<12|(Cn&63)<<6|je&63,ht>2047&&(ht<55296||ht>57343)&&(tt=ht));break;case 4:Cn=le[Ne+1],je=le[Ne+2],zt=le[Ne+3],(Cn&192)===128&&(je&192)===128&&(zt&192)===128&&(ht=(Be&15)<<18|(Cn&63)<<12|(je&63)<<6|zt&63,ht>65535&&ht<1114112&&(tt=ht))}}tt===null?(tt=65533,Tt=1):tt>65535&&(tt-=65536,fe.push(tt>>>10&1023|55296),tt=56320|tt&1023),fe.push(tt),Ne+=Tt}return X(fe)}const K=4096;function X(le){const z=le.length;if(z<=K)return String.fromCharCode.apply(String,le);let W="",fe=0;for(;fe<z;)W+=String.fromCharCode.apply(String,le.slice(fe,fe+=K));return W}function ae(le,z,W){let fe="";W=Math.min(le.length,W);for(let Ne=z;Ne<W;++Ne)fe+=String.fromCharCode(le[Ne]&127);return fe}function ce(le,z,W){let fe="";W=Math.min(le.length,W);for(let Ne=z;Ne<W;++Ne)fe+=String.fromCharCode(le[Ne]);return fe}function Me(le,z,W){const fe=le.length;(!z||z<0)&&(z=0),(!W||W<0||W>fe)&&(W=fe);let Ne="";for(let Be=z;Be<W;++Be)Ne+=tn[le[Be]];return Ne}function Fe(le,z,W){const fe=le.slice(z,W);let Ne="";for(let Be=0;Be<fe.length-1;Be+=2)Ne+=String.fromCharCode(fe[Be]+fe[Be+1]*256);return Ne}u.prototype.slice=function(z,W){const fe=this.length;z=~~z,W=W===void 0?fe:~~W,z<0?(z+=fe,z<0&&(z=0)):z>fe&&(z=fe),W<0?(W+=fe,W<0&&(W=0)):W>fe&&(W=fe),W<z&&(W=z);const Ne=this.subarray(z,W);return Object.setPrototypeOf(Ne,u.prototype),Ne};function Te(le,z,W){if(le%1!==0||le<0)throw new RangeError("offset is not uint");if(le+z>W)throw new RangeError("Trying to access beyond buffer length")}u.prototype.readUintLE=u.prototype.readUIntLE=function(z,W,fe){z=z>>>0,W=W>>>0,fe||Te(z,W,this.length);let Ne=this[z],Be=1,tt=0;for(;++tt<W&&(Be*=256);)Ne+=this[z+tt]*Be;return Ne},u.prototype.readUintBE=u.prototype.readUIntBE=function(z,W,fe){z=z>>>0,W=W>>>0,fe||Te(z,W,this.length);let Ne=this[z+--W],Be=1;for(;W>0&&(Be*=256);)Ne+=this[z+--W]*Be;return Ne},u.prototype.readUint8=u.prototype.readUInt8=function(z,W){return z=z>>>0,W||Te(z,1,this.length),this[z]},u.prototype.readUint16LE=u.prototype.readUInt16LE=function(z,W){return z=z>>>0,W||Te(z,2,this.length),this[z]|this[z+1]<<8},u.prototype.readUint16BE=u.prototype.readUInt16BE=function(z,W){return z=z>>>0,W||Te(z,2,this.length),this[z]<<8|this[z+1]},u.prototype.readUint32LE=u.prototype.readUInt32LE=function(z,W){return z=z>>>0,W||Te(z,4,this.length),(this[z]|this[z+1]<<8|this[z+2]<<16)+this[z+3]*16777216},u.prototype.readUint32BE=u.prototype.readUInt32BE=function(z,W){return z=z>>>0,W||Te(z,4,this.length),this[z]*16777216+(this[z+1]<<16|this[z+2]<<8|this[z+3])},u.prototype.readBigUInt64LE=Ht(function(z){z=z>>>0,Le(z,"offset");const W=this[z],fe=this[z+7];(W===void 0||fe===void 0)&&rt(z,this.length-8);const Ne=W+this[++z]*2**8+this[++z]*2**16+this[++z]*2**24,Be=this[++z]+this[++z]*2**8+this[++z]*2**16+fe*2**24;return BigInt(Ne)+(BigInt(Be)<<BigInt(32))}),u.prototype.readBigUInt64BE=Ht(function(z){z=z>>>0,Le(z,"offset");const W=this[z],fe=this[z+7];(W===void 0||fe===void 0)&&rt(z,this.length-8);const Ne=W*2**24+this[++z]*2**16+this[++z]*2**8+this[++z],Be=this[++z]*2**24+this[++z]*2**16+this[++z]*2**8+fe;return(BigInt(Ne)<<BigInt(32))+BigInt(Be)}),u.prototype.readIntLE=function(z,W,fe){z=z>>>0,W=W>>>0,fe||Te(z,W,this.length);let Ne=this[z],Be=1,tt=0;for(;++tt<W&&(Be*=256);)Ne+=this[z+tt]*Be;return Be*=128,Ne>=Be&&(Ne-=Math.pow(2,8*W)),Ne},u.prototype.readIntBE=function(z,W,fe){z=z>>>0,W=W>>>0,fe||Te(z,W,this.length);let Ne=W,Be=1,tt=this[z+--Ne];for(;Ne>0&&(Be*=256);)tt+=this[z+--Ne]*Be;return Be*=128,tt>=Be&&(tt-=Math.pow(2,8*W)),tt},u.prototype.readInt8=function(z,W){return z=z>>>0,W||Te(z,1,this.length),this[z]&128?(255-this[z]+1)*-1:this[z]},u.prototype.readInt16LE=function(z,W){z=z>>>0,W||Te(z,2,this.length);const fe=this[z]|this[z+1]<<8;return fe&32768?fe|4294901760:fe},u.prototype.readInt16BE=function(z,W){z=z>>>0,W||Te(z,2,this.length);const fe=this[z+1]|this[z]<<8;return fe&32768?fe|4294901760:fe},u.prototype.readInt32LE=function(z,W){return z=z>>>0,W||Te(z,4,this.length),this[z]|this[z+1]<<8|this[z+2]<<16|this[z+3]<<24},u.prototype.readInt32BE=function(z,W){return z=z>>>0,W||Te(z,4,this.length),this[z]<<24|this[z+1]<<16|this[z+2]<<8|this[z+3]},u.prototype.readBigInt64LE=Ht(function(z){z=z>>>0,Le(z,"offset");const W=this[z],fe=this[z+7];(W===void 0||fe===void 0)&&rt(z,this.length-8);const Ne=this[z+4]+this[z+5]*2**8+this[z+6]*2**16+(fe<<24);return(BigInt(Ne)<<BigInt(32))+BigInt(W+this[++z]*2**8+this[++z]*2**16+this[++z]*2**24)}),u.prototype.readBigInt64BE=Ht(function(z){z=z>>>0,Le(z,"offset");const W=this[z],fe=this[z+7];(W===void 0||fe===void 0)&&rt(z,this.length-8);const Ne=(W<<24)+this[++z]*2**16+this[++z]*2**8+this[++z];return(BigInt(Ne)<<BigInt(32))+BigInt(this[++z]*2**24+this[++z]*2**16+this[++z]*2**8+fe)}),u.prototype.readFloatLE=function(z,W){return z=z>>>0,W||Te(z,4,this.length),n.read(this,z,!0,23,4)},u.prototype.readFloatBE=function(z,W){return z=z>>>0,W||Te(z,4,this.length),n.read(this,z,!1,23,4)},u.prototype.readDoubleLE=function(z,W){return z=z>>>0,W||Te(z,8,this.length),n.read(this,z,!0,52,8)},u.prototype.readDoubleBE=function(z,W){return z=z>>>0,W||Te(z,8,this.length),n.read(this,z,!1,52,8)};function Re(le,z,W,fe,Ne,Be){if(!u.isBuffer(le))throw new TypeError('"buffer" argument must be a Buffer instance');if(z>Ne||z<Be)throw new RangeError('"value" argument is out of bounds');if(W+fe>le.length)throw new RangeError("Index out of range")}u.prototype.writeUintLE=u.prototype.writeUIntLE=function(z,W,fe,Ne){if(z=+z,W=W>>>0,fe=fe>>>0,!Ne){const Tt=Math.pow(2,8*fe)-1;Re(this,z,W,fe,Tt,0)}let Be=1,tt=0;for(this[W]=z&255;++tt<fe&&(Be*=256);)this[W+tt]=z/Be&255;return W+fe},u.prototype.writeUintBE=u.prototype.writeUIntBE=function(z,W,fe,Ne){if(z=+z,W=W>>>0,fe=fe>>>0,!Ne){const Tt=Math.pow(2,8*fe)-1;Re(this,z,W,fe,Tt,0)}let Be=fe-1,tt=1;for(this[W+Be]=z&255;--Be>=0&&(tt*=256);)this[W+Be]=z/tt&255;return W+fe},u.prototype.writeUint8=u.prototype.writeUInt8=function(z,W,fe){return z=+z,W=W>>>0,fe||Re(this,z,W,1,255,0),this[W]=z&255,W+1},u.prototype.writeUint16LE=u.prototype.writeUInt16LE=function(z,W,fe){return z=+z,W=W>>>0,fe||Re(this,z,W,2,65535,0),this[W]=z&255,this[W+1]=z>>>8,W+2},u.prototype.writeUint16BE=u.prototype.writeUInt16BE=function(z,W,fe){return z=+z,W=W>>>0,fe||Re(this,z,W,2,65535,0),this[W]=z>>>8,this[W+1]=z&255,W+2},u.prototype.writeUint32LE=u.prototype.writeUInt32LE=function(z,W,fe){return z=+z,W=W>>>0,fe||Re(this,z,W,4,4294967295,0),this[W+3]=z>>>24,this[W+2]=z>>>16,this[W+1]=z>>>8,this[W]=z&255,W+4},u.prototype.writeUint32BE=u.prototype.writeUInt32BE=function(z,W,fe){return z=+z,W=W>>>0,fe||Re(this,z,W,4,4294967295,0),this[W]=z>>>24,this[W+1]=z>>>16,this[W+2]=z>>>8,this[W+3]=z&255,W+4};function ge(le,z,W,fe,Ne){ze(z,fe,Ne,le,W,7);let Be=Number(z&BigInt(4294967295));le[W++]=Be,Be=Be>>8,le[W++]=Be,Be=Be>>8,le[W++]=Be,Be=Be>>8,le[W++]=Be;let tt=Number(z>>BigInt(32)&BigInt(4294967295));return le[W++]=tt,tt=tt>>8,le[W++]=tt,tt=tt>>8,le[W++]=tt,tt=tt>>8,le[W++]=tt,W}function _e(le,z,W,fe,Ne){ze(z,fe,Ne,le,W,7);let Be=Number(z&BigInt(4294967295));le[W+7]=Be,Be=Be>>8,le[W+6]=Be,Be=Be>>8,le[W+5]=Be,Be=Be>>8,le[W+4]=Be;let tt=Number(z>>BigInt(32)&BigInt(4294967295));return le[W+3]=tt,tt=tt>>8,le[W+2]=tt,tt=tt>>8,le[W+1]=tt,tt=tt>>8,le[W]=tt,W+8}u.prototype.writeBigUInt64LE=Ht(function(z,W=0){return ge(this,z,W,BigInt(0),BigInt("0xffffffffffffffff"))}),u.prototype.writeBigUInt64BE=Ht(function(z,W=0){return _e(this,z,W,BigInt(0),BigInt("0xffffffffffffffff"))}),u.prototype.writeIntLE=function(z,W,fe,Ne){if(z=+z,W=W>>>0,!Ne){const Cn=Math.pow(2,8*fe-1);Re(this,z,W,fe,Cn-1,-Cn)}let Be=0,tt=1,Tt=0;for(this[W]=z&255;++Be<fe&&(tt*=256);)z<0&&Tt===0&&this[W+Be-1]!==0&&(Tt=1),this[W+Be]=(z/tt>>0)-Tt&255;return W+fe},u.prototype.writeIntBE=function(z,W,fe,Ne){if(z=+z,W=W>>>0,!Ne){const Cn=Math.pow(2,8*fe-1);Re(this,z,W,fe,Cn-1,-Cn)}let Be=fe-1,tt=1,Tt=0;for(this[W+Be]=z&255;--Be>=0&&(tt*=256);)z<0&&Tt===0&&this[W+Be+1]!==0&&(Tt=1),this[W+Be]=(z/tt>>0)-Tt&255;return W+fe},u.prototype.writeInt8=function(z,W,fe){return z=+z,W=W>>>0,fe||Re(this,z,W,1,127,-128),z<0&&(z=255+z+1),this[W]=z&255,W+1},u.prototype.writeInt16LE=function(z,W,fe){return z=+z,W=W>>>0,fe||Re(this,z,W,2,32767,-32768),this[W]=z&255,this[W+1]=z>>>8,W+2},u.prototype.writeInt16BE=function(z,W,fe){return z=+z,W=W>>>0,fe||Re(this,z,W,2,32767,-32768),this[W]=z>>>8,this[W+1]=z&255,W+2},u.prototype.writeInt32LE=function(z,W,fe){return z=+z,W=W>>>0,fe||Re(this,z,W,4,2147483647,-2147483648),this[W]=z&255,this[W+1]=z>>>8,this[W+2]=z>>>16,this[W+3]=z>>>24,W+4},u.prototype.writeInt32BE=function(z,W,fe){return z=+z,W=W>>>0,fe||Re(this,z,W,4,2147483647,-2147483648),z<0&&(z=4294967295+z+1),this[W]=z>>>24,this[W+1]=z>>>16,this[W+2]=z>>>8,this[W+3]=z&255,W+4},u.prototype.writeBigInt64LE=Ht(function(z,W=0){return ge(this,z,W,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))}),u.prototype.writeBigInt64BE=Ht(function(z,W=0){return _e(this,z,W,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))});function ke(le,z,W,fe,Ne,Be){if(W+fe>le.length)throw new RangeError("Index out of range");if(W<0)throw new RangeError("Index out of range")}function gt(le,z,W,fe,Ne){return z=+z,W=W>>>0,Ne||ke(le,z,W,4),n.write(le,z,W,fe,23,4),W+4}u.prototype.writeFloatLE=function(z,W,fe){return gt(this,z,W,!0,fe)},u.prototype.writeFloatBE=function(z,W,fe){return gt(this,z,W,!1,fe)};function wt(le,z,W,fe,Ne){return z=+z,W=W>>>0,Ne||ke(le,z,W,8),n.write(le,z,W,fe,52,8),W+8}u.prototype.writeDoubleLE=function(z,W,fe){return wt(this,z,W,!0,fe)},u.prototype.writeDoubleBE=function(z,W,fe){return wt(this,z,W,!1,fe)},u.prototype.copy=function(z,W,fe,Ne){if(!u.isBuffer(z))throw new TypeError("argument should be a Buffer");if(fe||(fe=0),!Ne&&Ne!==0&&(Ne=this.length),W>=z.length&&(W=z.length),W||(W=0),Ne>0&&Ne<fe&&(Ne=fe),Ne===fe||z.length===0||this.length===0)return 0;if(W<0)throw new RangeError("targetStart out of bounds");if(fe<0||fe>=this.length)throw new RangeError("Index out of range");if(Ne<0)throw new RangeError("sourceEnd out of bounds");Ne>this.length&&(Ne=this.length),z.length-W<Ne-fe&&(Ne=z.length-W+fe);const Be=Ne-fe;return this===z&&typeof s.prototype.copyWithin=="function"?this.copyWithin(W,fe,Ne):s.prototype.set.call(z,this.subarray(fe,Ne),W),Be},u.prototype.fill=function(z,W,fe,Ne){if(typeof z=="string"){if(typeof W=="string"?(Ne=W,W=0,fe=this.length):typeof fe=="string"&&(Ne=fe,fe=this.length),Ne!==void 0&&typeof Ne!="string")throw new TypeError("encoding must be a string");if(typeof Ne=="string"&&!u.isEncoding(Ne))throw new TypeError("Unknown encoding: "+Ne);if(z.length===1){const tt=z.charCodeAt(0);(Ne==="utf8"&&tt<128||Ne==="latin1")&&(z=tt)}}else typeof z=="number"?z=z&255:typeof z=="boolean"&&(z=Number(z));if(W<0||this.length<W||this.length<fe)throw new RangeError("Out of range index");if(fe<=W)return this;W=W>>>0,fe=fe===void 0?this.length:fe>>>0,z||(z=0);let Be;if(typeof z=="number")for(Be=W;Be<fe;++Be)this[Be]=z;else{const tt=u.isBuffer(z)?z:u.from(z,Ne),Tt=tt.length;if(Tt===0)throw new TypeError('The value "'+z+'" is invalid for argument "value"');for(Be=0;Be<fe-W;++Be)this[Be+W]=tt[Be%Tt]}return this};const ye={};function Se(le,z,W){ye[le]=class extends W{constructor(){super(),Object.defineProperty(this,"message",{value:z.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${le}]`,this.stack,delete this.name}get code(){return le}set code(Ne){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:Ne,writable:!0})}toString(){return`${this.name} [${le}]: ${this.message}`}}}Se("ERR_BUFFER_OUT_OF_BOUNDS",function(le){return le?`${le} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"},RangeError),Se("ERR_INVALID_ARG_TYPE",function(le,z){return`The "${le}" argument must be of type number. Received type ${typeof z}`},TypeError),Se("ERR_OUT_OF_RANGE",function(le,z,W){let fe=`The value of "${le}" is out of range.`,Ne=W;return Number.isInteger(W)&&Math.abs(W)>2**32?Ne=Qe(String(W)):typeof W=="bigint"&&(Ne=String(W),(W>BigInt(2)**BigInt(32)||W<-(BigInt(2)**BigInt(32)))&&(Ne=Qe(Ne)),Ne+="n"),fe+=` It must be ${z}. Received ${Ne}`,fe},RangeError);function Qe(le){let z="",W=le.length;const fe=le[0]==="-"?1:0;for(;W>=fe+4;W-=3)z=`_${le.slice(W-3,W)}${z}`;return`${le.slice(0,W)}${z}`}function pe(le,z,W){Le(z,"offset"),(le[z]===void 0||le[z+W]===void 0)&&rt(z,le.length-(W+1))}function ze(le,z,W,fe,Ne,Be){if(le>W||le<z){const tt=typeof z=="bigint"?"n":"";let Tt;throw z===0||z===BigInt(0)?Tt=`>= 0${tt} and < 2${tt} ** ${(Be+1)*8}${tt}`:Tt=`>= -(2${tt} ** ${(Be+1)*8-1}${tt}) and < 2 ** ${(Be+1)*8-1}${tt}`,new ye.ERR_OUT_OF_RANGE("value",Tt,le)}pe(fe,Ne,Be)}function Le(le,z){if(typeof le!="number")throw new ye.ERR_INVALID_ARG_TYPE(z,"number",le)}function rt(le,z,W){throw Math.floor(le)!==le?(Le(le,W),new ye.ERR_OUT_OF_RANGE("offset","an integer",le)):z<0?new ye.ERR_BUFFER_OUT_OF_BOUNDS:new ye.ERR_OUT_OF_RANGE("offset",`>= 0 and <= ${z}`,le)}const dt=/[^+/0-9A-Za-z-_]/g;function pt(le){if(le=le.split("=")[0],le=le.trim().replace(dt,""),le.length<2)return"";for(;le.length%4!==0;)le=le+"=";return le}function bt(le,z){z=z||1/0;let W;const fe=le.length;let Ne=null;const Be=[];for(let tt=0;tt<fe;++tt){if(W=le.charCodeAt(tt),W>55295&&W<57344){if(!Ne){if(W>56319){(z-=3)>-1&&Be.push(239,191,189);continue}else if(tt+1===fe){(z-=3)>-1&&Be.push(239,191,189);continue}Ne=W;continue}if(W<56320){(z-=3)>-1&&Be.push(239,191,189),Ne=W;continue}W=(Ne-55296<<10|W-56320)+65536}else Ne&&(z-=3)>-1&&Be.push(239,191,189);if(Ne=null,W<128){if((z-=1)<0)break;Be.push(W)}else if(W<2048){if((z-=2)<0)break;Be.push(W>>6|192,W&63|128)}else if(W<65536){if((z-=3)<0)break;Be.push(W>>12|224,W>>6&63|128,W&63|128)}else if(W<1114112){if((z-=4)<0)break;Be.push(W>>18|240,W>>12&63|128,W>>6&63|128,W&63|128)}else throw new Error("Invalid code point")}return Be}function we(le){const z=[];for(let W=0;W<le.length;++W)z.push(le.charCodeAt(W)&255);return z}function he(le,z){let W,fe,Ne;const Be=[];for(let tt=0;tt<le.length&&!((z-=2)<0);++tt)W=le.charCodeAt(tt),fe=W>>8,Ne=W%256,Be.push(Ne),Be.push(fe);return Be}function $e(le){return e.toByteArray(pt(le))}function et(le,z,W,fe){let Ne;for(Ne=0;Ne<fe&&!(Ne+W>=z.length||Ne>=le.length);++Ne)z[Ne+W]=le[Ne];return Ne}function Et(le,z){return le instanceof z||le!=null&&le.constructor!=null&&le.constructor.name!=null&&le.constructor.name===z.name}function ct(le){return le!==le}const tn=function(){const le="0123456789abcdef",z=new Array(256);for(let W=0;W<16;++W){const fe=W*16;for(let Ne=0;Ne<16;++Ne)z[fe+Ne]=le[W]+le[Ne]}return z}();function Ht(le){return typeof BigInt>"u"?pn:le}function pn(){throw new Error("BigInt not supported")}})(sl);const Yl=sl.Buffer,f7e=sl.Blob,p7e=sl.BlobOptions,m7e=sl.Buffer,g7e=sl.File,v7e=sl.FileOptions,_7e=sl.INSPECT_MAX_BYTES,y7e=sl.SlowBuffer,b7e=sl.TranscodeEncoding,E7e=sl.atob,S7e=sl.btoa,T7e=sl.constants,x7e=sl.isAscii,w7e=sl.isUtf8,C7e=sl.kMaxLength,A7e=sl.kStringMaxLength,R7e=sl.resolveObjectURL,M7e=sl.transcode,O7e=Object.freeze(Object.defineProperty({__proto__:null,Blob:f7e,BlobOptions:p7e,Buffer:m7e,File:g7e,FileOptions:v7e,INSPECT_MAX_BYTES:_7e,SlowBuffer:y7e,TranscodeEncoding:b7e,atob:E7e,btoa:S7e,constants:T7e,default:Yl,isAscii:x7e,isUtf8:w7e,kMaxLength:C7e,kStringMaxLength:A7e,resolveObjectURL:R7e,transcode:M7e},Symbol.toStringTag,{value:"Module"}));var $q;try{$q=new TextDecoder}catch{}var yn,sp,Je=0,la={},Fr,Ab,Xf=0,zg=0,bl,g_,yd=[],Nr,yie={useRecords:!1,mapsAsObjects:!0};class c0e{}const l0e=new c0e;l0e.name="MessagePack 0xC1";var Hb=!1,u0e=2,bie;try{new Function("")}catch{u0e=1/0}class DN{constructor(e){e&&(e.useRecords===!1&&e.mapsAsObjects===void 0&&(e.mapsAsObjects=!0),e.sequential&&e.trusted!==!1&&(e.trusted=!0,!e.structures&&e.useRecords!=!1&&(e.structures=[],e.maxSharedStructures||(e.maxSharedStructures=0))),e.structures?e.structures.sharedLength=e.structures.length:e.getStructures&&((e.structures=[]).uninitialized=!0,e.structures.sharedLength=0),e.int64AsNumber&&(e.int64AsType="number")),Object.assign(this,e)}unpack(e,n){if(yn)return g0e(()=>(Yq(),this?this.unpack(e,n):DN.prototype.unpack.call(yie,e,n)));!e.buffer&&e.constructor===ArrayBuffer&&(e=typeof Yl<"u"?Yl.from(e):new Uint8Array(e)),typeof n=="object"?(sp=n.end||e.length,Je=n.start||0):(Je=0,sp=n>-1?n:e.length),zg=0,Ab=null,bl=null,yn=e;try{Nr=e.dataView||(e.dataView=new DataView(e.buffer,e.byteOffset,e.byteLength))}catch(i){throw yn=null,e instanceof Uint8Array?i:new Error("Source must be a Uint8Array or Buffer but was a "+(e&&typeof e=="object"?e.constructor.name:typeof e))}if(this instanceof DN){if(la=this,this.structures)return Fr=this.structures,KD(n);(!Fr||Fr.length>0)&&(Fr=[])}else la=yie,(!Fr||Fr.length>0)&&(Fr=[]);return KD(n)}unpackMultiple(e,n){let i,r=0;try{Hb=!0;let s=e.length,a=this?this.unpack(e,s):g4.unpack(e,s);if(n){if(n(a,r,Je)===!1)return;for(;Je<s;)if(r=Je,n(KD(),r,Je)===!1)return}else{for(i=[a];Je<s;)r=Je,i.push(KD());return i}}catch(s){throw s.lastPosition=r,s.values=i,s}finally{Hb=!1,Yq()}}_mergeStructures(e,n){e=e||[],Object.isFrozen(e)&&(e=e.map(i=>i.slice(0)));for(let i=0,r=e.length;i<r;i++){let s=e[i];s&&(s.isShared=!0,i>=32&&(s.highByte=i-32>>5))}e.sharedLength=e.length;for(let i in n||[])if(i>=0){let r=e[i],s=n[i];s&&(r&&((e.restoreStructures||(e.restoreStructures=[]))[i]=r),e[i]=s)}return this.structures=e}decode(e,n){return this.unpack(e,n)}}function KD(t){try{if(!la.trusted&&!Hb){let n=Fr.sharedLength||0;n<Fr.length&&(Fr.length=n)}let e;if(la.randomAccessStructure&&yn[Je]<64&&yn[Je]>=32&&bie?(e=bie(yn,Je,sp,la),yn=null,!(t&&t.lazy)&&e&&(e=e.toJSON()),Je=sp):e=Wo(),bl&&(Je=bl.postBundlePosition,bl=null),Hb&&(Fr.restoreStructures=null),Je==sp)Fr&&Fr.restoreStructures&&Eie(),Fr=null,yn=null,g_&&(g_=null);else{if(Je>sp)throw new Error("Unexpected end of MessagePack data");if(!Hb){let n;try{n=JSON.stringify(e,(i,r)=>typeof r=="bigint"?`${r}n`:r).slice(0,100)}catch(i){n="(JSON view not available "+i+")"}throw new Error("Data read, but end of buffer not reached "+n)}}return e}catch(e){throw Fr&&Fr.restoreStructures&&Eie(),Yq(),(e instanceof RangeError||e.message.startsWith("Unexpected end of buffer")||Je>sp)&&(e.incomplete=!0),e}}function Eie(){for(let t in Fr.restoreStructures)Fr[t]=Fr.restoreStructures[t];Fr.restoreStructures=null}function Wo(){let t=yn[Je++];if(t<160)if(t<128){if(t<64)return t;{let e=Fr[t&63]||la.getStructures&&h0e()[t&63];return e?(e.read||(e.read=NY(e,t&63)),e.read()):t}}else if(t<144)if(t-=128,la.mapsAsObjects){let e={};for(let n=0;n<t;n++){let i=f0e();i==="__proto__"&&(i="__proto_"),e[i]=Wo()}return e}else{let e=new Map;for(let n=0;n<t;n++)e.set(Wo(),Wo());return e}else{t-=144;let e=new Array(t);for(let n=0;n<t;n++)e[n]=Wo();return la.freezeData?Object.freeze(e):e}else if(t<192){let e=t-160;if(zg>=Je)return Ab.slice(Je-Xf,(Je+=e)-Xf);if(zg==0&&sp<140){let n=e<16?IY(e):d0e(e);if(n!=null)return n}return Wq(e)}else{let e;switch(t){case 192:return null;case 193:return bl?(e=Wo(),e>0?bl[1].slice(bl.position1,bl.position1+=e):bl[0].slice(bl.position0,bl.position0-=e)):l0e;case 194:return!1;case 195:return!0;case 196:if(e=yn[Je++],e===void 0)throw new Error("Unexpected end of buffer");return gH(e);case 197:return e=Nr.getUint16(Je),Je+=2,gH(e);case 198:return e=Nr.getUint32(Je),Je+=4,gH(e);case 199:return qS(yn[Je++]);case 200:return e=Nr.getUint16(Je),Je+=2,qS(e);case 201:return e=Nr.getUint32(Je),Je+=4,qS(e);case 202:if(e=Nr.getFloat32(Je),la.useFloat32>2){let n=kY[(yn[Je]&127)<<1|yn[Je+1]>>7];return Je+=4,(n*e+(e>0?.5:-.5)>>0)/n}return Je+=4,e;case 203:return e=Nr.getFloat64(Je),Je+=8,e;case 204:return yn[Je++];case 205:return e=Nr.getUint16(Je),Je+=2,e;case 206:return e=Nr.getUint32(Je),Je+=4,e;case 207:return la.int64AsType==="number"?(e=Nr.getUint32(Je)*4294967296,e+=Nr.getUint32(Je+4)):la.int64AsType==="string"?e=Nr.getBigUint64(Je).toString():la.int64AsType==="auto"?(e=Nr.getBigUint64(Je),e<=BigInt(2)<<BigInt(52)&&(e=Number(e))):e=Nr.getBigUint64(Je),Je+=8,e;case 208:return Nr.getInt8(Je++);case 209:return e=Nr.getInt16(Je),Je+=2,e;case 210:return e=Nr.getInt32(Je),Je+=4,e;case 211:return la.int64AsType==="number"?(e=Nr.getInt32(Je)*4294967296,e+=Nr.getUint32(Je+4)):la.int64AsType==="string"?e=Nr.getBigInt64(Je).toString():la.int64AsType==="auto"?(e=Nr.getBigInt64(Je),e>=BigInt(-2)<<BigInt(52)&&e<=BigInt(2)<<BigInt(52)&&(e=Number(e))):e=Nr.getBigInt64(Je),Je+=8,e;case 212:if(e=yn[Je++],e==114)return Aie(yn[Je++]&63);{let n=yd[e];if(n)return n.read?(Je++,n.read(Wo())):n.noBuffer?(Je++,n()):n(yn.subarray(Je,++Je));throw new Error("Unknown extension "+e)}case 213:return e=yn[Je],e==114?(Je++,Aie(yn[Je++]&63,yn[Je++])):qS(2);case 214:return qS(4);case 215:return qS(8);case 216:return qS(16);case 217:return e=yn[Je++],zg>=Je?Ab.slice(Je-Xf,(Je+=e)-Xf):I7e(e);case 218:return e=Nr.getUint16(Je),Je+=2,zg>=Je?Ab.slice(Je-Xf,(Je+=e)-Xf):k7e(e);case 219:return e=Nr.getUint32(Je),Je+=4,zg>=Je?Ab.slice(Je-Xf,(Je+=e)-Xf):P7e(e);case 220:return e=Nr.getUint16(Je),Je+=2,Tie(e);case 221:return e=Nr.getUint32(Je),Je+=4,Tie(e);case 222:return e=Nr.getUint16(Je),Je+=2,xie(e);case 223:return e=Nr.getUint32(Je),Je+=4,xie(e);default:if(t>=224)return t-256;if(t===void 0){let n=new Error("Unexpected end of MessagePack data");throw n.incomplete=!0,n}throw new Error("Unknown MessagePack token "+t)}}}const N7e=/^[a-zA-Z_$][a-zA-Z\d_$]*$/;function NY(t,e){function n(){if(n.count++>u0e){let r=t.read=new Function("r","return function(){return "+(la.freezeData?"Object.freeze":"")+"({"+t.map(s=>s==="__proto__"?"__proto_:r()":N7e.test(s)?s+":r()":"["+JSON.stringify(s)+"]:r()").join(",")+"})}")(Wo);return t.highByte===0&&(t.read=Sie(e,t.read)),r()}let i={};for(let r=0,s=t.length;r<s;r++){let a=t[r];a==="__proto__"&&(a="__proto_"),i[a]=Wo()}return la.freezeData?Object.freeze(i):i}return n.count=0,t.highByte===0?Sie(e,n):n}const Sie=(t,e)=>function(){let n=yn[Je++];if(n===0)return e();let i=t<32?-(t+(n<<5)):t+(n<<5),r=Fr[i]||h0e()[i];if(!r)throw new Error("Record id is not defined for "+i);return r.read||(r.read=NY(r,t)),r.read()};function h0e(){let t=g0e(()=>(yn=null,la.getStructures()));return Fr=la._mergeStructures(t,Fr)}var Wq=bk,I7e=bk,k7e=bk,P7e=bk;function bk(t){let e;if(t<16&&(e=IY(t)))return e;if(t>64&&$q)return $q.decode(yn.subarray(Je,Je+=t));const n=Je+t,i=[];for(e="";Je<n;){const r=yn[Je++];if(!(r&128))i.push(r);else if((r&224)===192){const s=yn[Je++]&63;i.push((r&31)<<6|s)}else if((r&240)===224){const s=yn[Je++]&63,a=yn[Je++]&63;i.push((r&31)<<12|s<<6|a)}else if((r&248)===240){const s=yn[Je++]&63,a=yn[Je++]&63,o=yn[Je++]&63;let c=(r&7)<<18|s<<12|a<<6|o;c>65535&&(c-=65536,i.push(c>>>10&1023|55296),c=56320|c&1023),i.push(c)}else i.push(r);i.length>=4096&&(e+=ml.apply(String,i),i.length=0)}return i.length>0&&(e+=ml.apply(String,i)),e}function Tie(t){let e=new Array(t);for(let n=0;n<t;n++)e[n]=Wo();return la.freezeData?Object.freeze(e):e}function xie(t){if(la.mapsAsObjects){let e={};for(let n=0;n<t;n++){let i=f0e();i==="__proto__"&&(i="__proto_"),e[i]=Wo()}return e}else{let e=new Map;for(let n=0;n<t;n++)e.set(Wo(),Wo());return e}}var ml=String.fromCharCode;function d0e(t){let e=Je,n=new Array(t);for(let i=0;i<t;i++){const r=yn[Je++];if((r&128)>0){Je=e;return}n[i]=r}return ml.apply(String,n)}function IY(t){if(t<4)if(t<2){if(t===0)return"";{let e=yn[Je++];if((e&128)>1){Je-=1;return}return ml(e)}}else{let e=yn[Je++],n=yn[Je++];if((e&128)>0||(n&128)>0){Je-=2;return}if(t<3)return ml(e,n);let i=yn[Je++];if((i&128)>0){Je-=3;return}return ml(e,n,i)}else{let e=yn[Je++],n=yn[Je++],i=yn[Je++],r=yn[Je++];if((e&128)>0||(n&128)>0||(i&128)>0||(r&128)>0){Je-=4;return}if(t<6){if(t===4)return ml(e,n,i,r);{let s=yn[Je++];if((s&128)>0){Je-=5;return}return ml(e,n,i,r,s)}}else if(t<8){let s=yn[Je++],a=yn[Je++];if((s&128)>0||(a&128)>0){Je-=6;return}if(t<7)return ml(e,n,i,r,s,a);let o=yn[Je++];if((o&128)>0){Je-=7;return}return ml(e,n,i,r,s,a,o)}else{let s=yn[Je++],a=yn[Je++],o=yn[Je++],c=yn[Je++];if((s&128)>0||(a&128)>0||(o&128)>0||(c&128)>0){Je-=8;return}if(t<10){if(t===8)return ml(e,n,i,r,s,a,o,c);{let l=yn[Je++];if((l&128)>0){Je-=9;return}return ml(e,n,i,r,s,a,o,c,l)}}else if(t<12){let l=yn[Je++],u=yn[Je++];if((l&128)>0||(u&128)>0){Je-=10;return}if(t<11)return ml(e,n,i,r,s,a,o,c,l,u);let h=yn[Je++];if((h&128)>0){Je-=11;return}return ml(e,n,i,r,s,a,o,c,l,u,h)}else{let l=yn[Je++],u=yn[Je++],h=yn[Je++],d=yn[Je++];if((l&128)>0||(u&128)>0||(h&128)>0||(d&128)>0){Je-=12;return}if(t<14){if(t===12)return ml(e,n,i,r,s,a,o,c,l,u,h,d);{let f=yn[Je++];if((f&128)>0){Je-=13;return}return ml(e,n,i,r,s,a,o,c,l,u,h,d,f)}}else{let f=yn[Je++],p=yn[Je++];if((f&128)>0||(p&128)>0){Je-=14;return}if(t<15)return ml(e,n,i,r,s,a,o,c,l,u,h,d,f,p);let g=yn[Je++];if((g&128)>0){Je-=15;return}return ml(e,n,i,r,s,a,o,c,l,u,h,d,f,p,g)}}}}}function wie(){let t=yn[Je++],e;if(t<192)e=t-160;else switch(t){case 217:e=yn[Je++];break;case 218:e=Nr.getUint16(Je),Je+=2;break;case 219:e=Nr.getUint32(Je),Je+=4;break;default:throw new Error("Expected string")}return bk(e)}function gH(t){return la.copyBuffers?Uint8Array.prototype.slice.call(yn,Je,Je+=t):yn.subarray(Je,Je+=t)}function qS(t){let e=yn[Je++];if(yd[e]){let n;return yd[e](yn.subarray(Je,n=Je+=t),i=>{Je=i;try{return Wo()}finally{Je=n}})}else throw new Error("Unknown extension type "+e)}var Cie=new Array(4096);function f0e(){let t=yn[Je++];if(t>=160&&t<192){if(t=t-160,zg>=Je)return Ab.slice(Je-Xf,(Je+=t)-Xf);if(!(zg==0&&sp<180))return Wq(t)}else return Je--,p0e(Wo());let e=(t<<5^(t>1?Nr.getUint16(Je):t>0?yn[Je]:0))&4095,n=Cie[e],i=Je,r=Je+t-3,s,a=0;if(n&&n.bytes==t){for(;i<r;){if(s=Nr.getUint32(i),s!=n[a++]){i=1879048192;break}i+=4}for(r+=3;i<r;)if(s=yn[i++],s!=n[a++]){i=1879048192;break}if(i===r)return Je=i,n.string;r-=3,i=Je}for(n=[],Cie[e]=n,n.bytes=t;i<r;)s=Nr.getUint32(i),n.push(s),i+=4;for(r+=3;i<r;)s=yn[i++],n.push(s);let o=t<16?IY(t):d0e(t);return o!=null?n.string=o:n.string=Wq(t)}function p0e(t){if(typeof t=="string")return t;if(typeof t=="number"||typeof t=="boolean"||typeof t=="bigint")return t.toString();if(t==null)return t+"";throw new Error("Invalid property type for record",typeof t)}const Aie=(t,e)=>{let n=Wo().map(p0e),i=t;e!==void 0&&(t=t<32?-((e<<5)+t):(e<<5)+t,n.highByte=e);let r=Fr[t];return r&&(r.isShared||Hb)&&((Fr.restoreStructures||(Fr.restoreStructures=[]))[t]=r),Fr[t]=n,n.read=NY(n,i),n.read()};yd[0]=()=>{};yd[0].noBuffer=!0;yd[66]=t=>{let e=t.length,n=BigInt(t[0]&128?t[0]-256:t[0]);for(let i=1;i<e;i++)n<<=BigInt(8),n+=BigInt(t[i]);return n};let D7e={Error,TypeError,ReferenceError};yd[101]=()=>{let t=Wo();return(D7e[t[0]]||Error)(t[1],{cause:t[2]})};yd[105]=t=>{if(la.structuredClone===!1)throw new Error("Structured clone extension is disabled");let e=Nr.getUint32(Je-4);g_||(g_=new Map);let n=yn[Je],i;n>=144&&n<160||n==220||n==221?i=[]:i={};let r={target:i};g_.set(e,r);let s=Wo();return r.used?Object.assign(i,s):(r.target=s,s)};yd[112]=t=>{if(la.structuredClone===!1)throw new Error("Structured clone extension is disabled");let e=Nr.getUint32(Je-4),n=g_.get(e);return n.used=!0,n.target};yd[115]=()=>new Set(Wo());const m0e=["Int8","Uint8","Uint8Clamped","Int16","Uint16","Int32","Uint32","Float32","Float64","BigInt64","BigUint64"].map(t=>t+"Array");let L7e=typeof globalThis=="object"?globalThis:window;yd[116]=t=>{let e=t[0],n=m0e[e];if(!n){if(e===16){let i=new ArrayBuffer(t.length-1);return new Uint8Array(i).set(t.subarray(1)),i}throw new Error("Could not find typed array for code "+e)}return new L7e[n](Uint8Array.prototype.slice.call(t,1).buffer)};yd[120]=()=>{let t=Wo();return new RegExp(t[0],t[1])};const U7e=[];yd[98]=t=>{let e=(t[0]<<24)+(t[1]<<16)+(t[2]<<8)+t[3],n=Je;return Je+=e-t.length,bl=U7e,bl=[wie(),wie()],bl.position0=0,bl.position1=0,bl.postBundlePosition=Je,Je=n,Wo()};yd[255]=t=>t.length==4?new Date((t[0]*16777216+(t[1]<<16)+(t[2]<<8)+t[3])*1e3):t.length==8?new Date(((t[0]<<22)+(t[1]<<14)+(t[2]<<6)+(t[3]>>2))/1e6+((t[3]&3)*4294967296+t[4]*16777216+(t[5]<<16)+(t[6]<<8)+t[7])*1e3):t.length==12?new Date(((t[0]<<24)+(t[1]<<16)+(t[2]<<8)+t[3])/1e6+((t[4]&128?-281474976710656:0)+t[6]*1099511627776+t[7]*4294967296+t[8]*16777216+(t[9]<<16)+(t[10]<<8)+t[11])*1e3):new Date("invalid");function g0e(t){let e=sp,n=Je,i=Xf,r=zg,s=Ab,a=g_,o=bl,c=new Uint8Array(yn.slice(0,sp)),l=Fr,u=Fr.slice(0,Fr.length),h=la,d=Hb,f=t();return sp=e,Je=n,Xf=i,zg=r,Ab=s,g_=a,bl=o,yn=c,Hb=d,Fr=l,Fr.splice(0,Fr.length,...u),la=h,Nr=new DataView(yn.buffer,yn.byteOffset,yn.byteLength),f}function Yq(){yn=null,g_=null,Fr=null}const kY=new Array(147);for(let t=0;t<256;t++)kY[t]=+("1e"+Math.floor(45.15-t*.30103));var g4=new DN({useRecords:!1});g4.unpack;g4.unpackMultiple;g4.unpack;let B7e=new Float32Array(1);new Uint8Array(B7e.buffer,0,4);let oL;try{oL=new TextEncoder}catch{}let Kq,v0e;const v4=typeof Yl<"u",XD=v4?function(t){return Yl.allocUnsafeSlow(t)}:Uint8Array,_0e=v4?Yl:Uint8Array,Rie=v4?4294967296:2144337920;let yt,mM,aa,nt=0,eh,to=null,F7e;const z7e=21760,j7e=/[\u0080-\uFFFF]/,hw=Symbol("record-id");class H7e extends DN{constructor(e){super(e),this.offset=0;let n,i,r,s,a=_0e.prototype.utf8Write?function(q,Y){return yt.utf8Write(q,Y,yt.byteLength-Y)}:oL&&oL.encodeInto?function(q,Y){return oL.encodeInto(q,yt.subarray(Y)).written}:!1,o=this;e||(e={});let c=e&&e.sequential,l=e.structures||e.saveStructures,u=e.maxSharedStructures;if(u==null&&(u=l?32:0),u>8160)throw new Error("Maximum maxSharedStructure is 8160");e.structuredClone&&e.moreTypes==null&&(this.moreTypes=!0);let h=e.maxOwnStructures;h==null&&(h=l?32:64),!this.structures&&e.useRecords!=!1&&(this.structures=[]);let d=u>32||h+u>64,f=u+64,p=u+h+64;if(p>8256)throw new Error("Maximum maxSharedStructure + maxOwnStructure is 8192");let g=[],_=0,v=0;this.pack=this.encode=function(q,Y){if(yt||(yt=new XD(8192),aa=yt.dataView||(yt.dataView=new DataView(yt.buffer,0,8192)),nt=0),eh=yt.length-10,eh-nt<2048?(yt=new XD(yt.length),aa=yt.dataView||(yt.dataView=new DataView(yt.buffer,0,yt.length)),eh=yt.length-10,nt=0):nt=nt+7&2147483640,n=nt,Y&Y7e&&(nt+=Y&255),s=o.structuredClone?new Map:null,o.bundleStrings&&typeof q!="string"?(to=[],to.size=1/0):to=null,r=o.structures,r){r.uninitialized&&(r=o._mergeStructures(o.getStructures()));let G=r.sharedLength||0;if(G>u)throw new Error("Shared structures is larger than maximum shared structures, try increasing maxSharedStructures to "+r.sharedLength);if(!r.transitions){r.transitions=Object.create(null);for(let J=0;J<G;J++){let K=r[J];if(!K)continue;let X,ae=r.transitions;for(let ce=0,Me=K.length;ce<Me;ce++){let Fe=K[ce];X=ae[Fe],X||(X=ae[Fe]=Object.create(null)),ae=X}ae[hw]=J+64}this.lastNamedStructuresLength=G}c||(r.nextId=G+64)}i&&(i=!1);let te;try{o.randomAccessStructure&&q&&q.constructor&&q.constructor===Object?$(q):x(q);let G=to;if(to&&Nie(n,x,0),s&&s.idsToInsert){let J=s.idsToInsert.sort((ce,Me)=>ce.offset>Me.offset?1:-1),K=J.length,X=-1;for(;G&&K>0;){let ce=J[--K].offset+n;ce<G.stringsPosition+n&&X===-1&&(X=0),ce>G.position+n?X>=0&&(X+=6):(X>=0&&(aa.setUint32(G.position+n,aa.getUint32(G.position+n)+X),X=-1),G=G.previous,K++)}X>=0&&G&&aa.setUint32(G.position+n,aa.getUint32(G.position+n)+X),nt+=J.length*6,nt>eh&&P(nt),o.offset=nt;let ae=G7e(yt.subarray(n,nt),J);return s=null,ae}return o.offset=nt,Y&$7e?(yt.start=n,yt.end=nt,yt):yt.subarray(n,nt)}catch(G){throw te=G,G}finally{if(r&&(b(),i&&o.saveStructures)){let G=r.sharedLength||0,J=yt.subarray(n,nt),K=q7e(r,o);if(!te)return o.saveStructures(K,K.isCompatible)===!1?o.pack(q,Y):(o.lastNamedStructuresLength=G,yt.length>1073741824&&(yt=null),J)}yt.length>1073741824&&(yt=null),Y&W7e&&(nt=n)}};const b=()=>{v<10&&v++;let q=r.sharedLength||0;if(r.length>q&&!c&&(r.length=q),_>1e4)r.transitions=null,v=0,_=0,g.length>0&&(g=[]);else if(g.length>0&&!c){for(let Y=0,te=g.length;Y<te;Y++)g[Y][hw]=0;g=[]}},S=q=>{var Y=q.length;Y<16?yt[nt++]=144|Y:Y<65536?(yt[nt++]=220,yt[nt++]=Y>>8,yt[nt++]=Y&255):(yt[nt++]=221,aa.setUint32(nt,Y),nt+=4);for(let te=0;te<Y;te++)x(q[te])},x=q=>{nt>eh&&(yt=P(nt));var Y=typeof q,te;if(Y==="string"){let G=q.length;if(to&&G>=4&&G<4096){if((to.size+=G)>z7e){let ae,ce=(to[0]?to[0].length*3+to[1].length:0)+10;nt+ce>eh&&(yt=P(nt+ce));let Me;to.position?(Me=to,yt[nt]=200,nt+=3,yt[nt++]=98,ae=nt-n,nt+=4,Nie(n,x,0),aa.setUint16(ae+n-3,nt-n-ae)):(yt[nt++]=214,yt[nt++]=98,ae=nt-n,nt+=4),to=["",""],to.previous=Me,to.size=0,to.position=ae}let X=j7e.test(q);to[X?0:1]+=q,yt[nt++]=193,x(X?-G:G);return}let J;G<32?J=1:G<256?J=2:G<65536?J=3:J=5;let K=G*3;if(nt+K>eh&&(yt=P(nt+K)),G<64||!a){let X,ae,ce,Me=nt+J;for(X=0;X<G;X++)ae=q.charCodeAt(X),ae<128?yt[Me++]=ae:ae<2048?(yt[Me++]=ae>>6|192,yt[Me++]=ae&63|128):(ae&64512)===55296&&((ce=q.charCodeAt(X+1))&64512)===56320?(ae=65536+((ae&1023)<<10)+(ce&1023),X++,yt[Me++]=ae>>18|240,yt[Me++]=ae>>12&63|128,yt[Me++]=ae>>6&63|128,yt[Me++]=ae&63|128):(yt[Me++]=ae>>12|224,yt[Me++]=ae>>6&63|128,yt[Me++]=ae&63|128);te=Me-nt-J}else te=a(q,nt+J);te<32?yt[nt++]=160|te:te<256?(J<2&&yt.copyWithin(nt+2,nt+1,nt+1+te),yt[nt++]=217,yt[nt++]=te):te<65536?(J<3&&yt.copyWithin(nt+3,nt+2,nt+2+te),yt[nt++]=218,yt[nt++]=te>>8,yt[nt++]=te&255):(J<5&&yt.copyWithin(nt+5,nt+3,nt+3+te),yt[nt++]=219,aa.setUint32(nt,te),nt+=4),nt+=te}else if(Y==="number")if(q>>>0===q)q<32||q<128&&this.useRecords===!1||q<64&&!this.randomAccessStructure?yt[nt++]=q:q<256?(yt[nt++]=204,yt[nt++]=q):q<65536?(yt[nt++]=205,yt[nt++]=q>>8,yt[nt++]=q&255):(yt[nt++]=206,aa.setUint32(nt,q),nt+=4);else if(q>>0===q)q>=-32?yt[nt++]=256+q:q>=-128?(yt[nt++]=208,yt[nt++]=q+256):q>=-32768?(yt[nt++]=209,aa.setInt16(nt,q),nt+=2):(yt[nt++]=210,aa.setInt32(nt,q),nt+=4);else{let G;if((G=this.useFloat32)>0&&q<4294967296&&q>=-2147483648){yt[nt++]=202,aa.setFloat32(nt,q);let J;if(G<4||(J=q*kY[(yt[nt]&127)<<1|yt[nt+1]>>7])>>0===J){nt+=4;return}else nt--}yt[nt++]=203,aa.setFloat64(nt,q),nt+=8}else if(Y==="object"||Y==="function")if(!q)yt[nt++]=192;else{if(s){let J=s.get(q);if(J){if(!J.id){let K=s.idsToInsert||(s.idsToInsert=[]);J.id=K.push(J)}yt[nt++]=214,yt[nt++]=112,aa.setUint32(nt,J.id),nt+=4;return}else s.set(q,{offset:nt-n})}let G=q.constructor;if(G===Object)k(q);else if(G===Array)S(q);else if(G===Map)if(this.mapAsEmptyObject)yt[nt++]=128;else{te=q.size,te<16?yt[nt++]=128|te:te<65536?(yt[nt++]=222,yt[nt++]=te>>8,yt[nt++]=te&255):(yt[nt++]=223,aa.setUint32(nt,te),nt+=4);for(let[J,K]of q)x(J),x(K)}else{for(let J=0,K=Kq.length;J<K;J++){let X=v0e[J];if(q instanceof X){let ae=Kq[J];if(ae.write){ae.type&&(yt[nt++]=212,yt[nt++]=ae.type,yt[nt++]=0);let Re=ae.write.call(this,q);Re===q?Array.isArray(q)?S(q):k(q):x(Re);return}let ce=yt,Me=aa,Fe=nt;yt=null;let Te;try{Te=ae.pack.call(this,q,Re=>(yt=ce,ce=null,nt+=Re,nt>eh&&P(nt),{target:yt,targetView:aa,position:nt-Re}),x)}finally{ce&&(yt=ce,aa=Me,nt=Fe,eh=yt.length-10)}Te&&(Te.length+nt>eh&&P(Te.length+nt),nt=V7e(Te,yt,nt,ae.type));return}}if(Array.isArray(q))S(q);else{if(q.toJSON){const J=q.toJSON();if(J!==q)return x(J)}if(Y==="function")return x(this.writeFunction&&this.writeFunction(q));k(q)}}}else if(Y==="boolean")yt[nt++]=q?195:194;else if(Y==="bigint"){if(q<BigInt(1)<<BigInt(63)&&q>=-(BigInt(1)<<BigInt(63)))yt[nt++]=211,aa.setBigInt64(nt,q);else if(q<BigInt(1)<<BigInt(64)&&q>0)yt[nt++]=207,aa.setBigUint64(nt,q);else if(this.largeBigIntToFloat)yt[nt++]=203,aa.setFloat64(nt,Number(q));else{if(this.largeBigIntToString)return x(q.toString());if(this.useBigIntExtension&&q<BigInt(2)**BigInt(1023)&&q>-(BigInt(2)**BigInt(1023))){yt[nt++]=199,nt++,yt[nt++]=66;let G=[],J;do{let K=q&BigInt(255);J=(K&BigInt(128))===(q<BigInt(0)?BigInt(128):BigInt(0)),G.push(K),q>>=BigInt(8)}while(!((q===BigInt(0)||q===BigInt(-1))&&J));yt[nt-2]=G.length;for(let K=G.length;K>0;)yt[nt++]=Number(G[--K]);return}else throw new RangeError(q+" was too large to fit in MessagePack 64-bit integer format, use useBigIntExtension, or set largeBigIntToFloat to convert to float-64, or set largeBigIntToString to convert to string")}nt+=8}else if(Y==="undefined")this.encodeUndefinedAsNil?yt[nt++]=192:(yt[nt++]=212,yt[nt++]=0,yt[nt++]=0);else throw new Error("Unknown type: "+Y)},M=this.variableMapSize||this.coercibleKeyAsNumber||this.skipValues?q=>{let Y;if(this.skipValues){Y=[];for(let J in q)(typeof q.hasOwnProperty!="function"||q.hasOwnProperty(J))&&!this.skipValues.includes(q[J])&&Y.push(J)}else Y=Object.keys(q);let te=Y.length;te<16?yt[nt++]=128|te:te<65536?(yt[nt++]=222,yt[nt++]=te>>8,yt[nt++]=te&255):(yt[nt++]=223,aa.setUint32(nt,te),nt+=4);let G;if(this.coercibleKeyAsNumber)for(let J=0;J<te;J++){G=Y[J];let K=Number(G);x(isNaN(K)?G:K),x(q[G])}else for(let J=0;J<te;J++)x(G=Y[J]),x(q[G])}:q=>{yt[nt++]=222;let Y=nt-n;nt+=2;let te=0;for(let G in q)(typeof q.hasOwnProperty!="function"||q.hasOwnProperty(G))&&(x(G),x(q[G]),te++);if(te>65535)throw new Error('Object is too large to serialize with fast 16-bit map size, use the "variableMapSize" option to serialize this object');yt[Y+++n]=te>>8,yt[Y+n]=te&255},R=this.useRecords===!1?M:e.progressiveRecords&&!d?q=>{let Y,te=r.transitions||(r.transitions=Object.create(null)),G=nt++-n,J;for(let K in q)if(typeof q.hasOwnProperty!="function"||q.hasOwnProperty(K)){if(Y=te[K],Y)te=Y;else{let X=Object.keys(q),ae=te;te=r.transitions;let ce=0;for(let Me=0,Fe=X.length;Me<Fe;Me++){let Te=X[Me];Y=te[Te],Y||(Y=te[Te]=Object.create(null),ce++),te=Y}G+n+1==nt?(nt--,U(te,X,ce)):V(te,X,G,ce),J=!0,te=ae[K]}x(q[K])}if(!J){let K=te[hw];K?yt[G+n]=K:V(te,Object.keys(q),G,0)}}:q=>{let Y,te=r.transitions||(r.transitions=Object.create(null)),G=0;for(let K in q)(typeof q.hasOwnProperty!="function"||q.hasOwnProperty(K))&&(Y=te[K],Y||(Y=te[K]=Object.create(null),G++),te=Y);let J=te[hw];J?J>=96&&d?(yt[nt++]=((J-=96)&31)+96,yt[nt++]=J>>5):yt[nt++]=J:U(te,te.__keys__||Object.keys(q),G);for(let K in q)(typeof q.hasOwnProperty!="function"||q.hasOwnProperty(K))&&x(q[K])},I=typeof this.useRecords=="function"&&this.useRecords,k=I?q=>{I(q)?R(q):M(q)}:R,P=q=>{let Y;if(q>16777216){if(q-n>Rie)throw new Error("Packed buffer would be larger than maximum buffer size");Y=Math.min(Rie,Math.round(Math.max((q-n)*(q>67108864?1.25:2),4194304)/4096)*4096)}else Y=(Math.max(q-n<<2,yt.length-1)>>12)+1<<12;let te=new XD(Y);return aa=te.dataView||(te.dataView=new DataView(te.buffer,0,Y)),q=Math.min(q,yt.length),yt.copy?yt.copy(te,0,n,q):te.set(yt.slice(n,q)),nt-=n,n=0,eh=te.length-10,yt=te},U=(q,Y,te)=>{let G=r.nextId;G||(G=64),G<f&&this.shouldShareStructure&&!this.shouldShareStructure(Y)?(G=r.nextOwnId,G<p||(G=f),r.nextOwnId=G+1):(G>=p&&(G=f),r.nextId=G+1);let J=Y.highByte=G>=96&&d?G-96>>5:-1;q[hw]=G,q.__keys__=Y,r[G-64]=Y,G<f?(Y.isShared=!0,r.sharedLength=G-63,i=!0,J>=0?(yt[nt++]=(G&31)+96,yt[nt++]=J):yt[nt++]=G):(J>=0?(yt[nt++]=213,yt[nt++]=114,yt[nt++]=(G&31)+96,yt[nt++]=J):(yt[nt++]=212,yt[nt++]=114,yt[nt++]=G),te&&(_+=v*te),g.length>=h&&(g.shift()[hw]=0),g.push(q),x(Y))},V=(q,Y,te,G)=>{let J=yt,K=nt,X=eh,ae=n;yt=mM,nt=0,n=0,yt||(mM=yt=new XD(8192)),eh=yt.length-10,U(q,Y,G),mM=yt;let ce=nt;if(yt=J,nt=K,eh=X,n=ae,ce>1){let Me=nt+ce-1;Me>eh&&P(Me);let Fe=te+n;yt.copyWithin(Fe+ce,Fe+1,nt),yt.set(mM.slice(0,ce),Fe),nt=Me}else yt[te+n]=mM[0]},$=q=>{let Y=F7e(q,yt,n,nt,r,P,(te,G,J)=>{if(J)return i=!0;nt=G;let K=yt;return x(te),b(),K!==yt?{position:nt,targetView:aa,target:yt}:nt},this);if(Y===0)return k(q);nt=Y}}useBuffer(e){yt=e,yt.dataView||(yt.dataView=new DataView(yt.buffer,yt.byteOffset,yt.byteLength)),nt=0}set position(e){nt=e}get position(){return nt}clearSharedData(){this.structures&&(this.structures=[]),this.typedStructs&&(this.typedStructs=[])}}v0e=[Date,Set,Error,RegExp,ArrayBuffer,Object.getPrototypeOf(Uint8Array.prototype).constructor,c0e];Kq=[{pack(t,e,n){let i=t.getTime()/1e3;if((this.useTimestamp32||t.getMilliseconds()===0)&&i>=0&&i<4294967296){let{target:r,targetView:s,position:a}=e(6);r[a++]=214,r[a++]=255,s.setUint32(a,i)}else if(i>0&&i<4294967296){let{target:r,targetView:s,position:a}=e(10);r[a++]=215,r[a++]=255,s.setUint32(a,t.getMilliseconds()*4e6+(i/1e3/4294967296>>0)),s.setUint32(a+4,i)}else if(isNaN(i)){if(this.onInvalidDate)return e(0),n(this.onInvalidDate());let{target:r,targetView:s,position:a}=e(3);r[a++]=212,r[a++]=255,r[a++]=255}else{let{target:r,targetView:s,position:a}=e(15);r[a++]=199,r[a++]=12,r[a++]=255,s.setUint32(a,t.getMilliseconds()*1e6),s.setBigInt64(a+4,BigInt(Math.floor(i)))}}},{pack(t,e,n){if(this.setAsEmptyObject)return e(0),n({});let i=Array.from(t),{target:r,position:s}=e(this.moreTypes?3:0);this.moreTypes&&(r[s++]=212,r[s++]=115,r[s++]=0),n(i)}},{pack(t,e,n){let{target:i,position:r}=e(this.moreTypes?3:0);this.moreTypes&&(i[r++]=212,i[r++]=101,i[r++]=0),n([t.name,t.message,t.cause])}},{pack(t,e,n){let{target:i,position:r}=e(this.moreTypes?3:0);this.moreTypes&&(i[r++]=212,i[r++]=120,i[r++]=0),n([t.source,t.flags])}},{pack(t,e){this.moreTypes?Mie(t,16,e):Oie(v4?Yl.from(t):new Uint8Array(t),e)}},{pack(t,e){let n=t.constructor;n!==_0e&&this.moreTypes?Mie(t,m0e.indexOf(n.name),e):Oie(t,e)}},{pack(t,e){let{target:n,position:i}=e(1);n[i]=193}}];function Mie(t,e,n,i){let r=t.byteLength;if(r+1<256){var{target:s,position:a}=n(4+r);s[a++]=199,s[a++]=r+1}else if(r+1<65536){var{target:s,position:a}=n(5+r);s[a++]=200,s[a++]=r+1>>8,s[a++]=r+1&255}else{var{target:s,position:a,targetView:o}=n(7+r);s[a++]=201,o.setUint32(a,r+1),a+=4}s[a++]=116,s[a++]=e,t.buffer||(t=new Uint8Array(t)),s.set(new Uint8Array(t.buffer,t.byteOffset,t.byteLength),a)}function Oie(t,e){let n=t.byteLength;var i,r;if(n<256){var{target:i,position:r}=e(n+2);i[r++]=196,i[r++]=n}else if(n<65536){var{target:i,position:r}=e(n+3);i[r++]=197,i[r++]=n>>8,i[r++]=n&255}else{var{target:i,position:r,targetView:s}=e(n+5);i[r++]=198,s.setUint32(r,n),r+=4}i.set(t,r)}function V7e(t,e,n,i){let r=t.length;switch(r){case 1:e[n++]=212;break;case 2:e[n++]=213;break;case 4:e[n++]=214;break;case 8:e[n++]=215;break;case 16:e[n++]=216;break;default:r<256?(e[n++]=199,e[n++]=r):r<65536?(e[n++]=200,e[n++]=r>>8,e[n++]=r&255):(e[n++]=201,e[n++]=r>>24,e[n++]=r>>16&255,e[n++]=r>>8&255,e[n++]=r&255)}return e[n++]=i,e.set(t,n),n+=r,n}function G7e(t,e){let n,i=e.length*6,r=t.length-i;for(;n=e.pop();){let s=n.offset,a=n.id;t.copyWithin(s+i,s,r),i-=6;let o=s+i;t[o++]=214,t[o++]=105,t[o++]=a>>24,t[o++]=a>>16&255,t[o++]=a>>8&255,t[o++]=a&255,r=s}return t}function Nie(t,e,n){if(to.length>0){aa.setUint32(to.position+t,nt+n-to.position-t),to.stringsPosition=nt-t;let i=to;to=null,e(i[0]),e(i[1])}}function q7e(t,e){return t.isCompatible=n=>{let i=!n||(e.lastNamedStructuresLength||0)===n.length;return i||e._mergeStructures(n),i},t}let y0e=new H7e({useRecords:!1});y0e.pack;y0e.pack;const $7e=512,W7e=1024,Y7e=2048,Ye=NE("SOFTWARE");function Iie(){return{id:wo()}}function hh(t){var e;return(((e=t==null?void 0:t.id)==null?void 0:e.length)??0)>0}function LN(t,e){if(!re(t)||!d0(e))return;const{color:n,bg:i}=E_e(e);re(n)&&(t.color=n),re(i)&&(t.bg=i)}function K1(t){var e;return Wn((t==null?void 0:t.name)??((e=t==null?void 0:t.kinddata)==null?void 0:e.name)??"")}function K7e(){return new Array(kn*ur).map(()=>{})}function PY(t=ih){const e={terrain:K7e(),objects:{},id:""};return t(e)}function P3(t){return hm(t.x,t.y,0,kn-1,ur-1,0)}function f1(t,e){return!re(t)||!re(e==null?void 0:e.x)||!re(e==null?void 0:e.y)||e.x<0||e.x>=kn||e.y<0||e.y>=ur?-1:e.x+e.y*kn}function bc(t,e){const n=f1(t,e);if(n<0||!re(t==null?void 0:t.lookup))return;const i=D_(t,t.lookup[n]??"");return re(i)?i:t.terrain[n]}function mA(t,e,n){return(e>=0&&e<kn)??(n>=0&&n<ur)?t==null?void 0:t.terrain[e+n*kn]:void 0}function af(t,e){if(!re(t)||!re(e)||!re(e.x)||!re(e.y)||e.x<0||e.x>=kn||e.y<0||e.y>=ur)return;const n=ro(e),i=e.x+e.y*kn;return t.terrain[i]=n,delete t.distmaps,t.terrain[i]}function X7e(t,e){if(!re(t)||!re(e))return;const n=ro(e);return n.id=n.id??wo(),t.objects[n.id]=n,t.objects[n.id]}function Z7e(t,e,n){return af(t,{...e,kind:n})}function b0e(t,e,n,i){return X7e(t,{...e,kind:n,id:i})}function D_(t,e){if(t)return t.objects[e]}function J7e(t,e){const n=f1(t,e);if(n<0||!re(t==null?void 0:t.lookup))return;const i=D_(t,t.lookup[n]??"");if(re(i))return i}function Q7e(t,e,n){if(!re(t)||!re(e))return;const i=t.objects[n];if(re(i))return i;if(fA(e))return T0e(e,Ek(t,"player"))}function UN(t,e){const n=t??Qr.ISWALK,i=e??Qr.ISWALK;switch(n){case Qr.ISWALK:return i!==Qr.ISWALK;case Qr.ISSWIM:return i!==Qr.ISSWIM;case Qr.ISSOLID:return!0;case Qr.ISBULLET:return i!==Qr.ISWALK&&i!==Qr.ISSWIM}}function BN(t,e,n){const i=t==null?void 0:t.objects[n];if(re(i))return i;const r=Ek(t,"player");return re(e)?(e.x<0&&(e.x=rf(0,kn-1)),e.y<0&&(e.y=rf(0,ur-1)),T0e(e,r)):io(...r)}function Ek(t,e){var i,r;return[...((r=(i=t==null?void 0:t.named)==null?void 0:i[e])==null?void 0:r.values())??[]].map(s=>typeof s=="string"?t==null?void 0:t.objects[s]:t==null?void 0:t.terrain[s]).filter(re)}function eWe(t){const e=[];for(let n=0;n<ur;++n)for(let i=0;i<kn;++i){const r={x:i,y:n},s=bc(t,r);!(s!=null&&s.name)&&!(s!=null&&s.kind)&&e.push(r)}return e}function E0e(t,e){const n=k3(e),i=MY(e),r=a0e(e);return Ek(t,n??"").filter(s=>{var a,o,c;return!(re(n)&&Wn((s==null?void 0:s.name)??((a=s==null?void 0:s.kinddata)==null?void 0:a.name)??"")!==n||re(i)&&((s==null?void 0:s.color)??((o=s==null?void 0:s.kinddata)==null?void 0:o.color)??qt.WHITE)!==i||re(r)&&((s==null?void 0:s.bg)??((c=s==null?void 0:s.kinddata)==null?void 0:c.bg)??qt.BLACK)!==r)}).filter(re)}function S0e(t,e){return re(t)?e.map(n=>{var i;if(typeof n=="string"){const r=t.objects[n];if(re(r))return r;const s=Ek(t,Wn(n));if(s.length)return s}else if(fA(n)&&n.x>=0&&n.x<kn&&n.y>=0&&n.y<ur){const r=n.x+n.y*kn,s=(i=t.lookup)==null?void 0:i[r];return re(s)?t.objects[s]:t.terrain[r]}}).flat().filter(re):[]}function T0e(t,e){let n=0,i;for(let r=0;r<e.length;++r){const s=e[r];if(s){const a=t.x-(s.x??0),o=t.y-(s.y??0),c=Math.sqrt(a*a+o*o);(i===void 0||c<n)&&(n=c,i=s)}}return i}const _4=CY(32,126).map(t=>String.fromCharCode(t));function Cr(t){return yf({...t,name:`token_${t.name}`})}function UE(t,e=!1){return Cr(e?{name:t,pattern:new RegExp(t.toLowerCase(),"i"),longer_alt:Ol,group:Kc.SKIPPED}:{name:t,pattern:new RegExp(t.toLowerCase(),"i"),longer_alt:Ol})}const gA=Cr({name:"newline",line_breaks:!0,start_chars_hint:[`
`,"\r"],pattern:/\n|\r\n?/}),x0e=Cr({name:"whitespace",pattern:/ +/,group:Kc.SKIPPED}),w0e=Cr({name:"whitespace",pattern:/\s+/,line_breaks:!0,group:Kc.SKIPPED}),p1=Cr({name:"stat",pattern:/@.*/,start_chars_hint:["@"]}),Zv=Cr({name:"command",pattern:/#/,start_chars_hint:["#"]});let C0e=!1;function tWe(t,e,n){if(!C0e)return null;const[i]=n.slice(-1);if(i&&i.tokenType!==gA)return null;let r=e;for(;t[r]===" ";)r++;if("@#/?':!".includes(t[r]))return null;let s=e+1;for(;s<t.length&&t[s]!==`
`;)s++;const a=t.substring(e,s);return a.trim().length===0?null:[a]}const FN=Cr({name:"text",pattern:tWe,line_breaks:!1,start_chars_hint:_4.filter(t=>"@#/?':!".includes(t)===!1)}),zN=Cr({name:"comment",pattern:/'.*/,start_chars_hint:["'"]}),jN=Cr({name:"label",pattern:/:[^;:\n]*/,start_chars_hint:[":"]}),HN=Cr({name:"hyperlink",pattern:/!/,start_chars_hint:["!"]}),DY=Cr({name:"hyperlinktext",pattern:/;[^;\n]*/,start_chars_hint:[";"]}),Ol=Cr({name:"stringliteral",pattern:/[^-0-9"!;@#/?()\s]+[^-"!;@#/?()\s]*/,start_chars_hint:_4}),LY=Cr({name:"stringliteraldouble",pattern:/"(?:[^\\"]|\\(?:[^\n\r]|u[0-9a-fA-F]{4}))*"/}),UY=Cr({name:"numberliteral",pattern:/-?(\d*\.)?\d+([eE][+-]?\d+)?[jJ]?[lL]?/}),BY=Cr({name:"iseq",pattern:/=|is|eq|equal/,longer_alt:Ol}),FY=Cr({name:"isnoteq",pattern:/!=|not ?eq|not ?equal/,longer_alt:Ol}),zY=Cr({name:"islessthan",pattern:/<|below/,longer_alt:Ol}),jY=Cr({name:"isgreaterthan",pattern:/>|above/,longer_alt:Ol}),HY=Cr({name:"islessthanorequal",pattern:/<=|below ?or ?eq|below ?or ?equal/,longer_alt:Ol}),VY=Cr({name:"isgreaterthanorequal",pattern:/>=|above ?or ?eq|above ?or ?equal/,longer_alt:Ol}),D3=Cr({name:"or",pattern:/or/i,longer_alt:Ol}),L3=Cr({name:"not",pattern:/not/i,longer_alt:Ol}),U3=Cr({name:"and",pattern:/and/i,longer_alt:Ol}),B3=Cr({name:"plus",pattern:/\+/}),F3=Cr({name:"minus",pattern:/-/}),GY=Cr({name:"power",pattern:/\*\*/}),qY=Cr({name:"multiply",pattern:/\*/}),BT=Cr({name:"divide",pattern:/\//}),$Y=Cr({name:"moddivide",pattern:/%/}),WY=Cr({name:"floordivide",pattern:/%%/}),VN=Cr({name:"query",pattern:/\?/}),YY=Cr({name:"lparen",pattern:/\(/,push_mode:"ignore_newlines"}),KY=Cr({name:"rparen",pattern:/\)/,pop_mode:!0}),XY=Cr({name:"command_play",pattern:/(play|bgplay) .*/,start_chars_hint:_4,longer_alt:Ol}),A0e=Cr({name:"command_toast",pattern:/toast .*/,start_chars_hint:_4,longer_alt:Ol}),FT=Cr({name:"if",pattern:/if|try|take|give/,longer_alt:Ol}),zT=UE("do"),z3=UE("done"),jT=UE("else"),ZY=UE("while"),JY=UE("repeat"),QY=UE("waitfor"),eK=Cr({name:"foreach",pattern:/foreach|for/,longer_alt:Ol}),tK=UE("break"),nK=UE("continue");function R0e(t){return[...t,UY,BY,FY,HY,zY,VY,jY,D3,L3,U3,B3,F3,GY,qY,BT,WY,$Y,VN,YY,KY,LY,Ol]}const M0e=R0e([FN,p1,XY,A0e,Zv,zN,jN,HN,DY,gA,x0e,tK,nK,z3,zT,jT,eK,FT,JY,QY,ZY]),nWe=new Kc({defaultMode:"use_newlines",modes:{use_newlines:M0e,ignore_newlines:R0e([w0e])}},{skipValidations:!o0,ensureOptimizations:o0,positionTracking:"full"});function O0e(t){C0e=!0;const e=nWe.tokenize(t||` 
`),[n]=(ji(e.tokens)?e.tokens:[]).slice(-1);return n&&n.tokenType.name!=="Newline"&&e.tokens.push(yk(gA,`
`,n.startOffset,n.endOffset??NaN,n.startLine??NaN,n.endLine??NaN,n.startColumn??NaN,n.endColumn??NaN)),e}function Xq(t,e,n=!0){if(n){const[i,...r]=e;switch(Wn(i??"")){default:return{type:gn.OBJECT,values:e};case"loader":return{type:gn.LOADER,values:r};case"board":return{type:gn.BOARD,values:r};case"object":return{type:gn.OBJECT,values:r};case"terrain":return{type:gn.TERRAIN,values:r};case"charset":return{type:gn.CHARSET,values:r};case"palette":return{type:gn.PALETTE,values:r}}}else{const[i,r,...s]=e,a=Wn(r??""),o=[i,t,...s];switch(a){default:return{type:gn.CONST,values:e};case"rn":case"range":return{type:gn.RANGE,values:o};case"sl":case"select":return{type:gn.SELECT,values:o};case"nm":case"number":return{type:gn.NUMBER,values:o};case"tx":case"text":return{type:gn.TEXT,values:o};case"hk":case"hotkey":return{type:gn.HOTKEY,values:o};case"copyit":return{type:gn.COPYIT,values:o};case"openit":return{type:gn.OPENIT,values:o};case"zssedit":return{type:gn.ZSSEDIT,values:o};case"charedit":return{type:gn.CHAREDIT,values:o};case"coloredit":return{type:gn.COLOREDIT,values:o}}}}function Qh(t){switch(t){case gn.LOADER:return"loader";case gn.BOARD:return"board";case gn.OBJECT:return"object";case gn.TERRAIN:return"terrain";case gn.CHARSET:return"charset";case gn.PALETTE:return"palette";case gn.CONST:return"const";case gn.RANGE:return"range";case gn.SELECT:return"select";case gn.NUMBER:return"number";case gn.TEXT:return"text";case gn.HOTKEY:return"hotkey";case gn.COPYIT:return"copyit";case gn.OPENIT:return"openit";case gn.ZSSEDIT:return"zssedit";case gn.CHAREDIT:return"charedit";case gn.COLOREDIT:return"coloredit"}}function iWe(t,e){return{id:wo(),code:t,...e}}function ZD(t){const e={...Sk(t)};return Object.keys(e).forEach(n=>{switch(n){case"type":case"name":delete e[n];break}}),e}function rWe(t){const e=O0e(t),n={};let i=!0;for(let r=0;r<e.tokens.length;++r){const s=e.tokens[r];if(s.tokenType===p1){const a=s.image.slice(1),[o,c]=a.split(";").map(d=>d.trim()),l=o.split(" "),u=Xq(Tn(c)?c:"",l,i),h=Wn(u.values.join(" "));switch(i=!1,u.type){case gn.LOADER:n.type=Xn.LOADER,n.name=h;break;case gn.BOARD:n.type=Xn.BOARD,n.name=h;break;case gn.OBJECT:n.type=Xn.OBJECT,n.name=h||"object";break;case gn.TERRAIN:n.type=Xn.TERRAIN,n.name=h;break;case gn.CHARSET:n.type=Xn.CHARSET,n.name=h;break;case gn.PALETTE:n.type=Xn.PALETTE,n.name=h;break;case gn.CONST:{const[d,f]=u.values;if(Tn(d)){const p=Wn(d);if(Tn(f)){const g=parseFloat(f);n[p]=an(g)?g:f}else an(f)?n[p]=f:n[p]=1}break}case gn.RANGE:case gn.SELECT:case gn.NUMBER:case gn.TEXT:case gn.HOTKEY:case gn.ZSSEDIT:case gn.CHAREDIT:case gn.COLOREDIT:{const[d,...f]=u.values;if(Tn(d)){const p=Wn(d);n[p]=[Qh(u.type),...f]}break}}}}return n}function Sk(t){var e;return re(t)?(re((e=t.stats)==null?void 0:e.type)||(t.stats=rWe(t.code),re(t.stats.type)||(t.stats.type=Xn.OBJECT)),t.stats):{}}function N0e(t){switch(t){default:case Xn.ERROR:return"error";case Xn.LOADER:return Qh(gn.LOADER);case Xn.BOARD:return Qh(gn.BOARD);case Xn.OBJECT:return Qh(gn.OBJECT);case Xn.TERRAIN:return Qh(gn.TERRAIN);case Xn.CHARSET:return Qh(gn.CHARSET);case Xn.PALETTE:return Qh(gn.PALETTE)}}function m1(t){return Sk(t).type??Xn.ERROR}function Fy(t){return N0e(m1(t))}function mu(t){return Sk(t).name??""}function sWe(t,e){return Sk(t)[e]}const JD=new bn;function aWe(t){if(!Tn(t))return;const e=M4(t);if(re(e)&&re(qt[e]))return qt[e];const n=Wn(t),i=Yt[n];if(re(i))return i}function kie(t,e){const n=Object.keys(t);for(let i=0;i<n.length;++i){const r=n[i],s=t[r];if(!ji(s))switch(r){case"name":case"char":case"light":case"group":case"p1":case"p2":case"p3":case"cycle":case"stepx":case"stepy":e[r]=t[r];break;case"color":case"bg":case"lightdir":e[r]=aWe(t[r])??t[r];break;case"ispushable":e.pushable=1;break;case"notpushable":e.pushable=0;break;case"iswalk":case"iswalking":case"iswalkable":e.collision=Qr.ISWALK;break;case"isswim":case"isswimming":case"isswimable":e.collision=Qr.ISSWIM;break;case"issolid":e.collision=Qr.ISSOLID;break;case"isbullet":e.collision=Qr.ISBULLET;break;case"isdestructible":e.destructible=1;break;case"notdestructible":e.destructible=0;break}}}function Qc(t){var e;if(re(t))switch(m1(t)){default:return;case Xn.ERROR:return t.code??"";case Xn.LOADER:return t.code??"";case Xn.BOARD:{re(t.board)||(t.board=PY()),t.board.id=t.id;const n=ZD(t);return t.board.isdark=n.isdark??t.board.isdark?1:0,t.board.startx=n.startx??t.board.startx,t.board.starty=n.starty??t.board.starty,t.board.over=n.over??t.board.over,t.board.under=n.under??t.board.under,t.board.camera=n.camera??t.board.camera,t.board.graphics=n.graphics??t.board.graphics,t.board.facing=n.facing??t.board.facing,t.board.exitnorth=n.exitnorth??t.board.exitnorth,t.board.exitsouth=n.exitsouth??t.board.exitsouth,t.board.exitwest=n.exitwest??t.board.exitwest,t.board.exiteast=n.exiteast??t.board.exiteast,t.board.timelimit=n.timelimit??t.board.timelimit,t.board.restartonzap=n.restartonzap??t.board.restartonzap,t.board.maxplayershots=n.maxplayershots??t.board.maxplayershots,t.board}case Xn.OBJECT:return re(t.object)||(t.object=Iie()),t.object.id=t.id,t.object.name=mu(t),t.object.category=c1.ISOBJECT,kie(ZD(t),t.object),t.object;case Xn.TERRAIN:return re(t.terrain)||(t.terrain=Iie()),t.terrain.id=t.id,t.terrain.name=mu(t),t.terrain.category=c1.ISTERRAIN,kie(ZD(t),t.terrain),t.terrain;case Xn.PALETTE:{if(re(t.palette)||(t.palette=PE(G1)),re((e=t.palette)==null?void 0:e.bits)){const n=ZD(t),i=M_(n);for(let r=0;r<i.length;++r){const s=i[r].toLowerCase(),a=n[s];if(s.startsWith("color")&&Tn(a)){const o=parseFloat(s.replace("color",""));if(o>=0&&o<=15){JD.set(a);const c=o*l1,l=JD.r*63,u=JD.g*63,h=JD.b*63;t.palette.bits[c+0]=er(l,0,63),t.palette.bits[c+1]=er(u,0,63),t.palette.bits[c+2]=er(h,0,63)}}}}return t.palette}case Xn.CHARSET:return re(t.charset)||(t.charset=V1(dR)),t.charset}}function I0e(t){return{id:wo(),name:B6e(),timestamp:0,activelist:[],pages:t,flags:{}}}function k0e(t){re(t)&&(t.token=`${F6e()}${rf(1111,9999)}`)}function g1(t,e){if(!re(t))return;const n=Wn(e);return t.pages.find(r=>r.id===e||n===mu(r))}function vh(t,e,n){if(!re(t))return;const i=Wn(n);return t.pages.find(s=>m1(s)===e&&(s.id===n||i===mu(s)))}function Zq(t,e,n){let i=vh(t,e,n);if(!re(i)){const r=N0e(e);return i=iWe(r==="object"?`@${n||"object"}
`:`@${r} ${n}
`,{}),oWe(t,i),[i,!0]}return[i,!1]}function fp(t,e,n){if(!re(t))return[];const i=Wn(n);return t.pages.filter(s=>m1(s)===e).filter(s=>{const a=Sk(s),o=Wn(mu(s));return s.id===n||i===o||re(a[n])})}function vH(t){return re(t)?ro(t.pages).sort((n,i)=>{const r=m1(n),s=m1(i);return r===s?mu(n).localeCompare(mu(i)):s-r}):[]}function oWe(t,e){if(!re(t)||!re(e))return!1;const n=g1(t,e.id);return re(n)?!1:(t.pages.push(e),k0e(t),!0)}function P0e(t,e){const n=g1(t,e);if(re(t)&&re(n)){const i=Wn(e);return t.pages=t.pages.filter(r=>r.id!==e&&i!==mu(r)),k0e(t),n}}function v1(t,e){if(re(e)&&re(e.kind))return re(e.kinddata)||(e.kinddata=re(e.id)?vA(t,e.kind):GN(t,e.kind)),e.kinddata}function yc(t,e,n){const i=v1(t,e);return(e==null?void 0:e[n])??(i==null?void 0:i[n])??sWe(g1(t,(i==null?void 0:i.id)??""),n)}let cWe=0;function cE(t,e){const n=yc(t,e,"group");if(Tn(n))return n;const i=yc(t,e==null?void 0:e.kinddata,"group");return Tn(i)?i:`group${cWe++}`}function j3(t,e,n,i,r){const s=v1(t,e);return{char:(e==null?void 0:e.char)??(s==null?void 0:s.char)??n,color:(e==null?void 0:e.color)??(s==null?void 0:s.color)??i,bg:(e==null?void 0:e.bg)??(s==null?void 0:s.bg)??r,light:(e==null?void 0:e.light)??(s==null?void 0:s.light)??0}}function vA(t,e){const n=e??"",i=vh(t,Xn.OBJECT,n);if(re(i)){const r=Qc(i);return{...ro(r),name:n,code:i.code}}}function GN(t,e){const n=e??"",i=vh(t,Xn.TERRAIN,n);if(re(i)){const r=Qc(i);return{...ro(r),name:n,code:i.code}}}function EC(t,e){const n=g1(t,e);return Qc(n)}function y4(t,e){return t?(t.flags[e]=t.flags[e]??{},t.flags[e]):{}}function lWe(t,e){t&&delete t.flags[e]}function D0e(t,e,n){const i=y4(t,e);return i==null?void 0:i[n]}function uWe(t,e,n,i){const r=y4(t,e);return r&&(r[n]=i),i}function hWe(t,e){const n=D0e(t,e,"board");return EC(t,Tn(n)?n:"")}function dWe(t,e,n){if(!re(t))return;uWe(t,e,"board",n);const i=EC(t,n);re(i)?t.activelist.includes(e)||t.activelist.push(e):t.activelist=t.activelist.filter(r=>r!==e)}function eC(t,e,n,i){if(!re(t))return;const r=hWe(t,e);if(!re(r))return;const s=D_(r,e);if(!hh(s)||!(s!=null&&s.id))return;const a=EC(t,n);if(!re(a)||(wl(t,a),iK(t,a,Qr.ISWALK,i)))return;delete r.objects[s.id];const o=f1(r,s);r.lookup&&(r.lookup[o]=void 0),s.x=i.x,s.y=i.y,a.objects[s.id]=s;const c=f1(a,s);a.lookup&&(a.lookup[c]=s.id),dWe(t,e,a.id)}function fWe(t){const n=((t==null?void 0:t.activelist)??[]).map(i=>{const r=D0e(t,i,"board");return Tn(r)?r:""});return Z$e(n)}function pWe(t){const e=fWe(t),n=new Set,i=[];for(let r=0;r<e.length;++r){const s=EC(t,e[r]);if(re(s)&&!n.has(s.id)){if(Tn(s.over))if(Tn(s.overboard)){const a=EC(t,s.overboard);re(a)?n.has(a.id)||i.push(a):delete s.overboard}else{const a=fp(t,Xn.BOARD,s.over);if(a.length){const o=io(a),c=Qc(o);re(c)&&(s.overboard=c.id)}}else Tn(s.overboard)&&delete s.overboard;if(i.push(s),Tn(s.under))if(Tn(s.underboard)){const a=EC(t,s.underboard);re(a)||delete s.underboard}else{const a=fp(t,Xn.BOARD,s.under);if(a.length){const o=io(a),c=Qc(o);re(c)&&(s.underboard=c.id)}}else Tn(s.underboard)&&delete s.underboard}}return i}function mWe(t,e,n,i,r){if(!re(e))return;re(e.distmaps)||(e.distmaps={});const s=`${n}.${i.x}.${i.y}.${r.x}.${r.y}`;let a=e.distmaps[s];if(!re(a)){a=new Array(hk).fill(-2);const o=[{...r}];let c=0;for(;o.length;){const l=o.shift();if(re(l)&&P3(l)){const u=rh(l,kn);if(a[u]===-2){const h=mA(e,l.x,l.y);UN(n,yc(t,h,"collision")??Qr.ISWALK)||(a[u]=c,o.push({x:l.x,y:l.y-1},{x:l.x,y:l.y+1},{x:l.x-1,y:l.y},{x:l.x+1,y:l.y})),++c}}}e.distmaps[s]=a}return a}function Pie(t,e){return P3(t)?e[rh(t,kn)]:-1}function Die(t,e,n,i,r,s){if(!re(t)||!re(e))return;const a=mWe(t,e,n,i,r);if(!re(a))return;const o=[{x:i.x,y:i.y-1},{x:i.x,y:i.y+1},{x:i.x-1,y:i.y},{x:i.x+1,y:i.y}];let c;if(s){let l=s?0:1e4;for(let u=0;u<o.length;++u){const h=Pie(o[u],a);h>=0&&h>l&&(l=h,c=o[u])}}else{let l=1e5;for(let u=0;u<o.length;++u){const h=Pie(o[u],a);h>=0&&h<l&&(l=h,c=o[u])}}return c}function wl(t,e){var o;if(!re(t)||!re(e)||re(e.lookup)&&re(e.named))return;const n=new Array(kn*ur).fill(void 0),i={},r=Object.values(e.objects);for(let c=0;c<r.length;++c){const l=r[c];if(re(l.x)&&re(l.y)&&re(l.id)&&!re(l.removed)){l.category=c1.ISOBJECT,n[l.x+l.y*kn]=l.id;const u=Wn(l.name??((o=l.kinddata)==null?void 0:o.name)??"");i[u]||(i[u]=new Set),i[u].add(l.id)}}let s=0,a=0;for(let c=0;c<e.terrain.length;++c){const l=e.terrain[c];if(re(l)){l.x=s,l.y=a,l.category=c1.ISTERRAIN;const u=K1(l);i[u]||(i[u]=new Set),i[u].add(c)}++s,s>=kn&&(s=0,++a)}e.lookup=n,e.named=i}function H3(t,e){re(e)&&(delete e.named,delete e.lookup,wl(t,e))}function Lie(t,e,n,i){var s;if(!re(t)||!re(e)||!re(e.named)||!re(n))return;const r=Wn(n.name??((s=n.kinddata)==null?void 0:s.name)??"");e.named[r]||(e.named[r]=new Set),e.named[r].add((n==null?void 0:n.id)??i??"")}function gWe(t,e,n){if(!(!re(t)||!re(e)||!re(e.lookup)||!re(n==null?void 0:n.id))&&!re(n.removed)){const i=n.x??0,r=n.y??0;e.lookup[i+r*kn]=n.id}}function vWe(t,e,n){var i;if(re(t)&&re(e)&&re(n==null?void 0:n.x)&&re(n.y)){const r=K1(n),s=f1(e,n);re((i=e.named)==null?void 0:i[r])&&e.named[r].delete(s)}}function L0e(t,e,n){var i;if(re(t)&&re(e)&&re(n==null?void 0:n.id)){if(re(e.lookup)&&re(n.x)&&re(n.y)){const s=n.x+n.y*kn;e.lookup[s]===n.id&&(e.lookup[s]=void 0)}const r=K1(n);re((i=e.named)==null?void 0:i[r])&&re(n.id)&&e.named[r].delete(n.id)}}function Jq(t,e,n,i,r,s){const a=Yt.MID;if(!re(t)||!re(e)||!re(n))return{dir:r,startpt:s,destpt:s,layer:a};const o={x:n.x??0,y:n.y??0},c={x:n.lx??o.x,y:n.ly??o.y},l=Vv(c,o),u=kn-1,h=ur-1;for(let d=0;d<r.length;++d){const f=n7e(r[d]);switch(f){case Yt.IDLE:break;case Yt.NORTH:case Yt.SOUTH:case Yt.WEST:case Yt.EAST:fc(o,f);break;case Yt.BY:{const[p,g]=r.slice(d+1);an(p)&&an(g)&&(o.x=er(o.x+p,0,u),o.y=er(o.y+g,0,h)),d+=2;break}case Yt.TO:case Yt.AT:{const[p,g]=r.slice(d+1);an(p)&&an(g)&&(o.x=er(p,0,u),o.y=er(g,0,h)),d+=2;break}case Yt.FLOW:fc(o,l);break;case Yt.SEEK:{const p=Q7e(e,n,i);fA(p)&&fc(o,Vv(s,p));break}case Yt.RNDNS:fc(o,io(Yt.NORTH,Yt.SOUTH));break;case Yt.RNDNE:fc(o,io(Yt.NORTH,Yt.EAST));break;case Yt.RND:fc(o,io(Yt.NORTH,Yt.SOUTH,Yt.WEST,Yt.EAST));break;case Yt.CW:case Yt.CCW:case Yt.OPP:case Yt.RNDP:{const p=Jq(t,e,n,i,r.slice(d+1),s);switch(o.x=s.x,o.y=s.y,f){case Yt.CW:switch(Vv(s,p.destpt)){case Yt.NORTH:fc(o,Yt.EAST);break;case Yt.SOUTH:fc(o,Yt.WEST);break;case Yt.EAST:fc(o,Yt.SOUTH);break;case Yt.WEST:fc(o,Yt.NORTH);break}break;case Yt.CCW:switch(Vv(s,p.destpt)){case Yt.NORTH:fc(o,Yt.WEST);break;case Yt.SOUTH:fc(o,Yt.EAST);break;case Yt.EAST:fc(o,Yt.NORTH);break;case Yt.WEST:fc(o,Yt.SOUTH);break}break;case Yt.OPP:switch(Vv(s,p.destpt)){case Yt.NORTH:fc(o,Yt.SOUTH);break;case Yt.SOUTH:fc(o,Yt.NORTH);break;case Yt.EAST:fc(o,Yt.WEST);break;case Yt.WEST:fc(o,Yt.EAST);break}break;case Yt.RNDP:switch(Vv(s,p.destpt)){case Yt.NORTH:case Yt.SOUTH:o.x+=io(-1,1);break;case Yt.WEST:case Yt.EAST:o.y+=io(-1,1);break}break}break}case Yt.FLEE:case Yt.AWAY:{const[p,g]=r.slice(d+1);if(an(p)&&an(g)){const _={x:er(p,0,u),y:er(g,0,h)},v=yc(t,n,"collision"),b=Die(t,e,v,o,_,!0);re(b)&&(o.x=b.x,o.y=b.y)}d+=2;break}case Yt.FIND:case Yt.TOWARD:{const[p,g]=r.slice(d+1);if(an(p)&&an(g)){const _={x:er(p,0,u),y:er(g,0,h)};if(rf(1,100)<5)fc(o,io(Yt.NORTH,Yt.SOUTH,Yt.WEST,Yt.EAST));else{const v=yc(t,n,"collision"),b=Die(t,e,v,o,_,!1);if(re(b))if(b.x!==p&&b.y!==g&&J7e(e,b))switch(Vv(s,b)){case Yt.EAST:case Yt.WEST:o.y+=io(-1,1);break;case Yt.NORTH:case Yt.SOUTH:o.x+=io(-1,1);break}else o.x=b.x,o.y=b.y}}d+=2;break}case Yt.PLAYER:{const p=BN(e,s,i);fA(p)&&(o.x=p.x,o.y=p.y);break}case Yt.OVER:case Yt.UNDER:{const p=Jq(t,e,n,i,r.slice(d+1),s);return p.layer=f,p}}}return{dir:r,startpt:s,destpt:o,layer:a}}function _We(t,e,n,i){if(re(t)&&re(e)&&re(n)){const[r,s]=n,a=vA(t,r);if(re(a)&&re(a.name)){const o=b0e(e,i,r);return LN(o,s),o}}}function lE(t,e,n,i,r){if(re(t)&&re(e)&&re(n)){const[s,a]=n,o=GN(t,s);if(re(o)){const l=Z7e(e,i,s);if(re(l)){LN(l,a);const u=rh(i,kn);return v1(t,l),Lie(t,e,l,u),l}}const c=vA(t,s);if(re(c)&&re(c.name)){const l=b0e(e,i,s,r);if(re(l))return LN(l,a),gWe(t,e,l),v1(t,l),Lie(t,e,l),l}}}function e0(t,e,n,i){return!re(n)||K1(n)==="player"?!1:(n.id?(n.removed=i,L0e(t,e,n)):(af(e,{x:(n==null?void 0:n.x)??0,y:(n==null?void 0:n.y)??0}),vWe(t,e,n)),!0)}function iK(t,e,n,i){if(!re(t)||!re(e)||!re(e.lookup)||i.x<0||i.x>=kn||i.y<0||i.y>=ur)return!0;const r=i.x+i.y*kn,s=D_(e,e.lookup[r]??"404");if(re(s))return!0;const a=e.terrain[r];return re(a)?UN(n,yc(t,a,"collision")??Qr.ISWALK):!1}function yWe(t,e,n,i){const r=D_(e,(n==null?void 0:n.id)??""),s=(r==null?void 0:r.x)??-1,a=(r==null?void 0:r.y)??-1;if(s-i.x===0&&a-i.y===0)return!0;const o=yc(t,r,"collision");return iK(t,e,o,i)}function rK(t,e,n,i){var d;const r=D_(e,(n==null?void 0:n.id)??"");if(!re(t)||!re(e)||!re(r)||!re(r.x)||!re(r.y)||!re(e.lookup)||!re(n)||i.x<0||i.x>=kn||i.y<0||i.y>=ur)return{name:"edge",kind:"edge",collision:Qr.ISSOLID,x:i.x,y:i.y};if(r.x-i.x===0&&r.y-i.y===0)return;const s=f1(e,r),a=f1(e,i),o=yc(t,r,"collision")??Qr.ISWALK,c=o1(r==null?void 0:r.id),l=D_(e,e.lookup[a]??""),u=o1((l==null?void 0:l.id)??"");if(re(l)&&(!c||!u)&&cE(t,n)!==cE(t,l)){if(!!yc(t,l,"pushable")){const p={x:i.x-(n.x??0),y:i.y-(n.y??0)};rK(t,e,l,p)}return{...l}}const h=e.terrain[a];if(re(h)){const f=h.collision??((d=h==null?void 0:h.kinddata)==null?void 0:d.collision)??Qr.ISWALK;if(UN(o,f))return{...h,x:i.x,y:i.y}}r.x=i.x,r.y=i.y,re(r.removed)||(e.lookup[s]=void 0,e.lookup[a]=r.id??"")}function bWe(t,e,n){const i=[],r=[];if(!re(t)||!re(e))return{objectelements:i,terrainelements:r};function s(o){const c=yc(t,o,n);return re(c)||cE(t,o)===n}const a=Object.values(e.objects);for(let o=0;o<a.length;++o){const c=a[o];s(c)&&i.push(c)}for(let o=0;o<hk;++o){const c=e.terrain[o];re(c)&&s(c)&&r.push(c)}return{objectelements:i,terrainelements:r}}var U0e={exports:{}},_H={exports:{}},Uie;function EWe(){return Uie||(Uie=1,function(t,e){(function(n,i){t.exports=i()})(Ml,function(){function n(g){return!isNaN(parseFloat(g))&&isFinite(g)}function i(g){return g.charAt(0).toUpperCase()+g.substring(1)}function r(g){return function(){return this[g]}}var s=["isConstructor","isEval","isNative","isToplevel"],a=["columnNumber","lineNumber"],o=["fileName","functionName","source"],c=["args"],l=["evalOrigin"],u=s.concat(a,o,c,l);function h(g){if(g)for(var _=0;_<u.length;_++)g[u[_]]!==void 0&&this["set"+i(u[_])](g[u[_]])}h.prototype={getArgs:function(){return this.args},setArgs:function(g){if(Object.prototype.toString.call(g)!=="[object Array]")throw new TypeError("Args must be an Array");this.args=g},getEvalOrigin:function(){return this.evalOrigin},setEvalOrigin:function(g){if(g instanceof h)this.evalOrigin=g;else if(g instanceof Object)this.evalOrigin=new h(g);else throw new TypeError("Eval Origin must be an Object or StackFrame")},toString:function(){var g=this.getFileName()||"",_=this.getLineNumber()||"",v=this.getColumnNumber()||"",b=this.getFunctionName()||"";return this.getIsEval()?g?"[eval] ("+g+":"+_+":"+v+")":"[eval]:"+_+":"+v:b?b+" ("+g+":"+_+":"+v+")":g+":"+_+":"+v}},h.fromString=function(_){var v=_.indexOf("("),b=_.lastIndexOf(")"),S=_.substring(0,v),x=_.substring(v+1,b).split(","),M=_.substring(b+1);if(M.indexOf("@")===0)var R=/@(.+?)(?::(\d+))?(?::(\d+))?$/.exec(M,""),I=R[1],k=R[2],P=R[3];return new h({functionName:S,args:x||void 0,fileName:I,lineNumber:k||void 0,columnNumber:P||void 0})};for(var d=0;d<s.length;d++)h.prototype["get"+i(s[d])]=r(s[d]),h.prototype["set"+i(s[d])]=function(g){return function(_){this[g]=!!_}}(s[d]);for(var f=0;f<a.length;f++)h.prototype["get"+i(a[f])]=r(a[f]),h.prototype["set"+i(a[f])]=function(g){return function(_){if(!n(_))throw new TypeError(g+" must be a Number");this[g]=Number(_)}}(a[f]);for(var p=0;p<o.length;p++)h.prototype["get"+i(o[p])]=r(o[p]),h.prototype["set"+i(o[p])]=function(g){return function(_){this[g]=String(_)}}(o[p]);return h})}(_H)),_H.exports}(function(t,e){(function(n,i){t.exports=i(EWe())})(Ml,function(i){var r=/(^|@)\S+:\d+/,s=/^\s*at .*(\S+:\d+|\(native\))/m,a=/^(eval@)?(\[native code])?$/;return{parse:function(c){if(typeof c.stacktrace<"u"||typeof c["opera#sourceloc"]<"u")return this.parseOpera(c);if(c.stack&&c.stack.match(s))return this.parseV8OrIE(c);if(c.stack)return this.parseFFOrSafari(c);throw new Error("Cannot parse given Error object")},extractLocation:function(c){if(c.indexOf(":")===-1)return[c];var l=/(.+?)(?::(\d+))?(?::(\d+))?$/,u=l.exec(c.replace(/[()]/g,""));return[u[1],u[2]||void 0,u[3]||void 0]},parseV8OrIE:function(c){var l=c.stack.split(`
`).filter(function(u){return!!u.match(s)},this);return l.map(function(u){u.indexOf("(eval ")>-1&&(u=u.replace(/eval code/g,"eval").replace(/(\(eval at [^()]*)|(,.*$)/g,""));var h=u.replace(/^\s+/,"").replace(/\(eval code/g,"(").replace(/^.*?\s+/,""),d=h.match(/ (\(.+\)$)/);h=d?h.replace(d[0],""):h;var f=this.extractLocation(d?d[1]:h),p=d&&h||void 0,g=["eval","<anonymous>"].indexOf(f[0])>-1?void 0:f[0];return new i({functionName:p,fileName:g,lineNumber:f[1],columnNumber:f[2],source:u})},this)},parseFFOrSafari:function(c){var l=c.stack.split(`
`).filter(function(u){return!u.match(a)},this);return l.map(function(u){if(u.indexOf(" > eval")>-1&&(u=u.replace(/ line (\d+)(?: > eval line \d+)* > eval:\d+:\d+/g,":$1")),u.indexOf("@")===-1&&u.indexOf(":")===-1)return new i({functionName:u});var h=/((.*".+"[^@]*)?[^@]*)(?:@)/,d=u.match(h),f=d&&d[1]?d[1]:void 0,p=this.extractLocation(u.replace(h,""));return new i({functionName:f,fileName:p[0],lineNumber:p[1],columnNumber:p[2],source:u})},this)},parseOpera:function(c){return!c.stacktrace||c.message.indexOf(`
`)>-1&&c.message.split(`
`).length>c.stacktrace.split(`
`).length?this.parseOpera9(c):c.stack?this.parseOpera11(c):this.parseOpera10(c)},parseOpera9:function(c){for(var l=/Line (\d+).*script (?:in )?(\S+)/i,u=c.message.split(`
`),h=[],d=2,f=u.length;d<f;d+=2){var p=l.exec(u[d]);p&&h.push(new i({fileName:p[2],lineNumber:p[1],source:u[d]}))}return h},parseOpera10:function(c){for(var l=/Line (\d+).*script (?:in )?(\S+)(?:: In function (\S+))?$/i,u=c.stacktrace.split(`
`),h=[],d=0,f=u.length;d<f;d+=2){var p=l.exec(u[d]);p&&h.push(new i({functionName:p[3]||void 0,fileName:p[2],lineNumber:p[1],source:u[d]}))}return h},parseOpera11:function(c){var l=c.stack.split(`
`).filter(function(u){return!!u.match(r)&&!u.match(/^Error created at/)},this);return l.map(function(u){var h=u.split("@"),d=this.extractLocation(h.pop()),f=h.shift()||"",p=f.replace(/<anonymous function(: (\w+))?>/,"$2").replace(/\([^)]*\)/g,"")||void 0,g;f.match(/\(([^)]*)\)/)&&(g=f.replace(/^[^(]+\(([^)]*)\)$/,"$1"));var _=g===void 0||g==="[arguments not available]"?void 0:g.split(",");return new i({functionName:p,args:_,fileName:d[0],lineNumber:d[1],columnNumber:d[2],source:u})},this)}}})})(U0e);var SWe=U0e.exports;const TWe=il(SWe);function q_(t){const e={},n={tick(){},everytick(){},listcommands(){return M_(e)},...t,getcommand(i){return e[i]},command(i,r){return e[i]=r,n}};return n}function ca(t){return`${t??""}`}function xT(t,e){const n=parseFloat(ca(t));return isNaN(n)?e:n}function dh(t,e){return typeof t==typeof e?t:e}function Bie(t,e,n){var r;const[i]=Rt(e,0,[Ke.MAYBE_NAME]);Zy(Ye,t,((r=ie.board)==null?void 0:r.id)??"",i??"",n)}function Jh(t,e,n,i){const[r,s]=Rt(i,0,[Ke.NUMBER_OR_STRING,Ke.MAYBE_NUMBER_OR_STRING]);dme(Ye,t,e,n,r,s)}const xWe=["echo","reverb","phaser","distortion","vibrato","fc","fcrush","autowah"];function B0e(t,e,n){const[i,r]=Rt(n,0,[Ke.NUMBER_OR_STRING]);if(an(i))nH(Ye,t,e,"volume",i);else if(xWe.includes(Wn(i))){const[s,a]=Rt(n,r,[Ke.NUMBER_OR_STRING,Ke.MAYBE_NUMBER_OR_STRING]);dme(Ye,t,e,i,s,a)}else{const[s]=Rt(n,r,[Ke.MAYBE_NUMBER_OR_STRING]);if(an(s)){const a=n.length-r,o=new Array(a).fill(Ke.NUMBER),c=Rt(n,r,o).slice(0,a),l=c.length===1?c[0]:c;nH(Ye,t,e,i,l)}else{const[a]=Rt(n,r,[Ke.MAYBE_NUMBER_OR_STRING]);nH(Ye,t,e,i,a)}}}const sK=q_().command("talk",(t,e)=>{const[n]=Rt(e,0,[Ke.ANY]);switch(Wn(n)){default:S4e(Ye,ie.elementfocus);break;case"stop":T4e(Ye,ie.elementfocus);break}return 0}).command("media",(t,e)=>{const[n]=Rt(e,0,[Ke.ANY]);switch(Wn(n)){default:x4e(Ye,ie.elementfocus);break;case"stop":w4e(Ye,ie.elementfocus);break}return 0}).command("tts",(t,e)=>{const[n,i]=Rt(e,0,[Ke.STRING]),r=e.slice(i).map(ca).join("");return U4e(Ye,ie.elementfocus,n,r),0}).command("tta",(t,e)=>{const n=e.map(ca).join("");return B4e(Ye,ie.elementfocus,n),0}).command("bpm",(t,e)=>{const[n]=Rt(e,0,[Ke.NUMBER]);return F4e(Ye,ie.elementfocus,n),0}).command("vol",(t,e)=>{const[n]=Rt(e,0,[Ke.NUMBER]);return z4e(Ye,ie.elementfocus,n),0}).command("bgvol",(t,e)=>{const[n]=Rt(e,0,[Ke.NUMBER]);return j4e(Ye,ie.elementfocus,n),0}).command("ttsvol",(t,e)=>{const[n]=Rt(e,0,[Ke.NUMBER]);return H4e(Ye,ie.elementfocus,n),0}).command("play",(t,e)=>(Bie(ie.elementfocus,e,!1),0)).command("bgplay",(t,e)=>(Bie(ie.elementfocus,e,!0),0)).command("synth",(t,e)=>{for(let n=0;n<8;++n)B0e(ie.elementfocus,n,e);return 0}).command("echo",(t,e)=>{for(let n=0;n<3;++n)Jh(ie.elementfocus,n,"echo",e);return 0}).command("fcrush",(t,e)=>{for(let n=0;n<3;++n)Jh(ie.elementfocus,n,"fc",e);return 0}).command("phaser",(t,e)=>{for(let n=0;n<3;++n)Jh(ie.elementfocus,n,"phaser",e);return 0}).command("reverb",(t,e)=>{for(let n=0;n<3;++n)Jh(ie.elementfocus,n,"reverb",e);return 0}).command("distort",(t,e)=>{for(let n=0;n<3;++n)Jh(ie.elementfocus,n,"distort",e);return 0}).command("vibrato",(t,e)=>{for(let n=0;n<3;++n)Jh(ie.elementfocus,n,"vibrato",e);return 0}).command("autowah",(t,e)=>{for(let n=0;n<3;++n)Jh(ie.elementfocus,n,"autowah",e);return 0});for(let t=0;t<8;++t)sK.command(`synth${t+1}`,(e,n)=>(B0e(ie.elementfocus,t,n),0));for(let t=0;t<3;++t){const e=t+1;sK.command(`echo${e}`,(n,i)=>(Jh(ie.elementfocus,t,"echo",i),0)).command(`fcrush${e}`,(n,i)=>(Jh(ie.elementfocus,t,"fcrush",i),0)).command(`phaser${e}`,(n,i)=>(Jh(ie.elementfocus,t,"phaser",i),0)).command(`reverb${e}`,(n,i)=>(Jh(ie.elementfocus,t,"reverb",i),0)).command(`distort${e}`,(n,i)=>(Jh(ie.elementfocus,t,"distort",i),0)).command(`vibrato${e}`,(n,i)=>(Jh(ie.elementfocus,t,"vibrato",i),0)).command(`autowah${e}`,(n,i)=>(Jh(ie.elementfocus,t,"autowah",i),0))}function Fie(t,e,n){if(!fA(ie.element))return 0;const[i,r]=Rt(e,0,[Ke.DIR,Ke.MAYBE_KIND]),s=r??["bullet"],a=_We(ie.book,ie.board,s,{x:ie.element.x,y:ie.element.y});if(re(a)){re(n)&&(a.arg=n),a.party=ie.elementid,a.collision=Qr.ISBULLET,a.destructible=1,a.stepx=i.destpt.x-ie.element.x,a.stepy=i.destpt.y-ie.element.y,a.bg=qt.ONCLEAR;const o=v1(ie.book,a),c=a.code??(o==null?void 0:o.code)??"";ttt(ie.book,ie.board,a,c,1)}return t.yield(),0}function QD(t,e,n,i){var u,h;if(!fA(ie.element)||!re(ie.book)||!re(ie.board)||!re(ie.element))return 0;wl(ie.book,ie.board);const[r,s]=Rt(e,0,[Ke.DIR,Ke.KIND]),a=bc(ie.board,r.destpt);if((a==null?void 0:a.category)===c1.ISOBJECT&&(a!=null&&a.pushable)){const d={x:((u=ie.element)==null?void 0:u.x)??0,y:((h=ie.element)==null?void 0:h.y)??0},f=fc(r.destpt,Vv(d,r.destpt));rK(ie.book,ie.board,a,f)}const[o]=s,c=GN(ie.book,o);re(c)&&lE(ie.book,ie.board,s,r.destpt,n);const l=vA(ie.book,o);if(re(l)){const d=vA(ie.book,o)??GN(ie.book,o),f=yc(ie.book,d,"collision")??Qr.ISWALK;if(!iK(ie.book,ie.board,f,r.destpt)){const g=lE(ie.book,ie.board,s,r.destpt,n);re(g)&&re(i)&&(g.arg=i)}}return 0}const wWe=q_().command("board",(t,e)=>{if(!re(ie.book)||!re(ie.board))return 0;const[n,i]=Rt(e,0,[Ke.NAME]),[r,s]=Rt(e,i,[Ke.MAYBE_NUMBER,Ke.MAYBE_NUMBER]),a=fp(ie.book,Xn.BOARD,n);if(a.length){const o=io(...a);re(o)&&eC(ie.book,ie.elementfocus,o.id,{x:r??Math.round(kn*.5),y:s??Math.round(ur*.5)})}return 0}).command("edge",(t,e)=>{var s,a;if(!re(ie.book)||!re(ie.board)||!re(ie.element))return 0;const[n,i]=Rt(e,0,[Ke.DIR,Ke.NAME]),r=fp(ie.book,Xn.BOARD,i);if(r.length){const o={x:((s=ie.element)==null?void 0:s.x)??0,y:((a=ie.element)==null?void 0:a.y)??0},c=Vv(o,n.destpt),l=io(...r);switch(c){case Yt.NORTH:ie.board.exitnorth=l.id;break;case Yt.SOUTH:ie.board.exitsouth=l.id;break;case Yt.WEST:ie.board.exitwest=l.id;break;case Yt.EAST:ie.board.exiteast=l.id;break}}return 0}).command("shove",(t,e)=>{if(!re(ie.book)||!re(ie.board))return 0;wl(ie.book,ie.board);const[n,i]=Rt(e,0,[Ke.DIR,Ke.DIR]),r=bc(ie.board,n.destpt);return hh(r)&&CC(ie.book,ie.board,r,i.destpt),0}).command("duplicate",(t,e)=>{if(!re(ie.book)||!re(ie.board))return 0;wl(ie.book,ie.board);const[n,i]=Rt(e,0,[Ke.DIR,Ke.DIR]),r=bc(ie.board,n.destpt);return hh(r),0}).command("write",(t,e)=>{var l;if(!re(ie.book)||!re(ie.board))return 0;wl(ie.book,ie.board);const[n,i,r]=Rt(e,0,[Ke.DIR,Ke.COLOR,Ke.STRING]),{color:s,bg:a}=E_e(i),o=((l=Ik(r,256,1))==null?void 0:l.measuredwidth)??1,c=FE(256,1,s??qt.WHITE,a??qt.BLACK);oi(r,c,!1);for(let u=0;u<o;++u)af(ie.board,{x:n.destpt.x+u,y:n.destpt.y,name:"text",char:c.char[u],color:c.color[u],bg:c.bg[u]});return 0}).command("change",(t,e)=>{if(!re(ie.book)||!re(ie.board))return 0;wl(ie.book,ie.board);const[n,i]=Rt(e,0,[Ke.KIND,Ke.KIND]);(k3(n)??"")==="empty"&&eWe(ie.board).forEach(c=>{lE(ie.book,ie.board,i,c)});const s=k3(i),a=MY(i),o=a0e(i);return E0e(ie.board,n).forEach(c=>{if(K1(c)===s)re(a)&&(c.color=a),re(o)&&(c.bg=o);else if(e0(ie.book,ie.board,c,ie.timestamp),s!=="empty"){const l={x:c.x??0,y:c.y??0};lE(ie.book,ie.board,i,l)}}),0}).command("put",(t,e)=>QD(t,e)).command("putwith",(t,e)=>{const[n,i]=Rt(e,0,[Ke.ANY]);return QD(t,e.slice(i),void 0,n)}).command("oneof",(t,e)=>{const[n,i]=Rt(e,0,[Ke.ANY]);return re(ie.board)&&D_(ie.board,n)?0:QD(t,e.slice(i),n)}).command("oneofwith",(t,e)=>{const[n,i,r]=Rt(e,0,[Ke.ANY,Ke.ANY]);return re(ie.board)&&D_(ie.board,i)?0:QD(t,e.slice(r),i,n)}).command("shoot",Fie).command("shootwith",(t,e)=>{const[n,i]=Rt(e,0,[Ke.ANY]);return Fie(t,e.slice(i),n)}),Cm=()=>new Map,Qq=t=>{const e=Cm();return t.forEach((n,i)=>{e.set(i,n)}),e},BE=(t,e,n)=>{let i=t.get(e);return i===void 0&&t.set(e,i=n()),i},CWe=(t,e)=>{const n=[];for(const[i,r]of t)n.push(e(r,i));return n},AWe=(t,e)=>{for(const[n,i]of t)if(e(i,n))return!0;return!1},_A=()=>new Set,yH=t=>t[t.length-1],RWe=(t,e)=>{for(let n=0;n<e.length;n++)t.push(e[n])},_1=Array.from,MWe=(t,e)=>{for(let n=0;n<t.length;n++)if(e(t[n],n,t))return!0;return!1},e$=Array.isArray;class F0e{constructor(){this._observers=Cm()}on(e,n){return BE(this._observers,e,_A).add(n),n}once(e,n){const i=(...r)=>{this.off(e,i),n(...r)};this.on(e,i)}off(e,n){const i=this._observers.get(e);i!==void 0&&(i.delete(n),i.size===0&&this._observers.delete(e))}emit(e,n){return _1((this._observers.get(e)||Cm()).values()).forEach(i=>i(...n))}destroy(){this._observers=Cm()}}const uE=Math.floor,cL=Math.abs,z0e=(t,e)=>t<e?t:e,X1=(t,e)=>t>e?t:e,j0e=t=>t!==0?t<0:1/t<0,zie=1,jie=2,bH=4,EH=8,qN=32,v_=64,pf=128,b4=31,t$=63,HT=127,OWe=2147483647,H0e=Number.MAX_SAFE_INTEGER,NWe=Number.isInteger||(t=>typeof t=="number"&&isFinite(t)&&uE(t)===t),IWe=t=>t.toLowerCase(),kWe=/^\s*/g,PWe=t=>t.replace(kWe,""),DWe=/([A-Z])/g,Hie=(t,e)=>PWe(t.replace(DWe,n=>`${e}${IWe(n)}`)),LWe=t=>{const e=unescape(encodeURIComponent(t)),n=e.length,i=new Uint8Array(n);for(let r=0;r<n;r++)i[r]=e.codePointAt(r);return i},$N=typeof TextEncoder<"u"?new TextEncoder:null,UWe=t=>$N.encode(t),BWe=$N?UWe:LWe;let RO=typeof TextDecoder>"u"?null:new TextDecoder("utf-8",{fatal:!0,ignoreBOM:!0});RO&&RO.decode(new Uint8Array).length===1&&(RO=null);class Tk{constructor(){this.cpos=0,this.cbuf=new Uint8Array(100),this.bufs=[]}}const E4=()=>new Tk,FWe=t=>{let e=t.cpos;for(let n=0;n<t.bufs.length;n++)e+=t.bufs[n].length;return e},Gg=t=>{const e=new Uint8Array(FWe(t));let n=0;for(let i=0;i<t.bufs.length;i++){const r=t.bufs[i];e.set(r,n),n+=r.length}return e.set(new Uint8Array(t.cbuf.buffer,0,t.cpos),n),e},zWe=(t,e)=>{const n=t.cbuf.length;n-t.cpos<e&&(t.bufs.push(new Uint8Array(t.cbuf.buffer,0,t.cpos)),t.cbuf=new Uint8Array(X1(n,e)*2),t.cpos=0)},gl=(t,e)=>{const n=t.cbuf.length;t.cpos===n&&(t.bufs.push(t.cbuf),t.cbuf=new Uint8Array(n*2),t.cpos=0),t.cbuf[t.cpos++]=e},n$=gl,es=(t,e)=>{for(;e>HT;)gl(t,pf|HT&e),e=uE(e/128);gl(t,HT&e)},aK=(t,e)=>{const n=j0e(e);for(n&&(e=-e),gl(t,(e>t$?pf:0)|(n?v_:0)|t$&e),e=uE(e/64);e>0;)gl(t,(e>HT?pf:0)|HT&e),e=uE(e/128)},i$=new Uint8Array(3e4),jWe=i$.length/3,HWe=(t,e)=>{if(e.length<jWe){const n=$N.encodeInto(e,i$).written||0;es(t,n);for(let i=0;i<n;i++)gl(t,i$[i])}else Wd(t,BWe(e))},VWe=(t,e)=>{const n=unescape(encodeURIComponent(e)),i=n.length;es(t,i);for(let r=0;r<i;r++)gl(t,n.codePointAt(r))},SC=$N&&$N.encodeInto?HWe:VWe,S4=(t,e)=>{const n=t.cbuf.length,i=t.cpos,r=z0e(n-i,e.length),s=e.length-r;t.cbuf.set(e.subarray(0,r),i),t.cpos+=r,s>0&&(t.bufs.push(t.cbuf),t.cbuf=new Uint8Array(X1(n*2,s)),t.cbuf.set(e.subarray(r)),t.cpos=s)},Wd=(t,e)=>{es(t,e.byteLength),S4(t,e)},oK=(t,e)=>{zWe(t,e);const n=new DataView(t.cbuf.buffer,t.cpos,e);return t.cpos+=e,n},GWe=(t,e)=>oK(t,4).setFloat32(0,e,!1),qWe=(t,e)=>oK(t,8).setFloat64(0,e,!1),$We=(t,e)=>oK(t,8).setBigInt64(0,e,!1),Vie=new DataView(new ArrayBuffer(4)),WWe=t=>(Vie.setFloat32(0,t),Vie.getFloat32(0)===t),WN=(t,e)=>{switch(typeof e){case"string":gl(t,119),SC(t,e);break;case"number":NWe(e)&&cL(e)<=OWe?(gl(t,125),aK(t,e)):WWe(e)?(gl(t,124),GWe(t,e)):(gl(t,123),qWe(t,e));break;case"bigint":gl(t,122),$We(t,e);break;case"object":if(e===null)gl(t,126);else if(e$(e)){gl(t,117),es(t,e.length);for(let n=0;n<e.length;n++)WN(t,e[n])}else if(e instanceof Uint8Array)gl(t,116),Wd(t,e);else{gl(t,118);const n=Object.keys(e);es(t,n.length);for(let i=0;i<n.length;i++){const r=n[i];SC(t,r),WN(t,e[r])}}break;case"boolean":gl(t,e?120:121);break;default:gl(t,127)}};class Gie extends Tk{constructor(e){super(),this.w=e,this.s=null,this.count=0}write(e){this.s===e?this.count++:(this.count>0&&es(this,this.count-1),this.count=1,this.w(this,e),this.s=e)}}const qie=t=>{t.count>0&&(aK(t.encoder,t.count===1?t.s:-t.s),t.count>1&&es(t.encoder,t.count-2))};class lL{constructor(){this.encoder=new Tk,this.s=0,this.count=0}write(e){this.s===e?this.count++:(qie(this),this.count=1,this.s=e)}toUint8Array(){return qie(this),Gg(this.encoder)}}const $ie=t=>{if(t.count>0){const e=t.diff*2+(t.count===1?0:1);aK(t.encoder,e),t.count>1&&es(t.encoder,t.count-2)}};class SH{constructor(){this.encoder=new Tk,this.s=0,this.count=0,this.diff=0}write(e){this.diff===e-this.s?(this.s=e,this.count++):($ie(this),this.count=1,this.diff=e-this.s,this.s=e)}toUint8Array(){return $ie(this),Gg(this.encoder)}}class YWe{constructor(){this.sarr=[],this.s="",this.lensE=new lL}write(e){this.s+=e,this.s.length>19&&(this.sarr.push(this.s),this.s=""),this.lensE.write(e.length)}toUint8Array(){const e=new Tk;return this.sarr.push(this.s),this.s="",SC(e,this.sarr.join("")),S4(e,this.lensE.toUint8Array()),Gg(e)}}const hE=t=>new Error(t),t0=()=>{throw hE("Method unimplemented")},c0=()=>{throw hE("Unexpected case")},V0e=hE("Unexpected end of array"),G0e=hE("Integer out of Range");class T4{constructor(e){this.arr=e,this.pos=0}}const pR=t=>new T4(t),KWe=t=>t.pos!==t.arr.length,XWe=(t,e)=>{const n=new Uint8Array(t.arr.buffer,t.pos+t.arr.byteOffset,e);return t.pos+=e,n},Yd=t=>XWe(t,Tr(t)),yA=t=>t.arr[t.pos++],Tr=t=>{let e=0,n=1;const i=t.arr.length;for(;t.pos<i;){const r=t.arr[t.pos++];if(e=e+(r&HT)*n,n*=128,r<pf)return e;if(e>H0e)throw G0e}throw V0e},cK=t=>{let e=t.arr[t.pos++],n=e&t$,i=64;const r=(e&v_)>0?-1:1;if(!(e&pf))return r*n;const s=t.arr.length;for(;t.pos<s;){if(e=t.arr[t.pos++],n=n+(e&HT)*i,i*=128,e<pf)return r*n;if(n>H0e)throw G0e}throw V0e},ZWe=t=>{let e=Tr(t);if(e===0)return"";{let n=String.fromCodePoint(yA(t));if(--e<100)for(;e--;)n+=String.fromCodePoint(yA(t));else for(;e>0;){const i=e<1e4?e:1e4,r=t.arr.subarray(t.pos,t.pos+i);t.pos+=i,n+=String.fromCodePoint.apply(null,r),e-=i}return decodeURIComponent(escape(n))}},JWe=t=>RO.decode(Yd(t)),TC=RO?JWe:ZWe,lK=(t,e)=>{const n=new DataView(t.arr.buffer,t.arr.byteOffset+t.pos,e);return t.pos+=e,n},QWe=t=>lK(t,4).getFloat32(0,!1),e9e=t=>lK(t,8).getFloat64(0,!1),t9e=t=>lK(t,8).getBigInt64(0,!1),n9e=[t=>{},t=>null,cK,QWe,e9e,t9e,t=>!1,t=>!0,TC,t=>{const e=Tr(t),n={};for(let i=0;i<e;i++){const r=TC(t);n[r]=YN(t)}return n},t=>{const e=Tr(t),n=[];for(let i=0;i<e;i++)n.push(YN(t));return n},Yd],YN=t=>n9e[127-yA(t)](t);class Wie extends T4{constructor(e,n){super(e),this.reader=n,this.s=null,this.count=0}read(){return this.count===0&&(this.s=this.reader(this),KWe(this)?this.count=Tr(this)+1:this.count=-1),this.count--,this.s}}class uL extends T4{constructor(e){super(e),this.s=0,this.count=0}read(){if(this.count===0){this.s=cK(this);const e=j0e(this.s);this.count=1,e&&(this.s=-this.s,this.count=Tr(this)+2)}return this.count--,this.s}}class TH extends T4{constructor(e){super(e),this.s=0,this.count=0,this.diff=0}read(){if(this.count===0){const e=cK(this),n=e&1;this.diff=uE(e/2),this.count=1,n&&(this.count=Tr(this)+2)}return this.s+=this.diff,this.count--,this.s}}class i9e{constructor(e){this.decoder=new uL(e),this.str=TC(this.decoder),this.spos=0}read(){const e=this.spos+this.decoder.read(),n=this.str.slice(this.spos,e);return this.spos=e,n}}const r9e=crypto.getRandomValues.bind(crypto),q0e=()=>r9e(new Uint32Array(1))[0],s9e="10000000-1000-4000-8000"+-1e11,a9e=()=>s9e.replace(/[018]/g,t=>(t^q0e()&15>>t/4).toString(16)),o9e=Date.now,Yie=t=>new Promise(t);Promise.all.bind(Promise);const Kie=t=>t===void 0?null:t;class c9e{constructor(){this.map=new Map}setItem(e,n){this.map.set(e,n)}getItem(e){return this.map.get(e)}}let $0e=new c9e,l9e=!0;try{typeof localStorage<"u"&&localStorage&&($0e=localStorage,l9e=!1)}catch{}const u9e=$0e,h9e=Object.assign,d9e=Object.keys,f9e=(t,e)=>{for(const n in t)e(t[n],n)},Xie=t=>d9e(t).length,p9e=t=>{for(const e in t)return!1;return!0},m9e=(t,e)=>{for(const n in t)if(!e(t[n],n))return!1;return!0},g9e=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),v9e=(t,e)=>t===e||Xie(t)===Xie(e)&&m9e(t,(n,i)=>(n!==void 0||g9e(e,i))&&e[i]===n),_9e=Object.freeze,W0e=t=>{for(const e in t){const n=t[e];(typeof n=="object"||typeof n=="function")&&W0e(t[e])}return _9e(t)},uK=(t,e,n=0)=>{try{for(;n<t.length;n++)t[n](...e)}finally{n<t.length&&uK(t,e,n+1)}},y9e=t=>t,b9e=(t,e)=>e.includes(t);var Y0e={};const KN=typeof Gn<"u"&&Gn.release&&/node|io\.js/.test(Gn.release.name)&&Object.prototype.toString.call(typeof Gn<"u"?Gn:0)==="[object process]";let Tg;const E9e=()=>{if(Tg===void 0)if(KN){Tg=Cm();const t=Gn.argv;let e=null;for(let n=0;n<t.length;n++){const i=t[n];i[0]==="-"?(e!==null&&Tg.set(e,""),e=i):e!==null&&(Tg.set(e,i),e=null)}e!==null&&Tg.set(e,"")}else typeof location=="object"?(Tg=Cm(),(location.search||"?").slice(1).split("&").forEach(t=>{if(t.length!==0){const[e,n]=t.split("=");Tg.set(`--${Hie(e,"-")}`,n),Tg.set(`-${Hie(e,"-")}`,n)}})):Tg=Cm();return Tg},r$=t=>E9e().has(t),V3=t=>Kie(KN?Y0e[t.toUpperCase().replaceAll("-","_")]:u9e.getItem(t)),K0e=t=>r$("--"+t)||V3(t)!==null;K0e("production");const S9e=KN&&b9e(Y0e.FORCE_COLOR,["true","1","2"]),T9e=S9e||!r$("--no-colors")&&!K0e("no-color")&&(!KN||Gn.stdout.isTTY)&&(!KN||r$("--color")||V3("COLORTERM")!==null||(V3("TERM")||"").includes("color")),x9e=t=>new Uint8Array(t),w9e=t=>{const e=x9e(t.byteLength);return e.set(t),e};class C9e{constructor(e,n){this.left=e,this.right=n}}const Dv=(t,e)=>new C9e(t,e);typeof DOMParser<"u"&&new DOMParser;const A9e=t=>CWe(t,(e,n)=>`${n}:${e};`).join(""),$_=Symbol,X0e=$_(),Z0e=$_(),R9e=$_(),M9e=$_(),O9e=$_(),J0e=$_(),N9e=$_(),hK=$_(),I9e=$_(),k9e=t=>{var r;t.length===1&&((r=t[0])==null?void 0:r.constructor)===Function&&(t=t[0]());const e=[],n=[];let i=0;for(;i<t.length;i++){const s=t[i];if(s===void 0)break;if(s.constructor===String||s.constructor===Number)e.push(s);else if(s.constructor===Object)break}for(i>0&&n.push(e.join(""));i<t.length;i++){const s=t[i];s instanceof Symbol||n.push(s)}return n},P9e={[X0e]:Dv("font-weight","bold"),[Z0e]:Dv("font-weight","normal"),[R9e]:Dv("color","blue"),[O9e]:Dv("color","green"),[M9e]:Dv("color","grey"),[J0e]:Dv("color","red"),[N9e]:Dv("color","purple"),[hK]:Dv("color","orange"),[I9e]:Dv("color","black")},D9e=t=>{var a;t.length===1&&((a=t[0])==null?void 0:a.constructor)===Function&&(t=t[0]());const e=[],n=[],i=Cm();let r=[],s=0;for(;s<t.length;s++){const o=t[s],c=P9e[o];if(c!==void 0)i.set(c.left,c.right);else{if(o===void 0)break;if(o.constructor===String||o.constructor===Number){const l=A9e(i);s>0||l.length>0?(e.push("%c"+o),n.push(l)):e.push(o)}else break}}for(s>0&&(r=n,r.unshift(e.join("")));s<t.length;s++){const o=t[s];o instanceof Symbol||r.push(o)}return r},Q0e=T9e?D9e:k9e,L9e=(...t)=>{console.log(...Q0e(t)),tve.forEach(e=>e.print(t))},eve=(...t)=>{console.warn(...Q0e(t)),t.unshift(hK),tve.forEach(e=>e.print(t))},tve=_A(),nve=t=>({[Symbol.iterator](){return this},next:t}),U9e=(t,e)=>nve(()=>{let n;do n=t.next();while(!n.done&&!e(n.value));return n}),xH=(t,e)=>nve(()=>{const{done:n,value:i}=t.next();return{done:n,value:n?void 0:e(i)}});class dK{constructor(e,n){this.clock=e,this.len=n}}class mR{constructor(){this.clients=new Map}}const bA=(t,e,n)=>e.clients.forEach((i,r)=>{const s=t.doc.store.clients.get(r);for(let a=0;a<i.length;a++){const o=i[a];hve(t,s,o.clock,o.len,n)}}),B9e=(t,e)=>{let n=0,i=t.length-1;for(;n<=i;){const r=uE((n+i)/2),s=t[r],a=s.clock;if(a<=e){if(e<a+s.len)return r;n=r+1}else i=r-1}return null},xk=(t,e)=>{const n=t.clients.get(e.client);return n!==void 0&&B9e(n,e.clock)!==null},fK=t=>{t.clients.forEach(e=>{e.sort((r,s)=>r.clock-s.clock);let n,i;for(n=1,i=1;n<e.length;n++){const r=e[i-1],s=e[n];r.clock+r.len>=s.clock?r.len=X1(r.len,s.clock+s.len-r.clock):(i<n&&(e[i]=s),i++)}e.length=i})},s$=t=>{const e=new mR;for(let n=0;n<t.length;n++)t[n].clients.forEach((i,r)=>{if(!e.clients.has(r)){const s=i.slice();for(let a=n+1;a<t.length;a++)RWe(s,t[a].clients.get(r)||[]);e.clients.set(r,s)}});return fK(e),e},XN=(t,e,n,i)=>{BE(t.clients,e,()=>[]).push(new dK(n,i))},F9e=()=>new mR,z9e=t=>{const e=F9e();return t.clients.forEach((n,i)=>{const r=[];for(let s=0;s<n.length;s++){const a=n[s];if(a.deleted){const o=a.id.clock;let c=a.length;if(s+1<n.length)for(let l=n[s+1];s+1<n.length&&l.deleted;l=n[++s+1])c+=l.length;r.push(new dK(o,c))}}r.length>0&&e.clients.set(i,r)}),e},gR=(t,e)=>{es(t.restEncoder,e.clients.size),_1(e.clients.entries()).sort((n,i)=>i[0]-n[0]).forEach(([n,i])=>{t.resetDsCurVal(),es(t.restEncoder,n);const r=i.length;es(t.restEncoder,r);for(let s=0;s<r;s++){const a=i[s];t.writeDsClock(a.clock),t.writeDsLen(a.len)}})},pK=t=>{const e=new mR,n=Tr(t.restDecoder);for(let i=0;i<n;i++){t.resetDsCurVal();const r=Tr(t.restDecoder),s=Tr(t.restDecoder);if(s>0){const a=BE(e.clients,r,()=>[]);for(let o=0;o<s;o++)a.push(new dK(t.readDsClock(),t.readDsLen()))}}return e},Zie=(t,e,n)=>{const i=new mR,r=Tr(t.restDecoder);for(let s=0;s<r;s++){t.resetDsCurVal();const a=Tr(t.restDecoder),o=Tr(t.restDecoder),c=n.clients.get(a)||[],l=Yc(n,a);for(let u=0;u<o;u++){const h=t.readDsClock(),d=h+t.readDsLen();if(h<l){l<d&&XN(i,a,l,d-l);let f=l0(c,h),p=c[f];for(!p.deleted&&p.id.clock<h&&(c.splice(f+1,0,Z3(e,p,h-p.id.clock)),f++);f<c.length&&(p=c[f++],p.id.clock<d);)p.deleted||(d<p.id.clock+p.length&&c.splice(f,0,Z3(e,p,d-p.id.clock)),p.delete(e))}else XN(i,a,h,d-h)}}if(i.clients.size>0){const s=new y1;return es(s.restEncoder,0),gR(s,i),s.toUint8Array()}return null},ive=q0e;class Z1 extends F0e{constructor({guid:e=a9e(),collectionid:n=null,gc:i=!0,gcFilter:r=()=>!0,meta:s=null,autoLoad:a=!1,shouldLoad:o=!0}={}){super(),this.gc=i,this.gcFilter=r,this.clientID=ive(),this.guid=e,this.collectionid=n,this.share=new Map,this.store=new lve,this._transaction=null,this._transactionCleanups=[],this.subdocs=new Set,this._item=null,this.shouldLoad=o,this.autoLoad=a,this.meta=s,this.isLoaded=!1,this.isSynced=!1,this.isDestroyed=!1,this.whenLoaded=Yie(l=>{this.on("load",()=>{this.isLoaded=!0,l(this)})});const c=()=>Yie(l=>{const u=h=>{(h===void 0||h===!0)&&(this.off("sync",u),l())};this.on("sync",u)});this.on("sync",l=>{l===!1&&this.isSynced&&(this.whenSynced=c()),this.isSynced=l===void 0||l===!0,this.isSynced&&!this.isLoaded&&this.emit("load",[this])}),this.whenSynced=c()}load(){const e=this._item;e!==null&&!this.shouldLoad&&Js(e.parent.doc,n=>{n.subdocsLoaded.add(this)},null,!0),this.shouldLoad=!0}getSubdocs(){return this.subdocs}getSubdocGuids(){return new Set(_1(this.subdocs).map(e=>e.guid))}transact(e,n=null){return Js(this,e,n)}get(e,n=Al){const i=BE(this.share,e,()=>{const s=new n;return s._integrate(this,null),s}),r=i.constructor;if(n!==Al&&r!==n)if(r===Al){const s=new n;s._map=i._map,i._map.forEach(a=>{for(;a!==null;a=a.left)a.parent=s}),s._start=i._start;for(let a=s._start;a!==null;a=a.right)a.parent=s;return s._length=i._length,this.share.set(e,s),s._integrate(this,null),s}else throw new Error(`Type with the name ${e} has already been defined with a different constructor`);return i}getArray(e=""){return this.get(e,wC)}getText(e=""){return this.get(e,u0)}getMap(e=""){return this.get(e,SA)}getXmlElement(e=""){return this.get(e,TA)}getXmlFragment(e=""){return this.get(e,b1)}toJSON(){const e={};return this.share.forEach((n,i)=>{e[i]=n.toJSON()}),e}destroy(){this.isDestroyed=!0,_1(this.subdocs).forEach(n=>n.destroy());const e=this._item;if(e!==null){this._item=null;const n=e.content;n.doc=new Z1({guid:this.guid,...n.opts,shouldLoad:!1}),n.doc._item=e,Js(e.parent.doc,i=>{const r=n.doc;e.deleted||i.subdocsAdded.add(r),i.subdocsRemoved.add(this)},null,!0)}this.emit("destroyed",[!0]),this.emit("destroy",[this]),super.destroy()}}class rve{constructor(e){this.restDecoder=e}resetDsCurVal(){}readDsClock(){return Tr(this.restDecoder)}readDsLen(){return Tr(this.restDecoder)}}class sve extends rve{readLeftID(){return wr(Tr(this.restDecoder),Tr(this.restDecoder))}readRightID(){return wr(Tr(this.restDecoder),Tr(this.restDecoder))}readClient(){return Tr(this.restDecoder)}readInfo(){return yA(this.restDecoder)}readString(){return TC(this.restDecoder)}readParentInfo(){return Tr(this.restDecoder)===1}readTypeRef(){return Tr(this.restDecoder)}readLen(){return Tr(this.restDecoder)}readAny(){return YN(this.restDecoder)}readBuf(){return w9e(Yd(this.restDecoder))}readJSON(){return JSON.parse(TC(this.restDecoder))}readKey(){return TC(this.restDecoder)}}class j9e{constructor(e){this.dsCurrVal=0,this.restDecoder=e}resetDsCurVal(){this.dsCurrVal=0}readDsClock(){return this.dsCurrVal+=Tr(this.restDecoder),this.dsCurrVal}readDsLen(){const e=Tr(this.restDecoder)+1;return this.dsCurrVal+=e,e}}class EA extends j9e{constructor(e){super(e),this.keys=[],Tr(e),this.keyClockDecoder=new TH(Yd(e)),this.clientDecoder=new uL(Yd(e)),this.leftClockDecoder=new TH(Yd(e)),this.rightClockDecoder=new TH(Yd(e)),this.infoDecoder=new Wie(Yd(e),yA),this.stringDecoder=new i9e(Yd(e)),this.parentInfoDecoder=new Wie(Yd(e),yA),this.typeRefDecoder=new uL(Yd(e)),this.lenDecoder=new uL(Yd(e))}readLeftID(){return new xC(this.clientDecoder.read(),this.leftClockDecoder.read())}readRightID(){return new xC(this.clientDecoder.read(),this.rightClockDecoder.read())}readClient(){return this.clientDecoder.read()}readInfo(){return this.infoDecoder.read()}readString(){return this.stringDecoder.read()}readParentInfo(){return this.parentInfoDecoder.read()===1}readTypeRef(){return this.typeRefDecoder.read()}readLen(){return this.lenDecoder.read()}readAny(){return YN(this.restDecoder)}readBuf(){return Yd(this.restDecoder)}readJSON(){return YN(this.restDecoder)}readKey(){const e=this.keyClockDecoder.read();if(e<this.keys.length)return this.keys[e];{const n=this.stringDecoder.read();return this.keys.push(n),n}}}class H9e{constructor(){this.restEncoder=E4()}toUint8Array(){return Gg(this.restEncoder)}resetDsCurVal(){}writeDsClock(e){es(this.restEncoder,e)}writeDsLen(e){es(this.restEncoder,e)}}class wk extends H9e{writeLeftID(e){es(this.restEncoder,e.client),es(this.restEncoder,e.clock)}writeRightID(e){es(this.restEncoder,e.client),es(this.restEncoder,e.clock)}writeClient(e){es(this.restEncoder,e)}writeInfo(e){n$(this.restEncoder,e)}writeString(e){SC(this.restEncoder,e)}writeParentInfo(e){es(this.restEncoder,e?1:0)}writeTypeRef(e){es(this.restEncoder,e)}writeLen(e){es(this.restEncoder,e)}writeAny(e){WN(this.restEncoder,e)}writeBuf(e){Wd(this.restEncoder,e)}writeJSON(e){SC(this.restEncoder,JSON.stringify(e))}writeKey(e){SC(this.restEncoder,e)}}class V9e{constructor(){this.restEncoder=E4(),this.dsCurrVal=0}toUint8Array(){return Gg(this.restEncoder)}resetDsCurVal(){this.dsCurrVal=0}writeDsClock(e){const n=e-this.dsCurrVal;this.dsCurrVal=e,es(this.restEncoder,n)}writeDsLen(e){e===0&&c0(),es(this.restEncoder,e-1),this.dsCurrVal+=e}}class y1 extends V9e{constructor(){super(),this.keyMap=new Map,this.keyClock=0,this.keyClockEncoder=new SH,this.clientEncoder=new lL,this.leftClockEncoder=new SH,this.rightClockEncoder=new SH,this.infoEncoder=new Gie(n$),this.stringEncoder=new YWe,this.parentInfoEncoder=new Gie(n$),this.typeRefEncoder=new lL,this.lenEncoder=new lL}toUint8Array(){const e=E4();return es(e,0),Wd(e,this.keyClockEncoder.toUint8Array()),Wd(e,this.clientEncoder.toUint8Array()),Wd(e,this.leftClockEncoder.toUint8Array()),Wd(e,this.rightClockEncoder.toUint8Array()),Wd(e,Gg(this.infoEncoder)),Wd(e,this.stringEncoder.toUint8Array()),Wd(e,Gg(this.parentInfoEncoder)),Wd(e,this.typeRefEncoder.toUint8Array()),Wd(e,this.lenEncoder.toUint8Array()),S4(e,Gg(this.restEncoder)),Gg(e)}writeLeftID(e){this.clientEncoder.write(e.client),this.leftClockEncoder.write(e.clock)}writeRightID(e){this.clientEncoder.write(e.client),this.rightClockEncoder.write(e.clock)}writeClient(e){this.clientEncoder.write(e)}writeInfo(e){this.infoEncoder.write(e)}writeString(e){this.stringEncoder.write(e)}writeParentInfo(e){this.parentInfoEncoder.write(e?1:0)}writeTypeRef(e){this.typeRefEncoder.write(e)}writeLen(e){this.lenEncoder.write(e)}writeAny(e){WN(this.restEncoder,e)}writeBuf(e){Wd(this.restEncoder,e)}writeJSON(e){WN(this.restEncoder,e)}writeKey(e){const n=this.keyMap.get(e);n===void 0?(this.keyClockEncoder.write(this.keyClock++),this.stringEncoder.write(e)):this.keyClockEncoder.write(n)}}const G9e=(t,e,n,i)=>{i=X1(i,e[0].id.clock);const r=l0(e,i);es(t.restEncoder,e.length-r),t.writeClient(n),es(t.restEncoder,i);const s=e[r];s.write(t,i-s.id.clock);for(let a=r+1;a<e.length;a++)e[a].write(t,0)},mK=(t,e,n)=>{const i=new Map;n.forEach((r,s)=>{Yc(e,s)>r&&i.set(s,r)}),gK(e).forEach((r,s)=>{n.has(s)||i.set(s,0)}),es(t.restEncoder,i.size),_1(i.entries()).sort((r,s)=>s[0]-r[0]).forEach(([r,s])=>{G9e(t,e.clients.get(r),r,s)})},q9e=(t,e)=>{const n=Cm(),i=Tr(t.restDecoder);for(let r=0;r<i;r++){const s=Tr(t.restDecoder),a=new Array(s),o=t.readClient();let c=Tr(t.restDecoder);n.set(o,{i:0,refs:a});for(let l=0;l<s;l++){const u=t.readInfo();switch(b4&u){case 0:{const h=t.readLen();a[l]=new ap(wr(o,c),h),c+=h;break}case 10:{const h=Tr(t.restDecoder);a[l]=new op(wr(o,c),h),c+=h;break}default:{const h=(u&(v_|pf))===0,d=new Aa(wr(o,c),null,(u&pf)===pf?t.readLeftID():null,null,(u&v_)===v_?t.readRightID():null,h?t.readParentInfo()?e.get(t.readString()):t.readLeftID():null,h&&(u&qN)===qN?t.readString():null,Nve(t,u));a[l]=d,c+=d.length}}}}return n},$9e=(t,e,n)=>{const i=[];let r=_1(n.keys()).sort((f,p)=>f-p);if(r.length===0)return null;const s=()=>{if(r.length===0)return null;let f=n.get(r[r.length-1]);for(;f.refs.length===f.i;)if(r.pop(),r.length>0)f=n.get(r[r.length-1]);else return null;return f};let a=s();if(a===null)return null;const o=new lve,c=new Map,l=(f,p)=>{const g=c.get(f);(g==null||g>p)&&c.set(f,p)};let u=a.refs[a.i++];const h=new Map,d=()=>{for(const f of i){const p=f.id.client,g=n.get(p);g?(g.i--,o.clients.set(p,g.refs.slice(g.i)),n.delete(p),g.i=0,g.refs=[]):o.clients.set(p,[f]),r=r.filter(_=>_!==p)}i.length=0};for(;;){if(u.constructor!==op){const p=BE(h,u.id.client,()=>Yc(e,u.id.client))-u.id.clock;if(p<0)i.push(u),l(u.id.client,u.id.clock-1),d();else{const g=u.getMissing(t,e);if(g!==null){i.push(u);const _=n.get(g)||{refs:[],i:0};if(_.refs.length===_.i)l(g,Yc(e,g)),d();else{u=_.refs[_.i++];continue}}else(p===0||p<u.length)&&(u.integrate(t,p),h.set(u.id.client,u.id.clock+u.length))}}if(i.length>0)u=i.pop();else if(a!==null&&a.i<a.refs.length)u=a.refs[a.i++];else{if(a=s(),a===null)break;u=a.refs[a.i++]}}if(o.clients.size>0){const f=new y1;return mK(f,o,new Map),es(f.restEncoder,0),{missing:c,update:f.toUint8Array()}}return null},W9e=(t,e)=>mK(t,e.doc.store,e.beforeState),Y9e=(t,e,n,i=new EA(t))=>Js(e,r=>{r.local=!1;let s=!1;const a=r.doc,o=a.store,c=q9e(i,a),l=$9e(r,o,c),u=o.pendingStructs;if(u){for(const[d,f]of u.missing)if(f<Yc(o,d)){s=!0;break}if(l){for(const[d,f]of l.missing){const p=u.missing.get(d);(p==null||p>f)&&u.missing.set(d,f)}u.update=q3([u.update,l.update])}}else o.pendingStructs=l;const h=Zie(i,r,o);if(o.pendingDs){const d=new EA(pR(o.pendingDs));Tr(d.restDecoder);const f=Zie(d,r,o);h&&f?o.pendingDs=q3([h,f]):o.pendingDs=h||f}else o.pendingDs=h;if(s){const d=o.pendingStructs.update;o.pendingStructs=null,ave(r.doc,d)}},n,!1),ave=(t,e,n,i=EA)=>{const r=pR(e);Y9e(r,t,n,new i(r))},Jie=(t,e,n)=>ave(t,e,n,sve),K9e=(t,e,n=new Map)=>{mK(t,e.store,n),gR(t,z9e(e.store))},X9e=(t,e=new Uint8Array([0]),n=new y1)=>{const i=ove(e);K9e(n,t,i);const r=[n.toUint8Array()];if(t.store.pendingDs&&r.push(t.store.pendingDs),t.store.pendingStructs&&r.push(hYe(t.store.pendingStructs.update,e)),r.length>1){if(n.constructor===wk)return lYe(r.map((s,a)=>a===0?s:fYe(s)));if(n.constructor===y1)return q3(r)}return r[0]},Z9e=(t,e)=>X9e(t,e,new wk),J9e=t=>{const e=new Map,n=Tr(t.restDecoder);for(let i=0;i<n;i++){const r=Tr(t.restDecoder),s=Tr(t.restDecoder);e.set(r,s)}return e},ove=t=>J9e(new rve(pR(t)));class Q9e{constructor(){this.l=[]}}const Qie=()=>new Q9e,ere=(t,e)=>t.l.push(e),tre=(t,e)=>{const n=t.l,i=n.length;t.l=n.filter(r=>e!==r),i===t.l.length&&console.error("[yjs] Tried to remove event handler that doesn't exist.")},cve=(t,e,n)=>uK(t.l,[e,n]);class xC{constructor(e,n){this.client=e,this.clock=n}}const e2=(t,e)=>t===e||t!==null&&e!==null&&t.client===e.client&&t.clock===e.clock,wr=(t,e)=>new xC(t,e),eYe=t=>{for(const[e,n]of t.doc.share.entries())if(n===t)return e;throw c0()},G3=(t,e)=>{for(;e!==null;){if(e.parent===t)return!0;e=e.parent._item}return!1},Mw=(t,e)=>e===void 0?!t.deleted:e.sv.has(t.id.client)&&(e.sv.get(t.id.client)||0)>t.id.clock&&!xk(e.ds,t.id),a$=(t,e)=>{const n=BE(t.meta,a$,_A),i=t.doc.store;n.has(e)||(e.sv.forEach((r,s)=>{r<Yc(i,s)&&nd(t,wr(s,r))}),bA(t,e.ds,r=>{}),n.add(e))};class lve{constructor(){this.clients=new Map,this.pendingStructs=null,this.pendingDs=null}}const gK=t=>{const e=new Map;return t.clients.forEach((n,i)=>{const r=n[n.length-1];e.set(i,r.id.clock+r.length)}),e},Yc=(t,e)=>{const n=t.clients.get(e);if(n===void 0)return 0;const i=n[n.length-1];return i.id.clock+i.length},uve=(t,e)=>{let n=t.clients.get(e.id.client);if(n===void 0)n=[],t.clients.set(e.id.client,n);else{const i=n[n.length-1];if(i.id.clock+i.length!==e.id.clock)throw c0()}n.push(e)},l0=(t,e)=>{let n=0,i=t.length-1,r=t[i],s=r.id.clock;if(s===e)return i;let a=uE(e/(s+r.length-1)*i);for(;n<=i;){if(r=t[a],s=r.id.clock,s<=e){if(e<s+r.length)return a;n=a+1}else i=a-1;a=uE((n+i)/2)}throw c0()},tYe=(t,e)=>{const n=t.clients.get(e.client);return n[l0(n,e.clock)]},hL=tYe,o$=(t,e,n)=>{const i=l0(e,n),r=e[i];return r.id.clock<n&&r instanceof Aa?(e.splice(i+1,0,Z3(t,r,n-r.id.clock)),i+1):i},nd=(t,e)=>{const n=t.doc.store.clients.get(e.client);return n[o$(t,n,e.clock)]},nre=(t,e,n)=>{const i=e.clients.get(n.client),r=l0(i,n.clock),s=i[r];return n.clock!==s.id.clock+s.length-1&&s.constructor!==ap&&i.splice(r+1,0,Z3(t,s,n.clock-s.id.clock+1)),s},nYe=(t,e,n)=>{const i=t.clients.get(e.id.client);i[l0(i,e.id.clock)]=n},hve=(t,e,n,i,r)=>{if(i===0)return;const s=n+i;let a=o$(t,e,n),o;do o=e[a++],s<o.id.clock+o.length&&o$(t,e,s),r(o);while(a<e.length&&e[a].id.clock<s)};class iYe{constructor(e,n,i){this.doc=e,this.deleteSet=new mR,this.beforeState=gK(e.store),this.afterState=new Map,this.changed=new Map,this.changedParentTypes=new Map,this._mergeStructs=[],this.origin=n,this.meta=new Map,this.local=i,this.subdocsAdded=new Set,this.subdocsRemoved=new Set,this.subdocsLoaded=new Set,this._needFormattingCleanup=!1}}const ire=(t,e)=>e.deleteSet.clients.size===0&&!AWe(e.afterState,(n,i)=>e.beforeState.get(i)!==n)?!1:(fK(e.deleteSet),W9e(t,e),gR(t,e.deleteSet),!0),rre=(t,e,n)=>{const i=e._item;(i===null||i.id.clock<(t.beforeState.get(i.id.client)||0)&&!i.deleted)&&BE(t.changed,e,_A).add(n)},dL=(t,e)=>{let n=t[e],i=t[e-1],r=e;for(;r>0;n=i,i=t[--r-1]){if(i.deleted===n.deleted&&i.constructor===n.constructor&&i.mergeWith(n)){n instanceof Aa&&n.parentSub!==null&&n.parent._map.get(n.parentSub)===n&&n.parent._map.set(n.parentSub,i);continue}break}const s=e-r;return s&&t.splice(e+1-s,s),s},rYe=(t,e,n)=>{for(const[i,r]of t.clients.entries()){const s=e.clients.get(i);for(let a=r.length-1;a>=0;a--){const o=r[a],c=o.clock+o.len;for(let l=l0(s,o.clock),u=s[l];l<s.length&&u.id.clock<c;u=s[++l]){const h=s[l];if(o.clock+o.len<=h.id.clock)break;h instanceof Aa&&h.deleted&&!h.keep&&n(h)&&h.gc(e,!1)}}}},sYe=(t,e)=>{t.clients.forEach((n,i)=>{const r=e.clients.get(i);for(let s=n.length-1;s>=0;s--){const a=n[s],o=z0e(r.length-1,1+l0(r,a.clock+a.len-1));for(let c=o,l=r[c];c>0&&l.id.clock>=a.clock;l=r[c])c-=1+dL(r,c)}})},dve=(t,e)=>{if(e<t.length){const n=t[e],i=n.doc,r=i.store,s=n.deleteSet,a=n._mergeStructs;try{fK(s),n.afterState=gK(n.doc.store),i.emit("beforeObserverCalls",[n,i]);const o=[];n.changed.forEach((c,l)=>o.push(()=>{(l._item===null||!l._item.deleted)&&l._callObserver(n,c)})),o.push(()=>{n.changedParentTypes.forEach((c,l)=>{l._dEH.l.length>0&&(l._item===null||!l._item.deleted)&&(c=c.filter(u=>u.target._item===null||!u.target._item.deleted),c.forEach(u=>{u.currentTarget=l,u._path=null}),c.sort((u,h)=>u.path.length-h.path.length),cve(l._dEH,c,n))})}),o.push(()=>i.emit("afterTransaction",[n,i])),uK(o,[]),n._needFormattingCleanup&&AYe(n)}finally{i.gc&&rYe(s,r,i.gcFilter),sYe(s,r),n.afterState.forEach((u,h)=>{const d=n.beforeState.get(h)||0;if(d!==u){const f=r.clients.get(h),p=X1(l0(f,d),1);for(let g=f.length-1;g>=p;)g-=1+dL(f,g)}});for(let u=a.length-1;u>=0;u--){const{client:h,clock:d}=a[u].id,f=r.clients.get(h),p=l0(f,d);p+1<f.length&&dL(f,p+1)>1||p>0&&dL(f,p)}if(!n.local&&n.afterState.get(i.clientID)!==n.beforeState.get(i.clientID)&&(L9e(hK,X0e,"[yjs] ",Z0e,J0e,"Changed the client-id because another client seems to be using it."),i.clientID=ive()),i.emit("afterTransactionCleanup",[n,i]),i._observers.has("update")){const u=new wk;ire(u,n)&&i.emit("update",[u.toUint8Array(),n.origin,i,n])}if(i._observers.has("updateV2")){const u=new y1;ire(u,n)&&i.emit("updateV2",[u.toUint8Array(),n.origin,i,n])}const{subdocsAdded:o,subdocsLoaded:c,subdocsRemoved:l}=n;(o.size>0||l.size>0||c.size>0)&&(o.forEach(u=>{u.clientID=i.clientID,u.collectionid==null&&(u.collectionid=i.collectionid),i.subdocs.add(u)}),l.forEach(u=>i.subdocs.delete(u)),i.emit("subdocs",[{loaded:c,added:o,removed:l},i,n]),l.forEach(u=>u.destroy())),t.length<=e+1?(i._transactionCleanups=[],i.emit("afterAllTransactions",[i,t])):dve(t,e+1)}}},Js=(t,e,n=null,i=!0)=>{const r=t._transactionCleanups;let s=!1,a=null;t._transaction===null&&(s=!0,t._transaction=new iYe(t,n,i),r.push(t._transaction),r.length===1&&t.emit("beforeAllTransactions",[t]),t.emit("beforeTransaction",[t._transaction,t]));try{a=e(t._transaction)}finally{if(s){const o=t._transaction===r[0];t._transaction=null,o&&dve(r,0)}}return a};class aYe{constructor(e,n){this.insertions=n,this.deletions=e,this.meta=new Map}}const sre=(t,e,n)=>{bA(t,n.deletions,i=>{i instanceof Aa&&e.scope.some(r=>r===t.doc||G3(r,i))&&xK(i,!1)})},are=(t,e,n)=>{let i=null;const r=t.doc,s=t.scope;Js(r,o=>{for(;e.length>0&&t.currStackItem===null;){const c=r.store,l=e.pop(),u=new Set,h=[];let d=!1;bA(o,l.insertions,f=>{if(f instanceof Aa){if(f.redone!==null){let{item:p,diff:g}=eKe(c,f.id);g>0&&(p=nd(o,wr(p.id.client,p.id.clock+g))),f=p}!f.deleted&&s.some(p=>p===o.doc||G3(p,f))&&h.push(f)}}),bA(o,l.deletions,f=>{f instanceof Aa&&s.some(p=>p===o.doc||G3(p,f))&&!xk(l.insertions,f.id)&&u.add(f)}),u.forEach(f=>{d=Ove(o,f,u,l.insertions,t.ignoreRemoteMapChanges,t)!==null||d});for(let f=h.length-1;f>=0;f--){const p=h[f];t.deleteFilter(p)&&(p.delete(o),d=!0)}t.currStackItem=d?l:null}o.changed.forEach((c,l)=>{c.has(null)&&l._searchMarker&&(l._searchMarker.length=0)}),i=o},t);const a=t.currStackItem;if(a!=null){const o=i.changedParentTypes;t.emit("stack-item-popped",[{stackItem:a,type:n,changedParentTypes:o,origin:t},t]),t.currStackItem=null}return a};class oYe extends F0e{constructor(e,{captureTimeout:n=500,captureTransaction:i=c=>!0,deleteFilter:r=()=>!0,trackedOrigins:s=new Set([null]),ignoreRemoteMapChanges:a=!1,doc:o=e$(e)?e[0].doc:e instanceof Z1?e:e.doc}={}){super(),this.scope=[],this.doc=o,this.addToScope(e),this.deleteFilter=r,s.add(this),this.trackedOrigins=s,this.captureTransaction=i,this.undoStack=[],this.redoStack=[],this.undoing=!1,this.redoing=!1,this.currStackItem=null,this.lastChange=0,this.ignoreRemoteMapChanges=a,this.captureTimeout=n,this.afterTransactionHandler=c=>{if(!this.captureTransaction(c)||!this.scope.some(_=>c.changedParentTypes.has(_)||_===this.doc)||!this.trackedOrigins.has(c.origin)&&(!c.origin||!this.trackedOrigins.has(c.origin.constructor)))return;const l=this.undoing,u=this.redoing,h=l?this.redoStack:this.undoStack;l?this.stopCapturing():u||this.clear(!1,!0);const d=new mR;c.afterState.forEach((_,v)=>{const b=c.beforeState.get(v)||0,S=_-b;S>0&&XN(d,v,b,S)});const f=o9e();let p=!1;if(this.lastChange>0&&f-this.lastChange<this.captureTimeout&&h.length>0&&!l&&!u){const _=h[h.length-1];_.deletions=s$([_.deletions,c.deleteSet]),_.insertions=s$([_.insertions,d])}else h.push(new aYe(c.deleteSet,d)),p=!0;!l&&!u&&(this.lastChange=f),bA(c,c.deleteSet,_=>{_ instanceof Aa&&this.scope.some(v=>v===c.doc||G3(v,_))&&xK(_,!0)});const g=[{stackItem:h[h.length-1],origin:c.origin,type:l?"redo":"undo",changedParentTypes:c.changedParentTypes},this];p?this.emit("stack-item-added",g):this.emit("stack-item-updated",g)},this.doc.on("afterTransaction",this.afterTransactionHandler),this.doc.on("destroy",()=>{this.destroy()})}addToScope(e){const n=new Set(this.scope);e=e$(e)?e:[e],e.forEach(i=>{n.has(i)||(n.add(i),(i instanceof Al?i.doc!==this.doc:i!==this.doc)&&eve("[yjs#509] Not same Y.Doc"),this.scope.push(i))})}addTrackedOrigin(e){this.trackedOrigins.add(e)}removeTrackedOrigin(e){this.trackedOrigins.delete(e)}clear(e=!0,n=!0){(e&&this.canUndo()||n&&this.canRedo())&&this.doc.transact(i=>{e&&(this.undoStack.forEach(r=>sre(i,this,r)),this.undoStack=[]),n&&(this.redoStack.forEach(r=>sre(i,this,r)),this.redoStack=[]),this.emit("stack-cleared",[{undoStackCleared:e,redoStackCleared:n}])})}stopCapturing(){this.lastChange=0}undo(){this.undoing=!0;let e;try{e=are(this,this.undoStack,"undo")}finally{this.undoing=!1}return e}redo(){this.redoing=!0;let e;try{e=are(this,this.redoStack,"redo")}finally{this.redoing=!1}return e}canUndo(){return this.undoStack.length>0}canRedo(){return this.redoStack.length>0}destroy(){this.trackedOrigins.delete(this),this.doc.off("afterTransaction",this.afterTransactionHandler),super.destroy()}}function*cYe(t){const e=Tr(t.restDecoder);for(let n=0;n<e;n++){const i=Tr(t.restDecoder),r=t.readClient();let s=Tr(t.restDecoder);for(let a=0;a<i;a++){const o=t.readInfo();if(o===10){const c=Tr(t.restDecoder);yield new op(wr(r,s),c),s+=c}else if(b4&o){const c=(o&(v_|pf))===0,l=new Aa(wr(r,s),null,(o&pf)===pf?t.readLeftID():null,null,(o&v_)===v_?t.readRightID():null,c?t.readParentInfo()?t.readString():t.readLeftID():null,c&&(o&qN)===qN?t.readString():null,Nve(t,o));yield l,s+=l.length}else{const c=t.readLen();yield new ap(wr(r,s),c),s+=c}}}}class vK{constructor(e,n){this.gen=cYe(e),this.curr=null,this.done=!1,this.filterSkips=n,this.next()}next(){do this.curr=this.gen.next().value||null;while(this.filterSkips&&this.curr!==null&&this.curr.constructor===op);return this.curr}}class _K{constructor(e){this.currClient=0,this.startClock=0,this.written=0,this.encoder=e,this.clientStructs=[]}}const lYe=t=>q3(t,sve,wk),uYe=(t,e)=>{if(t.constructor===ap){const{client:n,clock:i}=t.id;return new ap(wr(n,i+e),t.length-e)}else if(t.constructor===op){const{client:n,clock:i}=t.id;return new op(wr(n,i+e),t.length-e)}else{const n=t,{client:i,clock:r}=n.id;return new Aa(wr(i,r+e),null,wr(i,r+e-1),null,n.rightOrigin,n.parent,n.parentSub,n.content.splice(e))}},q3=(t,e=EA,n=y1)=>{if(t.length===1)return t[0];const i=t.map(u=>new e(pR(u)));let r=i.map(u=>new vK(u,!0)),s=null;const a=new n,o=new _K(a);for(;r=r.filter(d=>d.curr!==null),r.sort((d,f)=>{if(d.curr.id.client===f.curr.id.client){const p=d.curr.id.clock-f.curr.id.clock;return p===0?d.curr.constructor===f.curr.constructor?0:d.curr.constructor===op?1:-1:p}else return f.curr.id.client-d.curr.id.client}),r.length!==0;){const u=r[0],h=u.curr.id.client;if(s!==null){let d=u.curr,f=!1;for(;d!==null&&d.id.clock+d.length<=s.struct.id.clock+s.struct.length&&d.id.client>=s.struct.id.client;)d=u.next(),f=!0;if(d===null||d.id.client!==h||f&&d.id.clock>s.struct.id.clock+s.struct.length)continue;if(h!==s.struct.id.client)yb(o,s.struct,s.offset),s={struct:d,offset:0},u.next();else if(s.struct.id.clock+s.struct.length<d.id.clock)if(s.struct.constructor===op)s.struct.length=d.id.clock+d.length-s.struct.id.clock;else{yb(o,s.struct,s.offset);const p=d.id.clock-s.struct.id.clock-s.struct.length;s={struct:new op(wr(h,s.struct.id.clock+s.struct.length),p),offset:0}}else{const p=s.struct.id.clock+s.struct.length-d.id.clock;p>0&&(s.struct.constructor===op?s.struct.length-=p:d=uYe(d,p)),s.struct.mergeWith(d)||(yb(o,s.struct,s.offset),s={struct:d,offset:0},u.next())}}else s={struct:u.curr,offset:0},u.next();for(let d=u.curr;d!==null&&d.id.client===h&&d.id.clock===s.struct.id.clock+s.struct.length&&d.constructor!==op;d=u.next())yb(o,s.struct,s.offset),s={struct:d,offset:0}}s!==null&&(yb(o,s.struct,s.offset),s=null),yK(o);const c=i.map(u=>pK(u)),l=s$(c);return gR(a,l),a.toUint8Array()},hYe=(t,e,n=EA,i=y1)=>{const r=ove(e),s=new i,a=new _K(s),o=new n(pR(t)),c=new vK(o,!1);for(;c.curr;){const u=c.curr,h=u.id.client,d=r.get(h)||0;if(c.curr.constructor===op){c.next();continue}if(u.id.clock+u.length>d)for(yb(a,u,X1(d-u.id.clock,0)),c.next();c.curr&&c.curr.id.client===h;)yb(a,c.curr,0),c.next();else for(;c.curr&&c.curr.id.client===h&&c.curr.id.clock+c.curr.length<=d;)c.next()}yK(a);const l=pK(o);return gR(s,l),s.toUint8Array()},fve=t=>{t.written>0&&(t.clientStructs.push({written:t.written,restEncoder:Gg(t.encoder.restEncoder)}),t.encoder.restEncoder=E4(),t.written=0)},yb=(t,e,n)=>{t.written>0&&t.currClient!==e.id.client&&fve(t),t.written===0&&(t.currClient=e.id.client,t.encoder.writeClient(e.id.client),es(t.encoder.restEncoder,e.id.clock+n)),e.write(t.encoder,n),t.written++},yK=t=>{fve(t);const e=t.encoder.restEncoder;es(e,t.clientStructs.length);for(let n=0;n<t.clientStructs.length;n++){const i=t.clientStructs[n];es(e,i.written),S4(e,i.restEncoder)}},dYe=(t,e,n,i)=>{const r=new n(pR(t)),s=new vK(r,!1),a=new i,o=new _K(a);for(let l=s.curr;l!==null;l=s.next())yb(o,e(l),0);yK(o);const c=pK(r);return gR(a,c),a.toUint8Array()},fYe=t=>dYe(t,y9e,EA,wk),ore="You must not compute changes after the event-handler fired.";class x4{constructor(e,n){this.target=e,this.currentTarget=e,this.transaction=n,this._changes=null,this._keys=null,this._delta=null,this._path=null}get path(){return this._path||(this._path=pYe(this.currentTarget,this.target))}deletes(e){return xk(this.transaction.deleteSet,e.id)}get keys(){if(this._keys===null){if(this.transaction.doc._transactionCleanups.length===0)throw hE(ore);const e=new Map,n=this.target;this.transaction.changed.get(n).forEach(r=>{if(r!==null){const s=n._map.get(r);let a,o;if(this.adds(s)){let c=s.left;for(;c!==null&&this.adds(c);)c=c.left;if(this.deletes(s))if(c!==null&&this.deletes(c))a="delete",o=yH(c.content.getContent());else return;else c!==null&&this.deletes(c)?(a="update",o=yH(c.content.getContent())):(a="add",o=void 0)}else if(this.deletes(s))a="delete",o=yH(s.content.getContent());else return;e.set(r,{action:a,oldValue:o})}}),this._keys=e}return this._keys}get delta(){return this.changes.delta}adds(e){return e.id.clock>=(this.transaction.beforeState.get(e.id.client)||0)}get changes(){let e=this._changes;if(e===null){if(this.transaction.doc._transactionCleanups.length===0)throw hE(ore);const n=this.target,i=_A(),r=_A(),s=[];if(e={added:i,deleted:r,delta:s,keys:this.keys},this.transaction.changed.get(n).has(null)){let o=null;const c=()=>{o&&s.push(o)};for(let l=n._start;l!==null;l=l.right)l.deleted?this.deletes(l)&&!this.adds(l)&&((o===null||o.delete===void 0)&&(c(),o={delete:0}),o.delete+=l.length,r.add(l)):this.adds(l)?((o===null||o.insert===void 0)&&(c(),o={insert:[]}),o.insert=o.insert.concat(l.content.getContent()),i.add(l)):((o===null||o.retain===void 0)&&(c(),o={retain:0}),o.retain+=l.length);o!==null&&o.retain===void 0&&c()}this._changes=e}return e}}const pYe=(t,e)=>{const n=[];for(;e._item!==null&&e!==t;){if(e._item.parentSub!==null)n.unshift(e._item.parentSub);else{let i=0,r=e._item.parent._start;for(;r!==e._item&&r!==null;)!r.deleted&&r.countable&&(i+=r.length),r=r.right;n.unshift(i)}e=e._item.parent}return n},xu=()=>{eve("Invalid access: Add Yjs type to a document before reading data.")},pve=80;let bK=0;class mYe{constructor(e,n){e.marker=!0,this.p=e,this.index=n,this.timestamp=bK++}}const gYe=t=>{t.timestamp=bK++},mve=(t,e,n)=>{t.p.marker=!1,t.p=e,e.marker=!0,t.index=n,t.timestamp=bK++},vYe=(t,e,n)=>{if(t.length>=pve){const i=t.reduce((r,s)=>r.timestamp<s.timestamp?r:s);return mve(i,e,n),i}else{const i=new mYe(e,n);return t.push(i),i}},w4=(t,e)=>{if(t._start===null||e===0||t._searchMarker===null)return null;const n=t._searchMarker.length===0?null:t._searchMarker.reduce((s,a)=>cL(e-s.index)<cL(e-a.index)?s:a);let i=t._start,r=0;for(n!==null&&(i=n.p,r=n.index,gYe(n));i.right!==null&&r<e;){if(!i.deleted&&i.countable){if(e<r+i.length)break;r+=i.length}i=i.right}for(;i.left!==null&&r>e;)i=i.left,!i.deleted&&i.countable&&(r-=i.length);for(;i.left!==null&&i.left.id.client===i.id.client&&i.left.id.clock+i.left.length===i.id.clock;)i=i.left,!i.deleted&&i.countable&&(r-=i.length);return n!==null&&cL(n.index-r)<i.parent.length/pve?(mve(n,i,r),n):vYe(t._searchMarker,i,r)},ZN=(t,e,n)=>{for(let i=t.length-1;i>=0;i--){const r=t[i];if(n>0){let s=r.p;for(s.marker=!1;s&&(s.deleted||!s.countable);)s=s.left,s&&!s.deleted&&s.countable&&(r.index-=s.length);if(s===null||s.marker===!0){t.splice(i,1);continue}r.p=s,s.marker=!0}(e<r.index||n>0&&e===r.index)&&(r.index=X1(e,r.index+n))}},C4=(t,e,n)=>{const i=t,r=e.changedParentTypes;for(;BE(r,t,()=>[]).push(n),t._item!==null;)t=t._item.parent;cve(i._eH,n,e)};class Al{constructor(){this._item=null,this._map=new Map,this._start=null,this.doc=null,this._length=0,this._eH=Qie(),this._dEH=Qie(),this._searchMarker=null}get parent(){return this._item?this._item.parent:null}_integrate(e,n){this.doc=e,this._item=n}_copy(){throw t0()}clone(){throw t0()}_write(e){}get _first(){let e=this._start;for(;e!==null&&e.deleted;)e=e.right;return e}_callObserver(e,n){!e.local&&this._searchMarker&&(this._searchMarker.length=0)}observe(e){ere(this._eH,e)}observeDeep(e){ere(this._dEH,e)}unobserve(e){tre(this._eH,e)}unobserveDeep(e){tre(this._dEH,e)}toJSON(){}}const gve=(t,e,n)=>{t.doc??xu(),e<0&&(e=t._length+e),n<0&&(n=t._length+n);let i=n-e;const r=[];let s=t._start;for(;s!==null&&i>0;){if(s.countable&&!s.deleted){const a=s.content.getContent();if(a.length<=e)e-=a.length;else{for(let o=e;o<a.length&&i>0;o++)r.push(a[o]),i--;e=0}}s=s.right}return r},vve=t=>{t.doc??xu();const e=[];let n=t._start;for(;n!==null;){if(n.countable&&!n.deleted){const i=n.content.getContent();for(let r=0;r<i.length;r++)e.push(i[r])}n=n.right}return e},JN=(t,e)=>{let n=0,i=t._start;for(t.doc??xu();i!==null;){if(i.countable&&!i.deleted){const r=i.content.getContent();for(let s=0;s<r.length;s++)e(r[s],n++,t)}i=i.right}},_ve=(t,e)=>{const n=[];return JN(t,(i,r)=>{n.push(e(i,r,t))}),n},_Ye=t=>{let e=t._start,n=null,i=0;return{[Symbol.iterator](){return this},next:()=>{if(n===null){for(;e!==null&&e.deleted;)e=e.right;if(e===null)return{done:!0,value:void 0};n=e.content.getContent(),i=0,e=e.right}const r=n[i++];return n.length<=i&&(n=null),{done:!1,value:r}}}},yve=(t,e)=>{t.doc??xu();const n=w4(t,e);let i=t._start;for(n!==null&&(i=n.p,e-=n.index);i!==null;i=i.right)if(!i.deleted&&i.countable){if(e<i.length)return i.content.getContent()[e];e-=i.length}},$3=(t,e,n,i)=>{let r=n;const s=t.doc,a=s.clientID,o=s.store,c=n===null?e._start:n.right;let l=[];const u=()=>{l.length>0&&(r=new Aa(wr(a,Yc(o,a)),r,r&&r.lastId,c,c&&c.id,e,null,new E1(l)),r.integrate(t,0),l=[])};i.forEach(h=>{if(h===null)l.push(h);else switch(h.constructor){case Number:case Object:case Boolean:case Array:case String:l.push(h);break;default:switch(u(),h.constructor){case Uint8Array:case ArrayBuffer:r=new Aa(wr(a,Yc(o,a)),r,r&&r.lastId,c,c&&c.id,e,null,new Ck(new Uint8Array(h))),r.integrate(t,0);break;case Z1:r=new Aa(wr(a,Yc(o,a)),r,r&&r.lastId,c,c&&c.id,e,null,new Ak(h)),r.integrate(t,0);break;default:if(h instanceof Al)r=new Aa(wr(a,Yc(o,a)),r,r&&r.lastId,c,c&&c.id,e,null,new W_(h)),r.integrate(t,0);else throw new Error("Unexpected content type in insert operation")}}}),u()},bve=()=>hE("Length exceeded!"),Eve=(t,e,n,i)=>{if(n>e._length)throw bve();if(n===0)return e._searchMarker&&ZN(e._searchMarker,n,i.length),$3(t,e,null,i);const r=n,s=w4(e,n);let a=e._start;for(s!==null&&(a=s.p,n-=s.index,n===0&&(a=a.prev,n+=a&&a.countable&&!a.deleted?a.length:0));a!==null;a=a.right)if(!a.deleted&&a.countable){if(n<=a.length){n<a.length&&nd(t,wr(a.id.client,a.id.clock+n));break}n-=a.length}return e._searchMarker&&ZN(e._searchMarker,r,i.length),$3(t,e,a,i)},yYe=(t,e,n)=>{let r=(e._searchMarker||[]).reduce((s,a)=>a.index>s.index?a:s,{index:0,p:e._start}).p;if(r)for(;r.right;)r=r.right;return $3(t,e,r,n)},Sve=(t,e,n,i)=>{if(i===0)return;const r=n,s=i,a=w4(e,n);let o=e._start;for(a!==null&&(o=a.p,n-=a.index);o!==null&&n>0;o=o.right)!o.deleted&&o.countable&&(n<o.length&&nd(t,wr(o.id.client,o.id.clock+n)),n-=o.length);for(;i>0&&o!==null;)o.deleted||(i<o.length&&nd(t,wr(o.id.client,o.id.clock+i)),o.delete(t),i-=o.length),o=o.right;if(i>0)throw bve();e._searchMarker&&ZN(e._searchMarker,r,-s+i)},W3=(t,e,n)=>{const i=e._map.get(n);i!==void 0&&i.delete(t)},EK=(t,e,n,i)=>{const r=e._map.get(n)||null,s=t.doc,a=s.clientID;let o;if(i==null)o=new E1([i]);else switch(i.constructor){case Number:case Object:case Boolean:case Array:case String:o=new E1([i]);break;case Uint8Array:o=new Ck(i);break;case Z1:o=new Ak(i);break;default:if(i instanceof Al)o=new W_(i);else throw new Error("Unexpected content type")}new Aa(wr(a,Yc(s.store,a)),r,r&&r.lastId,null,null,e,n,o).integrate(t,0)},SK=(t,e)=>{t.doc??xu();const n=t._map.get(e);return n!==void 0&&!n.deleted?n.content.getContent()[n.length-1]:void 0},Tve=t=>{const e={};return t.doc??xu(),t._map.forEach((n,i)=>{n.deleted||(e[i]=n.content.getContent()[n.length-1])}),e},xve=(t,e)=>{t.doc??xu();const n=t._map.get(e);return n!==void 0&&!n.deleted},bYe=(t,e)=>{const n={};return t._map.forEach((i,r)=>{let s=i;for(;s!==null&&(!e.sv.has(s.id.client)||s.id.clock>=(e.sv.get(s.id.client)||0));)s=s.left;s!==null&&Mw(s,e)&&(n[r]=s.content.getContent()[s.length-1])}),n},t2=t=>(t.doc??xu(),U9e(t._map.entries(),e=>!e[1].deleted));class EYe extends x4{}class wC extends Al{constructor(){super(),this._prelimContent=[],this._searchMarker=[]}static from(e){const n=new wC;return n.push(e),n}_integrate(e,n){super._integrate(e,n),this.insert(0,this._prelimContent),this._prelimContent=null}_copy(){return new wC}clone(){const e=new wC;return e.insert(0,this.toArray().map(n=>n instanceof Al?n.clone():n)),e}get length(){return this.doc??xu(),this._length}_callObserver(e,n){super._callObserver(e,n),C4(this,e,new EYe(this,e))}insert(e,n){this.doc!==null?Js(this.doc,i=>{Eve(i,this,e,n)}):this._prelimContent.splice(e,0,...n)}push(e){this.doc!==null?Js(this.doc,n=>{yYe(n,this,e)}):this._prelimContent.push(...e)}unshift(e){this.insert(0,e)}delete(e,n=1){this.doc!==null?Js(this.doc,i=>{Sve(i,this,e,n)}):this._prelimContent.splice(e,n)}get(e){return yve(this,e)}toArray(){return vve(this)}slice(e=0,n=this.length){return gve(this,e,n)}toJSON(){return this.map(e=>e instanceof Al?e.toJSON():e)}map(e){return _ve(this,e)}forEach(e){JN(this,e)}[Symbol.iterator](){return _Ye(this)}_write(e){e.writeTypeRef($Ye)}}const SYe=t=>new wC;class TYe extends x4{constructor(e,n,i){super(e,n),this.keysChanged=i}}class SA extends Al{constructor(e){super(),this._prelimContent=null,e===void 0?this._prelimContent=new Map:this._prelimContent=new Map(e)}_integrate(e,n){super._integrate(e,n),this._prelimContent.forEach((i,r)=>{this.set(r,i)}),this._prelimContent=null}_copy(){return new SA}clone(){const e=new SA;return this.forEach((n,i)=>{e.set(i,n instanceof Al?n.clone():n)}),e}_callObserver(e,n){C4(this,e,new TYe(this,e,n))}toJSON(){this.doc??xu();const e={};return this._map.forEach((n,i)=>{if(!n.deleted){const r=n.content.getContent()[n.length-1];e[i]=r instanceof Al?r.toJSON():r}}),e}get size(){return[...t2(this)].length}keys(){return xH(t2(this),e=>e[0])}values(){return xH(t2(this),e=>e[1].content.getContent()[e[1].length-1])}entries(){return xH(t2(this),e=>[e[0],e[1].content.getContent()[e[1].length-1]])}forEach(e){this.doc??xu(),this._map.forEach((n,i)=>{n.deleted||e(n.content.getContent()[n.length-1],i,this)})}[Symbol.iterator](){return this.entries()}delete(e){this.doc!==null?Js(this.doc,n=>{W3(n,this,e)}):this._prelimContent.delete(e)}set(e,n){return this.doc!==null?Js(this.doc,i=>{EK(i,this,e,n)}):this._prelimContent.set(e,n),n}get(e){return SK(this,e)}has(e){return xve(this,e)}clear(){this.doc!==null?Js(this.doc,e=>{this.forEach(function(n,i,r){W3(e,r,i)})}):this._prelimContent.clear()}_write(e){e.writeTypeRef(WYe)}}const xYe=t=>new SA,Rb=(t,e)=>t===e||typeof t=="object"&&typeof e=="object"&&t&&e&&v9e(t,e);class c${constructor(e,n,i,r){this.left=e,this.right=n,this.index=i,this.currentAttributes=r}forward(){switch(this.right===null&&c0(),this.right.content.constructor){case el:this.right.deleted||vR(this.currentAttributes,this.right.content);break;default:this.right.deleted||(this.index+=this.right.length);break}this.left=this.right,this.right=this.right.right}}const cre=(t,e,n)=>{for(;e.right!==null&&n>0;){switch(e.right.content.constructor){case el:e.right.deleted||vR(e.currentAttributes,e.right.content);break;default:e.right.deleted||(n<e.right.length&&nd(t,wr(e.right.id.client,e.right.id.clock+n)),e.index+=e.right.length,n-=e.right.length);break}e.left=e.right,e.right=e.right.right}return e},n2=(t,e,n,i)=>{const r=new Map,s=i?w4(e,n):null;if(s){const a=new c$(s.p.left,s.p,s.index,r);return cre(t,a,n-s.index)}else{const a=new c$(null,e._start,0,r);return cre(t,a,n)}},wve=(t,e,n,i)=>{for(;n.right!==null&&(n.right.deleted===!0||n.right.content.constructor===el&&Rb(i.get(n.right.content.key),n.right.content.value));)n.right.deleted||i.delete(n.right.content.key),n.forward();const r=t.doc,s=r.clientID;i.forEach((a,o)=>{const c=n.left,l=n.right,u=new Aa(wr(s,Yc(r.store,s)),c,c&&c.lastId,l,l&&l.id,e,null,new el(o,a));u.integrate(t,0),n.right=u,n.forward()})},vR=(t,e)=>{const{key:n,value:i}=e;i===null?t.delete(n):t.set(n,i)},Cve=(t,e)=>{for(;t.right!==null;){if(!(t.right.deleted||t.right.content.constructor===el&&Rb(e[t.right.content.key]??null,t.right.content.value)))break;t.forward()}},Ave=(t,e,n,i)=>{const r=t.doc,s=r.clientID,a=new Map;for(const o in i){const c=i[o],l=n.currentAttributes.get(o)??null;if(!Rb(l,c)){a.set(o,l);const{left:u,right:h}=n;n.right=new Aa(wr(s,Yc(r.store,s)),u,u&&u.lastId,h,h&&h.id,e,null,new el(o,c)),n.right.integrate(t,0),n.forward()}}return a},wH=(t,e,n,i,r)=>{n.currentAttributes.forEach((d,f)=>{r[f]===void 0&&(r[f]=null)});const s=t.doc,a=s.clientID;Cve(n,r);const o=Ave(t,e,n,r),c=i.constructor===String?new h0(i):i instanceof Al?new W_(i):new J1(i);let{left:l,right:u,index:h}=n;e._searchMarker&&ZN(e._searchMarker,n.index,c.getLength()),u=new Aa(wr(a,Yc(s.store,a)),l,l&&l.lastId,u,u&&u.id,e,null,c),u.integrate(t,0),n.right=u,n.index=h,n.forward(),wve(t,e,n,o)},lre=(t,e,n,i,r)=>{const s=t.doc,a=s.clientID;Cve(n,r);const o=Ave(t,e,n,r);e:for(;n.right!==null&&(i>0||o.size>0&&(n.right.deleted||n.right.content.constructor===el));){if(!n.right.deleted)switch(n.right.content.constructor){case el:{const{key:c,value:l}=n.right.content,u=r[c];if(u!==void 0){if(Rb(u,l))o.delete(c);else{if(i===0)break e;o.set(c,l)}n.right.delete(t)}else n.currentAttributes.set(c,l);break}default:i<n.right.length&&nd(t,wr(n.right.id.client,n.right.id.clock+i)),i-=n.right.length;break}n.forward()}if(i>0){let c="";for(;i>0;i--)c+=`
`;n.right=new Aa(wr(a,Yc(s.store,a)),n.left,n.left&&n.left.lastId,n.right,n.right&&n.right.id,e,null,new h0(c)),n.right.integrate(t,0),n.forward()}wve(t,e,n,o)},Rve=(t,e,n,i,r)=>{let s=e;const a=Cm();for(;s&&(!s.countable||s.deleted);){if(!s.deleted&&s.content.constructor===el){const l=s.content;a.set(l.key,l)}s=s.right}let o=0,c=!1;for(;e!==s;){if(n===e&&(c=!0),!e.deleted){const l=e.content;switch(l.constructor){case el:{const{key:u,value:h}=l,d=i.get(u)??null;(a.get(u)!==l||d===h)&&(e.delete(t),o++,!c&&(r.get(u)??null)===h&&d!==h&&(d===null?r.delete(u):r.set(u,d))),!c&&!e.deleted&&vR(r,l);break}}}e=e.right}return o},wYe=(t,e)=>{for(;e&&e.right&&(e.right.deleted||!e.right.countable);)e=e.right;const n=new Set;for(;e&&(e.deleted||!e.countable);){if(!e.deleted&&e.content.constructor===el){const i=e.content.key;n.has(i)?e.delete(t):n.add(i)}e=e.left}},CYe=t=>{let e=0;return Js(t.doc,n=>{let i=t._start,r=t._start,s=Cm();const a=Qq(s);for(;r;){if(r.deleted===!1)switch(r.content.constructor){case el:vR(a,r.content);break;default:e+=Rve(n,i,r,s,a),s=Qq(a),i=r;break}r=r.right}}),e},AYe=t=>{const e=new Set,n=t.doc;for(const[i,r]of t.afterState.entries()){const s=t.beforeState.get(i)||0;r!==s&&hve(t,n.store.clients.get(i),s,r,a=>{!a.deleted&&a.content.constructor===el&&a.constructor!==ap&&e.add(a.parent)})}Js(n,i=>{bA(t,t.deleteSet,r=>{if(r instanceof ap||!r.parent._hasFormatting||e.has(r.parent))return;const s=r.parent;r.content.constructor===el?e.add(s):wYe(i,r)});for(const r of e)CYe(r)})},ure=(t,e,n)=>{const i=n,r=Qq(e.currentAttributes),s=e.right;for(;n>0&&e.right!==null;){if(e.right.deleted===!1)switch(e.right.content.constructor){case W_:case J1:case h0:n<e.right.length&&nd(t,wr(e.right.id.client,e.right.id.clock+n)),n-=e.right.length,e.right.delete(t);break}e.forward()}s&&Rve(t,s,e.right,r,e.currentAttributes);const a=(e.left||e.right).parent;return a._searchMarker&&ZN(a._searchMarker,e.index,-i+n),e};class RYe extends x4{constructor(e,n,i){super(e,n),this.childListChanged=!1,this.keysChanged=new Set,i.forEach(r=>{r===null?this.childListChanged=!0:this.keysChanged.add(r)})}get changes(){if(this._changes===null){const e={keys:this.keys,delta:this.delta,added:new Set,deleted:new Set};this._changes=e}return this._changes}get delta(){if(this._delta===null){const e=this.target.doc,n=[];Js(e,i=>{const r=new Map,s=new Map;let a=this.target._start,o=null;const c={};let l="",u=0,h=0;const d=()=>{if(o!==null){let f=null;switch(o){case"delete":h>0&&(f={delete:h}),h=0;break;case"insert":(typeof l=="object"||l.length>0)&&(f={insert:l},r.size>0&&(f.attributes={},r.forEach((p,g)=>{p!==null&&(f.attributes[g]=p)}))),l="";break;case"retain":u>0&&(f={retain:u},p9e(c)||(f.attributes=h9e({},c))),u=0;break}f&&n.push(f),o=null}};for(;a!==null;){switch(a.content.constructor){case W_:case J1:this.adds(a)?this.deletes(a)||(d(),o="insert",l=a.content.getContent()[0],d()):this.deletes(a)?(o!=="delete"&&(d(),o="delete"),h+=1):a.deleted||(o!=="retain"&&(d(),o="retain"),u+=1);break;case h0:this.adds(a)?this.deletes(a)||(o!=="insert"&&(d(),o="insert"),l+=a.content.str):this.deletes(a)?(o!=="delete"&&(d(),o="delete"),h+=a.length):a.deleted||(o!=="retain"&&(d(),o="retain"),u+=a.length);break;case el:{const{key:f,value:p}=a.content;if(this.adds(a)){if(!this.deletes(a)){const g=r.get(f)??null;Rb(g,p)?p!==null&&a.delete(i):(o==="retain"&&d(),Rb(p,s.get(f)??null)?delete c[f]:c[f]=p)}}else if(this.deletes(a)){s.set(f,p);const g=r.get(f)??null;Rb(g,p)||(o==="retain"&&d(),c[f]=g)}else if(!a.deleted){s.set(f,p);const g=c[f];g!==void 0&&(Rb(g,p)?g!==null&&a.delete(i):(o==="retain"&&d(),p===null?delete c[f]:c[f]=p))}a.deleted||(o==="insert"&&d(),vR(r,a.content));break}}a=a.right}for(d();n.length>0;){const f=n[n.length-1];if(f.retain!==void 0&&f.attributes===void 0)n.pop();else break}}),this._delta=n}return this._delta}}class u0 extends Al{constructor(e){super(),this._pending=e!==void 0?[()=>this.insert(0,e)]:[],this._searchMarker=[],this._hasFormatting=!1}get length(){return this.doc??xu(),this._length}_integrate(e,n){super._integrate(e,n);try{this._pending.forEach(i=>i())}catch(i){console.error(i)}this._pending=null}_copy(){return new u0}clone(){const e=new u0;return e.applyDelta(this.toDelta()),e}_callObserver(e,n){super._callObserver(e,n);const i=new RYe(this,e,n);C4(this,e,i),!e.local&&this._hasFormatting&&(e._needFormattingCleanup=!0)}toString(){this.doc??xu();let e="",n=this._start;for(;n!==null;)!n.deleted&&n.countable&&n.content.constructor===h0&&(e+=n.content.str),n=n.right;return e}toJSON(){return this.toString()}applyDelta(e,{sanitize:n=!0}={}){this.doc!==null?Js(this.doc,i=>{const r=new c$(null,this._start,0,new Map);for(let s=0;s<e.length;s++){const a=e[s];if(a.insert!==void 0){const o=!n&&typeof a.insert=="string"&&s===e.length-1&&r.right===null&&a.insert.slice(-1)===`
`?a.insert.slice(0,-1):a.insert;(typeof o!="string"||o.length>0)&&wH(i,this,r,o,a.attributes||{})}else a.retain!==void 0?lre(i,this,r,a.retain,a.attributes||{}):a.delete!==void 0&&ure(i,r,a.delete)}}):this._pending.push(()=>this.applyDelta(e))}toDelta(e,n,i){this.doc??xu();const r=[],s=new Map,a=this.doc;let o="",c=this._start;function l(){if(o.length>0){const h={};let d=!1;s.forEach((p,g)=>{d=!0,h[g]=p});const f={insert:o};d&&(f.attributes=h),r.push(f),o=""}}const u=()=>{for(;c!==null;){if(Mw(c,e)||n!==void 0&&Mw(c,n))switch(c.content.constructor){case h0:{const h=s.get("ychange");e!==void 0&&!Mw(c,e)?(h===void 0||h.user!==c.id.client||h.type!=="removed")&&(l(),s.set("ychange",i?i("removed",c.id):{type:"removed"})):n!==void 0&&!Mw(c,n)?(h===void 0||h.user!==c.id.client||h.type!=="added")&&(l(),s.set("ychange",i?i("added",c.id):{type:"added"})):h!==void 0&&(l(),s.delete("ychange")),o+=c.content.str;break}case W_:case J1:{l();const h={insert:c.content.getContent()[0]};if(s.size>0){const d={};h.attributes=d,s.forEach((f,p)=>{d[p]=f})}r.push(h);break}case el:Mw(c,e)&&(l(),vR(s,c.content));break}c=c.right}l()};return e||n?Js(a,h=>{e&&a$(h,e),n&&a$(h,n),u()},"cleanup"):u(),r}insert(e,n,i){if(n.length<=0)return;const r=this.doc;r!==null?Js(r,s=>{const a=n2(s,this,e,!i);i||(i={},a.currentAttributes.forEach((o,c)=>{i[c]=o})),wH(s,this,a,n,i)}):this._pending.push(()=>this.insert(e,n,i))}insertEmbed(e,n,i){const r=this.doc;r!==null?Js(r,s=>{const a=n2(s,this,e,!i);wH(s,this,a,n,i||{})}):this._pending.push(()=>this.insertEmbed(e,n,i||{}))}delete(e,n){if(n===0)return;const i=this.doc;i!==null?Js(i,r=>{ure(r,n2(r,this,e,!0),n)}):this._pending.push(()=>this.delete(e,n))}format(e,n,i){if(n===0)return;const r=this.doc;r!==null?Js(r,s=>{const a=n2(s,this,e,!1);a.right!==null&&lre(s,this,a,n,i)}):this._pending.push(()=>this.format(e,n,i))}removeAttribute(e){this.doc!==null?Js(this.doc,n=>{W3(n,this,e)}):this._pending.push(()=>this.removeAttribute(e))}setAttribute(e,n){this.doc!==null?Js(this.doc,i=>{EK(i,this,e,n)}):this._pending.push(()=>this.setAttribute(e,n))}getAttribute(e){return SK(this,e)}getAttributes(){return Tve(this)}_write(e){e.writeTypeRef(YYe)}}const MYe=t=>new u0;class CH{constructor(e,n=()=>!0){this._filter=n,this._root=e,this._currentNode=e._start,this._firstCall=!0,e.doc??xu()}[Symbol.iterator](){return this}next(){let e=this._currentNode,n=e&&e.content&&e.content.type;if(e!==null&&(!this._firstCall||e.deleted||!this._filter(n)))do if(n=e.content.type,!e.deleted&&(n.constructor===TA||n.constructor===b1)&&n._start!==null)e=n._start;else for(;e!==null;){const i=e.next;if(i!==null){e=i;break}else e.parent===this._root?e=null:e=e.parent._item}while(e!==null&&(e.deleted||!this._filter(e.content.type)));return this._firstCall=!1,e===null?{value:void 0,done:!0}:(this._currentNode=e,{value:e.content.type,done:!1})}}class b1 extends Al{constructor(){super(),this._prelimContent=[]}get firstChild(){const e=this._first;return e?e.content.getContent()[0]:null}_integrate(e,n){super._integrate(e,n),this.insert(0,this._prelimContent),this._prelimContent=null}_copy(){return new b1}clone(){const e=new b1;return e.insert(0,this.toArray().map(n=>n instanceof Al?n.clone():n)),e}get length(){return this.doc??xu(),this._prelimContent===null?this._length:this._prelimContent.length}createTreeWalker(e){return new CH(this,e)}querySelector(e){e=e.toUpperCase();const i=new CH(this,r=>r.nodeName&&r.nodeName.toUpperCase()===e).next();return i.done?null:i.value}querySelectorAll(e){return e=e.toUpperCase(),_1(new CH(this,n=>n.nodeName&&n.nodeName.toUpperCase()===e))}_callObserver(e,n){C4(this,e,new IYe(this,n,e))}toString(){return _ve(this,e=>e.toString()).join("")}toJSON(){return this.toString()}toDOM(e=document,n={},i){const r=e.createDocumentFragment();return i!==void 0&&i._createAssociation(r,this),JN(this,s=>{r.insertBefore(s.toDOM(e,n,i),null)}),r}insert(e,n){this.doc!==null?Js(this.doc,i=>{Eve(i,this,e,n)}):this._prelimContent.splice(e,0,...n)}insertAfter(e,n){if(this.doc!==null)Js(this.doc,i=>{const r=e&&e instanceof Al?e._item:e;$3(i,this,r,n)});else{const i=this._prelimContent,r=e===null?0:i.findIndex(s=>s===e)+1;if(r===0&&e!==null)throw hE("Reference item not found");i.splice(r,0,...n)}}delete(e,n=1){this.doc!==null?Js(this.doc,i=>{Sve(i,this,e,n)}):this._prelimContent.splice(e,n)}toArray(){return vve(this)}push(e){this.insert(this.length,e)}unshift(e){this.insert(0,e)}get(e){return yve(this,e)}slice(e=0,n=this.length){return gve(this,e,n)}forEach(e){JN(this,e)}_write(e){e.writeTypeRef(XYe)}}const OYe=t=>new b1;class TA extends b1{constructor(e="UNDEFINED"){super(),this.nodeName=e,this._prelimAttrs=new Map}get nextSibling(){const e=this._item?this._item.next:null;return e?e.content.type:null}get prevSibling(){const e=this._item?this._item.prev:null;return e?e.content.type:null}_integrate(e,n){super._integrate(e,n),this._prelimAttrs.forEach((i,r)=>{this.setAttribute(r,i)}),this._prelimAttrs=null}_copy(){return new TA(this.nodeName)}clone(){const e=new TA(this.nodeName),n=this.getAttributes();return f9e(n,(i,r)=>{typeof i=="string"&&e.setAttribute(r,i)}),e.insert(0,this.toArray().map(i=>i instanceof Al?i.clone():i)),e}toString(){const e=this.getAttributes(),n=[],i=[];for(const o in e)i.push(o);i.sort();const r=i.length;for(let o=0;o<r;o++){const c=i[o];n.push(c+'="'+e[c]+'"')}const s=this.nodeName.toLocaleLowerCase(),a=n.length>0?" "+n.join(" "):"";return`<${s}${a}>${super.toString()}</${s}>`}removeAttribute(e){this.doc!==null?Js(this.doc,n=>{W3(n,this,e)}):this._prelimAttrs.delete(e)}setAttribute(e,n){this.doc!==null?Js(this.doc,i=>{EK(i,this,e,n)}):this._prelimAttrs.set(e,n)}getAttribute(e){return SK(this,e)}hasAttribute(e){return xve(this,e)}getAttributes(e){return e?bYe(this,e):Tve(this)}toDOM(e=document,n={},i){const r=e.createElement(this.nodeName),s=this.getAttributes();for(const a in s){const o=s[a];typeof o=="string"&&r.setAttribute(a,o)}return JN(this,a=>{r.appendChild(a.toDOM(e,n,i))}),i!==void 0&&i._createAssociation(r,this),r}_write(e){e.writeTypeRef(KYe),e.writeKey(this.nodeName)}}const NYe=t=>new TA(t.readKey());class IYe extends x4{constructor(e,n,i){super(e,i),this.childListChanged=!1,this.attributesChanged=new Set,n.forEach(r=>{r===null?this.childListChanged=!0:this.attributesChanged.add(r)})}}class Y3 extends SA{constructor(e){super(),this.hookName=e}_copy(){return new Y3(this.hookName)}clone(){const e=new Y3(this.hookName);return this.forEach((n,i)=>{e.set(i,n)}),e}toDOM(e=document,n={},i){const r=n[this.hookName];let s;return r!==void 0?s=r.createDom(this):s=document.createElement(this.hookName),s.setAttribute("data-yjs-hook",this.hookName),i!==void 0&&i._createAssociation(s,this),s}_write(e){e.writeTypeRef(ZYe),e.writeKey(this.hookName)}}const kYe=t=>new Y3(t.readKey());class K3 extends u0{get nextSibling(){const e=this._item?this._item.next:null;return e?e.content.type:null}get prevSibling(){const e=this._item?this._item.prev:null;return e?e.content.type:null}_copy(){return new K3}clone(){const e=new K3;return e.applyDelta(this.toDelta()),e}toDOM(e=document,n,i){const r=e.createTextNode(this.toString());return i!==void 0&&i._createAssociation(r,this),r}toString(){return this.toDelta().map(e=>{const n=[];for(const r in e.attributes){const s=[];for(const a in e.attributes[r])s.push({key:a,value:e.attributes[r][a]});s.sort((a,o)=>a.key<o.key?-1:1),n.push({nodeName:r,attrs:s})}n.sort((r,s)=>r.nodeName<s.nodeName?-1:1);let i="";for(let r=0;r<n.length;r++){const s=n[r];i+=`<${s.nodeName}`;for(let a=0;a<s.attrs.length;a++){const o=s.attrs[a];i+=` ${o.key}="${o.value}"`}i+=">"}i+=e.insert;for(let r=n.length-1;r>=0;r--)i+=`</${n[r].nodeName}>`;return i}).join("")}toJSON(){return this.toString()}_write(e){e.writeTypeRef(JYe)}}const PYe=t=>new K3;class TK{constructor(e,n){this.id=e,this.length=n}get deleted(){throw t0()}mergeWith(e){return!1}write(e,n,i){throw t0()}integrate(e,n){throw t0()}}const DYe=0;class ap extends TK{get deleted(){return!0}delete(){}mergeWith(e){return this.constructor!==e.constructor?!1:(this.length+=e.length,!0)}integrate(e,n){n>0&&(this.id.clock+=n,this.length-=n),uve(e.doc.store,this)}write(e,n){e.writeInfo(DYe),e.writeLen(this.length-n)}getMissing(e,n){return null}}class Ck{constructor(e){this.content=e}getLength(){return 1}getContent(){return[this.content]}isCountable(){return!0}copy(){return new Ck(this.content)}splice(e){throw t0()}mergeWith(e){return!1}integrate(e,n){}delete(e){}gc(e){}write(e,n){e.writeBuf(this.content)}getRef(){return 3}}const LYe=t=>new Ck(t.readBuf());class QN{constructor(e){this.len=e}getLength(){return this.len}getContent(){return[]}isCountable(){return!1}copy(){return new QN(this.len)}splice(e){const n=new QN(this.len-e);return this.len=e,n}mergeWith(e){return this.len+=e.len,!0}integrate(e,n){XN(e.deleteSet,n.id.client,n.id.clock,this.len),n.markDeleted()}delete(e){}gc(e){}write(e,n){e.writeLen(this.len-n)}getRef(){return 1}}const UYe=t=>new QN(t.readLen()),Mve=(t,e)=>new Z1({guid:t,...e,shouldLoad:e.shouldLoad||e.autoLoad||!1});class Ak{constructor(e){e._item&&console.error("This document was already integrated as a sub-document. You should create a second instance instead with the same guid."),this.doc=e;const n={};this.opts=n,e.gc||(n.gc=!1),e.autoLoad&&(n.autoLoad=!0),e.meta!==null&&(n.meta=e.meta)}getLength(){return 1}getContent(){return[this.doc]}isCountable(){return!0}copy(){return new Ak(Mve(this.doc.guid,this.opts))}splice(e){throw t0()}mergeWith(e){return!1}integrate(e,n){this.doc._item=n,e.subdocsAdded.add(this.doc),this.doc.shouldLoad&&e.subdocsLoaded.add(this.doc)}delete(e){e.subdocsAdded.has(this.doc)?e.subdocsAdded.delete(this.doc):e.subdocsRemoved.add(this.doc)}gc(e){}write(e,n){e.writeString(this.doc.guid),e.writeAny(this.opts)}getRef(){return 9}}const BYe=t=>new Ak(Mve(t.readString(),t.readAny()));class J1{constructor(e){this.embed=e}getLength(){return 1}getContent(){return[this.embed]}isCountable(){return!0}copy(){return new J1(this.embed)}splice(e){throw t0()}mergeWith(e){return!1}integrate(e,n){}delete(e){}gc(e){}write(e,n){e.writeJSON(this.embed)}getRef(){return 5}}const FYe=t=>new J1(t.readJSON());class el{constructor(e,n){this.key=e,this.value=n}getLength(){return 1}getContent(){return[]}isCountable(){return!1}copy(){return new el(this.key,this.value)}splice(e){throw t0()}mergeWith(e){return!1}integrate(e,n){const i=n.parent;i._searchMarker=null,i._hasFormatting=!0}delete(e){}gc(e){}write(e,n){e.writeKey(this.key),e.writeJSON(this.value)}getRef(){return 6}}const zYe=t=>new el(t.readKey(),t.readJSON());class X3{constructor(e){this.arr=e}getLength(){return this.arr.length}getContent(){return this.arr}isCountable(){return!0}copy(){return new X3(this.arr)}splice(e){const n=new X3(this.arr.slice(e));return this.arr=this.arr.slice(0,e),n}mergeWith(e){return this.arr=this.arr.concat(e.arr),!0}integrate(e,n){}delete(e){}gc(e){}write(e,n){const i=this.arr.length;e.writeLen(i-n);for(let r=n;r<i;r++){const s=this.arr[r];e.writeString(s===void 0?"undefined":JSON.stringify(s))}}getRef(){return 2}}const jYe=t=>{const e=t.readLen(),n=[];for(let i=0;i<e;i++){const r=t.readString();r==="undefined"?n.push(void 0):n.push(JSON.parse(r))}return new X3(n)},HYe=V3("node_env")==="development";class E1{constructor(e){this.arr=e,HYe&&W0e(e)}getLength(){return this.arr.length}getContent(){return this.arr}isCountable(){return!0}copy(){return new E1(this.arr)}splice(e){const n=new E1(this.arr.slice(e));return this.arr=this.arr.slice(0,e),n}mergeWith(e){return this.arr=this.arr.concat(e.arr),!0}integrate(e,n){}delete(e){}gc(e){}write(e,n){const i=this.arr.length;e.writeLen(i-n);for(let r=n;r<i;r++){const s=this.arr[r];e.writeAny(s)}}getRef(){return 8}}const VYe=t=>{const e=t.readLen(),n=[];for(let i=0;i<e;i++)n.push(t.readAny());return new E1(n)};class h0{constructor(e){this.str=e}getLength(){return this.str.length}getContent(){return this.str.split("")}isCountable(){return!0}copy(){return new h0(this.str)}splice(e){const n=new h0(this.str.slice(e));this.str=this.str.slice(0,e);const i=this.str.charCodeAt(e-1);return i>=55296&&i<=56319&&(this.str=this.str.slice(0,e-1)+"",n.str=""+n.str.slice(1)),n}mergeWith(e){return this.str+=e.str,!0}integrate(e,n){}delete(e){}gc(e){}write(e,n){e.writeString(n===0?this.str:this.str.slice(n))}getRef(){return 4}}const GYe=t=>new h0(t.readString()),qYe=[SYe,xYe,MYe,NYe,OYe,kYe,PYe],$Ye=0,WYe=1,YYe=2,KYe=3,XYe=4,ZYe=5,JYe=6;class W_{constructor(e){this.type=e}getLength(){return 1}getContent(){return[this.type]}isCountable(){return!0}copy(){return new W_(this.type._copy())}splice(e){throw t0()}mergeWith(e){return!1}integrate(e,n){this.type._integrate(e.doc,n)}delete(e){let n=this.type._start;for(;n!==null;)n.deleted?n.id.clock<(e.beforeState.get(n.id.client)||0)&&e._mergeStructs.push(n):n.delete(e),n=n.right;this.type._map.forEach(i=>{i.deleted?i.id.clock<(e.beforeState.get(i.id.client)||0)&&e._mergeStructs.push(i):i.delete(e)}),e.changed.delete(this.type)}gc(e){let n=this.type._start;for(;n!==null;)n.gc(e,!0),n=n.right;this.type._start=null,this.type._map.forEach(i=>{for(;i!==null;)i.gc(e,!0),i=i.left}),this.type._map=new Map}write(e,n){this.type._write(e)}getRef(){return 7}}const QYe=t=>new W_(qYe[t.readTypeRef()](t)),eKe=(t,e)=>{let n=e,i=0,r;do i>0&&(n=wr(n.client,n.clock+i)),r=hL(t,n),i=n.clock-r.id.clock,n=r.redone;while(n!==null&&r instanceof Aa);return{item:r,diff:i}},xK=(t,e)=>{for(;t!==null&&t.keep!==e;)t.keep=e,t=t.parent._item},Z3=(t,e,n)=>{const{client:i,clock:r}=e.id,s=new Aa(wr(i,r+n),e,wr(i,r+n-1),e.right,e.rightOrigin,e.parent,e.parentSub,e.content.splice(n));return e.deleted&&s.markDeleted(),e.keep&&(s.keep=!0),e.redone!==null&&(s.redone=wr(e.redone.client,e.redone.clock+n)),e.right=s,s.right!==null&&(s.right.left=s),t._mergeStructs.push(s),s.parentSub!==null&&s.right===null&&s.parent._map.set(s.parentSub,s),e.length=n,s},hre=(t,e)=>MWe(t,n=>xk(n.deletions,e)),Ove=(t,e,n,i,r,s)=>{const a=t.doc,o=a.store,c=a.clientID,l=e.redone;if(l!==null)return nd(t,l);let u=e.parent._item,h=null,d;if(u!==null&&u.deleted===!0){if(u.redone===null&&(!n.has(u)||Ove(t,u,n,i,r,s)===null))return null;for(;u.redone!==null;)u=nd(t,u.redone)}const f=u===null?e.parent:u.content.type;if(e.parentSub===null){for(h=e.left,d=e;h!==null;){let v=h;for(;v!==null&&v.parent._item!==u;)v=v.redone===null?null:nd(t,v.redone);if(v!==null&&v.parent._item===u){h=v;break}h=h.left}for(;d!==null;){let v=d;for(;v!==null&&v.parent._item!==u;)v=v.redone===null?null:nd(t,v.redone);if(v!==null&&v.parent._item===u){d=v;break}d=d.right}}else if(d=null,e.right&&!r){for(h=e;h!==null&&h.right!==null&&(h.right.redone||xk(i,h.right.id)||hre(s.undoStack,h.right.id)||hre(s.redoStack,h.right.id));)for(h=h.right;h.redone;)h=nd(t,h.redone);if(h&&h.right!==null)return null}else h=f._map.get(e.parentSub)||null;const p=Yc(o,c),g=wr(c,p),_=new Aa(g,h,h&&h.lastId,d,d&&d.id,f,e.parentSub,e.content.copy());return e.redone=g,xK(_,!0),_.integrate(t,0),_};class Aa extends TK{constructor(e,n,i,r,s,a,o,c){super(e,c.getLength()),this.origin=i,this.left=n,this.right=r,this.rightOrigin=s,this.parent=a,this.parentSub=o,this.redone=null,this.content=c,this.info=this.content.isCountable()?jie:0}set marker(e){(this.info&EH)>0!==e&&(this.info^=EH)}get marker(){return(this.info&EH)>0}get keep(){return(this.info&zie)>0}set keep(e){this.keep!==e&&(this.info^=zie)}get countable(){return(this.info&jie)>0}get deleted(){return(this.info&bH)>0}set deleted(e){this.deleted!==e&&(this.info^=bH)}markDeleted(){this.info|=bH}getMissing(e,n){if(this.origin&&this.origin.client!==this.id.client&&this.origin.clock>=Yc(n,this.origin.client))return this.origin.client;if(this.rightOrigin&&this.rightOrigin.client!==this.id.client&&this.rightOrigin.clock>=Yc(n,this.rightOrigin.client))return this.rightOrigin.client;if(this.parent&&this.parent.constructor===xC&&this.id.client!==this.parent.client&&this.parent.clock>=Yc(n,this.parent.client))return this.parent.client;if(this.origin&&(this.left=nre(e,n,this.origin),this.origin=this.left.lastId),this.rightOrigin&&(this.right=nd(e,this.rightOrigin),this.rightOrigin=this.right.id),this.left&&this.left.constructor===ap||this.right&&this.right.constructor===ap)this.parent=null;else if(!this.parent)this.left&&this.left.constructor===Aa?(this.parent=this.left.parent,this.parentSub=this.left.parentSub):this.right&&this.right.constructor===Aa&&(this.parent=this.right.parent,this.parentSub=this.right.parentSub);else if(this.parent.constructor===xC){const i=hL(n,this.parent);i.constructor===ap?this.parent=null:this.parent=i.content.type}return null}integrate(e,n){if(n>0&&(this.id.clock+=n,this.left=nre(e,e.doc.store,wr(this.id.client,this.id.clock-1)),this.origin=this.left.lastId,this.content=this.content.splice(n),this.length-=n),this.parent){if(!this.left&&(!this.right||this.right.left!==null)||this.left&&this.left.right!==this.right){let i=this.left,r;if(i!==null)r=i.right;else if(this.parentSub!==null)for(r=this.parent._map.get(this.parentSub)||null;r!==null&&r.left!==null;)r=r.left;else r=this.parent._start;const s=new Set,a=new Set;for(;r!==null&&r!==this.right;){if(a.add(r),s.add(r),e2(this.origin,r.origin)){if(r.id.client<this.id.client)i=r,s.clear();else if(e2(this.rightOrigin,r.rightOrigin))break}else if(r.origin!==null&&a.has(hL(e.doc.store,r.origin)))s.has(hL(e.doc.store,r.origin))||(i=r,s.clear());else break;r=r.right}this.left=i}if(this.left!==null){const i=this.left.right;this.right=i,this.left.right=this}else{let i;if(this.parentSub!==null)for(i=this.parent._map.get(this.parentSub)||null;i!==null&&i.left!==null;)i=i.left;else i=this.parent._start,this.parent._start=this;this.right=i}this.right!==null?this.right.left=this:this.parentSub!==null&&(this.parent._map.set(this.parentSub,this),this.left!==null&&this.left.delete(e)),this.parentSub===null&&this.countable&&!this.deleted&&(this.parent._length+=this.length),uve(e.doc.store,this),this.content.integrate(e,this),rre(e,this.parent,this.parentSub),(this.parent._item!==null&&this.parent._item.deleted||this.parentSub!==null&&this.right!==null)&&this.delete(e)}else new ap(this.id,this.length).integrate(e,0)}get next(){let e=this.right;for(;e!==null&&e.deleted;)e=e.right;return e}get prev(){let e=this.left;for(;e!==null&&e.deleted;)e=e.left;return e}get lastId(){return this.length===1?this.id:wr(this.id.client,this.id.clock+this.length-1)}mergeWith(e){if(this.constructor===e.constructor&&e2(e.origin,this.lastId)&&this.right===e&&e2(this.rightOrigin,e.rightOrigin)&&this.id.client===e.id.client&&this.id.clock+this.length===e.id.clock&&this.deleted===e.deleted&&this.redone===null&&e.redone===null&&this.content.constructor===e.content.constructor&&this.content.mergeWith(e.content)){const n=this.parent._searchMarker;return n&&n.forEach(i=>{i.p===e&&(i.p=this,!this.deleted&&this.countable&&(i.index-=this.length))}),e.keep&&(this.keep=!0),this.right=e.right,this.right!==null&&(this.right.left=this),this.length+=e.length,!0}return!1}delete(e){if(!this.deleted){const n=this.parent;this.countable&&this.parentSub===null&&(n._length-=this.length),this.markDeleted(),XN(e.deleteSet,this.id.client,this.id.clock,this.length),rre(e,n,this.parentSub),this.content.delete(e)}}gc(e,n){if(!this.deleted)throw c0();this.content.gc(e),n?nYe(e,this,new ap(this.id,this.length)):this.content=new QN(this.length)}write(e,n){const i=n>0?wr(this.id.client,this.id.clock+n-1):this.origin,r=this.rightOrigin,s=this.parentSub,a=this.content.getRef()&b4|(i===null?0:pf)|(r===null?0:v_)|(s===null?0:qN);if(e.writeInfo(a),i!==null&&e.writeLeftID(i),r!==null&&e.writeRightID(r),i===null&&r===null){const o=this.parent;if(o._item!==void 0){const c=o._item;if(c===null){const l=eYe(o);e.writeParentInfo(!0),e.writeString(l)}else e.writeParentInfo(!1),e.writeLeftID(c.id)}else o.constructor===String?(e.writeParentInfo(!0),e.writeString(o)):o.constructor===xC?(e.writeParentInfo(!1),e.writeLeftID(o)):c0();s!==null&&e.writeString(s)}this.content.write(e,n)}}const Nve=(t,e)=>tKe[e&b4](t),tKe=[()=>{c0()},UYe,jYe,LYe,GYe,FYe,zYe,QYe,VYe,BYe,()=>{c0()}],nKe=10;class op extends TK{get deleted(){return!0}delete(){}mergeWith(e){return this.constructor!==e.constructor?!1:(this.length+=e.length,!0)}integrate(e,n){c0()}write(e,n){e.writeInfo(nKe),es(e.restEncoder,this.length-n)}getMissing(e,n){return null}}const Ive=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof bm<"u"?bm:{},kve="__ $YJS$ __";Ive[kve]===!0&&console.error("Yjs was already imported. This breaks constructor checks and will lead to issues! - https://github.com/yjs/yjs/issues/438");Ive[kve]=!0;let dre=!1;const id=new Z1;function Pve(t){const e=id.getMap(),[,n]=De.useState(0);if(De.useEffect(()=>{function i(){n(r=>1-r)}return e.observe(i),()=>{e.unobserve(i)}},[e,n]),e.has(t))return e.get(t)}function Rk(t){const e=Pve(t);if(an(e))return e}function Dve(t){const e=Pve(t);if(!(!re(e)||!(e instanceof u0)))return e}function Lve(t,e,n){const i=id.getMap();if(!i.has(t))switch(e){case 0:case 1:i.set(t,n);break}}function iKe(t,e){Lve(t,0,e)}function Uve(t,e){const n=new u0(e);Lve(t,1,n)}function Tl(t,e){id.getMap().set(t,e)}function rKe(t,e){const n=id.getMap(),i=new u0(e);n.set(t,i)}function Bve(t,e){const n=id.getMap();function i(r){const s=n.get(t);for(let a=0;a<r.length;++a)(r[a].target===n||r[a].target===s)&&e(s)}return n.has(t)&&e(n.get(t)),n.observeDeep(i),()=>{n.observeDeep(i)}}function sKe(t,e){return Bve(t,n=>{an(n)&&e(n)})}function aKe(t,e){return Bve(t,n=>{n instanceof u0&&e(n.toJSON())})}const sT=NE("modem",["second"],t=>{if(sT.session(t))switch(t.target){case"second":!dre&&t.data%2===0&&sT.emit(t.player,"modem:join");break;case"join":t.sender!==sT.id()&&sT.reply(t,"joinack",Ume(Z9e(id)));break;case"joinack":t.sender!==sT.id()&&(dre=!0,Jie(id,ON(t.data),id));break;case"sync":{t.sender!==sT.id()&&re(t.data)&&Jie(id,ON(t.data),id);break}}});function Fve(t,e){e!==id&&sT.emit("","modem:sync",Ume(t))}id.on("update",Fve);id.on("destroy",()=>{id.off("update",Fve)});function oKe(t,e,n,i){const r=t.slice(0,e),s=t.slice(e+n);return`${r}${i??""}${s}`}function wK(t){const[e,n]=t.split(":"),i=re(n);return[i?e:"self",i?n:t]}const cKe=`desc;$DKGRAYname and type of codepage
`,lKe=Object.freeze(Object.defineProperty({__proto__:null,default:cKe},Symbol.toStringTag,{value:"Module"})),uKe="desc;changes object into specified element",hKe=Object.freeze(Object.defineProperty({__proto__:null,default:uKe},Symbol.toStringTag,{value:"Module"})),dKe="desc;like #play but for sound effects",fKe=Object.freeze(Object.defineProperty({__proto__:null,default:dKe},Symbol.toStringTag,{value:"Module"})),pKe="",mKe=Object.freeze(Object.defineProperty({__proto__:null,default:pKe},Symbol.toStringTag,{value:"Module"})),gKe="",vKe=Object.freeze(Object.defineProperty({__proto__:null,default:gKe},Symbol.toStringTag,{value:"Module"})),_Ke="",yKe=Object.freeze(Object.defineProperty({__proto__:null,default:_Ke},Symbol.toStringTag,{value:"Module"})),bKe="",EKe=Object.freeze(Object.defineProperty({__proto__:null,default:bKe},Symbol.toStringTag,{value:"Module"})),SKe="",TKe=Object.freeze(Object.defineProperty({__proto__:null,default:SKe},Symbol.toStringTag,{value:"Module"})),xKe="",wKe=Object.freeze(Object.defineProperty({__proto__:null,default:xKe},Symbol.toStringTag,{value:"Module"})),CKe="",AKe=Object.freeze(Object.defineProperty({__proto__:null,default:CKe},Symbol.toStringTag,{value:"Module"})),RKe="",MKe=Object.freeze(Object.defineProperty({__proto__:null,default:RKe},Symbol.toStringTag,{value:"Module"})),OKe="",NKe=Object.freeze(Object.defineProperty({__proto__:null,default:OKe},Symbol.toStringTag,{value:"Module"})),IKe="",kKe=Object.freeze(Object.defineProperty({__proto__:null,default:IKe},Symbol.toStringTag,{value:"Module"})),PKe="",DKe=Object.freeze(Object.defineProperty({__proto__:null,default:PKe},Symbol.toStringTag,{value:"Module"})),LKe="",UKe=Object.freeze(Object.defineProperty({__proto__:null,default:LKe},Symbol.toStringTag,{value:"Module"})),BKe="",FKe=Object.freeze(Object.defineProperty({__proto__:null,default:BKe},Symbol.toStringTag,{value:"Module"})),zKe="",jKe=Object.freeze(Object.defineProperty({__proto__:null,default:zKe},Symbol.toStringTag,{value:"Module"})),HKe="",VKe=Object.freeze(Object.defineProperty({__proto__:null,default:HKe},Symbol.toStringTag,{value:"Module"})),GKe=`desc;$DKGRAYstarts a section of an if-do-done block
`,qKe=Object.freeze(Object.defineProperty({__proto__:null,default:GKe},Symbol.toStringTag,{value:"Module"})),$Ke=`desc;$DKGRAYcompletes an if-do-done block
`,WKe=Object.freeze(Object.defineProperty({__proto__:null,default:$Ke},Symbol.toStringTag,{value:"Module"})),YKe="",KKe=Object.freeze(Object.defineProperty({__proto__:null,default:YKe},Symbol.toStringTag,{value:"Module"})),XKe="",ZKe=Object.freeze(Object.defineProperty({__proto__:null,default:XKe},Symbol.toStringTag,{value:"Module"})),JKe="",QKe=Object.freeze(Object.defineProperty({__proto__:null,default:JKe},Symbol.toStringTag,{value:"Module"})),eXe=`desc;$DKGRAYelse logic in an if-do-done block
`,tXe=Object.freeze(Object.defineProperty({__proto__:null,default:eXe},Symbol.toStringTag,{value:"Module"})),nXe=`desc;$DKGRAYconditional else logic in an if-do-done block
`,iXe=Object.freeze(Object.defineProperty({__proto__:null,default:nXe},Symbol.toStringTag,{value:"Module"})),rXe="",sXe=Object.freeze(Object.defineProperty({__proto__:null,default:rXe},Symbol.toStringTag,{value:"Module"})),aXe="",oXe=Object.freeze(Object.defineProperty({__proto__:null,default:aXe},Symbol.toStringTag,{value:"Module"})),cXe="",lXe=Object.freeze(Object.defineProperty({__proto__:null,default:cXe},Symbol.toStringTag,{value:"Module"})),uXe="",hXe=Object.freeze(Object.defineProperty({__proto__:null,default:uXe},Symbol.toStringTag,{value:"Module"})),dXe="",fXe=Object.freeze(Object.defineProperty({__proto__:null,default:dXe},Symbol.toStringTag,{value:"Module"})),pXe="",mXe=Object.freeze(Object.defineProperty({__proto__:null,default:pXe},Symbol.toStringTag,{value:"Module"})),gXe="",vXe=Object.freeze(Object.defineProperty({__proto__:null,default:gXe},Symbol.toStringTag,{value:"Module"})),_Xe="",yXe=Object.freeze(Object.defineProperty({__proto__:null,default:_Xe},Symbol.toStringTag,{value:"Module"})),bXe=`desc;$DKGRAYhalt until the next cycle
`,EXe=Object.freeze(Object.defineProperty({__proto__:null,default:bXe},Symbol.toStringTag,{value:"Module"})),SXe=`desc;$DKGRAYevals condition for true or false
`,TXe=Object.freeze(Object.defineProperty({__proto__:null,default:SXe},Symbol.toStringTag,{value:"Module"})),xXe="",wXe=Object.freeze(Object.defineProperty({__proto__:null,default:xXe},Symbol.toStringTag,{value:"Module"})),CXe="",AXe=Object.freeze(Object.defineProperty({__proto__:null,default:CXe},Symbol.toStringTag,{value:"Module"})),RXe="",MXe=Object.freeze(Object.defineProperty({__proto__:null,default:RXe},Symbol.toStringTag,{value:"Module"})),OXe="",NXe=Object.freeze(Object.defineProperty({__proto__:null,default:OXe},Symbol.toStringTag,{value:"Module"})),IXe="",kXe=Object.freeze(Object.defineProperty({__proto__:null,default:IXe},Symbol.toStringTag,{value:"Module"})),PXe="",DXe=Object.freeze(Object.defineProperty({__proto__:null,default:PXe},Symbol.toStringTag,{value:"Module"})),LXe="",UXe=Object.freeze(Object.defineProperty({__proto__:null,default:LXe},Symbol.toStringTag,{value:"Module"})),BXe="",FXe=Object.freeze(Object.defineProperty({__proto__:null,default:BXe},Symbol.toStringTag,{value:"Module"})),zXe="",jXe=Object.freeze(Object.defineProperty({__proto__:null,default:zXe},Symbol.toStringTag,{value:"Module"})),HXe="",VXe=Object.freeze(Object.defineProperty({__proto__:null,default:HXe},Symbol.toStringTag,{value:"Module"})),GXe="",qXe=Object.freeze(Object.defineProperty({__proto__:null,default:GXe},Symbol.toStringTag,{value:"Module"})),$Xe="",WXe=Object.freeze(Object.defineProperty({__proto__:null,default:$Xe},Symbol.toStringTag,{value:"Module"})),YXe="",KXe=Object.freeze(Object.defineProperty({__proto__:null,default:YXe},Symbol.toStringTag,{value:"Module"})),XXe="",ZXe=Object.freeze(Object.defineProperty({__proto__:null,default:XXe},Symbol.toStringTag,{value:"Module"})),JXe="",QXe=Object.freeze(Object.defineProperty({__proto__:null,default:JXe},Symbol.toStringTag,{value:"Module"})),eZe="",tZe=Object.freeze(Object.defineProperty({__proto__:null,default:eZe},Symbol.toStringTag,{value:"Module"})),nZe="",iZe=Object.freeze(Object.defineProperty({__proto__:null,default:nZe},Symbol.toStringTag,{value:"Module"})),rZe="",sZe=Object.freeze(Object.defineProperty({__proto__:null,default:rZe},Symbol.toStringTag,{value:"Module"})),aZe="",oZe=Object.freeze(Object.defineProperty({__proto__:null,default:aZe},Symbol.toStringTag,{value:"Module"})),cZe="",lZe=Object.freeze(Object.defineProperty({__proto__:null,default:cZe},Symbol.toStringTag,{value:"Module"})),uZe="",hZe=Object.freeze(Object.defineProperty({__proto__:null,default:uZe},Symbol.toStringTag,{value:"Module"})),dZe=`desc;$DKGRAYlaunches a bullet
words;dir
words2;dir,kind
`,fZe=Object.freeze(Object.defineProperty({__proto__:null,default:dZe},Symbol.toStringTag,{value:"Module"})),pZe="",mZe=Object.freeze(Object.defineProperty({__proto__:null,default:pZe},Symbol.toStringTag,{value:"Module"})),gZe="",vZe=Object.freeze(Object.defineProperty({__proto__:null,default:gZe},Symbol.toStringTag,{value:"Module"})),_Ze="",yZe=Object.freeze(Object.defineProperty({__proto__:null,default:_Ze},Symbol.toStringTag,{value:"Module"})),bZe="",EZe=Object.freeze(Object.defineProperty({__proto__:null,default:bZe},Symbol.toStringTag,{value:"Module"})),SZe="",TZe=Object.freeze(Object.defineProperty({__proto__:null,default:SZe},Symbol.toStringTag,{value:"Module"})),xZe="",wZe=Object.freeze(Object.defineProperty({__proto__:null,default:xZe},Symbol.toStringTag,{value:"Module"})),CZe="",AZe=Object.freeze(Object.defineProperty({__proto__:null,default:CZe},Symbol.toStringTag,{value:"Module"})),RZe="",MZe=Object.freeze(Object.defineProperty({__proto__:null,default:RZe},Symbol.toStringTag,{value:"Module"})),OZe="",NZe=Object.freeze(Object.defineProperty({__proto__:null,default:OZe},Symbol.toStringTag,{value:"Module"})),IZe="",kZe=Object.freeze(Object.defineProperty({__proto__:null,default:IZe},Symbol.toStringTag,{value:"Module"})),PZe="",DZe=Object.freeze(Object.defineProperty({__proto__:null,default:PZe},Symbol.toStringTag,{value:"Module"})),LZe="",UZe=Object.freeze(Object.defineProperty({__proto__:null,default:LZe},Symbol.toStringTag,{value:"Module"})),BZe="",FZe=Object.freeze(Object.defineProperty({__proto__:null,default:BZe},Symbol.toStringTag,{value:"Module"})),zZe="",jZe=Object.freeze(Object.defineProperty({__proto__:null,default:zZe},Symbol.toStringTag,{value:"Module"})),HZe="",VZe=Object.freeze(Object.defineProperty({__proto__:null,default:HZe},Symbol.toStringTag,{value:"Module"})),GZe="",qZe=Object.freeze(Object.defineProperty({__proto__:null,default:GZe},Symbol.toStringTag,{value:"Module"})),$Ze="",WZe=Object.freeze(Object.defineProperty({__proto__:null,default:$Ze},Symbol.toStringTag,{value:"Module"})),YZe="",KZe=Object.freeze(Object.defineProperty({__proto__:null,default:YZe},Symbol.toStringTag,{value:"Module"})),XZe="",ZZe=Object.freeze(Object.defineProperty({__proto__:null,default:XZe},Symbol.toStringTag,{value:"Module"})),JZe=`desc;$DKGRAYdesignates an inactive label or comment
`,QZe=Object.freeze(Object.defineProperty({__proto__:null,default:JZe},Symbol.toStringTag,{value:"Module"})),eJe=`desc;$DKGRAYadds hyperlink text

`,tJe=Object.freeze(Object.defineProperty({__proto__:null,default:eJe},Symbol.toStringTag,{value:"Module"})),nJe=`desc;$DKGRAYsends the given message when hotkey is pressed

`,iJe=Object.freeze(Object.defineProperty({__proto__:null,default:nJe},Symbol.toStringTag,{value:"Module"})),rJe=`desc;$DKGRAYread number input into given stat/flag
`,sJe=Object.freeze(Object.defineProperty({__proto__:null,default:rJe},Symbol.toStringTag,{value:"Module"})),aJe=`desc;$DKGRAYa slider input from 1 to 9 

`,oJe=Object.freeze(Object.defineProperty({__proto__:null,default:aJe},Symbol.toStringTag,{value:"Module"})),cJe=`desc;$DKGRAYlist with label value pairs to pick from
`,lJe=Object.freeze(Object.defineProperty({__proto__:null,default:cJe},Symbol.toStringTag,{value:"Module"})),uJe=`desc;$DKGRAYread text input into given stat/flag
`,hJe=Object.freeze(Object.defineProperty({__proto__:null,default:uJe},Symbol.toStringTag,{value:"Module"})),dJe=`desc;$DKGRAYdesignates a starting point for running code
`,fJe=Object.freeze(Object.defineProperty({__proto__:null,default:dJe},Symbol.toStringTag,{value:"Module"})),pJe=`desc;$DKGRAYwaits until the object can move in the given direction and moves
`,mJe=Object.freeze(Object.defineProperty({__proto__:null,default:pJe},Symbol.toStringTag,{value:"Module"})),gJe=`desc;$DKGRAYwill move the object in the given direction
`,vJe=Object.freeze(Object.defineProperty({__proto__:null,default:gJe},Symbol.toStringTag,{value:"Module"})),_Je=`desc;$DKGRAYcreates a 60x25 space for terrain and object elements
`,yJe=Object.freeze(Object.defineProperty({__proto__:null,default:_Je},Symbol.toStringTag,{value:"Module"})),bJe=`desc;$DKGRAYcustom 8x14 charset
`,EJe=Object.freeze(Object.defineProperty({__proto__:null,default:bJe},Symbol.toStringTag,{value:"Module"})),SJe=`desc;$DKGRAYsets stat to given value

`,TJe=Object.freeze(Object.defineProperty({__proto__:null,default:SJe},Symbol.toStringTag,{value:"Module"})),xJe=`desc;$DKGRAYsends the given message when hotkey is pressed

`,wJe=Object.freeze(Object.defineProperty({__proto__:null,default:xJe},Symbol.toStringTag,{value:"Module"})),CJe=`desc;$DKGRAYread external content and/or handle events
`,AJe=Object.freeze(Object.defineProperty({__proto__:null,default:CJe},Symbol.toStringTag,{value:"Module"})),RJe=`desc;$DKGRAYread number input into given stat/flag
`,MJe=Object.freeze(Object.defineProperty({__proto__:null,default:RJe},Symbol.toStringTag,{value:"Module"})),OJe=`desc;$DKGRAYelements that can walk, swim, or be used with #shoot

`,NJe=Object.freeze(Object.defineProperty({__proto__:null,default:OJe},Symbol.toStringTag,{value:"Module"})),IJe=`desc;$DKGRAYcustom palette colors
`,kJe=Object.freeze(Object.defineProperty({__proto__:null,default:IJe},Symbol.toStringTag,{value:"Module"})),PJe=`desc;$DKGRAYa slider input from 1 to 9 

`,DJe=Object.freeze(Object.defineProperty({__proto__:null,default:PJe},Symbol.toStringTag,{value:"Module"})),LJe=`desc;$DKGRAYlist with label value pairs to pick from
`,UJe=Object.freeze(Object.defineProperty({__proto__:null,default:LJe},Symbol.toStringTag,{value:"Module"})),BJe=`desc;$DKGRAYterrain for solid, walkable, swimable board elements
`,FJe=Object.freeze(Object.defineProperty({__proto__:null,default:BJe},Symbol.toStringTag,{value:"Module"})),zJe=`desc;$DKGRAYread text input into given stat/flag
`,jJe=Object.freeze(Object.defineProperty({__proto__:null,default:zJe},Symbol.toStringTag,{value:"Module"})),HJe=`desc;$DKGRAYadds text
`,VJe=Object.freeze(Object.defineProperty({__proto__:null,default:HJe},Symbol.toStringTag,{value:"Module"})),GJe=`header;zss controls and inputs
section;keyboard input
option;arrow keys;move
option;shift + arrow keys;shoot
option;enter;ok / accept
option;escape;cancel / close
option;tab;menu / action
section;controller input
option;left stick;move
option;right stick;aim
option;a;ok / accept
option;b;cancel / close
option;y;menu / action
option;x;shoot
option;triggers;shoot
`,qJe=Object.freeze(Object.defineProperty({__proto__:null,default:GJe},Symbol.toStringTag,{value:"Module"})),$Je=`header;developer commands
option;#books;list books in memory
option;#pages;list pages in opened book
option;@[pagetype:]page name;create & edit a new codepage in the currently opened book
option;#trash;list books and pages from open book you can delete
option;#save;flush state to register
option;#share;creates a click to copy share url and QR code
`,WJe=Object.freeze(Object.defineProperty({__proto__:null,default:$Je},Symbol.toStringTag,{value:"Module"})),YJe=`header;H E L P
keyboard input
option;? or /;open terminal
option;esc;close terminal, scroll, or editor
option;tab;change layout
option;up or down arrow keys;navigate terminal items
option;left or right arrow keys;change terminal items
option;enter;activate terminal items
option;alt + arrow keys;skip words and terminal lines
option;ctrl + up / down arrow keys;input history
$32
option;controls;zss controls and inputs
!helpcontrols;read help controls
$32
option;text;zss text and inputs
!helptext;read help text
$32
option;developer;developer commands
!helpdeveloper;read help developer
$32
option;player;player settings & hotkeys
!helpplayer;read help player
`,KJe=Object.freeze(Object.defineProperty({__proto__:null,default:YJe},Symbol.toStringTag,{value:"Module"})),XJe=`header;player settings
#set user "name goes here"
`,ZJe=Object.freeze(Object.defineProperty({__proto__:null,default:XJe},Symbol.toStringTag,{value:"Module"})),JJe=`header;text formatting
section;typography
plain text
use"@quoted strings for special chars"
$$0-255 for ascii chars $159$176$240
use color names like $RED$$red$BLUE to change foreground color
use color names like $ONGREEN$$ongreen$ONCLEAR to change background color
use onclear $WHITE$$onclear$BLUE to change background to transparent
section;hyperlinks
option;!hotkey label <shortcut> [shortcutword];
send the given #label when the <shortcut> is pressed
!openit https://github.com/ianstormtaylor/is-hotkey;$BLUEuses is-hotkey
option;!range flag [minword] [maxword];
uses the standard 1 to 9 values input range
option;!select flag ...list of <word> <value> pairs;
gives a user a way to cycle through preset values
option;!text flag;
write user text input into a flag
`,QJe=Object.freeze(Object.defineProperty({__proto__:null,default:JJe},Symbol.toStringTag,{value:"Module"})),fre=Object.assign({"./editor/codepagename.txt":lKe,"./editor/command/become.txt":hKe,"./editor/command/bgplay.txt":fKe,"./editor/command/bgvol.txt":mKe,"./editor/command/bind.txt":vKe,"./editor/command/board.txt":yKe,"./editor/command/bpm.txt":EKe,"./editor/command/break.txt":TKe,"./editor/command/change.txt":wKe,"./editor/command/char.txt":AKe,"./editor/command/charset.txt":MKe,"./editor/command/clear.txt":NKe,"./editor/command/color.txt":kKe,"./editor/command/continue.txt":DKe,"./editor/command/copy.txt":UKe,"./editor/command/cycle.txt":FKe,"./editor/command/die.txt":jKe,"./editor/command/distort.txt":VKe,"./editor/command/do.txt":qKe,"./editor/command/done.txt":WKe,"./editor/command/duplicate.txt":KKe,"./editor/command/echo.txt":ZKe,"./editor/command/edge.txt":QKe,"./editor/command/else.txt":tXe,"./editor/command/elseif.txt":iXe,"./editor/command/end.txt":sXe,"./editor/command/endgame.txt":oXe,"./editor/command/endwith.txt":lXe,"./editor/command/fcrush.txt":hXe,"./editor/command/fetch.txt":fXe,"./editor/command/fetchwith.txt":mXe,"./editor/command/foreach.txt":vXe,"./editor/command/go.txt":yXe,"./editor/command/idle.txt":EXe,"./editor/command/if.txt":TXe,"./editor/command/lock.txt":wXe,"./editor/command/oneof.txt":AXe,"./editor/command/oneofwith.txt":MXe,"./editor/command/palette.txt":NXe,"./editor/command/phaser.txt":kXe,"./editor/command/pivot.txt":DXe,"./editor/command/play.txt":UXe,"./editor/command/put.txt":FXe,"./editor/command/putwith.txt":jXe,"./editor/command/readbin.txt":VXe,"./editor/command/readjson.txt":qXe,"./editor/command/readline.txt":WXe,"./editor/command/readrexpaint.txt":KXe,"./editor/command/remix.txt":ZXe,"./editor/command/repeat.txt":QXe,"./editor/command/restore.txt":tZe,"./editor/command/reverb.txt":iZe,"./editor/command/revert.txt":sZe,"./editor/command/run.txt":oZe,"./editor/command/runwith.txt":lZe,"./editor/command/set.txt":hZe,"./editor/command/shoot.txt":fZe,"./editor/command/shootwith.txt":mZe,"./editor/command/shove.txt":vZe,"./editor/command/snapshot.txt":yZe,"./editor/command/synth.txt":EZe,"./editor/command/toast.txt":TZe,"./editor/command/tts.txt":wZe,"./editor/command/ttsvol.txt":AZe,"./editor/command/twitchbroadcast.txt":MZe,"./editor/command/twitchchat.txt":NZe,"./editor/command/unlock.txt":kZe,"./editor/command/vibrato.txt":DZe,"./editor/command/vol.txt":UZe,"./editor/command/waitfor.txt":FZe,"./editor/command/walk.txt":jZe,"./editor/command/weave.txt":VZe,"./editor/command/while.txt":qZe,"./editor/command/with.txt":WZe,"./editor/command/write.txt":KZe,"./editor/command/zap.txt":ZZe,"./editor/comment.txt":QZe,"./editor/hyperlink.txt":tJe,"./editor/hyperlink/hotkey.txt":iJe,"./editor/hyperlink/number.txt":sJe,"./editor/hyperlink/range.txt":oJe,"./editor/hyperlink/select.txt":lJe,"./editor/hyperlink/text.txt":hJe,"./editor/label.txt":fJe,"./editor/shortgo.txt":mJe,"./editor/shorttry.txt":vJe,"./editor/stat/board.txt":yJe,"./editor/stat/charset.txt":EJe,"./editor/stat/const.txt":TJe,"./editor/stat/hotkey.txt":wJe,"./editor/stat/loader.txt":AJe,"./editor/stat/number.txt":MJe,"./editor/stat/object.txt":NJe,"./editor/stat/palette.txt":kJe,"./editor/stat/range.txt":DJe,"./editor/stat/select.txt":UJe,"./editor/stat/terrain.txt":FJe,"./editor/stat/text.txt":jJe,"./editor/text.txt":VJe,"./help/controls.txt":qJe,"./help/developer.txt":WJe,"./help/menu.txt":KJe,"./help/player.txt":ZJe,"./help/text.txt":QJe}),zve={};M_(fre).forEach(t=>{const e=t.replace(".txt","").replace("./","").replaceAll("/",":");zve[e]=fre[t].default});function jve(t){const e=Wn(t.trim().replaceAll(`
`,"").replace(/:+$/,"")),n=zve[e];if(re(n))return n;const{target:i,path:r}=O_(e);switch(i){case"editor":{const s=O_(r);switch(s.target){case"command":if(s.path.length)return`desc;$DKGRAYsends the message ${s.path}`}break}}}function Hve(t,e){const n=(t??"").split(`
`);for(let i=0;i<n.length;++i)e(n[i].split(";"))}function eQe(t,e){const[n,...i]=e,r=i[0]??"",s=i[1]??"";switch(Wn(n.trim())){case"header":Bg(Ye,t,r);break;case"section":rT(Ye,t,r);break;case"option":hp(Ye,t,r,s);break;default:n.trimStart().startsWith("!")?gze(Ye,t,n.trimStart().slice(1),r):Zs(Ye,t,n);break}}function tQe(t){const e={};return Hve(t,n=>{const[i,...r]=n,s=r[0]??"";e[i]=s}),e}function dw(){p6e(Ye,MO())}function gM(t){Hve(jve(`help:${t}`),e=>eQe(ie.elementfocus,e))}const nQe=q_().command("send",(t,e)=>{const[n,i]=Rt(e,0,[Ke.NAME,Ke.ANY]);switch(Wn(n)){case"helpmenu":gM("menu");break;case"helpcontrols":gM("controls");break;case"helptext":gM("text");break;case"helpdeveloper":gM("developer");break;case"helpplayer":gM("player");break;default:{const[r,s]=wK(n);v_e(r==="self"&&ie.elementisplayer?`${ie.elementfocus}:${s}`:n,i);break}}return 0}).command("stat",(t,e)=>{const[n,...i]=e.map(ca),r=i.join(" ");function s(a,o){if(re(a)&&(t.command("pageopen",a.id),o)){const c=mu(a),l=Fy(a);Zs(Ye,ie.elementfocus,`!pageopen ${a.id};$blue[${l}]$white ${c}`)}}switch(Wn(n)){case Qh(gn.LOADER):{const[a,o]=Jy(Lc.CONTENT,r,Xn.LOADER);s(a,o);break}default:{const[a,o]=Jy(Lc.CONTENT,[n,...i].join(" "),Xn.OBJECT);s(a,o);break}case Qh(gn.BOARD):{const[a,o]=Jy(Lc.CONTENT,r,Xn.BOARD);s(a,o);break}case Qh(gn.OBJECT):{const[a,o]=Jy(Lc.CONTENT,r,Xn.OBJECT);s(a,o);break}case Qh(gn.TERRAIN):{const[a,o]=Jy(Lc.CONTENT,r,Xn.TERRAIN);s(a,o);break}case Qh(gn.CHARSET):{const[a,o]=Jy(Lc.CONTENT,r,Xn.CHARSET);s(a,o);break}case Qh(gn.PALETTE):{const[a,o]=Jy(Lc.CONTENT,r,Xn.PALETTE);s(a,o);break}}return 0}).command("text",(t,e)=>{const n=e.map(ca).join(" ");if(re(ie.element)&&ie.elementisplayer){const{user:i}=T1(ie.elementid),r=Tn(i)?i:"player";ie.element.tickertext=`${r}: ${n}`,ie.element.tickertime=ie.timestamp;const s=j3(ie.book,ie.element,1,qt.WHITE,qt.BLACK);xr(Ye,ie.elementid,`$${qt[s.color]}$ON${qt[s.bg]}$${s.char}$ONCLEAR $WHITE${r}$BLUE ${n}`),xm(Ye,ie.elementid,void 0,"text","chat:message:game",`${r}:${n}`)}return 0}).command("hyperlink",(t,e)=>{const[n,...i]=e,r=ca(n),s=i.map(ca).join(" "),{user:a}=T1(ie.elementid),o=Tn(a)?a:"player",c=j3(ie.book,ie.element,1,qt.WHITE,qt.BLACK);return xr(Ye,ie.elementid,`!${s};$${qt[c.color]}$ON${qt[c.bg]}$${c.char}$ONCLEAR $WHITE${o}$BLUE ${r}`),0}).command("config",(t,e)=>{const[n,i]=Rt(e,0,[Ke.MAYBE_NAME,Ke.MAYBE_STRING]);return Tn(n)&&Tn(i)?V4e(Ye,ie.elementfocus,n,i):G4e(Ye,ie.elementfocus),0}).command("bookcreate",(t,e)=>{const[n]=Rt(e,0,[Ke.MAYBE_NAME]),i=m_e(n);return re(i)&&t.command("bookopen",i.id),0}).command("bookopen",(t,e)=>{const[n]=Rt(e,0,[Ke.NAME]),i=Jv(n);return re(i)?(xr(Ye,ie.elementfocus,`opened [book] ${i.name}`),m$(Lc.MAIN,i.id),t.command("pages")):Mi(Ye,ie.elementfocus,"bookopen",`book ${n} not found`),0}).command("booktrash",(t,e)=>{const[n]=Rt(e,0,[Ke.NAME]),i=nC(Lc.MAIN),r=Jv(n);return re(r)&&(i===r&&m$(Lc.MAIN,""),Qet(n),xr(Ye,ie.elementfocus,`trashed [book] ${r.name}`),dw(),t.command("pages")),0}).command("boardopen",(t,e)=>{const[n]=Rt(e,0,[Ke.NAME]),i=fp(ie.book,Xn.BOARD,n);if(i.length){const r=io(...i);re(r)&&eC(ie.book,ie.elementfocus,r.id,{x:rf(0,kn-1),y:rf(0,ur-1)})}return 0}).command("pageopen",(t,e)=>{const[n,i]=Rt(e,0,[Ke.NAME,Ke.MAYBE_NAME]),r=c_(Lc.MAIN);if(!re(r))return 0;const s=g1(r,n);if(re(s)){const a=mu(s),o=Fy(s);xr(Ye,ie.elementfocus,`opened [${o}] ${a}`);const c=[s.id,i];Uve(vme(r.id,c),s.code);const l=Fy(s);K4e(Ye,ie.elementfocus,r.id,c,l,`${a} - ${r.name}`)}else Mi(Ye,"pageopen",`page ${n} not found`,ie.elementfocus);return 0}).command("pagetrash",(t,e)=>{const[n]=Rt(e,0,[Ke.NAME]),i=c_(Lc.MAIN),r=P0e(i,n);if(re(n)){const s=mu(r),a=Fy(r);xr(Ye,ie.elementfocus,`trashed [${a}] ${s}`),dw(),t.command("pages")}return 0}).command("help",(t,e)=>{const n=e.map(ca).join(" ")||"menu";return t.command(`help${n}`),0}).command("books",()=>{rT(Ye,ie.elementfocus,"books");const t=nC(Lc.MAIN);hp(Ye,ie.elementfocus,"main",`${(t==null?void 0:t.name)??"empty"} $GREEN${(t==null?void 0:t.id)??""}`);const e=nC(Lc.CONTENT);hp(Ye,ie.elementfocus,"content",`${(e==null?void 0:e.name)??"empty"} ${(e==null?void 0:e.id)??""}`),Y9(Ye,ie.elementfocus,7);const n=gL();return n.length?n.forEach(i=>{Zs(Ye,ie.elementfocus,`!bookopen ${i.id};${i.name}`)}):Hl(Ye,ie.elementfocus,"no books found"),Zs(Ye,ie.elementfocus,"!bookcreate;create a new book"),0}).command("pages",()=>{const t=c_(Lc.MAIN);return re(t)&&(rT(Ye,ie.elementfocus,"pages"),hp(Ye,ie.elementfocus,"main",`${t.name} $GREEN${t.id}`),t.pages.length?vH(t).forEach(n=>{const i=mu(n),r=Fy(n);Zs(Ye,ie.elementfocus,`!pageopen ${n.id};$blue[${r}]$white ${i}`)}):(Zs(Ye,ie.elementfocus,""),Hl(Ye,ie.elementfocus,"$white no pages found"),Hl(Ye,ie.elementfocus,"$white use @ to create a page"),Hl(Ye,ie.elementfocus,"$white @board name of board"),Hl(Ye,ie.elementfocus,"$white @object name of object"),Hl(Ye,ie.elementfocus,"$white @terrain name of terrain"),Hl(Ye,ie.elementfocus,"$white You can omit the type and it will default to object"),Hl(Ye,ie.elementfocus,"$white @object name of object"),Hl(Ye,ie.elementfocus,"$white @name of object"))),0}).command("boards",()=>{rT(Ye,ie.elementfocus,"boards");const t=c_(Lc.MAIN);if(re(t)){hp(Ye,ie.elementfocus,"main",`${t.name} $GREEN${t.id}`);const e=vH(t);e.filter(n=>m1(n)===Xn.BOARD).forEach(n=>{const i=mu(n),r=Fy(n);Zs(Ye,ie.elementfocus,`!boardopen ${n.id};$blue[${r}]$white ${i}`)}),e.length===0&&(Zs(Ye,ie.elementfocus,""),Hl(Ye,ie.elementfocus,"$white no boards found"),Hl(Ye,ie.elementfocus,"$white use @ to create a board"),Hl(Ye,ie.elementfocus,"$white @board name of board"))}return 0}).command("trash",()=>{rT(Ye,ie.elementfocus,"$REDTRASH"),Hl(Ye,ie.elementfocus,"books");const t=gL();t.length&&(t.forEach(n=>{Zs(Ye,ie.elementfocus,`!booktrash ${n.id};$REDTRASH ${n.name}`)}),Zs(Ye,ie.elementfocus,""));const e=nC(Lc.MAIN);return re(e)&&(Hl(Ye,ie.elementfocus,`pages in open ${e.name} book`),e.pages.forEach(n=>{const i=mu(n);Zs(Ye,ie.elementfocus,`!pagetrash ${n.id};$REDTRASH ${i}`)}),Zs(Ye,ie.elementfocus,"")),0}).command("dev",()=>(dw(),k4e(Ye,ie.elementfocus),0)).command("share",()=>(dw(),P4e(Ye,ie.elementfocus),0)).command("save",()=>(dw(),0)).command("fork",()=>(m6e(Ye,ie.elementfocus),0)).command("nuke",()=>(D4e(Ye,ie.elementfocus),0)).command("restart",()=>(d6e(Ye,ie.elementfocus),dw(),0)).command("export",()=>{Bg(Ye,ie.elementfocus,"E X P O R T"),rT(Ye,ie.elementfocus,"books");const t=gL();return t.length&&t.forEach(e=>Zs(Ye,ie.elementfocus,`!bookexport ${e.id};${e.name}`)),0}).command("bookexport",(t,e)=>{const[n]=Rt(e,0,[Ke.NAME]),i=Jv(n);return re(i)&&(Bg(Ye,ie.elementfocus,"E X P O R T"),rT(Ye,ie.elementfocus,"pages"),setTimeout(()=>{if(i.pages.length){const r=vH(i);Zs(Ye,ie.elementfocus,`!bookallexport ${n};$blue[all]$white export book`),r.forEach(s=>{const a=mu(s),o=Fy(s);Zs(Ye,ie.elementfocus,`!pageexport ${n}:${s.id};$blue[${o}]$white ${a}`)})}},1e3)),0}).command("bookallexport",(t,e)=>{const[n]=Rt(e,0,[Ke.NAME]),i=Jv(n);return re(i)&&nne(Ye,ie.elementfocus,ro(i),`${i.name}.book.json`),0}).command("pageexport",(t,e)=>{const[n]=Rt(e,0,[Ke.NAME]),{target:i,path:r}=O_(n),s=Jv(i),a=g1(s,r);return re(a)&&nne(Ye,ie.elementfocus,ro(a),`${mu(a)}.${Fy(a)}.json`),0}).command("gadget",()=>(q4e(Ye,ie.elementfocus),0)).command("joincode",(t,e)=>{const[n]=Rt(e,0,[Ke.MAYBE_NAME]);return A4e(Ye,ie.elementfocus,!!n),0}).command("jointab",(t,e)=>{const[n]=Rt(e,0,[Ke.MAYBE_NAME]);return R4e(Ye,ie.elementfocus,!!n),0}),iQe=q_().command("toast",(t,e)=>{const n=e.map(ca).join("");return g4e(Ye,ie.elementfocus,n),0}).command("palette",(t,e)=>{const[n]=Rt(e,0,[Ke.NAME]),i=Ire(),r=vh(ie.book,Xn.PALETTE,n);return re(r)?(i.palette=r.id,xr(Ye,ie.elementfocus,`loaded palette ${n}`)):Mi(Ye,ie.elementfocus,"not-found",`unabled to find palette ${n}`),0}).command("charset",(t,e)=>{const[n]=Rt(e,0,[Ke.NAME]),i=Ire(),r=vh(ie.book,Xn.CHARSET,n);return re(r)?(i.charset=r.id,xr(Ye,ie.elementfocus,`loaded charset ${n}`)):Mi(Ye,ie.elementfocus,"not-found",`unabled to find charset ${n}`),0}),Vve={isterrain:"ISTERRAIN",isobject:"ISOBJECT"};function eI(t){return ji(t)&&Gve(t[0])}function Gve(t){return re(c1[t])&&Tn(t)}function qve(t){if(Tn(t))return Vve[Wn(t)]}function pre(t){if(eI(t))return t;if(Gve(t))return[t];const e=qve(t);if(re(e))return[e]}function rQe(t){const e=ie.words[t],n=pre(e);if(eI(n))return[n,t+1];const[i,r]=Xh(t),s=pre(i);return eI(s)?[s,r]:[void 0,t]}const $ve={issolid:"ISSOLID",iswalk:"ISWALK",isswim:"ISSWIM",isbullet:"ISBULLET",iswalking:"ISWALK",iswalkable:"ISWALK",isswimming:"ISSWIM",isswimmable:"ISSWIM"};Qr.ISSOLID,Qr.ISWALK,Qr.ISSWIM,Qr.ISBULLET,Qr.ISWALK,Qr.ISSWIM;function J3(t){return ji(t)&&l$(t[0])}function l$(t){return re(Qr[t])&&Tn(t)}function sQe(t){if(Tn(t))return $ve[Wn(t)]}function aQe(t){const e=ie.words[t];if(J3(e))return[e,t+1];if(l$(e))return[[e],t+1];const[n,i]=Xh(t);return J3(n)?[n,i]:l$(n)?[[n],i]:[void 0,t]}const oQe=new Set(["inputmove","inputalt","inputctrl","inputshift","inputok","inputcancel","inputmenu"]),mre=new Set(["char","color","bg","group","party","player","pushable","collision","destructible","p1","p2","p3","cycle","stepx","stepy","light","lightdir","sender","arg"]),cQe=["NORTH","SOUTH","WEST","EAST"];function lQe(t){const e=T1(t);if(an(e.inputcurrent)||(e.inputcurrent=0),ji(e.inputqueue)||(e.inputqueue=[]),e.inputcurrent>0)return e;const[n]=e.inputqueue,[i=Ft.NONE,r=0]=n??[Ft.NONE,0];switch(e.inputmove=[],e.inputok=0,e.inputcancel=0,e.inputmenu=0,e.inputalt=r&Z9?1:0,e.inputctrl=r&J9?1:0,e.inputshift=r&Q9?1:0,i){case Ft.MOVE_UP:case Ft.MOVE_DOWN:case Ft.MOVE_LEFT:case Ft.MOVE_RIGHT:e.inputmove=[cQe[i-Ft.MOVE_UP]];break;case Ft.OK_BUTTON:e.inputok=1;break;case Ft.CANCEL_BUTTON:e.inputcancel=1;break;case Ft.MENU_BUTTON:e.inputmenu=1;break}return e.inputcurrent=i,e.inputqueue=e.inputqueue.filter(s=>{const[a]=s;return a!==Ft.NONE&&a!==i}),e}function uQe(t){const e=Vve[t];if(re(e))return e;const n=$ve[t];if(re(n))return n;const i=R4[t];if(re(i))return i;const r=i0e[t];if(re(r))return r}const hQe=q_({get(t,e){var a,o,c,l,u,h,d,f,p,g,_,v,b,S,x,M,R,I,k,P,U;const n=uQe(e);if(re(n))return[!0,n];if(ie.elementisplayer&&oQe.has(e)){const V=lQe(ie.elementid)[e];return[re(V),V]}const i=BN(ie.board,{x:((a=ie.element)==null?void 0:a.x)??-1,y:((o=ie.element)==null?void 0:o.y)??-1},ie.elementfocus),r=(i==null?void 0:i.id)??ie.elementfocus??MO();switch(e){case"isdark":return[!0,(c=ie.board)!=null&&c.isdark?1:0];case"startx":return[!0,((l=ie.board)==null?void 0:l.startx)??0];case"starty":return[!0,((u=ie.board)==null?void 0:u.starty)??0];case"over":return[!0,((h=ie.board)==null?void 0:h.over)??""];case"under":return[!0,((d=ie.board)==null?void 0:d.under)??""];case"camera":return[!0,((f=ie.board)==null?void 0:f.camera)??""];case"graphics":return[!0,((p=ie.board)==null?void 0:p.graphics)??""];case"facing":break;case"exitnorth":return[!0,((g=ie.board)==null?void 0:g.exitnorth)??""];case"exitsouth":return[!0,((_=ie.board)==null?void 0:_.exitsouth)??""];case"exitwest":return[!0,((v=ie.board)==null?void 0:v.exitwest)??""];case"exiteast":return[!0,((b=ie.board)==null?void 0:b.exiteast)??""];case"timelimit":return[!0,((S=ie.board)==null?void 0:S.timelimit)??0];case"restartonzap":return[!0,((x=ie.board)==null?void 0:x.restartonzap)??0];case"maxplayershots":return[!0,((M=ie.board)==null?void 0:M.maxplayershots)??0];case"boardid":return[!0,((R=ie.board)==null?void 0:R.id)??"ERR"];case"playerx":return[!0,(i==null?void 0:i.x)??-1];case"playery":return[!0,(i==null?void 0:i.y)??-1];case"thisid":return[!0,((I=ie.element)==null?void 0:I.id)??""];case"thisx":return[!0,((k=ie.element)==null?void 0:k.x)??-1];case"thisy":return[!0,((P=ie.element)==null?void 0:P.y)??-1];default:{const V=(U=ie.element)==null?void 0:U[e];if(mre.has(e))return[!0,V];break}}const s=T1(r)[e];return[re(s),s]},set(t,e,n){var a,o;const i=BN(ie.board,{x:((a=ie.element)==null?void 0:a.x)??-1,y:((o=ie.element)==null?void 0:o.y)??-1},ie.elementfocus),r=(i==null?void 0:i.id)??ie.elementfocus;switch(e){case"isdark":if(re(ie.board))return ie.board.isdark=n?1:0,[!0,ie.board.isdark];break;case"startx":if(re(ie.board))return ie.board.startx=xT(n,0),[!0,ie.board.startx];break;case"starty":if(re(ie.board))return ie.board.starty=xT(n,0),[!0,ie.board.starty];break;case"over":if(re(ie.board))return ie.board.over=an(n)?n:ca(n),[!0,ie.board.over];break;case"under":if(re(ie.board))return ie.board.under=an(n)?n:ca(n),[!0,ie.board.under];break;case"camera":if(re(ie.board))return[!0,ie.board.camera=ca(n)];break;case"graphics":if(re(ie.board))return[!0,ie.board.graphics=ca(n)];break;case"facing":break;case"exitnorth":if(re(ie.board))return ie.board.exitnorth=ca(n),[!0,ie.board.exitnorth];break;case"exitsouth":if(re(ie.board))return ie.board.exitsouth=ca(n),[!0,ie.board.exitsouth];break;case"exitwest":if(re(ie.board))return ie.board.exitwest=ca(n),[!0,ie.board.exitwest];break;case"exiteast":if(re(ie.board))return ie.board.exiteast=ca(n),[!0,ie.board.exiteast];break;case"timelimit":if(re(ie.board))return ie.board.timelimit=xT(n,0),[!0,ie.board.timelimit];break;case"restartonzap":if(re(ie.board))return ie.board.restartonzap=n?1:0,[!0,ie.board.restartonzap];break;case"maxplayershots":if(re(ie.board))return ie.board.maxplayershots=xT(n,0),[!0,ie.board.maxplayershots];break;case"boardid":return[!1,n];case"playerx":return[!1,n];case"playery":return[!1,n];case"thisid":return[!1,n];case"thisx":return[!1,n];case"thisy":return[!1,n];default:{if(mre.has(e))return re(ie.element)&&(ie.element[e]=n),[!0,n];break}}const s=T1(r);return re(s)?(s[e]=n,[!0,n]):[!1,n]},everytick(){var t,e,n,i,r;if(!((t=ie.element)!=null&&t.removed)&&(re((e=ie.element)==null?void 0:e.stepx)||re((n=ie.element)==null?void 0:n.stepy))){const s={x:((i=ie.element)==null?void 0:i.x)??0,y:((r=ie.element)==null?void 0:r.y)??0};CC(ie.book,ie.board,ie.element,{x:s.x+(ie.element.stepx??0),y:s.y+(ie.element.stepy??0)})===!1&&(ie.element.stepx=0,ie.element.stepy=0,yc(ie.book,ie.element,"destructible")&&e0(ie.book,ie.board,ie.element,ie.timestamp))}}}).command("clear",(t,e)=>{for(let n=0;n<e.length;++n)t.set(ca(e[n]),0);return 0}).command("set",(t,e)=>{const[n,i]=Rt(e,0,[Ke.NAME,Ke.ANY]);return t.set(n,i??1),0}).command("become",(t,e)=>{var i,r;const[n]=Rt(e,0,[Ke.KIND]);if(wl(ie.book,ie.board),L0e(ie.book,ie.board,ie.element),e0(ie.book,ie.board,ie.element,ie.timestamp)){const s={x:((i=ie.element)==null?void 0:i.x)??0,y:((r=ie.element)==null?void 0:r.y)??0};lE(ie.book,ie.board,n,s)}return t.endofprogram(),0}).command("bind",()=>0).command("char",(t,e)=>{const[n]=Rt(e,0,[Ke.ANY]);if(P_(n)){const[i,r]=Rt(e,0,[Ke.DIR,Ke.NUMBER]),s=bc(ie.board,i.destpt);re(s)&&(s.char=r)}else re(ie.element)&&an(n)&&(ie.element.char=n);return 0}).command("color",(t,e)=>{const[n]=Rt(e,0,[Ke.ANY]);if(P_(n)){const[i,r]=Rt(e,0,[Ke.DIR,Ke.COLOR]),s=bc(ie.board,i.destpt);re(s)&&LN(ie.element,r)}else{const[i]=Rt(e,0,[Ke.COLOR]);re(ie.element)&&re(i)&&LN(ie.element,i)}return 0}).command("go",(t,e)=>{if(re(ie.element)){const[n]=Rt(e,0,[Ke.DIR]);if(CC(ie.book,ie.board,ie.element,n.destpt),t.yield(),ie.element.x===n.destpt.x&&ie.element.y===n.destpt.y)return 0}return 1}).command("walk",(t,e)=>{if(!re(ie.element))return 0;const[n]=Rt(e,0,[Ke.DIR]),i=ie.element.x??0,r=ie.element.y??0;return ie.element.stepx=n.destpt.x-i,ie.element.stepy=n.destpt.y-r,0}).command("idle",t=>(t.yield(),0)).command("end",t=>(t.endofprogram(),0)).command("endwith",(t,e)=>{const[n]=Rt(e,0,[Ke.ANY]);return t.set("arg",n),t.command("end")}).command("lock",t=>(t.lock(t.id()),0)).command("restore",(t,e)=>(t.restore(ca(e[0])),0)).command("unlock",t=>(t.unlock(),0)).command("zap",(t,e)=>(t.zap(ca(e[0])),0)).command("cycle",(t,e)=>{if(re(ie.element)){const[n]=Rt(e,0,[Ke.NUMBER]);ie.element.cycle=er(Math.round(n),1,255)}return 0}).command("die",t=>(e0(ie.book,ie.board,ie.element,ie.timestamp),t.endofprogram(),0)).command("endgame",()=>(r6e(Ye,ie.elementfocus),0)).command("run",(t,e)=>{const[n]=Rt(e,0,[Ke.NAME]);return nB(n),0}).command("runwith",(t,e)=>{const[n,i]=Rt(e,0,[Ke.ANY,Ke.NAME]);return t.set("arg",n),nB(i),0}),Wve={};function dQe(t){var e;return(e=Wve[t])==null?void 0:e.format}function Mb(t){var e;return(e=Wve[t])==null?void 0:e.content}function gre(t,e){if(!re(t))return;const n=Wn(e),i=n.endsWith("le");switch(n){case"float32":case"float32le":{const r=t.dataview.getFloat32(t.cursor,i);return t.cursor+=4,r}case"float64":case"float64le":{const r=t.dataview.getFloat64(t.cursor,i);return t.cursor+=8,r}case"int8":case"int8le":{const r=t.dataview.getInt8(t.cursor);return t.cursor+=1,r}case"int16":case"int16le":{const r=t.dataview.getInt16(t.cursor,i);return t.cursor+=2,r}case"int32":case"int32le":{const r=t.dataview.getInt32(t.cursor,i);return t.cursor+=4,r}case"int64":case"int64le":{const r=t.dataview.getBigInt64(t.cursor,i);return t.cursor+=8,r}case"uint8":case"uint8le":{const r=t.dataview.getUint8(t.cursor);return t.cursor+=1,r}case"uint16":case"uint16le":{const r=t.dataview.getUint16(t.cursor,i);return t.cursor+=2,r}case"uint32":case"uint32le":{const r=t.dataview.getUint32(t.cursor,i);return t.cursor+=4,r}case"uint64":case"uint64le":{const r=t.dataview.getBigUint64(t.cursor,i);return t.cursor+=8,r}}}const fQe=(t,e)=>{const n=Mb(t.id());if(!re(n))return 0;const[i,r]=Rt(e,0,[Ke.NAME]),s=Wn(i);switch(s){case"seek":{const[a]=Rt(e,r,[Ke.NUMBER]);n.cursor=a;break}case"float32":case"float32le":case"float64":case"float64le":case"int8":case"int8le":case"int16":case"int16le":case"int32":case"int32le":case"int64":case"int64le":case"uint8":case"uint8le":case"uint16":case"uint16le":case"uint32":case"uint32le":case"uint64":case"uint64le":{const[a]=Rt(e,r,[Ke.NAME]);t.set(a,gre(n,s));break}case"text":{const[a,o]=Rt(e,r,[Ke.NAME,Ke.NAME]),c=gre(n,a);if(an(c)&&Tn(o)){const l=new Uint8Array(n.bytes.buffer,n.cursor,c),h=new TextDecoder("utf-8").decode(l);t.set(o,h),n.cursor+=c}break}case"palette":{const[a]=Rt(e,r,[Ke.NAME]),[o]=Zq(ie.book,Xn.PALETTE,a),c=Qc(o);if(re(c)){const l=Dme*l1,u=PE(new Uint8Array(n.bytes.buffer,n.cursor,l));re(u)&&(c.bits=u.bits),n.cursor+=l}break}case"charset":{const[a]=Rt(e,r,[Ke.NAME]),[o]=Zq(ie.book,Xn.CHARSET,a),c=Qc(o);if(re(c)){const l=dp*Oq*Mq,u=V1(new Uint8Array(n.bytes.buffer,n.cursor,l));re(u)&&(c.bits=u.bits),n.cursor+=l}break}}return 0},xA=t=>t!==null&&Object.prototype.toString.call(t)==="[object Object]",Q3=(t,e)=>{if(t===e)return!0;if(typeof t!=typeof e)return!1;if(Array.isArray(t)&&Array.isArray(e)){if(t.length!==e.length)return!1;for(let n=0;n<t.length;n+=1)if(!Q3(t[n],e[n]))return!1;return!0}if(xA(t)&&xA(e)){const n=Object.entries(t),i=new Set(Object.keys(e));if(n.length!==i.size)return!1;for(const[r,s]of n){if(!Q3(s,e[r]))return!1;i.delete(r)}return i.size===0}return!1},i2=t=>{if(t===""||t===!1||t===null||t===void 0||Array.isArray(t)&&t.length===0)return!0;if(xA(t)){for(const e in t)if(t.hasOwnProperty(e))return!1;return!0}return!1},pQe=t=>t>="a"&&t<="z"||t>="A"&&t<="Z"||t==="_",vre=t=>t>="0"&&t<="9"||t==="-",mQe=t=>t>="a"&&t<="z"||t>="A"&&t<="Z"||t>="0"&&t<="9"||t==="_";var mt;(function(t){t.TOK_EOF="EOF",t.TOK_UNQUOTEDIDENTIFIER="UnquotedIdentifier",t.TOK_QUOTEDIDENTIFIER="QuotedIdentifier",t.TOK_RBRACKET="Rbracket",t.TOK_RPAREN="Rparen",t.TOK_COMMA="Comma",t.TOK_COLON="Colon",t.TOK_RBRACE="Rbrace",t.TOK_NUMBER="Number",t.TOK_CURRENT="Current",t.TOK_ROOT="Root",t.TOK_EXPREF="Expref",t.TOK_PIPE="Pipe",t.TOK_OR="Or",t.TOK_AND="And",t.TOK_EQ="EQ",t.TOK_GT="GT",t.TOK_LT="LT",t.TOK_GTE="GTE",t.TOK_LTE="LTE",t.TOK_NE="NE",t.TOK_FLATTEN="Flatten",t.TOK_STAR="Star",t.TOK_FILTER="Filter",t.TOK_DOT="Dot",t.TOK_NOT="Not",t.TOK_LBRACE="Lbrace",t.TOK_LBRACKET="Lbracket",t.TOK_LPAREN="Lparen",t.TOK_LITERAL="Literal"})(mt||(mt={}));const _re={"(":mt.TOK_LPAREN,")":mt.TOK_RPAREN,"*":mt.TOK_STAR,",":mt.TOK_COMMA,".":mt.TOK_DOT,":":mt.TOK_COLON,"@":mt.TOK_CURRENT,$:mt.TOK_ROOT,"]":mt.TOK_RBRACKET,"{":mt.TOK_LBRACE,"}":mt.TOK_RBRACE},gQe={"!":!0,"<":!0,"=":!0,">":!0},vQe={"	":!0,"\n":!0,"\r":!0," ":!0};class _Qe{constructor(){this._current=0}tokenize(e){const n=[];this._current=0;let i,r,s;for(;this._current<e.length;)if(pQe(e[this._current]))i=this._current,r=this.consumeUnquotedIdentifier(e),n.push({start:i,type:mt.TOK_UNQUOTEDIDENTIFIER,value:r});else if(_re[e[this._current]]!==void 0)n.push({start:this._current,type:_re[e[this._current]],value:e[this._current]}),this._current+=1;else if(vre(e[this._current]))s=this.consumeNumber(e),n.push(s);else if(e[this._current]==="[")s=this.consumeLBracket(e),n.push(s);else if(e[this._current]==='"')i=this._current,r=this.consumeQuotedIdentifier(e),n.push({start:i,type:mt.TOK_QUOTEDIDENTIFIER,value:r});else if(e[this._current]==="'")i=this._current,r=this.consumeRawStringLiteral(e),n.push({start:i,type:mt.TOK_LITERAL,value:r});else if(e[this._current]==="`"){i=this._current;const a=this.consumeLiteral(e);n.push({start:i,type:mt.TOK_LITERAL,value:a})}else if(gQe[e[this._current]]!==void 0)s=this.consumeOperator(e),s&&n.push(s);else if(vQe[e[this._current]]!==void 0)this._current+=1;else if(e[this._current]==="&")i=this._current,this._current+=1,e[this._current]==="&"?(this._current+=1,n.push({start:i,type:mt.TOK_AND,value:"&&"})):n.push({start:i,type:mt.TOK_EXPREF,value:"&"});else if(e[this._current]==="|")i=this._current,this._current+=1,e[this._current]==="|"?(this._current+=1,n.push({start:i,type:mt.TOK_OR,value:"||"})):n.push({start:i,type:mt.TOK_PIPE,value:"|"});else{const a=new Error(`Unknown character: ${e[this._current]}`);throw a.name="LexerError",a}return n}consumeUnquotedIdentifier(e){const n=this._current;for(this._current+=1;this._current<e.length&&mQe(e[this._current]);)this._current+=1;return e.slice(n,this._current)}consumeQuotedIdentifier(e){const n=this._current;this._current+=1;const i=e.length;for(;e[this._current]!=='"'&&this._current<i;){let r=this._current;e[r]==="\\"&&(e[r+1]==="\\"||e[r+1]==='"')?r+=2:r+=1,this._current=r}return this._current+=1,JSON.parse(e.slice(n,this._current))}consumeRawStringLiteral(e){const n=this._current;this._current+=1;const i=e.length;for(;e[this._current]!=="'"&&this._current<i;){let s=this._current;e[s]==="\\"&&(e[s+1]==="\\"||e[s+1]==="'")?s+=2:s+=1,this._current=s}return this._current+=1,e.slice(n+1,this._current-1).replace("\\'","'")}consumeNumber(e){const n=this._current;this._current+=1;const i=e.length;for(;vre(e[this._current])&&this._current<i;)this._current+=1;const r=parseInt(e.slice(n,this._current),10);return{start:n,value:r,type:mt.TOK_NUMBER}}consumeLBracket(e){const n=this._current;return this._current+=1,e[this._current]==="?"?(this._current+=1,{start:n,type:mt.TOK_FILTER,value:"[?"}):e[this._current]==="]"?(this._current+=1,{start:n,type:mt.TOK_FLATTEN,value:"[]"}):{start:n,type:mt.TOK_LBRACKET,value:"["}}consumeOperator(e){const n=this._current,i=e[n];if(this._current+=1,i==="!")return e[this._current]==="="?(this._current+=1,{start:n,type:mt.TOK_NE,value:"!="}):{start:n,type:mt.TOK_NOT,value:"!"};if(i==="<")return e[this._current]==="="?(this._current+=1,{start:n,type:mt.TOK_LTE,value:"<="}):{start:n,type:mt.TOK_LT,value:"<"};if(i===">")return e[this._current]==="="?(this._current+=1,{start:n,type:mt.TOK_GTE,value:">="}):{start:n,type:mt.TOK_GT,value:">"};if(i==="="&&e[this._current]==="=")return this._current+=1,{start:n,type:mt.TOK_EQ,value:"=="}}consumeLiteral(e){this._current+=1;const n=this._current,i=e.length;for(;e[this._current]!=="`"&&this._current<i;){let a=this._current;e[a]==="\\"&&(e[a+1]==="\\"||e[a+1]==="`")?a+=2:a+=1,this._current=a}let r=e.slice(n,this._current).trimLeft();r=r.replace("\\`","`");const s=this.looksLikeJSON(r)?JSON.parse(r):JSON.parse(`"${r}"`);return this._current+=1,s}looksLikeJSON(e){const n='[{"',i=["true","false","null"],r="-0123456789";if(e==="")return!1;if(n.includes(e[0])||i.includes(e))return!0;if(r.includes(e[0]))try{return JSON.parse(e),!0}catch{return!1}return!1}}const yQe=new _Qe,hu={[mt.TOK_EOF]:0,[mt.TOK_UNQUOTEDIDENTIFIER]:0,[mt.TOK_QUOTEDIDENTIFIER]:0,[mt.TOK_RBRACKET]:0,[mt.TOK_RPAREN]:0,[mt.TOK_COMMA]:0,[mt.TOK_RBRACE]:0,[mt.TOK_NUMBER]:0,[mt.TOK_CURRENT]:0,[mt.TOK_EXPREF]:0,[mt.TOK_ROOT]:0,[mt.TOK_PIPE]:1,[mt.TOK_OR]:2,[mt.TOK_AND]:3,[mt.TOK_EQ]:5,[mt.TOK_GT]:5,[mt.TOK_LT]:5,[mt.TOK_GTE]:5,[mt.TOK_LTE]:5,[mt.TOK_NE]:5,[mt.TOK_FLATTEN]:9,[mt.TOK_STAR]:20,[mt.TOK_FILTER]:21,[mt.TOK_DOT]:40,[mt.TOK_NOT]:45,[mt.TOK_LBRACE]:50,[mt.TOK_LBRACKET]:55,[mt.TOK_LPAREN]:60};class bQe{constructor(){this.index=0,this.tokens=[]}parse(e){this.loadTokens(e),this.index=0;const n=this.expression(0);if(this.lookahead(0)!==mt.TOK_EOF){const i=this.lookaheadToken(0);this.errorToken(i,`Unexpected token type: ${i.type}, value: ${i.value}`)}return n}loadTokens(e){this.tokens=[...yQe.tokenize(e),{type:mt.TOK_EOF,value:"",start:e.length}]}expression(e){const n=this.lookaheadToken(0);this.advance();let i=this.nud(n),r=this.lookahead(0);for(;e<hu[r];)this.advance(),i=this.led(r,i),r=this.lookahead(0);return i}lookahead(e){return this.tokens[this.index+e].type}lookaheadToken(e){return this.tokens[this.index+e]}advance(){this.index+=1}nud(e){let n,i,r;switch(e.type){case mt.TOK_LITERAL:return{type:"Literal",value:e.value};case mt.TOK_UNQUOTEDIDENTIFIER:return{type:"Field",name:e.value};case mt.TOK_QUOTEDIDENTIFIER:const s={type:"Field",name:e.value};if(this.lookahead(0)===mt.TOK_LPAREN)throw new Error("Quoted identifier not allowed for function names.");return s;case mt.TOK_NOT:return i=this.expression(hu.Not),{type:"NotExpression",children:[i]};case mt.TOK_STAR:return n={type:"Identity"},i=this.lookahead(0)===mt.TOK_RBRACKET&&{type:"Identity"}||this.parseProjectionRHS(hu.Star),{type:"ValueProjection",children:[n,i]};case mt.TOK_FILTER:return this.led(e.type,{type:"Identity"});case mt.TOK_LBRACE:return this.parseMultiselectHash();case mt.TOK_FLATTEN:return n={type:mt.TOK_FLATTEN,children:[{type:"Identity"}]},i=this.parseProjectionRHS(hu.Flatten),{type:"Projection",children:[n,i]};case mt.TOK_LBRACKET:return this.lookahead(0)===mt.TOK_NUMBER||this.lookahead(0)===mt.TOK_COLON?(i=this.parseIndexExpression(),this.projectIfSlice({type:"Identity"},i)):this.lookahead(0)===mt.TOK_STAR&&this.lookahead(1)===mt.TOK_RBRACKET?(this.advance(),this.advance(),i=this.parseProjectionRHS(hu.Star),{children:[{type:"Identity"},i],type:"Projection"}):this.parseMultiselectList();case mt.TOK_CURRENT:return{type:mt.TOK_CURRENT};case mt.TOK_ROOT:return{type:mt.TOK_ROOT};case mt.TOK_EXPREF:return r=this.expression(hu.Expref),{type:"ExpressionReference",children:[r]};case mt.TOK_LPAREN:const a=[];for(;this.lookahead(0)!==mt.TOK_RPAREN;)this.lookahead(0)===mt.TOK_CURRENT?(r={type:mt.TOK_CURRENT},this.advance()):r=this.expression(0),a.push(r);return this.match(mt.TOK_RPAREN),a[0];default:this.errorToken(e)}}led(e,n){let i;switch(e){case mt.TOK_DOT:const r=hu.Dot;return this.lookahead(0)!==mt.TOK_STAR?(i=this.parseDotRHS(r),{type:"Subexpression",children:[n,i]}):(this.advance(),i=this.parseProjectionRHS(r),{type:"ValueProjection",children:[n,i]});case mt.TOK_PIPE:return i=this.expression(hu.Pipe),{type:mt.TOK_PIPE,children:[n,i]};case mt.TOK_OR:return i=this.expression(hu.Or),{type:"OrExpression",children:[n,i]};case mt.TOK_AND:return i=this.expression(hu.And),{type:"AndExpression",children:[n,i]};case mt.TOK_LPAREN:const s=n.name,a=[];let o;for(;this.lookahead(0)!==mt.TOK_RPAREN;)this.lookahead(0)===mt.TOK_CURRENT?(o={type:mt.TOK_CURRENT},this.advance()):o=this.expression(0),this.lookahead(0)===mt.TOK_COMMA&&this.match(mt.TOK_COMMA),a.push(o);return this.match(mt.TOK_RPAREN),{name:s,type:"Function",children:a};case mt.TOK_FILTER:const l=this.expression(0);return this.match(mt.TOK_RBRACKET),i=this.lookahead(0)===mt.TOK_FLATTEN&&{type:"Identity"}||this.parseProjectionRHS(hu.Filter),{type:"FilterProjection",children:[n,i,l]};case mt.TOK_FLATTEN:const u={type:mt.TOK_FLATTEN,children:[n]},h=this.parseProjectionRHS(hu.Flatten);return{type:"Projection",children:[u,h]};case mt.TOK_EQ:case mt.TOK_NE:case mt.TOK_GT:case mt.TOK_GTE:case mt.TOK_LT:case mt.TOK_LTE:return this.parseComparator(n,e);case mt.TOK_LBRACKET:const d=this.lookaheadToken(0);return d.type===mt.TOK_NUMBER||d.type===mt.TOK_COLON?(i=this.parseIndexExpression(),this.projectIfSlice(n,i)):(this.match(mt.TOK_STAR),this.match(mt.TOK_RBRACKET),i=this.parseProjectionRHS(hu.Star),{type:"Projection",children:[n,i]});default:return this.errorToken(this.lookaheadToken(0))}}match(e){if(this.lookahead(0)===e){this.advance();return}else{const n=this.lookaheadToken(0);this.errorToken(n,`Expected ${e}, got: ${n.type}`)}}errorToken(e,n=""){const i=new Error(n||`Invalid token (${e.type}): "${e.value}"`);throw i.name="ParserError",i}parseIndexExpression(){if(this.lookahead(0)===mt.TOK_COLON||this.lookahead(1)===mt.TOK_COLON)return this.parseSliceExpression();const e={type:"Index",value:this.lookaheadToken(0).value};return this.advance(),this.match(mt.TOK_RBRACKET),e}projectIfSlice(e,n){const i={type:"IndexExpression",children:[e,n]};return n.type==="Slice"?{children:[i,this.parseProjectionRHS(hu.Star)],type:"Projection"}:i}parseSliceExpression(){const e=[null,null,null];let n=0,i=this.lookahead(0);for(;i!==mt.TOK_RBRACKET&&n<3;){if(i===mt.TOK_COLON)n+=1,this.advance();else if(i===mt.TOK_NUMBER)e[n]=this.lookaheadToken(0).value,this.advance();else{const r=this.lookaheadToken(0);this.errorToken(r,`Syntax error, unexpected token: ${r.value}(${r.type})`)}i=this.lookahead(0)}return this.match(mt.TOK_RBRACKET),{children:e,type:"Slice"}}parseComparator(e,n){const i=this.expression(hu[n]);return{type:"Comparator",name:n,children:[e,i]}}parseDotRHS(e){const n=this.lookahead(0);if([mt.TOK_UNQUOTEDIDENTIFIER,mt.TOK_QUOTEDIDENTIFIER,mt.TOK_STAR].includes(n))return this.expression(e);if(n===mt.TOK_LBRACKET)return this.match(mt.TOK_LBRACKET),this.parseMultiselectList();if(n===mt.TOK_LBRACE)return this.match(mt.TOK_LBRACE),this.parseMultiselectHash();const r=this.lookaheadToken(0);this.errorToken(r,`Syntax error, unexpected token: ${r.value}(${r.type})`)}parseProjectionRHS(e){if(hu[this.lookahead(0)]<10)return{type:"Identity"};if(this.lookahead(0)===mt.TOK_LBRACKET)return this.expression(e);if(this.lookahead(0)===mt.TOK_FILTER)return this.expression(e);if(this.lookahead(0)===mt.TOK_DOT)return this.match(mt.TOK_DOT),this.parseDotRHS(e);const n=this.lookaheadToken(0);this.errorToken(n,`Syntax error, unexpected token: ${n.value}(${n.type})`)}parseMultiselectList(){const e=[];for(;this.lookahead(0)!==mt.TOK_RBRACKET;){const n=this.expression(0);if(e.push(n),this.lookahead(0)===mt.TOK_COMMA&&(this.match(mt.TOK_COMMA),this.lookahead(0)===mt.TOK_RBRACKET))throw new Error("Unexpected token Rbracket")}return this.match(mt.TOK_RBRACKET),{type:"MultiSelectList",children:e}}parseMultiselectHash(){const e=[],n=[mt.TOK_UNQUOTEDIDENTIFIER,mt.TOK_QUOTEDIDENTIFIER];let i,r,s;for(;;){if(i=this.lookaheadToken(0),!n.includes(i.type))throw new Error(`Expecting an identifier token, got: ${i.type}`);if(r=i.value,this.advance(),this.match(mt.TOK_COLON),s=this.expression(0),e.push({value:s,type:"KeyValuePair",name:r}),this.lookahead(0)===mt.TOK_COMMA)this.match(mt.TOK_COMMA);else if(this.lookahead(0)===mt.TOK_RBRACE){this.match(mt.TOK_RBRACE);break}}return{type:"MultiSelectHash",children:e}}}const EQe=new bQe;var Wt;(function(t){t[t.TYPE_NUMBER=0]="TYPE_NUMBER",t[t.TYPE_ANY=1]="TYPE_ANY",t[t.TYPE_STRING=2]="TYPE_STRING",t[t.TYPE_ARRAY=3]="TYPE_ARRAY",t[t.TYPE_OBJECT=4]="TYPE_OBJECT",t[t.TYPE_BOOLEAN=5]="TYPE_BOOLEAN",t[t.TYPE_EXPREF=6]="TYPE_EXPREF",t[t.TYPE_NULL=7]="TYPE_NULL",t[t.TYPE_ARRAY_NUMBER=8]="TYPE_ARRAY_NUMBER",t[t.TYPE_ARRAY_STRING=9]="TYPE_ARRAY_STRING"})(Wt||(Wt={}));class SQe{constructor(e){this.TYPE_NAME_TABLE={[Wt.TYPE_NUMBER]:"number",[Wt.TYPE_ANY]:"any",[Wt.TYPE_STRING]:"string",[Wt.TYPE_ARRAY]:"array",[Wt.TYPE_OBJECT]:"object",[Wt.TYPE_BOOLEAN]:"boolean",[Wt.TYPE_EXPREF]:"expression",[Wt.TYPE_NULL]:"null",[Wt.TYPE_ARRAY_NUMBER]:"Array<number>",[Wt.TYPE_ARRAY_STRING]:"Array<string>"},this.functionAbs=([n])=>Math.abs(n),this.functionAvg=([n])=>{let i=0;for(let r=0;r<n.length;r+=1)i+=n[r];return i/n.length},this.functionCeil=([n])=>Math.ceil(n),this.functionContains=n=>{const[i,r]=n;return i.includes(r)},this.functionEndsWith=n=>{const[i,r]=n;return i.includes(r,i.length-r.length)},this.functionFloor=([n])=>Math.floor(n),this.functionJoin=n=>{const[i,r]=n;return r.join(i)},this.functionKeys=([n])=>Object.keys(n),this.functionLength=([n])=>xA(n)?Object.keys(n).length:n.length,this.functionMap=n=>{if(!this._interpreter)return[];const i=[],r=this._interpreter,s=n[0],a=n[1];for(let o=0;o<a.length;o+=1)i.push(r.visit(s,a[o]));return i},this.functionMax=([n])=>{if(!n.length)return null;if(this.getTypeName(n[0])===Wt.TYPE_NUMBER)return Math.max(...n);const r=n;let s=r[0];for(let a=1;a<r.length;a+=1)s.localeCompare(r[a])<0&&(s=r[a]);return s},this.functionMaxBy=n=>{const i=n[1],r=n[0],s=this.createKeyFunction(i,[Wt.TYPE_NUMBER,Wt.TYPE_STRING]);let a=-1/0,o,c;for(let l=0;l<r.length;l+=1)c=s&&s(r[l]),c!==void 0&&c>a&&(a=c,o=r[l]);return o},this.functionMerge=n=>{let i={};for(let r=0;r<n.length;r+=1){const s=n[r];i=Object.assign(i,s)}return i},this.functionMin=([n])=>{if(!n.length)return null;if(this.getTypeName(n[0])===Wt.TYPE_NUMBER)return Math.min(...n);const r=n;let s=r[0];for(let a=1;a<r.length;a+=1)r[a].localeCompare(s)<0&&(s=r[a]);return s},this.functionMinBy=n=>{const i=n[1],r=n[0],s=this.createKeyFunction(i,[Wt.TYPE_NUMBER,Wt.TYPE_STRING]);let a=1/0,o,c;for(let l=0;l<r.length;l+=1)c=s&&s(r[l]),c!==void 0&&c<a&&(a=c,o=r[l]);return o},this.functionNotNull=n=>{for(let i=0;i<n.length;i+=1)if(this.getTypeName(n[i])!==Wt.TYPE_NULL)return n[i];return null},this.functionReverse=([n])=>{if(this.getTypeName(n)===Wt.TYPE_STRING){const s=n;let a="";for(let o=s.length-1;o>=0;o-=1)a+=s[o];return a}const r=n.slice(0);return r.reverse(),r},this.functionSort=([n])=>[...n].sort(),this.functionSortBy=n=>{if(!this._interpreter)return[];const i=n[0].slice(0);if(i.length===0)return i;const r=this._interpreter,s=n[1],a=this.getTypeName(r.visit(s,i[0]));if(a!==void 0&&![Wt.TYPE_NUMBER,Wt.TYPE_STRING].includes(a))throw new Error(`TypeError: unexpected type (${this.TYPE_NAME_TABLE[a]})`);const o=[];for(let c=0;c<i.length;c+=1)o.push([c,i[c]]);o.sort((c,l)=>{const u=r.visit(s,c[1]),h=r.visit(s,l[1]);if(this.getTypeName(u)!==a)throw new Error(`TypeError: expected (${this.TYPE_NAME_TABLE[a]}), received ${this.TYPE_NAME_TABLE[this.getTypeName(u)]}`);if(this.getTypeName(h)!==a)throw new Error(`TypeError: expected (${this.TYPE_NAME_TABLE[a]}), received ${this.TYPE_NAME_TABLE[this.getTypeName(h)]}`);return u>h?1:u<h?-1:c[0]-l[0]});for(let c=0;c<o.length;c+=1)i[c]=o[c][1];return i},this.functionStartsWith=([n,i])=>n.startsWith(i),this.functionSum=([n])=>n.reduce((i,r)=>i+r,0),this.functionToArray=([n])=>this.getTypeName(n)===Wt.TYPE_ARRAY?n:[n],this.functionToNumber=([n])=>{const i=this.getTypeName(n);let r;return i===Wt.TYPE_NUMBER?n:i===Wt.TYPE_STRING&&(r=+n,!isNaN(r))?r:null},this.functionToString=([n])=>this.getTypeName(n)===Wt.TYPE_STRING?n:JSON.stringify(n),this.functionType=([n])=>{switch(this.getTypeName(n)){case Wt.TYPE_NUMBER:return"number";case Wt.TYPE_STRING:return"string";case Wt.TYPE_ARRAY:return"array";case Wt.TYPE_OBJECT:return"object";case Wt.TYPE_BOOLEAN:return"boolean";case Wt.TYPE_EXPREF:return"expref";case Wt.TYPE_NULL:return"null";default:return}},this.functionValues=([n])=>Object.values(n),this.functionTable={abs:{_func:this.functionAbs,_signature:[{types:[Wt.TYPE_NUMBER]}]},avg:{_func:this.functionAvg,_signature:[{types:[Wt.TYPE_ARRAY_NUMBER]}]},ceil:{_func:this.functionCeil,_signature:[{types:[Wt.TYPE_NUMBER]}]},contains:{_func:this.functionContains,_signature:[{types:[Wt.TYPE_STRING,Wt.TYPE_ARRAY]},{types:[Wt.TYPE_ANY]}]},ends_with:{_func:this.functionEndsWith,_signature:[{types:[Wt.TYPE_STRING]},{types:[Wt.TYPE_STRING]}]},floor:{_func:this.functionFloor,_signature:[{types:[Wt.TYPE_NUMBER]}]},join:{_func:this.functionJoin,_signature:[{types:[Wt.TYPE_STRING]},{types:[Wt.TYPE_ARRAY_STRING]}]},keys:{_func:this.functionKeys,_signature:[{types:[Wt.TYPE_OBJECT]}]},length:{_func:this.functionLength,_signature:[{types:[Wt.TYPE_STRING,Wt.TYPE_ARRAY,Wt.TYPE_OBJECT]}]},map:{_func:this.functionMap,_signature:[{types:[Wt.TYPE_EXPREF]},{types:[Wt.TYPE_ARRAY]}]},max:{_func:this.functionMax,_signature:[{types:[Wt.TYPE_ARRAY_NUMBER,Wt.TYPE_ARRAY_STRING]}]},max_by:{_func:this.functionMaxBy,_signature:[{types:[Wt.TYPE_ARRAY]},{types:[Wt.TYPE_EXPREF]}]},merge:{_func:this.functionMerge,_signature:[{types:[Wt.TYPE_OBJECT],variadic:!0}]},min:{_func:this.functionMin,_signature:[{types:[Wt.TYPE_ARRAY_NUMBER,Wt.TYPE_ARRAY_STRING]}]},min_by:{_func:this.functionMinBy,_signature:[{types:[Wt.TYPE_ARRAY]},{types:[Wt.TYPE_EXPREF]}]},not_null:{_func:this.functionNotNull,_signature:[{types:[Wt.TYPE_ANY],variadic:!0}]},reverse:{_func:this.functionReverse,_signature:[{types:[Wt.TYPE_STRING,Wt.TYPE_ARRAY]}]},sort:{_func:this.functionSort,_signature:[{types:[Wt.TYPE_ARRAY_STRING,Wt.TYPE_ARRAY_NUMBER]}]},sort_by:{_func:this.functionSortBy,_signature:[{types:[Wt.TYPE_ARRAY]},{types:[Wt.TYPE_EXPREF]}]},starts_with:{_func:this.functionStartsWith,_signature:[{types:[Wt.TYPE_STRING]},{types:[Wt.TYPE_STRING]}]},sum:{_func:this.functionSum,_signature:[{types:[Wt.TYPE_ARRAY_NUMBER]}]},to_array:{_func:this.functionToArray,_signature:[{types:[Wt.TYPE_ANY]}]},to_number:{_func:this.functionToNumber,_signature:[{types:[Wt.TYPE_ANY]}]},to_string:{_func:this.functionToString,_signature:[{types:[Wt.TYPE_ANY]}]},type:{_func:this.functionType,_signature:[{types:[Wt.TYPE_ANY]}]},values:{_func:this.functionValues,_signature:[{types:[Wt.TYPE_OBJECT]}]}},this._interpreter=e}registerFunction(e,n,i){if(e in this.functionTable)throw new Error(`Function already defined: ${e}()`);this.functionTable[e]={_func:n.bind(this),_signature:i}}callFunction(e,n){const i=this.functionTable[e];if(i===void 0)throw new Error(`Unknown function: ${e}()`);return this.validateArgs(e,n,i._signature),i._func.call(this,n)}validateInputSignatures(e,n){for(let i=0;i<n.length;i+=1)if("variadic"in n[i]&&i!==n.length-1)throw new Error(`ArgumentError: ${e}() 'variadic' argument ${i+1} must occur last`)}validateArgs(e,n,i){var r,s;let a;this.validateInputSignatures(e,i);const o=i.filter(g=>{var _;return(_=!g.optional)!==null&&_!==void 0?_:!1}).length,c=(s=(r=i[i.length-1])===null||r===void 0?void 0:r.variadic)!==null&&s!==void 0?s:!1,l=n.length<o,u=n.length>i.length,h=l&&(!c&&o>1||c)?"at least ":"";if(c&&l||!c&&(l||u))throw a=i.length>1,new Error(`ArgumentError: ${e}() takes ${h}${o} argument${a&&"s"||""} but received ${n.length}`);let d,f,p;for(let g=0;g<i.length;g+=1){p=!1,d=i[g].types,f=this.getTypeName(n[g]);let _;for(_=0;_<d.length;_+=1)if(f!==void 0&&this.typeMatches(f,d[_],n[g])){p=!0;break}if(!p&&f!==void 0){const v=d.map(b=>this.TYPE_NAME_TABLE[b]).join(" | ");throw new Error(`TypeError: ${e}() expected argument ${g+1} to be type (${v}) but received type ${this.TYPE_NAME_TABLE[f]} instead.`)}}}typeMatches(e,n,i){if(n===Wt.TYPE_ANY)return!0;if(n===Wt.TYPE_ARRAY_STRING||n===Wt.TYPE_ARRAY_NUMBER||n===Wt.TYPE_ARRAY){if(n===Wt.TYPE_ARRAY)return e===Wt.TYPE_ARRAY;if(e===Wt.TYPE_ARRAY){let r;n===Wt.TYPE_ARRAY_NUMBER?r=Wt.TYPE_NUMBER:n===Wt.TYPE_ARRAY_STRING&&(r=Wt.TYPE_STRING);for(let s=0;s<i.length;s+=1){const a=this.getTypeName(i[s]);if(a!==void 0&&r!==void 0&&!this.typeMatches(a,r,i[s]))return!1}return!0}}else return e===n;return!1}getTypeName(e){switch(Object.prototype.toString.call(e)){case"[object String]":return Wt.TYPE_STRING;case"[object Number]":return Wt.TYPE_NUMBER;case"[object Array]":return Wt.TYPE_ARRAY;case"[object Boolean]":return Wt.TYPE_BOOLEAN;case"[object Null]":return Wt.TYPE_NULL;case"[object Object]":return e.jmespathType===mt.TOK_EXPREF?Wt.TYPE_EXPREF:Wt.TYPE_OBJECT;default:return}}createKeyFunction(e,n){if(!this._interpreter)return;const i=this._interpreter;return s=>{const a=i.visit(e,s);if(!n.includes(this.getTypeName(a))){const o=`TypeError: expected one of (${n.map(c=>this.TYPE_NAME_TABLE[c]).join(" | ")}), received ${this.TYPE_NAME_TABLE[this.getTypeName(a)]}`;throw new Error(o)}return a}}}class TQe{constructor(){this._rootValue=null,this.runtime=new SQe(this)}search(e,n){return this._rootValue=n,this.visit(e,n)}visit(e,n){let i,r,s,a,o,c,l,u,h,d,f;switch(e.type){case"Field":return n===null?null:xA(n)?(c=n[e.name],c===void 0?null:c):null;case"Subexpression":for(s=this.visit(e.children[0],n),d=1;d<e.children.length;d+=1)if(s=this.visit(e.children[1],s),s===null)return null;return s;case"IndexExpression":return l=this.visit(e.children[0],n),u=this.visit(e.children[1],l),u;case"Index":if(!Array.isArray(n))return null;let p=e.value;return p<0&&(p=n.length+p),s=n[p],s===void 0&&(s=null),s;case"Slice":if(!Array.isArray(n))return null;const g=[...e.children],_=this.computeSliceParams(n.length,g),[v,b,S]=_;if(s=[],S>0)for(d=v;d<b;d+=S)s.push(n[d]);else for(d=v;d>b;d+=S)s.push(n[d]);return s;case"Projection":if(f=this.visit(e.children[0],n),!Array.isArray(f))return null;for(h=[],d=0;d<f.length;d+=1)r=this.visit(e.children[1],f[d]),r!==null&&h.push(r);return h;case"ValueProjection":if(f=this.visit(e.children[0],n),!xA(f))return null;h=[];const x=Object.values(f);for(d=0;d<x.length;d+=1)r=this.visit(e.children[1],x[d]),r!==null&&h.push(r);return h;case"FilterProjection":if(f=this.visit(e.children[0],n),!Array.isArray(f))return null;const M=[],R=[];for(d=0;d<f.length;d+=1)i=this.visit(e.children[2],f[d]),i2(i)||M.push(f[d]);for(let $=0;$<M.length;$+=1)r=this.visit(e.children[1],M[$]),r!==null&&R.push(r);return R;case"Comparator":switch(a=this.visit(e.children[0],n),o=this.visit(e.children[1],n),e.name){case mt.TOK_EQ:s=Q3(a,o);break;case mt.TOK_NE:s=!Q3(a,o);break;case mt.TOK_GT:s=a>o;break;case mt.TOK_GTE:s=a>=o;break;case mt.TOK_LT:s=a<o;break;case mt.TOK_LTE:s=a<=o;break;default:throw new Error(`Unknown comparator: ${e.name}`)}return s;case mt.TOK_FLATTEN:const I=this.visit(e.children[0],n);if(!Array.isArray(I))return null;let k=[];for(d=0;d<I.length;d+=1)r=I[d],Array.isArray(r)?k=[...k,...r]:k.push(r);return k;case"Identity":return n;case"MultiSelectList":if(n===null)return null;for(h=[],d=0;d<e.children.length;d+=1)h.push(this.visit(e.children[d],n));return h;case"MultiSelectHash":if(n===null)return null;h={};let P;for(d=0;d<e.children.length;d+=1)P=e.children[d],h[P.name]=this.visit(P.value,n);return h;case"OrExpression":return i=this.visit(e.children[0],n),i2(i)&&(i=this.visit(e.children[1],n)),i;case"AndExpression":return a=this.visit(e.children[0],n),i2(a)?a:this.visit(e.children[1],n);case"NotExpression":return a=this.visit(e.children[0],n),i2(a);case"Literal":return e.value;case mt.TOK_PIPE:return l=this.visit(e.children[0],n),this.visit(e.children[1],l);case mt.TOK_CURRENT:return n;case mt.TOK_ROOT:return this._rootValue;case"Function":const U=[];for(let $=0;$<e.children.length;$+=1)U.push(this.visit(e.children[$],n));return this.runtime.callFunction(e.name,U);case"ExpressionReference":const V=e.children[0];return V.jmespathType=mt.TOK_EXPREF,V;default:throw new Error(`Unknown node type: ${e.type}`)}}computeSliceParams(e,n){let[i,r,s]=n;if(s===null)s=1;else if(s===0){const o=new Error("Invalid slice, step cannot be 0");throw o.name="RuntimeError",o}const a=s<0;return i=i===null?a?e-1:0:this.capSliceRange(e,i,s),r=r===null?a?-1:e:this.capSliceRange(e,r,s),[i,r,s]}capSliceRange(e,n,i){let r=n;return r<0?(r+=e,r<0&&(r=i<0?-1:0)):r>=e&&(r=i<0?e-1:e),r}}const xQe=new TQe;Wt.TYPE_ANY;Wt.TYPE_ARRAY;Wt.TYPE_ARRAY_NUMBER;Wt.TYPE_ARRAY_STRING;Wt.TYPE_BOOLEAN;Wt.TYPE_EXPREF;Wt.TYPE_NULL;Wt.TYPE_NUMBER;Wt.TYPE_OBJECT;Wt.TYPE_STRING;function wQe(t,e){const n=EQe.parse(e);return xQe.search(n,t)}const CQe=(t,e)=>{const n=Mb(t.id());if(!re(n))return 0;const[i,r]=Rt(e,0,[Ke.NAME,Ke.NAME]),s=wQe(n.json,i);return t.set(r,s),0};function AQe(t,e){return Math.sqrt(Math.pow(t.r-e.r,2)+Math.pow(t.g-e.g,2)+Math.pow(t.b-e.b,2))}const r2=PE(G1);function yre(t){let e;if(!re(r2))return e;let n=1e9;for(let i=0;i<=qt.BLACK;++i){const r=i*l1,s=r2.bits[r],a=r2.bits[r+1],o=r2.bits[r+2],c=AQe(t,{r:s,g:a,b:o,hex:""});c<n&&(e=i,n=c)}return e}const RQe=(t,e)=>{var o,c,l,u;const n=Mb(t.id());if(!re(n))return 0;const[i,r]=Rt(e,0,[Ke.NAME]),s=Wn(i),a=((o=n.content)==null?void 0:o.layers)??[];switch(s){case"seek":{const[h]=Rt(e,r,[Ke.NUMBER]);n.cursor=er(h,0,a.length-1);break}case"layer":{const h=n.cursor+1;n.cursor=er(h,0,a.length-1);break}case"char":{const[h,d,f]=Rt(e,r,[Ke.NUMBER,Ke.NUMBER,Ke.NAME]),p=(c=n.content)==null?void 0:c.layers[n.cursor];re(p)&&hm(h,d,0,p.width-1,p.height-1,0)&&t.set(f,p.raster[h+d*p.width].asciiCode);break}case"color":{const[h,d,f]=Rt(e,r,[Ke.NUMBER,Ke.NUMBER,Ke.NAME]),p=(l=n.content)==null?void 0:l.layers[n.cursor];re(p)&&hm(h,d,0,p.width-1,p.height-1,0)&&t.set(f,yre(p.raster[h+d*p.width].color));break}case"bg":{const[h,d,f]=Rt(e,r,[Ke.NUMBER,Ke.NUMBER,Ke.NAME]),p=(u=n.content)==null?void 0:u.layers[n.cursor];re(p)&&hm(h,d,0,p.width-1,p.height-1,0)&&t.set(f,yre(p.raster[h+d*p.width].bg));break}}return 0},MQe=(t,e)=>{const n=Mb(t.id());if(!re(n))return 0;const[i,r]=Rt(e,0,[Ke.NAME]);switch(Wn(i)){case"seek":{const[a]=Rt(e,r,[Ke.NUMBER]);n.cursor=er(a,0,n.lines.length-1);break}case"line":n.cursor=er(n.cursor+1,0,n.lines.length-1);break;default:{const a=n.lines[n.cursor]??"",c=new RegExp(i,"i").exec(a)??[];let l=1;for(let u=r;u<e.length;){const[h,d]=Rt(e,u,[Ke.NAME]);t.set(h,c[l]??0),++l,u=d}break}}return 0},OQe=q_({get(t,e){var i,r,s;const n=dQe(t.id());if(e==="format")return[!0,n];switch(n){case"text":{const a=Mb(t.id());switch(e){case"filename":return[!0,a.filename];case"cursor":return[!0,a.cursor];case"lines":return[!0,a.lines.length]}break}case"json":{const a=Mb(t.id());switch(e){case"filename":return[!0,a.filename]}break}case"binary":{const a=Mb(t.id());switch(e){case"filename":return[!0,a.filename];case"cursor":return[!0,a.cursor];case"bytes":return[!0,a.bytes.length]}break}case"rexpaint":{const a=Mb(t.id());switch(e){case"filename":return[!0,a.filename];case"layers":return[!0,((i=a.content)==null?void 0:i.layers.length)??0];case"width":return[!0,((r=a.content)==null?void 0:r.layers[a.cursor].width)??0];case"height":return[!0,((s=a.content)==null?void 0:s.layers[a.cursor].height)??0];case"cursor":return[!0,a.cursor]}break}}return[!1,void 0]}}).command("send",(t,e)=>{const[n,i]=Rt(e,0,[Ke.NAME,Ke.ANY]);return v_e(n,i),0}).command("stat",()=>0).command("text",(t,e)=>{const n=e.map(ca).join(" ");return xr(Ye,ie.elementfocus,"$175",n),0}).command("hyperlink",(t,e)=>{const[n,...i]=e,r=ca(n),s=i.map(ca).join(" ");return xr(Ye,ie.elementfocus,"$175",`!${s};${r}`),0}).command("readline",MQe).command("readjson",CQe).command("readbin",fQe).command("readrexpaint",RQe).command("with",(t,e)=>{const[n]=Rt(e,0,[Ke.NAME]),i=fp(ie.book,Xn.BOARD,n);if(i.length){const r=io(...i);re(r)&&(ie.board=Qc(r),ie.element={x:-1,y:-1})}return 0});function bre(t,e,n,i,r,s){const a=[];for(let o=s;o<r.length;){const[c,l]=Rt(r,o,[Ke.ANY]);ji(c)&&!P_(c)&&!eI(c)&&!J3(c)&&!d0(c)?a.push(...c):a.push(c),o=l}switch(Wn(i)){case"get":case"post:json":E4e(Ye,ie.elementfocus,t,e,n,i,a);break}return 0}const NQe=q_().command("fetch",(t,e)=>{const[n,i,r="get",s]=Rt(e,0,[Ke.NAME,Ke.NAME,Ke.MAYBE_STRING]);return bre(void 0,n,i,r,e,s),0}).command("fetchwith",(t,e)=>{const[n,i,r,s="get",a]=Rt(e,0,[Ke.ANY,Ke.NAME,Ke.NAME,Ke.MAYBE_STRING]);return bre(n,i,r,s,e,a),0}).command("chat",(t,e)=>{const[n]=Rt(e,0,[Ke.MAYBE_NAME]);return n?y4e(Ye,ie.elementfocus,n):b4e(Ye,ie.elementfocus),0}).command("broadcast",(t,e)=>{const[n]=Rt(e,0,[Ke.MAYBE_NAME]);return n?v4e(Ye,ie.elementfocus,n):_4e(Ye,ie.elementfocus),0}),fL={},Ow={};function IQe(){return{id:wo(),layers:[],scroll:[],sidebar:[]}}const kQe=new Set(["rn","range","sl","select","nm","number","tx","text","zssedit","charedit","coloredit"]),PQe=new Set(["tx","text"]),DQe={rn:1,range:1,sl:0,select:0,nm:0,number:0,tx:"",text:"",zssedit:"",charedit:"",coloredit:""},Ere={};let LQe=t=>{let e=Ere[t];return re(e)||(Ere[t]=e=IQe()),e};function AH(t){return LQe(t)}function CK(t){return re(fL[t])||(fL[t]=[]),fL[t]}function UQe(t,e,n){Object.values(Ow).forEach(i=>{if(i[e]!==void 0){const r=kE(t.id(),e);an(n)&&Tl(r,n),Tn(n)&&rKe(r,n)}})}function BQe(t){const e=CK(t);return fL[t]=[],e}function FQe(t,e){CK(t).push(e)}function zQe(t,e,n,i,r=()=>0,s=ih){const a=[e,n,...i],o=Wn(`${a[3]}`),c={...ie};function l(u,h){re(h)&&h!==r(u)&&(ie.board=c.board,ie.element=c.element,ie.elementfocus=c.elementfocus,s(u,h))}if(kQe.has(o)){const u=`${a[2]}`;Ow[e]=Ow[e]??{};const h=r(u)??DQe[o];if(Ow[e][u]===void 0){const d=kE(e,u);an(h)&&iKe(d,h),Tn(h)&&Uve(d,h),PQe.has(o)?Ow[e][u]=aKe(d,f=>{l(u,f)}):Ow[e][u]=sKe(d,f=>{l(u,f)})}}CK(t).push(a)}const jQe=q_({set(t,e,n){return UQe(t,e,n),[!1,void 0]},everytick(){const t=BQe(ie.elementid),[e]=t;if(t.length===1&&Tn(e)){if(re(ie.element))if(e.trim().length===0){const n=AH(ie.elementid);n.sidebar=[]}else ie.element.tickertext=e,ie.element.tickertime=ie.timestamp}else if(t.length>1)if(ie.elementisplayer){const n=AH(ie.elementid);n.sidebar=t}else{const n=AH(ie.elementfocus);n.scroll=t}}}).command("send",(t,e)=>{var o,c;const[n,i]=Rt(e,0,[Ke.NAME,Ke.ANY]),[r,s]=wK(n);switch(Wn(r)){case"all":for(const l of Object.keys(((o=ie.board)==null?void 0:o.objects)??{}))t.send(ie.elementfocus,l,s,i);break;case"self":t.message({session:Ye.session(),player:ie.elementfocus,id:wo(),sender:t.id(),target:s,data:i});break;case"others":for(const l of Object.keys(((c=ie.board)==null?void 0:c.objects)??{}))l!==t.id()&&t.send(ie.elementfocus,l,s,i);break;default:{const l=S0e(ie.board,[r]);for(let u=0;u<l.length;++u){const h=l[u];re(h.id)&&t.send(ie.elementfocus,h.id,s,i)}break}}return 0}).command("stat",()=>0).command("text",(t,e)=>{const n=e.map(ca).join("");return FQe(ie.elementid,n),0}).command("hyperlink",(t,e)=>{const[n,...i]=e,r=ca(n);return zQe(ie.elementid,t.id(),r,i,t.get,t.set),0});function Sre(t,e,n,i){for(let r=n.y;r<=i.y;++r)for(let s=n.x;s<=i.x;++s){const a=bc(e,{x:s,y:r});hh(a)&&e0(t,e,a,t.timestamp),af(e,{x:s,y:r})}}function HQe(t,e,n){for(let i=e.y;i<=n.y;++i)for(let r=e.x;r<=n.x;++r)af(t,{x:r,y:i})}function Tre(t,e,n,i){for(let r=n.y;r<=i.y;++r)for(let s=n.x;s<=i.x;++s){const a=bc(e,{x:s,y:r});hh(a)&&e0(t,e,a,t.timestamp),af(e,{x:s,y:r})}}function eB(t,e){re(t)&&(t.name=e.name,t.char=e.char,t.color=e.color,t.bg=e.bg,t.p1=e.p1,t.p2=e.p2,t.p3=e.p3,t.code=e.code,t.group=e.group,t.party=e.party,t.cycle=e.cycle,t.light=e.light,t.stepx=e.stepx,t.stepy=e.stepy,t.pushable=e.pushable,t.collision=e.collision,t.destructible=e.destructible,t.tickertext=e.tickertext,t.tickertime=e.tickertime)}function AK(t,e,n,i,r){if(!re(ie.book))return;const s=ie.book,a=vh(s,Xn.BOARD,t),o=Qc(a);if(!re(o))return;const c=vh(s,Xn.BOARD,e),l=Qc(c);if(!re(l))return;wl(s,o),wl(s,l);let u=!1;if(re(o)&&re(l)){switch(r){case"all":Sre(s,l,n,i);break;case"object":Tre(s,l,n,i);break;case"terrain":HQe(l,n,i);break;default:u=!0;break}for(let h=n.y;h<=i.y;++h)for(let d=n.x;d<=i.x;++d){let f=!1,p=!1;switch(r){case"all":f=!0,p=!0;break;case"object":f=!0;break;case"terrain":p=!0;break}const g={x:d,y:h};let _,v=bc(o,g);if(hh(v)?(_=mA(o,d,h),o1(v==null?void 0:v.id)&&(v=void 0)):(_=v,v=void 0),re(_)&&(p||u&&cE(s,_)===r)){u&&Sre(s,l,g,g);const b=lE(s,l,[_.kind??""],g);eB(b,_)}if(re(v)&&(f||u&&cE(s,v)===r)){u&&Tre(s,l,g,g);const b=lE(s,l,[v.kind??""],g);eB(b,v)}}H3(s,l)}}function VQe(t,e,n,i,r){if(!re(ie.book))return;const s=ie.book,a=vh(s,Xn.BOARD,t),o=Qc(a);if(!re(o))return;const c=PY(),l=r==="all"||r==="object",u=r==="all"||r==="terrain";wl(s,o),wl(s,c);const h=-Math.tan(e*.5),d=Math.sin(e),f=Math.round(12.5*h),p=Math.round(12.5*d),g=new Array(ur).fill(0);gie(f,0,-f,ur-1).forEach(x=>{x.x<0?g[x.y]=Math.min(g[x.y],x.x):g[x.y]=Math.max(g[x.y],x.x)});const v=new Array(kn).fill(0);gie(0,p,kn-1,-p).forEach(x=>{x.y<0?v[x.x]=Math.min(v[x.x],x.y):v[x.x]=Math.max(v[x.x],x.y)});const S=[g,v,g];for(let x=0;x<S.length;++x){const M=S[x];if(x!==1){for(let R=0;R<ur;++R){const I=M[R],k=R*kn;for(let P=0;P<kn;P++){const U=(P+I+kn)%kn;u&&(c.terrain[U+k]=o.terrain[P+k])}}if(l){const R=Object.keys(o.objects);for(let I=0;I<R.length;++I){const k=R[I],{x:P,y:U}=o.objects[k];if(re(P)&&re(U)){const V=M[U];o.objects[k].x=(P+V+kn)%kn,o.objects[k].lx=o.objects[k].x}}}}if(x===1){for(let R=0;R<kn;++R){const I=M[R];for(let k=0;k<ur;++k){const P=(k+I+ur)%ur;u&&(c.terrain[R+P*kn]=o.terrain[R+k*kn])}}if(l){const R=Object.keys(o.objects);for(let I=0;I<R.length;++I){const k=R[I],{x:P,y:U}=o.objects[k];if(re(P)&&re(U)){const V=M[P];o.objects[k].y=(U+V+ur)%ur,o.objects[k].ly=o.objects[k].y}}}}u&&(o.terrain=[...c.terrain]),delete c.named,delete c.lookup,delete o.named,delete o.lookup,wl(s,c),wl(s,o)}}function GQe(t,e){let n=0,i=0,r=0;for(;r<t.length;r++)n+=t[r];for(r=0,e*=n;e&&r<t.length;){if(i+=t[r],e<=i)return r;r++}return 0}var qQe=GQe;const $Qe=qQe,Hr=function(){};Hr.prototype.FMX=0;Hr.prototype.FMY=0;Hr.prototype.FMXxFMY=0;Hr.prototype.T=0;Hr.prototype.N=0;Hr.prototype.initiliazedField=!1;Hr.prototype.generationComplete=!1;Hr.prototype.wave=null;Hr.prototype.compatible=null;Hr.prototype.weightLogWeights=null;Hr.prototype.sumOfWeights=0;Hr.prototype.sumOfWeightLogWeights=0;Hr.prototype.startingEntropy=0;Hr.prototype.sumsOfOnes=null;Hr.prototype.sumsOfWeights=null;Hr.prototype.sumsOfWeightLogWeights=null;Hr.prototype.entropies=null;Hr.prototype.propagator=null;Hr.prototype.observed=null;Hr.prototype.distribution=null;Hr.prototype.stack=null;Hr.prototype.stackSize=0;Hr.prototype.DX=[-1,0,1,0];Hr.prototype.DY=[0,1,0,-1];Hr.prototype.opposite=[2,3,0,1];Hr.prototype.initialize=function(){this.distribution=new Array(this.T),this.wave=new Array(this.FMXxFMY),this.compatible=new Array(this.FMXxFMY);for(let t=0;t<this.FMXxFMY;t++){this.wave[t]=new Array(this.T),this.compatible[t]=new Array(this.T);for(let e=0;e<this.T;e++)this.compatible[t][e]=[0,0,0,0]}this.weightLogWeights=new Array(this.T),this.sumOfWeights=0,this.sumOfWeightLogWeights=0;for(let t=0;t<this.T;t++)this.weightLogWeights[t]=this.weights[t]*Math.log(this.weights[t]),this.sumOfWeights+=this.weights[t],this.sumOfWeightLogWeights+=this.weightLogWeights[t];this.startingEntropy=Math.log(this.sumOfWeights)-this.sumOfWeightLogWeights/this.sumOfWeights,this.sumsOfOnes=new Array(this.FMXxFMY),this.sumsOfWeights=new Array(this.FMXxFMY),this.sumsOfWeightLogWeights=new Array(this.FMXxFMY),this.entropies=new Array(this.FMXxFMY),this.stack=new Array(this.FMXxFMY*this.T),this.stackSize=0};Hr.prototype.observe=function(t){let e=1e3,n=-1;for(let s=0;s<this.FMXxFMY;s++){if(this.onBoundary(s%this.FMX,s/this.FMX|0))continue;const a=this.sumsOfOnes[s];if(a===0)return!1;const o=this.entropies[s];if(a>1&&o<=e){const c=1e-6*t();o+c<e&&(e=o+c,n=s)}}if(n===-1){this.observed=new Array(this.FMXxFMY);for(let s=0;s<this.FMXxFMY;s++)for(let a=0;a<this.T;a++)if(this.wave[s][a]){this.observed[s]=a;break}return!0}for(let s=0;s<this.T;s++)this.distribution[s]=this.wave[n][s]?this.weights[s]:0;const i=$Qe(this.distribution,t()),r=this.wave[n];for(let s=0;s<this.T;s++)r[s]!==(s===i)&&this.ban(n,s);return null};Hr.prototype.propagate=function(){for(;this.stackSize>0;){const t=this.stack[this.stackSize-1];this.stackSize--;const e=t[0],n=e%this.FMX,i=e/this.FMX|0;for(let r=0;r<4;r++){const s=this.DX[r],a=this.DY[r];let o=n+s,c=i+a;if(this.onBoundary(o,c))continue;o<0?o+=this.FMX:o>=this.FMX&&(o-=this.FMX),c<0?c+=this.FMY:c>=this.FMY&&(c-=this.FMY);const l=o+c*this.FMX,u=this.propagator[r][t[1]],h=this.compatible[l];for(let d=0;d<u.length;d++){const f=u[d],p=h[f];p[r]--,p[r]==0&&this.ban(l,f)}}}};Hr.prototype.singleIteration=function(t){const e=this.observe(t);return e!==null?(this.generationComplete=e,!!e):(this.propagate(),null)};Hr.prototype.iterate=function(t,e){this.wave||this.initialize(),this.initiliazedField||this.clear(),t=t||0,e=e||Math.random;for(let n=0;n<t||t===0;n++){const i=this.singleIteration(e);if(i!==null)return!!i}return!0};Hr.prototype.generate=function(t){for(t=t||Math.random,this.wave||this.initialize(),this.clear();;){const e=this.singleIteration(t);if(e!==null)return!!e}};Hr.prototype.isGenerationComplete=function(){return this.generationComplete};Hr.prototype.ban=function(t,e){const n=this.compatible[t][e];for(let r=0;r<4;r++)n[r]=0;this.wave[t][e]=!1,this.stack[this.stackSize]=[t,e],this.stackSize++,this.sumsOfOnes[t]-=1,this.sumsOfWeights[t]-=this.weights[e],this.sumsOfWeightLogWeights[t]-=this.weightLogWeights[e];const i=this.sumsOfWeights[t];this.entropies[t]=Math.log(i)-this.sumsOfWeightLogWeights[t]/i};Hr.prototype.clear=function(){for(let t=0;t<this.FMXxFMY;t++){for(let e=0;e<this.T;e++){this.wave[t][e]=!0;for(let n=0;n<4;n++)this.compatible[t][e][n]=this.propagator[this.opposite[n]][e].length}this.sumsOfOnes[t]=this.weights.length,this.sumsOfWeights[t]=this.sumOfWeights,this.sumsOfWeightLogWeights[t]=this.sumOfWeightLogWeights,this.entropies[t]=this.startingEntropy}this.initiliazedField=!0,this.generationComplete=!1};var Yve=Hr;const Kve=Yve,L_=function(e,n,i,r,s,a,o,c,l,u){u=u||0,this.N=r,this.FMX=s,this.FMY=a,this.FMXxFMY=s*a,this.periodic=c;const h=n,d=new Array(h);for(let P=0;P<h;P++)d[P]=new Array(i);this.colors=[];const f={};for(let P=0;P<i;P++)for(let U=0;U<n;U++){const V=(P*n+U)*4,$=[e[V],e[V+1],e[V+2],e[V+3]],q=$.join("-");f.hasOwnProperty(q)||(f[q]=this.colors.length,this.colors.push($)),d[U][P]=f[q]}const p=this.colors.length,g=Math.pow(p,r*r),_=function(U){let V=new Array(r*r);for(let $=0;$<r;$++)for(let q=0;q<r;q++)V[q+$*r]=U(q,$);return V},v=function(U,V){return _(function($,q){return d[(U+$)%n][(V+q)%i]})},b=function(U){return _(function(V,$){return U[r-1-$+V*r]})},S=function(U){return _(function(V,$){return U[r-1-V+$*r]})},x=function(U){let V=0,$=1;for(let q=0;q<U.length;q++)V+=U[U.length-1-q]*$,$*=p;return V},M=function(U){let V=U,$=g;const q=new Array(r*r);for(let Y=0;Y<q.length;Y++){$/=p;let te=0;for(;V>=$;)V-=$,te++;q[Y]=te}return q},R={},I=[];for(let P=0;P<(o?i:i-r+1);P++)for(let U=0;U<(o?n:n-r+1);U++){const V=new Array(8);V[0]=v(U,P),V[1]=S(V[0]),V[2]=b(V[0]),V[3]=S(V[2]),V[4]=b(V[2]),V[5]=S(V[4]),V[6]=b(V[4]),V[7]=S(V[6]);for(let $=0;$<l;$++){const q=x(V[$]);R[q]?R[q]++:(I.push(q),R[q]=1)}}this.T=I.length,this.ground=(u+this.T)%this.T,this.patterns=new Array(this.T),this.weights=new Array(this.T);for(let P=0;P<this.T;P++){const U=parseInt(I[P],10);this.patterns[P]=M(U),this.weights[P]=R[U]}const k=function(U,V,$,q){const Y=$<0?0:$,te=$<0?$+r:r,G=q<0?0:q,J=q<0?q+r:r;for(let K=G;K<J;K++)for(let X=Y;X<te;X++)if(U[X+r*K]!=V[X-$+r*(K-q)])return!1;return!0};this.propagator=new Array(4);for(let P=0;P<4;P++){this.propagator[P]=new Array(this.T);for(let U=0;U<this.T;U++){const V=[];for(let $=0;$<this.T;$++)k(this.patterns[U],this.patterns[$],this.DX[P],this.DY[P])&&V.push($);this.propagator[P][U]=V}}};L_.prototype=Object.create(Kve.prototype);L_.prototype.constructor=L_;L_.prototype.onBoundary=function(t,e){return!this.periodic&&(t+this.N>this.FMX||e+this.N>this.FMY||t<0||e<0)};L_.prototype.clear=function(){if(Kve.prototype.clear.call(this),this.ground!==0){for(let t=0;t<this.FMX;t++){for(let e=0;e<this.T;e++)e!==this.ground&&this.ban(t+(this.FMY-1)*this.FMX,e);for(let e=0;e<this.FMY-1;e++)this.ban(t+e*this.FMX,this.ground)}this.propagate()}};L_.prototype.graphics=function(t){return t=t||new Uint8Array(this.FMXxFMY*4),this.isGenerationComplete()?this.graphicsComplete(t):this.graphicsIncomplete(t),t};L_.prototype.graphicsComplete=function(t){for(let e=0;e<this.FMY;e++){const n=e<this.FMY-this.N+1?0:this.N-1;for(let i=0;i<this.FMX;i++){const r=i<this.FMX-this.N+1?0:this.N-1,s=(e*this.FMX+i)*4,a=this.colors[this.patterns[this.observed[i-r+(e-n)*this.FMX]][r+n*this.N]];t[s]=a[0],t[s+1]=a[1],t[s+2]=a[2],t[s+3]=a[3]}}};L_.prototype.graphicsIncomplete=function(t){for(let e=0;e<this.FMXxFMY;e++){const n=e%this.FMX,i=e/this.FMX|0;let r=0,s=0,a=0,o=0,c=0;for(let u=0;u<this.N;u++)for(let h=0;h<this.N;h++){let d=n-h;d<0&&(d+=this.FMX);let f=i-u;if(f<0&&(f+=this.FMY),this.onBoundary(d,f))continue;const p=d+f*this.FMX;for(let g=0;g<this.T;g++)if(this.wave[p][g]){r++;const _=this.colors[this.patterns[g][h+u*this.N]];s+=_[0],a+=_[1],o+=_[2],c+=_[3]}}const l=e*4;t[l]=s/r,t[l+1]=a/r,t[l+2]=o/r,t[l+3]=c/r}};var WQe=L_;const YQe=Yve,dE=function(e,n,i,r,s){const a=e.tilesize||16;this.FMX=i,this.FMY=r,this.FMXxFMY=i*r,this.periodic=s,this.tilesize=a;const o=!!e.unique;let c=null;n&&e.subsets&&e.subsets[n]&&(c=e.subsets[n]);const l=function(x){const M=new Array(a*a);for(let R=0;R<a;R++)for(let I=0;I<a;I++)M[I+R*a]=x(I,R);return M},u=function(x){return l(function(M,R){return x[a-1-R+M*a]})},h=function(x){return l(function(M,R){return x[a-1-M+R*a]})};this.tiles=[];const d=[],f=[],p={};let g,_,v;for(let S=0;S<e.tiles.length;S++){const x=e.tiles[S];if(c!==null&&c.indexOf(x.name)===-1)continue;switch(x.symmetry){case"L":v=4,g=function(R){return(R+1)%4},_=function(R){return R%2===0?R+1:R-1};break;case"T":v=4,g=function(R){return(R+1)%4},_=function(R){return R%2===0?R:4-R};break;case"I":v=2,g=function(R){return 1-R},_=function(R){return R};break;case"\\":v=2,g=function(R){return 1-R},_=function(R){return 1-R};break;case"F":v=8,g=function(R){return R<4?(R+1)%4:4+(R-1)%4},_=function(R){return R<4?R+4:R-4};break;default:v=1,g=function(R){return R},_=function(R){return R};break}this.T=f.length,p[x.name]=this.T;for(let R=0;R<v;R++)f.push([this.T+R,this.T+g(R),this.T+g(g(R)),this.T+g(g(g(R))),this.T+_(R),this.T+_(g(R)),this.T+_(g(g(R))),this.T+_(g(g(g(R))))]);let M;if(o)for(let R=0;R<v;R++)M=x.bitmap[R],this.tiles.push(l(function(I,k){return[M[(a*k+I)*4],M[(a*k+I)*4+1],M[(a*k+I)*4+2],M[(a*k+I)*4+3]]}));else{M=x.bitmap,this.tiles.push(l(function(R,I){return[M[(a*I+R)*4],M[(a*I+R)*4+1],M[(a*I+R)*4+2],M[(a*I+R)*4+3]]}));for(let R=1;R<v;R++)this.tiles.push(R<4?u(this.tiles[this.T+R-1]):h(this.tiles[this.T+R-4]))}for(let R=0;R<v;R++)d.push(x.weight||1)}this.T=f.length,this.weights=d,this.propagator=new Array(4);const b=new Array(4);for(let S=0;S<4;S++){this.propagator[S]=new Array(this.T),b[S]=new Array(this.T);for(let x=0;x<this.T;x++){b[S][x]=new Array(this.T);for(let M=0;M<this.T;M++)b[S][x][M]=!1}}for(let S=0;S<e.neighbors.length;S++){const x=e.neighbors[S],M=x.left.split(" ").filter(function(V){return V.length}),R=x.right.split(" ").filter(function(V){return V.length});if(c!==null&&(c.indexOf(M[0])===-1||c.indexOf(R[0])===-1))continue;const I=f[p[M[0]]][M.length==1?0:parseInt(M[1],10)],k=f[I][1],P=f[p[R[0]]][R.length==1?0:parseInt(R[1],10)],U=f[P][1];b[0][P][I]=!0,b[0][f[P][6]][f[I][6]]=!0,b[0][f[I][4]][f[P][4]]=!0,b[0][f[I][2]][f[P][2]]=!0,b[1][U][k]=!0,b[1][f[k][6]][f[U][6]]=!0,b[1][f[U][4]][f[k][4]]=!0,b[1][f[k][2]][f[U][2]]=!0}for(let S=0;S<this.T;S++)for(let x=0;x<this.T;x++)b[2][S][x]=b[0][x][S],b[3][S][x]=b[1][x][S];for(let S=0;S<4;S++)for(let x=0;x<this.T;x++){const M=[],R=b[S][x];for(let I=0;I<this.T;I++)R[I]&&M.push(I);this.propagator[S][x]=M}};dE.prototype=Object.create(YQe.prototype);dE.prototype.constructor=dE;dE.prototype.onBoundary=function(t,e){return!this.periodic&&(t<0||e<0||t>=this.FMX||e>=this.FMY)};dE.prototype.graphics=function(t,e){return t=t||new Uint8Array(this.FMXxFMY*this.tilesize*this.tilesize*4),this.isGenerationComplete()?this.graphicsComplete(t):this.graphicsIncomplete(t,e),t};dE.prototype.graphicsComplete=function(t){for(let e=0;e<this.FMX;e++)for(let n=0;n<this.FMY;n++){const i=this.tiles[this.observed[e+n*this.FMX]];for(let r=0;r<this.tilesize;r++)for(let s=0;s<this.tilesize;s++){const a=(e*this.tilesize+s+(n*this.tilesize+r)*this.FMX*this.tilesize)*4,o=i[s+r*this.tilesize];t[a]=o[0],t[a+1]=o[1],t[a+2]=o[2],t[a+3]=o[3]}}};dE.prototype.graphicsIncomplete=function(t,e){(!e||e.length!==4)&&(e=!1);for(let n=0;n<this.FMX;n++)for(let i=0;i<this.FMY;i++){const r=this.wave[n+i*this.FMX];let s=0,a=0;for(let c=0;c<this.T;c++)r[c]&&(s++,a+=this.weights[c]);const o=1/a;for(let c=0;c<this.tilesize;c++)for(let l=0;l<this.tilesize;l++){const u=(n*this.tilesize+l+(i*this.tilesize+c)*this.FMX*this.tilesize)*4;if(e&&s===this.T)t[u]=e[0],t[u+1]=e[1],t[u+2]=e[2],t[u+3]=e[3];else{let h=0,d=0,f=0,p=0;for(let g=0;g<this.T;g++)if(r[g]){const _=this.tiles[g][l+c*this.tilesize],v=this.weights[g]*o;h+=_[0]*v,d+=_[1]*v,f+=_[2]*v,p+=_[3]*v}t[u]=h,t[u+1]=d,t[u+2]=f,t[u+3]=p}}}};var KQe=dE,XQe={OverlappingModel:WQe,SimpleTiledModel:KQe};const ZQe=il(XQe),xre=5;function JQe(t,e,n,i,r,s,a){if(!re(ie.book))return!1;const o=ie.book,c=vh(o,Xn.BOARD,t),l=vh(o,Xn.BOARD,e),u=Qc(c),h=Qc(l);if(!re(u)||!re(h))return!1;wl(o,u),wl(o,h);let d=0;const f=new Map,p=new Map;let g=0;const _=32,v=new Uint8Array(hk*4);for(let I=0;I<ur;++I)for(let k=0;k<kn;++k){const P=bc(h,{x:k,y:I}),U=(P==null?void 0:P.char)??0,V=(P==null?void 0:P.color)??_,$=(P==null?void 0:P.bg)??_;v[g++]=U,v[g++]=V,v[g++]=$;const q=v1(o,P),Y=Wn((q==null?void 0:q.name)??"empty"),te=f.get(Y);an(te)?v[g++]=te:(f.set(Y,d),p.set(d,Y),v[g++]=d++)}const b=s.x-r.x+1,S=s.y-r.y+1,x=new ZQe.OverlappingModel(v,kn,ur,n,b,S,!1,!1,i,0);let M=0;for(;M<xre&&!x.generate();++M);if(M===xre)return!1;g=0;const R=x.graphics();for(let I=r.y;I<=s.y;++I)for(let k=r.x;k<=s.x;++k){const P={x:k,y:I},U=R[g++],V=R[g++],$=R[g++];switch(d=R[g++],a){case"all":{const K=bc(u,{x:k,y:I});hh(K)&&e0(o,u,K,o.timestamp),af(u,{x:k,y:I});break}case"object":{const K=bc(u,{x:k,y:I});hh(K)&&e0(o,u,K,o.timestamp);break}case"terrain":af(u,{x:k,y:I});break}let q=p.get(d)??"";const Y=vA(o,q),te=GN(o,q),G=Y??te;switch(a){case"all":break;case"object":re(te)&&(q="");break;case"terrain":re(Y)&&(q="");break;default:if(cE(o,G)!==a&&(q=""),q){const K=bc(u,{x:k,y:I});hh(K)&&e0(o,u,K,o.timestamp),af(u,{x:k,y:I})}break}const J=q?lE(o,u,[q],P):void 0;if(!(!re(J)||!re(G))&&(eB(J,G),U>0&&(J.char=U),V<_&&(J.color=V),$<_&&(J.bg=$),hh(J))){const K=io(Ek(h,q));re(K)&&(af(u,{...mA(h,K.x??0,K.y??0),x:k,y:I}),eB(J,K))}}return!0}function Xve(t){return`zss_snapshot_${t}`}function QQe(t,e,n,i){const r=vh(ie.book,Xn.BOARD,t),s=Qc(r);if(!re(s))return;const a=Xve(s.id);P0e(ie.book,a);const[o]=Jy(Lc.CONTENT,a,Xn.BOARD),c=Qc(o);if(re(c))return AK(t,c.id,e,n,i),c}function eet(t,e,n,i){const r=vh(ie.book,Xn.BOARD,t),s=Qc(r);if(!re(s))return;const a=Xve(s.id),o=vh(ie.book,Xn.BOARD,a),c=Qc(o);if(re(c))return AK(c.id,t,e,n,i),c}function tet(t,e,n,i,r){switch(r){case"all":case"object":case"terrain":break;default:return net(t,e,r)}if(!re(ie.book))return;const s=ie.book,a=vh(s,Xn.BOARD,t),o=Qc(a);if(!re(o))return;const c=PY();wl(s,o);for(let l=n.y;l<=i.y;++l)for(let u=n.x;u<=i.x;++u){let h=!1,d=!1;switch(r){case"all":h=!0,d=!0;break;case"object":h=!0;break;case"terrain":d=!0;break}const f=(u+e.x+kn)%kn,p=(l+e.y+ur)%ur;if(h){const g=bc(o,{x:u,y:l});hh(g)&&re(g==null?void 0:g.x)&&re(g==null?void 0:g.y)&&(g.x=f,g.lx=f,g.y=p,g.ly=p)}d&&(c.terrain[f+p*kn]=o.terrain[u+l*kn])}(r==="all"||r==="terrain")&&(o.terrain=[...c.terrain]),H3(s,o)}function net(t,e,n){if(!re(ie.book))return;const i=ie.book,r=vh(i,Xn.BOARD,t),s=Qc(r);if(!re(s))return;wl(i,s);const{objectelements:a,terrainelements:o}=bWe(i,s,n);let c=!1;const l={};for(let h=0;h<o.length;++h){const d=o[h],f=yc(i,d,"collision"),p={x:d.x??-1,y:d.y??-1},g=bc(s,p);hh(g)&&re(g)&&(l[g.id??""]=!0);const _={x:p.x+e.x,y:p.y+e.y};if(P3(_)){const v=bc(s,_),b=cE(i,v),S=yc(i,v,"collision");hh(v)&&n!==b?UN(f,S)?c=!0:yc(i,v,"pushable")?c=CC(i,s,v,_)!==!0:c=!1:S===Qr.ISSOLID&&n!==b&&(c=!0)}else c=!0}if(c)return;for(let h=0;h<a.length;++h){const d=a[h],f=yc(i,d,"collision"),p={x:d.x??0,y:d.y??0},g={x:p.x+e.x,y:p.y+e.y};if(P3(g)){const _=bc(s,g),v=cE(i,_),b=yc(i,_,"collision");hh(_)&&re(_)&&n!==v&&!l[_.id??""]?yc(i,_,"pushable")?c=CC(i,s,_,g)!==!0:c=!0:UN(f,b)&&n!==v&&(c=!0)}else c=!0}if(c)return;(e.x>0||e.y>0)&&o.reverse();for(let h=0;h<o.length;++h){const d=o[h],f={x:d.x??-1,y:d.y??-1},p={x:f.x+e.x,y:f.y+e.y},g=mA(s,p.x,p.y);if(re(d)&&re(g)){af(s,{...d,x:p.x,y:p.y}),af(s,{...g,x:f.x,y:f.y});const _=bc(s,f);hh(_)&&re(_)&&(_.x=(_.x??0)+e.x,_.y=(_.y??0)+e.y,_.lx=(_.lx??0)+e.x,_.ly=(_.ly??0)+e.y)}}H3(i,s);for(let h=0;h<a.length;++h){const d=a[h],f={x:d.x??-1,y:d.y??-1},p={x:f.x+e.x,y:f.y+e.y};if(!CC(i,s,d,p))break}H3(i,s)}function fw(t,e){let n="all";const i={x:0,y:0},r={x:kn-1,y:ur-1};for(let s=e;s<t.length;){const[a,o]=Rt(t,s,[Ke.MAYBE_NUMBER_OR_STRING]);if(Tn(a))n=Wn(a),s=o;else if(an(a)){const[c,l,u,h]=Rt(t,o,[Ke.NUMBER,Ke.NUMBER,Ke.NUMBER]);i.x=Math.min(a,l),i.y=Math.min(c,u),r.x=Math.max(a,l),r.y=Math.max(c,u),s=h}else break}return{targetset:n,pt1:i,pt2:r}}const iet=q_().command("snapshot",(t,e)=>{if(!re(ie.book)||!re(ie.board))return 0;const n=fw(e,0);return QQe(ie.board.id,n.pt1,n.pt2,n.targetset),0}).command("revert",(t,e)=>{if(!re(ie.book)||!re(ie.board))return 0;const n=fw(e,0);return eet(ie.board.id,n.pt1,n.pt2,n.targetset),0}).command("copy",(t,e)=>{if(!re(ie.book)||!re(ie.board))return 0;const[n,i]=Rt(e,0,[Ke.NAME]),r=fp(ie.book,Xn.BOARD,n),s=io(...r);if(re(s)){const a=fw(e,i);AK(s.id,ie.board.id,a.pt1,a.pt2,a.targetset)}return 0}).command("remix",(t,e)=>{if(!re(ie.book)||!re(ie.board))return 0;const[n,i,r,s]=Rt(e,0,[Ke.NAME,Ke.NUMBER,Ke.NUMBER]),a=fp(ie.book,Xn.BOARD,n),o=io(...a);if(re(o)){const c=fw(e,s);JQe(ie.board.id,o.id,i,r,c.pt1,c.pt2,c.targetset)}return 0}).command("weave",(t,e)=>{var a,o;if(!re(ie.book)||!re(ie.board))return 0;const[n,i]=Rt(e,0,[Ke.DIR]),r={x:n.destpt.x-(((a=ie.element)==null?void 0:a.x)??0),y:n.destpt.y-(((o=ie.element)==null?void 0:o.y)??0)},s=fw(e,i);return tet(ie.board.id,r,s.pt1,s.pt2,s.targetset),0}).command("pivot",(t,e)=>{if(!re(ie.book)||!re(ie.board))return 0;const[n,i]=Rt(e,0,[Ke.NUMBER]),r=fw(e,i);return VQe(ie.board.id,Cpe(n),r.pt1,r.pt2,r.targetset),0});var RK=(t=>(t[t.ERROR=0]="ERROR",t[t.CLI=1]="CLI",t[t.LOADER=2]="LOADER",t[t.RUNTIME=3]="RUNTIME",t))(RK||{});const ret={audio:sK,board:wWe,cli:nQe,display:iQe,element:hQe,runtime:jQe,loader:OQe,network:NQe,transform:iet},RH=["audio","board","display","network","transform","element"],set={0:[],1:["cli",...RH],2:["loader",...RH],3:["runtime",...RH]},aet={0:new Map,1:new Map,2:new Map,3:new Map};function Mk(t){return(set[t]??[]).map(n=>ret[n]).filter(re)}function oet(t,e){const n=aet[t];if(!n.has(e)){let i;const r=Mk(t);for(let s=0;s<r.length&&(i=r[s].getcommand(e),!re(i));++s);n.set(e,i)}return n.get(e)}function cet(t,e,n){const i=Mk(t);for(let r=0;r<i.length;++r){const s=i[r];if(s.get!==void 0){const[a,o]=s.get(e,n);if(a)return[a,o]}}return[!1,void 0]}function uet(t,e,n,i){const r=Mk(t);for(let s=0;s<r.length;++s){const a=r[s];if(a.set!==void 0){const[o]=a.set(e,n,i);if(o)return[o,i]}}return[!1,void 0]}function het(t,e){const n=Mk(t);for(let i=0;i<n.length;++i)n[i].tick(e)}function wre(t,e){const n=Mk(t);for(let i=0;i<n.length;++i)n[i].everytick(e)}var Zve={},Jve={},Qve={};const Cre="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".split("");Qve.encode=function(t){if(0<=t&&t<Cre.length)return Cre[t];throw new TypeError("Must be between 0 and 63: "+t)};const det=Qve,e_e=5,t_e=1<<e_e,fet=t_e-1,pet=t_e;function met(t){return t<0?(-t<<1)+1:(t<<1)+0}Jve.encode=function(e){let n="",i,r=met(e);do i=r&fet,r>>>=e_e,r>0&&(i|=pet),n+=det.encode(i);while(r>0);return n};var Ok={};(function(t){function e(R,I,k){if(I in R)return R[I];if(arguments.length===3)return k;throw new Error('"'+I+'" is a required argument.')}t.getArg=e;const n=/^(?:([\w+\-.]+):)?\/\/(?:(\w+:\w+)@)?([\w.-]*)(?::(\d+))?(.*)$/,i=/^data:.+\,.+$/;function r(R){const I=R.match(n);return I?{scheme:I[1],auth:I[2],host:I[3],port:I[4],path:I[5]}:null}t.urlParse=r;function s(R){let I="";return R.scheme&&(I+=R.scheme+":"),I+="//",R.auth&&(I+=R.auth+"@"),R.host&&(I+=R.host),R.port&&(I+=":"+R.port),R.path&&(I+=R.path),I}t.urlGenerate=s;const a=32;function o(R){const I=[];return function(k){for(let U=0;U<I.length;U++)if(I[U].input===k){const V=I[0];return I[0]=I[U],I[U]=V,I[0].result}const P=R(k);return I.unshift({input:k,result:P}),I.length>a&&I.pop(),P}}const c=o(function(I){let k=I;const P=r(I);if(P){if(!P.path)return I;k=P.path}const U=t.isAbsolute(k),V=[];let $=0,q=0;for(;;)if($=q,q=k.indexOf("/",$),q===-1){V.push(k.slice($));break}else for(V.push(k.slice($,q));q<k.length&&k[q]==="/";)q++;let Y=0;for(q=V.length-1;q>=0;q--){const te=V[q];te==="."?V.splice(q,1):te===".."?Y++:Y>0&&(te===""?(V.splice(q+1,Y),Y=0):(V.splice(q,2),Y--))}return k=V.join("/"),k===""&&(k=U?"/":"."),P?(P.path=k,s(P)):k});t.normalize=c;function l(R,I){R===""&&(R="."),I===""&&(I=".");const k=r(I),P=r(R);if(P&&(R=P.path||"/"),k&&!k.scheme)return P&&(k.scheme=P.scheme),s(k);if(k||I.match(i))return I;if(P&&!P.host&&!P.path)return P.host=I,s(P);const U=I.charAt(0)==="/"?I:c(R.replace(/\/+$/,"")+"/"+I);return P?(P.path=U,s(P)):U}t.join=l,t.isAbsolute=function(R){return R.charAt(0)==="/"||n.test(R)};function u(R,I){R===""&&(R="."),R=R.replace(/\/$/,"");let k=0;for(;I.indexOf(R+"/")!==0;){const P=R.lastIndexOf("/");if(P<0||(R=R.slice(0,P),R.match(/^([^\/]+:\/)?\/*$/)))return I;++k}return Array(k+1).join("../")+I.substr(R.length+1)}t.relative=u;const h=function(){return!("__proto__"in Object.create(null))}();function d(R){return R}function f(R){return g(R)?"$"+R:R}t.toSetString=h?d:f;function p(R){return g(R)?R.slice(1):R}t.fromSetString=h?d:p;function g(R){if(!R)return!1;const I=R.length;if(I<9||R.charCodeAt(I-1)!==95||R.charCodeAt(I-2)!==95||R.charCodeAt(I-3)!==111||R.charCodeAt(I-4)!==116||R.charCodeAt(I-5)!==111||R.charCodeAt(I-6)!==114||R.charCodeAt(I-7)!==112||R.charCodeAt(I-8)!==95||R.charCodeAt(I-9)!==95)return!1;for(let k=I-10;k>=0;k--)if(R.charCodeAt(k)!==36)return!1;return!0}function _(R,I,k){let P=b(R.source,I.source);return P!==0||(P=R.originalLine-I.originalLine,P!==0)||(P=R.originalColumn-I.originalColumn,P!==0||k)||(P=R.generatedColumn-I.generatedColumn,P!==0)||(P=R.generatedLine-I.generatedLine,P!==0)?P:b(R.name,I.name)}t.compareByOriginalPositions=_;function v(R,I,k){let P=R.generatedLine-I.generatedLine;return P!==0||(P=R.generatedColumn-I.generatedColumn,P!==0||k)||(P=b(R.source,I.source),P!==0)||(P=R.originalLine-I.originalLine,P!==0)||(P=R.originalColumn-I.originalColumn,P!==0)?P:b(R.name,I.name)}t.compareByGeneratedPositionsDeflated=v;function b(R,I){return R===I?0:R===null?1:I===null?-1:R>I?1:-1}function S(R,I){let k=R.generatedLine-I.generatedLine;return k!==0||(k=R.generatedColumn-I.generatedColumn,k!==0)||(k=b(R.source,I.source),k!==0)||(k=R.originalLine-I.originalLine,k!==0)||(k=R.originalColumn-I.originalColumn,k!==0)?k:b(R.name,I.name)}t.compareByGeneratedPositionsInflated=S;function x(R){return JSON.parse(R.replace(/^\)]}'[^\n]*\n/,""))}t.parseSourceMapInput=x;function M(R,I,k){if(I=I||"",R&&(R[R.length-1]!=="/"&&I[0]!=="/"&&(R+="/"),I=R+I),k){const P=r(k);if(!P)throw new Error("sourceMapURL could not be parsed");if(P.path){const U=P.path.lastIndexOf("/");U>=0&&(P.path=P.path.substring(0,U+1))}I=l(s(P),I)}return c(I)}t.computeSourceURL=M})(Ok);var MK={};let get=class n_e{constructor(){this._array=[],this._set=new Map}static fromArray(e,n){const i=new n_e;for(let r=0,s=e.length;r<s;r++)i.add(e[r],n);return i}size(){return this._set.size}add(e,n){const i=this.has(e),r=this._array.length;(!i||n)&&this._array.push(e),i||this._set.set(e,r)}has(e){return this._set.has(e)}indexOf(e){const n=this._set.get(e);if(n>=0)return n;throw new Error('"'+e+'" is not in the set.')}at(e){if(e>=0&&e<this._array.length)return this._array[e];throw new Error("No element indexed by "+e)}toArray(){return this._array.slice()}};MK.ArraySet=get;var i_e={};const r_e=Ok;function vet(t,e){const n=t.generatedLine,i=e.generatedLine,r=t.generatedColumn,s=e.generatedColumn;return i>n||i==n&&s>=r||r_e.compareByGeneratedPositionsInflated(t,e)<=0}let _et=class{constructor(){this._array=[],this._sorted=!0,this._last={generatedLine:-1,generatedColumn:0}}unsortedForEach(e,n){this._array.forEach(e,n)}add(e){vet(this._last,e)?(this._last=e,this._array.push(e)):(this._sorted=!1,this._array.push(e))}toArray(){return this._sorted||(this._array.sort(r_e.compareByGeneratedPositionsInflated),this._sorted=!0),this._array}};i_e.MappingList=_et;const vM=Jve,dc=Ok,s2=MK.ArraySet,yet=i_e.MappingList;let s_e=class a_e{constructor(e){e||(e={}),this._file=dc.getArg(e,"file",null),this._sourceRoot=dc.getArg(e,"sourceRoot",null),this._skipValidation=dc.getArg(e,"skipValidation",!1),this._sources=new s2,this._names=new s2,this._mappings=new yet,this._sourcesContents=null}static fromSourceMap(e){const n=e.sourceRoot,i=new a_e({file:e.file,sourceRoot:n});return e.eachMapping(function(r){const s={generated:{line:r.generatedLine,column:r.generatedColumn}};r.source!=null&&(s.source=r.source,n!=null&&(s.source=dc.relative(n,s.source)),s.original={line:r.originalLine,column:r.originalColumn},r.name!=null&&(s.name=r.name)),i.addMapping(s)}),e.sources.forEach(function(r){let s=r;n!==null&&(s=dc.relative(n,r)),i._sources.has(s)||i._sources.add(s);const a=e.sourceContentFor(r);a!=null&&i.setSourceContent(r,a)}),i}addMapping(e){const n=dc.getArg(e,"generated"),i=dc.getArg(e,"original",null);let r=dc.getArg(e,"source",null),s=dc.getArg(e,"name",null);this._skipValidation||this._validateMapping(n,i,r,s),r!=null&&(r=String(r),this._sources.has(r)||this._sources.add(r)),s!=null&&(s=String(s),this._names.has(s)||this._names.add(s)),this._mappings.add({generatedLine:n.line,generatedColumn:n.column,originalLine:i!=null&&i.line,originalColumn:i!=null&&i.column,source:r,name:s})}setSourceContent(e,n){let i=e;this._sourceRoot!=null&&(i=dc.relative(this._sourceRoot,i)),n!=null?(this._sourcesContents||(this._sourcesContents=Object.create(null)),this._sourcesContents[dc.toSetString(i)]=n):this._sourcesContents&&(delete this._sourcesContents[dc.toSetString(i)],Object.keys(this._sourcesContents).length===0&&(this._sourcesContents=null))}applySourceMap(e,n,i){let r=n;if(n==null){if(e.file==null)throw new Error(`SourceMapGenerator.prototype.applySourceMap requires either an explicit source file, or the source map's "file" property. Both were omitted.`);r=e.file}const s=this._sourceRoot;s!=null&&(r=dc.relative(s,r));const a=this._mappings.toArray().length>0?new s2:this._sources,o=new s2;this._mappings.unsortedForEach(function(c){if(c.source===r&&c.originalLine!=null){const h=e.originalPositionFor({line:c.originalLine,column:c.originalColumn});h.source!=null&&(c.source=h.source,i!=null&&(c.source=dc.join(i,c.source)),s!=null&&(c.source=dc.relative(s,c.source)),c.originalLine=h.line,c.originalColumn=h.column,h.name!=null&&(c.name=h.name))}const l=c.source;l!=null&&!a.has(l)&&a.add(l);const u=c.name;u!=null&&!o.has(u)&&o.add(u)},this),this._sources=a,this._names=o,e.sources.forEach(function(c){const l=e.sourceContentFor(c);l!=null&&(i!=null&&(c=dc.join(i,c)),s!=null&&(c=dc.relative(s,c)),this.setSourceContent(c,l))},this)}_validateMapping(e,n,i,r){if(n&&typeof n.line!="number"&&typeof n.column!="number")throw new Error("original.line and original.column are not numbers -- you probably meant to omit the original mapping entirely and only map the generated position. If so, pass null for the original mapping instead of an object with empty or null values.");if(!(e&&"line"in e&&"column"in e&&e.line>0&&e.column>=0&&!n&&!i&&!r)){if(!(e&&"line"in e&&"column"in e&&n&&"line"in n&&"column"in n&&e.line>0&&e.column>=0&&n.line>0&&n.column>=0&&i))throw new Error("Invalid mapping: "+JSON.stringify({generated:e,source:i,original:n,name:r}))}}_serializeMappings(){let e=0,n=1,i=0,r=0,s=0,a=0,o="",c,l,u,h;const d=this._mappings.toArray();for(let f=0,p=d.length;f<p;f++){if(l=d[f],c="",l.generatedLine!==n)for(e=0;l.generatedLine!==n;)c+=";",n++;else if(f>0){if(!dc.compareByGeneratedPositionsInflated(l,d[f-1]))continue;c+=","}c+=vM.encode(l.generatedColumn-e),e=l.generatedColumn,l.source!=null&&(h=this._sources.indexOf(l.source),c+=vM.encode(h-a),a=h,c+=vM.encode(l.originalLine-1-r),r=l.originalLine-1,c+=vM.encode(l.originalColumn-i),i=l.originalColumn,l.name!=null&&(u=this._names.indexOf(l.name),c+=vM.encode(u-s),s=u)),o+=c}return o}_generateSourcesContent(e,n){return e.map(function(i){if(!this._sourcesContents)return null;n!=null&&(i=dc.relative(n,i));const r=dc.toSetString(i);return Object.prototype.hasOwnProperty.call(this._sourcesContents,r)?this._sourcesContents[r]:null},this)}toJSON(){const e={version:this._version,sources:this._sources.toArray(),names:this._names.toArray(),mappings:this._serializeMappings()};return this._file!=null&&(e.file=this._file),this._sourceRoot!=null&&(e.sourceRoot=this._sourceRoot),this._sourcesContents&&(e.sourcesContent=this._generateSourcesContent(e.sources,e.sourceRoot)),e}toString(){return JSON.stringify(this.toJSON())}};s_e.prototype._version=3;Zve.SourceMapGenerator=s_e;var o_e={};(function(t){t.GREATEST_LOWER_BOUND=1,t.LEAST_UPPER_BOUND=2;function e(n,i,r,s,a,o){const c=Math.floor((i-n)/2)+n,l=a(r,s[c],!0);return l===0?c:l>0?i-c>1?e(c,i,r,s,a,o):o==t.LEAST_UPPER_BOUND?i<s.length?i:-1:c:c-n>1?e(n,c,r,s,a,o):o==t.LEAST_UPPER_BOUND?c:n<0?-1:n}t.search=function(i,r,s,a){if(r.length===0)return-1;let o=e(-1,r.length,i,r,s,a||t.GREATEST_LOWER_BOUND);if(o<0)return-1;for(;o-1>=0&&s(r[o],r[o-1],!0)===0;)--o;return o}})(o_e);var qM={exports:{}};const bet={},u$=Object.freeze(Object.defineProperty({__proto__:null,default:bet},Symbol.toStringTag,{value:"Module"})),S1=$ce(u$),Eet=(function(){return typeof window<"u"&&this===window}).call();if(Eet){let t=null;qM.exports=function(){if(typeof t=="string")return fetch(t).then(n=>n.arrayBuffer());if(t instanceof ArrayBuffer)return Promise.resolve(t);throw new Error("You must provide the string URL or ArrayBuffer contents of lib/mappings.wasm by calling SourceMapConsumer.initialize({ 'lib/mappings.wasm': ... }) before using SourceMapConsumer")},qM.exports.initialize=e=>t=e}else{const t=S1,e=S1;qM.exports=function(){return new Promise((i,r)=>{const s=e.join(__dirname,"mappings.wasm");t.readFile(s,null,(a,o)=>{if(a){r(a);return}i(o.buffer)})})},qM.exports.initialize=n=>{console.debug("SourceMapConsumer.initialize is a no-op when running in node.js")}}var c_e=qM.exports;const Tet=c_e;function xet(){this.generatedLine=0,this.generatedColumn=0,this.lastGeneratedColumn=null,this.source=null,this.originalLine=null,this.originalColumn=null,this.name=null}let _M=null;var wet=function(){if(_M)return _M;const e=[];return _M=Tet().then(n=>WebAssembly.instantiate(n,{env:{mapping_callback(i,r,s,a,o,c,l,u,h,d){const f=new xet;f.generatedLine=i+1,f.generatedColumn=r,s&&(f.lastGeneratedColumn=a-1),o&&(f.source=c,f.originalLine=l+1,f.originalColumn=u,h&&(f.name=d)),e[e.length-1](f)},start_all_generated_locations_for(){console.time("all_generated_locations_for")},end_all_generated_locations_for(){console.timeEnd("all_generated_locations_for")},start_compute_column_spans(){console.time("compute_column_spans")},end_compute_column_spans(){console.timeEnd("compute_column_spans")},start_generated_location_for(){console.time("generated_location_for")},end_generated_location_for(){console.timeEnd("generated_location_for")},start_original_location_for(){console.time("original_location_for")},end_original_location_for(){console.timeEnd("original_location_for")},start_parse_mappings(){console.time("parse_mappings")},end_parse_mappings(){console.timeEnd("parse_mappings")},start_sort_by_generated_location(){console.time("sort_by_generated_location")},end_sort_by_generated_location(){console.timeEnd("sort_by_generated_location")},start_sort_by_original_location(){console.time("sort_by_original_location")},end_sort_by_original_location(){console.timeEnd("sort_by_original_location")}}})).then(n=>({exports:n.instance.exports,withMappingCallback:(i,r)=>{e.push(i);try{r()}finally{e.pop()}}})).then(null,n=>{throw _M=null,n}),_M};const si=Ok,MH=o_e,tB=MK.ArraySet,Cet=c_e,Aet=wet,OK=Symbol("smcInternal");class $o{constructor(e,n){return e==OK?Promise.resolve(this):Met(e,n)}static initialize(e){Cet.initialize(e["lib/mappings.wasm"])}static fromSourceMap(e,n){return Oet(e,n)}static async with(e,n,i){const r=await new $o(e,n);try{return await i(r)}finally{r.destroy()}}_parseMappings(e,n){throw new Error("Subclasses must implement _parseMappings")}eachMapping(e,n,i){throw new Error("Subclasses must implement eachMapping")}allGeneratedPositionsFor(e){throw new Error("Subclasses must implement allGeneratedPositionsFor")}destroy(){throw new Error("Subclasses must implement destroy")}}$o.prototype._version=3;$o.GENERATED_ORDER=1;$o.ORIGINAL_ORDER=2;$o.GREATEST_LOWER_BOUND=1;$o.LEAST_UPPER_BOUND=2;class Nk extends $o{constructor(e,n){return super(OK).then(i=>{let r=e;typeof e=="string"&&(r=si.parseSourceMapInput(e));const s=si.getArg(r,"version");let a=si.getArg(r,"sources");const o=si.getArg(r,"names",[]);let c=si.getArg(r,"sourceRoot",null);const l=si.getArg(r,"sourcesContent",null),u=si.getArg(r,"mappings"),h=si.getArg(r,"file",null);if(s!=i._version)throw new Error("Unsupported version: "+s);return c&&(c=si.normalize(c)),a=a.map(String).map(si.normalize).map(function(d){return c&&si.isAbsolute(c)&&si.isAbsolute(d)?si.relative(c,d):d}),i._names=tB.fromArray(o.map(String),!0),i._sources=tB.fromArray(a,!0),i._absoluteSources=i._sources.toArray().map(function(d){return si.computeSourceURL(c,d,n)}),i.sourceRoot=c,i.sourcesContent=l,i._mappings=u,i._sourceMapURL=n,i.file=h,i._computedColumnSpans=!1,i._mappingsPtr=0,i._wasm=null,Aet().then(d=>(i._wasm=d,i))})}_findSourceIndex(e){let n=e;if(this.sourceRoot!=null&&(n=si.relative(this.sourceRoot,n)),this._sources.has(n))return this._sources.indexOf(n);for(let i=0;i<this._absoluteSources.length;++i)if(this._absoluteSources[i]==e)return i;return-1}static fromSourceMap(e,n){return new Nk(e.toString())}get sources(){return this._absoluteSources.slice()}_getMappingsPtr(){return this._mappingsPtr===0&&this._parseMappings(this._mappings,this.sourceRoot),this._mappingsPtr}_parseMappings(e,n){const i=e.length,r=this._wasm.exports.allocate_mappings(i),s=new Uint8Array(this._wasm.exports.memory.buffer,r,i);for(let o=0;o<i;o++)s[o]=e.charCodeAt(o);const a=this._wasm.exports.parse_mappings(r);if(!a){const o=this._wasm.exports.get_last_error();let c=`Error parsing mappings (code ${o}): `;switch(o){case 1:c+="the mappings contained a negative line, column, source index, or name index";break;case 2:c+="the mappings contained a number larger than 2**32";break;case 3:c+="reached EOF while in the middle of parsing a VLQ";break;case 4:c+="invalid base 64 character while parsing a VLQ";break;default:c+="unknown error code";break}throw new Error(c)}this._mappingsPtr=a}eachMapping(e,n,i){const r=n||null,s=i||$o.GENERATED_ORDER,a=this.sourceRoot;this._wasm.withMappingCallback(o=>{o.source!==null&&(o.source=this._sources.at(o.source),o.source=si.computeSourceURL(a,o.source,this._sourceMapURL),o.name!==null&&(o.name=this._names.at(o.name))),e.call(r,o)},()=>{switch(s){case $o.GENERATED_ORDER:this._wasm.exports.by_generated_location(this._getMappingsPtr());break;case $o.ORIGINAL_ORDER:this._wasm.exports.by_original_location(this._getMappingsPtr());break;default:throw new Error("Unknown order of iteration.")}})}allGeneratedPositionsFor(e){let n=si.getArg(e,"source");const i=si.getArg(e,"line"),r=e.column||0;if(n=this._findSourceIndex(n),n<0)return[];if(i<1)throw new Error("Line numbers must be >= 1");if(r<0)throw new Error("Column numbers must be >= 0");const s=[];return this._wasm.withMappingCallback(a=>{let o=a.lastGeneratedColumn;this._computedColumnSpans&&o===null&&(o=1/0),s.push({line:a.generatedLine,column:a.generatedColumn,lastColumn:o})},()=>{this._wasm.exports.all_generated_locations_for(this._getMappingsPtr(),n,i-1,"column"in e,r)}),s}destroy(){this._mappingsPtr!==0&&(this._wasm.exports.free_mappings(this._mappingsPtr),this._mappingsPtr=0)}computeColumnSpans(){this._computedColumnSpans||(this._wasm.exports.compute_column_spans(this._getMappingsPtr()),this._computedColumnSpans=!0)}originalPositionFor(e){const n={generatedLine:si.getArg(e,"line"),generatedColumn:si.getArg(e,"column")};if(n.generatedLine<1)throw new Error("Line numbers must be >= 1");if(n.generatedColumn<0)throw new Error("Column numbers must be >= 0");let i=si.getArg(e,"bias",$o.GREATEST_LOWER_BOUND);i==null&&(i=$o.GREATEST_LOWER_BOUND);let r;if(this._wasm.withMappingCallback(s=>r=s,()=>{this._wasm.exports.original_location_for(this._getMappingsPtr(),n.generatedLine-1,n.generatedColumn,i)}),r&&r.generatedLine===n.generatedLine){let s=si.getArg(r,"source",null);s!==null&&(s=this._sources.at(s),s=si.computeSourceURL(this.sourceRoot,s,this._sourceMapURL));let a=si.getArg(r,"name",null);return a!==null&&(a=this._names.at(a)),{source:s,line:si.getArg(r,"originalLine",null),column:si.getArg(r,"originalColumn",null),name:a}}return{source:null,line:null,column:null,name:null}}hasContentsOfAllSources(){return this.sourcesContent?this.sourcesContent.length>=this._sources.size()&&!this.sourcesContent.some(function(e){return e==null}):!1}sourceContentFor(e,n){if(!this.sourcesContent)return null;const i=this._findSourceIndex(e);if(i>=0)return this.sourcesContent[i];let r=e;this.sourceRoot!=null&&(r=si.relative(this.sourceRoot,r));let s;if(this.sourceRoot!=null&&(s=si.urlParse(this.sourceRoot))){const a=r.replace(/^file:\/\//,"");if(s.scheme=="file"&&this._sources.has(a))return this.sourcesContent[this._sources.indexOf(a)];if((!s.path||s.path=="/")&&this._sources.has("/"+r))return this.sourcesContent[this._sources.indexOf("/"+r)]}if(n)return null;throw new Error('"'+r+'" is not in the SourceMap.')}generatedPositionFor(e){let n=si.getArg(e,"source");if(n=this._findSourceIndex(n),n<0)return{line:null,column:null,lastColumn:null};const i={source:n,originalLine:si.getArg(e,"line"),originalColumn:si.getArg(e,"column")};if(i.originalLine<1)throw new Error("Line numbers must be >= 1");if(i.originalColumn<0)throw new Error("Column numbers must be >= 0");let r=si.getArg(e,"bias",$o.GREATEST_LOWER_BOUND);r==null&&(r=$o.GREATEST_LOWER_BOUND);let s;if(this._wasm.withMappingCallback(a=>s=a,()=>{this._wasm.exports.generated_location_for(this._getMappingsPtr(),i.source,i.originalLine-1,i.originalColumn,r)}),s&&s.source===i.source){let a=s.lastGeneratedColumn;return this._computedColumnSpans&&a===null&&(a=1/0),{line:si.getArg(s,"generatedLine",null),column:si.getArg(s,"generatedColumn",null),lastColumn:a}}return{line:null,column:null,lastColumn:null}}}Nk.prototype.consumer=$o;class Ret extends $o{constructor(e,n){return super(OK).then(i=>{let r=e;typeof e=="string"&&(r=si.parseSourceMapInput(e));const s=si.getArg(r,"version"),a=si.getArg(r,"sections");if(s!=i._version)throw new Error("Unsupported version: "+s);i._sources=new tB,i._names=new tB,i.__generatedMappings=null,i.__originalMappings=null,i.__generatedMappingsUnsorted=null,i.__originalMappingsUnsorted=null;let o={line:-1,column:0};return Promise.all(a.map(c=>{if(c.url)throw new Error("Support for url field in sections not implemented.");const l=si.getArg(c,"offset"),u=si.getArg(l,"line"),h=si.getArg(l,"column");if(u<o.line||u===o.line&&h<o.column)throw new Error("Section offsets must be ordered and non-overlapping.");return o=l,new $o(si.getArg(c,"map"),n).then(f=>({generatedOffset:{generatedLine:u+1,generatedColumn:h+1},consumer:f}))})).then(c=>(i._sections=c,i))})}get _generatedMappings(){return this.__generatedMappings||this._sortGeneratedMappings(),this.__generatedMappings}get _originalMappings(){return this.__originalMappings||this._sortOriginalMappings(),this.__originalMappings}get _generatedMappingsUnsorted(){return this.__generatedMappingsUnsorted||this._parseMappings(this._mappings,this.sourceRoot),this.__generatedMappingsUnsorted}get _originalMappingsUnsorted(){return this.__originalMappingsUnsorted||this._parseMappings(this._mappings,this.sourceRoot),this.__originalMappingsUnsorted}_sortGeneratedMappings(){const e=this._generatedMappingsUnsorted;e.sort(si.compareByGeneratedPositionsDeflated),this.__generatedMappings=e}_sortOriginalMappings(){const e=this._originalMappingsUnsorted;e.sort(si.compareByOriginalPositions),this.__originalMappings=e}get sources(){const e=[];for(let n=0;n<this._sections.length;n++)for(let i=0;i<this._sections[n].consumer.sources.length;i++)e.push(this._sections[n].consumer.sources[i]);return e}originalPositionFor(e){const n={generatedLine:si.getArg(e,"line"),generatedColumn:si.getArg(e,"column")},i=MH.search(n,this._sections,function(s,a){const o=s.generatedLine-a.generatedOffset.generatedLine;return o||s.generatedColumn-a.generatedOffset.generatedColumn}),r=this._sections[i];return r?r.consumer.originalPositionFor({line:n.generatedLine-(r.generatedOffset.generatedLine-1),column:n.generatedColumn-(r.generatedOffset.generatedLine===n.generatedLine?r.generatedOffset.generatedColumn-1:0),bias:e.bias}):{source:null,line:null,column:null,name:null}}hasContentsOfAllSources(){return this._sections.every(function(e){return e.consumer.hasContentsOfAllSources()})}sourceContentFor(e,n){for(let i=0;i<this._sections.length;i++){const s=this._sections[i].consumer.sourceContentFor(e,!0);if(s)return s}if(n)return null;throw new Error('"'+e+'" is not in the SourceMap.')}generatedPositionFor(e){for(let n=0;n<this._sections.length;n++){const i=this._sections[n];if(i.consumer._findSourceIndex(si.getArg(e,"source"))===-1)continue;const r=i.consumer.generatedPositionFor(e);if(r)return{line:r.line+(i.generatedOffset.generatedLine-1),column:r.column+(i.generatedOffset.generatedLine===r.line?i.generatedOffset.generatedColumn-1:0)}}return{line:null,column:null}}_parseMappings(e,n){const i=this.__generatedMappingsUnsorted=[],r=this.__originalMappingsUnsorted=[];for(let s=0;s<this._sections.length;s++){const a=this._sections[s],o=[];a.consumer.eachMapping(c=>o.push(c));for(let c=0;c<o.length;c++){const l=o[c];let u=si.computeSourceURL(a.consumer.sourceRoot,null,this._sourceMapURL);this._sources.add(u),u=this._sources.indexOf(u);let h=null;l.name&&(this._names.add(l.name),h=this._names.indexOf(l.name));const d={source:u,generatedLine:l.generatedLine+(a.generatedOffset.generatedLine-1),generatedColumn:l.generatedColumn+(a.generatedOffset.generatedLine===l.generatedLine?a.generatedOffset.generatedColumn-1:0),originalLine:l.originalLine,originalColumn:l.originalColumn,name:h};i.push(d),typeof d.originalLine=="number"&&r.push(d)}}}eachMapping(e,n,i){const r=n||null,s=i||$o.GENERATED_ORDER;let a;switch(s){case $o.GENERATED_ORDER:a=this._generatedMappings;break;case $o.ORIGINAL_ORDER:a=this._originalMappings;break;default:throw new Error("Unknown order of iteration.")}const o=this.sourceRoot;a.map(function(c){let l=null;return c.source!==null&&(l=this._sources.at(c.source),l=si.computeSourceURL(o,l,this._sourceMapURL)),{source:l,generatedLine:c.generatedLine,generatedColumn:c.generatedColumn,originalLine:c.originalLine,originalColumn:c.originalColumn,name:c.name===null?null:this._names.at(c.name)}},this).forEach(e,r)}_findMapping(e,n,i,r,s,a){if(e[i]<=0)throw new TypeError("Line must be greater than or equal to 1, got "+e[i]);if(e[r]<0)throw new TypeError("Column must be greater than or equal to 0, got "+e[r]);return MH.search(e,n,s,a)}allGeneratedPositionsFor(e){const n=si.getArg(e,"line"),i={source:si.getArg(e,"source"),originalLine:n,originalColumn:si.getArg(e,"column",0)};if(i.source=this._findSourceIndex(i.source),i.source<0)return[];if(i.originalLine<1)throw new Error("Line numbers must be >= 1");if(i.originalColumn<0)throw new Error("Column numbers must be >= 0");const r=[];let s=this._findMapping(i,this._originalMappings,"originalLine","originalColumn",si.compareByOriginalPositions,MH.LEAST_UPPER_BOUND);if(s>=0){let a=this._originalMappings[s];if(e.column===void 0){const o=a.originalLine;for(;a&&a.originalLine===o;){let c=a.lastGeneratedColumn;this._computedColumnSpans&&c===null&&(c=1/0),r.push({line:si.getArg(a,"generatedLine",null),column:si.getArg(a,"generatedColumn",null),lastColumn:c}),a=this._originalMappings[++s]}}else{const o=a.originalColumn;for(;a&&a.originalLine===n&&a.originalColumn==o;){let c=a.lastGeneratedColumn;this._computedColumnSpans&&c===null&&(c=1/0),r.push({line:si.getArg(a,"generatedLine",null),column:si.getArg(a,"generatedColumn",null),lastColumn:c}),a=this._originalMappings[++s]}}}return r}destroy(){for(let e=0;e<this._sections.length;e++)this._sections[e].consumer.destroy()}}function Met(t,e){let n=t;typeof t=="string"&&(n=si.parseSourceMapInput(t));const i=n.sections!=null?new Ret(n,e):new Nk(n,e);return Promise.resolve(i)}function Oet(t,e){return Nk.fromSourceMap(t,e)}var l_e={};const Net=Zve.SourceMapGenerator,a2=Ok,Iet=/(\r?\n)/,ket=10,pw="$$$isSourceNode$$$";let Pet=class h${constructor(e,n,i,r,s){this.children=[],this.sourceContents={},this.line=e??null,this.column=n??null,this.source=i??null,this.name=s??null,this[pw]=!0,r!=null&&this.add(r)}static fromStringWithSourceMap(e,n,i){const r=new h$,s=e.split(Iet);let a=0;const o=function(){const f=g(),p=g()||"";return f+p;function g(){return a<s.length?s[a++]:void 0}};let c=1,l=0,u=null,h;return n.eachMapping(function(f){if(u!==null)if(c<f.generatedLine)d(u,o()),c++,l=0;else{h=s[a]||"";const p=h.substr(0,f.generatedColumn-l);s[a]=h.substr(f.generatedColumn-l),l=f.generatedColumn,d(u,p),u=f;return}for(;c<f.generatedLine;)r.add(o()),c++;l<f.generatedColumn&&(h=s[a]||"",r.add(h.substr(0,f.generatedColumn)),s[a]=h.substr(f.generatedColumn),l=f.generatedColumn),u=f},this),a<s.length&&(u&&d(u,o()),r.add(s.splice(a).join(""))),n.sources.forEach(function(f){const p=n.sourceContentFor(f);p!=null&&(i!=null&&(f=a2.join(i,f)),r.setSourceContent(f,p))}),r;function d(f,p){if(f===null||f.source===void 0)r.add(p);else{const g=i?a2.join(i,f.source):f.source;r.add(new h$(f.originalLine,f.originalColumn,g,p,f.name))}}}add(e){if(Array.isArray(e))e.forEach(function(n){this.add(n)},this);else if(e[pw]||typeof e=="string")e&&this.children.push(e);else throw new TypeError("Expected a SourceNode, string, or an array of SourceNodes and strings. Got "+e);return this}prepend(e){if(Array.isArray(e))for(let n=e.length-1;n>=0;n--)this.prepend(e[n]);else if(e[pw]||typeof e=="string")this.children.unshift(e);else throw new TypeError("Expected a SourceNode, string, or an array of SourceNodes and strings. Got "+e);return this}walk(e){let n;for(let i=0,r=this.children.length;i<r;i++)n=this.children[i],n[pw]?n.walk(e):n!==""&&e(n,{source:this.source,line:this.line,column:this.column,name:this.name})}join(e){let n,i;const r=this.children.length;if(r>0){for(n=[],i=0;i<r-1;i++)n.push(this.children[i]),n.push(e);n.push(this.children[i]),this.children=n}return this}replaceRight(e,n){const i=this.children[this.children.length-1];return i[pw]?i.replaceRight(e,n):typeof i=="string"?this.children[this.children.length-1]=i.replace(e,n):this.children.push("".replace(e,n)),this}setSourceContent(e,n){this.sourceContents[a2.toSetString(e)]=n}walkSourceContents(e){for(let i=0,r=this.children.length;i<r;i++)this.children[i][pw]&&this.children[i].walkSourceContents(e);const n=Object.keys(this.sourceContents);for(let i=0,r=n.length;i<r;i++)e(a2.fromSetString(n[i]),this.sourceContents[n[i]])}toString(){let e="";return this.walk(function(n){e+=n}),e}toStringWithSourceMap(e){const n={code:"",line:1,column:0},i=new Net(e);let r=!1,s=null,a=null,o=null,c=null;return this.walk(function(l,u){n.code+=l,u.source!==null&&u.line!==null&&u.column!==null?((s!==u.source||a!==u.line||o!==u.column||c!==u.name)&&i.addMapping({source:u.source,original:{line:u.line,column:u.column},generated:{line:n.line,column:n.column},name:u.name}),s=u.source,a=u.line,o=u.column,c=u.name,r=!0):r&&(i.addMapping({generated:{line:n.line,column:n.column}}),s=null,r=!1);for(let h=0,d=l.length;h<d;h++)l.charCodeAt(h)===ket?(n.line++,n.column=0,h+1===d?(s=null,r=!1):r&&i.addMapping({source:u.source,original:{line:u.line,column:u.column},generated:{line:n.line,column:n.column},name:u.name})):n.column++}),this.walkSourceContents(function(l,u){i.setSourceContent(l,u)}),{code:n.code,map:i}}};l_e.SourceNode=Pet;var Det=l_e.SourceNode;let Are=0;const Rre=o0,Let=["Command","lines"];class Uet extends I$e{constructor(){super(M0e,{traceInitPerf:o0,skipValidations:!o0,maxLookahead:2,recoveryEnabled:!0,nodeLocationTracking:"full"});fi(this,"program",this.RULED("program",()=>{this.MANY(()=>this.SUBRULE(this.line))}));fi(this,"line",this.RULED("line",()=>{this.OR([{ALT:()=>this.SUBRULE(this.stmt)},{ALT:()=>this.CONSUME(gA)}])}));fi(this,"stmt",this.RULED("stmt",()=>{this.OR([{ALT:()=>this.SUBRULE(this.stmt_label)},{ALT:()=>this.SUBRULE(this.stmt_stat)},{ALT:()=>this.SUBRULE(this.stmt_text)},{ALT:()=>this.SUBRULE(this.stmt_comment)},{ALT:()=>this.SUBRULE(this.stmt_hyperlink)},{ALT:()=>this.SUBRULE(this.stmt_command)},{ALT:()=>{this.AT_LEAST_ONE(()=>this.SUBRULE(this.short_commands)),this.MANY(()=>this.SUBRULE(this.commands))}}])}));fi(this,"inline",this.RULED("inline",()=>{this.SUBRULE(this.instmt)}));fi(this,"instmt",this.RULED("instmt",()=>{this.OR([{ALT:()=>this.SUBRULE(this.stmt_label)},{ALT:()=>this.SUBRULE(this.stmt_stat)},{ALT:()=>this.SUBRULE(this.stmt_text)},{ALT:()=>this.SUBRULE(this.stmt_comment)},{ALT:()=>this.SUBRULE(this.stmt_hyperlink)},{ALT:()=>this.SUBRULE(this.stmt_command)},{ALT:()=>this.AT_LEAST_ONE(()=>this.SUBRULE(this.commands))}])}));fi(this,"stmt_label",this.RULED("stmt_label",()=>{this.CONSUME(jN)}));fi(this,"stmt_stat",this.RULED("stmt_stat",()=>{this.CONSUME(p1)}));fi(this,"stmt_text",this.RULED("stmt_text",()=>{this.OR([{ALT:()=>this.CONSUME(FN)}])}));fi(this,"stmt_comment",this.RULED("stmt_comment",()=>{this.CONSUME(zN)}));fi(this,"stmt_hyperlink",this.RULED("stmt_hyperlink",()=>{this.CONSUME(HN),this.SUBRULE(this.words),this.CONSUME(DY)}));fi(this,"stmt_command",this.RULED("stmt_command",()=>{this.CONSUME(Zv),this.AT_LEAST_ONE(()=>this.SUBRULE(this.commands))}));fi(this,"short_commands",this.RULED("short_commands",()=>{this.OR([{ALT:()=>this.SUBRULE(this.short_go)},{ALT:()=>this.SUBRULE(this.short_try)}])}));fi(this,"commands",this.RULED("commands",()=>{this.OR([{ALT:()=>this.SUBRULE(this.words)},{ALT:()=>this.SUBRULE(this.short_go)},{ALT:()=>this.SUBRULE(this.short_try)},{ALT:()=>this.SUBRULE(this.command_play)},{ALT:()=>this.SUBRULE(this.command_toast)},{ALT:()=>this.SUBRULE(this.structured_cmd)}])}));fi(this,"structured_cmd",this.RULED("structured_cmd",()=>{this.OR([{ALT:()=>this.SUBRULE(this.command_if)},{ALT:()=>this.SUBRULE(this.command_while)},{ALT:()=>this.SUBRULE(this.command_repeat)},{ALT:()=>this.SUBRULE(this.command_waitfor)},{ALT:()=>this.SUBRULE(this.command_foreach)},{ALT:()=>this.SUBRULE(this.command_break)},{ALT:()=>this.SUBRULE(this.command_continue)}])}));fi(this,"short_go",this.RULED("short_go",()=>{this.CONSUME(BT),this.SUBRULE(this.words)}));fi(this,"short_try",this.RULED("short_try",()=>{this.CONSUME(VN),this.SUBRULE(this.words)}));fi(this,"command_if",this.RULED("command_if",()=>{this.CONSUME(FT),this.SUBRULE(this.words),this.OPTION(()=>this.SUBRULE(this.command_if_block))}));fi(this,"command_if_block",this.RULED("command_if_block",()=>{this.OR([{ALT:()=>this.SUBRULE(this.inline)},{ALT:()=>{this.CONSUME(zT),this.MANY(()=>this.SUBRULE(this.line)),this.MANY2({GATE:this.BACKTRACK(this.command_else_if),DEF:()=>this.SUBRULE(this.command_else_if)}),this.OPTION(()=>this.SUBRULE(this.command_else)),this.MANY3(()=>this.CONSUME3(gA)),this.CONSUME4(Zv),this.CONSUME4(z3)}}])}));fi(this,"command_block",this.RULED("command_block",()=>{this.OR([{ALT:()=>this.SUBRULE(this.inline)},{ALT:()=>{this.CONSUME(zT),this.MANY(()=>this.SUBRULE(this.line)),this.CONSUME(Zv),this.CONSUME(z3)}}])}));fi(this,"command_fork",this.RULED("command_fork",()=>{this.OR([{ALT:()=>this.SUBRULE(this.inline)},{ALT:()=>{this.CONSUME(zT),this.MANY({GATE:this.BACKTRACK(this.line),DEF:()=>this.SUBRULE(this.line)})}}])}));fi(this,"command_else_if",this.RULED("command_else_if",()=>{this.CONSUME(Zv),this.CONSUME(jT),this.CONSUME(FT),this.SUBRULE(this.words),this.OPTION(()=>this.SUBRULE(this.command_fork))}));fi(this,"command_else",this.RULED("command_else",()=>{this.CONSUME(Zv),this.CONSUME(jT),this.OPTION(()=>this.SUBRULE(this.command_fork))}));fi(this,"command_while",this.RULED("command_while",()=>{this.CONSUME(ZY),this.SUBRULE(this.words),this.OPTION(()=>this.SUBRULE(this.command_block))}));fi(this,"command_repeat",this.RULED("command_repeat",()=>{this.CONSUME(JY),this.SUBRULE(this.words),this.OPTION(()=>this.SUBRULE(this.command_block))}));fi(this,"command_waitfor",this.RULED("command_waitfor",()=>{this.CONSUME(QY),this.SUBRULE(this.words)}));fi(this,"command_foreach",this.RULED("command_foreach",()=>{this.CONSUME(eK),this.SUBRULE(this.words),this.OPTION(()=>this.SUBRULE(this.command_block))}));fi(this,"command_break",this.RULED("command_break",()=>{this.CONSUME(tK)}));fi(this,"command_continue",this.RULED("command_continue",()=>{this.CONSUME(nK)}));fi(this,"command_play",this.RULED("command_play",()=>{this.CONSUME(XY)}));fi(this,"command_toast",this.RULED("command_toast",()=>{this.CONSUME(A0e)}));fi(this,"expr",this.RULED("expr",()=>{this.SUBRULE1(this.and_test),this.MANY(()=>{this.CONSUME(D3),this.SUBRULE2(this.and_test)})}));fi(this,"and_test",this.RULED("and_test",()=>{this.SUBRULE1(this.not_test),this.MANY(()=>{this.CONSUME(U3),this.SUBRULE2(this.not_test)})}));fi(this,"not_test",this.RULED("not_test",()=>{this.OR([{ALT:()=>{this.CONSUME(L3),this.SUBRULE1(this.not_test)}},{ALT:()=>this.SUBRULE2(this.comparison)}])}));fi(this,"comparison",this.RULED("comparison",()=>{this.SUBRULE1(this.arith_expr),this.MANY(()=>{this.SUBRULE(this.comp_op),this.SUBRULE2(this.arith_expr)})}));fi(this,"comp_op",this.RULED("comp_op",()=>{this.OR([{ALT:()=>this.CONSUME(BY)},{ALT:()=>this.CONSUME(FY)},{ALT:()=>this.CONSUME(zY)},{ALT:()=>this.CONSUME(jY)},{ALT:()=>this.CONSUME(HY)},{ALT:()=>this.CONSUME(VY)}])}));fi(this,"expr_value",this.RULED("expr_value",()=>{this.SUBRULE1(this.and_test_value),this.MANY(()=>{this.CONSUME(D3),this.SUBRULE2(this.and_test_value)})}));fi(this,"and_test_value",this.RULED("and_test_value",()=>{this.SUBRULE1(this.not_test_value),this.MANY(()=>{this.CONSUME(U3),this.SUBRULE2(this.not_test_value)})}));fi(this,"not_test_value",this.RULED("not_test_value",()=>{this.OR([{ALT:()=>{this.CONSUME(L3),this.SUBRULE1(this.not_test_value)}},{ALT:()=>this.SUBRULE2(this.arith_expr)}])}));fi(this,"arith_expr",this.RULED("arith_expr",()=>{this.SUBRULE1(this.term),this.MANY(()=>this.SUBRULE2(this.arith_expr_item))}));fi(this,"arith_expr_item",this.RULED("arith_expr_item",()=>{this.OR([{ALT:()=>this.CONSUME(B3)},{ALT:()=>this.CONSUME(F3)}]),this.SUBRULE(this.term)}));fi(this,"term",this.RULED("term",()=>{this.SUBRULE1(this.factor),this.MANY(()=>this.SUBRULE2(this.term_item))}));fi(this,"term_item",this.RULED("term_item",()=>{this.OR([{ALT:()=>this.CONSUME(qY)},{ALT:()=>this.CONSUME(BT)},{ALT:()=>this.CONSUME($Y)},{ALT:()=>this.CONSUME(WY)}]),this.SUBRULE(this.factor)}));fi(this,"factor",this.RULED("factor",()=>{this.OR1([{ALT:()=>{this.OR2([{ALT:()=>this.CONSUME(B3)},{ALT:()=>this.CONSUME(F3)}]),this.SUBRULE(this.factor)}},{ALT:()=>this.SUBRULE(this.power)}])}));fi(this,"power",this.RULED("power",()=>{this.SUBRULE(this.token),this.OPTION(()=>{this.CONSUME(GY),this.SUBRULE(this.factor)})}));fi(this,"words",this.RULED("words",()=>{this.AT_LEAST_ONE(()=>this.SUBRULE(this.expr))}));fi(this,"token",this.RULED("token",()=>{this.OR([{ALT:()=>this.CONSUME(LY)},{ALT:()=>this.CONSUME(Ol)},{ALT:()=>this.CONSUME(UY)},{ALT:()=>{this.CONSUME(YY),this.SUBRULE(this.words),this.CONSUME(KY)}}])}));this.performSelfAnalysis()}PEEK(n,i,...r){console.info(n,r.map(s=>[s.image,s.tokenType]),i)}RULED(n,i,r){const s=Let.some(a=>n.includes(a));return this.RULE(n,()=>{const o=(Are++).toString().padStart(3),c=s?"font-weight: bold;":"";if(Rre&&!this.RECORDING_PHASE){const l=[this.LA(1),this.LA(2),this.LA(3)].map(u=>`[${u.tokenType.name} ${u.image.replaceAll(`
`,"\\n")}]`);console.info(`${o}%c> ${n} ${l.join(" ")}`,c)}i(),Rre&&!this.RECORDING_PHASE&&console.info(`${o}%c< ${n} `,c),Are--},r)}}const tC=new Uet;if(q$e){const t=tC.getGAstProductions(),e=G$e(t);console.info(e)}const Bet=tC.getBaseCstVisitorConstructor();var mn=(t=>(t[t.PROGRAM=0]="PROGRAM",t[t.API=1]="API",t[t.LINE=2]="LINE",t[t.MARK=3]="MARK",t[t.GOTO=4]="GOTO",t[t.COUNT=5]="COUNT",t[t.TEXT=6]="TEXT",t[t.LABEL=7]="LABEL",t[t.HYPERLINK=8]="HYPERLINK",t[t.STAT=9]="STAT",t[t.MOVE=10]="MOVE",t[t.COMMAND=11]="COMMAND",t[t.LITERAL=12]="LITERAL",t[t.IF=13]="IF",t[t.IF_CHECK=14]="IF_CHECK",t[t.IF_BLOCK=15]="IF_BLOCK",t[t.ELSE_IF=16]="ELSE_IF",t[t.ELSE=17]="ELSE",t[t.WHILE=18]="WHILE",t[t.BREAK=19]="BREAK",t[t.CONTINUE=20]="CONTINUE",t[t.REPEAT=21]="REPEAT",t[t.WAITFOR=22]="WAITFOR",t[t.FOREACH=23]="FOREACH",t[t.OR=24]="OR",t[t.AND=25]="AND",t[t.NOT=26]="NOT",t[t.COMPARE=27]="COMPARE",t[t.COMPARE_ITEM=28]="COMPARE_ITEM",t[t.OPERATOR=29]="OPERATOR",t[t.OPERATOR_ITEM=30]="OPERATOR_ITEM",t[t.EXPR=31]="EXPR",t))(mn||{}),aT=(t=>(t[t.IS_EQ=0]="IS_EQ",t[t.IS_NOT_EQ=1]="IS_NOT_EQ",t[t.IS_LESS_THAN=2]="IS_LESS_THAN",t[t.IS_GREATER_THAN=3]="IS_GREATER_THAN",t[t.IS_LESS_THAN_OR_EQ=4]="IS_LESS_THAN_OR_EQ",t[t.IS_GREATER_THAN_OR_EQ=5]="IS_GREATER_THAN_OR_EQ",t))(aT||{}),Rg=(t=>(t[t.EMPTY=0]="EMPTY",t[t.PLUS=1]="PLUS",t[t.MINUS=2]="MINUS",t[t.POWER=3]="POWER",t[t.MULTIPLY=4]="MULTIPLY",t[t.DIVIDE=5]="DIVIDE",t[t.MOD_DIVIDE=6]="MOD_DIVIDE",t[t.FLOOR_DIVIDE=7]="FLOOR_DIVIDE",t[t.UNI_PLUS=8]="UNI_PLUS",t[t.UNI_MINUS=9]="UNI_MINUS",t))(Rg||{}),pL=(t=>(t[t.NUMBER=0]="NUMBER",t[t.STRING=1]="STRING",t[t.TEMPLATE=2]="TEMPLATE",t))(pL||{});function Vf(t,e){const[n]=t??[];return((n==null?void 0:n.image)??e).trimStart().replaceAll(/^"|"$/g,"")}class Fet extends Bet{constructor(){super();fi(this,"unique",0);o0&&this.validateVisitor()}visit(n){if(ji(n)&&(n=n[0]),!!re(n))return this[n.name](n.children,n.location)}createcodenode(n,i){return[{...i,...n,lineindex:0}]}createstringnode(n,i){return this.createcodenode(n,{type:12,literal:1,value:i})}createmarknode(n,i,r){return this.createlinenode(n,this.createcodenode(n,{type:3,id:i,comment:r}))}creategotonode(n,i,r){return this.createlinenode(n,this.createcodenode(n,{type:4,id:i,comment:r}))}createlinenode(n,i){return this.createcodenode(n,{type:2,stmts:i})}createapinode(n,i,r){return this.createlinenode(n,this.createcodenode(n,{type:1,words:r,method:i}))}createlogicnode(n,i,r,s){return this.createlinenode(n,this.createcodenode(n,{type:14,skip:r,words:s,method:i}))}createcountnode(n){return this.createcodenode(n,{type:5,index:this.unique++})}go(n){return Array.isArray(n)?n.map(i=>this.visit(i)).flat():re(n)?[this.visit(n)].flat():[]}program(n,i){return this.unique=0,this.createcodenode(i,{type:0,lines:[this.createlinenode(i,this.createcodenode(i,{type:7,active:!0,name:"restart"})),this.go(n.line)].flat()})}line(n){return n.stmt?this.go(n.stmt):[]}stmt(n){return n.stmt_label?this.go(n.stmt_label):n.stmt_stat?this.go(n.stmt_stat):n.stmt_text?this.go(n.stmt_text):n.stmt_comment?this.go(n.stmt_comment):n.stmt_command?this.go(n.stmt_command):n.stmt_hyperlink?this.go(n.stmt_hyperlink):n.short_commands?[this.go(n.short_commands),this.go(n.commands)].flat():[]}inline(n){return this.go(n.instmt)}instmt(n){return n.stmt_label?this.go(n.stmt_label):n.stmt_stat?this.go(n.stmt_stat):n.stmt_text?this.go(n.stmt_text):n.stmt_comment?this.go(n.stmt_comment):n.stmt_command?this.go(n.stmt_command):n.stmt_hyperlink?this.go(n.stmt_hyperlink):n.commands?this.go(n.commands):[]}stmt_label(n,i){return this.createlinenode(i,this.createcodenode(i,{type:7,active:!0,name:Vf(n.token_label,":").slice(1).trim()}))}stmt_stat(n,i){return this.createlinenode(i,this.createcodenode(i,{type:9,value:Vf(n.token_stat,"@").slice(1)}))}stmt_text(n,i){return this.createlinenode(i,this.createcodenode(i,{type:6,value:Vf(n.token_text,"")}))}stmt_comment(n,i){return this.createlinenode(i,this.createcodenode(i,{type:7,active:!1,name:Vf(n.token_comment,"'").slice(1).trim()}))}stmt_hyperlink(n,i){return this.createlinenode(i,this.createcodenode(i,{type:8,link:this.go(n.words),text:Vf(n.token_hyperlinktext,";").slice(1)}))}stmt_command(n){return n.commands?this.go(n.commands):[]}short_commands(n){return n.short_go?this.go(n.short_go):n.short_try?this.go(n.short_try):[]}commands(n,i){return n.words?this.createlinenode(i,this.createcodenode(i,{type:11,words:this.go(n.words)})):n.short_go?this.go(n.short_go):n.short_try?this.go(n.short_try):n.command_play?this.go(n.command_play):n.command_toast?this.go(n.command_toast):n.structured_cmd?this.go(n.structured_cmd):[]}structured_cmd(n){return n.command_if?this.go(n.command_if):n.command_while?this.go(n.command_while):n.command_repeat?this.go(n.command_repeat):n.command_waitfor?this.go(n.command_waitfor):n.command_foreach?this.go(n.command_foreach):n.command_break?this.go(n.command_break):n.command_continue?this.go(n.command_continue):[]}short_go(n,i){return n.token_divide?this.createlinenode(i,this.createcodenode(i,{type:10,wait:!0,words:this.go(n.words)})):[]}short_try(n,i){return n.token_query?this.createlinenode(i,this.createcodenode(i,{type:10,wait:!1,words:this.go(n.words)})):[]}command_if(n,i){const[r]=this.createlogicnode(i,Vf(n.token_if,"if"),"",this.go(n.words)),[s]=this.go(n.command_if_block)??[];return this.createcodenode(i,{type:13,check:r,block:s})}command_if_block(n,i){const r=wo(),s=wo();return this.createcodenode(i,{type:15,skip:r,done:s,lines:[this.go(n.inline),this.go(n.line),this.creategotonode(i,s,"end of if"),this.createmarknode(i,r,"alt logic")].flat(),altlines:[this.go(n.command_else_if),this.go(n.command_else),this.createmarknode(i,s,"end of if")].flat()})}command_block(n){return[this.go(n.inline),this.go(n.line)].flat()}command_fork(n){return[this.go(n.inline),this.go(n.line)].flat()}command_else_if(n,i){const r=wo(),s=wo();return this.createcodenode(i,{type:16,done:s,lines:[this.createlogicnode(i,Vf(n.token_if,"if"),r,this.go(n.words)),this.go(n.command_fork),this.creategotonode(i,s,"end of if"),this.createmarknode(i,r,"skip")].flat()})}command_else(n,i){return this.createcodenode(i,{type:17,lines:this.go(n.command_fork)})}command_while(n,i){const r=wo(),s=wo();return this.createcodenode(i,{type:18,loop:r,done:s,lines:[this.createmarknode(i,r,"start of while"),this.createlogicnode(i,"if",s,this.go(n.words)),this.go(n.command_block),this.creategotonode(i,r,"loop of while"),this.createmarknode(i,s,"end of while")].flat()})}command_repeat(n,i){const r=wo(),s=wo(),o=[this.createcountnode(i),this.go(n.words)].flat();return this.createcodenode(i,{type:21,loop:r,done:s,lines:[this.createapinode(i,"repeatstart",o),this.createmarknode(i,r,"start of repeat"),this.createlogicnode(i,"repeat",s,o),this.go(n.command_block),this.creategotonode(i,r,"loop of repeat"),this.createmarknode(i,s,"end of repeat")].flat()})}command_foreach(n,i){const r=wo(),s=wo(),o=[this.createcountnode(i),this.go(n.words)].flat();return this.createcodenode(i,{type:23,loop:r,done:s,lines:[this.createapinode(i,"foreachstart",o),this.createmarknode(i,r,"start of foreach"),this.createlogicnode(i,"foreach",s,o),this.go(n.command_block),this.creategotonode(i,r,"loop of foreach"),this.createmarknode(i,s,"end of foreach")].flat()})}command_waitfor(n,i){const r=wo();return this.createcodenode(i,{type:22,loop:r,lines:[this.createmarknode(i,r,"start of waitfor"),this.createlogicnode(i,"waitfor",r,this.go(n.words))].flat()})}command_break(n,i){return this.createcodenode(i,{type:19,goto:0})}command_continue(n,i){return this.createcodenode(i,{type:20,goto:0})}command_play(n,i){const r=Vf(n.token_command_play,""),s=r.replace("bgplay","").replace("play","").trim(),a=r.includes("bgplay");return this.createlinenode(i,this.createcodenode(i,{type:11,words:[this.createstringnode(i,a?"bgplay":"play"),this.createstringnode(i,s)].flat()}))}command_toast(n,i){const s=Vf(n.token_command_toast,"").replace("toast","").trim();return this.createlinenode(i,this.createcodenode(i,{type:11,words:[this.createstringnode(i,"toast"),this.createstringnode(i,s)].flat()}))}expr(n,i){return n.and_test.length===1?this.go(n.and_test):this.createcodenode(i,{type:24,items:this.go(n.and_test)})}and_test(n,i){return n.not_test.length===1?this.go(n.not_test):this.createcodenode(i,{type:25,items:this.go(n.not_test)})}not_test(n,i){return n.comparison?this.go(n.comparison):n.not_test?this.createcodenode(i,{type:26,items:this.go(n.not_test)}):[]}comparison(n,i){if(n.arith_expr.length===1)return this.go(n.arith_expr);const[r,s]=this.go(n.arith_expr),[a]=this.go(n.comp_op);return this.createcodenode(i,{type:27,lhs:r,compare:a,rhs:s})}comp_op(n,i){return n.token_iseq?this.createcodenode(i,{type:28,method:0}):n.token_isnoteq?this.createcodenode(i,{type:28,method:1}):n.token_islessthan?this.createcodenode(i,{type:28,method:2}):n.token_isgreaterthan?this.createcodenode(i,{type:28,method:3}):n.token_islessthanorequal?this.createcodenode(i,{type:28,method:4}):n.token_isgreaterthanorequal?this.createcodenode(i,{type:28,method:5}):[]}expr_value(n,i){return n.and_test_value.length===1?this.go(n.and_test_value):this.createcodenode(i,{type:24,items:this.go(n.and_test_value)})}and_test_value(n,i){return n.not_test_value.length===1?this.go(n.not_test_value):this.createcodenode(i,{type:25,items:this.go(n.not_test_value)})}not_test_value(n,i){return n.arith_expr?this.go(n.arith_expr):n.not_test_value?this.createcodenode(i,{type:26,items:this.go(n.not_test_value)}):[]}arith_expr(n,i){const r=this.go(n.term);return n.arith_expr_item?this.createcodenode(i,{type:29,lhs:r[0],items:this.go(n.arith_expr_item)}):r}arith_expr_item(n,i){return this.createcodenode(i,{type:30,operator:n.token_plus?1:2,rhs:this.go(n.term)[0]})}term(n,i){return n.term_item?this.createcodenode(i,{type:29,lhs:this.go(n.factor)[0],items:this.go(n.term_item)}):this.go(n.factor)}term_item(n,i){let r=0;return n.token_multiply&&(r=4),n.token_divide&&(r=5),n.token_moddivide&&(r=6),n.token_floordivide&&(r=7),this.createcodenode(i,{type:30,operator:r,rhs:this.go(n.factor)[0]})}factor(n,i){if(n.power)return this.go(n.power);let r=0;return n.token_plus&&(r=8),n.token_minus&&(r=9),this.createcodenode(i,{type:29,lhs:void 0,items:this.createcodenode(i,{type:30,operator:r,rhs:this.go(n.factor)[0]})})}power(n,i){const r=this.go(n.token);return n.factor?this.createcodenode(i,{type:29,lhs:r[0],items:this.createcodenode(i,{type:30,operator:3,rhs:this.go(n.factor)[0]})}):r}words(n){return this.go(n.expr)}token(n,i){if(n.token_stringliteraldouble){const r=Vf(n.token_stringliteraldouble,"").replaceAll(/(^"|"$)/g,"");return this.createcodenode(i,{type:12,literal:2,value:r})}if(n.token_stringliteral){const r=Vf(n.token_stringliteral,"").replaceAll(/(^"|"$)/g,"");return this.createcodenode(i,{type:12,literal:1,value:r})}if(n.token_numberliteral){const r=parseFloat(Vf(n.token_numberliteral,"0"));return this.createcodenode(i,{type:12,literal:0,value:r})}return n.token_lparen?this.createcodenode(i,{type:31,words:this.go(n.words)}):[]}}const zet=new Fet,rd={labels:{},internal:0,lineindex:0,linelookup:{},isfirststat:!1},A4="zss.js";function Lr(t,e){return new Det(t.startLine??1,t.startColumn??1,A4,e)}function d$(t){return t.replace(/\\/g,"\\\\").replace(/'/g,"\\'")}function OH(t){return`'${d$(t)}'`}function mL(t){if(t.startsWith('"'))return mL(t.replaceAll(/(^"|"$)/g,""));const e=O4(t);return e.errors.length?t:`['${e.tokens.map(i=>i.tokenType===LK?`', api.get('${d$(i.image.substring(1))}'), '`:d$(i.image)).join("")}'].join('')`}function mw(t){return t.filter(e=>e!==void 0).map(os)}function Mre(t){return Lr(t,"")}function jet(t,e){const n=[];return t.forEach(i=>{n.push(i,e)}),n.pop(),n}function Fc(t,e,n){return Lr(t,[`api.${e}(`,...jet(n,", "),")"])}function Het(t){if(t.type===mn.COMPARE&&t.compare.type===mn.COMPARE_ITEM)switch(t.compare.method){case aT.IS_EQ:return Fc(t,"isEq",[os(t.lhs),os(t.rhs)]);case aT.IS_NOT_EQ:return Fc(t,"isNotEq",[os(t.lhs),os(t.rhs)]);case aT.IS_LESS_THAN:return Fc(t,"isLessThan",[os(t.lhs),os(t.rhs)]);case aT.IS_GREATER_THAN:return Fc(t,"isGreaterThan",[os(t.lhs),os(t.rhs)]);case aT.IS_LESS_THAN_OR_EQ:return Fc(t,"isLessThanOrEq",[os(t.lhs),os(t.rhs)]);case aT.IS_GREATER_THAN_OR_EQ:return Fc(t,"isGreaterThanOrEq",[os(t.lhs),os(t.rhs)])}return Lr(t,"")}function $S(t,e,n){return t.prepend(`api.${e}(`),t.add([", ",os(n),")"])}function Ore(t,e,n){return t.prepend(`api.${e}(`),t.add([os(n),")"])}function Vet(t,e){if(t.type===mn.OPERATOR_ITEM)switch(t.operator){case Rg.PLUS:return $S(e,"opPlus",t.rhs);case Rg.MINUS:return $S(e,"opMinus",t.rhs);case Rg.POWER:return $S(e,"opPower",t.rhs);case Rg.MULTIPLY:return $S(e,"opMultiply",t.rhs);case Rg.DIVIDE:return $S(e,"opDivide",t.rhs);case Rg.MOD_DIVIDE:return $S(e,"opModDivide",t.rhs);case Rg.FLOOR_DIVIDE:return $S(e,"opFloorDivide",t.rhs);case Rg.UNI_PLUS:return Ore(e,"opUniPlus",t.rhs);case Rg.UNI_MINUS:return Ore(e,"opUniMinus",t.rhs)}return Lr(t,"")}function Get(t){if(t.type===mn.OPERATOR){const e=t.lhs?os(t.lhs):Lr(t,"");return t.items.forEach(n=>Vet(n,e)),e}return Lr(t,"")}function o2(t,e){return Lr(t,[Fc(t,"jump",[`${e}`]),"; continue;"])}function Lv(t){return rd.linelookup[t??""]??-1}function f$(t,e){rd.linelookup[t]=e}function Nw(t,e,n){for(let i=0;i<t.length;++i){const r=t[i];switch(r.type){case mn.WHILE:case mn.REPEAT:case mn.FOREACH:case mn.ELSE_IF:r.type===e&&(r.done=n);break;case mn.IF_BLOCK:case mn.IF_CHECK:r.type===e&&(r.skip=n);break;case mn.LINE:Nw(r.stmts,e,n);break}}}function u_e(t,e,n){for(let i=0;i<t.length;++i){const r=t[i];switch(r.type){case mn.WHILE:case mn.REPEAT:case mn.FOREACH:case mn.ELSE_IF:r.type===e&&f$(r.done,n);break;case mn.IF_BLOCK:case mn.IF_CHECK:r.type===e&&f$(r.skip,n);break;case mn.LINE:u_e(r.stmts,e,n);break}}}function os(t){var e;switch(t.type){case mn.PROGRAM:return Lr(t,[`try { // first-line
`,`while (true) {
`,`if (api.sy()) { yield 1; }
`,`switch (api.getcase()) {
`,...t.lines.map(os).flat(),`default:
`,`  api.endofprogram();
`,`  while (api.hm() === 0) { yield 1; };
`,`  continue;
`,`}
`,`api.nextcase();
`,`} // end of logic
`,`} catch (e) {
`,`console.error(e);
`,`const source = api.stacktrace(e);
`,`const err = new Error(e.message);
`,`err.name = 'GameError';
`,`err.meta = { line: source.line, column: source.column };
`,`throw err;
`,`}
`,`//# sourceURL=${A4}`]);case mn.API:return Lr(t,["  ",Fc(t,t.method,mw(t.words)),`;
`]);case mn.LINE:return Lr(t,[`case ${t.lineindex}:
`,...t.stmts.map(os).flat(),`  break;
`]);case mn.MARK:return Lr(t,`  // ${t.comment}
`);case mn.GOTO:{const n=Lv(t.id);return Lr(t,["  ",o2(t,n),`
`])}case mn.COUNT:return Lr(t,`${t.index}`);case mn.LITERAL:switch(t.literal){case pL.NUMBER:return Lr(t,`${t.value}`);case pL.STRING:return Lr(t,OH(t.value));case pL.TEMPLATE:return Lr(t,mL(t.value))}return Mre(t);case mn.TEXT:return Lr(t,["  ",Fc(t,"text",[mL(t.value)]),`;
`]);case mn.STAT:if(rd.isfirststat){rd.isfirststat=!1;const n=t.value.trim().split(" ").map(OH);return Lr(t,["  ",Fc(t,"stat",n),`;
`])}return Lr(t,`  // skipped ${t.value}
`);case mn.LABEL:{const n=Wn(t.name),i=t.active?"label":"comment";rd.labels[n]||(rd.labels[n]=[]);const r=(t.active?1:-1)*t.lineindex;return rd.labels[n].push(r),Lr(t,`  // ${r} '${n}' ${i}
`)}case mn.HYPERLINK:return Lr(t,["  ",Fc(t,"hyperlink",[mL(t.text),...mw(t.link)]),`;
`]);case mn.MOVE:{const n=Fc(t,"command",[OH("go"),mw(t.words)].flat());return t.wait?Lr(t,["  if (",n,`) { continue; };
`]):Lr(t,["  ",n,`;
`])}case mn.COMMAND:return Lr(t,["  if (",Fc(t,"command",mw(t.words)),`) { continue; };
`]);case mn.IF:{const n=((e=t.block)==null?void 0:e.type)===mn.IF_BLOCK?t.block:void 0;if(re(n)){Nw([t.check],mn.IF_CHECK,n.skip);const i=Lr(t,os(t.check));return n.lines.forEach(r=>i.add(os(r))),u_e(n.altlines,mn.ELSE_IF,Lv(n.done)),n.altlines.forEach(r=>i.add(os(r))),i}return Lr(t,os(t.check))}case mn.IF_CHECK:{const n=Lv(t.skip);return n===-1?Lr(t,["  ",Fc(t,t.method,mw(t.words)),`;
`]):Lr(t,["  if (!",Fc(t,t.method,mw(t.words)),") { ",o2(t,n),` }
`])}case mn.ELSE_IF:case mn.ELSE:{const n=Lr(t,"");return t.lines.forEach(i=>n.add(os(i))),n}case mn.WHILE:{const n=Lv(t.loop),i=Lv(t.done),r=Lr(t,"");return Nw(t.lines,mn.IF_CHECK,t.done),t.lines.forEach(s=>{switch(s.type){case mn.BREAK:s.goto=i;break;case mn.CONTINUE:s.goto=n;break}r.add(os(s))}),r}case mn.REPEAT:{const n=Lv(t.loop),i=Lv(t.done),r=Lr(t,"");return Nw(t.lines,mn.IF_CHECK,t.done),t.lines.forEach(s=>{switch(s.type){case mn.BREAK:s.goto=i;break;case mn.CONTINUE:s.goto=n;break}r.add(os(s))}),r}case mn.WAITFOR:{const n=Lr(t,"");return Nw(t.lines,mn.IF_CHECK,t.loop),t.lines.forEach(i=>{n.add(os(i))}),n}case mn.FOREACH:{const n=Lv(t.loop),i=Lv(t.done),r=Lr(t,"");return Nw(t.lines,mn.IF_CHECK,t.done),t.lines.forEach(s=>{switch(s.type){case mn.BREAK:s.goto=i;break;case mn.CONTINUE:s.goto=n;break}r.add(os(s))}),r}case mn.BREAK:return Lr(t,["  ",o2(t,t.goto),`
`]);case mn.CONTINUE:return Lr(t,["  ",o2(t,t.goto),`
`]);case mn.OR:return Fc(t,"or",t.items.map(os));case mn.AND:return Fc(t,"and",t.items.map(os));case mn.NOT:return Fc(t,"not",t.items.map(os));case mn.COMPARE:return Het(t);case mn.OPERATOR:return Get(t);case mn.EXPR:return Fc(t,"expr",t.words.map(os));default:return console.error("<unsupported node>",t.type,t),Mre(t)}}function Mg(t){if(re(t))switch(t.type===mn.LINE&&++rd.lineindex,t.lineindex=rd.lineindex,t.type){case mn.PROGRAM:t.lines.forEach(Mg);break;case mn.LINE:t.stmts.forEach(Mg);break;case mn.MARK:f$(t.id,t.lineindex);break;case mn.IF:Mg(t.check),Mg(t.block);break;case mn.IF_BLOCK:t.lines.forEach(Mg),t.altlines.forEach(Mg);break;case mn.ELSE_IF:t.lines.forEach(Mg);break;case mn.ELSE:case mn.WHILE:case mn.REPEAT:case mn.FOREACH:case mn.WAITFOR:t.lines.forEach(Mg);break;case mn.MOVE:case mn.COMMAND:case mn.IF_CHECK:t.words.forEach(Mg);break}}function h_e(t){rd.labels={},rd.internal=1,rd.lineindex=0,rd.isfirststat=!0,Mg(t)}function qet(t){return h_e(t),{...os(t).toStringWithSourceMap({file:`${A4}.map`}),...rd}}function Nre(t){return ji(t)?t.length>0?1:0:t??0}function $et(t){return`${t}_chip`}function d_e(t=""){return`vm:${t??""}`}function Wet(t,e,n){var l,u;const i=$et(t),r=T1(i);let s;const a=ro(Object.entries(n.labels??{}));(!ji(r.lb)||r.lb.length!==a.length)&&(r.lb=a,r.lk="",r.mg=void 0,r.ec=1,r.lc=0,r.ys=0,r.ps=0,r.es=(((l=n.errors)==null?void 0:l.length)??0)!==0?1:0);function o(h,d){ie.words=d;const f=oet(e,h);return re(f)?f(c,d):h!=="send"?o("send",[h,...d]):0}const c={halt(){Jet(i)},id(){return t},set(h,d){const[f,p]=uet(e,c,h,d);if(f)return p},get(h){const[d,f]=cet(e,c,h);if(d)return f},tick(h){const d=an(r.ps)?r.ps:0,f=d%h===0;if(r.ps=d+1,f===!1)return!1;if(c.shouldtick()===!1)return wre(e,c),!1;r.lc=0,r.ys=0,ie.get=c.get,het(e,c);try{const p=s==null?void 0:s.next();p!=null&&p.done&&(r.es=1)}catch(p){Mi(Ye,ie.elementfocus,"crash",p.message),r.es=1}return wre(e,c),!0},isended(){return r.es===1},isfirstpulse(){return r.ps===1},shouldtick(){return r.es===0||c.hm()!==0},shouldhalt(){return an(r.lc)?++r.lc>Kt.HALT_AT_COUNT:!0},hm(){if(ji(r.mg)&&ji(r.lb)){const[h]=r.mg;if(re(h))for(let d=0;d<r.lb.length;++d){const[f,p]=r.lb[d];if(f===h)return p.find(g=>an(g)&&g>0)??0}}return 0},yield(){r.ys=1},jump(h){r.ec=h},sy(){return!!r.ys||c.shouldhalt()},send(h,d,f,p){Ye.emit(h,`${d_e(d)}:${f}`,p)},lock(h){r.lk=h},unlock(){r.lk=""},message(h){r.lk&&h.sender!==r.lk||(r.mg=[h.target,h.data,h.sender,h.player])},zap(h){if(ji(r.lb))for(let d=0;d<r.lb.length;++d){const[f,p]=r.lb[d];if(f===h){const g=p.findIndex(_=>_>0);g>=0&&(p[g]*=-1)}}},restore(h){if(ji(r.lb))for(let d=0;d<r.lb.length;++d){const[f,p]=r.lb[d];if(f===h)for(let g=0;g<p.length;g++)p[d]=Math.abs(p[d])}},getcase(){r.ec=an(r.ec)?r.ec:1;const h=c.hm();if(h&&ji(r.mg)){const[,d,f,p]=r.mg;c.set("sender",f),re(d)&&c.set("arg",d),p&&(c.set("player",p),ie.elementfocus=p),r.mg=void 0,r.ys=0,r.es=0,r.ec=h}return r.ec},nextcase(){const h=an(r.ec)?r.ec:1;return r.ec=h+1,r.ec},endofprogram(){c.yield(),r.es=1},stacktrace(h){const d=TWe.parse(h),[f]=d.filter(p=>p.fileName===A4);return{line:(f==null?void 0:f.lineNumber)??0,column:(f==null?void 0:f.columnNumber)??0}},text(h){return o("text",[h])},stat(...h){return o("stat",h)},hyperlink(...h){return o("hyperlink",h)},command(...h){if(h.length===0)return 0;const[d,...f]=h;return o(Wn(ca(d)),f)},if(...h){const[d,f]=Rt(h,0,[Ke.ANY]),p=Nre(d);return p&&f<h.length&&c.command(...h.slice(f)),p?1:0},try(...h){const[,d]=Rt(h,0,[Ke.DIR]),f=c.command("go",...h);return f&&d<h.length&&c.command(...h.slice(d)),f?1:0},take(...h){const[d,f,p]=Rt(h,0,[Ke.NAME,Ke.ANY]),g=an(f),_=g?p:1,v=c.get(d),b=g?f:1;if(!an(v))return _<h.length&&c.command(...h.slice(_)),1;const S=v-b;return S<0?(_<h.length&&c.command(...h.slice(_)),1):(c.set(d,S),0)},give(...h){const[d,f,p]=Rt(h,0,[Ke.NAME,Ke.ANY]),g=an(f),_=g?p:1,v=c.get(d),b=g?f:1,S=v===void 0?1:0;return S&&_<h.length&&c.command(...h.slice(_)),c.set(d,xT(v,0)+b),S},repeatstart(h,...d){const[f,p]=Rt(d,0,[Ke.NUMBER]),g=`repeatcount${h}`,_=`repeatwords${h}`;r[g]=f,r[_]=p<d.length?d.slice(p):void 0},repeat(h){const d=`repeatcount${h}`,f=`repeatwords${h}`;if(!an(r[d]))return 0;const p=r[d];r[d]=p-1;const g=p>0,_=r[f];return g&&ji(_)&&c.command(..._),g?1:0},foreachstart(h,...d){const[f,p,g,_]=Rt(d,0,[Ke.NAME,Ke.NUMBER,Ke.NUMBER,Ke.MAYBE_NUMBER]);let v=Math.min(p,g),b=Math.max(p,g);const S=(_??0)||1;if(S<0){const x=v;v=b,b=x}return c.set(f,v-S),0},foreach(h,...d){const[f,p,g,_,v]=Rt(d,0,[Ke.NAME,Ke.NUMBER,Ke.NUMBER,Ke.MAYBE_NUMBER]);let b=Math.min(p,g),S=Math.max(p,g);const x=(_??0)||1;if(x<0){const I=b;b=S,S=I}let M=c.get(f);!an(M)||M<b||M>S?M=b:M+=x;const R=M<=S?1:0;return R&&(c.set(f,M),v<d.length&&c.command(...d.slice(v))),R},waitfor(...h){const[d]=Rt(h,0,[Ke.ANY]),f=Nre(d);return f||c.yield(),f?1:0},or(...h){let d=0;for(let f=0;f<h.length;){const[p,g]=Rt(h,f,[Ke.ANY]);if(d=p,d)break;f=g}return d},and(...h){let d=0;for(let f=0;f<h.length;){const[p,g]=Rt(h,f,[Ke.ANY]);if(d=p,!d)break;f=g}return d},not(...h){const[d]=Rt(h,0,[Ke.ANY]);return d?0:1},expr(h){return h},isEq(h,d){const[f]=Rt([h],0,[Ke.ANY]),[p]=Rt([d],0,[Ke.ANY]);return typeof f=="object"||typeof p=="object"?hT(f,p)?1:0:f===p?1:0},isNotEq(h,d){return this.isEq(h,d)?0:1},isLessThan(h,d){const[f]=Rt([h],0,[Ke.NUMBER]),[p]=Rt([d],0,[Ke.NUMBER]);return f<p?1:0},isGreaterThan(h,d){const[f]=Rt([h],0,[Ke.NUMBER]),[p]=Rt([d],0,[Ke.NUMBER]);return f>p?1:0},isLessThanOrEq(h,d){const[f]=Rt([h],0,[Ke.NUMBER]),[p]=Rt([d],0,[Ke.NUMBER]);return f<=p?1:0},isGreaterThanOrEq(h,d){const[f]=Rt([h],0,[Ke.NUMBER]),[p]=Rt([d],0,[Ke.NUMBER]);return f>=p?1:0},opPlus(h,d){const[f]=Rt([h],0,[Ke.ANY]),[p]=Rt([d],0,[Ke.ANY]);return f+p},opMinus(h,d){const[f]=Rt([h],0,[Ke.ANY]),[p]=Rt([d],0,[Ke.ANY]);return f-p},opPower(h,d){const[f]=Rt([h],0,[Ke.NUMBER]),[p]=Rt([d],0,[Ke.NUMBER]);return Math.pow(f,p)},opMultiply(h,d){const[f]=Rt([h],0,[Ke.NUMBER]),[p]=Rt([d],0,[Ke.NUMBER]);return f*p},opDivide(h,d){const[f]=Rt([h],0,[Ke.NUMBER]),[p]=Rt([d],0,[Ke.NUMBER]);return f/p},opModDivide(h,d){const[f]=Rt([h],0,[Ke.NUMBER]),[p]=Rt([d],0,[Ke.NUMBER]);return f%p},opFloorDivide(h,d){const[f]=Rt([h],0,[Ke.NUMBER]),[p]=Rt([d],0,[Ke.NUMBER]);return Math.floor(f/p)},opUniPlus(h){const[d]=Rt([h],0,[Ke.NUMBER]);return+d},opUniMinus(h){const[d]=Rt([h],0,[Ke.NUMBER]);return-d}};return s=(u=n.code)==null?void 0:u.call(n,c),c}function p$(t){if(!t||t.type===void 0)return;const e=[{start:t.startOffset,end:t.endOffset??0}];return Object.keys(t).forEach(n=>{if(n!=="parent"){const i=t[n];ji(i)?i.forEach(r=>{e.push(p$(r))}):e.push(p$(i))}}),t.range={start:Math.min(...e.filter(n=>n).map(n=>(n==null?void 0:n.start)??0)),end:Math.max(...e.filter(n=>n).map(n=>(n==null?void 0:n.end)??0))},t.range}function f_e(t){const e=O0e(`${t}
`);if(e.errors.length>0)return e;tC.input=e.tokens;const n=tC.program();if(tC.errors.length>0)return{tokens:e.tokens,errors:tC.errors.map(r=>({offset:r.token.startOffset,line:r.token.startLine,column:r.token.startColumn,length:r.token.image.length,message:r.message}))};const[i]=zet.go(n);return i?(p$(i),{tokens:e.tokens,cst:n,ast:i}):{tokens:e.tokens,cst:n,errors:[{message:"no ast output",offset:0,line:0,column:0,length:0}]}}const NH=Object.getPrototypeOf(function*(){}).constructor;function Yet(t,e){const n=`compile-${t}`;console.time(n);const i=f_e(e);if(console.timeEnd(n),i.errors&&i.errors.length>0)return i;if(!i.ast)return{...i,errors:[{message:"no ast output",offset:0,line:0,column:0,length:0}]};const r=qet(i.ast);if(r.code){W$e&&console.info(r.code);try{return{...i,...r,source:r.code,code:new NH("api",r.code)}}catch(s){return{errors:[{message:`unexpected error ${s.message}`,offset:0,line:0,column:0,length:0}],source:"",code:new NH("api"," ")}}}return{...i,...r,source:"",code:new NH("api"," ")}}function Ket(){const t={},e={};function n(r,s){const a=t[s];if(a)return a;const o=Yet(r,s);return t[s]=o,o}const i={ids(){return Object.keys(e)},isended(r){const s=e[r];return re(s)?s.isended():!0},halt(r){const s=e[r];return re(s)&&(s.halt(),delete e[r]),!!s},gc(){const r=i.ids();for(let s=0;s<r.length;++s)i.isended(r[s])&&i.halt(r[s])},arg(r,s){const a=e[r];re(a)&&a.set("arg",s)},tick(r,s,a,o,c){var u;let l=e[r];if(!re(e[r])){const h=n(o,c);if(l=e[r]=Wet(r,s,h),(u=h.errors)!=null&&u.length){const[d]=h.errors,f=((d==null?void 0:d.line)??2)-1,p=c.replaceAll(`\r
`,"").split(`
`).map((v,b)=>[v,b]);p.slice(f-5,f).forEach(([v,b])=>{Mi(Ye,MO(),"build",`$grey${b+1} $grey${v}`)});const[g,_]=p[f]??[];if(Tn(g)&&re(_)){const v=(d.column??1)-1,b=v+d.length,S=v<g.length?g:`${g}*`,x=S.substring(0,v),M=S.substring(v,b),R=S.substring(b);Mi(Ye,MO(),"build",`$red${_+1} $grey${x}$red${M}$grey${R}`)}return d.message.split(`
`).forEach(v=>{Mi(Ye,MO(),"build",v)}),!1}}return!!(l!=null&&l.tick(a))},once(r,s,a,o){const c=i.tick(r,s,1,a,o);return i.halt(r)&&c},message(r){const{target:s,path:a}=O_(r.target),o=e[s];if(re(o)){const c={...r,target:a};o.message(c)}}};return i}new xt;const p_e=Ket();var Lc=(t=>(t.MAIN="main",t.TITLE="title",t.PLAYER="player",t.CONTENT="content",t.GADGETSTORE="gadgetstore",t.GADGETSYNC="gadgetsync",t))(Lc||{});const kp={halt:!1,session:wo(),operator:"",software:{main:"",content:""},books:new Map,chips:new Map,loaders:new Map};function MO(){return kp.operator}function gL(){return[...kp.books.values()]}function Xet(){const[t]=kp.books.values();return t}function Jv(t){const e=Wn(t);return kp.books.get(t)??gL().find(n=>n.name===e)}function m$(t,e){re(Jv(e))&&(kp.software[t]=e)}function nC(t){return Jv(kp.software[t])}function m_e(t){const e=I0e([]);return Tn(t)&&(e.name=t),g_e(e),xr(Ye,kp.operator,`created [book] ${e.name}`),e}function Zet(t){let e=Jv(t);return re(e)||(e=I0e([]),e.name=t),g_e(e),xr(Ye,kp.operator,`created [book] ${e.name}`),e}function c_(t,e){let n=re(e)?Zet(e):nC(t);return re(n)||(re(n)||(n=Xet()),re(n)||(n=m_e(e)),re(n)&&xr(Ye,kp.operator,`opened [book] ${n.name} for ${t}`)),m$(t,n.id),n}function Jy(t,e,n){return Zq(c_(t),n,e)}function T1(t){const e=c_("main");return y4(e,t)}function Ire(){const t=c_("main");return y4(t,"main")}function Jet(t){const e=c_("main");return lWe(e,t)}function g_e(t){return kp.books.set(t.id,t),t.id}function Qet(t){const e=Jv(t);e&&kp.books.delete(e.id)}function gw(t,e,n,i){const r=K1(e);Tn(n.id)&&Ye.emit(t,"vm:touched",[n.id,r,i])}function ett(t,e,n,i){const r=n.id??"";if(i.x<0){const s=fp(t,Xn.BOARD,(e==null?void 0:e.exitwest)??"");if(s.length){const a=io(s);eC(t,r,a.id,{x:kn-1,y:i.y})}}else if(i.x>=kn){const s=fp(t,Xn.BOARD,(e==null?void 0:e.exiteast)??"");if(s.length){const a=io(s);eC(t,r,a.id,{x:0,y:i.y})}}else if(i.y<0){const s=fp(t,Xn.BOARD,(e==null?void 0:e.exitnorth)??"");if(s.length){const a=io(s);eC(t,r,a.id,{x:i.x,y:ur-1})}}else if(i.y>=ur){const s=fp(t,Xn.BOARD,(e==null?void 0:e.exitsouth)??"");if(s.length){const a=io(s);eC(t,r,a.id,{x:i.x,y:0})}}}function CC(t,e,n,i){if(!re(n==null?void 0:n.id))return!1;const r=rK(t,e,n,i);if(re(r)){const s=o1(r.id);return n.kind==="player"&&r.kind==="edge"?ett(t,e,n,i):gw("",r,n,"thud"),n.kind==="player"?gw(n.id,n,r,s?"bump":"touch"):n.collision===Qr.ISBULLET?yc(t,r,"collision")===Qr.ISBULLET?gw("",n,r,"thud"):o1(n.party)?gw(n.id,n,r,s?"partyshot":"shot"):gw("",n,r,s?"shot":"partyshot"):gw("",n,r,"bump"),yc(t,r,"destructible")?(re(r==null?void 0:r.id)?e0(ie.book,ie.board,r,ie.timestamp):af(e,{x:i.x,y:i.y}),!0):!1}return!0}function ttt(t,e,n,i,r=t7e){var h;if(!re(t)||!re(e)||!re(n))return;const s={...ie};ie.book=t,ie.board=e,ie.element=n,ie.elementid=n.id??"",ie.elementisplayer=o1(ie.elementid);const a=ie.element.player??kp.operator;ie.elementfocus=ie.elementisplayer?ie.elementid:a;const o=v1(t,n),c=n.cycle??(o==null?void 0:o.cycle)??r,l=n.id??"",u=Wn(n.name??((h=n.kinddata)==null?void 0:h.name)??"");if(p_e.tick(l,RK.RUNTIME,an(c)?c:r,u,i),an(n==null?void 0:n.tickertime)&&ie.timestamp-n.tickertime>AY*5&&(n.tickertime=0,n.tickertext=""),ie.elementisplayer){const d=T1(ie.elementid);an(d.inputcurrent)&&(d.inputcurrent=0)}M_(s).forEach(d=>{ie[d]=s[d]})}function v_e(t,e){const n=nC("main");if(!re(n))return;function i(o,c){for(let l=0;l<o.length;++l){const u=o[l];if(re(u.id)){const h=`${d_e(u.id)}:${c}`;Ye.emit("",h,e)}}}const{target:r,path:s}=O_(t),a=pWe(n);for(let o=0;o<a.length;++o){const c=a[o];switch(Wn(r)){case"all":case"self":case"others":{i(Object.values(c.objects),s);break}default:{i(S0e(c,[r]),s);break}}}}function nB(t){var o;const e=c_("main"),n=g1(e,t);if(!re(e)||!re(n)||!re(ie.element))return;const i={...ie},r=`${t}_run`,s=Wn(ie.element.name??((o=ie.element.kinddata)==null?void 0:o.name)??""),a=(n==null?void 0:n.code)??"";p_e.once(r,RK.RUNTIME,s,a),M_(i).forEach(c=>{ie[c]=i[c]})}function vw(t,e=0){const n=[];let i=t;for(;i<ie.words.length;){const[r,s]=Xh(i);if(ji(r)&&!P_(r)&&!eI(r)&&!J3(r)&&!d0(r)&&n.push(...r),r==="|")return[n,s];if(i=s,n.push(r),e>0&&n.length>=e)return[n,i]}return[n,i]}function Xh(t){var i,r,s,a,o,c,l,u,h;const e=ie.words[t],n=t+1;if(qve(e)){const[d,f]=rQe(t);if(re(d))return[d,f]}if(sQe(e)){const[d,f]=aQe(t);if(re(d))return[d,f]}if(M4(e)){const[d,f]=NK(t);if(re(d))return[d,f]}if(Tn(e)&&Wn(e)==="rnd"){const[d,f]=Xh(n),[p,g]=Xh(f);return an(d)&&an(p)?[rf(d,p),g]:an(d)?[rf(0,d),f]:[rf(0,1),n]}if(RY(e)){const[d,f]=s0e(t);if(re(d))return[d,f]}if(!re(e))return[void 0,t];if(an(e)||ji(e))return[e,n];if(Tn(e)){const d=Wn(e),f=(i=ie.get)==null?void 0:i.call(ie,e);if(re(f))return[f,n];switch(d){case"aligned":case"alligned":{const p=BN(ie.board,{x:((r=ie.element)==null?void 0:r.x)??-1,y:((s=ie.element)==null?void 0:s.y)??-1},ie.elementfocus);return!re(ie.element)||!re(p)?[0,n]:[ie.element.x===p.x||ie.element.y===p.y?1:0,n]}case"contact":{const p=BN(ie.board,{x:((a=ie.element)==null?void 0:a.x)??-1,y:((o=ie.element)==null?void 0:o.y)??-1},ie.elementfocus);if(!re(ie.element)||!re(p))return[0,n];const g=(p.x??0)-(((c=ie.element)==null?void 0:c.x)??0),_=(p.y??0)-(((l=ie.element)==null?void 0:l.y)??0);return[g===0&&Math.abs(_)<2||_===0&&Math.abs(g)<2?1:0,n]}case"blocked":{const[p,g]=Rt(ie.words,n,[Ke.DIR]);return[yWe(ie.book,ie.board,ie.element,p.destpt)?1:0,g]}case"any":{const[p,g]=Rt(ie.words,n,[Ke.KIND]);return[E0e(ie.board,p).length?1:0,g]}case"color":{const[p,g,_]=Rt(ie.words,n,[Ke.DIR,Ke.COLOR]),v=p.layer===Yt.MID?bc(ie.board,p.destpt):mA(ie.board,p.destpt.x,p.destpt.y);if(re(v)){const b=j3(ie.book,v,-1,-1,-1);return[y_e(g)===b.color||b_e(g)===b.bg?1:0,_]}return[0,_]}case"detect":{const[p,g,_]=Rt(ie.words,n,[Ke.DIR,Ke.KIND]),v=p.layer===Yt.MID?bc(ie.board,p.destpt):mA(ie.board,p.destpt.x,p.destpt.y);if(re(v)){const b=Wn(k3(g)),S=MY(g),x=j3(ie.book,v,-1,-1,-1);if(b&&b===Wn(K1(v)))return[1,_];if(re(S)&&S===x.color)return[1,_]}return[0,_]}case"rnd":return[rf(0,1),n];case"abs":{const[p,g]=Rt(ie.words,n,[Ke.NUMBER]);return[Math.abs(p),g]}case"intceil":{const[p,g]=Rt(ie.words,n,[Ke.NUMBER]);return[Math.ceil(p),g]}case"intfloor":{const[p,g]=Rt(ie.words,n,[Ke.NUMBER]);return[Math.floor(p),g]}case"intround":{const[p,g]=Rt(ie.words,n,[Ke.NUMBER]);return[Math.round(p),g]}case"clamp":{const[p,g,_,v]=Rt(ie.words,n,[Ke.NUMBER,Ke.NUMBER,Ke.NUMBER]);return[er(p,g,_),v]}case"min":{const[p,g]=vw(n);return[Math.min(...p),g]}case"max":{const[p,g]=vw(n);return[Math.max(...p),g]}case"pick":{const[p,g]=vw(n);return[io(p),g]}case"pickwith":{const[p,g]=Rt(ie.words,n,[Ke.NUMBER_OR_STRING]),[_,v]=vw(g);return[X$e(`${p}`,_),v]}case"random":{const[p,g]=vw(n,2),[_,v]=p;return[rf(_,v??0),g]}case"randomwith":{const[p,g]=Rt(ie.words,n,[Ke.NUMBER_OR_STRING]),[_,v]=vw(g,2),[b,S]=_;return[Rpe(`${p}`,b,S??0),v]}case"run":{const[p,g]=Rt(ie.words,n,[Ke.NAME]);return nB(p),[(u=ie.get)==null?void 0:u.call(ie,"arg"),g]}case"runwith":{const[p,g,_]=Rt(ie.words,n,[Ke.ANY,Ke.NAME]);return re(ie.element)&&(ie.element.arg=p),nB(g),[(h=ie.get)==null?void 0:h.call(ie,"arg"),_]}}}return[e,n]}const ie={timestamp:0,book:void 0,board:void 0,element:void 0,elementid:"",elementisplayer:!1,elementfocus:"",words:[],get:void 0};var Ke=(t=>(t[t.COLOR=0]="COLOR",t[t.KIND=1]="KIND",t[t.DIR=2]="DIR",t[t.NAME=3]="NAME",t[t.NUMBER=4]="NUMBER",t[t.STRING=5]="STRING",t[t.NUMBER_OR_STRING=6]="NUMBER_OR_STRING",t[t.MAYBE_KIND=7]="MAYBE_KIND",t[t.MAYBE_NAME=8]="MAYBE_NAME",t[t.MAYBE_NUMBER=9]="MAYBE_NUMBER",t[t.MAYBE_STRING=10]="MAYBE_STRING",t[t.MAYBE_NUMBER_OR_STRING=11]="MAYBE_NUMBER_OR_STRING",t[t.ANY=12]="ANY",t))(Ke||{});function du(t,e,n){throw console.info(n,ie.element,ie.elementid,ie.elementfocus),new Error(`Invalid arg, expected: ${t} but got ${JSON.stringify(e)}`)}function kre(t){var n,i;const e={x:((n=ie.element)==null?void 0:n.x)??0,y:((i=ie.element)==null?void 0:i.y)??0};return Jq(ie.book,ie.board,ie.element,ie.elementfocus,t,e)}function Rt(t,e,n){const i=ie.words;ie.words=t;const r=[];let s=e;for(let a=0;a<n.length;++a)switch(n[a]){case 1:{const[o,c]=_ie(s);pA(o)?(s=c,r.push(o)):du("kind",o,t);break}case 0:{if(M4(t[0])===void 0){const[o,c]=Xh(s);d0(o)?(s=c,r.push(o)):du("color",o,t)}else{const[o,c]=NK(s);d0(o)?(s=c,r.push(o)):du("color",o,t)}break}case 2:{if(RY(t[0])===void 0){const[o,c]=Xh(s);P_(o)?(s=c,r.push(kre(o))):du("direction",o,t)}else{const[o,c]=s0e(s);P_(o)?(s=c,r.push(kre(o))):du("direction",o,t)}break}case 3:{const o=ie.words[s];Tn(o)||du("string",o,t),++s,r.push(o);break}case 4:{const[o,c]=Xh(s);if(Tn(o)){const l=parseFloat(o);an(l)?r.push(l):du("number",o,t)}else an(o)?r.push(o):du("number",o,t);s=c;break}case 5:{const[o,c]=Xh(s);Tn(o)||du("string",o,t),s=c,r.push(o);break}case 6:{const[o,c]=Xh(s);let l=o;if(Tn(l)){const u=parseFloat(l);an(u)&&(l=u)}else an(l)||du("number or string",l,t);s=c,r.push(l);break}case 7:{const[o,c]=_ie(s);o!==void 0&&!pA(o)&&du("optional kind",o,t),s=c,r.push(o);break}case 8:{const o=ie.words[s];o!==void 0&&!Tn(o)&&du("optional string",o,t),++s,r.push(o);break}case 9:{const[o,c]=Xh(s);if(Tn(o)){const l=parseFloat(o);an(l)?r.push(l):du("optional number",o,t)}else an(o)||o===void 0?r.push(o):du("optional number",o,t);s=c;break}case 10:{const[o,c]=Xh(s);o!==void 0&&!Tn(o)&&du("optional string",o,t),s=c,r.push(o);break}case 11:{const[o,c]=Xh(s);let l=o;if(Tn(l)){const u=parseFloat(l);an(u)&&(l=u)}else l!==void 0&&!an(l)&&du("number or string",l,t);s=c,r.push(l);break}case 12:{const[o,c]=Xh(s);s=c,r.push(o);break}}return ie.words=i,[...r,s]}function ntt(t){return re(t)&&t<qt.ONBLACK?t:void 0}function itt(t){return re(t)&&t>qt.WHITE&&t<qt.ONCLEAR?t-qt.ONBLACK:void 0}const R4={black:"BLACK",dkblue:"DKBLUE",dkgreen:"DKGREEN",dkcyan:"DKCYAN",dkred:"DKRED",dkpurple:"DKPURPLE",dkyellow:"DKYELLOW",ltgray:"LTGRAY",dkgray:"DKGRAY",blue:"BLUE",green:"GREEN",cyan:"CYAN",red:"RED",purple:"PURPLE",yellow:"YELLOW",white:"WHITE",brown:"DKYELLOW",dkwhite:"LTGRAY",ltgrey:"LTGRAY",gray:"LTGRAY",grey:"LTGRAY",dkgrey:"DKGRAY",ltblack:"DKGRAY",onblack:"ONBLACK",ondkblue:"ONDKBLUE",ondkgreen:"ONDKGREEN",ondkcyan:"ONDKCYAN",ondkred:"ONDKRED",ondkpurple:"ONDKPURPLE",ondkyellow:"ONDKYELLOW",onltgray:"ONLTGRAY",ondkgray:"ONDKGRAY",onblue:"ONBLUE",ongreen:"ONGREEN",oncyan:"ONCYAN",onred:"ONRED",onpurple:"ONPURPLE",onyellow:"ONYELLOW",onwhite:"ONWHITE",onbrown:"ONDKYELLOW",ondkwhite:"ONLTGRAY",onltgrey:"ONLTGRAY",ongray:"ONLTGRAY",ongrey:"ONLTGRAY",ondkgrey:"ONDKGRAY",onltblack:"ONDKGRAY",onclear:"ONCLEAR"};function d0(t){return ji(t)&&__e(t[0])}function Pre(t){return d0(t)&&t[0].startsWith("ON")}function __e(t){return re(qt[t])&&Tn(t)}function M4(t){if(Tn(t))return R4[Wn(t)]}function y_e(t){return t.map(e=>qt[e]).find(e=>re(e)&&e<qt.ONBLACK)}function b_e(t){return t.map(e=>qt[e]).find(e=>re(e)&&e>=qt.ONBLACK)}function rtt(t){if(d0(t))return t;if(__e(t))return[t];const e=M4(t);if(re(e))return[e]}function Dre(t){const e=ie.words[t],n=rtt(e);return d0(n)?[n,t+1]:[void 0,t]}function NK(t){const e=[];let n=t;const[i,r]=Dre(t);if(d0(i)&&(e.push(...i),n=r),d0(e)&&!Pre(e)){const[s,a]=Dre(r);Pre(s)&&(n=a)}return e.length?[e,n]:[void 0,t]}function E_e(t){const e={};return t.every(n=>{const i=qt[n];re(i)&&(i<qt.ONBLACK?e.color=i:e.bg=i-qt.ONBLACK)}),e}const stt=CY(32,126).map(t=>String.fromCharCode(t)),att=yf({name:"Whitespace",pattern:/ +/}),ott=yf({name:"WhitespaceSkipped",pattern:/ +/,group:Kc.SKIPPED}),IK=yf({name:"Newline",line_breaks:!0,start_chars_hint:[`
`,"\r"],pattern:/\n|\r\n?/}),kK=yf({name:"StringLiteral",pattern:/[^ $;\r\n]+/,start_chars_hint:stt}),PK=yf({name:"StringLiteralDouble",pattern:/"(?:[^\\"]|\\(?:[^\n\r]|u[0-9a-fA-F]{4}))*"/}),DK=yf({name:"EscapedDollar",pattern:"$$"}),LK=yf({name:"MaybeFlag",pattern:/\$[^-0-9"!;@#/?\s]+[^-"!;@#/?\s]*/}),UK=yf({name:"NumberLiteral",pattern:/\$-?(\d*\.)?\d+([eE][+-]?\d+)?[jJ]?[lL]?\+?/}),BK=yf({name:"HyperLinkText",pattern:/;[^;\r\n]*/,start_chars_hint:[";"]});function ctt(t,e=""){return yf({name:e||t,pattern:new RegExp(t.toLowerCase(),"i")})}const ltt=Object.keys(R4),S_e=ltt.map(t=>ctt(`\\$(${t})`,t)),utt=[att,IK,...S_e,PK,kK,UK,DK,BK,LK],htt=new Kc(utt,{skipValidations:!o0,ensureOptimizations:o0}),dtt=new Kc([ott,IK,...S_e,PK,kK,UK,DK,BK,LK],{skipValidations:!o0,ensureOptimizations:o0});function O4(t,e=!1){return e?dtt.tokenize(t):htt.tokenize(t)}function FE(t,e,n,i,r,s,a,o){return{disablewrap:!1,measureonly:!1,measuredwidth:0,writefullwidth:void 0,x:0,y:0,iseven:!0,active:{color:n,bg:i,topedge:r,leftedge:s,rightedge:a,bottomedge:o},reset:{color:n,bg:i,topedge:r,leftedge:s,rightedge:a,bottomedge:o},width:t,height:e,char:[],color:[],bg:[],changed(){}}}function N4(t){t.active={...t.reset}}function FK(t,e){const n=e.y;function i(){++e.x;const o=e.active.rightedge??e.width-1;!e.disablewrap&&e.x>o&&(e.x=e.active.leftedge??0,++e.y),e.x>e.measuredwidth&&(e.measuredwidth=e.x)}function r(){return e.x>=(e.active.leftedge??0)&&e.x<=(e.active.rightedge??e.width-1)&&e.y>=(e.active.topedge??0)&&e.y<=(e.active.bottomedge??e.height-1)}function s(o){for(let c=0;c<o.length;++c){if(e.measureonly!==!0&&r()){const l=e.x+e.y*e.width;e.char[l]=o.charCodeAt(c),e.active.color!==void 0&&(e.color[l]=e.active.color),e.active.bg!==void 0&&(e.bg[l]=e.active.bg)}i()}}for(let o=0;o<t.length;++o){const c=t[o];switch(c.tokenType){case DK:s("$");break;case UK:if(e.measureonly!==!0&&r()){const l=e.x+e.y*e.width;e.char[l]=parseFloat(c.image.replace("$","")),e.active.color!==void 0&&(e.color[l]=e.active.color),e.active.bg!==void 0&&(e.bg[l]=e.active.bg)}i();break;case PK:s(c.image.substring(1,c.image.length-1).replaceAll('\\"','"'));break;case IK:{e.x=e.active.leftedge??0,++e.y;break}default:{const l=c.tokenType.name,u=R4[l],h=ntt(qt[u]),d=itt(qt[u]);u==="ONCLEAR"?(e.active.color=e.reset.color,e.active.bg=e.reset.bg):re(h)?e.active.color=h:re(d)?e.active.bg=d:s(c.image);break}}}e.x>e.measuredwidth&&(e.measuredwidth=e.x+1);const a=e.active.leftedge??0;if(re(e.writefullwidth)&&(e.x>a||e.y===n)){const c=(e.active.rightedge??e.width-1)-e.x;if(c>0){N4(e);const l=String.fromCharCode(e.writefullwidth).repeat(c),u=e.x+e.y*e.width;wA(u,u+l.length,e.active.color,e.active.bg,e),I4(u,l,e)}}}function oi(t,e,n){const i=O4(t);i.tokens&&(FK(i.tokens,e),n&&N4(e),e.changed())}function Ik(t,e,n){const i=O4(t);if(!i.tokens)return;const r=FE(e,n,qt.WHITE,qt.BLACK);return r.measureonly=!0,FK(i.tokens,r),r.x>0&&++r.y,r}function I4(t,e,n){let i=0;const r=t+e.length;for(let s=t;s<r;++s)n.char[s]=e.charCodeAt(i++);n.changed()}function wA(t,e,n,i,r){const s=Math.min(t,e),a=Math.max(t,e);for(let o=s;o<=a;++o)r.color[o]=n,r.bg[o]=i;r.changed()}function ftt(t,e,n,i){const r=Math.min(t,e),s=Math.max(t,e);for(let a=r;a<=s;++a)i.bg[a]=n;i.changed()}function Gf(t,e,n,i,r,s,a){const o=Math.min(n,i),c=Math.max(n,i);if(o>e||c<0)return;const l=Math.max(0,o),u=Math.min(e,c);wA(t+l,t+u,r,s,a)}function Lre(t,e,n,i,r,s){const a=Math.min(n,i),o=Math.max(n,i);if(a>e||o<0)return;const c=Math.max(0,a),l=Math.min(e,o);ftt(t+c,t+l,r,s)}function g$(t,e,n){const i=yk(kK,t,0,0,0,0,0,0);FK([i],e),n&&N4(e),e.changed()}function ptt(t,e,n,i,r){r.active.topedge=t,r.active.leftedge=e,r.active.rightedge=n,r.active.bottomedge=i}function w0(t){const e=t.reset.leftedge??0,n=t.reset.rightedge??t.width-1,i=t.reset.topedge??0,r=t.reset.bottomedge??t.height-1,s=n-e+1,a=r-i+1;return{left:e,right:n,top:i,bottom:r,width:s,height:a}}function CA(t,e=16){return t?CY(e-1).map(n=>{const i=n*l1;return new bn(t.bits[i]/63,t.bits[i+1]/63,t.bits[i+2]/63)}):[]}function mtt(t){return t.generateMipmaps=!1,t.minFilter=Va,t.magFilter=Va,t.needsUpdate=!0,t}function VT(t){if(re(t))return mtt(new sue(yze(t)))}const tI=De.createContext(FE(1,1,15,1));function Pp(){return De.useContext(tI)}const T_e=IE(()=>({blink:!1}));setInterval(()=>{T_e.setState(t=>({blink:!t.blink}))},333);function bf(){return T_e(t=>t.blink)}function x_e(){return K9(t=>{function e(){t(n=>({render:n.render+1}))}return{dither:[],render:0,changed(){queueMicrotask(e)}}})}function gtt(t){t.fill(0)}function IH(t,e,n,i,r,s){if(i<0||i>=e||r<0||r>=n)return-1;t[i+r*e]=s}const w_e=De.createContext(x_e());function vtt(t,e,n){const[i]=De.useState(()=>x_e()),r=t*e,s=i.getState();return s.dither.length!==r&&(s.dither=new Array(r).fill(n),s.render=0),i}function C_e(){return K9(t=>{function e(){t(n=>({render:n.render+1}))}return{width:0,height:0,char:[],color:[],bg:[],render:0,changed(){queueMicrotask(e)}}})}function A_e(t,e,n,i){t.char.fill(e),t.color.fill(n),t.bg.fill(i)}function gc(t,e,n,i,r,s){if(i<0||i>=e||r<0||r>=n)return;const a=i+r*e;M_(s).forEach(o=>{const c=s[o];re(c)&&(t[o][a]=c)})}const zK=De.createContext(C_e());function kk(t,e,n,i,r){const[s]=De.useState(()=>C_e()),a=t*e,o=s.getState();return o.char.length!==a&&(o.width=t,o.height=e,o.char=new Array(a).fill(n),o.color=new Array(a).fill(i),o.bg=new Array(a).fill(r),o.render=0),s}function R_e(){return De.useContext(zK).getState()}const Ure=PE(G1),Bre=V1(dR),_p=IE(t=>({palette:Ure,charset:Bre,mood:"",screen:{},palettedata:CA(Ure),charsetdata:VT(Bre),setmood(e){t(n=>hT(n.mood,e)?n:{...n,mood:e})},setpalette(e){t(n=>hT(n.palette,e)?n:{...n,palette:e,palettedata:CA(e)})},setcharset(e){t(n=>hT(n.charset,e)?n:{...n,charset:e,charsetdata:VT(e)})},setaltcharset(e){t(n=>hT(n.altcharset,e)?n:{...n,altcharset:e,altcharsetdata:VT(e)})},setscreen(e,n){t(i=>hT(i.screen,n)?i:{...i,screen:{...i.screen,[e]:n}})}})),od=IE(()=>({insetcols:20,insetrows:20,islowrez:!1,islandscape:!0,sidebaropen:!0,showkeyboard:!1,keyboardalt:!1,keyboardctrl:!1,keyboardshift:!1,showtouchcontrols:!1}));function _l(t,e,n){function i(r){Mi(t,e,"crash",r.message)}n().catch(i)}function vr(t,e,n){return t.namespaceURI&&t.namespaceURI!=="http://www.w3.org/1999/xhtml"||(e=Array.isArray(e)?e:[e],!e.includes(t.tagName.toLowerCase()))?!1:n?Object.entries(n).every(([i,r])=>t[i]===r):!0}function Dp(t){var e;if(_tt(t)&&t.defaultView)return t.defaultView;if(!((e=t.ownerDocument)===null||e===void 0)&&e.defaultView)return t.ownerDocument.defaultView;throw new Error(`Could not determine window of node. Node was ${ytt(t)}`)}function _tt(t){return t.nodeType===9}function ytt(t){return typeof t=="function"?`function ${t.name}`:t===null?"null":String(t)}function M_e(t,e){return new Promise((n,i)=>{const r=new e;r.onerror=i,r.onabort=i,r.onload=()=>{n(String(r.result))},r.readAsText(t)})}function jK(t,e){const n={...e,length:e.length,item:i=>n[i],[Symbol.iterator]:function*(){for(let r=0;r<n.length;r++)yield n[r]}};return n.constructor=t.FileList,t.FileList&&Object.setPrototypeOf(n,t.FileList.prototype),Object.freeze(n),n}function Ob(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}class O_e{getAsFile(){return this.file}getAsString(e){typeof this.data=="string"&&e(this.data)}webkitGetAsEntry(){throw new Error("not implemented")}constructor(e,n){Ob(this,"kind",void 0),Ob(this,"type",void 0),Ob(this,"file",null),Ob(this,"data",void 0),typeof e=="string"?(this.kind="string",this.type=String(n),this.data=e):(this.kind="file",this.type=e.type,this.file=e)}}class btt extends Array{add(...e){const n=new O_e(e[0],e[1]);return this.push(n),n}clear(){this.splice(0,this.length)}remove(e){this.splice(e,1)}}function c2(t,e){const[n,i]=t.split("/"),r=!i||i==="*";return s=>e?s.type===(r?n:t):r?s.type.startsWith(`${n}/`):s.type===n}function Ett(t){return new class{getData(n){var i;const r=(i=this.items.find(c2(n,!0)))!==null&&i!==void 0?i:this.items.find(c2(n,!1));let s="";return r==null||r.getAsString(a=>{s=a}),s}setData(n,i){const r=this.items.findIndex(c2(n,!0)),s=new O_e(i,n);r>=0?this.items.splice(r,1,s):this.items.push(s)}clearData(n){if(n){const i=this.items.findIndex(c2(n,!0));i>=0&&this.items.remove(i)}else this.items.clear()}get types(){const n=[];return this.files.length&&n.push("Files"),this.items.forEach(i=>n.push(i.type)),Object.freeze(n),n}setDragImage(){}constructor(){Ob(this,"dropEffect","none"),Ob(this,"effectAllowed","uninitialized"),Ob(this,"items",new btt),Ob(this,"files",jK(t,[]))}}}function HK(t,e=[]){const n=typeof t.DataTransfer>"u"?Ett(t):new t.DataTransfer;return Object.defineProperty(n,"files",{get:()=>jK(t,e)}),n}async function Stt(t,e){return e.kind==="file"?e.getAsFile():new t.Blob([await new Promise(n=>e.getAsString(n))],{type:e.type})}function N_e(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function I_e(t,...e){const n=Object.fromEntries(e.map(i=>[typeof i=="string"?"text/plain":i.type,Promise.resolve(i)]));return typeof t.ClipboardItem<"u"?new t.ClipboardItem(n):new class{get types(){return Array.from(Object.keys(this.data))}async getType(r){const s=await this.data[r];if(!s)throw new Error(`${r} is not one of the available MIME types on this item.`);return s instanceof t.Blob?s:new t.Blob([s],{type:r})}constructor(r){N_e(this,"data",void 0),this.data=r}}(n)}const AA=Symbol("Manage ClipboardSub");function Fre(t,e){return Object.assign(new class extends t.EventTarget{async read(){return Array.from(this.items)}async readText(){let i="";for(const r of this.items){const s=r.types.includes("text/plain")?"text/plain":r.types.find(a=>a.startsWith("text/"));s&&(i+=await r.getType(s).then(a=>M_e(a,t.FileReader)))}return i}async write(i){this.items=i}async writeText(i){this.items=[I_e(t,i)]}constructor(...i){super(...i),N_e(this,"items",[])}},{[AA]:e})}function VK(t){return!!(t!=null&&t[AA])}function Ttt(t){if(VK(t.navigator.clipboard))return t.navigator.clipboard[AA];const e=Object.getOwnPropertyDescriptor(t.navigator,"clipboard");let n;const i={resetClipboardStub:()=>{n=Fre(t,i)},detachClipboardStub:()=>{e?Object.defineProperty(t.navigator,"clipboard",e):Object.defineProperty(t.navigator,"clipboard",{value:void 0,configurable:!0})}};return n=Fre(t,i),Object.defineProperty(t.navigator,"clipboard",{get:()=>n,configurable:!0}),n[AA]}function xtt(t){VK(t.navigator.clipboard)&&t.navigator.clipboard[AA].resetClipboardStub()}function wtt(t){VK(t.navigator.clipboard)&&t.navigator.clipboard[AA].detachClipboardStub()}async function Ctt(t){const e=t.defaultView,n=e==null?void 0:e.navigator.clipboard,i=n&&await n.read();if(!i)throw new Error("The Clipboard API is unavailable.");const r=HK(e);for(const s of i)for(const a of s.types)r.setData(a,await s.getType(a).then(o=>M_e(o,e.FileReader)));return r}async function k_e(t,e){const n=Dp(t),i=n.navigator.clipboard,r=[];for(let a=0;a<e.items.length;a++){const o=e.items[a],c=await Stt(n,o);r.push(I_e(n,c))}if(!(i&&await i.write(r).then(()=>!0,()=>!1)))throw new Error("The Clipboard API is unavailable.")}const iB=globalThis;typeof iB.afterEach=="function"&&iB.afterEach(()=>xtt(globalThis.window));typeof iB.afterAll=="function"&&iB.afterAll(()=>wtt(globalThis.window));const P_e=["input:not([type=hidden]):not([disabled])","button:not([disabled])","select:not([disabled])","textarea:not([disabled])",'[contenteditable=""]','[contenteditable="true"]',"a[href]","[tabindex]:not([disabled])"].join(", ");function GK(t){return t.matches(P_e)}function Att(t){return new t.constructor(t.type,t)}function U_(t){for(let n=t;n;n=n.parentElement)if(vr(n,["button","input","select","textarea","optgroup","option"])){if(n.hasAttribute("disabled"))return!0}else if(vr(n,"fieldset")){var e;if(n.hasAttribute("disabled")&&!(!((e=n.querySelector(":scope > legend"))===null||e===void 0)&&e.contains(t)))return!0}else if(n.tagName.includes("-")&&n.constructor.formAssociated&&n.hasAttribute("disabled"))return!0;return!1}function Pk(t){const e=t.activeElement;return e!=null&&e.shadowRoot?Pk(e.shadowRoot):U_(e)?t.ownerDocument?t.ownerDocument.body:t.body:e}function kH(t){var e;return(e=Pk(t))!==null&&e!==void 0?e:t.body}function Rtt(t,e){let n=t;do{if(e(n))return n;n=n.parentElement}while(n&&n!==t.ownerDocument.body)}function x1(t){return t.hasAttribute("contenteditable")&&(t.getAttribute("contenteditable")=="true"||t.getAttribute("contenteditable")=="")}function nI(t){const e=Mtt(t);return e&&(e.closest('[contenteditable=""]')||e.closest('[contenteditable="true"]'))}function Mtt(t){return t.nodeType===1?t:t.parentElement}var D_e=function(t){return t.button="button",t.color="color",t.file="file",t.image="image",t.reset="reset",t.submit="submit",t.checkbox="checkbox",t.radio="radio",t}(D_e||{});function L_e(t){return vr(t,"button")||vr(t,"input")&&t.type in D_e}function RA(t){return B_e(t)&&!t.readOnly||x1(t)}var U_e=function(t){return t.text="text",t.date="date",t["datetime-local"]="datetime-local",t.email="email",t.month="month",t.number="number",t.password="password",t.search="search",t.tel="tel",t.time="time",t.url="url",t.week="week",t}(U_e||{});function B_e(t){return vr(t,"textarea")||vr(t,"input")&&t.type in U_e}function C0(t){return F_e(t)&&B_e(t)}function Ott(t){return F_e(t)&&L_e(t)}function F_e(t){return t.nodeType===1}function Ntt(t){const e=t.ownerDocument.getSelection();if(e!=null&&e.focusNode&&C0(t)){const i=nI(e.focusNode);if(i){if(!e.isCollapsed){var n;const r=((n=i.firstChild)===null||n===void 0?void 0:n.nodeType)===3?i.firstChild:i;e.setBaseAndExtent(r,0,r,0)}}else e.setBaseAndExtent(t,0,t,0)}}var fE={},qK={exports:{}};qK.exports;(function(t){const n=(s=0)=>a=>`\x1B[${38+s};5;${a}m`,i=(s=0)=>(a,o,c)=>`\x1B[${38+s};2;${a};${o};${c}m`;function r(){const s=new Map,a={modifier:{reset:[0,0],bold:[1,22],dim:[2,22],italic:[3,23],underline:[4,24],overline:[53,55],inverse:[7,27],hidden:[8,28],strikethrough:[9,29]},color:{black:[30,39],red:[31,39],green:[32,39],yellow:[33,39],blue:[34,39],magenta:[35,39],cyan:[36,39],white:[37,39],blackBright:[90,39],redBright:[91,39],greenBright:[92,39],yellowBright:[93,39],blueBright:[94,39],magentaBright:[95,39],cyanBright:[96,39],whiteBright:[97,39]},bgColor:{bgBlack:[40,49],bgRed:[41,49],bgGreen:[42,49],bgYellow:[43,49],bgBlue:[44,49],bgMagenta:[45,49],bgCyan:[46,49],bgWhite:[47,49],bgBlackBright:[100,49],bgRedBright:[101,49],bgGreenBright:[102,49],bgYellowBright:[103,49],bgBlueBright:[104,49],bgMagentaBright:[105,49],bgCyanBright:[106,49],bgWhiteBright:[107,49]}};a.color.gray=a.color.blackBright,a.bgColor.bgGray=a.bgColor.bgBlackBright,a.color.grey=a.color.blackBright,a.bgColor.bgGrey=a.bgColor.bgBlackBright;for(const[o,c]of Object.entries(a)){for(const[l,u]of Object.entries(c))a[l]={open:`\x1B[${u[0]}m`,close:`\x1B[${u[1]}m`},c[l]=a[l],s.set(u[0],u[1]);Object.defineProperty(a,o,{value:c,enumerable:!1})}return Object.defineProperty(a,"codes",{value:s,enumerable:!1}),a.color.close="\x1B[39m",a.bgColor.close="\x1B[49m",a.color.ansi256=n(),a.color.ansi16m=i(),a.bgColor.ansi256=n(10),a.bgColor.ansi16m=i(10),Object.defineProperties(a,{rgbToAnsi256:{value:(o,c,l)=>o===c&&c===l?o<8?16:o>248?231:Math.round((o-8)/247*24)+232:16+36*Math.round(o/255*5)+6*Math.round(c/255*5)+Math.round(l/255*5),enumerable:!1},hexToRgb:{value:o=>{const c=/(?<colorString>[a-f\d]{6}|[a-f\d]{3})/i.exec(o.toString(16));if(!c)return[0,0,0];let{colorString:l}=c.groups;l.length===3&&(l=l.split("").map(h=>h+h).join(""));const u=Number.parseInt(l,16);return[u>>16&255,u>>8&255,u&255]},enumerable:!1},hexToAnsi256:{value:o=>a.rgbToAnsi256(...a.hexToRgb(o)),enumerable:!1}}),a}Object.defineProperty(t,"exports",{enumerable:!0,get:r})})(qK);var z_e=qK.exports,Y_={};Object.defineProperty(Y_,"__esModule",{value:!0});Y_.printIteratorEntries=ktt;Y_.printIteratorValues=Ptt;Y_.printListItems=Dtt;Y_.printObjectProperties=Ltt;const Itt=(t,e)=>{const n=Object.keys(t).sort(e);return Object.getOwnPropertySymbols&&Object.getOwnPropertySymbols(t).forEach(i=>{Object.getOwnPropertyDescriptor(t,i).enumerable&&n.push(i)}),n};function ktt(t,e,n,i,r,s,a=": "){let o="",c=t.next();if(!c.done){o+=e.spacingOuter;const l=n+e.indent;for(;!c.done;){const u=s(c.value[0],e,l,i,r),h=s(c.value[1],e,l,i,r);o+=l+u+a+h,c=t.next(),c.done?e.min||(o+=","):o+=","+e.spacingInner}o+=e.spacingOuter+n}return o}function Ptt(t,e,n,i,r,s){let a="",o=t.next();if(!o.done){a+=e.spacingOuter;const c=n+e.indent;for(;!o.done;)a+=c+s(o.value,e,c,i,r),o=t.next(),o.done?e.min||(a+=","):a+=","+e.spacingInner;a+=e.spacingOuter+n}return a}function Dtt(t,e,n,i,r,s){let a="";if(t.length){a+=e.spacingOuter;const o=n+e.indent;for(let c=0;c<t.length;c++)a+=o,c in t&&(a+=s(t[c],e,o,i,r)),c<t.length-1?a+=","+e.spacingInner:e.min||(a+=",");a+=e.spacingOuter+n}return a}function Ltt(t,e,n,i,r,s){let a="";const o=Itt(t,e.compareKeys);if(o.length){a+=e.spacingOuter;const c=n+e.indent;for(let l=0;l<o.length;l++){const u=o[l],h=s(u,e,c,i,r),d=s(t[u],e,c,i,r);a+=c+h+": "+d,l<o.length-1?a+=","+e.spacingInner:e.min||(a+=",")}a+=e.spacingOuter+n}return a}var Vb={};Object.defineProperty(Vb,"__esModule",{value:!0});Vb.test=Vb.serialize=Vb.default=void 0;var zre=Y_,rB=function(){return typeof globalThis<"u"?globalThis:typeof rB<"u"?rB:typeof self<"u"?self:typeof window<"u"?window:Function("return this")()}(),PH=rB["jest-symbol-do-not-touch"]||rB.Symbol;const Utt=typeof PH=="function"&&PH.for?PH.for("jest.asymmetricMatcher"):1267621,l2=" ",j_e=(t,e,n,i,r,s)=>{const a=t.toString();return a==="ArrayContaining"||a==="ArrayNotContaining"?++i>e.maxDepth?"["+a+"]":a+l2+"["+(0,zre.printListItems)(t.sample,e,n,i,r,s)+"]":a==="ObjectContaining"||a==="ObjectNotContaining"?++i>e.maxDepth?"["+a+"]":a+l2+"{"+(0,zre.printObjectProperties)(t.sample,e,n,i,r,s)+"}":a==="StringMatching"||a==="StringNotMatching"||a==="StringContaining"||a==="StringNotContaining"?a+l2+s(t.sample,e,n,i,r):t.toAsymmetricMatcher()};Vb.serialize=j_e;const H_e=t=>t&&t.$$typeof===Utt;Vb.test=H_e;const Btt={serialize:j_e,test:H_e};var Ftt=Btt;Vb.default=Ftt;var Gb={},ztt=({onlyFirst:t=!1}={})=>{const e=["[\\u001B\\u009B][[\\]()#;?]*(?:(?:(?:(?:;[-a-zA-Z\\d\\/#&.:=?%@~_]+)*|[a-zA-Z\\d]+(?:;[-a-zA-Z\\d\\/#&.:=?%@~_]*)*)?\\u0007)","(?:(?:\\d{1,4}(?:;\\d{0,4})*)?[\\dA-PR-TZcf-ntqry=><~]))"].join("|");return new RegExp(e,t?void 0:"g")};Object.defineProperty(Gb,"__esModule",{value:!0});Gb.test=Gb.serialize=Gb.default=void 0;var V_e=G_e(ztt),ra=G_e(z_e);function G_e(t){return t&&t.__esModule?t:{default:t}}const jtt=t=>t.replace((0,V_e.default)(),e=>{switch(e){case ra.default.red.close:case ra.default.green.close:case ra.default.cyan.close:case ra.default.gray.close:case ra.default.white.close:case ra.default.yellow.close:case ra.default.bgRed.close:case ra.default.bgGreen.close:case ra.default.bgYellow.close:case ra.default.inverse.close:case ra.default.dim.close:case ra.default.bold.close:case ra.default.reset.open:case ra.default.reset.close:return"</>";case ra.default.red.open:return"<red>";case ra.default.green.open:return"<green>";case ra.default.cyan.open:return"<cyan>";case ra.default.gray.open:return"<gray>";case ra.default.white.open:return"<white>";case ra.default.yellow.open:return"<yellow>";case ra.default.bgRed.open:return"<bgRed>";case ra.default.bgGreen.open:return"<bgGreen>";case ra.default.bgYellow.open:return"<bgYellow>";case ra.default.inverse.open:return"<inverse>";case ra.default.dim.open:return"<dim>";case ra.default.bold.open:return"<bold>";default:return""}}),q_e=t=>typeof t=="string"&&!!t.match((0,V_e.default)());Gb.test=q_e;const $_e=(t,e,n,i,r,s)=>s(jtt(t),e,n,i,r);Gb.serialize=$_e;const Htt={serialize:$_e,test:q_e};var Vtt=Htt;Gb.default=Vtt;var qb={};Object.defineProperty(qb,"__esModule",{value:!0});qb.test=qb.serialize=qb.default=void 0;var jre=Y_;const Gtt=" ",W_e=["DOMStringMap","NamedNodeMap"],qtt=/^(HTML\w*Collection|NodeList)$/,$tt=t=>W_e.indexOf(t)!==-1||qtt.test(t),Y_e=t=>t&&t.constructor&&!!t.constructor.name&&$tt(t.constructor.name);qb.test=Y_e;const Wtt=t=>t.constructor.name==="NamedNodeMap",K_e=(t,e,n,i,r,s)=>{const a=t.constructor.name;return++i>e.maxDepth?"["+a+"]":(e.min?"":a+Gtt)+(W_e.indexOf(a)!==-1?"{"+(0,jre.printObjectProperties)(Wtt(t)?Array.from(t).reduce((o,c)=>(o[c.name]=c.value,o),{}):{...t},e,n,i,r,s)+"}":"["+(0,jre.printListItems)(Array.from(t),e,n,i,r,s)+"]")};qb.serialize=K_e;const Ytt={serialize:K_e,test:Y_e};var Ktt=Ytt;qb.default=Ktt;var $b={},gu={},$K={};Object.defineProperty($K,"__esModule",{value:!0});$K.default=Xtt;function Xtt(t){return t.replace(/</g,"&lt;").replace(/>/g,"&gt;")}Object.defineProperty(gu,"__esModule",{value:!0});gu.printText=gu.printProps=gu.printElementAsLeaf=gu.printElement=gu.printComment=gu.printChildren=void 0;var X_e=Ztt($K);function Ztt(t){return t&&t.__esModule?t:{default:t}}const Jtt=(t,e,n,i,r,s,a)=>{const o=i+n.indent,c=n.colors;return t.map(l=>{const u=e[l];let h=a(u,n,o,r,s);return typeof u!="string"&&(h.indexOf(`
`)!==-1&&(h=n.spacingOuter+o+h+n.spacingOuter+i),h="{"+h+"}"),n.spacingInner+i+c.prop.open+l+c.prop.close+"="+c.value.open+h+c.value.close}).join("")};gu.printProps=Jtt;const Qtt=(t,e,n,i,r,s)=>t.map(a=>e.spacingOuter+n+(typeof a=="string"?Z_e(a,e):s(a,e,n,i,r))).join("");gu.printChildren=Qtt;const Z_e=(t,e)=>{const n=e.colors.content;return n.open+(0,X_e.default)(t)+n.close};gu.printText=Z_e;const ent=(t,e)=>{const n=e.colors.comment;return n.open+"<!--"+(0,X_e.default)(t)+"-->"+n.close};gu.printComment=ent;const tnt=(t,e,n,i,r)=>{const s=i.colors.tag;return s.open+"<"+t+(e&&s.close+e+i.spacingOuter+r+s.open)+(n?">"+s.close+n+i.spacingOuter+r+s.open+"</"+t:(e&&!i.min?"":" ")+"/")+">"+s.close};gu.printElement=tnt;const nnt=(t,e)=>{const n=e.colors.tag;return n.open+"<"+t+n.close+" "+n.open+" />"+n.close};gu.printElementAsLeaf=nnt;Object.defineProperty($b,"__esModule",{value:!0});$b.test=$b.serialize=$b.default=void 0;var _w=gu;const int=1,J_e=3,Q_e=8,eye=11,rnt=/^((HTML|SVG)\w*)?Element$/,snt=t=>{try{return typeof t.hasAttribute=="function"&&t.hasAttribute("is")}catch{return!1}},ant=t=>{const e=t.constructor.name,{nodeType:n,tagName:i}=t,r=typeof i=="string"&&i.includes("-")||snt(t);return n===int&&(rnt.test(e)||r)||n===J_e&&e==="Text"||n===Q_e&&e==="Comment"||n===eye&&e==="DocumentFragment"},tye=t=>{var e;return(t==null||(e=t.constructor)===null||e===void 0?void 0:e.name)&&ant(t)};$b.test=tye;function ont(t){return t.nodeType===J_e}function cnt(t){return t.nodeType===Q_e}function DH(t){return t.nodeType===eye}const nye=(t,e,n,i,r,s)=>{if(ont(t))return(0,_w.printText)(t.data,e);if(cnt(t))return(0,_w.printComment)(t.data,e);const a=DH(t)?"DocumentFragment":t.tagName.toLowerCase();return++i>e.maxDepth?(0,_w.printElementAsLeaf)(a,e):(0,_w.printElement)(a,(0,_w.printProps)(DH(t)?[]:Array.from(t.attributes).map(o=>o.name).sort(),DH(t)?{}:Array.from(t.attributes).reduce((o,c)=>(o[c.name]=c.value,o),{}),e,n+e.indent,i,r,s),(0,_w.printChildren)(Array.prototype.slice.call(t.childNodes||t.children),e,n+e.indent,i,r,s),e,n)};$b.serialize=nye;const lnt={serialize:nye,test:tye};var unt=lnt;$b.default=unt;var Wb={};Object.defineProperty(Wb,"__esModule",{value:!0});Wb.test=Wb.serialize=Wb.default=void 0;var iI=Y_;const hnt="@@__IMMUTABLE_ITERABLE__@@",dnt="@@__IMMUTABLE_LIST__@@",fnt="@@__IMMUTABLE_KEYED__@@",pnt="@@__IMMUTABLE_MAP__@@",Hre="@@__IMMUTABLE_ORDERED__@@",mnt="@@__IMMUTABLE_RECORD__@@",gnt="@@__IMMUTABLE_SEQ__@@",vnt="@@__IMMUTABLE_SET__@@",_nt="@@__IMMUTABLE_STACK__@@",MA=t=>"Immutable."+t,k4=t=>"["+t+"]",rI=" ",Vre="",ynt=(t,e,n,i,r,s,a)=>++i>e.maxDepth?k4(MA(a)):MA(a)+rI+"{"+(0,iI.printIteratorEntries)(t.entries(),e,n,i,r,s)+"}";function bnt(t){let e=0;return{next(){if(e<t._keys.length){const n=t._keys[e++];return{done:!1,value:[n,t.get(n)]}}return{done:!0,value:void 0}}}}const Ent=(t,e,n,i,r,s)=>{const a=MA(t._name||"Record");return++i>e.maxDepth?k4(a):a+rI+"{"+(0,iI.printIteratorEntries)(bnt(t),e,n,i,r,s)+"}"},Snt=(t,e,n,i,r,s)=>{const a=MA("Seq");return++i>e.maxDepth?k4(a):t[fnt]?a+rI+"{"+(t._iter||t._object?(0,iI.printIteratorEntries)(t.entries(),e,n,i,r,s):Vre)+"}":a+rI+"["+(t._iter||t._array||t._collection||t._iterable?(0,iI.printIteratorValues)(t.values(),e,n,i,r,s):Vre)+"]"},LH=(t,e,n,i,r,s,a)=>++i>e.maxDepth?k4(MA(a)):MA(a)+rI+"["+(0,iI.printIteratorValues)(t.values(),e,n,i,r,s)+"]",iye=(t,e,n,i,r,s)=>t[pnt]?ynt(t,e,n,i,r,s,t[Hre]?"OrderedMap":"Map"):t[dnt]?LH(t,e,n,i,r,s,"List"):t[vnt]?LH(t,e,n,i,r,s,t[Hre]?"OrderedSet":"Set"):t[_nt]?LH(t,e,n,i,r,s,"Stack"):t[gnt]?Snt(t,e,n,i,r,s):Ent(t,e,n,i,r,s);Wb.serialize=iye;const rye=t=>t&&(t[hnt]===!0||t[mnt]===!0);Wb.test=rye;const Tnt={serialize:iye,test:rye};var xnt=Tnt;Wb.default=xnt;var Yb={},sye={exports:{}},ea={};/** @license React v17.0.2
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var P4=60103,D4=60106,Dk=60107,Lk=60108,Uk=60114,Bk=60109,Fk=60110,zk=60112,jk=60113,WK=60120,Hk=60115,Vk=60116,aye=60121,oye=60122,cye=60117,lye=60129,uye=60131;if(typeof Symbol=="function"&&Symbol.for){var zl=Symbol.for;P4=zl("react.element"),D4=zl("react.portal"),Dk=zl("react.fragment"),Lk=zl("react.strict_mode"),Uk=zl("react.profiler"),Bk=zl("react.provider"),Fk=zl("react.context"),zk=zl("react.forward_ref"),jk=zl("react.suspense"),WK=zl("react.suspense_list"),Hk=zl("react.memo"),Vk=zl("react.lazy"),aye=zl("react.block"),oye=zl("react.server.block"),cye=zl("react.fundamental"),lye=zl("react.debug_trace_mode"),uye=zl("react.legacy_hidden")}function Fm(t){if(typeof t=="object"&&t!==null){var e=t.$$typeof;switch(e){case P4:switch(t=t.type,t){case Dk:case Uk:case Lk:case jk:case WK:return t;default:switch(t=t&&t.$$typeof,t){case Fk:case zk:case Vk:case Hk:case Bk:return t;default:return e}}case D4:return e}}}var wnt=Bk,Cnt=P4,Ant=zk,Rnt=Dk,Mnt=Vk,Ont=Hk,Nnt=D4,Int=Uk,knt=Lk,Pnt=jk;ea.ContextConsumer=Fk;ea.ContextProvider=wnt;ea.Element=Cnt;ea.ForwardRef=Ant;ea.Fragment=Rnt;ea.Lazy=Mnt;ea.Memo=Ont;ea.Portal=Nnt;ea.Profiler=Int;ea.StrictMode=knt;ea.Suspense=Pnt;ea.isAsyncMode=function(){return!1};ea.isConcurrentMode=function(){return!1};ea.isContextConsumer=function(t){return Fm(t)===Fk};ea.isContextProvider=function(t){return Fm(t)===Bk};ea.isElement=function(t){return typeof t=="object"&&t!==null&&t.$$typeof===P4};ea.isForwardRef=function(t){return Fm(t)===zk};ea.isFragment=function(t){return Fm(t)===Dk};ea.isLazy=function(t){return Fm(t)===Vk};ea.isMemo=function(t){return Fm(t)===Hk};ea.isPortal=function(t){return Fm(t)===D4};ea.isProfiler=function(t){return Fm(t)===Uk};ea.isStrictMode=function(t){return Fm(t)===Lk};ea.isSuspense=function(t){return Fm(t)===jk};ea.isValidElementType=function(t){return typeof t=="string"||typeof t=="function"||t===Dk||t===Uk||t===lye||t===Lk||t===jk||t===WK||t===uye||typeof t=="object"&&t!==null&&(t.$$typeof===Vk||t.$$typeof===Hk||t.$$typeof===Bk||t.$$typeof===Fk||t.$$typeof===zk||t.$$typeof===cye||t.$$typeof===aye||t[0]===oye)};ea.typeOf=Fm;sye.exports=ea;var Dnt=sye.exports;Object.defineProperty(Yb,"__esModule",{value:!0});Yb.test=Yb.serialize=Yb.default=void 0;var oT=Lnt(Dnt),u2=gu;function hye(t){if(typeof WeakMap!="function")return null;var e=new WeakMap,n=new WeakMap;return(hye=function(i){return i?n:e})(t)}function Lnt(t,e){if(t&&t.__esModule)return t;if(t===null||typeof t!="object"&&typeof t!="function")return{default:t};var n=hye(e);if(n&&n.has(t))return n.get(t);var i={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var s in t)if(s!=="default"&&Object.prototype.hasOwnProperty.call(t,s)){var a=r?Object.getOwnPropertyDescriptor(t,s):null;a&&(a.get||a.set)?Object.defineProperty(i,s,a):i[s]=t[s]}return i.default=t,n&&n.set(t,i),i}const dye=(t,e=[])=>(Array.isArray(t)?t.forEach(n=>{dye(n,e)}):t!=null&&t!==!1&&e.push(t),e),Gre=t=>{const e=t.type;if(typeof e=="string")return e;if(typeof e=="function")return e.displayName||e.name||"Unknown";if(oT.isFragment(t))return"React.Fragment";if(oT.isSuspense(t))return"React.Suspense";if(typeof e=="object"&&e!==null){if(oT.isContextProvider(t))return"Context.Provider";if(oT.isContextConsumer(t))return"Context.Consumer";if(oT.isForwardRef(t)){if(e.displayName)return e.displayName;const n=e.render.displayName||e.render.name||"";return n!==""?"ForwardRef("+n+")":"ForwardRef"}if(oT.isMemo(t)){const n=e.displayName||e.type.displayName||e.type.name||"";return n!==""?"Memo("+n+")":"Memo"}}return"UNDEFINED"},Unt=t=>{const{props:e}=t;return Object.keys(e).filter(n=>n!=="children"&&e[n]!==void 0).sort()},fye=(t,e,n,i,r,s)=>++i>e.maxDepth?(0,u2.printElementAsLeaf)(Gre(t),e):(0,u2.printElement)(Gre(t),(0,u2.printProps)(Unt(t),t.props,e,n+e.indent,i,r,s),(0,u2.printChildren)(dye(t.props.children),e,n+e.indent,i,r,s),e,n);Yb.serialize=fye;const pye=t=>t!=null&&oT.isElement(t);Yb.test=pye;const Bnt={serialize:fye,test:pye};var Fnt=Bnt;Yb.default=Fnt;var Kb={};Object.defineProperty(Kb,"__esModule",{value:!0});Kb.test=Kb.serialize=Kb.default=void 0;var h2=gu,sB=function(){return typeof globalThis<"u"?globalThis:typeof sB<"u"?sB:typeof self<"u"?self:typeof window<"u"?window:Function("return this")()}(),UH=sB["jest-symbol-do-not-touch"]||sB.Symbol;const znt=typeof UH=="function"&&UH.for?UH.for("react.test.json"):245830487,jnt=t=>{const{props:e}=t;return e?Object.keys(e).filter(n=>e[n]!==void 0).sort():[]},mye=(t,e,n,i,r,s)=>++i>e.maxDepth?(0,h2.printElementAsLeaf)(t.type,e):(0,h2.printElement)(t.type,t.props?(0,h2.printProps)(jnt(t),t.props,e,n+e.indent,i,r,s):"",t.children?(0,h2.printChildren)(t.children,e,n+e.indent,i,r,s):"",e,n);Kb.serialize=mye;const gye=t=>t&&t.$$typeof===znt;Kb.test=gye;const Hnt={serialize:mye,test:gye};var Vnt=Hnt;Kb.default=Vnt;Object.defineProperty(fE,"__esModule",{value:!0});fE.default=fE.DEFAULT_OPTIONS=void 0;var Gnt=fE.format=Rye,vye=fE.plugins=void 0,qnt=zE(z_e),yM=Y_,$nt=zE(Vb),Wnt=zE(Gb),Ynt=zE(qb),Knt=zE($b),Xnt=zE(Wb),Znt=zE(Yb),Jnt=zE(Kb);function zE(t){return t&&t.__esModule?t:{default:t}}const _ye=Object.prototype.toString,Qnt=Date.prototype.toISOString,eit=Error.prototype.toString,qre=RegExp.prototype.toString,BH=t=>typeof t.constructor=="function"&&t.constructor.name||"Object",tit=t=>typeof window<"u"&&t===window,nit=/^Symbol\((.*)\)(.*)$/,iit=/\n/gi;class yye extends Error{constructor(e,n){super(e),this.stack=n,this.name=this.constructor.name}}function rit(t){return t==="[object Array]"||t==="[object ArrayBuffer]"||t==="[object DataView]"||t==="[object Float32Array]"||t==="[object Float64Array]"||t==="[object Int8Array]"||t==="[object Int16Array]"||t==="[object Int32Array]"||t==="[object Uint8Array]"||t==="[object Uint8ClampedArray]"||t==="[object Uint16Array]"||t==="[object Uint32Array]"}function sit(t){return Object.is(t,-0)?"-0":String(t)}function ait(t){return`${t}n`}function $re(t,e){return e?"[Function "+(t.name||"anonymous")+"]":"[Function]"}function Wre(t){return String(t).replace(nit,"Symbol($1)")}function Yre(t){return"["+eit.call(t)+"]"}function bye(t,e,n,i){if(t===!0||t===!1)return""+t;if(t===void 0)return"undefined";if(t===null)return"null";const r=typeof t;if(r==="number")return sit(t);if(r==="bigint")return ait(t);if(r==="string")return i?'"'+t.replace(/"|\\/g,"\\$&")+'"':'"'+t+'"';if(r==="function")return $re(t,e);if(r==="symbol")return Wre(t);const s=_ye.call(t);return s==="[object WeakMap]"?"WeakMap {}":s==="[object WeakSet]"?"WeakSet {}":s==="[object Function]"||s==="[object GeneratorFunction]"?$re(t,e):s==="[object Symbol]"?Wre(t):s==="[object Date]"?isNaN(+t)?"Date { NaN }":Qnt.call(t):s==="[object Error]"?Yre(t):s==="[object RegExp]"?n?qre.call(t).replace(/[\\^$*+?.()|[\]{}]/g,"\\$&"):qre.call(t):t instanceof Error?Yre(t):null}function Eye(t,e,n,i,r,s){if(r.indexOf(t)!==-1)return"[Circular]";r=r.slice(),r.push(t);const a=++i>e.maxDepth,o=e.min;if(e.callToJSON&&!a&&t.toJSON&&typeof t.toJSON=="function"&&!s)return sb(t.toJSON(),e,n,i,r,!0);const c=_ye.call(t);return c==="[object Arguments]"?a?"[Arguments]":(o?"":"Arguments ")+"["+(0,yM.printListItems)(t,e,n,i,r,sb)+"]":rit(c)?a?"["+t.constructor.name+"]":(o||!e.printBasicPrototype&&t.constructor.name==="Array"?"":t.constructor.name+" ")+"["+(0,yM.printListItems)(t,e,n,i,r,sb)+"]":c==="[object Map]"?a?"[Map]":"Map {"+(0,yM.printIteratorEntries)(t.entries(),e,n,i,r,sb," => ")+"}":c==="[object Set]"?a?"[Set]":"Set {"+(0,yM.printIteratorValues)(t.values(),e,n,i,r,sb)+"}":a||tit(t)?"["+BH(t)+"]":(o||!e.printBasicPrototype&&BH(t)==="Object"?"":BH(t)+" ")+"{"+(0,yM.printObjectProperties)(t,e,n,i,r,sb)+"}"}function oit(t){return t.serialize!=null}function Sye(t,e,n,i,r,s){let a;try{a=oit(t)?t.serialize(e,n,i,r,s,sb):t.print(e,o=>sb(o,n,i,r,s),o=>{const c=i+n.indent;return c+o.replace(iit,`
`+c)},{edgeSpacing:n.spacingOuter,min:n.min,spacing:n.spacingInner},n.colors)}catch(o){throw new yye(o.message,o.stack)}if(typeof a!="string")throw new Error(`pretty-format: Plugin must return type "string" but instead returned "${typeof a}".`);return a}function Tye(t,e){for(let n=0;n<t.length;n++)try{if(t[n].test(e))return t[n]}catch(i){throw new yye(i.message,i.stack)}return null}function sb(t,e,n,i,r,s){const a=Tye(e.plugins,t);if(a!==null)return Sye(a,t,e,n,i,r);const o=bye(t,e.printFunctionName,e.escapeRegex,e.escapeString);return o!==null?o:Eye(t,e,n,i,r,s)}const YK={comment:"gray",content:"reset",prop:"yellow",tag:"cyan",value:"green"},xye=Object.keys(YK),fm={callToJSON:!0,compareKeys:void 0,escapeRegex:!1,escapeString:!0,highlight:!1,indent:2,maxDepth:1/0,min:!1,plugins:[],printBasicPrototype:!0,printFunctionName:!0,theme:YK};fE.DEFAULT_OPTIONS=fm;function cit(t){if(Object.keys(t).forEach(e=>{if(!fm.hasOwnProperty(e))throw new Error(`pretty-format: Unknown option "${e}".`)}),t.min&&t.indent!==void 0&&t.indent!==0)throw new Error('pretty-format: Options "min" and "indent" cannot be used together.');if(t.theme!==void 0){if(t.theme===null)throw new Error('pretty-format: Option "theme" must not be null.');if(typeof t.theme!="object")throw new Error(`pretty-format: Option "theme" must be of type "object" but instead received "${typeof t.theme}".`)}}const lit=t=>xye.reduce((e,n)=>{const i=t.theme&&t.theme[n]!==void 0?t.theme[n]:YK[n],r=i&&qnt.default[i];if(r&&typeof r.close=="string"&&typeof r.open=="string")e[n]=r;else throw new Error(`pretty-format: Option "theme" has a key "${n}" whose value "${i}" is undefined in ansi-styles.`);return e},Object.create(null)),uit=()=>xye.reduce((t,e)=>(t[e]={close:"",open:""},t),Object.create(null)),wye=t=>t&&t.printFunctionName!==void 0?t.printFunctionName:fm.printFunctionName,Cye=t=>t&&t.escapeRegex!==void 0?t.escapeRegex:fm.escapeRegex,Aye=t=>t&&t.escapeString!==void 0?t.escapeString:fm.escapeString,Kre=t=>{var e;return{callToJSON:t&&t.callToJSON!==void 0?t.callToJSON:fm.callToJSON,colors:t&&t.highlight?lit(t):uit(),compareKeys:t&&typeof t.compareKeys=="function"?t.compareKeys:fm.compareKeys,escapeRegex:Cye(t),escapeString:Aye(t),indent:t&&t.min?"":hit(t&&t.indent!==void 0?t.indent:fm.indent),maxDepth:t&&t.maxDepth!==void 0?t.maxDepth:fm.maxDepth,min:t&&t.min!==void 0?t.min:fm.min,plugins:t&&t.plugins!==void 0?t.plugins:fm.plugins,printBasicPrototype:(e=t==null?void 0:t.printBasicPrototype)!==null&&e!==void 0?e:!0,printFunctionName:wye(t),spacingInner:t&&t.min?" ":`
`,spacingOuter:t&&t.min?"":`
`}};function hit(t){return new Array(t+1).join(" ")}function Rye(t,e){if(e&&(cit(e),e.plugins)){const i=Tye(e.plugins,t);if(i!==null)return Sye(i,t,Kre(e),"",0,[])}const n=bye(t,wye(e),Cye(e),Aye(e));return n!==null?n:Eye(t,Kre(e),"",0,[])}const dit={AsymmetricMatcher:$nt.default,ConvertAnsi:Wnt.default,DOMCollection:Ynt.default,DOMElement:Knt.default,Immutable:Xnt.default,ReactElement:Znt.default,ReactTestComponent:Jnt.default};vye=fE.plugins=dit;var fit=Rye;fE.default=fit;var pit=Object.prototype.toString;function mit(t){return typeof t=="function"||pit.call(t)==="[object Function]"}function git(t){var e=Number(t);return isNaN(e)?0:e===0||!isFinite(e)?e:(e>0?1:-1)*Math.floor(Math.abs(e))}var vit=Math.pow(2,53)-1;function _it(t){var e=git(t);return Math.min(Math.max(e,0),vit)}function pm(t,e){var n=Array,i=Object(t);if(t==null)throw new TypeError("Array.from requires an array-like object - not null or undefined");for(var r=_it(i.length),s=mit(n)?Object(new n(r)):new Array(r),a=0,o;a<r;)o=i[a],s[a]=o,a+=1;return s.length=r,s}function sI(t){"@babel/helpers - typeof";return sI=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},sI(t)}function yit(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function bit(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,Mye(i.key),i)}}function Eit(t,e,n){return e&&bit(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t}function Sit(t,e,n){return e=Mye(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Mye(t){var e=Tit(t,"string");return sI(e)==="symbol"?e:String(e)}function Tit(t,e){if(sI(t)!=="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(sI(i)!=="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var xit=function(){function t(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];yit(this,t),Sit(this,"items",void 0),this.items=e}return Eit(t,[{key:"add",value:function(n){return this.has(n)===!1&&this.items.push(n),this}},{key:"clear",value:function(){this.items=[]}},{key:"delete",value:function(n){var i=this.items.length;return this.items=this.items.filter(function(r){return r!==n}),i!==this.items.length}},{key:"forEach",value:function(n){var i=this;this.items.forEach(function(r){n(r,r,i)})}},{key:"has",value:function(n){return this.items.indexOf(n)!==-1}},{key:"size",get:function(){return this.items.length}}]),t}();const wit=typeof Set>"u"?Set:xit;function Au(t){var e;return(e=t.localName)!==null&&e!==void 0?e:t.tagName.toLowerCase()}var Cit={article:"article",aside:"complementary",button:"button",datalist:"listbox",dd:"definition",details:"group",dialog:"dialog",dt:"term",fieldset:"group",figure:"figure",form:"form",footer:"contentinfo",h1:"heading",h2:"heading",h3:"heading",h4:"heading",h5:"heading",h6:"heading",header:"banner",hr:"separator",html:"document",legend:"legend",li:"listitem",math:"math",main:"main",menu:"list",nav:"navigation",ol:"list",optgroup:"group",option:"option",output:"status",progress:"progressbar",section:"region",summary:"button",table:"table",tbody:"rowgroup",textarea:"textbox",tfoot:"rowgroup",td:"cell",th:"columnheader",thead:"rowgroup",tr:"row",ul:"list"},Ait={caption:new Set(["aria-label","aria-labelledby"]),code:new Set(["aria-label","aria-labelledby"]),deletion:new Set(["aria-label","aria-labelledby"]),emphasis:new Set(["aria-label","aria-labelledby"]),generic:new Set(["aria-label","aria-labelledby","aria-roledescription"]),insertion:new Set(["aria-label","aria-labelledby"]),paragraph:new Set(["aria-label","aria-labelledby"]),presentation:new Set(["aria-label","aria-labelledby"]),strong:new Set(["aria-label","aria-labelledby"]),subscript:new Set(["aria-label","aria-labelledby"]),superscript:new Set(["aria-label","aria-labelledby"])};function Rit(t,e){return["aria-atomic","aria-busy","aria-controls","aria-current","aria-describedby","aria-details","aria-dropeffect","aria-flowto","aria-grabbed","aria-hidden","aria-keyshortcuts","aria-label","aria-labelledby","aria-live","aria-owns","aria-relevant","aria-roledescription"].some(function(n){var i;return t.hasAttribute(n)&&!((i=Ait[e])!==null&&i!==void 0&&i.has(n))})}function Oye(t,e){return Rit(t,e)}function Mit(t){var e=Nit(t);if(e===null||e==="presentation"){var n=Oit(t);if(e!=="presentation"||Oye(t,n||""))return n}return e}function Oit(t){var e=Cit[Au(t)];if(e!==void 0)return e;switch(Au(t)){case"a":case"area":case"link":if(t.hasAttribute("href"))return"link";break;case"img":return t.getAttribute("alt")===""&&!Oye(t,"img")?"presentation":"img";case"input":{var n=t,i=n.type;switch(i){case"button":case"image":case"reset":case"submit":return"button";case"checkbox":case"radio":return i;case"range":return"slider";case"email":case"tel":case"text":case"url":return t.hasAttribute("list")?"combobox":"textbox";case"search":return t.hasAttribute("list")?"combobox":"searchbox";case"number":return"spinbutton";default:return null}}case"select":return t.hasAttribute("multiple")||t.size>1?"listbox":"combobox"}return null}function Nit(t){var e=t.getAttribute("role");if(e!==null){var n=e.trim().split(" ")[0];if(n.length>0)return n}return null}function Ba(t){return t!==null&&t.nodeType===t.ELEMENT_NODE}function Nye(t){return Ba(t)&&Au(t)==="caption"}function vL(t){return Ba(t)&&Au(t)==="input"}function Iit(t){return Ba(t)&&Au(t)==="optgroup"}function kit(t){return Ba(t)&&Au(t)==="select"}function Pit(t){return Ba(t)&&Au(t)==="table"}function Dit(t){return Ba(t)&&Au(t)==="textarea"}function Lit(t){var e=t.ownerDocument===null?t:t.ownerDocument,n=e.defaultView;if(n===null)throw new TypeError("no window available");return n}function Uit(t){return Ba(t)&&Au(t)==="fieldset"}function Bit(t){return Ba(t)&&Au(t)==="legend"}function Fit(t){return Ba(t)&&Au(t)==="slot"}function zit(t){return Ba(t)&&t.ownerSVGElement!==void 0}function jit(t){return Ba(t)&&Au(t)==="svg"}function Hit(t){return zit(t)&&Au(t)==="title"}function aB(t,e){if(Ba(t)&&t.hasAttribute(e)){var n=t.getAttribute(e).split(" "),i=t.getRootNode?t.getRootNode():t.ownerDocument;return n.map(function(r){return i.getElementById(r)}).filter(function(r){return r!==null})}return[]}function l_(t,e){return Ba(t)?e.indexOf(Mit(t))!==-1:!1}function Vit(t){return t.trim().replace(/\s\s+/g," ")}function Git(t,e){if(!Ba(t))return!1;if(t.hasAttribute("hidden")||t.getAttribute("aria-hidden")==="true")return!0;var n=e(t);return n.getPropertyValue("display")==="none"||n.getPropertyValue("visibility")==="hidden"}function qit(t){return l_(t,["button","combobox","listbox","textbox"])||Iye(t,"range")}function Iye(t,e){if(!Ba(t))return!1;switch(e){case"range":return l_(t,["meter","progressbar","scrollbar","slider","spinbutton"]);default:throw new TypeError("No knowledge about abstract role '".concat(e,"'. This is likely a bug :("))}}function Xre(t,e){var n=pm(t.querySelectorAll(e));return aB(t,"aria-owns").forEach(function(i){n.push.apply(n,pm(i.querySelectorAll(e)))}),n}function $it(t){return kit(t)?t.selectedOptions||Xre(t,"[selected]"):Xre(t,'[aria-selected="true"]')}function Wit(t){return l_(t,["none","presentation"])}function Yit(t){return Nye(t)}function Kit(t){return l_(t,["button","cell","checkbox","columnheader","gridcell","heading","label","legend","link","menuitem","menuitemcheckbox","menuitemradio","option","radio","row","rowheader","switch","tab","tooltip","treeitem"])}function Xit(t){return!1}function Zit(t){return vL(t)||Dit(t)?t.value:t.textContent||""}function Zre(t){var e=t.getPropertyValue("content");return/^["'].*["']$/.test(e)?e.slice(1,-1):""}function kye(t){var e=Au(t);return e==="button"||e==="input"&&t.getAttribute("type")!=="hidden"||e==="meter"||e==="output"||e==="progress"||e==="select"||e==="textarea"}function Pye(t){if(kye(t))return t;var e=null;return t.childNodes.forEach(function(n){if(e===null&&Ba(n)){var i=Pye(n);i!==null&&(e=i)}}),e}function Jit(t){if(t.control!==void 0)return t.control;var e=t.getAttribute("for");return e!==null?t.ownerDocument.getElementById(e):Pye(t)}function Qit(t){var e=t.labels;if(e===null)return e;if(e!==void 0)return pm(e);if(!kye(t))return null;var n=t.ownerDocument;return pm(n.querySelectorAll("label")).filter(function(i){return Jit(i)===t})}function ert(t){var e=t.assignedNodes();return e.length===0?pm(t.childNodes):e}function Dye(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=new wit,i=Lit(t),r=e.compute,s=r===void 0?"name":r,a=e.computedStyleSupportsPseudoElements,o=a===void 0?e.getComputedStyle!==void 0:a,c=e.getComputedStyle,l=c===void 0?i.getComputedStyle.bind(i):c,u=e.hidden,h=u===void 0?!1:u;function d(v,b){var S="";if(Ba(v)&&o){var x=l(v,"::before"),M=Zre(x);S="".concat(M," ").concat(S)}var R=Fit(v)?ert(v):pm(v.childNodes).concat(aB(v,"aria-owns"));if(R.forEach(function(P){var U=_(P,{isEmbeddedInLabel:b.isEmbeddedInLabel,isReferenced:!1,recursion:!0}),V=Ba(P)?l(P).getPropertyValue("display"):"inline",$=V!=="inline"?" ":"";S+="".concat($).concat(U).concat($)}),Ba(v)&&o){var I=l(v,"::after"),k=Zre(I);S="".concat(S," ").concat(k)}return S.trim()}function f(v,b){var S=v.getAttributeNode(b);return S!==null&&!n.has(S)&&S.value.trim()!==""?(n.add(S),S.value):null}function p(v){return Ba(v)?f(v,"title"):null}function g(v){if(!Ba(v))return null;if(Uit(v)){n.add(v);for(var b=pm(v.childNodes),S=0;S<b.length;S+=1){var x=b[S];if(Bit(x))return _(x,{isEmbeddedInLabel:!1,isReferenced:!1,recursion:!1})}}else if(Pit(v)){n.add(v);for(var M=pm(v.childNodes),R=0;R<M.length;R+=1){var I=M[R];if(Nye(I))return _(I,{isEmbeddedInLabel:!1,isReferenced:!1,recursion:!1})}}else if(jit(v)){n.add(v);for(var k=pm(v.childNodes),P=0;P<k.length;P+=1){var U=k[P];if(Hit(U))return U.textContent}return null}else if(Au(v)==="img"||Au(v)==="area"){var V=f(v,"alt");if(V!==null)return V}else if(Iit(v)){var $=f(v,"label");if($!==null)return $}if(vL(v)&&(v.type==="button"||v.type==="submit"||v.type==="reset")){var q=f(v,"value");if(q!==null)return q;if(v.type==="submit")return"Submit";if(v.type==="reset")return"Reset"}var Y=Qit(v);if(Y!==null&&Y.length!==0)return n.add(v),pm(Y).map(function(K){return _(K,{isEmbeddedInLabel:!0,isReferenced:!1,recursion:!0})}).filter(function(K){return K.length>0}).join(" ");if(vL(v)&&v.type==="image"){var te=f(v,"alt");if(te!==null)return te;var G=f(v,"title");return G!==null?G:"Submit Query"}if(l_(v,["button"])){var J=d(v,{isEmbeddedInLabel:!1,isReferenced:!1});if(J!=="")return J}return null}function _(v,b){if(n.has(v))return"";if(!h&&Git(v,l)&&!b.isReferenced)return n.add(v),"";var S=Ba(v)?v.getAttributeNode("aria-labelledby"):null,x=S!==null&&!n.has(S)?aB(v,"aria-labelledby"):[];if(s==="name"&&!b.isReferenced&&x.length>0)return n.add(S),x.map(function(V){return _(V,{isEmbeddedInLabel:b.isEmbeddedInLabel,isReferenced:!0,recursion:!1})}).join(" ");var M=b.recursion&&qit(v)&&s==="name";if(!M){var R=(Ba(v)&&v.getAttribute("aria-label")||"").trim();if(R!==""&&s==="name")return n.add(v),R;if(!Wit(v)){var I=g(v);if(I!==null)return n.add(v),I}}if(l_(v,["menu"]))return n.add(v),"";if(M||b.isEmbeddedInLabel||b.isReferenced){if(l_(v,["combobox","listbox"])){n.add(v);var k=$it(v);return k.length===0?vL(v)?v.value:"":pm(k).map(function(V){return _(V,{isEmbeddedInLabel:b.isEmbeddedInLabel,isReferenced:!1,recursion:!0})}).join(" ")}if(Iye(v,"range"))return n.add(v),v.hasAttribute("aria-valuetext")?v.getAttribute("aria-valuetext"):v.hasAttribute("aria-valuenow")?v.getAttribute("aria-valuenow"):v.getAttribute("value")||"";if(l_(v,["textbox"]))return n.add(v),Zit(v)}if(Kit(v)||Ba(v)&&b.isReferenced||Yit(v)||Xit()){var P=d(v,{isEmbeddedInLabel:b.isEmbeddedInLabel,isReferenced:!1});if(P!=="")return n.add(v),P}if(v.nodeType===v.TEXT_NODE)return n.add(v),v.textContent||"";if(b.recursion)return n.add(v),d(v,{isEmbeddedInLabel:b.isEmbeddedInLabel,isReferenced:!1});var U=p(v);return U!==null?(n.add(v),U):(n.add(v),"")}return Vit(_(t,{isEmbeddedInLabel:!1,isReferenced:s==="description",recursion:!1}))}function aI(t){"@babel/helpers - typeof";return aI=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},aI(t)}function Jre(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter(function(r){return Object.getOwnPropertyDescriptor(t,r).enumerable})),n.push.apply(n,i)}return n}function Qre(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?Jre(Object(n),!0).forEach(function(i){trt(t,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Jre(Object(n)).forEach(function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(n,i))})}return t}function trt(t,e,n){return e=nrt(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function nrt(t){var e=irt(t,"string");return aI(e)==="symbol"?e:String(e)}function irt(t,e){if(aI(t)!=="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(aI(i)!=="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Lye(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=aB(t,"aria-describedby").map(function(r){return Dye(r,Qre(Qre({},e),{},{compute:"description"}))}).join(" ");if(n===""){var i=t.getAttribute("title");n=i===null?"":i}return n}function rrt(t){return l_(t,["caption","code","deletion","emphasis","generic","insertion","paragraph","presentation","strong","subscript","superscript"])}function KK(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return rrt(t)?"":Dye(t,e)}var _m={},L4={},Q1={},U4={};Object.defineProperty(U4,"__esModule",{value:!0});U4.default=void 0;function srt(){var t=this,e=0,n={"@@iterator":function(){return n},next:function(){if(e<t.length){var r=t[e];return e=e+1,{done:!1,value:r}}else return{done:!0}}};return n}var art=srt;U4.default=art;Object.defineProperty(Q1,"__esModule",{value:!0});Q1.default=lrt;var ort=crt(U4);function crt(t){return t&&t.__esModule?t:{default:t}}function v$(t){"@babel/helpers - typeof";return v$=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},v$(t)}function lrt(t,e){return typeof Symbol=="function"&&v$(Symbol.iterator)==="symbol"&&Object.defineProperty(t,Symbol.iterator,{value:ort.default.bind(e)}),t}Object.defineProperty(L4,"__esModule",{value:!0});L4.default=void 0;var urt=hrt(Q1);function hrt(t){return t&&t.__esModule?t:{default:t}}function FH(t,e){return prt(t)||frt(t,e)||Uye(t,e)||drt()}function drt(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function frt(t,e){var n=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(n!=null){var i=[],r=!0,s=!1,a,o;try{for(n=n.call(t);!(r=(a=n.next()).done)&&(i.push(a.value),!(e&&i.length===e));r=!0);}catch(c){s=!0,o=c}finally{try{!r&&n.return!=null&&n.return()}finally{if(s)throw o}}return i}}function prt(t){if(Array.isArray(t))return t}function mrt(t,e){var n=typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=Uye(t))||e){n&&(t=n);var i=0,r=function(){};return{s:r,n:function(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}},e:function(l){throw l},f:r}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var s=!0,a=!1,o;return{s:function(){n=n.call(t)},n:function(){var l=n.next();return s=l.done,l},e:function(l){a=!0,o=l},f:function(){try{!s&&n.return!=null&&n.return()}finally{if(a)throw o}}}}function Uye(t,e){if(t){if(typeof t=="string")return ese(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);if(n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set")return Array.from(t);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return ese(t,e)}}function ese(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}var yw=[["aria-activedescendant",{type:"id"}],["aria-atomic",{type:"boolean"}],["aria-autocomplete",{type:"token",values:["inline","list","both","none"]}],["aria-braillelabel",{type:"string"}],["aria-brailleroledescription",{type:"string"}],["aria-busy",{type:"boolean"}],["aria-checked",{type:"tristate"}],["aria-colcount",{type:"integer"}],["aria-colindex",{type:"integer"}],["aria-colspan",{type:"integer"}],["aria-controls",{type:"idlist"}],["aria-current",{type:"token",values:["page","step","location","date","time",!0,!1]}],["aria-describedby",{type:"idlist"}],["aria-description",{type:"string"}],["aria-details",{type:"id"}],["aria-disabled",{type:"boolean"}],["aria-dropeffect",{type:"tokenlist",values:["copy","execute","link","move","none","popup"]}],["aria-errormessage",{type:"id"}],["aria-expanded",{type:"boolean",allowundefined:!0}],["aria-flowto",{type:"idlist"}],["aria-grabbed",{type:"boolean",allowundefined:!0}],["aria-haspopup",{type:"token",values:[!1,!0,"menu","listbox","tree","grid","dialog"]}],["aria-hidden",{type:"boolean",allowundefined:!0}],["aria-invalid",{type:"token",values:["grammar",!1,"spelling",!0]}],["aria-keyshortcuts",{type:"string"}],["aria-label",{type:"string"}],["aria-labelledby",{type:"idlist"}],["aria-level",{type:"integer"}],["aria-live",{type:"token",values:["assertive","off","polite"]}],["aria-modal",{type:"boolean"}],["aria-multiline",{type:"boolean"}],["aria-multiselectable",{type:"boolean"}],["aria-orientation",{type:"token",values:["vertical","undefined","horizontal"]}],["aria-owns",{type:"idlist"}],["aria-placeholder",{type:"string"}],["aria-posinset",{type:"integer"}],["aria-pressed",{type:"tristate"}],["aria-readonly",{type:"boolean"}],["aria-relevant",{type:"tokenlist",values:["additions","all","removals","text"]}],["aria-required",{type:"boolean"}],["aria-roledescription",{type:"string"}],["aria-rowcount",{type:"integer"}],["aria-rowindex",{type:"integer"}],["aria-rowspan",{type:"integer"}],["aria-selected",{type:"boolean",allowundefined:!0}],["aria-setsize",{type:"integer"}],["aria-sort",{type:"token",values:["ascending","descending","none","other"]}],["aria-valuemax",{type:"number"}],["aria-valuemin",{type:"number"}],["aria-valuenow",{type:"number"}],["aria-valuetext",{type:"string"}]],_$={entries:function(){return yw},forEach:function(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,i=mrt(yw),r;try{for(i.s();!(r=i.n()).done;){var s=FH(r.value,2),a=s[0],o=s[1];e.call(n,o,a,yw)}}catch(c){i.e(c)}finally{i.f()}},get:function(e){var n=yw.find(function(i){return i[0]===e});return n&&n[1]},has:function(e){return!!_$.get(e)},keys:function(){return yw.map(function(e){var n=FH(e,1),i=n[0];return i})},values:function(){return yw.map(function(e){var n=FH(e,2),i=n[1];return i})}},grt=(0,urt.default)(_$,_$.entries());L4.default=grt;var B4={};Object.defineProperty(B4,"__esModule",{value:!0});B4.default=void 0;var vrt=_rt(Q1);function _rt(t){return t&&t.__esModule?t:{default:t}}function zH(t,e){return Ert(t)||brt(t,e)||Bye(t,e)||yrt()}function yrt(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function brt(t,e){var n=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(n!=null){var i=[],r=!0,s=!1,a,o;try{for(n=n.call(t);!(r=(a=n.next()).done)&&(i.push(a.value),!(e&&i.length===e));r=!0);}catch(c){s=!0,o=c}finally{try{!r&&n.return!=null&&n.return()}finally{if(s)throw o}}return i}}function Ert(t){if(Array.isArray(t))return t}function Srt(t,e){var n=typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=Bye(t))||e){n&&(t=n);var i=0,r=function(){};return{s:r,n:function(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}},e:function(l){throw l},f:r}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var s=!0,a=!1,o;return{s:function(){n=n.call(t)},n:function(){var l=n.next();return s=l.done,l},e:function(l){a=!0,o=l},f:function(){try{!s&&n.return!=null&&n.return()}finally{if(a)throw o}}}}function Bye(t,e){if(t){if(typeof t=="string")return tse(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);if(n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set")return Array.from(t);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return tse(t,e)}}function tse(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}var bw=[["a",{reserved:!1}],["abbr",{reserved:!1}],["acronym",{reserved:!1}],["address",{reserved:!1}],["applet",{reserved:!1}],["area",{reserved:!1}],["article",{reserved:!1}],["aside",{reserved:!1}],["audio",{reserved:!1}],["b",{reserved:!1}],["base",{reserved:!0}],["bdi",{reserved:!1}],["bdo",{reserved:!1}],["big",{reserved:!1}],["blink",{reserved:!1}],["blockquote",{reserved:!1}],["body",{reserved:!1}],["br",{reserved:!1}],["button",{reserved:!1}],["canvas",{reserved:!1}],["caption",{reserved:!1}],["center",{reserved:!1}],["cite",{reserved:!1}],["code",{reserved:!1}],["col",{reserved:!0}],["colgroup",{reserved:!0}],["content",{reserved:!1}],["data",{reserved:!1}],["datalist",{reserved:!1}],["dd",{reserved:!1}],["del",{reserved:!1}],["details",{reserved:!1}],["dfn",{reserved:!1}],["dialog",{reserved:!1}],["dir",{reserved:!1}],["div",{reserved:!1}],["dl",{reserved:!1}],["dt",{reserved:!1}],["em",{reserved:!1}],["embed",{reserved:!1}],["fieldset",{reserved:!1}],["figcaption",{reserved:!1}],["figure",{reserved:!1}],["font",{reserved:!1}],["footer",{reserved:!1}],["form",{reserved:!1}],["frame",{reserved:!1}],["frameset",{reserved:!1}],["h1",{reserved:!1}],["h2",{reserved:!1}],["h3",{reserved:!1}],["h4",{reserved:!1}],["h5",{reserved:!1}],["h6",{reserved:!1}],["head",{reserved:!0}],["header",{reserved:!1}],["hgroup",{reserved:!1}],["hr",{reserved:!1}],["html",{reserved:!0}],["i",{reserved:!1}],["iframe",{reserved:!1}],["img",{reserved:!1}],["input",{reserved:!1}],["ins",{reserved:!1}],["kbd",{reserved:!1}],["keygen",{reserved:!1}],["label",{reserved:!1}],["legend",{reserved:!1}],["li",{reserved:!1}],["link",{reserved:!0}],["main",{reserved:!1}],["map",{reserved:!1}],["mark",{reserved:!1}],["marquee",{reserved:!1}],["menu",{reserved:!1}],["menuitem",{reserved:!1}],["meta",{reserved:!0}],["meter",{reserved:!1}],["nav",{reserved:!1}],["noembed",{reserved:!0}],["noscript",{reserved:!0}],["object",{reserved:!1}],["ol",{reserved:!1}],["optgroup",{reserved:!1}],["option",{reserved:!1}],["output",{reserved:!1}],["p",{reserved:!1}],["param",{reserved:!0}],["picture",{reserved:!0}],["pre",{reserved:!1}],["progress",{reserved:!1}],["q",{reserved:!1}],["rp",{reserved:!1}],["rt",{reserved:!1}],["rtc",{reserved:!1}],["ruby",{reserved:!1}],["s",{reserved:!1}],["samp",{reserved:!1}],["script",{reserved:!0}],["section",{reserved:!1}],["select",{reserved:!1}],["small",{reserved:!1}],["source",{reserved:!0}],["spacer",{reserved:!1}],["span",{reserved:!1}],["strike",{reserved:!1}],["strong",{reserved:!1}],["style",{reserved:!0}],["sub",{reserved:!1}],["summary",{reserved:!1}],["sup",{reserved:!1}],["table",{reserved:!1}],["tbody",{reserved:!1}],["td",{reserved:!1}],["textarea",{reserved:!1}],["tfoot",{reserved:!1}],["th",{reserved:!1}],["thead",{reserved:!1}],["time",{reserved:!1}],["title",{reserved:!0}],["tr",{reserved:!1}],["track",{reserved:!0}],["tt",{reserved:!1}],["u",{reserved:!1}],["ul",{reserved:!1}],["var",{reserved:!1}],["video",{reserved:!1}],["wbr",{reserved:!1}],["xmp",{reserved:!1}]],y$={entries:function(){return bw},forEach:function(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,i=Srt(bw),r;try{for(i.s();!(r=i.n()).done;){var s=zH(r.value,2),a=s[0],o=s[1];e.call(n,o,a,bw)}}catch(c){i.e(c)}finally{i.f()}},get:function(e){var n=bw.find(function(i){return i[0]===e});return n&&n[1]},has:function(e){return!!y$.get(e)},keys:function(){return bw.map(function(e){var n=zH(e,1),i=n[0];return i})},values:function(){return bw.map(function(e){var n=zH(e,2),i=n[1];return i})}},Trt=(0,vrt.default)(y$,y$.entries());B4.default=Trt;var _R={},F4={},z4={};Object.defineProperty(z4,"__esModule",{value:!0});z4.default=void 0;var xrt={abstract:!0,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{},relatedConcepts:[],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","widget"]]},wrt=xrt;z4.default=wrt;var j4={};Object.defineProperty(j4,"__esModule",{value:!0});j4.default=void 0;var Crt={abstract:!0,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-activedescendant":null,"aria-disabled":null},relatedConcepts:[],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","widget"]]},Art=Crt;j4.default=Art;var H4={};Object.defineProperty(H4,"__esModule",{value:!0});H4.default=void 0;var Rrt={abstract:!0,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-disabled":null},relatedConcepts:[{concept:{name:"input"},module:"XForms"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","widget"]]},Mrt=Rrt;H4.default=Mrt;var V4={};Object.defineProperty(V4,"__esModule",{value:!0});V4.default=void 0;var Ort={abstract:!0,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{},relatedConcepts:[],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section"]]},Nrt=Ort;V4.default=Nrt;var G4={};Object.defineProperty(G4,"__esModule",{value:!0});G4.default=void 0;var Irt={abstract:!0,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-valuemax":null,"aria-valuemin":null,"aria-valuenow":null},relatedConcepts:[],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure"]]},krt=Irt;G4.default=krt;var q4={};Object.defineProperty(q4,"__esModule",{value:!0});q4.default=void 0;var Prt={abstract:!0,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:[],prohibitedProps:[],props:{"aria-atomic":null,"aria-busy":null,"aria-controls":null,"aria-current":null,"aria-describedby":null,"aria-details":null,"aria-dropeffect":null,"aria-flowto":null,"aria-grabbed":null,"aria-hidden":null,"aria-keyshortcuts":null,"aria-label":null,"aria-labelledby":null,"aria-live":null,"aria-owns":null,"aria-relevant":null,"aria-roledescription":null},relatedConcepts:[{concept:{name:"role"},module:"XHTML"},{concept:{name:"type"},module:"Dublin Core"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[]},Drt=Prt;q4.default=Drt;var $4={};Object.defineProperty($4,"__esModule",{value:!0});$4.default=void 0;var Lrt={abstract:!0,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:[],prohibitedProps:[],props:{},relatedConcepts:[{concept:{name:"frontmatter"},module:"DTB"},{concept:{name:"level"},module:"DTB"},{concept:{name:"level"},module:"SMIL"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure"]]},Urt=Lrt;$4.default=Urt;var W4={};Object.defineProperty(W4,"__esModule",{value:!0});W4.default=void 0;var Brt={abstract:!0,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author","contents"],prohibitedProps:[],props:{},relatedConcepts:[],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure"]]},Frt=Brt;W4.default=Frt;var Y4={};Object.defineProperty(Y4,"__esModule",{value:!0});Y4.default=void 0;var zrt={abstract:!0,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-orientation":null},relatedConcepts:[],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","widget","composite"],["roletype","structure","section","group"]]},jrt=zrt;Y4.default=jrt;var K4={};Object.defineProperty(K4,"__esModule",{value:!0});K4.default=void 0;var Hrt={abstract:!0,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:[],prohibitedProps:[],props:{},relatedConcepts:[],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype"]]},Vrt=Hrt;K4.default=Vrt;var X4={};Object.defineProperty(X4,"__esModule",{value:!0});X4.default=void 0;var Grt={abstract:!0,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:[],prohibitedProps:[],props:{},relatedConcepts:[],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype"]]},qrt=Grt;X4.default=qrt;var Z4={};Object.defineProperty(Z4,"__esModule",{value:!0});Z4.default=void 0;var $rt={abstract:!0,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-modal":null},relatedConcepts:[],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype"]]},Wrt=$rt;Z4.default=Wrt;Object.defineProperty(F4,"__esModule",{value:!0});F4.default=void 0;var Yrt=Lp(z4),Krt=Lp(j4),Xrt=Lp(H4),Zrt=Lp(V4),Jrt=Lp(G4),Qrt=Lp(q4),est=Lp($4),tst=Lp(W4),nst=Lp(Y4),ist=Lp(K4),rst=Lp(X4),sst=Lp(Z4);function Lp(t){return t&&t.__esModule?t:{default:t}}var ast=[["command",Yrt.default],["composite",Krt.default],["input",Xrt.default],["landmark",Zrt.default],["range",Jrt.default],["roletype",Qrt.default],["section",est.default],["sectionhead",tst.default],["select",nst.default],["structure",ist.default],["widget",rst.default],["window",sst.default]],ost=ast;F4.default=ost;var J4={},Q4={};Object.defineProperty(Q4,"__esModule",{value:!0});Q4.default=void 0;var cst={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-atomic":"true","aria-live":"assertive"},relatedConcepts:[{concept:{name:"alert"},module:"XForms"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section"]]},lst=cst;Q4.default=lst;var e6={};Object.defineProperty(e6,"__esModule",{value:!0});e6.default=void 0;var ust={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{},relatedConcepts:[{concept:{name:"alert"},module:"XForms"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section","alert"],["roletype","window","dialog"]]},hst=ust;e6.default=hst;var t6={};Object.defineProperty(t6,"__esModule",{value:!0});t6.default=void 0;var dst={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-activedescendant":null,"aria-disabled":null,"aria-errormessage":null,"aria-expanded":null,"aria-haspopup":null,"aria-invalid":null},relatedConcepts:[{concept:{name:"Device Independence Delivery Unit"}}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure"]]},fst=dst;t6.default=fst;var n6={};Object.defineProperty(n6,"__esModule",{value:!0});n6.default=void 0;var pst={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-posinset":null,"aria-setsize":null},relatedConcepts:[{concept:{name:"article"},module:"HTML"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","document"]]},mst=pst;n6.default=mst;var i6={};Object.defineProperty(i6,"__esModule",{value:!0});i6.default=void 0;var gst={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{},relatedConcepts:[{concept:{constraints:["scoped to the body element"],name:"header"},module:"HTML"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section","landmark"]]},vst=gst;i6.default=vst;var r6={};Object.defineProperty(r6,"__esModule",{value:!0});r6.default=void 0;var _st={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{},relatedConcepts:[{concept:{name:"blockquote"},module:"HTML"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section"]]},yst=_st;r6.default=yst;var s6={};Object.defineProperty(s6,"__esModule",{value:!0});s6.default=void 0;var bst={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!0,nameFrom:["author","contents"],prohibitedProps:[],props:{"aria-disabled":null,"aria-expanded":null,"aria-haspopup":null,"aria-pressed":null},relatedConcepts:[{concept:{attributes:[{name:"type",value:"button"}],name:"input"},module:"HTML"},{concept:{attributes:[{name:"type",value:"image"}],name:"input"},module:"HTML"},{concept:{attributes:[{name:"type",value:"reset"}],name:"input"},module:"HTML"},{concept:{attributes:[{name:"type",value:"submit"}],name:"input"},module:"HTML"},{concept:{name:"button"},module:"HTML"},{concept:{name:"trigger"},module:"XForms"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","widget","command"]]},Est=bst;s6.default=Est;var a6={};Object.defineProperty(a6,"__esModule",{value:!0});a6.default=void 0;var Sst={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["prohibited"],prohibitedProps:["aria-label","aria-labelledby"],props:{},relatedConcepts:[{concept:{name:"caption"},module:"HTML"}],requireContextRole:["figure","grid","table"],requiredContextRole:["figure","grid","table"],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section"]]},Tst=Sst;a6.default=Tst;var o6={};Object.defineProperty(o6,"__esModule",{value:!0});o6.default=void 0;var xst={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author","contents"],prohibitedProps:[],props:{"aria-colindex":null,"aria-colspan":null,"aria-rowindex":null,"aria-rowspan":null},relatedConcepts:[{concept:{constraints:["ancestor table element has table role"],name:"td"},module:"HTML"}],requireContextRole:["row"],requiredContextRole:["row"],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section"]]},wst=xst;o6.default=wst;var c6={};Object.defineProperty(c6,"__esModule",{value:!0});c6.default=void 0;var Cst={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!0,nameFrom:["author","contents"],prohibitedProps:[],props:{"aria-checked":null,"aria-errormessage":null,"aria-expanded":null,"aria-invalid":null,"aria-readonly":null,"aria-required":null},relatedConcepts:[{concept:{attributes:[{name:"type",value:"checkbox"}],name:"input"},module:"HTML"},{concept:{name:"option"},module:"ARIA"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{"aria-checked":null},superClass:[["roletype","widget","input"]]},Ast=Cst;c6.default=Ast;var l6={};Object.defineProperty(l6,"__esModule",{value:!0});l6.default=void 0;var Rst={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["prohibited"],prohibitedProps:["aria-label","aria-labelledby"],props:{},relatedConcepts:[{concept:{name:"code"},module:"HTML"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section"]]},Mst=Rst;l6.default=Mst;var u6={};Object.defineProperty(u6,"__esModule",{value:!0});u6.default=void 0;var Ost={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!1,nameFrom:["author","contents"],prohibitedProps:[],props:{"aria-sort":null},relatedConcepts:[{concept:{name:"th"},module:"HTML"},{concept:{attributes:[{name:"scope",value:"col"}],name:"th"},module:"HTML"},{concept:{attributes:[{name:"scope",value:"colgroup"}],name:"th"},module:"HTML"}],requireContextRole:["row"],requiredContextRole:["row"],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section","cell"],["roletype","structure","section","cell","gridcell"],["roletype","widget","gridcell"],["roletype","structure","sectionhead"]]},Nst=Ost;u6.default=Nst;var h6={};Object.defineProperty(h6,"__esModule",{value:!0});h6.default=void 0;var Ist={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-activedescendant":null,"aria-autocomplete":null,"aria-errormessage":null,"aria-invalid":null,"aria-readonly":null,"aria-required":null,"aria-expanded":"false","aria-haspopup":"listbox"},relatedConcepts:[{concept:{attributes:[{constraints:["set"],name:"list"},{name:"type",value:"email"}],name:"input"},module:"HTML"},{concept:{attributes:[{constraints:["set"],name:"list"},{name:"type",value:"search"}],name:"input"},module:"HTML"},{concept:{attributes:[{constraints:["set"],name:"list"},{name:"type",value:"tel"}],name:"input"},module:"HTML"},{concept:{attributes:[{constraints:["set"],name:"list"},{name:"type",value:"text"}],name:"input"},module:"HTML"},{concept:{attributes:[{constraints:["set"],name:"list"},{name:"type",value:"url"}],name:"input"},module:"HTML"},{concept:{attributes:[{constraints:["set"],name:"list"},{name:"type",value:"url"}],name:"input"},module:"HTML"},{concept:{attributes:[{constraints:["undefined"],name:"multiple"},{constraints:["undefined"],name:"size"}],constraints:["the multiple attribute is not set and the size attribute does not have a value greater than 1"],name:"select"},module:"HTML"},{concept:{name:"select"},module:"XForms"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{"aria-controls":null,"aria-expanded":"false"},superClass:[["roletype","widget","input"]]},kst=Ist;h6.default=kst;var d6={};Object.defineProperty(d6,"__esModule",{value:!0});d6.default=void 0;var Pst={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{},relatedConcepts:[{concept:{name:"aside"},module:"HTML"},{concept:{attributes:[{constraints:["set"],name:"aria-label"}],constraints:["scoped to a sectioning content element","scoped to a sectioning root element other than body"],name:"aside"},module:"HTML"},{concept:{attributes:[{constraints:["set"],name:"aria-labelledby"}],constraints:["scoped to a sectioning content element","scoped to a sectioning root element other than body"],name:"aside"},module:"HTML"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section","landmark"]]},Dst=Pst;d6.default=Dst;var f6={};Object.defineProperty(f6,"__esModule",{value:!0});f6.default=void 0;var Lst={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{},relatedConcepts:[{concept:{constraints:["scoped to the body element"],name:"footer"},module:"HTML"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section","landmark"]]},Ust=Lst;f6.default=Ust;var p6={};Object.defineProperty(p6,"__esModule",{value:!0});p6.default=void 0;var Bst={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{},relatedConcepts:[{concept:{name:"dd"},module:"HTML"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section"]]},Fst=Bst;p6.default=Fst;var m6={};Object.defineProperty(m6,"__esModule",{value:!0});m6.default=void 0;var zst={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["prohibited"],prohibitedProps:["aria-label","aria-labelledby"],props:{},relatedConcepts:[{concept:{name:"del"},module:"HTML"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section"]]},jst=zst;m6.default=jst;var g6={};Object.defineProperty(g6,"__esModule",{value:!0});g6.default=void 0;var Hst={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{},relatedConcepts:[{concept:{name:"dialog"},module:"HTML"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","window"]]},Vst=Hst;g6.default=Vst;var v6={};Object.defineProperty(v6,"__esModule",{value:!0});v6.default=void 0;var Gst={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{},relatedConcepts:[{module:"DAISY Guide"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section","list"]]},qst=Gst;v6.default=qst;var _6={};Object.defineProperty(_6,"__esModule",{value:!0});_6.default=void 0;var $st={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{},relatedConcepts:[{concept:{name:"Device Independence Delivery Unit"}},{concept:{name:"html"},module:"HTML"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure"]]},Wst=$st;_6.default=Wst;var y6={};Object.defineProperty(y6,"__esModule",{value:!0});y6.default=void 0;var Yst={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["prohibited"],prohibitedProps:["aria-label","aria-labelledby"],props:{},relatedConcepts:[{concept:{name:"em"},module:"HTML"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section"]]},Kst=Yst;y6.default=Kst;var b6={};Object.defineProperty(b6,"__esModule",{value:!0});b6.default=void 0;var Xst={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{},relatedConcepts:[],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[["article"]],requiredProps:{},superClass:[["roletype","structure","section","list"]]},Zst=Xst;b6.default=Zst;var E6={};Object.defineProperty(E6,"__esModule",{value:!0});E6.default=void 0;var Jst={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{},relatedConcepts:[{concept:{name:"figure"},module:"HTML"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section"]]},Qst=Jst;E6.default=Qst;var S6={};Object.defineProperty(S6,"__esModule",{value:!0});S6.default=void 0;var eat={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{},relatedConcepts:[{concept:{attributes:[{constraints:["set"],name:"aria-label"}],name:"form"},module:"HTML"},{concept:{attributes:[{constraints:["set"],name:"aria-labelledby"}],name:"form"},module:"HTML"},{concept:{attributes:[{constraints:["set"],name:"name"}],name:"form"},module:"HTML"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section","landmark"]]},tat=eat;S6.default=tat;var T6={};Object.defineProperty(T6,"__esModule",{value:!0});T6.default=void 0;var nat={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["prohibited"],prohibitedProps:["aria-label","aria-labelledby"],props:{},relatedConcepts:[{concept:{name:"a"},module:"HTML"},{concept:{name:"area"},module:"HTML"},{concept:{name:"aside"},module:"HTML"},{concept:{name:"b"},module:"HTML"},{concept:{name:"bdo"},module:"HTML"},{concept:{name:"body"},module:"HTML"},{concept:{name:"data"},module:"HTML"},{concept:{name:"div"},module:"HTML"},{concept:{constraints:["scoped to the main element","scoped to a sectioning content element","scoped to a sectioning root element other than body"],name:"footer"},module:"HTML"},{concept:{constraints:["scoped to the main element","scoped to a sectioning content element","scoped to a sectioning root element other than body"],name:"header"},module:"HTML"},{concept:{name:"hgroup"},module:"HTML"},{concept:{name:"i"},module:"HTML"},{concept:{name:"pre"},module:"HTML"},{concept:{name:"q"},module:"HTML"},{concept:{name:"samp"},module:"HTML"},{concept:{name:"section"},module:"HTML"},{concept:{name:"small"},module:"HTML"},{concept:{name:"span"},module:"HTML"},{concept:{name:"u"},module:"HTML"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure"]]},iat=nat;T6.default=iat;var x6={};Object.defineProperty(x6,"__esModule",{value:!0});x6.default=void 0;var rat={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-multiselectable":null,"aria-readonly":null},relatedConcepts:[],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[["row"],["row","rowgroup"]],requiredProps:{},superClass:[["roletype","widget","composite"],["roletype","structure","section","table"]]},sat=rat;x6.default=sat;var w6={};Object.defineProperty(w6,"__esModule",{value:!0});w6.default=void 0;var aat={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author","contents"],prohibitedProps:[],props:{"aria-disabled":null,"aria-errormessage":null,"aria-expanded":null,"aria-haspopup":null,"aria-invalid":null,"aria-readonly":null,"aria-required":null,"aria-selected":null},relatedConcepts:[{concept:{constraints:["ancestor table element has grid role","ancestor table element has treegrid role"],name:"td"},module:"HTML"}],requireContextRole:["row"],requiredContextRole:["row"],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section","cell"],["roletype","widget"]]},oat=aat;w6.default=oat;var C6={};Object.defineProperty(C6,"__esModule",{value:!0});C6.default=void 0;var cat={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-activedescendant":null,"aria-disabled":null},relatedConcepts:[{concept:{name:"details"},module:"HTML"},{concept:{name:"fieldset"},module:"HTML"},{concept:{name:"optgroup"},module:"HTML"},{concept:{name:"address"},module:"HTML"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section"]]},lat=cat;C6.default=lat;var A6={};Object.defineProperty(A6,"__esModule",{value:!0});A6.default=void 0;var uat={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!1,nameFrom:["author","contents"],prohibitedProps:[],props:{"aria-level":"2"},relatedConcepts:[{concept:{name:"h1"},module:"HTML"},{concept:{name:"h2"},module:"HTML"},{concept:{name:"h3"},module:"HTML"},{concept:{name:"h4"},module:"HTML"},{concept:{name:"h5"},module:"HTML"},{concept:{name:"h6"},module:"HTML"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{"aria-level":"2"},superClass:[["roletype","structure","sectionhead"]]},hat=uat;A6.default=hat;var R6={};Object.defineProperty(R6,"__esModule",{value:!0});R6.default=void 0;var dat={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!0,nameFrom:["author"],prohibitedProps:[],props:{},relatedConcepts:[{concept:{attributes:[{constraints:["set"],name:"alt"}],name:"img"},module:"HTML"},{concept:{attributes:[{constraints:["undefined"],name:"alt"}],name:"img"},module:"HTML"},{concept:{name:"imggroup"},module:"DTB"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section"]]},fat=dat;R6.default=fat;var M6={};Object.defineProperty(M6,"__esModule",{value:!0});M6.default=void 0;var pat={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["prohibited"],prohibitedProps:["aria-label","aria-labelledby"],props:{},relatedConcepts:[{concept:{name:"ins"},module:"HTML"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section"]]},mat=pat;M6.default=mat;var O6={};Object.defineProperty(O6,"__esModule",{value:!0});O6.default=void 0;var gat={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!1,nameFrom:["author","contents"],prohibitedProps:[],props:{"aria-disabled":null,"aria-expanded":null,"aria-haspopup":null},relatedConcepts:[{concept:{attributes:[{constraints:["set"],name:"href"}],name:"a"},module:"HTML"},{concept:{attributes:[{constraints:["set"],name:"href"}],name:"area"},module:"HTML"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","widget","command"]]},vat=gat;O6.default=vat;var N6={};Object.defineProperty(N6,"__esModule",{value:!0});N6.default=void 0;var _at={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{},relatedConcepts:[{concept:{name:"menu"},module:"HTML"},{concept:{name:"ol"},module:"HTML"},{concept:{name:"ul"},module:"HTML"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[["listitem"]],requiredProps:{},superClass:[["roletype","structure","section"]]},yat=_at;N6.default=yat;var I6={};Object.defineProperty(I6,"__esModule",{value:!0});I6.default=void 0;var bat={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-errormessage":null,"aria-expanded":null,"aria-invalid":null,"aria-multiselectable":null,"aria-readonly":null,"aria-required":null,"aria-orientation":"vertical"},relatedConcepts:[{concept:{attributes:[{constraints:[">1"],name:"size"}],constraints:["the size attribute value is greater than 1"],name:"select"},module:"HTML"},{concept:{attributes:[{name:"multiple"}],name:"select"},module:"HTML"},{concept:{name:"datalist"},module:"HTML"},{concept:{name:"list"},module:"ARIA"},{concept:{name:"select"},module:"XForms"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[["option","group"],["option"]],requiredProps:{},superClass:[["roletype","widget","composite","select"],["roletype","structure","section","group","select"]]},Eat=bat;I6.default=Eat;var k6={};Object.defineProperty(k6,"__esModule",{value:!0});k6.default=void 0;var Sat={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-level":null,"aria-posinset":null,"aria-setsize":null},relatedConcepts:[{concept:{constraints:["direct descendant of ol","direct descendant of ul","direct descendant of menu"],name:"li"},module:"HTML"},{concept:{name:"item"},module:"XForms"}],requireContextRole:["directory","list"],requiredContextRole:["directory","list"],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section"]]},Tat=Sat;k6.default=Tat;var P6={};Object.defineProperty(P6,"__esModule",{value:!0});P6.default=void 0;var xat={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-live":"polite"},relatedConcepts:[],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section"]]},wat=xat;P6.default=wat;var D6={};Object.defineProperty(D6,"__esModule",{value:!0});D6.default=void 0;var Cat={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{},relatedConcepts:[{concept:{name:"main"},module:"HTML"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section","landmark"]]},Aat=Cat;D6.default=Aat;var L6={};Object.defineProperty(L6,"__esModule",{value:!0});L6.default=void 0;var Rat={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["prohibited"],prohibitedProps:[],props:{"aria-braillelabel":null,"aria-brailleroledescription":null,"aria-description":null},relatedConcepts:[{concept:{name:"mark"},module:"HTML"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section"]]},Mat=Rat;L6.default=Mat;var U6={};Object.defineProperty(U6,"__esModule",{value:!0});U6.default=void 0;var Oat={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{},relatedConcepts:[],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section"]]},Nat=Oat;U6.default=Nat;var B6={};Object.defineProperty(B6,"__esModule",{value:!0});B6.default=void 0;var Iat={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{},relatedConcepts:[{concept:{name:"math"},module:"HTML"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section"]]},kat=Iat;B6.default=kat;var F6={};Object.defineProperty(F6,"__esModule",{value:!0});F6.default=void 0;var Pat={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-orientation":"vertical"},relatedConcepts:[{concept:{name:"MENU"},module:"JAPI"},{concept:{name:"list"},module:"ARIA"},{concept:{name:"select"},module:"XForms"},{concept:{name:"sidebar"},module:"DTB"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[["menuitem","group"],["menuitemradio","group"],["menuitemcheckbox","group"],["menuitem"],["menuitemcheckbox"],["menuitemradio"]],requiredProps:{},superClass:[["roletype","widget","composite","select"],["roletype","structure","section","group","select"]]},Dat=Pat;F6.default=Dat;var z6={};Object.defineProperty(z6,"__esModule",{value:!0});z6.default=void 0;var Lat={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-orientation":"horizontal"},relatedConcepts:[{concept:{name:"toolbar"},module:"ARIA"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[["menuitem","group"],["menuitemradio","group"],["menuitemcheckbox","group"],["menuitem"],["menuitemcheckbox"],["menuitemradio"]],requiredProps:{},superClass:[["roletype","widget","composite","select","menu"],["roletype","structure","section","group","select","menu"]]},Uat=Lat;z6.default=Uat;var j6={};Object.defineProperty(j6,"__esModule",{value:!0});j6.default=void 0;var Bat={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!1,nameFrom:["author","contents"],prohibitedProps:[],props:{"aria-disabled":null,"aria-expanded":null,"aria-haspopup":null,"aria-posinset":null,"aria-setsize":null},relatedConcepts:[{concept:{name:"MENU_ITEM"},module:"JAPI"},{concept:{name:"listitem"},module:"ARIA"},{concept:{name:"option"},module:"ARIA"}],requireContextRole:["group","menu","menubar"],requiredContextRole:["group","menu","menubar"],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","widget","command"]]},Fat=Bat;j6.default=Fat;var H6={};Object.defineProperty(H6,"__esModule",{value:!0});H6.default=void 0;var zat={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!0,nameFrom:["author","contents"],prohibitedProps:[],props:{},relatedConcepts:[{concept:{name:"menuitem"},module:"ARIA"}],requireContextRole:["group","menu","menubar"],requiredContextRole:["group","menu","menubar"],requiredOwnedElements:[],requiredProps:{"aria-checked":null},superClass:[["roletype","widget","input","checkbox"],["roletype","widget","command","menuitem"]]},jat=zat;H6.default=jat;var V6={};Object.defineProperty(V6,"__esModule",{value:!0});V6.default=void 0;var Hat={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!0,nameFrom:["author","contents"],prohibitedProps:[],props:{},relatedConcepts:[{concept:{name:"menuitem"},module:"ARIA"}],requireContextRole:["group","menu","menubar"],requiredContextRole:["group","menu","menubar"],requiredOwnedElements:[],requiredProps:{"aria-checked":null},superClass:[["roletype","widget","input","checkbox","menuitemcheckbox"],["roletype","widget","command","menuitem","menuitemcheckbox"],["roletype","widget","input","radio"]]},Vat=Hat;V6.default=Vat;var G6={};Object.defineProperty(G6,"__esModule",{value:!0});G6.default=void 0;var Gat={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!0,nameFrom:["author"],prohibitedProps:[],props:{"aria-valuetext":null,"aria-valuemax":"100","aria-valuemin":"0"},relatedConcepts:[{concept:{name:"meter"},module:"HTML"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{"aria-valuenow":null},superClass:[["roletype","structure","range"]]},qat=Gat;G6.default=qat;var q6={};Object.defineProperty(q6,"__esModule",{value:!0});q6.default=void 0;var $at={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{},relatedConcepts:[{concept:{name:"nav"},module:"HTML"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section","landmark"]]},Wat=$at;q6.default=Wat;var $6={};Object.defineProperty($6,"__esModule",{value:!0});$6.default=void 0;var Yat={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:[],prohibitedProps:[],props:{},relatedConcepts:[],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[]},Kat=Yat;$6.default=Kat;var W6={};Object.defineProperty(W6,"__esModule",{value:!0});W6.default=void 0;var Xat={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{},relatedConcepts:[],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section"]]},Zat=Xat;W6.default=Zat;var Y6={};Object.defineProperty(Y6,"__esModule",{value:!0});Y6.default=void 0;var Jat={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!0,nameFrom:["author","contents"],prohibitedProps:[],props:{"aria-checked":null,"aria-posinset":null,"aria-setsize":null,"aria-selected":"false"},relatedConcepts:[{concept:{name:"item"},module:"XForms"},{concept:{name:"listitem"},module:"ARIA"},{concept:{name:"option"},module:"HTML"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{"aria-selected":"false"},superClass:[["roletype","widget","input"]]},Qat=Jat;Y6.default=Qat;var K6={};Object.defineProperty(K6,"__esModule",{value:!0});K6.default=void 0;var eot={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["prohibited"],prohibitedProps:["aria-label","aria-labelledby"],props:{},relatedConcepts:[{concept:{name:"p"},module:"HTML"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section"]]},tot=eot;K6.default=tot;var X6={};Object.defineProperty(X6,"__esModule",{value:!0});X6.default=void 0;var not={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["prohibited"],prohibitedProps:["aria-label","aria-labelledby"],props:{},relatedConcepts:[{concept:{attributes:[{name:"alt",value:""}],name:"img"},module:"HTML"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure"]]},iot=not;X6.default=iot;var Z6={};Object.defineProperty(Z6,"__esModule",{value:!0});Z6.default=void 0;var rot={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!0,nameFrom:["author"],prohibitedProps:[],props:{"aria-valuetext":null},relatedConcepts:[{concept:{name:"progress"},module:"HTML"},{concept:{name:"status"},module:"ARIA"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","range"],["roletype","widget"]]},sot=rot;Z6.default=sot;var J6={};Object.defineProperty(J6,"__esModule",{value:!0});J6.default=void 0;var aot={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!0,nameFrom:["author","contents"],prohibitedProps:[],props:{"aria-checked":null,"aria-posinset":null,"aria-setsize":null},relatedConcepts:[{concept:{attributes:[{name:"type",value:"radio"}],name:"input"},module:"HTML"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{"aria-checked":null},superClass:[["roletype","widget","input"]]},oot=aot;J6.default=oot;var Q6={};Object.defineProperty(Q6,"__esModule",{value:!0});Q6.default=void 0;var cot={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-errormessage":null,"aria-invalid":null,"aria-readonly":null,"aria-required":null},relatedConcepts:[{concept:{name:"list"},module:"ARIA"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[["radio"]],requiredProps:{},superClass:[["roletype","widget","composite","select"],["roletype","structure","section","group","select"]]},lot=cot;Q6.default=lot;var ez={};Object.defineProperty(ez,"__esModule",{value:!0});ez.default=void 0;var uot={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{},relatedConcepts:[{concept:{attributes:[{constraints:["set"],name:"aria-label"}],name:"section"},module:"HTML"},{concept:{attributes:[{constraints:["set"],name:"aria-labelledby"}],name:"section"},module:"HTML"},{concept:{name:"Device Independence Glossart perceivable unit"}}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section","landmark"]]},hot=uot;ez.default=hot;var tz={};Object.defineProperty(tz,"__esModule",{value:!0});tz.default=void 0;var dot={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author","contents"],prohibitedProps:[],props:{"aria-colindex":null,"aria-expanded":null,"aria-level":null,"aria-posinset":null,"aria-rowindex":null,"aria-selected":null,"aria-setsize":null},relatedConcepts:[{concept:{name:"tr"},module:"HTML"}],requireContextRole:["grid","rowgroup","table","treegrid"],requiredContextRole:["grid","rowgroup","table","treegrid"],requiredOwnedElements:[["cell"],["columnheader"],["gridcell"],["rowheader"]],requiredProps:{},superClass:[["roletype","structure","section","group"],["roletype","widget"]]},fot=dot;tz.default=fot;var nz={};Object.defineProperty(nz,"__esModule",{value:!0});nz.default=void 0;var pot={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author","contents"],prohibitedProps:[],props:{},relatedConcepts:[{concept:{name:"tbody"},module:"HTML"},{concept:{name:"tfoot"},module:"HTML"},{concept:{name:"thead"},module:"HTML"}],requireContextRole:["grid","table","treegrid"],requiredContextRole:["grid","table","treegrid"],requiredOwnedElements:[["row"]],requiredProps:{},superClass:[["roletype","structure"]]},mot=pot;nz.default=mot;var iz={};Object.defineProperty(iz,"__esModule",{value:!0});iz.default=void 0;var got={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!1,nameFrom:["author","contents"],prohibitedProps:[],props:{"aria-sort":null},relatedConcepts:[{concept:{attributes:[{name:"scope",value:"row"}],name:"th"},module:"HTML"},{concept:{attributes:[{name:"scope",value:"rowgroup"}],name:"th"},module:"HTML"}],requireContextRole:["row","rowgroup"],requiredContextRole:["row","rowgroup"],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section","cell"],["roletype","structure","section","cell","gridcell"],["roletype","widget","gridcell"],["roletype","structure","sectionhead"]]},vot=got;iz.default=vot;var rz={};Object.defineProperty(rz,"__esModule",{value:!0});rz.default=void 0;var _ot={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!0,nameFrom:["author"],prohibitedProps:[],props:{"aria-disabled":null,"aria-valuetext":null,"aria-orientation":"vertical","aria-valuemax":"100","aria-valuemin":"0"},relatedConcepts:[],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{"aria-controls":null,"aria-valuenow":null},superClass:[["roletype","structure","range"],["roletype","widget"]]},yot=_ot;rz.default=yot;var sz={};Object.defineProperty(sz,"__esModule",{value:!0});sz.default=void 0;var bot={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{},relatedConcepts:[],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section","landmark"]]},Eot=bot;sz.default=Eot;var az={};Object.defineProperty(az,"__esModule",{value:!0});az.default=void 0;var Sot={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{},relatedConcepts:[{concept:{attributes:[{constraints:["undefined"],name:"list"},{name:"type",value:"search"}],constraints:["the list attribute is not set"],name:"input"},module:"HTML"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","widget","input","textbox"]]},Tot=Sot;az.default=Tot;var oz={};Object.defineProperty(oz,"__esModule",{value:!0});oz.default=void 0;var xot={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!0,nameFrom:["author"],prohibitedProps:[],props:{"aria-disabled":null,"aria-orientation":"horizontal","aria-valuemax":"100","aria-valuemin":"0","aria-valuenow":null,"aria-valuetext":null},relatedConcepts:[{concept:{name:"hr"},module:"HTML"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure"]]},wot=xot;oz.default=wot;var cz={};Object.defineProperty(cz,"__esModule",{value:!0});cz.default=void 0;var Cot={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!0,nameFrom:["author"],prohibitedProps:[],props:{"aria-errormessage":null,"aria-haspopup":null,"aria-invalid":null,"aria-readonly":null,"aria-valuetext":null,"aria-orientation":"horizontal","aria-valuemax":"100","aria-valuemin":"0"},relatedConcepts:[{concept:{attributes:[{name:"type",value:"range"}],name:"input"},module:"HTML"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{"aria-valuenow":null},superClass:[["roletype","widget","input"],["roletype","structure","range"]]},Aot=Cot;cz.default=Aot;var lz={};Object.defineProperty(lz,"__esModule",{value:!0});lz.default=void 0;var Rot={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-errormessage":null,"aria-invalid":null,"aria-readonly":null,"aria-required":null,"aria-valuetext":null,"aria-valuenow":"0"},relatedConcepts:[{concept:{attributes:[{name:"type",value:"number"}],name:"input"},module:"HTML"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","widget","composite"],["roletype","widget","input"],["roletype","structure","range"]]},Mot=Rot;lz.default=Mot;var uz={};Object.defineProperty(uz,"__esModule",{value:!0});uz.default=void 0;var Oot={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-atomic":"true","aria-live":"polite"},relatedConcepts:[{concept:{name:"output"},module:"HTML"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section"]]},Not=Oot;uz.default=Not;var hz={};Object.defineProperty(hz,"__esModule",{value:!0});hz.default=void 0;var Iot={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["prohibited"],prohibitedProps:["aria-label","aria-labelledby"],props:{},relatedConcepts:[{concept:{name:"strong"},module:"HTML"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section"]]},kot=Iot;hz.default=kot;var dz={};Object.defineProperty(dz,"__esModule",{value:!0});dz.default=void 0;var Pot={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["prohibited"],prohibitedProps:["aria-label","aria-labelledby"],props:{},relatedConcepts:[{concept:{name:"sub"},module:"HTML"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section"]]},Dot=Pot;dz.default=Dot;var fz={};Object.defineProperty(fz,"__esModule",{value:!0});fz.default=void 0;var Lot={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["prohibited"],prohibitedProps:["aria-label","aria-labelledby"],props:{},relatedConcepts:[{concept:{name:"sup"},module:"HTML"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section"]]},Uot=Lot;fz.default=Uot;var pz={};Object.defineProperty(pz,"__esModule",{value:!0});pz.default=void 0;var Bot={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!0,nameFrom:["author","contents"],prohibitedProps:[],props:{},relatedConcepts:[{concept:{name:"button"},module:"ARIA"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{"aria-checked":null},superClass:[["roletype","widget","input","checkbox"]]},Fot=Bot;pz.default=Fot;var mz={};Object.defineProperty(mz,"__esModule",{value:!0});mz.default=void 0;var zot={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!0,nameFrom:["author","contents"],prohibitedProps:[],props:{"aria-disabled":null,"aria-expanded":null,"aria-haspopup":null,"aria-posinset":null,"aria-setsize":null,"aria-selected":"false"},relatedConcepts:[],requireContextRole:["tablist"],requiredContextRole:["tablist"],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","sectionhead"],["roletype","widget"]]},jot=zot;mz.default=jot;var gz={};Object.defineProperty(gz,"__esModule",{value:!0});gz.default=void 0;var Hot={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-colcount":null,"aria-rowcount":null},relatedConcepts:[{concept:{name:"table"},module:"HTML"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[["row"],["row","rowgroup"]],requiredProps:{},superClass:[["roletype","structure","section"]]},Vot=Hot;gz.default=Vot;var vz={};Object.defineProperty(vz,"__esModule",{value:!0});vz.default=void 0;var Got={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-level":null,"aria-multiselectable":null,"aria-orientation":"horizontal"},relatedConcepts:[{module:"DAISY",concept:{name:"guide"}}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[["tab"]],requiredProps:{},superClass:[["roletype","widget","composite"]]},qot=Got;vz.default=qot;var _z={};Object.defineProperty(_z,"__esModule",{value:!0});_z.default=void 0;var $ot={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{},relatedConcepts:[],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section"]]},Wot=$ot;_z.default=Wot;var yz={};Object.defineProperty(yz,"__esModule",{value:!0});yz.default=void 0;var Yot={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{},relatedConcepts:[{concept:{name:"dfn"},module:"HTML"},{concept:{name:"dt"},module:"HTML"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section"]]},Kot=Yot;yz.default=Kot;var bz={};Object.defineProperty(bz,"__esModule",{value:!0});bz.default=void 0;var Xot={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-activedescendant":null,"aria-autocomplete":null,"aria-errormessage":null,"aria-haspopup":null,"aria-invalid":null,"aria-multiline":null,"aria-placeholder":null,"aria-readonly":null,"aria-required":null},relatedConcepts:[{concept:{attributes:[{constraints:["undefined"],name:"type"},{constraints:["undefined"],name:"list"}],constraints:["the list attribute is not set"],name:"input"},module:"HTML"},{concept:{attributes:[{constraints:["undefined"],name:"list"},{name:"type",value:"email"}],constraints:["the list attribute is not set"],name:"input"},module:"HTML"},{concept:{attributes:[{constraints:["undefined"],name:"list"},{name:"type",value:"tel"}],constraints:["the list attribute is not set"],name:"input"},module:"HTML"},{concept:{attributes:[{constraints:["undefined"],name:"list"},{name:"type",value:"text"}],constraints:["the list attribute is not set"],name:"input"},module:"HTML"},{concept:{attributes:[{constraints:["undefined"],name:"list"},{name:"type",value:"url"}],constraints:["the list attribute is not set"],name:"input"},module:"HTML"},{concept:{name:"input"},module:"XForms"},{concept:{name:"textarea"},module:"HTML"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","widget","input"]]},Zot=Xot;bz.default=Zot;var Ez={};Object.defineProperty(Ez,"__esModule",{value:!0});Ez.default=void 0;var Jot={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{},relatedConcepts:[{concept:{name:"time"},module:"HTML"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section"]]},Qot=Jot;Ez.default=Qot;var Sz={};Object.defineProperty(Sz,"__esModule",{value:!0});Sz.default=void 0;var ect={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{},relatedConcepts:[],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section","status"]]},tct=ect;Sz.default=tct;var Tz={};Object.defineProperty(Tz,"__esModule",{value:!0});Tz.default=void 0;var nct={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-orientation":"horizontal"},relatedConcepts:[{concept:{name:"menubar"},module:"ARIA"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section","group"]]},ict=nct;Tz.default=ict;var xz={};Object.defineProperty(xz,"__esModule",{value:!0});xz.default=void 0;var rct={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!1,nameFrom:["author","contents"],prohibitedProps:[],props:{},relatedConcepts:[],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section"]]},sct=rct;xz.default=sct;var wz={};Object.defineProperty(wz,"__esModule",{value:!0});wz.default=void 0;var act={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-errormessage":null,"aria-invalid":null,"aria-multiselectable":null,"aria-required":null,"aria-orientation":"vertical"},relatedConcepts:[],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[["treeitem","group"],["treeitem"]],requiredProps:{},superClass:[["roletype","widget","composite","select"],["roletype","structure","section","group","select"]]},oct=act;wz.default=oct;var Cz={};Object.defineProperty(Cz,"__esModule",{value:!0});Cz.default=void 0;var cct={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{},relatedConcepts:[],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[["row"],["row","rowgroup"]],requiredProps:{},superClass:[["roletype","widget","composite","grid"],["roletype","structure","section","table","grid"],["roletype","widget","composite","select","tree"],["roletype","structure","section","group","select","tree"]]},lct=cct;Cz.default=lct;var Az={};Object.defineProperty(Az,"__esModule",{value:!0});Az.default=void 0;var uct={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!1,nameFrom:["author","contents"],prohibitedProps:[],props:{"aria-expanded":null,"aria-haspopup":null},relatedConcepts:[],requireContextRole:["group","tree"],requiredContextRole:["group","tree"],requiredOwnedElements:[],requiredProps:{"aria-selected":null},superClass:[["roletype","structure","section","listitem"],["roletype","widget","input","option"]]},hct=uct;Az.default=hct;Object.defineProperty(J4,"__esModule",{value:!0});J4.default=void 0;var dct=un(Q4),fct=un(e6),pct=un(t6),mct=un(n6),gct=un(i6),vct=un(r6),_ct=un(s6),yct=un(a6),bct=un(o6),Ect=un(c6),Sct=un(l6),Tct=un(u6),xct=un(h6),wct=un(d6),Cct=un(f6),Act=un(p6),Rct=un(m6),Mct=un(g6),Oct=un(v6),Nct=un(_6),Ict=un(y6),kct=un(b6),Pct=un(E6),Dct=un(S6),Lct=un(T6),Uct=un(x6),Bct=un(w6),Fct=un(C6),zct=un(A6),jct=un(R6),Hct=un(M6),Vct=un(O6),Gct=un(N6),qct=un(I6),$ct=un(k6),Wct=un(P6),Yct=un(D6),Kct=un(L6),Xct=un(U6),Zct=un(B6),Jct=un(F6),Qct=un(z6),elt=un(j6),tlt=un(H6),nlt=un(V6),ilt=un(G6),rlt=un(q6),slt=un($6),alt=un(W6),olt=un(Y6),clt=un(K6),llt=un(X6),ult=un(Z6),hlt=un(J6),dlt=un(Q6),flt=un(ez),plt=un(tz),mlt=un(nz),glt=un(iz),vlt=un(rz),_lt=un(sz),ylt=un(az),blt=un(oz),Elt=un(cz),Slt=un(lz),Tlt=un(uz),xlt=un(hz),wlt=un(dz),Clt=un(fz),Alt=un(pz),Rlt=un(mz),Mlt=un(gz),Olt=un(vz),Nlt=un(_z),Ilt=un(yz),klt=un(bz),Plt=un(Ez),Dlt=un(Sz),Llt=un(Tz),Ult=un(xz),Blt=un(wz),Flt=un(Cz),zlt=un(Az);function un(t){return t&&t.__esModule?t:{default:t}}var jlt=[["alert",dct.default],["alertdialog",fct.default],["application",pct.default],["article",mct.default],["banner",gct.default],["blockquote",vct.default],["button",_ct.default],["caption",yct.default],["cell",bct.default],["checkbox",Ect.default],["code",Sct.default],["columnheader",Tct.default],["combobox",xct.default],["complementary",wct.default],["contentinfo",Cct.default],["definition",Act.default],["deletion",Rct.default],["dialog",Mct.default],["directory",Oct.default],["document",Nct.default],["emphasis",Ict.default],["feed",kct.default],["figure",Pct.default],["form",Dct.default],["generic",Lct.default],["grid",Uct.default],["gridcell",Bct.default],["group",Fct.default],["heading",zct.default],["img",jct.default],["insertion",Hct.default],["link",Vct.default],["list",Gct.default],["listbox",qct.default],["listitem",$ct.default],["log",Wct.default],["main",Yct.default],["mark",Kct.default],["marquee",Xct.default],["math",Zct.default],["menu",Jct.default],["menubar",Qct.default],["menuitem",elt.default],["menuitemcheckbox",tlt.default],["menuitemradio",nlt.default],["meter",ilt.default],["navigation",rlt.default],["none",slt.default],["note",alt.default],["option",olt.default],["paragraph",clt.default],["presentation",llt.default],["progressbar",ult.default],["radio",hlt.default],["radiogroup",dlt.default],["region",flt.default],["row",plt.default],["rowgroup",mlt.default],["rowheader",glt.default],["scrollbar",vlt.default],["search",_lt.default],["searchbox",ylt.default],["separator",blt.default],["slider",Elt.default],["spinbutton",Slt.default],["status",Tlt.default],["strong",xlt.default],["subscript",wlt.default],["superscript",Clt.default],["switch",Alt.default],["tab",Rlt.default],["table",Mlt.default],["tablist",Olt.default],["tabpanel",Nlt.default],["term",Ilt.default],["textbox",klt.default],["time",Plt.default],["timer",Dlt.default],["toolbar",Llt.default],["tooltip",Ult.default],["tree",Blt.default],["treegrid",Flt.default],["treeitem",zlt.default]],Hlt=jlt;J4.default=Hlt;var Rz={},Mz={};Object.defineProperty(Mz,"__esModule",{value:!0});Mz.default=void 0;var Vlt={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-disabled":null,"aria-errormessage":null,"aria-expanded":null,"aria-haspopup":null,"aria-invalid":null},relatedConcepts:[{concept:{name:"abstract [EPUB-SSV]"},module:"EPUB"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section"]]},Glt=Vlt;Mz.default=Glt;var Oz={};Object.defineProperty(Oz,"__esModule",{value:!0});Oz.default=void 0;var qlt={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-disabled":null,"aria-errormessage":null,"aria-expanded":null,"aria-haspopup":null,"aria-invalid":null},relatedConcepts:[{concept:{name:"acknowledgments [EPUB-SSV]"},module:"EPUB"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section","landmark"]]},$lt=qlt;Oz.default=$lt;var Nz={};Object.defineProperty(Nz,"__esModule",{value:!0});Nz.default=void 0;var Wlt={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-disabled":null,"aria-errormessage":null,"aria-expanded":null,"aria-haspopup":null,"aria-invalid":null},relatedConcepts:[{concept:{name:"afterword [EPUB-SSV]"},module:"EPUB"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section","landmark"]]},Ylt=Wlt;Nz.default=Ylt;var Iz={};Object.defineProperty(Iz,"__esModule",{value:!0});Iz.default=void 0;var Klt={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-disabled":null,"aria-errormessage":null,"aria-expanded":null,"aria-haspopup":null,"aria-invalid":null},relatedConcepts:[{concept:{name:"appendix [EPUB-SSV]"},module:"EPUB"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section","landmark"]]},Xlt=Klt;Iz.default=Xlt;var kz={};Object.defineProperty(kz,"__esModule",{value:!0});kz.default=void 0;var Zlt={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!1,nameFrom:["author","contents"],prohibitedProps:[],props:{"aria-errormessage":null,"aria-invalid":null},relatedConcepts:[{concept:{name:"referrer [EPUB-SSV]"},module:"EPUB"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","widget","command","link"]]},Jlt=Zlt;kz.default=Jlt;var Pz={};Object.defineProperty(Pz,"__esModule",{value:!0});Pz.default=void 0;var Qlt={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-disabled":null,"aria-errormessage":null,"aria-expanded":null,"aria-haspopup":null,"aria-invalid":null},relatedConcepts:[{concept:{name:"EPUB biblioentry [EPUB-SSV]"},module:"EPUB"}],requireContextRole:["doc-bibliography"],requiredContextRole:["doc-bibliography"],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section","listitem"]]},eut=Qlt;Pz.default=eut;var Dz={};Object.defineProperty(Dz,"__esModule",{value:!0});Dz.default=void 0;var tut={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-disabled":null,"aria-errormessage":null,"aria-expanded":null,"aria-haspopup":null,"aria-invalid":null},relatedConcepts:[{concept:{name:"bibliography [EPUB-SSV]"},module:"EPUB"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[["doc-biblioentry"]],requiredProps:{},superClass:[["roletype","structure","section","landmark"]]},nut=tut;Dz.default=nut;var Lz={};Object.defineProperty(Lz,"__esModule",{value:!0});Lz.default=void 0;var iut={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!1,nameFrom:["author","contents"],prohibitedProps:[],props:{"aria-errormessage":null,"aria-invalid":null},relatedConcepts:[{concept:{name:"biblioref [EPUB-SSV]"},module:"EPUB"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","widget","command","link"]]},rut=iut;Lz.default=rut;var Uz={};Object.defineProperty(Uz,"__esModule",{value:!0});Uz.default=void 0;var sut={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-disabled":null,"aria-errormessage":null,"aria-expanded":null,"aria-haspopup":null,"aria-invalid":null},relatedConcepts:[{concept:{name:"chapter [EPUB-SSV]"},module:"EPUB"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section","landmark"]]},aut=sut;Uz.default=aut;var Bz={};Object.defineProperty(Bz,"__esModule",{value:!0});Bz.default=void 0;var out={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-disabled":null,"aria-errormessage":null,"aria-expanded":null,"aria-haspopup":null,"aria-invalid":null},relatedConcepts:[{concept:{name:"colophon [EPUB-SSV]"},module:"EPUB"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section"]]},cut=out;Bz.default=cut;var Fz={};Object.defineProperty(Fz,"__esModule",{value:!0});Fz.default=void 0;var lut={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-disabled":null,"aria-errormessage":null,"aria-expanded":null,"aria-haspopup":null,"aria-invalid":null},relatedConcepts:[{concept:{name:"conclusion [EPUB-SSV]"},module:"EPUB"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section","landmark"]]},uut=lut;Fz.default=uut;var zz={};Object.defineProperty(zz,"__esModule",{value:!0});zz.default=void 0;var hut={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-disabled":null,"aria-errormessage":null,"aria-expanded":null,"aria-haspopup":null,"aria-invalid":null},relatedConcepts:[{concept:{name:"cover [EPUB-SSV]"},module:"EPUB"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section","img"]]},dut=hut;zz.default=dut;var jz={};Object.defineProperty(jz,"__esModule",{value:!0});jz.default=void 0;var fut={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-disabled":null,"aria-errormessage":null,"aria-expanded":null,"aria-haspopup":null,"aria-invalid":null},relatedConcepts:[{concept:{name:"credit [EPUB-SSV]"},module:"EPUB"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section"]]},put=fut;jz.default=put;var Hz={};Object.defineProperty(Hz,"__esModule",{value:!0});Hz.default=void 0;var mut={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-disabled":null,"aria-errormessage":null,"aria-expanded":null,"aria-haspopup":null,"aria-invalid":null},relatedConcepts:[{concept:{name:"credits [EPUB-SSV]"},module:"EPUB"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section","landmark"]]},gut=mut;Hz.default=gut;var Vz={};Object.defineProperty(Vz,"__esModule",{value:!0});Vz.default=void 0;var vut={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-disabled":null,"aria-errormessage":null,"aria-expanded":null,"aria-haspopup":null,"aria-invalid":null},relatedConcepts:[{concept:{name:"dedication [EPUB-SSV]"},module:"EPUB"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section"]]},_ut=vut;Vz.default=_ut;var Gz={};Object.defineProperty(Gz,"__esModule",{value:!0});Gz.default=void 0;var yut={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-disabled":null,"aria-errormessage":null,"aria-expanded":null,"aria-haspopup":null,"aria-invalid":null},relatedConcepts:[{concept:{name:"rearnote [EPUB-SSV]"},module:"EPUB"}],requireContextRole:["doc-endnotes"],requiredContextRole:["doc-endnotes"],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section","listitem"]]},but=yut;Gz.default=but;var qz={};Object.defineProperty(qz,"__esModule",{value:!0});qz.default=void 0;var Eut={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-disabled":null,"aria-errormessage":null,"aria-expanded":null,"aria-haspopup":null,"aria-invalid":null},relatedConcepts:[{concept:{name:"rearnotes [EPUB-SSV]"},module:"EPUB"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[["doc-endnote"]],requiredProps:{},superClass:[["roletype","structure","section","landmark"]]},Sut=Eut;qz.default=Sut;var $z={};Object.defineProperty($z,"__esModule",{value:!0});$z.default=void 0;var Tut={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-disabled":null,"aria-errormessage":null,"aria-expanded":null,"aria-haspopup":null,"aria-invalid":null},relatedConcepts:[{concept:{name:"epigraph [EPUB-SSV]"},module:"EPUB"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section"]]},xut=Tut;$z.default=xut;var Wz={};Object.defineProperty(Wz,"__esModule",{value:!0});Wz.default=void 0;var wut={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-disabled":null,"aria-errormessage":null,"aria-expanded":null,"aria-haspopup":null,"aria-invalid":null},relatedConcepts:[{concept:{name:"epilogue [EPUB-SSV]"},module:"EPUB"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section","landmark"]]},Cut=wut;Wz.default=Cut;var Yz={};Object.defineProperty(Yz,"__esModule",{value:!0});Yz.default=void 0;var Aut={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-disabled":null,"aria-errormessage":null,"aria-expanded":null,"aria-haspopup":null,"aria-invalid":null},relatedConcepts:[{concept:{name:"errata [EPUB-SSV]"},module:"EPUB"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section","landmark"]]},Rut=Aut;Yz.default=Rut;var Kz={};Object.defineProperty(Kz,"__esModule",{value:!0});Kz.default=void 0;var Mut={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-disabled":null,"aria-errormessage":null,"aria-expanded":null,"aria-haspopup":null,"aria-invalid":null},relatedConcepts:[],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section"]]},Out=Mut;Kz.default=Out;var Xz={};Object.defineProperty(Xz,"__esModule",{value:!0});Xz.default=void 0;var Nut={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-disabled":null,"aria-errormessage":null,"aria-expanded":null,"aria-haspopup":null,"aria-invalid":null},relatedConcepts:[{concept:{name:"footnote [EPUB-SSV]"},module:"EPUB"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section"]]},Iut=Nut;Xz.default=Iut;var Zz={};Object.defineProperty(Zz,"__esModule",{value:!0});Zz.default=void 0;var kut={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-disabled":null,"aria-errormessage":null,"aria-expanded":null,"aria-haspopup":null,"aria-invalid":null},relatedConcepts:[{concept:{name:"foreword [EPUB-SSV]"},module:"EPUB"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section","landmark"]]},Put=kut;Zz.default=Put;var Jz={};Object.defineProperty(Jz,"__esModule",{value:!0});Jz.default=void 0;var Dut={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-disabled":null,"aria-errormessage":null,"aria-expanded":null,"aria-haspopup":null,"aria-invalid":null},relatedConcepts:[{concept:{name:"glossary [EPUB-SSV]"},module:"EPUB"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[["definition"],["term"]],requiredProps:{},superClass:[["roletype","structure","section","landmark"]]},Lut=Dut;Jz.default=Lut;var Qz={};Object.defineProperty(Qz,"__esModule",{value:!0});Qz.default=void 0;var Uut={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!1,nameFrom:["author","contents"],prohibitedProps:[],props:{"aria-errormessage":null,"aria-invalid":null},relatedConcepts:[{concept:{name:"glossref [EPUB-SSV]"},module:"EPUB"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","widget","command","link"]]},But=Uut;Qz.default=But;var e8={};Object.defineProperty(e8,"__esModule",{value:!0});e8.default=void 0;var Fut={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-disabled":null,"aria-errormessage":null,"aria-expanded":null,"aria-haspopup":null,"aria-invalid":null},relatedConcepts:[{concept:{name:"index [EPUB-SSV]"},module:"EPUB"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section","landmark","navigation"]]},zut=Fut;e8.default=zut;var t8={};Object.defineProperty(t8,"__esModule",{value:!0});t8.default=void 0;var jut={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-disabled":null,"aria-errormessage":null,"aria-expanded":null,"aria-haspopup":null,"aria-invalid":null},relatedConcepts:[{concept:{name:"introduction [EPUB-SSV]"},module:"EPUB"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section","landmark"]]},Hut=jut;t8.default=Hut;var n8={};Object.defineProperty(n8,"__esModule",{value:!0});n8.default=void 0;var Vut={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!1,nameFrom:["author","contents"],prohibitedProps:[],props:{"aria-errormessage":null,"aria-invalid":null},relatedConcepts:[{concept:{name:"noteref [EPUB-SSV]"},module:"EPUB"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","widget","command","link"]]},Gut=Vut;n8.default=Gut;var i8={};Object.defineProperty(i8,"__esModule",{value:!0});i8.default=void 0;var qut={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-disabled":null,"aria-errormessage":null,"aria-expanded":null,"aria-haspopup":null,"aria-invalid":null},relatedConcepts:[{concept:{name:"notice [EPUB-SSV]"},module:"EPUB"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section","note"]]},$ut=qut;i8.default=$ut;var r8={};Object.defineProperty(r8,"__esModule",{value:!0});r8.default=void 0;var Wut={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!0,nameFrom:["author"],prohibitedProps:[],props:{"aria-errormessage":null,"aria-expanded":null,"aria-haspopup":null,"aria-invalid":null},relatedConcepts:[{concept:{name:"pagebreak [EPUB-SSV]"},module:"EPUB"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","separator"]]},Yut=Wut;r8.default=Yut;var s8={};Object.defineProperty(s8,"__esModule",{value:!0});s8.default=void 0;var Kut={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-disabled":null,"aria-errormessage":null,"aria-expanded":null,"aria-haspopup":null,"aria-invalid":null},relatedConcepts:[{concept:{name:"page-list [EPUB-SSV]"},module:"EPUB"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section","landmark","navigation"]]},Xut=Kut;s8.default=Xut;var a8={};Object.defineProperty(a8,"__esModule",{value:!0});a8.default=void 0;var Zut={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-disabled":null,"aria-errormessage":null,"aria-expanded":null,"aria-haspopup":null,"aria-invalid":null},relatedConcepts:[{concept:{name:"part [EPUB-SSV]"},module:"EPUB"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section","landmark"]]},Jut=Zut;a8.default=Jut;var o8={};Object.defineProperty(o8,"__esModule",{value:!0});o8.default=void 0;var Qut={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-disabled":null,"aria-errormessage":null,"aria-expanded":null,"aria-haspopup":null,"aria-invalid":null},relatedConcepts:[{concept:{name:"preface [EPUB-SSV]"},module:"EPUB"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section","landmark"]]},eht=Qut;o8.default=eht;var c8={};Object.defineProperty(c8,"__esModule",{value:!0});c8.default=void 0;var tht={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-disabled":null,"aria-errormessage":null,"aria-expanded":null,"aria-haspopup":null,"aria-invalid":null},relatedConcepts:[{concept:{name:"prologue [EPUB-SSV]"},module:"EPUB"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section","landmark"]]},nht=tht;c8.default=nht;var l8={};Object.defineProperty(l8,"__esModule",{value:!0});l8.default=void 0;var iht={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{},relatedConcepts:[{concept:{name:"pullquote [EPUB-SSV]"},module:"EPUB"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["none"]]},rht=iht;l8.default=rht;var u8={};Object.defineProperty(u8,"__esModule",{value:!0});u8.default=void 0;var sht={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-disabled":null,"aria-errormessage":null,"aria-expanded":null,"aria-haspopup":null,"aria-invalid":null},relatedConcepts:[{concept:{name:"qna [EPUB-SSV]"},module:"EPUB"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section"]]},aht=sht;u8.default=aht;var h8={};Object.defineProperty(h8,"__esModule",{value:!0});h8.default=void 0;var oht={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-disabled":null,"aria-errormessage":null,"aria-expanded":null,"aria-haspopup":null,"aria-invalid":null},relatedConcepts:[{concept:{name:"subtitle [EPUB-SSV]"},module:"EPUB"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","sectionhead"]]},cht=oht;h8.default=cht;var d8={};Object.defineProperty(d8,"__esModule",{value:!0});d8.default=void 0;var lht={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-disabled":null,"aria-errormessage":null,"aria-expanded":null,"aria-haspopup":null,"aria-invalid":null},relatedConcepts:[{concept:{name:"help [EPUB-SSV]"},module:"EPUB"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section","note"]]},uht=lht;d8.default=uht;var f8={};Object.defineProperty(f8,"__esModule",{value:!0});f8.default=void 0;var hht={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-disabled":null,"aria-errormessage":null,"aria-expanded":null,"aria-haspopup":null,"aria-invalid":null},relatedConcepts:[{concept:{name:"toc [EPUB-SSV]"},module:"EPUB"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section","landmark","navigation"]]},dht=hht;f8.default=dht;Object.defineProperty(Rz,"__esModule",{value:!0});Rz.default=void 0;var fht=Er(Mz),pht=Er(Oz),mht=Er(Nz),ght=Er(Iz),vht=Er(kz),_ht=Er(Pz),yht=Er(Dz),bht=Er(Lz),Eht=Er(Uz),Sht=Er(Bz),Tht=Er(Fz),xht=Er(zz),wht=Er(jz),Cht=Er(Hz),Aht=Er(Vz),Rht=Er(Gz),Mht=Er(qz),Oht=Er($z),Nht=Er(Wz),Iht=Er(Yz),kht=Er(Kz),Pht=Er(Xz),Dht=Er(Zz),Lht=Er(Jz),Uht=Er(Qz),Bht=Er(e8),Fht=Er(t8),zht=Er(n8),jht=Er(i8),Hht=Er(r8),Vht=Er(s8),Ght=Er(a8),qht=Er(o8),$ht=Er(c8),Wht=Er(l8),Yht=Er(u8),Kht=Er(h8),Xht=Er(d8),Zht=Er(f8);function Er(t){return t&&t.__esModule?t:{default:t}}var Jht=[["doc-abstract",fht.default],["doc-acknowledgments",pht.default],["doc-afterword",mht.default],["doc-appendix",ght.default],["doc-backlink",vht.default],["doc-biblioentry",_ht.default],["doc-bibliography",yht.default],["doc-biblioref",bht.default],["doc-chapter",Eht.default],["doc-colophon",Sht.default],["doc-conclusion",Tht.default],["doc-cover",xht.default],["doc-credit",wht.default],["doc-credits",Cht.default],["doc-dedication",Aht.default],["doc-endnote",Rht.default],["doc-endnotes",Mht.default],["doc-epigraph",Oht.default],["doc-epilogue",Nht.default],["doc-errata",Iht.default],["doc-example",kht.default],["doc-footnote",Pht.default],["doc-foreword",Dht.default],["doc-glossary",Lht.default],["doc-glossref",Uht.default],["doc-index",Bht.default],["doc-introduction",Fht.default],["doc-noteref",zht.default],["doc-notice",jht.default],["doc-pagebreak",Hht.default],["doc-pagelist",Vht.default],["doc-part",Ght.default],["doc-preface",qht.default],["doc-prologue",$ht.default],["doc-pullquote",Wht.default],["doc-qna",Yht.default],["doc-subtitle",Kht.default],["doc-tip",Xht.default],["doc-toc",Zht.default]],Qht=Jht;Rz.default=Qht;var p8={},m8={};Object.defineProperty(m8,"__esModule",{value:!0});m8.default=void 0;var edt={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-disabled":null,"aria-errormessage":null,"aria-expanded":null,"aria-haspopup":null,"aria-invalid":null},relatedConcepts:[{module:"GRAPHICS",concept:{name:"graphics-object"}},{module:"ARIA",concept:{name:"img"}},{module:"ARIA",concept:{name:"article"}}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","document"]]},tdt=edt;m8.default=tdt;var g8={};Object.defineProperty(g8,"__esModule",{value:!0});g8.default=void 0;var ndt={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author","contents"],prohibitedProps:[],props:{"aria-errormessage":null,"aria-expanded":null,"aria-haspopup":null,"aria-invalid":null},relatedConcepts:[{module:"GRAPHICS",concept:{name:"graphics-document"}},{module:"ARIA",concept:{name:"group"}},{module:"ARIA",concept:{name:"img"}},{module:"GRAPHICS",concept:{name:"graphics-symbol"}}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section","group"]]},idt=ndt;g8.default=idt;var v8={};Object.defineProperty(v8,"__esModule",{value:!0});v8.default=void 0;var rdt={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!0,nameFrom:["author"],prohibitedProps:[],props:{"aria-disabled":null,"aria-errormessage":null,"aria-expanded":null,"aria-haspopup":null,"aria-invalid":null},relatedConcepts:[],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section","img"]]},sdt=rdt;v8.default=sdt;Object.defineProperty(p8,"__esModule",{value:!0});p8.default=void 0;var adt=XK(m8),odt=XK(g8),cdt=XK(v8);function XK(t){return t&&t.__esModule?t:{default:t}}var ldt=[["graphics-document",adt.default],["graphics-object",odt.default],["graphics-symbol",cdt.default]],udt=ldt;p8.default=udt;Object.defineProperty(_R,"__esModule",{value:!0});_R.default=void 0;var hdt=Gk(F4),ddt=Gk(J4),fdt=Gk(Rz),pdt=Gk(p8),mdt=Gk(Q1);function Gk(t){return t&&t.__esModule?t:{default:t}}function gdt(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function b$(t,e){var n=typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=Fye(t))||e){n&&(t=n);var i=0,r=function(){};return{s:r,n:function(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}},e:function(l){throw l},f:r}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var s=!0,a=!1,o;return{s:function(){n=n.call(t)},n:function(){var l=n.next();return s=l.done,l},e:function(l){a=!0,o=l},f:function(){try{!s&&n.return!=null&&n.return()}finally{if(a)throw o}}}}function OO(t,e){return ydt(t)||_dt(t,e)||Fye(t,e)||vdt()}function vdt(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Fye(t,e){if(t){if(typeof t=="string")return nse(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);if(n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set")return Array.from(t);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return nse(t,e)}}function nse(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}function _dt(t,e){var n=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(n!=null){var i=[],r=!0,s=!1,a,o;try{for(n=n.call(t);!(r=(a=n.next()).done)&&(i.push(a.value),!(e&&i.length===e));r=!0);}catch(c){s=!0,o=c}finally{try{!r&&n.return!=null&&n.return()}finally{if(s)throw o}}return i}}function ydt(t){if(Array.isArray(t))return t}var ab=[].concat(hdt.default,ddt.default,fdt.default,pdt.default);ab.forEach(function(t){var e=OO(t,2),n=e[1],i=b$(n.superClass),r;try{for(i.s();!(r=i.n()).done;){var s=r.value,a=b$(s),o;try{var c=function(){var u=o.value,h=ab.find(function(_){var v=OO(_,1),b=v[0];return b===u});if(h)for(var d=h[1],f=0,p=Object.keys(d.props);f<p.length;f++){var g=p[f];Object.prototype.hasOwnProperty.call(n.props,g)||Object.assign(n.props,gdt({},g,d.props[g]))}};for(a.s();!(o=a.n()).done;)c()}catch(l){a.e(l)}finally{a.f()}}}catch(l){i.e(l)}finally{i.f()}});var E$={entries:function(){return ab},forEach:function(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,i=b$(ab),r;try{for(i.s();!(r=i.n()).done;){var s=OO(r.value,2),a=s[0],o=s[1];e.call(n,o,a,ab)}}catch(c){i.e(c)}finally{i.f()}},get:function(e){var n=ab.find(function(i){return i[0]===e});return n&&n[1]},has:function(e){return!!E$.get(e)},keys:function(){return ab.map(function(e){var n=OO(e,1),i=n[0];return i})},values:function(){return ab.map(function(e){var n=OO(e,2),i=n[1];return i})}},bdt=(0,mdt.default)(E$,E$.entries());_R.default=bdt;var _8={},zye={},ise=Object.prototype.hasOwnProperty;function S$(t,e){var n,i;if(t===e)return!0;if(t&&e&&(n=t.constructor)===e.constructor){if(n===Date)return t.getTime()===e.getTime();if(n===RegExp)return t.toString()===e.toString();if(n===Array){if((i=t.length)===e.length)for(;i--&&S$(t[i],e[i]););return i===-1}if(!n||typeof t=="object"){i=0;for(n in t)if(ise.call(t,n)&&++i&&!ise.call(e,n)||!(n in e)||!S$(t[n],e[n]))return!1;return Object.keys(e).length===i}}return t!==t&&e!==e}zye.dequal=S$;Object.defineProperty(_8,"__esModule",{value:!0});_8.default=void 0;var jye=zye,Edt=Vye(Q1),Hye=Vye(_R);function Vye(t){return t&&t.__esModule?t:{default:t}}function jH(t,e){return xdt(t)||Tdt(t,e)||Gye(t,e)||Sdt()}function Sdt(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Tdt(t,e){var n=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(n!=null){var i=[],r=!0,s=!1,a,o;try{for(n=n.call(t);!(r=(a=n.next()).done)&&(i.push(a.value),!(e&&i.length===e));r=!0);}catch(c){s=!0,o=c}finally{try{!r&&n.return!=null&&n.return()}finally{if(s)throw o}}return i}}function xdt(t){if(Array.isArray(t))return t}function wdt(t,e){var n=typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=Gye(t))||e){n&&(t=n);var i=0,r=function(){};return{s:r,n:function(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}},e:function(l){throw l},f:r}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var s=!0,a=!1,o;return{s:function(){n=n.call(t)},n:function(){var l=n.next();return s=l.done,l},e:function(l){a=!0,o=l},f:function(){try{!s&&n.return!=null&&n.return()}finally{if(a)throw o}}}}function Gye(t,e){if(t){if(typeof t=="string")return rse(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);if(n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set")return Array.from(t);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return rse(t,e)}}function rse(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}var ob=[],sse=Hye.default.keys();for(var HH=0;HH<sse.length;HH++){var VH=sse[HH],GH=Hye.default.get(VH);if(GH)for(var ase=[].concat(GH.baseConcepts,GH.relatedConcepts),qH=0;qH<ase.length;qH++){var ose=ase[qH];ose.module==="HTML"&&function(){var t=ose.concept;if(t){var e=ob.find(function(s){return(0,jye.dequal)(s,t)}),n;e?n=e[1]:n=[];for(var i=!0,r=0;r<n.length;r++)if(n[r]===VH){i=!1;break}i&&n.push(VH),ob.push([t,n])}}()}}var T$={entries:function(){return ob},forEach:function(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,i=wdt(ob),r;try{for(i.s();!(r=i.n()).done;){var s=jH(r.value,2),a=s[0],o=s[1];e.call(n,o,a,ob)}}catch(c){i.e(c)}finally{i.f()}},get:function(e){var n=ob.find(function(i){return e.name===i[0].name&&(0,jye.dequal)(e.attributes,i[0].attributes)});return n&&n[1]},has:function(e){return!!T$.get(e)},keys:function(){return ob.map(function(e){var n=jH(e,1),i=n[0];return i})},values:function(){return ob.map(function(e){var n=jH(e,2),i=n[1];return i})}},Cdt=(0,Edt.default)(T$,T$.entries());_8.default=Cdt;var y8={};Object.defineProperty(y8,"__esModule",{value:!0});y8.default=void 0;var Adt=$ye(Q1),qye=$ye(_R);function $ye(t){return t&&t.__esModule?t:{default:t}}function $H(t,e){return Odt(t)||Mdt(t,e)||Wye(t,e)||Rdt()}function Rdt(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Mdt(t,e){var n=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(n!=null){var i=[],r=!0,s=!1,a,o;try{for(n=n.call(t);!(r=(a=n.next()).done)&&(i.push(a.value),!(e&&i.length===e));r=!0);}catch(c){s=!0,o=c}finally{try{!r&&n.return!=null&&n.return()}finally{if(s)throw o}}return i}}function Odt(t){if(Array.isArray(t))return t}function Ndt(t,e){var n=typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=Wye(t))||e){n&&(t=n);var i=0,r=function(){};return{s:r,n:function(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}},e:function(l){throw l},f:r}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var s=!0,a=!1,o;return{s:function(){n=n.call(t)},n:function(){var l=n.next();return s=l.done,l},e:function(l){a=!0,o=l},f:function(){try{!s&&n.return!=null&&n.return()}finally{if(a)throw o}}}}function Wye(t,e){if(t){if(typeof t=="string")return cse(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);if(n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set")return Array.from(t);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return cse(t,e)}}function cse(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}var cT=[],lse=qye.default.keys();for(var WH=0;WH<lse.length;WH++){var use=lse[WH],YH=qye.default.get(use),KH=[];if(YH){for(var hse=[].concat(YH.baseConcepts,YH.relatedConcepts),XH=0;XH<hse.length;XH++){var dse=hse[XH];if(dse.module==="HTML"){var fse=dse.concept;fse!=null&&KH.push(fse)}}KH.length>0&&cT.push([use,KH])}}var x$={entries:function(){return cT},forEach:function(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,i=Ndt(cT),r;try{for(i.s();!(r=i.n()).done;){var s=$H(r.value,2),a=s[0],o=s[1];e.call(n,o,a,cT)}}catch(c){i.e(c)}finally{i.f()}},get:function(e){var n=cT.find(function(i){return i[0]===e});return n&&n[1]},has:function(e){return!!x$.get(e)},keys:function(){return cT.map(function(e){var n=$H(e,1),i=n[0];return i})},values:function(){return cT.map(function(e){var n=$H(e,2),i=n[1];return i})}},Idt=(0,Adt.default)(x$,x$.entries());y8.default=Idt;Object.defineProperty(_m,"__esModule",{value:!0});var cm=_m.roles=Kye=_m.roleElements=Yye=_m.elementRoles=_m.dom=_m.aria=void 0,kdt=qk(L4),Pdt=qk(B4),Ddt=qk(_R),Ldt=qk(_8),Udt=qk(y8);function qk(t){return t&&t.__esModule?t:{default:t}}var Bdt=kdt.default;_m.aria=Bdt;var Fdt=Pdt.default;_m.dom=Fdt;var zdt=Ddt.default;cm=_m.roles=zdt;var jdt=Ldt.default,Yye=_m.elementRoles=jdt,Hdt=Udt.default,Kye=_m.roleElements=Hdt,ZK={exports:{}};ZK.exports;(function(t){var e=function(){var n=String.fromCharCode,i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+-$",s={};function a(c,l){if(!s[c]){s[c]={};for(var u=0;u<c.length;u++)s[c][c.charAt(u)]=u}return s[c][l]}var o={compressToBase64:function(c){if(c==null)return"";var l=o._compress(c,6,function(u){return i.charAt(u)});switch(l.length%4){default:case 0:return l;case 1:return l+"===";case 2:return l+"==";case 3:return l+"="}},decompressFromBase64:function(c){return c==null?"":c==""?null:o._decompress(c.length,32,function(l){return a(i,c.charAt(l))})},compressToUTF16:function(c){return c==null?"":o._compress(c,15,function(l){return n(l+32)})+" "},decompressFromUTF16:function(c){return c==null?"":c==""?null:o._decompress(c.length,16384,function(l){return c.charCodeAt(l)-32})},compressToUint8Array:function(c){for(var l=o.compress(c),u=new Uint8Array(l.length*2),h=0,d=l.length;h<d;h++){var f=l.charCodeAt(h);u[h*2]=f>>>8,u[h*2+1]=f%256}return u},decompressFromUint8Array:function(c){if(c==null)return o.decompress(c);for(var l=new Array(c.length/2),u=0,h=l.length;u<h;u++)l[u]=c[u*2]*256+c[u*2+1];var d=[];return l.forEach(function(f){d.push(n(f))}),o.decompress(d.join(""))},compressToEncodedURIComponent:function(c){return c==null?"":o._compress(c,6,function(l){return r.charAt(l)})},decompressFromEncodedURIComponent:function(c){return c==null?"":c==""?null:(c=c.replace(/ /g,"+"),o._decompress(c.length,32,function(l){return a(r,c.charAt(l))}))},compress:function(c){return o._compress(c,16,function(l){return n(l)})},_compress:function(c,l,u){if(c==null)return"";var h,d,f={},p={},g="",_="",v="",b=2,S=3,x=2,M=[],R=0,I=0,k;for(k=0;k<c.length;k+=1)if(g=c.charAt(k),Object.prototype.hasOwnProperty.call(f,g)||(f[g]=S++,p[g]=!0),_=v+g,Object.prototype.hasOwnProperty.call(f,_))v=_;else{if(Object.prototype.hasOwnProperty.call(p,v)){if(v.charCodeAt(0)<256){for(h=0;h<x;h++)R=R<<1,I==l-1?(I=0,M.push(u(R)),R=0):I++;for(d=v.charCodeAt(0),h=0;h<8;h++)R=R<<1|d&1,I==l-1?(I=0,M.push(u(R)),R=0):I++,d=d>>1}else{for(d=1,h=0;h<x;h++)R=R<<1|d,I==l-1?(I=0,M.push(u(R)),R=0):I++,d=0;for(d=v.charCodeAt(0),h=0;h<16;h++)R=R<<1|d&1,I==l-1?(I=0,M.push(u(R)),R=0):I++,d=d>>1}b--,b==0&&(b=Math.pow(2,x),x++),delete p[v]}else for(d=f[v],h=0;h<x;h++)R=R<<1|d&1,I==l-1?(I=0,M.push(u(R)),R=0):I++,d=d>>1;b--,b==0&&(b=Math.pow(2,x),x++),f[_]=S++,v=String(g)}if(v!==""){if(Object.prototype.hasOwnProperty.call(p,v)){if(v.charCodeAt(0)<256){for(h=0;h<x;h++)R=R<<1,I==l-1?(I=0,M.push(u(R)),R=0):I++;for(d=v.charCodeAt(0),h=0;h<8;h++)R=R<<1|d&1,I==l-1?(I=0,M.push(u(R)),R=0):I++,d=d>>1}else{for(d=1,h=0;h<x;h++)R=R<<1|d,I==l-1?(I=0,M.push(u(R)),R=0):I++,d=0;for(d=v.charCodeAt(0),h=0;h<16;h++)R=R<<1|d&1,I==l-1?(I=0,M.push(u(R)),R=0):I++,d=d>>1}b--,b==0&&(b=Math.pow(2,x),x++),delete p[v]}else for(d=f[v],h=0;h<x;h++)R=R<<1|d&1,I==l-1?(I=0,M.push(u(R)),R=0):I++,d=d>>1;b--,b==0&&(b=Math.pow(2,x),x++)}for(d=2,h=0;h<x;h++)R=R<<1|d&1,I==l-1?(I=0,M.push(u(R)),R=0):I++,d=d>>1;for(;;)if(R=R<<1,I==l-1){M.push(u(R));break}else I++;return M.join("")},decompress:function(c){return c==null?"":c==""?null:o._decompress(c.length,32768,function(l){return c.charCodeAt(l)})},_decompress:function(c,l,u){var h=[],d=4,f=4,p=3,g="",_=[],v,b,S,x,M,R,I,k={val:u(0),position:l,index:1};for(v=0;v<3;v+=1)h[v]=v;for(S=0,M=Math.pow(2,2),R=1;R!=M;)x=k.val&k.position,k.position>>=1,k.position==0&&(k.position=l,k.val=u(k.index++)),S|=(x>0?1:0)*R,R<<=1;switch(S){case 0:for(S=0,M=Math.pow(2,8),R=1;R!=M;)x=k.val&k.position,k.position>>=1,k.position==0&&(k.position=l,k.val=u(k.index++)),S|=(x>0?1:0)*R,R<<=1;I=n(S);break;case 1:for(S=0,M=Math.pow(2,16),R=1;R!=M;)x=k.val&k.position,k.position>>=1,k.position==0&&(k.position=l,k.val=u(k.index++)),S|=(x>0?1:0)*R,R<<=1;I=n(S);break;case 2:return""}for(h[3]=I,b=I,_.push(I);;){if(k.index>c)return"";for(S=0,M=Math.pow(2,p),R=1;R!=M;)x=k.val&k.position,k.position>>=1,k.position==0&&(k.position=l,k.val=u(k.index++)),S|=(x>0?1:0)*R,R<<=1;switch(I=S){case 0:for(S=0,M=Math.pow(2,8),R=1;R!=M;)x=k.val&k.position,k.position>>=1,k.position==0&&(k.position=l,k.val=u(k.index++)),S|=(x>0?1:0)*R,R<<=1;h[f++]=n(S),I=f-1,d--;break;case 1:for(S=0,M=Math.pow(2,16),R=1;R!=M;)x=k.val&k.position,k.position>>=1,k.position==0&&(k.position=l,k.val=u(k.index++)),S|=(x>0?1:0)*R,R<<=1;h[f++]=n(S),I=f-1,d--;break;case 2:return _.join("")}if(d==0&&(d=Math.pow(2,p),p++),h[I])g=h[I];else if(I===f)g=b+b.charAt(0);else return null;_.push(g),h[f++]=b+g.charAt(0),d--,b=g,d==0&&(d=Math.pow(2,p),p++)}}};return o}();t!=null?t.exports=e:typeof angular<"u"&&angular!=null&&angular.module("LZString",[]).factory("LZString",function(){return e})})(ZK);var Vdt=ZK.exports;const Gdt=il(Vdt);var w$={};function Xye(t){return t.replace(/</g,"&lt;").replace(/>/g,"&gt;")}const qdt=(t,e,n,i,r,s,a)=>{const o=i+n.indent,c=n.colors;return t.map(l=>{const u=e[l];let h=a(u,n,o,r,s);return typeof u!="string"&&(h.indexOf(`
`)!==-1&&(h=n.spacingOuter+o+h+n.spacingOuter+i),h="{"+h+"}"),n.spacingInner+i+c.prop.open+l+c.prop.close+"="+c.value.open+h+c.value.close}).join("")},$dt=3,Wdt=(t,e,n,i,r,s)=>t.map(a=>{const o=typeof a=="string"?Zye(a,e):s(a,e,n,i,r);return o===""&&typeof a=="object"&&a!==null&&a.nodeType!==$dt?"":e.spacingOuter+n+o}).join(""),Zye=(t,e)=>{const n=e.colors.content;return n.open+Xye(t)+n.close},Ydt=(t,e)=>{const n=e.colors.comment;return n.open+"<!--"+Xye(t)+"-->"+n.close},Kdt=(t,e,n,i,r)=>{const s=i.colors.tag;return s.open+"<"+t+(e&&s.close+e+i.spacingOuter+r+s.open)+(n?">"+s.close+n+i.spacingOuter+r+s.open+"</"+t:(e&&!i.min?"":" ")+"/")+">"+s.close},Xdt=(t,e)=>{const n=e.colors.tag;return n.open+"<"+t+n.close+" "+n.open+" />"+n.close},Zdt=1,Jye=3,Qye=8,ebe=11,Jdt=/^((HTML|SVG)\w*)?Element$/,tbe=t=>{const{tagName:e}=t;return!!(typeof e=="string"&&e.includes("-")||typeof t.hasAttribute=="function"&&t.hasAttribute("is"))},Qdt=t=>{const e=t.constructor.name,{nodeType:n}=t;return n===Zdt&&(Jdt.test(e)||tbe(t))||n===Jye&&e==="Text"||n===Qye&&e==="Comment"||n===ebe&&e==="DocumentFragment"};function eft(t){return t.nodeType===Jye}function tft(t){return t.nodeType===Qye}function ZH(t){return t.nodeType===ebe}function nft(t){return{test:e=>{var n;return((e==null||(n=e.constructor)==null?void 0:n.name)||tbe(e))&&Qdt(e)},serialize:(e,n,i,r,s,a)=>{if(eft(e))return Zye(e.data,n);if(tft(e))return Ydt(e.data,n);const o=ZH(e)?"DocumentFragment":e.tagName.toLowerCase();return++r>n.maxDepth?Xdt(o,n):Kdt(o,qdt(ZH(e)?[]:Array.from(e.attributes).map(c=>c.name).sort(),ZH(e)?{}:Array.from(e.attributes).reduce((c,l)=>(c[l.name]=l.value,c),{}),n,i+n.indent,r,s,a),Wdt(Array.prototype.slice.call(e.childNodes||e.children).filter(t),n,i+n.indent,r,s,a),n,i)}}}let nbe=null,JK=null,QK=null;try{const t=module&&module.require;JK=t.call(module,"fs").readFileSync,QK=t.call(module,"@babel/code-frame").codeFrameColumns,nbe=t.call(module,"chalk")}catch{}function ift(t){const e=t.indexOf("(")+1,n=t.indexOf(")"),i=t.slice(e,n),r=i.split(":"),[s,a,o]=[r[0],parseInt(r[1],10),parseInt(r[2],10)];let c="";try{c=JK(s,"utf-8")}catch{return""}const l=QK(c,{start:{line:a,column:o}},{highlightCode:!0,linesBelow:0});return nbe.dim(i)+`
`+l+`
`}function rft(){if(!JK||!QK)return"";const e=new Error().stack.split(`
`).slice(1).find(n=>!n.includes("node_modules/"));return ift(e)}const ibe=3;function JH(){return typeof jest<"u"&&jest!==null?setTimeout._isMockFunction===!0||Object.prototype.hasOwnProperty.call(setTimeout,"clock"):!1}function eX(){if(typeof window>"u")throw new Error("Could not find default container");return window.document}function sft(t){if(t.defaultView)return t.defaultView;if(t.ownerDocument&&t.ownerDocument.defaultView)return t.ownerDocument.defaultView;if(t.window)return t.window;throw t.ownerDocument&&t.ownerDocument.defaultView===null?new Error("It looks like the window object is not available for the provided node."):t.then instanceof Function?new Error("It looks like you passed a Promise object instead of a DOM node. Did you do something like `fireEvent.click(screen.findBy...` when you meant to use a `getBy` query `fireEvent.click(screen.getBy...`, or await the findBy query `fireEvent.click(await screen.findBy...`?"):Array.isArray(t)?new Error("It looks like you passed an Array instead of a DOM node. Did you do something like `fireEvent.click(screen.getAllBy...` when you meant to use a `getBy` query `fireEvent.click(screen.getBy...`?"):typeof t.debug=="function"&&typeof t.logTestingPlaygroundURL=="function"?new Error("It looks like you passed a `screen` object. Did you do something like `fireEvent.click(screen, ...` when you meant to use a query, e.g. `fireEvent.click(screen.getBy..., `?"):new Error("The given node is not an Element, the node type is: "+typeof t+".")}function K_(t){if(!t||typeof t.querySelector!="function"||typeof t.querySelectorAll!="function")throw new TypeError("Expected container to be an Element, a Document or a DocumentFragment but got "+e(t)+".");function e(n){return typeof n=="object"?n===null?"null":n.constructor.name:typeof n}}const aft=()=>{if(typeof Gn>"u")return!1;let t;try{var e;const n=(e=w$)==null?void 0:e.COLORS;n&&(t=JSON.parse(n))}catch{}return typeof t=="boolean"?t:Gn.versions!==void 0&&Gn.versions.node!==void 0},{DOMCollection:oft}=vye,cft=1,lft=8;function uft(t){return t.nodeType!==lft&&(t.nodeType!==cft||!t.matches(us().defaultIgnore))}function oB(t,e,n){if(n===void 0&&(n={}),t||(t=eX().body),typeof e!="number"&&(e=typeof Gn<"u"&&typeof w$<"u"&&w$.DEBUG_PRINT_LIMIT||7e3),e===0)return"";t.documentElement&&(t=t.documentElement);let i=typeof t;if(i==="object"?i=t.constructor.name:t={},!("outerHTML"in t))throw new TypeError("Expected an element or document but got "+i);const{filterNode:r=uft,...s}=n,a=Gnt(t,{plugins:[nft(r),oft],printFunctionName:!1,highlight:aft(),...s});return e!==void 0&&t.outerHTML.length>e?a.slice(0,e)+"...":a}const pse=function(){const t=rft();console.log(t?oB(...arguments)+`

`+t:oB(...arguments))};let cB={testIdAttribute:"data-testid",asyncUtilTimeout:1e3,asyncWrapper:t=>t(),unstable_advanceTimersWrapper:t=>t(),eventWrapper:t=>t(),defaultHidden:!1,defaultIgnore:"script, style",showOriginalStackTrace:!1,throwSuggestions:!1,getElementError(t,e){const n=oB(e),i=new Error([t,"Ignored nodes: comments, "+cB.defaultIgnore+`
`+n].filter(Boolean).join(`

`));return i.name="TestingLibraryElementError",i},_disableExpensiveErrorDiagnostics:!1,computedStyleSupportsPseudoElements:!1};function hft(t){try{return cB._disableExpensiveErrorDiagnostics=!0,t()}finally{cB._disableExpensiveErrorDiagnostics=!1}}function us(){return cB}const dft=["button","meter","output","progress","select","textarea","input"];function rbe(t){return dft.includes(t.nodeName.toLowerCase())?"":t.nodeType===ibe?t.textContent:Array.from(t.childNodes).map(e=>rbe(e)).join("")}function C$(t){let e;return t.tagName.toLowerCase()==="label"?e=rbe(t):e=t.value||t.textContent,e}function sbe(t){if(t.labels!==void 0){var e;return(e=t.labels)!=null?e:[]}if(!fft(t))return[];const n=t.ownerDocument.querySelectorAll("label");return Array.from(n).filter(i=>i.control===t)}function fft(t){return/BUTTON|METER|OUTPUT|PROGRESS|SELECT|TEXTAREA/.test(t.tagName)||t.tagName==="INPUT"&&t.getAttribute("type")!=="hidden"}function abe(t,e,n){let{selector:i="*"}=n===void 0?{}:n;const r=e.getAttribute("aria-labelledby"),s=r?r.split(" "):[];return s.length?s.map(a=>{const o=t.querySelector('[id="'+a+'"]');return o?{content:C$(o),formControl:null}:{content:"",formControl:null}}):Array.from(sbe(e)).map(a=>{const o=C$(a),l=Array.from(a.querySelectorAll("button, input, meter, output, progress, select, textarea")).filter(u=>u.matches(i))[0];return{content:o,formControl:l}})}function obe(t){if(t==null)throw new Error("It looks like "+t+" was passed instead of a matcher. Did you do something like getByText("+t+")?")}function yR(t,e,n,i){if(typeof t!="string")return!1;obe(n);const r=i(t);return typeof n=="string"||typeof n=="number"?r.toLowerCase().includes(n.toString().toLowerCase()):typeof n=="function"?n(r,e):lbe(n,r)}function __(t,e,n,i){if(typeof t!="string")return!1;obe(n);const r=i(t);return n instanceof Function?n(r,e):n instanceof RegExp?lbe(n,r):r===String(n)}function cbe(t){let{trim:e=!0,collapseWhitespace:n=!0}=t===void 0?{}:t;return i=>{let r=i;return r=e?r.trim():r,r=n?r.replace(/\s+/g," "):r,r}}function ex(t){let{trim:e,collapseWhitespace:n,normalizer:i}=t;if(!i)return cbe({trim:e,collapseWhitespace:n});if(typeof e<"u"||typeof n<"u")throw new Error('trim and collapseWhitespace are not supported with a normalizer. If you want to use the default trim and collapseWhitespace logic in your normalizer, use "getDefaultNormalizer({trim, collapseWhitespace})" and compose that into your normalizer');return i}function lbe(t,e){const n=t.test(e);return t.global&&t.lastIndex!==0&&(console.warn("To match all elements we had to reset the lastIndex of the RegExp because the global flag is enabled. We encourage to remove the global flag from the RegExp."),t.lastIndex=0),n}function b8(t){return t.matches("input[type=submit], input[type=button], input[type=reset]")?t.value:Array.from(t.childNodes).filter(e=>e.nodeType===ibe&&!!e.textContent).map(e=>e.textContent).join("")}const pft=mft(Yye);function ube(t){return t.hidden===!0||t.getAttribute("aria-hidden")==="true"||t.ownerDocument.defaultView.getComputedStyle(t).display==="none"}function tX(t,e){e===void 0&&(e={});const{isSubtreeInaccessible:n=ube}=e;if(t.ownerDocument.defaultView.getComputedStyle(t).visibility==="hidden")return!0;let r=t;for(;r;){if(n(r))return!0;r=r.parentElement}return!1}function nX(t){for(const{match:e,roles:n}of pft)if(e(t))return[...n];return[]}function mft(t){function e(a){let{name:o,attributes:c}=a;return""+o+c.map(l=>{let{name:u,value:h,constraints:d=[]}=l;const f=d.indexOf("undefined")!==-1,p=d.indexOf("set")!==-1;return typeof h<"u"?"["+u+'="'+h+'"]':f?":not(["+u+"])":p?"["+u+"]:not(["+u+'=""])':"["+u+"]"}).join("")}function n(a){let{attributes:o=[]}=a;return o.length}function i(a,o){let{specificity:c}=a,{specificity:l}=o;return l-c}function r(a){let{attributes:o=[]}=a;const c=o.findIndex(u=>u.value&&u.name==="type"&&u.value==="text");c>=0&&(o=[...o.slice(0,c),...o.slice(c+1)]);const l=e({...a,attributes:o});return u=>c>=0&&u.type!=="text"?!1:u.matches(l)}let s=[];for(const[a,o]of t.entries())s=[...s,{match:r(a),roles:Array.from(o),specificity:n(a)}];return s.sort(i)}function gft(t,e){let{hidden:n=!1}=e===void 0?{}:e;function i(r){return[r,...Array.from(r.children).reduce((s,a)=>[...s,...i(a)],[])]}return i(t).filter(r=>n===!1?tX(r)===!1:!0).reduce((r,s)=>{let a=[];return s.hasAttribute("role")?a=s.getAttribute("role").split(" ").slice(0,1):a=nX(s),a.reduce((o,c)=>Array.isArray(o[c])?{...o,[c]:[...o[c],s]}:{...o,[c]:[s]},r)},{})}function vft(t,e){let{hidden:n,includeDescription:i}=e;const r=gft(t,{hidden:n});return Object.entries(r).filter(s=>{let[a]=s;return a!=="generic"}).map(s=>{let[a,o]=s;const c="-".repeat(50),l=o.map(u=>{const h='Name "'+KK(u,{computedStyleSupportsPseudoElements:us().computedStyleSupportsPseudoElements})+`":
`,d=oB(u.cloneNode(!1));if(i){const f='Description "'+Lye(u,{computedStyleSupportsPseudoElements:us().computedStyleSupportsPseudoElements})+`":
`;return""+h+f+d}return""+h+d}).join(`

`);return a+`:

`+l+`

`+c}).join(`
`)}function _ft(t){return t.tagName==="OPTION"?t.selected:$k(t,"aria-selected")}function yft(t){return t.getAttribute("aria-busy")==="true"}function bft(t){if(!("indeterminate"in t&&t.indeterminate))return"checked"in t?t.checked:$k(t,"aria-checked")}function Eft(t){return $k(t,"aria-pressed")}function Sft(t){var e,n;return(e=(n=$k(t,"aria-current"))!=null?n:t.getAttribute("aria-current"))!=null?e:!1}function Tft(t){return $k(t,"aria-expanded")}function $k(t,e){const n=t.getAttribute(e);if(n==="true")return!0;if(n==="false")return!1}function xft(t){const e={H1:1,H2:2,H3:3,H4:4,H5:5,H6:6};return t.getAttribute("aria-level")&&Number(t.getAttribute("aria-level"))||e[t.tagName]}function wft(t){const e=t.getAttribute("aria-valuenow");return e===null?void 0:+e}function Cft(t){const e=t.getAttribute("aria-valuemax");return e===null?void 0:+e}function Aft(t){const e=t.getAttribute("aria-valuemin");return e===null?void 0:+e}function Rft(t){const e=t.getAttribute("aria-valuetext");return e===null?void 0:e}const mse=cbe();function Mft(t){return t.replace(/[.*+\-?^${}()|[\]\\]/g,"\\$&")}function gse(t){return new RegExp(Mft(t.toLowerCase()),"i")}function zy(t,e,n,i){let{variant:r,name:s}=i,a="";const o={},c=[["Role","TestId"].includes(t)?n:gse(n)];s&&(o.name=gse(s)),t==="Role"&&tX(e)&&(o.hidden=!0,a=`Element is inaccessible. This means that the element and all its children are invisible to screen readers.
    If you are using the aria-hidden prop, make sure this is the right choice for your case.
    `),Object.keys(o).length>0&&c.push(o);const l=r+"By"+t;return{queryName:t,queryMethod:l,queryArgs:c,variant:r,warning:a,toString(){a&&console.warn(a);let[u,h]=c;return u=typeof u=="string"?"'"+u+"'":u,h=h?", { "+Object.entries(h).map(d=>{let[f,p]=d;return f+": "+p}).join(", ")+" }":"",l+"("+u+h+")"}}}function jy(t,e,n){return n&&!e}function A$(t,e,n){var i,r;if(e===void 0&&(e="get"),t.matches(us().defaultIgnore))return;const s=(i=t.getAttribute("role"))!=null?i:(r=nX(t))==null?void 0:r[0];if(s!=="generic"&&jy("Role",n,s))return zy("Role",t,s,{variant:e,name:KK(t,{computedStyleSupportsPseudoElements:us().computedStyleSupportsPseudoElements})});const a=abe(document,t).map(d=>d.content).join(" ");if(jy("LabelText",n,a))return zy("LabelText",t,a,{variant:e});const o=t.getAttribute("placeholder");if(jy("PlaceholderText",n,o))return zy("PlaceholderText",t,o,{variant:e});const c=mse(b8(t));if(jy("Text",n,c))return zy("Text",t,c,{variant:e});if(jy("DisplayValue",n,t.value))return zy("DisplayValue",t,mse(t.value),{variant:e});const l=t.getAttribute("alt");if(jy("AltText",n,l))return zy("AltText",t,l,{variant:e});const u=t.getAttribute("title");if(jy("Title",n,u))return zy("Title",t,u,{variant:e});const h=t.getAttribute(us().testIdAttribute);if(jy("TestId",n,h))return zy("TestId",t,h,{variant:e})}function d2(t,e){t.stack=e.stack.replace(e.message,t.message)}function Oft(t,e){let{container:n=eX(),timeout:i=us().asyncUtilTimeout,showOriginalStackTrace:r=us().showOriginalStackTrace,stackTraceError:s,interval:a=50,onTimeout:o=l=>(Object.defineProperty(l,"message",{value:us().getElementError(l.message,n).message}),l),mutationObserverOptions:c={subtree:!0,childList:!0,attributes:!0,characterData:!0}}=e;if(typeof t!="function")throw new TypeError("Received `callback` arg must be a function");return new Promise(async(l,u)=>{let h,d,f,p=!1,g="idle";const _=setTimeout(M,i),v=JH();if(v){const{unstable_advanceTimersWrapper:R}=us();for(x();!p;){if(!JH()){const I=new Error("Changed from using fake timers to real timers while using waitFor. This is not allowed and will result in very strange behavior. Please ensure you're awaiting all async things your test is doing before changing to real timers. For more info, please go to https://github.com/testing-library/dom-testing-library/issues/830");r||d2(I,s),u(I);return}if(await R(async()=>{jest.advanceTimersByTime(a)}),p)break;x()}}else{try{K_(n)}catch(I){u(I);return}d=setInterval(S,a);const{MutationObserver:R}=sft(n);f=new R(S),f.observe(n,c),x()}function b(R,I){p=!0,clearTimeout(_),v||(clearInterval(d),f.disconnect()),R?u(R):l(I)}function S(){if(JH()){const R=new Error("Changed from using real timers to fake timers while using waitFor. This is not allowed and will result in very strange behavior. Please ensure you're awaiting all async things your test is doing before changing to fake timers. For more info, please go to https://github.com/testing-library/dom-testing-library/issues/830");return r||d2(R,s),u(R)}else return x()}function x(){if(g!=="pending")try{const R=hft(t);typeof(R==null?void 0:R.then)=="function"?(g="pending",R.then(I=>{g="resolved",b(null,I)},I=>{g="rejected",h=I})):b(null,R)}catch(R){h=R}}function M(){let R;h?(R=h,!r&&R.name==="TestingLibraryElementError"&&d2(R,s)):(R=new Error("Timed out in waitFor."),r||d2(R,s)),b(o(R),null)}})}function Nft(t,e){const n=new Error("STACK_TRACE_MESSAGE");return us().asyncWrapper(()=>Oft(t,{stackTraceError:n,...e}))}function hbe(t,e){return us().getElementError(t,e)}function Ift(t,e){return hbe(t+"\n\n(If this is intentional, then use the `*AllBy*` variant of the query (like `queryAllByText`, `getAllByText`, or `findAllByText`)).",e)}function E8(t,e,n,i){let{exact:r=!0,collapseWhitespace:s,trim:a,normalizer:o}=i===void 0?{}:i;const c=r?__:yR,l=ex({collapseWhitespace:s,trim:a,normalizer:o});return Array.from(e.querySelectorAll("["+t+"]")).filter(u=>c(u.getAttribute(t),u,n,l))}function lB(t,e){return function(n){for(var i=arguments.length,r=new Array(i>1?i-1:0),s=1;s<i;s++)r[s-1]=arguments[s];const a=t(n,...r);if(a.length>1){const o=a.map(c=>hbe(null,c).message).join(`

`);throw Ift(e(n,...r)+`

Here are the matching elements:

`+o,n)}return a[0]||null}}function dbe(t,e){return us().getElementError(`A better query is available, try this:
`+t.toString()+`
`,e)}function kft(t,e){return function(n){for(var i=arguments.length,r=new Array(i>1?i-1:0),s=1;s<i;s++)r[s-1]=arguments[s];const a=t(n,...r);if(!a.length)throw us().getElementError(e(n,...r),n);return a}}function uB(t){return(e,n,i,r)=>Nft(()=>t(e,n,i),{container:e,...r})}const AC=(t,e,n)=>function(i){for(var r=arguments.length,s=new Array(r>1?r-1:0),a=1;a<r;a++)s[a-1]=arguments[a];const o=t(i,...s),[{suggest:c=us().throwSuggestions}={}]=s.slice(-1);if(o&&c){const l=A$(o,n);if(l&&!e.endsWith(l.queryName))throw dbe(l.toString(),i)}return o},Ap=(t,e,n)=>function(i){for(var r=arguments.length,s=new Array(r>1?r-1:0),a=1;a<r;a++)s[a-1]=arguments[a];const o=t(i,...s),[{suggest:c=us().throwSuggestions}={}]=s.slice(-1);if(o.length&&c){const l=[...new Set(o.map(u=>{var h;return(h=A$(u,n))==null?void 0:h.toString()}))];if(l.length===1&&!e.endsWith(A$(o[0],n).queryName))throw dbe(l[0],i)}return o};function tx(t,e,n){const i=AC(lB(t,e),t.name,"query"),r=kft(t,n),s=lB(r,e),a=AC(s,t.name,"get"),o=Ap(r,t.name.replace("query","get"),"getAll"),c=uB(Ap(r,t.name,"findAll")),l=uB(AC(s,t.name,"find"));return[i,o,a,c,l]}function Pft(t){return Array.from(t.querySelectorAll("label,input")).map(e=>({node:e,textToMatch:C$(e)})).filter(e=>{let{textToMatch:n}=e;return n!==null})}const Dft=function(t,e,n){let{exact:i=!0,trim:r,collapseWhitespace:s,normalizer:a}=n===void 0?{}:n;const o=i?__:yR,c=ex({collapseWhitespace:s,trim:r,normalizer:a});return Pft(t).filter(u=>{let{node:h,textToMatch:d}=u;return o(d,h,e,c)}).map(u=>{let{node:h}=u;return h})},oI=function(t,e,n){let{selector:i="*",exact:r=!0,collapseWhitespace:s,trim:a,normalizer:o}=n===void 0?{}:n;K_(t);const c=r?__:yR,l=ex({collapseWhitespace:s,trim:a,normalizer:o}),u=Array.from(t.querySelectorAll("*")).filter(h=>sbe(h).length||h.hasAttribute("aria-labelledby")).reduce((h,d)=>{const f=abe(t,d,{selector:i});f.filter(g=>!!g.formControl).forEach(g=>{c(g.content,g.formControl,e,l)&&g.formControl&&h.push(g.formControl)});const p=f.filter(g=>!!g.content).map(g=>g.content);return c(p.join(" "),d,e,l)&&h.push(d),p.length>1&&p.forEach((g,_)=>{c(g,d,e,l)&&h.push(d);const v=[...p];v.splice(_,1),v.length>1&&c(v.join(" "),d,e,l)&&h.push(d)}),h},[]).concat(E8("aria-label",t,e,{exact:r,normalizer:l}));return Array.from(new Set(u)).filter(h=>h.matches(i))},w1=function(t,e){for(var n=arguments.length,i=new Array(n>2?n-2:0),r=2;r<n;r++)i[r-2]=arguments[r];const s=oI(t,e,...i);if(!s.length){const a=Dft(t,e,...i);if(a.length){const o=a.map(c=>Lft(t,c)).filter(c=>!!c);throw o.length?us().getElementError(o.map(c=>"Found a label with the text of: "+e+", however the element associated with this label (<"+c+" />) is non-labellable [https://html.spec.whatwg.org/multipage/forms.html#category-label]. If you really need to label a <"+c+" />, you can use aria-label or aria-labelledby instead.").join(`

`),t):us().getElementError("Found a label with the text of: "+e+`, however no form control was found associated to that label. Make sure you're using the "for" attribute or "aria-labelledby" attribute correctly.`,t)}else throw us().getElementError("Unable to find a label with the text of: "+e,t)}return s};function Lft(t,e){const n=e.getAttribute("for");if(!n)return null;const i=t.querySelector('[id="'+n+'"]');return i?i.tagName.toLowerCase():null}const fbe=(t,e)=>"Found multiple elements with the text of: "+e,Uft=AC(lB(oI,fbe),oI.name,"query"),pbe=lB(w1,fbe),Bft=uB(Ap(w1,w1.name,"findAll")),Fft=uB(AC(pbe,w1.name,"find")),zft=Ap(w1,w1.name,"getAll"),jft=AC(pbe,w1.name,"get"),Hft=Ap(oI,oI.name,"queryAll"),R$=function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return K_(e[0]),E8("placeholder",...e)},Vft=(t,e)=>"Found multiple elements with the placeholder text of: "+e,Gft=(t,e)=>"Unable to find an element with the placeholder text of: "+e,qft=Ap(R$,R$.name,"queryAll"),[$ft,Wft,Yft,Kft,Xft]=tx(R$,Vft,Gft),M$=function(t,e,n){let{selector:i="*",exact:r=!0,collapseWhitespace:s,trim:a,ignore:o=us().defaultIgnore,normalizer:c}=n===void 0?{}:n;K_(t);const l=r?__:yR,u=ex({collapseWhitespace:s,trim:a,normalizer:c});let h=[];return typeof t.matches=="function"&&t.matches(i)&&(h=[t]),[...h,...Array.from(t.querySelectorAll(i))].filter(d=>!o||!d.matches(o)).filter(d=>l(b8(d),d,e,u))},Zft=(t,e)=>"Found multiple elements with the text: "+e,Jft=function(t,e,n){n===void 0&&(n={});const{collapseWhitespace:i,trim:r,normalizer:s,selector:a}=n,c=ex({collapseWhitespace:i,trim:r,normalizer:s})(e.toString()),l=c!==e.toString(),u=(a??"*")!=="*";return"Unable to find an element with the text: "+(l?c+" (normalized from '"+e+"')":e)+(u?", which matches selector '"+a+"'":"")+". This could be because the text is broken up by multiple elements. In this case, you can provide a function for your text matcher to make your matcher more flexible."},Qft=Ap(M$,M$.name,"queryAll"),[ept,tpt,npt,ipt,rpt]=tx(M$,Zft,Jft),O$=function(t,e,n){let{exact:i=!0,collapseWhitespace:r,trim:s,normalizer:a}=n===void 0?{}:n;K_(t);const o=i?__:yR,c=ex({collapseWhitespace:r,trim:s,normalizer:a});return Array.from(t.querySelectorAll("input,textarea,select")).filter(l=>l.tagName==="SELECT"?Array.from(l.options).filter(h=>h.selected).some(h=>o(b8(h),h,e,c)):o(l.value,l,e,c))},spt=(t,e)=>"Found multiple elements with the display value: "+e+".",apt=(t,e)=>"Unable to find an element with the display value: "+e+".",opt=Ap(O$,O$.name,"queryAll"),[cpt,lpt,upt,hpt,dpt]=tx(O$,spt,apt),fpt=/^(img|input|area|.+-.+)$/i,N$=function(t,e,n){return n===void 0&&(n={}),K_(t),E8("alt",t,e,n).filter(i=>fpt.test(i.tagName))},ppt=(t,e)=>"Found multiple elements with the alt text: "+e,mpt=(t,e)=>"Unable to find an element with the alt text: "+e,gpt=Ap(N$,N$.name,"queryAll"),[vpt,_pt,ypt,bpt,Ept]=tx(N$,ppt,mpt),Spt=t=>{var e;return t.tagName.toLowerCase()==="title"&&((e=t.parentElement)==null?void 0:e.tagName.toLowerCase())==="svg"},I$=function(t,e,n){let{exact:i=!0,collapseWhitespace:r,trim:s,normalizer:a}=n===void 0?{}:n;K_(t);const o=i?__:yR,c=ex({collapseWhitespace:r,trim:s,normalizer:a});return Array.from(t.querySelectorAll("[title], svg > title")).filter(l=>o(l.getAttribute("title"),l,e,c)||Spt(l)&&o(b8(l),l,e,c))},Tpt=(t,e)=>"Found multiple elements with the title: "+e+".",xpt=(t,e)=>"Unable to find an element with the title: "+e+".",wpt=Ap(I$,I$.name,"queryAll"),[Cpt,Apt,Rpt,Mpt,Opt]=tx(I$,Tpt,xpt),k$=function(t,e,n){let{hidden:i=us().defaultHidden,name:r,description:s,queryFallbacks:a=!1,selected:o,busy:c,checked:l,pressed:u,current:h,level:d,expanded:f,value:{now:p,min:g,max:_,text:v}={}}=n===void 0?{}:n;if(K_(t),o!==void 0){var b;if(((b=cm.get(e))==null?void 0:b.props["aria-selected"])===void 0)throw new Error('"aria-selected" is not supported on role "'+e+'".')}if(c!==void 0){var S;if(((S=cm.get(e))==null?void 0:S.props["aria-busy"])===void 0)throw new Error('"aria-busy" is not supported on role "'+e+'".')}if(l!==void 0){var x;if(((x=cm.get(e))==null?void 0:x.props["aria-checked"])===void 0)throw new Error('"aria-checked" is not supported on role "'+e+'".')}if(u!==void 0){var M;if(((M=cm.get(e))==null?void 0:M.props["aria-pressed"])===void 0)throw new Error('"aria-pressed" is not supported on role "'+e+'".')}if(h!==void 0){var R;if(((R=cm.get(e))==null?void 0:R.props["aria-current"])===void 0)throw new Error('"aria-current" is not supported on role "'+e+'".')}if(d!==void 0&&e!=="heading")throw new Error('Role "'+e+'" cannot have "level" property.');if(p!==void 0){var I;if(((I=cm.get(e))==null?void 0:I.props["aria-valuenow"])===void 0)throw new Error('"aria-valuenow" is not supported on role "'+e+'".')}if(_!==void 0){var k;if(((k=cm.get(e))==null?void 0:k.props["aria-valuemax"])===void 0)throw new Error('"aria-valuemax" is not supported on role "'+e+'".')}if(g!==void 0){var P;if(((P=cm.get(e))==null?void 0:P.props["aria-valuemin"])===void 0)throw new Error('"aria-valuemin" is not supported on role "'+e+'".')}if(v!==void 0){var U;if(((U=cm.get(e))==null?void 0:U.props["aria-valuetext"])===void 0)throw new Error('"aria-valuetext" is not supported on role "'+e+'".')}if(f!==void 0){var V;if(((V=cm.get(e))==null?void 0:V.props["aria-expanded"])===void 0)throw new Error('"aria-expanded" is not supported on role "'+e+'".')}const $=new WeakMap;function q(Y){return $.has(Y)||$.set(Y,ube(Y)),$.get(Y)}return Array.from(t.querySelectorAll(Npt(e))).filter(Y=>{if(Y.hasAttribute("role")){const J=Y.getAttribute("role");if(a)return J.split(" ").filter(Boolean).some(X=>X===e);const[K]=J.split(" ");return K===e}return nX(Y).some(J=>J===e)}).filter(Y=>{if(o!==void 0)return o===_ft(Y);if(c!==void 0)return c===yft(Y);if(l!==void 0)return l===bft(Y);if(u!==void 0)return u===Eft(Y);if(h!==void 0)return h===Sft(Y);if(f!==void 0)return f===Tft(Y);if(d!==void 0)return d===xft(Y);if(p!==void 0||_!==void 0||g!==void 0||v!==void 0){let G=!0;if(p!==void 0&&G&&(G=p===wft(Y)),_!==void 0&&G&&(G=_===Cft(Y)),g!==void 0&&G&&(G=g===Aft(Y)),v!==void 0){var te;G&&(G=__((te=Rft(Y))!=null?te:null,Y,v,J=>J))}return G}return!0}).filter(Y=>r===void 0?!0:__(KK(Y,{computedStyleSupportsPseudoElements:us().computedStyleSupportsPseudoElements}),Y,r,te=>te)).filter(Y=>s===void 0?!0:__(Lye(Y,{computedStyleSupportsPseudoElements:us().computedStyleSupportsPseudoElements}),Y,s,te=>te)).filter(Y=>i===!1?tX(Y,{isSubtreeInaccessible:q})===!1:!0)};function Npt(t){var e;const n='*[role~="'+t+'"]',i=(e=Kye.get(t))!=null?e:new Set,r=new Set(Array.from(i).map(s=>{let{name:a}=s;return a}));return[n].concat(Array.from(r)).join(",")}const mbe=t=>{let e="";return t===void 0?e="":typeof t=="string"?e=' and name "'+t+'"':e=" and name `"+t+"`",e},Ipt=function(t,e,n){let{name:i}=n===void 0?{}:n;return'Found multiple elements with the role "'+e+'"'+mbe(i)},kpt=function(t,e,n){let{hidden:i=us().defaultHidden,name:r,description:s}=n===void 0?{}:n;if(us()._disableExpensiveErrorDiagnostics)return'Unable to find role="'+e+'"'+mbe(r);let a="";Array.from(t.children).forEach(u=>{a+=vft(u,{hidden:i,includeDescription:s!==void 0})});let o;a.length===0?i===!1?o="There are no accessible roles. But there might be some inaccessible roles. If you wish to access them, then set the `hidden` option to `true`. Learn more about this here: https://testing-library.com/docs/dom-testing-library/api-queries#byrole":o="There are no available roles.":o=(`
Here are the `+(i===!1?"accessible":"available")+` roles:

  `+a.replace(/\n/g,`
  `).replace(/\n\s\s\n/g,`

`)+`
`).trim();let c="";r===void 0?c="":typeof r=="string"?c=' and name "'+r+'"':c=" and name `"+r+"`";let l="";return s===void 0?l="":typeof s=="string"?l=' and description "'+s+'"':l=" and description `"+s+"`",(`
Unable to find an `+(i===!1?"accessible ":"")+'element with the role "'+e+'"'+c+l+`

`+o).trim()},Ppt=Ap(k$,k$.name,"queryAll"),[Dpt,Lpt,Upt,Bpt,Fpt]=tx(k$,Ipt,kpt),iX=()=>us().testIdAttribute,P$=function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return K_(e[0]),E8(iX(),...e)},zpt=(t,e)=>"Found multiple elements by: ["+iX()+'="'+e+'"]',jpt=(t,e)=>"Unable to find an element by: ["+iX()+'="'+e+'"]',Hpt=Ap(P$,P$.name,"queryAll"),[Vpt,Gpt,qpt,$pt,Wpt]=tx(P$,zpt,jpt);var D$=Object.freeze({__proto__:null,queryAllByLabelText:Hft,queryByLabelText:Uft,getAllByLabelText:zft,getByLabelText:jft,findAllByLabelText:Bft,findByLabelText:Fft,queryByPlaceholderText:$ft,queryAllByPlaceholderText:qft,getByPlaceholderText:Yft,getAllByPlaceholderText:Wft,findAllByPlaceholderText:Kft,findByPlaceholderText:Xft,queryByText:ept,queryAllByText:Qft,getByText:npt,getAllByText:tpt,findAllByText:ipt,findByText:rpt,queryByDisplayValue:cpt,queryAllByDisplayValue:opt,getByDisplayValue:upt,getAllByDisplayValue:lpt,findAllByDisplayValue:hpt,findByDisplayValue:dpt,queryByAltText:vpt,queryAllByAltText:gpt,getByAltText:ypt,getAllByAltText:_pt,findAllByAltText:bpt,findByAltText:Ept,queryByTitle:Cpt,queryAllByTitle:wpt,getByTitle:Rpt,getAllByTitle:Apt,findAllByTitle:Mpt,findByTitle:Opt,queryByRole:Dpt,queryAllByRole:Ppt,getAllByRole:Lpt,getByRole:Upt,findAllByRole:Bpt,findByRole:Fpt,queryByTestId:Vpt,queryAllByTestId:Hpt,getByTestId:qpt,getAllByTestId:Gpt,findAllByTestId:$pt,findByTestId:Wpt});function Ypt(t,e,n){return e===void 0&&(e=D$),n===void 0&&(n={}),Object.keys(e).reduce((i,r)=>{const s=e[r];return i[r]=s.bind(null,t),i},n)}const Kpt={copy:{EventType:"ClipboardEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},cut:{EventType:"ClipboardEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},paste:{EventType:"ClipboardEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},compositionEnd:{EventType:"CompositionEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},compositionStart:{EventType:"CompositionEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},compositionUpdate:{EventType:"CompositionEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},keyDown:{EventType:"KeyboardEvent",defaultInit:{bubbles:!0,cancelable:!0,charCode:0,composed:!0}},keyPress:{EventType:"KeyboardEvent",defaultInit:{bubbles:!0,cancelable:!0,charCode:0,composed:!0}},keyUp:{EventType:"KeyboardEvent",defaultInit:{bubbles:!0,cancelable:!0,charCode:0,composed:!0}},focus:{EventType:"FocusEvent",defaultInit:{bubbles:!1,cancelable:!1,composed:!0}},blur:{EventType:"FocusEvent",defaultInit:{bubbles:!1,cancelable:!1,composed:!0}},focusIn:{EventType:"FocusEvent",defaultInit:{bubbles:!0,cancelable:!1,composed:!0}},focusOut:{EventType:"FocusEvent",defaultInit:{bubbles:!0,cancelable:!1,composed:!0}},change:{EventType:"Event",defaultInit:{bubbles:!0,cancelable:!1}},input:{EventType:"InputEvent",defaultInit:{bubbles:!0,cancelable:!1,composed:!0}},invalid:{EventType:"Event",defaultInit:{bubbles:!1,cancelable:!0}},submit:{EventType:"Event",defaultInit:{bubbles:!0,cancelable:!0}},reset:{EventType:"Event",defaultInit:{bubbles:!0,cancelable:!0}},click:{EventType:"MouseEvent",defaultInit:{bubbles:!0,cancelable:!0,button:0,composed:!0}},contextMenu:{EventType:"MouseEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},dblClick:{EventType:"MouseEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},drag:{EventType:"DragEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},dragEnd:{EventType:"DragEvent",defaultInit:{bubbles:!0,cancelable:!1,composed:!0}},dragEnter:{EventType:"DragEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},dragExit:{EventType:"DragEvent",defaultInit:{bubbles:!0,cancelable:!1,composed:!0}},dragLeave:{EventType:"DragEvent",defaultInit:{bubbles:!0,cancelable:!1,composed:!0}},dragOver:{EventType:"DragEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},dragStart:{EventType:"DragEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},drop:{EventType:"DragEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},mouseDown:{EventType:"MouseEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},mouseEnter:{EventType:"MouseEvent",defaultInit:{bubbles:!1,cancelable:!1,composed:!0}},mouseLeave:{EventType:"MouseEvent",defaultInit:{bubbles:!1,cancelable:!1,composed:!0}},mouseMove:{EventType:"MouseEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},mouseOut:{EventType:"MouseEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},mouseOver:{EventType:"MouseEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},mouseUp:{EventType:"MouseEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},select:{EventType:"Event",defaultInit:{bubbles:!0,cancelable:!1}},touchCancel:{EventType:"TouchEvent",defaultInit:{bubbles:!0,cancelable:!1,composed:!0}},touchEnd:{EventType:"TouchEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},touchMove:{EventType:"TouchEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},touchStart:{EventType:"TouchEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},resize:{EventType:"UIEvent",defaultInit:{bubbles:!1,cancelable:!1}},scroll:{EventType:"UIEvent",defaultInit:{bubbles:!1,cancelable:!1}},wheel:{EventType:"WheelEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},abort:{EventType:"Event",defaultInit:{bubbles:!1,cancelable:!1}},canPlay:{EventType:"Event",defaultInit:{bubbles:!1,cancelable:!1}},canPlayThrough:{EventType:"Event",defaultInit:{bubbles:!1,cancelable:!1}},durationChange:{EventType:"Event",defaultInit:{bubbles:!1,cancelable:!1}},emptied:{EventType:"Event",defaultInit:{bubbles:!1,cancelable:!1}},encrypted:{EventType:"Event",defaultInit:{bubbles:!1,cancelable:!1}},ended:{EventType:"Event",defaultInit:{bubbles:!1,cancelable:!1}},loadedData:{EventType:"Event",defaultInit:{bubbles:!1,cancelable:!1}},loadedMetadata:{EventType:"Event",defaultInit:{bubbles:!1,cancelable:!1}},loadStart:{EventType:"ProgressEvent",defaultInit:{bubbles:!1,cancelable:!1}},pause:{EventType:"Event",defaultInit:{bubbles:!1,cancelable:!1}},play:{EventType:"Event",defaultInit:{bubbles:!1,cancelable:!1}},playing:{EventType:"Event",defaultInit:{bubbles:!1,cancelable:!1}},progress:{EventType:"ProgressEvent",defaultInit:{bubbles:!1,cancelable:!1}},rateChange:{EventType:"Event",defaultInit:{bubbles:!1,cancelable:!1}},seeked:{EventType:"Event",defaultInit:{bubbles:!1,cancelable:!1}},seeking:{EventType:"Event",defaultInit:{bubbles:!1,cancelable:!1}},stalled:{EventType:"Event",defaultInit:{bubbles:!1,cancelable:!1}},suspend:{EventType:"Event",defaultInit:{bubbles:!1,cancelable:!1}},timeUpdate:{EventType:"Event",defaultInit:{bubbles:!1,cancelable:!1}},volumeChange:{EventType:"Event",defaultInit:{bubbles:!1,cancelable:!1}},waiting:{EventType:"Event",defaultInit:{bubbles:!1,cancelable:!1}},load:{EventType:"Event",defaultInit:{bubbles:!1,cancelable:!1}},error:{EventType:"Event",defaultInit:{bubbles:!1,cancelable:!1}},animationStart:{EventType:"AnimationEvent",defaultInit:{bubbles:!0,cancelable:!1}},animationEnd:{EventType:"AnimationEvent",defaultInit:{bubbles:!0,cancelable:!1}},animationIteration:{EventType:"AnimationEvent",defaultInit:{bubbles:!0,cancelable:!1}},transitionCancel:{EventType:"TransitionEvent",defaultInit:{bubbles:!0,cancelable:!1}},transitionEnd:{EventType:"TransitionEvent",defaultInit:{bubbles:!0,cancelable:!0}},transitionRun:{EventType:"TransitionEvent",defaultInit:{bubbles:!0,cancelable:!1}},transitionStart:{EventType:"TransitionEvent",defaultInit:{bubbles:!0,cancelable:!1}},pointerOver:{EventType:"PointerEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},pointerEnter:{EventType:"PointerEvent",defaultInit:{bubbles:!1,cancelable:!1}},pointerDown:{EventType:"PointerEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},pointerMove:{EventType:"PointerEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},pointerUp:{EventType:"PointerEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},pointerCancel:{EventType:"PointerEvent",defaultInit:{bubbles:!0,cancelable:!1,composed:!0}},pointerOut:{EventType:"PointerEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},pointerLeave:{EventType:"PointerEvent",defaultInit:{bubbles:!1,cancelable:!1}},gotPointerCapture:{EventType:"PointerEvent",defaultInit:{bubbles:!0,cancelable:!1,composed:!0}},lostPointerCapture:{EventType:"PointerEvent",defaultInit:{bubbles:!0,cancelable:!1,composed:!0}},popState:{EventType:"PopStateEvent",defaultInit:{bubbles:!0,cancelable:!1}},offline:{EventType:"Event",defaultInit:{bubbles:!1,cancelable:!1}},online:{EventType:"Event",defaultInit:{bubbles:!1,cancelable:!1}},pageHide:{EventType:"PageTransitionEvent",defaultInit:{bubbles:!0,cancelable:!0}},pageShow:{EventType:"PageTransitionEvent",defaultInit:{bubbles:!0,cancelable:!0}}},Xpt={doubleClick:"dblClick"};Object.keys(Kpt).forEach(t=>{t.toLowerCase()});Object.keys(Xpt).forEach(t=>{});function Zpt(t){return t.replace(/[ \t]*[\n][ \t]*/g,`
`)}function Jpt(t){return Gdt.compressToEncodedURIComponent(Zpt(t))}function Qpt(t){return"https://testing-playground.com/#markup="+Jpt(t)}const emt=(t,e,n)=>Array.isArray(t)?t.forEach(i=>pse(i,e,n)):pse(t,e,n),tmt=function(t){if(t===void 0&&(t=eX().body),!t||!("innerHTML"in t)){console.log("The element you're providing isn't a valid DOM element.");return}if(!t.innerHTML){console.log("The provided element doesn't have any children.");return}const e=Qpt(t.innerHTML);return console.log(`Open this URL in your browser

`+e),e},vse={debug:emt,logTestingPlaygroundURL:tmt};typeof document<"u"&&document.body?Ypt(document.body,D$,vse):Object.keys(D$).reduce((t,e)=>(t[e]=()=>{throw new TypeError("For queries bound to document.body a global document has to be available... Learn more: https://testing-library.com/s/screen-global-error")},t),vse);function OA(t,e){return us().eventWrapper(t)}function pE(t){const e=Rtt(t,GK),n=Pk(t.ownerDocument);(e??t.ownerDocument.body)!==n&&(OA(e?()=>e.focus():()=>n==null?void 0:n.blur()),Ntt(e??t.ownerDocument.body))}function nmt(t){!GK(t)||!(Pk(t.ownerDocument)===t)||OA(()=>t.blur())}const mE={};mE.click=(t,e,n)=>{const i=e.closest("button,input,label,select,textarea"),r=i&&vr(i,"label")&&i.control;if(r&&r!==e)return()=>{GK(r)&&(pE(r),n.dispatchEvent(r,Att(t)))};if(vr(e,"input",{type:"file"}))return()=>{nmt(e),e.dispatchEvent(new(Dp(e)).Event("fileDialog")),pE(e)}};const NA=Symbol("Displayed value in UI"),u_=Symbol("Displayed selection in UI"),hB=Symbol("Initial value to compare on blur");function imt(t){return typeof t=="object"&&NA in t}function rmt(t){return!!t&&typeof t=="object"&&u_ in t}function smt(t,e){t[hB]===void 0&&(t[hB]=t.value),t[NA]=e,t.value=Object.assign(new String(e),{[NA]:!0})}function A0(t){return t[NA]===void 0?t.value:String(t[NA])}function rX(t){t[NA]=void 0}function gbe(t){t[hB]=void 0}function amt(t){return t[hB]}function omt(t,e){t[u_]=e}function bR(t,{focusOffset:e,anchorOffset:n=e},i="replace"){const r=A0(t).length,s=h=>Math.max(0,Math.min(r,h)),a=i==="replace"||t[u_]===void 0?s(n):t[u_].anchorOffset,o=s(e),c=Math.min(a,o),l=Math.max(a,o);if(t[u_]={anchorOffset:a,focusOffset:o},t.selectionStart===c&&t.selectionEnd===l)return;const u=Object.assign(new Number(c),{[u_]:!0});try{t.setSelectionRange(u,l)}catch{}}function cI(t){var e,n,i;const r=(i=t[u_])!==null&&i!==void 0?i:{anchorOffset:(e=t.selectionStart)!==null&&e!==void 0?e:0,focusOffset:(n=t.selectionEnd)!==null&&n!==void 0?n:0};return{...r,startOffset:Math.min(r.anchorOffset,r.focusOffset),endOffset:Math.max(r.anchorOffset,r.focusOffset)}}function cmt(t){return!!t[u_]}function _L(t){t[u_]=void 0}const dB=globalThis.parseInt;function lmt(t){const e=t.replace(/\D/g,"");if(e.length<2)return t;const n=dB(e[0],10),i=dB(e[1],10);if(n>=3||n===2&&i>=4){let r;return n>=3?r=1:r=2,_se(e,r)}return t.length===2?t:_se(e,2)}function _se(t,e){const n=t.slice(0,e),i=Math.min(dB(n,10),23),r=t.slice(e),s=dB(r,10),a=Math.min(s,59);return`${i.toString().padStart(2,"0")}:${a.toString().padStart(2,"0")}`}function vbe(t,e){const n=t.cloneNode();return n.value=e,n.value===e}var _be=function(t){return t.email="email",t.password="password",t.search="search",t.telephone="telephone",t.text="text",t.url="url",t}(_be||{});function umt(t){var e;const n=(e=t.getAttribute("maxlength"))!==null&&e!==void 0?e:"";return/^\d+$/.test(n)&&Number(n)>=0?Number(n):void 0}function hmt(t){return vr(t,"textarea")||vr(t,"input")&&t.type in _be}function ybe(t,e,n,i){if(yL(t)&&e+n>=0&&e+n<=t.nodeValue.length)return{node:t,offset:e+n};const r=yse(t,e,n);if(r){if(yL(r))return{node:r,offset:n>0?Math.min(1,r.nodeValue.length):Math.max(r.nodeValue.length-1,0)};if(vr(r,"br")){const s=yse(r,void 0,n);return s?yL(s)?{node:s,offset:n>0?0:s.nodeValue.length}:n<0&&vr(s,"br")?{node:r.parentNode,offset:f2(r)}:{node:s.parentNode,offset:f2(s)+(n>0?0:1)}:n<0&&i==="deleteContentBackward"?{node:r.parentNode,offset:f2(r)}:void 0}else return{node:r.parentNode,offset:f2(r)+(n>0?1:0)}}}function yse(t,e,n){const i=Number(e)+(n<0?-1:0);return e!==void 0&&sX(t)&&i>=0&&i<t.children.length&&(t=t.children[i]),fmt(t,n===1?"next":"previous",dmt)}function dmt(t){if(yL(t))return!0;if(sX(t)){if(vr(t,["input","textarea"]))return t.type!=="hidden";if(vr(t,"br"))return!0}return!1}function f2(t){let e=0;for(;t.previousSibling;)e++,t=t.previousSibling;return e}function sX(t){return t.nodeType===1}function yL(t){return t.nodeType===3}function fmt(t,e,n){for(;;){var i;const r=t[`${e}Sibling`];if(r){if(t=pmt(r,e==="next"?"first":"last"),n(t))return t}else if(t.parentNode&&(!sX(t.parentNode)||!x1(t.parentNode)&&t.parentNode!==((i=t.ownerDocument)===null||i===void 0?void 0:i.body)))t=t.parentNode;else break}}function pmt(t,e){for(;t.hasChildNodes();)t=t[`${e}Child`];return t}const lI=Symbol("Track programmatic changes for React workaround");function mmt(t){return Object.getOwnPropertyNames(t).some(e=>e.startsWith("__react"))&&Dp(t).REACT_VERSION===17}function gmt(t){mmt(t)&&(t[lI]={previousValue:String(t.value),tracked:[]})}function vmt(t,e){var n,i;(i=t[lI])===null||i===void 0||(n=i.tracked)===null||n===void 0||n.push(e),t[lI]||(rX(t),bR(t,{focusOffset:e.length}))}function _mt(t,e){var n;const i=t[lI];if(t[lI]=void 0,!(!(i==null||(n=i.tracked)===null||n===void 0)&&n.length))return;const r=i.tracked.length===2&&i.tracked[0]===i.previousValue&&i.tracked[1]===t.value;r||rX(t),cmt(t)&&bR(t,{focusOffset:r?e:t.value.length})}function bbe(t){const e=ymt(t);if(e&&C0(e))return{type:"input",selection:cI(e)};const n=e==null?void 0:e.ownerDocument.getSelection();return{type:nI(t)&&(n==null?void 0:n.anchorNode)&&nI(n.anchorNode)?"contenteditable":"default",selection:n}}function ymt(t){return t.nodeType===1?t:t.parentElement}function bmt(t){const e=bbe(t);if(e.type==="input")return e.selection;if(e.type==="contenteditable"){var n;return(n=e.selection)===null||n===void 0?void 0:n.getRangeAt(0)}}function C1({focusNode:t,focusOffset:e,anchorNode:n=t,anchorOffset:i=e}){var r,s;if(bbe(t).type==="input")return bR(t,{anchorOffset:i,focusOffset:e});(s=n.ownerDocument)===null||s===void 0||(r=s.getSelection())===null||r===void 0||r.setBaseAndExtent(n,i,t,e)}function Ebe(t){return vr(t,"input")&&["date","time"].includes(t.type)}function IA(t,e,n,i="insertText"){const r=bmt(e);r&&(!Ebe(e)&&!t.dispatchUIEvent(e,"beforeinput",{inputType:i,data:n})||("startContainer"in r?Emt(t,e,r,n,i):Smt(t,e,r,n,i)))}function Emt(t,e,n,i,r){let s=!1;if(!n.collapsed)s=!0,n.deleteContents();else if(["deleteContentBackward","deleteContentForward"].includes(r)){const a=ybe(n.startContainer,n.startOffset,r==="deleteContentBackward"?-1:1,r);if(a){s=!0;const o=n.cloneRange();o.comparePoint(a.node,a.offset)<0?o.setStart(a.node,a.offset):o.setEnd(a.node,a.offset),o.deleteContents()}}if(i)if(n.endContainer.nodeType===3){const a=n.endOffset;n.endContainer.insertData(a,i),n.setStart(n.endContainer,a+i.length),n.setEnd(n.endContainer,a+i.length)}else{const a=e.ownerDocument.createTextNode(i);n.insertNode(a),n.setStart(a,i.length),n.setEnd(a,i.length)}(s||i)&&t.dispatchUIEvent(e,"input",{inputType:r})}function Smt(t,e,n,i,r){let s=i;if(hmt(e)){const l=umt(e);if(l!==void 0&&i.length>0){const u=l-e.value.length;if(u>0)s=i.substring(0,u);else return}}const{newValue:a,newOffset:o,oldValue:c}=Tmt(s,e,n,r);a===c&&o===n.startOffset&&o===n.endOffset||vr(e,"input",{type:"number"})&&!xmt(a)||(smt(e,a),C1({focusNode:e,anchorOffset:o,focusOffset:o}),Ebe(e)?vbe(e,a)&&(bse(t,e,o,{}),t.dispatchUIEvent(e,"change"),gbe(e)):bse(t,e,o,{data:i,inputType:r}))}function Tmt(t,e,{startOffset:n,endOffset:i},r){const s=A0(e),a=Math.max(0,n===i&&r==="deleteContentBackward"?n-1:n),o=s.substring(0,a),c=Math.min(s.length,n===i&&r==="deleteContentForward"?n+1:i),l=s.substring(c,s.length);let u=`${o}${t}${l}`,h=a+t.length;if(vr(e,"input",{type:"time"})){const d=lmt(u);d!==""&&vbe(e,d)&&(u=d,h=d.length)}return{oldValue:s,newValue:u,newOffset:h}}function bse(t,e,n,i){t.dispatchUIEvent(e,"input",i),_mt(e,n)}function xmt(t){var e,n;const i=t.split("e",2);return!(/[^\d.\-e]/.test(t)||Number((e=t.match(/-/g))===null||e===void 0?void 0:e.length)>2||Number((n=t.match(/\./g))===null||n===void 0?void 0:n.length)>1||i[1]&&!/^-?\d*$/.test(i[1]))}mE.cut=(t,e,n)=>()=>{RA(e)&&IA(n,e,"","deleteByCut")};function wmt(t){return t?x1(t)?t.textContent:A0(t):null}function Cmt(t){const e=Dp(t);for(let n=t;n!=null&&n.ownerDocument;n=n.parentElement){const{display:i,visibility:r}=e.getComputedStyle(n);if(i==="none"||r==="hidden")return!1}return!0}function Amt(t,e){const n=t.ownerDocument,i=n.querySelectorAll(P_e),r=Array.from(i).filter(c=>c===t||!(Number(c.getAttribute("tabindex"))<0||U_(c)));Number(t.getAttribute("tabindex"))>=0&&r.sort((c,l)=>{const u=Number(c.getAttribute("tabindex")),h=Number(l.getAttribute("tabindex"));return u===h?0:u===0?1:h===0?-1:u-h});const s={};let a=[n.body];const o=vr(t,"input",{type:"radio"})?t.name:void 0;r.forEach(c=>{const l=c;if(vr(l,"input",{type:"radio"})&&l.name){if(l===t){a.push(l);return}else if(l.name===o)return;if(l.checked){a=a.filter(u=>!vr(u,"input",{type:"radio",name:l.name})),a.push(l),s[l.name]=l;return}if(typeof s[l.name]<"u")return}a.push(l)});for(let c=a.findIndex(l=>l===t);;)if(c+=e?-1:1,c===a.length?c=0:c===-1&&(c=a.length-1),a[c]===t||a[c]===n.body||Cmt(a[c]))return a[c]}function Ese(t,e){if(C0(t)){const n=cI(t);C1({focusNode:t,focusOffset:n.startOffset===n.endOffset?n.focusOffset+e:e<0?n.startOffset:n.endOffset})}else{const n=t.ownerDocument.getSelection();if(!(n!=null&&n.focusNode))return;if(n.isCollapsed){const i=ybe(n.focusNode,n.focusOffset,e);i&&C1({focusNode:i.node,focusOffset:i.offset})}else n[e<0?"collapseToStart":"collapseToEnd"]()}}function Sbe(t){if(C0(t))return C1({focusNode:t,anchorOffset:0,focusOffset:A0(t).length});var e;const n=(e=nI(t))!==null&&e!==void 0?e:t.ownerDocument.body;C1({focusNode:n,anchorOffset:0,focusOffset:n.childNodes.length})}function Rmt(t){if(C0(t))return cI(t).startOffset===0&&cI(t).endOffset===A0(t).length;var e;const n=(e=nI(t))!==null&&e!==void 0?e:t.ownerDocument.body,i=t.ownerDocument.getSelection();return(i==null?void 0:i.anchorNode)===n&&i.focusNode===n&&i.anchorOffset===0&&i.focusOffset===n.childNodes.length}function $M(t,e,n){var i;if(C0(t))return C1({focusNode:t,anchorOffset:e,focusOffset:n});if(x1(t)&&((i=t.firstChild)===null||i===void 0?void 0:i.nodeType)===3)return C1({focusNode:t.firstChild,anchorOffset:e,focusOffset:n});throw new Error("Not implemented. The result of this interaction is unreliable.")}function p2(t,e,n){const i=Dp(e),r=Array.from(e.ownerDocument.querySelectorAll(e.name?`input[type="radio"][name="${i.CSS.escape(e.name)}"]`:'input[type="radio"][name=""], input[type="radio"]:not([name])'));for(let s=r.findIndex(a=>a===e)+n;;s+=n){if(r[s]||(s=n>0?0:r.length-1),r[s]===e)return;if(!U_(r[s])){pE(r[s]),t.dispatchUIEvent(r[s],"click");return}}}mE.keydown=(t,e,n)=>{var i,r;return(r=(i=Sse[t.key])===null||i===void 0?void 0:i.call(Sse,t,e,n))!==null&&r!==void 0?r:Mmt(t,e,n)};const Sse={ArrowDown:(t,e,n)=>{if(vr(e,"input",{type:"radio"}))return()=>p2(n,e,1)},ArrowLeft:(t,e,n)=>vr(e,"input",{type:"radio"})?()=>p2(n,e,-1):()=>Ese(e,-1),ArrowRight:(t,e,n)=>vr(e,"input",{type:"radio"})?()=>p2(n,e,1):()=>Ese(e,1),ArrowUp:(t,e,n)=>{if(vr(e,"input",{type:"radio"}))return()=>p2(n,e,-1)},Backspace:(t,e,n)=>{if(RA(e))return()=>{IA(n,e,"","deleteContentBackward")}},Delete:(t,e,n)=>{if(RA(e))return()=>{IA(n,e,"","deleteContentForward")}},End:(t,e)=>{if(vr(e,["input","textarea"])||x1(e))return()=>{var n,i;const r=(i=(n=wmt(e))===null||n===void 0?void 0:n.length)!==null&&i!==void 0?i:0;$M(e,r,r)}},Home:(t,e)=>{if(vr(e,["input","textarea"])||x1(e))return()=>{$M(e,0,0)}},PageDown:(t,e)=>{if(vr(e,["input"]))return()=>{const n=A0(e).length;$M(e,n,n)}},PageUp:(t,e)=>{if(vr(e,["input"]))return()=>{$M(e,0,0)}},Tab:(t,e,n)=>()=>{const i=Amt(e,n.system.keyboard.modifiers.Shift);pE(i),C0(i)&&bR(i,{anchorOffset:0,focusOffset:i.value.length})}},Mmt=(t,e,n)=>{if(t.code==="KeyA"&&n.system.keyboard.modifiers.Control)return()=>Sbe(e)};mE.keypress=(t,e,n)=>{if(t.key==="Enter"){if(vr(e,"button")||vr(e,"input")&&Omt.includes(e.type)||vr(e,"a")&&e.href)return()=>{n.dispatchUIEvent(e,"click")};if(vr(e,"input")){const i=e.form,r=i==null?void 0:i.querySelector('input[type="submit"], button:not([type]), button[type="submit"]');return r?()=>n.dispatchUIEvent(r,"click"):i&&Nmt.includes(e.type)&&i.querySelectorAll("input").length===1?()=>n.dispatchUIEvent(i,"submit"):void 0}}if(RA(e)){const i=t.key==="Enter"?x1(e)&&!n.system.keyboard.modifiers.Shift?"insertParagraph":"insertLineBreak":"insertText",r=t.key==="Enter"?`
`:t.key;return()=>IA(n,e,r,i)}};const Omt=["button","color","file","image","reset","submit"],Nmt=["email","month","password","search","tel","text","url","week"];mE.keyup=(t,e,n)=>{var i;return(i=Tse[t.key])===null||i===void 0?void 0:i.call(Tse,t,e,n)};const Tse={" ":(t,e,n)=>{if(L_e(e))return()=>n.dispatchUIEvent(e,"click")}};mE.paste=(t,e,n)=>{if(RA(e))return()=>{var i;const r=(i=t.clipboardData)===null||i===void 0?void 0:i.getData("text");r&&IA(n,e,r,"insertFromPaste")}};const Tbe={auxclick:{EventType:"PointerEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},beforeinput:{EventType:"InputEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},blur:{EventType:"FocusEvent",defaultInit:{bubbles:!1,cancelable:!1,composed:!0}},click:{EventType:"PointerEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},contextmenu:{EventType:"PointerEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},copy:{EventType:"ClipboardEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},change:{EventType:"Event",defaultInit:{bubbles:!0,cancelable:!1}},cut:{EventType:"ClipboardEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},dblclick:{EventType:"MouseEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},focus:{EventType:"FocusEvent",defaultInit:{bubbles:!1,cancelable:!1,composed:!0}},focusin:{EventType:"FocusEvent",defaultInit:{bubbles:!0,cancelable:!1,composed:!0}},focusout:{EventType:"FocusEvent",defaultInit:{bubbles:!0,cancelable:!1,composed:!0}},keydown:{EventType:"KeyboardEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},keypress:{EventType:"KeyboardEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},keyup:{EventType:"KeyboardEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},paste:{EventType:"ClipboardEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},input:{EventType:"InputEvent",defaultInit:{bubbles:!0,cancelable:!1,composed:!0}},mousedown:{EventType:"MouseEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},mouseenter:{EventType:"MouseEvent",defaultInit:{bubbles:!1,cancelable:!1,composed:!0}},mouseleave:{EventType:"MouseEvent",defaultInit:{bubbles:!1,cancelable:!1,composed:!0}},mousemove:{EventType:"MouseEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},mouseout:{EventType:"MouseEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},mouseover:{EventType:"MouseEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},mouseup:{EventType:"MouseEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},pointerover:{EventType:"PointerEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},pointerenter:{EventType:"PointerEvent",defaultInit:{bubbles:!1,cancelable:!1}},pointerdown:{EventType:"PointerEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},pointermove:{EventType:"PointerEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},pointerup:{EventType:"PointerEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},pointercancel:{EventType:"PointerEvent",defaultInit:{bubbles:!0,cancelable:!1,composed:!0}},pointerout:{EventType:"PointerEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},pointerleave:{EventType:"PointerEvent",defaultInit:{bubbles:!1,cancelable:!1}},submit:{EventType:"Event",defaultInit:{bubbles:!0,cancelable:!0}}};function xbe(t){return Tbe[t].EventType}const Imt=["MouseEvent","PointerEvent"];function kmt(t){return Imt.includes(xbe(t))}function Pmt(t){return xbe(t)==="KeyboardEvent"}const Dmt={ClipboardEvent:[Umt],Event:[],FocusEvent:[bM,Bmt],InputEvent:[bM,Fmt],MouseEvent:[bM,QH,xse],PointerEvent:[bM,QH,xse,jmt],KeyboardEvent:[bM,QH,zmt]};function wbe(t,e,n){const i=Dp(e),{EventType:r,defaultInit:s}=Tbe[t],a=new(Lmt(i))[r](t,s);return Dmt[r].forEach(o=>o(a,n??{})),a}function Lmt(t){var e;const n=(e=t.Event)!==null&&e!==void 0?e:class{};var i;const r=(i=t.AnimationEvent)!==null&&i!==void 0?i:class extends n{};var s;const a=(s=t.ClipboardEvent)!==null&&s!==void 0?s:class extends n{};var o;const c=(o=t.PopStateEvent)!==null&&o!==void 0?o:class extends n{};var l;const u=(l=t.ProgressEvent)!==null&&l!==void 0?l:class extends n{};var h;const d=(h=t.TransitionEvent)!==null&&h!==void 0?h:class extends n{};var f;const p=(f=t.UIEvent)!==null&&f!==void 0?f:class extends n{};var g;const _=(g=t.CompositionEvent)!==null&&g!==void 0?g:class extends p{};var v;const b=(v=t.FocusEvent)!==null&&v!==void 0?v:class extends p{};var S;const x=(S=t.InputEvent)!==null&&S!==void 0?S:class extends p{};var M;const R=(M=t.KeyboardEvent)!==null&&M!==void 0?M:class extends p{};var I;const k=(I=t.MouseEvent)!==null&&I!==void 0?I:class extends p{};var P;const U=(P=t.DragEvent)!==null&&P!==void 0?P:class extends k{};var V;const $=(V=t.PointerEvent)!==null&&V!==void 0?V:class extends k{};var q;const Y=(q=t.TouchEvent)!==null&&q!==void 0?q:class extends p{};return{Event:n,AnimationEvent:r,ClipboardEvent:a,PopStateEvent:c,ProgressEvent:u,TransitionEvent:d,UIEvent:p,CompositionEvent:_,FocusEvent:b,InputEvent:x,KeyboardEvent:R,MouseEvent:k,DragEvent:U,PointerEvent:$,TouchEvent:Y}}function jE(t,e){for(const[n,i]of Object.entries(e))Object.defineProperty(t,n,{get:()=>i??null})}function xo(t){return Number(t??0)}function Umt(t,{clipboardData:e}){jE(t,{clipboardData:e})}function Bmt(t,{relatedTarget:e}){jE(t,{relatedTarget:e})}function Fmt(t,{data:e,inputType:n,isComposing:i}){jE(t,{data:e,isComposing:!!i,inputType:String(n)})}function bM(t,{view:e,detail:n}){jE(t,{view:e,detail:xo(n??0)})}function QH(t,{altKey:e,ctrlKey:n,metaKey:i,shiftKey:r,modifierAltGraph:s,modifierCapsLock:a,modifierFn:o,modifierFnLock:c,modifierNumLock:l,modifierScrollLock:u,modifierSymbol:h,modifierSymbolLock:d}){jE(t,{altKey:!!e,ctrlKey:!!n,metaKey:!!i,shiftKey:!!r,getModifierState(f){return!!{Alt:e,AltGraph:s,CapsLock:a,Control:n,Fn:o,FnLock:c,Meta:i,NumLock:l,ScrollLock:u,Shift:r,Symbol:h,SymbolLock:d}[f]}})}function zmt(t,{key:e,code:n,location:i,repeat:r,isComposing:s,charCode:a}){jE(t,{key:String(e),code:String(n),location:xo(i),repeat:!!r,isComposing:!!s,charCode:a})}function xse(t,{x:e,y:n,screenX:i,screenY:r,clientX:s=e,clientY:a=n,button:o,buttons:c,relatedTarget:l,offsetX:u,offsetY:h,pageX:d,pageY:f}){jE(t,{screenX:xo(i),screenY:xo(r),clientX:xo(s),x:xo(s),clientY:xo(a),y:xo(a),button:xo(o),buttons:xo(c),relatedTarget:l,offsetX:xo(u),offsetY:xo(h),pageX:xo(d),pageY:xo(f)})}function jmt(t,{pointerId:e,width:n,height:i,pressure:r,tangentialPressure:s,tiltX:a,tiltY:o,twist:c,pointerType:l,isPrimary:u}){jE(t,{pointerId:xo(e),width:xo(n??1),height:xo(i??1),pressure:xo(r),tangentialPressure:xo(s),tiltX:xo(a),tiltY:xo(o),twist:xo(c),pointerType:String(l),isPrimary:!!u})}function Hmt(t,e,n,i=!1){(kmt(e)||Pmt(e))&&(n={...n,...this.system.getUIEventModifiers()});const r=wbe(e,t,n);return Cbe.call(this,t,r,i)}function Cbe(t,e,n=!1){var i;const r=e.type,s=n?()=>{}:(i=mE[r])===null||i===void 0?void 0:i.call(mE,e,t,this);if(s){e.preventDefault();let a=!1;return Object.defineProperty(e,"defaultPrevented",{get:()=>a}),Object.defineProperty(e,"preventDefault",{value:()=>{a=e.cancelable}}),OA(()=>t.dispatchEvent(e)),a||s(),!a}return OA(()=>t.dispatchEvent(e))}function lT(t,e,n){const i=wbe(e,t,n);OA(()=>t.dispatchEvent(i))}const wse=Symbol("patched focus/blur methods");function Abe(t){if(t.prototype[wse])return;const{focus:e,blur:n}=t.prototype;Object.defineProperties(t.prototype,{focus:{configurable:!0,get:()=>r},blur:{configurable:!0,get:()=>s},[wse]:{configurable:!0,get:()=>({focus:e,blur:n})}});let i;function r(a){if(this.ownerDocument.visibilityState!=="hidden")return e.call(this,a);const o=Cse(this.ownerDocument);if(o===this)return;const c=Symbol("focus call");i=c,o&&(n.call(o),lT(o,"blur",{relatedTarget:this}),lT(o,"focusout",{relatedTarget:i===c?this:null})),i===c&&(e.call(this,a),lT(this,"focus",{relatedTarget:o})),i===c&&lT(this,"focusin",{relatedTarget:o})}function s(){if(this.ownerDocument.visibilityState!=="hidden")return n.call(this);const a=Cse(this.ownerDocument);if(a!==this)return;i=Symbol("blur call"),n.call(this),lT(a,"blur",{relatedTarget:null}),lT(a,"focusout",{relatedTarget:null})}}function Cse(t){const e=Pk(t);return(e==null?void 0:e.tagName)==="BODY"?null:e}const eV=Symbol("Interceptor for programmatical calls");function iC(t,e,n){const i=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),r=Object.getOwnPropertyDescriptor(t,e),s=i!=null&&i.set?"set":"value";if(typeof(i==null?void 0:i[s])!="function"||i[s][eV])throw new Error(`Element ${t.tagName} does not implement "${String(e)}".`);function a(...o){const{applyNative:c=!1,realArgs:l,then:u}=n.call(this,...o),h=(!c&&r||i)[s];s==="set"?h.call(this,l):h.call(this,...l),u==null||u()}a[eV]=eV,Object.defineProperty(t,e,{...r??i,[s]:a})}function Vmt(t){iC(t,"value",function(n){const i=imt(n);return i&&gmt(this),{applyNative:!!i,realArgs:Gmt(this,n),then:i?void 0:()=>vmt(this,String(n))}})}function Gmt(t,e){return vr(t,"input",{type:"number"})&&String(e)!==""&&!Number.isNaN(Number(e))?String(Number(e)):String(e)}function qmt(t){iC(t,"setSelectionRange",function(n,...i){const r=rmt(n);return{applyNative:!!r,realArgs:[Number(n),...i],then:()=>r?void 0:_L(t)}}),iC(t,"selectionStart",function(n){return{realArgs:n,then:()=>_L(t)}}),iC(t,"selectionEnd",function(n){return{realArgs:n,then:()=>_L(t)}}),iC(t,"select",function(){return{realArgs:[],then:()=>omt(t,{anchorOffset:0,focusOffset:A0(t).length})}})}function $mt(t){iC(t,"setRangeText",function(...n){return{realArgs:n,then:()=>{rX(t),_L(t)}}})}const RC=Symbol("Node prepared with document state workarounds");function Rbe(t){t[RC]||(t.addEventListener("focus",e=>{const n=e.target;Ase(n)},{capture:!0,passive:!0}),t.activeElement&&Ase(t.activeElement),t.addEventListener("blur",e=>{const n=e.target,i=amt(n);i!==void 0&&(n.value!==i&&lT(n,"change"),gbe(n))},{capture:!0,passive:!0}),t[RC]=RC)}function Ase(t){t[RC]||(vr(t,["input","textarea"])&&(Vmt(t),qmt(t),$mt(t)),t[RC]=RC)}function Wmt(t){return Ymt(t)?t:t.ownerDocument}function Ymt(t){return t.nodeType===9}var Zd=function(t){return t[t.Trigger=2]="Trigger",t[t.Call=1]="Call",t}({});function WM(t,e){t.levelRefs[e]={}}function m2(t,e){return t.levelRefs[e]}function kA(t){const e=t.delay;if(typeof e=="number")return Promise.all([new Promise(n=>globalThis.setTimeout(()=>n(),e)),t.advanceTimers(e)])}var bL=function(t){return t[t.EachTrigger=4]="EachTrigger",t[t.EachApiCall=2]="EachApiCall",t[t.EachTarget=1]="EachTarget",t[t.Never=0]="Never",t}({});function WS(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var xg=function(t){return t[t.STANDARD=0]="STANDARD",t[t.LEFT=1]="LEFT",t[t.RIGHT=2]="RIGHT",t[t.NUMPAD=3]="NUMPAD",t}({});const Kmt=["Alt","AltGraph","Control","Fn","Meta","Shift","Symbol"];function Rse(t){return Kmt.includes(t)}const Xmt=["CapsLock","FnLock","NumLock","ScrollLock","SymbolLock"];function Mse(t){return Xmt.includes(t)}class Zmt{isKeyPressed(e){return this.pressed.has(String(e.code))}getPressedKeys(){return this.pressed.values().map(e=>e.keyDef)}async keydown(e,n){const i=String(n.key),r=String(n.code),s=kH(e.config.document);this.setKeydownTarget(s),this.pressed.add(r,n),Rse(i)&&(this.modifiers[i]=!0);const a=e.dispatchUIEvent(s,"keydown",{key:i,code:r});Mse(i)&&!this.modifiers[i]&&(this.modifiers[i]=!0,this.modifierLockStart[i]=!0),a&&this.pressed.setUnprevented(r),a&&this.hasKeyPress(i)&&e.dispatchUIEvent(kH(e.config.document),"keypress",{key:i,code:r,charCode:n.key==="Enter"?13:String(n.key).charCodeAt(0)})}async keyup(e,n){const i=String(n.key),r=String(n.code),s=this.pressed.isUnprevented(r);this.pressed.delete(r),Rse(i)&&!this.pressed.values().find(a=>a.keyDef.key===i)&&(this.modifiers[i]=!1),e.dispatchUIEvent(kH(e.config.document),"keyup",{key:i,code:r},!s),Mse(i)&&this.modifiers[i]&&(this.modifierLockStart[i]?this.modifierLockStart[i]=!1:this.modifiers[i]=!1)}setKeydownTarget(e){e!==this.lastKeydownTarget&&(this.carryChar=""),this.lastKeydownTarget=e}hasKeyPress(e){return(e.length===1||e==="Enter")&&!this.modifiers.Control&&!this.modifiers.Alt}constructor(e){WS(this,"system",void 0),WS(this,"modifiers",{Alt:!1,AltGraph:!1,CapsLock:!1,Control:!1,Fn:!1,FnLock:!1,Meta:!1,NumLock:!1,ScrollLock:!1,Shift:!1,Symbol:!1,SymbolLock:!1}),WS(this,"pressed",new class{add(n,i){var r,s,a;(a=(r=this.registry)[s=n])!==null&&a!==void 0||(r[s]={keyDef:i,unpreventedDefault:!1})}has(n){return!!this.registry[n]}setUnprevented(n){const i=this.registry[n];i&&(i.unpreventedDefault=!0)}isUnprevented(n){var i;return!!(!((i=this.registry[n])===null||i===void 0)&&i.unpreventedDefault)}delete(n){delete this.registry[n]}values(){return Object.values(this.registry)}constructor(){WS(this,"registry",{})}}),WS(this,"carryChar",""),WS(this,"lastKeydownTarget",void 0),WS(this,"modifierLockStart",{}),this.system=e}}const Jmt=[..."0123456789".split("").map(t=>({code:`Digit${t}`,key:t})),...")!@#$%^&*(".split("").map((t,e)=>({code:`Digit${e}`,key:t,shiftKey:!0})),..."abcdefghijklmnopqrstuvwxyz".split("").map(t=>({code:`Key${t.toUpperCase()}`,key:t})),..."ABCDEFGHIJKLMNOPQRSTUVWXYZ".split("").map(t=>({code:`Key${t}`,key:t,shiftKey:!0})),{code:"BracketLeft",key:"["},{code:"BracketLeft",key:"{",shiftKey:!0},{code:"BracketRight",key:"]"},{code:"BracketRight",key:"}",shiftKey:!0},{code:"Space",key:" "},{code:"AltLeft",key:"Alt",location:xg.LEFT},{code:"AltRight",key:"Alt",location:xg.RIGHT},{code:"ShiftLeft",key:"Shift",location:xg.LEFT},{code:"ShiftRight",key:"Shift",location:xg.RIGHT},{code:"ControlLeft",key:"Control",location:xg.LEFT},{code:"ControlRight",key:"Control",location:xg.RIGHT},{code:"MetaLeft",key:"Meta",location:xg.LEFT},{code:"MetaRight",key:"Meta",location:xg.RIGHT},{code:"OSLeft",key:"OS",location:xg.LEFT},{code:"OSRight",key:"OS",location:xg.RIGHT},{code:"ContextMenu",key:"ContextMenu"},{code:"Tab",key:"Tab"},{code:"CapsLock",key:"CapsLock"},{code:"Backspace",key:"Backspace"},{code:"Enter",key:"Enter"},{code:"Escape",key:"Escape"},{code:"ArrowUp",key:"ArrowUp"},{code:"ArrowDown",key:"ArrowDown"},{code:"ArrowLeft",key:"ArrowLeft"},{code:"ArrowRight",key:"ArrowRight"},{code:"Home",key:"Home"},{code:"End",key:"End"},{code:"Delete",key:"Delete"},{code:"PageUp",key:"PageUp"},{code:"PageDown",key:"PageDown"},{code:"Fn",key:"Fn"},{code:"Symbol",key:"Symbol"},{code:"AltRight",key:"AltGraph"}],Qmt=[{name:"MouseLeft",pointerType:"mouse",button:"primary"},{name:"MouseRight",pointerType:"mouse",button:"secondary"},{name:"MouseMiddle",pointerType:"mouse",button:"auxiliary"},{name:"TouchA",pointerType:"touch"},{name:"TouchB",pointerType:"touch"},{name:"TouchC",pointerType:"touch"}];function egt(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}class Mbe{getButtons(){let e=0;for(const n of Object.keys(this.pressed))e|=2**Number(n);return e}down(e){const n=L$(e.button);if(n in this.pressed){this.pressed[n].push(e);return}return this.pressed[n]=[e],n}up(e){const n=L$(e.button);if(n in this.pressed&&(this.pressed[n]=this.pressed[n].filter(i=>i.name!==e.name),this.pressed[n].length===0))return delete this.pressed[n],n}constructor(){egt(this,"pressed",{})}}const Ose={primary:0,secondary:1,auxiliary:2,back:3,X1:3,forward:4,X2:4};function L$(t=0){return t in Ose?Ose[t]:Number(t)}const Nse={1:2,2:1};function U$(t){return t=L$(t),t in Nse?Nse[t]:t}function tgt(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}class ngt{get countPressed(){return this.pressedKeys.size}isPressed(e){return this.pressedKeys.has(e.name)}addPressed(e){return this.pressedKeys.add(e.name)}removePressed(e){return this.pressedKeys.delete(e.name)}constructor(){tgt(this,"pressedKeys",new Set)}}function NO(t,e){const n=[];for(let s=t;s;s=s.parentElement)n.push(s);const i=[];for(let s=e;s;s=s.parentElement)i.push(s);let r=0;for(;!(r>=n.length||r>=i.length||n[n.length-1-r]!==i[i.length-1-r]);r++);return[n.slice(0,n.length-r),i.slice(0,i.length-r),i.slice(i.length-r)]}function B$({target:t,node:e,offset:n}){return C0(t)?{node:t,offset:n??A0(t).length}:e?{node:e,offset:n??(e.nodeType===3?e.nodeValue.length:e.childNodes.length)}:Obe(t,n)}function Obe(t,e,n=!0){let i=e===void 0?t.childNodes.length-1:0;const r=e===void 0?-1:1;for(;e===void 0?i>=(n?Math.max(t.childNodes.length-1,0):0):i<=t.childNodes.length;){if(e&&i===t.childNodes.length)throw new Error("The given offset is out of bounds.");const s=t.childNodes.item(i),a=String(s.textContent);if(a.length)if(e!==void 0&&a.length<e)e-=a.length;else{if(s.nodeType===1)return Obe(s,e,!1);if(s.nodeType===3)return{node:s,offset:e??s.nodeValue.length}}i+=r}return{node:t,offset:t.childNodes.length}}function igt({document:t,target:e,clickCount:n,node:i,offset:r}){if(Ott(e))return;const s=C0(e),a=String(s?A0(e):e.textContent),[o,c]=i?[r,r]:rgt(a,r,n);if(s)return bR(e,{anchorOffset:o??a.length,focusOffset:c??a.length}),{node:e,start:o??0,end:c??a.length};{const{node:l,offset:u}=B$({target:e,node:i,offset:o}),{node:h,offset:d}=B$({target:e,node:i,offset:c}),f=e.ownerDocument.createRange();try{f.setStart(l,u),f.setEnd(h,d)}catch{throw new Error("The given offset is out of bounds.")}const p=t.getSelection();return p==null||p.removeAllRanges(),p==null||p.addRange(f.cloneRange()),f}}function rgt(t,e,n){if(n%3===1||t.length===0)return[e,e];const i=e??t.length;return n%3===2?[i-t.substr(0,e).match(/(\w+|\s+|\W)?$/)[0].length,e===void 0?e:e+t.substr(e).match(/^(\w+|\s+|\W)?/)[0].length]:[i-t.substr(0,e).match(/[^\r\n]*$/)[0].length,e===void 0?e:e+t.substr(e).match(/^[^\r\n]*/)[0].length]}function sgt(t,{document:e,target:n,node:i,offset:r}){const s=B$({target:n,node:i,offset:r});if("node"in t){if(s.node===t.node){const a=s.offset<t.start?t.end:t.start,o=s.offset>t.end||s.offset<t.start?s.offset:t.end;bR(t.node,{anchorOffset:a,focusOffset:o})}}else{const a=t.cloneRange(),o=a.comparePoint(s.node,s.offset);o<0?a.setStart(s.node,s.offset):o>0&&a.setEnd(s.node,s.offset);const c=e.getSelection();c==null||c.removeAllRanges(),c==null||c.addRange(a.cloneRange())}}function Nbe(t,e){var n,i,r,s,a,o,c,l,u,h,d,f,p,g,_,v,b,S,x,M,R,I,k,P;return t.target!==e.target||((n=t.coords)===null||n===void 0?void 0:n.x)!==((i=e.coords)===null||i===void 0?void 0:i.x)||((r=t.coords)===null||r===void 0?void 0:r.y)!==((s=e.coords)===null||s===void 0?void 0:s.y)||((a=t.coords)===null||a===void 0?void 0:a.clientX)!==((o=e.coords)===null||o===void 0?void 0:o.clientX)||((c=t.coords)===null||c===void 0?void 0:c.clientY)!==((l=e.coords)===null||l===void 0?void 0:l.clientY)||((u=t.coords)===null||u===void 0?void 0:u.offsetX)!==((h=e.coords)===null||h===void 0?void 0:h.offsetX)||((d=t.coords)===null||d===void 0?void 0:d.offsetY)!==((f=e.coords)===null||f===void 0?void 0:f.offsetY)||((p=t.coords)===null||p===void 0?void 0:p.pageX)!==((g=e.coords)===null||g===void 0?void 0:g.pageX)||((_=t.coords)===null||_===void 0?void 0:_.pageY)!==((v=e.coords)===null||v===void 0?void 0:v.pageY)||((b=t.coords)===null||b===void 0?void 0:b.screenX)!==((S=e.coords)===null||S===void 0?void 0:S.screenX)||((x=t.coords)===null||x===void 0?void 0:x.screenY)!==((M=e.coords)===null||M===void 0?void 0:M.screenY)||((R=t.caret)===null||R===void 0?void 0:R.node)!==((I=e.caret)===null||I===void 0?void 0:I.node)||((k=t.caret)===null||k===void 0?void 0:k.offset)!==((P=e.caret)===null||P===void 0?void 0:P.offset)}function YS(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}class agt{move(e,n,i){const r=this.position,s=this.getTarget(e);if(this.position=n,!Nbe(r,n))return;const a=this.getTarget(e),o=this.getEventInit("mousemove"),[c,l]=NO(s,a);return{leave:()=>{s!==a&&(e.dispatchUIEvent(s,"mouseout",o),c.forEach(u=>e.dispatchUIEvent(u,"mouseleave",o)))},enter:()=>{s!==a&&(e.dispatchUIEvent(a,"mouseover",o),l.forEach(u=>e.dispatchUIEvent(u,"mouseenter",o)))},move:()=>{i||(e.dispatchUIEvent(a,"mousemove",o),this.modifySelecting(e))}}}down(e,n,i){const r=this.buttons.down(n);if(r===void 0)return;const s=this.getTarget(e);this.buttonDownTarget[r]=s;const a=this.getEventInit("mousedown",n.button),o=U_(s);!i&&(o||e.dispatchUIEvent(s,"mousedown",a))&&(this.startSelecting(e,a.detail),pE(s)),!o&&U$(n.button)===2&&e.dispatchUIEvent(s,"contextmenu",this.getEventInit("contextmenu",n.button))}up(e,n,i){const r=this.buttons.up(n);if(r===void 0)return;const s=this.getTarget(e);if(!U_(s)){if(!i){const o=this.getEventInit("mouseup",n.button);e.dispatchUIEvent(s,"mouseup",o),this.endSelecting()}const a=NO(this.buttonDownTarget[r],s)[2][0];if(a){const o=this.getEventInit("click",n.button);o.detail&&(e.dispatchUIEvent(a,o.button===0?"click":"auxclick",o),o.button===0&&o.detail===2&&e.dispatchUIEvent(a,"dblclick",{...this.getEventInit("dblclick",n.button),detail:o.detail}))}}}resetClickCount(){this.clickCount.reset()}getEventInit(e,n){const i={...this.position.coords};return i.button=U$(n),i.buttons=this.buttons.getButtons(),e==="mousedown"?i.detail=this.clickCount.getOnDown(i.button):e==="mouseup"?i.detail=this.clickCount.getOnUp(i.button):(e==="click"||e==="auxclick")&&(i.detail=this.clickCount.incOnClick(i.button)),i}getTarget(e){var n;return(n=this.position.target)!==null&&n!==void 0?n:e.config.document.body}startSelecting(e,n){var i,r;this.selecting=igt({document:e.config.document,target:this.getTarget(e),node:(i=this.position.caret)===null||i===void 0?void 0:i.node,offset:(r=this.position.caret)===null||r===void 0?void 0:r.offset,clickCount:n})}modifySelecting(e){var n,i;this.selecting&&sgt(this.selecting,{document:e.config.document,target:this.getTarget(e),node:(n=this.position.caret)===null||n===void 0?void 0:n.node,offset:(i=this.position.caret)===null||i===void 0?void 0:i.offset})}endSelecting(){this.selecting=void 0}constructor(){YS(this,"position",{}),YS(this,"buttons",new Mbe),YS(this,"selecting",void 0),YS(this,"buttonDownTarget",{}),YS(this,"clickCount",new class{incOnClick(e){const n=this.down[e]===void 0?void 0:Number(this.down[e])+1;return this.count=this.count[e]===void 0?{}:{[e]:Number(this.count[e])+1},n}getOnDown(e){var n;this.down={[e]:(n=this.count[e])!==null&&n!==void 0?n:0};var i;return this.count={[e]:(i=this.count[e])!==null&&i!==void 0?i:0},Number(this.count[e])+1}getOnUp(e){return this.down[e]===void 0?void 0:Number(this.down[e])+1}reset(){this.count={}}constructor(){YS(this,"down",{}),YS(this,"count",{})}})}}function fB(t,e){var n;return((n=Ibe(t,e))===null||n===void 0?void 0:n.pointerEvents)!=="none"}function ogt(t){const e=Dp(t);for(let n=t,i=[];n!=null&&n.ownerDocument;n=n.parentElement){i.push(n);const r=e.getComputedStyle(n).pointerEvents;if(r&&!["inherit","unset"].includes(r))return{pointerEvents:r,tree:i}}}const Ise=Symbol("Last check for pointer-events");function Ibe(t,e){const n=e[Ise];if(!(t.config.pointerEventsCheck!==bL.Never&&(!n||kse(t.config.pointerEventsCheck,bL.EachApiCall)&&n[Zd.Call]!==m2(t,Zd.Call)||kse(t.config.pointerEventsCheck,bL.EachTrigger)&&n[Zd.Trigger]!==m2(t,Zd.Trigger))))return n==null?void 0:n.result;const r=ogt(e);return e[Ise]={[Zd.Call]:m2(t,Zd.Call),[Zd.Trigger]:m2(t,Zd.Trigger),result:r},r}function YM(t,e){const n=Ibe(t,e);if((n==null?void 0:n.pointerEvents)==="none")throw new Error([`Unable to perform pointer interaction as the element ${n.tree.length>1?"inherits":"has"} \`pointer-events: none\`:`,"",cgt(n.tree)].join(`
`))}function cgt(t){return t.reverse().map((e,n)=>["".padEnd(n),e.tagName,e.id&&`#${e.id}`,e.hasAttribute("data-testid")&&`(testId=${e.getAttribute("data-testid")})`,lgt(e),t.length>1&&n===0&&"  <-- This element declared `pointer-events: none`",t.length>1&&n===t.length-1&&"  <-- Asserted pointer events here"].filter(Boolean).join("")).join(`
`)}function lgt(t){var e;let n;if(t.hasAttribute("aria-label"))n=t.getAttribute("aria-label");else if(t.hasAttribute("aria-labelledby")){var i,r;n=(r=t.ownerDocument.getElementById(t.getAttribute("aria-labelledby")))===null||r===void 0||(i=r.textContent)===null||i===void 0?void 0:i.trim()}else if(vr(t,["button","input","meter","output","progress","select","textarea"])&&(!((e=t.labels)===null||e===void 0)&&e.length))n=Array.from(t.labels).map(a=>{var o;return(o=a.textContent)===null||o===void 0?void 0:o.trim()}).join("|");else if(vr(t,"button")){var s;n=(s=t.textContent)===null||s===void 0?void 0:s.trim()}return n=n==null?void 0:n.replace(/\n/g,"  "),Number(n==null?void 0:n.length)>30&&(n=`${n==null?void 0:n.substring(0,29)}`),n?`(label=${n})`:""}function kse(t,e){return(t&e)>0}function Uv(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}class ugt{init(e){const n=this.getTarget(e),[,i]=NO(null,n),r=this.getEventInit();return YM(e,n),e.dispatchUIEvent(n,"pointerover",r),i.forEach(s=>e.dispatchUIEvent(s,"pointerenter",r)),this}move(e,n){const i=this.position,r=this.getTarget(e);if(this.position=n,!Nbe(i,n))return;const s=this.getTarget(e),a=this.getEventInit(-1),[o,c]=NO(r,s);return{leave:()=>{fB(e,r)&&r!==s&&(e.dispatchUIEvent(r,"pointerout",a),o.forEach(l=>e.dispatchUIEvent(l,"pointerleave",a)))},enter:()=>{YM(e,s),r!==s&&(e.dispatchUIEvent(s,"pointerover",a),c.forEach(l=>e.dispatchUIEvent(l,"pointerenter",a)))},move:()=>{e.dispatchUIEvent(s,"pointermove",a)}}}down(e,n=0){if(this.isDown)return;const i=this.getTarget(e);YM(e,i),this.isDown=!0,this.isPrevented=!e.dispatchUIEvent(i,"pointerdown",this.getEventInit(n))}up(e,n=0){if(!this.isDown)return;const i=this.getTarget(e);YM(e,i),this.isPrevented=!1,this.isDown=!1,e.dispatchUIEvent(i,"pointerup",this.getEventInit(n))}release(e){const n=this.getTarget(e),[i]=NO(n,null),r=this.getEventInit();fB(e,n)&&(e.dispatchUIEvent(n,"pointerout",r),i.forEach(s=>e.dispatchUIEvent(s,"pointerleave",r))),this.isCancelled=!0}getTarget(e){var n;return(n=this.position.target)!==null&&n!==void 0?n:e.config.document.body}getEventInit(e){return{...this.position.coords,pointerId:this.pointerId,pointerType:this.pointerType,isPrimary:this.isPrimary,button:U$(e),buttons:this.buttons.getButtons()}}constructor({pointerId:e,pointerType:n,isPrimary:i},r){Uv(this,"pointerId",void 0),Uv(this,"pointerType",void 0),Uv(this,"isPrimary",void 0),Uv(this,"buttons",void 0),Uv(this,"isMultitouch",!1),Uv(this,"isCancelled",!1),Uv(this,"isDown",!1),Uv(this,"isPrevented",!1),Uv(this,"position",{}),this.pointerId=e,this.pointerType=n,this.isPrimary=i,this.isMultitouch=!i,this.buttons=r}}function Hy(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}class hgt{isKeyPressed(e){return this.devices.get(e.pointerType).isPressed(e)}async press(e,n,i){this.devices.get(n.pointerType).addPressed(n),this.buttons.down(n);const r=this.getPointerName(n),s=n.pointerType==="touch"?this.pointers.new(r,n.pointerType,this.buttons):this.pointers.get(r);s.position=i,s.pointerType!=="touch"&&(this.mouse.position=i),s.pointerType==="touch"&&s.init(e),s.down(e,n.button),s.pointerType!=="touch"&&this.mouse.down(e,n,s.isPrevented)}async move(e,n,i){const r=this.pointers.get(n),s=r.move(e,i),a=r.pointerType==="touch"?void 0:this.mouse.move(e,i,r.isPrevented);s==null||s.leave(),a==null||a.leave(),s==null||s.enter(),a==null||a.enter(),s==null||s.move(),a==null||a.move()}async release(e,n,i){const r=this.devices.get(n.pointerType);r.removePressed(n),this.buttons.up(n);const s=this.pointers.get(this.getPointerName(n)),a=s.isPrevented;if(s.position=i,s.pointerType!=="touch"&&(this.mouse.position=i),r.countPressed===0&&s.up(e,n.button),s.pointerType==="touch"&&s.release(e),s.pointerType==="touch"&&!s.isMultitouch){const o=this.mouse.move(e,i,a);o==null||o.leave(),o==null||o.enter(),o==null||o.move(),this.mouse.down(e,n,a)}if(!s.isMultitouch){const o=this.mouse.move(e,i,a);o==null||o.leave(),o==null||o.enter(),o==null||o.move(),this.mouse.up(e,n,a)}}getPointerName(e){return e.pointerType==="touch"?e.name:e.pointerType}getPreviousPosition(e){return this.pointers.has(e)?this.pointers.get(e).position:void 0}resetClickCount(){this.mouse.resetClickCount()}getMouseTarget(e){var n;return(n=this.mouse.position.target)!==null&&n!==void 0?n:e.config.document.body}setMousePosition(e){this.mouse.position=e,this.pointers.get("mouse").position=e}constructor(e){Hy(this,"system",void 0),Hy(this,"mouse",void 0),Hy(this,"buttons",void 0),Hy(this,"devices",new class{get(n){var i,r,s;return(s=(i=this.registry)[r=n])!==null&&s!==void 0?s:i[r]=new ngt}constructor(){Hy(this,"registry",{})}}),Hy(this,"pointers",new class{new(n,i,r){const s=i!=="touch"||!Object.values(this.registry).some(a=>a.pointerType==="touch"&&!a.isCancelled);return s||Object.values(this.registry).forEach(a=>{a.pointerType===i&&!a.isCancelled&&(a.isMultitouch=!0)}),this.registry[n]=new ugt({pointerId:this.nextId++,pointerType:i,isPrimary:s},r),this.registry[n]}get(n){if(!this.has(n))throw new Error(`Trying to access pointer "${n}" which does not exist.`);return this.registry[n]}has(n){return n in this.registry}constructor(){Hy(this,"registry",{}),Hy(this,"nextId",1)}}),this.system=e,this.buttons=new Mbe,this.mouse=new agt,this.pointers.new("mouse","mouse",this.buttons)}}function Pse(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}class kbe{getUIEventModifiers(){return{altKey:this.keyboard.modifiers.Alt,ctrlKey:this.keyboard.modifiers.Control,metaKey:this.keyboard.modifiers.Meta,shiftKey:this.keyboard.modifiers.Shift,modifierAltGraph:this.keyboard.modifiers.AltGraph,modifierCapsLock:this.keyboard.modifiers.CapsLock,modifierFn:this.keyboard.modifiers.Fn,modifierFnLock:this.keyboard.modifiers.FnLock,modifierNumLock:this.keyboard.modifiers.NumLock,modifierScrollLock:this.keyboard.modifiers.ScrollLock,modifierSymbol:this.keyboard.modifiers.Symbol,modifierSymbolLock:this.keyboard.modifiers.SymbolLock}}constructor(){Pse(this,"keyboard",new Zmt(this)),Pse(this,"pointer",new hgt(this))}}async function dgt(t){const e=[];return this.config.skipHover||e.push({target:t}),e.push({keys:"[MouseLeft]",target:t}),this.pointer(e)}async function fgt(t){return this.pointer([{target:t},"[MouseLeft][MouseLeft]"])}async function pgt(t){return this.pointer([{target:t},"[MouseLeft][MouseLeft][MouseLeft]"])}async function mgt(t){return this.pointer({target:t})}async function ggt(t){return YM(this,this.system.pointer.getMouseTarget(this)),this.pointer({target:t.ownerDocument.body})}async function vgt({shift:t}={}){return this.keyboard(t===!0?"{Shift>}{Tab}{/Shift}":t===!1?"[/ShiftLeft][/ShiftRight]{Tab}":"{Tab}")}var aX=function(t){return t["{"]="}",t["["]="]",t}(aX||{});function Pbe(t,e){let n=0;const i=t[n]in aX?t[n]:"";n+=i.length;const s=new RegExp(`^\\${i}{2}`).test(t)?"":i;return{type:s,...s===""?_gt(t,n,e):ygt(t,n,s,e)}}function _gt(t,e,n){const i=t[e];return Dbe(i,t,e,n),e+=i.length,{consumedLength:e,descriptor:i,releasePrevious:!1,releaseSelf:!0,repeat:1}}function ygt(t,e,n,i){var r,s;const a=t[e]==="/"?"/":"";e+=a.length;const o=n==="{"&&t[e]==="\\";e+=Number(o);const c=o?t[e]:(r=t.slice(e).match(n==="{"?/^\w+|^[^}>/]/:/^\w+/))===null||r===void 0?void 0:r[0];Dbe(c,t,e,i),e+=c.length;var l;const u=(l=(s=t.slice(e).match(/^>\d+/))===null||s===void 0?void 0:s[0])!==null&&l!==void 0?l:"";e+=u.length;const h=t[e]==="/"||!u&&t[e]===">"?t[e]:"";e+=h.length;const d=aX[n],f=t[e]===d?d:"";if(!f)throw new Error(Lbe([!u&&"repeat modifier",!h&&"release modifier",`"${d}"`].filter(Boolean).join(" or "),t[e],t,i));return e+=f.length,{consumedLength:e,descriptor:c,releasePrevious:!!a,repeat:u?Math.max(Number(u.substr(1)),1):1,releaseSelf:bgt(h,u)}}function Dbe(t,e,n,i){if(!t)throw new Error(Lbe("key descriptor",e[n],e,i))}function bgt(t,e){if(t)return t==="/";if(e)return!1}function Lbe(t,e,n,i){return`Expected ${t} but found "${e??""}" in "${n}"
    See ${i==="pointer"?"https://testing-library.com/docs/user-event/pointer#pressing-a-button-or-touching-the-screen":"https://testing-library.com/docs/user-event/keyboard"}
    for more information about how userEvent parses your input.`}function Egt(t,e){const n=[];do{const{type:r,descriptor:s,consumedLength:a,releasePrevious:o,releaseSelf:c=!0,repeat:l}=Pbe(e,"keyboard");var i;const u=(i=t.find(h=>{if(r==="["){var d;return((d=h.code)===null||d===void 0?void 0:d.toLowerCase())===s.toLowerCase()}else if(r==="{"){var f;return((f=h.key)===null||f===void 0?void 0:f.toLowerCase())===s.toLowerCase()}return h.key===s}))!==null&&i!==void 0?i:{key:"Unknown",code:"Unknown",[r==="["?"code":"key"]:s};n.push({keyDef:u,releasePrevious:o,releaseSelf:c,repeat:l}),e=e.slice(a)}while(e);return n}async function Sgt(t){const e=Egt(this.config.keyboardMap,t);for(let n=0;n<e.length;n++)await kA(this.config),await Tgt(this,e[n])}async function Tgt(t,{keyDef:e,releasePrevious:n,releaseSelf:i,repeat:r}){const{system:s}=t;if(s.keyboard.isKeyPressed(e)&&await s.keyboard.keyup(t,e),!n){for(let a=1;a<=r;a++)await s.keyboard.keydown(t,e),a<r&&await kA(t.config);i&&await s.keyboard.keyup(t,e)}}async function xgt(t){for(const e of t.system.keyboard.getPressedKeys())await t.system.keyboard.keyup(t,e)}function Ube(t){const e=C0(t)?{"text/plain":wgt(t)}:{"text/plain":String(t.ownerDocument.getSelection())},n=HK(Dp(t));for(const i in e)e[i]&&n.setData(i,e[i]);return n}function wgt(t){const e=cI(t);return A0(t).substring(e.startOffset,e.endOffset)}async function Cgt(){const t=this.config.document;var e;const n=(e=t.activeElement)!==null&&e!==void 0?e:t.body,i=Ube(n);if(i.items.length!==0)return this.dispatchUIEvent(n,"copy",{clipboardData:i})&&this.config.writeToClipboard&&await k_e(t,i),i}async function Agt(){const t=this.config.document;var e;const n=(e=t.activeElement)!==null&&e!==void 0?e:t.body,i=Ube(n);if(i.items.length!==0)return this.dispatchUIEvent(n,"cut",{clipboardData:i})&&this.config.writeToClipboard&&await k_e(n.ownerDocument,i),i}async function Rgt(t){const e=this.config.document;var n;const i=(n=e.activeElement)!==null&&n!==void 0?n:e.body;var r;const s=(r=typeof t=="string"?Mgt(e,t):t)!==null&&r!==void 0?r:await Ctt(e).catch(()=>{throw new Error("`userEvent.paste()` without `clipboardData` requires the `ClipboardAPI` to be available.")});this.dispatchUIEvent(i,"paste",{clipboardData:s})}function Mgt(t,e){const n=HK(Dp(t));return n.setData("text",e),n}function Dse(t,e){const n=[];do{const{descriptor:i,consumedLength:r,releasePrevious:s,releaseSelf:a=!0}=Pbe(e,"pointer"),o=t.find(c=>c.name===i);o&&n.push({keyDef:o,releasePrevious:s,releaseSelf:a}),e=e.slice(r)}while(e);return n}async function Ogt(t){const{pointerMap:e}=this.config,n=[];(Array.isArray(t)?t:[t]).forEach(i=>{typeof i=="string"?n.push(...Dse(e,i)):"keys"in i?n.push(...Dse(e,i.keys).map(r=>({...i,...r}))):n.push(i)});for(let i=0;i<n.length;i++)await kA(this.config),await Ngt(this,n[i]);this.system.pointer.resetClickCount()}async function Ngt(t,e){var n,i;const r="pointerName"in e&&e.pointerName?e.pointerName:"keyDef"in e?t.system.pointer.getPointerName(e.keyDef):"mouse",s=t.system.pointer.getPreviousPosition(r);var a,o,c,l;const u={target:(a=e.target)!==null&&a!==void 0?a:Igt(t,s),coords:(o=e.coords)!==null&&o!==void 0?o:s==null?void 0:s.coords,caret:{node:(c=e.node)!==null&&c!==void 0?c:Lse(e)||s==null||(n=s.caret)===null||n===void 0?void 0:n.node,offset:(l=e.offset)!==null&&l!==void 0?l:Lse(e)||s==null||(i=s.caret)===null||i===void 0?void 0:i.offset}};"keyDef"in e?(t.system.pointer.isKeyPressed(e.keyDef)&&(WM(t,Zd.Trigger),await t.system.pointer.release(t,e.keyDef,u)),e.releasePrevious||(WM(t,Zd.Trigger),await t.system.pointer.press(t,e.keyDef,u),e.releaseSelf&&(WM(t,Zd.Trigger),await t.system.pointer.release(t,e.keyDef,u)))):(WM(t,Zd.Trigger),await t.system.pointer.move(t,r,u))}function Lse(t){var e,n;return!!((n=(e=t.target)!==null&&e!==void 0?e:t.node)!==null&&n!==void 0?n:t.offset!==void 0)}function Igt(t,e){if(!e)throw new Error("This pointer has no previous position. Provide a target property!");var n;return(n=e.target)!==null&&n!==void 0?n:t.config.document.body}async function kgt(t){if(!RA(t)||U_(t))throw new Error("clear()` is only supported on editable elements.");if(pE(t),t.ownerDocument.activeElement!==t)throw new Error("The element to be cleared could not be focused.");if(Sbe(t),!Rmt(t))throw new Error("The element content to be cleared could not be selected.");IA(this,t,"","deleteContentBackward")}async function Pgt(t,e){return Bbe.call(this,!0,t,e)}async function Dgt(t,e){return Bbe.call(this,!1,t,e)}async function Bbe(t,e,n){if(!t&&!e.multiple)throw us().getElementError("Unable to deselect an option in a non-multiple select. Use selectOptions to change the selection instead.",e);const i=Array.isArray(n)?n:[n],r=Array.from(e.querySelectorAll('option, [role="option"]')),s=i.map(o=>{if(typeof o!="string"&&r.includes(o))return o;{const c=r.find(l=>l.value===o||l.innerHTML===o);if(c)return c;throw us().getElementError(`Value "${String(o)}" not found in options`,e)}}).filter(o=>!U_(o));if(U_(e)||!s.length)return;const a=o=>{o.selected=t,this.dispatchUIEvent(e,"input",{bubbles:!0,cancelable:!1,composed:!0}),this.dispatchUIEvent(e,"change")};if(vr(e,"select"))if(e.multiple)for(const o of s){const c=this.config.pointerEventsCheck===0?!0:fB(this,o);c&&(this.dispatchUIEvent(o,"pointerover"),this.dispatchUIEvent(e,"pointerenter"),this.dispatchUIEvent(o,"mouseover"),this.dispatchUIEvent(e,"mouseenter"),this.dispatchUIEvent(o,"pointermove"),this.dispatchUIEvent(o,"mousemove"),this.dispatchUIEvent(o,"pointerdown"),this.dispatchUIEvent(o,"mousedown")),pE(e),c&&(this.dispatchUIEvent(o,"pointerup"),this.dispatchUIEvent(o,"mouseup")),a(o),c&&this.dispatchUIEvent(o,"click"),await kA(this.config)}else if(s.length===1){const o=this.config.pointerEventsCheck===0?!0:fB(this,e);o?await this.click(e):pE(e),a(s[0]),o&&(this.dispatchUIEvent(e,"pointerover"),this.dispatchUIEvent(e,"pointerenter"),this.dispatchUIEvent(e,"mouseover"),this.dispatchUIEvent(e,"mouseenter"),this.dispatchUIEvent(e,"pointerup"),this.dispatchUIEvent(e,"mouseup"),this.dispatchUIEvent(e,"click")),await kA(this.config)}else throw us().getElementError("Cannot select multiple options on a non-multiple select",e);else if(e.getAttribute("role")==="listbox")for(const o of s)await this.click(o),await this.unhover(o);else throw us().getElementError("Cannot select options on elements that are neither select nor listbox elements",e)}async function Lgt(t,e,{skipClick:n=this.config.skipClick,skipAutoClose:i=this.config.skipAutoClose,initialSelectionStart:r,initialSelectionEnd:s}={}){t.disabled||(n||await this.click(t),r!==void 0&&$M(t,r,s??r),await this.keyboard(e),i||await xgt(this))}const Use=Symbol("files and value properties are mocked");function tV(t,e,n){n?Object.defineProperty(t,e,n):delete t[e]}function Ugt(t,e){var n;(n=t[Use])===null||n===void 0||n.restore();const i=Object.getOwnPropertyDescriptor(t,"type"),r=Object.getOwnPropertyDescriptor(t,"value"),s=Object.getOwnPropertyDescriptor(t,"files");function a(){tV(t,"type",i),tV(t,"value",r),tV(t,"files",s)}t[Use]={restore:a},Object.defineProperties(t,{files:{configurable:!0,get:()=>e},value:{configurable:!0,get:()=>e.length?`C:\\fakepath\\${e[0].name}`:"",set(o){if(o==="")a();else{var c;r==null||(c=r.set)===null||c===void 0||c.call(t,o)}}},type:{configurable:!0,get:()=>"file",set(o){o!=="file"&&(a(),t.type=o)}}})}async function Bgt(t,e){const n=vr(t,"label")?t.control:t;if(!n||!vr(n,"input",{type:"file"}))throw new TypeError(`The ${n===t?"given":"associated"} ${n==null?void 0:n.tagName} element does not accept file uploads`);if(U_(t))return;const i=(Array.isArray(e)?e:[e]).filter(s=>!this.config.applyAccept||Fgt(s,n.accept)).slice(0,n.multiple?void 0:1),r=()=>{var s;i.length===((s=n.files)===null||s===void 0?void 0:s.length)&&i.every((a,o)=>{var c;return a===((c=n.files)===null||c===void 0?void 0:c.item(o))})||(Ugt(n,jK(Dp(t),i)),this.dispatchUIEvent(n,"input"),this.dispatchUIEvent(n,"change"))};n.addEventListener("fileDialog",r),await this.click(t),n.removeEventListener("fileDialog",r)}function g2(t){return t.toLowerCase().replace(/(\.|\/)jpg\b/g,"$1jpeg")}function Fgt(t,e){if(!e)return!0;const n=["audio/*","image/*","video/*"];return g2(e).trim().split(/\s*,\s*/).some(i=>i.startsWith(".")?g2(t.name).endsWith(i):n.includes(i)?g2(t.type).startsWith(i.replace("*","")):g2(t.type)===i)}const Bse={click:dgt,dblClick:fgt,tripleClick:pgt,hover:mgt,unhover:ggt,tab:vgt,keyboard:Sgt,copy:Cgt,cut:Agt,paste:Rgt,pointer:Ogt,clear:kgt,deselectOptions:Dgt,selectOptions:Pgt,type:Lgt,upload:Bgt};function zgt(t){return us().asyncWrapper(t)}const Fbe={applyAccept:!0,autoModify:!0,delay:0,document:globalThis.document,keyboardMap:Jmt,pointerMap:Qmt,pointerEventsCheck:bL.EachApiCall,skipAutoClose:!1,skipClick:!1,skipHover:!1,writeToClipboard:!1,advanceTimers:()=>Promise.resolve()},jgt={...Fbe,writeToClipboard:!0};function zbe(t={},e=jgt,n){const i=qgt(t,n,e);return{...e,...t,document:i}}function Hgt(t={}){const e=zbe(t);Rbe(e.document),Abe(Dp(e.document).HTMLElement);var n;const i=(n=e.document.defaultView)!==null&&n!==void 0?n:globalThis.window;return Ttt(i),oX(e).api}function Mu({keyboardState:t,pointerState:e,...n}={},i){const r=zbe(n,Fbe,i);Rbe(r.document),Abe(Dp(r.document).HTMLElement);var s;const a=(s=e??t)!==null&&s!==void 0?s:new kbe;return{api:oX(r,a).api,system:a}}function Vgt(t){return oX({...this.config,...t},this.system).api}function Ggt(t,e){function n(...i){return WM(t,Zd.Call),zgt(()=>e.apply(t,i).then(async r=>(await kA(t.config),r)))}return Object.defineProperty(n,"name",{get:()=>e.name}),n}function oX(t,e=new kbe){const n={};return Object.assign(n,{config:t,dispatchEvent:Cbe.bind(n),dispatchUIEvent:Hmt.bind(n),system:e,levelRefs:{},...Bse}),{instance:n,api:{...Object.fromEntries(Object.entries(Bse).map(([i,r])=>[i,Ggt(n,r)])),setup:Vgt.bind(n)}}}function qgt(t,e,n){var i,r;return(r=(i=t.document)!==null&&i!==void 0?i:e&&Wmt(e))!==null&&r!==void 0?r:n.document}function $gt(t){return Mu().api.clear(t)}function Wgt(t,e={}){return Mu(e,t).api.click(t)}function Ygt(t={}){return Mu(t).api.copy()}function Kgt(t={}){return Mu(t).api.cut()}function Xgt(t,e={}){return Mu(e).api.dblClick(t)}function Zgt(t,e,n={}){return Mu(n).api.deselectOptions(t,e)}function Jgt(t,e={}){return Mu(e).api.hover(t)}async function Qgt(t,e={}){const{api:n,system:i}=Mu(e);return n.keyboard(t).then(()=>i)}async function e0t(t,e={}){const{api:n,system:i}=Mu(e);return n.pointer(t).then(()=>i)}function t0t(t,e){return Mu(e).api.paste(t)}function n0t(t,e,n={}){return Mu(n).api.selectOptions(t,e)}function i0t(t,e={}){return Mu(e).api.tripleClick(t)}function r0t(t,e,n={}){return Mu(n,t).api.type(t,e,n)}function s0t(t,e={}){const{api:n,system:i}=Mu(e);return i.pointer.setMousePosition({target:t}),n.unhover(t)}function a0t(t,e,n={}){return Mu(n).api.upload(t,e)}function o0t(t={}){return Mu().api.tab(t)}const c0t=Object.freeze(Object.defineProperty({__proto__:null,clear:$gt,click:Wgt,copy:Ygt,cut:Kgt,dblClick:Xgt,deselectOptions:Zgt,hover:Jgt,keyboard:Qgt,paste:t0t,pointer:e0t,selectOptions:n0t,tab:o0t,tripleClick:i0t,type:r0t,unhover:s0t,upload:a0t},Symbol.toStringTag,{value:"Module"})),l0t={...c0t,setup:Hgt},Kd=l0t.setup({delay:null});function za(){return window.sysclipboard}function cX(t){const e=new Set;function n(s){p4e(s)&&s.target!=="tick"&&s.target!=="tock"&&e.has(s.id)===!1&&(e.add(s.id),MN.invoke(s))}const i=NE("forward",["all"],s=>{e.has(s.id)||(e.add(s.id),t(s))});function r(){MN.disconnect(i)}return{forward:n,disconnect:r}}function u0t(t){switch(t.target){case"tick":case"tock":case"ready":return!0}return!1}function h0t(t){switch(t.target){case"log":case"info":case"error":case"tick":case"tock":case"ready":case"toast":case"second":return!0;default:{const e=O_(t.target);switch(e.target){case"vm":case"synth":case"modem":case"bridge":case"register":case"gadgetclient":return!0}switch(e.path){case"sync":case"joinack":case"acklogin":case"ackoperator":case"ackzsswords":case"gadgetclient":return!0}break}}return!1}function d0t(t){return!1}function jbe(t){const e=O_(t.target);switch(e.target){case"vm":case"modem":case"gadgetserver":return!0}switch(e.path){case"sync":case"joinack":return!0}return!1}function f0t(t){return new Worker("/assets/simspace-A6kmw8x9.js",{name:t==null?void 0:t.name})}function p0t(t){return new Worker("/assets/stubspace-B_Dfczxl.js",{name:t==null?void 0:t.name})}let v2;function m0t(t=!1){if(!re(v2)){v2=t?new p0t:new f0t;const{forward:e}=cX(n=>{jbe(n)&&v2.postMessage(n)});v2.addEventListener("message",n=>e(n.data))}}const gE=navigator.userAgent.includes("Mac"),qf=gE?"cmd":"ctrl";async function uI(t){return E6e(t)}async function pB(t,e){return S6e(t,e)}function g0t(t){try{return sessionStorage.getItem(t)??void 0}catch(e){Mi(mi,wa,`readsession ${t}`,e.message)}}function v0t(t,e){try{re(e)?sessionStorage.setItem(t,e):sessionStorage.removeItem(t)}catch(n){Mi(mi,wa,`writesession ${t} <- ${e}`,n.message)}}function Hbe(){try{const t=location.hash.slice(1);if(t.length)return t}catch(t){Mi(mi,wa,"crash",t.message)}return""}async function F$(){const t=Hbe();if(t.length){const e=await w0t(t);return re(e)&&e.length>t.length?e:t}return""}function z$(){vze(mi,wa,"https://github.com/goldbuick/zed-software-system/wiki","open help wiki")}function Fse(){o_(mi,wa,"#pages")}function zse(t){const{terminal:e}=As.getState();let i=[[wo(),t.target,...t.data],...e.info];i.length>y3&&(i=i.slice(0,y3)),As.setState(r=>({terminal:{...r.terminal,info:i}}))}function _0t(t){const{terminal:e}=As.getState();let i=[[wo(),t.target,...t.data],...e.logs];i.length>y3&&(i=i.slice(0,y3)),As.setState(r=>({terminal:{...r.terminal,logs:i}}))}function y0t(t){const{layout:e,editor:n}=As.getState();let r=e+(t?1:-1);if(r<0&&(r+=vm.MAX),r>=vm.MAX&&(r-=vm.MAX),!n.open)switch(r){case vm.SPLIT_X:r=vm.TOP;break}As.setState({layout:r})}async function Vbe(t){if(t.length===0){Mi(mi,wa,"content","no content found"),z$();return}const e=await EL("selected")??"";e6e(mi,wa,t,e)}let hI="";window.addEventListener("hashchange",()=>{_l(mi,wa,async()=>{const t=Hbe();if(hI!==t){hI=t;const e=await F$();await Vbe(e)}})});async function Gbe(t,e){if(t.length>2048){const i=await x0t(t);return Gbe(i,e)}const n=`#${t}`;if(location.hash!==n){hI=t,location.hash=n;const i=`wrote ${(t==null?void 0:t.length)??0} chars [${t.slice(0,8)}...${t.slice(-8)}]`;e.includes("autosave")||xr(mi,wa,i),document.title=e}}async function EL(t){return xr(mi,wa,`reading config ${t}`),uI(`config_${t}`)}async function b0t(t,e){return xr(mi,wa,`writing config ${t}`),pB(`config_${t}`,()=>e)}async function E0t(){return(await x6e()).filter(([e])=>e.startsWith("config_")).map(([e,n])=>[e.replace("config_",""),n])}async function S0t(){return uI("HISTORYBUFFER")}async function T0t(t){return pB("HISTORYBUFFER",()=>t)}async function x0t(t){let e=await uI(t);if(e===void 0){for(;e===void 0;){const n=V9({addAdverb:!0,capitalize:!1,adjectiveCount:2});await uI(n)===void 0&&(e=n)}await pB(t,()=>e),await pB(e,()=>t)}return e}async function w0t(t){return await uI(t)}let nV=0;const jse=10,wa=g0t("PLAYER")??U6e();v0t("PLAYER",wa);function Gi(){return wa}const mi=NE("register",["ready","second","info","error","log","toast"],function(t){if(mi.session(t)){switch(t.target){case"ready":case"toast":case"second":break;default:if(t.player!==wa)return;break}switch(t.target){case"ready":{_l(mi,t.player,async()=>{const e=await S0t();re(e)&&Vo.setState({buffer:e}),await Kf(256),xr(mi,wa,`myplayerid ${wa}`),Z4e(mi,wa)});break}case"ackoperator":_l(mi,t.player,async()=>{const e=await F$();kme()?C4e(mi,wa,e):(Q4e(mi,wa,Rq()),await Vbe(e))});break;case"loginready":n6e(mi,wa);break;case"loginfail":Fse(),z$(),pme(mi,wa);break;case"acklogin":Fse(),z$(),_3(mi,wa),N4e(mi,wa),J4e(mi,wa);break;case"ackzsswords":jr.setState({zsswords:t.data});break;case"copy":Tn(t.data)&&re(za())&&za().writeText(t.data).then(()=>Hl(mi,t.player,"copied!")).catch(e=>console.error(e));break;case"copyjsonfile":if(ji(t.data)&&re(za())){const[e,n]=t.data,i=new Blob([JSON.stringify({exported:n,data:e},null,2)],{type:"text/plain"});za().write([new ClipboardItem({[i.type]:i})]).then(()=>Hl(mi,t.player,"copied!")).catch(r=>console.error(r))}break;case"downloadjsonfile":if(ji(t.data)){const[e,n]=t.data;try{const i=new Blob([JSON.stringify({exported:n,data:e},null,2)],{type:"application/json;charset=utf-8"}),r=URL.createObjectURL(i),s=document.createElement("a");s.href=r,s.download=n,s.click(),URL.revokeObjectURL(r)}catch(i){console.error(i)}}break;case"dev":_l(mi,t.player,async function(){Rq()?(Bg(mi,t.player,"unlocking terminal"),await Kf(100),location.href=location.href.replace("/locked/#","/#")):(Bg(mi,t.player,"creating locked terminal"),await Kf(100),location.href=location.href.replace("/#","/locked/#"))});break;case"share":_l(mi,t.player,async function(){const e=await F$(),n=`#${e}`;hI=e,location.hash=n;const i=await Ime(location.href);Aq(mi,t.player,i,i)});break;case"nuke":_l(mi,t.player,async function(){Bg(mi,t.player,"nuke in"),hp(mi,t.player,"3","..."),await Kf(1e3),hp(mi,t.player,"2","..."),await Kf(1e3),hp(mi,t.player,"1","..."),await Kf(1e3),Bg(mi,t.player,"BYE"),await Kf(100),location.hash="",hI=location.hash,location.reload()});break;case"savemem":_l(mi,t.player,async function(){if(ji(t.data)){const[e,n]=t.data;Tn(e)&&Tn(n)&&await Gbe(n,e)}});break;case"forkmem":if(ji(t.data)){const[e]=t.data;Tn(e)&&window.open(location.href.replace(/#.*/,`#${e}`),"_blank")}break;case"config":_l(mi,t.player,async()=>{if(ji(t.data)){const[e,n]=t.data;await b0t(e,n),xr(mi,t.player,`updated config ${e} to ${n}`)}});break;case"configshow":_l(mi,t.player,async()=>{const e=await E0t();Bg(mi,t.player,"config");for(let n=0;n<e.length;++n)hp(mi,t.player,e[n][0],e[n][1])});break;case"second":++nV,nV>=jse&&(nV-=jse,mme(mi,wa));break;case"inspector":As.setState(e=>{const n=re(t.data)?!!t.data:!e.inspector;return xr(mi,t.player,`gadget inspector ${n?"$greenon":"$redoff"}`),n&&xr(mi,t.player,"mouse click or tap elements to inspect"),{inspector:n}});break;case"log":_0t(t);break;case"info":zse(t);break;case"error":zse(t);break;case"toast":_l(mi,t.player,async()=>{if(re(t.data)){const e=Math.min(Math.max(t.data.length*150,3e3),14e3);As.setState({toast:t.data}),await Kf(e),As.setState({toast:""})}});break;case"terminal:full":As.setState(e=>({layout:vm.FULL,terminal:{...e.terminal,open:!0}}));break;case"terminal:open":As.setState(e=>({terminal:{...e.terminal,open:!0}}));break;case"terminal:quickopen":As.setState({quickterminal:!0});break;case"terminal:close":As.setState(e=>({quickterminal:!1,terminal:{...e.terminal,open:!1}}));break;case"terminal:toggle":As.setState(e=>({terminal:{...e.terminal,open:!e.terminal.open}}));break;case"terminal:inclayout":f3e(t.data)&&y0t(t.data);break;case"editor:open":if(ji(t.data)){const[e,n,i,r]=t.data;As.setState(s=>({editor:{open:!0,player:t.player,book:e,path:n,type:i,title:r}}))}break;case"editor:close":As.setState(e=>({editor:{...e.editor,open:!1}}));break;default:{const{target:e,path:n}=O_(t.target);switch(e){case"touchkey":_l(mi,t.player,async()=>{switch(n){case"[Alt]":Zy(mi,t.player,"","-c",!0),od.setState(i=>({...i,keyboardalt:!i.keyboardalt,keyboardctrl:!1,keyboardshift:!1}));break;case"[Ctrl]":Zy(mi,t.player,"","-e",!0),od.setState(i=>({...i,keyboardalt:!1,keyboardctrl:!i.keyboardctrl,keyboardshift:!1}));break;case"[Shift]":Zy(mi,t.player,"","-g",!0),od.setState(i=>({...i,keyboardalt:!1,keyboardctrl:!1,keyboardshift:!i.keyboardshift}));break;default:{const i=!isNaN(parseInt(n,10)),r=od.getState(),s=[],a=gE?"Meta":"Ctrl";r.keyboardshift?(Zy(mi,t.player,"",i?"+c":"+f",!0),s.push("{Shift>}")):r.keyboardalt?(Zy(mi,t.player,"",i?"+c!":"+f!",!0),s.push("{Alt>}")):r.keyboardctrl?(Zy(mi,t.player,"",i?"+c#":"+f#",!0),s.push(`{${a}>}`)):Zy(mi,t.player,"",i?"-c":"-f",!0),s.push(n),r.keyboardshift?s.push("{/Shift}"):r.keyboardalt?s.push("{/Alt}"):r.keyboardctrl&&s.push(`{/${a}}`);const o=s.join("");await Kd.keyboard(o);break}}});break}break}}}});setTimeout(function(){m0t(kme())},100);const qbe="15.1.22",Hse=(t,e,n)=>({endTime:e,insertTime:n,type:"exponentialRampToValue",value:t}),Vse=(t,e,n)=>({endTime:e,insertTime:n,type:"linearRampToValue",value:t}),j$=(t,e)=>({startTime:e,type:"setValue",value:t}),$be=(t,e,n)=>({duration:n,startTime:e,type:"setValueCurve",values:t}),Wbe=(t,e,{startTime:n,target:i,timeConstant:r})=>i+(e-i)*Math.exp((n-t)/r),rC=t=>t.type==="exponentialRampToValue",mB=t=>t.type==="linearRampToValue",cb=t=>rC(t)||mB(t),lX=t=>t.type==="setValue",Gv=t=>t.type==="setValueCurve",gB=(t,e,n,i)=>{const r=t[e];return r===void 0?i:cb(r)||lX(r)?r.value:Gv(r)?r.values[r.values.length-1]:Wbe(n,gB(t,e-1,r.startTime,i),r)},Gse=(t,e,n,i,r)=>n===void 0?[i.insertTime,r]:cb(n)?[n.endTime,n.value]:lX(n)?[n.startTime,n.value]:Gv(n)?[n.startTime+n.duration,n.values[n.values.length-1]]:[n.startTime,gB(t,e-1,n.startTime,r)],H$=t=>t.type==="cancelAndHold",V$=t=>t.type==="cancelScheduledValues",Vy=t=>H$(t)||V$(t)?t.cancelTime:rC(t)||mB(t)?t.endTime:t.startTime,qse=(t,e,n,{endTime:i,value:r})=>n===r?r:0<n&&0<r||n<0&&r<0?n*(r/n)**((t-e)/(i-e)):0,$se=(t,e,n,{endTime:i,value:r})=>n+(t-e)/(i-e)*(r-n),C0t=(t,e)=>{const n=Math.floor(e),i=Math.ceil(e);return n===i?t[n]:(1-(e-n))*t[n]+(1-(i-e))*t[i]},A0t=(t,{duration:e,startTime:n,values:i})=>{const r=(t-n)/e*(i.length-1);return C0t(i,r)},_2=t=>t.type==="setTarget";class R0t{constructor(e){this._automationEvents=[],this._currenTime=0,this._defaultValue=e}[Symbol.iterator](){return this._automationEvents[Symbol.iterator]()}add(e){const n=Vy(e);if(H$(e)||V$(e)){const i=this._automationEvents.findIndex(s=>V$(e)&&Gv(s)?s.startTime+s.duration>=n:Vy(s)>=n),r=this._automationEvents[i];if(i!==-1&&(this._automationEvents=this._automationEvents.slice(0,i)),H$(e)){const s=this._automationEvents[this._automationEvents.length-1];if(r!==void 0&&cb(r)){if(s!==void 0&&_2(s))throw new Error("The internal list is malformed.");const a=s===void 0?r.insertTime:Gv(s)?s.startTime+s.duration:Vy(s),o=s===void 0?this._defaultValue:Gv(s)?s.values[s.values.length-1]:s.value,c=rC(r)?qse(n,a,o,r):$se(n,a,o,r),l=rC(r)?Hse(c,n,this._currenTime):Vse(c,n,this._currenTime);this._automationEvents.push(l)}if(s!==void 0&&_2(s)&&this._automationEvents.push(j$(this.getValue(n),n)),s!==void 0&&Gv(s)&&s.startTime+s.duration>n){const a=n-s.startTime,o=(s.values.length-1)/s.duration,c=Math.max(2,1+Math.ceil(a*o)),l=a/(c-1)*o,u=s.values.slice(0,c);if(l<1)for(let h=1;h<c;h+=1){const d=l*h%1;u[h]=s.values[h-1]*(1-d)+s.values[h]*d}this._automationEvents[this._automationEvents.length-1]=$be(u,s.startTime,a)}}}else{const i=this._automationEvents.findIndex(a=>Vy(a)>n),r=i===-1?this._automationEvents[this._automationEvents.length-1]:this._automationEvents[i-1];if(r!==void 0&&Gv(r)&&Vy(r)+r.duration>n)return!1;const s=rC(e)?Hse(e.value,e.endTime,this._currenTime):mB(e)?Vse(e.value,n,this._currenTime):e;if(i===-1)this._automationEvents.push(s);else{if(Gv(e)&&n+e.duration>Vy(this._automationEvents[i]))return!1;this._automationEvents.splice(i,0,s)}}return!0}flush(e){const n=this._automationEvents.findIndex(i=>Vy(i)>e);if(n>1){const i=this._automationEvents.slice(n-1),r=i[0];_2(r)&&i.unshift(j$(gB(this._automationEvents,n-2,r.startTime,this._defaultValue),r.startTime)),this._automationEvents=i}}getValue(e){if(this._automationEvents.length===0)return this._defaultValue;const n=this._automationEvents.findIndex(a=>Vy(a)>e),i=this._automationEvents[n],r=(n===-1?this._automationEvents.length:n)-1,s=this._automationEvents[r];if(s!==void 0&&_2(s)&&(i===void 0||!cb(i)||i.insertTime>e))return Wbe(e,gB(this._automationEvents,r-1,s.startTime,this._defaultValue),s);if(s!==void 0&&lX(s)&&(i===void 0||!cb(i)))return s.value;if(s!==void 0&&Gv(s)&&(i===void 0||!cb(i)||s.startTime+s.duration>e))return e<s.startTime+s.duration?A0t(e,s):s.values[s.values.length-1];if(s!==void 0&&cb(s)&&(i===void 0||!cb(i)))return s.value;if(i!==void 0&&rC(i)){const[a,o]=Gse(this._automationEvents,r,s,i,this._defaultValue);return qse(e,a,o,i)}if(i!==void 0&&mB(i)){const[a,o]=Gse(this._automationEvents,r,s,i,this._defaultValue);return $se(e,a,o,i)}return this._defaultValue}}const M0t=t=>({cancelTime:t,type:"cancelAndHold"}),O0t=t=>({cancelTime:t,type:"cancelScheduledValues"}),N0t=(t,e)=>({endTime:e,type:"exponentialRampToValue",value:t}),I0t=(t,e)=>({endTime:e,type:"linearRampToValue",value:t}),k0t=(t,e,n)=>({startTime:e,target:t,timeConstant:n,type:"setTarget"}),P0t=()=>new DOMException("","AbortError"),D0t=t=>(e,n,[i,r,s],a)=>{t(e[r],[n,i,s],o=>o[0]===n&&o[1]===i,a)},L0t=t=>(e,n,i)=>{const r=[];for(let s=0;s<i.numberOfInputs;s+=1)r.push(new Set);t.set(e,{activeInputs:r,outputs:new Set,passiveInputs:new WeakMap,renderer:n})},U0t=t=>(e,n)=>{t.set(e,{activeInputs:new Set,passiveInputs:new WeakMap,renderer:n})},PA=new WeakSet,Ybe=new WeakMap,uX=new WeakMap,Kbe=new WeakMap,hX=new WeakMap,S8=new WeakMap,Xbe=new WeakMap,G$=new WeakMap,q$=new WeakMap,$$=new WeakMap,Zbe={construct(){return Zbe}},B0t=t=>{try{const e=new Proxy(t,Zbe);new e}catch{return!1}return!0},Wse=/^import(?:(?:[\s]+[\w]+|(?:[\s]+[\w]+[\s]*,)?[\s]*\{[\s]*[\w]+(?:[\s]+as[\s]+[\w]+)?(?:[\s]*,[\s]*[\w]+(?:[\s]+as[\s]+[\w]+)?)*[\s]*}|(?:[\s]+[\w]+[\s]*,)?[\s]*\*[\s]+as[\s]+[\w]+)[\s]+from)?(?:[\s]*)("([^"\\]|\\.)+"|'([^'\\]|\\.)+')(?:[\s]*);?/,Yse=(t,e)=>{const n=[];let i=t.replace(/^[\s]+/,""),r=i.match(Wse);for(;r!==null;){const s=r[1].slice(1,-1),a=r[0].replace(/([\s]+)?;?$/,"").replace(s,new URL(s,e).toString());n.push(a),i=i.slice(r[0].length).replace(/^[\s]+/,""),r=i.match(Wse)}return[n.join(";"),i]},Kse=t=>{if(t!==void 0&&!Array.isArray(t))throw new TypeError("The parameterDescriptors property of given value for processorCtor is not an array.")},Xse=t=>{if(!B0t(t))throw new TypeError("The given value for processorCtor should be a constructor.");if(t.prototype===null||typeof t.prototype!="object")throw new TypeError("The given value for processorCtor should have a prototype.")},F0t=(t,e,n,i,r,s,a,o,c,l,u,h,d)=>{let f=0;return(p,g,_={credentials:"omit"})=>{const v=u.get(p);if(v!==void 0&&v.has(g))return Promise.resolve();const b=l.get(p);if(b!==void 0){const M=b.get(g);if(M!==void 0)return M}const S=s(p),x=S.audioWorklet===void 0?r(g).then(([M,R])=>{const[I,k]=Yse(M,R),P=`${I};((a,b)=>{(a[b]=a[b]||[]).push((AudioWorkletProcessor,global,registerProcessor,sampleRate,self,window)=>{${k}
})})(window,'_AWGS')`;return n(P)}).then(()=>{const M=d._AWGS.pop();if(M===void 0)throw new SyntaxError;i(S.currentTime,S.sampleRate,()=>M(class{},void 0,(R,I)=>{if(R.trim()==="")throw e();const k=q$.get(S);if(k!==void 0){if(k.has(R))throw e();Xse(I),Kse(I.parameterDescriptors),k.set(R,I)}else Xse(I),Kse(I.parameterDescriptors),q$.set(S,new Map([[R,I]]))},S.sampleRate,void 0,void 0))}):Promise.all([r(g),Promise.resolve(t(h,h))]).then(([[M,R],I])=>{const k=f+1;f=k;const[P,U]=Yse(M,R),Y=`${P};((AudioWorkletProcessor,registerProcessor)=>{${U}
})(${I?"AudioWorkletProcessor":"class extends AudioWorkletProcessor {__b=new WeakSet();constructor(){super();(p=>p.postMessage=(q=>(m,t)=>q.call(p,m,t?t.filter(u=>!this.__b.has(u)):t))(p.postMessage))(this.port)}}"},(n,p)=>registerProcessor(n,class extends p{${I?"":"__c = (a) => a.forEach(e=>this.__b.add(e.buffer));"}process(i,o,p){${I?"":"i.forEach(this.__c);o.forEach(this.__c);this.__c(Object.values(p));"}return super.process(i.map(j=>j.some(k=>k.length===0)?[]:j),o,p)}}));registerProcessor('__sac${k}',class extends AudioWorkletProcessor{process(){return !1}})`,te=new Blob([Y],{type:"application/javascript; charset=utf-8"}),G=URL.createObjectURL(te);return S.audioWorklet.addModule(G,_).then(()=>{if(o(S))return S;const J=a(S);return J.audioWorklet.addModule(G,_).then(()=>J)}).then(J=>{if(c===null)throw new SyntaxError;try{new c(J,`__sac${k}`)}catch{throw new SyntaxError}}).finally(()=>URL.revokeObjectURL(G))});return b===void 0?l.set(p,new Map([[g,x]])):b.set(g,x),x.then(()=>{const M=u.get(p);M===void 0?u.set(p,new Set([g])):M.add(g)}).finally(()=>{const M=l.get(p);M!==void 0&&M.delete(g)}),x}},Mm=(t,e)=>{const n=t.get(e);if(n===void 0)throw new Error("A value with the given key could not be found.");return n},T8=(t,e)=>{const n=Array.from(t).filter(e);if(n.length>1)throw Error("More than one element was found.");if(n.length===0)throw Error("No element was found.");const[i]=n;return t.delete(i),i},Jbe=(t,e,n,i)=>{const r=Mm(t,e),s=T8(r,a=>a[0]===n&&a[1]===i);return r.size===0&&t.delete(e),s},Wk=t=>Mm(Xbe,t),DA=t=>{if(PA.has(t))throw new Error("The AudioNode is already stored.");PA.add(t),Wk(t).forEach(e=>e(!0))},Qbe=t=>"port"in t,Yk=t=>{if(!PA.has(t))throw new Error("The AudioNode is not stored.");PA.delete(t),Wk(t).forEach(e=>e(!1))},W$=(t,e)=>{!Qbe(t)&&e.every(n=>n.size===0)&&Yk(t)},z0t=(t,e,n,i,r,s,a,o,c,l,u,h,d)=>{const f=new WeakMap;return(p,g,_,v,b)=>{const{activeInputs:S,passiveInputs:x}=s(g),{outputs:M}=s(p),R=o(p),I=k=>{const P=c(g),U=c(p);if(k){const V=Jbe(x,p,_,v);t(S,p,V,!1),!b&&!h(p)&&n(U,P,_,v),d(g)&&DA(g)}else{const V=i(S,p,_,v);e(x,v,V,!1),!b&&!h(p)&&r(U,P,_,v);const $=a(g);if($===0)u(g)&&W$(g,S);else{const q=f.get(g);q!==void 0&&clearTimeout(q),f.set(g,setTimeout(()=>{u(g)&&W$(g,S)},$*1e3))}}};return l(M,[g,_,v],k=>k[0]===g&&k[1]===_&&k[2]===v,!0)?(R.add(I),u(p)?t(S,p,[_,v,I],!0):e(x,v,[p,_,I],!0),!0):!1}},j0t=t=>(e,n,[i,r,s],a)=>{const o=e.get(i);o===void 0?e.set(i,new Set([[r,n,s]])):t(o,[r,n,s],c=>c[0]===r&&c[1]===n,a)},H0t=t=>(e,n)=>{const i=t(e,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});n.connect(i).connect(e.destination);const r=()=>{n.removeEventListener("ended",r),n.disconnect(i),i.disconnect()};n.addEventListener("ended",r)},V0t=t=>(e,n)=>{t(e).add(n)},G0t={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",fftSize:2048,maxDecibels:-30,minDecibels:-100,smoothingTimeConstant:.8},q0t=(t,e,n,i,r,s)=>class extends t{constructor(o,c){const l=r(o),u={...G0t,...c},h=i(l,u),d=s(l)?e():null;super(o,!1,h,d),this._nativeAnalyserNode=h}get fftSize(){return this._nativeAnalyserNode.fftSize}set fftSize(o){this._nativeAnalyserNode.fftSize=o}get frequencyBinCount(){return this._nativeAnalyserNode.frequencyBinCount}get maxDecibels(){return this._nativeAnalyserNode.maxDecibels}set maxDecibels(o){const c=this._nativeAnalyserNode.maxDecibels;if(this._nativeAnalyserNode.maxDecibels=o,!(o>this._nativeAnalyserNode.minDecibels))throw this._nativeAnalyserNode.maxDecibels=c,n()}get minDecibels(){return this._nativeAnalyserNode.minDecibels}set minDecibels(o){const c=this._nativeAnalyserNode.minDecibels;if(this._nativeAnalyserNode.minDecibels=o,!(this._nativeAnalyserNode.maxDecibels>o))throw this._nativeAnalyserNode.minDecibels=c,n()}get smoothingTimeConstant(){return this._nativeAnalyserNode.smoothingTimeConstant}set smoothingTimeConstant(o){this._nativeAnalyserNode.smoothingTimeConstant=o}getByteFrequencyData(o){this._nativeAnalyserNode.getByteFrequencyData(o)}getByteTimeDomainData(o){this._nativeAnalyserNode.getByteTimeDomainData(o)}getFloatFrequencyData(o){this._nativeAnalyserNode.getFloatFrequencyData(o)}getFloatTimeDomainData(o){this._nativeAnalyserNode.getFloatTimeDomainData(o)}},Ou=(t,e)=>t.context===e,$0t=(t,e,n)=>()=>{const i=new WeakMap,r=async(s,a)=>{let o=e(s);if(!Ou(o,a)){const l={channelCount:o.channelCount,channelCountMode:o.channelCountMode,channelInterpretation:o.channelInterpretation,fftSize:o.fftSize,maxDecibels:o.maxDecibels,minDecibels:o.minDecibels,smoothingTimeConstant:o.smoothingTimeConstant};o=t(a,l)}return i.set(a,o),await n(s,a,o),o};return{render(s,a){const o=i.get(a);return o!==void 0?Promise.resolve(o):r(s,a)}}},vB=t=>{try{t.copyToChannel(new Float32Array(1),0,-1)}catch{return!1}return!0},R0=()=>new DOMException("","IndexSizeError"),dX=t=>{t.getChannelData=(e=>n=>{try{return e.call(t,n)}catch(i){throw i.code===12?R0():i}})(t.getChannelData)},W0t={numberOfChannels:1},Y0t=(t,e,n,i,r,s,a,o)=>{let c=null;return class eEe{constructor(u){if(r===null)throw new Error("Missing the native OfflineAudioContext constructor.");const{length:h,numberOfChannels:d,sampleRate:f}={...W0t,...u};c===null&&(c=new r(1,1,44100));const p=i!==null&&e(s,s)?new i({length:h,numberOfChannels:d,sampleRate:f}):c.createBuffer(d,h,f);if(p.numberOfChannels===0)throw n();return typeof p.copyFromChannel!="function"?(a(p),dX(p)):e(vB,()=>vB(p))||o(p),t.add(p),p}static[Symbol.hasInstance](u){return u!==null&&typeof u=="object"&&Object.getPrototypeOf(u)===eEe.prototype||t.has(u)}}},ed=-34028234663852886e22,sh=-ed,y_=t=>PA.has(t),K0t={buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1},X0t=(t,e,n,i,r,s,a,o)=>class extends t{constructor(l,u){const h=s(l),d={...K0t,...u},f=r(h,d),p=a(h),g=p?e():null;super(l,!1,f,g),this._audioBufferSourceNodeRenderer=g,this._isBufferNullified=!1,this._isBufferSet=d.buffer!==null,this._nativeAudioBufferSourceNode=f,this._onended=null,this._playbackRate=n(this,p,f.playbackRate,sh,ed)}get buffer(){return this._isBufferNullified?null:this._nativeAudioBufferSourceNode.buffer}set buffer(l){if(this._nativeAudioBufferSourceNode.buffer=l,l!==null){if(this._isBufferSet)throw i();this._isBufferSet=!0}}get loop(){return this._nativeAudioBufferSourceNode.loop}set loop(l){this._nativeAudioBufferSourceNode.loop=l}get loopEnd(){return this._nativeAudioBufferSourceNode.loopEnd}set loopEnd(l){this._nativeAudioBufferSourceNode.loopEnd=l}get loopStart(){return this._nativeAudioBufferSourceNode.loopStart}set loopStart(l){this._nativeAudioBufferSourceNode.loopStart=l}get onended(){return this._onended}set onended(l){const u=typeof l=="function"?o(this,l):null;this._nativeAudioBufferSourceNode.onended=u;const h=this._nativeAudioBufferSourceNode.onended;this._onended=h!==null&&h===u?l:h}get playbackRate(){return this._playbackRate}start(l=0,u=0,h){if(this._nativeAudioBufferSourceNode.start(l,u,h),this._audioBufferSourceNodeRenderer!==null&&(this._audioBufferSourceNodeRenderer.start=h===void 0?[l,u]:[l,u,h]),this.context.state!=="closed"){DA(this);const d=()=>{this._nativeAudioBufferSourceNode.removeEventListener("ended",d),y_(this)&&Yk(this)};this._nativeAudioBufferSourceNode.addEventListener("ended",d)}}stop(l=0){this._nativeAudioBufferSourceNode.stop(l),this._audioBufferSourceNodeRenderer!==null&&(this._audioBufferSourceNodeRenderer.stop=l)}},Z0t=(t,e,n,i,r)=>()=>{const s=new WeakMap;let a=null,o=null;const c=async(l,u)=>{let h=n(l);const d=Ou(h,u);if(!d){const f={buffer:h.buffer,channelCount:h.channelCount,channelCountMode:h.channelCountMode,channelInterpretation:h.channelInterpretation,loop:h.loop,loopEnd:h.loopEnd,loopStart:h.loopStart,playbackRate:h.playbackRate.value};h=e(u,f),a!==null&&h.start(...a),o!==null&&h.stop(o)}return s.set(u,h),d?await t(u,l.playbackRate,h.playbackRate):await i(u,l.playbackRate,h.playbackRate),await r(l,u,h),h};return{set start(l){a=l},set stop(l){o=l},render(l,u){const h=s.get(u);return h!==void 0?Promise.resolve(h):c(l,u)}}},J0t=t=>"playbackRate"in t,Q0t=t=>"frequency"in t&&"gain"in t,evt=t=>"offset"in t,tvt=t=>!("frequency"in t)&&"gain"in t,nvt=t=>"detune"in t&&"frequency"in t&&!("gain"in t),ivt=t=>"pan"in t,fh=t=>Mm(Ybe,t),Kk=t=>Mm(Kbe,t),Y$=(t,e)=>{const{activeInputs:n}=fh(t);n.forEach(r=>r.forEach(([s])=>{e.includes(t)||Y$(s,[...e,t])}));const i=J0t(t)?[t.playbackRate]:Qbe(t)?Array.from(t.parameters.values()):Q0t(t)?[t.Q,t.detune,t.frequency,t.gain]:evt(t)?[t.offset]:tvt(t)?[t.gain]:nvt(t)?[t.detune,t.frequency]:ivt(t)?[t.pan]:[];for(const r of i){const s=Kk(r);s!==void 0&&s.activeInputs.forEach(([a])=>Y$(a,e))}y_(t)&&Yk(t)},tEe=t=>{Y$(t.destination,[])},rvt=t=>t===void 0||typeof t=="number"||typeof t=="string"&&(t==="balanced"||t==="interactive"||t==="playback"),svt=(t,e,n,i,r,s,a,o,c)=>class extends t{constructor(u={}){if(c===null)throw new Error("Missing the native AudioContext constructor.");let h;try{h=new c(u)}catch(p){throw p.code===12&&p.message==="sampleRate is not in range"?n():p}if(h===null)throw i();if(!rvt(u.latencyHint))throw new TypeError(`The provided value '${u.latencyHint}' is not a valid enum value of type AudioContextLatencyCategory.`);if(u.sampleRate!==void 0&&h.sampleRate!==u.sampleRate)throw n();super(h,2);const{latencyHint:d}=u,{sampleRate:f}=h;if(this._baseLatency=typeof h.baseLatency=="number"?h.baseLatency:d==="balanced"?512/f:d==="interactive"||d===void 0?256/f:d==="playback"?1024/f:Math.max(2,Math.min(128,Math.round(d*f/128)))*128/f,this._nativeAudioContext=h,c.name==="webkitAudioContext"?(this._nativeGainNode=h.createGain(),this._nativeOscillatorNode=h.createOscillator(),this._nativeGainNode.gain.value=1e-37,this._nativeOscillatorNode.connect(this._nativeGainNode).connect(h.destination),this._nativeOscillatorNode.start()):(this._nativeGainNode=null,this._nativeOscillatorNode=null),this._state=null,h.state==="running"){this._state="suspended";const p=()=>{this._state==="suspended"&&(this._state=null),h.removeEventListener("statechange",p)};h.addEventListener("statechange",p)}}get baseLatency(){return this._baseLatency}get state(){return this._state!==null?this._state:this._nativeAudioContext.state}close(){return this.state==="closed"?this._nativeAudioContext.close().then(()=>{throw e()}):(this._state==="suspended"&&(this._state=null),this._nativeAudioContext.close().then(()=>{this._nativeGainNode!==null&&this._nativeOscillatorNode!==null&&(this._nativeOscillatorNode.stop(),this._nativeGainNode.disconnect(),this._nativeOscillatorNode.disconnect()),tEe(this)}))}createMediaElementSource(u){return new r(this,{mediaElement:u})}createMediaStreamDestination(){return new s(this)}createMediaStreamSource(u){return new a(this,{mediaStream:u})}createMediaStreamTrackSource(u){return new o(this,{mediaStreamTrack:u})}resume(){return this._state==="suspended"?new Promise((u,h)=>{const d=()=>{this._nativeAudioContext.removeEventListener("statechange",d),this._nativeAudioContext.state==="running"?u():this.resume().then(u,h)};this._nativeAudioContext.addEventListener("statechange",d)}):this._nativeAudioContext.resume().catch(u=>{throw u===void 0||u.code===15?e():u})}suspend(){return this._nativeAudioContext.suspend().catch(u=>{throw u===void 0?e():u})}},avt=(t,e,n,i,r,s,a,o)=>class extends t{constructor(l,u){const h=s(l),d=a(h),f=r(h,u,d),p=d?e(o):null;super(l,!1,f,p),this._isNodeOfNativeOfflineAudioContext=d,this._nativeAudioDestinationNode=f}get channelCount(){return this._nativeAudioDestinationNode.channelCount}set channelCount(l){if(this._isNodeOfNativeOfflineAudioContext)throw i();if(l>this._nativeAudioDestinationNode.maxChannelCount)throw n();this._nativeAudioDestinationNode.channelCount=l}get channelCountMode(){return this._nativeAudioDestinationNode.channelCountMode}set channelCountMode(l){if(this._isNodeOfNativeOfflineAudioContext)throw i();this._nativeAudioDestinationNode.channelCountMode=l}get maxChannelCount(){return this._nativeAudioDestinationNode.maxChannelCount}},ovt=t=>{const e=new WeakMap,n=async(i,r)=>{const s=r.destination;return e.set(r,s),await t(i,r,s),s};return{render(i,r){const s=e.get(r);return s!==void 0?Promise.resolve(s):n(i,r)}}},cvt=(t,e,n,i,r,s,a,o)=>(c,l)=>{const u=l.listener,h=()=>{const M=new Float32Array(1),R=e(l,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:9}),I=a(l);let k=!1,P=[0,0,-1,0,1,0],U=[0,0,0];const V=()=>{if(k)return;k=!0;const te=i(l,256,9,0);te.onaudioprocess=({inputBuffer:G})=>{const J=[s(G,M,0),s(G,M,1),s(G,M,2),s(G,M,3),s(G,M,4),s(G,M,5)];J.some((X,ae)=>X!==P[ae])&&(u.setOrientation(...J),P=J);const K=[s(G,M,6),s(G,M,7),s(G,M,8)];K.some((X,ae)=>X!==U[ae])&&(u.setPosition(...K),U=K)},R.connect(te)},$=te=>G=>{G!==P[te]&&(P[te]=G,u.setOrientation(...P))},q=te=>G=>{G!==U[te]&&(U[te]=G,u.setPosition(...U))},Y=(te,G,J)=>{const K=n(l,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:G});K.connect(R,0,te),K.start(),Object.defineProperty(K.offset,"defaultValue",{get(){return G}});const X=t({context:c},I,K.offset,sh,ed);return o(X,"value",ae=>()=>ae.call(X),ae=>ce=>{try{ae.call(X,ce)}catch(Me){if(Me.code!==9)throw Me}V(),I&&J(ce)}),X.cancelAndHoldAtTime=(ae=>I?()=>{throw r()}:(...ce)=>{const Me=ae.apply(X,ce);return V(),Me})(X.cancelAndHoldAtTime),X.cancelScheduledValues=(ae=>I?()=>{throw r()}:(...ce)=>{const Me=ae.apply(X,ce);return V(),Me})(X.cancelScheduledValues),X.exponentialRampToValueAtTime=(ae=>I?()=>{throw r()}:(...ce)=>{const Me=ae.apply(X,ce);return V(),Me})(X.exponentialRampToValueAtTime),X.linearRampToValueAtTime=(ae=>I?()=>{throw r()}:(...ce)=>{const Me=ae.apply(X,ce);return V(),Me})(X.linearRampToValueAtTime),X.setTargetAtTime=(ae=>I?()=>{throw r()}:(...ce)=>{const Me=ae.apply(X,ce);return V(),Me})(X.setTargetAtTime),X.setValueAtTime=(ae=>I?()=>{throw r()}:(...ce)=>{const Me=ae.apply(X,ce);return V(),Me})(X.setValueAtTime),X.setValueCurveAtTime=(ae=>I?()=>{throw r()}:(...ce)=>{const Me=ae.apply(X,ce);return V(),Me})(X.setValueCurveAtTime),X};return{forwardX:Y(0,0,$(0)),forwardY:Y(1,0,$(1)),forwardZ:Y(2,-1,$(2)),positionX:Y(6,0,q(0)),positionY:Y(7,0,q(1)),positionZ:Y(8,0,q(2)),upX:Y(3,0,$(3)),upY:Y(4,1,$(4)),upZ:Y(5,0,$(5))}},{forwardX:d,forwardY:f,forwardZ:p,positionX:g,positionY:_,positionZ:v,upX:b,upY:S,upZ:x}=u.forwardX===void 0?h():u;return{get forwardX(){return d},get forwardY(){return f},get forwardZ(){return p},get positionX(){return g},get positionY(){return _},get positionZ(){return v},get upX(){return b},get upY(){return S},get upZ(){return x}}},_B=t=>"context"in t,Xk=t=>_B(t[0]),nx=(t,e,n,i)=>{for(const r of t)if(n(r)){if(i)return!1;throw Error("The set contains at least one similar element.")}return t.add(e),!0},Zse=(t,e,[n,i],r)=>{nx(t,[e,n,i],s=>s[0]===e&&s[1]===n,r)},Jse=(t,[e,n,i],r)=>{const s=t.get(e);s===void 0?t.set(e,new Set([[n,i]])):nx(s,[n,i],a=>a[0]===n,r)},ER=t=>"inputs"in t,yB=(t,e,n,i)=>{if(ER(e)){const r=e.inputs[i];return t.connect(r,n,0),[r,n,0]}return t.connect(e,n,i),[e,n,i]},nEe=(t,e,n)=>{for(const i of t)if(i[0]===e&&i[1]===n)return t.delete(i),i;return null},lvt=(t,e,n)=>T8(t,i=>i[0]===e&&i[1]===n),iEe=(t,e)=>{if(!Wk(t).delete(e))throw new Error("Missing the expected event listener.")},rEe=(t,e,n)=>{const i=Mm(t,e),r=T8(i,s=>s[0]===n);return i.size===0&&t.delete(e),r},bB=(t,e,n,i)=>{ER(e)?t.disconnect(e.inputs[i],n,0):t.disconnect(e,n,i)},Ra=t=>Mm(uX,t),dI=t=>Mm(hX,t),A1=t=>G$.has(t),SL=t=>!PA.has(t),Qse=(t,e)=>new Promise(n=>{if(e!==null)n(!0);else{const i=t.createScriptProcessor(256,1,1),r=t.createGain(),s=t.createBuffer(1,2,44100),a=s.getChannelData(0);a[0]=1,a[1]=1;const o=t.createBufferSource();o.buffer=s,o.loop=!0,o.connect(i).connect(t.destination),o.connect(r),o.disconnect(r),i.onaudioprocess=c=>{const l=c.inputBuffer.getChannelData(0);Array.prototype.some.call(l,u=>u===1)?n(!0):n(!1),o.stop(),i.onaudioprocess=null,o.disconnect(i),i.disconnect(t.destination)},o.start()}}),iV=(t,e)=>{const n=new Map;for(const i of t)for(const r of i){const s=n.get(r);n.set(r,s===void 0?1:s+1)}n.forEach((i,r)=>e(r,i))},EB=t=>"context"in t,uvt=t=>{const e=new Map;t.connect=(n=>(i,r=0,s=0)=>{const a=EB(i)?n(i,r,s):n(i,r),o=e.get(i);return o===void 0?e.set(i,[{input:s,output:r}]):o.every(c=>c.input!==s||c.output!==r)&&o.push({input:s,output:r}),a})(t.connect.bind(t)),t.disconnect=(n=>(i,r,s)=>{if(n.apply(t),i===void 0)e.clear();else if(typeof i=="number")for(const[a,o]of e){const c=o.filter(l=>l.output!==i);c.length===0?e.delete(a):e.set(a,c)}else if(e.has(i))if(r===void 0)e.delete(i);else{const a=e.get(i);if(a!==void 0){const o=a.filter(c=>c.output!==r&&(c.input!==s||s===void 0));o.length===0?e.delete(i):e.set(i,o)}}for(const[a,o]of e)o.forEach(c=>{EB(a)?t.connect(a,c.output,c.input):t.connect(a,c.output)})})(t.disconnect)},hvt=(t,e,n,i)=>{const{activeInputs:r,passiveInputs:s}=Kk(e),{outputs:a}=fh(t),o=Wk(t),c=l=>{const u=Ra(t),h=dI(e);if(l){const d=rEe(s,t,n);Zse(r,t,d,!1),!i&&!A1(t)&&u.connect(h,n)}else{const d=lvt(r,t,n);Jse(s,d,!1),!i&&!A1(t)&&u.disconnect(h,n)}};return nx(a,[e,n],l=>l[0]===e&&l[1]===n,!0)?(o.add(c),y_(t)?Zse(r,t,[n,c],!0):Jse(s,[t,n,c],!0),!0):!1},dvt=(t,e,n,i)=>{const{activeInputs:r,passiveInputs:s}=fh(e),a=nEe(r[i],t,n);return a===null?[Jbe(s,t,n,i)[2],!1]:[a[2],!0]},fvt=(t,e,n)=>{const{activeInputs:i,passiveInputs:r}=Kk(e),s=nEe(i,t,n);return s===null?[rEe(r,t,n)[1],!1]:[s[2],!0]},fX=(t,e,n,i,r)=>{const[s,a]=dvt(t,n,i,r);if(s!==null&&(iEe(t,s),a&&!e&&!A1(t)&&bB(Ra(t),Ra(n),i,r)),y_(n)){const{activeInputs:o}=fh(n);W$(n,o)}},pX=(t,e,n,i)=>{const[r,s]=fvt(t,n,i);r!==null&&(iEe(t,r),s&&!e&&!A1(t)&&Ra(t).disconnect(dI(n),i))},pvt=(t,e)=>{const n=fh(t),i=[];for(const r of n.outputs)Xk(r)?fX(t,e,...r):pX(t,e,...r),i.push(r[0]);return n.outputs.clear(),i},mvt=(t,e,n)=>{const i=fh(t),r=[];for(const s of i.outputs)s[1]===n&&(Xk(s)?fX(t,e,...s):pX(t,e,...s),r.push(s[0]),i.outputs.delete(s));return r},gvt=(t,e,n,i,r)=>{const s=fh(t);return Array.from(s.outputs).filter(a=>a[0]===n&&(i===void 0||a[1]===i)&&(r===void 0||a[2]===r)).map(a=>(Xk(a)?fX(t,e,...a):pX(t,e,...a),s.outputs.delete(a),a[0]))},vvt=(t,e,n,i,r,s,a,o,c,l,u,h,d,f,p,g)=>class extends l{constructor(v,b,S,x){super(S),this._context=v,this._nativeAudioNode=S;const M=u(v);h(M)&&n(Qse,()=>Qse(M,g))!==!0&&uvt(S),uX.set(this,S),Xbe.set(this,new Set),v.state!=="closed"&&b&&DA(this),t(this,x,S)}get channelCount(){return this._nativeAudioNode.channelCount}set channelCount(v){this._nativeAudioNode.channelCount=v}get channelCountMode(){return this._nativeAudioNode.channelCountMode}set channelCountMode(v){this._nativeAudioNode.channelCountMode=v}get channelInterpretation(){return this._nativeAudioNode.channelInterpretation}set channelInterpretation(v){this._nativeAudioNode.channelInterpretation=v}get context(){return this._context}get numberOfInputs(){return this._nativeAudioNode.numberOfInputs}get numberOfOutputs(){return this._nativeAudioNode.numberOfOutputs}connect(v,b=0,S=0){if(b<0||b>=this._nativeAudioNode.numberOfOutputs)throw r();const x=u(this._context),M=p(x);if(d(v)||f(v))throw s();if(_B(v)){const k=Ra(v);try{const U=yB(this._nativeAudioNode,k,b,S),V=SL(this);(M||V)&&this._nativeAudioNode.disconnect(...U),this.context.state!=="closed"&&!V&&SL(v)&&DA(v)}catch(U){throw U.code===12?s():U}if(e(this,v,b,S,M)){const U=c([this],v);iV(U,i(M))}return v}const R=dI(v);if(R.name==="playbackRate"&&R.maxValue===1024)throw a();try{this._nativeAudioNode.connect(R,b),(M||SL(this))&&this._nativeAudioNode.disconnect(R,b)}catch(k){throw k.code===12?s():k}if(hvt(this,v,b,M)){const k=c([this],v);iV(k,i(M))}}disconnect(v,b,S){let x;const M=u(this._context),R=p(M);if(v===void 0)x=pvt(this,R);else if(typeof v=="number"){if(v<0||v>=this.numberOfOutputs)throw r();x=mvt(this,R,v)}else{if(b!==void 0&&(b<0||b>=this.numberOfOutputs)||_B(v)&&S!==void 0&&(S<0||S>=v.numberOfInputs))throw r();if(x=gvt(this,R,v,b,S),x.length===0)throw s()}for(const I of x){const k=c([this],I);iV(k,o)}}},_vt=(t,e,n,i,r,s,a,o,c,l,u,h,d)=>(f,p,g,_=null,v=null)=>{const b=g.value,S=new R0t(b),x=p?i(S):null,M={get defaultValue(){return b},get maxValue(){return _===null?g.maxValue:_},get minValue(){return v===null?g.minValue:v},get value(){return g.value},set value(R){g.value=R,M.setValueAtTime(R,f.context.currentTime)},cancelAndHoldAtTime(R){if(typeof g.cancelAndHoldAtTime=="function")x===null&&S.flush(f.context.currentTime),S.add(r(R)),g.cancelAndHoldAtTime(R);else{const I=Array.from(S).pop();x===null&&S.flush(f.context.currentTime),S.add(r(R));const k=Array.from(S).pop();g.cancelScheduledValues(R),I!==k&&k!==void 0&&(k.type==="exponentialRampToValue"?g.exponentialRampToValueAtTime(k.value,k.endTime):k.type==="linearRampToValue"?g.linearRampToValueAtTime(k.value,k.endTime):k.type==="setValue"?g.setValueAtTime(k.value,k.startTime):k.type==="setValueCurve"&&g.setValueCurveAtTime(k.values,k.startTime,k.duration))}return M},cancelScheduledValues(R){return x===null&&S.flush(f.context.currentTime),S.add(s(R)),g.cancelScheduledValues(R),M},exponentialRampToValueAtTime(R,I){if(R===0)throw new RangeError;if(!Number.isFinite(I)||I<0)throw new RangeError;const k=f.context.currentTime;return x===null&&S.flush(k),Array.from(S).length===0&&(S.add(l(b,k)),g.setValueAtTime(b,k)),S.add(a(R,I)),g.exponentialRampToValueAtTime(R,I),M},linearRampToValueAtTime(R,I){const k=f.context.currentTime;return x===null&&S.flush(k),Array.from(S).length===0&&(S.add(l(b,k)),g.setValueAtTime(b,k)),S.add(o(R,I)),g.linearRampToValueAtTime(R,I),M},setTargetAtTime(R,I,k){return x===null&&S.flush(f.context.currentTime),S.add(c(R,I,k)),g.setTargetAtTime(R,I,k),M},setValueAtTime(R,I){return x===null&&S.flush(f.context.currentTime),S.add(l(R,I)),g.setValueAtTime(R,I),M},setValueCurveAtTime(R,I,k){const P=R instanceof Float32Array?R:new Float32Array(R);if(h!==null&&h.name==="webkitAudioContext"){const U=I+k,V=f.context.sampleRate,$=Math.ceil(I*V),q=Math.floor(U*V),Y=q-$,te=new Float32Array(Y);for(let J=0;J<Y;J+=1){const K=(P.length-1)/k*(($+J)/V-I),X=Math.floor(K),ae=Math.ceil(K);te[J]=X===ae?P[X]:(1-(K-X))*P[X]+(1-(ae-K))*P[ae]}x===null&&S.flush(f.context.currentTime),S.add(u(te,I,k)),g.setValueCurveAtTime(te,I,k);const G=q/V;G<U&&d(M,te[te.length-1],G),d(M,P[P.length-1],U)}else x===null&&S.flush(f.context.currentTime),S.add(u(P,I,k)),g.setValueCurveAtTime(P,I,k);return M}};return n.set(M,g),e.set(M,f),t(M,x),M},yvt=t=>({replay(e){for(const n of t)if(n.type==="exponentialRampToValue"){const{endTime:i,value:r}=n;e.exponentialRampToValueAtTime(r,i)}else if(n.type==="linearRampToValue"){const{endTime:i,value:r}=n;e.linearRampToValueAtTime(r,i)}else if(n.type==="setTarget"){const{startTime:i,target:r,timeConstant:s}=n;e.setTargetAtTime(r,i,s)}else if(n.type==="setValue"){const{startTime:i,value:r}=n;e.setValueAtTime(r,i)}else if(n.type==="setValueCurve"){const{duration:i,startTime:r,values:s}=n;e.setValueCurveAtTime(s,r,i)}else throw new Error("Can't apply an unknown automation.")}});class sEe{constructor(e){this._map=new Map(e)}get size(){return this._map.size}entries(){return this._map.entries()}forEach(e,n=null){return this._map.forEach((i,r)=>e.call(n,i,r,this))}get(e){return this._map.get(e)}has(e){return this._map.has(e)}keys(){return this._map.keys()}values(){return this._map.values()}}const bvt={channelCount:2,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:1,numberOfOutputs:1,parameterData:{},processorOptions:{}},Evt=(t,e,n,i,r,s,a,o,c,l,u,h,d,f)=>class extends e{constructor(g,_,v){var b;const S=o(g),x=c(S),M=u({...bvt,...v});d(M);const R=q$.get(S),I=R==null?void 0:R.get(_),k=x||S.state!=="closed"?S:(b=a(S))!==null&&b!==void 0?b:S,P=r(k,x?null:g.baseLatency,l,_,I,M),U=x?i(_,M,I):null;super(g,!0,P,U);const V=[];P.parameters.forEach((q,Y)=>{const te=n(this,x,q);V.push([Y,te])}),this._nativeAudioWorkletNode=P,this._onprocessorerror=null,this._parameters=new sEe(V),x&&t(S,this);const{activeInputs:$}=s(this);h(P,$)}get onprocessorerror(){return this._onprocessorerror}set onprocessorerror(g){const _=typeof g=="function"?f(this,g):null;this._nativeAudioWorkletNode.onprocessorerror=_;const v=this._nativeAudioWorkletNode.onprocessorerror;this._onprocessorerror=v!==null&&v===_?g:v}get parameters(){return this._parameters===null?this._nativeAudioWorkletNode.parameters:this._parameters}get port(){return this._nativeAudioWorkletNode.port}};function SB(t,e,n,i,r){if(typeof t.copyFromChannel=="function")e[n].byteLength===0&&(e[n]=new Float32Array(128)),t.copyFromChannel(e[n],i,r);else{const s=t.getChannelData(i);if(e[n].byteLength===0)e[n]=s.slice(r,r+128);else{const a=new Float32Array(s.buffer,r*Float32Array.BYTES_PER_ELEMENT,128);e[n].set(a)}}}const aEe=(t,e,n,i,r)=>{typeof t.copyToChannel=="function"?e[n].byteLength!==0&&t.copyToChannel(e[n],i,r):e[n].byteLength!==0&&t.getChannelData(i).set(e[n],r)},TB=(t,e)=>{const n=[];for(let i=0;i<t;i+=1){const r=[],s=typeof e=="number"?e:e[i];for(let a=0;a<s;a+=1)r.push(new Float32Array(128));n.push(r)}return n},Svt=(t,e)=>{const n=Mm($$,t),i=Ra(e);return Mm(n,i)},Tvt=async(t,e,n,i,r,s,a)=>{const o=e===null?Math.ceil(t.context.length/128)*128:e.length,c=i.channelCount*i.numberOfInputs,l=r.reduce((_,v)=>_+v,0),u=l===0?null:n.createBuffer(l,o,n.sampleRate);if(s===void 0)throw new Error("Missing the processor constructor.");const h=fh(t),d=await Svt(n,t),f=TB(i.numberOfInputs,i.channelCount),p=TB(i.numberOfOutputs,r),g=Array.from(t.parameters.keys()).reduce((_,v)=>({..._,[v]:new Float32Array(128)}),{});for(let _=0;_<o;_+=128){if(i.numberOfInputs>0&&e!==null)for(let v=0;v<i.numberOfInputs;v+=1)for(let b=0;b<i.channelCount;b+=1)SB(e,f[v],b,b,_);s.parameterDescriptors!==void 0&&e!==null&&s.parameterDescriptors.forEach(({name:v},b)=>{SB(e,g,v,c+b,_)});for(let v=0;v<i.numberOfInputs;v+=1)for(let b=0;b<r[v];b+=1)p[v][b].byteLength===0&&(p[v][b]=new Float32Array(128));try{const v=f.map((S,x)=>h.activeInputs[x].size===0?[]:S),b=a(_/n.sampleRate,n.sampleRate,()=>d.process(v,p,g));if(u!==null)for(let S=0,x=0;S<i.numberOfOutputs;S+=1){for(let M=0;M<r[S];M+=1)aEe(u,p[S],M,x+M,_);x+=r[S]}if(!b)break}catch(v){t.dispatchEvent(new ErrorEvent("processorerror",{colno:v.colno,filename:v.filename,lineno:v.lineno,message:v.message}));break}}return u},xvt=(t,e,n,i,r,s,a,o,c,l,u,h,d,f,p,g)=>(_,v,b)=>{const S=new WeakMap;let x=null;const M=async(R,I)=>{let k=u(R),P=null;const U=Ou(k,I),V=Array.isArray(v.outputChannelCount)?v.outputChannelCount:Array.from(v.outputChannelCount);if(h===null){const $=V.reduce((G,J)=>G+J,0),q=r(I,{channelCount:Math.max(1,$),channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:Math.max(1,$)}),Y=[];for(let G=0;G<R.numberOfOutputs;G+=1)Y.push(i(I,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:V[G]}));const te=a(I,{channelCount:v.channelCount,channelCountMode:v.channelCountMode,channelInterpretation:v.channelInterpretation,gain:1});te.connect=e.bind(null,Y),te.disconnect=c.bind(null,Y),P=[q,Y,te]}else U||(k=new h(I,_));if(S.set(I,P===null?k:P[2]),P!==null){if(x===null){if(b===void 0)throw new Error("Missing the processor constructor.");if(d===null)throw new Error("Missing the native OfflineAudioContext constructor.");const J=R.channelCount*R.numberOfInputs,K=b.parameterDescriptors===void 0?0:b.parameterDescriptors.length,X=J+K;x=Tvt(R,X===0?null:await(async()=>{const ce=new d(X,Math.ceil(R.context.length/128)*128,I.sampleRate),Me=[],Fe=[];for(let ge=0;ge<v.numberOfInputs;ge+=1)Me.push(a(ce,{channelCount:v.channelCount,channelCountMode:v.channelCountMode,channelInterpretation:v.channelInterpretation,gain:1})),Fe.push(r(ce,{channelCount:v.channelCount,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:v.channelCount}));const Te=await Promise.all(Array.from(R.parameters.values()).map(async ge=>{const _e=s(ce,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:ge.value});return await f(ce,ge,_e.offset),_e})),Re=i(ce,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:Math.max(1,J+K)});for(let ge=0;ge<v.numberOfInputs;ge+=1){Me[ge].connect(Fe[ge]);for(let _e=0;_e<v.channelCount;_e+=1)Fe[ge].connect(Re,_e,ge*v.channelCount+_e)}for(const[ge,_e]of Te.entries())_e.connect(Re,0,J+ge),_e.start(0);return Re.connect(ce.destination),await Promise.all(Me.map(ge=>p(R,ce,ge))),g(ce)})(),I,v,V,b,l)}const $=await x,q=n(I,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}),[Y,te,G]=P;$!==null&&(q.buffer=$,q.start(0)),q.connect(Y);for(let J=0,K=0;J<R.numberOfOutputs;J+=1){const X=te[J];for(let ae=0;ae<V[J];ae+=1)Y.connect(X,K+ae,ae);K+=V[J]}return G}if(U)for(const[$,q]of R.parameters.entries())await t(I,q,k.parameters.get($));else for(const[$,q]of R.parameters.entries())await f(I,q,k.parameters.get($));return await p(R,I,k),k};return{render(R,I){o(I,R);const k=S.get(I);return k!==void 0?Promise.resolve(k):M(R,I)}}},wvt=(t,e,n,i,r,s,a,o,c,l,u,h,d,f,p,g,_,v,b,S)=>class extends p{constructor(M,R){super(M,R),this._nativeContext=M,this._audioWorklet=t===void 0?void 0:{addModule:(I,k)=>t(this,I,k)}}get audioWorklet(){return this._audioWorklet}createAnalyser(){return new e(this)}createBiquadFilter(){return new r(this)}createBuffer(M,R,I){return new n({length:R,numberOfChannels:M,sampleRate:I})}createBufferSource(){return new i(this)}createChannelMerger(M=6){return new s(this,{numberOfInputs:M})}createChannelSplitter(M=6){return new a(this,{numberOfOutputs:M})}createConstantSource(){return new o(this)}createConvolver(){return new c(this)}createDelay(M=1){return new u(this,{maxDelayTime:M})}createDynamicsCompressor(){return new h(this)}createGain(){return new d(this)}createIIRFilter(M,R){return new f(this,{feedback:R,feedforward:M})}createOscillator(){return new g(this)}createPanner(){return new _(this)}createPeriodicWave(M,R,I={disableNormalization:!1}){return new v(this,{...I,imag:R,real:M})}createStereoPanner(){return new b(this)}createWaveShaper(){return new S(this)}decodeAudioData(M,R,I){return l(this._nativeContext,M).then(k=>(typeof R=="function"&&R(k),k),k=>{throw typeof I=="function"&&I(k),k})}},Cvt={Q:1,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",detune:0,frequency:350,gain:0,type:"lowpass"},Avt=(t,e,n,i,r,s,a,o)=>class extends t{constructor(l,u){const h=s(l),d={...Cvt,...u},f=r(h,d),p=a(h),g=p?n():null;super(l,!1,f,g),this._Q=e(this,p,f.Q,sh,ed),this._detune=e(this,p,f.detune,1200*Math.log2(sh),-1200*Math.log2(sh)),this._frequency=e(this,p,f.frequency,l.sampleRate/2,0),this._gain=e(this,p,f.gain,40*Math.log10(sh),ed),this._nativeBiquadFilterNode=f,o(this,1)}get detune(){return this._detune}get frequency(){return this._frequency}get gain(){return this._gain}get Q(){return this._Q}get type(){return this._nativeBiquadFilterNode.type}set type(l){this._nativeBiquadFilterNode.type=l}getFrequencyResponse(l,u,h){try{this._nativeBiquadFilterNode.getFrequencyResponse(l,u,h)}catch(d){throw d.code===11?i():d}if(l.length!==u.length||u.length!==h.length)throw i()}},Rvt=(t,e,n,i,r)=>()=>{const s=new WeakMap,a=async(o,c)=>{let l=n(o);const u=Ou(l,c);if(!u){const h={Q:l.Q.value,channelCount:l.channelCount,channelCountMode:l.channelCountMode,channelInterpretation:l.channelInterpretation,detune:l.detune.value,frequency:l.frequency.value,gain:l.gain.value,type:l.type};l=e(c,h)}return s.set(c,l),u?(await t(c,o.Q,l.Q),await t(c,o.detune,l.detune),await t(c,o.frequency,l.frequency),await t(c,o.gain,l.gain)):(await i(c,o.Q,l.Q),await i(c,o.detune,l.detune),await i(c,o.frequency,l.frequency),await i(c,o.gain,l.gain)),await r(o,c,l),l};return{render(o,c){const l=s.get(c);return l!==void 0?Promise.resolve(l):a(o,c)}}},Mvt=(t,e)=>(n,i)=>{const r=e.get(n);if(r!==void 0)return r;const s=t.get(n);if(s!==void 0)return s;try{const a=i();return a instanceof Promise?(t.set(n,a),a.catch(()=>!1).then(o=>(t.delete(n),e.set(n,o),o))):(e.set(n,a),a)}catch{return e.set(n,!1),!1}},Ovt={channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:6},Nvt=(t,e,n,i,r)=>class extends t{constructor(a,o){const c=i(a),l={...Ovt,...o},u=n(c,l),h=r(c)?e():null;super(a,!1,u,h)}},Ivt=(t,e,n)=>()=>{const i=new WeakMap,r=async(s,a)=>{let o=e(s);if(!Ou(o,a)){const l={channelCount:o.channelCount,channelCountMode:o.channelCountMode,channelInterpretation:o.channelInterpretation,numberOfInputs:o.numberOfInputs};o=t(a,l)}return i.set(a,o),await n(s,a,o),o};return{render(s,a){const o=i.get(a);return o!==void 0?Promise.resolve(o):r(s,a)}}},kvt={channelCount:6,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:6},Pvt=(t,e,n,i,r,s)=>class extends t{constructor(o,c){const l=i(o),u=s({...kvt,...c}),h=n(l,u),d=r(l)?e():null;super(o,!1,h,d)}},Dvt=(t,e,n)=>()=>{const i=new WeakMap,r=async(s,a)=>{let o=e(s);if(!Ou(o,a)){const l={channelCount:o.channelCount,channelCountMode:o.channelCountMode,channelInterpretation:o.channelInterpretation,numberOfOutputs:o.numberOfOutputs};o=t(a,l)}return i.set(a,o),await n(s,a,o),o};return{render(s,a){const o=i.get(a);return o!==void 0?Promise.resolve(o):r(s,a)}}},Lvt=t=>(e,n,i)=>t(n,e,i),Uvt=t=>(e,n,i=0,r=0)=>{const s=e[i];if(s===void 0)throw t();return EB(n)?s.connect(n,0,r):s.connect(n,0)},Bvt=t=>(e,n)=>{const i=t(e,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}),r=e.createBuffer(1,2,44100);return i.buffer=r,i.loop=!0,i.connect(n),i.start(),()=>{i.stop(),i.disconnect(n)}},Fvt={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",offset:1},zvt=(t,e,n,i,r,s,a)=>class extends t{constructor(c,l){const u=r(c),h={...Fvt,...l},d=i(u,h),f=s(u),p=f?n():null;super(c,!1,d,p),this._constantSourceNodeRenderer=p,this._nativeConstantSourceNode=d,this._offset=e(this,f,d.offset,sh,ed),this._onended=null}get offset(){return this._offset}get onended(){return this._onended}set onended(c){const l=typeof c=="function"?a(this,c):null;this._nativeConstantSourceNode.onended=l;const u=this._nativeConstantSourceNode.onended;this._onended=u!==null&&u===l?c:u}start(c=0){if(this._nativeConstantSourceNode.start(c),this._constantSourceNodeRenderer!==null&&(this._constantSourceNodeRenderer.start=c),this.context.state!=="closed"){DA(this);const l=()=>{this._nativeConstantSourceNode.removeEventListener("ended",l),y_(this)&&Yk(this)};this._nativeConstantSourceNode.addEventListener("ended",l)}}stop(c=0){this._nativeConstantSourceNode.stop(c),this._constantSourceNodeRenderer!==null&&(this._constantSourceNodeRenderer.stop=c)}},jvt=(t,e,n,i,r)=>()=>{const s=new WeakMap;let a=null,o=null;const c=async(l,u)=>{let h=n(l);const d=Ou(h,u);if(!d){const f={channelCount:h.channelCount,channelCountMode:h.channelCountMode,channelInterpretation:h.channelInterpretation,offset:h.offset.value};h=e(u,f),a!==null&&h.start(a),o!==null&&h.stop(o)}return s.set(u,h),d?await t(u,l.offset,h.offset):await i(u,l.offset,h.offset),await r(l,u,h),h};return{set start(l){a=l},set stop(l){o=l},render(l,u){const h=s.get(u);return h!==void 0?Promise.resolve(h):c(l,u)}}},Hvt=t=>e=>(t[0]=e,t[0]),Vvt={buffer:null,channelCount:2,channelCountMode:"clamped-max",channelInterpretation:"speakers",disableNormalization:!1},Gvt=(t,e,n,i,r,s)=>class extends t{constructor(o,c){const l=i(o),u={...Vvt,...c},h=n(l,u),f=r(l)?e():null;super(o,!1,h,f),this._isBufferNullified=!1,this._nativeConvolverNode=h,u.buffer!==null&&s(this,u.buffer.duration)}get buffer(){return this._isBufferNullified?null:this._nativeConvolverNode.buffer}set buffer(o){if(this._nativeConvolverNode.buffer=o,o===null&&this._nativeConvolverNode.buffer!==null){const c=this._nativeConvolverNode.context;this._nativeConvolverNode.buffer=c.createBuffer(1,1,c.sampleRate),this._isBufferNullified=!0,s(this,0)}else this._isBufferNullified=!1,s(this,this._nativeConvolverNode.buffer===null?0:this._nativeConvolverNode.buffer.duration)}get normalize(){return this._nativeConvolverNode.normalize}set normalize(o){this._nativeConvolverNode.normalize=o}},qvt=(t,e,n)=>()=>{const i=new WeakMap,r=async(s,a)=>{let o=e(s);if(!Ou(o,a)){const l={buffer:o.buffer,channelCount:o.channelCount,channelCountMode:o.channelCountMode,channelInterpretation:o.channelInterpretation,disableNormalization:!o.normalize};o=t(a,l)}return i.set(a,o),ER(o)?await n(s,a,o.inputs[0]):await n(s,a,o),o};return{render(s,a){const o=i.get(a);return o!==void 0?Promise.resolve(o):r(s,a)}}},$vt=(t,e)=>(n,i,r)=>{if(e===null)throw new Error("Missing the native OfflineAudioContext constructor.");try{return new e(n,i,r)}catch(s){throw s.name==="SyntaxError"?t():s}},Wvt=()=>new DOMException("","DataCloneError"),eae=t=>{const{port1:e,port2:n}=new MessageChannel;return new Promise(i=>{const r=()=>{n.onmessage=null,e.close(),n.close(),i()};n.onmessage=()=>r();try{e.postMessage(t,[t])}catch{}finally{r()}})},Yvt=(t,e,n,i,r,s,a,o,c,l,u)=>(h,d)=>{const f=a(h)?h:s(h);if(r.has(d)){const p=n();return Promise.reject(p)}try{r.add(d)}catch{}return e(c,()=>c(f))?f.decodeAudioData(d).then(p=>(eae(d).catch(()=>{}),e(o,()=>o(p))||u(p),t.add(p),p)):new Promise((p,g)=>{const _=async()=>{try{await eae(d)}catch{}},v=b=>{g(b),_()};try{f.decodeAudioData(d,b=>{typeof b.copyFromChannel!="function"&&(l(b),dX(b)),t.add(b),_().then(()=>p(b))},b=>{v(b===null?i():b)})}catch(b){v(b)}})},Kvt=(t,e,n,i,r,s,a,o)=>(c,l)=>{const u=e.get(c);if(u===void 0)throw new Error("Missing the expected cycle count.");const h=s(c.context),d=o(h);if(u===l){if(e.delete(c),!d&&a(c)){const f=i(c),{outputs:p}=n(c);for(const g of p)if(Xk(g)){const _=i(g[0]);t(f,_,g[1],g[2])}else{const _=r(g[0]);f.connect(_,g[1])}}}else e.set(c,u-l)},Xvt={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",delayTime:0,maxDelayTime:1},Zvt=(t,e,n,i,r,s,a)=>class extends t{constructor(c,l){const u=r(c),h={...Xvt,...l},d=i(u,h),f=s(u),p=f?n(h.maxDelayTime):null;super(c,!1,d,p),this._delayTime=e(this,f,d.delayTime),a(this,h.maxDelayTime)}get delayTime(){return this._delayTime}},Jvt=(t,e,n,i,r)=>s=>{const a=new WeakMap,o=async(c,l)=>{let u=n(c);const h=Ou(u,l);if(!h){const d={channelCount:u.channelCount,channelCountMode:u.channelCountMode,channelInterpretation:u.channelInterpretation,delayTime:u.delayTime.value,maxDelayTime:s};u=e(l,d)}return a.set(l,u),h?await t(l,c.delayTime,u.delayTime):await i(l,c.delayTime,u.delayTime),await r(c,l,u),u};return{render(c,l){const u=a.get(l);return u!==void 0?Promise.resolve(u):o(c,l)}}},Qvt=t=>(e,n,i,r)=>t(e[r],s=>s[0]===n&&s[1]===i),e_t=t=>(e,n)=>{t(e).delete(n)},t_t=t=>"delayTime"in t,n_t=(t,e,n)=>function i(r,s){const a=_B(s)?s:n(t,s);if(t_t(a))return[];if(r[0]===a)return[r];if(r.includes(a))return[];const{outputs:o}=e(a);return Array.from(o).map(c=>i([...r,a],c[0])).reduce((c,l)=>c.concat(l),[])},y2=(t,e,n)=>{const i=e[n];if(i===void 0)throw t();return i},i_t=t=>(e,n=void 0,i=void 0,r=0)=>n===void 0?e.forEach(s=>s.disconnect()):typeof n=="number"?y2(t,e,n).disconnect():EB(n)?i===void 0?e.forEach(s=>s.disconnect(n)):r===void 0?y2(t,e,i).disconnect(n,0):y2(t,e,i).disconnect(n,0,r):i===void 0?e.forEach(s=>s.disconnect(n)):y2(t,e,i).disconnect(n,0),r_t={attack:.003,channelCount:2,channelCountMode:"clamped-max",channelInterpretation:"speakers",knee:30,ratio:12,release:.25,threshold:-24},s_t=(t,e,n,i,r,s,a,o)=>class extends t{constructor(l,u){const h=s(l),d={...r_t,...u},f=i(h,d),p=a(h),g=p?n():null;super(l,!1,f,g),this._attack=e(this,p,f.attack),this._knee=e(this,p,f.knee),this._nativeDynamicsCompressorNode=f,this._ratio=e(this,p,f.ratio),this._release=e(this,p,f.release),this._threshold=e(this,p,f.threshold),o(this,.006)}get attack(){return this._attack}get channelCount(){return this._nativeDynamicsCompressorNode.channelCount}set channelCount(l){const u=this._nativeDynamicsCompressorNode.channelCount;if(this._nativeDynamicsCompressorNode.channelCount=l,l>2)throw this._nativeDynamicsCompressorNode.channelCount=u,r()}get channelCountMode(){return this._nativeDynamicsCompressorNode.channelCountMode}set channelCountMode(l){const u=this._nativeDynamicsCompressorNode.channelCountMode;if(this._nativeDynamicsCompressorNode.channelCountMode=l,l==="max")throw this._nativeDynamicsCompressorNode.channelCountMode=u,r()}get knee(){return this._knee}get ratio(){return this._ratio}get reduction(){return typeof this._nativeDynamicsCompressorNode.reduction.value=="number"?this._nativeDynamicsCompressorNode.reduction.value:this._nativeDynamicsCompressorNode.reduction}get release(){return this._release}get threshold(){return this._threshold}},a_t=(t,e,n,i,r)=>()=>{const s=new WeakMap,a=async(o,c)=>{let l=n(o);const u=Ou(l,c);if(!u){const h={attack:l.attack.value,channelCount:l.channelCount,channelCountMode:l.channelCountMode,channelInterpretation:l.channelInterpretation,knee:l.knee.value,ratio:l.ratio.value,release:l.release.value,threshold:l.threshold.value};l=e(c,h)}return s.set(c,l),u?(await t(c,o.attack,l.attack),await t(c,o.knee,l.knee),await t(c,o.ratio,l.ratio),await t(c,o.release,l.release),await t(c,o.threshold,l.threshold)):(await i(c,o.attack,l.attack),await i(c,o.knee,l.knee),await i(c,o.ratio,l.ratio),await i(c,o.release,l.release),await i(c,o.threshold,l.threshold)),await r(o,c,l),l};return{render(o,c){const l=s.get(c);return l!==void 0?Promise.resolve(l):a(o,c)}}},o_t=()=>new DOMException("","EncodingError"),c_t=t=>e=>new Promise((n,i)=>{if(t===null){i(new SyntaxError);return}const r=t.document.head;if(r===null)i(new SyntaxError);else{const s=t.document.createElement("script"),a=new Blob([e],{type:"application/javascript"}),o=URL.createObjectURL(a),c=t.onerror,l=()=>{t.onerror=c,URL.revokeObjectURL(o)};t.onerror=(u,h,d,f,p)=>{if(h===o||h===t.location.href&&d===1&&f===1)return l(),i(p),!1;if(c!==null)return c(u,h,d,f,p)},s.onerror=()=>{l(),i(new SyntaxError)},s.onload=()=>{l(),n()},s.src=o,s.type="module",r.appendChild(s)}}),l_t=t=>class{constructor(n){this._nativeEventTarget=n,this._listeners=new WeakMap}addEventListener(n,i,r){if(i!==null){let s=this._listeners.get(i);s===void 0&&(s=t(this,i),typeof i=="function"&&this._listeners.set(i,s)),this._nativeEventTarget.addEventListener(n,s,r)}}dispatchEvent(n){return this._nativeEventTarget.dispatchEvent(n)}removeEventListener(n,i,r){const s=i===null?void 0:this._listeners.get(i);this._nativeEventTarget.removeEventListener(n,s===void 0?null:s,r)}},u_t=t=>(e,n,i)=>{Object.defineProperties(t,{currentFrame:{configurable:!0,get(){return Math.round(e*n)}},currentTime:{configurable:!0,get(){return e}}});try{return i()}finally{t!==null&&(delete t.currentFrame,delete t.currentTime)}},h_t=t=>async e=>{try{const n=await fetch(e);if(n.ok)return[await n.text(),n.url]}catch{}throw t()},d_t={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",gain:1},f_t=(t,e,n,i,r,s)=>class extends t{constructor(o,c){const l=r(o),u={...d_t,...c},h=i(l,u),d=s(l),f=d?n():null;super(o,!1,h,f),this._gain=e(this,d,h.gain,sh,ed)}get gain(){return this._gain}},p_t=(t,e,n,i,r)=>()=>{const s=new WeakMap,a=async(o,c)=>{let l=n(o);const u=Ou(l,c);if(!u){const h={channelCount:l.channelCount,channelCountMode:l.channelCountMode,channelInterpretation:l.channelInterpretation,gain:l.gain.value};l=e(c,h)}return s.set(c,l),u?await t(c,o.gain,l.gain):await i(c,o.gain,l.gain),await r(o,c,l),l};return{render(o,c){const l=s.get(c);return l!==void 0?Promise.resolve(l):a(o,c)}}},m_t=(t,e)=>n=>e(t,n),g_t=t=>e=>{const n=t(e);if(n.renderer===null)throw new Error("Missing the renderer of the given AudioNode in the audio graph.");return n.renderer},v_t=t=>e=>{var n;return(n=t.get(e))!==null&&n!==void 0?n:0},__t=t=>e=>{const n=t(e);if(n.renderer===null)throw new Error("Missing the renderer of the given AudioParam in the audio graph.");return n.renderer},y_t=t=>e=>t.get(e),Rl=()=>new DOMException("","InvalidStateError"),b_t=t=>e=>{const n=t.get(e);if(n===void 0)throw Rl();return n},E_t=(t,e)=>n=>{let i=t.get(n);if(i!==void 0)return i;if(e===null)throw new Error("Missing the native OfflineAudioContext constructor.");return i=new e(1,1,44100),t.set(n,i),i},S_t=t=>e=>{const n=t.get(e);if(n===void 0)throw new Error("The context has no set of AudioWorkletNodes.");return n},x8=()=>new DOMException("","InvalidAccessError"),T_t=t=>{t.getFrequencyResponse=(e=>(n,i,r)=>{if(n.length!==i.length||i.length!==r.length)throw x8();return e.call(t,n,i,r)})(t.getFrequencyResponse)},x_t={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers"},w_t=(t,e,n,i,r,s)=>class extends t{constructor(o,c){const l=i(o),u=r(l),h={...x_t,...c},d=e(l,u?null:o.baseLatency,h),f=u?n(h.feedback,h.feedforward):null;super(o,!1,d,f),T_t(d),this._nativeIIRFilterNode=d,s(this,1)}getFrequencyResponse(o,c,l){return this._nativeIIRFilterNode.getFrequencyResponse(o,c,l)}},oEe=(t,e,n,i,r,s,a,o,c,l,u)=>{const h=l.length;let d=o;for(let f=0;f<h;f+=1){let p=n[0]*l[f];for(let g=1;g<r;g+=1){const _=d-g&c-1;p+=n[g]*s[_],p-=t[g]*a[_]}for(let g=r;g<i;g+=1)p+=n[g]*s[d-g&c-1];for(let g=r;g<e;g+=1)p-=t[g]*a[d-g&c-1];s[d]=l[f],a[d]=p,d=d+1&c-1,u[f]=p}return d},C_t=(t,e,n,i)=>{const r=n instanceof Float64Array?n:new Float64Array(n),s=i instanceof Float64Array?i:new Float64Array(i),a=r.length,o=s.length,c=Math.min(a,o);if(r[0]!==1){for(let p=0;p<a;p+=1)s[p]/=r[0];for(let p=1;p<o;p+=1)r[p]/=r[0]}const l=32,u=new Float32Array(l),h=new Float32Array(l),d=e.createBuffer(t.numberOfChannels,t.length,t.sampleRate),f=t.numberOfChannels;for(let p=0;p<f;p+=1){const g=t.getChannelData(p),_=d.getChannelData(p);u.fill(0),h.fill(0),oEe(r,a,s,o,c,u,h,0,l,g,_)}return d},A_t=(t,e,n,i,r)=>(s,a)=>{const o=new WeakMap;let c=null;const l=async(u,h)=>{let d=null,f=e(u);const p=Ou(f,h);if(h.createIIRFilter===void 0?d=t(h,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}):p||(f=h.createIIRFilter(a,s)),o.set(h,d===null?f:d),d!==null){if(c===null){if(n===null)throw new Error("Missing the native OfflineAudioContext constructor.");const _=new n(u.context.destination.channelCount,u.context.length,h.sampleRate);c=(async()=>{await i(u,_,_.destination);const v=await r(_);return C_t(v,h,s,a)})()}const g=await c;return d.buffer=g,d.start(0),d}return await i(u,h,f),f};return{render(u,h){const d=o.get(h);return d!==void 0?Promise.resolve(d):l(u,h)}}},R_t=(t,e,n,i,r,s)=>a=>(o,c)=>{const l=t.get(o);if(l===void 0){if(!a&&s(o)){const u=i(o),{outputs:h}=n(o);for(const d of h)if(Xk(d)){const f=i(d[0]);e(u,f,d[1],d[2])}else{const f=r(d[0]);u.disconnect(f,d[1])}}t.set(o,c)}else t.set(o,l+c)},M_t=(t,e)=>n=>{const i=t.get(n);return e(i)||e(n)},O_t=(t,e)=>n=>t.has(n)||e(n),N_t=(t,e)=>n=>t.has(n)||e(n),I_t=(t,e)=>n=>{const i=t.get(n);return e(i)||e(n)},k_t=t=>e=>t!==null&&e instanceof t,P_t=t=>e=>t!==null&&typeof t.AudioNode=="function"&&e instanceof t.AudioNode,D_t=t=>e=>t!==null&&typeof t.AudioParam=="function"&&e instanceof t.AudioParam,L_t=(t,e)=>n=>t(n)||e(n),U_t=t=>e=>t!==null&&e instanceof t,B_t=t=>t!==null&&t.isSecureContext,F_t=(t,e,n,i)=>class extends t{constructor(s,a){const o=n(s),c=e(o,a);if(i(o))throw TypeError();super(s,!0,c,null),this._nativeMediaElementAudioSourceNode=c}get mediaElement(){return this._nativeMediaElementAudioSourceNode.mediaElement}},z_t={channelCount:2,channelCountMode:"explicit",channelInterpretation:"speakers"},j_t=(t,e,n,i)=>class extends t{constructor(s,a){const o=n(s);if(i(o))throw new TypeError;const c={...z_t,...a},l=e(o,c);super(s,!1,l,null),this._nativeMediaStreamAudioDestinationNode=l}get stream(){return this._nativeMediaStreamAudioDestinationNode.stream}},H_t=(t,e,n,i)=>class extends t{constructor(s,a){const o=n(s),c=e(o,a);if(i(o))throw new TypeError;super(s,!0,c,null),this._nativeMediaStreamAudioSourceNode=c}get mediaStream(){return this._nativeMediaStreamAudioSourceNode.mediaStream}},V_t=(t,e,n)=>class extends t{constructor(r,s){const a=n(r),o=e(a,s);super(r,!0,o,null)}},G_t=(t,e,n,i,r,s)=>class extends n{constructor(o,c){super(o),this._nativeContext=o,S8.set(this,o),i(o)&&r.set(o,new Set),this._destination=new t(this,c),this._listener=e(this,o),this._onstatechange=null}get currentTime(){return this._nativeContext.currentTime}get destination(){return this._destination}get listener(){return this._listener}get onstatechange(){return this._onstatechange}set onstatechange(o){const c=typeof o=="function"?s(this,o):null;this._nativeContext.onstatechange=c;const l=this._nativeContext.onstatechange;this._onstatechange=l!==null&&l===c?o:l}get sampleRate(){return this._nativeContext.sampleRate}get state(){return this._nativeContext.state}},fI=t=>{const e=new Uint32Array([1179011410,40,1163280727,544501094,16,131073,44100,176400,1048580,1635017060,4,0]);try{const n=t.decodeAudioData(e.buffer,()=>{});return n===void 0?!1:(n.catch(()=>{}),!0)}catch{}return!1},q_t=(t,e)=>(n,i,r)=>{const s=new Set;return n.connect=(a=>(o,c=0,l=0)=>{const u=s.size===0;if(e(o))return a.call(n,o,c,l),t(s,[o,c,l],h=>h[0]===o&&h[1]===c&&h[2]===l,!0),u&&i(),o;a.call(n,o,c),t(s,[o,c],h=>h[0]===o&&h[1]===c,!0),u&&i()})(n.connect),n.disconnect=(a=>(o,c,l)=>{const u=s.size>0;if(o===void 0)a.apply(n),s.clear();else if(typeof o=="number"){a.call(n,o);for(const d of s)d[1]===o&&s.delete(d)}else{e(o)?a.call(n,o,c,l):a.call(n,o,c);for(const d of s)d[0]===o&&(c===void 0||d[1]===c)&&(l===void 0||d[2]===l)&&s.delete(d)}const h=s.size===0;u&&h&&r()})(n.disconnect),n},Fa=(t,e,n)=>{const i=e[n];i!==void 0&&i!==t[n]&&(t[n]=i)},tl=(t,e)=>{Fa(t,e,"channelCount"),Fa(t,e,"channelCountMode"),Fa(t,e,"channelInterpretation")},tae=t=>typeof t.getFloatTimeDomainData=="function",$_t=t=>{t.getFloatTimeDomainData=e=>{const n=new Uint8Array(e.length);t.getByteTimeDomainData(n);const i=Math.max(n.length,t.fftSize);for(let r=0;r<i;r+=1)e[r]=(n[r]-128)*.0078125;return e}},W_t=(t,e)=>(n,i)=>{const r=n.createAnalyser();if(tl(r,i),!(i.maxDecibels>i.minDecibels))throw e();return Fa(r,i,"fftSize"),Fa(r,i,"maxDecibels"),Fa(r,i,"minDecibels"),Fa(r,i,"smoothingTimeConstant"),t(tae,()=>tae(r))||$_t(r),r},Y_t=t=>t===null?null:t.hasOwnProperty("AudioBuffer")?t.AudioBuffer:null,Oo=(t,e,n)=>{const i=e[n];i!==void 0&&i!==t[n].value&&(t[n].value=i)},K_t=t=>{t.start=(e=>{let n=!1;return(i=0,r=0,s)=>{if(n)throw Rl();e.call(t,i,r,s),n=!0}})(t.start)},mX=t=>{t.start=(e=>(n=0,i=0,r)=>{if(typeof r=="number"&&r<0||i<0||n<0)throw new RangeError("The parameters can't be negative.");e.call(t,n,i,r)})(t.start)},gX=t=>{t.stop=(e=>(n=0)=>{if(n<0)throw new RangeError("The parameter can't be negative.");e.call(t,n)})(t.stop)},X_t=(t,e,n,i,r,s,a,o,c,l,u)=>(h,d)=>{const f=h.createBufferSource();return tl(f,d),Oo(f,d,"playbackRate"),Fa(f,d,"buffer"),Fa(f,d,"loop"),Fa(f,d,"loopEnd"),Fa(f,d,"loopStart"),e(n,()=>n(h))||K_t(f),e(i,()=>i(h))||c(f),e(r,()=>r(h))||l(f,h),e(s,()=>s(h))||mX(f),e(a,()=>a(h))||u(f,h),e(o,()=>o(h))||gX(f),t(h,f),f},Z_t=t=>t===null?null:t.hasOwnProperty("AudioContext")?t.AudioContext:t.hasOwnProperty("webkitAudioContext")?t.webkitAudioContext:null,J_t=(t,e)=>(n,i,r)=>{const s=n.destination;if(s.channelCount!==i)try{s.channelCount=i}catch{}r&&s.channelCountMode!=="explicit"&&(s.channelCountMode="explicit"),s.maxChannelCount===0&&Object.defineProperty(s,"maxChannelCount",{value:i});const a=t(n,{channelCount:i,channelCountMode:s.channelCountMode,channelInterpretation:s.channelInterpretation,gain:1});return e(a,"channelCount",o=>()=>o.call(a),o=>c=>{o.call(a,c);try{s.channelCount=c}catch(l){if(c>s.maxChannelCount)throw l}}),e(a,"channelCountMode",o=>()=>o.call(a),o=>c=>{o.call(a,c),s.channelCountMode=c}),e(a,"channelInterpretation",o=>()=>o.call(a),o=>c=>{o.call(a,c),s.channelInterpretation=c}),Object.defineProperty(a,"maxChannelCount",{get:()=>s.maxChannelCount}),a.connect(s),a},Q_t=t=>t===null?null:t.hasOwnProperty("AudioWorkletNode")?t.AudioWorkletNode:null,eyt=t=>{const{port1:e}=new MessageChannel;try{e.postMessage(t)}finally{e.close()}},tyt=(t,e,n,i,r)=>(s,a,o,c,l,u)=>{if(o!==null)try{const h=new o(s,c,u),d=new Map;let f=null;if(Object.defineProperties(h,{channelCount:{get:()=>u.channelCount,set:()=>{throw t()}},channelCountMode:{get:()=>"explicit",set:()=>{throw t()}},onprocessorerror:{get:()=>f,set:p=>{typeof f=="function"&&h.removeEventListener("processorerror",f),f=typeof p=="function"?p:null,typeof f=="function"&&h.addEventListener("processorerror",f)}}}),h.addEventListener=(p=>(...g)=>{if(g[0]==="processorerror"){const _=typeof g[1]=="function"?g[1]:typeof g[1]=="object"&&g[1]!==null&&typeof g[1].handleEvent=="function"?g[1].handleEvent:null;if(_!==null){const v=d.get(g[1]);v!==void 0?g[1]=v:(g[1]=b=>{b.type==="error"?(Object.defineProperties(b,{type:{value:"processorerror"}}),_(b)):_(new ErrorEvent(g[0],{...b}))},d.set(_,g[1]))}}return p.call(h,"error",g[1],g[2]),p.call(h,...g)})(h.addEventListener),h.removeEventListener=(p=>(...g)=>{if(g[0]==="processorerror"){const _=d.get(g[1]);_!==void 0&&(d.delete(g[1]),g[1]=_)}return p.call(h,"error",g[1],g[2]),p.call(h,g[0],g[1],g[2])})(h.removeEventListener),u.numberOfOutputs!==0){const p=n(s,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});return h.connect(p).connect(s.destination),r(h,()=>p.disconnect(),()=>p.connect(s.destination))}return h}catch(h){throw h.code===11?i():h}if(l===void 0)throw i();return eyt(u),e(s,a,l,u)},cEe=(t,e)=>t===null?512:Math.max(512,Math.min(16384,Math.pow(2,Math.round(Math.log2(t*e))))),nyt=t=>new Promise((e,n)=>{const{port1:i,port2:r}=new MessageChannel;i.onmessage=({data:s})=>{i.close(),r.close(),e(s)},i.onmessageerror=({data:s})=>{i.close(),r.close(),n(s)},r.postMessage(t)}),iyt=async(t,e)=>{const n=await nyt(e);return new t(n)},ryt=(t,e,n,i)=>{let r=$$.get(t);r===void 0&&(r=new WeakMap,$$.set(t,r));const s=iyt(n,i);return r.set(e,s),s},syt=(t,e,n,i,r,s,a,o,c,l,u,h,d)=>(f,p,g,_)=>{if(_.numberOfInputs===0&&_.numberOfOutputs===0)throw c();const v=Array.isArray(_.outputChannelCount)?_.outputChannelCount:Array.from(_.outputChannelCount);if(v.some(ze=>ze<1))throw c();if(v.length!==_.numberOfOutputs)throw e();if(_.channelCountMode!=="explicit")throw c();const b=_.channelCount*_.numberOfInputs,S=v.reduce((ze,Le)=>ze+Le,0),x=g.parameterDescriptors===void 0?0:g.parameterDescriptors.length;if(b+x>6||S>6)throw c();const M=new MessageChannel,R=[],I=[];for(let ze=0;ze<_.numberOfInputs;ze+=1)R.push(a(f,{channelCount:_.channelCount,channelCountMode:_.channelCountMode,channelInterpretation:_.channelInterpretation,gain:1})),I.push(r(f,{channelCount:_.channelCount,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:_.channelCount}));const k=[];if(g.parameterDescriptors!==void 0)for(const{defaultValue:ze,maxValue:Le,minValue:rt,name:dt}of g.parameterDescriptors){const pt=s(f,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:_.parameterData[dt]!==void 0?_.parameterData[dt]:ze===void 0?0:ze});Object.defineProperties(pt.offset,{defaultValue:{get:()=>ze===void 0?0:ze},maxValue:{get:()=>Le===void 0?sh:Le},minValue:{get:()=>rt===void 0?ed:rt}}),k.push(pt)}const P=i(f,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:Math.max(1,b+x)}),U=cEe(p,f.sampleRate),V=o(f,U,b+x,Math.max(1,S)),$=r(f,{channelCount:Math.max(1,S),channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:Math.max(1,S)}),q=[];for(let ze=0;ze<_.numberOfOutputs;ze+=1)q.push(i(f,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:v[ze]}));for(let ze=0;ze<_.numberOfInputs;ze+=1){R[ze].connect(I[ze]);for(let Le=0;Le<_.channelCount;Le+=1)I[ze].connect(P,Le,ze*_.channelCount+Le)}const Y=new sEe(g.parameterDescriptors===void 0?[]:g.parameterDescriptors.map(({name:ze},Le)=>{const rt=k[Le];return rt.connect(P,0,b+Le),rt.start(0),[ze,rt.offset]}));P.connect(V);let te=_.channelInterpretation,G=null;const J=_.numberOfOutputs===0?[V]:q,K={get bufferSize(){return U},get channelCount(){return _.channelCount},set channelCount(ze){throw n()},get channelCountMode(){return _.channelCountMode},set channelCountMode(ze){throw n()},get channelInterpretation(){return te},set channelInterpretation(ze){for(const Le of R)Le.channelInterpretation=ze;te=ze},get context(){return V.context},get inputs(){return R},get numberOfInputs(){return _.numberOfInputs},get numberOfOutputs(){return _.numberOfOutputs},get onprocessorerror(){return G},set onprocessorerror(ze){typeof G=="function"&&K.removeEventListener("processorerror",G),G=typeof ze=="function"?ze:null,typeof G=="function"&&K.addEventListener("processorerror",G)},get parameters(){return Y},get port(){return M.port2},addEventListener(...ze){return V.addEventListener(ze[0],ze[1],ze[2])},connect:t.bind(null,J),disconnect:l.bind(null,J),dispatchEvent(...ze){return V.dispatchEvent(ze[0])},removeEventListener(...ze){return V.removeEventListener(ze[0],ze[1],ze[2])}},X=new Map;M.port1.addEventListener=(ze=>(...Le)=>{if(Le[0]==="message"){const rt=typeof Le[1]=="function"?Le[1]:typeof Le[1]=="object"&&Le[1]!==null&&typeof Le[1].handleEvent=="function"?Le[1].handleEvent:null;if(rt!==null){const dt=X.get(Le[1]);dt!==void 0?Le[1]=dt:(Le[1]=pt=>{u(f.currentTime,f.sampleRate,()=>rt(pt))},X.set(rt,Le[1]))}}return ze.call(M.port1,Le[0],Le[1],Le[2])})(M.port1.addEventListener),M.port1.removeEventListener=(ze=>(...Le)=>{if(Le[0]==="message"){const rt=X.get(Le[1]);rt!==void 0&&(X.delete(Le[1]),Le[1]=rt)}return ze.call(M.port1,Le[0],Le[1],Le[2])})(M.port1.removeEventListener);let ae=null;Object.defineProperty(M.port1,"onmessage",{get:()=>ae,set:ze=>{typeof ae=="function"&&M.port1.removeEventListener("message",ae),ae=typeof ze=="function"?ze:null,typeof ae=="function"&&(M.port1.addEventListener("message",ae),M.port1.start())}}),g.prototype.port=M.port1;let ce=null;ryt(f,K,g,_).then(ze=>ce=ze);const Fe=TB(_.numberOfInputs,_.channelCount),Te=TB(_.numberOfOutputs,v),Re=g.parameterDescriptors===void 0?[]:g.parameterDescriptors.reduce((ze,{name:Le})=>({...ze,[Le]:new Float32Array(128)}),{});let ge=!0;const _e=()=>{_.numberOfOutputs>0&&V.disconnect($);for(let ze=0,Le=0;ze<_.numberOfOutputs;ze+=1){const rt=q[ze];for(let dt=0;dt<v[ze];dt+=1)$.disconnect(rt,Le+dt,dt);Le+=v[ze]}},ke=new Map;V.onaudioprocess=({inputBuffer:ze,outputBuffer:Le})=>{if(ce!==null){const rt=h(K);for(let dt=0;dt<U;dt+=128){for(let pt=0;pt<_.numberOfInputs;pt+=1)for(let bt=0;bt<_.channelCount;bt+=1)SB(ze,Fe[pt],bt,bt,dt);g.parameterDescriptors!==void 0&&g.parameterDescriptors.forEach(({name:pt},bt)=>{SB(ze,Re,pt,b+bt,dt)});for(let pt=0;pt<_.numberOfInputs;pt+=1)for(let bt=0;bt<v[pt];bt+=1)Te[pt][bt].byteLength===0&&(Te[pt][bt]=new Float32Array(128));try{const pt=Fe.map((we,he)=>{if(rt[he].size>0)return ke.set(he,U/128),we;const et=ke.get(he);return et===void 0?[]:(we.every(Et=>Et.every(ct=>ct===0))&&(et===1?ke.delete(he):ke.set(he,et-1)),we)});ge=u(f.currentTime+dt/f.sampleRate,f.sampleRate,()=>ce.process(pt,Te,Re));for(let we=0,he=0;we<_.numberOfOutputs;we+=1){for(let $e=0;$e<v[we];$e+=1)aEe(Le,Te[we],$e,he+$e,dt);he+=v[we]}}catch(pt){ge=!1,K.dispatchEvent(new ErrorEvent("processorerror",{colno:pt.colno,filename:pt.filename,lineno:pt.lineno,message:pt.message}))}if(!ge){for(let pt=0;pt<_.numberOfInputs;pt+=1){R[pt].disconnect(I[pt]);for(let bt=0;bt<_.channelCount;bt+=1)I[dt].disconnect(P,bt,pt*_.channelCount+bt)}if(g.parameterDescriptors!==void 0){const pt=g.parameterDescriptors.length;for(let bt=0;bt<pt;bt+=1){const we=k[bt];we.disconnect(P,0,b+bt),we.stop()}}P.disconnect(V),V.onaudioprocess=null,gt?_e():Se();break}}}};let gt=!1;const wt=a(f,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0}),ye=()=>V.connect(wt).connect(f.destination),Se=()=>{V.disconnect(wt),wt.disconnect()},Qe=()=>{if(ge){Se(),_.numberOfOutputs>0&&V.connect($);for(let ze=0,Le=0;ze<_.numberOfOutputs;ze+=1){const rt=q[ze];for(let dt=0;dt<v[ze];dt+=1)$.connect(rt,Le+dt,dt);Le+=v[ze]}}gt=!0},pe=()=>{ge&&(ye(),_e()),gt=!1};return ye(),d(K,Qe,pe)},lEe=(t,e)=>{const n=t.createBiquadFilter();return tl(n,e),Oo(n,e,"Q"),Oo(n,e,"detune"),Oo(n,e,"frequency"),Oo(n,e,"gain"),Fa(n,e,"type"),n},ayt=(t,e)=>(n,i)=>{const r=n.createChannelMerger(i.numberOfInputs);return t!==null&&t.name==="webkitAudioContext"&&e(n,r),tl(r,i),r},oyt=t=>{const e=t.numberOfOutputs;Object.defineProperty(t,"channelCount",{get:()=>e,set:n=>{if(n!==e)throw Rl()}}),Object.defineProperty(t,"channelCountMode",{get:()=>"explicit",set:n=>{if(n!=="explicit")throw Rl()}}),Object.defineProperty(t,"channelInterpretation",{get:()=>"discrete",set:n=>{if(n!=="discrete")throw Rl()}})},Zk=(t,e)=>{const n=t.createChannelSplitter(e.numberOfOutputs);return tl(n,e),oyt(n),n},cyt=(t,e,n,i,r)=>(s,a)=>{if(s.createConstantSource===void 0)return n(s,a);const o=s.createConstantSource();return tl(o,a),Oo(o,a,"offset"),e(i,()=>i(s))||mX(o),e(r,()=>r(s))||gX(o),t(s,o),o},SR=(t,e)=>(t.connect=e.connect.bind(e),t.disconnect=e.disconnect.bind(e),t),lyt=(t,e,n,i)=>(r,{offset:s,...a})=>{const o=r.createBuffer(1,2,44100),c=e(r,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}),l=n(r,{...a,gain:s}),u=o.getChannelData(0);u[0]=1,u[1]=1,c.buffer=o,c.loop=!0;const h={get bufferSize(){},get channelCount(){return l.channelCount},set channelCount(p){l.channelCount=p},get channelCountMode(){return l.channelCountMode},set channelCountMode(p){l.channelCountMode=p},get channelInterpretation(){return l.channelInterpretation},set channelInterpretation(p){l.channelInterpretation=p},get context(){return l.context},get inputs(){return[]},get numberOfInputs(){return c.numberOfInputs},get numberOfOutputs(){return l.numberOfOutputs},get offset(){return l.gain},get onended(){return c.onended},set onended(p){c.onended=p},addEventListener(...p){return c.addEventListener(p[0],p[1],p[2])},dispatchEvent(...p){return c.dispatchEvent(p[0])},removeEventListener(...p){return c.removeEventListener(p[0],p[1],p[2])},start(p=0){c.start.call(c,p)},stop(p=0){c.stop.call(c,p)}},d=()=>c.connect(l),f=()=>c.disconnect(l);return t(r,c),i(SR(h,l),d,f)},uyt=(t,e)=>(n,i)=>{const r=n.createConvolver();if(tl(r,i),i.disableNormalization===r.normalize&&(r.normalize=!i.disableNormalization),Fa(r,i,"buffer"),i.channelCount>2||(e(r,"channelCount",s=>()=>s.call(r),s=>a=>{if(a>2)throw t();return s.call(r,a)}),i.channelCountMode==="max"))throw t();return e(r,"channelCountMode",s=>()=>s.call(r),s=>a=>{if(a==="max")throw t();return s.call(r,a)}),r},uEe=(t,e)=>{const n=t.createDelay(e.maxDelayTime);return tl(n,e),Oo(n,e,"delayTime"),n},hyt=t=>(e,n)=>{const i=e.createDynamicsCompressor();if(tl(i,n),n.channelCount>2||n.channelCountMode==="max")throw t();return Oo(i,n,"attack"),Oo(i,n,"knee"),Oo(i,n,"ratio"),Oo(i,n,"release"),Oo(i,n,"threshold"),i},bd=(t,e)=>{const n=t.createGain();return tl(n,e),Oo(n,e,"gain"),n},dyt=t=>(e,n,i)=>{if(e.createIIRFilter===void 0)return t(e,n,i);const r=e.createIIRFilter(i.feedforward,i.feedback);return tl(r,i),r};function fyt(t,e){const n=e[0]*e[0]+e[1]*e[1];return[(t[0]*e[0]+t[1]*e[1])/n,(t[1]*e[0]-t[0]*e[1])/n]}function pyt(t,e){return[t[0]*e[0]-t[1]*e[1],t[0]*e[1]+t[1]*e[0]]}function nae(t,e){let n=[0,0];for(let i=t.length-1;i>=0;i-=1)n=pyt(n,e),n[0]+=t[i];return n}const myt=(t,e,n,i)=>(r,s,{channelCount:a,channelCountMode:o,channelInterpretation:c,feedback:l,feedforward:u})=>{const h=cEe(s,r.sampleRate),d=l instanceof Float64Array?l:new Float64Array(l),f=u instanceof Float64Array?u:new Float64Array(u),p=d.length,g=f.length,_=Math.min(p,g);if(p===0||p>20)throw i();if(d[0]===0)throw e();if(g===0||g>20)throw i();if(f[0]===0)throw e();if(d[0]!==1){for(let k=0;k<g;k+=1)f[k]/=d[0];for(let k=1;k<p;k+=1)d[k]/=d[0]}const v=n(r,h,a,a);v.channelCount=a,v.channelCountMode=o,v.channelInterpretation=c;const b=32,S=[],x=[],M=[];for(let k=0;k<a;k+=1){S.push(0);const P=new Float32Array(b),U=new Float32Array(b);P.fill(0),U.fill(0),x.push(P),M.push(U)}v.onaudioprocess=k=>{const P=k.inputBuffer,U=k.outputBuffer,V=P.numberOfChannels;for(let $=0;$<V;$+=1){const q=P.getChannelData($),Y=U.getChannelData($);S[$]=oEe(d,p,f,g,_,x[$],M[$],S[$],b,q,Y)}};const R=r.sampleRate/2;return SR({get bufferSize(){return h},get channelCount(){return v.channelCount},set channelCount(k){v.channelCount=k},get channelCountMode(){return v.channelCountMode},set channelCountMode(k){v.channelCountMode=k},get channelInterpretation(){return v.channelInterpretation},set channelInterpretation(k){v.channelInterpretation=k},get context(){return v.context},get inputs(){return[v]},get numberOfInputs(){return v.numberOfInputs},get numberOfOutputs(){return v.numberOfOutputs},addEventListener(...k){return v.addEventListener(k[0],k[1],k[2])},dispatchEvent(...k){return v.dispatchEvent(k[0])},getFrequencyResponse(k,P,U){if(k.length!==P.length||P.length!==U.length)throw t();const V=k.length;for(let $=0;$<V;$+=1){const q=-Math.PI*(k[$]/R),Y=[Math.cos(q),Math.sin(q)],te=nae(f,Y),G=nae(d,Y),J=fyt(te,G);P[$]=Math.sqrt(J[0]*J[0]+J[1]*J[1]),U[$]=Math.atan2(J[1],J[0])}},removeEventListener(...k){return v.removeEventListener(k[0],k[1],k[2])}},v)},gyt=(t,e)=>t.createMediaElementSource(e.mediaElement),vyt=(t,e)=>{const n=t.createMediaStreamDestination();return tl(n,e),n.numberOfOutputs===1&&Object.defineProperty(n,"numberOfOutputs",{get:()=>0}),n},_yt=(t,{mediaStream:e})=>{const n=e.getAudioTracks();n.sort((s,a)=>s.id<a.id?-1:s.id>a.id?1:0);const i=n.slice(0,1),r=t.createMediaStreamSource(new MediaStream(i));return Object.defineProperty(r,"mediaStream",{value:e}),r},yyt=(t,e)=>(n,{mediaStreamTrack:i})=>{if(typeof n.createMediaStreamTrackSource=="function")return n.createMediaStreamTrackSource(i);const r=new MediaStream([i]),s=n.createMediaStreamSource(r);if(i.kind!=="audio")throw t();if(e(n))throw new TypeError;return s},byt=t=>t===null?null:t.hasOwnProperty("OfflineAudioContext")?t.OfflineAudioContext:t.hasOwnProperty("webkitOfflineAudioContext")?t.webkitOfflineAudioContext:null,Eyt=(t,e,n,i,r,s)=>(a,o)=>{const c=a.createOscillator();return tl(c,o),Oo(c,o,"detune"),Oo(c,o,"frequency"),o.periodicWave!==void 0?c.setPeriodicWave(o.periodicWave):Fa(c,o,"type"),e(n,()=>n(a))||mX(c),e(i,()=>i(a))||s(c,a),e(r,()=>r(a))||gX(c),t(a,c),c},Syt=t=>(e,n)=>{const i=e.createPanner();return i.orientationX===void 0?t(e,n):(tl(i,n),Oo(i,n,"orientationX"),Oo(i,n,"orientationY"),Oo(i,n,"orientationZ"),Oo(i,n,"positionX"),Oo(i,n,"positionY"),Oo(i,n,"positionZ"),Fa(i,n,"coneInnerAngle"),Fa(i,n,"coneOuterAngle"),Fa(i,n,"coneOuterGain"),Fa(i,n,"distanceModel"),Fa(i,n,"maxDistance"),Fa(i,n,"panningModel"),Fa(i,n,"refDistance"),Fa(i,n,"rolloffFactor"),i)},Tyt=(t,e,n,i,r,s,a,o,c,l)=>(u,{coneInnerAngle:h,coneOuterAngle:d,coneOuterGain:f,distanceModel:p,maxDistance:g,orientationX:_,orientationY:v,orientationZ:b,panningModel:S,positionX:x,positionY:M,positionZ:R,refDistance:I,rolloffFactor:k,...P})=>{const U=u.createPanner();if(P.channelCount>2||P.channelCountMode==="max")throw a();tl(U,P);const V={channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete"},$=n(u,{...V,channelInterpretation:"speakers",numberOfInputs:6}),q=i(u,{...P,gain:1}),Y=i(u,{...V,gain:1}),te=i(u,{...V,gain:0}),G=i(u,{...V,gain:0}),J=i(u,{...V,gain:0}),K=i(u,{...V,gain:0}),X=i(u,{...V,gain:0}),ae=r(u,256,6,1),ce=s(u,{...V,curve:new Float32Array([1,1]),oversample:"none"});let Me=[_,v,b],Fe=[x,M,R];const Te=new Float32Array(1);ae.onaudioprocess=({inputBuffer:ke})=>{const gt=[c(ke,Te,0),c(ke,Te,1),c(ke,Te,2)];gt.some((ye,Se)=>ye!==Me[Se])&&(U.setOrientation(...gt),Me=gt);const wt=[c(ke,Te,3),c(ke,Te,4),c(ke,Te,5)];wt.some((ye,Se)=>ye!==Fe[Se])&&(U.setPosition(...wt),Fe=wt)},Object.defineProperty(te.gain,"defaultValue",{get:()=>0}),Object.defineProperty(G.gain,"defaultValue",{get:()=>0}),Object.defineProperty(J.gain,"defaultValue",{get:()=>0}),Object.defineProperty(K.gain,"defaultValue",{get:()=>0}),Object.defineProperty(X.gain,"defaultValue",{get:()=>0});const Re={get bufferSize(){},get channelCount(){return U.channelCount},set channelCount(ke){if(ke>2)throw a();q.channelCount=ke,U.channelCount=ke},get channelCountMode(){return U.channelCountMode},set channelCountMode(ke){if(ke==="max")throw a();q.channelCountMode=ke,U.channelCountMode=ke},get channelInterpretation(){return U.channelInterpretation},set channelInterpretation(ke){q.channelInterpretation=ke,U.channelInterpretation=ke},get coneInnerAngle(){return U.coneInnerAngle},set coneInnerAngle(ke){U.coneInnerAngle=ke},get coneOuterAngle(){return U.coneOuterAngle},set coneOuterAngle(ke){U.coneOuterAngle=ke},get coneOuterGain(){return U.coneOuterGain},set coneOuterGain(ke){if(ke<0||ke>1)throw e();U.coneOuterGain=ke},get context(){return U.context},get distanceModel(){return U.distanceModel},set distanceModel(ke){U.distanceModel=ke},get inputs(){return[q]},get maxDistance(){return U.maxDistance},set maxDistance(ke){if(ke<0)throw new RangeError;U.maxDistance=ke},get numberOfInputs(){return U.numberOfInputs},get numberOfOutputs(){return U.numberOfOutputs},get orientationX(){return Y.gain},get orientationY(){return te.gain},get orientationZ(){return G.gain},get panningModel(){return U.panningModel},set panningModel(ke){U.panningModel=ke},get positionX(){return J.gain},get positionY(){return K.gain},get positionZ(){return X.gain},get refDistance(){return U.refDistance},set refDistance(ke){if(ke<0)throw new RangeError;U.refDistance=ke},get rolloffFactor(){return U.rolloffFactor},set rolloffFactor(ke){if(ke<0)throw new RangeError;U.rolloffFactor=ke},addEventListener(...ke){return q.addEventListener(ke[0],ke[1],ke[2])},dispatchEvent(...ke){return q.dispatchEvent(ke[0])},removeEventListener(...ke){return q.removeEventListener(ke[0],ke[1],ke[2])}};h!==Re.coneInnerAngle&&(Re.coneInnerAngle=h),d!==Re.coneOuterAngle&&(Re.coneOuterAngle=d),f!==Re.coneOuterGain&&(Re.coneOuterGain=f),p!==Re.distanceModel&&(Re.distanceModel=p),g!==Re.maxDistance&&(Re.maxDistance=g),_!==Re.orientationX.value&&(Re.orientationX.value=_),v!==Re.orientationY.value&&(Re.orientationY.value=v),b!==Re.orientationZ.value&&(Re.orientationZ.value=b),S!==Re.panningModel&&(Re.panningModel=S),x!==Re.positionX.value&&(Re.positionX.value=x),M!==Re.positionY.value&&(Re.positionY.value=M),R!==Re.positionZ.value&&(Re.positionZ.value=R),I!==Re.refDistance&&(Re.refDistance=I),k!==Re.rolloffFactor&&(Re.rolloffFactor=k),(Me[0]!==1||Me[1]!==0||Me[2]!==0)&&U.setOrientation(...Me),(Fe[0]!==0||Fe[1]!==0||Fe[2]!==0)&&U.setPosition(...Fe);const ge=()=>{q.connect(U),t(q,ce,0,0),ce.connect(Y).connect($,0,0),ce.connect(te).connect($,0,1),ce.connect(G).connect($,0,2),ce.connect(J).connect($,0,3),ce.connect(K).connect($,0,4),ce.connect(X).connect($,0,5),$.connect(ae).connect(u.destination)},_e=()=>{q.disconnect(U),o(q,ce,0,0),ce.disconnect(Y),Y.disconnect($),ce.disconnect(te),te.disconnect($),ce.disconnect(G),G.disconnect($),ce.disconnect(J),J.disconnect($),ce.disconnect(K),K.disconnect($),ce.disconnect(X),X.disconnect($),$.disconnect(ae),ae.disconnect(u.destination)};return l(SR(Re,U),ge,_e)},xyt=t=>(e,{disableNormalization:n,imag:i,real:r})=>{const s=i instanceof Float32Array?i:new Float32Array(i),a=r instanceof Float32Array?r:new Float32Array(r),o=e.createPeriodicWave(a,s,{disableNormalization:n});if(Array.from(i).length<2)throw t();return o},Jk=(t,e,n,i)=>t.createScriptProcessor(e,n,i),wyt=(t,e)=>(n,i)=>{const r=i.channelCountMode;if(r==="clamped-max")throw e();if(n.createStereoPanner===void 0)return t(n,i);const s=n.createStereoPanner();return tl(s,i),Oo(s,i,"pan"),Object.defineProperty(s,"channelCountMode",{get:()=>r,set:a=>{if(a!==r)throw e()}}),s},Cyt=(t,e,n,i,r,s)=>{const o=new Float32Array([1,1]),c=Math.PI/2,l={channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete"},u={...l,oversample:"none"},h=(p,g,_,v)=>{const b=new Float32Array(16385),S=new Float32Array(16385);for(let P=0;P<16385;P+=1){const U=P/16384*c;b[P]=Math.cos(U),S[P]=Math.sin(U)}const x=n(p,{...l,gain:0}),M=i(p,{...u,curve:b}),R=i(p,{...u,curve:o}),I=n(p,{...l,gain:0}),k=i(p,{...u,curve:S});return{connectGraph(){g.connect(x),g.connect(R.inputs===void 0?R:R.inputs[0]),g.connect(I),R.connect(_),_.connect(M.inputs===void 0?M:M.inputs[0]),_.connect(k.inputs===void 0?k:k.inputs[0]),M.connect(x.gain),k.connect(I.gain),x.connect(v,0,0),I.connect(v,0,1)},disconnectGraph(){g.disconnect(x),g.disconnect(R.inputs===void 0?R:R.inputs[0]),g.disconnect(I),R.disconnect(_),_.disconnect(M.inputs===void 0?M:M.inputs[0]),_.disconnect(k.inputs===void 0?k:k.inputs[0]),M.disconnect(x.gain),k.disconnect(I.gain),x.disconnect(v,0,0),I.disconnect(v,0,1)}}},d=(p,g,_,v)=>{const b=new Float32Array(16385),S=new Float32Array(16385),x=new Float32Array(16385),M=new Float32Array(16385),R=Math.floor(16385/2);for(let J=0;J<16385;J+=1)if(J>R){const K=(J-R)/(16384-R)*c;b[J]=Math.cos(K),S[J]=Math.sin(K),x[J]=0,M[J]=1}else{const K=J/(16384-R)*c;b[J]=1,S[J]=0,x[J]=Math.cos(K),M[J]=Math.sin(K)}const I=e(p,{channelCount:2,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:2}),k=n(p,{...l,gain:0}),P=i(p,{...u,curve:b}),U=n(p,{...l,gain:0}),V=i(p,{...u,curve:S}),$=i(p,{...u,curve:o}),q=n(p,{...l,gain:0}),Y=i(p,{...u,curve:x}),te=n(p,{...l,gain:0}),G=i(p,{...u,curve:M});return{connectGraph(){g.connect(I),g.connect($.inputs===void 0?$:$.inputs[0]),I.connect(k,0),I.connect(U,0),I.connect(q,1),I.connect(te,1),$.connect(_),_.connect(P.inputs===void 0?P:P.inputs[0]),_.connect(V.inputs===void 0?V:V.inputs[0]),_.connect(Y.inputs===void 0?Y:Y.inputs[0]),_.connect(G.inputs===void 0?G:G.inputs[0]),P.connect(k.gain),V.connect(U.gain),Y.connect(q.gain),G.connect(te.gain),k.connect(v,0,0),q.connect(v,0,0),U.connect(v,0,1),te.connect(v,0,1)},disconnectGraph(){g.disconnect(I),g.disconnect($.inputs===void 0?$:$.inputs[0]),I.disconnect(k,0),I.disconnect(U,0),I.disconnect(q,1),I.disconnect(te,1),$.disconnect(_),_.disconnect(P.inputs===void 0?P:P.inputs[0]),_.disconnect(V.inputs===void 0?V:V.inputs[0]),_.disconnect(Y.inputs===void 0?Y:Y.inputs[0]),_.disconnect(G.inputs===void 0?G:G.inputs[0]),P.disconnect(k.gain),V.disconnect(U.gain),Y.disconnect(q.gain),G.disconnect(te.gain),k.disconnect(v,0,0),q.disconnect(v,0,0),U.disconnect(v,0,1),te.disconnect(v,0,1)}}},f=(p,g,_,v,b)=>{if(g===1)return h(p,_,v,b);if(g===2)return d(p,_,v,b);throw r()};return(p,{channelCount:g,channelCountMode:_,pan:v,...b})=>{if(_==="max")throw r();const S=t(p,{...b,channelCount:1,channelCountMode:_,numberOfInputs:2}),x=n(p,{...b,channelCount:g,channelCountMode:_,gain:1}),M=n(p,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:v});let{connectGraph:R,disconnectGraph:I}=f(p,g,x,M,S);Object.defineProperty(M.gain,"defaultValue",{get:()=>0}),Object.defineProperty(M.gain,"maxValue",{get:()=>1}),Object.defineProperty(M.gain,"minValue",{get:()=>-1});const k={get bufferSize(){},get channelCount(){return x.channelCount},set channelCount($){x.channelCount!==$&&(P&&I(),{connectGraph:R,disconnectGraph:I}=f(p,$,x,M,S),P&&R()),x.channelCount=$},get channelCountMode(){return x.channelCountMode},set channelCountMode($){if($==="clamped-max"||$==="max")throw r();x.channelCountMode=$},get channelInterpretation(){return x.channelInterpretation},set channelInterpretation($){x.channelInterpretation=$},get context(){return x.context},get inputs(){return[x]},get numberOfInputs(){return x.numberOfInputs},get numberOfOutputs(){return x.numberOfOutputs},get pan(){return M.gain},addEventListener(...$){return x.addEventListener($[0],$[1],$[2])},dispatchEvent(...$){return x.dispatchEvent($[0])},removeEventListener(...$){return x.removeEventListener($[0],$[1],$[2])}};let P=!1;const U=()=>{R(),P=!0},V=()=>{I(),P=!1};return s(SR(k,S),U,V)}},Ayt=(t,e,n,i,r,s,a)=>(o,c)=>{const l=o.createWaveShaper();if(s!==null&&s.name==="webkitAudioContext"&&o.createGain().gain.automationRate===void 0)return n(o,c);tl(l,c);const u=c.curve===null||c.curve instanceof Float32Array?c.curve:new Float32Array(c.curve);if(u!==null&&u.length<2)throw e();Fa(l,{curve:u},"curve"),Fa(l,c,"oversample");let h=null,d=!1;return a(l,"curve",g=>()=>g.call(l),g=>_=>(g.call(l,_),d&&(i(_)&&h===null?h=t(o,l):!i(_)&&h!==null&&(h(),h=null)),_)),r(l,()=>{d=!0,i(l.curve)&&(h=t(o,l))},()=>{d=!1,h!==null&&(h(),h=null)})},Ryt=(t,e,n,i,r)=>(s,{curve:a,oversample:o,...c})=>{const l=s.createWaveShaper(),u=s.createWaveShaper();tl(l,c),tl(u,c);const h=n(s,{...c,gain:1}),d=n(s,{...c,gain:-1}),f=n(s,{...c,gain:1}),p=n(s,{...c,gain:-1});let g=null,_=!1,v=null;const b={get bufferSize(){},get channelCount(){return l.channelCount},set channelCount(M){h.channelCount=M,d.channelCount=M,l.channelCount=M,f.channelCount=M,u.channelCount=M,p.channelCount=M},get channelCountMode(){return l.channelCountMode},set channelCountMode(M){h.channelCountMode=M,d.channelCountMode=M,l.channelCountMode=M,f.channelCountMode=M,u.channelCountMode=M,p.channelCountMode=M},get channelInterpretation(){return l.channelInterpretation},set channelInterpretation(M){h.channelInterpretation=M,d.channelInterpretation=M,l.channelInterpretation=M,f.channelInterpretation=M,u.channelInterpretation=M,p.channelInterpretation=M},get context(){return l.context},get curve(){return v},set curve(M){if(M!==null&&M.length<2)throw e();if(M===null)l.curve=M,u.curve=M;else{const R=M.length,I=new Float32Array(R+2-R%2),k=new Float32Array(R+2-R%2);I[0]=M[0],k[0]=-M[R-1];const P=Math.ceil((R+1)/2),U=(R+1)/2-1;for(let V=1;V<P;V+=1){const $=V/P*U,q=Math.floor($),Y=Math.ceil($);I[V]=q===Y?M[q]:(1-($-q))*M[q]+(1-(Y-$))*M[Y],k[V]=q===Y?-M[R-1-q]:-((1-($-q))*M[R-1-q])-(1-(Y-$))*M[R-1-Y]}I[P]=R%2===1?M[P-1]:(M[P-2]+M[P-1])/2,l.curve=I,u.curve=k}v=M,_&&(i(v)&&g===null?g=t(s,h):g!==null&&(g(),g=null))},get inputs(){return[h]},get numberOfInputs(){return l.numberOfInputs},get numberOfOutputs(){return l.numberOfOutputs},get oversample(){return l.oversample},set oversample(M){l.oversample=M,u.oversample=M},addEventListener(...M){return h.addEventListener(M[0],M[1],M[2])},dispatchEvent(...M){return h.dispatchEvent(M[0])},removeEventListener(...M){return h.removeEventListener(M[0],M[1],M[2])}};a!==null&&(b.curve=a instanceof Float32Array?a:new Float32Array(a)),o!==b.oversample&&(b.oversample=o);const S=()=>{h.connect(l).connect(f),h.connect(d).connect(u).connect(p).connect(f),_=!0,i(v)&&(g=t(s,h))},x=()=>{h.disconnect(l),l.disconnect(f),h.disconnect(d),d.disconnect(u),u.disconnect(p),p.disconnect(f),_=!1,g!==null&&(g(),g=null)};return r(SR(b,f),S,x)},Sh=()=>new DOMException("","NotSupportedError"),Myt={numberOfChannels:1},Oyt=(t,e,n,i,r)=>class extends t{constructor(a,o,c){let l;if(typeof a=="number"&&o!==void 0&&c!==void 0)l={length:o,numberOfChannels:a,sampleRate:c};else if(typeof a=="object")l=a;else throw new Error("The given parameters are not valid.");const{length:u,numberOfChannels:h,sampleRate:d}={...Myt,...l},f=i(h,u,d);e(fI,()=>fI(f))||f.addEventListener("statechange",(()=>{let p=0;const g=_=>{this._state==="running"&&(p>0?(f.removeEventListener("statechange",g),_.stopImmediatePropagation(),this._waitForThePromiseToSettle(_)):p+=1)};return g})()),super(f,h),this._length=u,this._nativeOfflineAudioContext=f,this._state=null}get length(){return this._nativeOfflineAudioContext.length===void 0?this._length:this._nativeOfflineAudioContext.length}get state(){return this._state===null?this._nativeOfflineAudioContext.state:this._state}startRendering(){return this._state==="running"?Promise.reject(n()):(this._state="running",r(this.destination,this._nativeOfflineAudioContext).finally(()=>{this._state=null,tEe(this)}))}_waitForThePromiseToSettle(a){this._state===null?this._nativeOfflineAudioContext.dispatchEvent(a):setTimeout(()=>this._waitForThePromiseToSettle(a))}},Nyt={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",detune:0,frequency:440,periodicWave:void 0,type:"sine"},Iyt=(t,e,n,i,r,s,a)=>class extends t{constructor(c,l){const u=r(c),h={...Nyt,...l},d=n(u,h),f=s(u),p=f?i():null,g=c.sampleRate/2;super(c,!1,d,p),this._detune=e(this,f,d.detune,153600,-153600),this._frequency=e(this,f,d.frequency,g,-g),this._nativeOscillatorNode=d,this._onended=null,this._oscillatorNodeRenderer=p,this._oscillatorNodeRenderer!==null&&h.periodicWave!==void 0&&(this._oscillatorNodeRenderer.periodicWave=h.periodicWave)}get detune(){return this._detune}get frequency(){return this._frequency}get onended(){return this._onended}set onended(c){const l=typeof c=="function"?a(this,c):null;this._nativeOscillatorNode.onended=l;const u=this._nativeOscillatorNode.onended;this._onended=u!==null&&u===l?c:u}get type(){return this._nativeOscillatorNode.type}set type(c){this._nativeOscillatorNode.type=c,this._oscillatorNodeRenderer!==null&&(this._oscillatorNodeRenderer.periodicWave=null)}setPeriodicWave(c){this._nativeOscillatorNode.setPeriodicWave(c),this._oscillatorNodeRenderer!==null&&(this._oscillatorNodeRenderer.periodicWave=c)}start(c=0){if(this._nativeOscillatorNode.start(c),this._oscillatorNodeRenderer!==null&&(this._oscillatorNodeRenderer.start=c),this.context.state!=="closed"){DA(this);const l=()=>{this._nativeOscillatorNode.removeEventListener("ended",l),y_(this)&&Yk(this)};this._nativeOscillatorNode.addEventListener("ended",l)}}stop(c=0){this._nativeOscillatorNode.stop(c),this._oscillatorNodeRenderer!==null&&(this._oscillatorNodeRenderer.stop=c)}},kyt=(t,e,n,i,r)=>()=>{const s=new WeakMap;let a=null,o=null,c=null;const l=async(u,h)=>{let d=n(u);const f=Ou(d,h);if(!f){const p={channelCount:d.channelCount,channelCountMode:d.channelCountMode,channelInterpretation:d.channelInterpretation,detune:d.detune.value,frequency:d.frequency.value,periodicWave:a===null?void 0:a,type:d.type};d=e(h,p),o!==null&&d.start(o),c!==null&&d.stop(c)}return s.set(h,d),f?(await t(h,u.detune,d.detune),await t(h,u.frequency,d.frequency)):(await i(h,u.detune,d.detune),await i(h,u.frequency,d.frequency)),await r(u,h,d),d};return{set periodicWave(u){a=u},set start(u){o=u},set stop(u){c=u},render(u,h){const d=s.get(h);return d!==void 0?Promise.resolve(d):l(u,h)}}},Pyt={channelCount:2,channelCountMode:"clamped-max",channelInterpretation:"speakers",coneInnerAngle:360,coneOuterAngle:360,coneOuterGain:0,distanceModel:"inverse",maxDistance:1e4,orientationX:1,orientationY:0,orientationZ:0,panningModel:"equalpower",positionX:0,positionY:0,positionZ:0,refDistance:1,rolloffFactor:1},Dyt=(t,e,n,i,r,s,a)=>class extends t{constructor(c,l){const u=r(c),h={...Pyt,...l},d=n(u,h),f=s(u),p=f?i():null;super(c,!1,d,p),this._nativePannerNode=d,this._orientationX=e(this,f,d.orientationX,sh,ed),this._orientationY=e(this,f,d.orientationY,sh,ed),this._orientationZ=e(this,f,d.orientationZ,sh,ed),this._positionX=e(this,f,d.positionX,sh,ed),this._positionY=e(this,f,d.positionY,sh,ed),this._positionZ=e(this,f,d.positionZ,sh,ed),a(this,1)}get coneInnerAngle(){return this._nativePannerNode.coneInnerAngle}set coneInnerAngle(c){this._nativePannerNode.coneInnerAngle=c}get coneOuterAngle(){return this._nativePannerNode.coneOuterAngle}set coneOuterAngle(c){this._nativePannerNode.coneOuterAngle=c}get coneOuterGain(){return this._nativePannerNode.coneOuterGain}set coneOuterGain(c){this._nativePannerNode.coneOuterGain=c}get distanceModel(){return this._nativePannerNode.distanceModel}set distanceModel(c){this._nativePannerNode.distanceModel=c}get maxDistance(){return this._nativePannerNode.maxDistance}set maxDistance(c){this._nativePannerNode.maxDistance=c}get orientationX(){return this._orientationX}get orientationY(){return this._orientationY}get orientationZ(){return this._orientationZ}get panningModel(){return this._nativePannerNode.panningModel}set panningModel(c){this._nativePannerNode.panningModel=c}get positionX(){return this._positionX}get positionY(){return this._positionY}get positionZ(){return this._positionZ}get refDistance(){return this._nativePannerNode.refDistance}set refDistance(c){this._nativePannerNode.refDistance=c}get rolloffFactor(){return this._nativePannerNode.rolloffFactor}set rolloffFactor(c){this._nativePannerNode.rolloffFactor=c}},Lyt=(t,e,n,i,r,s,a,o,c,l)=>()=>{const u=new WeakMap;let h=null;const d=async(f,p)=>{let g=null,_=s(f);const v={channelCount:_.channelCount,channelCountMode:_.channelCountMode,channelInterpretation:_.channelInterpretation},b={...v,coneInnerAngle:_.coneInnerAngle,coneOuterAngle:_.coneOuterAngle,coneOuterGain:_.coneOuterGain,distanceModel:_.distanceModel,maxDistance:_.maxDistance,panningModel:_.panningModel,refDistance:_.refDistance,rolloffFactor:_.rolloffFactor},S=Ou(_,p);if("bufferSize"in _)g=i(p,{...v,gain:1});else if(!S){const x={...b,orientationX:_.orientationX.value,orientationY:_.orientationY.value,orientationZ:_.orientationZ.value,positionX:_.positionX.value,positionY:_.positionY.value,positionZ:_.positionZ.value};_=r(p,x)}if(u.set(p,g===null?_:g),g!==null){if(h===null){if(a===null)throw new Error("Missing the native OfflineAudioContext constructor.");const V=new a(6,f.context.length,p.sampleRate),$=e(V,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:6});$.connect(V.destination),h=(async()=>{const q=await Promise.all([f.orientationX,f.orientationY,f.orientationZ,f.positionX,f.positionY,f.positionZ].map(async(Y,te)=>{const G=n(V,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:te===0?1:0});return await o(V,Y,G.offset),G}));for(let Y=0;Y<6;Y+=1)q[Y].connect($,0,Y),q[Y].start(0);return l(V)})()}const x=await h,M=i(p,{...v,gain:1});await c(f,p,M);const R=[];for(let V=0;V<x.numberOfChannels;V+=1)R.push(x.getChannelData(V));let I=[R[0][0],R[1][0],R[2][0]],k=[R[3][0],R[4][0],R[5][0]],P=i(p,{...v,gain:1}),U=r(p,{...b,orientationX:I[0],orientationY:I[1],orientationZ:I[2],positionX:k[0],positionY:k[1],positionZ:k[2]});M.connect(P).connect(U.inputs[0]),U.connect(g);for(let V=128;V<x.length;V+=128){const $=[R[0][V],R[1][V],R[2][V]],q=[R[3][V],R[4][V],R[5][V]];if($.some((Y,te)=>Y!==I[te])||q.some((Y,te)=>Y!==k[te])){I=$,k=q;const Y=V/p.sampleRate;P.gain.setValueAtTime(0,Y),P=i(p,{...v,gain:0}),U=r(p,{...b,orientationX:I[0],orientationY:I[1],orientationZ:I[2],positionX:k[0],positionY:k[1],positionZ:k[2]}),P.gain.setValueAtTime(1,Y),M.connect(P).connect(U.inputs[0]),U.connect(g)}}return g}return S?(await t(p,f.orientationX,_.orientationX),await t(p,f.orientationY,_.orientationY),await t(p,f.orientationZ,_.orientationZ),await t(p,f.positionX,_.positionX),await t(p,f.positionY,_.positionY),await t(p,f.positionZ,_.positionZ)):(await o(p,f.orientationX,_.orientationX),await o(p,f.orientationY,_.orientationY),await o(p,f.orientationZ,_.orientationZ),await o(p,f.positionX,_.positionX),await o(p,f.positionY,_.positionY),await o(p,f.positionZ,_.positionZ)),ER(_)?await c(f,p,_.inputs[0]):await c(f,p,_),_};return{render(f,p){const g=u.get(p);return g!==void 0?Promise.resolve(g):d(f,p)}}},Uyt={disableNormalization:!1},Byt=(t,e,n,i)=>class hEe{constructor(s,a){const o=e(s),c=i({...Uyt,...a}),l=t(o,c);return n.add(l),l}static[Symbol.hasInstance](s){return s!==null&&typeof s=="object"&&Object.getPrototypeOf(s)===hEe.prototype||n.has(s)}},Fyt=(t,e)=>(n,i,r)=>(t(i).replay(r),e(i,n,r)),zyt=(t,e,n)=>async(i,r,s)=>{const a=t(i);await Promise.all(a.activeInputs.map((o,c)=>Array.from(o).map(async([l,u])=>{const d=await e(l).render(l,r),f=i.context.destination;!n(l)&&(i!==f||!n(i))&&d.connect(s,u,c)})).reduce((o,c)=>[...o,...c],[]))},jyt=(t,e,n)=>async(i,r,s)=>{const a=e(i);await Promise.all(Array.from(a.activeInputs).map(async([o,c])=>{const u=await t(o).render(o,r);n(o)||u.connect(s,c)}))},Hyt=(t,e,n,i)=>r=>t(fI,()=>fI(r))?Promise.resolve(t(i,i)).then(s=>{if(!s){const a=n(r,512,0,1);r.oncomplete=()=>{a.onaudioprocess=null,a.disconnect()},a.onaudioprocess=()=>r.currentTime,a.connect(r.destination)}return r.startRendering()}):new Promise(s=>{const a=e(r,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});r.oncomplete=o=>{a.disconnect(),s(o.renderedBuffer)},a.connect(r.destination),r.startRendering()}),Vyt=t=>(e,n)=>{t.set(e,n)},Gyt=t=>(e,n)=>t.set(e,n),qyt=(t,e,n,i,r,s,a,o)=>(c,l)=>n(c).render(c,l).then(()=>Promise.all(Array.from(i(l)).map(u=>n(u).render(u,l)))).then(()=>r(l)).then(u=>(typeof u.copyFromChannel!="function"?(a(u),dX(u)):e(s,()=>s(u))||o(u),t.add(u),u)),$yt={channelCount:2,channelCountMode:"explicit",channelInterpretation:"speakers",pan:0},Wyt=(t,e,n,i,r,s)=>class extends t{constructor(o,c){const l=r(o),u={...$yt,...c},h=n(l,u),d=s(l),f=d?i():null;super(o,!1,h,f),this._pan=e(this,d,h.pan)}get pan(){return this._pan}},Yyt=(t,e,n,i,r)=>()=>{const s=new WeakMap,a=async(o,c)=>{let l=n(o);const u=Ou(l,c);if(!u){const h={channelCount:l.channelCount,channelCountMode:l.channelCountMode,channelInterpretation:l.channelInterpretation,pan:l.pan.value};l=e(c,h)}return s.set(c,l),u?await t(c,o.pan,l.pan):await i(c,o.pan,l.pan),ER(l)?await r(o,c,l.inputs[0]):await r(o,c,l),l};return{render(o,c){const l=s.get(c);return l!==void 0?Promise.resolve(l):a(o,c)}}},Kyt=t=>()=>{if(t===null)return!1;try{new t({length:1,sampleRate:44100})}catch{return!1}return!0},Xyt=(t,e)=>async()=>{if(t===null)return!0;if(e===null)return!1;const n=new Blob(['class A extends AudioWorkletProcessor{process(i){this.port.postMessage(i,[i[0][0].buffer])}}registerProcessor("a",A)'],{type:"application/javascript; charset=utf-8"}),i=new e(1,128,44100),r=URL.createObjectURL(n);let s=!1,a=!1;try{await i.audioWorklet.addModule(r);const o=new t(i,"a",{numberOfOutputs:0}),c=i.createOscillator();o.port.onmessage=()=>s=!0,o.onprocessorerror=()=>a=!0,c.connect(o),c.start(0),await i.startRendering(),await new Promise(l=>setTimeout(l))}catch{}finally{URL.revokeObjectURL(r)}return s&&!a},Zyt=(t,e)=>()=>{if(e===null)return Promise.resolve(!1);const n=new e(1,1,44100),i=t(n,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});return new Promise(r=>{n.oncomplete=()=>{i.disconnect(),r(n.currentTime!==0)},n.startRendering()})},Jyt=()=>new DOMException("","UnknownError"),Qyt={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",curve:null,oversample:"none"},ebt=(t,e,n,i,r,s,a)=>class extends t{constructor(c,l){const u=r(c),h={...Qyt,...l},d=n(u,h),p=s(u)?i():null;super(c,!0,d,p),this._isCurveNullified=!1,this._nativeWaveShaperNode=d,a(this,1)}get curve(){return this._isCurveNullified?null:this._nativeWaveShaperNode.curve}set curve(c){if(c===null)this._isCurveNullified=!0,this._nativeWaveShaperNode.curve=new Float32Array([0,0]);else{if(c.length<2)throw e();this._isCurveNullified=!1,this._nativeWaveShaperNode.curve=c}}get oversample(){return this._nativeWaveShaperNode.oversample}set oversample(c){this._nativeWaveShaperNode.oversample=c}},tbt=(t,e,n)=>()=>{const i=new WeakMap,r=async(s,a)=>{let o=e(s);if(!Ou(o,a)){const l={channelCount:o.channelCount,channelCountMode:o.channelCountMode,channelInterpretation:o.channelInterpretation,curve:o.curve,oversample:o.oversample};o=t(a,l)}return i.set(a,o),ER(o)?await n(s,a,o.inputs[0]):await n(s,a,o),o};return{render(s,a){const o=i.get(a);return o!==void 0?Promise.resolve(o):r(s,a)}}},nbt=()=>typeof window>"u"?null:window,ibt=(t,e)=>n=>{n.copyFromChannel=(i,r,s=0)=>{const a=t(s),o=t(r);if(o>=n.numberOfChannels)throw e();const c=n.length,l=n.getChannelData(o),u=i.length;for(let h=a<0?-a:0;h+a<c&&h<u;h+=1)i[h]=l[h+a]},n.copyToChannel=(i,r,s=0)=>{const a=t(s),o=t(r);if(o>=n.numberOfChannels)throw e();const c=n.length,l=n.getChannelData(o),u=i.length;for(let h=a<0?-a:0;h+a<c&&h<u;h+=1)l[h+a]=i[h]}},rbt=t=>e=>{e.copyFromChannel=(n=>(i,r,s=0)=>{const a=t(s),o=t(r);if(a<e.length)return n.call(e,i,o,a)})(e.copyFromChannel),e.copyToChannel=(n=>(i,r,s=0)=>{const a=t(s),o=t(r);if(a<e.length)return n.call(e,i,o,a)})(e.copyToChannel)},sbt=t=>(e,n)=>{const i=n.createBuffer(1,1,44100);e.buffer===null&&(e.buffer=i),t(e,"buffer",r=>()=>{const s=r.call(e);return s===i?null:s},r=>s=>r.call(e,s===null?i:s))},abt=(t,e)=>(n,i)=>{i.channelCount=1,i.channelCountMode="explicit",Object.defineProperty(i,"channelCount",{get:()=>1,set:()=>{throw t()}}),Object.defineProperty(i,"channelCountMode",{get:()=>"explicit",set:()=>{throw t()}});const r=n.createBufferSource();e(i,()=>{const o=i.numberOfInputs;for(let c=0;c<o;c+=1)r.connect(i,0,c)},()=>r.disconnect(i))},dEe=(t,e,n)=>t.copyFromChannel===void 0?t.getChannelData(n)[0]:(t.copyFromChannel(e,n),e[0]),fEe=t=>{if(t===null)return!1;const e=t.length;return e%2!==0?t[Math.floor(e/2)]!==0:t[e/2-1]+t[e/2]!==0},Qk=(t,e,n,i)=>{let r=t;for(;!r.hasOwnProperty(e);)r=Object.getPrototypeOf(r);const{get:s,set:a}=Object.getOwnPropertyDescriptor(r,e);Object.defineProperty(t,e,{get:n(s),set:i(a)})},obt=t=>({...t,outputChannelCount:t.outputChannelCount!==void 0?t.outputChannelCount:t.numberOfInputs===1&&t.numberOfOutputs===1?[t.channelCount]:Array.from({length:t.numberOfOutputs},()=>1)}),cbt=t=>({...t,channelCount:t.numberOfOutputs}),lbt=t=>{const{imag:e,real:n}=t;return e===void 0?n===void 0?{...t,imag:[0,0],real:[0,0]}:{...t,imag:Array.from(n,()=>0),real:n}:n===void 0?{...t,imag:e,real:Array.from(e,()=>0)}:{...t,imag:e,real:n}},pEe=(t,e,n)=>{try{t.setValueAtTime(e,n)}catch(i){if(i.code!==9)throw i;pEe(t,e,n+1e-7)}},ubt=t=>{const e=t.createBufferSource();e.start();try{e.start()}catch{return!0}return!1},hbt=t=>{const e=t.createBufferSource(),n=t.createBuffer(1,1,44100);e.buffer=n;try{e.start(0,1)}catch{return!1}return!0},dbt=t=>{const e=t.createBufferSource();e.start();try{e.stop()}catch{return!1}return!0},vX=t=>{const e=t.createOscillator();try{e.start(-1)}catch(n){return n instanceof RangeError}return!1},mEe=t=>{const e=t.createBuffer(1,1,44100),n=t.createBufferSource();n.buffer=e,n.start(),n.stop();try{return n.stop(),!0}catch{return!1}},_X=t=>{const e=t.createOscillator();try{e.stop(-1)}catch(n){return n instanceof RangeError}return!1},fbt=t=>{const{port1:e,port2:n}=new MessageChannel;try{e.postMessage(t)}finally{e.close(),n.close()}},pbt=t=>{t.start=(e=>(n=0,i=0,r)=>{const s=t.buffer,a=s===null?i:Math.min(s.duration,i);s!==null&&a>s.duration-.5/t.context.sampleRate?e.call(t,n,0,0):e.call(t,n,a,r)})(t.start)},gEe=(t,e)=>{const n=e.createGain();t.connect(n);const i=(r=>()=>{r.call(t,n),t.removeEventListener("ended",i)})(t.disconnect);t.addEventListener("ended",i),SR(t,n),t.stop=(r=>{let s=!1;return(a=0)=>{if(s)try{r.call(t,a)}catch{n.gain.setValueAtTime(0,a)}else r.call(t,a),s=!0}})(t.stop)},TR=(t,e)=>n=>{const i={value:t};return Object.defineProperties(n,{currentTarget:i,target:i}),typeof e=="function"?e.call(t,n):e.handleEvent.call(t,n)},mbt=D0t(nx),gbt=j0t(nx),vbt=Qvt(T8),vEe=new WeakMap,_bt=v_t(vEe),zm=Mvt(new Map,new WeakMap),f0=nbt(),_Ee=W_t(zm,R0),yX=g_t(fh),Jl=zyt(fh,yX,A1),ybt=$0t(_Ee,Ra,Jl),fa=b_t(S8),X_=byt(f0),qs=U_t(X_),yEe=new WeakMap,bEe=l_t(TR),eP=Z_t(f0),bX=k_t(eP),EX=P_t(f0),EEe=D_t(f0),pI=Q_t(f0),Zo=vvt(L0t(Ybe),z0t(mbt,gbt,yB,vbt,bB,fh,_bt,Wk,Ra,nx,y_,A1,SL),zm,R_t(G$,bB,fh,Ra,dI,y_),R0,x8,Sh,Kvt(yB,G$,fh,Ra,dI,fa,y_,qs),n_t(yEe,fh,Mm),bEe,fa,bX,EX,EEe,qs,pI),bbt=q0t(Zo,ybt,R0,_Ee,fa,qs),SX=new WeakSet,iae=Y_t(f0),SEe=Hvt(new Uint32Array(1)),TX=ibt(SEe,R0),xX=rbt(SEe),TEe=Y0t(SX,zm,Sh,iae,X_,Kyt(iae),TX,xX),w8=H0t(bd),xEe=jyt(yX,Kk,A1),M0=Lvt(xEe),xR=X_t(w8,zm,ubt,hbt,dbt,vX,mEe,_X,pbt,sbt(Qk),gEe),O0=Fyt(__t(Kk),xEe),Ebt=Z0t(M0,xR,Ra,O0,Jl),jm=_vt(U0t(Kbe),yEe,hX,yvt,M0t,O0t,N0t,I0t,k0t,j$,$be,eP,pEe),Sbt=X0t(Zo,Ebt,jm,Rl,xR,fa,qs,TR),Tbt=avt(Zo,ovt,R0,Rl,J_t(bd,Qk),fa,qs,Jl),xbt=Rvt(M0,lEe,Ra,O0,Jl),ix=Gyt(vEe),wbt=Avt(Zo,jm,xbt,x8,lEe,fa,qs,ix),HE=q_t(nx,EX),Cbt=abt(Rl,HE),VE=ayt(eP,Cbt),Abt=Ivt(VE,Ra,Jl),Rbt=Nvt(Zo,Abt,VE,fa,qs),Mbt=Dvt(Zk,Ra,Jl),Obt=Pvt(Zo,Mbt,Zk,fa,qs,cbt),Nbt=lyt(w8,xR,bd,HE),wR=cyt(w8,zm,Nbt,vX,_X),Ibt=jvt(M0,wR,Ra,O0,Jl),kbt=zvt(Zo,jm,Ibt,wR,fa,qs,TR),wEe=uyt(Sh,Qk),Pbt=qvt(wEe,Ra,Jl),Dbt=Gvt(Zo,Pbt,wEe,fa,qs,ix),Lbt=Jvt(M0,uEe,Ra,O0,Jl),Ubt=Zvt(Zo,jm,Lbt,uEe,fa,qs,ix),CEe=hyt(Sh),Bbt=a_t(M0,CEe,Ra,O0,Jl),Fbt=s_t(Zo,jm,Bbt,CEe,Sh,fa,qs,ix),zbt=p_t(M0,bd,Ra,O0,Jl),jbt=f_t(Zo,jm,zbt,bd,fa,qs),Hbt=myt(x8,Rl,Jk,Sh),C8=Hyt(zm,bd,Jk,Zyt(bd,X_)),Vbt=A_t(xR,Ra,X_,Jl,C8),Gbt=dyt(Hbt),qbt=w_t(Zo,Gbt,Vbt,fa,qs,ix),$bt=cvt(jm,VE,wR,Jk,Sh,dEe,qs,Qk),AEe=new WeakMap,Wbt=G_t(Tbt,$bt,bEe,qs,AEe,TR),REe=Eyt(w8,zm,vX,mEe,_X,gEe),Ybt=kyt(M0,REe,Ra,O0,Jl),Kbt=Iyt(Zo,jm,REe,Ybt,fa,qs,TR),MEe=Bvt(xR),Xbt=Ryt(MEe,Rl,bd,fEe,HE),A8=Ayt(MEe,Rl,Xbt,fEe,HE,eP,Qk),Zbt=Tyt(yB,Rl,VE,bd,Jk,A8,Sh,bB,dEe,HE),OEe=Syt(Zbt),Jbt=Lyt(M0,VE,wR,bd,OEe,Ra,X_,O0,Jl,C8),Qbt=Dyt(Zo,jm,OEe,Jbt,fa,qs,ix),eEt=xyt(R0),tEt=Byt(eEt,fa,new WeakSet,lbt),nEt=Cyt(VE,Zk,bd,A8,Sh,HE),NEe=wyt(nEt,Sh),iEt=Yyt(M0,NEe,Ra,O0,Jl),rEt=Wyt(Zo,jm,NEe,iEt,fa,qs),sEt=tbt(A8,Ra,Jl),aEt=ebt(Zo,Rl,A8,sEt,fa,qs,ix),IEe=B_t(f0),wX=u_t(f0),kEe=new WeakMap,oEt=E_t(kEe,X_),cEt=IEe?F0t(zm,Sh,c_t(f0),wX,h_t(P0t),fa,oEt,qs,pI,new WeakMap,new WeakMap,Xyt(pI,X_),f0):void 0,lEt=L_t(bX,qs),uEt=Yvt(SX,zm,Wvt,o_t,new WeakSet,fa,lEt,vB,fI,TX,xX),PEe=wvt(cEt,bbt,TEe,Sbt,wbt,Rbt,Obt,kbt,Dbt,uEt,Ubt,Fbt,jbt,qbt,Wbt,Kbt,Qbt,tEt,rEt,aEt),hEt=F_t(Zo,gyt,fa,qs),dEt=j_t(Zo,vyt,fa,qs),fEt=H_t(Zo,_yt,fa,qs),pEt=yyt(Rl,qs),mEt=V_t(Zo,pEt,fa),gEt=svt(PEe,Rl,Sh,Jyt,hEt,dEt,fEt,mEt,eP),CX=S_t(AEe),vEt=V0t(CX),DEe=Uvt(R0),_Et=e_t(CX),LEe=i_t(R0),UEe=new WeakMap,yEt=m_t(UEe,Mm),bEt=syt(DEe,R0,Rl,VE,Zk,wR,bd,Jk,Sh,LEe,wX,yEt,HE),EEt=tyt(Rl,bEt,bd,Sh,HE),SEt=xvt(M0,DEe,xR,VE,Zk,wR,bd,_Et,LEe,wX,Ra,pI,X_,O0,Jl,C8),TEt=y_t(kEe),xEt=Vyt(UEe),rae=IEe?Evt(vEt,Zo,jm,SEt,EEt,fh,TEt,fa,qs,pI,obt,xEt,fbt,TR):void 0,wEt=$vt(Sh,X_),CEt=qyt(SX,zm,yX,CX,C8,vB,TX,xX),AEt=Oyt(PEe,zm,Rl,wEt,CEt),REt=M_t(S8,bX),MEt=O_t(uX,EX),OEt=N_t(hX,EEe),NEt=I_t(S8,qs);function mf(t){return t===void 0}function _r(t){return t!==void 0}function IEt(t){return typeof t=="function"}function Om(t){return typeof t=="number"}function Xb(t){return Object.prototype.toString.call(t)==="[object Object]"&&t.constructor===Object}function BEe(t){return typeof t=="boolean"}function hd(t){return Array.isArray(t)}function B_(t){return typeof t=="string"}function b2(t){return B_(t)&&/^([a-g]{1}(?:b|#|x|bb)?)(-?[0-9]+)/i.test(t)}function Ri(t,e){if(!t)throw new Error(e)}function pp(t,e,n=1/0){if(!(e<=t&&t<=n))throw new RangeError(`Value must be within [${e}, ${n}], got: ${t}`)}function FEe(t){!t.isOffline&&t.state!=="running"&&R8('The AudioContext is "suspended". Invoke Tone.start() from a user action to start the audio.')}let zEe=!1,sae=!1;function aae(t){zEe=t}function kEt(t){mf(t)&&zEe&&!sae&&(sae=!0,R8("Events scheduled inside of scheduled callbacks should use the passed in scheduling time. See https://github.com/Tonejs/Tone.js/wiki/Accurate-Timing"))}let jEe=console;function PEt(...t){jEe.log(...t)}function R8(...t){jEe.warn(...t)}function DEt(t){return new gEt(t)}function LEt(t,e,n){return new AEt(t,e,n)}const ef=typeof self=="object"?self:null,UEt=ef&&(ef.hasOwnProperty("AudioContext")||ef.hasOwnProperty("webkitAudioContext"));function BEt(t,e,n){return Ri(_r(rae),"AudioWorkletNode only works in a secure context (https or localhost)"),new(t instanceof(ef==null?void 0:ef.BaseAudioContext)?ef==null?void 0:ef.AudioWorkletNode:rae)(t,e,n)}var K$=function(t,e){return K$=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(n[r]=i[r])},K$(t,e)};function HEe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");K$(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}function pa(t,e,n,i){var r=arguments.length,s=r<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,n):i,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(t,e,n,i);else for(var o=t.length-1;o>=0;o--)(a=t[o])&&(s=(r<3?a(s):r>3?a(e,n,s):a(e,n))||s);return r>3&&s&&Object.defineProperty(e,n,s),s}function oo(t,e,n,i){function r(s){return s instanceof n?s:new n(function(a){a(s)})}return new(n||(n=Promise))(function(s,a){function o(u){try{l(i.next(u))}catch(h){a(h)}}function c(u){try{l(i.throw(u))}catch(h){a(h)}}function l(u){u.done?s(u.value):r(u.value).then(o,c)}l((i=i.apply(t,e||[])).next())})}function AX(t,e){var n={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},i,r,s,a=Object.create((typeof Iterator=="function"?Iterator:Object).prototype);return a.next=o(0),a.throw=o(1),a.return=o(2),typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function o(l){return function(u){return c([l,u])}}function c(l){if(i)throw new TypeError("Generator is already executing.");for(;a&&(a=0,l[0]&&(n=0)),n;)try{if(i=1,r&&(s=l[0]&2?r.return:l[0]?r.throw||((s=r.return)&&s.call(r),0):r.next)&&!(s=s.call(r,l[1])).done)return s;switch(r=0,s&&(l=[l[0]&2,s.value]),l[0]){case 0:case 1:s=l;break;case 4:return n.label++,{value:l[1],done:!1};case 5:n.label++,r=l[1],l=[0];continue;case 7:l=n.ops.pop(),n.trys.pop();continue;default:if(s=n.trys,!(s=s.length>0&&s[s.length-1])&&(l[0]===6||l[0]===2)){n=0;continue}if(l[0]===3&&(!s||l[1]>s[0]&&l[1]<s[3])){n.label=l[1];break}if(l[0]===6&&n.label<s[1]){n.label=s[1],s=l;break}if(s&&n.label<s[2]){n.label=s[2],n.ops.push(l);break}s[2]&&n.ops.pop(),n.trys.pop();continue}l=e.call(t,n)}catch(u){l=[6,u],r=0}finally{i=s=0}if(l[0]&5)throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}}function M8(t,e){var n=typeof Symbol=="function"&&t[Symbol.iterator];if(!n)return t;var i=n.call(t),r,s=[],a;try{for(;(e===void 0||e-- >0)&&!(r=i.next()).done;)s.push(r.value)}catch(o){a={error:o}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(a)throw a.error}}return s}function X$(t,e,n){if(n||arguments.length===2)for(var i=0,r=e.length,s;i<r;i++)(s||!(i in e))&&(s||(s=Array.prototype.slice.call(e,0,i)),s[i]=e[i]);return t.concat(s||Array.prototype.slice.call(e))}class FEt{constructor(e,n,i,r){this._callback=e,this._type=n,this._minimumUpdateInterval=Math.max(128/(r||44100),.001),this.updateInterval=i,this._createClock()}_createWorker(){const e=new Blob([`
			// the initial timeout time
			let timeoutTime =  ${(this._updateInterval*1e3).toFixed(1)};
			// onmessage callback
			self.onmessage = function(msg){
				timeoutTime = parseInt(msg.data);
			};
			// the tick function which posts a message
			// and schedules a new tick
			function tick(){
				setTimeout(tick, timeoutTime);
				self.postMessage('tick');
			}
			// call tick initially
			tick();
			`],{type:"text/javascript"}),n=URL.createObjectURL(e),i=new Worker(n);i.onmessage=this._callback.bind(this),this._worker=i}_createTimeout(){this._timeout=setTimeout(()=>{this._createTimeout(),this._callback()},this._updateInterval*1e3)}_createClock(){if(this._type==="worker")try{this._createWorker()}catch{this._type="timeout",this._createClock()}else this._type==="timeout"&&this._createTimeout()}_disposeClock(){this._timeout&&clearTimeout(this._timeout),this._worker&&(this._worker.terminate(),this._worker.onmessage=null)}get updateInterval(){return this._updateInterval}set updateInterval(e){var n;this._updateInterval=Math.max(e,this._minimumUpdateInterval),this._type==="worker"&&((n=this._worker)===null||n===void 0||n.postMessage(this._updateInterval*1e3))}get type(){return this._type}set type(e){this._disposeClock(),this._type=e,this._createClock()}dispose(){this._disposeClock()}}function R1(t){return OEt(t)}function Zb(t){return MEt(t)}function TL(t){return NEt(t)}function Iw(t){return REt(t)}function zEt(t){return t instanceof TEe}function jEt(t,e){return t==="value"||R1(e)||Zb(e)||zEt(e)}function Jb(t,...e){if(!e.length)return t;const n=e.shift();if(Xb(t)&&Xb(n))for(const i in n)jEt(i,n[i])?t[i]=n[i]:Xb(n[i])?(t[i]||Object.assign(t,{[i]:{}}),Jb(t[i],n[i])):Object.assign(t,{[i]:n[i]});return Jb(t,...e)}function HEt(t,e){return t.length===e.length&&t.every((n,i)=>e[i]===n)}function Mn(t,e,n=[],i){const r={},s=Array.from(e);if(Xb(s[0])&&i&&!Reflect.has(s[0],i)&&(Object.keys(s[0]).some(o=>Reflect.has(t,o))||(Jb(r,{[i]:s[0]}),n.splice(n.indexOf(i),1),s.shift())),s.length===1&&Xb(s[0]))Jb(r,s[0]);else for(let a=0;a<n.length;a++)_r(s[a])&&(r[n[a]]=s[a]);return Jb(t,r)}function VEt(t){return t.constructor.getDefaults()}function n0(t,e){return mf(t)?e:t}function qg(t,e){return e.forEach(n=>{Reflect.has(t,n)&&delete t[n]}),t}/**
 * Tone.js
 * @author Yotam Mann
 * @license http://opensource.org/licenses/MIT MIT License
 * @copyright 2014-2024 Yotam Mann
 */class Z_{constructor(){this.debug=!1,this._wasDisposed=!1}static getDefaults(){return{}}log(...e){(this.debug||ef&&this.toString()===ef.TONE_DEBUG_CLASS)&&PEt(this,...e)}dispose(){return this._wasDisposed=!0,this}get disposed(){return this._wasDisposed}toString(){return this.name}}Z_.version=qbe;const RX=1e-6;function LA(t,e){return t>e+RX}function Z$(t,e){return LA(t,e)||mm(t,e)}function xB(t,e){return t+RX<e}function mm(t,e){return Math.abs(t-e)<RX}function GEt(t,e,n){return Math.max(Math.min(t,n),e)}class yp extends Z_{constructor(){super(),this.name="Timeline",this._timeline=[];const e=Mn(yp.getDefaults(),arguments,["memory"]);this.memory=e.memory,this.increasing=e.increasing}static getDefaults(){return{memory:1/0,increasing:!1}}get length(){return this._timeline.length}add(e){if(Ri(Reflect.has(e,"time"),"Timeline: events must have a time attribute"),e.time=e.time.valueOf(),this.increasing&&this.length){const n=this._timeline[this.length-1];Ri(Z$(e.time,n.time),"The time must be greater than or equal to the last scheduled time"),this._timeline.push(e)}else{const n=this._search(e.time);this._timeline.splice(n+1,0,e)}if(this.length>this.memory){const n=this.length-this.memory;this._timeline.splice(0,n)}return this}remove(e){const n=this._timeline.indexOf(e);return n!==-1&&this._timeline.splice(n,1),this}get(e,n="time"){const i=this._search(e,n);return i!==-1?this._timeline[i]:null}peek(){return this._timeline[0]}shift(){return this._timeline.shift()}getAfter(e,n="time"){const i=this._search(e,n);return i+1<this._timeline.length?this._timeline[i+1]:null}getBefore(e){const n=this._timeline.length;if(n>0&&this._timeline[n-1].time<e)return this._timeline[n-1];const i=this._search(e);return i-1>=0?this._timeline[i-1]:null}cancel(e){if(this._timeline.length>1){let n=this._search(e);if(n>=0)if(mm(this._timeline[n].time,e)){for(let i=n;i>=0&&mm(this._timeline[i].time,e);i--)n=i;this._timeline=this._timeline.slice(0,n)}else this._timeline=this._timeline.slice(0,n+1);else this._timeline=[]}else this._timeline.length===1&&Z$(this._timeline[0].time,e)&&(this._timeline=[]);return this}cancelBefore(e){const n=this._search(e);return n>=0&&(this._timeline=this._timeline.slice(n+1)),this}previousEvent(e){const n=this._timeline.indexOf(e);return n>0?this._timeline[n-1]:null}_search(e,n="time"){if(this._timeline.length===0)return-1;let i=0;const r=this._timeline.length;let s=r;if(r>0&&this._timeline[r-1][n]<=e)return r-1;for(;i<s;){let a=Math.floor(i+(s-i)/2);const o=this._timeline[a],c=this._timeline[a+1];if(mm(o[n],e)){for(let l=a;l<this._timeline.length;l++){const u=this._timeline[l];if(mm(u[n],e))a=l;else break}return a}else{if(xB(o[n],e)&&LA(c[n],e))return a;LA(o[n],e)?s=a:i=a+1}}return-1}_iterate(e,n=0,i=this._timeline.length-1){this._timeline.slice(n,i+1).forEach(e)}forEach(e){return this._iterate(e),this}forEachBefore(e,n){const i=this._search(e);return i!==-1&&this._iterate(n,0,i),this}forEachAfter(e,n){const i=this._search(e);return this._iterate(n,i+1),this}forEachBetween(e,n,i){let r=this._search(e),s=this._search(n);return r!==-1&&s!==-1?(this._timeline[r].time!==e&&(r+=1),this._timeline[s].time===n&&(s-=1),this._iterate(i,r,s)):r===-1&&this._iterate(i,0,s),this}forEachFrom(e,n){let i=this._search(e);for(;i>=0&&this._timeline[i].time>=e;)i--;return this._iterate(n,i+1),this}forEachAtTime(e,n){const i=this._search(e);if(i!==-1&&mm(this._timeline[i].time,e)){let r=i;for(let s=i;s>=0&&mm(this._timeline[s].time,e);s--)r=s;this._iterate(s=>{n(s)},r,i)}return this}dispose(){return super.dispose(),this._timeline=[],this}}const VEe=[];function O8(t){VEe.push(t)}function qEt(t){VEe.forEach(e=>e(t))}const GEe=[];function N8(t){GEe.push(t)}function $Et(t){GEe.forEach(e=>e(t))}class tP extends Z_{constructor(){super(...arguments),this.name="Emitter"}on(e,n){return e.split(/\W+/).forEach(r=>{mf(this._events)&&(this._events={}),this._events.hasOwnProperty(r)||(this._events[r]=[]),this._events[r].push(n)}),this}once(e,n){const i=(...r)=>{n(...r),this.off(e,i)};return this.on(e,i),this}off(e,n){return e.split(/\W+/).forEach(r=>{if(mf(this._events)&&(this._events={}),this._events.hasOwnProperty(r))if(mf(n))this._events[r]=[];else{const s=this._events[r];for(let a=s.length-1;a>=0;a--)s[a]===n&&s.splice(a,1)}}),this}emit(e,...n){if(this._events&&this._events.hasOwnProperty(e)){const i=this._events[e].slice(0);for(let r=0,s=i.length;r<s;r++)i[r].apply(this,n)}return this}static mixin(e){["on","once","off","emit"].forEach(n=>{const i=Object.getOwnPropertyDescriptor(tP.prototype,n);Object.defineProperty(e.prototype,n,i)})}dispose(){return super.dispose(),this._events=void 0,this}}class qEe extends tP{constructor(){super(...arguments),this.isOffline=!1}toJSON(){return{}}}class CR extends qEe{constructor(){var e,n;super(),this.name="Context",this._constants=new Map,this._timeouts=new yp,this._timeoutIds=0,this._initialized=!1,this._closeStarted=!1,this.isOffline=!1,this._workletPromise=null;const i=Mn(CR.getDefaults(),arguments,["context"]);i.context?(this._context=i.context,this._latencyHint=((e=arguments[0])===null||e===void 0?void 0:e.latencyHint)||""):(this._context=DEt({latencyHint:i.latencyHint}),this._latencyHint=i.latencyHint),this._ticker=new FEt(this.emit.bind(this,"tick"),i.clockSource,i.updateInterval,this._context.sampleRate),this.on("tick",this._timeoutLoop.bind(this)),this._context.onstatechange=()=>{this.emit("statechange",this.state)},this[!((n=arguments[0])===null||n===void 0)&&n.hasOwnProperty("updateInterval")?"_lookAhead":"lookAhead"]=i.lookAhead}static getDefaults(){return{clockSource:"worker",latencyHint:"interactive",lookAhead:.1,updateInterval:.05}}initialize(){return this._initialized||(qEt(this),this._initialized=!0),this}createAnalyser(){return this._context.createAnalyser()}createOscillator(){return this._context.createOscillator()}createBufferSource(){return this._context.createBufferSource()}createBiquadFilter(){return this._context.createBiquadFilter()}createBuffer(e,n,i){return this._context.createBuffer(e,n,i)}createChannelMerger(e){return this._context.createChannelMerger(e)}createChannelSplitter(e){return this._context.createChannelSplitter(e)}createConstantSource(){return this._context.createConstantSource()}createConvolver(){return this._context.createConvolver()}createDelay(e){return this._context.createDelay(e)}createDynamicsCompressor(){return this._context.createDynamicsCompressor()}createGain(){return this._context.createGain()}createIIRFilter(e,n){return this._context.createIIRFilter(e,n)}createPanner(){return this._context.createPanner()}createPeriodicWave(e,n,i){return this._context.createPeriodicWave(e,n,i)}createStereoPanner(){return this._context.createStereoPanner()}createWaveShaper(){return this._context.createWaveShaper()}createMediaStreamSource(e){return Ri(Iw(this._context),"Not available if OfflineAudioContext"),this._context.createMediaStreamSource(e)}createMediaElementSource(e){return Ri(Iw(this._context),"Not available if OfflineAudioContext"),this._context.createMediaElementSource(e)}createMediaStreamDestination(){return Ri(Iw(this._context),"Not available if OfflineAudioContext"),this._context.createMediaStreamDestination()}decodeAudioData(e){return this._context.decodeAudioData(e)}get currentTime(){return this._context.currentTime}get state(){return this._context.state}get sampleRate(){return this._context.sampleRate}get listener(){return this.initialize(),this._listener}set listener(e){Ri(!this._initialized,"The listener cannot be set after initialization."),this._listener=e}get transport(){return this.initialize(),this._transport}set transport(e){Ri(!this._initialized,"The transport cannot be set after initialization."),this._transport=e}get draw(){return this.initialize(),this._draw}set draw(e){Ri(!this._initialized,"Draw cannot be set after initialization."),this._draw=e}get destination(){return this.initialize(),this._destination}set destination(e){Ri(!this._initialized,"The destination cannot be set after initialization."),this._destination=e}createAudioWorkletNode(e,n){return BEt(this.rawContext,e,n)}addAudioWorkletModule(e){return oo(this,void 0,void 0,function*(){Ri(_r(this.rawContext.audioWorklet),"AudioWorkletNode is only available in a secure context (https or localhost)"),this._workletPromise||(this._workletPromise=this.rawContext.audioWorklet.addModule(e)),yield this._workletPromise})}workletsAreReady(){return oo(this,void 0,void 0,function*(){(yield this._workletPromise)?this._workletPromise:Promise.resolve()})}get updateInterval(){return this._ticker.updateInterval}set updateInterval(e){this._ticker.updateInterval=e}get clockSource(){return this._ticker.type}set clockSource(e){this._ticker.type=e}get lookAhead(){return this._lookAhead}set lookAhead(e){this._lookAhead=e,this.updateInterval=e?e/2:.01}get latencyHint(){return this._latencyHint}get rawContext(){return this._context}now(){return this._context.currentTime+this._lookAhead}immediate(){return this._context.currentTime}resume(){return Iw(this._context)?this._context.resume():Promise.resolve()}close(){return oo(this,void 0,void 0,function*(){Iw(this._context)&&this.state!=="closed"&&!this._closeStarted&&(this._closeStarted=!0,yield this._context.close()),this._initialized&&$Et(this)})}getConstant(e){if(this._constants.has(e))return this._constants.get(e);{const n=this._context.createBuffer(1,128,this._context.sampleRate),i=n.getChannelData(0);for(let s=0;s<i.length;s++)i[s]=e;const r=this._context.createBufferSource();return r.channelCount=1,r.channelCountMode="explicit",r.buffer=n,r.loop=!0,r.start(0),this._constants.set(e,r),r}}dispose(){return super.dispose(),this._ticker.dispose(),this._timeouts.dispose(),Object.keys(this._constants).map(e=>this._constants[e].disconnect()),this.close(),this}_timeoutLoop(){const e=this.now();this._timeouts.forEachBefore(e,n=>{n.callback(),this._timeouts.remove(n)})}setTimeout(e,n){this._timeoutIds++;const i=this.now();return this._timeouts.add({callback:e,id:this._timeoutIds,time:i+n}),this._timeoutIds}clearTimeout(e){return this._timeouts.forEach(n=>{n.id===e&&this._timeouts.remove(n)}),this}clearInterval(e){return this.clearTimeout(e)}setInterval(e,n){const i=++this._timeoutIds,r=()=>{const s=this.now();this._timeouts.add({callback:()=>{e(),r()},id:i,time:s+n})};return r(),i}}class WEt extends qEe{constructor(){super(...arguments),this.lookAhead=0,this.latencyHint=0,this.isOffline=!1}createAnalyser(){return{}}createOscillator(){return{}}createBufferSource(){return{}}createBiquadFilter(){return{}}createBuffer(e,n,i){return{}}createChannelMerger(e){return{}}createChannelSplitter(e){return{}}createConstantSource(){return{}}createConvolver(){return{}}createDelay(e){return{}}createDynamicsCompressor(){return{}}createGain(){return{}}createIIRFilter(e,n){return{}}createPanner(){return{}}createPeriodicWave(e,n,i){return{}}createStereoPanner(){return{}}createWaveShaper(){return{}}createMediaStreamSource(e){return{}}createMediaElementSource(e){return{}}createMediaStreamDestination(){return{}}decodeAudioData(e){return Promise.resolve({})}createAudioWorkletNode(e,n){return{}}get rawContext(){return{}}addAudioWorkletModule(e){return oo(this,void 0,void 0,function*(){return Promise.resolve()})}resume(){return Promise.resolve()}setTimeout(e,n){return 0}clearTimeout(e){return this}setInterval(e,n){return 0}clearInterval(e){return this}getConstant(e){return{}}get currentTime(){return 0}get state(){return{}}get sampleRate(){return 0}get listener(){return{}}get transport(){return{}}get draw(){return{}}set draw(e){}get destination(){return{}}set destination(e){}now(){return 0}immediate(){return 0}}function br(t,e){hd(e)?e.forEach(n=>br(t,n)):Object.defineProperty(t,e,{enumerable:!0,writable:!1})}function nP(t,e){hd(e)?e.forEach(n=>nP(t,n)):Object.defineProperty(t,e,{writable:!0})}const Ss=()=>{};class Hs extends Z_{constructor(){super(),this.name="ToneAudioBuffer",this.onload=Ss;const e=Mn(Hs.getDefaults(),arguments,["url","onload","onerror"]);this.reverse=e.reverse,this.onload=e.onload,B_(e.url)?this.load(e.url).catch(e.onerror):e.url&&this.set(e.url)}static getDefaults(){return{onerror:Ss,onload:Ss,reverse:!1}}get sampleRate(){return this._buffer?this._buffer.sampleRate:Yo().sampleRate}set(e){return e instanceof Hs?e.loaded?this._buffer=e.get():e.onload=()=>{this.set(e),this.onload(this)}:this._buffer=e,this._reversed&&this._reverse(),this}get(){return this._buffer}load(e){return oo(this,void 0,void 0,function*(){const n=Hs.load(e).then(i=>{this.set(i),this.onload(this)});Hs.downloads.push(n);try{yield n}finally{const i=Hs.downloads.indexOf(n);Hs.downloads.splice(i,1)}return this})}dispose(){return super.dispose(),this._buffer=void 0,this}fromArray(e){const n=hd(e)&&e[0].length>0,i=n?e.length:1,r=n?e[0].length:e.length,s=Yo(),a=s.createBuffer(i,r,s.sampleRate),o=!n&&i===1?[e]:e;for(let c=0;c<i;c++)a.copyToChannel(o[c],c);return this._buffer=a,this}toMono(e){if(Om(e))this.fromArray(this.toArray(e));else{let n=new Float32Array(this.length);const i=this.numberOfChannels;for(let r=0;r<i;r++){const s=this.toArray(r);for(let a=0;a<s.length;a++)n[a]+=s[a]}n=n.map(r=>r/i),this.fromArray(n)}return this}toArray(e){if(Om(e))return this.getChannelData(e);if(this.numberOfChannels===1)return this.toArray(0);{const n=[];for(let i=0;i<this.numberOfChannels;i++)n[i]=this.getChannelData(i);return n}}getChannelData(e){return this._buffer?this._buffer.getChannelData(e):new Float32Array(0)}slice(e,n=this.duration){Ri(this.loaded,"Buffer is not loaded");const i=Math.floor(e*this.sampleRate),r=Math.floor(n*this.sampleRate);Ri(i<r,"The start time must be less than the end time");const s=r-i,a=Yo().createBuffer(this.numberOfChannels,s,this.sampleRate);for(let o=0;o<this.numberOfChannels;o++)a.copyToChannel(this.getChannelData(o).subarray(i,r),o);return new Hs(a)}_reverse(){if(this.loaded)for(let e=0;e<this.numberOfChannels;e++)this.getChannelData(e).reverse();return this}get loaded(){return this.length>0}get duration(){return this._buffer?this._buffer.duration:0}get length(){return this._buffer?this._buffer.length:0}get numberOfChannels(){return this._buffer?this._buffer.numberOfChannels:0}get reverse(){return this._reversed}set reverse(e){this._reversed!==e&&(this._reversed=e,this._reverse())}static fromArray(e){return new Hs().fromArray(e)}static fromUrl(e){return oo(this,void 0,void 0,function*(){return yield new Hs().load(e)})}static load(e){return oo(this,void 0,void 0,function*(){const n=Hs.baseUrl===""||Hs.baseUrl.endsWith("/")?Hs.baseUrl:Hs.baseUrl+"/",i=yield fetch(n+e);if(!i.ok)throw new Error(`could not load url: ${e}`);const r=yield i.arrayBuffer();return yield Yo().decodeAudioData(r)})}static supportsType(e){const n=e.split("."),i=n[n.length-1];return document.createElement("audio").canPlayType("audio/"+i)!==""}static loaded(){return oo(this,void 0,void 0,function*(){for(yield Promise.resolve();Hs.downloads.length;)yield Hs.downloads[0]})}}Hs.baseUrl="";Hs.downloads=[];class I8 extends CR{constructor(){super({clockSource:"offline",context:TL(arguments[0])?arguments[0]:LEt(arguments[0],arguments[1]*arguments[2],arguments[2]),lookAhead:0,updateInterval:TL(arguments[0])?128/arguments[0].sampleRate:128/arguments[2]}),this.name="OfflineContext",this._currentTime=0,this.isOffline=!0,this._duration=TL(arguments[0])?arguments[0].length/arguments[0].sampleRate:arguments[1]}now(){return this._currentTime}get currentTime(){return this._currentTime}_renderClock(e){return oo(this,void 0,void 0,function*(){let n=0;for(;this._duration-this._currentTime>=0;){this.emit("tick"),this._currentTime+=128/this.sampleRate,n++;const i=Math.floor(this.sampleRate/128);e&&n%i===0&&(yield new Promise(r=>setTimeout(r,1)))}})}render(){return oo(this,arguments,void 0,function*(e=!0){yield this.workletsAreReady(),yield this._renderClock(e);const n=yield this._context.startRendering();return new Hs(n)})}close(){return Promise.resolve()}}const $Ee=new WEt;let wT=$Ee;function Yo(){return wT===$Ee&&UEt&&WEe(new CR),wT}function WEe(t,e=!1){e&&wT.dispose(),Iw(t)?wT=new CR(t):TL(t)?wT=new I8(t):wT=t}function YEt(){return wT.resume()}if(ef&&!ef.TONE_SILENCE_LOGGING){const e=` * Tone.js v${qbe} * `;console.log(`%c${e}`,"background: #000; color: #fff")}function YEe(t){return Math.pow(10,t/20)}function KEe(t){return 20*(Math.log(t)/Math.LN10)}function XEe(t){return Math.pow(2,t/12)}let k8=440;function KEt(){return k8}function XEt(t){k8=t}function CT(t){return Math.round(ZEe(t))}function ZEe(t){return 69+12*Math.log2(t/k8)}function JEe(t){return k8*Math.pow(2,(t-69)/12)}class MX extends Z_{constructor(e,n,i){super(),this.defaultUnits="s",this._val=n,this._units=i,this.context=e,this._expressions=this._getExpressions()}_getExpressions(){return{hz:{method:e=>this._frequencyToUnits(parseFloat(e)),regexp:/^(\d+(?:\.\d+)?)hz$/i},i:{method:e=>this._ticksToUnits(parseInt(e,10)),regexp:/^(\d+)i$/i},m:{method:e=>this._beatsToUnits(parseInt(e,10)*this._getTimeSignature()),regexp:/^(\d+)m$/i},n:{method:(e,n)=>{const i=parseInt(e,10),r=n==="."?1.5:1;return i===1?this._beatsToUnits(this._getTimeSignature())*r:this._beatsToUnits(4/i)*r},regexp:/^(\d+)n(\.?)$/i},number:{method:e=>this._expressions[this.defaultUnits].method.call(this,e),regexp:/^(\d+(?:\.\d+)?)$/},s:{method:e=>this._secondsToUnits(parseFloat(e)),regexp:/^(\d+(?:\.\d+)?)s$/},samples:{method:e=>parseInt(e,10)/this.context.sampleRate,regexp:/^(\d+)samples$/},t:{method:e=>{const n=parseInt(e,10);return this._beatsToUnits(8/(Math.floor(n)*3))},regexp:/^(\d+)t$/i},tr:{method:(e,n,i)=>{let r=0;return e&&e!=="0"&&(r+=this._beatsToUnits(this._getTimeSignature()*parseFloat(e))),n&&n!=="0"&&(r+=this._beatsToUnits(parseFloat(n))),i&&i!=="0"&&(r+=this._beatsToUnits(parseFloat(i)/4)),r},regexp:/^(\d+(?:\.\d+)?):(\d+(?:\.\d+)?):?(\d+(?:\.\d+)?)?$/}}}valueOf(){if(this._val instanceof MX&&this.fromType(this._val),mf(this._val))return this._noArg();if(B_(this._val)&&mf(this._units)){for(const e in this._expressions)if(this._expressions[e].regexp.test(this._val.trim())){this._units=e;break}}else if(Xb(this._val)){let e=0;for(const n in this._val)if(_r(this._val[n])){const i=this._val[n],r=new this.constructor(this.context,n).valueOf()*i;e+=r}return e}if(_r(this._units)){const e=this._expressions[this._units],n=this._val.toString().trim().match(e.regexp);return n?e.method.apply(this,n.slice(1)):e.method.call(this,this._val)}else return B_(this._val)?parseFloat(this._val):this._val}_frequencyToUnits(e){return 1/e}_beatsToUnits(e){return 60/this._getBpm()*e}_secondsToUnits(e){return e}_ticksToUnits(e){return e*this._beatsToUnits(1)/this._getPPQ()}_noArg(){return this._now()}_getBpm(){return this.context.transport.bpm.value}_getTimeSignature(){return this.context.transport.timeSignature}_getPPQ(){return this.context.transport.PPQ}fromType(e){switch(this._units=void 0,this.defaultUnits){case"s":this._val=e.toSeconds();break;case"i":this._val=e.toTicks();break;case"hz":this._val=e.toFrequency();break;case"midi":this._val=e.toMidi();break}return this}toFrequency(){return 1/this.toSeconds()}toSamples(){return this.toSeconds()*this.context.sampleRate}toMilliseconds(){return this.toSeconds()*1e3}}class mp extends MX{constructor(){super(...arguments),this.name="TimeClass"}_getExpressions(){return Object.assign(super._getExpressions(),{now:{method:e=>this._now()+new this.constructor(this.context,e).valueOf(),regexp:/^\+(.+)/},quantize:{method:e=>{const n=new mp(this.context,e).valueOf();return this._secondsToUnits(this.context.transport.nextSubdivision(n))},regexp:/^@(.+)/}})}quantize(e,n=1){const i=new this.constructor(this.context,e).valueOf(),r=this.valueOf(),o=Math.round(r/i)*i-r;return r+o*n}toNotation(){const e=this.toSeconds(),n=["1m"];for(let s=1;s<9;s++){const a=Math.pow(2,s);n.push(a+"n."),n.push(a+"n"),n.push(a+"t")}n.push("0");let i=n[0],r=new mp(this.context,n[0]).toSeconds();return n.forEach(s=>{const a=new mp(this.context,s).toSeconds();Math.abs(a-e)<Math.abs(r-e)&&(i=s,r=a)}),i}toBarsBeatsSixteenths(){const e=this._beatsToUnits(1);let n=this.valueOf()/e;n=parseFloat(n.toFixed(4));const i=Math.floor(n/this._getTimeSignature());let r=n%1*4;n=Math.floor(n)%this._getTimeSignature();const s=r.toString();return s.length>3&&(r=parseFloat(parseFloat(s).toFixed(3))),[i,n,r].join(":")}toTicks(){const e=this._beatsToUnits(1);return this.valueOf()/e*this._getPPQ()}toSeconds(){return this.valueOf()}toMidi(){return CT(this.toFrequency())}_now(){return this.context.now()}}function Uc(t,e){return new mp(Yo(),t,e)}class cd extends mp{constructor(){super(...arguments),this.name="Frequency",this.defaultUnits="hz"}static get A4(){return KEt()}static set A4(e){XEt(e)}_getExpressions(){return Object.assign({},super._getExpressions(),{midi:{regexp:/^(\d+(?:\.\d+)?midi)/,method(e){return this.defaultUnits==="midi"?e:cd.mtof(e)}},note:{regexp:/^([a-g]{1}(?:b|#|##|x|bb|###|#x|x#|bbb)?)(-?[0-9]+)/i,method(e,n){const r=ZEt[e.toLowerCase()]+(parseInt(n,10)+1)*12;return this.defaultUnits==="midi"?r:cd.mtof(r)}},tr:{regexp:/^(\d+(?:\.\d+)?):(\d+(?:\.\d+)?):?(\d+(?:\.\d+)?)?/,method(e,n,i){let r=1;return e&&e!=="0"&&(r*=this._beatsToUnits(this._getTimeSignature()*parseFloat(e))),n&&n!=="0"&&(r*=this._beatsToUnits(parseFloat(n))),i&&i!=="0"&&(r*=this._beatsToUnits(parseFloat(i)/4)),r}}})}transpose(e){return new cd(this.context,this.valueOf()*XEe(e))}harmonize(e){return e.map(n=>this.transpose(n))}toMidi(){return CT(this.valueOf())}toNote(){const e=this.toFrequency(),n=Math.log2(e/cd.A4);let i=Math.round(12*n)+57;const r=Math.floor(i/12);return r<0&&(i+=-12*r),JEt[i%12]+r.toString()}toSeconds(){return 1/super.toSeconds()}toTicks(){const e=this._beatsToUnits(1),n=this.valueOf()/e;return Math.floor(n*this._getPPQ())}_noArg(){return 0}_frequencyToUnits(e){return e}_ticksToUnits(e){return 1/(e*60/(this._getBpm()*this._getPPQ()))}_beatsToUnits(e){return 1/super._beatsToUnits(e)}_secondsToUnits(e){return 1/e}static mtof(e){return JEe(e)}static ftom(e){return CT(e)}}const ZEt={cbbb:-3,cbb:-2,cb:-1,c:0,"c#":1,cx:2,"c##":2,"c###":3,"cx#":3,"c#x":3,dbbb:-1,dbb:0,db:1,d:2,"d#":3,dx:4,"d##":4,"d###":5,"dx#":5,"d#x":5,ebbb:1,ebb:2,eb:3,e:4,"e#":5,ex:6,"e##":6,"e###":7,"ex#":7,"e#x":7,fbbb:2,fbb:3,fb:4,f:5,"f#":6,fx:7,"f##":7,"f###":8,"fx#":8,"f#x":8,gbbb:4,gbb:5,gb:6,g:7,"g#":8,gx:9,"g##":9,"g###":10,"gx#":10,"g#x":10,abbb:6,abb:7,ab:8,a:9,"a#":10,ax:11,"a##":11,"a###":12,"ax#":12,"a#x":12,bbbb:8,bbb:9,bb:10,b:11,"b#":12,bx:13,"b##":13,"b###":14,"bx#":14,"b#x":14},JEt=["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"];function oae(t,e){return new cd(Yo(),t,e)}class MC extends mp{constructor(){super(...arguments),this.name="TransportTime"}_now(){return this.context.transport.seconds}}class wu extends Z_{constructor(){super();const e=Mn(wu.getDefaults(),arguments,["context"]);this.defaultContext?this.context=this.defaultContext:this.context=e.context}static getDefaults(){return{context:Yo()}}now(){return this.context.currentTime+this.context.lookAhead}immediate(){return this.context.currentTime}get sampleTime(){return 1/this.context.sampleRate}get blockTime(){return 128/this.context.sampleRate}toSeconds(e){return kEt(e),new mp(this.context,e).toSeconds()}toFrequency(e){return new cd(this.context,e).toFrequency()}toTicks(e){return new MC(this.context,e).toTicks()}_getPartialProperties(e){const n=this.get();return Object.keys(n).forEach(i=>{mf(e[i])&&delete n[i]}),n}get(){const e=VEt(this);return Object.keys(e).forEach(n=>{if(Reflect.has(this,n)){const i=this[n];_r(i)&&_r(i.value)&&_r(i.setValueAtTime)?e[n]=i.value:i instanceof wu?e[n]=i._getPartialProperties(e[n]):hd(i)||Om(i)||B_(i)||BEe(i)?e[n]=i:delete e[n]}}),e}set(e){return Object.keys(e).forEach(n=>{Reflect.has(this,n)&&_r(this[n])&&(this[n]&&_r(this[n].value)&&_r(this[n].setValueAtTime)?this[n].value!==e[n]&&(this[n].value=e[n]):this[n]instanceof wu?this[n].set(e[n]):this[n]=e[n])}),this}}class iP extends yp{constructor(e="stopped"){super(),this.name="StateTimeline",this._initial=e,this.setStateAtTime(this._initial,0)}getValueAtTime(e){const n=this.get(e);return n!==null?n.state:this._initial}setStateAtTime(e,n,i){return pp(n,0),this.add(Object.assign({},i,{state:e,time:n})),this}getLastState(e,n){const i=this._search(n);for(let r=i;r>=0;r--){const s=this._timeline[r];if(s.state===e)return s}}getNextState(e,n){const i=this._search(n);if(i!==-1)for(let r=i;r<this._timeline.length;r++){const s=this._timeline[r];if(s.state===e)return s}}}class gr extends wu{constructor(){const e=Mn(gr.getDefaults(),arguments,["param","units","convert"]);for(super(e),this.name="Param",this.overridden=!1,this._minOutput=1e-7,Ri(_r(e.param)&&(R1(e.param)||e.param instanceof gr),"param must be an AudioParam");!R1(e.param);)e.param=e.param._param;this._swappable=_r(e.swappable)?e.swappable:!1,this._swappable?(this.input=this.context.createGain(),this._param=e.param,this.input.connect(this._param)):this._param=this.input=e.param,this._events=new yp(1e3),this._initialValue=this._param.defaultValue,this.units=e.units,this.convert=e.convert,this._minValue=e.minValue,this._maxValue=e.maxValue,_r(e.value)&&e.value!==this._toType(this._initialValue)&&this.setValueAtTime(e.value,0)}static getDefaults(){return Object.assign(wu.getDefaults(),{convert:!0,units:"number"})}get value(){const e=this.now();return this.getValueAtTime(e)}set value(e){this.cancelScheduledValues(this.now()),this.setValueAtTime(e,this.now())}get minValue(){return _r(this._minValue)?this._minValue:this.units==="time"||this.units==="frequency"||this.units==="normalRange"||this.units==="positive"||this.units==="transportTime"||this.units==="ticks"||this.units==="bpm"||this.units==="hertz"||this.units==="samples"?0:this.units==="audioRange"?-1:this.units==="decibels"?-1/0:this._param.minValue}get maxValue(){return _r(this._maxValue)?this._maxValue:this.units==="normalRange"||this.units==="audioRange"?1:this._param.maxValue}_is(e,n){return this.units===n}_assertRange(e){return _r(this.maxValue)&&_r(this.minValue)&&pp(e,this._fromType(this.minValue),this._fromType(this.maxValue)),e}_fromType(e){return this.convert&&!this.overridden?this._is(e,"time")?this.toSeconds(e):this._is(e,"decibels")?YEe(e):this._is(e,"frequency")?this.toFrequency(e):e:this.overridden?0:e}_toType(e){return this.convert&&this.units==="decibels"?KEe(e):e}setValueAtTime(e,n){const i=this.toSeconds(n),r=this._fromType(e);return Ri(isFinite(r)&&isFinite(i),`Invalid argument(s) to setValueAtTime: ${JSON.stringify(e)}, ${JSON.stringify(n)}`),this._assertRange(r),this.log(this.units,"setValueAtTime",e,i),this._events.add({time:i,type:"setValueAtTime",value:r}),this._param.setValueAtTime(r,i),this}getValueAtTime(e){const n=Math.max(this.toSeconds(e),0),i=this._events.getAfter(n),r=this._events.get(n);let s=this._initialValue;if(r===null)s=this._initialValue;else if(r.type==="setTargetAtTime"&&(i===null||i.type==="setValueAtTime")){const a=this._events.getBefore(r.time);let o;a===null?o=this._initialValue:o=a.value,r.type==="setTargetAtTime"&&(s=this._exponentialApproach(r.time,o,r.value,r.constant,n))}else if(i===null)s=r.value;else if(i.type==="linearRampToValueAtTime"||i.type==="exponentialRampToValueAtTime"){let a=r.value;if(r.type==="setTargetAtTime"){const o=this._events.getBefore(r.time);o===null?a=this._initialValue:a=o.value}i.type==="linearRampToValueAtTime"?s=this._linearInterpolate(r.time,a,i.time,i.value,n):s=this._exponentialInterpolate(r.time,a,i.time,i.value,n)}else s=r.value;return this._toType(s)}setRampPoint(e){e=this.toSeconds(e);let n=this.getValueAtTime(e);return this.cancelAndHoldAtTime(e),this._fromType(n)===0&&(n=this._toType(this._minOutput)),this.setValueAtTime(n,e),this}linearRampToValueAtTime(e,n){const i=this._fromType(e),r=this.toSeconds(n);return Ri(isFinite(i)&&isFinite(r),`Invalid argument(s) to linearRampToValueAtTime: ${JSON.stringify(e)}, ${JSON.stringify(n)}`),this._assertRange(i),this._events.add({time:r,type:"linearRampToValueAtTime",value:i}),this.log(this.units,"linearRampToValueAtTime",e,r),this._param.linearRampToValueAtTime(i,r),this}exponentialRampToValueAtTime(e,n){let i=this._fromType(e);i=mm(i,0)?this._minOutput:i,this._assertRange(i);const r=this.toSeconds(n);return Ri(isFinite(i)&&isFinite(r),`Invalid argument(s) to exponentialRampToValueAtTime: ${JSON.stringify(e)}, ${JSON.stringify(n)}`),this._events.add({time:r,type:"exponentialRampToValueAtTime",value:i}),this.log(this.units,"exponentialRampToValueAtTime",e,r),this._param.exponentialRampToValueAtTime(i,r),this}exponentialRampTo(e,n,i){return i=this.toSeconds(i),this.setRampPoint(i),this.exponentialRampToValueAtTime(e,i+this.toSeconds(n)),this}linearRampTo(e,n,i){return i=this.toSeconds(i),this.setRampPoint(i),this.linearRampToValueAtTime(e,i+this.toSeconds(n)),this}targetRampTo(e,n,i){return i=this.toSeconds(i),this.setRampPoint(i),this.exponentialApproachValueAtTime(e,i,n),this}exponentialApproachValueAtTime(e,n,i){n=this.toSeconds(n),i=this.toSeconds(i);const r=Math.log(i+1)/Math.log(200);return this.setTargetAtTime(e,n,r),this.cancelAndHoldAtTime(n+i*.9),this.linearRampToValueAtTime(e,n+i),this}setTargetAtTime(e,n,i){const r=this._fromType(e);Ri(isFinite(i)&&i>0,"timeConstant must be a number greater than 0");const s=this.toSeconds(n);return this._assertRange(r),Ri(isFinite(r)&&isFinite(s),`Invalid argument(s) to setTargetAtTime: ${JSON.stringify(e)}, ${JSON.stringify(n)}`),this._events.add({constant:i,time:s,type:"setTargetAtTime",value:r}),this.log(this.units,"setTargetAtTime",e,s,i),this._param.setTargetAtTime(r,s,i),this}setValueCurveAtTime(e,n,i,r=1){i=this.toSeconds(i),n=this.toSeconds(n);const s=this._fromType(e[0])*r;this.setValueAtTime(this._toType(s),n);const a=i/(e.length-1);for(let o=1;o<e.length;o++){const c=this._fromType(e[o])*r;this.linearRampToValueAtTime(this._toType(c),n+o*a)}return this}cancelScheduledValues(e){const n=this.toSeconds(e);return Ri(isFinite(n),`Invalid argument to cancelScheduledValues: ${JSON.stringify(e)}`),this._events.cancel(n),this._param.cancelScheduledValues(n),this.log(this.units,"cancelScheduledValues",n),this}cancelAndHoldAtTime(e){const n=this.toSeconds(e),i=this._fromType(this.getValueAtTime(n));Ri(isFinite(n),`Invalid argument to cancelAndHoldAtTime: ${JSON.stringify(e)}`),this.log(this.units,"cancelAndHoldAtTime",n,"value="+i);const r=this._events.get(n),s=this._events.getAfter(n);return r&&mm(r.time,n)?s?(this._param.cancelScheduledValues(s.time),this._events.cancel(s.time)):(this._param.cancelAndHoldAtTime(n),this._events.cancel(n+this.sampleTime)):s&&(this._param.cancelScheduledValues(s.time),this._events.cancel(s.time),s.type==="linearRampToValueAtTime"?this.linearRampToValueAtTime(this._toType(i),n):s.type==="exponentialRampToValueAtTime"&&this.exponentialRampToValueAtTime(this._toType(i),n)),this._events.add({time:n,type:"setValueAtTime",value:i}),this._param.setValueAtTime(i,n),this}rampTo(e,n=.1,i){return this.units==="frequency"||this.units==="bpm"||this.units==="decibels"?this.exponentialRampTo(e,n,i):this.linearRampTo(e,n,i),this}apply(e){const n=this.context.currentTime;e.setValueAtTime(this.getValueAtTime(n),n);const i=this._events.get(n);if(i&&i.type==="setTargetAtTime"){const r=this._events.getAfter(i.time),s=r?r.time:n+2,a=(s-n)/10;for(let o=n;o<s;o+=a)e.linearRampToValueAtTime(this.getValueAtTime(o),o)}return this._events.forEachAfter(this.context.currentTime,r=>{r.type==="cancelScheduledValues"?e.cancelScheduledValues(r.time):r.type==="setTargetAtTime"?e.setTargetAtTime(r.value,r.time,r.constant):e[r.type](r.value,r.time)}),this}setParam(e){Ri(this._swappable,"The Param must be assigned as 'swappable' in the constructor");const n=this.input;return n.disconnect(this._param),this.apply(e),this._param=e,n.connect(this._param),this}dispose(){return super.dispose(),this._events.dispose(),this}get defaultValue(){return this._toType(this._param.defaultValue)}_exponentialApproach(e,n,i,r,s){return i+(n-i)*Math.exp(-(s-e)/r)}_linearInterpolate(e,n,i,r,s){return n+(r-n)*((s-e)/(i-e))}_exponentialInterpolate(e,n,i,r,s){return n*Math.pow(r/n,(s-e)/(i-e))}}class Ln extends wu{constructor(){super(...arguments),this._internalChannels=[]}get numberOfInputs(){return _r(this.input)?R1(this.input)||this.input instanceof gr?1:this.input.numberOfInputs:0}get numberOfOutputs(){return _r(this.output)?this.output.numberOfOutputs:0}_isAudioNode(e){return _r(e)&&(e instanceof Ln||Zb(e))}_getInternalNodes(){const e=this._internalChannels.slice(0);return this._isAudioNode(this.input)&&e.push(this.input),this._isAudioNode(this.output)&&this.input!==this.output&&e.push(this.output),e}_setChannelProperties(e){this._getInternalNodes().forEach(i=>{i.channelCount=e.channelCount,i.channelCountMode=e.channelCountMode,i.channelInterpretation=e.channelInterpretation})}_getChannelProperties(){const e=this._getInternalNodes();Ri(e.length>0,"ToneAudioNode does not have any internal nodes");const n=e[0];return{channelCount:n.channelCount,channelCountMode:n.channelCountMode,channelInterpretation:n.channelInterpretation}}get channelCount(){return this._getChannelProperties().channelCount}set channelCount(e){const n=this._getChannelProperties();this._setChannelProperties(Object.assign(n,{channelCount:e}))}get channelCountMode(){return this._getChannelProperties().channelCountMode}set channelCountMode(e){const n=this._getChannelProperties();this._setChannelProperties(Object.assign(n,{channelCountMode:e}))}get channelInterpretation(){return this._getChannelProperties().channelInterpretation}set channelInterpretation(e){const n=this._getChannelProperties();this._setChannelProperties(Object.assign(n,{channelInterpretation:e}))}connect(e,n=0,i=0){return Rp(this,e,n,i),this}toDestination(){return this.connect(this.context.destination),this}toMaster(){return R8("toMaster() has been renamed toDestination()"),this.toDestination()}disconnect(e,n=0,i=0){return QEe(this,e,n,i),this}chain(...e){return M1(this,...e),this}fan(...e){return e.forEach(n=>this.connect(n)),this}dispose(){return super.dispose(),_r(this.input)&&(this.input instanceof Ln?this.input.dispose():Zb(this.input)&&this.input.disconnect()),_r(this.output)&&(this.output instanceof Ln?this.output.dispose():Zb(this.output)&&this.output.disconnect()),this._internalChannels=[],this}}function M1(...t){const e=t.shift();t.reduce((n,i)=>(n instanceof Ln?n.connect(i):Zb(n)&&Rp(n,i),i),e)}function Rp(t,e,n=0,i=0){for(Ri(_r(t),"Cannot connect from undefined node"),Ri(_r(e),"Cannot connect to undefined node"),(e instanceof Ln||Zb(e))&&Ri(e.numberOfInputs>0,"Cannot connect to node with no inputs"),Ri(t.numberOfOutputs>0,"Cannot connect from node with no outputs");e instanceof Ln||e instanceof gr;)_r(e.input)&&(e=e.input);for(;t instanceof Ln;)_r(t.output)&&(t=t.output);R1(e)?t.connect(e,n):t.connect(e,n,i)}function QEe(t,e,n=0,i=0){if(_r(e))for(;e instanceof Ln;)e=e.input;for(;!Zb(t);)_r(t.output)&&(t=t.output);R1(e)?t.disconnect(e,n):Zb(e)?t.disconnect(e,n,i):t.disconnect()}class Xi extends Ln{constructor(){const e=Mn(Xi.getDefaults(),arguments,["gain","units"]);super(e),this.name="Gain",this._gainNode=this.context.createGain(),this.input=this._gainNode,this.output=this._gainNode,this.gain=new gr({context:this.context,convert:e.convert,param:this._gainNode.gain,units:e.units,value:e.gain,minValue:e.minValue,maxValue:e.maxValue}),br(this,"gain")}static getDefaults(){return Object.assign(Ln.getDefaults(),{convert:!0,gain:1,units:"gain"})}dispose(){return super.dispose(),this._gainNode.disconnect(),this.gain.dispose(),this}}class UA extends Ln{constructor(e){super(e),this.onended=Ss,this._startTime=-1,this._stopTime=-1,this._timeout=-1,this.output=new Xi({context:this.context,gain:0}),this._gainNode=this.output,this.getStateAtTime=function(n){const i=this.toSeconds(n);return this._startTime!==-1&&i>=this._startTime&&(this._stopTime===-1||i<=this._stopTime)?"started":"stopped"},this._fadeIn=e.fadeIn,this._fadeOut=e.fadeOut,this._curve=e.curve,this.onended=e.onended}static getDefaults(){return Object.assign(Ln.getDefaults(),{curve:"linear",fadeIn:0,fadeOut:0,onended:Ss})}_startGain(e,n=1){Ri(this._startTime===-1,"Source cannot be started more than once");const i=this.toSeconds(this._fadeIn);return this._startTime=e+i,this._startTime=Math.max(this._startTime,this.context.currentTime),i>0?(this._gainNode.gain.setValueAtTime(0,e),this._curve==="linear"?this._gainNode.gain.linearRampToValueAtTime(n,e+i):this._gainNode.gain.exponentialApproachValueAtTime(n,e,i)):this._gainNode.gain.setValueAtTime(n,e),this}stop(e){return this.log("stop",e),this._stopGain(this.toSeconds(e)),this}_stopGain(e){Ri(this._startTime!==-1,"'start' must be called before 'stop'"),this.cancelStop();const n=this.toSeconds(this._fadeOut);return this._stopTime=this.toSeconds(e)+n,this._stopTime=Math.max(this._stopTime,this.now()),n>0?this._curve==="linear"?this._gainNode.gain.linearRampTo(0,n,e):this._gainNode.gain.targetRampTo(0,n,e):(this._gainNode.gain.cancelAndHoldAtTime(e),this._gainNode.gain.setValueAtTime(0,e)),this.context.clearTimeout(this._timeout),this._timeout=this.context.setTimeout(()=>{const i=this._curve==="exponential"?n*2:0;this._stopSource(this.now()+i),this._onended()},this._stopTime-this.context.currentTime),this}_onended(){if(this.onended!==Ss&&(this.onended(this),this.onended=Ss,!this.context.isOffline)){const e=()=>this.dispose();typeof requestIdleCallback<"u"?requestIdleCallback(e):setTimeout(e,10)}}get state(){return this.getStateAtTime(this.now())}cancelStop(){return this.log("cancelStop"),Ri(this._startTime!==-1,"Source is not started"),this._gainNode.gain.cancelScheduledValues(this._startTime+this.sampleTime),this.context.clearTimeout(this._timeout),this._stopTime=-1,this}dispose(){return super.dispose(),this._gainNode.dispose(),this.onended=Ss,this}}class OX extends UA{constructor(){const e=Mn(OX.getDefaults(),arguments,["offset"]);super(e),this.name="ToneConstantSource",this._source=this.context.createConstantSource(),Rp(this._source,this._gainNode),this.offset=new gr({context:this.context,convert:e.convert,param:this._source.offset,units:e.units,value:e.offset,minValue:e.minValue,maxValue:e.maxValue})}static getDefaults(){return Object.assign(UA.getDefaults(),{convert:!0,offset:1,units:"number"})}start(e){const n=this.toSeconds(e);return this.log("start",n),this._startGain(n),this._source.start(n),this}_stopSource(e){this._source.stop(e)}dispose(){return super.dispose(),this.state==="started"&&this.stop(),this._source.disconnect(),this.offset.dispose(),this}}class Ir extends Ln{constructor(){const e=Mn(Ir.getDefaults(),arguments,["value","units"]);super(e),this.name="Signal",this.override=!0,this.output=this._constantSource=new OX({context:this.context,convert:e.convert,offset:e.value,units:e.units,minValue:e.minValue,maxValue:e.maxValue}),this._constantSource.start(0),this.input=this._param=this._constantSource.offset}static getDefaults(){return Object.assign(Ln.getDefaults(),{convert:!0,units:"number",value:0})}connect(e,n=0,i=0){return P8(this,e,n,i),this}dispose(){return super.dispose(),this._param.dispose(),this._constantSource.dispose(),this}setValueAtTime(e,n){return this._param.setValueAtTime(e,n),this}getValueAtTime(e){return this._param.getValueAtTime(e)}setRampPoint(e){return this._param.setRampPoint(e),this}linearRampToValueAtTime(e,n){return this._param.linearRampToValueAtTime(e,n),this}exponentialRampToValueAtTime(e,n){return this._param.exponentialRampToValueAtTime(e,n),this}exponentialRampTo(e,n,i){return this._param.exponentialRampTo(e,n,i),this}linearRampTo(e,n,i){return this._param.linearRampTo(e,n,i),this}targetRampTo(e,n,i){return this._param.targetRampTo(e,n,i),this}exponentialApproachValueAtTime(e,n,i){return this._param.exponentialApproachValueAtTime(e,n,i),this}setTargetAtTime(e,n,i){return this._param.setTargetAtTime(e,n,i),this}setValueCurveAtTime(e,n,i,r){return this._param.setValueCurveAtTime(e,n,i,r),this}cancelScheduledValues(e){return this._param.cancelScheduledValues(e),this}cancelAndHoldAtTime(e){return this._param.cancelAndHoldAtTime(e),this}rampTo(e,n,i){return this._param.rampTo(e,n,i),this}get value(){return this._param.value}set value(e){this._param.value=e}get convert(){return this._param.convert}set convert(e){this._param.convert=e}get units(){return this._param.units}get overridden(){return this._param.overridden}set overridden(e){this._param.overridden=e}get maxValue(){return this._param.maxValue}get minValue(){return this._param.minValue}apply(e){return this._param.apply(e),this}}function P8(t,e,n,i){(e instanceof gr||R1(e)||e instanceof Ir&&e.override)&&(e.cancelScheduledValues(0),e.setValueAtTime(0,0),e instanceof Ir&&(e.overridden=!0)),Rp(t,e,n,i)}class NX extends gr{constructor(){const e=Mn(NX.getDefaults(),arguments,["value"]);super(e),this.name="TickParam",this._events=new yp(1/0),this._multiplier=1,this._multiplier=e.multiplier,this._events.cancel(0),this._events.add({ticks:0,time:0,type:"setValueAtTime",value:this._fromType(e.value)}),this.setValueAtTime(e.value,0)}static getDefaults(){return Object.assign(gr.getDefaults(),{multiplier:1,units:"hertz",value:1})}setTargetAtTime(e,n,i){n=this.toSeconds(n),this.setRampPoint(n);const r=this._fromType(e),s=this._events.get(n),a=Math.round(Math.max(1/i,1));for(let o=0;o<=a;o++){const c=i*o+n,l=this._exponentialApproach(s.time,s.value,r,i,c);this.linearRampToValueAtTime(this._toType(l),c)}return this}setValueAtTime(e,n){const i=this.toSeconds(n);super.setValueAtTime(e,n);const r=this._events.get(i),s=this._events.previousEvent(r),a=this._getTicksUntilEvent(s,i);return r.ticks=Math.max(a,0),this}linearRampToValueAtTime(e,n){const i=this.toSeconds(n);super.linearRampToValueAtTime(e,n);const r=this._events.get(i),s=this._events.previousEvent(r),a=this._getTicksUntilEvent(s,i);return r.ticks=Math.max(a,0),this}exponentialRampToValueAtTime(e,n){n=this.toSeconds(n);const i=this._fromType(e),r=this._events.get(n),s=Math.round(Math.max((n-r.time)*10,1)),a=(n-r.time)/s;for(let o=0;o<=s;o++){const c=a*o+r.time,l=this._exponentialInterpolate(r.time,r.value,n,i,c);this.linearRampToValueAtTime(this._toType(l),c)}return this}_getTicksUntilEvent(e,n){if(e===null)e={ticks:0,time:0,type:"setValueAtTime",value:0};else if(mf(e.ticks)){const a=this._events.previousEvent(e);e.ticks=this._getTicksUntilEvent(a,e.time)}const i=this._fromType(this.getValueAtTime(e.time));let r=this._fromType(this.getValueAtTime(n));const s=this._events.get(n);return s&&s.time===n&&s.type==="setValueAtTime"&&(r=this._fromType(this.getValueAtTime(n-this.sampleTime))),.5*(n-e.time)*(i+r)+e.ticks}getTicksAtTime(e){const n=this.toSeconds(e),i=this._events.get(n);return Math.max(this._getTicksUntilEvent(i,n),0)}getDurationOfTicks(e,n){const i=this.toSeconds(n),r=this.getTicksAtTime(n);return this.getTimeOfTick(r+e)-i}getTimeOfTick(e){const n=this._events.get(e,"ticks"),i=this._events.getAfter(e,"ticks");if(n&&n.ticks===e)return n.time;if(n&&i&&i.type==="linearRampToValueAtTime"&&n.value!==i.value){const r=this._fromType(this.getValueAtTime(n.time)),a=(this._fromType(this.getValueAtTime(i.time))-r)/(i.time-n.time),o=Math.sqrt(Math.pow(r,2)-2*a*(n.ticks-e)),c=(-r+o)/a,l=(-r-o)/a;return(c>0?c:l)+n.time}else return n?n.value===0?1/0:n.time+(e-n.ticks)/n.value:e/this._initialValue}ticksToTime(e,n){return this.getDurationOfTicks(e,n)}timeToTicks(e,n){const i=this.toSeconds(n),r=this.toSeconds(e),s=this.getTicksAtTime(i);return this.getTicksAtTime(i+r)-s}_fromType(e){return this.units==="bpm"&&this.multiplier?1/(60/e/this.multiplier):super._fromType(e)}_toType(e){return this.units==="bpm"&&this.multiplier?e/this.multiplier*60:super._toType(e)}get multiplier(){return this._multiplier}set multiplier(e){const n=this.value;this._multiplier=e,this.cancelScheduledValues(0),this.setValueAtTime(n,0)}}class IX extends Ir{constructor(){const e=Mn(IX.getDefaults(),arguments,["value"]);super(e),this.name="TickSignal",this.input=this._param=new NX({context:this.context,convert:e.convert,multiplier:e.multiplier,param:this._constantSource.offset,units:e.units,value:e.value})}static getDefaults(){return Object.assign(Ir.getDefaults(),{multiplier:1,units:"hertz",value:1})}ticksToTime(e,n){return this._param.ticksToTime(e,n)}timeToTicks(e,n){return this._param.timeToTicks(e,n)}getTimeOfTick(e){return this._param.getTimeOfTick(e)}getDurationOfTicks(e,n){return this._param.getDurationOfTicks(e,n)}getTicksAtTime(e){return this._param.getTicksAtTime(e)}get multiplier(){return this._param.multiplier}set multiplier(e){this._param.multiplier=e}dispose(){return super.dispose(),this._param.dispose(),this}}class kX extends wu{constructor(){const e=Mn(kX.getDefaults(),arguments,["frequency"]);super(e),this.name="TickSource",this._state=new iP,this._tickOffset=new yp,this._ticksAtTime=new yp,this._secondsAtTime=new yp,this.frequency=new IX({context:this.context,units:e.units,value:e.frequency}),br(this,"frequency"),this._state.setStateAtTime("stopped",0),this.setTicksAtTime(0,0)}static getDefaults(){return Object.assign({frequency:1,units:"hertz"},wu.getDefaults())}get state(){return this.getStateAtTime(this.now())}start(e,n){const i=this.toSeconds(e);return this._state.getValueAtTime(i)!=="started"&&(this._state.setStateAtTime("started",i),_r(n)&&this.setTicksAtTime(n,i),this._ticksAtTime.cancel(i),this._secondsAtTime.cancel(i)),this}stop(e){const n=this.toSeconds(e);if(this._state.getValueAtTime(n)==="stopped"){const i=this._state.get(n);i&&i.time>0&&(this._tickOffset.cancel(i.time),this._state.cancel(i.time))}return this._state.cancel(n),this._state.setStateAtTime("stopped",n),this.setTicksAtTime(0,n),this._ticksAtTime.cancel(n),this._secondsAtTime.cancel(n),this}pause(e){const n=this.toSeconds(e);return this._state.getValueAtTime(n)==="started"&&(this._state.setStateAtTime("paused",n),this._ticksAtTime.cancel(n),this._secondsAtTime.cancel(n)),this}cancel(e){return e=this.toSeconds(e),this._state.cancel(e),this._tickOffset.cancel(e),this._ticksAtTime.cancel(e),this._secondsAtTime.cancel(e),this}getTicksAtTime(e){const n=this.toSeconds(e),i=this._state.getLastState("stopped",n),r=this._ticksAtTime.get(n),s={state:"paused",time:n};this._state.add(s);let a=r||i,o=r?r.ticks:0,c=null;return this._state.forEachBetween(a.time,n+this.sampleTime,l=>{let u=a.time;const h=this._tickOffset.get(l.time);h&&h.time>=a.time&&(o=h.ticks,u=h.time),a.state==="started"&&l.state!=="started"&&(o+=this.frequency.getTicksAtTime(l.time)-this.frequency.getTicksAtTime(u),l.time!==s.time&&(c={state:l.state,time:l.time,ticks:o})),a=l}),this._state.remove(s),c&&this._ticksAtTime.add(c),o}get ticks(){return this.getTicksAtTime(this.now())}set ticks(e){this.setTicksAtTime(e,this.now())}get seconds(){return this.getSecondsAtTime(this.now())}set seconds(e){const n=this.now(),i=this.frequency.timeToTicks(e,n);this.setTicksAtTime(i,n)}getSecondsAtTime(e){e=this.toSeconds(e);const n=this._state.getLastState("stopped",e),i={state:"paused",time:e};this._state.add(i);const r=this._secondsAtTime.get(e);let s=r||n,a=r?r.seconds:0,o=null;return this._state.forEachBetween(s.time,e+this.sampleTime,c=>{let l=s.time;const u=this._tickOffset.get(c.time);u&&u.time>=s.time&&(a=u.seconds,l=u.time),s.state==="started"&&c.state!=="started"&&(a+=c.time-l,c.time!==i.time&&(o={state:c.state,time:c.time,seconds:a})),s=c}),this._state.remove(i),o&&this._secondsAtTime.add(o),a}setTicksAtTime(e,n){return n=this.toSeconds(n),this._tickOffset.cancel(n),this._tickOffset.add({seconds:this.frequency.getDurationOfTicks(e,n),ticks:e,time:n}),this._ticksAtTime.cancel(n),this._secondsAtTime.cancel(n),this}getStateAtTime(e){return e=this.toSeconds(e),this._state.getValueAtTime(e)}getTimeOfTick(e,n=this.now()){const i=this._tickOffset.get(n),r=this._state.get(n),s=Math.max(i.time,r.time),a=this.frequency.getTicksAtTime(s)+e-i.ticks;return this.frequency.getTimeOfTick(a)}forEachTickBetween(e,n,i){let r=this._state.get(e);this._state.forEachBetween(e,n,a=>{r&&r.state==="started"&&a.state!=="started"&&this.forEachTickBetween(Math.max(r.time,e),a.time-this.sampleTime,i),r=a});let s=null;if(r&&r.state==="started"){const a=Math.max(r.time,e),o=this.frequency.getTicksAtTime(a),c=this.frequency.getTicksAtTime(r.time),l=o-c;let u=Math.ceil(l)-l;u=mm(u,1)?0:u;let h=this.frequency.getTimeOfTick(o+u);for(;h<n;){try{i(h,Math.round(this.getTicksAtTime(h)))}catch(d){s=d;break}h+=this.frequency.getDurationOfTicks(1,h)}}if(s)throw s;return this}dispose(){return super.dispose(),this._state.dispose(),this._tickOffset.dispose(),this._ticksAtTime.dispose(),this._secondsAtTime.dispose(),this.frequency.dispose(),this}}class D8 extends wu{constructor(){const e=Mn(D8.getDefaults(),arguments,["callback","frequency"]);super(e),this.name="Clock",this.callback=Ss,this._lastUpdate=0,this._state=new iP("stopped"),this._boundLoop=this._loop.bind(this),this.callback=e.callback,this._tickSource=new kX({context:this.context,frequency:e.frequency,units:e.units}),this._lastUpdate=0,this.frequency=this._tickSource.frequency,br(this,"frequency"),this._state.setStateAtTime("stopped",0),this.context.on("tick",this._boundLoop)}static getDefaults(){return Object.assign(wu.getDefaults(),{callback:Ss,frequency:1,units:"hertz"})}get state(){return this._state.getValueAtTime(this.now())}start(e,n){FEe(this.context);const i=this.toSeconds(e);return this.log("start",i),this._state.getValueAtTime(i)!=="started"&&(this._state.setStateAtTime("started",i),this._tickSource.start(i,n),i<this._lastUpdate&&this.emit("start",i,n)),this}stop(e){const n=this.toSeconds(e);return this.log("stop",n),this._state.cancel(n),this._state.setStateAtTime("stopped",n),this._tickSource.stop(n),n<this._lastUpdate&&this.emit("stop",n),this}pause(e){const n=this.toSeconds(e);return this._state.getValueAtTime(n)==="started"&&(this._state.setStateAtTime("paused",n),this._tickSource.pause(n),n<this._lastUpdate&&this.emit("pause",n)),this}get ticks(){return Math.ceil(this.getTicksAtTime(this.now()))}set ticks(e){this._tickSource.ticks=e}get seconds(){return this._tickSource.seconds}set seconds(e){this._tickSource.seconds=e}getSecondsAtTime(e){return this._tickSource.getSecondsAtTime(e)}setTicksAtTime(e,n){return this._tickSource.setTicksAtTime(e,n),this}getTimeOfTick(e,n=this.now()){return this._tickSource.getTimeOfTick(e,n)}getTicksAtTime(e){return this._tickSource.getTicksAtTime(e)}nextTickTime(e,n){const i=this.toSeconds(n),r=this.getTicksAtTime(i);return this._tickSource.getTimeOfTick(r+e,i)}_loop(){const e=this._lastUpdate,n=this.now();this._lastUpdate=n,this.log("loop",e,n),e!==n&&(this._state.forEachBetween(e,n,i=>{switch(i.state){case"started":const r=this._tickSource.getTicksAtTime(i.time);this.emit("start",i.time,r);break;case"stopped":i.time!==0&&this.emit("stop",i.time);break;case"paused":this.emit("pause",i.time);break}}),this._tickSource.forEachTickBetween(e,n,(i,r)=>{this.callback(i,r)}))}getStateAtTime(e){const n=this.toSeconds(e);return this._state.getValueAtTime(n)}dispose(){return super.dispose(),this.context.off("tick",this._boundLoop),this._tickSource.dispose(),this._state.dispose(),this}}tP.mixin(D8);class BA extends Ln{constructor(){const e=Mn(BA.getDefaults(),arguments,["delayTime","maxDelay"]);super(e),this.name="Delay";const n=this.toSeconds(e.maxDelay);this._maxDelay=Math.max(n,this.toSeconds(e.delayTime)),this._delayNode=this.input=this.output=this.context.createDelay(n),this.delayTime=new gr({context:this.context,param:this._delayNode.delayTime,units:"time",value:e.delayTime,minValue:0,maxValue:this.maxDelay}),br(this,"delayTime")}static getDefaults(){return Object.assign(Ln.getDefaults(),{delayTime:0,maxDelay:1})}get maxDelay(){return this._maxDelay}dispose(){return super.dispose(),this._delayNode.disconnect(),this.delayTime.dispose(),this}}class $g extends Ln{constructor(){const e=Mn($g.getDefaults(),arguments,["volume"]);super(e),this.name="Volume",this.input=this.output=new Xi({context:this.context,gain:e.volume,units:"decibels"}),this.volume=this.output.gain,br(this,"volume"),this._unmutedVolume=e.volume,this.mute=e.mute}static getDefaults(){return Object.assign(Ln.getDefaults(),{mute:!1,volume:0})}get mute(){return this.volume.value===-1/0}set mute(e){!this.mute&&e?(this._unmutedVolume=this.volume.value,this.volume.value=-1/0):this.mute&&!e&&(this.volume.value=this._unmutedVolume)}dispose(){return super.dispose(),this.input.dispose(),this.volume.dispose(),this}}class PX extends Ln{constructor(){const e=Mn(PX.getDefaults(),arguments);super(e),this.name="Destination",this.input=new $g({context:this.context}),this.output=new Xi({context:this.context}),this.volume=this.input.volume,M1(this.input,this.output,this.context.rawContext.destination),this.mute=e.mute,this._internalChannels=[this.input,this.context.rawContext.destination,this.output]}static getDefaults(){return Object.assign(Ln.getDefaults(),{mute:!1,volume:0})}get mute(){return this.input.mute}set mute(e){this.input.mute=e}chain(...e){return this.input.disconnect(),e.unshift(this.input),e.push(this.output),M1(...e),this}get maxChannelCount(){return this.context.rawContext.destination.maxChannelCount}dispose(){return super.dispose(),this.volume.dispose(),this}}O8(t=>{t.destination=new PX({context:t})});N8(t=>{t.destination.dispose()});class QEt extends Ln{constructor(){super(...arguments),this.name="Listener",this.positionX=new gr({context:this.context,param:this.context.rawContext.listener.positionX}),this.positionY=new gr({context:this.context,param:this.context.rawContext.listener.positionY}),this.positionZ=new gr({context:this.context,param:this.context.rawContext.listener.positionZ}),this.forwardX=new gr({context:this.context,param:this.context.rawContext.listener.forwardX}),this.forwardY=new gr({context:this.context,param:this.context.rawContext.listener.forwardY}),this.forwardZ=new gr({context:this.context,param:this.context.rawContext.listener.forwardZ}),this.upX=new gr({context:this.context,param:this.context.rawContext.listener.upX}),this.upY=new gr({context:this.context,param:this.context.rawContext.listener.upY}),this.upZ=new gr({context:this.context,param:this.context.rawContext.listener.upZ})}static getDefaults(){return Object.assign(Ln.getDefaults(),{positionX:0,positionY:0,positionZ:0,forwardX:0,forwardY:0,forwardZ:-1,upX:0,upY:1,upZ:0})}dispose(){return super.dispose(),this.positionX.dispose(),this.positionY.dispose(),this.positionZ.dispose(),this.forwardX.dispose(),this.forwardY.dispose(),this.forwardZ.dispose(),this.upX.dispose(),this.upY.dispose(),this.upZ.dispose(),this}}O8(t=>{t.listener=new QEt({context:t})});N8(t=>{t.listener.dispose()});class DX extends Z_{constructor(){super(),this.name="ToneAudioBuffers",this._buffers=new Map,this._loadingCount=0;const e=Mn(DX.getDefaults(),arguments,["urls","onload","baseUrl"],"urls");this.baseUrl=e.baseUrl,Object.keys(e.urls).forEach(n=>{this._loadingCount++;const i=e.urls[n];this.add(n,i,this._bufferLoaded.bind(this,e.onload),e.onerror)})}static getDefaults(){return{baseUrl:"",onerror:Ss,onload:Ss,urls:{}}}has(e){return this._buffers.has(e.toString())}get(e){return Ri(this.has(e),`ToneAudioBuffers has no buffer named: ${e}`),this._buffers.get(e.toString())}_bufferLoaded(e){this._loadingCount--,this._loadingCount===0&&e&&e()}get loaded(){return Array.from(this._buffers).every(([e,n])=>n.loaded)}add(e,n,i=Ss,r=Ss){return B_(n)?(this.baseUrl&&n.trim().substring(0,11).toLowerCase()==="data:audio/"&&(this.baseUrl=""),this._buffers.set(e.toString(),new Hs(this.baseUrl+n,i,r))):this._buffers.set(e.toString(),new Hs(n,i,r)),this}dispose(){return super.dispose(),this._buffers.forEach(e=>e.dispose()),this._buffers.clear(),this}}class wB extends cd{constructor(){super(...arguments),this.name="MidiClass",this.defaultUnits="midi"}_frequencyToUnits(e){return CT(super._frequencyToUnits(e))}_ticksToUnits(e){return CT(super._ticksToUnits(e))}_beatsToUnits(e){return CT(super._beatsToUnits(e))}_secondsToUnits(e){return CT(super._secondsToUnits(e))}toMidi(){return this.valueOf()}toFrequency(){return JEe(this.toMidi())}transpose(e){return new wB(this.context,this.toMidi()+e)}}class jc extends MC{constructor(){super(...arguments),this.name="Ticks",this.defaultUnits="i"}_now(){return this.context.transport.ticks}_beatsToUnits(e){return this._getPPQ()*e}_secondsToUnits(e){return Math.floor(e/(60/this._getBpm())*this._getPPQ())}_ticksToUnits(e){return e}toTicks(){return this.valueOf()}toSeconds(){return this.valueOf()/this._getPPQ()*(60/this._getBpm())}}class eSt extends wu{constructor(){super(...arguments),this.name="Draw",this.expiration=.25,this.anticipation=.008,this._events=new yp,this._boundDrawLoop=this._drawLoop.bind(this),this._animationFrame=-1}schedule(e,n){return this._events.add({callback:e,time:this.toSeconds(n)}),this._events.length===1&&(this._animationFrame=requestAnimationFrame(this._boundDrawLoop)),this}cancel(e){return this._events.cancel(this.toSeconds(e)),this}_drawLoop(){const e=this.context.currentTime;this._events.forEachBefore(e+this.anticipation,n=>{e-n.time<=this.expiration&&n.callback(),this._events.remove(n)}),this._events.length>0&&(this._animationFrame=requestAnimationFrame(this._boundDrawLoop))}dispose(){return super.dispose(),this._events.dispose(),cancelAnimationFrame(this._animationFrame),this}}O8(t=>{t.draw=new eSt({context:t})});N8(t=>{t.draw.dispose()});class tSt extends Z_{constructor(){super(...arguments),this.name="IntervalTimeline",this._root=null,this._length=0}add(e){Ri(_r(e.time),"Events must have a time property"),Ri(_r(e.duration),"Events must have a duration parameter"),e.time=e.time.valueOf();let n=new nSt(e.time,e.time+e.duration,e);for(this._root===null?this._root=n:this._root.insert(n),this._length++;n!==null;)n.updateHeight(),n.updateMax(),this._rebalance(n),n=n.parent;return this}remove(e){if(this._root!==null){const n=[];this._root.search(e.time,n);for(const i of n)if(i.event===e){this._removeNode(i),this._length--;break}}return this}get length(){return this._length}cancel(e){return this.forEachFrom(e,n=>this.remove(n)),this}_setRoot(e){this._root=e,this._root!==null&&(this._root.parent=null)}_replaceNodeInParent(e,n){e.parent!==null?(e.isLeftChild()?e.parent.left=n:e.parent.right=n,this._rebalance(e.parent)):this._setRoot(n)}_removeNode(e){if(e.left===null&&e.right===null)this._replaceNodeInParent(e,null);else if(e.right===null)this._replaceNodeInParent(e,e.left);else if(e.left===null)this._replaceNodeInParent(e,e.right);else{const n=e.getBalance();let i,r=null;if(n>0)if(e.left.right===null)i=e.left,i.right=e.right,r=i;else{for(i=e.left.right;i.right!==null;)i=i.right;i.parent&&(i.parent.right=i.left,r=i.parent,i.left=e.left,i.right=e.right)}else if(e.right.left===null)i=e.right,i.left=e.left,r=i;else{for(i=e.right.left;i.left!==null;)i=i.left;i.parent&&(i.parent.left=i.right,r=i.parent,i.left=e.left,i.right=e.right)}e.parent!==null?e.isLeftChild()?e.parent.left=i:e.parent.right=i:this._setRoot(i),r&&this._rebalance(r)}e.dispose()}_rotateLeft(e){const n=e.parent,i=e.isLeftChild(),r=e.right;r&&(e.right=r.left,r.left=e),n!==null?i?n.left=r:n.right=r:this._setRoot(r)}_rotateRight(e){const n=e.parent,i=e.isLeftChild(),r=e.left;r&&(e.left=r.right,r.right=e),n!==null?i?n.left=r:n.right=r:this._setRoot(r)}_rebalance(e){const n=e.getBalance();n>1&&e.left?e.left.getBalance()<0?this._rotateLeft(e.left):this._rotateRight(e):n<-1&&e.right&&(e.right.getBalance()>0?this._rotateRight(e.right):this._rotateLeft(e))}get(e){if(this._root!==null){const n=[];if(this._root.search(e,n),n.length>0){let i=n[0];for(let r=1;r<n.length;r++)n[r].low>i.low&&(i=n[r]);return i.event}}return null}forEach(e){if(this._root!==null){const n=[];this._root.traverse(i=>n.push(i)),n.forEach(i=>{i.event&&e(i.event)})}return this}forEachAtTime(e,n){if(this._root!==null){const i=[];this._root.search(e,i),i.forEach(r=>{r.event&&n(r.event)})}return this}forEachFrom(e,n){if(this._root!==null){const i=[];this._root.searchAfter(e,i),i.forEach(r=>{r.event&&n(r.event)})}return this}dispose(){return super.dispose(),this._root!==null&&this._root.traverse(e=>e.dispose()),this._root=null,this}}class nSt{constructor(e,n,i){this._left=null,this._right=null,this.parent=null,this.height=0,this.event=i,this.low=e,this.high=n,this.max=this.high}insert(e){e.low<=this.low?this.left===null?this.left=e:this.left.insert(e):this.right===null?this.right=e:this.right.insert(e)}search(e,n){e>this.max||(this.left!==null&&this.left.search(e,n),this.low<=e&&this.high>e&&n.push(this),!(this.low>e)&&this.right!==null&&this.right.search(e,n))}searchAfter(e,n){this.low>=e&&(n.push(this),this.left!==null&&this.left.searchAfter(e,n)),this.right!==null&&this.right.searchAfter(e,n)}traverse(e){e(this),this.left!==null&&this.left.traverse(e),this.right!==null&&this.right.traverse(e)}updateHeight(){this.left!==null&&this.right!==null?this.height=Math.max(this.left.height,this.right.height)+1:this.right!==null?this.height=this.right.height+1:this.left!==null?this.height=this.left.height+1:this.height=0}updateMax(){this.max=this.high,this.left!==null&&(this.max=Math.max(this.max,this.left.max)),this.right!==null&&(this.max=Math.max(this.max,this.right.max))}getBalance(){let e=0;return this.left!==null&&this.right!==null?e=this.left.height-this.right.height:this.left!==null?e=this.left.height+1:this.right!==null&&(e=-(this.right.height+1)),e}isLeftChild(){return this.parent!==null&&this.parent.left===this}get left(){return this._left}set left(e){this._left=e,e!==null&&(e.parent=this),this.updateHeight(),this.updateMax()}get right(){return this._right}set right(e){this._right=e,e!==null&&(e.parent=this),this.updateHeight(),this.updateMax()}dispose(){this.parent=null,this._left=null,this._right=null,this.event=null}}class iSt extends Z_{constructor(e){super(),this.name="TimelineValue",this._timeline=new yp({memory:10}),this._initialValue=e}set(e,n){return this._timeline.add({value:e,time:n}),this}get(e){const n=this._timeline.get(e);return n?n.value:this._initialValue}}class Nm extends Ln{constructor(){super(Mn(Nm.getDefaults(),arguments,["context"]))}connect(e,n=0,i=0){return P8(this,e,n,i),this}}class GE extends Nm{constructor(){const e=Mn(GE.getDefaults(),arguments,["mapping","length"]);super(e),this.name="WaveShaper",this._shaper=this.context.createWaveShaper(),this.input=this._shaper,this.output=this._shaper,hd(e.mapping)||e.mapping instanceof Float32Array?this.curve=Float32Array.from(e.mapping):IEt(e.mapping)&&this.setMap(e.mapping,e.length)}static getDefaults(){return Object.assign(Ir.getDefaults(),{length:1024})}setMap(e,n=1024){const i=new Float32Array(n);for(let r=0,s=n;r<s;r++){const a=r/(s-1)*2-1;i[r]=e(a,r)}return this.curve=i,this}get curve(){return this._shaper.curve}set curve(e){this._shaper.curve=e}get oversample(){return this._shaper.oversample}set oversample(e){const n=["none","2x","4x"].some(i=>i.includes(e));Ri(n,"oversampling must be either 'none', '2x', or '4x'"),this._shaper.oversample=e}dispose(){return super.dispose(),this._shaper.disconnect(),this}}class L8 extends Nm{constructor(){const e=Mn(L8.getDefaults(),arguments,["value"]);super(e),this.name="Pow",this._exponentScaler=this.input=this.output=new GE({context:this.context,mapping:this._expFunc(e.value),length:8192}),this._exponent=e.value}static getDefaults(){return Object.assign(Nm.getDefaults(),{value:1})}_expFunc(e){return n=>Math.pow(Math.abs(n),e)}get value(){return this._exponent}set value(e){this._exponent=e,this._exponentScaler.setMap(this._expFunc(this._exponent))}dispose(){return super.dispose(),this._exponentScaler.dispose(),this}}class vE{constructor(e,n){this.id=vE._eventId++,this._remainderTime=0;const i=Object.assign(vE.getDefaults(),n);this.transport=e,this.callback=i.callback,this._once=i.once,this.time=Math.floor(i.time),this._remainderTime=i.time-this.time}static getDefaults(){return{callback:Ss,once:!1,time:0}}get floatTime(){return this.time+this._remainderTime}invoke(e){if(this.callback){const n=this.transport.bpm.getDurationOfTicks(1,e);this.callback(e+this._remainderTime*n),this._once&&this.transport.clear(this.id)}}dispose(){return this.callback=void 0,this}}vE._eventId=0;class LX extends vE{constructor(e,n){super(e,n),this._currentId=-1,this._nextId=-1,this._nextTick=this.time,this._boundRestart=this._restart.bind(this);const i=Object.assign(LX.getDefaults(),n);this.duration=i.duration,this._interval=i.interval,this._nextTick=i.time,this.transport.on("start",this._boundRestart),this.transport.on("loopStart",this._boundRestart),this.transport.on("ticks",this._boundRestart),this.context=this.transport.context,this._restart()}static getDefaults(){return Object.assign({},vE.getDefaults(),{duration:1/0,interval:1,once:!1})}invoke(e){this._createEvents(e),super.invoke(e)}_createEvent(){return xB(this._nextTick,this.floatTime+this.duration)?this.transport.scheduleOnce(this.invoke.bind(this),new jc(this.context,this._nextTick).toSeconds()):-1}_createEvents(e){xB(this._nextTick+this._interval,this.floatTime+this.duration)&&(this._nextTick+=this._interval,this._currentId=this._nextId,this._nextId=this.transport.scheduleOnce(this.invoke.bind(this),new jc(this.context,this._nextTick).toSeconds()))}_restart(e){this.transport.clear(this._currentId),this.transport.clear(this._nextId),this._nextTick=this.floatTime;const n=this.transport.getTicksAtTime(e);LA(n,this.time)&&(this._nextTick=this.floatTime+Math.ceil((n-this.floatTime)/this._interval)*this._interval),this._currentId=this._createEvent(),this._nextTick+=this._interval,this._nextId=this._createEvent()}dispose(){return super.dispose(),this.transport.clear(this._currentId),this.transport.clear(this._nextId),this.transport.off("start",this._boundRestart),this.transport.off("loopStart",this._boundRestart),this.transport.off("ticks",this._boundRestart),this}}class U8 extends wu{constructor(){const e=Mn(U8.getDefaults(),arguments);super(e),this.name="Transport",this._loop=new iSt(!1),this._loopStart=0,this._loopEnd=0,this._scheduledEvents={},this._timeline=new yp,this._repeatedEvents=new tSt,this._syncedSignals=[],this._swingAmount=0,this._ppq=e.ppq,this._clock=new D8({callback:this._processTick.bind(this),context:this.context,frequency:0,units:"bpm"}),this._bindClockEvents(),this.bpm=this._clock.frequency,this._clock.frequency.multiplier=e.ppq,this.bpm.setValueAtTime(e.bpm,0),br(this,"bpm"),this._timeSignature=e.timeSignature,this._swingTicks=e.ppq/2}static getDefaults(){return Object.assign(wu.getDefaults(),{bpm:120,loopEnd:"4m",loopStart:0,ppq:192,swing:0,swingSubdivision:"8n",timeSignature:4})}_processTick(e,n){if(this._loop.get(e)&&n>=this._loopEnd&&(this.emit("loopEnd",e),this._clock.setTicksAtTime(this._loopStart,e),n=this._loopStart,this.emit("loopStart",e,this._clock.getSecondsAtTime(e)),this.emit("loop",e)),this._swingAmount>0&&n%this._ppq!==0&&n%(this._swingTicks*2)!==0){const i=n%(this._swingTicks*2)/(this._swingTicks*2),r=Math.sin(i*Math.PI)*this._swingAmount;e+=new jc(this.context,this._swingTicks*2/3).toSeconds()*r}aae(!0),this._timeline.forEachAtTime(n,i=>i.invoke(e)),aae(!1)}schedule(e,n){const i=new vE(this,{callback:e,time:new MC(this.context,n).toTicks()});return this._addEvent(i,this._timeline)}scheduleRepeat(e,n,i,r=1/0){const s=new LX(this,{callback:e,duration:new mp(this.context,r).toTicks(),interval:new mp(this.context,n).toTicks(),time:new MC(this.context,i).toTicks()});return this._addEvent(s,this._repeatedEvents)}scheduleOnce(e,n){const i=new vE(this,{callback:e,once:!0,time:new MC(this.context,n).toTicks()});return this._addEvent(i,this._timeline)}clear(e){if(this._scheduledEvents.hasOwnProperty(e)){const n=this._scheduledEvents[e.toString()];n.timeline.remove(n.event),n.event.dispose(),delete this._scheduledEvents[e.toString()]}return this}_addEvent(e,n){return this._scheduledEvents[e.id.toString()]={event:e,timeline:n},n.add(e),e.id}cancel(e=0){const n=this.toTicks(e);return this._timeline.forEachFrom(n,i=>this.clear(i.id)),this._repeatedEvents.forEachFrom(n,i=>this.clear(i.id)),this}_bindClockEvents(){this._clock.on("start",(e,n)=>{n=new jc(this.context,n).toSeconds(),this.emit("start",e,n)}),this._clock.on("stop",e=>{this.emit("stop",e)}),this._clock.on("pause",e=>{this.emit("pause",e)})}get state(){return this._clock.getStateAtTime(this.now())}start(e,n){this.context.resume();let i;return _r(n)&&(i=this.toTicks(n)),this._clock.start(e,i),this}stop(e){return this._clock.stop(e),this}pause(e){return this._clock.pause(e),this}toggle(e){return e=this.toSeconds(e),this._clock.getStateAtTime(e)!=="started"?this.start(e):this.stop(e),this}get timeSignature(){return this._timeSignature}set timeSignature(e){hd(e)&&(e=e[0]/e[1]*4),this._timeSignature=e}get loopStart(){return new mp(this.context,this._loopStart,"i").toSeconds()}set loopStart(e){this._loopStart=this.toTicks(e)}get loopEnd(){return new mp(this.context,this._loopEnd,"i").toSeconds()}set loopEnd(e){this._loopEnd=this.toTicks(e)}get loop(){return this._loop.get(this.now())}set loop(e){this._loop.set(e,this.now())}setLoopPoints(e,n){return this.loopStart=e,this.loopEnd=n,this}get swing(){return this._swingAmount}set swing(e){this._swingAmount=e}get swingSubdivision(){return new jc(this.context,this._swingTicks).toNotation()}set swingSubdivision(e){this._swingTicks=this.toTicks(e)}get position(){const e=this.now(),n=this._clock.getTicksAtTime(e);return new jc(this.context,n).toBarsBeatsSixteenths()}set position(e){const n=this.toTicks(e);this.ticks=n}get seconds(){return this._clock.seconds}set seconds(e){const n=this.now(),i=this._clock.frequency.timeToTicks(e,n);this.ticks=i}get progress(){if(this.loop){const e=this.now();return(this._clock.getTicksAtTime(e)-this._loopStart)/(this._loopEnd-this._loopStart)}else return 0}get ticks(){return this._clock.ticks}set ticks(e){if(this._clock.ticks!==e){const n=this.now();if(this.state==="started"){const i=this._clock.getTicksAtTime(n),r=this._clock.frequency.getDurationOfTicks(Math.ceil(i)-i,n),s=n+r;this.emit("stop",s),this._clock.setTicksAtTime(e,s),this.emit("start",s,this._clock.getSecondsAtTime(s))}else this.emit("ticks",n),this._clock.setTicksAtTime(e,n)}}getTicksAtTime(e){return this._clock.getTicksAtTime(e)}getSecondsAtTime(e){return this._clock.getSecondsAtTime(e)}get PPQ(){return this._clock.frequency.multiplier}set PPQ(e){this._clock.frequency.multiplier=e}nextSubdivision(e){if(e=this.toTicks(e),this.state!=="started")return 0;{const n=this.now(),i=this.getTicksAtTime(n),r=e-i%e;return this._clock.nextTickTime(r,n)}}syncSignal(e,n){const i=this.now();let r=this.bpm,s=1/(60/r.getValueAtTime(i)/this.PPQ),a=[];if(e.units==="time"){const c=.015625/s,l=new Xi(c),u=new L8(-1),h=new Xi(c);r.chain(l,u,h),r=h,s=1/s,a=[l,u,h]}n||(e.getValueAtTime(i)!==0?n=e.getValueAtTime(i)/s:n=0);const o=new Xi(n);return r.connect(o),o.connect(e._param),a.push(o),this._syncedSignals.push({initial:e.value,nodes:a,signal:e}),e.value=0,this}unsyncSignal(e){for(let n=this._syncedSignals.length-1;n>=0;n--){const i=this._syncedSignals[n];i.signal===e&&(i.nodes.forEach(r=>r.dispose()),i.signal.value=i.initial,this._syncedSignals.splice(n,1))}return this}dispose(){return super.dispose(),this._clock.dispose(),nP(this,"bpm"),this._timeline.dispose(),this._repeatedEvents.dispose(),this}}tP.mixin(U8);O8(t=>{t.transport=new U8({context:t})});N8(t=>{t.transport.dispose()});class Nl extends Ln{constructor(e){super(e),this.input=void 0,this._state=new iP("stopped"),this._synced=!1,this._scheduled=[],this._syncedStart=Ss,this._syncedStop=Ss,this._state.memory=100,this._state.increasing=!0,this._volume=this.output=new $g({context:this.context,mute:e.mute,volume:e.volume}),this.volume=this._volume.volume,br(this,"volume"),this.onstop=e.onstop}static getDefaults(){return Object.assign(Ln.getDefaults(),{mute:!1,onstop:Ss,volume:0})}get state(){return this._synced?this.context.transport.state==="started"?this._state.getValueAtTime(this.context.transport.seconds):"stopped":this._state.getValueAtTime(this.now())}get mute(){return this._volume.mute}set mute(e){this._volume.mute=e}_clampToCurrentTime(e){return this._synced?e:Math.max(e,this.context.currentTime)}start(e,n,i){let r=mf(e)&&this._synced?this.context.transport.seconds:this.toSeconds(e);if(r=this._clampToCurrentTime(r),!this._synced&&this._state.getValueAtTime(r)==="started")Ri(LA(r,this._state.get(r).time),"Start time must be strictly greater than previous start time"),this._state.cancel(r),this._state.setStateAtTime("started",r),this.log("restart",r),this.restart(r,n,i);else if(this.log("start",r),this._state.setStateAtTime("started",r),this._synced){const s=this._state.get(r);s&&(s.offset=this.toSeconds(n0(n,0)),s.duration=i?this.toSeconds(i):void 0);const a=this.context.transport.schedule(o=>{this._start(o,n,i)},r);this._scheduled.push(a),this.context.transport.state==="started"&&this.context.transport.getSecondsAtTime(this.immediate())>r&&this._syncedStart(this.now(),this.context.transport.seconds)}else FEe(this.context),this._start(r,n,i);return this}stop(e){let n=mf(e)&&this._synced?this.context.transport.seconds:this.toSeconds(e);if(n=this._clampToCurrentTime(n),this._state.getValueAtTime(n)==="started"||_r(this._state.getNextState("started",n))){if(this.log("stop",n),!this._synced)this._stop(n);else{const i=this.context.transport.schedule(this._stop.bind(this),n);this._scheduled.push(i)}this._state.cancel(n),this._state.setStateAtTime("stopped",n)}return this}restart(e,n,i){return e=this.toSeconds(e),this._state.getValueAtTime(e)==="started"&&(this._state.cancel(e),this._restart(e,n,i)),this}sync(){return this._synced||(this._synced=!0,this._syncedStart=(e,n)=>{if(LA(n,0)){const i=this._state.get(n);if(i&&i.state==="started"&&i.time!==n){const r=n-this.toSeconds(i.time);let s;i.duration&&(s=this.toSeconds(i.duration)-r),this._start(e,this.toSeconds(i.offset)+r,s)}}},this._syncedStop=e=>{const n=this.context.transport.getSecondsAtTime(Math.max(e-this.sampleTime,0));this._state.getValueAtTime(n)==="started"&&this._stop(e)},this.context.transport.on("start",this._syncedStart),this.context.transport.on("loopStart",this._syncedStart),this.context.transport.on("stop",this._syncedStop),this.context.transport.on("pause",this._syncedStop),this.context.transport.on("loopEnd",this._syncedStop)),this}unsync(){return this._synced&&(this.context.transport.off("stop",this._syncedStop),this.context.transport.off("pause",this._syncedStop),this.context.transport.off("loopEnd",this._syncedStop),this.context.transport.off("start",this._syncedStart),this.context.transport.off("loopStart",this._syncedStart)),this._synced=!1,this._scheduled.forEach(e=>this.context.transport.clear(e)),this._scheduled=[],this._state.cancel(0),this._stop(0),this}dispose(){return super.dispose(),this.onstop=Ss,this.unsync(),this._volume.dispose(),this._state.dispose(),this}}class rP extends UA{constructor(){const e=Mn(rP.getDefaults(),arguments,["url","onload"]);super(e),this.name="ToneBufferSource",this._source=this.context.createBufferSource(),this._internalChannels=[this._source],this._sourceStarted=!1,this._sourceStopped=!1,Rp(this._source,this._gainNode),this._source.onended=()=>this._stopSource(),this.playbackRate=new gr({context:this.context,param:this._source.playbackRate,units:"positive",value:e.playbackRate}),this.loop=e.loop,this.loopStart=e.loopStart,this.loopEnd=e.loopEnd,this._buffer=new Hs(e.url,e.onload,e.onerror),this._internalChannels.push(this._source)}static getDefaults(){return Object.assign(UA.getDefaults(),{url:new Hs,loop:!1,loopEnd:0,loopStart:0,onload:Ss,onerror:Ss,playbackRate:1})}get fadeIn(){return this._fadeIn}set fadeIn(e){this._fadeIn=e}get fadeOut(){return this._fadeOut}set fadeOut(e){this._fadeOut=e}get curve(){return this._curve}set curve(e){this._curve=e}start(e,n,i,r=1){Ri(this.buffer.loaded,"buffer is either not set or not loaded");const s=this.toSeconds(e);this._startGain(s,r),this.loop?n=n0(n,this.loopStart):n=n0(n,0);let a=Math.max(this.toSeconds(n),0);if(this.loop){const o=this.toSeconds(this.loopEnd)||this.buffer.duration,c=this.toSeconds(this.loopStart),l=o-c;Z$(a,o)&&(a=(a-c)%l+c),mm(a,this.buffer.duration)&&(a=0)}if(this._source.buffer=this.buffer.get(),this._source.loopEnd=this.toSeconds(this.loopEnd)||this.buffer.duration,xB(a,this.buffer.duration)&&(this._sourceStarted=!0,this._source.start(s,a)),_r(i)){let o=this.toSeconds(i);o=Math.max(o,0),this.stop(s+o)}return this}_stopSource(e){!this._sourceStopped&&this._sourceStarted&&(this._sourceStopped=!0,this._source.stop(this.toSeconds(e)),this._onended())}get loopStart(){return this._source.loopStart}set loopStart(e){this._source.loopStart=this.toSeconds(e)}get loopEnd(){return this._source.loopEnd}set loopEnd(e){this._source.loopEnd=this.toSeconds(e)}get buffer(){return this._buffer}set buffer(e){this._buffer.set(e)}get loop(){return this._source.loop}set loop(e){this._source.loop=e,this._sourceStarted&&this.cancelStop()}dispose(){return super.dispose(),this._source.onended=null,this._source.disconnect(),this._buffer.dispose(),this.playbackRate.dispose(),this}}class O1 extends Nl{constructor(){const e=Mn(O1.getDefaults(),arguments,["type"]);super(e),this.name="Noise",this._source=null,this._playbackRate=e.playbackRate,this.type=e.type,this._fadeIn=e.fadeIn,this._fadeOut=e.fadeOut}static getDefaults(){return Object.assign(Nl.getDefaults(),{fadeIn:0,fadeOut:0,playbackRate:1,type:"white"})}get type(){return this._type}set type(e){if(Ri(e in cae,"Noise: invalid type: "+e),this._type!==e&&(this._type=e,this.state==="started")){const n=this.now();this._stop(n),this._start(n)}}get playbackRate(){return this._playbackRate}set playbackRate(e){this._playbackRate=e,this._source&&(this._source.playbackRate.value=e)}_start(e){const n=cae[this._type];this._source=new rP({url:n,context:this.context,fadeIn:this._fadeIn,fadeOut:this._fadeOut,loop:!0,onended:()=>this.onstop(this),playbackRate:this._playbackRate}).connect(this.output),this._source.start(this.toSeconds(e),Math.random()*(n.duration-.001))}_stop(e){this._source&&(this._source.stop(this.toSeconds(e)),this._source=null)}get fadeIn(){return this._fadeIn}set fadeIn(e){this._fadeIn=e,this._source&&(this._source.fadeIn=this._fadeIn)}get fadeOut(){return this._fadeOut}set fadeOut(e){this._fadeOut=e,this._source&&(this._source.fadeOut=this._fadeOut)}_restart(e){this._stop(e),this._start(e)}dispose(){return super.dispose(),this._source&&this._source.disconnect(),this}}const Ew=44100*5,rV=2,Bv={brown:null,pink:null,white:null},cae={get brown(){if(!Bv.brown){const t=[];for(let e=0;e<rV;e++){const n=new Float32Array(Ew);t[e]=n;let i=0;for(let r=0;r<Ew;r++){const s=Math.random()*2-1;n[r]=(i+.02*s)/1.02,i=n[r],n[r]*=3.5}}Bv.brown=new Hs().fromArray(t)}return Bv.brown},get pink(){if(!Bv.pink){const t=[];for(let e=0;e<rV;e++){const n=new Float32Array(Ew);t[e]=n;let i,r,s,a,o,c,l;i=r=s=a=o=c=l=0;for(let u=0;u<Ew;u++){const h=Math.random()*2-1;i=.99886*i+h*.0555179,r=.99332*r+h*.0750759,s=.969*s+h*.153852,a=.8665*a+h*.3104856,o=.55*o+h*.5329522,c=-.7616*c-h*.016898,n[u]=i+r+s+a+o+c+l+h*.5362,n[u]*=.11,l=h*.115926}}Bv.pink=new Hs().fromArray(t)}return Bv.pink},get white(){if(!Bv.white){const t=[];for(let e=0;e<rV;e++){const n=new Float32Array(Ew);t[e]=n;for(let i=0;i<Ew;i++)n[i]=Math.random()*2-1}Bv.white=new Hs().fromArray(t)}return Bv.white}};function rx(t,e){return oo(this,void 0,void 0,function*(){const n=e/t.context.sampleRate,i=new I8(1,n,t.context.sampleRate);return new t.constructor(Object.assign(t.get(),{frequency:2/n,detune:0,context:i})).toDestination().start(0),(yield i.render()).getChannelData(0)})}class UX extends UA{constructor(){const e=Mn(UX.getDefaults(),arguments,["frequency","type"]);super(e),this.name="ToneOscillatorNode",this._oscillator=this.context.createOscillator(),this._internalChannels=[this._oscillator],Rp(this._oscillator,this._gainNode),this.type=e.type,this.frequency=new gr({context:this.context,param:this._oscillator.frequency,units:"frequency",value:e.frequency}),this.detune=new gr({context:this.context,param:this._oscillator.detune,units:"cents",value:e.detune}),br(this,["frequency","detune"])}static getDefaults(){return Object.assign(UA.getDefaults(),{detune:0,frequency:440,type:"sine"})}start(e){const n=this.toSeconds(e);return this.log("start",n),this._startGain(n),this._oscillator.start(n),this}_stopSource(e){this._oscillator.stop(e)}setPeriodicWave(e){return this._oscillator.setPeriodicWave(e),this}get type(){return this._oscillator.type}set type(e){this._oscillator.type=e}dispose(){return super.dispose(),this.state==="started"&&this.stop(),this._oscillator.disconnect(),this.frequency.dispose(),this.detune.dispose(),this}}class so extends Nl{constructor(){const e=Mn(so.getDefaults(),arguments,["frequency","type"]);super(e),this.name="Oscillator",this._oscillator=null,this.frequency=new Ir({context:this.context,units:"frequency",value:e.frequency}),br(this,"frequency"),this.detune=new Ir({context:this.context,units:"cents",value:e.detune}),br(this,"detune"),this._partials=e.partials,this._partialCount=e.partialCount,this._type=e.type,e.partialCount&&e.type!=="custom"&&(this._type=this.baseType+e.partialCount.toString()),this.phase=e.phase}static getDefaults(){return Object.assign(Nl.getDefaults(),{detune:0,frequency:440,partialCount:0,partials:[],phase:0,type:"sine"})}_start(e){const n=this.toSeconds(e),i=new UX({context:this.context,onended:()=>this.onstop(this)});this._oscillator=i,this._wave?this._oscillator.setPeriodicWave(this._wave):this._oscillator.type=this._type,this._oscillator.connect(this.output),this.frequency.connect(this._oscillator.frequency),this.detune.connect(this._oscillator.detune),this._oscillator.start(n)}_stop(e){const n=this.toSeconds(e);this._oscillator&&this._oscillator.stop(n)}_restart(e){const n=this.toSeconds(e);return this.log("restart",n),this._oscillator&&this._oscillator.cancelStop(),this._state.cancel(n),this}syncFrequency(){return this.context.transport.syncSignal(this.frequency),this}unsyncFrequency(){return this.context.transport.unsyncSignal(this.frequency),this}_getCachedPeriodicWave(){if(this._type==="custom")return so._periodicWaveCache.find(n=>n.phase===this._phase&&HEt(n.partials,this._partials));{const e=so._periodicWaveCache.find(n=>n.type===this._type&&n.phase===this._phase);return this._partialCount=e?e.partialCount:this._partialCount,e}}get type(){return this._type}set type(e){this._type=e;const n=["sine","square","sawtooth","triangle"].indexOf(e)!==-1;if(this._phase===0&&n)this._wave=void 0,this._partialCount=0,this._oscillator!==null&&(this._oscillator.type=e);else{const i=this._getCachedPeriodicWave();if(_r(i)){const{partials:r,wave:s}=i;this._wave=s,this._partials=r,this._oscillator!==null&&this._oscillator.setPeriodicWave(this._wave)}else{const[r,s]=this._getRealImaginary(e,this._phase),a=this.context.createPeriodicWave(r,s);this._wave=a,this._oscillator!==null&&this._oscillator.setPeriodicWave(this._wave),so._periodicWaveCache.push({imag:s,partialCount:this._partialCount,partials:this._partials,phase:this._phase,real:r,type:this._type,wave:this._wave}),so._periodicWaveCache.length>100&&so._periodicWaveCache.shift()}}}get baseType(){return this._type.replace(this.partialCount.toString(),"")}set baseType(e){this.partialCount&&this._type!=="custom"&&e!=="custom"?this.type=e+this.partialCount:this.type=e}get partialCount(){return this._partialCount}set partialCount(e){pp(e,0);let n=this._type;const i=/^(sine|triangle|square|sawtooth)(\d+)$/.exec(this._type);if(i&&(n=i[1]),this._type!=="custom")e===0?this.type=n:this.type=n+e.toString();else{const r=new Float32Array(e);this._partials.forEach((s,a)=>r[a]=s),this._partials=Array.from(r),this.type=this._type}}_getRealImaginary(e,n){let r=2048;const s=new Float32Array(r),a=new Float32Array(r);let o=1;if(e==="custom"){if(o=this._partials.length+1,this._partialCount=this._partials.length,r=o,this._partials.length===0)return[s,a]}else{const c=/^(sine|triangle|square|sawtooth)(\d+)$/.exec(e);c?(o=parseInt(c[2],10)+1,this._partialCount=parseInt(c[2],10),e=c[1],o=Math.max(o,2),r=o):this._partialCount=0,this._partials=[]}for(let c=1;c<r;++c){const l=2/(c*Math.PI);let u;switch(e){case"sine":u=c<=o?1:0,this._partials[c-1]=u;break;case"square":u=c&1?2*l:0,this._partials[c-1]=u;break;case"sawtooth":u=l*(c&1?1:-1),this._partials[c-1]=u;break;case"triangle":c&1?u=2*(l*l)*(c-1>>1&1?-1:1):u=0,this._partials[c-1]=u;break;case"custom":u=this._partials[c-1];break;default:throw new TypeError("Oscillator: invalid type: "+e)}u!==0?(s[c]=-u*Math.sin(n*c),a[c]=u*Math.cos(n*c)):(s[c]=0,a[c]=0)}return[s,a]}_inverseFFT(e,n,i){let r=0;const s=e.length;for(let a=0;a<s;a++)r+=e[a]*Math.cos(a*i)+n[a]*Math.sin(a*i);return r}getInitialValue(){const[e,n]=this._getRealImaginary(this._type,0);let i=0;const r=Math.PI*2,s=32;for(let a=0;a<s;a++)i=Math.max(this._inverseFFT(e,n,a/s*r),i);return GEt(-this._inverseFFT(e,n,this._phase)/i,-1,1)}get partials(){return this._partials.slice(0,this.partialCount)}set partials(e){this._partials=e,this._partialCount=this._partials.length,e.length&&(this.type="custom")}get phase(){return this._phase*(180/Math.PI)}set phase(e){this._phase=e*Math.PI/180,this.type=this._type}asArray(){return oo(this,arguments,void 0,function*(e=1024){return rx(this,e)})}dispose(){return super.dispose(),this._oscillator!==null&&this._oscillator.dispose(),this._wave=void 0,this.frequency.dispose(),this.detune.dispose(),this}}so._periodicWaveCache=[];class BX extends Nm{constructor(){super(...arguments),this.name="AudioToGain",this._norm=new GE({context:this.context,mapping:e=>(e+1)/2}),this.input=this._norm,this.output=this._norm}dispose(){return super.dispose(),this._norm.dispose(),this}}class p0 extends Ir{constructor(){const e=Mn(p0.getDefaults(),arguments,["value"]);super(e),this.name="Multiply",this.override=!1,this._mult=this.input=this.output=new Xi({context:this.context,minValue:e.minValue,maxValue:e.maxValue}),this.factor=this._param=this._mult.gain,this.factor.setValueAtTime(e.value,0)}static getDefaults(){return Object.assign(Ir.getDefaults(),{value:0})}dispose(){return super.dispose(),this._mult.dispose(),this}}class B8 extends Nl{constructor(){const e=Mn(B8.getDefaults(),arguments,["frequency","type","modulationType"]);super(e),this.name="AMOscillator",this._modulationScale=new BX({context:this.context}),this._modulationNode=new Xi({context:this.context}),this._carrier=new so({context:this.context,detune:e.detune,frequency:e.frequency,onstop:()=>this.onstop(this),phase:e.phase,type:e.type}),this.frequency=this._carrier.frequency,this.detune=this._carrier.detune,this._modulator=new so({context:this.context,phase:e.phase,type:e.modulationType}),this.harmonicity=new p0({context:this.context,units:"positive",value:e.harmonicity}),this.frequency.chain(this.harmonicity,this._modulator.frequency),this._modulator.chain(this._modulationScale,this._modulationNode.gain),this._carrier.chain(this._modulationNode,this.output),br(this,["frequency","detune","harmonicity"])}static getDefaults(){return Object.assign(so.getDefaults(),{harmonicity:1,modulationType:"square"})}_start(e){this._modulator.start(e),this._carrier.start(e)}_stop(e){this._modulator.stop(e),this._carrier.stop(e)}_restart(e){this._modulator.restart(e),this._carrier.restart(e)}get type(){return this._carrier.type}set type(e){this._carrier.type=e}get baseType(){return this._carrier.baseType}set baseType(e){this._carrier.baseType=e}get partialCount(){return this._carrier.partialCount}set partialCount(e){this._carrier.partialCount=e}get modulationType(){return this._modulator.type}set modulationType(e){this._modulator.type=e}get phase(){return this._carrier.phase}set phase(e){this._carrier.phase=e,this._modulator.phase=e}get partials(){return this._carrier.partials}set partials(e){this._carrier.partials=e}asArray(){return oo(this,arguments,void 0,function*(e=1024){return rx(this,e)})}dispose(){return super.dispose(),this.frequency.dispose(),this.detune.dispose(),this.harmonicity.dispose(),this._carrier.dispose(),this._modulator.dispose(),this._modulationNode.dispose(),this._modulationScale.dispose(),this}}class sP extends Nl{constructor(){const e=Mn(sP.getDefaults(),arguments,["frequency","type","modulationType"]);super(e),this.name="FMOscillator",this._modulationNode=new Xi({context:this.context,gain:0}),this._carrier=new so({context:this.context,detune:e.detune,frequency:0,onstop:()=>this.onstop(this),phase:e.phase,type:e.type}),this.detune=this._carrier.detune,this.frequency=new Ir({context:this.context,units:"frequency",value:e.frequency}),this._modulator=new so({context:this.context,phase:e.phase,type:e.modulationType}),this.harmonicity=new p0({context:this.context,units:"positive",value:e.harmonicity}),this.modulationIndex=new p0({context:this.context,units:"positive",value:e.modulationIndex}),this.frequency.connect(this._carrier.frequency),this.frequency.chain(this.harmonicity,this._modulator.frequency),this.frequency.chain(this.modulationIndex,this._modulationNode),this._modulator.connect(this._modulationNode.gain),this._modulationNode.connect(this._carrier.frequency),this._carrier.connect(this.output),this.detune.connect(this._modulator.detune),br(this,["modulationIndex","frequency","detune","harmonicity"])}static getDefaults(){return Object.assign(so.getDefaults(),{harmonicity:1,modulationIndex:2,modulationType:"square"})}_start(e){this._modulator.start(e),this._carrier.start(e)}_stop(e){this._modulator.stop(e),this._carrier.stop(e)}_restart(e){return this._modulator.restart(e),this._carrier.restart(e),this}get type(){return this._carrier.type}set type(e){this._carrier.type=e}get baseType(){return this._carrier.baseType}set baseType(e){this._carrier.baseType=e}get partialCount(){return this._carrier.partialCount}set partialCount(e){this._carrier.partialCount=e}get modulationType(){return this._modulator.type}set modulationType(e){this._modulator.type=e}get phase(){return this._carrier.phase}set phase(e){this._carrier.phase=e,this._modulator.phase=e}get partials(){return this._carrier.partials}set partials(e){this._carrier.partials=e}asArray(){return oo(this,arguments,void 0,function*(e=1024){return rx(this,e)})}dispose(){return super.dispose(),this.frequency.dispose(),this.harmonicity.dispose(),this._carrier.dispose(),this._modulator.dispose(),this._modulationNode.dispose(),this.modulationIndex.dispose(),this}}class aP extends Nl{constructor(){const e=Mn(aP.getDefaults(),arguments,["frequency","width"]);super(e),this.name="PulseOscillator",this._widthGate=new Xi({context:this.context,gain:0}),this._thresh=new GE({context:this.context,mapping:n=>n<=0?-1:1}),this.width=new Ir({context:this.context,units:"audioRange",value:e.width}),this._triangle=new so({context:this.context,detune:e.detune,frequency:e.frequency,onstop:()=>this.onstop(this),phase:e.phase,type:"triangle"}),this.frequency=this._triangle.frequency,this.detune=this._triangle.detune,this._triangle.chain(this._thresh,this.output),this.width.chain(this._widthGate,this._thresh),br(this,["width","frequency","detune"])}static getDefaults(){return Object.assign(Nl.getDefaults(),{detune:0,frequency:440,phase:0,type:"pulse",width:.2})}_start(e){e=this.toSeconds(e),this._triangle.start(e),this._widthGate.gain.setValueAtTime(1,e)}_stop(e){e=this.toSeconds(e),this._triangle.stop(e),this._widthGate.gain.cancelScheduledValues(e),this._widthGate.gain.setValueAtTime(0,e)}_restart(e){this._triangle.restart(e),this._widthGate.gain.cancelScheduledValues(e),this._widthGate.gain.setValueAtTime(1,e)}get phase(){return this._triangle.phase}set phase(e){this._triangle.phase=e}get type(){return"pulse"}get baseType(){return"pulse"}get partials(){return[]}get partialCount(){return 0}set carrierType(e){this._triangle.type=e}asArray(){return oo(this,arguments,void 0,function*(e=1024){return rx(this,e)})}dispose(){return super.dispose(),this._triangle.dispose(),this.width.dispose(),this._widthGate.dispose(),this._thresh.dispose(),this}}class F8 extends Nl{constructor(){const e=Mn(F8.getDefaults(),arguments,["frequency","type","spread"]);super(e),this.name="FatOscillator",this._oscillators=[],this.frequency=new Ir({context:this.context,units:"frequency",value:e.frequency}),this.detune=new Ir({context:this.context,units:"cents",value:e.detune}),this._spread=e.spread,this._type=e.type,this._phase=e.phase,this._partials=e.partials,this._partialCount=e.partialCount,this.count=e.count,br(this,["frequency","detune"])}static getDefaults(){return Object.assign(so.getDefaults(),{count:3,spread:20,type:"sawtooth"})}_start(e){e=this.toSeconds(e),this._forEach(n=>n.start(e))}_stop(e){e=this.toSeconds(e),this._forEach(n=>n.stop(e))}_restart(e){this._forEach(n=>n.restart(e))}_forEach(e){for(let n=0;n<this._oscillators.length;n++)e(this._oscillators[n],n)}get type(){return this._type}set type(e){this._type=e,this._forEach(n=>n.type=e)}get spread(){return this._spread}set spread(e){if(this._spread=e,this._oscillators.length>1){const n=-e/2,i=e/(this._oscillators.length-1);this._forEach((r,s)=>r.detune.value=n+i*s)}}get count(){return this._oscillators.length}set count(e){if(pp(e,1),this._oscillators.length!==e){this._forEach(n=>n.dispose()),this._oscillators=[];for(let n=0;n<e;n++){const i=new so({context:this.context,volume:-6-e*1.1,type:this._type,phase:this._phase+n/e*360,partialCount:this._partialCount,onstop:n===0?()=>this.onstop(this):Ss});this.type==="custom"&&(i.partials=this._partials),this.frequency.connect(i.frequency),this.detune.connect(i.detune),i.detune.overridden=!1,i.connect(this.output),this._oscillators[n]=i}this.spread=this._spread,this.state==="started"&&this._forEach(n=>n.start())}}get phase(){return this._phase}set phase(e){this._phase=e,this._forEach((n,i)=>n.phase=this._phase+i/this.count*360)}get baseType(){return this._oscillators[0].baseType}set baseType(e){this._forEach(n=>n.baseType=e),this._type=this._oscillators[0].type}get partials(){return this._oscillators[0].partials}set partials(e){this._partials=e,this._partialCount=this._partials.length,e.length&&(this._type="custom",this._forEach(n=>n.partials=e))}get partialCount(){return this._oscillators[0].partialCount}set partialCount(e){this._partialCount=e,this._forEach(n=>n.partialCount=e),this._type=this._oscillators[0].type}asArray(){return oo(this,arguments,void 0,function*(e=1024){return rx(this,e)})}dispose(){return super.dispose(),this.frequency.dispose(),this.detune.dispose(),this._forEach(e=>e.dispose()),this}}class z8 extends Nl{constructor(){const e=Mn(z8.getDefaults(),arguments,["frequency","modulationFrequency"]);super(e),this.name="PWMOscillator",this.sourceType="pwm",this._scale=new p0({context:this.context,value:2}),this._pulse=new aP({context:this.context,frequency:e.modulationFrequency}),this._pulse.carrierType="sine",this.modulationFrequency=this._pulse.frequency,this._modulator=new so({context:this.context,detune:e.detune,frequency:e.frequency,onstop:()=>this.onstop(this),phase:e.phase}),this.frequency=this._modulator.frequency,this.detune=this._modulator.detune,this._modulator.chain(this._scale,this._pulse.width),this._pulse.connect(this.output),br(this,["modulationFrequency","frequency","detune"])}static getDefaults(){return Object.assign(Nl.getDefaults(),{detune:0,frequency:440,modulationFrequency:.4,phase:0,type:"pwm"})}_start(e){e=this.toSeconds(e),this._modulator.start(e),this._pulse.start(e)}_stop(e){e=this.toSeconds(e),this._modulator.stop(e),this._pulse.stop(e)}_restart(e){this._modulator.restart(e),this._pulse.restart(e)}get type(){return"pwm"}get baseType(){return"pwm"}get partials(){return[]}get partialCount(){return 0}get phase(){return this._modulator.phase}set phase(e){this._modulator.phase=e}asArray(){return oo(this,arguments,void 0,function*(e=1024){return rx(this,e)})}dispose(){return super.dispose(),this._pulse.dispose(),this._scale.dispose(),this._modulator.dispose(),this}}const lae={am:B8,fat:F8,fm:sP,oscillator:so,pulse:aP,pwm:z8};class FA extends Nl{constructor(){const e=Mn(FA.getDefaults(),arguments,["frequency","type"]);super(e),this.name="OmniOscillator",this.frequency=new Ir({context:this.context,units:"frequency",value:e.frequency}),this.detune=new Ir({context:this.context,units:"cents",value:e.detune}),br(this,["frequency","detune"]),this.set(e)}static getDefaults(){return Object.assign(so.getDefaults(),sP.getDefaults(),B8.getDefaults(),F8.getDefaults(),aP.getDefaults(),z8.getDefaults())}_start(e){this._oscillator.start(e)}_stop(e){this._oscillator.stop(e)}_restart(e){return this._oscillator.restart(e),this}get type(){let e="";return["am","fm","fat"].some(n=>this._sourceType===n)&&(e=this._sourceType),e+this._oscillator.type}set type(e){e.substr(0,2)==="fm"?(this._createNewOscillator("fm"),this._oscillator=this._oscillator,this._oscillator.type=e.substr(2)):e.substr(0,2)==="am"?(this._createNewOscillator("am"),this._oscillator=this._oscillator,this._oscillator.type=e.substr(2)):e.substr(0,3)==="fat"?(this._createNewOscillator("fat"),this._oscillator=this._oscillator,this._oscillator.type=e.substr(3)):e==="pwm"?(this._createNewOscillator("pwm"),this._oscillator=this._oscillator):e==="pulse"?this._createNewOscillator("pulse"):(this._createNewOscillator("oscillator"),this._oscillator=this._oscillator,this._oscillator.type=e)}get partials(){return this._oscillator.partials}set partials(e){!this._getOscType(this._oscillator,"pulse")&&!this._getOscType(this._oscillator,"pwm")&&(this._oscillator.partials=e)}get partialCount(){return this._oscillator.partialCount}set partialCount(e){!this._getOscType(this._oscillator,"pulse")&&!this._getOscType(this._oscillator,"pwm")&&(this._oscillator.partialCount=e)}set(e){return Reflect.has(e,"type")&&e.type&&(this.type=e.type),super.set(e),this}_createNewOscillator(e){if(e!==this._sourceType){this._sourceType=e;const n=lae[e],i=this.now();if(this._oscillator){const r=this._oscillator;r.stop(i),this.context.setTimeout(()=>r.dispose(),this.blockTime)}this._oscillator=new n({context:this.context}),this.frequency.connect(this._oscillator.frequency),this.detune.connect(this._oscillator.detune),this._oscillator.connect(this.output),this._oscillator.onstop=()=>this.onstop(this),this.state==="started"&&this._oscillator.start(i)}}get phase(){return this._oscillator.phase}set phase(e){this._oscillator.phase=e}get sourceType(){return this._sourceType}set sourceType(e){let n="sine";this._oscillator.type!=="pwm"&&this._oscillator.type!=="pulse"&&(n=this._oscillator.type),e==="fm"?this.type="fm"+n:e==="am"?this.type="am"+n:e==="fat"?this.type="fat"+n:e==="oscillator"?this.type=n:e==="pulse"?this.type="pulse":e==="pwm"&&(this.type="pwm")}_getOscType(e,n){return e instanceof lae[n]}get baseType(){return this._oscillator.baseType}set baseType(e){!this._getOscType(this._oscillator,"pulse")&&!this._getOscType(this._oscillator,"pwm")&&e!=="pulse"&&e!=="pwm"&&(this._oscillator.baseType=e)}get width(){if(this._getOscType(this._oscillator,"pulse"))return this._oscillator.width}get count(){if(this._getOscType(this._oscillator,"fat"))return this._oscillator.count}set count(e){this._getOscType(this._oscillator,"fat")&&Om(e)&&(this._oscillator.count=e)}get spread(){if(this._getOscType(this._oscillator,"fat"))return this._oscillator.spread}set spread(e){this._getOscType(this._oscillator,"fat")&&Om(e)&&(this._oscillator.spread=e)}get modulationType(){if(this._getOscType(this._oscillator,"fm")||this._getOscType(this._oscillator,"am"))return this._oscillator.modulationType}set modulationType(e){(this._getOscType(this._oscillator,"fm")||this._getOscType(this._oscillator,"am"))&&B_(e)&&(this._oscillator.modulationType=e)}get modulationIndex(){if(this._getOscType(this._oscillator,"fm"))return this._oscillator.modulationIndex}get harmonicity(){if(this._getOscType(this._oscillator,"fm")||this._getOscType(this._oscillator,"am"))return this._oscillator.harmonicity}get modulationFrequency(){if(this._getOscType(this._oscillator,"pwm"))return this._oscillator.modulationFrequency}asArray(){return oo(this,arguments,void 0,function*(e=1024){return rx(this,e)})}dispose(){return super.dispose(),this.detune.dispose(),this.frequency.dispose(),this._oscillator.dispose(),this}}class FX extends Ir{constructor(){super(Mn(FX.getDefaults(),arguments,["value"])),this.override=!1,this.name="Add",this._sum=new Xi({context:this.context}),this.input=this._sum,this.output=this._sum,this.addend=this._param,M1(this._constantSource,this._sum)}static getDefaults(){return Object.assign(Ir.getDefaults(),{value:0})}dispose(){return super.dispose(),this._sum.dispose(),this}}class b_ extends Nm{constructor(){const e=Mn(b_.getDefaults(),arguments,["min","max"]);super(e),this.name="Scale",this._mult=this.input=new p0({context:this.context,value:e.max-e.min}),this._add=this.output=new FX({context:this.context,value:e.min}),this._min=e.min,this._max=e.max,this.input.connect(this.output)}static getDefaults(){return Object.assign(Nm.getDefaults(),{max:1,min:0})}get min(){return this._min}set min(e){this._min=e,this._setRange()}get max(){return this._max}set max(e){this._max=e,this._setRange()}_setRange(){this._add.value=this._min,this._mult.value=this._max-this._min}dispose(){return super.dispose(),this._add.dispose(),this._mult.dispose(),this}}class zX extends Nm{constructor(){super(Mn(zX.getDefaults(),arguments)),this.name="Zero",this._gain=new Xi({context:this.context}),this.output=this._gain,this.input=void 0,Rp(this.context.getConstant(0),this._gain)}dispose(){return super.dispose(),QEe(this.context.getConstant(0),this._gain),this}}class N1 extends Ln{constructor(){const e=Mn(N1.getDefaults(),arguments,["frequency","min","max"]);super(e),this.name="LFO",this._stoppedValue=0,this._units="number",this.convert=!0,this._fromType=gr.prototype._fromType,this._toType=gr.prototype._toType,this._is=gr.prototype._is,this._clampValue=gr.prototype._clampValue,this._oscillator=new so(e),this.frequency=this._oscillator.frequency,this._amplitudeGain=new Xi({context:this.context,gain:e.amplitude,units:"normalRange"}),this.amplitude=this._amplitudeGain.gain,this._stoppedSignal=new Ir({context:this.context,units:"audioRange",value:0}),this._zeros=new zX({context:this.context}),this._a2g=new BX({context:this.context}),this._scaler=this.output=new b_({context:this.context,max:e.max,min:e.min}),this.units=e.units,this.min=e.min,this.max=e.max,this._oscillator.chain(this._amplitudeGain,this._a2g,this._scaler),this._zeros.connect(this._a2g),this._stoppedSignal.connect(this._a2g),br(this,["amplitude","frequency"]),this.phase=e.phase}static getDefaults(){return Object.assign(so.getDefaults(),{amplitude:1,frequency:"4n",max:1,min:0,type:"sine",units:"number"})}start(e){return e=this.toSeconds(e),this._stoppedSignal.setValueAtTime(0,e),this._oscillator.start(e),this}stop(e){return e=this.toSeconds(e),this._stoppedSignal.setValueAtTime(this._stoppedValue,e),this._oscillator.stop(e),this}sync(){return this._oscillator.sync(),this._oscillator.syncFrequency(),this}unsync(){return this._oscillator.unsync(),this._oscillator.unsyncFrequency(),this}_setStoppedValue(){this._stoppedValue=this._oscillator.getInitialValue(),this._stoppedSignal.value=this._stoppedValue}get min(){return this._toType(this._scaler.min)}set min(e){e=this._fromType(e),this._scaler.min=e}get max(){return this._toType(this._scaler.max)}set max(e){e=this._fromType(e),this._scaler.max=e}get type(){return this._oscillator.type}set type(e){this._oscillator.type=e,this._setStoppedValue()}get partials(){return this._oscillator.partials}set partials(e){this._oscillator.partials=e,this._setStoppedValue()}get phase(){return this._oscillator.phase}set phase(e){this._oscillator.phase=e,this._setStoppedValue()}get units(){return this._units}set units(e){const n=this.min,i=this.max;this._units=e,this.min=n,this.max=i}get state(){return this._oscillator.state}connect(e,n,i){return(e instanceof gr||e instanceof Ir)&&(this.convert=e.convert,this.units=e.units),P8(this,e,n,i),this}dispose(){return super.dispose(),this._oscillator.dispose(),this._stoppedSignal.dispose(),this._zeros.dispose(),this._scaler.dispose(),this._a2g.dispose(),this._amplitudeGain.dispose(),this.amplitude.dispose(),this}}function eSe(t,e=1/0){const n=new WeakMap;return function(i,r){Reflect.defineProperty(i,r,{configurable:!0,enumerable:!0,get:function(){return n.get(this)},set:function(s){pp(s,t,e),n.set(this,s)}})}}function J_(t,e=1/0){const n=new WeakMap;return function(i,r){Reflect.defineProperty(i,r,{configurable:!0,enumerable:!0,get:function(){return n.get(this)},set:function(s){pp(this.toSeconds(s),t,e),n.set(this,s)}})}}class oP extends Nl{constructor(){const e=Mn(oP.getDefaults(),arguments,["url","onload"]);super(e),this.name="Player",this._activeSources=new Set,this._buffer=new Hs({onload:this._onload.bind(this,e.onload),onerror:e.onerror,reverse:e.reverse,url:e.url}),this.autostart=e.autostart,this._loop=e.loop,this._loopStart=e.loopStart,this._loopEnd=e.loopEnd,this._playbackRate=e.playbackRate,this.fadeIn=e.fadeIn,this.fadeOut=e.fadeOut}static getDefaults(){return Object.assign(Nl.getDefaults(),{autostart:!1,fadeIn:0,fadeOut:0,loop:!1,loopEnd:0,loopStart:0,onload:Ss,onerror:Ss,playbackRate:1,reverse:!1})}load(e){return oo(this,void 0,void 0,function*(){return yield this._buffer.load(e),this._onload(),this})}_onload(e=Ss){e(),this.autostart&&this.start()}_onSourceEnd(e){this.onstop(this),this._activeSources.delete(e),this._activeSources.size===0&&!this._synced&&this._state.getValueAtTime(this.now())==="started"&&(this._state.cancel(this.now()),this._state.setStateAtTime("stopped",this.now()))}start(e,n,i){return super.start(e,n,i),this}_start(e,n,i){this._loop?n=n0(n,this._loopStart):n=n0(n,0);const r=this.toSeconds(n),s=i;i=n0(i,Math.max(this._buffer.duration-r,0));let a=this.toSeconds(i);a=a/this._playbackRate,e=this.toSeconds(e);const o=new rP({url:this._buffer,context:this.context,fadeIn:this.fadeIn,fadeOut:this.fadeOut,loop:this._loop,loopEnd:this._loopEnd,loopStart:this._loopStart,onended:this._onSourceEnd.bind(this),playbackRate:this._playbackRate}).connect(this.output);!this._loop&&!this._synced&&(this._state.cancel(e+a),this._state.setStateAtTime("stopped",e+a,{implicitEnd:!0})),this._activeSources.add(o),this._loop&&mf(s)?o.start(e,r):o.start(e,r,a-this.toSeconds(this.fadeOut))}_stop(e){const n=this.toSeconds(e);this._activeSources.forEach(i=>i.stop(n))}restart(e,n,i){return super.restart(e,n,i),this}_restart(e,n,i){var r;(r=[...this._activeSources].pop())===null||r===void 0||r.stop(e),this._start(e,n,i)}seek(e,n){const i=this.toSeconds(n);if(this._state.getValueAtTime(i)==="started"){const r=this.toSeconds(e);this._stop(i),this._start(i,r)}return this}setLoopPoints(e,n){return this.loopStart=e,this.loopEnd=n,this}get loopStart(){return this._loopStart}set loopStart(e){this._loopStart=e,this.buffer.loaded&&pp(this.toSeconds(e),0,this.buffer.duration),this._activeSources.forEach(n=>{n.loopStart=e})}get loopEnd(){return this._loopEnd}set loopEnd(e){this._loopEnd=e,this.buffer.loaded&&pp(this.toSeconds(e),0,this.buffer.duration),this._activeSources.forEach(n=>{n.loopEnd=e})}get buffer(){return this._buffer}set buffer(e){this._buffer.set(e)}get loop(){return this._loop}set loop(e){if(this._loop!==e&&(this._loop=e,this._activeSources.forEach(n=>{n.loop=e}),e)){const n=this._state.getNextState("stopped",this.now());n&&this._state.cancel(n.time)}}get playbackRate(){return this._playbackRate}set playbackRate(e){this._playbackRate=e;const n=this.now(),i=this._state.getNextState("stopped",n);i&&i.implicitEnd&&(this._state.cancel(i.time),this._activeSources.forEach(r=>r.cancelStop())),this._activeSources.forEach(r=>{r.playbackRate.setValueAtTime(e,n)})}get reverse(){return this._buffer.reverse}set reverse(e){this._buffer.reverse=e}get loaded(){return this._buffer.loaded}dispose(){return super.dispose(),this._activeSources.forEach(e=>e.dispose()),this._activeSources.clear(),this._buffer.dispose(),this}}pa([J_(0)],oP.prototype,"fadeIn",void 0);pa([J_(0)],oP.prototype,"fadeOut",void 0);class rSt extends Nm{constructor(){super(...arguments),this.name="Abs",this._abs=new GE({context:this.context,mapping:e=>Math.abs(e)<.001?0:Math.abs(e)}),this.input=this._abs,this.output=this._abs}dispose(){return super.dispose(),this._abs.dispose(),this}}class sSt extends Nm{constructor(){super(...arguments),this.name="GainToAudio",this._norm=new GE({context:this.context,mapping:e=>Math.abs(e)*2-1}),this.input=this._norm,this.output=this._norm}dispose(){return super.dispose(),this._norm.dispose(),this}}class jX extends b_{constructor(){const e=Mn(jX.getDefaults(),arguments,["min","max","exponent"]);super(e),this.name="ScaleExp",this.input=this._exp=new L8({context:this.context,value:e.exponent}),this._exp.connect(this._mult)}static getDefaults(){return Object.assign(b_.getDefaults(),{exponent:1})}get exponent(){return this._exp.value}set exponent(e){this._exp.value=e}dispose(){return super.dispose(),this._exp.dispose(),this}}class vf extends Ln{constructor(){const e=Mn(vf.getDefaults(),arguments,["attack","decay","sustain","release"]);super(e),this.name="Envelope",this._sig=new Ir({context:this.context,value:0}),this.output=this._sig,this.input=void 0,this.attack=e.attack,this.decay=e.decay,this.sustain=e.sustain,this.release=e.release,this.attackCurve=e.attackCurve,this.releaseCurve=e.releaseCurve,this.decayCurve=e.decayCurve}static getDefaults(){return Object.assign(Ln.getDefaults(),{attack:.01,attackCurve:"linear",decay:.1,decayCurve:"exponential",release:1,releaseCurve:"exponential",sustain:.5})}get value(){return this.getValueAtTime(this.now())}_getCurve(e,n){if(B_(e))return e;{let i;for(i in E2)if(E2[i][n]===e)return i;return e}}_setCurve(e,n,i){if(B_(i)&&Reflect.has(E2,i)){const r=E2[i];Xb(r)?e!=="_decayCurve"&&(this[e]=r[n]):this[e]=r}else if(hd(i)&&e!=="_decayCurve")this[e]=i;else throw new Error("Envelope: invalid curve: "+i)}get attackCurve(){return this._getCurve(this._attackCurve,"In")}set attackCurve(e){this._setCurve("_attackCurve","In",e)}get releaseCurve(){return this._getCurve(this._releaseCurve,"Out")}set releaseCurve(e){this._setCurve("_releaseCurve","Out",e)}get decayCurve(){return this._getCurve(this._decayCurve,"Out")}set decayCurve(e){this._setCurve("_decayCurve","Out",e)}triggerAttack(e,n=1){this.log("triggerAttack",e,n),e=this.toSeconds(e);let r=this.toSeconds(this.attack);const s=this.toSeconds(this.decay),a=this.getValueAtTime(e);if(a>0){const o=1/r;r=(1-a)/o}if(r<this.sampleTime)this._sig.cancelScheduledValues(e),this._sig.setValueAtTime(n,e);else if(this._attackCurve==="linear")this._sig.linearRampTo(n,r,e);else if(this._attackCurve==="exponential")this._sig.targetRampTo(n,r,e);else{this._sig.cancelAndHoldAtTime(e);let o=this._attackCurve;for(let c=1;c<o.length;c++)if(o[c-1]<=a&&a<=o[c]){o=this._attackCurve.slice(c),o[0]=a;break}this._sig.setValueCurveAtTime(o,e,r,n)}if(s&&this.sustain<1){const o=n*this.sustain,c=e+r;this.log("decay",c),this._decayCurve==="linear"?this._sig.linearRampToValueAtTime(o,s+c):this._sig.exponentialApproachValueAtTime(o,c,s)}return this}triggerRelease(e){this.log("triggerRelease",e),e=this.toSeconds(e);const n=this.getValueAtTime(e);if(n>0){const i=this.toSeconds(this.release);i<this.sampleTime?this._sig.setValueAtTime(0,e):this._releaseCurve==="linear"?this._sig.linearRampTo(0,i,e):this._releaseCurve==="exponential"?this._sig.targetRampTo(0,i,e):(Ri(hd(this._releaseCurve),"releaseCurve must be either 'linear', 'exponential' or an array"),this._sig.cancelAndHoldAtTime(e),this._sig.setValueCurveAtTime(this._releaseCurve,e,i,n))}return this}getValueAtTime(e){return this._sig.getValueAtTime(e)}triggerAttackRelease(e,n,i=1){return n=this.toSeconds(n),this.triggerAttack(n,i),this.triggerRelease(n+this.toSeconds(e)),this}cancel(e){return this._sig.cancelScheduledValues(this.toSeconds(e)),this}connect(e,n=0,i=0){return P8(this,e,n,i),this}asArray(){return oo(this,arguments,void 0,function*(e=1024){const n=e/this.context.sampleRate,i=new I8(1,n,this.context.sampleRate),r=this.toSeconds(this.attack)+this.toSeconds(this.decay),s=r+this.toSeconds(this.release),a=s*.1,o=s+a,c=new this.constructor(Object.assign(this.get(),{attack:n*this.toSeconds(this.attack)/o,decay:n*this.toSeconds(this.decay)/o,release:n*this.toSeconds(this.release)/o,context:i}));return c._sig.toDestination(),c.triggerAttackRelease(n*(r+a)/o,0),(yield i.render()).getChannelData(0)})}dispose(){return super.dispose(),this._sig.dispose(),this}}pa([J_(0)],vf.prototype,"attack",void 0);pa([J_(0)],vf.prototype,"decay",void 0);pa([eSe(0,1)],vf.prototype,"sustain",void 0);pa([J_(0)],vf.prototype,"release",void 0);const E2=(()=>{let e,n;const i=[];for(e=0;e<128;e++)i[e]=Math.sin(e/127*(Math.PI/2));const r=[],s=6.4;for(e=0;e<127;e++){n=e/127;const d=Math.sin(n*(Math.PI*2)*s-Math.PI/2)+1;r[e]=d/10+n*.83}r[127]=1;const a=[],o=5;for(e=0;e<128;e++)a[e]=Math.ceil(e/127*o)/o;const c=[];for(e=0;e<128;e++)n=e/127,c[e]=.5*(1-Math.cos(Math.PI*n));const l=[];for(e=0;e<128;e++){n=e/127;const d=Math.pow(n,3)*4+.2,f=Math.cos(d*Math.PI*2*n);l[e]=Math.abs(f*(1-n))}function u(d){const f=new Array(d.length);for(let p=0;p<d.length;p++)f[p]=1-d[p];return f}function h(d){return d.slice(0).reverse()}return{bounce:{In:u(l),Out:l},cosine:{In:i,Out:h(i)},exponential:"exponential",linear:"linear",ripple:{In:r,Out:u(r)},sine:{In:c,Out:u(c)},step:{In:a,Out:u(a)}}})();class m0 extends Ln{constructor(){const e=Mn(m0.getDefaults(),arguments);super(e),this._scheduledEvents=[],this._synced=!1,this._original_triggerAttack=this.triggerAttack,this._original_triggerRelease=this.triggerRelease,this._syncedRelease=n=>this._original_triggerRelease(n),this._volume=this.output=new $g({context:this.context,volume:e.volume}),this.volume=this._volume.volume,br(this,"volume")}static getDefaults(){return Object.assign(Ln.getDefaults(),{volume:0})}sync(){return this._syncState()&&(this._syncMethod("triggerAttack",1),this._syncMethod("triggerRelease",0),this.context.transport.on("stop",this._syncedRelease),this.context.transport.on("pause",this._syncedRelease),this.context.transport.on("loopEnd",this._syncedRelease)),this}_syncState(){let e=!1;return this._synced||(this._synced=!0,e=!0),e}_syncMethod(e,n){const i=this["_original_"+e]=this[e];this[e]=(...r)=>{const s=r[n],a=this.context.transport.schedule(o=>{r[n]=o,i.apply(this,r)},s);this._scheduledEvents.push(a)}}unsync(){return this._scheduledEvents.forEach(e=>this.context.transport.clear(e)),this._scheduledEvents=[],this._synced&&(this._synced=!1,this.triggerAttack=this._original_triggerAttack,this.triggerRelease=this._original_triggerRelease,this.context.transport.off("stop",this._syncedRelease),this.context.transport.off("pause",this._syncedRelease),this.context.transport.off("loopEnd",this._syncedRelease)),this}triggerAttackRelease(e,n,i,r){const s=this.toSeconds(i),a=this.toSeconds(n);return this.triggerAttack(e,s,r),this.triggerRelease(s+a),this}dispose(){return super.dispose(),this._volume.dispose(),this.unsync(),this._scheduledEvents=[],this}}class Im extends m0{constructor(){const e=Mn(Im.getDefaults(),arguments);super(e),this.portamento=e.portamento,this.onsilence=e.onsilence}static getDefaults(){return Object.assign(m0.getDefaults(),{detune:0,onsilence:Ss,portamento:0})}triggerAttack(e,n,i=1){this.log("triggerAttack",e,n,i);const r=this.toSeconds(n);return this._triggerEnvelopeAttack(r,i),this.setNote(e,r),this}triggerRelease(e){this.log("triggerRelease",e);const n=this.toSeconds(e);return this._triggerEnvelopeRelease(n),this}setNote(e,n){const i=this.toSeconds(n),r=e instanceof cd?e.toFrequency():e;if(this.portamento>0&&this.getLevelAtTime(i)>.05){const s=this.toSeconds(this.portamento);this.frequency.exponentialRampTo(r,s,i)}else this.frequency.setValueAtTime(r,i);return this}}pa([J_(0)],Im.prototype,"portamento",void 0);class j8 extends vf{constructor(){super(Mn(j8.getDefaults(),arguments,["attack","decay","sustain","release"])),this.name="AmplitudeEnvelope",this._gainNode=new Xi({context:this.context,gain:0}),this.output=this._gainNode,this.input=this._gainNode,this._sig.connect(this._gainNode.gain),this.output=this._gainNode,this.input=this._gainNode}dispose(){return super.dispose(),this._gainNode.dispose(),this}}class $l extends Im{constructor(){const e=Mn($l.getDefaults(),arguments);super(e),this.name="Synth",this.oscillator=new FA(Object.assign({context:this.context,detune:e.detune,onstop:()=>this.onsilence(this)},e.oscillator)),this.frequency=this.oscillator.frequency,this.detune=this.oscillator.detune,this.envelope=new j8(Object.assign({context:this.context},e.envelope)),this.oscillator.chain(this.envelope,this.output),br(this,["oscillator","frequency","detune","envelope"])}static getDefaults(){return Object.assign(Im.getDefaults(),{envelope:Object.assign(qg(vf.getDefaults(),Object.keys(Ln.getDefaults())),{attack:.005,decay:.1,release:1,sustain:.3}),oscillator:Object.assign(qg(FA.getDefaults(),[...Object.keys(Nl.getDefaults()),"frequency","detune"]),{type:"triangle"})})}_triggerEnvelopeAttack(e,n){if(this.envelope.triggerAttack(e,n),this.oscillator.start(e),this.envelope.sustain===0){const i=this.toSeconds(this.envelope.attack),r=this.toSeconds(this.envelope.decay);this.oscillator.stop(e+i+r)}}_triggerEnvelopeRelease(e){this.envelope.triggerRelease(e),this.oscillator.stop(e+this.toSeconds(this.envelope.release))}getLevelAtTime(e){return e=this.toSeconds(e),this.envelope.getValueAtTime(e)}dispose(){return super.dispose(),this.oscillator.dispose(),this.envelope.dispose(),this}}class CB extends Im{constructor(){const e=Mn(CB.getDefaults(),arguments);super(e),this.name="ModulationSynth",this._carrier=new $l({context:this.context,oscillator:e.oscillator,envelope:e.envelope,onsilence:()=>this.onsilence(this),volume:-10}),this._modulator=new $l({context:this.context,oscillator:e.modulation,envelope:e.modulationEnvelope,volume:-10}),this.oscillator=this._carrier.oscillator,this.envelope=this._carrier.envelope,this.modulation=this._modulator.oscillator,this.modulationEnvelope=this._modulator.envelope,this.frequency=new Ir({context:this.context,units:"frequency"}),this.detune=new Ir({context:this.context,value:e.detune,units:"cents"}),this.harmonicity=new p0({context:this.context,value:e.harmonicity,minValue:0}),this._modulationNode=new Xi({context:this.context,gain:0}),br(this,["frequency","harmonicity","oscillator","envelope","modulation","modulationEnvelope","detune"])}static getDefaults(){return Object.assign(Im.getDefaults(),{harmonicity:3,oscillator:Object.assign(qg(FA.getDefaults(),[...Object.keys(Nl.getDefaults()),"frequency","detune"]),{type:"sine"}),envelope:Object.assign(qg(vf.getDefaults(),Object.keys(Ln.getDefaults())),{attack:.01,decay:.01,sustain:1,release:.5}),modulation:Object.assign(qg(FA.getDefaults(),[...Object.keys(Nl.getDefaults()),"frequency","detune"]),{type:"square"}),modulationEnvelope:Object.assign(qg(vf.getDefaults(),Object.keys(Ln.getDefaults())),{attack:.5,decay:0,sustain:1,release:.5})})}_triggerEnvelopeAttack(e,n){this._carrier._triggerEnvelopeAttack(e,n),this._modulator._triggerEnvelopeAttack(e,n)}_triggerEnvelopeRelease(e){return this._carrier._triggerEnvelopeRelease(e),this._modulator._triggerEnvelopeRelease(e),this}getLevelAtTime(e){return e=this.toSeconds(e),this.envelope.getValueAtTime(e)}dispose(){return super.dispose(),this._carrier.dispose(),this._modulator.dispose(),this.frequency.dispose(),this.detune.dispose(),this.harmonicity.dispose(),this._modulationNode.dispose(),this}}class zA extends Ln{constructor(){const e=Mn(zA.getDefaults(),arguments,["frequency","type"]);super(e),this.name="BiquadFilter",this._filter=this.context.createBiquadFilter(),this.input=this.output=this._filter,this.Q=new gr({context:this.context,units:"number",value:e.Q,param:this._filter.Q}),this.frequency=new gr({context:this.context,units:"frequency",value:e.frequency,param:this._filter.frequency}),this.detune=new gr({context:this.context,units:"cents",value:e.detune,param:this._filter.detune}),this.gain=new gr({context:this.context,units:"decibels",convert:!1,value:e.gain,param:this._filter.gain}),this.type=e.type}static getDefaults(){return Object.assign(Ln.getDefaults(),{Q:1,type:"lowpass",frequency:350,detune:0,gain:0})}get type(){return this._filter.type}set type(e){Ri(["lowpass","highpass","bandpass","lowshelf","highshelf","notch","allpass","peaking"].indexOf(e)!==-1,`Invalid filter type: ${e}`),this._filter.type=e}getFrequencyResponse(e=128){const n=new Float32Array(e);for(let a=0;a<e;a++){const c=Math.pow(a/e,2)*19980+20;n[a]=c}const i=new Float32Array(e),r=new Float32Array(e),s=this.context.createBiquadFilter();return s.type=this.type,s.Q.value=this.Q.value,s.frequency.value=this.frequency.value,s.gain.value=this.gain.value,s.getFrequencyResponse(n,i,r),i}dispose(){return super.dispose(),this._filter.disconnect(),this.Q.dispose(),this.frequency.dispose(),this.gain.dispose(),this.detune.dispose(),this}}class ah extends Ln{constructor(){const e=Mn(ah.getDefaults(),arguments,["frequency","type","rolloff"]);super(e),this.name="Filter",this.input=new Xi({context:this.context}),this.output=new Xi({context:this.context}),this._filters=[],this._filters=[],this.Q=new Ir({context:this.context,units:"positive",value:e.Q}),this.frequency=new Ir({context:this.context,units:"frequency",value:e.frequency}),this.detune=new Ir({context:this.context,units:"cents",value:e.detune}),this.gain=new Ir({context:this.context,units:"decibels",convert:!1,value:e.gain}),this._type=e.type,this.rolloff=e.rolloff,br(this,["detune","frequency","gain","Q"])}static getDefaults(){return Object.assign(Ln.getDefaults(),{Q:1,detune:0,frequency:350,gain:0,rolloff:-12,type:"lowpass"})}get type(){return this._type}set type(e){Ri(["lowpass","highpass","bandpass","lowshelf","highshelf","notch","allpass","peaking"].indexOf(e)!==-1,`Invalid filter type: ${e}`),this._type=e,this._filters.forEach(i=>i.type=e)}get rolloff(){return this._rolloff}set rolloff(e){const n=Om(e)?e:parseInt(e,10),i=[-12,-24,-48,-96];let r=i.indexOf(n);Ri(r!==-1,`rolloff can only be ${i.join(", ")}`),r+=1,this._rolloff=n,this.input.disconnect(),this._filters.forEach(s=>s.disconnect()),this._filters=new Array(r);for(let s=0;s<r;s++){const a=new zA({context:this.context});a.type=this._type,this.frequency.connect(a.frequency),this.detune.connect(a.detune),this.Q.connect(a.Q),this.gain.connect(a.gain),this._filters[s]=a}this._internalChannels=this._filters,M1(this.input,...this._internalChannels,this.output)}getFrequencyResponse(e=128){const n=new zA({context:this.context,frequency:this.frequency.value,gain:this.gain.value,Q:this.Q.value,type:this._type,detune:this.detune.value}),i=new Float32Array(e).map(()=>1);return this._filters.forEach(()=>{n.getFrequencyResponse(e).forEach((s,a)=>i[a]*=s)}),n.dispose(),i}dispose(){return super.dispose(),this._filters.forEach(e=>{e.dispose()}),nP(this,["detune","frequency","gain","Q"]),this.frequency.dispose(),this.Q.dispose(),this.detune.dispose(),this.gain.dispose(),this}}class HX extends CB{constructor(){const e=Mn(HX.getDefaults(),arguments);super(e),this.name="FMSynth",this.modulationIndex=new p0({context:this.context,value:e.modulationIndex}),this.frequency.connect(this._carrier.frequency),this.frequency.chain(this.harmonicity,this._modulator.frequency),this.frequency.chain(this.modulationIndex,this._modulationNode),this.detune.fan(this._carrier.detune,this._modulator.detune),this._modulator.connect(this._modulationNode.gain),this._modulationNode.connect(this._carrier.frequency),this._carrier.connect(this.output)}static getDefaults(){return Object.assign(CB.getDefaults(),{modulationIndex:10})}dispose(){return super.dispose(),this.modulationIndex.dispose(),this}}const uae=[1,1.483,1.932,2.546,2.63,3.897];class VX extends Im{constructor(){const e=Mn(VX.getDefaults(),arguments);super(e),this.name="MetalSynth",this._oscillators=[],this._freqMultipliers=[],this.detune=new Ir({context:this.context,units:"cents",value:e.detune}),this.frequency=new Ir({context:this.context,units:"frequency"}),this._amplitude=new Xi({context:this.context,gain:0}).connect(this.output),this._highpass=new ah({Q:0,context:this.context,type:"highpass"}).connect(this._amplitude);for(let n=0;n<uae.length;n++){const i=new sP({context:this.context,harmonicity:e.harmonicity,modulationIndex:e.modulationIndex,modulationType:"square",onstop:n===0?()=>this.onsilence(this):Ss,type:"square"});i.connect(this._highpass),this._oscillators[n]=i;const r=new p0({context:this.context,value:uae[n]});this._freqMultipliers[n]=r,this.frequency.chain(r,i.frequency),this.detune.connect(i.detune)}this._filterFreqScaler=new b_({context:this.context,max:7e3,min:this.toFrequency(e.resonance)}),this.envelope=new vf({attack:e.envelope.attack,attackCurve:"linear",context:this.context,decay:e.envelope.decay,release:e.envelope.release,sustain:0}),this.envelope.chain(this._filterFreqScaler,this._highpass.frequency),this.envelope.connect(this._amplitude.gain),this._octaves=e.octaves,this.octaves=e.octaves}static getDefaults(){return Jb(Im.getDefaults(),{envelope:Object.assign(qg(vf.getDefaults(),Object.keys(Ln.getDefaults())),{attack:.001,decay:1.4,release:.2}),harmonicity:5.1,modulationIndex:32,octaves:1.5,resonance:4e3})}_triggerEnvelopeAttack(e,n=1){return this.envelope.triggerAttack(e,n),this._oscillators.forEach(i=>i.start(e)),this.envelope.sustain===0&&this._oscillators.forEach(i=>{i.stop(e+this.toSeconds(this.envelope.attack)+this.toSeconds(this.envelope.decay))}),this}_triggerEnvelopeRelease(e){return this.envelope.triggerRelease(e),this._oscillators.forEach(n=>n.stop(e+this.toSeconds(this.envelope.release))),this}getLevelAtTime(e){return e=this.toSeconds(e),this.envelope.getValueAtTime(e)}get modulationIndex(){return this._oscillators[0].modulationIndex.value}set modulationIndex(e){this._oscillators.forEach(n=>n.modulationIndex.value=e)}get harmonicity(){return this._oscillators[0].harmonicity.value}set harmonicity(e){this._oscillators.forEach(n=>n.harmonicity.value=e)}get resonance(){return this._filterFreqScaler.min}set resonance(e){this._filterFreqScaler.min=this.toFrequency(e),this.octaves=this._octaves}get octaves(){return this._octaves}set octaves(e){this._octaves=e,this._filterFreqScaler.max=this._filterFreqScaler.min*Math.pow(2,e)}dispose(){return super.dispose(),this._oscillators.forEach(e=>e.dispose()),this._freqMultipliers.forEach(e=>e.dispose()),this.frequency.dispose(),this.detune.dispose(),this._filterFreqScaler.dispose(),this._amplitude.dispose(),this.envelope.dispose(),this._highpass.dispose(),this}}class AR extends $l{constructor(){const e=Mn(AR.getDefaults(),arguments);super(e),this.name="MembraneSynth",this.portamento=0,this.pitchDecay=e.pitchDecay,this.octaves=e.octaves,br(this,["oscillator","envelope"])}static getDefaults(){return Jb(Im.getDefaults(),$l.getDefaults(),{envelope:{attack:.001,attackCurve:"exponential",decay:.4,release:1.4,sustain:.01},octaves:10,oscillator:{type:"sine"},pitchDecay:.05})}setNote(e,n){const i=this.toSeconds(n),r=this.toFrequency(e instanceof cd?e.toFrequency():e),s=r*this.octaves;return this.oscillator.frequency.setValueAtTime(s,i),this.oscillator.frequency.exponentialRampToValueAtTime(r,i+this.toSeconds(this.pitchDecay)),this}dispose(){return super.dispose(),this}}pa([eSe(0)],AR.prototype,"octaves",void 0);pa([J_(0)],AR.prototype,"pitchDecay",void 0);class sC extends m0{constructor(){const e=Mn(sC.getDefaults(),arguments);super(e),this.name="NoiseSynth",this.noise=new O1(Object.assign({context:this.context},e.noise)),this.envelope=new j8(Object.assign({context:this.context},e.envelope)),this.noise.chain(this.envelope,this.output)}static getDefaults(){return Object.assign(m0.getDefaults(),{envelope:Object.assign(qg(vf.getDefaults(),Object.keys(Ln.getDefaults())),{decay:.1,sustain:0}),noise:Object.assign(qg(O1.getDefaults(),Object.keys(Nl.getDefaults())),{type:"white"})})}triggerAttack(e,n=1){return e=this.toSeconds(e),this.envelope.triggerAttack(e,n),this.noise.start(e),this.envelope.sustain===0&&this.noise.stop(e+this.toSeconds(this.envelope.attack)+this.toSeconds(this.envelope.decay)),this}triggerRelease(e){return e=this.toSeconds(e),this.envelope.triggerRelease(e),this.noise.stop(e+this.toSeconds(this.envelope.release)),this}sync(){return this._syncState()&&(this._syncMethod("triggerAttack",0),this._syncMethod("triggerRelease",0)),this}triggerAttackRelease(e,n,i=1){return n=this.toSeconds(n),e=this.toSeconds(e),this.triggerAttack(n,i),this.triggerRelease(n+e),this}dispose(){return super.dispose(),this.noise.dispose(),this.envelope.dispose(),this}}const tSe=new Set;function GX(t){tSe.add(t)}function nSe(t,e){const n=`registerProcessor("${t}", ${e})`;tSe.add(n)}const aSt=`
	/**
	 * The base AudioWorkletProcessor for use in Tone.js. Works with the {@link ToneAudioWorklet}. 
	 */
	class ToneAudioWorkletProcessor extends AudioWorkletProcessor {

		constructor(options) {
			
			super(options);
			/**
			 * If the processor was disposed or not. Keep alive until it's disposed.
			 */
			this.disposed = false;
		   	/** 
			 * The number of samples in the processing block
			 */
			this.blockSize = 128;
			/**
			 * the sample rate
			 */
			this.sampleRate = sampleRate;

			this.port.onmessage = (event) => {
				// when it receives a dispose 
				if (event.data === "dispose") {
					this.disposed = true;
				}
			};
		}
	}
`;GX(aSt);const oSt=`
	/**
	 * Abstract class for a single input/output processor. 
	 * has a 'generate' function which processes one sample at a time
	 */
	class SingleIOProcessor extends ToneAudioWorkletProcessor {

		constructor(options) {
			super(Object.assign(options, {
				numberOfInputs: 1,
				numberOfOutputs: 1
			}));
			/**
			 * Holds the name of the parameter and a single value of that
			 * parameter at the current sample
			 * @type { [name: string]: number }
			 */
			this.params = {}
		}

		/**
		 * Generate an output sample from the input sample and parameters
		 * @abstract
		 * @param input number
		 * @param channel number
		 * @param parameters { [name: string]: number }
		 * @returns number
		 */
		generate(){}

		/**
		 * Update the private params object with the 
		 * values of the parameters at the given index
		 * @param parameters { [name: string]: Float32Array },
		 * @param index number
		 */
		updateParams(parameters, index) {
			for (const paramName in parameters) {
				const param = parameters[paramName];
				if (param.length > 1) {
					this.params[paramName] = parameters[paramName][index];
				} else {
					this.params[paramName] = parameters[paramName][0];
				}
			}
		}

		/**
		 * Process a single frame of the audio
		 * @param inputs Float32Array[][]
		 * @param outputs Float32Array[][]
		 */
		process(inputs, outputs, parameters) {
			const input = inputs[0];
			const output = outputs[0];
			// get the parameter values
			const channelCount = Math.max(input && input.length || 0, output.length);
			for (let sample = 0; sample < this.blockSize; sample++) {
				this.updateParams(parameters, sample);
				for (let channel = 0; channel < channelCount; channel++) {
					const inputSample = input && input.length ? input[channel][sample] : 0;
					output[channel][sample] = this.generate(inputSample, channel, this.params);
				}
			}
			return !this.disposed;
		}
	};
`;GX(oSt);const cSt=`
	/**
	 * A multichannel buffer for use within an AudioWorkletProcessor as a delay line
	 */
	class DelayLine {
		
		constructor(size, channels) {
			this.buffer = [];
			this.writeHead = []
			this.size = size;

			// create the empty channels
			for (let i = 0; i < channels; i++) {
				this.buffer[i] = new Float32Array(this.size);
				this.writeHead[i] = 0;
			}
		}

		/**
		 * Push a value onto the end
		 * @param channel number
		 * @param value number
		 */
		push(channel, value) {
			this.writeHead[channel] += 1;
			if (this.writeHead[channel] > this.size) {
				this.writeHead[channel] = 0;
			}
			this.buffer[channel][this.writeHead[channel]] = value;
		}

		/**
		 * Get the recorded value of the channel given the delay
		 * @param channel number
		 * @param delay number delay samples
		 */
		get(channel, delay) {
			let readHead = this.writeHead[channel] - Math.floor(delay);
			if (readHead < 0) {
				readHead += this.size;
			}
			return this.buffer[channel][readHead];
		}
	}
`;GX(cSt);const lSt="feedback-comb-filter",uSt=`
	class FeedbackCombFilterWorklet extends SingleIOProcessor {

		constructor(options) {
			super(options);
			this.delayLine = new DelayLine(this.sampleRate, options.channelCount || 2);
		}

		static get parameterDescriptors() {
			return [{
				name: "delayTime",
				defaultValue: 0.1,
				minValue: 0,
				maxValue: 1,
				automationRate: "k-rate"
			}, {
				name: "feedback",
				defaultValue: 0.5,
				minValue: 0,
				maxValue: 0.9999,
				automationRate: "k-rate"
			}];
		}

		generate(input, channel, parameters) {
			const delayedSample = this.delayLine.get(channel, parameters.delayTime * this.sampleRate);
			this.delayLine.push(channel, input + delayedSample * parameters.feedback);
			return delayedSample;
		}
	}
`;nSe(lSt,uSt);class qX extends Ln{constructor(){const e=Mn(qX.getDefaults(),arguments,["frequency","type"]);super(e),this.name="OnePoleFilter",this._frequency=e.frequency,this._type=e.type,this.input=new Xi({context:this.context}),this.output=new Xi({context:this.context}),this._createFilter()}static getDefaults(){return Object.assign(Ln.getDefaults(),{frequency:880,type:"lowpass"})}_createFilter(){const e=this._filter,n=this.toFrequency(this._frequency),i=1/(2*Math.PI*n);if(this._type==="lowpass"){const r=1/(i*this.context.sampleRate),s=r-1;this._filter=this.context.createIIRFilter([r,0],[1,s])}else{const r=1/(i*this.context.sampleRate)-1;this._filter=this.context.createIIRFilter([1,-1],[1,r])}this.input.chain(this._filter,this.output),e&&this.context.setTimeout(()=>{this.disposed||(this.input.disconnect(e),e.disconnect())},this.blockTime)}get frequency(){return this._frequency}set frequency(e){this._frequency=e,this._createFilter()}get type(){return this._type}set type(e){this._type=e,this._createFilter()}getFrequencyResponse(e=128){const n=new Float32Array(e);for(let s=0;s<e;s++){const o=Math.pow(s/e,2)*19980+20;n[s]=o}const i=new Float32Array(e),r=new Float32Array(e);return this._filter.getFrequencyResponse(n,i,r),i}dispose(){return super.dispose(),this.input.dispose(),this.output.dispose(),this._filter.disconnect(),this}}class AB extends m0{constructor(){const e=Mn(AB.getDefaults(),arguments,["voice","options"]);super(e),this.name="PolySynth",this._availableVoices=[],this._activeVoices=[],this._voices=[],this._gcTimeout=-1,this._averageActiveVoices=0,this._syncedRelease=r=>this.releaseAll(r),Ri(!Om(e.voice),"DEPRECATED: The polyphony count is no longer the first argument.");const n=e.voice.getDefaults();this.options=Object.assign(n,e.options),this.voice=e.voice,this.maxPolyphony=e.maxPolyphony,this._dummyVoice=this._getNextAvailableVoice();const i=this._voices.indexOf(this._dummyVoice);this._voices.splice(i,1),this._gcTimeout=this.context.setInterval(this._collectGarbage.bind(this),1)}static getDefaults(){return Object.assign(m0.getDefaults(),{maxPolyphony:32,options:{},voice:$l})}get activeVoices(){return this._activeVoices.length}_makeVoiceAvailable(e){this._availableVoices.push(e);const n=this._activeVoices.findIndex(i=>i.voice===e);this._activeVoices.splice(n,1)}_getNextAvailableVoice(){if(this._availableVoices.length)return this._availableVoices.shift();if(this._voices.length<this.maxPolyphony){const e=new this.voice(Object.assign(this.options,{context:this.context,onsilence:this._makeVoiceAvailable.bind(this)}));return Ri(e instanceof Im,"Voice must extend Monophonic class"),e.connect(this.output),this._voices.push(e),e}else R8("Max polyphony exceeded. Note dropped.")}_collectGarbage(){if(this._averageActiveVoices=Math.max(this._averageActiveVoices*.95,this.activeVoices),this._availableVoices.length&&this._voices.length>Math.ceil(this._averageActiveVoices+1)){const e=this._availableVoices.shift(),n=this._voices.indexOf(e);this._voices.splice(n,1),this.context.isOffline||e.dispose()}}_triggerAttack(e,n,i){e.forEach(r=>{const s=new wB(this.context,r).toMidi(),a=this._getNextAvailableVoice();a&&(a.triggerAttack(r,n,i),this._activeVoices.push({midi:s,voice:a,released:!1}),this.log("triggerAttack",r,n))})}_triggerRelease(e,n){e.forEach(i=>{const r=new wB(this.context,i).toMidi(),s=this._activeVoices.find(({midi:a,released:o})=>a===r&&!o);s&&(s.voice.triggerRelease(n),s.released=!0,this.log("triggerRelease",i,n))})}_scheduleEvent(e,n,i,r){Ri(!this.disposed,"Synth was already disposed"),i<=this.now()?e==="attack"?this._triggerAttack(n,i,r):this._triggerRelease(n,i):this.context.setTimeout(()=>{this.disposed||this._scheduleEvent(e,n,i,r)},i-this.now())}triggerAttack(e,n,i){Array.isArray(e)||(e=[e]);const r=this.toSeconds(n);return this._scheduleEvent("attack",e,r,i),this}triggerRelease(e,n){Array.isArray(e)||(e=[e]);const i=this.toSeconds(n);return this._scheduleEvent("release",e,i),this}triggerAttackRelease(e,n,i,r){const s=this.toSeconds(i);if(this.triggerAttack(e,s,r),hd(n)){Ri(hd(e),"If the duration is an array, the notes must also be an array"),e=e;for(let a=0;a<e.length;a++){const o=n[Math.min(a,n.length-1)],c=this.toSeconds(o);Ri(c>0,"The duration must be greater than 0"),this.triggerRelease(e[a],s+c)}}else{const a=this.toSeconds(n);Ri(a>0,"The duration must be greater than 0"),this.triggerRelease(e,s+a)}return this}sync(){return this._syncState()&&(this._syncMethod("triggerAttack",1),this._syncMethod("triggerRelease",1),this.context.transport.on("stop",this._syncedRelease),this.context.transport.on("pause",this._syncedRelease),this.context.transport.on("loopEnd",this._syncedRelease)),this}set(e){const n=qg(e,["onsilence","context"]);return this.options=Jb(this.options,n),this._voices.forEach(i=>i.set(n)),this._dummyVoice.set(n),this}get(){return this._dummyVoice.get()}releaseAll(e){const n=this.toSeconds(e);return this._activeVoices.forEach(({voice:i})=>{i.triggerRelease(n)}),this}dispose(){return super.dispose(),this._dummyVoice.dispose(),this._voices.forEach(e=>e.dispose()),this._activeVoices=[],this._availableVoices=[],this.context.clearInterval(this._gcTimeout),this}}class cP extends m0{constructor(){const e=Mn(cP.getDefaults(),arguments,["urls","onload","baseUrl"],"urls");super(e),this.name="Sampler",this._activeSources=new Map;const n={};Object.keys(e.urls).forEach(i=>{const r=parseInt(i,10);if(Ri(b2(i)||Om(r)&&isFinite(r),`url key is neither a note or midi pitch: ${i}`),b2(i)){const s=new cd(this.context,i).toMidi();n[s]=e.urls[i]}else Om(r)&&isFinite(r)&&(n[r]=e.urls[r])}),this._buffers=new DX({urls:n,onload:e.onload,baseUrl:e.baseUrl,onerror:e.onerror}),this.attack=e.attack,this.release=e.release,this.curve=e.curve,this._buffers.loaded&&Promise.resolve().then(e.onload)}static getDefaults(){return Object.assign(m0.getDefaults(),{attack:0,baseUrl:"",curve:"exponential",onload:Ss,onerror:Ss,release:.1,urls:{}})}_findClosest(e){let i=0;for(;i<96;){if(this._buffers.has(e+i))return-i;if(this._buffers.has(e-i))return i;i++}throw new Error(`No available buffers for note: ${e}`)}triggerAttack(e,n,i=1){return this.log("triggerAttack",e,n,i),Array.isArray(e)||(e=[e]),e.forEach(r=>{const s=ZEe(new cd(this.context,r).toFrequency()),a=Math.round(s),o=s-a,c=this._findClosest(a),l=a-c,u=this._buffers.get(l),h=XEe(c+o),d=new rP({url:u,context:this.context,curve:this.curve,fadeIn:this.attack,fadeOut:this.release,playbackRate:h}).connect(this.output);d.start(n,0,u.duration/h,i),hd(this._activeSources.get(a))||this._activeSources.set(a,[]),this._activeSources.get(a).push(d),d.onended=()=>{if(this._activeSources&&this._activeSources.has(a)){const f=this._activeSources.get(a),p=f.indexOf(d);p!==-1&&f.splice(p,1)}}}),this}triggerRelease(e,n){return this.log("triggerRelease",e,n),Array.isArray(e)||(e=[e]),e.forEach(i=>{const r=new cd(this.context,i).toMidi();if(this._activeSources.has(r)&&this._activeSources.get(r).length){const s=this._activeSources.get(r);n=this.toSeconds(n),s.forEach(a=>{a.stop(n)}),this._activeSources.set(r,[])}}),this}releaseAll(e){const n=this.toSeconds(e);return this._activeSources.forEach(i=>{for(;i.length;)i.shift().stop(n)}),this}sync(){return this._syncState()&&(this._syncMethod("triggerAttack",1),this._syncMethod("triggerRelease",1)),this}triggerAttackRelease(e,n,i,r=1){const s=this.toSeconds(i);return this.triggerAttack(e,s,r),hd(n)?(Ri(hd(e),"notes must be an array when duration is array"),e.forEach((a,o)=>{const c=n[Math.min(o,n.length-1)];this.triggerRelease(a,s+this.toSeconds(c))})):this.triggerRelease(e,s+this.toSeconds(n)),this}add(e,n,i){if(Ri(b2(e)||isFinite(e),`note must be a pitch or midi: ${e}`),b2(e)){const r=new cd(this.context,e).toMidi();this._buffers.add(r,n,i)}else this._buffers.add(e,n,i);return this}get loaded(){return this._buffers.loaded}dispose(){return super.dispose(),this._buffers.dispose(),this._activeSources.forEach(e=>{e.forEach(n=>n.dispose())}),this._activeSources.clear(),this}}pa([J_(0)],cP.prototype,"attack",void 0);pa([J_(0)],cP.prototype,"release",void 0);class aC extends wu{constructor(){const e=Mn(aC.getDefaults(),arguments,["callback","value"]);super(e),this.name="ToneEvent",this._state=new iP("stopped"),this._startOffset=0,this._loop=e.loop,this.callback=e.callback,this.value=e.value,this._loopStart=this.toTicks(e.loopStart),this._loopEnd=this.toTicks(e.loopEnd),this._playbackRate=e.playbackRate,this._probability=e.probability,this._humanize=e.humanize,this.mute=e.mute,this._playbackRate=e.playbackRate,this._state.increasing=!0,this._rescheduleEvents()}static getDefaults(){return Object.assign(wu.getDefaults(),{callback:Ss,humanize:!1,loop:!1,loopEnd:"1m",loopStart:0,mute:!1,playbackRate:1,probability:1,value:null})}_rescheduleEvents(e=-1){this._state.forEachFrom(e,n=>{let i;if(n.state==="started"){n.id!==-1&&this.context.transport.clear(n.id);const r=n.time+Math.round(this.startOffset/this._playbackRate);if(this._loop===!0||Om(this._loop)&&this._loop>1){i=1/0,Om(this._loop)&&(i=this._loop*this._getLoopDuration());const s=this._state.getAfter(r);s!==null&&(i=Math.min(i,s.time-r)),i!==1/0&&(i=new jc(this.context,i));const a=new jc(this.context,this._getLoopDuration());n.id=this.context.transport.scheduleRepeat(this._tick.bind(this),a,new jc(this.context,r),i)}else n.id=this.context.transport.schedule(this._tick.bind(this),new jc(this.context,r))}})}get state(){return this._state.getValueAtTime(this.context.transport.ticks)}get startOffset(){return this._startOffset}set startOffset(e){this._startOffset=e}get probability(){return this._probability}set probability(e){this._probability=e}get humanize(){return this._humanize}set humanize(e){this._humanize=e}start(e){const n=this.toTicks(e);return this._state.getValueAtTime(n)==="stopped"&&(this._state.add({id:-1,state:"started",time:n}),this._rescheduleEvents(n)),this}stop(e){this.cancel(e);const n=this.toTicks(e);if(this._state.getValueAtTime(n)==="started"){this._state.setStateAtTime("stopped",n,{id:-1});const i=this._state.getBefore(n);let r=n;i!==null&&(r=i.time),this._rescheduleEvents(r)}return this}cancel(e){e=n0(e,-1/0);const n=this.toTicks(e);return this._state.forEachFrom(n,i=>{this.context.transport.clear(i.id)}),this._state.cancel(n),this}_tick(e){const n=this.context.transport.getTicksAtTime(e);if(!this.mute&&this._state.getValueAtTime(n)==="started"){if(this.probability<1&&Math.random()>this.probability)return;if(this.humanize){let i=.02;BEe(this.humanize)||(i=this.toSeconds(this.humanize)),e+=(Math.random()*2-1)*i}this.callback(e,this.value)}}_getLoopDuration(){return(this._loopEnd-this._loopStart)/this._playbackRate}get loop(){return this._loop}set loop(e){this._loop=e,this._rescheduleEvents()}get playbackRate(){return this._playbackRate}set playbackRate(e){this._playbackRate=e,this._rescheduleEvents()}get loopEnd(){return new jc(this.context,this._loopEnd).toSeconds()}set loopEnd(e){this._loopEnd=this.toTicks(e),this._loop&&this._rescheduleEvents()}get loopStart(){return new jc(this.context,this._loopStart).toSeconds()}set loopStart(e){this._loopStart=this.toTicks(e),this._loop&&this._rescheduleEvents()}get progress(){if(this._loop){const e=this.context.transport.ticks,n=this._state.get(e);if(n!==null&&n.state==="started"){const i=this._getLoopDuration();return(e-n.time)%i/i}else return 0}else return 0}dispose(){return super.dispose(),this.cancel(),this._state.dispose(),this}}class RB extends aC{constructor(){const e=Mn(RB.getDefaults(),arguments,["callback","events"]);super(e),this.name="Part",this._state=new iP("stopped"),this._events=new Set,this._state.increasing=!0,e.events.forEach(n=>{hd(n)?this.add(n[0],n[1]):this.add(n)})}static getDefaults(){return Object.assign(aC.getDefaults(),{events:[]})}start(e,n){const i=this.toTicks(e);if(this._state.getValueAtTime(i)!=="started"){n=n0(n,this._loop?this._loopStart:0),this._loop?n=n0(n,this._loopStart):n=n0(n,0);const r=this.toTicks(n);this._state.add({id:-1,offset:r,state:"started",time:i}),this._forEach(s=>{this._startNote(s,i,r)})}return this}_startNote(e,n,i){n-=i,this._loop?e.startOffset>=this._loopStart&&e.startOffset<this._loopEnd?(e.startOffset<i&&(n+=this._getLoopDuration()),e.start(new jc(this.context,n))):e.startOffset<this._loopStart&&e.startOffset>=i&&(e.loop=!1,e.start(new jc(this.context,n))):e.startOffset>=i&&e.start(new jc(this.context,n))}get startOffset(){return this._startOffset}set startOffset(e){this._startOffset=e,this._forEach(n=>{n.startOffset+=this._startOffset})}stop(e){const n=this.toTicks(e);return this._state.cancel(n),this._state.setStateAtTime("stopped",n),this._forEach(i=>{i.stop(e)}),this}at(e,n){const i=new MC(this.context,e).toTicks(),r=new jc(this.context,1).toSeconds(),s=this._events.values();let a=s.next();for(;!a.done;){const o=a.value;if(Math.abs(i-o.startOffset)<r)return _r(n)&&(o.value=n),o;a=s.next()}return _r(n)?(this.add(e,n),this.at(e)):null}add(e,n){e instanceof Object&&Reflect.has(e,"time")&&(n=e,e=n.time);const i=this.toTicks(e);let r;return n instanceof aC?(r=n,r.callback=this._tick.bind(this)):r=new aC({callback:this._tick.bind(this),context:this.context,value:n}),r.startOffset=i,r.set({humanize:this.humanize,loop:this.loop,loopEnd:this.loopEnd,loopStart:this.loopStart,playbackRate:this.playbackRate,probability:this.probability}),this._events.add(r),this._restartEvent(r),this}_restartEvent(e){this._state.forEach(n=>{n.state==="started"?this._startNote(e,n.time,n.offset):e.stop(new jc(this.context,n.time))})}remove(e,n){return Xb(e)&&e.hasOwnProperty("time")&&(n=e,e=n.time),e=this.toTicks(e),this._events.forEach(i=>{i.startOffset===e&&(mf(n)||_r(n)&&i.value===n)&&(this._events.delete(i),i.dispose())}),this}clear(){return this._forEach(e=>e.dispose()),this._events.clear(),this}cancel(e){return this._forEach(n=>n.cancel(e)),this._state.cancel(this.toTicks(e)),this}_forEach(e){return this._events&&this._events.forEach(n=>{n instanceof RB?n._forEach(e):e(n)}),this}_setAll(e,n){this._forEach(i=>{i[e]=n})}_tick(e,n){this.mute||this.callback(e,n)}_testLoopBoundries(e){this._loop&&(e.startOffset<this._loopStart||e.startOffset>=this._loopEnd)?e.cancel(0):e.state==="stopped"&&this._restartEvent(e)}get probability(){return this._probability}set probability(e){this._probability=e,this._setAll("probability",e)}get humanize(){return this._humanize}set humanize(e){this._humanize=e,this._setAll("humanize",e)}get loop(){return this._loop}set loop(e){this._loop=e,this._forEach(n=>{n.loopStart=this.loopStart,n.loopEnd=this.loopEnd,n.loop=e,this._testLoopBoundries(n)})}get loopEnd(){return new jc(this.context,this._loopEnd).toSeconds()}set loopEnd(e){this._loopEnd=this.toTicks(e),this._loop&&this._forEach(n=>{n.loopEnd=e,this._testLoopBoundries(n)})}get loopStart(){return new jc(this.context,this._loopStart).toSeconds()}set loopStart(e){this._loopStart=this.toTicks(e),this._loop&&this._forEach(n=>{n.loopStart=this.loopStart,this._testLoopBoundries(n)})}get playbackRate(){return this._playbackRate}set playbackRate(e){this._playbackRate=e,this._setAll("playbackRate",e)}get length(){return this._events.size}dispose(){return super.dispose(),this.clear(),this}}class H8 extends Ln{constructor(){const e=Mn(H8.getDefaults(),arguments,["fade"]);super(e),this.name="CrossFade",this._panner=this.context.createStereoPanner(),this._split=this.context.createChannelSplitter(2),this._g2a=new sSt({context:this.context}),this.a=new Xi({context:this.context,gain:0}),this.b=new Xi({context:this.context,gain:0}),this.output=new Xi({context:this.context}),this._internalChannels=[this.a,this.b],this.fade=new Ir({context:this.context,units:"normalRange",value:e.fade}),br(this,"fade"),this.context.getConstant(1).connect(this._panner),this._panner.connect(this._split),this._panner.channelCount=1,this._panner.channelCountMode="explicit",Rp(this._split,this.a.gain,0),Rp(this._split,this.b.gain,1),this.fade.chain(this._g2a,this._panner.pan),this.a.connect(this.output),this.b.connect(this.output)}static getDefaults(){return Object.assign(Ln.getDefaults(),{fade:.5})}dispose(){return super.dispose(),this.a.dispose(),this.b.dispose(),this.output.dispose(),this.fade.dispose(),this._g2a.dispose(),this._panner.disconnect(),this._split.disconnect(),this}}let Mp=class extends Ln{constructor(e){super(e),this.name="Effect",this._dryWet=new H8({context:this.context}),this.wet=this._dryWet.fade,this.effectSend=new Xi({context:this.context}),this.effectReturn=new Xi({context:this.context}),this.input=new Xi({context:this.context}),this.output=this._dryWet,this.input.fan(this._dryWet.a,this.effectSend),this.effectReturn.connect(this._dryWet.b),this.wet.setValueAtTime(e.wet,0),this._internalChannels=[this.effectReturn,this.effectSend],br(this,"wet")}static getDefaults(){return Object.assign(Ln.getDefaults(),{wet:1})}connectEffect(e){return this._internalChannels.push(e),this.effectSend.chain(e,this.effectReturn),this}dispose(){return super.dispose(),this._dryWet.dispose(),this.effectSend.dispose(),this.effectReturn.dispose(),this.wet.dispose(),this}};class $X extends Ln{constructor(){const e=Mn($X.getDefaults(),arguments,["pan"]);super(e),this.name="Panner",this._panner=this.context.createStereoPanner(),this.input=this._panner,this.output=this._panner,this.pan=new gr({context:this.context,param:this._panner.pan,value:e.pan,minValue:-1,maxValue:1}),this._panner.channelCount=e.channelCount,this._panner.channelCountMode="explicit",br(this,"pan")}static getDefaults(){return Object.assign(Ln.getDefaults(),{pan:0,channelCount:1})}dispose(){return super.dispose(),this._panner.disconnect(),this.pan.dispose(),this}}class WX extends Ln{constructor(){const e=Mn(WX.getDefaults(),arguments,["smoothing"]);super(e),this.name="Follower",this._abs=this.input=new rSt({context:this.context}),this._lowpass=this.output=new qX({context:this.context,frequency:1/this.toSeconds(e.smoothing),type:"lowpass"}),this._abs.connect(this._lowpass),this._smoothing=e.smoothing}static getDefaults(){return Object.assign(Ln.getDefaults(),{smoothing:.05})}get smoothing(){return this._smoothing}set smoothing(e){this._smoothing=e,this._lowpass.frequency=1/this.toSeconds(this.smoothing)}dispose(){return super.dispose(),this._abs.dispose(),this._lowpass.dispose(),this}}class YX extends Mp{constructor(){const e=Mn(YX.getDefaults(),arguments,["baseFrequency","octaves","sensitivity"]);super(e),this.name="AutoWah",this._follower=new WX({context:this.context,smoothing:e.follower}),this._sweepRange=new jX({context:this.context,min:0,max:1,exponent:.5}),this._baseFrequency=this.toFrequency(e.baseFrequency),this._octaves=e.octaves,this._inputBoost=new Xi({context:this.context}),this._bandpass=new ah({context:this.context,rolloff:-48,frequency:0,Q:e.Q}),this._peaking=new ah({context:this.context,type:"peaking"}),this._peaking.gain.value=e.gain,this.gain=this._peaking.gain,this.Q=this._bandpass.Q,this.effectSend.chain(this._inputBoost,this._follower,this._sweepRange),this._sweepRange.connect(this._bandpass.frequency),this._sweepRange.connect(this._peaking.frequency),this.effectSend.chain(this._bandpass,this._peaking,this.effectReturn),this._setSweepRange(),this.sensitivity=e.sensitivity,br(this,["gain","Q"])}static getDefaults(){return Object.assign(Mp.getDefaults(),{baseFrequency:100,octaves:6,sensitivity:0,Q:2,gain:2,follower:.2})}get octaves(){return this._octaves}set octaves(e){this._octaves=e,this._setSweepRange()}get follower(){return this._follower.smoothing}set follower(e){this._follower.smoothing=e}get baseFrequency(){return this._baseFrequency}set baseFrequency(e){this._baseFrequency=this.toFrequency(e),this._setSweepRange()}get sensitivity(){return KEe(1/this._inputBoost.gain.value)}set sensitivity(e){this._inputBoost.gain.value=1/YEe(e)}_setSweepRange(){this._sweepRange.min=this._baseFrequency,this._sweepRange.max=Math.min(this._baseFrequency*Math.pow(2,this._octaves),this.context.sampleRate/2)}dispose(){return super.dispose(),this._follower.dispose(),this._sweepRange.dispose(),this._bandpass.dispose(),this._peaking.dispose(),this._inputBoost.dispose(),this}}const hSt="bit-crusher",dSt=`
	class BitCrusherWorklet extends SingleIOProcessor {

		static get parameterDescriptors() {
			return [{
				name: "bits",
				defaultValue: 12,
				minValue: 1,
				maxValue: 16,
				automationRate: 'k-rate'
			}];
		}

		generate(input, _channel, parameters) {
			const step = Math.pow(0.5, parameters.bits - 1);
			const val = step * Math.floor(input / step + 0.5);
			return val;
		}
	}
`;nSe(hSt,dSt);class V8 extends Ln{constructor(){const e=Mn(V8.getDefaults(),arguments,["channels"]);super(e),this.name="Split",this._splitter=this.input=this.output=this.context.createChannelSplitter(e.channels),this._internalChannels=[this._splitter]}static getDefaults(){return Object.assign(Ln.getDefaults(),{channels:2})}dispose(){return super.dispose(),this._splitter.disconnect(),this}}class lP extends Ln{constructor(){const e=Mn(lP.getDefaults(),arguments,["channels"]);super(e),this.name="Merge",this._merger=this.output=this.input=this.context.createChannelMerger(e.channels)}static getDefaults(){return Object.assign(Ln.getDefaults(),{channels:2})}dispose(){return super.dispose(),this._merger.disconnect(),this}}class MB extends Ln{constructor(e){super(e),this.name="StereoEffect",this.input=new Xi({context:this.context}),this.input.channelCount=2,this.input.channelCountMode="explicit",this._dryWet=this.output=new H8({context:this.context,fade:e.wet}),this.wet=this._dryWet.fade,this._split=new V8({context:this.context,channels:2}),this._merge=new lP({context:this.context,channels:2}),this.input.connect(this._split),this.input.connect(this._dryWet.a),this._merge.connect(this._dryWet.b),br(this,["wet"])}connectEffectLeft(...e){this._split.connect(e[0],0,0),M1(...e),Rp(e[e.length-1],this._merge,0,0)}connectEffectRight(...e){this._split.connect(e[0],1,0),M1(...e),Rp(e[e.length-1],this._merge,0,1)}static getDefaults(){return Object.assign(Ln.getDefaults(),{wet:1})}dispose(){return super.dispose(),this._dryWet.dispose(),this._split.dispose(),this._merge.dispose(),this}}class hae extends MB{constructor(e){super(e),this.feedback=new Ir({context:this.context,value:e.feedback,units:"normalRange"}),this._feedbackL=new Xi({context:this.context}),this._feedbackR=new Xi({context:this.context}),this._feedbackSplit=new V8({context:this.context,channels:2}),this._feedbackMerge=new lP({context:this.context,channels:2}),this._merge.connect(this._feedbackSplit),this._feedbackMerge.connect(this._split),this._feedbackSplit.connect(this._feedbackL,0,0),this._feedbackL.connect(this._feedbackMerge,0,0),this._feedbackSplit.connect(this._feedbackR,1,0),this._feedbackR.connect(this._feedbackMerge,0,1),this.feedback.fan(this._feedbackL.gain,this._feedbackR.gain),br(this,["feedback"])}static getDefaults(){return Object.assign(MB.getDefaults(),{feedback:.5})}dispose(){return super.dispose(),this.feedback.dispose(),this._feedbackL.dispose(),this._feedbackR.dispose(),this._feedbackSplit.dispose(),this._feedbackMerge.dispose(),this}}class KX extends hae{constructor(){const e=Mn(KX.getDefaults(),arguments,["frequency","delayTime","depth"]);super(e),this.name="Chorus",this._depth=e.depth,this._delayTime=e.delayTime/1e3,this._lfoL=new N1({context:this.context,frequency:e.frequency,min:0,max:1}),this._lfoR=new N1({context:this.context,frequency:e.frequency,min:0,max:1,phase:180}),this._delayNodeL=new BA({context:this.context}),this._delayNodeR=new BA({context:this.context}),this.frequency=this._lfoL.frequency,br(this,["frequency"]),this._lfoL.frequency.connect(this._lfoR.frequency),this.connectEffectLeft(this._delayNodeL),this.connectEffectRight(this._delayNodeR),this._lfoL.connect(this._delayNodeL.delayTime),this._lfoR.connect(this._delayNodeR.delayTime),this.depth=this._depth,this.type=e.type,this.spread=e.spread}static getDefaults(){return Object.assign(hae.getDefaults(),{frequency:1.5,delayTime:3.5,depth:.7,type:"sine",spread:180,feedback:0,wet:.5})}get depth(){return this._depth}set depth(e){this._depth=e;const n=this._delayTime*e;this._lfoL.min=Math.max(this._delayTime-n,0),this._lfoL.max=this._delayTime+n,this._lfoR.min=Math.max(this._delayTime-n,0),this._lfoR.max=this._delayTime+n}get delayTime(){return this._delayTime*1e3}set delayTime(e){this._delayTime=e/1e3,this.depth=this._depth}get type(){return this._lfoL.type}set type(e){this._lfoL.type=e,this._lfoR.type=e}get spread(){return this._lfoR.phase-this._lfoL.phase}set spread(e){this._lfoL.phase=90-e/2,this._lfoR.phase=e/2+90}start(e){return this._lfoL.start(e),this._lfoR.start(e),this}stop(e){return this._lfoL.stop(e),this._lfoR.stop(e),this}sync(){return this._lfoL.sync(),this._lfoR.sync(),this}unsync(){return this._lfoL.unsync(),this._lfoR.unsync(),this}dispose(){return super.dispose(),this._lfoL.dispose(),this._lfoR.dispose(),this._delayNodeL.dispose(),this._delayNodeR.dispose(),this.frequency.dispose(),this}}class mI extends Mp{constructor(){const e=Mn(mI.getDefaults(),arguments,["distortion"]);super(e),this.name="Distortion",this._shaper=new GE({context:this.context,length:4096}),this._distortion=e.distortion,this.connectEffect(this._shaper),this.distortion=e.distortion,this.oversample=e.oversample}static getDefaults(){return Object.assign(Mp.getDefaults(),{distortion:.4,oversample:"none"})}get distortion(){return this._distortion}set distortion(e){this._distortion=e;const n=e*100,i=Math.PI/180;this._shaper.setMap(r=>Math.abs(r)<.001?0:(3+n)*r*20*i/(Math.PI+n*Math.abs(r)))}get oversample(){return this._shaper.oversample}set oversample(e){this._shaper.oversample=e}dispose(){return super.dispose(),this._shaper.dispose(),this}}class dae extends Mp{constructor(e){super(e),this.name="FeedbackEffect",this._feedbackGain=new Xi({context:this.context,gain:e.feedback,units:"normalRange"}),this.feedback=this._feedbackGain.gain,br(this,"feedback"),this.effectReturn.chain(this._feedbackGain,this.effectSend)}static getDefaults(){return Object.assign(Mp.getDefaults(),{feedback:.125})}dispose(){return super.dispose(),this._feedbackGain.dispose(),this.feedback.dispose(),this}}class G8 extends dae{constructor(){const e=Mn(G8.getDefaults(),arguments,["delayTime","feedback"]);super(e),this.name="FeedbackDelay",this._delayNode=new BA({context:this.context,delayTime:e.delayTime,maxDelay:e.maxDelay}),this.delayTime=this._delayNode.delayTime,this.connectEffect(this._delayNode),br(this,"delayTime")}static getDefaults(){return Object.assign(dae.getDefaults(),{delayTime:.25,maxDelay:1})}dispose(){return super.dispose(),this._delayNode.dispose(),this.delayTime.dispose(),this}}class XX extends MB{constructor(){const e=Mn(XX.getDefaults(),arguments,["frequency","octaves","baseFrequency"]);super(e),this.name="Phaser",this._lfoL=new N1({context:this.context,frequency:e.frequency,min:0,max:1}),this._lfoR=new N1({context:this.context,frequency:e.frequency,min:0,max:1,phase:180}),this._baseFrequency=this.toFrequency(e.baseFrequency),this._octaves=e.octaves,this.Q=new Ir({context:this.context,value:e.Q,units:"positive"}),this._filtersL=this._makeFilters(e.stages,this._lfoL),this._filtersR=this._makeFilters(e.stages,this._lfoR),this.frequency=this._lfoL.frequency,this.frequency.value=e.frequency,this.connectEffectLeft(...this._filtersL),this.connectEffectRight(...this._filtersR),this._lfoL.frequency.connect(this._lfoR.frequency),this.baseFrequency=e.baseFrequency,this.octaves=e.octaves,this._lfoL.start(),this._lfoR.start(),br(this,["frequency","Q"])}static getDefaults(){return Object.assign(MB.getDefaults(),{frequency:.5,octaves:3,stages:10,Q:10,baseFrequency:350})}_makeFilters(e,n){const i=[];for(let r=0;r<e;r++){const s=this.context.createBiquadFilter();s.type="allpass",this.Q.connect(s.Q),n.connect(s.frequency),i.push(s)}return i}get octaves(){return this._octaves}set octaves(e){this._octaves=e;const n=this._baseFrequency*Math.pow(2,e);this._lfoL.max=n,this._lfoR.max=n}get baseFrequency(){return this._baseFrequency}set baseFrequency(e){this._baseFrequency=this.toFrequency(e),this._lfoL.min=this._baseFrequency,this._lfoR.min=this._baseFrequency,this.octaves=this._octaves}dispose(){return super.dispose(),this.Q.dispose(),this._lfoL.dispose(),this._lfoR.dispose(),this._filtersL.forEach(e=>e.disconnect()),this._filtersR.forEach(e=>e.disconnect()),this.frequency.dispose(),this}}class ZX extends Mp{constructor(){const e=Mn(ZX.getDefaults(),arguments,["decay"]);super(e),this.name="Reverb",this._convolver=this.context.createConvolver(),this.ready=Promise.resolve();const n=this.toSeconds(e.decay);pp(n,.001),this._decay=n;const i=this.toSeconds(e.preDelay);pp(i,0),this._preDelay=i,this.generate(),this.connectEffect(this._convolver)}static getDefaults(){return Object.assign(Mp.getDefaults(),{decay:1.5,preDelay:.01})}get decay(){return this._decay}set decay(e){e=this.toSeconds(e),pp(e,.001),this._decay=e,this.generate()}get preDelay(){return this._preDelay}set preDelay(e){e=this.toSeconds(e),pp(e,0),this._preDelay=e,this.generate()}generate(){return oo(this,void 0,void 0,function*(){const e=this.ready,n=new I8(2,this._decay+this._preDelay,this.context.sampleRate),i=new O1({context:n}),r=new O1({context:n}),s=new lP({context:n});i.connect(s,0,0),r.connect(s,0,1);const a=new Xi({context:n}).toDestination();s.connect(a),i.start(0),r.start(0),a.gain.setValueAtTime(0,0),a.gain.setValueAtTime(1,this._preDelay),a.gain.exponentialApproachValueAtTime(0,this._preDelay,this.decay);const o=n.render();return this.ready=o.then(Ss),yield e,this._convolver.buffer=(yield o).get(),this})}dispose(){return super.dispose(),this._convolver.disconnect(),this}}class JX extends Mp{constructor(){const e=Mn(JX.getDefaults(),arguments,["frequency","depth"]);super(e),this.name="Vibrato",this._delayNode=new BA({context:this.context,delayTime:0,maxDelay:e.maxDelay}),this._lfo=new N1({context:this.context,type:e.type,min:0,max:e.maxDelay,frequency:e.frequency,phase:-90}).start().connect(this._delayNode.delayTime),this.frequency=this._lfo.frequency,this.depth=this._lfo.amplitude,this.depth.value=e.depth,br(this,["frequency","depth"]),this.effectSend.chain(this._delayNode,this.effectReturn)}static getDefaults(){return Object.assign(Mp.getDefaults(),{maxDelay:.005,frequency:5,depth:.1,type:"sine"})}get type(){return this._lfo.type}set type(e){this._lfo.type=e}dispose(){return super.dispose(),this._delayNode.dispose(),this._lfo.dispose(),this.frequency.dispose(),this.depth.dispose(),this}}class pc extends Ln{constructor(){const e=Mn(pc.getDefaults(),arguments,["solo"]);super(e),this.name="Solo",this.input=this.output=new Xi({context:this.context}),pc._allSolos.has(this.context)||pc._allSolos.set(this.context,new Set),pc._allSolos.get(this.context).add(this),this.solo=e.solo}static getDefaults(){return Object.assign(Ln.getDefaults(),{solo:!1})}get solo(){return this._isSoloed()}set solo(e){e?this._addSolo():this._removeSolo(),pc._allSolos.get(this.context).forEach(n=>n._updateSolo())}get muted(){return this.input.gain.value===0}_addSolo(){pc._soloed.has(this.context)||pc._soloed.set(this.context,new Set),pc._soloed.get(this.context).add(this)}_removeSolo(){pc._soloed.has(this.context)&&pc._soloed.get(this.context).delete(this)}_isSoloed(){return pc._soloed.has(this.context)&&pc._soloed.get(this.context).has(this)}_noSolos(){return!pc._soloed.has(this.context)||pc._soloed.has(this.context)&&pc._soloed.get(this.context).size===0}_updateSolo(){this._isSoloed()?this.input.gain.value=1:this._noSolos()?this.input.gain.value=1:this.input.gain.value=0}dispose(){return super.dispose(),pc._allSolos.get(this.context).delete(this),this._removeSolo(),this}}pc._allSolos=new Map;pc._soloed=new Map;class QX extends Ln{constructor(){const e=Mn(QX.getDefaults(),arguments,["pan","volume"]);super(e),this.name="PanVol",this._panner=this.input=new $X({context:this.context,pan:e.pan,channelCount:e.channelCount}),this.pan=this._panner.pan,this._volume=this.output=new $g({context:this.context,volume:e.volume}),this.volume=this._volume.volume,this._panner.connect(this._volume),this.mute=e.mute,br(this,["pan","volume"])}static getDefaults(){return Object.assign(Ln.getDefaults(),{mute:!1,pan:0,volume:0,channelCount:1})}get mute(){return this._volume.mute}set mute(e){this._volume.mute=e}dispose(){return super.dispose(),this._panner.dispose(),this.pan.dispose(),this._volume.dispose(),this.volume.dispose(),this}}class oC extends Ln{constructor(){const e=Mn(oC.getDefaults(),arguments,["volume","pan"]);super(e),this.name="Channel",this._solo=this.input=new pc({solo:e.solo,context:this.context}),this._panVol=this.output=new QX({context:this.context,pan:e.pan,volume:e.volume,mute:e.mute,channelCount:e.channelCount}),this.pan=this._panVol.pan,this.volume=this._panVol.volume,this._solo.connect(this._panVol),br(this,["pan","volume"])}static getDefaults(){return Object.assign(Ln.getDefaults(),{pan:0,volume:0,mute:!1,solo:!1,channelCount:1})}get solo(){return this._solo.solo}set solo(e){this._solo.solo=e}get muted(){return this._solo.muted||this.mute}get mute(){return this._panVol.mute}set mute(e){this._panVol.mute=e}_getBus(e){return oC.buses.has(e)||oC.buses.set(e,new Xi({context:this.context})),oC.buses.get(e)}send(e,n=0){const i=this._getBus(e),r=new Xi({context:this.context,units:"decibels",gain:n});return this.connect(r),r.connect(i),r}receive(e){return this._getBus(e).connect(this),this}dispose(){return super.dispose(),this._panVol.dispose(),this.pan.dispose(),this.volume.dispose(),this._solo.dispose(),this}}oC.buses=new Map;class eZ extends Ln{constructor(){const e=Mn(eZ.getDefaults(),arguments,["lowFrequency","highFrequency"]);super(e),this.name="MultibandSplit",this.input=new Xi({context:this.context}),this.output=void 0,this.low=new ah({context:this.context,frequency:0,type:"lowpass"}),this._lowMidFilter=new ah({context:this.context,frequency:0,type:"highpass"}),this.mid=new ah({context:this.context,frequency:0,type:"lowpass"}),this.high=new ah({context:this.context,frequency:0,type:"highpass"}),this._internalChannels=[this.low,this.mid,this.high],this.lowFrequency=new Ir({context:this.context,units:"frequency",value:e.lowFrequency}),this.highFrequency=new Ir({context:this.context,units:"frequency",value:e.highFrequency}),this.Q=new Ir({context:this.context,units:"positive",value:e.Q}),this.input.fan(this.low,this.high),this.input.chain(this._lowMidFilter,this.mid),this.lowFrequency.fan(this.low.frequency,this._lowMidFilter.frequency),this.highFrequency.fan(this.mid.frequency,this.high.frequency),this.Q.connect(this.low.Q),this.Q.connect(this._lowMidFilter.Q),this.Q.connect(this.mid.Q),this.Q.connect(this.high.Q),br(this,["high","mid","low","highFrequency","lowFrequency"])}static getDefaults(){return Object.assign(Ln.getDefaults(),{Q:1,highFrequency:2500,lowFrequency:400})}dispose(){return super.dispose(),nP(this,["high","mid","low","highFrequency","lowFrequency"]),this.low.dispose(),this._lowMidFilter.dispose(),this.mid.dispose(),this.high.dispose(),this.lowFrequency.dispose(),this.highFrequency.dispose(),this.Q.dispose(),this}}class tZ extends Ln{constructor(){const e=Mn(tZ.getDefaults(),arguments,["threshold","ratio"]);super(e),this.name="Compressor",this._compressor=this.context.createDynamicsCompressor(),this.input=this._compressor,this.output=this._compressor,this.threshold=new gr({minValue:this._compressor.threshold.minValue,maxValue:this._compressor.threshold.maxValue,context:this.context,convert:!1,param:this._compressor.threshold,units:"decibels",value:e.threshold}),this.attack=new gr({minValue:this._compressor.attack.minValue,maxValue:this._compressor.attack.maxValue,context:this.context,param:this._compressor.attack,units:"time",value:e.attack}),this.release=new gr({minValue:this._compressor.release.minValue,maxValue:this._compressor.release.maxValue,context:this.context,param:this._compressor.release,units:"time",value:e.release}),this.knee=new gr({minValue:this._compressor.knee.minValue,maxValue:this._compressor.knee.maxValue,context:this.context,convert:!1,param:this._compressor.knee,units:"decibels",value:e.knee}),this.ratio=new gr({minValue:this._compressor.ratio.minValue,maxValue:this._compressor.ratio.maxValue,context:this.context,convert:!1,param:this._compressor.ratio,units:"positive",value:e.ratio}),br(this,["knee","release","attack","ratio","threshold"])}static getDefaults(){return Object.assign(Ln.getDefaults(),{attack:.003,knee:30,ratio:12,release:.25,threshold:-24})}get reduction(){return this._compressor.reduction}dispose(){return super.dispose(),this._compressor.disconnect(),this.attack.dispose(),this.release.dispose(),this.threshold.dispose(),this.ratio.dispose(),this.knee.dispose(),this}}class nZ extends Ln{constructor(){const e=Mn(nZ.getDefaults(),arguments,["low","mid","high"]);super(e),this.name="EQ3",this.output=new Xi({context:this.context}),this._internalChannels=[],this.input=this._multibandSplit=new eZ({context:this.context,highFrequency:e.highFrequency,lowFrequency:e.lowFrequency}),this._lowGain=new Xi({context:this.context,gain:e.low,units:"decibels"}),this._midGain=new Xi({context:this.context,gain:e.mid,units:"decibels"}),this._highGain=new Xi({context:this.context,gain:e.high,units:"decibels"}),this.low=this._lowGain.gain,this.mid=this._midGain.gain,this.high=this._highGain.gain,this.Q=this._multibandSplit.Q,this.lowFrequency=this._multibandSplit.lowFrequency,this.highFrequency=this._multibandSplit.highFrequency,this._multibandSplit.low.chain(this._lowGain,this.output),this._multibandSplit.mid.chain(this._midGain,this.output),this._multibandSplit.high.chain(this._highGain,this.output),br(this,["low","mid","high","lowFrequency","highFrequency"]),this._internalChannels=[this._multibandSplit]}static getDefaults(){return Object.assign(Ln.getDefaults(),{high:0,highFrequency:2500,low:0,lowFrequency:400,mid:0})}dispose(){return super.dispose(),nP(this,["low","mid","high","lowFrequency","highFrequency"]),this._multibandSplit.dispose(),this.lowFrequency.dispose(),this.highFrequency.dispose(),this._lowGain.dispose(),this._midGain.dispose(),this._highGain.dispose(),this.low.dispose(),this.mid.dispose(),this.high.dispose(),this.Q.dispose(),this}}Yo().transport;function OB(){return Yo().transport}Yo().destination;Yo().destination;function fSt(){return Yo().destination}Yo().listener;Yo().draw;function pSt(){return Yo().draw}Yo();function iSe(t){return t!==null&&typeof t=="object"&&"name"in t&&typeof t.name=="string"}function rSe(t){return t!==null&&typeof t=="object"&&"step"in t&&typeof t.step=="number"&&"alt"in t&&typeof t.alt=="number"&&!isNaN(t.step)&&!isNaN(t.alt)}var sSe=[0,2,4,-1,1,3,5],aSe=sSe.map(t=>Math.floor(t*7/12));function oSe(t){const{step:e,alt:n,oct:i,dir:r=1}=t,s=sSe[e]+7*n;if(i===void 0)return[r*s];const a=i-aSe[e]-4*n;return[r*s,r*a]}var mSt=[3,0,4,1,5,2,6];function gSt(t){const[e,n,i]=t,r=mSt[vSt(e)],s=Math.floor((e+1)/7);if(n===void 0)return{step:r,alt:s,dir:i};const a=n+4*s+aSe[r];return{step:r,alt:s,oct:a,dir:i}}function vSt(t){const e=(t+1)%7;return e<0?7+e:e}var fae=(t,e)=>Array(Math.abs(e)+1).join(t),J$=Object.freeze({empty:!0,name:"",num:NaN,q:"",type:"",step:NaN,alt:NaN,dir:NaN,simple:NaN,semitones:NaN,chroma:NaN,coord:[],oct:NaN}),_St="([-+]?\\d+)(d{1,4}|m|M|P|A{1,4})",ySt="(AA|A|P|M|m|d|dd)([-+]?\\d+)",bSt=new RegExp("^"+_St+"|"+ySt+"$");function ESt(t){const e=bSt.exec(`${t}`);return e===null?["",""]:e[1]?[e[1],e[2]]:[e[4],e[3]]}var pae={};function NB(t){return typeof t=="string"?pae[t]||(pae[t]=SSt(t)):rSe(t)?NB(xSt(t)):iSe(t)?NB(t.name):J$}var mae=[0,2,4,5,7,9,11],cSe="PMMPPMM";function SSt(t){const e=ESt(t);if(e[0]==="")return J$;const n=+e[0],i=e[1],r=(Math.abs(n)-1)%7,s=cSe[r];if(s==="M"&&i==="P")return J$;const a=s==="M"?"majorable":"perfectable",o=""+n+i,c=n<0?-1:1,l=n===8||n===-8?n:c*(r+1),u=TSt(a,i),h=Math.floor((Math.abs(n)-1)/7),d=c*(mae[r]+u+12*h),f=(c*(mae[r]+u)%12+12)%12,p=oSe({step:r,alt:u,oct:h,dir:c});return{empty:!1,name:o,num:n,q:i,step:r,alt:u,dir:c,type:a,simple:l,semitones:d,chroma:f,coord:p,oct:h}}function TSt(t,e){return e==="M"&&t==="majorable"||e==="P"&&t==="perfectable"?0:e==="m"&&t==="majorable"?-1:/^A+$/.test(e)?e.length:/^d+$/.test(e)?-1*(t==="perfectable"?e.length:e.length+1):0}function xSt(t){const{step:e,alt:n,oct:i=0,dir:r}=t;if(!r)return"";const s=e+1+7*i,a=s===0?e+1:s,o=r<0?"-":"",c=cSe[e]==="M"?"majorable":"perfectable";return o+a+wSt(c,n)}function wSt(t,e){return e===0?t==="majorable"?"M":"P":e===-1&&t==="majorable"?"m":e>0?fae("A",e):fae("d",t==="perfectable"?e:e+1)}var gae=(t,e)=>Array(Math.abs(e)+1).join(t),lSe=Object.freeze({empty:!0,name:"",letter:"",acc:"",pc:"",step:NaN,alt:NaN,chroma:NaN,height:NaN,coord:[],midi:null,freq:null}),vae=new Map,CSt=t=>"CDEFGAB".charAt(t),ASt=t=>t<0?gae("b",-t):gae("#",t),RSt=t=>t[0]==="b"?-t.length:t.length;function gI(t){const e=JSON.stringify(t),n=vae.get(e);if(n)return n;const i=typeof t=="string"?kSt(t):rSe(t)?gI(PSt(t)):iSe(t)?gI(t.name):lSe;return vae.set(e,i),i}var MSt=/^([a-gA-G]?)(#{1,}|b{1,}|x{1,}|)(-?\d*)\s*(.*)$/;function OSt(t){const e=MSt.exec(t);return e?[e[1].toUpperCase(),e[2].replace(/x/g,"##"),e[3],e[4]]:["","","",""]}function NSt(t){return gI(gSt(t))}var ISt=(t,e)=>(t%e+e)%e,sV=[0,2,4,5,7,9,11];function kSt(t){const e=OSt(t);if(e[0]===""||e[3]!=="")return lSe;const n=e[0],i=e[1],r=e[2],s=(n.charCodeAt(0)+3)%7,a=RSt(i),o=r.length?+r:void 0,c=oSe({step:s,alt:a,oct:o}),l=n+i+r,u=n+i,h=(sV[s]+a+120)%12,d=o===void 0?ISt(sV[s]+a,12)-12*99:sV[s]+a+12*(o+1),f=d>=0&&d<=127?d:null,p=o===void 0?null:Math.pow(2,(d-69)/12)*440;return{empty:!1,acc:i,alt:a,chroma:h,coord:c,freq:p,height:d,letter:n,midi:f,name:l,oct:o,pc:u,step:s}}function PSt(t){const{step:e,alt:n,oct:i}=t,r=CSt(e);if(!r)return"";const s=r+ASt(n);return i||i===0?s+i:s}function uSe(t,e){const n=gI(t),i=Array.isArray(e)?e:NB(e).coord;if(n.empty||!i||i.length<2)return"";const r=n.coord,s=r.length===1?[r[0]+i[0]]:[r[0]+i[0],r[1]+i[1]];return NSt(s).name}function hSe(t,e){const n=e.length,i=(t%n+n)%n;return e.slice(i,n).concat(e.slice(0,i))}var I1={empty:!0,name:"",setNum:0,chroma:"000000000000",normalized:"000000000000",intervals:[]},dSe=t=>Number(t).toString(2).padStart(12,"0"),_ae=t=>parseInt(t,2),DSt=/^[01]{12}$/;function fSe(t){return DSt.test(t)}var LSt=t=>typeof t=="number"&&t>=0&&t<=4095,USt=t=>t&&fSe(t.chroma),yae={[I1.chroma]:I1};function pSe(t){const e=fSe(t)?t:LSt(t)?dSe(t):Array.isArray(t)?HSt(t):USt(t)?t.chroma:I1.chroma;return yae[e]=yae[e]||jSt(e)}var BSt=["1P","2m","2M","3m","3M","4P","5d","5P","6m","6M","7m","7M"];function FSt(t){const e=[];for(let n=0;n<12;n++)t.charAt(n)==="1"&&e.push(BSt[n]);return e}function zSt(t){const e=t.split("");return e.map((n,i)=>hSe(i,e).join(""))}function jSt(t){const e=_ae(t),n=zSt(t).map(_ae).filter(s=>s>=2048).sort()[0],i=dSe(n),r=FSt(t);return{empty:!1,name:"",setNum:e,chroma:t,normalized:i,intervals:r}}function HSt(t){if(t.length===0)return I1.chroma;let e;const n=[0,0,0,0,0,0,0,0,0,0,0,0];for(let i=0;i<t.length;i++)e=gI(t[i]),e.empty&&(e=NB(t[i])),e.empty||(n[e.chroma]=1);return n.join("")}var VSt=[["1P 3M 5P","major","M ^  maj"],["1P 3M 5P 7M","major seventh","maj7  ma7 M7 Maj7 ^7"],["1P 3M 5P 7M 9M","major ninth","maj9 9 ^9"],["1P 3M 5P 7M 9M 13M","major thirteenth","maj13 Maj13 ^13"],["1P 3M 5P 6M","sixth","6 add6 add13 M6"],["1P 3M 5P 6M 9M","sixth added ninth","6add9 6/9 69 M69"],["1P 3M 6m 7M","major seventh flat sixth","M7b6 ^7b6"],["1P 3M 5P 7M 11A","major seventh sharp eleventh","maj#4 #4 #11 M7#11 ^7#11 maj7#11"],["1P 3m 5P","minor","m min -"],["1P 3m 5P 7m","minor seventh","m7 min7 mi7 -7"],["1P 3m 5P 7M","minor/major seventh","m/ma7 m/maj7 mM7 mMaj7 m/M7 -7 m -^7 -maj7"],["1P 3m 5P 6M","minor sixth","m6 -6"],["1P 3m 5P 7m 9M","minor ninth","m9 -9"],["1P 3m 5P 7M 9M","minor/major ninth","mM9 mMaj9 -^9"],["1P 3m 5P 7m 9M 11P","minor eleventh","m11 -11"],["1P 3m 5P 7m 9M 13M","minor thirteenth","m13 -13"],["1P 3m 5d","diminished","dim  o"],["1P 3m 5d 7d","diminished seventh","dim7 7 o7"],["1P 3m 5d 7m","half-diminished","m7b5  -7b5 h7 h"],["1P 3M 5P 7m","dominant seventh","7 dom"],["1P 3M 5P 7m 9M","dominant ninth","9"],["1P 3M 5P 7m 9M 13M","dominant thirteenth","13"],["1P 3M 5P 7m 11A","lydian dominant seventh","7#11 7#4"],["1P 3M 5P 7m 9m","dominant flat ninth","7b9"],["1P 3M 5P 7m 9A","dominant sharp ninth","7#9"],["1P 3M 7m 9m","altered","alt7"],["1P 4P 5P","suspended fourth","sus4 sus"],["1P 2M 5P","suspended second","sus2"],["1P 4P 5P 7m","suspended fourth seventh","7sus4 7sus"],["1P 5P 7m 9M 11P","eleventh","11"],["1P 4P 5P 7m 9m","suspended fourth flat ninth","b9sus phryg 7b9sus 7b9sus4"],["1P 5P","fifth","5"],["1P 3M 5A","augmented","aug + +5 ^#5"],["1P 3m 5A","minor augmented","m#5 -#5 m+"],["1P 3M 5A 7M","augmented seventh","maj7#5 maj7+5 +maj7 ^7#5"],["1P 3M 5P 7M 9M 11A","major sharp eleventh (lydian)","maj9#11 9#11 ^9#11"],["1P 2M 4P 5P","","sus24 sus4add9"],["1P 3M 5A 7M 9M","","maj9#5 Maj9#5"],["1P 3M 5A 7m","","7#5 +7 7+ 7aug aug7"],["1P 3M 5A 7m 9A","","7#5#9 7#9#5 7alt"],["1P 3M 5A 7m 9M","","9#5 9+"],["1P 3M 5A 7m 9M 11A","","9#5#11"],["1P 3M 5A 7m 9m","","7#5b9 7b9#5"],["1P 3M 5A 7m 9m 11A","","7#5b9#11"],["1P 3M 5A 9A","","+add#9"],["1P 3M 5A 9M","","M#5add9 +add9"],["1P 3M 5P 6M 11A","","M6#11 M6b5 6#11 6b5"],["1P 3M 5P 6M 7M 9M","","M7add13"],["1P 3M 5P 6M 9M 11A","","69#11"],["1P 3m 5P 6M 9M","","m69 -69"],["1P 3M 5P 6m 7m","","7b6"],["1P 3M 5P 7M 9A 11A","","maj7#9#11"],["1P 3M 5P 7M 9M 11A 13M","","M13#11 maj13#11 M13+4 M13#4"],["1P 3M 5P 7M 9m","","M7b9"],["1P 3M 5P 7m 11A 13m","","7#11b13 7b5b13"],["1P 3M 5P 7m 13M","","7add6 67 7add13"],["1P 3M 5P 7m 9A 11A","","7#9#11 7b5#9 7#9b5"],["1P 3M 5P 7m 9A 11A 13M","","13#9#11"],["1P 3M 5P 7m 9A 11A 13m","","7#9#11b13"],["1P 3M 5P 7m 9A 13M","","13#9"],["1P 3M 5P 7m 9A 13m","","7#9b13"],["1P 3M 5P 7m 9M 11A","","9#11 9+4 9#4"],["1P 3M 5P 7m 9M 11A 13M","","13#11 13+4 13#4"],["1P 3M 5P 7m 9M 11A 13m","","9#11b13 9b5b13"],["1P 3M 5P 7m 9m 11A","","7b9#11 7b5b9 7b9b5"],["1P 3M 5P 7m 9m 11A 13M","","13b9#11"],["1P 3M 5P 7m 9m 11A 13m","","7b9b13#11 7b9#11b13 7b5b9b13"],["1P 3M 5P 7m 9m 13M","","13b9"],["1P 3M 5P 7m 9m 13m","","7b9b13"],["1P 3M 5P 7m 9m 9A","","7b9#9"],["1P 3M 5P 9M","","Madd9 2 add9 add2"],["1P 3M 5P 9m","","Maddb9"],["1P 3M 5d","","Mb5"],["1P 3M 5d 6M 7m 9M","","13b5"],["1P 3M 5d 7M","","M7b5"],["1P 3M 5d 7M 9M","","M9b5"],["1P 3M 5d 7m","","7b5"],["1P 3M 5d 7m 9M","","9b5"],["1P 3M 7m","","7no5"],["1P 3M 7m 13m","","7b13"],["1P 3M 7m 9M","","9no5"],["1P 3M 7m 9M 13M","","13no5"],["1P 3M 7m 9M 13m","","9b13"],["1P 3m 4P 5P","","madd4"],["1P 3m 5P 6m 7M","","mMaj7b6"],["1P 3m 5P 6m 7M 9M","","mMaj9b6"],["1P 3m 5P 7m 11P","","m7add11 m7add4"],["1P 3m 5P 9M","","madd9"],["1P 3m 5d 6M 7M","","o7M7"],["1P 3m 5d 7M","","oM7"],["1P 3m 6m 7M","","mb6M7"],["1P 3m 6m 7m","","m7#5"],["1P 3m 6m 7m 9M","","m9#5"],["1P 3m 5A 7m 9M 11P","","m11A"],["1P 3m 6m 9m","","mb6b9"],["1P 2M 3m 5d 7m","","m9b5"],["1P 4P 5A 7M","","M7#5sus4"],["1P 4P 5A 7M 9M","","M9#5sus4"],["1P 4P 5A 7m","","7#5sus4"],["1P 4P 5P 7M","","M7sus4"],["1P 4P 5P 7M 9M","","M9sus4"],["1P 4P 5P 7m 9M","","9sus4 9sus"],["1P 4P 5P 7m 9M 13M","","13sus4 13sus"],["1P 4P 5P 7m 9m 13m","","7sus4b9b13 7b9b13sus4"],["1P 4P 7m 10m","","4 quartal"],["1P 5P 7m 9m 11P","","11b9"]],GSt=VSt;({...I1});var mSe=[],xL={};function qSt(t,e,n){const i=WSt(t),r={...pSe(t),name:n||"",quality:i,intervals:t,aliases:e};mSe.push(r),r.name&&(xL[r.name]=r),xL[r.setNum]=r,xL[r.chroma]=r,r.aliases.forEach(s=>$St(r,s))}function $St(t,e){xL[e]=t}function WSt(t){const e=n=>t.indexOf(n)!==-1;return e("5A")?"Augmented":e("3M")?"Major":e("5d")?"Diminished":e("3m")?"Minor":"Unknown"}GSt.forEach(([t,e,n])=>qSt(t.split(" "),n.split(" "),e));mSe.sort((t,e)=>t.setNum-e.setNum);var YSt=[["1P 2M 3M 5P 6M","major pentatonic","pentatonic"],["1P 2M 3M 4P 5P 6M 7M","major","ionian"],["1P 2M 3m 4P 5P 6m 7m","minor","aeolian"],["1P 2M 3m 3M 5P 6M","major blues"],["1P 3m 4P 5d 5P 7m","minor blues","blues"],["1P 2M 3m 4P 5P 6M 7M","melodic minor"],["1P 2M 3m 4P 5P 6m 7M","harmonic minor"],["1P 2M 3M 4P 5P 6M 7m 7M","bebop"],["1P 2M 3m 4P 5d 6m 6M 7M","diminished","whole-half diminished"],["1P 2M 3m 4P 5P 6M 7m","dorian"],["1P 2M 3M 4A 5P 6M 7M","lydian"],["1P 2M 3M 4P 5P 6M 7m","mixolydian","dominant"],["1P 2m 3m 4P 5P 6m 7m","phrygian"],["1P 2m 3m 4P 5d 6m 7m","locrian"],["1P 3M 4P 5P 7M","ionian pentatonic"],["1P 3M 4P 5P 7m","mixolydian pentatonic","indian"],["1P 2M 4P 5P 6M","ritusen"],["1P 2M 4P 5P 7m","egyptian"],["1P 3M 4P 5d 7m","neopolitan major pentatonic"],["1P 3m 4P 5P 6m","vietnamese 1"],["1P 2m 3m 5P 6m","pelog"],["1P 2m 4P 5P 6m","kumoijoshi"],["1P 2M 3m 5P 6m","hirajoshi"],["1P 2m 4P 5d 7m","iwato"],["1P 2m 4P 5P 7m","in-sen"],["1P 3M 4A 5P 7M","lydian pentatonic","chinese"],["1P 3m 4P 6m 7m","malkos raga"],["1P 3m 4P 5d 7m","locrian pentatonic","minor seven flat five pentatonic"],["1P 3m 4P 5P 7m","minor pentatonic","vietnamese 2"],["1P 3m 4P 5P 6M","minor six pentatonic"],["1P 2M 3m 5P 6M","flat three pentatonic","kumoi"],["1P 2M 3M 5P 6m","flat six pentatonic"],["1P 2m 3M 5P 6M","scriabin"],["1P 3M 5d 6m 7m","whole tone pentatonic"],["1P 3M 4A 5A 7M","lydian #5P pentatonic"],["1P 3M 4A 5P 7m","lydian dominant pentatonic"],["1P 3m 4P 5P 7M","minor #7M pentatonic"],["1P 3m 4d 5d 7m","super locrian pentatonic"],["1P 2M 3m 4P 5P 7M","minor hexatonic"],["1P 2A 3M 5P 5A 7M","augmented"],["1P 2M 4P 5P 6M 7m","piongio"],["1P 2m 3M 4A 6M 7m","prometheus neopolitan"],["1P 2M 3M 4A 6M 7m","prometheus"],["1P 2m 3M 5d 6m 7m","mystery #1"],["1P 2m 3M 4P 5A 6M","six tone symmetric"],["1P 2M 3M 4A 5A 6A","whole tone","messiaen's mode #1"],["1P 2m 4P 4A 5P 7M","messiaen's mode #5"],["1P 2M 3M 4P 5d 6m 7m","locrian major","arabian"],["1P 2m 3M 4A 5P 6m 7M","double harmonic lydian"],["1P 2m 2A 3M 4A 6m 7m","altered","super locrian","diminished whole tone","pomeroy"],["1P 2M 3m 4P 5d 6m 7m","locrian #2","half-diminished","aeolian b5"],["1P 2M 3M 4P 5P 6m 7m","mixolydian b6","melodic minor fifth mode","hindu"],["1P 2M 3M 4A 5P 6M 7m","lydian dominant","lydian b7","overtone"],["1P 2M 3M 4A 5A 6M 7M","lydian augmented"],["1P 2m 3m 4P 5P 6M 7m","dorian b2","phrygian #6","melodic minor second mode"],["1P 2m 3m 4d 5d 6m 7d","ultralocrian","superlocrian bb7","superlocrian diminished"],["1P 2m 3m 4P 5d 6M 7m","locrian 6","locrian natural 6","locrian sharp 6"],["1P 2A 3M 4P 5P 5A 7M","augmented heptatonic"],["1P 2M 3m 4A 5P 6M 7m","dorian #4","ukrainian dorian","romanian minor","altered dorian"],["1P 2M 3m 4A 5P 6M 7M","lydian diminished"],["1P 2M 3M 4A 5A 7m 7M","leading whole tone"],["1P 2M 3M 4A 5P 6m 7m","lydian minor"],["1P 2m 3M 4P 5P 6m 7m","phrygian dominant","spanish","phrygian major"],["1P 2m 3m 4P 5P 6m 7M","balinese"],["1P 2m 3m 4P 5P 6M 7M","neopolitan major"],["1P 2M 3M 4P 5P 6m 7M","harmonic major"],["1P 2m 3M 4P 5P 6m 7M","double harmonic major","gypsy"],["1P 2M 3m 4A 5P 6m 7M","hungarian minor"],["1P 2A 3M 4A 5P 6M 7m","hungarian major"],["1P 2m 3M 4P 5d 6M 7m","oriental"],["1P 2m 3m 3M 4A 5P 7m","flamenco"],["1P 2m 3m 4A 5P 6m 7M","todi raga"],["1P 2m 3M 4P 5d 6m 7M","persian"],["1P 2m 3M 5d 6m 7m 7M","enigmatic"],["1P 2M 3M 4P 5A 6M 7M","major augmented","major #5","ionian augmented","ionian #5"],["1P 2A 3M 4A 5P 6M 7M","lydian #9"],["1P 2m 2M 4P 4A 5P 6m 7M","messiaen's mode #4"],["1P 2m 3M 4P 4A 5P 6m 7M","purvi raga"],["1P 2m 3m 3M 4P 5P 6m 7m","spanish heptatonic"],["1P 2M 3m 3M 4P 5P 6M 7m","bebop minor"],["1P 2M 3M 4P 5P 5A 6M 7M","bebop major"],["1P 2m 3m 4P 5d 5P 6m 7m","bebop locrian"],["1P 2M 3m 4P 5P 6m 7m 7M","minor bebop"],["1P 2M 3M 4P 5d 5P 6M 7M","ichikosucho"],["1P 2M 3m 4P 5P 6m 6M 7M","minor six diminished"],["1P 2m 3m 3M 4A 5P 6M 7m","half-whole diminished","dominant diminished","messiaen's mode #2"],["1P 3m 3M 4P 5P 6M 7m 7M","kafi raga"],["1P 2M 3M 4P 4A 5A 6A 7M","messiaen's mode #6"],["1P 2M 3m 3M 4P 5d 5P 6M 7m","composite blues"],["1P 2M 3m 3M 4A 5P 6m 7m 7M","messiaen's mode #3"],["1P 2m 2M 3m 4P 4A 5P 6m 6M 7M","messiaen's mode #7"],["1P 2m 2M 3m 3M 4P 5d 5P 6m 6M 7m 7M","chromatic"]],KSt=YSt,XSt={...I1,intervals:[],aliases:[]},IO={};function ZSt(t){return IO[t]||XSt}function JSt(t,e,n=[]){const i={...pSe(t),name:e,intervals:t,aliases:n};return IO[i.name]=i,IO[i.setNum]=i,IO[i.chroma]=i,i.aliases.forEach(r=>QSt(i,r)),i}function QSt(t,e){IO[e]=t}KSt.forEach(([t,e,...n])=>JSt(t.split(" "),e,n));var eTt=uSe;function tTt(t,e){return eTt(t,[0,e])}var iZ=[[0,2773,0,"ionian","","Maj7","major"],[1,2902,2,"dorian","m","m7"],[2,3418,4,"phrygian","m","m7"],[3,2741,-1,"lydian","","Maj7"],[4,2774,1,"mixolydian","","7"],[5,2906,3,"aeolian","m","m7","minor"],[6,3434,5,"locrian","dim","m7b5"]],bae={...I1,name:"",alt:0,modeNum:NaN,triad:"",seventh:"",aliases:[]},nTt=iZ.map(iTt),Q$={};nTt.forEach(t=>{Q$[t.name]=t,t.aliases.forEach(e=>{Q$[e]=t})});function gSe(t){return typeof t=="string"?Q$[t.toLowerCase()]||bae:t&&t.name?gSe(t.name):bae}function iTt(t){const[e,n,i,r,s,a,o]=t,c=o?[o]:[],l=Number(n).toString(2);return{empty:!1,intervals:ZSt(r).intervals,modeNum:e,chroma:l,normalized:l,name:r,setNum:n,alt:i,triad:s,seventh:a,aliases:c}}function vSe(t){return(e,n)=>{const i=gSe(e);if(i.empty)return[];const r=hSe(i.modeNum,t),s=i.intervals.map(a=>uSe(n,a));return r.map((a,o)=>s[o]+a)}}vSe(iZ.map(t=>t[4]));vSe(iZ.map(t=>t[5]));const Eae=4,rTt={a:1,b:2,c:3,d:4,e:5,f:6,g:7,x:8,"#":9,"!":10,y:13,t:14,s:15,i:16,q:17,h:18,w:19,3:20,".":21,"+":11,"-":12,0:22,1:23,2:24,p:25,4:26,5:27,6:29,7:28,8:30,9:31};function sTt(t,e,n,i=!0){let r=e,s=4,a="32n",o="",c="";const l=[];function u(){c="",o="",r+=Uc(a).toSeconds()}function h(){c===null?(l.push([r,[t,a,c]]),u()):an(c)?(l.push([r,[t,a,c]]),u()):c.startsWith("#")?(l.push([r,[t,a,c]]),u()):c!==""&&(l.push([r,[t,a,`${c}${o}${s}`]]),u())}if(Tn(n))c=n;else for(let d=0;d<n.length;++d){switch(n[d]){case 9:case 10:break;default:h();break}switch(n[d]){case 1:c="A";break;case 2:c="B";break;case 3:c="C";break;case 4:c="D";break;case 5:c="E";break;case 6:c="F";break;case 7:c="G";break;case 8:c=null;break;case 9:o+="#";break;case 10:o+="b";break;case 11:++s;break;case 12:--s;break;case 13:a="64n";break;case 14:a="32n";break;case 15:a="16n";break;case 16:a="8n";break;case 17:a="4n";break;case 18:a="2n";break;case 19:a="1n";break;case 20:a=a.replace("n","t");break;case 21:a+=".";break;case 22:c=0;break;case 23:c=1;break;case 24:c=2;break;case 25:c=3;break;case 26:c=4;break;case 27:c=5;break;case 29:c=6;break;case 28:c=7;break;case 30:c=8;break;case 31:c=9;break}}return h(),i&&l.push([r,[t,"8n",-1]]),l}function aTt(t){const e=[],n=t.split(";");for(let i=0;i<n.length;++i){const r=[],s=n[i];if(s.startsWith("#"))e.push(s);else{for(let a=0;a<s.length;++a){const o=rTt[s[a]];re(o)&&r.push(o)}e.push(r)}}return e}const oTt="data:text/javascript;base64,Ly8gQSBkb3duc2FtcGxpbmcvZGVncmFkaW5nIHByb2Nlc3NpbmcgZWZmZWN0Ci8vIFNhbXBsZSBhbmQgaG9sZHMgdGhlIHNpZ25hbCBiYXNlZCBvbiBhbiBpbmNyZW1lbnRpbmcgY291bnRlcgovLyB3cml0dGVuIGJ5IFRpbW8gSG9vZ2xhbmQsIChjKSAyMDIzLCB3d3cudGltb2hvb2dsYW5kLmNvbQovLwpjbGFzcyBTeW50aFdvcmtsZXRQcm9jZXNzb3IgZXh0ZW5kcyBBdWRpb1dvcmtsZXRQcm9jZXNzb3IgewogIHN0YXRpYyBnZXQgcGFyYW1ldGVyRGVzY3JpcHRvcnMoKSB7CiAgICByZXR1cm4gWwogICAgICB7CiAgICAgICAgbmFtZTogJ2Rvd24nLAogICAgICAgIGRlZmF1bHRWYWx1ZTogMSwKICAgICAgICBtaW5WYWx1ZTogMSwKICAgICAgICBtYXhWYWx1ZTogNTEyLAogICAgICB9LAogICAgXQogIH0KCiAgY29uc3RydWN0b3IoKSB7CiAgICBzdXBlcigpCiAgICAvLyB0aGUgZnJhbWUgY291bnRlcgogICAgdGhpcy5jb3VudCA9IDAKICAgIC8vIHNhbXBsZSBhbmQgaG9sZCB2YXJpYWJsZSBhcnJheQogICAgdGhpcy5zYWggPSBbXQogIH0KCiAgcHJvY2VzcyhpbnB1dHMsIG91dHB1dHMsIHBhcmFtZXRlcnMpIHsKICAgIGNvbnN0IGlucHV0ID0gaW5wdXRzWzBdCiAgICBjb25zdCBvdXRwdXQgPSBvdXRwdXRzWzBdCgogICAgLy8gaWYgdGhlcmUgaXMgYW55dGhpbmcgdG8gcHJvY2VzcwogICAgaWYgKGlucHV0Lmxlbmd0aCA+IDApIHsKICAgICAgLy8gZm9yIHRoZSBsZW5ndGggb2YgdGhlIHNhbXBsZSBhcnJheSAoZ2VuZXJhbGx5IDEyOCkKICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBpbnB1dFswXS5sZW5ndGg7IGkrKykgewogICAgICAgIC8vIGZvciBldmVyeSBjaGFubmVsCiAgICAgICAgZm9yIChsZXQgY2hhbm5lbCA9IDA7IGNoYW5uZWwgPCBpbnB1dC5sZW5ndGg7ICsrY2hhbm5lbCkgewogICAgICAgICAgLy8gaWYgY291bnRlciBlcXVhbHMgMCwgc2FtcGxlIGFuZCBob2xkCiAgICAgICAgICBpZiAodGhpcy5jb3VudCAlIHBhcmFtZXRlcnMuZG93biA9PT0gMCkgewogICAgICAgICAgICB0aGlzLnNhaFtjaGFubmVsXSA9IGlucHV0W2NoYW5uZWxdW2ldCiAgICAgICAgICB9CiAgICAgICAgICAvLyBvdXRwdXQgdGhlIGN1cnJlbnRseSBoZWxkIHNhbXBsZQogICAgICAgICAgb3V0cHV0W2NoYW5uZWxdW2ldID0gdGhpcy5zYWhbY2hhbm5lbF0KICAgICAgICB9CiAgICAgICAgLy8gaW5jcmVtZW50IHNhbXBsZSBjb3VudGVyCiAgICAgICAgdGhpcy5jb3VudCsrCiAgICAgIH0KICAgIH0KICAgIHJldHVybiB0cnVlCiAgfQp9CgpyZWdpc3RlclByb2Nlc3Nvcignc3ludGh3b3JrbGV0cHJvY2Vzc29yJywgU3ludGhXb3JrbGV0UHJvY2Vzc29yKQo=";class rZ extends Mp{constructor(){const n=Mn(rZ.getDefaults(),arguments,["rate"]);super(n);fi(this,"name","FrequencyCrusher");fi(this,"rate");fi(this,"_audioworkletnode",this.context.createAudioWorkletNode("synthworkletprocessor"));this.rate=new gr({context:this.context,param:this._audioworkletnode.parameters.get("down"),value:n.rate,minValue:1,maxValue:512}),this.connectEffect(this._audioworkletnode)}static getDefaults(){return Object.assign(Mp.getDefaults(),{rate:64})}dispose(){return super.dispose(),this._audioworkletnode.disconnect(),this}}async function cTt(){await Yo().addAudioWorkletModule(oTt)}const e7=Uc("256n").toSeconds(),lTt=Uc("8n").toSeconds();function aV(){const t=new ZX,e=ro(t.get()),n=new G8,i=ro(n.get()),r=new XX,s=ro(r.get()),a=new mI,o=ro(a.get()),c=new JX,l=ro(c.get()),u=new rZ,h=ro(u.get()),d=new YX,f=ro(d.get());function p(){t.set({...e,wet:0}),n.set({...i,wet:0,delayTime:e7,maxDelay:"8n",feedback:.666}),r.set({...s,wet:0,frequency:4,octaves:3,baseFrequency:330}),a.set({...o,wet:0,oversample:"4x"}),c.set({...l,wet:0,depth:0,maxDelay:.5}),u.set({...h,wet:0,rate:32}),d.set({...f,wet:0})}return p(),{fc:u,echo:n,reverb:t,phaser:r,vibrato:c,distortion:a,applyreset:p,autowah:d,fcrush:u,distort:a}}var bs=(t=>(t[t.SYNTH=0]="SYNTH",t[t.RETRO_NOISE=1]="RETRO_NOISE",t[t.BUZZ_NOISE=2]="BUZZ_NOISE",t[t.CLANG_NOISE=3]="CLANG_NOISE",t[t.METALLIC_NOISE=4]="METALLIC_NOISE",t[t.BELLS=5]="BELLS",t[t.DOOT=6]="DOOT",t))(bs||{});const Sae=131072;function uTt(t){const e=Yo().createBuffer(1,Sae,Yo().sampleRate);let n=1;const i=e.getChannelData(0);for(let r=0;r<Sae;r++){t===4?i[r]=(n&1)*4*(Math.random()*14+1)-8:i[r]=(n&1)*2-1;let s=n>>1;if((n+s&1)==1)switch(t){default:case 1:s+=16384;break;case 3:s+=32768;break;case 2:s+=40;break;case 4:s+=60;break}n=s}return e}function Fv(t){let e,n;function i(){switch(e==null?void 0:e.type){case 0:{e.synth.set({...n,envelope:{...n.envelope,attack:.01,decay:.01,sustain:.5,release:.01},oscillator:{...n.oscillator,type:"square"}});break}case 1:{e.synth.set({...n,attack:.01,decay:.01,sustain:.5,release:.01});break}case 5:{e.synth.set({...n,harmonicity:1.5,modulationIndex:30,oscillator:{type:"sine"},modulation:{type:"square"},envelope:{attack:.01,decay:3,sustain:.3,release:6},modulationEnvelope:{attack:.5,decay:1,sustain:.2,release:4}});break}case 6:{e.synth.set({...n});break}}}switch(t){case 0:return e={type:t,synth:new $l},n=ro(e.synth.get()),i(),{source:e,applyreset:i};case 1:case 2:case 3:case 4:return e={type:t,synth:new cP({volume:-44,urls:{C4:uTt(t)}}),filter1:new zA({type:"lowshelf",gain:-32,frequency:440}),filter2:new zA({type:"highshelf",gain:32,frequency:440})},n=ro(e.synth.get()),i(),{source:e,applyreset:i};case 5:return e={type:5,synth:new HX,sparkle:new VX({volume:-16,envelope:{attack:.001,decay:1.4,release:.321},harmonicity:5.1,modulationIndex:32,resonance:4e3,octaves:1.5})},n=ro(e.synth.get()),i(),{source:e,applyreset:i};case 6:return e={type:t,synth:new AR},n=ro(e.synth.get()),i(),{source:e,applyreset:i}}}function Tae(t){return 20*Math.log10(t)-35}function hTt(){const t=fSt(),e=Yo().createMediaStreamDestination(),n=new $g(-4);n.connect(t),n.connect(e);const i=new tZ({threshold:-24,ratio:4,attack:.003,release:.25,knee:30});i.connect(n);const r=new KX;r.set({wet:.999,depth:.111,spread:8,delayTime:8}),r.connect(i);const s=new O1({type:"pink"}),a=new BX,o=new b_(0,.0042);s.chain(a,o,r),s.start(0);const c=new so(Math.PI*.25,"sine"),l=new b_(0,.333),u=new b_(1e-4,5);c.chain(a,l,r.feedback),c.chain(a,u,r.frequency),c.start();const h=new $g;h.connect(r);const d=new $g;d.connect(r);const f=new $g;f.connect(r);const p=[Fv(bs.SYNTH),Fv(bs.SYNTH),Fv(bs.SYNTH),Fv(bs.SYNTH),Fv(bs.SYNTH),Fv(bs.SYNTH),Fv(bs.SYNTH),Fv(bs.SYNTH)],g=[aV(),aV(),aV()];function _(z){return z<4?Math.floor(z/2):2}function v(z){var fe,Ne,Be,tt,Tt,Cn,je;const W=_(z);switch((fe=p[z])==null?void 0:fe.source.type){case bs.RETRO_NOISE:case bs.BUZZ_NOISE:case bs.CLANG_NOISE:case bs.METALLIC_NOISE:break;default:(Ne=p[z])==null||Ne.source.synth.chain(g[W].fc,g[W].distortion,g[W].vibrato,g[W].phaser,g[W].autowah,g[W].echo,g[W].reverb,z<4?h:d);break}switch((Be=p[z])==null?void 0:Be.source.type){case bs.RETRO_NOISE:case bs.BUZZ_NOISE:case bs.CLANG_NOISE:case bs.METALLIC_NOISE:(Cn=p[z])==null||Cn.source.synth.chain((tt=p[z])==null?void 0:tt.source.filter1,(Tt=p[z])==null?void 0:Tt.source.filter2,g[W].fc,g[W].distortion,g[W].vibrato,g[W].phaser,g[W].autowah,g[W].echo,g[W].reverb,z<4?h:d);break;case bs.BELLS:{(je=p[z])==null||je.source.sparkle.chain(g[W].fc,g[W].distortion,g[W].vibrato,g[W].phaser,g[W].autowah,g[W].echo,g[W].reverb,z<4?h:d);break}}}for(let z=0;z<p.length;++z)v(z);function b(z,W){var fe,Ne;((fe=p[z])==null?void 0:fe.source.type)!==W&&((Ne=p[z])==null||Ne.source.synth.dispose(),p[z]=Fv(W),v(z))}const S=new AB().connect(h);S.maxPolyphony=8,S.set({envelope:{attack:.001,decay:.001,sustain:.001,release:.1},oscillator:{type:"square"}});function x(z){S.triggerAttackRelease("C6","1i",z)}const M=new $l().connect(h);S.set({envelope:{attack:.001,decay:.001,sustain:.001,release:.1},oscillator:{type:"square"}});function R(z){const W=Uc("64n").toSeconds();M.triggerAttackRelease("C6","8n",z),M.frequency.exponentialRampToValueAtTime("C11",W+z)}const I=new ah(350,"bandpass").connect(h),k=new Xi().connect(I);k.gain.value=0;const P=new AB().connect(k);P.volume.value=16,P.maxPolyphony=8,P.set({envelope:{attack:.001,decay:.01,sustain:.1,release:.1},oscillator:{type:"square"}});function U(z,W){const fe=Uc("64n").toSeconds()+Uc(z).toSeconds();k.gain.setValueAtTime(.5,W),k.gain.exponentialRampToValueAtTime(.01,fe+W),P.triggerAttackRelease([800,540],z,W)}const V=new nZ(-10,10,-1).connect(h),$=new ah(800,"highpass",-12);$.connect(V);const q=new sC;q.set({envelope:{attack:.01,decay:.1,sustain:.1,release:.1}}),q.connect($);function Y(z,W){q.triggerAttackRelease(z,W)}const te=new mI().connect(h);te.set({distortion:.666});const G=new $l;G.set({envelope:{attack:0,decay:.1,sustain:0,release:1},oscillator:{type:"triangle"}}),G.connect(te);const J=new ah;J.set({type:"highpass",frequency:1e4}),J.connect(te);const K=new sC;K.set({envelope:{attack:.01,decay:.1,sustain:0,release:.1}}),K.connect(J);function X(z,W){const fe=Uc("512n").toSeconds(),Ne=Uc("32n").toSeconds();G.triggerAttackRelease(1e4,z,W,1),G.frequency.exponentialRampToValueAtTime(300,W+fe),G.frequency.exponentialRampToValueAtTime(100,W+Ne),K.triggerAttackRelease("8n",W,.333),K.volume.setValueAtTime(1,W),K.volume.exponentialRampToValueAtTime(0,W+Uc("32n").toSeconds())}const ae=new ah;ae.set({type:"bandpass",frequency:256,Q:.17}),ae.connect(h);const ce=new $l;ce.set({envelope:{attack:.001,decay:.001,sustain:.001,release:.1},oscillator:{type:"sawtooth"}}),ce.connect(ae);const Me=new $l;Me.set({envelope:{attack:.001,decay:.1,sustain:.001,release:.1},oscillator:{type:"sine"}}),Me.connect(ae);function Fe(z,W){ce.triggerAttackRelease(2e3,z,W),ce.frequency.exponentialRampToValueAtTime(1e3,W+Uc("32n").toSeconds()),Me.triggerAttackRelease(999,z,W),Me.frequency.exponentialRampToValueAtTime(888,W+Uc("256n").toSeconds())}const Te=new mI().connect(h);Te.set({distortion:.876});const Re=new $l;Re.set({envelope:{attack:0,decay:.1,sustain:0,release:1},oscillator:{type:"triangle"}}),Re.connect(Te);const ge=new ah;ge.set({type:"highpass",frequency:1e4}),ge.connect(Te);const _e=new sC;_e.set({envelope:{attack:.01,decay:.1,sustain:.001,release:.1}}),_e.connect(ge);function ke(z,W){const fe=Uc("512n").toSeconds(),Ne=Uc("32n").toSeconds();Re.triggerAttackRelease(1e4,z,W,1),Re.frequency.exponentialRampToValueAtTime(150,W+fe),Re.frequency.exponentialRampToValueAtTime(100,W+Ne),_e.triggerAttackRelease("8n",W,.25),_e.volume.setValueAtTime(1,W),_e.volume.exponentialRampToValueAtTime(0,W+Uc("32n").toSeconds())}const gt=new $l().connect(h);gt.set({envelope:{attack:.01,decay:.1,sustain:.001,release:.1},oscillator:{type:"sawtooth"}});const wt=new $l().connect(h);gt.set({envelope:{attack:.01,decay:.1,sustain:.001,release:.1},oscillator:{type:"triangle"}});const ye=new sC().connect(h);ye.set({envelope:{attack:.01,decay:.1,sustain:.001,release:.1}});function Se(z,W){const fe=Uc("256n").toSeconds(),Ne=Uc(z).toSeconds()-fe;gt.triggerAttackRelease("C4",Ne,W,1),gt.frequency.exponentialRampToValueAtTime(oae("C0").toFrequency(),W+Ne),wt.triggerAttackRelease("C5",Ne,W,.5),wt.frequency.exponentialRampToValueAtTime(oae("C0").toFrequency(),W+Ne);const Be=Uc("4n").toSeconds();ye.triggerAttackRelease("8n",W),ye.volume.setValueAtTime(1,W),ye.volume.exponentialRampToValueAtTime(0,W+Be)}const Qe=new ah;Qe.set({type:"bandpass",frequency:256,Q:.17}),Qe.connect(h);const pe=new $l;pe.set({envelope:{attack:.001,decay:.001,sustain:.001,release:.1},oscillator:{type:"sawtooth"}}),pe.connect(Qe);const ze=new $l;ze.set({envelope:{attack:.001,decay:.1,sustain:.001,release:.1},oscillator:{type:"sine"}}),ze.connect(Qe);function Le(z,W){pe.triggerAttackRelease(2e3,z,W),pe.frequency.exponentialRampToValueAtTime(100,W+Uc("32n").toSeconds()),ze.triggerAttackRelease(699,z,W),ze.frequency.exponentialRampToValueAtTime(399,W+Uc("256n").toSeconds())}const rt=new AR().connect(h);rt.set({octaves:8,volume:8,pitchDecay:.125});function dt(z){rt.triggerAttackRelease("C1","8n",z)}const pt=new RB(bt);function bt(z,W){if(W===null)return;const[fe,Ne,Be]=W,tt=_(fe);if(Tn(Be)&&re(p[fe])&&re(g[tt]))if(Be.startsWith("#"))pSt().schedule(()=>{f6e(Ye,"",Be.slice(1))},z);else{switch(p[fe].source.type){case bs.BELLS:p[fe].source.synth.detune.value=rf(-3,3),p[fe].source.sparkle.triggerAttackRelease(tTt(Be,2),Ne,z);break}p[fe].source.synth.triggerAttackRelease(Be,Ne,z);const Tt=p[fe].source.synth.toSeconds(Ne),Cn="128n",je=p[fe].source.synth.toSeconds(Cn);g[tt].vibrato.depth.rampTo(1,"2n",z),g[tt].vibrato.depth.rampTo(0,Cn,z+Tt-je),g[tt].vibrato.frequency.rampTo(5,"4n",z),g[tt].vibrato.frequency.rampTo(1,Cn,z+Tt-je)}if(an(Be))switch(Be){case 0:x(z);break;case 1:R(z);break;case 2:U(Ne,z);break;case 3:Y(Ne,z);break;case 4:X(Ne,z);break;case 5:Fe(Ne,z);break;case 6:ke(Ne,z);break;case 7:Se(Ne,z);break;case 8:Le(Ne,z);break;case 9:dt(z);break;case-1:--$e,$e===0&&(pt.clear(),he=-1);break}}function we(z,W,fe,Ne=!0){let Be=W;const tt=sTt(z,W,fe,Ne),Tt=tt[tt.length-1];re(Tt)&&(Be=Math.max(Be,Tt[0]));for(let Cn=0;Cn<tt.length;++Cn){const[je,zt]=tt[Cn];pt.add(je,zt)}return Be}let he=-1,$e=0,et=Eae;function Et(z,W){const fe=aTt(z),Ne=OB().seconds+OB().context.lookAhead;if(W)for(let Be=0;Be<fe.length;++Be)we(et++,Ne,fe[Be],!1),et>=p.length&&(et=Eae);else{he===-1&&(he=Ne),$e+=fe.length;const Be=he;for(let tt=0;tt<fe.length&&tt<p.length;++tt){const Tt=we(tt,Be,fe[tt]);he=Math.max(he,Tt)}}}pt.start(0);function ct(){pt.clear(),he=-1,$e=0}function tn(z){h.volume.value=Tae(z)}function Ht(z){d.volume.value=Tae(z)}function pn(z){new oP(z).connect(f).start(0)}function le(z){f.volume.value=z}return le(15),tn(75),Ht(100),{broadcastdestination:e,addplay:Et,stopplay:ct,addttsaudiobuffer:pn,setplayvolume:tn,setbgplayvolume:Ht,setttsvolume:le,SOURCE:p,FX:g,changesource:b}}const dTt=/(am|fm|fat)*(sine|square|triangle|sawtooth|custom)[0-9]+/,fTt=/(am|fm|fat)*(sine|square|triangle|sawtooth|custom)[0-9]*/;function pTt(t,e){if(Tn(t)){const n=Wn(t);if(dTt.test(n))return ji(e);switch(n){case"pwm":case"pulse":case"retro":case"buzz":case"clang":case"metallic":case"bells":case"doot":return!0;default:return fTt.test(n)}}return!1}function mTt(t,e,n,i,r){if(!re(e))return;const s=e.SOURCE[n];if(!re(s)){Mi(Ye,t,"synth",`unknown voice ${n}`);return}switch(i){case"reset":case"restart":s.applyreset();return;case"vol":case"volume":an(r)&&(s.source.synth.volume.value=r);return;case"port":case"portamento":if(an(r))switch(s.source.type){case bs.SYNTH:s.source.synth.portamento=r;break;case bs.RETRO_NOISE:Mi(Ye,t,"synth","portamento for retro synth not supported");break}return;case"env":case"envelope":if(ji(r)){const[a,o,c,l]=r;s.source.synth.set({envelope:{attack:a,decay:o,sustain:c,release:l}})}return;default:if(Tn(i)){if(pTt(i,r)){switch(i){case"retro":e.changesource(n,bs.RETRO_NOISE);break;case"buzz":e.changesource(n,bs.BUZZ_NOISE);break;case"clang":e.changesource(n,bs.CLANG_NOISE);break;case"metallic":e.changesource(n,bs.METALLIC_NOISE);break;case"bells":e.changesource(n,bs.BELLS);break;case"doot":e.changesource(n,bs.DOOT);break;default:e.changesource(n,bs.SYNTH),s.source.synth.set({oscillator:{type:i}}),ji(r)&&s.source.synth.set({oscillator:{type:i,partials:r,partialCount:r.length}}),an(r)&&s.source.synth.set({oscillator:{type:i,partials:[r],partialCount:1}});break}return}switch(s.source.type){case bs.SYNTH:{switch(s.source.synth.get().oscillator.type){case"pwm":switch(i){case"modfreq":case"modulationfrequency":an(r)&&s.source.synth.set({oscillator:{modulationFrequency:r}});return}break;case"pulse":switch(i){case"width":an(r)&&s.source.synth.set({oscillator:{width:r}});return}break;case"custom":case"sine":case"square":case"triangle":case"sawtooth":switch(i){case"phase":an(r)&&s.source.synth.set({oscillator:{phase:r}});return}break;case"amcustom":case"amsine":case"amsquare":case"amtriangle":case"amsawtooth":switch(i){case"harmonicity":an(r)&&s.source.synth.set({oscillator:{harmonicity:r}});return;case"modtype":case"modulationtype":Tn(r)&&s.source.synth.set({oscillator:{modulationType:r}});return;case"modenv":case"modulationenvelope":if(ji(r)){const[o,c,l,u]=r;s.source.synth.set({oscillator:{modulationEnvelope:{attack:o,decay:c,sustain:l,release:u}}});return}break}break;case"fmcustom":case"fmsine":case"fmsquare":case"fmtriangle":case"fmsawtooth":switch(i){case"harmonicity":if(an(r)){s.source.synth.set({oscillator:{harmonicity:r}});return}break;case"modindex":if(an(r)){s.source.synth.set({oscillator:{modulationIndex:r}});return}break;case"modtype":if(Tn(r)){s.source.synth.set({oscillator:{modulationType:r}});return}break;case"modenv":if(ji(r)){const[o,c,l,u]=r;s.source.synth.set({oscillator:{modulationEnvelope:{attack:o,decay:c,sustain:l,release:u}}});return}break}break;case"fatcustom":case"fatsine":case"fatsquare":case"fattriangle":case"fatsawtooth":switch(i){case"count":if(an(r)){s.source.synth.set({oscillator:{count:r}});return}break;case"phase":if(an(r)){s.source.synth.set({oscillator:{phase:r}});return}break;case"spread":if(an(r)){s.source.synth.set({oscillator:{spread:r}});return}break}break}return}case bs.BELLS:switch(i){default:return}case bs.DOOT:switch(i){default:return}}Mi(Ye,t,"synth",`unknown config ${i}`)}break}}function gTt(t,e,n,i,r){if(!re(e))return;if(n<0||n>=e.FX.length){Mi(Ye,t,"synth",`index ${n} out of bounds`);return}const s=e.FX[n].autowah;switch(i){case"basefrequency":if(an(r)){s.set({baseFrequency:r});return}break;case"octaves":if(an(r)){s.set({octaves:r});return}break;case"sensitivity":if(an(r)){s.set({sensitivity:r});return}break;case"gain":if(an(r)){s.set({gain:r});return}break;case"follower":if(an(r)){s.set({follower:r});return}break}Mi(Ye,t,"synth",`unknown autowah config ${i} with ${r}`)}function vTt(t,e,n,i,r){if(!re(e)||n<0||n>=e.FX.length){Mi(Ye,t,"synth",`index ${n} out of bounds`);return}const s=e.FX[n].distortion;switch(i){case"distortion":if(an(r)){s.set({distortion:r});return}break;case"oversample":if(Tn(r)){s.set({oversample:r});return}break}Mi(Ye,t,"kind",`unknown distortion ${i} or ${r}`)}function _Tt(t,e,n,i,r){if(!re(e)||n<0||n>=e.FX.length){Mi(Ye,t,"synth",`index ${n} out of bounds`);return}const s=e.FX[n].echo;switch(i){case"delaytime":if(an(r)){s.set({delayTime:r});return}break;case"feedback":if(an(r)){s.set({feedback:r});return}break}Mi(Ye,t,"kind",`unknown echo ${i} or ${r}`)}function yTt(t,e,n,i,r){if(!re(e)||n<0||n>=e.FX.length){Mi(Ye,t,"synth",`index ${n} out of bounds`);return}const s=e.FX[n].fcrush;switch(i){case"rate":if(an(r)){s.set({rate:r});return}break}Mi(Ye,t,"kind",`unknown fcrush ${i} or ${r}`)}function bTt(t,e,n,i,r){if(!re(e)||n<0||n>=e.FX.length){Mi(Ye,t,"synth",`index ${n} out of bounds`);return}const s=e.FX[n].phaser;switch(i){case"q":if(an(r)){s.set({Q:r});return}break;case"octaves":if(an(r)){s.set({octaves:r});return}break;case"basefrequency":s.set({baseFrequency:r});return}Mi(Ye,t,"kind",`unknown phaser ${i} or ${r}`)}function ETt(t,e,n,i,r){if(!re(e)||n<0||n>=e.FX.length){Mi(Ye,t,"synth",`index ${n} out of bounds`);return}const s=e.FX[n].reverb;switch(i){case"decay":if(an(r)){s.set({decay:r});return}break;case"predelay":if(an(r)){s.set({preDelay:r});return}break}Mi(Ye,t,"kind",`unknown reverb ${i} or ${r}`)}function STt(t,e,n,i,r){if(!re(e))return;if(n<0||n>=e.FX.length){Mi(Ye,t,"synth",`index ${n} out of bounds`);return}const s=e.FX[n].vibrato;switch(i){case"maxdelay":if(an(r)){s.set({maxDelay:r});return}break}Mi(Ye,t,"synth",`unknown vibrato config ${i} with ${r}`)}function TTt(t,e,n,i,r,s){if(!re(e))return;if(n<0||n>=e.FX.length){Mi(Ye,t,"synth",`index ${n} out of bounds`);return}const a=e.FX[n][i];if(re(a)){switch(r){case"on":switch(i){case"vibrato":a.wet.value=.8;break;default:a.wet.value=.2;break}break;case"off":a.wet.value=0;break;default:if(an(r))a.wet.value=er(.01*r,0,1);else switch(i){case"fc":case"fcrush":yTt(t,e,n,r,s);break;case"echo":_Tt(t,e,n,r,s);break;case"phaser":bTt(t,e,n,r,s);break;case"reverb":ETt(t,e,n,r,s);break;case"distort":case"distortion":vTt(t,e,n,r,s);break;case"vibrato":STt(t,e,n,r,s);break;case"autowah":gTt(t,e,n,r,s);break}break}a instanceof G8&&(a.wet.value===0?a.set({delayTime:e7}):a.get().delayTime===e7&&a.set({delayTime:lTt}));return}Mi(Ye,t,"synth",`unknown fx ${i}`)}const xTt="modulepreload",wTt=function(t){return"/"+t},xae={},t7=function(e,n,i){let r=Promise.resolve();if(n&&n.length>0){document.getElementsByTagName("link");const a=document.querySelector("meta[property=csp-nonce]"),o=(a==null?void 0:a.nonce)||(a==null?void 0:a.getAttribute("nonce"));r=Promise.allSettled(n.map(c=>{if(c=wTt(c),c in xae)return;xae[c]=!0;const l=c.endsWith(".css"),u=l?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${c}"]${u}`))return;const h=document.createElement("link");if(h.rel=l?"stylesheet":xTt,l||(h.as="script"),h.crossOrigin="",h.href=c,o&&h.setAttribute("nonce",o),document.head.appendChild(h),l)return new Promise((d,f)=>{h.addEventListener("load",d),h.addEventListener("error",()=>f(new Error(`Unable to preload CSS for ${c}`)))})}))}function s(a){const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=a,window.dispatchEvent(o),!o.defaultPrevented)throw a}return r.then(a=>{for(const o of a||[])o.status==="rejected"&&s(o.reason);return e().catch(s)})};var CTt=Object.defineProperty,ATt=(t,e,n)=>e in t?CTt(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,Yi=(t,e,n)=>(ATt(t,typeof e!="symbol"?e+"":e,n),n),_Se=(t,e,n)=>{if(!e.has(t))throw TypeError("Cannot "+n)},EM=(t,e,n)=>(_Se(t,e,"read from private field"),n?n.call(t):e.get(t)),RTt=(t,e,n)=>{if(e.has(t))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(t):e.set(t,n)},MTt=(t,e,n,i)=>(_Se(t,e,"write to private field"),e.set(t,n),n),Qy,oV=new Intl.Collator(0,{numeric:1}).compare;function ySe(t,e,n){return t=t.split("."),e=e.split("."),oV(t[0],e[0])||oV(t[1],e[1])||(e[2]=e.slice(2).join("."),n=/[.-]/.test(t[2]=t.slice(2).join(".")),n==/[.-]/.test(e[2])?oV(t[2],e[2]):n?-1:1)}const OTt="host",bSe="queue/data",NTt="queue/join",wae="upload",ITt="login",kTt="config",PTt="info",DTt="runtime",LTt="sleeptime",UTt="heartbeat",BTt="component_server",FTt="reset",zTt="cancel",jTt="https://gradio-space-api-fetcher-v2.hf.space/api",ESe="This application is currently busy. Please try again. ",GT="Connection errored out. ",lb="Could not resolve app config. ",HTt="Could not get space status. ",VTt="Could not get API info. ",sZ="Space metadata could not be loaded. ",GTt="Invalid URL. A full URL path is required.",qTt="Not authorized to access this space. ",SSe="Invalid credentials. Could not login. ",$Tt="Login credentials are required to access this space.",WTt="File system access is only available in Node.js environments",TSe="Root URL not found in client config",YTt="Error uploading file";function xSe(t,e,n){return e.startsWith("http://")||e.startsWith("https://")?n?t:e:t+e}async function Cae(t,e,n){try{return(await(await fetch(`https://huggingface.co/api/spaces/${t}/jwt`,{headers:{Authorization:`Bearer ${e}`,...n?{Cookie:n}:{}}})).json()).token||!1}catch{return!1}}function KTt(t){let e={};return t.forEach(({api_name:n,id:i})=>{n&&(e[n]=i)}),e}async function XTt(t){var e;const n=this.options.hf_token?{Authorization:`Bearer ${this.options.hf_token}`}:{};if(n["Content-Type"]="application/json",typeof window<"u"&&window.gradio_config&&location.origin!=="http://localhost:9876"&&!window.gradio_config.dev_mode){const i=window.gradio_config.root,r=window.gradio_config;let s=xSe(t,r.root,!1);return r.root=s,{...r,path:i}}else if(t){const i=ASe(t,kTt),r=await this.fetch(i,{headers:n,credentials:"include"});if((r==null?void 0:r.status)===401&&!this.options.auth)throw new Error($Tt);if((r==null?void 0:r.status)===401&&this.options.auth)throw new Error(SSe);if((r==null?void 0:r.status)===200){let s=await r.json();return s.path=s.path??"",s.root=t,(e=s.dependencies)==null||e.forEach((a,o)=>{a.id===void 0&&(a.id=o)}),s}else if((r==null?void 0:r.status)===401)throw new Error(qTt);throw new Error(lb)}throw new Error(lb)}async function ZTt(){const{http_protocol:t,host:e}=await q8(this.app_reference,this.options.hf_token);try{if(this.options.auth){const n=await wSe(t,e,this.options.auth,this.fetch,this.options.hf_token);n&&this.set_cookies(n)}}catch(n){throw Error(n.message)}}async function wSe(t,e,n,i,r){const s=new FormData;s.append("username",n==null?void 0:n[0]),s.append("password",n==null?void 0:n[1]);let a={};r&&(a.Authorization=`Bearer ${r}`);const o=await i(`${t}//${e}/${ITt}`,{headers:a,method:"POST",body:s,credentials:"include"});if(o.status===200)return o.headers.get("set-cookie");throw o.status===401?new Error(SSe):new Error(sZ)}function cV(t){if(t.startsWith("http")){const{protocol:e,host:n,pathname:i}=new URL(t);return{ws_protocol:e==="https:"?"wss":"ws",http_protocol:e,host:n+(i!=="/"?i:"")}}else if(t.startsWith("file:"))return{ws_protocol:"ws",http_protocol:"http:",host:"lite.local"};return{ws_protocol:"wss",http_protocol:"https:",host:new URL(t).host}}const CSe=t=>{let e=[];return t.split(/,(?=\s*[^\s=;]+=[^\s=;]+)/).forEach(i=>{const[r,s]=i.split(";")[0].split("=");r&&s&&e.push(`${r.trim()}=${s.trim()}`)}),e},aZ=/^[a-zA-Z0-9_\-\.]+\/[a-zA-Z0-9_\-\.]+$/,JTt=/.*hf\.space\/{0,1}.*$/;async function q8(t,e){const n={};e&&(n.Authorization=`Bearer ${e}`);const i=t.trim().replace(/\/$/,"");if(aZ.test(i))try{const s=(await(await fetch(`https://huggingface.co/api/spaces/${i}/${OTt}`,{headers:n})).json()).host;return{space_id:t,...cV(s)}}catch{throw new Error(sZ)}if(JTt.test(i)){const{ws_protocol:r,http_protocol:s,host:a}=cV(i);return{space_id:a.split("/")[0].replace(".hf.space",""),ws_protocol:r,http_protocol:s,host:a}}return{space_id:!1,...cV(i)}}const ASe=(...t)=>{try{return t.reduce((e,n)=>(e=e.replace(/\/+$/,""),n=n.replace(/^\/+/,""),new URL(n,e+"/").toString()))}catch{throw new Error(GTt)}};function QTt(t,e,n){const i={named_endpoints:{},unnamed_endpoints:{}};return Object.keys(t).forEach(r=>{(r==="named_endpoints"||r==="unnamed_endpoints")&&(i[r]={},Object.entries(t[r]).forEach(([s,{parameters:a,returns:o}])=>{var c,l,u,h;const d=((c=e.dependencies.find(g=>g.api_name===s||g.api_name===s.replace("/","")))==null?void 0:c.id)||n[s.replace("/","")]||-1,f=d!==-1?(l=e.dependencies.find(g=>g.id==d))==null?void 0:l.types:{generator:!1,cancel:!1};if(d!==-1&&((h=(u=e.dependencies.find(g=>g.id==d))==null?void 0:u.inputs)==null?void 0:h.length)!==a.length){const g=e.dependencies.find(_=>_.id==d).inputs.map(_=>{var v;return(v=e.components.find(b=>b.id===_))==null?void 0:v.type});try{g.forEach((_,v)=>{if(_==="state"){const b={component:"state",example:null,parameter_default:null,parameter_has_default:!0,parameter_name:null,hidden:!0};a.splice(v,0,b)}})}catch(_){console.error(_)}}const p=(g,_,v,b)=>({...g,description:t1t(g==null?void 0:g.type,v),type:e1t(g==null?void 0:g.type,_,v,b)||""});i[r][s]={parameters:a.map(g=>p(g,g==null?void 0:g.component,g==null?void 0:g.serializer,"parameter")),returns:o.map(g=>p(g,g==null?void 0:g.component,g==null?void 0:g.serializer,"return")),type:f}}))}),i}function e1t(t,e,n,i){if(e==="Api")return t.type;switch(t==null?void 0:t.type){case"string":return"string";case"boolean":return"boolean";case"number":return"number"}if(n==="JSONSerializable"||n==="StringSerializable")return"any";if(n==="ListStringSerializable")return"string[]";if(e==="Image")return i==="parameter"?"Blob | File | Buffer":"string";if(n==="FileSerializable")return(t==null?void 0:t.type)==="array"?i==="parameter"?"(Blob | File | Buffer)[]":"{ name: string; data: string; size?: number; is_file?: boolean; orig_name?: string}[]":i==="parameter"?"Blob | File | Buffer":"{ name: string; data: string; size?: number; is_file?: boolean; orig_name?: string}";if(n==="GallerySerializable")return i==="parameter"?"[(Blob | File | Buffer), (string | null)][]":"[{ name: string; data: string; size?: number; is_file?: boolean; orig_name?: string}, (string | null))][]"}function t1t(t,e){return e==="GallerySerializable"?"array of [file, label] tuples":e==="ListStringSerializable"?"array of strings":e==="FileSerializable"?"array of files or single file":t==null?void 0:t.description}function lV(t,e){switch(t.msg){case"send_data":return{type:"data"};case"send_hash":return{type:"hash"};case"queue_full":return{type:"update",status:{queue:!0,message:ESe,stage:"error",code:t.code,success:t.success}};case"heartbeat":return{type:"heartbeat"};case"unexpected_error":return{type:"unexpected_error",status:{queue:!0,message:t.message,stage:"error",success:!1}};case"estimation":return{type:"update",status:{queue:!0,stage:e||"pending",code:t.code,size:t.queue_size,position:t.rank,eta:t.rank_eta,success:t.success}};case"progress":return{type:"update",status:{queue:!0,stage:"pending",code:t.code,progress_data:t.progress_data,success:t.success}};case"log":return{type:"log",data:t};case"process_generating":return{type:"generating",status:{queue:!0,message:t.success?null:t.output.error,stage:t.success?"generating":"error",code:t.code,progress_data:t.progress_data,eta:t.average_duration,changed_state_ids:t.success?t.output.changed_state_ids:void 0},data:t.success?t.output:null};case"process_streaming":return{type:"streaming",status:{queue:!0,message:t.output.error,stage:"streaming",time_limit:t.time_limit,code:t.code,progress_data:t.progress_data,eta:t.eta},data:t.output};case"process_completed":return"error"in t.output?{type:"update",status:{queue:!0,title:t.output.title,message:t.output.error,visible:t.output.visible,duration:t.output.duration,stage:"error",code:t.code,success:t.success}}:{type:"complete",status:{queue:!0,message:t.success?void 0:t.output.error,stage:t.success?"complete":"error",code:t.code,progress_data:t.progress_data,changed_state_ids:t.success?t.output.changed_state_ids:void 0},data:t.success?t.output:null};case"process_starts":return{type:"update",status:{queue:!0,stage:"pending",code:t.code,size:t.rank,position:0,success:t.success,eta:t.eta},original_msg:"process_starts"}}return{type:"none",status:{stage:"error",queue:!0}}}const n1t=(t=[],e)=>{const n=e?e.parameters:[];if(Array.isArray(t))return t.length>n.length&&console.warn("Too many arguments provided for the endpoint."),t;const i=[],r=Object.keys(t);return n.forEach((s,a)=>{if(t.hasOwnProperty(s.parameter_name))i[a]=t[s.parameter_name];else if(s.parameter_has_default)i[a]=s.parameter_default;else throw new Error(`No value provided for required parameter: ${s.parameter_name}`)}),r.forEach(s=>{if(!n.some(a=>a.parameter_name===s))throw new Error(`Parameter \`${s}\` is not a valid keyword argument. Please refer to the API for usage.`)}),i.forEach((s,a)=>{if(s===void 0&&!n[a].parameter_has_default)throw new Error(`No value provided for required parameter: ${n[a].parameter_name}`)}),i};async function i1t(){if(this.api_info)return this.api_info;const{hf_token:t}=this.options,{config:e}=this,n={"Content-Type":"application/json"};if(t&&(n.Authorization=`Bearer ${t}`),!!e)try{let i,r;if(typeof window<"u"&&window.gradio_api_info)r=window.gradio_api_info;else{if(ySe((e==null?void 0:e.version)||"2.0.0","3.30")<0)i=await this.fetch(jTt,{method:"POST",body:JSON.stringify({serialize:!1,config:JSON.stringify(e)}),headers:n,credentials:"include"});else{const s=ASe(e.root,this.api_prefix,PTt);i=await this.fetch(s,{headers:n,credentials:"include"})}if(!i.ok)throw new Error(GT);r=await i.json()}return"api"in r&&(r=r.api),r.named_endpoints["/predict"]&&!r.unnamed_endpoints[0]&&(r.unnamed_endpoints[0]=r.named_endpoints["/predict"]),QTt(r,e,this.api_map)}catch(i){""+i.message}}async function r1t(t,e,n){var i;const r={};(i=this==null?void 0:this.options)!=null&&i.hf_token&&(r.Authorization=`Bearer ${this.options.hf_token}`);const s=1e3,a=[];let o;for(let c=0;c<e.length;c+=s){const l=e.slice(c,c+s),u=new FormData;l.forEach(d=>{u.append("files",d)});try{const d=n?`${t}${this.api_prefix}/${wae}?upload_id=${n}`:`${t}${this.api_prefix}/${wae}`;o=await this.fetch(d,{method:"POST",body:u,headers:r,credentials:"include"})}catch(d){throw new Error(GT+d.message)}if(!o.ok){const d=await o.text();return{error:`HTTP ${o.status}: ${d}`}}const h=await o.json();h&&a.push(...h)}return{files:a}}async function s1t(t,e,n,i){let r=(Array.isArray(t)?t:[t]).map(a=>a.blob);const s=r.filter(a=>a.size>(i??1/0));if(s.length)throw new Error(`File size exceeds the maximum allowed size of ${i} bytes: ${s.map(a=>a.name).join(", ")}`);return await Promise.all(await this.upload_files(e,r,n).then(async a=>{if(a.error)throw new Error(a.error);return a.files?a.files.map((o,c)=>new oZ({...t[c],path:o,url:`${e}${this.api_prefix}/file=${o}`})):[]}))}class oZ{constructor({path:e,url:n,orig_name:i,size:r,blob:s,is_stream:a,mime_type:o,alt_text:c,b64:l}){Yi(this,"path"),Yi(this,"url"),Yi(this,"orig_name"),Yi(this,"size"),Yi(this,"blob"),Yi(this,"is_stream"),Yi(this,"mime_type"),Yi(this,"alt_text"),Yi(this,"b64"),Yi(this,"meta",{_type:"gradio.FileData"}),this.path=e,this.url=n,this.orig_name=i,this.size=r,this.blob=n?void 0:s,this.is_stream=a,this.mime_type=o,this.alt_text=c,this.b64=l}}class a1t{constructor(e,n){Yi(this,"type"),Yi(this,"command"),Yi(this,"meta"),Yi(this,"fileData"),this.type="command",this.command=e,this.meta=n}}typeof Gn<"u"&&Gn.versions&&Gn.versions.node;function Aae(t,e,n){for(;n.length>1;){const r=n.shift();if(typeof r=="string"||typeof r=="number")t=t[r];else throw new Error("Invalid key type")}const i=n.shift();if(typeof i=="string"||typeof i=="number")t[i]=e;else throw new Error("Invalid key type")}async function n7(t,e=void 0,n=[],i=!1,r=void 0){if(Array.isArray(t)){let s=[];return await Promise.all(t.map(async(a,o)=>{var c;let l=n.slice();l.push(String(o));const u=await n7(t[o],i?((c=r==null?void 0:r.parameters[o])==null?void 0:c.component)||void 0:e,l,!1,r);s=s.concat(u)})),s}else{if(globalThis.Buffer&&t instanceof globalThis.Buffer||t instanceof Blob)return[{path:n,blob:new Blob([t]),type:e}];if(typeof t=="object"&&t!==null){let s=[];for(const a of Object.keys(t)){const o=[...n,a],c=t[a];s=s.concat(await n7(c,void 0,o,!1,r))}return s}}return[]}function o1t(t,e){var n,i;let r=(i=(n=e==null?void 0:e.dependencies)==null?void 0:n.find(s=>s.id==t))==null?void 0:i.queue;return r!=null?!r:!e.enable_queue}function c1t(t,e){return new Promise((n,i)=>{const r=new MessageChannel;r.port1.onmessage=({data:s})=>{r.port1.close(),n(s)},window.parent.postMessage(t,e,[r.port2])})}function SM(t,e,n,i,r=!1){if(i==="input"&&!r)throw new Error("Invalid code path. Cannot skip state inputs for input.");if(i==="output"&&r)return t;let s=[],a=0;const o=i==="input"?e.inputs:e.outputs;for(let c=0;c<o.length;c++){const l=o[c],u=n.find(h=>h.id===l);if((u==null?void 0:u.type)==="state"){if(r)if(t.length===o.length){const h=t[a];s.push(h),a++}else s.push(null);else{a++;continue}continue}else{const h=t[a];s.push(h),a++}}return s}async function l1t(t,e,n){const i=this;await u1t(i,e);const r=await n7(e,void 0,[],!0,n);return(await Promise.all(r.map(async({path:a,blob:o,type:c})=>{if(!o)return{path:a,type:c};const l=await i.upload_files(t,[o]),u=l.files&&l.files[0];return{path:a,file_url:u,type:c,name:typeof File<"u"&&o instanceof File?o==null?void 0:o.name:void 0}}))).forEach(({path:a,file_url:o,type:c,name:l})=>{if(c==="Gallery")Aae(e,o,a);else if(o){const u=new oZ({path:o,orig_name:l});Aae(e,u,a)}}),e}async function u1t(t,e){var n,i;if(!(((n=t.config)==null?void 0:n.root)||((i=t.config)==null?void 0:i.root_url)))throw new Error(TSe);await RSe(t,e)}async function RSe(t,e,n=[]){for(const i in e)e[i]instanceof a1t?await h1t(t,e,i):typeof e[i]=="object"&&e[i]!==null&&await RSe(t,e[i],[...n,i])}async function h1t(t,e,n){var i,r;let s=e[n];const a=((i=t.config)==null?void 0:i.root)||((r=t.config)==null?void 0:r.root_url);if(!a)throw new Error(TSe);try{let o,c;if(typeof Gn<"u"&&Gn.versions&&Gn.versions.node){const d=await t7(()=>Promise.resolve().then(()=>u$),void 0);c=(await t7(()=>Promise.resolve().then(()=>u$),void 0)).resolve(Gn.cwd(),s.meta.path),o=await d.readFile(c)}else throw new Error(WTt);const l=new Blob([o],{type:"application/octet-stream"}),u=await t.upload_files(a,[l]),h=u.files&&u.files[0];if(h){const d=new oZ({path:h,orig_name:s.meta.name||""});e[n]=d}}catch(o){console.error(YTt,o)}}async function d1t(t,e,n){const i={"Content-Type":"application/json"};this.options.hf_token&&(i.Authorization=`Bearer ${this.options.hf_token}`);try{var r=await this.fetch(t,{method:"POST",body:JSON.stringify(e),headers:{...i,...n},credentials:"include"})}catch{return[{error:GT},500]}let s,a;try{s=await r.json(),a=r.status}catch(o){s={error:`Could not parse server response: ${o}`},a=500}return[s,a]}async function f1t(t,e={}){let n=!1,i=!1;if(!this.config)throw new Error("Could not resolve app config");if(typeof t=="number")this.config.dependencies.find(r=>r.id==t);else{const r=t.replace(/^\//,"");this.config.dependencies.find(s=>s.id==this.api_map[r])}return new Promise(async(r,s)=>{const a=this.submit(t,e,null,null,!0);let o;for await(const c of a)c.type==="data"&&(i&&r(o),n=!0,o=c),c.type==="status"&&(c.stage==="error"&&s(c),c.stage==="complete"&&(i=!0,n&&r(o)))})}async function kO(t,e,n){let i=e==="subdomain"?`https://huggingface.co/api/spaces/by-subdomain/${t}`:`https://huggingface.co/api/spaces/${t}`,r,s;try{if(r=await fetch(i),s=r.status,s!==200)throw new Error;r=await r.json()}catch{n({status:"error",load_status:"error",message:HTt,detail:"NOT_FOUND"});return}if(!r||s!==200)return;const{runtime:{stage:a},id:o}=r;switch(a){case"STOPPED":case"SLEEPING":n({status:"sleeping",load_status:"pending",message:"Space is asleep. Waking it up...",detail:a}),setTimeout(()=>{kO(t,e,n)},1e3);break;case"PAUSED":n({status:"paused",load_status:"error",message:"This space has been paused by the author. If you would like to try this demo, consider duplicating the space.",detail:a,discussions_enabled:await Rae(o)});break;case"RUNNING":case"RUNNING_BUILDING":n({status:"running",load_status:"complete",message:"Space is running.",detail:a});break;case"BUILDING":n({status:"building",load_status:"pending",message:"Space is building...",detail:a}),setTimeout(()=>{kO(t,e,n)},1e3);break;case"APP_STARTING":n({status:"starting",load_status:"pending",message:"Space is starting...",detail:a}),setTimeout(()=>{kO(t,e,n)},1e3);break;default:n({status:"space_error",load_status:"error",message:"This space is experiencing an issue.",detail:a,discussions_enabled:await Rae(o)});break}}const MSe=async(t,e)=>{let n=0;const i=12,r=5e3;return new Promise(s=>{kO(t,aZ.test(t)?"space_name":"subdomain",a=>{e(a),a.status==="running"||a.status==="error"||a.status==="paused"||a.status==="space_error"?s():(a.status==="sleeping"||a.status==="building")&&(n<i?(n++,setTimeout(()=>{MSe(t,e).then(s)},r)):s())})})},p1t=/^(?=[^]*\b[dD]iscussions{0,1}\b)(?=[^]*\b[dD]isabled\b)[^]*$/;async function Rae(t){try{const e=await fetch(`https://huggingface.co/api/spaces/${t}/discussions`,{method:"HEAD"}),n=e.headers.get("x-error-message");return!(!e.ok||n&&p1t.test(n))}catch{return!1}}async function m1t(t,e){const n={};e&&(n.Authorization=`Bearer ${e}`);try{const i=await fetch(`https://huggingface.co/api/spaces/${t}/${DTt}`,{headers:n});if(i.status!==200)throw new Error("Space hardware could not be obtained.");const{hardware:r}=await i.json();return r.current}catch(i){throw new Error(i.message)}}async function g1t(t,e,n){const i={};n&&(i.Authorization=`Bearer ${n}`);const r={seconds:e};try{const s=await fetch(`https://huggingface.co/api/spaces/${t}/${LTt}`,{method:"POST",headers:{"Content-Type":"application/json",...i},body:JSON.stringify(r)});if(s.status!==200)throw new Error("Could not set sleep timeout on duplicated Space. Please visit *ADD HF LINK TO SETTINGS* to set a timeout manually to reduce billing charges.");return await s.json()}catch(s){throw new Error(s.message)}}const Mae=["cpu-basic","cpu-upgrade","cpu-xl","t4-small","t4-medium","a10g-small","a10g-large","a10g-largex2","a10g-largex4","a100-large","zero-a10g","h100","h100x8"];async function v1t(t,e){const{hf_token:n,private:i,hardware:r,timeout:s,auth:a}=e;if(r&&!Mae.includes(r))throw new Error(`Invalid hardware type provided. Valid types are: ${Mae.map(_=>`"${_}"`).join(",")}.`);const{http_protocol:o,host:c}=await q8(t,n);let l=null;if(a){const _=await wSe(o,c,a,fetch);_&&(l=CSe(_))}const u={Authorization:`Bearer ${n}`,"Content-Type":"application/json",...l?{Cookie:l.join("; ")}:{}},h=(await(await fetch("https://huggingface.co/api/whoami-v2",{headers:u})).json()).name,d=t.split("/")[1],f={repository:`${h}/${d}`};i&&(f.private=!0);let p;try{r||(p=await m1t(t,n))}catch(_){throw Error(sZ+_.message)}const g=r||p||"cpu-basic";f.hardware=g;try{const _=await fetch(`https://huggingface.co/api/spaces/${t}/duplicate`,{method:"POST",headers:u,body:JSON.stringify(f)});if(_.status===409)try{return await i7.connect(`${h}/${d}`,e)}catch(b){throw console.error("Failed to connect Client instance:",b),b}else if(_.status!==200)throw new Error(_.statusText);const v=await _.json();return await g1t(`${h}/${d}`,s||300,n),await i7.connect(_1t(v.url),e)}catch(_){throw new Error(_)}}function _1t(t){const e=/https:\/\/huggingface.co\/spaces\/([^/]+\/[^/]+)/,n=t.match(e);if(n)return n[1]}class y1t extends TransformStream{constructor(e={allowCR:!1}){super({transform:(n,i)=>{for(n=EM(this,Qy)+n;;){const r=n.indexOf(`
`),s=e.allowCR?n.indexOf("\r"):-1;if(s!==-1&&s!==n.length-1&&(r===-1||r-1>s)){i.enqueue(n.slice(0,s)),n=n.slice(s+1);continue}if(r===-1)break;const a=n[r-1]==="\r"?r-1:r;i.enqueue(n.slice(0,a)),n=n.slice(r+1)}MTt(this,Qy,n)},flush:n=>{if(EM(this,Qy)==="")return;const i=e.allowCR&&EM(this,Qy).endsWith("\r")?EM(this,Qy).slice(0,-1):EM(this,Qy);n.enqueue(i)}}),RTt(this,Qy,"")}}Qy=new WeakMap;function b1t(t){let e=new TextDecoderStream,n=new y1t({allowCR:!0});return t.pipeThrough(e).pipeThrough(n)}function E1t(t){let n=/[:]\s*/.exec(t),i=n&&n.index;if(i)return[t.substring(0,i),t.substring(i+n[0].length)]}function Oae(t,e,n){t.get(e)||t.set(e,n)}async function*S1t(t,e){if(!t.body)return;let n=b1t(t.body),i,r=n.getReader(),s;for(;;){if(e&&e.aborted)return r.cancel();if(i=await r.read(),i.done)return;if(!i.value){s&&(yield s),s=void 0;continue}let[a,o]=E1t(i.value)||[];a&&(a==="data"?(s||(s={}),s[a]=s[a]?s[a]+`
`+o:o):a==="event"?(s||(s={}),s[a]=o):a==="id"?(s||(s={}),s[a]=+o||o):a==="retry"&&(s||(s={}),s[a]=+o||void 0))}}async function T1t(t,e){let n=new Request(t,e);Oae(n.headers,"Accept","text/event-stream"),Oae(n.headers,"Content-Type","application/json");let i=await fetch(n);if(!i.ok)throw i;return S1t(i,n.signal)}async function x1t(){let{event_callbacks:t,unclosed_events:e,pending_stream_messages:n,stream_status:i,config:r,jwt:s}=this;const a=this;if(!r)throw new Error("Could not resolve app config");i.open=!0;let o=null,c=new URLSearchParams({session_hash:this.session_hash}).toString(),l=new URL(`${r.root}${this.api_prefix}/${bSe}?${c}`);if(s&&l.searchParams.set("__sign",s),o=this.stream(l),!o){console.warn("Cannot connect to SSE endpoint: "+l.toString());return}o.onmessage=async function(u){let h=JSON.parse(u.data);if(h.msg==="close_stream"){IB(i,a.abort_controller);return}const d=h.event_id;if(!d)await Promise.all(Object.keys(t).map(f=>t[f](h)));else if(t[d]&&r){h.msg==="process_completed"&&["sse","sse_v1","sse_v2","sse_v2.1","sse_v3"].includes(r.protocol)&&e.delete(d);let f=t[d];typeof window<"u"&&typeof document<"u"?setTimeout(f,0,h):f(h)}else n[d]||(n[d]=[]),n[d].push(h)},o.onerror=async function(){await Promise.all(Object.keys(t).map(u=>t[u]({msg:"unexpected_error",message:GT})))}}function IB(t,e){t&&(t.open=!1,e==null||e.abort())}function w1t(t,e,n){!t[e]?(t[e]=[],n.data.forEach((r,s)=>{t[e][s]=r})):n.data.forEach((r,s)=>{let a=C1t(t[e][s],r);t[e][s]=a,n.data[s]=a})}function C1t(t,e){return e.forEach(([n,i,r])=>{t=A1t(t,i,n,r)}),t}function A1t(t,e,n,i){if(e.length===0){if(n==="replace")return i;if(n==="append")return t+i;throw new Error(`Unsupported action: ${n}`)}let r=t;for(let a=0;a<e.length-1;a++)r=r[e[a]];const s=e[e.length-1];switch(n){case"replace":r[s]=i;break;case"append":r[s]+=i;break;case"add":Array.isArray(r)?r.splice(Number(s),0,i):r[s]=i;break;case"delete":Array.isArray(r)?r.splice(Number(s),1):delete r[s];break;default:throw new Error(`Unknown action: ${n}`)}return t}function R1t(t,e={}){const n={close:()=>{console.warn("Method not implemented.")},onerror:null,onmessage:null,onopen:null,readyState:0,url:t.toString(),withCredentials:!1,CONNECTING:0,OPEN:1,CLOSED:2,addEventListener:()=>{throw new Error("Method not implemented.")},dispatchEvent:()=>{throw new Error("Method not implemented.")},removeEventListener:()=>{throw new Error("Method not implemented.")}};return T1t(t,e).then(async i=>{n.readyState=n.OPEN;try{for await(const r of i)n.onmessage&&n.onmessage(r);n.readyState=n.CLOSED}catch(r){n.onerror&&n.onerror(r),n.readyState=n.CLOSED}}).catch(i=>{console.error(i),n.onerror&&n.onerror(i),n.readyState=n.CLOSED}),n}function M1t(t,e={},n,i,r){var s;try{let a=function(ze){(r||_e[ze.type])&&u(ze)},o=function(){for(ye=!0;Qe.length>0;)Qe.shift()({value:void 0,done:!0})},c=function(ze){ye||(Qe.length>0?Qe.shift()(ze):Se.push(ze))},l=function(ze){c(O1t(ze)),o()},u=function(ze){c({value:ze,done:!1})},h=function(){return Se.length>0?Promise.resolve(Se.shift()):ye?Promise.resolve({value:void 0,done:!0}):new Promise(ze=>Qe.push(ze))};const{hf_token:d}=this.options,{fetch:f,app_reference:p,config:g,session_hash:_,api_info:v,api_map:b,stream_status:S,pending_stream_messages:x,pending_diff_streams:M,event_callbacks:R,unclosed_events:I,post_data:k,options:P,api_prefix:U}=this,V=this;if(!v)throw new Error("No API found");if(!g)throw new Error("Could not resolve app config");let{fn_index:$,endpoint_info:q,dependency:Y}=N1t(v,t,b,g),te=n1t(e,q),G,J,K=g.protocol??"ws",X="",ae=()=>X;const ce=typeof t=="number"?"/predict":t;let Me,Fe=null,Te=!1,Re={},ge=typeof window<"u"&&typeof document<"u"?new URLSearchParams(window.location.search).toString():"";const _e=((s=P==null?void 0:P.events)==null?void 0:s.reduce((ze,Le)=>(ze[Le]=!0,ze),{}))||{};async function ke(){const ze={stage:"complete",queue:!1,time:new Date};Te=ze,a({...ze,type:"status",endpoint:ce,fn_index:$});let Le={},rt={};K==="ws"?(G&&G.readyState===0?G.addEventListener("open",()=>{G.close()}):G.close(),Le={fn_index:$,session_hash:_}):(IB(S,V.abort_controller),o(),Le={event_id:Fe},rt={event_id:Fe,session_hash:_,fn_index:$});try{if(!g)throw new Error("Could not resolve app config");"event_id"in rt&&await f(`${g.root}${U}/${zTt}`,{headers:{"Content-Type":"application/json"},method:"POST",body:JSON.stringify(rt)}),await f(`${g.root}${U}/${FTt}`,{headers:{"Content-Type":"application/json"},method:"POST",body:JSON.stringify(Le)})}catch{console.warn("The `/reset` endpoint could not be called. Subsequent endpoint results may be unreliable.")}}const gt=async ze=>{await this._resolve_hearbeat(ze)};async function wt(ze){if(!g)return;let Le=ze.render_id;g.components=[...g.components.filter(pt=>pt.props.rendered_in!==Le),...ze.components],g.dependencies=[...g.dependencies.filter(pt=>pt.rendered_in!==Le),...ze.dependencies];const rt=g.components.some(pt=>pt.type==="state"),dt=g.dependencies.some(pt=>pt.targets.some(bt=>bt[1]==="unload"));g.connect_heartbeat=rt||dt,await gt(g),a({type:"render",data:ze,endpoint:ce,fn_index:$})}this.handle_blob(g.root,te,q).then(async ze=>{var Le;if(Me={data:SM(ze,Y,g.components,"input",!0)||[],event_data:n,fn_index:$,trigger_id:i},o1t($,g))a({type:"status",endpoint:ce,stage:"pending",queue:!1,fn_index:$,time:new Date}),k(`${g.root}${U}/run${ce.startsWith("/")?ce:`/${ce}`}${ge?"?"+ge:""}`,{...Me,session_hash:_}).then(([pt,bt])=>{const we=pt.data;bt==200?(a({type:"data",endpoint:ce,fn_index:$,data:SM(we,Y,g.components,"output",P.with_null_state),time:new Date,event_data:n,trigger_id:i}),pt.render_config&&wt(pt.render_config),a({type:"status",endpoint:ce,fn_index:$,stage:"complete",eta:pt.average_duration,queue:!1,time:new Date})):a({type:"status",stage:"error",endpoint:ce,fn_index:$,message:pt.error,queue:!1,time:new Date})}).catch(pt=>{a({type:"status",stage:"error",message:pt.message,endpoint:ce,fn_index:$,queue:!1,time:new Date})});else if(K=="ws"){const{ws_protocol:pt,host:bt}=await q8(p,d);a({type:"status",stage:"pending",queue:!0,endpoint:ce,fn_index:$,time:new Date});let we=new URL(`${pt}://${xSe(bt,g.path,!0)}/queue/join${ge?"?"+ge:""}`);this.jwt&&we.searchParams.set("__sign",this.jwt),G=new WebSocket(we),G.onclose=he=>{he.wasClean||a({type:"status",stage:"error",broken:!0,message:GT,queue:!0,endpoint:ce,fn_index:$,time:new Date})},G.onmessage=function(he){const $e=JSON.parse(he.data),{type:et,status:Et,data:ct}=lV($e,Re[$]);if(et==="update"&&Et&&!Te)a({type:"status",endpoint:ce,fn_index:$,time:new Date,...Et}),Et.stage==="error"&&G.close();else if(et==="hash"){G.send(JSON.stringify({fn_index:$,session_hash:_}));return}else et==="data"?G.send(JSON.stringify({...Me,session_hash:_})):et==="complete"?Te=Et:et==="log"?a({type:"log",title:ct.title,log:ct.log,level:ct.level,endpoint:ce,duration:ct.duration,visible:ct.visible,fn_index:$}):et==="generating"&&a({type:"status",time:new Date,...Et,stage:Et==null?void 0:Et.stage,queue:!0,endpoint:ce,fn_index:$});ct&&(a({type:"data",time:new Date,data:SM(ct.data,Y,g.components,"output",P.with_null_state),endpoint:ce,fn_index:$,event_data:n,trigger_id:i}),Te&&(a({type:"status",time:new Date,...Te,stage:Et==null?void 0:Et.stage,queue:!0,endpoint:ce,fn_index:$}),G.close()))},ySe(g.version||"2.0.0","3.6")<0&&addEventListener("open",()=>G.send(JSON.stringify({hash:_})))}else if(K=="sse"){a({type:"status",stage:"pending",queue:!0,endpoint:ce,fn_index:$,time:new Date});var dt=new URLSearchParams({fn_index:$.toString(),session_hash:_}).toString();let pt=new URL(`${g.root}${U}/${bSe}?${ge?ge+"&":""}${dt}`);if(this.jwt&&pt.searchParams.set("__sign",this.jwt),J=this.stream(pt),!J)return Promise.reject(new Error("Cannot connect to SSE endpoint: "+pt.toString()));J.onmessage=async function(bt){const we=JSON.parse(bt.data),{type:he,status:$e,data:et}=lV(we,Re[$]);if(he==="update"&&$e&&!Te)a({type:"status",endpoint:ce,fn_index:$,time:new Date,...$e}),$e.stage==="error"&&(J==null||J.close(),o());else if(he==="data"){let[Et,ct]=await k(`${g.root}${U}/queue/data`,{...Me,session_hash:_,event_id:Fe});ct!==200&&(a({type:"status",stage:"error",message:GT,queue:!0,endpoint:ce,fn_index:$,time:new Date}),J==null||J.close(),o())}else he==="complete"?Te=$e:he==="log"?a({type:"log",title:et.title,log:et.log,level:et.level,endpoint:ce,duration:et.duration,visible:et.visible,fn_index:$}):(he==="generating"||he==="streaming")&&a({type:"status",time:new Date,...$e,stage:$e==null?void 0:$e.stage,queue:!0,endpoint:ce,fn_index:$});et&&(a({type:"data",time:new Date,data:SM(et.data,Y,g.components,"output",P.with_null_state),endpoint:ce,fn_index:$,event_data:n,trigger_id:i}),Te&&(a({type:"status",time:new Date,...Te,stage:$e==null?void 0:$e.stage,queue:!0,endpoint:ce,fn_index:$}),J==null||J.close(),o()))}}else if(K=="sse_v1"||K=="sse_v2"||K=="sse_v2.1"||K=="sse_v3"){a({type:"status",stage:"pending",queue:!0,endpoint:ce,fn_index:$,time:new Date});let pt="";typeof window<"u"&&typeof document<"u"&&(pt=(Le=window==null?void 0:window.location)==null?void 0:Le.hostname);const we=pt.includes(".dev.")?`https://moon-${pt.split(".")[1]}.dev.spaces.huggingface.tech`:"https://huggingface.co";(typeof window<"u"&&typeof document<"u"&&window.parent!=window&&window.supports_zerogpu_headers?c1t("zerogpu-headers",we):Promise.resolve(null)).then(Et=>k(`${g.root}${U}/${NTt}?${ge}`,{...Me,session_hash:_},Et)).then(async([Et,ct])=>{if(ct===503)a({type:"status",stage:"error",message:ESe,queue:!0,endpoint:ce,fn_index:$,time:new Date});else if(ct!==200)a({type:"status",stage:"error",message:GT,queue:!0,endpoint:ce,fn_index:$,time:new Date});else{Fe=Et.event_id,X=Fe;let tn=async function(Ht){try{const{type:pn,status:le,data:z,original_msg:W}=lV(Ht,Re[$]);if(pn=="heartbeat")return;if(pn==="update"&&le&&!Te)a({type:"status",endpoint:ce,fn_index:$,time:new Date,original_msg:W,...le});else if(pn==="complete")Te=le;else if(pn=="unexpected_error")console.error("Unexpected error",le==null?void 0:le.message),a({type:"status",stage:"error",message:(le==null?void 0:le.message)||"An Unexpected Error Occurred!",queue:!0,endpoint:ce,fn_index:$,time:new Date});else if(pn==="log"){a({type:"log",title:z.title,log:z.log,level:z.level,endpoint:ce,duration:z.duration,visible:z.visible,fn_index:$});return}else(pn==="generating"||pn==="streaming")&&(a({type:"status",time:new Date,...le,stage:le==null?void 0:le.stage,queue:!0,endpoint:ce,fn_index:$}),z&&Y.connection!=="stream"&&["sse_v2","sse_v2.1","sse_v3"].includes(K)&&w1t(M,Fe,z));z&&(a({type:"data",time:new Date,data:SM(z.data,Y,g.components,"output",P.with_null_state),endpoint:ce,fn_index:$}),z.render_config&&await wt(z.render_config),Te&&(a({type:"status",time:new Date,...Te,stage:le==null?void 0:le.stage,queue:!0,endpoint:ce,fn_index:$}),o())),((le==null?void 0:le.stage)==="complete"||(le==null?void 0:le.stage)==="error")&&(R[Fe]&&delete R[Fe],Fe in M&&delete M[Fe])}catch(pn){console.error("Unexpected client exception",pn),a({type:"status",stage:"error",message:"An Unexpected Error Occurred!",queue:!0,endpoint:ce,fn_index:$,time:new Date}),["sse_v2","sse_v2.1","sse_v3"].includes(K)&&(IB(S,V.abort_controller),S.open=!1,o())}};Fe in x&&(x[Fe].forEach(Ht=>tn(Ht)),delete x[Fe]),R[Fe]=tn,I.add(Fe),S.open||await this.open_stream()}})}});let ye=!1;const Se=[],Qe=[],pe={[Symbol.asyncIterator]:()=>pe,next:h,throw:async ze=>(l(ze),h()),return:async()=>(o(),h()),cancel:ke,event_id:ae};return pe}catch(a){throw console.error("Submit function encountered an error:",a),a}}function O1t(t){return{then:(e,n)=>n(t)}}function N1t(t,e,n,i){let r,s,a;if(typeof e=="number")r=e,s=t.unnamed_endpoints[r],a=i.dependencies.find(o=>o.id==e);else{const o=e.replace(/^\//,"");r=n[o],s=t.named_endpoints[e.trim()],a=i.dependencies.find(c=>c.id==n[o])}if(typeof r!="number")throw new Error("There is no endpoint matching that name of fn_index matching that number.");return{fn_index:r,endpoint_info:s,dependency:a}}class i7{constructor(e,n={events:["data"]}){Yi(this,"app_reference"),Yi(this,"options"),Yi(this,"config"),Yi(this,"api_prefix",""),Yi(this,"api_info"),Yi(this,"api_map",{}),Yi(this,"session_hash",Math.random().toString(36).substring(2)),Yi(this,"jwt",!1),Yi(this,"last_status",{}),Yi(this,"cookies",null),Yi(this,"stream_status",{open:!1}),Yi(this,"pending_stream_messages",{}),Yi(this,"pending_diff_streams",{}),Yi(this,"event_callbacks",{}),Yi(this,"unclosed_events",new Set),Yi(this,"heartbeat_event",null),Yi(this,"abort_controller",null),Yi(this,"stream_instance",null),Yi(this,"current_payload"),Yi(this,"ws_map",{}),Yi(this,"view_api"),Yi(this,"upload_files"),Yi(this,"upload"),Yi(this,"handle_blob"),Yi(this,"post_data"),Yi(this,"submit"),Yi(this,"predict"),Yi(this,"open_stream"),Yi(this,"resolve_config"),Yi(this,"resolve_cookies"),this.app_reference=e,n.events||(n.events=["data"]),this.options=n,this.current_payload={},this.view_api=i1t.bind(this),this.upload_files=r1t.bind(this),this.handle_blob=l1t.bind(this),this.post_data=d1t.bind(this),this.submit=M1t.bind(this),this.predict=f1t.bind(this),this.open_stream=x1t.bind(this),this.resolve_config=XTt.bind(this),this.resolve_cookies=ZTt.bind(this),this.upload=s1t.bind(this),this.fetch=this.fetch.bind(this),this.handle_space_success=this.handle_space_success.bind(this),this.stream=this.stream.bind(this)}get_url_config(e=null){if(!this.config)throw new Error(lb);e===null&&(e=window.location.href);const n=a=>a.replace(/^\/+|\/+$/g,"");let i=n(new URL(this.config.root).pathname),r=n(new URL(e).pathname),s;return r.startsWith(i)?s=n(r.substring(i.length)):s="",this.get_page_config(s)}get_page_config(e){if(!this.config)throw new Error(lb);let n=this.config;return e in n.page||(e=""),{...n,current_page:e,layout:n.page[e].layout,components:n.components.filter(i=>n.page[e].components.includes(i.id)),dependencies:this.config.dependencies.filter(i=>n.page[e].dependencies.includes(i.id))}}fetch(e,n){const i=new Headers((n==null?void 0:n.headers)||{});if(this&&this.cookies&&i.append("Cookie",this.cookies),this&&this.options.headers)for(const r in this.options.headers)i.append(r,this.options.headers[r]);return fetch(e,{...n,headers:i})}stream(e){const n=new Headers;if(this&&this.cookies&&n.append("Cookie",this.cookies),this&&this.options.headers)for(const i in this.options.headers)n.append(i,this.options.headers[i]);return this.abort_controller=new AbortController,this.stream_instance=R1t(e.toString(),{credentials:"include",headers:n,signal:this.abort_controller.signal}),this.stream_instance}async init(){var e;if((typeof window>"u"||!("WebSocket"in window))&&!bm.WebSocket){const n=await t7(()=>import("./wrapper-CviSselG-BPHUEp0d.js"),[]);bm.WebSocket=n.WebSocket}this.options.auth&&await this.resolve_cookies(),await this._resolve_config().then(({config:n})=>this._resolve_hearbeat(n)),this.api_info=await this.view_api(),this.api_map=KTt(((e=this.config)==null?void 0:e.dependencies)||[])}async _resolve_hearbeat(e){if(e&&(this.config=e,this.api_prefix=e.api_prefix||"",this.config&&this.config.connect_heartbeat&&this.config.space_id&&this.options.hf_token&&(this.jwt=await Cae(this.config.space_id,this.options.hf_token,this.cookies))),e.space_id&&this.options.hf_token&&(this.jwt=await Cae(e.space_id,this.options.hf_token)),this.config&&this.config.connect_heartbeat){const n=new URL(`${this.config.root}${this.api_prefix}/${UTt}/${this.session_hash}`);this.jwt&&n.searchParams.set("__sign",this.jwt),this.heartbeat_event||(this.heartbeat_event=this.stream(n))}}static async connect(e,n={events:["data"]}){const i=new this(e,n);return await i.init(),i}close(){IB(this.stream_status,this.abort_controller)}set_current_payload(e){this.current_payload=e}static async duplicate(e,n={events:["data"]}){return v1t(e,n)}async _resolve_config(){const{http_protocol:e,host:n,space_id:i}=await q8(this.app_reference,this.options.hf_token),{status_callback:r}=this.options;i&&r&&await MSe(i,r);let s;try{if(s=await this.resolve_config(`${e}//${n}`),!s)throw new Error(lb);return this.config_success(s)}catch(a){if(i&&r)kO(i,aZ.test(i)?"space_name":"subdomain",this.handle_space_success);else throw r&&r({status:"error",message:"Could not load this space.",load_status:"error",detail:"NOT_FOUND"}),Error(a)}}async config_success(e){if(this.config=e,this.api_prefix=e.api_prefix||"",typeof window<"u"&&typeof document<"u"&&window.location.protocol==="https:"&&(this.config.root=this.config.root.replace("http://","https://")),this.config.auth_required)return this.prepare_return_obj();try{this.api_info=await this.view_api()}catch(n){console.error(VTt+n.message)}return this.prepare_return_obj()}async handle_space_success(e){var n;if(!this)throw new Error(lb);const{status_callback:i}=this.options;if(i&&i(e),e.status==="running")try{if(this.config=await this._resolve_config(),this.api_prefix=((n=this==null?void 0:this.config)==null?void 0:n.api_prefix)||"",!this.config)throw new Error(lb);return await this.config_success(this.config)}catch(r){throw i&&i({status:"error",message:"Could not load this space.",load_status:"error",detail:"NOT_FOUND"}),r}}async component_server(e,n,i){var r;if(!this.config)throw new Error(lb);const s={},{hf_token:a}=this.options,{session_hash:o}=this;a&&(s.Authorization=`Bearer ${this.options.hf_token}`);let c,l=this.config.components.find(h=>h.id===e);(r=l==null?void 0:l.props)!=null&&r.root_url?c=l.props.root_url:c=this.config.root;let u;if("binary"in i){u=new FormData;for(const h in i.data)h!=="binary"&&u.append(h,i.data[h]);u.set("component_id",e.toString()),u.set("fn_name",n),u.set("session_hash",o)}else u=JSON.stringify({data:i,component_id:e,fn_name:n,session_hash:o}),s["Content-Type"]="application/json";a&&(s.Authorization=`Bearer ${a}`);try{const h=await this.fetch(`${c}${this.api_prefix}/${BTt}/`,{method:"POST",body:u,headers:s,credentials:"include"});if(!h.ok)throw new Error("Could not connect to component server: "+h.statusText);return await h.json()}catch(h){console.warn(h)}}set_cookies(e){this.cookies=CSe(e).join("; ")}prepare_return_obj(){return{config:this.config,predict:this.predict,submit:this.submit,view_api:this.view_api,component_server:this.component_server}}async connect_ws(e){return new Promise((n,i)=>{let r;try{r=new WebSocket(e)}catch{this.ws_map[e]="failed";return}r.onopen=()=>{n()},r.onerror=s=>{console.error("WebSocket error:",s),this.close_ws(e),this.ws_map[e]="failed",n()},r.onclose=()=>{delete this.ws_map[e],this.ws_map[e]="failed"},r.onmessage=s=>{},this.ws_map[e]=r})}async send_ws_message(e,n){e in this.ws_map||await this.connect_ws(e);const i=this.ws_map[e];i instanceof WebSocket?i.send(JSON.stringify(n)):this.post_data(e,n)}async close_ws(e){if(e in this.ws_map){const n=this.ws_map[e];n instanceof WebSocket&&(n.close(),delete this.ws_map[e])}}}function k1(t){"@babel/helpers - typeof";return k1=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},k1(t)}function tf(){tf=function(){return e};var t,e={},n=Object.prototype,i=n.hasOwnProperty,r=Object.defineProperty||function(G,J,K){G[J]=K.value},s=typeof Symbol=="function"?Symbol:{},a=s.iterator||"@@iterator",o=s.asyncIterator||"@@asyncIterator",c=s.toStringTag||"@@toStringTag";function l(G,J,K){return Object.defineProperty(G,J,{value:K,enumerable:!0,configurable:!0,writable:!0}),G[J]}try{l({},"")}catch{l=function(K,X,ae){return K[X]=ae}}function u(G,J,K,X){var ae=J&&J.prototype instanceof v?J:v,ce=Object.create(ae.prototype),Me=new Y(X||[]);return r(ce,"_invoke",{value:U(G,K,Me)}),ce}function h(G,J,K){try{return{type:"normal",arg:G.call(J,K)}}catch(X){return{type:"throw",arg:X}}}e.wrap=u;var d="suspendedStart",f="suspendedYield",p="executing",g="completed",_={};function v(){}function b(){}function S(){}var x={};l(x,a,function(){return this});var M=Object.getPrototypeOf,R=M&&M(M(te([])));R&&R!==n&&i.call(R,a)&&(x=R);var I=S.prototype=v.prototype=Object.create(x);function k(G){["next","throw","return"].forEach(function(J){l(G,J,function(K){return this._invoke(J,K)})})}function P(G,J){function K(ae,ce,Me,Fe){var Te=h(G[ae],G,ce);if(Te.type!=="throw"){var Re=Te.arg,ge=Re.value;return ge&&k1(ge)=="object"&&i.call(ge,"__await")?J.resolve(ge.__await).then(function(_e){K("next",_e,Me,Fe)},function(_e){K("throw",_e,Me,Fe)}):J.resolve(ge).then(function(_e){Re.value=_e,Me(Re)},function(_e){return K("throw",_e,Me,Fe)})}Fe(Te.arg)}var X;r(this,"_invoke",{value:function(ce,Me){function Fe(){return new J(function(Te,Re){K(ce,Me,Te,Re)})}return X=X?X.then(Fe,Fe):Fe()}})}function U(G,J,K){var X=d;return function(ae,ce){if(X===p)throw Error("Generator is already running");if(X===g){if(ae==="throw")throw ce;return{value:t,done:!0}}for(K.method=ae,K.arg=ce;;){var Me=K.delegate;if(Me){var Fe=V(Me,K);if(Fe){if(Fe===_)continue;return Fe}}if(K.method==="next")K.sent=K._sent=K.arg;else if(K.method==="throw"){if(X===d)throw X=g,K.arg;K.dispatchException(K.arg)}else K.method==="return"&&K.abrupt("return",K.arg);X=p;var Te=h(G,J,K);if(Te.type==="normal"){if(X=K.done?g:f,Te.arg===_)continue;return{value:Te.arg,done:K.done}}Te.type==="throw"&&(X=g,K.method="throw",K.arg=Te.arg)}}}function V(G,J){var K=J.method,X=G.iterator[K];if(X===t)return J.delegate=null,K==="throw"&&G.iterator.return&&(J.method="return",J.arg=t,V(G,J),J.method==="throw")||K!=="return"&&(J.method="throw",J.arg=new TypeError("The iterator does not provide a '"+K+"' method")),_;var ae=h(X,G.iterator,J.arg);if(ae.type==="throw")return J.method="throw",J.arg=ae.arg,J.delegate=null,_;var ce=ae.arg;return ce?ce.done?(J[G.resultName]=ce.value,J.next=G.nextLoc,J.method!=="return"&&(J.method="next",J.arg=t),J.delegate=null,_):ce:(J.method="throw",J.arg=new TypeError("iterator result is not an object"),J.delegate=null,_)}function $(G){var J={tryLoc:G[0]};1 in G&&(J.catchLoc=G[1]),2 in G&&(J.finallyLoc=G[2],J.afterLoc=G[3]),this.tryEntries.push(J)}function q(G){var J=G.completion||{};J.type="normal",delete J.arg,G.completion=J}function Y(G){this.tryEntries=[{tryLoc:"root"}],G.forEach($,this),this.reset(!0)}function te(G){if(G||G===""){var J=G[a];if(J)return J.call(G);if(typeof G.next=="function")return G;if(!isNaN(G.length)){var K=-1,X=function ae(){for(;++K<G.length;)if(i.call(G,K))return ae.value=G[K],ae.done=!1,ae;return ae.value=t,ae.done=!0,ae};return X.next=X}}throw new TypeError(k1(G)+" is not iterable")}return b.prototype=S,r(I,"constructor",{value:S,configurable:!0}),r(S,"constructor",{value:b,configurable:!0}),b.displayName=l(S,c,"GeneratorFunction"),e.isGeneratorFunction=function(G){var J=typeof G=="function"&&G.constructor;return!!J&&(J===b||(J.displayName||J.name)==="GeneratorFunction")},e.mark=function(G){return Object.setPrototypeOf?Object.setPrototypeOf(G,S):(G.__proto__=S,l(G,c,"GeneratorFunction")),G.prototype=Object.create(I),G},e.awrap=function(G){return{__await:G}},k(P.prototype),l(P.prototype,o,function(){return this}),e.AsyncIterator=P,e.async=function(G,J,K,X,ae){ae===void 0&&(ae=Promise);var ce=new P(u(G,J,K,X),ae);return e.isGeneratorFunction(J)?ce:ce.next().then(function(Me){return Me.done?Me.value:ce.next()})},k(I),l(I,c,"Generator"),l(I,a,function(){return this}),l(I,"toString",function(){return"[object Generator]"}),e.keys=function(G){var J=Object(G),K=[];for(var X in J)K.push(X);return K.reverse(),function ae(){for(;K.length;){var ce=K.pop();if(ce in J)return ae.value=ce,ae.done=!1,ae}return ae.done=!0,ae}},e.values=te,Y.prototype={constructor:Y,reset:function(J){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(q),!J)for(var K in this)K.charAt(0)==="t"&&i.call(this,K)&&!isNaN(+K.slice(1))&&(this[K]=t)},stop:function(){this.done=!0;var J=this.tryEntries[0].completion;if(J.type==="throw")throw J.arg;return this.rval},dispatchException:function(J){if(this.done)throw J;var K=this;function X(Re,ge){return Me.type="throw",Me.arg=J,K.next=Re,ge&&(K.method="next",K.arg=t),!!ge}for(var ae=this.tryEntries.length-1;ae>=0;--ae){var ce=this.tryEntries[ae],Me=ce.completion;if(ce.tryLoc==="root")return X("end");if(ce.tryLoc<=this.prev){var Fe=i.call(ce,"catchLoc"),Te=i.call(ce,"finallyLoc");if(Fe&&Te){if(this.prev<ce.catchLoc)return X(ce.catchLoc,!0);if(this.prev<ce.finallyLoc)return X(ce.finallyLoc)}else if(Fe){if(this.prev<ce.catchLoc)return X(ce.catchLoc,!0)}else{if(!Te)throw Error("try statement without catch or finally");if(this.prev<ce.finallyLoc)return X(ce.finallyLoc)}}}},abrupt:function(J,K){for(var X=this.tryEntries.length-1;X>=0;--X){var ae=this.tryEntries[X];if(ae.tryLoc<=this.prev&&i.call(ae,"finallyLoc")&&this.prev<ae.finallyLoc){var ce=ae;break}}ce&&(J==="break"||J==="continue")&&ce.tryLoc<=K&&K<=ce.finallyLoc&&(ce=null);var Me=ce?ce.completion:{};return Me.type=J,Me.arg=K,ce?(this.method="next",this.next=ce.finallyLoc,_):this.complete(Me)},complete:function(J,K){if(J.type==="throw")throw J.arg;return J.type==="break"||J.type==="continue"?this.next=J.arg:J.type==="return"?(this.rval=this.arg=J.arg,this.method="return",this.next="end"):J.type==="normal"&&K&&(this.next=K),_},finish:function(J){for(var K=this.tryEntries.length-1;K>=0;--K){var X=this.tryEntries[K];if(X.finallyLoc===J)return this.complete(X.completion,X.afterLoc),q(X),_}},catch:function(J){for(var K=this.tryEntries.length-1;K>=0;--K){var X=this.tryEntries[K];if(X.tryLoc===J){var ae=X.completion;if(ae.type==="throw"){var ce=ae.arg;q(X)}return ce}}throw Error("illegal catch attempt")},delegateYield:function(J,K,X){return this.delegate={iterator:te(J),resultName:K,nextLoc:X},this.method==="next"&&(this.arg=t),_}},e}function Nae(t,e,n,i,r,s,a){try{var o=t[s](a),c=o.value}catch(l){return void n(l)}o.done?e(c):Promise.resolve(c).then(i,r)}function OC(t){return function(){var e=this,n=arguments;return new Promise(function(i,r){var s=t.apply(e,n);function a(c){Nae(s,i,r,a,o,"next",c)}function o(c){Nae(s,i,r,a,o,"throw",c)}a(void 0)})}}function I1t(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function k1t(t,e){if(k1(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(k1(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function OSe(t){var e=k1t(t,"string");return k1(e)=="symbol"?e:e+""}function P1t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,OSe(i.key),i)}}function D1t(t,e,n){return e&&P1t(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t}function Pg(t,e,n){return(e=OSe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}const wL={"ar-SA":["ar-SA-HamedNeural","ar-SA-ZariyahNeural"],"de-DE":["de-DE-AmalaNeural","de-DE-ConradNeural","de-DE-KatjaNeural","de-DE-KillianNeural"],"en-US":["en-US-AriaNeural","en-US-AnaNeural","en-US-ChristopherNeural","en-US-EricNeural","en-US-GuyNeural","en-US-JennyNeural","en-US-MichelleNeural","en-US-RogerNeural","en-US-SteffanNeural"],"es-ES":["es-ES-AlvaroNeural","es-ES-ElviraNeural"],"fr-FR":["fr-FR-DeniseNeural","fr-FR-EloiseNeural","fr-FR-HenriNeural"],"ja-JP":["ja-JP-KeitaNeural","ja-JP-NanamiNeural"],"ko-KR":["ko-KR-InJoonNeural","ko-KR-SunHiNeural"],"pt-BR":["pt-BR-AntonioNeural","pt-BR-FranciscaNeural"],"ru-RU":["ru-RU-DmitryNeural","ru-RU-SvetlanaNeural"],"zh-CN":["zh-CN-XiaoxiaoNeural","zh-CN-XiaoyiNeural","zh-CN-YunjianNeural","zh-CN-liaoning-XiaobeiNeural","zh-CN-shaanxi-XiaoniNeural","zh-CN-YunxiNeural","zh-CN-YunxiaNeural","zh-CN-YunyangNeural"],"zh-TW":["zh-TW-HsiaoChenNeural","zh-TW-YunJheNeural","zh-TW-HsiaoYuNeural"]},CL={"ar-SA-HamedNeural":"","ar-SA-ZariyahNeural":"","de-DE-AmalaNeural":"Amala","de-DE-BerndNeural":"Bernd","de-DE-ChristophNeural":"Christoph","de-DE-ConradNeural":"Conrad","de-DE-ElkeNeural":"Elke","de-DE-GiselaNeural":"Gisela","de-DE-KasperNeural":"Kasper","de-DE-KatjaNeural":"Katja","de-DE-KillianNeural":"Killian","de-DE-KlarissaNeural":"Klarissa","de-DE-KlausNeural":"Klaus","de-DE-LouisaNeural":"Louisa","de-DE-MajaNeural":"Maja","de-DE-RalfNeural":"Ralf","de-DE-TanjaNeural":"Tanja","en-US-AIGenerate1Neural":"AIGenerate1","en-US-AIGenerate2Neural":"AIGenerate2","en-US-AmberNeural":"Amber","en-US-AnaNeural":"Ana","en-US-AndrewNeural":"Andrew","en-US-AriaNeural":"Aria","en-US-AshleyNeural":"Ashley","en-US-BlueNeural":"Blue","en-US-BrandonNeural":"Brandon","en-US-BrianNeural":"Brian","en-US-ChristopherNeural":"Christopher","en-US-CoraNeural":"Cora","en-US-DavisNeural":"Davis","en-US-ElizabethNeural":"Elizabeth","en-US-EmmaNeural":"Emma","en-US-EricNeural":"Eric","en-US-GuyNeural":"Guy","en-US-JacobNeural":"Jacob","en-US-JaneNeural":"Jane","en-US-JasonNeural":"Jason","en-US-JennyMultilingualNeural":"Jenny Multilingual","en-US-JennyMultilingualV2Neural":"Jenny Multilingual V2","en-US-JennyNeural":"Jenny","en-US-MichelleNeural":"Michelle","en-US-MonicaNeural":"Monica","en-US-NancyNeural":"Nancy","en-US-RogerNeural":"Roger","en-US-RyanMultilingualNeural":"Ryan Multilingual","en-US-SaraNeural":"Sara","en-US-SteffanNeural":"Steffan","en-US-TonyNeural":"Tony","es-ES-AbrilNeural":"Abril","es-ES-AlvaroNeural":"lvaro","es-ES-ArnauNeural":"Arnau","es-ES-DarioNeural":"Dario","es-ES-EliasNeural":"Elias","es-ES-ElviraNeural":"Elvira","es-ES-EstrellaNeural":"Estrella","es-ES-IreneNeural":"Irene","es-ES-LaiaNeural":"Laia","es-ES-LiaNeural":"Lia","es-ES-NilNeural":"Nil","es-ES-SaulNeural":"Saul","es-ES-TeoNeural":"Teo","es-ES-TrianaNeural":"Triana","es-ES-VeraNeural":"Vera","fr-FR-AlainNeural":"Alain","fr-FR-BrigitteNeural":"Brigitte","fr-FR-CelesteNeural":"Celeste","fr-FR-ClaudeNeural":"Claude","fr-FR-CoralieNeural":"Coralie","fr-FR-DeniseNeural":"Denise","fr-FR-EloiseNeural":"Eloise","fr-FR-HenriNeural":"Henri","fr-FR-JacquelineNeural":"Jacqueline","fr-FR-JeromeNeural":"Jerome","fr-FR-JosephineNeural":"Josephine","fr-FR-MauriceNeural":"Maurice","fr-FR-YvesNeural":"Yves","fr-FR-YvetteNeural":"Yvette","ja-JP-AoiNeural":"","ja-JP-DaichiNeural":"","ja-JP-KeitaNeural":"","ja-JP-MayuNeural":"","ja-JP-NanamiNeural":"","ja-JP-NaokiNeural":"","ja-JP-ShioriNeural":"","ko-KR-BongJinNeural":"","ko-KR-GookMinNeural":"","ko-KR-InJoonNeural":"","ko-KR-JiMinNeural":"","ko-KR-SeoHyeonNeural":"","ko-KR-SoonBokNeural":"","ko-KR-SunHiNeural":"","ko-KR-YuJinNeural":"","pt-BR-AntonioNeural":"Antnio","pt-BR-BrendaNeural":"Brenda","pt-BR-DonatoNeural":"Donato","pt-BR-ElzaNeural":"Elza","pt-BR-FabioNeural":"Fabio","pt-BR-FranciscaNeural":"Francisca","pt-BR-GiovannaNeural":"Giovanna","pt-BR-HumbertoNeural":"Humberto","pt-BR-JulioNeural":"Julio","pt-BR-LeilaNeural":"Leila","pt-BR-LeticiaNeural":"Leticia","pt-BR-ManuelaNeural":"Manuela","pt-BR-NicolauNeural":"Nicolau","pt-BR-ValerioNeural":"Valerio","pt-BR-YaraNeural":"Yara","ru-RU-DariyaNeural":"","ru-RU-DmitryNeural":"","ru-RU-SvetlanaNeural":"","wuu-CN-XiaotongNeural":"","wuu-CN-YunzheNeural":"","yue-CN-XiaoMinNeural":"","yue-CN-YunSongNeural":"","zh-CN-XiaochenNeural":"","zh-CN-XiaohanNeural":"","zh-CN-XiaomengNeural":"","zh-CN-XiaomoNeural":"","zh-CN-XiaoqiuNeural":"","zh-CN-XiaorouNeural":"","zh-CN-XiaoruiNeural":"","zh-CN-XiaoshuangNeural":"","zh-CN-XiaoxiaoNeural":"","zh-CN-XiaoxuanNeural":"","zh-CN-XiaoyanNeural":"","zh-CN-XiaoyiNeural":"","zh-CN-XiaoyouNeural":"","zh-CN-XiaozhenNeural":"","zh-CN-YunfengNeural":"","zh-CN-YunhaoNeural":"","zh-CN-YunjianNeural":"","zh-CN-YunjieNeural":"","zh-CN-YunxiNeural":"","zh-CN-YunxiaNeural":"","zh-CN-YunyangNeural":"","zh-CN-YunyeNeural":"","zh-CN-YunzeNeural":"","zh-CN-guangxi-YunqiNeural":"","zh-CN-henan-YundengNeural":"","zh-CN-liaoning-XiaobeiNeural":"","zh-CN-liaoning-YunbiaoNeural":"","zh-CN-shaanxi-XiaoniNeural":"","zh-CN-shandong-YunxiangNeural":"","zh-CN-sichuan-YunxiNeural":"","zh-TW-HsiaoChenNeural":"","zh-TW-HsiaoYuNeural":"","zh-TW-YunJheNeural":""};var L1t=function(){var t=OC(tf().mark(function e(n){var i;return tf().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return i=new AudioContext,s.next=3,i.decodeAudioData(n);case 3:return s.abrupt("return",s.sent);case 4:case"end":return s.stop()}},e)}));return function(n){return t.apply(this,arguments)}}();function U1t(t){if(Array.isArray(t))return t}function B1t(t,e){var n=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(n!=null){var i,r,s,a,o=[],c=!0,l=!1;try{if(s=(n=n.call(t)).next,e!==0)for(;!(c=(i=s.call(n)).done)&&(o.push(i.value),o.length!==e);c=!0);}catch(u){l=!0,r=u}finally{try{if(!c&&n.return!=null&&(a=n.return(),Object(a)!==a))return}finally{if(l)throw r}}return o}}function Iae(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,i=Array(e);n<e;n++)i[n]=t[n];return i}function NSe(t,e){if(t){if(typeof t=="string")return Iae(t,e);var n={}.toString.call(t).slice(8,-1);return n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set"?Array.from(t):n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Iae(t,e):void 0}}function F1t(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function cZ(t,e){return U1t(t)||B1t(t,e)||NSe(t,e)||F1t()}const z1t={"ar-SA":"","de-DE":"Deutsch","en-US":"English","es-ES":"Espaol","fr-FR":"Franais","ja-JP":"","ko-KR":"","pt-BR":"Portugus","ru-RU":"","zh-CN":"","zh-TW":""};var j1t=function(){return Object.entries(z1t).map(function(e){var n=cZ(e,2),i=n[0],r=n[1];return{label:r,value:i}})};const ISe="%[a-f0-9]{2}",kae=new RegExp("("+ISe+")|([^%]+?)","gi"),Pae=new RegExp("("+ISe+")+","gi");function r7(t,e){try{return[decodeURIComponent(t.join(""))]}catch{}if(t.length===1)return t;e=e||1;const n=t.slice(0,e),i=t.slice(e);return Array.prototype.concat.call([],r7(n),r7(i))}function H1t(t){try{return decodeURIComponent(t)}catch{let e=t.match(kae)||[];for(let n=1;n<e.length;n++)t=r7(e,n).join(""),e=t.match(kae)||[];return t}}function V1t(t){const e={"%FE%FF":"","%FF%FE":""};let n=Pae.exec(t);for(;n;){try{e[n[0]]=decodeURIComponent(n[0])}catch{const r=H1t(n[0]);r!==n[0]&&(e[n[0]]=r)}n=Pae.exec(t)}e["%C2"]="";const i=Object.keys(e);for(const r of i)t=t.replace(new RegExp(r,"g"),e[r]);return t}function G1t(t){if(typeof t!="string")throw new TypeError("Expected `encodedURI` to be of type `string`, got `"+typeof t+"`");try{return decodeURIComponent(t)}catch{return V1t(t)}}function q1t(t,e){const n={};if(Array.isArray(e))for(const i of e){const r=Object.getOwnPropertyDescriptor(t,i);r!=null&&r.enumerable&&Object.defineProperty(n,i,r)}else for(const i of Reflect.ownKeys(t)){const r=Object.getOwnPropertyDescriptor(t,i);if(r.enumerable){const s=t[i];e(i,s,t)&&Object.defineProperty(n,i,r)}}return n}function kSe(t,e){if(!(typeof t=="string"&&typeof e=="string"))throw new TypeError("Expected the arguments to be of type `string`");if(t===""||e==="")return[];const n=t.indexOf(e);return n===-1?[]:[t.slice(0,n),t.slice(n+e.length)]}const $1t=t=>t==null,W1t=t=>encodeURIComponent(t).replaceAll(/[!'()*]/g,e=>`%${e.charCodeAt(0).toString(16).toUpperCase()}`),s7=Symbol("encodeFragmentIdentifier");function Y1t(t){switch(t.arrayFormat){case"index":return e=>(n,i)=>{const r=n.length;return i===void 0||t.skipNull&&i===null||t.skipEmptyString&&i===""?n:i===null?[...n,[mc(e,t),"[",r,"]"].join("")]:[...n,[mc(e,t),"[",mc(r,t),"]=",mc(i,t)].join("")]};case"bracket":return e=>(n,i)=>i===void 0||t.skipNull&&i===null||t.skipEmptyString&&i===""?n:i===null?[...n,[mc(e,t),"[]"].join("")]:[...n,[mc(e,t),"[]=",mc(i,t)].join("")];case"colon-list-separator":return e=>(n,i)=>i===void 0||t.skipNull&&i===null||t.skipEmptyString&&i===""?n:i===null?[...n,[mc(e,t),":list="].join("")]:[...n,[mc(e,t),":list=",mc(i,t)].join("")];case"comma":case"separator":case"bracket-separator":{const e=t.arrayFormat==="bracket-separator"?"[]=":"=";return n=>(i,r)=>r===void 0||t.skipNull&&r===null||t.skipEmptyString&&r===""?i:(r=r===null?"":r,i.length===0?[[mc(n,t),e,mc(r,t)].join("")]:[[i,mc(r,t)].join(t.arrayFormatSeparator)])}default:return e=>(n,i)=>i===void 0||t.skipNull&&i===null||t.skipEmptyString&&i===""?n:i===null?[...n,mc(e,t)]:[...n,[mc(e,t),"=",mc(i,t)].join("")]}}function K1t(t){let e;switch(t.arrayFormat){case"index":return(n,i,r)=>{if(e=/\[(\d*)]$/.exec(n),n=n.replace(/\[\d*]$/,""),!e){r[n]=i;return}r[n]===void 0&&(r[n]={}),r[n][e[1]]=i};case"bracket":return(n,i,r)=>{if(e=/(\[])$/.exec(n),n=n.replace(/\[]$/,""),!e){r[n]=i;return}if(r[n]===void 0){r[n]=[i];return}r[n]=[...r[n],i]};case"colon-list-separator":return(n,i,r)=>{if(e=/(:list)$/.exec(n),n=n.replace(/:list$/,""),!e){r[n]=i;return}if(r[n]===void 0){r[n]=[i];return}r[n]=[...r[n],i]};case"comma":case"separator":return(n,i,r)=>{const s=typeof i=="string"&&i.includes(t.arrayFormatSeparator),a=typeof i=="string"&&!s&&Wv(i,t).includes(t.arrayFormatSeparator);i=a?Wv(i,t):i;const o=s||a?i.split(t.arrayFormatSeparator).map(c=>Wv(c,t)):i===null?i:Wv(i,t);r[n]=o};case"bracket-separator":return(n,i,r)=>{const s=/(\[])$/.test(n);if(n=n.replace(/\[]$/,""),!s){r[n]=i&&Wv(i,t);return}const a=i===null?[]:Wv(i,t).split(t.arrayFormatSeparator);if(r[n]===void 0){r[n]=a;return}r[n]=[...r[n],...a]};default:return(n,i,r)=>{if(r[n]===void 0){r[n]=i;return}r[n]=[...[r[n]].flat(),i]}}}function PSe(t){if(typeof t!="string"||t.length!==1)throw new TypeError("arrayFormatSeparator must be single character string")}function mc(t,e){return e.encode?e.strict?W1t(t):encodeURIComponent(t):t}function Wv(t,e){return e.decode?G1t(t):t}function DSe(t){return Array.isArray(t)?t.sort():typeof t=="object"?DSe(Object.keys(t)).sort((e,n)=>Number(e)-Number(n)).map(e=>t[e]):t}function LSe(t){const e=t.indexOf("#");return e!==-1&&(t=t.slice(0,e)),t}function X1t(t){let e="";const n=t.indexOf("#");return n!==-1&&(e=t.slice(n)),e}function Dae(t,e,n){return n==="string"&&typeof t=="string"?t:typeof n=="function"&&typeof t=="string"?n(t):e.parseBooleans&&t!==null&&(t.toLowerCase()==="true"||t.toLowerCase()==="false")?t.toLowerCase()==="true":n==="number"&&!Number.isNaN(Number(t))&&typeof t=="string"&&t.trim()!==""||e.parseNumbers&&!Number.isNaN(Number(t))&&typeof t=="string"&&t.trim()!==""?Number(t):t}function lZ(t){t=LSe(t);const e=t.indexOf("?");return e===-1?"":t.slice(e+1)}function uZ(t,e){e={decode:!0,sort:!0,arrayFormat:"none",arrayFormatSeparator:",",parseNumbers:!1,parseBooleans:!1,types:Object.create(null),...e},PSe(e.arrayFormatSeparator);const n=K1t(e),i=Object.create(null);if(typeof t!="string"||(t=t.trim().replace(/^[?#&]/,""),!t))return i;for(const r of t.split("&")){if(r==="")continue;const s=e.decode?r.replaceAll("+"," "):r;let[a,o]=kSe(s,"=");a===void 0&&(a=s),o=o===void 0?null:["comma","separator","bracket-separator"].includes(e.arrayFormat)?o:Wv(o,e),n(Wv(a,e),o,i)}for(const[r,s]of Object.entries(i))if(typeof s=="object"&&s!==null&&e.types[r]!=="string")for(const[a,o]of Object.entries(s)){const c=e.types[r]?e.types[r].replace("[]",""):void 0;s[a]=Dae(o,e,c)}else typeof s=="object"&&s!==null&&e.types[r]==="string"?i[r]=Object.values(s).join(e.arrayFormatSeparator):i[r]=Dae(s,e,e.types[r]);return e.sort===!1?i:(e.sort===!0?Object.keys(i).sort():Object.keys(i).sort(e.sort)).reduce((r,s)=>{const a=i[s];return r[s]=a&&typeof a=="object"&&!Array.isArray(a)?DSe(a):a,r},Object.create(null))}function USe(t,e){if(!t)return"";e={encode:!0,strict:!0,arrayFormat:"none",arrayFormatSeparator:",",...e},PSe(e.arrayFormatSeparator);const n=a=>e.skipNull&&$1t(t[a])||e.skipEmptyString&&t[a]==="",i=Y1t(e),r={};for(const[a,o]of Object.entries(t))n(a)||(r[a]=o);const s=Object.keys(r);return e.sort!==!1&&s.sort(e.sort),s.map(a=>{const o=t[a];return o===void 0?"":o===null?mc(a,e):Array.isArray(o)?o.length===0&&e.arrayFormat==="bracket-separator"?mc(a,e)+"[]":o.reduce(i(a),[]).join("&"):mc(a,e)+"="+mc(o,e)}).filter(a=>a.length>0).join("&")}function BSe(t,e){var r;e={decode:!0,...e};let[n,i]=kSe(t,"#");return n===void 0&&(n=t),{url:((r=n==null?void 0:n.split("?"))==null?void 0:r[0])??"",query:uZ(lZ(t),e),...e&&e.parseFragmentIdentifier&&i?{fragmentIdentifier:Wv(i,e)}:{}}}function FSe(t,e){e={encode:!0,strict:!0,[s7]:!0,...e};const n=LSe(t.url).split("?")[0]||"",i=lZ(t.url),r={...uZ(i,{sort:!1}),...t.query};let s=USe(r,e);s&&(s=`?${s}`);let a=X1t(t.url);if(typeof t.fragmentIdentifier=="string"){const o=new URL(n);o.hash=t.fragmentIdentifier,a=e[s7]?o.hash:`#${t.fragmentIdentifier}`}return`${n}${s}${a}`}function zSe(t,e,n){n={parseFragmentIdentifier:!0,[s7]:!1,...n};const{url:i,query:r,fragmentIdentifier:s}=BSe(t,n);return FSe({url:i,query:q1t(r,e),fragmentIdentifier:s},n)}function Z1t(t,e,n){const i=Array.isArray(e)?r=>!e.includes(r):(r,s)=>!e(r,s);return zSe(t,i,n)}const J1t=Object.freeze(Object.defineProperty({__proto__:null,exclude:Z1t,extract:lZ,parse:uZ,parseUrl:BSe,pick:zSe,stringify:USe,stringifyUrl:FSe},Symbol.toStringTag,{value:"Module"}));var jl=[];for(var uV=0;uV<256;++uV)jl.push((uV+256).toString(16).slice(1));function Q1t(t,e=0){return(jl[t[e+0]]+jl[t[e+1]]+jl[t[e+2]]+jl[t[e+3]]+"-"+jl[t[e+4]]+jl[t[e+5]]+"-"+jl[t[e+6]]+jl[t[e+7]]+"-"+jl[t[e+8]]+jl[t[e+9]]+"-"+jl[t[e+10]]+jl[t[e+11]]+jl[t[e+12]]+jl[t[e+13]]+jl[t[e+14]]+jl[t[e+15]]).toLowerCase()}var S2,ext=new Uint8Array(16);function txt(){if(!S2&&(S2=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!S2))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return S2(ext)}var nxt=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto);const Lae={randomUUID:nxt};function ixt(t,e,n){if(Lae.randomUUID&&!e&&!t)return Lae.randomUUID();t=t||{};var i=t.random||(t.rng||txt)();return i[6]=i[6]&15|64,i[8]=i[8]&63|128,Q1t(i)}var rxt=function(e,n){var i=n.voice;return'<voice name="'.concat(i,'">').concat(e,"</voice>")},sxt=function(e,n){var i=n.style;return i?'<mstts:express-as style="'.concat(i,'">').concat(e,"</mstts:express-as>"):e},axt=function(e,n){var i=n.pitch,r=n.rate;return!i&&!r?e:'<prosody pitch="'.concat(Math.floor((i||1)*100),'%" rate="').concat(Math.floor((r||1)*100),'%">').concat(e,"</prosody>")},oxt=function(e){return'<speak version="1.0" xmlns="http://www.w3.org/2001/10/synthesis" xmlns:mstts="https://www.w3.org/2001/mstts" xml:lang="en-US">'.concat(e,"</speak>")},cxt=function(e,n){var i=axt(e,n);return i=sxt(i,n),i=rxt(i,n),i=oxt(i),i},Uae=function(e,n){for(var i=[],r=0,s=Object.entries(e);r<s.length;r++){var a=cZ(s[r],2),o=a[0],c=a[1];i.push("".concat(o,":").concat(c))}return i.push("",n),i.join(`\r
`)};function lxt(t,e){var n=typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=NSe(t))||e){n&&(t=n);var i=0,r=function(){};return{s:r,n:function(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}},e:function(l){throw l},f:r}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var s,a=!0,o=!1;return{s:function(){n=n.call(t)},n:function(){var l=n.next();return a=l.done,l},e:function(l){o=!0,s=l},f:function(){try{a||n.return==null||n.return()}finally{if(o)throw s}}}}var uxt=function(e){var n={},i=lxt(e.slice(0,e.indexOf(`\r
\r
`)).split(`\r
`)),r;try{for(i.s();!(r=i.n()).done;){var s=r.value,a=s.split(":",2),o=cZ(a,2),c=o[0],l=o[1];n[c]=l}}catch(u){i.e(u)}finally{i.f()}return{data:e.slice(e.indexOf(`\r
\r
`)+4),headers:n}},hxt="wss://speech.platform.bing.com/consumer/speech/synthesize/readaloud/edge/v1",dxt="6A5AA1D4EAFF4E9FB37E23D68491D6F4",fxt=JSON.stringify({context:{synthesis:{audio:{metadataoptions:{sentenceBoundaryEnabled:!1,wordBoundaryEnabled:!0},outputFormat:"audio-24khz-48kbitrate-mono-mp3"}}}}),pxt=function(e){var n=new Date().toString(),i={"Content-Type":"application/json; charset=utf-8",Path:"speech.config","X-Timestamp":n},r={"Content-Type":"application/ssml+xml",Path:"ssml","X-RequestId":e,"X-Timestamp":n};return{configHeader:i,contentHeader:r}},jSe=function(){var t=OC(tf().mark(function e(n){var i,r,s,a,o,c,l,u,h,d,f,p,g,_=arguments;return tf().wrap(function(b){for(;;)switch(b.prev=b.next){case 0:return i=n.payload,r=_.length>1&&_[1]!==void 0?_[1]:{},s=r.proxyUrl,a=r.token,o=i.input,c=i.options,l=ixt().replaceAll("-",""),u=J1t.stringifyUrl({query:{ConnectionId:l,TrustedClientToken:a||dxt},url:s||hxt}),h=pxt(l),d=h.configHeader,f=h.contentHeader,p=Uae(d,fxt),g=Uae(f,cxt(o,c)),b.abrupt("return",new Promise(function(S,x){var M=new WebSocket(u);M.binaryType="arraybuffer";var R=function(){M.send(p),M.send(g)},I=new ArrayBuffer(0),k=function(){var U=OC(tf().mark(function V($){var q,Y,te,G,J,K,X,ae;return tf().wrap(function(Me){for(;;)switch(Me.prev=Me.next){case 0:if(typeof $.data!="string"){Me.next=13;break}q=uxt($.data),Y=q.headers,Me.t0=Y.Path,Me.next=Me.t0==="turn.end"?5:11;break;case 5:if(M.close(),I.byteLength){Me.next=8;break}return Me.abrupt("return");case 8:return te=new Response(I),S(te),Me.abrupt("break",11);case 11:Me.next=14;break;case 13:$.data instanceof ArrayBuffer&&(G=new DataView($.data),J=G.getInt16(0),$.data.byteLength>J+2&&(K=$.data.slice(2+J),X=new ArrayBuffer(I.byteLength+K.byteLength),ae=new Uint8Array(X),ae.set(new Uint8Array(I),0),ae.set(new Uint8Array(K),I.byteLength),I=X));case 14:case"end":return Me.stop()}},V)}));return function($){return U.apply(this,arguments)}}(),P=function(){x(new Error("WebSocket error occurred.")),M.close()};M.addEventListener("open",R),M.addEventListener("message",k),M.addEventListener("error",P)}));case 9:case"end":return b.stop()}},e)}));return function(n){return t.apply(this,arguments)}}(),mxt=function(e){var n=e&&wL[e]?wL[e]||[]:ld(Object.values(wL));return n.map(function(i){return{label:(CL==null?void 0:CL[i])||i,value:i}})},uP=function(){function t(){var e=this,n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},i=n.serviceUrl,r=n.locale,s=n.headers;I1t(this,t),Pg(this,"locale",void 0),Pg(this,"serviceUrl",void 0),Pg(this,"headers",void 0),Pg(this,"fetch",function(){var a=OC(tf().mark(function o(c){var l;return tf().wrap(function(h){for(;;)switch(h.prev=h.next){case 0:return h.next=2,e.serviceUrl?fetch(e.serviceUrl,{body:JSON.stringify(c),headers:e.headers,method:"POST"}):jSe({payload:c});case 2:return l=h.sent,h.abrupt("return",l);case 4:case"end":return h.stop()}},o)}));return function(o){return a.apply(this,arguments)}}()),Pg(this,"create",function(){var a=OC(tf().mark(function o(c){return tf().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.abrupt("return",e.fetch(c));case 1:case"end":return u.stop()}},o)}));return function(o){return a.apply(this,arguments)}}()),Pg(this,"createAudio",function(){var a=OC(tf().mark(function o(c){var l,u;return tf().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return d.next=2,e.create(c);case 2:return l=d.sent,d.next=5,l.arrayBuffer();case 5:return u=d.sent,d.abrupt("return",L1t(u));case 7:case"end":return d.stop()}},o)}));return function(o){return a.apply(this,arguments)}}()),this.locale=r,this.serviceUrl=i,this.headers=s}return D1t(t,[{key:"voiceOptions",get:function(){return mxt(this.locale)}}]),t}();Pg(uP,"localeOptions",j1t());Pg(uP,"voiceList",wL);Pg(uP,"voiceName",CL);Pg(uP,"createRequest",jSe);let hV;async function gxt(t,e){if(!re(t))return;re(hV)||(hV=new uP({locale:"en-US"}));const[n,i]=e,r=await hV.createAudio({input:i,options:{voice:n||"en-US-GuyNeural"}});t.addttsaudiobuffer(r)}const Bae=new Map;async function vxt(t,e,n){var s,a;if(!re(e))return;const[i]=n,r=Bae.get(i);if(re(r))r.loaded&&e.addttsaudiobuffer(r);else{const c=await(await i7.connect("declare-lab/TangoFlux")).predict("/predict",[i,25,4.5,3]);if(ji(c.data)&&Tn((s=c.data[0])==null?void 0:s.url)){const l=(a=c.data[0])==null?void 0:a.url;Bae.set(i,new Hs(l,()=>{xr(Ye,t,"loaded",`${l.substring(0,8)}...${l.slice(-8)}`)}))}}}const _xt=Date.now(),Jd={get value(){return(Date.now()-_xt)/1e3%1e6}},yxt=120;let HSe=0;function hZ(t){HSe=yxt/t,OB().bpm.value=t}hZ(150);const hP={get value(){return HSe}};function dP(t){const e=t.clone();return e.uniforms.time=Jd,e.uniforms.interval=hP,e}WEe(new CR({latencyHint:"playback"}));cTt().catch(t=>{Mi(Qv,Gi(),"audio",t.message)});let AL=!1;function qE(){AL||YEt().then(()=>{if(!AL){const t=OB();AL=!0,t.start(),xr(Qv,Gi(),"audio is enabled!"),hZ(107);try{const e=navigator;re(e.audioSession)&&(e.audioSession.type="playback")}catch{}L4e(Qv,Gi())}}).catch(t=>{Mi(Qv,Gi(),"audio",t.message)})}let nh,Fae="";function bxt(){return nh==null?void 0:nh.broadcastdestination}const Qv=NE("synth",[],t=>{if(Qv.session(t)&&(AL&&!re(nh)&&(nh=hTt()),!!re(nh)))switch(t.target){case"audioenabled":_l(Qv,t.player,async()=>{await Kf(2e3),xm(Qv,t.player,void 0,"text","audioenabled","")});break;case"bpm":an(t.data)&&hZ(t.data);break;case"playvolume":an(t.data)&&nh.setplayvolume(t.data);break;case"bgplayvolume":an(t.data)&&nh.setbgplayvolume(t.data);break;case"ttsvolume":an(t.data)&&nh.setttsvolume(t.data);break;case"focus":Tn(t.data)&&(Fae=t.data);break;case"play":if(ji(t.data)){const[e,n,i]=t.data;if(e&&e!==Fae)return;n.trim()===""?nh.stopplay():nh.addplay(n,i)}break;case"voice":if(ji(t.data)){const[e,n,i]=t.data;mTt(t.player,nh,e,n,i)}break;case"voicefx":if(ji(t.data)){const[e,n,i,r]=t.data;TTt(t.player,nh,e,n,i,r)}break;case"tts":_l(Qv,t.player,async()=>{ji(t.data)&&await gxt(nh,t.data)});break;case"tta":_l(Qv,t.player,async()=>{ji(t.data)&&await vxt(t.player,nh,t.data)});break}});function _E(){return _E=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)({}).hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t},_E.apply(null,arguments)}var Ext=function(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:.01,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:1/(2*Math.PI);return i/Math.atan(1/n)*Math.atan(Math.sin(2*Math.PI*e*r)/n)},Sxt=function(e){return 1/(1+e+.48*e*e+.235*e*e*e)};function ph(t,e,n){var i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:.25,r=arguments.length>4&&arguments[4]!==void 0?arguments[4]:.01,s=arguments.length>5&&arguments[5]!==void 0?arguments[5]:1/0,a=arguments.length>6&&arguments[6]!==void 0?arguments[6]:Sxt,o=arguments.length>7&&arguments[7]!==void 0?arguments[7]:.001,c="velocity_"+e;if(t.__damp===void 0&&(t.__damp={}),t.__damp[c]===void 0&&(t.__damp[c]=0),Math.abs(t[e]-n)<=o)return t[e]=n,!1;i=Math.max(1e-4,i);var l=2/i,u=a(l*r),h=t[e]-n,d=n,f=s*i;h=Math.min(Math.max(h,-f),f),n=t[e]-h;var p=(t.__damp[c]+l*h)*r;t.__damp[c]=(t.__damp[c]-l*p)*u;var g=n+(h+p)*u;return d-t[e]>0==g>d&&(g=d,t.__damp[c]=(g-d)/r),t[e]=g,!0}function dV(t,e,n,i,r,s,a,o){return ph(t,e,t[e]+HUe(t[e],n),i,r,s,a,o)}var Sw=new Oe,zae,jae,Hae;function jA(t,e,n,i,r,s,a){return typeof e=="number"?Sw.setScalar(e):Array.isArray(e)?Sw.set(e[0],e[1],e[2]):Sw.copy(e),zae=ph(t,"x",Sw.x,n,i,r,s,a),jae=ph(t,"y",Sw.y,n,i,r,s,a),Hae=ph(t,"z",Sw.z,n,i,r,s,a),zae||jae||Hae}var TM=new dd,Vae,Gae,qae;function dZ(t,e,n,i,r,s,a){return Array.isArray(e)?TM.set(e[0],e[1],e[2],e[3]):TM.copy(e),Vae=dV(t,"x",TM.x,n,i,r,s,a),Gae=dV(t,"y",TM.y,n,i,r,s,a),qae=dV(t,"z",TM.z,n,i,r,s,a),Vae||Gae||qae}const $ae=t=>Symbol.iterator in t,Wae=t=>"entries"in t,Yae=(t,e)=>{const n=t instanceof Map?t:new Map(t.entries()),i=e instanceof Map?e:new Map(e.entries());if(n.size!==i.size)return!1;for(const[r,s]of n)if(!Object.is(s,i.get(r)))return!1;return!0},Txt=(t,e)=>{const n=t[Symbol.iterator](),i=e[Symbol.iterator]();let r=n.next(),s=i.next();for(;!r.done&&!s.done;){if(!Object.is(r.value,s.value))return!1;r=n.next(),s=i.next()}return!!r.done&&!!s.done};function xxt(t,e){return Object.is(t,e)?!0:typeof t!="object"||t===null||typeof e!="object"||e===null?!1:!$ae(t)||!$ae(e)?Yae({entries:()=>Object.entries(t)},{entries:()=>Object.entries(e)}):Wae(t)&&Wae(e)?Yae(t,e):Txt(t,e)}function Cu(t){const e=Sm.useRef();return n=>{const i=t(n);return xxt(e.current,i)?e.current:e.current=i}}function fZ(t,e,n){const i=Tu(d=>d.size),r=Tu(d=>d.viewport),s=typeof t=="number"?t:i.width*r.dpr,a=typeof e=="number"?e:i.height*r.dpr,o=(typeof t=="number"?n:t)||{},{samples:c=0,depth:l,...u}=o,h=De.useMemo(()=>{const d=new Ko(s,a,{minFilter:Ca,magFilter:Ca,type:SE,...u});return l&&(d.depthTexture=new JA(s,a,vu)),d.samples=c,d},[]);return De.useLayoutEffect(()=>{h.setSize(s,a),c&&(h.samples=c)},[c,h,s,a]),De.useEffect(()=>()=>h.dispose(),[]),h}const wxt=t=>typeof t=="function",VSe=De.forwardRef(({envMap:t,resolution:e=256,frames:n=1/0,children:i,makeDefault:r,...s},a)=>{const o=Tu(({set:_})=>_),c=Tu(({camera:_})=>_),l=Tu(({size:_})=>_),u=De.useRef(null);De.useImperativeHandle(a,()=>u.current,[]);const h=De.useRef(null),d=fZ(e);De.useLayoutEffect(()=>{s.manual||u.current.updateProjectionMatrix()},[l,s]),De.useLayoutEffect(()=>{u.current.updateProjectionMatrix()}),De.useLayoutEffect(()=>{if(r){const _=c;return o(()=>({camera:u.current})),()=>o(()=>({camera:_}))}},[u,r,o]);let f=0,p=null;const g=wxt(i);return Pm(_=>{g&&(n===1/0||f<n)&&(h.current.visible=!1,_.gl.setRenderTarget(d),p=_.scene.background,t&&(_.scene.background=t),_.gl.render(_.scene,u.current),_.scene.background=p,_.gl.setRenderTarget(null),h.current.visible=!0,f++)}),De.createElement(De.Fragment,null,De.createElement("orthographicCamera",_E({left:l.width/-2,right:l.width/2,top:l.height/2,bottom:l.height/-2,ref:u},s),!g&&i),De.createElement("group",{ref:h},g&&i(d.texture)))}),Cxt=t=>typeof t=="function",GSe=De.forwardRef(({envMap:t,resolution:e=256,frames:n=1/0,makeDefault:i,children:r,...s},a)=>{const o=Tu(({set:_})=>_),c=Tu(({camera:_})=>_),l=Tu(({size:_})=>_),u=De.useRef(null);De.useImperativeHandle(a,()=>u.current,[]);const h=De.useRef(null),d=fZ(e);De.useLayoutEffect(()=>{s.manual||(u.current.aspect=l.width/l.height)},[l,s]),De.useLayoutEffect(()=>{u.current.updateProjectionMatrix()});let f=0,p=null;const g=Cxt(r);return Pm(_=>{g&&(n===1/0||f<n)&&(h.current.visible=!1,_.gl.setRenderTarget(d),p=_.scene.background,t&&(_.scene.background=t),_.gl.render(_.scene,u.current),_.scene.background=p,_.gl.setRenderTarget(null),h.current.visible=!0,f++)}),De.useLayoutEffect(()=>{if(i){const _=c;return o(()=>({camera:u.current})),()=>o(()=>({camera:_}))}},[u,i,o]),De.createElement(De.Fragment,null,De.createElement("perspectiveCamera",_E({ref:u},s),!g&&r),De.createElement("group",{ref:h},g&&r(d.texture)))});var qSe={exports:{}};(function(t,e){(function(n,i){t.exports=i()})(Ml,function(){var n=function(){function i(f){return a.appendChild(f.dom),f}function r(f){for(var p=0;p<a.children.length;p++)a.children[p].style.display=p===f?"block":"none";s=f}var s=0,a=document.createElement("div");a.style.cssText="position:fixed;top:0;left:0;cursor:pointer;opacity:0.9;z-index:10000",a.addEventListener("click",function(f){f.preventDefault(),r(++s%a.children.length)},!1);var o=(performance||Date).now(),c=o,l=0,u=i(new n.Panel("FPS","#0ff","#002")),h=i(new n.Panel("MS","#0f0","#020"));if(self.performance&&self.performance.memory)var d=i(new n.Panel("MB","#f08","#201"));return r(0),{REVISION:16,dom:a,addPanel:i,showPanel:r,begin:function(){o=(performance||Date).now()},end:function(){l++;var f=(performance||Date).now();if(h.update(f-o,200),f>c+1e3&&(u.update(1e3*l/(f-c),100),c=f,l=0,d)){var p=performance.memory;d.update(p.usedJSHeapSize/1048576,p.jsHeapSizeLimit/1048576)}return f},update:function(){o=this.end()},domElement:a,setMode:r}};return n.Panel=function(i,r,s){var a=1/0,o=0,c=Math.round,l=c(window.devicePixelRatio||1),u=80*l,h=48*l,d=3*l,f=2*l,p=3*l,g=15*l,_=74*l,v=30*l,b=document.createElement("canvas");b.width=u,b.height=h,b.style.cssText="width:80px;height:48px";var S=b.getContext("2d");return S.font="bold "+9*l+"px Helvetica,Arial,sans-serif",S.textBaseline="top",S.fillStyle=s,S.fillRect(0,0,u,h),S.fillStyle=r,S.fillText(i,d,f),S.fillRect(p,g,_,v),S.fillStyle=s,S.globalAlpha=.9,S.fillRect(p,g,_,v),{dom:b,update:function(x,M){a=Math.min(a,x),o=Math.max(o,x),S.fillStyle=s,S.globalAlpha=1,S.fillRect(0,0,u,g),S.fillStyle=r,S.fillText(c(x)+" "+i+" ("+c(a)+"-"+c(o)+")",d,f),S.drawImage(b,p+l,g,_-l,v,p,g,_-l,v),S.fillRect(p+_-l,g,l,v),S.fillStyle=s,S.globalAlpha=.9,S.fillRect(p+_-l,g,l,c((1-x/M)*v))}}},n})})(qSe);var Axt=qSe.exports;const Rxt=il(Axt);function fV(t,e,n,i){return new(n||(n=Promise))(function(r,s){function a(l){try{c(i.next(l))}catch(u){s(u)}}function o(l){try{c(i.throw(l))}catch(u){s(u)}}function c(l){var u;l.done?r(l.value):(u=l.value,u instanceof n?u:new n(function(h){h(u)})).then(a,o)}c((i=i.apply(t,[])).next())})}const Mxt=["geforce 320m","geforce 8600","geforce 8600m gt","geforce 8800 gs","geforce 8800 gt","geforce 9400","geforce 9400m g","geforce 9400m","geforce 9600m gt","geforce 9600m","geforce fx go5200","geforce gt 120","geforce gt 130","geforce gt 330m","geforce gtx 285","google swiftshader","intel g41","intel g45","intel gma 4500mhd","intel gma x3100","intel hd 3000","intel q45","legacy","mali-2","mali-3","mali-4","quadro fx 1500","quadro fx 4","quadro fx 5","radeon hd 2400","radeon hd 2600","radeon hd 4670","radeon hd 4850","radeon hd 4870","radeon hd 5670","radeon hd 5750","radeon hd 6290","radeon hd 6300","radeon hd 6310","radeon hd 6320","radeon hd 6490m","radeon hd 6630m","radeon hd 6750m","radeon hd 6770m","radeon hd 6970m","sgx 543","sgx543"];function Kae(t){return t=t.toLowerCase().replace(/.*angle ?\((.+)\)(?: on vulkan [0-9.]+)?$/i,"$1").replace(/\s(\d{1,2}gb|direct3d.+$)|\(r\)| \([^)]+\)$/g,"").replace(/(?:vulkan|opengl) \d+\.\d+(?:\.\d+)?(?: \((.*)\))?/,"$1")}const $Se=typeof window>"u",Og=(()=>{if($Se)return;const{userAgent:t,platform:e,maxTouchPoints:n}=window.navigator,i=/(iphone|ipod|ipad)/i.test(t),r=e==="iPad"||e==="MacIntel"&&n>0&&!window.MSStream;return{isIpad:r,isMobile:/android/i.test(t)||i||r,isSafari12:/Version\/12.+Safari/.test(t),isFirefox:/Firefox/.test(t)}})();function Oxt(t,e,n){if(!n)return[e];const i=function(l){const u=`
    precision highp float;
    attribute vec3 aPosition;
    varying float vvv;
    void main() {
      vvv = 0.31622776601683794;
      gl_Position = vec4(aPosition, 1.0);
    }
  `,h=`
    precision highp float;
    varying float vvv;
    void main() {
      vec4 enc = vec4(1.0, 255.0, 65025.0, 16581375.0) * vvv;
      enc = fract(enc);
      enc -= enc.yzww * vec4(1.0 / 255.0, 1.0 / 255.0, 1.0 / 255.0, 0.0);
      gl_FragColor = enc;
    }
  `,d=l.createShader(35633),f=l.createShader(35632),p=l.createProgram();if(!(f&&d&&p))return;l.shaderSource(d,u),l.shaderSource(f,h),l.compileShader(d),l.compileShader(f),l.attachShader(p,d),l.attachShader(p,f),l.linkProgram(p),l.detachShader(p,d),l.detachShader(p,f),l.deleteShader(d),l.deleteShader(f),l.useProgram(p);const g=l.createBuffer();l.bindBuffer(34962,g),l.bufferData(34962,new Float32Array([-1,-1,0,3,-1,0,-1,3,0]),35044);const _=l.getAttribLocation(p,"aPosition");l.vertexAttribPointer(_,3,5126,!1,0,0),l.enableVertexAttribArray(_),l.clearColor(1,1,1,1),l.clear(16384),l.viewport(0,0,1,1),l.drawArrays(4,0,3);const v=new Uint8Array(4);return l.readPixels(0,0,1,1,6408,5121,v),l.deleteProgram(p),l.deleteBuffer(g),v.join("")}(t),r="801621810",s="8016218135",a="80162181161",o=Og!=null&&Og.isIpad?[["a7",a,12],["a8",s,15],["a8x",s,15],["a9",s,15],["a9x",s,15],["a10",s,15],["a10x",s,15],["a12",r,15],["a12x",r,15],["a12z",r,15],["a14",r,15],["a15",r,15],["m1",r,15],["m2",r,15]]:[["a7",a,12],["a8",s,12],["a9",s,15],["a10",s,15],["a11",r,15],["a12",r,15],["a13",r,15],["a14",r,15],["a15",r,15],["a16",r,15],["a17",r,15]];let c;return i==="80162181255"?c=o.filter(([,,l])=>l>=14):(c=o.filter(([,l])=>l===i),c.length||(c=o)),c.map(([l])=>`apple ${l} gpu`)}class Xae extends Error{constructor(e){super(e),Object.setPrototypeOf(this,new.target.prototype)}}const pV=[],Zae=[];function Nxt(t,e){if(t===e)return 0;const n=t;t.length>e.length&&(t=e,e=n);let i=t.length,r=e.length;for(;i>0&&t.charCodeAt(~-i)===e.charCodeAt(~-r);)i--,r--;let s,a=0;for(;a<i&&t.charCodeAt(a)===e.charCodeAt(a);)a++;if(i-=a,r-=a,i===0)return r;let o,c,l=0,u=0,h=0;for(;u<i;)Zae[u]=t.charCodeAt(a+u),pV[u]=++u;for(;h<r;)for(s=e.charCodeAt(a+h),o=h++,l=h,u=0;u<i;u++)c=s===Zae[u]?o:o+1,o=pV[u],l=pV[u]=o>l?c>l?l+1:c:c>o?o+1:c;return l}function Ixt(t){return t!=null}const kxt=({mobileTiers:t=[0,15,30,60],desktopTiers:e=[0,15,30,60],override:n={},glContext:i,failIfMajorPerformanceCaveat:r=!1,benchmarksURL:s="https://unpkg.com/detect-gpu@5.0.56/dist/benchmarks"}={})=>fV(void 0,void 0,void 0,function*(){const a={};if($Se)return{tier:0,type:"SSR"};const{isIpad:o=!!(Og!=null&&Og.isIpad),isMobile:c=!!(Og!=null&&Og.isMobile),screenSize:l=window.screen,loadBenchmarks:u=M=>fV(void 0,void 0,void 0,function*(){const R=yield fetch(`${s}/${M}`).then(I=>I.json());if(parseInt(R.shift().split(".")[0],10)<4)throw new Xae("Detect GPU benchmark data is out of date. Please update to version 4x");return R})}=n;let{renderer:h}=n;const d=(M,R,I,k,P)=>({device:P,fps:k,gpu:I,isMobile:c,tier:M,type:R});let f,p="";if(h)h=Kae(h),f=[h];else{const M=i||function(I,k=!1){const P={alpha:!1,antialias:!1,depth:!1,failIfMajorPerformanceCaveat:k,powerPreference:"high-performance",stencil:!1};I&&delete P.powerPreference;const U=window.document.createElement("canvas"),V=U.getContext("webgl",P)||U.getContext("experimental-webgl",P);return V??void 0}(Og==null?void 0:Og.isSafari12,r);if(!M)return d(0,"WEBGL_UNSUPPORTED");const R=Og!=null&&Og.isFirefox?null:M.getExtension("WEBGL_debug_renderer_info");if(h=R?M.getParameter(R.UNMASKED_RENDERER_WEBGL):M.getParameter(M.RENDERER),!h)return d(1,"FALLBACK");p=h,h=Kae(h),f=function(I,k,P){return k==="apple gpu"?Oxt(I,k,P):[k]}(M,h,c)}const g=(yield Promise.all(f.map(function(M){var R;return fV(this,void 0,void 0,function*(){const I=(Fe=>{const Te=c?["adreno","apple","mali-t","mali","nvidia","powervr","samsung"]:["intel","apple","amd","radeon","nvidia","geforce","adreno"];for(const Re of Te)if(Fe.includes(Re))return Re})(M);if(!I)return;const k=`${c?"m":"d"}-${I}${o?"-ipad":""}.json`,P=a[k]=(R=a[k])!==null&&R!==void 0?R:u(k);let U;try{U=yield P}catch(Fe){if(Fe instanceof Xae)throw Fe;return}const V=function(Fe){var Te;const Re=(Fe=Fe.replace(/\([^)]+\)/,"")).match(/\d+/)||Fe.match(/(\W|^)([A-Za-z]{1,3})(\W|$)/g);return(Te=Re==null?void 0:Re.join("").replace(/\W|amd/g,""))!==null&&Te!==void 0?Te:""}(M);let $=U.filter(([,Fe])=>Fe===V);$.length||($=U.filter(([Fe])=>Fe.includes(M)));const q=$.length;if(q===0)return;const Y=M.split(/[.,()\[\]/\s]/g).sort().filter((Fe,Te,Re)=>Te===0||Fe!==Re[Te-1]).join(" ");let te,[G,,,,J]=q>1?$.map(Fe=>[Fe,Nxt(Y,Fe[2])]).sort(([,Fe],[,Te])=>Fe-Te)[0][0]:$[0],K=Number.MAX_VALUE;const{devicePixelRatio:X}=window,ae=l.width*X*l.height*X;for(const Fe of J){const[Te,Re]=Fe,ge=Te*Re,_e=Math.abs(ae-ge);_e<K&&(K=_e,te=Fe)}if(!te)return;const[,,ce,Me]=te;return[K,ce,G,Me]})}))).filter(Ixt).sort(([M=Number.MAX_VALUE,R],[I=Number.MAX_VALUE,k])=>M===I?R-k:M-I);if(!g.length){const M=Mxt.find(R=>h.includes(R));return M?d(0,"BLOCKLISTED",M):d(1,"FALLBACK",`${h} (${p})`)}const[,_,v,b]=g[0];if(_===-1)return d(0,"BLOCKLISTED",v,_,b);const S=c?t:e;let x=0;for(let M=0;M<S.length;M++)_>=S[M]&&(x=M);return d(x,"BENCHMARK",v,_,b)}),Pxt=t=>dDe(()=>kxt(t),["useDetectGPU"]),Jae=(t,e)=>{t.updateRanges[0]=e};function Dxt(t){return typeof t=="function"}const Qae=new gi,eoe=new gi,T2=[],xM=new Io;class Lxt extends _T{constructor(){super(),this.color=new bn("white"),this.instance={current:void 0},this.instanceKey={current:void 0}}get geometry(){var e;return(e=this.instance.current)==null?void 0:e.geometry}raycast(e,n){const i=this.instance.current;if(!i||!i.geometry||!i.material)return;xM.geometry=i.geometry;const r=i.matrixWorld,s=i.userData.instances.indexOf(this.instanceKey);if(!(s===-1||s>i.count)){i.getMatrixAt(s,Qae),eoe.multiplyMatrices(r,Qae),xM.matrixWorld=eoe,i.material instanceof rl?xM.material.side=i.material.side:xM.material.side=i.material[0].side,xM.raycast(e,T2);for(let a=0,o=T2.length;a<o;a++){const c=T2[a];c.instanceId=s,c.object=this,n.push(c)}T2.length=0}}}const WSe=De.createContext(null),toe=new gi,noe=new gi,Uxt=new gi,ioe=new Oe,roe=new mh,soe=new Oe,Bxt=t=>t.isInstancedBufferAttribute,pZ=De.forwardRef(({context:t,children:e,...n},i)=>{De.useMemo(()=>DW({PositionMesh:Lxt}),[]);const r=De.useRef(null);De.useImperativeHandle(i,()=>r.current,[]);const{subscribe:s,getParent:a}=De.useContext(t||WSe);return De.useLayoutEffect(()=>s(r),[]),De.createElement("positionMesh",_E({instance:a(),instanceKey:r,ref:r},n),e)}),YSe=De.forwardRef(({context:t,children:e,range:n,limit:i=1e3,frames:r=1/0,...s},a)=>{const[{localContext:o,instance:c}]=De.useState(()=>{const b=De.createContext(null);return{localContext:b,instance:De.forwardRef((S,x)=>De.createElement(pZ,_E({context:b},S,{ref:x})))}}),l=De.useRef(null);De.useImperativeHandle(a,()=>l.current,[]);const[u,h]=De.useState([]),[[d,f]]=De.useState(()=>{const b=new Float32Array(i*16);for(let S=0;S<i;S++)Uxt.identity().toArray(b,S*16);return[b,new Float32Array([...new Array(i*3)].map(()=>1))]});De.useEffect(()=>{l.current.instanceMatrix.needsUpdate=!0});let p=0,g=0;const _=De.useRef([]);De.useLayoutEffect(()=>{_.current=Object.entries(l.current.geometry.attributes).filter(([b,S])=>Bxt(S))}),Pm(()=>{if(r===1/0||p<r){l.current.updateMatrix(),l.current.updateMatrixWorld(),toe.copy(l.current.matrixWorld).invert(),g=Math.min(i,n!==void 0?n:i,u.length),l.current.count=g,Jae(l.current.instanceMatrix,{start:0,count:g*16}),Jae(l.current.instanceColor,{start:0,count:g*3});for(let b=0;b<u.length;b++){const S=u[b].current;S.matrixWorld.decompose(ioe,roe,soe),noe.compose(ioe,roe,soe).premultiply(toe),noe.toArray(d,b*16),l.current.instanceMatrix.needsUpdate=!0,S.color.toArray(f,b*3),l.current.instanceColor.needsUpdate=!0}p++}});const v=De.useMemo(()=>({getParent:()=>l,subscribe:b=>(h(S=>[...S,b]),()=>h(S=>S.filter(x=>x.current!==b.current)))}),[]);return De.createElement("instancedMesh",_E({userData:{instances:u,limit:i,frames:r},matrixAutoUpdate:!1,ref:l,args:[null,null,0],raycast:()=>null},s),De.createElement("instancedBufferAttribute",{attach:"instanceMatrix",args:[d,16],usage:JV}),De.createElement("instancedBufferAttribute",{attach:"instanceColor",args:[f,3],usage:JV}),Dxt(e)?De.createElement(o.Provider,{value:v},e(c)):t?De.createElement(t.Provider,{value:v},e):De.createElement(WSe.Provider,{value:v},e))}),Fxt=De.forwardRef(({children:t,compute:e,width:n,height:i,samples:r=8,renderPriority:s=0,eventPriority:a=0,frames:o=1/0,stencilBuffer:c=!1,depthBuffer:l=!0,generateMipmaps:u=!1,...h},d)=>{const{size:f,viewport:p}=Tu(),g=fZ((n||f.width)*p.dpr,(i||f.height)*p.dpr,{samples:r,stencilBuffer:c,depthBuffer:l,generateMipmaps:u}),[_]=De.useState(()=>new VC),v=De.useCallback((b,S,x)=>{var M,R;let I=(M=g.texture)==null||(M=M.__r3f.parent)==null?void 0:M.object;for(;I&&!(I instanceof Wr);){var k;I=(k=I.__r3f.parent)==null?void 0:k.object}if(!I)return!1;x.raycaster.camera||x.events.compute(b,x,(R=x.previousRoot)==null?void 0:R.getState());const[P]=x.raycaster.intersectObject(I);if(!P)return!1;const U=P.uv;if(!U)return!1;S.raycaster.setFromCamera(S.pointer.set(U.x*2-1,U.y*2-1),S.camera)},[]);return De.useImperativeHandle(d,()=>g.texture,[g]),De.createElement(De.Fragment,null,GDe(De.createElement(zxt,{renderPriority:s,frames:o,fbo:g},t,De.createElement("group",{onPointerOver:()=>null})),_,{events:{compute:e||v,priority:a}}),De.createElement("primitive",_E({object:g.texture},h)))});function zxt({frames:t,renderPriority:e,children:n,fbo:i}){let r=0,s,a,o,c;return Pm(l=>{(t===1/0||r<t)&&(s=l.gl.autoClear,a=l.gl.xr.enabled,o=l.gl.getRenderTarget(),c=l.gl.xr.isPresenting,l.gl.autoClear=!0,l.gl.xr.enabled=!1,l.gl.xr.isPresenting=!1,l.gl.setRenderTarget(i),l.gl.render(l.scene,l.camera),l.gl.setRenderTarget(o),l.gl.autoClear=s,l.gl.xr.enabled=a,l.gl.xr.isPresenting=c,r++)},e),De.createElement(De.Fragment,null,n)}/**
 * postprocessing v6.37.3 build Sun Apr 27 2025
 * https://github.com/pmndrs/postprocessing
 * Copyright 2015-2025 Raoul van Rschen
 * @license Zlib
 */var mV=1/1e3,jxt=1e3,Hxt=class{constructor(){this.startTime=performance.now(),this.previousTime=0,this.currentTime=0,this._delta=0,this._elapsed=0,this._fixedDelta=1e3/60,this.timescale=1,this.useFixedDelta=!1,this._autoReset=!1}get autoReset(){return this._autoReset}set autoReset(t){typeof document<"u"&&document.hidden!==void 0&&(t?document.addEventListener("visibilitychange",this):document.removeEventListener("visibilitychange",this),this._autoReset=t)}get delta(){return this._delta*mV}get fixedDelta(){return this._fixedDelta*mV}set fixedDelta(t){this._fixedDelta=t*jxt}get elapsed(){return this._elapsed*mV}update(t){this.useFixedDelta?this._delta=this.fixedDelta:(this.previousTime=this.currentTime,this.currentTime=(t!==void 0?t:performance.now())-this.startTime,this._delta=this.currentTime-this.previousTime),this._delta*=this.timescale,this._elapsed+=this._delta}reset(){this._delta=0,this._elapsed=0,this.currentTime=performance.now()-this.startTime}getDelta(){return this.delta}getElapsed(){return this.elapsed}handleEvent(t){document.hidden||(this.currentTime=performance.now()-this.startTime)}dispose(){this.autoReset=!1}},Vxt=(()=>{const t=new Float32Array([-1,-1,0,3,-1,0,-1,3,0]),e=new Float32Array([0,0,2,0,0,2]),n=new tr;return n.setAttribute("position",new ar(t,3)),n.setAttribute("uv",new ar(e,2)),n})(),Td=class a7{static get fullscreenGeometry(){return Vxt}constructor(e="Pass",n=new VC,i=new DI){this.name=e,this.renderer=null,this.scene=n,this.camera=i,this.screen=null,this.rtt=!0,this.needsSwap=!0,this.needsDepthTexture=!1,this.enabled=!0}get renderToScreen(){return!this.rtt}set renderToScreen(e){if(this.rtt===e){const n=this.fullscreenMaterial;n!==null&&(n.needsUpdate=!0),this.rtt=!e}}set mainScene(e){}set mainCamera(e){}setRenderer(e){this.renderer=e}isEnabled(){return this.enabled}setEnabled(e){this.enabled=e}get fullscreenMaterial(){return this.screen!==null?this.screen.material:null}set fullscreenMaterial(e){let n=this.screen;n!==null?n.material=e:(n=new Io(a7.fullscreenGeometry,e),n.frustumCulled=!1,this.scene===null&&(this.scene=new VC),this.scene.add(n),this.screen=n)}getFullscreenMaterial(){return this.fullscreenMaterial}setFullscreenMaterial(e){this.fullscreenMaterial=e}getDepthTexture(){return null}setDepthTexture(e,n=TE){}render(e,n,i,r,s){throw new Error("Render method not implemented!")}setSize(e,n){}initialize(e,n,i){}dispose(){for(const e of Object.keys(this)){const n=this[e];(n instanceof Ko||n instanceof rl||n instanceof Ga||n instanceof a7)&&this[e].dispose()}this.fullscreenMaterial!==null&&this.fullscreenMaterial.dispose()}},Gxt=class extends Td{constructor(){super("ClearMaskPass",null,null),this.needsSwap=!1}render(t,e,n,i,r){const s=t.state.buffers.stencil;s.setLocked(!1),s.setTest(!1)}},qxt=`#include <common>
#include <dithering_pars_fragment>
#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D inputBuffer;
#else
uniform lowp sampler2D inputBuffer;
#endif
uniform float opacity;varying vec2 vUv;void main(){vec4 texel=texture2D(inputBuffer,vUv);gl_FragColor=opacity*texel;
#include <colorspace_fragment>
#include <dithering_fragment>
}`,KSe="varying vec2 vUv;void main(){vUv=position.xy*0.5+0.5;gl_Position=vec4(position.xy,1.0,1.0);}",XSe=class extends qa{constructor(){super({name:"CopyMaterial",uniforms:{inputBuffer:new vn(null),opacity:new vn(1)},blending:Eu,toneMapped:!1,depthWrite:!1,depthTest:!1,fragmentShader:qxt,vertexShader:KSe})}set inputBuffer(t){this.uniforms.inputBuffer.value=t}setInputBuffer(t){this.uniforms.inputBuffer.value=t}getOpacity(t){return this.uniforms.opacity.value}setOpacity(t){this.uniforms.opacity.value=t}},$xt=class extends Td{constructor(t,e=!0){super("CopyPass"),this.fullscreenMaterial=new XSe,this.needsSwap=!1,this.renderTarget=t,t===void 0&&(this.renderTarget=new Ko(1,1,{minFilter:Ca,magFilter:Ca,stencilBuffer:!1,depthBuffer:!1}),this.renderTarget.texture.name="CopyPass.Target"),this.autoResize=e}get resize(){return this.autoResize}set resize(t){this.autoResize=t}get texture(){return this.renderTarget.texture}getTexture(){return this.renderTarget.texture}setAutoResizeEnabled(t){this.autoResize=t}render(t,e,n,i,r){this.fullscreenMaterial.inputBuffer=e.texture,t.setRenderTarget(this.renderToScreen?null:this.renderTarget),t.render(this.scene,this.camera)}setSize(t,e){this.autoResize&&this.renderTarget.setSize(t,e)}initialize(t,e,n){n!==void 0&&(this.renderTarget.texture.type=n,n!==lo?this.fullscreenMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1":t!==null&&t.outputColorSpace===ls&&(this.renderTarget.texture.colorSpace=ls))}},aoe=new bn,ZSe=class extends Td{constructor(t=!0,e=!0,n=!1){super("ClearPass",null,null),this.needsSwap=!1,this.color=t,this.depth=e,this.stencil=n,this.overrideClearColor=null,this.overrideClearAlpha=-1}setClearFlags(t,e,n){this.color=t,this.depth=e,this.stencil=n}getOverrideClearColor(){return this.overrideClearColor}setOverrideClearColor(t){this.overrideClearColor=t}getOverrideClearAlpha(){return this.overrideClearAlpha}setOverrideClearAlpha(t){this.overrideClearAlpha=t}render(t,e,n,i,r){const s=this.overrideClearColor,a=this.overrideClearAlpha,o=t.getClearAlpha(),c=s!==null,l=a>=0;c?(t.getClearColor(aoe),t.setClearColor(s,l?a:o)):l&&t.setClearAlpha(a),t.setRenderTarget(this.renderToScreen?null:e),t.clear(this.color,this.depth,this.stencil),c?t.setClearColor(aoe,o):l&&t.setClearAlpha(o)}},Wxt=class extends Td{constructor(t,e){super("MaskPass",t,e),this.needsSwap=!1,this.clearPass=new ZSe(!1,!1,!0),this.inverse=!1}set mainScene(t){this.scene=t}set mainCamera(t){this.camera=t}get inverted(){return this.inverse}set inverted(t){this.inverse=t}get clear(){return this.clearPass.enabled}set clear(t){this.clearPass.enabled=t}getClearPass(){return this.clearPass}isInverted(){return this.inverted}setInverted(t){this.inverted=t}render(t,e,n,i,r){const s=t.getContext(),a=t.state.buffers,o=this.scene,c=this.camera,l=this.clearPass,u=this.inverted?0:1,h=1-u;a.color.setMask(!1),a.depth.setMask(!1),a.color.setLocked(!0),a.depth.setLocked(!0),a.stencil.setTest(!0),a.stencil.setOp(s.REPLACE,s.REPLACE,s.REPLACE),a.stencil.setFunc(s.ALWAYS,u,4294967295),a.stencil.setClear(h),a.stencil.setLocked(!0),this.clearPass.enabled&&(this.renderToScreen?l.render(t,null):(l.render(t,e),l.render(t,n))),this.renderToScreen?(t.setRenderTarget(null),t.render(o,c)):(t.setRenderTarget(e),t.render(o,c),t.setRenderTarget(n),t.render(o,c)),a.color.setLocked(!1),a.depth.setLocked(!1),a.stencil.setLocked(!1),a.stencil.setFunc(s.EQUAL,1,4294967295),a.stencil.setOp(s.KEEP,s.KEEP,s.KEEP),a.stencil.setLocked(!0)}},Yxt=class{constructor(t=null,{depthBuffer:e=!0,stencilBuffer:n=!1,multisampling:i=0,frameBufferType:r}={}){this.renderer=null,this.inputBuffer=this.createBuffer(e,n,r,i),this.outputBuffer=this.inputBuffer.clone(),this.copyPass=new $xt,this.depthTexture=null,this.passes=[],this.timer=new Hxt,this.autoRenderToScreen=!0,this.setRenderer(t)}get multisampling(){return this.inputBuffer.samples||0}set multisampling(t){const e=this.inputBuffer,n=this.multisampling;n>0&&t>0?(this.inputBuffer.samples=t,this.outputBuffer.samples=t,this.inputBuffer.dispose(),this.outputBuffer.dispose()):n!==t&&(this.inputBuffer.dispose(),this.outputBuffer.dispose(),this.inputBuffer=this.createBuffer(e.depthBuffer,e.stencilBuffer,e.texture.type,t),this.inputBuffer.depthTexture=this.depthTexture,this.outputBuffer=this.inputBuffer.clone())}getTimer(){return this.timer}getRenderer(){return this.renderer}setRenderer(t){if(this.renderer=t,t!==null){const e=t.getSize(new xt),n=t.getContext().getContextAttributes().alpha,i=this.inputBuffer.texture.type;i===lo&&t.outputColorSpace===ls&&(this.inputBuffer.texture.colorSpace=ls,this.outputBuffer.texture.colorSpace=ls,this.inputBuffer.dispose(),this.outputBuffer.dispose()),t.autoClear=!1,this.setSize(e.width,e.height);for(const r of this.passes)r.initialize(t,n,i)}}replaceRenderer(t,e=!0){const n=this.renderer,i=n.domElement.parentNode;return this.setRenderer(t),e&&i!==null&&(i.removeChild(n.domElement),i.appendChild(t.domElement)),n}createDepthTexture(){const t=this.depthTexture=new JA;return this.inputBuffer.depthTexture=t,this.inputBuffer.dispose(),this.inputBuffer.stencilBuffer?(t.format=XT,t.type=KT):t.type=s0,t}deleteDepthTexture(){if(this.depthTexture!==null){this.depthTexture.dispose(),this.depthTexture=null,this.inputBuffer.depthTexture=null,this.inputBuffer.dispose();for(const t of this.passes)t.setDepthTexture(null)}}createBuffer(t,e,n,i){const r=this.renderer,s=r===null?new xt:r.getDrawingBufferSize(new xt),a={minFilter:Ca,magFilter:Ca,stencilBuffer:e,depthBuffer:t,type:n},o=new Ko(s.width,s.height,a);return i>0&&(o.ignoreDepthForMultisampleCopy=!1,o.samples=i),n===lo&&r!==null&&r.outputColorSpace===ls&&(o.texture.colorSpace=ls),o.texture.name="EffectComposer.Buffer",o.texture.generateMipmaps=!1,o}setMainScene(t){for(const e of this.passes)e.mainScene=t}setMainCamera(t){for(const e of this.passes)e.mainCamera=t}addPass(t,e){const n=this.passes,i=this.renderer,r=i.getDrawingBufferSize(new xt),s=i.getContext().getContextAttributes().alpha,a=this.inputBuffer.texture.type;if(t.setRenderer(i),t.setSize(r.width,r.height),t.initialize(i,s,a),this.autoRenderToScreen&&(n.length>0&&(n[n.length-1].renderToScreen=!1),t.renderToScreen&&(this.autoRenderToScreen=!1)),e!==void 0?n.splice(e,0,t):n.push(t),this.autoRenderToScreen&&(n[n.length-1].renderToScreen=!0),t.needsDepthTexture||this.depthTexture!==null)if(this.depthTexture===null){const o=this.createDepthTexture();for(t of n)t.setDepthTexture(o)}else t.setDepthTexture(this.depthTexture)}removePass(t){const e=this.passes,n=e.indexOf(t);if(n!==-1&&e.splice(n,1).length>0){if(this.depthTexture!==null){const s=(o,c)=>o||c.needsDepthTexture;e.reduce(s,!1)||(t.getDepthTexture()===this.depthTexture&&t.setDepthTexture(null),this.deleteDepthTexture())}this.autoRenderToScreen&&n===e.length&&(t.renderToScreen=!1,e.length>0&&(e[e.length-1].renderToScreen=!0))}}removeAllPasses(){const t=this.passes;this.deleteDepthTexture(),t.length>0&&(this.autoRenderToScreen&&(t[t.length-1].renderToScreen=!1),this.passes=[])}render(t){const e=this.renderer,n=this.copyPass;let i=this.inputBuffer,r=this.outputBuffer,s=!1,a,o,c;t===void 0&&(this.timer.update(),t=this.timer.getDelta());for(const l of this.passes)l.enabled&&(l.render(e,i,r,t,s),l.needsSwap&&(s&&(n.renderToScreen=l.renderToScreen,a=e.getContext(),o=e.state.buffers.stencil,o.setFunc(a.NOTEQUAL,1,4294967295),n.render(e,i,r,t,s),o.setFunc(a.EQUAL,1,4294967295)),c=i,i=r,r=c),l instanceof Wxt?s=!0:l instanceof Gxt&&(s=!1))}setSize(t,e,n){const i=this.renderer,r=i.getSize(new xt);(t===void 0||e===void 0)&&(t=r.width,e=r.height),(r.width!==t||r.height!==e)&&i.setSize(t,e,n);const s=i.getDrawingBufferSize(new xt);this.inputBuffer.setSize(s.width,s.height),this.outputBuffer.setSize(s.width,s.height);for(const a of this.passes)a.setSize(s.width,s.height)}reset(){this.dispose(),this.autoRenderToScreen=!0}dispose(){for(const t of this.passes)t.dispose();this.passes=[],this.inputBuffer!==null&&this.inputBuffer.dispose(),this.outputBuffer!==null&&this.outputBuffer.dispose(),this.deleteDepthTexture(),this.copyPass.dispose(),this.timer.dispose(),Td.fullscreenGeometry.dispose()}},Qb={NONE:0,DEPTH:1,CONVOLUTION:2},cs={FRAGMENT_HEAD:"FRAGMENT_HEAD",FRAGMENT_MAIN_UV:"FRAGMENT_MAIN_UV",FRAGMENT_MAIN_IMAGE:"FRAGMENT_MAIN_IMAGE",VERTEX_HEAD:"VERTEX_HEAD",VERTEX_MAIN_SUPPORT:"VERTEX_MAIN_SUPPORT"},Kxt=class{constructor(){this.shaderParts=new Map([[cs.FRAGMENT_HEAD,null],[cs.FRAGMENT_MAIN_UV,null],[cs.FRAGMENT_MAIN_IMAGE,null],[cs.VERTEX_HEAD,null],[cs.VERTEX_MAIN_SUPPORT,null]]),this.defines=new Map,this.uniforms=new Map,this.blendModes=new Map,this.extensions=new Set,this.attributes=Qb.NONE,this.varyings=new Set,this.uvTransformation=!1,this.readDepth=!1,this.colorSpace=a0}},gV=!1,ooe=class{constructor(t=null){this.originalMaterials=new Map,this.material=null,this.materials=null,this.materialsBackSide=null,this.materialsDoubleSide=null,this.materialsFlatShaded=null,this.materialsFlatShadedBackSide=null,this.materialsFlatShadedDoubleSide=null,this.setMaterial(t),this.meshCount=0,this.replaceMaterial=e=>{if(e.isMesh){let n;if(e.material.flatShading)switch(e.material.side){case Vc:n=this.materialsFlatShadedDoubleSide;break;case $c:n=this.materialsFlatShadedBackSide;break;default:n=this.materialsFlatShaded;break}else switch(e.material.side){case Vc:n=this.materialsDoubleSide;break;case $c:n=this.materialsBackSide;break;default:n=this.materials;break}this.originalMaterials.set(e,e.material),e.isSkinnedMesh?e.material=n[2]:e.isInstancedMesh?e.material=n[1]:e.material=n[0],++this.meshCount}}}cloneMaterial(t){if(!(t instanceof qa))return t.clone();const e=t.uniforms,n=new Map;for(const r in e){const s=e[r].value;s.isRenderTargetTexture&&(e[r].value=null,n.set(r,s))}const i=t.clone();for(const r of n)e[r[0]].value=r[1],i.uniforms[r[0]].value=r[1];return i}setMaterial(t){if(this.disposeMaterials(),this.material=t,t!==null){const e=this.materials=[this.cloneMaterial(t),this.cloneMaterial(t),this.cloneMaterial(t)];for(const n of e)n.uniforms=Object.assign({},t.uniforms),n.side=r0;e[2].skinning=!0,this.materialsBackSide=e.map(n=>{const i=this.cloneMaterial(n);return i.uniforms=Object.assign({},t.uniforms),i.side=$c,i}),this.materialsDoubleSide=e.map(n=>{const i=this.cloneMaterial(n);return i.uniforms=Object.assign({},t.uniforms),i.side=Vc,i}),this.materialsFlatShaded=e.map(n=>{const i=this.cloneMaterial(n);return i.uniforms=Object.assign({},t.uniforms),i.flatShading=!0,i}),this.materialsFlatShadedBackSide=e.map(n=>{const i=this.cloneMaterial(n);return i.uniforms=Object.assign({},t.uniforms),i.flatShading=!0,i.side=$c,i}),this.materialsFlatShadedDoubleSide=e.map(n=>{const i=this.cloneMaterial(n);return i.uniforms=Object.assign({},t.uniforms),i.flatShading=!0,i.side=Vc,i})}}render(t,e,n){const i=t.shadowMap.enabled;if(t.shadowMap.enabled=!1,gV){const r=this.originalMaterials;this.meshCount=0,e.traverse(this.replaceMaterial),t.render(e,n);for(const s of r)s[0].material=s[1];this.meshCount!==r.size&&r.clear()}else{const r=e.overrideMaterial;e.overrideMaterial=this.material,t.render(e,n),e.overrideMaterial=r}t.shadowMap.enabled=i}disposeMaterials(){if(this.material!==null){const t=this.materials.concat(this.materialsBackSide).concat(this.materialsDoubleSide).concat(this.materialsFlatShaded).concat(this.materialsFlatShadedBackSide).concat(this.materialsFlatShadedDoubleSide);for(const e of t)e.dispose()}}dispose(){this.originalMaterials.clear(),this.disposeMaterials()}static get workaroundEnabled(){return gV}static set workaroundEnabled(t){gV=t}},Gy=-1,bu=class extends _f{constructor(t,e=Gy,n=Gy,i=1){super(),this.resizable=t,this.baseSize=new xt(1,1),this.preferredSize=new xt(e,n),this.target=this.preferredSize,this.s=i,this.effectiveSize=new xt,this.addEventListener("change",()=>this.updateEffectiveSize()),this.updateEffectiveSize()}updateEffectiveSize(){const t=this.baseSize,e=this.preferredSize,n=this.effectiveSize,i=this.scale;e.width!==Gy?n.width=e.width:e.height!==Gy?n.width=Math.round(e.height*(t.width/Math.max(t.height,1))):n.width=Math.round(t.width*i),e.height!==Gy?n.height=e.height:e.width!==Gy?n.height=Math.round(e.width/Math.max(t.width/Math.max(t.height,1),1)):n.height=Math.round(t.height*i)}get width(){return this.effectiveSize.width}set width(t){this.preferredWidth=t}get height(){return this.effectiveSize.height}set height(t){this.preferredHeight=t}getWidth(){return this.width}getHeight(){return this.height}get scale(){return this.s}set scale(t){this.s!==t&&(this.s=t,this.preferredSize.setScalar(Gy),this.dispatchEvent({type:"change"}),this.resizable.setSize(this.baseSize.width,this.baseSize.height))}getScale(){return this.scale}setScale(t){this.scale=t}get baseWidth(){return this.baseSize.width}set baseWidth(t){this.baseSize.width!==t&&(this.baseSize.width=t,this.dispatchEvent({type:"change"}),this.resizable.setSize(this.baseSize.width,this.baseSize.height))}getBaseWidth(){return this.baseWidth}setBaseWidth(t){this.baseWidth=t}get baseHeight(){return this.baseSize.height}set baseHeight(t){this.baseSize.height!==t&&(this.baseSize.height=t,this.dispatchEvent({type:"change"}),this.resizable.setSize(this.baseSize.width,this.baseSize.height))}getBaseHeight(){return this.baseHeight}setBaseHeight(t){this.baseHeight=t}setBaseSize(t,e){(this.baseSize.width!==t||this.baseSize.height!==e)&&(this.baseSize.set(t,e),this.dispatchEvent({type:"change"}),this.resizable.setSize(this.baseSize.width,this.baseSize.height))}get preferredWidth(){return this.preferredSize.width}set preferredWidth(t){this.preferredSize.width!==t&&(this.preferredSize.width=t,this.dispatchEvent({type:"change"}),this.resizable.setSize(this.baseSize.width,this.baseSize.height))}getPreferredWidth(){return this.preferredWidth}setPreferredWidth(t){this.preferredWidth=t}get preferredHeight(){return this.preferredSize.height}set preferredHeight(t){this.preferredSize.height!==t&&(this.preferredSize.height=t,this.dispatchEvent({type:"change"}),this.resizable.setSize(this.baseSize.width,this.baseSize.height))}getPreferredHeight(){return this.preferredHeight}setPreferredHeight(t){this.preferredHeight=t}setPreferredSize(t,e){(this.preferredSize.width!==t||this.preferredSize.height!==e)&&(this.preferredSize.set(t,e),this.dispatchEvent({type:"change"}),this.resizable.setSize(this.baseSize.width,this.baseSize.height))}copy(t){this.s=t.scale,this.baseSize.set(t.baseWidth,t.baseHeight),this.preferredSize.set(t.preferredWidth,t.preferredHeight),this.dispatchEvent({type:"change"}),this.resizable.setSize(this.baseSize.width,this.baseSize.height)}static get AUTO_SIZE(){return Gy}},sr={SKIP:9,SET:30,ADD:0,ALPHA:1,AVERAGE:2,COLOR:3,COLOR_BURN:4,COLOR_DODGE:5,DARKEN:6,DIFFERENCE:7,DIVIDE:8,DST:9,EXCLUSION:10,HARD_LIGHT:11,HARD_MIX:12,HUE:13,INVERT:14,INVERT_RGB:15,LIGHTEN:16,LINEAR_BURN:17,LINEAR_DODGE:18,LINEAR_LIGHT:19,LUMINOSITY:20,MULTIPLY:21,NEGATION:22,NORMAL:23,OVERLAY:24,PIN_LIGHT:25,REFLECT:26,SATURATION:27,SCREEN:28,SOFT_LIGHT:29,SRC:30,SUBTRACT:31,VIVID_LIGHT:32},Xxt="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,x+y,opacity);}",Zxt="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,y,min(y.a,opacity));}",Jxt="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,(x+y)*0.5,opacity);}",Qxt="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec3 xHSL=RGBToHSL(x.rgb);vec3 yHSL=RGBToHSL(y.rgb);vec3 z=HSLToRGB(vec3(yHSL.rg,xHSL.b));return vec4(mix(x.rgb,z,opacity),y.a);}",ewt="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec4 z=mix(step(0.0,y)*(1.0-min(vec4(1.0),(1.0-x)/y)),vec4(1.0),step(1.0,x));return mix(x,z,opacity);}",twt="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec4 z=step(0.0,x)*mix(min(vec4(1.0),x/max(1.0-y,1e-9)),vec4(1.0),step(1.0,y));return mix(x,z,opacity);}",nwt="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,min(x,y),opacity);}",iwt="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,abs(x-y),opacity);}",rwt="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,x/max(y,1e-12),opacity);}",swt="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,(x+y-2.0*x*y),opacity);}",awt="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec4 a=min(x,1.0),b=min(y,1.0);vec4 z=mix(2.0*a*b,1.0-2.0*(1.0-a)*(1.0-b),step(0.5,y));return mix(x,z,opacity);}",owt="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,step(1.0,x+y),opacity);}",cwt="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec3 xHSL=RGBToHSL(x.rgb);vec3 yHSL=RGBToHSL(y.rgb);vec3 z=HSLToRGB(vec3(yHSL.r,xHSL.gb));return vec4(mix(x.rgb,z,opacity),y.a);}",lwt="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,1.0-y,opacity);}",uwt="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,y*(1.0-x),opacity);}",hwt="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,max(x,y),opacity);}",dwt="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,clamp(y+x-1.0,0.0,1.0),opacity);}",fwt="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,min(x+y,1.0),opacity);}",pwt="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,clamp(2.0*y+x-1.0,0.0,1.0),opacity);}",mwt="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec3 xHSL=RGBToHSL(x.rgb);vec3 yHSL=RGBToHSL(y.rgb);vec3 z=HSLToRGB(vec3(xHSL.rg,yHSL.b));return vec4(mix(x.rgb,z,opacity),y.a);}",gwt="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,x*y,opacity);}",vwt="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,1.0-abs(1.0-x-y),opacity);}",_wt="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,y,opacity);}",ywt="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec4 z=mix(2.0*y*x,1.0-2.0*(1.0-y)*(1.0-x),step(0.5,x));return mix(x,z,opacity);}",bwt="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec4 y2=2.0*y;vec4 z=mix(mix(y2,x,step(0.5*x,y)),max(vec4(0.0),y2-1.0),step(x,(y2-1.0)));return mix(x,z,opacity);}",Ewt="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec4 z=mix(min(x*x/max(1.0-y,1e-12),1.0),y,step(1.0,y));return mix(x,z,opacity);}",Swt="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec3 xHSL=RGBToHSL(x.rgb);vec3 yHSL=RGBToHSL(y.rgb);vec3 z=HSLToRGB(vec3(xHSL.r,yHSL.g,xHSL.b));return vec4(mix(x.rgb,z,opacity),y.a);}",Twt="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,x+y-min(x*y,1.0),opacity);}",xwt="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec4 y2=2.0*y;vec4 w=step(0.5,y);vec4 z=mix(x-(1.0-y2)*x*(1.0-x),mix(x+(y2-1.0)*(sqrt(x)-x),x+(y2-1.0)*x*((16.0*x-12.0)*x+3.0),w*(1.0-step(0.25,x))),w);return mix(x,z,opacity);}",wwt="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return y;}",Cwt="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,max(x+y-1.0,0.0),opacity);}",Awt="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec4 z=mix(max(1.0-min((1.0-x)/(2.0*y),1.0),0.0),min(x/(2.0*(1.0-y)),1.0),step(0.5,y));return mix(x,z,opacity);}",Rwt=new Map([[sr.ADD,Xxt],[sr.ALPHA,Zxt],[sr.AVERAGE,Jxt],[sr.COLOR,Qxt],[sr.COLOR_BURN,ewt],[sr.COLOR_DODGE,twt],[sr.DARKEN,nwt],[sr.DIFFERENCE,iwt],[sr.DIVIDE,rwt],[sr.DST,null],[sr.EXCLUSION,swt],[sr.HARD_LIGHT,awt],[sr.HARD_MIX,owt],[sr.HUE,cwt],[sr.INVERT,lwt],[sr.INVERT_RGB,uwt],[sr.LIGHTEN,hwt],[sr.LINEAR_BURN,dwt],[sr.LINEAR_DODGE,fwt],[sr.LINEAR_LIGHT,pwt],[sr.LUMINOSITY,mwt],[sr.MULTIPLY,gwt],[sr.NEGATION,vwt],[sr.NORMAL,_wt],[sr.OVERLAY,ywt],[sr.PIN_LIGHT,bwt],[sr.REFLECT,Ewt],[sr.SATURATION,Swt],[sr.SCREEN,Twt],[sr.SOFT_LIGHT,xwt],[sr.SRC,wwt],[sr.SUBTRACT,Cwt],[sr.VIVID_LIGHT,Awt]]),Mwt=class extends _f{constructor(t,e=1){super(),this._blendFunction=t,this.opacity=new vn(e)}getOpacity(){return this.opacity.value}setOpacity(t){this.opacity.value=t}get blendFunction(){return this._blendFunction}set blendFunction(t){this._blendFunction=t,this.dispatchEvent({type:"change"})}getBlendFunction(){return this.blendFunction}setBlendFunction(t){this.blendFunction=t}getShaderCode(){return Rwt.get(this.blendFunction)}},yE=class extends _f{constructor(t,e,{attributes:n=Qb.NONE,blendFunction:i=sr.NORMAL,defines:r=new Map,uniforms:s=new Map,extensions:a=null,vertexShader:o=null}={}){super(),this.name=t,this.renderer=null,this.attributes=n,this.fragmentShader=e,this.vertexShader=o,this.defines=r,this.uniforms=s,this.extensions=a,this.blendMode=new Mwt(i),this.blendMode.addEventListener("change",c=>this.setChanged()),this._inputColorSpace=a0,this._outputColorSpace=gm}get inputColorSpace(){return this._inputColorSpace}set inputColorSpace(t){this._inputColorSpace=t,this.setChanged()}get outputColorSpace(){return this._outputColorSpace}set outputColorSpace(t){this._outputColorSpace=t,this.setChanged()}set mainScene(t){}set mainCamera(t){}getName(){return this.name}setRenderer(t){this.renderer=t}getDefines(){return this.defines}getUniforms(){return this.uniforms}getExtensions(){return this.extensions}getBlendMode(){return this.blendMode}getAttributes(){return this.attributes}setAttributes(t){this.attributes=t,this.setChanged()}getFragmentShader(){return this.fragmentShader}setFragmentShader(t){this.fragmentShader=t,this.setChanged()}getVertexShader(){return this.vertexShader}setVertexShader(t){this.vertexShader=t,this.setChanged()}setChanged(){this.dispatchEvent({type:"change"})}setDepthTexture(t,e=TE){}update(t,e,n){}setSize(t,e){}initialize(t,e,n){}dispose(){for(const t of Object.keys(this)){const e=this[t];(e instanceof Ko||e instanceof rl||e instanceof Ga||e instanceof Td)&&this[t].dispose()}}},$8={VERY_SMALL:0,SMALL:1,MEDIUM:2,LARGE:3,VERY_LARGE:4,HUGE:5},Owt=`#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D inputBuffer;
#else
uniform lowp sampler2D inputBuffer;
#endif
varying vec2 vUv0;varying vec2 vUv1;varying vec2 vUv2;varying vec2 vUv3;void main(){vec4 sum=texture2D(inputBuffer,vUv0);sum+=texture2D(inputBuffer,vUv1);sum+=texture2D(inputBuffer,vUv2);sum+=texture2D(inputBuffer,vUv3);gl_FragColor=sum*0.25;
#include <colorspace_fragment>
}`,Nwt="uniform vec4 texelSize;uniform float kernel;uniform float scale;varying vec2 vUv0;varying vec2 vUv1;varying vec2 vUv2;varying vec2 vUv3;void main(){vec2 uv=position.xy*0.5+0.5;vec2 dUv=(texelSize.xy*vec2(kernel)+texelSize.zw)*scale;vUv0=vec2(uv.x-dUv.x,uv.y+dUv.y);vUv1=vec2(uv.x+dUv.x,uv.y+dUv.y);vUv2=vec2(uv.x+dUv.x,uv.y-dUv.y);vUv3=vec2(uv.x-dUv.x,uv.y-dUv.y);gl_Position=vec4(position.xy,1.0,1.0);}",Iwt=[new Float32Array([0,0]),new Float32Array([0,1,1]),new Float32Array([0,1,1,2]),new Float32Array([0,1,2,2,3]),new Float32Array([0,1,2,3,4,4,5]),new Float32Array([0,1,2,3,4,5,7,8,9,10])],kwt=class extends qa{constructor(t=new zr){super({name:"KawaseBlurMaterial",uniforms:{inputBuffer:new vn(null),texelSize:new vn(new zr),scale:new vn(1),kernel:new vn(0)},blending:Eu,toneMapped:!1,depthWrite:!1,depthTest:!1,fragmentShader:Owt,vertexShader:Nwt}),this.setTexelSize(t.x,t.y),this.kernelSize=$8.MEDIUM}set inputBuffer(t){this.uniforms.inputBuffer.value=t}setInputBuffer(t){this.inputBuffer=t}get kernelSequence(){return Iwt[this.kernelSize]}get scale(){return this.uniforms.scale.value}set scale(t){this.uniforms.scale.value=t}getScale(){return this.uniforms.scale.value}setScale(t){this.uniforms.scale.value=t}getKernel(){return null}get kernel(){return this.uniforms.kernel.value}set kernel(t){this.uniforms.kernel.value=t}setKernel(t){this.kernel=t}setTexelSize(t,e){this.uniforms.texelSize.value.set(t,e,t*.5,e*.5)}setSize(t,e){const n=1/t,i=1/e;this.uniforms.texelSize.value.set(n,i,n*.5,i*.5)}},Pwt=class extends Td{constructor({kernelSize:t=$8.MEDIUM,resolutionScale:e=.5,width:n=bu.AUTO_SIZE,height:i=bu.AUTO_SIZE,resolutionX:r=n,resolutionY:s=i}={}){super("KawaseBlurPass"),this.renderTargetA=new Ko(1,1,{depthBuffer:!1}),this.renderTargetA.texture.name="Blur.Target.A",this.renderTargetB=this.renderTargetA.clone(),this.renderTargetB.texture.name="Blur.Target.B";const a=this.resolution=new bu(this,r,s,e);a.addEventListener("change",o=>this.setSize(a.baseWidth,a.baseHeight)),this._blurMaterial=new kwt,this._blurMaterial.kernelSize=t,this.copyMaterial=new XSe}getResolution(){return this.resolution}get blurMaterial(){return this._blurMaterial}set blurMaterial(t){this._blurMaterial=t}get dithering(){return this.copyMaterial.dithering}set dithering(t){this.copyMaterial.dithering=t}get kernelSize(){return this.blurMaterial.kernelSize}set kernelSize(t){this.blurMaterial.kernelSize=t}get width(){return this.resolution.width}set width(t){this.resolution.preferredWidth=t}get height(){return this.resolution.height}set height(t){this.resolution.preferredHeight=t}get scale(){return this.blurMaterial.scale}set scale(t){this.blurMaterial.scale=t}getScale(){return this.blurMaterial.scale}setScale(t){this.blurMaterial.scale=t}getKernelSize(){return this.kernelSize}setKernelSize(t){this.kernelSize=t}getResolutionScale(){return this.resolution.scale}setResolutionScale(t){this.resolution.scale=t}render(t,e,n,i,r){const s=this.scene,a=this.camera,o=this.renderTargetA,c=this.renderTargetB,l=this.blurMaterial,u=l.kernelSequence;let h=e;this.fullscreenMaterial=l;for(let d=0,f=u.length;d<f;++d){const p=d&1?c:o;l.kernel=u[d],l.inputBuffer=h.texture,t.setRenderTarget(p),t.render(s,a),h=p}this.fullscreenMaterial=this.copyMaterial,this.copyMaterial.inputBuffer=h.texture,t.setRenderTarget(this.renderToScreen?null:n),t.render(s,a)}setSize(t,e){const n=this.resolution;n.setBaseSize(t,e);const i=n.width,r=n.height;this.renderTargetA.setSize(i,r),this.renderTargetB.setSize(i,r),this.blurMaterial.setSize(t,e)}initialize(t,e,n){n!==void 0&&(this.renderTargetA.texture.type=n,this.renderTargetB.texture.type=n,n!==lo?(this.blurMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1",this.copyMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1"):t!==null&&t.outputColorSpace===ls&&(this.renderTargetA.texture.colorSpace=ls,this.renderTargetB.texture.colorSpace=ls))}static get AUTO_SIZE(){return bu.AUTO_SIZE}},Dwt=`#include <common>
#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D inputBuffer;
#else
uniform lowp sampler2D inputBuffer;
#endif
#ifdef RANGE
uniform vec2 range;
#elif defined(THRESHOLD)
uniform float threshold;uniform float smoothing;
#endif
varying vec2 vUv;void main(){vec4 texel=texture2D(inputBuffer,vUv);float l=luminance(texel.rgb);
#ifdef RANGE
float low=step(range.x,l);float high=step(l,range.y);l*=low*high;
#elif defined(THRESHOLD)
l=smoothstep(threshold,threshold+smoothing,l)*l;
#endif
#ifdef COLOR
gl_FragColor=vec4(texel.rgb*clamp(l,0.0,1.0),l);
#else
gl_FragColor=vec4(l);
#endif
}`,Lwt=class extends qa{constructor(t=!1,e=null){super({name:"LuminanceMaterial",defines:{THREE_REVISION:WA.replace(/\D+/g,"")},uniforms:{inputBuffer:new vn(null),threshold:new vn(0),smoothing:new vn(1),range:new vn(null)},blending:Eu,toneMapped:!1,depthWrite:!1,depthTest:!1,fragmentShader:Dwt,vertexShader:KSe}),this.colorOutput=t,this.luminanceRange=e}set inputBuffer(t){this.uniforms.inputBuffer.value=t}setInputBuffer(t){this.uniforms.inputBuffer.value=t}get threshold(){return this.uniforms.threshold.value}set threshold(t){this.smoothing>0||t>0?this.defines.THRESHOLD="1":delete this.defines.THRESHOLD,this.uniforms.threshold.value=t}getThreshold(){return this.threshold}setThreshold(t){this.threshold=t}get smoothing(){return this.uniforms.smoothing.value}set smoothing(t){this.threshold>0||t>0?this.defines.THRESHOLD="1":delete this.defines.THRESHOLD,this.uniforms.smoothing.value=t}getSmoothingFactor(){return this.smoothing}setSmoothingFactor(t){this.smoothing=t}get useThreshold(){return this.threshold>0||this.smoothing>0}set useThreshold(t){}get colorOutput(){return this.defines.COLOR!==void 0}set colorOutput(t){t?this.defines.COLOR="1":delete this.defines.COLOR,this.needsUpdate=!0}isColorOutputEnabled(t){return this.colorOutput}setColorOutputEnabled(t){this.colorOutput=t}get useRange(){return this.luminanceRange!==null}set useRange(t){this.luminanceRange=null}get luminanceRange(){return this.uniforms.range.value}set luminanceRange(t){t!==null?this.defines.RANGE="1":delete this.defines.RANGE,this.uniforms.range.value=t,this.needsUpdate=!0}getLuminanceRange(){return this.luminanceRange}setLuminanceRange(t){this.luminanceRange=t}},Uwt=class extends Td{constructor({renderTarget:t,luminanceRange:e,colorOutput:n,resolutionScale:i=1,width:r=bu.AUTO_SIZE,height:s=bu.AUTO_SIZE,resolutionX:a=r,resolutionY:o=s}={}){super("LuminancePass"),this.fullscreenMaterial=new Lwt(n,e),this.needsSwap=!1,this.renderTarget=t,this.renderTarget===void 0&&(this.renderTarget=new Ko(1,1,{depthBuffer:!1}),this.renderTarget.texture.name="LuminancePass.Target");const c=this.resolution=new bu(this,a,o,i);c.addEventListener("change",l=>this.setSize(c.baseWidth,c.baseHeight))}get texture(){return this.renderTarget.texture}getTexture(){return this.renderTarget.texture}getResolution(){return this.resolution}render(t,e,n,i,r){const s=this.fullscreenMaterial;s.inputBuffer=e.texture,t.setRenderTarget(this.renderToScreen?null:this.renderTarget),t.render(this.scene,this.camera)}setSize(t,e){const n=this.resolution;n.setBaseSize(t,e),this.renderTarget.setSize(n.width,n.height)}initialize(t,e,n){n!==void 0&&n!==lo&&(this.renderTarget.texture.type=n,this.fullscreenMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1")}},Bwt=`#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D inputBuffer;
#else
uniform lowp sampler2D inputBuffer;
#endif
#define WEIGHT_INNER 0.125
#define WEIGHT_OUTER 0.0555555
varying vec2 vUv;varying vec2 vUv00;varying vec2 vUv01;varying vec2 vUv02;varying vec2 vUv03;varying vec2 vUv04;varying vec2 vUv05;varying vec2 vUv06;varying vec2 vUv07;varying vec2 vUv08;varying vec2 vUv09;varying vec2 vUv10;varying vec2 vUv11;float clampToBorder(const in vec2 uv){return float(uv.s>=0.0&&uv.s<=1.0&&uv.t>=0.0&&uv.t<=1.0);}void main(){vec4 c=vec4(0.0);vec4 w=WEIGHT_INNER*vec4(clampToBorder(vUv00),clampToBorder(vUv01),clampToBorder(vUv02),clampToBorder(vUv03));c+=w.x*texture2D(inputBuffer,vUv00);c+=w.y*texture2D(inputBuffer,vUv01);c+=w.z*texture2D(inputBuffer,vUv02);c+=w.w*texture2D(inputBuffer,vUv03);w=WEIGHT_OUTER*vec4(clampToBorder(vUv04),clampToBorder(vUv05),clampToBorder(vUv06),clampToBorder(vUv07));c+=w.x*texture2D(inputBuffer,vUv04);c+=w.y*texture2D(inputBuffer,vUv05);c+=w.z*texture2D(inputBuffer,vUv06);c+=w.w*texture2D(inputBuffer,vUv07);w=WEIGHT_OUTER*vec4(clampToBorder(vUv08),clampToBorder(vUv09),clampToBorder(vUv10),clampToBorder(vUv11));c+=w.x*texture2D(inputBuffer,vUv08);c+=w.y*texture2D(inputBuffer,vUv09);c+=w.z*texture2D(inputBuffer,vUv10);c+=w.w*texture2D(inputBuffer,vUv11);c+=WEIGHT_OUTER*texture2D(inputBuffer,vUv);gl_FragColor=c;
#include <colorspace_fragment>
}`,Fwt="uniform vec2 texelSize;varying vec2 vUv;varying vec2 vUv00;varying vec2 vUv01;varying vec2 vUv02;varying vec2 vUv03;varying vec2 vUv04;varying vec2 vUv05;varying vec2 vUv06;varying vec2 vUv07;varying vec2 vUv08;varying vec2 vUv09;varying vec2 vUv10;varying vec2 vUv11;void main(){vUv=position.xy*0.5+0.5;vUv00=vUv+texelSize*vec2(-1.0,1.0);vUv01=vUv+texelSize*vec2(1.0,1.0);vUv02=vUv+texelSize*vec2(-1.0,-1.0);vUv03=vUv+texelSize*vec2(1.0,-1.0);vUv04=vUv+texelSize*vec2(-2.0,2.0);vUv05=vUv+texelSize*vec2(0.0,2.0);vUv06=vUv+texelSize*vec2(2.0,2.0);vUv07=vUv+texelSize*vec2(-2.0,0.0);vUv08=vUv+texelSize*vec2(2.0,0.0);vUv09=vUv+texelSize*vec2(-2.0,-2.0);vUv10=vUv+texelSize*vec2(0.0,-2.0);vUv11=vUv+texelSize*vec2(2.0,-2.0);gl_Position=vec4(position.xy,1.0,1.0);}",zwt=class extends qa{constructor(){super({name:"DownsamplingMaterial",uniforms:{inputBuffer:new vn(null),texelSize:new vn(new xt)},blending:Eu,toneMapped:!1,depthWrite:!1,depthTest:!1,fragmentShader:Bwt,vertexShader:Fwt})}set inputBuffer(t){this.uniforms.inputBuffer.value=t}setSize(t,e){this.uniforms.texelSize.value.set(1/t,1/e)}},jwt=`#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D inputBuffer;uniform mediump sampler2D supportBuffer;
#else
uniform lowp sampler2D inputBuffer;uniform lowp sampler2D supportBuffer;
#endif
uniform float radius;varying vec2 vUv;varying vec2 vUv0;varying vec2 vUv1;varying vec2 vUv2;varying vec2 vUv3;varying vec2 vUv4;varying vec2 vUv5;varying vec2 vUv6;varying vec2 vUv7;void main(){vec4 c=vec4(0.0);c+=texture2D(inputBuffer,vUv0)*0.0625;c+=texture2D(inputBuffer,vUv1)*0.125;c+=texture2D(inputBuffer,vUv2)*0.0625;c+=texture2D(inputBuffer,vUv3)*0.125;c+=texture2D(inputBuffer,vUv)*0.25;c+=texture2D(inputBuffer,vUv4)*0.125;c+=texture2D(inputBuffer,vUv5)*0.0625;c+=texture2D(inputBuffer,vUv6)*0.125;c+=texture2D(inputBuffer,vUv7)*0.0625;vec4 baseColor=texture2D(supportBuffer,vUv);gl_FragColor=mix(baseColor,c,radius);
#include <colorspace_fragment>
}`,Hwt="uniform vec2 texelSize;varying vec2 vUv;varying vec2 vUv0;varying vec2 vUv1;varying vec2 vUv2;varying vec2 vUv3;varying vec2 vUv4;varying vec2 vUv5;varying vec2 vUv6;varying vec2 vUv7;void main(){vUv=position.xy*0.5+0.5;vUv0=vUv+texelSize*vec2(-1.0,1.0);vUv1=vUv+texelSize*vec2(0.0,1.0);vUv2=vUv+texelSize*vec2(1.0,1.0);vUv3=vUv+texelSize*vec2(-1.0,0.0);vUv4=vUv+texelSize*vec2(1.0,0.0);vUv5=vUv+texelSize*vec2(-1.0,-1.0);vUv6=vUv+texelSize*vec2(0.0,-1.0);vUv7=vUv+texelSize*vec2(1.0,-1.0);gl_Position=vec4(position.xy,1.0,1.0);}",Vwt=class extends qa{constructor(){super({name:"UpsamplingMaterial",uniforms:{inputBuffer:new vn(null),supportBuffer:new vn(null),texelSize:new vn(new xt),radius:new vn(.85)},blending:Eu,toneMapped:!1,depthWrite:!1,depthTest:!1,fragmentShader:jwt,vertexShader:Hwt})}set inputBuffer(t){this.uniforms.inputBuffer.value=t}set supportBuffer(t){this.uniforms.supportBuffer.value=t}get radius(){return this.uniforms.radius.value}set radius(t){this.uniforms.radius.value=t}setSize(t,e){this.uniforms.texelSize.value.set(1/t,1/e)}},Gwt=class extends Td{constructor(){super("MipmapBlurPass"),this.needsSwap=!1,this.renderTarget=new Ko(1,1,{depthBuffer:!1}),this.renderTarget.texture.name="Upsampling.Mipmap0",this.downsamplingMipmaps=[],this.upsamplingMipmaps=[],this.downsamplingMaterial=new zwt,this.upsamplingMaterial=new Vwt,this.resolution=new xt}get texture(){return this.renderTarget.texture}get levels(){return this.downsamplingMipmaps.length}set levels(t){if(this.levels!==t){const e=this.renderTarget;this.dispose(),this.downsamplingMipmaps=[],this.upsamplingMipmaps=[];for(let n=0;n<t;++n){const i=e.clone();i.texture.name="Downsampling.Mipmap"+n,this.downsamplingMipmaps.push(i)}this.upsamplingMipmaps.push(e);for(let n=1,i=t-1;n<i;++n){const r=e.clone();r.texture.name="Upsampling.Mipmap"+n,this.upsamplingMipmaps.push(r)}this.setSize(this.resolution.x,this.resolution.y)}}get radius(){return this.upsamplingMaterial.radius}set radius(t){this.upsamplingMaterial.radius=t}render(t,e,n,i,r){const{scene:s,camera:a}=this,{downsamplingMaterial:o,upsamplingMaterial:c}=this,{downsamplingMipmaps:l,upsamplingMipmaps:u}=this;let h=e;this.fullscreenMaterial=o;for(let d=0,f=l.length;d<f;++d){const p=l[d];o.setSize(h.width,h.height),o.inputBuffer=h.texture,t.setRenderTarget(p),t.render(s,a),h=p}this.fullscreenMaterial=c;for(let d=u.length-1;d>=0;--d){const f=u[d];c.setSize(h.width,h.height),c.inputBuffer=h.texture,c.supportBuffer=l[d].texture,t.setRenderTarget(f),t.render(s,a),h=f}}setSize(t,e){const n=this.resolution;n.set(t,e);let i=n.width,r=n.height;for(let s=0,a=this.downsamplingMipmaps.length;s<a;++s)i=Math.round(i*.5),r=Math.round(r*.5),this.downsamplingMipmaps[s].setSize(i,r),s<this.upsamplingMipmaps.length&&this.upsamplingMipmaps[s].setSize(i,r)}initialize(t,e,n){if(n!==void 0){const i=this.downsamplingMipmaps.concat(this.upsamplingMipmaps);for(const r of i)r.texture.type=n;if(n!==lo)this.downsamplingMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1",this.upsamplingMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1";else if(t!==null&&t.outputColorSpace===ls)for(const r of i)r.texture.colorSpace=ls}}dispose(){super.dispose();for(const t of this.downsamplingMipmaps.concat(this.upsamplingMipmaps))t.dispose()}},qwt=`#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D map;
#else
uniform lowp sampler2D map;
#endif
uniform float intensity;void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){vec4 texel=texture2D(map,uv);outputColor=vec4(texel.rgb*intensity,texel.a);}`,$wt=class extends yE{constructor({blendFunction:t=sr.SCREEN,luminanceThreshold:e=.9,luminanceSmoothing:n=.025,mipmapBlur:i=!1,intensity:r=1,radius:s=.85,levels:a=8,kernelSize:o=$8.LARGE,resolutionScale:c=.5,width:l=bu.AUTO_SIZE,height:u=bu.AUTO_SIZE,resolutionX:h=l,resolutionY:d=u}={}){super("BloomEffect",qwt,{blendFunction:t,uniforms:new Map([["map",new vn(null)],["intensity",new vn(r)]])}),this.renderTarget=new Ko(1,1,{depthBuffer:!1}),this.renderTarget.texture.name="Bloom.Target",this.blurPass=new Pwt({kernelSize:o}),this.luminancePass=new Uwt({colorOutput:!0}),this.luminanceMaterial.threshold=e,this.luminanceMaterial.smoothing=n,this.mipmapBlurPass=new Gwt,this.mipmapBlurPass.enabled=i,this.mipmapBlurPass.radius=s,this.mipmapBlurPass.levels=a,this.uniforms.get("map").value=i?this.mipmapBlurPass.texture:this.renderTarget.texture;const f=this.resolution=new bu(this,h,d,c);f.addEventListener("change",p=>this.setSize(f.baseWidth,f.baseHeight))}get texture(){return this.mipmapBlurPass.enabled?this.mipmapBlurPass.texture:this.renderTarget.texture}getTexture(){return this.texture}getResolution(){return this.resolution}getBlurPass(){return this.blurPass}getLuminancePass(){return this.luminancePass}get luminanceMaterial(){return this.luminancePass.fullscreenMaterial}getLuminanceMaterial(){return this.luminancePass.fullscreenMaterial}get width(){return this.resolution.width}set width(t){this.resolution.preferredWidth=t}get height(){return this.resolution.height}set height(t){this.resolution.preferredHeight=t}get dithering(){return this.blurPass.dithering}set dithering(t){this.blurPass.dithering=t}get kernelSize(){return this.blurPass.kernelSize}set kernelSize(t){this.blurPass.kernelSize=t}get distinction(){return console.warn(this.name,"distinction was removed"),1}set distinction(t){console.warn(this.name,"distinction was removed")}get intensity(){return this.uniforms.get("intensity").value}set intensity(t){this.uniforms.get("intensity").value=t}getIntensity(){return this.intensity}setIntensity(t){this.intensity=t}getResolutionScale(){return this.resolution.scale}setResolutionScale(t){this.resolution.scale=t}update(t,e,n){const i=this.renderTarget,r=this.luminancePass;r.enabled?(r.render(t,e),this.mipmapBlurPass.enabled?this.mipmapBlurPass.render(t,r.renderTarget):this.blurPass.render(t,r.renderTarget,i)):this.mipmapBlurPass.enabled?this.mipmapBlurPass.render(t,e):this.blurPass.render(t,e,i)}setSize(t,e){const n=this.resolution;n.setBaseSize(t,e),this.renderTarget.setSize(n.width,n.height),this.blurPass.resolution.copy(n),this.luminancePass.setSize(t,e),this.mipmapBlurPass.setSize(t,e)}initialize(t,e,n){this.blurPass.initialize(t,e,n),this.luminancePass.initialize(t,e,n),this.mipmapBlurPass.initialize(t,e,n),n!==void 0&&(this.renderTarget.texture.type=n,t!==null&&t.outputColorSpace===ls&&(this.renderTarget.texture.colorSpace=ls))}},x2={RED:0,GREEN:1,BLUE:2,ALPHA:3},bb={DISABLED:0,SPORADIC:1,CONSTANT_MILD:2,CONSTANT_WILD:3};function Wwt(t,e,n){const i=new Map([[KA,1],[tF,2],[Wc,4]]);let r;if(i.has(e)||console.error("Invalid noise texture format"),n===lo){r=new Uint8Array(t*i.get(e));for(let s=0,a=r.length;s<a;++s)r[s]=Math.random()*255+.5}else{r=new Float32Array(t*i.get(e));for(let s=0,a=r.length;s<a;++s)r[s]=Math.random()}return r}var coe=class extends lf{constructor(t,e,n=KA,i=lo){super(Wwt(t*e,n,i),t,e,n,i),this.needsUpdate=!0}},Ywt="uniform lowp sampler2D perturbationMap;uniform bool active;uniform float columns;uniform float random;uniform vec2 seeds;uniform vec2 distortion;void mainUv(inout vec2 uv){if(active){if(uv.y<distortion.x+columns&&uv.y>distortion.x-columns*random){float sx=clamp(ceil(seeds.x),0.0,1.0);uv.y=sx*(1.0-(uv.y+distortion.y))+(1.0-sx)*distortion.y;}if(uv.x<distortion.y+columns&&uv.x>distortion.y-columns*random){float sy=clamp(ceil(seeds.y),0.0,1.0);uv.x=sy*distortion.x+(1.0-sy)*(1.0-(uv.x+distortion.x));}vec2 normal=texture2D(perturbationMap,uv*random*random).rg;uv+=normal*seeds*(random*0.2);}}",w2="Glitch.Generated";function Gh(t,e){return t+Math.random()*(e-t)}var Kwt=class extends yE{constructor({chromaticAberrationOffset:t=null,delay:e=new xt(1.5,3.5),duration:n=new xt(.6,1),strength:i=new xt(.3,1),columns:r=.05,ratio:s=.85,perturbationMap:a=null,dtSize:o=64}={}){if(super("GlitchEffect",Ywt,{uniforms:new Map([["perturbationMap",new vn(null)],["columns",new vn(r)],["active",new vn(!1)],["random",new vn(1)],["seeds",new vn(new xt)],["distortion",new vn(new xt)]])}),a===null){const c=new coe(o,o,Wc);c.name=w2,this.perturbationMap=c}else this.perturbationMap=a;this.time=0,this.distortion=this.uniforms.get("distortion").value,this.delay=e,this.duration=n,this.breakPoint=new xt(Gh(this.delay.x,this.delay.y),Gh(this.duration.x,this.duration.y)),this.strength=i,this.mode=bb.SPORADIC,this.ratio=s,this.chromaticAberrationOffset=t}get seeds(){return this.uniforms.get("seeds").value}get active(){return this.uniforms.get("active").value}isActive(){return this.active}get minDelay(){return this.delay.x}set minDelay(t){this.delay.x=t}getMinDelay(){return this.delay.x}setMinDelay(t){this.delay.x=t}get maxDelay(){return this.delay.y}set maxDelay(t){this.delay.y=t}getMaxDelay(){return this.delay.y}setMaxDelay(t){this.delay.y=t}get minDuration(){return this.duration.x}set minDuration(t){this.duration.x=t}getMinDuration(){return this.duration.x}setMinDuration(t){this.duration.x=t}get maxDuration(){return this.duration.y}set maxDuration(t){this.duration.y=t}getMaxDuration(){return this.duration.y}setMaxDuration(t){this.duration.y=t}get minStrength(){return this.strength.x}set minStrength(t){this.strength.x=t}getMinStrength(){return this.strength.x}setMinStrength(t){this.strength.x=t}get maxStrength(){return this.strength.y}set maxStrength(t){this.strength.y=t}getMaxStrength(){return this.strength.y}setMaxStrength(t){this.strength.y=t}getMode(){return this.mode}setMode(t){this.mode=t}getGlitchRatio(){return 1-this.ratio}setGlitchRatio(t){this.ratio=Math.min(Math.max(1-t,0),1)}get columns(){return this.uniforms.get("columns").value}set columns(t){this.uniforms.get("columns").value=t}getGlitchColumns(){return this.columns}setGlitchColumns(t){this.columns=t}getChromaticAberrationOffset(){return this.chromaticAberrationOffset}setChromaticAberrationOffset(t){this.chromaticAberrationOffset=t}get perturbationMap(){return this.uniforms.get("perturbationMap").value}set perturbationMap(t){const e=this.perturbationMap;e!==null&&e.name===w2&&e.dispose(),t.minFilter=t.magFilter=Va,t.wrapS=t.wrapT=UC,t.generateMipmaps=!1,this.uniforms.get("perturbationMap").value=t}getPerturbationMap(){return this.perturbationMap}setPerturbationMap(t){this.perturbationMap=t}generatePerturbationMap(t=64){const e=new coe(t,t,Wc);return e.name=w2,e}update(t,e,n){const i=this.mode,r=this.breakPoint,s=this.chromaticAberrationOffset,a=this.strength;let o=this.time,c=!1,l=0,u=0,h;i!==bb.DISABLED&&(i===bb.SPORADIC&&(o+=n,h=o>r.x,o>=r.x+r.y&&(r.set(Gh(this.delay.x,this.delay.y),Gh(this.duration.x,this.duration.y)),o=0)),l=Math.random(),this.uniforms.get("random").value=l,h&&l>this.ratio||i===bb.CONSTANT_WILD?(c=!0,l*=a.y*.03,u=Gh(-Math.PI,Math.PI),this.seeds.set(Gh(-a.y,a.y),Gh(-a.y,a.y)),this.distortion.set(Gh(0,1),Gh(0,1))):(h||i===bb.CONSTANT_MILD)&&(c=!0,l*=a.x*.03,u=Gh(-Math.PI,Math.PI),this.seeds.set(Gh(-a.x,a.x),Gh(-a.x,a.x)),this.distortion.set(Gh(0,1),Gh(0,1))),this.time=o),s!==null&&(c?s.set(Math.cos(u),Math.sin(u)).multiplyScalar(l):s.set(0,0)),this.uniforms.get("active").value=c}dispose(){const t=this.perturbationMap;t!==null&&t.name===w2&&t.dispose()}},JSe=class extends Td{constructor(t,e,n=null){super("RenderPass",t,e),this.needsSwap=!1,this.clearPass=new ZSe,this.overrideMaterialManager=n===null?null:new ooe(n),this.ignoreBackground=!1,this.skipShadowMapUpdate=!1,this.selection=null}set mainScene(t){this.scene=t}set mainCamera(t){this.camera=t}get renderToScreen(){return super.renderToScreen}set renderToScreen(t){super.renderToScreen=t,this.clearPass.renderToScreen=t}get overrideMaterial(){const t=this.overrideMaterialManager;return t!==null?t.material:null}set overrideMaterial(t){const e=this.overrideMaterialManager;t!==null?e!==null?e.setMaterial(t):this.overrideMaterialManager=new ooe(t):e!==null&&(e.dispose(),this.overrideMaterialManager=null)}getOverrideMaterial(){return this.overrideMaterial}setOverrideMaterial(t){this.overrideMaterial=t}get clear(){return this.clearPass.enabled}set clear(t){this.clearPass.enabled=t}getSelection(){return this.selection}setSelection(t){this.selection=t}isBackgroundDisabled(){return this.ignoreBackground}setBackgroundDisabled(t){this.ignoreBackground=t}isShadowMapDisabled(){return this.skipShadowMapUpdate}setShadowMapDisabled(t){this.skipShadowMapUpdate=t}getClearPass(){return this.clearPass}render(t,e,n,i,r){const s=this.scene,a=this.camera,o=this.selection,c=a.layers.mask,l=s.background,u=t.shadowMap.autoUpdate,h=this.renderToScreen?null:e;o!==null&&a.layers.set(o.getLayer()),this.skipShadowMapUpdate&&(t.shadowMap.autoUpdate=!1),(this.ignoreBackground||this.clearPass.overrideClearColor!==null)&&(s.background=null),this.clearPass.enabled&&this.clearPass.render(t,e),t.setRenderTarget(h),this.overrideMaterialManager!==null?this.overrideMaterialManager.render(t,s,a):t.render(s,a),a.layers.mask=c,s.background=l,t.shadowMap.autoUpdate=u}},wM={DEFAULT:0,ESKIL:1},Xwt=`void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){vec3 noise=vec3(rand(uv*(1.0+time)));
#ifdef PREMULTIPLY
outputColor=vec4(min(inputColor.rgb*noise,vec3(1.0)),inputColor.a);
#else
outputColor=vec4(noise,inputColor.a);
#endif
}`,Zwt=class extends yE{constructor({blendFunction:t=sr.SCREEN,premultiply:e=!1}={}){super("NoiseEffect",Xwt,{blendFunction:t}),this.premultiply=e}get premultiply(){return this.defines.has("PREMULTIPLY")}set premultiply(t){this.premultiply!==t&&(t?this.defines.set("PREMULTIPLY","1"):this.defines.delete("PREMULTIPLY"),this.setChanged())}isPremultiplied(){return this.premultiply}setPremultiplied(t){this.premultiply=t}},Jwt=`uniform float count;
#ifdef SCROLL
uniform float scrollSpeed;
#endif
void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){float y=uv.y;
#ifdef SCROLL
y+=time*scrollSpeed;
#endif
vec2 sl=vec2(sin(y*count),cos(y*count));outputColor=vec4(sl.xyx,inputColor.a);}`,Qwt=class extends yE{constructor({blendFunction:t=sr.OVERLAY,density:e=1.25,scrollSpeed:n=0}={}){super("ScanlineEffect",Jwt,{blendFunction:t,uniforms:new Map([["count",new vn(0)],["scrollSpeed",new vn(0)]])}),this.resolution=new xt,this.d=e,this.scrollSpeed=n}get density(){return this.d}set density(t){this.d=t,this.setSize(this.resolution.width,this.resolution.height)}getDensity(){return this.density}setDensity(t){this.density=t}get scrollSpeed(){return this.uniforms.get("scrollSpeed").value}set scrollSpeed(t){this.uniforms.get("scrollSpeed").value=t,t===0?this.defines.delete("SCROLL")&&this.setChanged():this.defines.has("SCROLL")||(this.defines.set("SCROLL","1"),this.setChanged())}setSize(t,e){this.resolution.set(t,e),this.uniforms.get("count").value=Math.round(e*this.density)}},eCt=`#include <packing>
#ifdef GL_FRAGMENT_PRECISION_HIGH
uniform highp sampler2D depthBuffer;
#else
uniform mediump sampler2D depthBuffer;
#endif
#ifdef DOWNSAMPLE_NORMALS
uniform lowp sampler2D normalBuffer;
#endif
varying vec2 vUv0;varying vec2 vUv1;varying vec2 vUv2;varying vec2 vUv3;float readDepth(const in vec2 uv){
#if DEPTH_PACKING == 3201
return unpackRGBAToDepth(texture2D(depthBuffer,uv));
#else
return texture2D(depthBuffer,uv).r;
#endif
}int findBestDepth(const in float samples[4]){float c=(samples[0]+samples[1]+samples[2]+samples[3])*0.25;float distances[4];distances[0]=abs(c-samples[0]);distances[1]=abs(c-samples[1]);distances[2]=abs(c-samples[2]);distances[3]=abs(c-samples[3]);float maxDistance=max(max(distances[0],distances[1]),max(distances[2],distances[3]));int remaining[3];int rejected[3];int i,j,k;for(i=0,j=0,k=0;i<4;++i){if(distances[i]<maxDistance){remaining[j++]=i;}else{rejected[k++]=i;}}for(;j<3;++j){remaining[j]=rejected[--k];}vec3 s=vec3(samples[remaining[0]],samples[remaining[1]],samples[remaining[2]]);c=(s.x+s.y+s.z)/3.0;distances[0]=abs(c-s.x);distances[1]=abs(c-s.y);distances[2]=abs(c-s.z);float minDistance=min(distances[0],min(distances[1],distances[2]));for(i=0;i<3;++i){if(distances[i]==minDistance){break;}}return remaining[i];}void main(){float d[4];d[0]=readDepth(vUv0);d[1]=readDepth(vUv1);d[2]=readDepth(vUv2);d[3]=readDepth(vUv3);int index=findBestDepth(d);
#ifdef DOWNSAMPLE_NORMALS
vec3 n[4];n[0]=texture2D(normalBuffer,vUv0).rgb;n[1]=texture2D(normalBuffer,vUv1).rgb;n[2]=texture2D(normalBuffer,vUv2).rgb;n[3]=texture2D(normalBuffer,vUv3).rgb;
#else
vec3 n[4];n[0]=vec3(0.0);n[1]=vec3(0.0);n[2]=vec3(0.0);n[3]=vec3(0.0);
#endif
gl_FragColor=vec4(n[index],d[index]);}`,tCt="uniform vec2 texelSize;varying vec2 vUv0;varying vec2 vUv1;varying vec2 vUv2;varying vec2 vUv3;void main(){vec2 uv=position.xy*0.5+0.5;vUv0=uv;vUv1=vec2(uv.x,uv.y+texelSize.y);vUv2=vec2(uv.x+texelSize.x,uv.y);vUv3=uv+texelSize;gl_Position=vec4(position.xy,1.0,1.0);}",nCt=class extends qa{constructor(){super({name:"DepthDownsamplingMaterial",defines:{DEPTH_PACKING:"0"},uniforms:{depthBuffer:new vn(null),normalBuffer:new vn(null),texelSize:new vn(new xt)},blending:Eu,toneMapped:!1,depthWrite:!1,depthTest:!1,fragmentShader:eCt,vertexShader:tCt})}set depthBuffer(t){this.uniforms.depthBuffer.value=t}set depthPacking(t){this.defines.DEPTH_PACKING=t.toFixed(0),this.needsUpdate=!0}setDepthBuffer(t,e=TE){this.depthBuffer=t,this.depthPacking=e}set normalBuffer(t){this.uniforms.normalBuffer.value=t,t!==null?this.defines.DOWNSAMPLE_NORMALS="1":delete this.defines.DOWNSAMPLE_NORMALS,this.needsUpdate=!0}setNormalBuffer(t){this.normalBuffer=t}setTexelSize(t,e){this.uniforms.texelSize.value.set(t,e)}setSize(t,e){this.uniforms.texelSize.value.set(1/t,1/e)}},iCt=class extends Td{constructor({normalBuffer:t=null,resolutionScale:e=.5,width:n=bu.AUTO_SIZE,height:i=bu.AUTO_SIZE,resolutionX:r=n,resolutionY:s=i}={}){super("DepthDownsamplingPass");const a=new nCt;a.normalBuffer=t,this.fullscreenMaterial=a,this.needsDepthTexture=!0,this.needsSwap=!1,this.renderTarget=new Ko(1,1,{minFilter:Va,magFilter:Va,depthBuffer:!1,type:vu}),this.renderTarget.texture.name="DepthDownsamplingPass.Target",this.renderTarget.texture.generateMipmaps=!1;const o=this.resolution=new bu(this,r,s,e);o.addEventListener("change",c=>this.setSize(o.baseWidth,o.baseHeight))}get texture(){return this.renderTarget.texture}getTexture(){return this.renderTarget.texture}getResolution(){return this.resolution}setDepthTexture(t,e=TE){this.fullscreenMaterial.depthBuffer=t,this.fullscreenMaterial.depthPacking=e}render(t,e,n,i,r){t.setRenderTarget(this.renderToScreen?null:this.renderTarget),t.render(this.scene,this.camera)}setSize(t,e){const n=this.resolution;n.setBaseSize(t,e),this.renderTarget.setSize(n.width,n.height),this.fullscreenMaterial.setSize(t,e)}initialize(t,e,n){const i=t.getContext();if(!(i.getExtension("EXT_color_buffer_float")||i.getExtension("EXT_color_buffer_half_float")))throw new Error("Rendering to float texture is not supported.")}},rCt=`uniform float offset;uniform float darkness;void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){const vec2 center=vec2(0.5);vec3 color=inputColor.rgb;
#if VIGNETTE_TECHNIQUE == 0
float d=distance(uv,center);color*=smoothstep(0.8,offset*0.799,d*(darkness+offset));
#else
vec2 coord=(uv-center)*vec2(offset);color=mix(color,vec3(1.0-darkness),dot(coord,coord));
#endif
outputColor=vec4(color,inputColor.a);}`,sCt=class extends yE{constructor({blendFunction:t,eskil:e=!1,technique:n=e?wM.ESKIL:wM.DEFAULT,offset:i=.5,darkness:r=.5}={}){super("VignetteEffect",rCt,{blendFunction:t,defines:new Map([["VIGNETTE_TECHNIQUE",n.toFixed(0)]]),uniforms:new Map([["offset",new vn(i)],["darkness",new vn(r)]])})}get technique(){return Number(this.defines.get("VIGNETTE_TECHNIQUE"))}set technique(t){this.technique!==t&&(this.defines.set("VIGNETTE_TECHNIQUE",t.toFixed(0)),this.setChanged())}get eskil(){return this.technique===wM.ESKIL}set eskil(t){this.technique=t?wM.ESKIL:wM.DEFAULT}getTechnique(){return this.technique}setTechnique(t){this.technique=t}get offset(){return this.uniforms.get("offset").value}set offset(t){this.uniforms.get("offset").value=t}getOffset(){return this.offset}setOffset(t){this.offset=t}get darkness(){return this.uniforms.get("darkness").value}set darkness(t){this.uniforms.get("darkness").value=t}getDarkness(){return this.darkness}setDarkness(t){this.darkness=t}},aCt=`#include <common>
#include <packing>
#include <dithering_pars_fragment>
#define packFloatToRGBA(v) packDepthToRGBA(v)
#define unpackRGBAToFloat(v) unpackRGBAToDepth(v)
#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D inputBuffer;
#else
uniform lowp sampler2D inputBuffer;
#endif
#if DEPTH_PACKING == 3201
uniform lowp sampler2D depthBuffer;
#elif defined(GL_FRAGMENT_PRECISION_HIGH)
uniform highp sampler2D depthBuffer;
#else
uniform mediump sampler2D depthBuffer;
#endif
uniform vec2 resolution;uniform vec2 texelSize;uniform float cameraNear;uniform float cameraFar;uniform float aspect;uniform float time;varying vec2 vUv;vec4 sRGBToLinear(const in vec4 value){return vec4(mix(pow(value.rgb*0.9478672986+vec3(0.0521327014),vec3(2.4)),value.rgb*0.0773993808,vec3(lessThanEqual(value.rgb,vec3(0.04045)))),value.a);}float readDepth(const in vec2 uv){
#if DEPTH_PACKING == 3201
return unpackRGBAToDepth(texture2D(depthBuffer,uv));
#else
return texture2D(depthBuffer,uv).r;
#endif
}float getViewZ(const in float depth){
#ifdef PERSPECTIVE_CAMERA
return perspectiveDepthToViewZ(depth,cameraNear,cameraFar);
#else
return orthographicDepthToViewZ(depth,cameraNear,cameraFar);
#endif
}vec3 RGBToHCV(const in vec3 RGB){vec4 P=mix(vec4(RGB.bg,-1.0,2.0/3.0),vec4(RGB.gb,0.0,-1.0/3.0),step(RGB.b,RGB.g));vec4 Q=mix(vec4(P.xyw,RGB.r),vec4(RGB.r,P.yzx),step(P.x,RGB.r));float C=Q.x-min(Q.w,Q.y);float H=abs((Q.w-Q.y)/(6.0*C+EPSILON)+Q.z);return vec3(H,C,Q.x);}vec3 RGBToHSL(const in vec3 RGB){vec3 HCV=RGBToHCV(RGB);float L=HCV.z-HCV.y*0.5;float S=HCV.y/(1.0-abs(L*2.0-1.0)+EPSILON);return vec3(HCV.x,S,L);}vec3 HueToRGB(const in float H){float R=abs(H*6.0-3.0)-1.0;float G=2.0-abs(H*6.0-2.0);float B=2.0-abs(H*6.0-4.0);return clamp(vec3(R,G,B),0.0,1.0);}vec3 HSLToRGB(const in vec3 HSL){vec3 RGB=HueToRGB(HSL.x);float C=(1.0-abs(2.0*HSL.z-1.0))*HSL.y;return(RGB-0.5)*C+HSL.z;}FRAGMENT_HEAD void main(){FRAGMENT_MAIN_UV vec4 color0=texture2D(inputBuffer,UV);vec4 color1=vec4(0.0);FRAGMENT_MAIN_IMAGE color0.a=clamp(color0.a,0.0,1.0);gl_FragColor=color0;
#ifdef ENCODE_OUTPUT
#include <colorspace_fragment>
#endif
#include <dithering_fragment>
}`,oCt="uniform vec2 resolution;uniform vec2 texelSize;uniform float cameraNear;uniform float cameraFar;uniform float aspect;uniform float time;varying vec2 vUv;VERTEX_HEAD void main(){vUv=position.xy*0.5+0.5;VERTEX_MAIN_SUPPORT gl_Position=vec4(position.xy,1.0,1.0);}",cCt=class extends qa{constructor(t,e,n,i,r=!1){super({name:"EffectMaterial",defines:{THREE_REVISION:WA.replace(/\D+/g,""),DEPTH_PACKING:"0",ENCODE_OUTPUT:"1"},uniforms:{inputBuffer:new vn(null),depthBuffer:new vn(null),resolution:new vn(new xt),texelSize:new vn(new xt),cameraNear:new vn(.3),cameraFar:new vn(1e3),aspect:new vn(1),time:new vn(0)},blending:Eu,toneMapped:!1,depthWrite:!1,depthTest:!1,dithering:r}),t&&this.setShaderParts(t),e&&this.setDefines(e),n&&this.setUniforms(n),this.copyCameraSettings(i)}set inputBuffer(t){this.uniforms.inputBuffer.value=t}setInputBuffer(t){this.uniforms.inputBuffer.value=t}get depthBuffer(){return this.uniforms.depthBuffer.value}set depthBuffer(t){this.uniforms.depthBuffer.value=t}get depthPacking(){return Number(this.defines.DEPTH_PACKING)}set depthPacking(t){this.defines.DEPTH_PACKING=t.toFixed(0),this.needsUpdate=!0}setDepthBuffer(t,e=TE){this.depthBuffer=t,this.depthPacking=e}setShaderData(t){this.setShaderParts(t.shaderParts),this.setDefines(t.defines),this.setUniforms(t.uniforms),this.setExtensions(t.extensions)}setShaderParts(t){return this.fragmentShader=aCt.replace(cs.FRAGMENT_HEAD,t.get(cs.FRAGMENT_HEAD)||"").replace(cs.FRAGMENT_MAIN_UV,t.get(cs.FRAGMENT_MAIN_UV)||"").replace(cs.FRAGMENT_MAIN_IMAGE,t.get(cs.FRAGMENT_MAIN_IMAGE)||""),this.vertexShader=oCt.replace(cs.VERTEX_HEAD,t.get(cs.VERTEX_HEAD)||"").replace(cs.VERTEX_MAIN_SUPPORT,t.get(cs.VERTEX_MAIN_SUPPORT)||""),this.needsUpdate=!0,this}setDefines(t){for(const e of t.entries())this.defines[e[0]]=e[1];return this.needsUpdate=!0,this}setUniforms(t){for(const e of t.entries())this.uniforms[e[0]]=e[1];return this}setExtensions(t){this.extensions={};for(const e of t)this.extensions[e]=!0;return this}get encodeOutput(){return this.defines.ENCODE_OUTPUT!==void 0}set encodeOutput(t){this.encodeOutput!==t&&(t?this.defines.ENCODE_OUTPUT="1":delete this.defines.ENCODE_OUTPUT,this.needsUpdate=!0)}isOutputEncodingEnabled(t){return this.encodeOutput}setOutputEncodingEnabled(t){this.encodeOutput=t}get time(){return this.uniforms.time.value}set time(t){this.uniforms.time.value=t}setDeltaTime(t){this.uniforms.time.value+=t}adoptCameraSettings(t){this.copyCameraSettings(t)}copyCameraSettings(t){t&&(this.uniforms.cameraNear.value=t.near,this.uniforms.cameraFar.value=t.far,t instanceof Hc?this.defines.PERSPECTIVE_CAMERA="1":delete this.defines.PERSPECTIVE_CAMERA,this.needsUpdate=!0)}setSize(t,e){const n=this.uniforms;n.resolution.value.set(t,e),n.texelSize.value.set(1/t,1/e),n.aspect.value=t/e}static get Section(){return cs}};function loe(t,e,n){for(const i of e){const r="$1"+t+i.charAt(0).toUpperCase()+i.slice(1),s=new RegExp("([^\\.])(\\b"+i+"\\b)","g");for(const a of n.entries())a[1]!==null&&n.set(a[0],a[1].replace(s,r))}}function lCt(t,e,n){let i=e.getFragmentShader(),r=e.getVertexShader();const s=i!==void 0&&/mainImage/.test(i),a=i!==void 0&&/mainUv/.test(i);if(n.attributes|=e.getAttributes(),i===void 0)throw new Error(`Missing fragment shader (${e.name})`);if(a&&n.attributes&Qb.CONVOLUTION)throw new Error(`Effects that transform UVs are incompatible with convolution effects (${e.name})`);if(!s&&!a)throw new Error(`Could not find mainImage or mainUv function (${e.name})`);{const o=/\w+\s+(\w+)\([\w\s,]*\)\s*{/g,c=n.shaderParts;let l=c.get(cs.FRAGMENT_HEAD)||"",u=c.get(cs.FRAGMENT_MAIN_UV)||"",h=c.get(cs.FRAGMENT_MAIN_IMAGE)||"",d=c.get(cs.VERTEX_HEAD)||"",f=c.get(cs.VERTEX_MAIN_SUPPORT)||"";const p=new Set,g=new Set;if(a&&(u+=`	${t}MainUv(UV);
`,n.uvTransformation=!0),r!==null&&/mainSupport/.test(r)){const b=/mainSupport *\([\w\s]*?uv\s*?\)/.test(r);f+=`	${t}MainSupport(`,f+=b?`vUv);
`:`);
`;for(const S of r.matchAll(/(?:varying\s+\w+\s+([\S\s]*?);)/g))for(const x of S[1].split(/\s*,\s*/))n.varyings.add(x),p.add(x),g.add(x);for(const S of r.matchAll(o))g.add(S[1])}for(const b of i.matchAll(o))g.add(b[1]);for(const b of e.defines.keys())g.add(b.replace(/\([\w\s,]*\)/g,""));for(const b of e.uniforms.keys())g.add(b);g.delete("while"),g.delete("for"),g.delete("if"),e.uniforms.forEach((b,S)=>n.uniforms.set(t+S.charAt(0).toUpperCase()+S.slice(1),b)),e.defines.forEach((b,S)=>n.defines.set(t+S.charAt(0).toUpperCase()+S.slice(1),b));const _=new Map([["fragment",i],["vertex",r]]);loe(t,g,n.defines),loe(t,g,_),i=_.get("fragment"),r=_.get("vertex");const v=e.blendMode;if(n.blendModes.set(v.blendFunction,v),s){e.inputColorSpace!==null&&e.inputColorSpace!==n.colorSpace&&(h+=e.inputColorSpace===ls?`color0 = sRGBTransferOETF(color0);
	`:`color0 = sRGBToLinear(color0);
	`),e.outputColorSpace!==gm?n.colorSpace=e.outputColorSpace:e.inputColorSpace!==null&&(n.colorSpace=e.inputColorSpace);const b=/MainImage *\([\w\s,]*?depth[\w\s,]*?\)/;h+=`${t}MainImage(color0, UV, `,n.attributes&Qb.DEPTH&&b.test(i)&&(h+="depth, ",n.readDepth=!0),h+=`color1);
	`;const S=t+"BlendOpacity";n.uniforms.set(S,v.opacity),h+=`color0 = blend${v.blendFunction}(color0, color1, ${S});

	`,l+=`uniform float ${S};

`}if(l+=i+`
`,r!==null&&(d+=r+`
`),c.set(cs.FRAGMENT_HEAD,l),c.set(cs.FRAGMENT_MAIN_UV,u),c.set(cs.FRAGMENT_MAIN_IMAGE,h),c.set(cs.VERTEX_HEAD,d),c.set(cs.VERTEX_MAIN_SUPPORT,f),e.extensions!==null)for(const b of e.extensions)n.extensions.add(b)}}var uCt=class extends Td{constructor(t,...e){super("EffectPass"),this.fullscreenMaterial=new cCt(null,null,null,t),this.listener=n=>this.handleEvent(n),this.effects=[],this.setEffects(e),this.skipRendering=!1,this.minTime=1,this.maxTime=Number.POSITIVE_INFINITY,this.timeScale=1}set mainScene(t){for(const e of this.effects)e.mainScene=t}set mainCamera(t){this.fullscreenMaterial.copyCameraSettings(t);for(const e of this.effects)e.mainCamera=t}get encodeOutput(){return this.fullscreenMaterial.encodeOutput}set encodeOutput(t){this.fullscreenMaterial.encodeOutput=t}get dithering(){return this.fullscreenMaterial.dithering}set dithering(t){const e=this.fullscreenMaterial;e.dithering=t,e.needsUpdate=!0}setEffects(t){for(const e of this.effects)e.removeEventListener("change",this.listener);this.effects=t.sort((e,n)=>n.attributes-e.attributes);for(const e of this.effects)e.addEventListener("change",this.listener)}updateMaterial(){const t=new Kxt;let e=0;for(const a of this.effects)if(a.blendMode.blendFunction===sr.DST)t.attributes|=a.getAttributes()&Qb.DEPTH;else{if(t.attributes&a.getAttributes()&Qb.CONVOLUTION)throw new Error(`Convolution effects cannot be merged (${a.name})`);lCt("e"+e++,a,t)}let n=t.shaderParts.get(cs.FRAGMENT_HEAD),i=t.shaderParts.get(cs.FRAGMENT_MAIN_IMAGE),r=t.shaderParts.get(cs.FRAGMENT_MAIN_UV);const s=/\bblend\b/g;for(const a of t.blendModes.values())n+=a.getShaderCode().replace(s,`blend${a.blendFunction}`)+`
`;t.attributes&Qb.DEPTH?(t.readDepth&&(i=`float depth = readDepth(UV);

	`+i),this.needsDepthTexture=this.getDepthTexture()===null):this.needsDepthTexture=!1,t.colorSpace===ls&&(i+=`color0 = sRGBToLinear(color0);
	`),t.uvTransformation?(r=`vec2 transformedUv = vUv;
`+r,t.defines.set("UV","transformedUv")):t.defines.set("UV","vUv"),t.shaderParts.set(cs.FRAGMENT_HEAD,n),t.shaderParts.set(cs.FRAGMENT_MAIN_IMAGE,i),t.shaderParts.set(cs.FRAGMENT_MAIN_UV,r);for(const[a,o]of t.shaderParts)o!==null&&t.shaderParts.set(a,o.trim().replace(/^#/,`
#`));this.skipRendering=e===0,this.needsSwap=!this.skipRendering,this.fullscreenMaterial.setShaderData(t)}recompile(){this.updateMaterial()}getDepthTexture(){return this.fullscreenMaterial.depthBuffer}setDepthTexture(t,e=TE){this.fullscreenMaterial.depthBuffer=t,this.fullscreenMaterial.depthPacking=e;for(const n of this.effects)n.setDepthTexture(t,e)}render(t,e,n,i,r){for(const s of this.effects)s.update(t,e,i);if(!this.skipRendering||this.renderToScreen){const s=this.fullscreenMaterial;s.inputBuffer=e.texture,s.time+=i*this.timeScale,t.setRenderTarget(this.renderToScreen?null:n),t.render(this.scene,this.camera)}}setSize(t,e){this.fullscreenMaterial.setSize(t,e);for(const n of this.effects)n.setSize(t,e)}initialize(t,e,n){this.renderer=t;for(const i of this.effects)i.initialize(t,e,n);this.updateMaterial(),n!==void 0&&n!==lo&&(this.fullscreenMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1")}dispose(){super.dispose();for(const t of this.effects)t.removeEventListener("change",this.listener),t.dispose()}handleEvent(t){switch(t.type){case"change":this.recompile();break}}},hCt=class extends Td{constructor(t,e,{renderTarget:n,resolutionScale:i=1,width:r=bu.AUTO_SIZE,height:s=bu.AUTO_SIZE,resolutionX:a=r,resolutionY:o=s}={}){super("NormalPass"),this.needsSwap=!1,this.renderPass=new JSe(t,e,new uW);const c=this.renderPass;c.ignoreBackground=!0,c.skipShadowMapUpdate=!0;const l=c.getClearPass();l.overrideClearColor=new bn(7829503),l.overrideClearAlpha=1,this.renderTarget=n,this.renderTarget===void 0&&(this.renderTarget=new Ko(1,1,{minFilter:Va,magFilter:Va}),this.renderTarget.texture.name="NormalPass.Target");const u=this.resolution=new bu(this,a,o,i);u.addEventListener("change",h=>this.setSize(u.baseWidth,u.baseHeight))}set mainScene(t){this.renderPass.mainScene=t}set mainCamera(t){this.renderPass.mainCamera=t}get texture(){return this.renderTarget.texture}getTexture(){return this.renderTarget.texture}getResolution(){return this.resolution}getResolutionScale(){return this.resolution.scale}setResolutionScale(t){this.resolution.scale=t}render(t,e,n,i,r){const s=this.renderToScreen?null:this.renderTarget;this.renderPass.render(t,s,s)}setSize(t,e){const n=this.resolution;n.setBaseSize(t,e),this.renderTarget.setSize(n.width,n.height)}};function PO(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}new xt;new xt;function QSe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var $f=function t(e,n,i){var r=this;QSe(this,t),PO(this,"dot2",function(s,a){return r.x*s+r.y*a}),PO(this,"dot3",function(s,a,o){return r.x*s+r.y*a+r.z*o}),this.x=e,this.y=n,this.z=i},dCt=[new $f(1,1,0),new $f(-1,1,0),new $f(1,-1,0),new $f(-1,-1,0),new $f(1,0,1),new $f(-1,0,1),new $f(1,0,-1),new $f(-1,0,-1),new $f(0,1,1),new $f(0,-1,1),new $f(0,1,-1),new $f(0,-1,-1)],uoe=[151,160,137,91,90,15,131,13,201,95,96,53,194,233,7,225,140,36,103,30,69,142,8,99,37,240,21,10,23,190,6,148,247,120,234,75,0,26,197,62,94,252,219,203,117,35,11,32,57,177,33,88,237,149,56,87,174,20,125,136,171,168,68,175,74,165,71,134,139,48,27,166,77,146,158,231,83,111,229,122,60,211,133,230,220,105,92,41,55,46,245,40,244,102,143,54,65,25,63,161,1,216,80,73,209,76,132,187,208,89,18,169,200,196,135,130,116,188,159,86,164,100,109,198,173,186,3,64,52,217,226,250,124,123,5,202,38,147,118,126,255,82,85,212,207,206,59,227,47,16,58,17,182,189,28,42,223,183,170,213,119,248,152,2,44,154,163,70,221,153,101,155,167,43,172,9,129,22,39,253,19,98,108,110,79,113,224,232,178,185,112,104,218,246,97,228,251,34,242,193,238,210,144,12,191,179,162,241,81,51,145,235,249,14,239,107,49,192,214,31,181,199,106,157,184,84,204,176,115,121,50,45,127,4,150,254,138,236,205,93,222,114,67,29,24,72,243,141,128,195,78,66,215,61,156,180],hoe=new Array(512),doe=new Array(512),fCt=function(e){e>0&&e<1&&(e*=65536),e=Math.floor(e),e<256&&(e|=e<<8);for(var n=0;n<256;n++){var i;n&1?i=uoe[n]^e&255:i=uoe[n]^e>>8&255,hoe[n]=hoe[n+256]=i,doe[n]=doe[n+256]=dCt[i%12]}};fCt(0);function pCt(t){if(typeof t=="number")t=Math.abs(t);else if(typeof t=="string"){var e=t;t=0;for(var n=0;n<e.length;n++)t=(t+(n+1)*(e.charCodeAt(n)%96))%2147483647}return t===0&&(t=311),t}function foe(t){var e=pCt(t);return function(){var n=e*48271%2147483647;return e=n,n/2147483647}}var mCt=function t(e){var n=this;QSe(this,t),PO(this,"seed",0),PO(this,"init",function(i){n.seed=i,n.value=foe(i)}),PO(this,"value",foe(this.seed)),this.init(e)};new mCt(Math.random());const gCt=De.createContext(null),poe=t=>(t.getAttributes()&2)===2,vCt=De.memo(De.forwardRef(({children:t,camera:e,scene:n,resolutionScale:i,enabled:r=!0,renderPriority:s=1,autoClear:a=!0,depthBuffer:o,enableNormalPass:c,stencilBuffer:l,multisampling:u=8,frameBufferType:h=SE},d)=>{const{gl:f,scene:p,camera:g,size:_}=Tu(),v=n||p,b=e||g,[S,x,M]=De.useMemo(()=>{const k=new Yxt(f,{depthBuffer:o,stencilBuffer:l,multisampling:u,frameBufferType:h});k.addPass(new JSe(v,b));let P=null,U=null;return c&&(U=new hCt(v,b),U.enabled=!1,k.addPass(U),i!==void 0&&(P=new iCt({normalBuffer:U.texture,resolutionScale:i}),P.enabled=!1,k.addPass(P))),[k,U,P]},[b,f,o,l,u,h,v,c,i]);De.useEffect(()=>S==null?void 0:S.setSize(_.width,_.height),[S,_]),Pm((k,P)=>{if(r){const U=f.autoClear;f.autoClear=a,l&&!a&&f.clearStencil(),S.render(P),f.autoClear=U}},r?s:0);const R=De.useRef(null);De.useLayoutEffect(()=>{var U;const k=[],P=R.current.__r3f;if(P&&S){const V=P.children;for(let $=0;$<V.length;$++){const q=V[$].object;if(q instanceof yE){const Y=[q];if(!poe(q)){let G=null;for(;(G=(U=V[$+1])==null?void 0:U.object)instanceof yE&&!poe(G);)Y.push(G),$++}const te=new uCt(b,...Y);k.push(te)}else q instanceof Td&&k.push(q)}for(const $ of k)S==null||S.addPass($);x&&(x.enabled=!0),M&&(M.enabled=!0)}return()=>{for(const V of k)S==null||S.removePass(V);x&&(x.enabled=!1),M&&(M.enabled=!1)}},[S,t,b,x,M]),De.useEffect(()=>{const k=f.toneMapping;return f.toneMapping=Em,()=>{f.toneMapping=k}},[f]);const I=De.useMemo(()=>({composer:S,normalPass:x,downSamplingPass:M,resolutionScale:i,camera:b,scene:v}),[S,x,M,i,b,v]);return De.useImperativeHandle(d,()=>S,[S]),be.jsx(gCt.Provider,{value:I,children:be.jsx("group",{ref:R,children:t})})}));let _Ct=0;const moe=new WeakMap,fP=(t,e)=>function({blendFunction:n=e==null?void 0:e.blendFunction,opacity:i=e==null?void 0:e.opacity,...r}){let s=moe.get(t);if(!s){const c=`@react-three/postprocessing/${t.name}-${_Ct++}`;DW({[c]:t}),moe.set(t,s=c)}const a=Tu(c=>c.camera),o=Sm.useMemo(()=>[...(e==null?void 0:e.args)??[],...r.args??[{...e,...r}]],[JSON.stringify(r)]);return be.jsx(s,{camera:a,"blendMode-blendFunction":n,"blendMode-opacity-value":i,...r,args:o})},C2=(t,e)=>{const n=t[e];return Sm.useMemo(()=>typeof n=="number"?new xt(n,n):n?new xt(...n):new xt,[n])},yCt=fP($wt,{blendFunction:0}),bCt=De.forwardRef(function({active:t=!0,...e},n){const i=Tu(l=>l.invalidate),r=C2(e,"delay"),s=C2(e,"duration"),a=C2(e,"strength"),o=C2(e,"chromaticAberrationOffset"),c=De.useMemo(()=>new Kwt({...e,delay:r,duration:s,strength:a,chromaticAberrationOffset:o}),[r,s,e,a,o]);return De.useLayoutEffect(()=>{c.mode=t?e.mode||bb.SPORADIC:bb.DISABLED,i()},[t,c,i,e.mode]),De.useEffect(()=>()=>{var l;(l=c.dispose)==null||l.call(c)},[c]),be.jsx("primitive",{ref:n,object:c,dispose:null})}),ECt=fP(Zwt,{blendFunction:5}),SCt=fP(Qwt,{blendFunction:24,density:1.25}),TCt=fP(sCt);var Op=typeof window<"u"?window:{screen:{},navigator:{}},HA=(Op.matchMedia||function(){return{matches:!1}}).bind(Op),xCt={get passive(){return!0}},eTe=function(){};Op.addEventListener&&Op.addEventListener("p",eTe,xCt);Op.removeEventListener&&Op.removeEventListener("p",eTe,!1);var mZ="ontouchstart"in Op,wCt="TouchEvent"in Op,CCt=mZ||wCt&&HA("(any-pointer: coarse)").matches,goe=(Op.navigator.maxTouchPoints||0)>0||CCt,tTe=Op.navigator.userAgent||"",ACt=HA("(pointer: coarse)").matches&&/iPad|Macintosh/.test(tTe)&&Math.min(Op.screen.width||0,Op.screen.height||0)>=768,nTe=(HA("(pointer: coarse)").matches||!HA("(pointer: fine)").matches&&mZ)&&!/Windows.*Firefox/.test(tTe),RCt=HA("(any-pointer: fine)").matches||HA("(any-hover: hover)").matches||ACt||!mZ,o7=goe&&(RCt||!nTe)?"hybrid":goe?"touchOnly":"mouseOnly",MCt=o7==="mouseOnly"?"mouse":o7==="touchOnly"||nTe?"touch":"mouse";const OCt=`  
vec3 halftone(vec3 texcolor, vec2 st, float frequency) {
  float n = 0.1 * snoise(st * 200.0); // Fractal noise
  n += 0.05 * snoise(st * 400.0);
  n += 0.025 * snoise(st * 800.0);

  // Perform a rough RGB-to-CMYK conversion
  vec4 cmyk;
  // CMY = 1-RGB
  cmyk.xyz = 1.0 - texcolor;
  // Black generation: K = min(C,M,Y)
  cmyk.w = min(cmyk.x, min(cmyk.y, cmyk.z)); 
  // Grey component replacement: subtract K from CMY
  cmyk.xyz -= cmyk.w; 

  // K based modifier
  float flex = pow(cmyk.w, 3.11);

  // Distance to nearest point in a grid of
  // (frequency x frequency) points over the unit square
  
  float t = 0.1 + 0.1 * n + 0.11 * flex + 0.1 * cmyk.y;

  // K component: 45 degrees screen angle
  vec2 Kst = frequency * mat2(0.707, -0.707, 0.707, 0.707) * st;
  vec2 Kuv = 2.0 * fract(Kst) - 1.0; 
  float k = aastep(0.0, sqrt(cmyk.w) + t - length(Kuv) + n);
  
  // C component: 15 degrees screen angle
  vec2 Cst = frequency*mat2(0.966, -0.259, 0.259, 0.966) * st;
  vec2 Cuv = 2.0 * fract(Cst) - 1.0;
  float c = aastep(0.0, sqrt(cmyk.x) + t - length(Cuv) + n);
  
  // M component: -15 degrees screen angle
  vec2 Mst = frequency * mat2(0.966, 0.259, -0.259, 0.966) * st;
  vec2 Muv = 2.0 * fract(Mst) - 1.0;
  float m = aastep(0.0, sqrt(cmyk.y) + t - length(Muv) + n);

  // Y component: 0 degrees screen angle
  vec2 Yst = frequency * st; // 0 deg 
  vec2 Yuv = 2.0 * fract(Yst) - 1.0;
  float y = aastep(0.0, sqrt(cmyk.z) + t - length(Yuv) + n);

  // CMY screen in RGB
  vec3 black = vec3(n + 0.01);
  vec3 rgbscreen = 1.0 - vec3(c,m,y) + n;
  
  // Blend in K for final color
  vec3 factor = mix(rgbscreen, black, 1.1 * k + 0.3 * n);

  // Blend with og color
  return mix(factor, texcolor, 0.777);
}

vec3 halftone(vec3 texcolor, vec2 st) {
  return halftone(texcolor, st, 412.321);
}
`,NCt=`
float blendLighten(float base, float blend) {
	return max(blend,base);
}

vec3 blendLighten(vec3 base, vec3 blend) {
	return vec3(blendLighten(base.r,blend.r),blendLighten(base.g,blend.g),blendLighten(base.b,blend.b));
}

vec3 blendLighten(vec3 base, vec3 blend, float opacity) {
	return (blendLighten(base, blend) * opacity + base * (1.0 - opacity));
}

float blendDarken(float base, float blend) {
	return min(blend,base);
}

vec3 blendDarken(vec3 base, vec3 blend) {
	return vec3(blendDarken(base.r,blend.r),blendDarken(base.g,blend.g),blendDarken(base.b,blend.b));
}

vec3 blendDarken(vec3 base, vec3 blend, float opacity) {
	return (blendDarken(base, blend) * opacity + base * (1.0 - opacity));
}
`,ICt=`
float aastep(float threshold, float value) {
  float afwidth = length(vec2(dFdx(value), dFdy(value))) * 0.70710678118654757;
  return smoothstep(threshold-afwidth, threshold+afwidth, value);
}
`,kCt=`
//
// Description : Array and textureless GLSL 2D simplex noise function.
//      Author : Ian McEwan, Ashima Arts.
//  Maintainer : ijm
//     Lastmod : 20110822 (ijm)
//     License : Copyright (C) 2011 Ashima Arts. All rights reserved.
//               Distributed under the MIT License. See LICENSE file.
//               https://github.com/ashima/webgl-noise
//

vec3 mod289(vec3 x) {
  return x - floor(x * (1.0 / 289.0)) * 289.0;
}

vec2 mod289(vec2 x) {
  return x - floor(x * (1.0 / 289.0)) * 289.0;
}

vec3 permute(vec3 x) {
  return mod289(((x*34.0)+1.0)*x);
}

float snoise(vec2 v) {
  const vec4 C = vec4(0.211324865405187,  // (3.0-sqrt(3.0))/6.0
                      0.366025403784439,  // 0.5*(sqrt(3.0)-1.0)
                     -0.577350269189626,  // -1.0 + 2.0 * C.x
                      0.024390243902439); // 1.0 / 41.0
// First corner
  vec2 i  = floor(v + dot(v, C.yy) );
  vec2 x0 = v -   i + dot(i, C.xx);

// Other corners
  vec2 i1;
  //i1.x = step( x0.y, x0.x ); // x0.x > x0.y ? 1.0 : 0.0
  //i1.y = 1.0 - i1.x;
  i1 = (x0.x > x0.y) ? vec2(1.0, 0.0) : vec2(0.0, 1.0);
  // x0 = x0 - 0.0 + 0.0 * C.xx ;
  // x1 = x0 - i1 + 1.0 * C.xx ;
  // x2 = x0 - 1.0 + 2.0 * C.xx ;
  vec4 x12 = x0.xyxy + C.xxzz;
  x12.xy -= i1;

// Permutations
  i = mod289(i); // Avoid truncation effects in permutation
  vec3 p = permute( permute( i.y + vec3(0.0, i1.y, 1.0 ))
    + i.x + vec3(0.0, i1.x, 1.0 ));

  vec3 m = max(0.5 - vec3(dot(x0,x0), dot(x12.xy,x12.xy), dot(x12.zw,x12.zw)), 0.0);
  m = m*m ;
  m = m*m ;

// Gradients: 41 points uniformly over a line, mapped onto a diamond.
// The ring size 17*17 = 289 is close to a multiple of 41 (41*7 = 287)

  vec3 x = 2.0 * fract(p * C.www) - 1.0;
  vec3 h = abs(x) - 0.5;
  vec3 ox = floor(x + 0.5);
  vec3 a0 = x - ox;

// Normalise gradients implicitly by scaling m
// Approximation of: m *= inversesqrt( a0*a0 + h*h );
  m *= 1.79284291400159 - 0.85373472095314 * ( a0*a0 + h*h );

// Compute final noise value at P
  vec3 g;
  g.x  = a0.x  * x0.x  + h.x  * x0.y;
  g.yz = a0.yz * x12.xz + h.yz * x12.yw;
  return 130.0 * dot(m, g);
}
`,PCt=`
#ifdef ASPECT_CORRECTION
	uniform float scale;
#else
	uniform mat3 uvTransform;
#endif

varying vec2 vUv2;

void mainSupport(const in vec2 uv) {
	#ifdef ASPECT_CORRECTION
		vUv2 = uv * vec2(aspect, 1.0) * scale;
	#else
		vUv2 = (uvTransform * vec3(uv, 1.0)).xy;
	#endif
}
`,DCt=`
uniform float viewheight;
uniform sampler2D splat;

${NCt}
${ICt}
${kCt}
${OCt}

float rectdistance(vec2 uv) {
  vec2 tl = vec2(-1.0);
  vec2 br = vec2(1.0);
  vec2 d = max(tl - uv, uv - br);
  return abs(length(max(vec2(0.0), d)) + min(0.0, max(d.x, d.y)));
}

vec2 bendy(const in vec2 xn, float dn, float sn) {
  // config
  float distortion = 0.0173 + dn; // 0.0173, 0.511
  float scale = 0.991 + sn; // 1.0, 0.7
  // calc
  vec3 xDistorted = vec3((1.0 + vec2(distortion, distortion) * dot(xn, xn)) * xn, 1.0);
  mat3 kk = mat3(
    vec3(1.0, 0.0, 0.0),
    vec3(0.0, 1.0, 0.0),
    vec3(0.0, 0.0, 1.0)
  );
  return (kk * xDistorted).xy * scale;
}

void mainImage(const in vec4 inputColor, const in vec2 uv, out vec4 outputColor) {
	#ifdef UV_TRANSFORM
		vec4 bright = texture2D(splat, vUv2);
		vec4 dark = texture2D(splat, 1.0 - vUv2);
	#else
		vec4 bright = texture2D(splat, uv);
		vec4 dark = texture2D(splat, 1.0 - uv);
	#endif
  
  float n = 0.1 * snoise(uv.st * 200.0); // Fractal noise
  n += 0.05 * snoise(uv.st * 400.0);
  n += 0.025 * snoise(uv.st * 800.0);

  vec2 xn = 2.0 * (uv.st - 0.5);
  float fz = 0.005;
  vec2 edge = bendy(xn, fz * n, -fz * n);
  vec2 bent = edge.xy * 0.5 + 0.5;
  
  float dx = rectdistance(xn);
  float bx = rectdistance(edge);

  // apply shape
  float doot = max(abs(edge.x), abs(edge.y));
  if (doot < 1.0) {
    // display
    outputColor = texture2D(inputBuffer, bent);

    // apply scratches
    outputColor.rgb = blendLighten(outputColor.rgb, bright.rgb, 0.079);
    outputColor.rgb = blendDarken(outputColor.rgb, dark.rgb, 0.0666);

    // apply halftones
    outputColor.rgb = halftone(outputColor.rgb, uv.st);
  
  } else if (doot > 1.004) {
    // display shell
    // rbgb 205 205 193
    vec3 matte = vec3(205.0 / 255.0, 205.0 / 255.0, 193.0 / 255.0);
    vec3 dkmatte = mix(matte, vec3(0.0), 0.5);
    float mx = pow(1.0 - bx, 16.0) + n;
    outputColor = vec4(mix(matte, dkmatte, mx), inputColor.a);

  } else {
    // border
    outputColor = vec4(mix(vec3(0.0), outputColor.rgb, 0.5), inputColor.a);
  }

  // apply inner shade
  if (doot >= 0.5 && doot < 1.0) {
    float sh = clamp(0.0, 1.0, 1.0 - bx - 0.7);
    vec3 shade = mix(outputColor.rgb, vec3(0.0), pow(sh, 4.0));
    outputColor = vec4(shade, inputColor.a);
  }

  // apply outer shade
  if (doot >= 0.97) {
    float sh = clamp(0.0, 1.0, bx * 24.0);
    vec3 dkout = mix(vec3(0.0), outputColor.rgb, 0.81);
    vec3 shade = mix(dkout, outputColor.rgb, sh);
    outputColor = vec4(shade, inputColor.a);
  }
}
`;class LCt extends yE{constructor({splat:e,viewheight:n}={}){super("CRTShapeEffect",DCt,{blendFunction:sr.NORMAL,attributes:Qb.CONVOLUTION,defines:new Map([["TEXEL","texel"],["TEXTURE_PRECISION_HIGH","1"]]),uniforms:new Map([["splat",new vn(e)],["viewheight",new vn(n??128)]])})}get splat(){var e;return(e=this.uniforms.get("splat"))==null?void 0:e.value}set splat(e){const{splat:n,uniforms:i,defines:r}=this,s=i.get("splat"),a=i.get("uvTransform");n!==e&&s&&a&&(s.value=e,a.value=e.matrix,r.delete("TEXTURE_PRECISION_HIGH"),e!==null&&(e.matrixAutoUpdate?(r.set("UV_TRANSFORM","1"),this.setVertexShader(PCt)):(r.delete("UV_TRANSFORM"),this.setVertexShader(null)),e.type!==lo&&r.set("TEXTURE_PRECISION_HIGH","1"),(n===null||(n==null?void 0:n.type)!==e.type)&&this.setChanged()))}getTexture(){return this.splat}setTexture(e){this.splat=e}get aspectCorrection(){return this.defines.has("ASPECT_CORRECTION")}set aspectCorrection(e){this.aspectCorrection!==e&&(e?this.defines.set("ASPECT_CORRECTION","1"):this.defines.delete("ASPECT_CORRECTION"),this.setChanged())}get uvTransform(){const e=this.splat;return!!(e!=null&&e.matrixAutoUpdate)}set uvTransform(e){const n=this.splat;re(n)&&(n.matrixAutoUpdate=e)}setTextureSwizzleRGBA(e,n=e,i=e,r=e){const s="rgba";let a="";(e!==x2.RED||n!==x2.GREEN||i!==x2.BLUE||r!==x2.ALPHA)&&(a=[".",s[e],s[n],s[i],s[r]].join("")),this.defines.set("TEXEL","texel"+a),this.setChanged()}update(){var e;(e=this.splat)!=null&&e.matrixAutoUpdate&&this.splat.updateMatrix()}}const UCt=fP(LCt);function BCt(t,e,n,i){const r=e*n*4;for(let s=0,a=0;s<r;++a)t.image.data[s]=i[a]*255,s+=4;return t.needsUpdate=!0,t}function FCt(t,e){const n=new Uint8Array(4*t*e);return new lf(n,t,e)}const zCt=new qa({transparent:!1,side:Vc,uniforms:{color:{value:new bn(0,0,0)},data:{value:null}},vertexShader:`
      varying vec2 vUv;
    
      void main() {
        vec4 mvPosition = modelViewMatrix * vec4(position, 1.0);
        gl_Position = projectionMatrix * mvPosition;
        
        vUv = uv;
      }
    `,fragmentShader:`
      uniform vec3 color;
      uniform sampler2D data;
  
      varying vec2 vUv;

      // adapted from https://www.shadertoy.com/view/Mlt3z8
      float bayerDither2x2( vec2 v ) {
        return mod( 3.0 * v.y + 2.0 * v.x, 4.0 );
      }

      float bayerDither4x4( vec2 v ) {
        vec2 P1 = mod( v, 2.0 );
        vec2 P2 = mod( floor( 0.5  * v ), 2.0 );
        return 4.0 * bayerDither2x2( P1 ) + bayerDither2x2( P2 );
      }

      void main() {
        float alpha = texture2D(data, vUv).r;
        if (alpha < 1.0) {
          vec2 ditherCoord = floor( mod( gl_FragCoord.xy, 4.0 ) );
          if ( bayerDither4x4( ditherCoord ) / 16.0 >= alpha ) {
            discard;
          }
        }

        gl_FragColor.rgba = vec4(color.xyz, 1.0);
      }
    `});function jCt(){return dP(zCt)}const kB=[0,1,0],iTe=[1,1,0],PB=[1,0,0],rTe=[0,0,0],HCt=new Float32Array([...kB,...PB,...iTe,...kB,...rTe,...PB]),VCt=new Float32Array([...kB.slice(0,2),...PB.slice(0,2),...iTe.slice(0,2),...kB.slice(0,2),...rTe.slice(0,2),...PB.slice(0,2)]);function GCt(t,e,n,i,r,s){const a=e*n*4;for(let o=0,c=0;o<a;++c){const l=i[c]??0;t.image.data[o++]=l%dp,t.image.data[o++]=Math.floor(l/dp),t.image.data[o++]=r[c]??16,t.image.data[o++]=s[c]??16}return t.needsUpdate=!0,t}function qCt(t,e){const n=new Uint8Array(4*t*e),i=new lf(n,t,e,kI,lo);return i.internalFormat="RGBA8UI",i}function sTe(t,e,n){const i=e*Kt.DRAW_CHAR_WIDTH(),r=n*Kt.DRAW_CHAR_HEIGHT(),s=HCt.map((a,o)=>{switch(o%3){case 0:return a*i;case 1:return a*r;default:return a}});t.setAttribute("position",new ar(s,3)),t.setAttribute("uv",new ar(VCt,2)),t.computeBoundingBox(),t.computeBoundingSphere()}const $Ct=CA(PE(G1)),voe=VT(V1(dR)),WCt=new qa({transparent:!1,side:Vc,uniforms:{time:Jd,interval:hP,palette:new vn($Ct),map:new vn(voe),alt:new vn(voe),data:new vn(null),size:new vn(new xt),step:new vn(new xt),flip:new vn(!0)},vertexShader:`
    varying vec2 vUv;
    void main() {
      vec4 mvPosition = modelViewMatrix * vec4(position, 1.0);
      gl_Position = projectionMatrix * mvPosition;
      vUv = uv;
    }
  `,fragmentShader:`
    uniform float time;
    uniform float interval;
    uniform sampler2D map;
    uniform sampler2D alt;
    uniform usampler2D data;
    uniform vec3 palette[16];
    uniform vec2 size;
    uniform vec2 step;
    uniform bool flip;
    varying vec2 vUv;

    void main() {
      uvec4 tiledata = texture(data, vUv);
      int colori = int(tiledata.z);
      int bgi = int(tiledata.w);

      vec2 charPosition = mod(vUv, size) / size;
      vec2 uv = vec2(charPosition.x * step.x, charPosition.y * step.y);
      vec3 color = palette[colori];

      uv.x += step.x * float(tiledata.x);
      uv.y += step.y * float(tiledata.y);
      if (flip) {
        uv.y = 1.0 - uv.y;
      }

      bool useAlt = mod(time, interval * 2.0) > interval;
      vec3 blip = useAlt ? texture(alt, uv).rgb : texture(map, uv).rgb;

      if (blip.r == 0.0) {
        if (bgi >= ${qt.ONCLEAR}) {
          discard;
        }
        color = palette[bgi];
      }

      gl_FragColor.rgb = color;
      gl_FragColor.a = 1.0;
    }
  `});function YCt(){return dP(WCt)}function E_({width:t,height:e,alphas:n}){const i=De.useRef(null),[r]=De.useState(()=>jCt());return De.useEffect(()=>{r.uniforms.data.value=FCt(t,e)},[r.uniforms.data,t,e]),De.useEffect(()=>{BCt(r.uniforms.data.value,t,e,n)},[r.uniforms.data.value,t,e,n]),De.useEffect(()=>{i.current&&(sTe(i.current,t,e),r.needsUpdate=!0)},[r,t,e]),be.jsx("mesh",{material:r,children:be.jsx("bufferGeometry",{ref:i})})}function KCt({width:t,height:e,alpha:n}){const i=De.useMemo(()=>new Array(t*e).fill(n),[t,e,n]);return be.jsx(E_,{width:t,height:e,alphas:i})}const CM=new que,KS=new xt;function vI({width:t,height:e,top:n,left:i,right:r,bottom:s,scale:a=.125,alpha:o=.25}){const c=De.useMemo(()=>{const l=new Array(t*e);CM.min.x=i,CM.min.y=n,CM.max.x=r,CM.max.y=s,KS.x=0,KS.y=0;for(let u=0;u<l.length;++u)l[u]=jle.smootherstep(1-CM.distanceToPoint(KS)*a,0,1)*o,++KS.x,KS.x>=t&&(KS.x=0,++KS.y);return l},[t,e,n,i,r,s,a,o]);return be.jsx(E_,{width:t,height:e,alphas:c})}const Q_=De.createContext({sendmessage(){},sendclose(){},didclose(){}}),_oe={input:{color:"$white",active:"$yellow"}};function Hm(t){return t?_oe.input.active:_oe.input.color}function W8(t,e){switch(t){case"touchkey":return`register:${t}:${e}`}return`vm:${t}:${e}`}function KM(t,e,n=0,i=""){return`${t.substring(0,e)}${i}${t.substring(e+n)}`}function Up(t,e){re(t)&&(e.x=1,e.y=t)}function pP({width:t,height:e,char:n,color:i,bg:r,fliptexture:s=!0}){const a=_p(f=>f.palettedata),o=_p(f=>f.charsetdata),c=_p(f=>f.altcharsetdata),[l]=De.useState(()=>YCt()),u=De.useRef(null),{width:h=0,height:d=0}=(o==null?void 0:o.image)??{};return De.useEffect(()=>{t===0||e===0||(l.uniforms.data.value=qCt(t,e))},[l.uniforms.data,t,e]),De.useEffect(()=>{t===0||e===0||GCt(l.uniforms.data.value,t,e,n,i,r)},[l.uniforms.data.value,t,e,n,i,r]),De.useEffect(()=>{t===0||e===0||!u.current||!o||(sTe(u.current,t,e),l.uniforms.map.value=o,l.uniforms.alt.value=c??o,l.uniforms.palette.value=a,l.uniforms.size.value.x=1/t,l.uniforms.size.value.y=1/e,l.uniforms.step.value.x=1/Math.round(h/p_),l.uniforms.step.value.y=1/Math.round(d/m_),l.uniforms.flip.value=s,l.needsUpdate=!0)},[a,o,c,l,t,e,h,d,s]),be.jsx("mesh",{material:l,children:be.jsx("bufferGeometry",{ref:u})})}function mP({store:t,children:e}){return be.jsx(zK.Provider,{value:t,children:e})}function gP({width:t,height:e}){const n=De.useContext(zK),[i,r,s]=X9(n,Cu(a=>[a.char,a.color,a.bg,a.render]));return t>0&&e>0&&be.jsx(pP,{char:i.slice(),color:r.slice(),bg:s.slice(),width:t,height:e})}function yoe(){}const XCt=Sm.forwardRef(function({args:e,children:n,...i},r){const s=Sm.useRef(null);return Sm.useImperativeHandle(r,()=>s.current),be.jsxs("mesh",{ref:s,...i,children:[be.jsx("planeGeometry",{attach:"geometry",args:e}),n]})}),of=Sm.forwardRef(function({blocking:e=!1,cursor:n="default",x:i=0,y:r=0,z:s=0,width:a=1,height:o=1,opacity:c=1,visible:l=!0,color:u="white",...h},d){const f=a*.5,p=o*.5,g=[(i+f)*Kt.DRAW_CHAR_WIDTH(),(r+p)*Kt.DRAW_CHAR_HEIGHT(),s];return be.jsx(XCt,{ref:d,args:[a*Kt.DRAW_CHAR_WIDTH(),o*Kt.DRAW_CHAR_HEIGHT()],userData:{blocking:e,cursor:n},onClick:e?yoe:void 0,onPointerMove:e?yoe:void 0,position:g,...h,children:be.jsx("meshBasicMaterial",{color:u,opacity:c,visible:l,transparent:c!==1})})});var aTe={exports:{}};(function(t,e){(function(n,i){t.exports=i()})(Ml,()=>(()=>{var n={944:function(a){var o;o=()=>(()=>{var c={d:(v,b)=>{for(var S in b)c.o(b,S)&&!c.o(v,S)&&Object.defineProperty(v,S,{enumerable:!0,get:b[S]})},o:(v,b)=>Object.prototype.hasOwnProperty.call(v,b)},l={};function u(v){return u=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(b){return typeof b}:function(b){return b&&typeof Symbol=="function"&&b.constructor===Symbol&&b!==Symbol.prototype?"symbol":typeof b},u(v)}function h(v,b){var S=typeof Symbol<"u"&&v[Symbol.iterator]||v["@@iterator"];if(!S){if(Array.isArray(v)||(S=f(v))||b){S&&(v=S);var x=0,M=function(){};return{s:M,n:function(){return x>=v.length?{done:!0}:{done:!1,value:v[x++]}},e:function(P){throw P},f:M}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var R,I=!0,k=!1;return{s:function(){S=S.call(v)},n:function(){var P=S.next();return I=P.done,P},e:function(P){k=!0,R=P},f:function(){try{I||S.return==null||S.return()}finally{if(k)throw R}}}}function d(v,b){return function(S){if(Array.isArray(S))return S}(v)||function(S,x){var M=S==null?null:typeof Symbol<"u"&&S[Symbol.iterator]||S["@@iterator"];if(M!=null){var R,I,k,P,U=[],V=!0,$=!1;try{if(k=(M=M.call(S)).next,x!==0)for(;!(V=(R=k.call(M)).done)&&(U.push(R.value),U.length!==x);V=!0);}catch(q){$=!0,I=q}finally{try{if(!V&&M.return!=null&&(P=M.return(),Object(P)!==P))return}finally{if($)throw I}}return U}}(v,b)||f(v,b)||function(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}()}function f(v,b){if(v){if(typeof v=="string")return p(v,b);var S=Object.prototype.toString.call(v).slice(8,-1);return S==="Object"&&v.constructor&&(S=v.constructor.name),S==="Map"||S==="Set"?Array.from(v):S==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(S)?p(v,b):void 0}}function p(v,b){(b==null||b>v.length)&&(b=v.length);for(var S=0,x=new Array(b);S<b;S++)x[S]=v[S];return x}function g(v,b){if(!(v instanceof b))throw new TypeError("Cannot call a class as a function")}c.d(l,{default:()=>_});var _=function(){function v(){var x=!(arguments.length>0&&arguments[0]!==void 0)||arguments[0];g(this,v),this.strict=x,this.defaults=new Map,this.validators=new Map,this.types=new Map,this.optional=new Set,this.required=new Set}var b,S;return b=v,(S=[{key:"allowExtra",value:function(){return this.strict=!1,this}},{key:"setDefaults",value:function(x){var M=this;return Object.entries(x).forEach(function(R){var I=d(R,2),k=I[0],P=I[1];return M.defaults.set(k,P)}),this}},{key:"setValidators",value:function(x){var M=this;return Object.entries(x).forEach(function(R){var I=d(R,2),k=I[0],P=I[1];return M.validators.set(k,P)}),this}},{key:"setTypes",value:function(x){var M=this;return Object.entries(x).forEach(function(R){var I=d(R,2),k=I[0],P=I[1];return M.types.set(k,P)}),this}},{key:"setOptional",value:function(x){var M=this;return x.forEach(function(R){return M.optional.add(R)}),this}},{key:"setRequired",value:function(x){var M=this;return x.forEach(function(R){return M.required.add(R)}),this}},{key:"resolve",value:function(x){return this.validate(Object.assign(this.getDefaults(),x))}},{key:"getDefaults",value:function(){var x,M={},R=h(this.defaults);try{for(R.s();!(x=R.n()).done;){var I=d(x.value,2),k=I[0],P=I[1];M[k]=P}}catch(U){R.e(U)}finally{R.f()}return M}},{key:"validate",value:function(x){for(var M in x)this.validators.has(M)&&(x[M]=this.validators.get(M)(x[M]));for(var R in x){if(!this.optionExists(R))throw new Error('Unkown option "'.concat(R,'".'));this.checkType(R,x[R])}var I,k=h(this.required.values());try{for(k.s();!(I=k.n()).done;){var P=I.value;if(x[P]===void 0)throw new Error('Option "'.concat(P,'" is required.'))}}catch(U){k.e(U)}finally{k.f()}return x}},{key:"checkType",value:function(x,M){if(this.types.has(x)){var R=this.types.get(x),I=u(M);if(I!==R)throw new Error('Wrong value for option "'.concat(x,'": expected type "').concat(R,'", got "').concat(I,'".'))}}},{key:"optionExists",value:function(x){return!this.strict||this.defaults.has(x)||this.validators.has(x)||this.optional.has(x)||this.required.has(x)||this.types.has(x)}}])&&function(x,M){for(var R=0;R<M.length;R++){var I=M[R];I.enumerable=I.enumerable||!1,I.configurable=!0,"value"in I&&(I.writable=!0),Object.defineProperty(x,(k=function(P,U){if(u(P)!=="object"||P===null)return P;var V=P[Symbol.toPrimitive];if(V!==void 0){var $=V.call(P,"string");if(u($)!=="object")return $;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(P)}(I.key),u(k)==="symbol"?k:String(k)),I)}var k}(b.prototype,S),Object.defineProperty(b,"prototype",{writable:!1}),v}();return l.default})(),a.exports=o()},162:function(a){a.exports=(()=>{var o={d:(u,h)=>{for(var d in h)o.o(h,d)&&!o.o(u,d)&&Object.defineProperty(u,d,{enumerable:!0,get:h[d]})},o:(u,h)=>Object.prototype.hasOwnProperty.call(u,h)},c={};o.d(c,{default:()=>l});var l=function(){function u(){(function(d,f){if(!(d instanceof f))throw new TypeError("Cannot call a class as a function")})(this,u),this._events={},this.on=this.addEventListener,this.off=this.removeEventListener}var h;return(h=[{key:"emit",value:function(d,f){if(Object.prototype.hasOwnProperty.call(this._events,d))for(var p=this._events[d],g={type:d,detail:f},_=p.length,v=0;v<_;v++)this.handle(p[v],g)}},{key:"handle",value:function(d,f){d(f)}},{key:"addEventListener",value:function(d,f){Object.prototype.hasOwnProperty.call(this._events,d)||(this._events[d]=[]),this._events[d].indexOf(f)<0&&this._events[d].push(f)}},{key:"removeEventListener",value:function(d,f){if(Object.prototype.hasOwnProperty.call(this._events,d)){var p=this._events[d],g=p.indexOf(f);g>=0&&p.splice(g,1),p.length===0&&delete this._events[d]}}}])&&function(d,f){for(var p=0;p<f.length;p++){var g=f[p];g.enumerable=g.enumerable||!1,g.configurable=!0,"value"in g&&(g.writable=!0),Object.defineProperty(d,g.key,g)}}(u.prototype,h),u}();return c.default})()}},i={};function r(a){var o=i[a];if(o!==void 0)return o.exports;var c=i[a]={exports:{}};return n[a].call(c.exports,c,c.exports,r),c.exports}r.n=a=>{var o=a&&a.__esModule?()=>a.default:()=>a;return r.d(o,{a:o}),o},r.d=(a,o)=>{for(var c in o)r.o(o,c)&&!r.o(a,c)&&Object.defineProperty(a,c,{enumerable:!0,get:o[c]})},r.o=(a,o)=>Object.prototype.hasOwnProperty.call(a,o),r.r=a=>{typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(a,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(a,"__esModule",{value:!0})};var s={};return(()=>{r.r(s),r.d(s,{GamepadHandler:()=>x,GamepadListener:()=>J});var a=r(162),o=r.n(a),c=r(944),l=r.n(c);function u(K){return u=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(X){return typeof X}:function(X){return X&&typeof Symbol=="function"&&X.constructor===Symbol&&X!==Symbol.prototype?"symbol":typeof X},u(K)}function h(K,X){if(!(K instanceof X))throw new TypeError("Cannot call a class as a function")}function d(K,X){for(var ae=0;ae<X.length;ae++){var ce=X[ae];ce.enumerable=ce.enumerable||!1,ce.configurable=!0,"value"in ce&&(ce.writable=!0),Object.defineProperty(K,_(ce.key),ce)}}function f(K,X){return f=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(ae,ce){return ae.__proto__=ce,ae},f(K,X)}function p(K,X){if(X&&(u(X)==="object"||typeof X=="function"))return X;if(X!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return function(ae){if(ae===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return ae}(K)}function g(K){return g=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(X){return X.__proto__||Object.getPrototypeOf(X)},g(K)}function _(K){var X=function(ae,ce){if(u(ae)!=="object"||ae===null)return ae;var Me=ae[Symbol.toPrimitive];if(Me!==void 0){var Fe=Me.call(ae,"string");if(u(Fe)!=="object")return Fe;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(ae)}(K);return u(X)==="symbol"?X:String(X)}var v,b,S,x=function(K){(function(ge,_e){if(typeof _e!="function"&&_e!==null)throw new TypeError("Super expression must either be null or a function");ge.prototype=Object.create(_e&&_e.prototype,{constructor:{value:ge,writable:!0,configurable:!0}}),Object.defineProperty(ge,"prototype",{writable:!1}),_e&&f(ge,_e)})(Re,K);var X,ae,ce,Me,Fe,Te=(Me=Re,Fe=function(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}(),function(){var ge,_e=g(Me);if(Fe){var ke=g(this).constructor;ge=Reflect.construct(_e,arguments,ke)}else ge=_e.apply(this,arguments);return p(this,ge)});function Re(ge,_e){var ke,gt=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return h(this,Re),(ke=Te.call(this)).index=ge,ke.gamepad=_e,ke.options=ke.constructor.resolveOptions(gt),ke.axes=new Array(_e.axes.length).fill(null),ke.buttons=new Array(_e.buttons.length).fill(null),ke.initAxes(),ke.initButtons(),ke}return X=Re,ce=[{key:"resolveOptions",value:function(ge){var _e,ke,gt,wt,ye=ge.axis,Se=ge.button;return{axis:this.optionResolver.resolve((_e=(ke=ye??Se)!==null&&ke!==void 0?ke:ge)!==null&&_e!==void 0?_e:{}),button:this.optionResolver.resolve((gt=(wt=Se??ye)!==null&&wt!==void 0?wt:ge)!==null&&gt!==void 0?gt:{})}}}],(ae=[{key:"initAxes",value:function(){for(var ge=this.axes.length,_e=0;_e<ge;_e++)this.axes[_e]=this.resolveAxisValue(_e)}},{key:"initButtons",value:function(){for(var ge=this.buttons.length,_e=0;_e<ge;_e++)this.buttons[_e]=this.resolveButtonValue(_e)}},{key:"update",value:function(ge){this.gamepad=ge,this.updateAxis(),this.updateButtons()}},{key:"updateAxis",value:function(){for(var ge=this.axes.length,_e=0;_e<ge;_e++)this.setAxisValue(_e,this.resolveAxisValue(_e))}},{key:"updateButtons",value:function(){for(var ge=this.buttons.length,_e=0;_e<ge;_e++)this.setButtonValue(_e,this.resolveButtonValue(_e))}},{key:"setAxisValue",value:function(ge,_e){this.axes[ge]!==_e&&(this.axes[ge]=_e,this.emit("axis",{gamepad:this.gamepad,index:this.index,axis:ge,value:_e}))}},{key:"setButtonValue",value:function(ge,_e){this.buttons[ge]!==_e&&(this.buttons[ge]=_e,this.emit("button",{gamepad:this.gamepad,index:this.index,button:ge,pressed:this.gamepad.buttons[ge].pressed,value:_e}))}},{key:"resolveAxisValue",value:function(ge){var _e=this.options.axis,ke=_e.deadZone,gt=_e.analog,wt=_e.precision,ye=this.gamepad.axes[ge];return ke&&ye<ke&&ye>-ke?0:gt?wt?Math.round(ye*wt)/wt:ye:ye>0?1:ye<0?-1:0}},{key:"resolveButtonValue",value:function(ge){var _e=this.options.button,ke=_e.deadZone,gt=_e.analog,wt=_e.precision,ye=this.gamepad.buttons[ge].value;return ke>0&&ye<ke&&ye>-ke?0:gt?wt?Math.round(ye*wt)/wt:ye:ye===0?0:1}}])&&d(X.prototype,ae),ce&&d(X,ce),Object.defineProperty(X,"prototype",{writable:!1}),Re}(o());function M(K){return M=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(X){return typeof X}:function(X){return X&&typeof Symbol=="function"&&X.constructor===Symbol&&X!==Symbol.prototype?"symbol":typeof X},M(K)}function R(K,X){for(var ae=0;ae<X.length;ae++){var ce=X[ae];ce.enumerable=ce.enumerable||!1,ce.configurable=!0,"value"in ce&&(ce.writable=!0),Object.defineProperty(K,I(ce.key),ce)}}function I(K){var X=function(ae,ce){if(M(ae)!=="object"||ae===null)return ae;var Me=ae[Symbol.toPrimitive];if(Me!==void 0){var Fe=Me.call(ae,"string");if(M(Fe)!=="object")return Fe;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(ae)}(K);return M(X)==="symbol"?X:String(X)}v=x,b="optionResolver",S=new(l())().setDefaults({analog:!0,deadZone:0,precision:0}).setTypes({analog:"boolean",deadZone:"number",precision:"number"}).setValidators({deadZone:function(K){return Math.max(Math.min(K,1),0)},precision:function(K){return K>0?Math.pow(10,K):0}}),(b=_(b))in v?Object.defineProperty(v,b,{value:S,enumerable:!0,configurable:!0,writable:!0}):v[b]=S;var k=function(){function K(ce){(function(Me,Fe){if(!(Me instanceof Fe))throw new TypeError("Cannot call a class as a function")})(this,K),this.callback=ce,this.frame=null,this.update=this.update.bind(this)}var X,ae;return X=K,(ae=[{key:"setCallback",value:function(ce){this.callback=ce}},{key:"start",value:function(){this.frame||(this.frame=window.requestAnimationFrame(this.update))}},{key:"stop",value:function(){this.frame&&(window.cancelAnimationFrame(this.frame),this.frame=null)}},{key:"update",value:function(){this.frame=window.requestAnimationFrame(this.update),this.callback()}}])&&R(X.prototype,ae),Object.defineProperty(X,"prototype",{writable:!1}),K}();function P(K){return P=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(X){return typeof X}:function(X){return X&&typeof Symbol=="function"&&X.constructor===Symbol&&X!==Symbol.prototype?"symbol":typeof X},P(K)}function U(K,X){if(!(K instanceof X))throw new TypeError("Cannot call a class as a function")}function V(K,X){for(var ae=0;ae<X.length;ae++){var ce=X[ae];ce.enumerable=ce.enumerable||!1,ce.configurable=!0,"value"in ce&&(ce.writable=!0),Object.defineProperty(K,$(ce.key),ce)}}function $(K){var X=function(ae,ce){if(P(ae)!=="object"||ae===null)return ae;var Me=ae[Symbol.toPrimitive];if(Me!==void 0){var Fe=Me.call(ae,"string");if(P(Fe)!=="object")return Fe;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(ae)}(K);return P(X)==="symbol"?X:String(X)}function q(K,X){return q=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(ae,ce){return ae.__proto__=ce,ae},q(K,X)}function Y(K,X){if(X&&(P(X)==="object"||typeof X=="function"))return X;if(X!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return te(K)}function te(K){if(K===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return K}function G(K){return G=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(X){return X.__proto__||Object.getPrototypeOf(X)},G(K)}var J=function(K){(function(Re,ge){if(typeof ge!="function"&&ge!==null)throw new TypeError("Super expression must either be null or a function");Re.prototype=Object.create(ge&&ge.prototype,{constructor:{value:Re,writable:!0,configurable:!0}}),Object.defineProperty(Re,"prototype",{writable:!1}),ge&&q(Re,ge)})(Te,K);var X,ae,ce,Me,Fe=(ce=Te,Me=function(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}(),function(){var Re,ge=G(ce);if(Me){var _e=G(this).constructor;Re=Reflect.construct(ge,arguments,_e)}else Re=ge.apply(this,arguments);return Y(this,Re)});function Te(){var Re,ge=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(U(this,Te),Re=Fe.call(this),typeof navigator.getGamepads!="function")throw new Error("This browser does not support gamepad API.");return Re.options=ge,Re.onAxis=Re.onAxis.bind(te(Re)),Re.update=Re.update.bind(te(Re)),Re.start=Re.start.bind(te(Re)),Re.stop=Re.stop.bind(te(Re)),Re.discover=Re.discover.bind(te(Re)),Re.onButton=Re.onButton.bind(te(Re)),Re.handlers=new Array(4).fill(null),Re.loop=new k(Re.update),window.addEventListener("error",Re.stop),Re}return X=Te,(ae=[{key:"start",value:function(){this.loop.start()}},{key:"stop",value:function(){this.loop.stop()}},{key:"update",value:function(){var Re=navigator.getGamepads();this.discover(Re[0],0),this.discover(Re[1],1),this.discover(Re[2],2),this.discover(Re[3],3)}},{key:"discover",value:function(Re,ge){Re?(this.handlers[ge]===null&&this.registerHandler(ge,Re),this.handlers[ge].update(Re)):this.handlers[ge]&&this.removeGamepad(ge)}},{key:"registerHandler",value:function(Re,ge){var _e=new x(Re,ge,this.options);this.handlers[Re]=_e,_e.addEventListener("axis",this.onAxis),_e.addEventListener("button",this.onButton),this.emit("gamepad:connected",{index:Re,gamepad:ge}),this.emit("gamepad:".concat(Re,":connected"),{index:Re,gamepad:ge})}},{key:"removeGamepad",value:function(Re){var ge=this.handlers[Re];ge.removeEventListener("axis",this.onAxis),ge.removeEventListener("button",this.onButton),this.handlers[Re]=null,this.emit("gamepad:disconnected",{index:Re}),this.emit("gamepad:".concat(Re,":disconnected"),{index:Re})}},{key:"onAxis",value:function(Re){var ge=Re.detail.index;this.emit("gamepad:axis",Re.detail),this.emit("gamepad:".concat(ge,":axis"),Re.detail),this.emit("gamepad:".concat(ge,":axis:").concat(Re.detail.axis),Re.detail)}},{key:"onButton",value:function(Re){var ge=Re.detail.index;this.emit("gamepad:button",Re.detail),this.emit("gamepad:".concat(ge,":button"),Re.detail),this.emit("gamepad:".concat(ge,":button:").concat(Re.detail.button),Re.detail)}}])&&V(X.prototype,ae),Object.defineProperty(X,"prototype",{writable:!1}),Te}(o())})(),s})())})(aTe);var ZCt=aTe.exports,ey={};Object.defineProperty(ey,"__esModule",{value:!0});var JCt=typeof window<"u"&&/Mac|iPod|iPhone|iPad/.test(window.navigator.platform),vV={alt:"altKey",control:"ctrlKey",meta:"metaKey",shift:"shiftKey"},oTe={add:"+",break:"pause",cmd:"meta",command:"meta",ctl:"control",ctrl:"control",del:"delete",down:"arrowdown",esc:"escape",ins:"insert",left:"arrowleft",mod:JCt?"meta":"control",opt:"alt",option:"alt",return:"enter",right:"arrowright",space:" ",spacebar:" ",up:"arrowup",win:"meta",windows:"meta"},gZ={backspace:8,tab:9,enter:13,shift:16,control:17,alt:18,pause:19,capslock:20,escape:27," ":32,pageup:33,pagedown:34,end:35,home:36,arrowleft:37,arrowup:38,arrowright:39,arrowdown:40,insert:45,delete:46,meta:91,numlock:144,scrolllock:145,";":186,"=":187,",":188,"-":189,".":190,"/":191,"`":192,"[":219,"\\":220,"]":221,"'":222};for(var A2=1;A2<20;A2++)gZ["f"+A2]=111+A2;function Y8(t,e,n){e&&!("byKey"in e)&&(n=e,e=null),Array.isArray(t)||(t=[t]);var i=t.map(function(a){return cTe(a,e)}),r=function(o){return i.some(function(c){return lTe(c,o)})},s=n==null?r:r(n);return s}function QCt(t,e){return Y8(t,e)}function eAt(t,e){return Y8(t,{byKey:!0},e)}function cTe(t,e){var n=e&&e.byKey,i={};t=t.replace("++","+add");var r=t.split("+"),s=r.length;for(var a in vV)i[vV[a]]=!1;var o=!0,c=!1,l=void 0;try{for(var u=r[Symbol.iterator](),h;!(o=(h=u.next()).done);o=!0){var d=h.value,f=d.endsWith("?")&&d.length>1;f&&(d=d.slice(0,-1));var p=vZ(d),g=vV[p];if(d.length>1&&!g&&!oTe[d]&&!gZ[p])throw new TypeError('Unknown modifier: "'+d+'"');(s===1||!g)&&(n?i.key=p:i.which=uTe(d)),g&&(i[g]=f?null:!0)}}catch(_){c=!0,l=_}finally{try{!o&&u.return&&u.return()}finally{if(c)throw l}}return i}function lTe(t,e){for(var n in t){var i=t[n],r=void 0;if(i!=null&&(n==="key"&&e.key!=null?r=e.key.toLowerCase():n==="which"?r=i===91&&e.which===93?91:e.which:r=e[n],!(r==null&&i===!1)&&r!==i))return!1}return!0}function uTe(t){t=vZ(t);var e=gZ[t]||t.toUpperCase().charCodeAt(0);return e}function vZ(t){return t=t.toLowerCase(),t=oTe[t]||t,t}var boe=ey.default=Y8;ey.isHotkey=Y8;ey.isCodeHotkey=QCt;ey.isKeyHotkey=eAt;ey.parseHotkey=cTe;ey.compareHotkey=lTe;ey.toKeyCode=uTe;ey.toKeyName=vZ;function hTe(t){return{all:t=t||new Map,on:function(e,n){var i=t.get(e);i?i.push(n):t.set(e,[n])},off:function(e,n){var i=t.get(e);i&&(n?i.splice(i.indexOf(n)>>>0,1):t.set(e,[]))},emit:function(e,n){var i=t.get(e);i&&i.slice().map(function(r){r(n)}),(i=t.get("*"))&&i.slice().map(function(r){r(e,n)})}}}const qT={};function _Z(t){return`${Gi()}local${t}`}const kw={};let _V=0,Eoe=performance.now();const VA=100,Soe=[Ft.MOVE_UP,Ft.MOVE_DOWN,Ft.MOVE_LEFT,Ft.MOVE_RIGHT,Ft.OK_BUTTON,Ft.CANCEL_BUTTON,Ft.MENU_BUTTON];function dTe(){const t=performance.now(),e=t-Eoe,n=M_(qT);for(let i=0;i<n.length;++i){const r=parseFloat(n[i]);if(kw[r]=kw[r]??0,kw[r]+=e,kw[r]>=VA){kw[r]-=VA;const s=qT[r],a={alt:!!s[Ft.ALT],ctrl:!!s[Ft.CTRL],shift:!!s[Ft.SHIFT]};for(let o=0;o<Soe.length;++o){const c=Soe[o];s[c]&&pTe(r,c,a)}}}if(++_V,Eoe=t,setTimeout(dTe,10),_V>32){_V=0;const i=M_(qT);for(let r=0;r<i.length;++r){const s=parseFloat(i[r]);mme(Ye,_Z(s))}}}dTe();function yZ(t){return qT[t]=qT[t]??{[Ft.NONE]:!1,[Ft.ALT]:!1,[Ft.CTRL]:!1,[Ft.SHIFT]:!1,[Ft.MOVE_UP]:!1,[Ft.MOVE_DOWN]:!1,[Ft.MOVE_LEFT]:!1,[Ft.MOVE_RIGHT]:!1,[Ft.OK_BUTTON]:!1,[Ft.CANCEL_BUTTON]:!1,[Ft.MENU_BUTTON]:!1},qT[t]}function ua(t,e){const n=yZ(t);n[e]||(kw[t]=VA*-2,pTe(t,e,{alt:n[Ft.ALT],ctrl:n[Ft.CTRL],shift:n[Ft.SHIFT]})),n[e]=!0}function Zr(t,e){const n=yZ(t);n[e]=!1}const Dg={root:hTe(),ignorehotkeys:!1},fTe=De.createContext(Dg.root);function vP(t){return{alt:t.altKey,ctrl:gE?t.metaKey:t.ctrlKey,shift:t.shiftKey}}function pTe(t,e,n){if(t===0)Dg.root.emit(Ft[e],n);else{let i=0;const r=_Z(t);n.alt&&(i|=Z9),n.ctrl&&(i|=J9),n.shift&&(i|=Q9),gme(Ye,r,e,i)}}document.addEventListener("keydown",t=>{const e=Wn(t.key),n=vP(t),i=Gi();switch(e){case"s":case"j":case"o":case"f":case"z":case"y":case"e":case"k":case"p":case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":case"arrowleft":case"arrowright":case"arrowup":case"arrowdown":(n.alt||n.ctrl||n.shift)&&t.preventDefault();break;case"tab":t.preventDefault();break}switch(n.alt?ua(0,Ft.ALT):Zr(0,Ft.ALT),n.ctrl?ua(0,Ft.CTRL):Zr(0,Ft.CTRL),n.shift?ua(0,Ft.SHIFT):Zr(0,Ft.SHIFT),e){case"arrowleft":ua(0,Ft.MOVE_LEFT);break;case"arrowright":ua(0,Ft.MOVE_RIGHT);break;case"arrowup":ua(0,Ft.MOVE_UP);break;case"arrowdown":ua(0,Ft.MOVE_DOWN);break;case"enter":ua(0,Ft.OK_BUTTON);break;case"esc":case"escape":ua(0,Ft.CANCEL_BUTTON);break;case"tab":ua(0,Ft.MENU_BUTTON);break;case"s":n.ctrl&&o_(Ye,i,"#save");break;case"j":n.ctrl&&o_(Ye,i,n.shift?"#jointab hush":"#jointab");break;case"o":n.ctrl&&o_(Ye,i,n.shift?"#joincode hush":"#joincode");break;case"l":break;case"f":n.ctrl&&o_(Ye,i,"#fork");break}Dg.root.emit("keydown",t)},{capture:!0});document.addEventListener("keyup",t=>{const e=Wn(t.key),n=vP(t);switch(n.alt?ua(0,Ft.ALT):Zr(0,Ft.ALT),n.ctrl?ua(0,Ft.CTRL):Zr(0,Ft.CTRL),n.shift?ua(0,Ft.SHIFT):Zr(0,Ft.SHIFT),e){case"meta":Zr(0,Ft.MOVE_LEFT),Zr(0,Ft.MOVE_RIGHT),Zr(0,Ft.MOVE_UP),Zr(0,Ft.MOVE_DOWN);break;case"arrowleft":Zr(0,Ft.MOVE_LEFT);break;case"arrowright":Zr(0,Ft.MOVE_RIGHT);break;case"arrowup":Zr(0,Ft.MOVE_UP);break;case"arrowdown":Zr(0,Ft.MOVE_DOWN);break;case"enter":Zr(0,Ft.OK_BUTTON);break;case"esc":case"escape":Zr(0,Ft.CANCEL_BUTTON);break;case"tab":Zr(0,Ft.MENU_BUTTON);break}},{capture:!0});NE("userinput",["tock"],t=>{switch(t.target){case"up":an(t.data)&&Zr(0,t.data);break;case"down":an(t.data)&&ua(0,t.data);break}});const mTe=0,gTe=1,vTe=2,_Te=3,tAt=4,nAt=5,iAt=6,rAt=7,sAt=9,aAt=12,oAt=13,cAt=14,lAt=15,yV={[_Te]:Ft.MOVE_UP,[mTe]:Ft.MOVE_DOWN,[vTe]:Ft.MOVE_LEFT,[gTe]:Ft.MOVE_RIGHT,[tAt]:Ft.OK_BUTTON,[nAt]:Ft.CANCEL_BUTTON,[iAt]:Ft.SHIFT,[rAt]:Ft.SHIFT,[sAt]:Ft.MENU_BUTTON,[aAt]:Ft.MOVE_UP,[oAt]:Ft.MOVE_DOWN,[cAt]:Ft.MOVE_LEFT,[lAt]:Ft.MOVE_RIGHT},bV={};function uAt(t){return bV[t]=bV[t]??{},bV[t]}function hAt(t,e,n){const i=uAt(t),r=GM(i[0]??0,i[1]??0),s=GM(i[2]??0,i[3]??0);i[e]=n;const a=GM(i[0]??0,i[1]??0),o=GM(i[2]??0,i[3]??0);if(r!==a)switch(Zr(t,Ft.MOVE_LEFT),Zr(t,Ft.MOVE_RIGHT),Zr(t,Ft.MOVE_UP),Zr(t,Ft.MOVE_DOWN),a){case Yt.NORTH:ua(t,Ft.MOVE_UP);break;case Yt.SOUTH:ua(t,Ft.MOVE_DOWN);break;case Yt.WEST:ua(t,Ft.MOVE_LEFT);break;case Yt.EAST:ua(t,Ft.MOVE_RIGHT);break}if(s!==o)switch(o===Yt.IDLE?Zr(t,Ft.SHIFT):ua(t,Ft.SHIFT),Zr(t,Ft.MOVE_LEFT),Zr(t,Ft.MOVE_RIGHT),Zr(t,Ft.MOVE_UP),Zr(t,Ft.MOVE_DOWN),o){case Yt.NORTH:ua(t,Ft.MOVE_UP);break;case Yt.SOUTH:ua(t,Ft.MOVE_DOWN);break;case Yt.WEST:ua(t,Ft.MOVE_LEFT);break;case Yt.EAST:ua(t,Ft.MOVE_RIGHT);break}}const _P=new ZCt.GamepadListener({analog:!1,deadZone:.3});_P.on("gamepad:connected",t=>{const e=Gi();xr(Ye,e,`connected ${t.detail.gamepad.id}`),yZ(t.detail.index),t.detail.index>0&&i6e(Ye,_Z(t.detail.index))});_P.on("gamepad:disconnected",t=>{const e=Gi();xr(Ye,e,`disconnected gamepad ${t.detail.index}`),delete qT[t.detail.index]});_P.on("gamepad:axis",t=>{hAt(t.detail.index,t.detail.axis,t.detail.value)});_P.on("gamepad:button",t=>{const e=t.detail.index;switch(t.detail.button){case vTe:case gTe:case _Te:case mTe:Zr(e,Ft.MOVE_UP),Zr(e,Ft.MOVE_DOWN),Zr(e,Ft.MOVE_LEFT),Zr(e,Ft.MOVE_RIGHT),t.detail.value?(ua(t.detail.index,Ft.SHIFT),ua(t.detail.index,yV[t.detail.button])):Zr(t.detail.index,Ft.SHIFT);break;default:t.detail.value?ua(t.detail.index,yV[t.detail.button]):Zr(t.detail.index,yV[t.detail.button]);break}});_P.start();const Toe="keyup";function NC({hotkey:t,althotkey:e,children:n}){return De.useEffect(()=>{const i=boe(t,{byKey:!0}),r=re(e)?boe(e,{byKey:!0}):void 0;function s(a){Dg.ignorehotkeys===!1&&(i(a)||r!=null&&r(a))&&n()}return document.addEventListener(Toe,s,!1),()=>document.removeEventListener(Toe,s,!1)},[t,e,n]),null}function nl(t){const e=De.useContext(fTe);return De.useEffect(()=>{const n=Object.entries(t);return n.forEach(([i,r])=>e.on(i,r)),()=>{n.forEach(([i,r])=>e.off(i,r))}},[e,t]),null}function sx({blockhotkeys:t,children:e}){const[n]=De.useState(()=>hTe());return De.useEffect(()=>{const i=Dg.root,r=Dg.ignorehotkeys;return Dg.root=n,Dg.ignorehotkeys=!!t,()=>{Dg.root=i,Dg.ignorehotkeys=r}},[n,t]),be.jsx(fTe.Provider,{value:n,children:e})}const eb=32,yTe=8,c7=new Oe;function dAt(){const t=Kt.DRAW_CHAR_WIDTH(),e=Kt.DRAW_CHAR_HEIGHT(),n=Math.floor(c7.x/t),i=Math.floor(c7.y/e);return{x:eb*.5+n,y:yTe*.5+i}}function fAt({chip:t,row:e,label:n,args:i,context:r}){Up(e,r);const[s]=[dh(i[0],"")],a=kE(t,s),c=Rk(a)??0,l=bf(),[u,h]=De.useState(!1);De.useLayoutEffect(()=>{h(!0)},[]);const d=`${c}`.padStart(3,"0"),f=n.trim(),p=r.x-1,g=r.y+2,_=[`$green${f} ${d}
$white`];for(let k=0;k<256;++k)if(k%eb===0&&_.push(`
`),k===c){const P=l?"$green$onwhite":"$white$ongreen";_.push(`${P}$${k}$white$ondkblue`)}else _.push(`$${k}`);const v=_.join("");oi(v,r,!0);const b=De.useContext(Q_),S=De.useCallback(()=>{c>=eb&&Tl(a,c-eb)},[a,c]),x=De.useCallback(()=>{c>0&&Tl(a,c-1)},[a,c]),M=De.useCallback(()=>{c<255&&Tl(a,c+1)},[a,c]),R=De.useCallback(()=>{c<=255-eb&&Tl(a,c+eb)},[a,c]),I=De.useCallback(()=>{b.sendclose()},[b]);return be.jsx("group",{position:[p*Kt.DRAW_CHAR_WIDTH(),g*Kt.DRAW_CHAR_HEIGHT(),1],children:u&&be.jsxs(sx,{blockhotkeys:!0,children:[be.jsx(of,{blocking:!0,visible:!1,width:eb,height:yTe,onClick:k=>{k.intersections[0].object.worldToLocal(c7.copy(k.intersections[0].point));const P=rh(dAt(),eb);P>=0&&P<=255&&(Tl(a,P),b.sendclose())}}),be.jsx(nl,{MOVE_LEFT:x,MOVE_UP:S,MOVE_RIGHT:M,MOVE_DOWN:R,OK_BUTTON:I,CANCEL_BUTTON:I})]})})}const tb=8,bTe=2,l7=new Oe;function pAt(){const t=Kt.DRAW_CHAR_WIDTH(),e=Kt.DRAW_CHAR_HEIGHT(),n=Math.floor(l7.x/t),i=Math.floor(l7.y/e);return{x:tb*.5+n,y:bTe*.5+i}}function mAt({chip:t,row:e,label:n,args:i,context:r}){Up(e,r);const[s]=[dh(i[0],"")],a=kE(t,s),c=Rk(a)??0,l=bf(),[u,h]=De.useState(!1);De.useLayoutEffect(()=>{h(!0)},[]);const d=`${c}`.padStart(2,"0"),f=n.trim(),p=(qt[c]||qt[qt.BLACK]).padEnd(12," ").toLowerCase(),g=r.x-1,_=r.y+2,v=[`$green${f} ${d} ${p}
$white`];for(let k=0;k<16;++k)if(k%tb===0&&v.push(`
`),k===c){const P=k<8?"$white":"$black",U=l?P:`$${qt[k]}`;v.push(`${U}$219`)}else v.push(`$${qt[k]}$219`);v.push("$white"),oi(v.join(""),r,!0);const b=De.useContext(Q_),S=De.useCallback(()=>{c>=tb&&Tl(a,c-tb)},[a,c]),x=De.useCallback(()=>{c>0&&Tl(a,c-1)},[a,c]),M=De.useCallback(()=>{c<15&&Tl(a,c+1)},[a,c]),R=De.useCallback(()=>{c<=15-tb&&Tl(a,c+tb)},[a,c]),I=De.useCallback(()=>{b.sendclose()},[b]);return be.jsx("group",{position:[g*Kt.DRAW_CHAR_WIDTH(),_*Kt.DRAW_CHAR_HEIGHT(),1],children:u&&be.jsxs(sx,{blockhotkeys:!0,children:[be.jsx(of,{blocking:!0,visible:!1,width:tb,height:bTe,onClick:k=>{k.intersections[0].object.worldToLocal(l7.copy(k.intersections[0].point));const P=pAt(),U=rh(P,tb);U>=0&&U<=16&&(Tl(a,U),b.sendclose())}}),be.jsx(nl,{MOVE_LEFT:x,MOVE_UP:S,MOVE_RIGHT:M,MOVE_DOWN:R,OK_BUTTON:I,CANCEL_BUTTON:I})]})})}function gAt({item:t,row:e,context:n}){return Up(e,n),oi(`${t}${re(e)?`
`:""}`,n,!0),null}function vAt({chip:t,row:e,active:n,label:i,args:r,context:s}){Up(e,s);const[a,o]=[dh(r[0],""),r[1]],c=Hm(n);oi(`  $purple$16 ${c}${i}
`,s,!0);const l=De.useContext(Q_),u=De.useCallback(()=>{l.sendmessage(W8(t,a),o),l.sendclose()},[l,t,a,o]);return n&&be.jsx(nl,{OK_BUTTON:u})}function _At({chip:t,row:e,active:n,label:i,args:r,context:s}){var _;Up(e,s);const[a,o,c,l]=[dh(r[0],""),dh(r[1],((_=r[1])==null?void 0:_.toString())??""),dh(r[2],""),dh(r[3],"")],u=c||` ${o.toUpperCase()} `,h=Hm(n),d=s.x-.25,f=s.y-.25;oi(`${s.iseven?"$black$onltgray":"$black$ondkcyan"}${u}${h}$onclear ${i}${re(e)?`
`:""}`,s,!0);const p=De.useContext(Q_),g=De.useCallback(()=>{p.sendmessage(W8(t,a)),l||p.sendclose()},[t,p,a,l]);return be.jsxs("group",{position:[d*Kt.DRAW_CHAR_WIDTH(),f*Kt.DRAW_CHAR_HEIGHT(),1],children:[be.jsx(of,{visible:!1,width:u.length+.5,height:1.5,blocking:!0,onClick:g}),n&&be.jsx(nl,{OK_BUTTON:g}),o&&be.jsx(NC,{hotkey:o,children:g})]})}function yAt({chip:t,row:e,active:n,label:i,args:r,context:s}){Up(e,s);const[a,o]=[dh(r[0],""),r[1]],c=Hm(n);oi(`  $purple$16 ${c}${i}
`,s,!0);const l=De.useContext(Q_),u=De.useCallback(()=>{l.sendmessage(W8(t,a),o),l.sendclose()},[l,t,a,o]);return n&&be.jsx(nl,{OK_BUTTON:u})}function bAt({chip:t,row:e,active:n,label:i,args:r,context:s}){Up(e,s);const[a,o,c]=[dh(r[0],""),xT(r[1],-1),xT(r[2],-1)];let l,u;o===-1?(l=0,u=31):c===-1?(l=0,u=o):(l=o,u=c);const h=kE(t,a),d=Rk(h),f=d??0,p=bf(),[g,_]=De.useState(""),[v,b]=De.useState(0),[S,x]=De.useState(!1);let M=`${f}`;const R=i.trim(),I=Hm(n);S&&(M=p?KM(g,v,1,"$219+"):g),s.writefullwidth=32,oi(`  # ${I}${R} $green${M}`,s,!1),s.writefullwidth=void 0,oi(`
`,s,!1);const k=De.useCallback(V=>{const $=V.alt?10:1;Tl(h,Math.min(u,f+$))},[u,f,h]),P=De.useCallback(V=>{const $=V.alt?10:1;Tl(h,Math.max(l,f-$))},[l,f,h]),U=De.useCallback(()=>{x(V=>{const $=!V;if($){const q=`${d}`;_(q),b(q.length)}else{const q=parseFloat(g),Y=isNaN(q)?0:q;Tl(a,Math.min(u,Math.max(l,Y)))}return $})},[u,l,g,a,d]);return d!==void 0&&be.jsxs(be.Fragment,{children:[n&&!S&&be.jsx(nl,{MOVE_LEFT:P,MOVE_RIGHT:k,OK_BUTTON:U}),S&&be.jsxs(sx,{blockhotkeys:!0,children:[be.jsx(NC,{hotkey:"ctrl+c",children:()=>{console.info("copy")}}),be.jsx(NC,{hotkey:"ctrl+v",children:()=>{console.info("paste")}}),be.jsx(NC,{hotkey:"ctrl+a",children:()=>{console.info("select all")}}),be.jsx(nl,{MOVE_LEFT:()=>{b(V=>Math.max(0,V-1))},MOVE_RIGHT:()=>{b(V=>Math.min(g.length,V+1))},CANCEL_BUTTON:U,OK_BUTTON:U,keydown:V=>{switch(Wn(V.key)){case"delete":g.length>0&&_($=>KM($,v,1));break;case"backspace":v>0&&(_($=>KM($,v-1,1)),b($=>Math.max(0,$-1)));break}V.key.length===1&&g.length<s.width*.5&&(_($=>KM($,v,0,V.key)),b($=>$+1))}})]})]})}function EAt({chip:t,row:e,active:n,label:i,args:r,context:s}){Up(e,s);const[a,o,c]=[dh(r[0],""),dh(r[1],""),dh(r[2],"")];let l,u;o===""?(l="L ",u=" H"):c===""?(l="L ",u=` ${o}`):(l=`${o} `,u=` ${c}`);const h=0,d=8,f=kE(t,a),g=Rk(f)??0,_=bf(),v=i.trim(),b=Hm(n);oi(` $red $29 ${b}${v} `,s,!1);const x=KM("----:----",g,1,`$green${n?_?"$26":"$27":"$4"}${b}`).replaceAll("-","$7").replaceAll(":","$9");oi(`${b}${l}${x}${u} $green${g+1}
`,s,!1);const M=De.useCallback(I=>{const k=I.alt?10:1;Tl(f,Math.min(d,g+k))},[d,g,f]),R=De.useCallback(I=>{const k=I.alt?10:1;Tl(f,Math.max(h,g-k))},[h,g,f]);return be.jsx(be.Fragment,{children:n&&be.jsx(nl,{MOVE_LEFT:R,MOVE_RIGHT:M})})}function SAt({chip:t,row:e,active:n,label:i,args:r,context:s}){Up(e,s);const[a,...o]=[dh(r[0],""),...r.slice(1)],c=[],l=[];for(let x=0;x<o.length;x+=2)c.push(o[x]),l.push(o[x+1]);const u=kE(t,a),d=`${Rk(u)??0}`;let f=l.indexOf(d);f<0&&(f=0);const p=bf(),g=i.trim(),_=Hm(n);oi(` $dkred ? ${_}${g} `,s,!1);const v=n?p?"$26":"$27":"/";oi(`${f+1}$green${v}${_}${l.length}`,s,!1),s.writefullwidth=32,oi(` $green${c[f]}`,s,!1),s.writefullwidth=void 0,oi(`
`,s,!1);const b=De.useCallback(()=>{const x=Math.min(0,f-1),M=parseFloat(l[x]);Number.isInteger(M)&&Tl(u,M)},[f,u]),S=De.useCallback(()=>{const x=Math.max(l.length-1,f+1),M=parseFloat(l[x]);Number.isInteger(M)&&Tl(u,M)},[f,u]);return be.jsx(be.Fragment,{children:n&&be.jsx(nl,{MOVE_LEFT:b,MOVE_RIGHT:S})})}function TAt({chip:t,row:e,active:n,label:i,args:r,context:s}){Up(e,s);const a=dh(r[0],""),o=kE(t,a),c=Dve(o),l=(c==null?void 0:c.toJSON())??"",u=bf(),[h,d]=De.useState(0),[f,p]=De.useState(!1),[g,_]=De.useState(void 0),v=`${l} `,b=i.trim(),S=Hm(n);oi(`$green  $20 ${S}${b} $green`,s,!1);const x=s.x,R=s.y*s.width;s.writefullwidth=32,oi(`${v}`,s,!1),s.writefullwidth=void 0,oi(`
`,s,!1);const I=re(g),k=s.width-x-2,P=I?Math.min(g,h):h;let U=I?Math.max(g,h):h;I&&(U!==P&&U===h&&--U,wA(x+P+R,x+U+R,15,8,s)),f&&u&&I4(x+h+R,"",s);function V(){re(c)&&(d(P),_(void 0),c.delete(P,U-P+1))}return be.jsxs(be.Fragment,{children:[n&&be.jsx(nl,{OK_BUTTON:()=>{c&&(p(!0),d(c.length),_(void 0))}}),f&&be.jsx(sx,{blockhotkeys:!0,children:be.jsx(nl,{MOVE_LEFT:$=>{$.shift?re(g)||_(er(h-1,0,l.length)):_(void 0),d(q=>er(q-1,0,l.length))},MOVE_RIGHT:$=>{$.shift?re(g)||_(h):_(void 0),d(q=>er(q+1,0,l.length))},CANCEL_BUTTON:()=>{p(!1),d(l.length),_(void 0)},OK_BUTTON:()=>p(!1),keydown:$=>{if(!c)return;const{key:q}=$,Y=Wn(q),te={alt:$.altKey,ctrl:gE?$.metaKey:$.ctrlKey,shift:$.shiftKey},G=c.toJSON();switch(Y){case"delete":I?V():G.length>0&&c.delete(h,1);break;case"backspace":I?V():h>0&&(c.delete(h-1,1),d(J=>Math.max(0,J-1)));break;default:if(te.ctrl)switch(Y){case"a":_(0),d(G.length);break;case"c":re(za())&&za().writeText(c.toJSON()).catch(J=>console.error(J));break;case"v":re(za())&&za().readText().then(J=>{I&&V(),c.insert(h,J),d(h+J.length)}).catch(J=>console.error(J));break;case"x":re(za())&&za().writeText(c.toJSON()).then(()=>V()).catch(J=>console.error(J));break}else te.alt||q.length===1&&G.length<k&&(c.insert(h,q),d(J=>J+1));break}}})})]})}function xAt({chip:t,row:e,active:n,label:i,args:r,context:s}){Up(e,s);const[a]=[dh(r[0],"")],o="z",c=` ${o.toUpperCase()} `,l=Hm(n),u=s.x-.25,h=s.y-.25;oi(`${s.iseven?"$black$onltgray":"$black$ondkcyan"}${c}${l}$onclear ${i}${re(e)?`
`:""}`,s,!0);const d=De.useContext(Q_),f=De.useCallback(()=>{d.sendmessage(W8(t,a),void 0)},[d,t,a]);return be.jsxs("group",{position:[u*Kt.DRAW_CHAR_WIDTH(),h*Kt.DRAW_CHAR_HEIGHT(),1],children:[be.jsx(of,{visible:!1,width:c.length+.5,height:1.5,blocking:!0,onClick:f}),n&&be.jsx(nl,{OK_BUTTON:f}),be.jsx(NC,{hotkey:o,children:f})]})}function wAt({row:t,item:e,active:n}){const i=Gi(),r=Pp();if(Up(t,r),r.iseven=r.y%2===0,typeof e=="string")return be.jsx(gAt,{player:i,item:e,row:t,context:r});if(ji(e)){const[s,a,o,c,...l]=e;if(typeof s!="string"||typeof a!="string"||typeof o!="string")return null;const u={player:i,chip:s,row:t,active:n,label:a,args:[o,...l],context:r},h=Tn(c)?c:"";switch(Wn(h)){default:case"hyperlink":return be.jsx(yAt,{...u});case"hk":case"hotkey":return be.jsx(_At,{...u});case"rn":case"range":return be.jsx(EAt,{...u});case"sl":case"select":return be.jsx(SAt,{...u});case"nm":case"number":return be.jsx(bAt,{...u});case"tx":case"text":return be.jsx(TAt,{...u});case"copyit":return be.jsx(vAt,{...u});case"zssedit":return be.jsx(xAt,{...u});case"charedit":return be.jsx(fAt,{...u});case"coloredit":return be.jsx(mAt,{...u})}N4(r)}return null}function bZ({inline:t=!1,xmargin:e=1,ymargin:n=1,selected:i=-1,width:r,height:s,color:a,bg:o,text:c}){const l=kk(r,s,0,a,o),u=l.getState(),h={...FE(r,s,a,o,n,e,r-e,s-n),...l.getState(),x:e,y:n};return A_e(u,0,a,o),be.jsxs(mP,{store:l,children:[be.jsx(gP,{width:r,height:s}),be.jsx(tI.Provider,{value:h,children:c.map((d,f)=>be.jsx(wAt,{row:t?void 0:f,item:d,active:f===i},f))})]})}const CAt=2,AAt=14,ETe=AAt*CAt;function RAt(t){return $F(t,ETe*.5)}function MAt(t,e,n,i,r=1.235){function s(o){return Ext(o,i)}ph(t.userData,e,n,r,i,ETe*12,s),t.position[e]=RAt(t.userData[e]);const a=n-t.position.y;return Math.abs(a)<.1}function OAt({name:t,width:e,height:n,context:i}){const r=R_e();for(let l=1;l<e-1;++l)l>2&&l<e-1&&gc(r,e,n,l,1,{char:205,color:15}),gc(r,e,n,l,n-1,{char:205,color:15});gc(r,e,n,e-2,0,{char:196,color:15}),gc(r,e,n,1,0,{char:205,color:15}),gc(r,e,n,2,0,{char:187,color:15}),gc(r,e,n,2,1,{char:200,color:15});for(let l=1;l<n-1;++l)gc(r,e,n,0,l,{char:179,color:15}),gc(r,e,n,e-1,l,{char:179,color:15});for(let l=2;l<n-1;++l)gc(r,e,n,1,l,{char:0,color:15}),gc(r,e,n,e-2,l,{char:0,color:15});gc(r,e,n,0,0,{char:213,color:15}),gc(r,e,n,e-1,0,{char:191,color:15}),gc(r,e,n,e-1,1,{char:181,color:15}),gc(r,e,n,0,n-1,{char:212,color:15}),gc(r,e,n,e-1,n-1,{char:190,color:15});const s=` ${t} `,a=Ik(s,e,n),o=(a==null?void 0:a.x)??s.length,c=e-2;return i.x=2+Math.round(c*.5),i.x-=Math.round(o*.5),i.y++,oi(s,i,!0),null}function xoe({x:t,y:e,color:n,on:i=232,off:r=7,alt:s}){const a=bf(),o=R_e(),c=De.useRef(0),l=re(s)?c.current%2===0?i:s:i;return gc(o,o.width,o.height,t,e,{char:a?l:r,color:n}),o.changed(),a&&++c.current,null}function NAt({store:t,children:e}){return be.jsx(w_e.Provider,{value:t,children:e})}function IAt({width:t,height:e}){const n=De.useContext(w_e),[i]=X9(n,Cu(r=>[r.dither,r.render]));return t>0&&e>0&&be.jsx(E_,{alphas:i.slice(),width:t,height:e})}function kAt({row:t,width:e,height:n,panelwidth:i,panelheight:r,children:s}){const a=vtt(i,r,0),o=[.001,.05,.1,.2],c=.4,{dither:l}=a.getState();gtt(l);for(let u=0;u<i;++u){IH(l,i,r,u,t,c);for(let h=0;h<o.length;++h){const d=o.length-h;IH(l,i,r,u,t-d,o[h]),IH(l,i,r,u,t+d,o[h])}}return be.jsxs(be.Fragment,{children:[be.jsx(gP,{width:e,height:n}),be.jsxs("group",{position:[2*Kt.DRAW_CHAR_WIDTH(),2*Kt.DRAW_CHAR_HEIGHT(),0],children:[be.jsx(NAt,{store:a,children:be.jsx(IAt,{width:i,height:r})}),s,be.jsx(xoe,{x:1,y:1}),be.jsx(xoe,{x:1,y:2+t,on:26,alt:27,off:45,color:12})]})]})}function EZ({line:t,color:e,margin:n,y:i,leftedge:r,rightedge:s,context:a}){const o=bf(),l=`$${(qt[e]??"").toLowerCase()} ${t.replaceAll(`
`,"").trim()} --=--`,u=Ik(l,1e4,1),h=(u==null?void 0:u.measuredwidth)??1,[d,f]=De.useState(0);De.useEffect(()=>{f(p=>o?p:(p-1)%h)},[o,h]),a.disablewrap=!0,a.active.leftedge=n,a.active.rightedge=s-n;for(let p=r+n+d;p<=s;p+=h)a.x=p,a.y=i,oi(l,a,!1);return a.active.leftedge=0,a.active.rightedge=s,a.disablewrap=!1,null}function PAt({name:t,width:e,height:n,color:i,bg:r,text:s,shouldclose:a}){const{viewport:o}=Tu(),c=e-3,l=n-3,u=kk(e,n,0,i,r),h=De.useContext(Q_),d={...FE(e,n,i,r,0,0,e,n),...u.getState()},[f,p]=De.useState(()=>{const R=s.findIndex(I=>ji(I));return R>=0&&R<=8?R:0});let g=f-Math.floor(l*.5);g=Math.min(s.length-l,g),g=Math.max(0,g);const _=s.slice(g,g+l),v=f-g,b=De.useRef(null),S=De.useCallback(()=>{a&&h.didclose()},[a,h]),x=De.useCallback(R=>{const I=R.alt?10:1;p(k=>Math.max(0,k-I))},[p]),M=De.useCallback(R=>{const I=R.alt?10:1;p(k=>Math.min(s.length,k+I))},[p,s.length]);return De.useEffect(()=>{if(b.current&&!a){const R=o.height;b.current.position.y=R,b.current.userData.y=R,b.current.userData.vy=0}},[a]),Pm(De.useCallback((R,I)=>{if(re(b.current)){const k=a?n*2*-Kt.DRAW_CHAR_HEIGHT():0;MAt(b.current,"y",k,I)&&S()}},[a,S,n])),be.jsx("group",{ref:b,"position-y":1e6,children:be.jsxs(sx,{children:[be.jsx(nl,{MOVE_UP:x,MOVE_DOWN:M,CANCEL_BUTTON:h.sendclose}),be.jsxs(mP,{store:u,children:[be.jsx(OAt,{name:t,width:e,height:n,context:d}),be.jsx(EZ,{margin:3,color:qt.BLUE,y:0,leftedge:0,rightedge:e-1,line:`
   up/down$white.SCROLL UP/DOWN   $blue
esc/cancel$white.CLOSE SCROLL   $blue
alt+up/down$white.JUMP 10 LINES   $blue
`,context:d}),be.jsx(kAt,{row:v,width:e,height:n,panelwidth:c,panelheight:l,children:be.jsx(bZ,{name:t,width:c,height:l,xmargin:0,ymargin:0,color:i,bg:qt.ONCLEAR,text:_,selected:v})})]})]})})}const woe=new xt,Coe=[153,5,42,94,24,25,26,27,16,17,30,31,234,227,227].map((t,e)=>[t,e%3===0?176:177,e%3===0?178:176]).flat();function DAt({context:t,width:e,height:n,drawstick:i}){const{islandscape:r,sidebaropen:s,showkeyboard:a}=od();if(A_e(t,0,qt.WHITE,qt.ONCLEAR),!r){const o=e*n;for(let c=4*e;c<o;++c)t.char[c]=s?Coe[c%Coe.length]:0,t.color[c]=s?qt.DKPURPLE:qt.ONCLEAR}t.y=3;for(let o=0;o<3;++o)t.x=t.active.leftedge=1,oi("$YELLOW$176$176$176$176$176",t,!1),t.x=t.active.leftedge=e-7,oi(`$WHITE$176$176$176$176$176
`,t,!1);t.y=n-5;for(let o=0;o<3;++o)t.x=t.active.leftedge=1,oi("$GREEN$176$176$176$176$176",t,!1),t.x=t.active.leftedge=e-7,oi(`$RED$176$176$176$176$176
`,t,!1);if(t.y=n-5,t.active.leftedge=1,t.active.bg=qt.ONCLEAR,a?(++t.y,t.x=Math.round((e-8)*.5),oi("$GREY$221",t,!1),t.x+=5,oi(`$GREY$222
`,t,!1),t.x=Math.round((e-6)*.5),oi("$GREY$221",t,!1),t.x+=3,oi(`$GREY$222
`,t,!1),t.x=Math.round((e-4)*.5),oi("$GREY$221",t,!1),++t.x,oi(`$GREY$222
`,t,!1)):(t.x=Math.round((e-4)*.5),oi("$GREY$221",t,!1),++t.x,oi(`$GREY$222
`,t,!1),t.x=Math.round((e-6)*.5),oi("$GREY$221",t,!1),t.x+=3,oi(`$GREY$222
`,t,!1),t.x=Math.round((e-8)*.5),oi("$GREY$221",t,!1),t.x+=5,oi(`$GREY$222
`,t,!1)),i.startx!==-1){t.active.leftedge=0,t.x=t.active.leftedge=i.startx-4,t.y=i.starty-3;for(let c=0;c<5;++c)oi(`$BLUE$176$176$176$176$176$176$176$176
`,t,!1);woe.set(i.tipx-i.startx,i.tipy-i.starty);const o=Cpe($F(Ape(woe.angle()),45));t.x=t.active.leftedge=Math.round(i.startx+Math.cos(o)*4)-2,t.y=Math.round(i.starty+Math.sin(o)*3)-2;for(let c=0;c<3;++c)oi(`$BLUE$177$177$177$177
`,t,!1)}return r||(t.active.leftedge=1,t.y=4,t.x=2,oi("$YELLOW?",t,!1),t.x=e-7,oi("$WHITEMENU",t,!1),t.y=n-4,t.x=2,oi("$GREENOKAY",t,!1),t.x=e-9,oi("$REDCANCEL",t,!1)),null}function LAt(t,e){switch(t){case 0:Kd.keyboard(e?"{Shift>}[ArrowLeft]{/Shift}":"[ArrowLeft]").catch(ih);break;case 45:Kd.keyboard(e?"{Shift>}[ArrowLeft][ArrowUp]{/Shift}":"[ArrowLeft][ArrowUp]").catch(ih);break;case 90:Kd.keyboard(e?"{Shift>}[ArrowUp]{/Shift}":"[ArrowUp]").catch(ih);break;case 135:Kd.keyboard(e?"{Shift>}[ArrowRight][ArrowUp]{/Shift}":"[ArrowRight][ArrowUp]").catch(ih);break;case 180:Kd.keyboard(e?"{Shift>}[ArrowRight]{/Shift}":"[ArrowRight]").catch(ih);break;case 225:Kd.keyboard(e?"{Shift>}[ArrowRight][ArrowDown]{/Shift}":"[ArrowRight][ArrowDown]").catch(ih);break;case 270:Kd.keyboard(e?"{Shift>}[ArrowDown]{/Shift}":"[ArrowDown]").catch(ih);break;case 315:Kd.keyboard(e?"{Shift>}[ArrowLeft][ArrowDown]{/Shift}":"[ArrowLeft][ArrowDown]").catch(ih);break;case 360:Kd.keyboard(e?"{Shift>}[ArrowLeft]{/Shift}":"[ArrowLeft]").catch(ih);break}}const UAt=VA/1e3,AM=new xt,cC=new Oe;function RM(t,e){const n=Kt.DRAW_CHAR_WIDTH(),i=Kt.DRAW_CHAR_HEIGHT(),r=cC.x+n*.5,s=cC.y+i*.5;return{cx:Math.floor(t*.5)+Math.floor(r/n),cy:Math.floor(e*.5)+Math.floor(s/i)}}function BAt({width:t,height:e,player:n,onDrawStick:i}){const{islandscape:r}=od(),[s]=De.useState({startx:-1,starty:-1,tipx:-1,tipy:-1,pointerid:-1,presscount:0,inputacc:VA});function a(o,c){s.tipx===-1&&(hm(o,c,3,6,6,1)?Y4e(Ye,n):hm(o,c,3,t-2,6,t-6)?Kd.keyboard("[Tab]").catch(ih):hm(o,c,e-5,6,e-2,1)?Kd.keyboard("[Enter]").catch(ih):hm(o,c,e-5,t-2,e-2,t-6)?Kd.keyboard("[Escape]").catch(ih):r&&hm(o,c,6,t,e-6,t-5)||!r&&hm(o,c,0,t-12,3,12)?od.setState(l=>({...l,sidebaropen:!l.sidebaropen})):hm(o,c,e-4,t-12,e-2,12)&&od.setState({showkeyboard:!0})),s.startx=-1,s.starty=-1,s.tipx=-1,s.tipy=-1,s.pointerid=-1,i(s.startx,s.starty,s.tipx,s.tipy)}return Pm((o,c)=>{if(s.inputacc+=c,s.inputacc>=UAt&&s.presscount>0){s.inputacc=0;const{cx:l,cy:u}=RM(t,e);if(AM.set(s.startx-l,s.starty-u),s.tipx!==-1||AM.length()>3){const h=$F(Ape(AM.angle()),45);LAt(h,s.presscount>1)}}}),be.jsx(of,{width:t,height:e,visible:!1,onPointerDown:o=>{if(qE(),++s.presscount,s.startx===-1){o.intersections[0].object.worldToLocal(cC.copy(o.intersections[0].point));const{cx:c,cy:l}=RM(t,e);s.startx=c,s.starty=l,s.tipx=-1,s.tipy=-1,s.pointerid=o.pointerId,s.inputacc=VA}},onPointerMove:o=>{if(o.pointerId===s.pointerid){o.intersections[0].object.worldToLocal(cC.copy(o.intersections[0].point));const{cx:c,cy:l}=RM(t,e);AM.set(s.startx-c,s.starty-l),(s.tipx!==-1||AM.length()>3)&&(s.tipx=c,s.tipy=l,i(s.startx,s.starty,s.tipx,s.tipy))}},onPointerCancel:o=>{if(--s.presscount,o.pointerId===s.pointerid){o.intersections[0].object.worldToLocal(cC.copy(o.intersections[0].point));const{cx:c,cy:l}=RM(t,e);a(c,l)}},onPointerUp:o=>{if(--s.presscount,o.pointerId===s.pointerid){o.intersections[0].object.worldToLocal(cC.copy(o.intersections[0].point));const{cx:c,cy:l}=RM(t,e);a(c,l)}}})}function FAt({width:t,height:e}){const n=Gi(),[i,r]=De.useState({startx:-1,starty:-1,tipx:-1,tipy:-1}),s=kk(t,e,0,qt.WHITE,qt.ONCLEAR),a={...FE(t,e,qt.WHITE,qt.ONCLEAR),...s.getState()};return ptt(1,1,t-2,e-2,a),be.jsxs(mP,{store:s,children:[be.jsx(DAt,{context:a,width:t,height:e,drawstick:i}),be.jsx(BAt,{width:t,height:e,player:n,onDrawStick:(o,c,l,u)=>r({startx:o,starty:c,tipx:l,tipy:u})}),be.jsx(vI,{width:t,height:e,top:5,left:0,right:5,bottom:e-6,alpha:.47135}),be.jsx(vI,{width:t,height:e,top:5,left:t-6,right:t-1,bottom:e-6,alpha:.47135}),be.jsx(gP,{width:t,height:e})]})}const Aoe=1.5,Roe=56,zAt=16,jAt=[[`
`],["[Escape]","$","1","2","3","4","5","6","7","8","9","0","&",`
`],[" ","Q","W","E","R","T","Y","U","I","O","P","-","+","*",`
`,`
`],["A","S","D","F","G","H","J","K","L","[Backspace]","_","=","%",`
`],[" ","Z","X","C","V","B","N","M","!","[Enter]","(",")","|",`
`],["                                          ","<",">","`",`
`],["[Space]","#","/","?",":","'",";",'"',"  ","[ArrowUp]",`
`],["         ","[Shift]","[Ctrl]","[Alt]","@","[ArrowLeft]","    ","[ArrowRight]",`
`],["                                      ","[ArrowDown]",`
`],["$greenz s s k e y s"]].flat();function HAt(t){return t.replaceAll("{","").replaceAll("}","").replaceAll("[","").replaceAll("]","")}function VAt(t,e,n,i){let r=t,s=HAt(t);switch(t){case"$":s=" $$ ";break;case";":s=" $59 ";break;case"[Escape]":s=" esc ";break;case"[ArrowUp]":s=" $30 ";break;case"[ArrowDown]":s=" $31 ";break;case"[ArrowRight]":s=" $16 ";break;case"[ArrowLeft]":s=" $17 ";break;case"[Backspace]":s=" del ";break;case"[Shift]":s=i?" SHIFT ":" shift ";break;case"[Ctrl]":s=n?" CTRL ":" ctrl ";break;case"[Alt]":s=e?" ALT ":" alt ";break;default:if(!i)r=r.toLowerCase(),s=s.toLowerCase();else switch(s){case"(":s="[";break;case")":s="]";break;case"<":s="{";break;case">":s="}";break;case"`":s="~";break}s=` ${s} `;break}return["touchkey","",r,"hk","",s]}function GAt({width:t,height:e}){const n=Gi(),{showkeyboard:i,keyboardalt:r,keyboardctrl:s,keyboardshift:a}=od(),o=De.useRef(null),[c]=De.useState({}),l=16;return i&&be.jsxs(be.Fragment,{children:[be.jsx(of,{blocking:!0,width:t,height:e,visible:!1,onPointerDown:u=>{qE(),c[u.pointerId]=u.point.x,re(o.current)&&(o.current.userData.x=o.current.position.x)},onPointerMove:u=>{const h=c[u.pointerId],d=u.point.x;if(re(h)&&o.current){const f=Kt.DRAW_CHAR_WIDTH()*Aoe,p=Math.round($F(d-h,f)/f);o.current.position.x=er(o.current.userData.x+p*f,Roe*-f+t*Kt.DRAW_CHAR_WIDTH(),0)}},onPointerUp:u=>{delete c[u.pointerId]}}),be.jsx(vI,{width:t,height:e,top:5,left:0,right:t-1,bottom:e-1,alpha:.753718}),be.jsx("group",{position:[0,0,1],children:be.jsx(of,{visible:!1,x:t*.5-l*.5,y:e-3.5,width:l,height:4,onClick:()=>{od.setState({showkeyboard:!1})}})}),be.jsx("group",{ref:o,scale:Aoe,children:be.jsx(Q_.Provider,{value:{sendmessage(u,h){Ye.emit(n,u,h)},sendclose(){},didclose(){}},children:be.jsx(bZ,{name:"keyboard",inline:!0,ymargin:1,color:qt.WHITE,bg:qt.ONCLEAR,width:Roe,height:zAt,text:jAt.map(u=>{switch(u){case`
`:return u;default:if(u.includes(" "))return u}return VAt(u,r,s,a)})})})})]})}function qAt({width:t,height:e}){const n=K8();return n.cols<10||n.rows<10?null:be.jsxs(be.Fragment,{children:[be.jsx("group",{position:[0,0,800],children:be.jsx(FAt,{width:t,height:e})}),be.jsx("group",{position:[0,0,850],children:be.jsx(GAt,{width:t,height:e})})]})}const STe=De.createContext({cols:1,rows:1});function K8(){return De.useContext(STe)}function $At({children:t}){const{viewport:e}=Tu(),{width:n,height:i}=e.getCurrentViewport(),{islandscape:r,showtouchcontrols:s}=od(),a=n/Kt.DRAW_CHAR_WIDTH();let o=Math.floor(a);const c=i/Kt.DRAW_CHAR_HEIGHT();let l=Math.floor(c);const u=(n-o*Kt.DRAW_CHAR_WIDTH())*.5,h=(i-l*Kt.DRAW_CHAR_HEIGHT())*.5;let d=0,f=0;const p=Math.round(a);let g=Math.round(c);if(s)if(r)d=5*Kt.DRAW_CHAR_WIDTH(),o-=5*2;else{l=Math.round(l*.666);const _=l-4;g-=_,f=_*Kt.DRAW_CHAR_HEIGHT()}return De.useEffect(()=>{od.setState(_=>({..._,insetcols:p,insetrows:g}))},[p,g]),be.jsxs(STe.Provider,{value:{cols:o,rows:l},children:[be.jsx(VSe,{makeDefault:!0,near:1,far:2e3,position:[0,0,1e3]}),o>=10&&l>=10&&be.jsx("group",{"scale-x":-1,"rotation-z":Math.PI,children:be.jsxs("group",{position:[n*-.5+u,i*-.5+h,0],children:[be.jsx("group",{position:[d,0,0],children:t}),s&&be.jsx("group",{position:[0,f,0],children:be.jsx(qAt,{width:p,height:g},p*g)})]})})]})}const DB=new Oe;function Moe(){const t=Kt.DRAW_CHAR_WIDTH(),e=Kt.DRAW_CHAR_HEIGHT(),n=Math.floor(DB.x/t),i=Math.floor((DB.y+e*.5)/e);return{x:n,y:ur*.5+i}}function WAt(){const t=As(u=>u.inspector),[e,n]=cw(Cu(u=>[u.cursor,u.select])),i=I3(e??0,kn),r=I3(n??e??0,kn),s={x:Math.min(i.x,r.x),y:Math.min(i.y,r.y)},a={x:Math.max(i.x,r.x),y:Math.max(i.y,r.y)},o=a.x-s.x+1,c=a.y-s.y+1;function l(){cw.getState().cursor&&o6e(Ye,Gi(),s,a),cw.setState(()=>({cursor:void 0,select:void 0}))}return be.jsxs(be.Fragment,{children:[t?be.jsx(of,{visible:!0,x:0,y:0,z:-1,width:kn,height:ur,color:"black",cursor:"pointer",onPointerDown:u=>{u.intersections[0].object.worldToLocal(DB.copy(u.intersections[0].point));const h=Moe();cw.setState(()=>({cursor:rh(h,kn)}))},onPointerMove:u=>{if(re(cw.getState().cursor)){u.intersections[0].object.worldToLocal(DB.copy(u.intersections[0].point));const h=Moe();cw.setState(()=>({select:rh(h,kn)}))}},onPointerUp:l,onPointerOut:l,onPointerCancel:l}):be.jsx(of,{visible:!0,x:0,y:0,z:-1,width:kn,height:ur,color:"black"}),re(e)&&be.jsxs(be.Fragment,{children:[be.jsx(of,{x:s.x+.25,y:s.y+.25,z:100,width:o-.5,height:c-.5,color:"black",opacity:.3}),be.jsx(of,{x:s.x,y:s.y,z:101,width:o,height:c,color:"white",opacity:.25})]})]})}const YAt=AY,KAt=CA(PE(G1)),Ooe=VT(V1(dR)),XAt=new qa({transparent:!1,side:Vc,uniforms:{time:Jd,interval:hP,smoothrate:new vn(YAt),palette:new vn(KAt),map:new vn(Ooe),alt:new vn(Ooe),dpr:new vn(1),screenwidth:new vn(1),screenheight:new vn(1),pointSize:{value:new xt(1,1)},rows:new vn(1),step:new vn(new xt),flip:new vn(!0)},vertexShader:`
    attribute float visible;
    attribute vec4 charData;
    attribute vec3 lastPosition;
    attribute vec2 lastColor;
    attribute vec2 lastBg;
    attribute vec2 animShake;
    attribute vec2 animBounce;

    uniform float smoothrate;
    uniform float time;
    uniform float interval;
    uniform vec2 pointSize;
    uniform vec3 palette[16];
    uniform float dpr;
    uniform float screenwidth;
    uniform float screenheight;
    uniform float tindex;

    varying float vVisible;
    varying vec2 vCharData;
    varying vec3 vColor;
    varying vec4 vBg;

    float rand(float co) {
      return fract(sin(co*(91.3458)) * 47453.5453);
    }

    vec3 colorFromIndex(float index) {
      return palette[int(index)];
    }

    vec4 bgFromIndex(float index) {
      vec4 bg;
      if (int(index) >= 16) {
        return vec4(0.0, 0.0, 0.0, 0.0);
      }
      bg.rgb = colorFromIndex(index);
      bg.a = 1.0;
      return bg;
    }

    float animDelta(float startTime, float deltaMod, float maxDelta) {
      float delta = time - startTime;
      if (delta < 0.0) {
        return maxDelta;
      }
      return clamp(delta * deltaMod, 0.0, maxDelta);
    }

    void main() {
      vVisible = visible;

      float deltaPosition = clamp((time - lastPosition.z) * smoothrate, 0.0, 1.0);
      vec2 animPosition = mix(lastPosition.xy, position.xy, deltaPosition);

      float deltaShake = 1.0 - animDelta(animShake.y, smoothrate * 0.5, 1.0); 
      animPosition += vec2(
        deltaShake - rand(cos(time) + animShake.x) * deltaShake * 2.0,
        deltaShake - rand(sin(time) + animShake.x) * deltaShake * 2.0
      ) * 0.5;

      float deltaBounce = 1.0 - abs(1.0 - animDelta(animBounce.y, smoothrate, 2.0));
      animPosition.y -= smoothstep(0.0, 1.0, deltaBounce);

      float deltaColor = animDelta(lastColor.y, smoothrate, 1.0);
      vec3 sourceColor = colorFromIndex(lastColor.x);
      vec3 destColor = colorFromIndex(charData.z);
      vColor = mix(sourceColor, destColor, deltaColor);

      float deltaBg = animDelta(lastBg.y, smoothrate, 1.0);
      vec4 sourceBg = bgFromIndex(lastBg.x);
      vec4 destBg = bgFromIndex(charData.w);
      vBg = mix(sourceBg, destBg, deltaBg);

      vCharData.xy = charData.xy;

      animPosition *= pointSize;
      animPosition += pointSize * 0.5;

      // model space
      vec4 mvPosition = modelViewMatrix * vec4(animPosition, 0.0, 1.0);

      // transform to screenspace 
      gl_Position = projectionMatrix * mvPosition;

      // this handles things being scaled
      float ptaspect = (screenwidth / screenheight);
      float ptsize = pointSize.y + ptaspect;
      
      gl_PointSize = (screenheight * ptsize) / gl_Position.w;
      gl_PointSize *= dpr;
      gl_Position.y -= ptsize - ptaspect;
    }
  `,fragmentShader:`
    uniform float time;
    uniform float interval;
    uniform sampler2D map;
    uniform sampler2D alt;
    uniform float rows;
    uniform vec2 step;
    uniform vec2 pointSize;
    uniform bool flip;

    varying float vVisible;
    varying vec2 vCharData;
    varying vec3 vColor;
    varying vec4 vBg;

    void main() {
      float xscale = pointSize.y / pointSize.x;
      float xpadding = (pointSize.y - pointSize.x) / pointSize.y;
      float px = gl_PointCoord.x * xscale - xpadding;      
      if (vVisible == 0.0 || px < 0.0 || px > 1.0) {
        discard;
      }

      vec2 lookup = vec2(vCharData.x, vCharData.y);

      float py = gl_PointCoord.y;
      if (flip) {
        py = 1.0 - py;
      }
      vec2 idx = vec2(px, py);
      vec2 char = vec2(lookup.x * step.x, (rows - lookup.y) * step.y);
      vec2 uv = idx * step + char;

      bool useAlt = mod(time, interval * 2.0) > interval;
      vec3 blip = useAlt ? texture2D(alt, uv).rgb : texture2D(map, uv).rgb;

      if (blip.r == 0.0) {
        if (vBg.a < 0.001) {
          discard;
        } else {
          gl_FragColor = vBg;
        }
      } else {
        gl_FragColor.rgb = vColor;
        gl_FragColor.a = 1.0;
      }
    }
  `});function ZAt(){return dP(XAt)}const JAt=AY,QAt=CA(PE(G1)),Noe=VT(V1(dR)),eRt=new qa({transparent:!1,side:Vc,uniforms:{time:Jd,interval:hP,smoothrate:new vn(JAt),palette:new vn(QAt),map:new vn(Noe),alt:new vn(Noe),dpr:new vn(1),screenwidth:new vn(1),screenheight:new vn(1),pointSize:{value:new xt(1,1)},rows:new vn(1),step:new vn(new xt),flip:new vn(!0)},vertexShader:`
    attribute float visible;
    attribute vec4 charData;
    attribute vec3 lastPosition;
    attribute vec2 lastColor;
    attribute vec2 lastBg;
    attribute vec2 animShake;
    attribute vec2 animBounce;

    uniform float smoothrate;
    uniform float time;
    uniform float interval;
    uniform vec2 pointSize;
    uniform vec3 palette[16];
    uniform float dpr;
    uniform float tindex;

    varying float vVisible;
    varying vec2 vCharData;
    varying vec3 vColor;
    varying vec4 vBg;

    float rand(float co) {
      return fract(sin(co*(91.3458)) * 47453.5453);
    }

    vec3 colorFromIndex(float index) {
      return palette[int(index)];
    }

    vec4 bgFromIndex(float index) {
      vec4 bg;
      if (int(index) >= 16) {
        return vec4(0.0, 0.0, 0.0, 0.0);
      }
      bg.rgb = colorFromIndex(index);
      bg.a = 1.0;
      return bg;
    }

    float animDelta(float startTime, float deltaMod, float maxDelta) {
      float delta = time - startTime;
      if (delta < 0.0) {
        return maxDelta;
      }
      return clamp(delta * deltaMod, 0.0, maxDelta);
    }

    void main() {
      vVisible = visible;

      float deltaPosition = clamp((time - lastPosition.z) * smoothrate, 0.0, 1.0);
      vec2 animPosition = mix(lastPosition.xy, position.xy, deltaPosition);

      float deltaShake = 1.0 - animDelta(animShake.y, smoothrate * 0.5, 1.0); 
      animPosition += vec2(
        deltaShake - rand(cos(time) + animShake.x) * deltaShake * 2.0,
        deltaShake - rand(sin(time) + animShake.x) * deltaShake * 2.0
      ) * 0.5;

      float deltaBounce = 1.0 - abs(1.0 - animDelta(animBounce.y, smoothrate, 2.0));
      animPosition.y -= smoothstep(0.0, 1.0, deltaBounce);

      float deltaColor = animDelta(lastColor.y, smoothrate, 1.0);
      vec3 sourceColor = colorFromIndex(lastColor.x);
      vec3 destColor = colorFromIndex(charData.z);
      vColor = mix(sourceColor, destColor, deltaColor);

      float deltaBg = animDelta(lastBg.y, smoothrate, 1.0);
      vec4 sourceBg = bgFromIndex(lastBg.x);
      vec4 destBg = bgFromIndex(charData.w);
      vBg = mix(sourceBg, destBg, deltaBg);

      vCharData.xy = charData.xy;

      animPosition *= pointSize;
      animPosition += pointSize * 0.5;

      // animPosition = animPosition * pointSize;
      // animPosition += pointSize * 0.5;
      // animPosition.x += (pointSize.y - pointSize.x) * 0.5;

      vec4 mvPosition = modelViewMatrix * vec4(animPosition, 0.0, 1.0);
      gl_Position = projectionMatrix * mvPosition;

      // this handles things being scaled
      gl_PointSize = pointSize.y * modelViewMatrix[0][0] * dpr + 1.0;
    }
  `,fragmentShader:`
    uniform float time;
    uniform float interval;
    uniform sampler2D map;
    uniform sampler2D alt;
    uniform float rows;
    uniform vec2 step;
    uniform vec2 pointSize;
    uniform bool flip;

    varying float vVisible;
    varying vec2 vCharData;
    varying vec3 vColor;
    varying vec4 vBg;

    void main() {
      float xscale = pointSize.y / pointSize.x;
      float xpadding = (pointSize.y - pointSize.x) / pointSize.y;
      float px = gl_PointCoord.x * xscale - xpadding;      
      if (vVisible == 0.0 || px < 0.0 || px > 1.0) {
        discard;
      }

      vec2 lookup = vec2(vCharData.x, vCharData.y);

      float py = gl_PointCoord.y;
      if (flip) {
        py = 1.0 - py;
      }
      vec2 idx = vec2(px, py);
      vec2 char = vec2(lookup.x * step.x, (rows - lookup.y) * step.y);
      vec2 uv = idx * step + char;

      bool useAlt = mod(time, interval * 2.0) > interval;
      vec3 blip = useAlt ? texture2D(alt, uv).rgb : texture2D(map, uv).rgb;

      if (blip.r == 0.0) {
        if (vBg.a < 1.0) {
          discard;
        } else {
          gl_FragColor = vBg;
        }
      } else {
        gl_FragColor.rgb = vColor;
        gl_FragColor.a = 1.0;
      }
    }
  `});function tRt(){return dP(eRt)}const Ioe=2048;function X8({sprites:t,fliptexture:e=!0,withbillboards:n=!1}){const{viewport:i}=Tu(),r=_p(d=>d.palettedata),s=_p(d=>d.charsetdata),a=_p(d=>d.altcharsetdata),o=De.useMemo(()=>n?ZAt():tRt(),[n]),c=De.useRef(null),l=De.useRef([]),{width:u=0,height:h=0}=(s==null?void 0:s.image)??{};return De.useMemo(()=>{var g;l.current.length===0&&(l.current=Array.from({length:Ioe},()=>({id:"",x:0,y:0,char:0,color:0,bg:0})));const d={};for(let _=0;_<t.length;++_)d[t[_].id]=t[_];const f=new Set(l.current.map(_=>_.id));let p=0;for(let _=0;_<Ioe;++_)if(l.current[_].id){const v=d[l.current[_].id];re(v)?l.current[_]={...v}:l.current[_].id=""}else if(p<t.length){for(;f.has((g=t[p])==null?void 0:g.id)===!0;)++p;p<t.length&&(l.current[_]={...t[p++]})}},[t]),De.useEffect(()=>{const{current:d}=c,{current:f}=l;if(!d||!f)return;let p=d.getAttribute("visible"),g=d.getAttribute("lastVisible"),_=d.getAttribute("position"),v=d.getAttribute("charData"),b=d.getAttribute("lastPosition"),S=d.getAttribute("lastColor"),x=d.getAttribute("lastBg"),M=d.getAttribute("animShake"),R=d.getAttribute("animBounce");if(!p||p.count!==f.length){p=new ar(new Float32Array(f.length),1),g=new ar(new Float32Array(f.length),1),_=new ar(new Float32Array(f.length*3),3),v=new ar(new Float32Array(f.length*4),4),b=new ar(new Float32Array(f.length*3),3),S=new ar(new Float32Array(f.length*2),2),x=new ar(new Float32Array(f.length*2),2),M=new ar(new Float32Array(f.length*2),2),R=new ar(new Float32Array(f.length*2),2);for(let I=0;I<f.length;++I){const k=f[I],P=k.id?1:0;p.setX(I,P),g.setX(I,P),_.setXY(I,k.x,k.y),v.setXYZW(I,k.char%dp,Math.floor(k.char/dp),k.color,k.bg),b.setXYZ(I,k.x,k.y,Jd.value),S.setXY(I,k.color,Jd.value),x.setXY(I,k.bg,Jd.value),M.setXY(I,0,Jd.value-1e6),R.setXY(I,0,Jd.value-1e6)}d.setAttribute("visible",p),d.setAttribute("lastVisible",g),d.setAttribute("position",_),d.setAttribute("charData",v),d.setAttribute("lastPosition",b),d.setAttribute("lastColor",S),d.setAttribute("lastBg",x),d.setAttribute("animShake",M),d.setAttribute("animBounce",R)}else for(let I=0;I<f.length;++I){const k=f[I],P=_.getX(I),U=_.getY(I),V=v.getX(I),$=v.getY(I),q=v.getZ(I),Y=v.getW(I);g.setX(I,p.getX(I)),g.needsUpdate=!0,p.setX(I,k.id?1:0),p.needsUpdate=!0;const te=g.getX(I)===0&&p.getX(I)===1;(te||P!==k.x||U!==k.y)&&(b.setXYZ(I,te?k.x:P,te?k.y:U,Jd.value),b.needsUpdate=!0,_.setXY(I,k.x,k.y),_.needsUpdate=!0),(te||q!==k.color)&&(S.setXY(I,te?k.color:q,Jd.value),S.needsUpdate=!0,v.setZ(I,k.color),v.needsUpdate=!0),(te||Y!==k.bg)&&(x.setXY(I,te?k.bg:Y,Jd.value),x.needsUpdate=!0,v.setW(I,k.bg),v.needsUpdate=!0);const G=k.char%dp,J=Math.floor(k.char/dp);(V!==G||$!==J)&&(v.setXY(I,G,J),v.needsUpdate=!0)}d.computeBoundingBox(),d.computeBoundingSphere()},[t]),De.useEffect(()=>{if(!s||!c.current)return;const d=Math.round(u/p_),f=Math.round(h/m_);o.uniforms.palette.value=r,o.uniforms.map.value=s,o.uniforms.alt.value=a??s,o.uniforms.dpr.value=1,o.uniforms.screenwidth.value=i.width,o.uniforms.screenheight.value=i.height,o.uniforms.pointSize.value.x=Kt.DRAW_CHAR_WIDTH(),o.uniforms.pointSize.value.y=Kt.DRAW_CHAR_HEIGHT(),o.uniforms.rows.value=f-1,o.uniforms.step.value.x=1/d,o.uniforms.step.value.y=1/f,o.uniforms.flip.value=e,o.needsUpdate=!0},[r,s,a,o,u,h,e,n,i.width,i.height]),be.jsx("points",{frustumCulled:!1,material:o,children:be.jsx("bufferGeometry",{ref:c})})}function S_({id:t,z:e,from:n}){const i=jr(Cu(r=>{var s;return(s=r.gadget[n])==null?void 0:s.find(a=>a.id===t)}));switch(i==null?void 0:i.type){default:case ks.BLANK:case ks.MEDIA:return null;case ks.TILES:return be.jsx("group",{position:[0,0,e],children:be.jsx(pP,{width:i.width,height:i.height,char:[...i.char],color:[...i.color],bg:[...i.bg]})},i.id);case ks.SPRITES:return be.jsx("group",{position:[0,0,e],children:be.jsx(X8,{sprites:[...i.sprites]})},i.id);case ks.DITHER:return be.jsx("group",{position:[0,0,e],children:be.jsx(E_,{width:i.width,height:i.height,alphas:[...i.alphas]})},i.id)}}class nRt{constructor(){this.encoder=new TextEncoder,this._pieces=[],this._parts=[]}append_buffer(e){this.flush(),this._parts.push(e)}append(e){this._pieces.push(e)}flush(){if(this._pieces.length>0){const e=new Uint8Array(this._pieces);this._parts.push(e),this._pieces=[]}}toArrayBuffer(){const e=[];for(const n of this._parts)e.push(n);return iRt(e).buffer}}function iRt(t){let e=0;for(const r of t)e+=r.byteLength;const n=new Uint8Array(e);let i=0;for(const r of t){const s=new Uint8Array(r.buffer,r.byteOffset,r.byteLength);n.set(s,i),i+=r.byteLength}return n}function TTe(t){return new rRt(t).unpack()}function xTe(t){const e=new sRt,n=e.pack(t);return n instanceof Promise?n.then(()=>e.getBuffer()):e.getBuffer()}class rRt{constructor(e){this.index=0,this.dataBuffer=e,this.dataView=new Uint8Array(this.dataBuffer),this.length=this.dataBuffer.byteLength}unpack(){const e=this.unpack_uint8();if(e<128)return e;if((e^224)<32)return(e^224)-32;let n;if((n=e^160)<=15)return this.unpack_raw(n);if((n=e^176)<=15)return this.unpack_string(n);if((n=e^144)<=15)return this.unpack_array(n);if((n=e^128)<=15)return this.unpack_map(n);switch(e){case 192:return null;case 193:return;case 194:return!1;case 195:return!0;case 202:return this.unpack_float();case 203:return this.unpack_double();case 204:return this.unpack_uint8();case 205:return this.unpack_uint16();case 206:return this.unpack_uint32();case 207:return this.unpack_uint64();case 208:return this.unpack_int8();case 209:return this.unpack_int16();case 210:return this.unpack_int32();case 211:return this.unpack_int64();case 212:return;case 213:return;case 214:return;case 215:return;case 216:return n=this.unpack_uint16(),this.unpack_string(n);case 217:return n=this.unpack_uint32(),this.unpack_string(n);case 218:return n=this.unpack_uint16(),this.unpack_raw(n);case 219:return n=this.unpack_uint32(),this.unpack_raw(n);case 220:return n=this.unpack_uint16(),this.unpack_array(n);case 221:return n=this.unpack_uint32(),this.unpack_array(n);case 222:return n=this.unpack_uint16(),this.unpack_map(n);case 223:return n=this.unpack_uint32(),this.unpack_map(n)}}unpack_uint8(){const e=this.dataView[this.index]&255;return this.index++,e}unpack_uint16(){const e=this.read(2),n=(e[0]&255)*256+(e[1]&255);return this.index+=2,n}unpack_uint32(){const e=this.read(4),n=((e[0]*256+e[1])*256+e[2])*256+e[3];return this.index+=4,n}unpack_uint64(){const e=this.read(8),n=((((((e[0]*256+e[1])*256+e[2])*256+e[3])*256+e[4])*256+e[5])*256+e[6])*256+e[7];return this.index+=8,n}unpack_int8(){const e=this.unpack_uint8();return e<128?e:e-256}unpack_int16(){const e=this.unpack_uint16();return e<32768?e:e-65536}unpack_int32(){const e=this.unpack_uint32();return e<2**31?e:e-2**32}unpack_int64(){const e=this.unpack_uint64();return e<2**63?e:e-2**64}unpack_raw(e){if(this.length<this.index+e)throw new Error(`BinaryPackFailure: index is out of range ${this.index} ${e} ${this.length}`);const n=this.dataBuffer.slice(this.index,this.index+e);return this.index+=e,n}unpack_string(e){const n=this.read(e);let i=0,r="",s,a;for(;i<e;)s=n[i],s<160?(a=s,i++):(s^192)<32?(a=(s&31)<<6|n[i+1]&63,i+=2):(s^224)<16?(a=(s&15)<<12|(n[i+1]&63)<<6|n[i+2]&63,i+=3):(a=(s&7)<<18|(n[i+1]&63)<<12|(n[i+2]&63)<<6|n[i+3]&63,i+=4),r+=String.fromCodePoint(a);return this.index+=e,r}unpack_array(e){const n=new Array(e);for(let i=0;i<e;i++)n[i]=this.unpack();return n}unpack_map(e){const n={};for(let i=0;i<e;i++){const r=this.unpack();n[r]=this.unpack()}return n}unpack_float(){const e=this.unpack_uint32(),n=e>>31,i=(e>>23&255)-127,r=e&8388607|8388608;return(n===0?1:-1)*r*2**(i-23)}unpack_double(){const e=this.unpack_uint32(),n=this.unpack_uint32(),i=e>>31,r=(e>>20&2047)-1023,a=(e&1048575|1048576)*2**(r-20)+n*2**(r-52);return(i===0?1:-1)*a}read(e){const n=this.index;if(n+e<=this.length)return this.dataView.subarray(n,n+e);throw new Error("BinaryPackFailure: read index out of range")}}class sRt{getBuffer(){return this._bufferBuilder.toArrayBuffer()}pack(e){if(typeof e=="string")this.pack_string(e);else if(typeof e=="number")Math.floor(e)===e?this.pack_integer(e):this.pack_double(e);else if(typeof e=="boolean")e===!0?this._bufferBuilder.append(195):e===!1&&this._bufferBuilder.append(194);else if(e===void 0)this._bufferBuilder.append(192);else if(typeof e=="object")if(e===null)this._bufferBuilder.append(192);else{const n=e.constructor;if(e instanceof Array){const i=this.pack_array(e);if(i instanceof Promise)return i.then(()=>this._bufferBuilder.flush())}else if(e instanceof ArrayBuffer)this.pack_bin(new Uint8Array(e));else if("BYTES_PER_ELEMENT"in e){const i=e;this.pack_bin(new Uint8Array(i.buffer,i.byteOffset,i.byteLength))}else if(e instanceof Date)this.pack_string(e.toString());else{if(e instanceof Blob)return e.arrayBuffer().then(i=>{this.pack_bin(new Uint8Array(i)),this._bufferBuilder.flush()});if(n==Object||n.toString().startsWith("class")){const i=this.pack_object(e);if(i instanceof Promise)return i.then(()=>this._bufferBuilder.flush())}else throw new Error(`Type "${n.toString()}" not yet supported`)}}else throw new Error(`Type "${typeof e}" not yet supported`);this._bufferBuilder.flush()}pack_bin(e){const n=e.length;if(n<=15)this.pack_uint8(160+n);else if(n<=65535)this._bufferBuilder.append(218),this.pack_uint16(n);else if(n<=4294967295)this._bufferBuilder.append(219),this.pack_uint32(n);else throw new Error("Invalid length");this._bufferBuilder.append_buffer(e)}pack_string(e){const n=this._textEncoder.encode(e),i=n.length;if(i<=15)this.pack_uint8(176+i);else if(i<=65535)this._bufferBuilder.append(216),this.pack_uint16(i);else if(i<=4294967295)this._bufferBuilder.append(217),this.pack_uint32(i);else throw new Error("Invalid length");this._bufferBuilder.append_buffer(n)}pack_array(e){const n=e.length;if(n<=15)this.pack_uint8(144+n);else if(n<=65535)this._bufferBuilder.append(220),this.pack_uint16(n);else if(n<=4294967295)this._bufferBuilder.append(221),this.pack_uint32(n);else throw new Error("Invalid length");const i=r=>{if(r<n){const s=this.pack(e[r]);return s instanceof Promise?s.then(()=>i(r+1)):i(r+1)}};return i(0)}pack_integer(e){if(e>=-32&&e<=127)this._bufferBuilder.append(e&255);else if(e>=0&&e<=255)this._bufferBuilder.append(204),this.pack_uint8(e);else if(e>=-128&&e<=127)this._bufferBuilder.append(208),this.pack_int8(e);else if(e>=0&&e<=65535)this._bufferBuilder.append(205),this.pack_uint16(e);else if(e>=-32768&&e<=32767)this._bufferBuilder.append(209),this.pack_int16(e);else if(e>=0&&e<=4294967295)this._bufferBuilder.append(206),this.pack_uint32(e);else if(e>=-2147483648&&e<=2147483647)this._bufferBuilder.append(210),this.pack_int32(e);else if(e>=-9223372036854776e3&&e<=9223372036854776e3)this._bufferBuilder.append(211),this.pack_int64(e);else if(e>=0&&e<=18446744073709552e3)this._bufferBuilder.append(207),this.pack_uint64(e);else throw new Error("Invalid integer")}pack_double(e){let n=0;e<0&&(n=1,e=-e);const i=Math.floor(Math.log(e)/Math.LN2),r=e/2**i-1,s=Math.floor(r*2**52),a=2**32,o=n<<31|i+1023<<20|s/a&1048575,c=s%a;this._bufferBuilder.append(203),this.pack_int32(o),this.pack_int32(c)}pack_object(e){const n=Object.keys(e),i=n.length;if(i<=15)this.pack_uint8(128+i);else if(i<=65535)this._bufferBuilder.append(222),this.pack_uint16(i);else if(i<=4294967295)this._bufferBuilder.append(223),this.pack_uint32(i);else throw new Error("Invalid length");const r=s=>{if(s<n.length){const a=n[s];if(e.hasOwnProperty(a)){this.pack(a);const o=this.pack(e[a]);if(o instanceof Promise)return o.then(()=>r(s+1))}return r(s+1)}};return r(0)}pack_uint8(e){this._bufferBuilder.append(e)}pack_uint16(e){this._bufferBuilder.append(e>>8),this._bufferBuilder.append(e&255)}pack_uint32(e){const n=e&4294967295;this._bufferBuilder.append((n&4278190080)>>>24),this._bufferBuilder.append((n&16711680)>>>16),this._bufferBuilder.append((n&65280)>>>8),this._bufferBuilder.append(n&255)}pack_uint64(e){const n=e/4294967296,i=e%2**32;this._bufferBuilder.append((n&4278190080)>>>24),this._bufferBuilder.append((n&16711680)>>>16),this._bufferBuilder.append((n&65280)>>>8),this._bufferBuilder.append(n&255),this._bufferBuilder.append((i&4278190080)>>>24),this._bufferBuilder.append((i&16711680)>>>16),this._bufferBuilder.append((i&65280)>>>8),this._bufferBuilder.append(i&255)}pack_int8(e){this._bufferBuilder.append(e&255)}pack_int16(e){this._bufferBuilder.append((e&65280)>>8),this._bufferBuilder.append(e&255)}pack_int32(e){this._bufferBuilder.append(e>>>24&255),this._bufferBuilder.append((e&16711680)>>>16),this._bufferBuilder.append((e&65280)>>>8),this._bufferBuilder.append(e&255)}pack_int64(e){const n=Math.floor(e/4294967296),i=e%2**32;this._bufferBuilder.append((n&4278190080)>>>24),this._bufferBuilder.append((n&16711680)>>>16),this._bufferBuilder.append((n&65280)>>>8),this._bufferBuilder.append(n&255),this._bufferBuilder.append((i&4278190080)>>>24),this._bufferBuilder.append((i&16711680)>>>16),this._bufferBuilder.append((i&65280)>>>8),this._bufferBuilder.append(i&255)}constructor(){this._bufferBuilder=new nRt,this._textEncoder=new TextEncoder}}let wTe=!0,CTe=!0;function RL(t,e,n){const i=t.match(e);return i&&i.length>=n&&parseInt(i[n],10)}function ax(t,e,n){if(!t.RTCPeerConnection)return;const i=t.RTCPeerConnection.prototype,r=i.addEventListener;i.addEventListener=function(a,o){if(a!==e)return r.apply(this,arguments);const c=l=>{const u=n(l);u&&(o.handleEvent?o.handleEvent(u):o(u))};return this._eventMap=this._eventMap||{},this._eventMap[e]||(this._eventMap[e]=new Map),this._eventMap[e].set(o,c),r.apply(this,[a,c])};const s=i.removeEventListener;i.removeEventListener=function(a,o){if(a!==e||!this._eventMap||!this._eventMap[e])return s.apply(this,arguments);if(!this._eventMap[e].has(o))return s.apply(this,arguments);const c=this._eventMap[e].get(o);return this._eventMap[e].delete(o),this._eventMap[e].size===0&&delete this._eventMap[e],Object.keys(this._eventMap).length===0&&delete this._eventMap,s.apply(this,[a,c])},Object.defineProperty(i,"on"+e,{get(){return this["_on"+e]},set(a){this["_on"+e]&&(this.removeEventListener(e,this["_on"+e]),delete this["_on"+e]),a&&this.addEventListener(e,this["_on"+e]=a)},enumerable:!0,configurable:!0})}function aRt(t){return typeof t!="boolean"?new Error("Argument type: "+typeof t+". Please use a boolean."):(wTe=t,t?"adapter.js logging disabled":"adapter.js logging enabled")}function oRt(t){return typeof t!="boolean"?new Error("Argument type: "+typeof t+". Please use a boolean."):(CTe=!t,"adapter.js deprecation warnings "+(t?"disabled":"enabled"))}function ATe(){if(typeof window=="object"){if(wTe)return;typeof console<"u"&&typeof console.log=="function"&&console.log.apply(console,arguments)}}function SZ(t,e){CTe&&console.warn(t+" is deprecated, please use "+e+" instead.")}function cRt(t){const e={browser:null,version:null};if(typeof t>"u"||!t.navigator||!t.navigator.userAgent)return e.browser="Not a browser.",e;const{navigator:n}=t;if(n.userAgentData&&n.userAgentData.brands){const i=n.userAgentData.brands.find(r=>r.brand==="Chromium");if(i)return{browser:"chrome",version:parseInt(i.version,10)}}if(n.mozGetUserMedia)e.browser="firefox",e.version=RL(n.userAgent,/Firefox\/(\d+)\./,1);else if(n.webkitGetUserMedia||t.isSecureContext===!1&&t.webkitRTCPeerConnection)e.browser="chrome",e.version=RL(n.userAgent,/Chrom(e|ium)\/(\d+)\./,2);else if(t.RTCPeerConnection&&n.userAgent.match(/AppleWebKit\/(\d+)\./))e.browser="safari",e.version=RL(n.userAgent,/AppleWebKit\/(\d+)\./,1),e.supportsUnifiedPlan=t.RTCRtpTransceiver&&"currentDirection"in t.RTCRtpTransceiver.prototype;else return e.browser="Not a supported browser.",e;return e}function koe(t){return Object.prototype.toString.call(t)==="[object Object]"}function RTe(t){return koe(t)?Object.keys(t).reduce(function(e,n){const i=koe(t[n]),r=i?RTe(t[n]):t[n],s=i&&!Object.keys(r).length;return r===void 0||s?e:Object.assign(e,{[n]:r})},{}):t}function u7(t,e,n){!e||n.has(e.id)||(n.set(e.id,e),Object.keys(e).forEach(i=>{i.endsWith("Id")?u7(t,t.get(e[i]),n):i.endsWith("Ids")&&e[i].forEach(r=>{u7(t,t.get(r),n)})}))}function Poe(t,e,n){const i=n?"outbound-rtp":"inbound-rtp",r=new Map;if(e===null)return r;const s=[];return t.forEach(a=>{a.type==="track"&&a.trackIdentifier===e.id&&s.push(a)}),s.forEach(a=>{t.forEach(o=>{o.type===i&&o.trackId===a.id&&u7(t,o,r)})}),r}const Doe=ATe;function MTe(t,e){const n=t&&t.navigator;if(!n.mediaDevices)return;const i=function(o){if(typeof o!="object"||o.mandatory||o.optional)return o;const c={};return Object.keys(o).forEach(l=>{if(l==="require"||l==="advanced"||l==="mediaSource")return;const u=typeof o[l]=="object"?o[l]:{ideal:o[l]};u.exact!==void 0&&typeof u.exact=="number"&&(u.min=u.max=u.exact);const h=function(d,f){return d?d+f.charAt(0).toUpperCase()+f.slice(1):f==="deviceId"?"sourceId":f};if(u.ideal!==void 0){c.optional=c.optional||[];let d={};typeof u.ideal=="number"?(d[h("min",l)]=u.ideal,c.optional.push(d),d={},d[h("max",l)]=u.ideal,c.optional.push(d)):(d[h("",l)]=u.ideal,c.optional.push(d))}u.exact!==void 0&&typeof u.exact!="number"?(c.mandatory=c.mandatory||{},c.mandatory[h("",l)]=u.exact):["min","max"].forEach(d=>{u[d]!==void 0&&(c.mandatory=c.mandatory||{},c.mandatory[h(d,l)]=u[d])})}),o.advanced&&(c.optional=(c.optional||[]).concat(o.advanced)),c},r=function(o,c){if(e.version>=61)return c(o);if(o=JSON.parse(JSON.stringify(o)),o&&typeof o.audio=="object"){const l=function(u,h,d){h in u&&!(d in u)&&(u[d]=u[h],delete u[h])};o=JSON.parse(JSON.stringify(o)),l(o.audio,"autoGainControl","googAutoGainControl"),l(o.audio,"noiseSuppression","googNoiseSuppression"),o.audio=i(o.audio)}if(o&&typeof o.video=="object"){let l=o.video.facingMode;l=l&&(typeof l=="object"?l:{ideal:l});const u=e.version<66;if(l&&(l.exact==="user"||l.exact==="environment"||l.ideal==="user"||l.ideal==="environment")&&!(n.mediaDevices.getSupportedConstraints&&n.mediaDevices.getSupportedConstraints().facingMode&&!u)){delete o.video.facingMode;let h;if(l.exact==="environment"||l.ideal==="environment"?h=["back","rear"]:(l.exact==="user"||l.ideal==="user")&&(h=["front"]),h)return n.mediaDevices.enumerateDevices().then(d=>{d=d.filter(p=>p.kind==="videoinput");let f=d.find(p=>h.some(g=>p.label.toLowerCase().includes(g)));return!f&&d.length&&h.includes("back")&&(f=d[d.length-1]),f&&(o.video.deviceId=l.exact?{exact:f.deviceId}:{ideal:f.deviceId}),o.video=i(o.video),Doe("chrome: "+JSON.stringify(o)),c(o)})}o.video=i(o.video)}return Doe("chrome: "+JSON.stringify(o)),c(o)},s=function(o){return e.version>=64?o:{name:{PermissionDeniedError:"NotAllowedError",PermissionDismissedError:"NotAllowedError",InvalidStateError:"NotAllowedError",DevicesNotFoundError:"NotFoundError",ConstraintNotSatisfiedError:"OverconstrainedError",TrackStartError:"NotReadableError",MediaDeviceFailedDueToShutdown:"NotAllowedError",MediaDeviceKillSwitchOn:"NotAllowedError",TabCaptureError:"AbortError",ScreenCaptureError:"AbortError",DeviceCaptureError:"AbortError"}[o.name]||o.name,message:o.message,constraint:o.constraint||o.constraintName,toString(){return this.name+(this.message&&": ")+this.message}}},a=function(o,c,l){r(o,u=>{n.webkitGetUserMedia(u,c,h=>{l&&l(s(h))})})};if(n.getUserMedia=a.bind(n),n.mediaDevices.getUserMedia){const o=n.mediaDevices.getUserMedia.bind(n.mediaDevices);n.mediaDevices.getUserMedia=function(c){return r(c,l=>o(l).then(u=>{if(l.audio&&!u.getAudioTracks().length||l.video&&!u.getVideoTracks().length)throw u.getTracks().forEach(h=>{h.stop()}),new DOMException("","NotFoundError");return u},u=>Promise.reject(s(u))))}}}function OTe(t){t.MediaStream=t.MediaStream||t.webkitMediaStream}function NTe(t){if(typeof t=="object"&&t.RTCPeerConnection&&!("ontrack"in t.RTCPeerConnection.prototype)){Object.defineProperty(t.RTCPeerConnection.prototype,"ontrack",{get(){return this._ontrack},set(n){this._ontrack&&this.removeEventListener("track",this._ontrack),this.addEventListener("track",this._ontrack=n)},enumerable:!0,configurable:!0});const e=t.RTCPeerConnection.prototype.setRemoteDescription;t.RTCPeerConnection.prototype.setRemoteDescription=function(){return this._ontrackpoly||(this._ontrackpoly=i=>{i.stream.addEventListener("addtrack",r=>{let s;t.RTCPeerConnection.prototype.getReceivers?s=this.getReceivers().find(o=>o.track&&o.track.id===r.track.id):s={track:r.track};const a=new Event("track");a.track=r.track,a.receiver=s,a.transceiver={receiver:s},a.streams=[i.stream],this.dispatchEvent(a)}),i.stream.getTracks().forEach(r=>{let s;t.RTCPeerConnection.prototype.getReceivers?s=this.getReceivers().find(o=>o.track&&o.track.id===r.id):s={track:r};const a=new Event("track");a.track=r,a.receiver=s,a.transceiver={receiver:s},a.streams=[i.stream],this.dispatchEvent(a)})},this.addEventListener("addstream",this._ontrackpoly)),e.apply(this,arguments)}}else ax(t,"track",e=>(e.transceiver||Object.defineProperty(e,"transceiver",{value:{receiver:e.receiver}}),e))}function ITe(t){if(typeof t=="object"&&t.RTCPeerConnection&&!("getSenders"in t.RTCPeerConnection.prototype)&&"createDTMFSender"in t.RTCPeerConnection.prototype){const e=function(r,s){return{track:s,get dtmf(){return this._dtmf===void 0&&(s.kind==="audio"?this._dtmf=r.createDTMFSender(s):this._dtmf=null),this._dtmf},_pc:r}};if(!t.RTCPeerConnection.prototype.getSenders){t.RTCPeerConnection.prototype.getSenders=function(){return this._senders=this._senders||[],this._senders.slice()};const r=t.RTCPeerConnection.prototype.addTrack;t.RTCPeerConnection.prototype.addTrack=function(o,c){let l=r.apply(this,arguments);return l||(l=e(this,o),this._senders.push(l)),l};const s=t.RTCPeerConnection.prototype.removeTrack;t.RTCPeerConnection.prototype.removeTrack=function(o){s.apply(this,arguments);const c=this._senders.indexOf(o);c!==-1&&this._senders.splice(c,1)}}const n=t.RTCPeerConnection.prototype.addStream;t.RTCPeerConnection.prototype.addStream=function(s){this._senders=this._senders||[],n.apply(this,[s]),s.getTracks().forEach(a=>{this._senders.push(e(this,a))})};const i=t.RTCPeerConnection.prototype.removeStream;t.RTCPeerConnection.prototype.removeStream=function(s){this._senders=this._senders||[],i.apply(this,[s]),s.getTracks().forEach(a=>{const o=this._senders.find(c=>c.track===a);o&&this._senders.splice(this._senders.indexOf(o),1)})}}else if(typeof t=="object"&&t.RTCPeerConnection&&"getSenders"in t.RTCPeerConnection.prototype&&"createDTMFSender"in t.RTCPeerConnection.prototype&&t.RTCRtpSender&&!("dtmf"in t.RTCRtpSender.prototype)){const e=t.RTCPeerConnection.prototype.getSenders;t.RTCPeerConnection.prototype.getSenders=function(){const i=e.apply(this,[]);return i.forEach(r=>r._pc=this),i},Object.defineProperty(t.RTCRtpSender.prototype,"dtmf",{get(){return this._dtmf===void 0&&(this.track.kind==="audio"?this._dtmf=this._pc.createDTMFSender(this.track):this._dtmf=null),this._dtmf}})}}function kTe(t){if(!(typeof t=="object"&&t.RTCPeerConnection&&t.RTCRtpSender&&t.RTCRtpReceiver))return;if(!("getStats"in t.RTCRtpSender.prototype)){const n=t.RTCPeerConnection.prototype.getSenders;n&&(t.RTCPeerConnection.prototype.getSenders=function(){const s=n.apply(this,[]);return s.forEach(a=>a._pc=this),s});const i=t.RTCPeerConnection.prototype.addTrack;i&&(t.RTCPeerConnection.prototype.addTrack=function(){const s=i.apply(this,arguments);return s._pc=this,s}),t.RTCRtpSender.prototype.getStats=function(){const s=this;return this._pc.getStats().then(a=>Poe(a,s.track,!0))}}if(!("getStats"in t.RTCRtpReceiver.prototype)){const n=t.RTCPeerConnection.prototype.getReceivers;n&&(t.RTCPeerConnection.prototype.getReceivers=function(){const r=n.apply(this,[]);return r.forEach(s=>s._pc=this),r}),ax(t,"track",i=>(i.receiver._pc=i.srcElement,i)),t.RTCRtpReceiver.prototype.getStats=function(){const r=this;return this._pc.getStats().then(s=>Poe(s,r.track,!1))}}if(!("getStats"in t.RTCRtpSender.prototype&&"getStats"in t.RTCRtpReceiver.prototype))return;const e=t.RTCPeerConnection.prototype.getStats;t.RTCPeerConnection.prototype.getStats=function(){if(arguments.length>0&&arguments[0]instanceof t.MediaStreamTrack){const i=arguments[0];let r,s,a;return this.getSenders().forEach(o=>{o.track===i&&(r?a=!0:r=o)}),this.getReceivers().forEach(o=>(o.track===i&&(s?a=!0:s=o),o.track===i)),a||r&&s?Promise.reject(new DOMException("There are more than one sender or receiver for the track.","InvalidAccessError")):r?r.getStats():s?s.getStats():Promise.reject(new DOMException("There is no sender or receiver for the track.","InvalidAccessError"))}return e.apply(this,arguments)}}function PTe(t){t.RTCPeerConnection.prototype.getLocalStreams=function(){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},Object.keys(this._shimmedLocalStreams).map(a=>this._shimmedLocalStreams[a][0])};const e=t.RTCPeerConnection.prototype.addTrack;t.RTCPeerConnection.prototype.addTrack=function(a,o){if(!o)return e.apply(this,arguments);this._shimmedLocalStreams=this._shimmedLocalStreams||{};const c=e.apply(this,arguments);return this._shimmedLocalStreams[o.id]?this._shimmedLocalStreams[o.id].indexOf(c)===-1&&this._shimmedLocalStreams[o.id].push(c):this._shimmedLocalStreams[o.id]=[o,c],c};const n=t.RTCPeerConnection.prototype.addStream;t.RTCPeerConnection.prototype.addStream=function(a){this._shimmedLocalStreams=this._shimmedLocalStreams||{},a.getTracks().forEach(l=>{if(this.getSenders().find(h=>h.track===l))throw new DOMException("Track already exists.","InvalidAccessError")});const o=this.getSenders();n.apply(this,arguments);const c=this.getSenders().filter(l=>o.indexOf(l)===-1);this._shimmedLocalStreams[a.id]=[a].concat(c)};const i=t.RTCPeerConnection.prototype.removeStream;t.RTCPeerConnection.prototype.removeStream=function(a){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},delete this._shimmedLocalStreams[a.id],i.apply(this,arguments)};const r=t.RTCPeerConnection.prototype.removeTrack;t.RTCPeerConnection.prototype.removeTrack=function(a){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},a&&Object.keys(this._shimmedLocalStreams).forEach(o=>{const c=this._shimmedLocalStreams[o].indexOf(a);c!==-1&&this._shimmedLocalStreams[o].splice(c,1),this._shimmedLocalStreams[o].length===1&&delete this._shimmedLocalStreams[o]}),r.apply(this,arguments)}}function DTe(t,e){if(!t.RTCPeerConnection)return;if(t.RTCPeerConnection.prototype.addTrack&&e.version>=65)return PTe(t);const n=t.RTCPeerConnection.prototype.getLocalStreams;t.RTCPeerConnection.prototype.getLocalStreams=function(){const u=n.apply(this);return this._reverseStreams=this._reverseStreams||{},u.map(h=>this._reverseStreams[h.id])};const i=t.RTCPeerConnection.prototype.addStream;t.RTCPeerConnection.prototype.addStream=function(u){if(this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},u.getTracks().forEach(h=>{if(this.getSenders().find(f=>f.track===h))throw new DOMException("Track already exists.","InvalidAccessError")}),!this._reverseStreams[u.id]){const h=new t.MediaStream(u.getTracks());this._streams[u.id]=h,this._reverseStreams[h.id]=u,u=h}i.apply(this,[u])};const r=t.RTCPeerConnection.prototype.removeStream;t.RTCPeerConnection.prototype.removeStream=function(u){this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},r.apply(this,[this._streams[u.id]||u]),delete this._reverseStreams[this._streams[u.id]?this._streams[u.id].id:u.id],delete this._streams[u.id]},t.RTCPeerConnection.prototype.addTrack=function(u,h){if(this.signalingState==="closed")throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");const d=[].slice.call(arguments,1);if(d.length!==1||!d[0].getTracks().find(g=>g===u))throw new DOMException("The adapter.js addTrack polyfill only supports a single  stream which is associated with the specified track.","NotSupportedError");if(this.getSenders().find(g=>g.track===u))throw new DOMException("Track already exists.","InvalidAccessError");this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{};const p=this._streams[h.id];if(p)p.addTrack(u),Promise.resolve().then(()=>{this.dispatchEvent(new Event("negotiationneeded"))});else{const g=new t.MediaStream([u]);this._streams[h.id]=g,this._reverseStreams[g.id]=h,this.addStream(g)}return this.getSenders().find(g=>g.track===u)};function s(l,u){let h=u.sdp;return Object.keys(l._reverseStreams||[]).forEach(d=>{const f=l._reverseStreams[d],p=l._streams[f.id];h=h.replace(new RegExp(p.id,"g"),f.id)}),new RTCSessionDescription({type:u.type,sdp:h})}function a(l,u){let h=u.sdp;return Object.keys(l._reverseStreams||[]).forEach(d=>{const f=l._reverseStreams[d],p=l._streams[f.id];h=h.replace(new RegExp(f.id,"g"),p.id)}),new RTCSessionDescription({type:u.type,sdp:h})}["createOffer","createAnswer"].forEach(function(l){const u=t.RTCPeerConnection.prototype[l],h={[l](){const d=arguments;return arguments.length&&typeof arguments[0]=="function"?u.apply(this,[p=>{const g=s(this,p);d[0].apply(null,[g])},p=>{d[1]&&d[1].apply(null,p)},arguments[2]]):u.apply(this,arguments).then(p=>s(this,p))}};t.RTCPeerConnection.prototype[l]=h[l]});const o=t.RTCPeerConnection.prototype.setLocalDescription;t.RTCPeerConnection.prototype.setLocalDescription=function(){return!arguments.length||!arguments[0].type?o.apply(this,arguments):(arguments[0]=a(this,arguments[0]),o.apply(this,arguments))};const c=Object.getOwnPropertyDescriptor(t.RTCPeerConnection.prototype,"localDescription");Object.defineProperty(t.RTCPeerConnection.prototype,"localDescription",{get(){const l=c.get.apply(this);return l.type===""?l:s(this,l)}}),t.RTCPeerConnection.prototype.removeTrack=function(u){if(this.signalingState==="closed")throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");if(!u._pc)throw new DOMException("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.","TypeError");if(!(u._pc===this))throw new DOMException("Sender was not created by this connection.","InvalidAccessError");this._streams=this._streams||{};let d;Object.keys(this._streams).forEach(f=>{this._streams[f].getTracks().find(g=>u.track===g)&&(d=this._streams[f])}),d&&(d.getTracks().length===1?this.removeStream(this._reverseStreams[d.id]):d.removeTrack(u.track),this.dispatchEvent(new Event("negotiationneeded")))}}function h7(t,e){!t.RTCPeerConnection&&t.webkitRTCPeerConnection&&(t.RTCPeerConnection=t.webkitRTCPeerConnection),t.RTCPeerConnection&&e.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(n){const i=t.RTCPeerConnection.prototype[n],r={[n](){return arguments[0]=new(n==="addIceCandidate"?t.RTCIceCandidate:t.RTCSessionDescription)(arguments[0]),i.apply(this,arguments)}};t.RTCPeerConnection.prototype[n]=r[n]})}function LTe(t,e){ax(t,"negotiationneeded",n=>{const i=n.target;if(!((e.version<72||i.getConfiguration&&i.getConfiguration().sdpSemantics==="plan-b")&&i.signalingState!=="stable"))return n})}const Loe=Object.freeze(Object.defineProperty({__proto__:null,fixNegotiationNeeded:LTe,shimAddTrackRemoveTrack:DTe,shimAddTrackRemoveTrackWithNative:PTe,shimGetSendersWithDtmf:ITe,shimGetUserMedia:MTe,shimMediaStream:OTe,shimOnTrack:NTe,shimPeerConnection:h7,shimSenderReceiverGetStats:kTe},Symbol.toStringTag,{value:"Module"}));function UTe(t,e){const n=t&&t.navigator,i=t&&t.MediaStreamTrack;if(n.getUserMedia=function(r,s,a){SZ("navigator.getUserMedia","navigator.mediaDevices.getUserMedia"),n.mediaDevices.getUserMedia(r).then(s,a)},!(e.version>55&&"autoGainControl"in n.mediaDevices.getSupportedConstraints())){const r=function(a,o,c){o in a&&!(c in a)&&(a[c]=a[o],delete a[o])},s=n.mediaDevices.getUserMedia.bind(n.mediaDevices);if(n.mediaDevices.getUserMedia=function(a){return typeof a=="object"&&typeof a.audio=="object"&&(a=JSON.parse(JSON.stringify(a)),r(a.audio,"autoGainControl","mozAutoGainControl"),r(a.audio,"noiseSuppression","mozNoiseSuppression")),s(a)},i&&i.prototype.getSettings){const a=i.prototype.getSettings;i.prototype.getSettings=function(){const o=a.apply(this,arguments);return r(o,"mozAutoGainControl","autoGainControl"),r(o,"mozNoiseSuppression","noiseSuppression"),o}}if(i&&i.prototype.applyConstraints){const a=i.prototype.applyConstraints;i.prototype.applyConstraints=function(o){return this.kind==="audio"&&typeof o=="object"&&(o=JSON.parse(JSON.stringify(o)),r(o,"autoGainControl","mozAutoGainControl"),r(o,"noiseSuppression","mozNoiseSuppression")),a.apply(this,[o])}}}}function lRt(t,e){t.navigator.mediaDevices&&"getDisplayMedia"in t.navigator.mediaDevices||t.navigator.mediaDevices&&(t.navigator.mediaDevices.getDisplayMedia=function(i){if(!(i&&i.video)){const r=new DOMException("getDisplayMedia without video constraints is undefined");return r.name="NotFoundError",r.code=8,Promise.reject(r)}return i.video===!0?i.video={mediaSource:e}:i.video.mediaSource=e,t.navigator.mediaDevices.getUserMedia(i)})}function BTe(t){typeof t=="object"&&t.RTCTrackEvent&&"receiver"in t.RTCTrackEvent.prototype&&!("transceiver"in t.RTCTrackEvent.prototype)&&Object.defineProperty(t.RTCTrackEvent.prototype,"transceiver",{get(){return{receiver:this.receiver}}})}function d7(t,e){if(typeof t!="object"||!(t.RTCPeerConnection||t.mozRTCPeerConnection))return;!t.RTCPeerConnection&&t.mozRTCPeerConnection&&(t.RTCPeerConnection=t.mozRTCPeerConnection),e.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(r){const s=t.RTCPeerConnection.prototype[r],a={[r](){return arguments[0]=new(r==="addIceCandidate"?t.RTCIceCandidate:t.RTCSessionDescription)(arguments[0]),s.apply(this,arguments)}};t.RTCPeerConnection.prototype[r]=a[r]});const n={inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"},i=t.RTCPeerConnection.prototype.getStats;t.RTCPeerConnection.prototype.getStats=function(){const[s,a,o]=arguments;return i.apply(this,[s||null]).then(c=>{if(e.version<53&&!a)try{c.forEach(l=>{l.type=n[l.type]||l.type})}catch(l){if(l.name!=="TypeError")throw l;c.forEach((u,h)=>{c.set(h,Object.assign({},u,{type:n[u.type]||u.type}))})}return c}).then(a,o)}}function FTe(t){if(!(typeof t=="object"&&t.RTCPeerConnection&&t.RTCRtpSender)||t.RTCRtpSender&&"getStats"in t.RTCRtpSender.prototype)return;const e=t.RTCPeerConnection.prototype.getSenders;e&&(t.RTCPeerConnection.prototype.getSenders=function(){const r=e.apply(this,[]);return r.forEach(s=>s._pc=this),r});const n=t.RTCPeerConnection.prototype.addTrack;n&&(t.RTCPeerConnection.prototype.addTrack=function(){const r=n.apply(this,arguments);return r._pc=this,r}),t.RTCRtpSender.prototype.getStats=function(){return this.track?this._pc.getStats(this.track):Promise.resolve(new Map)}}function zTe(t){if(!(typeof t=="object"&&t.RTCPeerConnection&&t.RTCRtpSender)||t.RTCRtpSender&&"getStats"in t.RTCRtpReceiver.prototype)return;const e=t.RTCPeerConnection.prototype.getReceivers;e&&(t.RTCPeerConnection.prototype.getReceivers=function(){const i=e.apply(this,[]);return i.forEach(r=>r._pc=this),i}),ax(t,"track",n=>(n.receiver._pc=n.srcElement,n)),t.RTCRtpReceiver.prototype.getStats=function(){return this._pc.getStats(this.track)}}function jTe(t){!t.RTCPeerConnection||"removeStream"in t.RTCPeerConnection.prototype||(t.RTCPeerConnection.prototype.removeStream=function(n){SZ("removeStream","removeTrack"),this.getSenders().forEach(i=>{i.track&&n.getTracks().includes(i.track)&&this.removeTrack(i)})})}function HTe(t){t.DataChannel&&!t.RTCDataChannel&&(t.RTCDataChannel=t.DataChannel)}function VTe(t){if(!(typeof t=="object"&&t.RTCPeerConnection))return;const e=t.RTCPeerConnection.prototype.addTransceiver;e&&(t.RTCPeerConnection.prototype.addTransceiver=function(){this.setParametersPromises=[];let i=arguments[1]&&arguments[1].sendEncodings;i===void 0&&(i=[]),i=[...i];const r=i.length>0;r&&i.forEach(a=>{if("rid"in a&&!/^[a-z0-9]{0,16}$/i.test(a.rid))throw new TypeError("Invalid RID value provided.");if("scaleResolutionDownBy"in a&&!(parseFloat(a.scaleResolutionDownBy)>=1))throw new RangeError("scale_resolution_down_by must be >= 1.0");if("maxFramerate"in a&&!(parseFloat(a.maxFramerate)>=0))throw new RangeError("max_framerate must be >= 0.0")});const s=e.apply(this,arguments);if(r){const{sender:a}=s,o=a.getParameters();(!("encodings"in o)||o.encodings.length===1&&Object.keys(o.encodings[0]).length===0)&&(o.encodings=i,a.sendEncodings=i,this.setParametersPromises.push(a.setParameters(o).then(()=>{delete a.sendEncodings}).catch(()=>{delete a.sendEncodings})))}return s})}function GTe(t){if(!(typeof t=="object"&&t.RTCRtpSender))return;const e=t.RTCRtpSender.prototype.getParameters;e&&(t.RTCRtpSender.prototype.getParameters=function(){const i=e.apply(this,arguments);return"encodings"in i||(i.encodings=[].concat(this.sendEncodings||[{}])),i})}function qTe(t){if(!(typeof t=="object"&&t.RTCPeerConnection))return;const e=t.RTCPeerConnection.prototype.createOffer;t.RTCPeerConnection.prototype.createOffer=function(){return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then(()=>e.apply(this,arguments)).finally(()=>{this.setParametersPromises=[]}):e.apply(this,arguments)}}function $Te(t){if(!(typeof t=="object"&&t.RTCPeerConnection))return;const e=t.RTCPeerConnection.prototype.createAnswer;t.RTCPeerConnection.prototype.createAnswer=function(){return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then(()=>e.apply(this,arguments)).finally(()=>{this.setParametersPromises=[]}):e.apply(this,arguments)}}const Uoe=Object.freeze(Object.defineProperty({__proto__:null,shimAddTransceiver:VTe,shimCreateAnswer:$Te,shimCreateOffer:qTe,shimGetDisplayMedia:lRt,shimGetParameters:GTe,shimGetUserMedia:UTe,shimOnTrack:BTe,shimPeerConnection:d7,shimRTCDataChannel:HTe,shimReceiverGetStats:zTe,shimRemoveStream:jTe,shimSenderGetStats:FTe},Symbol.toStringTag,{value:"Module"}));function WTe(t){if(!(typeof t!="object"||!t.RTCPeerConnection)){if("getLocalStreams"in t.RTCPeerConnection.prototype||(t.RTCPeerConnection.prototype.getLocalStreams=function(){return this._localStreams||(this._localStreams=[]),this._localStreams}),!("addStream"in t.RTCPeerConnection.prototype)){const e=t.RTCPeerConnection.prototype.addTrack;t.RTCPeerConnection.prototype.addStream=function(i){this._localStreams||(this._localStreams=[]),this._localStreams.includes(i)||this._localStreams.push(i),i.getAudioTracks().forEach(r=>e.call(this,r,i)),i.getVideoTracks().forEach(r=>e.call(this,r,i))},t.RTCPeerConnection.prototype.addTrack=function(i,...r){return r&&r.forEach(s=>{this._localStreams?this._localStreams.includes(s)||this._localStreams.push(s):this._localStreams=[s]}),e.apply(this,arguments)}}"removeStream"in t.RTCPeerConnection.prototype||(t.RTCPeerConnection.prototype.removeStream=function(n){this._localStreams||(this._localStreams=[]);const i=this._localStreams.indexOf(n);if(i===-1)return;this._localStreams.splice(i,1);const r=n.getTracks();this.getSenders().forEach(s=>{r.includes(s.track)&&this.removeTrack(s)})})}}function YTe(t){if(!(typeof t!="object"||!t.RTCPeerConnection)&&("getRemoteStreams"in t.RTCPeerConnection.prototype||(t.RTCPeerConnection.prototype.getRemoteStreams=function(){return this._remoteStreams?this._remoteStreams:[]}),!("onaddstream"in t.RTCPeerConnection.prototype))){Object.defineProperty(t.RTCPeerConnection.prototype,"onaddstream",{get(){return this._onaddstream},set(n){this._onaddstream&&(this.removeEventListener("addstream",this._onaddstream),this.removeEventListener("track",this._onaddstreampoly)),this.addEventListener("addstream",this._onaddstream=n),this.addEventListener("track",this._onaddstreampoly=i=>{i.streams.forEach(r=>{if(this._remoteStreams||(this._remoteStreams=[]),this._remoteStreams.includes(r))return;this._remoteStreams.push(r);const s=new Event("addstream");s.stream=r,this.dispatchEvent(s)})})}});const e=t.RTCPeerConnection.prototype.setRemoteDescription;t.RTCPeerConnection.prototype.setRemoteDescription=function(){const i=this;return this._onaddstreampoly||this.addEventListener("track",this._onaddstreampoly=function(r){r.streams.forEach(s=>{if(i._remoteStreams||(i._remoteStreams=[]),i._remoteStreams.indexOf(s)>=0)return;i._remoteStreams.push(s);const a=new Event("addstream");a.stream=s,i.dispatchEvent(a)})}),e.apply(i,arguments)}}}function KTe(t){if(typeof t!="object"||!t.RTCPeerConnection)return;const e=t.RTCPeerConnection.prototype,n=e.createOffer,i=e.createAnswer,r=e.setLocalDescription,s=e.setRemoteDescription,a=e.addIceCandidate;e.createOffer=function(l,u){const h=arguments.length>=2?arguments[2]:arguments[0],d=n.apply(this,[h]);return u?(d.then(l,u),Promise.resolve()):d},e.createAnswer=function(l,u){const h=arguments.length>=2?arguments[2]:arguments[0],d=i.apply(this,[h]);return u?(d.then(l,u),Promise.resolve()):d};let o=function(c,l,u){const h=r.apply(this,[c]);return u?(h.then(l,u),Promise.resolve()):h};e.setLocalDescription=o,o=function(c,l,u){const h=s.apply(this,[c]);return u?(h.then(l,u),Promise.resolve()):h},e.setRemoteDescription=o,o=function(c,l,u){const h=a.apply(this,[c]);return u?(h.then(l,u),Promise.resolve()):h},e.addIceCandidate=o}function XTe(t){const e=t&&t.navigator;if(e.mediaDevices&&e.mediaDevices.getUserMedia){const n=e.mediaDevices,i=n.getUserMedia.bind(n);e.mediaDevices.getUserMedia=r=>i(ZTe(r))}!e.getUserMedia&&e.mediaDevices&&e.mediaDevices.getUserMedia&&(e.getUserMedia=(function(i,r,s){e.mediaDevices.getUserMedia(i).then(r,s)}).bind(e))}function ZTe(t){return t&&t.video!==void 0?Object.assign({},t,{video:RTe(t.video)}):t}function JTe(t){if(!t.RTCPeerConnection)return;const e=t.RTCPeerConnection;t.RTCPeerConnection=function(i,r){if(i&&i.iceServers){const s=[];for(let a=0;a<i.iceServers.length;a++){let o=i.iceServers[a];o.urls===void 0&&o.url?(SZ("RTCIceServer.url","RTCIceServer.urls"),o=JSON.parse(JSON.stringify(o)),o.urls=o.url,delete o.url,s.push(o)):s.push(i.iceServers[a])}i.iceServers=s}return new e(i,r)},t.RTCPeerConnection.prototype=e.prototype,"generateCertificate"in e&&Object.defineProperty(t.RTCPeerConnection,"generateCertificate",{get(){return e.generateCertificate}})}function QTe(t){typeof t=="object"&&t.RTCTrackEvent&&"receiver"in t.RTCTrackEvent.prototype&&!("transceiver"in t.RTCTrackEvent.prototype)&&Object.defineProperty(t.RTCTrackEvent.prototype,"transceiver",{get(){return{receiver:this.receiver}}})}function e1e(t){const e=t.RTCPeerConnection.prototype.createOffer;t.RTCPeerConnection.prototype.createOffer=function(i){if(i){typeof i.offerToReceiveAudio<"u"&&(i.offerToReceiveAudio=!!i.offerToReceiveAudio);const r=this.getTransceivers().find(a=>a.receiver.track.kind==="audio");i.offerToReceiveAudio===!1&&r?r.direction==="sendrecv"?r.setDirection?r.setDirection("sendonly"):r.direction="sendonly":r.direction==="recvonly"&&(r.setDirection?r.setDirection("inactive"):r.direction="inactive"):i.offerToReceiveAudio===!0&&!r&&this.addTransceiver("audio",{direction:"recvonly"}),typeof i.offerToReceiveVideo<"u"&&(i.offerToReceiveVideo=!!i.offerToReceiveVideo);const s=this.getTransceivers().find(a=>a.receiver.track.kind==="video");i.offerToReceiveVideo===!1&&s?s.direction==="sendrecv"?s.setDirection?s.setDirection("sendonly"):s.direction="sendonly":s.direction==="recvonly"&&(s.setDirection?s.setDirection("inactive"):s.direction="inactive"):i.offerToReceiveVideo===!0&&!s&&this.addTransceiver("video",{direction:"recvonly"})}return e.apply(this,arguments)}}function t1e(t){typeof t!="object"||t.AudioContext||(t.AudioContext=t.webkitAudioContext)}const Boe=Object.freeze(Object.defineProperty({__proto__:null,shimAudioContext:t1e,shimCallbacksAPI:KTe,shimConstraints:ZTe,shimCreateOfferLegacy:e1e,shimGetUserMedia:XTe,shimLocalStreamsAPI:WTe,shimRTCIceServerUrls:JTe,shimRemoteStreamsAPI:YTe,shimTrackEventTransceiver:QTe},Symbol.toStringTag,{value:"Module"}));var n1e={exports:{}};(function(t){const e={};e.generateIdentifier=function(){return Math.random().toString(36).substring(2,12)},e.localCName=e.generateIdentifier(),e.splitLines=function(n){return n.trim().split(`
`).map(i=>i.trim())},e.splitSections=function(n){return n.split(`
m=`).map((r,s)=>(s>0?"m="+r:r).trim()+`\r
`)},e.getDescription=function(n){const i=e.splitSections(n);return i&&i[0]},e.getMediaSections=function(n){const i=e.splitSections(n);return i.shift(),i},e.matchPrefix=function(n,i){return e.splitLines(n).filter(r=>r.indexOf(i)===0)},e.parseCandidate=function(n){let i;n.indexOf("a=candidate:")===0?i=n.substring(12).split(" "):i=n.substring(10).split(" ");const r={foundation:i[0],component:{1:"rtp",2:"rtcp"}[i[1]]||i[1],protocol:i[2].toLowerCase(),priority:parseInt(i[3],10),ip:i[4],address:i[4],port:parseInt(i[5],10),type:i[7]};for(let s=8;s<i.length;s+=2)switch(i[s]){case"raddr":r.relatedAddress=i[s+1];break;case"rport":r.relatedPort=parseInt(i[s+1],10);break;case"tcptype":r.tcpType=i[s+1];break;case"ufrag":r.ufrag=i[s+1],r.usernameFragment=i[s+1];break;default:r[i[s]]===void 0&&(r[i[s]]=i[s+1]);break}return r},e.writeCandidate=function(n){const i=[];i.push(n.foundation);const r=n.component;r==="rtp"?i.push(1):r==="rtcp"?i.push(2):i.push(r),i.push(n.protocol.toUpperCase()),i.push(n.priority),i.push(n.address||n.ip),i.push(n.port);const s=n.type;return i.push("typ"),i.push(s),s!=="host"&&n.relatedAddress&&n.relatedPort&&(i.push("raddr"),i.push(n.relatedAddress),i.push("rport"),i.push(n.relatedPort)),n.tcpType&&n.protocol.toLowerCase()==="tcp"&&(i.push("tcptype"),i.push(n.tcpType)),(n.usernameFragment||n.ufrag)&&(i.push("ufrag"),i.push(n.usernameFragment||n.ufrag)),"candidate:"+i.join(" ")},e.parseIceOptions=function(n){return n.substring(14).split(" ")},e.parseRtpMap=function(n){let i=n.substring(9).split(" ");const r={payloadType:parseInt(i.shift(),10)};return i=i[0].split("/"),r.name=i[0],r.clockRate=parseInt(i[1],10),r.channels=i.length===3?parseInt(i[2],10):1,r.numChannels=r.channels,r},e.writeRtpMap=function(n){let i=n.payloadType;n.preferredPayloadType!==void 0&&(i=n.preferredPayloadType);const r=n.channels||n.numChannels||1;return"a=rtpmap:"+i+" "+n.name+"/"+n.clockRate+(r!==1?"/"+r:"")+`\r
`},e.parseExtmap=function(n){const i=n.substring(9).split(" ");return{id:parseInt(i[0],10),direction:i[0].indexOf("/")>0?i[0].split("/")[1]:"sendrecv",uri:i[1],attributes:i.slice(2).join(" ")}},e.writeExtmap=function(n){return"a=extmap:"+(n.id||n.preferredId)+(n.direction&&n.direction!=="sendrecv"?"/"+n.direction:"")+" "+n.uri+(n.attributes?" "+n.attributes:"")+`\r
`},e.parseFmtp=function(n){const i={};let r;const s=n.substring(n.indexOf(" ")+1).split(";");for(let a=0;a<s.length;a++)r=s[a].trim().split("="),i[r[0].trim()]=r[1];return i},e.writeFmtp=function(n){let i="",r=n.payloadType;if(n.preferredPayloadType!==void 0&&(r=n.preferredPayloadType),n.parameters&&Object.keys(n.parameters).length){const s=[];Object.keys(n.parameters).forEach(a=>{n.parameters[a]!==void 0?s.push(a+"="+n.parameters[a]):s.push(a)}),i+="a=fmtp:"+r+" "+s.join(";")+`\r
`}return i},e.parseRtcpFb=function(n){const i=n.substring(n.indexOf(" ")+1).split(" ");return{type:i.shift(),parameter:i.join(" ")}},e.writeRtcpFb=function(n){let i="",r=n.payloadType;return n.preferredPayloadType!==void 0&&(r=n.preferredPayloadType),n.rtcpFeedback&&n.rtcpFeedback.length&&n.rtcpFeedback.forEach(s=>{i+="a=rtcp-fb:"+r+" "+s.type+(s.parameter&&s.parameter.length?" "+s.parameter:"")+`\r
`}),i},e.parseSsrcMedia=function(n){const i=n.indexOf(" "),r={ssrc:parseInt(n.substring(7,i),10)},s=n.indexOf(":",i);return s>-1?(r.attribute=n.substring(i+1,s),r.value=n.substring(s+1)):r.attribute=n.substring(i+1),r},e.parseSsrcGroup=function(n){const i=n.substring(13).split(" ");return{semantics:i.shift(),ssrcs:i.map(r=>parseInt(r,10))}},e.getMid=function(n){const i=e.matchPrefix(n,"a=mid:")[0];if(i)return i.substring(6)},e.parseFingerprint=function(n){const i=n.substring(14).split(" ");return{algorithm:i[0].toLowerCase(),value:i[1].toUpperCase()}},e.getDtlsParameters=function(n,i){return{role:"auto",fingerprints:e.matchPrefix(n+i,"a=fingerprint:").map(e.parseFingerprint)}},e.writeDtlsParameters=function(n,i){let r="a=setup:"+i+`\r
`;return n.fingerprints.forEach(s=>{r+="a=fingerprint:"+s.algorithm+" "+s.value+`\r
`}),r},e.parseCryptoLine=function(n){const i=n.substring(9).split(" ");return{tag:parseInt(i[0],10),cryptoSuite:i[1],keyParams:i[2],sessionParams:i.slice(3)}},e.writeCryptoLine=function(n){return"a=crypto:"+n.tag+" "+n.cryptoSuite+" "+(typeof n.keyParams=="object"?e.writeCryptoKeyParams(n.keyParams):n.keyParams)+(n.sessionParams?" "+n.sessionParams.join(" "):"")+`\r
`},e.parseCryptoKeyParams=function(n){if(n.indexOf("inline:")!==0)return null;const i=n.substring(7).split("|");return{keyMethod:"inline",keySalt:i[0],lifeTime:i[1],mkiValue:i[2]?i[2].split(":")[0]:void 0,mkiLength:i[2]?i[2].split(":")[1]:void 0}},e.writeCryptoKeyParams=function(n){return n.keyMethod+":"+n.keySalt+(n.lifeTime?"|"+n.lifeTime:"")+(n.mkiValue&&n.mkiLength?"|"+n.mkiValue+":"+n.mkiLength:"")},e.getCryptoParameters=function(n,i){return e.matchPrefix(n+i,"a=crypto:").map(e.parseCryptoLine)},e.getIceParameters=function(n,i){const r=e.matchPrefix(n+i,"a=ice-ufrag:")[0],s=e.matchPrefix(n+i,"a=ice-pwd:")[0];return r&&s?{usernameFragment:r.substring(12),password:s.substring(10)}:null},e.writeIceParameters=function(n){let i="a=ice-ufrag:"+n.usernameFragment+`\r
a=ice-pwd:`+n.password+`\r
`;return n.iceLite&&(i+=`a=ice-lite\r
`),i},e.parseRtpParameters=function(n){const i={codecs:[],headerExtensions:[],fecMechanisms:[],rtcp:[]},s=e.splitLines(n)[0].split(" ");i.profile=s[2];for(let o=3;o<s.length;o++){const c=s[o],l=e.matchPrefix(n,"a=rtpmap:"+c+" ")[0];if(l){const u=e.parseRtpMap(l),h=e.matchPrefix(n,"a=fmtp:"+c+" ");switch(u.parameters=h.length?e.parseFmtp(h[0]):{},u.rtcpFeedback=e.matchPrefix(n,"a=rtcp-fb:"+c+" ").map(e.parseRtcpFb),i.codecs.push(u),u.name.toUpperCase()){case"RED":case"ULPFEC":i.fecMechanisms.push(u.name.toUpperCase());break}}}e.matchPrefix(n,"a=extmap:").forEach(o=>{i.headerExtensions.push(e.parseExtmap(o))});const a=e.matchPrefix(n,"a=rtcp-fb:* ").map(e.parseRtcpFb);return i.codecs.forEach(o=>{a.forEach(c=>{o.rtcpFeedback.find(u=>u.type===c.type&&u.parameter===c.parameter)||o.rtcpFeedback.push(c)})}),i},e.writeRtpDescription=function(n,i){let r="";r+="m="+n+" ",r+=i.codecs.length>0?"9":"0",r+=" "+(i.profile||"UDP/TLS/RTP/SAVPF")+" ",r+=i.codecs.map(a=>a.preferredPayloadType!==void 0?a.preferredPayloadType:a.payloadType).join(" ")+`\r
`,r+=`c=IN IP4 0.0.0.0\r
`,r+=`a=rtcp:9 IN IP4 0.0.0.0\r
`,i.codecs.forEach(a=>{r+=e.writeRtpMap(a),r+=e.writeFmtp(a),r+=e.writeRtcpFb(a)});let s=0;return i.codecs.forEach(a=>{a.maxptime>s&&(s=a.maxptime)}),s>0&&(r+="a=maxptime:"+s+`\r
`),i.headerExtensions&&i.headerExtensions.forEach(a=>{r+=e.writeExtmap(a)}),r},e.parseRtpEncodingParameters=function(n){const i=[],r=e.parseRtpParameters(n),s=r.fecMechanisms.indexOf("RED")!==-1,a=r.fecMechanisms.indexOf("ULPFEC")!==-1,o=e.matchPrefix(n,"a=ssrc:").map(d=>e.parseSsrcMedia(d)).filter(d=>d.attribute==="cname"),c=o.length>0&&o[0].ssrc;let l;const u=e.matchPrefix(n,"a=ssrc-group:FID").map(d=>d.substring(17).split(" ").map(p=>parseInt(p,10)));u.length>0&&u[0].length>1&&u[0][0]===c&&(l=u[0][1]),r.codecs.forEach(d=>{if(d.name.toUpperCase()==="RTX"&&d.parameters.apt){let f={ssrc:c,codecPayloadType:parseInt(d.parameters.apt,10)};c&&l&&(f.rtx={ssrc:l}),i.push(f),s&&(f=JSON.parse(JSON.stringify(f)),f.fec={ssrc:c,mechanism:a?"red+ulpfec":"red"},i.push(f))}}),i.length===0&&c&&i.push({ssrc:c});let h=e.matchPrefix(n,"b=");return h.length&&(h[0].indexOf("b=TIAS:")===0?h=parseInt(h[0].substring(7),10):h[0].indexOf("b=AS:")===0?h=parseInt(h[0].substring(5),10)*1e3*.95-50*40*8:h=void 0,i.forEach(d=>{d.maxBitrate=h})),i},e.parseRtcpParameters=function(n){const i={},r=e.matchPrefix(n,"a=ssrc:").map(o=>e.parseSsrcMedia(o)).filter(o=>o.attribute==="cname")[0];r&&(i.cname=r.value,i.ssrc=r.ssrc);const s=e.matchPrefix(n,"a=rtcp-rsize");i.reducedSize=s.length>0,i.compound=s.length===0;const a=e.matchPrefix(n,"a=rtcp-mux");return i.mux=a.length>0,i},e.writeRtcpParameters=function(n){let i="";return n.reducedSize&&(i+=`a=rtcp-rsize\r
`),n.mux&&(i+=`a=rtcp-mux\r
`),n.ssrc!==void 0&&n.cname&&(i+="a=ssrc:"+n.ssrc+" cname:"+n.cname+`\r
`),i},e.parseMsid=function(n){let i;const r=e.matchPrefix(n,"a=msid:");if(r.length===1)return i=r[0].substring(7).split(" "),{stream:i[0],track:i[1]};const s=e.matchPrefix(n,"a=ssrc:").map(a=>e.parseSsrcMedia(a)).filter(a=>a.attribute==="msid");if(s.length>0)return i=s[0].value.split(" "),{stream:i[0],track:i[1]}},e.parseSctpDescription=function(n){const i=e.parseMLine(n),r=e.matchPrefix(n,"a=max-message-size:");let s;r.length>0&&(s=parseInt(r[0].substring(19),10)),isNaN(s)&&(s=65536);const a=e.matchPrefix(n,"a=sctp-port:");if(a.length>0)return{port:parseInt(a[0].substring(12),10),protocol:i.fmt,maxMessageSize:s};const o=e.matchPrefix(n,"a=sctpmap:");if(o.length>0){const c=o[0].substring(10).split(" ");return{port:parseInt(c[0],10),protocol:c[1],maxMessageSize:s}}},e.writeSctpDescription=function(n,i){let r=[];return n.protocol!=="DTLS/SCTP"?r=["m="+n.kind+" 9 "+n.protocol+" "+i.protocol+`\r
`,`c=IN IP4 0.0.0.0\r
`,"a=sctp-port:"+i.port+`\r
`]:r=["m="+n.kind+" 9 "+n.protocol+" "+i.port+`\r
`,`c=IN IP4 0.0.0.0\r
`,"a=sctpmap:"+i.port+" "+i.protocol+` 65535\r
`],i.maxMessageSize!==void 0&&r.push("a=max-message-size:"+i.maxMessageSize+`\r
`),r.join("")},e.generateSessionId=function(){return Math.random().toString().substr(2,22)},e.writeSessionBoilerplate=function(n,i,r){let s;const a=i!==void 0?i:2;return n?s=n:s=e.generateSessionId(),`v=0\r
o=`+(r||"thisisadapterortc")+" "+s+" "+a+` IN IP4 127.0.0.1\r
s=-\r
t=0 0\r
`},e.getDirection=function(n,i){const r=e.splitLines(n);for(let s=0;s<r.length;s++)switch(r[s]){case"a=sendrecv":case"a=sendonly":case"a=recvonly":case"a=inactive":return r[s].substring(2)}return i?e.getDirection(i):"sendrecv"},e.getKind=function(n){return e.splitLines(n)[0].split(" ")[0].substring(2)},e.isRejected=function(n){return n.split(" ",2)[1]==="0"},e.parseMLine=function(n){const r=e.splitLines(n)[0].substring(2).split(" ");return{kind:r[0],port:parseInt(r[1],10),protocol:r[2],fmt:r.slice(3).join(" ")}},e.parseOLine=function(n){const r=e.matchPrefix(n,"o=")[0].substring(2).split(" ");return{username:r[0],sessionId:r[1],sessionVersion:parseInt(r[2],10),netType:r[3],addressType:r[4],address:r[5]}},e.isValidSDP=function(n){if(typeof n!="string"||n.length===0)return!1;const i=e.splitLines(n);for(let r=0;r<i.length;r++)if(i[r].length<2||i[r].charAt(1)!=="=")return!1;return!0},t.exports=e})(n1e);var i1e=n1e.exports;const IC=il(i1e),uRt=Jwe({__proto__:null,default:IC},[i1e]);function ML(t){if(!t.RTCIceCandidate||t.RTCIceCandidate&&"foundation"in t.RTCIceCandidate.prototype)return;const e=t.RTCIceCandidate;t.RTCIceCandidate=function(i){if(typeof i=="object"&&i.candidate&&i.candidate.indexOf("a=")===0&&(i=JSON.parse(JSON.stringify(i)),i.candidate=i.candidate.substring(2)),i.candidate&&i.candidate.length){const r=new e(i),s=IC.parseCandidate(i.candidate);for(const a in s)a in r||Object.defineProperty(r,a,{value:s[a]});return r.toJSON=function(){return{candidate:r.candidate,sdpMid:r.sdpMid,sdpMLineIndex:r.sdpMLineIndex,usernameFragment:r.usernameFragment}},r}return new e(i)},t.RTCIceCandidate.prototype=e.prototype,ax(t,"icecandidate",n=>(n.candidate&&Object.defineProperty(n,"candidate",{value:new t.RTCIceCandidate(n.candidate),writable:"false"}),n))}function f7(t){!t.RTCIceCandidate||t.RTCIceCandidate&&"relayProtocol"in t.RTCIceCandidate.prototype||ax(t,"icecandidate",e=>{if(e.candidate){const n=IC.parseCandidate(e.candidate.candidate);n.type==="relay"&&(e.candidate.relayProtocol={0:"tls",1:"tcp",2:"udp"}[n.priority>>24])}return e})}function OL(t,e){if(!t.RTCPeerConnection)return;"sctp"in t.RTCPeerConnection.prototype||Object.defineProperty(t.RTCPeerConnection.prototype,"sctp",{get(){return typeof this._sctp>"u"?null:this._sctp}});const n=function(o){if(!o||!o.sdp)return!1;const c=IC.splitSections(o.sdp);return c.shift(),c.some(l=>{const u=IC.parseMLine(l);return u&&u.kind==="application"&&u.protocol.indexOf("SCTP")!==-1})},i=function(o){const c=o.sdp.match(/mozilla...THIS_IS_SDPARTA-(\d+)/);if(c===null||c.length<2)return-1;const l=parseInt(c[1],10);return l!==l?-1:l},r=function(o){let c=65536;return e.browser==="firefox"&&(e.version<57?o===-1?c=16384:c=2147483637:e.version<60?c=e.version===57?65535:65536:c=2147483637),c},s=function(o,c){let l=65536;e.browser==="firefox"&&e.version===57&&(l=65535);const u=IC.matchPrefix(o.sdp,"a=max-message-size:");return u.length>0?l=parseInt(u[0].substring(19),10):e.browser==="firefox"&&c!==-1&&(l=2147483637),l},a=t.RTCPeerConnection.prototype.setRemoteDescription;t.RTCPeerConnection.prototype.setRemoteDescription=function(){if(this._sctp=null,e.browser==="chrome"&&e.version>=76){const{sdpSemantics:c}=this.getConfiguration();c==="plan-b"&&Object.defineProperty(this,"sctp",{get(){return typeof this._sctp>"u"?null:this._sctp},enumerable:!0,configurable:!0})}if(n(arguments[0])){const c=i(arguments[0]),l=r(c),u=s(arguments[0],c);let h;l===0&&u===0?h=Number.POSITIVE_INFINITY:l===0||u===0?h=Math.max(l,u):h=Math.min(l,u);const d={};Object.defineProperty(d,"maxMessageSize",{get(){return h}}),this._sctp=d}return a.apply(this,arguments)}}function NL(t){if(!(t.RTCPeerConnection&&"createDataChannel"in t.RTCPeerConnection.prototype))return;function e(i,r){const s=i.send;i.send=function(){const o=arguments[0],c=o.length||o.size||o.byteLength;if(i.readyState==="open"&&r.sctp&&c>r.sctp.maxMessageSize)throw new TypeError("Message too large (can send a maximum of "+r.sctp.maxMessageSize+" bytes)");return s.apply(i,arguments)}}const n=t.RTCPeerConnection.prototype.createDataChannel;t.RTCPeerConnection.prototype.createDataChannel=function(){const r=n.apply(this,arguments);return e(r,this),r},ax(t,"datachannel",i=>(e(i.channel,i.target),i))}function p7(t){if(!t.RTCPeerConnection||"connectionState"in t.RTCPeerConnection.prototype)return;const e=t.RTCPeerConnection.prototype;Object.defineProperty(e,"connectionState",{get(){return{completed:"connected",checking:"connecting"}[this.iceConnectionState]||this.iceConnectionState},enumerable:!0,configurable:!0}),Object.defineProperty(e,"onconnectionstatechange",{get(){return this._onconnectionstatechange||null},set(n){this._onconnectionstatechange&&(this.removeEventListener("connectionstatechange",this._onconnectionstatechange),delete this._onconnectionstatechange),n&&this.addEventListener("connectionstatechange",this._onconnectionstatechange=n)},enumerable:!0,configurable:!0}),["setLocalDescription","setRemoteDescription"].forEach(n=>{const i=e[n];e[n]=function(){return this._connectionstatechangepoly||(this._connectionstatechangepoly=r=>{const s=r.target;if(s._lastConnectionState!==s.connectionState){s._lastConnectionState=s.connectionState;const a=new Event("connectionstatechange",r);s.dispatchEvent(a)}return r},this.addEventListener("iceconnectionstatechange",this._connectionstatechangepoly)),i.apply(this,arguments)}})}function m7(t,e){if(!t.RTCPeerConnection||e.browser==="chrome"&&e.version>=71||e.browser==="safari"&&e.version>=605)return;const n=t.RTCPeerConnection.prototype.setRemoteDescription;t.RTCPeerConnection.prototype.setRemoteDescription=function(r){if(r&&r.sdp&&r.sdp.indexOf(`
a=extmap-allow-mixed`)!==-1){const s=r.sdp.split(`
`).filter(a=>a.trim()!=="a=extmap-allow-mixed").join(`
`);t.RTCSessionDescription&&r instanceof t.RTCSessionDescription?arguments[0]=new t.RTCSessionDescription({type:r.type,sdp:s}):r.sdp=s}return n.apply(this,arguments)}}function IL(t,e){if(!(t.RTCPeerConnection&&t.RTCPeerConnection.prototype))return;const n=t.RTCPeerConnection.prototype.addIceCandidate;!n||n.length===0||(t.RTCPeerConnection.prototype.addIceCandidate=function(){return arguments[0]?(e.browser==="chrome"&&e.version<78||e.browser==="firefox"&&e.version<68||e.browser==="safari")&&arguments[0]&&arguments[0].candidate===""?Promise.resolve():n.apply(this,arguments):(arguments[1]&&arguments[1].apply(null),Promise.resolve())})}function kL(t,e){if(!(t.RTCPeerConnection&&t.RTCPeerConnection.prototype))return;const n=t.RTCPeerConnection.prototype.setLocalDescription;!n||n.length===0||(t.RTCPeerConnection.prototype.setLocalDescription=function(){let r=arguments[0]||{};if(typeof r!="object"||r.type&&r.sdp)return n.apply(this,arguments);if(r={type:r.type,sdp:r.sdp},!r.type)switch(this.signalingState){case"stable":case"have-local-offer":case"have-remote-pranswer":r.type="offer";break;default:r.type="answer";break}return r.sdp||r.type!=="offer"&&r.type!=="answer"?n.apply(this,[r]):(r.type==="offer"?this.createOffer:this.createAnswer).apply(this).then(a=>n.apply(this,[a]))})}const hRt=Object.freeze(Object.defineProperty({__proto__:null,removeExtmapAllowMixed:m7,shimAddIceCandidateNullOrEmpty:IL,shimConnectionState:p7,shimMaxMessageSize:OL,shimParameterlessSetLocalDescription:kL,shimRTCIceCandidate:ML,shimRTCIceCandidateRelayProtocol:f7,shimSendThrowTypeError:NL},Symbol.toStringTag,{value:"Module"}));function dRt({window:t}={},e={shimChrome:!0,shimFirefox:!0,shimSafari:!0}){const n=ATe,i=cRt(t),r={browserDetails:i,commonShim:hRt,extractVersion:RL,disableLog:aRt,disableWarnings:oRt,sdp:uRt};switch(i.browser){case"chrome":if(!Loe||!h7||!e.shimChrome)return n("Chrome shim is not included in this adapter release."),r;if(i.version===null)return n("Chrome shim can not determine version, not shimming."),r;n("adapter.js shimming chrome."),r.browserShim=Loe,IL(t,i),kL(t),MTe(t,i),OTe(t),h7(t,i),NTe(t),DTe(t,i),ITe(t),kTe(t),LTe(t,i),ML(t),f7(t),p7(t),OL(t,i),NL(t),m7(t,i);break;case"firefox":if(!Uoe||!d7||!e.shimFirefox)return n("Firefox shim is not included in this adapter release."),r;n("adapter.js shimming firefox."),r.browserShim=Uoe,IL(t,i),kL(t),UTe(t,i),d7(t,i),BTe(t),jTe(t),FTe(t),zTe(t),HTe(t),VTe(t),GTe(t),qTe(t),$Te(t),ML(t),p7(t),OL(t,i),NL(t);break;case"safari":if(!Boe||!e.shimSafari)return n("Safari shim is not included in this adapter release."),r;n("adapter.js shimming safari."),r.browserShim=Boe,IL(t,i),kL(t),JTe(t),e1e(t),KTe(t),WTe(t),YTe(t),QTe(t),XTe(t),t1e(t),ML(t),f7(t),OL(t,i),NL(t),m7(t,i);break;default:n("Unsupported browser!");break}return r}const Foe=dRt({window:typeof window>"u"?void 0:window});function ox(t,e,n,i){Object.defineProperty(t,e,{get:n,set:i,enumerable:!0,configurable:!0})}class r1e{constructor(){this.chunkedMTU=16300,this._dataCount=1,this.chunk=e=>{const n=[],i=e.byteLength,r=Math.ceil(i/this.chunkedMTU);let s=0,a=0;for(;a<i;){const o=Math.min(i,a+this.chunkedMTU),c=e.slice(a,o),l={__peerData:this._dataCount,n:s,data:c,total:r};n.push(l),a=o,s++}return this._dataCount++,n}}}function fRt(t){let e=0;for(const r of t)e+=r.byteLength;const n=new Uint8Array(e);let i=0;for(const r of t)n.set(r,i),i+=r.byteLength;return n}const EV=Foe.default||Foe,MM=new class{isWebRTCSupported(){return typeof RTCPeerConnection<"u"}isBrowserSupported(){const t=this.getBrowser(),e=this.getVersion();return this.supportedBrowsers.includes(t)?t==="chrome"?e>=this.minChromeVersion:t==="firefox"?e>=this.minFirefoxVersion:t==="safari"?!this.isIOS&&e>=this.minSafariVersion:!1:!1}getBrowser(){return EV.browserDetails.browser}getVersion(){return EV.browserDetails.version||0}isUnifiedPlanSupported(){const t=this.getBrowser(),e=EV.browserDetails.version||0;if(t==="chrome"&&e<this.minChromeVersion)return!1;if(t==="firefox"&&e>=this.minFirefoxVersion)return!0;if(!window.RTCRtpTransceiver||!("currentDirection"in RTCRtpTransceiver.prototype))return!1;let n,i=!1;try{n=new RTCPeerConnection,n.addTransceiver("audio"),i=!0}catch{}finally{n&&n.close()}return i}toString(){return`Supports:
    browser:${this.getBrowser()}
    version:${this.getVersion()}
    isIOS:${this.isIOS}
    isWebRTCSupported:${this.isWebRTCSupported()}
    isBrowserSupported:${this.isBrowserSupported()}
    isUnifiedPlanSupported:${this.isUnifiedPlanSupported()}`}constructor(){this.isIOS=typeof navigator<"u"?["iPad","iPhone","iPod"].includes(navigator.platform):!1,this.supportedBrowsers=["firefox","chrome","safari"],this.minFirefoxVersion=59,this.minChromeVersion=72,this.minSafariVersion=605}},pRt=t=>!t||/^[A-Za-z0-9]+(?:[ _-][A-Za-z0-9]+)*$/.test(t),s1e=()=>Math.random().toString(36).slice(2),zoe={iceServers:[{urls:"stun:stun.l.google.com:19302"},{urls:["turn:eu-0.turn.peerjs.com:3478","turn:us-0.turn.peerjs.com:3478"],username:"peerjs",credential:"peerjsp"}],sdpSemantics:"unified-plan"};class mRt extends r1e{noop(){}blobToArrayBuffer(e,n){const i=new FileReader;return i.onload=function(r){r.target&&n(r.target.result)},i.readAsArrayBuffer(e),i}binaryStringToArrayBuffer(e){const n=new Uint8Array(e.length);for(let i=0;i<e.length;i++)n[i]=e.charCodeAt(i)&255;return n.buffer}isSecure(){return location.protocol==="https:"}constructor(...e){super(...e),this.CLOUD_HOST="0.peerjs.com",this.CLOUD_PORT=443,this.chunkedBrowsers={Chrome:1,chrome:1},this.defaultConfig=zoe,this.browser=MM.getBrowser(),this.browserVersion=MM.getVersion(),this.pack=xTe,this.unpack=TTe,this.supports=function(){const n={browser:MM.isBrowserSupported(),webRTC:MM.isWebRTCSupported(),audioVideo:!1,data:!1,binaryBlob:!1,reliable:!1};if(!n.webRTC)return n;let i;try{i=new RTCPeerConnection(zoe),n.audioVideo=!0;let r;try{r=i.createDataChannel("_PEERJSTEST",{ordered:!0}),n.data=!0,n.reliable=!!r.ordered;try{r.binaryType="blob",n.binaryBlob=!MM.isIOS}catch{}}catch{}finally{r&&r.close()}}catch{}finally{i&&i.close()}return n}(),this.validateId=pRt,this.randomToken=s1e}}const Yh=new mRt,gRt="PeerJS: ";var joe;(function(t){t[t.Disabled=0]="Disabled",t[t.Errors=1]="Errors",t[t.Warnings=2]="Warnings",t[t.All=3]="All"})(joe||(joe={}));class vRt{get logLevel(){return this._logLevel}set logLevel(e){this._logLevel=e}log(...e){this._logLevel>=3&&this._print(3,...e)}warn(...e){this._logLevel>=2&&this._print(2,...e)}error(...e){this._logLevel>=1&&this._print(1,...e)}setLogFunction(e){this._print=e}_print(e,...n){const i=[gRt,...n];for(const r in i)i[r]instanceof Error&&(i[r]="("+i[r].name+") "+i[r].message);e>=3?console.log(...i):e>=2?console.warn("WARNING",...i):e>=1&&console.error("ERROR",...i)}constructor(){this._logLevel=0}}var $n=new vRt,TZ={},_Rt=Object.prototype.hasOwnProperty,_h="~";function _I(){}Object.create&&(_I.prototype=Object.create(null),new _I().__proto__||(_h=!1));function yRt(t,e,n){this.fn=t,this.context=e,this.once=n||!1}function a1e(t,e,n,i,r){if(typeof n!="function")throw new TypeError("The listener must be a function");var s=new yRt(n,i||t,r),a=_h?_h+e:e;return t._events[a]?t._events[a].fn?t._events[a]=[t._events[a],s]:t._events[a].push(s):(t._events[a]=s,t._eventsCount++),t}function PL(t,e){--t._eventsCount===0?t._events=new _I:delete t._events[e]}function Ru(){this._events=new _I,this._eventsCount=0}Ru.prototype.eventNames=function(){var e=[],n,i;if(this._eventsCount===0)return e;for(i in n=this._events)_Rt.call(n,i)&&e.push(_h?i.slice(1):i);return Object.getOwnPropertySymbols?e.concat(Object.getOwnPropertySymbols(n)):e};Ru.prototype.listeners=function(e){var n=_h?_h+e:e,i=this._events[n];if(!i)return[];if(i.fn)return[i.fn];for(var r=0,s=i.length,a=new Array(s);r<s;r++)a[r]=i[r].fn;return a};Ru.prototype.listenerCount=function(e){var n=_h?_h+e:e,i=this._events[n];return i?i.fn?1:i.length:0};Ru.prototype.emit=function(e,n,i,r,s,a){var o=_h?_h+e:e;if(!this._events[o])return!1;var c=this._events[o],l=arguments.length,u,h;if(c.fn){switch(c.once&&this.removeListener(e,c.fn,void 0,!0),l){case 1:return c.fn.call(c.context),!0;case 2:return c.fn.call(c.context,n),!0;case 3:return c.fn.call(c.context,n,i),!0;case 4:return c.fn.call(c.context,n,i,r),!0;case 5:return c.fn.call(c.context,n,i,r,s),!0;case 6:return c.fn.call(c.context,n,i,r,s,a),!0}for(h=1,u=new Array(l-1);h<l;h++)u[h-1]=arguments[h];c.fn.apply(c.context,u)}else{var d=c.length,f;for(h=0;h<d;h++)switch(c[h].once&&this.removeListener(e,c[h].fn,void 0,!0),l){case 1:c[h].fn.call(c[h].context);break;case 2:c[h].fn.call(c[h].context,n);break;case 3:c[h].fn.call(c[h].context,n,i);break;case 4:c[h].fn.call(c[h].context,n,i,r);break;default:if(!u)for(f=1,u=new Array(l-1);f<l;f++)u[f-1]=arguments[f];c[h].fn.apply(c[h].context,u)}}return!0};Ru.prototype.on=function(e,n,i){return a1e(this,e,n,i,!1)};Ru.prototype.once=function(e,n,i){return a1e(this,e,n,i,!0)};Ru.prototype.removeListener=function(e,n,i,r){var s=_h?_h+e:e;if(!this._events[s])return this;if(!n)return PL(this,s),this;var a=this._events[s];if(a.fn)a.fn===n&&(!r||a.once)&&(!i||a.context===i)&&PL(this,s);else{for(var o=0,c=[],l=a.length;o<l;o++)(a[o].fn!==n||r&&!a[o].once||i&&a[o].context!==i)&&c.push(a[o]);c.length?this._events[s]=c.length===1?c[0]:c:PL(this,s)}return this};Ru.prototype.removeAllListeners=function(e){var n;return e?(n=_h?_h+e:e,this._events[n]&&PL(this,n)):(this._events=new _I,this._eventsCount=0),this};Ru.prototype.off=Ru.prototype.removeListener;Ru.prototype.addListener=Ru.prototype.on;Ru.prefixed=_h;Ru.EventEmitter=Ru;TZ=Ru;var cx={};ox(cx,"ConnectionType",()=>i0);ox(cx,"PeerErrorType",()=>To);ox(cx,"BaseConnectionErrorType",()=>yI);ox(cx,"DataConnectionErrorType",()=>bI);ox(cx,"SerializationType",()=>GA);ox(cx,"SocketEventType",()=>Wg);ox(cx,"ServerMessageType",()=>El);var i0;(function(t){t.Data="data",t.Media="media"})(i0||(i0={}));var To;(function(t){t.BrowserIncompatible="browser-incompatible",t.Disconnected="disconnected",t.InvalidID="invalid-id",t.InvalidKey="invalid-key",t.Network="network",t.PeerUnavailable="peer-unavailable",t.SslUnavailable="ssl-unavailable",t.ServerError="server-error",t.SocketError="socket-error",t.SocketClosed="socket-closed",t.UnavailableID="unavailable-id",t.WebRTC="webrtc"})(To||(To={}));var yI;(function(t){t.NegotiationFailed="negotiation-failed",t.ConnectionClosed="connection-closed"})(yI||(yI={}));var bI;(function(t){t.NotOpenYet="not-open-yet",t.MessageToBig="message-too-big"})(bI||(bI={}));var GA;(function(t){t.Binary="binary",t.BinaryUTF8="binary-utf8",t.JSON="json",t.None="raw"})(GA||(GA={}));var Wg;(function(t){t.Message="message",t.Disconnected="disconnected",t.Error="error",t.Close="close"})(Wg||(Wg={}));var El;(function(t){t.Heartbeat="HEARTBEAT",t.Candidate="CANDIDATE",t.Offer="OFFER",t.Answer="ANSWER",t.Open="OPEN",t.Error="ERROR",t.IdTaken="ID-TAKEN",t.InvalidKey="INVALID-KEY",t.Leave="LEAVE",t.Expire="EXPIRE"})(El||(El={}));var xZ={};xZ=JSON.parse('{"name":"peerjs","version":"1.5.4","keywords":["peerjs","webrtc","p2p","rtc"],"description":"PeerJS client","homepage":"https://peerjs.com","bugs":{"url":"https://github.com/peers/peerjs/issues"},"repository":{"type":"git","url":"https://github.com/peers/peerjs"},"license":"MIT","contributors":["Michelle Bu <michelle@michellebu.com>","afrokick <devbyru@gmail.com>","ericz <really.ez@gmail.com>","Jairo <kidandcat@gmail.com>","Jonas Gloning <34194370+jonasgloning@users.noreply.github.com>","Jairo Caro-Accino Viciana <jairo@galax.be>","Carlos Caballero <carlos.caballero.gonzalez@gmail.com>","hc <hheennrryy@gmail.com>","Muhammad Asif <capripio@gmail.com>","PrashoonB <prashoonbhattacharjee@gmail.com>","Harsh Bardhan Mishra <47351025+HarshCasper@users.noreply.github.com>","akotynski <aleksanderkotbury@gmail.com>","lmb <i@lmb.io>","Jairooo <jairocaro@msn.com>","Moritz Stckler <moritz.stueckler@gmail.com>","Simon <crydotsnakegithub@gmail.com>","Denis Lukov <denismassters@gmail.com>","Philipp Hancke <fippo@andyet.net>","Hans Oksendahl <hansoksendahl@gmail.com>","Jess <jessachandler@gmail.com>","khankuan <khankuan@gmail.com>","DUODVK <kurmanov.work@gmail.com>","XiZhao <kwang1imsa@gmail.com>","Matthias Lohr <matthias@lohr.me>","=frank tree <=frnktrb@googlemail.com>","Andre Eckardt <aeckardt@outlook.com>","Chris Cowan <agentme49@gmail.com>","Alex Chuev <alex@chuev.com>","alxnull <alxnull@e.mail.de>","Yemel Jardi <angel.jardi@gmail.com>","Ben Parnell <benjaminparnell.94@gmail.com>","Benny Lichtner <bennlich@gmail.com>","fresheneesz <bitetrudpublic@gmail.com>","bob.barstead@exaptive.com <bob.barstead@exaptive.com>","chandika <chandika@gmail.com>","emersion <contact@emersion.fr>","Christopher Van <cvan@users.noreply.github.com>","eddieherm <edhermoso@gmail.com>","Eduardo Pinho <enet4mikeenet@gmail.com>","Evandro Zanatta <ezanatta@tray.net.br>","Gardner Bickford <gardner@users.noreply.github.com>","Gian Luca <gianluca.cecchi@cynny.com>","PatrickJS <github@gdi2290.com>","jonnyf <github@jonathanfoss.co.uk>","Hizkia Felix <hizkifw@gmail.com>","Hristo Oskov <hristo.oskov@gmail.com>","Isaac Madwed <i.madwed@gmail.com>","Ilya Konanykhin <ilya.konanykhin@gmail.com>","jasonbarry <jasbarry@me.com>","Jonathan Burke <jonathan.burke.1311@googlemail.com>","Josh Hamit <josh.hamit@gmail.com>","Jordan Austin <jrax86@gmail.com>","Joel Wetzell <jwetzell@yahoo.com>","xizhao <kevin.wang@cloudera.com>","Alberto Torres <kungfoobar@gmail.com>","Jonathan Mayol <mayoljonathan@gmail.com>","Jefferson Felix <me@jsfelix.dev>","Rolf Erik Lekang <me@rolflekang.com>","Kevin Mai-Husan Chia <mhchia@users.noreply.github.com>","Pepijn de Vos <pepijndevos@gmail.com>","JooYoung <qkdlql@naver.com>","Tobias Speicher <rootcommander@gmail.com>","Steve Blaurock <sblaurock@gmail.com>","Kyrylo Shegeda <shegeda@ualberta.ca>","Diwank Singh Tomer <singh@diwank.name>","Soren Balko <Soeren.Balko@gmail.com>","Arpit Solanki <solankiarpit1997@gmail.com>","Yuki Ito <yuki@gnnk.net>","Artur Zayats <zag2art@gmail.com>"],"funding":{"type":"opencollective","url":"https://opencollective.com/peer"},"collective":{"type":"opencollective","url":"https://opencollective.com/peer"},"files":["dist/*"],"sideEffects":["lib/global.ts","lib/supports.ts"],"main":"dist/bundler.cjs","module":"dist/bundler.mjs","browser-minified":"dist/peerjs.min.js","browser-unminified":"dist/peerjs.js","browser-minified-msgpack":"dist/serializer.msgpack.mjs","types":"dist/types.d.ts","engines":{"node":">= 14"},"targets":{"types":{"source":"lib/exports.ts"},"main":{"source":"lib/exports.ts","sourceMap":{"inlineSources":true}},"module":{"source":"lib/exports.ts","includeNodeModules":["eventemitter3"],"sourceMap":{"inlineSources":true}},"browser-minified":{"context":"browser","outputFormat":"global","optimize":true,"engines":{"browsers":"chrome >= 83, edge >= 83, firefox >= 80, safari >= 15"},"source":"lib/global.ts"},"browser-unminified":{"context":"browser","outputFormat":"global","optimize":false,"engines":{"browsers":"chrome >= 83, edge >= 83, firefox >= 80, safari >= 15"},"source":"lib/global.ts"},"browser-minified-msgpack":{"context":"browser","outputFormat":"esmodule","isLibrary":true,"optimize":true,"engines":{"browsers":"chrome >= 83, edge >= 83, firefox >= 102, safari >= 15"},"source":"lib/dataconnection/StreamConnection/MsgPack.ts"}},"scripts":{"contributors":"git-authors-cli --print=false && prettier --write package.json && git add package.json package-lock.json && git commit -m \\"chore(contributors): update and sort contributors list\\"","check":"tsc --noEmit && tsc -p e2e/tsconfig.json --noEmit","watch":"parcel watch","build":"rm -rf dist && parcel build","prepublishOnly":"npm run build","test":"jest","test:watch":"jest --watch","coverage":"jest --coverage --collectCoverageFrom=\\"./lib/**\\"","format":"prettier --write .","format:check":"prettier --check .","semantic-release":"semantic-release","e2e":"wdio run e2e/wdio.local.conf.ts","e2e:bstack":"wdio run e2e/wdio.bstack.conf.ts"},"devDependencies":{"@parcel/config-default":"^2.9.3","@parcel/packager-ts":"^2.9.3","@parcel/transformer-typescript-tsc":"^2.9.3","@parcel/transformer-typescript-types":"^2.9.3","@semantic-release/changelog":"^6.0.1","@semantic-release/git":"^10.0.1","@swc/core":"^1.3.27","@swc/jest":"^0.2.24","@types/jasmine":"^4.3.4","@wdio/browserstack-service":"^8.11.2","@wdio/cli":"^8.11.2","@wdio/globals":"^8.11.2","@wdio/jasmine-framework":"^8.11.2","@wdio/local-runner":"^8.11.2","@wdio/spec-reporter":"^8.11.2","@wdio/types":"^8.10.4","http-server":"^14.1.1","jest":"^29.3.1","jest-environment-jsdom":"^29.3.1","mock-socket":"^9.0.0","parcel":"^2.9.3","prettier":"^3.0.0","semantic-release":"^21.0.0","ts-node":"^10.9.1","typescript":"^5.0.0","wdio-geckodriver-service":"^5.0.1"},"dependencies":{"@msgpack/msgpack":"^2.8.0","eventemitter3":"^4.0.7","peerjs-js-binarypack":"^2.1.0","webrtc-adapter":"^9.0.0"},"alias":{"process":false,"buffer":false}}');class bRt extends TZ.EventEmitter{constructor(e,n,i,r,s,a=5e3){super(),this.pingInterval=a,this._disconnected=!0,this._messagesQueue=[];const o=e?"wss://":"ws://";this._baseUrl=o+n+":"+i+r+"peerjs?key="+s}start(e,n){this._id=e;const i=`${this._baseUrl}&id=${e}&token=${n}`;this._socket||!this._disconnected||(this._socket=new WebSocket(i+"&version="+xZ.version),this._disconnected=!1,this._socket.onmessage=r=>{let s;try{s=JSON.parse(r.data),$n.log("Server message received:",s)}catch{$n.log("Invalid server message",r.data);return}this.emit(Wg.Message,s)},this._socket.onclose=r=>{this._disconnected||($n.log("Socket closed.",r),this._cleanup(),this._disconnected=!0,this.emit(Wg.Disconnected))},this._socket.onopen=()=>{this._disconnected||(this._sendQueuedMessages(),$n.log("Socket open"),this._scheduleHeartbeat())})}_scheduleHeartbeat(){this._wsPingTimer=setTimeout(()=>{this._sendHeartbeat()},this.pingInterval)}_sendHeartbeat(){if(!this._wsOpen()){$n.log("Cannot send heartbeat, because socket closed");return}const e=JSON.stringify({type:El.Heartbeat});this._socket.send(e),this._scheduleHeartbeat()}_wsOpen(){return!!this._socket&&this._socket.readyState===1}_sendQueuedMessages(){const e=[...this._messagesQueue];this._messagesQueue=[];for(const n of e)this.send(n)}send(e){if(this._disconnected)return;if(!this._id){this._messagesQueue.push(e);return}if(!e.type){this.emit(Wg.Error,"Invalid message");return}if(!this._wsOpen())return;const n=JSON.stringify(e);this._socket.send(n)}close(){this._disconnected||(this._cleanup(),this._disconnected=!0)}_cleanup(){this._socket&&(this._socket.onopen=this._socket.onmessage=this._socket.onclose=null,this._socket.close(),this._socket=void 0),clearTimeout(this._wsPingTimer)}}class o1e{constructor(e){this.connection=e}startConnection(e){const n=this._startPeerConnection();if(this.connection.peerConnection=n,this.connection.type===i0.Media&&e._stream&&this._addTracksToConnection(e._stream,n),e.originator){const i=this.connection,r={ordered:!!e.reliable},s=n.createDataChannel(i.label,r);i._initializeDataChannel(s),this._makeOffer()}else this.handleSDP("OFFER",e.sdp)}_startPeerConnection(){$n.log("Creating RTCPeerConnection.");const e=new RTCPeerConnection(this.connection.provider.options.config);return this._setupListeners(e),e}_setupListeners(e){const n=this.connection.peer,i=this.connection.connectionId,r=this.connection.type,s=this.connection.provider;$n.log("Listening for ICE candidates."),e.onicecandidate=a=>{!a.candidate||!a.candidate.candidate||($n.log(`Received ICE candidates for ${n}:`,a.candidate),s.socket.send({type:El.Candidate,payload:{candidate:a.candidate,type:r,connectionId:i},dst:n}))},e.oniceconnectionstatechange=()=>{switch(e.iceConnectionState){case"failed":$n.log("iceConnectionState is failed, closing connections to "+n),this.connection.emitError(yI.NegotiationFailed,"Negotiation of connection to "+n+" failed."),this.connection.close();break;case"closed":$n.log("iceConnectionState is closed, closing connections to "+n),this.connection.emitError(yI.ConnectionClosed,"Connection to "+n+" closed."),this.connection.close();break;case"disconnected":$n.log("iceConnectionState changed to disconnected on the connection with "+n);break;case"completed":e.onicecandidate=()=>{};break}this.connection.emit("iceStateChanged",e.iceConnectionState)},$n.log("Listening for data channel"),e.ondatachannel=a=>{$n.log("Received data channel");const o=a.channel;s.getConnection(n,i)._initializeDataChannel(o)},$n.log("Listening for remote stream"),e.ontrack=a=>{$n.log("Received remote stream");const o=a.streams[0],c=s.getConnection(n,i);if(c.type===i0.Media){const l=c;this._addStreamToMediaConnection(o,l)}}}cleanup(){$n.log("Cleaning up PeerConnection to "+this.connection.peer);const e=this.connection.peerConnection;if(!e)return;this.connection.peerConnection=null,e.onicecandidate=e.oniceconnectionstatechange=e.ondatachannel=e.ontrack=()=>{};const n=e.signalingState!=="closed";let i=!1;const r=this.connection.dataChannel;r&&(i=!!r.readyState&&r.readyState!=="closed"),(n||i)&&e.close()}async _makeOffer(){const e=this.connection.peerConnection,n=this.connection.provider;try{const i=await e.createOffer(this.connection.options.constraints);$n.log("Created offer."),this.connection.options.sdpTransform&&typeof this.connection.options.sdpTransform=="function"&&(i.sdp=this.connection.options.sdpTransform(i.sdp)||i.sdp);try{await e.setLocalDescription(i),$n.log("Set localDescription:",i,`for:${this.connection.peer}`);let r={sdp:i,type:this.connection.type,connectionId:this.connection.connectionId,metadata:this.connection.metadata};if(this.connection.type===i0.Data){const s=this.connection;r={...r,label:s.label,reliable:s.reliable,serialization:s.serialization}}n.socket.send({type:El.Offer,payload:r,dst:this.connection.peer})}catch(r){r!="OperationError: Failed to set local offer sdp: Called in wrong state: kHaveRemoteOffer"&&(n.emitError(To.WebRTC,r),$n.log("Failed to setLocalDescription, ",r))}}catch(i){n.emitError(To.WebRTC,i),$n.log("Failed to createOffer, ",i)}}async _makeAnswer(){const e=this.connection.peerConnection,n=this.connection.provider;try{const i=await e.createAnswer();$n.log("Created answer."),this.connection.options.sdpTransform&&typeof this.connection.options.sdpTransform=="function"&&(i.sdp=this.connection.options.sdpTransform(i.sdp)||i.sdp);try{await e.setLocalDescription(i),$n.log("Set localDescription:",i,`for:${this.connection.peer}`),n.socket.send({type:El.Answer,payload:{sdp:i,type:this.connection.type,connectionId:this.connection.connectionId},dst:this.connection.peer})}catch(r){n.emitError(To.WebRTC,r),$n.log("Failed to setLocalDescription, ",r)}}catch(i){n.emitError(To.WebRTC,i),$n.log("Failed to create answer, ",i)}}async handleSDP(e,n){n=new RTCSessionDescription(n);const i=this.connection.peerConnection,r=this.connection.provider;$n.log("Setting remote description",n);const s=this;try{await i.setRemoteDescription(n),$n.log(`Set remoteDescription:${e} for:${this.connection.peer}`),e==="OFFER"&&await s._makeAnswer()}catch(a){r.emitError(To.WebRTC,a),$n.log("Failed to setRemoteDescription, ",a)}}async handleCandidate(e){$n.log("handleCandidate:",e);try{await this.connection.peerConnection.addIceCandidate(e),$n.log(`Added ICE candidate for:${this.connection.peer}`)}catch(n){this.connection.provider.emitError(To.WebRTC,n),$n.log("Failed to handleCandidate, ",n)}}_addTracksToConnection(e,n){if($n.log(`add tracks from stream ${e.id} to peer connection`),!n.addTrack)return $n.error("Your browser does't support RTCPeerConnection#addTrack. Ignored.");e.getTracks().forEach(i=>{n.addTrack(i,e)})}_addStreamToMediaConnection(e,n){$n.log(`add stream ${e.id} to media connection ${n.connectionId}`),n.addStream(e)}}class c1e extends TZ.EventEmitter{emitError(e,n){$n.error("Error:",n),this.emit("error",new ERt(`${e}`,n))}}class ERt extends Error{constructor(e,n){typeof n=="string"?super(n):(super(),Object.assign(this,n)),this.type=e}}class l1e extends c1e{get open(){return this._open}constructor(e,n,i){super(),this.peer=e,this.provider=n,this.options=i,this._open=!1,this.metadata=i.metadata}}var U7;const jO=class jO extends l1e{get type(){return i0.Media}get localStream(){return this._localStream}get remoteStream(){return this._remoteStream}constructor(e,n,i){super(e,n,i),this._localStream=this.options._stream,this.connectionId=this.options.connectionId||jO.ID_PREFIX+Yh.randomToken(),this._negotiator=new o1e(this),this._localStream&&this._negotiator.startConnection({_stream:this._localStream,originator:!0})}_initializeDataChannel(e){this.dataChannel=e,this.dataChannel.onopen=()=>{$n.log(`DC#${this.connectionId} dc connection success`),this.emit("willCloseOnRemote")},this.dataChannel.onclose=()=>{$n.log(`DC#${this.connectionId} dc closed for:`,this.peer),this.close()}}addStream(e){$n.log("Receiving stream",e),this._remoteStream=e,super.emit("stream",e)}handleMessage(e){const n=e.type,i=e.payload;switch(e.type){case El.Answer:this._negotiator.handleSDP(n,i.sdp),this._open=!0;break;case El.Candidate:this._negotiator.handleCandidate(i.candidate);break;default:$n.warn(`Unrecognized message type:${n} from peer:${this.peer}`);break}}answer(e,n={}){if(this._localStream){$n.warn("Local stream already exists on this MediaConnection. Are you answering a call twice?");return}this._localStream=e,n&&n.sdpTransform&&(this.options.sdpTransform=n.sdpTransform),this._negotiator.startConnection({...this.options._payload,_stream:e});const i=this.provider._getMessages(this.connectionId);for(const r of i)this.handleMessage(r);this._open=!0}close(){this._negotiator&&(this._negotiator.cleanup(),this._negotiator=null),this._localStream=null,this._remoteStream=null,this.provider&&(this.provider._removeConnection(this),this.provider=null),this.options&&this.options._stream&&(this.options._stream=null),this.open&&(this._open=!1,super.emit("close"))}};U7=new WeakMap,GR(jO,U7,jO.ID_PREFIX="mc_");let LB=jO;class SRt{constructor(e){this._options=e}_buildRequest(e){const n=this._options.secure?"https":"http",{host:i,port:r,path:s,key:a}=this._options,o=new URL(`${n}://${i}:${r}${s}${a}/${e}`);return o.searchParams.set("ts",`${Date.now()}${Math.random()}`),o.searchParams.set("version",xZ.version),fetch(o.href,{referrerPolicy:this._options.referrerPolicy})}async retrieveId(){try{const e=await this._buildRequest("id");if(e.status!==200)throw new Error(`Error. Status:${e.status}`);return e.text()}catch(e){$n.error("Error retrieving ID",e);let n="";throw this._options.path==="/"&&this._options.host!==Yh.CLOUD_HOST&&(n=" If you passed in a `path` to your self-hosted PeerServer, you'll also need to pass in that same path when creating a new Peer."),new Error("Could not get an ID from the server."+n)}}async listAllPeers(){try{const e=await this._buildRequest("peers");if(e.status!==200){if(e.status===401){let n="";throw this._options.host===Yh.CLOUD_HOST?n="It looks like you're using the cloud server. You can email team@peerjs.com to enable peer listing for your API key.":n="You need to enable `allow_discovery` on your self-hosted PeerServer to use this feature.",new Error("It doesn't look like you have permission to list peers IDs. "+n)}throw new Error(`Error. Status:${e.status}`)}return e.json()}catch(e){throw $n.error("Error retrieving list peers",e),new Error("Could not get list peers from the server."+e)}}}var B7,F7;const pT=class pT extends l1e{get type(){return i0.Data}constructor(e,n,i){super(e,n,i),this.connectionId=this.options.connectionId||pT.ID_PREFIX+s1e(),this.label=this.options.label||this.connectionId,this.reliable=!!this.options.reliable,this._negotiator=new o1e(this),this._negotiator.startConnection(this.options._payload||{originator:!0,reliable:this.reliable})}_initializeDataChannel(e){this.dataChannel=e,this.dataChannel.onopen=()=>{$n.log(`DC#${this.connectionId} dc connection success`),this._open=!0,this.emit("open")},this.dataChannel.onmessage=n=>{$n.log(`DC#${this.connectionId} dc onmessage:`,n.data)},this.dataChannel.onclose=()=>{$n.log(`DC#${this.connectionId} dc closed for:`,this.peer),this.close()}}close(e){if(e!=null&&e.flush){this.send({__peerData:{type:"close"}});return}this._negotiator&&(this._negotiator.cleanup(),this._negotiator=null),this.provider&&(this.provider._removeConnection(this),this.provider=null),this.dataChannel&&(this.dataChannel.onopen=null,this.dataChannel.onmessage=null,this.dataChannel.onclose=null,this.dataChannel=null),this.open&&(this._open=!1,super.emit("close"))}send(e,n=!1){if(!this.open){this.emitError(bI.NotOpenYet,"Connection is not open. You should listen for the `open` event before sending messages.");return}return this._send(e,n)}async handleMessage(e){const n=e.payload;switch(e.type){case El.Answer:await this._negotiator.handleSDP(e.type,n.sdp);break;case El.Candidate:await this._negotiator.handleCandidate(n.candidate);break;default:$n.warn("Unrecognized message type:",e.type,"from peer:",this.peer);break}}};B7=new WeakMap,F7=new WeakMap,GR(pT,B7,pT.ID_PREFIX="dc_"),GR(pT,F7,pT.MAX_BUFFERED_AMOUNT=8388608);let UB=pT;class wZ extends UB{get bufferSize(){return this._bufferSize}_initializeDataChannel(e){super._initializeDataChannel(e),this.dataChannel.binaryType="arraybuffer",this.dataChannel.addEventListener("message",n=>this._handleDataMessage(n))}_bufferedSend(e){(this._buffering||!this._trySend(e))&&(this._buffer.push(e),this._bufferSize=this._buffer.length)}_trySend(e){if(!this.open)return!1;if(this.dataChannel.bufferedAmount>UB.MAX_BUFFERED_AMOUNT)return this._buffering=!0,setTimeout(()=>{this._buffering=!1,this._tryBuffer()},50),!1;try{this.dataChannel.send(e)}catch(n){return $n.error(`DC#:${this.connectionId} Error when sending:`,n),this._buffering=!0,this.close(),!1}return!0}_tryBuffer(){if(!this.open||this._buffer.length===0)return;const e=this._buffer[0];this._trySend(e)&&(this._buffer.shift(),this._bufferSize=this._buffer.length,this._tryBuffer())}close(e){if(e!=null&&e.flush){this.send({__peerData:{type:"close"}});return}this._buffer=[],this._bufferSize=0,super.close()}constructor(...e){super(...e),this._buffer=[],this._bufferSize=0,this._buffering=!1}}class SV extends wZ{close(e){super.close(e),this._chunkedData={}}constructor(e,n,i){super(e,n,i),this.chunker=new r1e,this.serialization=GA.Binary,this._chunkedData={}}_handleDataMessage({data:e}){const n=TTe(e),i=n.__peerData;if(i){if(i.type==="close"){this.close();return}this._handleChunk(n);return}this.emit("data",n)}_handleChunk(e){const n=e.__peerData,i=this._chunkedData[n]||{data:[],count:0,total:e.total};if(i.data[e.n]=new Uint8Array(e.data),i.count++,this._chunkedData[n]=i,i.total===i.count){delete this._chunkedData[n];const r=fRt(i.data);this._handleDataMessage({data:r})}}_send(e,n){const i=xTe(e);if(i instanceof Promise)return this._send_blob(i);if(!n&&i.byteLength>this.chunker.chunkedMTU){this._sendChunks(i);return}this._bufferedSend(i)}async _send_blob(e){const n=await e;if(n.byteLength>this.chunker.chunkedMTU){this._sendChunks(n);return}this._bufferedSend(n)}_sendChunks(e){const n=this.chunker.chunk(e);$n.log(`DC#${this.connectionId} Try to send ${n.length} chunks...`);for(const i of n)this.send(i,!0)}}class TRt extends wZ{_handleDataMessage({data:e}){super.emit("data",e)}_send(e,n){this._bufferedSend(e)}constructor(...e){super(...e),this.serialization=GA.None}}class xRt extends wZ{_handleDataMessage({data:e}){const n=this.parse(this.decoder.decode(e)),i=n.__peerData;if(i&&i.type==="close"){this.close();return}this.emit("data",n)}_send(e,n){const i=this.encoder.encode(this.stringify(e));if(i.byteLength>=Yh.chunkedMTU){this.emitError(bI.MessageToBig,"Message too big for JSON channel");return}this._bufferedSend(i)}constructor(...e){super(...e),this.serialization=GA.JSON,this.encoder=new TextEncoder,this.decoder=new TextDecoder,this.stringify=JSON.stringify,this.parse=JSON.parse}}var z7;const HO=class HO extends c1e{get id(){return this._id}get options(){return this._options}get open(){return this._open}get socket(){return this._socket}get connections(){const e=Object.create(null);for(const[n,i]of this._connections)e[n]=i;return e}get destroyed(){return this._destroyed}get disconnected(){return this._disconnected}constructor(e,n){super(),this._serializers={raw:TRt,json:xRt,binary:SV,"binary-utf8":SV,default:SV},this._id=null,this._lastServerId=null,this._destroyed=!1,this._disconnected=!1,this._open=!1,this._connections=new Map,this._lostMessages=new Map;let i;if(e&&e.constructor==Object?n=e:e&&(i=e.toString()),n={debug:0,host:Yh.CLOUD_HOST,port:Yh.CLOUD_PORT,path:"/",key:HO.DEFAULT_KEY,token:Yh.randomToken(),config:Yh.defaultConfig,referrerPolicy:"strict-origin-when-cross-origin",serializers:{},...n},this._options=n,this._serializers={...this._serializers,...this.options.serializers},this._options.host==="/"&&(this._options.host=window.location.hostname),this._options.path&&(this._options.path[0]!=="/"&&(this._options.path="/"+this._options.path),this._options.path[this._options.path.length-1]!=="/"&&(this._options.path+="/")),this._options.secure===void 0&&this._options.host!==Yh.CLOUD_HOST?this._options.secure=Yh.isSecure():this._options.host==Yh.CLOUD_HOST&&(this._options.secure=!0),this._options.logFunction&&$n.setLogFunction(this._options.logFunction),$n.logLevel=this._options.debug||0,this._api=new SRt(n),this._socket=this._createServerConnection(),!Yh.supports.audioVideo&&!Yh.supports.data){this._delayedAbort(To.BrowserIncompatible,"The current browser does not support WebRTC");return}if(i&&!Yh.validateId(i)){this._delayedAbort(To.InvalidID,`ID "${i}" is invalid`);return}i?this._initialize(i):this._api.retrieveId().then(r=>this._initialize(r)).catch(r=>this._abort(To.ServerError,r))}_createServerConnection(){const e=new bRt(this._options.secure,this._options.host,this._options.port,this._options.path,this._options.key,this._options.pingInterval);return e.on(Wg.Message,n=>{this._handleMessage(n)}),e.on(Wg.Error,n=>{this._abort(To.SocketError,n)}),e.on(Wg.Disconnected,()=>{this.disconnected||(this.emitError(To.Network,"Lost connection to server."),this.disconnect())}),e.on(Wg.Close,()=>{this.disconnected||this._abort(To.SocketClosed,"Underlying socket is already closed.")}),e}_initialize(e){this._id=e,this.socket.start(e,this._options.token)}_handleMessage(e){const n=e.type,i=e.payload,r=e.src;switch(n){case El.Open:this._lastServerId=this.id,this._open=!0,this.emit("open",this.id);break;case El.Error:this._abort(To.ServerError,i.msg);break;case El.IdTaken:this._abort(To.UnavailableID,`ID "${this.id}" is taken`);break;case El.InvalidKey:this._abort(To.InvalidKey,`API KEY "${this._options.key}" is invalid`);break;case El.Leave:$n.log(`Received leave message from ${r}`),this._cleanupPeer(r),this._connections.delete(r);break;case El.Expire:this.emitError(To.PeerUnavailable,`Could not connect to peer ${r}`);break;case El.Offer:{const s=i.connectionId;let a=this.getConnection(r,s);if(a&&(a.close(),$n.warn(`Offer received for existing Connection ID:${s}`)),i.type===i0.Media){const c=new LB(r,this,{connectionId:s,_payload:i,metadata:i.metadata});a=c,this._addConnection(r,a),this.emit("call",c)}else if(i.type===i0.Data){const c=new this._serializers[i.serialization](r,this,{connectionId:s,_payload:i,metadata:i.metadata,label:i.label,serialization:i.serialization,reliable:i.reliable});a=c,this._addConnection(r,a),this.emit("connection",c)}else{$n.warn(`Received malformed connection type:${i.type}`);return}const o=this._getMessages(s);for(const c of o)a.handleMessage(c);break}default:{if(!i){$n.warn(`You received a malformed message from ${r} of type ${n}`);return}const s=i.connectionId,a=this.getConnection(r,s);a&&a.peerConnection?a.handleMessage(e):s?this._storeMessage(s,e):$n.warn("You received an unrecognized message:",e);break}}}_storeMessage(e,n){this._lostMessages.has(e)||this._lostMessages.set(e,[]),this._lostMessages.get(e).push(n)}_getMessages(e){const n=this._lostMessages.get(e);return n?(this._lostMessages.delete(e),n):[]}connect(e,n={}){if(n={serialization:"default",...n},this.disconnected){$n.warn("You cannot connect to a new Peer because you called .disconnect() on this Peer and ended your connection with the server. You can create a new Peer to reconnect, or call reconnect on this peer if you believe its ID to still be available."),this.emitError(To.Disconnected,"Cannot connect to new Peer after disconnecting from server.");return}const i=new this._serializers[n.serialization](e,this,n);return this._addConnection(e,i),i}call(e,n,i={}){if(this.disconnected){$n.warn("You cannot connect to a new Peer because you called .disconnect() on this Peer and ended your connection with the server. You can create a new Peer to reconnect."),this.emitError(To.Disconnected,"Cannot connect to new Peer after disconnecting from server.");return}if(!n){$n.error("To call a peer, you must provide a stream from your browser's `getUserMedia`.");return}const r=new LB(e,this,{...i,_stream:n});return this._addConnection(e,r),r}_addConnection(e,n){$n.log(`add connection ${n.type}:${n.connectionId} to peerId:${e}`),this._connections.has(e)||this._connections.set(e,[]),this._connections.get(e).push(n)}_removeConnection(e){const n=this._connections.get(e.peer);if(n){const i=n.indexOf(e);i!==-1&&n.splice(i,1)}this._lostMessages.delete(e.connectionId)}getConnection(e,n){const i=this._connections.get(e);if(!i)return null;for(const r of i)if(r.connectionId===n)return r;return null}_delayedAbort(e,n){setTimeout(()=>{this._abort(e,n)},0)}_abort(e,n){$n.error("Aborting!"),this.emitError(e,n),this._lastServerId?this.disconnect():this.destroy()}destroy(){this.destroyed||($n.log(`Destroy peer with ID:${this.id}`),this.disconnect(),this._cleanup(),this._destroyed=!0,this.emit("close"))}_cleanup(){for(const e of this._connections.keys())this._cleanupPeer(e),this._connections.delete(e);this.socket.removeAllListeners()}_cleanupPeer(e){const n=this._connections.get(e);if(n)for(const i of n)i.close()}disconnect(){if(this.disconnected)return;const e=this.id;$n.log(`Disconnect peer with ID:${e}`),this._disconnected=!0,this._open=!1,this.socket.close(),this._lastServerId=e,this._id=null,this.emit("disconnected",e)}reconnect(){if(this.disconnected&&!this.destroyed)$n.log(`Attempting reconnection to server with ID ${this._lastServerId}`),this._disconnected=!1,this._initialize(this._lastServerId);else{if(this.destroyed)throw new Error("This peer cannot reconnect to the server. It has already been destroyed.");if(!this.disconnected&&!this.open)$n.error("In a hurry? We're still trying to make the initial connection!");else throw new Error(`Peer ${this.id} cannot reconnect because it is not disconnected from the server!`)}}listAllPeers(e=n=>{}){this._api.listAllPeers().then(n=>e(n)).catch(n=>this._abort(To.ServerError,n))}};z7=new WeakMap,GR(HO,z7,HO.DEFAULT_KEY="peerjs");let g7=HO;var wRt=g7;let gp,EI,SI;const TI={},qA={},xI={},v7={},u1e={};function h1e(t,e,n=!1){const i=Yo().createMediaStreamSource(e),r=new Xi(5);Rp(i,r),t===Gi()?(console.info("setup local voice",t),EI=e):console.info("setup remote voice",t),r.toDestination(),xI[t]=r}function d1e(t,e){const n=document.createElement("video");n.autoplay=!0,n.srcObject=e,t===Gi()?SI=e:console.info("setup remote screen",t),_p.getState().setscreen(t,n),u1e[t]=n}function _7(t){var e,n;(e=xI[t])==null||e.dispose(),(n=qA[t])==null||n.close(),delete xI[t],delete qA[t],delete v7[t],delete u1e[t]}function y7(t){console.info("mediaconnection.metadata",t.metadata),t.on("stream",e=>{t.metadata.screen?d1e(t.peer,e):h1e(t.peer,e)}),t.on("close",()=>{_7(t.peer)}),t.on("error",()=>{_7(t.peer)})}function CZ(){re(gp)||(gp=new wRt(Gi()),gp.on("call",t=>{t.answer(),y7(t),setTimeout(Z8,1e3)}),gp.on("error",t=>{Mi(Ye,Gi(),"usermedia",t.toString())}))}function f1e(){re(gp)&&(gp.destroy(),gp=void 0)}async function CRt(){try{return await navigator.mediaDevices.getUserMedia({audio:{echoCancellation:!1,noiseSuppression:!1}})}catch(t){Mi(Ye,Gi(),"uservoice",t.toString())}}function ARt(){CZ(),CRt().then(t=>{re(t)&&(h1e(Gi(),t),Z8())}).catch(t=>{Mi(Ye,Gi(),"uservoice",t.toString())})}function RRt(){_7(Gi()),EI=void 0,re(SI)||f1e()}async function MRt(){try{return await navigator.mediaDevices.getDisplayMedia({audio:!0,video:!0})}catch(t){Mi(Ye,Gi(),"userscreenshare",t.toString())}}function ORt(){CZ(),MRt().then(t=>{re(t)&&(d1e(Gi(),t),Z8())}).catch(t=>{Mi(Ye,Gi(),"userscreen",t.toString())})}function NRt(){SI=void 0,re(EI)||f1e()}function IRt(t){CZ(),re(gp)&&(TI[t]=!0)}function kRt(t){var e,n;re(gp)&&((e=qA[t])==null||e.close(),(n=xI[t])==null||n.dispose(),delete TI[t],delete qA[t],delete xI[t])}function Z8(){if(!re(gp))return;const t=Object.keys(TI);if(re(EI))for(let e=0;e<t.length;++e){const n=t[e];if(n===Gi())continue;const i=qA[n];if(!re(i)||!i.open){const r=gp.call(n,EI,{metadata:{voice:!0}});qA[n]=r,y7(r)}}if(re(SI))for(let e=0;e<t.length;++e){const n=t[e];if(n===Gi())continue;const i=v7[n];if(!re(i)||!i.open){const r=gp.call(n,SI,{metadata:{screen:!0}});v7[n]=r,y7(r)}}}function PRt(t){const e={};for(let i=0;i<t.length;++i){const r=t[i];re(TI[r])||(e[r]=!0,IRt(r))}const n=Object.keys(TI);for(let i=0;i<n.length;++i){const r=n[i];re(e[r])||kRt(r)}Z8()}function J8({id:t,from:e}){const n=_p(),i=jr(Cu(s=>{var a;return(a=s.gadget[e])==null?void 0:a.find(o=>o.id===t)})),r=(i==null?void 0:i.type)===ks.MEDIA?i:void 0;return De.useEffect(()=>{switch(r==null?void 0:r.mime){case"image/palette":ji(r.media)&&n.setpalette(aH(l1,Dme,r.media));break;case"image/charset":ji(r.media)&&n.setcharset(aH(dp*p_,Oq*m_,r.media));break;case"image/altcharset":ji(r.media)&&n.setaltcharset(aH(dp*p_,Oq*m_,r.media));break;case"text/mood":Tn(r.media)&&n.setmood(r.media);break;case"text/players":Tn(r.media)&&PRt(r.media.split(","));break}},[n,r]),null}function DRt({width:t,height:e}){const n=t*Kt.DRAW_CHAR_WIDTH(),i=e*Kt.DRAW_CHAR_HEIGHT(),r=De.useRef(null),s=De.useRef(null),a=De.useRef(null),o=De.useRef(null);Pm((h,d)=>{if(!r.current||!s.current||!a.current||!o.current)return;const f=cA(jr.getState().gadget.layers??[]);re(s.current.userData.focusx)||(a.current.scale.setScalar(f.viewscale),s.current.userData={focusx:f.focusx,focusy:f.focusy,tfocusx:f.focusx,tfocusy:f.focusy,facing:f.facing},s.current.position.set(-f.focusx*Kt.DRAW_CHAR_WIDTH(),-f.focusy*Kt.DRAW_CHAR_HEIGHT(),0));const p=.25,g=s.current.userData.focusx,_=s.current.userData.focusy,v=g*Kt.DRAW_CHAR_WIDTH(),b=_*Kt.DRAW_CHAR_HEIGHT();jA(s.current.position,[-v,-b,0],p,d);const S=Math.abs(s.current.userData.focusx-s.current.userData.tfocusx),x=Math.abs(s.current.userData.focusy-s.current.userData.tfocusy);S<1&&x<1&&jA(a.current.scale,f.viewscale,p,d);const M=a.current.scale.x,R=1/M,k=Math.abs(M-f.viewscale)>.01,P=M<Sc.MID,$=(M*Kt.DRAW_CHAR_WIDTH()-Kt.DRAW_CHAR_WIDTH())*R,q=Kt.DRAW_CHAR_WIDTH()+$,G=(M*Kt.DRAW_CHAR_HEIGHT()-Kt.DRAW_CHAR_HEIGHT())*R,J=Kt.DRAW_CHAR_HEIGHT()+G;o.current.position.set(v-g*q,b-_*J,0);const K=Kt.DRAW_CHAR_WIDTH()*M,X=Kt.DRAW_CHAR_HEIGHT()*M,ae=n/K,ce=i/X;if(k&&(s.current.userData.tfocusx=f.focusx+.5,s.current.userData.tfocusy=f.focusy+.5),r.current.position.set(n*.5,i*.5,0),!k)if(P)s.current.userData.tfocusx=f.focusx+.5,s.current.userData.tfocusy=f.focusy+.5;else{const ke=Math.round(ae*.25),gt=Math.round(ce*.25),wt=Math.round(s.current.userData.tfocusx-f.focusx);if(Math.abs(wt)>=ke){const Se=wt<0?ke:-ke;s.current.userData.tfocusx+=Se*2}const ye=Math.round(s.current.userData.tfocusy-f.focusy);if(Math.abs(ye)>=gt){const Se=ye<0?gt:-gt;s.current.userData.tfocusy+=Se*2}}const Me=Math.round(ae*.5),Fe=Math.round(ce*.5),Te=f.width-ae*.5,Re=f.height-ce*.5,ge=-Math.round((ae-f.width)*.5),_e=-Math.round((ce-f.height)*.5);ge>=0?(s.current.userData.tfocusx<Me&&(k&&(s.current.userData.focusx=Me),s.current.userData.tfocusx=Me),s.current.userData.tfocusx>Te&&(k&&(s.current.userData.focusx=Te),s.current.userData.tfocusx=Te)):s.current.userData.tfocusx=Me+ge,_e>=0?(s.current.userData.tfocusy<Fe&&(k&&(s.current.userData.focusy=Fe),s.current.userData.tfocusy=Fe),s.current.userData.tfocusy>Re&&(k&&(s.current.userData.focusy=Re),s.current.userData.tfocusy=Re)):s.current.userData.tfocusy=Fe+_e,ph(s.current.userData,"focusx",s.current.userData.tfocusx,p),ph(s.current.userData,"focusy",s.current.userData.tfocusy,p)}),jr(h=>{var d;return((d=h.gadget.over)==null?void 0:d.length)??0}),jr(h=>{var d;return((d=h.gadget.under)==null?void 0:d.length)??0}),jr(h=>{var d;return((d=h.gadget.layers)==null?void 0:d.length)??0});const{over:c=[],under:l=[],layers:u=[]}=jr.getState().gadget;return be.jsx("group",{ref:r,children:be.jsx("group",{ref:s,children:be.jsx("group",{ref:a,children:be.jsxs("group",{ref:o,children:[be.jsx(WAt,{}),l.map((h,d)=>be.jsx(S_,{from:"under",id:h.id,z:d*2},h.id)),u.map(h=>be.jsx(J8,{id:h.id,from:"layers"},`media${h.id}`)),u.map((h,d)=>be.jsx(S_,{from:"layers",id:h.id,z:l.length+d*2},h.id)),c.map((h,d)=>be.jsx(S_,{from:"over",id:h.id,z:l.length+u.length+d*2},h.id))]})})})})}const LRt=CA(PE(G1)),Hoe=VT(V1(dR)),URt=new qa({transparent:!1,side:Vc,uniforms:{time:Jd,interval:hP,palette:new vn(LRt),map:new vn(Hoe),alt:new vn(Hoe),cols:new vn(1),rows:new vn(1),step:new vn(new xt)},vertexShader:`
    uniform float time;
    uniform float interval;
    uniform float size;

    varying vec2 vUv;
    varying vec3 vColor;

    void main() {
      vUv = uv;
      vColor.xyz = instanceColor.xyz;
      
      vec4 mvPosition = vec4(position, 1.0);
      mvPosition = instanceMatrix * mvPosition;
      mvPosition = modelViewMatrix * mvPosition;
      gl_Position = projectionMatrix * mvPosition;
    }
  `,fragmentShader:`
    uniform float time;
    uniform float interval;
    uniform sampler2D map;
    uniform sampler2D alt;
    uniform vec3 palette[16];
    uniform vec2 step;
    uniform float cols;
    uniform float rows;

    varying vec2 vUv;
    varying vec3 vColor;
    
    vec3 colorFromIndex(float index) {
      return palette[int(index)];
    }

    void main() {
      // r = char, g = color, b = bg
      int tc = int(cols);
      int ti = int(vColor.r);
      float tx = float(ti % tc);
      float ty = rows - floor(vColor.r / cols);

      vec2 uv = vUv * step + vec2(tx * step.x, ty * step.y);
      bool useAlt = mod(time, interval * 2.0) > interval;
      vec3 blip = useAlt ? texture(alt, uv).rgb : texture(map, uv).rgb;

      if (blip.r == 0.0) {
        gl_FragColor.rgb = colorFromIndex(vColor.b);
      } else {
        gl_FragColor.rgb = colorFromIndex(vColor.g);
      }      
      gl_FragColor.a = 1.0;
    }
  `});function BRt(){return dP(URt)}function p1e(){const t=_p(c=>c.palettedata),e=_p(c=>c.charsetdata),n=_p(c=>c.altcharsetdata),[i]=De.useState(()=>BRt()),r=Kt.DRAW_CHAR_WIDTH(),s=Kt.DRAW_CHAR_HEIGHT(),{width:a=0,height:o=0}=(e==null?void 0:e.image)??{};return De.useEffect(()=>{i.uniforms.map.value=e,i.uniforms.alt.value=n??e,i.uniforms.palette.value=t;const c=Math.round(a/p_),l=Math.round(o/m_);i.uniforms.cols.value=c,i.uniforms.rows.value=l-1,i.uniforms.step.value.x=1/c,i.uniforms.step.value.y=1/l,i.needsUpdate=!0},[t,e,n,i,a,o]),be.jsxs(be.Fragment,{children:[be.jsx("boxGeometry",{args:[r,s,s]}),be.jsx("primitive",{object:i,attach:"material"})]})}function FRt({id:t,z:e,from:n}){const i=jr(Cu(a=>{var o;return(o=a.gadget[n])==null?void 0:o.find(c=>c.id===t)})),r=Kt.DRAW_CHAR_WIDTH(),s=Kt.DRAW_CHAR_HEIGHT();switch(i==null?void 0:i.type){default:case ks.BLANK:case ks.MEDIA:return null;case ks.TILES:return be.jsx(be.Fragment,{children:be.jsxs("group",{position:[0,0,e],children:[be.jsx(pP,{width:i.width,height:i.height,char:[...i.char],color:[...i.color],bg:[...i.bg]}),be.jsxs(YSe,{limit:hk,children:[be.jsx(p1e,{}),i.wall.map((a,o)=>{const c=I3(o,kn);return a?be.jsx(pZ,{position:[(c.x+.5)*r,(c.y+.5)*s,e+s*.5],color:[i.char[o],i.color[o],i.bg[o]]},o):null}).filter(a=>a)]})]},i.id)});case ks.SPRITES:return be.jsx("group",{position:[0,0,e],children:be.jsx(X8,{sprites:[...i.sprites],withbillboards:!0,fliptexture:!1})},i.id);case ks.DITHER:return be.jsx("group",{position:[0,0,e],children:be.jsx(E_,{width:i.width,height:i.height,alphas:[...i.alphas]})},i.id)}}function AZ({viewwidth:t,viewheight:e,children:n}){return be.jsxs("mesh",{position:[t*.5,e*.5,0],children:[be.jsx("planeGeometry",{args:[t,e]}),be.jsx("meshBasicMaterial",{transparent:!0,children:be.jsx(Fxt,{attach:"map",width:t,height:e,depthBuffer:!0,stencilBuffer:!1,generateMipmaps:!1,children:n})})]})}function zRt(t){switch(t.type){case ks.TILES:if(t.tag==="tickers")return Kt.DRAW_CHAR_HEIGHT()+1;break;case ks.DITHER:return Kt.DRAW_CHAR_HEIGHT()+1;case ks.SPRITES:return Kt.DRAW_CHAR_HEIGHT()*.25}return 0}function jRt({width:t,height:e}){const n=t*Kt.DRAW_CHAR_WIDTH(),i=e*Kt.DRAW_CHAR_HEIGHT(),r=De.useRef(null),s=De.useRef(null),a=De.useRef(null);Pm((d,f)=>{if(!r.current||!s.current||!a.current)return;const p=cA(jr.getState().gadget.layers??[]),g=t*Kt.DRAW_CHAR_WIDTH(),_=e*Kt.DRAW_CHAR_HEIGHT(),v=kn*Kt.DRAW_CHAR_WIDTH(),b=ur*Kt.DRAW_CHAR_HEIGHT();r.current.position.x=0,r.current.position.y=_-b;const S=er(g/v,1,10);s.current.position.x=g-v*S,s.current.position.y=0,s.current.scale.setScalar(S);const x=.125,M=Kt.DRAW_CHAR_WIDTH(),R=Kt.DRAW_CHAR_HEIGHT();dZ(a.current.rotation,[Math.PI*-.5,p.facing,0],x,f),a.current.position.x=(p.focusx+.5)*M,a.current.position.y=(p.focusy+.5)*R,a.current.position.z=Kt.DRAW_CHAR_HEIGHT()*.75}),jr(d=>{var f;return((f=d.gadget.over)==null?void 0:f.length)??0}),jr(d=>{var f;return((f=d.gadget.under)==null?void 0:f.length)??0}),jr(d=>{var f;return((f=d.gadget.layers)==null?void 0:f.length)??0});const{over:o=[],under:c=[],layers:l=[]}=jr.getState().gadget,u=c.length*2+2,h=u+2;return be.jsxs(be.Fragment,{children:[be.jsxs("group",{"position-z":u,children:[l.map(d=>be.jsx(J8,{id:d.id,from:"layers"},`media${d.id}`)),be.jsxs(AZ,{viewwidth:n,viewheight:i,children:[be.jsx(GSe,{ref:a,makeDefault:!0,near:1,far:2e3,rotation:[Math.PI*-.5,0,0],position:[0,0,200]}),l.map(d=>be.jsx(FRt,{id:d.id,from:"layers",z:zRt(d)},d.id))]})]}),be.jsx("group",{ref:s,children:c.map((d,f)=>be.jsx(S_,{from:"under",id:d.id,z:f*2},d.id))}),be.jsx("group",{ref:r,"position-z":h,children:o.map((d,f)=>be.jsx(S_,{from:"over",id:d.id,z:f*2},d.id))})]})}function HRt({id:t,z:e,from:n}){const i=jr(Cu(a=>{var o;return(o=a.gadget[n])==null?void 0:o.find(c=>c.id===t)})),r=Kt.DRAW_CHAR_WIDTH(),s=Kt.DRAW_CHAR_HEIGHT();switch(i==null?void 0:i.type){default:case ks.BLANK:case ks.MEDIA:return null;case ks.TILES:return be.jsx(be.Fragment,{children:be.jsxs("group",{position:[0,0,e],children:[be.jsx(pP,{width:i.width,height:i.height,char:[...i.char],color:[...i.color],bg:[...i.bg]}),be.jsxs(YSe,{limit:hk,children:[be.jsx(p1e,{}),i.wall.map((a,o)=>{const c=I3(o,kn);return a?be.jsx(pZ,{position:[(c.x+.5)*r,(c.y+.5)*s,e+s*.5],color:[i.char[o],i.color[o],i.bg[o]]},o):null}).filter(a=>a)]})]},i.id)});case ks.SPRITES:return be.jsx("group",{position:[0,0,e],children:be.jsx(X8,{sprites:[...i.sprites],fliptexture:!1})},i.id);case ks.DITHER:return be.jsx("group",{position:[0,0,e],children:be.jsx(E_,{width:i.width,height:i.height,alphas:[...i.alphas]})},i.id)}}function VRt(t){switch(t.type){case ks.TILES:if(t.tag==="tickers")return Kt.DRAW_CHAR_HEIGHT()+1;break;case ks.DITHER:return Kt.DRAW_CHAR_HEIGHT()+1;case ks.SPRITES:return Kt.DRAW_CHAR_HEIGHT()*.25}return 0}function GRt(t){switch(t){case Sc.NEAR:return 10;default:case Sc.MID:return 4;case Sc.FAR:return 1.5}}function qRt({width:t,height:e}){const n=t*Kt.DRAW_CHAR_WIDTH(),i=e*Kt.DRAW_CHAR_HEIGHT(),r=De.useRef(null),s=De.useRef(null),a=De.useRef(null),o=De.useRef(null),c=De.useRef(null);Pm((p,g)=>{if(!r.current||!s.current||!a.current||!o.current||!c.current)return;const _=cA(jr.getState().gadget.layers??[]),v=t*Kt.DRAW_CHAR_WIDTH(),b=e*Kt.DRAW_CHAR_HEIGHT(),S=kn*Kt.DRAW_CHAR_WIDTH(),x=ur*Kt.DRAW_CHAR_HEIGHT();re(c.current.userData.focusx)||(r.current.scale.setScalar(_.viewscale),c.current.userData={focusx:_.focusx,focusy:_.focusy,focuslx:_.focusx,focusly:_.focusy,focusvx:0,focusvy:0,facing:_.facing,focusz:0}),a.current.position.x=0,a.current.position.y=b-x;const M=er(v/S,1,10);o.current.position.x=v-S*M,o.current.position.y=0,o.current.scale.setScalar(M);const R=.125,{focusx:I,focusy:k,focuslx:P,focusly:U}=c.current.userData;let V=I+.25,$=k+.5;V+=c.current.userData.focusvx,$+=c.current.userData.focusvy,V*=-Kt.DRAW_CHAR_WIDTH(),$*=-Kt.DRAW_CHAR_HEIGHT(),c.current.userData.focuslx=_.focusx,c.current.userData.focusly=_.focusy,jA(r.current.scale,GRt(_.viewscale),R,g),dZ(s.current.rotation,[0,0,0],R,g),jA(c.current.position,[V,$,0],R,g),ph(c.current.userData,"focusx",_.focusx,R),ph(c.current.userData,"focusy",_.focusy,R),ph(c.current.userData,"focusvx",0,R*5),ph(c.current.userData,"focusvy",0,R*5),s.current.rotation.z=_.facing}),jr(p=>{var g;return((g=p.gadget.over)==null?void 0:g.length)??0}),jr(p=>{var g;return((g=p.gadget.under)==null?void 0:g.length)??0}),jr(p=>{var g;return((g=p.gadget.layers)==null?void 0:g.length)??0});const{over:l=[],under:u=[],layers:h=[]}=jr.getState().gadget,d=u.length*2+2,f=d+2;return be.jsxs(be.Fragment,{children:[be.jsxs("group",{"position-z":d,children:[h.map(p=>be.jsx(J8,{id:p.id,from:"layers"},`media${p.id}`)),be.jsxs(AZ,{viewwidth:n,viewheight:i,children:[be.jsx(VSe,{makeDefault:!0,manual:!0,near:1,far:2e3,position:[0,0,1e3]}),be.jsx("group",{rotation:[Math.PI*.25,0,Math.PI*-.25],children:be.jsx("group",{ref:r,children:be.jsx("group",{ref:s,children:be.jsx("group",{ref:c,children:h.map(p=>be.jsx(HRt,{id:p.id,from:"layers",z:VRt(p)},p.id))})})})})]})]}),be.jsx("group",{ref:o,children:u.map((p,g)=>be.jsx(S_,{from:"under",id:p.id,z:g*2},p.id))}),be.jsx("group",{ref:a,"position-z":f,children:l.map((p,g)=>be.jsx(S_,{from:"over",id:p.id,z:g*2},p.id))})]})}function $Rt({id:t,z:e,from:n}){const i=jr(Cu(r=>{var s;return(s=r.gadget[n])==null?void 0:s.find(a=>a.id===t)}));switch(i==null?void 0:i.type){default:case ks.BLANK:case ks.MEDIA:return null;case ks.TILES:return be.jsx("group",{position:[0,0,e],children:be.jsx(pP,{width:i.width,height:i.height,char:[...i.char],color:[...i.color],bg:[...i.bg]})},i.id);case ks.SPRITES:return be.jsx("group",{position:[0,0,e],children:be.jsx(X8,{sprites:[...i.sprites],withbillboards:!0,fliptexture:!1})},i.id);case ks.DITHER:{const r=new Array((i.width+2)*(i.height+2)).fill(0);for(let a=1;a<kn-1;++a){const o=i.alphas[rh({x:1+a,y:0},kn)],c=i.alphas[rh({x:1+a,y:ur-1},kn)];r[rh({x:1+a,y:0},kn+2)]=o,r[rh({x:1+a,y:ur},kn+2)]=c}for(let a=1;a<ur-1;++a){const o=i.alphas[rh({x:0,y:1+a},kn)],c=i.alphas[rh({x:kn-1,y:1+a},kn)];r[rh({x:0,y:1+a},kn+2)]=o,r[rh({x:kn,y:1+a},kn+2)]=c}const s=Kt.DRAW_CHAR_HEIGHT();return be.jsxs(be.Fragment,{children:[be.jsx("group",{position:[0,0,e],children:be.jsx(E_,{width:i.width,height:i.height,alphas:[...i.alphas]})},`under${i.id}`),be.jsx("group",{position:[0,0,e+s],children:be.jsx(E_,{width:i.width,height:i.height,alphas:[...i.alphas]})},`mid${i.id}`),be.jsx("group",{position:[0,0,e+s],children:be.jsx(E_,{width:i.width+2,height:i.height+2,alphas:r})},`over${i.id}`)]})}}}function WRt(t){switch(t){case Sc.NEAR:return 160;default:case Sc.MID:return 320;case Sc.FAR:return 768}}function YRt(t){switch(t){case Sc.NEAR:return .888;default:case Sc.MID:return .777;case Sc.FAR:return .444}}function KRt(t){switch(t){case Sc.NEAR:return 4;default:case Sc.MID:return 6;case Sc.FAR:return 5}}function XRt(t){switch(t){case Sc.NEAR:return 4.6;default:case Sc.MID:return 6.5;case Sc.FAR:return 8}}function ZRt(t){switch(t){case Sc.NEAR:return 5.5;default:case Sc.MID:return 4.5;case Sc.FAR:return 6}}function JRt({width:t,height:e}){const n=t*Kt.DRAW_CHAR_WIDTH(),i=e*Kt.DRAW_CHAR_HEIGHT(),r=De.useRef(null),s=De.useRef(null),a=De.useRef(null),o=De.useRef(null),c=De.useRef(null);Pm((p,g)=>{if(!r.current||!s.current||!a.current||!o.current||!c.current)return;const _=cA(jr.getState().gadget.layers??[]),v=t*Kt.DRAW_CHAR_WIDTH(),b=e*Kt.DRAW_CHAR_HEIGHT(),S=kn*Kt.DRAW_CHAR_WIDTH(),x=ur*Kt.DRAW_CHAR_HEIGHT();re(o.current.userData.focusx)||(o.current.userData={focusx:_.focusx,focusy:_.focusy,focuslx:_.focusx,focusly:_.focusy,focusvx:0,focusvy:0,facing:_.facing}),s.current.position.x=0,s.current.position.y=b-x;const M=er(v/S,1,10);a.current.position.x=v-S*M,a.current.position.y=0,a.current.scale.setScalar(M);const R=.125,{focusx:I,focusy:k,focuslx:P,focusly:U}=o.current.userData,V=_.focusx-P,$=_.focusy-U,q=.1,Y=KRt(_.viewscale)*q,te=XRt(_.viewscale)*q,G=ZRt(_.viewscale)*q;$<0?(o.current.userData.focusvx=0,o.current.userData.focusvy-=te):$>0?(o.current.userData.focusvx=0,o.current.userData.focusvy+=G):V<0?(o.current.userData.focusvx-=Y,o.current.userData.focusvy=0):V>0&&(o.current.userData.focusvx+=Y,o.current.userData.focusvy=0);let J=I+1,K=k+1;J+=o.current.userData.focusvx,K+=o.current.userData.focusvy,J*=-Kt.DRAW_CHAR_WIDTH(),K*=-Kt.DRAW_CHAR_HEIGHT(),o.current.userData.focuslx=_.focusx,o.current.userData.focusly=_.focusy,jA(c.current.position,[0,0,WRt(_.viewscale)],R,g),dZ(r.current.rotation,[YRt(_.viewscale),0,0],R,g),jA(o.current.position,[J,K,0],R,g),ph(o.current.userData,"focusx",_.focusx,R),ph(o.current.userData,"focusy",_.focusy,R),ph(o.current.userData,"focusvx",0,R*5),ph(o.current.userData,"focusvy",0,R*5),r.current.rotation.z=_.facing}),jr(p=>{var g;return((g=p.gadget.over)==null?void 0:g.length)??0}),jr(p=>{var g;return((g=p.gadget.under)==null?void 0:g.length)??0}),jr(p=>{var g;return((g=p.gadget.layers)==null?void 0:g.length)??0});const{over:l=[],under:u=[],layers:h=[]}=jr.getState().gadget,d=u.length*2+2,f=d+2;return be.jsxs(be.Fragment,{children:[be.jsxs("group",{"position-z":d,children:[h.map(p=>be.jsx(J8,{id:p.id,from:"layers"},`media${p.id}`)),be.jsxs(AZ,{viewwidth:n,viewheight:i,children:[be.jsx(GSe,{ref:c,makeDefault:!0,manual:!0,near:1,far:2e3,aspect:n/i}),be.jsx("group",{ref:r,children:be.jsx("group",{ref:o,children:h.map(p=>be.jsx($Rt,{id:p.id,from:"layers",z:p.type===ks.TILES&&p.tag==="tickers"?Kt.DRAW_CHAR_HEIGHT():0},p.id))})})]})]}),be.jsx("group",{ref:a,children:u.map((p,g)=>be.jsx(S_,{from:"under",id:p.id,z:g*2},p.id))}),be.jsx("group",{ref:s,"position-z":f,children:l.map((p,g)=>be.jsx(S_,{from:"over",id:p.id,z:g*2},p.id))})]})}function XS(t,e,n){let i=0;n.alt&&(i|=Z9),n.ctrl&&(i|=J9),n.shift&&(i|=Q9),o1(t)&&gme(Ye,t,e,i)}function QRt({width:t,height:e}){const n=Gi();jr(s=>{var a;return((a=s.gadget.layers)==null?void 0:a.length)??0}),jr(s=>cA(s.gadget.layers??[]).graphics);const{layers:i=[]}=jr.getState().gadget,r=cA(i);return be.jsxs(be.Fragment,{children:[be.jsx(nl,{MOVE_LEFT:s=>XS(n,Ft.MOVE_LEFT,s),MOVE_RIGHT:s=>XS(n,Ft.MOVE_RIGHT,s),MOVE_UP:s=>XS(n,Ft.MOVE_UP,s),MOVE_DOWN:s=>XS(n,Ft.MOVE_DOWN,s),OK_BUTTON:s=>XS(n,Ft.OK_BUTTON,s),CANCEL_BUTTON:s=>XS(n,Ft.CANCEL_BUTTON,s),MENU_BUTTON:s=>XS(n,Ft.MENU_BUTTON,s),keydown:s=>{const a=Wn(s.key),o=vP(s),c=Gi();switch(a){case"t":W4e(Ye,c);break;case"p":o.ctrl&&u6e(Ye,c);break;case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":o.ctrl&&h6e(Ye,c,parseFloat(a));break}}}),r.graphics==="flat"&&be.jsx(DRt,{width:t,height:e}),r.graphics==="mode7"&&be.jsx(JRt,{width:t,height:e}),r.graphics==="iso"&&be.jsx(qRt,{width:t,height:e}),r.graphics==="fpv"&&be.jsx(jRt,{width:t,height:e})]})}function Voe({rect:t,islandscape:e=!0,sidebaropen:n=!0,shouldclose:i=!1}){switch(t.type){case 0:return be.jsx("group",{"position-z":512,children:be.jsx(bZ,{name:t.name,width:t.width,height:t.height,color:14,bg:1,text:t.text,xmargin:e?1:n?3:10,ymargin:e&&!n?6:0})});case 1:return be.jsx(PAt,{name:t.name,width:t.width,height:t.height,color:14,bg:1,text:t.text,shouldclose:i});case 2:return be.jsx(QRt,{width:t.width,height:t.height})}return null}const Tw=20;function eMt(){const t=K8(),{islandscape:e,sidebaropen:n,insetrows:i,showtouchcontrols:r}=od(),s=jr(one(p=>p.gadget.scroll??[])),a=s.length===0,[o,c]=De.useState(!1),l=jr(one(p=>p.gadget.sidebar??[]));if(t.cols<10||t.rows<10)return null;const u={name:"main",type:2,x:0,y:0,text:[],width:t.cols,height:t.rows},h=[];if(l.length)if(r)if(e){const p=n?Tw+5:Tw,g=n?Tw:4,_={name:"sidebar",type:0,x:u.x+u.width-g,y:u.y,width:p,height:u.height,text:l};u.width-=g,h.push(_)}else{const p=n?i-7:i,g=n?p:4,_={name:"sidebar",type:0,x:0,y:u.y+u.height-g,width:u.width,height:p,text:l};u.height-=g,h.push(_)}else{const p={name:"sidebar",type:0,x:u.x+u.width-Tw,y:u.y,width:Tw,height:u.height,text:l};u.width-=Tw,h.push(p)}const d={name:"scroll",type:1,x:0,y:0,width:er(50,24,u.width-2),height:er(18,8,u.height-8),text:s};d.x=u.x+Math.floor((u.width-d.width)*.5),d.y=u.y+Math.floor((u.height-d.height)*.5),!a&&!o&&c(!0),h.unshift(u);const f=Gi();return be.jsxs(Q_.Provider,{value:{sendmessage(p,g){Ye.emit(f,p,g)},sendclose(){I4e(Ye,f)},didclose(){c(!1)}},children:[be.jsx("group",{position:[-Kt.DRAW_CHAR_WIDTH(),-Kt.DRAW_CHAR_HEIGHT(),-524],children:be.jsx(of,{visible:!0,color:new bn(.076,.076,0),width:t.cols+2,height:t.rows+2})}),be.jsx("group",{position:[0,0,-512],children:h.map(p=>be.jsx("group",{position:[p.x*Kt.DRAW_CHAR_WIDTH(),p.y*Kt.DRAW_CHAR_HEIGHT(),0],children:be.jsx(Voe,{islandscape:!r||e,sidebaropen:!r||n,rect:p})},p.name))}),o&&be.jsxs(Sm.Fragment,{children:[be.jsx("group",{position:[0,0,800],children:be.jsx(KCt,{width:t.cols,height:t.rows,alpha:.14})}),be.jsx("group",{position:[d.x*Kt.DRAW_CHAR_WIDTH(),d.y*Kt.DRAW_CHAR_HEIGHT(),900],children:be.jsx(Voe,{rect:d,shouldclose:a})})]},"scroll")]})}const tMt=250,nMt=249,BB=qt.BLUE,iMt=qt.WHITE,rMt=qt.DKGRAY,RZ=qt.BLACK;function RR(t){return t?qt.ONCLEAR:qt.DKBLUE}const m1e=De.createContext({sendmessage(){}});function $T(t,e,n,i,r){const s=w0(r);r.iseven=r.y%2===0,r.active.bg=e&&!t?RZ:r.reset.bg,r.active.leftedge=s.left,r.active.rightedge=s.right,r.active.topedge=s.top,r.active.bottomedge=s.bottom,r.x=r.active.leftedge+n,r.y=r.active.topedge+i}function fT(t,e,n,i,r,s,a,o){const c=w0(r);r.iseven=r.y%2===0,r.active.color=qt.WHITE,r.active.bg=r.reset.bg,r.active.leftedge=c.left+s,r.active.rightedge=c.right-s,r.active.topedge=c.top+a,r.active.bottomedge=c.bottom-o,r.x=r.active.leftedge+n,r.y=r.active.topedge+i}function sMt(t){let e=0;return t.split(/\r?\n/).map(i=>{const r=e,s=`${i}
`;return e+=s.length,{start:r,code:s,end:r+i.length}})}function aMt(t){return t.reduce((e,n)=>{const i=n.code.length;return i>e?i:e},0)}function oMt(t,e){for(let n=0;n<e.length;++n)if(t<=e[n].end)return n;return 0}function MZ({bump:t}){const e=Pp(),n=w0(e),{quickterminal:i}=As(),r=RR(i);if(t&&n.top++,i){for(let s=n.top;s<=n.bottom;++s)for(let a=n.left;a<=n.right;++a)gc(e,e.width,e.height,a,s,{char:0,color:BB,bg:r});return null}for(let s=n.top;s<=n.bottom;++s)for(let a=n.left;a<=n.right;++a){let o=0;(a+s)%2===0&&(o=Math.abs(Math.round(Math.cos(a*s*.01)))?tMt:nMt),gc(e,e.width,e.height,a,s,{char:o,color:BB,bg:r})}return null}const TV=qt.WHITE,DO=qt.GREEN,Go=qt.YELLOW,cMt=qt.CYAN,Qd=qt.DKGREEN,Goe=qt.DKCYAN,lMt=qt.GREEN,DL=qt.DKPURPLE,g1e=qt.WHITE,uMt=qt.LTGRAY,hMt=qt.DKGRAY,qoe=qt.DKRED,dMt=qt.DKRED,xV=qt.DKYELLOW,fMt={[gA.tokenTypeIdx??0]:TV,[x0e.tokenTypeIdx??0]:TV,[w0e.tokenTypeIdx??0]:TV,[p1.tokenTypeIdx??0]:DL,[Zv.tokenTypeIdx??0]:Go,[FN.tokenTypeIdx??0]:DO,[zN.tokenTypeIdx??0]:cMt,[jN.tokenTypeIdx??0]:dMt,[HN.tokenTypeIdx??0]:Go,[DY.tokenTypeIdx??0]:Go,[Ol.tokenTypeIdx??0]:DO,[LY.tokenTypeIdx??0]:DO,[UY.tokenTypeIdx??0]:g1e,[BY.tokenTypeIdx??0]:Go,[FY.tokenTypeIdx??0]:Go,[zY.tokenTypeIdx??0]:Go,[jY.tokenTypeIdx??0]:Go,[HY.tokenTypeIdx??0]:Go,[VY.tokenTypeIdx??0]:Go,[D3.tokenTypeIdx??0]:xV,[L3.tokenTypeIdx??0]:xV,[U3.tokenTypeIdx??0]:xV,[B3.tokenTypeIdx??0]:Go,[F3.tokenTypeIdx??0]:Go,[GY.tokenTypeIdx??0]:Go,[qY.tokenTypeIdx??0]:Go,[BT.tokenTypeIdx??0]:Go,[$Y.tokenTypeIdx??0]:Go,[WY.tokenTypeIdx??0]:Go,[VN.tokenTypeIdx??0]:Go,[YY.tokenTypeIdx??0]:Go,[KY.tokenTypeIdx??0]:Go,[XY.tokenTypeIdx??0]:lMt,[FT.tokenTypeIdx??0]:Qd,[zT.tokenTypeIdx??0]:Goe,[z3.tokenTypeIdx??0]:Goe,[jT.tokenTypeIdx??0]:Qd,[ZY.tokenTypeIdx??0]:Qd,[JY.tokenTypeIdx??0]:Qd,[QY.tokenTypeIdx??0]:Qd,[eK.tokenTypeIdx??0]:Qd,[tK.tokenTypeIdx??0]:Qd,[nK.tokenTypeIdx??0]:Qd};qt.DKPURPLE;const pMt=qt.DKYELLOW,mMt=qt.DKPURPLE,gMt=qt.CYAN,vMt=qt.DKCYAN,_Mt=qt.RED,yMt=qt.WHITE,bMt=qt.LTGRAY,v1e=new Map;function wg(t,e){v1e.set(t,e)}function $oe(t){const e=[];let n=0;for(let i=0;i<t.length;++i){switch(t[i]){case";":n=0;break;case" ":break;default:n===0&&(n=1);break;case"#":n===0&&(n=2);break}switch(n){case 0:e.push(qt.LTGRAY);break;case 1:e.push(TMt(t[i]));break;case 2:e.push(qt.CYAN);break}}return e.push(qt.BLUE),e}function EMt(t){if(t.startsWith("play ")){const e=new Array(5).fill(Qd);return e.push(...$oe(t.slice(5))),e}else if(t.startsWith("bgplay ")){const e=new Array(7).fill(Qd);return e.push(...$oe(t.slice(7))),e}return v1e.get(t)??qt.GREEN}const lx=qt.GREEN,SMt=qt.DKGREEN,N0=qt.PURPLE,ux=qt.DKCYAN,_1e=qt.CYAN,y1e=qt.YELLOW,b1e=qt.DKYELLOW,E1e=new Map;function hs(t,e){E1e.set(t,e)}function TMt(t){return E1e.get(t)??qt.GREEN}function xMt(){const t=Pp(),e=w0(t),[n,i,r]=As(Cu(v=>[v.quickterminal,v.editor.type,v.editor.title])),s=qt.WHITE,a=RR(n);for(let v=e.top;v<e.bottom;++v)gc(t,t.width,t.height,e.left,v,{char:179,color:s,bg:a}),gc(t,t.width,t.height,e.right,v,{char:179,color:s,bg:a});fT(!1,!1,0,0,t,0,0,0),oi("$213$205$187",t,!0),fT(!1,!1,t.width-3,0,t,0,0,0),oi("$196$196$191",t,!0);const o="$205".repeat(e.width-2);fT(!1,!1,0,e.height-1,t,0,0,0),oi(`$212${o}$190`,t,!0);const c=bf(),l="$205".repeat(e.width-4);fT(!1,!1,0,1,t,0,0,0),oi(`$179$${c?"7":"232"}$200${l}$181`,t,!0);const h=` ${`$blue[${i}] `}$green${r}$white `,d=Ik(h,e.width,e.height),f=(d==null?void 0:d.measuredwidth)??1,p=e.width-2,g=2+Math.round(p*.5)-Math.round(f*.5);fT(!1,!1,g,1,t,0,0,0),oi(h,t,!0);const _=gE?`shift+${qf}+z`:`${qf}+y`;return be.jsx(EZ,{margin:3,color:qt.BLUE,y:e.top,leftedge:0,rightedge:e.width-1,line:`
    esc/cancel$white.CLOSE   $blue
    tab$white.CHANGE LAYOUT   $blue
    hold shift$white.SELECT TEXT   $blue
    alt+up/down$white.JUMP 10 LINES   $blue
    alt+left/right$white.JUMP 10 COLS   $blue
    ${qf}+up/down$white.JUMP TOP/BOTTOM   $blue
    ${qf}+left/right$white.JUMP TO START/END OF LINE   $blue
    ${qf}+a$white.SELECT ALL   $blue
    ${qf}+c$white.COPY   $blue
    ${qf}+x$white.CUT   $blue
    ${qf}+v$white.PASTE   $blue
    ${qf}+z$white.UNDO   $blue
    ${_}$white.REDO   $blue
    ${qf}+p$white.TEST SELECTED CODE   $blue
    ${qf}+k$white.OPEN REFSCROLL   $blue
    ${qf}+e$white.COPY CODEPAGE TO CLIPBOARD AS JSON   $blue
    `,context:t})}const wMt=t=>{const e="nativeEvent"in t?t.nativeEvent:t;return{deltaX:e.deltaX||0,deltaY:e.deltaY||0,deltaZ:e.deltaZ||0,timeStamp:e.timeStamp}},CMt=t=>[t.deltaX,t.deltaY,t.deltaZ],R2=t=>{const e=CMt(t).map(Math.abs);return Math.max(...e)};var ub;(function(t){t.ALL_OTHER_CHECKS_FAILED="ALL_OTHER_CHECKS_FAILED",t.NO_PREVIOUS_EVENT_TO_COMPARE="NO_PREVIOUS_EVENT_TO_COMPARE",t.PAST_TIMESTAMP_EVENT="PAST_TIMESTAMP_EVENT",t.ENOUGH_TIME_PASSED="ENOUGH_TIME_PASSED",t.NON_DECREASING_DELTAS_OF_KNOWN_HUMAN="NON_DECREASING_DELTAS_OF_KNOWN_HUMAN",t.DELTA_MODULE_HAS_BEEN_INCREASING="DELTA_MODULE_HAS_BEEN_INCREASING"})(ub||(ub={}));class AMt{constructor({sensitivity:e=2,delay:n=100,increasingDeltasThreshold:i=3}={}){fi(this,"sensitivity");fi(this,"delay");fi(this,"increasingDeltasThreshold");fi(this,"previousEvents");this.sensitivity=Math.max(1,e),this.delay=Math.max(1,n),this.increasingDeltasThreshold=Math.max(2,i),this.previousEvents=[]}check(e){var s;if(!(("nativeEvent"in e?e.nativeEvent:e)instanceof Event))throw new Error(`"${e}" is not a valid event`);const i=wMt(e);if(R2(i)<this.sensitivity)return!1;const{isHuman:r}=this.isHuman(i);return r?this.previousEvents=[i]:i.timeStamp>(((s=this.previousEvents.at(-1))==null?void 0:s.timeStamp)||0)&&this.previousEvents.push(i),r}isHuman(e){const n=this.previousEvents.at(-1);if(!n)return{isHuman:!0,reason:ub.NO_PREVIOUS_EVENT_TO_COMPARE};if(e.timeStamp<n.timeStamp)return{isHuman:!1,reason:ub.PAST_TIMESTAMP_EVENT};if(e.timeStamp>n.timeStamp+this.delay)return{isHuman:!0,reason:ub.ENOUGH_TIME_PASSED};const s=R2(e),a=R2(n);if(s>=a){if(this.previousEvents.length===1)return{isHuman:!0,reason:ub.NON_DECREASING_DELTAS_OF_KNOWN_HUMAN};if(this.increasingDeltasThreshold<=2||this.previousEvents.length>=this.increasingDeltasThreshold&&this.previousEvents.slice(-this.increasingDeltasThreshold).map(R2).every((u,h,d)=>h===0||u>d[h-1]))return{isHuman:!0,reason:ub.DELTA_MODULE_HAS_BEEN_INCREASING}}return{isHuman:!1,reason:ub.ALL_OTHER_CHECKS_FAILED}}}const RMt=new AMt({sensitivity:gE?7:2}),Woe=4,MMt=.75;function OMt(t){const e=er(t,-Woe,Woe);return Math.round(e*MMt)}function S1e({debug:t=!1,disabled:e=!1,blocking:n=!0,cursor:i="pointer",x:r=0,y:s=0,width:a=30,height:o=10,children:c,onScroll:l,...u}){return be.jsxs("group",{...u,children:[be.jsx(of,{blocking:n,cursor:i,visible:t,x:r,y:s,width:a,height:o,onWheel:h=>{e||!RMt.check(h)||l==null||l(OMt(h.deltaY))}}),c]})}function NMt({xcursor:t,ycursor:e,xoffset:n,yoffset:i,rows:r,codepage:s}){var Y,te;const a=bf(),o=Pp(),c=De.useRef(void 0),l=So(),u=w0(o),h=As(G=>G.editor.path),d=Gi(),f=re(s)?s.toJSON():"",p=r.length-1,g=t+1-n,_=e+2-i;if(re(s)){const G=((Y=c.current)==null?void 0:Y.x)!==g||((te=c.current)==null?void 0:te.y)!==_;if(a||G){const J=u.left+g,K=u.top+_;if(K>u.top+1&&K<u.bottom&&J>u.left&&J<u.right){const X=J+K*o.width;I4(X,"",o),wA(X,X,qt.WHITE,qt.DKBLUE,o)}}}c.current={x:g,y:_};const v=r[p].end,b=r[e];let S=l.cursor,x=l.cursor,M=!1;re(l.select)&&(M=!0,S=Math.min(l.cursor,l.select),x=Math.max(l.cursor,l.select),l.cursor!==l.select&&--x);const R=x-S+1,I=M?f.substring(S,x+1):f;function k(G){G?re(l.select)||So.setState({select:l.cursor}):So.setState({select:void 0})}function P(G,J,K){J>0&&(s==null||s.delete(G,J)),re(K)&&(s==null||s.insert(G,K)),So.setState({cursor:G+(K??"").length,select:void 0})}function U(){re(l.select)&&(So.setState({cursor:S}),P(S,R))}function V(){So.setState({cursor:v,select:void 0})}const $=De.useCallback(function(J){const K=Math.round(e+J);if(K<0)So.setState({cursor:0});else if(K>p)So.setState({cursor:v});else{const X=r[K];So.setState({cursor:X.start+Math.min(t,X.code.length-1)})}},[v,r,p,t,e]),q=De.useMemo(()=>s?new oYe(s):void 0,[s]);return De.useEffect(()=>{function G(K){K.stackItem.meta.set("cursor",l.cursor)}function J(K){if(K.stackItem.meta.has("cursor")){const X=K.stackItem.meta.get("cursor");So.setState({cursor:X})}}return q==null||q.on("stack-item-added",G),q==null||q.on("stack-item-popped",J),()=>{q==null||q.off("stack-item-added",G),q==null||q.off("stack-item-popped",J)}},[q,l.cursor]),be.jsxs(be.Fragment,{children:[be.jsx(S1e,{blocking:!0,x:u.left,y:u.top,width:u.width,height:u.height,onScroll:G=>$(G*.75)}),be.jsx(nl,{keydown:G=>{if(!re(s))return;const{key:J}=G,K=Wn(J),X=vP(G);switch(K){case"arrowleft":if(k(X.shift),X.ctrl)So.setState({cursor:b.start});else{const ae=l.cursor-(X.alt?10:1);So.setState({cursor:er(ae,0,v)})}break;case"arrowright":if(k(X.shift),X.ctrl)So.setState({cursor:b.end});else{const ae=l.cursor+(X.alt?10:1);So.setState({cursor:er(ae,0,v)})}break;case"arrowup":k(X.shift),X.ctrl?So.setState({cursor:0}):$(X.alt?-10:-1);break;case"arrowdown":k(X.shift),X.ctrl?So.setState({cursor:v}):$(X.alt?10:1);break;case"enter":re(s)&&(s.insert(l.cursor,`
`),So.setState({cursor:l.cursor+1}));break;case"esc":case"escape":X.shift||X.alt||X.ctrl?_3(Ye,d):X4e(Ye,d);break;case"tab":fme(Ye,d,!X.shift);break;case"delete":M?U():P(l.cursor,1);break;case"backspace":M?U():f.length>0&&P(Math.max(l.cursor-1,0),1);break;default:if(X.ctrl)switch(K){case"e":s6e(Ye,d,h);break;case"k":a6e(Ye,d);break;case"z":gE&&X.shift?q==null||q.redo():q==null||q.undo();break;case"y":gE||q==null||q.redo();break;case"a":So.setState({cursor:v,select:0});break;case"c":re(za())?za().writeText(I).catch(ae=>Mi(Ye,d,"clipboard",ae)):V();break;case"v":re(za())?za().readText().then(ae=>{const ce=ae.replaceAll("\r","");M?P(S,R,ce):P(l.cursor,0,ce)}).catch(ae=>Mi(Ye,d,"clipboard",ae)):V();break;case"x":re(za())?za().writeText(I).then(()=>U()).catch(ae=>Mi(Ye,d,"clipboard",ae)):V();break;case"p":o_(Ye,d,I),xr(Ye,d,`running $WHITE${I.substring(0,16)}...$BLUE`);break}else if(!X.alt){if(J.length===1)if(M)P(S,R,J);else{const ae=l.cursor+J.length;s.insert(l.cursor,J),So.setState({cursor:ae})}}break}}})]})}function Yoe(t){const[e]=t.substring(1).split(";");return e.split(" ")}let Pw;function am(t){const e=tQe(jve(t));Object.keys(e).length&&(Pw=e)}function IMt({ycursor:t,xoffset:e,yoffset:n,rows:i,codepage:r}){var _;const s=bf(),a=Pp(),o=So(),{quickterminal:c}=As(),l=De.useMemo(()=>{if(i.length){const v=i[i.length-1];return[...i,{code:"",start:v.end+1,end:v.end+1}]}return[]},[i]);if(!re(r)){const v=(s?"|":"-").repeat(3);return fT(!1,!1,0,0,a,1,2,1),oi(` ${v} LOADING ${v}`,a,!0),null}const u=a.width-2,h=w0(a);h.right=u-1;let d=o.cursor,f=o.cursor,p=!1;re(o.select)&&(p=!0,d=Math.min(o.cursor,o.select),f=Math.max(o.cursor,o.select),o.cursor!==o.select&&--f);const g=h.left+1-4;fT(!1,!1,-e,-n,a,1,2,1);for(let v=0;v<l.length;++v){if(a.y<=h.top+1){++a.y;continue}const b=l[v],S=l[v-1],x=v===t,M=v-1===t,R=b.code.replaceAll(`
`,""),I=g-e;a.x=I,a.iseven=a.y%2===0,a.active.bg=x?RZ:RR(c),a.disablewrap=!0,a.active.rightedge=u;const[k]=b.errors??[],P=`${v+1}`.padStart(3," ");g$(`${v<i.length?P:"   "} ${R} `,a,!1);const U=1+a.y*a.width;Gf(U,h.right,-e-3,-e,uMt,a.active.bg,a);let V=-1;const $=er(o.cursor-b.start,1,b.end-b.start);if(re(b.tokens))for(let q=0;q<b.tokens.length;++q){const Y=b.tokens[q];x&&$>=(Y.startColumn??1)&&$<=(Y.endColumn??1)&&(V=q);const te=(Y.startColumn??1)-1-e,G=(Y.endColumn??1)-1-e,J=fMt[Y.tokenTypeIdx];if(re(J))switch(J){case DL:{const K=Yoe(Y.image);switch(Xq("",K,!!Y.payload).type){case gn.BOARD:case gn.LOADER:case gn.OBJECT:case gn.TERRAIN:case gn.CHARSET:case gn.PALETTE:{Gf(U,h.right,te,G,DL,a.active.bg,a);break}case gn.CONST:case gn.RANGE:case gn.SELECT:case gn.NUMBER:case gn.TEXT:case gn.HOTKEY:case gn.COPYIT:case gn.OPENIT:case gn.ZSSEDIT:case gn.CHAREDIT:case gn.COLOREDIT:{const[ae]=K;Gf(U,h.right,te,te+ae.length,DL,a.active.bg,a),K.length>1&&Gf(U,h.right,te+ae.length+1,G,g1e,a.active.bg,a);break}default:Gf(U,h.right,te,G,qt.DKRED,a.active.bg,a);break}break}case Go:{Gf(U,h.right,te,te,J,a.active.bg,a),te!==G&&Gf(U,h.right,te+1,G,DO,a.active.bg,a);break}case DO:{const K=EMt(Y.image);if(ji(K))for(let X=0;X<K.length;++X)Gf(U,h.right,te+X,G+X,K[X],a.active.bg,a);else Gf(U,h.right,te,G,K,a.active.bg,a);break}default:Gf(U,h.right,te,G,J,a.active.bg,a);break}}if(p&&b.start<=f&&b.end>=d){const q=Math.max(b.start,d)-b.start-e,Y=Math.min(b.end,f)-b.start-e,te=h.width-3,G=Math.max(0,q),J=Math.min(te,Y);G<=te&&J>=g&&Gf(U,h.right,G,J,iMt,rMt,a)}if(x&&re(b.tokens)){let q;if(re(b.asts)){for(let Y=0;Y<(((_=b.asts)==null?void 0:_.length)??0);++Y)b.asts[Y].type===mn.IF&&(q=b.asts[Y]);re(q)||(q=b.asts.find(Y=>$<=(Y.endColumn??0)))}Pw=void 0;for(let Y=V;Y>=0;--Y){const te=b.tokens[Y-1],G=b.tokens[Y],J=b.tokens[Y+1];switch(G.tokenTypeIdx){case Zv.tokenTypeIdx:case zT.tokenTypeIdx:case FT.tokenTypeIdx:case jT.tokenTypeIdx:case p1.tokenTypeIdx:case jN.tokenTypeIdx:case zN.tokenTypeIdx:case HN.tokenTypeIdx:case VN.tokenTypeIdx:case BT.tokenTypeIdx:case FN.tokenTypeIdx:if(G.tokenTypeIdx===BT.tokenTypeIdx&&(!re(q)||G.startColumn!==q.startColumn))continue;break;default:continue}switch(G.tokenTypeIdx){case Zv.tokenTypeIdx:{am(`editor:command:${J.image}`);break}case zT.tokenTypeIdx:{am("editor:command:do");break}case FT.tokenTypeIdx:{am(te.tokenTypeIdx===jT.tokenTypeIdx?"editor:command:elseif":"editor:command:if");break}case jT.tokenTypeIdx:{am(J.tokenTypeIdx===FT.tokenTypeIdx?"editor:command:elseif":"editor:command:else");break}case p1.tokenTypeIdx:{const K=Yoe(G.image),X=Xq("",K,!!G.payload);am(`editor:stat:${Qh(X.type)}`);break}case jN.tokenTypeIdx:{am("editor:label");break}case zN.tokenTypeIdx:{am("editor:comment");break}case HN.tokenTypeIdx:{am("editor:hyperlink");break}case VN.tokenTypeIdx:{am("editor:shorttry");break}case BT.tokenTypeIdx:{am("editor:shortgo");break}case FN.tokenTypeIdx:{am("editor:text");break}}break}Tn(Pw==null?void 0:Pw.desc)&&oi(Pw.desc,a,!1)}if(M&&re(S.errors)){a.x=I;const[q]=S.errors,Y=`${q.message}`.replaceAll(`
`," ");g$(Y,a,!1),Gf(U,h.right,0,Y.length-1,qt.WHITE,qoe,a)}else if(re(k)){const q=3+(k.column??1),Y=k.length??1;Lre(U,h.right,0,2,qoe,a),Lre(U,h.right,q,q+Y-1,hMt,a)}if(++a.y,a.y>=h.bottom)break}return a.disablewrap=!1,a.active.rightedge=a.width,null}function wV(t){switch(t){case"stat":case"text":case"hyperlink":return!1;default:return!0}}hs("a",lx);hs("b",lx);hs("c",lx);hs("d",lx);hs("e",lx);hs("f",lx);hs("g",lx);hs("x",SMt);hs("#",b1e);hs("!",b1e);hs("y",ux);hs("t",ux);hs("s",ux);hs("i",ux);hs("q",ux);hs("h",ux);hs("w",ux);hs("3",_1e);hs(".",_1e);hs("+",y1e);hs("-",y1e);hs("0",N0);hs("1",N0);hs("2",N0);hs("p",N0);hs("4",N0);hs("5",N0);hs("6",N0);hs("7",N0);hs("8",N0);hs("9",N0);hs(";",Go);function Koe(){var U;const t=Gi(),[e]=As(Cu(V=>[V.editor])),[n,i,r,s,a,o,c,l,u,h]=jr(Cu(V=>[V.zsswords.cli,V.zsswords.loader,V.zsswords.runtime,V.zsswords.flags,V.zsswords.stats,V.zsswords.kinds,V.zsswords.altkinds,V.zsswords.colors,V.zsswords.dirs,V.zsswords.dirmods]));De.useEffect(()=>{n.filter(wV).forEach(V=>wg(V,Qd)),i.filter(wV).forEach(V=>wg(V,Qd)),r.filter(wV).forEach(V=>wg(V,Qd)),s.forEach(V=>wg(V,pMt)),a.forEach(V=>wg(V,mMt)),o.forEach(V=>wg(V,gMt)),c.forEach(V=>wg(V,vMt)),l.forEach(V=>wg(V,_Mt)),u.forEach(V=>wg(V,yMt)),h.forEach(V=>wg(V,bMt))},[n,i,r,s,a,o,c,l,u,h]);const d=Pp(),f=So(),p=Dve(vme(e.book,e.path)),g=w0(d);De.useEffect(()=>(c6e(Ye,t,e.book,e.path),()=>{l6e(Ye,t,e.book,e.path)}),[e.book,e.path,t]);const _=re(p)?p.toJSON():"",v=sMt(_),b=oMt(f.cursor,v),S=f.cursor-v[b].start,x=aMt(v),M=f_e(_);if(re(M.tokens)){let V=!0;for(let $=0;$<M.tokens.length;++$){const q=M.tokens[$];q.tokenTypeIdx===p1.tokenTypeIdx&&(q.payload=V,V=!1);const Y=v[(q.startLine??1)-1];re(Y)&&(Y.tokens=Y.tokens??[],Y.tokens.push(q))}}if(((U=M==null?void 0:M.ast)==null?void 0:U.type)===mn.PROGRAM){h_e(M.ast);const V=[];for(let $=1;$<M.ast.lines.length;++$)V.push(M.ast.lines[$]);for(;V.length;){const $=V.pop();if(an($==null?void 0:$.type)){switch($.type){case mn.LINE:case mn.IF:if(an($.startLine)){const Y=v[$.startLine-1];Y.asts=Y.asts??[],Y.asts.unshift($)}break}const q=M_($);for(let Y=0;Y<q.length;++Y){const te=q[Y],G=$[te];ji(G)?V.push(...G):typeof G=="object"&&V.push(G)}}}}if(re(M.errors))for(let V=0;V<M.errors.length;++V){const $=M.errors[V],q=v[($.line??1)-1];re(q)&&(q.errors=q.errors??[],q.errors.push($))}const R={rows:v,xcursor:S,ycursor:b,codepage:p,xoffset:-4+f.xscroll,yoffset:f.yscroll},I=32,k=(Math.round(x/I)+1)*I,P=v.length;return De.useEffect(()=>{let V=f.xscroll;const $=S-V,q=g.width-3;let Y=Math.round(er(Math.abs($)*.5,1,I));Y<8&&(Y=1),$>q-8&&(V+=Y),$<8&&(V-=Y);let te=f.yscroll;const G=b-te,J=g.height-4,K=Math.round(J*.5);let X=Math.round(er(Math.abs(G)*.25,1,K));X<8&&(X=1),G>J-4&&(te+=X),G<4&&(te-=X),setTimeout(()=>So.setState({xscroll:Math.round(er(V,0,k)),yscroll:Math.round(er(te,0,P))}),16)},[S,k,f.xscroll,b,P,f.yscroll,g.width,g.height]),be.jsxs(be.Fragment,{children:[be.jsx(MZ,{bump:!0}),be.jsx(xMt,{}),be.jsx(IMt,{...R}),be.jsx(NMt,{...R})]})}function kMt({tapeycursor:t,logrowtotalheight:e}){const n=bf(),i=Pp(),{quickterminal:r}=As(),s=Vo(),a=Gi(),o=w0(i),c=s.buffer[s.bufferindex];let l=s.xcursor,u=s.xcursor,h=!1;re(s.xselect)&&re(s.yselect)&&(h=!0,l=Math.min(s.xcursor,s.xselect),u=Math.max(s.xcursor,s.xselect),s.xcursor!==s.xselect&&--u);const d=u-l+1,f=s.ycursor===0,p=h?c.substring(l,u+1):c;function g(k,P,U){s.bufferindex>0&&Vo.setState({bufferindex:0}),s.buffer[0]=oKe(c,k,P,U),Vo.setState({buffer:s.buffer,xselect:void 0,xcursor:k+(U??"").length})}function _(k){const P=s.buffer.length-1,U=er(k,0,P);Vo.setState({bufferindex:U,xcursor:s.buffer[U].length,ycursor:0,xselect:void 0,yselect:void 0})}function v(k){k?re(s.xselect)||Vo.setState({xselect:s.xcursor,yselect:s.ycursor}):Vo.setState({xselect:void 0,yselect:void 0})}function b(){re(s.xselect)&&(Vo.setState({xcursor:l,xselect:void 0,yselect:void 0}),g(l,d))}function S(){Vo.setState({xcursor:c.length,ycursor:0,xselect:void 0,yselect:void 0})}if(i.reset.bg=RR(r),!r){$T(!1,!1,0,0,i);const k="main:0.52.6 - if lost try #help";i.x=o.right-k.length,oi(`$dkcyan${k}`,i,!0)}const x="$196",R="$205".repeat(o.width-6);$T(!1,!1,0,o.height-2,i),i.active.color=qt.WHITE,oi(`  ${x}${R}${x}  `,i,!0);const I=c.padEnd(o.width," ");if($T(!1,!1,0,o.height-1,i),i.active.color=qt.WHITE,g$(I,i,!0),re(s.xselect)&&re(s.yselect)&&s.xcursor!==s.xselect){const k=Math.min(s.xcursor,s.xselect),P=Math.min(s.ycursor,s.yselect),U=Math.max(s.xcursor,s.xselect)-1,V=Math.max(s.ycursor,s.yselect);for(let $=P;$<=V;++$){const q=k+(o.bottom-$)*o.width,Y=U+(o.bottom-$)*o.width;wA(q,Y,15,8,i)}}if(n){const k=o.left+s.xcursor,P=o.top+t,U=k+P*i.width;I4(U,"",i),wA(U,U,15,i.reset.bg,i)}return De.useEffect(()=>{let k=s.scroll;t<4&&k++,t>o.bottom-4&&k--,Vo.setState({scroll:Math.round(er(k,0,e))})},[s.scroll,t,e,o.bottom]),be.jsxs(be.Fragment,{children:[be.jsx(S1e,{blocking:!0,x:o.left,y:o.top,width:o.width,height:o.height,onScroll:k=>{v(!1),Vo.setState({ycursor:er(Math.round(s.ycursor-k),0,e)})}}),be.jsx(nl,{keydown:k=>{const{key:P}=k,U=Wn(P),V=vP(k);switch(U){case"arrowleft":v(V.shift),V.ctrl?Vo.setState({xcursor:0}):Vo.setState({xcursor:er(s.xcursor-(V.alt?10:1),0,o.right)});break;case"arrowright":v(V.shift),V.ctrl?Vo.setState({xcursor:f?c.length:o.right}):Vo.setState({xcursor:er(s.xcursor+(V.alt?10:1),0,o.right)});break;case"arrowup":V.ctrl?_(s.bufferindex+1):(v(V.shift),Vo.setState({ycursor:er(Math.round(s.ycursor+(V.alt?10:1)),0,e)}));break;case"arrowdown":V.ctrl?_(s.bufferindex-1):(v(V.shift),Vo.setState({ycursor:er(Math.round(s.ycursor-(V.alt?10:1)),0,e)}));break;case"enter":{const $=h?p:c;if($.length)if(f){const q=["",$,...s.buffer.slice(1).filter(Y=>Y!==$)];T0t(q).catch(Y=>Mi(Ye,a,"input?",Y.message)),Vo.setState({xcursor:0,bufferindex:0,xselect:void 0,yselect:void 0,buffer:q}),o_(Ye,a,$),r&&_3(Ye,a)}else S();break}case"esc":case"escape":_3(Ye,a);break;case"tab":fme(Ye,a,!V.shift);break;case"delete":f?h?b():c.length>0&&g(s.xcursor,1):S();break;case"backspace":f?h?b():s.xcursor>0&&g(s.xcursor-1,1):S();break;default:if(V.ctrl)switch(U){case"e":o_(Ye,a,"#export");break;case"a":Vo.setState({xselect:0,yselect:0,xcursor:c.length,ycursor:0});break;case"c":f&&re(za())?za().writeText(p).catch($=>console.error($)):S();break;case"v":f&&re(za())?za().readText().then($=>{try{const Y=JSON.parse($);if(Tn(Y.exported)&&re(Y.data)){xm(Ye,a,void 0,"json",`file:${Y.exported}`,JSON.stringify(Y));return}}catch(Y){console.error(Y)}const q=$.replaceAll("\r","");h?g(l,d,q):g(s.xcursor,0,q)}).catch($=>console.error($)):S();break;case"x":f&&re(za())?za().writeText(p).then(()=>b()).catch($=>console.error($)):S();break}else V.alt||P.length===1&&(f&&s.xcursor<=c.length?h?(g(l,d,P),Vo.setState({xselect:void 0})):g(s.xcursor,0,P):S());break}}})]})}function PMt({blink:t,active:e,prefix:n,label:i,words:r,y:s}){const a=Pp(),o=De.useCallback(()=>{setTimeout(()=>{if(re(za())){const[,...l]=r,u=l.join(" ");za().writeText(u).then(()=>Hl(Ye,Gi(),"copied!")).catch(h=>console.error(h))}},100)},[r]),c=Hm(!!e);return $T(!!t,!!e,0,s,a),oi(`${n} $purple$16 $yellowCOPYIT ${c}${i}`,a,!0),e&&be.jsx(nl,{OK_BUTTON:o})}function DMt({blink:t,active:e,prefix:n,label:i,words:r,y:s}){const a=Pp(),o=De.useContext(m1e),c=De.useCallback(()=>{const[u,...h]=r;setTimeout(()=>{o.sendmessage(u,h)},100)},[r,o]),l=Hm(!!e);return $T(!!t,!!e,0,s,a),oi(`${n} $purple$16 ${l}${i}`,a,!0),e&&be.jsx(nl,{OK_BUTTON:c})}function LMt({blink:t,active:e,prefix:n,label:i,words:r,y:s}){const a=Pp(),o=De.useCallback(()=>{const[,...l]=r,u=l.join(" ");setTimeout(()=>{window.open(u,"_blank")},100)},[r]),c=Hm(!!e);return $T(!!t,!!e,0,s,a),oi(`${n} $purple$16 $yellowOPENIT ${c}${i}`,a,!0),e&&be.jsx(nl,{OK_BUTTON:o})}function b7({blink:t,active:e,text:n,y:i}){const r=Pp(),{quickterminal:s}=As(),a=w0(r),o=n.startsWith("!");if($T(!!t,!!e,0,i,r),r.reset.bg=e?RZ:RR(s),r.active.bottomedge=a.bottom,oi(o?"":n,r,!0),o){const[c,...l]=n.slice(1).split("!"),u=`${l.join("!")}`;let h="PRESS ME";const d=[],f=O4(u,!0);for(let v=0;v<f.tokens.length;v++){const b=f.tokens[v];switch(b.tokenType){case BK:h=b.image.slice(1);break;default:d.push(b.image);break}}const[p,...g]=d,_={blink:t,active:e,prefix:c,label:h,words:g,y:i};switch(Wn(p)){case"copyit":return be.jsx(PMt,{..._,words:d});case"openit":return be.jsx(LMt,{..._,words:d});default:case"hyperlink":return be.jsx(DMt,{..._,words:d});case"hk":case"hotkey":return null;case"rn":case"range":return null;case"sl":case"select":return null;case"nm":case"number":return null;case"tx":case"text":return null;case"zssedit":return null;case"charedit":return null;case"coloredit":return null}}return null}function Xoe(t){const e=bf();return be.jsx(b7,{active:!0,blink:e,...t})}function Zoe(t){const[,e,...n]=t,i=e==="error"?"$red":"$blue",r=n.map(o=>`${o}`).join(" "),s=r.startsWith("!"),a=`$onclear${i}`;return`${s?"!":""}${a}${r}`}function Joe(t,e,n){if(t.startsWith("!"))return 1;const i=Ik(t,e,n);return(i==null?void 0:i.y)??1}function Qoe(t,e,n,i,r){return{...r,x:t,y:e,reset:{...ro(r.reset),topedge:e,leftedge:t,rightedge:n,bottomedge:i},active:{...ro(r.active),topedge:e,leftedge:t,rightedge:n,bottomedge:i}}}function ece(){const t=Gi(),[e]=As(Cu($=>[$.editor.open])),n=As(Cu($=>$.terminal.info)),i=As(Cu($=>$.terminal.logs)),r=Pp(),s=Vo(),a=0,o=0,c=r.width-1,l=r.height-1,u=w0(r),h=Math.floor(u.width*.587),d=De.useMemo(()=>Qoe(o,a,h-1,l,r),[h,a,o,l,r]),f=De.useMemo(()=>Qoe(h+1,a,c,l,r),[h,a,c,l,r]),p=n.map(Zoe),g=i.map(Zoe),_=h-1,v=p.map($=>Joe($,_,u.height)),b=r.width-h-1,S=g.map($=>Joe($,b,u.height)),x=u.bottom-u.top-(e?0:2);let M=0,R=x+1;const I=v.map($=>(R-=$,M+=$,R));++M;let k=0,P=x+1;const U=S.map($=>(P-=$,k+=$,P));++k;const V=u.bottom-s.ycursor+s.scroll;return be.jsxs(be.Fragment,{children:[be.jsx(MZ,{}),be.jsxs(m1e.Provider,{value:{sendmessage($,q){const[Y,te]=wK($);if(Y==="self"){const G=`#${te} ${q.join(" ")}`;o_(Ye,t,G)}else Ye.emit(t,`${Y}:${te}`,q)}},children:[be.jsx(tI.Provider,{value:d,children:p.map(($,q)=>{const Y=I[q]+s.scroll,te=v[q],G=Y+te;return G<0||Y>x?null:!e&&s.xcursor<h&&V>=Y&&V<G?be.jsx(Xoe,{text:$,y:Y},q):be.jsx(b7,{text:$,y:Y},q)})}),be.jsx(tI.Provider,{value:f,children:g.map(($,q)=>{const Y=U[q]+s.scroll,te=S[q],G=Y+te;return G<0||Y>x?null:!e&&s.xcursor>=h&&V>=Y&&V<G?be.jsx(Xoe,{text:$,y:Y},q):be.jsx(b7,{text:$,y:Y},q)})}),!e&&be.jsx(kMt,{tapeycursor:V,logrowtotalheight:Math.max(M,k)})]})]})}function UMt(t,e,n,i,r){return{...r,x:t,y:e,reset:{...ro(r.reset),topedge:e,leftedge:t,rightedge:n,bottomedge:i},active:{...ro(r.active),topedge:e,leftedge:t,rightedge:n,bottomedge:i}}}function M2({quickterminal:t,top:e,width:n,height:i,children:r}){const s=RR(t),a=kk(n,i,0,BB,s),o=De.useMemo(()=>UMt(0,0,n-1,i-1,{...FE(n,i,BB,s),...a.getState()}),[s,n,i,a]);return be.jsxs(mP,{store:a,children:[be.jsxs(tI.Provider,{value:o,children:[be.jsx(MZ,{}),r]}),be.jsx("group",{position:[0,e*Kt.DRAW_CHAR_HEIGHT(),0],children:be.jsx(gP,{width:n,height:i})})]})}function BMt({quickterminal:t,top:e,width:n,height:i}){const[r,s]=As(Cu(a=>[a.layout,a.editor.open]));if(s)switch(r){case vm.SPLIT_X:{const a=Math.floor(n*.587);return be.jsxs(De.Fragment,{children:[be.jsx(M2,{quickterminal:t,top:e,width:n,height:i,children:be.jsx(ece,{})}),be.jsx(M2,{quickterminal:t,top:e,width:a,height:i,children:be.jsx(Koe,{})})]},"layout")}default:return be.jsx(M2,{quickterminal:t,top:e,width:n,height:i,children:be.jsx(Koe,{})},"layout")}return be.jsx(M2,{quickterminal:t,top:e,width:n,height:i,children:be.jsx(ece,{})},"layout")}function FMt(){const t=K8();let e=0,n=t.rows-2;const[i,r,s,a]=As(Cu(l=>[l.layout,l.quickterminal,l.terminal.open,l.editor.open]));switch(i){case vm.TOP:n=Math.floor(t.rows*.5);break;case vm.BOTTOM:n=Math.ceil(t.rows*.5),e=t.rows-n;break;default:case vm.FULL:break}if(t.cols<10||t.rows<10)return null;const o=Gi(),c=r||s||a;return be.jsxs(be.Fragment,{children:[c&&be.jsx(vI,{width:t.cols,height:t.rows,top:e,left:0,right:t.cols-1,bottom:e+n-1}),c?be.jsx(sx,{blockhotkeys:!0,children:be.jsx(BMt,{quickterminal:r,top:e,width:t.cols,height:n})}):be.jsx(NC,{hotkey:"Shift+?",althotkey:"/",children:()=>$4e(Ye,o)})]})}function zMt({context:t}){return be.jsx("group",{position:[0,0,999],children:be.jsx(gP,{width:t.width,height:t.height})})}function jMt(){const{toast:t}=As(),e=K8(),n=kk(e.cols,1,0,qt.GREEN,qt.ONCLEAR),i={...FE(e.cols,1,qt.GREEN,qt.ONCLEAR,0,0,e.cols-1,1),...n.getState()};if(e.cols<10||e.rows<10)return null;const r=e.cols-1;return be.jsx(mP,{store:n,children:t&&be.jsxs(be.Fragment,{children:[be.jsx(EZ,{margin:1,color:qt.YELLOW,y:0,leftedge:0,rightedge:r,line:t,context:i}),be.jsx("group",{position:[0,0,998],children:be.jsx(vI,{alpha:.4,width:e.cols,height:10,top:0,left:0,right:r,bottom:0})}),be.jsx(zMt,{context:i})]})})}const tce=NE("gadgetclient",[],t=>{if(!tce.session(t)||t.player!==Gi())return;const{desync:e}=jr.getState();switch(t.target){case"paint":jr.setState({desync:!1,gadget:t.data});break;case"patch":e||jr.setState(n=>{let i;try{i=k9(t.data,n.gadget)}catch(s){i=s}if(re(i))return tce.replynext(t,"desync"),{...n,desync:!0};const r=WF(n.gadget,t.data,!0,!1);return{...n,gadget:r.newDocument}});break}}),OZ=Object.prototype.toString.call(typeof Gn<"u"?Gn:0)==="[object process]";var qy,vi;(function(t){t[t.CRITICAL=0]="CRITICAL",t[t.ERROR=1]="ERROR",t[t.WARNING=2]="WARNING",t[t.INFO=3]="INFO",t[t.DEBUG=4]="DEBUG",t[t.TRACE=7]="TRACE"})(vi||(vi={}));function NZ(t){if(typeof t=="number"){if(Object.prototype.hasOwnProperty.call(vi,t))return t;var e=Object.keys(vi).map(function(i){return parseInt(i,10)}).filter(function(i){return!isNaN(i)&&i<t});return e.length?Math.max.apply(Math,e):vi.WARNING}var n=t.replace(/\d+$/,"").toUpperCase();if(!Object.prototype.hasOwnProperty.call(vi,n))throw new Error("Unknown log level string: ".concat(t));return vi[n]}var HMt=OZ?console.log.bind(console):console.debug.bind(console),T1e=(qy={},qy[vi.CRITICAL]=console.error.bind(console),qy[vi.ERROR]=console.error.bind(console),qy[vi.WARNING]=console.warn.bind(console),qy[vi.INFO]=console.info.bind(console),qy[vi.DEBUG]=HMt.bind(console),qy[vi.TRACE]=console.trace.bind(console),qy);function $E(t){return function(e,n){Object.defineProperty(e,n,{get:function(){},set:function(i){Object.defineProperty(this,n,{value:i,writable:!0,enumerable:t})},enumerable:t})}}function E7(t){return oo(this,void 0,Promise,function(){return AX(this,function(e){switch(e.label){case 0:return typeof t!="function"?[3,2]:[4,t()];case 1:return[2,e.sent()];case 2:return[2,t]}})})}function VMt(t){return typeof t=="function"?t():t}function x1e(t){var e,n,i;return AX(this,function(r){switch(r.label){case 0:e=0,n=1,r.label=1;case 1:return e<t?[4,e]:[3,3];case 2:return r.sent(),i=M8([n,e+n],2),e=i[0],n=i[1],[3,1];case 3:return[4,t];case 4:return r.sent(),[3,3];case 5:return[2]}})}function O2(t,e){return Object.assign.apply(Object,X$([{}],M8(t.map(e)),!1))}function S7(t,e){Object.entries(t).forEach(function(n){var i=M8(n,2),r=i[0],s=i[1];return e(s,r)})}function w1e(t){return t==null}function wI(t,e){return w1e(t)?null:e(t)}function C1e(t,e){return w1e(t)?void 0:e(t)}function GMt(t){return oo(this,void 0,Promise,function(){return AX(this,function(e){switch(e.label){case 0:return[4,new Promise(function(n){return setTimeout(n,t)})];case 1:return e.sent(),[2]}})})}function T7(){var t,e,n=new Promise(function(i,r){t=i,e=r});return{promise:n,resolve:t,reject:e}}function qMt(t,e,n){if(typeof t=="number"&&(t=t.toString()),e=e-t.length,e<=0)return t;n===void 0&&(n=" ");var i="";do(e&1)===1&&(i+=n),e>>=1,e&&(n+=n);while(e);return i+t}function WT(t,e,n){var i=t.split(e);return i.length<=n?i:X$(X$([],M8(i.slice(0,n-1)),!1),[i.slice(n-1).join(e)],!1)}var $Mt={},CV,AV,FB=typeof Gn>"u"?[]:(AV=(CV=$Mt.LOGGING)===null||CV===void 0?void 0:CV.split(";").map(function(t){var e=t.split("=",2),n=e[0],i=e[1];return i?[n==="default"?void 0:n.split(":"),NZ(i)]:null}).filter(function(t){return!!t}).sort(function(t,e){var n,i,r=t[0],s=e[0];return((n=s==null?void 0:s.length)!==null&&n!==void 0?n:0)-((i=r==null?void 0:r.length)!==null&&i!==void 0?i:0)}))!==null&&AV!==void 0?AV:[],RV=FB.findIndex(function(t){var e=t[0];return!e}),A1e=void 0;RV!==-1&&(A1e=FB[RV][1],FB.splice(RV));function WMt(t,e){return e.length<=t.length&&e.every(function(n,i){return n===t[i]})}function R1e(t){for(var e=t.split(":"),n=0,i=FB;n<i.length;n++){var r=i[n],s=r[0],a=r[1];if(WMt(e,s))return a}return A1e}var M1e=function(){function t(e){var n=e.name,i=e.minLevel,r=e.emoji,s=r===void 0?!1:r,a=e.colors,o=e.timestamps,c=o===void 0?OZ:o,l,u;this._name=n,this._minLevel=(u=(l=C1e(i,function(h){return NZ(h)}))!==null&&l!==void 0?l:R1e(n))!==null&&u!==void 0?u:vi.WARNING,this._emoji=s,this._colors=a,this._timestamps=c}return t.prototype.crit=function(e){this.log(vi.CRITICAL,e)},t.prototype.error=function(e){this.log(vi.ERROR,e)},t.prototype.warn=function(e){this.log(vi.WARNING,e)},t.prototype.info=function(e){this.log(vi.INFO,e)},t.prototype.debug=function(e){this.log(vi.DEBUG,e)},t.prototype.trace=function(e){this.log(vi.TRACE,e)},t}(),YMt=function(t){HEe(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.prototype.log=function(n,i){if(!(n>this._minLevel)){var r=T1e[n],s="[".concat(this._name,"] ").concat(i);this._timestamps&&(s="[".concat(new Date().toISOString(),"] ").concat(i)),r(s)}},e}(M1e),KMt=function(){function t(e){var n=e.name,i=e.minLevel,r=e.custom,s;this._minLevel=(s=C1e(i,function(a){return NZ(a)}))!==null&&s!==void 0?s:R1e(n),this._override=typeof r=="function"?{log:r}:r}return t.prototype.log=function(e,n){this._shouldLog(e)&&this._override.log(e,n)},t.prototype.crit=function(e){this._override.crit?this._shouldLog(vi.CRITICAL)&&this._override.crit(e):this.log(vi.CRITICAL,e)},t.prototype.error=function(e){this._override.error?this._shouldLog(vi.ERROR)&&this._override.error(e):this.log(vi.ERROR,e)},t.prototype.warn=function(e){this._override.warn?this._shouldLog(vi.WARNING)&&this._override.warn(e):this.log(vi.WARNING,e)},t.prototype.info=function(e){this._override.info?this._shouldLog(vi.INFO)&&this._override.info(e):this.log(vi.INFO,e)},t.prototype.debug=function(e){this._override.debug?this._shouldLog(vi.DEBUG)&&this._override.debug(e):this.log(vi.DEBUG,e)},t.prototype.trace=function(e){this._override.trace?this._shouldLog(vi.TRACE)&&this._override.trace(e):this.log(vi.TRACE,e)},t.prototype._shouldLog=function(e){return this._minLevel===void 0||this._minLevel>=e},t}(),$y,Wy,Yy,XMt=($y={},$y[vi.CRITICAL]="",$y[vi.ERROR]="",$y[vi.WARNING]=" ",$y[vi.INFO]=" ",$y[vi.DEBUG]="",$y[vi.TRACE]="",$y),ZMt={black:30,red:31,green:32,yellow:33,blue:34,magenta:35,cyan:36,white:37,blackBright:90,redBright:91,greenBright:92,yellowBright:93,blueBright:94,magentaBright:95,cyanBright:96,whiteBright:97},JMt={bgBlack:40,bgRed:41,bgGreen:42,bgYellow:43,bgBlue:44,bgMagenta:45,bgCyan:46,bgWhite:47,bgBlackBright:100,bgRedBright:101,bgGreenBright:102,bgYellowBright:103,bgBlueBright:104,bgMagentaBright:105,bgCyanBright:106,bgWhiteBright:107};function Q8(t,e,n){return function(i){return"\x1B[".concat(t,"m").concat(n?n(i):i,"\x1B[").concat(e,"m")}}function jg(t){return Q8(ZMt[t],39)}function OM(t,e){return Q8(JMt[t],49,e)}var QMt=(Wy={},Wy[vi.CRITICAL]=jg("red"),Wy[vi.ERROR]=jg("redBright"),Wy[vi.WARNING]=jg("yellow"),Wy[vi.INFO]=jg("blue"),Wy[vi.DEBUG]=jg("magenta"),Wy[vi.TRACE]=Q8(0,0),Wy),nce=(Yy={},Yy[vi.CRITICAL]=OM("bgRed",jg("white")),Yy[vi.ERROR]=OM("bgRedBright",jg("white")),Yy[vi.WARNING]=OM("bgYellow",jg("black")),Yy[vi.INFO]=OM("bgBlue",jg("white")),Yy[vi.DEBUG]=OM("bgMagenta",jg("black")),Yy[vi.TRACE]=Q8(7,27),Yy),eOt=function(t){HEe(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.prototype.log=function(n,i){var r,s,a;if(!(n>this._minLevel)){var o=T1e[n],c="";if(this._timestamps&&(c+="[".concat(new Date().toISOString(),"] ")),this._emoji){var l=XMt[n];c+="".concat(l," ")}var u=(a=(r=this._colors)!==null&&r!==void 0?r:(s=Gn.stdout)===null||s===void 0?void 0:s.isTTY)!==null&&a!==void 0?a:!0;u?c+="".concat(nce[n](this._name)," ").concat(nce[n](vi[n])," ").concat(QMt[n](i)):c+="[".concat(this._name,":").concat(vi[n].toLowerCase(),"] ").concat(i),o(c)}},e}(M1e);function e5(t){return t.custom?new KMt(t):OZ?new eOt(t):new YMt(t)}let tOt=class extends Error{constructor(...e){var n;super(...e),Object.setPrototypeOf(this,new.target.prototype),(n=Error.captureStackTrace)===null||n===void 0||n.call(Error,this,new.target.constructor)}get name(){return this.constructor.name}};class O1e extends tOt{}class nOt{constructor({logger:e,bucketSize:n,timeFrame:i,doRequest:r,getPartitionKey:s}){this._partitionedQueue=new Map,this._usedFromBucket=new Map,this._paused=!1,this._logger=e5({name:"rate-limiter",emoji:!0,...e}),this._bucketSize=n,this._timeFrame=i,this._callback=r,this._partitionKeyCallback=s}async request(e,n){return await new Promise((i,r)=>{var s,a;const o={req:e,resolve:i,reject:r,limitReachedBehavior:(s=n==null?void 0:n.limitReachedBehavior)!==null&&s!==void 0?s:"enqueue"},c=this._partitionKeyCallback(e),l=(a=this._usedFromBucket.get(c))!==null&&a!==void 0?a:0;if(l>=this._bucketSize||this._paused)switch(o.limitReachedBehavior){case"enqueue":{const u=this._getPartitionedQueue(c);u.push(o),l+u.length>=this._bucketSize?this._logger.warn(`Rate limit of ${this._bucketSize} for ${c?`partition ${c}`:"default partition"} was reached, waiting for ${this._paused?"the limiter to be unpaused":"a free bucket entry"}; queue size is ${u.length}`):this._logger.info(`Enqueueing request for ${c?`partition ${c}`:"default partition"} because the rate limiter is paused; queue size is ${u.length}`);break}case"null":{o.resolve(null),this._paused?this._logger.info(`Returning null for request for ${c?`partition ${c}`:"default partition"} because the rate limiter is paused`):this._logger.warn(`Rate limit of ${this._bucketSize} for ${c?`partition ${c}`:"default partition"} was reached, dropping request and returning null`);break}case"throw":{o.reject(new O1e(`Request dropped because ${this._paused?"the rate limiter is paused":`the rate limit for ${c?`partition ${c}`:"default partition"} was reached`}`));break}default:throw new Error("this should never happen")}else this._runRequest(o,c)})}clear(){this._partitionedQueue.clear()}pause(){this._paused=!0}resume(){this._paused=!1;for(const e of this._partitionedQueue.keys())this._runNextRequest(e)}_getPartitionedQueue(e){if(this._partitionedQueue.has(e))return this._partitionedQueue.get(e);const n=[];return this._partitionedQueue.set(e,n),n}async _runRequest(e,n){var i;const r=this._getPartitionedQueue(n);this._logger.debug(`doing a request for ${n?`partition ${n}`:"default partition"}, new queue length is ${r.length}`),this._usedFromBucket.set(n,((i=this._usedFromBucket.get(n))!==null&&i!==void 0?i:0)+1);const{req:s,resolve:a,reject:o}=e;try{a(await this._callback(s))}catch(c){o(c)}finally{setTimeout(()=>{const c=this._usedFromBucket.get(n)-1;this._usedFromBucket.set(n,c),r.length&&c<this._bucketSize&&this._runNextRequest(n)},this._timeFrame)}}_runNextRequest(e){if(this._paused)return;const i=this._getPartitionedQueue(e).shift();i&&this._runRequest(i,e)}}class x7{constructor({logger:e,bucketSize:n,timeFrame:i,doRequest:r}){this._queue=[],this._usedFromBucket=0,this._paused=!1,this._logger=e5({name:"rate-limiter",emoji:!0,...e}),this._bucketSize=n,this._timeFrame=i,this._callback=r}async request(e,n){return await new Promise((i,r)=>{var s;const a={req:e,resolve:i,reject:r,limitReachedBehavior:(s=n==null?void 0:n.limitReachedBehavior)!==null&&s!==void 0?s:"enqueue"};if(this._usedFromBucket>=this._bucketSize||this._paused)switch(a.limitReachedBehavior){case"enqueue":{this._queue.push(a),this._usedFromBucket+this._queue.length>=this._bucketSize?this._logger.warn(`Rate limit of ${this._bucketSize} was reached, waiting for ${this._paused?"the limiter to be unpaused":"a free bucket entry"}; queue size is ${this._queue.length}`):this._logger.info(`Enqueueing request because the rate limiter is paused; queue size is ${this._queue.length}`);break}case"null":{a.resolve(null),this._logger.warn(`Rate limit of ${this._bucketSize} was reached, dropping request and returning null`),this._paused?this._logger.info("Returning null for request because the rate limiter is paused"):this._logger.warn(`Rate limit of ${this._bucketSize} was reached, dropping request and returning null`);break}case"throw":{a.reject(new O1e(`Request dropped because ${this._paused?"the rate limiter is paused":"the rate limit was reached"}`));break}default:throw new Error("this should never happen")}else this._runRequest(a)})}clear(){this._queue=[]}pause(){this._paused=!0}resume(){this._paused=!1,this._runNextRequest()}async _runRequest(e){this._logger.debug(`doing a request, new queue length is ${this._queue.length}`),this._usedFromBucket+=1;const{req:n,resolve:i,reject:r}=e;try{i(await this._callback(n))}catch(s){r(s)}finally{setTimeout(()=>{this._usedFromBucket-=1,this._queue.length&&this._usedFromBucket<this._bucketSize&&this._runNextRequest()},this._timeFrame)}}_runNextRequest(){if(this._paused)return;const e=this._queue.shift();e&&this._runRequest(e)}}class iOt extends x7{constructor(e,n){super({...n,async doRequest(i,r){return await e.request(i,r)}})}}class rOt{constructor(e,n,i,r=!1){this.owner=e,this.event=n,this.listener=i,this._internal=r}unbind(){this.owner.removeListener(this)}}let yP=class{constructor(){this._eventListeners=new Map,this._internalEventListeners=new Map}on(e,n){return this._addListener(!1,e,n)}addListener(e,n){return this._addListener(!1,e,n)}removeListener(e,n){this._removeListener(!1,e,n)}registerEvent(){const e=n=>this.addListener(e,n);return e}emit(e,...n){if(this._eventListeners.has(e))for(const i of this._eventListeners.get(e))i(...n);if(this._internalEventListeners.has(e))for(const i of this._internalEventListeners.get(e))i(...n)}registerInternalEvent(){const e=n=>this.addInternalListener(e,n);return e}addInternalListener(e,n){return this._addListener(!0,e,n)}removeInternalListener(e,n){this._removeListener(!0,e,n)}_addListener(e,n,i){const r=e?this._eventListeners:this._internalEventListeners;return r.has(n)?r.get(n).push(i):r.set(n,[i]),new rOt(this,n,i,e)}_removeListener(e,n,i){const r=e?this._eventListeners:this._internalEventListeners;if(!n)r.clear();else if(typeof n=="object"){const s=n;this._removeListener(s._internal,s.event,s.listener)}else{const s=n;if(r.has(s))if(i){const a=r.get(s);let o=0;for(;(o=a.indexOf(i))!==-1;)a.splice(o,1)}else r.delete(s)}}};const sOt=6e4;function aOt(t){return wI(t.expiresIn,e=>t.obtainmentTimestamp+e*1e3-sOt)}function LL(t){var e;return(e=wI(aOt(t),n=>Date.now()>n))!==null&&e!==void 0?e:!1}var w7={exports:{}};(function(t,e){var n=typeof self<"u"?self:Ml,i=function(){function s(){this.fetch=!1,this.DOMException=n.DOMException}return s.prototype=n,new s}();(function(s){(function(a){var o={searchParams:"URLSearchParams"in s,iterable:"Symbol"in s&&"iterator"in Symbol,blob:"FileReader"in s&&"Blob"in s&&function(){try{return new Blob,!0}catch{return!1}}(),formData:"FormData"in s,arrayBuffer:"ArrayBuffer"in s};function c(Y){return Y&&DataView.prototype.isPrototypeOf(Y)}if(o.arrayBuffer)var l=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],u=ArrayBuffer.isView||function(Y){return Y&&l.indexOf(Object.prototype.toString.call(Y))>-1};function h(Y){if(typeof Y!="string"&&(Y=String(Y)),/[^a-z0-9\-#$%&'*+.^_`|~]/i.test(Y))throw new TypeError("Invalid character in header field name");return Y.toLowerCase()}function d(Y){return typeof Y!="string"&&(Y=String(Y)),Y}function f(Y){var te={next:function(){var G=Y.shift();return{done:G===void 0,value:G}}};return o.iterable&&(te[Symbol.iterator]=function(){return te}),te}function p(Y){this.map={},Y instanceof p?Y.forEach(function(te,G){this.append(G,te)},this):Array.isArray(Y)?Y.forEach(function(te){this.append(te[0],te[1])},this):Y&&Object.getOwnPropertyNames(Y).forEach(function(te){this.append(te,Y[te])},this)}p.prototype.append=function(Y,te){Y=h(Y),te=d(te);var G=this.map[Y];this.map[Y]=G?G+", "+te:te},p.prototype.delete=function(Y){delete this.map[h(Y)]},p.prototype.get=function(Y){return Y=h(Y),this.has(Y)?this.map[Y]:null},p.prototype.has=function(Y){return this.map.hasOwnProperty(h(Y))},p.prototype.set=function(Y,te){this.map[h(Y)]=d(te)},p.prototype.forEach=function(Y,te){for(var G in this.map)this.map.hasOwnProperty(G)&&Y.call(te,this.map[G],G,this)},p.prototype.keys=function(){var Y=[];return this.forEach(function(te,G){Y.push(G)}),f(Y)},p.prototype.values=function(){var Y=[];return this.forEach(function(te){Y.push(te)}),f(Y)},p.prototype.entries=function(){var Y=[];return this.forEach(function(te,G){Y.push([G,te])}),f(Y)},o.iterable&&(p.prototype[Symbol.iterator]=p.prototype.entries);function g(Y){if(Y.bodyUsed)return Promise.reject(new TypeError("Already read"));Y.bodyUsed=!0}function _(Y){return new Promise(function(te,G){Y.onload=function(){te(Y.result)},Y.onerror=function(){G(Y.error)}})}function v(Y){var te=new FileReader,G=_(te);return te.readAsArrayBuffer(Y),G}function b(Y){var te=new FileReader,G=_(te);return te.readAsText(Y),G}function S(Y){for(var te=new Uint8Array(Y),G=new Array(te.length),J=0;J<te.length;J++)G[J]=String.fromCharCode(te[J]);return G.join("")}function x(Y){if(Y.slice)return Y.slice(0);var te=new Uint8Array(Y.byteLength);return te.set(new Uint8Array(Y)),te.buffer}function M(){return this.bodyUsed=!1,this._initBody=function(Y){this._bodyInit=Y,Y?typeof Y=="string"?this._bodyText=Y:o.blob&&Blob.prototype.isPrototypeOf(Y)?this._bodyBlob=Y:o.formData&&FormData.prototype.isPrototypeOf(Y)?this._bodyFormData=Y:o.searchParams&&URLSearchParams.prototype.isPrototypeOf(Y)?this._bodyText=Y.toString():o.arrayBuffer&&o.blob&&c(Y)?(this._bodyArrayBuffer=x(Y.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):o.arrayBuffer&&(ArrayBuffer.prototype.isPrototypeOf(Y)||u(Y))?this._bodyArrayBuffer=x(Y):this._bodyText=Y=Object.prototype.toString.call(Y):this._bodyText="",this.headers.get("content-type")||(typeof Y=="string"?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):o.searchParams&&URLSearchParams.prototype.isPrototypeOf(Y)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},o.blob&&(this.blob=function(){var Y=g(this);if(Y)return Y;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?g(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(v)}),this.text=function(){var Y=g(this);if(Y)return Y;if(this._bodyBlob)return b(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(S(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},o.formData&&(this.formData=function(){return this.text().then(P)}),this.json=function(){return this.text().then(JSON.parse)},this}var R=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];function I(Y){var te=Y.toUpperCase();return R.indexOf(te)>-1?te:Y}function k(Y,te){te=te||{};var G=te.body;if(Y instanceof k){if(Y.bodyUsed)throw new TypeError("Already read");this.url=Y.url,this.credentials=Y.credentials,te.headers||(this.headers=new p(Y.headers)),this.method=Y.method,this.mode=Y.mode,this.signal=Y.signal,!G&&Y._bodyInit!=null&&(G=Y._bodyInit,Y.bodyUsed=!0)}else this.url=String(Y);if(this.credentials=te.credentials||this.credentials||"same-origin",(te.headers||!this.headers)&&(this.headers=new p(te.headers)),this.method=I(te.method||this.method||"GET"),this.mode=te.mode||this.mode||null,this.signal=te.signal||this.signal,this.referrer=null,(this.method==="GET"||this.method==="HEAD")&&G)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(G)}k.prototype.clone=function(){return new k(this,{body:this._bodyInit})};function P(Y){var te=new FormData;return Y.trim().split("&").forEach(function(G){if(G){var J=G.split("="),K=J.shift().replace(/\+/g," "),X=J.join("=").replace(/\+/g," ");te.append(decodeURIComponent(K),decodeURIComponent(X))}}),te}function U(Y){var te=new p,G=Y.replace(/\r?\n[\t ]+/g," ");return G.split(/\r?\n/).forEach(function(J){var K=J.split(":"),X=K.shift().trim();if(X){var ae=K.join(":").trim();te.append(X,ae)}}),te}M.call(k.prototype);function V(Y,te){te||(te={}),this.type="default",this.status=te.status===void 0?200:te.status,this.ok=this.status>=200&&this.status<300,this.statusText="statusText"in te?te.statusText:"OK",this.headers=new p(te.headers),this.url=te.url||"",this._initBody(Y)}M.call(V.prototype),V.prototype.clone=function(){return new V(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new p(this.headers),url:this.url})},V.error=function(){var Y=new V(null,{status:0,statusText:""});return Y.type="error",Y};var $=[301,302,303,307,308];V.redirect=function(Y,te){if($.indexOf(te)===-1)throw new RangeError("Invalid status code");return new V(null,{status:te,headers:{location:Y}})},a.DOMException=s.DOMException;try{new a.DOMException}catch{a.DOMException=function(te,G){this.message=te,this.name=G;var J=Error(te);this.stack=J.stack},a.DOMException.prototype=Object.create(Error.prototype),a.DOMException.prototype.constructor=a.DOMException}function q(Y,te){return new Promise(function(G,J){var K=new k(Y,te);if(K.signal&&K.signal.aborted)return J(new a.DOMException("Aborted","AbortError"));var X=new XMLHttpRequest;function ae(){X.abort()}X.onload=function(){var ce={status:X.status,statusText:X.statusText,headers:U(X.getAllResponseHeaders()||"")};ce.url="responseURL"in X?X.responseURL:ce.headers.get("X-Request-URL");var Me="response"in X?X.response:X.responseText;G(new V(Me,ce))},X.onerror=function(){J(new TypeError("Network request failed"))},X.ontimeout=function(){J(new TypeError("Network request failed"))},X.onabort=function(){J(new a.DOMException("Aborted","AbortError"))},X.open(K.method,K.url,!0),K.credentials==="include"?X.withCredentials=!0:K.credentials==="omit"&&(X.withCredentials=!1),"responseType"in X&&o.blob&&(X.responseType="blob"),K.headers.forEach(function(ce,Me){X.setRequestHeader(Me,ce)}),K.signal&&(K.signal.addEventListener("abort",ae),X.onreadystatechange=function(){X.readyState===4&&K.signal.removeEventListener("abort",ae)}),X.send(typeof K._bodyInit>"u"?null:K._bodyInit)})}return q.polyfill=!0,s.fetch||(s.fetch=q,s.Headers=p,s.Request=k,s.Response=V),a.Headers=p,a.Request=k,a.Response=V,a.fetch=q,Object.defineProperty(a,"__esModule",{value:!0}),a})({})})(i),i.fetch.ponyfill=!0,delete i.fetch.polyfill;var r=i;e=r.fetch,e.default=r.fetch,e.fetch=r.fetch,e.Headers=r.Headers,e.Request=r.Request,e.Response=r.Response,t.exports=e})(w7,w7.exports);var N1e=w7.exports;const oOt=il(N1e);var MV=Object.prototype.hasOwnProperty,Dw=Array.isArray,Cg=function(){for(var t=[],e=0;e<256;++e)t.push("%"+((e<16?"0":"")+e.toString(16)).toUpperCase());return t}(),cOt=function(e){for(;e.length>1;){var n=e.pop(),i=n.obj[n.prop];if(Dw(i)){for(var r=[],s=0;s<i.length;++s)typeof i[s]<"u"&&r.push(i[s]);n.obj[n.prop]=r}}},I1e=function(e,n){for(var i=n&&n.plainObjects?Object.create(null):{},r=0;r<e.length;++r)typeof e[r]<"u"&&(i[r]=e[r]);return i},lOt=function t(e,n,i){if(!n)return e;if(typeof n!="object"){if(Dw(e))e.push(n);else if(e&&typeof e=="object")(i&&(i.plainObjects||i.allowPrototypes)||!MV.call(Object.prototype,n))&&(e[n]=!0);else return[e,n];return e}if(!e||typeof e!="object")return[e].concat(n);var r=e;return Dw(e)&&!Dw(n)&&(r=I1e(e,i)),Dw(e)&&Dw(n)?(n.forEach(function(s,a){if(MV.call(e,a)){var o=e[a];o&&typeof o=="object"&&s&&typeof s=="object"?e[a]=t(o,s,i):e.push(s)}else e[a]=s}),e):Object.keys(n).reduce(function(s,a){var o=n[a];return MV.call(s,a)?s[a]=t(s[a],o,i):s[a]=o,s},r)},uOt=function(e,n){return Object.keys(n).reduce(function(i,r){return i[r]=n[r],i},e)},hOt=function(t,e,n){var i=t.replace(/\+/g," ");if(n==="iso-8859-1")return i.replace(/%[0-9a-f]{2}/gi,unescape);try{return decodeURIComponent(i)}catch{return i}},dOt=function(e,n,i){if(e.length===0)return e;var r=e;if(typeof e=="symbol"?r=Symbol.prototype.toString.call(e):typeof e!="string"&&(r=String(e)),i==="iso-8859-1")return escape(r).replace(/%u[0-9a-f]{4}/gi,function(c){return"%26%23"+parseInt(c.slice(2),16)+"%3B"});for(var s="",a=0;a<r.length;++a){var o=r.charCodeAt(a);if(o===45||o===46||o===95||o===126||o>=48&&o<=57||o>=65&&o<=90||o>=97&&o<=122){s+=r.charAt(a);continue}if(o<128){s=s+Cg[o];continue}if(o<2048){s=s+(Cg[192|o>>6]+Cg[128|o&63]);continue}if(o<55296||o>=57344){s=s+(Cg[224|o>>12]+Cg[128|o>>6&63]+Cg[128|o&63]);continue}a+=1,o=65536+((o&1023)<<10|r.charCodeAt(a)&1023),s+=Cg[240|o>>18]+Cg[128|o>>12&63]+Cg[128|o>>6&63]+Cg[128|o&63]}return s},fOt=function(e){for(var n=[{obj:{o:e},prop:"o"}],i=[],r=0;r<n.length;++r)for(var s=n[r],a=s.obj[s.prop],o=Object.keys(a),c=0;c<o.length;++c){var l=o[c],u=a[l];typeof u=="object"&&u!==null&&i.indexOf(u)===-1&&(n.push({obj:a,prop:l}),i.push(u))}return cOt(n),e},pOt=function(e){return Object.prototype.toString.call(e)==="[object RegExp]"},mOt=function(e){return!e||typeof e!="object"?!1:!!(e.constructor&&e.constructor.isBuffer&&e.constructor.isBuffer(e))},gOt=function(e,n){return[].concat(e,n)},IZ={arrayToObject:I1e,assign:uOt,combine:gOt,compact:fOt,decode:hOt,encode:dOt,isBuffer:mOt,isRegExp:pOt,merge:lOt},vOt=String.prototype.replace,_Ot=/%20/g,yOt=IZ,ice={RFC1738:"RFC1738",RFC3986:"RFC3986"},bOt=yOt.assign({default:ice.RFC3986,formatters:{RFC1738:function(t){return vOt.call(t,_Ot,"+")},RFC3986:function(t){return String(t)}}},ice),k1e=IZ,LO=bOt,EOt=Object.prototype.hasOwnProperty,rce={brackets:function(e){return e+"[]"},comma:"comma",indices:function(e,n){return e+"["+n+"]"},repeat:function(e){return e}},kC=Array.isArray,SOt=Array.prototype.push,C7=function(t,e){SOt.apply(t,kC(e)?e:[e])},TOt=Date.prototype.toISOString,sce=LO.default,pu={addQueryPrefix:!1,allowDots:!1,charset:"utf-8",charsetSentinel:!1,delimiter:"&",encode:!0,encoder:k1e.encode,encodeValuesOnly:!1,format:sce,formatter:LO.formatters[sce],indices:!1,serializeDate:function(e){return TOt.call(e)},skipNulls:!1,strictNullHandling:!1},xOt=function(e){return typeof e=="string"||typeof e=="number"||typeof e=="boolean"||typeof e=="symbol"||typeof e=="bigint"},wOt=function t(e,n,i,r,s,a,o,c,l,u,h,d,f){var p=e;if(typeof o=="function"?p=o(n,p):p instanceof Date?p=u(p):i==="comma"&&kC(p)&&(p=p.join(",")),p===null){if(r)return a&&!d?a(n,pu.encoder,f,"key"):n;p=""}if(xOt(p)||k1e.isBuffer(p)){if(a){var g=d?n:a(n,pu.encoder,f,"key");return[h(g)+"="+h(a(p,pu.encoder,f,"value"))]}return[h(n)+"="+h(String(p))]}var _=[];if(typeof p>"u")return _;var v;if(kC(o))v=o;else{var b=Object.keys(p);v=c?b.sort(c):b}for(var S=0;S<v.length;++S){var x=v[S];s&&p[x]===null||(kC(p)?C7(_,t(p[x],typeof i=="function"?i(n,x):n,i,r,s,a,o,c,l,u,h,d,f)):C7(_,t(p[x],n+(l?"."+x:"["+x+"]"),i,r,s,a,o,c,l,u,h,d,f)))}return _},COt=function(e){if(!e)return pu;if(e.encoder!==null&&e.encoder!==void 0&&typeof e.encoder!="function")throw new TypeError("Encoder has to be a function.");var n=e.charset||pu.charset;if(typeof e.charset<"u"&&e.charset!=="utf-8"&&e.charset!=="iso-8859-1")throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");var i=LO.default;if(typeof e.format<"u"){if(!EOt.call(LO.formatters,e.format))throw new TypeError("Unknown format option provided.");i=e.format}var r=LO.formatters[i],s=pu.filter;return(typeof e.filter=="function"||kC(e.filter))&&(s=e.filter),{addQueryPrefix:typeof e.addQueryPrefix=="boolean"?e.addQueryPrefix:pu.addQueryPrefix,allowDots:typeof e.allowDots>"u"?pu.allowDots:!!e.allowDots,charset:n,charsetSentinel:typeof e.charsetSentinel=="boolean"?e.charsetSentinel:pu.charsetSentinel,delimiter:typeof e.delimiter>"u"?pu.delimiter:e.delimiter,encode:typeof e.encode=="boolean"?e.encode:pu.encode,encoder:typeof e.encoder=="function"?e.encoder:pu.encoder,encodeValuesOnly:typeof e.encodeValuesOnly=="boolean"?e.encodeValuesOnly:pu.encodeValuesOnly,filter:s,formatter:r,serializeDate:typeof e.serializeDate=="function"?e.serializeDate:pu.serializeDate,skipNulls:typeof e.skipNulls=="boolean"?e.skipNulls:pu.skipNulls,sort:typeof e.sort=="function"?e.sort:null,strictNullHandling:typeof e.strictNullHandling=="boolean"?e.strictNullHandling:pu.strictNullHandling}},AOt=function(t,e){var n=t,i=COt(e),r,s;typeof i.filter=="function"?(s=i.filter,n=s("",n)):kC(i.filter)&&(s=i.filter,r=s);var a=[];if(typeof n!="object"||n===null)return"";var o;e&&e.arrayFormat in rce?o=e.arrayFormat:e&&"indices"in e?o=e.indices?"indices":"repeat":o="indices";var c=rce[o];r||(r=Object.keys(n)),i.sort&&r.sort(i.sort);for(var l=0;l<r.length;++l){var u=r[l];i.skipNulls&&n[u]===null||C7(a,wOt(n[u],u,c,i.strictNullHandling,i.skipNulls,i.encode?i.encoder:null,i.filter,i.sort,i.allowDots,i.serializeDate,i.formatter,i.encodeValuesOnly,i.charset))}var h=a.join(i.delimiter),d=i.addQueryPrefix===!0?"?":"";return i.charsetSentinel&&(i.charset==="iso-8859-1"?d+="utf8=%26%2310003%3B&":d+="utf8=%E2%9C%93&"),h.length>0?d+h:""};const P1e=il(AOt);var ROt=IZ;ROt.decode;const Lw=Symbol("twurpleRawData");class MOt{constructor(e){this[Lw]=e}}class hx extends Error{constructor(e,n){var i;super(e,n),Object.setPrototypeOf(this,new.target.prototype),(i=Error.captureStackTrace)===null||i===void 0||i.call(Error,this,new.target.constructor)}get name(){return this.constructor.name}}function bP(t,e,n){return i=>{const r=n?function(){return`[${e}#${this[n]} - please check https://twurple.js.org/reference/${t}/classes/${e}.html for available properties]`}:function(){return`[${e} - please check https://twurple.js.org/reference/${t}/classes/${e}.html for available properties]`};Object.defineProperty(i.prototype,Symbol.for("nodejs.util.inspect.custom"),{value:r,enumerable:!1})}}class ace extends hx{constructor(e){super(`${e} - this should never happen, please file a bug in the GitHub issue tracker`)}}function zv(t){return typeof t=="string"?t:typeof t=="number"?t.toString(10):t.id}class D1e extends hx{constructor(e,n,i,r,s,a){super(`Encountered HTTP status code ${e}: ${n}

URL: ${i}
Method: ${r}
Body:
${!a&&s.length>150?`${s.slice(0,147)}...`:s}`),this._statusCode=e,this._url=i,this._method=r,this._body=s}get statusCode(){return this._statusCode}get url(){return this._url}get method(){return this._method}get body(){return this._body}}async function OOt(t,e){var n;if(!t.ok){const i=t.headers.get("Content-Type")==="application/json",r=i?JSON.stringify(await t.json(),null,2):await t.text(),s=P1e(e.query,{arrayFormat:"repeat",addQueryPrefix:!0}),a=`${e.url}${s}`;throw new D1e(t.status,t.statusText,a,(n=e.method)!==null&&n!==void 0?n:"GET",r,i)}}async function NOt(t){if(t.status===204)return;const e=await t.text();if(e)return JSON.parse(e)}function IOt(t,e,n){switch(e){case"helix":return`https://api.twitch.tv/helix/${t.replace(/^\//,"")}`;case"auth":return`https://id.twitch.tv/oauth2/${t.replace(/^\//,"")}`;case"custom":return t;default:return t}}async function kOt(t,e,n,i,r={},s){var a,o;const c=(a=t.type)!==null&&a!==void 0?a:"helix",l=IOt(t.url,c),u=P1e(t.query,{arrayFormat:"repeat",addQueryPrefix:!0}),h=new N1e.Headers({Accept:"application/json"});let d;t.jsonBody&&(d=JSON.stringify(t.jsonBody),h.append("Content-Type","application/json")),e&&c!=="auth"&&h.append("Client-ID",e),n&&h.append("Authorization",`${c==="helix"?"Bearer":"OAuth"} ${n}`);const f={...r,method:(o=t.method)!==null&&o!==void 0?o:"GET",headers:h,body:d};return await oOt(`${l}${u}`,f)}async function t5(t,e,n,i,r={}){const s=await kOt(t,e,n,i,r);return await OOt(s,t),await NOt(s)}class PC extends hx{constructor(e){super("Invalid token supplied",e)}}class UL extends hx{}function POt(t,e,n,i){return{grant_type:"authorization_code",client_id:t,client_secret:e,code:n,redirect_uri:i}}function DOt(t,e){return{grant_type:"client_credentials",client_id:t,client_secret:e}}function LOt(t,e,n){return{grant_type:"refresh_token",client_id:t,client_secret:e,refresh_token:n}}let A7=class extends MOt{constructor(e){super(e),this._obtainmentDate=new Date}get clientId(){return this[Lw].client_id}get userId(){var e;return(e=this[Lw].user_id)!==null&&e!==void 0?e:null}get userName(){var e;return(e=this[Lw].login)!==null&&e!==void 0?e:null}get scopes(){return this[Lw].scopes}get expiryDate(){return wI(this[Lw].expires_in,e=>new Date(this._obtainmentDate.getTime()+e*1e3))}};A7=pa([bP("auth","TokenInfo","clientId")],A7);function kZ(t){var e,n;return{accessToken:t.access_token,refreshToken:t.refresh_token||null,scope:(e=t.scope)!==null&&e!==void 0?e:[],expiresIn:(n=t.expires_in)!==null&&n!==void 0?n:null,obtainmentTimestamp:Date.now()}}async function UOt(t,e,n,i){return kZ(await t5({type:"auth",url:"token",method:"POST",query:POt(t,e,n,i)}))}async function BOt(t,e){return kZ(await t5({type:"auth",url:"token",method:"POST",query:DOt(t,e)}))}async function oce(t,e,n){return kZ(await t5({type:"auth",url:"token",method:"POST",query:LOt(t,e,n)}))}async function CI(t,e){try{const n=await t5({type:"auth",url:"validate"},e,t);return new A7(n)}catch(n){throw n instanceof D1e&&n.statusCode===401?new PC({cause:n}):n}}const FOt=new Map([["channel_commercial",["channel:edit:commercial"]],["channel_editor",["channel:manage:broadcast"]],["channel_read",["channel:read:stream_key"]],["channel_subscriptions",["channel:read:subscriptions"]],["user_blocks_read",["user:read:blocked_users"]],["user_blocks_edit",["user:manage:blocked_users"]],["user_follows_edit",["user:edit:follows"]],["user_read",["user:read:email"]],["user_subscriptions",["user:read:subscriptions"]],["user:edit:broadcast",["channel:manage:broadcast","channel:manage:extensions"]]]);function zOt(t,e){if(e!=null&&e.length){const n=new Set(t.flatMap(i=>{var r;return[i,...(r=FOt.get(i))!==null&&r!==void 0?r:[]]}));if(e.every(i=>!n.has(i))){const i=e.join(", ");throw new Error(`This token does not have any of the requested scopes (${i}) and can not be upgraded.
If you need dynamically upgrading scopes, please implement the AuthProvider interface accordingly:

	https://twurple.js.org/reference/auth/interfaces/AuthProvider.html`)}}}function BL(t,e){for(const n of e)zOt(t,n)}async function jOt(t,e,n,i,r){if(r!=null&&r.length||!n){const s=await CI(e,t);if(!s.userId)throw new Error("Trying to use an app access token as a user access token");const a=i??s.scopes;return r&&BL(a,r.filter(o=>!!o)),[a,s.userId]}return[i,n]}class cce{constructor(e){this._newTokenScopeSets=[],this._newTokenPromise=null,this._queuedScopeSets=[],this._queueExecutor=null,this._queuePromise=null,this._executor=e}async fetch(...e){var n;const i=e.filter(o=>!!o);if(this._newTokenPromise){if(!i.length)return await this._newTokenPromise;if(this._queueExecutor?this._queuedScopeSets.push(...i):this._queuedScopeSets=[...i],!this._queuePromise){const{promise:o,resolve:c,reject:l}=T7();this._queuePromise=o,this._queueExecutor=async()=>{var u;if(this._queuePromise){this._newTokenScopeSets=this._queuedScopeSets,this._queuedScopeSets=[],this._newTokenPromise=this._queuePromise,this._queuePromise=null,this._queueExecutor=null;try{c(await this._executor(this._newTokenScopeSets))}catch(h){l(h)}finally{this._newTokenPromise=null,this._newTokenScopeSets=[],(u=this._queueExecutor)===null||u===void 0||u.call(this)}}}}return await this._queuePromise}this._newTokenScopeSets=[...i];const{promise:r,resolve:s,reject:a}=T7();this._newTokenPromise=r;try{s(await this._executor(this._newTokenScopeSets))}catch(o){a(o)}finally{this._newTokenPromise=null,this._newTokenScopeSets=[],(n=this._queueExecutor)===null||n===void 0||n.call(this)}return await r}}class lce extends hx{constructor(e){super(`The user context for the user ${e} has been disabled.
This happened because the access token became invalid (e.g. by expiry) and refreshing it failed (e.g. because the account's password was changed).

Use .addUser(), .addUserForToken() or .addUserForCode() for the same user context to re-enable the user with a new, valid token.`),this.userId=e}}class HOt extends hx{constructor(e){super(`User ${e} was removed while trying to fetch a token.

Make sure you're not executing any actions when you want to remove a user.`),this.userId=e}}class VOt extends hx{constructor(e){super(`Unknown intent: ${e}`),this.intent=e}}let bE=class extends yP{constructor(e){var n;super(),this._userAccessTokens=new Map,this._userTokenFetchers=new Map,this._intentToUserId=new Map,this._userIdToIntents=new Map,this._cachedRefreshFailures=new Set,this.onRefresh=this.registerEvent(),this.onRefreshFailure=this.registerEvent(),this._clientId=e.clientId,this._clientSecret=e.clientSecret,this._redirectUri=e.redirectUri,this._appImpliedScopes=(n=e.appImpliedScopes)!==null&&n!==void 0?n:[],this._appTokenFetcher=new cce(async i=>await this._fetchAppToken(i))}addUser(e,n,i){const r=zv(e);if(!n.refreshToken)throw new Error(`Trying to add user ${r} without refresh token`);this._cachedRefreshFailures.delete(r),this._userAccessTokens.set(r,{...n,userId:r}),this._userTokenFetchers.has(r)||this._userTokenFetchers.set(r,new cce(async s=>await this._fetchUserToken(r,s))),i&&this.addIntentsToUser(e,i)}async addUserForToken(e,n){let i=null;if(e.accessToken&&!LL(e))try{const o=await CI(e.accessToken);i=[e,o]}catch(o){if(!(o instanceof PC))throw o}if(!i){if(!e.refreshToken)throw new PC;const o=await oce(this._clientId,this._clientSecret,e.refreshToken),c=await CI(o.accessToken);this.emit(this.onRefresh,c.userId,o),i=[o,c]}const[r,s]=i;if(!s.userId)throw new UL("Could not determine a user ID for your token; you might be trying to disguise an app token as a user token.");const a=r.scope?r:{...r,scope:s.scopes};return this.addUser(s.userId,a,n),s.userId}async addUserForCode(e,n){if(!this._redirectUri)throw new Error("This method requires you to pass a `redirectUri` as a configuration property");const i=await UOt(this._clientId,this._clientSecret,e,this._redirectUri);return await this.addUserForToken(i,n)}hasUser(e){return this._userTokenFetchers.has(zv(e))}removeUser(e){const n=zv(e);if(this._userIdToIntents.has(n)){const i=this._userIdToIntents.get(n);for(const r of i)this._intentToUserId.delete(r);this._userIdToIntents.delete(n)}this._userAccessTokens.delete(n),this._userTokenFetchers.delete(n),this._cachedRefreshFailures.delete(n)}addIntentsToUser(e,n){const i=zv(e);if(!this._userAccessTokens.has(i))throw new Error("Trying to add intents to a user that was not added to this provider");for(const r of n)this._intentToUserId.has(r)&&this._userIdToIntents.get(this._intentToUserId.get(r)).delete(r),this._intentToUserId.set(r,i),this._userIdToIntents.has(i)?this._userIdToIntents.get(i).add(r):this._userIdToIntents.set(i,new Set([r]))}getIntentsForUser(e){const n=zv(e);return this._userIdToIntents.has(n)?Array.from(this._userIdToIntents.get(n)):[]}removeIntents(e){var n;for(const i of e)if(this._intentToUserId.has(i)){const r=this._intentToUserId.get(i);(n=this._userIdToIntents.get(r))===null||n===void 0||n.delete(i),this._intentToUserId.delete(i)}}async refreshAccessTokenForUser(e){const n=zv(e);if(this._cachedRefreshFailures.has(n))throw new lce(n);const i=this._userAccessTokens.get(n);if(!i)throw new Error("Trying to refresh token for user that was not added to the provider");const r=await this._refreshUserTokenWithCallback(n,i.refreshToken);return this._checkIntermediateUserRemoval(n),this._userAccessTokens.set(n,{...r,userId:n}),this.emit(this.onRefresh,n,r),{...r,userId:n}}async refreshAccessTokenForIntent(e){if(!this._intentToUserId.has(e))throw new VOt(e);const n=this._intentToUserId.get(e);return await this.refreshAccessTokenForUser(n)}get clientId(){return this._clientId}getCurrentScopesForUser(e){var n;const i=this._userAccessTokens.get(zv(e));if(!i)throw new Error("Trying to get scopes for user that was not added to the provider");return(n=i.scope)!==null&&n!==void 0?n:[]}async getAccessTokenForUser(e,...n){const i=zv(e),r=this._userTokenFetchers.get(i);if(!r)return null;if(this._cachedRefreshFailures.has(i))throw new lce(i);return BL(this.getCurrentScopesForUser(i),n.filter(Boolean)),await r.fetch(...n)}async getAccessTokenForIntent(e,...n){if(!this._intentToUserId.has(e))return null;const i=this._intentToUserId.get(e),r=await this.getAccessTokenForUser(i,...n);if(!r)throw new ace(`Found intent ${e} corresponding to user ID ${i} but no token was found`);return{...r,userId:i}}async getAnyAccessToken(e){if(e){const n=zv(e);if(this._userAccessTokens.has(n)){const i=await this.getAccessTokenForUser(n);if(!i)throw new ace(`Token for user ID ${n} exists but nothing was returned by getAccessTokenForUser`);return{...i,userId:n}}}return await this.getAppAccessToken()}async getAppAccessToken(e=!1){return e&&(this._appAccessToken=void 0),await this._appTokenFetcher.fetch(...this._appImpliedScopes.map(n=>[n]))}_checkIntermediateUserRemoval(e){if(!this._userTokenFetchers.has(e))throw this._cachedRefreshFailures.delete(e),new HOt(e)}async _fetchUserToken(e,n){const i=this._userAccessTokens.get(e);if(!i)throw new Error("Trying to get token for user that was not added to the provider");if(i.accessToken&&!LL(i))try{if(i.scope)return BL(i.scope,n),i;const[s=[]]=await jOt(this._clientId,i.accessToken,e,i.scope,n),a={...i,scope:s};return this._checkIntermediateUserRemoval(e),this._userAccessTokens.set(e,a),a}catch(s){if(!(s instanceof PC))throw s}this._checkIntermediateUserRemoval(e);const r=await this.refreshAccessTokenForUser(e);return BL(r.scope,n),r}async _refreshUserTokenWithCallback(e,n){try{return await oce(this.clientId,this._clientSecret,n)}catch(i){throw this._cachedRefreshFailures.add(e),this.emit(this.onRefreshFailure,e,i),i}}async _fetchAppToken(e){if(e.length>0)for(const n of e)if(this._appImpliedScopes.length){if(n.every(i=>!this._appImpliedScopes.includes(i)))throw new Error(`One of the scopes ${n.join(", ")} requested but only the scope ${this._appImpliedScopes.join(", ")} is implied`)}else throw new Error(`One of the scopes ${n.join(", ")} requested but the client credentials flow does not support scopes`);return!this._appAccessToken||LL(this._appAccessToken)?await this._refreshAppToken():this._appAccessToken}async _refreshAppToken(){return this._appAccessToken=await BOt(this._clientId,this._clientSecret)}};pa([$E(!1)],bE.prototype,"_clientSecret",void 0);pa([$E(!1)],bE.prototype,"_userAccessTokens",void 0);pa([$E(!1)],bE.prototype,"_userTokenFetchers",void 0);pa([$E(!1)],bE.prototype,"_appAccessToken",void 0);pa([$E(!1)],bE.prototype,"_appTokenFetcher",void 0);bE=pa([bP("auth","RefreshingAuthProvider","clientId")],bE);class GOt extends yP{constructor({lineBased:e,logger:n,additionalOptions:i}={}){super(),this._currentLine="",this._connecting=!1,this._connected=!1,this.onReceive=this.registerEvent(),this.onConnect=this.registerEvent(),this.onDisconnect=this.registerEvent(),this.onEnd=this.registerEvent(),this._lineBased=e??!1,this._logger=n,this._additionalOptions=i}get isConnecting(){return this._connecting}get isConnected(){return this._connected}sendLine(e){this._connected&&(e=e.replace(/[\0\r\n]/g,""),this.sendRaw(`${e}\r
`))}assumeExternalDisconnect(){var e;(e=this._logger)===null||e===void 0||e.trace("AbstractConnection assumeExternalDisconnect"),this._connected=!1,this._connecting=!1,this.clearSocket(),this.emit(this.onDisconnect,!1)}receiveRaw(e){var n,i;if(!this._lineBased){this.emit(this.onReceive,e);return}const r=e.split(`\r
`);if(this._currentLine+=(n=r.shift())!==null&&n!==void 0?n:"",r.length){this.emit(this.onReceive,this._currentLine),this._currentLine=(i=r.pop())!==null&&i!==void 0?i:"";for(const s of r)this.emit(this.onReceive,s)}}}class qOt{constructor(){throw new Error("DirectConnection is not implemented in a browser environment")}}class $Ot extends yP{constructor(e,n,i={}){var r;super(),this._type=e,this._target=n,this._config=i,this._retryLimit=1/0,this._initialRetryLimit=3,this._connecting=!1,this._connectionRetryCount=0,this.onReceive=this.registerEvent(),this.onConnect=this.registerEvent(),this.onDisconnect=this.registerEvent(),this.onEnd=this.registerEvent(),this._retryLimit=(r=i.retryLimit)!==null&&r!==void 0?r:1/0,this._logger=i.logger}get isConnected(){var e,n;return(n=(e=this._currentConnection)===null||e===void 0?void 0:e.isConnected)!==null&&n!==void 0?n:!1}get isConnecting(){var e,n;return(n=(e=this._currentConnection)===null||e===void 0?void 0:e.isConnecting)!==null&&n!==void 0?n:this._connecting}get hasSocket(){var e,n;return(n=(e=this._currentConnection)===null||e===void 0?void 0:e.hasSocket)!==null&&n!==void 0?n:!1}sendLine(e){var n;(n=this._currentConnection)===null||n===void 0||n.sendLine(e)}connect(){if(this._currentConnection||this._connecting)throw new Error("Connection already present");this._connecting=!0,this._connectionRetryCount=0,this._tryConnect(!0)}disconnect(){var e;if((e=this._logger)===null||e===void 0||e.trace(`PersistentConnection disconnect currentConnectionExists:${(!!this._currentConnection).toString()} connecting:${this._connecting.toString()}`),this._connecting=!1,this._currentConnection){const n=this._currentConnection;this._currentConnection=void 0,n.disconnect()}}assumeExternalDisconnect(){var e,n;(e=this._logger)===null||e===void 0||e.trace("PersistentConnection assumeExternalDisconnect"),(n=this._currentConnection)===null||n===void 0||n.assumeExternalDisconnect()}reconnect(){this._reconnect(!0)}acknowledgeSuccessfulReconnect(){this._previousConnection&&(this._previousConnection.disconnect(),this._previousConnection=void 0)}_startTryingToConnect(e=!1){this._connecting=!0,this._connectionRetryCount=0,this._tryConnect(e)}_tryConnect(e=!1){var n,i;(n=this._logger)===null||n===void 0||n.trace(`PersistentConnection tryConnect currentConnectionExists:${(!!this._currentConnection).toString()} connecting:${this._connecting.toString()}`);const r=e?this._initialRetryLimit:this._retryLimit;(i=this._retryTimerGenerator)!==null&&i!==void 0||(this._retryTimerGenerator=x1e(120));const s=this._currentConnection=new this._type(VMt(this._target),this._config);s.onReceive(a=>this.emit(this.onReceive,a)),s.onConnect(()=>{this.emit(this.onConnect),this._connecting=!1,this._retryTimerGenerator=void 0}),s.onDisconnect((a,o)=>{var c,l,u;if(this.emit(this.onDisconnect,a,o),a)this.emit(this.onEnd,!0),this._connecting=!1,this._retryTimerGenerator=void 0,s.disconnect(),this._currentConnection===s&&(this._currentConnection=void 0),this._previousConnection===s&&(this._previousConnection=void 0);else if(this._connecting){if((c=this._logger)===null||c===void 0||c.debug(`Connection error caught: ${(l=o==null?void 0:o.message)!==null&&l!==void 0?l:"unknown error"}`),this._connectionRetryCount>=r)return;this._connectionRetryCount++;const h=this._retryTimerGenerator.next().value;h!==0&&((u=this._logger)===null||u===void 0||u.info(`Retrying in ${h} seconds`)),setTimeout(()=>{var d;this._connecting&&((d=this._logger)===null||d===void 0||d.info(e?"Retrying connection":"Trying to reconnect"),this._tryConnect())},h*1e3)}else this._reconnect()}),s.connect()}_reconnect(e=!1){e&&this._config.overlapManualReconnect?(this._previousConnection=this._currentConnection,this._currentConnection=void 0):this.disconnect(),this._startTryingToConnect(e)}}var Uw=null;typeof WebSocket<"u"?Uw=WebSocket:typeof MozWebSocket<"u"?Uw=MozWebSocket:typeof bm<"u"?Uw=bm.WebSocket||bm.MozWebSocket:typeof window<"u"?Uw=window.WebSocket||window.MozWebSocket:typeof self<"u"&&(Uw=self.WebSocket||self.MozWebSocket);class WOt extends GOt{constructor(e,n){if(super(n),this._socket=null,this._closingOnDemand=!1,e.hostName&&e.port)this._url=`ws${e.secure?"s":""}://${e.hostName}:${e.port}`;else if(e.url)this._url=e.url;else throw new Error("WebSocketConnection requires either hostName & port or url to be set")}get hasSocket(){return!!this._socket}sendRaw(e){var n;(n=this._socket)===null||n===void 0||n.send(e)}connect(){var e,n;(e=this._logger)===null||e===void 0||e.trace("WebSocketConnection connect"),this._connecting=!0,this._socket=new Uw(this._url,(n=this._additionalOptions)===null||n===void 0?void 0:n.wsOptions),this._socket.onopen=()=>{var i;(i=this._logger)===null||i===void 0||i.trace("WebSocketConnection onOpen"),this._connected=!0,this._connecting=!1,this._closingOnDemand=!1,this.emit(this.onConnect)},this._socket.onmessage=({data:i})=>{this.receiveRaw(i.toString())},this._socket.onerror=i=>{var r;(r=this._logger)===null||r===void 0||r.trace(`WebSocketConnection onError message:${i.message}`)},this._socket.onclose=i=>{var r;const s=this._connected,a=this._connecting;if((r=this._logger)===null||r===void 0||r.trace(`WebSocketConnection onClose wasConnected:${s.toString()} wasConnecting:${a.toString()} closingOnDemand:${this._closingOnDemand.toString()} wasClean:${i.wasClean.toString()}`),this._connected=!1,this._connecting=!1,this._closingOnDemand)this._closingOnDemand=!1,this.emit(this.onDisconnect,!0),this.emit(this.onEnd,!0);else{const o=new Error(`[${i.code}] ${i.reason}`);this.emit(this.onDisconnect,!1,o),this.emit(this.onEnd,!1,o)}this.clearSocket()}}disconnect(){var e,n;(e=this._logger)===null||e===void 0||e.trace("WebSocketConnection disconnect"),this._closingOnDemand=!0,(n=this._socket)===null||n===void 0||n.close()}clearSocket(){this._socket&&(this._socket.onopen=null,this._socket.onmessage=null,this._socket.onerror=null,this._socket.onclose=null,this._socket=null)}}function UO(t){var e,n,i;if(Array.isArray(t)){for(n=Array(e=t.length);e--;)n[e]=(i=t[e])&&typeof i=="object"?UO(i):i;return n}if(Object.prototype.toString.call(t)==="[object Object]"){n={};for(e in t)e==="__proto__"?Object.defineProperty(n,e,{value:UO(t[e]),configurable:!0,enumerable:!0,writable:!0}):n[e]=(i=t[e])&&typeof i=="object"?UO(i):i;return n}return t}const YOt={name:"away-notify"};class zB extends Error{constructor(e,n,i){super(`command "${e}" expected ${n} or more parameters, got ${i}`),this._command=e,this._expectedParams=n,this._actualParams=i,Object.setPrototypeOf(this,zB.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,zB)}get command(){return this._command}get expectedParams(){return this._expectedParams}get actualParams(){return this._actualParams}}class jB extends Error{constructor(e,n,i,r){var s;super(`required parameter "${n}" did not validate against ${(s=i.type)!==null&&s!==void 0?s:"regex"} validation: "${r}"`),this._command=e,this._paramName=n,this._paramSpec=i,this._givenValue=r,Object.setPrototypeOf(this,jB.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,jB)}get command(){return this._command}get paramName(){return this._paramName}get paramSpec(){return this._paramSpec}get givenValue(){return this._givenValue}}const DC={channelTypes:"#&",supportedUserModes:"iwso",supportedChannelModes:{prefix:"ov",list:"b",alwaysWithParam:"ovk",paramWhenSet:"l",noParam:"imnpst"},prefixes:[{modeChar:"v",prefix:"+"},{modeChar:"o",prefix:"@"}]};var L1e={exports:{}};(function(t){t.exports=e=>{if(typeof e!="string")throw new TypeError("Expected a string");return e.replace(/[|\\{}()[\]^$+*?.]/g,"\\$&").replace(/-/g,"\\x2d")},t.exports.default=t.exports})(L1e);var KOt=L1e.exports;const XOt=il(KOt);function R7(t,e="#&"){return new RegExp(`^[${XOt(e)}][^ \b\0
\r,]+$`).test(t)}const uce={0:"\0",n:`
`,r:"\r","":""};function hce(t){if(!t.startsWith("")||(t=t.substring(1),t.endsWith("")&&(t=t.slice(0,-1)),!t))return!1;t=t.replace(/\x10(.)/,(i,r)=>r in uce?uce[r]:"");let[e,n=""]=WT(t," ",2);return e=e?e.toUpperCase():"",{command:e,params:n}}const ZOt={"\\":"\\",";":":","\n":"n","\r":"r"," ":"s"};function JOt(t){return t.replace(/[\\;\n\r ]/g,e=>`\\${ZOt[e]}`)}function QOt(t){let e=`${t.nick}`;return t.user&&(e+=`!${t.user}`),t.host&&(e+=`@${t.host}`),e}function eNt(t,e,n,i,r=DC,s=!1){const a=new t(t.COMMAND,void 0,{serverProperties:r}),o={};if(a._paramSpec&&S7(a._paramSpec,(c,l)=>{if(!(s&&c.noServer)&&!(!s&&c.noClient)){if(l in e){const u=e[l];if(u!==void 0){if(t.checkParam(u,c,r))o[l]={value:u,trailing:!!c.trailing};else if(!c.optional)throw new Error(`required parameter "${l}" did not suit requirements: "${u}"`)}}if(!(l in o)&&!c.optional)throw new Error(`required parameter "${l}" not found in command "${t.COMMAND}"`)}}),a._parsedParams=o,a._paramSpec)for(const c of Object.keys(a._paramSpec))Object.defineProperty(a,c,{get(){var l,u;return(u=(l=this._parsedParams)===null||l===void 0?void 0:l[c])===null||u===void 0?void 0:u.value}});return a._initPrefixAndTags(n,i),a}class jt{static checkParam(e,n,i=DC){return!(n.type==="channel"&&!R7(e,i.channelTypes)||n.type==="channelList"&&!e.split(",").every(s=>R7(s,i.channelTypes))||n.match&&!n.match.test(e))}constructor(e,{params:n,tags:i,prefix:r,rawLine:s}={},{serverProperties:a=DC,isServer:o=!1,shouldParseParams:c=!0}={},l){this._params=[],this._serverProperties=DC,this._paramSpec=l,this._command=e,this._params=n,this._tags=i??new Map,this._prefix=r,this._serverProperties=a,this._raw=s,c&&this.parseParams(o)}getMinParamCount(e=!1){return this._paramSpec?Object.values(this._paramSpec).filter(n=>n.noServer&&e||n.noClient&&!e?!1:!n.optional).length:0}get paramCount(){var e,n;return(n=(e=this._params)===null||e===void 0?void 0:e.length)!==null&&n!==void 0?n:0}prefixToString(){return this._prefix?QOt(this._prefix):""}tagsToString(){return[...this._tags.entries()].map(([e,n])=>n?`${e}=${JOt(n)}`:e).join(";")}toString(e=!1,n=!1){const r=[n?this._buildCommandFromRawParams():this._buildCommandFromNamedParams()];if(e){const a=this.prefixToString();a&&r.unshift(`:${a}`)}const s=this.tagsToString();return s&&r.unshift(`@${s}`),r.join(" ")}_initPrefixAndTags(e,n){this._prefix=e,n&&(this._tags=n)}parseParams(e=!1){if(this._params){let n=this.getMinParamCount(e);if(n>this._params.length)throw new zB(this._command,n,this._params.length);const i=this._paramSpec;if(!i)return;let r=0;const s={};for(const[a,o]of Object.entries(i)){if(o.noServer&&e||o.noClient&&!e)continue;if(this._params.length-r<=n){if(o.optional)continue;if(this._params.length-r!==n)throw new Error("not enough parameters left for required parameters parsing (this is a library bug)")}let c=this._params[r];if(!c){if(o.optional)break;throw new Error("unexpected parameter underflow")}if(o.rest){const l=[];for(;this._params[r]&&!this._params[r].trailing;)l.push(this._params[r].value),++r;if(!l.length){if(o.optional)continue;throw new Error(`no parameters left for required rest parameter "${a}"`)}c={value:l.join(" "),trailing:!1}}if(jt.checkParam(c.value,o))s[a]={...c},o.optional||--n,o.rest||++r;else if(!o.optional)throw new jB(this._command,a,o,c.value);if(o.trailing)break}if(this._parsedParams=s,this._paramSpec)for(const a of Object.keys(this._paramSpec))Object.defineProperty(this,a,{get(){var o,c;return(c=(o=this._parsedParams)===null||o===void 0?void 0:o[a])===null||c===void 0?void 0:c.value}})}}get rawParamValues(){var e,n;return(n=(e=this._params)===null||e===void 0?void 0:e.map(i=>i.value))!==null&&n!==void 0?n:[]}get prefix(){return this._prefix}get command(){return this._command}get tags(){return this._tags}get rawLine(){return this._raw}isResponseTo(e){return!1}endsResponseTo(e){return!1}_acceptsInReplyCollection(e){return e.isResponseTo(this)}_buildCommandFromNamedParams(){const e=this._paramSpec?Object.keys(this._paramSpec):[];return[this._command,...e.map(n=>{var i;const r=(i=this._parsedParams)===null||i===void 0?void 0:i[n];if(r)return(r.trailing?":":"")+r.value}).filter(n=>n!==void 0)].join(" ")}_buildCommandFromRawParams(){var e,n;return[this._command,...(n=(e=this._params)===null||e===void 0?void 0:e.map(i=>`${i.trailing?":":""}${i.value}`))!==null&&n!==void 0?n:[]].join(" ")}}jt.COMMAND="";jt.SUPPORTS_CAPTURE=!1;class U1e extends jt{constructor(e,n,i){super(e,n,i,{reference:{},type:{optional:!0},additionalParams:{optional:!0}})}}U1e.COMMAND="BATCH";const tNt={name:"batch",messageTypes:[U1e],usesTags:!0},nNt={name:"cap-notify"};class B1e extends jt{constructor(e,n,i){super(e,n,i,{newUser:{},newHost:{}})}}B1e.COMMAND="CHGHOST";const iNt={name:"chghost",messageTypes:[B1e]},rNt={name:"invite-notify"};class F1e extends jt{}F1e.COMMAND="ACK";const sNt={name:"labeled-response",messageTypes:[F1e],usesTags:!0},aNt={name:"message-tags",usesTags:!0},oNt={name:"multi-prefix"},cNt=Object.freeze(Object.defineProperty({__proto__:null,AwayNotify:YOt,Batch:tNt,CapNotify:nNt,ChgHost:iNt,InviteNotify:rNt,LabeledResponse:sNt,MessageTags:aNt,MultiPrefix:oNt},Symbol.toStringTag,{value:"Module"}));class lNt{constructor(e,n,...i){this._client=e,this._originalMessage=n,this._messages=[],this._endEventHandlers=new Map,this._types=new Set(i)}untilEvent(e){this._cleanEndEventHandler(e);const n=this._client.on(e,()=>this.end());this._endEventHandlers.set(e,n)}async promise(){return this._promise||(this._promise=new Promise(e=>{this._promiseResolve=e})),await this._promise}collect(e){return this._originalMessage._acceptsInReplyCollection(e)?(this._messages.push(e),e.endsResponseTo(this._originalMessage)&&this.end(),!0):!1}end(){this._client.stopCollect(this),this._cleanEndEventHandlers(),this._promiseResolve&&this._promiseResolve(this._messages)}_cleanEndEventHandlers(){this._endEventHandlers.forEach(e=>{this._client.removeListener(e)}),this._endEventHandlers.clear()}_cleanEndEventHandler(e){this._endEventHandlers.has(e)&&(this._client.removeListener(this._endEventHandlers.get(e)),this._endEventHandlers.delete(e))}}class PZ extends jt{constructor(e,n,i){super(e,n,i,{password:{}})}}PZ.COMMAND="PASS";class BO extends jt{constructor(e,n,i){super(e,n,i,{nick:{}})}}BO.COMMAND="NICK";class DZ extends jt{constructor(e,n,i){super(e,n,i,{user:{},mode:{},unused:{},realName:{trailing:!0}})}}DZ.COMMAND="USER";class z1e extends jt{constructor(e,n,i){super(e,n,i,{name:{},password:{}})}}z1e.COMMAND="OPER";class LZ extends jt{constructor(e,n,i){super(e,n,i,{text:{trailing:!0,optional:!0}})}}LZ.COMMAND="QUIT";class j1e extends jt{constructor(e,n,i){super(e,n,i,{server:{},reason:{trailing:!0}})}}j1e.COMMAND="SQUIT";class AI extends jt{constructor(e,n,i){super(e,n,i,{channel:{type:"channel"},key:{optional:!0}})}}AI.COMMAND="JOIN";class RI extends jt{constructor(e,n,i){super(e,n,i,{channel:{type:"channel"},reason:{trailing:!0,optional:!0}})}}RI.COMMAND="PART";class HB extends Error{constructor(e){super(`Unknown channel mode character ${e}`),this._char=e,Object.setPrototypeOf(this,HB.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,HB)}get char(){return this._char}}class H1e extends jt{constructor(e,n,i){super(e,n,i,{target:{},modes:{rest:!0,optional:!0}})}get isChannel(){return R7(this.target,this._serverProperties.channelTypes)}separate(){const e=[],n=this.modes;if(!n)throw new Error("can't separate a channel mode request, just set actions");const i=n.split(" "),r=i.shift();let s="add";for(const a of r){let o=s;switch(a){case"+":{s="add";break}case"-":{s="remove";break}default:{let c=!1,l=!0;if(this.isChannel){if(this._serverProperties.supportedChannelModes.alwaysWithParam.includes(a)||this._serverProperties.supportedChannelModes.prefix.includes(a))c=!0;else if(this._serverProperties.supportedChannelModes.paramWhenSet.includes(a))s==="add"&&(c=!0);else if(this._serverProperties.supportedChannelModes.list.includes(a))i.length?c=!0:o="getList";else if(!this._serverProperties.supportedChannelModes.noParam.includes(a))throw new HB(a)}else l=this._serverProperties.supportedUserModes.includes(a);if(c&&!i.length)continue;e.push({prefix:this._prefix,action:o,letter:a,param:c?i.shift():void 0,known:l})}}}return e}}H1e.COMMAND="MODE";class V1e extends jt{constructor(e,n,i){super(e,n,i,{channel:{type:"channel"},newTopic:{optional:!0,trailing:!0}})}}V1e.COMMAND="TOPIC";class EP extends jt{constructor(e,n,i){super(e,n,i,{channel:{type:"channelList",optional:!0}})}}EP.COMMAND="NAMES";EP.SUPPORTS_CAPTURE=!0;class G1e extends jt{constructor(e,n,i){super(e,n,i,{channel:{optional:!0},server:{optional:!0}})}}G1e.COMMAND="LIST";class q1e extends jt{constructor(e,n,i){super(e,n,i,{target:{},channel:{type:"channel"}})}}q1e.COMMAND="INVITE";class $1e extends jt{constructor(e,n,i){super(e,n,i,{channel:{type:"channel"},target:{},reason:{trailing:!0,optional:!0}})}}$1e.COMMAND="KICK";class W1e extends jt{constructor(e,n,i){super(e,n,i,{server:{optional:!0}})}}W1e.COMMAND="TIME";class MI extends jt{constructor(e,n,i){super(e,n,i,{target:{},text:{trailing:!0}})}}MI.COMMAND="PRIVMSG";class n5 extends jt{constructor(e,n,i){super(e,n,i,{target:{},text:{trailing:!0}})}}n5.COMMAND="NOTICE";class i5 extends jt{constructor(e,n,i){super(e,n,i,{mask:{},flags:{optional:!0},extendedMask:{optional:!0,trailing:!0}})}}i5.COMMAND="WHO";class Y1e extends jt{constructor(e,n,i){super(e,n,i,{server:{optional:!0},nickMask:{}})}}Y1e.COMMAND="WHOIS";class K1e extends jt{constructor(e,n,i){super(e,n,i,{nick:{},count:{optional:!0},server:{optional:!0}})}}K1e.COMMAND="WHOWAS";class X1e extends jt{constructor(e,n,i){super(e,n,i,{target:{},reason:{trailing:!0,optional:!0}})}}X1e.COMMAND="KILL";class VB extends jt{constructor(e,n,i){super(e,n,i,{text:{trailing:!0}})}}VB.COMMAND="PING";class GB extends jt{constructor(e,n,i){super(e,n,i,{server:{noClient:!0},text:{trailing:!0}})}}GB.COMMAND="PONG";class Z1e extends jt{constructor(e,n,i){super(e,n,i,{text:{trailing:!0}})}}Z1e.COMMAND="ERROR";class J1e extends jt{constructor(e,n,i){super(e,n,i,{text:{trailing:!0,optional:!0}})}}J1e.COMMAND="AWAY";class Q1e extends jt{}Q1e.COMMAND="REHASH";class exe extends jt{}exe.COMMAND="RESTART";class txe extends jt{constructor(e,n,i){super(e,n,i,{text:{trailing:!0}})}}txe.COMMAND="WALLOPS";class nxe extends jt{constructor(e,n,i){super(e,n,i,{nicks:{rest:!0}})}}nxe.COMMAND="USERHOST";class ixe extends jt{constructor(e,n,i){super(e,n,i,{nicks:{rest:!0}})}}ixe.COMMAND="ISON";class tp extends jt{constructor(e,n,i){super(e,n,i,{target:{match:/^(?:[a-z_\-\[\]\\^{}|`][a-z0-9_\-\[\]\\^{}|`]+|\*)$/i,optional:!0,noClient:!0},subCommand:{match:/^(?:LS|LIST|REQ|ACK|NAK|END|NEW|DEL)$/i},version:{match:/^\d+$/,optional:!0},continued:{match:/^\*$/,optional:!0},capabilities:{trailing:!0,optional:!0}})}isResponseTo(e){if(!(e instanceof tp))return!1;switch(this.subCommand){case"ACK":case"NAK":return e.subCommand==="REQ"&&e.capabilities===this.capabilities.trim();case"LS":case"LIST":return e.subCommand===this.subCommand;default:return!1}}endsResponseTo(e){if(!(e instanceof tp))return!1;switch(this.subCommand){case"LS":case"LIST":return!this.continued;default:return!0}}}tp.COMMAND="CAP";tp.SUPPORTS_CAPTURE=!0;class rxe extends jt{constructor(e,n,i){super(e,n,i,{target:{}})}}rxe.COMMAND="TAGMSG";const sxe=Object.freeze(Object.defineProperty({__proto__:null,Away:J1e,CapabilityNegotiation:tp,ChannelInvite:q1e,ChannelJoin:AI,ChannelKick:$1e,ChannelList:G1e,ChannelPart:RI,ClientQuit:LZ,ErrorMessage:Z1e,IsOnQuery:ixe,Kill:X1e,Mode:H1e,Names:EP,NickChange:BO,Notice:n5,OperLogin:z1e,Password:PZ,Ping:VB,Pong:GB,PrivateMessage:MI,Rehash:Q1e,Restart:exe,ServerQuit:j1e,TagMessage:rxe,Time:W1e,Topic:V1e,UserHostQuery:nxe,UserRegistration:DZ,Wallops:txe,WhoIsQuery:Y1e,WhoQuery:i5,WhoWasQuery:K1e},Symbol.toStringTag,{value:"Module"}));class UZ extends jt{constructor(e,n,i){super(e,n,i,{me:{},welcomeText:{trailing:!0}})}}UZ.COMMAND="001";class axe extends jt{constructor(e,n,i){super(e,n,i,{me:{},yourHost:{trailing:!0}})}}axe.COMMAND="002";class oxe extends jt{constructor(e,n,i){super(e,n,i,{me:{},createdText:{trailing:!0}})}}oxe.COMMAND="003";class BZ extends jt{constructor(e,n,i){super(e,n,i,{me:{},serverName:{},version:{},userModes:{},channelModes:{},channelModesWithParam:{optional:!0}})}}BZ.COMMAND="004";class FZ extends jt{constructor(e,n,i){super(e,n,i,{me:{},supports:{rest:!0},suffix:{trailing:!0}})}}FZ.COMMAND="005";class cxe extends jt{constructor(e,n,i){super(e,n,i,{me:{},modes:{}})}}cxe.COMMAND="221";class lxe extends jt{constructor(e,n,i){super(e,n,i,{me:{},nick:{},text:{trailing:!0}})}}lxe.COMMAND="301";class uxe extends jt{constructor(e,n,i){super(e,n,i,{me:{},hosts:{trailing:!0}})}}uxe.COMMAND="302";class hxe extends jt{constructor(e,n,i){super(e,n,i,{me:{},suffix:{trailing:!0}})}}hxe.COMMAND="305";class dxe extends jt{constructor(e,n,i){super(e,n,i,{me:{},suffix:{trailing:!0}})}}dxe.COMMAND="306";class fxe extends jt{constructor(e,n,i){super(e,n,i,{me:{},nick:{},username:{},host:{},_unused:{},realname:{trailing:!0}})}}fxe.COMMAND="311";class pxe extends jt{constructor(e,n,i){super(e,n,i,{me:{},query:{},suffix:{trailing:!0}})}isResponseTo(e){return e instanceof i5}endsResponseTo(){return!0}}pxe.COMMAND="315";class mxe extends jt{constructor(e,n,i){super(e,n,i,{me:{},nickMask:{},suffix:{trailing:!0}})}}mxe.COMMAND="318";class gxe extends jt{constructor(e,n,i){super(e,n,i,{me:{},nick:{},channels:{trailing:!0}})}}gxe.COMMAND="319";class vxe extends jt{constructor(e,n,i){super(e,n,i,{me:{},channel:{type:"channel"},memberCount:{},topic:{trailing:!0}})}}vxe.COMMAND="322";class _xe extends jt{constructor(e,n,i){super(e,n,i,{me:{},suffix:{trailing:!0}})}}_xe.COMMAND="323";class yxe extends jt{constructor(e,n,i){super(e,n,i,{me:{},channel:{type:"channel"},modes:{rest:!0}})}}yxe.COMMAND="324";class bxe extends jt{constructor(e,n,i){super(e,n,i,{me:{},channel:{type:"channel"},suffix:{trailing:!0}})}}bxe.COMMAND="331";class Exe extends jt{constructor(e,n,i){super(e,n,i,{me:{},channel:{type:"channel"},topic:{trailing:!0}})}}Exe.COMMAND="332";class Sxe extends jt{constructor(e,n,i){super(e,n,i,{me:{},channel:{type:"channel"},who:{},ts:{}})}}Sxe.COMMAND="333";class Txe extends jt{constructor(e,n,i){super(e,n,i,{me:{},nick:{},channel:{type:"channel"}})}}Txe.COMMAND="341";class xxe extends jt{constructor(e,n,i){super(e,n,i,{me:{},channel:{type:"channel"},mask:{},creatorName:{optional:!0},timestamp:{optional:!0}})}}xxe.COMMAND="348";class wxe extends jt{constructor(e,n,i){super(e,n,i,{me:{},channel:{type:"channel"},suffix:{trailing:!0}})}}wxe.COMMAND="349";class Cxe extends jt{constructor(e,n,i){super(e,n,i,{me:{},channel:{},user:{},host:{},server:{},nick:{},flags:{},hopsAndRealName:{trailing:!0}})}get isAway(){return this.flags.includes("G")}get isOper(){return this.flags.includes("*")}get isBot(){return this.flags.includes("B")}isResponseTo(e){return e instanceof i5}}Cxe.COMMAND="352";class Axe extends jt{constructor(e,n,i){super(e,n,i,{me:{},channelType:{},channel:{type:"channel"},names:{trailing:!0}})}isResponseTo(e){return e instanceof EP}}Axe.COMMAND="353";class Rxe extends jt{constructor(e,n,i){super(e,n,i,{me:{},channel:{},suffix:{trailing:!0}})}isResponseTo(e){return e instanceof EP}endsResponseTo(){return!0}}Rxe.COMMAND="366";class Mxe extends jt{constructor(e,n,i){super(e,n,i,{me:{},channel:{type:"channel"},mask:{},creatorName:{optional:!0},timestamp:{optional:!0}})}}Mxe.COMMAND="367";class Oxe extends jt{constructor(e,n,i){super(e,n,i,{me:{},channel:{type:"channel"},suffix:{trailing:!0}})}}Oxe.COMMAND="368";class Nxe extends jt{constructor(e,n,i){super(e,n,i,{me:{},line:{trailing:!0}})}}Nxe.COMMAND="372";class Ixe extends jt{constructor(e,n,i){super(e,n,i,{me:{},line:{trailing:!0}})}}Ixe.COMMAND="375";class zZ extends jt{constructor(e,n,i){super(e,n,i,{me:{},suffix:{trailing:!0}})}}zZ.COMMAND="376";class kxe extends jt{constructor(e,n,i){super(e,n,i,{me:{},suffix:{trailing:!0}})}}kxe.COMMAND="381";class Pxe extends jt{constructor(e,n,i){super(e,n,i,{me:{},server:{optional:!0},timestamp:{trailing:!0}})}}Pxe.COMMAND="391";class Dxe extends jt{constructor(e,n,i){super(e,n,i,{me:{},nick:{},suffix:{trailing:!0}})}}Dxe.COMMAND="401";class Lxe extends jt{constructor(e,n,i){super(e,n,i,{me:{},server:{},suffix:{trailing:!0}})}}Lxe.COMMAND="402";class Uxe extends jt{constructor(e,n,i){super(e,n,i,{me:{},channel:{},suffix:{trailing:!0}})}}Uxe.COMMAND="403";class Bxe extends jt{constructor(e,n,i){super(e,n,i,{me:{},channel:{type:"channel"},suffix:{trailing:!0}})}}Bxe.COMMAND="404";class Fxe extends jt{constructor(e,n,i){super(e,n,i,{me:{},channel:{type:"channel"},suffix:{trailing:!0}})}}Fxe.COMMAND="405";class zxe extends jt{constructor(e,n,i){super(e,n,i,{me:{},subCommand:{},suffix:{trailing:!0}})}}zxe.COMMAND="410";class jxe extends jt{constructor(e,n,i){super(e,n,i,{me:{},originalCommand:{},suffix:{trailing:!0}})}isResponseTo(e){return e.command===this.originalCommand}endsResponseTo(){return!0}}jxe.COMMAND="421";class jZ extends jt{constructor(e,n,i){super(e,n,i,{me:{},suffix:{trailing:!0}})}}jZ.COMMAND="422";class Hxe extends jt{constructor(e,n,i){super(e,n,i,{me:{},suffix:{trailing:!0}})}isResponseTo(e){return e.command==="NICK"}endsResponseTo(){return!0}}Hxe.COMMAND="431";class Vxe extends jt{constructor(e,n,i){super(e,n,i,{me:{},nick:{},suffix:{trailing:!0}})}isResponseTo(e){return e.command==="NICK"}endsResponseTo(){return!0}}Vxe.COMMAND="432";class Gxe extends jt{constructor(e,n,i){super(e,n,i,{me:{},nick:{},suffix:{trailing:!0}})}isResponseTo(e){return e.command==="NICK"}endsResponseTo(){return!0}}Gxe.COMMAND="433";class qxe extends jt{constructor(e,n,i){super(e,n,i,{me:{},nick:{},suffix:{trailing:!0}})}isResponseTo(e){return e.command==="NICK"}endsResponseTo(){return!0}}qxe.COMMAND="436";class $xe extends jt{constructor(e,n,i){super(e,n,i,{me:{},nick:{},channel:{type:"channel"},suffix:{trailing:!0}})}isResponseTo(e){return e.command==="NICK"}endsResponseTo(){return!0}}$xe.COMMAND="441";class Wxe extends jt{constructor(e,n,i){super(e,n,i,{me:{},channel:{type:"channel"},suffix:{trailing:!0}})}isResponseTo(e){return e.command==="NICK"}endsResponseTo(){return!0}}Wxe.COMMAND="442";class Yxe extends jt{constructor(e,n,i){super(e,n,i,{me:{},nick:{},channel:{type:"channel"},suffix:{trailing:!0}})}isResponseTo(e){return e.command==="NICK"}endsResponseTo(){return!0}}Yxe.COMMAND="443";class Kxe extends jt{constructor(e,n,i){super(e,n,i,{me:{},suffix:{trailing:!0}})}}Kxe.COMMAND="451";class Xxe extends jt{constructor(e,n,i){super(e,n,i,{me:{},originalCommand:{},suffix:{trailing:!0}})}}Xxe.COMMAND="461";class HZ extends jt{constructor(e,n,i){super(e,n,i,{me:{},suffix:{trailing:!0}})}}HZ.COMMAND="462";class Zxe extends jt{constructor(e,n,i){super(e,n,i,{me:{},channel:{type:"channel"},suffix:{trailing:!0}})}}Zxe.COMMAND="471";class Jxe extends jt{constructor(e,n,i){super(e,n,i,{me:{},char:{},suffix:{trailing:!0}})}}Jxe.COMMAND="472";class Qxe extends jt{constructor(e,n,i){super(e,n,i,{me:{},channel:{type:"channel"},suffix:{trailing:!0}})}}Qxe.COMMAND="473";class ewe extends jt{constructor(e,n,i){super(e,n,i,{me:{},channel:{type:"channel"},suffix:{trailing:!0}})}}ewe.COMMAND="474";class twe extends jt{constructor(e,n,i){super(e,n,i,{me:{},channel:{type:"channel"},suffix:{trailing:!0}})}}twe.COMMAND="475";class nwe extends jt{constructor(e,n,i){super(e,n,i,{me:{},channel:{},suffix:{trailing:!0}})}}nwe.COMMAND="479";class iwe extends jt{constructor(e,n,i){super(e,n,i,{me:{},suffix:{trailing:!0}})}}iwe.COMMAND="481";class rwe extends jt{constructor(e,n,i){super(e,n,i,{me:{},channel:{},suffix:{trailing:!0}})}}rwe.COMMAND="482";class swe extends jt{constructor(e,n,i){super(e,n,i,{me:{},suffix:{trailing:!0}})}}swe.COMMAND="491";class awe extends jt{constructor(e,n,i){super(e,n,i,{me:{},modeChar:{optional:!0,match:/^\w$/},suffix:{trailing:!0}})}}awe.COMMAND="501";class owe extends jt{constructor(e,n,i){super(e,n,i,{me:{},suffix:{trailing:!0}})}}owe.COMMAND="502";const cwe=Object.freeze(Object.defineProperty({__proto__:null,Error401NoSuchNick:Dxe,Error402NoSuchServer:Lxe,Error403NoSuchChannel:Uxe,Error404CanNotSendToChan:Bxe,Error405TooManyChannels:Fxe,Error410InvalidCapCmd:zxe,Error421UnknownCommand:jxe,Error422NoMotd:jZ,Error431NoNickNameGiven:Hxe,Error432ErroneusNickname:Vxe,Error433NickNameInUse:Gxe,Error436NickCollision:qxe,Error441UserNotInChannel:$xe,Error442NotOnChannel:Wxe,Error443UserOnChannel:Yxe,Error451NotRegistered:Kxe,Error461NeedMoreParams:Xxe,Error462AlreadyRegistered:HZ,Error471ChannelIsFull:Zxe,Error472UnknownMode:Jxe,Error473InviteOnlyChan:Qxe,Error474BannedFromChan:ewe,Error475BadChannelKey:twe,Error479BadChanName:nwe,Error481NoPrivileges:iwe,Error482ChanOpPrivsNeeded:rwe,Error491NoOperHost:swe,Error501UmodeUnknownFlag:awe,Error502UsersDontMatch:owe,Reply001Welcome:UZ,Reply002YourHost:axe,Reply003Created:oxe,Reply004ServerInfo:BZ,Reply005Isupport:FZ,Reply221UmodeIs:cxe,Reply301Away:lxe,Reply302UserHost:uxe,Reply305UnAway:hxe,Reply306NowAway:dxe,Reply311WhoisUser:fxe,Reply315EndOfWho:pxe,Reply318EndOfWhois:mxe,Reply319WhoisChannels:gxe,Reply322List:vxe,Reply323ListEnd:_xe,Reply324ChannelModeIs:yxe,Reply331NoTopic:bxe,Reply332Topic:Exe,Reply333TopicWhoTime:Sxe,Reply341Inviting:Txe,Reply348ExceptList:xxe,Reply349EndOfExceptList:wxe,Reply352WhoReply:Cxe,Reply353NamesReply:Axe,Reply366EndOfNames:Rxe,Reply367BanList:Mxe,Reply368EndOfBanList:Oxe,Reply372Motd:Nxe,Reply375MotdStart:Ixe,Reply376EndOfMotd:zZ,Reply381YoureOper:kxe,Reply391Time:Pxe},Symbol.toStringTag,{value:"Module"})),uNt=new Map([...Object.values(sxe),...Object.values(cwe)].map(t=>[t.COMMAND,t]));function hNt(t){const[e,n]=WT(t,"!",2);if(n){const[i,r]=WT(n,"@",2);return r?{nick:e,user:i,host:r}:{nick:e,host:i}}return{nick:e}}const dce={":":";",n:`
`,r:"\r",s:" "};function dNt(t){const e=new Map,n=t.split(";");for(const i of n){const[r,s]=WT(i,"=",2);r!==""&&e.set(r,s?s.replace(/\\(.?)/g,(a,o)=>Object.prototype.hasOwnProperty.call(dce,o)?dce[o]:o):"")}return e}function fNt(t,e=DC,n=uNt,i=!1,r=[],s=!0){const a=t.split(" ");let o,c;const l=[];let u,h;for(;a.length;){if([o]=a,o.startsWith("@")&&!u&&!c&&!h)u=dNt(o.slice(1));else if(o.startsWith(":"))if(!h&&!c)o.length>1&&(h=hNt(o.slice(1)));else{l.push({value:a.join(" ").slice(1),trailing:!0});break}else c?l.push({value:o,trailing:!1}):c=o.toUpperCase();a.shift()}if(u||(u=new Map),!c)throw new Error(`line without command received: ${t}`);s&&(s=!r.includes(c));let d=jt;return n.has(c)&&(d=n.get(c)),new d(c,{params:l,tags:u,prefix:h,rawLine:t},{serverProperties:e,isServer:i,shouldParseParams:s})}class lwe extends yP{constructor(e){super(),this._registered=!1,this._supportsCapabilities=!0,this._events=new Map,this._registeredMessageTypes=new Map,this.onConnect=this.registerEvent(),this.onRegister=this.registerEvent(),this.onDisconnect=this.registerEvent(),this.onPrivmsg=this.registerEvent(),this.onAction=this.registerEvent(),this.onNotice=this.registerEvent(),this.onNickChange=this.registerEvent(),this.onCtcp=this.registerEvent(),this.onCtcpReply=this.registerEvent(),this.onPasswordError=this.registerEvent(),this.onAnyMessage=this.registerEvent(),this._serverProperties=UO(DC),this._supportedFeatures={},this._collectors=[],this._clientCapabilities=new Map,this._serverCapabilities=new Map,this._negotiatedCapabilities=new Map,this._currentChannels=new Set,this._hasRegisteredBefore=!1,this._channelsFromLastRegister=new Set,this._initialConnectionSetupDone=!1;const{connection:n,credentials:i,channels:r,channelTypes:s,webSocket:a,logger:o={}}=e;this._options=e;const{pingOnInactivity:c=60,pingTimeout:l=10}=n;this._pingOnInactivity=c,this._pingTimeout=l,this._currentNick=i.nick,this._logger=e5({name:"ircv3",emoji:!0,...o}),this.registerCoreMessageTypes();const{hostName:u,secure:h,reconnect:d=!0}=n,f={hostName:u,port:this.port,secure:h},p={lineBased:!0,logger:this._logger,additionalOptions:e.connectionOptions},g=a?WOt:qOt;d?this._connection=new $Ot(g,f,p):this._connection=new g(p,this._logger,e.connectionOptions);for(const _ of Object.values(cNt))this.addCapability(_);this.addInternalListener(this.onRegister,async()=>{const _=this._hasRegisteredBefore,v=this._channelsFromLastRegister;this._hasRegisteredBefore=!0,this._channelsFromLastRegister=new Set;const b=_&&this._options.rejoinChannelsOnReconnect?v:await E7(r);if(b)for(const S of b)this.join(S)}),this.onTypedMessage(tp,async({subCommand:_,capabilities:v})=>{const b=v.split(" ");switch(_.toUpperCase()){case"NEW":{this._logger.debug(`Server registered new capabilities: ${b.join(", ")}`);const S=O2(b,M=>{if(!M)return{};const[R,I]=WT(M,"=",2);return{[R]:{name:R,param:I||!0}}});for(const[M,R]of Object.entries(S))this._serverCapabilities.set(M,R);const x=Object.keys(S);await this._negotiateCapabilities(Array.from(this._clientCapabilities.entries()).filter(([M])=>x.includes(M)).map(([,M])=>M));break}case"DEL":{this._logger.debug(`Server removed capabilities: ${b.join(", ")}`);for(const S of b)this._serverCapabilities.delete(S),this._negotiatedCapabilities.delete(S)}}}),this.onTypedMessage(VB,({text:_})=>{this.sendMessage(GB,{text:_})}),this.onTypedMessage(UZ,({me:_})=>this._handleReceivedClientNick(_)),this.onTypedMessage(BZ,({userModes:_})=>{_&&(this._serverProperties.supportedUserModes=_)}),this.onTypedMessage(FZ,({supports:_})=>{const v=O2(_.split(" "),b=>{const[S,x]=WT(b,"=",2);return{[S]:x||!0}});this._supportedFeatures={...this._supportedFeatures,...v}}),this.onTypedMessage(zZ,({me:_})=>{this._registered||(this._handleReceivedClientNick(_),this._registered=!0,this.emit(this.onRegister))}),this.onTypedMessage(jZ,({me:_})=>{this._registered||(this._handleReceivedClientNick(_),this._registered=!0,this.emit(this.onRegister))}),this.onTypedMessage(HZ,({me:_})=>{this._registered||(this._logger.warn("We thought we're not registered yet, but we actually are"),this._handleReceivedClientNick(_),this._registered=!0,this.emit(this.onRegister))}),this.onTypedMessage(MI,_=>{var v;const{target:b,text:S}=_,x=hce(S),M=(v=_.prefix)===null||v===void 0?void 0:v.nick;x?x.command==="ACTION"?this.emit(this.onAction,b,M,x.params,_):this.emit(this.onCtcp,b,M,x.command,x.params,_):this.emit(this.onPrivmsg,b,M,S,_)}),this.onTypedMessage(BO,_=>{var v;const{nick:b}=_,S=(v=_.prefix)===null||v===void 0?void 0:v.nick;S===this._currentNick&&(this._currentNick=b),this.emit(this.onNickChange,S,b,_)}),this.onTypedMessage(n5,_=>{var v;const{target:b,text:S}=_,x=hce(S),M=(v=_.prefix)===null||v===void 0?void 0:v.nick;x&&this.emit(this.onCtcpReply,b,M,x.command,x.params,_),this.emit(this.onNotice,b,M,S,_)}),this._options.manuallyAcknowledgeJoins||this.onTypedMessage(AI,({channel:_,prefix:v})=>{(v==null?void 0:v.nick)===this._currentNick&&this.acknowledgeJoin(_)}),this.onTypedMessage(RI,_=>{var v;((v=_.prefix)===null||v===void 0?void 0:v.nick)===this._currentNick&&(this._currentChannels.delete(_.channel),this._channelsFromLastRegister.delete(_.channel))}),this.addInternalListener(this.onRegister,()=>this._startPingCheckTimer()),this._desiredNick=i.nick,this._userName=i.userName,this._realName=i.realName,s&&(this._serverProperties.channelTypes=s)}receiveLine(e){var n;this._logger.debug(`Received message: ${e}`);let i;try{i=fNt(e,this._serverProperties,this._registeredMessageTypes,!0,this._options.nonConformingCommands)}catch(r){this._logger.error(`Error parsing message: ${r.message}`),this._logger.trace((n=r.stack)!==null&&n!==void 0?n:"No stack available");return}this._logger.trace(`Parsed message: ${JSON.stringify(i)}`),this._startPingCheckTimer(),this.emit(this.onAnyMessage,i),this._handleEvents(i)}get serverProperties(){return UO(this._serverProperties)}get port(){const{webSocket:e,connection:{port:n,secure:i}}=this._options;return n||(e?i?443:80:i?6697:6667)}pingCheck(){const e=Date.now(),n=e.toString(),i=this.onTypedMessage(GB,r=>{const{text:s}=r;s===n&&(this._logger.debug(`Current ping: ${Date.now()-e}ms`),this._pingTimeoutTimer&&clearTimeout(this._pingTimeoutTimer),this.removeMessageListener(i))});this._pingTimeoutTimer=setTimeout(()=>{this.removeMessageListener(i),this._options.connection.reconnect===!1?this._logger.error(`Disconnecting because the last ping took over ${this._pingTimeout} seconds`):this._logger.warn(`Reconnecting because the last ping took over ${this._pingTimeout} seconds`),this._connection.assumeExternalDisconnect()},this._pingTimeout*1e3),this.sendMessage(VB,{text:n})}reconnect(e){this.quit(e),this.connect()}registerMessageType(e){e.COMMAND!==""&&(this._logger.trace(`Registering message type ${e.COMMAND}`),this._registeredMessageTypes.set(e.COMMAND.toUpperCase(),e))}knowsCommand(e){return this._registeredMessageTypes.has(e.toUpperCase())}getCommandClass(e){return this._registeredMessageTypes.get(e.toUpperCase())}acknowledgeJoin(e){this._currentChannels.add(e),this._channelsFromLastRegister.add(e)}connect(){this._supportsCapabilities=!1,this._negotiatedCapabilities=new Map,this._currentChannels=new Set,this._currentNick=this._desiredNick,this._setupConnection(),this._logger.info(`Connecting to ${this._options.connection.hostName}:${this.port}`),this._connection.connect()}addCapability(e){if(this._clientCapabilities.set(e.name,e),e.messageTypes)for(const n of Object.values(e.messageTypes))this.registerMessageType(n)}async registerCapability(e){return this.addCapability(e),this._serverCapabilities.has(e.name)?await this._negotiateCapabilities([e]):[]}send(e){this.sendRaw(e.toString())}sendRaw(e){this._connection.isConnected&&(this._logger.debug(`Sending message: ${e}`),this._connection.sendLine(e))}onNamedMessage(e,n,i){this._events.has(e)||this._events.set(e,new Map);const r=this._events.get(e);if(!i)do i=`${e}:${qMt(Math.random()*1e4,4,"0")}`;while(r.has(i));return r.set(i,n),i}onTypedMessage(e,n,i){return this.onNamedMessage(e.COMMAND,n,i)}removeMessageListener(e){const[n]=e.split(":");this._events.has(n)&&this._events.get(n).delete(e)}createMessage(e,n,i){const r=i?new Map(Object.entries(i)):void 0;return eNt(e,n,void 0,r,this.serverProperties)}sendMessage(e,n,i){this.send(this.createMessage(e,n,i))}async sendMessageAndCaptureReply(e,n){if(!e.SUPPORTS_CAPTURE)throw new Error(`The command "${e.COMMAND}" does not support reply capture`);const i=this.createMessage(e,n),r=this.collect(i).promise();return this.send(i),await r}get isConnected(){return this._connection.isConnected}get isConnecting(){return this._connection.isConnecting}get isRegistered(){return this._registered}get currentNick(){return this._currentNick}get currentChannels(){return Array.from(this._currentChannels)}collect(e,...n){const i=new lNt(this,e,...n);return this._collectors.push(i),i}stopCollect(e){this._collectors.splice(this._collectors.findIndex(n=>n===e),1)}join(e,n){this.sendMessage(AI,{channel:e,key:n})}part(e){this.sendMessage(RI,{channel:e})}quit(e){this.sendMessage(LZ,{text:e}),this.quitAbruptly()}quitAbruptly(){this._registered=!1,this._connection.disconnect()}say(e,n,i={}){this.sendMessage(MI,{target:e,text:n},i)}sendCtcp(e,n,i){this.say(e,`${n.toUpperCase()} ${i}`)}action(e,n){this.sendCtcp(e,"ACTION",n)}changeNick(e){this._currentNick!==e&&(this._desiredNick=e,this.isRegistered&&this.sendMessage(BO,{nick:e}))}registerCoreMessageTypes(){S7(sxe,e=>{this.registerMessageType(e)}),S7(cwe,e=>{this.registerMessageType(e)})}async _negotiateCapabilityBatch(e){return await Promise.all(e.filter(n=>n.length).map(async n=>await this._negotiateCapabilities(n)))}async _negotiateCapabilities(e){const n=O2(e,a=>({[a.name]:a})),r=(await this.sendMessageAndCaptureReply(tp,{subCommand:"REQ",capabilities:e.map(a=>a.name).join(" ")})).shift();if(!r)throw new Error("capability negotiation failed unexpectedly without any reply");if(!(r instanceof tp))throw new Error(`capability negotiation failed unexpectedly with "${r.command}" command`);const s=r.capabilities.split(" ").filter(a=>a);if(r.subCommand==="ACK"){this._logger.debug(`Successfully negotiated capabilities: ${s.join(", ")}`);const a=s.map(o=>n[o]);for(const o of a){const c=this._clientCapabilities.get(o.name);c.param=o.param,this._negotiatedCapabilities.set(c.name,c)}return a}return this._logger.warn(`Failed to negotiate capabilities: ${s.join(", ")}`),new Error("capabilities failed to negotiate")}_setupConnection(){this._initialConnectionSetupDone||(this._connection.onConnect(async()=>{var e,n;this._logger.info(`Connection to server ${this._options.connection.hostName}:${this.port} established`),this.emit(this.onConnect),this._logger.debug("Determining connection password");try{const[i]=await Promise.all([E7(this._options.credentials.password),this.sendMessageAndCaptureReply(tp,{subCommand:"LS",version:"302"}).then(async r=>{if(!r.length||!(r[0]instanceof tp))return this._logger.debug("Server does not support capabilities"),[];this._supportsCapabilities=!0;const s=r.map(o=>O2(o.capabilities.split(" "),c=>{if(!c)return{};const[l,u]=WT(c,"=",2);return{[l]:{name:l,param:u||!0}}}));this._serverCapabilities=new Map(Object.entries(Object.assign({},...s))),this._logger.debug(`Capabilities supported by server: ${Array.from(this._serverCapabilities.keys()).join(", ")}`);const a=s.map(o=>{const c=Object.keys(o);return Array.from(this._clientCapabilities.entries()).filter(([l])=>c.includes(l)).map(([,l])=>l)});return await this._negotiateCapabilityBatch(a)}).then(()=>{this.sendMessage(tp,{subCommand:"END"})})]);i&&this.sendMessage(PZ,{password:i}),this.sendMessage(BO,{nick:this._desiredNick}),this.sendMessage(DZ,{user:(e=this._userName)!==null&&e!==void 0?e:this._desiredNick,mode:"8",unused:"*",realName:(n=this._realName)!==null&&n!==void 0?n:this._desiredNick})}catch(i){this.emit(this.onPasswordError,i),this.quit()}}),this._initialConnectionSetupDone=!0,this._connection.onReceive(e=>{this.receiveLine(e)}),this._connection.onDisconnect((e,n)=>{var i;if(this._registered=!1,this._pingCheckTimer&&clearTimeout(this._pingCheckTimer),this._pingTimeoutTimer&&clearTimeout(this._pingTimeoutTimer),e)this._logger.info("Disconnected");else{const r=(i=this._options.connection.reconnect)!==null&&i!==void 0?i:!0,s=n?`Disconnected unexpectedly: ${n.message}`:"Disconnected unexpectedly";r?this._logger.warn(`${s}; trying to reconnect`):this._logger.error(s)}this.emit(this.onDisconnect,e,n)}),this._connection.onEnd(e=>{e||this._logger.warn("No further retries will be made")}))}_handleReceivedClientNick(e){this._currentNick!==e&&(this._currentNick!==""&&this._logger.warn(`Mismatching nicks: passed ${this._currentNick}, but you're actually ${e}`),this._currentNick=e)}_handleEvents(e){this._collectors.some(i=>i.collect(e));const n=this._events.get(e.constructor.COMMAND);if(n)for(const i of n.values())i(e)}_startPingCheckTimer(){this._pingCheckTimer&&clearTimeout(this._pingCheckTimer),this._connection.isConnected?this._pingCheckTimer=setTimeout(()=>this.pingCheck(),this._pingOnInactivity*1e3):this._pingCheckTimer=void 0}}pa([$E(!1)],lwe.prototype,"_options",void 0);class VZ extends jt{constructor(e,n,i){super(e,n,i,{channel:{type:"channel"},user:{trailing:!0,optional:!0}})}get date(){const e=this._tags.get("tmi-sent-ts");return new Date(Number(e))}get channelId(){return this._tags.get("room-id")}get targetUserId(){var e;return(e=this._tags.get("target-user-id"))!==null&&e!==void 0?e:null}}VZ.COMMAND="CLEARCHAT";class uwe extends jt{}uwe.COMMAND="RECONNECT";class GZ extends jt{constructor(e,n,i){super(e,n,i,{channel:{type:"channel"}})}}GZ.COMMAND="ROOMSTATE";function pNt(t){switch(typeof t){case"undefined":return"";case"object":{if(t===null)return"";if("cacheKey"in t)return t.cacheKey;const e=JSON.stringify(t);if(e!=="{}")return e}default:return t.toString()}}function hwe(t,e,n){return[t,...e.map(pNt)].join("/")+(n?"/":"")}const jv=Symbol("cache");function mNt(t){var e,n;return n=class extends t{constructor(){super(...arguments),this[e]=new Map}getFromCache(i){if(this._cleanCache(),this[jv].has(i)){const r=this[jv].get(i);if(r)return r.value}}setCache(i,r,s){this[jv].set(i,{value:r,expires:Date.now()+s*1e3})}removeFromCache(i,r){const s=this._getInternalCacheKey(i,r);r?this[jv].forEach((a,o)=>{o.startsWith(s)&&this[jv].delete(o)}):this[jv].delete(s)}_cleanCache(){const i=Date.now();this[jv].forEach((r,s)=>{r.expires<i&&this[jv].delete(s)})}_getInternalCacheKey(i,r){if(typeof i=="string"){let s=i;return s.endsWith("/")||(s+="/"),s}else{const s=i.shift();return hwe(s,i,r)}}},e=jv,n}function dwe(t=1/0){return function(e,n,i){if(i.get){const r=i.get;i.get=function(){const s=hwe(n,[]),a=this.getFromCache(s);if(a)return a;const o=r.call(this);return this.setCache(s,o,t),o}}return i}}var FL;let EE=FL=class{constructor(e,n){this._userName=e.toLowerCase(),this._userData=n?new Map(n):new Map}static _parseBadgesLike(e){return e?new Map(e.split(",").map(n=>{const i=n.indexOf("/");return i===-1?[n,""]:[n.slice(0,i),n.slice(i+1)]})):new Map}get userName(){return this._userName}get displayName(){var e;return(e=this._userData.get("display-name"))!==null&&e!==void 0?e:this._userName}get color(){return this._userData.get("color")}get badges(){const e=this._userData.get("badges");return FL._parseBadgesLike(e)}get badgeInfo(){const e=this._userData.get("badge-info");return FL._parseBadgesLike(e)}get userId(){return this._userData.get("user-id")}get userType(){return this._userData.get("user-type")}get isBroadcaster(){return this.badges.has("broadcaster")}get isSubscriber(){return this.badges.has("subscriber")||this.isFounder}get isFounder(){return this.badges.has("founder")}get isMod(){return this.badges.has("moderator")}get isVip(){const e=this._userData.get("vip");return e!=null&&e!=="0"}get isArtist(){return this.badges.has("artist-badge")}};pa([$E(!1)],EE.prototype,"_userData",void 0);pa([dwe()],EE.prototype,"badges",null);pa([dwe()],EE.prototype,"badgeInfo",null);EE=FL=pa([mNt,bP("chat","ChatUser","userId")],EE);function qZ(t){return t?new Map(t.split("/").map(e=>{const[n,i]=e.split(":",2);return i?[n,i.split(",")]:null}).filter(e=>e!==null)):new Map}class $Z extends jt{constructor(e,n,i){super(e,n,i,{channel:{type:"channel"},text:{trailing:!0,optional:!0}})}get id(){return this._tags.get("id")}get date(){const e=this._tags.get("tmi-sent-ts");return new Date(Number(e))}get userInfo(){return new EE(this._tags.get("login"),this._tags)}get channelId(){var e;return(e=this._tags.get("room-id"))!==null&&e!==void 0?e:null}get emoteOffsets(){return qZ(this._tags.get("emotes"))}}$Z.COMMAND="USERNOTICE";class fwe extends jt{constructor(e,n,i){super(e,n,i,{channel:{type:"channel"}})}}fwe.COMMAND="USERSTATE";class WZ extends jt{constructor(e,n,i){super(e,n,i,{target:{},text:{trailing:!0}})}get userInfo(){return new EE(this._prefix.nick,this._tags)}get emoteOffsets(){return qZ(this._tags.get("emotes"))}}WZ.COMMAND="WHISPER";const gNt={name:"twitch.tv/commands",messageTypes:[VZ,uwe,GZ,$Z,fwe,WZ]},vNt={name:"twitch.tv/membership"};class YZ extends jt{constructor(e,n,i){super(e,n,i,{channel:{type:"channel"},text:{trailing:!0}})}get date(){const e=this._tags.get("tmi-sent-ts");return new Date(Number(e))}get userName(){return this._tags.get("login")}get channelId(){return this._tags.get("room-id")}get targetMessageId(){return this._tags.get("target-msg-id")}}YZ.COMMAND="CLEARMSG";class pwe extends jt{}pwe.COMMAND="GLOBALUSERSTATE";const _Nt={name:"twitch.tv/tags",messageTypes:[pwe,YZ]},yNt=["ONE","TWO","THREE","FOUR","FIVE","SIX","SEVEN","EIGHT","NINE","TEN"];let qB=class extends MI{get id(){return this._tags.get("id")}get date(){const e=this._tags.get("tmi-sent-ts");return new Date(Number(e))}get userInfo(){return new EE(this._prefix.nick,this._tags)}get channelId(){var e;return(e=this._tags.get("room-id"))!==null&&e!==void 0?e:null}get isCheer(){return this._tags.has("bits")}get isRedemption(){return!!this._tags.get("custom-reward-id")}get rewardId(){return this._tags.get("custom-reward-id")||null}get isFirst(){return this._tags.get("first-msg")==="1"}get isReturningChatter(){return this._tags.get("returning-chatter")==="1"}get isHighlight(){return this._tags.get("msg-id")==="highlighted-message"}get isReply(){return this._tags.has("reply-parent-msg-id")}get parentMessageId(){var e;return(e=this._tags.get("reply-parent-msg-id"))!==null&&e!==void 0?e:null}get parentMessageText(){var e;return(e=this._tags.get("reply-parent-msg-body"))!==null&&e!==void 0?e:null}get parentMessageUserId(){var e;return(e=this._tags.get("reply-parent-user-id"))!==null&&e!==void 0?e:null}get parentMessageUserName(){var e;return(e=this._tags.get("reply-parent-user-login"))!==null&&e!==void 0?e:null}get parentMessageUserDisplayName(){var e;return(e=this._tags.get("reply-parent-display-name"))!==null&&e!==void 0?e:null}get threadMessageId(){var e;return(e=this._tags.get("reply-thread-parent-msg-id"))!==null&&e!==void 0?e:null}get threadMessageUserId(){var e;return(e=this._tags.get("reply-thread-parent-user-id"))!==null&&e!==void 0?e:null}get bits(){var e;return Number((e=this._tags.get("bits"))!==null&&e!==void 0?e:0)}get emoteOffsets(){return qZ(this._tags.get("emotes"))}get isHypeChat(){return this._tags.has("pinned-chat-paid-amount")}get hypeChatAmount(){return wI(this._tags.get("pinned-chat-paid-amount"),Number)}get hypeChatDecimalPlaces(){return wI(this._tags.get("pinned-chat-paid-exponent"),Number)}get hypeChatLocalizedAmount(){const e=this.hypeChatAmount;return e?e/10**this.hypeChatDecimalPlaces:null}get hypeChatCurrency(){var e;return(e=this._tags.get("pinned-chat-paid-currency"))!==null&&e!==void 0?e:null}get hypeChatLevel(){const e=this._tags.get("pinned-chat-paid-level");return e?yNt.indexOf(e)+1:null}get hypeChatIsSystemMessage(){const e=this._tags.get("pinned-chat-paid-is-system-message");return e?!!Number(e):null}};qB=pa([bP("chat","ChatMessage","id")],qB);function bNt(t){return t instanceof qB?t.tags.get("id"):t}function fce(t,e){if(t.length<=e)return[t];t=t.trim();const n=[];let i=0,r=e;for(;i<t.length;){let s=t.lastIndexOf(" ",r);(s===-1||s<=i||t.length-i+1<=e)&&(s=i+e);const a=t.slice(i,s).trim();a.length&&n.push(a),i=s+(t[s]===" "?1:0),r=i+e}return n}const ENt=/^[a-z0-9][a-z0-9_]{0,24}$/;function Dc(t){const e=t.replace(/^#/,"").toLowerCase();if(!ENt.test(e))throw new Error(`"${e}" is not a valid user or channel name. It must be at most 25 characters long, can only include letters, numbers and underscores, and can not start with an underscore.`);return e}function N2(t){return`#${Dc(t)}`}var M7;let $B=M7=class extends yP{constructor(e={}){var n,i,r,s,a;if(e.authProvider&&!e.authProvider.getAccessTokenForIntent)throw new UL("You can not connect to chat using an AuthProvider that does not support intents.\nTo get an anonymous, read-only connection, please don't pass an `AuthProvider` at all.\nTo get a read-write connection, please provide an auth provider that provides user access tokens via intents, such as `RefreshingAuthProvider`.");super(),this._authVerified=!1,this._authRetryCount=0,this.onConnect=this.registerEvent(),this.onDisconnect=this.registerEvent(),this.onTimeout=this.registerEvent(),this.onBan=this.registerEvent(),this.onBitsBadgeUpgrade=this.registerEvent(),this.onChatClear=this.registerEvent(),this.onEmoteOnly=this.registerEvent(),this.onFollowersOnly=this.registerEvent(),this.onJoin=this.registerEvent(),this.onJoinFailure=this.registerEvent(),this.onPart=this.registerEvent(),this.onMessageRemove=this.registerEvent(),this.onUniqueChat=this.registerEvent(),this.onRaid=this.registerEvent(),this.onRaidCancel=this.registerEvent(),this.onRitual=this.registerEvent(),this.onSlow=this.registerEvent(),this.onSubsOnly=this.registerEvent(),this.onSub=this.registerEvent(),this.onResub=this.registerEvent(),this.onSubGift=this.registerEvent(),this.onCommunitySub=this.registerEvent(),this.onSubExtend=this.registerEvent(),this.onRewardGift=this.registerEvent(),this.onPrimePaidUpgrade=this.registerEvent(),this.onGiftPaidUpgrade=this.registerEvent(),this.onPrimeCommunityGift=this.registerEvent(),this.onStandardPayForward=this.registerEvent(),this.onCommunityPayForward=this.registerEvent(),this.onAnnouncement=this.registerEvent(),this.onWhisper=this.registerEvent(),this.onNoPermission=this.registerEvent(),this.onMessageRatelimit=this.registerEvent(),this.onAuthenticationSuccess=this.registerEvent(),this.onAuthenticationFailure=this.registerEvent(),this.onTokenFetchFailure=this.registerEvent(),this.onMessageFailed=this.registerEvent(),this.onMessage=this.registerEvent(),this.onAction=this.registerEvent(),this._onJoinResult=this.registerInternalEvent(),this._ircClient=new lwe({connection:{hostName:(n=e.hostName)!==null&&n!==void 0?n:!((i=e.webSocket)!==null&&i!==void 0)||i?"irc-ws.chat.twitch.tv":"irc.chat.twitch.tv",secure:(r=e.ssl)!==null&&r!==void 0?r:!0},credentials:{nick:"",password:async()=>await this._getAuthToken()},webSocket:(s=e.webSocket)!==null&&s!==void 0?s:!0,connectionOptions:e.connectionOptions,logger:{name:"twurple:chat:irc",...e.logger},nonConformingCommands:["004"],manuallyAcknowledgeJoins:!0,rejoinChannelsOnReconnect:e.rejoinChannelsOnReconnect}),this._ircClient.onDisconnect((l,u)=>{this._messageRateLimiter.clear(),this._messageRateLimiter.pause(),this._joinRateLimiter.clear(),this._joinRateLimiter.pause(),this.emit(this.onDisconnect,l,u)}),this._ircClient.registerMessageType(qB),this._chatLogger=e5({name:"twurple:chat:twitch",...e.logger}),this._authProvider=e.authProvider,this._useLegacyScopes=!!e.legacyScopes,this._readOnly=!!e.readOnly,this._authIntents=[...(a=e.authIntents)!==null&&a!==void 0?a:[],"chat"];const o=async({type:l,text:u,channel:h,tags:d})=>{l==="say"?this._ircClient.say(h,u,d):this._ircClient.action(h,u)},c=async l=>{const{promise:u,resolve:h,reject:d}=T7();let f;const p=this.addInternalListener(this._onJoinResult,(g,_,v)=>{g===l&&(clearTimeout(f),v?d(v):h(),this.removeListener(p))});f=setTimeout(()=>{this.removeListener(p),this.emit(this._onJoinResult,l,void 0,"twurple_timeout"),d(new Error(`Did not receive a reply to join ${l} in time; assuming that the join failed`))},1e4),this._ircClient.join(l),await u};if(e.isAlwaysMod)this._messageRateLimiter=new x7({bucketSize:e.botLevel==="verified"?7500:100,timeFrame:32e3,doRequest:o});else{let l=20;e.botLevel==="verified"?l=7500:e.botLevel==="known"&&(l=50),this._messageRateLimiter=new iOt(new nOt({bucketSize:1,timeFrame:1200,logger:{minLevel:vi.ERROR},doRequest:o,getPartitionKey:({channel:u})=>u}),{bucketSize:l,timeFrame:32e3})}this._joinRateLimiter=new x7({bucketSize:e.botLevel==="verified"?2e3:20,timeFrame:11e3,doRequest:c}),this._messageRateLimiter.pause(),this._joinRateLimiter.pause(),this._ircClient.addCapability(_Nt),this._ircClient.addCapability(gNt),e.requestMembershipEvents&&this._ircClient.addCapability(vNt),this._ircClient.onConnect(()=>{this.emit(this.onConnect)}),this._ircClient.onRegister(async()=>{this._messageRateLimiter.resume(),this._joinRateLimiter.resume(),this._authVerified=!0,this._authRetryTimer=void 0,this._authRetryCount=0,this.emit(this.onAuthenticationSuccess);const l=await E7(e.channels);l&&await Promise.all(l.map(async u=>{var h;try{await this.join(u)}catch(d){this._chatLogger.warn(`Failed to join configured channel ${u}; original message: ${(h=d==null?void 0:d.message)!==null&&h!==void 0?h:d}`)}}))}),this._ircClient.onPasswordError(l=>{this._chatLogger.error(`Error fetching a token for connecting to the server: ${l.message}`),this.emit(this.onTokenFetchFailure,l)}),this._ircClient.onPrivmsg((l,u,h,d)=>{u!=="jtv"&&this.emit(this.onMessage,Dc(l),u,h,d)}),this._ircClient.onAction((l,u,h,d)=>{this.emit(this.onAction,Dc(l),u,h,d)}),this.addInternalListener(this._onJoinResult,(l,u,h)=>{h?this.emit(this.onJoinFailure,Dc(l),h):this._ircClient.acknowledgeJoin(l)}),this._ircClient.onTypedMessage(VZ,l=>{const{channel:u,user:h,tags:d}=l,f=Dc(u);if(h){const p=d.get("ban-duration");p===void 0?this.emit(this.onBan,f,h,l):this.emit(this.onTimeout,f,h,Number(p),l)}else this.emit(this.onChatClear,f,l)}),this._ircClient.onTypedMessage(YZ,l=>{const{channel:u,targetMessageId:h}=l;this.emit(this.onMessageRemove,Dc(u),h,l)}),this._ircClient.onTypedMessage(AI,({prefix:l,channel:u})=>{this.emit(this.onJoin,Dc(u),l.nick)}),this._ircClient.onTypedMessage(RI,({prefix:l,channel:u})=>{this.emit(this.onPart,Dc(u),l.nick)}),this._ircClient.onTypedMessage(GZ,({channel:l,tags:u})=>{let h=!1;if(u.has("subs-only")&&u.has("slow")&&(this.emit(this._onJoinResult,l,u),h=!0),!h){const d=Dc(l);if(u.has("slow")){const f=Number(u.get("slow"));f?this.emit(this.onSlow,d,!0,f):this.emit(this.onSlow,d,!1)}if(u.has("followers-only")){const f=Number(u.get("followers-only"));f===-1?this.emit(this.onFollowersOnly,d,!1):this.emit(this.onFollowersOnly,d,!0,f)}}}),this._ircClient.onTypedMessage($Z,l=>{const{channel:u,text:h,tags:d}=l,f=d.get("msg-id"),p=Dc(u);switch(f){case"sub":case"resub":{const g=f==="sub"?this.onSub:this.onResub,_=d.get("msg-param-sub-plan"),v=d.get("msg-param-streak-months"),b={userId:d.get("user-id"),displayName:d.get("display-name"),plan:_,planName:d.get("msg-param-sub-plan-name"),isPrime:_==="Prime",months:Number(d.get("msg-param-cumulative-months")),streak:v?Number(v):void 0,message:h};if(d.get("msg-param-was-gifted")==="true"){const x=d.get("msg-param-anon-gift")==="true",M=Number(d.get("msg-param-gift-months")),R=Number(d.get("msg-param-gift-month-being-redeemed"));x?b.originalGiftInfo={anonymous:!0,duration:M,redeemedMonth:R}:b.originalGiftInfo={anonymous:!1,duration:M,redeemedMonth:R,userId:d.get("msg-param-gifter-id"),userName:d.get("msg-param-gifter-login"),userDisplayName:d.get("msg-param-gifter-name")}}this.emit(g,p,d.get("login"),b,l);break}case"subgift":{const g=d.get("msg-param-sub-plan"),_=d.get("login"),v=_==="ananonymousgifter",b={userId:d.get("msg-param-recipient-id"),displayName:d.get("msg-param-recipient-display-name"),gifter:v?void 0:_,gifterUserId:v?void 0:d.get("user-id"),gifterDisplayName:v?void 0:d.get("display-name"),gifterGiftCount:v?void 0:Number(d.get("msg-param-sender-count")),giftDuration:Number(d.get("msg-param-gift-months")),plan:g,planName:d.get("msg-param-sub-plan-name"),isPrime:g==="Prime",months:Number(d.get("msg-param-months"))};this.emit(this.onSubGift,p,d.get("msg-param-recipient-user-name"),b,l);break}case"submysterygift":{const g=d.get("login"),_=g==="ananonymousgifter",v={gifter:_?void 0:g,gifterUserId:_?void 0:d.get("user-id"),gifterDisplayName:_?void 0:d.get("display-name"),gifterGiftCount:_?void 0:Number(d.get("msg-param-sender-count")),count:Number(d.get("msg-param-mass-gift-count")),plan:d.get("msg-param-sub-plan")};this.emit(this.onCommunitySub,p,d.get("login"),v,l);break}case"primepaidupgrade":{const g={userId:d.get("user-id"),displayName:d.get("display-name"),plan:d.get("msg-param-sub-plan")};this.emit(this.onPrimePaidUpgrade,p,d.get("login"),g,l);break}case"giftpaidupgrade":{const g={userId:d.get("user-id"),displayName:d.get("display-name"),gifter:d.get("msg-param-sender-login"),gifterDisplayName:d.get("msg-param-sender-name")};this.emit(this.onGiftPaidUpgrade,p,d.get("login"),g,l);break}case"standardpayforward":{const g=d.get("msg-param-prior-gifter-anonymous")==="true",_={userId:d.get("user-id"),displayName:d.get("display-name"),originalGifterUserId:g?void 0:d.get("msg-param-prior-gifter-id"),originalGifterDisplayName:g?void 0:d.get("msg-param-prior-gifter-display-name"),recipientUserId:d.get("msg-param-recipient-id"),recipientDisplayName:d.get("msg-param-recipient-display-name")};this.emit(this.onStandardPayForward,p,d.get("login"),_,l);break}case"communitypayforward":{const g=d.get("msg-param-prior-gifter-anonymous")==="true",_={userId:d.get("user-id"),displayName:d.get("display-name"),originalGifterUserId:g?void 0:d.get("msg-param-prior-gifter-id"),originalGifterDisplayName:g?void 0:d.get("msg-param-prior-gifter-display-name")};this.emit(this.onCommunityPayForward,p,d.get("login"),_,l);break}case"primecommunitygiftreceived":{const g={name:d.get("msg-param-gift-name"),gifter:d.get("login"),gifterDisplayName:d.get("display-name")};this.emit(this.onPrimeCommunityGift,p,d.get("msg-param-recipient"),g,l);break}case"raid":{const g={displayName:d.get("msg-param-displayName"),viewerCount:Number(d.get("msg-param-viewerCount"))};this.emit(this.onRaid,p,d.get("login"),g,l);break}case"unraid":{this.emit(this.onRaidCancel,p,l);break}case"ritual":{const g={ritualName:d.get("msg-param-ritual-name"),message:h};this.emit(this.onRitual,p,d.get("login"),g,l);break}case"bitsbadgetier":{const g={displayName:d.get("display-name"),threshold:Number(d.get("msg-param-threshold"))};this.emit(this.onBitsBadgeUpgrade,p,d.get("login"),g,l);break}case"extendsub":{const g={userId:d.get("user-id"),displayName:d.get("display-name"),plan:d.get("msg-param-sub-plan"),months:Number(d.get("msg-param-cumulative-months")),endMonth:Number(d.get("msg-param-sub-benefit-end-month"))};this.emit(this.onSubExtend,p,d.get("login"),g,l);break}case"rewardgift":{const g={domain:d.get("msg-param-domain"),gifterId:d.get("user-id"),gifterDisplayName:d.get("display-name"),count:Number(d.get("msg-param-selected-count")),gifterGiftCount:Number(d.get("msg-param-total-reward-count")),triggerType:d.get("msg-param-trigger-type")};this.emit(this.onRewardGift,p,d.get("login"),g,l);break}case"announcement":{const g={color:d.get("msg-param-color")};this.emit(this.onAnnouncement,p,d.get("login"),g,l);break}default:this._chatLogger.warn(`Unrecognized usernotice ID: ${f}`)}}),this._ircClient.onTypedMessage(WZ,l=>{this.emit(this.onWhisper,l.prefix.nick,l.text,l)}),this._ircClient.onTypedMessage(n5,async({target:l,text:u,tags:h})=>{const d=h.get("msg-id");switch(d){case"emote_only_on":{this.emit(this.onEmoteOnly,Dc(l),!0);break}case"emote_only_off":{this.emit(this.onEmoteOnly,Dc(l),!1);break}case"msg_channel_suspended":case"msg_banned":{this.emit(this._onJoinResult,l,void 0,d);break}case"r9k_on":{this.emit(this.onUniqueChat,Dc(l),!0);break}case"r9k_off":{this.emit(this.onUniqueChat,Dc(l),!1);break}case"subs_on":{this.emit(this.onSubsOnly,Dc(l),!0);break}case"subs_off":{this.emit(this.onSubsOnly,Dc(l),!1);break}case"cmds_available":break;case"followers_on":case"followers_on_zero":case"followers_off":case"slow_on":case"slow_off":break;case"timeout_success":break;case"unrecognized_cmd":break;case"no_permission":{this.emit(this.onNoPermission,Dc(l),u);break}case"msg_ratelimit":{this.emit(this.onMessageRatelimit,Dc(l),u);break}case"msg_duplicate":case"msg_emoteonly":case"msg_followersonly":case"msg_followersonly_followed":case"msg_followersonly_zero":case"msg_subsonly":case"msg_slowmode":case"msg_r9k":case"msg_verified_email":case"msg_timedout":case"msg_rejected_mandatory":case"msg_channel_blocked":{this.emit(this.onMessageFailed,Dc(l),d);break}case void 0:{if(u==="Login authentication failed"||u==="Improperly formatted AUTH"||u==="Invalid NICK"){this._authVerified=!1,this._authRetryTimer||(this._authRetryTimer=x1e(120),this._authRetryCount=0);const f=this._authRetryTimer.next().value,p=++this._authRetryCount;this.emit(this.onAuthenticationFailure,u,p),f!==0&&this._chatLogger.info(`Retrying authentication in ${f} seconds`),await GMt(f*1e3),this._ircClient.reconnect()}break}default:d.startsWith("usage_")||this._chatLogger.warn(`Unrecognized notice ID: '${d}'`)}})}connect(){this._authProvider||this._ircClient.changeNick(M7._generateJustinfanNick()),this._ircClient.connect()}get irc(){return this._ircClient}get isConnected(){return this._ircClient.isConnected}get isConnecting(){return this._ircClient.isConnecting}get currentChannels(){return this._ircClient.currentChannels}async say(e,n,i={},r){const s={};i.replyTo&&(s["reply-parent-msg-id"]=bNt(i.replyTo));const a=fce(n,500);await Promise.all(a.map(async o=>await this._messageRateLimiter.request({type:"say",channel:N2(e),text:o,tags:s},r)))}async action(e,n,i){const r=fce(n,490);await Promise.all(r.map(async s=>await this._messageRateLimiter.request({type:"action",channel:N2(e),text:s},i)))}async join(e){await this._joinRateLimiter.request(N2(e))}part(e){this._ircClient.part(N2(e))}quit(){this._ircClient.quitAbruptly()}reconnect(){this.quit(),this.connect()}async _getAuthToken(){var e,n;if(!this._authProvider){this._chatLogger.debug("No authProvider given; connecting anonymously");return}if(this._authToken&&!LL(this._authToken)&&this._authVerified)return this._chatLogger.debug("AccessToken assumed to be correct from last connection"),`oauth:${this._authToken.accessToken}`;const i=this._getNecessaryScopes();let r,s=!1;for(const a of this._authIntents){try{if(this._authToken=await this._authProvider.getAccessTokenForIntent(a,i),!this._authToken)continue;s=!0;const o=await CI(this._authToken.accessToken);if(!o.userName)throw new UL("Could not determine a user name for your token; you might be trying to disguise an app token as a user token.");return this._ircClient.changeNick(o.userName),`oauth:${this._authToken.accessToken}`}catch(o){o instanceof PC?r=o:this._chatLogger.error(`Retrieving an access token failed: ${o.message}`)}this._chatLogger.warn("No valid token available; trying to refresh");try{if(this._authToken=await((n=(e=this._authProvider).refreshAccessTokenForIntent)===null||n===void 0?void 0:n.call(e,a)),this._authToken){const o=await CI(this._authToken.accessToken);if(!o.userName)throw new UL("Could not determine a user name for your token; you might be trying to disguise an app token as a user token.");return this._ircClient.changeNick(o.userName),`oauth:${this._authToken.accessToken}`}}catch(o){o instanceof PC?r=o:this._chatLogger.error(`Refreshing the access token failed: ${o.message}`)}}throw this._authVerified=!1,r??new Error(s?"Could not retrieve a valid token":`None of the queried intents (${this._authIntents.join(", ")}) are known by the auth provider${this._authProvider instanceof bE?".\nPlease add one of these to the user you want to connect with using the `addIntentToUser` method or the additional parameter to `addUser` or `addUserForToken`.":""}`)}_getNecessaryScopes(){return this._useLegacyScopes?["chat_login"]:this._readOnly?["chat:read"]:["chat:read","chat:edit"]}static _generateJustinfanNick(){return`justinfan${Math.floor(Math.random()*1e5).toString().padStart(5,"0")}`}};pa([$E(!1)],$B.prototype,"_authProvider",void 0);$B=M7=pa([bP("chat","ChatClient")],$B);var mwe={exports:{}};(function(t,e){(function(n,i){t.exports=i()})(self,()=>(()=>{var n={9669:(a,o,c)=>{a.exports=c(1609)},5448:(a,o,c)=>{var l=c(4867),u=c(6026),h=c(4372),d=c(5327),f=c(4097),p=c(4109),g=c(7985),_=c(7874),v=c(2648),b=c(644),S=c(205);a.exports=function(x){return new Promise(function(M,R){var I,k=x.data,P=x.headers,U=x.responseType;function V(){x.cancelToken&&x.cancelToken.unsubscribe(I),x.signal&&x.signal.removeEventListener("abort",I)}l.isFormData(k)&&l.isStandardBrowserEnv()&&delete P["Content-Type"];var $=new XMLHttpRequest;if(x.auth){var q=x.auth.username||"",Y=x.auth.password?unescape(encodeURIComponent(x.auth.password)):"";P.Authorization="Basic "+btoa(q+":"+Y)}var te=f(x.baseURL,x.url);function G(){if($){var X="getAllResponseHeaders"in $?p($.getAllResponseHeaders()):null,ae={data:U&&U!=="text"&&U!=="json"?$.response:$.responseText,status:$.status,statusText:$.statusText,headers:X,config:x,request:$};u(function(ce){M(ce),V()},function(ce){R(ce),V()},ae),$=null}}if($.open(x.method.toUpperCase(),d(te,x.params,x.paramsSerializer),!0),$.timeout=x.timeout,"onloadend"in $?$.onloadend=G:$.onreadystatechange=function(){$&&$.readyState===4&&($.status!==0||$.responseURL&&$.responseURL.indexOf("file:")===0)&&setTimeout(G)},$.onabort=function(){$&&(R(new v("Request aborted",v.ECONNABORTED,x,$)),$=null)},$.onerror=function(){R(new v("Network Error",v.ERR_NETWORK,x,$,$)),$=null},$.ontimeout=function(){var X=x.timeout?"timeout of "+x.timeout+"ms exceeded":"timeout exceeded",ae=x.transitional||_;x.timeoutErrorMessage&&(X=x.timeoutErrorMessage),R(new v(X,ae.clarifyTimeoutError?v.ETIMEDOUT:v.ECONNABORTED,x,$)),$=null},l.isStandardBrowserEnv()){var J=(x.withCredentials||g(te))&&x.xsrfCookieName?h.read(x.xsrfCookieName):void 0;J&&(P[x.xsrfHeaderName]=J)}"setRequestHeader"in $&&l.forEach(P,function(X,ae){k===void 0&&ae.toLowerCase()==="content-type"?delete P[ae]:$.setRequestHeader(ae,X)}),l.isUndefined(x.withCredentials)||($.withCredentials=!!x.withCredentials),U&&U!=="json"&&($.responseType=x.responseType),typeof x.onDownloadProgress=="function"&&$.addEventListener("progress",x.onDownloadProgress),typeof x.onUploadProgress=="function"&&$.upload&&$.upload.addEventListener("progress",x.onUploadProgress),(x.cancelToken||x.signal)&&(I=function(X){$&&(R(!X||X&&X.type?new b:X),$.abort(),$=null)},x.cancelToken&&x.cancelToken.subscribe(I),x.signal&&(x.signal.aborted?I():x.signal.addEventListener("abort",I))),k||(k=null);var K=S(te);K&&["http","https","file"].indexOf(K)===-1?R(new v("Unsupported protocol "+K+":",v.ERR_BAD_REQUEST,x)):$.send(k)})}},1609:(a,o,c)=>{var l=c(4867),u=c(1849),h=c(321),d=c(7185),f=function p(g){var _=new h(g),v=u(h.prototype.request,_);return l.extend(v,h.prototype,_),l.extend(v,_),v.create=function(b){return p(d(g,b))},v}(c(5546));f.Axios=h,f.CanceledError=c(644),f.CancelToken=c(4972),f.isCancel=c(6502),f.VERSION=c(7288).version,f.toFormData=c(7675),f.AxiosError=c(2648),f.Cancel=f.CanceledError,f.all=function(p){return Promise.all(p)},f.spread=c(8713),f.isAxiosError=c(6268),a.exports=f,a.exports.default=f},4972:(a,o,c)=>{var l=c(644);function u(h){if(typeof h!="function")throw new TypeError("executor must be a function.");var d;this.promise=new Promise(function(p){d=p});var f=this;this.promise.then(function(p){if(f._listeners){var g,_=f._listeners.length;for(g=0;g<_;g++)f._listeners[g](p);f._listeners=null}}),this.promise.then=function(p){var g,_=new Promise(function(v){f.subscribe(v),g=v}).then(p);return _.cancel=function(){f.unsubscribe(g)},_},h(function(p){f.reason||(f.reason=new l(p),d(f.reason))})}u.prototype.throwIfRequested=function(){if(this.reason)throw this.reason},u.prototype.subscribe=function(h){this.reason?h(this.reason):this._listeners?this._listeners.push(h):this._listeners=[h]},u.prototype.unsubscribe=function(h){if(this._listeners){var d=this._listeners.indexOf(h);d!==-1&&this._listeners.splice(d,1)}},u.source=function(){var h;return{token:new u(function(d){h=d}),cancel:h}},a.exports=u},644:(a,o,c)=>{var l=c(2648);function u(h){l.call(this,h??"canceled",l.ERR_CANCELED),this.name="CanceledError"}c(4867).inherits(u,l,{__CANCEL__:!0}),a.exports=u},6502:a=>{a.exports=function(o){return!(!o||!o.__CANCEL__)}},321:(a,o,c)=>{var l=c(4867),u=c(5327),h=c(782),d=c(3572),f=c(7185),p=c(4097),g=c(4875),_=g.validators;function v(b){this.defaults=b,this.interceptors={request:new h,response:new h}}v.prototype.request=function(b,S){typeof b=="string"?(S=S||{}).url=b:S=b||{},(S=f(this.defaults,S)).method?S.method=S.method.toLowerCase():this.defaults.method?S.method=this.defaults.method.toLowerCase():S.method="get";var x=S.transitional;x!==void 0&&g.assertOptions(x,{silentJSONParsing:_.transitional(_.boolean),forcedJSONParsing:_.transitional(_.boolean),clarifyTimeoutError:_.transitional(_.boolean)},!1);var M=[],R=!0;this.interceptors.request.forEach(function(q){typeof q.runWhen=="function"&&q.runWhen(S)===!1||(R=R&&q.synchronous,M.unshift(q.fulfilled,q.rejected))});var I,k=[];if(this.interceptors.response.forEach(function(q){k.push(q.fulfilled,q.rejected)}),!R){var P=[d,void 0];for(Array.prototype.unshift.apply(P,M),P=P.concat(k),I=Promise.resolve(S);P.length;)I=I.then(P.shift(),P.shift());return I}for(var U=S;M.length;){var V=M.shift(),$=M.shift();try{U=V(U)}catch(q){$(q);break}}try{I=d(U)}catch(q){return Promise.reject(q)}for(;k.length;)I=I.then(k.shift(),k.shift());return I},v.prototype.getUri=function(b){b=f(this.defaults,b);var S=p(b.baseURL,b.url);return u(S,b.params,b.paramsSerializer)},l.forEach(["delete","get","head","options"],function(b){v.prototype[b]=function(S,x){return this.request(f(x||{},{method:b,url:S,data:(x||{}).data}))}}),l.forEach(["post","put","patch"],function(b){function S(x){return function(M,R,I){return this.request(f(I||{},{method:b,headers:x?{"Content-Type":"multipart/form-data"}:{},url:M,data:R}))}}v.prototype[b]=S(),v.prototype[b+"Form"]=S(!0)}),a.exports=v},2648:(a,o,c)=>{var l=c(4867);function u(f,p,g,_,v){Error.call(this),this.message=f,this.name="AxiosError",p&&(this.code=p),g&&(this.config=g),_&&(this.request=_),v&&(this.response=v)}l.inherits(u,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:this.config,code:this.code,status:this.response&&this.response.status?this.response.status:null}}});var h=u.prototype,d={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED"].forEach(function(f){d[f]={value:f}}),Object.defineProperties(u,d),Object.defineProperty(h,"isAxiosError",{value:!0}),u.from=function(f,p,g,_,v,b){var S=Object.create(h);return l.toFlatObject(f,S,function(x){return x!==Error.prototype}),u.call(S,f.message,p,g,_,v),S.name=f.name,b&&Object.assign(S,b),S},a.exports=u},782:(a,o,c)=>{var l=c(4867);function u(){this.handlers=[]}u.prototype.use=function(h,d,f){return this.handlers.push({fulfilled:h,rejected:d,synchronous:!!f&&f.synchronous,runWhen:f?f.runWhen:null}),this.handlers.length-1},u.prototype.eject=function(h){this.handlers[h]&&(this.handlers[h]=null)},u.prototype.forEach=function(h){l.forEach(this.handlers,function(d){d!==null&&h(d)})},a.exports=u},4097:(a,o,c)=>{var l=c(1793),u=c(7303);a.exports=function(h,d){return h&&!l(d)?u(h,d):d}},3572:(a,o,c)=>{var l=c(4867),u=c(8527),h=c(6502),d=c(5546),f=c(644);function p(g){if(g.cancelToken&&g.cancelToken.throwIfRequested(),g.signal&&g.signal.aborted)throw new f}a.exports=function(g){return p(g),g.headers=g.headers||{},g.data=u.call(g,g.data,g.headers,g.transformRequest),g.headers=l.merge(g.headers.common||{},g.headers[g.method]||{},g.headers),l.forEach(["delete","get","head","post","put","patch","common"],function(_){delete g.headers[_]}),(g.adapter||d.adapter)(g).then(function(_){return p(g),_.data=u.call(g,_.data,_.headers,g.transformResponse),_},function(_){return h(_)||(p(g),_&&_.response&&(_.response.data=u.call(g,_.response.data,_.response.headers,g.transformResponse))),Promise.reject(_)})}},7185:(a,o,c)=>{var l=c(4867);a.exports=function(u,h){h=h||{};var d={};function f(S,x){return l.isPlainObject(S)&&l.isPlainObject(x)?l.merge(S,x):l.isPlainObject(x)?l.merge({},x):l.isArray(x)?x.slice():x}function p(S){return l.isUndefined(h[S])?l.isUndefined(u[S])?void 0:f(void 0,u[S]):f(u[S],h[S])}function g(S){if(!l.isUndefined(h[S]))return f(void 0,h[S])}function _(S){return l.isUndefined(h[S])?l.isUndefined(u[S])?void 0:f(void 0,u[S]):f(void 0,h[S])}function v(S){return S in h?f(u[S],h[S]):S in u?f(void 0,u[S]):void 0}var b={url:g,method:g,data:g,baseURL:_,transformRequest:_,transformResponse:_,paramsSerializer:_,timeout:_,timeoutMessage:_,withCredentials:_,adapter:_,responseType:_,xsrfCookieName:_,xsrfHeaderName:_,onUploadProgress:_,onDownloadProgress:_,decompress:_,maxContentLength:_,maxBodyLength:_,beforeRedirect:_,transport:_,httpAgent:_,httpsAgent:_,cancelToken:_,socketPath:_,responseEncoding:_,validateStatus:v};return l.forEach(Object.keys(u).concat(Object.keys(h)),function(S){var x=b[S]||p,M=x(S);l.isUndefined(M)&&x!==v||(d[S]=M)}),d}},6026:(a,o,c)=>{var l=c(2648);a.exports=function(u,h,d){var f=d.config.validateStatus;d.status&&f&&!f(d.status)?h(new l("Request failed with status code "+d.status,[l.ERR_BAD_REQUEST,l.ERR_BAD_RESPONSE][Math.floor(d.status/100)-4],d.config,d.request,d)):u(d)}},8527:(a,o,c)=>{var l=c(4867),u=c(5546);a.exports=function(h,d,f){var p=this||u;return l.forEach(f,function(g){h=g.call(p,h,d)}),h}},5546:(a,o,c)=>{var l=c(4867),u=c(6016),h=c(2648),d=c(7874),f=c(7675),p={"Content-Type":"application/x-www-form-urlencoded"};function g(b,S){!l.isUndefined(b)&&l.isUndefined(b["Content-Type"])&&(b["Content-Type"]=S)}var _,v={transitional:d,adapter:((typeof XMLHttpRequest<"u"||typeof Gn<"u"&&Object.prototype.toString.call(Gn)==="[object process]")&&(_=c(5448)),_),transformRequest:[function(b,S){if(u(S,"Accept"),u(S,"Content-Type"),l.isFormData(b)||l.isArrayBuffer(b)||l.isBuffer(b)||l.isStream(b)||l.isFile(b)||l.isBlob(b))return b;if(l.isArrayBufferView(b))return b.buffer;if(l.isURLSearchParams(b))return g(S,"application/x-www-form-urlencoded;charset=utf-8"),b.toString();var x,M=l.isObject(b),R=S&&S["Content-Type"];if((x=l.isFileList(b))||M&&R==="multipart/form-data"){var I=this.env&&this.env.FormData;return f(x?{"files[]":b}:b,I&&new I)}return M||R==="application/json"?(g(S,"application/json"),function(k,P,U){if(l.isString(k))try{return(P||JSON.parse)(k),l.trim(k)}catch(V){if(V.name!=="SyntaxError")throw V}return(0,JSON.stringify)(k)}(b)):b}],transformResponse:[function(b){var S=this.transitional||v.transitional,x=S&&S.silentJSONParsing,M=S&&S.forcedJSONParsing,R=!x&&this.responseType==="json";if(R||M&&l.isString(b)&&b.length)try{return JSON.parse(b)}catch(I){if(R)throw I.name==="SyntaxError"?h.from(I,h.ERR_BAD_RESPONSE,this,null,this.response):I}return b}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:c(1623)},validateStatus:function(b){return b>=200&&b<300},headers:{common:{Accept:"application/json, text/plain, */*"}}};l.forEach(["delete","get","head"],function(b){v.headers[b]={}}),l.forEach(["post","put","patch"],function(b){v.headers[b]=l.merge(p)}),a.exports=v},7874:a=>{a.exports={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1}},7288:a=>{a.exports={version:"0.27.2"}},1849:a=>{a.exports=function(o,c){return function(){for(var l=new Array(arguments.length),u=0;u<l.length;u++)l[u]=arguments[u];return o.apply(c,l)}}},5327:(a,o,c)=>{var l=c(4867);function u(h){return encodeURIComponent(h).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}a.exports=function(h,d,f){if(!d)return h;var p;if(f)p=f(d);else if(l.isURLSearchParams(d))p=d.toString();else{var g=[];l.forEach(d,function(v,b){v!=null&&(l.isArray(v)?b+="[]":v=[v],l.forEach(v,function(S){l.isDate(S)?S=S.toISOString():l.isObject(S)&&(S=JSON.stringify(S)),g.push(u(b)+"="+u(S))}))}),p=g.join("&")}if(p){var _=h.indexOf("#");_!==-1&&(h=h.slice(0,_)),h+=(h.indexOf("?")===-1?"?":"&")+p}return h}},7303:a=>{a.exports=function(o,c){return c?o.replace(/\/+$/,"")+"/"+c.replace(/^\/+/,""):o}},4372:(a,o,c)=>{var l=c(4867);a.exports=l.isStandardBrowserEnv()?{write:function(u,h,d,f,p,g){var _=[];_.push(u+"="+encodeURIComponent(h)),l.isNumber(d)&&_.push("expires="+new Date(d).toGMTString()),l.isString(f)&&_.push("path="+f),l.isString(p)&&_.push("domain="+p),g===!0&&_.push("secure"),document.cookie=_.join("; ")},read:function(u){var h=document.cookie.match(new RegExp("(^|;\\s*)("+u+")=([^;]*)"));return h?decodeURIComponent(h[3]):null},remove:function(u){this.write(u,"",Date.now()-864e5)}}:{write:function(){},read:function(){return null},remove:function(){}}},1793:a=>{a.exports=function(o){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(o)}},6268:(a,o,c)=>{var l=c(4867);a.exports=function(u){return l.isObject(u)&&u.isAxiosError===!0}},7985:(a,o,c)=>{var l=c(4867);a.exports=l.isStandardBrowserEnv()?function(){var u,h=/(msie|trident)/i.test(navigator.userAgent),d=document.createElement("a");function f(p){var g=p;return h&&(d.setAttribute("href",g),g=d.href),d.setAttribute("href",g),{href:d.href,protocol:d.protocol?d.protocol.replace(/:$/,""):"",host:d.host,search:d.search?d.search.replace(/^\?/,""):"",hash:d.hash?d.hash.replace(/^#/,""):"",hostname:d.hostname,port:d.port,pathname:d.pathname.charAt(0)==="/"?d.pathname:"/"+d.pathname}}return u=f(window.location.href),function(p){var g=l.isString(p)?f(p):p;return g.protocol===u.protocol&&g.host===u.host}}():function(){return!0}},6016:(a,o,c)=>{var l=c(4867);a.exports=function(u,h){l.forEach(u,function(d,f){f!==h&&f.toUpperCase()===h.toUpperCase()&&(u[h]=d,delete u[f])})}},1623:a=>{a.exports=null},4109:(a,o,c)=>{var l=c(4867),u=["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"];a.exports=function(h){var d,f,p,g={};return h&&l.forEach(h.split(`
`),function(_){if(p=_.indexOf(":"),d=l.trim(_.substr(0,p)).toLowerCase(),f=l.trim(_.substr(p+1)),d){if(g[d]&&u.indexOf(d)>=0)return;g[d]=d==="set-cookie"?(g[d]?g[d]:[]).concat([f]):g[d]?g[d]+", "+f:f}}),g}},205:a=>{a.exports=function(o){var c=/^([-+\w]{1,25})(:?\/\/|:)/.exec(o);return c&&c[1]||""}},8713:a=>{a.exports=function(o){return function(c){return o.apply(null,c)}}},7675:(a,o,c)=>{var l=c(4867);a.exports=function(u,h){h=h||new FormData;var d=[];function f(p){return p===null?"":l.isDate(p)?p.toISOString():l.isArrayBuffer(p)||l.isTypedArray(p)?typeof Blob=="function"?new Blob([p]):Yl.from(p):p}return function p(g,_){if(l.isPlainObject(g)||l.isArray(g)){if(d.indexOf(g)!==-1)throw Error("Circular reference detected in "+_);d.push(g),l.forEach(g,function(v,b){if(!l.isUndefined(v)){var S,x=_?_+"."+b:b;if(v&&!_&&typeof v=="object"){if(l.endsWith(b,"{}"))v=JSON.stringify(v);else if(l.endsWith(b,"[]")&&(S=l.toArray(v)))return void S.forEach(function(M){!l.isUndefined(M)&&h.append(x,f(M))})}p(v,x)}}),d.pop()}else h.append(_,f(g))}(u),h}},4875:(a,o,c)=>{var l=c(7288).version,u=c(2648),h={};["object","boolean","number","function","string","symbol"].forEach(function(f,p){h[f]=function(g){return typeof g===f||"a"+(p<1?"n ":" ")+f}});var d={};h.transitional=function(f,p,g){function _(v,b){return"[Axios v"+l+"] Transitional option '"+v+"'"+b+(g?". "+g:"")}return function(v,b,S){if(f===!1)throw new u(_(b," has been removed"+(p?" in "+p:"")),u.ERR_DEPRECATED);return p&&!d[b]&&(d[b]=!0,console.warn(_(b," has been deprecated since v"+p+" and will be removed in the near future"))),!f||f(v,b,S)}},a.exports={assertOptions:function(f,p,g){if(typeof f!="object")throw new u("options must be an object",u.ERR_BAD_OPTION_VALUE);for(var _=Object.keys(f),v=_.length;v-- >0;){var b=_[v],S=p[b];if(S){var x=f[b],M=x===void 0||S(x,b,f);if(M!==!0)throw new u("option "+b+" must be "+M,u.ERR_BAD_OPTION_VALUE)}else if(g!==!0)throw new u("Unknown option "+b,u.ERR_BAD_OPTION)}},validators:h}},4867:(a,o,c)=>{var l,u=c(1849),h=Object.prototype.toString,d=(l=Object.create(null),function($){var q=h.call($);return l[q]||(l[q]=q.slice(8,-1).toLowerCase())});function f($){return $=$.toLowerCase(),function(q){return d(q)===$}}function p($){return Array.isArray($)}function g($){return $===void 0}var _=f("ArrayBuffer");function v($){return $!==null&&typeof $=="object"}function b($){if(d($)!=="object")return!1;var q=Object.getPrototypeOf($);return q===null||q===Object.prototype}var S=f("Date"),x=f("File"),M=f("Blob"),R=f("FileList");function I($){return h.call($)==="[object Function]"}var k=f("URLSearchParams");function P($,q){if($!=null)if(typeof $!="object"&&($=[$]),p($))for(var Y=0,te=$.length;Y<te;Y++)q.call(null,$[Y],Y,$);else for(var G in $)Object.prototype.hasOwnProperty.call($,G)&&q.call(null,$[G],G,$)}var U,V=(U=typeof Uint8Array<"u"&&Object.getPrototypeOf(Uint8Array),function($){return U&&$ instanceof U});a.exports={isArray:p,isArrayBuffer:_,isBuffer:function($){return $!==null&&!g($)&&$.constructor!==null&&!g($.constructor)&&typeof $.constructor.isBuffer=="function"&&$.constructor.isBuffer($)},isFormData:function($){var q="[object FormData]";return $&&(typeof FormData=="function"&&$ instanceof FormData||h.call($)===q||I($.toString)&&$.toString()===q)},isArrayBufferView:function($){return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?ArrayBuffer.isView($):$&&$.buffer&&_($.buffer)},isString:function($){return typeof $=="string"},isNumber:function($){return typeof $=="number"},isObject:v,isPlainObject:b,isUndefined:g,isDate:S,isFile:x,isBlob:M,isFunction:I,isStream:function($){return v($)&&I($.pipe)},isURLSearchParams:k,isStandardBrowserEnv:function(){return(typeof navigator>"u"||navigator.product!=="ReactNative"&&navigator.product!=="NativeScript"&&navigator.product!=="NS")&&typeof window<"u"&&typeof document<"u"},forEach:P,merge:function $(){var q={};function Y(J,K){b(q[K])&&b(J)?q[K]=$(q[K],J):b(J)?q[K]=$({},J):p(J)?q[K]=J.slice():q[K]=J}for(var te=0,G=arguments.length;te<G;te++)P(arguments[te],Y);return q},extend:function($,q,Y){return P(q,function(te,G){$[G]=Y&&typeof te=="function"?u(te,Y):te}),$},trim:function($){return $.trim?$.trim():$.replace(/^\s+|\s+$/g,"")},stripBOM:function($){return $.charCodeAt(0)===65279&&($=$.slice(1)),$},inherits:function($,q,Y,te){$.prototype=Object.create(q.prototype,te),$.prototype.constructor=$,Y&&Object.assign($.prototype,Y)},toFlatObject:function($,q,Y){var te,G,J,K={};q=q||{};do{for(G=(te=Object.getOwnPropertyNames($)).length;G-- >0;)K[J=te[G]]||(q[J]=$[J],K[J]=!0);$=Object.getPrototypeOf($)}while($&&(!Y||Y($,q))&&$!==Object.prototype);return q},kindOf:d,kindOfTest:f,endsWith:function($,q,Y){$=String($),(Y===void 0||Y>$.length)&&(Y=$.length),Y-=q.length;var te=$.indexOf(q,Y);return te!==-1&&te===Y},toArray:function($){if(!$)return null;var q=$.length;if(g(q))return null;for(var Y=new Array(q);q-- >0;)Y[q]=$[q];return Y},isTypedArray:V,isFileList:R}},1206:function(a){a.exports=function(o){var c={};function l(u){if(c[u])return c[u].exports;var h=c[u]={i:u,l:!1,exports:{}};return o[u].call(h.exports,h,h.exports,l),h.l=!0,h.exports}return l.m=o,l.c=c,l.d=function(u,h,d){l.o(u,h)||Object.defineProperty(u,h,{enumerable:!0,get:d})},l.r=function(u){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(u,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(u,"__esModule",{value:!0})},l.t=function(u,h){if(1&h&&(u=l(u)),8&h||4&h&&typeof u=="object"&&u&&u.__esModule)return u;var d=Object.create(null);if(l.r(d),Object.defineProperty(d,"default",{enumerable:!0,value:u}),2&h&&typeof u!="string")for(var f in u)l.d(d,f,(function(p){return u[p]}).bind(null,f));return d},l.n=function(u){var h=u&&u.__esModule?function(){return u.default}:function(){return u};return l.d(h,"a",h),h},l.o=function(u,h){return Object.prototype.hasOwnProperty.call(u,h)},l.p="",l(l.s=90)}({17:function(o,c,l){c.__esModule=!0,c.default=void 0;var u=l(18),h=function(){function d(){}return d.getFirstMatch=function(f,p){var g=p.match(f);return g&&g.length>0&&g[1]||""},d.getSecondMatch=function(f,p){var g=p.match(f);return g&&g.length>1&&g[2]||""},d.matchAndReturnConst=function(f,p,g){if(f.test(p))return g},d.getWindowsVersionName=function(f){switch(f){case"NT":return"NT";case"XP":case"NT 5.1":return"XP";case"NT 5.0":return"2000";case"NT 5.2":return"2003";case"NT 6.0":return"Vista";case"NT 6.1":return"7";case"NT 6.2":return"8";case"NT 6.3":return"8.1";case"NT 10.0":return"10";default:return}},d.getMacOSVersionName=function(f){var p=f.split(".").splice(0,2).map(function(g){return parseInt(g,10)||0});if(p.push(0),p[0]===10)switch(p[1]){case 5:return"Leopard";case 6:return"Snow Leopard";case 7:return"Lion";case 8:return"Mountain Lion";case 9:return"Mavericks";case 10:return"Yosemite";case 11:return"El Capitan";case 12:return"Sierra";case 13:return"High Sierra";case 14:return"Mojave";case 15:return"Catalina";default:return}},d.getAndroidVersionName=function(f){var p=f.split(".").splice(0,2).map(function(g){return parseInt(g,10)||0});if(p.push(0),!(p[0]===1&&p[1]<5))return p[0]===1&&p[1]<6?"Cupcake":p[0]===1&&p[1]>=6?"Donut":p[0]===2&&p[1]<2?"Eclair":p[0]===2&&p[1]===2?"Froyo":p[0]===2&&p[1]>2?"Gingerbread":p[0]===3?"Honeycomb":p[0]===4&&p[1]<1?"Ice Cream Sandwich":p[0]===4&&p[1]<4?"Jelly Bean":p[0]===4&&p[1]>=4?"KitKat":p[0]===5?"Lollipop":p[0]===6?"Marshmallow":p[0]===7?"Nougat":p[0]===8?"Oreo":p[0]===9?"Pie":void 0},d.getVersionPrecision=function(f){return f.split(".").length},d.compareVersions=function(f,p,g){g===void 0&&(g=!1);var _=d.getVersionPrecision(f),v=d.getVersionPrecision(p),b=Math.max(_,v),S=0,x=d.map([f,p],function(M){var R=b-d.getVersionPrecision(M),I=M+new Array(R+1).join(".0");return d.map(I.split("."),function(k){return new Array(20-k.length).join("0")+k}).reverse()});for(g&&(S=b-Math.min(_,v)),b-=1;b>=S;){if(x[0][b]>x[1][b])return 1;if(x[0][b]===x[1][b]){if(b===S)return 0;b-=1}else if(x[0][b]<x[1][b])return-1}},d.map=function(f,p){var g,_=[];if(Array.prototype.map)return Array.prototype.map.call(f,p);for(g=0;g<f.length;g+=1)_.push(p(f[g]));return _},d.find=function(f,p){var g,_;if(Array.prototype.find)return Array.prototype.find.call(f,p);for(g=0,_=f.length;g<_;g+=1){var v=f[g];if(p(v,g))return v}},d.assign=function(f){for(var p,g,_=f,v=arguments.length,b=new Array(v>1?v-1:0),S=1;S<v;S++)b[S-1]=arguments[S];if(Object.assign)return Object.assign.apply(Object,[f].concat(b));var x=function(){var M=b[p];typeof M=="object"&&M!==null&&Object.keys(M).forEach(function(R){_[R]=M[R]})};for(p=0,g=b.length;p<g;p+=1)x();return f},d.getBrowserAlias=function(f){return u.BROWSER_ALIASES_MAP[f]},d.getBrowserTypeByAlias=function(f){return u.BROWSER_MAP[f]||""},d}();c.default=h,o.exports=c.default},18:function(o,c,l){c.__esModule=!0,c.ENGINE_MAP=c.OS_MAP=c.PLATFORMS_MAP=c.BROWSER_MAP=c.BROWSER_ALIASES_MAP=void 0,c.BROWSER_ALIASES_MAP={"Amazon Silk":"amazon_silk","Android Browser":"android",Bada:"bada",BlackBerry:"blackberry",Chrome:"chrome",Chromium:"chromium",Electron:"electron",Epiphany:"epiphany",Firefox:"firefox",Focus:"focus",Generic:"generic","Google Search":"google_search",Googlebot:"googlebot","Internet Explorer":"ie","K-Meleon":"k_meleon",Maxthon:"maxthon","Microsoft Edge":"edge","MZ Browser":"mz","NAVER Whale Browser":"naver",Opera:"opera","Opera Coast":"opera_coast",PhantomJS:"phantomjs",Puffin:"puffin",QupZilla:"qupzilla",QQ:"qq",QQLite:"qqlite",Safari:"safari",Sailfish:"sailfish","Samsung Internet for Android":"samsung_internet",SeaMonkey:"seamonkey",Sleipnir:"sleipnir",Swing:"swing",Tizen:"tizen","UC Browser":"uc",Vivaldi:"vivaldi","WebOS Browser":"webos",WeChat:"wechat","Yandex Browser":"yandex",Roku:"roku"},c.BROWSER_MAP={amazon_silk:"Amazon Silk",android:"Android Browser",bada:"Bada",blackberry:"BlackBerry",chrome:"Chrome",chromium:"Chromium",electron:"Electron",epiphany:"Epiphany",firefox:"Firefox",focus:"Focus",generic:"Generic",googlebot:"Googlebot",google_search:"Google Search",ie:"Internet Explorer",k_meleon:"K-Meleon",maxthon:"Maxthon",edge:"Microsoft Edge",mz:"MZ Browser",naver:"NAVER Whale Browser",opera:"Opera",opera_coast:"Opera Coast",phantomjs:"PhantomJS",puffin:"Puffin",qupzilla:"QupZilla",qq:"QQ Browser",qqlite:"QQ Browser Lite",safari:"Safari",sailfish:"Sailfish",samsung_internet:"Samsung Internet for Android",seamonkey:"SeaMonkey",sleipnir:"Sleipnir",swing:"Swing",tizen:"Tizen",uc:"UC Browser",vivaldi:"Vivaldi",webos:"WebOS Browser",wechat:"WeChat",yandex:"Yandex Browser"},c.PLATFORMS_MAP={tablet:"tablet",mobile:"mobile",desktop:"desktop",tv:"tv"},c.OS_MAP={WindowsPhone:"Windows Phone",Windows:"Windows",MacOS:"macOS",iOS:"iOS",Android:"Android",WebOS:"WebOS",BlackBerry:"BlackBerry",Bada:"Bada",Tizen:"Tizen",Linux:"Linux",ChromeOS:"Chrome OS",PlayStation4:"PlayStation 4",Roku:"Roku"},c.ENGINE_MAP={EdgeHTML:"EdgeHTML",Blink:"Blink",Trident:"Trident",Presto:"Presto",Gecko:"Gecko",WebKit:"WebKit"}},90:function(o,c,l){c.__esModule=!0,c.default=void 0;var u,h=(u=l(91))&&u.__esModule?u:{default:u},d=l(18);function f(g,_){for(var v=0;v<_.length;v++){var b=_[v];b.enumerable=b.enumerable||!1,b.configurable=!0,"value"in b&&(b.writable=!0),Object.defineProperty(g,b.key,b)}}var p=function(){function g(){}var _,v,b;return g.getParser=function(S,x){if(x===void 0&&(x=!1),typeof S!="string")throw new Error("UserAgent should be a string");return new h.default(S,x)},g.parse=function(S){return new h.default(S).getResult()},_=g,b=[{key:"BROWSER_MAP",get:function(){return d.BROWSER_MAP}},{key:"ENGINE_MAP",get:function(){return d.ENGINE_MAP}},{key:"OS_MAP",get:function(){return d.OS_MAP}},{key:"PLATFORMS_MAP",get:function(){return d.PLATFORMS_MAP}}],(v=null)&&f(_.prototype,v),b&&f(_,b),g}();c.default=p,o.exports=c.default},91:function(o,c,l){c.__esModule=!0,c.default=void 0;var u=g(l(92)),h=g(l(93)),d=g(l(94)),f=g(l(95)),p=g(l(17));function g(v){return v&&v.__esModule?v:{default:v}}var _=function(){function v(S,x){if(x===void 0&&(x=!1),S==null||S==="")throw new Error("UserAgent parameter can't be empty");this._ua=S,this.parsedResult={},x!==!0&&this.parse()}var b=v.prototype;return b.getUA=function(){return this._ua},b.test=function(S){return S.test(this._ua)},b.parseBrowser=function(){var S=this;this.parsedResult.browser={};var x=p.default.find(u.default,function(M){if(typeof M.test=="function")return M.test(S);if(M.test instanceof Array)return M.test.some(function(R){return S.test(R)});throw new Error("Browser's test function is not valid")});return x&&(this.parsedResult.browser=x.describe(this.getUA())),this.parsedResult.browser},b.getBrowser=function(){return this.parsedResult.browser?this.parsedResult.browser:this.parseBrowser()},b.getBrowserName=function(S){return S?String(this.getBrowser().name).toLowerCase()||"":this.getBrowser().name||""},b.getBrowserVersion=function(){return this.getBrowser().version},b.getOS=function(){return this.parsedResult.os?this.parsedResult.os:this.parseOS()},b.parseOS=function(){var S=this;this.parsedResult.os={};var x=p.default.find(h.default,function(M){if(typeof M.test=="function")return M.test(S);if(M.test instanceof Array)return M.test.some(function(R){return S.test(R)});throw new Error("Browser's test function is not valid")});return x&&(this.parsedResult.os=x.describe(this.getUA())),this.parsedResult.os},b.getOSName=function(S){var x=this.getOS().name;return S?String(x).toLowerCase()||"":x||""},b.getOSVersion=function(){return this.getOS().version},b.getPlatform=function(){return this.parsedResult.platform?this.parsedResult.platform:this.parsePlatform()},b.getPlatformType=function(S){S===void 0&&(S=!1);var x=this.getPlatform().type;return S?String(x).toLowerCase()||"":x||""},b.parsePlatform=function(){var S=this;this.parsedResult.platform={};var x=p.default.find(d.default,function(M){if(typeof M.test=="function")return M.test(S);if(M.test instanceof Array)return M.test.some(function(R){return S.test(R)});throw new Error("Browser's test function is not valid")});return x&&(this.parsedResult.platform=x.describe(this.getUA())),this.parsedResult.platform},b.getEngine=function(){return this.parsedResult.engine?this.parsedResult.engine:this.parseEngine()},b.getEngineName=function(S){return S?String(this.getEngine().name).toLowerCase()||"":this.getEngine().name||""},b.parseEngine=function(){var S=this;this.parsedResult.engine={};var x=p.default.find(f.default,function(M){if(typeof M.test=="function")return M.test(S);if(M.test instanceof Array)return M.test.some(function(R){return S.test(R)});throw new Error("Browser's test function is not valid")});return x&&(this.parsedResult.engine=x.describe(this.getUA())),this.parsedResult.engine},b.parse=function(){return this.parseBrowser(),this.parseOS(),this.parsePlatform(),this.parseEngine(),this},b.getResult=function(){return p.default.assign({},this.parsedResult)},b.satisfies=function(S){var x=this,M={},R=0,I={},k=0;if(Object.keys(S).forEach(function(G){var J=S[G];typeof J=="string"?(I[G]=J,k+=1):typeof J=="object"&&(M[G]=J,R+=1)}),R>0){var P=Object.keys(M),U=p.default.find(P,function(G){return x.isOS(G)});if(U){var V=this.satisfies(M[U]);if(V!==void 0)return V}var $=p.default.find(P,function(G){return x.isPlatform(G)});if($){var q=this.satisfies(M[$]);if(q!==void 0)return q}}if(k>0){var Y=Object.keys(I),te=p.default.find(Y,function(G){return x.isBrowser(G,!0)});if(te!==void 0)return this.compareVersion(I[te])}},b.isBrowser=function(S,x){x===void 0&&(x=!1);var M=this.getBrowserName().toLowerCase(),R=S.toLowerCase(),I=p.default.getBrowserTypeByAlias(R);return x&&I&&(R=I.toLowerCase()),R===M},b.compareVersion=function(S){var x=[0],M=S,R=!1,I=this.getBrowserVersion();if(typeof I=="string")return S[0]===">"||S[0]==="<"?(M=S.substr(1),S[1]==="="?(R=!0,M=S.substr(2)):x=[],S[0]===">"?x.push(1):x.push(-1)):S[0]==="="?M=S.substr(1):S[0]==="~"&&(R=!0,M=S.substr(1)),x.indexOf(p.default.compareVersions(I,M,R))>-1},b.isOS=function(S){return this.getOSName(!0)===String(S).toLowerCase()},b.isPlatform=function(S){return this.getPlatformType(!0)===String(S).toLowerCase()},b.isEngine=function(S){return this.getEngineName(!0)===String(S).toLowerCase()},b.is=function(S,x){return x===void 0&&(x=!1),this.isBrowser(S,x)||this.isOS(S)||this.isPlatform(S)},b.some=function(S){var x=this;return S===void 0&&(S=[]),S.some(function(M){return x.is(M)})},v}();c.default=_,o.exports=c.default},92:function(o,c,l){c.__esModule=!0,c.default=void 0;var u,h=(u=l(17))&&u.__esModule?u:{default:u},d=/version\/(\d+(\.?_?\d+)+)/i,f=[{test:[/googlebot/i],describe:function(p){var g={name:"Googlebot"},_=h.default.getFirstMatch(/googlebot\/(\d+(\.\d+))/i,p)||h.default.getFirstMatch(d,p);return _&&(g.version=_),g}},{test:[/opera/i],describe:function(p){var g={name:"Opera"},_=h.default.getFirstMatch(d,p)||h.default.getFirstMatch(/(?:opera)[\s/](\d+(\.?_?\d+)+)/i,p);return _&&(g.version=_),g}},{test:[/opr\/|opios/i],describe:function(p){var g={name:"Opera"},_=h.default.getFirstMatch(/(?:opr|opios)[\s/](\S+)/i,p)||h.default.getFirstMatch(d,p);return _&&(g.version=_),g}},{test:[/SamsungBrowser/i],describe:function(p){var g={name:"Samsung Internet for Android"},_=h.default.getFirstMatch(d,p)||h.default.getFirstMatch(/(?:SamsungBrowser)[\s/](\d+(\.?_?\d+)+)/i,p);return _&&(g.version=_),g}},{test:[/Whale/i],describe:function(p){var g={name:"NAVER Whale Browser"},_=h.default.getFirstMatch(d,p)||h.default.getFirstMatch(/(?:whale)[\s/](\d+(?:\.\d+)+)/i,p);return _&&(g.version=_),g}},{test:[/MZBrowser/i],describe:function(p){var g={name:"MZ Browser"},_=h.default.getFirstMatch(/(?:MZBrowser)[\s/](\d+(?:\.\d+)+)/i,p)||h.default.getFirstMatch(d,p);return _&&(g.version=_),g}},{test:[/focus/i],describe:function(p){var g={name:"Focus"},_=h.default.getFirstMatch(/(?:focus)[\s/](\d+(?:\.\d+)+)/i,p)||h.default.getFirstMatch(d,p);return _&&(g.version=_),g}},{test:[/swing/i],describe:function(p){var g={name:"Swing"},_=h.default.getFirstMatch(/(?:swing)[\s/](\d+(?:\.\d+)+)/i,p)||h.default.getFirstMatch(d,p);return _&&(g.version=_),g}},{test:[/coast/i],describe:function(p){var g={name:"Opera Coast"},_=h.default.getFirstMatch(d,p)||h.default.getFirstMatch(/(?:coast)[\s/](\d+(\.?_?\d+)+)/i,p);return _&&(g.version=_),g}},{test:[/opt\/\d+(?:.?_?\d+)+/i],describe:function(p){var g={name:"Opera Touch"},_=h.default.getFirstMatch(/(?:opt)[\s/](\d+(\.?_?\d+)+)/i,p)||h.default.getFirstMatch(d,p);return _&&(g.version=_),g}},{test:[/yabrowser/i],describe:function(p){var g={name:"Yandex Browser"},_=h.default.getFirstMatch(/(?:yabrowser)[\s/](\d+(\.?_?\d+)+)/i,p)||h.default.getFirstMatch(d,p);return _&&(g.version=_),g}},{test:[/ucbrowser/i],describe:function(p){var g={name:"UC Browser"},_=h.default.getFirstMatch(d,p)||h.default.getFirstMatch(/(?:ucbrowser)[\s/](\d+(\.?_?\d+)+)/i,p);return _&&(g.version=_),g}},{test:[/Maxthon|mxios/i],describe:function(p){var g={name:"Maxthon"},_=h.default.getFirstMatch(d,p)||h.default.getFirstMatch(/(?:Maxthon|mxios)[\s/](\d+(\.?_?\d+)+)/i,p);return _&&(g.version=_),g}},{test:[/epiphany/i],describe:function(p){var g={name:"Epiphany"},_=h.default.getFirstMatch(d,p)||h.default.getFirstMatch(/(?:epiphany)[\s/](\d+(\.?_?\d+)+)/i,p);return _&&(g.version=_),g}},{test:[/puffin/i],describe:function(p){var g={name:"Puffin"},_=h.default.getFirstMatch(d,p)||h.default.getFirstMatch(/(?:puffin)[\s/](\d+(\.?_?\d+)+)/i,p);return _&&(g.version=_),g}},{test:[/sleipnir/i],describe:function(p){var g={name:"Sleipnir"},_=h.default.getFirstMatch(d,p)||h.default.getFirstMatch(/(?:sleipnir)[\s/](\d+(\.?_?\d+)+)/i,p);return _&&(g.version=_),g}},{test:[/k-meleon/i],describe:function(p){var g={name:"K-Meleon"},_=h.default.getFirstMatch(d,p)||h.default.getFirstMatch(/(?:k-meleon)[\s/](\d+(\.?_?\d+)+)/i,p);return _&&(g.version=_),g}},{test:[/micromessenger/i],describe:function(p){var g={name:"WeChat"},_=h.default.getFirstMatch(/(?:micromessenger)[\s/](\d+(\.?_?\d+)+)/i,p)||h.default.getFirstMatch(d,p);return _&&(g.version=_),g}},{test:[/qqbrowser/i],describe:function(p){var g={name:/qqbrowserlite/i.test(p)?"QQ Browser Lite":"QQ Browser"},_=h.default.getFirstMatch(/(?:qqbrowserlite|qqbrowser)[/](\d+(\.?_?\d+)+)/i,p)||h.default.getFirstMatch(d,p);return _&&(g.version=_),g}},{test:[/msie|trident/i],describe:function(p){var g={name:"Internet Explorer"},_=h.default.getFirstMatch(/(?:msie |rv:)(\d+(\.?_?\d+)+)/i,p);return _&&(g.version=_),g}},{test:[/\sedg\//i],describe:function(p){var g={name:"Microsoft Edge"},_=h.default.getFirstMatch(/\sedg\/(\d+(\.?_?\d+)+)/i,p);return _&&(g.version=_),g}},{test:[/edg([ea]|ios)/i],describe:function(p){var g={name:"Microsoft Edge"},_=h.default.getSecondMatch(/edg([ea]|ios)\/(\d+(\.?_?\d+)+)/i,p);return _&&(g.version=_),g}},{test:[/vivaldi/i],describe:function(p){var g={name:"Vivaldi"},_=h.default.getFirstMatch(/vivaldi\/(\d+(\.?_?\d+)+)/i,p);return _&&(g.version=_),g}},{test:[/seamonkey/i],describe:function(p){var g={name:"SeaMonkey"},_=h.default.getFirstMatch(/seamonkey\/(\d+(\.?_?\d+)+)/i,p);return _&&(g.version=_),g}},{test:[/sailfish/i],describe:function(p){var g={name:"Sailfish"},_=h.default.getFirstMatch(/sailfish\s?browser\/(\d+(\.\d+)?)/i,p);return _&&(g.version=_),g}},{test:[/silk/i],describe:function(p){var g={name:"Amazon Silk"},_=h.default.getFirstMatch(/silk\/(\d+(\.?_?\d+)+)/i,p);return _&&(g.version=_),g}},{test:[/phantom/i],describe:function(p){var g={name:"PhantomJS"},_=h.default.getFirstMatch(/phantomjs\/(\d+(\.?_?\d+)+)/i,p);return _&&(g.version=_),g}},{test:[/slimerjs/i],describe:function(p){var g={name:"SlimerJS"},_=h.default.getFirstMatch(/slimerjs\/(\d+(\.?_?\d+)+)/i,p);return _&&(g.version=_),g}},{test:[/blackberry|\bbb\d+/i,/rim\stablet/i],describe:function(p){var g={name:"BlackBerry"},_=h.default.getFirstMatch(d,p)||h.default.getFirstMatch(/blackberry[\d]+\/(\d+(\.?_?\d+)+)/i,p);return _&&(g.version=_),g}},{test:[/(web|hpw)[o0]s/i],describe:function(p){var g={name:"WebOS Browser"},_=h.default.getFirstMatch(d,p)||h.default.getFirstMatch(/w(?:eb)?[o0]sbrowser\/(\d+(\.?_?\d+)+)/i,p);return _&&(g.version=_),g}},{test:[/bada/i],describe:function(p){var g={name:"Bada"},_=h.default.getFirstMatch(/dolfin\/(\d+(\.?_?\d+)+)/i,p);return _&&(g.version=_),g}},{test:[/tizen/i],describe:function(p){var g={name:"Tizen"},_=h.default.getFirstMatch(/(?:tizen\s?)?browser\/(\d+(\.?_?\d+)+)/i,p)||h.default.getFirstMatch(d,p);return _&&(g.version=_),g}},{test:[/qupzilla/i],describe:function(p){var g={name:"QupZilla"},_=h.default.getFirstMatch(/(?:qupzilla)[\s/](\d+(\.?_?\d+)+)/i,p)||h.default.getFirstMatch(d,p);return _&&(g.version=_),g}},{test:[/firefox|iceweasel|fxios/i],describe:function(p){var g={name:"Firefox"},_=h.default.getFirstMatch(/(?:firefox|iceweasel|fxios)[\s/](\d+(\.?_?\d+)+)/i,p);return _&&(g.version=_),g}},{test:[/electron/i],describe:function(p){var g={name:"Electron"},_=h.default.getFirstMatch(/(?:electron)\/(\d+(\.?_?\d+)+)/i,p);return _&&(g.version=_),g}},{test:[/MiuiBrowser/i],describe:function(p){var g={name:"Miui"},_=h.default.getFirstMatch(/(?:MiuiBrowser)[\s/](\d+(\.?_?\d+)+)/i,p);return _&&(g.version=_),g}},{test:[/chromium/i],describe:function(p){var g={name:"Chromium"},_=h.default.getFirstMatch(/(?:chromium)[\s/](\d+(\.?_?\d+)+)/i,p)||h.default.getFirstMatch(d,p);return _&&(g.version=_),g}},{test:[/chrome|crios|crmo/i],describe:function(p){var g={name:"Chrome"},_=h.default.getFirstMatch(/(?:chrome|crios|crmo)\/(\d+(\.?_?\d+)+)/i,p);return _&&(g.version=_),g}},{test:[/GSA/i],describe:function(p){var g={name:"Google Search"},_=h.default.getFirstMatch(/(?:GSA)\/(\d+(\.?_?\d+)+)/i,p);return _&&(g.version=_),g}},{test:function(p){var g=!p.test(/like android/i),_=p.test(/android/i);return g&&_},describe:function(p){var g={name:"Android Browser"},_=h.default.getFirstMatch(d,p);return _&&(g.version=_),g}},{test:[/playstation 4/i],describe:function(p){var g={name:"PlayStation 4"},_=h.default.getFirstMatch(d,p);return _&&(g.version=_),g}},{test:[/safari|applewebkit/i],describe:function(p){var g={name:"Safari"},_=h.default.getFirstMatch(d,p);return _&&(g.version=_),g}},{test:[/.*/i],describe:function(p){var g=p.search("\\(")!==-1?/^(.*)\/(.*)[ \t]\((.*)/:/^(.*)\/(.*) /;return{name:h.default.getFirstMatch(g,p),version:h.default.getSecondMatch(g,p)}}}];c.default=f,o.exports=c.default},93:function(o,c,l){c.__esModule=!0,c.default=void 0;var u,h=(u=l(17))&&u.__esModule?u:{default:u},d=l(18),f=[{test:[/Roku\/DVP/],describe:function(p){var g=h.default.getFirstMatch(/Roku\/DVP-(\d+\.\d+)/i,p);return{name:d.OS_MAP.Roku,version:g}}},{test:[/windows phone/i],describe:function(p){var g=h.default.getFirstMatch(/windows phone (?:os)?\s?(\d+(\.\d+)*)/i,p);return{name:d.OS_MAP.WindowsPhone,version:g}}},{test:[/windows /i],describe:function(p){var g=h.default.getFirstMatch(/Windows ((NT|XP)( \d\d?.\d)?)/i,p),_=h.default.getWindowsVersionName(g);return{name:d.OS_MAP.Windows,version:g,versionName:_}}},{test:[/Macintosh(.*?) FxiOS(.*?)\//],describe:function(p){var g={name:d.OS_MAP.iOS},_=h.default.getSecondMatch(/(Version\/)(\d[\d.]+)/,p);return _&&(g.version=_),g}},{test:[/macintosh/i],describe:function(p){var g=h.default.getFirstMatch(/mac os x (\d+(\.?_?\d+)+)/i,p).replace(/[_\s]/g,"."),_=h.default.getMacOSVersionName(g),v={name:d.OS_MAP.MacOS,version:g};return _&&(v.versionName=_),v}},{test:[/(ipod|iphone|ipad)/i],describe:function(p){var g=h.default.getFirstMatch(/os (\d+([_\s]\d+)*) like mac os x/i,p).replace(/[_\s]/g,".");return{name:d.OS_MAP.iOS,version:g}}},{test:function(p){var g=!p.test(/like android/i),_=p.test(/android/i);return g&&_},describe:function(p){var g=h.default.getFirstMatch(/android[\s/-](\d+(\.\d+)*)/i,p),_=h.default.getAndroidVersionName(g),v={name:d.OS_MAP.Android,version:g};return _&&(v.versionName=_),v}},{test:[/(web|hpw)[o0]s/i],describe:function(p){var g=h.default.getFirstMatch(/(?:web|hpw)[o0]s\/(\d+(\.\d+)*)/i,p),_={name:d.OS_MAP.WebOS};return g&&g.length&&(_.version=g),_}},{test:[/blackberry|\bbb\d+/i,/rim\stablet/i],describe:function(p){var g=h.default.getFirstMatch(/rim\stablet\sos\s(\d+(\.\d+)*)/i,p)||h.default.getFirstMatch(/blackberry\d+\/(\d+([_\s]\d+)*)/i,p)||h.default.getFirstMatch(/\bbb(\d+)/i,p);return{name:d.OS_MAP.BlackBerry,version:g}}},{test:[/bada/i],describe:function(p){var g=h.default.getFirstMatch(/bada\/(\d+(\.\d+)*)/i,p);return{name:d.OS_MAP.Bada,version:g}}},{test:[/tizen/i],describe:function(p){var g=h.default.getFirstMatch(/tizen[/\s](\d+(\.\d+)*)/i,p);return{name:d.OS_MAP.Tizen,version:g}}},{test:[/linux/i],describe:function(){return{name:d.OS_MAP.Linux}}},{test:[/CrOS/],describe:function(){return{name:d.OS_MAP.ChromeOS}}},{test:[/PlayStation 4/],describe:function(p){var g=h.default.getFirstMatch(/PlayStation 4[/\s](\d+(\.\d+)*)/i,p);return{name:d.OS_MAP.PlayStation4,version:g}}}];c.default=f,o.exports=c.default},94:function(o,c,l){c.__esModule=!0,c.default=void 0;var u,h=(u=l(17))&&u.__esModule?u:{default:u},d=l(18),f=[{test:[/googlebot/i],describe:function(){return{type:"bot",vendor:"Google"}}},{test:[/huawei/i],describe:function(p){var g=h.default.getFirstMatch(/(can-l01)/i,p)&&"Nova",_={type:d.PLATFORMS_MAP.mobile,vendor:"Huawei"};return g&&(_.model=g),_}},{test:[/nexus\s*(?:7|8|9|10).*/i],describe:function(){return{type:d.PLATFORMS_MAP.tablet,vendor:"Nexus"}}},{test:[/ipad/i],describe:function(){return{type:d.PLATFORMS_MAP.tablet,vendor:"Apple",model:"iPad"}}},{test:[/Macintosh(.*?) FxiOS(.*?)\//],describe:function(){return{type:d.PLATFORMS_MAP.tablet,vendor:"Apple",model:"iPad"}}},{test:[/kftt build/i],describe:function(){return{type:d.PLATFORMS_MAP.tablet,vendor:"Amazon",model:"Kindle Fire HD 7"}}},{test:[/silk/i],describe:function(){return{type:d.PLATFORMS_MAP.tablet,vendor:"Amazon"}}},{test:[/tablet(?! pc)/i],describe:function(){return{type:d.PLATFORMS_MAP.tablet}}},{test:function(p){var g=p.test(/ipod|iphone/i),_=p.test(/like (ipod|iphone)/i);return g&&!_},describe:function(p){var g=h.default.getFirstMatch(/(ipod|iphone)/i,p);return{type:d.PLATFORMS_MAP.mobile,vendor:"Apple",model:g}}},{test:[/nexus\s*[0-6].*/i,/galaxy nexus/i],describe:function(){return{type:d.PLATFORMS_MAP.mobile,vendor:"Nexus"}}},{test:[/[^-]mobi/i],describe:function(){return{type:d.PLATFORMS_MAP.mobile}}},{test:function(p){return p.getBrowserName(!0)==="blackberry"},describe:function(){return{type:d.PLATFORMS_MAP.mobile,vendor:"BlackBerry"}}},{test:function(p){return p.getBrowserName(!0)==="bada"},describe:function(){return{type:d.PLATFORMS_MAP.mobile}}},{test:function(p){return p.getBrowserName()==="windows phone"},describe:function(){return{type:d.PLATFORMS_MAP.mobile,vendor:"Microsoft"}}},{test:function(p){var g=Number(String(p.getOSVersion()).split(".")[0]);return p.getOSName(!0)==="android"&&g>=3},describe:function(){return{type:d.PLATFORMS_MAP.tablet}}},{test:function(p){return p.getOSName(!0)==="android"},describe:function(){return{type:d.PLATFORMS_MAP.mobile}}},{test:function(p){return p.getOSName(!0)==="macos"},describe:function(){return{type:d.PLATFORMS_MAP.desktop,vendor:"Apple"}}},{test:function(p){return p.getOSName(!0)==="windows"},describe:function(){return{type:d.PLATFORMS_MAP.desktop}}},{test:function(p){return p.getOSName(!0)==="linux"},describe:function(){return{type:d.PLATFORMS_MAP.desktop}}},{test:function(p){return p.getOSName(!0)==="playstation 4"},describe:function(){return{type:d.PLATFORMS_MAP.tv}}},{test:function(p){return p.getOSName(!0)==="roku"},describe:function(){return{type:d.PLATFORMS_MAP.tv}}}];c.default=f,o.exports=c.default},95:function(o,c,l){c.__esModule=!0,c.default=void 0;var u,h=(u=l(17))&&u.__esModule?u:{default:u},d=l(18),f=[{test:function(p){return p.getBrowserName(!0)==="microsoft edge"},describe:function(p){if(/\sedg\//i.test(p))return{name:d.ENGINE_MAP.Blink};var g=h.default.getFirstMatch(/edge\/(\d+(\.?_?\d+)+)/i,p);return{name:d.ENGINE_MAP.EdgeHTML,version:g}}},{test:[/trident/i],describe:function(p){var g={name:d.ENGINE_MAP.Trident},_=h.default.getFirstMatch(/trident\/(\d+(\.?_?\d+)+)/i,p);return _&&(g.version=_),g}},{test:function(p){return p.test(/presto/i)},describe:function(p){var g={name:d.ENGINE_MAP.Presto},_=h.default.getFirstMatch(/presto\/(\d+(\.?_?\d+)+)/i,p);return _&&(g.version=_),g}},{test:function(p){var g=p.test(/gecko/i),_=p.test(/like gecko/i);return g&&!_},describe:function(p){var g={name:d.ENGINE_MAP.Gecko},_=h.default.getFirstMatch(/gecko\/(\d+(\.?_?\d+)+)/i,p);return _&&(g.version=_),g}},{test:[/(apple)?webkit\/537\.36/i],describe:function(){return{name:d.ENGINE_MAP.Blink}}},{test:[/(apple)?webkit/i],describe:function(p){var g={name:d.ENGINE_MAP.WebKit},_=h.default.getFirstMatch(/webkit\/(\d+(\.?_?\d+)+)/i,p);return _&&(g.version=_),g}}];c.default=f,o.exports=c.default}})},6729:a=>{var o=Object.prototype.hasOwnProperty,c="~";function l(){}function u(p,g,_){this.fn=p,this.context=g,this.once=_||!1}function h(p,g,_,v,b){if(typeof _!="function")throw new TypeError("The listener must be a function");var S=new u(_,v||p,b),x=c?c+g:g;return p._events[x]?p._events[x].fn?p._events[x]=[p._events[x],S]:p._events[x].push(S):(p._events[x]=S,p._eventsCount++),p}function d(p,g){--p._eventsCount==0?p._events=new l:delete p._events[g]}function f(){this._events=new l,this._eventsCount=0}Object.create&&(l.prototype=Object.create(null),new l().__proto__||(c=!1)),f.prototype.eventNames=function(){var p,g,_=[];if(this._eventsCount===0)return _;for(g in p=this._events)o.call(p,g)&&_.push(c?g.slice(1):g);return Object.getOwnPropertySymbols?_.concat(Object.getOwnPropertySymbols(p)):_},f.prototype.listeners=function(p){var g=c?c+p:p,_=this._events[g];if(!_)return[];if(_.fn)return[_.fn];for(var v=0,b=_.length,S=new Array(b);v<b;v++)S[v]=_[v].fn;return S},f.prototype.listenerCount=function(p){var g=c?c+p:p,_=this._events[g];return _?_.fn?1:_.length:0},f.prototype.emit=function(p,g,_,v,b,S){var x=c?c+p:p;if(!this._events[x])return!1;var M,R,I=this._events[x],k=arguments.length;if(I.fn){switch(I.once&&this.removeListener(p,I.fn,void 0,!0),k){case 1:return I.fn.call(I.context),!0;case 2:return I.fn.call(I.context,g),!0;case 3:return I.fn.call(I.context,g,_),!0;case 4:return I.fn.call(I.context,g,_,v),!0;case 5:return I.fn.call(I.context,g,_,v,b),!0;case 6:return I.fn.call(I.context,g,_,v,b,S),!0}for(R=1,M=new Array(k-1);R<k;R++)M[R-1]=arguments[R];I.fn.apply(I.context,M)}else{var P,U=I.length;for(R=0;R<U;R++)switch(I[R].once&&this.removeListener(p,I[R].fn,void 0,!0),k){case 1:I[R].fn.call(I[R].context);break;case 2:I[R].fn.call(I[R].context,g);break;case 3:I[R].fn.call(I[R].context,g,_);break;case 4:I[R].fn.call(I[R].context,g,_,v);break;default:if(!M)for(P=1,M=new Array(k-1);P<k;P++)M[P-1]=arguments[P];I[R].fn.apply(I[R].context,M)}}return!0},f.prototype.on=function(p,g,_){return h(this,p,g,_,!1)},f.prototype.once=function(p,g,_){return h(this,p,g,_,!0)},f.prototype.removeListener=function(p,g,_,v){var b=c?c+p:p;if(!this._events[b])return this;if(!g)return d(this,b),this;var S=this._events[b];if(S.fn)S.fn!==g||v&&!S.once||_&&S.context!==_||d(this,b);else{for(var x=0,M=[],R=S.length;x<R;x++)(S[x].fn!==g||v&&!S[x].once||_&&S[x].context!==_)&&M.push(S[x]);M.length?this._events[b]=M.length===1?M[0]:M:d(this,b)}return this},f.prototype.removeAllListeners=function(p){var g;return p?(g=c?c+p:p,this._events[g]&&d(this,g)):(this._events=new l,this._eventsCount=0),this},f.prototype.off=f.prototype.removeListener,f.prototype.addListener=f.prototype.on,f.prefixed=c,f.EventEmitter=f,a.exports=f},1564:a=>{var o;o=()=>(()=>{var c={228:u=>{var h=Object.prototype.hasOwnProperty,d="~";function f(){}function p(b,S,x){this.fn=b,this.context=S,this.once=x||!1}function g(b,S,x,M,R){if(typeof x!="function")throw new TypeError("The listener must be a function");var I=new p(x,M||b,R),k=d?d+S:S;return b._events[k]?b._events[k].fn?b._events[k]=[b._events[k],I]:b._events[k].push(I):(b._events[k]=I,b._eventsCount++),b}function _(b,S){--b._eventsCount==0?b._events=new f:delete b._events[S]}function v(){this._events=new f,this._eventsCount=0}Object.create&&(f.prototype=Object.create(null),new f().__proto__||(d=!1)),v.prototype.eventNames=function(){var b,S,x=[];if(this._eventsCount===0)return x;for(S in b=this._events)h.call(b,S)&&x.push(d?S.slice(1):S);return Object.getOwnPropertySymbols?x.concat(Object.getOwnPropertySymbols(b)):x},v.prototype.listeners=function(b){var S=d?d+b:b,x=this._events[S];if(!x)return[];if(x.fn)return[x.fn];for(var M=0,R=x.length,I=new Array(R);M<R;M++)I[M]=x[M].fn;return I},v.prototype.listenerCount=function(b){var S=d?d+b:b,x=this._events[S];return x?x.fn?1:x.length:0},v.prototype.emit=function(b,S,x,M,R,I){var k=d?d+b:b;if(!this._events[k])return!1;var P,U,V=this._events[k],$=arguments.length;if(V.fn){switch(V.once&&this.removeListener(b,V.fn,void 0,!0),$){case 1:return V.fn.call(V.context),!0;case 2:return V.fn.call(V.context,S),!0;case 3:return V.fn.call(V.context,S,x),!0;case 4:return V.fn.call(V.context,S,x,M),!0;case 5:return V.fn.call(V.context,S,x,M,R),!0;case 6:return V.fn.call(V.context,S,x,M,R,I),!0}for(U=1,P=new Array($-1);U<$;U++)P[U-1]=arguments[U];V.fn.apply(V.context,P)}else{var q,Y=V.length;for(U=0;U<Y;U++)switch(V[U].once&&this.removeListener(b,V[U].fn,void 0,!0),$){case 1:V[U].fn.call(V[U].context);break;case 2:V[U].fn.call(V[U].context,S);break;case 3:V[U].fn.call(V[U].context,S,x);break;case 4:V[U].fn.call(V[U].context,S,x,M);break;default:if(!P)for(q=1,P=new Array($-1);q<$;q++)P[q-1]=arguments[q];V[U].fn.apply(V[U].context,P)}}return!0},v.prototype.on=function(b,S,x){return g(this,b,S,x,!1)},v.prototype.once=function(b,S,x){return g(this,b,S,x,!0)},v.prototype.removeListener=function(b,S,x,M){var R=d?d+b:b;if(!this._events[R])return this;if(!S)return _(this,R),this;var I=this._events[R];if(I.fn)I.fn!==S||M&&!I.once||x&&I.context!==x||_(this,R);else{for(var k=0,P=[],U=I.length;k<U;k++)(I[k].fn!==S||M&&!I[k].once||x&&I[k].context!==x)&&P.push(I[k]);P.length?this._events[R]=P.length===1?P[0]:P:_(this,R)}return this},v.prototype.removeAllListeners=function(b){var S;return b?(S=d?d+b:b,this._events[S]&&_(this,S)):(this._events=new f,this._eventsCount=0),this},v.prototype.off=v.prototype.removeListener,v.prototype.addListener=v.prototype.on,v.prefixed=d,v.EventEmitter=v,u.exports=v},815:function(u,h){var d,f,p=this&&this.__extends||(d=function(K,X){return d=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(ae,ce){ae.__proto__=ce}||function(ae,ce){for(var Me in ce)Object.prototype.hasOwnProperty.call(ce,Me)&&(ae[Me]=ce[Me])},d(K,X)},function(K,X){if(typeof X!="function"&&X!==null)throw new TypeError("Class extends value "+String(X)+" is not a constructor or null");function ae(){this.constructor=K}d(K,X),K.prototype=X===null?Object.create(X):(ae.prototype=X.prototype,new ae)});function g(K){return 60*K*60}function _(K){return 60*K*60*24}Object.defineProperty(h,"__esModule",{value:!0}),h.daysToSeconds=h.hoursToSeconds=h.ConfigurationHolder=h.ConfigurationManager=h.Env=void 0,function(K){K.BETA="beta",K.PROD="prod",K.CUSTOM="custom"}(f||(h.Env=f={})),h.hoursToSeconds=g,h.daysToSeconds=_;var v=function(K){function X(ae){return K.call(this,ae)||this}return p(X,K),X}(Error),b="data",S="metrics",x=g(1),M=_(3),R=g(2),I="base64",k=function(){function K(X,ae){var ce,Me,Fe,Te,Re,ge,_e,ke;if(!ae.fileKey)throw new Error("options.fileKey cannot be empty");var gt=(ce=ae.clock)!==null&&ce!==void 0?ce:new te,wt=gt.getMillis();switch(this.context=X,this.fileKey=ae.fileKey,this.env=ae.standardEnv,ae.standardEnv){case f.BETA:this.fetchServer="beta.ivs-device-config-beta.live-video.net";break;case f.PROD:this.fetchServer="prod.ivs-device-config.live-video.net";break;case f.CUSTOM:if(!ae.customServer)throw new Error("Custom env requires options.customServer");this.fetchServer=ae.customServer;break;default:throw new Error("Invalid value for standardEnv: ".concat(ae.standardEnv))}this.trace=(Me=ae.trace)!==null&&Me!==void 0?Me:new $(this.env),this.fetch=(Fe=ae.fetch)!==null&&Fe!==void 0?Fe:new V(X),this.storage=new Y("amazon_ivs_device_config_v1_"+ae.fileKey,X.localStorage),this.state=new J(this.storage,"state"),this.refresh={refreshIntervalSeconds:(Te=ae.refresh.refreshIntervalSeconds)!==null&&Te!==void 0?Te:x,retryCount:(Re=ae.refresh.retryCount)!==null&&Re!==void 0?Re:3,retryIntervalSeconds:(ge=ae.refresh.retryIntervalSeconds)!==null&&ge!==void 0?ge:10,maxCacheAgeSeconds:(_e=ae.refresh.maxCacheAgeSeconds)!==null&&_e!==void 0?_e:M,stopRefreshAfterSeconds:(ke=ae.refresh.stopRefreshAfterSeconds)!==null&&ke!==void 0?ke:R,canRefreshNow:ae.refresh.canRefreshNow},this.clock=gt,this.isInitialRefreshDone=!1;var ye=0,Se=this.state.getState();Se&&Se.fetchServer===this.fetchServer&&Se.lastFetchWhenMs&&(ye=Se.lastFetchWhenMs);var Qe=gt.getMillis(),pe=(Qe-ye)/1e3;if(pe<=this.refresh.maxCacheAgeSeconds){var ze=this.storage.getJson(b);ze&&ze.fetchServer===this.fetchServer&&this.setData(ze.json)}if(this.lastUseMs=Qe,pe>=this.refresh.refreshIntervalSeconds||ye==0)this.trace.onTrace("Will start refresh right now"),this.fetchTask=this.context.setTimeout(this.startRefresh.bind(this),0);else{var Le=Math.round(this.refresh.refreshIntervalSeconds-pe);this.trace.onTrace("Will start refresh in "+Le+" seconds"),this.fetchTask=this.context.setTimeout(this.startRefresh.bind(this),1e3*Le),this.isInitialRefreshDone=!0}var rt=gt.getMillis();this.initialLoadTime=rt-wt}return K.getInstance=function(X,ae){try{if(!(X.fetch&&X.setTimeout&&X.clearTimeout&&X.localStorage))return void console.log("Context needs to provide fetch, setTimeout, clearTimeout, localStorage")}catch(ce){return void console.error("Error checking for context properties "+ce)}if(this.gInstance){if(this.gInstance.fileKey!=ae.fileKey)throw new Error("Existing instance has file key ".concat(this.gInstance.fileKey,", now asking for ").concat(ae.fileKey));return this.gInstance}return this.gInstance=new K(X,ae),this.gInstance},K.prototype.getConfigurationHolder=function(X){var ae,ce=this,Me=this.clock.getMillis();this.lastUseMs=Me;var Fe=(ae=X.analytics)!==null&&ae!==void 0?ae:new q(this.env);this.context.setTimeout(function(){ce.emitMetrics(Fe)});var Te=0,Re=this.state.getState();return Re&&Re.fetchServer===this.fetchServer&&Re.lastFetchWhenMs&&(Te=Re.lastFetchWhenMs),(Me-Te)/1e3<=this.refresh.maxCacheAgeSeconds?new P(Fe,this.properties):new P(Fe,void 0)},K.prototype.getFetchUrl=function(){var X="https://".concat(this.fetchServer,"/").concat(this.fileKey,".json"),ae=new URL(X);return ae.searchParams.set("version","1.0"),ae},K.clearInstance=function(){var X;(X=this.gInstance)===null||X===void 0||X.clearInstanceImpl(),this.gInstance=void 0},K.prototype.clearInstanceImpl=function(){this.context.clearTimeout(this.fetchTask),this.fetchTask=void 0,this.context.clearTimeout(this.retryTask),this.retryTask=void 0},K.prototype.startRefresh=function(){var X=this;this.trace.onTrace("Starting refresh request..."),this.fetchTask=void 0,this.retryTask&&(this.context.clearTimeout(this.retryTask),this.retryTask=void 0);var ae=this.clock.getMillis();return(ae-this.lastUseMs)/1e3>this.refresh.stopRefreshAfterSeconds?(this.trace.onTrace("Actually will not refresh due to refresh timeout"),void(this.fetchTask=this.context.setTimeout(this.startRefresh.bind(this),1e3*this.refresh.refreshIntervalSeconds))):this.isInitialRefreshDone&&!this.refresh.canRefreshNow()?(this.trace.onTrace("Will not refresh due to callback having returned false"),void(this.fetchTask=this.context.setTimeout(this.startRefresh.bind(this),1e3*this.refresh.refreshIntervalSeconds))):void this.fetchData().then(function(ce){X.processResponse(ce,ae)}).catch(function(ce){X.exceptionMetrics(ce),X.trace.onTrace("Fetch error: "+ce),X.refresh.retryCount>0&&X.scheduleRetry(1)}).finally(function(){X.isInitialRefreshDone=!0,X.fetchTask=X.context.setTimeout(X.startRefresh.bind(X),1e3*X.refresh.refreshIntervalSeconds)})},K.prototype.fetchData=function(){var X=this.getFetchUrl(),ae=new Headers,ce=this.state.getState();return ce.fetchServer===this.fetchServer&&(ce.lastFetchWhenFullMs&&this.clock.getMillis()-ce.lastFetchWhenFullMs>1e3*g(24)?this.trace.onTrace("Forcing full refresh"):this.properties&&ce.lastFetchEtagHeader&&ae.set("If-None-Match",ce.lastFetchEtagHeader)),this.incrementMetrics("fetch_attempt_count"),this.fetch.fetchUrl(X,ae)},K.prototype.processResponse=function(X,ae){var ce={fetchServer:this.fetchServer,lastFetchWhenMs:this.clock.getMillis()},Me=X.headers.get("etag");Me&&(ce.lastFetchEtagHeader=Me);try{if(X.status<300&&X.json)if(this.setData(X.json)){this.trace.onTrace("Successfully parsed fetched data"),this.storage.setJson(b,{fetchServer:this.fetchServer,json:X.json});var Fe=this.clock.getMillis();ce.lastFetchWhenFullMs=Fe,this.incrementMetricsWithDuration("success_new_data_count",Fe-ae)}else this.incrementMetrics("fail_invalid_data_count");else{if(X.status!==304){var Te="Unexpected http fetch status: "+X.status;throw this.trace.onTrace(Te),new v(Te)}this.trace.onTrace("Server said no change in data"),Fe=this.clock.getMillis(),this.incrementMetricsWithDuration("success_no_change_count",Fe-ae)}}finally{this.state.setState(ce)}},K.prototype.scheduleRetry=function(X){var ae=this;this.retryTask&&this.context.clearTimeout(this.retryTask);var ce=X*this.refresh.retryIntervalSeconds;this.retryTask=this.context.setTimeout(function(){ae.retryTask=void 0,ae.fetchRetry(X)},1e3*ce)},K.prototype.fetchRetry=function(X){var ae=this;this.trace.onTrace("Starting retry request ".concat(X,"..."));var ce=this.clock.getMillis();this.fetchData().then(function(Me){ae.processResponse(Me,ce)}).catch(function(Me){ae.exceptionMetrics(Me),ae.trace.onTrace("Fetch error: "+Me),ae.refresh.retryCount>X&&ae.scheduleRetry(X+1)})},K.prototype.setData=function(X){if(!X)return!1;if(X.version!=="1.0")return this.trace.onTrace("Data version is not 1.0, not applying"),!1;var ae=X.properties;if(!ae||!Array.isArray(ae))return this.trace.onTrace("Data properties is not an array, not applying"),!1;for(var ce=new Map,Me=0,Fe=ae;Me<Fe.length;Me++){var Te=Fe[Me];if(Te.name&&Te.type&&this.isValidValueType(Te.type)){if(Te.value_string&&typeof Te.value_string!="string"){this.trace.onTrace("Invalid type of value.value_string "+typeof Te.value_string);continue}if(Te.value_number&&typeof Te.value_number!="number"){this.trace.onTrace("Invalid type of value.value_number "+typeof Te.value_number);continue}if(Te.value_boolean&&typeof Te.value_boolean!="boolean"){this.trace.onTrace("Invalid type of value.value_boolean "+typeof Te.value_boolean);continue}if(Te.value_json&&typeof Te.value_json!="string"){this.trace.onTrace("Invalid type of value.value_json "+typeof Te.value_json);continue}if(Te.value_analytics&&typeof Te.value_analytics!="string"){this.trace.onTrace("Invalid type of item.value_analytics "+typeof Te.value_analytics);continue}var Re=new G(Te.name,this.parseValueType(Te.type),Te.value_string,Te.value_number,Te.value_boolean,Te.value_json,Te.value_analytics,Te.encoding);ce.set(Re.name,Re)}}return ce.size!=0&&(this.properties=ce,!0)},K.prototype.isValidValueType=function(X){return X==="string"||X==="number"||X==="boolean"||X=="json"},K.prototype.parseValueType=function(X){switch(X){case"string":return U.STRING;case"number":return U.NUMBER;case"boolean":return U.BOOLEAN;case"json":return U.JSON;default:throw new Error("Unsupported value type ".concat(X))}},K.prototype.emitMetrics=function(X){var ae,ce,Me,Fe,Te,Re,ge,_e,ke=(ae=this.storage.getJson(S))!==null&&ae!==void 0?ae:{},gt={initial_load_time:this.initialLoadTime,fetch_attempt_count:(ce=ke.fetch_attempt_count)!==null&&ce!==void 0?ce:0,fetch_duration_average:(Me=ke.fetch_duration_average)!==null&&Me!==void 0?Me:0,success_no_change_count:(Fe=ke.success_no_change_count)!==null&&Fe!==void 0?Fe:0,success_new_data_count:(Te=ke.success_new_data_count)!==null&&Te!==void 0?Te:0,fail_exception_count:(Re=ke.fail_exception_count)!==null&&Re!==void 0?Re:0,fail_http_error_count:(ge=ke.fail_http_error_count)!==null&&ge!==void 0?ge:0,fail_invalid_data_count:(_e=ke.fail_invalid_data_count)!==null&&_e!==void 0?_e:0};X.onMetrics(gt),ke.fetch_attempt_count=0,ke.success_no_change_count=0,ke.success_new_data_count=0,ke.fail_exception_count=0,ke.fail_http_error_count=0,ke.fail_invalid_data_count=0,this.storage.setJson(S,ke)},K.prototype.exceptionMetrics=function(X){X instanceof v||X.message.startsWith("http error")?this.incrementMetrics("fail_http_error_count"):this.incrementMetrics("fail_exception_count")},K.prototype.incrementMetrics=function(X){var ae,ce,Me=(ae=this.storage.getJson(S))!==null&&ae!==void 0?ae:{};Me[X]=((ce=Me[X])!==null&&ce!==void 0?ce:0)+1,this.storage.setJson(S,Me)},K.prototype.incrementMetricsWithDuration=function(X,ae){var ce,Me,Fe=(ce=this.storage.getJson(S))!==null&&ce!==void 0?ce:{};Fe[X]=((Me=Fe[X])!==null&&Me!==void 0?Me:0)+1,ae>0&&(Fe.fetch_duration_average!==void 0?Fe.fetch_duration_average=.9*Fe.fetch_duration_average+.1*ae|0:Fe.fetch_duration_average=ae),this.storage.setJson(S,Fe)},K}();h.ConfigurationManager=k;var P=function(){function K(X,ae){this.analytics=X,this.properties=ae}return K.prototype.getSize=function(){return this.properties?this.properties.size:-1},K.prototype.getStringValue=function(X){var ae,ce;if(this.properties){var Me=this.properties.get(X);if(Me){if(Me.type===U.STRING){var Fe=(ae=Me.valueString)!==null&&ae!==void 0?ae:"";return this.analytics.onValue(X,(ce=Me.valueAnalytics)!==null&&ce!==void 0?ce:Fe),Fe}this.analytics.onError(X,"Type is not string")}}else this.analytics.onTrace(X,"Configuration is not available")},K.prototype.getNumberValue=function(X){var ae,ce;if(this.properties){var Me=this.properties.get(X);if(Me){if(Me.type===U.NUMBER){var Fe=(ae=Me.valueNumber)!==null&&ae!==void 0?ae:0;return this.analytics.onValue(X,(ce=Me.valueAnalytics)!==null&&ce!==void 0?ce:Fe.toString()),Fe}this.analytics.onError(X,"Type is not number")}}else this.analytics.onTrace(X,"Configuration is not available")},K.prototype.getBooleanValue=function(X){var ae,ce;if(this.properties){var Me=this.properties.get(X);if(Me){if(Me.type===U.BOOLEAN){var Fe=(ae=Me.valueBoolean)!==null&&ae!==void 0&&ae;return this.analytics.onValue(X,(ce=Me.valueAnalytics)!==null&&ce!==void 0?ce:Fe.toString()),Fe}this.analytics.onError(X,"Type is not boolean")}}else this.analytics.onTrace(X,"Configuration is not available")},K.prototype.getJsonValue=function(X){var ae,ce;if(this.properties){var Me=this.properties.get(X);if(Me){if(Me.type===U.JSON){var Fe=Me.valueJson;if(!Fe)return this.analytics.onValue(X,(ae=Me.valueAnalytics)!==null&&ae!==void 0?ae:""),null;try{var Te=JSON.parse(Fe);return this.analytics.onValue(X,(ce=Me.valueAnalytics)!==null&&ce!==void 0?ce:Fe),Te}catch{return void this.analytics.onError(X,"Json parse error")}}this.analytics.onError(X,"Type is not json")}}else this.analytics.onTrace(X,"Configuration is not available")},K}();h.ConfigurationHolder=P;var U,V=function(){function K(X){this.context=X}return K.prototype.fetchUrl=function(X,ae){var ce=this;return new Promise(function(Me,Fe){ce.context.fetch(X,{headers:ae,cache:"no-store"}).then(function(Te){if(Te.status>=400)Fe(new v("http error ".concat(Te.status,", ").concat(Te.statusText)));else{var Re={status:Te.status,headers:Te.headers};Te.json().then(function(ge){Re.json=ge}).catch(function(){}).finally(function(){Me(Re)})}}).catch(function(Te){Fe(Te)})})},K}(),$=function(){function K(X){this.env=X}return K.prototype.onTrace=function(X){this.env!=f.PROD&&console.log("Configuration: "+X)},K}(),q=function(){function K(X){this.env=X}return K.prototype.onMetrics=function(X){this.env!=f.PROD&&console.log("Metrics",X)},K.prototype.onValue=function(X,ae){this.env!=f.PROD&&console.log("Configuration for ".concat(X,": value = ").concat(ae))},K.prototype.onError=function(X,ae){this.env!=f.PROD&&console.error("Configuration for ".concat(X,": error = ").concat(ae))},K.prototype.onTrace=function(X,ae){this.env!=f.PROD&&console.log("Configuration for ".concat(X,": trace = ").concat(ae))},K}(),Y=function(){function K(X,ae){this.prefix=X,this.storage=ae}return K.prototype.getJson=function(X){var ae=this.prefix+"_"+X;try{var ce=this.storage.getItem(ae);if(ce)return JSON.parse(ce)}catch(Me){console.error("Error getting local storage key ".concat(ae)+Me)}return null},K.prototype.setJson=function(X,ae){var ce=this.prefix+"_"+X;try{this.storage.setItem(ce,JSON.stringify(ae))}catch(Me){console.error("Error setting local storage key ".concat(ce,": ")+Me)}},K}(),te=function(){function K(){}return K.prototype.getMillis=function(){return Date.now()},K}();(function(K){K[K.STRING=0]="STRING",K[K.NUMBER=1]="NUMBER",K[K.BOOLEAN=2]="BOOLEAN",K[K.JSON=3]="JSON"})(U||(U={}));var G=function(K,X,ae,ce,Me,Fe,Te,Re){switch(this.name=K,this.type=X,this.valueString=ae,this.valueNumber=ce,this.valueBoolean=Me,this.valueJson=Fe,this.valueAnalytics=Te,this.type){case U.STRING:Re===I&&ae&&(this.valueString=atob(ae));break;case U.JSON:Re===I&&Fe&&(this.valueJson=atob(Fe))}},J=function(){function K(X,ae){var ce;this.storage=X,this.key=ae,this.state=(ce=X.getJson(ae))!==null&&ce!==void 0?ce:{}}return K.prototype.getState=function(){return this.state},K.prototype.setState=function(X){Object.assign(this.state,X),this.storage.setJson(this.key,this.state)},K}()},456:function(u,h,d){var f=this&&this.__createBinding||(Object.create?function(g,_,v,b){b===void 0&&(b=v);var S=Object.getOwnPropertyDescriptor(_,v);S&&!("get"in S?!_.__esModule:S.writable||S.configurable)||(S={enumerable:!0,get:function(){return _[v]}}),Object.defineProperty(g,b,S)}:function(g,_,v,b){b===void 0&&(b=v),g[b]=_[v]}),p=this&&this.__exportStar||function(g,_){for(var v in g)v==="default"||Object.prototype.hasOwnProperty.call(_,v)||f(_,g,v)};Object.defineProperty(h,"__esModule",{value:!0}),p(d(903),h)},903:function(u,h,d){var f=this&&this.__spreadArray||function(_,v,b){if(b||arguments.length===2)for(var S,x=0,M=v.length;x<M;x++)!S&&x in v||(S||(S=Array.prototype.slice.call(v,0,x)),S[x]=v[x]);return _.concat(S||Array.prototype.slice.call(v))};Object.defineProperty(h,"__esModule",{value:!0}),h.TypedEmitter=void 0;var p=d(228),g=function(){function _(v){var b=v.propagateErrors;this.emitter=new p.EventEmitter,this.propagateErrors=b!=null&&b}return _.prototype.on=function(v,b){b.call=this.wrapCall(v,b),this.emitter.on(v,b)},_.prototype.off=function(v,b){this.emitter.off(v,b)},_.prototype.emit=function(v){for(var b,S=[],x=1;x<arguments.length;x++)S[x-1]=arguments[x];(b=this.emitter).emit.apply(b,f([v],S,!1))},_.prototype.removeAllListeners=function(){this.emitter.removeAllListeners()},_.prototype.wrapCall=function(v,b){var S=this;return function(x){for(var M=[],R=1;R<arguments.length;R++)M[R-1]=arguments[R];if(S.propagateErrors)b.apply(x,M);else try{b.apply(x,M)}catch(P){var I="Error in callback for ".concat(v),k=b.name;return k&&(I+=" for function ".concat(k)),void console.error(I,P)}}},_}();h.TypedEmitter=g},987:function(u,h,d){var f,p=this&&this.__extends||(f=function(M,R){return f=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(I,k){I.__proto__=k}||function(I,k){for(var P in k)Object.prototype.hasOwnProperty.call(k,P)&&(I[P]=k[P])},f(M,R)},function(M,R){if(typeof R!="function"&&R!==null)throw new TypeError("Class extends value "+String(R)+" is not a constructor or null");function I(){this.constructor=M}f(M,R),M.prototype=R===null?Object.create(R):(I.prototype=R.prototype,new I)}),g=this&&this.__createBinding||(Object.create?function(M,R,I,k){k===void 0&&(k=I);var P=Object.getOwnPropertyDescriptor(R,I);P&&!("get"in P?!R.__esModule:P.writable||P.configurable)||(P={enumerable:!0,get:function(){return R[I]}}),Object.defineProperty(M,k,P)}:function(M,R,I,k){k===void 0&&(k=I),M[k]=R[I]}),_=this&&this.__setModuleDefault||(Object.create?function(M,R){Object.defineProperty(M,"default",{enumerable:!0,value:R})}:function(M,R){M.default=R}),v=this&&this.__importStar||function(M){if(M&&M.__esModule)return M;var R={};if(M!=null)for(var I in M)I!=="default"&&Object.prototype.hasOwnProperty.call(M,I)&&g(R,M,I);return _(R,M),R};Object.defineProperty(h,"__esModule",{value:!0}),h.createFsm=h.FsmWildcardState=h.RejectedTransitionError=h.InvalidStateTransitionError=void 0;var b=v(d(293)),S=function(M){function R(I,k){var P=M.call(this,"Invalid transition from '".concat(k,"' via event '").concat(I,"'"))||this;return P.name="InvalidStateTransitionError",P}return p(R,M),R}(Error);h.InvalidStateTransitionError=S;var x=function(M){function R(I,k,P){var U=M.call(this,"Transition from '".concat(k,"' via event '").concat(I,"' was rejected for: ").concat(P))||this;return U.name="RejectedTransitionError",U}return p(R,M),R}(Error);h.RejectedTransitionError=x,h.FsmWildcardState="*",h.createFsm=function(M){var R,I=M.transitions,k=M.callbacks,P=M.initialState,U=function(V){var $,q=($=I[V])===null||$===void 0?void 0:$.from;return!!q&&(typeof q=="string"?q===h.FsmWildcardState:q.includes(P))};return{canTransition:U,transition:function(V,$){var q,Y,te,G,J,K;if(!U(V))return b.err(new S(String(P),String(V)));var X=I[V];return X.shouldTransition===void 0||X.shouldTransition(P)?((Y=(q=k==null?void 0:k[P])===null||q===void 0?void 0:q.onExiting)===null||Y===void 0||Y.call(q),(te=k==null?void 0:k.onStateExiting)===null||te===void 0||te.call(k,P),R=P,P=X.to,(J=(G=k==null?void 0:k[P])===null||G===void 0?void 0:G.onChanged)===null||J===void 0||J.call(G,R,$),(K=k==null?void 0:k.onStateChanged)===null||K===void 0||K.call(k,R,P,$),b.ok(P)):b.err(new x(String(P),String(V),"shouldTransition returned false"))},previousState:function(){return R},currentState:function(){return P}}}},156:function(u,h,d){var f=this&&this.__createBinding||(Object.create?function(g,_,v,b){b===void 0&&(b=v);var S=Object.getOwnPropertyDescriptor(_,v);S&&!("get"in S?!_.__esModule:S.writable||S.configurable)||(S={enumerable:!0,get:function(){return _[v]}}),Object.defineProperty(g,b,S)}:function(g,_,v,b){b===void 0&&(b=v),g[b]=_[v]}),p=this&&this.__exportStar||function(g,_){for(var v in g)v==="default"||Object.prototype.hasOwnProperty.call(_,v)||f(_,g,v)};Object.defineProperty(h,"__esModule",{value:!0}),h.VERSION=void 0,h.VERSION="0.2.0",p(d(815),h),p(d(456),h),p(d(987),h),p(d(293),h)},293:(u,h)=>{Object.defineProperty(h,"__esModule",{value:!0}),h.getErr=h.getOk_or=h.getOk=h.isNotOk=h.isOk=h.err=h.ok=void 0,h.ok=function(d){return{ok:!0,value:d}},h.err=function(d){return{ok:!1,error:d}},h.isOk=function(d){return d.ok===!0},h.isNotOk=function(d){return!(0,h.isOk)(d)},h.getOk=function(d){return d.ok===!0?d.value:void 0},h.getOk_or=function(d,f){return d.ok===!0?d.value:f},h.getErr=function(d){return d.ok===!0?void 0:d.error}}},l={};return function u(h){var d=l[h];if(d!==void 0)return d.exports;var f=l[h]={exports:{}};return c[h].call(f.exports,f,f.exports,u),f.exports}(156)})(),a.exports=o()},1989:(a,o,c)=>{var l=c(1789),u=c(401),h=c(7667),d=c(1327),f=c(1866);function p(g){var _=-1,v=g==null?0:g.length;for(this.clear();++_<v;){var b=g[_];this.set(b[0],b[1])}}p.prototype.clear=l,p.prototype.delete=u,p.prototype.get=h,p.prototype.has=d,p.prototype.set=f,a.exports=p},8407:(a,o,c)=>{var l=c(7040),u=c(4125),h=c(2117),d=c(7518),f=c(4705);function p(g){var _=-1,v=g==null?0:g.length;for(this.clear();++_<v;){var b=g[_];this.set(b[0],b[1])}}p.prototype.clear=l,p.prototype.delete=u,p.prototype.get=h,p.prototype.has=d,p.prototype.set=f,a.exports=p},7071:(a,o,c)=>{var l=c(852)(c(5639),"Map");a.exports=l},3369:(a,o,c)=>{var l=c(4785),u=c(1285),h=c(6e3),d=c(9916),f=c(5265);function p(g){var _=-1,v=g==null?0:g.length;for(this.clear();++_<v;){var b=g[_];this.set(b[0],b[1])}}p.prototype.clear=l,p.prototype.delete=u,p.prototype.get=h,p.prototype.has=d,p.prototype.set=f,a.exports=p},6384:(a,o,c)=>{var l=c(8407),u=c(7465),h=c(3779),d=c(7599),f=c(4758),p=c(4309);function g(_){var v=this.__data__=new l(_);this.size=v.size}g.prototype.clear=u,g.prototype.delete=h,g.prototype.get=d,g.prototype.has=f,g.prototype.set=p,a.exports=g},2705:(a,o,c)=>{var l=c(5639).Symbol;a.exports=l},1149:(a,o,c)=>{var l=c(5639).Uint8Array;a.exports=l},6874:a=>{a.exports=function(o,c,l){switch(l.length){case 0:return o.call(c);case 1:return o.call(c,l[0]);case 2:return o.call(c,l[0],l[1]);case 3:return o.call(c,l[0],l[1],l[2])}return o.apply(c,l)}},4636:(a,o,c)=>{var l=c(2545),u=c(5694),h=c(1469),d=c(4144),f=c(5776),p=c(6719),g=Object.prototype.hasOwnProperty;a.exports=function(_,v){var b=h(_),S=!b&&u(_),x=!b&&!S&&d(_),M=!b&&!S&&!x&&p(_),R=b||S||x||M,I=R?l(_.length,String):[],k=I.length;for(var P in _)!v&&!g.call(_,P)||R&&(P=="length"||x&&(P=="offset"||P=="parent")||M&&(P=="buffer"||P=="byteLength"||P=="byteOffset")||f(P,k))||I.push(P);return I}},6556:(a,o,c)=>{var l=c(9465),u=c(7813);a.exports=function(h,d,f){(f!==void 0&&!u(h[d],f)||f===void 0&&!(d in h))&&l(h,d,f)}},4865:(a,o,c)=>{var l=c(9465),u=c(7813),h=Object.prototype.hasOwnProperty;a.exports=function(d,f,p){var g=d[f];h.call(d,f)&&u(g,p)&&(p!==void 0||f in d)||l(d,f,p)}},8470:(a,o,c)=>{var l=c(7813);a.exports=function(u,h){for(var d=u.length;d--;)if(l(u[d][0],h))return d;return-1}},9465:(a,o,c)=>{var l=c(8777);a.exports=function(u,h,d){h=="__proto__"&&l?l(u,h,{configurable:!0,enumerable:!0,value:d,writable:!0}):u[h]=d}},3118:(a,o,c)=>{var l=c(3218),u=Object.create,h=function(){function d(){}return function(f){if(!l(f))return{};if(u)return u(f);d.prototype=f;var p=new d;return d.prototype=void 0,p}}();a.exports=h},8483:(a,o,c)=>{var l=c(5063)();a.exports=l},4239:(a,o,c)=>{var l=c(2705),u=c(9607),h=c(2333),d="[object Null]",f="[object Undefined]",p=l?l.toStringTag:void 0;a.exports=function(g){return g==null?g===void 0?f:d:p&&p in Object(g)?u(g):h(g)}},9454:(a,o,c)=>{var l=c(4239),u=c(7005),h="[object Arguments]";a.exports=function(d){return u(d)&&l(d)==h}},8458:(a,o,c)=>{var l=c(3560),u=c(5346),h=c(3218),d=c(346),f=/^\[object .+?Constructor\]$/,p=Function.prototype,g=Object.prototype,_=p.toString,v=g.hasOwnProperty,b=RegExp("^"+_.call(v).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");a.exports=function(S){return!(!h(S)||u(S))&&(l(S)?b:f).test(d(S))}},8749:(a,o,c)=>{var l=c(4239),u=c(1780),h=c(7005),d={};d["[object Float32Array]"]=d["[object Float64Array]"]=d["[object Int8Array]"]=d["[object Int16Array]"]=d["[object Int32Array]"]=d["[object Uint8Array]"]=d["[object Uint8ClampedArray]"]=d["[object Uint16Array]"]=d["[object Uint32Array]"]=!0,d["[object Arguments]"]=d["[object Array]"]=d["[object ArrayBuffer]"]=d["[object Boolean]"]=d["[object DataView]"]=d["[object Date]"]=d["[object Error]"]=d["[object Function]"]=d["[object Map]"]=d["[object Number]"]=d["[object Object]"]=d["[object RegExp]"]=d["[object Set]"]=d["[object String]"]=d["[object WeakMap]"]=!1,a.exports=function(f){return h(f)&&u(f.length)&&!!d[l(f)]}},313:(a,o,c)=>{var l=c(3218),u=c(5726),h=c(3498),d=Object.prototype.hasOwnProperty;a.exports=function(f){if(!l(f))return h(f);var p=u(f),g=[];for(var _ in f)(_!="constructor"||!p&&d.call(f,_))&&g.push(_);return g}},2980:(a,o,c)=>{var l=c(6384),u=c(6556),h=c(8483),d=c(9783),f=c(3218),p=c(1704),g=c(6390);a.exports=function _(v,b,S,x,M){v!==b&&h(b,function(R,I){if(M||(M=new l),f(R))d(v,b,I,S,_,x,M);else{var k=x?x(g(v,I),R,I+"",v,b,M):void 0;k===void 0&&(k=R),u(v,I,k)}},p)}},9783:(a,o,c)=>{var l=c(6556),u=c(4626),h=c(7133),d=c(278),f=c(8517),p=c(5694),g=c(1469),_=c(9246),v=c(4144),b=c(3560),S=c(3218),x=c(8630),M=c(6719),R=c(6390),I=c(9881);a.exports=function(k,P,U,V,$,q,Y){var te=R(k,U),G=R(P,U),J=Y.get(G);if(J)l(k,U,J);else{var K=q?q(te,G,U+"",k,P,Y):void 0,X=K===void 0;if(X){var ae=g(G),ce=!ae&&v(G),Me=!ae&&!ce&&M(G);K=G,ae||ce||Me?g(te)?K=te:_(te)?K=d(te):ce?(X=!1,K=u(G,!0)):Me?(X=!1,K=h(G,!0)):K=[]:x(G)||p(G)?(K=te,p(te)?K=I(te):S(te)&&!b(te)||(K=f(G))):X=!1}X&&(Y.set(G,K),$(K,G,V,q,Y),Y.delete(G)),l(k,U,K)}}},5976:(a,o,c)=>{var l=c(6557),u=c(5357),h=c(61);a.exports=function(d,f){return h(u(d,f,l),d+"")}},6560:(a,o,c)=>{var l=c(5703),u=c(8777),h=c(6557),d=u?function(f,p){return u(f,"toString",{configurable:!0,enumerable:!1,value:l(p),writable:!0})}:h;a.exports=d},2545:a=>{a.exports=function(o,c){for(var l=-1,u=Array(o);++l<o;)u[l]=c(l);return u}},1717:a=>{a.exports=function(o){return function(c){return o(c)}}},4318:(a,o,c)=>{var l=c(1149);a.exports=function(u){var h=new u.constructor(u.byteLength);return new l(h).set(new l(u)),h}},4626:(a,o,c)=>{a=c.nmd(a);var l=c(5639),u=o&&!o.nodeType&&o,h=u&&a&&!a.nodeType&&a,d=h&&h.exports===u?l.Buffer:void 0,f=d?d.allocUnsafe:void 0;a.exports=function(p,g){if(g)return p.slice();var _=p.length,v=f?f(_):new p.constructor(_);return p.copy(v),v}},7133:(a,o,c)=>{var l=c(4318);a.exports=function(u,h){var d=h?l(u.buffer):u.buffer;return new u.constructor(d,u.byteOffset,u.length)}},278:a=>{a.exports=function(o,c){var l=-1,u=o.length;for(c||(c=Array(u));++l<u;)c[l]=o[l];return c}},8363:(a,o,c)=>{var l=c(4865),u=c(9465);a.exports=function(h,d,f,p){var g=!f;f||(f={});for(var _=-1,v=d.length;++_<v;){var b=d[_],S=p?p(f[b],h[b],b,f,h):void 0;S===void 0&&(S=h[b]),g?u(f,b,S):l(f,b,S)}return f}},4429:(a,o,c)=>{var l=c(5639)["__core-js_shared__"];a.exports=l},1463:(a,o,c)=>{var l=c(5976),u=c(6612);a.exports=function(h){return l(function(d,f){var p=-1,g=f.length,_=g>1?f[g-1]:void 0,v=g>2?f[2]:void 0;for(_=h.length>3&&typeof _=="function"?(g--,_):void 0,v&&u(f[0],f[1],v)&&(_=g<3?void 0:_,g=1),d=Object(d);++p<g;){var b=f[p];b&&h(d,b,p,_)}return d})}},5063:a=>{a.exports=function(o){return function(c,l,u){for(var h=-1,d=Object(c),f=u(c),p=f.length;p--;){var g=f[o?p:++h];if(l(d[g],g,d)===!1)break}return c}}},8777:(a,o,c)=>{var l=c(852),u=function(){try{var h=l(Object,"defineProperty");return h({},"",{}),h}catch{}}();a.exports=u},1957:(a,o,c)=>{var l=typeof c.g=="object"&&c.g&&c.g.Object===Object&&c.g;a.exports=l},5050:(a,o,c)=>{var l=c(7019);a.exports=function(u,h){var d=u.__data__;return l(h)?d[typeof h=="string"?"string":"hash"]:d.map}},852:(a,o,c)=>{var l=c(8458),u=c(7801);a.exports=function(h,d){var f=u(h,d);return l(f)?f:void 0}},5924:(a,o,c)=>{var l=c(5569)(Object.getPrototypeOf,Object);a.exports=l},9607:(a,o,c)=>{var l=c(2705),u=Object.prototype,h=u.hasOwnProperty,d=u.toString,f=l?l.toStringTag:void 0;a.exports=function(p){var g=h.call(p,f),_=p[f];try{p[f]=void 0;var v=!0}catch{}var b=d.call(p);return v&&(g?p[f]=_:delete p[f]),b}},7801:a=>{a.exports=function(o,c){return o==null?void 0:o[c]}},1789:(a,o,c)=>{var l=c(4536);a.exports=function(){this.__data__=l?l(null):{},this.size=0}},401:a=>{a.exports=function(o){var c=this.has(o)&&delete this.__data__[o];return this.size-=c?1:0,c}},7667:(a,o,c)=>{var l=c(4536),u="__lodash_hash_undefined__",h=Object.prototype.hasOwnProperty;a.exports=function(d){var f=this.__data__;if(l){var p=f[d];return p===u?void 0:p}return h.call(f,d)?f[d]:void 0}},1327:(a,o,c)=>{var l=c(4536),u=Object.prototype.hasOwnProperty;a.exports=function(h){var d=this.__data__;return l?d[h]!==void 0:u.call(d,h)}},1866:(a,o,c)=>{var l=c(4536),u="__lodash_hash_undefined__";a.exports=function(h,d){var f=this.__data__;return this.size+=this.has(h)?0:1,f[h]=l&&d===void 0?u:d,this}},8517:(a,o,c)=>{var l=c(3118),u=c(5924),h=c(5726);a.exports=function(d){return typeof d.constructor!="function"||h(d)?{}:l(u(d))}},5776:a=>{var o=9007199254740991,c=/^(?:0|[1-9]\d*)$/;a.exports=function(l,u){var h=typeof l;return!!(u=u??o)&&(h=="number"||h!="symbol"&&c.test(l))&&l>-1&&l%1==0&&l<u}},6612:(a,o,c)=>{var l=c(7813),u=c(8612),h=c(5776),d=c(3218);a.exports=function(f,p,g){if(!d(g))return!1;var _=typeof p;return!!(_=="number"?u(g)&&h(p,g.length):_=="string"&&p in g)&&l(g[p],f)}},7019:a=>{a.exports=function(o){var c=typeof o;return c=="string"||c=="number"||c=="symbol"||c=="boolean"?o!=="__proto__":o===null}},5346:(a,o,c)=>{var l,u=c(4429),h=(l=/[^.]+$/.exec(u&&u.keys&&u.keys.IE_PROTO||""))?"Symbol(src)_1."+l:"";a.exports=function(d){return!!h&&h in d}},5726:a=>{var o=Object.prototype;a.exports=function(c){var l=c&&c.constructor;return c===(typeof l=="function"&&l.prototype||o)}},7040:a=>{a.exports=function(){this.__data__=[],this.size=0}},4125:(a,o,c)=>{var l=c(8470),u=Array.prototype.splice;a.exports=function(h){var d=this.__data__,f=l(d,h);return!(f<0)&&(f==d.length-1?d.pop():u.call(d,f,1),--this.size,!0)}},2117:(a,o,c)=>{var l=c(8470);a.exports=function(u){var h=this.__data__,d=l(h,u);return d<0?void 0:h[d][1]}},7518:(a,o,c)=>{var l=c(8470);a.exports=function(u){return l(this.__data__,u)>-1}},4705:(a,o,c)=>{var l=c(8470);a.exports=function(u,h){var d=this.__data__,f=l(d,u);return f<0?(++this.size,d.push([u,h])):d[f][1]=h,this}},4785:(a,o,c)=>{var l=c(1989),u=c(8407),h=c(7071);a.exports=function(){this.size=0,this.__data__={hash:new l,map:new(h||u),string:new l}}},1285:(a,o,c)=>{var l=c(5050);a.exports=function(u){var h=l(this,u).delete(u);return this.size-=h?1:0,h}},6e3:(a,o,c)=>{var l=c(5050);a.exports=function(u){return l(this,u).get(u)}},9916:(a,o,c)=>{var l=c(5050);a.exports=function(u){return l(this,u).has(u)}},5265:(a,o,c)=>{var l=c(5050);a.exports=function(u,h){var d=l(this,u),f=d.size;return d.set(u,h),this.size+=d.size==f?0:1,this}},4536:(a,o,c)=>{var l=c(852)(Object,"create");a.exports=l},3498:a=>{a.exports=function(o){var c=[];if(o!=null)for(var l in Object(o))c.push(l);return c}},1167:(a,o,c)=>{a=c.nmd(a);var l=c(1957),u=o&&!o.nodeType&&o,h=u&&a&&!a.nodeType&&a,d=h&&h.exports===u&&l.process,f=function(){try{var p=h&&h.require&&h.require("util").types;return p||d&&d.binding&&d.binding("util")}catch{}}();a.exports=f},2333:a=>{var o=Object.prototype.toString;a.exports=function(c){return o.call(c)}},5569:a=>{a.exports=function(o,c){return function(l){return o(c(l))}}},5357:(a,o,c)=>{var l=c(6874),u=Math.max;a.exports=function(h,d,f){return d=u(d===void 0?h.length-1:d,0),function(){for(var p=arguments,g=-1,_=u(p.length-d,0),v=Array(_);++g<_;)v[g]=p[d+g];g=-1;for(var b=Array(d+1);++g<d;)b[g]=p[g];return b[d]=f(v),l(h,this,b)}}},5639:(a,o,c)=>{var l=c(1957),u=typeof self=="object"&&self&&self.Object===Object&&self,h=l||u||Function("return this")();a.exports=h},6390:a=>{a.exports=function(o,c){if((c!=="constructor"||typeof o[c]!="function")&&c!="__proto__")return o[c]}},61:(a,o,c)=>{var l=c(6560),u=c(1275)(l);a.exports=u},1275:a=>{var o=800,c=16,l=Date.now;a.exports=function(u){var h=0,d=0;return function(){var f=l(),p=c-(f-d);if(d=f,p>0){if(++h>=o)return arguments[0]}else h=0;return u.apply(void 0,arguments)}}},7465:(a,o,c)=>{var l=c(8407);a.exports=function(){this.__data__=new l,this.size=0}},3779:a=>{a.exports=function(o){var c=this.__data__,l=c.delete(o);return this.size=c.size,l}},7599:a=>{a.exports=function(o){return this.__data__.get(o)}},4758:a=>{a.exports=function(o){return this.__data__.has(o)}},4309:(a,o,c)=>{var l=c(8407),u=c(7071),h=c(3369),d=200;a.exports=function(f,p){var g=this.__data__;if(g instanceof l){var _=g.__data__;if(!u||_.length<d-1)return _.push([f,p]),this.size=++g.size,this;g=this.__data__=new h(_)}return g.set(f,p),this.size=g.size,this}},346:a=>{var o=Function.prototype.toString;a.exports=function(c){if(c!=null){try{return o.call(c)}catch{}try{return c+""}catch{}}return""}},5703:a=>{a.exports=function(o){return function(){return o}}},7813:a=>{a.exports=function(o,c){return o===c||o!=o&&c!=c}},6557:a=>{a.exports=function(o){return o}},5694:(a,o,c)=>{var l=c(9454),u=c(7005),h=Object.prototype,d=h.hasOwnProperty,f=h.propertyIsEnumerable,p=l(function(){return arguments}())?l:function(g){return u(g)&&d.call(g,"callee")&&!f.call(g,"callee")};a.exports=p},1469:a=>{var o=Array.isArray;a.exports=o},8612:(a,o,c)=>{var l=c(3560),u=c(1780);a.exports=function(h){return h!=null&&u(h.length)&&!l(h)}},9246:(a,o,c)=>{var l=c(8612),u=c(7005);a.exports=function(h){return u(h)&&l(h)}},4144:(a,o,c)=>{a=c.nmd(a);var l=c(5639),u=c(5062),h=o&&!o.nodeType&&o,d=h&&a&&!a.nodeType&&a,f=d&&d.exports===h?l.Buffer:void 0,p=(f?f.isBuffer:void 0)||u;a.exports=p},3560:(a,o,c)=>{var l=c(4239),u=c(3218),h="[object AsyncFunction]",d="[object Function]",f="[object GeneratorFunction]",p="[object Proxy]";a.exports=function(g){if(!u(g))return!1;var _=l(g);return _==d||_==f||_==h||_==p}},1780:a=>{var o=9007199254740991;a.exports=function(c){return typeof c=="number"&&c>-1&&c%1==0&&c<=o}},3218:a=>{a.exports=function(o){var c=typeof o;return o!=null&&(c=="object"||c=="function")}},7005:a=>{a.exports=function(o){return o!=null&&typeof o=="object"}},8630:(a,o,c)=>{var l=c(4239),u=c(5924),h=c(7005),d="[object Object]",f=Function.prototype,p=Object.prototype,g=f.toString,_=p.hasOwnProperty,v=g.call(Object);a.exports=function(b){if(!h(b)||l(b)!=d)return!1;var S=u(b);if(S===null)return!0;var x=_.call(S,"constructor")&&S.constructor;return typeof x=="function"&&x instanceof x&&g.call(x)==v}},6719:(a,o,c)=>{var l=c(8749),u=c(1717),h=c(1167),d=h&&h.isTypedArray,f=d?u(d):l;a.exports=f},1704:(a,o,c)=>{var l=c(4636),u=c(313),h=c(8612);a.exports=function(d){return h(d)?l(d,!0):u(d)}},6486:function(a,o,c){var l;a=c.nmd(a),(function(){var u,h="Expected a function",d="__lodash_hash_undefined__",f="__lodash_placeholder__",p=16,g=32,_=64,v=128,b=256,S=1/0,x=9007199254740991,M=NaN,R=4294967295,I=[["ary",v],["bind",1],["bindKey",2],["curry",8],["curryRight",p],["flip",512],["partial",g],["partialRight",_],["rearg",b]],k="[object Arguments]",P="[object Array]",U="[object Boolean]",V="[object Date]",$="[object Error]",q="[object Function]",Y="[object GeneratorFunction]",te="[object Map]",G="[object Number]",J="[object Object]",K="[object Promise]",X="[object RegExp]",ae="[object Set]",ce="[object String]",Me="[object Symbol]",Fe="[object WeakMap]",Te="[object ArrayBuffer]",Re="[object DataView]",ge="[object Float32Array]",_e="[object Float64Array]",ke="[object Int8Array]",gt="[object Int16Array]",wt="[object Int32Array]",ye="[object Uint8Array]",Se="[object Uint8ClampedArray]",Qe="[object Uint16Array]",pe="[object Uint32Array]",ze=/\b__p \+= '';/g,Le=/\b(__p \+=) '' \+/g,rt=/(__e\(.*?\)|\b__t\)) \+\n'';/g,dt=/&(?:amp|lt|gt|quot|#39);/g,pt=/[&<>"']/g,bt=RegExp(dt.source),we=RegExp(pt.source),he=/<%-([\s\S]+?)%>/g,$e=/<%([\s\S]+?)%>/g,et=/<%=([\s\S]+?)%>/g,Et=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,ct=/^\w*$/,tn=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Ht=/[\\^$.*+?()[\]{}|]/g,pn=RegExp(Ht.source),le=/^\s+/,z=/\s/,W=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,fe=/\{\n\/\* \[wrapped with (.+)\] \*/,Ne=/,? & /,Be=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,tt=/[()=,{}\[\]\/\s]/,Tt=/\\(\\)?/g,Cn=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,je=/\w*$/,zt=/^[-+]0x[0-9a-f]+$/i,ht=/^0b[01]+$/i,Pt=/^\[object .+?Constructor\]$/,hn=/^0o[0-7]+$/i,on=/^(?:0|[1-9]\d*)$/,Ve=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,at=/($^)/,Mt=/['\n\r\u2028\u2029\\]/g,Ot="\\ud800-\\udfff",Zn="\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff",or="\\u2700-\\u27bf",wi="a-z\\xdf-\\xf6\\xf8-\\xff",ai="A-Z\\xc0-\\xd6\\xd8-\\xde",xn="\\ufe0e\\ufe0f",sn="\\xac\\xb1\\xd7\\xf7\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf\\u2000-\\u206f \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",zn="[']",Un="["+Ot+"]",pi="["+sn+"]",dr="["+Zn+"]",ni="\\d+",$a="["+or+"]",Nu="["+wi+"]",Ef="[^"+Ot+sn+ni+or+wi+ai+"]",Fp="\\ud83c[\\udffb-\\udfff]",I0="[^"+Ot+"]",Sf="(?:\\ud83c[\\udde6-\\uddff]){2}",Tf="[\\ud800-\\udbff][\\udc00-\\udfff]",Iu="["+ai+"]",Ee="\\u200d",We="(?:"+Nu+"|"+Ef+")",vt="(?:"+Iu+"|"+Ef+")",_t="(?:['](?:d|ll|m|re|s|t|ve))?",Ze="(?:['](?:D|LL|M|RE|S|T|VE))?",Vt="(?:"+dr+"|"+Fp+")?",rn="["+xn+"]?",_n=rn+Vt+("(?:"+Ee+"(?:"+[I0,Sf,Tf].join("|")+")"+rn+Vt+")*"),wn="(?:"+[$a,Sf,Tf].join("|")+")"+_n,ci="(?:"+[I0+dr+"?",dr,Sf,Tf,Un].join("|")+")",li=RegExp(zn,"g"),Nn=RegExp(dr,"g"),yi=RegExp(Fp+"(?="+Fp+")|"+ci+_n,"g"),cr=RegExp([Iu+"?"+Nu+"+"+_t+"(?="+[pi,Iu,"$"].join("|")+")",vt+"+"+Ze+"(?="+[pi,Iu+We,"$"].join("|")+")",Iu+"?"+We+"+"+_t,Iu+"+"+Ze,"\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])","\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",ni,wn].join("|"),"g"),Ds=RegExp("["+Ee+Ot+Zn+xn+"]"),xs=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,Zi=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],Jn=-1,Ci={};Ci[ge]=Ci[_e]=Ci[ke]=Ci[gt]=Ci[wt]=Ci[ye]=Ci[Se]=Ci[Qe]=Ci[pe]=!0,Ci[k]=Ci[P]=Ci[Te]=Ci[U]=Ci[Re]=Ci[V]=Ci[$]=Ci[q]=Ci[te]=Ci[G]=Ci[J]=Ci[X]=Ci[ae]=Ci[ce]=Ci[Fe]=!1;var Hn={};Hn[k]=Hn[P]=Hn[Te]=Hn[Re]=Hn[U]=Hn[V]=Hn[ge]=Hn[_e]=Hn[ke]=Hn[gt]=Hn[wt]=Hn[te]=Hn[G]=Hn[J]=Hn[X]=Hn[ae]=Hn[ce]=Hn[Me]=Hn[ye]=Hn[Se]=Hn[Qe]=Hn[pe]=!0,Hn[$]=Hn[q]=Hn[Fe]=!1;var Jo={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},Ql=parseFloat,uo=parseInt,Th=typeof c.g=="object"&&c.g&&c.g.Object===Object&&c.g,ds=typeof self=="object"&&self&&self.Object===Object&&self,Sn=Th||ds||Function("return this")(),ho=o&&!o.nodeType&&o,Ws=ho&&a&&!a.nodeType&&a,Yn=Ws&&Ws.exports===ho,Il=Yn&&Th.process,ma=function(){try{var ft=Ws&&Ws.require&&Ws.require("util").types;return ft||Il&&Il.binding&&Il.binding("util")}catch{}}(),zp=ma&&ma.isArrayBuffer,xd=ma&&ma.isDate,xh=ma&&ma.isMap,k0=ma&&ma.isRegExp,ty=ma&&ma.isSet,P0=ma&&ma.isTypedArray;function Qo(ft,st,Bt){switch(Bt.length){case 0:return ft.call(st);case 1:return ft.call(st,Bt[0]);case 2:return ft.call(st,Bt[0],Bt[1]);case 3:return ft.call(st,Bt[0],Bt[1],Bt[2])}return ft.apply(st,Bt)}function D0(ft,st,Bt,fn){for(var Zt=-1,Hi=ft==null?0:ft.length;++Zt<Hi;){var va=ft[Zt];st(fn,va,Bt(va),ft)}return fn}function ec(ft,st){for(var Bt=-1,fn=ft==null?0:ft.length;++Bt<fn&&st(ft[Bt],Bt,ft)!==!1;);return ft}function fx(ft,st){for(var Bt=ft==null?0:ft.length;Bt--&&st(ft[Bt],Bt,ft)!==!1;);return ft}function WE(ft,st){for(var Bt=-1,fn=ft==null?0:ft.length;++Bt<fn;)if(!st(ft[Bt],Bt,ft))return!1;return!0}function ku(ft,st){for(var Bt=-1,fn=ft==null?0:ft.length,Zt=0,Hi=[];++Bt<fn;){var va=ft[Bt];st(va,Bt,ft)&&(Hi[Zt++]=va)}return Hi}function Vm(ft,st){return!!(ft!=null&&ft.length)&&wf(ft,st,0)>-1}function wd(ft,st,Bt){for(var fn=-1,Zt=ft==null?0:ft.length;++fn<Zt;)if(Bt(st,ft[fn]))return!0;return!1}function Rs(ft,st){for(var Bt=-1,fn=ft==null?0:ft.length,Zt=Array(fn);++Bt<fn;)Zt[Bt]=st(ft[Bt],Bt,ft);return Zt}function wh(ft,st){for(var Bt=-1,fn=st.length,Zt=ft.length;++Bt<fn;)ft[Zt+Bt]=st[Bt];return ft}function ny(ft,st,Bt,fn){var Zt=-1,Hi=ft==null?0:ft.length;for(fn&&Hi&&(Bt=ft[++Zt]);++Zt<Hi;)Bt=st(Bt,ft[Zt],Zt,ft);return Bt}function YE(ft,st,Bt,fn){var Zt=ft==null?0:ft.length;for(fn&&Zt&&(Bt=ft[--Zt]);Zt--;)Bt=st(Bt,ft[Zt],Zt,ft);return Bt}function iy(ft,st){for(var Bt=-1,fn=ft==null?0:ft.length;++Bt<fn;)if(st(ft[Bt],Bt,ft))return!0;return!1}var px=L0("length");function KE(ft,st,Bt){var fn;return Bt(ft,function(Zt,Hi,va){if(st(Zt,Hi,va))return fn=Hi,!1}),fn}function xf(ft,st,Bt,fn){for(var Zt=ft.length,Hi=Bt+(fn?1:-1);fn?Hi--:++Hi<Zt;)if(st(ft[Hi],Hi,ft))return Hi;return-1}function wf(ft,st,Bt){return st==st?function(fn,Zt,Hi){for(var va=Hi-1,Ah=fn.length;++va<Ah;)if(fn[va]===Zt)return va;return-1}(ft,st,Bt):xf(ft,XE,Bt)}function ry(ft,st,Bt,fn){for(var Zt=Bt-1,Hi=ft.length;++Zt<Hi;)if(fn(ft[Zt],st))return Zt;return-1}function XE(ft){return ft!=ft}function ZE(ft,st){var Bt=ft==null?0:ft.length;return Bt?Ch(ft,st)/Bt:M}function L0(ft){return function(st){return st==null?u:st[ft]}}function sy(ft){return function(st){return ft==null?u:ft[st]}}function JE(ft,st,Bt,fn,Zt){return Zt(ft,function(Hi,va,Ah){Bt=fn?(fn=!1,Hi):st(Bt,Hi,va,Ah)}),Bt}function Ch(ft,st){for(var Bt,fn=-1,Zt=ft.length;++fn<Zt;){var Hi=st(ft[fn]);Hi!==u&&(Bt=Bt===u?Hi:Bt+Hi)}return Bt}function Gm(ft,st){for(var Bt=-1,fn=Array(ft);++Bt<ft;)fn[Bt]=st(Bt);return fn}function QE(ft){return ft&&ft.slice(0,B0(ft)+1).replace(le,"")}function Tc(ft){return function(st){return ft(st)}}function Ls(ft,st){return Rs(st,function(Bt){return ft[Bt]})}function Cd(ft,st){return ft.has(st)}function mx(ft,st){for(var Bt=-1,fn=ft.length;++Bt<fn&&wf(st,ft[Bt],0)>-1;);return Bt}function ga(ft,st){for(var Bt=ft.length;Bt--&&wf(st,ft[Bt],0)>-1;);return Bt}var gx=sy({:"A",:"A",:"A",:"A",:"A",:"A",:"a",:"a",:"a",:"a",:"a",:"a",:"C",:"c",:"D",:"d",:"E",:"E",:"E",:"E",:"e",:"e",:"e",:"e",:"I",:"I",:"I",:"I",:"i",:"i",:"i",:"i",:"N",:"n",:"O",:"O",:"O",:"O",:"O",:"O",:"o",:"o",:"o",:"o",:"o",:"o",:"U",:"U",:"U",:"U",:"u",:"u",:"u",:"u",:"Y",:"y",:"y",:"Ae",:"ae",:"Th",:"th",:"ss",:"A",:"A",:"A",:"a",:"a",:"a",:"C",:"C",:"C",:"C",:"c",:"c",:"c",:"c",:"D",:"D",:"d",:"d",:"E",:"E",:"E",:"E",:"E",:"e",:"e",:"e",:"e",:"e",:"G",:"G",:"G",:"G",:"g",:"g",:"g",:"g",:"H",:"H",:"h",:"h",:"I",:"I",:"I",:"I",:"I",:"i",:"i",:"i",:"i",:"i",:"J",:"j",:"K",:"k",:"k",:"L",:"L",:"L",:"L",:"L",:"l",:"l",:"l",:"l",:"l",:"N",:"N",:"N",:"N",:"n",:"n",:"n",:"n",:"O",:"O",:"O",:"o",:"o",:"o",:"R",:"R",:"R",:"r",:"r",:"r",:"S",:"S",:"S",:"S",:"s",:"s",:"s",:"s",:"T",:"T",:"T",:"t",:"t",:"t",:"U",:"U",:"U",:"U",:"U",:"U",:"u",:"u",:"u",:"u",:"u",:"u",:"W",:"w",:"Y",:"y",:"Y",:"Z",:"Z",:"Z",:"z",:"z",:"z",:"IJ",:"ij",:"Oe",:"oe",:"'n",:"s"}),U0=sy({"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"});function vx(ft){return"\\"+Jo[ft]}function Cf(ft){return Ds.test(ft)}function qm(ft){var st=-1,Bt=Array(ft.size);return ft.forEach(function(fn,Zt){Bt[++st]=[Zt,fn]}),Bt}function fo(ft,st){return function(Bt){return ft(st(Bt))}}function xc(ft,st){for(var Bt=-1,fn=ft.length,Zt=0,Hi=[];++Bt<fn;){var va=ft[Bt];va!==st&&va!==f||(ft[Bt]=f,Hi[Zt++]=Bt)}return Hi}function $m(ft){var st=-1,Bt=Array(ft.size);return ft.forEach(function(fn){Bt[++st]=fn}),Bt}function _x(ft){var st=-1,Bt=Array(ft.size);return ft.forEach(function(fn){Bt[++st]=[fn,fn]}),Bt}function Oa(ft){return Cf(ft)?function(st){for(var Bt=yi.lastIndex=0;yi.test(st);)++Bt;return Bt}(ft):px(ft)}function ta(ft){return Cf(ft)?function(st){return st.match(yi)||[]}(ft):function(st){return st.split("")}(ft)}function B0(ft){for(var st=ft.length;st--&&z.test(ft.charAt(st)););return st}var Ad=sy({"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"}),jp=function ft(st){var Bt,fn=(st=st==null?Sn:jp.defaults(Sn.Object(),st,jp.pick(Sn,Zi))).Array,Zt=st.Date,Hi=st.Error,va=st.Function,Ah=st.Math,Ji=st.Object,eu=st.RegExp,Rh=st.String,al=st.TypeError,Wm=fn.prototype,F0=va.prototype,Pu=Ji.prototype,ol=st["__core-js_shared__"],Wa=F0.toString,Mr=Pu.hasOwnProperty,z0=0,ay=(Bt=/[^.]+$/.exec(ol&&ol.keys&&ol.keys.IE_PROTO||""))?"Symbol(src)_1."+Bt:"",Af=Pu.toString,Rf=Wa.call(Ji),oy=Sn._,yx=eu("^"+Wa.call(Mr).replace(Ht,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),tc=Yn?st.Buffer:u,Rd=st.Symbol,Mh=st.Uint8Array,eS=tc?tc.allocUnsafe:u,Ym=fo(Ji.getPrototypeOf,Ji),Km=Ji.create,j0=Pu.propertyIsEnumerable,Mf=Wm.splice,H0=Rd?Rd.isConcatSpreadable:u,Du=Rd?Rd.iterator:u,Vr=Rd?Rd.toStringTag:u,V0=function(){try{var E=Bl(Ji,"defineProperty");return E({},"",{}),E}catch{}}(),dn=st.clearTimeout!==Sn.clearTimeout&&st.clearTimeout,_a=Zt&&Zt.now!==Sn.Date.now&&Zt.now,G0=st.setTimeout!==Sn.setTimeout&&st.setTimeout,Lu=Ah.ceil,cl=Ah.floor,q0=Ji.getOwnPropertySymbols,Hp=tc?tc.isBuffer:u,Na=st.isFinite,tS=Wm.join,wc=fo(Ji.keys,Ji),Ms=Ah.max,na=Ah.min,ki=Zt.now,Cc=st.parseInt,ko=Ah.random,Vp=Wm.reverse,$0=Bl(st,"DataView"),Po=Bl(st,"Map"),Ut=Bl(st,"Promise"),Ia=Bl(st,"Set"),Xm=Bl(st,"WeakMap"),Of=Bl(Ji,"create"),Md=Xm&&new Xm,ya={},W0=em($0),Ac=em(Po),bx=em(Ut),kl=em(Ia),Gp=em(Xm),tu=Rd?Rd.prototype:u,Nf=tu?tu.valueOf:u,Zm=tu?tu.toString:u;function ve(E){if(L(E)&&!ei(E)&&!(E instanceof Bi)){if(E instanceof po)return E;if(Mr.call(E,"__wrapped__"))return bS(E)}return new po(E)}var Od=function(){function E(){}return function(w){if(!O(w))return{};if(Km)return Km(w);E.prototype=w;var F=new E;return E.prototype=u,F}}();function Oh(){}function po(E,w){this.__wrapped__=E,this.__actions__=[],this.__chain__=!!w,this.__index__=0,this.__values__=u}function Bi(E){this.__wrapped__=E,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=R,this.__views__=[]}function Nd(E){var w=-1,F=E==null?0:E.length;for(this.clear();++w<F;){var ee=E[w];this.set(ee[0],ee[1])}}function Uu(E){var w=-1,F=E==null?0:E.length;for(this.clear();++w<F;){var ee=E[w];this.set(ee[0],ee[1])}}function ll(E){var w=-1,F=E==null?0:E.length;for(this.clear();++w<F;){var ee=E[w];this.set(ee[0],ee[1])}}function Bu(E){var w=-1,F=E==null?0:E.length;for(this.__data__=new ll;++w<F;)this.add(E[w])}function Rc(E){var w=this.__data__=new Uu(E);this.size=w.size}function cy(E,w){var F=ei(E),ee=!F&&qr(E),ue=!F&&!ee&&Uf(E),Ae=!F&&!ee&&!ue&&me(E),Ue=F||ee||ue||Ae,Ge=Ue?Gm(E.length,Rh):[],ot=Ge.length;for(var It in E)!w&&!Mr.call(E,It)||Ue&&(It=="length"||ue&&(It=="offset"||It=="parent")||Ae&&(It=="buffer"||It=="byteLength"||It=="byteOffset")||Us(It,ot))||Ge.push(It);return Ge}function nu(E){var w=E.length;return w?E[lS(0,w-1)]:u}function ly(E,w){return mv(Nc(E),Id(w,0,E.length))}function Y0(E){return mv(Nc(E))}function K0(E,w,F){(F!==u&&!Bs(E[w],F)||F===u&&!(w in E))&&Fu(E,w,F)}function If(E,w,F){var ee=E[w];Mr.call(E,w)&&Bs(ee,F)&&(F!==u||w in E)||Fu(E,w,F)}function Do(E,w){for(var F=E.length;F--;)if(Bs(E[F][0],w))return F;return-1}function nS(E,w,F,ee){return Pl(E,function(ue,Ae,Ue){w(ee,ue,F(ue),Ue)}),ee}function nc(E,w){return E&&qu(w,An(w),E)}function Fu(E,w,F){w=="__proto__"&&V0?V0(E,w,{configurable:!0,enumerable:!0,value:F,writable:!0}):E[w]=F}function X0(E,w){for(var F=-1,ee=w.length,ue=fn(ee),Ae=E==null;++F<ee;)ue[F]=Ae?u:Oi(E,w[F]);return ue}function Id(E,w,F){return E==E&&(F!==u&&(E=E<=F?E:F),w!==u&&(E=E>=w?E:w)),E}function Mc(E,w,F,ee,ue,Ae){var Ue,Ge=1&w,ot=2&w,It=4&w;if(F&&(Ue=ue?F(E,ee,ue,Ae):F(E)),Ue!==u)return Ue;if(!O(E))return E;var Dt=ei(E);if(Dt){if(Ue=function(Lt){var en=Lt.length,_i=new Lt.constructor(en);return en&&typeof Lt[0]=="string"&&Mr.call(Lt,"index")&&(_i.index=Lt.index,_i.input=Lt.input),_i}(E),!Ge)return Nc(E,Ue)}else{var Xt=Ka(E),Pn=Xt==q||Xt==Y;if(Uf(E))return bi(E,Ge);if(Xt==J||Xt==k||Pn&&!ue){if(Ue=ot||Pn?{}:Rx(E),!Ge)return ot?function(Lt,en){return qu(Lt,gS(Lt),en)}(E,function(Lt,en){return Lt&&qu(en,Kn(en),Lt)}(Ue,E)):function(Lt,en){return qu(Lt,dv(Lt),en)}(E,nc(Ue,E))}else{if(!Hn[Xt])return ue?E:{};Ue=function(Lt,en,_i){var $t=Lt.constructor;switch(en){case Te:return sg(Lt);case U:case V:return new $t(+Lt);case Re:return function(cn,Bn){var ln=Bn?sg(cn.buffer):cn.buffer;return new cn.constructor(ln,cn.byteOffset,cn.byteLength)}(Lt,_i);case ge:case _e:case ke:case gt:case wt:case ye:case Se:case Qe:case pe:return my(Lt,_i);case te:return new $t;case G:case ce:return new $t(Lt);case X:return function(cn){var Bn=new cn.constructor(cn.source,je.exec(cn));return Bn.lastIndex=cn.lastIndex,Bn}(Lt);case ae:return new $t;case Me:return Dn=Lt,Nf?Ji(Nf.call(Dn)):{}}var Dn}(E,Xt,Ge)}}Ae||(Ae=new Rc);var jn=Ae.get(E);if(jn)return jn;Ae.set(E,Ue),Z(E)?E.forEach(function(Lt){Ue.add(Mc(Lt,w,F,Lt,E,Ae))}):B(E)&&E.forEach(function(Lt,en){Ue.set(en,Mc(Lt,w,F,en,E,Ae))});var ri=Dt?u:(It?ot?vy:pS:ot?Kn:An)(E);return ec(ri||E,function(Lt,en){ri&&(Lt=E[en=Lt]),If(Ue,en,Mc(Lt,w,F,en,E,Ae))}),Ue}function fs(E,w,F){var ee=F.length;if(E==null)return!ee;for(E=Ji(E);ee--;){var ue=F[ee],Ae=w[ue],Ue=E[ue];if(Ue===u&&!(ue in E)||!Ae(Ue))return!1}return!0}function uy(E,w,F){if(typeof E!="function")throw new al(h);return lg(function(){E.apply(u,F)},w)}function kf(E,w,F,ee){var ue=-1,Ae=Vm,Ue=!0,Ge=E.length,ot=[],It=w.length;if(!Ge)return ot;F&&(w=Rs(w,Tc(F))),ee?(Ae=wd,Ue=!1):w.length>=200&&(Ae=Cd,Ue=!1,w=new Bu(w));e:for(;++ue<Ge;){var Dt=E[ue],Xt=F==null?Dt:F(Dt);if(Dt=ee||Dt!==0?Dt:0,Ue&&Xt==Xt){for(var Pn=It;Pn--;)if(w[Pn]===Xt)continue e;ot.push(Dt)}else Ae(w,Xt,ee)||ot.push(Dt)}return ot}ve.templateSettings={escape:he,evaluate:$e,interpolate:et,variable:"",imports:{_:ve}},ve.prototype=Oh.prototype,ve.prototype.constructor=ve,po.prototype=Od(Oh.prototype),po.prototype.constructor=po,Bi.prototype=Od(Oh.prototype),Bi.prototype.constructor=Bi,Nd.prototype.clear=function(){this.__data__=Of?Of(null):{},this.size=0},Nd.prototype.delete=function(E){var w=this.has(E)&&delete this.__data__[E];return this.size-=w?1:0,w},Nd.prototype.get=function(E){var w=this.__data__;if(Of){var F=w[E];return F===d?u:F}return Mr.call(w,E)?w[E]:u},Nd.prototype.has=function(E){var w=this.__data__;return Of?w[E]!==u:Mr.call(w,E)},Nd.prototype.set=function(E,w){var F=this.__data__;return this.size+=this.has(E)?0:1,F[E]=Of&&w===u?d:w,this},Uu.prototype.clear=function(){this.__data__=[],this.size=0},Uu.prototype.delete=function(E){var w=this.__data__,F=Do(w,E);return!(F<0)&&(F==w.length-1?w.pop():Mf.call(w,F,1),--this.size,!0)},Uu.prototype.get=function(E){var w=this.__data__,F=Do(w,E);return F<0?u:w[F][1]},Uu.prototype.has=function(E){return Do(this.__data__,E)>-1},Uu.prototype.set=function(E,w){var F=this.__data__,ee=Do(F,E);return ee<0?(++this.size,F.push([E,w])):F[ee][1]=w,this},ll.prototype.clear=function(){this.size=0,this.__data__={hash:new Nd,map:new(Po||Uu),string:new Nd}},ll.prototype.delete=function(E){var w=_y(this,E).delete(E);return this.size-=w?1:0,w},ll.prototype.get=function(E){return _y(this,E).get(E)},ll.prototype.has=function(E){return _y(this,E).has(E)},ll.prototype.set=function(E,w){var F=_y(this,E),ee=F.size;return F.set(E,w),this.size+=F.size==ee?0:1,this},Bu.prototype.add=Bu.prototype.push=function(E){return this.__data__.set(E,d),this},Bu.prototype.has=function(E){return this.__data__.has(E)},Rc.prototype.clear=function(){this.__data__=new Uu,this.size=0},Rc.prototype.delete=function(E){var w=this.__data__,F=w.delete(E);return this.size=w.size,F},Rc.prototype.get=function(E){return this.__data__.get(E)},Rc.prototype.has=function(E){return this.__data__.has(E)},Rc.prototype.set=function(E,w){var F=this.__data__;if(F instanceof Uu){var ee=F.__data__;if(!Po||ee.length<199)return ee.push([E,w]),this.size=++F.size,this;F=this.__data__=new ll(ee)}return F.set(E,w),this.size=F.size,this};var Pl=xx(zu),Z0=xx(sS,!0);function iS(E,w){var F=!0;return Pl(E,function(ee,ue,Ae){return F=!!w(ee,ue,Ae)}),F}function Jm(E,w,F){for(var ee=-1,ue=E.length;++ee<ue;){var Ae=E[ee],Ue=w(Ae);if(Ue!=null&&(Ge===u?Ue==Ue&&!de(Ue):F(Ue,Ge)))var Ge=Ue,ot=Ae}return ot}function Qm(E,w){var F=[];return Pl(E,function(ee,ue,Ae){w(ee,ue,Ae)&&F.push(ee)}),F}function Ya(E,w,F,ee,ue){var Ae=-1,Ue=E.length;for(F||(F=vS),ue||(ue=[]);++Ae<Ue;){var Ge=E[Ae];w>0&&F(Ge)?w>1?Ya(Ge,w-1,F,ee,ue):wh(ue,Ge):ee||(ue[ue.length]=Ge)}return ue}var J0=wx(),rS=wx(!0);function zu(E,w){return E&&J0(E,w,An)}function sS(E,w){return E&&rS(E,w,An)}function ju(E,w){return ku(w,function(F){return N(E[F])})}function Ys(E,w){for(var F=0,ee=(w=Dh(w,E)).length;E!=null&&F<ee;)E=E[Ku(w[F++])];return F&&F==ee?E:u}function iu(E,w,F){var ee=w(E);return ei(E)?ee:wh(ee,F(E))}function ba(E){return E==null?E===u?"[object Undefined]":"[object Null]":Vr&&Vr in Ji(E)?function(w){var F=Mr.call(w,Vr),ee=w[Vr];try{w[Vr]=u;var ue=!0}catch{}var Ae=Af.call(w);return ue&&(F?w[Vr]=ee:delete w[Vr]),Ae}(E):function(w){return Af.call(w)}(E)}function Gr(E,w){return E>w}function eg(E,w){return E!=null&&Mr.call(E,w)}function tg(E,w){return E!=null&&w in Ji(E)}function hy(E,w,F){for(var ee=F?wd:Vm,ue=E[0].length,Ae=E.length,Ue=Ae,Ge=fn(Ae),ot=1/0,It=[];Ue--;){var Dt=E[Ue];Ue&&w&&(Dt=Rs(Dt,Tc(w))),ot=na(Dt.length,ot),Ge[Ue]=!F&&(w||ue>=120&&Dt.length>=120)?new Bu(Ue&&Dt):u}Dt=E[0];var Xt=-1,Pn=Ge[0];e:for(;++Xt<ue&&It.length<ot;){var jn=Dt[Xt],ri=w?w(jn):jn;if(jn=F||jn!==0?jn:0,!(Pn?Cd(Pn,ri):ee(It,ri,F))){for(Ue=Ae;--Ue;){var Lt=Ge[Ue];if(!(Lt?Cd(Lt,ri):ee(E[Ue],ri,F)))continue e}Pn&&Pn.push(ri),It.push(jn)}}return It}function Oc(E,w,F){var ee=(E=yS(E,w=Dh(w,E)))==null?E:E[Ku(Bo(w))];return ee==null?u:Qo(ee,E,F)}function Q0(E){return L(E)&&ba(E)==k}function lr(E,w,F,ee,ue){return E===w||(E==null||w==null||!L(E)&&!L(w)?E!=E&&w!=w:function(Ae,Ue,Ge,ot,It,Dt){var Xt=ei(Ae),Pn=ei(Ue),jn=Xt?P:Ka(Ae),ri=Pn?P:Ka(Ue),Lt=(jn=jn==k?J:jn)==J,en=(ri=ri==k?J:ri)==J,_i=jn==ri;if(_i&&Uf(Ae)){if(!Uf(Ue))return!1;Xt=!0,Lt=!1}if(_i&&!Lt)return Dt||(Dt=new Rc),Xt||me(Ae)?fS(Ae,Ue,Ge,ot,It,Dt):function(ln,Vn,Os,js,kc,Pr,mr){switch(Os){case Re:if(ln.byteLength!=Vn.byteLength||ln.byteOffset!=Vn.byteOffset)return!1;ln=ln.buffer,Vn=Vn.buffer;case Te:return!(ln.byteLength!=Vn.byteLength||!Pr(new Mh(ln),new Mh(Vn)));case U:case V:case G:return Bs(+ln,+Vn);case $:return ln.name==Vn.name&&ln.message==Vn.message;case X:case ce:return ln==Vn+"";case te:var Pc=qm;case ae:var au=1&js;if(Pc||(Pc=$m),ln.size!=Vn.size&&!au)return!1;var Ay=mr.get(ln);if(Ay)return Ay==Vn;js|=2,mr.set(ln,Vn);var ou=fS(Pc(ln),Pc(Vn),js,kc,Pr,mr);return mr.delete(ln),ou;case Me:if(Nf)return Nf.call(ln)==Nf.call(Vn)}return!1}(Ae,Ue,jn,Ge,ot,It,Dt);if(!(1&Ge)){var $t=Lt&&Mr.call(Ae,"__wrapped__"),Dn=en&&Mr.call(Ue,"__wrapped__");if($t||Dn){var cn=$t?Ae.value():Ae,Bn=Dn?Ue.value():Ue;return Dt||(Dt=new Rc),It(cn,Bn,Ge,ot,Dt)}}return _i?(Dt||(Dt=new Rc),function(ln,Vn,Os,js,kc,Pr){var mr=1&Os,Pc=pS(ln),au=Pc.length,Ay=pS(Vn),ou=Ay.length;if(au!=ou&&!mr)return!1;for(var nm=au;nm--;){var Fd=Pc[nm];if(!(mr?Fd in Vn:Mr.call(Vn,Fd)))return!1}var zd=Pr.get(ln),Lx=Pr.get(Vn);if(zd&&Lx)return zd==Vn&&Lx==ln;var Ry=!0;Pr.set(ln,Vn),Pr.set(Vn,ln);for(var Sv=mr;++nm<au;){var Tv=ln[Fd=Pc[nm]],jd=Vn[Fd];if(js)var MS=mr?js(jd,Tv,Fd,Vn,ln,Pr):js(Tv,jd,Fd,ln,Vn,Pr);if(!(MS===u?Tv===jd||kc(Tv,jd,Os,js,Pr):MS)){Ry=!1;break}Sv||(Sv=Fd=="constructor")}if(Ry&&!Sv){var zf=ln.constructor,_g=Vn.constructor;zf==_g||!("constructor"in ln)||!("constructor"in Vn)||typeof zf=="function"&&zf instanceof zf&&typeof _g=="function"&&_g instanceof _g||(Ry=!1)}return Pr.delete(ln),Pr.delete(Vn),Ry}(Ae,Ue,Ge,ot,It,Dt)):!1}(E,w,F,ee,lr,ue))}function ev(E,w,F,ee){var ue=F.length,Ae=ue,Ue=!ee;if(E==null)return!Ae;for(E=Ji(E);ue--;){var Ge=F[ue];if(Ue&&Ge[2]?Ge[1]!==E[Ge[0]]:!(Ge[0]in E))return!1}for(;++ue<Ae;){var ot=(Ge=F[ue])[0],It=E[ot],Dt=Ge[1];if(Ue&&Ge[2]){if(It===u&&!(ot in E))return!1}else{var Xt=new Rc;if(ee)var Pn=ee(It,Dt,ot,E,w,Xt);if(!(Pn===u?lr(Dt,It,3,ee,Xt):Pn))return!1}}return!0}function Ex(E){return!(!O(E)||(w=E,ay&&ay in w))&&(N(E)?yx:Pt).test(em(E));var w}function aS(E){return typeof E=="function"?E:E==null?_s:typeof E=="object"?ei(E)?Nh(E[0],E[1]):tv(E):Ff(E)}function oS(E){if(!fv(E))return wc(E);var w=[];for(var F in Ji(E))Mr.call(E,F)&&F!="constructor"&&w.push(F);return w}function Sx(E){if(!O(E))return function(ue){var Ae=[];if(ue!=null)for(var Ue in Ji(ue))Ae.push(Ue);return Ae}(E);var w=fv(E),F=[];for(var ee in E)(ee!="constructor"||!w&&Mr.call(E,ee))&&F.push(ee);return F}function dy(E,w){return E<w}function Hu(E,w){var F=-1,ee=yo(E)?fn(E.length):[];return Pl(E,function(ue,Ae,Ue){ee[++F]=w(ue,Ae,Ue)}),ee}function tv(E){var w=ii(E);return w.length==1&&w[0][2]?Ox(w[0][0],w[0][1]):function(F){return F===E||ev(F,E,w)}}function Nh(E,w){return yy(E)&&Mx(w)?Ox(Ku(E),w):function(F){var ee=Oi(F,E);return ee===u&&ee===w?Di(F,E):lr(w,ee,3)}}function nv(E,w,F,ee,ue){E!==w&&J0(w,function(Ae,Ue){if(ue||(ue=new Rc),O(Ae))(function(ot,It,Dt,Xt,Pn,jn,ri){var Lt=pv(ot,Dt),en=pv(It,Dt),_i=ri.get(en);if(_i)return void K0(ot,Dt,_i);var $t=jn?jn(Lt,en,Dt+"",ot,It,ri):u,Dn=$t===u;if(Dn){var cn=ei(en),Bn=!cn&&Uf(en),ln=!cn&&!Bn&&me(en);$t=en,cn||Bn||ln?ei(Lt)?$t=Lt:Fs(Lt)?$t=Nc(Lt):Bn?(Dn=!1,$t=bi(en,!0)):ln?(Dn=!1,$t=my(en,!0)):$t=[]:ne(en)||qr(en)?($t=Lt,qr(Lt)?$t=Jt(Lt):O(Lt)&&!N(Lt)||($t=Rx(en))):Dn=!1}Dn&&(ri.set(en,$t),Pn($t,en,Xt,jn,ri),ri.delete(en)),K0(ot,Dt,$t)})(E,w,Ue,F,nv,ee,ue);else{var Ge=ee?ee(pv(E,Ue),Ae,Ue+"",E,w,ue):u;Ge===u&&(Ge=Ae),K0(E,Ue,Ge)}},Kn)}function iv(E,w){var F=E.length;if(F)return Us(w+=w<0?F:0,F)?E[w]:u}function Pf(E,w,F){w=w.length?Rs(w,function(Ae){return ei(Ae)?function(Ue){return Ys(Ue,Ae.length===1?Ae[0]:Ae)}:Ae}):[_s];var ee=-1;w=Rs(w,Tc(ui()));var ue=Hu(E,function(Ae,Ue,Ge){var ot=Rs(w,function(It){return It(Ae)});return{criteria:ot,index:++ee,value:Ae}});return function(Ae,Ue){var Ge=Ae.length;for(Ae.sort(Ue);Ge--;)Ae[Ge]=Ae[Ge].value;return Ae}(ue,function(Ae,Ue){return function(Ge,ot,It){for(var Dt=-1,Xt=Ge.criteria,Pn=ot.criteria,jn=Xt.length,ri=It.length;++Dt<jn;){var Lt=Xp(Xt[Dt],Pn[Dt]);if(Lt)return Dt>=ri?Lt:Lt*(It[Dt]=="desc"?-1:1)}return Ge.index-ot.index}(Ae,Ue,F)})}function cS(E,w,F){for(var ee=-1,ue=w.length,Ae={};++ee<ue;){var Ue=w[ee],Ge=Ys(E,Ue);F(Ge,Ue)&&ng(Ae,Dh(Ue,E),Ge)}return Ae}function rv(E,w,F,ee){var ue=ee?ry:wf,Ae=-1,Ue=w.length,Ge=E;for(E===w&&(w=Nc(w)),F&&(Ge=Rs(E,Tc(F)));++Ae<Ue;)for(var ot=0,It=w[Ae],Dt=F?F(It):It;(ot=ue(Ge,Dt,ot,ee))>-1;)Ge!==E&&Mf.call(Ge,ot,1),Mf.call(E,ot,1);return E}function fy(E,w){for(var F=E?w.length:0,ee=F-1;F--;){var ue=w[F];if(F==ee||ue!==Ae){var Ae=ue;Us(ue)?Mf.call(E,ue,1):Yp(E,ue)}}return E}function lS(E,w){return E+cl(ko()*(w-E+1))}function py(E,w){var F="";if(!E||w<1||w>x)return F;do w%2&&(F+=E),(w=cl(w/2))&&(E+=E);while(w);return F}function $i(E,w){return by(cg(E,w,_s),E+"")}function sv(E){return nu(fr(E))}function Tx(E,w){var F=fr(E);return mv(F,Id(w,0,F.length))}function ng(E,w,F,ee){if(!O(E))return E;for(var ue=-1,Ae=(w=Dh(w,E)).length,Ue=Ae-1,Ge=E;Ge!=null&&++ue<Ae;){var ot=Ku(w[ue]),It=F;if(ot==="__proto__"||ot==="constructor"||ot==="prototype")return E;if(ue!=Ue){var Dt=Ge[ot];(It=ee?ee(Dt,ot,Ge):u)===u&&(It=O(Dt)?Dt:Us(w[ue+1])?[]:{})}If(Ge,ot,It),Ge=Ge[ot]}return E}var kd=Md?function(E,w){return Md.set(E,w),E}:_s,Vi=V0?function(E,w){return V0(E,"toString",{configurable:!0,enumerable:!1,value:Fo(w),writable:!0})}:_s;function qp(E){return mv(fr(E))}function ps(E,w,F){var ee=-1,ue=E.length;w<0&&(w=-w>ue?0:ue+w),(F=F>ue?ue:F)<0&&(F+=ue),ue=w>F?0:F-w>>>0,w>>>=0;for(var Ae=fn(ue);++ee<ue;)Ae[ee]=E[ee+w];return Ae}function Ih(E,w){var F;return Pl(E,function(ee,ue,Ae){return!(F=w(ee,ue,Ae))}),!!F}function $p(E,w,F){var ee=0,ue=E==null?ee:E.length;if(typeof w=="number"&&w==w&&ue<=2147483647){for(;ee<ue;){var Ae=ee+ue>>>1,Ue=E[Ae];Ue!==null&&!de(Ue)&&(F?Ue<=w:Ue<w)?ee=Ae+1:ue=Ae}return ue}return ig(E,w,_s,F)}function ig(E,w,F,ee){var ue=0,Ae=E==null?0:E.length;if(Ae===0)return 0;for(var Ue=(w=F(w))!=w,Ge=w===null,ot=de(w),It=w===u;ue<Ae;){var Dt=cl((ue+Ae)/2),Xt=F(E[Dt]),Pn=Xt!==u,jn=Xt===null,ri=Xt==Xt,Lt=de(Xt);if(Ue)var en=ee||ri;else en=It?ri&&(ee||Pn):Ge?ri&&Pn&&(ee||!jn):ot?ri&&Pn&&!jn&&(ee||!Lt):!jn&&!Lt&&(ee?Xt<=w:Xt<w);en?ue=Dt+1:Ae=Dt}return na(Ae,4294967294)}function Wp(E,w){for(var F=-1,ee=E.length,ue=0,Ae=[];++F<ee;){var Ue=E[F],Ge=w?w(Ue):Ue;if(!F||!Bs(Ge,ot)){var ot=Ge;Ae[ue++]=Ue===0?0:Ue}}return Ae}function kh(E){return typeof E=="number"?E:de(E)?M:+E}function ul(E){if(typeof E=="string")return E;if(ei(E))return Rs(E,ul)+"";if(de(E))return Zm?Zm.call(E):"";var w=E+"";return w=="0"&&1/E==-1/0?"-0":w}function Ph(E,w,F){var ee=-1,ue=Vm,Ae=E.length,Ue=!0,Ge=[],ot=Ge;if(F)Ue=!1,ue=wd;else if(Ae>=200){var It=w?null:NR(E);if(It)return $m(It);Ue=!1,ue=Cd,ot=new Bu}else ot=w?[]:Ge;e:for(;++ee<Ae;){var Dt=E[ee],Xt=w?w(Dt):Dt;if(Dt=F||Dt!==0?Dt:0,Ue&&Xt==Xt){for(var Pn=ot.length;Pn--;)if(ot[Pn]===Xt)continue e;w&&ot.push(Xt),Ge.push(Dt)}else ue(ot,Xt,F)||(ot!==Ge&&ot.push(Xt),Ge.push(Dt))}return Ge}function Yp(E,w){return(E=yS(E,w=Dh(w,E)))==null||delete E[Ku(Bo(w))]}function uS(E,w,F,ee){return ng(E,w,F(Ys(E,w)),ee)}function Vu(E,w,F,ee){for(var ue=E.length,Ae=ee?ue:-1;(ee?Ae--:++Ae<ue)&&w(E[Ae],Ae,E););return F?ps(E,ee?0:Ae,ee?Ae+1:ue):ps(E,ee?Ae+1:0,ee?ue:Ae)}function rg(E,w){var F=E;return F instanceof Bi&&(F=F.value()),ny(w,function(ee,ue){return ue.func.apply(ue.thisArg,wh([ee],ue.args))},F)}function av(E,w,F){var ee=E.length;if(ee<2)return ee?Ph(E[0]):[];for(var ue=-1,Ae=fn(ee);++ue<ee;)for(var Ue=E[ue],Ge=-1;++Ge<ee;)Ge!=ue&&(Ae[ue]=kf(Ae[ue]||Ue,E[Ge],w,F));return Ph(Ya(Ae,1),w,F)}function Kp(E,w,F){for(var ee=-1,ue=E.length,Ae=w.length,Ue={};++ee<ue;){var Ge=ee<Ae?w[ee]:u;F(Ue,E[ee],Ge)}return Ue}function ov(E){return Fs(E)?E:[]}function Gu(E){return typeof E=="function"?E:_s}function Dh(E,w){return ei(E)?E:yy(E,w)?[E]:Ey(Nt(E))}var OR=$i;function mo(E,w,F){var ee=E.length;return F=F===u?ee:F,!w&&F>=ee?E:ps(E,w,F)}var hS=dn||function(E){return Sn.clearTimeout(E)};function bi(E,w){if(w)return E.slice();var F=E.length,ee=eS?eS(F):new E.constructor(F);return E.copy(ee),ee}function sg(E){var w=new E.constructor(E.byteLength);return new Mh(w).set(new Mh(E)),w}function my(E,w){var F=w?sg(E.buffer):E.buffer;return new E.constructor(F,E.byteOffset,E.length)}function Xp(E,w){if(E!==w){var F=E!==u,ee=E===null,ue=E==E,Ae=de(E),Ue=w!==u,Ge=w===null,ot=w==w,It=de(w);if(!Ge&&!It&&!Ae&&E>w||Ae&&Ue&&ot&&!Ge&&!It||ee&&Ue&&ot||!F&&ot||!ue)return 1;if(!ee&&!Ae&&!It&&E<w||It&&F&&ue&&!ee&&!Ae||Ge&&F&&ue||!Ue&&ue||!ot)return-1}return 0}function Pd(E,w,F,ee){for(var ue=-1,Ae=E.length,Ue=F.length,Ge=-1,ot=w.length,It=Ms(Ae-Ue,0),Dt=fn(ot+It),Xt=!ee;++Ge<ot;)Dt[Ge]=w[Ge];for(;++ue<Ue;)(Xt||ue<Ae)&&(Dt[F[ue]]=E[ue]);for(;It--;)Dt[Ge++]=E[ue++];return Dt}function cv(E,w,F,ee){for(var ue=-1,Ae=E.length,Ue=-1,Ge=F.length,ot=-1,It=w.length,Dt=Ms(Ae-Ge,0),Xt=fn(Dt+It),Pn=!ee;++ue<Dt;)Xt[ue]=E[ue];for(var jn=ue;++ot<It;)Xt[jn+ot]=w[ot];for(;++Ue<Ge;)(Pn||ue<Ae)&&(Xt[jn+F[Ue]]=E[ue++]);return Xt}function Nc(E,w){var F=-1,ee=E.length;for(w||(w=fn(ee));++F<ee;)w[F]=E[F];return w}function qu(E,w,F,ee){var ue=!F;F||(F={});for(var Ae=-1,Ue=w.length;++Ae<Ue;){var Ge=w[Ae],ot=ee?ee(F[Ge],E[Ge],Ge,F,E):u;ot===u&&(ot=E[Ge]),ue?Fu(F,Ge,ot):If(F,Ge,ot)}return F}function Df(E,w){return function(F,ee){var ue=ei(F)?D0:nS,Ae=w?w():{};return ue(F,E,ui(ee,2),Ae)}}function ag(E){return $i(function(w,F){var ee=-1,ue=F.length,Ae=ue>1?F[ue-1]:u,Ue=ue>2?F[2]:u;for(Ae=E.length>3&&typeof Ae=="function"?(ue--,Ae):u,Ue&&rc(F[0],F[1],Ue)&&(Ae=ue<3?u:Ae,ue=1),w=Ji(w);++ee<ue;){var Ge=F[ee];Ge&&E(w,Ge,ee,Ae)}return w})}function xx(E,w){return function(F,ee){if(F==null)return F;if(!yo(F))return E(F,ee);for(var ue=F.length,Ae=w?ue:-1,Ue=Ji(F);(w?Ae--:++Ae<ue)&&ee(Ue[Ae],Ae,Ue)!==!1;);return F}}function wx(E){return function(w,F,ee){for(var ue=-1,Ae=Ji(w),Ue=ee(w),Ge=Ue.length;Ge--;){var ot=Ue[E?Ge:++ue];if(F(Ae[ot],ot,Ae)===!1)break}return w}}function Cx(E){return function(w){var F=Cf(w=Nt(w))?ta(w):u,ee=F?F[0]:w.charAt(0),ue=F?mo(F,1).join(""):w.slice(1);return ee[E]()+ue}}function Zp(E){return function(w){return ny(qi(vs(w).replace(li,"")),E,"")}}function Jp(E){return function(){var w=arguments;switch(w.length){case 0:return new E;case 1:return new E(w[0]);case 2:return new E(w[0],w[1]);case 3:return new E(w[0],w[1],w[2]);case 4:return new E(w[0],w[1],w[2],w[3]);case 5:return new E(w[0],w[1],w[2],w[3],w[4]);case 6:return new E(w[0],w[1],w[2],w[3],w[4],w[5]);case 7:return new E(w[0],w[1],w[2],w[3],w[4],w[5],w[6])}var F=Od(E.prototype),ee=E.apply(F,w);return O(ee)?ee:F}}function dS(E){return function(w,F,ee){var ue=Ji(w);if(!yo(w)){var Ae=ui(F,3);w=An(w),F=function(Ge){return Ae(ue[Ge],Ge,ue)}}var Ue=E(w,F,ee);return Ue>-1?ue[Ae?w[Ue]:Ue]:u}}function og(E){return Yu(function(w){var F=w.length,ee=F,ue=po.prototype.thru;for(E&&w.reverse();ee--;){var Ae=w[ee];if(typeof Ae!="function")throw new al(h);if(ue&&!Ue&&Dd(Ae)=="wrapper")var Ue=new po([],!0)}for(ee=Ue?ee:F;++ee<F;){var Ge=Dd(Ae=w[ee]),ot=Ge=="wrapper"?mS(Ae):u;Ue=ot&&_S(ot[0])&&ot[1]==424&&!ot[4].length&&ot[9]==1?Ue[Dd(ot[0])].apply(Ue,ot[3]):Ae.length==1&&_S(Ae)?Ue[Ge]():Ue.thru(Ae)}return function(){var It=arguments,Dt=It[0];if(Ue&&It.length==1&&ei(Dt))return Ue.plant(Dt).value();for(var Xt=0,Pn=F?w[Xt].apply(this,It):Dt;++Xt<F;)Pn=w[Xt].call(this,Pn);return Pn}})}function lv(E,w,F,ee,ue,Ae,Ue,Ge,ot,It){var Dt=w&v,Xt=1&w,Pn=2&w,jn=24&w,ri=512&w,Lt=Pn?u:Jp(E);return function en(){for(var _i=arguments.length,$t=fn(_i),Dn=_i;Dn--;)$t[Dn]=arguments[Dn];if(jn)var cn=Ul(en),Bn=function(js,kc){for(var Pr=js.length,mr=0;Pr--;)js[Pr]===kc&&++mr;return mr}($t,cn);if(ee&&($t=Pd($t,ee,ue,jn)),Ae&&($t=cv($t,Ae,Ue,jn)),_i-=Bn,jn&&_i<It){var ln=xc($t,cn);return Dl(E,w,lv,en.placeholder,F,$t,ln,Ge,ot,It-_i)}var Vn=Xt?F:this,Os=Pn?Vn[E]:E;return _i=$t.length,Ge?$t=function(js,kc){for(var Pr=js.length,mr=na(kc.length,Pr),Pc=Nc(js);mr--;){var au=kc[mr];js[mr]=Us(au,Pr)?Pc[au]:u}return js}($t,Ge):ri&&_i>1&&$t.reverse(),Dt&&ot<_i&&($t.length=ot),this&&this!==Sn&&this instanceof en&&(Os=Lt||Jp(Os)),Os.apply(Vn,$t)}}function Ax(E,w){return function(F,ee){return function(ue,Ae,Ue,Ge){return zu(ue,function(ot,It,Dt){Ae(Ge,Ue(ot),It,Dt)}),Ge}(F,E,w(ee),{})}}function gy(E,w){return function(F,ee){var ue;if(F===u&&ee===u)return w;if(F!==u&&(ue=F),ee!==u){if(ue===u)return ee;typeof F=="string"||typeof ee=="string"?(F=ul(F),ee=ul(ee)):(F=kh(F),ee=kh(ee)),ue=E(F,ee)}return ue}}function uv(E){return Yu(function(w){return w=Rs(w,Tc(ui())),$i(function(F){var ee=this;return E(w,function(ue){return Qo(ue,ee,F)})})})}function ru(E,w){var F=(w=w===u?" ":ul(w)).length;if(F<2)return F?py(w,E):w;var ee=py(w,Lu(E/Oa(w)));return Cf(w)?mo(ta(ee),0,E).join(""):ee.slice(0,E)}function Lo(E){return function(w,F,ee){return ee&&typeof ee!="number"&&rc(w,F,ee)&&(F=ee=u),w=Ie(w),F===u?(F=w,w=0):F=Ie(F),function(ue,Ae,Ue,Ge){for(var ot=-1,It=Ms(Lu((Ae-ue)/(Ue||1)),0),Dt=fn(It);It--;)Dt[Ge?It:++ot]=ue,ue+=Ue;return Dt}(w,F,ee=ee===u?w<F?1:-1:Ie(ee),E)}}function $u(E){return function(w,F){return typeof w=="string"&&typeof F=="string"||(w=At(w),F=At(F)),E(w,F)}}function Dl(E,w,F,ee,ue,Ae,Ue,Ge,ot,It){var Dt=8&w;w|=Dt?g:_,4&(w&=~(Dt?_:g))||(w&=-4);var Xt=[E,w,ue,Dt?Ae:u,Dt?Ue:u,Dt?u:Ae,Dt?u:Ue,Ge,ot,It],Pn=F.apply(u,Xt);return _S(E)&&hl(Pn,Xt),Pn.placeholder=ee,Xa(Pn,E,w)}function hv(E){var w=Ah[E];return function(F,ee){if(F=At(F),(ee=ee==null?0:na(xe(ee),292))&&Na(F)){var ue=(Nt(F)+"e").split("e");return+((ue=(Nt(w(ue[0]+"e"+(+ue[1]+ee)))+"e").split("e"))[0]+"e"+(+ue[1]-ee))}return w(F)}}var NR=Ia&&1/$m(new Ia([,-0]))[1]==S?function(E){return new Ia(E)}:bo;function ic(E){return function(w){var F=Ka(w);return F==te?qm(w):F==ae?_x(w):function(ee,ue){return Rs(ue,function(Ae){return[Ae,ee[Ae]]})}(w,E(w))}}function go(E,w,F,ee,ue,Ae,Ue,Ge){var ot=2&w;if(!ot&&typeof E!="function")throw new al(h);var It=ee?ee.length:0;if(It||(w&=-97,ee=ue=u),Ue=Ue===u?Ue:Ms(xe(Ue),0),Ge=Ge===u?Ge:xe(Ge),It-=ue?ue.length:0,w&_){var Dt=ee,Xt=ue;ee=ue=u}var Pn=ot?u:mS(E),jn=[E,w,F,ee,ue,Dt,Xt,Ae,Ue,Ge];if(Pn&&function(Lt,en){var _i=Lt[1],$t=en[1],Dn=_i|$t,cn=Dn<131,Bn=$t==v&&_i==8||$t==v&&_i==b&&Lt[7].length<=en[8]||$t==384&&en[7].length<=en[8]&&_i==8;if(!cn&&!Bn)return Lt;1&$t&&(Lt[2]=en[2],Dn|=1&_i?0:4);var ln=en[3];if(ln){var Vn=Lt[3];Lt[3]=Vn?Pd(Vn,ln,en[4]):ln,Lt[4]=Vn?xc(Lt[3],f):en[4]}(ln=en[5])&&(Vn=Lt[5],Lt[5]=Vn?cv(Vn,ln,en[6]):ln,Lt[6]=Vn?xc(Lt[5],f):en[6]),(ln=en[7])&&(Lt[7]=ln),$t&v&&(Lt[8]=Lt[8]==null?en[8]:na(Lt[8],en[8])),Lt[9]==null&&(Lt[9]=en[9]),Lt[0]=en[0],Lt[1]=Dn}(jn,Pn),E=jn[0],w=jn[1],F=jn[2],ee=jn[3],ue=jn[4],!(Ge=jn[9]=jn[9]===u?ot?0:E.length:Ms(jn[9]-It,0))&&24&w&&(w&=-25),w&&w!=1)ri=w==8||w==p?function(Lt,en,_i){var $t=Jp(Lt);return function Dn(){for(var cn=arguments.length,Bn=fn(cn),ln=cn,Vn=Ul(Dn);ln--;)Bn[ln]=arguments[ln];var Os=cn<3&&Bn[0]!==Vn&&Bn[cn-1]!==Vn?[]:xc(Bn,Vn);return(cn-=Os.length)<_i?Dl(Lt,en,lv,Dn.placeholder,u,Bn,Os,u,u,_i-cn):Qo(this&&this!==Sn&&this instanceof Dn?$t:Lt,this,Bn)}}(E,w,Ge):w!=g&&w!=33||ue.length?lv.apply(u,jn):function(Lt,en,_i,$t){var Dn=1&en,cn=Jp(Lt);return function Bn(){for(var ln=-1,Vn=arguments.length,Os=-1,js=$t.length,kc=fn(js+Vn),Pr=this&&this!==Sn&&this instanceof Bn?cn:Lt;++Os<js;)kc[Os]=$t[Os];for(;Vn--;)kc[Os++]=arguments[++ln];return Qo(Pr,Dn?_i:this,kc)}}(E,w,F,ee);else var ri=function(Lt,en,_i){var $t=1&en,Dn=Jp(Lt);return function cn(){return(this&&this!==Sn&&this instanceof cn?Dn:Lt).apply($t?_i:this,arguments)}}(E,w,F);return Xa((Pn?kd:hl)(ri,jn),E,w)}function Wu(E,w,F,ee){return E===u||Bs(E,Pu[F])&&!Mr.call(ee,F)?w:E}function Ll(E,w,F,ee,ue,Ae){return O(E)&&O(w)&&(Ae.set(w,E),nv(E,w,u,Ll,Ae),Ae.delete(w)),E}function ms(E){return ne(E)?u:E}function fS(E,w,F,ee,ue,Ae){var Ue=1&F,Ge=E.length,ot=w.length;if(Ge!=ot&&!(Ue&&ot>Ge))return!1;var It=Ae.get(E),Dt=Ae.get(w);if(It&&Dt)return It==w&&Dt==E;var Xt=-1,Pn=!0,jn=2&F?new Bu:u;for(Ae.set(E,w),Ae.set(w,E);++Xt<Ge;){var ri=E[Xt],Lt=w[Xt];if(ee)var en=Ue?ee(Lt,ri,Xt,w,E,Ae):ee(ri,Lt,Xt,E,w,Ae);if(en!==u){if(en)continue;Pn=!1;break}if(jn){if(!iy(w,function(_i,$t){if(!Cd(jn,$t)&&(ri===_i||ue(ri,_i,F,ee,Ae)))return jn.push($t)})){Pn=!1;break}}else if(ri!==Lt&&!ue(ri,Lt,F,ee,Ae)){Pn=!1;break}}return Ae.delete(E),Ae.delete(w),Pn}function Yu(E){return by(cg(E,u,Nx),E+"")}function pS(E){return iu(E,An,dv)}function vy(E){return iu(E,Kn,gS)}var mS=Md?function(E){return Md.get(E)}:bo;function Dd(E){for(var w=E.name+"",F=ya[w],ee=Mr.call(ya,w)?F.length:0;ee--;){var ue=F[ee],Ae=ue.func;if(Ae==null||Ae==E)return ue.name}return w}function Ul(E){return(Mr.call(ve,"placeholder")?ve:E).placeholder}function ui(){var E=ve.iteratee||lc;return E=E===lc?aS:E,arguments.length?E(arguments[0],arguments[1]):E}function _y(E,w){var F,ee,ue=E.__data__;return((ee=typeof(F=w))=="string"||ee=="number"||ee=="symbol"||ee=="boolean"?F!=="__proto__":F===null)?ue[typeof w=="string"?"string":"hash"]:ue.map}function ii(E){for(var w=An(E),F=w.length;F--;){var ee=w[F],ue=E[ee];w[F]=[ee,ue,Mx(ue)]}return w}function Bl(E,w){var F=function(ee,ue){return ee==null?u:ee[ue]}(E,w);return Ex(F)?F:u}var dv=q0?function(E){return E==null?[]:(E=Ji(E),ku(q0(E),function(w){return j0.call(E,w)}))}:Bd,gS=q0?function(E){for(var w=[];E;)wh(w,dv(E)),E=Ym(E);return w}:Bd,Ka=ba;function Qp(E,w,F){for(var ee=-1,ue=(w=Dh(w,E)).length,Ae=!1;++ee<ue;){var Ue=Ku(w[ee]);if(!(Ae=E!=null&&F(E,Ue)))break;E=E[Ue]}return Ae||++ee!=ue?Ae:!!(ue=E==null?0:E.length)&&A(ue)&&Us(Ue,ue)&&(ei(E)||qr(E))}function Rx(E){return typeof E.constructor!="function"||fv(E)?{}:Od(Ym(E))}function vS(E){return ei(E)||qr(E)||!!(H0&&E&&E[H0])}function Us(E,w){var F=typeof E;return!!(w=w??x)&&(F=="number"||F!="symbol"&&on.test(E))&&E>-1&&E%1==0&&E<w}function rc(E,w,F){if(!O(F))return!1;var ee=typeof w;return!!(ee=="number"?yo(F)&&Us(w,F.length):ee=="string"&&w in F)&&Bs(F[w],E)}function yy(E,w){if(ei(E))return!1;var F=typeof E;return!(F!="number"&&F!="symbol"&&F!="boolean"&&E!=null&&!de(E))||ct.test(E)||!Et.test(E)||w!=null&&E in Ji(w)}function _S(E){var w=Dd(E),F=ve[w];if(typeof F!="function"||!(w in Bi.prototype))return!1;if(E===F)return!0;var ee=mS(F);return!!ee&&E===ee[0]}($0&&Ka(new $0(new ArrayBuffer(1)))!=Re||Po&&Ka(new Po)!=te||Ut&&Ka(Ut.resolve())!=K||Ia&&Ka(new Ia)!=ae||Xm&&Ka(new Xm)!=Fe)&&(Ka=function(E){var w=ba(E),F=w==J?E.constructor:u,ee=F?em(F):"";if(ee)switch(ee){case W0:return Re;case Ac:return te;case bx:return K;case kl:return ae;case Gp:return Fe}return w});var IR=ol?N:jh;function fv(E){var w=E&&E.constructor;return E===(typeof w=="function"&&w.prototype||Pu)}function Mx(E){return E==E&&!O(E)}function Ox(E,w){return function(F){return F!=null&&F[E]===w&&(w!==u||E in Ji(F))}}function cg(E,w,F){return w=Ms(w===u?E.length-1:w,0),function(){for(var ee=arguments,ue=-1,Ae=Ms(ee.length-w,0),Ue=fn(Ae);++ue<Ae;)Ue[ue]=ee[w+ue];ue=-1;for(var Ge=fn(w+1);++ue<w;)Ge[ue]=ee[ue];return Ge[w]=F(Ue),Qo(E,this,Ge)}}function yS(E,w){return w.length<2?E:Ys(E,ps(w,0,-1))}function pv(E,w){if((w!=="constructor"||typeof E[w]!="function")&&w!="__proto__")return E[w]}var hl=ug(kd),lg=G0||function(E,w){return Sn.setTimeout(E,w)},by=ug(Vi);function Xa(E,w,F){var ee=w+"";return by(E,function(ue,Ae){var Ue=Ae.length;if(!Ue)return ue;var Ge=Ue-1;return Ae[Ge]=(Ue>1?"& ":"")+Ae[Ge],Ae=Ae.join(Ue>2?", ":" "),ue.replace(W,`{
/* [wrapped with `+Ae+`] */
`)}(ee,function(ue,Ae){return ec(I,function(Ue){var Ge="_."+Ue[0];Ae&Ue[1]&&!Vm(ue,Ge)&&ue.push(Ge)}),ue.sort()}(function(ue){var Ae=ue.match(fe);return Ae?Ae[1].split(Ne):[]}(ee),F)))}function ug(E){var w=0,F=0;return function(){var ee=ki(),ue=16-(ee-F);if(F=ee,ue>0){if(++w>=800)return arguments[0]}else w=0;return E.apply(u,arguments)}}function mv(E,w){var F=-1,ee=E.length,ue=ee-1;for(w=w===u?ee:w;++F<w;){var Ae=lS(F,ue),Ue=E[Ae];E[Ae]=E[F],E[F]=Ue}return E.length=w,E}var Ey=function(E){var w=oc(E,function(ee){return F.size===500&&F.clear(),ee}),F=w.cache;return w}(function(E){var w=[];return E.charCodeAt(0)===46&&w.push(""),E.replace(tn,function(F,ee,ue,Ae){w.push(ue?Ae.replace(Tt,"$1"):ee||F)}),w});function Ku(E){if(typeof E=="string"||de(E))return E;var w=E+"";return w=="0"&&1/E==-1/0?"-0":w}function em(E){if(E!=null){try{return Wa.call(E)}catch{}try{return E+""}catch{}}return""}function bS(E){if(E instanceof Bi)return E.clone();var w=new po(E.__wrapped__,E.__chain__);return w.__actions__=Nc(E.__actions__),w.__index__=E.__index__,w.__values__=E.__values__,w}var hg=$i(function(E,w){return Fs(E)?kf(E,Ya(w,1,Fs,!0)):[]}),Za=$i(function(E,w){var F=Bo(w);return Fs(F)&&(F=u),Fs(E)?kf(E,Ya(w,1,Fs,!0),ui(F,2)):[]}),dg=$i(function(E,w){var F=Bo(w);return Fs(F)&&(F=u),Fs(E)?kf(E,Ya(w,1,Fs,!0),u,F):[]});function Ea(E,w,F){var ee=E==null?0:E.length;if(!ee)return-1;var ue=F==null?0:xe(F);return ue<0&&(ue=Ms(ee+ue,0)),xf(E,ui(w,3),ue)}function Lh(E,w,F){var ee=E==null?0:E.length;if(!ee)return-1;var ue=ee-1;return F!==u&&(ue=xe(F),ue=F<0?Ms(ee+ue,0):na(ue,ee-1)),xf(E,ui(w,3),ue,!0)}function Nx(E){return E!=null&&E.length?Ya(E,1):[]}function fg(E){return E&&E.length?E[0]:u}var Sy=$i(function(E){var w=Rs(E,ov);return w.length&&w[0]===E[0]?hy(w):[]}),sc=$i(function(E){var w=Bo(E),F=Rs(E,ov);return w===Bo(F)?w=u:F.pop(),F.length&&F[0]===E[0]?hy(F,ui(w,2)):[]}),Uo=$i(function(E){var w=Bo(E),F=Rs(E,ov);return(w=typeof w=="function"?w:u)&&F.pop(),F.length&&F[0]===E[0]?hy(F,u,w):[]});function Bo(E){var w=E==null?0:E.length;return w?E[w-1]:u}var ES=$i(Ix);function Ix(E,w){return E&&E.length&&w&&w.length?rv(E,w):E}var Ld=Yu(function(E,w){var F=E==null?0:E.length,ee=X0(E,w);return fy(E,Rs(w,function(ue){return Us(ue,F)?+ue:ue}).sort(Xp)),ee});function Sr(E){return E==null?E:Vp.call(E)}var kR=$i(function(E){return Ph(Ya(E,1,Fs,!0))}),PR=$i(function(E){var w=Bo(E);return Fs(w)&&(w=u),Ph(Ya(E,1,Fs,!0),ui(w,2))}),DR=$i(function(E){var w=Bo(E);return w=typeof w=="function"?w:u,Ph(Ya(E,1,Fs,!0),u,w)});function pg(E){if(!E||!E.length)return[];var w=0;return E=ku(E,function(F){if(Fs(F))return w=Ms(F.length,w),!0}),Gm(w,function(F){return Rs(E,L0(F))})}function mg(E,w){if(!E||!E.length)return[];var F=pg(E);return w==null?F:Rs(F,function(ee){return Qo(w,u,ee)})}var gv=$i(function(E,w){return Fs(E)?kf(E,w):[]}),LR=$i(function(E){return av(ku(E,Fs))}),UR=$i(function(E){var w=Bo(E);return Fs(w)&&(w=u),av(ku(E,Fs),ui(w,2))}),kx=$i(function(E){var w=Bo(E);return w=typeof w=="function"?w:u,av(ku(E,Fs),u,w)}),Xu=$i(pg),Zu=$i(function(E){var w=E.length,F=w>1?E[w-1]:u;return F=typeof F=="function"?(E.pop(),F):u,mg(E,F)});function vo(E){var w=ve(E);return w.__chain__=!0,w}function Uh(E,w){return w(E)}var Ud=Yu(function(E){var w=E.length,F=w?E[0]:0,ee=this.__wrapped__,ue=function(Ae){return X0(Ae,E)};return!(w>1||this.__actions__.length)&&ee instanceof Bi&&Us(F)?((ee=ee.slice(F,+F+(w?1:0))).__actions__.push({func:Uh,args:[ue],thisArg:u}),new po(ee,this.__chain__).thru(function(Ae){return w&&!Ae.length&&Ae.push(u),Ae})):this.thru(ue)}),Bh=Df(function(E,w,F){Mr.call(E,F)?++E[F]:Fu(E,F,1)}),Ks=dS(Ea),ac=dS(Lh);function SS(E,w){return(ei(E)?ec:Pl)(E,ui(w,3))}function vv(E,w){return(ei(E)?fx:Z0)(E,ui(w,3))}var TS=Df(function(E,w,F){Mr.call(E,F)?E[F].push(w):Fu(E,F,[w])}),BR=$i(function(E,w,F){var ee=-1,ue=typeof w=="function",Ae=yo(E)?fn(E.length):[];return Pl(E,function(Ue){Ae[++ee]=ue?Qo(w,Ue,F):Oc(Ue,w,F)}),Ae}),Px=Df(function(E,w,F){Fu(E,F,w)});function Ty(E,w){return(ei(E)?Rs:Hu)(E,ui(w,3))}var xS=Df(function(E,w,F){E[F?0:1].push(w)},function(){return[[],[]]}),FR=$i(function(E,w){if(E==null)return[];var F=w.length;return F>1&&rc(E,w[0],w[1])?w=[]:F>2&&rc(w[0],w[1],w[2])&&(w=[w[0]]),Pf(E,Ya(w,1),[])}),ka=_a||function(){return Sn.Date.now()};function gg(E,w,F){return w=F?u:w,w=E&&w==null?E.length:w,go(E,v,u,u,u,u,w)}function xy(E,w){var F;if(typeof w!="function")throw new al(h);return E=xe(E),function(){return--E>0&&(F=w.apply(this,arguments)),E<=1&&(w=u),F}}var wS=$i(function(E,w,F){var ee=1;if(F.length){var ue=xc(F,Ul(wS));ee|=g}return go(E,ee,w,F,ue)}),CS=$i(function(E,w,F){var ee=3;if(F.length){var ue=xc(F,Ul(CS));ee|=g}return go(w,ee,E,F,ue)});function AS(E,w,F){var ee,ue,Ae,Ue,Ge,ot,It=0,Dt=!1,Xt=!1,Pn=!0;if(typeof E!="function")throw new al(h);function jn($t){var Dn=ee,cn=ue;return ee=ue=u,It=$t,Ue=E.apply(cn,Dn)}function ri($t){var Dn=$t-ot;return ot===u||Dn>=w||Dn<0||Xt&&$t-It>=Ae}function Lt(){var $t=ka();if(ri($t))return en($t);Ge=lg(Lt,function(Dn){var cn=w-(Dn-ot);return Xt?na(cn,Ae-(Dn-It)):cn}($t))}function en($t){return Ge=u,Pn&&ee?jn($t):(ee=ue=u,Ue)}function _i(){var $t=ka(),Dn=ri($t);if(ee=arguments,ue=this,ot=$t,Dn){if(Ge===u)return function(cn){return It=cn,Ge=lg(Lt,w),Dt?jn(cn):Ue}(ot);if(Xt)return hS(Ge),Ge=lg(Lt,w),jn(ot)}return Ge===u&&(Ge=lg(Lt,w)),Ue}return w=At(w)||0,O(F)&&(Dt=!!F.leading,Ae=(Xt="maxWait"in F)?Ms(At(F.maxWait)||0,w):Ae,Pn="trailing"in F?!!F.trailing:Pn),_i.cancel=function(){Ge!==u&&hS(Ge),It=0,ee=ot=ue=Ge=u},_i.flush=function(){return Ge===u?Ue:en(ka())},_i}var _o=$i(function(E,w){return uy(E,1,w)}),Lf=$i(function(E,w,F){return uy(E,At(w)||0,F)});function oc(E,w){if(typeof E!="function"||w!=null&&typeof w!="function")throw new al(h);var F=function(){var ee=arguments,ue=w?w.apply(this,ee):ee[0],Ae=F.cache;if(Ae.has(ue))return Ae.get(ue);var Ue=E.apply(this,ee);return F.cache=Ae.set(ue,Ue)||Ae,Ue};return F.cache=new(oc.Cache||ll),F}function cc(E){if(typeof E!="function")throw new al(h);return function(){var w=arguments;switch(w.length){case 0:return!E.call(this);case 1:return!E.call(this,w[0]);case 2:return!E.call(this,w[0],w[1]);case 3:return!E.call(this,w[0],w[1],w[2])}return!E.apply(this,w)}}oc.Cache=ll;var zR=OR(function(E,w){var F=(w=w.length==1&&ei(w[0])?Rs(w[0],Tc(ui())):Rs(Ya(w,1),Tc(ui()))).length;return $i(function(ee){for(var ue=-1,Ae=na(ee.length,F);++ue<Ae;)ee[ue]=w[ue].call(this,ee[ue]);return Qo(E,this,ee)})}),wy=$i(function(E,w){var F=xc(w,Ul(wy));return go(E,g,u,w,F)}),_v=$i(function(E,w){var F=xc(w,Ul(_v));return go(E,_,u,w,F)}),Ja=Yu(function(E,w){return go(E,b,u,u,u,w)});function Bs(E,w){return E===w||E!=E&&w!=w}var Fh=$u(Gr),jR=$u(function(E,w){return E>=w}),qr=Q0(function(){return arguments}())?Q0:function(E){return L(E)&&Mr.call(E,"callee")&&!j0.call(E,"callee")},ei=fn.isArray,Dx=zp?Tc(zp):function(E){return L(E)&&ba(E)==Te};function yo(E){return E!=null&&A(E.length)&&!N(E)}function Fs(E){return L(E)&&yo(E)}var Uf=Hp||jh,vg=xd?Tc(xd):function(E){return L(E)&&ba(E)==V};function RS(E){if(!L(E))return!1;var w=ba(E);return w==$||w=="[object DOMException]"||typeof E.message=="string"&&typeof E.name=="string"&&!ne(E)}function N(E){if(!O(E))return!1;var w=ba(E);return w==q||w==Y||w=="[object AsyncFunction]"||w=="[object Proxy]"}function T(E){return typeof E=="number"&&E==xe(E)}function A(E){return typeof E=="number"&&E>-1&&E%1==0&&E<=x}function O(E){var w=typeof E;return E!=null&&(w=="object"||w=="function")}function L(E){return E!=null&&typeof E=="object"}var B=xh?Tc(xh):function(E){return L(E)&&Ka(E)==te};function H(E){return typeof E=="number"||L(E)&&ba(E)==G}function ne(E){if(!L(E)||ba(E)!=J)return!1;var w=Ym(E);if(w===null)return!0;var F=Mr.call(w,"constructor")&&w.constructor;return typeof F=="function"&&F instanceof F&&Wa.call(F)==Rf}var se=k0?Tc(k0):function(E){return L(E)&&ba(E)==X},Z=ty?Tc(ty):function(E){return L(E)&&Ka(E)==ae};function oe(E){return typeof E=="string"||!ei(E)&&L(E)&&ba(E)==ce}function de(E){return typeof E=="symbol"||L(E)&&ba(E)==Me}var me=P0?Tc(P0):function(E){return L(E)&&A(E.length)&&!!Ci[ba(E)]},Pe=$u(dy),Xe=$u(function(E,w){return E<=w});function qe(E){if(!E)return[];if(yo(E))return oe(E)?ta(E):Nc(E);if(Du&&E[Du])return function(F){for(var ee,ue=[];!(ee=F.next()).done;)ue.push(ee.value);return ue}(E[Du]());var w=Ka(E);return(w==te?qm:w==ae?$m:fr)(E)}function Ie(E){return E?(E=At(E))===S||E===-1/0?17976931348623157e292*(E<0?-1:1):E==E?E:0:E===0?E:0}function xe(E){var w=Ie(E),F=w%1;return w==w?F?w-F:w:0}function lt(E){return E?Id(xe(E),0,R):0}function At(E){if(typeof E=="number")return E;if(de(E))return M;if(O(E)){var w=typeof E.valueOf=="function"?E.valueOf():E;E=O(w)?w+"":w}if(typeof E!="string")return E===0?E:+E;E=QE(E);var F=ht.test(E);return F||hn.test(E)?uo(E.slice(2),F?2:8):zt.test(E)?M:+E}function Jt(E){return qu(E,Kn(E))}function Nt(E){return E==null?"":ul(E)}var Qn=ag(function(E,w){if(fv(w)||yo(w))qu(w,An(w),E);else for(var F in w)Mr.call(w,F)&&If(E,F,w[F])}),On=ag(function(E,w){qu(w,Kn(w),E)}),Ei=ag(function(E,w,F,ee){qu(w,Kn(w),E,ee)}),Fi=ag(function(E,w,F,ee){qu(w,An(w),E,ee)}),Pi=Yu(X0),Ai=$i(function(E,w){E=Ji(E);var F=-1,ee=w.length,ue=ee>2?w[2]:u;for(ue&&rc(w[0],w[1],ue)&&(ee=1);++F<ee;)for(var Ae=w[F],Ue=Kn(Ae),Ge=-1,ot=Ue.length;++Ge<ot;){var It=Ue[Ge],Dt=E[It];(Dt===u||Bs(Dt,Pu[It])&&!Mr.call(E,It))&&(E[It]=Ae[It])}return E}),Si=$i(function(E){return E.push(u,Ll),Qo(ts,u,E)});function Oi(E,w,F){var ee=E==null?u:Ys(E,w);return ee===u?F:ee}function Di(E,w){return E!=null&&Qp(E,w,tg)}var Ti=Ax(function(E,w,F){w!=null&&typeof w.toString!="function"&&(w=Af.call(w)),E[w]=F},Fo(_s)),Ni=Ax(function(E,w,F){w!=null&&typeof w.toString!="function"&&(w=Af.call(w)),Mr.call(E,w)?E[w].push(F):E[w]=[F]},ui),hi=$i(Oc);function An(E){return yo(E)?cy(E):oS(E)}function Kn(E){return yo(E)?cy(E,!0):Sx(E)}var Wi=ag(function(E,w,F){nv(E,w,F)}),ts=ag(function(E,w,F,ee){nv(E,w,F,ee)}),ws=Yu(function(E,w){var F={};if(E==null)return F;var ee=!1;w=Rs(w,function(Ae){return Ae=Dh(Ae,E),ee||(ee=Ae.length>1),Ae}),qu(E,vy(E),F),ee&&(F=Mc(F,7,ms));for(var ue=w.length;ue--;)Yp(F,w[ue]);return F}),ns=Yu(function(E,w){return E==null?{}:function(F,ee){return cS(F,ee,function(ue,Ae){return Di(F,Ae)})}(E,w)});function gs(E,w){if(E==null)return{};var F=Rs(vy(E),function(ee){return[ee]});return w=ui(w),cS(E,F,function(ee,ue){return w(ee,ue[0])})}var is=ic(An),kr=ic(Kn);function fr(E){return E==null?[]:Ls(E,An(E))}var Kr=Zp(function(E,w,F){return w=w.toLowerCase(),E+(F?rs(w):w)});function rs(E){return ti(Nt(E).toLowerCase())}function vs(E){return(E=Nt(E))&&E.replace(Ve,gx).replace(Nn,"")}var ia=Zp(function(E,w,F){return E+(F?"-":"")+w.toLowerCase()}),Sa=Zp(function(E,w,F){return E+(F?" ":"")+w.toLowerCase()}),Cs=Cx("toLowerCase"),zs=Zp(function(E,w,F){return E+(F?"_":"")+w.toLowerCase()}),pr=Zp(function(E,w,F){return E+(F?" ":"")+ti(w)}),Pa=Zp(function(E,w,F){return E+(F?" ":"")+w.toUpperCase()}),ti=Cx("toUpperCase");function qi(E,w,F){return E=Nt(E),(w=F?u:w)===u?function(ee){return xs.test(ee)}(E)?function(ee){return ee.match(cr)||[]}(E):function(ee){return ee.match(Be)||[]}(E):E.match(w)||[]}var Or=$i(function(E,w){try{return Qo(E,u,w)}catch(F){return RS(F)?F:new Hi(F)}}),Qa=Yu(function(E,w){return ec(w,function(F){F=Ku(F),Fu(E,F,wS(E[F],E))}),E});function Fo(E){return function(){return E}}var Ic=og(),dl=og(!0);function _s(E){return E}function lc(E){return aS(typeof E=="function"?E:Mc(E,1))}var zh=$i(function(E,w){return function(F){return Oc(F,E,w)}}),su=$i(function(E,w){return function(F){return Oc(E,F,w)}});function Da(E,w,F){var ee=An(w),ue=ju(w,ee);F!=null||O(w)&&(ue.length||!ee.length)||(F=w,w=E,E=this,ue=ju(w,An(w)));var Ae=!(O(F)&&"chain"in F&&!F.chain),Ue=N(E);return ec(ue,function(Ge){var ot=w[Ge];E[Ge]=ot,Ue&&(E.prototype[Ge]=function(){var It=this.__chain__;if(Ae||It){var Dt=E(this.__wrapped__);return(Dt.__actions__=Nc(this.__actions__)).push({func:ot,args:arguments,thisArg:E}),Dt.__chain__=It,Dt}return ot.apply(E,wh([this.value()],arguments))})}),E}function bo(){}var zo=uv(Rs),uc=uv(WE),Bf=uv(iy);function Ff(E){return yy(E)?L0(Ku(E)):function(w){return function(F){return Ys(F,w)}}(E)}var tm=Lo(),Xs=Lo(!0);function Bd(){return[]}function jh(){return!1}var Ju=gy(function(E,w){return E+w},0),Fl=hv("ceil"),yv=gy(function(E,w){return E/w},1),Cy=hv("floor"),bv,Xr=gy(function(E,w){return E*w},1),Ev=hv("round"),Hh=gy(function(E,w){return E-w},0);return ve.after=function(E,w){if(typeof w!="function")throw new al(h);return E=xe(E),function(){if(--E<1)return w.apply(this,arguments)}},ve.ary=gg,ve.assign=Qn,ve.assignIn=On,ve.assignInWith=Ei,ve.assignWith=Fi,ve.at=Pi,ve.before=xy,ve.bind=wS,ve.bindAll=Qa,ve.bindKey=CS,ve.castArray=function(){if(!arguments.length)return[];var E=arguments[0];return ei(E)?E:[E]},ve.chain=vo,ve.chunk=function(E,w,F){w=(F?rc(E,w,F):w===u)?1:Ms(xe(w),0);var ee=E==null?0:E.length;if(!ee||w<1)return[];for(var ue=0,Ae=0,Ue=fn(Lu(ee/w));ue<ee;)Ue[Ae++]=ps(E,ue,ue+=w);return Ue},ve.compact=function(E){for(var w=-1,F=E==null?0:E.length,ee=0,ue=[];++w<F;){var Ae=E[w];Ae&&(ue[ee++]=Ae)}return ue},ve.concat=function(){var E=arguments.length;if(!E)return[];for(var w=fn(E-1),F=arguments[0],ee=E;ee--;)w[ee-1]=arguments[ee];return wh(ei(F)?Nc(F):[F],Ya(w,1))},ve.cond=function(E){var w=E==null?0:E.length,F=ui();return E=w?Rs(E,function(ee){if(typeof ee[1]!="function")throw new al(h);return[F(ee[0]),ee[1]]}):[],$i(function(ee){for(var ue=-1;++ue<w;){var Ae=E[ue];if(Qo(Ae[0],this,ee))return Qo(Ae[1],this,ee)}})},ve.conforms=function(E){return function(w){var F=An(w);return function(ee){return fs(ee,w,F)}}(Mc(E,1))},ve.constant=Fo,ve.countBy=Bh,ve.create=function(E,w){var F=Od(E);return w==null?F:nc(F,w)},ve.curry=function E(w,F,ee){var ue=go(w,8,u,u,u,u,u,F=ee?u:F);return ue.placeholder=E.placeholder,ue},ve.curryRight=function E(w,F,ee){var ue=go(w,p,u,u,u,u,u,F=ee?u:F);return ue.placeholder=E.placeholder,ue},ve.debounce=AS,ve.defaults=Ai,ve.defaultsDeep=Si,ve.defer=_o,ve.delay=Lf,ve.difference=hg,ve.differenceBy=Za,ve.differenceWith=dg,ve.drop=function(E,w,F){var ee=E==null?0:E.length;return ee?ps(E,(w=F||w===u?1:xe(w))<0?0:w,ee):[]},ve.dropRight=function(E,w,F){var ee=E==null?0:E.length;return ee?ps(E,0,(w=ee-(w=F||w===u?1:xe(w)))<0?0:w):[]},ve.dropRightWhile=function(E,w){return E&&E.length?Vu(E,ui(w,3),!0,!0):[]},ve.dropWhile=function(E,w){return E&&E.length?Vu(E,ui(w,3),!0):[]},ve.fill=function(E,w,F,ee){var ue=E==null?0:E.length;return ue?(F&&typeof F!="number"&&rc(E,w,F)&&(F=0,ee=ue),function(Ae,Ue,Ge,ot){var It=Ae.length;for((Ge=xe(Ge))<0&&(Ge=-Ge>It?0:It+Ge),(ot=ot===u||ot>It?It:xe(ot))<0&&(ot+=It),ot=Ge>ot?0:lt(ot);Ge<ot;)Ae[Ge++]=Ue;return Ae}(E,w,F,ee)):[]},ve.filter=function(E,w){return(ei(E)?ku:Qm)(E,ui(w,3))},ve.flatMap=function(E,w){return Ya(Ty(E,w),1)},ve.flatMapDeep=function(E,w){return Ya(Ty(E,w),S)},ve.flatMapDepth=function(E,w,F){return F=F===u?1:xe(F),Ya(Ty(E,w),F)},ve.flatten=Nx,ve.flattenDeep=function(E){return E!=null&&E.length?Ya(E,S):[]},ve.flattenDepth=function(E,w){return E!=null&&E.length?Ya(E,w=w===u?1:xe(w)):[]},ve.flip=function(E){return go(E,512)},ve.flow=Ic,ve.flowRight=dl,ve.fromPairs=function(E){for(var w=-1,F=E==null?0:E.length,ee={};++w<F;){var ue=E[w];ee[ue[0]]=ue[1]}return ee},ve.functions=function(E){return E==null?[]:ju(E,An(E))},ve.functionsIn=function(E){return E==null?[]:ju(E,Kn(E))},ve.groupBy=TS,ve.initial=function(E){return E!=null&&E.length?ps(E,0,-1):[]},ve.intersection=Sy,ve.intersectionBy=sc,ve.intersectionWith=Uo,ve.invert=Ti,ve.invertBy=Ni,ve.invokeMap=BR,ve.iteratee=lc,ve.keyBy=Px,ve.keys=An,ve.keysIn=Kn,ve.map=Ty,ve.mapKeys=function(E,w){var F={};return w=ui(w,3),zu(E,function(ee,ue,Ae){Fu(F,w(ee,ue,Ae),ee)}),F},ve.mapValues=function(E,w){var F={};return w=ui(w,3),zu(E,function(ee,ue,Ae){Fu(F,ue,w(ee,ue,Ae))}),F},ve.matches=function(E){return tv(Mc(E,1))},ve.matchesProperty=function(E,w){return Nh(E,Mc(w,1))},ve.memoize=oc,ve.merge=Wi,ve.mergeWith=ts,ve.method=zh,ve.methodOf=su,ve.mixin=Da,ve.negate=cc,ve.nthArg=function(E){return E=xe(E),$i(function(w){return iv(w,E)})},ve.omit=ws,ve.omitBy=function(E,w){return gs(E,cc(ui(w)))},ve.once=function(E){return xy(2,E)},ve.orderBy=function(E,w,F,ee){return E==null?[]:(ei(w)||(w=w==null?[]:[w]),ei(F=ee?u:F)||(F=F==null?[]:[F]),Pf(E,w,F))},ve.over=zo,ve.overArgs=zR,ve.overEvery=uc,ve.overSome=Bf,ve.partial=wy,ve.partialRight=_v,ve.partition=xS,ve.pick=ns,ve.pickBy=gs,ve.property=Ff,ve.propertyOf=function(E){return function(w){return E==null?u:Ys(E,w)}},ve.pull=ES,ve.pullAll=Ix,ve.pullAllBy=function(E,w,F){return E&&E.length&&w&&w.length?rv(E,w,ui(F,2)):E},ve.pullAllWith=function(E,w,F){return E&&E.length&&w&&w.length?rv(E,w,u,F):E},ve.pullAt=Ld,ve.range=tm,ve.rangeRight=Xs,ve.rearg=Ja,ve.reject=function(E,w){return(ei(E)?ku:Qm)(E,cc(ui(w,3)))},ve.remove=function(E,w){var F=[];if(!E||!E.length)return F;var ee=-1,ue=[],Ae=E.length;for(w=ui(w,3);++ee<Ae;){var Ue=E[ee];w(Ue,ee,E)&&(F.push(Ue),ue.push(ee))}return fy(E,ue),F},ve.rest=function(E,w){if(typeof E!="function")throw new al(h);return $i(E,w=w===u?w:xe(w))},ve.reverse=Sr,ve.sampleSize=function(E,w,F){return w=(F?rc(E,w,F):w===u)?1:xe(w),(ei(E)?ly:Tx)(E,w)},ve.set=function(E,w,F){return E==null?E:ng(E,w,F)},ve.setWith=function(E,w,F,ee){return ee=typeof ee=="function"?ee:u,E==null?E:ng(E,w,F,ee)},ve.shuffle=function(E){return(ei(E)?Y0:qp)(E)},ve.slice=function(E,w,F){var ee=E==null?0:E.length;return ee?(F&&typeof F!="number"&&rc(E,w,F)?(w=0,F=ee):(w=w==null?0:xe(w),F=F===u?ee:xe(F)),ps(E,w,F)):[]},ve.sortBy=FR,ve.sortedUniq=function(E){return E&&E.length?Wp(E):[]},ve.sortedUniqBy=function(E,w){return E&&E.length?Wp(E,ui(w,2)):[]},ve.split=function(E,w,F){return F&&typeof F!="number"&&rc(E,w,F)&&(w=F=u),(F=F===u?R:F>>>0)?(E=Nt(E))&&(typeof w=="string"||w!=null&&!se(w))&&!(w=ul(w))&&Cf(E)?mo(ta(E),0,F):E.split(w,F):[]},ve.spread=function(E,w){if(typeof E!="function")throw new al(h);return w=w==null?0:Ms(xe(w),0),$i(function(F){var ee=F[w],ue=mo(F,0,w);return ee&&wh(ue,ee),Qo(E,this,ue)})},ve.tail=function(E){var w=E==null?0:E.length;return w?ps(E,1,w):[]},ve.take=function(E,w,F){return E&&E.length?ps(E,0,(w=F||w===u?1:xe(w))<0?0:w):[]},ve.takeRight=function(E,w,F){var ee=E==null?0:E.length;return ee?ps(E,(w=ee-(w=F||w===u?1:xe(w)))<0?0:w,ee):[]},ve.takeRightWhile=function(E,w){return E&&E.length?Vu(E,ui(w,3),!1,!0):[]},ve.takeWhile=function(E,w){return E&&E.length?Vu(E,ui(w,3)):[]},ve.tap=function(E,w){return w(E),E},ve.throttle=function(E,w,F){var ee=!0,ue=!0;if(typeof E!="function")throw new al(h);return O(F)&&(ee="leading"in F?!!F.leading:ee,ue="trailing"in F?!!F.trailing:ue),AS(E,w,{leading:ee,maxWait:w,trailing:ue})},ve.thru=Uh,ve.toArray=qe,ve.toPairs=is,ve.toPairsIn=kr,ve.toPath=function(E){return ei(E)?Rs(E,Ku):de(E)?[E]:Nc(Ey(Nt(E)))},ve.toPlainObject=Jt,ve.transform=function(E,w,F){var ee=ei(E),ue=ee||Uf(E)||me(E);if(w=ui(w,4),F==null){var Ae=E&&E.constructor;F=ue?ee?new Ae:[]:O(E)&&N(Ae)?Od(Ym(E)):{}}return(ue?ec:zu)(E,function(Ue,Ge,ot){return w(F,Ue,Ge,ot)}),F},ve.unary=function(E){return gg(E,1)},ve.union=kR,ve.unionBy=PR,ve.unionWith=DR,ve.uniq=function(E){return E&&E.length?Ph(E):[]},ve.uniqBy=function(E,w){return E&&E.length?Ph(E,ui(w,2)):[]},ve.uniqWith=function(E,w){return w=typeof w=="function"?w:u,E&&E.length?Ph(E,u,w):[]},ve.unset=function(E,w){return E==null||Yp(E,w)},ve.unzip=pg,ve.unzipWith=mg,ve.update=function(E,w,F){return E==null?E:uS(E,w,Gu(F))},ve.updateWith=function(E,w,F,ee){return ee=typeof ee=="function"?ee:u,E==null?E:uS(E,w,Gu(F),ee)},ve.values=fr,ve.valuesIn=function(E){return E==null?[]:Ls(E,Kn(E))},ve.without=gv,ve.words=qi,ve.wrap=function(E,w){return wy(Gu(w),E)},ve.xor=LR,ve.xorBy=UR,ve.xorWith=kx,ve.zip=Xu,ve.zipObject=function(E,w){return Kp(E||[],w||[],If)},ve.zipObjectDeep=function(E,w){return Kp(E||[],w||[],ng)},ve.zipWith=Zu,ve.entries=is,ve.entriesIn=kr,ve.extend=On,ve.extendWith=Ei,Da(ve,ve),ve.add=Ju,ve.attempt=Or,ve.camelCase=Kr,ve.capitalize=rs,ve.ceil=Fl,ve.clamp=function(E,w,F){return F===u&&(F=w,w=u),F!==u&&(F=(F=At(F))==F?F:0),w!==u&&(w=(w=At(w))==w?w:0),Id(At(E),w,F)},ve.clone=function(E){return Mc(E,4)},ve.cloneDeep=function(E){return Mc(E,5)},ve.cloneDeepWith=function(E,w){return Mc(E,5,w=typeof w=="function"?w:u)},ve.cloneWith=function(E,w){return Mc(E,4,w=typeof w=="function"?w:u)},ve.conformsTo=function(E,w){return w==null||fs(E,w,An(w))},ve.deburr=vs,ve.defaultTo=function(E,w){return E==null||E!=E?w:E},ve.divide=yv,ve.endsWith=function(E,w,F){E=Nt(E),w=ul(w);var ee=E.length,ue=F=F===u?ee:Id(xe(F),0,ee);return(F-=w.length)>=0&&E.slice(F,ue)==w},ve.eq=Bs,ve.escape=function(E){return(E=Nt(E))&&we.test(E)?E.replace(pt,U0):E},ve.escapeRegExp=function(E){return(E=Nt(E))&&pn.test(E)?E.replace(Ht,"\\$&"):E},ve.every=function(E,w,F){var ee=ei(E)?WE:iS;return F&&rc(E,w,F)&&(w=u),ee(E,ui(w,3))},ve.find=Ks,ve.findIndex=Ea,ve.findKey=function(E,w){return KE(E,ui(w,3),zu)},ve.findLast=ac,ve.findLastIndex=Lh,ve.findLastKey=function(E,w){return KE(E,ui(w,3),sS)},ve.floor=Cy,ve.forEach=SS,ve.forEachRight=vv,ve.forIn=function(E,w){return E==null?E:J0(E,ui(w,3),Kn)},ve.forInRight=function(E,w){return E==null?E:rS(E,ui(w,3),Kn)},ve.forOwn=function(E,w){return E&&zu(E,ui(w,3))},ve.forOwnRight=function(E,w){return E&&sS(E,ui(w,3))},ve.get=Oi,ve.gt=Fh,ve.gte=jR,ve.has=function(E,w){return E!=null&&Qp(E,w,eg)},ve.hasIn=Di,ve.head=fg,ve.identity=_s,ve.includes=function(E,w,F,ee){E=yo(E)?E:fr(E),F=F&&!ee?xe(F):0;var ue=E.length;return F<0&&(F=Ms(ue+F,0)),oe(E)?F<=ue&&E.indexOf(w,F)>-1:!!ue&&wf(E,w,F)>-1},ve.indexOf=function(E,w,F){var ee=E==null?0:E.length;if(!ee)return-1;var ue=F==null?0:xe(F);return ue<0&&(ue=Ms(ee+ue,0)),wf(E,w,ue)},ve.inRange=function(E,w,F){return w=Ie(w),F===u?(F=w,w=0):F=Ie(F),function(ee,ue,Ae){return ee>=na(ue,Ae)&&ee<Ms(ue,Ae)}(E=At(E),w,F)},ve.invoke=hi,ve.isArguments=qr,ve.isArray=ei,ve.isArrayBuffer=Dx,ve.isArrayLike=yo,ve.isArrayLikeObject=Fs,ve.isBoolean=function(E){return E===!0||E===!1||L(E)&&ba(E)==U},ve.isBuffer=Uf,ve.isDate=vg,ve.isElement=function(E){return L(E)&&E.nodeType===1&&!ne(E)},ve.isEmpty=function(E){if(E==null)return!0;if(yo(E)&&(ei(E)||typeof E=="string"||typeof E.splice=="function"||Uf(E)||me(E)||qr(E)))return!E.length;var w=Ka(E);if(w==te||w==ae)return!E.size;if(fv(E))return!oS(E).length;for(var F in E)if(Mr.call(E,F))return!1;return!0},ve.isEqual=function(E,w){return lr(E,w)},ve.isEqualWith=function(E,w,F){var ee=(F=typeof F=="function"?F:u)?F(E,w):u;return ee===u?lr(E,w,u,F):!!ee},ve.isError=RS,ve.isFinite=function(E){return typeof E=="number"&&Na(E)},ve.isFunction=N,ve.isInteger=T,ve.isLength=A,ve.isMap=B,ve.isMatch=function(E,w){return E===w||ev(E,w,ii(w))},ve.isMatchWith=function(E,w,F){return F=typeof F=="function"?F:u,ev(E,w,ii(w),F)},ve.isNaN=function(E){return H(E)&&E!=+E},ve.isNative=function(E){if(IR(E))throw new Hi("Unsupported core-js use. Try https://npms.io/search?q=ponyfill.");return Ex(E)},ve.isNil=function(E){return E==null},ve.isNull=function(E){return E===null},ve.isNumber=H,ve.isObject=O,ve.isObjectLike=L,ve.isPlainObject=ne,ve.isRegExp=se,ve.isSafeInteger=function(E){return T(E)&&E>=-9007199254740991&&E<=x},ve.isSet=Z,ve.isString=oe,ve.isSymbol=de,ve.isTypedArray=me,ve.isUndefined=function(E){return E===u},ve.isWeakMap=function(E){return L(E)&&Ka(E)==Fe},ve.isWeakSet=function(E){return L(E)&&ba(E)=="[object WeakSet]"},ve.join=function(E,w){return E==null?"":tS.call(E,w)},ve.kebabCase=ia,ve.last=Bo,ve.lastIndexOf=function(E,w,F){var ee=E==null?0:E.length;if(!ee)return-1;var ue=ee;return F!==u&&(ue=(ue=xe(F))<0?Ms(ee+ue,0):na(ue,ee-1)),w==w?function(Ae,Ue,Ge){for(var ot=Ge+1;ot--;)if(Ae[ot]===Ue)return ot;return ot}(E,w,ue):xf(E,XE,ue,!0)},ve.lowerCase=Sa,ve.lowerFirst=Cs,ve.lt=Pe,ve.lte=Xe,ve.max=function(E){return E&&E.length?Jm(E,_s,Gr):u},ve.maxBy=function(E,w){return E&&E.length?Jm(E,ui(w,2),Gr):u},ve.mean=function(E){return ZE(E,_s)},ve.meanBy=function(E,w){return ZE(E,ui(w,2))},ve.min=function(E){return E&&E.length?Jm(E,_s,dy):u},ve.minBy=function(E,w){return E&&E.length?Jm(E,ui(w,2),dy):u},ve.stubArray=Bd,ve.stubFalse=jh,ve.stubObject=function(){return{}},ve.stubString=function(){return""},ve.stubTrue=function(){return!0},ve.multiply=Xr,ve.nth=function(E,w){return E&&E.length?iv(E,xe(w)):u},ve.noConflict=function(){return Sn._===this&&(Sn._=oy),this},ve.noop=bo,ve.now=ka,ve.pad=function(E,w,F){E=Nt(E);var ee=(w=xe(w))?Oa(E):0;if(!w||ee>=w)return E;var ue=(w-ee)/2;return ru(cl(ue),F)+E+ru(Lu(ue),F)},ve.padEnd=function(E,w,F){E=Nt(E);var ee=(w=xe(w))?Oa(E):0;return w&&ee<w?E+ru(w-ee,F):E},ve.padStart=function(E,w,F){E=Nt(E);var ee=(w=xe(w))?Oa(E):0;return w&&ee<w?ru(w-ee,F)+E:E},ve.parseInt=function(E,w,F){return F||w==null?w=0:w&&(w=+w),Cc(Nt(E).replace(le,""),w||0)},ve.random=function(E,w,F){if(F&&typeof F!="boolean"&&rc(E,w,F)&&(w=F=u),F===u&&(typeof w=="boolean"?(F=w,w=u):typeof E=="boolean"&&(F=E,E=u)),E===u&&w===u?(E=0,w=1):(E=Ie(E),w===u?(w=E,E=0):w=Ie(w)),E>w){var ee=E;E=w,w=ee}if(F||E%1||w%1){var ue=ko();return na(E+ue*(w-E+Ql("1e-"+((ue+"").length-1))),w)}return lS(E,w)},ve.reduce=function(E,w,F){var ee=ei(E)?ny:JE,ue=arguments.length<3;return ee(E,ui(w,4),F,ue,Pl)},ve.reduceRight=function(E,w,F){var ee=ei(E)?YE:JE,ue=arguments.length<3;return ee(E,ui(w,4),F,ue,Z0)},ve.repeat=function(E,w,F){return w=(F?rc(E,w,F):w===u)?1:xe(w),py(Nt(E),w)},ve.replace=function(){var E=arguments,w=Nt(E[0]);return E.length<3?w:w.replace(E[1],E[2])},ve.result=function(E,w,F){var ee=-1,ue=(w=Dh(w,E)).length;for(ue||(ue=1,E=u);++ee<ue;){var Ae=E==null?u:E[Ku(w[ee])];Ae===u&&(ee=ue,Ae=F),E=N(Ae)?Ae.call(E):Ae}return E},ve.round=Ev,ve.runInContext=ft,ve.sample=function(E){return(ei(E)?nu:sv)(E)},ve.size=function(E){if(E==null)return 0;if(yo(E))return oe(E)?Oa(E):E.length;var w=Ka(E);return w==te||w==ae?E.size:oS(E).length},ve.snakeCase=zs,ve.some=function(E,w,F){var ee=ei(E)?iy:Ih;return F&&rc(E,w,F)&&(w=u),ee(E,ui(w,3))},ve.sortedIndex=function(E,w){return $p(E,w)},ve.sortedIndexBy=function(E,w,F){return ig(E,w,ui(F,2))},ve.sortedIndexOf=function(E,w){var F=E==null?0:E.length;if(F){var ee=$p(E,w);if(ee<F&&Bs(E[ee],w))return ee}return-1},ve.sortedLastIndex=function(E,w){return $p(E,w,!0)},ve.sortedLastIndexBy=function(E,w,F){return ig(E,w,ui(F,2),!0)},ve.sortedLastIndexOf=function(E,w){if(E!=null&&E.length){var F=$p(E,w,!0)-1;if(Bs(E[F],w))return F}return-1},ve.startCase=pr,ve.startsWith=function(E,w,F){return E=Nt(E),F=F==null?0:Id(xe(F),0,E.length),w=ul(w),E.slice(F,F+w.length)==w},ve.subtract=Hh,ve.sum=function(E){return E&&E.length?Ch(E,_s):0},ve.sumBy=function(E,w){return E&&E.length?Ch(E,ui(w,2)):0},ve.template=function(E,w,F){var ee=ve.templateSettings;F&&rc(E,w,F)&&(w=u),E=Nt(E),w=Ei({},w,ee,Wu);var ue,Ae,Ue=Ei({},w.imports,ee.imports,Wu),Ge=An(Ue),ot=Ls(Ue,Ge),It=0,Dt=w.interpolate||at,Xt="__p += '",Pn=eu((w.escape||at).source+"|"+Dt.source+"|"+(Dt===et?Cn:at).source+"|"+(w.evaluate||at).source+"|$","g"),jn="//# sourceURL="+(Mr.call(w,"sourceURL")?(w.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++Jn+"]")+`
`;E.replace(Pn,function(en,_i,$t,Dn,cn,Bn){return $t||($t=Dn),Xt+=E.slice(It,Bn).replace(Mt,vx),_i&&(ue=!0,Xt+=`' +
__e(`+_i+`) +
'`),cn&&(Ae=!0,Xt+=`';
`+cn+`;
__p += '`),$t&&(Xt+=`' +
((__t = (`+$t+`)) == null ? '' : __t) +
'`),It=Bn+en.length,en}),Xt+=`';
`;var ri=Mr.call(w,"variable")&&w.variable;if(ri){if(tt.test(ri))throw new Hi("Invalid `variable` option passed into `_.template`")}else Xt=`with (obj) {
`+Xt+`
}
`;Xt=(Ae?Xt.replace(ze,""):Xt).replace(Le,"$1").replace(rt,"$1;"),Xt="function("+(ri||"obj")+`) {
`+(ri?"":`obj || (obj = {});
`)+"var __t, __p = ''"+(ue?", __e = _.escape":"")+(Ae?`, __j = Array.prototype.join;
function print() { __p += __j.call(arguments, '') }
`:`;
`)+Xt+`return __p
}`;var Lt=Or(function(){return va(Ge,jn+"return "+Xt).apply(u,ot)});if(Lt.source=Xt,RS(Lt))throw Lt;return Lt},ve.times=function(E,w){if((E=xe(E))<1||E>x)return[];var F=R,ee=na(E,R);w=ui(w),E-=R;for(var ue=Gm(ee,w);++F<E;)w(F);return ue},ve.toFinite=Ie,ve.toInteger=xe,ve.toLength=lt,ve.toLower=function(E){return Nt(E).toLowerCase()},ve.toNumber=At,ve.toSafeInteger=function(E){return E?Id(xe(E),-9007199254740991,x):E===0?E:0},ve.toString=Nt,ve.toUpper=function(E){return Nt(E).toUpperCase()},ve.trim=function(E,w,F){if((E=Nt(E))&&(F||w===u))return QE(E);if(!E||!(w=ul(w)))return E;var ee=ta(E),ue=ta(w);return mo(ee,mx(ee,ue),ga(ee,ue)+1).join("")},ve.trimEnd=function(E,w,F){if((E=Nt(E))&&(F||w===u))return E.slice(0,B0(E)+1);if(!E||!(w=ul(w)))return E;var ee=ta(E);return mo(ee,0,ga(ee,ta(w))+1).join("")},ve.trimStart=function(E,w,F){if((E=Nt(E))&&(F||w===u))return E.replace(le,"");if(!E||!(w=ul(w)))return E;var ee=ta(E);return mo(ee,mx(ee,ta(w))).join("")},ve.truncate=function(E,w){var F=30,ee="...";if(O(w)){var ue="separator"in w?w.separator:ue;F="length"in w?xe(w.length):F,ee="omission"in w?ul(w.omission):ee}var Ae=(E=Nt(E)).length;if(Cf(E)){var Ue=ta(E);Ae=Ue.length}if(F>=Ae)return E;var Ge=F-Oa(ee);if(Ge<1)return ee;var ot=Ue?mo(Ue,0,Ge).join(""):E.slice(0,Ge);if(ue===u)return ot+ee;if(Ue&&(Ge+=ot.length-Ge),se(ue)){if(E.slice(Ge).search(ue)){var It,Dt=ot;for(ue.global||(ue=eu(ue.source,Nt(je.exec(ue))+"g")),ue.lastIndex=0;It=ue.exec(Dt);)var Xt=It.index;ot=ot.slice(0,Xt===u?Ge:Xt)}}else if(E.indexOf(ul(ue),Ge)!=Ge){var Pn=ot.lastIndexOf(ue);Pn>-1&&(ot=ot.slice(0,Pn))}return ot+ee},ve.unescape=function(E){return(E=Nt(E))&&bt.test(E)?E.replace(dt,Ad):E},ve.uniqueId=function(E){var w=++z0;return Nt(E)+w},ve.upperCase=Pa,ve.upperFirst=ti,ve.each=SS,ve.eachRight=vv,ve.first=fg,Da(ve,(bv={},zu(ve,function(E,w){Mr.call(ve.prototype,w)||(bv[w]=E)}),bv),{chain:!1}),ve.VERSION="4.17.21",ec(["bind","bindKey","curry","curryRight","partial","partialRight"],function(E){ve[E].placeholder=ve}),ec(["drop","take"],function(E,w){Bi.prototype[E]=function(F){F=F===u?1:Ms(xe(F),0);var ee=this.__filtered__&&!w?new Bi(this):this.clone();return ee.__filtered__?ee.__takeCount__=na(F,ee.__takeCount__):ee.__views__.push({size:na(F,R),type:E+(ee.__dir__<0?"Right":"")}),ee},Bi.prototype[E+"Right"]=function(F){return this.reverse()[E](F).reverse()}}),ec(["filter","map","takeWhile"],function(E,w){var F=w+1,ee=F==1||F==3;Bi.prototype[E]=function(ue){var Ae=this.clone();return Ae.__iteratees__.push({iteratee:ui(ue,3),type:F}),Ae.__filtered__=Ae.__filtered__||ee,Ae}}),ec(["head","last"],function(E,w){var F="take"+(w?"Right":"");Bi.prototype[E]=function(){return this[F](1).value()[0]}}),ec(["initial","tail"],function(E,w){var F="drop"+(w?"":"Right");Bi.prototype[E]=function(){return this.__filtered__?new Bi(this):this[F](1)}}),Bi.prototype.compact=function(){return this.filter(_s)},Bi.prototype.find=function(E){return this.filter(E).head()},Bi.prototype.findLast=function(E){return this.reverse().find(E)},Bi.prototype.invokeMap=$i(function(E,w){return typeof E=="function"?new Bi(this):this.map(function(F){return Oc(F,E,w)})}),Bi.prototype.reject=function(E){return this.filter(cc(ui(E)))},Bi.prototype.slice=function(E,w){E=xe(E);var F=this;return F.__filtered__&&(E>0||w<0)?new Bi(F):(E<0?F=F.takeRight(-E):E&&(F=F.drop(E)),w!==u&&(F=(w=xe(w))<0?F.dropRight(-w):F.take(w-E)),F)},Bi.prototype.takeRightWhile=function(E){return this.reverse().takeWhile(E).reverse()},Bi.prototype.toArray=function(){return this.take(R)},zu(Bi.prototype,function(E,w){var F=/^(?:filter|find|map|reject)|While$/.test(w),ee=/^(?:head|last)$/.test(w),ue=ve[ee?"take"+(w=="last"?"Right":""):w],Ae=ee||/^find/.test(w);ue&&(ve.prototype[w]=function(){var Ue=this.__wrapped__,Ge=ee?[1]:arguments,ot=Ue instanceof Bi,It=Ge[0],Dt=ot||ei(Ue),Xt=function(_i){var $t=ue.apply(ve,wh([_i],Ge));return ee&&Pn?$t[0]:$t};Dt&&F&&typeof It=="function"&&It.length!=1&&(ot=Dt=!1);var Pn=this.__chain__,jn=!!this.__actions__.length,ri=Ae&&!Pn,Lt=ot&&!jn;if(!Ae&&Dt){Ue=Lt?Ue:new Bi(this);var en=E.apply(Ue,Ge);return en.__actions__.push({func:Uh,args:[Xt],thisArg:u}),new po(en,Pn)}return ri&&Lt?E.apply(this,Ge):(en=this.thru(Xt),ri?ee?en.value()[0]:en.value():en)})}),ec(["pop","push","shift","sort","splice","unshift"],function(E){var w=Wm[E],F=/^(?:push|sort|unshift)$/.test(E)?"tap":"thru",ee=/^(?:pop|shift)$/.test(E);ve.prototype[E]=function(){var ue=arguments;if(ee&&!this.__chain__){var Ae=this.value();return w.apply(ei(Ae)?Ae:[],ue)}return this[F](function(Ue){return w.apply(ei(Ue)?Ue:[],ue)})}}),zu(Bi.prototype,function(E,w){var F=ve[w];if(F){var ee=F.name+"";Mr.call(ya,ee)||(ya[ee]=[]),ya[ee].push({name:w,func:F})}}),ya[lv(u,2).name]=[{name:"wrapper",func:u}],Bi.prototype.clone=function(){var E=new Bi(this.__wrapped__);return E.__actions__=Nc(this.__actions__),E.__dir__=this.__dir__,E.__filtered__=this.__filtered__,E.__iteratees__=Nc(this.__iteratees__),E.__takeCount__=this.__takeCount__,E.__views__=Nc(this.__views__),E},Bi.prototype.reverse=function(){if(this.__filtered__){var E=new Bi(this);E.__dir__=-1,E.__filtered__=!0}else(E=this.clone()).__dir__*=-1;return E},Bi.prototype.value=function(){var E=this.__wrapped__.value(),w=this.__dir__,F=ei(E),ee=w<0,ue=F?E.length:0,Ae=function(Bn,ln,Vn){for(var Os=-1,js=Vn.length;++Os<js;){var kc=Vn[Os],Pr=kc.size;switch(kc.type){case"drop":Bn+=Pr;break;case"dropRight":ln-=Pr;break;case"take":ln=na(ln,Bn+Pr);break;case"takeRight":Bn=Ms(Bn,ln-Pr)}}return{start:Bn,end:ln}}(0,ue,this.__views__),Ue=Ae.start,Ge=Ae.end,ot=Ge-Ue,It=ee?Ge:Ue-1,Dt=this.__iteratees__,Xt=Dt.length,Pn=0,jn=na(ot,this.__takeCount__);if(!F||!ee&&ue==ot&&jn==ot)return rg(E,this.__actions__);var ri=[];e:for(;ot--&&Pn<jn;){for(var Lt=-1,en=E[It+=w];++Lt<Xt;){var _i=Dt[Lt],$t=_i.iteratee,Dn=_i.type,cn=$t(en);if(Dn==2)en=cn;else if(!cn){if(Dn==1)continue e;break e}}ri[Pn++]=en}return ri},ve.prototype.at=Ud,ve.prototype.chain=function(){return vo(this)},ve.prototype.commit=function(){return new po(this.value(),this.__chain__)},ve.prototype.next=function(){this.__values__===u&&(this.__values__=qe(this.value()));var E=this.__index__>=this.__values__.length;return{done:E,value:E?u:this.__values__[this.__index__++]}},ve.prototype.plant=function(E){for(var w,F=this;F instanceof Oh;){var ee=bS(F);ee.__index__=0,ee.__values__=u,w?ue.__wrapped__=ee:w=ee;var ue=ee;F=F.__wrapped__}return ue.__wrapped__=E,w},ve.prototype.reverse=function(){var E=this.__wrapped__;if(E instanceof Bi){var w=E;return this.__actions__.length&&(w=new Bi(this)),(w=w.reverse()).__actions__.push({func:Uh,args:[Sr],thisArg:u}),new po(w,this.__chain__)}return this.thru(Sr)},ve.prototype.toJSON=ve.prototype.valueOf=ve.prototype.value=function(){return rg(this.__wrapped__,this.__actions__)},ve.prototype.first=ve.prototype.head,Du&&(ve.prototype[Du]=function(){return this}),ve}();Sn._=jp,(l=(function(){return jp}).call(o,c,o,a))===u||(a.exports=l)}).call(this)},2492:(a,o,c)=>{var l=c(2980),u=c(1463)(function(h,d,f){l(h,d,f)});a.exports=u},5062:a=>{a.exports=function(){return!1}},9881:(a,o,c)=>{var l=c(8363),u=c(1704);a.exports=function(h){return l(h,u(h))}},6692:a=>{var o=a.exports={v:[{name:"version",reg:/^(\d*)$/}],o:[{name:"origin",reg:/^(\S*) (\d*) (\d*) (\S*) IP(\d) (\S*)/,names:["username","sessionId","sessionVersion","netType","ipVer","address"],format:"%s %s %d %s IP%d %s"}],s:[{name:"name"}],i:[{name:"description"}],u:[{name:"uri"}],e:[{name:"email"}],p:[{name:"phone"}],z:[{name:"timezones"}],r:[{name:"repeats"}],t:[{name:"timing",reg:/^(\d*) (\d*)/,names:["start","stop"],format:"%d %d"}],c:[{name:"connection",reg:/^IN IP(\d) (\S*)/,names:["version","ip"],format:"IN IP%d %s"}],b:[{push:"bandwidth",reg:/^(TIAS|AS|CT|RR|RS):(\d*)/,names:["type","limit"],format:"%s:%s"}],m:[{reg:/^(\w*) (\d*) ([\w/]*)(?: (.*))?/,names:["type","port","protocol","payloads"],format:"%s %d %s %s"}],a:[{push:"rtp",reg:/^rtpmap:(\d*) ([\w\-.]*)(?:\s*\/(\d*)(?:\s*\/(\S*))?)?/,names:["payload","codec","rate","encoding"],format:function(c){return c.encoding?"rtpmap:%d %s/%s/%s":c.rate?"rtpmap:%d %s/%s":"rtpmap:%d %s"}},{push:"fmtp",reg:/^fmtp:(\d*) ([\S| ]*)/,names:["payload","config"],format:"fmtp:%d %s"},{name:"control",reg:/^control:(.*)/,format:"control:%s"},{name:"rtcp",reg:/^rtcp:(\d*)(?: (\S*) IP(\d) (\S*))?/,names:["port","netType","ipVer","address"],format:function(c){return c.address!=null?"rtcp:%d %s IP%d %s":"rtcp:%d"}},{push:"rtcpFbTrrInt",reg:/^rtcp-fb:(\*|\d*) trr-int (\d*)/,names:["payload","value"],format:"rtcp-fb:%s trr-int %d"},{push:"rtcpFb",reg:/^rtcp-fb:(\*|\d*) ([\w-_]*)(?: ([\w-_]*))?/,names:["payload","type","subtype"],format:function(c){return c.subtype!=null?"rtcp-fb:%s %s %s":"rtcp-fb:%s %s"}},{push:"ext",reg:/^extmap:(\d+)(?:\/(\w+))?(?: (urn:ietf:params:rtp-hdrext:encrypt))? (\S*)(?: (\S*))?/,names:["value","direction","encrypt-uri","uri","config"],format:function(c){return"extmap:%d"+(c.direction?"/%s":"%v")+(c["encrypt-uri"]?" %s":"%v")+" %s"+(c.config?" %s":"")}},{name:"extmapAllowMixed",reg:/^(extmap-allow-mixed)/},{push:"crypto",reg:/^crypto:(\d*) ([\w_]*) (\S*)(?: (\S*))?/,names:["id","suite","config","sessionConfig"],format:function(c){return c.sessionConfig!=null?"crypto:%d %s %s %s":"crypto:%d %s %s"}},{name:"setup",reg:/^setup:(\w*)/,format:"setup:%s"},{name:"connectionType",reg:/^connection:(new|existing)/,format:"connection:%s"},{name:"mid",reg:/^mid:([^\s]*)/,format:"mid:%s"},{name:"msid",reg:/^msid:(.*)/,format:"msid:%s"},{name:"ptime",reg:/^ptime:(\d*(?:\.\d*)*)/,format:"ptime:%d"},{name:"maxptime",reg:/^maxptime:(\d*(?:\.\d*)*)/,format:"maxptime:%d"},{name:"direction",reg:/^(sendrecv|recvonly|sendonly|inactive)/},{name:"icelite",reg:/^(ice-lite)/},{name:"iceUfrag",reg:/^ice-ufrag:(\S*)/,format:"ice-ufrag:%s"},{name:"icePwd",reg:/^ice-pwd:(\S*)/,format:"ice-pwd:%s"},{name:"fingerprint",reg:/^fingerprint:(\S*) (\S*)/,names:["type","hash"],format:"fingerprint:%s %s"},{push:"candidates",reg:/^candidate:(\S*) (\d*) (\S*) (\d*) (\S*) (\d*) typ (\S*)(?: raddr (\S*) rport (\d*))?(?: tcptype (\S*))?(?: generation (\d*))?(?: network-id (\d*))?(?: network-cost (\d*))?/,names:["foundation","component","transport","priority","ip","port","type","raddr","rport","tcptype","generation","network-id","network-cost"],format:function(c){var l="candidate:%s %d %s %d %s %d typ %s";return l+=c.raddr!=null?" raddr %s rport %d":"%v%v",l+=c.tcptype!=null?" tcptype %s":"%v",c.generation!=null&&(l+=" generation %d"),l+=c["network-id"]!=null?" network-id %d":"%v",l+=c["network-cost"]!=null?" network-cost %d":"%v"}},{name:"endOfCandidates",reg:/^(end-of-candidates)/},{name:"remoteCandidates",reg:/^remote-candidates:(.*)/,format:"remote-candidates:%s"},{name:"iceOptions",reg:/^ice-options:(\S*)/,format:"ice-options:%s"},{push:"ssrcs",reg:/^ssrc:(\d*) ([\w_-]*)(?::(.*))?/,names:["id","attribute","value"],format:function(c){var l="ssrc:%d";return c.attribute!=null&&(l+=" %s",c.value!=null&&(l+=":%s")),l}},{push:"ssrcGroups",reg:/^ssrc-group:([\x21\x23\x24\x25\x26\x27\x2A\x2B\x2D\x2E\w]*) (.*)/,names:["semantics","ssrcs"],format:"ssrc-group:%s %s"},{name:"msidSemantic",reg:/^msid-semantic:\s?(\w*) (\S*)/,names:["semantic","token"],format:"msid-semantic: %s %s"},{push:"groups",reg:/^group:(\w*) (.*)/,names:["type","mids"],format:"group:%s %s"},{name:"rtcpMux",reg:/^(rtcp-mux)/},{name:"rtcpRsize",reg:/^(rtcp-rsize)/},{name:"sctpmap",reg:/^sctpmap:([\w_/]*) (\S*)(?: (\S*))?/,names:["sctpmapNumber","app","maxMessageSize"],format:function(c){return c.maxMessageSize!=null?"sctpmap:%s %s %s":"sctpmap:%s %s"}},{name:"xGoogleFlag",reg:/^x-google-flag:([^\s]*)/,format:"x-google-flag:%s"},{push:"rids",reg:/^rid:([\d\w]+) (\w+)(?: ([\S| ]*))?/,names:["id","direction","params"],format:function(c){return c.params?"rid:%s %s %s":"rid:%s %s"}},{push:"imageattrs",reg:new RegExp("^imageattr:(\\d+|\\*)[\\s\\t]+(send|recv)[\\s\\t]+(\\*|\\[\\S+\\](?:[\\s\\t]+\\[\\S+\\])*)(?:[\\s\\t]+(recv|send)[\\s\\t]+(\\*|\\[\\S+\\](?:[\\s\\t]+\\[\\S+\\])*))?"),names:["pt","dir1","attrs1","dir2","attrs2"],format:function(c){return"imageattr:%s %s %s"+(c.dir2?" %s %s":"")}},{name:"simulcast",reg:new RegExp("^simulcast:(send|recv) ([a-zA-Z0-9\\-_~;,]+)(?:\\s?(send|recv) ([a-zA-Z0-9\\-_~;,]+))?$"),names:["dir1","list1","dir2","list2"],format:function(c){return"simulcast:%s %s"+(c.dir2?" %s %s":"")}},{name:"simulcast_03",reg:/^simulcast:[\s\t]+([\S+\s\t]+)$/,names:["value"],format:"simulcast: %s"},{name:"framerate",reg:/^framerate:(\d+(?:$|\.\d+))/,format:"framerate:%s"},{name:"sourceFilter",reg:/^source-filter: *(excl|incl) (\S*) (IP4|IP6|\*) (\S*) (.*)/,names:["filterMode","netType","addressTypes","destAddress","srcList"],format:"source-filter: %s %s %s %s %s"},{name:"bundleOnly",reg:/^(bundle-only)/},{name:"label",reg:/^label:(.+)/,format:"label:%s"},{name:"sctpPort",reg:/^sctp-port:(\d+)$/,format:"sctp-port:%s"},{name:"maxMessageSize",reg:/^max-message-size:(\d+)$/,format:"max-message-size:%s"},{push:"tsRefClocks",reg:/^ts-refclk:([^\s=]*)(?:=(\S*))?/,names:["clksrc","clksrcExt"],format:function(c){return"ts-refclk:%s"+(c.clksrcExt!=null?"=%s":"")}},{name:"mediaClk",reg:/^mediaclk:(?:id=(\S*))? *([^\s=]*)(?:=(\S*))?(?: *rate=(\d+)\/(\d+))?/,names:["id","mediaClockName","mediaClockValue","rateNumerator","rateDenominator"],format:function(c){var l="mediaclk:";return l+=c.id!=null?"id=%s %s":"%v%s",l+=c.mediaClockValue!=null?"=%s":"",l+=c.rateNumerator!=null?" rate=%s":"",l+=c.rateDenominator!=null?"/%s":""}},{name:"keywords",reg:/^keywds:(.+)$/,format:"keywds:%s"},{name:"content",reg:/^content:(.+)/,format:"content:%s"},{name:"bfcpFloorCtrl",reg:/^floorctrl:(c-only|s-only|c-s)/,format:"floorctrl:%s"},{name:"bfcpConfId",reg:/^confid:(\d+)/,format:"confid:%s"},{name:"bfcpUserId",reg:/^userid:(\d+)/,format:"userid:%s"},{name:"bfcpFloorId",reg:/^floorid:(.+) (?:m-stream|mstrm):(.+)/,names:["id","mStream"],format:"floorid:%s mstrm:%s"},{push:"invalid",names:["value"]}]};Object.keys(o).forEach(function(c){o[c].forEach(function(l){l.reg||(l.reg=/(.*)/),l.format||(l.format="%s")})})},766:(a,o,c)=>{var l=c(962),u=c(8627);o.cW=u,o.Qc=l.parse,o.rz=l.parseParams,l.parseFmtpConfig,l.parsePayloads,l.parseRemoteCandidates,l.parseImageAttributes,l.parseSimulcastStreamList},962:(a,o,c)=>{var l=function(p){return String(Number(p))===p?Number(p):p},u=function(p,g,_){var v=p.name&&p.names;p.push&&!g[p.push]?g[p.push]=[]:v&&!g[p.name]&&(g[p.name]={});var b=p.push?{}:v?g[p.name]:g;(function(S,x,M,R){if(R&&!M)x[R]=l(S[1]);else for(var I=0;I<M.length;I+=1)S[I+1]!=null&&(x[M[I]]=l(S[I+1]))})(_.match(p.reg),b,p.names,p.name),p.push&&g[p.push].push(b)},h=c(6692),d=RegExp.prototype.test.bind(/^([a-z])=(.*)/);o.parse=function(p){var g={},_=[],v=g;return p.split(/(\r\n|\r|\n)/).filter(d).forEach(function(b){var S=b[0],x=b.slice(2);S==="m"&&(_.push({rtp:[],fmtp:[]}),v=_[_.length-1]);for(var M=0;M<(h[S]||[]).length;M+=1){var R=h[S][M];if(R.reg.test(x))return u(R,v,x)}}),g.media=_,g};var f=function(p,g){var _=g.split(/=(.+)/,2);return _.length===2?p[_[0]]=l(_[1]):_.length===1&&g.length>1&&(p[_[0]]=void 0),p};o.parseParams=function(p){return p.split(/;\s?/).reduce(f,{})},o.parseFmtpConfig=o.parseParams,o.parsePayloads=function(p){return p.toString().split(" ").map(Number)},o.parseRemoteCandidates=function(p){for(var g=[],_=p.split(" ").map(l),v=0;v<_.length;v+=3)g.push({component:_[v],ip:_[v+1],port:_[v+2]});return g},o.parseImageAttributes=function(p){return p.split(" ").map(function(g){return g.substring(1,g.length-1).split(",").reduce(f,{})})},o.parseSimulcastStreamList=function(p){return p.split(";").map(function(g){return g.split(",").map(function(_){var v,b=!1;return _[0]!=="~"?v=l(_):(v=l(_.substring(1,_.length)),b=!0),{scid:v,paused:b}})})}},8627:(a,o,c)=>{var l=c(6692),u=/%[sdv%]/g,h=function(g){var _=1,v=arguments,b=v.length;return g.replace(u,function(S){if(_>=b)return S;var x=v[_];switch(_+=1,S){case"%%":return"%";case"%s":return String(x);case"%d":return Number(x);case"%v":return""}})},d=function(g,_,v){var b=[g+"="+(_.format instanceof Function?_.format(_.push?v:v[_.name]):_.format)];if(_.names)for(var S=0;S<_.names.length;S+=1){var x=_.names[S];_.name?b.push(v[_.name][x]):b.push(v[_.names[S]])}else b.push(v[_.name]);return h.apply(null,b)},f=["v","o","s","i","u","e","p","c","b","t","r","z","a"],p=["i","c","b","a"];a.exports=function(g,_){_=_||{},g.version==null&&(g.version=0),g.name==null&&(g.name=" "),g.media.forEach(function(x){x.payloads==null&&(x.payloads="")});var v=_.outerOrder||f,b=_.innerOrder||p,S=[];return v.forEach(function(x){l[x].forEach(function(M){M.name in g&&g[M.name]!=null?S.push(d(x,M,g)):M.push in g&&g[M.push]!=null&&g[M.push].forEach(function(R){S.push(d(x,M,R))})})}),g.media.forEach(function(x){S.push(d("m",l.m[0],x)),b.forEach(function(M){l[M].forEach(function(R){R.name in x&&x[R.name]!=null?S.push(d(M,R,x)):R.push in x&&x[R.push]!=null&&x[R.push].forEach(function(I){S.push(d(M,R,I))})})})}),S.join(`\r
`)+`\r
`}},7539:a=>{const o={generateIdentifier:function(){return Math.random().toString(36).substring(2,12)}};o.localCName=o.generateIdentifier(),o.splitLines=function(c){return c.trim().split(`
`).map(l=>l.trim())},o.splitSections=function(c){return c.split(`
m=`).map((l,u)=>(u>0?"m="+l:l).trim()+`\r
`)},o.getDescription=function(c){const l=o.splitSections(c);return l&&l[0]},o.getMediaSections=function(c){const l=o.splitSections(c);return l.shift(),l},o.matchPrefix=function(c,l){return o.splitLines(c).filter(u=>u.indexOf(l)===0)},o.parseCandidate=function(c){let l;l=c.indexOf("a=candidate:")===0?c.substring(12).split(" "):c.substring(10).split(" ");const u={foundation:l[0],component:{1:"rtp",2:"rtcp"}[l[1]]||l[1],protocol:l[2].toLowerCase(),priority:parseInt(l[3],10),ip:l[4],address:l[4],port:parseInt(l[5],10),type:l[7]};for(let h=8;h<l.length;h+=2)switch(l[h]){case"raddr":u.relatedAddress=l[h+1];break;case"rport":u.relatedPort=parseInt(l[h+1],10);break;case"tcptype":u.tcpType=l[h+1];break;case"ufrag":u.ufrag=l[h+1],u.usernameFragment=l[h+1];break;default:u[l[h]]===void 0&&(u[l[h]]=l[h+1])}return u},o.writeCandidate=function(c){const l=[];l.push(c.foundation);const u=c.component;u==="rtp"?l.push(1):u==="rtcp"?l.push(2):l.push(u),l.push(c.protocol.toUpperCase()),l.push(c.priority),l.push(c.address||c.ip),l.push(c.port);const h=c.type;return l.push("typ"),l.push(h),h!=="host"&&c.relatedAddress&&c.relatedPort&&(l.push("raddr"),l.push(c.relatedAddress),l.push("rport"),l.push(c.relatedPort)),c.tcpType&&c.protocol.toLowerCase()==="tcp"&&(l.push("tcptype"),l.push(c.tcpType)),(c.usernameFragment||c.ufrag)&&(l.push("ufrag"),l.push(c.usernameFragment||c.ufrag)),"candidate:"+l.join(" ")},o.parseIceOptions=function(c){return c.substring(14).split(" ")},o.parseRtpMap=function(c){let l=c.substring(9).split(" ");const u={payloadType:parseInt(l.shift(),10)};return l=l[0].split("/"),u.name=l[0],u.clockRate=parseInt(l[1],10),u.channels=l.length===3?parseInt(l[2],10):1,u.numChannels=u.channels,u},o.writeRtpMap=function(c){let l=c.payloadType;c.preferredPayloadType!==void 0&&(l=c.preferredPayloadType);const u=c.channels||c.numChannels||1;return"a=rtpmap:"+l+" "+c.name+"/"+c.clockRate+(u!==1?"/"+u:"")+`\r
`},o.parseExtmap=function(c){const l=c.substring(9).split(" ");return{id:parseInt(l[0],10),direction:l[0].indexOf("/")>0?l[0].split("/")[1]:"sendrecv",uri:l[1],attributes:l.slice(2).join(" ")}},o.writeExtmap=function(c){return"a=extmap:"+(c.id||c.preferredId)+(c.direction&&c.direction!=="sendrecv"?"/"+c.direction:"")+" "+c.uri+(c.attributes?" "+c.attributes:"")+`\r
`},o.parseFmtp=function(c){const l={};let u;const h=c.substring(c.indexOf(" ")+1).split(";");for(let d=0;d<h.length;d++)u=h[d].trim().split("="),l[u[0].trim()]=u[1];return l},o.writeFmtp=function(c){let l="",u=c.payloadType;if(c.preferredPayloadType!==void 0&&(u=c.preferredPayloadType),c.parameters&&Object.keys(c.parameters).length){const h=[];Object.keys(c.parameters).forEach(d=>{c.parameters[d]!==void 0?h.push(d+"="+c.parameters[d]):h.push(d)}),l+="a=fmtp:"+u+" "+h.join(";")+`\r
`}return l},o.parseRtcpFb=function(c){const l=c.substring(c.indexOf(" ")+1).split(" ");return{type:l.shift(),parameter:l.join(" ")}},o.writeRtcpFb=function(c){let l="",u=c.payloadType;return c.preferredPayloadType!==void 0&&(u=c.preferredPayloadType),c.rtcpFeedback&&c.rtcpFeedback.length&&c.rtcpFeedback.forEach(h=>{l+="a=rtcp-fb:"+u+" "+h.type+(h.parameter&&h.parameter.length?" "+h.parameter:"")+`\r
`}),l},o.parseSsrcMedia=function(c){const l=c.indexOf(" "),u={ssrc:parseInt(c.substring(7,l),10)},h=c.indexOf(":",l);return h>-1?(u.attribute=c.substring(l+1,h),u.value=c.substring(h+1)):u.attribute=c.substring(l+1),u},o.parseSsrcGroup=function(c){const l=c.substring(13).split(" ");return{semantics:l.shift(),ssrcs:l.map(u=>parseInt(u,10))}},o.getMid=function(c){const l=o.matchPrefix(c,"a=mid:")[0];if(l)return l.substring(6)},o.parseFingerprint=function(c){const l=c.substring(14).split(" ");return{algorithm:l[0].toLowerCase(),value:l[1].toUpperCase()}},o.getDtlsParameters=function(c,l){return{role:"auto",fingerprints:o.matchPrefix(c+l,"a=fingerprint:").map(o.parseFingerprint)}},o.writeDtlsParameters=function(c,l){let u="a=setup:"+l+`\r
`;return c.fingerprints.forEach(h=>{u+="a=fingerprint:"+h.algorithm+" "+h.value+`\r
`}),u},o.parseCryptoLine=function(c){const l=c.substring(9).split(" ");return{tag:parseInt(l[0],10),cryptoSuite:l[1],keyParams:l[2],sessionParams:l.slice(3)}},o.writeCryptoLine=function(c){return"a=crypto:"+c.tag+" "+c.cryptoSuite+" "+(typeof c.keyParams=="object"?o.writeCryptoKeyParams(c.keyParams):c.keyParams)+(c.sessionParams?" "+c.sessionParams.join(" "):"")+`\r
`},o.parseCryptoKeyParams=function(c){if(c.indexOf("inline:")!==0)return null;const l=c.substring(7).split("|");return{keyMethod:"inline",keySalt:l[0],lifeTime:l[1],mkiValue:l[2]?l[2].split(":")[0]:void 0,mkiLength:l[2]?l[2].split(":")[1]:void 0}},o.writeCryptoKeyParams=function(c){return c.keyMethod+":"+c.keySalt+(c.lifeTime?"|"+c.lifeTime:"")+(c.mkiValue&&c.mkiLength?"|"+c.mkiValue+":"+c.mkiLength:"")},o.getCryptoParameters=function(c,l){return o.matchPrefix(c+l,"a=crypto:").map(o.parseCryptoLine)},o.getIceParameters=function(c,l){const u=o.matchPrefix(c+l,"a=ice-ufrag:")[0],h=o.matchPrefix(c+l,"a=ice-pwd:")[0];return u&&h?{usernameFragment:u.substring(12),password:h.substring(10)}:null},o.writeIceParameters=function(c){let l="a=ice-ufrag:"+c.usernameFragment+`\r
a=ice-pwd:`+c.password+`\r
`;return c.iceLite&&(l+=`a=ice-lite\r
`),l},o.parseRtpParameters=function(c){const l={codecs:[],headerExtensions:[],fecMechanisms:[],rtcp:[]},u=o.splitLines(c)[0].split(" ");l.profile=u[2];for(let d=3;d<u.length;d++){const f=u[d],p=o.matchPrefix(c,"a=rtpmap:"+f+" ")[0];if(p){const g=o.parseRtpMap(p),_=o.matchPrefix(c,"a=fmtp:"+f+" ");switch(g.parameters=_.length?o.parseFmtp(_[0]):{},g.rtcpFeedback=o.matchPrefix(c,"a=rtcp-fb:"+f+" ").map(o.parseRtcpFb),l.codecs.push(g),g.name.toUpperCase()){case"RED":case"ULPFEC":l.fecMechanisms.push(g.name.toUpperCase())}}}o.matchPrefix(c,"a=extmap:").forEach(d=>{l.headerExtensions.push(o.parseExtmap(d))});const h=o.matchPrefix(c,"a=rtcp-fb:* ").map(o.parseRtcpFb);return l.codecs.forEach(d=>{h.forEach(f=>{d.rtcpFeedback.find(p=>p.type===f.type&&p.parameter===f.parameter)||d.rtcpFeedback.push(f)})}),l},o.writeRtpDescription=function(c,l){let u="";u+="m="+c+" ",u+=l.codecs.length>0?"9":"0",u+=" "+(l.profile||"UDP/TLS/RTP/SAVPF")+" ",u+=l.codecs.map(d=>d.preferredPayloadType!==void 0?d.preferredPayloadType:d.payloadType).join(" ")+`\r
`,u+=`c=IN IP4 0.0.0.0\r
`,u+=`a=rtcp:9 IN IP4 0.0.0.0\r
`,l.codecs.forEach(d=>{u+=o.writeRtpMap(d),u+=o.writeFmtp(d),u+=o.writeRtcpFb(d)});let h=0;return l.codecs.forEach(d=>{d.maxptime>h&&(h=d.maxptime)}),h>0&&(u+="a=maxptime:"+h+`\r
`),l.headerExtensions&&l.headerExtensions.forEach(d=>{u+=o.writeExtmap(d)}),u},o.parseRtpEncodingParameters=function(c){const l=[],u=o.parseRtpParameters(c),h=u.fecMechanisms.indexOf("RED")!==-1,d=u.fecMechanisms.indexOf("ULPFEC")!==-1,f=o.matchPrefix(c,"a=ssrc:").map(b=>o.parseSsrcMedia(b)).filter(b=>b.attribute==="cname"),p=f.length>0&&f[0].ssrc;let g;const _=o.matchPrefix(c,"a=ssrc-group:FID").map(b=>b.substring(17).split(" ").map(S=>parseInt(S,10)));_.length>0&&_[0].length>1&&_[0][0]===p&&(g=_[0][1]),u.codecs.forEach(b=>{if(b.name.toUpperCase()==="RTX"&&b.parameters.apt){let S={ssrc:p,codecPayloadType:parseInt(b.parameters.apt,10)};p&&g&&(S.rtx={ssrc:g}),l.push(S),h&&(S=JSON.parse(JSON.stringify(S)),S.fec={ssrc:p,mechanism:d?"red+ulpfec":"red"},l.push(S))}}),l.length===0&&p&&l.push({ssrc:p});let v=o.matchPrefix(c,"b=");return v.length&&(v=v[0].indexOf("b=TIAS:")===0?parseInt(v[0].substring(7),10):v[0].indexOf("b=AS:")===0?1e3*parseInt(v[0].substring(5),10)*.95-16e3:void 0,l.forEach(b=>{b.maxBitrate=v})),l},o.parseRtcpParameters=function(c){const l={},u=o.matchPrefix(c,"a=ssrc:").map(f=>o.parseSsrcMedia(f)).filter(f=>f.attribute==="cname")[0];u&&(l.cname=u.value,l.ssrc=u.ssrc);const h=o.matchPrefix(c,"a=rtcp-rsize");l.reducedSize=h.length>0,l.compound=h.length===0;const d=o.matchPrefix(c,"a=rtcp-mux");return l.mux=d.length>0,l},o.writeRtcpParameters=function(c){let l="";return c.reducedSize&&(l+=`a=rtcp-rsize\r
`),c.mux&&(l+=`a=rtcp-mux\r
`),c.ssrc!==void 0&&c.cname&&(l+="a=ssrc:"+c.ssrc+" cname:"+c.cname+`\r
`),l},o.parseMsid=function(c){let l;const u=o.matchPrefix(c,"a=msid:");if(u.length===1)return l=u[0].substring(7).split(" "),{stream:l[0],track:l[1]};const h=o.matchPrefix(c,"a=ssrc:").map(d=>o.parseSsrcMedia(d)).filter(d=>d.attribute==="msid");return h.length>0?(l=h[0].value.split(" "),{stream:l[0],track:l[1]}):void 0},o.parseSctpDescription=function(c){const l=o.parseMLine(c),u=o.matchPrefix(c,"a=max-message-size:");let h;u.length>0&&(h=parseInt(u[0].substring(19),10)),isNaN(h)&&(h=65536);const d=o.matchPrefix(c,"a=sctp-port:");if(d.length>0)return{port:parseInt(d[0].substring(12),10),protocol:l.fmt,maxMessageSize:h};const f=o.matchPrefix(c,"a=sctpmap:");if(f.length>0){const p=f[0].substring(10).split(" ");return{port:parseInt(p[0],10),protocol:p[1],maxMessageSize:h}}},o.writeSctpDescription=function(c,l){let u=[];return u=c.protocol!=="DTLS/SCTP"?["m="+c.kind+" 9 "+c.protocol+" "+l.protocol+`\r
`,`c=IN IP4 0.0.0.0\r
`,"a=sctp-port:"+l.port+`\r
`]:["m="+c.kind+" 9 "+c.protocol+" "+l.port+`\r
`,`c=IN IP4 0.0.0.0\r
`,"a=sctpmap:"+l.port+" "+l.protocol+` 65535\r
`],l.maxMessageSize!==void 0&&u.push("a=max-message-size:"+l.maxMessageSize+`\r
`),u.join("")},o.generateSessionId=function(){return Math.random().toString().substr(2,22)},o.writeSessionBoilerplate=function(c,l,u){let h;const d=l!==void 0?l:2;return h=c||o.generateSessionId(),`v=0\r
o=`+(u||"thisisadapterortc")+" "+h+" "+d+` IN IP4 127.0.0.1\r
s=-\r
t=0 0\r
`},o.getDirection=function(c,l){const u=o.splitLines(c);for(let h=0;h<u.length;h++)switch(u[h]){case"a=sendrecv":case"a=sendonly":case"a=recvonly":case"a=inactive":return u[h].substring(2)}return l?o.getDirection(l):"sendrecv"},o.getKind=function(c){return o.splitLines(c)[0].split(" ")[0].substring(2)},o.isRejected=function(c){return c.split(" ",2)[1]==="0"},o.parseMLine=function(c){const l=o.splitLines(c)[0].substring(2).split(" ");return{kind:l[0],port:parseInt(l[1],10),protocol:l[2],fmt:l.slice(3).join(" ")}},o.parseOLine=function(c){const l=o.matchPrefix(c,"o=")[0].substring(2).split(" ");return{username:l[0],sessionId:l[1],sessionVersion:parseInt(l[2],10),netType:l[3],addressType:l[4],address:l[5]}},o.isValidSDP=function(c){if(typeof c!="string"||c.length===0)return!1;const l=o.splitLines(c);for(let u=0;u<l.length;u++)if(l[u].length<2||l[u].charAt(1)!=="=")return!1;return!0},a.exports=o},477:a=>{a.exports=function(o,c,l,u){var h=self||window;try{try{var d;try{d=new h.Blob([o])}catch{(d=new(h.BlobBuilder||h.WebKitBlobBuilder||h.MozBlobBuilder||h.MSBlobBuilder)).append(o),d=d.getBlob()}var f=h.URL||h.webkitURL,p=f.createObjectURL(d),g=new h[c](p,l);return f.revokeObjectURL(p),g}catch{return new h[c]("data:application/javascript,".concat(encodeURIComponent(o)),l)}}catch{if(!u)throw Error("Inline worker is not supported");return new h[c](u,l)}}},8520:(a,o,c)=>{var l;(function(u){(function(h){var d=typeof globalThis=="object"?globalThis:typeof c.g=="object"?c.g:typeof self=="object"?self:typeof this=="object"?this:function(){try{return Function("return this;")()}catch{}}()||function(){try{return(0,eval)("(function() { return this; })()")}catch{}}(),f=p(u);function p(g,_){return function(v,b){Object.defineProperty(g,v,{configurable:!0,writable:!0,value:b}),_&&_(v,b)}}d.Reflect!==void 0&&(f=p(d.Reflect,f)),function(g,_){var v=Object.prototype.hasOwnProperty,b=typeof Symbol=="function",S=b&&Symbol.toPrimitive!==void 0?Symbol.toPrimitive:"@@toPrimitive",x=b&&Symbol.iterator!==void 0?Symbol.iterator:"@@iterator",M=typeof Object.create=="function",R={__proto__:[]}instanceof Array,I=!M&&!R,k={create:M?function(){return on(Object.create(null))}:R?function(){return on({__proto__:null})}:function(){return on({})},has:I?function(Ve,at){return v.call(Ve,at)}:function(Ve,at){return at in Ve},get:I?function(Ve,at){return v.call(Ve,at)?Ve[at]:void 0}:function(Ve,at){return Ve[at]}},P=Object.getPrototypeOf(Function),U=typeof Map=="function"&&typeof Map.prototype.entries=="function"?Map:ht(),V=typeof Set=="function"&&typeof Set.prototype.entries=="function"?Set:Pt(),$=typeof WeakMap=="function"?WeakMap:hn(),q=b?Symbol.for("@reflect-metadata:registry"):void 0,Y=Tt(),te=Cn(Y);function G(Ve,at,Mt,Ot){if(Le(Mt)){if(!Et(Ve))throw new TypeError;if(!tn(at))throw new TypeError;return ge(Ve,at)}if(!Et(Ve))throw new TypeError;if(!pt(at))throw new TypeError;if(!pt(Ot)&&!Le(Ot)&&!rt(Ot))throw new TypeError;return rt(Ot)&&(Ot=void 0),_e(Ve,at,Mt=et(Mt),Ot)}function J(Ve,at){function Mt(Ot,Zn){if(!pt(Ot))throw new TypeError;if(!Le(Zn)&&!Ht(Zn))throw new TypeError;Se(Ve,at,Ot,Zn)}return Mt}function K(Ve,at,Mt,Ot){if(!pt(Mt))throw new TypeError;return Le(Ot)||(Ot=et(Ot)),Se(Ve,at,Mt,Ot)}function X(Ve,at,Mt){if(!pt(at))throw new TypeError;return Le(Mt)||(Mt=et(Mt)),ke(Ve,at,Mt)}function ae(Ve,at,Mt){if(!pt(at))throw new TypeError;return Le(Mt)||(Mt=et(Mt)),gt(Ve,at,Mt)}function ce(Ve,at,Mt){if(!pt(at))throw new TypeError;return Le(Mt)||(Mt=et(Mt)),wt(Ve,at,Mt)}function Me(Ve,at,Mt){if(!pt(at))throw new TypeError;return Le(Mt)||(Mt=et(Mt)),ye(Ve,at,Mt)}function Fe(Ve,at){if(!pt(Ve))throw new TypeError;return Le(at)||(at=et(at)),Qe(Ve,at)}function Te(Ve,at){if(!pt(Ve))throw new TypeError;return Le(at)||(at=et(at)),pe(Ve,at)}function Re(Ve,at,Mt){if(!pt(at))throw new TypeError;if(Le(Mt)||(Mt=et(Mt)),!pt(at))throw new TypeError;Le(Mt)||(Mt=et(Mt));var Ot=zt(at,Mt,!1);return!Le(Ot)&&Ot.OrdinaryDeleteMetadata(Ve,at,Mt)}function ge(Ve,at){for(var Mt=Ve.length-1;Mt>=0;--Mt){var Ot=(0,Ve[Mt])(at);if(!Le(Ot)&&!rt(Ot)){if(!tn(Ot))throw new TypeError;at=Ot}}return at}function _e(Ve,at,Mt,Ot){for(var Zn=Ve.length-1;Zn>=0;--Zn){var or=(0,Ve[Zn])(at,Mt,Ot);if(!Le(or)&&!rt(or)){if(!pt(or))throw new TypeError;Ot=or}}return Ot}function ke(Ve,at,Mt){if(gt(Ve,at,Mt))return!0;var Ot=Be(at);return!rt(Ot)&&ke(Ve,Ot,Mt)}function gt(Ve,at,Mt){var Ot=zt(at,Mt,!1);return!Le(Ot)&&he(Ot.OrdinaryHasOwnMetadata(Ve,at,Mt))}function wt(Ve,at,Mt){if(gt(Ve,at,Mt))return ye(Ve,at,Mt);var Ot=Be(at);return rt(Ot)?void 0:wt(Ve,Ot,Mt)}function ye(Ve,at,Mt){var Ot=zt(at,Mt,!1);if(!Le(Ot))return Ot.OrdinaryGetOwnMetadata(Ve,at,Mt)}function Se(Ve,at,Mt,Ot){zt(Mt,Ot,!0).OrdinaryDefineOwnMetadata(Ve,at,Mt,Ot)}function Qe(Ve,at){var Mt=pe(Ve,at),Ot=Be(Ve);if(Ot===null)return Mt;var Zn=Qe(Ot,at);if(Zn.length<=0)return Mt;if(Mt.length<=0)return Zn;for(var or=new V,wi=[],ai=0,xn=Mt;ai<xn.length;ai++){var sn=xn[ai];or.has(sn)||(or.add(sn),wi.push(sn))}for(var zn=0,Un=Zn;zn<Un.length;zn++)sn=Un[zn],or.has(sn)||(or.add(sn),wi.push(sn));return wi}function pe(Ve,at){var Mt=zt(Ve,at,!1);return Mt?Mt.OrdinaryOwnMetadataKeys(Ve,at):[]}function ze(Ve){if(Ve===null)return 1;switch(typeof Ve){case"undefined":return 0;case"boolean":return 2;case"string":return 3;case"symbol":return 4;case"number":return 5;case"object":return Ve===null?1:6;default:return 6}}function Le(Ve){return Ve===void 0}function rt(Ve){return Ve===null}function dt(Ve){return typeof Ve=="symbol"}function pt(Ve){return typeof Ve=="object"?Ve!==null:typeof Ve=="function"}function bt(Ve,at){switch(ze(Ve)){case 0:case 1:case 2:case 3:case 4:case 5:return Ve}var Mt="string",Ot=le(Ve,S);if(Ot!==void 0){var Zn=Ot.call(Ve,Mt);if(pt(Zn))throw new TypeError;return Zn}return we(Ve)}function we(Ve,at){var Mt,Ot;{var Zn=Ve.toString;if(ct(Zn)&&!pt(Ot=Zn.call(Ve))||ct(Mt=Ve.valueOf)&&!pt(Ot=Mt.call(Ve)))return Ot}throw new TypeError}function he(Ve){return!!Ve}function $e(Ve){return""+Ve}function et(Ve){var at=bt(Ve);return dt(at)?at:$e(at)}function Et(Ve){return Array.isArray?Array.isArray(Ve):Ve instanceof Object?Ve instanceof Array:Object.prototype.toString.call(Ve)==="[object Array]"}function ct(Ve){return typeof Ve=="function"}function tn(Ve){return typeof Ve=="function"}function Ht(Ve){switch(ze(Ve)){case 3:case 4:return!0;default:return!1}}function pn(Ve,at){return Ve===at||Ve!=Ve&&at!=at}function le(Ve,at){var Mt=Ve[at];if(Mt!=null){if(!ct(Mt))throw new TypeError;return Mt}}function z(Ve){var at=le(Ve,x);if(!ct(at))throw new TypeError;var Mt=at.call(Ve);if(!pt(Mt))throw new TypeError;return Mt}function W(Ve){return Ve.value}function fe(Ve){var at=Ve.next();return!at.done&&at}function Ne(Ve){var at=Ve.return;at&&at.call(Ve)}function Be(Ve){var at=Object.getPrototypeOf(Ve);if(typeof Ve!="function"||Ve===P||at!==P)return at;var Mt=Ve.prototype,Ot=Mt&&Object.getPrototypeOf(Mt);if(Ot==null||Ot===Object.prototype)return at;var Zn=Ot.constructor;return typeof Zn!="function"||Zn===Ve?at:Zn}function tt(){var Ve,at,Mt,Ot;Le(q)||_.Reflect===void 0||q in _.Reflect||typeof _.Reflect.defineMetadata!="function"||(Ve=je(_.Reflect));var Zn=new $,or={registerProvider:wi,getProvider:xn,setProvider:zn};return or;function wi(Un){if(!Object.isExtensible(or))throw new Error("Cannot add provider to a frozen registry.");switch(!0){case Ve===Un:break;case Le(at):at=Un;break;case at===Un:break;case Le(Mt):Mt=Un;break;case Mt===Un:break;default:Ot===void 0&&(Ot=new V),Ot.add(Un)}}function ai(Un,pi){if(!Le(at)){if(at.isProviderFor(Un,pi))return at;if(!Le(Mt)){if(Mt.isProviderFor(Un,pi))return at;if(!Le(Ot))for(var dr=z(Ot);;){var ni=fe(dr);if(!ni)return;var $a=W(ni);if($a.isProviderFor(Un,pi))return Ne(dr),$a}}}if(!Le(Ve)&&Ve.isProviderFor(Un,pi))return Ve}function xn(Un,pi){var dr,ni=Zn.get(Un);return Le(ni)||(dr=ni.get(pi)),Le(dr)&&(Le(dr=ai(Un,pi))||(Le(ni)&&(ni=new U,Zn.set(Un,ni)),ni.set(pi,dr))),dr}function sn(Un){if(Le(Un))throw new TypeError;return at===Un||Mt===Un||!Le(Ot)&&Ot.has(Un)}function zn(Un,pi,dr){if(!sn(dr))throw new Error("Metadata provider not registered.");var ni=xn(Un,pi);if(ni!==dr){if(!Le(ni))return!1;var $a=Zn.get(Un);Le($a)&&($a=new U,Zn.set(Un,$a)),$a.set(pi,dr)}return!0}}function Tt(){var Ve;return!Le(q)&&pt(_.Reflect)&&Object.isExtensible(_.Reflect)&&(Ve=_.Reflect[q]),Le(Ve)&&(Ve=tt()),!Le(q)&&pt(_.Reflect)&&Object.isExtensible(_.Reflect)&&Object.defineProperty(_.Reflect,q,{enumerable:!1,configurable:!1,writable:!1,value:Ve}),Ve}function Cn(Ve){var at=new $,Mt={isProviderFor:function(sn,zn){var Un=at.get(sn);return!Le(Un)&&Un.has(zn)},OrdinaryDefineOwnMetadata:wi,OrdinaryHasOwnMetadata:Zn,OrdinaryGetOwnMetadata:or,OrdinaryOwnMetadataKeys:ai,OrdinaryDeleteMetadata:xn};return Y.registerProvider(Mt),Mt;function Ot(sn,zn,Un){var pi=at.get(sn),dr=!1;if(Le(pi)){if(!Un)return;pi=new U,at.set(sn,pi),dr=!0}var ni=pi.get(zn);if(Le(ni)){if(!Un)return;if(ni=new U,pi.set(zn,ni),!Ve.setProvider(sn,zn,Mt))throw pi.delete(zn),dr&&at.delete(sn),new Error("Wrong provider for target.")}return ni}function Zn(sn,zn,Un){var pi=Ot(zn,Un,!1);return!Le(pi)&&he(pi.has(sn))}function or(sn,zn,Un){var pi=Ot(zn,Un,!1);if(!Le(pi))return pi.get(sn)}function wi(sn,zn,Un,pi){Ot(Un,pi,!0).set(sn,zn)}function ai(sn,zn){var Un=[],pi=Ot(sn,zn,!1);if(Le(pi))return Un;for(var dr=z(pi.keys()),ni=0;;){var $a=fe(dr);if(!$a)return Un.length=ni,Un;var Nu=W($a);try{Un[ni]=Nu}catch(Ef){try{Ne(dr)}finally{throw Ef}}ni++}}function xn(sn,zn,Un){var pi=Ot(zn,Un,!1);if(Le(pi)||!pi.delete(sn))return!1;if(pi.size===0){var dr=at.get(zn);Le(dr)||(dr.delete(Un),dr.size===0&&at.delete(dr))}return!0}}function je(Ve){var at=Ve.defineMetadata,Mt=Ve.hasOwnMetadata,Ot=Ve.getOwnMetadata,Zn=Ve.getOwnMetadataKeys,or=Ve.deleteMetadata,wi=new $;return{isProviderFor:function(ai,xn){var sn=wi.get(ai);return!(Le(sn)||!sn.has(xn))||!!Zn(ai,xn).length&&(Le(sn)&&(sn=new V,wi.set(ai,sn)),sn.add(xn),!0)},OrdinaryDefineOwnMetadata:at,OrdinaryHasOwnMetadata:Mt,OrdinaryGetOwnMetadata:Ot,OrdinaryOwnMetadataKeys:Zn,OrdinaryDeleteMetadata:or}}function zt(Ve,at,Mt){var Ot=Y.getProvider(Ve,at);if(!Le(Ot))return Ot;if(Mt){if(Y.setProvider(Ve,at,te))return te;throw new Error("Illegal state.")}}function ht(){var Ve={},at=[],Mt=function(){function wi(ai,xn,sn){this._index=0,this._keys=ai,this._values=xn,this._selector=sn}return wi.prototype["@@iterator"]=function(){return this},wi.prototype[x]=function(){return this},wi.prototype.next=function(){var ai=this._index;if(ai>=0&&ai<this._keys.length){var xn=this._selector(this._keys[ai],this._values[ai]);return ai+1>=this._keys.length?(this._index=-1,this._keys=at,this._values=at):this._index++,{value:xn,done:!1}}return{value:void 0,done:!0}},wi.prototype.throw=function(ai){throw this._index>=0&&(this._index=-1,this._keys=at,this._values=at),ai},wi.prototype.return=function(ai){return this._index>=0&&(this._index=-1,this._keys=at,this._values=at),{value:ai,done:!0}},wi}();return function(){function wi(){this._keys=[],this._values=[],this._cacheKey=Ve,this._cacheIndex=-2}return Object.defineProperty(wi.prototype,"size",{get:function(){return this._keys.length},enumerable:!0,configurable:!0}),wi.prototype.has=function(ai){return this._find(ai,!1)>=0},wi.prototype.get=function(ai){var xn=this._find(ai,!1);return xn>=0?this._values[xn]:void 0},wi.prototype.set=function(ai,xn){var sn=this._find(ai,!0);return this._values[sn]=xn,this},wi.prototype.delete=function(ai){var xn=this._find(ai,!1);if(xn>=0){for(var sn=this._keys.length,zn=xn+1;zn<sn;zn++)this._keys[zn-1]=this._keys[zn],this._values[zn-1]=this._values[zn];return this._keys.length--,this._values.length--,pn(ai,this._cacheKey)&&(this._cacheKey=Ve,this._cacheIndex=-2),!0}return!1},wi.prototype.clear=function(){this._keys.length=0,this._values.length=0,this._cacheKey=Ve,this._cacheIndex=-2},wi.prototype.keys=function(){return new Mt(this._keys,this._values,Ot)},wi.prototype.values=function(){return new Mt(this._keys,this._values,Zn)},wi.prototype.entries=function(){return new Mt(this._keys,this._values,or)},wi.prototype["@@iterator"]=function(){return this.entries()},wi.prototype[x]=function(){return this.entries()},wi.prototype._find=function(ai,xn){if(!pn(this._cacheKey,ai)){this._cacheIndex=-1;for(var sn=0;sn<this._keys.length;sn++)if(pn(this._keys[sn],ai)){this._cacheIndex=sn;break}}return this._cacheIndex<0&&xn&&(this._cacheIndex=this._keys.length,this._keys.push(ai),this._values.push(void 0)),this._cacheIndex},wi}();function Ot(wi,ai){return wi}function Zn(wi,ai){return ai}function or(wi,ai){return[wi,ai]}}function Pt(){return function(){function Ve(){this._map=new U}return Object.defineProperty(Ve.prototype,"size",{get:function(){return this._map.size},enumerable:!0,configurable:!0}),Ve.prototype.has=function(at){return this._map.has(at)},Ve.prototype.add=function(at){return this._map.set(at,at),this},Ve.prototype.delete=function(at){return this._map.delete(at)},Ve.prototype.clear=function(){this._map.clear()},Ve.prototype.keys=function(){return this._map.keys()},Ve.prototype.values=function(){return this._map.keys()},Ve.prototype.entries=function(){return this._map.entries()},Ve.prototype["@@iterator"]=function(){return this.keys()},Ve.prototype[x]=function(){return this.keys()},Ve}()}function hn(){var Ve=16,at=k.create(),Mt=Ot();return function(){function xn(){this._key=Ot()}return xn.prototype.has=function(sn){var zn=Zn(sn,!1);return zn!==void 0&&k.has(zn,this._key)},xn.prototype.get=function(sn){var zn=Zn(sn,!1);return zn!==void 0?k.get(zn,this._key):void 0},xn.prototype.set=function(sn,zn){return Zn(sn,!0)[this._key]=zn,this},xn.prototype.delete=function(sn){var zn=Zn(sn,!1);return zn!==void 0&&delete zn[this._key]},xn.prototype.clear=function(){this._key=Ot()},xn}();function Ot(){var xn;do xn="@@WeakMap@@"+ai();while(k.has(at,xn));return at[xn]=!0,xn}function Zn(xn,sn){if(!v.call(xn,Mt)){if(!sn)return;Object.defineProperty(xn,Mt,{value:k.create()})}return xn[Mt]}function or(xn,sn){for(var zn=0;zn<sn;++zn)xn[zn]=255*Math.random()|0;return xn}function wi(xn){if(typeof Uint8Array=="function"){var sn=new Uint8Array(xn);return typeof crypto<"u"?crypto.getRandomValues(sn):typeof msCrypto<"u"?msCrypto.getRandomValues(sn):or(sn,xn),sn}return or(new Array(xn),xn)}function ai(){var xn=wi(Ve);xn[6]=79&xn[6]|64,xn[8]=191&xn[8]|128;for(var sn="",zn=0;zn<Ve;++zn){var Un=xn[zn];zn!==4&&zn!==6&&zn!==8||(sn+="-"),Un<16&&(sn+="0"),sn+=Un.toString(16).toLowerCase()}return sn}}function on(Ve){return Ve.__=void 0,delete Ve.__,Ve}g("decorate",G),g("metadata",J),g("defineMetadata",K),g("hasMetadata",X),g("hasOwnMetadata",ae),g("getMetadata",ce),g("getOwnMetadata",Me),g("getMetadataKeys",Fe),g("getOwnMetadataKeys",Te),g("deleteMetadata",Re)}(f,d),d.Reflect===void 0&&(d.Reflect=u)})()})(l||(l={}))}},i={};function r(a){var o=i[a];if(o!==void 0)return o.exports;var c=i[a]={id:a,loaded:!1,exports:{}};return n[a].call(c.exports,c,c.exports,r),c.loaded=!0,c.exports}r.n=a=>{var o=a&&a.__esModule?()=>a.default:()=>a;return r.d(o,{a:o}),o},r.d=(a,o)=>{for(var c in o)r.o(o,c)&&!r.o(a,c)&&Object.defineProperty(a,c,{enumerable:!0,get:o[c]})},r.g=function(){if(typeof globalThis=="object")return globalThis;try{return this||new Function("return this")()}catch{if(typeof window=="object")return window}}(),r.o=(a,o)=>Object.prototype.hasOwnProperty.call(a,o),r.r=a=>{typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(a,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(a,"__esModule",{value:!0})},r.nmd=a=>(a.paths=[],a.children||(a.children=[]),a);var s={};return(()=>{r.r(s),r.d(s,{BASIC_FULL_HD_LANDSCAPE:()=>Ci,BASIC_FULL_HD_PORTRAIT:()=>Hn,BASIC_LANDSCAPE:()=>Zi,BASIC_PORTRAIT:()=>Jn,BroadcastClientError:()=>Tt,BroadcastClientEvents:()=>Oa,ConnectionState:()=>st,Errors:()=>u,InitialLayerPreference:()=>iu,JitterBufferMinDelay:()=>Ys,LOG_LEVEL:()=>W,LocalStageStream:()=>TS,LocalStageStreamEvents:()=>Ud,LogLevels:()=>W,RemoteStageStream:()=>CS,RemoteStageStreamEvents:()=>vo,STANDARD_LANDSCAPE:()=>Jo,STANDARD_PORTRAIT:()=>Ql,Stage:()=>Uf,StageConnectionState:()=>ms,StageErrorCategory:()=>Ld,StageErrorCode:()=>Sr,StageEvents:()=>qr,StageLeftReason:()=>vg,StageParticipantPublishState:()=>Ks,StageParticipantSubscribeState:()=>ac,StageStream:()=>vv,StageStreamLayerSelectedReason:()=>Uh,StreamType:()=>Zt,SubscribeType:()=>Uo,__version:()=>V0,create:()=>Vr,default:()=>RS,isSupported:()=>z});var a={};r.r(a),r.d(a,{fixNegotiationNeeded:()=>X,shimAddTrackRemoveTrack:()=>J,shimAddTrackRemoveTrackWithNative:()=>G,shimGetDisplayMedia:()=>U,shimGetSendersWithDtmf:()=>q,shimGetStats:()=>Y,shimGetUserMedia:()=>P,shimMediaStream:()=>V,shimOnTrack:()=>$,shimPeerConnection:()=>K,shimSenderReceiverGetStats:()=>te});var o={};r.r(o),r.d(o,{shimAddTransceiver:()=>ke,shimCreateAnswer:()=>ye,shimCreateOffer:()=>wt,shimGetDisplayMedia:()=>ce,shimGetParameters:()=>gt,shimGetUserMedia:()=>ae,shimOnTrack:()=>Me,shimPeerConnection:()=>Fe,shimRTCDataChannel:()=>_e,shimReceiverGetStats:()=>Re,shimRemoveStream:()=>ge,shimSenderGetStats:()=>Te});var c={};r.r(c),r.d(c,{shimAudioContext:()=>bt,shimCallbacksAPI:()=>pe,shimConstraints:()=>Le,shimCreateOfferLegacy:()=>pt,shimGetUserMedia:()=>ze,shimLocalStreamsAPI:()=>Se,shimRTCIceServerUrls:()=>rt,shimRemoteStreamsAPI:()=>Qe,shimTrackEventTransceiver:()=>dt});var l={};r.r(l),r.d(l,{removeExtmapAllowMixed:()=>Ht,shimAddIceCandidateNullOrEmpty:()=>pn,shimConnectionState:()=>tn,shimMaxMessageSize:()=>Et,shimParameterlessSetLocalDescription:()=>le,shimRTCIceCandidate:()=>$e,shimRTCIceCandidateRelayProtocol:()=>et,shimSendThrowTypeError:()=>ct});var u={};r.r(u),r.d(u,{ADD_DEVICE_COMPOSITION_INDEX_MISSING_ERROR:()=>on,ADD_DEVICE_COMPOSITION_MISSING_ERROR:()=>hn,ADD_DEVICE_CONSTRAINTS_ERROR:()=>Mt,ADD_DEVICE_DEVICE_ERROR:()=>ht,ADD_DEVICE_NAME_EXISTS_ERROR:()=>Pt,ADD_DEVICE_NAME_MISSING_ERROR:()=>Ve,ADD_DEVICE_UNSUPPORTED:()=>at,BROADCAST_CONFIGURATION_ERROR:()=>dr,BROADCAST_ERROR:()=>Cn,CAMERA_ERROR:()=>je,CLIENT_INVALID_ERROR:()=>I0,EXCHANGE_POSITION_DEVICE_NOT_FOUND_ERROR:()=>xn,FAILED_TO_ADD_IMAGE_ERROR:()=>sn,INGEST_ENDPOINT_TYPE_ERROR:()=>$a,INGEST_ENDPOINT_URL_ERROR:()=>Nu,INPUT_ERROR:()=>zt,INVALID_STREAM_KEY:()=>pi,LOGGER_TYPE_ERROR:()=>Fp,LOG_LEVEL_TYPE_ERROR:()=>Ef,NETWORK_RECONNECT_CONFIGURATION_ERROR:()=>Sf,NETWORK_RECONNECT_CONFIGURATION_INVALID_TIMEOUT_ERROR:()=>Tf,PEER_CONNECTION_ERROR:()=>Un,PEER_SETUP_ERROR:()=>zn,REMOVE_DEVICE_NOT_FOUND_ERROR:()=>Ot,REMOVE_IMAGE_NOT_FOUND_ERROR:()=>Zn,STAGE_TOKEN_TYPE_ERROR:()=>Ee,STAGE_WHIP_OVERRIDE_ERROR:()=>We,STREAM_CONFIGURATION_ERROR:()=>ni,STREAM_KEY_INVALID_CHAR_ERROR:()=>Iu,UPDATE_VIDEO_DEVICE_COMPOSITION_INDEX_MISSING_ERROR:()=>wi,UPDATE_VIDEO_DEVICE_COMPOSITION_MISSING_ERROR:()=>or,UPDATE_VIDEO_DEVICE_COMPOSITION_NAME_NOT_FOUND_ERROR:()=>ai});var h={};r.r(h),r.d(h,{BASIC_FULL_HD_LANDSCAPE:()=>Ci,BASIC_FULL_HD_PORTRAIT:()=>Hn,BASIC_LANDSCAPE:()=>Zi,BASIC_PORTRAIT:()=>Jn,BroadcastClientError:()=>Tt,BroadcastClientEvents:()=>Oa,ConnectionState:()=>st,Errors:()=>u,LOG_LEVEL:()=>W,LogLevels:()=>W,STANDARD_LANDSCAPE:()=>Jo,STANDARD_PORTRAIT:()=>Ql,__version:()=>V0,create:()=>Vr,isSupported:()=>z});let d=!0,f=!0;function p(N,T,A){const O=N.match(T);return O&&O.length>=A&&parseInt(O[A],10)}function g(N,T,A){if(!N.RTCPeerConnection)return;const O=N.RTCPeerConnection.prototype,L=O.addEventListener;O.addEventListener=function(H,ne){if(H!==T)return L.apply(this,arguments);const se=Z=>{const oe=A(Z);oe&&(ne.handleEvent?ne.handleEvent(oe):ne(oe))};return this._eventMap=this._eventMap||{},this._eventMap[T]||(this._eventMap[T]=new Map),this._eventMap[T].set(ne,se),L.apply(this,[H,se])};const B=O.removeEventListener;O.removeEventListener=function(H,ne){if(H!==T||!this._eventMap||!this._eventMap[T])return B.apply(this,arguments);if(!this._eventMap[T].has(ne))return B.apply(this,arguments);const se=this._eventMap[T].get(ne);return this._eventMap[T].delete(ne),this._eventMap[T].size===0&&delete this._eventMap[T],Object.keys(this._eventMap).length===0&&delete this._eventMap,B.apply(this,[H,se])},Object.defineProperty(O,"on"+T,{get(){return this["_on"+T]},set(H){this["_on"+T]&&(this.removeEventListener(T,this["_on"+T]),delete this["_on"+T]),H&&this.addEventListener(T,this["_on"+T]=H)},enumerable:!0,configurable:!0})}function _(N){return typeof N!="boolean"?new Error("Argument type: "+typeof N+". Please use a boolean."):(d=N,N?"adapter.js logging disabled":"adapter.js logging enabled")}function v(N){return typeof N!="boolean"?new Error("Argument type: "+typeof N+". Please use a boolean."):(f=!N,"adapter.js deprecation warnings "+(N?"disabled":"enabled"))}function b(){if(typeof window=="object"){if(d)return;typeof console<"u"&&typeof console.log=="function"&&console.log.apply(console,arguments)}}function S(N,T){f&&console.warn(N+" is deprecated, please use "+T+" instead.")}function x(N){return Object.prototype.toString.call(N)==="[object Object]"}function M(N){return x(N)?Object.keys(N).reduce(function(T,A){const O=x(N[A]),L=O?M(N[A]):N[A],B=O&&!Object.keys(L).length;return L===void 0||B?T:Object.assign(T,{[A]:L})},{}):N}function R(N,T,A){T&&!A.has(T.id)&&(A.set(T.id,T),Object.keys(T).forEach(O=>{O.endsWith("Id")?R(N,N.get(T[O]),A):O.endsWith("Ids")&&T[O].forEach(L=>{R(N,N.get(L),A)})}))}function I(N,T,A){const O=A?"outbound-rtp":"inbound-rtp",L=new Map;if(T===null)return L;const B=[];return N.forEach(H=>{H.type==="track"&&H.trackIdentifier===T.id&&B.push(H)}),B.forEach(H=>{N.forEach(ne=>{ne.type===O&&ne.trackId===H.id&&R(N,ne,L)})}),L}const k=b;function P(N,T){const A=N&&N.navigator;if(!A.mediaDevices)return;const O=function(H){if(typeof H!="object"||H.mandatory||H.optional)return H;const ne={};return Object.keys(H).forEach(se=>{if(se==="require"||se==="advanced"||se==="mediaSource")return;const Z=typeof H[se]=="object"?H[se]:{ideal:H[se]};Z.exact!==void 0&&typeof Z.exact=="number"&&(Z.min=Z.max=Z.exact);const oe=function(de,me){return de?de+me.charAt(0).toUpperCase()+me.slice(1):me==="deviceId"?"sourceId":me};if(Z.ideal!==void 0){ne.optional=ne.optional||[];let de={};typeof Z.ideal=="number"?(de[oe("min",se)]=Z.ideal,ne.optional.push(de),de={},de[oe("max",se)]=Z.ideal,ne.optional.push(de)):(de[oe("",se)]=Z.ideal,ne.optional.push(de))}Z.exact!==void 0&&typeof Z.exact!="number"?(ne.mandatory=ne.mandatory||{},ne.mandatory[oe("",se)]=Z.exact):["min","max"].forEach(de=>{Z[de]!==void 0&&(ne.mandatory=ne.mandatory||{},ne.mandatory[oe(de,se)]=Z[de])})}),H.advanced&&(ne.optional=(ne.optional||[]).concat(H.advanced)),ne},L=function(H,ne){if(T.version>=61)return ne(H);if((H=JSON.parse(JSON.stringify(H)))&&typeof H.audio=="object"){const se=function(Z,oe,de){oe in Z&&!(de in Z)&&(Z[de]=Z[oe],delete Z[oe])};se((H=JSON.parse(JSON.stringify(H))).audio,"autoGainControl","googAutoGainControl"),se(H.audio,"noiseSuppression","googNoiseSuppression"),H.audio=O(H.audio)}if(H&&typeof H.video=="object"){let se=H.video.facingMode;se=se&&(typeof se=="object"?se:{ideal:se});const Z=T.version<66;if(se&&(se.exact==="user"||se.exact==="environment"||se.ideal==="user"||se.ideal==="environment")&&(!A.mediaDevices.getSupportedConstraints||!A.mediaDevices.getSupportedConstraints().facingMode||Z)){let oe;if(delete H.video.facingMode,se.exact==="environment"||se.ideal==="environment"?oe=["back","rear"]:se.exact!=="user"&&se.ideal!=="user"||(oe=["front"]),oe)return A.mediaDevices.enumerateDevices().then(de=>{let me=(de=de.filter(Pe=>Pe.kind==="videoinput")).find(Pe=>oe.some(Xe=>Pe.label.toLowerCase().includes(Xe)));return!me&&de.length&&oe.includes("back")&&(me=de[de.length-1]),me&&(H.video.deviceId=se.exact?{exact:me.deviceId}:{ideal:me.deviceId}),H.video=O(H.video),k("chrome: "+JSON.stringify(H)),ne(H)})}H.video=O(H.video)}return k("chrome: "+JSON.stringify(H)),ne(H)},B=function(H){return T.version>=64?H:{name:{PermissionDeniedError:"NotAllowedError",PermissionDismissedError:"NotAllowedError",InvalidStateError:"NotAllowedError",DevicesNotFoundError:"NotFoundError",ConstraintNotSatisfiedError:"OverconstrainedError",TrackStartError:"NotReadableError",MediaDeviceFailedDueToShutdown:"NotAllowedError",MediaDeviceKillSwitchOn:"NotAllowedError",TabCaptureError:"AbortError",ScreenCaptureError:"AbortError",DeviceCaptureError:"AbortError"}[H.name]||H.name,message:H.message,constraint:H.constraint||H.constraintName,toString(){return this.name+(this.message&&": ")+this.message}}};if(A.getUserMedia=(function(H,ne,se){L(H,Z=>{A.webkitGetUserMedia(Z,ne,oe=>{se&&se(B(oe))})})}).bind(A),A.mediaDevices.getUserMedia){const H=A.mediaDevices.getUserMedia.bind(A.mediaDevices);A.mediaDevices.getUserMedia=function(ne){return L(ne,se=>H(se).then(Z=>{if(se.audio&&!Z.getAudioTracks().length||se.video&&!Z.getVideoTracks().length)throw Z.getTracks().forEach(oe=>{oe.stop()}),new DOMException("","NotFoundError");return Z},Z=>Promise.reject(B(Z))))}}}function U(N,T){N.navigator.mediaDevices&&"getDisplayMedia"in N.navigator.mediaDevices||N.navigator.mediaDevices&&(typeof T=="function"?N.navigator.mediaDevices.getDisplayMedia=function(A){return T(A).then(O=>{const L=A.video&&A.video.width,B=A.video&&A.video.height,H=A.video&&A.video.frameRate;return A.video={mandatory:{chromeMediaSource:"desktop",chromeMediaSourceId:O,maxFrameRate:H||3}},L&&(A.video.mandatory.maxWidth=L),B&&(A.video.mandatory.maxHeight=B),N.navigator.mediaDevices.getUserMedia(A)})}:console.error("shimGetDisplayMedia: getSourceId argument is not a function"))}function V(N){N.MediaStream=N.MediaStream||N.webkitMediaStream}function $(N){if(typeof N=="object"&&N.RTCPeerConnection&&!("ontrack"in N.RTCPeerConnection.prototype)){Object.defineProperty(N.RTCPeerConnection.prototype,"ontrack",{get(){return this._ontrack},set(A){this._ontrack&&this.removeEventListener("track",this._ontrack),this.addEventListener("track",this._ontrack=A)},enumerable:!0,configurable:!0});const T=N.RTCPeerConnection.prototype.setRemoteDescription;N.RTCPeerConnection.prototype.setRemoteDescription=function(){return this._ontrackpoly||(this._ontrackpoly=A=>{A.stream.addEventListener("addtrack",O=>{let L;L=N.RTCPeerConnection.prototype.getReceivers?this.getReceivers().find(H=>H.track&&H.track.id===O.track.id):{track:O.track};const B=new Event("track");B.track=O.track,B.receiver=L,B.transceiver={receiver:L},B.streams=[A.stream],this.dispatchEvent(B)}),A.stream.getTracks().forEach(O=>{let L;L=N.RTCPeerConnection.prototype.getReceivers?this.getReceivers().find(H=>H.track&&H.track.id===O.id):{track:O};const B=new Event("track");B.track=O,B.receiver=L,B.transceiver={receiver:L},B.streams=[A.stream],this.dispatchEvent(B)})},this.addEventListener("addstream",this._ontrackpoly)),T.apply(this,arguments)}}else g(N,"track",T=>(T.transceiver||Object.defineProperty(T,"transceiver",{value:{receiver:T.receiver}}),T))}function q(N){if(typeof N=="object"&&N.RTCPeerConnection&&!("getSenders"in N.RTCPeerConnection.prototype)&&"createDTMFSender"in N.RTCPeerConnection.prototype){const T=function(L,B){return{track:B,get dtmf(){return this._dtmf===void 0&&(B.kind==="audio"?this._dtmf=L.createDTMFSender(B):this._dtmf=null),this._dtmf},_pc:L}};if(!N.RTCPeerConnection.prototype.getSenders){N.RTCPeerConnection.prototype.getSenders=function(){return this._senders=this._senders||[],this._senders.slice()};const L=N.RTCPeerConnection.prototype.addTrack;N.RTCPeerConnection.prototype.addTrack=function(H,ne){let se=L.apply(this,arguments);return se||(se=T(this,H),this._senders.push(se)),se};const B=N.RTCPeerConnection.prototype.removeTrack;N.RTCPeerConnection.prototype.removeTrack=function(H){B.apply(this,arguments);const ne=this._senders.indexOf(H);ne!==-1&&this._senders.splice(ne,1)}}const A=N.RTCPeerConnection.prototype.addStream;N.RTCPeerConnection.prototype.addStream=function(L){this._senders=this._senders||[],A.apply(this,[L]),L.getTracks().forEach(B=>{this._senders.push(T(this,B))})};const O=N.RTCPeerConnection.prototype.removeStream;N.RTCPeerConnection.prototype.removeStream=function(L){this._senders=this._senders||[],O.apply(this,[L]),L.getTracks().forEach(B=>{const H=this._senders.find(ne=>ne.track===B);H&&this._senders.splice(this._senders.indexOf(H),1)})}}else if(typeof N=="object"&&N.RTCPeerConnection&&"getSenders"in N.RTCPeerConnection.prototype&&"createDTMFSender"in N.RTCPeerConnection.prototype&&N.RTCRtpSender&&!("dtmf"in N.RTCRtpSender.prototype)){const T=N.RTCPeerConnection.prototype.getSenders;N.RTCPeerConnection.prototype.getSenders=function(){const A=T.apply(this,[]);return A.forEach(O=>O._pc=this),A},Object.defineProperty(N.RTCRtpSender.prototype,"dtmf",{get(){return this._dtmf===void 0&&(this.track.kind==="audio"?this._dtmf=this._pc.createDTMFSender(this.track):this._dtmf=null),this._dtmf}})}}function Y(N){if(!N.RTCPeerConnection)return;const T=N.RTCPeerConnection.prototype.getStats;N.RTCPeerConnection.prototype.getStats=function(){const[A,O,L]=arguments;if(arguments.length>0&&typeof A=="function")return T.apply(this,arguments);if(T.length===0&&(arguments.length===0||typeof A!="function"))return T.apply(this,[]);const B=function(ne){const se={};return ne.result().forEach(Z=>{const oe={id:Z.id,timestamp:Z.timestamp,type:{localcandidate:"local-candidate",remotecandidate:"remote-candidate"}[Z.type]||Z.type};Z.names().forEach(de=>{oe[de]=Z.stat(de)}),se[oe.id]=oe}),se},H=function(ne){return new Map(Object.keys(ne).map(se=>[se,ne[se]]))};if(arguments.length>=2){const ne=function(se){O(H(B(se)))};return T.apply(this,[ne,A])}return new Promise((ne,se)=>{T.apply(this,[function(Z){ne(H(B(Z)))},se])}).then(O,L)}}function te(N){if(!(typeof N=="object"&&N.RTCPeerConnection&&N.RTCRtpSender&&N.RTCRtpReceiver))return;if(!("getStats"in N.RTCRtpSender.prototype)){const A=N.RTCPeerConnection.prototype.getSenders;A&&(N.RTCPeerConnection.prototype.getSenders=function(){const L=A.apply(this,[]);return L.forEach(B=>B._pc=this),L});const O=N.RTCPeerConnection.prototype.addTrack;O&&(N.RTCPeerConnection.prototype.addTrack=function(){const L=O.apply(this,arguments);return L._pc=this,L}),N.RTCRtpSender.prototype.getStats=function(){const L=this;return this._pc.getStats().then(B=>I(B,L.track,!0))}}if(!("getStats"in N.RTCRtpReceiver.prototype)){const A=N.RTCPeerConnection.prototype.getReceivers;A&&(N.RTCPeerConnection.prototype.getReceivers=function(){const O=A.apply(this,[]);return O.forEach(L=>L._pc=this),O}),g(N,"track",O=>(O.receiver._pc=O.srcElement,O)),N.RTCRtpReceiver.prototype.getStats=function(){const O=this;return this._pc.getStats().then(L=>I(L,O.track,!1))}}if(!("getStats"in N.RTCRtpSender.prototype)||!("getStats"in N.RTCRtpReceiver.prototype))return;const T=N.RTCPeerConnection.prototype.getStats;N.RTCPeerConnection.prototype.getStats=function(){if(arguments.length>0&&arguments[0]instanceof N.MediaStreamTrack){const A=arguments[0];let O,L,B;return this.getSenders().forEach(H=>{H.track===A&&(O?B=!0:O=H)}),this.getReceivers().forEach(H=>(H.track===A&&(L?B=!0:L=H),H.track===A)),B||O&&L?Promise.reject(new DOMException("There are more than one sender or receiver for the track.","InvalidAccessError")):O?O.getStats():L?L.getStats():Promise.reject(new DOMException("There is no sender or receiver for the track.","InvalidAccessError"))}return T.apply(this,arguments)}}function G(N){N.RTCPeerConnection.prototype.getLocalStreams=function(){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},Object.keys(this._shimmedLocalStreams).map(B=>this._shimmedLocalStreams[B][0])};const T=N.RTCPeerConnection.prototype.addTrack;N.RTCPeerConnection.prototype.addTrack=function(B,H){if(!H)return T.apply(this,arguments);this._shimmedLocalStreams=this._shimmedLocalStreams||{};const ne=T.apply(this,arguments);return this._shimmedLocalStreams[H.id]?this._shimmedLocalStreams[H.id].indexOf(ne)===-1&&this._shimmedLocalStreams[H.id].push(ne):this._shimmedLocalStreams[H.id]=[H,ne],ne};const A=N.RTCPeerConnection.prototype.addStream;N.RTCPeerConnection.prototype.addStream=function(B){this._shimmedLocalStreams=this._shimmedLocalStreams||{},B.getTracks().forEach(se=>{if(this.getSenders().find(Z=>Z.track===se))throw new DOMException("Track already exists.","InvalidAccessError")});const H=this.getSenders();A.apply(this,arguments);const ne=this.getSenders().filter(se=>H.indexOf(se)===-1);this._shimmedLocalStreams[B.id]=[B].concat(ne)};const O=N.RTCPeerConnection.prototype.removeStream;N.RTCPeerConnection.prototype.removeStream=function(B){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},delete this._shimmedLocalStreams[B.id],O.apply(this,arguments)};const L=N.RTCPeerConnection.prototype.removeTrack;N.RTCPeerConnection.prototype.removeTrack=function(B){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},B&&Object.keys(this._shimmedLocalStreams).forEach(H=>{const ne=this._shimmedLocalStreams[H].indexOf(B);ne!==-1&&this._shimmedLocalStreams[H].splice(ne,1),this._shimmedLocalStreams[H].length===1&&delete this._shimmedLocalStreams[H]}),L.apply(this,arguments)}}function J(N,T){if(!N.RTCPeerConnection)return;if(N.RTCPeerConnection.prototype.addTrack&&T.version>=65)return G(N);const A=N.RTCPeerConnection.prototype.getLocalStreams;N.RTCPeerConnection.prototype.getLocalStreams=function(){const se=A.apply(this);return this._reverseStreams=this._reverseStreams||{},se.map(Z=>this._reverseStreams[Z.id])};const O=N.RTCPeerConnection.prototype.addStream;N.RTCPeerConnection.prototype.addStream=function(se){if(this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},se.getTracks().forEach(Z=>{if(this.getSenders().find(oe=>oe.track===Z))throw new DOMException("Track already exists.","InvalidAccessError")}),!this._reverseStreams[se.id]){const Z=new N.MediaStream(se.getTracks());this._streams[se.id]=Z,this._reverseStreams[Z.id]=se,se=Z}O.apply(this,[se])};const L=N.RTCPeerConnection.prototype.removeStream;function B(se,Z){let oe=Z.sdp;return Object.keys(se._reverseStreams||[]).forEach(de=>{const me=se._reverseStreams[de],Pe=se._streams[me.id];oe=oe.replace(new RegExp(Pe.id,"g"),me.id)}),new RTCSessionDescription({type:Z.type,sdp:oe})}N.RTCPeerConnection.prototype.removeStream=function(se){this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},L.apply(this,[this._streams[se.id]||se]),delete this._reverseStreams[this._streams[se.id]?this._streams[se.id].id:se.id],delete this._streams[se.id]},N.RTCPeerConnection.prototype.addTrack=function(se,Z){if(this.signalingState==="closed")throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");const oe=[].slice.call(arguments,1);if(oe.length!==1||!oe[0].getTracks().find(me=>me===se))throw new DOMException("The adapter.js addTrack polyfill only supports a single  stream which is associated with the specified track.","NotSupportedError");if(this.getSenders().find(me=>me.track===se))throw new DOMException("Track already exists.","InvalidAccessError");this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{};const de=this._streams[Z.id];if(de)de.addTrack(se),Promise.resolve().then(()=>{this.dispatchEvent(new Event("negotiationneeded"))});else{const me=new N.MediaStream([se]);this._streams[Z.id]=me,this._reverseStreams[me.id]=Z,this.addStream(me)}return this.getSenders().find(me=>me.track===se)},["createOffer","createAnswer"].forEach(function(se){const Z=N.RTCPeerConnection.prototype[se],oe={[se](){const de=arguments;return arguments.length&&typeof arguments[0]=="function"?Z.apply(this,[me=>{const Pe=B(this,me);de[0].apply(null,[Pe])},me=>{de[1]&&de[1].apply(null,me)},arguments[2]]):Z.apply(this,arguments).then(me=>B(this,me))}};N.RTCPeerConnection.prototype[se]=oe[se]});const H=N.RTCPeerConnection.prototype.setLocalDescription;N.RTCPeerConnection.prototype.setLocalDescription=function(){return arguments.length&&arguments[0].type?(arguments[0]=function(se,Z){let oe=Z.sdp;return Object.keys(se._reverseStreams||[]).forEach(de=>{const me=se._reverseStreams[de],Pe=se._streams[me.id];oe=oe.replace(new RegExp(me.id,"g"),Pe.id)}),new RTCSessionDescription({type:Z.type,sdp:oe})}(this,arguments[0]),H.apply(this,arguments)):H.apply(this,arguments)};const ne=Object.getOwnPropertyDescriptor(N.RTCPeerConnection.prototype,"localDescription");Object.defineProperty(N.RTCPeerConnection.prototype,"localDescription",{get(){const se=ne.get.apply(this);return se.type===""?se:B(this,se)}}),N.RTCPeerConnection.prototype.removeTrack=function(se){if(this.signalingState==="closed")throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");if(!se._pc)throw new DOMException("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.","TypeError");if(se._pc!==this)throw new DOMException("Sender was not created by this connection.","InvalidAccessError");let Z;this._streams=this._streams||{},Object.keys(this._streams).forEach(oe=>{this._streams[oe].getTracks().find(de=>se.track===de)&&(Z=this._streams[oe])}),Z&&(Z.getTracks().length===1?this.removeStream(this._reverseStreams[Z.id]):Z.removeTrack(se.track),this.dispatchEvent(new Event("negotiationneeded")))}}function K(N,T){!N.RTCPeerConnection&&N.webkitRTCPeerConnection&&(N.RTCPeerConnection=N.webkitRTCPeerConnection),N.RTCPeerConnection&&T.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(A){const O=N.RTCPeerConnection.prototype[A],L={[A](){return arguments[0]=new(A==="addIceCandidate"?N.RTCIceCandidate:N.RTCSessionDescription)(arguments[0]),O.apply(this,arguments)}};N.RTCPeerConnection.prototype[A]=L[A]})}function X(N,T){g(N,"negotiationneeded",A=>{const O=A.target;if(!(T.version<72||O.getConfiguration&&O.getConfiguration().sdpSemantics==="plan-b")||O.signalingState==="stable")return A})}function ae(N,T){const A=N&&N.navigator,O=N&&N.MediaStreamTrack;if(A.getUserMedia=function(L,B,H){S("navigator.getUserMedia","navigator.mediaDevices.getUserMedia"),A.mediaDevices.getUserMedia(L).then(B,H)},!(T.version>55&&"autoGainControl"in A.mediaDevices.getSupportedConstraints())){const L=function(H,ne,se){ne in H&&!(se in H)&&(H[se]=H[ne],delete H[ne])},B=A.mediaDevices.getUserMedia.bind(A.mediaDevices);if(A.mediaDevices.getUserMedia=function(H){return typeof H=="object"&&typeof H.audio=="object"&&(H=JSON.parse(JSON.stringify(H)),L(H.audio,"autoGainControl","mozAutoGainControl"),L(H.audio,"noiseSuppression","mozNoiseSuppression")),B(H)},O&&O.prototype.getSettings){const H=O.prototype.getSettings;O.prototype.getSettings=function(){const ne=H.apply(this,arguments);return L(ne,"mozAutoGainControl","autoGainControl"),L(ne,"mozNoiseSuppression","noiseSuppression"),ne}}if(O&&O.prototype.applyConstraints){const H=O.prototype.applyConstraints;O.prototype.applyConstraints=function(ne){return this.kind==="audio"&&typeof ne=="object"&&(ne=JSON.parse(JSON.stringify(ne)),L(ne,"autoGainControl","mozAutoGainControl"),L(ne,"noiseSuppression","mozNoiseSuppression")),H.apply(this,[ne])}}}}function ce(N,T){N.navigator.mediaDevices&&"getDisplayMedia"in N.navigator.mediaDevices||N.navigator.mediaDevices&&(N.navigator.mediaDevices.getDisplayMedia=function(A){if(!A||!A.video){const O=new DOMException("getDisplayMedia without video constraints is undefined");return O.name="NotFoundError",O.code=8,Promise.reject(O)}return A.video===!0?A.video={mediaSource:T}:A.video.mediaSource=T,N.navigator.mediaDevices.getUserMedia(A)})}function Me(N){typeof N=="object"&&N.RTCTrackEvent&&"receiver"in N.RTCTrackEvent.prototype&&!("transceiver"in N.RTCTrackEvent.prototype)&&Object.defineProperty(N.RTCTrackEvent.prototype,"transceiver",{get(){return{receiver:this.receiver}}})}function Fe(N,T){if(typeof N!="object"||!N.RTCPeerConnection&&!N.mozRTCPeerConnection)return;!N.RTCPeerConnection&&N.mozRTCPeerConnection&&(N.RTCPeerConnection=N.mozRTCPeerConnection),T.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(L){const B=N.RTCPeerConnection.prototype[L],H={[L](){return arguments[0]=new(L==="addIceCandidate"?N.RTCIceCandidate:N.RTCSessionDescription)(arguments[0]),B.apply(this,arguments)}};N.RTCPeerConnection.prototype[L]=H[L]});const A={inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"},O=N.RTCPeerConnection.prototype.getStats;N.RTCPeerConnection.prototype.getStats=function(){const[L,B,H]=arguments;return O.apply(this,[L||null]).then(ne=>{if(T.version<53&&!B)try{ne.forEach(se=>{se.type=A[se.type]||se.type})}catch(se){if(se.name!=="TypeError")throw se;ne.forEach((Z,oe)=>{ne.set(oe,Object.assign({},Z,{type:A[Z.type]||Z.type}))})}return ne}).then(B,H)}}function Te(N){if(typeof N!="object"||!N.RTCPeerConnection||!N.RTCRtpSender||N.RTCRtpSender&&"getStats"in N.RTCRtpSender.prototype)return;const T=N.RTCPeerConnection.prototype.getSenders;T&&(N.RTCPeerConnection.prototype.getSenders=function(){const O=T.apply(this,[]);return O.forEach(L=>L._pc=this),O});const A=N.RTCPeerConnection.prototype.addTrack;A&&(N.RTCPeerConnection.prototype.addTrack=function(){const O=A.apply(this,arguments);return O._pc=this,O}),N.RTCRtpSender.prototype.getStats=function(){return this.track?this._pc.getStats(this.track):Promise.resolve(new Map)}}function Re(N){if(typeof N!="object"||!N.RTCPeerConnection||!N.RTCRtpSender||N.RTCRtpSender&&"getStats"in N.RTCRtpReceiver.prototype)return;const T=N.RTCPeerConnection.prototype.getReceivers;T&&(N.RTCPeerConnection.prototype.getReceivers=function(){const A=T.apply(this,[]);return A.forEach(O=>O._pc=this),A}),g(N,"track",A=>(A.receiver._pc=A.srcElement,A)),N.RTCRtpReceiver.prototype.getStats=function(){return this._pc.getStats(this.track)}}function ge(N){N.RTCPeerConnection&&!("removeStream"in N.RTCPeerConnection.prototype)&&(N.RTCPeerConnection.prototype.removeStream=function(T){S("removeStream","removeTrack"),this.getSenders().forEach(A=>{A.track&&T.getTracks().includes(A.track)&&this.removeTrack(A)})})}function _e(N){N.DataChannel&&!N.RTCDataChannel&&(N.RTCDataChannel=N.DataChannel)}function ke(N){if(typeof N!="object"||!N.RTCPeerConnection)return;const T=N.RTCPeerConnection.prototype.addTransceiver;T&&(N.RTCPeerConnection.prototype.addTransceiver=function(){this.setParametersPromises=[];let A=arguments[1]&&arguments[1].sendEncodings;A===void 0&&(A=[]),A=[...A];const O=A.length>0;O&&A.forEach(B=>{if("rid"in B&&!/^[a-z0-9]{0,16}$/i.test(B.rid))throw new TypeError("Invalid RID value provided.");if("scaleResolutionDownBy"in B&&!(parseFloat(B.scaleResolutionDownBy)>=1))throw new RangeError("scale_resolution_down_by must be >= 1.0");if("maxFramerate"in B&&!(parseFloat(B.maxFramerate)>=0))throw new RangeError("max_framerate must be >= 0.0")});const L=T.apply(this,arguments);if(O){const{sender:B}=L,H=B.getParameters();(!("encodings"in H)||H.encodings.length===1&&Object.keys(H.encodings[0]).length===0)&&(H.encodings=A,B.sendEncodings=A,this.setParametersPromises.push(B.setParameters(H).then(()=>{delete B.sendEncodings}).catch(()=>{delete B.sendEncodings})))}return L})}function gt(N){if(typeof N!="object"||!N.RTCRtpSender)return;const T=N.RTCRtpSender.prototype.getParameters;T&&(N.RTCRtpSender.prototype.getParameters=function(){const A=T.apply(this,arguments);return"encodings"in A||(A.encodings=[].concat(this.sendEncodings||[{}])),A})}function wt(N){if(typeof N!="object"||!N.RTCPeerConnection)return;const T=N.RTCPeerConnection.prototype.createOffer;N.RTCPeerConnection.prototype.createOffer=function(){return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then(()=>T.apply(this,arguments)).finally(()=>{this.setParametersPromises=[]}):T.apply(this,arguments)}}function ye(N){if(typeof N!="object"||!N.RTCPeerConnection)return;const T=N.RTCPeerConnection.prototype.createAnswer;N.RTCPeerConnection.prototype.createAnswer=function(){return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then(()=>T.apply(this,arguments)).finally(()=>{this.setParametersPromises=[]}):T.apply(this,arguments)}}function Se(N){if(typeof N=="object"&&N.RTCPeerConnection){if("getLocalStreams"in N.RTCPeerConnection.prototype||(N.RTCPeerConnection.prototype.getLocalStreams=function(){return this._localStreams||(this._localStreams=[]),this._localStreams}),!("addStream"in N.RTCPeerConnection.prototype)){const T=N.RTCPeerConnection.prototype.addTrack;N.RTCPeerConnection.prototype.addStream=function(A){this._localStreams||(this._localStreams=[]),this._localStreams.includes(A)||this._localStreams.push(A),A.getAudioTracks().forEach(O=>T.call(this,O,A)),A.getVideoTracks().forEach(O=>T.call(this,O,A))},N.RTCPeerConnection.prototype.addTrack=function(A,...O){return O&&O.forEach(L=>{this._localStreams?this._localStreams.includes(L)||this._localStreams.push(L):this._localStreams=[L]}),T.apply(this,arguments)}}"removeStream"in N.RTCPeerConnection.prototype||(N.RTCPeerConnection.prototype.removeStream=function(T){this._localStreams||(this._localStreams=[]);const A=this._localStreams.indexOf(T);if(A===-1)return;this._localStreams.splice(A,1);const O=T.getTracks();this.getSenders().forEach(L=>{O.includes(L.track)&&this.removeTrack(L)})})}}function Qe(N){if(typeof N=="object"&&N.RTCPeerConnection&&("getRemoteStreams"in N.RTCPeerConnection.prototype||(N.RTCPeerConnection.prototype.getRemoteStreams=function(){return this._remoteStreams?this._remoteStreams:[]}),!("onaddstream"in N.RTCPeerConnection.prototype))){Object.defineProperty(N.RTCPeerConnection.prototype,"onaddstream",{get(){return this._onaddstream},set(A){this._onaddstream&&(this.removeEventListener("addstream",this._onaddstream),this.removeEventListener("track",this._onaddstreampoly)),this.addEventListener("addstream",this._onaddstream=A),this.addEventListener("track",this._onaddstreampoly=O=>{O.streams.forEach(L=>{if(this._remoteStreams||(this._remoteStreams=[]),this._remoteStreams.includes(L))return;this._remoteStreams.push(L);const B=new Event("addstream");B.stream=L,this.dispatchEvent(B)})})}});const T=N.RTCPeerConnection.prototype.setRemoteDescription;N.RTCPeerConnection.prototype.setRemoteDescription=function(){const A=this;return this._onaddstreampoly||this.addEventListener("track",this._onaddstreampoly=function(O){O.streams.forEach(L=>{if(A._remoteStreams||(A._remoteStreams=[]),A._remoteStreams.indexOf(L)>=0)return;A._remoteStreams.push(L);const B=new Event("addstream");B.stream=L,A.dispatchEvent(B)})}),T.apply(A,arguments)}}}function pe(N){if(typeof N!="object"||!N.RTCPeerConnection)return;const T=N.RTCPeerConnection.prototype,A=T.createOffer,O=T.createAnswer,L=T.setLocalDescription,B=T.setRemoteDescription,H=T.addIceCandidate;T.createOffer=function(se,Z){const oe=arguments.length>=2?arguments[2]:arguments[0],de=A.apply(this,[oe]);return Z?(de.then(se,Z),Promise.resolve()):de},T.createAnswer=function(se,Z){const oe=arguments.length>=2?arguments[2]:arguments[0],de=O.apply(this,[oe]);return Z?(de.then(se,Z),Promise.resolve()):de};let ne=function(se,Z,oe){const de=L.apply(this,[se]);return oe?(de.then(Z,oe),Promise.resolve()):de};T.setLocalDescription=ne,ne=function(se,Z,oe){const de=B.apply(this,[se]);return oe?(de.then(Z,oe),Promise.resolve()):de},T.setRemoteDescription=ne,ne=function(se,Z,oe){const de=H.apply(this,[se]);return oe?(de.then(Z,oe),Promise.resolve()):de},T.addIceCandidate=ne}function ze(N){const T=N&&N.navigator;if(T.mediaDevices&&T.mediaDevices.getUserMedia){const A=T.mediaDevices,O=A.getUserMedia.bind(A);T.mediaDevices.getUserMedia=L=>O(Le(L))}!T.getUserMedia&&T.mediaDevices&&T.mediaDevices.getUserMedia&&(T.getUserMedia=(function(A,O,L){T.mediaDevices.getUserMedia(A).then(O,L)}).bind(T))}function Le(N){return N&&N.video!==void 0?Object.assign({},N,{video:M(N.video)}):N}function rt(N){if(!N.RTCPeerConnection)return;const T=N.RTCPeerConnection;N.RTCPeerConnection=function(A,O){if(A&&A.iceServers){const L=[];for(let B=0;B<A.iceServers.length;B++){let H=A.iceServers[B];H.urls===void 0&&H.url?(S("RTCIceServer.url","RTCIceServer.urls"),H=JSON.parse(JSON.stringify(H)),H.urls=H.url,delete H.url,L.push(H)):L.push(A.iceServers[B])}A.iceServers=L}return new T(A,O)},N.RTCPeerConnection.prototype=T.prototype,"generateCertificate"in T&&Object.defineProperty(N.RTCPeerConnection,"generateCertificate",{get:()=>T.generateCertificate})}function dt(N){typeof N=="object"&&N.RTCTrackEvent&&"receiver"in N.RTCTrackEvent.prototype&&!("transceiver"in N.RTCTrackEvent.prototype)&&Object.defineProperty(N.RTCTrackEvent.prototype,"transceiver",{get(){return{receiver:this.receiver}}})}function pt(N){const T=N.RTCPeerConnection.prototype.createOffer;N.RTCPeerConnection.prototype.createOffer=function(A){if(A){A.offerToReceiveAudio!==void 0&&(A.offerToReceiveAudio=!!A.offerToReceiveAudio);const O=this.getTransceivers().find(B=>B.receiver.track.kind==="audio");A.offerToReceiveAudio===!1&&O?O.direction==="sendrecv"?O.setDirection?O.setDirection("sendonly"):O.direction="sendonly":O.direction==="recvonly"&&(O.setDirection?O.setDirection("inactive"):O.direction="inactive"):A.offerToReceiveAudio!==!0||O||this.addTransceiver("audio",{direction:"recvonly"}),A.offerToReceiveVideo!==void 0&&(A.offerToReceiveVideo=!!A.offerToReceiveVideo);const L=this.getTransceivers().find(B=>B.receiver.track.kind==="video");A.offerToReceiveVideo===!1&&L?L.direction==="sendrecv"?L.setDirection?L.setDirection("sendonly"):L.direction="sendonly":L.direction==="recvonly"&&(L.setDirection?L.setDirection("inactive"):L.direction="inactive"):A.offerToReceiveVideo!==!0||L||this.addTransceiver("video",{direction:"recvonly"})}return T.apply(this,arguments)}}function bt(N){typeof N!="object"||N.AudioContext||(N.AudioContext=N.webkitAudioContext)}var we=r(7539),he=r.n(we);function $e(N){if(!N.RTCIceCandidate||N.RTCIceCandidate&&"foundation"in N.RTCIceCandidate.prototype)return;const T=N.RTCIceCandidate;N.RTCIceCandidate=function(A){if(typeof A=="object"&&A.candidate&&A.candidate.indexOf("a=")===0&&((A=JSON.parse(JSON.stringify(A))).candidate=A.candidate.substring(2)),A.candidate&&A.candidate.length){const O=new T(A),L=he().parseCandidate(A.candidate);for(const B in L)B in O||Object.defineProperty(O,B,{value:L[B]});return O.toJSON=function(){return{candidate:O.candidate,sdpMid:O.sdpMid,sdpMLineIndex:O.sdpMLineIndex,usernameFragment:O.usernameFragment}},O}return new T(A)},N.RTCIceCandidate.prototype=T.prototype,g(N,"icecandidate",A=>(A.candidate&&Object.defineProperty(A,"candidate",{value:new N.RTCIceCandidate(A.candidate),writable:"false"}),A))}function et(N){!N.RTCIceCandidate||N.RTCIceCandidate&&"relayProtocol"in N.RTCIceCandidate.prototype||g(N,"icecandidate",T=>{if(T.candidate){const A=he().parseCandidate(T.candidate.candidate);A.type==="relay"&&(T.candidate.relayProtocol={0:"tls",1:"tcp",2:"udp"}[A.priority>>24])}return T})}function Et(N,T){if(!N.RTCPeerConnection)return;"sctp"in N.RTCPeerConnection.prototype||Object.defineProperty(N.RTCPeerConnection.prototype,"sctp",{get(){return this._sctp===void 0?null:this._sctp}});const A=N.RTCPeerConnection.prototype.setRemoteDescription;N.RTCPeerConnection.prototype.setRemoteDescription=function(){if(this._sctp=null,T.browser==="chrome"&&T.version>=76){const{sdpSemantics:O}=this.getConfiguration();O==="plan-b"&&Object.defineProperty(this,"sctp",{get(){return this._sctp===void 0?null:this._sctp},enumerable:!0,configurable:!0})}if(function(O){if(!O||!O.sdp)return!1;const L=he().splitSections(O.sdp);return L.shift(),L.some(B=>{const H=he().parseMLine(B);return H&&H.kind==="application"&&H.protocol.indexOf("SCTP")!==-1})}(arguments[0])){const O=function(se){const Z=se.sdp.match(/mozilla...THIS_IS_SDPARTA-(\d+)/);if(Z===null||Z.length<2)return-1;const oe=parseInt(Z[1],10);return oe!=oe?-1:oe}(arguments[0]),L=function(se){let Z=65536;return T.browser==="firefox"&&(Z=T.version<57?se===-1?16384:2147483637:T.version<60?T.version===57?65535:65536:2147483637),Z}(O),B=function(se,Z){let oe=65536;T.browser==="firefox"&&T.version===57&&(oe=65535);const de=he().matchPrefix(se.sdp,"a=max-message-size:");return de.length>0?oe=parseInt(de[0].substring(19),10):T.browser==="firefox"&&Z!==-1&&(oe=2147483637),oe}(arguments[0],O);let H;H=L===0&&B===0?Number.POSITIVE_INFINITY:L===0||B===0?Math.max(L,B):Math.min(L,B);const ne={};Object.defineProperty(ne,"maxMessageSize",{get:()=>H}),this._sctp=ne}return A.apply(this,arguments)}}function ct(N){if(!N.RTCPeerConnection||!("createDataChannel"in N.RTCPeerConnection.prototype))return;function T(O,L){const B=O.send;O.send=function(){const H=arguments[0],ne=H.length||H.size||H.byteLength;if(O.readyState==="open"&&L.sctp&&ne>L.sctp.maxMessageSize)throw new TypeError("Message too large (can send a maximum of "+L.sctp.maxMessageSize+" bytes)");return B.apply(O,arguments)}}const A=N.RTCPeerConnection.prototype.createDataChannel;N.RTCPeerConnection.prototype.createDataChannel=function(){const O=A.apply(this,arguments);return T(O,this),O},g(N,"datachannel",O=>(T(O.channel,O.target),O))}function tn(N){if(!N.RTCPeerConnection||"connectionState"in N.RTCPeerConnection.prototype)return;const T=N.RTCPeerConnection.prototype;Object.defineProperty(T,"connectionState",{get(){return{completed:"connected",checking:"connecting"}[this.iceConnectionState]||this.iceConnectionState},enumerable:!0,configurable:!0}),Object.defineProperty(T,"onconnectionstatechange",{get(){return this._onconnectionstatechange||null},set(A){this._onconnectionstatechange&&(this.removeEventListener("connectionstatechange",this._onconnectionstatechange),delete this._onconnectionstatechange),A&&this.addEventListener("connectionstatechange",this._onconnectionstatechange=A)},enumerable:!0,configurable:!0}),["setLocalDescription","setRemoteDescription"].forEach(A=>{const O=T[A];T[A]=function(){return this._connectionstatechangepoly||(this._connectionstatechangepoly=L=>{const B=L.target;if(B._lastConnectionState!==B.connectionState){B._lastConnectionState=B.connectionState;const H=new Event("connectionstatechange",L);B.dispatchEvent(H)}return L},this.addEventListener("iceconnectionstatechange",this._connectionstatechangepoly)),O.apply(this,arguments)}})}function Ht(N,T){if(!N.RTCPeerConnection||T.browser==="chrome"&&T.version>=71||T.browser==="safari"&&T.version>=605)return;const A=N.RTCPeerConnection.prototype.setRemoteDescription;N.RTCPeerConnection.prototype.setRemoteDescription=function(O){if(O&&O.sdp&&O.sdp.indexOf(`
a=extmap-allow-mixed`)!==-1){const L=O.sdp.split(`
`).filter(B=>B.trim()!=="a=extmap-allow-mixed").join(`
`);N.RTCSessionDescription&&O instanceof N.RTCSessionDescription?arguments[0]=new N.RTCSessionDescription({type:O.type,sdp:L}):O.sdp=L}return A.apply(this,arguments)}}function pn(N,T){if(!N.RTCPeerConnection||!N.RTCPeerConnection.prototype)return;const A=N.RTCPeerConnection.prototype.addIceCandidate;A&&A.length!==0&&(N.RTCPeerConnection.prototype.addIceCandidate=function(){return arguments[0]?(T.browser==="chrome"&&T.version<78||T.browser==="firefox"&&T.version<68||T.browser==="safari")&&arguments[0]&&arguments[0].candidate===""?Promise.resolve():A.apply(this,arguments):(arguments[1]&&arguments[1].apply(null),Promise.resolve())})}function le(N,T){if(!N.RTCPeerConnection||!N.RTCPeerConnection.prototype)return;const A=N.RTCPeerConnection.prototype.setLocalDescription;A&&A.length!==0&&(N.RTCPeerConnection.prototype.setLocalDescription=function(){let O=arguments[0]||{};if(typeof O!="object"||O.type&&O.sdp)return A.apply(this,arguments);if(O={type:O.type,sdp:O.sdp},!O.type)switch(this.signalingState){case"stable":case"have-local-offer":case"have-remote-pranswer":O.type="offer";break;default:O.type="answer"}return O.sdp||O.type!=="offer"&&O.type!=="answer"?A.apply(this,[O]):(O.type==="offer"?this.createOffer:this.createAnswer).apply(this).then(L=>A.apply(this,[L]))})}(function({window:N}={},T={shimChrome:!0,shimFirefox:!0,shimSafari:!0}){const A=b,O=function(B){const H={browser:null,version:null};if(B===void 0||!B.navigator||!B.navigator.userAgent)return H.browser="Not a browser.",H;const{navigator:ne}=B;if(ne.mozGetUserMedia)H.browser="firefox",H.version=p(ne.userAgent,/Firefox\/(\d+)\./,1);else if(ne.webkitGetUserMedia||B.isSecureContext===!1&&B.webkitRTCPeerConnection)H.browser="chrome",H.version=p(ne.userAgent,/Chrom(e|ium)\/(\d+)\./,2);else{if(!B.RTCPeerConnection||!ne.userAgent.match(/AppleWebKit\/(\d+)\./))return H.browser="Not a supported browser.",H;H.browser="safari",H.version=p(ne.userAgent,/AppleWebKit\/(\d+)\./,1),H.supportsUnifiedPlan=B.RTCRtpTransceiver&&"currentDirection"in B.RTCRtpTransceiver.prototype}return H}(N),L={browserDetails:O,commonShim:l,extractVersion:p,disableLog:_,disableWarnings:v,sdp:we};switch(O.browser){case"chrome":if(!a||!K||!T.shimChrome)return A("Chrome shim is not included in this adapter release."),L;if(O.version===null)return A("Chrome shim can not determine version, not shimming."),L;A("adapter.js shimming chrome."),L.browserShim=a,pn(N,O),le(N),P(N,O),V(N),K(N,O),$(N),J(N,O),q(N),Y(N),te(N),X(N,O),$e(N),et(N),tn(N),Et(N,O),ct(N),Ht(N,O);break;case"firefox":if(!o||!Fe||!T.shimFirefox)return A("Firefox shim is not included in this adapter release."),L;A("adapter.js shimming firefox."),L.browserShim=o,pn(N,O),le(N),ae(N,O),Fe(N,O),Me(N),ge(N),Te(N),Re(N),_e(N),ke(N),gt(N),wt(N),ye(N),$e(N),tn(N),Et(N,O),ct(N);break;case"safari":if(!c||!T.shimSafari)return A("Safari shim is not included in this adapter release."),L;A("adapter.js shimming safari."),L.browserShim=c,pn(N,O),le(N),rt(N),pt(N),pe(N),Se(N),Qe(N),dt(N),ze(N),bt(N),$e(N),et(N),Et(N,O),ct(N),Ht(N,O);break;default:A("Unsupported browser!")}})({window:typeof window>"u"?void 0:window}),r(8520);const z=()=>typeof RTCPeerConnection=="function";var W,fe;(function(N){N[N.TRACE=0]="TRACE",N[N.DEBUG=1]="DEBUG",N[N.INFO=2]="INFO",N[N.WARN=3]="WARN",N[N.ERROR=4]="ERROR",N[N.SILENT=5]="SILENT"})(W||(W={})),function(N){N.SPADE="SPADE",N.TIME="Time",N.WEBRTC="WebRTC",N.EMITTER="Emitter",N.MEDIA="Media",N.SUBSCRIPTION="StageSubscription",N.PUBLICATION="StagePublication",N.CONNECTION="StageConnection",N.SOCKET="StageSocket",N.BROADCAST_STAGE_CLIENT="BroadcastStageClient",N.STAGE="Stage",N.REMOTE_PARTICIPANT="RemoteParticipant",N.LOCAL_PARTICIPANT="LocalParticipant",N.CONFIGURATION="Configuration",N.REMOTE_PLAYBACK="RemotePlaybackController",N.REMOTE_STAGE_STREAM="RemoteStageStream"}(fe||(fe={}));const Ne=1007,Be=12e4,tt=3e5;class Tt extends Error{constructor({name:T,message:A,code:O,details:L,cause:B,params:H}){super(A),Error.captureStackTrace&&Error.captureStackTrace(this,Tt),this.name=T||"BroadcastClientError",this.message=A,this.code=O,this.details=L,this.cause=B,this.params=H}}const Cn={name:"BroadcastError",code:1e3,message:"Unable to broadcast"},je={name:"CameraError",code:2e3,message:"Camera could not be captured"},zt={name:"InputError",code:3e3,message:"Input could not be attached"},ht={name:"AddDeviceError",code:4e3,message:"Device is missing"},Pt={name:"AddDeviceNameExistsError",code:4001,message:"Name is already registered"},hn={name:"AddDeviceCompositionMissingError",code:4002,message:"VideoComposition is missing"},on={name:"AddDeviceCompositionIndexMissingError",code:4003,message:`VideoComposition's "index" property is missing`},Ve={name:"AddDeviceNameMissingError",code:4004,message:"Name property is missing"},at={name:"AddDeviceUnsupported",code:4005,message:"Unsupported device"},Mt={name:"AddDeviceConstraintsError",code:4006,message:"Constraints error"},Ot={name:"RemoveDeviceNotFoundError",code:5e3,message:"Device not found"},Zn={name:"RemoveImageNotFoundError",code:6e3,message:"Image not found"},or={name:"UpdateVideoDeviceCompositionMissingError",code:7e3,message:"VideoComposition is missing"},wi={name:"UpdateVideoDeviceCompositionIndexMissingError",code:7001,message:`VideoComposition's "index" property is missing`},ai={name:"UpdateVideoDeviceCompositionNameMissingError",code:7002,message:"Video device with that name is not found"},xn={name:"ExchangePositionDeviceNotFoundError",code:8e3,message:"Device with that name is not found"},sn={name:"FailedToAddImageError",code:9e3,message:"Failed to add image"},zn={name:"PeerSetupError",code:1e4,message:"Unexpected return value from setup request"},Un={name:"PeerConnectionError",code:10001,message:"Peer connection has failed."},pi={name:"InvalidStreamKey",code:10003,message:"Invalid Stream Key."},dr={name:"BroadcastConfigurationError",code:11e3,message:"Error when configuring broadcast client"},ni={name:"StreamConfigurationError",code:12e3,message:"Error when configuring stream"},$a={name:"IngestEndpointTypeError",code:13e3,message:"Ingest endpoint must be a string"},Nu={name:"IngestEndpointUrlError",code:13001,message:"Ingest endpoint must be a valid https or rtmps URL"},Ef={name:"LogLevelTypeError",code:14e3,message:"Log Level must be a valid integer between [0..5]"},Fp={name:"LoggerTypeError",code:15e3,message:"Logger must be an object"},I0={name:"ClientInvalidError",code:16e3,message:"Client is no longer valid, possibly due to delete() invocation."},Sf={name:"NetworkReconnectConfigurationError",code:17e3,message:"Error when configuring network reconnect"},Tf={name:"NetworkReconnectConfigurationInvalidTimeoutError",code:17001,message:"Network reconnect timeout value must be a number between [10000, 300000]"},Iu={name:"StreamKeyInvalidCharError",code:18e3,message:"Streamkey must contain only [A-Za-z0-9_-] characters"},Ee={name:"StageTokenTypeError",code:19e3,message:"Stage token must be a string"},We={name:"StageWhipUrlOverrideError",code:19001,message:"Stage WHIP override URL must be a string starting with http"};var vt,_t,Ze,Vt,rn,_n,wn,ci,li,Nn=function(N,T,A,O){if(A==="a"&&!O)throw new TypeError("Private accessor was defined without a getter");if(typeof T=="function"?N!==T||!O:!T.has(N))throw new TypeError("Cannot read private member from an object whose class did not declare it");return A==="m"?O:A==="a"?O.call(N):O?O.value:T.get(N)},yi=function(N,T,A,O,L){if(typeof T=="function"?N!==T||!L:!T.has(N))throw new TypeError("Cannot write private member to an object whose class did not declare it");return T.set(N,A),A};const cr=1920,Ds=1080,xs=W.ERROR,Zi={maxResolution:{width:852,height:480},maxFramerate:30,maxBitrate:1500},Jn={maxResolution:{width:480,height:852},maxFramerate:30,maxBitrate:1500},Ci={maxResolution:{width:1920,height:1080},maxFramerate:30,maxBitrate:3500},Hn={maxResolution:{width:1080,height:1920},maxFramerate:30,maxBitrate:3500},Jo={maxResolution:{width:1920,height:1080},maxFramerate:30,maxBitrate:8500},Ql={maxResolution:{width:1080,height:1920},maxFramerate:30,maxBitrate:8500},uo={reconnect:!1,timeout:Be};function Th(N){var T,A;if(typeof N!="string"&&N!==void 0)throw new Tt($a);if(N){if(N.startsWith("https"))return N;{const O=/(?<protocol>(rtmps|https):\/\/)?(?<id>.+)\.(?<environment>(?=\S*['-])([a-zA-Z'-]+))\.live-video\.net.*/.exec(N);if(((T=O==null?void 0:O.groups)===null||T===void 0?void 0:T.protocol)==="rtmps"&&console.warn("rtmps server url detected; please pass in the ingest endpoint (no rtmps:// protocol) instead"),(A=O==null?void 0:O.groups)===null||A===void 0?void 0:A.id)return`https://${O.groups.id}.webrtc.live-video.net:4443`;throw new Tt(Nu)}}return""}class ds{constructor(T,A,O=Zi,L,B=uo){this.LOG_LEVEL=W,this.BASIC_LANDSCAPE=Zi,this.BASIC_PORTRAIT=Jn,this.BASIC_FULL_HD_LANDSCAPE=Ci,this.BASIC_FULL_HD_PORTRAIT=Hn,this.STANDARD_LANDSCAPE=Jo,this.STANDARD_PORTRAIT=Ql,vt.set(this,void 0),_t.set(this,void 0),Ze.set(this,Zi),Vt.set(this,void 0),rn.set(this,uo),_n.set(this,H=>{if(!H)throw new Tt(Object.assign(Object.assign({},ni),{details:"missing stream configuration"}));if(!(H.maxBitrate<=8500&&H.maxBitrate>=200))throw new Tt(Object.assign(Object.assign({},ni),{details:"maxBitrate must be between 200 and 8500"}));if(!(H.maxFramerate<=60&&H.maxFramerate>=10))throw new Tt(Object.assign(Object.assign({},ni),{details:"maxFramerate must be between 10 and 60"}));const ne=H.maxResolution.width,se=H.maxResolution.height;if(ne>cr||se>cr||ne<160||se<160||ne===cr&&se>Ds||se===cr&&ne>Ds)throw new Tt(Object.assign(Object.assign({},ni),{details:"maxResolution values must be between 1080x1920 or 1920x1080"}))}),wn.set(this,H=>{if(!H)return;const ne=Number(H),se=Number.isInteger(ne),Z=ne>=W.TRACE,oe=ne<=W.SILENT;if(!se||!Z||!oe)throw new Tt(Ef)}),ci.set(this,H=>{if(H&&typeof H!="object")throw new Tt(Fp)}),li.set(this,H=>{if(!H)return;if(typeof H!="object"||typeof H.reconnect!="boolean")throw new Tt(Sf);const{timeout:ne}=H;if(ne!==void 0&&(Number.isNaN(ne)||typeof ne!="number"||ne<1e4||ne>tt))throw new Tt(Tf)}),Nn(this,ci,"f").call(this,L),Nn(this,wn,"f").call(this,A),Nn(this,_n,"f").call(this,O),yi(this,vt,T),yi(this,_t,A),yi(this,Ze,O),yi(this,Vt,L),yi(this,rn,B)}get ingestEndpoint(){return Nn(this,vt,"f")}set ingestEndpoint(T){yi(this,vt,Th(T))}get streamConfig(){return Nn(this,Ze,"f")}set streamConfig(T){Nn(this,_n,"f").call(this,T),yi(this,Ze,T)}get logLevel(){return Nn(this,_t,"f")}set logLevel(T){Nn(this,wn,"f").call(this,T),yi(this,_t,T)}get logger(){return Nn(this,Vt,"f")}set logger(T){Nn(this,ci,"f").call(this,T),yi(this,Vt,T)}get networkReconnectConfig(){return Nn(this,rn,"f")}set networkReconnectConfig(T){Nn(this,li,"f").call(this,T),yi(this,rn,T)}}vt=new WeakMap,_t=new WeakMap,Ze=new WeakMap,Vt=new WeakMap,rn=new WeakMap,_n=new WeakMap,wn=new WeakMap,ci=new WeakMap,li=new WeakMap;var Sn,ho=r(6729),Ws=r(1206);(function(N){N.PUBLISHED_VIDEO_STATS="ivs_broadcast_webrtc_published_video_stats",N.PUBLISHED_VIDEO_STATS_WINDOW="ivs_broadcast_webrtc_published_video_stats_window",N.PUBLISHED_AUDIO_STATS="ivs_broadcast_webrtc_published_audio_stats",N.PUBLISHED_AUDIO_STATS_WINDOW="ivs_broadcast_webrtc_published_audio_stats_window",N.SUBSCRIBED_VIDEO_STATS="ivs_broadcast_webrtc_subscribed_video_stats",N.SUBSCRIBED_VIDEO_STATS_WINDOW="ivs_broadcast_webrtc_sbcrbd_video_stats_window",N.SUBSCRIBED_AUDIO_STATS="ivs_broadcast_webrtc_subscribed_audio_stats",N.SUBSCRIBED_AUDIO_STATS_WINDOW="ivs_broadcast_webrtc_sbcrbd_audio_stats_window",N.PUBLISH="ivs_broadcast_multihost_publish",N.UNPUBLISH="ivs_broadcast_multihost_unpublish",N.SUBSCRIBE="ivs_broadcast_multihost_subscribe",N.UNSUBSCRIBE="ivs_broadcast_multihost_unsubscribe",N.PUBLISH_STARTED="ivs_broadcast_multihost_publish_started",N.PUBLISH_FAILED="ivs_broadcast_multihost_publish_failed",N.PUBLISH_ENDED="ivs_broadcast_multihost_publish_ended",N.STATE_UPDATED="ivs_broadcast_multihost_event_state_updated",N.SUBSCRIBE_STARTED="ivs_broadcast_multihost_subscribe_started",N.SUBSCRIBE_FAILED="ivs_broadcast_multihost_subscribe_failed",N.SUBSCRIBE_ENDED="ivs_broadcast_multihost_subscribe_ended",N.FIRST_FRAME="ivs_broadcast_multihost_first_frame",N.JOIN="ivs_broadcast_multihost_join",N.JOIN_ATTEMPT="ivs_broadcast_multihost_event_connect_attempt",N.JOIN_ATTEMPT_FAILED="ivs_broadcast_multihost_event_connect_failed",N.JOIN_ENDED="ivs_broadcast_multihost_join_ended",N.LEAVE="ivs_broadcast_multihost_leave",N.REASSIGNMENT_REQUEST="ivs_broadcast_multihost_reassignment_request",N.SERVER_REQUEST="ivs_broadcast_multihost_server_request",N.TRACE="ivs_broadcast_stage_trace",N.ERROR="ivs_broadcast_error",N.MINUTE="ivs_broadcast_multihost_minute",N.CONNECTION_STATE="ivs_broadcast_webrtc_connection_state",N.ICE_GATHERING_STATE="ivs_broadcast_webrtc_gathering_state",N.EDP_CONNECTED="ivs_broadcast_multihost_event_connected",N.EDP_DISCONNECTED="ivs_broadcast_multihost_event_disconnected",N.EDP_PONG="ivs_broadcast_multihost_edp_rtt",N.SIMULCAST_LAYER_INFO="ivs_broadcast_simulcast_layer_info",N.MULTIHOST_CONFIGURATION="ivs_broadcast_multihost_configuration",N.MULTIHOST_SUBSCRIBE_CONFIGURATION="ivs_broadcast_multihost_subscribe_configuration",N.PLAYBACK_LAYER_REQUEST="ivs_broadcast_multihost_playback_layer_request",N.PLAYBACK_LAYER_STATE="ivs_broadcast_multihost_playback_layer_state"})(Sn||(Sn={}));class Yn{constructor(T,A,O,L){let B="unknown";if(A.stageARN&&A.stageARN.startsWith("arn:aws:ivs:")){const H=A.stageARN.split(":");H.length===6&&(B=H[4])}this.event=T,this.properties={client_time:new Date().toISOString(),customer_id:B,device_software:window.navigator.userAgent,multihost_id:A.stageARN,participant_id:A.participantID,participant_user_id:A.userID,platform:"web",sdk_version:"1.19.0",stage_arn:A.stageARN,trace_id:O.value},A.attrGsRole&&(this.properties.token_attribute_0=A.attrGsRole),A.attrGsSessionId&&(this.properties.token_attribute_1=A.attrGsSessionId),this.critical=L}}class Il extends Yn{constructor(T){super(Sn.ERROR,T.token,T.traceId,!0),Object.assign(this.properties,{code:T.code,tag:T.tag,description:T.message,remote_participant_id:T.remoteParticipantId,request_uuid:T.requestUUID,is_nominal:T.nominal,is_fatal:T.fatal,details:T.details,location:T.location})}}const ma="IVS_CLIENT_OVERRIDES";function zp(N){const T=window[ma];return typeof T=="object"?T[N]:N==="logLevel"?window.STAGES_LOG_LEVEL:N==="appLabel"?window.IVS_APP_LABEL:N==="whipUrl"?window.IVS_DATA_PLANE_ENDPOINT:void 0}function xd(N){const T=zp(N);if(typeof T=="string")return T}function xh(N){const T=zp(N);if(typeof T=="boolean")return T}function k0(){const N=zp("logLevel");if(typeof N=="number"&&Object.values(W).includes(N))return N}function ty(){return xh("disableXdp")}function P0(){return xh("enableXdpPublish")}function Qo(){return xh("preferMainProfile")}function D0(){return xh("enableInitialLayerOnSdp")}var ec=function(N,T,A,O){return new(A||(A=Promise))(function(L,B){function H(Z){try{se(O.next(Z))}catch(oe){B(oe)}}function ne(Z){try{se(O.throw(Z))}catch(oe){B(oe)}}function se(Z){var oe;Z.done?L(Z.value):(oe=Z.value,oe instanceof A?oe:new A(function(de){de(oe)})).then(H,ne)}se((O=O.apply(N,[])).next())})};const fx=4;class WE{constructor(T="https://broadcast.stats.live-video.net/"){this.spadeUrl=T}send(T,A=!1){return ec(this,void 0,void 0,function*(){const O=Date.now();for(const ne of T)ne.properties.batch_time_millis=O;const L=this.b64EncodeUnicode(JSON.stringify(T)),B={"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"},H=`data=${L}`;A?navigator.sendBeacon(this.spadeUrl,H):ec(this,void 0,void 0,function*(){try{yield function(ne,se,Z={},oe=""){return ec(this,void 0,void 0,function*(){const de=new XMLHttpRequest;return de.open(ne,se,!0),Z&&Object.keys(Z).forEach(me=>{Z.hasOwnProperty(me)&&de.setRequestHeader(me,Z[me])}),new Promise((me,Pe)=>{de.onreadystatechange=()=>{de.readyState===fx&&(de.status>=200&&de.status<300?me(de.responseText):Pe(new Error(`Spade ${ne} ${se} responded ${de.status}
${de.responseText}`)))},de.send(oe)})})}("POST",this.spadeUrl,B,H)}catch{}})})}b64EncodeUnicode(T){return btoa(encodeURIComponent(T).replace(/%([0-9A-F]{2})/g,(A,O)=>String.fromCharCode(+`0x${O}`)))}}function ku(N){if(!N)throw new Error("SpadeClient is not defined")}function Vm(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,N=>{const T=16*Math.random()|0;return(N==="x"?T:3&T|8).toString(16)})}class wd{constructor(){this.sharedProperties={},this.spadeClient={},this.queuedEvents=[],this.genSessionId();const T=function(){const O=xd("analyticsPostUrl");if(O!==void 0)return O}()||"https://broadcast.stats.live-video.net/",A=function(){const O=xd("appLabel");if(O!==void 0)return O.substring(0,64)}();this.spadeClient=new WE(T),this.initSharedProperties({appLabel:A})}start(){this.flushInterval||(this.flushInterval=window.setInterval(()=>{this.flushEvents()},1e3))}stop(T){let A=!1;clearInterval(this.flushInterval),this.flushInterval=void 0,T&&(this.queuedEvents=this.queuedEvents.filter(O=>O.critical),A=!0),this.flushEvents(A),this.genSessionId()}trackEvent(T,A=!1){let O=this.sharedProperties;A&&(O={global_session_id:wd.globalSessionId,session_id:this.sharedProperties.session_id,browser:this.sharedProperties.browser,browser_family:this.sharedProperties.browser_family,browser_version:this.sharedProperties.browser_version,os_name:this.sharedProperties.os_name,os_version:this.sharedProperties.os_version}),"data"in T?(T.data.properties=Object.assign({},O,T.data.properties),this.queuedEvents.push(T.data)):(T.properties=Object.assign({},O,T.properties),this.queuedEvents.push(T))}trackEventNoSharedProps(T){this.trackEvent(T,!0)}trackErrorAndThrow(T){throw this.trackError(T),T}trackError(T){this.trackEvent(new Il(T))}batchEvents(T){ku(this.spadeClient);const A=T.map(O=>(O.data.properties=Object.assign({},this.sharedProperties,O.data.properties),O.data));this.spadeClient.send(A)}initSharedProperties({appLabel:T}){const A=Ws.getParser(navigator.userAgent),O=this.parseSemver(String(A.getBrowserVersion()));this.sharedProperties={browser:navigator.appVersion,browser_family:A.getBrowserName().toLowerCase(),browser_version:`${O.major}.${O.minor}`,customer_id:"ivs",host:window.location.hostname,os_name:A.getOSName(),os_version:String(A.getOSVersion()),platform:"web",global_session_id:wd.globalSessionId,session_id:this.sessionId,sdk_version:"1.19.0",user_agent:navigator.userAgent},T&&(this.sharedProperties.app_label=T)}genSessionId(){this.sessionId=Vm(),this.sharedProperties.session_id=this.sessionId}flushEvents(T=!1){ku(this.spadeClient),this.queuedEvents.length>0&&this.spadeClient.send(this.queuedEvents,T),this.queuedEvents=[]}parseSemver(T){const A=/^(\d+)\.(\d+)\.(\d+)[+|-]?(.*)?$/.exec(T)||/^(\d+)\.(\d+)[+|-]?(.*)?$/.exec(T)||/^(\d+)$/.exec(T)||[];return{major:parseInt(A[1],10)||0,minor:parseInt(A[2],10)||0,patch:parseInt(A[3],10)||0}}getSessionId(){return this.sessionId}}wd.globalSessionId=Vm();class Rs{constructor(T,A){this.transformProperties=(L,B)=>({sum:L.sum,median:L.median(),min:L.min,max:L.max,p90:L.percentile(.9),event_count:L.data.length,period:B});const O=this.transformProperties(T,A);this.data={event:Ls.CONGESTION_TIME,properties:O}}}class wh{constructor(T,A,O){this.transformProperties=(B,H,ne)=>({duration:(B.getTime()-((H==null?void 0:H.getTime())||0))/1e3,ecn_negotiated:!1,ingest_session_id:ne});const L=this.transformProperties(T,A,O);this.data={event:Ls.CONNECTION_ESTABLISHED,properties:L}}}class ny{constructor(T,A){this.transformProperties=(L,B)=>({sum:L.sum,median:L.median(),min:L.min,max:L.max,p90:L.percentile(.9),event_count:L.data.length,period:B});const O=this.transformProperties(T,A);this.data={event:Ls.CONNECTION_RTT,properties:O}}}class YE{constructor(T){this.transformProperties=O=>{var L;return{is_fatal:(L=O.isFatal)!==null&&L!==void 0&&L,value:O.value,code:O.code,description:O.description}};const A=this.transformProperties(T);this.data={event:Ls.ERROR,properties:A}}}class iy{constructor(T,A){this.transformProperties=(L,B)=>({type:L,input_device_id:B.deviceId,position:B.facingMode||"unknown"});const O=this.transformProperties(T,A);this.data={event:Ls.INPUT_DEVICE_ATTACHED,properties:O}}}class px{constructor(T,A){this.transformProperties=(L,B)=>({type:L,input_device_id:B.deviceId,position:B.facingMode||"unknown"});const O=this.transformProperties(T,A);this.data={event:Ls.INPUT_DEVICE_DETACHED,properties:O}}}class KE{constructor(T,A){this.transformProperties=(L,B)=>({sum:L.sum,median:L.median(),min:L.min,max:L.max,p90:L.percentile(.9),event_count:L.data.length,period:B});const O=this.transformProperties(T,A);this.data={event:Ls.MEASURED_BITRATE,properties:O}}}class xf{constructor(T,A){this.transformProperties=(L,B)=>({minutes_logged:Math.round((L.timestamp-B)/6e4)});const O=this.transformProperties(T,A);this.data={event:Ls.MINUTE_BROADCAST,properties:O}}}class wf{constructor(T,A){this.transformProperties=(L,B)=>({sum:L.sum,median:L.median(),min:L.min,max:L.max,p90:L.percentile(.9),event_count:L.data.length,period:B});const O=this.transformProperties(T,A);this.data={event:Ls.RECOMMENDED_BITRATE,properties:O}}}class ry{constructor(T){this.transformProperties=O=>({codec:O.mimeType,bitrate:0,sample_rate:O.clockRate,channel_count:O.channels});const A=this.transformProperties(T);this.data={event:Ls.SESSION_AUDIO_ENCODER_CONFIGURED,properties:A}}}class XE{constructor(T){this.transformProperties=O=>({codec:"audio",bitrate:32e3,sample_rate:O.sampleRate,channel_count:O.channelCount});const A=this.transformProperties(T);this.data={event:Ls.SESSION_AUDIO_PROPERTIES,properties:A}}}class ZE{constructor(T,A,O){this.transformProperties=(B,H,ne)=>({codec:ne.mimeType,codec_profile:H.profile,codec_level:H.level,rate_mode:"vbr",initial_bitrate:0,keyframe_interval:2,width:B.width,height:B.height,bframe_count:0,target_fps:B.frameRate});const L=this.transformProperties(T,A,O);this.data={event:Ls.SESSION_VIDEO_ENCODER_CONFIGURED,properties:L}}}class L0{constructor(T){this.transformProperties=O=>({codec:"video",initial_bitrate:32e3,min_bitrate:0,max_bitrate:0,keyframe_interval:2,width:O.width,height:O.height,auto_bitrate_enabled:!0,bframes_enabled:!1,target_fps:O.frameRate});const A=this.transformProperties(T);this.data={event:Ls.SESSION_VIDEO_PROPERTIES,properties:A}}}class sy{constructor(T,A){this.transformProperties=(L,B)=>({sum:L.sum,median:L.median(),min:L.min,max:L.max,p90:L.percentile(.9),event_count:L.data.length,period:B});const O=this.transformProperties(T,A);this.data={event:Ls.SOURCE_AUDIO_LATENCY,properties:O}}}class JE{constructor(T,A){this.transformProperties=(L,B)=>({sum:L.sum,median:L.median(),min:L.min,max:L.max,p90:L.percentile(.9),event_count:L.data.length,period:B});const O=this.transformProperties(T,A);this.data={event:Ls.SOURCE_VIDEO_LATENCY,properties:O}}}class Ch{constructor(T,A){this.transformProperties=({protocol:L,hostname:B,port:H},ne)=>({protocol:L,endpoint_host:B,endpoint_port:H,reason:ne});const O=this.transformProperties(T,A);this.data={event:Ls.START_BROADCAST,properties:O}}}class Gm{constructor(T){this.transformProperties=({protocol:O,hostname:L,port:B})=>({protocol:O,endpoint_host:L,endpoint_port:B});const A=this.transformProperties(T);this.data={event:Ls.STOP_BROADCAST,properties:A}}}class QE{constructor(T){this.transformProperties=O=>({bytes_sent:O.bytesSent,header_bytes_sent:O.headerBytesSent,nack_count:O.nackCount,packets_sent:O.packetsSent,retransmitted_bytes_sent:O.retransmittedBytesSent,retransmitted_packets_sent:O.retransmittedPacketsSent});const A=this.transformProperties(T);this.data={event:Ls.WEBRTC_AUDIO_STATS,properties:A}}}class Tc{constructor(T){this.transformProperties=O=>({bytes_sent:O.bytesSent,fir_count:O.firCount,frames_encoded:O.framesEncoded,frames_sent:O.framesSent,header_bytes_sent:O.headerBytesSent,huge_frames_sent:O.hugeFramesSent,key_frames_encoded:O.keyFramesEncoded,nack_count:O.nackCount,packets_sent:O.packetsSent,pli_count:O.pliCount,quality_limitation_reason:O.qualityLimitationReason,quality_limitation_resolution_changes:O.qualityLimitationResolutionChanges,retransmitted_bytes_sent:O.retransmittedBytesSent,retransmitted_packets_sent:O.retransmittedPacketsSent,total_encode_time:O.totalEncodeTime,total_encoded_bytes_target:O.totalEncodedBytesTarget,total_packet_send_delay:O.totalPacketSendDelay});const A=this.transformProperties(T);this.data={event:Ls.WEBRTC_VIDEO_STATS,properties:A}}}var Ls,Cd;(function(N){N.START_BROADCAST="ivs_broadcast_start_broadcast",N.STOP_BROADCAST="ivs_broadcast_stop_broadcast",N.MINUTE_BROADCAST="ivs_broadcast_minute_broadcast",N.WEBRTC_AUDIO_STATS="ivs_broadcast_webrtc_audio_stats",N.WEBRTC_VIDEO_STATS="ivs_broadcast_webrtc_video_stats",N.WEBRTC_AUDIO_STATS_WINDOW="ivs_broadcast_webrtc_audio_stats_window",N.WEBRTC_VIDEO_STATS_WINDOW="ivs_broadcast_webrtc_video_stats_window",N.CONNECTION_ESTABLISHED="ivs_broadcast_connection_established",N.SESSION_VIDEO_PROPERTIES="ivs_broadcast_session_video_properties",N.SESSION_AUDIO_PROPERTIES="ivs_broadcast_session_audio_properties",N.SESSION_VIDEO_ENCODER_CONFIGURED="ivs_broadcast_session_video_encoder_configured",N.SESSION_AUDIO_ENCODER_CONFIGURED="ivs_broadcast_session_audio_encoder_configured",N.SOURCE_AUDIO_LATENCY="ivs_broadcast_source_audio_latency",N.SOURCE_VIDEO_LATENCY="ivs_broadcast_source_video_latency",N.INPUT_DEVICE_ATTACHED="ivs_broadcast_input_device_attached",N.INPUT_DEVICE_DETACHED="ivs_broadcast_input_device_detached",N.CONGESTION_TIME="ivs_broadcast_congestion_time",N.BUFFER_DURATION="ivs_broadcast_buffer_duration",N.MEASURED_BITRATE="ivs_broadcast_measured_bitrate",N.RECOMMENDED_BITRATE="ivs_broadcast_recommended_bitrate",N.CONNECTION_RTT="ivs_broadcast_connection_rtt",N.ERROR="ivs_broadcast_error"})(Ls||(Ls={})),function(N){N.USER_INITIATED="user-initiated",N.NETWORK_DISCONNECT="network-disconnect"}(Cd||(Cd={}));const mx={[W.INFO]:"#528bff",[W.WARN]:"#ffb31a",[W.DEBUG]:"#00f593",[W.ERROR]:"#ff4f4d",[W.TRACE]:"",[W.SILENT]:"",[fe.SPADE]:"#a970ff",[fe.TIME]:"#53535f",[fe.WEBRTC]:"#0e9bd8",[fe.SUBSCRIPTION]:"#ffc400",[fe.CONNECTION]:"#ff5edb",[fe.SOCKET]:"#8585ff",[fe.EMITTER]:"#adadb8",[fe.LOCAL_PARTICIPANT]:"#1DD21D",[fe.STAGE]:"#EC9806",[fe.REMOTE_PARTICIPANT]:"#0680EC",details:"#808080"},ga=({label:N})=>`background: ${mx[N]||"#333333"}; color: white; padding: 3px; margin-left: 3px;`,gx=Object.entries(W),U0=(N,T,A)=>{const O=ga({label:N}),[L]=gx.find(([,Xe])=>Xe===Number(N))||[],B=`%c${L}`,H=ga({label:T}),ne=`%c${T}`,se=ga({label:fe.TIME}),Z=`%c[${new Date().toISOString()}]`,oe=ga({label:"details"}),de=`%c[${A}]`,me=[Z,B,ne],Pe=[se,O,H];return A&&(me.push(de),Pe.push(oe)),[me.join(""),...Pe]},vx={debug(N){console.groupCollapsed(...U0(W.DEBUG,N.scope,N.label)),console.debug(N.msg,Object.assign(Object.assign({},N),{level:"debug"})),console.groupEnd()},info(N){console.groupCollapsed(...U0(W.INFO,N.scope,N.label)),console.info(N.msg,Object.assign(Object.assign({},N),{level:"info"})),console.groupEnd()},warn(N){console.groupCollapsed(...U0(W.WARN,N.scope,N.label)),console.warn(N.msg,Object.assign(Object.assign({},N),{level:"warn"})),console.groupEnd()},error(N){console.groupCollapsed(...U0(W.ERROR,N.scope,N.label)),console.error(N),console.groupEnd()}};var Cf=function(N,T){var A={};for(var O in N)Object.prototype.hasOwnProperty.call(N,O)&&T.indexOf(O)<0&&(A[O]=N[O]);if(N!=null&&typeof Object.getOwnPropertySymbols=="function"){var L=0;for(O=Object.getOwnPropertySymbols(N);L<O.length;L++)T.indexOf(O[L])<0&&Object.prototype.propertyIsEnumerable.call(N,O[L])&&(A[O[L]]=N[O[L]])}return A};Object.entries(W);class qm{constructor(T=xs,A=vx){this.logLevel=T,this.loggerInstance=A}debug(T){var A,O;this.logLevel>W.DEBUG||(O=(A=this.loggerInstance).debug)===null||O===void 0||O.call(A,JSON.parse(JSON.stringify(Object.assign(Object.assign({},T),{level:"debug"}))))}info(T){var A,O;this.logLevel>W.INFO||(O=(A=this.loggerInstance).info)===null||O===void 0||O.call(A,JSON.parse(JSON.stringify(Object.assign(Object.assign({},T),{level:"info"}))))}warn(T){var A,O;this.logLevel>W.WARN||(O=(A=this.loggerInstance).warn)===null||O===void 0||O.call(A,JSON.parse(JSON.stringify(Object.assign(Object.assign({},T),{level:"warn"}))))}error(T){var A,O,{err:L}=T,B=Cf(T,["err"]);this.logLevel>W.ERROR||(O=(A=this.loggerInstance).error)===null||O===void 0||O.call(A,Object.assign({err:L},B))}}class fo{constructor(T,A){this.logger=T,this.scope=A}debug(T){var A,O;(O=(A=this.logger).debug)===null||O===void 0||O.call(A,JSON.parse(JSON.stringify(Object.assign(Object.assign({},T),{scope:this.scope}))))}info(T){var A,O;(O=(A=this.logger).info)===null||O===void 0||O.call(A,JSON.parse(JSON.stringify(Object.assign(Object.assign({},T),{scope:this.scope}))))}warn(T){var A,O;(O=(A=this.logger).warn)===null||O===void 0||O.call(A,JSON.parse(JSON.stringify(Object.assign(Object.assign({},T),{scope:this.scope}))))}error(T){var A,O,{err:L}=T,B=Cf(T,["err"]);(O=(A=this.logger).error)===null||O===void 0||O.call(A,Object.assign(Object.assign({err:L},B),{scope:this.scope}))}unwrap(){return this.logger}}class xc{constructor(){this.min=0,this.max=0,this.sum=0,this.data=[]}push(T){(this.min===0||T<this.min)&&(this.min=T),T>=this.max&&(this.max=T),this.data.push(T),this.sum+=T}median(){this.data.sort();const T=this.data.length>>1;return this.data.length%2==0?this.data[T-1]+this.data[T]>>1:this.data[T]}percentile(T){if(this.data.length===0)return 0;if(T<=0)return this.data[0];if(T>=1)return this.data[this.data.length-1];const A=(this.data.length-1)*T,O=Math.floor(A),L=O+1,B=A%1;return L>=this.data.length?this.data[O]:this.data[O]*(1-B)+this.data[L]*B}}var $m=function(N,T,A,O){return new(A||(A=Promise))(function(L,B){function H(Z){try{se(O.next(Z))}catch(oe){B(oe)}}function ne(Z){try{se(O.throw(Z))}catch(oe){B(oe)}}function se(Z){var oe;Z.done?L(Z.value):(oe=Z.value,oe instanceof A?oe:new A(function(de){de(oe)})).then(H,ne)}se((O=O.apply(N,[])).next())})};class _x{constructor(T,A,O,L){this.peerClient=T,this.broadcastCanvasManager=A,this.analyticsTracker=L,this.logger=new fo(O,fe.EMITTER),this.previousBytesSent=0,this.startTimestamp=0,this.initializeSamples()}start(){this.logger.info({msg:"start emitter"}),this.collectSamplesTimerId=window.setInterval(()=>{this.collectSamples()},1e3),this.trackSamplesTimerId=window.setInterval(()=>{this.trackSamples()},3e4),this.trackPeerConnectionStatsTimerId=window.setInterval(()=>{this.trackPeerConnectionStats()},6e4),this.trackSamples()}stop(){clearInterval(this.collectSamplesTimerId),clearInterval(this.trackSamplesTimerId),clearInterval(this.trackPeerConnectionStatsTimerId),this.collectSamplesTimerId=void 0,this.trackSamplesTimerId=void 0,this.trackPeerConnectionStatsTimerId=void 0}trackPeerConnectionStats(){return $m(this,void 0,void 0,function*(){(yield this.peerClient.getReports()).forEach(T=>{if(T.type==="outbound-rtp")switch(T.kind){case"audio":this.analyticsTracker.trackEvent(new QE(T));break;case"video":{const A=new Tc(T),O=new xf(T,this.startTimestamp);this.analyticsTracker.batchEvents([A,O]);break}default:this.logger.warn({msg:"unknown report kind: ",reportKind:T.kind})}})})}collectSamples(){return $m(this,void 0,void 0,function*(){let T=0;this.audioLatencySamples.push(this.broadcastCanvasManager.getAudioLatency()),this.videoLatencySamples.push(this.broadcastCanvasManager.getVideoLatency()),(yield this.peerClient.getReports()).forEach(O=>{switch(O.type){case"candidate-pair":O.nominated&&(this.rttSamples.push(O.currentRoundTripTime),this.recommendedBitrateSamples.push(O.availableOutgoingBitrate));break;case"outbound-rtp":T+=O.bytesSent||0,this.startTimestamp===0&&O.kind==="video"&&(this.startTimestamp=O.timestamp)}});const A=8*Math.round(T-this.previousBytesSent);this.previousBytesSent=T,this.measuredBitrateSamples.push(A)})}trackSamples(){const A=new sy(this.audioLatencySamples,30),O=new JE(this.videoLatencySamples,30),L=new Rs(this.congestionTimeSamples,30),B=new KE(this.measuredBitrateSamples,30),H=new wf(this.recommendedBitrateSamples,30),ne=new ny(this.rttSamples,30);this.analyticsTracker.batchEvents([A,O,L,B,H,ne]),this.initializeSamples()}initializeSamples(){this.audioLatencySamples=new xc,this.videoLatencySamples=new xc,this.congestionTimeSamples=new xc,this.measuredBitrateSamples=new xc,this.recommendedBitrateSamples=new xc,this.rttSamples=new xc}}const Oa={CONNECTION_STATE_CHANGE:"connectionStateChange",ERROR:"clientError",ACTIVE_STATE_CHANGE:"activeStateChange"},ta="connectionStateChange",B0="sdpNegotiated",Ad="clientError",jp="seiMessageReceived",ft="transformError";var st;(function(N){N.CLOSED="closed",N.COMPLETED="completed",N.CONNECTED="connected",N.CONNECTING="connecting",N.DISCONNECTED="disconnected",N.FAILED="failed",N.IDLE="idle",N.NEW="new",N.NONE="none"})(st||(st={}));const Bt=N=>{const T=B=>{var H;return!((H=B.deviceId)===null||H===void 0)&&H.startsWith("web-contents-media-stream")?"tab":void 0},A=B=>{var H;return!((H=B.deviceId)===null||H===void 0)&&H.startsWith("window")&&B.displaySurface==="window"?"window":void 0},O=B=>{var H;return!((H=B.deviceId)===null||H===void 0)&&H.startsWith("screen")&&B.displaySurface==="monitor"?"screen":void 0};return(T(L=N)||A(L)||O(L)?void 0:"camera")||O(N)||A(N)||T(N)||"unknown";var L};function fn(N,T){return N.find(A=>A.kind===T)}var Zt;(function(N){N.VIDEO="video",N.AUDIO="audio"})(Zt||(Zt={}));class Hi{constructor(){this.mediaTracks=new Map([[Zt.VIDEO,void 0],[Zt.AUDIO,void 0]])}setTrack(T,A){this.mediaTracks.set(T,A)}getTrack(T){return this.mediaTracks.get(T)}}class va{constructor(){this.levelAsymmetryAllowed=!1,this.packetisationMode=!1,this.profile="",this.level=0}extractVideoSdpFmtpLine(T){return T?(T.split("\r").join(";").split(`
`).join(";").split(" ").join(";").split(";").map(A=>A.trim()).filter(Boolean).forEach(A=>{const O=A.split("=");if(O.length===2)switch(O[0]){case"level-asymmetry-allowed":O[1]==="1"?this.levelAsymmetryAllowed=!0:this.levelAsymmetryAllowed=!1;break;case"packetization-mode":O[1]==="1"?this.packetisationMode=!0:this.packetisationMode=!1;break;case"profile-level-id":this.profile=this.getProfileFromId(O[1]),this.level=this.getLevelFromId(O[1])}}),{levelAsymmetryAllowed:this.levelAsymmetryAllowed,packetisationMode:this.packetisationMode,profile:this.profile,level:this.level}):{levelAsymmetryAllowed:this.levelAsymmetryAllowed,packetisationMode:this.packetisationMode,profile:this.profile,level:this.level}}getProfileFromId(T){const A=T.substr(0,2),O=T.substr(2,2);switch(A.substr(0,2)){case"42":return"baseline";case"4d":return"main";case"58":return"extended";case"64":return"high";case"6e":return O==="00"?"high 10":"high 10 intra";case"7a":return O==="00"?"high 42":"high 42 intra";case"f4":return O==="00"?"high 44":"high 44 intra";default:return"unknown"}}getLevelFromId(T){return parseInt(T.substr(4,2),16)}}function Ah(N){return btoa(JSON.stringify(N))}var Ji,eu=function(N,T,A,O){return new(A||(A=Promise))(function(L,B){function H(Z){try{se(O.next(Z))}catch(oe){B(oe)}}function ne(Z){try{se(O.throw(Z))}catch(oe){B(oe)}}function se(Z){var oe;Z.done?L(Z.value):(oe=Z.value,oe instanceof A?oe:new A(function(de){de(oe)})).then(H,ne)}se((O=O.apply(N,[])).next())})};(function(N){N.IDLE="idle",N.EXECUTING="executing",N.RECONNECTING="reconnecting"})(Ji||(Ji={}));class Rh{constructor(T,A=12e4,O,L){this.state=Ji.IDLE,this.failureCallback=()=>{},this.peerClient=T,this.timeout=A,this.logger=O,this.emitter=L}onFailure(T){this.failureCallback=T}setStartConfig(T,A){this.ingestEndpoint=T,this.streamKey=A}execute(){const{id:T}=this;this.state===Ji.IDLE&&(this.state=Ji.EXECUTING,this.emitter.emit(Oa.CONNECTION_STATE_CHANGE,st.CONNECTING),this.logger.info({msg:"Starting execution of reconnect strategy.",id:T}),this.startTimeoutTimer(this.timeout),this.executeStrategy())}startTimeoutTimer(T){this.timeoutTimerId=window.setTimeout(()=>{this.state!==Ji.IDLE&&(this.logger.info({msg:"Reconnect strategy timed out."}),this.stop(),this.emitter.emit(Oa.CONNECTION_STATE_CHANGE,st.FAILED),this.failureCallback())},T)}stop(){this.state=Ji.IDLE,clearTimeout(this.timeoutTimerId),this.stopStrategy()}reconnect(){return eu(this,void 0,void 0,function*(){if(this.ingestEndpoint&&this.streamKey){const T=this.peerClient.getConnectionState();try{this.logger.info({msg:"Attempting reconnect."}),T===st.CONNECTED?this.logger.info({msg:"Already connected! Stopping reconnect strategy."}):(yield this.peerClient.start(this.ingestEndpoint,this.streamKey),this.logger.info({msg:"Reconnect succeeded!"})),this.stop()}catch(A){throw this.logger.error({err:A}),A}}})}isActive(){return this.state!==Ji.IDLE}}class al extends Rh{constructor(){super(...arguments),this.id="ExponentialBackoffStrategy"}executeStrategy(){let T=5e3;const A=()=>eu(this,void 0,void 0,function*(){if(this.state===Ji.EXECUTING)try{this.state=Ji.RECONNECTING,yield this.reconnect()}catch{this.logger.warn({msg:"Attempted reconnect failed. Trying again in: ",nextRetry:T}),this.state=Ji.EXECUTING,this.currentTimeoutId=window.setTimeout(A,T),T*=2}});this.currentTimeoutId=window.setTimeout(A,0)}stopStrategy(){clearTimeout(this.currentTimeoutId)}}class Wm extends Rh{constructor(){super(...arguments),this.id="NetworkApiStrategy",this.onConnectionChange=()=>eu(this,void 0,void 0,function*(){if(navigator.onLine&&this.state===Ji.EXECUTING){this.state=Ji.RECONNECTING;try{yield this.reconnect()}catch{this.logger.warn({msg:"Attempted reconnect failed."}),this.state=Ji.EXECUTING}}})}executeStrategy(){navigator.connection.addEventListener("change",this.onConnectionChange),this.onConnectionChange()}stopStrategy(){navigator.connection.removeEventListener("change",this.onConnectionChange)}}class F0{static create(T,A=uo,O,L){const{reconnect:B,timeout:H}=A;if(B){const ne=Ws.getParser(navigator.userAgent).getBrowserName().toLowerCase();return["edge","chrome"].includes(ne)&&navigator.connection?new Wm(T,H,O,L):new al(T,H,O,L)}}}var Pu,ol=function(N,T,A,O){return new(A||(A=Promise))(function(L,B){function H(Z){try{se(O.next(Z))}catch(oe){B(oe)}}function ne(Z){try{se(O.throw(Z))}catch(oe){B(oe)}}function se(Z){var oe;Z.done?L(Z.value):(oe=Z.value,oe instanceof A?oe:new A(function(de){de(oe)})).then(H,ne)}se((O=O.apply(N,[])).next())})},Wa=function(N,T,A,O){if(A==="a"&&!O)throw new TypeError("Private accessor was defined without a getter");if(typeof T=="function"?N!==T||!O:!T.has(N))throw new TypeError("Cannot read private member from an object whose class did not declare it");return A==="m"?O:A==="a"?O.call(N):O?O.value:T.get(N)};const Mr=N=>!!N;function z0(N){if(!N)throw new Error("PeerConnection is not defined")}const ay={bundlePolicy:"max-bundle",rtcpMuxPolicy:"require",enableDtlsSrtp:{exact:!0},enableRtpDataChannels:{exact:!1},optional:[{googHighStartBitrate:{exact:0}},{googPayloadPadding:{exact:!0}},{googScreencastMinBitrate:{exact:100}},{googCpuOveruseDetection:{exact:!0}},{googCpuOveruseEncodeUsage:{exact:!0}},{googCpuUnderuseThreshold:{exact:55}},{googCpuOveruseThreshold:{exact:85}},{enableDscp:{exact:!0}}]};class Af{constructor(T,A,O,L,B){this.config=T,this.emitter=A,this.mediaStreamManager=O,this.analyticsTracker=B,this.establishConnection=(H,ne)=>ol(this,void 0,void 0,function*(){var se,Z,oe;z0(this.peerConnection);try{const de=yield this.peerConnection.createOffer({offerToReceiveAudio:!1,offerToReceiveVideo:!1});yield this.handleLocalDescription(de),yield this.sendSetupRequest(H,ne,de)}catch(de){if(de instanceof Error){(se=(oe=de).code)!==null&&se!==void 0||(oe.code=zn.code);const me=new Tt(Object.assign(Object.assign({},zn),{name:de.name,message:de.message,code:de==null?void 0:de.code,cause:de}));throw!((Z=this.reconnectStrategy)===null||Z===void 0)&&Z.isActive()||this.handleError(de.code,de.message),this.stop(),me}}}),this.getSessionId=()=>this.ingestSessionId,this.getConnectionState=()=>{var H;if(!this.peerConnection)return st.NONE;const ne=(H=this.reconnectStrategy)===null||H===void 0?void 0:H.isActive(),se=this.peerConnection.connectionState||this.peerConnection.iceConnectionState;switch(se){case"new":return st.NEW;case"closed":return st.CLOSED;case"disconnected":return ne?st.CONNECTING:st.DISCONNECTED;case"failed":return ne?st.CONNECTING:st.FAILED;case"idle":return st.IDLE;case"checking":case"connecting":return st.CONNECTING;case"completed":case"connected":return st.CONNECTED;default:return this.logger.warn({msg:"Unhandled connection state:",rawState:se}),st.IDLE}},this.onConnectionStateChange=()=>{var H;const ne=this.getConnectionState();switch(ne){case st.CONNECTED:{this.emitter.emit(Oa.CONNECTION_STATE_CHANGE,ne);const se=new Date;this.analyticsTracker.trackEvent(new wh(se,this.connectionStartDate,this.ingestSessionId));const Z=this.mediaStreamManager.getTrack(Zt.AUDIO),oe=this.mediaStreamManager.getTrack(Zt.VIDEO);if(oe){const de=oe.getSettings();this.analyticsTracker.trackEvent(new L0(de))}if(Z){const de=Z.getSettings();this.analyticsTracker.trackEvent(new XE(de))}(((H=this.peerConnection)===null||H===void 0?void 0:H.getSenders())||[]).forEach(de=>{var me;(((me=de.getParameters())===null||me===void 0?void 0:me.codecs)||[]).forEach(Pe=>{var Xe;switch((Xe=de.track)===null||Xe===void 0?void 0:Xe.kind){case"video":{if(!oe)break;const qe=new va().extractVideoSdpFmtpLine(Pe.sdpFmtpLine),Ie=oe.getSettings();this.analyticsTracker.trackEvent(new ZE(Ie,qe,Pe));break}case"audio":if(!Z)break;this.analyticsTracker.trackEvent(new ry(Pe))}})});break}case st.CONNECTING:this.emitter.emit(Oa.CONNECTION_STATE_CHANGE,ne),this.connectionStartDate=new Date,this.disconnectionStartDate=void 0;break;case st.FAILED:this.reconnectStrategy?this.reconnectStrategy.execute():(this.emitter.emit(Oa.CONNECTION_STATE_CHANGE,ne),this.handleTerminalConnectionFailure());break;case st.DISCONNECTED:this.emitter.emit(Oa.CONNECTION_STATE_CHANGE,ne),this.disconnectionStartDate=new Date;break;default:this.emitter.emit(Oa.CONNECTION_STATE_CHANGE,ne)}},this.handleLocalDescription=H=>ol(this,void 0,void 0,function*(){var ne;return(ne=this.peerConnection)===null||ne===void 0?void 0:ne.setLocalDescription(H)}),Pu.set(this,H=>{if(typeof H!="string")throw new Tt($a);try{new URL(H)}catch{throw new Tt(Nu)}}),this.logger=new fo(L,fe.WEBRTC),this.createReconnectStrategy(T)}start(T,A){var O;return ol(this,void 0,void 0,function*(){Wa(this,Pu,"f").call(this,T);const L=[this.mediaStreamManager.getTrack(Zt.VIDEO),this.mediaStreamManager.getTrack(Zt.AUDIO)].filter(Mr);if(this.createPeerConnection(),this.addTracks({tracks:L}),this.reconnectStrategy&&this.reconnectStrategy.setStartConfig(T,A),yield this.establishConnection(T,A),!((O=this.reconnectStrategy)===null||O===void 0)&&O.isActive()){const B=new URL(T);this.analyticsTracker.trackEvent(new Ch({protocol:"webrtc",hostname:B.hostname,port:B.port},Cd.NETWORK_DISCONNECT))}})}stop(){var T,A,O,L;this.stateCheckInterval&&(clearInterval(this.stateCheckInterval),this.stateCheckInterval=void 0),this.stopStreamDataChannel&&this.stopStreamDataChannel.readyState==="open"&&this.stopStreamDataChannel.send(" "),[st.NEW,st.CONNECTING,st.CONNECTED].includes(this.getConnectionState())&&this.emitter.emit(Oa.CONNECTION_STATE_CHANGE,st.CLOSED),(T=this.peerConnection)===null||T===void 0||T.close(),(A=this.peerConnection)===null||A===void 0||A.removeEventListener("connectionstatechange",this.onConnectionStateChange),(O=this.peerConnection)===null||O===void 0||O.removeEventListener("iceconnectionstatechange",this.onConnectionStateChange),this.ingestSessionId=void 0,(L=this.reconnectStrategy)===null||L===void 0||L.stop()}addTracks(T){var A;if(z0(this.peerConnection),!T)return;const O=this.peerConnection.getSenders().map(B=>{var H;return(H=B.track)===null||H===void 0?void 0:H.id}),L=T.tracks.filter(B=>!O.includes(B.id));for(const B of L)(A=this.peerConnection)===null||A===void 0||A.addTrack(B)}getReports(){var T;return ol(this,void 0,void 0,function*(){try{const A=(yield(T=this.peerConnection)===null||T===void 0?void 0:T.getStats())||[],O=[];return A.forEach(L=>{O.push(L)}),O}catch{return[]}})}sendSetupRequest(T,A,O){var L;return ol(this,void 0,void 0,function*(){const B=yield fetch(`${T}/v1/offer`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(Object.assign({offer:Ah(O),streamKey:A},this.config.streamConfig))});if(!B.ok)throw function(ne){let se=new Tt(Object.assign({},zn));return(ne==null?void 0:ne.code)===Ne&&(se=new Tt(Object.assign({},pi))),ne!=null&&ne.message&&(se.message=ne.message),se}(yield B.json());const H=yield B.json();H!=null&&H.answer&&(yield(L=this.peerConnection)===null||L===void 0?void 0:L.setRemoteDescription(function(ne){return JSON.parse(atob(ne))}(H.answer)),this.ingestSessionId=H.ingestSessionId)})}handleTerminalConnectionFailure(){const T=new Tt(Un);this.handleError(T.code,T.message)}handleError(T,A){this.analyticsTracker.trackEvent(new YE({code:T,description:A,isFatal:!0})),this.emitter.emit(Oa.ERROR,{code:T,message:A})}createPeerConnection(){var T;const A=this.getConnectionState(),O=A!==st.NONE,L=A!==st.CLOSED,B=(T=this.reconnectStrategy)===null||T===void 0?void 0:T.isActive();O&&L&&!B||(this.stateCheckInterval&&(clearInterval(this.stateCheckInterval),this.stateCheckInterval=void 0),this.stateCheckInterval=window.setInterval(()=>{const H=this.getConnectionState();if(this.reconnectStrategy&&H===st.DISCONNECTED&&this.disconnectionStartDate){const ne=Date.now()-this.disconnectionStartDate.getTime();this.logger.info({msg:"Time since disconnected:",timeSinceDisconnect:ne}),ne>1e4&&(this.disconnectionStartDate=void 0,this.reconnectStrategy.execute())}else H===st.CLOSED&&(this.handleTerminalConnectionFailure(),clearInterval(this.stateCheckInterval),this.stateCheckInterval=void 0)},1e3),this.peerConnection=new RTCPeerConnection(ay),this.stopStreamDataChannel=this.peerConnection.createDataChannel("stopStream"),this.peerConnection.addEventListener("connectionstatechange",this.onConnectionStateChange),this.peerConnection.addEventListener("iceconnectionstatechange",this.onConnectionStateChange))}createReconnectStrategy(T){if(this.reconnectStrategy=F0.create(this,T.networkReconnectConfig,this.logger,this.emitter),this.reconnectStrategy){this.reconnectStrategy.onFailure(this.handleTerminalConnectionFailure.bind(this));const A=this.reconnectStrategy.id;this.logger.info({msg:"Using reconnect strategy:",strategyId:A})}}}Pu=new WeakMap;var Rf,oy=r(2492);(function(N){N.CONFIG="config",N.UPDATE="update",N.START="start",N.STOP="stop"})(Rf||(Rf={}));var yx=r(477),tc=r.n(yx);function Rd(){return tc()(`/*! For license information please see scheduler.worker.worker.js.LICENSE.txt */
(()=>{"use strict";var t;!function(t){t.CONFIG="config",t.UPDATE="update",t.START="start",t.STOP="stop"}(t||(t={}));const i=self;const s=new class Scheduler{constructor(){this.config={frameRate:60,isRunning:!1}}setConfig(t){this.config=Object.assign(Object.assign({},this.config),t),this.config.isRunning&&(this.stop(),this.start())}start(){this.config.isRunning||(this.intervalId=setInterval((()=>{i.postMessage({type:t.UPDATE})}),1e3/this.config.frameRate),this.config.isRunning=!0)}stop(){this.config.isRunning&&(clearInterval(this.intervalId),this.intervalId=void 0,this.config.isRunning=!1)}};i.addEventListener("message",(function(i){var n;if(null===(n=null==i?void 0:i.data)||void 0===n?void 0:n.type)switch(i.data.type){case t.CONFIG:s.setConfig(i.data.payload||{});break;case t.START:s.start();break;case t.STOP:s.stop()}}))})();`,"Worker",void 0,void 0)}var Mh=function(N,T,A,O){return new(A||(A=Promise))(function(L,B){function H(Z){try{se(O.next(Z))}catch(oe){B(oe)}}function ne(Z){try{se(O.throw(Z))}catch(oe){B(oe)}}function se(Z){var oe;Z.done?L(Z.value):(oe=Z.value,oe instanceof A?oe:new A(function(de){de(oe)})).then(H,ne)}se((O=O.apply(N,[])).next())})};class eS{constructor(T,A,O){this.config=T,this.mediaStreamManager=A,this.analyticsTracker=O,this.handleWorkerEvent=ne=>{var se;((se=ne.data)===null||se===void 0?void 0:se.type)===Rf.UPDATE&&this.drawComposite()},this.mixer={video:[],audio:[]},this.schedulerWorker=new Rd,this.running=!1,this.compositeEl=document.createElement("canvas"),this.compositeEl.height=this.config.streamConfig.maxResolution.height,this.compositeEl.width=this.config.streamConfig.maxResolution.width;const L=this.compositeEl.getContext("2d");if(L===null)throw new Tt(Object.assign({},Cn));this.compositeContext=L,this.compositeStream=this.compositeEl.captureStream(typeof CanvasCaptureMediaStreamTrack!==void 0?0:30);const B=fn(this.compositeStream.getTracks(),Zt.VIDEO);this.audioContext=new AudioContext,this.unlockAudioContext(),this.audioDestination=this.audioContext.createMediaStreamDestination(),this.setupSilence();const H=fn(this.audioDestination.stream.getTracks(),Zt.AUDIO);B&&this.mediaStreamManager.setTrack(Zt.VIDEO,B),H&&this.mediaStreamManager.setTrack(Zt.AUDIO,H),this.schedulerWorker.addEventListener("message",this.handleWorkerEvent),this.schedulerWorker.postMessage({type:Rf.CONFIG,payload:{frameRate:this.config.streamConfig.maxFramerate}}),this.previewElement=null,this.previewCtx=null,this.nextMix=new Date().getTime()}attachPreview(T){this.previewElement=T;const{width:A,height:O}=this.config.streamConfig.maxResolution;this.previewElement.width=A,this.previewElement.height=O,this.previewCtx=this.previewElement.getContext("2d")}detachPreview(){this.previewElement=null,this.previewCtx=null}setupSilence(){const T=this.audioContext.createConstantSource(),A=this.audioContext.createGain();A.gain.value=.001,T.connect(A),A.connect(this.audioDestination),T.start()}unlockAudioContext(){if(this.audioContext.state!=="suspended")return;const T=document.body,A=["touchstart","touchend","mousedown","keydown"],O=()=>{A.forEach(B=>{T.removeEventListener(B,L)})},L=()=>{this.audioContext.resume().then(O)};A.forEach(B=>{T.addEventListener(B,L,!1)})}getTracks(){return[this.mediaStreamManager.getTrack(Zt.VIDEO),this.mediaStreamManager.getTrack(Zt.AUDIO)]}getCanvasVideoTrack(){return this.mediaStreamManager.getTrack(Zt.VIDEO)}getAudioInputDevice(T){if(typeof T!="string")return;const A=this.mixer.audio.find(O=>{if(O.name===T)return O.source});return A==null?void 0:A.source}getVideoInputDevice(T){if(typeof T=="string")return this.mixer.video.find(A=>A.name===T)}getCanvasDimensions(){return{height:this.compositeEl.height,width:this.compositeEl.width}}addVideoInputDevice(T,A,O){var L;return Mh(this,void 0,void 0,function*(){if(typeof T!="object")throw new Tt(Object.assign({},ht));if(!A||typeof A!="string")throw new Tt(Object.assign({},Ve));if(this.mixer.video.some(me=>me.name===A))throw new Tt(Object.assign({},Pt));if(!O)throw new Tt(Object.assign({},hn));if(typeof O.index!="number")throw new Tt(Object.assign({},on));const B=function(){const me=document.createElement("video");return me.autoplay=!0,me.muted=!0,me.setAttribute("playsinline",""),me.setAttribute("webkit-playsinline",""),me}(),H=T.getVideoTracks(),[ne]=H;if(!H.length)throw new Tt(Object.assign({},je));const se=ne.getConstraints(),Z=oy({},se,{frameRate:this.config.streamConfig.maxFramerate});try{yield ne.applyConstraints(Z)}catch(me){let Pe="Unknown constraints error";me instanceof Error&&(Pe=me.message),this.analyticsTracker.trackEvent(new YE({description:`${Mt.message}: ${Pe}`,isFatal:!1,code:Mt.code}))}const oe=()=>Mh(this,void 0,void 0,function*(){let me=0;for(;me<5;)try{return void(yield B.play())}catch(Pe){if(!(Pe instanceof Error))throw new Error("unknown error trying to add video to broadcast");me++,yield new Promise(Xe=>setTimeout(Xe,150))}throw new Error("Error playing video, tries exceeded")}),de=new MediaStream([ne]);B.srcObject=de;try{yield oe();const me={name:A,element:B,position:O,source:de,render:!0},Pe=((L=ne.getSettings)===null||L===void 0?void 0:L.call(ne))||{};this.analyticsTracker.trackEvent(new iy(Bt(Pe),Pe)),this.mixer.video.push(me)}catch(me){throw new Tt(Object.assign(Object.assign({},je),{cause:me}))}})}addImageSource(T,A,O){var L;return Mh(this,void 0,void 0,function*(){if(!T)throw new Tt(Object.assign({},ht));if(!A||typeof A!="string")throw new Tt(Object.assign({},Ve));if(T.tagName==="image")throw new Tt(Object.assign({},at));if(this.mixer.video.some(H=>H.name===A))throw new Tt(Object.assign({},Pt));if(!O)throw new Tt(Object.assign({},hn));if(typeof O.index!="number")throw new Tt(Object.assign({},on));if(T instanceof Image){const H=(L=T.src)===null||L===void 0?void 0:L.slice();try{const ne=T.src?new URL(T.src):{};if(ne.host&&ne.hostname){const se=yield fetch(T.src).then(oe=>Mh(this,void 0,void 0,function*(){return oe.blob()})),Z=yield new Promise(oe=>{const de=new FileReader;de.onload=()=>{oe(de.result)},de.readAsDataURL(se)});T.src=Z}}catch{throw new Tt(Object.assign(Object.assign({},sn),{params:{details:`Image URL: ${H}`}}))}}const B={name:A,element:T,position:O,render:!0};this.mixer.video.push(B)})}addAudioInputDevice(T,A){return Mh(this,void 0,void 0,function*(){if(typeof T!="object")throw new Tt(Object.assign({},ht));if(!A||typeof A!="string")throw new Tt(Object.assign({},Ve));if(this.mixer.audio.some(ne=>ne.name===A))throw new Tt(Object.assign({},Pt));const O=T.getAudioTracks();if(!O.length)throw new Tt(Object.assign({},zt));const L=this.audioContext.createMediaStreamSource(new MediaStream(O)),B=this.audioContext.createGain();B.gain.value=1,L.connect(B),B.connect(this.audioDestination);const H={name:A,source:T,audioTrackSource:L,gainNode:B};this.analyticsTracker.trackEvent(new iy("audio",{deviceId:T.id})),this.mixer.audio.push(H)})}removeImage(T){const A=this.mixer.video.findIndex(O=>O.name===T);if(A<0)throw new Tt(Object.assign({},Zn));this.mixer.video.splice(A,1)}removeVideoInputDevice(T){var A;const O=this.removeDevice(T,this.mixer.video);if(!O)throw new Tt(Object.assign({},Ot));{const L=fn(O.source.getTracks(),Zt.VIDEO);if(!L)throw new Tt(Object.assign({},Ot));O.element.srcObject=null,L.stop();const B=((A=L==null?void 0:L.getSettings)===null||A===void 0?void 0:A.call(L))||{};this.analyticsTracker.trackEvent(new px(Bt(B),B))}}removeAudioInputDevice(T){const A=this.removeDevice(T,this.mixer.audio);if(A!=null&&A.audioTrackSource){for(const O of A.source.getTracks())O.stop(),this.analyticsTracker.trackEvent(new px("audio",{deviceId:O.id}));A.gainNode.disconnect(this.audioDestination)}else if(!A)throw new Tt(Object.assign({},Ot))}updateVideoDeviceComposition(T,A){if(!T||typeof T!="string")throw new Tt(Object.assign({},ai));if(!A)throw new Tt(Object.assign({},or));if(typeof A.index!="number")throw new Tt(Object.assign({},wi));this.mixer.video.forEach((O,L)=>{O.name===T&&(O.position=A)})}exchangeVideoDevicePositions(T,A){const O=this.getVideoInputDevice(T),L=this.getVideoInputDevice(A);if(!O)throw new Tt(Object.assign(Object.assign({},xn),{params:{details:`device with name: "${T}" not found`}}));if(!L)throw new Tt(Object.assign(Object.assign({},xn),{params:{details:`device with name: "${A}" not found`}}));const B=Object.assign({},O.position),H=Object.assign({},L.position);for(const ne of this.mixer.video)ne.name===T&&(Ym(H.x)?ne.position=Object.assign(Object.assign({},ne.position),H):ne.position={index:H.index}),ne.name===A&&(Ym(B.x)?ne.position=Object.assign(Object.assign({},ne.position),B):ne.position={index:B.index})}start(){this.running||(this.running=!0,this.schedulerWorker.postMessage({type:Rf.CONFIG,payload:{frameRate:this.config.streamConfig.maxFramerate}}),this.schedulerWorker.postMessage({type:Rf.START}))}stop(){this.running&&(this.running=!1,this.schedulerWorker.removeEventListener("message",this.handleWorkerEvent))}isCapturing(){return this.running}getAudioLatency(){return this.audioContext.baseLatency}getVideoLatency(){var T;return((T=this.mediaStreamManager.getTrack(Zt.VIDEO))===null||T===void 0?void 0:T.getConstraints().latency)||0}disableVideo(){this.mixer.video.forEach(T=>{T.render=!1})}enableVideo(){this.mixer.video.forEach(T=>{T.render=!0})}disableAudio(){this.mixer.audio.forEach(T=>{T.audioTrackSource&&(T.gainNode.gain.value=0)})}enableAudio(){this.mixer.audio.forEach(T=>{T.audioTrackSource&&(T.gainNode.gain.value=1)})}getDrawRegion(T,A,O){var L,B,H,ne;let se=(L=T.position.x)!==null&&L!==void 0?L:0,Z=(B=T.position.y)!==null&&B!==void 0?B:0;const oe=(H=T.position.width)!==null&&H!==void 0?H:A-se,de=(ne=T.position.height)!==null&&ne!==void 0?ne:O-Z,me=oe/de;let Pe=T.element.width,Xe=T.element.height;T.element instanceof HTMLVideoElement&&(Pe=T.element.videoWidth,Xe=T.element.videoHeight);const qe=Pe/Xe;let Ie=oe,xe=de;return qe>me?(Ie=oe,xe=2*Math.round(oe/qe/2),Z+=(de-xe)/2):qe<me&&(xe=de,Ie=2*Math.round(de*qe/2),se+=(oe-Ie)/2),{x:se,y:Z,width:Ie,height:xe}}drawComposite(){if(!this.shouldMix(new Date))return;this.compositeContext.clearRect(0,0,this.compositeEl.width,this.compositeEl.height),this.drawBlackScreen();const T=this.mixer.video.filter(A=>A.render);T.sort((A,O)=>A.position.index-O.position.index);for(const A of T){const{x:O,y:L,width:B,height:H}=this.getDrawRegion(A,this.compositeEl.width,this.compositeEl.height);this.compositeContext.drawImage(A.element,O,L,B,H)}this.previewElement&&this.previewCtx&&this.previewCtx.drawImage(this.compositeEl,0,0,this.previewElement.width,this.previewElement.height),this.requestCanvasCapture()}requestCanvasCapture(){typeof CanvasCaptureMediaStreamTrack!==void 0&&(typeof this.compositeStream.requestFrame=="function"?this.compositeStream.requestFrame():this.mediaStreamManager.getTrack(Zt.VIDEO).requestFrame())}drawBlackScreen(){this.compositeContext.fillStyle="#000000",this.compositeContext.fillRect(0,0,this.compositeEl.width,this.compositeEl.height)}removeDevice(T,A){const O=A.findIndex(L=>(B=>B.name===T)(L));if(!(O<0))return A.splice(O,1)[0]}shouldMix(T){if(T.getTime()<this.nextMix)return!1;for(;this.nextMix<=T.getTime();)this.nextMix+=1e3/this.config.streamConfig.maxFramerate;return!0}}function Ym(N){return Number.isSafeInteger(N)}var Km,j0,Mf=function(N,T,A,O){return new(A||(A=Promise))(function(L,B){function H(Z){try{se(O.next(Z))}catch(oe){B(oe)}}function ne(Z){try{se(O.throw(Z))}catch(oe){B(oe)}}function se(Z){var oe;Z.done?L(Z.value):(oe=Z.value,oe instanceof A?oe:new A(function(de){de(oe)})).then(H,ne)}se((O=O.apply(N,[])).next())})},H0=function(N,T,A,O){if(A==="a"&&!O)throw new TypeError("Private accessor was defined without a getter");if(typeof T=="function"?N!==T||!O:!T.has(N))throw new TypeError("Cannot read private member from an object whose class did not declare it");return A==="m"?O:A==="a"?O.call(N):O?O.value:T.get(N)};class Du{constructor(T){this.config=T,Km.add(this),this.emitter=new ho,this.isValid=!0,this.emitter.on(Oa.ERROR,this.stopBroadcast),this.config.ingestEndpoint&&(this.url=new URL(this.config.ingestEndpoint)),this.analyticsTracker=new wd,this.mediaStreamManager=new Hi;const A=new qm(T.logLevel,T.logger);this.peerClient=new Af(this.config,this.emitter,this.mediaStreamManager,A,this.analyticsTracker),this.broadcastCanvasManager=new eS(T,this.mediaStreamManager,this.analyticsTracker),this.peerStatsTracker=new _x(this.peerClient,this.broadcastCanvasManager,A,this.analyticsTracker),this.broadcastCanvasManager.start(),Object.getOwnPropertyNames(Du.prototype).forEach(O=>{this[O]=new Proxy(this[O],{apply:(L,B,H)=>{if(!B.isValid)throw new Tt(Object.assign({},I0));return Reflect.apply(L,B,H)}})}),window.addEventListener("beforeunload",()=>{this.analyticsTracker.stop(!0)})}delete(){this.isValid=!1,this.peerClient.stop(),this.broadcastCanvasManager.stop(),this.emitter.removeAllListeners()}startBroadcast(T,A){return Mf(this,void 0,void 0,function*(){H0(this,Km,"m",j0).call(this,T);const O=Th(A||this.config.ingestEndpoint);this.analyticsTracker.start(),this.peerStatsTracker.start(),yield this.peerClient.start(O,T),this.emitter.emit(Oa.ACTIVE_STATE_CHANGE,!0),this.url=new URL(O),this.url&&this.analyticsTracker.trackEvent(new Ch({protocol:"webrtc",hostname:this.url.hostname,port:this.url.port},Cd.USER_INITIATED))})}stopBroadcast(){var T,A,O;this.url&&this.analyticsTracker.trackEvent(new Gm({protocol:"webrtc",hostname:this.url.hostname,port:this.url.port})),(T=this.peerStatsTracker)===null||T===void 0||T.stop(),(A=this.peerClient)===null||A===void 0||A.stop(),(O=this.emitter)===null||O===void 0||O.emit(Oa.ACTIVE_STATE_CHANGE,!1)}getCanvasDimensions(){return this.broadcastCanvasManager.getCanvasDimensions()}addVideoInputDevice(T,A,O){return Mf(this,void 0,void 0,function*(){return this.broadcastCanvasManager.addVideoInputDevice(T,A,O)})}addImageSource(T,A,O){return Mf(this,void 0,void 0,function*(){return this.broadcastCanvasManager.addImageSource(T,A,O)})}addAudioInputDevice(T,A){return Mf(this,void 0,void 0,function*(){return this.broadcastCanvasManager.addAudioInputDevice(T,A)})}removeVideoInputDevice(T){this.broadcastCanvasManager.removeVideoInputDevice(T)}removeAudioInputDevice(T){this.broadcastCanvasManager.removeAudioInputDevice(T)}removeImage(T){this.broadcastCanvasManager.removeImage(T)}updateVideoDeviceComposition(T,A){this.broadcastCanvasManager.updateVideoDeviceComposition(T,A)}exchangeVideoDevicePositions(T,A){this.broadcastCanvasManager.exchangeVideoDevicePositions(T,A)}getAudioInputDevice(T){return this.broadcastCanvasManager.getAudioInputDevice(T)}getVideoInputDevice(T){return this.broadcastCanvasManager.getVideoInputDevice(T)}getConnectionState(){return this.peerClient.getConnectionState()}getSessionId(){return this.peerClient.getSessionId()}on(T,A){this.emitter.on(T,A)}off(T,A){this.emitter.off(T,A)}getAudioContext(){return this.broadcastCanvasManager.audioContext}attachPreview(T){this.broadcastCanvasManager.attachPreview(T)}detachPreview(){this.broadcastCanvasManager.detachPreview()}disableVideo(){this.broadcastCanvasManager.disableVideo()}enableVideo(){this.broadcastCanvasManager.enableVideo()}disableAudio(){this.broadcastCanvasManager.disableAudio()}enableAudio(){this.broadcastCanvasManager.enableAudio()}}function Vr(N){return new Du(function(T){const A=new ds;return A.streamConfig=T.streamConfig,A.ingestEndpoint=T.ingestEndpoint,A.logger=T.logger,A.logLevel=T.logLevel,A.networkReconnectConfig=T.networkReconnectConfig,A}(N))}Km=new WeakSet,j0=function(N){if(typeof N!="string"||!/^[a-zA-Z0-9_-]+$/.test(N))throw new Tt(Iu)};const V0="1.19.0";var dn,_a=r(6486);(function(N){N.PUBLISH="publish",N.SUBSCRIBE="subscribe",N.JOIN="join",N.LEAVE="leave"})(dn||(dn={}));const G0=2;class Lu extends Yn{constructor(T){super(Sn.LEAVE,T.token,T.traceId,!1),Object.assign(this.properties,{action:dn.LEAVE,event_endpoint:T.eventEndpoint,whip_endpoint:T.whipEndpoint,reason:T.reason}),this.critical=!0}}class cl{constructor(){this.emitter=new ho}on(T,A,O){A.call=function(L,B){return function(H,...ne){try{B.apply(H,ne)}catch(se){let Z=`Error in callback for ${L}`;const oe=B.name;return oe&&(Z+=` for function ${oe}`),void console.error(`${Z}
`,se)}}}(T,A),this.emitter.on(T,A,O)}off(T,A,O){this.emitter.off(T,A,O)}emit(T,...A){this.emitter.emit(T,...A)}removeAllListeners(){this.emitter.removeAllListeners()}}function q0(N){const T="0123456789abcdef";let A="";for(let O=0;O<N;O+=1)A+=T.charAt(Math.floor(Math.random()*T.length));return A}class Hp{constructor(){const T=q0;this.value=`${T(8)}-${T(4)}-${T(4)}-${T(4)}-${T(12)}`}}function Na(){return new Hp}class tS{constructor(){const T=(Date.now()/1e3|0).toString(16);this.value=`1-${T}-${q0(24)}`}}function wc(){return new tS}var Ms=r(9669),na=r.n(Ms);class ki extends Tt{constructor({token:T,traceId:A,code:O,tag:L,location:B,message:H,details:ne,remoteParticipantId:se,requestUUID:Z,fatal:oe,nominal:de,action:me}){super({name:"StageClientError",message:H,code:O}),Error.captureStackTrace&&Error.captureStackTrace(this,ki),this.action=me,this.token=T,this.traceId=A,this.code=O,this.tag=L,this.location=B,this.message=H,this.details=ne,this.remoteParticipantId=se,this.requestUUID=Z,this.fatal=oe,this.nominal=de}}const Cc={JOIN_RELATED:"signalling_session",PUBLISH_RELATED:"webrtc_sink",UNPUBLISH_RELATED:"webrtc_unsink",SUBSCRIBE_RELATED:"webrtc_source"};function ko(N,T){switch(N){case dn.PUBLISH:return Cc.PUBLISH_RELATED;case dn.SUBSCRIBE:return`webrtc_source:${T}`;default:return"unknown"}}function Vp(N,T){var A,O,L,B;const H={code:N.code,message:`${N.message}: ${T.name} ${T.message}`,fatal:(A=N.fatal)!==null&&A!==void 0&&A,nominal:(O=N.nominal)!==null&&O!==void 0&&O};return T instanceof ki&&(H.fatal=(L=T.fatal)!==null&&L!==void 0&&L,H.nominal=(B=T.nominal)!==null&&B!==void 0&&B),H}function $0(N,T){if(N===0)return Ut.UNKNOWN_SERVER_ERROR;if(!(N<400))if(N>=400&&N<=403)switch(T){case Po.TokenExpired:return Ut.EXPIRED_TOKEN;case Po.NoPermissions:return Ut.TOKEN_PERMISSIONS_DENIED;case Po.StageAtCapacity:return Ut.STAGE_AT_CAPACITY;case Po.NoMatchingCodec:return Ut.NO_MATCHING_CODEC;default:return Ut.UNKNOWN_SERVER_ERROR}else{if(N===404)return T===Po.RemoteStreamNotFound?Ut.REMOTE_STREAM_NOT_FOUND:Ut.UNKNOWN_SERVER_ERROR;if(N===412)return T===Po.AbortedMHCPError?Ut.MHCP_ABORTED:Ut.UNKNOWN_SERVER_ERROR;if(N===429)return T===Po.StageAuthThrottled?Ut.STAGE_AUTH_THROTTLED:Ut.WHIP_TOO_MANY_REQUESTS;if(N!==500)return Ut.UNKNOWN_SERVER_ERROR;switch(T){case Po.InternalMHCPError:return Ut.INTERNAL_MHCP_ERROR;case Po.UnreachableMHCP:return Ut.UNREACHABLE_MHCP;case Po.InvalidSessionStatus:return Ut.INVALID_SESSION_STATUS;default:return Ut.INTERNAL_SERVER_ERROR}}}var Po;(function(N){N[N.Unspecified=2001]="Unspecified",N[N.TokenExpired=2002]="TokenExpired",N[N.NoPermissions=2003]="NoPermissions",N[N.RemoteStreamNotFound=2004]="RemoteStreamNotFound",N[N.StageAtCapacity=2005]="StageAtCapacity",N[N.InternalMHCPError=2006]="InternalMHCPError",N[N.UncategorizedMHCPError=2007]="UncategorizedMHCPError",N[N.UnreachableMHCP=2008]="UnreachableMHCP",N[N.InvalidSessionStatus=2010]="InvalidSessionStatus",N[N.PostWithoutOptions=2011]="PostWithoutOptions",N[N.AbortedMHCPError=2012]="AbortedMHCPError",N[N.StageAuthThrottled=2013]="StageAuthThrottled",N[N.NoMatchingCodec=2014]="NoMatchingCodec"})(Po||(Po={}));const Ut={MALFORMED_TOKEN:{code:1e3,message:"Token is malformed",fatal:!0,nominal:!0},EXPIRED_TOKEN:{code:1001,message:"Token expired and is no longer valid",fatal:!0,nominal:!0},UNPUBLISH_FAILURE:{code:1013,message:"Failed to unpublish",fatal:!1,nominal:!1},UNSUBSCRIBE_FAILURE:{code:1014,message:"Failed to unsubscribe",fatal:!1,nominal:!1},PUBLISH_FAILURE:{code:1015,message:"Failed to publish",fatal:!1,nominal:!1},SUBSCRIBE_FAILURE:{code:1016,message:"Failed to subscribe",fatal:!1,nominal:!1},JOIN_FAILURE:{code:1017,message:"Failed to join",fatal:!0,nominal:!1},JOIN_TIMED_OUT:{code:1019,message:"Join timed out",fatal:!0,nominal:!1},PUBLISH_TIMED_OUT:{code:1020,message:"Publish timed out",fatal:!1,nominal:!1},SUBSCRIBE_TIMED_OUT:{code:1021,message:"Subscribe timed out",fatal:!1,nominal:!1},NO_CANDIDATES:{code:1022,message:"No ICE candidates",fatal:!1,nominal:!1},OPERATION_ABORTED:{code:1023,message:"Request aborted",fatal:!1,nominal:!0},STAGE_AT_CAPACITY:{code:1024,message:"Stage at capacity",fatal:!0,nominal:!0},INTERNAL_SERVER_ERROR:{code:1025,message:"Internal server error",fatal:!0,nominal:!1},TOKEN_PERMISSIONS_DENIED:{code:1026,message:"Token permissions are not valid for the operation",fatal:!0,nominal:!1},REMOTE_STREAM_NOT_FOUND:{code:1027,message:"Contributor group (PUBLISH) or remote stream (SUBSCRIBE) not found",fatal:!0,nominal:!1},INTERNAL_MHCP_ERROR:{code:1028,message:"Authorization failed due to internal MHCP error",fatal:!0,nominal:!1},UNCATEGORIZED_MHCP_ERROR:{code:1029,message:"Authorization failed due to uncategorized MHCP error",fatal:!0,nominal:!1},UNREACHABLE_MHCP:{code:1030,message:"Authorization failed due to MHCP unreachable",fatal:!0,nominal:!1},INVALID_SESSION_STATUS:{code:1031,message:"Stream has already been published (PUBLISH) or subscribed to (SUBSCRIBE)",fatal:!0,nominal:!1},POST_WITHOUT_OPTIONS:{code:1032,message:"Cannot POST without OPTIONS in mandatory TURN",fatal:!0,nominal:!1},MHCP_ABORTED:{code:1033,message:"Publisher state conflict",fatal:!0,nominal:!1},STAGE_AUTH_THROTTLED:{code:1034,message:"Too many requests",fatal:!1,nominal:!1},NO_MATCHING_CODEC:{code:1035,message:"No matching codec found",fatal:!0,nominal:!1},CHIME_MEETING_NOT_FOUND:{code:1098,message:"Meeting or Attendee was deleted",fatal:!0,nominal:!0},UNKNOWN_SERVER_ERROR:{code:1099,message:"Service error code unknown or not found",fatal:!0,nominal:!1},XDP_CONNECTION_LOST:{code:1221,message:"Connection lost during SDP exchange",fatal:!1,nominal:!1},XDP_INVALID_ANSWER_MSG:{code:1222,message:"Invalid answer message received by client",fatal:!1,nominal:!1},XDP_TIMEOUT:{code:1223,message:"Failed to receive SDP answer within timeout period",fatal:!1,nominal:!1},XDP_UNEXPECTED_ERROR:{code:1224,message:"Unexpected error encountered",fatal:!1,nominal:!1},WEBSOCKET_MESSAGE_PARSE_FAILURE:{code:1204,message:"Failed to parse websocket message",fatal:!1,nominal:!1},WHIP_SESSION_RESOURCE_DELETED:{code:1206,message:"WHIP signaling session resource not found",fatal:!0,nominal:!0},WHIP_TOO_MANY_REQUESTS:{code:1207,message:"WHIP endpoint received too many requests",fatal:!1,nominal:!1},WHIP_OPTIONS_FAILURE:{code:1501,message:"Failed to get ICE Servers from OPTIONS",fatal:!1,nominal:!1},WHIP_POST_FAILURE:{code:1502,message:"WHIP post failure",fatal:!1,nominal:!1},WHIP_DELETE_FAILURE:{code:1503,message:"WHIP delete failure",fatal:!1,nominal:!1},WHIP_URL_MISSING:{code:1504,message:"WHIP delete failure",fatal:!1,nominal:!1},WHEP_SET_LAYER_REQUEST_FAILED:{code:1510,message:"Set layer request failed for reason: Unknown",fatal:!1,nominal:!1},WHEP_SET_LAYER_REQUEST_THROTTLED:{code:1511,message:"Too many set layer requests",fatal:!1,nominal:!0},WHEP_GET_LAYER_STATE_FAILED:{code:1512,message:"Get layer state failed for reason: Unknown",fatal:!1,nominal:!1},WHEP_GET_LAYER_STATE_THROTTLED:{code:1513,message:"Too many get layer state requests",fatal:!1,nominal:!0},EVENT_PLANE_WS_CREATE_FAILED:{code:1300,message:"Error creating WebSocket",fatal:!0,nominal:!1},EVENT_PLANE_WS_UNEXPECTED_CLOSE:{code:1302,message:"Unexpectedly not connected to event plane",fatal:!1,nominal:!1},EVENT_PLANE_PING_SEND_FAIL:{code:1303,message:"Ping send fail",fatal:!1,nominal:!1},EVENT_PLANE_PONG_TIMEOUT:{code:1304,message:"Pong timed out",fatal:!1,nominal:!1},EVENT_PLANE_WS_CLOSE_BEFORE_OPEN:{code:1305,message:"Connect attempt closed by server",fatal:!1,nominal:!1},PEER_CONNECTION_NETWORK_FAILURE:{code:1400,message:"PeerConnection is lost due to unknown network error",fatal:!1,nominal:!1},CREATE_OFFER_FAILURE:{code:1402,message:"Failed to set local description",fatal:!1,nominal:!1},CREATE_PEER_CONNECTION_FAILURE:{code:1403,message:"Failed to create a peer connection",fatal:!1,nominal:!1},ICE_CANDIDATE_ERROR:{code:1404,message:"ICE candidate error",fatal:!1,nominal:!1},SET_ANSWER_FAILURE:{code:1405,message:"Failed to set remote answer",fatal:!1,nominal:!1},NETWORK_FAILURE:{code:1406,message:"Failed due to network problem",fatal:!1,nominal:!1},REASSIGNMENT_REQUEST_INVALID_LOCAL_PARTICIPANT_ID:{code:1470,message:"Invalid participant id in the reassignment message",fatal:!1,nominal:!1},REASSIGNMENT_REQUEST_INVALID_REMOTE_PARTICIPANT_ID:{code:1471,message:"Invalid remote participant id in the reassignment message",fatal:!1,nominal:!1},REASSIGNMENT_REQUEST_INVALID_REMOTE_PEER_CONNECTION_STATE:{code:1472,message:"Invalid subscriber peer connection state for reassignment",fatal:!1,nominal:!1},REASSIGNMENT_REQUEST_ALREADY_IN_PROGRESS:{code:1473,message:"Request rejected because client is already processing a previous reassignment request",fatal:!1,nominal:!1},UNEXPECTED_ERROR:{code:9999,message:"Encountered unexpected error condition. Expected StageClientError type.",fatal:!1,nominal:!1},TRANSFORM_UNEXPECTED_ERROR:{code:1480,message:"Unexpected error occurred during transform execution",fatal:!1,nominal:!1},TRANSFORM_TOO_MANY_ERRORS:{code:1481,message:"Transformer encountered too many consecutive errors",fatal:!1,nominal:!1},TRANSFORM_NOT_SUPPORTED_BY_PLATFORM:{code:1482,message:"Transforms are not supported by this platform",fatal:!1,nominal:!1},CODEC_HANDLE_INCOMPATIBLE_UNEXPECTED_ERROR:{code:1490,message:"Unexpected error occurred when handling incompatible codecs",fatal:!1,nominal:!1}};var Ia;(function(N){N.UNPUBLISH="unpublish",N.UNSUBSCRIBE="unsubscribe",N.UNLOAD="unload",N.CONNECTION_FAIL="connection fail",N.REASSIGNMENT="reassignment"})(Ia||(Ia={}));const Xm="stageJoined",Of="stageParticipantJoined",Md="stageParticipantLeft",ya="stageParticipantKicked",W0="stageParticipantUpdated",Ac="localPublishingChanged",bx="stageRefresh",kl="stateChange",Gp="error",tu="reassignmentRequest",Nf="incompatibleCodecs",Zm="connectionStateChange",ve="stageStreamUpdate",Od="error",Oh="stageStreamSeiMessageReceived",po="transformError",Bi="reassignmentStarted",Nd="reassignmentSuccess",Uu="reassignmentFailed",ll="open",Bu="closed",Rc="messageParseError",cy="refresh",nu="error",ly="stageStateMessage",Y0="sdpAnswer",K0="disconnectMessage",If="reassignmentMessage",Do="incompatibleCodecs";function nS(N){return A=function(O){return O.replace(/-/g,"+").replace(/_/g,"/").padEnd(O.length+(4-O.length%4)%4,"=")}(N),window.atob(A);var A}class nc{constructor(T,A){this.analyticsTracker=A,this.rawToken=T;const O=T.split(".");if(O.length!==3)throw Error(`Token format incorrect. length: ${O.length}`);try{this.header=JSON.parse(nS(O[0]))}catch(H){const ne=H instanceof Error?`: ${H.message}`:"";throw Error(`Error parsing Stage Token header${ne}`)}try{this.claims=JSON.parse(nS(O[1]))}catch(H){const ne=H instanceof Error?`: ${H.message}`:"";throw Error(`Error parsing Stage Token claims${ne}`)}this.signature=O[2];const{claims:L}=this;this.stageARN=L.resource,this.participantID=L.jti,this.eventsURL=L.events_url,this.whipURL=xd("whipUrl")||L.whip_url,this.userID=L.user_id,this.expirationTime=L.exp,this.topic=L.topic,this.parseVersionFlags(L.version);const{attributes:B}=L;B&&(this.attrGsRole=B.gs_role,this.attrGsSessionId=B.gs_session_id)}getPublishEndpoint(){let T="";return this.whipURL&&this.participantID&&(T=`${this.whipURL}/publish/${this.participantID}`),T}getSubscribeEndpoint(T){let A="";return this.whipURL&&(A=`${this.whipURL}/subscribe/${T}`),A}assertTokenIsUnexpired(T,A,O,L){(!this.expirationTime||Date.now()/1e3>=this.expirationTime)&&this.analyticsTracker.trackErrorAndThrow(new ki(Object.assign(Object.assign({},Ut.EXPIRED_TOKEN),{action:dn.JOIN,location:O,tag:A,token:this,traceId:T,remoteParticipantId:L,message:Ut.EXPIRED_TOKEN.message,details:`Token expired at ${this.expirationTime} and is no longer valid`})))}parseVersionFlags(T){if(!T)return;const A=T.split(".");A.length===2&&(this.versionFlags=parseInt(A[1],10))}shouldSendSilentAudio(){return this.versionFlags===void 0||(this.versionFlags&G0)!=0}}function Fu(N,T){return new nc(N,T)}class X0{constructor(T,A){this.throttleDuration=0,this.throttled=!1,this.timeout=0,this.unthrottle=()=>{this.trailing&&this.trailingFn&&this.trailingFn(...this.trailingFnArgs),this.clear()},this.throttleDuration=T,this.trailing=!(A&&A.skipTrailing)}invoke(T,...A){return this.throttled?(this.trailingFn=T,this.trailingFnArgs=A,!1):(this.throttled=!0,this.timeout=window.setTimeout(this.unthrottle,this.throttleDuration),T(...A),!0)}clear(){clearTimeout(this.timeout),this.timeout=0,this.throttled=!1,delete this.trailingFn,delete this.trailingFnArgs}}class Id extends Yn{constructor(T,A,O,L,B,H,ne,se){super(Sn.SERVER_REQUEST,A,ne,!0),Object.assign(this.properties,{action:T,http_method:L,remote_participant_id:H,request_uuid:B,url:O,transport:se})}}const Mc="draft-ietf-wish-whip-04";var fs,uy=function(N,T,A,O){return new(A||(A=Promise))(function(L,B){function H(Z){try{se(O.next(Z))}catch(oe){B(oe)}}function ne(Z){try{se(O.throw(Z))}catch(oe){B(oe)}}function se(Z){var oe;Z.done?L(Z.value):(oe=Z.value,oe instanceof A?oe:new A(function(de){de(oe)})).then(H,ne)}se((O=O.apply(N,[])).next())})};function kf(N,T){return uy(this,void 0,void 0,function*(){N.validateStatus=O=>O>=200&&O<300||O===403;const A=yield na()(N);if(A.status===403){if(A.data.code===2003)throw new Ms.AxiosError("Request failed with status code 403","ERR_BAD_REQUEST",N,A.request,A);return N.url===A.request.responseURL?(N.validateStatus=O=>O>=200&&O<300,na()(N)):(N.url=A.request.responseURL,T<5?kf(N,T+1):(N.validateStatus=O=>O>=200&&O<300,na()(N)))}return A})}function Pl(N){return uy(this,void 0,void 0,function*(){return kf(N,0)})}function Z0(){}function iS(N){switch(N){case"new":return st.NEW;case"closed":return st.CLOSED;case"disconnected":return st.DISCONNECTED;case"failed":return st.FAILED;case"idle":return st.IDLE;case"checking":case"connecting":return st.CONNECTING;case"completed":case"connected":return st.CONNECTED;default:throw new Error(`unknown connecion state: ${N}`)}}function Jm(N,T,A){let O=document.createElement(T);const L=()=>{O&&(O.removeEventListener("loadeddata",B),O.removeEventListener("error",L),O.srcObject=null,O.src="",O=null)},B=()=>{L(),A(T)};return O.addEventListener("loadeddata",B),O.addEventListener("error",L),O.srcObject=N,L}class Qm extends Yn{constructor(T,A,O,L,B){super(Sn.TRACE,T,A,!1),Object.assign(this.properties,{action:L,message:O,remote_participant_id:B})}}class Ya extends Yn{constructor(T,A,O,L,B){super(Sn.CONNECTION_STATE,A,O,!1),Object.assign(this.properties,{action:T,remote_participant_id:B,state:L})}}class J0 extends Yn{constructor(T,A,O,L,B){super(Sn.ICE_GATHERING_STATE,A,O,!1),Object.assign(this.properties,{action:T,remote_participant_id:B,state:L})}}(function(N){N.POST="post",N.CONNECTED="connected",N.ICE_GATHERING="icegathering",N.SDP_EXCHANGE="sdpExchange",N.SET_REMOTE_DESC="setRemoteDesc",N.PEER_CONNECTION="peerConnection"})(fs||(fs={}));const rS="start",zu="stop";class sS{constructor(T,A){this.marks={},this.optionsDuration=0,this.postDuration=0,this.timeToCandidate=0,this.timeToConnected=0,this.sdpExchangeDuration=0,this.sdpExchangeTransport="",this.setRemoteDescDuration=0,this.peerConnectionDuration=0,this.action=T,this.traceId=A}markActionStart(){this.markStart(fs.CONNECTED)}markPostStart(){this.markStart(fs.POST)}markPostStop(){this.markStop(fs.POST),this.postDuration=this.measure(fs.POST)}markIceGatheringStart(){this.markStart(fs.ICE_GATHERING)}markIceGatheringStop(){this.markStop(fs.ICE_GATHERING),this.timeToCandidate=this.measure(fs.ICE_GATHERING)}markActionStop(){this.markStop(fs.CONNECTED),this.timeToConnected=this.measure(fs.CONNECTED),this.markStop(fs.PEER_CONNECTION),this.peerConnectionDuration=this.measure(fs.PEER_CONNECTION)}markSetRemoteDescStart(){this.markStart(fs.SET_REMOTE_DESC)}markSetRemoteDescStop(){const T=fs.SET_REMOTE_DESC;this.markStop(T),this.setRemoteDescDuration=this.measure(T),this.markStart(fs.PEER_CONNECTION)}markSdpExchangeStart(){this.markStart(fs.SDP_EXCHANGE)}markSdpExchangeStop(){const T=fs.SDP_EXCHANGE;this.markStop(T),this.sdpExchangeDuration=this.measure(T)}setTransport(T){this.sdpExchangeTransport=T}markStart(T){this.marks[`${this.namespace}.${T}.${rS}`]=performance.now()}markStop(T){this.marks[`${this.namespace}.${T}.${zu}`]=performance.now()}measure(T){const A=`${this.namespace}.${T}.${rS}`,O=`${this.namespace}.${T}.${zu}`,L=this.marks[A],B=this.marks[O];return L===void 0||B===void 0?0:B-L}get namespace(){return`ivswb.peerclient.${this.action}.${this.traceId.value}`}getMeasurements(){const{optionsDuration:T,postDuration:A,timeToCandidate:O,timeToConnected:L,sdpExchangeDuration:B,sdpExchangeTransport:H,setRemoteDescDuration:ne,peerConnectionDuration:se}=this;return{optionsDuration:T,postDuration:A,timeToCandidate:O,timeToConnected:L,sdpExchangeDuration:B,sdpExchangeTransport:H,setRemoteDescDuration:ne,peerConnectionDuration:se}}resetMeasurements(T){this.traceId=T,this.marks={},this.optionsDuration=0,this.postDuration=0,this.timeToCandidate=0,this.timeToConnected=0,this.sdpExchangeDuration=0,this.sdpExchangeTransport="",this.setRemoteDescDuration=0,this.peerConnectionDuration=0}}var ju,Ys,iu;(function(N){N.VIDEO="video",N.AUDIO="audio"})(ju||(ju={})),function(N){N.DEFAULT="default",N.LOW="low",N.MEDIUM="medium",N.HIGH="high"}(Ys||(Ys={})),function(N){N.LOWEST_QUALITY="lowest_quality",N.HIGHEST_QUALITY="highest_quality"}(iu||(iu={}));var ba=r(766);class Gr{constructor(T){this.sdp=T}static splitLines(T){return T.trim().split(`
`).map(A=>A.trim())}static splitSections(T){return T.split(`
m=`).map((A,O)=>(O>0?`m=${A}`:A).trim()+Gr.CRLF)}getUniqueRtpHeaderExtensionId(T){const A=[];for(const L of T)if(/^a=extmap:/.test(L.trim())){const B=+L.split("a=extmap:")[1].split(" ")[0];A.includes(B)||A.push(B)}A.sort((L,B)=>L-B);let O=0;for(const L of A){if(L-O>1)return O+1;O=L}return O===14?-1:O+1}withVideoLayersAllocationRtpHeaderExtension(T){const A="http://www.webrtc.org/experiments/rtp-hdrext/video-layers-allocation00",O=T?T.getRtpHeaderExtensionId(A):-1,L=O===-1?this.getUniqueRtpHeaderExtensionId(Gr.splitLines(this.sdp)):O,B=Gr.splitSections(this.sdp),H=[];for(let se of B){if(/^m=video/.test(se)&&Gr.getRtpHeaderExtensionIdInSection(se,A)===-1){const Z=Gr.splitLines(se),oe=[];if(L===-1||this.hasRtpHeaderExtensionId(L)){H.push(se);continue}for(const de of Z)if(oe.push(de),/^a=sendrecv/.test(de.trim())){const me=`a=extmap:${L} ${A}`;oe.push(me)}se=oe.join(Gr.CRLF)+Gr.CRLF}else if(O!==-1&&/^m=video/.test(se)&&Gr.getRtpHeaderExtensionIdInSection(se,A)!==O){const Z=Gr.splitLines(se),oe=[];for(const de of Z){if(/^a=extmap:/.test(de.trim())&&de.split("a=extmap:")[1].split(" ")[1]===A){if(!this.hasRtpHeaderExtensionId(O)){const me=`a=extmap:${O} ${A}`;oe.push(me)}continue}oe.push(de)}se=oe.join(Gr.CRLF)+Gr.CRLF}H.push(se)}const ne=H.join("");return new Gr(ne)}withOpusAudioConfig(T,A){const O=ba.Qc(this.sdp);for(const L of O.media)if(L.type==="audio"){const{payload:B}=L.rtp.find(Z=>Z.codec==="opus");if(!B)continue;let H=L.fmtp.find(Z=>Z.payload===B);H||(H={payload:B,config:""});const ne=ba.rz(H.config);if(ne.maxaveragebitrate=T,typeof A=="boolean"){const Z=A?1:0;ne["sprop-stereo"]=Z,ne.stereo=Z}let se="";for(const Z of Object.keys(ne))se+=`${Z}=${ne[Z]}; `;H.config=se.trim()}return new Gr(ba.cW(O))}static getRtpHeaderExtensionIdInSection(T,A){const O=Gr.splitLines(T);for(const L of O)if(/^a=extmap:/.test(L.trim())){const B=L.split("a=extmap:")[1].split(" "),H=+B[0];if(B[1]===A)return H}return-1}getRtpHeaderExtensionId(T){const A=Gr.splitSections(this.sdp);for(const O of A)if(/^m=video/.test(O)){const L=Gr.getRtpHeaderExtensionIdInSection(O,T);if(L!==-1)return L}return-1}hasRtpHeaderExtensionId(T){const A=Gr.splitLines(this.sdp);for(const O of A)if(/^a=extmap:/.test(O.trim())&&+O.split("a=extmap:")[1].split(" ")[0]===T)return!0;return!1}hasAudioNacksEnabled(){var T,A,O;return((O=(A=((T=ba.Qc(this.sdp).media.filter(L=>L.type==="audio")[0])!==null&&T!==void 0?T:{}).rtcpFb)===null||A===void 0?void 0:A.filter(L=>L.type==="nack"))!==null&&O!==void 0?O:[]).length>0}}Gr.CRLF=`\r
`,Gr.rfc7587LowestBitrate=6e3,Gr.rfc7587HighestBitrate=51e4;const eg=200,tg=2500,hy=10,Oc=30,Q0=12,lr=128,ev={[Ys.DEFAULT]:0,[Ys.LOW]:50,[Ys.MEDIUM]:150,[Ys.HIGH]:250},Ex={[Ys.DEFAULT]:0,[Ys.LOW]:100,[Ys.MEDIUM]:200,[Ys.HIGH]:300},aS=()=>({minBitrate:eg,maxBitrate:tg,maxFramerate:Oc,simulcast:{enabled:!1},maxAudioBitrateKbps:64,stereo:!1});var oS=function(N,T,A,O){return new(A||(A=Promise))(function(L,B){function H(Z){try{se(O.next(Z))}catch(oe){B(oe)}}function ne(Z){try{se(O.throw(Z))}catch(oe){B(oe)}}function se(Z){var oe;Z.done?L(Z.value):(oe=Z.value,oe instanceof A?oe:new A(function(de){de(oe)})).then(H,ne)}se((O=O.apply(N,[])).next())})};const Sx="H264",dy=N=>{const T=N==null?void 0:N.split("/");if((T==null?void 0:T.length)===2)return T[1]},Hu=(N,T)=>{const A=dy(N);if(N===void 0||A===void 0)return;const O={mimeSubtype:A};if(T){const L=(B=>{const H=B.split(";"),ne=new Map;for(const se of H){const[Z,oe]=se.split("=");ne.set(Z,oe)}return ne})(T);switch(A){case Sx:{const B=L.get("profile-level-id");B&&((H,ne)=>{if(ne.length<6)return;const se=ne.substring(0,4),Z=parseInt(ne.substring(4,6),16);H.profile=se,H.level=Z})(O,B);break}case"H265":((B,H)=>{const ne=H.get("profile-id")||"0",se=H.get("tier-flag")||"0",Z=parseInt(H.get("level-id")||"0",10),oe=[se,ne].join("_");B.profile=oe,B.level=Z})(O,L)}}return O},tv=(N,T)=>N.sort((A,O)=>{if(dy(A.mimeType)===Sx){const L=Hu(A.mimeType,A.sdpFmtpLine);if((L==null?void 0:L.profile)===T)return-1}return 0}),Nh=(N,T)=>{var A;const O=Hu(N.mimeType,N.sdpFmtpLine);return(O==null?void 0:O.mimeSubtype.toLowerCase())===T.mime.toLowerCase()&&((A=O==null?void 0:O.profile)===null||A===void 0?void 0:A.toLowerCase().indexOf(T.config.toLowerCase()))===0},nv=(N,T)=>T.filter(A=>!A.mimeType.endsWith("rtx")).filter(A=>A.mimeType.indexOf("packetization-mode=0")===-1).find(A=>N.reduce((O,L)=>O&&Nh(A,L)===!1,!0));class iv extends Yn{constructor(T,A,O,L,B,H,ne,se,Z){var oe,de;super(Sn.PUBLISHED_VIDEO_STATS,T,A,!1),Object.assign(this.properties,Object.assign({action:dn.PUBLISH,node:(oe=O==null?void 0:O.node)!==null&&oe!==void 0?oe:"",cluster:(de=O==null?void 0:O.cluster)!==null&&de!==void 0?de:""},((me,Pe,Xe,qe,Ie,xe)=>{var lt,At,Jt,Nt,Qn,On,Ei,Fi,Pi,Ai,Si,Oi,Di,Ti,Ni,hi,An,Kn,Wi,ts,ws,ns,gs,is,kr,fr,Kr,rs,vs,ia,Sa;const Cs=(At=(lt=me==null?void 0:me.qualityLimitationDurations)===null||lt===void 0?void 0:lt.cpu)!==null&&At!==void 0?At:0,zs=(Nt=(Jt=me==null?void 0:me.qualityLimitationDurations)===null||Jt===void 0?void 0:Jt.bandwidth)!==null&&Nt!==void 0?Nt:0,pr=Math.max((Qn=me==null?void 0:me.bytesSent)!==null&&Qn!==void 0?Qn:0,0),Pa=8*pr/(xe??1),ti=Math.max((On=Pe==null?void 0:Pe.packetsLost)!==null&&On!==void 0?On:0,0),qi=Math.max((Ei=me==null?void 0:me.packetsSent)!==null&&Ei!==void 0?Ei:0,0),Or=ti/Math.max(qi,1),Qa=Hu(qe==null?void 0:qe.mimeType,qe==null?void 0:qe.sdpFmtpLine);return{active:!!(me!=null&&me.framesPerSecond)&&me.framesPerSecond!==0,bytes_sent:pr,codec_mime_type:Qa==null?void 0:Qa.mimeSubtype,codec_profile:Qa==null?void 0:Qa.profile,codec_level:Qa==null?void 0:Qa.level,configured_bitrate:Ie==null?void 0:Ie.max_bitrate,connection_bandwidth:(Fi=Xe==null?void 0:Xe.availableOutgoingBitrate)!==null&&Fi!==void 0?Fi:0,encode_bitrate:Pa,encoder_implementation:(Pi=me==null?void 0:me.encoderImplementation)!==null&&Pi!==void 0?Pi:"unknown",fir_count:(Ai=me==null?void 0:me.firCount)!==null&&Ai!==void 0?Ai:0,fraction_packets_lost:Or,frame_height:Math.max((Si=me==null?void 0:me.frameHeight)!==null&&Si!==void 0?Si:0,0),frame_width:Math.max((Oi=me==null?void 0:me.frameWidth)!==null&&Oi!==void 0?Oi:0,0),frames_encoded:(Di=me==null?void 0:me.framesEncoded)!==null&&Di!==void 0?Di:0,frames_per_second:Math.max((Ti=me==null?void 0:me.framesPerSecond)!==null&&Ti!==void 0?Ti:0,0),frames_sent:(Ni=me==null?void 0:me.framesSent)!==null&&Ni!==void 0?Ni:0,header_bytes_sent:(hi=me==null?void 0:me.headerBytesSent)!==null&&hi!==void 0?hi:0,huge_frames_sent:(An=me==null?void 0:me.hugeFramesSent)!==null&&An!==void 0?An:0,key_frames_encoded:(Kn=me==null?void 0:me.keyFramesEncoded)!==null&&Kn!==void 0?Kn:0,nack_count:(Wi=me==null?void 0:me.nackCount)!==null&&Wi!==void 0?Wi:0,packets_lost:ti,packets_sent:qi,power_efficient_encoder:(ts=me==null?void 0:me.powerEfficientEncoder)!==null&&ts!==void 0&&ts,pli_count:(ws=me==null?void 0:me.pliCount)!==null&&ws!==void 0?ws:0,quality_limitation_reason:(ns=me==null?void 0:me.qualityLimitationReason)!==null&&ns!==void 0?ns:"none",quality_limitation_resolution_changes:(gs=me==null?void 0:me.qualityLimitationResolutionChanges)!==null&&gs!==void 0?gs:0,quality_limitation_cpu_duration:Cs,quality_limitation_bandwidth_duration:zs,retransmitted_bytes_sent:(is=me==null?void 0:me.retransmittedBytesSent)!==null&&is!==void 0?is:0,retransmitted_packets_sent:(kr=me==null?void 0:me.retransmittedPacketsSent)!==null&&kr!==void 0?kr:0,rid:(fr=me==null?void 0:me.rid)!==null&&fr!==void 0?fr:"no-rid",scalability_mode:(Kr=me==null?void 0:me.scalabilityMode)!==null&&Kr!==void 0?Kr:"unknown",target_bitrate:Math.max((rs=me==null?void 0:me.targetBitrate)!==null&&rs!==void 0?rs:0,0),total_encode_time:(vs=me==null?void 0:me.totalEncodeTime)!==null&&vs!==void 0?vs:0,total_encoded_bytes_target:(ia=me==null?void 0:me.totalEncodedBytesTarget)!==null&&ia!==void 0?ia:0,total_packet_send_delay:(Sa=me==null?void 0:me.totalPacketSendDelay)!==null&&Sa!==void 0?Sa:0}})(L,B,H,ne,se,Z)))}}class Pf extends Yn{constructor(T,A,O,L,B,H,ne,se,Z,oe){var de,me,Pe,Xe;super(Sn.PUBLISHED_VIDEO_STATS_WINDOW,T,A,!1);const qe=Math.max(((de=L==null?void 0:L.timestamp)!==null&&de!==void 0?de:0)-((me=B==null?void 0:B.timestamp)!==null&&me!==void 0?me:0),0);Object.assign(this.properties,Object.assign({action:dn.PUBLISH,node:(Pe=O==null?void 0:O.node)!==null&&Pe!==void 0?Pe:"",cluster:(Xe=O==null?void 0:O.cluster)!==null&&Xe!==void 0?Xe:"",window_size_ms:qe},((Ie,xe,lt,At,Jt,Nt,Qn,On)=>{var Ei,Fi,Pi,Ai,Si,Oi,Di,Ti,Ni,hi,An,Kn,Wi,ts,ws,ns,gs,is,kr,fr,Kr,rs,vs,ia,Sa,Cs,zs,pr,Pa,ti,qi,Or,Qa,Fo,Ic,dl,_s,lc,zh,su,Da,bo,zo,uc,Bf,Ff,tm,Xs,Bd,jh,Ju,Fl;const yv=(Fi=(Ei=Ie==null?void 0:Ie.qualityLimitationDurations)===null||Ei===void 0?void 0:Ei.cpu)!==null&&Fi!==void 0?Fi:0,Cy=(Ai=(Pi=xe==null?void 0:xe.qualityLimitationDurations)===null||Pi===void 0?void 0:Pi.cpu)!==null&&Ai!==void 0?Ai:0,bv=(Oi=(Si=Ie==null?void 0:Ie.qualityLimitationDurations)===null||Si===void 0?void 0:Si.bandwidth)!==null&&Oi!==void 0?Oi:0,Xr=(Ti=(Di=xe==null?void 0:xe.qualityLimitationDurations)===null||Di===void 0?void 0:Di.bandwidth)!==null&&Ti!==void 0?Ti:0,Ev=Math.max(((Ni=Ie==null?void 0:Ie.bytesSent)!==null&&Ni!==void 0?Ni:0)-((hi=xe==null?void 0:xe.bytesSent)!==null&&hi!==void 0?hi:0),0),Hh=8*Ev/(typeof On!="number"?1:On/1e3),E=Math.max(((An=lt==null?void 0:lt.packetsLost)!==null&&An!==void 0?An:0)-((Kn=At==null?void 0:At.packetsLost)!==null&&Kn!==void 0?Kn:0),0),w=Math.max(((Wi=Ie==null?void 0:Ie.packetsSent)!==null&&Wi!==void 0?Wi:0)-((ts=xe==null?void 0:xe.packetsSent)!==null&&ts!==void 0?ts:0),0),F=E/Math.max(w,1),ee=Hu(Nt==null?void 0:Nt.mimeType,Nt==null?void 0:Nt.sdpFmtpLine);return{active:!!(Ie!=null&&Ie.framesPerSecond)&&(Ie==null?void 0:Ie.framesPerSecond)!==0,bytes_sent:Ev,codec_mime_type:ee==null?void 0:ee.mimeSubtype,codec_profile:ee==null?void 0:ee.profile,codec_level:ee==null?void 0:ee.level,configured_bitrate:Qn==null?void 0:Qn.max_bitrate,connection_bandwidth:(ws=Jt==null?void 0:Jt.availableOutgoingBitrate)!==null&&ws!==void 0?ws:0,encode_bitrate:Hh,encoder_implementation:(ns=Ie==null?void 0:Ie.encoderImplementation)!==null&&ns!==void 0?ns:"unknown",fir_count:Math.max(((gs=Ie==null?void 0:Ie.firCount)!==null&&gs!==void 0?gs:0)-((is=xe==null?void 0:xe.firCount)!==null&&is!==void 0?is:0),0),fraction_packets_lost:F,frame_height:Math.max((kr=Ie==null?void 0:Ie.frameHeight)!==null&&kr!==void 0?kr:0,0),frame_width:Math.max((fr=Ie==null?void 0:Ie.frameWidth)!==null&&fr!==void 0?fr:0,0),frames_encoded:Math.max(((Kr=Ie==null?void 0:Ie.framesEncoded)!==null&&Kr!==void 0?Kr:0)-((rs=xe==null?void 0:xe.framesEncoded)!==null&&rs!==void 0?rs:0),0),frames_per_second:Math.max((vs=Ie==null?void 0:Ie.framesPerSecond)!==null&&vs!==void 0?vs:0,0),frames_sent:Math.max(((ia=Ie==null?void 0:Ie.framesSent)!==null&&ia!==void 0?ia:0)-((Sa=xe==null?void 0:xe.framesSent)!==null&&Sa!==void 0?Sa:0),0),header_bytes_sent:Math.max(((Cs=Ie==null?void 0:Ie.headerBytesSent)!==null&&Cs!==void 0?Cs:0)-((zs=xe==null?void 0:xe.headerBytesSent)!==null&&zs!==void 0?zs:0),0),huge_frames_sent:Math.max(((pr=Ie==null?void 0:Ie.hugeFramesSent)!==null&&pr!==void 0?pr:0)-((Pa=xe==null?void 0:xe.hugeFramesSent)!==null&&Pa!==void 0?Pa:0),0),key_frames_encoded:Math.max(((ti=Ie==null?void 0:Ie.keyFramesEncoded)!==null&&ti!==void 0?ti:0)-((qi=xe==null?void 0:xe.keyFramesEncoded)!==null&&qi!==void 0?qi:0),0),nack_count:Math.max(((Or=Ie==null?void 0:Ie.nackCount)!==null&&Or!==void 0?Or:0)-((Qa=xe==null?void 0:xe.nackCount)!==null&&Qa!==void 0?Qa:0),0),packets_lost:E,packets_sent:w,power_efficient_encoder:(Fo=Ie==null?void 0:Ie.powerEfficientEncoder)!==null&&Fo!==void 0&&Fo,pli_count:Math.max(((Ic=Ie==null?void 0:Ie.pliCount)!==null&&Ic!==void 0?Ic:0)-((dl=xe==null?void 0:xe.pliCount)!==null&&dl!==void 0?dl:0),0),quality_limitation_reason:(_s=Ie==null?void 0:Ie.qualityLimitationReason)!==null&&_s!==void 0?_s:"none",quality_limitation_resolution_changes:Math.max(((lc=Ie==null?void 0:Ie.qualityLimitationResolutionChanges)!==null&&lc!==void 0?lc:0)-((zh=xe==null?void 0:xe.qualityLimitationResolutionChanges)!==null&&zh!==void 0?zh:0),0),quality_limitation_cpu_duration:Math.max(yv-Cy,0),quality_limitation_bandwidth_duration:Math.max(bv-Xr,0),retransmitted_bytes_sent:Math.max(((su=Ie==null?void 0:Ie.retransmittedBytesSent)!==null&&su!==void 0?su:0)-((Da=xe==null?void 0:xe.retransmittedBytesSent)!==null&&Da!==void 0?Da:0),0),rid:(bo=Ie==null?void 0:Ie.rid)!==null&&bo!==void 0?bo:"no-rid",retransmitted_packets_sent:Math.max(((zo=Ie==null?void 0:Ie.retransmittedPacketsSent)!==null&&zo!==void 0?zo:0)-((uc=xe==null?void 0:xe.retransmittedPacketsSent)!==null&&uc!==void 0?uc:0),0),scalability_mode:(Bf=Ie==null?void 0:Ie.scalabilityMode)!==null&&Bf!==void 0?Bf:"unknown",target_bitrate:Math.max((Ff=Ie==null?void 0:Ie.targetBitrate)!==null&&Ff!==void 0?Ff:0,0),total_encode_time:Math.max(((tm=Ie==null?void 0:Ie.totalEncodeTime)!==null&&tm!==void 0?tm:0)-((Xs=xe==null?void 0:xe.totalEncodeTime)!==null&&Xs!==void 0?Xs:0),0),total_encoded_bytes_target:Math.max(((Bd=Ie==null?void 0:Ie.totalEncodedBytesTarget)!==null&&Bd!==void 0?Bd:0)-((jh=xe==null?void 0:xe.totalEncodedBytesTarget)!==null&&jh!==void 0?jh:0),0),total_packet_send_delay:Math.max(((Ju=Ie==null?void 0:Ie.totalPacketSendDelay)!==null&&Ju!==void 0?Ju:0)-((Fl=xe==null?void 0:xe.totalPacketSendDelay)!==null&&Fl!==void 0?Fl:0),0)}})(L,B,H,ne,se,Z,oe,qe)))}}class cS extends Yn{constructor(T,A,O,L,B,H,ne,se,Z,oe){var de,me;super(Sn.PUBLISHED_AUDIO_STATS,T,A,!1),Object.assign(this.properties,Object.assign({action:dn.PUBLISH,node:(de=O==null?void 0:O.node)!==null&&de!==void 0?de:"",cluster:(me=O==null?void 0:O.cluster)!==null&&me!==void 0?me:""},((Pe,Xe,qe,Ie,xe,lt,At)=>{var Jt,Nt,Qn,On,Ei,Fi,Pi,Ai,Si,Oi,Di;const Ti=Math.max((Jt=Pe==null?void 0:Pe.bytesSent)!==null&&Jt!==void 0?Jt:0,0),Ni=8*Ti/(lt??1),hi=Math.max((Nt=Xe==null?void 0:Xe.packetsLost)!==null&&Nt!==void 0?Nt:0,0),An=Math.max((Qn=Pe==null?void 0:Pe.packetsSent)!==null&&Qn!==void 0?Qn:0,0),Kn=hi/Math.max(An,1),Wi=Hu(Ie==null?void 0:Ie.mimeType,Ie==null?void 0:Ie.sdpFmtpLine);return{audio_nacks_enabled:(On=At==null?void 0:At.audioNacks)!==null&&On!==void 0&&On,bytes_sent:Ti,codec_mime_type:Wi==null?void 0:Wi.mimeSubtype,configured_bitrate:(Ei=xe==null?void 0:xe.max_audio_bitrate_bps)!==null&&Ei!==void 0?Ei:0,connection_bandwidth:(Fi=qe==null?void 0:qe.availableOutgoingBitrate)!==null&&Fi!==void 0?Fi:0,encode_bitrate:Ni,fraction_packets_lost:Kn,header_bytes_sent:(Pi=Pe==null?void 0:Pe.headerBytesSent)!==null&&Pi!==void 0?Pi:0,nack_count:(Ai=Pe==null?void 0:Pe.nackCount)!==null&&Ai!==void 0?Ai:0,packets_lost:hi,packets_sent:An,retransmitted_bytes_sent:(Si=Pe==null?void 0:Pe.retransmittedBytesSent)!==null&&Si!==void 0?Si:0,retransmitted_packets_sent:(Oi=Pe==null?void 0:Pe.retransmittedPacketsSent)!==null&&Oi!==void 0?Oi:0,target_bitrate:(Di=Pe==null?void 0:Pe.targetBitrate)!==null&&Di!==void 0?Di:0}})(L,B,H,ne,se,Z,oe)))}}class rv extends Yn{constructor(T,A,O,L,B,H,ne,se,Z,oe,de){var me,Pe,Xe,qe;super(Sn.PUBLISHED_AUDIO_STATS_WINDOW,T,A,!1);const Ie=Math.max(((me=L==null?void 0:L.timestamp)!==null&&me!==void 0?me:0)-((Pe=B==null?void 0:B.timestamp)!==null&&Pe!==void 0?Pe:0),0);Object.assign(this.properties,Object.assign({action:dn.PUBLISH,node:(Xe=O==null?void 0:O.node)!==null&&Xe!==void 0?Xe:"",cluster:(qe=O==null?void 0:O.cluster)!==null&&qe!==void 0?qe:"",window_size_ms:Ie},((xe,lt,At,Jt,Nt,Qn,On,Ei,Fi)=>{var Pi,Ai,Si,Oi,Di,Ti,Ni,hi,An,Kn,Wi,ts,ws,ns,gs,is,kr,fr,Kr,rs;const vs=Math.max(((Pi=xe==null?void 0:xe.bytesSent)!==null&&Pi!==void 0?Pi:0)-((Ai=lt==null?void 0:lt.bytesSent)!==null&&Ai!==void 0?Ai:0),0),ia=8*vs/(typeof Ei!="number"?1:Ei/1e3),Sa=Math.max(((Si=At==null?void 0:At.packetsLost)!==null&&Si!==void 0?Si:0)-((Oi=Jt==null?void 0:Jt.packetsLost)!==null&&Oi!==void 0?Oi:0),0),Cs=Math.max(((Di=xe==null?void 0:xe.packetsSent)!==null&&Di!==void 0?Di:0)-((Ti=lt==null?void 0:lt.packetsSent)!==null&&Ti!==void 0?Ti:0),0),zs=Sa/Math.max(Cs,1),pr=Hu(Qn==null?void 0:Qn.mimeType,Qn==null?void 0:Qn.sdpFmtpLine);return{audio_nacks_enabled:(Ni=Fi==null?void 0:Fi.audioNacks)!==null&&Ni!==void 0&&Ni,bytes_sent:vs,codec_mime_type:pr==null?void 0:pr.mimeSubtype,configured_bitrate:(hi=On==null?void 0:On.max_audio_bitrate_bps)!==null&&hi!==void 0?hi:0,connection_bandwidth:(An=Nt==null?void 0:Nt.availableOutgoingBitrate)!==null&&An!==void 0?An:0,encode_bitrate:ia,fraction_packets_lost:zs,header_bytes_sent:Math.max(((Kn=xe==null?void 0:xe.headerBytesSent)!==null&&Kn!==void 0?Kn:0)-((Wi=lt==null?void 0:lt.headerBytesSent)!==null&&Wi!==void 0?Wi:0),0),nack_count:Math.max(((ts=xe==null?void 0:xe.nackCount)!==null&&ts!==void 0?ts:0)-((ws=lt==null?void 0:lt.nackCount)!==null&&ws!==void 0?ws:0),0),packets_lost:Sa,packets_sent:Math.max(((ns=xe==null?void 0:xe.packetsSent)!==null&&ns!==void 0?ns:0)-((gs=lt==null?void 0:lt.packetsSent)!==null&&gs!==void 0?gs:0),0),retransmitted_bytes_sent:Math.max(((is=xe==null?void 0:xe.retransmittedBytesSent)!==null&&is!==void 0?is:0)-((kr=lt==null?void 0:lt.retransmittedBytesSent)!==null&&kr!==void 0?kr:0),0),retransmitted_packets_sent:Math.max(((fr=xe==null?void 0:xe.retransmittedPacketsSent)!==null&&fr!==void 0?fr:0)-((Kr=lt==null?void 0:lt.retransmittedPacketsSent)!==null&&Kr!==void 0?Kr:0),0),target_bitrate:Math.max((rs=xe==null?void 0:xe.targetBitrate)!==null&&rs!==void 0?rs:0,0)}})(L,B,H,ne,se,Z,oe,Ie,de)))}}class fy extends Yn{constructor(T,A,O,L,B,H,ne,se){var Z,oe;super(Sn.SUBSCRIBED_VIDEO_STATS,T,A,!1),Object.assign(this.properties,Object.assign({action:dn.SUBSCRIBE,node:(Z=L==null?void 0:L.node)!==null&&Z!==void 0?Z:"",cluster:(oe=L==null?void 0:L.cluster)!==null&&oe!==void 0?oe:"",remote_participant_id:O},((de,me,Pe,Xe)=>{var qe,Ie,xe,lt,At,Jt,Nt,Qn,On,Ei,Fi,Pi,Ai,Si,Oi,Di,Ti,Ni,hi,An,Kn,Wi,ts;let ws=0;de!=null&&de.jitterBufferDelay&&(de!=null&&de.jitterBufferEmittedCount)&&de.jitterBufferEmittedCount>0&&(ws=de.jitterBufferDelay/de.jitterBufferEmittedCount);const ns=Xe??1,gs=Math.max((qe=de==null?void 0:de.bytesReceived)!==null&&qe!==void 0?qe:0,0),is=8*gs/ns;let kr=0;de!=null&&de.totalDecodeTime&&(de!=null&&de.framesDecoded)&&(kr=de.totalDecodeTime/Math.max(de==null?void 0:de.framesDecoded,1));const fr=Math.max((Ie=de==null?void 0:de.packetsLost)!==null&&Ie!==void 0?Ie:0,0),Kr=Math.max((xe=de==null?void 0:de.packetsReceived)!==null&&xe!==void 0?xe:0,0),rs=fr/Math.max(Kr+fr,1),vs=Hu(Pe==null?void 0:Pe.mimeType,Pe==null?void 0:Pe.sdpFmtpLine);return{bytes_received:gs,codec_mime_type:vs==null?void 0:vs.mimeSubtype,codec_profile:vs==null?void 0:vs.profile,codec_level:vs==null?void 0:vs.level,connection_bandwidth:(lt=me==null?void 0:me.availableIncomingBitrate)!==null&&lt!==void 0?lt:0,decode_bitrate:is,decoder_implementation:(At=de==null?void 0:de.decoderImplementation)!==null&&At!==void 0?At:"unknown",fir_count:Math.max((Jt=de==null?void 0:de.firCount)!==null&&Jt!==void 0?Jt:0,0),fraction_packets_lost:rs,frame_decode_time_avg:kr,frame_height:Math.max((Nt=de==null?void 0:de.frameHeight)!==null&&Nt!==void 0?Nt:0,0),frame_width:Math.max((Qn=de==null?void 0:de.frameWidth)!==null&&Qn!==void 0?Qn:0,0),frames_decoded:Math.max((On=de==null?void 0:de.framesDecoded)!==null&&On!==void 0?On:0,0),frames_dropped:Math.max((Ei=de==null?void 0:de.framesDropped)!==null&&Ei!==void 0?Ei:0,0),frames_received:Math.max((Fi=de==null?void 0:de.framesReceived)!==null&&Fi!==void 0?Fi:0,0),freeze_count:Math.max((Pi=de==null?void 0:de.freezeCount)!==null&&Pi!==void 0?Pi:0,0),frames_rendered:Math.max((Ai=de==null?void 0:de.framesRendered)!==null&&Ai!==void 0?Ai:0,0),frames_per_second:Math.max((Si=de==null?void 0:de.framesPerSecond)!==null&&Si!==void 0?Si:0,0),header_bytes_received:Math.max((Oi=de==null?void 0:de.headerBytesReceived)!==null&&Oi!==void 0?Oi:0,0),jitter_buffer_delay_avg:ws,key_frames_decoded:Math.max((Di=de==null?void 0:de.keyFramesDecoded)!==null&&Di!==void 0?Di:0,0),nack_count:Math.max((Ti=de==null?void 0:de.nackCount)!==null&&Ti!==void 0?Ti:0,0),packets_discarded:Math.max((Ni=de==null?void 0:de.packetsDiscarded)!==null&&Ni!==void 0?Ni:0,0),packets_lost:fr,packets_received:Kr,pause_count:Math.max((hi=de==null?void 0:de.pauseCount)!==null&&hi!==void 0?hi:0,0),pli_count:Math.max((An=de==null?void 0:de.pliCount)!==null&&An!==void 0?An:0,0),power_efficient_decoder:(Kn=de==null?void 0:de.powerEfficientDecoder)!==null&&Kn!==void 0&&Kn,total_freezes_duration:Math.max((Wi=de==null?void 0:de.totalFreezesDuration)!==null&&Wi!==void 0?Wi:0,0),total_pauses_duration:Math.max((ts=de==null?void 0:de.totalPausesDuration)!==null&&ts!==void 0?ts:0,0)}})(B,H,ne,se)))}}class lS extends Yn{constructor(T,A,O,L,B,H,ne,se,Z,oe,de){var me,Pe,Xe,qe;super(Sn.SUBSCRIBED_VIDEO_STATS_WINDOW,T,A,!1);const Ie=Math.max(((me=B==null?void 0:B.timestamp)!==null&&me!==void 0?me:0)-((Pe=H==null?void 0:H.timestamp)!==null&&Pe!==void 0?Pe:0),0);Object.assign(this.properties,Object.assign({action:dn.SUBSCRIBE,node:(Xe=L==null?void 0:L.node)!==null&&Xe!==void 0?Xe:"",cluster:(qe=L==null?void 0:L.cluster)!==null&&qe!==void 0?qe:"",window_size_ms:Ie,remote_participant_id:O},((xe,lt,At,Jt,Nt,Qn,On,Ei)=>{var Fi,Pi,Ai,Si,Oi,Di,Ti,Ni,hi,An,Kn,Wi,ts,ws,ns,gs,is,kr,fr,Kr,rs,vs,ia,Sa,Cs,zs,pr,Pa,ti,qi,Or,Qa,Fo,Ic,dl,_s,lc,zh,su,Da,bo,zo,uc;let Bf=0,Ff=0;if(xe!=null&&xe.jitterBufferEmittedCount&&(lt!=null&&lt.jitterBufferEmittedCount)&&xe.jitterBufferEmittedCount>lt.jitterBufferEmittedCount){xe!=null&&xe.jitterBufferDelay&&(lt!=null&&lt.jitterBufferDelay)&&(Bf=(xe.jitterBufferDelay-lt.jitterBufferDelay)/(xe.jitterBufferEmittedCount-lt.jitterBufferEmittedCount));const Hh=lt==null?void 0:lt.jitterBufferMinimumDelay,E=xe==null?void 0:xe.jitterBufferMinimumDelay;Hh&&E&&(Ff=(E-Hh)/(xe.jitterBufferEmittedCount-lt.jitterBufferEmittedCount))}const tm=Math.max(((Fi=xe==null?void 0:xe.bytesReceived)!==null&&Fi!==void 0?Fi:0)-((Pi=lt==null?void 0:lt.bytesReceived)!==null&&Pi!==void 0?Pi:0),0),Xs=typeof Nt!="number"?1:Nt/1e3,Bd=8*tm/Xs,jh=Math.max(((Ai=xe==null?void 0:xe.totalDecodeTime)!==null&&Ai!==void 0?Ai:0)-((Si=lt==null?void 0:lt.totalDecodeTime)!==null&&Si!==void 0?Si:0),0),Ju=Math.max(((Oi=xe==null?void 0:xe.framesDecoded)!==null&&Oi!==void 0?Oi:0)-((Di=lt==null?void 0:lt.framesDecoded)!==null&&Di!==void 0?Di:0),0),Fl=jh/Math.max(Ju,1),yv=Math.max(((Ti=xe==null?void 0:xe.packetsLost)!==null&&Ti!==void 0?Ti:0)-((Ni=lt==null?void 0:lt.packetsLost)!==null&&Ni!==void 0?Ni:0),0),Cy=Math.max(((hi=xe==null?void 0:xe.packetsReceived)!==null&&hi!==void 0?hi:0)-((An=lt==null?void 0:lt.packetsReceived)!==null&&An!==void 0?An:0),0),bv=yv/Math.max(Cy+yv,1),Xr=Hu(Jt==null?void 0:Jt.mimeType,Jt==null?void 0:Jt.sdpFmtpLine),Ev=8*(Ei||0)/Xs;return{bytes_received:tm,codec_mime_type:Xr==null?void 0:Xr.mimeSubtype,codec_profile:Xr==null?void 0:Xr.profile,codec_level:Xr==null?void 0:Xr.level,connection_bandwidth:(Kn=At==null?void 0:At.availableIncomingBitrate)!==null&&Kn!==void 0?Kn:0,decode_bitrate:Bd,decoder_implementation:(Wi=xe==null?void 0:xe.decoderImplementation)!==null&&Wi!==void 0?Wi:"unknown",fir_count:Math.max(((ts=xe==null?void 0:xe.firCount)!==null&&ts!==void 0?ts:0)-((ws=lt==null?void 0:lt.firCount)!==null&&ws!==void 0?ws:0),0),fraction_packets_lost:bv,frame_decode_time_avg:Fl,frame_height:Math.max((ns=xe==null?void 0:xe.frameHeight)!==null&&ns!==void 0?ns:0,0),frame_width:Math.max((gs=xe==null?void 0:xe.frameWidth)!==null&&gs!==void 0?gs:0,0),frames_decoded:Math.max(((is=xe==null?void 0:xe.framesDecoded)!==null&&is!==void 0?is:0)-((kr=lt==null?void 0:lt.framesDecoded)!==null&&kr!==void 0?kr:0),0),frames_dropped:Math.max(((fr=xe==null?void 0:xe.framesDropped)!==null&&fr!==void 0?fr:0)-((Kr=lt==null?void 0:lt.framesDropped)!==null&&Kr!==void 0?Kr:0),0),frames_received:Math.max(((rs=xe==null?void 0:xe.framesReceived)!==null&&rs!==void 0?rs:0)-((vs=lt==null?void 0:lt.framesReceived)!==null&&vs!==void 0?vs:0),0),freeze_count:Math.max(((ia=xe==null?void 0:xe.freezeCount)!==null&&ia!==void 0?ia:0)-((Sa=lt==null?void 0:lt.freezeCount)!==null&&Sa!==void 0?Sa:0),0),frames_rendered:Math.max((Cs=xe==null?void 0:xe.framesRendered)!==null&&Cs!==void 0?Cs:0,0),frames_per_second:Math.max((zs=xe==null?void 0:xe.framesPerSecond)!==null&&zs!==void 0?zs:0,0),header_bytes_received:Math.max(((pr=xe==null?void 0:xe.headerBytesReceived)!==null&&pr!==void 0?pr:0)-((Pa=lt==null?void 0:lt.headerBytesReceived)!==null&&Pa!==void 0?Pa:0),0),configured_jitter_buffer_min_delay_ms:Qn??0,jitter_buffer_min_obtainable_delay:Ff,jitter_buffer_delay_avg:Bf,key_frames_decoded:Math.max(((ti=xe==null?void 0:xe.keyFramesDecoded)!==null&&ti!==void 0?ti:0)-((qi=lt==null?void 0:lt.keyFramesDecoded)!==null&&qi!==void 0?qi:0),0),nack_count:Math.max(((Or=xe==null?void 0:xe.nackCount)!==null&&Or!==void 0?Or:0)-((Qa=lt==null?void 0:lt.nackCount)!==null&&Qa!==void 0?Qa:0),0),packets_discarded:Math.max(((Fo=xe==null?void 0:xe.packetsDiscarded)!==null&&Fo!==void 0?Fo:0)-((Ic=lt==null?void 0:lt.packetsDiscarded)!==null&&Ic!==void 0?Ic:0),0),packets_lost:yv,packets_received:Cy,pause_count:Math.max(((dl=xe==null?void 0:xe.pauseCount)!==null&&dl!==void 0?dl:0)-((_s=lt==null?void 0:lt.pauseCount)!==null&&_s!==void 0?_s:0),0),pli_count:Math.max(((lc=xe==null?void 0:xe.pliCount)!==null&&lc!==void 0?lc:0)-((zh=lt==null?void 0:lt.pliCount)!==null&&zh!==void 0?zh:0),0),power_efficient_decoder:(su=xe==null?void 0:xe.powerEfficientDecoder)!==null&&su!==void 0&&su,total_freezes_duration:Math.max(((Da=xe==null?void 0:xe.totalFreezesDuration)!==null&&Da!==void 0?Da:0)-((bo=lt==null?void 0:lt.totalFreezesDuration)!==null&&bo!==void 0?bo:0),0),total_pauses_duration:Math.max(((zo=xe==null?void 0:xe.totalPausesDuration)!==null&&zo!==void 0?zo:0)-((uc=lt==null?void 0:lt.totalPausesDuration)!==null&&uc!==void 0?uc:0),0),sei_read_count:On,sei_bytes_received:Ei,sei_bitrate:Ev}})(B,H,ne,se,Ie,Z,oe,de)))}}class py extends Yn{constructor(T,A,O,L,B,H,ne,se,Z){var oe,de;super(Sn.SUBSCRIBED_AUDIO_STATS,T,A,!1),Object.assign(this.properties,Object.assign({action:dn.SUBSCRIBE,node:(oe=L==null?void 0:L.node)!==null&&oe!==void 0?oe:"",cluster:(de=L==null?void 0:L.cluster)!==null&&de!==void 0?de:"",remote_participant_id:O},((me,Pe,Xe,qe,Ie)=>{var xe,lt,At,Jt,Nt,Qn,On,Ei,Fi,Pi,Ai,Si,Oi,Di,Ti,Ni,hi;let An=0;me!=null&&me.jitterBufferDelay&&(me!=null&&me.jitterBufferEmittedCount)&&me.jitterBufferEmittedCount>0&&(An=me.jitterBufferDelay/me.jitterBufferEmittedCount);const Kn=qe??1,Wi=Math.max((xe=me==null?void 0:me.bytesReceived)!==null&&xe!==void 0?xe:0,0),ts=8*Wi/Kn,ws=Math.max((lt=me==null?void 0:me.packetsLost)!==null&&lt!==void 0?lt:0,0),ns=Math.max((At=me==null?void 0:me.packetsReceived)!==null&&At!==void 0?At:0,0),gs=ws/Math.max(ns+ws,1),is=Math.max((Jt=me==null?void 0:me.concealedSamples)!==null&&Jt!==void 0?Jt:0,0),kr=Math.max((Nt=me==null?void 0:me.totalSamplesReceived)!==null&&Nt!==void 0?Nt:0,0),fr=is/Math.max(kr,1),Kr=Hu(Xe==null?void 0:Xe.mimeType,Xe==null?void 0:Xe.sdpFmtpLine);return{audio_level:(Qn=me==null?void 0:me.audioLevel)!==null&&Qn!==void 0?Qn:0,audio_nacks_enabled:(On=Ie==null?void 0:Ie.audioNacks)!==null&&On!==void 0&&On,bytes_received:Wi,codec_mime_type:Kr==null?void 0:Kr.mimeSubtype,connection_bandwidth:(Ei=Pe==null?void 0:Pe.availableIncomingBitrate)!==null&&Ei!==void 0?Ei:0,concealed_samples:is,concealment_events:Math.max((Fi=me==null?void 0:me.concealmentEvents)!==null&&Fi!==void 0?Fi:0,0),silent_concealed_samples:Math.max((Pi=me==null?void 0:me.silentConcealedSamples)!==null&&Pi!==void 0?Pi:0,0),decode_bitrate:ts,fraction_audio_concealed:fr,fraction_packets_lost:gs,header_bytes_received:Math.max((Ai=me==null?void 0:me.headerBytesReceived)!==null&&Ai!==void 0?Ai:0,0),inserted_samples_for_deceleration:Math.max((Si=me==null?void 0:me.insertedSamplesForDeceleration)!==null&&Si!==void 0?Si:0,0),jitter_buffer_delay_avg:An,packets_discarded:Math.max((Oi=me==null?void 0:me.packetsDiscarded)!==null&&Oi!==void 0?Oi:0,0),retransmitted_packets_received:Math.max((Di=me==null?void 0:me.retransmittedPacketsReceived)!==null&&Di!==void 0?Di:0,0),retransmitted_bytes_received:Math.max((Ti=me==null?void 0:me.retransmittedBytesReceived)!==null&&Ti!==void 0?Ti:0,0),packets_lost:ws,packets_received:ns,nack_count:Math.max((Ni=me==null?void 0:me.nackCount)!==null&&Ni!==void 0?Ni:0,0),removed_samples_for_acceleration:Math.max((hi=me==null?void 0:me.removedSamplesForAcceleration)!==null&&hi!==void 0?hi:0,0),total_samples_received:kr}})(B,H,ne,se,Z)))}}class $i extends Yn{constructor(T,A,O,L,B,H,ne,se,Z,oe){var de,me,Pe,Xe;super(Sn.SUBSCRIBED_AUDIO_STATS_WINDOW,T,A,!1);const qe=Math.max(((de=B==null?void 0:B.timestamp)!==null&&de!==void 0?de:0)-((me=H==null?void 0:H.timestamp)!==null&&me!==void 0?me:0),0);Object.assign(this.properties,Object.assign({action:dn.SUBSCRIBE,window_size_ms:qe,node:(Pe=L==null?void 0:L.node)!==null&&Pe!==void 0?Pe:"",cluster:(Xe=L==null?void 0:L.cluster)!==null&&Xe!==void 0?Xe:"",remote_participant_id:O},((Ie,xe,lt,At,Jt,Nt,Qn)=>{var On,Ei,Fi,Pi,Ai,Si,Oi,Di,Ti,Ni,hi,An,Kn,Wi,ts,ws,ns,gs,is,kr,fr,Kr,rs,vs,ia,Sa,Cs,zs,pr,Pa,ti;let qi=0,Or=0;if(Ie!=null&&Ie.jitterBufferEmittedCount&&(xe!=null&&xe.jitterBufferEmittedCount)&&Ie.jitterBufferEmittedCount>xe.jitterBufferEmittedCount){Ie!=null&&Ie.jitterBufferDelay&&(xe!=null&&xe.jitterBufferDelay)&&(qi=(Ie.jitterBufferDelay-xe.jitterBufferDelay)/(Ie.jitterBufferEmittedCount-xe.jitterBufferEmittedCount));const zo=xe==null?void 0:xe.jitterBufferMinimumDelay,uc=Ie==null?void 0:Ie.jitterBufferMinimumDelay;zo&&uc&&(Or=(uc-zo)/(Ie.jitterBufferEmittedCount-xe.jitterBufferEmittedCount))}const Qa=typeof Jt!="number"?1:Jt/1e3,Fo=Math.max(((On=Ie==null?void 0:Ie.bytesReceived)!==null&&On!==void 0?On:0)-((Ei=xe==null?void 0:xe.bytesReceived)!==null&&Ei!==void 0?Ei:0),0),Ic=8*Fo/Qa,dl=Math.max(((Fi=Ie==null?void 0:Ie.packetsLost)!==null&&Fi!==void 0?Fi:0)-((Pi=xe==null?void 0:xe.packetsLost)!==null&&Pi!==void 0?Pi:0),0),_s=Math.max(((Ai=Ie==null?void 0:Ie.packetsReceived)!==null&&Ai!==void 0?Ai:0)-((Si=xe==null?void 0:xe.packetsReceived)!==null&&Si!==void 0?Si:0),0),lc=dl/Math.max(_s+dl,1),zh=Math.max(((Oi=Ie==null?void 0:Ie.concealedSamples)!==null&&Oi!==void 0?Oi:0)-((Di=xe==null?void 0:xe.concealedSamples)!==null&&Di!==void 0?Di:0),0),su=Math.max(((Ti=Ie==null?void 0:Ie.totalSamplesReceived)!==null&&Ti!==void 0?Ti:0)-((Ni=xe==null?void 0:xe.totalSamplesReceived)!==null&&Ni!==void 0?Ni:0),0),Da=zh/Math.max(su,1),bo=Hu(At==null?void 0:At.mimeType,At==null?void 0:At.sdpFmtpLine);return{audio_level:(hi=Ie==null?void 0:Ie.audioLevel)!==null&&hi!==void 0?hi:0,audio_nacks_enabled:(An=Nt==null?void 0:Nt.audioNacks)!==null&&An!==void 0&&An,bytes_received:Fo,codec_mime_type:bo==null?void 0:bo.mimeSubtype,connection_bandwidth:(Kn=lt==null?void 0:lt.availableIncomingBitrate)!==null&&Kn!==void 0?Kn:0,decode_bitrate:Ic,concealed_samples:zh,concealment_events:Math.max(((Wi=Ie==null?void 0:Ie.concealmentEvents)!==null&&Wi!==void 0?Wi:0)-((ts=xe==null?void 0:xe.concealmentEvents)!==null&&ts!==void 0?ts:0),0),silent_concealed_samples:Math.max(((ws=Ie==null?void 0:Ie.silentConcealedSamples)!==null&&ws!==void 0?ws:0)-((ns=xe==null?void 0:xe.silentConcealedSamples)!==null&&ns!==void 0?ns:0),0),fraction_audio_concealed:Da,fraction_packets_lost:lc,header_bytes_received:Math.max(((gs=Ie==null?void 0:Ie.headerBytesReceived)!==null&&gs!==void 0?gs:0)-((is=xe==null?void 0:xe.headerBytesReceived)!==null&&is!==void 0?is:0),0),inserted_samples_for_deceleration:Math.max(((kr=Ie==null?void 0:Ie.insertedSamplesForDeceleration)!==null&&kr!==void 0?kr:0)-((fr=xe==null?void 0:xe.insertedSamplesForDeceleration)!==null&&fr!==void 0?fr:0),0),configured_jitter_buffer_min_delay_ms:Qn??0,jitter_buffer_min_obtainable_delay:Or,jitter_buffer_delay_avg:qi,packets_discarded:Math.max(((Kr=Ie==null?void 0:Ie.packetsDiscarded)!==null&&Kr!==void 0?Kr:0)-((rs=xe==null?void 0:xe.packetsDiscarded)!==null&&rs!==void 0?rs:0),0),packets_lost:dl,packets_received:_s,nack_count:Math.max(((vs=Ie==null?void 0:Ie.nackCount)!==null&&vs!==void 0?vs:0)-((ia=xe==null?void 0:xe.nackCount)!==null&&ia!==void 0?ia:0),0),removed_samples_for_acceleration:Math.max(((Sa=Ie==null?void 0:Ie.removedSamplesForAcceleration)!==null&&Sa!==void 0?Sa:0)-((Cs=xe==null?void 0:xe.removedSamplesForAcceleration)!==null&&Cs!==void 0?Cs:0),0),retransmitted_packets_received:Math.max(((zs=Ie==null?void 0:Ie.retransmittedPacketsReceived)!==null&&zs!==void 0?zs:0)-((pr=xe==null?void 0:xe.retransmittedPacketsReceived)!==null&&pr!==void 0?pr:0),0),retransmitted_bytes_received:Math.max(((Pa=Ie==null?void 0:Ie.retransmittedBytesReceived)!==null&&Pa!==void 0?Pa:0)-((ti=xe==null?void 0:xe.retransmittedBytesReceived)!==null&&ti!==void 0?ti:0),0),total_samples_received:su}})(B,H,ne,se,qe,Z,oe)))}}class sv extends Yn{constructor(T,A,O,L,B=dn.PUBLISH,H=!1,ne=""){super(Sn.SIMULCAST_LAYER_INFO,T,A,!1),Object.assign(this.properties,{rid:O,active:L,selected:H,source:B===dn.PUBLISH?"publisher":"subscriber",remote_participant_id:ne})}}class Tx extends Yn{constructor(T,A,O,L){super(Sn.MULTIHOST_CONFIGURATION,T,A,!1),Object.assign(this.properties,Object.assign(Object.assign({},O),{action:L}))}}class ng extends Yn{constructor(T,A,O){super(Sn.MULTIHOST_SUBSCRIBE_CONFIGURATION,T,A,!1),Object.assign(this.properties,Object.assign({},O))}}var kd,Vi,qp;(function(N){N.Mobile="mobile",N.Tablet="tablet",N.Desktop="desktop",N.Tv="tv"})(kd||(kd={})),function(N){N.IOS="iOS",N.MacOS="macOS",N.Windows="Windows",N.Android="Android"}(Vi||(Vi={})),function(N){N.Safari="Safari",N.Firefox="Firefox",N.Chrome="Chrome",N.IE="Internet Explorer",N.Edge="Microsoft Edge"}(qp||(qp={}));const ps=function(N){const T=Ih(N);return{platform:{isMobile:$p(kd.Mobile,T),isTablet:$p(kd.Tablet,T),isDesktop:$p(kd.Desktop,T),isTv:$p(kd.Tv,T)},os:{name:Wp(T),version:ig(T),isIOS:kh(Vi.IOS,T),isMacOS:kh(Vi.MacOS,T),isWindows:kh(Vi.Windows,T),isAndroid:kh(Vi.Android,T)},browser:{name:Ph(T),version:ul(T),isSafari:Yp(qp.Safari,T),isFirefox:Yp(qp.Firefox,T),isChrome:Yp(qp.Chrome,T),isIE:Yp(qp.IE,T),isEdge:Yp(qp.Edge,T)}}}(window.navigator.userAgent);function Ih(N){try{return Ws.getParser(N||window.navigator.userAgent)}catch{}}function $p(N,T){return()=>(T||(T=Ih()),!(!T||T.getPlatformType(!0)!==N.toLowerCase()))}function ig(N){return()=>(N||(N=Ih()),N&&N.getOSVersion()||"")}function Wp(N){return()=>(N||(N=Ih()),N&&N.getOSName()||"")}function kh(N,T){return()=>(T||(T=Ih()),!(!T||T.getOSName(!0)!==N.toLowerCase()))}function ul(N){return()=>(N||(N=Ih()),N&&N.getBrowserVersion()||"")}function Ph(N){return()=>(N||(N=Ih()),N&&N.getBrowserName()||"")}function Yp(N,T){return()=>(T||(T=Ih()),!(!T||T.getBrowserName().toLowerCase()!==N.toLowerCase()))}const uS={active:!1,maxBitrate:2e5,rid:"low",maxFramerate:15,scaleResolutionDownBy:4},Vu={width:320,height:180},rg={active:!1,maxBitrate:7e5,rid:"mid",maxFramerate:20,scaleResolutionDownBy:2},av={width:640,height:360},Kp={active:!1,maxBitrate:17e5,rid:"hi",maxFramerate:30,scaleResolutionDownBy:1},ov={width:1280,height:720};function Gu(N){const{config:T}=N;return[{maxBitrate:T.maxBitrateBps}]}function Dh(N,T){var A,O;const L=T==null?void 0:T.track,B=T==null?void 0:T.config;if(N&&L){const H=(0,_a.cloneDeep)([{encodingParams:uS,targetResolution:Vu},{encodingParams:rg,targetResolution:av},{encodingParams:Kp,targetResolution:ov}]),{height:ne,width:se}=L.getSettings(),Z=ne&&se?{width:se,height:ne}:void 0;for(const me of H){me.encodingParams.active=!0;let Pe=1;Z&&(Pe=Math.floor(Math.sqrt(Z.width*Z.height/(me.targetResolution.width*me.targetResolution.height))),Pe=Math.max(Pe,1)),me.encodingParams.scaleResolutionDownBy=Pe}let oe=(A=B==null?void 0:B.maxBitrateBps)!==null&&A!==void 0?A:Kp.maxBitrate;const de=(O=B==null?void 0:B.maxFramerate)!==null&&O!==void 0?O:Kp.maxFramerate;return oe<rg.maxBitrate&&(oe=Kp.maxBitrate),H[2].encodingParams.maxBitrate=oe,H[2].encodingParams.maxFramerate=de,H[2].encodingParams.scaleResolutionDownBy=1,H.map(me=>me.encodingParams)}return B?[{maxBitrate:B.maxBitrateBps,maxFramerate:B.maxFramerate}]:[{maxBitrate:mo(tg),maxFramerate:Oc}]}const OR=1e3;function mo(N){return N*OR}const hS=(N,...T)=>{const A=T.map(O=>typeof O!="object").filter(Boolean).length>0;if(typeof N=="object"&&!A)return(0,_a.merge)({},N,...T)},bi=N=>sg(N),sg=N=>(0,_a.cloneDeep)(N),my=N=>{switch(N){case iu.HIGHEST_QUALITY:return"highest";case iu.LOWEST_QUALITY:default:return"lowest"}};var Xp=function(N,T,A,O){return new(A||(A=Promise))(function(L,B){function H(Z){try{se(O.next(Z))}catch(oe){B(oe)}}function ne(Z){try{se(O.throw(Z))}catch(oe){B(oe)}}function se(Z){var oe;Z.done?L(Z.value):(oe=Z.value,oe instanceof A?oe:new A(function(de){de(oe)})).then(H,ne)}se((O=O.apply(N,[])).next())})};const Pd="no-rid";class cv{constructor(T,A,O,L,B,H){this.analyticsTracker=B,this.receiveVideoTransformer=H,this.simulcastEnabled=!1,this.simulcastState={low:!1,mid:!1,hi:!1},this.sdp=new Gr(""),this.sdpFeatures={audioNacks:!1},this.multihostConfiguration=cv.defaultMultihostConfiguration(),this.prevOutboundVideoStats=new Map,this.prevInboundVideoStats=new Map,this.prevRemoteInboundStats=new Map,this.sfuResource={node:"",cluster:""},this.connectionStartedTimestamp=Date.now(),this.prevVideoReceiverTransformerStats={seiReadCnt:0,seiBytesRead:0},this.onPeerConnectionStateChange=()=>{switch(this.getConnectionState()){case st.CONNECTED:this.connectionStartedTimestamp=Date.now(),this.setupIntervals();break;case st.FAILED:this.flushStats()}},this.action=T,this.token=A,this.traceId=O,this.identifier=L}static defaultMultihostConfiguration(){return{video_codec:"unknown",width:0,height:0,max_bitrate:0,min_bitrate:0,target_fps:0,echo_cancellation:!1,auto_gain:!1,noise_suppression:!1,enable_simulcast:!1,max_audio_bitrate_bps:mo(lr)}}set sdpAnswer(T){try{this.sdp=new Gr(T),this.sdpFeatures.audioNacks=this.sdp.hasAudioNacksEnabled()}catch{}}start(T,A=!1){this.peerConnection=T,this.simulcastEnabled=A,this.prevOutboundAudioStats=void 0,this.prevOutboundVideoStats=new Map,this.prevRemoteInboundStats=new Map,this.peerConnection.addEventListener("connectionstatechange",this.onPeerConnectionStateChange)}stop(){var T;clearInterval(this.uploadStatsInterval),this.uploadStatsInterval=void 0,(T=this.peerConnection)===null||T===void 0||T.removeEventListener("connectionstatechange",this.onPeerConnectionStateChange)}updateSfuResource(T){this.sfuResource=T}updateMultihostConfiguration(T,A){var O,L,B,H,ne,se;return Xp(this,void 0,void 0,function*(){if(this.action!==dn.PUBLISH||!this.peerConnection)return;const Z=cv.defaultMultihostConfiguration();if(A){const oe=this.peerConnection.getSenders().filter(me=>me.track!==null&&me.track.kind==="video");oe.length>0&&(yield oe[0].getStats()).forEach(me=>{me.type==="codec"&&(Z.video_codec=me.mimeType)});const de=A.track.getSettings();Z.width=(O=de.width)!==null&&O!==void 0?O:0,Z.height=(L=de.height)!==null&&L!==void 0?L:0,Z.target_fps=(B=de.frameRate)!==null&&B!==void 0?B:0,A.config?(Z.max_bitrate=A.config.maxBitrateBps,Z.min_bitrate=A.config.minBitrateBps,Z.enable_simulcast=A.config.simulcastEnabled):(Z.max_bitrate=mo(tg),Z.min_bitrate=mo(eg),Z.enable_simulcast=!1)}if(T){const oe=T.track.getSettings();Z.auto_gain=(H=oe.autoGainControl)!==null&&H!==void 0&&H,Z.echo_cancellation=(ne=oe.echoCancellation)!==null&&ne!==void 0&&ne,Z.noise_suppression=(se=oe.noiseSuppression)!==null&&se!==void 0&&se,Z.max_audio_bitrate_bps=T.config.maxBitrateBps,Z.stereo=T.config.stereo}(0,_a.isEqual)(Z,this.multihostConfiguration)||(this.analyticsTracker.trackEventNoSharedProps(new Tx(this.token,this.traceId,Z,this.action)),this.multihostConfiguration=Z)})}updateJitterBufferMinDelay(T){this.jitterBufferMinDelayInMs=T}setupIntervals(){this.action===dn.PUBLISH&&this.simulcastEnabled&&!this.pollSimulcastLayerInterval&&(this.pollSimulcastLayers(),this.pollSimulcastLayerInterval=this.startInterval(this.pollSimulcastLayers,5e3)),this.uploadStatsInterval||(this.uploadStats(),this.uploadStatsInterval=this.startInterval(this.uploadStats,1e4))}startInterval(T,A){return setInterval(T.bind(this),A)}getConnectionState(){var T;if(!this.peerConnection)return st.NONE;const A=(T=this.peerConnection.connectionState)!==null&&T!==void 0?T:this.peerConnection.iceConnectionState;try{return iS(A)}catch{return st.IDLE}}pollSimulcastLayers(){var T;return Xp(this,void 0,void 0,function*(){if(this.getConnectionState()===st.CONNECTED){const A=yield(T=this.peerConnection)===null||T===void 0?void 0:T.getStats();if(!A)return;A.forEach(O=>{var L;if(O.type==="outbound-rtp"){const B=((L=O.framesPerSecond)!==null&&L!==void 0?L:0)!==0;switch(O.rid){case"low":B!==this.simulcastState.low&&(this.simulcastState.low=B,this.analyticsTracker.trackEventNoSharedProps(new sv(this.token,this.traceId,O.rid,B)));break;case"mid":B!==this.simulcastState.mid&&(this.simulcastState.mid=B,this.analyticsTracker.trackEventNoSharedProps(new sv(this.token,this.traceId,O.rid,B)));break;case"hi":B!==this.simulcastState.hi&&(this.simulcastState.hi=B,this.analyticsTracker.trackEventNoSharedProps(new sv(this.token,this.traceId,O.rid,B)))}}})}})}flushStats(){var T;return Xp(this,void 0,void 0,function*(){const A=yield(T=this.peerConnection)===null||T===void 0?void 0:T.getStats();A&&(this.action===dn.PUBLISH?this.uploadPublisherStats(A):this.action===dn.SUBSCRIBE&&this.uploadSubscriberStats(A))})}uploadStats(){var T;return Xp(this,void 0,void 0,function*(){if(this.getConnectionState()===st.CONNECTED){const A=yield(T=this.peerConnection)===null||T===void 0?void 0:T.getStats();if(!A)return;this.action===dn.PUBLISH?this.uploadPublisherStats(A):this.action===dn.SUBSCRIBE&&this.uploadSubscriberStats(A)}})}uploadPublisherStats(T){const A={audio:{},video:[]},O=new Map,L=(Date.now()-this.connectionStartedTimestamp)/1e3,B=Object.assign({},this.multihostConfiguration);T.forEach(H=>{if(H.type==="outbound-rtp"){const ne=T.get(H.remoteId),se=this.prevRemoteInboundStats.get(H.remoteId);switch(ne&&this.prevRemoteInboundStats.set(ne.id,ne),H.kind){case"audio":A.audio=this.updateOutboundAudio(H),A.audio.remoteInbound=ne,A.audio.prevRemoteInbound=se,A.audio.codec=O.get(H.codecId);break;case"video":A.video.push(Object.assign({},this.updateOutboundVideo(H),{remoteInbound:ne,prevRemoteInbound:se,codec:O.get(H.codecId)}))}}H.type==="candidate-pair"&&H.nominated&&(A.candidatePair=H),H.type==="codec"&&O.set(H.id,H)}),this.analyticsTracker.trackEventNoSharedProps(new cS(this.token,this.traceId,this.sfuResource,A.audio.outbound,A.audio.remoteInbound,A.candidatePair,A.audio.codec,B,L,this.sdpFeatures)),A.audio.prevOutbound&&this.analyticsTracker.trackEventNoSharedProps(new rv(this.token,this.traceId,this.sfuResource,A.audio.outbound,A.audio.prevOutbound,A.audio.remoteInbound,A.audio.prevRemoteInbound,A.candidatePair,A.audio.codec,B,this.sdpFeatures)),A.video.forEach(H=>{this.analyticsTracker.trackEventNoSharedProps(new iv(this.token,this.traceId,this.sfuResource,H.outbound,H.remoteInbound,A.candidatePair,H.codec,B,L)),H.prevOutbound&&this.analyticsTracker.trackEventNoSharedProps(new Pf(this.token,this.traceId,this.sfuResource,H.outbound,H.prevOutbound,H.remoteInbound,H.prevRemoteInbound,A.candidatePair,H.codec,B))})}uploadSubscriberStats(T){var A;const O={audio:{},video:{}},L=new Map,B=(Date.now()-this.connectionStartedTimestamp)/1e3,H=(A=this.jitterBufferMinDelayInMs)!==null&&A!==void 0?A:0,{seiReadCnt:ne,seiBytesRead:se}=this.updateAndDiffSinceLastUpdate(this.receiveVideoTransformer.getReceiverStats());T.forEach(Z=>{if(Z.type==="inbound-rtp")switch(Z.kind){case"audio":O.audio=this.updateInboundAudio(Z),O.audio.codec=L.get(Z.codecId);break;case"video":O.video=this.updateInboundVideo(Z),O.video.codec=L.get(Z.codecId)}Z.type==="candidate-pair"&&Z.nominated&&(O.candidatePair=Z),Z.type==="codec"&&L.set(Z.id,Z)}),this.analyticsTracker.trackEventNoSharedProps(new py(this.token,this.traceId,this.identifier,this.sfuResource,O.audio.inbound,O.candidatePair,O.audio.codec,B,this.sdpFeatures)),O.audio.prevInbound&&this.analyticsTracker.trackEventNoSharedProps(new $i(this.token,this.traceId,this.identifier,this.sfuResource,O.audio.inbound,O.audio.prevInbound,O.candidatePair,O.audio.codec,this.sdpFeatures,H)),this.analyticsTracker.trackEventNoSharedProps(new fy(this.token,this.traceId,this.identifier,this.sfuResource,O.video.inbound,O.candidatePair,O.video.codec,B)),O.video.prevInbound&&this.analyticsTracker.trackEventNoSharedProps(new lS(this.token,this.traceId,this.identifier,this.sfuResource,O.video.inbound,O.video.prevInbound,O.candidatePair,O.video.codec,H,ne,se))}updateAndDiffSinceLastUpdate(T){const A=this.prevVideoReceiverTransformerStats,O=T.seiReadCnt-A.seiReadCnt,L=T.seiBytesRead-A.seiBytesRead;return this.prevVideoReceiverTransformerStats={seiReadCnt:T.seiReadCnt,seiBytesRead:T.seiBytesRead},{seiReadCnt:O,seiBytesRead:L}}updateOutboundAudio(T){const A=T,O=this.prevOutboundAudioStats,L=T.id===(O==null?void 0:O.id)?O:void 0;return this.prevOutboundAudioStats=T,{outbound:A,prevOutbound:L}}updateInboundAudio(T){const A=T,O=this.prevInboundAudioStats,L=T.id===(O==null?void 0:O.id)?O:void 0;return this.prevInboundAudioStats=T,{inbound:A,prevInbound:L}}updateInboundVideo(T){const A=T,O=this.prevInboundVideoStats.get(Pd),L=T.id===(O==null?void 0:O.id)?O:void 0;return this.prevInboundVideoStats.set(Pd,T),{inbound:A,prevInbound:L}}updateOutboundVideo(T){const A=T,O=this.getPrevOutboundVideo(T),L=T.id===(O==null?void 0:O.id)?O:void 0;return this.setPrevVideoStat(T),{outbound:A,prevOutbound:L}}getPrevOutboundVideo(T){return this.simulcastEnabled&&T.rid&&this.prevOutboundVideoStats.has(T.rid)?this.prevOutboundVideoStats.get(T.rid):!this.simulcastEnabled&&this.prevOutboundVideoStats.has(Pd)?this.prevOutboundVideoStats.get(Pd):void 0}setPrevVideoStat(T){this.simulcastEnabled&&T.rid?this.prevOutboundVideoStats.set(T.rid,T):this.simulcastEnabled||this.prevOutboundVideoStats.set(Pd,T)}}class Nc extends Yn{constructor(T,A,O,L,B){super(Sn.MINUTE,T,A,!1),Object.assign(this.properties,{action:L?dn.PUBLISH:dn.SUBSCRIBE,is_publishing:L,minutes_logged:O,subscribed_number:B})}}class qu extends Yn{constructor(T){super(Sn.PUBLISH,T.token,T.traceId,!1),Object.assign(this.properties,{action:dn.PUBLISH,remote_participant_id:T.token.participantID})}}class Df extends Yn{constructor(T){super(Sn.UNPUBLISH,T.token,T.traceId,!0),Object.assign(this.properties,{action:dn.PUBLISH,remote_participant_id:T.token.participantID})}}class ag extends Yn{constructor(T){var A,O,L,B;super(Sn.SUBSCRIBE,T.token,T.traceId,!1),Object.assign(this.properties,{action:dn.SUBSCRIBE,remote_participant_id:T.subscribedId,subscribed_id:T.subscribedId,is_edp_connected:T.isEdpConnected,is_reassignment:T.isReassignment,node:(O=(A=T.preAttemptSfuResource)===null||A===void 0?void 0:A.node)!==null&&O!==void 0?O:"",cluster:(B=(L=T.preAttemptSfuResource)===null||L===void 0?void 0:L.cluster)!==null&&B!==void 0?B:""})}}class xx extends Yn{constructor(T){super(Sn.UNSUBSCRIBE,T.token,T.traceId,!0),Object.assign(this.properties,{action:dn.SUBSCRIBE,remote_participant_id:T.unsubscribedId,unsubscribed_id:T.unsubscribedId})}}class wx extends Yn{constructor(T){var A,O,L,B;super(Sn.PUBLISH_STARTED,T.token,T.traceId,!1),Object.assign(this.properties,{action:dn.PUBLISH,options_duration:T.optionsDuration,post_duration:T.postDuration,remote_participant_id:T.token.participantID,time_to_candidate:T.timeToCandidate,total_duration:T.totalDuration,edp_initial_connect_duration:T.edpInitialConnectDuration,edp_initial_connect_retry_times:T.edpInitialConnectRetries,edp_initial_state_duration:T.edpInitialStateDuration,edp_state_update_count:T.edpStateUpdateCount,sdp_exchange_duration:T.sdpExchangeDuration,sdp_exchange_transport:T.sdpExchangeTransport,set_remote_desc_duration:T.setRemoteDescDuration,peer_connection_duration:T.peerConnectionDuration,node:(O=(A=T.sfuResource)===null||A===void 0?void 0:A.node)!==null&&O!==void 0?O:"",cluster:(B=(L=T.sfuResource)===null||L===void 0?void 0:L.cluster)!==null&&B!==void 0?B:"",publish_retry_times:T.publishRetries,total_duration_with_retries:T.totalDurationWithRetries})}}class Cx extends Yn{constructor(T){super(Sn.PUBLISH_FAILED,T.token,T.traceId,!1),Object.assign(this.properties,{action:dn.PUBLISH,code:T.code,message:T.message,fatal:T.fatal,nominal:T.nominal})}}class Zp extends Yn{constructor(T){super(Sn.PUBLISH_ENDED,T.token,T.traceId,!0),Object.assign(this.properties,{action:dn.PUBLISH,remote_participant_id:T.token.participantID,unpublish_successful:T.isUnpublishSuccessful,reason:T.reason})}}class Jp extends Yn{constructor(T){var A,O,L,B;super(Sn.SUBSCRIBE_STARTED,T.token,T.traceId,!1),Object.assign(this.properties,{action:dn.SUBSCRIBE,options_duration:T.optionsDuration,post_duration:T.postDuration,remote_participant_id:T.remoteParticipantId,time_to_candidate:T.timeToCandidate,total_duration:T.totalDuration,edp_initial_connect_duration:T.edpInitialConnectDuration,edp_initial_connect_retry_times:T.edpInitialConnectRetries,edp_initial_state_duration:T.edpInitialStateDuration,edp_initial_state_publishing_count:T.edpInitialStatePublishingCount,edp_state_update_count:T.edpStateUpdateCount,sdp_exchange_duration:T.sdpExchangeDuration,sdp_exchange_transport:T.sdpExchangeTransport,set_remote_desc_duration:T.setRemoteDescDuration,peer_connection_duration:T.peerConnectionDuration,node:(O=(A=T.sfuResource)===null||A===void 0?void 0:A.node)!==null&&O!==void 0?O:"",cluster:(B=(L=T.sfuResource)===null||L===void 0?void 0:L.cluster)!==null&&B!==void 0?B:"",total_duration_with_retries:T.totalDurationWithRetries,subscribe_retry_times:T.subscribeRetryTimes,is_reassignment:T.isReassignment})}}class dS extends Yn{constructor(T){super(Sn.SUBSCRIBE_FAILED,T.token,T.traceId,!1),Object.assign(this.properties,{action:dn.SUBSCRIBE,remote_participant_id:T.remoteParticipantId,code:T.code,message:T.message,fatal:T.fatal,nominal:T.nominal,is_reassignment:T.isReassignment})}}class og extends Yn{constructor(T){super(Sn.SUBSCRIBE_ENDED,T.token,T.traceId,!0),Object.assign(this.properties,{action:dn.SUBSCRIBE,remote_participant_id:T.remoteParticipantId,unsubscribe_successful:T.isUnsubscribeSuccessful,reason:T.reason}),this.critical=!0}}class lv extends Yn{constructor(T){super(Sn.STATE_UPDATED,T.token,T.traceId,!1),Object.assign(this.properties,{audio_muted:T.isAudioMuted,is_disconnected:T.isDisconnected,is_publishing:T.isPublishing,other_participant_id:T.otherParticipantId,other_participant_user_id:T.otherParticipantUserId,video_stopped:T.isVideoStopped})}}class Ax extends Yn{constructor(T){var A,O,L,B,H;super(Sn.FIRST_FRAME,T.token,T.traceId,!1),Object.assign(this.properties,{action:dn.SUBSCRIBE,remote_participant_id:T.remoteParticipantId,edp_initial_connect_duration:T.edpInitialConnectDuration,edp_initial_connect_retry_times:T.edpInitialConnectRetries,edp_initial_state_duration:T.edpInitialStateDuration,edp_initial_state_publishing_count:T.edpInitialStatePublishingCount,edp_state_update_count:T.edpStateUpdateCount,sdp_exchange_duration:T.sdpExchangeDuration,sdp_exchange_transport:T.sdpExchangeTransport,set_remote_desc_duration:T.setRemoteDescDuration,peer_connection_duration:T.peerConnectionDuration,node:(O=(A=T.sfuResource)===null||A===void 0?void 0:A.node)!==null&&O!==void 0?O:"",cluster:(B=(L=T.sfuResource)===null||L===void 0?void 0:L.cluster)!==null&&B!==void 0?B:"",video_was_paused:T.videoWasPaused,first_frame_duration:T.firstFrameDuration,total_duration_with_retries:T.totalDurationWithRetries,subscribe_retry_times:T.subscribeRetryTimes,media_type:T.mediaType,configured_jitter_buffer_min_delay_ms:(H=T.currentJitterBufferMinDelayInMs)!==null&&H!==void 0?H:0})}}class gy extends Yn{constructor(T){super(Sn.EDP_PONG,T.token,T.traceId,!1),Object.assign(this.properties,{event_endpoint:T.eventEndpoint,protocol:T.protocol,edp_rtt:T.edpRttMs})}}class uv extends Yn{constructor(T){super(Sn.JOIN,T.token,T.traceId,!1),Object.assign(this.properties,{action:dn.JOIN,event_endpoint:T.eventEndpoint,whip_endpoint:T.whipEndpoint})}}class ru extends Yn{constructor(T){super(Sn.JOIN_ATTEMPT,T.token,T.traceId,!1),Object.assign(this.properties,{action:dn.JOIN,event_endpoint:T.eventEndpoint,whip_endpoint:T.whipEndpoint})}}class Lo extends Yn{constructor(T){super(Sn.JOIN_ATTEMPT_FAILED,T.token,T.traceId,!1),Object.assign(this.properties,{action:dn.JOIN,event_endpoint:T.eventEndpoint,whip_endpoint:T.whipEndpoint,code:T.code,message:T.message,fatal:T.fatal,nominal:T.nominal,connect_retry_times:T.retryCnt})}}class $u extends Yn{constructor(T){super(Sn.EDP_DISCONNECTED,T.token,T.traceId,!1),Object.assign(this.properties,{event_endpoint:T.eventEndpoint,protocol:T.protocol}),this.critical=!0}}class Dl extends Yn{constructor(T){super(Sn.EDP_CONNECTED,T.token,T.traceId,!1),Object.assign(this.properties,{event_endpoint:T.eventEndpoint,protocol:T.protocol,connect_retry_times:T.numRetries}),this.critical=!0}}var hv;(function(N){N.MESSAGE="message",N.RESPONSE="response"})(hv||(hv={}));class NR{constructor(T,A,O){this.token=T,this.analyticsTracker=O,this.protocol="",this.connecting=!1,this.closing=!1,this.windowUnloading=!1,this.latestPingTimestamp=0,this.pongCount=0,this.latestSequenceNumber=0,this.nextConnectionAttempt=0,this.pingInterval=0,this.pongTimeout=0,this.connectTimeout=0,this.beforeUnload=()=>{this.emitter.emit(Bu,"beforeunload"),this.windowUnloading=!0},this.sendSdpOffer=(L,B,H,ne,se,Z,oe,de)=>{var me;const Pe={type:"aws:ivs:SDP_OFFER",payload:{whipUrl:B,requestId:ne,traceId:H,platform:"web",sdk:"1.19.0",whipVersion:Mc,content:L,contentType:"application/sdp"}};se&&(Pe.payload.forceNode=se),Z&&(Pe.payload.assignmentToken=Z),oe&&(Pe.payload.multiCodec=oe);const Xe=D0()===void 0,qe=D0()||Xe;de&&qe&&(Pe.payload.initialLayerPref=my(de)),(me=this.socket)===null||me===void 0||me.send(JSON.stringify(Pe))},this.getRetryCount=()=>Math.max(this.connectionAttempts-1,0),this.trackJoinEnded=()=>{this.analyticsTracker.trackEventNoSharedProps(new $u({token:this.token,eventEndpoint:this.token.eventsURL,traceId:this.traceId,protocol:this.protocol}))},this.logger=new fo(A,fe.SOCKET),this.emitter=new ho.EventEmitter,this.connectionAttempts=0,this.sentPing=!1,this.receivedPong=!1,this.traceId=wc(),this.id=`[${Na().value}] `,window.addEventListener("beforeunload",this.beforeUnload)}connect(T,A,O=!1){this.logger.debug({msg:`${this.id}connecting to ${this.addr}`}),this.addr=T,this.traceId=A,O&&!this.connecting&&(window.clearTimeout(this.connectTimeout),this.connectTimeout=window.setTimeout(this.connectTimedOut.bind(this),1e4)),this.attemptConnect(A)}attemptConnect(T){this.traceId=T||wc(),this.connectionAttempts++,this.trackJoinAttempt(this.connectionAttempts);const{topic:A,rawToken:O}=this.token;this.connecting=!0,this.closing=!1;try{const L=encodeURIComponent(this.traceId.value);this.socket=this.createWebSocket(`${this.addr}?topic=${A}/publishers&traceid=${L}`,O),this.socket.onmessage=this.onMessage.bind(this),this.socket.onerror=this.onError.bind(this),this.socket.onclose=this.onClose.bind(this),this.socket.onopen=this.onOpen.bind(this),this.protocol=this.socket.protocol}catch(L){const B=L instanceof Error?L.message:void 0,H=this.createError(Ut.EVENT_PLANE_WS_CREATE_FAILED,B);this.trackJoinFailed(H,this.getRetryCount()),this.emitter.emit(nu,H)}}send(T){var A;this.logger.debug({msg:`${this.id}sending ${JSON.stringify(T)}`}),this.isReady()?(A=this.socket)===null||A===void 0||A.send(JSON.stringify(T)):this.logger.warn({msg:"Trying to send data over stage socket that is not ready"})}close(){this.logger.debug({msg:`${this.id}closing`});const T=this.connecting,A=this.socket&&this.socket.readyState===this.socket.OPEN,O=this.socket&&this.socket.readyState===this.socket.CLOSING,L=this.getRetryCount();if(this.closing=!0,this.connecting=!1,this.cleanPingPongTimeouts(),window.clearTimeout(this.nextConnectionAttempt),window.clearTimeout(this.connectTimeout),this.connectionAttempts=0,this.connectTimeout=0,this.socket){if(this.socket.close(),this.socket.onmessage=null,this.socket.onerror=null,this.socket.onclose=null,this.socket.onopen=null,A)this.trackJoinEnded(),this.emitter.emit(Bu,"intentional-close");else if(T&&!O){const B=this.createError(Ut.OPERATION_ABORTED);this.trackJoinFailed(B,L),this.analyticsTracker.trackError(B),this.emitter.emit(nu,B)}}}removeAllListeners(){window.removeEventListener("beforeunload",this.beforeUnload),this.emitter.removeAllListeners()}createWebSocket(T,A){return new WebSocket(T,A)}createError(T,A){return new ki(Object.assign({action:dn.JOIN,traceId:this.traceId,token:this.token,location:"StageSocket.connection",tag:Cc.JOIN_RELATED,details:A},T))}on(T,A){this.emitter.on(T,A)}off(T,A){this.emitter.off(T,A)}isReady(){return this.logger.debug({msg:`${this.id}isReady called`}),!!this.socket&&this.socket.readyState===this.socket.OPEN}onMessage(T){this.logger.debug({msg:`${this.id}received message: ${T.data}`});try{const A=JSON.parse(T.data);switch(A.type){case"STAGE_STATE":case"aws:ivs:STAGE_STATE":{const O=A.payload.sequenceNumber;O>this.latestSequenceNumber&&(this.latestSequenceNumber===0&&P0()&&this.connectTimeout>0&&this.triggerSocketOpen(A),this.emitter.emit(ly,A),this.latestSequenceNumber=O);break}case"PONG":this.receivedPong=!0,this.pongCount%2==0&&this.analyticsTracker.trackEventNoSharedProps(new gy({token:this.token,eventEndpoint:this.token.eventsURL,protocol:this.protocol,traceId:this.traceId,edpRttMs:performance.now()-this.latestPingTimestamp})),this.pongCount++;break;case"REFRESH":this.emitter.emit(cy);break;case"aws:ivs:SDP_ANSWER":this.emitter.emit(Y0,A.payload);break;case"aws:ivs:DISCONNECT":this.emitter.emit(K0,A.payload);break;case"aws:ivs:REASSIGN":this.emitter.emit(If,A.payload);break;case"aws:ivs:INCOMPATIBLE_CODECS":this.emitter.emit(Do,A.payload);break;default:(0,_a.noop)()}}catch(A){this.logger.debug({msg:`onMessage JSON Parse error: ${A}`}),this.emitter.emit(Rc,A)}}onError(T){this.logger.debug({msg:`${this.id}error: ${JSON.stringify(T)}`})}onClose(T){if(this.logger.debug({msg:`${this.id}onClose triggered with code (closing = ${this.closing}, connecting = ${this.connecting})`}),this.cleanPingPongTimeouts(),this.closing)this.closing=!1;else if(!this.windowUnloading)if(this.connecting){let A=Math.pow(2,this.connectionAttempts-1);A>64&&(A=64),this.logger.debug({msg:`${this.id}reconnecting in ${A} seconds`}),window.clearTimeout(this.nextConnectionAttempt),this.nextConnectionAttempt=window.setTimeout(this.attemptConnect.bind(this),1e3*A);const O=this.createError(Ut.EVENT_PLANE_WS_CLOSE_BEFORE_OPEN,`code: ${T==null?void 0:T.code}, reason: ${T==null?void 0:T.reason}, wasClean: ${T==null?void 0:T.wasClean}`);this.trackJoinFailed(O,this.getRetryCount()),this.analyticsTracker.trackError(O)}else{this.logger.debug({msg:`${this.id}unexpected close`}),this.emitter.emit(Bu,"unknown");const A=this.createError(Ut.EVENT_PLANE_WS_UNEXPECTED_CLOSE,`code: ${T==null?void 0:T.code}, reason: ${T==null?void 0:T.reason}, wasClean: ${T==null?void 0:T.wasClean}`);this.trackJoinEnded(),this.emitter.emit(nu,A)}}onOpen(){this.logger.debug({msg:`${this.id} socket opened`}),this.clearConnectionAttemptTimeouts(),P0()?this.connectTimeout=window.setTimeout(()=>{this.triggerSocketOpen()},1e4):this.triggerSocketOpen()}clearConnectionAttemptTimeouts(){window.clearTimeout(this.nextConnectionAttempt),window.clearTimeout(this.connectTimeout),this.nextConnectionAttempt=0,this.connectTimeout=0}triggerSocketOpen(T){this.clearConnectionAttemptTimeouts();const A=this.getRetryCount();this.connectionAttempts=0,this.connecting=!1,this.trackJoinStarted(),this.emitter.emit(ll,{retryCnt:A,traceId:this.traceId,initialStageState:T}),this.pingInterval=window.setInterval(this.ping.bind(this),3e4)}ping(){var T;this.logger.debug({msg:`${this.id}sending PING`});try{this.latestPingTimestamp=performance.now(),(T=this.socket)===null||T===void 0||T.send(JSON.stringify({type:"PING"})),this.sentPing=!0,this.receivedPong=!1,this.pongTimeout&&clearTimeout(this.pongTimeout),this.pongTimeout=window.setTimeout(this.pongTimedOut.bind(this),5e3)}catch(A){const O=A instanceof Error?A.message:void 0,L=this.createError(Ut.EVENT_PLANE_PING_SEND_FAIL,O);this.emitter.emit(nu,L)}}connectTimedOut(){const T=this.socket&&this.socket.readyState===this.socket.CONNECTING;this.connecting=!1,this.logger.debug({msg:`${this.id}Connect timed out!`});const A=this.createError(Ut.JOIN_TIMED_OUT);T&&this.trackJoinFailed(A,this.getRetryCount()),this.createError(Ut.JOIN_TIMED_OUT),this.emitter.emit(nu,A),this.close()}pongTimedOut(){if(this.sentPing&&!this.receivedPong){this.logger.debug({msg:`${this.id}Pong timed out!`});const T=this.createError(Ut.EVENT_PLANE_PONG_TIMEOUT);this.emitter.emit(nu,T)}}cleanPingPongTimeouts(){this.sentPing=this.receivedPong=!1,window.clearTimeout(this.pongTimeout),window.clearInterval(this.pingInterval)}trackJoinAttempt(T){const{token:A,traceId:O}=this;this.analyticsTracker.trackEvent(new ru({token:A,eventEndpoint:(A==null?void 0:A.eventsURL)||"",whipEndpoint:(A==null?void 0:A.whipURL)||"",traceId:O}))}trackJoinFailed(T,A){const{token:O,traceId:L,code:B,message:H,fatal:ne,nominal:se}=T;this.analyticsTracker.trackEvent(new Lo({token:O,eventEndpoint:O.eventsURL,whipEndpoint:O.whipURL,traceId:L,code:B,message:H,fatal:ne,nominal:se,retryCnt:A}))}trackJoinStarted(){this.analyticsTracker.trackEventNoSharedProps(new Dl({token:this.token,eventEndpoint:this.token.eventsURL,numRetries:this.getRetryCount(),protocol:this.protocol,traceId:this.traceId}))}}var ic=function(N,T,A,O){return new(A||(A=Promise))(function(L,B){function H(Z){try{se(O.next(Z))}catch(oe){B(oe)}}function ne(Z){try{se(O.throw(Z))}catch(oe){B(oe)}}function se(Z){var oe;Z.done?L(Z.value):(oe=Z.value,oe instanceof A?oe:new A(function(de){de(oe)})).then(H,ne)}se((O=O.apply(N,[])).next())})},go,Wu,Ll,ms;(function(N){N.SDP_EXCHANGE="xdp",N.JITTER_BUFFER_MIN_DELAY_MS="jit_buf_min_delay_ms"})(go||(go={})),function(N){N.USER_INITIATED="user-initiated",N.CLIENT_RECONNECT="reconnect",N.TOKEN_REUSED="token-reused",N.UNKNOWN="unknown",N.PARTICIPANT_DISCONNECTED="participant-disconnected",N.STAGE_DELETED="stage-deleted"}(Wu||(Wu={})),function(N){N[N.NOT_CONNECTED=0]="NOT_CONNECTED",N[N.CONNECTION_LOST=1]="CONNECTION_LOST",N[N.TIMEDOUT=2]="TIMEDOUT",N[N.ABORTED=3]="ABORTED",N[N.INVALID_MESSAGE=4]="INVALID_MESSAGE",N[N.UNEXPECTED_ERROR=5]="UNEXPECTED_ERROR"}(Ll||(Ll={})),function(N){N.DISCONNECTED="disconnected",N.CONNECTING="connecting",N.CONNECTED="connected",N.ERRORED="errored"}(ms||(ms={}));class fS extends cl{constructor(T,A,O){super(),this.token=T,this.nonScopedLogger=A,this.analyticsTracker=O,this.participants=new Map,this.disconnected=[],this.state={value:ms.DISCONNECTED,context:{connectStartTime:0,hasConnected:!1}},this.features={sdpExchange:!1},this.stats=this.resetStats(),this.stageMinutesLogged=0,this.isStagePublishing=!1,this.onConnecting=(L,B)=>{this.logger.debug({msg:"onConnecting",context:L,event:B}),L.connectStartTime=performance.now();const H=B.type==="RECONNECT";H&&this.stageSocket.close();const{eventsURL:ne}=this.token;this.emit(kl,ms.CONNECTING),this.state.value=ms.CONNECTING;const se=!H;this.stageSocket.connect(ne,this.traceId,se)},this.onConnected=(L,B)=>{this.logger.debug({msg:"onConnected",context:L,event:B}),L.hasConnected=!0,this.emit(Xm),this.emit(kl,ms.CONNECTED),this.state.value=ms.CONNECTED},this.onDisconnected=(L,B)=>{this.logger.debug({msg:"onDisconnected",context:L}),this.state.value=ms.DISCONNECTED,this.stopStageMinuteLoggedInterval(!0),this.stageSocket.close(),L.hasConnected=!1,this.participants=new Map,this.disconnected=[],this.stageSocket.removeAllListeners(),this.resetStats(),this.emit(kl,ms.DISCONNECTED,B)},this.onErrored=(L,B)=>{this.logger.error({msg:"Connection failure occurred",err:B.payload.error}),this.emit(kl,ms.ERRORED),this.emit(Gp,B.payload.error),this.state.value=ms.ERRORED,L.hasConnected?this.processStateUpdate({type:"RECONNECT"}):this.stageSocket.close()},this.processStateUpdate=L=>{const B=this.state.value,H=this.state.context;switch(B){case ms.DISCONNECTED:L.type==="CONNECT"&&this.onConnecting(H,L);break;case ms.CONNECTING:L.type==="RECONNECT"?this.onConnecting(H,L):L.type==="DISCONNECT"?this.onDisconnected(H,L.reason):L.type==="CONNECT_SUCCESS"?this.onConnected(H,L):L.type==="ERROR"&&this.onErrored(H,L);break;case ms.CONNECTED:L.type==="RECONNECT"?this.onConnecting(H,L):L.type==="DISCONNECT"?this.onDisconnected(H,L.reason):L.type==="ERROR"&&this.onErrored(H,L);break;case ms.ERRORED:L.type==="RECONNECT"?this.onConnecting(H,L):L.type==="DISCONNECT"&&this.onDisconnected(H,L.reason)}},this.measureConnect=(L,B)=>{const H=this.stats.edpConnectCount,ne=H+1,se=performance.now(),Z=se-B;return Object.assign(this.stats,{edpConnectCount:ne,edpConnectDuration:Z}),H===0&&Object.assign(this.stats,{edpInitialStartConnectTime:B,edpInitialFinishConnectTime:se,edpInitialConnectDuration:Z,edpInitialConnectRetries:L}),this.stats},this.measureStateUpdate=L=>{const{edpInitialFinishConnectTime:B}=this.stats,H=this.stats.edpStateUpdateCount,ne=H+1;return Object.assign(this.stats,{edpStateUpdateCount:ne}),H===0&&Object.assign(this.stats,{edpInitialStateDuration:performance.now()-B,edpInitialStatePublishingCount:L}),this.stats},this.trackMessageParseError=L=>{this.logger.error({msg:"Message Parse Error occurred",err:L.err});const B=new ki({token:L.token,traceId:L.traceId,code:Ut.WEBSOCKET_MESSAGE_PARSE_FAILURE.code,tag:L.tag,location:L.location,message:L.message,details:L.err.message});this.analyticsTracker.trackEvent(new Il(B))},this.trackStageSocketMessageParseError=(L,B,H)=>{this.trackMessageParseError({token:L,traceId:B,tag:Cc.JOIN_RELATED,location:"StageConnection.onMessage",message:Ut.WEBSOCKET_MESSAGE_PARSE_FAILURE.message,err:H})},this.trackStageStateMessageParseError=(L,B,H,ne)=>{this.trackMessageParseError({token:L,traceId:B,tag:Cc.JOIN_RELATED,location:"StageConnection.onStageStateMessage",message:ne,err:H})},this.onDisconnectMessage=L=>{this.analyticsTracker.trackEventNoSharedProps(new Qm(this.token,this.traceId,`DISCONNECT message received: ${L.code}:${L.reason}`,dn.JOIN));let B=Wu.UNKNOWN;if(L.code==="PARTICIPANT_DISCONNECTED")B=Wu.PARTICIPANT_DISCONNECTED;else if(L.code==="STAGE_DELETED")B=Wu.STAGE_DELETED;else if(L.code==="TOKEN_REUSED"&&(B=Wu.TOKEN_REUSED,xh("disableTokenReuseMessage")))return void console.warn("Token reuse is detected, but skipping as feature is disabled");console.warn(`Disconnecting client due to: ${L.reason}`),this.processStateUpdate({type:"DISCONNECT",reason:B})},this.onReassignmentMessage=L=>{this.emit(tu,L)},this.onIncompatibleCodecsMessage=L=>{this.emit(Nf,L)},this.onStageStateMessage=(L,B,H)=>{var ne,se;this.logger.debug({msg:"State Stage Message occurred",state:H});const Z=H.payload,oe=(ne=Z.participants)!==null&&ne!==void 0?ne:[],de=(se=Z.disconnected)!==null&&se!==void 0?se:[],me=[],Pe=[];this.measureStateUpdate(oe.length),this.enableFeaturesBasedOnServerFeatures(Z.serverFeatures||[]);const Xe=(qe,Ie)=>{this.analyticsTracker.trackEventNoSharedProps(new lv({token:L,otherParticipantId:qe.id,otherParticipantUserId:qe.userId,isAudioMuted:qe.audioMuted,isVideoStopped:qe.videoStopped,isPublishing:qe.isPublishing,isDisconnected:Ie,traceId:B}))};this.participants.forEach(qe=>{const Ie=oe.find(xe=>xe.id===qe.id);if(Ie){let xe=!0,lt=!1;["isPublishing","id","audioMuted","joinedAt","userId","videoStopped"].forEach(At=>{xe=xe&&Ie[At.toString()]===qe[At.toString()],xe||(qe[At.toString()]=Ie[At.toString()],lt=!0)}),Object.keys(qe.attributes).forEach(At=>{xe=xe&&Ie.attributes[At]===qe.attributes[At],xe||(qe.attributes=Ie.attributes,lt=!0)}),lt&&(Xe(qe,!1),this.emit(W0,Ie))}else Pe.push(qe)}),oe.forEach(qe=>{this.participants.get(qe.id)||me.push(qe)}),Pe.forEach(qe=>{this.participants.delete(qe.id),Xe(qe,!0),this.emit(Md,qe)}),me.forEach(qe=>{this.participants.set(qe.id,qe),Xe(qe,!1),this.emit(Of,qe)}),de.forEach(qe=>{this.disconnected.find(Ie=>Ie.id===qe.id)||(this.disconnected.push(qe),qe.status==="KICKED"&&this.emit(ya,qe))}),this.disconnected=de},this.nonScopedLogger=A,this.logger=new fo(A,fe.CONNECTION),this.stageSocket=new NR(T,this.nonScopedLogger,O),this.token=T,this.traceId=wc()}resetStats(){return this.stats={isConnected:!1,edpInitialStartConnectTime:0,edpInitialFinishConnectTime:0,edpConnectCount:0,edpInitialConnectDuration:0,edpConnectDuration:0,edpInitialStateDuration:0,edpInitialStatePublishingCount:0,edpStateUpdateCount:0,edpInitialConnectRetries:0},this.stats}connect(T){return ic(this,void 0,void 0,function*(){return this.logger.debug({msg:"connect invoked",token:this.token,traceId:T}),this.traceId=T,this.state.value!==ms.DISCONNECTED&&(this.logger.debug({msg:"Disconnecting previous connection"}),this.processStateUpdate({type:"DISCONNECT",reason:Wu.CLIENT_RECONNECT})),new Promise((A,O)=>{this.stageSocket.on(ll,L=>{var B,H;const{retryCnt:ne,initialStageState:se}=L;se&&this.enableFeaturesBasedOnServerFeatures((H=(B=se.payload)===null||B===void 0?void 0:B.serverFeatures)!==null&&H!==void 0?H:[]),this.traceId=L.traceId||wc(),this.measureConnect(ne,this.state.context.connectStartTime),this.processStateUpdate({type:"CONNECT_SUCCESS"}),this.startStageMinuteLoggedInterval(this.token,this.traceId),A(this.traceId)}),this.stageSocket.on(nu,L=>{O(L),this.processStateUpdate({type:"ERROR",payload:{error:L}})}),this.stageSocket.on(cy,()=>{this.logger.debug({msg:"Refresh event occurred"}),this.emit(bx),this.processStateUpdate({type:"RECONNECT"})}),this.stageSocket.on(ly,L=>this.onStageStateMessage(this.token,this.traceId,L)),this.stageSocket.on(Rc,L=>this.trackStageSocketMessageParseError(this.token,this.traceId,L)),this.stageSocket.on(K0,this.onDisconnectMessage),this.stageSocket.on(If,this.onReassignmentMessage),this.stageSocket.on(Do,this.onIncompatibleCodecsMessage),this.stageSocket.on(Bu,L=>{this.stopStageMinuteLoggedInterval()}),this.processStateUpdate({type:"CONNECT",payload:{token:this.token,traceId:T}})})})}disconnect(){return this.logger.debug({msg:"disconnect invoked"}),this.processStateUpdate({type:"DISCONNECT",reason:Wu.USER_INITIATED}),this.traceId}getParticipant(T){return this.participants.get(T)}listConnectedParticipants(){const T=[];return this.participants.forEach(A=>{A.subscribed&&T.push(A)}),T}listAvailableParticipants(){return Array.from(this.participants.values())}emitStageState(T,A){this.stageSocket.send({audioMuted:T,type:"SET_STATE",version:"0",videoStopped:A})}setStagePublishing(T){this.isStagePublishing=T,this.emit(Ac,this.isStagePublishing)}getIsStagePublishing(){return this.isStagePublishing}startStageMinuteLoggedInterval(T,A){this.uploadStageMinutesBroadcastInterval||(this.analyticsTracker.trackEvent(new Nc(T,A,this.stageMinutesLogged,this.isStagePublishing,0)),this.stageMinutesLogged++,this.uploadStageMinutesBroadcastInterval=setInterval(()=>{this.analyticsTracker.trackEvent(new Nc(T,A??wc(),this.stageMinutesLogged,this.isStagePublishing,0)),this.stageMinutesLogged++},6e4))}stopStageMinuteLoggedInterval(T=!1){this.uploadStageMinutesBroadcastInterval&&(clearInterval(this.uploadStageMinutesBroadcastInterval),this.uploadStageMinutesBroadcastInterval=void 0),T&&(this.stageMinutesLogged=0)}enableFeaturesBasedOnServerFeatures(T){const A=(H,ne)=>{this.trackStageStateMessageParseError(this.token,this.traceId,ne,`Could not parse "${H}" from the Eevee server features list`)},O=T.includes(go.SDP_EXCHANGE);this.features.sdpExchange!==O&&(this.logger.debug({msg:`XDP SDP exchange feature toggled: ${O}`}),this.features.sdpExchange=O);const L=T.find(H=>H.indexOf(go.JITTER_BUFFER_MIN_DELAY_MS)!==-1),B=H=>{this.logger.debug({msg:`jitterBufferMinDelay feature updated to: ${H}`}),this.features.jitterBufferMinDelayInMs=H};if(L!==void 0)try{const H=L.split("=")[1],ne=parseInt(H,10);if(isNaN(ne))throw new Error("Unable to parse - result is NaN");if(ne<0)throw new Error("Unable to apply - result is negative");this.features.jitterBufferMinDelayInMs!==void 0&&this.features.jitterBufferMinDelayInMs===ne||B(ne)}catch(H){A(L,H),B(void 0)}else B(void 0)}isConnected(){return this.state.value===ms.CONNECTED}supportsSdpExchange(){return this.features.sdpExchange}jitterBufferMinDelayInMs(){return this.features.jitterBufferMinDelayInMs}getConnectionStats(){return Object.assign({},this.stats,{isConnected:this.isConnected()})}exchangeSdp(T,A,O,L,B,H,ne,se,Z){return ic(this,void 0,void 0,function*(){return this.isConnected()?new Promise((oe,de)=>{const me=window.setTimeout(()=>{Pe(),de(Ll.TIMEDOUT)},8e3),Pe=()=>{window.clearTimeout(me),this.stageSocket.off(Y0,Xe),this.stageSocket.off(nu,qe)},Xe=Ie=>{Ie.requestId===L&&(Pe(),oe(Ie))},qe=()=>{Pe(),de(Ll.CONNECTION_LOST)};B==null||B.addEventListener("abort",()=>{Pe(),de(Ll.ABORTED)}),this.stageSocket.on(Y0,Xe),this.stageSocket.on(nu,qe),this.stageSocket.sendSdpOffer(T,A,O,L,H,ne,se,Z)}):Promise.reject(Ll.NOT_CONNECTED)})}}class Yu{constructor(T){this.token=T}}var pS=function(N,T,A,O){return new(A||(A=Promise))(function(L,B){function H(Z){try{se(O.next(Z))}catch(oe){B(oe)}}function ne(Z){try{se(O.throw(Z))}catch(oe){B(oe)}}function se(Z){var oe;Z.done?L(Z.value):(oe=Z.value,oe instanceof A?oe:new A(function(de){de(oe)})).then(H,ne)}se((O=O.apply(N,[])).next())})};const vy={[Ll.ABORTED]:Ut.OPERATION_ABORTED,[Ll.NOT_CONNECTED]:Ut.EVENT_PLANE_WS_UNEXPECTED_CLOSE,[Ll.CONNECTION_LOST]:Ut.XDP_CONNECTION_LOST,[Ll.TIMEDOUT]:Ut.XDP_TIMEOUT,[Ll.INVALID_MESSAGE]:Ut.XDP_INVALID_ANSWER_MSG,[Ll.UNEXPECTED_ERROR]:Ut.XDP_UNEXPECTED_ERROR};class mS extends Yu{constructor(T,A,O,L){super(T),this.token=T,this.stageConnection=A,this.contextData=O,this.analyticsTracker=L}exchange(T){return pS(this,void 0,void 0,function*(){const A=Na(),{action:O}=this.contextData,{sdpOffer:L,url:B,traceId:H,forceNode:ne,assignmentToken:se,multiCodec:Z,abortController:oe,initialLayerPreference:de}=T;let me;this.trackAttempt(B,A,H);try{me=yield this.stageConnection.exchangeSdp(L,B,H.value,A.value,oe==null?void 0:oe.signal,ne,se,Z,de)}catch(Jt){if(typeof Jt=="number")throw this.createClientSideErrorFromReasonCode(Jt,H,A,O)}if(!me)return;const{httpStatusCode:Pe,errorCode:Xe,location:qe,content:Ie,sessionDeleteLink:xe,subscriberControlLink:lt,videoLayersLink:At}=me;if(Pe>=200&&Pe<300)return{sdpAnswer:Ie,url:B,location:qe,sessionDeleteLink:xe,mediaControls:lt,layerControls:At};throw this.createServerSideError(H,A,Pe,Xe,O)})}trackAttempt(T,A,O){const{remoteParticipantId:L,action:B}=this.contextData;this.analyticsTracker.trackEventNoSharedProps(new Id(B,this.token,T,"POST",A.value,L,O,"xdp"))}createServerSideError(T,A,O,L,B){const H=this.baseErrorProps(T,A);let ne=$0(O,L);return ne||(ne=Ut.UNKNOWN_SERVER_ERROR),new ki(Object.assign(Object.assign({action:B},H),ne))}baseErrorProps(T,A){const{remoteParticipantId:O,action:L}=this.contextData;return{token:this.token,traceId:T,tag:ko(L,O),location:"EdpSdpExchanger.exchange",requestUUID:A,remoteParticipantId:O}}createClientSideErrorFromReasonCode(T,A,O,L){const B=this.baseErrorProps(A,O),H=vy[T];return new ki(H?Object.assign(Object.assign({action:L},B),H):Object.assign(Object.assign({action:L},B),Ut.XDP_INVALID_ANSWER_MSG))}getTransport(){return"sdp"}}const Dd=new RegExp("^(?:[a-z+]+:)?//","i");function Ul(N){return Dd.test(N)}var ui=function(N,T,A,O){return new(A||(A=Promise))(function(L,B){function H(Z){try{se(O.next(Z))}catch(oe){B(oe)}}function ne(Z){try{se(O.throw(Z))}catch(oe){B(oe)}}function se(Z){var oe;Z.done?L(Z.value):(oe=Z.value,oe instanceof A?oe:new A(function(de){de(oe)})).then(H,ne)}se((O=O.apply(N,[])).next())})};class _y extends Yu{constructor(T,A,O){super(T),this.contextData=A,this.analyticsTracker=O}exchange(T){return ui(this,void 0,void 0,function*(){const A=Na(),{token:O}=this,{action:L,remoteParticipantId:B}=this.contextData,{sdpOffer:H,url:ne,traceId:se,forceNode:Z,assignmentToken:oe,multiCodec:de,abortController:me,initialLayerPreference:Pe}=T;try{const qe="POST",Ie="http";this.analyticsTracker.trackEventNoSharedProps(new Id(L,O,ne,qe,A.value,B,se,Ie));const xe={data:H,headers:{Authorization:`Bearer ${O.rawToken}`,"Content-Type":"application/sdp","X-Stages-Platform":"web","X-Stages-Request-ID":A.value,"X-Stages-SDK":"1.19.0","X-Stages-Session-ID":this.analyticsTracker.getSessionId(),"X-Stages-Trace-ID":se.value,"X-Stages-WHIP-Version":Mc,"X-Stages-Options":(Xe=JSON.stringify({cap:["sau"]}),btoa(Xe).replace(/[^A-Za-z0-9+/]/g,""))},method:qe,responseType:"text",url:ne,signal:me==null?void 0:me.signal,params:{}};Z&&(xe.params.force_node=Z),oe&&(xe.params.assignment_token=oe),de&&(xe.params.multi_codec=!0);const lt=D0()===void 0,At=D0()||lt;Pe&&xe.headers&&At&&(xe.headers["X-Stages-Initial-Layer-Pref"]=my(Pe));const{data:Jt,headers:Nt,request:Qn}=yield Pl(xe),On=this.parseWhipResource(ne,Nt.location,Nt.link);return{url:Qn.responseURL,sdpAnswer:Jt,location:On==null?void 0:On.location,sessionDeleteLink:On==null?void 0:On.sessionDeleteLink,mediaControls:On==null?void 0:On.mediaControls,layerControls:On==null?void 0:On.layerControls}}catch(qe){if(na().isCancel(qe))throw new ki(Object.assign(Object.assign({},Vp(Ut.OPERATION_ABORTED,qe)),{action:L,token:O,traceId:se,tag:ko(L,B),location:"StagePeerClient.start",requestUUID:A,remoteParticipantId:B}));const Ie=function(xe,lt){var At;return xe instanceof Ms.AxiosError&&xe.response&&typeof xe.response.status=="number"?xe instanceof Ms.AxiosError&&xe.code==="ERR_NETWORK"?Ut.NETWORK_FAILURE:$0(Number(xe.response.status),(At=xe.response.data)===null||At===void 0?void 0:At.code)||lt:lt}(qe,Ut.WHIP_POST_FAILURE);throw new ki(Object.assign(Object.assign({},Vp(Ie,qe)),{action:L,token:O,traceId:se,tag:ko(L,B),location:"StagePeerClient.start",requestUUID:A,remoteParticipantId:B}))}var Xe})}parseWhipResource(T,A,O){const L=new URL(T);let B;return B=function(H,ne,se){if(!se)return H;if(H||(H={}),Ul(se))return H.location=se,H;const Z=ne.port?`:${ne.port}`:"";return H.location=`${ne.protocol}//${ne.hostname}${Z}${se}`,H}(B,L,A),B=function(H,ne,se){if(!se)return H;H||(H={});const Z=H;return se.split(",").forEach(oe=>{const de=/<(.+)>;\s?rel="([a-z:-]+)"/.exec(oe);if((de==null?void 0:de.length)!==3)return;let me;if(Ul(de[1]))me=de[1];else{const Pe=ne.port?`:${ne.port}`:"";me=`${ne.protocol}//${ne.hostname}${Pe}${de[1]}`}switch(de[2]){case"urn:ietf:params:whip:ivs-stages:session-delete":Z.sessionDeleteLink=me;break;case"urn:ietf:params:whep:core:playback-controls":Z.mediaControls=me;break;case"urn:ietf:params:whep:ext:core:layer":Z.layerControls=me;break;default:return}}),Z}(B,L,O),B}getTransport(){return"http"}}var ii=r(1564);function Bl(N){return N.track.kind===ju.AUDIO}function dv(N){return N.track.kind===ju.VIDEO&&typeof N.config=="object"}const gS=(N,T)=>function(A){return A.kind===ju.AUDIO}(N)?((A,O)=>{var L;const B={maxBitrateBps:mo((L=O==null?void 0:O.maxAudioBitrateKbps)!==null&&L!==void 0?L:64)},H=O==null?void 0:O.stereo;return typeof H=="boolean"&&(B.stereo=H),{track:A,config:B}})(N,T):((A,O)=>{var L,B,H,ne;const se=(L=O==null?void 0:O.minBitrate)!==null&&L!==void 0?L:eg,Z=(B=O==null?void 0:O.maxBitrate)!==null&&B!==void 0?B:tg,oe=(H=O==null?void 0:O.maxFramerate)!==null&&H!==void 0?H:Oc,de=!!(!((ne=O==null?void 0:O.simulcast)===null||ne===void 0)&&ne.enabled);return{track:A,config:{minBitrateBps:mo(se),maxBitrateBps:mo(Z),maxFramerate:oe,simulcastEnabled:de,inBandMessagingEnabled:!1}}})(N,T),Ka=(N,T)=>{if(typeof N=="number")return N;const A=T?ev:Ex;return A[N]!==void 0?A[N]:0};function Qp(N){if(N<eg||N>tg)throw new Error(`Stage bitrate must be between ${eg} kbps and ${tg} kbps`)}function Rx(N,T){const A=aS();let O=Object.assign({},A,(0,_a.cloneDeep)(T));return O=function(L,B){var H,ne,se;const Z=Object.assign({},(0,_a.cloneDeep)(B)),oe=!ps.browser.isChrome()&&!ps.browser.isEdge(),de=(se=(ne=(H=L.getSettings)===null||H===void 0?void 0:H.call(L))===null||ne===void 0?void 0:ne.displaySurface)!==null&&se!==void 0&&se,me=mo(Z.maxBitrate)<rg.maxBitrate;return(oe||de||me)&&(Z.simulcast.enabled=!1),Z}(N,O),Qp(O.maxBitrate),Qp(O.minBitrate),function(L){if(L&&(L>Oc||L<hy))throw new Error(`framerate cannot exceed ${Oc} fps`)}(O.maxFramerate),function(L){if(L<Q0||L>lr)throw new Error(`Stage audio bitrate must be between ${Q0} kbps and ${lr} kbps`)}(O.maxAudioBitrateKbps),function(L){if(typeof L!="boolean")throw new Error("Stage stereo prop must be a boolean")}(O.stereo),O}function vS({stageErrorValue:N,action:T,token:A,traceId:O,tag:L,identifier:B,details:H}){return new ki(Object.assign(Object.assign({},N),{token:A,traceId:O,location:"peer-client",tag:L,action:T,remoteParticipantId:B,details:H}))}var Us;function rc(N){var T;return!((T=N==null?void 0:N.sender)===null||T===void 0)&&T.createEncodedStreams?Us.INSERTABLE_STREAMS:window.RTCRtpSender&&"transform"in RTCRtpSender.prototype&&window.RTCRtpScriptTransform?Us.ENCODED_TRANSFORMS:Us.NONE}function yy(N){var T;return!((T=N==null?void 0:N.receiver)===null||T===void 0)&&T.createEncodedStreams?Us.INSERTABLE_STREAMS:window.RTCRtpReceiver&&"transform"in RTCRtpReceiver.prototype&&window.RTCRtpScriptTransform?Us.ENCODED_TRANSFORMS:Us.NONE}function _S(N){let T=[];const A=new Map;function O(L){const B="0123456789abcdef";let H="";for(let ne=0;ne<L;ne+=1)H+=B.charAt(Math.floor(Math.random()*B.length));return H}return{add(L){const B=O,H=`${B(8)}-${B(4)}-${B(4)}-${B(4)}-${B(12)}`,ne=Date.now();return T.push({id:H,enqueuedAt:ne,payload:L}),H},poll(L){return A.has(L)||A.set(L,[]),A.size>=N&&(A.forEach(B=>{B.push(...T)}),T=[]),(A.get(L)||[]).splice(0,1)}}}function IR(N,T){return T.type==="sei"?function(A,O){const ne=new Uint8Array([1,2,1,8,1,2,3,4,2,2,2,4,4,3,2,1]);function se(de,me,Pe){return Pe+me.length<=de.byteLength&&me.every((Xe,qe)=>de.getUint8(Pe+qe)===Xe)}function Z(de,me){const Pe=function(qe,Ie){return new Uint8Array([0,0,1,6,5,...Ie,...qe])}(de,function(qe){const Ie=[];for(;qe>=255;)Ie.push(255),qe-=255;return Ie.push(qe),new Uint8Array(Ie)}(me.length+de.length)),Xe=function(qe){const Ie=[...qe];let xe=3;for(;xe<Ie.length-2;)Ie[xe]!==0||Ie[xe+1]!==0||Ie[xe+2]!==0&&Ie[xe+2]!==1&&Ie[xe+2]!==2&&Ie[xe+2]!==3?xe+=1:(Ie.splice(xe+2,0,3),xe+=3);return Ie}(new Uint8Array([...Pe,...me,128]));return new Uint8Array(Xe)}function oe(de,me){const Pe=function(Xe){const qe=new DataView(Xe);for(let Ie=0;Ie<qe.byteLength-4;Ie++)if(se(qe,[0,0,1],Ie)){const xe=31&qe.getUint8(Ie+3);if(xe>=1&&xe<=5)return Ie}return-1}(A.data);if(Pe>=0){const Xe=new ArrayBuffer(A.data.byteLength+me.byteLength),qe=new Uint8Array(Xe);return qe.set(new Uint8Array(A.data.slice(0,Pe)),0),qe.set(me,Pe),qe.set(new Uint8Array(A.data.slice(Pe)),Pe+me.byteLength),Xe}return de}return function(){for(let de=0;de<O.length;de+=1){const me=Z(ne,new Uint8Array(O[de]));A.data=oe(A.data,me)}return A}()}(N,T.payloads||[]):N}function fv(N,T){const{type:A,transformerId:O}=T;if(A==="sei"){const L=function(ne){function oe(Pe,Xe,qe){return qe+Xe.length<Pe.byteLength&&Xe.every((Ie,xe)=>Pe.getUint8(qe+xe)===Ie)}function de(Pe){const Xe=[];let qe=0;for(;qe<Pe.length;)Pe[qe]===0&&Pe[qe+1]===0&&Pe[qe+2]===3?(Xe.push(Pe[qe]),Xe.push(Pe[qe+1]),qe+=3):(Xe.push(Pe[qe]),qe+=1);return new Uint8Array(Xe)}function me(Pe){let Xe=2;const qe=Pe.byteLength;for(;Xe<qe;){let Ie=0;for(;Xe<qe&&Pe[Xe]===255;)Ie+=255,Xe++;Ie+=Pe[Xe],Xe++;const xe=Math.min(Xe+Ie,qe),lt=new Uint8Array(Pe.slice(Xe,xe));return{uuid:lt.slice(0,16),payload:lt.slice(16)}}}return{messages:function(Pe){const Xe=new DataView(Pe.data),qe=[];let Ie=0;if(!oe(Xe,[0,0,1],0)&&!oe(Xe,[0,0,0,1],0))return[];for(;Ie<Xe.byteLength-5;)if(oe(Xe,[0,0,1],Ie)){const xe=Ie+3;Ie=xe;const lt=31&Xe.getUint8(Ie),At=31&Xe.getUint8(Ie+1);if(lt===6&&At===5){for(;Ie<Xe.byteLength&&!oe(Xe,[0,0,1],Ie);)Ie++;const Jt=Ie,Nt=me(de(new Uint8Array(Pe.data.slice(xe,Jt))));Nt&&qe.push(Object.assign(Object.assign({},Nt),{timestamp:Pe.timestamp,type:Pe.type}))}else Ie++}else Ie++;return qe}(ne),frame:ne}}(N),{frame:B,messages:H}=L;return{success:!0,frame:B,type:A,transformerId:O,seiResult:H}}return{success:!0,frame:N,transformerId:O,type:A}}function Mx(){let N;const T=L=>(B,H)=>{const ne=B.getMetadata().synchronizationSource,se=(N?N.poll(ne):[]).map(Z=>Z.payload);H.enqueue("<SEND_TRANSFORMER_IMPL>"(B,Object.assign(Object.assign({},L),{payloads:se})))},A=L=>(B,H)=>{try{const ne="<RECEIVE_TRANSFORMER_IMPL>"(B,L);H.enqueue(ne.frame),self.postMessage(Object.assign(Object.assign({success:ne.success},L),{seiResult:ne.seiResult}))}catch{self.postMessage(Object.assign({success:!1},L))}};function O(L,B,H,ne){const se=new TransformStream({transform:L==="video/send"?T(B):A(B)});H.pipeThrough(se).pipeTo(ne)}return self.onrtctransform=L=>{const B=L.transformer;B&&O(B.options.method,B.options,B.readable,B.writable)},self.onmessage=L=>{var B;const{operation:H,transformerId:ne}=L.data;H==="insert"?(N||(N="<CREATE_MESSAGE_QUEUE>"(1)),N.add((B=L.data)===null||B===void 0?void 0:B.payload)):H!=="video/receive"&&H!=="video/send"||O(H,{method:H,transformerId:ne,type:"sei"},L.data.readable,L.data.writable)},{videoReceiveTransform:A,videoSendTransform:T}}(function(N){N.NONE="none",N.ENCODED_TRANSFORMS="encodedTransforms",N.INSERTABLE_STREAMS="insertableStreams"})(Us||(Us={}));const Ox=()=>{let N=Mx.toString();return N=N.replace('"<SEND_TRANSFORMER_IMPL>"',IR.toString()),N=N.replace('"<RECEIVE_TRANSFORMER_IMPL>"',fv.toString()),N=N.replace('"<CREATE_MESSAGE_QUEUE>"',_S.toString()),N},cg=(()=>{let N;return{getWorker:()=>(N||(N=function(){const T=new Blob([`(${Ox()})()`],{type:"text/javascript"}),A=URL.createObjectURL(T);return new Worker(A)}()),N),destroy:()=>{N&&N.terminate(),N=void 0}}})(),yS="seiMessageReceived",pv="error";var hl;(function(N){N.CREATED="created",N.INITIALIZED="initialized",N.DESTROYED="destroyed"})(hl||(hl={}));class lg extends cl{constructor({enabled:T}){super(),this.state=hl.CREATED,this.transformerId=Na().value,this.prevResultWasError=!1,this.consecutiveErrorResults=0,this.seiReadCnt=0,this.seiBytesRead=0,this.onMessage=A=>{this.onTransformResult(A.data)},T||this.destroy()}initializeInsertableStreams(T){var A;this.worker=cg.getWorker();const O=T.receiver.createEncodedStreams(),{readable:L,writable:B}=O;(A=this.worker)===null||A===void 0||A.postMessage({operation:"video/receive",transformerId:this.transformerId,readable:L,writable:B},[L,B]),this.worker.addEventListener("message",this.onMessage)}initializeEncodedTransforms(T){this.worker=cg.getWorker();const A={method:"video/receive",type:"sei",transformerId:this.transformerId};T.receiver.transform=new RTCRtpScriptTransform(this.worker,A),this.worker.addEventListener("message",this.onMessage)}initialize(T,A){if(this.state!==hl.CREATED)return!1;const O=yy(T);if(O===Us.NONE)return!1;if(A&&O===Us.INSERTABLE_STREAMS)this.initializeInsertableStreams(T);else{if(A||O!==Us.ENCODED_TRANSFORMS)return!1;this.initializeEncodedTransforms(T)}return this.transceiver=T,this.state=hl.INITIALIZED,!0}onTransceiverAdd(T){return this.initialize(T,!0)}onTrackEvent(T){return T.track.kind==="video"&&this.initialize(T.transceiver,!1)}static isSupported(T){return yy(T)!==Us.NONE}onTransformResult(T){return T.transformerId===this.transformerId&&(T.success?(this.prevResultWasError=!1,this.consecutiveErrorResults=0,!!T.seiResult&&(T.seiResult.forEach(A=>{const{payload:O,uuid:L}=A;this.updateReadStats(A),this.emit(yS,{uuid:L,payload:O})}),T.seiResult.length>0)):(this.prevResultWasError&&this.consecutiveErrorResults++,this.consecutiveErrorResults>=300&&this.onError(T,Ut.TRANSFORM_TOO_MANY_ERRORS),this.prevResultWasError=!0,this.onError(T,Ut.TRANSFORM_UNEXPECTED_ERROR),!1))}updateReadStats(T){this.seiReadCnt++,this.seiBytesRead+=T.payload.byteLength}getReceiverStats(){const{seiBytesRead:T,seiReadCnt:A}=this;return{seiReadCnt:A,seiBytesRead:T}}onError(T,A){const{type:O}=T;this.emit(pv,{type:O,stageErrorValue:A})}destroy(){var T,A;this.state!==hl.DESTROYED&&(this.removeAllListeners(),(T=this.worker)===null||T===void 0||T.removeEventListener("message",this.onMessage),!((A=this.transceiver)===null||A===void 0)&&A.receiver&&(this.transceiver.receiver.transform=null),this.state=hl.DESTROYED)}getState(){return this.state}}class by{constructor({enabled:T}){this.state=hl.CREATED,this.transformerId=Na().value,T||this.destroy()}initializeInsertableStreams(T,A){var O;this.worker=cg.getWorker();const L=T.sender.createEncodedStreams(),{readable:B,writable:H}=L;(O=this.worker)===null||O===void 0||O.postMessage({operation:"video/send",transformerId:this.transformerId,readable:B,writable:H},[B,H])}initializeEncodedTransforms(T,A){this.worker=cg.getWorker();const O={method:"video/send",type:"sei",transformerId:this.transformerId,encodingLayers:A};T.sender.transform=new RTCRtpScriptTransform(this.worker,O)}initialize(T){var A;if(this.state!==hl.CREATED)return!1;const O=rc(T);if(O===Us.NONE)return!1;const L=T.sender.getParameters(),B=((A=L==null?void 0:L.encodings)===null||A===void 0?void 0:A.length)||1;if(O===Us.INSERTABLE_STREAMS)this.initializeInsertableStreams(T,B);else{if(O!==Us.ENCODED_TRANSFORMS)return!1;this.initializeEncodedTransforms(T,B)}return this.transceiver=T,this.state=hl.INITIALIZED,!0}static isSupported(T){return rc(T)!==Us.NONE}sendSeiMessage(T){var A;this.state===hl.INITIALIZED&&this.transceiver&&((A=this.worker)===null||A===void 0||A.postMessage({operation:"insert",transformerId:this.transformerId,payload:T}))}onTransceiverAdd(T){return this.initialize(T)}onTrackEvent(T){return!1}destroy(){var T;this.state!==hl.DESTROYED&&(!((T=this.transceiver)===null||T===void 0)&&T.receiver&&(this.transceiver.receiver.transform=null),this.state=hl.DESTROYED)}getState(){return this.state}}var Xa=function(N,T,A,O){return new(A||(A=Promise))(function(L,B){function H(Z){try{se(O.next(Z))}catch(oe){B(oe)}}function ne(Z){try{se(O.throw(Z))}catch(oe){B(oe)}}function se(Z){var oe;Z.done?L(Z.value):(oe=Z.value,oe instanceof A?oe:new A(function(de){de(oe)})).then(H,ne)}se((O=O.apply(N,[])).next())})};let ug=null;class mv extends cl{constructor(T,A,O,L,B,H,ne,se,Z){var oe,de;if(super(),this.analyticsTracker=H,this.sfuResource={node:"",cluster:""},this.stageCapabilities={simulcastNegotiated:!1},this.incompatibleCodecs=new Set,this.connect=({audioOnly:me=!1,traceId:Pe,iceRestartOptions:Xe})=>Xa(this,void 0,void 0,function*(){const{token:qe,tag:Ie,identifier:xe,action:lt}=this,At=!!Xe,Jt=new AbortController;let Nt,Qn,On;this.abortController=Jt,this.traceId=Pe,this.perfTracker.resetMeasurements(Pe);const Ei=()=>{Nt&&this.off(Ad,Nt),Qn&&this.off(ta,Qn)},Fi=new Promise((Pi,Ai)=>{const Si=function({action:Ti,token:Ni,traceId:hi,tag:An,identifier:Kn}){const Wi=Ti===dn.SUBSCRIBE?Ut.SUBSCRIBE_TIMED_OUT:Ut.PUBLISH_TIMED_OUT;return new ki(Object.assign(Object.assign({},Wi),{action:Ti,token:Ni,traceId:hi,tag:An,location:"connect",remoteParticipantId:Kn}))}({action:lt,token:qe,traceId:Pe,tag:Ie,identifier:xe}),Oi=function({action:Ti,token:Ni,traceId:hi,tag:An}){const Kn=Ut.OPERATION_ABORTED;return new ki(Object.assign(Object.assign({},Kn),{token:Ni,traceId:hi,location:"peer-client.connect",tag:An,action:Ti}))}({action:lt,token:qe,traceId:Pe,tag:Ie}),Di=setTimeout(()=>{this.stop(),this.analyticsTracker.trackError(Si),Ai(Si)},1e4);Nt=Ti=>{clearTimeout(Di),At||this.stop(),Ai(Ti)},Qn=Ti=>{if(Ti===st.CONNECTED)clearTimeout(Di),Pi();else if(Ti===st.FAILED){const Ni=function({action:hi,token:An,traceId:Kn,tag:Wi}){return new ki(Object.assign(Object.assign({},Ut.PEER_CONNECTION_NETWORK_FAILURE),{token:An,traceId:Kn,location:"peer-client.connect",tag:Wi,action:hi}))}({action:lt,token:qe,traceId:Pe,tag:Ie});clearTimeout(Di),Ai(Ni)}},this.on(Ad,Nt),this.on(ta,Qn),On=()=>{clearTimeout(Di)},Jt.signal.aborted&&(clearTimeout(Di),Ai(Oi)),Jt.signal.addEventListener("abort",()=>{clearTimeout(Di),Ai(Oi)})});try{const Pi=yield Promise.all([Xa(this,void 0,void 0,function*(){At||(yield this.start(),this.mediaStream=yield this.initializePeerConnection(me));const Si=Xe==null?void 0:Xe.assignmentToken,Oi=Xe==null?void 0:Xe.nodeOverride;return yield this.exchangeSdp({iceRestart:At,nodeOverride:Oi,assignmentToken:Si,abortController:Jt}),this.mediaStream}),Fi]);this.statsReporter.traceId=Pe;const Ai=Pi[0];if(this.abortController=void 0,!At&&lt===dn.PUBLISH)try{yield this.verifyOrUpdateTransceiverSync()}catch(Si){this.logger.error({err:Si,msg:"error syncing transceivers"})}return{mediaStream:Ai}}catch(Pi){throw On&&On(),Pi}finally{Ei()}}),this.disconnect=(me=!1)=>Xa(this,void 0,void 0,function*(){var Pe;const{token:Xe,action:qe}=this;(Pe=this.abortController)===null||Pe===void 0||Pe.abort(),this.stop(),me?this.cleanup(qe,Xe.participantID,Xe,me):yield this.cleanup(qe,Xe.participantID,Xe,me)}),this.onTrack=me=>{const{token:Pe,action:Xe,traceId:qe,identifier:Ie}=this;this.trace(Pe,qe,`onTrack: ${me.track.kind}`,Xe,Ie),this.videoSenderTransformer.onTrackEvent(me),this.videoReceiverTransformer.onTrackEvent(me)},this.onIceGatheringStateChange=()=>{var me,Pe,Xe;const{token:qe,action:Ie,traceId:xe,identifier:lt}=this;if(((me=this.peerConnection)===null||me===void 0?void 0:me.iceGatheringState)==="gathering"?this.perfTracker.markIceGatheringStart():((Pe=this.peerConnection)===null||Pe===void 0?void 0:Pe.iceGatheringState)==="complete"&&this.perfTracker.markIceGatheringStop(),this.peerConnection){const At=this.peerConnection.iceGatheringState,Jt=new J0(Ie,qe,xe,At,lt);this.analyticsTracker.trackEventNoSharedProps(Jt)}this.trace(qe,xe,`ICE gathering state change: ${(Xe=this.peerConnection)===null||Xe===void 0?void 0:Xe.iceGatheringState}`,Ie,lt)},this.onSelectedCandidatePairChange=()=>{var me,Pe;const{token:Xe,action:qe,traceId:Ie,identifier:xe}=this,lt=(Pe=(me=this.peerConnection)===null||me===void 0?void 0:me.getReceivers()[0].transport)===null||Pe===void 0?void 0:Pe.iceTransport,At=lt==null?void 0:lt.getSelectedCandidatePair();if(At){const{local:Jt,remote:Nt}=At,Qn=`Selected candidate pair change (local, remote): ${Jt==null?void 0:Jt.candidate}, ${Nt==null?void 0:Nt.candidate}`;this.logger.debug({msg:Qn}),this.trace(Xe,Ie,Qn,qe,xe)}},this.onIceCandidate=me=>Xa(this,void 0,void 0,function*(){var Pe,Xe;const{identifier:qe,action:Ie,traceId:xe}=this,lt=(Pe=me.target.localDescription)===null||Pe===void 0?void 0:Pe.sdp.includes("relay");this.analyticsTracker.trackEventNoSharedProps(new Qm(this.token,xe,`ice candidate: hasRelay = ${lt}, candidate = ${(Xe=me.candidate)===null||Xe===void 0?void 0:Xe.candidate}`,Ie,qe))}),this.onMute=()=>Xa(this,void 0,void 0,function*(){const{token:me,action:Pe,traceId:Xe,identifier:qe}=this;this.trace(me,Xe,"Track has muted",Pe,qe)}),this.onUnMute=()=>Xa(this,void 0,void 0,function*(){const{token:me,action:Pe,traceId:Xe,identifier:qe}=this;this.trace(me,Xe,"Track has unmuted",Pe,qe)}),this.fetchAndSetRemoteDescription=me=>Xa(this,void 0,void 0,function*(){var Pe,Xe,qe,Ie;const xe=(Xe=(Pe=this.peerConnection)===null||Pe===void 0?void 0:Pe.localDescription)===null||Xe===void 0?void 0:Xe.sdp;xe||this.logger.warn({msg:"Unexpected state: No SDP offer when attempting to fetch remote description"});const{token:lt,traceId:At,action:Jt,identifier:Nt,tag:Qn}=this,{endpointURL:On,nodeOverride:Ei,assignmentToken:Fi,multiCodec:Pi,abortController:Ai}=me;let Si;this.perfTracker.markPostStart(),this.perfTracker.markSdpExchangeStart();try{this.perfTracker.setTransport(this.sdpExchanger.getTransport());const hi=Ei||xd("node")||xd("dataPlaneEndpoint");Si=yield this.sdpExchanger.exchange({sdpOffer:xe,url:On,traceId:At,forceNode:hi,assignmentToken:Fi,multiCodec:Pi,abortController:Ai,initialLayerPreference:(qe=this.simulcastSubscribeConfig)===null||qe===void 0?void 0:qe.initialLayerPreference})}catch(hi){let An=hi;An instanceof ki||(An=new ki(Object.assign(Object.assign({},Ut.UNEXPECTED_ERROR),{action:Jt,token:lt,traceId:At,tag:Qn,details:hi instanceof Error?hi.message:"",location:"sdp-exchange"}))),An instanceof ki&&(this.analyticsTracker.trackError(An),this.emit(Ad,An))}if(this.perfTracker.markSdpExchangeStop(),!Si)return;const{location:Oi,sessionDeleteLink:Di,mediaControls:Ti}=Si;let Ni=Si.sdpAnswer;try{Ni=this.mungeSdpAnswer(Ni),Si.sdpAnswer=Ni}catch(hi){this.logger.error({err:hi,msg:"Error while attempting to munge SDP, keeping original answer"})}this.statsReporter.sdpAnswer=Ni,this.emit(B0,Si),Oi&&(this.whipResource={location:Oi,sessionDeleteLink:Di,mediaControls:Ti},this.sfuResource=function(hi){const An=hi.match(/https:\/\/([^/]+)\//);if(An){const Kn=An[1].split(".");if(Kn[0].includes("video-rtx"))return{node:`${Kn[0]}.${Kn[1]}`,cluster:Kn[1]}}}(Oi)||{node:"",cluster:""},this.statsReporter.updateSfuResource(this.sfuResource));try{this.perfTracker.markSetRemoteDescStart(),yield(Ie=this.peerConnection)===null||Ie===void 0?void 0:Ie.setRemoteDescription({sdp:Ni,type:"answer"}),this.perfTracker.markSetRemoteDescStop(),this.perfTracker.markPostStop()}catch(hi){const An=new ki(Object.assign(Object.assign({},Ut.SET_ANSWER_FAILURE),{action:Jt,token:lt,traceId:At,tag:ko(Jt,Nt),location:"setRemoteDescription",remoteParticipantId:Nt,details:hi instanceof Error?hi.message:""}));this.analyticsTracker.trackError(An),this.emit(Ad,An)}}),this.cleanup=(me,Pe,Xe,qe=!1)=>Xa(this,void 0,void 0,function*(){var Ie,xe,lt;const At=Na();if(this.toggleStageConnectionListeners(!1),this.currentJitterBufferMinDelayInMs=void 0,this.stageConnection=void 0,!(!((Ie=this.whipResource)===null||Ie===void 0)&&Ie.location))return this.trace(Xe,this.traceId,"whipResource location not known, exiting cleanup",me,Pe),void this.analyticsTracker.trackError(new ki(Object.assign(Object.assign({},Ut.WHIP_URL_MISSING),{action:me,token:Xe,traceId:this.traceId,tag:ko(me,Pe),location:me===dn.SUBSCRIBE?"unsubscribe":"unpublish",requestUUID:At,remoteParticipantId:Pe})));let Jt=this.whipResource.location;if(this.trace(Xe,this.traceId,`use hostnamecachedurl: ${Jt}`,me,Pe),qe){if(!((lt=this.whipResource)===null||lt===void 0)&&lt.sessionDeleteLink){Jt=this.whipResource.sessionDeleteLink,this.trace(Xe,this.traceId,`DELETE via session-delete beacon path: ${Jt}`,me,Pe);try{navigator.sendBeacon(Jt,JSON.stringify({authorization:Xe.rawToken}))}catch(Nt){this.analyticsTracker.trackErrorAndThrow(new ki(Object.assign(Object.assign({},Vp(Ut.WHIP_DELETE_FAILURE,Nt)),{action:me,token:Xe,traceId:this.traceId,tag:ko(me,Pe),location:dn.SUBSCRIBE?"unsubscribe":"unpublish",requestUUID:At,remoteParticipantId:Pe})))}}}else try{yield na().delete(Jt,{headers:{Authorization:`Bearer ${Xe.rawToken}`,"X-Stages-Platform":"web","X-Stages-Request-ID":At.value,"X-Stages-SDK":"1.19.0","X-Stages-Session-ID":this.analyticsTracker.getSessionId(),"X-Stages-Trace-ID":this.traceId.value,"X-Stages-WHIP-Version":Mc}})}catch(Nt){((xe=Nt.response)===null||xe===void 0?void 0:xe.status)===404?this.trace(Xe,this.traceId,`DELETE returned 404, ignoring, action = ${me}, uuid = ${At.value}`,me,Pe):this.analyticsTracker.trackErrorAndThrow(new ki(Object.assign(Object.assign({},Vp(Ut.WHIP_DELETE_FAILURE,Nt)),{action:me,token:Xe,traceId:this.traceId,tag:ko(me,Pe),location:dn.SUBSCRIBE?"unsubscribe":"unpublish",requestUUID:At,remoteParticipantId:Pe})))}}),this.getConnectionState=()=>{if(!this.peerConnection)return st.NONE;const me=this.peerConnection.connectionState||this.peerConnection.iceConnectionState;try{return iS(me)}catch{return this.logger.warn({msg:"Unhandled connection state:",rawState:me}),st.IDLE}},this.onIceCandidateError=me=>{const{token:Pe,traceId:Xe,tag:qe}=this;if(me.errorCode!==701){const Ie=new ki(Object.assign(Object.assign({},Ut.ICE_CANDIDATE_ERROR),{action:this.action,token:Pe,traceId:Xe,tag:qe,location:"onIceCandidateError",remoteParticipantId:this.identifier}));this.analyticsTracker.trackError(Ie),this.emit(Ad,Ie)}},this.onIceConnectionStateChange=()=>{var me;const{token:Pe,traceId:Xe,action:qe,identifier:Ie}=this;this.trace(Pe,Xe,`ICE connection state change: ${(me=this.peerConnection)===null||me===void 0?void 0:me.iceConnectionState}`,qe,Ie),this.onConnectionStateChange()},this.createVideoReceiverTransformer=({enabled:me})=>{const Pe=new lg({enabled:me}),{token:Xe,tag:qe,identifier:Ie,action:xe,traceId:lt}=this;Pe.on(yS,Nt=>{this.emit(jp,Nt)});const At=function(Nt,Qn){let On=0;return function(...Ei){const Fi=Date.now();Fi-On>=Qn&&(On=Fi,Nt(...Ei))}}(Nt=>{const Qn=`Transform error occurred: ${Nt.type}`,On=vS({traceId:lt,token:Xe,tag:qe,identifier:Ie,action:xe,details:Qn,stageErrorValue:Ut.TRANSFORM_UNEXPECTED_ERROR});this.logger.warn({err:On,msg:"Error encountered when transforming receiver",error:Nt})},1e3),Jt=Nt=>{const Qn=`Too many errors occurred: ${Nt.type}`,On=vS({traceId:lt,token:Xe,tag:qe,identifier:Ie,action:xe,details:Qn,stageErrorValue:Ut.TRANSFORM_TOO_MANY_ERRORS});this.logger.error({err:On,msg:"Too many errors encountered when transforming receiver. Shutting down transformer.",error:Nt}),Pe.destroy(),this.analyticsTracker.trackError(On),this.emit(ft,On)};return Pe.on(pv,Nt=>{Nt.stageErrorValue.code!==Ut.TRANSFORM_TOO_MANY_ERRORS.code?At(Nt):Jt(Nt)}),Pe},this.onConnectionStateChange=()=>{var me;if(this.peerConnection){const Xe=this.peerConnection.connectionState||this.peerConnection.iceConnectionState,{token:qe,traceId:Ie,identifier:xe,action:lt}=this,At=new Ya(lt,qe,Ie,Xe,xe);this.analyticsTracker.trackEventNoSharedProps(At),this.trace(qe,Ie,`connection state change: ${Xe}`,lt,xe)}const Pe=this.getConnectionState();switch(Pe){case st.CONNECTED:this.perfTracker.markActionStop(),this.emit(ta,Pe),this.statsReporter.updateMultihostConfiguration(this.audioTrackForPub,this.videoTrackForPub),(me=this.peerConnection)===null||me===void 0||me.getTransceivers().forEach(Xe=>{var qe,Ie;!((Ie=(qe=Xe.receiver)===null||qe===void 0?void 0:qe.transport)===null||Ie===void 0)&&Ie.iceTransport&&Xe.receiver.transport.iceTransport.addEventListener("selectedcandidatepairchange",this.onSelectedCandidatePairChange)});break;case st.FAILED:this.emit(ta,Pe),this.handleConnectionFailure();break;default:this.emit(ta,Pe)}},this.onIncompatibleCodecs=me=>Xa(this,void 0,void 0,function*(){if(me.forEach(qe=>{let Ie=!1;this.incompatibleCodecs.forEach(xe=>{xe.config===qe.config&&xe.mime===qe.mime&&(Ie=!0)}),Ie||this.incompatibleCodecs.add(qe)}),this.peerConnection)try{yield(Pe=this.peerConnection,Xe=[...this.incompatibleCodecs],oS(void 0,void 0,void 0,function*(){var qe;for(const Ie of Pe.getSenders()){const xe=Ie.getParameters();if(xe.codecs.length>1){const lt=xe.codecs[0];let At=!1;for(const Jt of Xe)Nh(lt,Jt)&&(At=!0);if(At){const Jt=nv(Xe,xe.codecs);(qe=xe.encodings)===null||qe===void 0||qe.forEach(Nt=>{Nt.active&&(Nt.codec=Jt)}),yield Ie.setParameters(xe)}}}}))}catch(qe){const{token:Ie,action:xe,traceId:lt,identifier:At}=this,Jt=new ki(Object.assign(Object.assign({},Ut.CODEC_HANDLE_INCOMPATIBLE_UNEXPECTED_ERROR),{action:xe,token:Ie,traceId:lt,tag:ko(xe,At),location:"onIncompatibleCodecs",remoteParticipantId:At,details:qe instanceof Error?qe.message:""}));this.analyticsTracker.trackError(Jt),this.emit(Ad,Jt)}var Pe,Xe}),this.token=T,this.logger=new fo(A,fe.WEBRTC),this.action=O,this.tag=L,this.traceId=B,O===dn.SUBSCRIBE&&!ne)throw new Error("Subscribe action provided without subscriber Id");this.inBandMessagingEnabled=O===dn.SUBSCRIBE?!!(!((oe=Z==null?void 0:Z.inBandMessaging)===null||oe===void 0)&&oe.enabled):(de=xh("enableInBandMessaging"))!==null&&de!==void 0&&de,this.jitterBufferConfig=Z==null?void 0:Z.jitterBuffer,this.simulcastSubscribeConfig=Z==null?void 0:Z.simulcast,this.subscriberId=ne,this.stageConnection=se,this.videoSenderTransformer=new by({enabled:this.action===dn.PUBLISH&&this.inBandMessagingEnabled}),this.videoReceiverTransformer=this.createVideoReceiverTransformer({enabled:this.action===dn.SUBSCRIBE&&this.inBandMessagingEnabled}),this.perfTracker=new sS(this.action,this.traceId),this.statsReporter=new cv(O,T,B,this.identifier,this.analyticsTracker,this.videoReceiverTransformer),this.sdpExchanger=function(me){const{connection:Pe,token:Xe,action:qe,identifier:Ie,tracker:xe}=me,lt=Pe&&Pe.supportsSdpExchange(),At=qe===dn.SUBSCRIBE&&lt&&!ty(),Jt=qe===dn.PUBLISH&&lt&&P0()&&!ty();return At||Jt?new mS(Xe,Pe,{action:qe,remoteParticipantId:Ie},xe):new _y(Xe,{action:qe,remoteParticipantId:Ie},xe)}({connection:se,action:O,token:T,identifier:this.identifier,tracker:H}),this.handlePublishingChangedBinding=this.handlePublishingChanged.bind(this),this.toggleStageConnectionListeners(!0)}get videoMediaId(){var T,A;return(A=(T=this.videoTransceiver)===null||T===void 0?void 0:T.mid)!==null&&A!==void 0?A:null}toggleStageConnectionListeners(T){var A,O;T?(A=this.stageConnection)===null||A===void 0||A.on(Ac,this.handlePublishingChangedBinding):(O=this.stageConnection)===null||O===void 0||O.off(Ac,this.handlePublishingChangedBinding)}updateSubscribeConfig(T){var A,O;this.jitterBufferConfig=T.jitterBuffer,this.simulcastSubscribeConfig=T.simulcast,this.action===dn.SUBSCRIBE&&(this.inBandMessagingEnabled=T.inBandMessaging.enabled),this.applyJitterBufferMinDelayConditionally((O=(A=this.stageConnection)===null||A===void 0?void 0:A.getIsStagePublishing())!==null&&O!==void 0&&O)}verifyOrUpdateTransceiverSync(){var T,A;return Xa(this,void 0,void 0,function*(){if(this.videoTrackForPub){const O=this.getTransceiverForKind("video");O?this.videoTrackForPub.track.id!==((T=O.sender.track)===null||T===void 0?void 0:T.id)&&(this.logger.debug({msg:"found out of sync video transceiver... updating"}),yield this.replaceOrUpdateTrack(this.videoTrackForPub)):this.logger.warn({msg:"missing transceiver for video"})}if(this.audioTrackForPub){const O=this.getTransceiverForKind("audio");O?this.audioTrackForPub.track.id!==((A=O.sender.track)===null||A===void 0?void 0:A.id)&&(this.logger.debug({msg:"found out of sync audio transceiver... updating"}),yield this.replaceOrUpdateTrack(this.audioTrackForPub)):this.logger.warn({msg:"missing transceiver for audio"})}})}start(){var T,A,O;return Xa(this,void 0,void 0,function*(){const{token:L,action:B,traceId:H,identifier:ne}=this;B!==dn.PUBLISH||L.claims.capabilities.allow_publish||this.analyticsTracker.trackErrorAndThrow(new ki(Object.assign(Object.assign({},Vp(Ut.TOKEN_PERMISSIONS_DENIED,new Error("Cannot publish with subscribe only token"))),{action:B,token:L,traceId:H,tag:ko(B,ne),location:"StagePeerClient.start",remoteParticipantId:ne})));const se=function({action:Z,identifier:oe,token:de,analyticsTracker:me}){let Pe="";const Xe=Fu(de,me);switch(Z){case dn.PUBLISH:Pe=Xe.getPublishEndpoint();break;case dn.SUBSCRIBE:oe&&(Pe=Xe.getSubscribeEndpoint(oe))}return Pe}({action:B,identifier:ne,token:L.rawToken,analyticsTracker:this.analyticsTracker});try{this.perfTracker.markActionStart(),this.stageCapabilities={simulcastNegotiated:(O=(A=(T=this.videoTrackForPub)===null||T===void 0?void 0:T.config)===null||A===void 0?void 0:A.simulcastEnabled)!==null&&O!==void 0&&O},this.endpointURL=se,this.peerConnection=new RTCPeerConnection({iceTransportPolicy:"all"}),this.statsReporter.start(this.peerConnection,this.stageCapabilities.simulcastNegotiated),this.peerConnection.addEventListener("connectionstatechange",this.onConnectionStateChange),this.peerConnection.addEventListener("iceconnectionstatechange",this.onIceConnectionStateChange),this.peerConnection.addEventListener("icecandidateerror",this.onIceCandidateError),this.peerConnection.addEventListener("icegatheringstatechange",this.onIceGatheringStateChange),this.peerConnection.addEventListener("icecandidate",this.onIceCandidate),this.peerConnection.addEventListener("track",this.onTrack),this.peerConnection.addEventListener("mute",this.onMute),this.peerConnection.addEventListener("unmute",this.onUnMute),this.trace(L,H,"peer connection created",B,ne)}catch(Z){const oe=new ki(Object.assign(Object.assign({action:B},Vp(Ut.CREATE_PEER_CONNECTION_FAILURE,Z)),{token:L,traceId:H,tag:ko(B,ne),location:"StagePeerClient.start",remoteParticipantId:ne}));B===dn.PUBLISH&&this.emit(ta,st.FAILED),this.emit(Ad,oe),this.analyticsTracker.trackErrorAndThrow(oe)}})}mungeSdpOffer(T,A,O){if(O.simulcastNegotiated&&(T=new Gr(T).withVideoLayersAllocationRtpHeaderExtension().sdp),A===dn.SUBSCRIBE)T=new Gr(T).withOpusAudioConfig(mo(lr),!0).sdp;else if(A===dn.PUBLISH&&O.audioConfig){const{maxBitrateBps:L,stereo:B}=O.audioConfig;T=new Gr(T).withOpusAudioConfig(L,B).sdp}return T}mungeSdpAnswer(T){return ps.browser.isFirefox()&&this.audioTrackForPub&&this.action===dn.PUBLISH&&(T=new Gr(T).withOpusAudioConfig(this.audioTrackForPub.config.maxBitrateBps,void 0).sdp),T}stop(){var T,A,O,L,B,H,ne,se,Z;this.statsReporter.stop(),this.videoReceiverTransformer.destroy(),this.videoSenderTransformer.destroy(),(T=this.peerConnection)===null||T===void 0||T.removeEventListener("connectionstatechange",this.onConnectionStateChange),(A=this.peerConnection)===null||A===void 0||A.removeEventListener("iceconnectionstatechange",this.onIceConnectionStateChange),(O=this.peerConnection)===null||O===void 0||O.removeEventListener("icecandidateerror",this.onIceCandidateError),(L=this.peerConnection)===null||L===void 0||L.removeEventListener("icegatheringstatechange",this.onIceGatheringStateChange),(B=this.peerConnection)===null||B===void 0||B.removeEventListener("track",this.onTrack),(H=this.peerConnection)===null||H===void 0||H.removeEventListener("mute",this.onMute),(ne=this.peerConnection)===null||ne===void 0||ne.removeEventListener("unmute",this.onUnMute),(se=this.peerConnection)===null||se===void 0||se.removeEventListener("icecandidate",this.onIceCandidate),(Z=this.peerConnection)===null||Z===void 0||Z.close()}getTransceiverForKind(T){if(!this.peerConnection)return;const A=this.peerConnection.getTransceivers();return T==="audio"?A.find(O=>O.mid==="0"):T==="video"?A.find(O=>O.mid==="1"):void 0}removeTrack(T){return Xa(this,void 0,void 0,function*(){if(T==="audio"||T==="video")if(this.peerConnection)try{const A=this.getTransceiverForKind(T);if(!A)return void this.logger.warn({msg:`tried removing track type ${T} but couldn't find transceiver`});yield A.sender.replaceTrack(null),T===ju.AUDIO?this.audioTrackForPub=void 0:this.videoTrackForPub=void 0,yield this.statsReporter.updateMultihostConfiguration(this.audioTrackForPub,this.videoTrackForPub)}catch(A){this.logger.warn({msg:"error replacing track",err:A})}else T===ju.AUDIO?this.audioTrackForPub=void 0:this.videoTrackForPub=void 0;else this.logger.warn({msg:"RemoveTrack called with invalid track type",trackType:T})})}replaceOrUpdateTrack(T){return Xa(this,void 0,void 0,function*(){if(T.track){if(Bl(T)?this.audioTrackForPub=T:dv(T)&&(this.videoTrackForPub=T),this.peerConnection)try{const A=this.getTransceiverForKind(T.track.kind);if(!A)return void this.logger.warn({msg:`tried replacing track type ${T.track.kind} but couldn't find transceiver`,track:T.track});if(dv(T)){const O=A.sender.getParameters(),L=Dh(this.stageCapabilities.simulcastNegotiated,T);O.encodings=O.encodings.map(B=>{var H;const ne=(H=B.rid)!==null&&H!==void 0?H:"",se=L.find(Z=>{var oe;return((oe=Z.rid)!==null&&oe!==void 0?oe:"")===ne});return se?Object.assign(Object.assign({},B),se):B}),yield A.sender.setParameters(O)}else if(Bl(T)){const O=A.sender.getParameters(),L=Gu(T)[0];O.encodings=O.encodings.map(B=>Object.assign(Object.assign({},B),L)),yield A.sender.setParameters(O)}yield A.sender.replaceTrack(T.track),yield this.statsReporter.updateMultihostConfiguration(this.audioTrackForPub,this.videoTrackForPub)}catch(A){this.logger.warn({msg:"error replacing track",err:A})}}else this.logger.warn({msg:"Unexpected call to replaceOrUpdateTrack with no track"})})}initializePeerConnection(T=!1){var A,O,L;return Xa(this,void 0,void 0,function*(){const{traceId:B,token:H,action:ne,identifier:se}=this;z0(this.peerConnection);let Z=new MediaStream;if(ne===dn.PUBLISH){this.audioTrackForPub||(this.audioTrackForPub={track:this.getSilentAudio(),config:{maxBitrateBps:mo(Q0),stereo:!1}});const oe=this.peerConnection.getTransceivers(),de=[];oe.forEach(xe=>{var lt;de.concat((lt=xe.sender.track)===null||lt===void 0?void 0:lt.id)}),Z=new MediaStream([this.audioTrackForPub.track,(A=this.videoTrackForPub)===null||A===void 0?void 0:A.track].filter(xe=>!!xe&&!de.includes(xe.id)));const me=Z.getAudioTracks()[0]||"audio",Pe=Z.getVideoTracks()[0]||"video",Xe={direction:"sendonly",streams:[Z],sendEncodings:Gu(this.audioTrackForPub)},qe={direction:"sendrecv",streams:[Z],sendEncodings:Dh(this.stageCapabilities.simulcastNegotiated,this.videoTrackForPub)};this.peerConnection.addTransceiver(me,Xe),this.trace(H,B,`track added, type: ${me.kind||me}`,ne,se);const Ie=this.peerConnection.addTransceiver(Pe,qe);this.trace(H,B,`track added, type: ${Pe.kind||Pe}`,ne,se),this.inBandMessagingEnabled&&!by.isSupported(Ie)&&this.handleTransformNotSupported(),this.videoSenderTransformer.onTransceiverAdd(Ie)}else ne===dn.SUBSCRIBE&&(H.shouldSendSilentAudio()?this.peerConnection.addTransceiver(this.getSilentAudio(),{direction:"sendrecv"}):this.peerConnection.addTransceiver("audio",{direction:"recvonly"}),this.trace(H,B,"track added, type: audio",ne,se),T||(this.videoTransceiver=this.peerConnection.addTransceiver("video",{direction:"recvonly"}),this.trace(H,B,"track added, type: video",ne,se),this.inBandMessagingEnabled&&!lg.isSupported(this.videoTransceiver)&&this.handleTransformNotSupported(),this.videoReceiverTransformer.onTransceiverAdd(this.videoTransceiver)),this.peerConnection.getTransceivers().forEach(oe=>{oe.receiver?(this.logger.info({msg:"dbg: Subscribe succeeded, adding media track to participant mediaStream"}),Z==null||Z.addTrack(oe.receiver.track)):this.logger.info({msg:"dbg: Subscribe succeeded, but Transceiver were negotiated without Receiver"})}),this.applyJitterBufferMinDelayConditionally((L=(O=this.stageConnection)===null||O===void 0?void 0:O.getIsStagePublishing())!==null&&L!==void 0&&L));return Z})}handlePublishingChanged(T){this.logger.debug({msg:`[handlePublishingChanged (${this.subscriberId})] isStagePublishing: ${T}, currentMinDelay: ${this.currentJitterBufferMinDelayInMs}`}),this.action===dn.SUBSCRIBE&&this.applyJitterBufferMinDelayConditionally(T)}applyJitterBufferMinDelayConditionally(T){const A=this.currentJitterBufferMinDelayInMs,O=this.calcJitterBufferMinDelay(T,this.jitterBufferConfig);if(T){if(A===void 0||A>O){const L=`[applyJitterBufferMinDelayConditionally (${this.subscriberId})] participant is publishing and min delay is unset or > configured; attempting to update to ${O}`;this.logger.debug({msg:L}),this.trace(this.token,this.traceId,L,this.action,this.identifier),this.applyAndTrackJitterBufferMinDelay(O)}}else if(A===void 0||O!==A){const L=`[applyJitterBufferMinDelayConditionally (${this.subscriberId})] participant is subscribe-only and min delay is unset or != configured; attempting to update to ${O}`;this.logger.debug({msg:L}),this.trace(this.token,this.traceId,L,this.action,this.identifier),this.applyAndTrackJitterBufferMinDelay(O)}}calcJitterBufferMinDelay(T,A){var O,L,B;let H=0;if(!(()=>{const ne=RTCRtpReceiver.prototype;return!(!ne||typeof ne!="object")&&("jitterBufferTarget"in ne||"playoutDelayHint"in ne)})())return 0;if(T)H=Ka((O=A==null?void 0:A.minDelayWhenPublishing)!==null&&O!==void 0?O:Ys.DEFAULT,T);else{H=Ka((L=A==null?void 0:A.minDelayWhenSubscribeOnly)!==null&&L!==void 0?L:Ys.DEFAULT,T);const ne=(B=this.stageConnection)===null||B===void 0?void 0:B.jitterBufferMinDelayInMs();(A==null?void 0:A.minDelayWhenSubscribeOnly)===Ys.DEFAULT&&ne!==void 0&&(H=ne,this.logger.debug({msg:`[calcJitterBufferMinDelay] overriding min delay with remote value: ${H}`}))}return H}applyAndTrackJitterBufferMinDelay(T){var A,O;this.currentJitterBufferMinDelayInMs=T,this.statsReporter.updateJitterBufferMinDelay(T),T!==void 0&&((O=(A=this.peerConnection)===null||A===void 0?void 0:A.getTransceivers())===null||O===void 0||O.forEach(L=>{L.receiver&&this.applyJitterBufferMinDelay(L.receiver,T)}))}applyJitterBufferMinDelay(T,A){let O="Unable to set jitter buffer min delay";if("jitterBufferTarget"in T)O=`setting jitterBufferTarget to: ${A} for track: ${T.track.kind}`,this.logger.debug({msg:O}),T.jitterBufferTarget=A;else if("playoutDelayHint"in T){const L=A/1e3;O=`setting playoutDelayHint to: ${A} for track: ${T.track.kind}`,this.logger.debug({msg:O}),T.playoutDelayHint=L}else this.logger.warn({msg:O});this.trace(this.token,this.traceId,O,this.action,this.identifier)}exchangeSdp(T){var A;return Xa(this,void 0,void 0,function*(){const{traceId:O,token:L,action:B,identifier:H,tag:ne,endpointURL:se}=this,{iceRestart:Z=!1,nodeOverride:oe,assignmentToken:de,abortController:me}=T;let Pe;this.logger.debug({msg:`Exchanging SDP: ${O.value}, iceRestart=${Z}, nodeOverride=${oe}, assignmentToken=${de}`}),z0(this.peerConnection),B===dn.PUBLISH&&Qo()&&(this.logger.debug({msg:"Applying publisher codec preference for main profile."}),((qe,Ie)=>{var xe,lt;const At=(xe=RTCRtpReceiver.getCapabilities("video"))===null||xe===void 0?void 0:xe.codecs;if(!At)return;let Jt=At;Jt=tv(At,"42e0"),Ie.preferMainProfile&&(Jt=tv(At,"4d00")),(lt=qe.getTransceivers().find(Nt=>Nt.receiver.track.kind==="video"))===null||lt===void 0||lt.setCodecPreferences(Jt)})(this.peerConnection,{preferMainProfile:Qo()}));try{this.trace(L,O,"Creating offer",B,H),Pe=yield this.peerConnection.createOffer({iceRestart:Z})}catch(qe){const Ie=new ki(Object.assign(Object.assign({},Vp(Ut.CREATE_OFFER_FAILURE,qe)),{action:B,token:L,traceId:O,tag:ne,location:"exchangeSdp",remoteParticipantId:H}));this.emit(Ad,Ie),this.analyticsTracker.trackErrorAndThrow(Ie)}Pe.sdp&&(Pe.sdp=this.mungeSdpOffer(Pe.sdp,B,{simulcastNegotiated:this.stageCapabilities.simulcastNegotiated,audioConfig:(A=this.audioTrackForPub)===null||A===void 0?void 0:A.config})),this.trace(L,O,"Setting local description",B,H),yield this.peerConnection.setLocalDescription(Pe),this.trace(L,O,"local description set",B,H),se||this.logger.warn({msg:"Unexpected state: No endpointURL specified for fetching of remote description."});const Xe=B===dn.PUBLISH&&Qo()||B===dn.SUBSCRIBE&&xh("multiCodecAnswer");yield this.fetchAndSetRemoteDescription({endpointURL:se,nodeOverride:oe,assignmentToken:de,multiCodec:Xe,abortController:me})})}getReports(){var T;return Xa(this,void 0,void 0,function*(){try{const A=(yield(T=this.peerConnection)===null||T===void 0?void 0:T.getStats())||[],O=[];return A.forEach(L=>{O.push(L)}),O}catch{return[]}})}requestRTCStats(T){return Xa(this,void 0,void 0,function*(){if(this.peerConnection)return this.peerConnection.getStats(T)})}get identifier(){return this.subscriberId||this.token.participantID}handleTransformNotSupported(){const{token:T,tag:A,identifier:O,action:L,traceId:B}=this,H=vS({traceId:B,token:T,tag:A,identifier:O,action:L,stageErrorValue:Ut.TRANSFORM_NOT_SUPPORTED_BY_PLATFORM});this.logger.error({err:H,msg:"Transforms not supported by this platform"}),this.analyticsTracker.trackError(H),this.emit(ft,H)}handleConnectionFailure(){return Xa(this,void 0,void 0,function*(){const{token:T,traceId:A,tag:O}=this;this.analyticsTracker.trackError(new ki(Object.assign(Object.assign({},Ut.PEER_CONNECTION_NETWORK_FAILURE),{action:this.action,token:T,traceId:A,tag:O,location:"onIceCandidateError",remoteParticipantId:this.identifier})))})}getSilentAudio(){ug||(ug=new AudioContext);const T=ug.createOscillator(),A=ug.createGain();T.connect(A);const O=ug.createMediaStreamDestination();return A.connect(O),A.gain.value=0,T.start(),O.stream.getAudioTracks()[0]}getActionMeasurements(){return this.perfTracker.getMeasurements()}initTracksToPublish(T){this.videoTrackForPub=T.find(dv),this.audioTrackForPub=T.find(Bl)}getSfuResource(){return this.sfuResource}getExpectedJitterBufferMinDelayInMs(){var T,A;return this.calcJitterBufferMinDelay((A=(T=this.stageConnection)===null||T===void 0?void 0:T.getIsStagePublishing())!==null&&A!==void 0&&A,this.jitterBufferConfig)}trace(T,A,O,L,B){this.analyticsTracker.trackEventNoSharedProps(new Qm(T,A,O,L,B))}sendSeiMessage(T){var A;this.action===dn.PUBLISH&&((A=this.videoSenderTransformer)===null||A===void 0||A.sendSeiMessage(T))}}const Ey=dn.SUBSCRIBE;class Ku{constructor(T,A,O){this.analyticsTracker=T,this.token=A,this.remoteId=O,this.action=Ey}trackAttempt({stageConnectionStats:T,isReassignment:A=!1,traceIdOverride:O,preAttemptSfuResource:L}){const{action:B,analyticsTracker:H,token:ne,remoteId:se}=this,Z=O||wc();return H.trackEvent(new ag({token:this.token,subscribedId:this.remoteId,traceId:Z,isEdpConnected:T.isConnected,isReassignment:A,preAttemptSfuResource:L})),{getTraceId:()=>Z,trackSubscribeStarted({totalDurationWithRetries:oe,retryTimes:de,sfuResource:me,peerClientPerfStats:Pe}){const{optionsDuration:Xe,postDuration:qe,timeToCandidate:Ie,timeToConnected:xe,sdpExchangeDuration:lt,sdpExchangeTransport:At,setRemoteDescDuration:Jt,peerConnectionDuration:Nt}=Pe,{edpInitialConnectDuration:Qn,edpInitialConnectRetries:On,edpInitialStateDuration:Ei,edpInitialStatePublishingCount:Fi,edpStateUpdateCount:Pi}=T;H.trackEvent(new Jp({token:ne,traceId:Z,remoteParticipantId:se,optionsDuration:Xe,postDuration:qe,timeToCandidate:Ie,totalDuration:xe,edpInitialConnectDuration:Qn,edpInitialConnectRetries:On,edpInitialStateDuration:Ei,edpInitialStatePublishingCount:Fi,edpStateUpdateCount:Pi,sdpExchangeDuration:lt,sdpExchangeTransport:At,setRemoteDescDuration:Jt,peerConnectionDuration:Nt,sfuResource:me,totalDurationWithRetries:oe,subscribeRetryTimes:de,isReassignment:A}))},trackSubscribeFirstFrame:({peerClientPerfStats:oe,totalDurationWithRetries:de,sfuResource:me,retryTimes:Pe,currentJitterBufferMinDelayInMs:Xe,mediaType:qe,firstFrameDuration:Ie})=>{const{sdpExchangeDuration:xe,sdpExchangeTransport:lt,setRemoteDescDuration:At,peerConnectionDuration:Jt}=oe,{edpInitialConnectDuration:Nt,edpInitialConnectRetries:Qn,edpInitialStateDuration:On,edpInitialStatePublishingCount:Ei,edpStateUpdateCount:Fi}=T;this.analyticsTracker.trackEvent(new Ax({token:this.token,traceId:Z,remoteParticipantId:se,edpInitialConnectDuration:Nt,edpInitialConnectRetries:Qn,edpInitialStateDuration:On,edpInitialStatePublishingCount:Ei,edpStateUpdateCount:Fi,sdpExchangeDuration:xe,sdpExchangeTransport:lt,setRemoteDescDuration:At,peerConnectionDuration:Jt,videoWasPaused:!1,firstFrameDuration:Ie,mediaType:qe,sfuResource:me,totalDurationWithRetries:de,subscribeRetryTimes:Pe,currentJitterBufferMinDelayInMs:Xe}))},trackSubscribeFailed(oe,de){const me=((qe,Ie,xe)=>{if(qe instanceof ki)return qe;let lt="";return qe instanceof Ms.AxiosError&&(lt+=`AxiosError - ${qe.code}`),new ki(Object.assign(Object.assign(Object.assign({},Ut.SUBSCRIBE_FAILURE),{action:Ey,token:Ie,traceId:xe,tag:Cc.SUBSCRIBE_RELATED,location:"subscribe",details:`${lt} ${qe==null?void 0:qe.message}`}),{fatal:!0}))})(oe,ne,Z);H.trackEvent(new dS({token:ne,traceId:Z,remoteParticipantId:se,code:me.code,message:me.message,fatal:me.fatal,nominal:me.nominal,isReassignment:A}));const{isConnected:Pe}=T,Xe=new ki(Object.assign(Object.assign({},Ut.SUBSCRIBE_FAILURE),{action:B,token:ne,traceId:Z,tag:ko(dn.SUBSCRIBE,se),location:"subscribe",remoteParticipantId:se,isEdpConnected:Pe,details:de}));return oe instanceof ki&&(Xe.fatal=oe.fatal,Xe.nominal=oe.nominal,Xe.location=`subscribe > ${oe.location}`),H.trackError(Xe),me},trackUnsubscribe:()=>{H.trackEvent(new xx({token:ne,unsubscribedId:se,traceId:Z}))},trackEndSucceeded:oe=>{H.trackEvent(new og({token:ne,traceId:Z,remoteParticipantId:se,isUnsubscribeSuccessful:!0,reason:oe}))},trackEndFailed:oe=>{const de=new ki(Object.assign(Object.assign({},Ut.UNSUBSCRIBE_FAILURE),{token:ne,traceId:Z,tag:ko(dn.SUBSCRIBE,se),location:"unsubscribe",remoteParticipantId:se}));return oe!==Ia.UNLOAD&&oe!==Ia.UNSUBSCRIBE||H.trackError(de),H.trackEvent(new og({token:ne,traceId:Z,remoteParticipantId:se,isUnsubscribeSuccessful:!0,reason:oe})),de}}}}class em extends Yn{constructor(T,A,O,L,B,H){super(Sn.PLAYBACK_LAYER_REQUEST,T,A,!1),Object.assign(this.properties,{media_type:O,remote_participant_id:L,track_id:B,layer_id:H})}}class bS extends Yn{constructor(T,A,O,L,B,H=1){super(Sn.PLAYBACK_LAYER_STATE,T,A,!1),Object.assign(this.properties,{media_type:O,remote_participant_id:L,track_id:B,request_count:H})}}var hg,Za,dg,Ea;(function(N){N.PAUSE="pause",N.PLAY="play"})(hg||(hg={})),function(N){N.IDLE="idle",N.ACTIVE="active",N.ERRORED="errored",N.DESTROYED="destroyed"}(Za||(Za={})),function(N){N.SUCCESS="success"}(dg||(dg={})),function(N){N.FAILED="failed",N.DESTROYED="destroyed",N.THROTTLED="throttled"}(Ea||(Ea={}));var Lh=function(N,T,A,O){return new(A||(A=Promise))(function(L,B){function H(Z){try{se(O.next(Z))}catch(oe){B(oe)}}function ne(Z){try{se(O.throw(Z))}catch(oe){B(oe)}}function se(Z){var oe;Z.done?L(Z.value):(oe=Z.value,oe instanceof A?oe:new A(function(de){de(oe)})).then(H,ne)}se((O=O.apply(N,[])).next())})};class Nx{constructor(T){this.state=Za.IDLE,this.mid=null,this.playbackEndpoint=null,this.layersEndpoint=null,this.stopVideo=()=>Lh(this,void 0,void 0,function*(){return this.state!==Za.ACTIVE?(this.logCommandSkipped("stopVideo"),this.mapSkippedResultFromState(this.state)):this.sendPlaybackRequest(hg.PAUSE)}),this.startVideo=()=>Lh(this,void 0,void 0,function*(){return this.state!==Za.ACTIVE?(this.logCommandSkipped("startVideo"),this.mapSkippedResultFromState(this.state)):this.sendPlaybackRequest(hg.PLAY)}),this.setLayer=A=>Lh(this,void 0,void 0,function*(){return this.state!==Za.ACTIVE?(this.logCommandSkipped("setLayer"),this.mapSkippedResultFromState(this.state)):this.sendLayerRequest(A)}),this.unsetLayer=()=>Lh(this,void 0,void 0,function*(){return this.state!==Za.ACTIVE?(this.logCommandSkipped("unsetLayer"),this.mapSkippedResultFromState(this.state)):this.sendLayerRequest()}),this.getLayers=()=>Lh(this,void 0,void 0,function*(){return this.state!==Za.ACTIVE?(this.logCommandSkipped("getLayers"),this.mapSkippedResultFromState(this.state)):this.sendLayerStateRequest()}),this.sendPlaybackRequest=A=>Lh(this,void 0,void 0,function*(){if(!this.mid)return this.logger.warn({msg:"mid is unexpectedly undefined"}),(0,ii.err)(Ea.FAILED);if(!this.playbackEndpoint)return this.logger.warn({msg:"Playback endpoint is unset and required for playback control requests"}),(0,ii.err)(Ea.FAILED);this.logger.info({msg:`Sending ${A} request to ${this.playbackEndpoint}`});const O=A===hg.PAUSE?{pause:[this.mid]}:{play:[this.mid]},L=this.createPostWhepRequest(O);return fetch(this.playbackEndpoint,L).then(B=>B.status>=300?(new Error(`Error sending media controls request: ${B.status}:${B.statusText}`),this.logger.error({err:ii.err}),(0,ii.err)(Ea.FAILED)):(this.logger.debug({msg:`Request to ${A} was successful: ${B.status}`}),(0,ii.ok)(dg.SUCCESS))).catch(B=>(this.logger.error({err:B,msg:"Error sending media controls request"}),(0,ii.err)(Ea.FAILED)))}),this.sendLayerRequest=A=>Lh(this,void 0,void 0,function*(){if(!this.mid)return this.logger.warn({msg:"mid is unexpectedly undefined"}),(0,ii.err)(Ea.FAILED);if(!this.layersEndpoint)return this.logger.warn({msg:"Layers endpoint is unset and required for layer requests"}),(0,ii.err)(Ea.FAILED);const O=typeof A=="string",L=O?{mediaId:this.mid,encodingId:A}:{},B=O?`set : ${A}`:"unset layer";this.logger.info({msg:`sendLayerRequest for ${B} at ${this.layersEndpoint}`});const H=this.createPostWhepRequest(L);return this.trackLayerRequest(A??"auto"),fetch(this.layersEndpoint,H).then(ne=>this.state===Za.DESTROYED?(0,ii.err)(Ea.DESTROYED):ne.status>=300?this.handleLayerRequestError(ne.status,ne.statusText):(this.logger.debug({msg:`Request to ${B} was successful: ${ne.status}`}),(0,ii.ok)(dg.SUCCESS))).catch(ne=>this.handleLayerRequestError(0,ne.message))}),this.sendLayerStateRequest=()=>Lh(this,void 0,void 0,function*(){if(!this.mid)return this.logger.warn({msg:"mid is unexpectedly undefined"}),(0,ii.err)(Ea.FAILED);if(!this.layersEndpoint)return this.logger.warn({msg:"Layers endpoint is unset and required for layer requests"}),(0,ii.err)(Ea.FAILED);this.logger.info({msg:`sendLayerStateRequest for ${this.mid} at ${this.layersEndpoint}`});const A=this.createGetWhepRequest();return this.trackLayerStateRequest(),fetch(this.layersEndpoint,A).then(O=>Lh(this,void 0,void 0,function*(){var L;if(this.state===Za.DESTROYED)return(0,ii.err)(Ea.DESTROYED);if(O.status>=300)return this.handleLayerStateRequestError(O.status,O.statusText);const B=yield O.json(),H=(L=B==null?void 0:B.layers)!==null&&L!==void 0?L:[],ne=JSON.stringify(H,null,2);return this.logger.debug({msg:`sendLayerStateRequest was successful: ${ne}`}),(0,ii.ok)(H)})).catch(O=>this.handleLayerStateRequestError(0,O.message))}),this.logger=new fo(T.logger,fe.REMOTE_PLAYBACK),this.token=T.token,this.traceId=T.traceId,this.analyticsTracker=T.analyticsTracker,this.remoteParticipantId=T.remoteParticipantId}set mediaId(T){if(this.state!==Za.DESTROYED){if(this.mid=T,this.mid===null)return this.logger.info({msg:"media id is unset, controller is transitioning to idle state"}),void(this.state=Za.IDLE);(this.playbackEndpoint||this.layersEndpoint)&&(this.state=Za.ACTIVE)}else this.logCommandSkipped("set mediaId")}set endpoints(T){var A,O;if(this.state!==Za.DESTROYED){if(this.playbackEndpoint=(A=T.playback)!==null&&A!==void 0?A:null,this.layersEndpoint=(O=T.layers)!==null&&O!==void 0?O:null,!this.playbackEndpoint||!this.layersEndpoint){const L={playbackEndpoint:this.playbackEndpoint,layersEndpoint:this.layersEndpoint};return this.logger.info({msg:`no endpoints are set, transitioning to idle state: ${JSON.stringify(L,null)}`}),void(this.state=Za.IDLE)}this.mid&&(this.state=Za.ACTIVE)}else this.logCommandSkipped("set endpoints")}destroy(){this.state=Za.DESTROYED,this.mid=null,this.playbackEndpoint=null,this.layersEndpoint=null}logCommandSkipped(T="command"){this.logger.info({msg:`skipping ${T}, controller state invalid: ${this.state}`})}mapSkippedResultFromState(T){return T===Za.DESTROYED?(0,ii.err)(Ea.DESTROYED):(0,ii.err)(Ea.FAILED)}createPostWhepRequest(T){return{method:"POST",headers:this.createRequestHeaders(),body:JSON.stringify(T)}}createGetWhepRequest(){return{method:"GET",headers:this.createRequestHeaders()}}createRequestHeaders(){var T,A;return{Authorization:`Bearer ${this.token.rawToken}`,"Content-Type":"application/json","X-Stages-Platform":"web","X-Stages-Request-ID":Na().value,"X-Stages-SDK":"1.19.0","X-Stages-Session-ID":this.analyticsTracker.getSessionId(),"X-Stages-Trace-ID":(A=(T=this.traceId)===null||T===void 0?void 0:T.value)!==null&&A!==void 0?A:"","X-Stages-WHIP-Version":Mc}}trackLayerRequest(T){var A;this.analyticsTracker.trackEventNoSharedProps(new em(this.token,this.traceId,Zt.VIDEO,this.remoteParticipantId,(A=this.mid)!==null&&A!==void 0?A:"unknown",T))}trackLayerStateRequest(T=1){var A;this.analyticsTracker.trackEventNoSharedProps(new bS(this.token,this.traceId,Zt.VIDEO,this.remoteParticipantId,(A=this.mid)!==null&&A!==void 0?A:"unknown",T))}handleLayerRequestError(T,A){const O=`sendLayerRequest failed for reason: ${T} ${A}`;let L,B;return T===429?(L=Ea.THROTTLED,B=Ut.WHEP_SET_LAYER_REQUEST_THROTTLED):(L=Ea.FAILED,B=Ut.WHEP_SET_LAYER_REQUEST_FAILED),this.trackRequestError(B,O),(0,ii.err)(L)}handleLayerStateRequestError(T,A){const O=`sendLayerStateRequest failed for reason: ${T} ${A}`;let L,B;return T===429?(L=Ea.THROTTLED,B=Ut.WHEP_GET_LAYER_STATE_THROTTLED):(L=Ea.FAILED,B=Ut.WHEP_GET_LAYER_STATE_FAILED),this.trackRequestError(B,O),(0,ii.err)(L)}trackRequestError(T,A){const O=new Error(A);this.logger.error({err:O}),T.message=A;const L=this.createError(T);this.analyticsTracker.trackError(L)}createError(T,A){return new ki(Object.assign({action:dn.SUBSCRIBE,traceId:this.traceId,token:this.token,location:"RemotePlaybackController",tag:Cc.SUBSCRIBE_RELATED,details:A},T))}}var fg,Sy,sc,Uo,Bo=function(N,T,A,O){return new(A||(A=Promise))(function(L,B){function H(Z){try{se(O.next(Z))}catch(oe){B(oe)}}function ne(Z){try{se(O.throw(Z))}catch(oe){B(oe)}}function se(Z){var oe;Z.done?L(Z.value):(oe=Z.value,oe instanceof A?oe:new A(function(de){de(oe)})).then(H,ne)}se((O=O.apply(N,[])).next())})},ES=function(N,T,A,O){if(A==="a"&&!O)throw new TypeError("Private accessor was defined without a getter");if(typeof T=="function"?N!==T||!O:!T.has(N))throw new TypeError("Cannot read private member from an object whose class did not declare it");return A==="m"?O:A==="a"?O.call(N):O?O.value:T.get(N)};(function(N){N.DISCONNECTED="disconnected",N.CONNECTING="connecting",N.CONNECTED="connected",N.ERRORED="errored"})(sc||(sc={})),function(N){N.NONE="none",N.AUDIO_ONLY="audio_only",N.AUDIO_VIDEO="audio_video"}(Uo||(Uo={}));class Ix extends cl{constructor(T,A,O,L,B,H,ne){super(),this.id=T,this.token=A,this.stageConnection=O,this.nonScopedLogger=L,this.analyticsTracker=B,this.desiredSubscribeType=H,fg.add(this),this.isSubscriptionActive=!1,this.subscriptionState={connectionState:sc.DISCONNECTED,subscribeInProgress:!1},this.previousSignalState={isTargetPublishing:!1},this.failedRetries=0,this.startConnectingTimestamp=-1,this.throttler=new X0(1e3),this.cleanupFirstFrameTracking=Z0,this.actualSubscribeType=Uo.NONE,this.action=dn.SUBSCRIBE,this.updateDesiredSubscribeType=Z=>{this.desiredSubscribeType=Z,this.attemptToActualizeSubscribeType()},this.updateSubscribeConfig=Z=>{this.peerClient.updateSubscribeConfig(Z)},this.getDesiredSubscribeType=()=>this.desiredSubscribeType,this.attemptToActualizeSubscribeType=()=>{const Z=this.actualSubscribeType,oe=this.desiredSubscribeType;this.logger.debug({msg:`Attempt to actualize subscribe type to ${oe}`}),this.subscriptionState.connectionState===sc.CONNECTED&&oe!==Uo.NONE&&Z!==oe&&this.applyVideoControlsBySubscribeType(oe,Z)},this.onParticipantUpdated=Z=>{ES(this,fg,"m",Sy).call(this,Z)&&(this.logger.debug({msg:"onParticipantUpdated",participant:Z}),this.processStateUpdate({isTargetPublishing:Z.isPublishing}))},this.onParticipantJoined=Z=>{ES(this,fg,"m",Sy).call(this,Z)&&(this.logger.debug({msg:"onParticipantJoined",participant:Z}),this.processStateUpdate({isTargetPublishing:Z.isPublishing}))},this.onParticipantLeft=Z=>{ES(this,fg,"m",Sy).call(this,Z)&&(this.logger.debug({msg:"onParticipantLeft",participant:Z}),this.processStateUpdate({isTargetPublishing:!1}))},this.requestRTCStats=Z=>Bo(this,void 0,void 0,function*(){return this.peerClient.requestRTCStats(Z)}),this.trySubscribe=Z=>Bo(this,void 0,void 0,function*(){if(this.logger.debug({msg:`Subscribe attempt started: ${Z}`}),!this.isSubscriptionActive)return this.logger.warn({msg:"Subscribe attempt invalid: Subscription is inactive"}),!1;this.logger.debug({msg:"Subscribe attempt is valid."}),this.startConnectingTimestamp<0&&(this.startConnectingTimestamp=performance.now()),this.subscriptionState.connectionState!==sc.ERRORED&&(this.logger.debug({msg:"Updating state to CONNECTING"}),this.updateState({connectionState:sc.CONNECTING}));const oe=this.stageConnection.getConnectionStats(),de=this.peerClient.getExpectedJitterBufferMinDelayInMs(),me=this.peerClient.getSfuResource();this.attemptTracker=this.subscribeTracker.trackAttempt({stageConnectionStats:oe,preAttemptSfuResource:me});try{this.remotePlaybackController.traceId=this.attemptTracker.getTraceId();const{mediaStream:Pe}=yield this.subscribe(this.attemptTracker.getTraceId()),Xe=performance.now()-this.startConnectingTimestamp,qe=this.peerClient.getSfuResource();this.remotePlaybackController.mediaId=this.peerClient.videoMediaId;const Ie=this.failedRetries;this.attemptToActualizeSubscribeType();const xe=this.peerClient.getActionMeasurements();if(this.attemptTracker.trackSubscribeStarted({sfuResource:qe,totalDurationWithRetries:Xe,retryTimes:Ie,peerClientPerfStats:xe}),Pe){this.cleanupFirstFrameTracking();const lt=this.actualSubscribeType,At=this.attemptTracker,Jt=(Nt,Qn)=>{At.trackSubscribeFirstFrame({peerClientPerfStats:xe,sfuResource:qe,totalDurationWithRetries:Xe,retryTimes:Ie,currentJitterBufferMinDelayInMs:de,mediaType:Qn,firstFrameDuration:Nt})};this.cleanupFirstFrameTracking=this.measureFirstFrameDuration({mediaStream:Pe,subscribeType:lt,callback:Jt})}return this.throttler.clear(),this.failedRetries=0,this.startConnectingTimestamp=-1,Pe&&this.emit(ve,Pe,this.remotePlaybackController),this.logger.debug({msg:"Subscribe attempt succeeded"}),!0}catch(Pe){const Xe=this.attemptTracker.trackSubscribeFailed(Pe);this.logger.error({log:"Subscribe attempt failed",err:Pe}),this.onTrySubscribeFailure(Xe,Z)}return!1});const se=wc();this.peerClient=new mv(A,this.nonScopedLogger,this.action,ko(this.action,T),se,B,T,O,ne),this.logger=new fo(L,fe.SUBSCRIPTION),this.subscribeTracker=new Ku(this.analyticsTracker,A,T),this.remotePlaybackController=new Nx({token:A,analyticsTracker:B,traceId:se,logger:this.nonScopedLogger,remoteParticipantId:this.id})}applyVideoControlsBySubscribeType(T,A){try{T===Uo.AUDIO_ONLY?this.remotePlaybackController.stopVideo().catch(O=>{this.logger.error({err:O,msg:"Remote playback request to stop video failed"})}):T===Uo.AUDIO_VIDEO&&this.remotePlaybackController.startVideo().catch(O=>{this.logger.error({err:O,msg:"Remote playback request to start video failed"})}),this.actualSubscribeType=T,this.logger.debug({msg:`Desired subscribe type actualized from ${A} to ${T}.`})}catch(O){this.logger.error({err:O,msg:`Error updating subscribe type from ${A} to ${T}.`})}}onPeerClientConnectionStateChange(T){const A=this.stageConnection.getParticipant(this.id);this.logger.debug({msg:`onPeerClientConnectionStateChange: ${T}`,state:T,targetParticipant:A}),this.processStateUpdate({peerClientState:T})}onPeerClientTransformError(T){this.emit(po,T)}processStateUpdate(T){const A=this.previousSignalState,O=Object.assign({},A,T);this.isSubscriptionActive?(O.isTargetPublishing?T.peerClientState===st.CONNECTED?this.updateState({connectionState:sc.CONNECTED,subscribeInProgress:!0}):T.peerClientState===st.FAILED&&this.subscriptionState.subscribeInProgress&&(this.attemptTracker&&this.attemptTracker.trackEndFailed(Ia.CONNECTION_FAIL),this.updateState({subscribeInProgress:!1})):(A.isTargetPublishing&&this.subscriptionState.subscribeInProgress&&(this.logger.debug({msg:"Scheduling an unsubscribe on the event loop"}),this.unsubscribe()),this.throttler.clear(),this.updateState({connectionState:sc.DISCONNECTED})),(!A.isTargetPublishing&&T.isTargetPublishing||T.peerClientState===st.FAILED)&&this.throttledTrySubscribe("onSignalState change: isTargetPublishing is now true"),Object.assign(this.previousSignalState,T)):this.logger.warn({msg:"Unexpected processStateUpdate when subscription is inactive"})}onTrySubscribeFailure(T,A){this.logger.debug({msg:"Changing/keeping state FAILED"});const O=T.fatal,L=T.code===Ut.OPERATION_ABORTED.code,B=this.failedRetries<=4;if(!L&&!O&&B){const H=1e3*Math.pow(2,this.failedRetries);this.logger.debug({msg:`Retrying in ${H}ms`}),this.failedRetries++,this.nextAttemptTimerId=window.setTimeout(()=>Bo(this,void 0,void 0,function*(){this.throttledTrySubscribe(A)}),H)}else this.updateState({connectionState:sc.ERRORED}),this.emit(Od,T),this.onTerminalFailure()}onTerminalFailure(){this.previousSignalState.isTargetPublishing=!1,this.startConnectingTimestamp=-1,this.failedRetries=0}start(){this.isSubscriptionActive=!0,this.peerClient.on(ta,this.onPeerClientConnectionStateChange,this),this.peerClient.on(B0,A=>{this.remotePlaybackController.endpoints={playback:A.mediaControls,layers:A.layerControls}}),this.peerClient.on(jp,A=>{this.emit(Oh,A)}),this.peerClient.on(ft,this.onPeerClientTransformError,this),this.stageConnection.on(W0,this.onParticipantUpdated),this.stageConnection.on(Of,this.onParticipantJoined),this.stageConnection.on(Md,this.onParticipantLeft),this.stageConnection.on(ya,this.onParticipantLeft);let T=!0;if(this.stageConnection.isConnected()){const A=this.stageConnection.getParticipant(this.id);T=!!(A!=null&&A.isPublishing)}this.processStateUpdate({isTargetPublishing:T})}throttledTrySubscribe(T){return this.throttler.invoke(this.trySubscribe,T)}updateState(T){T.subscribeInProgress!==void 0&&(this.subscriptionState.subscribeInProgress=T.subscribeInProgress),T.connectionState&&this.subscriptionState.connectionState!==T.connectionState&&(this.subscriptionState.connectionState=T.connectionState,this.emit(Zm,this.subscriptionState.connectionState))}stop(T=!1){this.peerClient.off(ta,this.onPeerClientConnectionStateChange,this),this.peerClient.off(ft,this.onPeerClientTransformError,this),this.unsubscribe(T),this.throttler.clear(),this.stageConnection.off(W0,this.onParticipantUpdated),this.stageConnection.off(Of,this.onParticipantJoined),this.stageConnection.off(Md,this.onParticipantLeft),this.stageConnection.off(ya,this.onParticipantLeft),this.isSubscriptionActive=!1,this.updateState({connectionState:sc.DISCONNECTED})}isActive(){return this.isSubscriptionActive}subscribe(T,A){return Bo(this,void 0,void 0,function*(){const{token:O,id:L}=this;O.assertTokenIsUnexpired(T,ko(dn.SUBSCRIBE,L),"subscribe",L);const{mediaStream:B}=yield this.peerClient.connect({audioOnly:A,traceId:T});return{peerClient:this.peerClient,mediaStream:B}})}unsubscribe(T=!1){return Bo(this,void 0,void 0,function*(){if(window.clearTimeout(this.nextAttemptTimerId),this.remotePlaybackController.destroy(),!this.isSubscriptionActive||!this.attemptTracker||this.subscriptionState.connectionState===sc.DISCONNECTED)return;this.cleanupFirstFrameTracking(),this.attemptTracker.trackUnsubscribe();const A=T?Ia.UNLOAD:Ia.UNSUBSCRIBE;try{T?this.peerClient.disconnect(T):yield this.peerClient.disconnect(T),this.updateState({subscribeInProgress:!1}),this.attemptTracker.trackEndSucceeded(A)}catch{this.attemptTracker.trackEndFailed(A)}})}triggerIceRestart(T){var A;return Bo(this,void 0,void 0,function*(){const O=this.stageConnection.getConnectionStats(),L=this.peerClient.getSfuResource(),B=this.subscribeTracker.trackAttempt({stageConnectionStats:O,isReassignment:!0,traceIdOverride:T.traceId,preAttemptSfuResource:L}),H=performance.now();try{this.emit(Bi),this.logger.debug({msg:`Triggering attempt. Current node: ${this.peerClient.getSfuResource().node}`}),yield this.peerClient.connect({iceRestartOptions:T,traceId:T.traceId}),this.logger.debug({msg:`Successful ICE restart attempt. Current node: ${this.peerClient.getSfuResource().node}`});const ne=performance.now()-H,se=this.peerClient.getSfuResource(),Z=this.peerClient.getActionMeasurements();(A=this.attemptTracker)===null||A===void 0||A.trackEndSucceeded(Ia.REASSIGNMENT),this.applyVideoControlsBySubscribeType(this.actualSubscribeType,this.actualSubscribeType),B.trackSubscribeStarted({totalDurationWithRetries:ne,sfuResource:se,retryTimes:0,peerClientPerfStats:Z}),this.emit(Nd)}catch(ne){this.emit(Uu),this.logger.error({msg:"ICE restart attempt failed",err:ne});const se=this.peerClient.getSfuResource(),Z=B.trackSubscribeFailed(ne,`iceRestart=true, startNode=${L.node}, endNode=${se==null?void 0:se.node}`);throw Z.code===Ut.SUBSCRIBE_TIMED_OUT.code&&this.onTrySubscribeFailure(Z,"ice restart timeout"),ne}})}measureFirstFrameDuration({mediaStream:T,subscribeType:A,callback:O}){const L=performance.now(),B=se=>{const Z=performance.now()-L;O(Z,se),se==="audio"?ne():H()};let H=Z0,ne=Z0;return A!==Uo.AUDIO_ONLY&&(H=function(se,Z){return Jm(se,"video",Z)}(T,B)),ne=function(se,Z){return Jm(se,"audio",Z)}(T,B),()=>{H(),ne()}}}var Ld,Sr;fg=new WeakSet,Sy=function(N){return N.id===this.id},function(N){N.JOIN_ERROR="JOIN_ERROR",N.PUBLISH_ERROR="PUBLISH_ERROR",N.SUBSCRIBE_ERROR="SUBSCRIBE_ERROR"}(Ld||(Ld={})),function(N){N[N.TOKEN_MALFORMED=1]="TOKEN_MALFORMED",N[N.TOKEN_EXPIRED=2]="TOKEN_EXPIRED",N[N.TIMEOUT=3]="TIMEOUT",N[N.FAILED=4]="FAILED",N[N.CANCELED=5]="CANCELED",N[N.STAGE_AT_CAPACITY=6]="STAGE_AT_CAPACITY",N[N.CODEC_MISMATCH=7]="CODEC_MISMATCH",N[N.TOKEN_NOT_ALLOWED=8]="TOKEN_NOT_ALLOWED"}(Sr||(Sr={}));const kR={[Sr.TOKEN_MALFORMED]:"Token is malformed",[Sr.TOKEN_EXPIRED]:"Token expired and is no longer valid",[Sr.TIMEOUT]:"Operation timed out",[Sr.FAILED]:"Operation failed",[Sr.CANCELED]:"Operation canceled",[Sr.STAGE_AT_CAPACITY]:"Stage at capacity",[Sr.CODEC_MISMATCH]:"Client codec is not supported",[Sr.TOKEN_NOT_ALLOWED]:"Token not allowed to perform operation"},PR={[Ut.EXPIRED_TOKEN.code]:Sr.TOKEN_EXPIRED,[Ut.MALFORMED_TOKEN.code]:Sr.TOKEN_MALFORMED,[Ut.TOKEN_PERMISSIONS_DENIED.code]:Sr.TOKEN_NOT_ALLOWED,[Ut.OPERATION_ABORTED.code]:Sr.CANCELED,[Ut.JOIN_TIMED_OUT.code]:Sr.TIMEOUT,[Ut.EVENT_PLANE_WS_CREATE_FAILED.code]:Sr.FAILED,[Ut.EVENT_PLANE_PONG_TIMEOUT.code]:Sr.FAILED,[Ut.EVENT_PLANE_WS_UNEXPECTED_CLOSE.code]:Sr.FAILED,[Ut.PUBLISH_TIMED_OUT.code]:Sr.TIMEOUT,[Ut.PUBLISH_FAILURE.code]:Sr.FAILED,[Ut.SUBSCRIBE_TIMED_OUT.code]:Sr.TIMEOUT,[Ut.SUBSCRIBE_FAILURE.code]:Sr.FAILED,[Ut.STAGE_AT_CAPACITY.code]:Sr.STAGE_AT_CAPACITY,[Ut.NO_MATCHING_CODEC.code]:Sr.CODEC_MISMATCH,[Ut.NETWORK_FAILURE.code]:Sr.FAILED,[Ut.INTERNAL_SERVER_ERROR.code]:Sr.FAILED,[Ut.REMOTE_STREAM_NOT_FOUND.code]:Sr.FAILED,[Ut.INTERNAL_MHCP_ERROR.code]:Sr.FAILED,[Ut.UNREACHABLE_MHCP.code]:Sr.FAILED,[Ut.INVALID_SESSION_STATUS.code]:Sr.FAILED,[Ut.MHCP_ABORTED.code]:Sr.FAILED};class DR extends Error{constructor(T,A,O){super(),this.code=T,this.category=A,this.message=O,this.name="StageError",this.errorDetails=[],this.message=`[${A}] ${O}`}addDetails(T){this.errorDetails.push(T)}get details(){return this.errorDetails.length?JSON.stringify(this.errorDetails):""}toString(){return`
${this.message}
details - ${this.details}
        `.trim()}}var pg,mg,gv;(function(N){N.ERROR="error"})(pg||(pg={}));class LR extends cl{constructor(){super(...arguments),this.handleError=(T,A,O=!0)=>{let L;if(T instanceof ki){const B=PR[T.code];B&&(L=function(H,ne,se){var Z,oe;const de=kR[H],me=new DR(H,ne,de);return me.addDetails({stageErrorMessage:de,stageErrorCode:H,stageErrorCategory:ne,stageArn:(Z=se.token)===null||Z===void 0?void 0:Z.stageARN,traceId:(oe=se.traceId)===null||oe===void 0?void 0:oe.value,causeCode:se.code,causeDetails:se.details,causeMessage:se.message,causeLocation:se.location}),me}(B,A,T))}if(L)return O&&this.emit(pg.ERROR,L),L}}}(function(N){N.INTERNAL="internal",N.API="api"})(mg||(mg={})),function(N){N.ADDITIVE="additive",N.REPLACE="replace"}(gv||(gv={}));class UR{constructor(T){this.logger=new fo(T.logger,fe.CONNECTION),this.subscribeConfig={defaults:T.subscribeDefaults,participants:{}}}handleSubscribeConfigUpdate(T,A,O,L=gv.REPLACE){A=(oe=>{const de=sg(oe);if(de.jitterBuffer!==void 0){const me=Pe=>{if(typeof Pe=="number"){if(Pe<0)return 0;if(Pe>4e3)return 4e3}return Pe};de.jitterBuffer.minDelayWhenPublishing!==void 0&&(de.jitterBuffer.minDelayWhenPublishing=me(de.jitterBuffer.minDelayWhenPublishing)),de.jitterBuffer.minDelayWhenSubscribeOnly!==void 0&&(de.jitterBuffer.minDelayWhenSubscribeOnly=me(de.jitterBuffer.minDelayWhenSubscribeOnly))}return de})(A),this.subscribeConfig.participants[T]===void 0&&(this.subscribeConfig.participants[T]={internalOverrides:{},apiOverrides:{},lastMerged:this.subscribeConfig.defaults});const B=this.subscribeConfig.participants[T];switch(O){case mg.INTERNAL:B.internalOverrides=this.handleSubscribeConfigLevelMerging(B.internalOverrides,A,L);break;case mg.API:B.apiOverrides=this.handleSubscribeConfigLevelMerging(B.apiOverrides,A,L);break;default:(function(oe){throw new Error(`Unknown case kind: ${oe}`)})(O)}const H=hS(this.subscribeConfig.defaults,B.internalOverrides,B.apiOverrides);if(H===void 0)return this.logger.warn({msg:`Unable to merge subscribe configs for participant: ${T} | ${B}, ${A}`}),!1;const ne=(se=B.lastMerged,Z=H,(typeof se=="object"&&typeof Z=="object"&&(0,_a.isEqual)(se,Z))===!1);var se,Z;return B.lastMerged=H,this.subscribeConfig.participants[T]=B,ne}handleExternalSubscribeConfigUpdate(T,A,O,L=gv.REPLACE){const B=(H=>{const ne={};return typeof H!="object"?ii.err(new Error("Invalid input")):(H.jitterBuffer!==void 0&&(ne.jitterBuffer={},H.jitterBuffer.minDelay!==void 0&&(ne.jitterBuffer.minDelayWhenSubscribeOnly=H.jitterBuffer.minDelay)),H.inBandMessaging!==void 0&&(ne.inBandMessaging={enabled:H.inBandMessaging.enabled===!0}),H.simulcast!==void 0&&(ne.simulcast={},H.simulcast.initialLayerPreference!==void 0&&(ne.simulcast.initialLayerPreference=H.simulcast.initialLayerPreference)),ii.ok(ne))})(A);return B.ok===!0&&this.handleSubscribeConfigUpdate(T,B.value,O,L)}handleSubscribeConfigLevelMerging(T,A,O){if(O===gv.REPLACE)return A;{const L=hS(T,A);return L===void 0?(this.logger.warn({msg:`Unable to merge '${T}' and '${A}' with type ${O}`}),T):L}}getSubscribeConfigSnapshot(T){return this.subscribeConfig.participants[T]===void 0?bi(this.subscribeConfig.defaults):bi(this.subscribeConfig.participants[T].lastMerged)}}class kx extends Yn{constructor(T){super(Sn.REASSIGNMENT_REQUEST,T.token,T.traceId,!1),Object.assign(this.properties,{target_local_participant_id:T.targetLocalParticipantId,target_remote_participant_id:T.targetRemoteParticipantId}),this.critical=!0}}var Xu,Zu,vo,Uh,Ud,Bh,Ks,ac,SS=function(N,T,A,O){return new(A||(A=Promise))(function(L,B){function H(Z){try{se(O.next(Z))}catch(oe){B(oe)}}function ne(Z){try{se(O.throw(Z))}catch(oe){B(oe)}}function se(Z){var oe;Z.done?L(Z.value):(oe=Z.value,oe instanceof A?oe:new A(function(de){de(oe)})).then(H,ne)}se((O=O.apply(N,[])).next())})};class vv extends cl{constructor(T,A){super(),this.setGetStats=O=>{this.getInternalStats=O},this.getStats=()=>SS(this,void 0,void 0,function*(){return this.requestRTCStats()}),this.requestRTCStats=()=>SS(this,void 0,void 0,function*(){if(this.getInternalStats)return this.getInternalStats(this.mediaStreamTrack)}),this.getInternalStats=A,this.id=T.id,this.isMuted=!T.enabled,this.mediaStreamTrack=T,this.streamType=this.mediaStreamTrack.kind==="audio"?Zt.AUDIO:Zt.VIDEO}cleanup(){this.removeAllListeners(),this.getInternalStats=void 0}}(function(N){N.IDLE="IDLE",N.INITIALIZING="INITIALIZING",N.ACTIVE="ACTIVE",N.CONTROLS_PAUSED="CONTROLS_PAUSED",N.DESTROYED="DESTROYED"})(Xu||(Xu={})),function(N){N.LAYERS_CHANGED="LAYERS_CHANGED",N.LAYER_SELECTED="LAYER_SELECTED",N.ADAPTION_CHANGED="ADAPTION_CHANGED"}(Zu||(Zu={})),function(N){N.LAYERS_CHANGED="LAYERS_CHANGED",N.LAYER_SELECTED="LAYER_SELECTED",N.ADAPTION_CHANGED="ADAPTION_CHANGED"}(vo||(vo={})),function(N){N.UNAVAILABLE="unavailable",N.SELECTED="selected"}(Uh||(Uh={})),function(N){N.LOCAL_STREAM_MUTE_CHANGED="localStreamMutedChanged"}(Ud||(Ud={}));class TS extends vv{constructor(T,A){super(T),this.setMuted=O=>{O!==this.isMuted&&(this.mediaStreamTrack.enabled=!O,this.isMuted=O,this.emit(Ud.LOCAL_STREAM_MUTE_CHANGED,this))},this.mediaConfig=Rx(T,A)}}class BR{constructor(T,A){this.strategy=T,this.logger=A}setStrategy(T){this.strategy=T}stageStreamsToPublish(){let T=[];try{T=this.strategy.stageStreamsToPublish(),T=T.filter(L=>L instanceof TS)}catch(L){return this.logger.warn({msg:"error executing stageStreamsToPublish treating this as a no-op",err:L}),console.error("Error executing stageStreamsToPublish",L),ii.err(L)}let A=0,O=0;for(const L of T)L.mediaStreamTrack.kind==="audio"?A++:L.mediaStreamTrack.kind==="video"&&O++;if(A>1||O>1){const L=Error("stageStreamsToPublish strategy function returned more than 1 video or audio stream and as a result will not publish",{cause:"UserStrategy"});return ii.err(L)}return ii.ok(T)}shouldPublishParticipant(T){try{return ii.ok(this.strategy.shouldPublishParticipant(T))}catch(A){return this.logger.warn({msg:"error executing shouldPublishParticipant treating this as a no-op",err:A}),console.error("Error executing shouldPublishParticipant",A),ii.err(A)}}shouldSubscribeToParticipant(T){try{return ii.ok(this.strategy.shouldSubscribeToParticipant(T))}catch(A){return this.logger.warn({msg:"error executing shouldSubscribeToParticipant. Treating it as a no-op",err:A}),console.error("Error executing shouldSubscribeToParticipant",A),ii.err(A)}}subscribeConfiguration(T){var A,O;try{return ii.ok((O=(A=this.strategy).subscribeConfiguration)===null||O===void 0?void 0:O.call(A,T))}catch(L){return this.logger.warn({msg:"error executing subscribeConfiguration. Treating it as a no-op",err:L}),console.error("Error executing subscribeConfiguration",L),ii.err(L)}}preferredLayerForStream(T,A){var O,L;try{return ii.ok((L=(O=this.strategy).preferredLayerForStream)===null||L===void 0?void 0:L.call(O,T,A))}catch(B){return this.logger.warn({msg:"error executing preferredLayerForStream. Treating it as a no-op",err:B}),console.error("Error executing preferredLayerForStream",B),ii.err(B)}}}class Px extends cl{constructor(T,A){super(),this.audioMuted=!0,this.videoStopped=!0,this.publishState=Ks.NOT_PUBLISHED,this.logger=A,this.info=T,this.audioMuted=T.audioMuted,this.videoStopped=T.videoStopped}}(function(N){N.PUBLISH="publish",N.SUBSCRIBE="subscribe"})(Bh||(Bh={})),function(N){N.NOT_PUBLISHED="not_published",N.ATTEMPTING_PUBLISH="attempting_publish",N.PUBLISHED="published",N.ERRORED="errored"}(Ks||(Ks={})),function(N){N.NOT_SUBSCRIBED="not_subscribed",N.ATTEMPTING_SUBSCRIBE="attempting_subscribe",N.SUBSCRIBED="subscribed",N.ERRORED="errored"}(ac||(ac={}));const Ty=1e3;function xS(N){return N.map(T=>T.remote)}function FR(N){return{label:N.encodingId,bitrateBps:N.bitrate*Ty,width:N.width,height:N.height,framesPerSecond:N.framesPerSecond,selected:N.selected}}function ka(N,T){const A=N.width*N.height,O=T.width*T.height;return A>O||N.bitrateBps>T.bitrateBps||N.framesPerSecond>T.framesPerSecond?1:A===O||N.bitrateBps===T.bitrateBps||N.framesPerSecond>T.framesPerSecond?0:-1}var gg,xy,wS=function(N,T,A,O){return new(A||(A=Promise))(function(L,B){function H(Z){try{se(O.next(Z))}catch(oe){B(oe)}}function ne(Z){try{se(O.throw(Z))}catch(oe){B(oe)}}function se(Z){var oe;Z.done?L(Z.value):(oe=Z.value,oe instanceof A?oe:new A(function(de){de(oe)})).then(H,ne)}se((O=O.apply(N,[])).next())})};class CS extends cl{constructor(T){super(),this.setGetStats=()=>{},this.requestRTCStats=()=>this.internalStream.requestRTCStats(),this.getStats=()=>wS(this,void 0,void 0,function*(){return this.internalStream.requestRTCStats()}),this.setMuted=A=>{this.internalStream.setMuted(A)},this.getLayers=()=>this.internalStream.layers,this.getSelectedLayer=()=>this.internalStream.selectedLayer,this.getLowestQualityLayer=()=>this.internalStream.lowestQualityLayer,this.getHighestQualityLayer=()=>this.internalStream.highestQualityLayer,this.internalStream=T,this.internalStream.on(Zu.ADAPTION_CHANGED,A=>{this.emit(vo.ADAPTION_CHANGED,A)}),this.internalStream.on(Zu.LAYERS_CHANGED,A=>{this.emit(vo.LAYERS_CHANGED,A)}),this.internalStream.on(Zu.LAYER_SELECTED,(A,O)=>{this.emit(vo.LAYER_SELECTED,A,O)})}get id(){return this.internalStream.id}get participantInfo(){return this.internalStream.participantInfo}get streamType(){return this.internalStream.streamType}get mediaStreamTrack(){return this.internalStream.mediaStreamTrack}get isMuted(){return this.internalStream.isMuted}set isMuted(T){this.internalStream.setMuted(T)}get isAdapting(){return this.internalStream.isAdapting}cleanup(){this.removeAllListeners()}}class AS extends vv{constructor({track:T,info:A,getStats:O,remotePlaybackController:L,analyticsTracker:B,token:H}){super(T,O),this.setMuted=se=>{this.isMuted=se},this.setLayer=se=>{const Z=(0,_a.cloneDeep)(se);if(this.queueLayerUpdateForValidState(Z))return void this.logger.debug({msg:`setLayer:${Z} queued, skipping for now`});const oe=function(me,Pe){if(!me)return(0,ii.ok)(void 0);const Xe=typeof me=="string"?me:me.label,qe=Pe.filter(Ie=>Ie.label===Xe)[0];return qe?(0,ii.ok)(qe):(0,ii.err)(`Provided layer with id ${Xe} does not exist`)}(Z,this._layers);if(!oe.ok){const me=oe.error;return void this.logger.error({err:me,msg:"Unable to select layer, skipping skipping selection"})}const de=oe.value;if(this.isNextUpdateAdaptionOnly(de))return this.logger.warn({msg:"setLayer:dynamic"}),void this.handleDynamicUpdate();this.isFirstLayerUpdate()||!this.isRepeatLayerSelection(de)||this.isAdapting?de&&(this.logger.warn({msg:`setLayer:${JSON.stringify(de)} `}),this.handleManualUpdate(de)):this.logger.debug({msg:"Setting the same layer, same adaption state, skipping selection"})},this.state=Xu.INITIALIZING,this.prevState=Xu.IDLE,this.analyticsTracker=B,this.token=H,this.id=T.id,this.info=A,this.mediaStreamTrack=T,this.remotePlaybackController=L,this.layerPollingTimeoutId=null,this.weakRemoteMap=new WeakMap,this.weakRemoteKey={id:"remote"},this.commandMap=new Map,this._isAdapting=!0,this._layers=[],this._selectedLayer=null;const ne=k0();this.logger=new fo(new qm(ne),fe.REMOTE_STAGE_STREAM),this.streamType===Zt.AUDIO?this.isMuted=A.audioMuted:this.isMuted=A.videoStopped,this.initializeLayerPolling(),this.pollInternalLayers()}transitionStateTo(T){this.state!==T&&(this.prevState=this.state,this.state=T)}initializeLayerPolling(){this.streamType!==Zt.AUDIO?(this.logger.debug({msg:"Setting up RemoteStageStream, requesting initial layers"}),this.layerPollingTimeoutId=setInterval(()=>{this.pollInternalLayers()},3e3)):this.logger.debug({msg:"Skipping initializing polling for audio streams"})}startLayerPolling(){this.layerPollingTimeoutId===null?this.initializeLayerPolling():this.logger.debug({msg:"Skipping start polling request, already started"})}stopLayerPolling(){this.layerPollingTimeoutId!==null?(clearInterval(this.layerPollingTimeoutId),this.layerPollingTimeoutId=null):this.logger.debug({msg:"Skipping stop polling request, already stopped"})}pollInternalLayers(){this.streamType!==Zt.AUDIO?this.remotePlaybackController.getLayers().then(T=>{if(this.isStateValidForLayerUpdates()){if(!T.ok)throw Error(T.error);this.updateInternalLayersFromRemote(T.value),this.transitionStateTo(Xu.ACTIVE),this.flushCommandQueue()}else this.logger.warn({msg:"Stream controls have been paused, skipping getLayers"})}).catch(T=>{this.logger.error({err:T,msg:"Error calling getLayers, returning current layers"})}):this.logger.debug({msg:"Skipping layer poll request for audio stream"})}updateInternalLayersFromRemote(T){const A=this._layers,O=T.map(FR).sort(ka),L=!(0,_a.isEqual)(O,A);this._layers=O;const B=this._selectedLayer,H=this._layers.filter(se=>se.selected)[0],ne=!(0,_a.isEqual)(H,B);B&&(B.selected=!1),this._selectedLayer=H,ne&&(this.trackLayerUpdate(B),this.trackLayerUpdate(H)),this.isCommandQueueEmpty()&&(L&&this.emitLayersChanged(),ne&&this.emitLayerSelected(H))}flushCommandQueue(){if(this.isCommandQueueEmpty())return;const T=Array.from(this.commandMap.keys());this.logger.debug({msg:`Flushing active commands from map ${T}`});for(const A of this.commandMap.keys()){const O=this.commandMap.get(A);O==null||O()}this.commandMap.clear()}queueLayerUpdateForValidState(T){if(!T)return this.commandMap.delete("setLayer"),!1;if(this.state===Xu.INITIALIZING){const A=this.setLayer.bind(this,T);return this.commandMap.set("setLayer",A),!0}return!1}handleDynamicUpdate(){if(!this.isStateValidForLayerUpdates())return void this.logger.warn({msg:"Stream controls have been paused, skipping dynamic mode transition"});const T=this._isAdapting;this._isAdapting=!0,this.emitAdaptionChanged(),this.remotePlaybackController.unsetLayer().then(A=>{if(!this.isStateValidForLayerUpdates())return this.logger.warn({msg:"Stream controls have been paused, skipping dynamic mode transition"}),void this.resetAdaptionStateOnError(T,`Stream in invalid state: ${this.state}`);A.ok?this.logger.debug({msg:"Layer successfully unset, restarting dynamic adaption"}):this.resetAdaptionStateOnError(T,A.error)}).catch(()=>{})}resetAdaptionStateOnError(T,A){this._isAdapting=T,this.emitAdaptionChanged(),this.logger.error({err:A,msg:"Error unsetting layer, reverting adaption state"})}handleManualUpdate(T){if(!this.isStateValidForLayerUpdates())return void this.logger.warn({msg:"Stream controls have been paused, skipping manual updates"});const A=this._isAdapting,O=this._selectedLayer;O&&(O.selected=!1),this._isAdapting=!1,this._selectedLayer=T,T.selected=!0,A!==this._isAdapting&&this.emitAdaptionChanged(),this.updateLocalLayerStateBeforeRemote(T,O),this.trackLayerUpdate(O),this.trackLayerUpdate(T),this.emitLayersChanged(),this.emitLayerSelected(T),this.remotePlaybackController.setLayer(T.label).then(L=>{if(!this.isStateValidForLayerUpdates()){this.logger.warn({msg:"Stream controls have been paused, skipping dynamic mode transition"});const B=`Stream in invalid state: ${this.state}`;return this.resetAdaptionStateOnError(A,B),void this.resetLayerOnError(O,T,B)}if(!L.ok){const B=L.error;return this.resetAdaptionStateOnError(A,B),void this.resetLayerOnError(O,T,B)}this.logger.debug({msg:`Layer successfully selected: ${T.label}`})}).catch(()=>{})}applyExistingControlState(){var T;this._isAdapting?this.remotePlaybackController.unsetLayer().then(()=>{}).catch(()=>{}):!((T=this._selectedLayer)===null||T===void 0)&&T.label&&this.remotePlaybackController.setLayer(this._selectedLayer.label).then(()=>{}).catch(()=>{})}resetLayerOnError(T,A,O){A&&(A.selected=!1),T&&(T.selected=!0),this._selectedLayer=T,this.logger.error({err:O,msg:"Error unsetting layer, leaving current selection in place"}),this.updateLocalLayerStateBeforeRemote(T,A),this.emitLayersChanged(),T!==null&&this.emitLayerSelected(T,Uh.UNAVAILABLE),this.trackLayerUpdate(A),this.trackLayerUpdate(T)}updateLocalLayerStateBeforeRemote(T,A){this._layers=this._layers.map(O=>O.label===(T==null?void 0:T.label)?T:O.label===(A==null?void 0:A.label)?A:O).sort(ka)}trackLayerUpdate(T){var A,O;this.analyticsTracker.trackEventNoSharedProps(new sv(this.token,wc(),(A=T==null?void 0:T.label)!==null&&A!==void 0?A:"auto",!0,dn.SUBSCRIBE,(O=T==null?void 0:T.selected)!==null&&O!==void 0&&O,this.info.id))}isNextUpdateAdaptionOnly(T){return T===void 0&&this.isFirstLayerUpdate()||T===void 0&&!this.isAdapting}isFirstLayerUpdate(){return this._selectedLayer===null}isRepeatLayerSelection(T){var A;return((A=this._selectedLayer)===null||A===void 0?void 0:A.label)===(T==null?void 0:T.label)}isStateValidForLayerUpdates(){return this.state===Xu.ACTIVE||this.state===Xu.INITIALIZING}isCommandQueueEmpty(){return this.commandMap.size===0}emitLayerSelected(T,A=Uh.SELECTED){this.logger.debug({msg:`Emitting layers selected ${JSON.stringify(T,null,2)}`}),this.emit(Zu.LAYER_SELECTED,(0,_a.cloneDeep)(T),A)}emitLayersChanged(){this.emit(Zu.LAYERS_CHANGED,(0,_a.cloneDeep)(this._layers))}emitAdaptionChanged(){this.emit(Zu.ADAPTION_CHANGED,this._isAdapting)}get remote(){const T=this.weakRemoteMap.get(this.weakRemoteKey);if(T)return T;const A=new CS(this);return this.weakRemoteMap.set(this.weakRemoteKey,A),A}get participantInfo(){return(0,_a.cloneDeep)(this.info)}get isAdapting(){return this._isAdapting}get layers(){return(0,_a.cloneDeep)(this._layers)}get selectedLayer(){var T;return(0,_a.cloneDeep)((T=this._selectedLayer)!==null&&T!==void 0?T:void 0)}get highestQualityLayer(){return(0,_a.cloneDeep)(this.layers[this.layers.length-1])}get lowestQualityLayer(){return(0,_a.cloneDeep)(this.layers[0])}pauseControls(){this.transitionStateTo(Xu.CONTROLS_PAUSED),this.stopLayerPolling()}resumeControls(){this.applyExistingControlState(),this.startLayerPolling(),this.transitionStateTo(Xu.ACTIVE)}cleanup(){this.transitionStateTo(Xu.DESTROYED),super.cleanup(),this.stopLayerPolling(),this._layers=[],this._selectedLayer=null,this._isAdapting=!0,this.commandMap.clear()}}(function(N){N.STATE_CHANGE="stateChange",N.MEDIA_STREAM_ADDED="mediaStreamAdded",N.MEDIA_STREAM_REMOVED="mediaStreamRemoved",N.MEDIA_STREAM_MUTE_CHANGED="mediaStreamMuteChanged",N.ERROR="error"})(gg||(gg={})),function(N){N.SUBSCRIPTION_STATE_CHANGE="subscriptionStateChange",N.MEDIA_STREAM_SEI_MESSAGE_RECEIVED="mediaStreamSeiMessageReceived"}(xy||(xy={}));const _o=Object.assign(Object.assign({},gg),xy);var Lf;(function(N){N.PUBLICATION_STATE_CHANGE="publicationStateChange"})(Lf||(Lf={}));const oc=Object.assign(Object.assign({},gg),Lf);var cc=function(N,T,A,O){return new(A||(A=Promise))(function(L,B){function H(Z){try{se(O.next(Z))}catch(oe){B(oe)}}function ne(Z){try{se(O.throw(Z))}catch(oe){B(oe)}}function se(Z){var oe;Z.done?L(Z.value):(oe=Z.value,oe instanceof A?oe:new A(function(de){de(oe)})).then(H,ne)}se((O=O.apply(N,[])).next())})};class zR extends Px{constructor(T,A,O,L,B,H,ne,se=!1){super(T,new fo(L,fe.REMOTE_PARTICIPANT)),this.subscribeState=ac.NOT_SUBSCRIBED,this.reassigning=!1,this.streams=[],this.left=!1,this.onSubscriptionStateChange=Z=>{this.logger.debug({msg:"subscriptionStateChange",state:Z}),Z===sc.DISCONNECTED?this.updateSubscriptionState(ac.NOT_SUBSCRIBED):Z===sc.CONNECTED?this.updateSubscriptionState(ac.SUBSCRIBED):Z===sc.CONNECTING?this.updateSubscriptionState(ac.ATTEMPTING_SUBSCRIBE):Z===sc.ERRORED?this.updateSubscriptionState(ac.ERRORED):this.logger.warn({msg:"FIXME onSubscriptionStateChange UNHANDLED STATE",state:Z})},this.onSubscriptionMediaStream=(Z,oe)=>{this.logger.debug({msg:"onSubscriptionMediaStream",stream:Z});let de=Z.getTracks().map(me=>{const Pe=new AS({track:me,info:this.info,getStats:this.subscription.requestRTCStats,remotePlaybackController:oe,analyticsTracker:this.analyticsTracker,token:this.token});return this.streams.push(Pe),Pe});this.subscription.getDesiredSubscribeType()===Uo.AUDIO_ONLY&&(de=de.filter(me=>me.streamType!==Zt.VIDEO)),this.emit(_o.MEDIA_STREAM_ADDED,de)},this.onSubscriptionError=Z=>{this.emit(_o.ERROR,Z)},this.onSubscriptionSeiMessageReceived=Z=>{this.emit(_o.MEDIA_STREAM_SEI_MESSAGE_RECEIVED,Z)},this.onSubscriptionTransformError=Z=>{this.emit(_o.ERROR,Z)},this.onSubscriptionReassignmentStart=()=>{for(const Z of this.streams)Z.pauseControls()},this.onSubscriptionReassignmentDone=()=>{for(const Z of this.streams)Z.resumeControls()},this.updateSubscribeStateIfNecessary=(Z,oe)=>{if(!this.info.capabilities.has(Bh.SUBSCRIBE))return;oe!==void 0&&this.subscription.updateSubscribeConfig(oe);const de=Z!==Uo.NONE&&this.publishState===Ks.PUBLISHED,me=this.subscribeState!==ac.NOT_SUBSCRIBED&&this.subscribeState!==ac.ERRORED;if(de&&!me)this.subscription.updateDesiredSubscribeType(Z),this.subscribe();else if(!de&&me)this.unsubscribe(),this.subscription.updateDesiredSubscribeType(Z);else if(this.subscribeState===ac.SUBSCRIBED&&this.subscription.getDesiredSubscribeType()!==Z)try{Z===Uo.AUDIO_ONLY?this.emit(_o.MEDIA_STREAM_REMOVED,this.streams.filter(Pe=>Pe.streamType===Zt.VIDEO)):Z===Uo.AUDIO_VIDEO&&this.emit(_o.MEDIA_STREAM_ADDED,this.streams.filter(Pe=>Pe.streamType===Zt.VIDEO)),this.subscription.updateDesiredSubscribeType(Z)}catch(Pe){this.logger.error({err:Pe,msg:"error updating subscribe type"})}},this.updatePublishState=Z=>{const oe=Z&&this.publishState===Ks.PUBLISHED,de=!Z&&this.publishState===Ks.NOT_PUBLISHED;return!oe&&!de&&(this.info.isPublishing=Z,this.publishState=Z?Ks.PUBLISHED:Ks.NOT_PUBLISHED,!0)},this.updateStreamState=(Z,oe)=>{this.audioMuted!==Z&&(this.audioMuted=Z,this.info.audioMuted=Z,this.updateStreamMuteState(Zt.AUDIO,Z)),this.videoStopped!==oe&&(this.videoStopped=oe,this.info.videoStopped=oe,this.updateStreamMuteState(Zt.VIDEO,oe))},this.updateStreamMuteState=(Z,oe)=>{const de=this.streams.find(me=>me.streamType===Z);de?(de.setMuted(oe),this.emit(_o.MEDIA_STREAM_MUTE_CHANGED,de)):this.logger.warn({msg:`tried to update mute state for ${Z} stream on participant ${this.info.id} that didn't exist`})},this.cleanup=()=>{for(const Z of this.streams)Z.remote.removeAllListeners(),Z.removeAllListeners();this.removeAllListeners()},this.quickUnsubscribe=()=>this.subscribeState!==ac.NOT_SUBSCRIBED&&this.subscription.stop(!0),this.getDesiredSubscribeType=()=>this.subscription.getDesiredSubscribeType(),this.isReassigning=()=>this.reassigning,this.analyticsTracker=ne,this.token=A,this.createSubscription=()=>{const Z=new Ix(T.id,A,O,L,ne,B,H);return Z.on(Zm,this.onSubscriptionStateChange),Z.on(ve,this.onSubscriptionMediaStream),Z.on(Od,this.onSubscriptionError),Z.on(Oh,this.onSubscriptionSeiMessageReceived),Z.on(po,this.onSubscriptionTransformError),Z.on(Bi,this.onSubscriptionReassignmentStart),Z.on(Nd,this.onSubscriptionReassignmentDone),Z.on(Uu,this.onSubscriptionReassignmentDone),Z},this.subscription=this.createSubscription(),se&&(this.publishState=Ks.PUBLISHED)}updateSubscriptionState(T){T!==this.subscribeState&&(this.subscribeState=T,this.emit(_o.SUBSCRIPTION_STATE_CHANGE,this.subscribeState))}participantLeave(){this.left=!0}subscribe(){this.left?this.logger.warn({msg:"tried to subscribe to a participant that left"}):(this.updateSubscriptionState(ac.ATTEMPTING_SUBSCRIBE),this.logger.debug({msg:"subscribe"}),this.subscription.start())}unsubscribe(){if(this.subscribeState===ac.NOT_SUBSCRIBED)return;this.logger.debug({msg:"unsubscribe"}),this.subscription.stop(),this.subscription.off(Zm,this.onSubscriptionStateChange),this.subscription.off(ve,this.onSubscriptionMediaStream),this.subscription.off(Od,this.onSubscriptionError),this.subscription.off(po,this.onSubscriptionTransformError);const T=this.getDesiredSubscribeType();this.subscription=this.createSubscription(),T===Uo.AUDIO_ONLY?this.emit(_o.MEDIA_STREAM_REMOVED,this.streams.filter(A=>A.streamType===Zt.AUDIO)):this.emit(_o.MEDIA_STREAM_REMOVED,this.streams),this.updateSubscriptionState(ac.NOT_SUBSCRIBED),this.streams.forEach(A=>{A.cleanup()}),this.streams=[]}triggerIceRestart(T){return cc(this,void 0,void 0,function*(){this.reassigning=!0;try{yield this.subscription.triggerIceRestart(T)}finally{this.reassigning=!1}})}}const wy=dn.PUBLISH;class _v{constructor(T,A){this.analyticsTracker=T,this.token=A,this.action=wy,this.traceId=wc()}trackPublish(T){const{action:A,traceId:O,analyticsTracker:L,token:B}=this;return L.trackEvent(new qu({token:B,traceId:O})),{getTraceId:()=>O,trackPublishStarted({totalDurationWithRetries:H,retryTimes:ne,sfuResource:se,peerClientPerfStats:Z}){const{optionsDuration:oe,postDuration:de,timeToCandidate:me,timeToConnected:Pe,sdpExchangeDuration:Xe,sdpExchangeTransport:qe,setRemoteDescDuration:Ie,peerConnectionDuration:xe}=Z,{edpInitialConnectDuration:lt,edpInitialConnectRetries:At,edpInitialStateDuration:Jt,edpStateUpdateCount:Nt}=T;L.trackEvent(new wx({token:B,traceId:O,optionsDuration:oe,postDuration:de,timeToCandidate:me,totalDuration:Pe,edpInitialConnectDuration:lt,edpInitialConnectRetries:At,edpInitialStateDuration:Jt,edpStateUpdateCount:Nt,sdpExchangeDuration:Xe,sdpExchangeTransport:qe,setRemoteDescDuration:Ie,peerConnectionDuration:xe,publishRetries:ne,totalDurationWithRetries:H,sfuResource:se}))},trackPublishFailed(H){const ne=((Z,oe,de)=>{if(Z instanceof ki)return Z;let me="";return Z instanceof Ms.AxiosError&&(me+=`AxiosError - ${Z.code}`),new ki(Object.assign(Object.assign(Object.assign({},Ut.PUBLISH_FAILURE),{action:wy,token:oe,traceId:de,tag:Cc.PUBLISH_RELATED,location:"publish",details:`${me} ${Z.message}`}),{fatal:!0}))})(H,B,O);L.trackEvent(new Cx({token:B,traceId:O,code:ne.code,message:ne.message,fatal:ne.fatal,nominal:ne.nominal}));const se=new ki(Object.assign(Object.assign({},Ut.PUBLISH_FAILURE),{action:A,token:B,traceId:O,tag:Cc.PUBLISH_RELATED,location:"publish"}));return H instanceof ki&&(se.fatal=H.fatal,se.nominal=H.nominal,se.location=`publish > ${H.location}`),L.trackError(se),ne},trackUnpublish:()=>{L.trackEvent(new Df({token:B,traceId:O}))},trackEndSucceeded:H=>{L.trackEvent(new Zp({token:B,isUnpublishSuccessful:!0,traceId:O,reason:H}))},trackEndFailed:H=>{const ne=new ki(Object.assign(Object.assign({},Ut.UNPUBLISH_FAILURE),{token:B,traceId:O,tag:Cc.UNPUBLISH_RELATED,location:"unpublish"}));return H!==Ia.UNLOAD&&H!==Ia.UNPUBLISH||this.analyticsTracker.trackError(ne),L.trackEvent(new Zp({token:B,isUnpublishSuccessful:!1,traceId:O,reason:H})),ne}}}}var Ja,Bs,Fh=function(N,T,A,O){return new(A||(A=Promise))(function(L,B){function H(Z){try{se(O.next(Z))}catch(oe){B(oe)}}function ne(Z){try{se(O.throw(Z))}catch(oe){B(oe)}}function se(Z){var oe;Z.done?L(Z.value):(oe=Z.value,oe instanceof A?oe:new A(function(de){de(oe)})).then(H,ne)}se((O=O.apply(N,[])).next())})};(function(N){N.DISCONNECTED="disconnected",N.CONNECTING="connecting",N.CONNECTED="connected",N.ERRORED="errored"})(Ja||(Ja={})),function(N){N.STATE_CHANGE="stateChange",N.ERROR="error",N.TRANSFORM_ERROR="transformError"}(Bs||(Bs={}));class jR extends cl{constructor(T,A,O,L){super(),this.token=T,this.stageConnection=A,this.nonScopedLogger=O,this.analyticsTracker=L,this.tracksToPublish=[],this.publicationState=Ja.DISCONNECTED,this.latestPubAttemptNum=0,this.startConnectingTimestamp=-1,this.action=dn.PUBLISH,this.start=B=>{this.publicationState===Ja.DISCONNECTED||this.publicationState===Ja.ERRORED?(this.tracksToPublish=B,this.latestPubAttemptNum=0,this.processStateUpdate()):this.logger.warn({msg:"publication cannot be started if not in disconnected or error state"})},this.requestRTCStats=B=>Fh(this,void 0,void 0,function*(){return this.peerClient.requestRTCStats(B)}),this.stop=(B=!1)=>Fh(this,void 0,void 0,function*(){this.peerClient.off(ta,this.onPeerClientConnectionStateChange,this),this.peerClient.off(ft,this.onPeerClientTransformError,this),yield this.unpublish(B),this.updateState(Ja.DISCONNECTED)}),this.processStateUpdate=B=>{const{publicationState:H}=this;H===Ja.DISCONNECTED||H===Ja.ERRORED?this.latestPubAttemptNum===0&&(this.startConnectingTimestamp=performance.now(),this.updateState(Ja.CONNECTING),this.tryPublish()):H===Ja.CONNECTING?B===st.CONNECTED&&this.updateState(Ja.CONNECTED):H===Ja.CONNECTED&&B===st.FAILED&&(this.attemptTracker&&this.attemptTracker.trackEndFailed(Ia.CONNECTION_FAIL),this.latestPubAttemptNum===0&&(this.startConnectingTimestamp=performance.now(),this.updateState(Ja.CONNECTING),this.tryPublish()))},this.updateState=B=>{this.publicationState=B,this.emit(Bs.STATE_CHANGE,B)},this.tryPublish=()=>Fh(this,void 0,void 0,function*(){if(this.latestPubAttemptNum++,this.latestPubAttemptNum<=4){const B=this.stageConnection.getConnectionStats();this.attemptTracker=this.publishTracker.trackPublish(B);try{this.logger.debug({msg:`attempting to publish, attemptNum: ${this.latestPubAttemptNum}`}),yield this.publish(this.tracksToPublish,this.attemptTracker.getTraceId()),this.logger.debug({msg:"publish succeeded!"});const H=this.peerClient.getSfuResource(),ne=this.latestPubAttemptNum-1,se=performance.now()-this.startConnectingTimestamp,Z=this.peerClient.getActionMeasurements();this.attemptTracker.trackPublishStarted({sfuResource:H,totalDurationWithRetries:se,retryTimes:ne,peerClientPerfStats:Z}),this.latestPubAttemptNum=0}catch(H){this.logger.error({msg:"publish failed!",err:H});const ne=this.attemptTracker.trackPublishFailed(H),se=ne.code===Ut.OPERATION_ABORTED.code,Z=ne.fatal,oe=this.latestPubAttemptNum===4;if(se)return;if(Z||oe)return this.logger.error({msg:`Stopping attempts: isFatal=${Z}, isLastAttempt=${oe}`,err:H}),this.updateState(Ja.ERRORED),void this.emit(Bs.ERROR,ne);const de=1e3*Math.pow(2,this.latestPubAttemptNum);this.logger.debug({msg:`attempt failed, retrying in ${de}ms`}),this.nextAttemptTimerId=window.setTimeout(()=>{this.tryPublish()},de)}}}),this.publish=(B,H)=>Fh(this,void 0,void 0,function*(){this.peerClient.initTracksToPublish(B),yield this.peerClient.connect({audioOnly:!1,traceId:H})}),this.unpublish=(B=!1)=>Fh(this,void 0,void 0,function*(){if(window.clearTimeout(this.nextAttemptTimerId),this.publicationState===Ja.DISCONNECTED||this.publicationState===Ja.ERRORED||!this.attemptTracker)return;this.attemptTracker.trackUnpublish();const H=B?Ia.UNLOAD:Ia.UNPUBLISH;try{B?this.peerClient.disconnect(B):yield this.peerClient.disconnect(B),this.attemptTracker.trackEndSucceeded(H)}catch{this.attemptTracker.trackEndFailed(H)}}),this.replaceOrUpdateTrack=B=>Fh(this,void 0,void 0,function*(){this.tracksToPublish.find(H=>H.track.kind===B.track.kind)?this.tracksToPublish=this.tracksToPublish.map(H=>H.track.kind===B.track.kind?B:H):this.tracksToPublish.push(B),yield this.peerClient.replaceOrUpdateTrack(B)}),this.onPeerClientConnectionStateChange=B=>{this.logger.debug({msg:`onPeerClientConnectionStateChange: ${B}`,state:B}),this.processStateUpdate(B)},this.onPeerClientTransformError=B=>{this.emit(Bs.TRANSFORM_ERROR,B)},this.onIncompatibleCodecs=B=>Fh(this,void 0,void 0,function*(){yield this.peerClient.onIncompatibleCodecs(B)}),this.sendSeiMessage=B=>{this.peerClient.sendSeiMessage(B)},this.peerClient=new mv(T,this.nonScopedLogger,this.action,ko(this.action),wc(),this.analyticsTracker,void 0,A,void 0),this.logger=new fo(O,fe.PUBLICATION),this.peerClient.on(ta,this.onPeerClientConnectionStateChange,this),this.peerClient.on(ft,this.onPeerClientTransformError,this),this.publishTracker=new _v(this.analyticsTracker,this.token)}removeTrack(T){return Fh(this,void 0,void 0,function*(){this.tracksToPublish=this.tracksToPublish.filter(A=>A.track.kind!==T),yield this.peerClient.removeTrack(T)})}}var qr,ei=function(N,T,A,O){return new(A||(A=Promise))(function(L,B){function H(Z){try{se(O.next(Z))}catch(oe){B(oe)}}function ne(Z){try{se(O.throw(Z))}catch(oe){B(oe)}}function se(Z){var oe;Z.done?L(Z.value):(oe=Z.value,oe instanceof A?oe:new A(function(de){de(oe)})).then(H,ne)}se((O=O.apply(N,[])).next())})};class Dx extends Px{constructor(T,A,O,L,B){super(T,new fo(O,fe.LOCAL_PARTICIPANT)),this.onPublicationStateChange=H=>{switch(this.logger.debug({msg:"publicationStateChange",state:H}),H){case"connected":this.connection.setStagePublishing(!0),this.updatePublishState(Ks.PUBLISHED);break;case"connecting":this.updatePublishState(Ks.ATTEMPTING_PUBLISH);break;case"errored":this.updatePublishState(Ks.ERRORED),this.connection.setStagePublishing(!1);break;default:return void this.logger.warn({msg:"FIXME onPublicationStateChange UNHANDLED STATE",state:H})}},this.onPublicationError=H=>{this.emit(oc.ERROR,H)},this.updatePublishState=H=>{this.info.isPublishing=H===Ks.PUBLISHED,this.publishState=H,this.emit(oc.PUBLICATION_STATE_CHANGE,this.publishState)},this.handleMute=H=>{H.streamType===Zt.AUDIO&&(this.audioMuted=H.isMuted,this.info.audioMuted=H.isMuted),H.streamType===Zt.VIDEO&&(this.videoStopped=H.isMuted,this.info.videoStopped=H.isMuted),this.connection.emitStageState(this.audioMuted,this.videoStopped),this.emit(oc.MEDIA_STREAM_MUTE_CHANGED,H)},this.publish=H=>{this.logger.debug({msg:"publish"}),H.forEach(se=>{se&&(this.setupStreamListener(se),se.streamType===Zt.AUDIO?(this.audioStream=se,this.audioMuted=!se.mediaStreamTrack.enabled,this.info.audioMuted=this.audioMuted):se.streamType===Zt.VIDEO&&(this.videoStream=se,this.videoStopped=!se.mediaStreamTrack.enabled,this.info.videoStopped=this.videoStopped),se.setGetStats(this.publication.requestRTCStats))}),this.connection.emitStageState(this.audioMuted,this.videoStopped);const ne=H.map(se=>gS(se.mediaStreamTrack,se.mediaConfig));this.publication.start(ne)},this.cleanup=()=>this.removeAllListeners(),this.quickUnpublish=()=>this.publishState!==Ks.NOT_PUBLISHED&&this.publishState!==Ks.ERRORED&&void this.publication.stop(!0),this.onIncompatibleCodecs=H=>ei(this,void 0,void 0,function*(){yield this.publication.onIncompatibleCodecs(H)}),this.sendSeiMessage=H=>{this.publication.sendSeiMessage(H)},this.sendSeiMessageString=H=>{const ne=new TextEncoder().encode(H);this.publication.sendSeiMessage(ne)},this.connection=L,this.createPublication=()=>{const H=new jR(A,L,O,B);return H.on(Bs.STATE_CHANGE,this.onPublicationStateChange),H.on(Bs.ERROR,this.onPublicationError),H.on(Bs.TRANSFORM_ERROR,this.onPublicationError),H},this.publication=this.createPublication()}setupStreamListener(T){T.on(Ud.LOCAL_STREAM_MUTE_CHANGED,this.handleMute)}removeTrack(T){var A,O;T.streamType===Zt.AUDIO?((A=this.audioStream)===null||A===void 0||A.off(Ud.LOCAL_STREAM_MUTE_CHANGED,this.handleMute),this.audioStream=void 0,this.audioMuted=!0,this.info.audioMuted=!0):T.streamType===Zt.VIDEO&&((O=this.videoStream)===null||O===void 0||O.off(Ud.LOCAL_STREAM_MUTE_CHANGED,this.handleMute),this.videoStream=void 0,this.videoStopped=!0,this.info.videoStopped=!0),this.connection.emitStageState(this.audioMuted,this.videoStopped),this.publication.removeTrack(T.streamType)}replaceOrAddTrack(T){return ei(this,void 0,void 0,function*(){this.setupStreamListener(T),T.setGetStats(this.publication.requestRTCStats),T.streamType===Zt.AUDIO?(this.audioStream=T,this.audioMuted=!T.mediaStreamTrack.enabled):T.streamType===Zt.VIDEO&&(this.videoStream=T,this.videoStopped=!T.mediaStreamTrack.enabled),this.connection.emitStageState(this.audioMuted,this.videoStopped);const A=gS(T.mediaStreamTrack,T.mediaConfig);yield this.publication.replaceOrUpdateTrack(A)})}unpublish(){if(this.publishState===Ks.NOT_PUBLISHED||this.publishState===Ks.ERRORED)return;this.logger.debug({msg:"unpublish"}),this.connection.setStagePublishing(!1),this.publication.stop(),this.publication.off(Bs.STATE_CHANGE,this.onPublicationStateChange),this.publication.off(Bs.ERROR,this.onPublicationError),this.publication.off(Bs.TRANSFORM_ERROR,this.onPublicationError);const T=[this.audioStream,this.videoStream].filter(A=>!!A);T.forEach(A=>{A.cleanup()}),this.audioStream=void 0,this.videoStream=void 0,this.emit(oc.MEDIA_STREAM_REMOVED,T),this.updatePublishState(Ks.NOT_PUBLISHED),this.publication=this.createPublication()}}(function(N){N.STAGE_CONNECTION_STATE_CHANGED="stageConnectionStateChanged",N.STAGE_PARTICIPANT_JOINED="stageParticipantJoined",N.STAGE_PARTICIPANT_LEFT="stageParticipantLeft",N.STAGE_PARTICIPANT_STREAMS_ADDED="stageParticipantStreamsAdded",N.STAGE_PARTICIPANT_STREAMS_REMOVED="stageParticipantStreamsRemoved",N.STAGE_STREAM_MUTE_CHANGED="stageStreamMuteChanged",N.STAGE_STREAM_SEI_MESSAGE_RECEIVED="stageStreamSeiMessageReceived",N.STAGE_STREAM_LAYERS_CHANGED="stageStreamLayersChanged",N.STAGE_STREAM_LAYER_SELECTED="stageStreamLayerSelected",N.STAGE_STREAM_ADAPTION_CHANGED="stageStreamAdaptionChanged",N.STAGE_PARTICIPANT_SUBSCRIBE_STATE_CHANGED="stageParticipantSubscribeStateChanged",N.STAGE_PARTICIPANT_PUBLISH_STATE_CHANGED="stageParticipantPublishStateChanged",N.ERROR="error",N.STAGE_LEFT="stageLeft"})(qr||(qr={}));var yo=function(N,T,A,O){return new(A||(A=Promise))(function(L,B){function H(Z){try{se(O.next(Z))}catch(oe){B(oe)}}function ne(Z){try{se(O.throw(Z))}catch(oe){B(oe)}}function se(Z){var oe;Z.done?L(Z.value):(oe=Z.value,oe instanceof A?oe:new A(function(de){de(oe)})).then(H,ne)}se((O=O.apply(N,[])).next())})};const Fs=N=>!!N;class Uf extends cl{constructor(T,A){super(),this.connectionState=ms.DISCONNECTED,this.participants=new Map,this.connectionStateErrored=!1,this.onConnectionStateChanged=(L,B)=>{var H,ne;if(this.connectionState=L,L===ms.ERRORED&&(this.connectionStateErrored=!0),L===ms.CONNECTED&&this.localParticipant&&this.localParticipant.publishState!==Ks.NOT_PUBLISHED&&this.stageConnection.emitStageState((H=this.localParticipant)===null||H===void 0?void 0:H.audioMuted,(ne=this.localParticipant)===null||ne===void 0?void 0:ne.videoStopped),L===ms.CONNECTED&&this.connectionStateErrored&&(this.connectionStateErrored=!1,this.refreshStrategy()),L===ms.DISCONNECTED){if(B&&B!==Wu.CLIENT_RECONNECT&&B!==Wu.USER_INITIATED){let se=vg.UNKNOWN;(function(Z){return Object.values(vg).includes(Z)})(B)?se=B:this.logger.warn({msg:`DISCONNECTED reason is not a StageLeftReason: ${B}`}),this.cleanup(se)}}else this.emit(qr.STAGE_CONNECTION_STATE_CHANGED,this.connectionState)},this.setupLocalParticipantOnce=()=>{var L;this.localParticipant?this.analyticsTracker.trackEventNoSharedProps(new Qm(this.token,(L=this.joinTraceId)!==null&&L!==void 0?L:new tS,"reusing local participant from repeat join",dn.JOIN,"")):this.createLocalParticipant()},this.createLocalParticipant=()=>{const L=function(B){var H,ne;const se=new Set;return B.token.claims.capabilities.allow_publish&&se.add(Bh.PUBLISH),B.token.claims.capabilities.allow_subscribe&&se.add(Bh.SUBSCRIBE),{id:B.token.participantID,userId:(H=B.token.userID)!==null&&H!==void 0?H:"",attributes:(ne=B.token.claims.attributes)!==null&&ne!==void 0?ne:{},capabilities:se,isLocal:!0,userInfo:{},videoStopped:B.videoStopped,audioMuted:B.audioMuted,isPublishing:B.isPublishing}}({token:this.token,videoStopped:!0,audioMuted:!0,isPublishing:!1});this.localParticipant=new Dx(L,this.token,this.logger.unwrap(),this.stageConnection,this.analyticsTracker),this.localParticipant.on(oc.PUBLICATION_STATE_CHANGE,B=>{this.onPublishStateChanged(this.localParticipant.info,B)}),this.localParticipant.on(oc.MEDIA_STREAM_REMOVED,this.onLocalStreamsRemoved),this.localParticipant.on(oc.MEDIA_STREAM_MUTE_CHANGED,B=>{this.localParticipant?this.onStreamMuteChange(this.localParticipant.info,B):this.logger.warn({msg:"tried to emit a stream mute change event for undefined local participant"})}),this.localParticipant.on(oc.ERROR,B=>{this.errorManager.handleError(B,Ld.PUBLISH_ERROR)}),this.emit(qr.STAGE_PARTICIPANT_JOINED,L)},this.onRemoteParticipantJoined=L=>{var B;if(L.id!==((B=this.localParticipant)===null||B===void 0?void 0:B.info.id)){const H=function(oe){return{id:oe.id,userId:oe.userId,attributes:oe.attributes,capabilities:new Set([Bh.SUBSCRIBE]),isLocal:!1,userInfo:{},videoStopped:oe.videoStopped,audioMuted:oe.audioMuted,isPublishing:oe.isPublishing}}(L);if(this.participants.has(H.id))return void this.logger.warn({msg:"Remote participant already tracked"});let ne=Uo.NONE;H.capabilities.has(Bh.SUBSCRIBE)&&(ne=ii.getOk_or(this.strategyWrapper.shouldSubscribeToParticipant(H),ne),this.updateManagerWithExternalSubscribeConfig(H,"joined"));const se=this.configManager.getSubscribeConfigSnapshot(H.id),Z=new zR(H,this.token,this.stageConnection,this.logger.unwrap(),ne,se,this.analyticsTracker,L.isPublishing);this.participants.set(H.id,Z),this.setupRemoteParticipantListeners(Z),this.emit(qr.STAGE_PARTICIPANT_JOINED,Z.info),Z.updateSubscribeStateIfNecessary(ne)}},this.setupRemoteParticipantListeners=L=>{L.on(_o.SUBSCRIPTION_STATE_CHANGE,B=>{this.onParticipantSubscribeStateChanged(L.info.id,B)}),L.on(_o.MEDIA_STREAM_ADDED,B=>{const H=this.participants.get(L.info.id);if(H){for(const ne of B)this.setupRemoteParticipantStreamEvents(H.info,ne);this.emit(qr.STAGE_PARTICIPANT_STREAMS_ADDED,H.info,xS(B)),this.updateStreamLayerForParticipant(L)}else this.logger.warn({msg:"Got stream add for participant no longer being tracked"})}),L.on(_o.MEDIA_STREAM_REMOVED,B=>{const H=this.participants.get(L.info.id);H?this.emit(qr.STAGE_PARTICIPANT_STREAMS_REMOVED,H.info,xS(B)):this.logger.warn({msg:"Got stream remove for participant no longer being tracked"})}),L.on(_o.MEDIA_STREAM_MUTE_CHANGED,B=>{this.onStreamMuteChange(L.info,B.remote)}),L.on(_o.ERROR,B=>{this.errorManager.handleError(B,Ld.SUBSCRIBE_ERROR)}),L.on(_o.MEDIA_STREAM_SEI_MESSAGE_RECEIVED,B=>{this.onSeiMessageReceived(L.info,B)})},this.onRemoteParticipantLeft=L=>{if(this.connectionState!==ms.CONNECTED)return;const B=this.participants.get(L);B?(B.participantLeave(),B.unsubscribe(),B.cleanup(),this.participants.delete(L),this.emitParticipantLeave(B.info)):this.logger.warn({msg:"Remote participant no longer tracked"})},this.emitParticipantLeave=L=>{this.emit(qr.STAGE_PARTICIPANT_LEFT,L)},this.onRemoteParticipantStateChanged=L=>{const B=this.participants.get(L.id);if(!B)return void this.logger.warn({msg:"Remote participant updated but not tracked"});B.updatePublishState(L.isPublishing)&&this.onPublishStateChanged(B.info,B.publishState),B.updateStreamState(L.audioMuted,L.videoStopped);const H=this.strategyWrapper.shouldSubscribeToParticipant(B.info);if(ii.isNotOk(H))return;this.updateManagerWithExternalSubscribeConfig(B.info,"updated");const ne=this.configManager.getSubscribeConfigSnapshot(B.info.id),se=ii.getOk_or(H,Uo.NONE);B.updateSubscribeStateIfNecessary(se,ne)},this.onPublishStateChanged=(L,B)=>{this.emit(qr.STAGE_PARTICIPANT_PUBLISH_STATE_CHANGED,L,B)},this.onParticipantSubscribeStateChanged=(L,B)=>{const H=this.participants.get(L);H?this.emit(qr.STAGE_PARTICIPANT_SUBSCRIBE_STATE_CHANGED,H.info,B):this.logger.warn({msg:"Remote participant subscribe state changed but not tracked"})},this.onLocalStreamsAdded=L=>{this.localParticipant&&this.emit(qr.STAGE_PARTICIPANT_STREAMS_ADDED,this.localParticipant.info,L)},this.onLocalStreamsRemoved=L=>{this.localParticipant&&this.emit(qr.STAGE_PARTICIPANT_STREAMS_REMOVED,this.localParticipant.info,L)},this.onStreamMuteChange=(L,B)=>{this.emit(qr.STAGE_STREAM_MUTE_CHANGED,L,B)},this.onSeiMessageReceived=(L,B)=>{this.emit(qr.STAGE_STREAM_SEI_MESSAGE_RECEIVED,L,B)},this.leave=()=>{this.cleanup(vg.USER_INITIATED)},this.onBeforeUnloadCleanup=()=>{var L;this.participants.forEach(B=>{B.quickUnsubscribe()}),(L=this.localParticipant)===null||L===void 0||L.quickUnpublish(),this.stageConnection.disconnect(),this.emit(qr.STAGE_CONNECTION_STATE_CHANGED,ms.DISCONNECTED),this.analyticsTracker.stop(!0)},this.cleanup=L=>{if(!this.localParticipant)return;this.analyticsTracker.trackEventNoSharedProps(new Lu({token:this.token,eventEndpoint:this.token.eventsURL,whipEndpoint:this.token.whipURL,traceId:this.joinTraceId,reason:L})),this.localParticipant.unpublish(),this.localParticipant.cleanup();const B=this.localParticipant.info;this.localParticipant=void 0,this.emitParticipantLeave(B);const H=this.participants.entries();for(const[ne,se]of H)se.unsubscribe(),this.participants.delete(ne),se.cleanup(),this.emitParticipantLeave(se.info);cg.destroy(),this.stageConnection.disconnect(),this.emit(qr.STAGE_CONNECTION_STATE_CHANGED,ms.DISCONNECTED),this.emit(qr.STAGE_LEFT,L),this.stageConnection.removeAllListeners(),this.stageConnection=new fS(this.token,this.logger.unwrap(),this.analyticsTracker),this.setupListeners(),this.analyticsTracker.stop(!1),window.removeEventListener("beforeunload",this.onBeforeUnloadCleanup)},this.refreshStrategy=()=>{this.participants.forEach(L=>{if(L.info.capabilities.has(Bh.SUBSCRIBE)){const B=this.strategyWrapper.shouldSubscribeToParticipant(L.info);if(ii.isNotOk(B))return;const H=ii.getOk_or(B,Uo.NONE);this.updateManagerWithExternalSubscribeConfig(L.info,"updated");const ne=this.configManager.getSubscribeConfigSnapshot(L.info.id);L.updateSubscribeStateIfNecessary(H,ne),this.updateStreamLayerForParticipant(L)}}),this.updateStreamsToPublishIfNecessary()},this.updateStreamsToPublishIfNecessary=()=>{var L;if(!this.localParticipant||!(!((L=this.localParticipant)===null||L===void 0)&&L.info.capabilities.has(Bh.PUBLISH)))return;const B=this.localParticipant.publishState!==Ks.NOT_PUBLISHED&&this.localParticipant.publishState!==Ks.ERRORED,H=this.strategyWrapper.shouldPublishParticipant(this.localParticipant.info);if(ii.isNotOk(H))return;let ne=ii.getOk_or(H,!1);if(!B&&!ne)return;if(B&&!ne)return void this.localParticipant.unpublish();const se=this.strategyWrapper.stageStreamsToPublish();if(ii.isNotOk(se)){const oe=ii.getErr(se);if(oe instanceof Error&&oe.cause==="UserStrategy")throw oe;return}const Z=ii.getOk_or(se,[]);ne=ne&&Z.length>0,!B&&ne?(this.localParticipant.publish(Z),this.onLocalStreamsAdded(Z)):this.syncTracksToPublish(Z)},this.syncTracksToPublish=L=>{var B;if(!this.localParticipant)return;const H=this.localParticipant.audioStream,ne=this.localParticipant.videoStream,{updates:se,streamsToAdd:Z,streamsToRemove:oe}=this.determineStreamUpdates(H,ne,L);if(se.length){for(const de of se)de.newStream?(B=this.localParticipant)===null||B===void 0||B.replaceOrAddTrack(de.newStream):de.oldStream&&this.localParticipant.removeTrack(de.oldStream);oe.length!==0&&this.onLocalStreamsRemoved(oe),Z.length!==0&&this.onLocalStreamsAdded(Z)}},this.determineStreamUpdates=(L,B,H=[])=>{const ne=[],se=H.slice(0,2);if(se.sort((de,me)=>de.streamType===Zt.AUDIO?-1:1),se.length===0)L&&ne.push({oldStream:L}),B&&ne.push({oldStream:B});else if(se.length===1){const de=se[0];de.streamType===Zt.AUDIO?B&&ne.push({oldStream:B}):de.streamType===Zt.VIDEO&&L&&ne.push({oldStream:L})}se.forEach(de=>{var me,Pe;de.streamType===Zt.AUDIO?L?L.id===de.id&&(0,_a.isEqual)(L.mediaConfig,de.mediaConfig)||(!!(!((me=L.mediaConfig)===null||me===void 0)&&me.stereo)!=!!(!((Pe=de.mediaConfig)===null||Pe===void 0)&&Pe.stereo)&&this.logger.warn({msg:"Ignoring change to audio stream's stereo configuration. Re-publish to change stereo configuraiton."}),ne.push({oldStream:L,newStream:de})):ne.push({newStream:de}):de.streamType===Zt.VIDEO&&(B?B.id===de.id&&(0,_a.isEqual)(B.mediaConfig,de.mediaConfig)||ne.push({oldStream:B,newStream:de}):ne.push({newStream:de}))});const Z=ne.map(de=>de.newStream).filter(Fs),oe=ne.map(de=>de.oldStream).filter(Fs);return{updates:ne,streamsToAdd:Z,streamsToRemove:oe}},this.onReassignmentMessage=L=>yo(this,void 0,void 0,function*(){if(xh("disableReassignments"))return void this.logger.debug({msg:"REASSIGN message ignored: disableReassignments is configured"});if(!ps.browser.isChrome())return void this.logger.debug({msg:"REASSIGN message ignored: browser is not chrome"});const B=wc();this.trackReassignmentRequest(L,B);const H=this.participants.get(L.remoteParticipantId),ne=this.token.participantID,se=function(Z,{localParticipantId:oe,remoteParticipant:de}){const{participantId:me}=Z;if(oe!==me)return ii.err(Object.assign(Object.assign({},Ut.REASSIGNMENT_REQUEST_INVALID_LOCAL_PARTICIPANT_ID),{details:`Invalid participantId received: ${me}`}));if(!de)return ii.err(Object.assign(Object.assign({},Ut.REASSIGNMENT_REQUEST_INVALID_REMOTE_PARTICIPANT_ID),{details:`Invalid remoteParticipantId received: ${de}`}));if(de.isReassigning())return ii.err(Ut.REASSIGNMENT_REQUEST_ALREADY_IN_PROGRESS);const Pe=de.subscription.peerClient.getConnectionState();return[st.CONNECTED,st.DISCONNECTED].includes(Pe)?ii.ok(de):ii.err(Object.assign(Object.assign({},Ut.REASSIGNMENT_REQUEST_INVALID_REMOTE_PEER_CONNECTION_STATE),{details:`connectionState: ${Pe}`}))}(L,{localParticipantId:ne,remoteParticipant:H});if(!se.ok)this.trackReassignmentRequestRejected(se.error,B);else try{const{token:Z,nodeOverride:oe}=L;yield se.value.triggerIceRestart({assignmentToken:Z,traceId:B,nodeOverride:oe})}catch(Z){this.logger.error({msg:"Reassignment failed.",err:Z})}}),this.onIncompatibleCodecsMessage=L=>yo(this,void 0,void 0,function*(){var B;yield(B=this.localParticipant)===null||B===void 0?void 0:B.onIncompatibleCodecs(L.codecs)}),this.analyticsTracker=new wd;const O=k0();this.logger=new fo(new qm(O),fe.STAGE),this.strategyWrapper=new BR(A,this.logger),this.configManager=new UR({logger:this.logger.unwrap(),subscribeDefaults:{jitterBuffer:{minDelayWhenPublishing:Ys.DEFAULT,minDelayWhenSubscribeOnly:Ys.DEFAULT},inBandMessaging:{enabled:!1},simulcast:{initialLayerPreference:iu.LOWEST_QUALITY}}}),this.errorManager=new LR;try{this.token=Fu(T,this.analyticsTracker)}catch(L){const B=new ki(Object.assign({action:dn.JOIN,token:T,traceId:wc(),tag:Cc.JOIN_RELATED,location:"Stage.constructor"},Ut.MALFORMED_TOKEN));throw L instanceof Error&&(B.details=L.message),this.errorManager.handleError(B,Ld.JOIN_ERROR)||L}this.stageConnection=new fS(this.token,this.logger.unwrap(),this.analyticsTracker),this.setupListeners()}setupListeners(){this.stageConnection.on(kl,(T,A)=>{this.onConnectionStateChanged(T,A)}),this.stageConnection.on(Of,T=>{this.onRemoteParticipantJoined(T)}),this.stageConnection.on(Md,T=>{this.onRemoteParticipantLeft(T.id)}),this.stageConnection.on(W0,T=>{var A;T.id!==((A=this.localParticipant)===null||A===void 0?void 0:A.info.id)&&this.onRemoteParticipantStateChanged(T)}),this.stageConnection.on(tu,T=>yo(this,void 0,void 0,function*(){yield this.onReassignmentMessage(T)})),this.stageConnection.on(Nf,T=>yo(this,void 0,void 0,function*(){yield this.onIncompatibleCodecsMessage(T)})),this.stageConnection.on(Gp,T=>{T instanceof ki&&this.analyticsTracker.trackError(T),this.errorManager.handleError(T,Ld.JOIN_ERROR)}),this.errorManager.on(pg.ERROR,T=>{this.emit(qr.ERROR,T)})}setupRemoteParticipantStreamEvents(T,A){const O=A.remote;A.on(Zu.ADAPTION_CHANGED,L=>{this.emit(qr.STAGE_STREAM_ADAPTION_CHANGED,T,O,L)}),A.on(Zu.LAYERS_CHANGED,L=>{this.emit(qr.STAGE_STREAM_LAYERS_CHANGED,T,O,L)}),A.on(Zu.LAYER_SELECTED,(L,B)=>{this.emit(qr.STAGE_STREAM_LAYER_SELECTED,T,O,L,B)}),A.layers.length>0&&(this.emit(qr.STAGE_STREAM_LAYERS_CHANGED,T,O,O.getLayers()),this.emit(qr.STAGE_STREAM_LAYER_SELECTED,T,O,O.getSelectedLayer(),Uh.SELECTED))}join(){return yo(this,void 0,void 0,function*(){this.analyticsTracker.start(),this.joinTraceId=wc(),this.analyticsTracker.trackEvent(new uv({token:this.token,eventEndpoint:this.token.eventsURL,whipEndpoint:this.token.whipURL,traceId:this.joinTraceId}));try{this.token.assertTokenIsUnexpired(wc(),Cc.JOIN_RELATED,"join")}catch(T){throw this.errorManager.handleError(T,Ld.JOIN_ERROR)||T}try{this.joinTraceId=yield this.stageConnection.connect(this.joinTraceId),this.connectionState===ms.CONNECTED&&(this.setupLocalParticipantOnce(),this.updateStreamsToPublishIfNecessary()),window.addEventListener("beforeunload",this.onBeforeUnloadCleanup)}catch(T){throw this.logger.error({err:T,msg:"error joining stage"}),this.errorManager.handleError(T,Ld.JOIN_ERROR,!1)||T}})}replaceStrategy(T){this.strategyWrapper.setStrategy(T),this.refreshStrategy()}updateManagerWithExternalSubscribeConfig(T,A){const O=ii.getOk(this.strategyWrapper.subscribeConfiguration(T));if(O===void 0)return;const L=T.id;if(this.configManager.handleExternalSubscribeConfigUpdate(L,O,mg.API)){const B=this.configManager.getSubscribeConfigSnapshot(L);this.analyticsTracker.trackEventNoSharedProps(new ng(this.token,this.joinTraceId,{trigger:A==="joined"?"initial":"ad-hoc",remote_participant_id:L,min_delay_when_publishing:Ka(B.jitterBuffer.minDelayWhenPublishing,!0),min_delay_when_subscribe_only:Ka(B.jitterBuffer.minDelayWhenSubscribeOnly,!1),in_band_messaging_enabled:B.inBandMessaging.enabled,simulcast_initial_layer_preference:B.simulcast.initialLayerPreference}))}}updateStreamLayerForParticipant(T){T.streams.forEach(A=>{if(A.streamType==="audio")return;const O=this.strategyWrapper.preferredLayerForStream(T.info,A.remote),L=ii.getOk_or(O,void 0);A.setLayer(L)})}trackReassignmentRequestRejected(T,A){const{token:O}=this,L=new ki(Object.assign(Object.assign({},T),{token:O,action:dn.JOIN,traceId:A,tag:Cc.SUBSCRIBE_RELATED,location:"publish"}));this.logger.error({err:L,msg:"Reassignment request rejected."}),this.analyticsTracker.trackError(L)}trackReassignmentRequest(T,A){const{token:O}=this;this.analyticsTracker.trackEvent(new kx({token:O,traceId:A,targetLocalParticipantId:T.participantId,targetRemoteParticipantId:T.remoteParticipantId}))}}var vg;(function(N){N.UNKNOWN="unknown",N.USER_INITIATED="user-initiated",N.TOKEN_REUSED="token-reused",N.PARTICIPANT_DISCONNECTED="participant-disconnected",N.STAGE_DELETED="stage-deleted"})(vg||(vg={}));const RS=h})(),s})())})(mwe);var SNt=mwe.exports;const ZS=il(SNt),gwe="0123456789abcdefABCDEF";gwe.split("").map(t=>t.codePointAt(0));Array(256).fill(!0).map((t,e)=>{const n=String.fromCodePoint(e),i=gwe.indexOf(n);return i<0?void 0:i<16?i:i-6});new TextEncoder;new TextDecoder;function xw(t,e){const n=Math.min(t.length,e.length);for(let i=0;i<n;++i)if(t[i]!==e[i])return t[i]<e[i]?-1:1;return t.length===e.length?0:t.length>e.length?1:-1}var TNt=(t,e,n=Math.min(t.length,e.length))=>{for(let i=0;i<n;i++){const r=t[i],s=e[i];if(r!==s)return 8*n-(i*8+Math.clz32(r^s)-24)}return 0},xNt=class{constructor(t,e){this.id=t,this.bucketSize=e.bucketSize||20,this.buckets=new Array(t.length*8+1).fill(void 0).map(()=>[]),this.compare=e.compare||(()=>0),this.getId=e.getId}get length(){return this.buckets.reduce((t,e)=>t+e.length,0)}*[Symbol.iterator](){for(const t of this.buckets)for(const e of t)yield e}add(t,e=this.getBitwiseDistance(this.getId(t))){if(this.has(this.getId(t),e))return!1;if(this.buckets[e].length<this.bucketSize)return this.buckets[e].push(t),!0;const n=this.buckets[e].slice(0);n.push(t);const i=n.sort(this.compare);this.buckets[e]=i.slice(0,this.bucketSize);const r=i.at(-1);return xw(this.getId(t),this.getId(r))!==0}clear(){for(let t=0;t<this.buckets.length;t++)this.buckets[t]=[]}listClosestToId(t,e=this.buckets.length*this.bucketSize){const n=this.getBitwiseDistance(t);return this.getNodes(n,e)}get(t){const e=this.buckets[t].shift();return e&&this.buckets[t].push(e),e}getById(t,e=this.getBitwiseDistance(t)){const n=this.buckets[e].findIndex(r=>xw(this.getId(r),t)===0);if(n===-1)return;const i=this.buckets[e][n];return this.buckets[e]=this.buckets[e].splice(n,1).concat(i),i}getBitwiseDistance(t){return TNt(this.id,t)}getNodes(t,e,n=0){const i=(n%2===0?1:-1)*Math.ceil(n/2);if(Math.abs(i)>Math.max(t,this.buckets.length-1-t))return[];const r=t+i;if(0>r||r>this.buckets.length-1)return this.getNodes(t,e,n+1);const s=this.buckets[r].slice(0,e);return s.length>=e?(this.buckets[r]=this.buckets[r].slice(s.length).concat(this.buckets[r].slice(0,s.length)),s):s.concat(this.getNodes(t,e-s.length,n+1))}has(t,e=this.getBitwiseDistance(t)){return!!this.buckets[e].find(n=>xw(this.getId(n),t)===0)}peek(t){return this.buckets[t].at(0)}peekById(t,e=this.getBitwiseDistance(t)){return this.buckets[e].find(n=>xw(this.getId(n),t)===0)}update(t,e=this.getBitwiseDistance(this.getId(t))){const n=this.buckets[e].findIndex(i=>xw(this.getId(i),this.getId(t))===0);return n===-1?!1:(this.buckets[e][n]=t,!0)}remove(t,e=this.getBitwiseDistance(t)){const n=this.buckets[e].findIndex(i=>xw(this.getId(i),t)===0);return n===-1?!1:(this.buckets[e].splice(n,1),!0)}},vwe={exports:{}};(function(t){var e=function(){function n(d,f){return f!=null&&d instanceof f}var i;try{i=Map}catch{i=function(){}}var r;try{r=Set}catch{r=function(){}}var s;try{s=Promise}catch{s=function(){}}function a(d,f,p,g,_){typeof f=="object"&&(p=f.depth,g=f.prototype,_=f.includeNonEnumerable,f=f.circular);var v=[],b=[],S=typeof Yl<"u";typeof f>"u"&&(f=!0),typeof p>"u"&&(p=1/0);function x(M,R){if(M===null)return null;if(R===0)return M;var I,k;if(typeof M!="object")return M;if(n(M,i))I=new i;else if(n(M,r))I=new r;else if(n(M,s))I=new s(function(J,K){M.then(function(X){J(x(X,R-1))},function(X){K(x(X,R-1))})});else if(a.__isArray(M))I=[];else if(a.__isRegExp(M))I=new RegExp(M.source,h(M)),M.lastIndex&&(I.lastIndex=M.lastIndex);else if(a.__isDate(M))I=new Date(M.getTime());else{if(S&&Yl.isBuffer(M))return Yl.allocUnsafe?I=Yl.allocUnsafe(M.length):I=new Yl(M.length),M.copy(I),I;n(M,Error)?I=Object.create(M):typeof g>"u"?(k=Object.getPrototypeOf(M),I=Object.create(k)):(I=Object.create(g),k=g)}if(f){var P=v.indexOf(M);if(P!=-1)return b[P];v.push(M),b.push(I)}n(M,i)&&M.forEach(function(J,K){var X=x(K,R-1),ae=x(J,R-1);I.set(X,ae)}),n(M,r)&&M.forEach(function(J){var K=x(J,R-1);I.add(K)});for(var U in M){var V;k&&(V=Object.getOwnPropertyDescriptor(k,U)),!(V&&V.set==null)&&(I[U]=x(M[U],R-1))}if(Object.getOwnPropertySymbols)for(var $=Object.getOwnPropertySymbols(M),U=0;U<$.length;U++){var q=$[U],Y=Object.getOwnPropertyDescriptor(M,q);Y&&!Y.enumerable&&!_||(I[q]=x(M[q],R-1),Y.enumerable||Object.defineProperty(I,q,{enumerable:!1}))}if(_)for(var te=Object.getOwnPropertyNames(M),U=0;U<te.length;U++){var G=te[U],Y=Object.getOwnPropertyDescriptor(M,G);Y&&Y.enumerable||(I[G]=x(M[G],R-1),Object.defineProperty(I,G,{enumerable:!1}))}return I}return x(d,p)}a.clonePrototype=function(f){if(f===null)return null;var p=function(){};return p.prototype=f,new p};function o(d){return Object.prototype.toString.call(d)}a.__objToStr=o;function c(d){return typeof d=="object"&&o(d)==="[object Date]"}a.__isDate=c;function l(d){return typeof d=="object"&&o(d)==="[object Array]"}a.__isArray=l;function u(d){return typeof d=="object"&&o(d)==="[object RegExp]"}a.__isRegExp=u;function h(d){var f="";return d.global&&(f+="g"),d.ignoreCase&&(f+="i"),d.multiline&&(f+="m"),f}return a.__getRegExpFlags=h,a}();t.exports&&(t.exports=e)})(vwe);var wNt=vwe.exports,O7={exports:{}},OV,pce;function CNt(){if(pce)return OV;pce=1;var t=1e3,e=t*60,n=e*60,i=n*24,r=i*7,s=i*365.25;OV=function(u,h){h=h||{};var d=typeof u;if(d==="string"&&u.length>0)return a(u);if(d==="number"&&isFinite(u))return h.long?c(u):o(u);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(u))};function a(u){if(u=String(u),!(u.length>100)){var h=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(u);if(h){var d=parseFloat(h[1]),f=(h[2]||"ms").toLowerCase();switch(f){case"years":case"year":case"yrs":case"yr":case"y":return d*s;case"weeks":case"week":case"w":return d*r;case"days":case"day":case"d":return d*i;case"hours":case"hour":case"hrs":case"hr":case"h":return d*n;case"minutes":case"minute":case"mins":case"min":case"m":return d*e;case"seconds":case"second":case"secs":case"sec":case"s":return d*t;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return d;default:return}}}}function o(u){var h=Math.abs(u);return h>=i?Math.round(u/i)+"d":h>=n?Math.round(u/n)+"h":h>=e?Math.round(u/e)+"m":h>=t?Math.round(u/t)+"s":u+"ms"}function c(u){var h=Math.abs(u);return h>=i?l(u,h,i,"day"):h>=n?l(u,h,n,"hour"):h>=e?l(u,h,e,"minute"):h>=t?l(u,h,t,"second"):u+" ms"}function l(u,h,d,f){var p=h>=d*1.5;return Math.round(u/d)+" "+f+(p?"s":"")}return OV}function ANt(t){n.debug=n,n.default=n,n.coerce=c,n.disable=s,n.enable=r,n.enabled=a,n.humanize=CNt(),n.destroy=l,Object.keys(t).forEach(u=>{n[u]=t[u]}),n.names=[],n.skips=[],n.formatters={};function e(u){let h=0;for(let d=0;d<u.length;d++)h=(h<<5)-h+u.charCodeAt(d),h|=0;return n.colors[Math.abs(h)%n.colors.length]}n.selectColor=e;function n(u){let h,d=null,f,p;function g(..._){if(!g.enabled)return;const v=g,b=Number(new Date),S=b-(h||b);v.diff=S,v.prev=h,v.curr=b,h=b,_[0]=n.coerce(_[0]),typeof _[0]!="string"&&_.unshift("%O");let x=0;_[0]=_[0].replace(/%([a-zA-Z%])/g,(R,I)=>{if(R==="%%")return"%";x++;const k=n.formatters[I];if(typeof k=="function"){const P=_[x];R=k.call(v,P),_.splice(x,1),x--}return R}),n.formatArgs.call(v,_),(v.log||n.log).apply(v,_)}return g.namespace=u,g.useColors=n.useColors(),g.color=n.selectColor(u),g.extend=i,g.destroy=n.destroy,Object.defineProperty(g,"enabled",{enumerable:!0,configurable:!1,get:()=>d!==null?d:(f!==n.namespaces&&(f=n.namespaces,p=n.enabled(u)),p),set:_=>{d=_}}),typeof n.init=="function"&&n.init(g),g}function i(u,h){const d=n(this.namespace+(typeof h>"u"?":":h)+u);return d.log=this.log,d}function r(u){n.save(u),n.namespaces=u,n.names=[],n.skips=[];let h;const d=(typeof u=="string"?u:"").split(/[\s,]+/),f=d.length;for(h=0;h<f;h++)d[h]&&(u=d[h].replace(/\*/g,".*?"),u[0]==="-"?n.skips.push(new RegExp("^"+u.slice(1)+"$")):n.names.push(new RegExp("^"+u+"$")))}function s(){const u=[...n.names.map(o),...n.skips.map(o).map(h=>"-"+h)].join(",");return n.enable(""),u}function a(u){if(u[u.length-1]==="*")return!0;let h,d;for(h=0,d=n.skips.length;h<d;h++)if(n.skips[h].test(u))return!1;for(h=0,d=n.names.length;h<d;h++)if(n.names[h].test(u))return!0;return!1}function o(u){return u.toString().substring(2,u.toString().length-2).replace(/\.\*\?$/,"*")}function c(u){return u instanceof Error?u.stack||u.message:u}function l(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")}return n.enable(n.load()),n}var RNt=ANt;(function(t,e){var n={};e.formatArgs=r,e.save=s,e.load=a,e.useColors=i,e.storage=o(),e.destroy=(()=>{let l=!1;return()=>{l||(l=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})(),e.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"];function i(){if(typeof window<"u"&&window.process&&(window.process.type==="renderer"||window.process.__nwjs))return!0;if(typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))return!1;let l;return typeof document<"u"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window<"u"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator<"u"&&navigator.userAgent&&(l=navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/))&&parseInt(l[1],10)>=31||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)}function r(l){if(l[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+l[0]+(this.useColors?"%c ":" ")+"+"+t.exports.humanize(this.diff),!this.useColors)return;const u="color: "+this.color;l.splice(1,0,u,"color: inherit");let h=0,d=0;l[0].replace(/%[a-zA-Z%]/g,f=>{f!=="%%"&&(h++,f==="%c"&&(d=h))}),l.splice(d,0,u)}e.log=console.debug||console.log||(()=>{});function s(l){try{l?e.storage.setItem("debug",l):e.storage.removeItem("debug")}catch{}}function a(){let l;try{l=e.storage.getItem("debug")}catch{}return!l&&typeof Gn<"u"&&"env"in Gn&&(l=n.DEBUG),l}function o(){try{return localStorage}catch{}}t.exports=RNt(e);const{formatters:c}=t.exports;c.j=function(l){try{return JSON.stringify(l)}catch(u){return"[UnexpectedJSONParseError]: "+u.message}}})(O7,O7.exports);var r5=O7.exports,MNt=function(){if(typeof globalThis>"u")return null;var e={RTCPeerConnection:globalThis.RTCPeerConnection||globalThis.mozRTCPeerConnection||globalThis.webkitRTCPeerConnection,RTCSessionDescription:globalThis.RTCSessionDescription||globalThis.mozRTCSessionDescription||globalThis.webkitRTCSessionDescription,RTCIceCandidate:globalThis.RTCIceCandidate||globalThis.mozRTCIceCandidate||globalThis.webkitRTCIceCandidate};return e.RTCPeerConnection?e:null},N7={exports:{}},I7={exports:{}};const SP=$ce(O7e);/*! safe-buffer. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> */(function(t,e){var n=SP,i=n.Buffer;function r(a,o){for(var c in a)o[c]=a[c]}i.from&&i.alloc&&i.allocUnsafe&&i.allocUnsafeSlow?t.exports=n:(r(n,e),e.Buffer=s);function s(a,o,c){return i(a,o,c)}s.prototype=Object.create(i.prototype),r(i,s),s.from=function(a,o,c){if(typeof a=="number")throw new TypeError("Argument must not be a number");return i(a,o,c)},s.alloc=function(a,o,c){if(typeof a!="number")throw new TypeError("Argument must be a number");var l=i(a);return o!==void 0?typeof c=="string"?l.fill(o,c):l.fill(o):l.fill(0),l},s.allocUnsafe=function(a){if(typeof a!="number")throw new TypeError("Argument must be a number");return i(a)},s.allocUnsafeSlow=function(a){if(typeof a!="number")throw new TypeError("Argument must be a number");return n.SlowBuffer(a)}})(I7,I7.exports);var _we=I7.exports,NV=65536,ONt=4294967295;function NNt(){throw new Error(`Secure random number generation is not supported by this browser.
Use Chrome, Firefox or Internet Explorer 11`)}var INt=_we.Buffer,WB=Ml.crypto||Ml.msCrypto;WB&&WB.getRandomValues?N7.exports=kNt:N7.exports=NNt;function kNt(t,e){if(t>ONt)throw new RangeError("requested too many random bytes");var n=INt.allocUnsafe(t);if(t>0)if(t>NV)for(var i=0;i<t;i+=NV)WB.getRandomValues(n.slice(i,i+NV));else WB.getRandomValues(n);return typeof e=="function"?Gn.nextTick(function(){e(null,n)}):n}var s5=N7.exports,k7={exports:{}},KZ={exports:{}},LC=typeof Reflect=="object"?Reflect:null,mce=LC&&typeof LC.apply=="function"?LC.apply:function(e,n,i){return Function.prototype.apply.call(e,n,i)},zL;LC&&typeof LC.ownKeys=="function"?zL=LC.ownKeys:Object.getOwnPropertySymbols?zL=function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:zL=function(e){return Object.getOwnPropertyNames(e)};function PNt(t){console&&console.warn&&console.warn(t)}var ywe=Number.isNaN||function(e){return e!==e};function $s(){$s.init.call(this)}KZ.exports=$s;KZ.exports.once=BNt;$s.EventEmitter=$s;$s.prototype._events=void 0;$s.prototype._eventsCount=0;$s.prototype._maxListeners=void 0;var gce=10;function a5(t){if(typeof t!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof t)}Object.defineProperty($s,"defaultMaxListeners",{enumerable:!0,get:function(){return gce},set:function(t){if(typeof t!="number"||t<0||ywe(t))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+t+".");gce=t}});$s.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0};$s.prototype.setMaxListeners=function(e){if(typeof e!="number"||e<0||ywe(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this};function bwe(t){return t._maxListeners===void 0?$s.defaultMaxListeners:t._maxListeners}$s.prototype.getMaxListeners=function(){return bwe(this)};$s.prototype.emit=function(e){for(var n=[],i=1;i<arguments.length;i++)n.push(arguments[i]);var r=e==="error",s=this._events;if(s!==void 0)r=r&&s.error===void 0;else if(!r)return!1;if(r){var a;if(n.length>0&&(a=n[0]),a instanceof Error)throw a;var o=new Error("Unhandled error."+(a?" ("+a.message+")":""));throw o.context=a,o}var c=s[e];if(c===void 0)return!1;if(typeof c=="function")mce(c,this,n);else for(var l=c.length,u=wwe(c,l),i=0;i<l;++i)mce(u[i],this,n);return!0};function Ewe(t,e,n,i){var r,s,a;if(a5(n),s=t._events,s===void 0?(s=t._events=Object.create(null),t._eventsCount=0):(s.newListener!==void 0&&(t.emit("newListener",e,n.listener?n.listener:n),s=t._events),a=s[e]),a===void 0)a=s[e]=n,++t._eventsCount;else if(typeof a=="function"?a=s[e]=i?[n,a]:[a,n]:i?a.unshift(n):a.push(n),r=bwe(t),r>0&&a.length>r&&!a.warned){a.warned=!0;var o=new Error("Possible EventEmitter memory leak detected. "+a.length+" "+String(e)+" listeners added. Use emitter.setMaxListeners() to increase limit");o.name="MaxListenersExceededWarning",o.emitter=t,o.type=e,o.count=a.length,PNt(o)}return t}$s.prototype.addListener=function(e,n){return Ewe(this,e,n,!1)};$s.prototype.on=$s.prototype.addListener;$s.prototype.prependListener=function(e,n){return Ewe(this,e,n,!0)};function DNt(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function Swe(t,e,n){var i={fired:!1,wrapFn:void 0,target:t,type:e,listener:n},r=DNt.bind(i);return r.listener=n,i.wrapFn=r,r}$s.prototype.once=function(e,n){return a5(n),this.on(e,Swe(this,e,n)),this};$s.prototype.prependOnceListener=function(e,n){return a5(n),this.prependListener(e,Swe(this,e,n)),this};$s.prototype.removeListener=function(e,n){var i,r,s,a,o;if(a5(n),r=this._events,r===void 0)return this;if(i=r[e],i===void 0)return this;if(i===n||i.listener===n)--this._eventsCount===0?this._events=Object.create(null):(delete r[e],r.removeListener&&this.emit("removeListener",e,i.listener||n));else if(typeof i!="function"){for(s=-1,a=i.length-1;a>=0;a--)if(i[a]===n||i[a].listener===n){o=i[a].listener,s=a;break}if(s<0)return this;s===0?i.shift():LNt(i,s),i.length===1&&(r[e]=i[0]),r.removeListener!==void 0&&this.emit("removeListener",e,o||n)}return this};$s.prototype.off=$s.prototype.removeListener;$s.prototype.removeAllListeners=function(e){var n,i,r;if(i=this._events,i===void 0)return this;if(i.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):i[e]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete i[e]),this;if(arguments.length===0){var s=Object.keys(i),a;for(r=0;r<s.length;++r)a=s[r],a!=="removeListener"&&this.removeAllListeners(a);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(n=i[e],typeof n=="function")this.removeListener(e,n);else if(n!==void 0)for(r=n.length-1;r>=0;r--)this.removeListener(e,n[r]);return this};function Twe(t,e,n){var i=t._events;if(i===void 0)return[];var r=i[e];return r===void 0?[]:typeof r=="function"?n?[r.listener||r]:[r]:n?UNt(r):wwe(r,r.length)}$s.prototype.listeners=function(e){return Twe(this,e,!0)};$s.prototype.rawListeners=function(e){return Twe(this,e,!1)};$s.listenerCount=function(t,e){return typeof t.listenerCount=="function"?t.listenerCount(e):xwe.call(t,e)};$s.prototype.listenerCount=xwe;function xwe(t){var e=this._events;if(e!==void 0){var n=e[t];if(typeof n=="function")return 1;if(n!==void 0)return n.length}return 0}$s.prototype.eventNames=function(){return this._eventsCount>0?zL(this._events):[]};function wwe(t,e){for(var n=new Array(e),i=0;i<e;++i)n[i]=t[i];return n}function LNt(t,e){for(;e+1<t.length;e++)t[e]=t[e+1];t.pop()}function UNt(t){for(var e=new Array(t.length),n=0;n<e.length;++n)e[n]=t[n].listener||t[n];return e}function BNt(t,e){return new Promise(function(n,i){function r(a){t.removeListener(e,s),i(a)}function s(){typeof t.removeListener=="function"&&t.removeListener("error",r),n([].slice.call(arguments))}Cwe(t,e,s,{once:!0}),e!=="error"&&FNt(t,r,{once:!0})})}function FNt(t,e,n){typeof t.on=="function"&&Cwe(t,"error",e,n)}function Cwe(t,e,n,i){if(typeof t.on=="function")i.once?t.once(e,n):t.on(e,n);else if(typeof t.addEventListener=="function")t.addEventListener(e,function r(s){i.once&&t.removeEventListener(e,r),n(s)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof t)}var TP=KZ.exports;const kPt=il(TP);var Awe=TP.EventEmitter,IV,vce;function zNt(){if(vce)return IV;vce=1;function t(p,g){var _=Object.keys(p);if(Object.getOwnPropertySymbols){var v=Object.getOwnPropertySymbols(p);g&&(v=v.filter(function(b){return Object.getOwnPropertyDescriptor(p,b).enumerable})),_.push.apply(_,v)}return _}function e(p){for(var g=1;g<arguments.length;g++){var _=arguments[g]!=null?arguments[g]:{};g%2?t(Object(_),!0).forEach(function(v){n(p,v,_[v])}):Object.getOwnPropertyDescriptors?Object.defineProperties(p,Object.getOwnPropertyDescriptors(_)):t(Object(_)).forEach(function(v){Object.defineProperty(p,v,Object.getOwnPropertyDescriptor(_,v))})}return p}function n(p,g,_){return g=a(g),g in p?Object.defineProperty(p,g,{value:_,enumerable:!0,configurable:!0,writable:!0}):p[g]=_,p}function i(p,g){if(!(p instanceof g))throw new TypeError("Cannot call a class as a function")}function r(p,g){for(var _=0;_<g.length;_++){var v=g[_];v.enumerable=v.enumerable||!1,v.configurable=!0,"value"in v&&(v.writable=!0),Object.defineProperty(p,a(v.key),v)}}function s(p,g,_){return g&&r(p.prototype,g),Object.defineProperty(p,"prototype",{writable:!1}),p}function a(p){var g=o(p,"string");return typeof g=="symbol"?g:String(g)}function o(p,g){if(typeof p!="object"||p===null)return p;var _=p[Symbol.toPrimitive];if(_!==void 0){var v=_.call(p,g||"default");if(typeof v!="object")return v;throw new TypeError("@@toPrimitive must return a primitive value.")}return(g==="string"?String:Number)(p)}var c=SP,l=c.Buffer,u=S1,h=u.inspect,d=h&&h.custom||"inspect";function f(p,g,_){l.prototype.copy.call(p,g,_)}return IV=function(){function p(){i(this,p),this.head=null,this.tail=null,this.length=0}return s(p,[{key:"push",value:function(_){var v={data:_,next:null};this.length>0?this.tail.next=v:this.head=v,this.tail=v,++this.length}},{key:"unshift",value:function(_){var v={data:_,next:this.head};this.length===0&&(this.tail=v),this.head=v,++this.length}},{key:"shift",value:function(){if(this.length!==0){var _=this.head.data;return this.length===1?this.head=this.tail=null:this.head=this.head.next,--this.length,_}}},{key:"clear",value:function(){this.head=this.tail=null,this.length=0}},{key:"join",value:function(_){if(this.length===0)return"";for(var v=this.head,b=""+v.data;v=v.next;)b+=_+v.data;return b}},{key:"concat",value:function(_){if(this.length===0)return l.alloc(0);for(var v=l.allocUnsafe(_>>>0),b=this.head,S=0;b;)f(b.data,v,S),S+=b.data.length,b=b.next;return v}},{key:"consume",value:function(_,v){var b;return _<this.head.data.length?(b=this.head.data.slice(0,_),this.head.data=this.head.data.slice(_)):_===this.head.data.length?b=this.shift():b=v?this._getString(_):this._getBuffer(_),b}},{key:"first",value:function(){return this.head.data}},{key:"_getString",value:function(_){var v=this.head,b=1,S=v.data;for(_-=S.length;v=v.next;){var x=v.data,M=_>x.length?x.length:_;if(M===x.length?S+=x:S+=x.slice(0,_),_-=M,_===0){M===x.length?(++b,v.next?this.head=v.next:this.head=this.tail=null):(this.head=v,v.data=x.slice(M));break}++b}return this.length-=b,S}},{key:"_getBuffer",value:function(_){var v=l.allocUnsafe(_),b=this.head,S=1;for(b.data.copy(v),_-=b.data.length;b=b.next;){var x=b.data,M=_>x.length?x.length:_;if(x.copy(v,v.length-_,0,M),_-=M,_===0){M===x.length?(++S,b.next?this.head=b.next:this.head=this.tail=null):(this.head=b,b.data=x.slice(M));break}++S}return this.length-=S,v}},{key:d,value:function(_,v){return h(this,e(e({},v),{},{depth:0,customInspect:!1}))}}]),p}(),IV}function jNt(t,e){var n=this,i=this._readableState&&this._readableState.destroyed,r=this._writableState&&this._writableState.destroyed;return i||r?(e?e(t):t&&(this._writableState?this._writableState.errorEmitted||(this._writableState.errorEmitted=!0,Gn.nextTick(P7,this,t)):Gn.nextTick(P7,this,t)),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(t||null,function(s){!e&&s?n._writableState?n._writableState.errorEmitted?Gn.nextTick(jL,n):(n._writableState.errorEmitted=!0,Gn.nextTick(_ce,n,s)):Gn.nextTick(_ce,n,s):e?(Gn.nextTick(jL,n),e(s)):Gn.nextTick(jL,n)}),this)}function _ce(t,e){P7(t,e),jL(t)}function jL(t){t._writableState&&!t._writableState.emitClose||t._readableState&&!t._readableState.emitClose||t.emit("close")}function HNt(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finalCalled=!1,this._writableState.prefinished=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)}function P7(t,e){t.emit("error",e)}function VNt(t,e){var n=t._readableState,i=t._writableState;n&&n.autoDestroy||i&&i.autoDestroy?t.destroy(e):t.emit("error",e)}var Rwe={destroy:jNt,undestroy:HNt,errorOrDestroy:VNt},dx={};function GNt(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t,t.__proto__=e}var Mwe={};function Bp(t,e,n){n||(n=Error);function i(s,a,o){return typeof e=="string"?e:e(s,a,o)}var r=function(s){GNt(a,s);function a(o,c,l){return s.call(this,i(o,c,l))||this}return a}(n);r.prototype.name=n.name,r.prototype.code=t,Mwe[t]=r}function yce(t,e){if(Array.isArray(t)){var n=t.length;return t=t.map(function(i){return String(i)}),n>2?"one of ".concat(e," ").concat(t.slice(0,n-1).join(", "),", or ")+t[n-1]:n===2?"one of ".concat(e," ").concat(t[0]," or ").concat(t[1]):"of ".concat(e," ").concat(t[0])}else return"of ".concat(e," ").concat(String(t))}function qNt(t,e,n){return t.substr(0,e.length)===e}function $Nt(t,e,n){return(n===void 0||n>t.length)&&(n=t.length),t.substring(n-e.length,n)===e}function WNt(t,e,n){return typeof n!="number"&&(n=0),n+e.length>t.length?!1:t.indexOf(e,n)!==-1}Bp("ERR_INVALID_OPT_VALUE",function(t,e){return'The value "'+e+'" is invalid for option "'+t+'"'},TypeError);Bp("ERR_INVALID_ARG_TYPE",function(t,e,n){var i;typeof e=="string"&&qNt(e,"not ")?(i="must not be",e=e.replace(/^not /,"")):i="must be";var r;if($Nt(t," argument"))r="The ".concat(t," ").concat(i," ").concat(yce(e,"type"));else{var s=WNt(t,".")?"property":"argument";r='The "'.concat(t,'" ').concat(s," ").concat(i," ").concat(yce(e,"type"))}return r+=". Received type ".concat(typeof n),r},TypeError);Bp("ERR_STREAM_PUSH_AFTER_EOF","stream.push() after EOF");Bp("ERR_METHOD_NOT_IMPLEMENTED",function(t){return"The "+t+" method is not implemented"});Bp("ERR_STREAM_PREMATURE_CLOSE","Premature close");Bp("ERR_STREAM_DESTROYED",function(t){return"Cannot call "+t+" after a stream was destroyed"});Bp("ERR_MULTIPLE_CALLBACK","Callback called multiple times");Bp("ERR_STREAM_CANNOT_PIPE","Cannot pipe, not readable");Bp("ERR_STREAM_WRITE_AFTER_END","write after end");Bp("ERR_STREAM_NULL_VALUES","May not write null values to stream",TypeError);Bp("ERR_UNKNOWN_ENCODING",function(t){return"Unknown encoding: "+t},TypeError);Bp("ERR_STREAM_UNSHIFT_AFTER_END_EVENT","stream.unshift() after end event");dx.codes=Mwe;var YNt=dx.codes.ERR_INVALID_OPT_VALUE;function KNt(t,e,n){return t.highWaterMark!=null?t.highWaterMark:e?t[n]:null}function XNt(t,e,n,i){var r=KNt(e,i,n);if(r!=null){if(!(isFinite(r)&&Math.floor(r)===r)||r<0){var s=i?n:"highWaterMark";throw new YNt(s,r)}return Math.floor(r)}return t.objectMode?16:16*1024}var Owe={getHighWaterMark:XNt},D7={exports:{}};typeof Object.create=="function"?D7.exports=function(e,n){n&&(e.super_=n,e.prototype=Object.create(n.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}))}:D7.exports=function(e,n){if(n){e.super_=n;var i=function(){};i.prototype=n.prototype,e.prototype=new i,e.prototype.constructor=e}};var xP=D7.exports,ZNt=JNt;function JNt(t,e){if(kV("noDeprecation"))return t;var n=!1;function i(){if(!n){if(kV("throwDeprecation"))throw new Error(e);kV("traceDeprecation")?console.trace(e):console.warn(e),n=!0}return t.apply(this,arguments)}return i}function kV(t){try{if(!Ml.localStorage)return!1}catch{return!1}var e=Ml.localStorage[t];return e==null?!1:String(e).toLowerCase()==="true"}var PV,bce;function Nwe(){if(bce)return PV;bce=1,PV=k;function t(ge){var _e=this;this.next=null,this.entry=null,this.finish=function(){Re(_e,ge)}}var e;k.WritableState=R;var n={deprecate:ZNt},i=Awe,r=SP.Buffer,s=(typeof Ml<"u"?Ml:typeof window<"u"?window:typeof self<"u"?self:{}).Uint8Array||function(){};function a(ge){return r.from(ge)}function o(ge){return r.isBuffer(ge)||ge instanceof s}var c=Rwe,l=Owe,u=l.getHighWaterMark,h=dx.codes,d=h.ERR_INVALID_ARG_TYPE,f=h.ERR_METHOD_NOT_IMPLEMENTED,p=h.ERR_MULTIPLE_CALLBACK,g=h.ERR_STREAM_CANNOT_PIPE,_=h.ERR_STREAM_DESTROYED,v=h.ERR_STREAM_NULL_VALUES,b=h.ERR_STREAM_WRITE_AFTER_END,S=h.ERR_UNKNOWN_ENCODING,x=c.errorOrDestroy;xP(k,i);function M(){}function R(ge,_e,ke){e=e||$A(),ge=ge||{},typeof ke!="boolean"&&(ke=_e instanceof e),this.objectMode=!!ge.objectMode,ke&&(this.objectMode=this.objectMode||!!ge.writableObjectMode),this.highWaterMark=u(this,ge,"writableHighWaterMark",ke),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var gt=ge.decodeStrings===!1;this.decodeStrings=!gt,this.defaultEncoding=ge.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(wt){G(_e,wt)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.emitClose=ge.emitClose!==!1,this.autoDestroy=!!ge.autoDestroy,this.bufferedRequestCount=0,this.corkedRequestsFree=new t(this)}R.prototype.getBuffer=function(){for(var _e=this.bufferedRequest,ke=[];_e;)ke.push(_e),_e=_e.next;return ke},function(){try{Object.defineProperty(R.prototype,"buffer",{get:n.deprecate(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch{}}();var I;typeof Symbol=="function"&&Symbol.hasInstance&&typeof Function.prototype[Symbol.hasInstance]=="function"?(I=Function.prototype[Symbol.hasInstance],Object.defineProperty(k,Symbol.hasInstance,{value:function(_e){return I.call(this,_e)?!0:this!==k?!1:_e&&_e._writableState instanceof R}})):I=function(_e){return _e instanceof this};function k(ge){e=e||$A();var _e=this instanceof e;if(!_e&&!I.call(k,this))return new k(ge);this._writableState=new R(ge,this,_e),this.writable=!0,ge&&(typeof ge.write=="function"&&(this._write=ge.write),typeof ge.writev=="function"&&(this._writev=ge.writev),typeof ge.destroy=="function"&&(this._destroy=ge.destroy),typeof ge.final=="function"&&(this._final=ge.final)),i.call(this)}k.prototype.pipe=function(){x(this,new g)};function P(ge,_e){var ke=new b;x(ge,ke),Gn.nextTick(_e,ke)}function U(ge,_e,ke,gt){var wt;return ke===null?wt=new v:typeof ke!="string"&&!_e.objectMode&&(wt=new d("chunk",["string","Buffer"],ke)),wt?(x(ge,wt),Gn.nextTick(gt,wt),!1):!0}k.prototype.write=function(ge,_e,ke){var gt=this._writableState,wt=!1,ye=!gt.objectMode&&o(ge);return ye&&!r.isBuffer(ge)&&(ge=a(ge)),typeof _e=="function"&&(ke=_e,_e=null),ye?_e="buffer":_e||(_e=gt.defaultEncoding),typeof ke!="function"&&(ke=M),gt.ending?P(this,ke):(ye||U(this,gt,ge,ke))&&(gt.pendingcb++,wt=$(this,gt,ye,ge,_e,ke)),wt},k.prototype.cork=function(){this._writableState.corked++},k.prototype.uncork=function(){var ge=this._writableState;ge.corked&&(ge.corked--,!ge.writing&&!ge.corked&&!ge.bufferProcessing&&ge.bufferedRequest&&X(this,ge))},k.prototype.setDefaultEncoding=function(_e){if(typeof _e=="string"&&(_e=_e.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((_e+"").toLowerCase())>-1))throw new S(_e);return this._writableState.defaultEncoding=_e,this},Object.defineProperty(k.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}});function V(ge,_e,ke){return!ge.objectMode&&ge.decodeStrings!==!1&&typeof _e=="string"&&(_e=r.from(_e,ke)),_e}Object.defineProperty(k.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}});function $(ge,_e,ke,gt,wt,ye){if(!ke){var Se=V(_e,gt,wt);gt!==Se&&(ke=!0,wt="buffer",gt=Se)}var Qe=_e.objectMode?1:gt.length;_e.length+=Qe;var pe=_e.length<_e.highWaterMark;if(pe||(_e.needDrain=!0),_e.writing||_e.corked){var ze=_e.lastBufferedRequest;_e.lastBufferedRequest={chunk:gt,encoding:wt,isBuf:ke,callback:ye,next:null},ze?ze.next=_e.lastBufferedRequest:_e.bufferedRequest=_e.lastBufferedRequest,_e.bufferedRequestCount+=1}else q(ge,_e,!1,Qe,gt,wt,ye);return pe}function q(ge,_e,ke,gt,wt,ye,Se){_e.writelen=gt,_e.writecb=Se,_e.writing=!0,_e.sync=!0,_e.destroyed?_e.onwrite(new _("write")):ke?ge._writev(wt,_e.onwrite):ge._write(wt,ye,_e.onwrite),_e.sync=!1}function Y(ge,_e,ke,gt,wt){--_e.pendingcb,ke?(Gn.nextTick(wt,gt),Gn.nextTick(Fe,ge,_e),ge._writableState.errorEmitted=!0,x(ge,gt)):(wt(gt),ge._writableState.errorEmitted=!0,x(ge,gt),Fe(ge,_e))}function te(ge){ge.writing=!1,ge.writecb=null,ge.length-=ge.writelen,ge.writelen=0}function G(ge,_e){var ke=ge._writableState,gt=ke.sync,wt=ke.writecb;if(typeof wt!="function")throw new p;if(te(ke),_e)Y(ge,ke,gt,_e,wt);else{var ye=ae(ke)||ge.destroyed;!ye&&!ke.corked&&!ke.bufferProcessing&&ke.bufferedRequest&&X(ge,ke),gt?Gn.nextTick(J,ge,ke,ye,wt):J(ge,ke,ye,wt)}}function J(ge,_e,ke,gt){ke||K(ge,_e),_e.pendingcb--,gt(),Fe(ge,_e)}function K(ge,_e){_e.length===0&&_e.needDrain&&(_e.needDrain=!1,ge.emit("drain"))}function X(ge,_e){_e.bufferProcessing=!0;var ke=_e.bufferedRequest;if(ge._writev&&ke&&ke.next){var gt=_e.bufferedRequestCount,wt=new Array(gt),ye=_e.corkedRequestsFree;ye.entry=ke;for(var Se=0,Qe=!0;ke;)wt[Se]=ke,ke.isBuf||(Qe=!1),ke=ke.next,Se+=1;wt.allBuffers=Qe,q(ge,_e,!0,_e.length,wt,"",ye.finish),_e.pendingcb++,_e.lastBufferedRequest=null,ye.next?(_e.corkedRequestsFree=ye.next,ye.next=null):_e.corkedRequestsFree=new t(_e),_e.bufferedRequestCount=0}else{for(;ke;){var pe=ke.chunk,ze=ke.encoding,Le=ke.callback,rt=_e.objectMode?1:pe.length;if(q(ge,_e,!1,rt,pe,ze,Le),ke=ke.next,_e.bufferedRequestCount--,_e.writing)break}ke===null&&(_e.lastBufferedRequest=null)}_e.bufferedRequest=ke,_e.bufferProcessing=!1}k.prototype._write=function(ge,_e,ke){ke(new f("_write()"))},k.prototype._writev=null,k.prototype.end=function(ge,_e,ke){var gt=this._writableState;return typeof ge=="function"?(ke=ge,ge=null,_e=null):typeof _e=="function"&&(ke=_e,_e=null),ge!=null&&this.write(ge,_e),gt.corked&&(gt.corked=1,this.uncork()),gt.ending||Te(this,gt,ke),this},Object.defineProperty(k.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}});function ae(ge){return ge.ending&&ge.length===0&&ge.bufferedRequest===null&&!ge.finished&&!ge.writing}function ce(ge,_e){ge._final(function(ke){_e.pendingcb--,ke&&x(ge,ke),_e.prefinished=!0,ge.emit("prefinish"),Fe(ge,_e)})}function Me(ge,_e){!_e.prefinished&&!_e.finalCalled&&(typeof ge._final=="function"&&!_e.destroyed?(_e.pendingcb++,_e.finalCalled=!0,Gn.nextTick(ce,ge,_e)):(_e.prefinished=!0,ge.emit("prefinish")))}function Fe(ge,_e){var ke=ae(_e);if(ke&&(Me(ge,_e),_e.pendingcb===0&&(_e.finished=!0,ge.emit("finish"),_e.autoDestroy))){var gt=ge._readableState;(!gt||gt.autoDestroy&&gt.endEmitted)&&ge.destroy()}return ke}function Te(ge,_e,ke){_e.ending=!0,Fe(ge,_e),ke&&(_e.finished?Gn.nextTick(ke):ge.once("finish",ke)),_e.ended=!0,ge.writable=!1}function Re(ge,_e,ke){var gt=ge.entry;for(ge.entry=null;gt;){var wt=gt.callback;_e.pendingcb--,wt(ke),gt=gt.next}_e.corkedRequestsFree.next=ge}return Object.defineProperty(k.prototype,"destroyed",{enumerable:!1,get:function(){return this._writableState===void 0?!1:this._writableState.destroyed},set:function(_e){this._writableState&&(this._writableState.destroyed=_e)}}),k.prototype.destroy=c.destroy,k.prototype._undestroy=c.undestroy,k.prototype._destroy=function(ge,_e){_e(ge)},PV}var DV,Ece;function $A(){if(Ece)return DV;Ece=1;var t=Object.keys||function(l){var u=[];for(var h in l)u.push(h);return u};DV=a;var e=kwe(),n=Nwe();xP(a,e);for(var i=t(n.prototype),r=0;r<i.length;r++){var s=i[r];a.prototype[s]||(a.prototype[s]=n.prototype[s])}function a(l){if(!(this instanceof a))return new a(l);e.call(this,l),n.call(this,l),this.allowHalfOpen=!0,l&&(l.readable===!1&&(this.readable=!1),l.writable===!1&&(this.writable=!1),l.allowHalfOpen===!1&&(this.allowHalfOpen=!1,this.once("end",o)))}Object.defineProperty(a.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Object.defineProperty(a.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(a.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}});function o(){this._writableState.ended||Gn.nextTick(c,this)}function c(l){l.end()}return Object.defineProperty(a.prototype,"destroyed",{enumerable:!1,get:function(){return this._readableState===void 0||this._writableState===void 0?!1:this._readableState.destroyed&&this._writableState.destroyed},set:function(u){this._readableState===void 0||this._writableState===void 0||(this._readableState.destroyed=u,this._writableState.destroyed=u)}}),DV}var LV={},Sce;function Tce(){if(Sce)return LV;Sce=1;var t=_we.Buffer,e=t.isEncoding||function(v){switch(v=""+v,v&&v.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function n(v){if(!v)return"utf8";for(var b;;)switch(v){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return v;default:if(b)return;v=(""+v).toLowerCase(),b=!0}}function i(v){var b=n(v);if(typeof b!="string"&&(t.isEncoding===e||!e(v)))throw new Error("Unknown encoding: "+v);return b||v}LV.StringDecoder=r;function r(v){this.encoding=i(v);var b;switch(this.encoding){case"utf16le":this.text=h,this.end=d,b=4;break;case"utf8":this.fillLast=c,b=4;break;case"base64":this.text=f,this.end=p,b=3;break;default:this.write=g,this.end=_;return}this.lastNeed=0,this.lastTotal=0,this.lastChar=t.allocUnsafe(b)}r.prototype.write=function(v){if(v.length===0)return"";var b,S;if(this.lastNeed){if(b=this.fillLast(v),b===void 0)return"";S=this.lastNeed,this.lastNeed=0}else S=0;return S<v.length?b?b+this.text(v,S):this.text(v,S):b||""},r.prototype.end=u,r.prototype.text=l,r.prototype.fillLast=function(v){if(this.lastNeed<=v.length)return v.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);v.copy(this.lastChar,this.lastTotal-this.lastNeed,0,v.length),this.lastNeed-=v.length};function s(v){return v<=127?0:v>>5===6?2:v>>4===14?3:v>>3===30?4:v>>6===2?-1:-2}function a(v,b,S){var x=b.length-1;if(x<S)return 0;var M=s(b[x]);return M>=0?(M>0&&(v.lastNeed=M-1),M):--x<S||M===-2?0:(M=s(b[x]),M>=0?(M>0&&(v.lastNeed=M-2),M):--x<S||M===-2?0:(M=s(b[x]),M>=0?(M>0&&(M===2?M=0:v.lastNeed=M-3),M):0))}function o(v,b,S){if((b[0]&192)!==128)return v.lastNeed=0,"";if(v.lastNeed>1&&b.length>1){if((b[1]&192)!==128)return v.lastNeed=1,"";if(v.lastNeed>2&&b.length>2&&(b[2]&192)!==128)return v.lastNeed=2,""}}function c(v){var b=this.lastTotal-this.lastNeed,S=o(this,v);if(S!==void 0)return S;if(this.lastNeed<=v.length)return v.copy(this.lastChar,b,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);v.copy(this.lastChar,b,0,v.length),this.lastNeed-=v.length}function l(v,b){var S=a(this,v,b);if(!this.lastNeed)return v.toString("utf8",b);this.lastTotal=S;var x=v.length-(S-this.lastNeed);return v.copy(this.lastChar,0,x),v.toString("utf8",b,x)}function u(v){var b=v&&v.length?this.write(v):"";return this.lastNeed?b+"":b}function h(v,b){if((v.length-b)%2===0){var S=v.toString("utf16le",b);if(S){var x=S.charCodeAt(S.length-1);if(x>=55296&&x<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=v[v.length-2],this.lastChar[1]=v[v.length-1],S.slice(0,-1)}return S}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=v[v.length-1],v.toString("utf16le",b,v.length-1)}function d(v){var b=v&&v.length?this.write(v):"";if(this.lastNeed){var S=this.lastTotal-this.lastNeed;return b+this.lastChar.toString("utf16le",0,S)}return b}function f(v,b){var S=(v.length-b)%3;return S===0?v.toString("base64",b):(this.lastNeed=3-S,this.lastTotal=3,S===1?this.lastChar[0]=v[v.length-1]:(this.lastChar[0]=v[v.length-2],this.lastChar[1]=v[v.length-1]),v.toString("base64",b,v.length-S))}function p(v){var b=v&&v.length?this.write(v):"";return this.lastNeed?b+this.lastChar.toString("base64",0,3-this.lastNeed):b}function g(v){return v.toString(this.encoding)}function _(v){return v&&v.length?this.write(v):""}return LV}var xce=dx.codes.ERR_STREAM_PREMATURE_CLOSE;function QNt(t){var e=!1;return function(){if(!e){e=!0;for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];t.apply(this,i)}}}function eIt(){}function tIt(t){return t.setHeader&&typeof t.abort=="function"}function Iwe(t,e,n){if(typeof e=="function")return Iwe(t,null,e);e||(e={}),n=QNt(n||eIt);var i=e.readable||e.readable!==!1&&t.readable,r=e.writable||e.writable!==!1&&t.writable,s=function(){t.writable||o()},a=t._writableState&&t._writableState.finished,o=function(){r=!1,a=!0,i||n.call(t)},c=t._readableState&&t._readableState.endEmitted,l=function(){i=!1,c=!0,r||n.call(t)},u=function(p){n.call(t,p)},h=function(){var p;if(i&&!c)return(!t._readableState||!t._readableState.ended)&&(p=new xce),n.call(t,p);if(r&&!a)return(!t._writableState||!t._writableState.ended)&&(p=new xce),n.call(t,p)},d=function(){t.req.on("finish",o)};return tIt(t)?(t.on("complete",o),t.on("abort",h),t.req?d():t.on("request",d)):r&&!t._writableState&&(t.on("end",s),t.on("close",s)),t.on("end",l),t.on("finish",o),e.error!==!1&&t.on("error",u),t.on("close",h),function(){t.removeListener("complete",o),t.removeListener("abort",h),t.removeListener("request",d),t.req&&t.req.removeListener("finish",o),t.removeListener("end",s),t.removeListener("close",s),t.removeListener("finish",o),t.removeListener("end",l),t.removeListener("error",u),t.removeListener("close",h)}}var XZ=Iwe,UV,wce;function nIt(){if(wce)return UV;wce=1;var t;function e(S,x,M){return x=n(x),x in S?Object.defineProperty(S,x,{value:M,enumerable:!0,configurable:!0,writable:!0}):S[x]=M,S}function n(S){var x=i(S,"string");return typeof x=="symbol"?x:String(x)}function i(S,x){if(typeof S!="object"||S===null)return S;var M=S[Symbol.toPrimitive];if(M!==void 0){var R=M.call(S,x||"default");if(typeof R!="object")return R;throw new TypeError("@@toPrimitive must return a primitive value.")}return(x==="string"?String:Number)(S)}var r=XZ,s=Symbol("lastResolve"),a=Symbol("lastReject"),o=Symbol("error"),c=Symbol("ended"),l=Symbol("lastPromise"),u=Symbol("handlePromise"),h=Symbol("stream");function d(S,x){return{value:S,done:x}}function f(S){var x=S[s];if(x!==null){var M=S[h].read();M!==null&&(S[l]=null,S[s]=null,S[a]=null,x(d(M,!1)))}}function p(S){Gn.nextTick(f,S)}function g(S,x){return function(M,R){S.then(function(){if(x[c]){M(d(void 0,!0));return}x[u](M,R)},R)}}var _=Object.getPrototypeOf(function(){}),v=Object.setPrototypeOf((t={get stream(){return this[h]},next:function(){var x=this,M=this[o];if(M!==null)return Promise.reject(M);if(this[c])return Promise.resolve(d(void 0,!0));if(this[h].destroyed)return new Promise(function(P,U){Gn.nextTick(function(){x[o]?U(x[o]):P(d(void 0,!0))})});var R=this[l],I;if(R)I=new Promise(g(R,this));else{var k=this[h].read();if(k!==null)return Promise.resolve(d(k,!1));I=new Promise(this[u])}return this[l]=I,I}},e(t,Symbol.asyncIterator,function(){return this}),e(t,"return",function(){var x=this;return new Promise(function(M,R){x[h].destroy(null,function(I){if(I){R(I);return}M(d(void 0,!0))})})}),t),_),b=function(x){var M,R=Object.create(v,(M={},e(M,h,{value:x,writable:!0}),e(M,s,{value:null,writable:!0}),e(M,a,{value:null,writable:!0}),e(M,o,{value:null,writable:!0}),e(M,c,{value:x._readableState.endEmitted,writable:!0}),e(M,u,{value:function(k,P){var U=R[h].read();U?(R[l]=null,R[s]=null,R[a]=null,k(d(U,!1))):(R[s]=k,R[a]=P)},writable:!0}),M));return R[l]=null,r(x,function(I){if(I&&I.code!=="ERR_STREAM_PREMATURE_CLOSE"){var k=R[a];k!==null&&(R[l]=null,R[s]=null,R[a]=null,k(I)),R[o]=I;return}var P=R[s];P!==null&&(R[l]=null,R[s]=null,R[a]=null,P(d(void 0,!0))),R[c]=!0}),x.on("readable",p.bind(null,R)),R};return UV=b,UV}var BV,Cce;function iIt(){return Cce||(Cce=1,BV=function(){throw new Error("Readable.from is not available in the browser")}),BV}var FV,Ace;function kwe(){if(Ace)return FV;Ace=1,FV=P;var t;P.ReadableState=k,TP.EventEmitter;var e=function(Se,Qe){return Se.listeners(Qe).length},n=Awe,i=SP.Buffer,r=(typeof Ml<"u"?Ml:typeof window<"u"?window:typeof self<"u"?self:{}).Uint8Array||function(){};function s(ye){return i.from(ye)}function a(ye){return i.isBuffer(ye)||ye instanceof r}var o=S1,c;o&&o.debuglog?c=o.debuglog("stream"):c=function(){};var l=zNt(),u=Rwe,h=Owe,d=h.getHighWaterMark,f=dx.codes,p=f.ERR_INVALID_ARG_TYPE,g=f.ERR_STREAM_PUSH_AFTER_EOF,_=f.ERR_METHOD_NOT_IMPLEMENTED,v=f.ERR_STREAM_UNSHIFT_AFTER_END_EVENT,b,S,x;xP(P,n);var M=u.errorOrDestroy,R=["error","close","destroy","pause","resume"];function I(ye,Se,Qe){if(typeof ye.prependListener=="function")return ye.prependListener(Se,Qe);!ye._events||!ye._events[Se]?ye.on(Se,Qe):Array.isArray(ye._events[Se])?ye._events[Se].unshift(Qe):ye._events[Se]=[Qe,ye._events[Se]]}function k(ye,Se,Qe){t=t||$A(),ye=ye||{},typeof Qe!="boolean"&&(Qe=Se instanceof t),this.objectMode=!!ye.objectMode,Qe&&(this.objectMode=this.objectMode||!!ye.readableObjectMode),this.highWaterMark=d(this,ye,"readableHighWaterMark",Qe),this.buffer=new l,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.paused=!0,this.emitClose=ye.emitClose!==!1,this.autoDestroy=!!ye.autoDestroy,this.destroyed=!1,this.defaultEncoding=ye.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,ye.encoding&&(b||(b=Tce().StringDecoder),this.decoder=new b(ye.encoding),this.encoding=ye.encoding)}function P(ye){if(t=t||$A(),!(this instanceof P))return new P(ye);var Se=this instanceof t;this._readableState=new k(ye,this,Se),this.readable=!0,ye&&(typeof ye.read=="function"&&(this._read=ye.read),typeof ye.destroy=="function"&&(this._destroy=ye.destroy)),n.call(this)}Object.defineProperty(P.prototype,"destroyed",{enumerable:!1,get:function(){return this._readableState===void 0?!1:this._readableState.destroyed},set:function(Se){this._readableState&&(this._readableState.destroyed=Se)}}),P.prototype.destroy=u.destroy,P.prototype._undestroy=u.undestroy,P.prototype._destroy=function(ye,Se){Se(ye)},P.prototype.push=function(ye,Se){var Qe=this._readableState,pe;return Qe.objectMode?pe=!0:typeof ye=="string"&&(Se=Se||Qe.defaultEncoding,Se!==Qe.encoding&&(ye=i.from(ye,Se),Se=""),pe=!0),U(this,ye,Se,!1,pe)},P.prototype.unshift=function(ye){return U(this,ye,null,!0,!1)};function U(ye,Se,Qe,pe,ze){c("readableAddChunk",Se);var Le=ye._readableState;if(Se===null)Le.reading=!1,G(ye,Le);else{var rt;if(ze||(rt=$(Le,Se)),rt)M(ye,rt);else if(Le.objectMode||Se&&Se.length>0)if(typeof Se!="string"&&!Le.objectMode&&Object.getPrototypeOf(Se)!==i.prototype&&(Se=s(Se)),pe)Le.endEmitted?M(ye,new v):V(ye,Le,Se,!0);else if(Le.ended)M(ye,new g);else{if(Le.destroyed)return!1;Le.reading=!1,Le.decoder&&!Qe?(Se=Le.decoder.write(Se),Le.objectMode||Se.length!==0?V(ye,Le,Se,!1):X(ye,Le)):V(ye,Le,Se,!1)}else pe||(Le.reading=!1,X(ye,Le))}return!Le.ended&&(Le.length<Le.highWaterMark||Le.length===0)}function V(ye,Se,Qe,pe){Se.flowing&&Se.length===0&&!Se.sync?(Se.awaitDrain=0,ye.emit("data",Qe)):(Se.length+=Se.objectMode?1:Qe.length,pe?Se.buffer.unshift(Qe):Se.buffer.push(Qe),Se.needReadable&&J(ye)),X(ye,Se)}function $(ye,Se){var Qe;return!a(Se)&&typeof Se!="string"&&Se!==void 0&&!ye.objectMode&&(Qe=new p("chunk",["string","Buffer","Uint8Array"],Se)),Qe}P.prototype.isPaused=function(){return this._readableState.flowing===!1},P.prototype.setEncoding=function(ye){b||(b=Tce().StringDecoder);var Se=new b(ye);this._readableState.decoder=Se,this._readableState.encoding=this._readableState.decoder.encoding;for(var Qe=this._readableState.buffer.head,pe="";Qe!==null;)pe+=Se.write(Qe.data),Qe=Qe.next;return this._readableState.buffer.clear(),pe!==""&&this._readableState.buffer.push(pe),this._readableState.length=pe.length,this};var q=1073741824;function Y(ye){return ye>=q?ye=q:(ye--,ye|=ye>>>1,ye|=ye>>>2,ye|=ye>>>4,ye|=ye>>>8,ye|=ye>>>16,ye++),ye}function te(ye,Se){return ye<=0||Se.length===0&&Se.ended?0:Se.objectMode?1:ye!==ye?Se.flowing&&Se.length?Se.buffer.head.data.length:Se.length:(ye>Se.highWaterMark&&(Se.highWaterMark=Y(ye)),ye<=Se.length?ye:Se.ended?Se.length:(Se.needReadable=!0,0))}P.prototype.read=function(ye){c("read",ye),ye=parseInt(ye,10);var Se=this._readableState,Qe=ye;if(ye!==0&&(Se.emittedReadable=!1),ye===0&&Se.needReadable&&((Se.highWaterMark!==0?Se.length>=Se.highWaterMark:Se.length>0)||Se.ended))return c("read: emitReadable",Se.length,Se.ended),Se.length===0&&Se.ended?ke(this):J(this),null;if(ye=te(ye,Se),ye===0&&Se.ended)return Se.length===0&&ke(this),null;var pe=Se.needReadable;c("need readable",pe),(Se.length===0||Se.length-ye<Se.highWaterMark)&&(pe=!0,c("length less than watermark",pe)),Se.ended||Se.reading?(pe=!1,c("reading or ended",pe)):pe&&(c("do read"),Se.reading=!0,Se.sync=!0,Se.length===0&&(Se.needReadable=!0),this._read(Se.highWaterMark),Se.sync=!1,Se.reading||(ye=te(Qe,Se)));var ze;return ye>0?ze=_e(ye,Se):ze=null,ze===null?(Se.needReadable=Se.length<=Se.highWaterMark,ye=0):(Se.length-=ye,Se.awaitDrain=0),Se.length===0&&(Se.ended||(Se.needReadable=!0),Qe!==ye&&Se.ended&&ke(this)),ze!==null&&this.emit("data",ze),ze};function G(ye,Se){if(c("onEofChunk"),!Se.ended){if(Se.decoder){var Qe=Se.decoder.end();Qe&&Qe.length&&(Se.buffer.push(Qe),Se.length+=Se.objectMode?1:Qe.length)}Se.ended=!0,Se.sync?J(ye):(Se.needReadable=!1,Se.emittedReadable||(Se.emittedReadable=!0,K(ye)))}}function J(ye){var Se=ye._readableState;c("emitReadable",Se.needReadable,Se.emittedReadable),Se.needReadable=!1,Se.emittedReadable||(c("emitReadable",Se.flowing),Se.emittedReadable=!0,Gn.nextTick(K,ye))}function K(ye){var Se=ye._readableState;c("emitReadable_",Se.destroyed,Se.length,Se.ended),!Se.destroyed&&(Se.length||Se.ended)&&(ye.emit("readable"),Se.emittedReadable=!1),Se.needReadable=!Se.flowing&&!Se.ended&&Se.length<=Se.highWaterMark,ge(ye)}function X(ye,Se){Se.readingMore||(Se.readingMore=!0,Gn.nextTick(ae,ye,Se))}function ae(ye,Se){for(;!Se.reading&&!Se.ended&&(Se.length<Se.highWaterMark||Se.flowing&&Se.length===0);){var Qe=Se.length;if(c("maybeReadMore read 0"),ye.read(0),Qe===Se.length)break}Se.readingMore=!1}P.prototype._read=function(ye){M(this,new _("_read()"))},P.prototype.pipe=function(ye,Se){var Qe=this,pe=this._readableState;switch(pe.pipesCount){case 0:pe.pipes=ye;break;case 1:pe.pipes=[pe.pipes,ye];break;default:pe.pipes.push(ye);break}pe.pipesCount+=1,c("pipe count=%d opts=%j",pe.pipesCount,Se);var ze=(!Se||Se.end!==!1)&&ye!==Gn.stdout&&ye!==Gn.stderr,Le=ze?dt:ct;pe.endEmitted?Gn.nextTick(Le):Qe.once("end",Le),ye.on("unpipe",rt);function rt(tn,Ht){c("onunpipe"),tn===Qe&&Ht&&Ht.hasUnpiped===!1&&(Ht.hasUnpiped=!0,we())}function dt(){c("onend"),ye.end()}var pt=ce(Qe);ye.on("drain",pt);var bt=!1;function we(){c("cleanup"),ye.removeListener("close",et),ye.removeListener("finish",Et),ye.removeListener("drain",pt),ye.removeListener("error",$e),ye.removeListener("unpipe",rt),Qe.removeListener("end",dt),Qe.removeListener("end",ct),Qe.removeListener("data",he),bt=!0,pe.awaitDrain&&(!ye._writableState||ye._writableState.needDrain)&&pt()}Qe.on("data",he);function he(tn){c("ondata");var Ht=ye.write(tn);c("dest.write",Ht),Ht===!1&&((pe.pipesCount===1&&pe.pipes===ye||pe.pipesCount>1&&wt(pe.pipes,ye)!==-1)&&!bt&&(c("false write response, pause",pe.awaitDrain),pe.awaitDrain++),Qe.pause())}function $e(tn){c("onerror",tn),ct(),ye.removeListener("error",$e),e(ye,"error")===0&&M(ye,tn)}I(ye,"error",$e);function et(){ye.removeListener("finish",Et),ct()}ye.once("close",et);function Et(){c("onfinish"),ye.removeListener("close",et),ct()}ye.once("finish",Et);function ct(){c("unpipe"),Qe.unpipe(ye)}return ye.emit("pipe",Qe),pe.flowing||(c("pipe resume"),Qe.resume()),ye};function ce(ye){return function(){var Qe=ye._readableState;c("pipeOnDrain",Qe.awaitDrain),Qe.awaitDrain&&Qe.awaitDrain--,Qe.awaitDrain===0&&e(ye,"data")&&(Qe.flowing=!0,ge(ye))}}P.prototype.unpipe=function(ye){var Se=this._readableState,Qe={hasUnpiped:!1};if(Se.pipesCount===0)return this;if(Se.pipesCount===1)return ye&&ye!==Se.pipes?this:(ye||(ye=Se.pipes),Se.pipes=null,Se.pipesCount=0,Se.flowing=!1,ye&&ye.emit("unpipe",this,Qe),this);if(!ye){var pe=Se.pipes,ze=Se.pipesCount;Se.pipes=null,Se.pipesCount=0,Se.flowing=!1;for(var Le=0;Le<ze;Le++)pe[Le].emit("unpipe",this,{hasUnpiped:!1});return this}var rt=wt(Se.pipes,ye);return rt===-1?this:(Se.pipes.splice(rt,1),Se.pipesCount-=1,Se.pipesCount===1&&(Se.pipes=Se.pipes[0]),ye.emit("unpipe",this,Qe),this)},P.prototype.on=function(ye,Se){var Qe=n.prototype.on.call(this,ye,Se),pe=this._readableState;return ye==="data"?(pe.readableListening=this.listenerCount("readable")>0,pe.flowing!==!1&&this.resume()):ye==="readable"&&!pe.endEmitted&&!pe.readableListening&&(pe.readableListening=pe.needReadable=!0,pe.flowing=!1,pe.emittedReadable=!1,c("on readable",pe.length,pe.reading),pe.length?J(this):pe.reading||Gn.nextTick(Fe,this)),Qe},P.prototype.addListener=P.prototype.on,P.prototype.removeListener=function(ye,Se){var Qe=n.prototype.removeListener.call(this,ye,Se);return ye==="readable"&&Gn.nextTick(Me,this),Qe},P.prototype.removeAllListeners=function(ye){var Se=n.prototype.removeAllListeners.apply(this,arguments);return(ye==="readable"||ye===void 0)&&Gn.nextTick(Me,this),Se};function Me(ye){var Se=ye._readableState;Se.readableListening=ye.listenerCount("readable")>0,Se.resumeScheduled&&!Se.paused?Se.flowing=!0:ye.listenerCount("data")>0&&ye.resume()}function Fe(ye){c("readable nexttick read 0"),ye.read(0)}P.prototype.resume=function(){var ye=this._readableState;return ye.flowing||(c("resume"),ye.flowing=!ye.readableListening,Te(this,ye)),ye.paused=!1,this};function Te(ye,Se){Se.resumeScheduled||(Se.resumeScheduled=!0,Gn.nextTick(Re,ye,Se))}function Re(ye,Se){c("resume",Se.reading),Se.reading||ye.read(0),Se.resumeScheduled=!1,ye.emit("resume"),ge(ye),Se.flowing&&!Se.reading&&ye.read(0)}P.prototype.pause=function(){return c("call pause flowing=%j",this._readableState.flowing),this._readableState.flowing!==!1&&(c("pause"),this._readableState.flowing=!1,this.emit("pause")),this._readableState.paused=!0,this};function ge(ye){var Se=ye._readableState;for(c("flow",Se.flowing);Se.flowing&&ye.read()!==null;);}P.prototype.wrap=function(ye){var Se=this,Qe=this._readableState,pe=!1;ye.on("end",function(){if(c("wrapped end"),Qe.decoder&&!Qe.ended){var rt=Qe.decoder.end();rt&&rt.length&&Se.push(rt)}Se.push(null)}),ye.on("data",function(rt){if(c("wrapped data"),Qe.decoder&&(rt=Qe.decoder.write(rt)),!(Qe.objectMode&&rt==null)&&!(!Qe.objectMode&&(!rt||!rt.length))){var dt=Se.push(rt);dt||(pe=!0,ye.pause())}});for(var ze in ye)this[ze]===void 0&&typeof ye[ze]=="function"&&(this[ze]=function(dt){return function(){return ye[dt].apply(ye,arguments)}}(ze));for(var Le=0;Le<R.length;Le++)ye.on(R[Le],this.emit.bind(this,R[Le]));return this._read=function(rt){c("wrapped _read",rt),pe&&(pe=!1,ye.resume())},this},typeof Symbol=="function"&&(P.prototype[Symbol.asyncIterator]=function(){return S===void 0&&(S=nIt()),S(this)}),Object.defineProperty(P.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),Object.defineProperty(P.prototype,"readableBuffer",{enumerable:!1,get:function(){return this._readableState&&this._readableState.buffer}}),Object.defineProperty(P.prototype,"readableFlowing",{enumerable:!1,get:function(){return this._readableState.flowing},set:function(Se){this._readableState&&(this._readableState.flowing=Se)}}),P._fromList=_e,Object.defineProperty(P.prototype,"readableLength",{enumerable:!1,get:function(){return this._readableState.length}});function _e(ye,Se){if(Se.length===0)return null;var Qe;return Se.objectMode?Qe=Se.buffer.shift():!ye||ye>=Se.length?(Se.decoder?Qe=Se.buffer.join(""):Se.buffer.length===1?Qe=Se.buffer.first():Qe=Se.buffer.concat(Se.length),Se.buffer.clear()):Qe=Se.buffer.consume(ye,Se.decoder),Qe}function ke(ye){var Se=ye._readableState;c("endReadable",Se.endEmitted),Se.endEmitted||(Se.ended=!0,Gn.nextTick(gt,Se,ye))}function gt(ye,Se){if(c("endReadableNT",ye.endEmitted,ye.length),!ye.endEmitted&&ye.length===0&&(ye.endEmitted=!0,Se.readable=!1,Se.emit("end"),ye.autoDestroy)){var Qe=Se._writableState;(!Qe||Qe.autoDestroy&&Qe.finished)&&Se.destroy()}}typeof Symbol=="function"&&(P.from=function(ye,Se){return x===void 0&&(x=iIt()),x(P,ye,Se)});function wt(ye,Se){for(var Qe=0,pe=ye.length;Qe<pe;Qe++)if(ye[Qe]===Se)return Qe;return-1}return FV}var Pwe=F_,o5=dx.codes,rIt=o5.ERR_METHOD_NOT_IMPLEMENTED,sIt=o5.ERR_MULTIPLE_CALLBACK,aIt=o5.ERR_TRANSFORM_ALREADY_TRANSFORMING,oIt=o5.ERR_TRANSFORM_WITH_LENGTH_0,c5=$A();xP(F_,c5);function cIt(t,e){var n=this._transformState;n.transforming=!1;var i=n.writecb;if(i===null)return this.emit("error",new sIt);n.writechunk=null,n.writecb=null,e!=null&&this.push(e),i(t);var r=this._readableState;r.reading=!1,(r.needReadable||r.length<r.highWaterMark)&&this._read(r.highWaterMark)}function F_(t){if(!(this instanceof F_))return new F_(t);c5.call(this,t),this._transformState={afterTransform:cIt.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,t&&(typeof t.transform=="function"&&(this._transform=t.transform),typeof t.flush=="function"&&(this._flush=t.flush)),this.on("prefinish",lIt)}function lIt(){var t=this;typeof this._flush=="function"&&!this._readableState.destroyed?this._flush(function(e,n){Rce(t,e,n)}):Rce(this,null,null)}F_.prototype.push=function(t,e){return this._transformState.needTransform=!1,c5.prototype.push.call(this,t,e)};F_.prototype._transform=function(t,e,n){n(new rIt("_transform()"))};F_.prototype._write=function(t,e,n){var i=this._transformState;if(i.writecb=n,i.writechunk=t,i.writeencoding=e,!i.transforming){var r=this._readableState;(i.needTransform||r.needReadable||r.length<r.highWaterMark)&&this._read(r.highWaterMark)}};F_.prototype._read=function(t){var e=this._transformState;e.writechunk!==null&&!e.transforming?(e.transforming=!0,this._transform(e.writechunk,e.writeencoding,e.afterTransform)):e.needTransform=!0};F_.prototype._destroy=function(t,e){c5.prototype._destroy.call(this,t,function(n){e(n)})};function Rce(t,e,n){if(e)return t.emit("error",e);if(n!=null&&t.push(n),t._writableState.length)throw new oIt;if(t._transformState.transforming)throw new aIt;return t.push(null)}var uIt=OI,Dwe=Pwe;xP(OI,Dwe);function OI(t){if(!(this instanceof OI))return new OI(t);Dwe.call(this,t)}OI.prototype._transform=function(t,e,n){n(null,t)};var zV;function hIt(t){var e=!1;return function(){e||(e=!0,t.apply(void 0,arguments))}}var Lwe=dx.codes,dIt=Lwe.ERR_MISSING_ARGS,fIt=Lwe.ERR_STREAM_DESTROYED;function Mce(t){if(t)throw t}function pIt(t){return t.setHeader&&typeof t.abort=="function"}function mIt(t,e,n,i){i=hIt(i);var r=!1;t.on("close",function(){r=!0}),zV===void 0&&(zV=XZ),zV(t,{readable:e,writable:n},function(a){if(a)return i(a);r=!0,i()});var s=!1;return function(a){if(!r&&!s){if(s=!0,pIt(t))return t.abort();if(typeof t.destroy=="function")return t.destroy();i(a||new fIt("pipe"))}}}function Oce(t){t()}function gIt(t,e){return t.pipe(e)}function vIt(t){return!t.length||typeof t[t.length-1]!="function"?Mce:t.pop()}function _It(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];var i=vIt(e);if(Array.isArray(e[0])&&(e=e[0]),e.length<2)throw new dIt("streams");var r,s=e.map(function(a,o){var c=o<e.length-1,l=o>0;return mIt(a,c,l,function(u){r||(r=u),u&&s.forEach(Oce),!c&&(s.forEach(Oce),i(r))})});return e.reduce(gIt)}var yIt=_It;(function(t,e){e=t.exports=kwe(),e.Stream=e,e.Readable=e,e.Writable=Nwe(),e.Duplex=$A(),e.Transform=Pwe,e.PassThrough=uIt,e.finished=XZ,e.pipeline=yIt})(k7,k7.exports);var Uwe=k7.exports;/*! queue-microtask. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> */let Nce;var Bwe=typeof queueMicrotask=="function"?queueMicrotask.bind(typeof window<"u"?window:Ml):t=>(Nce||(Nce=Promise.resolve())).then(t).catch(e=>setTimeout(()=>{throw e},0));function Ice(t,e){for(const n in e)Object.defineProperty(t,n,{value:e[n],enumerable:!0,configurable:!0});return t}function bIt(t,e,n){if(!t||typeof t=="string")throw new TypeError("Please pass an Error to err-code");n||(n={}),typeof e=="object"&&(n=e,e=""),e&&(n.code=e);try{return Ice(t,n)}catch{n.message=t.message,n.stack=t.stack;const r=function(){};return r.prototype=Object.create(Object.getPrototypeOf(t)),Ice(new r,n)}}var EIt=bIt;/*! simple-peer. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> */const SIt=r5("simple-peer"),Fwe=MNt,kce=s5,TIt=Uwe,jV=Bwe,Dr=EIt,{Buffer:xIt}=SP,HV=64*1024,wIt=5*1e3,CIt=5*1e3;function Pce(t){return t.replace(/a=ice-options:trickle\s\n/g,"")}function AIt(t){console.warn(t)}let l5=class L7 extends TIt.Duplex{constructor(e){if(e=Object.assign({allowHalfOpen:!1},e),super(e),this._id=kce(4).toString("hex").slice(0,7),this._debug("new peer %o",e),this.channelName=e.initiator?e.channelName||kce(20).toString("hex"):null,this.initiator=e.initiator||!1,this.channelConfig=e.channelConfig||L7.channelConfig,this.channelNegotiated=this.channelConfig.negotiated,this.config=Object.assign({},L7.config,e.config),this.offerOptions=e.offerOptions||{},this.answerOptions=e.answerOptions||{},this.sdpTransform=e.sdpTransform||(n=>n),this.streams=e.streams||(e.stream?[e.stream]:[]),this.trickle=e.trickle!==void 0?e.trickle:!0,this.allowHalfTrickle=e.allowHalfTrickle!==void 0?e.allowHalfTrickle:!1,this.iceCompleteTimeout=e.iceCompleteTimeout||wIt,this.destroyed=!1,this.destroying=!1,this._connected=!1,this.remoteAddress=void 0,this.remoteFamily=void 0,this.remotePort=void 0,this.localAddress=void 0,this.localFamily=void 0,this.localPort=void 0,this._wrtc=e.wrtc&&typeof e.wrtc=="object"?e.wrtc:Fwe(),!this._wrtc)throw Dr(typeof window>"u"?new Error("No WebRTC support: Specify `opts.wrtc` option in this environment"):new Error("No WebRTC support: Not a supported browser"),"ERR_WEBRTC_SUPPORT");this._pcReady=!1,this._channelReady=!1,this._iceComplete=!1,this._iceCompleteTimer=null,this._channel=null,this._pendingCandidates=[],this._isNegotiating=!1,this._firstNegotiation=!0,this._batchedNegotiation=!1,this._queuedNegotiation=!1,this._sendersAwaitingStable=[],this._senderMap=new Map,this._closingInterval=null,this._remoteTracks=[],this._remoteStreams=[],this._chunk=null,this._cb=null,this._interval=null;try{this._pc=new this._wrtc.RTCPeerConnection(this.config)}catch(n){this.destroy(Dr(n,"ERR_PC_CONSTRUCTOR"));return}this._isReactNativeWebrtc=typeof this._pc._peerConnectionId=="number",this._pc.oniceconnectionstatechange=()=>{this._onIceStateChange()},this._pc.onicegatheringstatechange=()=>{this._onIceStateChange()},this._pc.onconnectionstatechange=()=>{this._onConnectionStateChange()},this._pc.onsignalingstatechange=()=>{this._onSignalingStateChange()},this._pc.onicecandidate=n=>{this._onIceCandidate(n)},typeof this._pc.peerIdentity=="object"&&this._pc.peerIdentity.catch(n=>{this.destroy(Dr(n,"ERR_PC_PEER_IDENTITY"))}),this.initiator||this.channelNegotiated?this._setupData({channel:this._pc.createDataChannel(this.channelName,this.channelConfig)}):this._pc.ondatachannel=n=>{this._setupData(n)},this.streams&&this.streams.forEach(n=>{this.addStream(n)}),this._pc.ontrack=n=>{this._onTrack(n)},this._debug("initial negotiation"),this._needsNegotiation(),this._onFinishBound=()=>{this._onFinish()},this.once("finish",this._onFinishBound)}get bufferSize(){return this._channel&&this._channel.bufferedAmount||0}get connected(){return this._connected&&this._channel.readyState==="open"}address(){return{port:this.localPort,family:this.localFamily,address:this.localAddress}}signal(e){if(!this.destroying){if(this.destroyed)throw Dr(new Error("cannot signal after peer is destroyed"),"ERR_DESTROYED");if(typeof e=="string")try{e=JSON.parse(e)}catch{e={}}this._debug("signal()"),e.renegotiate&&this.initiator&&(this._debug("got request to renegotiate"),this._needsNegotiation()),e.transceiverRequest&&this.initiator&&(this._debug("got request for transceiver"),this.addTransceiver(e.transceiverRequest.kind,e.transceiverRequest.init)),e.candidate&&(this._pc.remoteDescription&&this._pc.remoteDescription.type?this._addIceCandidate(e.candidate):this._pendingCandidates.push(e.candidate)),e.sdp&&this._pc.setRemoteDescription(new this._wrtc.RTCSessionDescription(e)).then(()=>{this.destroyed||(this._pendingCandidates.forEach(n=>{this._addIceCandidate(n)}),this._pendingCandidates=[],this._pc.remoteDescription.type==="offer"&&this._createAnswer())}).catch(n=>{this.destroy(Dr(n,"ERR_SET_REMOTE_DESCRIPTION"))}),!e.sdp&&!e.candidate&&!e.renegotiate&&!e.transceiverRequest&&this.destroy(Dr(new Error("signal() called with invalid signal data"),"ERR_SIGNALING"))}}_addIceCandidate(e){const n=new this._wrtc.RTCIceCandidate(e);this._pc.addIceCandidate(n).catch(i=>{!n.address||n.address.endsWith(".local")?AIt("Ignoring unsupported ICE candidate."):this.destroy(Dr(i,"ERR_ADD_ICE_CANDIDATE"))})}send(e){if(!this.destroying){if(this.destroyed)throw Dr(new Error("cannot send after peer is destroyed"),"ERR_DESTROYED");this._channel.send(e)}}addTransceiver(e,n){if(!this.destroying){if(this.destroyed)throw Dr(new Error("cannot addTransceiver after peer is destroyed"),"ERR_DESTROYED");if(this._debug("addTransceiver()"),this.initiator)try{this._pc.addTransceiver(e,n),this._needsNegotiation()}catch(i){this.destroy(Dr(i,"ERR_ADD_TRANSCEIVER"))}else this.emit("signal",{type:"transceiverRequest",transceiverRequest:{kind:e,init:n}})}}addStream(e){if(!this.destroying){if(this.destroyed)throw Dr(new Error("cannot addStream after peer is destroyed"),"ERR_DESTROYED");this._debug("addStream()"),e.getTracks().forEach(n=>{this.addTrack(n,e)})}}addTrack(e,n){if(this.destroying)return;if(this.destroyed)throw Dr(new Error("cannot addTrack after peer is destroyed"),"ERR_DESTROYED");this._debug("addTrack()");const i=this._senderMap.get(e)||new Map;let r=i.get(n);if(!r)r=this._pc.addTrack(e,n),i.set(n,r),this._senderMap.set(e,i),this._needsNegotiation();else throw r.removed?Dr(new Error("Track has been removed. You should enable/disable tracks that you want to re-add."),"ERR_SENDER_REMOVED"):Dr(new Error("Track has already been added to that stream."),"ERR_SENDER_ALREADY_ADDED")}replaceTrack(e,n,i){if(this.destroying)return;if(this.destroyed)throw Dr(new Error("cannot replaceTrack after peer is destroyed"),"ERR_DESTROYED");this._debug("replaceTrack()");const r=this._senderMap.get(e),s=r?r.get(i):null;if(!s)throw Dr(new Error("Cannot replace track that was never added."),"ERR_TRACK_NOT_ADDED");n&&this._senderMap.set(n,r),s.replaceTrack!=null?s.replaceTrack(n):this.destroy(Dr(new Error("replaceTrack is not supported in this browser"),"ERR_UNSUPPORTED_REPLACETRACK"))}removeTrack(e,n){if(this.destroying)return;if(this.destroyed)throw Dr(new Error("cannot removeTrack after peer is destroyed"),"ERR_DESTROYED");this._debug("removeSender()");const i=this._senderMap.get(e),r=i?i.get(n):null;if(!r)throw Dr(new Error("Cannot remove track that was never added."),"ERR_TRACK_NOT_ADDED");try{r.removed=!0,this._pc.removeTrack(r)}catch(s){s.name==="NS_ERROR_UNEXPECTED"?this._sendersAwaitingStable.push(r):this.destroy(Dr(s,"ERR_REMOVE_TRACK"))}this._needsNegotiation()}removeStream(e){if(!this.destroying){if(this.destroyed)throw Dr(new Error("cannot removeStream after peer is destroyed"),"ERR_DESTROYED");this._debug("removeSenders()"),e.getTracks().forEach(n=>{this.removeTrack(n,e)})}}_needsNegotiation(){this._debug("_needsNegotiation"),!this._batchedNegotiation&&(this._batchedNegotiation=!0,jV(()=>{this._batchedNegotiation=!1,this.initiator||!this._firstNegotiation?(this._debug("starting batched negotiation"),this.negotiate()):this._debug("non-initiator initial negotiation request discarded"),this._firstNegotiation=!1}))}negotiate(){if(!this.destroying){if(this.destroyed)throw Dr(new Error("cannot negotiate after peer is destroyed"),"ERR_DESTROYED");this.initiator?this._isNegotiating?(this._queuedNegotiation=!0,this._debug("already negotiating, queueing")):(this._debug("start negotiation"),setTimeout(()=>{this._createOffer()},0)):this._isNegotiating?(this._queuedNegotiation=!0,this._debug("already negotiating, queueing")):(this._debug("requesting negotiation from initiator"),this.emit("signal",{type:"renegotiate",renegotiate:!0})),this._isNegotiating=!0}}destroy(e){this._destroy(e,()=>{})}_destroy(e,n){this.destroyed||this.destroying||(this.destroying=!0,this._debug("destroying (error: %s)",e&&(e.message||e)),jV(()=>{if(this.destroyed=!0,this.destroying=!1,this._debug("destroy (error: %s)",e&&(e.message||e)),this.readable=this.writable=!1,this._readableState.ended||this.push(null),this._writableState.finished||this.end(),this._connected=!1,this._pcReady=!1,this._channelReady=!1,this._remoteTracks=null,this._remoteStreams=null,this._senderMap=null,clearInterval(this._closingInterval),this._closingInterval=null,clearInterval(this._interval),this._interval=null,this._chunk=null,this._cb=null,this._onFinishBound&&this.removeListener("finish",this._onFinishBound),this._onFinishBound=null,this._channel){try{this._channel.close()}catch{}this._channel.onmessage=null,this._channel.onopen=null,this._channel.onclose=null,this._channel.onerror=null}if(this._pc){try{this._pc.close()}catch{}this._pc.oniceconnectionstatechange=null,this._pc.onicegatheringstatechange=null,this._pc.onsignalingstatechange=null,this._pc.onicecandidate=null,this._pc.ontrack=null,this._pc.ondatachannel=null}this._pc=null,this._channel=null,e&&this.emit("error",e),this.emit("close"),n()}))}_setupData(e){if(!e.channel)return this.destroy(Dr(new Error("Data channel event is missing `channel` property"),"ERR_DATA_CHANNEL"));this._channel=e.channel,this._channel.binaryType="arraybuffer",typeof this._channel.bufferedAmountLowThreshold=="number"&&(this._channel.bufferedAmountLowThreshold=HV),this.channelName=this._channel.label,this._channel.onmessage=i=>{this._onChannelMessage(i)},this._channel.onbufferedamountlow=()=>{this._onChannelBufferedAmountLow()},this._channel.onopen=()=>{this._onChannelOpen()},this._channel.onclose=()=>{this._onChannelClose()},this._channel.onerror=i=>{const r=i.error instanceof Error?i.error:new Error(`Datachannel error: ${i.message} ${i.filename}:${i.lineno}:${i.colno}`);this.destroy(Dr(r,"ERR_DATA_CHANNEL"))};let n=!1;this._closingInterval=setInterval(()=>{this._channel&&this._channel.readyState==="closing"?(n&&this._onChannelClose(),n=!0):n=!1},CIt)}_read(){}_write(e,n,i){if(this.destroyed)return i(Dr(new Error("cannot write after peer is destroyed"),"ERR_DATA_CHANNEL"));if(this._connected){try{this.send(e)}catch(r){return this.destroy(Dr(r,"ERR_DATA_CHANNEL"))}this._channel.bufferedAmount>HV?(this._debug("start backpressure: bufferedAmount %d",this._channel.bufferedAmount),this._cb=i):i(null)}else this._debug("write before connect"),this._chunk=e,this._cb=i}_onFinish(){if(this.destroyed)return;const e=()=>{setTimeout(()=>this.destroy(),1e3)};this._connected?e():this.once("connect",e)}_startIceCompleteTimeout(){this.destroyed||this._iceCompleteTimer||(this._debug("started iceComplete timeout"),this._iceCompleteTimer=setTimeout(()=>{this._iceComplete||(this._iceComplete=!0,this._debug("iceComplete timeout completed"),this.emit("iceTimeout"),this.emit("_iceComplete"))},this.iceCompleteTimeout))}_createOffer(){this.destroyed||this._pc.createOffer(this.offerOptions).then(e=>{if(this.destroyed)return;!this.trickle&&!this.allowHalfTrickle&&(e.sdp=Pce(e.sdp)),e.sdp=this.sdpTransform(e.sdp);const n=()=>{if(this.destroyed)return;const s=this._pc.localDescription||e;this._debug("signal"),this.emit("signal",{type:s.type,sdp:s.sdp})},i=()=>{this._debug("createOffer success"),!this.destroyed&&(this.trickle||this._iceComplete?n():this.once("_iceComplete",n))},r=s=>{this.destroy(Dr(s,"ERR_SET_LOCAL_DESCRIPTION"))};this._pc.setLocalDescription(e).then(i).catch(r)}).catch(e=>{this.destroy(Dr(e,"ERR_CREATE_OFFER"))})}_requestMissingTransceivers(){this._pc.getTransceivers&&this._pc.getTransceivers().forEach(e=>{!e.mid&&e.sender.track&&!e.requested&&(e.requested=!0,this.addTransceiver(e.sender.track.kind))})}_createAnswer(){this.destroyed||this._pc.createAnswer(this.answerOptions).then(e=>{if(this.destroyed)return;!this.trickle&&!this.allowHalfTrickle&&(e.sdp=Pce(e.sdp)),e.sdp=this.sdpTransform(e.sdp);const n=()=>{if(this.destroyed)return;const s=this._pc.localDescription||e;this._debug("signal"),this.emit("signal",{type:s.type,sdp:s.sdp}),this.initiator||this._requestMissingTransceivers()},i=()=>{this.destroyed||(this.trickle||this._iceComplete?n():this.once("_iceComplete",n))},r=s=>{this.destroy(Dr(s,"ERR_SET_LOCAL_DESCRIPTION"))};this._pc.setLocalDescription(e).then(i).catch(r)}).catch(e=>{this.destroy(Dr(e,"ERR_CREATE_ANSWER"))})}_onConnectionStateChange(){this.destroyed||this._pc.connectionState==="failed"&&this.destroy(Dr(new Error("Connection failed."),"ERR_CONNECTION_FAILURE"))}_onIceStateChange(){if(this.destroyed)return;const e=this._pc.iceConnectionState,n=this._pc.iceGatheringState;this._debug("iceStateChange (connection: %s) (gathering: %s)",e,n),this.emit("iceStateChange",e,n),(e==="connected"||e==="completed")&&(this._pcReady=!0,this._maybeReady()),e==="failed"&&this.destroy(Dr(new Error("Ice connection failed."),"ERR_ICE_CONNECTION_FAILURE")),e==="closed"&&this.destroy(Dr(new Error("Ice connection closed."),"ERR_ICE_CONNECTION_CLOSED"))}getStats(e){const n=i=>(Object.prototype.toString.call(i.values)==="[object Array]"&&i.values.forEach(r=>{Object.assign(i,r)}),i);this._pc.getStats.length===0||this._isReactNativeWebrtc?this._pc.getStats().then(i=>{const r=[];i.forEach(s=>{r.push(n(s))}),e(null,r)},i=>e(i)):this._pc.getStats.length>0?this._pc.getStats(i=>{if(this.destroyed)return;const r=[];i.result().forEach(s=>{const a={};s.names().forEach(o=>{a[o]=s.stat(o)}),a.id=s.id,a.type=s.type,a.timestamp=s.timestamp,r.push(n(a))}),e(null,r)},i=>e(i)):e(null,[])}_maybeReady(){if(this._debug("maybeReady pc %s channel %s",this._pcReady,this._channelReady),this._connected||this._connecting||!this._pcReady||!this._channelReady)return;this._connecting=!0;const e=()=>{this.destroyed||this.getStats((n,i)=>{if(this.destroyed)return;n&&(i=[]);const r={},s={},a={};let o=!1;i.forEach(l=>{(l.type==="remotecandidate"||l.type==="remote-candidate")&&(r[l.id]=l),(l.type==="localcandidate"||l.type==="local-candidate")&&(s[l.id]=l),(l.type==="candidatepair"||l.type==="candidate-pair")&&(a[l.id]=l)});const c=l=>{o=!0;let u=s[l.localCandidateId];u&&(u.ip||u.address)?(this.localAddress=u.ip||u.address,this.localPort=Number(u.port)):u&&u.ipAddress?(this.localAddress=u.ipAddress,this.localPort=Number(u.portNumber)):typeof l.googLocalAddress=="string"&&(u=l.googLocalAddress.split(":"),this.localAddress=u[0],this.localPort=Number(u[1])),this.localAddress&&(this.localFamily=this.localAddress.includes(":")?"IPv6":"IPv4");let h=r[l.remoteCandidateId];h&&(h.ip||h.address)?(this.remoteAddress=h.ip||h.address,this.remotePort=Number(h.port)):h&&h.ipAddress?(this.remoteAddress=h.ipAddress,this.remotePort=Number(h.portNumber)):typeof l.googRemoteAddress=="string"&&(h=l.googRemoteAddress.split(":"),this.remoteAddress=h[0],this.remotePort=Number(h[1])),this.remoteAddress&&(this.remoteFamily=this.remoteAddress.includes(":")?"IPv6":"IPv4"),this._debug("connect local: %s:%s remote: %s:%s",this.localAddress,this.localPort,this.remoteAddress,this.remotePort)};if(i.forEach(l=>{l.type==="transport"&&l.selectedCandidatePairId&&c(a[l.selectedCandidatePairId]),(l.type==="googCandidatePair"&&l.googActiveConnection==="true"||(l.type==="candidatepair"||l.type==="candidate-pair")&&l.selected)&&c(l)}),!o&&(!Object.keys(a).length||Object.keys(s).length)){setTimeout(e,100);return}else this._connecting=!1,this._connected=!0;if(this._chunk){try{this.send(this._chunk)}catch(u){return this.destroy(Dr(u,"ERR_DATA_CHANNEL"))}this._chunk=null,this._debug('sent chunk from "write before connect"');const l=this._cb;this._cb=null,l(null)}typeof this._channel.bufferedAmountLowThreshold!="number"&&(this._interval=setInterval(()=>this._onInterval(),150),this._interval.unref&&this._interval.unref()),this._debug("connect"),this.emit("connect")})};e()}_onInterval(){!this._cb||!this._channel||this._channel.bufferedAmount>HV||this._onChannelBufferedAmountLow()}_onSignalingStateChange(){this.destroyed||(this._pc.signalingState==="stable"&&(this._isNegotiating=!1,this._debug("flushing sender queue",this._sendersAwaitingStable),this._sendersAwaitingStable.forEach(e=>{this._pc.removeTrack(e),this._queuedNegotiation=!0}),this._sendersAwaitingStable=[],this._queuedNegotiation?(this._debug("flushing negotiation queue"),this._queuedNegotiation=!1,this._needsNegotiation()):(this._debug("negotiated"),this.emit("negotiated"))),this._debug("signalingStateChange %s",this._pc.signalingState),this.emit("signalingStateChange",this._pc.signalingState))}_onIceCandidate(e){this.destroyed||(e.candidate&&this.trickle?this.emit("signal",{type:"candidate",candidate:{candidate:e.candidate.candidate,sdpMLineIndex:e.candidate.sdpMLineIndex,sdpMid:e.candidate.sdpMid}}):!e.candidate&&!this._iceComplete&&(this._iceComplete=!0,this.emit("_iceComplete")),e.candidate&&this._startIceCompleteTimeout())}_onChannelMessage(e){if(this.destroyed)return;let n=e.data;n instanceof ArrayBuffer&&(n=xIt.from(n)),this.push(n)}_onChannelBufferedAmountLow(){if(this.destroyed||!this._cb)return;this._debug("ending backpressure: bufferedAmount %d",this._channel.bufferedAmount);const e=this._cb;this._cb=null,e(null)}_onChannelOpen(){this._connected||this.destroyed||(this._debug("on channel open"),this._channelReady=!0,this._maybeReady())}_onChannelClose(){this.destroyed||(this._debug("on channel close"),this.destroy())}_onTrack(e){this.destroyed||e.streams.forEach(n=>{this._debug("on track"),this.emit("track",e.track,n),this._remoteTracks.push({track:e.track,stream:n}),!this._remoteStreams.some(i=>i.id===n.id)&&(this._remoteStreams.push(n),jV(()=>{this._debug("on stream"),this.emit("stream",n)}))})}_debug(){const e=[].slice.call(arguments);e[0]="["+this._id+"] "+e[0],SIt.apply(null,e)}};l5.WEBRTC_SUPPORT=!!Fwe();l5.config={iceServers:[{urls:["stun:stun.l.google.com:19302","stun:global.stun.twilio.com:3478"]}],sdpSemantics:"unified-plan"};l5.channelConfig={};var RIt=l5;const MIt=r5("simple-websocket"),OIt=s5,NIt=Uwe,Dce=Bwe,FO=S1,XM=typeof FO!="function"?WebSocket:FO,Lce=64*1024;let zwe=class extends NIt.Duplex{constructor(e={}){if(typeof e=="string"&&(e={url:e}),e=Object.assign({allowHalfOpen:!1},e),super(e),e.url==null&&e.socket==null)throw new Error("Missing required `url` or `socket` option");if(e.url!=null&&e.socket!=null)throw new Error("Must specify either `url` or `socket` option, not both");if(this._id=OIt(4).toString("hex").slice(0,7),this._debug("new websocket: %o",e),this.connected=!1,this.destroyed=!1,this._chunk=null,this._cb=null,this._interval=null,e.socket)this.url=e.socket.url,this._ws=e.socket,this.connected=e.socket.readyState===XM.OPEN;else{this.url=e.url;try{typeof FO=="function"?this._ws=new XM(e.url,null,{...e,encoding:void 0}):this._ws=new XM(e.url)}catch(n){Dce(()=>this.destroy(n));return}}this._ws.binaryType="arraybuffer",e.socket&&this.connected?Dce(()=>this._handleOpen()):this._ws.onopen=()=>this._handleOpen(),this._ws.onmessage=n=>this._handleMessage(n),this._ws.onclose=()=>this._handleClose(),this._ws.onerror=n=>this._handleError(n),this._handleFinishBound=()=>this._handleFinish(),this.once("finish",this._handleFinishBound)}send(e){this._ws.send(e)}destroy(e){this._destroy(e,()=>{})}_destroy(e,n){if(!this.destroyed){if(this._debug("destroy (error: %s)",e&&(e.message||e)),this.readable=this.writable=!1,this._readableState.ended||this.push(null),this._writableState.finished||this.end(),this.connected=!1,this.destroyed=!0,clearInterval(this._interval),this._interval=null,this._chunk=null,this._cb=null,this._handleFinishBound&&this.removeListener("finish",this._handleFinishBound),this._handleFinishBound=null,this._ws){const i=this._ws,r=()=>{i.onclose=null};if(i.readyState===XM.CLOSED)r();else try{i.onclose=r,i.close()}catch{r()}i.onopen=null,i.onmessage=null,i.onerror=()=>{}}this._ws=null,e&&this.emit("error",e),this.emit("close"),n()}}_read(){}_write(e,n,i){if(this.destroyed)return i(new Error("cannot write after socket is destroyed"));if(this.connected){try{this.send(e)}catch(r){return this.destroy(r)}typeof FO!="function"&&this._ws.bufferedAmount>Lce?(this._debug("start backpressure: bufferedAmount %d",this._ws.bufferedAmount),this._cb=i):i(null)}else this._debug("write before connect"),this._chunk=e,this._cb=i}_handleOpen(){if(!(this.connected||this.destroyed)){if(this.connected=!0,this._chunk){try{this.send(this._chunk)}catch(n){return this.destroy(n)}this._chunk=null,this._debug('sent chunk from "write before connect"');const e=this._cb;this._cb=null,e(null)}typeof FO!="function"&&(this._interval=setInterval(()=>this._onInterval(),150),this._interval.unref&&this._interval.unref()),this._debug("connect"),this.emit("connect")}}_handleMessage(e){if(this.destroyed)return;let n=e.data;n instanceof ArrayBuffer&&(n=Yl.from(n)),this.push(n)}_handleClose(){this.destroyed||(this._debug("on close"),this.destroy())}_handleError(e){this.destroy(new Error(`Error connecting to ${this.url}`))}_handleFinish(){if(this.destroyed)return;const e=()=>{setTimeout(()=>this.destroy(),1e3)};this.connected?e():this.once("connect",e)}_onInterval(){if(!this._cb||!this._ws||this._ws.bufferedAmount>Lce)return;this._debug("ending backpressure: bufferedAmount %d",this._ws.bufferedAmount);const e=this._cb;this._cb=null,e(null)}_debug(){const e=[].slice.call(arguments);e[0]="["+this._id+"] "+e[0],MIt.apply(null,e)}};zwe.WEBSOCKET_SUPPORT=!!XM;var IIt=zwe,jwe={};(function(t){t.DEFAULT_ANNOUNCE_PEERS=50,t.MAX_ANNOUNCE_PEERS=82,t.binaryToHex=n=>(typeof n!="string"&&(n=String(n)),Yl.from(n,"binary").toString("hex")),t.hexToBinary=n=>(typeof n!="string"&&(n=String(n)),Yl.from(n,"hex").toString("binary")),t.parseUrl=n=>{const i=new URL(n.replace(/^udp:/,"http:"));return n.match(/^udp:/)&&Object.defineProperties(i,{href:{value:i.href.replace(/^http/,"udp")},protocol:{value:i.protocol.replace(/^http/,"udp")},origin:{value:i.origin.replace(/^http/,"udp")}}),i},Object.assign(t,S1)})(jwe);const kIt=TP;let PIt=class extends kIt{constructor(e,n){super(),this.client=e,this.announceUrl=n,this.interval=null,this.destroyed=!1}setInterval(e){e==null&&(e=this.DEFAULT_ANNOUNCE_INTERVAL),clearInterval(this.interval),e&&(this.interval=setInterval(()=>{this.announce(this.client._defaultAnnounceOpts())},e),this.interval.unref&&this.interval.unref())}};var DIt=PIt;const LIt=wNt,om=r5("bittorrent-tracker:websocket-tracker"),UIt=RIt,BIt=s5,FIt=IIt,zIt=S1,Ky=jwe,jIt=DIt,Hv={},HIt=10*1e3,VIt=60*60*1e3,GIt=5*60*1e3,qIt=50*1e3;let ZZ=class extends jIt{constructor(e,n){super(e,n),om("new websocket tracker %s",n),this.peers={},this.socket=null,this.reconnecting=!1,this.retries=0,this.reconnectTimer=null,this.expectingResponse=!1,this._openSocket()}announce(e){if(this.destroyed||this.reconnecting)return;if(!this.socket.connected){this.socket.once("connect",()=>{this.announce(e)});return}const n=Object.assign({},e,{action:"announce",info_hash:this.client._infoHashBinary,peer_id:this.client._peerIdBinary});if(this._trackerId&&(n.trackerid=this._trackerId),e.event==="stopped"||e.event==="completed")this._send(n);else{const i=Math.min(e.numwant,5);this._generateOffers(i,r=>{n.numwant=i,n.offers=r,this._send(n)})}}scrape(e){if(this.destroyed||this.reconnecting)return;if(!this.socket.connected){this.socket.once("connect",()=>{this.scrape(e)});return}const i={action:"scrape",info_hash:Array.isArray(e.infoHash)&&e.infoHash.length>0?e.infoHash.map(r=>r.toString("binary")):e.infoHash&&e.infoHash.toString("binary")||this.client._infoHashBinary};this._send(i)}destroy(e=Uce){if(this.destroyed)return e(null);this.destroyed=!0,clearInterval(this.interval),clearTimeout(this.reconnectTimer);for(const s in this.peers){const a=this.peers[s];clearTimeout(a.trackerTimeout),a.destroy()}if(this.peers=null,this.socket&&(this.socket.removeListener("connect",this._onSocketConnectBound),this.socket.removeListener("data",this._onSocketDataBound),this.socket.removeListener("close",this._onSocketCloseBound),this.socket.removeListener("error",this._onSocketErrorBound),this.socket=null),this._onSocketConnectBound=null,this._onSocketErrorBound=null,this._onSocketDataBound=null,this._onSocketCloseBound=null,Hv[this.announceUrl]&&(Hv[this.announceUrl].consumers-=1),Hv[this.announceUrl].consumers>0)return e();let n=Hv[this.announceUrl];delete Hv[this.announceUrl],n.on("error",Uce),n.once("close",e);let i;if(!this.expectingResponse)return r();i=setTimeout(r,Ky.DESTROY_TIMEOUT),n.once("data",r);function r(){i&&(clearTimeout(i),i=null),n.removeListener("data",r),n.destroy(),n=null}}_openSocket(){if(this.destroyed=!1,this.peers||(this.peers={}),this._onSocketConnectBound=()=>{this._onSocketConnect()},this._onSocketErrorBound=e=>{this._onSocketError(e)},this._onSocketDataBound=e=>{this._onSocketData(e)},this._onSocketCloseBound=()=>{this._onSocketClose()},this.socket=Hv[this.announceUrl],this.socket)Hv[this.announceUrl].consumers+=1,this.socket.connected&&this._onSocketConnectBound();else{const e=new URL(this.announceUrl);let n;this.client._proxyOpts&&(n=e.protocol==="wss:"?this.client._proxyOpts.httpsAgent:this.client._proxyOpts.httpAgent,!n&&this.client._proxyOpts.socksProxy&&(n=new zIt.Agent(LIt(this.client._proxyOpts.socksProxy),e.protocol==="wss:"))),this.socket=Hv[this.announceUrl]=new FIt({url:this.announceUrl,agent:n}),this.socket.consumers=1,this.socket.once("connect",this._onSocketConnectBound)}this.socket.on("data",this._onSocketDataBound),this.socket.once("close",this._onSocketCloseBound),this.socket.once("error",this._onSocketErrorBound)}_onSocketConnect(){this.destroyed||this.reconnecting&&(this.reconnecting=!1,this.retries=0,this.announce(this.client._defaultAnnounceOpts()))}_onSocketData(e){if(!this.destroyed){this.expectingResponse=!1;try{e=JSON.parse(e)}catch{this.client.emit("warning",new Error("Invalid tracker response"));return}e.action==="announce"?this._onAnnounceResponse(e):e.action==="scrape"?this._onScrapeResponse(e):this._onSocketError(new Error(`invalid action in WS response: ${e.action}`))}}_onAnnounceResponse(e){if(e.info_hash!==this.client._infoHashBinary){om("ignoring websocket data from %s for %s (looking for %s: reused socket)",this.announceUrl,Ky.binaryToHex(e.info_hash),this.client.infoHash);return}if(e.peer_id&&e.peer_id===this.client._peerIdBinary)return;om("received %s from %s for %s",JSON.stringify(e),this.announceUrl,this.client.infoHash);const n=e["failure reason"];if(n)return this.client.emit("warning",new Error(n));const i=e["warning message"];i&&this.client.emit("warning",new Error(i));const r=e.interval||e["min interval"];r&&this.setInterval(r*1e3);const s=e["tracker id"];if(s&&(this._trackerId=s),e.complete!=null){const o=Object.assign({},e,{announce:this.announceUrl,infoHash:Ky.binaryToHex(e.info_hash)});this.client.emit("update",o)}let a;if(e.offer&&e.peer_id&&(om("creating peer (from remote offer)"),a=this._createPeer(),a.id=Ky.binaryToHex(e.peer_id),a.once("signal",o=>{const c={action:"announce",info_hash:this.client._infoHashBinary,peer_id:this.client._peerIdBinary,to_peer_id:e.peer_id,answer:o,offer_id:e.offer_id};this._trackerId&&(c.trackerid=this._trackerId),this._send(c)}),this.client.emit("peer",a),a.signal(e.offer)),e.answer&&e.peer_id){const o=Ky.binaryToHex(e.offer_id);a=this.peers[o],a?(a.id=Ky.binaryToHex(e.peer_id),this.client.emit("peer",a),a.signal(e.answer),clearTimeout(a.trackerTimeout),a.trackerTimeout=null,delete this.peers[o]):om(`got unexpected answer: ${JSON.stringify(e.answer)}`)}}_onScrapeResponse(e){e=e.files||{};const n=Object.keys(e);if(n.length===0){this.client.emit("warning",new Error("invalid scrape response"));return}n.forEach(i=>{const r=Object.assign(e[i],{announce:this.announceUrl,infoHash:Ky.binaryToHex(i)});this.client.emit("scrape",r)})}_onSocketClose(){this.destroyed||(this.destroy(),this._startReconnectTimer())}_onSocketError(e){this.destroyed||(this.destroy(),this.client.emit("warning",e),this._startReconnectTimer())}_startReconnectTimer(){const e=Math.floor(Math.random()*GIt)+Math.min(Math.pow(2,this.retries)*HIt,VIt);this.reconnecting=!0,clearTimeout(this.reconnectTimer),this.reconnectTimer=setTimeout(()=>{this.retries++,this._openSocket()},e),this.reconnectTimer.unref&&this.reconnectTimer.unref(),om("reconnecting socket in %s ms",e)}_send(e){if(this.destroyed)return;this.expectingResponse=!0;const n=JSON.stringify(e);om("send %s",n),this.socket.send(n)}_generateOffers(e,n){const i=this,r=[];om("generating %s offers",e);for(let o=0;o<e;++o)s();a();function s(){const o=BIt(20).toString("hex");om("creating peer (from _generateOffers)");const c=i.peers[o]=i._createPeer({initiator:!0});c.once("signal",l=>{r.push({offer:l,offer_id:Ky.hexToBinary(o)}),a()}),c.trackerTimeout=setTimeout(()=>{om("tracker timeout: destroying peer"),c.trackerTimeout=null,delete i.peers[o],c.destroy()},qIt),c.trackerTimeout.unref&&c.trackerTimeout.unref()}function a(){r.length===e&&(om("generated %s offers",e),n(r))}}_createPeer(e){const n=this;e=Object.assign({trickle:!1,config:n.client._rtcConfig,wrtc:n.client._wrtc},e);const i=new UIt(e);return i.once("error",r),i.once("connect",s),i;function r(a){n.client.emit("warning",new Error(`Connection error: ${a.message}`)),i.destroy()}function s(){i.removeListener("error",r),i.removeListener("connect",s)}}};ZZ.prototype.DEFAULT_ANNOUNCE_INTERVAL=30*1e3;ZZ._socketPool=Hv;function Uce(){}var $It=ZZ,JZ={exports:{}},Hwe={exports:{}};(function(t,e){(function(i,r){t.exports=r()})(typeof self<"u"?self:Ml,function(){return function(n){var i={};function r(s){if(i[s])return i[s].exports;var a=i[s]={i:s,l:!1,exports:{}};return n[s].call(a.exports,a,a.exports,r),a.l=!0,a.exports}return r.m=n,r.c=i,r.d=function(s,a,o){r.o(s,a)||Object.defineProperty(s,a,{configurable:!1,enumerable:!0,get:o})},r.n=function(s){var a=s&&s.__esModule?function(){return s.default}:function(){return s};return r.d(a,"a",a),a},r.o=function(s,a){return Object.prototype.hasOwnProperty.call(s,a)},r.p="",r(r.s=3)}([function(n,i,r){function s(_,v){if(!(_ instanceof v))throw new TypeError("Cannot call a class as a function")}var a=r(5),o=r(1),c=o.toHex,l=o.ceilHeapSize,u=r(6),h=function(_){for(_+=9;_%64>0;_+=1);return _},d=function(_,v){var b=new Uint8Array(_.buffer),S=v%4,x=v-S;switch(S){case 0:b[x+3]=0;case 1:b[x+2]=0;case 2:b[x+1]=0;case 3:b[x+0]=0}for(var M=(v>>2)+1;M<_.length;M++)_[M]=0},f=function(_,v,b){_[v>>2]|=128<<24-(v%4<<3),_[((v>>2)+2&-16)+14]=b/(1<<29)|0,_[((v>>2)+2&-16)+15]=b<<3},p=function(_,v){var b=new Int32Array(_,v+320,5),S=new Int32Array(5),x=new DataView(S.buffer);return x.setInt32(0,b[0],!1),x.setInt32(4,b[1],!1),x.setInt32(8,b[2],!1),x.setInt32(12,b[3],!1),x.setInt32(16,b[4],!1),S},g=function(){function _(v){if(s(this,_),v=v||64*1024,v%64>0)throw new Error("Chunk size must be a multiple of 128 bit");this._offset=0,this._maxChunkLen=v,this._padMaxChunkLen=h(v),this._heap=new ArrayBuffer(l(this._padMaxChunkLen+320+20)),this._h32=new Int32Array(this._heap),this._h8=new Int8Array(this._heap),this._core=new a({Int32Array},{},this._heap)}return _.prototype._initState=function(b,S){this._offset=0;var x=new Int32Array(b,S+320,5);x[0]=1732584193,x[1]=-271733879,x[2]=-1732584194,x[3]=271733878,x[4]=-1009589776},_.prototype._padChunk=function(b,S){var x=h(b),M=new Int32Array(this._heap,0,x>>2);return d(M,b),f(M,b,S),x},_.prototype._write=function(b,S,x,M){u(b,this._h8,this._h32,S,x,M||0)},_.prototype._coreCall=function(b,S,x,M,R){var I=x;this._write(b,S,x),R&&(I=this._padChunk(x,M)),this._core.hash(I,this._padMaxChunkLen)},_.prototype.rawDigest=function(b){var S=b.byteLength||b.length||b.size||0;this._initState(this._heap,this._padMaxChunkLen);var x=0,M=this._maxChunkLen;for(x=0;S>x+M;x+=M)this._coreCall(b,x,M,S,!1);return this._coreCall(b,x,S-x,S,!0),p(this._heap,this._padMaxChunkLen)},_.prototype.digest=function(b){return c(this.rawDigest(b).buffer)},_.prototype.digestFromString=function(b){return this.digest(b)},_.prototype.digestFromBuffer=function(b){return this.digest(b)},_.prototype.digestFromArrayBuffer=function(b){return this.digest(b)},_.prototype.resetState=function(){return this._initState(this._heap,this._padMaxChunkLen),this},_.prototype.append=function(b){var S=0,x=b.byteLength||b.length||b.size||0,M=this._offset%this._maxChunkLen,R=void 0;for(this._offset+=x;S<x;)R=Math.min(x-S,this._maxChunkLen-M),this._write(b,S,R,M),M+=R,S+=R,M===this._maxChunkLen&&(this._core.hash(this._maxChunkLen,this._padMaxChunkLen),M=0);return this},_.prototype.getState=function(){var b=this._offset%this._maxChunkLen,S=void 0;if(b)S=this._heap.slice(0);else{var x=new Int32Array(this._heap,this._padMaxChunkLen+320,5);S=x.buffer.slice(x.byteOffset,x.byteOffset+x.byteLength)}return{offset:this._offset,heap:S}},_.prototype.setState=function(b){if(this._offset=b.offset,b.heap.byteLength===20){var S=new Int32Array(this._heap,this._padMaxChunkLen+320,5);S.set(new Int32Array(b.heap))}else this._h32.set(new Int32Array(b.heap));return this},_.prototype.rawEnd=function(){var b=this._offset,S=b%this._maxChunkLen,x=this._padChunk(S,b);this._core.hash(x,this._padMaxChunkLen);var M=p(this._heap,this._padMaxChunkLen);return this._initState(this._heap,this._padMaxChunkLen),M},_.prototype.end=function(){return c(this.rawEnd().buffer)},_}();n.exports=g,n.exports._core=a},function(n,i){for(var r=new Array(256),s=0;s<256;s++)r[s]=(s<16?"0":"")+s.toString(16);n.exports.toHex=function(a){for(var o=new Uint8Array(a),c=new Array(a.byteLength),l=0;l<c.length;l++)c[l]=r[o[l]];return c.join("")},n.exports.ceilHeapSize=function(a){var o=0;if(a<=65536)return 65536;if(a<16777216)for(o=1;o<a;o=o<<1);else for(o=16777216;o<a;o+=16777216);return o},n.exports.isDedicatedWorkerScope=function(a){var o="WorkerGlobalScope"in a&&a instanceof a.WorkerGlobalScope,c="SharedWorkerGlobalScope"in a&&a instanceof a.SharedWorkerGlobalScope,l="ServiceWorkerGlobalScope"in a&&a instanceof a.ServiceWorkerGlobalScope;return o&&!c&&!l}},function(n,i,r){n.exports=function(){var s=r(0),a=function(l,u,h){try{return h(null,l.digest(u))}catch(d){return h(d)}},o=function(l,u,h,d,f){var p=new self.FileReader;p.onloadend=function(){if(p.error)return f(p.error);var _=p.result;u+=p.result.byteLength;try{l.append(_)}catch(v){f(v);return}u<d.size?o(l,u,h,d,f):f(null,l.end())},p.readAsArrayBuffer(d.slice(u,u+h))},c=!0;return self.onmessage=function(l){if(c){var u=l.data.data,h=l.data.file,d=l.data.id;if(!(typeof d>"u")&&!(!h&&!u)){var f=l.data.blockSize||4*1024*1024,p=new s(f);p.resetState();var g=function(_,v){_?self.postMessage({id:d,error:_.name}):self.postMessage({id:d,hash:v})};u&&a(p,u,g),h&&o(p,0,f,h,g)}}},function(){c=!1}}},function(n,i,r){var s=r(4),a=r(0),o=r(7),c=r(2),l=r(1),u=l.isDedicatedWorkerScope,h=typeof self<"u"&&u(self);a.disableWorkerBehaviour=h?c():function(){},a.createWorker=function(){var d=s(2),f=d.terminate;return d.terminate=function(){URL.revokeObjectURL(d.objectURL),f.call(d)},d},a.createHash=o,n.exports=a},function(n,i,r){function s(d){var f={};function p(_){if(f[_])return f[_].exports;var v=f[_]={i:_,l:!1,exports:{}};return d[_].call(v.exports,v,v.exports,p),v.l=!0,v.exports}p.m=d,p.c=f,p.i=function(_){return _},p.d=function(_,v,b){p.o(_,v)||Object.defineProperty(_,v,{configurable:!1,enumerable:!0,get:b})},p.r=function(_){Object.defineProperty(_,"__esModule",{value:!0})},p.n=function(_){var v=_&&_.__esModule?function(){return _.default}:function(){return _};return p.d(v,"a",v),v},p.o=function(_,v){return Object.prototype.hasOwnProperty.call(_,v)},p.p="/",p.oe=function(_){throw console.error(_),_};var g=p(p.s=ENTRY_MODULE);return g.default||g}var a="[\\.|\\-|\\+|\\w|/|@]+",o="\\((/\\*.*?\\*/)?s?.*?("+a+").*?\\)";function c(d){return(d+"").replace(/[.?*+^$[\]\\(){}|-]/g,"\\$&")}function l(d,f,p){var g={};g[p]=[];var _=f.toString(),v=_.match(/^function\s?\(\w+,\s*\w+,\s*(\w+)\)/);if(!v)return g;for(var b=v[1],S=new RegExp("(\\\\n|\\W)"+c(b)+o,"g"),x;x=S.exec(_);)x[3]!=="dll-reference"&&g[p].push(x[3]);for(S=new RegExp("\\("+c(b)+'\\("(dll-reference\\s('+a+'))"\\)\\)'+o,"g");x=S.exec(_);)d[x[2]]||(g[p].push(x[1]),d[x[2]]=r(x[1]).m),g[x[2]]=g[x[2]]||[],g[x[2]].push(x[4]);return g}function u(d){var f=Object.keys(d);return f.reduce(function(p,g){return p||d[g].length>0},!1)}function h(d,f){for(var p={main:[f]},g={main:[]},_={main:{}};u(p);)for(var v=Object.keys(p),b=0;b<v.length;b++){var S=v[b],x=p[S],M=x.pop();if(_[S]=_[S]||{},!(_[S][M]||!d[S][M])){_[S][M]=!0,g[S]=g[S]||[],g[S].push(M);for(var R=l(d,d[S][M],S),I=Object.keys(R),k=0;k<I.length;k++)p[I[k]]=p[I[k]]||[],p[I[k]]=p[I[k]].concat(R[I[k]])}}return g}n.exports=function(d,f){f=f||{};var p={main:r.m},g=f.all?{main:Object.keys(p)}:h(p,d),_="";Object.keys(g).filter(function(M){return M!=="main"}).forEach(function(M){for(var R=0;g[M][R];)R++;g[M].push(R),p[M][R]="(function(module, exports, __webpack_require__) { module.exports = __webpack_require__; })",_=_+"var "+M+" = ("+s.toString().replace("ENTRY_MODULE",JSON.stringify(R))+")({"+g[M].map(function(I){return""+JSON.stringify(I)+": "+p[M][I].toString()}).join(",")+`});
`}),_=_+"("+s.toString().replace("ENTRY_MODULE",JSON.stringify(d))+")({"+g.main.map(function(M){return""+JSON.stringify(M)+": "+p.main[M].toString()}).join(",")+"})(self);";var v=new window.Blob([_],{type:"text/javascript"});if(f.bare)return v;var b=window.URL||window.webkitURL||window.mozURL||window.msURL,S=b.createObjectURL(v),x=new window.Worker(S);return x.objectURL=S,x}},function(n,i){n.exports=function(s,a,o){var c=new s.Int32Array(o);function l(u,h){u=u|0,h=h|0;var d=0,f=0,p=0,g=0,_=0,v=0,b=0,S=0,x=0,M=0,R=0,I=0,k=0,P=0;for(p=c[h+320>>2]|0,_=c[h+324>>2]|0,b=c[h+328>>2]|0,x=c[h+332>>2]|0,R=c[h+336>>2]|0,d=0;(d|0)<(u|0);d=d+64|0){for(g=p,v=_,S=b,M=x,I=R,f=0;(f|0)<64;f=f+4|0)P=c[d+f>>2]|0,k=((p<<5|p>>>27)+(_&b|~_&x)|0)+((P+R|0)+1518500249|0)|0,R=x,x=b,b=_<<30|_>>>2,_=p,p=k,c[u+f>>2]=P;for(f=u+64|0;(f|0)<(u+80|0);f=f+4|0)P=(c[f-12>>2]^c[f-32>>2]^c[f-56>>2]^c[f-64>>2])<<1|(c[f-12>>2]^c[f-32>>2]^c[f-56>>2]^c[f-64>>2])>>>31,k=((p<<5|p>>>27)+(_&b|~_&x)|0)+((P+R|0)+1518500249|0)|0,R=x,x=b,b=_<<30|_>>>2,_=p,p=k,c[f>>2]=P;for(f=u+80|0;(f|0)<(u+160|0);f=f+4|0)P=(c[f-12>>2]^c[f-32>>2]^c[f-56>>2]^c[f-64>>2])<<1|(c[f-12>>2]^c[f-32>>2]^c[f-56>>2]^c[f-64>>2])>>>31,k=((p<<5|p>>>27)+(_^b^x)|0)+((P+R|0)+1859775393|0)|0,R=x,x=b,b=_<<30|_>>>2,_=p,p=k,c[f>>2]=P;for(f=u+160|0;(f|0)<(u+240|0);f=f+4|0)P=(c[f-12>>2]^c[f-32>>2]^c[f-56>>2]^c[f-64>>2])<<1|(c[f-12>>2]^c[f-32>>2]^c[f-56>>2]^c[f-64>>2])>>>31,k=((p<<5|p>>>27)+(_&b|_&x|b&x)|0)+((P+R|0)-1894007588|0)|0,R=x,x=b,b=_<<30|_>>>2,_=p,p=k,c[f>>2]=P;for(f=u+240|0;(f|0)<(u+320|0);f=f+4|0)P=(c[f-12>>2]^c[f-32>>2]^c[f-56>>2]^c[f-64>>2])<<1|(c[f-12>>2]^c[f-32>>2]^c[f-56>>2]^c[f-64>>2])>>>31,k=((p<<5|p>>>27)+(_^b^x)|0)+((P+R|0)-899497514|0)|0,R=x,x=b,b=_<<30|_>>>2,_=p,p=k,c[f>>2]=P;p=p+g|0,_=_+v|0,b=b+S|0,x=x+M|0,R=R+I|0}c[h+320>>2]=p,c[h+324>>2]=_,c[h+328>>2]=b,c[h+332>>2]=x,c[h+336>>2]=R}return{hash:l}}},function(n,i){var r=this,s=void 0;typeof self<"u"&&typeof self.FileReaderSync<"u"&&(s=new self.FileReaderSync);var a=function(l,u,h,d,f,p){var g=void 0,_=p%4,v=(f+_)%4,b=f-v;switch(_){case 0:u[p]=l.charCodeAt(d+3);case 1:u[p+1-(_<<1)|0]=l.charCodeAt(d+2);case 2:u[p+2-(_<<1)|0]=l.charCodeAt(d+1);case 3:u[p+3-(_<<1)|0]=l.charCodeAt(d)}if(!(f<v+(4-_))){for(g=4-_;g<b;g=g+4|0)h[p+g>>2]=l.charCodeAt(d+g)<<24|l.charCodeAt(d+g+1)<<16|l.charCodeAt(d+g+2)<<8|l.charCodeAt(d+g+3);switch(v){case 3:u[p+b+1|0]=l.charCodeAt(d+b+2);case 2:u[p+b+2|0]=l.charCodeAt(d+b+1);case 1:u[p+b+3|0]=l.charCodeAt(d+b)}}},o=function(l,u,h,d,f,p){var g=void 0,_=p%4,v=(f+_)%4,b=f-v;switch(_){case 0:u[p]=l[d+3];case 1:u[p+1-(_<<1)|0]=l[d+2];case 2:u[p+2-(_<<1)|0]=l[d+1];case 3:u[p+3-(_<<1)|0]=l[d]}if(!(f<v+(4-_))){for(g=4-_;g<b;g=g+4|0)h[p+g>>2|0]=l[d+g]<<24|l[d+g+1]<<16|l[d+g+2]<<8|l[d+g+3];switch(v){case 3:u[p+b+1|0]=l[d+b+2];case 2:u[p+b+2|0]=l[d+b+1];case 1:u[p+b+3|0]=l[d+b]}}},c=function(l,u,h,d,f,p){var g=void 0,_=p%4,v=(f+_)%4,b=f-v,S=new Uint8Array(s.readAsArrayBuffer(l.slice(d,d+f)));switch(_){case 0:u[p]=S[3];case 1:u[p+1-(_<<1)|0]=S[2];case 2:u[p+2-(_<<1)|0]=S[1];case 3:u[p+3-(_<<1)|0]=S[0]}if(!(f<v+(4-_))){for(g=4-_;g<b;g=g+4|0)h[p+g>>2|0]=S[g]<<24|S[g+1]<<16|S[g+2]<<8|S[g+3];switch(v){case 3:u[p+b+1|0]=S[b+2];case 2:u[p+b+2|0]=S[b+1];case 1:u[p+b+3|0]=S[b]}}};n.exports=function(l,u,h,d,f,p){if(typeof l=="string")return a(l,u,h,d,f,p);if(l instanceof Array||r&&r.Buffer&&r.Buffer.isBuffer(l))return o(l,u,h,d,f,p);if(l instanceof ArrayBuffer)return o(new Uint8Array(l),u,h,d,f,p);if(l.buffer instanceof ArrayBuffer)return o(new Uint8Array(l.buffer,l.byteOffset,l.byteLength),u,h,d,f,p);if(l instanceof Blob)return c(l,u,h,d,f,p);throw new Error("Unsupported data type.")}},function(n,i,r){var s=function(){function h(d,f){for(var p=0;p<f.length;p++){var g=f[p];g.enumerable=g.enumerable||!1,g.configurable=!0,"value"in g&&(g.writable=!0),Object.defineProperty(d,g.key,g)}}return function(d,f,p){return f&&h(d.prototype,f),p&&h(d,p),d}}();function a(h,d){if(!(h instanceof d))throw new TypeError("Cannot call a class as a function")}var o=r(0),c=r(1),l=c.toHex,u=function(){function h(){a(this,h),this._rusha=new o,this._rusha.resetState()}return h.prototype.update=function(f){return this._rusha.append(f),this},h.prototype.digest=function(f){var p=this._rusha.rawEnd().buffer;if(!f)return p;if(f==="hex")return l(p);throw new Error("unsupported digest encoding")},s(h,[{key:"state",get:function(){return this._rusha.getState()},set:function(d){this._rusha.setState(d)}}]),h}();n.exports=function(){return new u}}])})})(Hwe);var Vwe=Hwe.exports;const WIt=Vwe;let YB,HL,VL;function YIt(){YB=WIt.createWorker(),HL=1,VL={},YB.onmessage=function(e){const n=e.data.id,i=VL[n];delete VL[n],e.data.error!=null?i(new Error("Rusha worker error: "+e.data.error)):i(null,e.data.hash)}}function KIt(t,e){YB||YIt(),VL[HL]=e,YB.postMessage({id:HL,data:t}),HL+=1}var XIt=KIt;const ZIt=Vwe,JIt=XIt,QIt=new ZIt,Bce=typeof window<"u"?window:self,Fce=Bce.crypto||Bce.msCrypto||{};let zO=Fce.subtle||Fce.webkitSubtle;function GL(t){return QIt.digest(t)}try{zO.digest({name:"sha-1"},new Uint8Array).catch(function(){zO=!1})}catch{zO=!1}function ekt(t,e){if(!zO){typeof window<"u"?JIt(t,function(i,r){if(i){e(GL(t));return}e(r)}):queueMicrotask(()=>e(GL(t)));return}typeof t=="string"&&(t=tkt(t)),zO.digest({name:"sha-1"},t).then(function(i){e(nkt(new Uint8Array(i)))},function(){e(GL(t))})}function tkt(t){const e=t.length,n=new Uint8Array(e);for(let i=0;i<e;i++)n[i]=t.charCodeAt(i);return n}function nkt(t){const e=t.length,n=[];for(let i=0;i<e;i++){const r=t[i];n.push((r>>>4).toString(16)),n.push((r&15).toString(16))}return n.join("")}JZ.exports=ekt;JZ.exports.sync=GL;var ikt=JZ.exports;const zce=$It,rkt=s5,skt=TP,akt=ikt,NM=r5("p2pt"),jce="^",Hce=16e3;class okt extends skt{constructor(e=[],n=""){super(),this.announceURLs=e,this.trackers={},this.peers={},this.msgChunks={},this.responseWaiting={},n&&this.setIdentifier(n),this._peerIdBuffer=rkt(20),this._peerId=this._peerIdBuffer.toString("hex"),this._peerIdBinary=this._peerIdBuffer.toString("binary"),NM("my peer id: "+this._peerId)}setIdentifier(e){this.identifierString=e,this.infoHash=akt.sync(e).toLowerCase(),this._infoHashBuffer=Yl.from(this.infoHash,"hex"),this._infoHashBinary=this._infoHashBuffer.toString("binary")}start(){this.on("peer",e=>{let n=!1;this.peers[e.id]||(n=!0,this.peers[e.id]={},this.responseWaiting[e.id]={}),e.on("connect",()=>{this.peers[e.id][e.channelName]=e,n&&this.emit("peerconnect",e)}),e.on("data",i=>{if(this.emit("data",e,i),i=i.toString(),NM("got a message from "+e.id),i[0]===jce)try{i=JSON.parse(i.slice(1)),e.respond=this._peerRespond(e,i.id);let r=this._chunkHandler(i);r!==!1&&(i.o&&(r=JSON.parse(r)),this.responseWaiting[e.id][i.id]?(this.responseWaiting[e.id][i.id]([e,r]),delete this.responseWaiting[e.id][i.id]):this.emit("msg",e,r),this._destroyChunks(i.id))}catch(r){console.log(r)}}),e.on("error",i=>{this._removePeer(e),NM("Error in connection : "+i)}),e.on("close",()=>{this._removePeer(e),NM("Connection closed with "+e.id)})}),this.on("update",e=>{const n=this.trackers[this.announceURLs.indexOf(e.announce)];this.emit("trackerconnect",n,this.getTrackerStats())}),this.on("warning",e=>{this.emit("trackerwarning",e,this.getTrackerStats())}),this._fetchPeers()}addTracker(e){if(this.announceURLs.indexOf(e)!==-1)throw new Error("Tracker already added");const n=this.announceURLs.push(e);this.trackers[n]=new zce(this,e),this.trackers[n].announce(this._defaultAnnounceOpts())}removeTracker(e){const n=this.announceURLs.indexOf(e);if(n===-1)throw new Error("Tracker does not exist");this.trackers[n].peers=[],this.trackers[n].destroy(),delete this.trackers[n],delete this.announceURLs[n]}_removePeer(e){if(!this.peers[e.id])return!1;delete this.peers[e.id][e.channelName],Object.keys(this.peers[e.id]).length===0&&(this.emit("peerclose",e),delete this.responseWaiting[e.id],delete this.peers[e.id])}send(e,n,i=""){return new Promise((r,s)=>{const a={id:i!==""?i:Math.floor(Math.random()*1e5+1e5),msg:n};typeof n=="object"&&(a.msg=JSON.stringify(n),a.o=1);try{if(!e.connected){for(const l in this.peers[e.id])if(e=this.peers[e.id][l],e.connected)break}this.responseWaiting[e.id]||(this.responseWaiting[e.id]={}),this.responseWaiting[e.id][a.id]=r}catch(l){return s(Error("Connection to peer closed"+l))}let o=0,c="";for(;a.msg.length>0;)a.c=o,c=a.msg.slice(Hce),a.msg=a.msg.slice(0,Hce),c||(a.last=!0),e.send(jce+JSON.stringify(a)),a.msg=c,o++;NM("sent a message to "+e.id)})}requestMorePeers(){return new Promise(e=>{for(const n in this.trackers)this.trackers[n].announce(this._defaultAnnounceOpts());e(this.peers)})}getTrackerStats(){let e=0;for(const n in this.trackers)this.trackers[n].socket&&this.trackers[n].socket.connected&&e++;return{connected:e,total:this.announceURLs.length}}destroy(){let e;for(e in this.peers)for(const n in this.peers[e])this.peers[e][n].destroy();for(e in this.trackers)this.trackers[e].destroy()}_peerRespond(e,n){return i=>this.send(e,i,n)}_chunkHandler(e){return this.msgChunks[e.id]||(this.msgChunks[e.id]=[]),this.msgChunks[e.id][e.c]=e.msg,e.last?this.msgChunks[e.id].join(""):!1}_destroyChunks(e){delete this.msgChunks[e]}_defaultAnnounceOpts(e={}){return e.numwant==null&&(e.numwant=50),e.uploaded==null&&(e.uploaded=0),e.downloaded==null&&(e.downloaded=0),e}_fetchPeers(){for(const e in this.announceURLs)this.trackers[e]=new zce(this,this.announceURLs[e]),this.trackers[e].announce(this._defaultAnnounceOpts())}}var ckt=okt;const lkt=il(ckt),ukt=`
wss://tracker.btorrent.xyz
wss://tracker.webtorrent.dev
wss://tracker.openwebtorrent.com
`.split(`
`).map(t=>t.trim()).filter(t=>t);function MR(t){return ON(t)}const hkt="hubworld_e840e8d183e2f539e772d63ed83012427ebca6b4",bp=new lkt(ukt,hkt),wP=new xNt(MR(bp._peerId),{getId(t){return t.id}});bp.on("peerconnect",t=>{xr(Ye,Gi(),`remote connected ${t.id}`),wP.add({id:MR(t.id),peer:t})});bp.on("peerclose",t=>{xr(Ye,Gi(),`remote closed ${t.id}`),wP.remove(MR(t.id))});let qL="";const Vce=new Map;bp.on("msg",(t,e)=>{const n=Date.now(),i=Vce.get(e.topic)??new Map;if("pub"in e){e.topic===qL&&(hb==null||hb.forward({...e.gme,session:Ye.session()}));for(const[r,s]of i)if(n-s>1e3*60)i.delete(r);else{const[o]=wP.listClosestToId(MR(r),1);re(o)&&bp.send(o.peer,e).catch(console.error)}}else"sub"in e&&(i.set(e.sub,n),e.topic===qL&&bp._peerId===qL?(hb==null||hb.forward({...e.gme,session:Ye.session()}),fkt()):re(e.gme)&&$we(e.topic,e.sub,e.gme));Vce.set(e.topic,i)});bp.on("trackerconnect",(t,e)=>{xr(Ye,Gi(),`looking for players ${j6e(t.announceUrl)} [${e.connected}]`)});let Gce=!1,hb,Gwe;function dkt(t){function e(){t6e(Ye,t)}e(),Gwe=setInterval(e,5*1e3)}function fkt(){clearInterval(Gwe)}function qwe(t){Gce||(Gce=!0,qL=t,bp.start(),xr(Ye,Gi(),`connecting to hubworld for ${t}`))}function pkt(t,e){const[n]=wP.listClosestToId(MR(t),1);re(n)&&bp.send(n.peer,{topic:t,pub:!0,gme:e}).catch(()=>{})}function qce(t,e){const n=bp._peerId;qwe(n),O4e(Ye,Gi(),t,n),e&&M4e(Ye,Gi(),n),hb=cX(i=>{h0t(i)&&u0t(i)===!1&&pkt(n,i)})}function $we(t,e,n){const[i]=wP.listClosestToId(MR(t),1);re(i)&&bp.send(i.peer,{topic:t,sub:e,gme:n}).catch(console.error)}function mkt(t,e){qwe(t),hb=cX(n=>{jbe(n)&&d0t()===!1&&$we(t,bp._peerId,n)}),setTimeout(()=>dkt(e),1e3)}let Ag,fu;async function gkt(t,e,n,i,r,s){let a;switch(Wn(r)){case"get":{a=await fetch(i);break}case"post:json":{const l=[];for(let u=0;u<s.length;u+=2)l.push([s[u],s[u+1]]);a=await fetch(i,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(d3e(l))});break}}if(!(a!=null&&a.ok))return;const o=`fetch:${n}`,[c]=(a.headers.get("content-type")??"").split(";");switch(c){case"text/plain":{const l=await a.text();xr(Ye,t,JSON.stringify(l)),xm(Ye,t,e,"text",o,l);break}case"application/json":{const l=await a.json();xr(Ye,t,JSON.stringify(l)),xm(Ye,t,e,"json",o,l);break}case"application/octet-stream":{const l=await a.arrayBuffer();xm(Ye,t,e,"binary",o,new Uint8Array(l));break}}}const sa=NE("bridge",[],t=>{if(!sa.session(t))return;const e=Gi();switch(t.target){default:if(t.player!==e)return;break}switch(t.target){case"fetch":if(ji(t.data)){const[n,i,r,s,a]=t.data;_l(Ye,t.player,async()=>{await gkt(t.player,n,i,r,s,a)})}break;case"start":qce(!!t.data,!1);break;case"tab":qce(!!t.data,!0);break;case"tabopen":Tn(t.data)&&window.open(`${location.origin}/join/#${t.data}`,"_blank","noopener,noreferrer");break;case"join":Tn(t.data)&&mkt(t.data,t.player);break;case"showjoincode":_l(sa,t.player,async()=>{if(ji(t.data)){const[n,i]=t.data,r=`${location.origin}/join/#${i}`,s=await Ime(r);n?Aq(sa,t.player,s,"secret join url",!1):Aq(sa,t.player,s,s)}});break;case"talkstart":ARt();break;case"talkstop":RRt();break;case"mediastart":ORt();break;case"mediastop":NRt();break;case"chatstart":re(Ag)?Mi(sa,t.player,"bridge","chat is already started"):Tn(t.data)&&(xr(sa,t.player,`connecting to ${t.data}`),Ag=new $B({channels:[t.data]}),Ag.connect(),Ag.onConnect(()=>{xr(sa,t.player,"connected")}),Ag.onDisconnect(()=>{xr(sa,t.player,"disconnected")}),Ag.onMessage((n,i,r)=>{xm(sa,t.player,void 0,"text",`chat:message:${t.data}`,`${i}:${r}`)}),Ag.onAction((n,i,r)=>{xm(sa,t.player,void 0,"text",`chat:action:${t.data}`,`${i}:${r}`)}));break;case"chatstop":re(Ag)?(Ag.quit(),Ag=void 0,xr(sa,t.player,"chat stopped")):Mi(sa,t.player,"bridge","chat is already stoped");break;case"streamstart":_l(sa,t.player,async()=>{if(re(fu))Mi(sa,t.player,"bridge","stream is already open");else{const n=window.innerHeight>window.innerWidth;fu=ZS.create({streamConfig:n?ZS.STANDARD_PORTRAIT:ZS.STANDARD_LANDSCAPE,logLevel:ZS.LOG_LEVEL.DEBUG}),fu.on(ZS.BroadcastClientEvents.ACTIVE_STATE_CHANGE,function(s){console.info({activestate:s})}),fu.on(ZS.BroadcastClientEvents.CONNECTION_STATE_CHANGE,function(s){xr(sa,t.player,s)}),fu.on(ZS.BroadcastClientEvents.ERROR,function(s){Mi(sa,t.player,"bridge",s),fu=void 0});const i=document.querySelector("canvas");if(re(i))await fu.addImageSource(i,"video",{index:1});else{Mi(sa,t.player,"video","unabled to find canvas element"),fu=void 0;return}const r=bxt();if(re(r))await fu.addAudioInputDevice(r.stream,"audio");else{Mi(sa,t.player,"video","unable create media audio node destination"),fu=void 0;return}xr(sa,t.player,"created client")}Tn(t.data)&&re(fu)&&(Bg(sa,t.player,"broadcasting in"),hp(sa,t.player,"3","..."),await Kf(1e3),hp(sa,t.player,"2","..."),await Kf(1e3),hp(sa,t.player,"1","..."),await Kf(1e3),Bg(sa,t.player,"GOING LIVE"),await fu.startBroadcast(t.data,"https://g.webrtc.live-video.net:4443"))});break;case"streamstop":re(fu)?(fu.stopBroadcast(),fu.delete(),fu=void 0,xr(sa,t.player,"stream stopped")):Mi(sa,t.player,"bridge","stream already stopped");break}});function vkt(){const{viewport:t}=Tu(),{width:e,height:n}=t.getCurrentViewport(),[i]=De.useState(()=>new Rxt);De.useEffect(()=>{if(!$$e)return;document.body.appendChild(i.dom),i.showPanel(0),i.dom.style.cssText="position:fixed;bottom:0;left:0;";const v=WDe(()=>i.begin()),b=YDe(()=>i.end());return()=>{document.body.removeChild(i.dom),v(),b()}},[i]);const r=Pxt(),[s,a]=De.useState(!1),[o,c]=De.useState(!1),[l,u]=De.useState(!1);De.useLayoutEffect(()=>{_l(Ye,Gi(),async()=>{const v=await EL("lowrez");Wn(v)==="on"&&a(!0);const b=await EL("crt");Wn(b)!=="off"&&c(!0);const S=await EL("scanlines");Wn(S)==="on"&&u(!0)})},[]);const h=Math.min(e,n),d=s||h<600;Kt.DRAW_CHAR_SCALE=d?1:2;const f=e>n,p=o7==="touchOnly"||MCt==="touch",g=!d&&!p&&o===!0&&r&&r.tier>2&&!r.isMobile;De.useEffect(()=>{od.setState(v=>({...v,islowrez:d,islandscape:f,showtouchcontrols:p}))},[d,f,p]);const{mood:_}=_p();return be.jsxs(be.Fragment,{children:[be.jsx(sx,{children:be.jsxs($At,{children:[be.jsx(eMt,{}),be.jsx(FMt,{}),be.jsx(jMt,{})]})}),g&&be.jsxs(vCt,{multisampling:8,children:[be.jsxs(be.Fragment,{children:[_.includes("dark")&&be.jsxs(De.Fragment,{children:[be.jsx(bCt,{delay:[10,60*2],duration:[.1,3],strength:[0,1],mode:bb.SPORADIC,active:!0,ratio:.5}),be.jsx(ECt,{opacity:.5,premultiply:!0,blendFunction:sr.DARKEN})]},"mood"),_.includes("bright")&&be.jsx(De.Fragment,{children:be.jsx(yCt,{intensity:.5,luminanceThreshold:.5,kernelSize:$8.VERY_LARGE})},"mood"),l&&be.jsx(SCt,{blendFunction:sr.OVERLAY,density:1.28})]}),be.jsx(TCt,{eskil:!0,offset:.89,darkness:.9}),be.jsx(UCt,{viewheight:n})]})]})}document.addEventListener("keydown",()=>{qE()});window.addEventListener("touchstart",()=>{qE()});window.addEventListener("click",()=>{qE()});window.addEventListener("dragover",t=>{t.preventDefault()});window.addEventListener("contextmenu",t=>{qE(),t.preventDefault()});window.addEventListener("paste",t=>{var n;if(!((n=t.clipboardData)!=null&&n.files.length))return;qE(),t.preventDefault(),[...t.clipboardData.files].forEach(i=>xm(Ye,Gi(),void 0,"file",`file:${i.name}`,i))});window.addEventListener("drop",t=>{var e,n;qE(),t.preventDefault(),(e=t.dataTransfer)!=null&&e.items?[...t.dataTransfer.items].forEach(r=>{if(r.kind==="file"){const s=r.getAsFile();re(s)&&xm(Ye,Gi(),void 0,"file",s.name,s)}}):[...((n=t.dataTransfer)==null?void 0:n.files)??[]].forEach(r=>xm(Ye,Gi(),void 0,"file",r.name,r))});function _kt(){return be.jsx(vkt,{})}FUe();const ykt=t=>({...Dhe(t),filter:e=>{const n=e.filter(a=>!!a.object.visible),i=n.findIndex(a=>a.object.userData.blocking),r=i===-1?n:n.slice(0,i+1);let s="default";return r.some(a=>a.object.userData.cursor?(s=a.object.userData.cursor,!0):!1),document.querySelectorAll("html, body").forEach(a=>{a.style.cursor=s}),r}});let VV;function bkt(t,e){const n=document.getElementById("frame");if(!re(n))return;const i=fte(t),r=fte(e);n.style.width=`${i}px`,n.style.height=`${r}px`,re(VV)||(VV=LUe.createRoot(n),VV.render(be.jsx(t2e,{flat:!0,linear:!0,dpr:1,shadows:!1,events:ykt,gl:{alpha:!0,stencil:!1,antialias:!1,preserveDrawingBuffer:!0},children:be.jsx(_kt,{})})))}const Wwe=i2e(bkt,256);window.addEventListener("resize",()=>Wwe(window.innerWidth,window.innerHeight));Wwe(window.innerWidth,window.innerHeight);export{Yl as B,kPt as a,bet as b,Ml as c,Gn as p,S1 as r};
