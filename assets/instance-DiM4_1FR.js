var pM=Object.defineProperty;var mM=(ir,Nt,Re)=>Nt in ir?pM(ir,Nt,{enumerable:!0,configurable:!0,writable:!0,value:Re}):ir[Nt]=Re;var X=(ir,Nt,Re)=>(mM(ir,typeof Nt!="symbol"?Nt+"":Nt,Re),Re);(function(){"use strict";const ir=new Set,Nt={emit(e,t,n,r){Nt.invoke(Bb(e,t,n,r))},invoke(e){ir.forEach(t=>t.handle(e))},connect(e){ir.add(e)},disconnect(e){ir.delete(e)}};var Re=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function hs(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function Eb(e){if(e.__esModule)return e;var t=e.default;if(typeof t=="function"){var n=function r(){return this instanceof r?Reflect.construct(t,arguments,this.constructor):t.apply(this,arguments)};n.prototype=t.prototype}else n={};return Object.defineProperty(n,"__esModule",{value:!0}),Object.keys(e).forEach(function(r){var i=Object.getOwnPropertyDescriptor(e,r);Object.defineProperty(n,r,i.get?i:{enumerable:!0,get:function(){return e[r]}})}),n}var $h={};(function(e){var t=Re&&Re.__spreadArray||function(l,u,f){if(f||arguments.length===2)for(var d=0,h=u.length,p;d<h;d++)(p||!(d in u))&&(p||(p=Array.prototype.slice.call(u,0,d)),p[d]=u[d]);return l.concat(p||Array.prototype.slice.call(u))};Object.defineProperty(e,"__esModule",{value:!0}),e.minLength=e.maxLength=e.poolSize=e.humanId=e.adverbs=e.verbs=e.nouns=e.adjectives=void 0,e.adjectives=["afraid","all","angry","beige","big","better","bitter","blue","brave","breezy","bright","brown","bumpy","busy","calm","chatty","chilly","chubby","clean","clear","clever","cold","crazy","cruel","cuddly","curly","curvy","cute","common","cold","cool","cyan","dark","deep","dirty","dry","dull","eager","early","easy","eight","eighty","eleven","empty","every","evil","fair","famous","fast","fancy","few","fine","fifty","five","flat","fluffy","floppy","forty","four","free","fresh","fruity","full","funny","fuzzy","gentle","giant","gold","good","great","green","grumpy","happy","heavy","hip","honest","hot","huge","hungry","icy","itchy","khaki","kind","large","late","lazy","lemon","legal","light","little","long","loose","loud","lovely","lucky","major","many","mean","metal","mighty","modern","moody","nasty","neat","new","nice","nine","ninety","odd","old","olive","open","orange","pink","plain","plenty","polite","poor","pretty","proud","public","puny","petite","purple","quick","quiet","rare","real","ready","red","rich","ripe","rotten","rude","sad","salty","seven","shaggy","shaky","sharp","shiny","short","shy","silent","silly","silver","six","sixty","slick","slimy","slow","small","smart","smooth","social","soft","solid","some","sour","spicy","spotty","stale","strong","stupid","sweet","swift","tall","tame","tangy","tasty","ten","tender","thick","thin","thirty","three","tidy","tiny","tired","tough","tricky","true","twelve","twenty","two","upset","vast","violet","warm","weak","wet","whole","wicked","wide","wild","wise","witty","yellow","young","yummy"],e.nouns=["apes","animals","areas","bars","banks","baths","breads","bushes","cloths","clowns","clubs","hoops","loops","memes","papers","parks","paths","showers","sides","signs","sites","streets","teeth","tires","webs","actors","ads","adults","aliens","ants","apples","baboons","badgers","bags","bananas","bats","beans","bears","beds","beers","bees","berries","bikes","birds","boats","bobcats","books","bottles","boxes","brooms","buckets","bugs","buses","buttons","camels","cases","cameras","candies","candles","carpets","carrots","carrots","cars","cats","chairs","chefs","chicken","clocks","clouds","coats","cobras","coins","corners","colts","comics","cooks","cougars","regions","results","cows","crabs","crabs","crews","cups","cities","cycles","dancers","days","deer","dingos","dodos","dogs","dolls","donkeys","donuts","doodles","doors","dots","dragons","drinks","dryers","ducks","ducks","eagles","ears","eels","eggs","ends","mammals","emus","experts","eyes","facts","falcons","fans","feet","files","flies","flowers","forks","foxes","friends","frogs","games","garlics","geckos","geese","ghosts","ghosts","gifts","glasses","goats","grapes","groups","guests","hairs","hands","hats","heads","hornets","horses","hotels","hounds","houses","humans","icons","ideas","impalas","insects","islands","items","jars","jeans","jobs","jokes","keys","kids","kings","kiwis","knives","lamps","lands","laws","lemons","lies","lights","lines","lions","lizards","llamas","mails","mangos","maps","masks","meals","melons","mice","mirrors","moments","moles","monkeys","months","moons","moose","mugs","nails","needles","news","nights","numbers","olives","onions","oranges","otters","owls","pandas","pans","pants","papayas","parents","parts","parrots","paws","peaches","pears","peas","pens","pets","phones","pianos","pigs","pillows","places","planes","planets","plants","plums","poems","poets","points","pots","pugs","pumas","queens","rabbits","radios","rats","ravens","readers","rice","rings","rivers","rockets","rocks","rooms","roses","rules","schools","bats","seals","seas","sheep","shirts","shoes","shrimps","singers","sloths","snails","snakes","socks","spiders","spies","spoons","squids","stars","states","steaks","wings","suits","suns","swans","symbols","tables","taxes","taxis","teams","terms","things","ties","tigers","times","tips","toes","towns","tools","toys","trains","trams","trees","turkeys","turtles","vans","views","walls","walls","wasps","waves","ways","weeks","windows","wolves","women","wombats","words","worlds","worms","yaks","years","zebras","zoos"],e.verbs=["accept","act","add","admire","agree","allow","appear","argue","arrive","ask","attack","attend","bake","bathe","battle","beam","beg","begin","behave","bet","boil","bow","brake","brush","build","burn","buy","call","camp","care","carry","change","cheat","check","cheer","chew","clap","clean","cough","count","cover","crash","create","cross","cry","cut","dance","decide","deny","design","dig","divide","do","double","doubt","draw","dream","dress","drive","drop","drum","eat","end","enter","enjoy","exist","fail","fall","feel","fetch","film","find","fix","flash","float","flow","fly","fold","follow","fry","give","glow","go","grab","greet","grin","grow","guess","hammer","hang","happen","heal","hear","help","hide","hope","hug","hunt","invent","invite","itch","jam","jog","join","joke","judge","juggle","jump","kick","kiss","kneel","knock","know","laugh","lay","lead","learn","leave","lick","like","lie","listen","live","look","lose","love","make","march","marry","mate","matter","melt","mix","move","nail","notice","obey","occur","open","own","pay","peel","play","poke","post","press","prove","pull","pump","pick","punch","push","raise","read","refuse","relate","relax","remain","repair","repeat","reply","report","rescue","rest","retire","return","rhyme","ring","roll","rule","run","rush","say","scream","see","search","sell","send","serve","shake","share","shave","shine","show","shop","shout","sin","sink","sing","sip","sit","sleep","slide","smash","smell","smile","smoke","sneeze","sniff","sort","speak","spend","stand","start","stay","stick","stop","stare","study","strive","swim","switch","take","talk","tan","tap","taste","teach","tease","tell","thank","think","throw","tickle","tie","trade","train","travel","try","turn","type","unite","vanish","visit","wait","walk","warn","wash","watch","wave","wear","win","wink","wish","wonder","work","worry","write","yawn","yell"],e.adverbs=["bravely","brightly","busily","daily","freely","hungrily","joyously","knowlingly","lazily","oddly","mysteriously","noisily","politely","quickly","quietly","rapidly","safely","sleepily","slowly","truly","yearly"];function n(l){return l[Math.floor(Math.random()*l.length)]}function r(l){return l.reduce(function(u,f){return u.length>f.length?u:f})}function i(l){return l.reduce(function(u,f){return u.length<f.length?u:f})}function s(l){l===void 0&&(l={}),typeof l=="string"&&(l={separator:l}),typeof l=="boolean"&&(l={capitalize:l});var u=l.separator,f=u===void 0?"":u,d=l.capitalize,h=d===void 0?!0:d,p=l.adjectiveCount,m=p===void 0?1:p,v=l.addAdverb,b=v===void 0?!1:v,y=t(t(t([],t([],Array(m),!0).map(function(A){return n(e.adjectives)}),!0),[n(e.nouns),n(e.verbs)],!1),b?[n(e.adverbs)]:[],!0);return h&&(y=y.map(function(A){return A.charAt(0).toUpperCase()+A.substr(1)})),y.join(f)}e.humanId=s;function o(l){l===void 0&&(l={});var u=l.adjectiveCount,f=u===void 0?1:u,d=l.addAdverb,h=d===void 0?!1:d;return e.adjectives.length*f*e.nouns.length*e.verbs.length*(h?e.adverbs.length:1)}e.poolSize=o;function a(l){l===void 0&&(l={});var u=l.adjectiveCount,f=u===void 0?1:u,d=l.addAdverb,h=d===void 0?!1:d,p=l.separator,m=p===void 0?"":p;return r(e.adjectives).length*f+f*m.length+r(e.nouns).length+m.length+r(e.verbs).length+(h?r(e.adverbs).length+m.length:0)}e.maxLength=a;function c(l){l===void 0&&(l={});var u=l.adjectiveCount,f=u===void 0?1:u,d=l.addAdverb,h=d===void 0?!1:d,p=l.separator,m=p===void 0?"":p;return i(e.adjectives).length*f+f*m.length+i(e.nouns).length+m.length+i(e.verbs).length+(h?i(e.adverbs).length+m.length:0)}e.minLength=c,e.default=s})($h);var Fh=hs($h);const kb="useandom-26T198340PX75pxJACKVERYMINDBUSHWOLF_GQZbfghjklqvwyzrict";let Ab=e=>crypto.getRandomValues(new Uint8Array(e)),Sb=(e,t,n)=>{let r=(2<<Math.log(e.length-1)/Math.LN2)-1,i=-~(1.6*r*t/e.length);return(s=t)=>{let o="";for(;;){let a=n(i),c=i;for(;c--;)if(o+=e[a[c]&r]||"",o.length===s)return o}}},jh=(e,t=21)=>Sb(e,t,Ab),Tb=(e=21)=>{let t="",n=crypto.getRandomValues(new Uint8Array(e));for(;e--;)t+=kb[n[e]&63];return t};var zh="abcdefghijklmnopqrstuvwxyz",Gh="ABCDEFGHIJKLMNOPQRSTUVWXYZ",Wh="0123456789",Rb="346789ABCDEFGHJKLMNPQRTUVWXYabcdefghijkmnpqrtwxyz",Ob="6789BCDFGHJKLMNPQRTWbcdfghjkmnpqrtwz";const Ib=Wh,xb=zh,Cb=Gh;var Nb=Ib+xb+Cb,Nc={lowercase:zh,uppercase:Gh,numbers:Wh,nolookalikes:Rb,nolookalikesSafe:Ob,alphanumeric:Nb};function sr(){return`sid_${Tb(12).replaceAll("-",".")}`}const Lb=jh(Nc.numbers,4),Mb=jh(`${Nc.numbers}${Nc.lowercase}`,16);function Ub(){return`pid_${Lb()}_${Mb()}`}function Db(e){return(e==null?void 0:e.startsWith("pid_"))??!1}function Pb(){return Fh({capitalize:!1,adjectiveCount:1})}function Kh(){return Fh({addAdverb:!1,capitalize:!1,adjectiveCount:0})}function Bb(e,t,n,r){return{id:sr(),target:e,sender:t,data:n,player:r}}function Hh(e){const[t,...n]=e.split(":");return{target:t,path:n.join(":")}}function So(e,t,n){const r=sr(),i=e.toLowerCase(),s=t.map(a=>a.toLowerCase()),o={id(){return r},name(){return e},topics(){return t},emit(a,c,l){Nt.emit(a,r,c,l)},reply(a,c,l,u){o.emit(`${a.sender}:${c}`,l,u)},handle(a){const{target:c,path:l}=Hh(a.target),u=c.toLowerCase();s.findIndex(f=>f==="all"||f===u)!==-1&&n(a),(r===c||u==="all"||i===u)&&n({...a,target:l})}};return Nt.connect(o),o}function $b(e){const t=new Set;function n(r){t.has(r.id)||(t.add(r.id),Nt.invoke(r))}return So("forward",["all"],r=>{t.has(r.id)||(t.add(r.id),e(r))}),n}/*!
 * https://github.com/Starcounter-Jack/JSON-Patch
 * (c) 2017-2022 Joachim Wester
 * MIT licensed
 */var Fb=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var s in i)i.hasOwnProperty(s)&&(r[s]=i[s])},e(t,n)};return function(t,n){e(t,n);function r(){this.constructor=t}t.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),jb=Object.prototype.hasOwnProperty;function Lc(e,t){return jb.call(e,t)}function Mc(e){if(Array.isArray(e)){for(var t=new Array(e.length),n=0;n<t.length;n++)t[n]=""+n;return t}if(Object.keys)return Object.keys(e);var r=[];for(var i in e)Lc(e,i)&&r.push(i);return r}function Ne(e){switch(typeof e){case"object":return JSON.parse(JSON.stringify(e));case"undefined":return null;default:return e}}function Uc(e){for(var t=0,n=e.length,r;t<n;){if(r=e.charCodeAt(t),r>=48&&r<=57){t++;continue}return!1}return!0}function Jr(e){return e.indexOf("/")===-1&&e.indexOf("~")===-1?e:e.replace(/~/g,"~0").replace(/\//g,"~1")}function Vh(e){return e.replace(/~1/g,"/").replace(/~0/g,"~")}function Dc(e){if(e===void 0)return!0;if(e){if(Array.isArray(e)){for(var t=0,n=e.length;t<n;t++)if(Dc(e[t]))return!0}else if(typeof e=="object"){for(var r=Mc(e),i=r.length,s=0;s<i;s++)if(Dc(e[r[s]]))return!0}}return!1}function Yh(e,t){var n=[e];for(var r in t){var i=typeof t[r]=="object"?JSON.stringify(t[r],null,2):t[r];typeof i<"u"&&n.push(r+": "+i)}return n.join(`
`)}var qh=function(e){Fb(t,e);function t(n,r,i,s,o){var a=this.constructor,c=e.call(this,Yh(n,{name:r,index:i,operation:s,tree:o}))||this;return c.name=r,c.index=i,c.operation=s,c.tree=o,Object.setPrototypeOf(c,a.prototype),c.message=Yh(n,{name:r,index:i,operation:s,tree:o}),c}return t}(Error),Vt=qh,zb=Ne,Ri={add:function(e,t,n){return e[t]=this.value,{newDocument:n}},remove:function(e,t,n){var r=e[t];return delete e[t],{newDocument:n,removed:r}},replace:function(e,t,n){var r=e[t];return e[t]=this.value,{newDocument:n,removed:r}},move:function(e,t,n){var r=To(n,this.path);r&&(r=Ne(r));var i=Xr(n,{op:"remove",path:this.from}).removed;return Xr(n,{op:"add",path:this.path,value:i}),{newDocument:n,removed:r}},copy:function(e,t,n){var r=To(n,this.from);return Xr(n,{op:"add",path:this.path,value:Ne(r)}),{newDocument:n}},test:function(e,t,n){return{newDocument:n,test:fs(e[t],this.value)}},_get:function(e,t,n){return this.value=e[t],{newDocument:n}}},Gb={add:function(e,t,n){return Uc(t)?e.splice(t,0,this.value):e[t]=this.value,{newDocument:n,index:t}},remove:function(e,t,n){var r=e.splice(t,1);return{newDocument:n,removed:r[0]}},replace:function(e,t,n){var r=e[t];return e[t]=this.value,{newDocument:n,removed:r}},move:Ri.move,copy:Ri.copy,test:Ri.test,_get:Ri._get};function To(e,t){if(t=="")return e;var n={op:"_get",path:t};return Xr(e,n),n.value}function Xr(e,t,n,r,i,s){if(n===void 0&&(n=!1),r===void 0&&(r=!0),i===void 0&&(i=!0),s===void 0&&(s=0),n&&(typeof n=="function"?n(t,0,e,t.path):Ro(t,0)),t.path===""){var o={newDocument:e};if(t.op==="add")return o.newDocument=t.value,o;if(t.op==="replace")return o.newDocument=t.value,o.removed=e,o;if(t.op==="move"||t.op==="copy")return o.newDocument=To(e,t.from),t.op==="move"&&(o.removed=e),o;if(t.op==="test"){if(o.test=fs(e,t.value),o.test===!1)throw new Vt("Test operation failed","TEST_OPERATION_FAILED",s,t,e);return o.newDocument=e,o}else{if(t.op==="remove")return o.removed=e,o.newDocument=null,o;if(t.op==="_get")return t.value=e,o;if(n)throw new Vt("Operation `op` property is not one of operations defined in RFC-6902","OPERATION_OP_INVALID",s,t,e);return o}}else{r||(e=Ne(e));var a=t.path||"",c=a.split("/"),l=e,u=1,f=c.length,d=void 0,h=void 0,p=void 0;for(typeof n=="function"?p=n:p=Ro;;){if(h=c[u],h&&h.indexOf("~")!=-1&&(h=Vh(h)),i&&(h=="__proto__"||h=="prototype"&&u>0&&c[u-1]=="constructor"))throw new TypeError("JSON-Patch: modifying `__proto__` or `constructor/prototype` prop is banned for security reasons, if this was on purpose, please set `banPrototypeModifications` flag false and pass it to this function. More info in fast-json-patch README");if(n&&d===void 0&&(l[h]===void 0?d=c.slice(0,u).join("/"):u==f-1&&(d=t.path),d!==void 0&&p(t,0,e,d)),u++,Array.isArray(l)){if(h==="-")h=l.length;else{if(n&&!Uc(h))throw new Vt("Expected an unsigned base-10 integer value, making the new referenced value the array element with the zero-based index","OPERATION_PATH_ILLEGAL_ARRAY_INDEX",s,t,e);Uc(h)&&(h=~~h)}if(u>=f){if(n&&t.op==="add"&&h>l.length)throw new Vt("The specified index MUST NOT be greater than the number of elements in the array","OPERATION_VALUE_OUT_OF_BOUNDS",s,t,e);var o=Gb[t.op].call(t,l,h,e);if(o.test===!1)throw new Vt("Test operation failed","TEST_OPERATION_FAILED",s,t,e);return o}}else if(u>=f){var o=Ri[t.op].call(t,l,h,e);if(o.test===!1)throw new Vt("Test operation failed","TEST_OPERATION_FAILED",s,t,e);return o}if(l=l[h],n&&u<f&&(!l||typeof l!="object"))throw new Vt("Cannot perform operation at the desired path","OPERATION_PATH_UNRESOLVABLE",s,t,e)}}}function Pc(e,t,n,r,i){if(r===void 0&&(r=!0),i===void 0&&(i=!0),n&&!Array.isArray(t))throw new Vt("Patch sequence must be an array","SEQUENCE_NOT_AN_ARRAY");r||(e=Ne(e));for(var s=new Array(t.length),o=0,a=t.length;o<a;o++)s[o]=Xr(e,t[o],n,!0,i,o),e=s[o].newDocument;return s.newDocument=e,s}function Wb(e,t,n){var r=Xr(e,t);if(r.test===!1)throw new Vt("Test operation failed","TEST_OPERATION_FAILED",n,t,e);return r.newDocument}function Ro(e,t,n,r){if(typeof e!="object"||e===null||Array.isArray(e))throw new Vt("Operation is not an object","OPERATION_NOT_AN_OBJECT",t,e,n);if(Ri[e.op]){if(typeof e.path!="string")throw new Vt("Operation `path` property is not a string","OPERATION_PATH_INVALID",t,e,n);if(e.path.indexOf("/")!==0&&e.path.length>0)throw new Vt('Operation `path` property must start with "/"',"OPERATION_PATH_INVALID",t,e,n);if((e.op==="move"||e.op==="copy")&&typeof e.from!="string")throw new Vt("Operation `from` property is not present (applicable in `move` and `copy` operations)","OPERATION_FROM_REQUIRED",t,e,n);if((e.op==="add"||e.op==="replace"||e.op==="test")&&e.value===void 0)throw new Vt("Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)","OPERATION_VALUE_REQUIRED",t,e,n);if((e.op==="add"||e.op==="replace"||e.op==="test")&&Dc(e.value))throw new Vt("Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)","OPERATION_VALUE_CANNOT_CONTAIN_UNDEFINED",t,e,n);if(n){if(e.op=="add"){var i=e.path.split("/").length,s=r.split("/").length;if(i!==s+1&&i!==s)throw new Vt("Cannot perform an `add` operation at the desired path","OPERATION_PATH_CANNOT_ADD",t,e,n)}else if(e.op==="replace"||e.op==="remove"||e.op==="_get"){if(e.path!==r)throw new Vt("Cannot perform the operation at a path that does not exist","OPERATION_PATH_UNRESOLVABLE",t,e,n)}else if(e.op==="move"||e.op==="copy"){var o={op:"_get",path:e.from,value:void 0},a=Jh([o],n);if(a&&a.name==="OPERATION_PATH_UNRESOLVABLE")throw new Vt("Cannot perform the operation from a path that does not exist","OPERATION_FROM_UNRESOLVABLE",t,e,n)}}}else throw new Vt("Operation `op` property is not one of operations defined in RFC-6902","OPERATION_OP_INVALID",t,e,n)}function Jh(e,t,n){try{if(!Array.isArray(e))throw new Vt("Patch sequence must be an array","SEQUENCE_NOT_AN_ARRAY");if(t)Pc(Ne(t),Ne(e),n||!0);else{n=n||Ro;for(var r=0;r<e.length;r++)n(e[r],r,t,void 0)}}catch(i){if(i instanceof Vt)return i;throw i}}function fs(e,t){if(e===t)return!0;if(e&&t&&typeof e=="object"&&typeof t=="object"){var n=Array.isArray(e),r=Array.isArray(t),i,s,o;if(n&&r){if(s=e.length,s!=t.length)return!1;for(i=s;i--!==0;)if(!fs(e[i],t[i]))return!1;return!0}if(n!=r)return!1;var a=Object.keys(e);if(s=a.length,s!==Object.keys(t).length)return!1;for(i=s;i--!==0;)if(!t.hasOwnProperty(a[i]))return!1;for(i=s;i--!==0;)if(o=a[i],!fs(e[o],t[o]))return!1;return!0}return e!==e&&t!==t}var Kb=Object.freeze({__proto__:null,JsonPatchError:Vt,_areEquals:fs,applyOperation:Xr,applyPatch:Pc,applyReducer:Wb,deepClone:zb,getValueByPointer:To,validate:Jh,validator:Ro});/*!
 * https://github.com/Starcounter-Jack/JSON-Patch
 * (c) 2017-2021 Joachim Wester
 * MIT license
 */var Bc=new WeakMap,Hb=function(){function e(t){this.observers=new Map,this.obj=t}return e}(),Vb=function(){function e(t,n){this.callback=t,this.observer=n}return e}();function Yb(e){return Bc.get(e)}function qb(e,t){return e.observers.get(t)}function Jb(e,t){e.observers.delete(t.callback)}function Xb(e,t){t.unobserve()}function Zb(e,t){var n=[],r,i=Yb(e);if(!i)i=new Hb(e),Bc.set(e,i);else{var s=qb(i,t);r=s&&s.observer}if(r)return r;if(r={},i.value=Ne(e),t){r.callback=t,r.next=null;var o=function(){$c(r)},a=function(){clearTimeout(r.next),r.next=setTimeout(o)};typeof window<"u"&&(window.addEventListener("mouseup",a),window.addEventListener("keyup",a),window.addEventListener("mousedown",a),window.addEventListener("keydown",a),window.addEventListener("change",a))}return r.patches=n,r.object=e,r.unobserve=function(){$c(r),clearTimeout(r.next),Jb(i,r),typeof window<"u"&&(window.removeEventListener("mouseup",a),window.removeEventListener("keyup",a),window.removeEventListener("mousedown",a),window.removeEventListener("keydown",a),window.removeEventListener("change",a))},i.observers.set(t,new Vb(t,r)),r}function $c(e,t){t===void 0&&(t=!1);var n=Bc.get(e.object);Fc(n.value,e.object,e.patches,"",t),e.patches.length&&Pc(n.value,e.patches);var r=e.patches;return r.length>0&&(e.patches=[],e.callback&&e.callback(r)),r}function Fc(e,t,n,r,i){if(t!==e){typeof t.toJSON=="function"&&(t=t.toJSON());for(var s=Mc(t),o=Mc(e),a=!1,c=o.length-1;c>=0;c--){var l=o[c],u=e[l];if(Lc(t,l)&&!(t[l]===void 0&&u!==void 0&&Array.isArray(t)===!1)){var f=t[l];typeof u=="object"&&u!=null&&typeof f=="object"&&f!=null&&Array.isArray(u)===Array.isArray(f)?Fc(u,f,n,r+"/"+Jr(l),i):u!==f&&(i&&n.push({op:"test",path:r+"/"+Jr(l),value:Ne(u)}),n.push({op:"replace",path:r+"/"+Jr(l),value:Ne(f)}))}else Array.isArray(e)===Array.isArray(t)?(i&&n.push({op:"test",path:r+"/"+Jr(l),value:Ne(u)}),n.push({op:"remove",path:r+"/"+Jr(l)}),a=!0):(i&&n.push({op:"test",path:r,value:e}),n.push({op:"replace",path:r,value:t}))}if(!(!a&&s.length==o.length))for(var c=0;c<s.length;c++){var l=s[c];!Lc(e,l)&&t[l]!==void 0&&n.push({op:"add",path:r+"/"+Jr(l),value:Ne(t[l])})}}}function jc(e,t,n){n===void 0&&(n=!1);var r=[];return Fc(e,t,r,"",n),r}var Qb=Object.freeze({__proto__:null,compare:jc,generate:$c,observe:Zb,unobserve:Xb});Object.assign({},Kb,Qb,{JsonPatchError:qh,deepClone:Ne,escapePathComponent:Jr,unescapePathComponent:Vh});function T(e){return e!=null}const tw=Object.keys;function ew(e,t){return jc(e,t).length===0}function nw(e){return Ne(e)}function rw(e){return typeof e=="boolean"}function Kt(e){return typeof e=="number"}function xt(e){return typeof e=="string"}function ne(e){return Array.isArray(e)}function iw(e){return e}var Qt=(e=>(e[e.BLACK=0]="BLACK",e[e.DKBLUE=1]="DKBLUE",e[e.DKGREEN=2]="DKGREEN",e[e.DKCYAN=3]="DKCYAN",e[e.DKRED=4]="DKRED",e[e.DKPURPLE=5]="DKPURPLE",e[e.DKYELLOW=6]="DKYELLOW",e[e.LTGRAY=7]="LTGRAY",e[e.DKGRAY=8]="DKGRAY",e[e.BLUE=9]="BLUE",e[e.GREEN=10]="GREEN",e[e.CYAN=11]="CYAN",e[e.RED=12]="RED",e[e.PURPLE=13]="PURPLE",e[e.YELLOW=14]="YELLOW",e[e.WHITE=15]="WHITE",e[e.ONBLACK=16]="ONBLACK",e[e.ONDKBLUE=17]="ONDKBLUE",e[e.ONDKGREEN=18]="ONDKGREEN",e[e.ONDKCYAN=19]="ONDKCYAN",e[e.ONDKRED=20]="ONDKRED",e[e.ONDKPURPLE=21]="ONDKPURPLE",e[e.ONDKYELLOW=22]="ONDKYELLOW",e[e.ONLTGRAY=23]="ONLTGRAY",e[e.ONDKGRAY=24]="ONDKGRAY",e[e.ONBLUE=25]="ONBLUE",e[e.ONGREEN=26]="ONGREEN",e[e.ONCYAN=27]="ONCYAN",e[e.ONRED=28]="ONRED",e[e.ONPURPLE=29]="ONPURPLE",e[e.ONYELLOW=30]="ONYELLOW",e[e.ONWHITE=31]="ONWHITE",e[e.CLEAR=32]="CLEAR",e[e.SHADOW=33]="SHADOW",e[e.BORROW=34]="BORROW",e))(Qt||{});function Oo(e,t){return new Array(e).fill(t)}function sw(e,t,n,r,i=0){const s=n*r;return{id:`tiles:${e}:${t}`,type:1,width:n,height:r,char:Oo(s,0),color:Oo(s,0),bg:Oo(s,i)}}function ow(e,t,n,r=1,i=15){return{id:`sprites:${e}:${t}:${n}`,x:0,y:0,char:r,color:i,bg:32}}function aw(e,t){return{id:`sprites:${e}:${t}`,type:2,sprites:[]}}function cw(e,t,n,r,i=0){const s=n*r;return{id:`dither:${e}:${t}`,type:3,width:n,height:r,alphas:Oo(s,i)}}function lw(e,t){return{id:`control:${e}:${t}`,type:5,focusx:0,focusy:0,focusid:e,viewscale:2}}var Qe=(e=>(e[e.START=0]="START",e[e.LEFT=1]="LEFT",e[e.RIGHT=2]="RIGHT",e[e.TOP=3]="TOP",e[e.BOTTOM=4]="BOTTOM",e[e.SCROLL=5]="SCROLL",e))(Qe||{});const uw={start:0,left:1,right:2,top:3,bottom:4,scroll:5},hw={0:1,1:20,2:20,3:1,4:1,5:40};function Xh(e,t){return`${e}:${t}`}const fw=1,dw=16,pw=256;var fe=(e=>(e[e.NONE=0]="NONE",e[e.MOVE_UP=1]="MOVE_UP",e[e.MOVE_DOWN=2]="MOVE_DOWN",e[e.MOVE_LEFT=3]="MOVE_LEFT",e[e.MOVE_RIGHT=4]="MOVE_RIGHT",e[e.OK_BUTTON=5]="OK_BUTTON",e[e.CANCEL_BUTTON=6]="CANCEL_BUTTON",e[e.MENU_BUTTON=7]="MENU_BUTTON",e))(fe||{});function re(e,t,n,r){const i=r??"";return Nt.emit(`error:${t}`,e,n,i),vw(e,n,i)}function mw(e,t,n){Nt.emit("gadgetclient:reset",e,t,n)}function gw(e,t,n){Nt.emit("gadgetclient:patch",e,t,n)}function yw(e,t){Nt.emit("register:flush",e,t)}function _w(e){Nt.emit("register:nodetrash",e)}function bw(e){Nt.emit("register:biosflash",e)}function ww(e){Nt.emit("register:biostrash",e)}function Zh(e,t,n){Nt.emit("synth:play",e,[t,n])}function de(e,...t){return Nt.emit("tape:info",e,t),!0}function Qh(e,...t){return Nt.emit("tape:debug",e,t),!0}function vw(e,...t){return Nt.emit("tape:error",e,t),!1}function Ew(e,t,n,r,i,s){Nt.emit("tape:editor:open",e,[t,n,r,i],s)}function tf(e,t){return`${e}${t}`}function ds(e){Nt.emit("vm:flush",e)}function ef(e,t){function n(r){console.error(r),re(e,"crash",r.message)}t().catch(n)}var nf={exports:{}},zc={exports:{}},rf;function kw(){return rf||(rf=1,function(e,t){(function(n,r){e.exports=r()})(Re,function(){function n(m){return!isNaN(parseFloat(m))&&isFinite(m)}function r(m){return m.charAt(0).toUpperCase()+m.substring(1)}function i(m){return function(){return this[m]}}var s=["isConstructor","isEval","isNative","isToplevel"],o=["columnNumber","lineNumber"],a=["fileName","functionName","source"],c=["args"],l=["evalOrigin"],u=s.concat(o,a,c,l);function f(m){if(m)for(var v=0;v<u.length;v++)m[u[v]]!==void 0&&this["set"+r(u[v])](m[u[v]])}f.prototype={getArgs:function(){return this.args},setArgs:function(m){if(Object.prototype.toString.call(m)!=="[object Array]")throw new TypeError("Args must be an Array");this.args=m},getEvalOrigin:function(){return this.evalOrigin},setEvalOrigin:function(m){if(m instanceof f)this.evalOrigin=m;else if(m instanceof Object)this.evalOrigin=new f(m);else throw new TypeError("Eval Origin must be an Object or StackFrame")},toString:function(){var m=this.getFileName()||"",v=this.getLineNumber()||"",b=this.getColumnNumber()||"",y=this.getFunctionName()||"";return this.getIsEval()?m?"[eval] ("+m+":"+v+":"+b+")":"[eval]:"+v+":"+b:y?y+" ("+m+":"+v+":"+b+")":m+":"+v+":"+b}},f.fromString=function(v){var b=v.indexOf("("),y=v.lastIndexOf(")"),A=v.substring(0,b),I=v.substring(b+1,y).split(","),k=v.substring(y+1);if(k.indexOf("@")===0)var E=/@(.+?)(?::(\d+))?(?::(\d+))?$/.exec(k,""),w=E[1],S=E[2],O=E[3];return new f({functionName:A,args:I||void 0,fileName:w,lineNumber:S||void 0,columnNumber:O||void 0})};for(var d=0;d<s.length;d++)f.prototype["get"+r(s[d])]=i(s[d]),f.prototype["set"+r(s[d])]=function(m){return function(v){this[m]=!!v}}(s[d]);for(var h=0;h<o.length;h++)f.prototype["get"+r(o[h])]=i(o[h]),f.prototype["set"+r(o[h])]=function(m){return function(v){if(!n(v))throw new TypeError(m+" must be a Number");this[m]=Number(v)}}(o[h]);for(var p=0;p<a.length;p++)f.prototype["get"+r(a[p])]=i(a[p]),f.prototype["set"+r(a[p])]=function(m){return function(v){this[m]=String(v)}}(a[p]);return f})}(zc)),zc.exports}(function(e,t){(function(n,r){e.exports=r(kw())})(Re,function(r){var i=/(^|@)\S+:\d+/,s=/^\s*at .*(\S+:\d+|\(native\))/m,o=/^(eval@)?(\[native code])?$/;return{parse:function(c){if(typeof c.stacktrace<"u"||typeof c["opera#sourceloc"]<"u")return this.parseOpera(c);if(c.stack&&c.stack.match(s))return this.parseV8OrIE(c);if(c.stack)return this.parseFFOrSafari(c);throw new Error("Cannot parse given Error object")},extractLocation:function(c){if(c.indexOf(":")===-1)return[c];var l=/(.+?)(?::(\d+))?(?::(\d+))?$/,u=l.exec(c.replace(/[()]/g,""));return[u[1],u[2]||void 0,u[3]||void 0]},parseV8OrIE:function(c){var l=c.stack.split(`
`).filter(function(u){return!!u.match(s)},this);return l.map(function(u){u.indexOf("(eval ")>-1&&(u=u.replace(/eval code/g,"eval").replace(/(\(eval at [^()]*)|(,.*$)/g,""));var f=u.replace(/^\s+/,"").replace(/\(eval code/g,"(").replace(/^.*?\s+/,""),d=f.match(/ (\(.+\)$)/);f=d?f.replace(d[0],""):f;var h=this.extractLocation(d?d[1]:f),p=d&&f||void 0,m=["eval","<anonymous>"].indexOf(h[0])>-1?void 0:h[0];return new r({functionName:p,fileName:m,lineNumber:h[1],columnNumber:h[2],source:u})},this)},parseFFOrSafari:function(c){var l=c.stack.split(`
`).filter(function(u){return!u.match(o)},this);return l.map(function(u){if(u.indexOf(" > eval")>-1&&(u=u.replace(/ line (\d+)(?: > eval line \d+)* > eval:\d+:\d+/g,":$1")),u.indexOf("@")===-1&&u.indexOf(":")===-1)return new r({functionName:u});var f=/((.*".+"[^@]*)?[^@]*)(?:@)/,d=u.match(f),h=d&&d[1]?d[1]:void 0,p=this.extractLocation(u.replace(f,""));return new r({functionName:h,fileName:p[0],lineNumber:p[1],columnNumber:p[2],source:u})},this)},parseOpera:function(c){return!c.stacktrace||c.message.indexOf(`
`)>-1&&c.message.split(`
`).length>c.stacktrace.split(`
`).length?this.parseOpera9(c):c.stack?this.parseOpera11(c):this.parseOpera10(c)},parseOpera9:function(c){for(var l=/Line (\d+).*script (?:in )?(\S+)/i,u=c.message.split(`
`),f=[],d=2,h=u.length;d<h;d+=2){var p=l.exec(u[d]);p&&f.push(new r({fileName:p[2],lineNumber:p[1],source:u[d]}))}return f},parseOpera10:function(c){for(var l=/Line (\d+).*script (?:in )?(\S+)(?:: In function (\S+))?$/i,u=c.stacktrace.split(`
`),f=[],d=0,h=u.length;d<h;d+=2){var p=l.exec(u[d]);p&&f.push(new r({functionName:p[3]||void 0,fileName:p[2],lineNumber:p[1],source:u[d]}))}return f},parseOpera11:function(c){var l=c.stack.split(`
`).filter(function(u){return!!u.match(i)&&!u.match(/^Error created at/)},this);return l.map(function(u){var f=u.split("@"),d=this.extractLocation(f.pop()),h=f.shift()||"",p=h.replace(/<anonymous function(: (\w+))?>/,"$2").replace(/\([^)]*\)/g,"")||void 0,m;h.match(/\(([^)]*)\)/)&&(m=h.replace(/^[^(]+\(([^)]*)\)$/,"$1"));var v=m===void 0||m==="[arguments not available]"?void 0:m.split(",");return new r({functionName:p,args:v,fileName:d[0],lineNumber:d[1],columnNumber:d[2],source:u})},this)}}})})(nf);var Aw=nf.exports,Sw=hs(Aw),sf={exports:{}};(function(e,t){(function(n,r){e.exports=r()})(Re,function(){return n.importState=function(i){var s=new n;return s.importState(i),s},n;function n(){return function(i){var s=0,o=0,a=0,c=1;i.length==0&&(i=[+new Date]);var l=r();s=l(" "),o=l(" "),a=l(" ");for(var u=0;u<i.length;u++)s-=l(i[u]),s<0&&(s+=1),o-=l(i[u]),o<0&&(o+=1),a-=l(i[u]),a<0&&(a+=1);l=null;var f=function(){var d=2091639*s+c*23283064365386963e-26;return s=o,o=a,a=d-(c=d|0)};return f.next=f,f.uint32=function(){return f()*4294967296},f.fract53=function(){return f()+(f()*2097152|0)*11102230246251565e-32},f.version="Alea 0.9",f.args=i,f.exportState=function(){return[s,o,a,c]},f.importState=function(d){s=+d[0]||0,o=+d[1]||0,a=+d[2]||0,c=+d[3]||0},f}(Array.prototype.slice.call(arguments))}function r(){var i=4022871197,s=function(o){o=o.toString();for(var a=0;a<o.length;a++){i+=o.charCodeAt(a);var c=.02519603282416938*i;i=c>>>0,c-=i,c*=i,i=c>>>0,c-=i,i+=c*4294967296}return(i>>>0)*23283064365386963e-26};return s.version="Mash 0.9",s}})})(sf);var Tw=sf.exports,Rw=hs(Tw);function Zr(e,t,n){return Math.max(t,Math.min(n,e))}const Ow=Rw("089fad0j9awfem09wavefc09uwaef");function Iw(){return Ow()}function Io(e,t){const n=Math.min(e,t),i=Math.max(e,t)-n+1;return n+Math.floor(Iw()*i)}function Gc(e,t,n){typeof e!="number"&&(e=0,t=0,n=1),typeof t!="number"&&(t=e,e=0,n=1),typeof n!="number"&&(n=1);const r=[],i=Math.min(e,t),s=Math.max(e,t);for(let o=i;o<=s;o+=n)r.push(o);return r}function xw(e){return e[Io(0,e.length-1)]}function or(...e){return xw(e.flat())}function Cw(e){return[...new Set(e)].filter(T)}function Nw(...e){const t=e.flat().filter(T);return t.reduce((n,r)=>n+r,0)/t.length}var Oe=(e=>(e[e.ISSOLID=0]="ISSOLID",e[e.ISWALK=1]="ISWALK",e[e.ISSWIM=2]="ISSWIM",e[e.ISBULLET=3]="ISBULLET",e))(Oe||{}),xo=(e=>(e[e.ISTERRAIN=0]="ISTERRAIN",e[e.ISOBJECT=1]="ISOBJECT",e))(xo||{});const jt=60,yn=25,of=jt*yn;var at=(e=>(e[e.ERROR=0]="ERROR",e[e.LOADER=1]="LOADER",e[e.BOARD=2]="BOARD",e[e.OBJECT=3]="OBJECT",e[e.TERRAIN=4]="TERRAIN",e[e.CHARSET=5]="CHARSET",e[e.PALETTE=6]="PALETTE",e[e.EIGHT_TRACK=7]="EIGHT_TRACK",e))(at||{}),Yt=(e=>(e.LOADER="loader",e.BOARD="board",e.OBJECT="object",e.TERRAIN="terrain",e.CHARSET="charset",e.PALETTE="palette",e.EIGHT_TRACK="8track",e))(Yt||{});function af(e,t){const n=e??Oe.ISWALK,r=t??Oe.ISWALK;switch(n){case Oe.ISWALK:return r!==Oe.ISWALK;case Oe.ISSWIM:return r!==Oe.ISSWIM;case Oe.ISSOLID:return!0;case Oe.ISBULLET:return r!==Oe.ISWALK&&r!==Oe.ISSWIM}}function Wc(e,t){var r,i;return[...((i=(r=e==null?void 0:e.named)==null?void 0:r[t])==null?void 0:i.values())??[]].map(s=>typeof s=="string"?e==null?void 0:e.objects[s]:e==null?void 0:e.terrain[s]).filter(T)}function Lw(e,t){const n=Zc(t),r=Tf(t),i=Rf(t);return e.filter(s=>!(T(n)&&hf(s)!==n||T(r)&&zw(s)!==r||T(i)&&Gw(s)!==i)).filter(T)}function Kc(e,t){return T(e)?t.map(n=>{var r;if(typeof n=="string"){const i=e.objects[n];if(T(i))return i;const s=Wc(e,n.toLowerCase());if(s.length)return s}else if(Ln(n)&&n.x>=0&&n.x<jt&&n.y>=0&&n.y<yn){const i=n.x+n.y*jt,s=(r=e.lookup)==null?void 0:r[i];return T(s)?e.objects[s]:e.terrain[i]}}).flat().filter(T):[]}function Mw(e,t){let n=0,r;for(let i=0;i<t.length;++i){const s=t[i];if(s){const o=e.x-(s.x??0),a=e.y-(s.y??0),c=Math.sqrt(o*o+a*a);(r===void 0||c<n)&&(n=c,r=s)}}return r}function ie(e){if(T(e)){if(Kt(e))return{type:"wordnumber",value:e};if(xt(e))return{type:"wordstring",value:e};if(ne(e))return{type:"wordarray",value:e.map(ie).filter(T)}}}function pe(e){if(T(e))switch(e.type){case"wordnumber":case"wordstring":return e.value;case"wordarray":return e.value.map(pe).filter(T)}}function Uw(e,t){if(T(t)){if(ne(t))return{name:e,type:"wordarray",value:t.map(ie).filter(T)};if(xt(t))return{name:e,type:"wordstring",value:t};if(Kt(t))return{name:e,type:"wordnumber",value:t}}}function cf(){return{id:sr()}}function Co(e){if(T(e))return{kind:e.kind,id:e.id,x:e.x,y:e.y,lx:e.lx,ly:e.ly,code:e.code,name:e.name,char:e.char,color:e.color,bg:e.bg,pushable:!!e.pushable,collision:e.collision,destructible:!!e.destructible,p1:ie(e.p1),p2:ie(e.p2),p3:ie(e.p3),cycle:ie(e.cycle),stepx:ie(e.stepx),stepy:ie(e.stepy),sender:ie(e.sender),data:ie(e.data)}}function No(e){if(T(e))return{kind:e.kind,id:e.id,x:e.x,y:e.y,lx:e.lx,ly:e.ly,code:e.code,name:e.name,char:e.char,color:e.color,bg:e.bg,pushable:e.pushable?1:void 0,collision:e.collision,destructible:e.destructible?1:void 0,p1:pe(e.p1),p2:pe(e.p2),p3:pe(e.p3),cycle:pe(e.cycle),stepx:pe(e.stepx),stepy:pe(e.stepy),sender:pe(e.sender),data:pe(e.data)}}function lf(e,t,n){return T(e)?e[t]??n:void 0}function uf(e,t,n){T(e)&&(e[t]=n)}function Hc(e,t){tw(t).forEach(n=>uf(e,n,t[n]))}function Dw(){return new Array(jt*yn).map(()=>{})}function Pw(e=iw){const t={terrain:Dw(),objects:{},codepage:""};return e(t)}function Bw(e){if(T(e))return{terrain:e.terrain.map(Co),objects:Object.keys(e.objects).map(t=>Co(e.objects[t])).filter(T),isdark:ie(e.isdark),over:ie(e.over),under:ie(e.under),exitnorth:ie(e.exitnorth),exitsouth:ie(e.exitsouth),exitwest:ie(e.exitwest),exiteast:ie(e.exiteast),timelimit:ie(e.timelimit),restartonzap:ie(e.restartonzap),maxplayershots:ie(e.maxplayershots)}}function $w(e){if(T(e))return{terrain:e.terrain.map(No),objects:Object.fromEntries(e.objects.map(No).filter(t=>T(t)).map(t=>[(t==null?void 0:t.id)??"",t])),isdark:pe(e.isdark),over:pe(e.over),under:pe(e.under),exitnorth:pe(e.exitnorth),exitsouth:pe(e.exitsouth),exitwest:pe(e.exitwest),exiteast:pe(e.exiteast),timelimit:pe(e.timelimit),restartonzap:pe(e.restartonzap),maxplayershots:pe(e.maxplayershots),codepage:""}}function Fw(e,t){return!T(e)||t.x<0||t.x>=jt||t.y<0||t.y>=yn?-1:t.x+t.y*jt}function jw(e,t){const n=Fw(e,t);if(n<0||!T(e==null?void 0:e.lookup))return;const r=Yc(e,e.lookup[n]??"");return T(r)?r:e.terrain[n]}function hf(e){var t;return((e==null?void 0:e.name)??((t=e==null?void 0:e.kinddata)==null?void 0:t.name)??"object").toLowerCase()}function zw(e){var t;return(e==null?void 0:e.color)??((t=e==null?void 0:e.kinddata)==null?void 0:t.color)??Qt.BLACK}function Gw(e){var t;return(e==null?void 0:e.bg)??((t=e==null?void 0:e.kinddata)==null?void 0:t.bg)??Qt.BLACK}function Lo(e,t){if(!T(e)||!en(t))return;const{color:n,bg:r}=Jw(t);T(n)&&(e.color=n),T(r)&&(e.bg=r)}function Ww(e,t){if(!T(e)||!T(t)||!T(t.x)||!T(t.y)||t.x<0||t.x>=jt||t.y<0||t.y>=yn)return;const n={...t},r=t.x+t.y*jt;return e.terrain[r]=n,t}function Kw(e,t){if(!T(e)||!T(t))return;const n={...t,id:t.id??sr()};return e.objects[n.id]=n,n}function ff(e,t,n){return Ww(e,{...t,kind:n})}function Vc(e,t,n,r){return Kw(e,{...t,id:r??void 0,kind:n})}function Yc(e,t){if(e)return e.objects[t]}function Oi(e,t,n){if(!T(e)||!T(t))return{x:0,y:0};const r={x:t.x??0,y:t.y??0},i={x:t.lx??r.x,y:t.ly??r.y},s={...r},o=Tr(i,r),a=jt-1,c=yn-1;for(let l=0;l<n.length;++l){const u=Xw(n[l]);switch(u){case Ct.IDLE:break;case Ct.NORTH:case Ct.SOUTH:case Ct.WEST:case Ct.EAST:tn(r,u);break;case Ct.BY:{const[f,d]=n.slice(l+1);Kt(f)&&Kt(d)&&(r.x=Zr(r.x+f,0,a),r.y=Zr(r.y+d,0,c)),l+=2;break}case Ct.AT:{const[f,d]=n.slice(l+1);Kt(f)&&Kt(d)&&(r.x=Zr(f,0,a),r.y=Zr(d,0,c)),l+=2;break}case Ct.FLOW:tn(r,o);break;case Ct.SEEK:{const f=qc(e,t);Ln(f)&&tn(r,Tr(s,f));break}case Ct.RNDNS:tn(r,or(Ct.NORTH,Ct.SOUTH));break;case Ct.RNDNE:tn(r,or(Ct.NORTH,Ct.EAST));break;case Ct.RND:tn(r,or(Ct.NORTH,Ct.SOUTH,Ct.WEST,Ct.EAST));break;case Ct.CW:{const f=Oi(e,t,n.slice(l+1));tn(r,Tr(s,f));break}case Ct.CCW:{const f=Oi(e,t,n.slice(l+1));tn(r,Tr(s,f));break}case Ct.OPP:{const f=Oi(e,t,n.slice(l+1));tn(r,Tr(s,f));break}case Ct.RNDP:{const f=Oi(e,t,n.slice(l+1));switch(Tr(s,f)){case Ct.NORTH:case Ct.SOUTH:r.x+=or(-1,1);break;case Ct.WEST:case Ct.EAST:r.y+=or(-1,1);break}break}}}return r}function df(e,t){return T(e==null?void 0:e.objects[t])?(delete e.objects[t],!0):!1}function qc(e,t){if(!T(e)||!T(t))return;const r=wt(t.id??"").player??"",i=e.objects[r];if(T(i))return i;if(Ln(t))return Mw(t,Wc(e,"player"))}function Hw(e,t,n){return{board:e.board,object:e.object,words:t,get:n}}var Ct=(e=>(e[e.IDLE=0]="IDLE",e[e.NORTH=1]="NORTH",e[e.SOUTH=2]="SOUTH",e[e.WEST=3]="WEST",e[e.EAST=4]="EAST",e[e.BY=5]="BY",e[e.AT=6]="AT",e[e.FLOW=7]="FLOW",e[e.SEEK=8]="SEEK",e[e.RNDNS=9]="RNDNS",e[e.RNDNE=10]="RNDNE",e[e.RND=11]="RND",e[e.CW=12]="CW",e[e.CCW=13]="CCW",e[e.OPP=14]="OPP",e[e.RNDP=15]="RNDP",e))(Ct||{});function Ln(e){return T(e)&&T(e.x)&&T(e.y)}function tn(e,t){switch(t){case 1:--e.y;break;case 2:++e.y;break;case 3:--e.x;break;case 4:++e.x;break}return e}function Tr(e,t){const n=t.x-e.x,r=t.y-e.y;if(n<0)return 3;if(n>0)return 4;if(r<0)return 1;if(r>0)return 2}const pf={isterrain:"ISTERRAIN",isobject:"ISOBJECT"};function Rr(e){return ne(e)&&mf(e[0])}function mf(e){return T(xo[e])&&xt(e)}function gf(e){if(xt(e))return pf[e.toLowerCase()]}function yf(e){if(Rr(e))return e;if(mf(e))return[e];const t=gf(e);if(T(t))return[t]}function Mo(e,t){const n=e.words[t],r=yf(n);if(Rr(r))return[r,t+1];const[i,s]=Le(e,t),o=yf(i);return Rr(o)?[o,s]:[void 0,t]}const _f={issolid:"ISSOLID",iswalk:"ISWALK",isswim:"ISSWIM",isbullet:"ISBULLET",iswalkable:"ISWALKABLE",isswimmable:"ISSWIMABLE"};function Qr(e){return ne(e)&&Jc(e[0])}function Jc(e){return T(Oe[e])&&xt(e)}function Vw(e){if(xt(e))return _f[e.toLowerCase()]}function bf(e,t){const n=e.words[t];if(Qr(n))return[n,t+1];if(Jc(n))return[[n],t+1];const[r,i]=Le(e,t);return Qr(r)?[r,i]:Jc(r)?[[r],i]:[void 0,t]}const Xc={black:"BLACK",dkblue:"DKBLUE",dkgreen:"DKGREEN",dkcyan:"DKCYAN",dkred:"DKRED",dkpurple:"DKPURPLE",dkyellow:"DKYELLOW",ltgray:"LTGRAY",dkgray:"DKGRAY",blue:"BLUE",green:"GREEN",cyan:"CYAN",red:"RED",purple:"PURPLE",yellow:"YELLOW",white:"WHITE",clear:"CLEAR",shadow:"SHADOW",borrow:"BORROW",brown:"DKYELLOW",dkwhite:"LTGRAY",ltgrey:"LTGRAY",gray:"LTGRAY",grey:"LTGRAY",dkgrey:"DKGRAY",ltblack:"DKGRAY",onblack:"ONBLACK",ondkblue:"ONDKBLUE",ondkgreen:"ONDKGREEN",ondkcyan:"ONDKCYAN",ondkred:"ONDKRED",ondkpurple:"ONDKPURPLE",ondkyellow:"ONDKYELLOW",onltgray:"ONLTGRAY",ondkgray:"ONDKGRAY",onblue:"ONBLUE",ongreen:"ONGREEN",oncyan:"ONCYAN",onred:"ONRED",onpurple:"ONPURPLE",onyellow:"ONYELLOW",onwhite:"ONWHITE",onbrown:"ONDKYELLOW",ondkwhite:"ONLTGRAY",onltgrey:"ONLTGRAY",ongray:"ONLTGRAY",ongrey:"ONLTGRAY",ondkgrey:"ONDKGRAY",onltblack:"ONDKGRAY"};function en(e){return ne(e)&&vf(e[0])}function wf(e){return en(e)&&e[0].startsWith("ON")}function vf(e){return T(Qt[e])&&xt(e)}function Ef(e){if(xt(e))return Xc[e.toLowerCase()]}function Yw(e){return e.map(t=>Qt[t]).find(t=>T(t)&&t<Qt.ONBLACK)}function qw(e){return e.map(t=>Qt[t]).find(t=>T(t)&&t>=Qt.ONBLACK)}function kf(e){if(en(e))return e;if(vf(e))return[e];const t=Ef(e);if(T(t))return[t]}function Af(e,t){const n=e.words[t],r=kf(n);if(en(r))return[r,t+1];const[i,s]=Le(e,t),o=kf(i);return en(o)?[o,s]:[void 0,t]}function Uo(e,t){const n=[];let r=t;const[i,s]=Af(e,t);if(en(i)&&(n.push(...i),r=s),en(n)&&!wf(n)){const[o,a]=Af(e,s);wf(o)&&(r=a)}return n.length?[n,r]:[void 0,t]}function Jw(e){const t={};return e.every(n=>{const r=Qt[n];T(r)&&(r<Qt.ONBLACK?t.color=r:t.bg=r-Qt.ONBLACK)}),t}function Ii(e){return ne(e)&&typeof e[0]=="string"}function Sf(e,t){const n=e.words[t];if(Ii(n))return[n,t+1];const[r,i]=Uo(e,t),[s,o]=Le(e,i,!1);return xt(s)?[[s,r],o]:[void 0,t]}function Zc(e){if(!Ii(e))return;const[t]=e;return t}function Tf(e){if(!Ii(e))return;const[,t]=e,n=T(t)?Yw(t):void 0;return T(n)?n:void 0}function Rf(e){if(!Ii(e))return;const[,t]=e,n=T(t)?qw(t):void 0;return T(n)?n:void 0}const Of={idle:"IDLE",up:"NORTH",down:"SOUTH",left:"WEST",right:"EAST",by:"BY",at:"AT",flow:"FLOW",seek:"SEEK",rndns:"RNDNS",rndne:"RNDNE",rnd:"RND",cw:"CW",ccw:"CCW",opp:"OPP",rndp:"RNDP",i:"IDLE",u:"NORTH",north:"NORTH",n:"NORTH",d:"SOUTH",south:"SOUTH",s:"SOUTH",l:"WEST",west:"WEST",w:"WEST",r:"EAST",east:"EAST",e:"EAST",edit:"EDIT"};function ar(e){return ne(e)&&If(e[0])}function If(e){return T(Ct[e])&&xt(e)}function Xw(e){const t=Ct[e];return T(t)?t:0}function xf(e){if(xt(e))return Of[e.toLowerCase()]}function Cf(e){if(ar(e))return e;if(If(e))return[e];const t=xf(e);if(T(t))return[t]}function Nf(e,t){const n=e.words[t],r=Cf(n);if(ar(r))return[r,t+1];const[i,s]=Le(e,t),o=Cf(i);return ar(o)?[o,s]:[void 0,t]}function Qc(e,t){const n=[];let[r,i]=Nf(e,t);for(;ar(r);){if(n.push(...r),r[0]==="AT"||r[0]==="BY"){const[a,c,l]=Z(e,i,[5,5]);n.push(a,c),i=l}const[s,o]=Nf(e,i);r=s,i=o}return n.length?[n,i]:[void 0,t]}function Le(e,t,n=!0){const r=e.words[t];if(gf(r)){const[i,s]=Mo(e,t);if(T(i))return[i,s]}if(Vw(r)){const[i,s]=bf(e,t);if(T(i))return[i,s]}if(Ef(r)){const[i,s]=Uo(e,t);if(T(i))return[i,s]}if(xt(r)&&r.toLowerCase()==="rnd"){const[i,s]=Le(e,t+1),[o,a]=Le(e,s);return Kt(i)&&Kt(o)?[Io(i,o),a]:Kt(i)?[Io(0,i),s]:[Io(0,1),t+1]}if(xf(r)){const[i,s]=Qc(e,t);if(T(i))return[i,s]}if(!T(r))return[void 0,t];if(Ln(r)||Kt(r)||ne(r))return[r,t+1];if(xt(r)){const i=r.toLowerCase();if(n){const s=e.get(r);if(T(s))return[s,t+1]}switch(i){case"aligned":case"alligned":break;case"contact":break;case"blocked":break;case"any":break;case"abs":{const[s,o]=Z(e,t+1,[5]);return[Math.abs(s),o]}case"ceil":{const[s,o]=Z(e,t+1,[5]);return[Math.ceil(s),o]}case"floor":{const[s,o]=Z(e,t+1,[5]);return[Math.floor(s),o]}case"round":{const[s,o]=Z(e,t+1,[5]);return[Math.round(s),o]}case"min":{const s=[];for(let o=t+1;o<e.words.length;){const[a,c]=Le(e,o);if(ne(a)&&!Ln(a)&&!ar(a)&&!Rr(a)&&!Qr(a)&&!en(a))return[or(a),c];o=c,s.push(a)}return[Math.min(...s),e.words.length]}case"max":{const s=[];for(let o=t+1;o<e.words.length;){const[a,c]=Le(e,o);if(ne(a)&&!Ln(a)&&!ar(a)&&!Rr(a)&&!Qr(a)&&!en(a))return[or(a),c];o=c,s.push(a)}return[Math.max(...s),e.words.length]}case"clamp":{const[s,o,a,c]=Z(e,t+1,[5,5,5]);return[Zr(s,o,a),c]}case"pick":{const s=[];for(let o=t+1;o<e.words.length;){const[a,c]=Le(e,o);if(ne(a)&&!Ln(a)&&!ar(a)&&!Rr(a)&&!Qr(a)&&!en(a))return[or(a),c];o=c,s.push(a)}return[or(s),e.words.length]}case"range":{const[s,o,a,c]=Z(e,t+1,[5,13,13]);return[Gc(s,o,a),c]}}}return[r,t+1]}var Y=(e=>(e[e.CATEGORY=0]="CATEGORY",e[e.COLLISION=1]="COLLISION",e[e.COLOR=2]="COLOR",e[e.KIND=3]="KIND",e[e.DIR=4]="DIR",e[e.NUMBER=5]="NUMBER",e[e.STRING=6]="STRING",e[e.NUMBER_OR_STRING=7]="NUMBER_OR_STRING",e[e.MAYBE_CATEGORY=8]="MAYBE_CATEGORY",e[e.MAYBE_COLLISION=9]="MAYBE_COLLISION",e[e.MAYBE_COLOR=10]="MAYBE_COLOR",e[e.MAYBE_KIND=11]="MAYBE_KIND",e[e.MAYBE_DIR=12]="MAYBE_DIR",e[e.MAYBE_NUMBER=13]="MAYBE_NUMBER",e[e.MAYBE_STRING=14]="MAYBE_STRING",e[e.MAYBE_NUMBER_OR_STRING=15]="MAYBE_NUMBER_OR_STRING",e[e.ANY=16]="ANY",e))(Y||{});function Ie(e,t){throw new Error(`Invalid arg, expected: ${e} but got ${JSON.stringify(t)}`)}function Z(e,t,n){const r=[];let i=t;for(let s=0;s<n.length;++s)switch(n[s]){case 0:{const[o,a]=Mo(e,i);Rr(o)||Ie("terrain or object",o),i=a,r.push(o);break}case 1:{const[o,a]=bf(e,i);Qr(o)||Ie("solid, walk, swim, bullet, walkable or swimmable",o),i=a,r.push(o);break}case 2:{const[o,a]=Uo(e,i);en(o)||Ie("color",o),i=a,r.push(o);break}case 3:{const[o,a]=Sf(e,i);Ii(o)?(i=a,r.push(o)):Ie("kind",o);break}case 4:{const[o,a]=Qc(e,i);if(ar(o)){const c=e.board?Oi(e.board,e.object,o):{x:0,y:0};i=a,r.push(c)}else Ie("direction",o);break}case 5:{const[o,a]=Le(e,i);Kt(o)||Ie("number",o),i=a,r.push(o);break}case 6:{const o=e.words[i];xt(o)||Ie("string",o),++i,r.push(o);break}case 7:{const[o,a]=Le(e,i,!1);!Kt(o)&&!xt(o)&&Ie("number or string",o),i=a,r.push(o);break}case 8:{const[o,a]=Mo(e,i);o!==void 0&&!Rr(o)&&Ie("optional terrain or object",o),i=a,r.push(o);break}case 9:{const[o,a]=Mo(e,i);o!==void 0&&!Qr(o)&&Ie("optional solid, walk, swim, bullet, walkable or swimmable",o),i=a,r.push(o);break}case 10:{const[o,a]=Uo(e,i);o!==void 0&&!en(o)&&Ie("optional color",o),i=a,r.push(o);break}case 11:{const[o,a]=Sf(e,i);o!==void 0&&!Ii(o)&&Ie("optional kind",o),i=a,r.push(o);break}case 12:{const[o,a]=Qc(e,i);if(ar(o)){const c=e.board?Oi(e.board,e.object,o):{x:0,y:0};i=a,r.push(c)}else o===void 0?(i=a,r.push(void 0)):Ie("optional direction",o);break}case 13:{const[o,a]=Le(e,i);o!==void 0&&!Kt(o)&&Ie("optional number",o),i=a,r.push(o);break}case 14:{const o=e.words[i];o!==void 0&&!xt(o)&&Ie("optional string",o),++i,r.push(o);break}case 15:{const[o,a]=Le(e,i,!1);o!==void 0&&!Kt(o)&&!xt(o)&&Ie("optional number or string",o),i=a,r.push(o);break}case 16:{const[o,a]=Le(e,i);i=a,r.push(o);break}}return[...r,i]}var Lf={},Mf={},Uf={};const Df="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".split("");Uf.encode=function(e){if(0<=e&&e<Df.length)return Df[e];throw new TypeError("Must be between 0 and 63: "+e)};const Zw=Uf,Pf=5,Bf=1<<Pf,Qw=Bf-1,tv=Bf;function ev(e){return e<0?(-e<<1)+1:(e<<1)+0}Mf.encode=function(t){let n="",r,i=ev(t);do r=i&Qw,i>>>=Pf,i>0&&(r|=tv),n+=Zw.encode(r);while(i>0);return n};var ps={};(function(e){function t(E,w,S){if(w in E)return E[w];if(arguments.length===3)return S;throw new Error('"'+w+'" is a required argument.')}e.getArg=t;const n=/^(?:([\w+\-.]+):)?\/\/(?:(\w+:\w+)@)?([\w.-]*)(?::(\d+))?(.*)$/,r=/^data:.+\,.+$/;function i(E){const w=E.match(n);return w?{scheme:w[1],auth:w[2],host:w[3],port:w[4],path:w[5]}:null}e.urlParse=i;function s(E){let w="";return E.scheme&&(w+=E.scheme+":"),w+="//",E.auth&&(w+=E.auth+"@"),E.host&&(w+=E.host),E.port&&(w+=":"+E.port),E.path&&(w+=E.path),w}e.urlGenerate=s;const o=32;function a(E){const w=[];return function(S){for(let B=0;B<w.length;B++)if(w[B].input===S){const V=w[0];return w[0]=w[B],w[B]=V,w[0].result}const O=E(S);return w.unshift({input:S,result:O}),w.length>o&&w.pop(),O}}const c=a(function(w){let S=w;const O=i(w);if(O){if(!O.path)return w;S=O.path}const B=e.isAbsolute(S),V=[];let C=0,D=0;for(;;)if(C=D,D=S.indexOf("/",C),D===-1){V.push(S.slice(C));break}else for(V.push(S.slice(C,D));D<S.length&&S[D]==="/";)D++;let _=0;for(D=V.length-1;D>=0;D--){const P=V[D];P==="."?V.splice(D,1):P===".."?_++:_>0&&(P===""?(V.splice(D+1,_),_=0):(V.splice(D,2),_--))}return S=V.join("/"),S===""&&(S=B?"/":"."),O?(O.path=S,s(O)):S});e.normalize=c;function l(E,w){E===""&&(E="."),w===""&&(w=".");const S=i(w),O=i(E);if(O&&(E=O.path||"/"),S&&!S.scheme)return O&&(S.scheme=O.scheme),s(S);if(S||w.match(r))return w;if(O&&!O.host&&!O.path)return O.host=w,s(O);const B=w.charAt(0)==="/"?w:c(E.replace(/\/+$/,"")+"/"+w);return O?(O.path=B,s(O)):B}e.join=l,e.isAbsolute=function(E){return E.charAt(0)==="/"||n.test(E)};function u(E,w){E===""&&(E="."),E=E.replace(/\/$/,"");let S=0;for(;w.indexOf(E+"/")!==0;){const O=E.lastIndexOf("/");if(O<0||(E=E.slice(0,O),E.match(/^([^\/]+:\/)?\/*$/)))return w;++S}return Array(S+1).join("../")+w.substr(E.length+1)}e.relative=u;const f=function(){return!("__proto__"in Object.create(null))}();function d(E){return E}function h(E){return m(E)?"$"+E:E}e.toSetString=f?d:h;function p(E){return m(E)?E.slice(1):E}e.fromSetString=f?d:p;function m(E){if(!E)return!1;const w=E.length;if(w<9||E.charCodeAt(w-1)!==95||E.charCodeAt(w-2)!==95||E.charCodeAt(w-3)!==111||E.charCodeAt(w-4)!==116||E.charCodeAt(w-5)!==111||E.charCodeAt(w-6)!==114||E.charCodeAt(w-7)!==112||E.charCodeAt(w-8)!==95||E.charCodeAt(w-9)!==95)return!1;for(let S=w-10;S>=0;S--)if(E.charCodeAt(S)!==36)return!1;return!0}function v(E,w,S){let O=y(E.source,w.source);return O!==0||(O=E.originalLine-w.originalLine,O!==0)||(O=E.originalColumn-w.originalColumn,O!==0||S)||(O=E.generatedColumn-w.generatedColumn,O!==0)||(O=E.generatedLine-w.generatedLine,O!==0)?O:y(E.name,w.name)}e.compareByOriginalPositions=v;function b(E,w,S){let O=E.generatedLine-w.generatedLine;return O!==0||(O=E.generatedColumn-w.generatedColumn,O!==0||S)||(O=y(E.source,w.source),O!==0)||(O=E.originalLine-w.originalLine,O!==0)||(O=E.originalColumn-w.originalColumn,O!==0)?O:y(E.name,w.name)}e.compareByGeneratedPositionsDeflated=b;function y(E,w){return E===w?0:E===null?1:w===null?-1:E>w?1:-1}function A(E,w){let S=E.generatedLine-w.generatedLine;return S!==0||(S=E.generatedColumn-w.generatedColumn,S!==0)||(S=y(E.source,w.source),S!==0)||(S=E.originalLine-w.originalLine,S!==0)||(S=E.originalColumn-w.originalColumn,S!==0)?S:y(E.name,w.name)}e.compareByGeneratedPositionsInflated=A;function I(E){return JSON.parse(E.replace(/^\)]}'[^\n]*\n/,""))}e.parseSourceMapInput=I;function k(E,w,S){if(w=w||"",E&&(E[E.length-1]!=="/"&&w[0]!=="/"&&(E+="/"),w=E+w),S){const O=i(S);if(!O)throw new Error("sourceMapURL could not be parsed");if(O.path){const B=O.path.lastIndexOf("/");B>=0&&(O.path=O.path.substring(0,B+1))}w=l(s(O),w)}return c(w)}e.computeSourceURL=k})(ps);var tl={};let nv=class wb{constructor(){this._array=[],this._set=new Map}static fromArray(t,n){const r=new wb;for(let i=0,s=t.length;i<s;i++)r.add(t[i],n);return r}size(){return this._set.size}add(t,n){const r=this.has(t),i=this._array.length;(!r||n)&&this._array.push(t),r||this._set.set(t,i)}has(t){return this._set.has(t)}indexOf(t){const n=this._set.get(t);if(n>=0)return n;throw new Error('"'+t+'" is not in the set.')}at(t){if(t>=0&&t<this._array.length)return this._array[t];throw new Error("No element indexed by "+t)}toArray(){return this._array.slice()}};tl.ArraySet=nv;var $f={};const Ff=ps;function rv(e,t){const n=e.generatedLine,r=t.generatedLine,i=e.generatedColumn,s=t.generatedColumn;return r>n||r==n&&s>=i||Ff.compareByGeneratedPositionsInflated(e,t)<=0}let iv=class{constructor(){this._array=[],this._sorted=!0,this._last={generatedLine:-1,generatedColumn:0}}unsortedForEach(t,n){this._array.forEach(t,n)}add(t){rv(this._last,t)?(this._last=t,this._array.push(t)):(this._sorted=!1,this._array.push(t))}toArray(){return this._sorted||(this._array.sort(Ff.compareByGeneratedPositionsInflated),this._sorted=!0),this._array}};$f.MappingList=iv;const ms=Mf,se=ps,Do=tl.ArraySet,sv=$f.MappingList;let jf=class vb{constructor(t){t||(t={}),this._file=se.getArg(t,"file",null),this._sourceRoot=se.getArg(t,"sourceRoot",null),this._skipValidation=se.getArg(t,"skipValidation",!1),this._sources=new Do,this._names=new Do,this._mappings=new sv,this._sourcesContents=null}static fromSourceMap(t){const n=t.sourceRoot,r=new vb({file:t.file,sourceRoot:n});return t.eachMapping(function(i){const s={generated:{line:i.generatedLine,column:i.generatedColumn}};i.source!=null&&(s.source=i.source,n!=null&&(s.source=se.relative(n,s.source)),s.original={line:i.originalLine,column:i.originalColumn},i.name!=null&&(s.name=i.name)),r.addMapping(s)}),t.sources.forEach(function(i){let s=i;n!==null&&(s=se.relative(n,i)),r._sources.has(s)||r._sources.add(s);const o=t.sourceContentFor(i);o!=null&&r.setSourceContent(i,o)}),r}addMapping(t){const n=se.getArg(t,"generated"),r=se.getArg(t,"original",null);let i=se.getArg(t,"source",null),s=se.getArg(t,"name",null);this._skipValidation||this._validateMapping(n,r,i,s),i!=null&&(i=String(i),this._sources.has(i)||this._sources.add(i)),s!=null&&(s=String(s),this._names.has(s)||this._names.add(s)),this._mappings.add({generatedLine:n.line,generatedColumn:n.column,originalLine:r!=null&&r.line,originalColumn:r!=null&&r.column,source:i,name:s})}setSourceContent(t,n){let r=t;this._sourceRoot!=null&&(r=se.relative(this._sourceRoot,r)),n!=null?(this._sourcesContents||(this._sourcesContents=Object.create(null)),this._sourcesContents[se.toSetString(r)]=n):this._sourcesContents&&(delete this._sourcesContents[se.toSetString(r)],Object.keys(this._sourcesContents).length===0&&(this._sourcesContents=null))}applySourceMap(t,n,r){let i=n;if(n==null){if(t.file==null)throw new Error(`SourceMapGenerator.prototype.applySourceMap requires either an explicit source file, or the source map's "file" property. Both were omitted.`);i=t.file}const s=this._sourceRoot;s!=null&&(i=se.relative(s,i));const o=this._mappings.toArray().length>0?new Do:this._sources,a=new Do;this._mappings.unsortedForEach(function(c){if(c.source===i&&c.originalLine!=null){const f=t.originalPositionFor({line:c.originalLine,column:c.originalColumn});f.source!=null&&(c.source=f.source,r!=null&&(c.source=se.join(r,c.source)),s!=null&&(c.source=se.relative(s,c.source)),c.originalLine=f.line,c.originalColumn=f.column,f.name!=null&&(c.name=f.name))}const l=c.source;l!=null&&!o.has(l)&&o.add(l);const u=c.name;u!=null&&!a.has(u)&&a.add(u)},this),this._sources=o,this._names=a,t.sources.forEach(function(c){const l=t.sourceContentFor(c);l!=null&&(r!=null&&(c=se.join(r,c)),s!=null&&(c=se.relative(s,c)),this.setSourceContent(c,l))},this)}_validateMapping(t,n,r,i){if(n&&typeof n.line!="number"&&typeof n.column!="number")throw new Error("original.line and original.column are not numbers -- you probably meant to omit the original mapping entirely and only map the generated position. If so, pass null for the original mapping instead of an object with empty or null values.");if(!(t&&"line"in t&&"column"in t&&t.line>0&&t.column>=0&&!n&&!r&&!i)){if(!(t&&"line"in t&&"column"in t&&n&&"line"in n&&"column"in n&&t.line>0&&t.column>=0&&n.line>0&&n.column>=0&&r))throw new Error("Invalid mapping: "+JSON.stringify({generated:t,source:r,original:n,name:i}))}}_serializeMappings(){let t=0,n=1,r=0,i=0,s=0,o=0,a="",c,l,u,f;const d=this._mappings.toArray();for(let h=0,p=d.length;h<p;h++){if(l=d[h],c="",l.generatedLine!==n)for(t=0;l.generatedLine!==n;)c+=";",n++;else if(h>0){if(!se.compareByGeneratedPositionsInflated(l,d[h-1]))continue;c+=","}c+=ms.encode(l.generatedColumn-t),t=l.generatedColumn,l.source!=null&&(f=this._sources.indexOf(l.source),c+=ms.encode(f-o),o=f,c+=ms.encode(l.originalLine-1-i),i=l.originalLine-1,c+=ms.encode(l.originalColumn-r),r=l.originalColumn,l.name!=null&&(u=this._names.indexOf(l.name),c+=ms.encode(u-s),s=u)),a+=c}return a}_generateSourcesContent(t,n){return t.map(function(r){if(!this._sourcesContents)return null;n!=null&&(r=se.relative(n,r));const i=se.toSetString(r);return Object.prototype.hasOwnProperty.call(this._sourcesContents,i)?this._sourcesContents[i]:null},this)}toJSON(){const t={version:this._version,sources:this._sources.toArray(),names:this._names.toArray(),mappings:this._serializeMappings()};return this._file!=null&&(t.file=this._file),this._sourceRoot!=null&&(t.sourceRoot=this._sourceRoot),this._sourcesContents&&(t.sourcesContent=this._generateSourcesContent(t.sources,t.sourceRoot)),t}toString(){return JSON.stringify(this.toJSON())}};jf.prototype._version=3,Lf.SourceMapGenerator=jf;var zf={};(function(e){e.GREATEST_LOWER_BOUND=1,e.LEAST_UPPER_BOUND=2;function t(n,r,i,s,o,a){const c=Math.floor((r-n)/2)+n,l=o(i,s[c],!0);return l===0?c:l>0?r-c>1?t(c,r,i,s,o,a):a==e.LEAST_UPPER_BOUND?r<s.length?r:-1:c:c-n>1?t(n,c,i,s,o,a):a==e.LEAST_UPPER_BOUND?c:n<0?-1:n}e.search=function(r,i,s,o){if(i.length===0)return-1;let a=t(-1,i.length,r,i,s,o||e.GREATEST_LOWER_BOUND);if(a<0)return-1;for(;a-1>=0&&s(i[a],i[a-1],!0)===0;)--a;return a}})(zf);var gs={exports:{}},ov={},av=Object.freeze({__proto__:null,default:ov}),Gf=Eb(av);if((function(){return typeof window<"u"&&this===window}).call()){let e=null;gs.exports=function(){if(typeof e=="string")return fetch(e).then(n=>n.arrayBuffer());if(e instanceof ArrayBuffer)return Promise.resolve(e);throw new Error("You must provide the string URL or ArrayBuffer contents of lib/mappings.wasm by calling SourceMapConsumer.initialize({ 'lib/mappings.wasm': ... }) before using SourceMapConsumer")},gs.exports.initialize=t=>e=t}else{const e=Gf,t=Gf;gs.exports=function(){return new Promise((r,i)=>{const s=t.join(__dirname,"mappings.wasm");e.readFile(s,null,(o,a)=>{if(o){i(o);return}r(a.buffer)})})},gs.exports.initialize=n=>{console.debug("SourceMapConsumer.initialize is a no-op when running in node.js")}}var Wf=gs.exports;const cv=Wf;function lv(){this.generatedLine=0,this.generatedColumn=0,this.lastGeneratedColumn=null,this.source=null,this.originalLine=null,this.originalColumn=null,this.name=null}let ys=null;var uv=function(){if(ys)return ys;const t=[];return ys=cv().then(n=>WebAssembly.instantiate(n,{env:{mapping_callback(r,i,s,o,a,c,l,u,f,d){const h=new lv;h.generatedLine=r+1,h.generatedColumn=i,s&&(h.lastGeneratedColumn=o-1),a&&(h.source=c,h.originalLine=l+1,h.originalColumn=u,f&&(h.name=d)),t[t.length-1](h)},start_all_generated_locations_for(){console.time("all_generated_locations_for")},end_all_generated_locations_for(){console.timeEnd("all_generated_locations_for")},start_compute_column_spans(){console.time("compute_column_spans")},end_compute_column_spans(){console.timeEnd("compute_column_spans")},start_generated_location_for(){console.time("generated_location_for")},end_generated_location_for(){console.timeEnd("generated_location_for")},start_original_location_for(){console.time("original_location_for")},end_original_location_for(){console.timeEnd("original_location_for")},start_parse_mappings(){console.time("parse_mappings")},end_parse_mappings(){console.timeEnd("parse_mappings")},start_sort_by_generated_location(){console.time("sort_by_generated_location")},end_sort_by_generated_location(){console.timeEnd("sort_by_generated_location")},start_sort_by_original_location(){console.time("sort_by_original_location")},end_sort_by_original_location(){console.timeEnd("sort_by_original_location")}}})).then(n=>({exports:n.instance.exports,withMappingCallback:(r,i)=>{t.push(r);try{i()}finally{t.pop()}}})).then(null,n=>{throw ys=null,n}),ys};const it=ps,el=zf,Po=tl.ArraySet,hv=Wf,fv=uv,nl=Symbol("smcInternal");class te{constructor(t,n){return t==nl?Promise.resolve(this):pv(t,n)}static initialize(t){hv.initialize(t["lib/mappings.wasm"])}static fromSourceMap(t,n){return mv(t,n)}static async with(t,n,r){const i=await new te(t,n);try{return await r(i)}finally{i.destroy()}}_parseMappings(t,n){throw new Error("Subclasses must implement _parseMappings")}eachMapping(t,n,r){throw new Error("Subclasses must implement eachMapping")}allGeneratedPositionsFor(t){throw new Error("Subclasses must implement allGeneratedPositionsFor")}destroy(){throw new Error("Subclasses must implement destroy")}}te.prototype._version=3,te.GENERATED_ORDER=1,te.ORIGINAL_ORDER=2,te.GREATEST_LOWER_BOUND=1,te.LEAST_UPPER_BOUND=2;class _s extends te{constructor(t,n){return super(nl).then(r=>{let i=t;typeof t=="string"&&(i=it.parseSourceMapInput(t));const s=it.getArg(i,"version");let o=it.getArg(i,"sources");const a=it.getArg(i,"names",[]);let c=it.getArg(i,"sourceRoot",null);const l=it.getArg(i,"sourcesContent",null),u=it.getArg(i,"mappings"),f=it.getArg(i,"file",null);if(s!=r._version)throw new Error("Unsupported version: "+s);return c&&(c=it.normalize(c)),o=o.map(String).map(it.normalize).map(function(d){return c&&it.isAbsolute(c)&&it.isAbsolute(d)?it.relative(c,d):d}),r._names=Po.fromArray(a.map(String),!0),r._sources=Po.fromArray(o,!0),r._absoluteSources=r._sources.toArray().map(function(d){return it.computeSourceURL(c,d,n)}),r.sourceRoot=c,r.sourcesContent=l,r._mappings=u,r._sourceMapURL=n,r.file=f,r._computedColumnSpans=!1,r._mappingsPtr=0,r._wasm=null,fv().then(d=>(r._wasm=d,r))})}_findSourceIndex(t){let n=t;if(this.sourceRoot!=null&&(n=it.relative(this.sourceRoot,n)),this._sources.has(n))return this._sources.indexOf(n);for(let r=0;r<this._absoluteSources.length;++r)if(this._absoluteSources[r]==t)return r;return-1}static fromSourceMap(t,n){return new _s(t.toString())}get sources(){return this._absoluteSources.slice()}_getMappingsPtr(){return this._mappingsPtr===0&&this._parseMappings(this._mappings,this.sourceRoot),this._mappingsPtr}_parseMappings(t,n){const r=t.length,i=this._wasm.exports.allocate_mappings(r),s=new Uint8Array(this._wasm.exports.memory.buffer,i,r);for(let a=0;a<r;a++)s[a]=t.charCodeAt(a);const o=this._wasm.exports.parse_mappings(i);if(!o){const a=this._wasm.exports.get_last_error();let c=`Error parsing mappings (code ${a}): `;switch(a){case 1:c+="the mappings contained a negative line, column, source index, or name index";break;case 2:c+="the mappings contained a number larger than 2**32";break;case 3:c+="reached EOF while in the middle of parsing a VLQ";break;case 4:c+="invalid base 64 character while parsing a VLQ";break;default:c+="unknown error code";break}throw new Error(c)}this._mappingsPtr=o}eachMapping(t,n,r){const i=n||null,s=r||te.GENERATED_ORDER,o=this.sourceRoot;this._wasm.withMappingCallback(a=>{a.source!==null&&(a.source=this._sources.at(a.source),a.source=it.computeSourceURL(o,a.source,this._sourceMapURL),a.name!==null&&(a.name=this._names.at(a.name))),t.call(i,a)},()=>{switch(s){case te.GENERATED_ORDER:this._wasm.exports.by_generated_location(this._getMappingsPtr());break;case te.ORIGINAL_ORDER:this._wasm.exports.by_original_location(this._getMappingsPtr());break;default:throw new Error("Unknown order of iteration.")}})}allGeneratedPositionsFor(t){let n=it.getArg(t,"source");const r=it.getArg(t,"line"),i=t.column||0;if(n=this._findSourceIndex(n),n<0)return[];if(r<1)throw new Error("Line numbers must be >= 1");if(i<0)throw new Error("Column numbers must be >= 0");const s=[];return this._wasm.withMappingCallback(o=>{let a=o.lastGeneratedColumn;this._computedColumnSpans&&a===null&&(a=1/0),s.push({line:o.generatedLine,column:o.generatedColumn,lastColumn:a})},()=>{this._wasm.exports.all_generated_locations_for(this._getMappingsPtr(),n,r-1,"column"in t,i)}),s}destroy(){this._mappingsPtr!==0&&(this._wasm.exports.free_mappings(this._mappingsPtr),this._mappingsPtr=0)}computeColumnSpans(){this._computedColumnSpans||(this._wasm.exports.compute_column_spans(this._getMappingsPtr()),this._computedColumnSpans=!0)}originalPositionFor(t){const n={generatedLine:it.getArg(t,"line"),generatedColumn:it.getArg(t,"column")};if(n.generatedLine<1)throw new Error("Line numbers must be >= 1");if(n.generatedColumn<0)throw new Error("Column numbers must be >= 0");let r=it.getArg(t,"bias",te.GREATEST_LOWER_BOUND);r==null&&(r=te.GREATEST_LOWER_BOUND);let i;if(this._wasm.withMappingCallback(s=>i=s,()=>{this._wasm.exports.original_location_for(this._getMappingsPtr(),n.generatedLine-1,n.generatedColumn,r)}),i&&i.generatedLine===n.generatedLine){let s=it.getArg(i,"source",null);s!==null&&(s=this._sources.at(s),s=it.computeSourceURL(this.sourceRoot,s,this._sourceMapURL));let o=it.getArg(i,"name",null);return o!==null&&(o=this._names.at(o)),{source:s,line:it.getArg(i,"originalLine",null),column:it.getArg(i,"originalColumn",null),name:o}}return{source:null,line:null,column:null,name:null}}hasContentsOfAllSources(){return this.sourcesContent?this.sourcesContent.length>=this._sources.size()&&!this.sourcesContent.some(function(t){return t==null}):!1}sourceContentFor(t,n){if(!this.sourcesContent)return null;const r=this._findSourceIndex(t);if(r>=0)return this.sourcesContent[r];let i=t;this.sourceRoot!=null&&(i=it.relative(this.sourceRoot,i));let s;if(this.sourceRoot!=null&&(s=it.urlParse(this.sourceRoot))){const o=i.replace(/^file:\/\//,"");if(s.scheme=="file"&&this._sources.has(o))return this.sourcesContent[this._sources.indexOf(o)];if((!s.path||s.path=="/")&&this._sources.has("/"+i))return this.sourcesContent[this._sources.indexOf("/"+i)]}if(n)return null;throw new Error('"'+i+'" is not in the SourceMap.')}generatedPositionFor(t){let n=it.getArg(t,"source");if(n=this._findSourceIndex(n),n<0)return{line:null,column:null,lastColumn:null};const r={source:n,originalLine:it.getArg(t,"line"),originalColumn:it.getArg(t,"column")};if(r.originalLine<1)throw new Error("Line numbers must be >= 1");if(r.originalColumn<0)throw new Error("Column numbers must be >= 0");let i=it.getArg(t,"bias",te.GREATEST_LOWER_BOUND);i==null&&(i=te.GREATEST_LOWER_BOUND);let s;if(this._wasm.withMappingCallback(o=>s=o,()=>{this._wasm.exports.generated_location_for(this._getMappingsPtr(),r.source,r.originalLine-1,r.originalColumn,i)}),s&&s.source===r.source){let o=s.lastGeneratedColumn;return this._computedColumnSpans&&o===null&&(o=1/0),{line:it.getArg(s,"generatedLine",null),column:it.getArg(s,"generatedColumn",null),lastColumn:o}}return{line:null,column:null,lastColumn:null}}}_s.prototype.consumer=te;class dv extends te{constructor(t,n){return super(nl).then(r=>{let i=t;typeof t=="string"&&(i=it.parseSourceMapInput(t));const s=it.getArg(i,"version"),o=it.getArg(i,"sections");if(s!=r._version)throw new Error("Unsupported version: "+s);r._sources=new Po,r._names=new Po,r.__generatedMappings=null,r.__originalMappings=null,r.__generatedMappingsUnsorted=null,r.__originalMappingsUnsorted=null;let a={line:-1,column:0};return Promise.all(o.map(c=>{if(c.url)throw new Error("Support for url field in sections not implemented.");const l=it.getArg(c,"offset"),u=it.getArg(l,"line"),f=it.getArg(l,"column");if(u<a.line||u===a.line&&f<a.column)throw new Error("Section offsets must be ordered and non-overlapping.");return a=l,new te(it.getArg(c,"map"),n).then(h=>({generatedOffset:{generatedLine:u+1,generatedColumn:f+1},consumer:h}))})).then(c=>(r._sections=c,r))})}get _generatedMappings(){return this.__generatedMappings||this._sortGeneratedMappings(),this.__generatedMappings}get _originalMappings(){return this.__originalMappings||this._sortOriginalMappings(),this.__originalMappings}get _generatedMappingsUnsorted(){return this.__generatedMappingsUnsorted||this._parseMappings(this._mappings,this.sourceRoot),this.__generatedMappingsUnsorted}get _originalMappingsUnsorted(){return this.__originalMappingsUnsorted||this._parseMappings(this._mappings,this.sourceRoot),this.__originalMappingsUnsorted}_sortGeneratedMappings(){const t=this._generatedMappingsUnsorted;t.sort(it.compareByGeneratedPositionsDeflated),this.__generatedMappings=t}_sortOriginalMappings(){const t=this._originalMappingsUnsorted;t.sort(it.compareByOriginalPositions),this.__originalMappings=t}get sources(){const t=[];for(let n=0;n<this._sections.length;n++)for(let r=0;r<this._sections[n].consumer.sources.length;r++)t.push(this._sections[n].consumer.sources[r]);return t}originalPositionFor(t){const n={generatedLine:it.getArg(t,"line"),generatedColumn:it.getArg(t,"column")},r=el.search(n,this._sections,function(s,o){const a=s.generatedLine-o.generatedOffset.generatedLine;return a||s.generatedColumn-o.generatedOffset.generatedColumn}),i=this._sections[r];return i?i.consumer.originalPositionFor({line:n.generatedLine-(i.generatedOffset.generatedLine-1),column:n.generatedColumn-(i.generatedOffset.generatedLine===n.generatedLine?i.generatedOffset.generatedColumn-1:0),bias:t.bias}):{source:null,line:null,column:null,name:null}}hasContentsOfAllSources(){return this._sections.every(function(t){return t.consumer.hasContentsOfAllSources()})}sourceContentFor(t,n){for(let r=0;r<this._sections.length;r++){const s=this._sections[r].consumer.sourceContentFor(t,!0);if(s)return s}if(n)return null;throw new Error('"'+t+'" is not in the SourceMap.')}generatedPositionFor(t){for(let n=0;n<this._sections.length;n++){const r=this._sections[n];if(r.consumer._findSourceIndex(it.getArg(t,"source"))===-1)continue;const i=r.consumer.generatedPositionFor(t);if(i)return{line:i.line+(r.generatedOffset.generatedLine-1),column:i.column+(r.generatedOffset.generatedLine===i.line?r.generatedOffset.generatedColumn-1:0)}}return{line:null,column:null}}_parseMappings(t,n){const r=this.__generatedMappingsUnsorted=[],i=this.__originalMappingsUnsorted=[];for(let s=0;s<this._sections.length;s++){const o=this._sections[s],a=[];o.consumer.eachMapping(c=>a.push(c));for(let c=0;c<a.length;c++){const l=a[c];let u=it.computeSourceURL(o.consumer.sourceRoot,null,this._sourceMapURL);this._sources.add(u),u=this._sources.indexOf(u);let f=null;l.name&&(this._names.add(l.name),f=this._names.indexOf(l.name));const d={source:u,generatedLine:l.generatedLine+(o.generatedOffset.generatedLine-1),generatedColumn:l.generatedColumn+(o.generatedOffset.generatedLine===l.generatedLine?o.generatedOffset.generatedColumn-1:0),originalLine:l.originalLine,originalColumn:l.originalColumn,name:f};r.push(d),typeof d.originalLine=="number"&&i.push(d)}}}eachMapping(t,n,r){const i=n||null,s=r||te.GENERATED_ORDER;let o;switch(s){case te.GENERATED_ORDER:o=this._generatedMappings;break;case te.ORIGINAL_ORDER:o=this._originalMappings;break;default:throw new Error("Unknown order of iteration.")}const a=this.sourceRoot;o.map(function(c){let l=null;return c.source!==null&&(l=this._sources.at(c.source),l=it.computeSourceURL(a,l,this._sourceMapURL)),{source:l,generatedLine:c.generatedLine,generatedColumn:c.generatedColumn,originalLine:c.originalLine,originalColumn:c.originalColumn,name:c.name===null?null:this._names.at(c.name)}},this).forEach(t,i)}_findMapping(t,n,r,i,s,o){if(t[r]<=0)throw new TypeError("Line must be greater than or equal to 1, got "+t[r]);if(t[i]<0)throw new TypeError("Column must be greater than or equal to 0, got "+t[i]);return el.search(t,n,s,o)}allGeneratedPositionsFor(t){const n=it.getArg(t,"line"),r={source:it.getArg(t,"source"),originalLine:n,originalColumn:it.getArg(t,"column",0)};if(r.source=this._findSourceIndex(r.source),r.source<0)return[];if(r.originalLine<1)throw new Error("Line numbers must be >= 1");if(r.originalColumn<0)throw new Error("Column numbers must be >= 0");const i=[];let s=this._findMapping(r,this._originalMappings,"originalLine","originalColumn",it.compareByOriginalPositions,el.LEAST_UPPER_BOUND);if(s>=0){let o=this._originalMappings[s];if(t.column===void 0){const a=o.originalLine;for(;o&&o.originalLine===a;){let c=o.lastGeneratedColumn;this._computedColumnSpans&&c===null&&(c=1/0),i.push({line:it.getArg(o,"generatedLine",null),column:it.getArg(o,"generatedColumn",null),lastColumn:c}),o=this._originalMappings[++s]}}else{const a=o.originalColumn;for(;o&&o.originalLine===n&&o.originalColumn==a;){let c=o.lastGeneratedColumn;this._computedColumnSpans&&c===null&&(c=1/0),i.push({line:it.getArg(o,"generatedLine",null),column:it.getArg(o,"generatedColumn",null),lastColumn:c}),o=this._originalMappings[++s]}}}return i}destroy(){for(let t=0;t<this._sections.length;t++)this._sections[t].consumer.destroy()}}function pv(e,t){let n=e;typeof e=="string"&&(n=it.parseSourceMapInput(e));const r=n.sections!=null?new dv(n,t):new _s(n,t);return Promise.resolve(r)}function mv(e,t){return _s.fromSourceMap(e,t)}var Kf={};const gv=Lf.SourceMapGenerator,Bo=ps,yv=/(\r?\n)/,_v=10,xi="$$$isSourceNode$$$";let bv=class Bh{constructor(t,n,r,i,s){this.children=[],this.sourceContents={},this.line=t??null,this.column=n??null,this.source=r??null,this.name=s??null,this[xi]=!0,i!=null&&this.add(i)}static fromStringWithSourceMap(t,n,r){const i=new Bh,s=t.split(yv);let o=0;const a=function(){const h=m(),p=m()||"";return h+p;function m(){return o<s.length?s[o++]:void 0}};let c=1,l=0,u=null,f;return n.eachMapping(function(h){if(u!==null)if(c<h.generatedLine)d(u,a()),c++,l=0;else{f=s[o]||"";const p=f.substr(0,h.generatedColumn-l);s[o]=f.substr(h.generatedColumn-l),l=h.generatedColumn,d(u,p),u=h;return}for(;c<h.generatedLine;)i.add(a()),c++;l<h.generatedColumn&&(f=s[o]||"",i.add(f.substr(0,h.generatedColumn)),s[o]=f.substr(h.generatedColumn),l=h.generatedColumn),u=h},this),o<s.length&&(u&&d(u,a()),i.add(s.splice(o).join(""))),n.sources.forEach(function(h){const p=n.sourceContentFor(h);p!=null&&(r!=null&&(h=Bo.join(r,h)),i.setSourceContent(h,p))}),i;function d(h,p){if(h===null||h.source===void 0)i.add(p);else{const m=r?Bo.join(r,h.source):h.source;i.add(new Bh(h.originalLine,h.originalColumn,m,p,h.name))}}}add(t){if(Array.isArray(t))t.forEach(function(n){this.add(n)},this);else if(t[xi]||typeof t=="string")t&&this.children.push(t);else throw new TypeError("Expected a SourceNode, string, or an array of SourceNodes and strings. Got "+t);return this}prepend(t){if(Array.isArray(t))for(let n=t.length-1;n>=0;n--)this.prepend(t[n]);else if(t[xi]||typeof t=="string")this.children.unshift(t);else throw new TypeError("Expected a SourceNode, string, or an array of SourceNodes and strings. Got "+t);return this}walk(t){let n;for(let r=0,i=this.children.length;r<i;r++)n=this.children[r],n[xi]?n.walk(t):n!==""&&t(n,{source:this.source,line:this.line,column:this.column,name:this.name})}join(t){let n,r;const i=this.children.length;if(i>0){for(n=[],r=0;r<i-1;r++)n.push(this.children[r]),n.push(t);n.push(this.children[r]),this.children=n}return this}replaceRight(t,n){const r=this.children[this.children.length-1];return r[xi]?r.replaceRight(t,n):typeof r=="string"?this.children[this.children.length-1]=r.replace(t,n):this.children.push("".replace(t,n)),this}setSourceContent(t,n){this.sourceContents[Bo.toSetString(t)]=n}walkSourceContents(t){for(let r=0,i=this.children.length;r<i;r++)this.children[r][xi]&&this.children[r].walkSourceContents(t);const n=Object.keys(this.sourceContents);for(let r=0,i=n.length;r<i;r++)t(Bo.fromSetString(n[r]),this.sourceContents[n[r]])}toString(){let t="";return this.walk(function(n){t+=n}),t}toStringWithSourceMap(t){const n={code:"",line:1,column:0},r=new gv(t);let i=!1,s=null,o=null,a=null,c=null;return this.walk(function(l,u){n.code+=l,u.source!==null&&u.line!==null&&u.column!==null?((s!==u.source||o!==u.line||a!==u.column||c!==u.name)&&r.addMapping({source:u.source,original:{line:u.line,column:u.column},generated:{line:n.line,column:n.column},name:u.name}),s=u.source,o=u.line,a=u.column,c=u.name,i=!0):i&&(r.addMapping({generated:{line:n.line,column:n.column}}),s=null,i=!1);for(let f=0,d=l.length;f<d;f++)l.charCodeAt(f)===_v?(n.line++,n.column=0,f+1===d?(s=null,i=!1):i&&r.addMapping({source:u.source,original:{line:u.line,column:u.column},generated:{line:n.line,column:n.column},name:u.name})):n.column++}),this.walkSourceContents(function(l,u){r.setSourceContent(l,u)}),{code:n.code,map:r}}};Kf.SourceNode=bv;var wv=Kf.SourceNode;const Mn=!!JSON.parse("false"),vv=!!JSON.parse("false");JSON.parse("false");const Ev=!!JSON.parse("false"),kv="";JSON.parse("false"),JSON.parse("false");var Hf=typeof global=="object"&&global&&global.Object===Object&&global,Av=typeof self=="object"&&self&&self.Object===Object&&self,Un=Hf||Av||Function("return this")(),nn=Un.Symbol,Vf=Object.prototype,Sv=Vf.hasOwnProperty,Tv=Vf.toString,bs=nn?nn.toStringTag:void 0;function Rv(e){var t=Sv.call(e,bs),n=e[bs];try{e[bs]=void 0;var r=!0}catch{}var i=Tv.call(e);return r&&(t?e[bs]=n:delete e[bs]),i}var Ov=Object.prototype,Iv=Ov.toString;function xv(e){return Iv.call(e)}var Cv="[object Null]",Nv="[object Undefined]",Yf=nn?nn.toStringTag:void 0;function Or(e){return e==null?e===void 0?Nv:Cv:Yf&&Yf in Object(e)?Rv(e):xv(e)}function _n(e){return e!=null&&typeof e=="object"}var Lv="[object Symbol]";function $o(e){return typeof e=="symbol"||_n(e)&&Or(e)==Lv}function Fo(e,t){for(var n=-1,r=e==null?0:e.length,i=Array(r);++n<r;)i[n]=t(e[n],n,e);return i}var St=Array.isArray,Mv=1/0,qf=nn?nn.prototype:void 0,Jf=qf?qf.toString:void 0;function Xf(e){if(typeof e=="string")return e;if(St(e))return Fo(e,Xf)+"";if($o(e))return Jf?Jf.call(e):"";var t=e+"";return t=="0"&&1/e==-Mv?"-0":t}var Uv=/\s/;function Dv(e){for(var t=e.length;t--&&Uv.test(e.charAt(t)););return t}var Pv=/^\s+/;function Bv(e){return e&&e.slice(0,Dv(e)+1).replace(Pv,"")}function rn(e){var t=typeof e;return e!=null&&(t=="object"||t=="function")}var Zf=NaN,$v=/^[-+]0x[0-9a-f]+$/i,Fv=/^0b[01]+$/i,jv=/^0o[0-7]+$/i,zv=parseInt;function Gv(e){if(typeof e=="number")return e;if($o(e))return Zf;if(rn(e)){var t=typeof e.valueOf=="function"?e.valueOf():e;e=rn(t)?t+"":t}if(typeof e!="string")return e===0?e:+e;e=Bv(e);var n=Fv.test(e);return n||jv.test(e)?zv(e.slice(2),n?2:8):$v.test(e)?Zf:+e}var Qf=1/0,Wv=17976931348623157e292;function Kv(e){if(!e)return e===0?e:0;if(e=Gv(e),e===Qf||e===-Qf){var t=e<0?-1:1;return t*Wv}return e===e?e:0}function jo(e){var t=Kv(e),n=t%1;return t===t?n?t-n:t:0}function Ci(e){return e}var Hv="[object AsyncFunction]",Vv="[object Function]",Yv="[object GeneratorFunction]",qv="[object Proxy]";function cr(e){if(!rn(e))return!1;var t=Or(e);return t==Vv||t==Yv||t==Hv||t==qv}var rl=Un["__core-js_shared__"],td=function(){var e=/[^.]+$/.exec(rl&&rl.keys&&rl.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}();function Jv(e){return!!td&&td in e}var Xv=Function.prototype,Zv=Xv.toString;function ti(e){if(e!=null){try{return Zv.call(e)}catch{}try{return e+""}catch{}}return""}var Qv=/[\\^$.*+?()[\]{}|]/g,t0=/^\[object .+?Constructor\]$/,e0=Function.prototype,n0=Object.prototype,r0=e0.toString,i0=n0.hasOwnProperty,s0=RegExp("^"+r0.call(i0).replace(Qv,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function o0(e){if(!rn(e)||Jv(e))return!1;var t=cr(e)?s0:t0;return t.test(ti(e))}function a0(e,t){return e==null?void 0:e[t]}function ei(e,t){var n=a0(e,t);return o0(n)?n:void 0}var il=ei(Un,"WeakMap"),ed=Object.create,c0=function(){function e(){}return function(t){if(!rn(t))return{};if(ed)return ed(t);e.prototype=t;var n=new e;return e.prototype=void 0,n}}();function l0(e,t,n){switch(n.length){case 0:return e.call(t);case 1:return e.call(t,n[0]);case 2:return e.call(t,n[0],n[1]);case 3:return e.call(t,n[0],n[1],n[2])}return e.apply(t,n)}function me(){}function u0(e,t){var n=-1,r=e.length;for(t||(t=Array(r));++n<r;)t[n]=e[n];return t}var h0=800,f0=16,d0=Date.now;function p0(e){var t=0,n=0;return function(){var r=d0(),i=f0-(r-n);if(n=r,i>0){if(++t>=h0)return arguments[0]}else t=0;return e.apply(void 0,arguments)}}function m0(e){return function(){return e}}var zo=function(){try{var e=ei(Object,"defineProperty");return e({},"",{}),e}catch{}}(),g0=zo?function(e,t){return zo(e,"toString",{configurable:!0,enumerable:!1,value:m0(t),writable:!0})}:Ci,y0=p0(g0);function nd(e,t){for(var n=-1,r=e==null?0:e.length;++n<r&&t(e[n],n,e)!==!1;);return e}function rd(e,t,n,r){for(var i=e.length,s=n+-1;++s<i;)if(t(e[s],s,e))return s;return-1}function _0(e){return e!==e}function b0(e,t,n){for(var r=n-1,i=e.length;++r<i;)if(e[r]===t)return r;return-1}function sl(e,t,n){return t===t?b0(e,t,n):rd(e,_0,n)}function id(e,t){var n=e==null?0:e.length;return!!n&&sl(e,t,0)>-1}var w0=9007199254740991,v0=/^(?:0|[1-9]\d*)$/;function Go(e,t){var n=typeof e;return t=t??w0,!!t&&(n=="number"||n!="symbol"&&v0.test(e))&&e>-1&&e%1==0&&e<t}function ol(e,t,n){t=="__proto__"&&zo?zo(e,t,{configurable:!0,enumerable:!0,value:n,writable:!0}):e[t]=n}function ws(e,t){return e===t||e!==e&&t!==t}var E0=Object.prototype,k0=E0.hasOwnProperty;function Wo(e,t,n){var r=e[t];(!(k0.call(e,t)&&ws(r,n))||n===void 0&&!(t in e))&&ol(e,t,n)}function al(e,t,n,r){var i=!n;n||(n={});for(var s=-1,o=t.length;++s<o;){var a=t[s],c=void 0;c===void 0&&(c=e[a]),i?ol(n,a,c):Wo(n,a,c)}return n}var sd=Math.max;function A0(e,t,n){return t=sd(t===void 0?e.length-1:t,0),function(){for(var r=arguments,i=-1,s=sd(r.length-t,0),o=Array(s);++i<s;)o[i]=r[t+i];i=-1;for(var a=Array(t+1);++i<t;)a[i]=r[i];return a[t]=n(o),l0(e,this,a)}}function cl(e,t){return y0(A0(e,t,Ci),e+"")}var S0=9007199254740991;function ll(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=S0}function Dn(e){return e!=null&&ll(e.length)&&!cr(e)}function od(e,t,n){if(!rn(n))return!1;var r=typeof t;return(r=="number"?Dn(n)&&Go(t,n.length):r=="string"&&t in n)?ws(n[t],e):!1}function T0(e){return cl(function(t,n){var r=-1,i=n.length,s=i>1?n[i-1]:void 0,o=i>2?n[2]:void 0;for(s=e.length>3&&typeof s=="function"?(i--,s):void 0,o&&od(n[0],n[1],o)&&(s=i<3?void 0:s,i=1),t=Object(t);++r<i;){var a=n[r];a&&e(t,a,r,s)}return t})}var R0=Object.prototype;function vs(e){var t=e&&e.constructor,n=typeof t=="function"&&t.prototype||R0;return e===n}function O0(e,t){for(var n=-1,r=Array(e);++n<e;)r[n]=t(n);return r}var I0="[object Arguments]";function ad(e){return _n(e)&&Or(e)==I0}var cd=Object.prototype,x0=cd.hasOwnProperty,C0=cd.propertyIsEnumerable,Ko=ad(function(){return arguments}())?ad:function(e){return _n(e)&&x0.call(e,"callee")&&!C0.call(e,"callee")};function N0(){return!1}var ld=typeof exports=="object"&&exports&&!exports.nodeType&&exports,ud=ld&&typeof module=="object"&&module&&!module.nodeType&&module,L0=ud&&ud.exports===ld,hd=L0?Un.Buffer:void 0,M0=hd?hd.isBuffer:void 0,Es=M0||N0,U0="[object Arguments]",D0="[object Array]",P0="[object Boolean]",B0="[object Date]",$0="[object Error]",F0="[object Function]",j0="[object Map]",z0="[object Number]",G0="[object Object]",W0="[object RegExp]",K0="[object Set]",H0="[object String]",V0="[object WeakMap]",Y0="[object ArrayBuffer]",q0="[object DataView]",J0="[object Float32Array]",X0="[object Float64Array]",Z0="[object Int8Array]",Q0="[object Int16Array]",tE="[object Int32Array]",eE="[object Uint8Array]",nE="[object Uint8ClampedArray]",rE="[object Uint16Array]",iE="[object Uint32Array]",zt={};zt[J0]=zt[X0]=zt[Z0]=zt[Q0]=zt[tE]=zt[eE]=zt[nE]=zt[rE]=zt[iE]=!0,zt[U0]=zt[D0]=zt[Y0]=zt[P0]=zt[q0]=zt[B0]=zt[$0]=zt[F0]=zt[j0]=zt[z0]=zt[G0]=zt[W0]=zt[K0]=zt[H0]=zt[V0]=!1;function sE(e){return _n(e)&&ll(e.length)&&!!zt[Or(e)]}function Ho(e){return function(t){return e(t)}}var fd=typeof exports=="object"&&exports&&!exports.nodeType&&exports,ks=fd&&typeof module=="object"&&module&&!module.nodeType&&module,oE=ks&&ks.exports===fd,ul=oE&&Hf.process,Ir=function(){try{var e=ks&&ks.require&&ks.require("util").types;return e||ul&&ul.binding&&ul.binding("util")}catch{}}(),dd=Ir&&Ir.isTypedArray,hl=dd?Ho(dd):sE,aE=Object.prototype,cE=aE.hasOwnProperty;function pd(e,t){var n=St(e),r=!n&&Ko(e),i=!n&&!r&&Es(e),s=!n&&!r&&!i&&hl(e),o=n||r||i||s,a=o?O0(e.length,String):[],c=a.length;for(var l in e)(t||cE.call(e,l))&&!(o&&(l=="length"||i&&(l=="offset"||l=="parent")||s&&(l=="buffer"||l=="byteLength"||l=="byteOffset")||Go(l,c)))&&a.push(l);return a}function md(e,t){return function(n){return e(t(n))}}var lE=md(Object.keys,Object),uE=Object.prototype,hE=uE.hasOwnProperty;function gd(e){if(!vs(e))return lE(e);var t=[];for(var n in Object(e))hE.call(e,n)&&n!="constructor"&&t.push(n);return t}function sn(e){return Dn(e)?pd(e):gd(e)}var fE=Object.prototype,dE=fE.hasOwnProperty,Fe=T0(function(e,t){if(vs(t)||Dn(t)){al(t,sn(t),e);return}for(var n in t)dE.call(t,n)&&Wo(e,n,t[n])});function pE(e){var t=[];if(e!=null)for(var n in Object(e))t.push(n);return t}var mE=Object.prototype,gE=mE.hasOwnProperty;function yE(e){if(!rn(e))return pE(e);var t=vs(e),n=[];for(var r in e)r=="constructor"&&(t||!gE.call(e,r))||n.push(r);return n}function yd(e){return Dn(e)?pd(e,!0):yE(e)}var _E=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,bE=/^\w*$/;function fl(e,t){if(St(e))return!1;var n=typeof e;return n=="number"||n=="symbol"||n=="boolean"||e==null||$o(e)?!0:bE.test(e)||!_E.test(e)||t!=null&&e in Object(t)}var As=ei(Object,"create");function wE(){this.__data__=As?As(null):{},this.size=0}function vE(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}var EE="__lodash_hash_undefined__",kE=Object.prototype,AE=kE.hasOwnProperty;function SE(e){var t=this.__data__;if(As){var n=t[e];return n===EE?void 0:n}return AE.call(t,e)?t[e]:void 0}var TE=Object.prototype,RE=TE.hasOwnProperty;function OE(e){var t=this.__data__;return As?t[e]!==void 0:RE.call(t,e)}var IE="__lodash_hash_undefined__";function xE(e,t){var n=this.__data__;return this.size+=this.has(e)?0:1,n[e]=As&&t===void 0?IE:t,this}function ni(e){var t=-1,n=e==null?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}ni.prototype.clear=wE,ni.prototype.delete=vE,ni.prototype.get=SE,ni.prototype.has=OE,ni.prototype.set=xE;function CE(){this.__data__=[],this.size=0}function Vo(e,t){for(var n=e.length;n--;)if(ws(e[n][0],t))return n;return-1}var NE=Array.prototype,LE=NE.splice;function ME(e){var t=this.__data__,n=Vo(t,e);if(n<0)return!1;var r=t.length-1;return n==r?t.pop():LE.call(t,n,1),--this.size,!0}function UE(e){var t=this.__data__,n=Vo(t,e);return n<0?void 0:t[n][1]}function DE(e){return Vo(this.__data__,e)>-1}function PE(e,t){var n=this.__data__,r=Vo(n,e);return r<0?(++this.size,n.push([e,t])):n[r][1]=t,this}function lr(e){var t=-1,n=e==null?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}lr.prototype.clear=CE,lr.prototype.delete=ME,lr.prototype.get=UE,lr.prototype.has=DE,lr.prototype.set=PE;var Ss=ei(Un,"Map");function BE(){this.size=0,this.__data__={hash:new ni,map:new(Ss||lr),string:new ni}}function $E(e){var t=typeof e;return t=="string"||t=="number"||t=="symbol"||t=="boolean"?e!=="__proto__":e===null}function Yo(e,t){var n=e.__data__;return $E(t)?n[typeof t=="string"?"string":"hash"]:n.map}function FE(e){var t=Yo(this,e).delete(e);return this.size-=t?1:0,t}function jE(e){return Yo(this,e).get(e)}function zE(e){return Yo(this,e).has(e)}function GE(e,t){var n=Yo(this,e),r=n.size;return n.set(e,t),this.size+=n.size==r?0:1,this}function ur(e){var t=-1,n=e==null?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}ur.prototype.clear=BE,ur.prototype.delete=FE,ur.prototype.get=jE,ur.prototype.has=zE,ur.prototype.set=GE;var WE="Expected a function";function dl(e,t){if(typeof e!="function"||t!=null&&typeof t!="function")throw new TypeError(WE);var n=function(){var r=arguments,i=t?t.apply(this,r):r[0],s=n.cache;if(s.has(i))return s.get(i);var o=e.apply(this,r);return n.cache=s.set(i,o)||s,o};return n.cache=new(dl.Cache||ur),n}dl.Cache=ur;var KE=500;function HE(e){var t=dl(e,function(r){return n.size===KE&&n.clear(),r}),n=t.cache;return t}var VE=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,YE=/\\(\\)?/g,qE=HE(function(e){var t=[];return e.charCodeAt(0)===46&&t.push(""),e.replace(VE,function(n,r,i,s){t.push(i?s.replace(YE,"$1"):r||n)}),t});function _d(e){return e==null?"":Xf(e)}function qo(e,t){return St(e)?e:fl(e,t)?[e]:qE(_d(e))}var JE=1/0;function Ts(e){if(typeof e=="string"||$o(e))return e;var t=e+"";return t=="0"&&1/e==-JE?"-0":t}function pl(e,t){t=qo(t,e);for(var n=0,r=t.length;e!=null&&n<r;)e=e[Ts(t[n++])];return n&&n==r?e:void 0}function XE(e,t,n){var r=e==null?void 0:pl(e,t);return r===void 0?n:r}function ml(e,t){for(var n=-1,r=t.length,i=e.length;++n<r;)e[i+n]=t[n];return e}var bd=nn?nn.isConcatSpreadable:void 0;function ZE(e){return St(e)||Ko(e)||!!(bd&&e&&e[bd])}function gl(e,t,n,r,i){var s=-1,o=e.length;for(n||(n=ZE),i||(i=[]);++s<o;){var a=e[s];n(a)?ml(i,a):r||(i[i.length]=a)}return i}function qe(e){var t=e==null?0:e.length;return t?gl(e):[]}var wd=md(Object.getPrototypeOf,Object);function yl(e,t,n){var r=-1,i=e.length;t<0&&(t=-t>i?0:i+t),n=n>i?i:n,n<0&&(n+=i),i=t>n?0:n-t>>>0,t>>>=0;for(var s=Array(i);++r<i;)s[r]=e[r+t];return s}function QE(e,t,n){var r=e.length;return n=n===void 0?r:n,!t&&n>=r?e:yl(e,t,n)}var tk="\\ud800-\\udfff",ek="\\u0300-\\u036f",nk="\\ufe20-\\ufe2f",rk="\\u20d0-\\u20ff",ik=ek+nk+rk,sk="\\ufe0e\\ufe0f",ok="\\u200d",ak=RegExp("["+ok+tk+ik+sk+"]");function vd(e){return ak.test(e)}function ck(e){return e.split("")}var Ed="\\ud800-\\udfff",lk="\\u0300-\\u036f",uk="\\ufe20-\\ufe2f",hk="\\u20d0-\\u20ff",fk=lk+uk+hk,dk="\\ufe0e\\ufe0f",pk="["+Ed+"]",_l="["+fk+"]",bl="\\ud83c[\\udffb-\\udfff]",mk="(?:"+_l+"|"+bl+")",kd="[^"+Ed+"]",Ad="(?:\\ud83c[\\udde6-\\uddff]){2}",Sd="[\\ud800-\\udbff][\\udc00-\\udfff]",gk="\\u200d",Td=mk+"?",Rd="["+dk+"]?",yk="(?:"+gk+"(?:"+[kd,Ad,Sd].join("|")+")"+Rd+Td+")*",_k=Rd+Td+yk,bk="(?:"+[kd+_l+"?",_l,Ad,Sd,pk].join("|")+")",wk=RegExp(bl+"(?="+bl+")|"+bk+_k,"g");function vk(e){return e.match(wk)||[]}function Ek(e){return vd(e)?vk(e):ck(e)}function kk(e){return function(t){t=_d(t);var n=vd(t)?Ek(t):void 0,r=n?n[0]:t.charAt(0),i=n?QE(n,1).join(""):t.slice(1);return r[e]()+i}}var Od=kk("toUpperCase");function Ak(e,t,n,r){var i=-1,s=e==null?0:e.length;for(r&&s&&(n=e[++i]);++i<s;)n=t(n,e[i],i,e);return n}function Sk(){this.__data__=new lr,this.size=0}function Tk(e){var t=this.__data__,n=t.delete(e);return this.size=t.size,n}function Rk(e){return this.__data__.get(e)}function Ok(e){return this.__data__.has(e)}var Ik=200;function xk(e,t){var n=this.__data__;if(n instanceof lr){var r=n.__data__;if(!Ss||r.length<Ik-1)return r.push([e,t]),this.size=++n.size,this;n=this.__data__=new ur(r)}return n.set(e,t),this.size=n.size,this}function Pn(e){var t=this.__data__=new lr(e);this.size=t.size}Pn.prototype.clear=Sk,Pn.prototype.delete=Tk,Pn.prototype.get=Rk,Pn.prototype.has=Ok,Pn.prototype.set=xk;function Ck(e,t){return e&&al(t,sn(t),e)}var Id=typeof exports=="object"&&exports&&!exports.nodeType&&exports,xd=Id&&typeof module=="object"&&module&&!module.nodeType&&module,Nk=xd&&xd.exports===Id,Cd=Nk?Un.Buffer:void 0,Nd=Cd?Cd.allocUnsafe:void 0;function Lk(e,t){var n=e.length,r=Nd?Nd(n):new e.constructor(n);return e.copy(r),r}function wl(e,t){for(var n=-1,r=e==null?0:e.length,i=0,s=[];++n<r;){var o=e[n];t(o,n,e)&&(s[i++]=o)}return s}function Ld(){return[]}var Mk=Object.prototype,Uk=Mk.propertyIsEnumerable,Md=Object.getOwnPropertySymbols,vl=Md?function(e){return e==null?[]:(e=Object(e),wl(Md(e),function(t){return Uk.call(e,t)}))}:Ld;function Dk(e,t){return al(e,vl(e),t)}var Pk=Object.getOwnPropertySymbols,Bk=Pk?function(e){for(var t=[];e;)ml(t,vl(e)),e=wd(e);return t}:Ld;function Ud(e,t,n){var r=t(e);return St(e)?r:ml(r,n(e))}function El(e){return Ud(e,sn,vl)}function $k(e){return Ud(e,yd,Bk)}var kl=ei(Un,"DataView"),Al=ei(Un,"Promise"),Ni=ei(Un,"Set"),Dd="[object Map]",Fk="[object Object]",Pd="[object Promise]",Bd="[object Set]",$d="[object WeakMap]",Fd="[object DataView]",jk=ti(kl),zk=ti(Ss),Gk=ti(Al),Wk=ti(Ni),Kk=ti(il),on=Or;(kl&&on(new kl(new ArrayBuffer(1)))!=Fd||Ss&&on(new Ss)!=Dd||Al&&on(Al.resolve())!=Pd||Ni&&on(new Ni)!=Bd||il&&on(new il)!=$d)&&(on=function(e){var t=Or(e),n=t==Fk?e.constructor:void 0,r=n?ti(n):"";if(r)switch(r){case jk:return Fd;case zk:return Dd;case Gk:return Pd;case Wk:return Bd;case Kk:return $d}return t});var Hk=Object.prototype,Vk=Hk.hasOwnProperty;function Yk(e){var t=e.length,n=new e.constructor(t);return t&&typeof e[0]=="string"&&Vk.call(e,"index")&&(n.index=e.index,n.input=e.input),n}var Jo=Un.Uint8Array;function qk(e){var t=new e.constructor(e.byteLength);return new Jo(t).set(new Jo(e)),t}function Jk(e,t){var n=e.buffer;return new e.constructor(n,e.byteOffset,e.byteLength)}var Xk=/\w*$/;function Zk(e){var t=new e.constructor(e.source,Xk.exec(e));return t.lastIndex=e.lastIndex,t}var jd=nn?nn.prototype:void 0,zd=jd?jd.valueOf:void 0;function Qk(e){return zd?Object(zd.call(e)):{}}function tA(e,t){var n=e.buffer;return new e.constructor(n,e.byteOffset,e.length)}var eA="[object Boolean]",nA="[object Date]",rA="[object Map]",iA="[object Number]",sA="[object RegExp]",oA="[object Set]",aA="[object String]",cA="[object Symbol]",lA="[object ArrayBuffer]",uA="[object DataView]",hA="[object Float32Array]",fA="[object Float64Array]",dA="[object Int8Array]",pA="[object Int16Array]",mA="[object Int32Array]",gA="[object Uint8Array]",yA="[object Uint8ClampedArray]",_A="[object Uint16Array]",bA="[object Uint32Array]";function wA(e,t,n){var r=e.constructor;switch(t){case lA:return qk(e);case eA:case nA:return new r(+e);case uA:return Jk(e);case hA:case fA:case dA:case pA:case mA:case gA:case yA:case _A:case bA:return tA(e);case rA:return new r;case iA:case aA:return new r(e);case sA:return Zk(e);case oA:return new r;case cA:return Qk(e)}}function vA(e){return typeof e.constructor=="function"&&!vs(e)?c0(wd(e)):{}}var EA="[object Map]";function kA(e){return _n(e)&&on(e)==EA}var Gd=Ir&&Ir.isMap,AA=Gd?Ho(Gd):kA,SA="[object Set]";function TA(e){return _n(e)&&on(e)==SA}var Wd=Ir&&Ir.isSet,RA=Wd?Ho(Wd):TA,Kd="[object Arguments]",OA="[object Array]",IA="[object Boolean]",xA="[object Date]",CA="[object Error]",Hd="[object Function]",NA="[object GeneratorFunction]",LA="[object Map]",MA="[object Number]",Vd="[object Object]",UA="[object RegExp]",DA="[object Set]",PA="[object String]",BA="[object Symbol]",$A="[object WeakMap]",FA="[object ArrayBuffer]",jA="[object DataView]",zA="[object Float32Array]",GA="[object Float64Array]",WA="[object Int8Array]",KA="[object Int16Array]",HA="[object Int32Array]",VA="[object Uint8Array]",YA="[object Uint8ClampedArray]",qA="[object Uint16Array]",JA="[object Uint32Array]",Mt={};Mt[Kd]=Mt[OA]=Mt[FA]=Mt[jA]=Mt[IA]=Mt[xA]=Mt[zA]=Mt[GA]=Mt[WA]=Mt[KA]=Mt[HA]=Mt[LA]=Mt[MA]=Mt[Vd]=Mt[UA]=Mt[DA]=Mt[PA]=Mt[BA]=Mt[VA]=Mt[YA]=Mt[qA]=Mt[JA]=!0,Mt[CA]=Mt[Hd]=Mt[$A]=!1;function Xo(e,t,n,r,i,s){var o;if(o!==void 0)return o;if(!rn(e))return e;var a=St(e);if(a)return o=Yk(e),u0(e,o);var c=on(e),l=c==Hd||c==NA;if(Es(e))return Lk(e);if(c==Vd||c==Kd||l&&!i)return o=l?{}:vA(e),Dk(e,Ck(o,e));if(!Mt[c])return i?e:{};o=wA(e,c),s||(s=new Pn);var u=s.get(e);if(u)return u;s.set(e,o),RA(e)?e.forEach(function(h){o.add(Xo(h,t,n,h,e,s))}):AA(e)&&e.forEach(function(h,p){o.set(p,Xo(h,t,n,p,e,s))});var f=El,d=a?void 0:f(e);return nd(d||e,function(h,p){d&&(p=h,h=e[p]),Wo(o,p,Xo(h,t,n,p,e,s))}),o}var XA=4;function Se(e){return Xo(e,XA)}function Rs(e){for(var t=-1,n=e==null?0:e.length,r=0,i=[];++t<n;){var s=e[t];s&&(i[r++]=s)}return i}var ZA="__lodash_hash_undefined__";function QA(e){return this.__data__.set(e,ZA),this}function t1(e){return this.__data__.has(e)}function Li(e){var t=-1,n=e==null?0:e.length;for(this.__data__=new ur;++t<n;)this.add(e[t])}Li.prototype.add=Li.prototype.push=QA,Li.prototype.has=t1;function Yd(e,t){for(var n=-1,r=e==null?0:e.length;++n<r;)if(t(e[n],n,e))return!0;return!1}function Sl(e,t){return e.has(t)}var e1=1,n1=2;function qd(e,t,n,r,i,s){var o=n&e1,a=e.length,c=t.length;if(a!=c&&!(o&&c>a))return!1;var l=s.get(e),u=s.get(t);if(l&&u)return l==t&&u==e;var f=-1,d=!0,h=n&n1?new Li:void 0;for(s.set(e,t),s.set(t,e);++f<a;){var p=e[f],m=t[f];if(r)var v=o?r(m,p,f,t,e,s):r(p,m,f,e,t,s);if(v!==void 0){if(v)continue;d=!1;break}if(h){if(!Yd(t,function(b,y){if(!Sl(h,y)&&(p===b||i(p,b,n,r,s)))return h.push(y)})){d=!1;break}}else if(!(p===m||i(p,m,n,r,s))){d=!1;break}}return s.delete(e),s.delete(t),d}function r1(e){var t=-1,n=Array(e.size);return e.forEach(function(r,i){n[++t]=[i,r]}),n}function Tl(e){var t=-1,n=Array(e.size);return e.forEach(function(r){n[++t]=r}),n}var i1=1,s1=2,o1="[object Boolean]",a1="[object Date]",c1="[object Error]",l1="[object Map]",u1="[object Number]",h1="[object RegExp]",f1="[object Set]",d1="[object String]",p1="[object Symbol]",m1="[object ArrayBuffer]",g1="[object DataView]",Jd=nn?nn.prototype:void 0,Rl=Jd?Jd.valueOf:void 0;function y1(e,t,n,r,i,s,o){switch(n){case g1:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case m1:return!(e.byteLength!=t.byteLength||!s(new Jo(e),new Jo(t)));case o1:case a1:case u1:return ws(+e,+t);case c1:return e.name==t.name&&e.message==t.message;case h1:case d1:return e==t+"";case l1:var a=r1;case f1:var c=r&i1;if(a||(a=Tl),e.size!=t.size&&!c)return!1;var l=o.get(e);if(l)return l==t;r|=s1,o.set(e,t);var u=qd(a(e),a(t),r,i,s,o);return o.delete(e),u;case p1:if(Rl)return Rl.call(e)==Rl.call(t)}return!1}var _1=1,b1=Object.prototype,w1=b1.hasOwnProperty;function v1(e,t,n,r,i,s){var o=n&_1,a=El(e),c=a.length,l=El(t),u=l.length;if(c!=u&&!o)return!1;for(var f=c;f--;){var d=a[f];if(!(o?d in t:w1.call(t,d)))return!1}var h=s.get(e),p=s.get(t);if(h&&p)return h==t&&p==e;var m=!0;s.set(e,t),s.set(t,e);for(var v=o;++f<c;){d=a[f];var b=e[d],y=t[d];if(r)var A=o?r(y,b,d,t,e,s):r(b,y,d,e,t,s);if(!(A===void 0?b===y||i(b,y,n,r,s):A)){m=!1;break}v||(v=d=="constructor")}if(m&&!v){var I=e.constructor,k=t.constructor;I!=k&&"constructor"in e&&"constructor"in t&&!(typeof I=="function"&&I instanceof I&&typeof k=="function"&&k instanceof k)&&(m=!1)}return s.delete(e),s.delete(t),m}var E1=1,Xd="[object Arguments]",Zd="[object Array]",Zo="[object Object]",k1=Object.prototype,Qd=k1.hasOwnProperty;function A1(e,t,n,r,i,s){var o=St(e),a=St(t),c=o?Zd:on(e),l=a?Zd:on(t);c=c==Xd?Zo:c,l=l==Xd?Zo:l;var u=c==Zo,f=l==Zo,d=c==l;if(d&&Es(e)){if(!Es(t))return!1;o=!0,u=!1}if(d&&!u)return s||(s=new Pn),o||hl(e)?qd(e,t,n,r,i,s):y1(e,t,c,n,r,i,s);if(!(n&E1)){var h=u&&Qd.call(e,"__wrapped__"),p=f&&Qd.call(t,"__wrapped__");if(h||p){var m=h?e.value():e,v=p?t.value():t;return s||(s=new Pn),i(m,v,n,r,s)}}return d?(s||(s=new Pn),v1(e,t,n,r,i,s)):!1}function Ol(e,t,n,r,i){return e===t?!0:e==null||t==null||!_n(e)&&!_n(t)?e!==e&&t!==t:A1(e,t,n,r,Ol,i)}var S1=1,T1=2;function R1(e,t,n,r){var i=n.length,s=i;if(e==null)return!s;for(e=Object(e);i--;){var o=n[i];if(o[2]?o[1]!==e[o[0]]:!(o[0]in e))return!1}for(;++i<s;){o=n[i];var a=o[0],c=e[a],l=o[1];if(o[2]){if(c===void 0&&!(a in e))return!1}else{var u=new Pn,f;if(!(f===void 0?Ol(l,c,S1|T1,r,u):f))return!1}}return!0}function tp(e){return e===e&&!rn(e)}function O1(e){for(var t=sn(e),n=t.length;n--;){var r=t[n],i=e[r];t[n]=[r,i,tp(i)]}return t}function ep(e,t){return function(n){return n==null?!1:n[e]===t&&(t!==void 0||e in Object(n))}}function I1(e){var t=O1(e);return t.length==1&&t[0][2]?ep(t[0][0],t[0][1]):function(n){return n===e||R1(n,e,t)}}function x1(e,t){return e!=null&&t in Object(e)}function np(e,t,n){t=qo(t,e);for(var r=-1,i=t.length,s=!1;++r<i;){var o=Ts(t[r]);if(!(s=e!=null&&n(e,o)))break;e=e[o]}return s||++r!=i?s:(i=e==null?0:e.length,!!i&&ll(i)&&Go(o,i)&&(St(e)||Ko(e)))}function C1(e,t){return e!=null&&np(e,t,x1)}var N1=1,L1=2;function M1(e,t){return fl(e)&&tp(t)?ep(Ts(e),t):function(n){var r=XE(n,e);return r===void 0&&r===t?C1(n,e):Ol(t,r,N1|L1)}}function U1(e){return function(t){return t==null?void 0:t[e]}}function D1(e){return function(t){return pl(t,e)}}function P1(e){return fl(e)?U1(Ts(e)):D1(e)}function Bn(e){return typeof e=="function"?e:e==null?Ci:typeof e=="object"?St(e)?M1(e[0],e[1]):I1(e):P1(e)}function B1(e,t,n,r){for(var i=-1,s=e==null?0:e.length;++i<s;){var o=e[i];t(r,o,n(o),e)}return r}function $1(e){return function(t,n,r){for(var i=-1,s=Object(t),o=r(t),a=o.length;a--;){var c=o[++i];if(n(s[c],c,s)===!1)break}return t}}var F1=$1();function j1(e,t){return e&&F1(e,t,sn)}function z1(e,t){return function(n,r){if(n==null)return n;if(!Dn(n))return e(n,r);for(var i=n.length,s=-1,o=Object(n);++s<i&&r(o[s],s,o)!==!1;);return n}}var ri=z1(j1);function G1(e,t,n,r){return ri(e,function(i,s,o){t(r,i,n(i),o)}),r}function W1(e,t){return function(n,r){var i=St(n)?B1:G1,s=t?t():{};return i(n,e,Bn(r),s)}}var rp=Object.prototype,K1=rp.hasOwnProperty,Il=cl(function(e,t){e=Object(e);var n=-1,r=t.length,i=r>2?t[2]:void 0;for(i&&od(t[0],t[1],i)&&(r=1);++n<r;)for(var s=t[n],o=yd(s),a=-1,c=o.length;++a<c;){var l=o[a],u=e[l];(u===void 0||ws(u,rp[l])&&!K1.call(e,l))&&(e[l]=s[l])}return e});function ip(e){return _n(e)&&Dn(e)}var H1=200;function V1(e,t,n,r){var i=-1,s=id,o=!0,a=e.length,c=[],l=t.length;if(!a)return c;t.length>=H1&&(s=Sl,o=!1,t=new Li(t));t:for(;++i<a;){var u=e[i],f=u;if(u=u!==0?u:0,o&&f===f){for(var d=l;d--;)if(t[d]===f)continue t;c.push(u)}else s(t,f,r)||c.push(u)}return c}var Qo=cl(function(e,t){return ip(e)?V1(e,gl(t,1,ip,!0)):[]});function Mi(e){var t=e==null?0:e.length;return t?e[t-1]:void 0}function Te(e,t,n){var r=e==null?0:e.length;return r?(t=t===void 0?1:jo(t),yl(e,t<0?0:t,r)):[]}function Os(e,t,n){var r=e==null?0:e.length;return r?(t=t===void 0?1:jo(t),t=r-t,yl(e,0,t<0?0:t)):[]}function Y1(e){return typeof e=="function"?e:Ci}function ut(e,t){var n=St(e)?nd:ri;return n(e,Y1(t))}function q1(e,t){for(var n=-1,r=e==null?0:e.length;++n<r;)if(!t(e[n],n,e))return!1;return!0}function J1(e,t){var n=!0;return ri(e,function(r,i,s){return n=!!t(r,i,s),n}),n}function bn(e,t,n){var r=St(e)?q1:J1;return r(e,Bn(t))}function sp(e,t){var n=[];return ri(e,function(r,i,s){t(r,i,s)&&n.push(r)}),n}function an(e,t){var n=St(e)?wl:sp;return n(e,Bn(t))}function X1(e){return function(t,n,r){var i=Object(t);if(!Dn(t)){var s=Bn(n);t=sn(t),n=function(a){return s(i[a],a,i)}}var o=e(t,n,r);return o>-1?i[s?t[o]:o]:void 0}}var Z1=Math.max;function Q1(e,t,n){var r=e==null?0:e.length;if(!r)return-1;var i=n==null?0:jo(n);return i<0&&(i=Z1(r+i,0)),rd(e,Bn(t),i)}var Ui=X1(Q1);function wn(e){return e&&e.length?e[0]:void 0}function tS(e,t){var n=-1,r=Dn(e)?Array(e.length):[];return ri(e,function(i,s,o){r[++n]=t(i,s,o)}),r}function et(e,t){var n=St(e)?Fo:tS;return n(e,Bn(t))}function cn(e,t){return gl(et(e,t))}var eS=Object.prototype,nS=eS.hasOwnProperty,op=W1(function(e,t,n){nS.call(e,n)?e[n].push(t):ol(e,n,[t])}),rS=Object.prototype,iS=rS.hasOwnProperty;function sS(e,t){return e!=null&&iS.call(e,t)}function lt(e,t){return e!=null&&np(e,t,sS)}var oS="[object String]";function je(e){return typeof e=="string"||!St(e)&&_n(e)&&Or(e)==oS}function aS(e,t){return Fo(t,function(n){return e[n]})}function oe(e){return e==null?[]:aS(e,sn(e))}var cS=Math.max;function Me(e,t,n,r){e=Dn(e)?e:oe(e),n=n&&!r?jo(n):0;var i=e.length;return n<0&&(n=cS(i+n,0)),je(e)?n<=i&&e.indexOf(t,n)>-1:!!i&&sl(e,t,n)>-1}function ap(e,t,n){var r=e==null?0:e.length;if(!r)return-1;var i=0;return sl(e,t,i)}var lS="[object Map]",uS="[object Set]",hS=Object.prototype,fS=hS.hasOwnProperty;function Ut(e){if(e==null)return!0;if(Dn(e)&&(St(e)||typeof e=="string"||typeof e.splice=="function"||Es(e)||hl(e)||Ko(e)))return!e.length;var t=on(e);if(t==lS||t==uS)return!e.size;if(vs(e))return!gd(e).length;for(var n in e)if(fS.call(e,n))return!1;return!0}var dS="[object RegExp]";function pS(e){return _n(e)&&Or(e)==dS}var cp=Ir&&Ir.isRegExp,hr=cp?Ho(cp):pS;function fr(e){return e===void 0}var mS="Expected a function";function gS(e){if(typeof e!="function")throw new TypeError(mS);return function(){var t=arguments;switch(t.length){case 0:return!e.call(this);case 1:return!e.call(this,t[0]);case 2:return!e.call(this,t[0],t[1]);case 3:return!e.call(this,t[0],t[1],t[2])}return!e.apply(this,t)}}function yS(e,t,n,r){if(!rn(e))return e;t=qo(t,e);for(var i=-1,s=t.length,o=s-1,a=e;a!=null&&++i<s;){var c=Ts(t[i]),l=n;if(c==="__proto__"||c==="constructor"||c==="prototype")return e;if(i!=o){var u=a[c];l=void 0,l===void 0&&(l=rn(u)?u:Go(t[i+1])?[]:{})}Wo(a,c,l),a=a[c]}return e}function _S(e,t,n){for(var r=-1,i=t.length,s={};++r<i;){var o=t[r],a=pl(e,o);n(a,o)&&yS(s,qo(o,e),a)}return s}function vn(e,t){if(e==null)return{};var n=Fo($k(e),function(r){return[r]});return t=Bn(t),_S(e,n,function(r,i){return t(r,i[0])})}function bS(e,t,n,r,i){return i(e,function(s,o,a){n=r?(r=!1,s):t(n,s,o,a)}),n}function ze(e,t,n){var r=St(e)?Ak:bS,i=arguments.length<3;return r(e,Bn(t),n,i,ri)}function ta(e,t){var n=St(e)?wl:sp;return n(e,gS(Bn(t)))}function wS(e,t){var n;return ri(e,function(r,i,s){return n=t(r,i,s),!n}),!!n}function xl(e,t,n){var r=St(e)?Yd:wS;return r(e,Bn(t))}var vS=1/0,ES=Ni&&1/Tl(new Ni([,-0]))[1]==vS?function(e){return new Ni(e)}:me,kS=200;function AS(e,t,n){var r=-1,i=id,s=e.length,o=!0,a=[],c=a;if(s>=kS){var l=ES(e);if(l)return Tl(l);o=!1,i=Sl,c=new Li}else c=a;t:for(;++r<s;){var u=e[r],f=u;if(u=u!==0?u:0,o&&f===f){for(var d=c.length;d--;)if(c[d]===f)continue t;a.push(u)}else i(c,f,n)||(c!==a&&c.push(f),a.push(u))}return a}function ea(e){return e&&e.length?AS(e):[]}function Cl(e){console&&console.error&&console.error(`Error: ${e}`)}function lp(e){console&&console.warn&&console.warn(`Warning: ${e}`)}function up(e){const t=new Date().getTime(),n=e();return{time:new Date().getTime()-t,value:n}}function hp(e){function t(){}t.prototype=e;const n=new t;function r(){return typeof n.bar}return r(),r(),e}function SS(e){return TS(e)?e.LABEL:e.name}function TS(e){return je(e.LABEL)&&e.LABEL!==""}class $n{get definition(){return this._definition}set definition(t){this._definition=t}constructor(t){this._definition=t}accept(t){t.visit(this),ut(this.definition,n=>{n.accept(t)})}}class Ge extends $n{constructor(t){super([]),this.idx=1,Fe(this,vn(t,n=>n!==void 0))}set definition(t){}get definition(){return this.referencedRule!==void 0?this.referencedRule.definition:[]}accept(t){t.visit(this)}}class Di extends $n{constructor(t){super(t.definition),this.orgText="",Fe(this,vn(t,n=>n!==void 0))}}class We extends $n{constructor(t){super(t.definition),this.ignoreAmbiguities=!1,Fe(this,vn(t,n=>n!==void 0))}}class Ke extends $n{constructor(t){super(t.definition),this.idx=1,Fe(this,vn(t,n=>n!==void 0))}}class Fn extends $n{constructor(t){super(t.definition),this.idx=1,Fe(this,vn(t,n=>n!==void 0))}}class jn extends $n{constructor(t){super(t.definition),this.idx=1,Fe(this,vn(t,n=>n!==void 0))}}class ge extends $n{constructor(t){super(t.definition),this.idx=1,Fe(this,vn(t,n=>n!==void 0))}}class En extends $n{constructor(t){super(t.definition),this.idx=1,Fe(this,vn(t,n=>n!==void 0))}}class kn extends $n{get definition(){return this._definition}set definition(t){this._definition=t}constructor(t){super(t.definition),this.idx=1,this.ignoreAmbiguities=!1,this.hasPredicates=!1,Fe(this,vn(t,n=>n!==void 0))}}class Ht{constructor(t){this.idx=1,Fe(this,vn(t,n=>n!==void 0))}accept(t){t.visit(this)}}function RS(e){return et(e,na)}function na(e){function t(n){return et(n,na)}if(e instanceof Ge){const n={type:"NonTerminal",name:e.nonTerminalName,idx:e.idx};return je(e.label)&&(n.label=e.label),n}else{if(e instanceof We)return{type:"Alternative",definition:t(e.definition)};if(e instanceof Ke)return{type:"Option",idx:e.idx,definition:t(e.definition)};if(e instanceof Fn)return{type:"RepetitionMandatory",idx:e.idx,definition:t(e.definition)};if(e instanceof jn)return{type:"RepetitionMandatoryWithSeparator",idx:e.idx,separator:na(new Ht({terminalType:e.separator})),definition:t(e.definition)};if(e instanceof En)return{type:"RepetitionWithSeparator",idx:e.idx,separator:na(new Ht({terminalType:e.separator})),definition:t(e.definition)};if(e instanceof ge)return{type:"Repetition",idx:e.idx,definition:t(e.definition)};if(e instanceof kn)return{type:"Alternation",idx:e.idx,definition:t(e.definition)};if(e instanceof Ht){const n={type:"Terminal",name:e.terminalType.name,label:SS(e.terminalType),idx:e.idx};je(e.label)&&(n.terminalLabel=e.label);const r=e.terminalType.PATTERN;return e.terminalType.PATTERN&&(n.pattern=hr(r)?r.source:r),n}else{if(e instanceof Di)return{type:"Rule",name:e.name,orgText:e.orgText,definition:t(e.definition)};throw Error("non exhaustive match")}}}class ii{visit(t){const n=t;switch(n.constructor){case Ge:return this.visitNonTerminal(n);case We:return this.visitAlternative(n);case Ke:return this.visitOption(n);case Fn:return this.visitRepetitionMandatory(n);case jn:return this.visitRepetitionMandatoryWithSeparator(n);case En:return this.visitRepetitionWithSeparator(n);case ge:return this.visitRepetition(n);case kn:return this.visitAlternation(n);case Ht:return this.visitTerminal(n);case Di:return this.visitRule(n);default:throw Error("non exhaustive match")}}visitNonTerminal(t){}visitAlternative(t){}visitOption(t){}visitRepetition(t){}visitRepetitionMandatory(t){}visitRepetitionMandatoryWithSeparator(t){}visitRepetitionWithSeparator(t){}visitAlternation(t){}visitTerminal(t){}visitRule(t){}}function OS(e){return e instanceof We||e instanceof Ke||e instanceof ge||e instanceof Fn||e instanceof jn||e instanceof En||e instanceof Ht||e instanceof Di}function ra(e,t=[]){return e instanceof Ke||e instanceof ge||e instanceof En?!0:e instanceof kn?xl(e.definition,r=>ra(r,t)):e instanceof Ge&&Me(t,e)?!1:e instanceof $n?(e instanceof Ge&&t.push(e),bn(e.definition,r=>ra(r,t))):!1}function IS(e){return e instanceof kn}function zn(e){if(e instanceof Ge)return"SUBRULE";if(e instanceof Ke)return"OPTION";if(e instanceof kn)return"OR";if(e instanceof Fn)return"AT_LEAST_ONE";if(e instanceof jn)return"AT_LEAST_ONE_SEP";if(e instanceof En)return"MANY_SEP";if(e instanceof ge)return"MANY";if(e instanceof Ht)return"CONSUME";throw Error("non exhaustive match")}class ia{walk(t,n=[]){ut(t.definition,(r,i)=>{const s=Te(t.definition,i+1);if(r instanceof Ge)this.walkProdRef(r,s,n);else if(r instanceof Ht)this.walkTerminal(r,s,n);else if(r instanceof We)this.walkFlat(r,s,n);else if(r instanceof Ke)this.walkOption(r,s,n);else if(r instanceof Fn)this.walkAtLeastOne(r,s,n);else if(r instanceof jn)this.walkAtLeastOneSep(r,s,n);else if(r instanceof En)this.walkManySep(r,s,n);else if(r instanceof ge)this.walkMany(r,s,n);else if(r instanceof kn)this.walkOr(r,s,n);else throw Error("non exhaustive match")})}walkTerminal(t,n,r){}walkProdRef(t,n,r){}walkFlat(t,n,r){const i=n.concat(r);this.walk(t,i)}walkOption(t,n,r){const i=n.concat(r);this.walk(t,i)}walkAtLeastOne(t,n,r){const i=[new Ke({definition:t.definition})].concat(n,r);this.walk(t,i)}walkAtLeastOneSep(t,n,r){const i=fp(t,n,r);this.walk(t,i)}walkMany(t,n,r){const i=[new Ke({definition:t.definition})].concat(n,r);this.walk(t,i)}walkManySep(t,n,r){const i=fp(t,n,r);this.walk(t,i)}walkOr(t,n,r){const i=n.concat(r);ut(t.definition,s=>{const o=new We({definition:[s]});this.walk(o,i)})}}function fp(e,t,n){return[new Ke({definition:[new Ht({terminalType:e.separator})].concat(e.definition)})].concat(t,n)}function Is(e){if(e instanceof Ge)return Is(e.referencedRule);if(e instanceof Ht)return NS(e);if(OS(e))return xS(e);if(IS(e))return CS(e);throw Error("non exhaustive match")}function xS(e){let t=[];const n=e.definition;let r=0,i=n.length>r,s,o=!0;for(;i&&o;)s=n[r],o=ra(s),t=t.concat(Is(s)),r=r+1,i=n.length>r;return ea(t)}function CS(e){const t=et(e.definition,n=>Is(n));return ea(qe(t))}function NS(e){return[e.terminalType]}const dp="_~IN~_";class LS extends ia{constructor(t){super(),this.topProd=t,this.follows={}}startWalking(){return this.walk(this.topProd),this.follows}walkTerminal(t,n,r){}walkProdRef(t,n,r){const i=US(t.referencedRule,t.idx)+this.topProd.name,s=n.concat(r),o=new We({definition:s}),a=Is(o);this.follows[i]=a}}function MS(e){const t={};return ut(e,n=>{const r=new LS(n).startWalking();Fe(t,r)}),t}function US(e,t){return e.name+t+dp}function dt(e){return e.charCodeAt(0)}function Nl(e,t){Array.isArray(e)?e.forEach(function(n){t.push(n)}):t.push(e)}function xs(e,t){if(e[t]===!0)throw"duplicate flag "+t;e[t],e[t]=!0}function Pi(e){if(e===void 0)throw Error("Internal Error - Should never get here!");return!0}function DS(){throw Error("Internal Error - Should never get here!")}function pp(e){return e.type==="Character"}const sa=[];for(let e=dt("0");e<=dt("9");e++)sa.push(e);const oa=[dt("_")].concat(sa);for(let e=dt("a");e<=dt("z");e++)oa.push(e);for(let e=dt("A");e<=dt("Z");e++)oa.push(e);const mp=[dt(" "),dt("\f"),dt(`
`),dt("\r"),dt("	"),dt("\v"),dt("	"),dt(" "),dt(" "),dt(" "),dt(" "),dt(" "),dt(" "),dt(" "),dt(" "),dt(" "),dt(" "),dt(" "),dt(" "),dt(" "),dt("\u2028"),dt("\u2029"),dt(" "),dt(" "),dt("　"),dt("\uFEFF")],PS=/[0-9a-fA-F]/,aa=/[0-9]/,BS=/[1-9]/;class $S{constructor(){this.idx=0,this.input="",this.groupIdx=0}saveState(){return{idx:this.idx,input:this.input,groupIdx:this.groupIdx}}restoreState(t){this.idx=t.idx,this.input=t.input,this.groupIdx=t.groupIdx}pattern(t){this.idx=0,this.input=t,this.groupIdx=0,this.consumeChar("/");const n=this.disjunction();this.consumeChar("/");const r={type:"Flags",loc:{begin:this.idx,end:t.length},global:!1,ignoreCase:!1,multiLine:!1,unicode:!1,sticky:!1};for(;this.isRegExpFlag();)switch(this.popChar()){case"g":xs(r,"global");break;case"i":xs(r,"ignoreCase");break;case"m":xs(r,"multiLine");break;case"u":xs(r,"unicode");break;case"y":xs(r,"sticky");break}if(this.idx!==this.input.length)throw Error("Redundant input: "+this.input.substring(this.idx));return{type:"Pattern",flags:r,value:n,loc:this.loc(0)}}disjunction(){const t=[],n=this.idx;for(t.push(this.alternative());this.peekChar()==="|";)this.consumeChar("|"),t.push(this.alternative());return{type:"Disjunction",value:t,loc:this.loc(n)}}alternative(){const t=[],n=this.idx;for(;this.isTerm();)t.push(this.term());return{type:"Alternative",value:t,loc:this.loc(n)}}term(){return this.isAssertion()?this.assertion():this.atom()}assertion(){const t=this.idx;switch(this.popChar()){case"^":return{type:"StartAnchor",loc:this.loc(t)};case"$":return{type:"EndAnchor",loc:this.loc(t)};case"\\":switch(this.popChar()){case"b":return{type:"WordBoundary",loc:this.loc(t)};case"B":return{type:"NonWordBoundary",loc:this.loc(t)}}throw Error("Invalid Assertion Escape");case"(":this.consumeChar("?");let n;switch(this.popChar()){case"=":n="Lookahead";break;case"!":n="NegativeLookahead";break}Pi(n);const r=this.disjunction();return this.consumeChar(")"),{type:n,value:r,loc:this.loc(t)}}return DS()}quantifier(t=!1){let n;const r=this.idx;switch(this.popChar()){case"*":n={atLeast:0,atMost:1/0};break;case"+":n={atLeast:1,atMost:1/0};break;case"?":n={atLeast:0,atMost:1};break;case"{":const i=this.integerIncludingZero();switch(this.popChar()){case"}":n={atLeast:i,atMost:i};break;case",":let s;this.isDigit()?(s=this.integerIncludingZero(),n={atLeast:i,atMost:s}):n={atLeast:i,atMost:1/0},this.consumeChar("}");break}if(t===!0&&n===void 0)return;Pi(n);break}if(!(t===!0&&n===void 0)&&Pi(n))return this.peekChar(0)==="?"?(this.consumeChar("?"),n.greedy=!1):n.greedy=!0,n.type="Quantifier",n.loc=this.loc(r),n}atom(){let t;const n=this.idx;switch(this.peekChar()){case".":t=this.dotAll();break;case"\\":t=this.atomEscape();break;case"[":t=this.characterClass();break;case"(":t=this.group();break}if(t===void 0&&this.isPatternCharacter()&&(t=this.patternCharacter()),Pi(t))return t.loc=this.loc(n),this.isQuantifier()&&(t.quantifier=this.quantifier()),t}dotAll(){return this.consumeChar("."),{type:"Set",complement:!0,value:[dt(`
`),dt("\r"),dt("\u2028"),dt("\u2029")]}}atomEscape(){switch(this.consumeChar("\\"),this.peekChar()){case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":return this.decimalEscapeAtom();case"d":case"D":case"s":case"S":case"w":case"W":return this.characterClassEscape();case"f":case"n":case"r":case"t":case"v":return this.controlEscapeAtom();case"c":return this.controlLetterEscapeAtom();case"0":return this.nulCharacterAtom();case"x":return this.hexEscapeSequenceAtom();case"u":return this.regExpUnicodeEscapeSequenceAtom();default:return this.identityEscapeAtom()}}decimalEscapeAtom(){return{type:"GroupBackReference",value:this.positiveInteger()}}characterClassEscape(){let t,n=!1;switch(this.popChar()){case"d":t=sa;break;case"D":t=sa,n=!0;break;case"s":t=mp;break;case"S":t=mp,n=!0;break;case"w":t=oa;break;case"W":t=oa,n=!0;break}if(Pi(t))return{type:"Set",value:t,complement:n}}controlEscapeAtom(){let t;switch(this.popChar()){case"f":t=dt("\f");break;case"n":t=dt(`
`);break;case"r":t=dt("\r");break;case"t":t=dt("	");break;case"v":t=dt("\v");break}if(Pi(t))return{type:"Character",value:t}}controlLetterEscapeAtom(){this.consumeChar("c");const t=this.popChar();if(/[a-zA-Z]/.test(t)===!1)throw Error("Invalid ");return{type:"Character",value:t.toUpperCase().charCodeAt(0)-64}}nulCharacterAtom(){return this.consumeChar("0"),{type:"Character",value:dt("\0")}}hexEscapeSequenceAtom(){return this.consumeChar("x"),this.parseHexDigits(2)}regExpUnicodeEscapeSequenceAtom(){return this.consumeChar("u"),this.parseHexDigits(4)}identityEscapeAtom(){const t=this.popChar();return{type:"Character",value:dt(t)}}classPatternCharacterAtom(){switch(this.peekChar()){case`
`:case"\r":case"\u2028":case"\u2029":case"\\":case"]":throw Error("TBD");default:const t=this.popChar();return{type:"Character",value:dt(t)}}}characterClass(){const t=[];let n=!1;for(this.consumeChar("["),this.peekChar(0)==="^"&&(this.consumeChar("^"),n=!0);this.isClassAtom();){const r=this.classAtom();if(r.type,pp(r)&&this.isRangeDash()){this.consumeChar("-");const i=this.classAtom();if(i.type,pp(i)){if(i.value<r.value)throw Error("Range out of order in character class");t.push({from:r.value,to:i.value})}else Nl(r.value,t),t.push(dt("-")),Nl(i.value,t)}else Nl(r.value,t)}return this.consumeChar("]"),{type:"Set",complement:n,value:t}}classAtom(){switch(this.peekChar()){case"]":case`
`:case"\r":case"\u2028":case"\u2029":throw Error("TBD");case"\\":return this.classEscape();default:return this.classPatternCharacterAtom()}}classEscape(){switch(this.consumeChar("\\"),this.peekChar()){case"b":return this.consumeChar("b"),{type:"Character",value:dt("\b")};case"d":case"D":case"s":case"S":case"w":case"W":return this.characterClassEscape();case"f":case"n":case"r":case"t":case"v":return this.controlEscapeAtom();case"c":return this.controlLetterEscapeAtom();case"0":return this.nulCharacterAtom();case"x":return this.hexEscapeSequenceAtom();case"u":return this.regExpUnicodeEscapeSequenceAtom();default:return this.identityEscapeAtom()}}group(){let t=!0;switch(this.consumeChar("("),this.peekChar(0)){case"?":this.consumeChar("?"),this.consumeChar(":"),t=!1;break;default:this.groupIdx++;break}const n=this.disjunction();this.consumeChar(")");const r={type:"Group",capturing:t,value:n};return t&&(r.idx=this.groupIdx),r}positiveInteger(){let t=this.popChar();if(BS.test(t)===!1)throw Error("Expecting a positive integer");for(;aa.test(this.peekChar(0));)t+=this.popChar();return parseInt(t,10)}integerIncludingZero(){let t=this.popChar();if(aa.test(t)===!1)throw Error("Expecting an integer");for(;aa.test(this.peekChar(0));)t+=this.popChar();return parseInt(t,10)}patternCharacter(){const t=this.popChar();switch(t){case`
`:case"\r":case"\u2028":case"\u2029":case"^":case"$":case"\\":case".":case"*":case"+":case"?":case"(":case")":case"[":case"|":throw Error("TBD");default:return{type:"Character",value:dt(t)}}}isRegExpFlag(){switch(this.peekChar(0)){case"g":case"i":case"m":case"u":case"y":return!0;default:return!1}}isRangeDash(){return this.peekChar()==="-"&&this.isClassAtom(1)}isDigit(){return aa.test(this.peekChar(0))}isClassAtom(t=0){switch(this.peekChar(t)){case"]":case`
`:case"\r":case"\u2028":case"\u2029":return!1;default:return!0}}isTerm(){return this.isAtom()||this.isAssertion()}isAtom(){if(this.isPatternCharacter())return!0;switch(this.peekChar(0)){case".":case"\\":case"[":case"(":return!0;default:return!1}}isAssertion(){switch(this.peekChar(0)){case"^":case"$":return!0;case"\\":switch(this.peekChar(1)){case"b":case"B":return!0;default:return!1}case"(":return this.peekChar(1)==="?"&&(this.peekChar(2)==="="||this.peekChar(2)==="!");default:return!1}}isQuantifier(){const t=this.saveState();try{return this.quantifier(!0)!==void 0}catch{return!1}finally{this.restoreState(t)}}isPatternCharacter(){switch(this.peekChar()){case"^":case"$":case"\\":case".":case"*":case"+":case"?":case"(":case")":case"[":case"|":case"/":case`
`:case"\r":case"\u2028":case"\u2029":return!1;default:return!0}}parseHexDigits(t){let n="";for(let i=0;i<t;i++){const s=this.popChar();if(PS.test(s)===!1)throw Error("Expecting a HexDecimal digits");n+=s}return{type:"Character",value:parseInt(n,16)}}peekChar(t=0){return this.input[this.idx+t]}popChar(){const t=this.peekChar(0);return this.consumeChar(void 0),t}consumeChar(t){if(t!==void 0&&this.input[this.idx]!==t)throw Error("Expected: '"+t+"' but found: '"+this.input[this.idx]+"' at offset: "+this.idx);if(this.idx>=this.input.length)throw Error("Unexpected end of input");this.idx++}loc(t){return{begin:t,end:this.idx}}}class Ll{visitChildren(t){for(const n in t){const r=t[n];t.hasOwnProperty(n)&&(r.type!==void 0?this.visit(r):Array.isArray(r)&&r.forEach(i=>{this.visit(i)},this))}}visit(t){switch(t.type){case"Pattern":this.visitPattern(t);break;case"Flags":this.visitFlags(t);break;case"Disjunction":this.visitDisjunction(t);break;case"Alternative":this.visitAlternative(t);break;case"StartAnchor":this.visitStartAnchor(t);break;case"EndAnchor":this.visitEndAnchor(t);break;case"WordBoundary":this.visitWordBoundary(t);break;case"NonWordBoundary":this.visitNonWordBoundary(t);break;case"Lookahead":this.visitLookahead(t);break;case"NegativeLookahead":this.visitNegativeLookahead(t);break;case"Character":this.visitCharacter(t);break;case"Set":this.visitSet(t);break;case"Group":this.visitGroup(t);break;case"GroupBackReference":this.visitGroupBackReference(t);break;case"Quantifier":this.visitQuantifier(t);break}this.visitChildren(t)}visitPattern(t){}visitFlags(t){}visitDisjunction(t){}visitAlternative(t){}visitStartAnchor(t){}visitEndAnchor(t){}visitWordBoundary(t){}visitNonWordBoundary(t){}visitLookahead(t){}visitNegativeLookahead(t){}visitCharacter(t){}visitSet(t){}visitGroup(t){}visitGroupBackReference(t){}visitQuantifier(t){}}let ca={};const FS=new $S;function la(e){const t=e.toString();if(ca.hasOwnProperty(t))return ca[t];{const n=FS.pattern(t);return ca[t]=n,n}}function jS(){ca={}}const gp="Complement Sets are not supported for first char optimization",ua=`Unable to use "first char" lexer optimizations:
`;function zS(e,t=!1){try{const n=la(e);return Ml(n.value,{},n.flags.ignoreCase)}catch(n){if(n.message===gp)t&&lp(`${ua}	Unable to optimize: < ${e.toString()} >
	Complement Sets cannot be automatically optimized.
	This will disable the lexer's first char optimizations.
	See: https://chevrotain.io/docs/guide/resolving_lexer_errors.html#COMPLEMENT for details.`);else{let r="";t&&(r=`
	This will disable the lexer's first char optimizations.
	See: https://chevrotain.io/docs/guide/resolving_lexer_errors.html#REGEXP_PARSING for details.`),Cl(`${ua}
	Failed parsing: < ${e.toString()} >
	Using the @chevrotain/regexp-to-ast library
	Please open an issue at: https://github.com/chevrotain/chevrotain/issues`+r)}}return[]}function Ml(e,t,n){switch(e.type){case"Disjunction":for(let i=0;i<e.value.length;i++)Ml(e.value[i],t,n);break;case"Alternative":const r=e.value;for(let i=0;i<r.length;i++){const s=r[i];switch(s.type){case"EndAnchor":case"GroupBackReference":case"Lookahead":case"NegativeLookahead":case"StartAnchor":case"WordBoundary":case"NonWordBoundary":continue}const o=s;switch(o.type){case"Character":ha(o.value,t,n);break;case"Set":if(o.complement===!0)throw Error(gp);ut(o.value,c=>{if(typeof c=="number")ha(c,t,n);else{const l=c;if(n===!0)for(let u=l.from;u<=l.to;u++)ha(u,t,n);else{for(let u=l.from;u<=l.to&&u<Ns;u++)ha(u,t,n);if(l.to>=Ns){const u=l.from>=Ns?l.from:Ns,f=l.to,d=xr(u),h=xr(f);for(let p=d;p<=h;p++)t[p]=p}}}});break;case"Group":Ml(o.value,t,n);break;default:throw Error("Non Exhaustive Match")}const a=o.quantifier!==void 0&&o.quantifier.atLeast===0;if(o.type==="Group"&&Ul(o)===!1||o.type!=="Group"&&a===!1)break}break;default:throw Error("non exhaustive match!")}return oe(t)}function ha(e,t,n){const r=xr(e);t[r]=r,n===!0&&GS(e,t)}function GS(e,t){const n=String.fromCharCode(e),r=n.toUpperCase();if(r!==n){const i=xr(r.charCodeAt(0));t[i]=i}else{const i=n.toLowerCase();if(i!==n){const s=xr(i.charCodeAt(0));t[s]=s}}}function yp(e,t){return Ui(e.value,n=>{if(typeof n=="number")return Me(t,n);{const r=n;return Ui(t,i=>r.from<=i&&i<=r.to)!==void 0}})}function Ul(e){const t=e.quantifier;return t&&t.atLeast===0?!0:e.value?St(e.value)?bn(e.value,Ul):Ul(e.value):!1}class WS extends Ll{constructor(t){super(),this.targetCharCodes=t,this.found=!1}visitChildren(t){if(this.found!==!0){switch(t.type){case"Lookahead":this.visitLookahead(t);return;case"NegativeLookahead":this.visitNegativeLookahead(t);return}super.visitChildren(t)}}visitCharacter(t){Me(this.targetCharCodes,t.value)&&(this.found=!0)}visitSet(t){t.complement?yp(t,this.targetCharCodes)===void 0&&(this.found=!0):yp(t,this.targetCharCodes)!==void 0&&(this.found=!0)}}function Dl(e,t){if(t instanceof RegExp){const n=la(t),r=new WS(e);return r.visit(n),r.found}else return Ui(t,n=>Me(e,n.charCodeAt(0)))!==void 0}const si="PATTERN",Cs="defaultMode",fa="modes";let _p=typeof new RegExp("(?:)").sticky=="boolean";function KS(e,t){t=Il(t,{useSticky:_p,debug:!1,safeMode:!1,positionTracking:"full",lineTerminatorCharacters:["\r",`
`],tracer:(y,A)=>A()});const n=t.tracer;n("initCharCodeToOptimizedIndexMap",()=>{pT()});let r;n("Reject Lexer.NA",()=>{r=ta(e,y=>y[si]===ye.NA)});let i=!1,s;n("Transform Patterns",()=>{i=!1,s=et(r,y=>{const A=y[si];if(hr(A)){const I=A.source;return I.length===1&&I!=="^"&&I!=="$"&&I!=="."&&!A.ignoreCase?I:I.length===2&&I[0]==="\\"&&!Me(["d","D","s","S","t","r","n","t","0","c","b","B","f","v","w","W"],I[1])?I[1]:t.useSticky?wp(A):bp(A)}else{if(cr(A))return i=!0,{exec:A};if(typeof A=="object")return i=!0,A;if(typeof A=="string"){if(A.length===1)return A;{const I=A.replace(/[\\^$.*+?()[\]{}|]/g,"\\$&"),k=new RegExp(I);return t.useSticky?wp(k):bp(k)}}else throw Error("non exhaustive match")}})});let o,a,c,l,u;n("misc mapping",()=>{o=et(r,y=>y.tokenTypeIdx),a=et(r,y=>{const A=y.GROUP;if(A!==ye.SKIPPED){if(je(A))return A;if(fr(A))return!1;throw Error("non exhaustive match")}}),c=et(r,y=>{const A=y.LONGER_ALT;if(A)return St(A)?et(A,k=>ap(r,k)):[ap(r,A)]}),l=et(r,y=>y.PUSH_MODE),u=et(r,y=>lt(y,"POP_MODE"))});let f;n("Line Terminator Handling",()=>{const y=kp(t.lineTerminatorCharacters);f=et(r,A=>!1),t.positionTracking!=="onlyOffset"&&(f=et(r,A=>lt(A,"LINE_BREAKS")?!!A.LINE_BREAKS:Ep(A,y)===!1&&Dl(y,A.PATTERN)))});let d,h,p,m;n("Misc Mapping #2",()=>{d=et(r,vp),h=et(s,hT),p=ze(r,(y,A)=>{const I=A.GROUP;return je(I)&&I!==ye.SKIPPED&&(y[I]=[]),y},{}),m=et(s,(y,A)=>({pattern:s[A],longerAlt:c[A],canLineTerminator:f[A],isCustom:d[A],short:h[A],group:a[A],push:l[A],pop:u[A],tokenTypeIdx:o[A],tokenType:r[A]}))});let v=!0,b=[];return t.safeMode||n("First Char Optimization",()=>{b=ze(r,(y,A,I)=>{if(typeof A.PATTERN=="string"){const k=A.PATTERN.charCodeAt(0),E=xr(k);Pl(y,E,m[I])}else if(St(A.START_CHARS_HINT)){let k;ut(A.START_CHARS_HINT,E=>{const w=typeof E=="string"?E.charCodeAt(0):E,S=xr(w);k!==S&&(k=S,Pl(y,S,m[I]))})}else if(hr(A.PATTERN))if(A.PATTERN.unicode)v=!1,t.ensureOptimizations&&Cl(`${ua}	Unable to analyze < ${A.PATTERN.toString()} > pattern.
	The regexp unicode flag is not currently supported by the regexp-to-ast library.
	This will disable the lexer's first char optimizations.
	For details See: https://chevrotain.io/docs/guide/resolving_lexer_errors.html#UNICODE_OPTIMIZE`);else{const k=zS(A.PATTERN,t.ensureOptimizations);Ut(k)&&(v=!1),ut(k,E=>{Pl(y,E,m[I])})}else t.ensureOptimizations&&Cl(`${ua}	TokenType: <${A.name}> is using a custom token pattern without providing <start_chars_hint> parameter.
	This will disable the lexer's first char optimizations.
	For details See: https://chevrotain.io/docs/guide/resolving_lexer_errors.html#CUSTOM_OPTIMIZE`),v=!1;return y},[])}),{emptyGroups:p,patternIdxToConfig:m,charCodeToPatternIdxToConfig:b,hasCustom:i,canBeOptimized:v}}function HS(e,t){let n=[];const r=YS(e);n=n.concat(r.errors);const i=qS(r.valid),s=i.valid;return n=n.concat(i.errors),n=n.concat(VS(s)),n=n.concat(rT(s)),n=n.concat(iT(s,t)),n=n.concat(sT(s)),n}function VS(e){let t=[];const n=an(e,r=>hr(r[si]));return t=t.concat(XS(n)),t=t.concat(tT(n)),t=t.concat(eT(n)),t=t.concat(nT(n)),t=t.concat(ZS(n)),t}function YS(e){const t=an(e,i=>!lt(i,si)),n=et(t,i=>({message:"Token Type: ->"+i.name+"<- missing static 'PATTERN' property",type:qt.MISSING_PATTERN,tokenTypes:[i]})),r=Qo(e,t);return{errors:n,valid:r}}function qS(e){const t=an(e,i=>{const s=i[si];return!hr(s)&&!cr(s)&&!lt(s,"exec")&&!je(s)}),n=et(t,i=>({message:"Token Type: ->"+i.name+"<- static 'PATTERN' can only be a RegExp, a Function matching the {CustomPatternMatcherFunc} type or an Object matching the {ICustomPattern} interface.",type:qt.INVALID_PATTERN,tokenTypes:[i]})),r=Qo(e,t);return{errors:n,valid:r}}const JS=/[^\\][$]/;function XS(e){class t extends Ll{constructor(){super(...arguments),this.found=!1}visitEndAnchor(s){this.found=!0}}const n=an(e,i=>{const s=i.PATTERN;try{const o=la(s),a=new t;return a.visit(o),a.found}catch{return JS.test(s.source)}});return et(n,i=>({message:`Unexpected RegExp Anchor Error:
	Token Type: ->`+i.name+`<- static 'PATTERN' cannot contain end of input anchor '$'
	See chevrotain.io/docs/guide/resolving_lexer_errors.html#ANCHORS	for details.`,type:qt.EOI_ANCHOR_FOUND,tokenTypes:[i]}))}function ZS(e){const t=an(e,r=>r.PATTERN.test(""));return et(t,r=>({message:"Token Type: ->"+r.name+"<- static 'PATTERN' must not match an empty string",type:qt.EMPTY_MATCH_PATTERN,tokenTypes:[r]}))}const QS=/[^\\[][\^]|^\^/;function tT(e){class t extends Ll{constructor(){super(...arguments),this.found=!1}visitStartAnchor(s){this.found=!0}}const n=an(e,i=>{const s=i.PATTERN;try{const o=la(s),a=new t;return a.visit(o),a.found}catch{return QS.test(s.source)}});return et(n,i=>({message:`Unexpected RegExp Anchor Error:
	Token Type: ->`+i.name+`<- static 'PATTERN' cannot contain start of input anchor '^'
	See https://chevrotain.io/docs/guide/resolving_lexer_errors.html#ANCHORS	for details.`,type:qt.SOI_ANCHOR_FOUND,tokenTypes:[i]}))}function eT(e){const t=an(e,r=>{const i=r[si];return i instanceof RegExp&&(i.multiline||i.global)});return et(t,r=>({message:"Token Type: ->"+r.name+"<- static 'PATTERN' may NOT contain global('g') or multiline('m')",type:qt.UNSUPPORTED_FLAGS_FOUND,tokenTypes:[r]}))}function nT(e){const t=[];let n=et(e,s=>ze(e,(o,a)=>(s.PATTERN.source===a.PATTERN.source&&!Me(t,a)&&a.PATTERN!==ye.NA&&(t.push(a),o.push(a)),o),[]));n=Rs(n);const r=an(n,s=>s.length>1);return et(r,s=>{const o=et(s,c=>c.name);return{message:`The same RegExp pattern ->${wn(s).PATTERN}<-has been used in all of the following Token Types: ${o.join(", ")} <-`,type:qt.DUPLICATE_PATTERNS_FOUND,tokenTypes:s}})}function rT(e){const t=an(e,r=>{if(!lt(r,"GROUP"))return!1;const i=r.GROUP;return i!==ye.SKIPPED&&i!==ye.NA&&!je(i)});return et(t,r=>({message:"Token Type: ->"+r.name+"<- static 'GROUP' can only be Lexer.SKIPPED/Lexer.NA/A String",type:qt.INVALID_GROUP_TYPE_FOUND,tokenTypes:[r]}))}function iT(e,t){const n=an(e,i=>i.PUSH_MODE!==void 0&&!Me(t,i.PUSH_MODE));return et(n,i=>({message:`Token Type: ->${i.name}<- static 'PUSH_MODE' value cannot refer to a Lexer Mode ->${i.PUSH_MODE}<-which does not exist`,type:qt.PUSH_MODE_DOES_NOT_EXIST,tokenTypes:[i]}))}function sT(e){const t=[],n=ze(e,(r,i,s)=>{const o=i.PATTERN;return o===ye.NA||(je(o)?r.push({str:o,idx:s,tokenType:i}):hr(o)&&aT(o)&&r.push({str:o.source,idx:s,tokenType:i})),r},[]);return ut(e,(r,i)=>{ut(n,({str:s,idx:o,tokenType:a})=>{if(i<o&&oT(s,r.PATTERN)){const c=`Token: ->${a.name}<- can never be matched.
Because it appears AFTER the Token Type ->${r.name}<-in the lexer's definition.
See https://chevrotain.io/docs/guide/resolving_lexer_errors.html#UNREACHABLE`;t.push({message:c,type:qt.UNREACHABLE_PATTERN,tokenTypes:[r,a]})}})}),t}function oT(e,t){if(hr(t)){const n=t.exec(e);return n!==null&&n.index===0}else{if(cr(t))return t(e,0,[],{});if(lt(t,"exec"))return t.exec(e,0,[],{});if(typeof t=="string")return t===e;throw Error("non exhaustive match")}}function aT(e){return Ui([".","\\","[","]","|","^","$","(",")","?","*","+","{"],n=>e.source.indexOf(n)!==-1)===void 0}function bp(e){const t=e.ignoreCase?"i":"";return new RegExp(`^(?:${e.source})`,t)}function wp(e){const t=e.ignoreCase?"iy":"y";return new RegExp(`${e.source}`,t)}function cT(e,t,n){const r=[];return lt(e,Cs)||r.push({message:"A MultiMode Lexer cannot be initialized without a <"+Cs+`> property in its definition
`,type:qt.MULTI_MODE_LEXER_WITHOUT_DEFAULT_MODE}),lt(e,fa)||r.push({message:"A MultiMode Lexer cannot be initialized without a <"+fa+`> property in its definition
`,type:qt.MULTI_MODE_LEXER_WITHOUT_MODES_PROPERTY}),lt(e,fa)&&lt(e,Cs)&&!lt(e.modes,e.defaultMode)&&r.push({message:`A MultiMode Lexer cannot be initialized with a ${Cs}: <${e.defaultMode}>which does not exist
`,type:qt.MULTI_MODE_LEXER_DEFAULT_MODE_VALUE_DOES_NOT_EXIST}),lt(e,fa)&&ut(e.modes,(i,s)=>{ut(i,(o,a)=>{if(fr(o))r.push({message:`A Lexer cannot be initialized using an undefined Token Type. Mode:<${s}> at index: <${a}>
`,type:qt.LEXER_DEFINITION_CANNOT_CONTAIN_UNDEFINED});else if(lt(o,"LONGER_ALT")){const c=St(o.LONGER_ALT)?o.LONGER_ALT:[o.LONGER_ALT];ut(c,l=>{!fr(l)&&!Me(i,l)&&r.push({message:`A MultiMode Lexer cannot be initialized with a longer_alt <${l.name}> on token <${o.name}> outside of mode <${s}>
`,type:qt.MULTI_MODE_LEXER_LONGER_ALT_NOT_IN_CURRENT_MODE})})}})}),r}function lT(e,t,n){const r=[];let i=!1;const s=Rs(qe(oe(e.modes))),o=ta(s,c=>c[si]===ye.NA),a=kp(n);return t&&ut(o,c=>{const l=Ep(c,a);if(l!==!1){const f={message:dT(c,l),type:l.issue,tokenType:c};r.push(f)}else lt(c,"LINE_BREAKS")?c.LINE_BREAKS===!0&&(i=!0):Dl(a,c.PATTERN)&&(i=!0)}),t&&!i&&r.push({message:`Warning: No LINE_BREAKS Found.
	This Lexer has been defined to track line and column information,
	But none of the Token Types can be identified as matching a line terminator.
	See https://chevrotain.io/docs/guide/resolving_lexer_errors.html#LINE_BREAKS 
	for details.`,type:qt.NO_LINE_BREAKS_FLAGS}),r}function uT(e){const t={},n=sn(e);return ut(n,r=>{const i=e[r];if(St(i))t[r]=[];else throw Error("non exhaustive match")}),t}function vp(e){const t=e.PATTERN;if(hr(t))return!1;if(cr(t))return!0;if(lt(t,"exec"))return!0;if(je(t))return!1;throw Error("non exhaustive match")}function hT(e){return je(e)&&e.length===1?e.charCodeAt(0):!1}const fT={test:function(e){const t=e.length;for(let n=this.lastIndex;n<t;n++){const r=e.charCodeAt(n);if(r===10)return this.lastIndex=n+1,!0;if(r===13)return e.charCodeAt(n+1)===10?this.lastIndex=n+2:this.lastIndex=n+1,!0}return!1},lastIndex:0};function Ep(e,t){if(lt(e,"LINE_BREAKS"))return!1;if(hr(e.PATTERN)){try{Dl(t,e.PATTERN)}catch(n){return{issue:qt.IDENTIFY_TERMINATOR,errMsg:n.message}}return!1}else{if(je(e.PATTERN))return!1;if(vp(e))return{issue:qt.CUSTOM_LINE_BREAK};throw Error("non exhaustive match")}}function dT(e,t){if(t.issue===qt.IDENTIFY_TERMINATOR)return`Warning: unable to identify line terminator usage in pattern.
	The problem is in the <${e.name}> Token Type
	 Root cause: ${t.errMsg}.
	For details See: https://chevrotain.io/docs/guide/resolving_lexer_errors.html#IDENTIFY_TERMINATOR`;if(t.issue===qt.CUSTOM_LINE_BREAK)return`Warning: A Custom Token Pattern should specify the <line_breaks> option.
	The problem is in the <${e.name}> Token Type
	For details See: https://chevrotain.io/docs/guide/resolving_lexer_errors.html#CUSTOM_LINE_BREAK`;throw Error("non exhaustive match")}function kp(e){return et(e,n=>je(n)?n.charCodeAt(0):n)}function Pl(e,t,n){e[t]===void 0?e[t]=[n]:e[t].push(n)}const Ns=256;let da=[];function xr(e){return e<Ns?e:da[e]}function pT(){if(Ut(da)){da=new Array(65536);for(let e=0;e<65536;e++)da[e]=e>255?255+~~(e/255):e}}function Ls(e,t){const n=e.tokenTypeIdx;return n===t.tokenTypeIdx?!0:t.isParent===!0&&t.categoryMatchesMap[n]===!0}function pa(e,t){return e.tokenTypeIdx===t.tokenTypeIdx}let Ap=1;const Sp={};function Ms(e){const t=mT(e);gT(t),_T(t),yT(t),ut(t,n=>{n.isParent=n.categoryMatches.length>0})}function mT(e){let t=Se(e),n=e,r=!0;for(;r;){n=Rs(qe(et(n,s=>s.CATEGORIES)));const i=Qo(n,t);t=t.concat(i),Ut(i)?r=!1:n=i}return t}function gT(e){ut(e,t=>{Rp(t)||(Sp[Ap]=t,t.tokenTypeIdx=Ap++),Op(t)&&!St(t.CATEGORIES)&&(t.CATEGORIES=[t.CATEGORIES]),Op(t)||(t.CATEGORIES=[]),bT(t)||(t.categoryMatches=[]),wT(t)||(t.categoryMatchesMap={})})}function yT(e){ut(e,t=>{t.categoryMatches=[],ut(t.categoryMatchesMap,(n,r)=>{t.categoryMatches.push(Sp[r].tokenTypeIdx)})})}function _T(e){ut(e,t=>{Tp([],t)})}function Tp(e,t){ut(e,n=>{t.categoryMatchesMap[n.tokenTypeIdx]=!0}),ut(t.CATEGORIES,n=>{const r=e.concat(t);Me(r,n)||Tp(r,n)})}function Rp(e){return lt(e,"tokenTypeIdx")}function Op(e){return lt(e,"CATEGORIES")}function bT(e){return lt(e,"categoryMatches")}function wT(e){return lt(e,"categoryMatchesMap")}function vT(e){return lt(e,"tokenTypeIdx")}const ET={buildUnableToPopLexerModeMessage(e){return`Unable to pop Lexer Mode after encountering Token ->${e.image}<- The Mode Stack is empty`},buildUnexpectedCharactersMessage(e,t,n,r,i){return`unexpected character: ->${e.charAt(t)}<- at offset: ${t}, skipped ${n} characters.`}};var qt;(function(e){e[e.MISSING_PATTERN=0]="MISSING_PATTERN",e[e.INVALID_PATTERN=1]="INVALID_PATTERN",e[e.EOI_ANCHOR_FOUND=2]="EOI_ANCHOR_FOUND",e[e.UNSUPPORTED_FLAGS_FOUND=3]="UNSUPPORTED_FLAGS_FOUND",e[e.DUPLICATE_PATTERNS_FOUND=4]="DUPLICATE_PATTERNS_FOUND",e[e.INVALID_GROUP_TYPE_FOUND=5]="INVALID_GROUP_TYPE_FOUND",e[e.PUSH_MODE_DOES_NOT_EXIST=6]="PUSH_MODE_DOES_NOT_EXIST",e[e.MULTI_MODE_LEXER_WITHOUT_DEFAULT_MODE=7]="MULTI_MODE_LEXER_WITHOUT_DEFAULT_MODE",e[e.MULTI_MODE_LEXER_WITHOUT_MODES_PROPERTY=8]="MULTI_MODE_LEXER_WITHOUT_MODES_PROPERTY",e[e.MULTI_MODE_LEXER_DEFAULT_MODE_VALUE_DOES_NOT_EXIST=9]="MULTI_MODE_LEXER_DEFAULT_MODE_VALUE_DOES_NOT_EXIST",e[e.LEXER_DEFINITION_CANNOT_CONTAIN_UNDEFINED=10]="LEXER_DEFINITION_CANNOT_CONTAIN_UNDEFINED",e[e.SOI_ANCHOR_FOUND=11]="SOI_ANCHOR_FOUND",e[e.EMPTY_MATCH_PATTERN=12]="EMPTY_MATCH_PATTERN",e[e.NO_LINE_BREAKS_FLAGS=13]="NO_LINE_BREAKS_FLAGS",e[e.UNREACHABLE_PATTERN=14]="UNREACHABLE_PATTERN",e[e.IDENTIFY_TERMINATOR=15]="IDENTIFY_TERMINATOR",e[e.CUSTOM_LINE_BREAK=16]="CUSTOM_LINE_BREAK",e[e.MULTI_MODE_LEXER_LONGER_ALT_NOT_IN_CURRENT_MODE=17]="MULTI_MODE_LEXER_LONGER_ALT_NOT_IN_CURRENT_MODE"})(qt||(qt={}));const Us={deferDefinitionErrorsHandling:!1,positionTracking:"full",lineTerminatorsPattern:/\n|\r\n?/g,lineTerminatorCharacters:[`
`,"\r"],ensureOptimizations:!1,safeMode:!1,errorMessageProvider:ET,traceInitPerf:!1,skipValidations:!1,recoveryEnabled:!0};Object.freeze(Us);class ye{constructor(t,n=Us){if(this.lexerDefinition=t,this.lexerDefinitionErrors=[],this.lexerDefinitionWarning=[],this.patternIdxToConfig={},this.charCodeToPatternIdxToConfig={},this.modes=[],this.emptyGroups={},this.trackStartLines=!0,this.trackEndLines=!0,this.hasCustom=!1,this.canModeBeOptimized={},this.TRACE_INIT=(i,s)=>{if(this.traceInitPerf===!0){this.traceInitIndent++;const o=new Array(this.traceInitIndent+1).join("	");this.traceInitIndent<this.traceInitMaxIdent&&console.log(`${o}--> <${i}>`);const{time:a,value:c}=up(s),l=a>10?console.warn:console.log;return this.traceInitIndent<this.traceInitMaxIdent&&l(`${o}<-- <${i}> time: ${a}ms`),this.traceInitIndent--,c}else return s()},typeof n=="boolean")throw Error(`The second argument to the Lexer constructor is now an ILexerConfig Object.
a boolean 2nd argument is no longer supported`);this.config=Fe({},Us,n);const r=this.config.traceInitPerf;r===!0?(this.traceInitMaxIdent=1/0,this.traceInitPerf=!0):typeof r=="number"&&(this.traceInitMaxIdent=r,this.traceInitPerf=!0),this.traceInitIndent=-1,this.TRACE_INIT("Lexer Constructor",()=>{let i,s=!0;this.TRACE_INIT("Lexer Config handling",()=>{if(this.config.lineTerminatorsPattern===Us.lineTerminatorsPattern)this.config.lineTerminatorsPattern=fT;else if(this.config.lineTerminatorCharacters===Us.lineTerminatorCharacters)throw Error(`Error: Missing <lineTerminatorCharacters> property on the Lexer config.
	For details See: https://chevrotain.io/docs/guide/resolving_lexer_errors.html#MISSING_LINE_TERM_CHARS`);if(n.safeMode&&n.ensureOptimizations)throw Error('"safeMode" and "ensureOptimizations" flags are mutually exclusive.');this.trackStartLines=/full|onlyStart/i.test(this.config.positionTracking),this.trackEndLines=/full/i.test(this.config.positionTracking),St(t)?i={modes:{defaultMode:Se(t)},defaultMode:Cs}:(s=!1,i=Se(t))}),this.config.skipValidations===!1&&(this.TRACE_INIT("performRuntimeChecks",()=>{this.lexerDefinitionErrors=this.lexerDefinitionErrors.concat(cT(i,this.trackStartLines,this.config.lineTerminatorCharacters))}),this.TRACE_INIT("performWarningRuntimeChecks",()=>{this.lexerDefinitionWarning=this.lexerDefinitionWarning.concat(lT(i,this.trackStartLines,this.config.lineTerminatorCharacters))})),i.modes=i.modes?i.modes:{},ut(i.modes,(a,c)=>{i.modes[c]=ta(a,l=>fr(l))});const o=sn(i.modes);if(ut(i.modes,(a,c)=>{this.TRACE_INIT(`Mode: <${c}> processing`,()=>{if(this.modes.push(c),this.config.skipValidations===!1&&this.TRACE_INIT("validatePatterns",()=>{this.lexerDefinitionErrors=this.lexerDefinitionErrors.concat(HS(a,o))}),Ut(this.lexerDefinitionErrors)){Ms(a);let l;this.TRACE_INIT("analyzeTokenTypes",()=>{l=KS(a,{lineTerminatorCharacters:this.config.lineTerminatorCharacters,positionTracking:n.positionTracking,ensureOptimizations:n.ensureOptimizations,safeMode:n.safeMode,tracer:this.TRACE_INIT})}),this.patternIdxToConfig[c]=l.patternIdxToConfig,this.charCodeToPatternIdxToConfig[c]=l.charCodeToPatternIdxToConfig,this.emptyGroups=Fe({},this.emptyGroups,l.emptyGroups),this.hasCustom=l.hasCustom||this.hasCustom,this.canModeBeOptimized[c]=l.canBeOptimized}})}),this.defaultMode=i.defaultMode,!Ut(this.lexerDefinitionErrors)&&!this.config.deferDefinitionErrorsHandling){const c=et(this.lexerDefinitionErrors,l=>l.message).join(`-----------------------
`);throw new Error(`Errors detected in definition of Lexer:
`+c)}ut(this.lexerDefinitionWarning,a=>{lp(a.message)}),this.TRACE_INIT("Choosing sub-methods implementations",()=>{if(_p?(this.chopInput=Ci,this.match=this.matchWithTest):(this.updateLastIndex=me,this.match=this.matchWithExec),s&&(this.handleModes=me),this.trackStartLines===!1&&(this.computeNewColumn=Ci),this.trackEndLines===!1&&(this.updateTokenEndLineColumnLocation=me),/full/i.test(this.config.positionTracking))this.createTokenInstance=this.createFullToken;else if(/onlyStart/i.test(this.config.positionTracking))this.createTokenInstance=this.createStartOnlyToken;else if(/onlyOffset/i.test(this.config.positionTracking))this.createTokenInstance=this.createOffsetOnlyToken;else throw Error(`Invalid <positionTracking> config option: "${this.config.positionTracking}"`);this.hasCustom?(this.addToken=this.addTokenUsingPush,this.handlePayload=this.handlePayloadWithCustom):(this.addToken=this.addTokenUsingMemberAccess,this.handlePayload=this.handlePayloadNoCustom)}),this.TRACE_INIT("Failed Optimization Warnings",()=>{const a=ze(this.canModeBeOptimized,(c,l,u)=>(l===!1&&c.push(u),c),[]);if(n.ensureOptimizations&&!Ut(a))throw Error(`Lexer Modes: < ${a.join(", ")} > cannot be optimized.
	 Disable the "ensureOptimizations" lexer config flag to silently ignore this and run the lexer in an un-optimized mode.
	 Or inspect the console log for details on how to resolve these issues.`)}),this.TRACE_INIT("clearRegExpParserCache",()=>{jS()}),this.TRACE_INIT("toFastProperties",()=>{hp(this)})})}tokenize(t,n=this.defaultMode){if(!Ut(this.lexerDefinitionErrors)){const i=et(this.lexerDefinitionErrors,s=>s.message).join(`-----------------------
`);throw new Error(`Unable to Tokenize because Errors detected in definition of Lexer:
`+i)}return this.tokenizeInternal(t,n)}tokenizeInternal(t,n){let r,i,s,o,a,c,l,u,f,d,h,p,m,v,b;const y=t,A=y.length;let I=0,k=0;const E=this.hasCustom?0:Math.floor(t.length/10),w=new Array(E),S=[];let O=this.trackStartLines?1:void 0,B=this.trackStartLines?1:void 0;const V=uT(this.emptyGroups),C=this.trackStartLines,D=this.config.lineTerminatorsPattern;let _=0,P=[],Q=[];const F=[],st=[];Object.freeze(st);let z;function ot(){return P}function M(ht){const vt=xr(ht),pt=Q[vt];return pt===void 0?st:pt}const L=ht=>{if(F.length===1&&ht.tokenType.PUSH_MODE===void 0){const vt=this.config.errorMessageProvider.buildUnableToPopLexerModeMessage(ht);S.push({offset:ht.startOffset,line:ht.startLine,column:ht.startColumn,length:ht.image.length,message:vt})}else{F.pop();const vt=Mi(F);P=this.patternIdxToConfig[vt],Q=this.charCodeToPatternIdxToConfig[vt],_=P.length;const pt=this.canModeBeOptimized[vt]&&this.config.safeMode===!1;Q&&pt?z=M:z=ot}};function tt(ht){F.push(ht),Q=this.charCodeToPatternIdxToConfig[ht],P=this.patternIdxToConfig[ht],_=P.length,_=P.length;const vt=this.canModeBeOptimized[ht]&&this.config.safeMode===!1;Q&&vt?z=M:z=ot}tt.call(this,n);let H;const W=this.config.recoveryEnabled;for(;I<A;){c=null;const ht=y.charCodeAt(I),vt=z(ht),pt=vt.length;for(r=0;r<pt;r++){H=vt[r];const ft=H.pattern;l=null;const Rt=H.short;if(Rt!==!1?ht===Rt&&(c=ft):H.isCustom===!0?(b=ft.exec(y,I,w,V),b!==null?(c=b[0],b.payload!==void 0&&(l=b.payload)):c=null):(this.updateLastIndex(ft,I),c=this.match(ft,t,I)),c!==null){if(a=H.longerAlt,a!==void 0){const Et=a.length;for(s=0;s<Et;s++){const Bt=P[a[s]],$t=Bt.pattern;if(u=null,Bt.isCustom===!0?(b=$t.exec(y,I,w,V),b!==null?(o=b[0],b.payload!==void 0&&(u=b.payload)):o=null):(this.updateLastIndex($t,I),o=this.match($t,t,I)),o&&o.length>c.length){c=o,l=u,H=Bt;break}}}break}}if(c!==null){if(f=c.length,d=H.group,d!==void 0&&(h=H.tokenTypeIdx,p=this.createTokenInstance(c,I,h,H.tokenType,O,B,f),this.handlePayload(p,l),d===!1?k=this.addToken(w,k,p):V[d].push(p)),t=this.chopInput(t,f),I=I+f,B=this.computeNewColumn(B,f),C===!0&&H.canLineTerminator===!0){let ft=0,Rt,Et;D.lastIndex=0;do Rt=D.test(c),Rt===!0&&(Et=D.lastIndex-1,ft++);while(Rt===!0);ft!==0&&(O=O+ft,B=f-Et,this.updateTokenEndLineColumnLocation(p,d,Et,ft,O,B,f))}this.handleModes(H,L,tt,p)}else{const ft=I,Rt=O,Et=B;let Bt=W===!1;for(;Bt===!1&&I<A;)for(t=this.chopInput(t,1),I++,i=0;i<_;i++){const $t=P[i],g=$t.pattern,j=$t.short;if(j!==!1?y.charCodeAt(I)===j&&(Bt=!0):$t.isCustom===!0?Bt=g.exec(y,I,w,V)!==null:(this.updateLastIndex(g,I),Bt=g.exec(t)!==null),Bt===!0)break}if(m=I-ft,B=this.computeNewColumn(B,m),v=this.config.errorMessageProvider.buildUnexpectedCharactersMessage(y,ft,m,Rt,Et),S.push({offset:ft,line:Rt,column:Et,length:m,message:v}),W===!1)break}}return this.hasCustom||(w.length=k),{tokens:w,groups:V,errors:S}}handleModes(t,n,r,i){if(t.pop===!0){const s=t.push;n(i),s!==void 0&&r.call(this,s)}else t.push!==void 0&&r.call(this,t.push)}chopInput(t,n){return t.substring(n)}updateLastIndex(t,n){t.lastIndex=n}updateTokenEndLineColumnLocation(t,n,r,i,s,o,a){let c,l;n!==void 0&&(c=r===a-1,l=c?-1:0,i===1&&c===!0||(t.endLine=s+l,t.endColumn=o-1+-l))}computeNewColumn(t,n){return t+n}createOffsetOnlyToken(t,n,r,i){return{image:t,startOffset:n,tokenTypeIdx:r,tokenType:i}}createStartOnlyToken(t,n,r,i,s,o){return{image:t,startOffset:n,startLine:s,startColumn:o,tokenTypeIdx:r,tokenType:i}}createFullToken(t,n,r,i,s,o,a){return{image:t,startOffset:n,endOffset:n+a-1,startLine:s,endLine:s,startColumn:o,endColumn:o+a-1,tokenTypeIdx:r,tokenType:i}}addTokenUsingPush(t,n,r){return t.push(r),n}addTokenUsingMemberAccess(t,n,r){return t[n]=r,n++,n}handlePayloadNoCustom(t,n){}handlePayloadWithCustom(t,n){n!==null&&(t.payload=n)}matchWithTest(t,n,r){return t.test(n)===!0?n.substring(r,t.lastIndex):null}matchWithExec(t,n){const r=t.exec(n);return r!==null?r[0]:null}}ye.SKIPPED="This marks a skipped Token pattern, this means each token identified by it willbe consumed and then thrown into oblivion, this can be used to for example to completely ignore whitespace.",ye.NA=/NOT_APPLICABLE/;function Ds(e){return Ip(e)?e.LABEL:e.name}function Ip(e){return je(e.LABEL)&&e.LABEL!==""}const kT="parent",xp="categories",Cp="label",Np="group",Lp="push_mode",Mp="pop_mode",Up="longer_alt",Dp="line_breaks",Pp="start_chars_hint";function Je(e){return AT(e)}function AT(e){const t=e.pattern,n={};if(n.name=e.name,fr(t)||(n.PATTERN=t),lt(e,kT))throw`The parent property is no longer supported.
See: https://github.com/chevrotain/chevrotain/issues/564#issuecomment-349062346 for details.`;return lt(e,xp)&&(n.CATEGORIES=e[xp]),Ms([n]),lt(e,Cp)&&(n.LABEL=e[Cp]),lt(e,Np)&&(n.GROUP=e[Np]),lt(e,Mp)&&(n.POP_MODE=e[Mp]),lt(e,Lp)&&(n.PUSH_MODE=e[Lp]),lt(e,Up)&&(n.LONGER_ALT=e[Up]),lt(e,Dp)&&(n.LINE_BREAKS=e[Dp]),lt(e,Pp)&&(n.START_CHARS_HINT=e[Pp]),n}const oi=Je({name:"EOF",pattern:ye.NA});Ms([oi]);function ma(e,t,n,r,i,s,o,a){return{image:t,startOffset:n,endOffset:r,startLine:i,endLine:s,startColumn:o,endColumn:a,tokenTypeIdx:e.tokenTypeIdx,tokenType:e}}function ST(e,t){return Ls(e,t)}const Bp={buildMismatchTokenMessage({expected:e,actual:t,previous:n,ruleName:r}){return`Expecting ${Ip(e)?`--> ${Ds(e)} <--`:`token of type --> ${e.name} <--`} but found --> '${t.image}' <--`},buildNotAllInputParsedMessage({firstRedundant:e,ruleName:t}){return"Redundant input, expecting EOF but found: "+e.image},buildNoViableAltMessage({expectedPathsPerAlt:e,actual:t,previous:n,customUserDescription:r,ruleName:i}){const s="Expecting: ",a=`
but found: '`+wn(t).image+"'";if(r)return s+r+a;{const c=ze(e,(d,h)=>d.concat(h),[]),l=et(c,d=>`[${et(d,h=>Ds(h)).join(", ")}]`),f=`one of these possible Token sequences:
${et(l,(d,h)=>`  ${h+1}. ${d}`).join(`
`)}`;return s+f+a}},buildEarlyExitMessage({expectedIterationPaths:e,actual:t,customUserDescription:n,ruleName:r}){const i="Expecting: ",o=`
but found: '`+wn(t).image+"'";if(n)return i+n+o;{const c=`expecting at least one iteration which starts with one of these possible Token sequences::
  <${et(e,l=>`[${et(l,u=>Ds(u)).join(",")}]`).join(" ,")}>`;return i+c+o}}};Object.freeze(Bp);const TT={buildRuleNotFoundError(e,t){return"Invalid grammar, reference to a rule which is not defined: ->"+t.nonTerminalName+`<-
inside top level rule: ->`+e.name+"<-"}},ai={buildDuplicateFoundError(e,t){function n(u){return u instanceof Ht?u.terminalType.name:u instanceof Ge?u.nonTerminalName:""}const r=e.name,i=wn(t),s=i.idx,o=zn(i),a=n(i),c=s>0;let l=`->${o}${c?s:""}<- ${a?`with argument: ->${a}<-`:""}
                  appears more than once (${t.length} times) in the top level rule: ->${r}<-.                  
                  For further details see: https://chevrotain.io/docs/FAQ.html#NUMERICAL_SUFFIXES 
                  `;return l=l.replace(/[ \t]+/g," "),l=l.replace(/\s\s+/g,`
`),l},buildNamespaceConflictError(e){return`Namespace conflict found in grammar.
The grammar has both a Terminal(Token) and a Non-Terminal(Rule) named: <${e.name}>.
To resolve this make sure each Terminal and Non-Terminal names are unique
This is easy to accomplish by using the convention that Terminal names start with an uppercase letter
and Non-Terminal names start with a lower case letter.`},buildAlternationPrefixAmbiguityError(e){const t=et(e.prefixPath,i=>Ds(i)).join(", "),n=e.alternation.idx===0?"":e.alternation.idx;return`Ambiguous alternatives: <${e.ambiguityIndices.join(" ,")}> due to common lookahead prefix
in <OR${n}> inside <${e.topLevelRule.name}> Rule,
<${t}> may appears as a prefix path in all these alternatives.
See: https://chevrotain.io/docs/guide/resolving_grammar_errors.html#COMMON_PREFIX
For Further details.`},buildAlternationAmbiguityError(e){const t=et(e.prefixPath,i=>Ds(i)).join(", "),n=e.alternation.idx===0?"":e.alternation.idx;let r=`Ambiguous Alternatives Detected: <${e.ambiguityIndices.join(" ,")}> in <OR${n}> inside <${e.topLevelRule.name}> Rule,
<${t}> may appears as a prefix path in all these alternatives.
`;return r=r+`See: https://chevrotain.io/docs/guide/resolving_grammar_errors.html#AMBIGUOUS_ALTERNATIVES
For Further details.`,r},buildEmptyRepetitionError(e){let t=zn(e.repetition);return e.repetition.idx!==0&&(t+=e.repetition.idx),`The repetition <${t}> within Rule <${e.topLevelRule.name}> can never consume any tokens.
This could lead to an infinite loop.`},buildTokenNameError(e){return"deprecated"},buildEmptyAlternationError(e){return`Ambiguous empty alternative: <${e.emptyChoiceIdx+1}> in <OR${e.alternation.idx}> inside <${e.topLevelRule.name}> Rule.
Only the last alternative may be an empty alternative.`},buildTooManyAlternativesError(e){return`An Alternation cannot have more than 256 alternatives:
<OR${e.alternation.idx}> inside <${e.topLevelRule.name}> Rule.
 has ${e.alternation.definition.length+1} alternatives.`},buildLeftRecursionError(e){const t=e.topLevelRule.name,n=et(e.leftRecursionPath,s=>s.name),r=`${t} --> ${n.concat([t]).join(" --> ")}`;return`Left Recursion found in grammar.
rule: <${t}> can be invoked from itself (directly or indirectly)
without consuming any Tokens. The grammar path that causes this is: 
 ${r}
 To fix this refactor your grammar to remove the left recursion.
see: https://en.wikipedia.org/wiki/LL_parser#Left_factoring.`},buildInvalidRuleNameError(e){return"deprecated"},buildDuplicateRuleNameError(e){let t;return e.topLevelRule instanceof Di?t=e.topLevelRule.name:t=e.topLevelRule,`Duplicate definition, rule: ->${t}<- is already defined in the grammar: ->${e.grammarName}<-`}};function RT(e,t){const n=new OT(e,t);return n.resolveRefs(),n.errors}class OT extends ii{constructor(t,n){super(),this.nameToTopRule=t,this.errMsgProvider=n,this.errors=[]}resolveRefs(){ut(oe(this.nameToTopRule),t=>{this.currTopLevel=t,t.accept(this)})}visitNonTerminal(t){const n=this.nameToTopRule[t.nonTerminalName];if(n)t.referencedRule=n;else{const r=this.errMsgProvider.buildRuleNotFoundError(this.currTopLevel,t);this.errors.push({message:r,type:Ue.UNRESOLVED_SUBRULE_REF,ruleName:this.currTopLevel.name,unresolvedRefName:t.nonTerminalName})}}}class IT extends ia{constructor(t,n){super(),this.topProd=t,this.path=n,this.possibleTokTypes=[],this.nextProductionName="",this.nextProductionOccurrence=0,this.found=!1,this.isAtEndOfPath=!1}startWalking(){if(this.found=!1,this.path.ruleStack[0]!==this.topProd.name)throw Error("The path does not start with the walker's top Rule!");return this.ruleStack=Se(this.path.ruleStack).reverse(),this.occurrenceStack=Se(this.path.occurrenceStack).reverse(),this.ruleStack.pop(),this.occurrenceStack.pop(),this.updateExpectedNext(),this.walk(this.topProd),this.possibleTokTypes}walk(t,n=[]){this.found||super.walk(t,n)}walkProdRef(t,n,r){if(t.referencedRule.name===this.nextProductionName&&t.idx===this.nextProductionOccurrence){const i=n.concat(r);this.updateExpectedNext(),this.walk(t.referencedRule,i)}}updateExpectedNext(){Ut(this.ruleStack)?(this.nextProductionName="",this.nextProductionOccurrence=0,this.isAtEndOfPath=!0):(this.nextProductionName=this.ruleStack.pop(),this.nextProductionOccurrence=this.occurrenceStack.pop())}}class xT extends IT{constructor(t,n){super(t,n),this.path=n,this.nextTerminalName="",this.nextTerminalOccurrence=0,this.nextTerminalName=this.path.lastTok.name,this.nextTerminalOccurrence=this.path.lastTokOccurrence}walkTerminal(t,n,r){if(this.isAtEndOfPath&&t.terminalType.name===this.nextTerminalName&&t.idx===this.nextTerminalOccurrence&&!this.found){const i=n.concat(r),s=new We({definition:i});this.possibleTokTypes=Is(s),this.found=!0}}}class ga extends ia{constructor(t,n){super(),this.topRule=t,this.occurrence=n,this.result={token:void 0,occurrence:void 0,isEndOfRule:void 0}}startWalking(){return this.walk(this.topRule),this.result}}class CT extends ga{walkMany(t,n,r){if(t.idx===this.occurrence){const i=wn(n.concat(r));this.result.isEndOfRule=i===void 0,i instanceof Ht&&(this.result.token=i.terminalType,this.result.occurrence=i.idx)}else super.walkMany(t,n,r)}}class $p extends ga{walkManySep(t,n,r){if(t.idx===this.occurrence){const i=wn(n.concat(r));this.result.isEndOfRule=i===void 0,i instanceof Ht&&(this.result.token=i.terminalType,this.result.occurrence=i.idx)}else super.walkManySep(t,n,r)}}class NT extends ga{walkAtLeastOne(t,n,r){if(t.idx===this.occurrence){const i=wn(n.concat(r));this.result.isEndOfRule=i===void 0,i instanceof Ht&&(this.result.token=i.terminalType,this.result.occurrence=i.idx)}else super.walkAtLeastOne(t,n,r)}}class Fp extends ga{walkAtLeastOneSep(t,n,r){if(t.idx===this.occurrence){const i=wn(n.concat(r));this.result.isEndOfRule=i===void 0,i instanceof Ht&&(this.result.token=i.terminalType,this.result.occurrence=i.idx)}else super.walkAtLeastOneSep(t,n,r)}}function Bl(e,t,n=[]){n=Se(n);let r=[],i=0;function s(a){return a.concat(Te(e,i+1))}function o(a){const c=Bl(s(a),t,n);return r.concat(c)}for(;n.length<t&&i<e.length;){const a=e[i];if(a instanceof We)return o(a.definition);if(a instanceof Ge)return o(a.definition);if(a instanceof Ke)r=o(a.definition);else if(a instanceof Fn){const c=a.definition.concat([new ge({definition:a.definition})]);return o(c)}else if(a instanceof jn){const c=[new We({definition:a.definition}),new ge({definition:[new Ht({terminalType:a.separator})].concat(a.definition)})];return o(c)}else if(a instanceof En){const c=a.definition.concat([new ge({definition:[new Ht({terminalType:a.separator})].concat(a.definition)})]);r=o(c)}else if(a instanceof ge){const c=a.definition.concat([new ge({definition:a.definition})]);r=o(c)}else{if(a instanceof kn)return ut(a.definition,c=>{Ut(c.definition)===!1&&(r=o(c.definition))}),r;if(a instanceof Ht)n.push(a.terminalType);else throw Error("non exhaustive match")}i++}return r.push({partialPath:n,suffixDef:Te(e,i)}),r}function jp(e,t,n,r){const i="EXIT_NONE_TERMINAL",s=[i],o="EXIT_ALTERNATIVE";let a=!1;const c=t.length,l=c-r-1,u=[],f=[];for(f.push({idx:-1,def:e,ruleStack:[],occurrenceStack:[]});!Ut(f);){const d=f.pop();if(d===o){a&&Mi(f).idx<=l&&f.pop();continue}const h=d.def,p=d.idx,m=d.ruleStack,v=d.occurrenceStack;if(Ut(h))continue;const b=h[0];if(b===i){const y={idx:p,def:Te(h),ruleStack:Os(m),occurrenceStack:Os(v)};f.push(y)}else if(b instanceof Ht)if(p<c-1){const y=p+1,A=t[y];if(n(A,b.terminalType)){const I={idx:y,def:Te(h),ruleStack:m,occurrenceStack:v};f.push(I)}}else if(p===c-1)u.push({nextTokenType:b.terminalType,nextTokenOccurrence:b.idx,ruleStack:m,occurrenceStack:v}),a=!0;else throw Error("non exhaustive match");else if(b instanceof Ge){const y=Se(m);y.push(b.nonTerminalName);const A=Se(v);A.push(b.idx);const I={idx:p,def:b.definition.concat(s,Te(h)),ruleStack:y,occurrenceStack:A};f.push(I)}else if(b instanceof Ke){const y={idx:p,def:Te(h),ruleStack:m,occurrenceStack:v};f.push(y),f.push(o);const A={idx:p,def:b.definition.concat(Te(h)),ruleStack:m,occurrenceStack:v};f.push(A)}else if(b instanceof Fn){const y=new ge({definition:b.definition,idx:b.idx}),A=b.definition.concat([y],Te(h)),I={idx:p,def:A,ruleStack:m,occurrenceStack:v};f.push(I)}else if(b instanceof jn){const y=new Ht({terminalType:b.separator}),A=new ge({definition:[y].concat(b.definition),idx:b.idx}),I=b.definition.concat([A],Te(h)),k={idx:p,def:I,ruleStack:m,occurrenceStack:v};f.push(k)}else if(b instanceof En){const y={idx:p,def:Te(h),ruleStack:m,occurrenceStack:v};f.push(y),f.push(o);const A=new Ht({terminalType:b.separator}),I=new ge({definition:[A].concat(b.definition),idx:b.idx}),k=b.definition.concat([I],Te(h)),E={idx:p,def:k,ruleStack:m,occurrenceStack:v};f.push(E)}else if(b instanceof ge){const y={idx:p,def:Te(h),ruleStack:m,occurrenceStack:v};f.push(y),f.push(o);const A=new ge({definition:b.definition,idx:b.idx}),I=b.definition.concat([A],Te(h)),k={idx:p,def:I,ruleStack:m,occurrenceStack:v};f.push(k)}else if(b instanceof kn)for(let y=b.definition.length-1;y>=0;y--){const A=b.definition[y],I={idx:p,def:A.definition.concat(Te(h)),ruleStack:m,occurrenceStack:v};f.push(I),f.push(o)}else if(b instanceof We)f.push({idx:p,def:b.definition.concat(Te(h)),ruleStack:m,occurrenceStack:v});else if(b instanceof Di)f.push(LT(b,p,m,v));else throw Error("non exhaustive match")}return u}function LT(e,t,n,r){const i=Se(n);i.push(e.name);const s=Se(r);return s.push(1),{idx:t,def:e.definition,ruleStack:i,occurrenceStack:s}}var Jt;(function(e){e[e.OPTION=0]="OPTION",e[e.REPETITION=1]="REPETITION",e[e.REPETITION_MANDATORY=2]="REPETITION_MANDATORY",e[e.REPETITION_MANDATORY_WITH_SEPARATOR=3]="REPETITION_MANDATORY_WITH_SEPARATOR",e[e.REPETITION_WITH_SEPARATOR=4]="REPETITION_WITH_SEPARATOR",e[e.ALTERNATION=5]="ALTERNATION"})(Jt||(Jt={}));function zp(e){if(e instanceof Ke||e==="Option")return Jt.OPTION;if(e instanceof ge||e==="Repetition")return Jt.REPETITION;if(e instanceof Fn||e==="RepetitionMandatory")return Jt.REPETITION_MANDATORY;if(e instanceof jn||e==="RepetitionMandatoryWithSeparator")return Jt.REPETITION_MANDATORY_WITH_SEPARATOR;if(e instanceof En||e==="RepetitionWithSeparator")return Jt.REPETITION_WITH_SEPARATOR;if(e instanceof kn||e==="Alternation")return Jt.ALTERNATION;throw Error("non exhaustive match")}function MT(e,t,n,r,i,s){const o=Fl(e,t,n),a=Hp(o)?pa:Ls;return s(o,r,a,i)}function UT(e,t,n,r,i,s){const o=jl(e,t,i,n),a=Hp(o)?pa:Ls;return s(o[0],a,r)}function DT(e,t,n,r){const i=e.length,s=bn(e,o=>bn(o,a=>a.length===1));if(t)return function(o){const a=et(o,c=>c.GATE);for(let c=0;c<i;c++){const l=e[c],u=l.length,f=a[c];if(!(f!==void 0&&f.call(this)===!1))t:for(let d=0;d<u;d++){const h=l[d],p=h.length;for(let m=0;m<p;m++){const v=this.LA(m+1);if(n(v,h[m])===!1)continue t}return c}}};if(s&&!r){const o=et(e,c=>qe(c)),a=ze(o,(c,l,u)=>(ut(l,f=>{lt(c,f.tokenTypeIdx)||(c[f.tokenTypeIdx]=u),ut(f.categoryMatches,d=>{lt(c,d)||(c[d]=u)})}),c),{});return function(){const c=this.LA(1);return a[c.tokenTypeIdx]}}else return function(){for(let o=0;o<i;o++){const a=e[o],c=a.length;t:for(let l=0;l<c;l++){const u=a[l],f=u.length;for(let d=0;d<f;d++){const h=this.LA(d+1);if(n(h,u[d])===!1)continue t}return o}}}}function PT(e,t,n){const r=bn(e,s=>s.length===1),i=e.length;if(r&&!n){const s=qe(e);if(s.length===1&&Ut(s[0].categoryMatches)){const a=s[0].tokenTypeIdx;return function(){return this.LA(1).tokenTypeIdx===a}}else{const o=ze(s,(a,c,l)=>(a[c.tokenTypeIdx]=!0,ut(c.categoryMatches,u=>{a[u]=!0}),a),[]);return function(){const a=this.LA(1);return o[a.tokenTypeIdx]===!0}}}else return function(){t:for(let s=0;s<i;s++){const o=e[s],a=o.length;for(let c=0;c<a;c++){const l=this.LA(c+1);if(t(l,o[c])===!1)continue t}return!0}return!1}}class BT extends ia{constructor(t,n,r){super(),this.topProd=t,this.targetOccurrence=n,this.targetProdType=r}startWalking(){return this.walk(this.topProd),this.restDef}checkIsTarget(t,n,r,i){return t.idx===this.targetOccurrence&&this.targetProdType===n?(this.restDef=r.concat(i),!0):!1}walkOption(t,n,r){this.checkIsTarget(t,Jt.OPTION,n,r)||super.walkOption(t,n,r)}walkAtLeastOne(t,n,r){this.checkIsTarget(t,Jt.REPETITION_MANDATORY,n,r)||super.walkOption(t,n,r)}walkAtLeastOneSep(t,n,r){this.checkIsTarget(t,Jt.REPETITION_MANDATORY_WITH_SEPARATOR,n,r)||super.walkOption(t,n,r)}walkMany(t,n,r){this.checkIsTarget(t,Jt.REPETITION,n,r)||super.walkOption(t,n,r)}walkManySep(t,n,r){this.checkIsTarget(t,Jt.REPETITION_WITH_SEPARATOR,n,r)||super.walkOption(t,n,r)}}class Gp extends ii{constructor(t,n,r){super(),this.targetOccurrence=t,this.targetProdType=n,this.targetRef=r,this.result=[]}checkIsTarget(t,n){t.idx===this.targetOccurrence&&this.targetProdType===n&&(this.targetRef===void 0||t===this.targetRef)&&(this.result=t.definition)}visitOption(t){this.checkIsTarget(t,Jt.OPTION)}visitRepetition(t){this.checkIsTarget(t,Jt.REPETITION)}visitRepetitionMandatory(t){this.checkIsTarget(t,Jt.REPETITION_MANDATORY)}visitRepetitionMandatoryWithSeparator(t){this.checkIsTarget(t,Jt.REPETITION_MANDATORY_WITH_SEPARATOR)}visitRepetitionWithSeparator(t){this.checkIsTarget(t,Jt.REPETITION_WITH_SEPARATOR)}visitAlternation(t){this.checkIsTarget(t,Jt.ALTERNATION)}}function Wp(e){const t=new Array(e);for(let n=0;n<e;n++)t[n]=[];return t}function $l(e){let t=[""];for(let n=0;n<e.length;n++){const r=e[n],i=[];for(let s=0;s<t.length;s++){const o=t[s];i.push(o+"_"+r.tokenTypeIdx);for(let a=0;a<r.categoryMatches.length;a++){const c="_"+r.categoryMatches[a];i.push(o+c)}}t=i}return t}function $T(e,t,n){for(let r=0;r<e.length;r++){if(r===n)continue;const i=e[r];for(let s=0;s<t.length;s++){const o=t[s];if(i[o]===!0)return!1}}return!0}function Kp(e,t){const n=et(e,o=>Bl([o],1)),r=Wp(n.length),i=et(n,o=>{const a={};return ut(o,c=>{const l=$l(c.partialPath);ut(l,u=>{a[u]=!0})}),a});let s=n;for(let o=1;o<=t;o++){const a=s;s=Wp(a.length);for(let c=0;c<a.length;c++){const l=a[c];for(let u=0;u<l.length;u++){const f=l[u].partialPath,d=l[u].suffixDef,h=$l(f);if($T(i,h,c)||Ut(d)||f.length===t){const m=r[c];if(zl(m,f)===!1){m.push(f);for(let v=0;v<h.length;v++){const b=h[v];i[c][b]=!0}}}else{const m=Bl(d,o+1,f);s[c]=s[c].concat(m),ut(m,v=>{const b=$l(v.partialPath);ut(b,y=>{i[c][y]=!0})})}}}}return r}function Fl(e,t,n,r){const i=new Gp(e,Jt.ALTERNATION,r);return t.accept(i),Kp(i.result,n)}function jl(e,t,n,r){const i=new Gp(e,n);t.accept(i);const s=i.result,a=new BT(t,e,n).startWalking(),c=new We({definition:s}),l=new We({definition:a});return Kp([c,l],r)}function zl(e,t){t:for(let n=0;n<e.length;n++){const r=e[n];if(r.length===t.length){for(let i=0;i<r.length;i++){const s=t[i],o=r[i];if((s===o||o.categoryMatchesMap[s.tokenTypeIdx]!==void 0)===!1)continue t}return!0}}return!1}function FT(e,t){return e.length<t.length&&bn(e,(n,r)=>{const i=t[r];return n===i||i.categoryMatchesMap[n.tokenTypeIdx]})}function Hp(e){return bn(e,t=>bn(t,n=>bn(n,r=>Ut(r.categoryMatches))))}function jT(e){const t=e.lookaheadStrategy.validate({rules:e.rules,tokenTypes:e.tokenTypes,grammarName:e.grammarName});return et(t,n=>Object.assign({type:Ue.CUSTOM_LOOKAHEAD_VALIDATION},n))}function zT(e,t,n,r){const i=cn(e,c=>GT(c,n)),s=eR(e,t,n),o=cn(e,c=>XT(c,n)),a=cn(e,c=>HT(c,e,r,n));return i.concat(s,o,a)}function GT(e,t){const n=new KT;e.accept(n);const r=n.allProductions,i=op(r,WT),s=vn(i,a=>a.length>1);return et(oe(s),a=>{const c=wn(a),l=t.buildDuplicateFoundError(e,a),u=zn(c),f={message:l,type:Ue.DUPLICATE_PRODUCTIONS,ruleName:e.name,dslName:u,occurrence:c.idx},d=Vp(c);return d&&(f.parameter=d),f})}function WT(e){return`${zn(e)}_#_${e.idx}_#_${Vp(e)}`}function Vp(e){return e instanceof Ht?e.terminalType.name:e instanceof Ge?e.nonTerminalName:""}class KT extends ii{constructor(){super(...arguments),this.allProductions=[]}visitNonTerminal(t){this.allProductions.push(t)}visitOption(t){this.allProductions.push(t)}visitRepetitionWithSeparator(t){this.allProductions.push(t)}visitRepetitionMandatory(t){this.allProductions.push(t)}visitRepetitionMandatoryWithSeparator(t){this.allProductions.push(t)}visitRepetition(t){this.allProductions.push(t)}visitAlternation(t){this.allProductions.push(t)}visitTerminal(t){this.allProductions.push(t)}}function HT(e,t,n,r){const i=[];if(ze(t,(o,a)=>a.name===e.name?o+1:o,0)>1){const o=r.buildDuplicateRuleNameError({topLevelRule:e,grammarName:n});i.push({message:o,type:Ue.DUPLICATE_RULE_NAME,ruleName:e.name})}return i}function VT(e,t,n){const r=[];let i;return Me(t,e)||(i=`Invalid rule override, rule: ->${e}<- cannot be overridden in the grammar: ->${n}<-as it is not defined in any of the super grammars `,r.push({message:i,type:Ue.INVALID_RULE_OVERRIDE,ruleName:e})),r}function Yp(e,t,n,r=[]){const i=[],s=ya(t.definition);if(Ut(s))return[];{const o=e.name;Me(s,e)&&i.push({message:n.buildLeftRecursionError({topLevelRule:e,leftRecursionPath:r}),type:Ue.LEFT_RECURSION,ruleName:o});const c=Qo(s,r.concat([e])),l=cn(c,u=>{const f=Se(r);return f.push(u),Yp(e,u,n,f)});return i.concat(l)}}function ya(e){let t=[];if(Ut(e))return t;const n=wn(e);if(n instanceof Ge)t.push(n.referencedRule);else if(n instanceof We||n instanceof Ke||n instanceof Fn||n instanceof jn||n instanceof En||n instanceof ge)t=t.concat(ya(n.definition));else if(n instanceof kn)t=qe(et(n.definition,s=>ya(s.definition)));else if(!(n instanceof Ht))throw Error("non exhaustive match");const r=ra(n),i=e.length>1;if(r&&i){const s=Te(e);return t.concat(ya(s))}else return t}class Gl extends ii{constructor(){super(...arguments),this.alternations=[]}visitAlternation(t){this.alternations.push(t)}}function YT(e,t){const n=new Gl;e.accept(n);const r=n.alternations;return cn(r,s=>{const o=Os(s.definition);return cn(o,(a,c)=>{const l=jp([a],[],Ls,1);return Ut(l)?[{message:t.buildEmptyAlternationError({topLevelRule:e,alternation:s,emptyChoiceIdx:c}),type:Ue.NONE_LAST_EMPTY_ALT,ruleName:e.name,occurrence:s.idx,alternative:c+1}]:[]})})}function qT(e,t,n){const r=new Gl;e.accept(r);let i=r.alternations;return i=ta(i,o=>o.ignoreAmbiguities===!0),cn(i,o=>{const a=o.idx,c=o.maxLookahead||t,l=Fl(a,e,c,o),u=QT(l,o,e,n),f=tR(l,o,e,n);return u.concat(f)})}class JT extends ii{constructor(){super(...arguments),this.allProductions=[]}visitRepetitionWithSeparator(t){this.allProductions.push(t)}visitRepetitionMandatory(t){this.allProductions.push(t)}visitRepetitionMandatoryWithSeparator(t){this.allProductions.push(t)}visitRepetition(t){this.allProductions.push(t)}}function XT(e,t){const n=new Gl;e.accept(n);const r=n.alternations;return cn(r,s=>s.definition.length>255?[{message:t.buildTooManyAlternativesError({topLevelRule:e,alternation:s}),type:Ue.TOO_MANY_ALTS,ruleName:e.name,occurrence:s.idx}]:[])}function ZT(e,t,n){const r=[];return ut(e,i=>{const s=new JT;i.accept(s);const o=s.allProductions;ut(o,a=>{const c=zp(a),l=a.maxLookahead||t,u=a.idx,d=jl(u,i,c,l)[0];if(Ut(qe(d))){const h=n.buildEmptyRepetitionError({topLevelRule:i,repetition:a});r.push({message:h,type:Ue.NO_NON_EMPTY_LOOKAHEAD,ruleName:i.name})}})}),r}function QT(e,t,n,r){const i=[],s=ze(e,(a,c,l)=>(t.definition[l].ignoreAmbiguities===!0||ut(c,u=>{const f=[l];ut(e,(d,h)=>{l!==h&&zl(d,u)&&t.definition[h].ignoreAmbiguities!==!0&&f.push(h)}),f.length>1&&!zl(i,u)&&(i.push(u),a.push({alts:f,path:u}))}),a),[]);return et(s,a=>{const c=et(a.alts,u=>u+1);return{message:r.buildAlternationAmbiguityError({topLevelRule:n,alternation:t,ambiguityIndices:c,prefixPath:a.path}),type:Ue.AMBIGUOUS_ALTS,ruleName:n.name,occurrence:t.idx,alternatives:a.alts}})}function tR(e,t,n,r){const i=ze(e,(o,a,c)=>{const l=et(a,u=>({idx:c,path:u}));return o.concat(l)},[]);return Rs(cn(i,o=>{if(t.definition[o.idx].ignoreAmbiguities===!0)return[];const c=o.idx,l=o.path,u=an(i,d=>t.definition[d.idx].ignoreAmbiguities!==!0&&d.idx<c&&FT(d.path,l));return et(u,d=>{const h=[d.idx+1,c+1],p=t.idx===0?"":t.idx;return{message:r.buildAlternationPrefixAmbiguityError({topLevelRule:n,alternation:t,ambiguityIndices:h,prefixPath:d.path}),type:Ue.AMBIGUOUS_PREFIX_ALTS,ruleName:n.name,occurrence:p,alternatives:h}})}))}function eR(e,t,n){const r=[],i=et(t,s=>s.name);return ut(e,s=>{const o=s.name;if(Me(i,o)){const a=n.buildNamespaceConflictError(s);r.push({message:a,type:Ue.CONFLICT_TOKENS_RULES_NAMESPACE,ruleName:o})}}),r}function nR(e){const t=Il(e,{errMsgProvider:TT}),n={};return ut(e.rules,r=>{n[r.name]=r}),RT(n,t.errMsgProvider)}function rR(e){return e=Il(e,{errMsgProvider:ai}),zT(e.rules,e.tokenTypes,e.errMsgProvider,e.grammarName)}const qp="MismatchedTokenException",Jp="NoViableAltException",Xp="EarlyExitException",Zp="NotAllInputParsedException",Qp=[qp,Jp,Xp,Zp];Object.freeze(Qp);function _a(e){return Me(Qp,e.name)}class ba extends Error{constructor(t,n){super(t),this.token=n,this.resyncedTokens=[],Object.setPrototypeOf(this,new.target.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor)}}class tm extends ba{constructor(t,n,r){super(t,n),this.previousToken=r,this.name=qp}}class iR extends ba{constructor(t,n,r){super(t,n),this.previousToken=r,this.name=Jp}}class sR extends ba{constructor(t,n){super(t,n),this.name=Zp}}class oR extends ba{constructor(t,n,r){super(t,n),this.previousToken=r,this.name=Xp}}const Wl={},em="InRuleRecoveryException";class aR extends Error{constructor(t){super(t),this.name=em}}class cR{initRecoverable(t){this.firstAfterRepMap={},this.resyncFollows={},this.recoveryEnabled=lt(t,"recoveryEnabled")?t.recoveryEnabled:dr.recoveryEnabled,this.recoveryEnabled&&(this.attemptInRepetitionRecovery=lR)}getTokenToInsert(t){const n=ma(t,"",NaN,NaN,NaN,NaN,NaN,NaN);return n.isInsertedInRecovery=!0,n}canTokenTypeBeInsertedInRecovery(t){return!0}canTokenTypeBeDeletedInRecovery(t){return!0}tryInRepetitionRecovery(t,n,r,i){const s=this.findReSyncTokenType(),o=this.exportLexerState(),a=[];let c=!1;const l=this.LA(1);let u=this.LA(1);const f=()=>{const d=this.LA(0),h=this.errorMessageProvider.buildMismatchTokenMessage({expected:i,actual:l,previous:d,ruleName:this.getCurrRuleFullName()}),p=new tm(h,l,this.LA(0));p.resyncedTokens=Os(a),this.SAVE_ERROR(p)};for(;!c;)if(this.tokenMatcher(u,i)){f();return}else if(r.call(this)){f(),t.apply(this,n);return}else this.tokenMatcher(u,s)?c=!0:(u=this.SKIP_TOKEN(),this.addToResyncTokens(u,a));this.importLexerState(o)}shouldInRepetitionRecoveryBeTried(t,n,r){return!(r===!1||this.tokenMatcher(this.LA(1),t)||this.isBackTracking()||this.canPerformInRuleRecovery(t,this.getFollowsForInRuleRecovery(t,n)))}getFollowsForInRuleRecovery(t,n){const r=this.getCurrentGrammarPath(t,n);return this.getNextPossibleTokenTypes(r)}tryInRuleRecovery(t,n){if(this.canRecoverWithSingleTokenInsertion(t,n))return this.getTokenToInsert(t);if(this.canRecoverWithSingleTokenDeletion(t)){const r=this.SKIP_TOKEN();return this.consumeToken(),r}throw new aR("sad sad panda")}canPerformInRuleRecovery(t,n){return this.canRecoverWithSingleTokenInsertion(t,n)||this.canRecoverWithSingleTokenDeletion(t)}canRecoverWithSingleTokenInsertion(t,n){if(!this.canTokenTypeBeInsertedInRecovery(t)||Ut(n))return!1;const r=this.LA(1);return Ui(n,s=>this.tokenMatcher(r,s))!==void 0}canRecoverWithSingleTokenDeletion(t){return this.canTokenTypeBeDeletedInRecovery(t)?this.tokenMatcher(this.LA(2),t):!1}isInCurrentRuleReSyncSet(t){const n=this.getCurrFollowKey(),r=this.getFollowSetFromFollowKey(n);return Me(r,t)}findReSyncTokenType(){const t=this.flattenFollowSet();let n=this.LA(1),r=2;for(;;){const i=Ui(t,s=>ST(n,s));if(i!==void 0)return i;n=this.LA(r),r++}}getCurrFollowKey(){if(this.RULE_STACK.length===1)return Wl;const t=this.getLastExplicitRuleShortName(),n=this.getLastExplicitRuleOccurrenceIndex(),r=this.getPreviousExplicitRuleShortName();return{ruleName:this.shortRuleNameToFullName(t),idxInCallingRule:n,inRule:this.shortRuleNameToFullName(r)}}buildFullFollowKeyStack(){const t=this.RULE_STACK,n=this.RULE_OCCURRENCE_STACK;return et(t,(r,i)=>i===0?Wl:{ruleName:this.shortRuleNameToFullName(r),idxInCallingRule:n[i],inRule:this.shortRuleNameToFullName(t[i-1])})}flattenFollowSet(){const t=et(this.buildFullFollowKeyStack(),n=>this.getFollowSetFromFollowKey(n));return qe(t)}getFollowSetFromFollowKey(t){if(t===Wl)return[oi];const n=t.ruleName+t.idxInCallingRule+dp+t.inRule;return this.resyncFollows[n]}addToResyncTokens(t,n){return this.tokenMatcher(t,oi)||n.push(t),n}reSyncTo(t){const n=[];let r=this.LA(1);for(;this.tokenMatcher(r,t)===!1;)r=this.SKIP_TOKEN(),this.addToResyncTokens(r,n);return Os(n)}attemptInRepetitionRecovery(t,n,r,i,s,o,a){}getCurrentGrammarPath(t,n){const r=this.getHumanReadableRuleStack(),i=Se(this.RULE_OCCURRENCE_STACK);return{ruleStack:r,occurrenceStack:i,lastTok:t,lastTokOccurrence:n}}getHumanReadableRuleStack(){return et(this.RULE_STACK,t=>this.shortRuleNameToFullName(t))}}function lR(e,t,n,r,i,s,o){const a=this.getKeyForAutomaticLookahead(r,i);let c=this.firstAfterRepMap[a];if(c===void 0){const d=this.getCurrRuleFullName(),h=this.getGAstProductions()[d];c=new s(h,i).startWalking(),this.firstAfterRepMap[a]=c}let l=c.token,u=c.occurrence;const f=c.isEndOfRule;this.RULE_STACK.length===1&&f&&l===void 0&&(l=oi,u=1),!(l===void 0||u===void 0)&&this.shouldInRepetitionRecoveryBeTried(l,u,o)&&this.tryInRepetitionRecovery(e,t,n,l)}const uR=4,Cr=8,nm=1<<Cr,rm=2<<Cr,Kl=3<<Cr,Hl=4<<Cr,Vl=5<<Cr,wa=6<<Cr;function Yl(e,t,n){return n|t|e}class hR{constructor(t){var n;this.maxLookahead=(n=t==null?void 0:t.maxLookahead)!==null&&n!==void 0?n:dr.maxLookahead}validate(t){const n=this.validateNoLeftRecursion(t.rules);if(Ut(n)){const r=this.validateEmptyOrAlternatives(t.rules),i=this.validateAmbiguousAlternationAlternatives(t.rules,this.maxLookahead),s=this.validateSomeNonEmptyLookaheadPath(t.rules,this.maxLookahead);return[...n,...r,...i,...s]}return n}validateNoLeftRecursion(t){return cn(t,n=>Yp(n,n,ai))}validateEmptyOrAlternatives(t){return cn(t,n=>YT(n,ai))}validateAmbiguousAlternationAlternatives(t,n){return cn(t,r=>qT(r,n,ai))}validateSomeNonEmptyLookaheadPath(t,n){return ZT(t,n,ai)}buildLookaheadForAlternation(t){return MT(t.prodOccurrence,t.rule,t.maxLookahead,t.hasPredicates,t.dynamicTokensEnabled,DT)}buildLookaheadForOptional(t){return UT(t.prodOccurrence,t.rule,t.maxLookahead,t.dynamicTokensEnabled,zp(t.prodType),PT)}}class fR{initLooksAhead(t){this.dynamicTokensEnabled=lt(t,"dynamicTokensEnabled")?t.dynamicTokensEnabled:dr.dynamicTokensEnabled,this.maxLookahead=lt(t,"maxLookahead")?t.maxLookahead:dr.maxLookahead,this.lookaheadStrategy=lt(t,"lookaheadStrategy")?t.lookaheadStrategy:new hR({maxLookahead:this.maxLookahead}),this.lookAheadFuncsCache=new Map}preComputeLookaheadFunctions(t){ut(t,n=>{this.TRACE_INIT(`${n.name} Rule Lookahead`,()=>{const{alternation:r,repetition:i,option:s,repetitionMandatory:o,repetitionMandatoryWithSeparator:a,repetitionWithSeparator:c}=pR(n);ut(r,l=>{const u=l.idx===0?"":l.idx;this.TRACE_INIT(`${zn(l)}${u}`,()=>{const f=this.lookaheadStrategy.buildLookaheadForAlternation({prodOccurrence:l.idx,rule:n,maxLookahead:l.maxLookahead||this.maxLookahead,hasPredicates:l.hasPredicates,dynamicTokensEnabled:this.dynamicTokensEnabled}),d=Yl(this.fullRuleNameToShort[n.name],nm,l.idx);this.setLaFuncCache(d,f)})}),ut(i,l=>{this.computeLookaheadFunc(n,l.idx,Kl,"Repetition",l.maxLookahead,zn(l))}),ut(s,l=>{this.computeLookaheadFunc(n,l.idx,rm,"Option",l.maxLookahead,zn(l))}),ut(o,l=>{this.computeLookaheadFunc(n,l.idx,Hl,"RepetitionMandatory",l.maxLookahead,zn(l))}),ut(a,l=>{this.computeLookaheadFunc(n,l.idx,wa,"RepetitionMandatoryWithSeparator",l.maxLookahead,zn(l))}),ut(c,l=>{this.computeLookaheadFunc(n,l.idx,Vl,"RepetitionWithSeparator",l.maxLookahead,zn(l))})})})}computeLookaheadFunc(t,n,r,i,s,o){this.TRACE_INIT(`${o}${n===0?"":n}`,()=>{const a=this.lookaheadStrategy.buildLookaheadForOptional({prodOccurrence:n,rule:t,maxLookahead:s||this.maxLookahead,dynamicTokensEnabled:this.dynamicTokensEnabled,prodType:i}),c=Yl(this.fullRuleNameToShort[t.name],r,n);this.setLaFuncCache(c,a)})}getKeyForAutomaticLookahead(t,n){const r=this.getLastExplicitRuleShortName();return Yl(r,t,n)}getLaFuncFromCache(t){return this.lookAheadFuncsCache.get(t)}setLaFuncCache(t,n){this.lookAheadFuncsCache.set(t,n)}}class dR extends ii{constructor(){super(...arguments),this.dslMethods={option:[],alternation:[],repetition:[],repetitionWithSeparator:[],repetitionMandatory:[],repetitionMandatoryWithSeparator:[]}}reset(){this.dslMethods={option:[],alternation:[],repetition:[],repetitionWithSeparator:[],repetitionMandatory:[],repetitionMandatoryWithSeparator:[]}}visitOption(t){this.dslMethods.option.push(t)}visitRepetitionWithSeparator(t){this.dslMethods.repetitionWithSeparator.push(t)}visitRepetitionMandatory(t){this.dslMethods.repetitionMandatory.push(t)}visitRepetitionMandatoryWithSeparator(t){this.dslMethods.repetitionMandatoryWithSeparator.push(t)}visitRepetition(t){this.dslMethods.repetition.push(t)}visitAlternation(t){this.dslMethods.alternation.push(t)}}const va=new dR;function pR(e){va.reset(),e.accept(va);const t=va.dslMethods;return va.reset(),t}function im(e,t){isNaN(e.startOffset)===!0?(e.startOffset=t.startOffset,e.endOffset=t.endOffset):e.endOffset<t.endOffset&&(e.endOffset=t.endOffset)}function sm(e,t){isNaN(e.startOffset)===!0?(e.startOffset=t.startOffset,e.startColumn=t.startColumn,e.startLine=t.startLine,e.endOffset=t.endOffset,e.endColumn=t.endColumn,e.endLine=t.endLine):e.endOffset<t.endOffset&&(e.endOffset=t.endOffset,e.endColumn=t.endColumn,e.endLine=t.endLine)}function mR(e,t,n){e.children[n]===void 0?e.children[n]=[t]:e.children[n].push(t)}function gR(e,t,n){e.children[t]===void 0?e.children[t]=[n]:e.children[t].push(n)}const yR="name";function om(e,t){Object.defineProperty(e,yR,{enumerable:!1,configurable:!0,writable:!1,value:t})}function _R(e,t){const n=sn(e),r=n.length;for(let i=0;i<r;i++){const s=n[i],o=e[s],a=o.length;for(let c=0;c<a;c++){const l=o[c];l.tokenTypeIdx===void 0&&this[l.name](l.children,t)}}}function bR(e,t){const n=function(){};om(n,e+"BaseSemantics");const r={visit:function(i,s){if(St(i)&&(i=i[0]),!fr(i))return this[i.name](i.children,s)},validateVisitor:function(){const i=vR(this,t);if(!Ut(i)){const s=et(i,o=>o.msg);throw Error(`Errors Detected in CST Visitor <${this.constructor.name}>:
	${s.join(`

`).replace(/\n/g,`
	`)}`)}}};return n.prototype=r,n.prototype.constructor=n,n._RULE_NAMES=t,n}function wR(e,t,n){const r=function(){};om(r,e+"BaseSemanticsWithDefaults");const i=Object.create(n.prototype);return ut(t,s=>{i[s]=_R}),r.prototype=i,r.prototype.constructor=r,r}var ql;(function(e){e[e.REDUNDANT_METHOD=0]="REDUNDANT_METHOD",e[e.MISSING_METHOD=1]="MISSING_METHOD"})(ql||(ql={}));function vR(e,t){return ER(e,t)}function ER(e,t){const n=an(t,i=>cr(e[i])===!1),r=et(n,i=>({msg:`Missing visitor method: <${i}> on ${e.constructor.name} CST Visitor.`,type:ql.MISSING_METHOD,methodName:i}));return Rs(r)}class kR{initTreeBuilder(t){if(this.CST_STACK=[],this.outputCst=t.outputCst,this.nodeLocationTracking=lt(t,"nodeLocationTracking")?t.nodeLocationTracking:dr.nodeLocationTracking,!this.outputCst)this.cstInvocationStateUpdate=me,this.cstFinallyStateUpdate=me,this.cstPostTerminal=me,this.cstPostNonTerminal=me,this.cstPostRule=me;else if(/full/i.test(this.nodeLocationTracking))this.recoveryEnabled?(this.setNodeLocationFromToken=sm,this.setNodeLocationFromNode=sm,this.cstPostRule=me,this.setInitialNodeLocation=this.setInitialNodeLocationFullRecovery):(this.setNodeLocationFromToken=me,this.setNodeLocationFromNode=me,this.cstPostRule=this.cstPostRuleFull,this.setInitialNodeLocation=this.setInitialNodeLocationFullRegular);else if(/onlyOffset/i.test(this.nodeLocationTracking))this.recoveryEnabled?(this.setNodeLocationFromToken=im,this.setNodeLocationFromNode=im,this.cstPostRule=me,this.setInitialNodeLocation=this.setInitialNodeLocationOnlyOffsetRecovery):(this.setNodeLocationFromToken=me,this.setNodeLocationFromNode=me,this.cstPostRule=this.cstPostRuleOnlyOffset,this.setInitialNodeLocation=this.setInitialNodeLocationOnlyOffsetRegular);else if(/none/i.test(this.nodeLocationTracking))this.setNodeLocationFromToken=me,this.setNodeLocationFromNode=me,this.cstPostRule=me,this.setInitialNodeLocation=me;else throw Error(`Invalid <nodeLocationTracking> config option: "${t.nodeLocationTracking}"`)}setInitialNodeLocationOnlyOffsetRecovery(t){t.location={startOffset:NaN,endOffset:NaN}}setInitialNodeLocationOnlyOffsetRegular(t){t.location={startOffset:this.LA(1).startOffset,endOffset:NaN}}setInitialNodeLocationFullRecovery(t){t.location={startOffset:NaN,startLine:NaN,startColumn:NaN,endOffset:NaN,endLine:NaN,endColumn:NaN}}setInitialNodeLocationFullRegular(t){const n=this.LA(1);t.location={startOffset:n.startOffset,startLine:n.startLine,startColumn:n.startColumn,endOffset:NaN,endLine:NaN,endColumn:NaN}}cstInvocationStateUpdate(t){const n={name:t,children:Object.create(null)};this.setInitialNodeLocation(n),this.CST_STACK.push(n)}cstFinallyStateUpdate(){this.CST_STACK.pop()}cstPostRuleFull(t){const n=this.LA(0),r=t.location;r.startOffset<=n.startOffset?(r.endOffset=n.endOffset,r.endLine=n.endLine,r.endColumn=n.endColumn):(r.startOffset=NaN,r.startLine=NaN,r.startColumn=NaN)}cstPostRuleOnlyOffset(t){const n=this.LA(0),r=t.location;r.startOffset<=n.startOffset?r.endOffset=n.endOffset:r.startOffset=NaN}cstPostTerminal(t,n){const r=this.CST_STACK[this.CST_STACK.length-1];mR(r,n,t),this.setNodeLocationFromToken(r.location,n)}cstPostNonTerminal(t,n){const r=this.CST_STACK[this.CST_STACK.length-1];gR(r,n,t),this.setNodeLocationFromNode(r.location,t.location)}getBaseCstVisitorConstructor(){if(fr(this.baseCstVisitorConstructor)){const t=bR(this.className,sn(this.gastProductionsCache));return this.baseCstVisitorConstructor=t,t}return this.baseCstVisitorConstructor}getBaseCstVisitorConstructorWithDefaults(){if(fr(this.baseCstVisitorWithDefaultsConstructor)){const t=wR(this.className,sn(this.gastProductionsCache),this.getBaseCstVisitorConstructor());return this.baseCstVisitorWithDefaultsConstructor=t,t}return this.baseCstVisitorWithDefaultsConstructor}getLastExplicitRuleShortName(){const t=this.RULE_STACK;return t[t.length-1]}getPreviousExplicitRuleShortName(){const t=this.RULE_STACK;return t[t.length-2]}getLastExplicitRuleOccurrenceIndex(){const t=this.RULE_OCCURRENCE_STACK;return t[t.length-1]}}class AR{initLexerAdapter(){this.tokVector=[],this.tokVectorLength=0,this.currIdx=-1}set input(t){if(this.selfAnalysisDone!==!0)throw Error("Missing <performSelfAnalysis> invocation at the end of the Parser's constructor.");this.reset(),this.tokVector=t,this.tokVectorLength=t.length}get input(){return this.tokVector}SKIP_TOKEN(){return this.currIdx<=this.tokVector.length-2?(this.consumeToken(),this.LA(1)):Aa}LA(t){const n=this.currIdx+t;return n<0||this.tokVectorLength<=n?Aa:this.tokVector[n]}consumeToken(){this.currIdx++}exportLexerState(){return this.currIdx}importLexerState(t){this.currIdx=t}resetLexerState(){this.currIdx=-1}moveToTerminatedState(){this.currIdx=this.tokVector.length-1}getLexerPosition(){return this.exportLexerState()}}class SR{ACTION(t){return t.call(this)}consume(t,n,r){return this.consumeInternal(n,t,r)}subrule(t,n,r){return this.subruleInternal(n,t,r)}option(t,n){return this.optionInternal(n,t)}or(t,n){return this.orInternal(n,t)}many(t,n){return this.manyInternal(t,n)}atLeastOne(t,n){return this.atLeastOneInternal(t,n)}CONSUME(t,n){return this.consumeInternal(t,0,n)}CONSUME1(t,n){return this.consumeInternal(t,1,n)}CONSUME2(t,n){return this.consumeInternal(t,2,n)}CONSUME3(t,n){return this.consumeInternal(t,3,n)}CONSUME4(t,n){return this.consumeInternal(t,4,n)}CONSUME5(t,n){return this.consumeInternal(t,5,n)}CONSUME6(t,n){return this.consumeInternal(t,6,n)}CONSUME7(t,n){return this.consumeInternal(t,7,n)}CONSUME8(t,n){return this.consumeInternal(t,8,n)}CONSUME9(t,n){return this.consumeInternal(t,9,n)}SUBRULE(t,n){return this.subruleInternal(t,0,n)}SUBRULE1(t,n){return this.subruleInternal(t,1,n)}SUBRULE2(t,n){return this.subruleInternal(t,2,n)}SUBRULE3(t,n){return this.subruleInternal(t,3,n)}SUBRULE4(t,n){return this.subruleInternal(t,4,n)}SUBRULE5(t,n){return this.subruleInternal(t,5,n)}SUBRULE6(t,n){return this.subruleInternal(t,6,n)}SUBRULE7(t,n){return this.subruleInternal(t,7,n)}SUBRULE8(t,n){return this.subruleInternal(t,8,n)}SUBRULE9(t,n){return this.subruleInternal(t,9,n)}OPTION(t){return this.optionInternal(t,0)}OPTION1(t){return this.optionInternal(t,1)}OPTION2(t){return this.optionInternal(t,2)}OPTION3(t){return this.optionInternal(t,3)}OPTION4(t){return this.optionInternal(t,4)}OPTION5(t){return this.optionInternal(t,5)}OPTION6(t){return this.optionInternal(t,6)}OPTION7(t){return this.optionInternal(t,7)}OPTION8(t){return this.optionInternal(t,8)}OPTION9(t){return this.optionInternal(t,9)}OR(t){return this.orInternal(t,0)}OR1(t){return this.orInternal(t,1)}OR2(t){return this.orInternal(t,2)}OR3(t){return this.orInternal(t,3)}OR4(t){return this.orInternal(t,4)}OR5(t){return this.orInternal(t,5)}OR6(t){return this.orInternal(t,6)}OR7(t){return this.orInternal(t,7)}OR8(t){return this.orInternal(t,8)}OR9(t){return this.orInternal(t,9)}MANY(t){this.manyInternal(0,t)}MANY1(t){this.manyInternal(1,t)}MANY2(t){this.manyInternal(2,t)}MANY3(t){this.manyInternal(3,t)}MANY4(t){this.manyInternal(4,t)}MANY5(t){this.manyInternal(5,t)}MANY6(t){this.manyInternal(6,t)}MANY7(t){this.manyInternal(7,t)}MANY8(t){this.manyInternal(8,t)}MANY9(t){this.manyInternal(9,t)}MANY_SEP(t){this.manySepFirstInternal(0,t)}MANY_SEP1(t){this.manySepFirstInternal(1,t)}MANY_SEP2(t){this.manySepFirstInternal(2,t)}MANY_SEP3(t){this.manySepFirstInternal(3,t)}MANY_SEP4(t){this.manySepFirstInternal(4,t)}MANY_SEP5(t){this.manySepFirstInternal(5,t)}MANY_SEP6(t){this.manySepFirstInternal(6,t)}MANY_SEP7(t){this.manySepFirstInternal(7,t)}MANY_SEP8(t){this.manySepFirstInternal(8,t)}MANY_SEP9(t){this.manySepFirstInternal(9,t)}AT_LEAST_ONE(t){this.atLeastOneInternal(0,t)}AT_LEAST_ONE1(t){return this.atLeastOneInternal(1,t)}AT_LEAST_ONE2(t){this.atLeastOneInternal(2,t)}AT_LEAST_ONE3(t){this.atLeastOneInternal(3,t)}AT_LEAST_ONE4(t){this.atLeastOneInternal(4,t)}AT_LEAST_ONE5(t){this.atLeastOneInternal(5,t)}AT_LEAST_ONE6(t){this.atLeastOneInternal(6,t)}AT_LEAST_ONE7(t){this.atLeastOneInternal(7,t)}AT_LEAST_ONE8(t){this.atLeastOneInternal(8,t)}AT_LEAST_ONE9(t){this.atLeastOneInternal(9,t)}AT_LEAST_ONE_SEP(t){this.atLeastOneSepFirstInternal(0,t)}AT_LEAST_ONE_SEP1(t){this.atLeastOneSepFirstInternal(1,t)}AT_LEAST_ONE_SEP2(t){this.atLeastOneSepFirstInternal(2,t)}AT_LEAST_ONE_SEP3(t){this.atLeastOneSepFirstInternal(3,t)}AT_LEAST_ONE_SEP4(t){this.atLeastOneSepFirstInternal(4,t)}AT_LEAST_ONE_SEP5(t){this.atLeastOneSepFirstInternal(5,t)}AT_LEAST_ONE_SEP6(t){this.atLeastOneSepFirstInternal(6,t)}AT_LEAST_ONE_SEP7(t){this.atLeastOneSepFirstInternal(7,t)}AT_LEAST_ONE_SEP8(t){this.atLeastOneSepFirstInternal(8,t)}AT_LEAST_ONE_SEP9(t){this.atLeastOneSepFirstInternal(9,t)}RULE(t,n,r=Sa){if(Me(this.definedRulesNames,t)){const o={message:ai.buildDuplicateRuleNameError({topLevelRule:t,grammarName:this.className}),type:Ue.DUPLICATE_RULE_NAME,ruleName:t};this.definitionErrors.push(o)}this.definedRulesNames.push(t);const i=this.defineRule(t,n,r);return this[t]=i,i}OVERRIDE_RULE(t,n,r=Sa){const i=VT(t,this.definedRulesNames,this.className);this.definitionErrors=this.definitionErrors.concat(i);const s=this.defineRule(t,n,r);return this[t]=s,s}BACKTRACK(t,n){return function(){this.isBackTrackingStack.push(1);const r=this.saveRecogState();try{return t.apply(this,n),!0}catch(i){if(_a(i))return!1;throw i}finally{this.reloadRecogState(r),this.isBackTrackingStack.pop()}}}getGAstProductions(){return this.gastProductionsCache}getSerializedGastProductions(){return RS(oe(this.gastProductionsCache))}}class TR{initRecognizerEngine(t,n){if(this.className=this.constructor.name,this.shortRuleNameToFull={},this.fullRuleNameToShort={},this.ruleShortNameIdx=256,this.tokenMatcher=pa,this.subruleIdx=0,this.definedRulesNames=[],this.tokensMap={},this.isBackTrackingStack=[],this.RULE_STACK=[],this.RULE_OCCURRENCE_STACK=[],this.gastProductionsCache={},lt(n,"serializedGrammar"))throw Error(`The Parser's configuration can no longer contain a <serializedGrammar> property.
	See: https://chevrotain.io/docs/changes/BREAKING_CHANGES.html#_6-0-0
	For Further details.`);if(St(t)){if(Ut(t))throw Error(`A Token Vocabulary cannot be empty.
	Note that the first argument for the parser constructor
	is no longer a Token vector (since v4.0).`);if(typeof t[0].startOffset=="number")throw Error(`The Parser constructor no longer accepts a token vector as the first argument.
	See: https://chevrotain.io/docs/changes/BREAKING_CHANGES.html#_4-0-0
	For Further details.`)}if(St(t))this.tokensMap=ze(t,(s,o)=>(s[o.name]=o,s),{});else if(lt(t,"modes")&&bn(qe(oe(t.modes)),vT)){const s=qe(oe(t.modes)),o=ea(s);this.tokensMap=ze(o,(a,c)=>(a[c.name]=c,a),{})}else if(rn(t))this.tokensMap=Se(t);else throw new Error("<tokensDictionary> argument must be An Array of Token constructors, A dictionary of Token constructors or an IMultiModeLexerDefinition");this.tokensMap.EOF=oi;const r=lt(t,"modes")?qe(oe(t.modes)):oe(t),i=bn(r,s=>Ut(s.categoryMatches));this.tokenMatcher=i?pa:Ls,Ms(oe(this.tokensMap))}defineRule(t,n,r){if(this.selfAnalysisDone)throw Error(`Grammar rule <${t}> may not be defined after the 'performSelfAnalysis' method has been called'
Make sure that all grammar rule definitions are done before 'performSelfAnalysis' is called.`);const i=lt(r,"resyncEnabled")?r.resyncEnabled:Sa.resyncEnabled,s=lt(r,"recoveryValueFunc")?r.recoveryValueFunc:Sa.recoveryValueFunc,o=this.ruleShortNameIdx<<uR+Cr;this.ruleShortNameIdx++,this.shortRuleNameToFull[o]=t,this.fullRuleNameToShort[t]=o;let a;return this.outputCst===!0?a=function(...u){try{this.ruleInvocationStateUpdate(o,t,this.subruleIdx),n.apply(this,u);const f=this.CST_STACK[this.CST_STACK.length-1];return this.cstPostRule(f),f}catch(f){return this.invokeRuleCatch(f,i,s)}finally{this.ruleFinallyStateUpdate()}}:a=function(...u){try{return this.ruleInvocationStateUpdate(o,t,this.subruleIdx),n.apply(this,u)}catch(f){return this.invokeRuleCatch(f,i,s)}finally{this.ruleFinallyStateUpdate()}},Object.assign(a,{ruleName:t,originalGrammarAction:n})}invokeRuleCatch(t,n,r){const i=this.RULE_STACK.length===1,s=n&&!this.isBackTracking()&&this.recoveryEnabled;if(_a(t)){const o=t;if(s){const a=this.findReSyncTokenType();if(this.isInCurrentRuleReSyncSet(a))if(o.resyncedTokens=this.reSyncTo(a),this.outputCst){const c=this.CST_STACK[this.CST_STACK.length-1];return c.recoveredNode=!0,c}else return r(t);else{if(this.outputCst){const c=this.CST_STACK[this.CST_STACK.length-1];c.recoveredNode=!0,o.partialCstResult=c}throw o}}else{if(i)return this.moveToTerminatedState(),r(t);throw o}}else throw t}optionInternal(t,n){const r=this.getKeyForAutomaticLookahead(rm,n);return this.optionInternalLogic(t,n,r)}optionInternalLogic(t,n,r){let i=this.getLaFuncFromCache(r),s;if(typeof t!="function"){s=t.DEF;const o=t.GATE;if(o!==void 0){const a=i;i=()=>o.call(this)&&a.call(this)}}else s=t;if(i.call(this)===!0)return s.call(this)}atLeastOneInternal(t,n){const r=this.getKeyForAutomaticLookahead(Hl,t);return this.atLeastOneInternalLogic(t,n,r)}atLeastOneInternalLogic(t,n,r){let i=this.getLaFuncFromCache(r),s;if(typeof n!="function"){s=n.DEF;const o=n.GATE;if(o!==void 0){const a=i;i=()=>o.call(this)&&a.call(this)}}else s=n;if(i.call(this)===!0){let o=this.doSingleRepetition(s);for(;i.call(this)===!0&&o===!0;)o=this.doSingleRepetition(s)}else throw this.raiseEarlyExitException(t,Jt.REPETITION_MANDATORY,n.ERR_MSG);this.attemptInRepetitionRecovery(this.atLeastOneInternal,[t,n],i,Hl,t,NT)}atLeastOneSepFirstInternal(t,n){const r=this.getKeyForAutomaticLookahead(wa,t);this.atLeastOneSepFirstInternalLogic(t,n,r)}atLeastOneSepFirstInternalLogic(t,n,r){const i=n.DEF,s=n.SEP;if(this.getLaFuncFromCache(r).call(this)===!0){i.call(this);const a=()=>this.tokenMatcher(this.LA(1),s);for(;this.tokenMatcher(this.LA(1),s)===!0;)this.CONSUME(s),i.call(this);this.attemptInRepetitionRecovery(this.repetitionSepSecondInternal,[t,s,a,i,Fp],a,wa,t,Fp)}else throw this.raiseEarlyExitException(t,Jt.REPETITION_MANDATORY_WITH_SEPARATOR,n.ERR_MSG)}manyInternal(t,n){const r=this.getKeyForAutomaticLookahead(Kl,t);return this.manyInternalLogic(t,n,r)}manyInternalLogic(t,n,r){let i=this.getLaFuncFromCache(r),s;if(typeof n!="function"){s=n.DEF;const a=n.GATE;if(a!==void 0){const c=i;i=()=>a.call(this)&&c.call(this)}}else s=n;let o=!0;for(;i.call(this)===!0&&o===!0;)o=this.doSingleRepetition(s);this.attemptInRepetitionRecovery(this.manyInternal,[t,n],i,Kl,t,CT,o)}manySepFirstInternal(t,n){const r=this.getKeyForAutomaticLookahead(Vl,t);this.manySepFirstInternalLogic(t,n,r)}manySepFirstInternalLogic(t,n,r){const i=n.DEF,s=n.SEP;if(this.getLaFuncFromCache(r).call(this)===!0){i.call(this);const a=()=>this.tokenMatcher(this.LA(1),s);for(;this.tokenMatcher(this.LA(1),s)===!0;)this.CONSUME(s),i.call(this);this.attemptInRepetitionRecovery(this.repetitionSepSecondInternal,[t,s,a,i,$p],a,Vl,t,$p)}}repetitionSepSecondInternal(t,n,r,i,s){for(;r();)this.CONSUME(n),i.call(this);this.attemptInRepetitionRecovery(this.repetitionSepSecondInternal,[t,n,r,i,s],r,wa,t,s)}doSingleRepetition(t){const n=this.getLexerPosition();return t.call(this),this.getLexerPosition()>n}orInternal(t,n){const r=this.getKeyForAutomaticLookahead(nm,n),i=St(t)?t:t.DEF,o=this.getLaFuncFromCache(r).call(this,i);if(o!==void 0)return i[o].ALT.call(this);this.raiseNoAltException(n,t.ERR_MSG)}ruleFinallyStateUpdate(){if(this.RULE_STACK.pop(),this.RULE_OCCURRENCE_STACK.pop(),this.cstFinallyStateUpdate(),this.RULE_STACK.length===0&&this.isAtEndOfInput()===!1){const t=this.LA(1),n=this.errorMessageProvider.buildNotAllInputParsedMessage({firstRedundant:t,ruleName:this.getCurrRuleFullName()});this.SAVE_ERROR(new sR(n,t))}}subruleInternal(t,n,r){let i;try{const s=r!==void 0?r.ARGS:void 0;return this.subruleIdx=n,i=t.apply(this,s),this.cstPostNonTerminal(i,r!==void 0&&r.LABEL!==void 0?r.LABEL:t.ruleName),i}catch(s){throw this.subruleInternalError(s,r,t.ruleName)}}subruleInternalError(t,n,r){throw _a(t)&&t.partialCstResult!==void 0&&(this.cstPostNonTerminal(t.partialCstResult,n!==void 0&&n.LABEL!==void 0?n.LABEL:r),delete t.partialCstResult),t}consumeInternal(t,n,r){let i;try{const s=this.LA(1);this.tokenMatcher(s,t)===!0?(this.consumeToken(),i=s):this.consumeInternalError(t,s,r)}catch(s){i=this.consumeInternalRecovery(t,n,s)}return this.cstPostTerminal(r!==void 0&&r.LABEL!==void 0?r.LABEL:t.name,i),i}consumeInternalError(t,n,r){let i;const s=this.LA(0);throw r!==void 0&&r.ERR_MSG?i=r.ERR_MSG:i=this.errorMessageProvider.buildMismatchTokenMessage({expected:t,actual:n,previous:s,ruleName:this.getCurrRuleFullName()}),this.SAVE_ERROR(new tm(i,n,s))}consumeInternalRecovery(t,n,r){if(this.recoveryEnabled&&r.name==="MismatchedTokenException"&&!this.isBackTracking()){const i=this.getFollowsForInRuleRecovery(t,n);try{return this.tryInRuleRecovery(t,i)}catch(s){throw s.name===em?r:s}}else throw r}saveRecogState(){const t=this.errors,n=Se(this.RULE_STACK);return{errors:t,lexerState:this.exportLexerState(),RULE_STACK:n,CST_STACK:this.CST_STACK}}reloadRecogState(t){this.errors=t.errors,this.importLexerState(t.lexerState),this.RULE_STACK=t.RULE_STACK}ruleInvocationStateUpdate(t,n,r){this.RULE_OCCURRENCE_STACK.push(r),this.RULE_STACK.push(t),this.cstInvocationStateUpdate(n)}isBackTracking(){return this.isBackTrackingStack.length!==0}getCurrRuleFullName(){const t=this.getLastExplicitRuleShortName();return this.shortRuleNameToFull[t]}shortRuleNameToFullName(t){return this.shortRuleNameToFull[t]}isAtEndOfInput(){return this.tokenMatcher(this.LA(1),oi)}reset(){this.resetLexerState(),this.subruleIdx=0,this.isBackTrackingStack=[],this.errors=[],this.RULE_STACK=[],this.CST_STACK=[],this.RULE_OCCURRENCE_STACK=[]}}class RR{initErrorHandler(t){this._errors=[],this.errorMessageProvider=lt(t,"errorMessageProvider")?t.errorMessageProvider:dr.errorMessageProvider}SAVE_ERROR(t){if(_a(t))return t.context={ruleStack:this.getHumanReadableRuleStack(),ruleOccurrenceStack:Se(this.RULE_OCCURRENCE_STACK)},this._errors.push(t),t;throw Error("Trying to save an Error which is not a RecognitionException")}get errors(){return Se(this._errors)}set errors(t){this._errors=t}raiseEarlyExitException(t,n,r){const i=this.getCurrRuleFullName(),s=this.getGAstProductions()[i],a=jl(t,s,n,this.maxLookahead)[0],c=[];for(let u=1;u<=this.maxLookahead;u++)c.push(this.LA(u));const l=this.errorMessageProvider.buildEarlyExitMessage({expectedIterationPaths:a,actual:c,previous:this.LA(0),customUserDescription:r,ruleName:i});throw this.SAVE_ERROR(new oR(l,this.LA(1),this.LA(0)))}raiseNoAltException(t,n){const r=this.getCurrRuleFullName(),i=this.getGAstProductions()[r],s=Fl(t,i,this.maxLookahead),o=[];for(let l=1;l<=this.maxLookahead;l++)o.push(this.LA(l));const a=this.LA(0),c=this.errorMessageProvider.buildNoViableAltMessage({expectedPathsPerAlt:s,actual:o,previous:a,customUserDescription:n,ruleName:this.getCurrRuleFullName()});throw this.SAVE_ERROR(new iR(c,this.LA(1),a))}}class OR{initContentAssist(){}computeContentAssist(t,n){const r=this.gastProductionsCache[t];if(fr(r))throw Error(`Rule ->${t}<- does not exist in this grammar.`);return jp([r],n,this.tokenMatcher,this.maxLookahead)}getNextPossibleTokenTypes(t){const n=wn(t.ruleStack),i=this.getGAstProductions()[n];return new xT(i,t).startWalking()}}const Ea={description:"This Object indicates the Parser is during Recording Phase"};Object.freeze(Ea);const am=!0,cm=Math.pow(2,Cr)-1,lm=Je({name:"RECORDING_PHASE_TOKEN",pattern:ye.NA});Ms([lm]);const um=ma(lm,`This IToken indicates the Parser is in Recording Phase
	See: https://chevrotain.io/docs/guide/internals.html#grammar-recording for details`,-1,-1,-1,-1,-1,-1);Object.freeze(um);const IR={name:`This CSTNode indicates the Parser is in Recording Phase
	See: https://chevrotain.io/docs/guide/internals.html#grammar-recording for details`,children:{}};class xR{initGastRecorder(t){this.recordingProdStack=[],this.RECORDING_PHASE=!1}enableRecording(){this.RECORDING_PHASE=!0,this.TRACE_INIT("Enable Recording",()=>{for(let t=0;t<10;t++){const n=t>0?t:"";this[`CONSUME${n}`]=function(r,i){return this.consumeInternalRecord(r,t,i)},this[`SUBRULE${n}`]=function(r,i){return this.subruleInternalRecord(r,t,i)},this[`OPTION${n}`]=function(r){return this.optionInternalRecord(r,t)},this[`OR${n}`]=function(r){return this.orInternalRecord(r,t)},this[`MANY${n}`]=function(r){this.manyInternalRecord(t,r)},this[`MANY_SEP${n}`]=function(r){this.manySepFirstInternalRecord(t,r)},this[`AT_LEAST_ONE${n}`]=function(r){this.atLeastOneInternalRecord(t,r)},this[`AT_LEAST_ONE_SEP${n}`]=function(r){this.atLeastOneSepFirstInternalRecord(t,r)}}this.consume=function(t,n,r){return this.consumeInternalRecord(n,t,r)},this.subrule=function(t,n,r){return this.subruleInternalRecord(n,t,r)},this.option=function(t,n){return this.optionInternalRecord(n,t)},this.or=function(t,n){return this.orInternalRecord(n,t)},this.many=function(t,n){this.manyInternalRecord(t,n)},this.atLeastOne=function(t,n){this.atLeastOneInternalRecord(t,n)},this.ACTION=this.ACTION_RECORD,this.BACKTRACK=this.BACKTRACK_RECORD,this.LA=this.LA_RECORD})}disableRecording(){this.RECORDING_PHASE=!1,this.TRACE_INIT("Deleting Recording methods",()=>{const t=this;for(let n=0;n<10;n++){const r=n>0?n:"";delete t[`CONSUME${r}`],delete t[`SUBRULE${r}`],delete t[`OPTION${r}`],delete t[`OR${r}`],delete t[`MANY${r}`],delete t[`MANY_SEP${r}`],delete t[`AT_LEAST_ONE${r}`],delete t[`AT_LEAST_ONE_SEP${r}`]}delete t.consume,delete t.subrule,delete t.option,delete t.or,delete t.many,delete t.atLeastOne,delete t.ACTION,delete t.BACKTRACK,delete t.LA})}ACTION_RECORD(t){}BACKTRACK_RECORD(t,n){return()=>!0}LA_RECORD(t){return Aa}topLevelRuleRecord(t,n){try{const r=new Di({definition:[],name:t});return r.name=t,this.recordingProdStack.push(r),n.call(this),this.recordingProdStack.pop(),r}catch(r){if(r.KNOWN_RECORDER_ERROR!==!0)try{r.message=r.message+`
	 This error was thrown during the "grammar recording phase" For more info see:
	https://chevrotain.io/docs/guide/internals.html#grammar-recording`}catch{throw r}throw r}}optionInternalRecord(t,n){return Ps.call(this,Ke,t,n)}atLeastOneInternalRecord(t,n){Ps.call(this,Fn,n,t)}atLeastOneSepFirstInternalRecord(t,n){Ps.call(this,jn,n,t,am)}manyInternalRecord(t,n){Ps.call(this,ge,n,t)}manySepFirstInternalRecord(t,n){Ps.call(this,En,n,t,am)}orInternalRecord(t,n){return CR.call(this,t,n)}subruleInternalRecord(t,n,r){if(ka(n),!t||lt(t,"ruleName")===!1){const a=new Error(`<SUBRULE${hm(n)}> argument is invalid expecting a Parser method reference but got: <${JSON.stringify(t)}>
 inside top level rule: <${this.recordingProdStack[0].name}>`);throw a.KNOWN_RECORDER_ERROR=!0,a}const i=Mi(this.recordingProdStack),s=t.ruleName,o=new Ge({idx:n,nonTerminalName:s,label:r==null?void 0:r.LABEL,referencedRule:void 0});return i.definition.push(o),this.outputCst?IR:Ea}consumeInternalRecord(t,n,r){if(ka(n),!Rp(t)){const o=new Error(`<CONSUME${hm(n)}> argument is invalid expecting a TokenType reference but got: <${JSON.stringify(t)}>
 inside top level rule: <${this.recordingProdStack[0].name}>`);throw o.KNOWN_RECORDER_ERROR=!0,o}const i=Mi(this.recordingProdStack),s=new Ht({idx:n,terminalType:t,label:r==null?void 0:r.LABEL});return i.definition.push(s),um}}function Ps(e,t,n,r=!1){ka(n);const i=Mi(this.recordingProdStack),s=cr(t)?t:t.DEF,o=new e({definition:[],idx:n});return r&&(o.separator=t.SEP),lt(t,"MAX_LOOKAHEAD")&&(o.maxLookahead=t.MAX_LOOKAHEAD),this.recordingProdStack.push(o),s.call(this),i.definition.push(o),this.recordingProdStack.pop(),Ea}function CR(e,t){ka(t);const n=Mi(this.recordingProdStack),r=St(e)===!1,i=r===!1?e:e.DEF,s=new kn({definition:[],idx:t,ignoreAmbiguities:r&&e.IGNORE_AMBIGUITIES===!0});lt(e,"MAX_LOOKAHEAD")&&(s.maxLookahead=e.MAX_LOOKAHEAD);const o=xl(i,a=>cr(a.GATE));return s.hasPredicates=o,n.definition.push(s),ut(i,a=>{const c=new We({definition:[]});s.definition.push(c),lt(a,"IGNORE_AMBIGUITIES")?c.ignoreAmbiguities=a.IGNORE_AMBIGUITIES:lt(a,"GATE")&&(c.ignoreAmbiguities=!0),this.recordingProdStack.push(c),a.ALT.call(this),this.recordingProdStack.pop()}),Ea}function hm(e){return e===0?"":`${e}`}function ka(e){if(e<0||e>cm){const t=new Error(`Invalid DSL Method idx value: <${e}>
	Idx value must be a none negative value smaller than ${cm+1}`);throw t.KNOWN_RECORDER_ERROR=!0,t}}class NR{initPerformanceTracer(t){if(lt(t,"traceInitPerf")){const n=t.traceInitPerf,r=typeof n=="number";this.traceInitMaxIdent=r?n:1/0,this.traceInitPerf=r?n>0:n}else this.traceInitMaxIdent=0,this.traceInitPerf=dr.traceInitPerf;this.traceInitIndent=-1}TRACE_INIT(t,n){if(this.traceInitPerf===!0){this.traceInitIndent++;const r=new Array(this.traceInitIndent+1).join("	");this.traceInitIndent<this.traceInitMaxIdent&&console.log(`${r}--> <${t}>`);const{time:i,value:s}=up(n),o=i>10?console.warn:console.log;return this.traceInitIndent<this.traceInitMaxIdent&&o(`${r}<-- <${t}> time: ${i}ms`),this.traceInitIndent--,s}else return n()}}function LR(e,t){t.forEach(n=>{const r=n.prototype;Object.getOwnPropertyNames(r).forEach(i=>{if(i==="constructor")return;const s=Object.getOwnPropertyDescriptor(r,i);s&&(s.get||s.set)?Object.defineProperty(e.prototype,i,s):e.prototype[i]=n.prototype[i]})})}const Aa=ma(oi,"",NaN,NaN,NaN,NaN,NaN,NaN);Object.freeze(Aa);const dr=Object.freeze({recoveryEnabled:!1,maxLookahead:3,dynamicTokensEnabled:!1,outputCst:!0,errorMessageProvider:Bp,nodeLocationTracking:"none",traceInitPerf:!1,skipValidations:!1}),Sa=Object.freeze({recoveryValueFunc:()=>{},resyncEnabled:!0});var Ue;(function(e){e[e.INVALID_RULE_NAME=0]="INVALID_RULE_NAME",e[e.DUPLICATE_RULE_NAME=1]="DUPLICATE_RULE_NAME",e[e.INVALID_RULE_OVERRIDE=2]="INVALID_RULE_OVERRIDE",e[e.DUPLICATE_PRODUCTIONS=3]="DUPLICATE_PRODUCTIONS",e[e.UNRESOLVED_SUBRULE_REF=4]="UNRESOLVED_SUBRULE_REF",e[e.LEFT_RECURSION=5]="LEFT_RECURSION",e[e.NONE_LAST_EMPTY_ALT=6]="NONE_LAST_EMPTY_ALT",e[e.AMBIGUOUS_ALTS=7]="AMBIGUOUS_ALTS",e[e.CONFLICT_TOKENS_RULES_NAMESPACE=8]="CONFLICT_TOKENS_RULES_NAMESPACE",e[e.INVALID_TOKEN_NAME=9]="INVALID_TOKEN_NAME",e[e.NO_NON_EMPTY_LOOKAHEAD=10]="NO_NON_EMPTY_LOOKAHEAD",e[e.AMBIGUOUS_PREFIX_ALTS=11]="AMBIGUOUS_PREFIX_ALTS",e[e.TOO_MANY_ALTS=12]="TOO_MANY_ALTS",e[e.CUSTOM_LOOKAHEAD_VALIDATION=13]="CUSTOM_LOOKAHEAD_VALIDATION"})(Ue||(Ue={}));class Bs{static performSelfAnalysis(t){throw Error("The **static** `performSelfAnalysis` method has been deprecated.	\nUse the **instance** method with the same name instead.")}performSelfAnalysis(){this.TRACE_INIT("performSelfAnalysis",()=>{let t;this.selfAnalysisDone=!0;const n=this.className;this.TRACE_INIT("toFastProps",()=>{hp(this)}),this.TRACE_INIT("Grammar Recording",()=>{try{this.enableRecording(),ut(this.definedRulesNames,i=>{const o=this[i].originalGrammarAction;let a;this.TRACE_INIT(`${i} Rule`,()=>{a=this.topLevelRuleRecord(i,o)}),this.gastProductionsCache[i]=a})}finally{this.disableRecording()}});let r=[];if(this.TRACE_INIT("Grammar Resolving",()=>{r=nR({rules:oe(this.gastProductionsCache)}),this.definitionErrors=this.definitionErrors.concat(r)}),this.TRACE_INIT("Grammar Validations",()=>{if(Ut(r)&&this.skipValidations===!1){const i=rR({rules:oe(this.gastProductionsCache),tokenTypes:oe(this.tokensMap),errMsgProvider:ai,grammarName:n}),s=jT({lookaheadStrategy:this.lookaheadStrategy,rules:oe(this.gastProductionsCache),tokenTypes:oe(this.tokensMap),grammarName:n});this.definitionErrors=this.definitionErrors.concat(i,s)}}),Ut(this.definitionErrors)&&(this.recoveryEnabled&&this.TRACE_INIT("computeAllProdsFollows",()=>{const i=MS(oe(this.gastProductionsCache));this.resyncFollows=i}),this.TRACE_INIT("ComputeLookaheadFunctions",()=>{var i,s;(s=(i=this.lookaheadStrategy).initialize)===null||s===void 0||s.call(i,{rules:oe(this.gastProductionsCache)}),this.preComputeLookaheadFunctions(oe(this.gastProductionsCache))})),!Bs.DEFER_DEFINITION_ERRORS_HANDLING&&!Ut(this.definitionErrors))throw t=et(this.definitionErrors,i=>i.message),new Error(`Parser Definition Errors detected:
 ${t.join(`
-------------------------------
`)}`)})}constructor(t,n){this.definitionErrors=[],this.selfAnalysisDone=!1;const r=this;if(r.initErrorHandler(n),r.initLexerAdapter(),r.initLooksAhead(n),r.initRecognizerEngine(t,n),r.initRecoverable(n),r.initTreeBuilder(n),r.initContentAssist(),r.initGastRecorder(n),r.initPerformanceTracer(n),lt(n,"ignoredIssues"))throw new Error(`The <ignoredIssues> IParserConfig property has been deprecated.
	Please use the <IGNORE_AMBIGUITIES> flag on the relevant DSL method instead.
	See: https://chevrotain.io/docs/guide/resolving_grammar_errors.html#IGNORING_AMBIGUITIES
	For further details.`);this.skipValidations=lt(n,"skipValidations")?n.skipValidations:dr.skipValidations}}Bs.DEFER_DEFINITION_ERRORS_HANDLING=!1,LR(Bs,[cR,fR,kR,AR,TR,SR,RR,OR,xR,NR]);class MR extends Bs{constructor(t,n=dr){const r=Se(n);r.outputCst=!0,super(t,r)}}function UR(e){const t=new DR,n=oe(e);return et(n,r=>t.visitRule(r))}class DR extends ii{visitRule(t){const n=this.visitEach(t.definition),r=op(n,s=>s.propertyName),i=et(r,(s,o)=>{const a=!xl(s,l=>!l.canBeNull);let c=s[0].type;return s.length>1&&(c=et(s,l=>l.type)),{name:o,type:c,optional:a}});return{name:t.name,properties:i}}visitAlternative(t){return this.visitEachAndOverrideWith(t.definition,{canBeNull:!0})}visitOption(t){return this.visitEachAndOverrideWith(t.definition,{canBeNull:!0})}visitRepetition(t){return this.visitEachAndOverrideWith(t.definition,{canBeNull:!0})}visitRepetitionMandatory(t){return this.visitEach(t.definition)}visitRepetitionMandatoryWithSeparator(t){return this.visitEach(t.definition).concat({propertyName:t.separator.name,canBeNull:!0,type:Ta(t.separator)})}visitRepetitionWithSeparator(t){return this.visitEachAndOverrideWith(t.definition,{canBeNull:!0}).concat({propertyName:t.separator.name,canBeNull:!0,type:Ta(t.separator)})}visitAlternation(t){return this.visitEachAndOverrideWith(t.definition,{canBeNull:!0})}visitTerminal(t){return[{propertyName:t.label||t.terminalType.name,canBeNull:!1,type:Ta(t)}]}visitNonTerminal(t){return[{propertyName:t.label||t.nonTerminalName,canBeNull:!1,type:Ta(t)}]}visitEachAndOverrideWith(t,n){return et(this.visitEach(t),r=>Fe({},r,n))}visitEach(t){return qe(et(t,n=>this.visit(n)))}}function Ta(e){return e instanceof Ge?{kind:"rule",name:e.referencedRule.name}:{kind:"token"}}function PR(e,t){let n=[];return n=n.concat('import type { CstNode, ICstVisitor, IToken } from "chevrotain";'),n=n.concat(qe(et(e,r=>BR(r)))),t.includeVisitorInterface&&(n=n.concat(zR(t.visitorInterfaceName,e))),n.join(`

`)+`
`}function BR(e){const t=$R(e),n=FR(e);return[t,n]}function $R(e){const t=dm(e.name),n=Jl(e.name);return`export interface ${t} extends CstNode {
  name: "${e.name}";
  children: ${n};
}`}function FR(e){return`export type ${Jl(e.name)} = {
  ${et(e.properties,n=>jR(n)).join(`
  `)}
};`}function jR(e){const t=WR(e.type);return`${e.name}${e.optional?"?":""}: ${t}[];`}function zR(e,t){return`export interface ${e}<IN, OUT> extends ICstVisitor<IN, OUT> {
  ${et(t,n=>GR(n)).join(`
  `)}
}`}function GR(e){const t=Jl(e.name);return`${e.name}(children: ${t}, param?: IN): OUT;`}function WR(e){if(St(e)){const t=ea(et(e,r=>fm(r)));return"("+ze(t,(r,i)=>r+" | "+i)+")"}else return fm(e)}function fm(e){return e.kind==="token"?"IToken":dm(e.name)}function dm(e){return Od(e)+"CstNode"}function Jl(e){return Od(e)+"CstChildren"}const KR={includeVisitorInterface:!0,visitorInterfaceName:"ICstNodeVisitor"};function HR(e,t){const n=Object.assign(Object.assign({},KR),t),r=UR(e);return PR(r,n)}var pm={exports:{}},bt={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var $s=Symbol.for("react.element"),VR=Symbol.for("react.portal"),YR=Symbol.for("react.fragment"),qR=Symbol.for("react.strict_mode"),JR=Symbol.for("react.profiler"),XR=Symbol.for("react.provider"),ZR=Symbol.for("react.context"),QR=Symbol.for("react.forward_ref"),tO=Symbol.for("react.suspense"),eO=Symbol.for("react.memo"),nO=Symbol.for("react.lazy"),mm=Symbol.iterator;function rO(e){return e===null||typeof e!="object"?null:(e=mm&&e[mm]||e["@@iterator"],typeof e=="function"?e:null)}var gm={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},ym=Object.assign,_m={};function Bi(e,t,n){this.props=e,this.context=t,this.refs=_m,this.updater=n||gm}Bi.prototype.isReactComponent={},Bi.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")},Bi.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function bm(){}bm.prototype=Bi.prototype;function Xl(e,t,n){this.props=e,this.context=t,this.refs=_m,this.updater=n||gm}var Zl=Xl.prototype=new bm;Zl.constructor=Xl,ym(Zl,Bi.prototype),Zl.isPureReactComponent=!0;var wm=Array.isArray,vm=Object.prototype.hasOwnProperty,Ql={current:null},Em={key:!0,ref:!0,__self:!0,__source:!0};function km(e,t,n){var r,i={},s=null,o=null;if(t!=null)for(r in t.ref!==void 0&&(o=t.ref),t.key!==void 0&&(s=""+t.key),t)vm.call(t,r)&&!Em.hasOwnProperty(r)&&(i[r]=t[r]);var a=arguments.length-2;if(a===1)i.children=n;else if(1<a){for(var c=Array(a),l=0;l<a;l++)c[l]=arguments[l+2];i.children=c}if(e&&e.defaultProps)for(r in a=e.defaultProps,a)i[r]===void 0&&(i[r]=a[r]);return{$$typeof:$s,type:e,key:s,ref:o,props:i,_owner:Ql.current}}function iO(e,t){return{$$typeof:$s,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function tu(e){return typeof e=="object"&&e!==null&&e.$$typeof===$s}function sO(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(n){return t[n]})}var Am=/\/+/g;function eu(e,t){return typeof e=="object"&&e!==null&&e.key!=null?sO(""+e.key):t.toString(36)}function Ra(e,t,n,r,i){var s=typeof e;(s==="undefined"||s==="boolean")&&(e=null);var o=!1;if(e===null)o=!0;else switch(s){case"string":case"number":o=!0;break;case"object":switch(e.$$typeof){case $s:case VR:o=!0}}if(o)return o=e,i=i(o),e=r===""?"."+eu(o,0):r,wm(i)?(n="",e!=null&&(n=e.replace(Am,"$&/")+"/"),Ra(i,t,n,"",function(l){return l})):i!=null&&(tu(i)&&(i=iO(i,n+(!i.key||o&&o.key===i.key?"":(""+i.key).replace(Am,"$&/")+"/")+e)),t.push(i)),1;if(o=0,r=r===""?".":r+":",wm(e))for(var a=0;a<e.length;a++){s=e[a];var c=r+eu(s,a);o+=Ra(s,t,n,c,i)}else if(c=rO(e),typeof c=="function")for(e=c.call(e),a=0;!(s=e.next()).done;)s=s.value,c=r+eu(s,a++),o+=Ra(s,t,n,c,i);else if(s==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return o}function Oa(e,t,n){if(e==null)return e;var r=[],i=0;return Ra(e,r,"","",function(s){return t.call(n,s,i++)}),r}function oO(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(n){(e._status===0||e._status===-1)&&(e._status=1,e._result=n)},function(n){(e._status===0||e._status===-1)&&(e._status=2,e._result=n)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var De={current:null},Ia={transition:null},aO={ReactCurrentDispatcher:De,ReactCurrentBatchConfig:Ia,ReactCurrentOwner:Ql};function Sm(){throw Error("act(...) is not supported in production builds of React.")}bt.Children={map:Oa,forEach:function(e,t,n){Oa(e,function(){t.apply(this,arguments)},n)},count:function(e){var t=0;return Oa(e,function(){t++}),t},toArray:function(e){return Oa(e,function(t){return t})||[]},only:function(e){if(!tu(e))throw Error("React.Children.only expected to receive a single React element child.");return e}},bt.Component=Bi,bt.Fragment=YR,bt.Profiler=JR,bt.PureComponent=Xl,bt.StrictMode=qR,bt.Suspense=tO,bt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=aO,bt.act=Sm,bt.cloneElement=function(e,t,n){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var r=ym({},e.props),i=e.key,s=e.ref,o=e._owner;if(t!=null){if(t.ref!==void 0&&(s=t.ref,o=Ql.current),t.key!==void 0&&(i=""+t.key),e.type&&e.type.defaultProps)var a=e.type.defaultProps;for(c in t)vm.call(t,c)&&!Em.hasOwnProperty(c)&&(r[c]=t[c]===void 0&&a!==void 0?a[c]:t[c])}var c=arguments.length-2;if(c===1)r.children=n;else if(1<c){a=Array(c);for(var l=0;l<c;l++)a[l]=arguments[l+2];r.children=a}return{$$typeof:$s,type:e.type,key:i,ref:s,props:r,_owner:o}},bt.createContext=function(e){return e={$$typeof:ZR,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:XR,_context:e},e.Consumer=e},bt.createElement=km,bt.createFactory=function(e){var t=km.bind(null,e);return t.type=e,t},bt.createRef=function(){return{current:null}},bt.forwardRef=function(e){return{$$typeof:QR,render:e}},bt.isValidElement=tu,bt.lazy=function(e){return{$$typeof:nO,_payload:{_status:-1,_result:e},_init:oO}},bt.memo=function(e,t){return{$$typeof:eO,type:e,compare:t===void 0?null:t}},bt.startTransition=function(e){var t=Ia.transition;Ia.transition={};try{e()}finally{Ia.transition=t}},bt.unstable_act=Sm,bt.useCallback=function(e,t){return De.current.useCallback(e,t)},bt.useContext=function(e){return De.current.useContext(e)},bt.useDebugValue=function(){},bt.useDeferredValue=function(e){return De.current.useDeferredValue(e)},bt.useEffect=function(e,t){return De.current.useEffect(e,t)},bt.useId=function(){return De.current.useId()},bt.useImperativeHandle=function(e,t,n){return De.current.useImperativeHandle(e,t,n)},bt.useInsertionEffect=function(e,t){return De.current.useInsertionEffect(e,t)},bt.useLayoutEffect=function(e,t){return De.current.useLayoutEffect(e,t)},bt.useMemo=function(e,t){return De.current.useMemo(e,t)},bt.useReducer=function(e,t,n){return De.current.useReducer(e,t,n)},bt.useRef=function(e){return De.current.useRef(e)},bt.useState=function(e){return De.current.useState(e)},bt.useSyncExternalStore=function(e,t,n){return De.current.useSyncExternalStore(e,t,n)},bt.useTransition=function(){return De.current.useTransition()},bt.version="18.3.1",pm.exports=bt;var cO=pm.exports;const lO=Gc(32,126).map(e=>String.fromCharCode(e)),uO=Je({name:"Whitespace",pattern:/ +/}),hO=Je({name:"WhitespaceSkipped",pattern:/ +/,group:ye.SKIPPED}),Tm=Je({name:"Newline",line_breaks:!0,start_chars_hint:[`
`,"\r"],pattern:/\n|\r\n?/}),Rm=Je({name:"StringLiteral",pattern:/[^ $;\r\n]+/,start_chars_hint:lO}),Om=Je({name:"StringLiteralDouble",pattern:/"(?:[^\\"]|\\(?:[^\n\r]|u[0-9a-fA-F]{4}))*"/}),Im=Je({name:"EscapedDollar",pattern:"$$"}),nu=Je({name:"MaybeFlag",pattern:/\$[^ $\r\n]+/}),xm=Je({name:"NumberLiteral",pattern:/\$-?(\d*\.)?\d+([eE][+-]?\d+)?[jJ]?[lL]?\+?/}),Cm=Je({name:"HyperLinkText",pattern:/;[^;\r\n]*/,start_chars_hint:[";"]});function fO(e,t=""){return Je({name:t||e,pattern:new RegExp(e.toLowerCase(),"i")})}const Nm=Object.keys(Xc).map(e=>fO(`\\$(${e})`,e)),dO=[uO,Tm,...Nm,Om,Rm,xm,Im,Cm,nu],pO=new ye(dO,{skipValidations:!Mn,ensureOptimizations:Mn}),mO=new ye([hO,Tm,...Nm,Om,Rm,xm,Im,Cm,nu],{skipValidations:!Mn,ensureOptimizations:Mn});function gO(e,t=!1){return t?mO.tokenize(e):pO.tokenize(e)}function yO(e,t,n,r,i,s,o,a){return{disablewrap:!1,measureonly:!1,measuredwidth:0,writefullwidth:void 0,x:0,y:0,iseven:!0,active:{color:n,bg:r,topedge:i,leftedge:s,rightedge:o,bottomedge:a},reset:{color:n,bg:r,topedge:i,leftedge:s,rightedge:o,bottomedge:a},width:e,height:t,char:[],color:[],bg:[]}}cO.createContext(yO(1,1,15,1));const ru=Gc(32,126).map(e=>String.fromCharCode(e));function kt(e){return Je({...e,name:`token_${e.name}`})}function Gn(e,t=!1){return kt(t?{name:e,pattern:new RegExp(e.toLowerCase(),"i"),longer_alt:He,group:ye.SKIPPED}:{name:e,pattern:new RegExp(e.toLowerCase(),"i"),longer_alt:He})}const ci=kt({name:"newline",line_breaks:!0,start_chars_hint:[`
`,"\r"],pattern:/\n|\r\n?/}),_O=kt({name:"whitespace",pattern:/ +/,group:ye.SKIPPED}),bO=kt({name:"whitespace",pattern:/\s+/,line_breaks:!0,group:ye.SKIPPED}),iu=kt({name:"stat",pattern:/@.*/,start_chars_hint:["@"]}),$i=kt({name:"command",pattern:/#/,start_chars_hint:["#"]});let Lm=!1;function wO(e,t,n){if(!Lm)return null;const[r]=n.slice(-1);if(r&&r.tokenType!==ci)return null;let i=t;for(;e[i]===" ";)i++;if(`@#/?':!"`.includes(e[i]))return null;let s=t+1;for(;s<e.length&&e[s]!==`
`;)s++;return[e.substring(t,s)]}const Mm=kt({name:"text",pattern:wO,line_breaks:!1,start_chars_hint:ru.filter(e=>"@#/?':!".includes(e)===!1)}),Um=kt({name:"comment",pattern:/'.*/,start_chars_hint:["'"]}),Dm=kt({name:"label",pattern:/:[^;:\n]*/,start_chars_hint:[":"]}),Pm=kt({name:"hyperlink",pattern:/!/,start_chars_hint:["!"]}),Bm=kt({name:"hyperlinktext",pattern:/;[^;\n]*/,start_chars_hint:[";"]}),He=kt({name:"stringliteral",pattern:/[^-0-9"!;@#/?\s]+[^-"!;@#/?\s]*/,start_chars_hint:ru}),su=kt({name:"stringliteraldouble",pattern:/"(?:[^\\"]|\\(?:[^\n\r]|u[0-9a-fA-F]{4}))*"/}),$m=kt({name:"numberliteral",pattern:/-?(\d*\.)?\d+([eE][+-]?\d+)?[jJ]?[lL]?/}),Fm=kt({name:"iseq",pattern:/=|is|eq|equal/,longer_alt:He}),jm=kt({name:"isnoteq",pattern:/!=|not ?eq|not ?equal/,longer_alt:He}),zm=kt({name:"islessthan",pattern:/<|below/,longer_alt:He}),Gm=kt({name:"isgreaterthan",pattern:/>|above/,longer_alt:He}),Wm=kt({name:"islessthanorequal",pattern:/<=|below ?or ?eq|below ?or ?equal/,longer_alt:He}),Km=kt({name:"isgreaterthanorequal",pattern:/>=|above ?or ?eq|above ?or ?equal/,longer_alt:He}),ou=kt({name:"or",pattern:/or/i,longer_alt:He}),au=kt({name:"not",pattern:/not/i,longer_alt:He}),cu=kt({name:"and",pattern:/and/i,longer_alt:He}),lu=kt({name:"plus",pattern:/\+/}),uu=kt({name:"minus",pattern:/-/}),Hm=kt({name:"power",pattern:/\*\*/}),Vm=kt({name:"multiply",pattern:/\*/}),hu=kt({name:"divide",pattern:/\//}),Ym=kt({name:"moddivide",pattern:/%/}),qm=kt({name:"floordivide",pattern:/%%/}),Jm=kt({name:"query",pattern:/\?/}),Xm=kt({name:"lparen",pattern:/\(/,push_mode:"ignore_newlines"}),Zm=kt({name:"rparen",pattern:/\)/,pop_mode:!0}),Qm=kt({name:"command_play",pattern:/play .*/,start_chars_hint:ru,longer_alt:He}),fu=Gn("if"),tg=Gn("do"),du=Gn("done"),vO=Gn("then",!0),pu=Gn("else"),eg=Gn("while"),ng=Gn("repeat"),EO=Gn("into"),rg=Gn("break"),ig=Gn("continue");function sg(e){return[...e,$m,Fm,jm,Wm,zm,Km,Gm,ou,au,cu,lu,uu,Hm,Vm,hu,qm,Ym,Jm,Xm,Zm,su,He]}const og=sg([Mm,iu,Qm,$i,Um,Dm,Pm,Bm,ci,_O,fu,du,tg,vO,pu,eg,ng,EO,rg,ig]),kO=new ye({defaultMode:"use_newlines",modes:{use_newlines:og,ignore_newlines:sg([bO])}},{skipValidations:!Mn,ensureOptimizations:Mn});function mu(e){Lm=!0;const t=kO.tokenize(e||` 
`),[n]=(ne(t.tokens)?t.tokens:[]).slice(-1);return n&&n.tokenType.name!=="Newline"&&t.tokens.push(ma(ci,`
`,n.startOffset,n.endOffset??NaN,n.startLine??NaN,n.endLine??NaN,n.startColumn??NaN,n.endColumn??NaN)),t}let ag=0;const cg=Mn,AO=["Command","lines"];class SO extends MR{constructor(){super(og,{traceInitPerf:Mn,skipValidations:!Mn,maxLookahead:2,recoveryEnabled:!0,nodeLocationTracking:"full"});X(this,"program",this.RULED("program",()=>{this.MANY(()=>this.SUBRULE(this.line))}));X(this,"line",this.RULED("line",()=>{this.OR([{ALT:()=>this.SUBRULE(this.stmt)},{ALT:()=>this.CONSUME(ci)}])}));X(this,"stmt",this.RULED("stmt",()=>{this.OR([{ALT:()=>this.SUBRULE(this.stmt_label)},{ALT:()=>this.SUBRULE(this.stmt_stat)},{ALT:()=>this.SUBRULE(this.stmt_text)},{ALT:()=>this.SUBRULE(this.stmt_comment)},{ALT:()=>this.SUBRULE(this.stmt_hyperlink)},{ALT:()=>this.SUBRULE(this.stmt_command)},{ALT:()=>{this.AT_LEAST_ONE(()=>this.SUBRULE(this.short_commands)),this.MANY(()=>this.SUBRULE(this.commands))}}])}));X(this,"do_block",this.RULED("do_block",()=>{this.CONSUME(tg),this.MANY(()=>this.CONSUME(ci)),this.AT_LEAST_ONE({GATE:this.BACKTRACK(this.do_line),DEF:()=>this.SUBRULE(this.do_line)})}));X(this,"do_line",this.RULED("do_line",()=>{this.SUBRULE(this.do_stmt),this.AT_LEAST_ONE(()=>this.CONSUME(ci))}));X(this,"do_stmt",this.RULED("do_stmt",()=>{this.OR([{ALT:()=>this.SUBRULE(this.stmt_stat)},{ALT:()=>this.SUBRULE(this.stmt_text)},{ALT:()=>this.SUBRULE(this.stmt_comment)},{ALT:()=>this.SUBRULE(this.stmt_hyperlink)},{ALT:()=>this.SUBRULE(this.stmt_command)},{ALT:()=>{this.AT_LEAST_ONE(()=>this.SUBRULE(this.short_commands)),this.MANY(()=>this.SUBRULE(this.commands))}}])}));X(this,"do_inline",this.RULED("do_inline",()=>{this.OR([{ALT:()=>this.SUBRULE(this.stmt_stat)},{ALT:()=>this.SUBRULE(this.stmt_text)},{ALT:()=>this.SUBRULE(this.stmt_comment)},{ALT:()=>this.SUBRULE(this.stmt_hyperlink)},{ALT:()=>this.SUBRULE(this.stmt_command)},{GATE:this.BACKTRACK(this.commands),ALT:()=>this.MANY(()=>this.SUBRULE(this.commands))}])}));X(this,"stmt_label",this.RULED("stmt_label",()=>{this.CONSUME(Dm)}));X(this,"stmt_stat",this.RULED("stmt_stat",()=>{this.CONSUME(iu)}));X(this,"stmt_text",this.RULED("stmt_text",()=>{this.OR([{ALT:()=>this.CONSUME(su)},{ALT:()=>this.CONSUME(Mm)}])}));X(this,"stmt_comment",this.RULED("stmt_comment",()=>{this.CONSUME(Um)}));X(this,"stmt_hyperlink",this.RULED("stmt_hyperlink",()=>{this.CONSUME(Pm),this.SUBRULE(this.words),this.CONSUME(Bm)}));X(this,"stmt_command",this.RULED("stmt_command",()=>{this.CONSUME($i),this.AT_LEAST_ONE(()=>this.SUBRULE(this.commands))}));X(this,"short_commands",this.RULED("short_commands",()=>{this.OR([{ALT:()=>this.SUBRULE(this.short_go)},{ALT:()=>this.SUBRULE(this.short_try)}])}));X(this,"commands",this.RULED("commands",()=>{this.OR([{ALT:()=>this.SUBRULE(this.words)},{ALT:()=>this.SUBRULE(this.short_go)},{ALT:()=>this.SUBRULE(this.short_try)},{ALT:()=>this.SUBRULE(this.command_play)},{ALT:()=>this.SUBRULE(this.structured_cmd)}])}));X(this,"structured_cmd",this.RULED("structured_cmd",()=>{this.OR([{ALT:()=>this.SUBRULE(this.command_if)},{ALT:()=>this.SUBRULE(this.command_while)},{ALT:()=>this.SUBRULE(this.command_repeat)},{ALT:()=>this.SUBRULE(this.command_break)},{ALT:()=>this.SUBRULE(this.command_continue)}])}));X(this,"short_go",this.RULED("short_go",()=>{this.CONSUME(hu),this.SUBRULE(this.words)}));X(this,"short_try",this.RULED("short_try",()=>{this.CONSUME(Jm),this.SUBRULE(this.words)}));X(this,"command_if",this.RULED("command_if",()=>{this.CONSUME(fu),this.SUBRULE(this.words),this.OPTION({GATE:this.BACKTRACK(this.command_if_block),DEF:()=>this.SUBRULE(this.command_if_block)})}));X(this,"command_if_block",this.RULED("command_if_block",()=>{this.OR([{GATE:this.BACKTRACK(this.do_inline),ALT:()=>this.SUBRULE(this.do_inline)},{ALT:()=>{this.SUBRULE(this.do_block),this.MANY({GATE:this.BACKTRACK(this.command_else_if),DEF:()=>this.SUBRULE(this.command_else_if)}),this.OPTION2({GATE:this.BACKTRACK(this.command_else),DEF:()=>this.SUBRULE(this.command_else)}),this.MANY2(()=>this.CONSUME(ci)),this.CONSUME($i),this.CONSUME(du)}}])}));X(this,"command_block",this.RULED("command_block",()=>{this.OR([{GATE:this.BACKTRACK(this.do_inline),ALT:()=>this.SUBRULE(this.do_inline)},{GATE:this.BACKTRACK(this.do_block),ALT:()=>this.SUBRULE(this.do_block)}])}));X(this,"command_else_if",this.RULED("command_else_if",()=>{this.CONSUME($i),this.CONSUME(pu),this.CONSUME(fu),this.SUBRULE(this.words),this.OPTION({GATE:this.BACKTRACK(this.command_block),DEF:()=>this.SUBRULE(this.command_block)})}));X(this,"command_else",this.RULED("command_else",()=>{this.CONSUME($i),this.CONSUME(pu),this.OPTION({GATE:this.BACKTRACK(this.command_block),DEF:()=>this.SUBRULE(this.command_block)})}));X(this,"command_loop",this.RULED("command_loop",()=>{this.OR([{GATE:this.BACKTRACK(this.do_inline),ALT:()=>this.SUBRULE(this.do_inline)},{GATE:this.BACKTRACK(this.do_block),ALT:()=>{this.SUBRULE(this.do_block),this.CONSUME($i),this.CONSUME(du)}}])}));X(this,"command_while",this.RULED("command_while",()=>{this.CONSUME(eg),this.SUBRULE(this.words),this.OPTION({GATE:this.BACKTRACK(this.command_loop),DEF:()=>this.SUBRULE(this.command_loop)})}));X(this,"command_repeat",this.RULED("command_repeat",()=>{this.CONSUME(ng),this.SUBRULE(this.words),this.OPTION({GATE:this.BACKTRACK(this.command_loop),DEF:()=>this.SUBRULE(this.command_loop)})}));X(this,"command_break",this.RULED("command_break",()=>{this.CONSUME(rg)}));X(this,"command_continue",this.RULED("command_continue",()=>{this.CONSUME(ig)}));X(this,"command_play",this.RULED("command_play",()=>{this.CONSUME(Qm)}));X(this,"expr",this.RULED("expr",()=>{this.SUBRULE1(this.and_test),this.MANY(()=>{this.CONSUME(ou),this.SUBRULE2(this.and_test)})}));X(this,"and_test",this.RULED("and_test",()=>{this.SUBRULE1(this.not_test),this.MANY(()=>{this.CONSUME(cu),this.SUBRULE2(this.not_test)})}));X(this,"not_test",this.RULED("not_test",()=>{this.OR([{ALT:()=>{this.CONSUME(au),this.SUBRULE1(this.not_test)}},{ALT:()=>this.SUBRULE2(this.comparison)}])}));X(this,"comparison",this.RULED("comparison",()=>{this.SUBRULE1(this.arith_expr),this.MANY(()=>{this.SUBRULE(this.comp_op),this.SUBRULE2(this.arith_expr)})}));X(this,"comp_op",this.RULED("comp_op",()=>{this.OR([{ALT:()=>this.CONSUME(Fm)},{ALT:()=>this.CONSUME(jm)},{ALT:()=>this.CONSUME(zm)},{ALT:()=>this.CONSUME(Gm)},{ALT:()=>this.CONSUME(Wm)},{ALT:()=>this.CONSUME(Km)}])}));X(this,"expr_value",this.RULED("expr_value",()=>{this.SUBRULE1(this.and_test_value),this.MANY(()=>{this.CONSUME(ou),this.SUBRULE2(this.and_test_value)})}));X(this,"and_test_value",this.RULED("and_test_value",()=>{this.SUBRULE1(this.not_test_value),this.MANY(()=>{this.CONSUME(cu),this.SUBRULE2(this.not_test_value)})}));X(this,"not_test_value",this.RULED("not_test_value",()=>{this.OR([{ALT:()=>{this.CONSUME(au),this.SUBRULE1(this.not_test_value)}},{ALT:()=>this.SUBRULE2(this.arith_expr)}])}));X(this,"arith_expr",this.RULED("arith_expr",()=>{this.SUBRULE1(this.term),this.MANY(()=>this.SUBRULE2(this.arith_expr_item))}));X(this,"arith_expr_item",this.RULED("arith_expr_item",()=>{this.OR([{ALT:()=>this.CONSUME(lu)},{ALT:()=>this.CONSUME(uu)}]),this.SUBRULE(this.term)}));X(this,"term",this.RULED("term",()=>{this.SUBRULE1(this.factor),this.MANY(()=>this.SUBRULE2(this.term_item))}));X(this,"term_item",this.RULED("term_item",()=>{this.OR([{ALT:()=>this.CONSUME(Vm)},{ALT:()=>this.CONSUME(hu)},{ALT:()=>this.CONSUME(Ym)},{ALT:()=>this.CONSUME(qm)}]),this.SUBRULE(this.factor)}));X(this,"factor",this.RULED("factor",()=>{this.OR1([{ALT:()=>{this.OR2([{ALT:()=>this.CONSUME(lu)},{ALT:()=>this.CONSUME(uu)}]),this.SUBRULE(this.factor)}},{ALT:()=>this.SUBRULE(this.power)}])}));X(this,"power",this.RULED("power",()=>{this.SUBRULE(this.token),this.OPTION(()=>{this.CONSUME(Hm),this.SUBRULE(this.factor)})}));X(this,"words",this.RULED("words",()=>{this.AT_LEAST_ONE(()=>this.SUBRULE(this.expr))}));X(this,"token",this.RULED("token",()=>{this.OR([{ALT:()=>this.CONSUME(su)},{ALT:()=>this.CONSUME(He)},{ALT:()=>this.CONSUME($m)},{ALT:()=>{this.CONSUME(Xm),this.SUBRULE(this.expr),this.CONSUME(Zm)}}])}));this.performSelfAnalysis()}PEEK(n,r,...i){console.info(n,i.map(s=>[s.image,s.tokenType]),r)}RULED(n,r,i){const s=AO.some(o=>n.includes(o));return this.RULE(n,()=>{const a=(ag++).toString().padStart(3),c=s?"font-weight: bold;":"";if(cg&&!this.RECORDING_PHASE){const l=[this.LA(1),this.LA(2),this.LA(3)].map(u=>`[${u.tokenType.name} ${u.image.replaceAll(`
`,"\\n")}]`);console.info(`${a}%c> ${n} ${l.join(" ")}`,c)}r(),cg&&!this.RECORDING_PHASE&&console.info(`${a}%c< ${n} `,c),ag--},i)}}const Fi=new SO;if(vv){const e=Fi.getGAstProductions(),t=HR(e);console.info(t)}const TO=Fi.getBaseCstVisitorConstructor();var Dt=(e=>(e[e.PROGRAM=0]="PROGRAM",e[e.TEXT=1]="TEXT",e[e.LABEL=2]="LABEL",e[e.HYPERLINK=3]="HYPERLINK",e[e.STAT=4]="STAT",e[e.MOVE=5]="MOVE",e[e.COMMAND=6]="COMMAND",e[e.LITERAL=7]="LITERAL",e[e.IF=8]="IF",e[e.ELSE_IF=9]="ELSE_IF",e[e.ELSE=10]="ELSE",e[e.WHILE=11]="WHILE",e[e.BREAK=12]="BREAK",e[e.CONTINUE=13]="CONTINUE",e[e.REPEAT=14]="REPEAT",e[e.READ=15]="READ",e[e.OR=16]="OR",e[e.AND=17]="AND",e[e.NOT=18]="NOT",e[e.COMPARE=19]="COMPARE",e[e.COMPARE_ITEM=20]="COMPARE_ITEM",e[e.OPERATOR=21]="OPERATOR",e[e.OPERATOR_ITEM=22]="OPERATOR_ITEM",e[e.EXPR=23]="EXPR",e))(Dt||{}),li=(e=>(e[e.IS_EQ=0]="IS_EQ",e[e.IS_NOT_EQ=1]="IS_NOT_EQ",e[e.IS_LESS_THAN=2]="IS_LESS_THAN",e[e.IS_GREATER_THAN=3]="IS_GREATER_THAN",e[e.IS_LESS_THAN_OR_EQ=4]="IS_LESS_THAN_OR_EQ",e[e.IS_GREATER_THAN_OR_EQ=5]="IS_GREATER_THAN_OR_EQ",e))(li||{}),Wn=(e=>(e[e.EMPTY=0]="EMPTY",e[e.PLUS=1]="PLUS",e[e.MINUS=2]="MINUS",e[e.POWER=3]="POWER",e[e.MULTIPLY=4]="MULTIPLY",e[e.DIVIDE=5]="DIVIDE",e[e.MOD_DIVIDE=6]="MOD_DIVIDE",e[e.FLOOR_DIVIDE=7]="FLOOR_DIVIDE",e[e.UNI_PLUS=8]="UNI_PLUS",e[e.UNI_MINUS=9]="UNI_MINUS",e))(Wn||{}),xa=(e=>(e[e.NUMBER=0]="NUMBER",e[e.STRING=1]="STRING",e[e.TEMPLATE=2]="TEMPLATE",e))(xa||{});function RO(e){return!!(e!=null&&e.tokenType)}function Kn(e,t){const[n]=e??[];return(n==null?void 0:n.image)??t}function lg(e,t){return mt(e,{type:7,literal:1,value:t})}function OO(e){const t=Object.values(e).flat().filter(n=>!!n).map(n=>n&&RO(n)?{startLine:n.startLine,startColumn:n.startColumn,startOffset:n.startOffset,endLine:n.endLine,endColumn:n.endColumn,endOffset:n.endOffset}:n!=null&&n.location?{...n.location}:{startLine:0,startColumn:0,startOffset:0,endLine:0,endColumn:0,endOffset:0}).filter(n=>n.startLine!==0&&n.endLine!==0);return{startLine:Math.min(...t.map(n=>n.startLine??1)),startColumn:Math.min(...t.map(n=>n.startColumn??1)),startOffset:Math.min(...t.map(n=>n.startOffset??1)),endLine:Math.max(...t.map(n=>n.endLine??1)),endColumn:Math.max(...t.map(n=>n.endColumn??1)),endOffset:Math.max(...t.map(n=>n.endOffset??1))}}function mt(e,t){return[{...t,...OO(e)}]}class IO extends TO{constructor(){super(),Mn&&this.validateVisitor()}go(t){return Array.isArray(t)?t.map(n=>this.visit(n)).flat():T(t)?[this.visit(t)].flat():[]}program(t){return mt(t,{type:0,lines:this.go(t.line)})}line(t){return this.go(t.stmt)}stmt(t){return t.stmt_label?this.go(t.stmt_label):t.stmt_stat?this.go(t.stmt_stat):t.stmt_text?this.go(t.stmt_text):t.stmt_comment?this.go(t.stmt_comment):t.stmt_command?this.go(t.stmt_command):t.stmt_hyperlink?this.go(t.stmt_hyperlink):t.short_commands?[this.go(t.short_commands),this.go(t.commands)].flat():[]}do_block(t){return this.go(t.do_line)}do_line(t){return this.go(t.do_stmt)}do_stmt(t){return t.stmt_stat?this.go(t.stmt_stat):t.stmt_text?this.go(t.stmt_text):t.stmt_comment?this.go(t.stmt_comment):t.stmt_command?this.go(t.stmt_command):t.stmt_hyperlink?this.go(t.stmt_hyperlink):t.short_commands?[this.go(t.short_commands),this.go(t.commands)].flat():[]}do_inline(t){return t.stmt_stat?this.go(t.stmt_stat):t.stmt_text?this.go(t.stmt_text):t.stmt_comment?this.go(t.stmt_comment):t.stmt_command?this.go(t.stmt_command):t.stmt_hyperlink?this.go(t.stmt_hyperlink):t.commands?this.go(t.commands):[]}stmt_label(t){return mt(t,{type:2,active:!0,name:Kn(t.token_label,":").slice(1).trim()})}stmt_stat(t){return mt(t,{type:4,value:Kn(t.token_stat,"@").slice(1)})}stmt_text(t){return mt(t,{type:1,value:Kn(t.token_stringliteraldouble,"")||Kn(t.token_text,"")})}stmt_comment(t){return mt(t,{type:2,active:!1,name:Kn(t.token_comment,"'").slice(1).trim()})}stmt_hyperlink(t){return mt(t,{type:3,link:this.go(t.words),text:Kn(t.token_hyperlinktext,";").slice(1)})}stmt_command(t){return t.commands?this.go(t.commands):[]}short_commands(t){return t.short_go?this.go(t.short_go):t.short_try?this.go(t.short_try):[]}commands(t){return t.words?mt(t,{type:6,words:this.go(t.words)}):t.short_go?this.go(t.short_go):t.short_try?this.go(t.short_try):t.command_play?this.go(t.command_play):t.structured_cmd?this.go(t.structured_cmd):[]}structured_cmd(t){return t.command_if?this.go(t.command_if):t.command_while?this.go(t.command_while):t.command_repeat?this.go(t.command_repeat):t.command_break?this.go(t.command_break):t.command_continue?this.go(t.command_continue):[]}short_go(t){return t.token_divide?mt(t,{type:5,wait:!0,words:this.go(t.words)}):[]}short_try(t){return t.token_query?mt(t,{type:5,wait:!1,words:this.go(t.words)}):[]}command_if(t){return mt(t,{type:8,method:"if",words:this.go(t.words),lines:this.go(t.command_if_block)})}command_if_block(t){return[this.go(t.do_inline),this.go(t.do_block),this.go(t.command_else_if),this.go(t.command_else)].flat()}command_block(t){return[this.go(t.do_inline),this.go(t.do_block)].flat()}command_else_if(t){return mt(t,{type:9,method:"if",words:this.go(t.words),lines:this.go(t.command_block)})}command_else(t){return mt(t,{type:10,method:"if",lines:this.go(t.command_block)})}command_loop(t){return[this.go(t.do_inline),this.go(t.do_block)].flat()}command_while(t){return mt(t,{type:11,method:"while",words:this.go(t.words),lines:this.go(t.command_loop)})}command_repeat(t){return mt(t,{type:14,words:this.go(t.words),lines:this.go(t.command_loop)})}command_break(t){return mt(t,{type:12})}command_continue(t){return mt(t,{type:13})}command_play(t){const n=Kn(t.token_command_play,"").replace("play","").trim();return mt(t,{type:6,words:[lg(t,"play"),lg(t,n)].flat()})}expr(t){return t.and_test.length===1?this.go(t.and_test):mt(t,{type:16,items:this.go(t.and_test)})}and_test(t){return t.not_test.length===1?this.go(t.not_test):mt(t,{type:17,items:this.go(t.not_test)})}not_test(t){return t.comparison?this.go(t.comparison):t.not_test?mt(t,{type:18,items:this.go(t.not_test)}):[]}comparison(t){if(t.arith_expr.length===1)return this.go(t.arith_expr);const[n,r]=this.go(t.arith_expr),[i]=this.go(t.comp_op);return mt(t,{type:19,lhs:n,compare:i,rhs:r})}comp_op(t){return t.token_iseq?mt(t,{type:20,method:0}):t.token_isnoteq?mt(t,{type:20,method:1}):t.token_islessthan?mt(t,{type:20,method:2}):t.token_isgreaterthan?mt(t,{type:20,method:3}):t.token_isgreaterthanorequal?mt(t,{type:20,method:4}):t.token_isgreaterthanorequal?mt(t,{type:20,method:5}):[]}expr_value(t){return t.and_test_value.length===1?this.go(t.and_test_value):mt(t,{type:16,items:this.go(t.and_test_value)})}and_test_value(t){return t.not_test_value.length===1?this.go(t.not_test_value):mt(t,{type:17,items:this.go(t.not_test_value)})}not_test_value(t){return t.arith_expr?this.go(t.arith_expr):t.not_test_value?mt(t,{type:18,items:this.go(t.not_test_value)}):[]}arith_expr(t){const n=this.go(t.term);return t.arith_expr_item?mt(t,{type:21,lhs:n[0],items:this.go(t.arith_expr_item)}):n}arith_expr_item(t){return mt(t,{type:22,operator:t.token_plus?1:2,rhs:this.go(t.term)[0]})}term(t){return t.term_item?mt(t,{type:21,lhs:this.go(t.factor)[0],items:this.go(t.term_item)}):this.go(t.factor)}term_item(t){let n=0;return t.token_multiply&&(n=4),t.token_divide&&(n=5),t.token_moddivide&&(n=6),t.token_floordivide&&(n=7),mt(t,{type:22,operator:n,rhs:this.go(t.factor)[0]})}factor(t){if(t.power)return this.go(t.power);let n=0;return t.token_plus&&(n=8),t.token_minus&&(n=9),mt(t,{type:21,lhs:void 0,items:mt(t,{type:22,operator:n,rhs:this.go(t.factor)[0]})})}power(t){const n=this.go(t.token);return t.factor?mt(t,{type:21,lhs:n[0],items:mt(t,{type:22,operator:3,rhs:this.go(t.factor)[0]})}):n}words(t){return this.go(t.expr)}token(t){if(t.token_stringliteraldouble){const n=Kn(t.token_stringliteraldouble,'""').replace(/(^"|"$)/g,"");return mt(t,{type:7,literal:2,value:n.substring(1,n.length-1)})}return t.token_stringliteral?mt(t,{type:7,literal:1,value:Kn(t.token_stringliteral,"")}):t.token_numberliteral?mt(t,{type:7,literal:0,value:parseFloat(Kn(t.token_numberliteral,"0"))}):t.token_lparen?mt(t,{type:23,words:this.go(t.expr)}):[]}}const xO=new IO,An={internal:0,labels:{},labelIndex:0},Ca=`
         `,ug="if (api.hm()) { continue zss; }",CO="if (api.sy()) { yield 1; }",NO=`yield 1; ${ug}`;let hg=!1;const gu={};function yu(e){if(!hg)return"";gu[e]=gu[e]??0;const t=gu[e]++;return`${Ca}console.info('${e}-${t}')`}function _u(){return`${NO};${yu("wait")}`}function bu(){return`${CO}; ${ug}${yu("eol")};`}function LO(e){hg=e===kv}const Na="zss.js";function ae(e,t){return new wv(e.startLine??1,e.startColumn??1,Na,t)}function wu(e){return e.replace(/\\/g,"\\\\").replace(/'/g,"\\'")}function fg(e){return`'${wu(e)}'`}function La(e){if(e.startsWith('"'))return La(e.substring(1,e.length-1));const t=gO(e);return t.errors.length?e:`['${t.tokens.map(r=>r.tokenType===nu?`', api.get('${wu(r.image.substring(1))}'), '`:wu(r.image)).join("")}'].join('')`}function ui(e){return e.filter(t=>t!==void 0).map(Lt)}function dg(e){return ae(e,"")}function MO(e,t){const n=[];return e.forEach(r=>{n.push(r,t)}),n.pop(),n}function ce(e,t,n){return ae(e,[`api.${t}(`,...MO(n,", "),")"])}function UO(e){if(e.type===Dt.COMPARE&&e.compare.type===Dt.COMPARE_ITEM)switch(e.compare.method){case li.IS_EQ:return ce(e,"isEq",[Lt(e.lhs),Lt(e.rhs)]);case li.IS_NOT_EQ:return ce(e,"isNotEq",[Lt(e.lhs),Lt(e.rhs)]);case li.IS_LESS_THAN:return ce(e,"isLessThan",[Lt(e.lhs),Lt(e.rhs)]);case li.IS_GREATER_THAN:return ce(e,"isGreaterThan",[Lt(e.lhs),Lt(e.rhs)]);case li.IS_LESS_THAN_OR_EQ:return ce(e,"isLessThanOrEq",[Lt(e.lhs),Lt(e.rhs)]);case li.IS_GREATER_THAN_OR_EQ:return ce(e,"isGreaterThanOrEq",[Lt(e.lhs),Lt(e.rhs)])}return ae(e,"")}function hi(e,t,n,r){return t.prepend(`api.${n}(`),t.add([", ",Lt(r),")"])}function pg(e,t,n,r){return t.prepend(`api.${n}(`),t.add([Lt(r),")"])}function DO(e,t){if(e.type===Dt.OPERATOR_ITEM)switch(e.operator){case Wn.PLUS:return hi(e,t,"opPlus",e.rhs);case Wn.MINUS:return hi(e,t,"opMinus",e.rhs);case Wn.POWER:return hi(e,t,"opPower",e.rhs);case Wn.MULTIPLY:return hi(e,t,"opMultiply",e.rhs);case Wn.DIVIDE:return hi(e,t,"opDivide",e.rhs);case Wn.MOD_DIVIDE:return hi(e,t,"opModDivide",e.rhs);case Wn.FLOOR_DIVIDE:return hi(e,t,"opFloorDivide",e.rhs);case Wn.UNI_PLUS:return pg(e,t,"opUniPlus",e.rhs);case Wn.UNI_MINUS:return pg(e,t,"opUniMinus",e.rhs)}return ae(e,"")}function PO(e){if(e.type===Dt.OPERATOR){const t=e.lhs?Lt(e.lhs):ae(e,"");return e.items.forEach(n=>DO(n,t)),t}return ae(e,"")}function Lt(e){switch(e.type){case Dt.PROGRAM:return ae(e,[`try { // first-line
`,`zss: while (true) {
`,`switch (api.getcase()) {
`,`default:
`,`case 1: 
`,...e.lines.map(t=>[Lt(t),`
`]).flat(),`}
`,`api.endofprogram();
`,`while(true) { ${_u()} }
`,`}
`,`} catch (e) {
`,`console.error(e);
`,`const source = api.stacktrace(e);
`,`const err = new Error(e.message);
`,`err.name = 'GameError';
`,`err.meta = { line: source.line, column: source.column };
`,`throw err;
`,`}
`,`//# sourceURL=${Na}`]);case Dt.LITERAL:switch(e.literal){case xa.NUMBER:return ae(e,`${e.value}`);case xa.STRING:return ae(e,fg(e.value));case xa.TEMPLATE:return ae(e,La(e.value))}return dg(e);case Dt.TEXT:return ce(e,"text",[La(e.value)]);case Dt.STAT:return ce(e,"stat",[fg(e.value)]);case Dt.LABEL:{const t=An.labelIndex++;return An.labels[e.name]||(An.labels[e.name]=[]),An.labels[e.name].push(e.active?t:-t),ae(e,`case ${t}: // ${e.name}`)}case Dt.HYPERLINK:return ce(e,"hyperlink",[La(e.text),...ui(e.link)]);case Dt.MOVE:return ae(e,["while (",ce(e,"move",[e.wait?"true":"false",...ui(e.words)]),`) { ${_u()} };${Ca}${bu()}`]);case Dt.COMMAND:return ae(e,["while (",ce(e,"command",ui(e.words)),`) { ${_u()} };${Ca}${bu()}`]);case Dt.IF:{const t=ae(e,["if (",ce(e,`${e.method}`,ui(e.words)),`) { ${yu("if")} 
`]);return e.lines&&e.lines.forEach(n=>t.add([Lt(n),`
`])),t.add("}"),t}case Dt.ELSE_IF:{const t=ae(e,["} else if (",ce(e,e.method,ui(e.words)),`) {
`]);return e.lines&&e.lines.forEach(n=>t.add([Lt(n),`
`])),t}case Dt.ELSE:{const t=ae(e,`} else {
`);return e.lines&&e.lines.forEach(n=>t.add([Lt(n),`
`])),t}case Dt.WHILE:{const t=ae(e,["while (",ce(e,"if",ui(e.words)),`) {
`]);return e.lines&&e.lines.forEach(n=>t.add([Lt(n),`
`])),t.add("}"),t}case Dt.REPEAT:{const t=ae(e,[ce(e,"repeatstart",[`${An.internal}`,...ui(e.words)]),`;
while (`,ce(e,"repeat",[`${An.internal}`]),`) {${Ca}${bu()}
`]);return An.internal+=1,e.lines&&e.lines.forEach(n=>t.add([Lt(n),`
`])),t.add("}"),t}case Dt.BREAK:return ae(e,`break;
`);case Dt.CONTINUE:return ae(e,`continue;
`);case Dt.OR:return ce(e,"or",e.items.map(Lt));case Dt.AND:return ce(e,"and",e.items.map(Lt));case Dt.NOT:return ce(e,"not",e.items.map(Lt));case Dt.COMPARE:return UO(e);case Dt.OPERATOR:return PO(e);case Dt.EXPR:return ce(e,"expr",e.words.map(Lt));default:return console.error("<unsupported node>",e.type,e),dg(e)}}function BO(e){return An.internal=0,An.labels={restart:[1]},An.labelIndex=2,{...Lt(e).toStringWithSourceMap({file:`${Na}.map`}),...An}}const Ma={HALT_AT_COUNT:64};function $O(e){return ne(e)?e.length>0?1:0:e??0}function _e(e){return`${e??""}`}function FO(e,t){var A,I;const n=nw(t.labels??{});let r,i="",s,o=0;const a={},c={},l={};let u=!1,f=0,d=0,h=(((A=t.errors)==null?void 0:A.length)??0)!==0;const p=[];let m={};function v(k){if(m[k]===void 0)for(let E=0;E<p.length;++E){const w=p[E].getcommand(k);w&&(m[k]=w)}return m[k]}function b(k,E){const w=v(k);if(!w)throw new Error(`unknown firmware command ${k}`);w(y,E)}const y={id(){return e},senderid(k=y.id()){return`vm:${k??y.id()}`},install(k){T(k)&&(m={},p.push(k))},set(k,E){const w=k.toLowerCase();for(let S=0;S<p.length;++S){const[O]=p[S].set(y,w,E);if(O)return E}return E},get(k){const E=k.toLowerCase();for(let w=0;w<p.length;++w){const[S,O]=p[w].get(y,E);if(S)return O}},timestamp(){return d},tick(k,E){d=E;const w=f%k===0;for(let S=0;S<p.length;++S)p[S].shouldtick(y,w);if(!y.shouldtick()||(++f,!w))return!1;o=0,u=!1;for(let S=0;S<p.length;++S)p[S].tick(y);try{const S=r==null?void 0:r.next();S!=null&&S.done&&(re("chip","crash","generator logic unexpectedly exited"),h=!0)}catch(S){re("chip","crash",S.message),h=!0}for(let S=0;S<p.length;++S)p[S].tock(y);return!0},isended(){return h===!0},shouldtick(){return h===!1||y.hm()!==0},shouldhalt(){return o++>Ma.HALT_AT_COUNT},hm(){var E;const k=(s==null?void 0:s.target)??"";return T(s==null?void 0:s.target)?((E=n[k])==null?void 0:E.find(w=>w>0))??0:0},yield(){u=!0},sy(){return u||y.shouldhalt()},emit(k,E,w){Nt.emit(k,y.senderid(),E,w)},send(k,E,w,S){Nt.emit(`${y.senderid(k)}:${E}`,e,w,S)},lock(k){i=k},unlock(){i=""},message(k){i&&k.sender!==i||(s=k)},zap(k){const E=n[k];if(E){const w=E.findIndex(S=>S>0);w>=0&&(E[w]*=-1)}},restore(k){const E=n[k];if(E)for(let w=0;w<E.length;w++)E[w]=Math.abs(E[w])},getcase(){const k=y.hm();return k&&T(s)&&(y.set("sender",s.sender),y.set("data",s.data),s.player&&y.set("player",s.player),s=void 0,u=!1,h=!1),k},endofprogram(){y.yield(),h=!0},stacktrace(k){const E=Sw.parse(k),[w]=E.filter(S=>S.fileName===Na);return{line:(w==null?void 0:w.lineNumber)??0,column:(w==null?void 0:w.columnNumber)??0}},text(k){return b("text",[k])},stat(...k){return b("stat",k)},hyperlink(...k){return b("hyperlink",k)},move(k,...E){const w=y.command("go",...E)&&k;return y.yield(),w?1:0},command(...k){if(k.length===0)return 0;const[E,...w]=k,S=v(_e(E));return T(S)?S(y,w):(b("send",[E,...w]),0)},if(...k){const[E,w]=Z(rt(y,k),0,[Y.ANY]),S=$O(E);return S&&w<k.length&&y.command(...k.slice(w)),S?1:0},repeatstart(k,...E){const[w,S]=Z(rt(y,E),0,[Y.NUMBER]);a[k]=w,c[k]=S<E.length?E.slice(S):void 0},repeat(k){const E=a[k]??0;a[k]=E-1;const w=E>0,S=c[k];return w&&S&&y.command(...S),w?1:0},readstart(k,E){if(!xt(E))return;const w=y.get(E)??[];l[k]=ne(w)?w:[w]},read(k,...E){const w=l[k];if(ne(w)===!1)return 0;const S=w.shift();if(S===void 0)return 0;const O=E.map(_e);switch(typeof S){case"number":case"string":O.forEach(B=>{y.set(B,S)});break;case"object":Array.isArray(S)||O.forEach(B=>{const V=S[B];y.set(B,V)});break}return 1},or(...k){let E=0;for(let w=0;w<k.length;){const[S,O]=Z(rt(y,k),w,[Y.ANY]);if(E=S,E)break;w=O}return E},and(...k){let E=0;for(let w=0;w<k.length;){const[S,O]=Z(rt(y,k),w,[Y.ANY]);if(E=S,!E)break;w=O}return E},not(...k){const[E]=Z(rt(y,k),0,[Y.ANY]);return E?0:1},expr(...k){const[E]=Z(rt(y,k),0,[Y.ANY]);return E},isEq(k,E){const[w]=Z(rt(y,[k]),0,[Y.ANY]),[S]=Z(rt(y,[E]),0,[Y.ANY]);return ew(w,S)?1:0},isNotEq(k,E){const[w]=Z(rt(y,[k]),0,[Y.ANY]),[S]=Z(rt(y,[E]),0,[Y.ANY]);return w!==S?1:0},isLessThan(k,E){const[w]=Z(rt(y,[k]),0,[Y.NUMBER]),[S]=Z(rt(y,[E]),0,[Y.NUMBER]);return w<S?1:0},isGreaterThan(k,E){const[w]=Z(rt(y,[k]),0,[Y.NUMBER]),[S]=Z(rt(y,[E]),0,[Y.NUMBER]);return w>S?1:0},isLessThanOrEq(k,E){const[w]=Z(rt(y,[k]),0,[Y.NUMBER]),[S]=Z(rt(y,[E]),0,[Y.NUMBER]);return w<=S?1:0},isGreaterThanOrEq(k,E){const[w]=Z(rt(y,[k]),0,[Y.NUMBER]),[S]=Z(rt(y,[E]),0,[Y.NUMBER]);return w>=S?1:0},opPlus(k,E){const[w]=Z(rt(y,[k]),0,[Y.ANY]),[S]=Z(rt(y,[E]),0,[Y.ANY]);return w+S},opMinus(k,E){const[w]=Z(rt(y,[k]),0,[Y.ANY]),[S]=Z(rt(y,[E]),0,[Y.ANY]);return w-S},opPower(k,E){const[w]=Z(rt(y,[k]),0,[Y.NUMBER]),[S]=Z(rt(y,[E]),0,[Y.NUMBER]);return Math.pow(w,S)},opMultiply(k,E){const[w]=Z(rt(y,[k]),0,[Y.NUMBER]),[S]=Z(rt(y,[E]),0,[Y.NUMBER]);return w*S},opDivide(k,E){const[w]=Z(rt(y,[k]),0,[Y.NUMBER]),[S]=Z(rt(y,[E]),0,[Y.NUMBER]);return w/S},opModDivide(k,E){const[w]=Z(rt(y,[k]),0,[Y.NUMBER]),[S]=Z(rt(y,[E]),0,[Y.NUMBER]);return w%S},opFloorDivide(k,E){const[w]=Z(rt(y,[k]),0,[Y.NUMBER]),[S]=Z(rt(y,[E]),0,[Y.NUMBER]);return Math.floor(w/S)},opUniPlus(k){const[E]=Z(rt(y,[k]),0,[Y.NUMBER]);return+E},opUniMinus(k){const[E]=Z(rt(y,[k]),0,[Y.NUMBER]);return-E}};return r=(I=t.code)==null?void 0:I.call(t,y),y}function fi(e){const t={},n={...e,getcommand(r){return t[r]},command(r,i){return t[r]=i,n}};return n}function jO(e){const t=pf[e];if(T(t))return t;const n=_f[e];if(T(n))return n;const r=Xc[e];if(T(r))return r;const i=Of[e];if(T(i))return i}const zO=fi({get(e,t){const n=jO(t);return T(n)?[!0,n]:[!1,void 0]},set(){return[!1,void 0]},shouldtick(){},tick(){},tock(){}}).command("clear",(e,t)=>{const n=_e(t[0]);return e.set(n,void 0),0}).command("set",(e,t)=>{const[n,r]=Z(rt(e,t),0,[Y.STRING,Y.ANY]);return e.set(n,r),0}).command("take",(e,t)=>{const[n,r,i]=Z(rt(e,t),0,[Y.STRING,Y.MAYBE_NUMBER]),s=e.get(n),o=r??1;if(!Kt(s))return 1;const a=s-o;return a<0?(i<t.length&&e.command(...t.slice(i)),1):(e.set(n,a),0)}).command("give",(e,t)=>{const[n,r,i]=Z(rt(e,t),0,[Y.STRING,Y.MAYBE_NUMBER]),s=e.get(n),o=Kt(s)?s:0,a=r??1;if(!Kt(a))return 0;const c=s===void 0?1:0;return c&&i<t.length&&e.command(...t.slice(i)),e.set(n,o+a),c}).command("idle",e=>(e.yield(),0)).command("end",e=>(e.endofprogram(),0)).command("lock",e=>(e.lock(e.id()),0)).command("restore",(e,t)=>(e.restore(_e(t[0])),0)).command("unlock",e=>(e.unlock(),0)).command("zap",(e,t)=>(e.zap(_e(t[0])),0)),GO=fi({get(){return[!1,void 0]},set(){return[!1,void 0]},shouldtick(){},tick(){},tock(){}}).command("play",(e,t)=>{const n=rt(e,t),[r]=Z(n,0,[Y.MAYBE_STRING]),i=r??"",s=e.get(i);return Zh("audio",-1,xt(s)?s:i),0}).command("bgplay",(e,t)=>{const n=rt(e,t),[r]=Z(n,0,[Y.MAYBE_STRING]),i=r??"",s=e.get(i);return Zh("audio",1,xt(s)?s:i),0});function Fs(){return Fs=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Fs.apply(this,arguments)}function WO(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,vu(e,t)}function vu(e,t){return vu=Object.setPrototypeOf||function(r,i){return r.__proto__=i,r},vu(e,t)}function KO(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var mg=function(){function e(n){this.trigger=n,this.observing=new Map}var t=e.prototype;return t.registerConnection=function(r){var i=this.observing.get(r.observable);i||(i={byKey:new Set,iterate:!1},this.observing.set(r.observable,i)),r.type==="iterate"?i.iterate=!0:i.byKey.add(r.key)},t.removeObservers=function(){var r=this;this.observing.forEach(function(i,s){i.iterate&&s[be].connections.iterate.delete(r),i.byKey.forEach(function(o){s[be].connections.byKey.get(o).delete(r)})}),this.observing.clear()},e}(),di=[],Ua=function(e){WO(t,e);function t(r,i,s){var o;if(o=e.call(this,function(){return o._trigger()})||this,o.func=r,o.options=i,o.effect=s,o.isInitial=!0,o.reaction=function(){di.push(KO(o));try{o.func()}finally{di.pop()}o.effect&&(!o.isInitial||o.options.fireImmediately)&&o.effect(),o.isInitial=!1},!s&&!o.options.fireImmediately)throw new Error("if no effect function passed, should always fireImmediately");return o.reaction(),o}var n=t.prototype;return n._trigger=function(){if(di.includes(this))throw new Error("already running reaction");this.removeObservers(),this.reaction()},t}(mg);function gg(){return!!di.length}function yg(){return di.length?di[di.length-1]:void 0}function HO(e,t,n){var r=Fs({name:"unnamed",fireImmediately:!0},n),i=new Ua(e,r,t);return i}var Da=0;function _g(){return Da>0}function Eu(e){Da++;try{return e()}finally{Da--,Da===0&&YO()}}var ku=!1;function bg(){return ku}function wg(e){ku=!0;try{e()}finally{ku=!1}}function VO(e){return function(){return wg(e)}}var Au=[];function YO(){var e=[].concat(Au);Au=[],vg(e)}function vg(e){var t=new Set;e.forEach(function(n){var r;(n.type==="add"||n.type==="delete")&&n.observable[be].connections.iterate.forEach(function(i){t.add(i)}),(r=n.observable[be].connections.byKey.get(n.key))==null||r.forEach(function(i){t.add(i)})}),t.forEach(function(n){n.trigger()})}function Pa(e){if(_g()){Au.push(e);return}vg([e])}function Eg(e,t){if(e.type==="iterate")e.observable[be].connections.iterate.add(t);else{var n=e.observable[be].connections.byKey.get(e.key);n||(n=new Set,e.observable[be].connections.byKey.set(e.key,n)),n.add(t)}}function Ba(e,t){if(!bg()){var n=yg();n&&(Eg(e,n),n.registerConnection(e)),t&&(Eg(e,t),t.registerConnection(e))}}var Su=Symbol("$skipreactive"),be=Symbol("$reactive"),ln=Symbol("$reactiveproxy");function js(e,t){return!!(e&&e[ln]&&e[ln].implicitObserver===t)}function Tu(e){return e[Su]=!0,e}function kg(e){return!!(e&&!js(e)&&e[be])}function Ru(e,t,n){if(n===void 0&&(n=!1),e[Su]||js(e,t))return e;var r=qO(e,n);if(!t)return r;var i=r[be].proxiesWithImplicitObserver.get(t);if(!i){var s={implicitObserver:t};Object.setPrototypeOf(s,Ag),i=new Proxy(r[be].raw,s),r[be].proxiesWithImplicitObserver.set(t,i)}return i}var zs=Ru;function qO(e,t){if(t===void 0&&(t=!1),js(e))return e;if(kg(e))return e[be].proxy;if(e[be]||e[ln])throw new Error("unexpected");var n={connections:{iterate:new Set,byKey:new Map},proxy:{},raw:e,proxiesWithImplicitObserver:new Map,shallow:t};Object.defineProperty(e,be,{enumerable:!1,writable:!0,configurable:!0,value:n});var r=new Proxy(e,Ag);return n.proxy=r,r}var Ag={has:function(t,n){var r=Reflect.has(t,n);return typeof n=="symbol"||Ba({observable:t,key:n,type:"has"},this.implicitObserver),r},get:function(t,n,r){if(n===ln)return{implicitObserver:this.implicitObserver};var i=Reflect.get(t,n,r);if(typeof n=="symbol")return n.toString()==="Symbol($reactiveproxy)"&&console.error("warning, Symbol($reactiveproxy) passed, but does not match $reactiveproxy. Multiple Reactive libraries loaded?"),i;if(n==="length"&&Array.isArray(t)?Ba({observable:t,type:"iterate"},this.implicitObserver):Ba({observable:t,key:n,type:"get"},this.implicitObserver),kg(i))return Ru(i,this.implicitObserver);if(t[be].shallow)return i;if(typeof i=="object"&&i!==null&&!js(i,this.implicitObserver)&&!Object.isFrozen(i)){var s=Reflect.getOwnPropertyDescriptor(t,n);if((!s||!(s.writable===!1&&s.configurable===!1))&&(gg()||this.implicitObserver))return Ru(i,this.implicitObserver)}return i},ownKeys:function(t){return Ba({observable:t,type:"iterate"},this.implicitObserver),Reflect.ownKeys(t)},set:function(t,n,r,i){return Eu(function(){if(typeof n=="symbol")return Reflect.set(t,n,r,i);var s=Object.hasOwnProperty.call(t,n),o=Reflect.get(t,n,i),a=Reflect.set(t,n,r,i);if(!s)Pa({observable:t,key:n,value:r,type:"add"});else if(r!==o)if(n==="length"&&Array.isArray(t)){if(!(o<r))for(var c=r+1;c<=o;c++)Pa({observable:t,key:""+(c-1),oldValue:void 0,type:"delete"})}else Pa({observable:t,key:n,value:r,oldValue:o,type:"update"});return a})},deleteProperty:function(t,n){return Eu(function(){if(typeof n=="symbol")return Reflect.deleteProperty(t,n);var r=Object.hasOwnProperty.call(t,n),i=Reflect.get(t,n),s=Reflect.deleteProperty(t,n);return r&&Pa({observable:t,key:n,oldValue:i,type:"delete"}),s})},preventExtensions:function(t){throw new Error("Dynamic observable objects cannot be frozen")}};function JO(e,t){var n=Fs({name:"unnamed",fireImmediately:!0},t),r=new Ua(e,n);return r}function XO(e,t,n){var r=Fs({name:"unnamed",fireImmediately:!0},n),i=new Ua(function(){e(t)},r);return t=zs(t,i),r.fireImmediately&&i.trigger(),i}var Sg=function(){function e(){this._observable=zs({_key:1})}var t=e.prototype;return t.reportObserved=function(r){return zs(this._observable,r)._key},t.reportChanged=function(){this._observable._key++},e}();function ZO(e,t,n){return new Sg}var QO=Object.freeze({__proto__:null,$reactive:be,$reactiveproxy:ln,$skipreactive:Su,Atom:Sg,Observer:mg,Reaction:Ua,autorun:JO,autorunAsync:XO,createAtom:ZO,hasRunningReaction:gg,isActionRunning:_g,isReactive:js,isTrackingDisabled:bg,markRaw:Tu,reaction:HO,reactive:zs,runInAction:Eu,runningReaction:yg,untracked:wg,untrackedCB:VO});const Sn=()=>new Map,Ou=e=>{const t=Sn();return e.forEach((n,r)=>{t.set(r,n)}),t},Nr=(e,t,n)=>{let r=e.get(t);return r===void 0&&e.set(t,r=n()),r},tI=(e,t)=>{const n=[];for(const[r,i]of e)n.push(t(i,r));return n},eI=(e,t)=>{for(const[n,r]of e)if(t(r,n))return!0;return!1},ji=()=>new Set,Iu=e=>e[e.length-1],nI=(e,t)=>{for(let n=0;n<t.length;n++)e.push(t[n])},Lr=Array.from,rI=Array.isArray;class iI{constructor(){this._observers=Sn()}on(t,n){return Nr(this._observers,t,ji).add(n),n}once(t,n){const r=(...i)=>{this.off(t,r),n(...i)};this.on(t,r)}off(t,n){const r=this._observers.get(t);r!==void 0&&(r.delete(n),r.size===0&&this._observers.delete(t))}emit(t,n){return Lr((this._observers.get(t)||Sn()).values()).forEach(r=>r(...n))}destroy(){this._observers=Sn()}}const Mr=Math.floor,$a=Math.abs,Tg=(e,t)=>e<t?e:t,pi=(e,t)=>e>t?e:t,Rg=e=>e!==0?e<0:1/e<0,Og=1,Ig=2,xu=4,Cu=8,Gs=32,pr=64,Xe=128,Fa=31,Nu=63,mi=127,sI=2147483647,xg=Number.MAX_SAFE_INTEGER,oI=Number.isInteger||(e=>typeof e=="number"&&isFinite(e)&&Mr(e)===e),aI=e=>e.toLowerCase(),cI=/^\s*/g,lI=e=>e.replace(cI,""),uI=/([A-Z])/g,Cg=(e,t)=>lI(e.replace(uI,n=>`${t}${aI(n)}`)),hI=e=>{const t=unescape(encodeURIComponent(e)),n=t.length,r=new Uint8Array(n);for(let i=0;i<n;i++)r[i]=t.codePointAt(i);return r},Ws=typeof TextEncoder<"u"?new TextEncoder:null,fI=Ws?e=>Ws.encode(e):hI;let Ks=typeof TextDecoder>"u"?null:new TextDecoder("utf-8",{fatal:!0,ignoreBOM:!0});Ks&&Ks.decode(new Uint8Array).length===1&&(Ks=null);class Hs{constructor(){this.cpos=0,this.cbuf=new Uint8Array(100),this.bufs=[]}}const Ur=()=>new Hs,dI=e=>{let t=e.cpos;for(let n=0;n<e.bufs.length;n++)t+=e.bufs[n].length;return t},Tn=e=>{const t=new Uint8Array(dI(e));let n=0;for(let r=0;r<e.bufs.length;r++){const i=e.bufs[r];t.set(i,n),n+=i.length}return t.set(new Uint8Array(e.cbuf.buffer,0,e.cpos),n),t},pI=(e,t)=>{const n=e.cbuf.length;n-e.cpos<t&&(e.bufs.push(new Uint8Array(e.cbuf.buffer,0,e.cpos)),e.cbuf=new Uint8Array(pi(n,t)*2),e.cpos=0)},ke=(e,t)=>{const n=e.cbuf.length;e.cpos===n&&(e.bufs.push(e.cbuf),e.cbuf=new Uint8Array(n*2),e.cpos=0),e.cbuf[e.cpos++]=t},Lu=ke,gt=(e,t)=>{for(;t>mi;)ke(e,Xe|mi&t),t=Mr(t/128);ke(e,mi&t)},Mu=(e,t)=>{const n=Rg(t);for(n&&(t=-t),ke(e,(t>Nu?Xe:0)|(n?pr:0)|Nu&t),t=Mr(t/64);t>0;)ke(e,(t>mi?Xe:0)|mi&t),t=Mr(t/128)},Uu=new Uint8Array(3e4),mI=Uu.length/3,gI=(e,t)=>{if(t.length<mI){const n=Ws.encodeInto(t,Uu).written||0;gt(e,n);for(let r=0;r<n;r++)ke(e,Uu[r])}else xe(e,fI(t))},yI=(e,t)=>{const n=unescape(encodeURIComponent(t)),r=n.length;gt(e,r);for(let i=0;i<r;i++)ke(e,n.codePointAt(i))},zi=Ws&&Ws.encodeInto?gI:yI,ja=(e,t)=>{const n=e.cbuf.length,r=e.cpos,i=Tg(n-r,t.length),s=t.length-i;e.cbuf.set(t.subarray(0,i),r),e.cpos+=i,s>0&&(e.bufs.push(e.cbuf),e.cbuf=new Uint8Array(pi(n*2,s)),e.cbuf.set(t.subarray(i)),e.cpos=s)},xe=(e,t)=>{gt(e,t.byteLength),ja(e,t)},Du=(e,t)=>{pI(e,t);const n=new DataView(e.cbuf.buffer,e.cpos,t);return e.cpos+=t,n},_I=(e,t)=>Du(e,4).setFloat32(0,t,!1),bI=(e,t)=>Du(e,8).setFloat64(0,t,!1),wI=(e,t)=>Du(e,8).setBigInt64(0,t,!1),Ng=new DataView(new ArrayBuffer(4)),vI=e=>(Ng.setFloat32(0,e),Ng.getFloat32(0)===e),Vs=(e,t)=>{switch(typeof t){case"string":ke(e,119),zi(e,t);break;case"number":oI(t)&&$a(t)<=sI?(ke(e,125),Mu(e,t)):vI(t)?(ke(e,124),_I(e,t)):(ke(e,123),bI(e,t));break;case"bigint":ke(e,122),wI(e,t);break;case"object":if(t===null)ke(e,126);else if(rI(t)){ke(e,117),gt(e,t.length);for(let n=0;n<t.length;n++)Vs(e,t[n])}else if(t instanceof Uint8Array)ke(e,116),xe(e,t);else{ke(e,118);const n=Object.keys(t);gt(e,n.length);for(let r=0;r<n.length;r++){const i=n[r];zi(e,i),Vs(e,t[i])}}break;case"boolean":ke(e,t?120:121);break;default:ke(e,127)}};class Lg extends Hs{constructor(t){super(),this.w=t,this.s=null,this.count=0}write(t){this.s===t?this.count++:(this.count>0&&gt(this,this.count-1),this.count=1,this.w(this,t),this.s=t)}}const Mg=e=>{e.count>0&&(Mu(e.encoder,e.count===1?e.s:-e.s),e.count>1&&gt(e.encoder,e.count-2))};class za{constructor(){this.encoder=new Hs,this.s=0,this.count=0}write(t){this.s===t?this.count++:(Mg(this),this.count=1,this.s=t)}toUint8Array(){return Mg(this),Tn(this.encoder)}}const Ug=e=>{if(e.count>0){const t=e.diff*2+(e.count===1?0:1);Mu(e.encoder,t),e.count>1&&gt(e.encoder,e.count-2)}};class Pu{constructor(){this.encoder=new Hs,this.s=0,this.count=0,this.diff=0}write(t){this.diff===t-this.s?(this.s=t,this.count++):(Ug(this),this.count=1,this.diff=t-this.s,this.s=t)}toUint8Array(){return Ug(this),Tn(this.encoder)}}class EI{constructor(){this.sarr=[],this.s="",this.lensE=new za}write(t){this.s+=t,this.s.length>19&&(this.sarr.push(this.s),this.s=""),this.lensE.write(t.length)}toUint8Array(){const t=new Hs;return this.sarr.push(this.s),this.s="",zi(t,this.sarr.join("")),ja(t,this.lensE.toUint8Array()),Tn(t)}}const Dr=e=>new Error(e),Hn=()=>{throw Dr("Method unimplemented")},Vn=()=>{throw Dr("Unexpected case")},Dg=Dr("Unexpected end of array"),Pg=Dr("Integer out of Range");class Ga{constructor(t){this.arr=t,this.pos=0}}const gi=e=>new Ga(e),kI=e=>e.pos!==e.arr.length,AI=(e,t)=>{const n=new Uint8Array(e.arr.buffer,e.pos+e.arr.byteOffset,t);return e.pos+=t,n},Pe=e=>AI(e,yt(e)),Gi=e=>e.arr[e.pos++],yt=e=>{let t=0,n=1;const r=e.arr.length;for(;e.pos<r;){const i=e.arr[e.pos++];if(t=t+(i&mi)*n,n*=128,i<Xe)return t;if(t>xg)throw Pg}throw Dg},Bu=e=>{let t=e.arr[e.pos++],n=t&Nu,r=64;const i=(t&pr)>0?-1:1;if(!(t&Xe))return i*n;const s=e.arr.length;for(;e.pos<s;){if(t=e.arr[e.pos++],n=n+(t&mi)*r,r*=128,t<Xe)return i*n;if(n>xg)throw Pg}throw Dg},Wi=Ks?e=>Ks.decode(Pe(e)):e=>{let t=yt(e);if(t===0)return"";{let n=String.fromCodePoint(Gi(e));if(--t<100)for(;t--;)n+=String.fromCodePoint(Gi(e));else for(;t>0;){const r=t<1e4?t:1e4,i=e.arr.subarray(e.pos,e.pos+r);e.pos+=r,n+=String.fromCodePoint.apply(null,i),t-=r}return decodeURIComponent(escape(n))}},$u=(e,t)=>{const n=new DataView(e.arr.buffer,e.arr.byteOffset+e.pos,t);return e.pos+=t,n},SI=[e=>{},e=>null,Bu,e=>$u(e,4).getFloat32(0,!1),e=>$u(e,8).getFloat64(0,!1),e=>$u(e,8).getBigInt64(0,!1),e=>!1,e=>!0,Wi,e=>{const t=yt(e),n={};for(let r=0;r<t;r++){const i=Wi(e);n[i]=Ys(e)}return n},e=>{const t=yt(e),n=[];for(let r=0;r<t;r++)n.push(Ys(e));return n},Pe],Ys=e=>SI[127-Gi(e)](e);class Bg extends Ga{constructor(t,n){super(t),this.reader=n,this.s=null,this.count=0}read(){return this.count===0&&(this.s=this.reader(this),kI(this)?this.count=yt(this)+1:this.count=-1),this.count--,this.s}}class Wa extends Ga{constructor(t){super(t),this.s=0,this.count=0}read(){if(this.count===0){this.s=Bu(this);const t=Rg(this.s);this.count=1,t&&(this.s=-this.s,this.count=yt(this)+2)}return this.count--,this.s}}class Fu extends Ga{constructor(t){super(t),this.s=0,this.count=0,this.diff=0}read(){if(this.count===0){const t=Bu(this),n=t&1;this.diff=Mr(t/2),this.count=1,n&&(this.count=yt(this)+2)}return this.s+=this.diff,this.count--,this.s}}class TI{constructor(t){this.decoder=new Wa(t),this.str=Wi(this.decoder),this.spos=0}read(){const t=this.spos+this.decoder.read(),n=this.str.slice(this.spos,t);return this.spos=t,n}}const RI=crypto.getRandomValues.bind(crypto),$g=()=>RI(new Uint32Array(1))[0],OI="10000000-1000-4000-8000"+-1e11,II=()=>OI.replace(/[018]/g,e=>(e^$g()&15>>e/4).toString(16)),Fg=e=>new Promise(e);Promise.all.bind(Promise);const jg=e=>e===void 0?null:e;class xI{constructor(){this.map=new Map}setItem(t,n){this.map.set(t,n)}getItem(t){return this.map.get(t)}}let zg=new xI,CI=!0;try{typeof localStorage<"u"&&localStorage&&(zg=localStorage,CI=!1)}catch{}const NI=zg,LI=Object.assign,MI=Object.keys,UI=(e,t)=>{for(const n in e)t(e[n],n)},Gg=e=>MI(e).length,DI=e=>{for(const t in e)return!1;return!0},PI=(e,t)=>{for(const n in e)if(!t(e[n],n))return!1;return!0},BI=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),$I=(e,t)=>e===t||Gg(e)===Gg(t)&&PI(e,(n,r)=>(n!==void 0||BI(t,r))&&t[r]===n),ju=(e,t,n=0)=>{try{for(;n<e.length;n++)e[n](...t)}finally{n<e.length&&ju(e,t,n+1)}},FI=e=>e,jI=(e,t)=>t.includes(e);var Wg={};const qs=typeof process<"u"&&process.release&&/node|io\.js/.test(process.release.name)&&Object.prototype.toString.call(typeof process<"u"?process:0)==="[object process]";let Yn;const zI=()=>{if(Yn===void 0)if(qs){Yn=Sn();const e=process.argv;let t=null;for(let n=0;n<e.length;n++){const r=e[n];r[0]==="-"?(t!==null&&Yn.set(t,""),t=r):t!==null&&(Yn.set(t,r),t=null)}t!==null&&Yn.set(t,"")}else typeof location=="object"?(Yn=Sn(),(location.search||"?").slice(1).split("&").forEach(e=>{if(e.length!==0){const[t,n]=e.split("=");Yn.set(`--${Cg(t,"-")}`,n),Yn.set(`-${Cg(t,"-")}`,n)}})):Yn=Sn();return Yn},zu=e=>zI().has(e),Gu=e=>jg(qs?Wg[e.toUpperCase().replaceAll("-","_")]:NI.getItem(e));(e=>zu("--"+e)||Gu(e)!==null)("production");const Kg=qs&&jI(Wg.FORCE_COLOR,["true","1","2"]),GI=!zu("--no-colors")&&(!qs||process.stdout.isTTY||Kg)&&(!qs||zu("--color")||Kg||Gu("COLORTERM")!==null||(Gu("TERM")||"").includes("color")),WI=e=>new Uint8Array(e),KI=e=>{const t=WI(e.byteLength);return t.set(e),t};class HI{constructor(t,n){this.left=t,this.right=n}}const mr=(e,t)=>new HI(e,t);typeof DOMParser<"u"&&new DOMParser;const VI=e=>tI(e,(t,n)=>`${n}:${t};`).join(""),gr=Symbol,Hg=gr(),Vg=gr(),YI=gr(),qI=gr(),JI=gr(),Yg=gr(),XI=gr(),qg=gr(),ZI=gr(),QI=e=>{var r;e.length===1&&((r=e[0])==null?void 0:r.constructor)===Function&&(e=e[0]());const t=[];let n=0;for(;n<e.length;n++){const i=e[n];i===void 0||i.constructor===String||i.constructor===Number||i.constructor===Object&&t.push(JSON.stringify(i))}return t},tx={[Hg]:mr("font-weight","bold"),[Vg]:mr("font-weight","normal"),[YI]:mr("color","blue"),[JI]:mr("color","green"),[qI]:mr("color","grey"),[Yg]:mr("color","red"),[XI]:mr("color","purple"),[qg]:mr("color","orange"),[ZI]:mr("color","black")},ex=GI?e=>{var o;e.length===1&&((o=e[0])==null?void 0:o.constructor)===Function&&(e=e[0]());const t=[],n=[],r=Sn();let i=[],s=0;for(;s<e.length;s++){const a=e[s],c=tx[a];if(c!==void 0)r.set(c.left,c.right);else{if(a===void 0)break;if(a.constructor===String||a.constructor===Number){const l=VI(r);s>0||l.length>0?(t.push("%c"+a),n.push(l)):t.push(a)}else break}}for(s>0&&(i=n,i.unshift(t.join("")));s<e.length;s++){const a=e[s];a instanceof Symbol||i.push(a)}return i}:QI,nx=(...e)=>{console.log(...ex(e)),rx.forEach(t=>t.print(e))},rx=ji(),Jg=e=>({[Symbol.iterator](){return this},next:e}),ix=(e,t)=>Jg(()=>{let n;do n=e.next();while(!n.done&&!t(n.value));return n}),Wu=(e,t)=>Jg(()=>{const{done:n,value:r}=e.next();return{done:n,value:n?void 0:t(r)}});class Ku{constructor(t,n){this.clock=t,this.len=n}}class Js{constructor(){this.clients=new Map}}const Xg=(e,t,n)=>t.clients.forEach((r,i)=>{const s=e.doc.store.clients.get(i);for(let o=0;o<r.length;o++){const a=r[o];my(e,s,a.clock,a.len,n)}}),sx=(e,t)=>{let n=0,r=e.length-1;for(;n<=r;){const i=Mr((n+r)/2),s=e[i],o=s.clock;if(o<=t){if(t<o+s.len)return i;n=i+1}else r=i-1}return null},Zg=(e,t)=>{const n=e.clients.get(t.client);return n!==void 0&&sx(n,t.clock)!==null},Hu=e=>{e.clients.forEach(t=>{t.sort((i,s)=>i.clock-s.clock);let n,r;for(n=1,r=1;n<t.length;n++){const i=t[r-1],s=t[n];i.clock+i.len>=s.clock?i.len=pi(i.len,s.clock+s.len-i.clock):(r<n&&(t[r]=s),r++)}t.length=r})},ox=e=>{const t=new Js;for(let n=0;n<e.length;n++)e[n].clients.forEach((r,i)=>{if(!t.clients.has(i)){const s=r.slice();for(let o=n+1;o<e.length;o++)nI(s,e[o].clients.get(i)||[]);t.clients.set(i,s)}});return Hu(t),t},Ka=(e,t,n,r)=>{Nr(e.clients,t,()=>[]).push(new Ku(n,r))},ax=()=>new Js,cx=e=>{const t=ax();return e.clients.forEach((n,r)=>{const i=[];for(let s=0;s<n.length;s++){const o=n[s];if(o.deleted){const a=o.id.clock;let c=o.length;if(s+1<n.length)for(let l=n[s+1];s+1<n.length&&l.deleted;l=n[++s+1])c+=l.length;i.push(new Ku(a,c))}}i.length>0&&t.clients.set(r,i)}),t},Ki=(e,t)=>{gt(e.restEncoder,t.clients.size),Lr(t.clients.entries()).sort((n,r)=>r[0]-n[0]).forEach(([n,r])=>{e.resetDsCurVal(),gt(e.restEncoder,n);const i=r.length;gt(e.restEncoder,i);for(let s=0;s<i;s++){const o=r[s];e.writeDsClock(o.clock),e.writeDsLen(o.len)}})},Vu=e=>{const t=new Js,n=yt(e.restDecoder);for(let r=0;r<n;r++){e.resetDsCurVal();const i=yt(e.restDecoder),s=yt(e.restDecoder);if(s>0){const o=Nr(t.clients,i,()=>[]);for(let a=0;a<s;a++)o.push(new Ku(e.readDsClock(),e.readDsLen()))}}return t},Qg=(e,t,n)=>{const r=new Js,i=yt(e.restDecoder);for(let s=0;s<i;s++){e.resetDsCurVal();const o=yt(e.restDecoder),a=yt(e.restDecoder),c=n.clients.get(o)||[],l=Ae(n,o);for(let u=0;u<a;u++){const f=e.readDsClock(),d=f+e.readDsLen();if(f<l){l<d&&Ka(r,o,l,d-l);let h=Rn(c,f),p=c[h];for(!p.deleted&&p.id.clock<f&&(c.splice(h+1,0,ic(t,p,f-p.id.clock)),h++);h<c.length&&(p=c[h++],p.id.clock<d);)p.deleted||(d<p.id.clock+p.length&&c.splice(h,0,ic(t,p,d-p.id.clock)),p.delete(t))}else Ka(r,o,f,d-f)}}if(r.clients.size>0){const s=new yi;return gt(s.restEncoder,0),Ki(s,r),s.toUint8Array()}return null},ty=$g;class yr extends iI{constructor({guid:t=II(),collectionid:n=null,gc:r=!0,gcFilter:i=()=>!0,meta:s=null,autoLoad:o=!1,shouldLoad:a=!0}={}){super(),this.gc=r,this.gcFilter=i,this.clientID=ty(),this.guid=t,this.collectionid=n,this.share=new Map,this.store=new fy,this._transaction=null,this._transactionCleanups=[],this.subdocs=new Set,this._item=null,this.shouldLoad=a,this.autoLoad=o,this.meta=s,this.isLoaded=!1,this.isSynced=!1,this.whenLoaded=Fg(l=>{this.on("load",()=>{this.isLoaded=!0,l(this)})});const c=()=>Fg(l=>{const u=f=>{(f===void 0||f===!0)&&(this.off("sync",u),l())};this.on("sync",u)});this.on("sync",l=>{l===!1&&this.isSynced&&(this.whenSynced=c()),this.isSynced=l===void 0||l===!0,this.isSynced&&!this.isLoaded&&this.emit("load",[this])}),this.whenSynced=c()}load(){const t=this._item;t!==null&&!this.shouldLoad&&Pt(t.parent.doc,n=>{n.subdocsLoaded.add(this)},null,!0),this.shouldLoad=!0}getSubdocs(){return this.subdocs}getSubdocGuids(){return new Set(Lr(this.subdocs).map(t=>t.guid))}transact(t,n=null){return Pt(this,t,n)}get(t,n=Xt){const r=Nr(this.share,t,()=>{const s=new n;return s._integrate(this,null),s}),i=r.constructor;if(n!==Xt&&i!==n)if(i===Xt){const s=new n;s._map=r._map,r._map.forEach(o=>{for(;o!==null;o=o.left)o.parent=s}),s._start=r._start;for(let o=s._start;o!==null;o=o.right)o.parent=s;return s._length=r._length,this.share.set(t,s),s._integrate(this,null),s}else throw new Error(`Type with the name ${t} has already been defined with a different constructor`);return r}getArray(t=""){return this.get(t,qn)}getText(t=""){return this.get(t,On)}getMap(t=""){return this.get(t,Jn)}getXmlElement(t=""){return this.get(t,_r)}getXmlFragment(t=""){return this.get(t,Xn)}toJSON(){const t={};return this.share.forEach((n,r)=>{t[r]=n.toJSON()}),t}destroy(){Lr(this.subdocs).forEach(n=>n.destroy());const t=this._item;if(t!==null){this._item=null;const n=t.content;n.doc=new yr({guid:this.guid,...n.opts,shouldLoad:!1}),n.doc._item=t,Pt(t.parent.doc,r=>{const i=n.doc;t.deleted||r.subdocsAdded.add(i),r.subdocsRemoved.add(this)},null,!0)}this.emit("destroyed",[!0]),this.emit("destroy",[this]),super.destroy()}}class ey{constructor(t){this.restDecoder=t}resetDsCurVal(){}readDsClock(){return yt(this.restDecoder)}readDsLen(){return yt(this.restDecoder)}}class ny extends ey{readLeftID(){return At(yt(this.restDecoder),yt(this.restDecoder))}readRightID(){return At(yt(this.restDecoder),yt(this.restDecoder))}readClient(){return yt(this.restDecoder)}readInfo(){return Gi(this.restDecoder)}readString(){return Wi(this.restDecoder)}readParentInfo(){return yt(this.restDecoder)===1}readTypeRef(){return yt(this.restDecoder)}readLen(){return yt(this.restDecoder)}readAny(){return Ys(this.restDecoder)}readBuf(){return KI(Pe(this.restDecoder))}readJSON(){return JSON.parse(Wi(this.restDecoder))}readKey(){return Wi(this.restDecoder)}}class lx{constructor(t){this.dsCurrVal=0,this.restDecoder=t}resetDsCurVal(){this.dsCurrVal=0}readDsClock(){return this.dsCurrVal+=yt(this.restDecoder),this.dsCurrVal}readDsLen(){const t=yt(this.restDecoder)+1;return this.dsCurrVal+=t,t}}class Hi extends lx{constructor(t){super(t),this.keys=[],yt(t),this.keyClockDecoder=new Fu(Pe(t)),this.clientDecoder=new Wa(Pe(t)),this.leftClockDecoder=new Fu(Pe(t)),this.rightClockDecoder=new Fu(Pe(t)),this.infoDecoder=new Bg(Pe(t),Gi),this.stringDecoder=new TI(Pe(t)),this.parentInfoDecoder=new Bg(Pe(t),Gi),this.typeRefDecoder=new Wa(Pe(t)),this.lenDecoder=new Wa(Pe(t))}readLeftID(){return new Vi(this.clientDecoder.read(),this.leftClockDecoder.read())}readRightID(){return new Vi(this.clientDecoder.read(),this.rightClockDecoder.read())}readClient(){return this.clientDecoder.read()}readInfo(){return this.infoDecoder.read()}readString(){return this.stringDecoder.read()}readParentInfo(){return this.parentInfoDecoder.read()===1}readTypeRef(){return this.typeRefDecoder.read()}readLen(){return this.lenDecoder.read()}readAny(){return Ys(this.restDecoder)}readBuf(){return Pe(this.restDecoder)}readJSON(){return Ys(this.restDecoder)}readKey(){const t=this.keyClockDecoder.read();if(t<this.keys.length)return this.keys[t];{const n=this.stringDecoder.read();return this.keys.push(n),n}}}class ry{constructor(){this.restEncoder=Ur()}toUint8Array(){return Tn(this.restEncoder)}resetDsCurVal(){}writeDsClock(t){gt(this.restEncoder,t)}writeDsLen(t){gt(this.restEncoder,t)}}class Xs extends ry{writeLeftID(t){gt(this.restEncoder,t.client),gt(this.restEncoder,t.clock)}writeRightID(t){gt(this.restEncoder,t.client),gt(this.restEncoder,t.clock)}writeClient(t){gt(this.restEncoder,t)}writeInfo(t){Lu(this.restEncoder,t)}writeString(t){zi(this.restEncoder,t)}writeParentInfo(t){gt(this.restEncoder,t?1:0)}writeTypeRef(t){gt(this.restEncoder,t)}writeLen(t){gt(this.restEncoder,t)}writeAny(t){Vs(this.restEncoder,t)}writeBuf(t){xe(this.restEncoder,t)}writeJSON(t){zi(this.restEncoder,JSON.stringify(t))}writeKey(t){zi(this.restEncoder,t)}}class iy{constructor(){this.restEncoder=Ur(),this.dsCurrVal=0}toUint8Array(){return Tn(this.restEncoder)}resetDsCurVal(){this.dsCurrVal=0}writeDsClock(t){const n=t-this.dsCurrVal;this.dsCurrVal=t,gt(this.restEncoder,n)}writeDsLen(t){t===0&&Vn(),gt(this.restEncoder,t-1),this.dsCurrVal+=t}}class yi extends iy{constructor(){super(),this.keyMap=new Map,this.keyClock=0,this.keyClockEncoder=new Pu,this.clientEncoder=new za,this.leftClockEncoder=new Pu,this.rightClockEncoder=new Pu,this.infoEncoder=new Lg(Lu),this.stringEncoder=new EI,this.parentInfoEncoder=new Lg(Lu),this.typeRefEncoder=new za,this.lenEncoder=new za}toUint8Array(){const t=Ur();return gt(t,0),xe(t,this.keyClockEncoder.toUint8Array()),xe(t,this.clientEncoder.toUint8Array()),xe(t,this.leftClockEncoder.toUint8Array()),xe(t,this.rightClockEncoder.toUint8Array()),xe(t,Tn(this.infoEncoder)),xe(t,this.stringEncoder.toUint8Array()),xe(t,Tn(this.parentInfoEncoder)),xe(t,this.typeRefEncoder.toUint8Array()),xe(t,this.lenEncoder.toUint8Array()),ja(t,Tn(this.restEncoder)),Tn(t)}writeLeftID(t){this.clientEncoder.write(t.client),this.leftClockEncoder.write(t.clock)}writeRightID(t){this.clientEncoder.write(t.client),this.rightClockEncoder.write(t.clock)}writeClient(t){this.clientEncoder.write(t)}writeInfo(t){this.infoEncoder.write(t)}writeString(t){this.stringEncoder.write(t)}writeParentInfo(t){this.parentInfoEncoder.write(t?1:0)}writeTypeRef(t){this.typeRefEncoder.write(t)}writeLen(t){this.lenEncoder.write(t)}writeAny(t){Vs(this.restEncoder,t)}writeBuf(t){xe(this.restEncoder,t)}writeJSON(t){Vs(this.restEncoder,t)}writeKey(t){const n=this.keyMap.get(t);n===void 0?(this.keyClockEncoder.write(this.keyClock++),this.stringEncoder.write(t)):this.keyClockEncoder.write(n)}}const ux=(e,t,n,r)=>{r=pi(r,t[0].id.clock);const i=Rn(t,r);gt(e.restEncoder,t.length-i),e.writeClient(n),gt(e.restEncoder,r);const s=t[i];s.write(e,r-s.id.clock);for(let o=i+1;o<t.length;o++)t[o].write(e,0)},Yu=(e,t,n)=>{const r=new Map;n.forEach((i,s)=>{Ae(t,s)>i&&r.set(s,i)}),Va(t).forEach((i,s)=>{n.has(s)||r.set(s,0)}),gt(e.restEncoder,r.size),Lr(r.entries()).sort((i,s)=>s[0]-i[0]).forEach(([i,s])=>{ux(e,t.clients.get(i),i,s)})},hx=(e,t)=>{const n=Sn(),r=yt(e.restDecoder);for(let i=0;i<r;i++){const s=yt(e.restDecoder),o=new Array(s),a=e.readClient();let c=yt(e.restDecoder);n.set(a,{i:0,refs:o});for(let l=0;l<s;l++){const u=e.readInfo();switch(Fa&u){case 0:{const f=e.readLen();o[l]=new Ze(At(a,c),f),c+=f;break}case 10:{const f=yt(e.restDecoder);o[l]=new un(At(a,c),f),c+=f;break}default:{const f=(u&(pr|Xe))===0,d=new ve(At(a,c),null,(u&Xe)===Xe?e.readLeftID():null,null,(u&pr)===pr?e.readRightID():null,f?e.readParentInfo()?t.get(e.readString()):e.readLeftID():null,f&&(u&Gs)===Gs?e.readString():null,Fy(e,u));o[l]=d,c+=d.length}}}}return n},fx=(e,t,n)=>{const r=[];let i=Lr(n.keys()).sort((h,p)=>h-p);if(i.length===0)return null;const s=()=>{if(i.length===0)return null;let h=n.get(i[i.length-1]);for(;h.refs.length===h.i;)if(i.pop(),i.length>0)h=n.get(i[i.length-1]);else return null;return h};let o=s();if(o===null)return null;const a=new fy,c=new Map,l=(h,p)=>{const m=c.get(h);(m==null||m>p)&&c.set(h,p)};let u=o.refs[o.i++];const f=new Map,d=()=>{for(const h of r){const p=h.id.client,m=n.get(p);m?(m.i--,a.clients.set(p,m.refs.slice(m.i)),n.delete(p),m.i=0,m.refs=[]):a.clients.set(p,[h]),i=i.filter(v=>v!==p)}r.length=0};for(;;){if(u.constructor!==un){const p=Nr(f,u.id.client,()=>Ae(t,u.id.client))-u.id.clock;if(p<0)r.push(u),l(u.id.client,u.id.clock-1),d();else{const m=u.getMissing(e,t);if(m!==null){r.push(u);const v=n.get(m)||{refs:[],i:0};if(v.refs.length===v.i)l(m,Ae(t,m)),d();else{u=v.refs[v.i++];continue}}else(p===0||p<u.length)&&(u.integrate(e,p),f.set(u.id.client,u.id.clock+u.length))}}if(r.length>0)u=r.pop();else if(o!==null&&o.i<o.refs.length)u=o.refs[o.i++];else{if(o=s(),o===null)break;u=o.refs[o.i++]}}if(a.clients.size>0){const h=new yi;return Yu(h,a,new Map),gt(h.restEncoder,0),{missing:c,update:h.toUint8Array()}}return null},dx=(e,t)=>Yu(e,t.doc.store,t.beforeState),px=(e,t,n,r=new Hi(e))=>Pt(t,i=>{i.local=!1;let s=!1;const o=i.doc,a=o.store,c=hx(r,o),l=fx(i,a,c),u=a.pendingStructs;if(u){for(const[d,h]of u.missing)if(h<Ae(a,d)){s=!0;break}if(l){for(const[d,h]of l.missing){const p=u.missing.get(d);(p==null||p>h)&&u.missing.set(d,h)}u.update=qa([u.update,l.update])}}else a.pendingStructs=l;const f=Qg(r,i,a);if(a.pendingDs){const d=new Hi(gi(a.pendingDs));yt(d.restDecoder);const h=Qg(d,i,a);f&&h?a.pendingDs=qa([f,h]):a.pendingDs=f||h}else a.pendingDs=f;if(s){const d=a.pendingStructs.update;a.pendingStructs=null,sy(i.doc,d)}},n,!1),sy=(e,t,n,r=Hi)=>{const i=gi(t);px(i,e,n,new r(i))},mx=(e,t,n)=>sy(e,t,n,ny),gx=(e,t,n=new Map)=>{Yu(e,t.store,n),Ki(e,cx(t.store))},yx=(e,t=new Uint8Array([0]),n=new yi)=>{const r=oy(t);gx(n,e,r);const i=[n.toUint8Array()];if(e.store.pendingDs&&i.push(e.store.pendingDs),e.store.pendingStructs&&i.push(Nx(e.store.pendingStructs.update,t)),i.length>1){if(n.constructor===Xs)return xx(i.map((s,o)=>o===0?s:Mx(s)));if(n.constructor===yi)return qa(i)}return i[0]},_x=(e,t)=>yx(e,t,new Xs),bx=e=>{const t=new Map,n=yt(e.restDecoder);for(let r=0;r<n;r++){const i=yt(e.restDecoder),s=yt(e.restDecoder);t.set(i,s)}return t},oy=e=>bx(new ey(gi(e))),ay=(e,t)=>(gt(e.restEncoder,t.size),Lr(t.entries()).sort((n,r)=>r[0]-n[0]).forEach(([n,r])=>{gt(e.restEncoder,n),gt(e.restEncoder,r)}),e),wx=(e,t)=>ay(e,Va(t.store)),vx=(e,t=new iy)=>(e instanceof Map?ay(t,e):wx(t,e),t.toUint8Array()),Ex=e=>vx(e,new ry);class kx{constructor(){this.l=[]}}const cy=()=>new kx,ly=(e,t)=>e.l.push(t),uy=(e,t)=>{const n=e.l,r=n.length;e.l=n.filter(i=>t!==i),r===e.l.length&&console.error("[yjs] Tried to remove event handler that doesn't exist.")},hy=(e,t,n)=>ju(e.l,[t,n]);class Vi{constructor(t,n){this.client=t,this.clock=n}}const Ha=(e,t)=>e===t||e!==null&&t!==null&&e.client===t.client&&e.clock===t.clock,At=(e,t)=>new Vi(e,t),Ax=e=>{for(const[t,n]of e.doc.share.entries())if(n===e)return t;throw Vn()},Yi=(e,t)=>t===void 0?!e.deleted:t.sv.has(e.id.client)&&(t.sv.get(e.id.client)||0)>e.id.clock&&!Zg(t.ds,e.id),qu=(e,t)=>{const n=Nr(e.meta,qu,ji),r=e.doc.store;n.has(t)||(t.sv.forEach((i,s)=>{i<Ae(r,s)&&Pr(e,At(s,i))}),Xg(e,t.ds,i=>{}),n.add(t))};class fy{constructor(){this.clients=new Map,this.pendingStructs=null,this.pendingDs=null}}const Va=e=>{const t=new Map;return e.clients.forEach((n,r)=>{const i=n[n.length-1];t.set(r,i.id.clock+i.length)}),t},Ae=(e,t)=>{const n=e.clients.get(t);if(n===void 0)return 0;const r=n[n.length-1];return r.id.clock+r.length},dy=(e,t)=>{let n=e.clients.get(t.id.client);if(n===void 0)n=[],e.clients.set(t.id.client,n);else{const r=n[n.length-1];if(r.id.clock+r.length!==t.id.clock)throw Vn()}n.push(t)},Rn=(e,t)=>{let n=0,r=e.length-1,i=e[r],s=i.id.clock;if(s===t)return r;let o=Mr(t/(s+i.length-1)*r);for(;n<=r;){if(i=e[o],s=i.id.clock,s<=t){if(t<s+i.length)return o;n=o+1}else r=o-1;o=Mr((n+r)/2)}throw Vn()},Ju=(e,t)=>{const n=e.clients.get(t.client);return n[Rn(n,t.clock)]},Xu=(e,t,n)=>{const r=Rn(t,n),i=t[r];return i.id.clock<n&&i instanceof ve?(t.splice(r+1,0,ic(e,i,n-i.id.clock)),r+1):r},Pr=(e,t)=>{const n=e.doc.store.clients.get(t.client);return n[Xu(e,n,t.clock)]},py=(e,t,n)=>{const r=t.clients.get(n.client),i=Rn(r,n.clock),s=r[i];return n.clock!==s.id.clock+s.length-1&&s.constructor!==Ze&&r.splice(i+1,0,ic(e,s,n.clock-s.id.clock+1)),s},Sx=(e,t,n)=>{const r=e.clients.get(t.id.client);r[Rn(r,t.id.clock)]=n},my=(e,t,n,r,i)=>{if(r===0)return;const s=n+r;let o=Xu(e,t,n),a;do a=t[o++],s<a.id.clock+a.length&&Xu(e,t,s),i(a);while(o<t.length&&t[o].id.clock<s)};class Tx{constructor(t,n,r){this.doc=t,this.deleteSet=new Js,this.beforeState=Va(t.store),this.afterState=new Map,this.changed=new Map,this.changedParentTypes=new Map,this._mergeStructs=[],this.origin=n,this.meta=new Map,this.local=r,this.subdocsAdded=new Set,this.subdocsRemoved=new Set,this.subdocsLoaded=new Set,this._needFormattingCleanup=!1}}const gy=(e,t)=>t.deleteSet.clients.size===0&&!eI(t.afterState,(n,r)=>t.beforeState.get(r)!==n)?!1:(Hu(t.deleteSet),dx(e,t),Ki(e,t.deleteSet),!0),yy=(e,t,n)=>{const r=t._item;(r===null||r.id.clock<(e.beforeState.get(r.id.client)||0)&&!r.deleted)&&Nr(e.changed,t,ji).add(n)},Ya=(e,t)=>{let n=e[t],r=e[t-1],i=t;for(;i>0;n=r,r=e[--i-1]){if(r.deleted===n.deleted&&r.constructor===n.constructor&&r.mergeWith(n)){n instanceof ve&&n.parentSub!==null&&n.parent._map.get(n.parentSub)===n&&n.parent._map.set(n.parentSub,r);continue}break}const s=t-i;return s&&e.splice(t+1-s,s),s},Rx=(e,t,n)=>{for(const[r,i]of e.clients.entries()){const s=t.clients.get(r);for(let o=i.length-1;o>=0;o--){const a=i[o],c=a.clock+a.len;for(let l=Rn(s,a.clock),u=s[l];l<s.length&&u.id.clock<c;u=s[++l]){const f=s[l];if(a.clock+a.len<=f.id.clock)break;f instanceof ve&&f.deleted&&!f.keep&&n(f)&&f.gc(t,!1)}}}},Ox=(e,t)=>{e.clients.forEach((n,r)=>{const i=t.clients.get(r);for(let s=n.length-1;s>=0;s--){const o=n[s],a=Tg(i.length-1,1+Rn(i,o.clock+o.len-1));for(let c=a,l=i[c];c>0&&l.id.clock>=o.clock;l=i[c])c-=1+Ya(i,c)}})},_y=(e,t)=>{if(t<e.length){const n=e[t],r=n.doc,i=r.store,s=n.deleteSet,o=n._mergeStructs;try{Hu(s),n.afterState=Va(n.doc.store),r.emit("beforeObserverCalls",[n,r]);const a=[];n.changed.forEach((c,l)=>a.push(()=>{(l._item===null||!l._item.deleted)&&l._callObserver(n,c)})),a.push(()=>{n.changedParentTypes.forEach((c,l)=>{l._dEH.l.length>0&&(l._item===null||!l._item.deleted)&&(c=c.filter(u=>u.target._item===null||!u.target._item.deleted),c.forEach(u=>{u.currentTarget=l,u._path=null}),c.sort((u,f)=>u.path.length-f.path.length),hy(l._dEH,c,n))})}),a.push(()=>r.emit("afterTransaction",[n,r])),ju(a,[]),n._needFormattingCleanup&&Yx(n)}finally{r.gc&&Rx(s,i,r.gcFilter),Ox(s,i),n.afterState.forEach((u,f)=>{const d=n.beforeState.get(f)||0;if(d!==u){const h=i.clients.get(f),p=pi(Rn(h,d),1);for(let m=h.length-1;m>=p;)m-=1+Ya(h,m)}});for(let u=o.length-1;u>=0;u--){const{client:f,clock:d}=o[u].id,h=i.clients.get(f),p=Rn(h,d);p+1<h.length&&Ya(h,p+1)>1||p>0&&Ya(h,p)}if(!n.local&&n.afterState.get(r.clientID)!==n.beforeState.get(r.clientID)&&(nx(qg,Hg,"[yjs] ",Vg,Yg,"Changed the client-id because another client seems to be using it."),r.clientID=ty()),r.emit("afterTransactionCleanup",[n,r]),r._observers.has("update")){const u=new Xs;gy(u,n)&&r.emit("update",[u.toUint8Array(),n.origin,r,n])}if(r._observers.has("updateV2")){const u=new yi;gy(u,n)&&r.emit("updateV2",[u.toUint8Array(),n.origin,r,n])}const{subdocsAdded:a,subdocsLoaded:c,subdocsRemoved:l}=n;(a.size>0||l.size>0||c.size>0)&&(a.forEach(u=>{u.clientID=r.clientID,u.collectionid==null&&(u.collectionid=r.collectionid),r.subdocs.add(u)}),l.forEach(u=>r.subdocs.delete(u)),r.emit("subdocs",[{loaded:c,added:a,removed:l},r,n]),l.forEach(u=>u.destroy())),e.length<=t+1?(r._transactionCleanups=[],r.emit("afterAllTransactions",[r,e])):_y(e,t+1)}}},Pt=(e,t,n=null,r=!0)=>{const i=e._transactionCleanups;let s=!1,o=null;e._transaction===null&&(s=!0,e._transaction=new Tx(e,n,r),i.push(e._transaction),i.length===1&&e.emit("beforeAllTransactions",[e]),e.emit("beforeTransaction",[e._transaction,e]));try{o=t(e._transaction)}finally{if(s){const a=e._transaction===i[0];e._transaction=null,a&&_y(i,0)}}return o};function*Ix(e){const t=yt(e.restDecoder);for(let n=0;n<t;n++){const r=yt(e.restDecoder),i=e.readClient();let s=yt(e.restDecoder);for(let o=0;o<r;o++){const a=e.readInfo();if(a===10){const c=yt(e.restDecoder);yield new un(At(i,s),c),s+=c}else if(Fa&a){const c=(a&(pr|Xe))===0,l=new ve(At(i,s),null,(a&Xe)===Xe?e.readLeftID():null,null,(a&pr)===pr?e.readRightID():null,c?e.readParentInfo()?e.readString():e.readLeftID():null,c&&(a&Gs)===Gs?e.readString():null,Fy(e,a));yield l,s+=l.length}else{const c=e.readLen();yield new Ze(At(i,s),c),s+=c}}}}class Zu{constructor(t,n){this.gen=Ix(t),this.curr=null,this.done=!1,this.filterSkips=n,this.next()}next(){do this.curr=this.gen.next().value||null;while(this.filterSkips&&this.curr!==null&&this.curr.constructor===un);return this.curr}}class Qu{constructor(t){this.currClient=0,this.startClock=0,this.written=0,this.encoder=t,this.clientStructs=[]}}const xx=e=>qa(e,ny,Xs),Cx=(e,t)=>{if(e.constructor===Ze){const{client:n,clock:r}=e.id;return new Ze(At(n,r+t),e.length-t)}else if(e.constructor===un){const{client:n,clock:r}=e.id;return new un(At(n,r+t),e.length-t)}else{const n=e,{client:r,clock:i}=n.id;return new ve(At(r,i+t),null,At(r,i+t-1),null,n.rightOrigin,n.parent,n.parentSub,n.content.splice(t))}},qa=(e,t=Hi,n=yi)=>{if(e.length===1)return e[0];const r=e.map(u=>new t(gi(u)));let i=r.map(u=>new Zu(u,!0)),s=null;const o=new n,a=new Qu(o);for(;i=i.filter(d=>d.curr!==null),i.sort((d,h)=>{if(d.curr.id.client===h.curr.id.client){const p=d.curr.id.clock-h.curr.id.clock;return p===0?d.curr.constructor===h.curr.constructor?0:d.curr.constructor===un?1:-1:p}else return h.curr.id.client-d.curr.id.client}),i.length!==0;){const u=i[0],f=u.curr.id.client;if(s!==null){let d=u.curr,h=!1;for(;d!==null&&d.id.clock+d.length<=s.struct.id.clock+s.struct.length&&d.id.client>=s.struct.id.client;)d=u.next(),h=!0;if(d===null||d.id.client!==f||h&&d.id.clock>s.struct.id.clock+s.struct.length)continue;if(f!==s.struct.id.client)Br(a,s.struct,s.offset),s={struct:d,offset:0},u.next();else if(s.struct.id.clock+s.struct.length<d.id.clock)if(s.struct.constructor===un)s.struct.length=d.id.clock+d.length-s.struct.id.clock;else{Br(a,s.struct,s.offset);const p=d.id.clock-s.struct.id.clock-s.struct.length;s={struct:new un(At(f,s.struct.id.clock+s.struct.length),p),offset:0}}else{const p=s.struct.id.clock+s.struct.length-d.id.clock;p>0&&(s.struct.constructor===un?s.struct.length-=p:d=Cx(d,p)),s.struct.mergeWith(d)||(Br(a,s.struct,s.offset),s={struct:d,offset:0},u.next())}}else s={struct:u.curr,offset:0},u.next();for(let d=u.curr;d!==null&&d.id.client===f&&d.id.clock===s.struct.id.clock+s.struct.length&&d.constructor!==un;d=u.next())Br(a,s.struct,s.offset),s={struct:d,offset:0}}s!==null&&(Br(a,s.struct,s.offset),s=null),th(a);const c=r.map(u=>Vu(u)),l=ox(c);return Ki(o,l),o.toUint8Array()},Nx=(e,t,n=Hi,r=yi)=>{const i=oy(t),s=new r,o=new Qu(s),a=new n(gi(e)),c=new Zu(a,!1);for(;c.curr;){const u=c.curr,f=u.id.client,d=i.get(f)||0;if(c.curr.constructor===un){c.next();continue}if(u.id.clock+u.length>d)for(Br(o,u,pi(d-u.id.clock,0)),c.next();c.curr&&c.curr.id.client===f;)Br(o,c.curr,0),c.next();else for(;c.curr&&c.curr.id.client===f&&c.curr.id.clock+c.curr.length<=d;)c.next()}th(o);const l=Vu(a);return Ki(s,l),s.toUint8Array()},by=e=>{e.written>0&&(e.clientStructs.push({written:e.written,restEncoder:Tn(e.encoder.restEncoder)}),e.encoder.restEncoder=Ur(),e.written=0)},Br=(e,t,n)=>{e.written>0&&e.currClient!==t.id.client&&by(e),e.written===0&&(e.currClient=t.id.client,e.encoder.writeClient(t.id.client),gt(e.encoder.restEncoder,t.id.clock+n)),t.write(e.encoder,n),e.written++},th=e=>{by(e);const t=e.encoder.restEncoder;gt(t,e.clientStructs.length);for(let n=0;n<e.clientStructs.length;n++){const r=e.clientStructs[n];gt(t,r.written),ja(t,r.restEncoder)}},Lx=(e,t,n,r)=>{const i=new n(gi(e)),s=new Zu(i,!1),o=new r,a=new Qu(o);for(let l=s.curr;l!==null;l=s.next())Br(a,t(l),0);th(a);const c=Vu(i);return Ki(o,c),o.toUint8Array()},Mx=e=>Lx(e,FI,Hi,Xs),wy="You must not compute changes after the event-handler fired.";class Ja{constructor(t,n){this.target=t,this.currentTarget=t,this.transaction=n,this._changes=null,this._keys=null,this._delta=null,this._path=null}get path(){return this._path||(this._path=Ux(this.currentTarget,this.target))}deletes(t){return Zg(this.transaction.deleteSet,t.id)}get keys(){if(this._keys===null){if(this.transaction.doc._transactionCleanups.length===0)throw Dr(wy);const t=new Map,n=this.target;this.transaction.changed.get(n).forEach(i=>{if(i!==null){const s=n._map.get(i);let o,a;if(this.adds(s)){let c=s.left;for(;c!==null&&this.adds(c);)c=c.left;if(this.deletes(s))if(c!==null&&this.deletes(c))o="delete",a=Iu(c.content.getContent());else return;else c!==null&&this.deletes(c)?(o="update",a=Iu(c.content.getContent())):(o="add",a=void 0)}else if(this.deletes(s))o="delete",a=Iu(s.content.getContent());else return;t.set(i,{action:o,oldValue:a})}}),this._keys=t}return this._keys}get delta(){return this.changes.delta}adds(t){return t.id.clock>=(this.transaction.beforeState.get(t.id.client)||0)}get changes(){let t=this._changes;if(t===null){if(this.transaction.doc._transactionCleanups.length===0)throw Dr(wy);const n=this.target,r=ji(),i=ji(),s=[];if(t={added:r,deleted:i,delta:s,keys:this.keys},this.transaction.changed.get(n).has(null)){let a=null;const c=()=>{a&&s.push(a)};for(let l=n._start;l!==null;l=l.right)l.deleted?this.deletes(l)&&!this.adds(l)&&((a===null||a.delete===void 0)&&(c(),a={delete:0}),a.delete+=l.length,i.add(l)):this.adds(l)?((a===null||a.insert===void 0)&&(c(),a={insert:[]}),a.insert=a.insert.concat(l.content.getContent()),r.add(l)):((a===null||a.retain===void 0)&&(c(),a={retain:0}),a.retain+=l.length);a!==null&&a.retain===void 0&&c()}this._changes=t}return t}}const Ux=(e,t)=>{const n=[];for(;t._item!==null&&t!==e;){if(t._item.parentSub!==null)n.unshift(t._item.parentSub);else{let r=0,i=t._item.parent._start;for(;i!==t._item&&i!==null;)i.deleted||r++,i=i.right;n.unshift(r)}t=t._item.parent}return n},vy=80;let eh=0;class Dx{constructor(t,n){t.marker=!0,this.p=t,this.index=n,this.timestamp=eh++}}const Px=e=>{e.timestamp=eh++},Ey=(e,t,n)=>{e.p.marker=!1,e.p=t,t.marker=!0,e.index=n,e.timestamp=eh++},Bx=(e,t,n)=>{if(e.length>=vy){const r=e.reduce((i,s)=>i.timestamp<s.timestamp?i:s);return Ey(r,t,n),r}else{const r=new Dx(t,n);return e.push(r),r}},Xa=(e,t)=>{if(e._start===null||t===0||e._searchMarker===null)return null;const n=e._searchMarker.length===0?null:e._searchMarker.reduce((s,o)=>$a(t-s.index)<$a(t-o.index)?s:o);let r=e._start,i=0;for(n!==null&&(r=n.p,i=n.index,Px(n));r.right!==null&&i<t;){if(!r.deleted&&r.countable){if(t<i+r.length)break;i+=r.length}r=r.right}for(;r.left!==null&&i>t;)r=r.left,!r.deleted&&r.countable&&(i-=r.length);for(;r.left!==null&&r.left.id.client===r.id.client&&r.left.id.clock+r.left.length===r.id.clock;)r=r.left,!r.deleted&&r.countable&&(i-=r.length);return n!==null&&$a(n.index-i)<r.parent.length/vy?(Ey(n,r,i),n):Bx(e._searchMarker,r,i)},Zs=(e,t,n)=>{for(let r=e.length-1;r>=0;r--){const i=e[r];if(n>0){let s=i.p;for(s.marker=!1;s&&(s.deleted||!s.countable);)s=s.left,s&&!s.deleted&&s.countable&&(i.index-=s.length);if(s===null||s.marker===!0){e.splice(r,1);continue}i.p=s,s.marker=!0}(t<i.index||n>0&&t===i.index)&&(i.index=pi(t,i.index+n))}},Za=(e,t,n)=>{const r=e,i=t.changedParentTypes;for(;Nr(i,e,()=>[]).push(n),e._item!==null;)e=e._item.parent;hy(r._eH,n,t)};class Xt{constructor(){this._item=null,this._map=new Map,this._start=null,this.doc=null,this._length=0,this._eH=cy(),this._dEH=cy(),this._searchMarker=null}get parent(){return this._item?this._item.parent:null}_integrate(t,n){this.doc=t,this._item=n}_copy(){throw Hn()}clone(){throw Hn()}_write(t){}get _first(){let t=this._start;for(;t!==null&&t.deleted;)t=t.right;return t}_callObserver(t,n){!t.local&&this._searchMarker&&(this._searchMarker.length=0)}observe(t){ly(this._eH,t)}observeDeep(t){ly(this._dEH,t)}unobserve(t){uy(this._eH,t)}unobserveDeep(t){uy(this._dEH,t)}toJSON(){}}const ky=(e,t,n)=>{t<0&&(t=e._length+t),n<0&&(n=e._length+n);let r=n-t;const i=[];let s=e._start;for(;s!==null&&r>0;){if(s.countable&&!s.deleted){const o=s.content.getContent();if(o.length<=t)t-=o.length;else{for(let a=t;a<o.length&&r>0;a++)i.push(o[a]),r--;t=0}}s=s.right}return i},Ay=e=>{const t=[];let n=e._start;for(;n!==null;){if(n.countable&&!n.deleted){const r=n.content.getContent();for(let i=0;i<r.length;i++)t.push(r[i])}n=n.right}return t},Qs=(e,t)=>{let n=0,r=e._start;for(;r!==null;){if(r.countable&&!r.deleted){const i=r.content.getContent();for(let s=0;s<i.length;s++)t(i[s],n++,e)}r=r.right}},Sy=(e,t)=>{const n=[];return Qs(e,(r,i)=>{n.push(t(r,i,e))}),n},$x=e=>{let t=e._start,n=null,r=0;return{[Symbol.iterator](){return this},next:()=>{if(n===null){for(;t!==null&&t.deleted;)t=t.right;if(t===null)return{done:!0,value:void 0};n=t.content.getContent(),r=0,t=t.right}const i=n[r++];return n.length<=r&&(n=null),{done:!1,value:i}}}},Ty=(e,t)=>{const n=Xa(e,t);let r=e._start;for(n!==null&&(r=n.p,t-=n.index);r!==null;r=r.right)if(!r.deleted&&r.countable){if(t<r.length)return r.content.getContent()[t];t-=r.length}},Qa=(e,t,n,r)=>{let i=n;const s=e.doc,o=s.clientID,a=s.store,c=n===null?t._start:n.right;let l=[];const u=()=>{l.length>0&&(i=new ve(At(o,Ae(a,o)),i,i&&i.lastId,c,c&&c.id,t,null,new wi(l)),i.integrate(e,0),l=[])};r.forEach(f=>{if(f===null)l.push(f);else switch(f.constructor){case Number:case Object:case Boolean:case Array:case String:l.push(f);break;default:switch(u(),f.constructor){case Uint8Array:case ArrayBuffer:i=new ve(At(o,Ae(a,o)),i,i&&i.lastId,c,c&&c.id,t,null,new to(new Uint8Array(f))),i.integrate(e,0);break;case yr:i=new ve(At(o,Ae(a,o)),i,i&&i.lastId,c,c&&c.id,t,null,new no(f)),i.integrate(e,0);break;default:if(f instanceof Xt)i=new ve(At(o,Ae(a,o)),i,i&&i.lastId,c,c&&c.id,t,null,new br(f)),i.integrate(e,0);else throw new Error("Unexpected content type in insert operation")}}}),u()},Ry=()=>Dr("Length exceeded!"),Oy=(e,t,n,r)=>{if(n>t._length)throw Ry();if(n===0)return t._searchMarker&&Zs(t._searchMarker,n,r.length),Qa(e,t,null,r);const i=n,s=Xa(t,n);let o=t._start;for(s!==null&&(o=s.p,n-=s.index,n===0&&(o=o.prev,n+=o&&o.countable&&!o.deleted?o.length:0));o!==null;o=o.right)if(!o.deleted&&o.countable){if(n<=o.length){n<o.length&&Pr(e,At(o.id.client,o.id.clock+n));break}n-=o.length}return t._searchMarker&&Zs(t._searchMarker,i,r.length),Qa(e,t,o,r)},Fx=(e,t,n)=>{let i=(t._searchMarker||[]).reduce((s,o)=>o.index>s.index?o:s,{index:0,p:t._start}).p;if(i)for(;i.right;)i=i.right;return Qa(e,t,i,n)},Iy=(e,t,n,r)=>{if(r===0)return;const i=n,s=r,o=Xa(t,n);let a=t._start;for(o!==null&&(a=o.p,n-=o.index);a!==null&&n>0;a=a.right)!a.deleted&&a.countable&&(n<a.length&&Pr(e,At(a.id.client,a.id.clock+n)),n-=a.length);for(;r>0&&a!==null;)a.deleted||(r<a.length&&Pr(e,At(a.id.client,a.id.clock+r)),a.delete(e),r-=a.length),a=a.right;if(r>0)throw Ry();t._searchMarker&&Zs(t._searchMarker,i,-s+r)},tc=(e,t,n)=>{const r=t._map.get(n);r!==void 0&&r.delete(e)},nh=(e,t,n,r)=>{const i=t._map.get(n)||null,s=e.doc,o=s.clientID;let a;if(r==null)a=new wi([r]);else switch(r.constructor){case Number:case Object:case Boolean:case Array:case String:a=new wi([r]);break;case Uint8Array:a=new to(r);break;case yr:a=new no(r);break;default:if(r instanceof Xt)a=new br(r);else throw new Error("Unexpected content type")}new ve(At(o,Ae(s.store,o)),i,i&&i.lastId,null,null,t,n,a).integrate(e,0)},rh=(e,t)=>{const n=e._map.get(t);return n!==void 0&&!n.deleted?n.content.getContent()[n.length-1]:void 0},xy=e=>{const t={};return e._map.forEach((n,r)=>{n.deleted||(t[r]=n.content.getContent()[n.length-1])}),t},Cy=(e,t)=>{const n=e._map.get(t);return n!==void 0&&!n.deleted},jx=(e,t)=>{const n={};return e._map.forEach((r,i)=>{let s=r;for(;s!==null&&(!t.sv.has(s.id.client)||s.id.clock>=(t.sv.get(s.id.client)||0));)s=s.left;s!==null&&Yi(s,t)&&(n[i]=s.content.getContent()[s.length-1])}),n},ec=e=>ix(e.entries(),t=>!t[1].deleted);class zx extends Ja{constructor(t,n){super(t,n),this._transaction=n}}class qn extends Xt{constructor(){super(),this._prelimContent=[],this._searchMarker=[]}static from(t){const n=new qn;return n.push(t),n}_integrate(t,n){super._integrate(t,n),this.insert(0,this._prelimContent),this._prelimContent=null}_copy(){return new qn}clone(){const t=new qn;return t.insert(0,this.toArray().map(n=>n instanceof Xt?n.clone():n)),t}get length(){return this._prelimContent===null?this._length:this._prelimContent.length}_callObserver(t,n){super._callObserver(t,n),Za(this,t,new zx(this,t))}insert(t,n){this.doc!==null?Pt(this.doc,r=>{Oy(r,this,t,n)}):this._prelimContent.splice(t,0,...n)}push(t){this.doc!==null?Pt(this.doc,n=>{Fx(n,this,t)}):this._prelimContent.push(...t)}unshift(t){this.insert(0,t)}delete(t,n=1){this.doc!==null?Pt(this.doc,r=>{Iy(r,this,t,n)}):this._prelimContent.splice(t,n)}get(t){return Ty(this,t)}toArray(){return Ay(this)}slice(t=0,n=this.length){return ky(this,t,n)}toJSON(){return this.map(t=>t instanceof Xt?t.toJSON():t)}map(t){return Sy(this,t)}forEach(t){Qs(this,t)}[Symbol.iterator](){return $x(this)}_write(t){t.writeTypeRef(fC)}}const Gx=e=>new qn;class Wx extends Ja{constructor(t,n,r){super(t,n),this.keysChanged=r}}class Jn extends Xt{constructor(t){super(),this._prelimContent=null,t===void 0?this._prelimContent=new Map:this._prelimContent=new Map(t)}_integrate(t,n){super._integrate(t,n),this._prelimContent.forEach((r,i)=>{this.set(i,r)}),this._prelimContent=null}_copy(){return new Jn}clone(){const t=new Jn;return this.forEach((n,r)=>{t.set(r,n instanceof Xt?n.clone():n)}),t}_callObserver(t,n){Za(this,t,new Wx(this,t,n))}toJSON(){const t={};return this._map.forEach((n,r)=>{if(!n.deleted){const i=n.content.getContent()[n.length-1];t[r]=i instanceof Xt?i.toJSON():i}}),t}get size(){return[...ec(this._map)].length}keys(){return Wu(ec(this._map),t=>t[0])}values(){return Wu(ec(this._map),t=>t[1].content.getContent()[t[1].length-1])}entries(){return Wu(ec(this._map),t=>[t[0],t[1].content.getContent()[t[1].length-1]])}forEach(t){this._map.forEach((n,r)=>{n.deleted||t(n.content.getContent()[n.length-1],r,this)})}[Symbol.iterator](){return this.entries()}delete(t){this.doc!==null?Pt(this.doc,n=>{tc(n,this,t)}):this._prelimContent.delete(t)}set(t,n){return this.doc!==null?Pt(this.doc,r=>{nh(r,this,t,n)}):this._prelimContent.set(t,n),n}get(t){return rh(this,t)}has(t){return Cy(this,t)}clear(){this.doc!==null?Pt(this.doc,t=>{this.forEach(function(n,r,i){tc(t,i,r)})}):this._prelimContent.clear()}_write(t){t.writeTypeRef(dC)}}const Kx=e=>new Jn,$r=(e,t)=>e===t||typeof e=="object"&&typeof t=="object"&&e&&t&&$I(e,t);class ih{constructor(t,n,r,i){this.left=t,this.right=n,this.index=r,this.currentAttributes=i}forward(){switch(this.right===null&&Vn(),this.right.content.constructor){case we:this.right.deleted||qi(this.currentAttributes,this.right.content);break;default:this.right.deleted||(this.index+=this.right.length);break}this.left=this.right,this.right=this.right.right}}const Ny=(e,t,n)=>{for(;t.right!==null&&n>0;){switch(t.right.content.constructor){case we:t.right.deleted||qi(t.currentAttributes,t.right.content);break;default:t.right.deleted||(n<t.right.length&&Pr(e,At(t.right.id.client,t.right.id.clock+n)),t.index+=t.right.length,n-=t.right.length);break}t.left=t.right,t.right=t.right.right}return t},nc=(e,t,n,r)=>{const i=new Map,s=r?Xa(t,n):null;if(s){const o=new ih(s.p.left,s.p,s.index,i);return Ny(e,o,n-s.index)}else{const o=new ih(null,t._start,0,i);return Ny(e,o,n)}},Ly=(e,t,n,r)=>{for(;n.right!==null&&(n.right.deleted===!0||n.right.content.constructor===we&&$r(r.get(n.right.content.key),n.right.content.value));)n.right.deleted||r.delete(n.right.content.key),n.forward();const i=e.doc,s=i.clientID;r.forEach((o,a)=>{const c=n.left,l=n.right,u=new ve(At(s,Ae(i.store,s)),c,c&&c.lastId,l,l&&l.id,t,null,new we(a,o));u.integrate(e,0),n.right=u,n.forward()})},qi=(e,t)=>{const{key:n,value:r}=t;r===null?e.delete(n):e.set(n,r)},My=(e,t)=>{for(;e.right!==null;){if(!(e.right.deleted||e.right.content.constructor===we&&$r(t[e.right.content.key]??null,e.right.content.value)))break;e.forward()}},Uy=(e,t,n,r)=>{const i=e.doc,s=i.clientID,o=new Map;for(const a in r){const c=r[a],l=n.currentAttributes.get(a)??null;if(!$r(l,c)){o.set(a,l);const{left:u,right:f}=n;n.right=new ve(At(s,Ae(i.store,s)),u,u&&u.lastId,f,f&&f.id,t,null,new we(a,c)),n.right.integrate(e,0),n.forward()}}return o},sh=(e,t,n,r,i)=>{n.currentAttributes.forEach((d,h)=>{i[h]===void 0&&(i[h]=null)});const s=e.doc,o=s.clientID;My(n,i);const a=Uy(e,t,n,i),c=r.constructor===String?new Zn(r):r instanceof Xt?new br(r):new bi(r);let{left:l,right:u,index:f}=n;t._searchMarker&&Zs(t._searchMarker,n.index,c.getLength()),u=new ve(At(o,Ae(s.store,o)),l,l&&l.lastId,u,u&&u.id,t,null,c),u.integrate(e,0),n.right=u,n.index=f,n.forward(),Ly(e,t,n,a)},Dy=(e,t,n,r,i)=>{const s=e.doc,o=s.clientID;My(n,i);const a=Uy(e,t,n,i);t:for(;n.right!==null&&(r>0||a.size>0&&(n.right.deleted||n.right.content.constructor===we));){if(!n.right.deleted)switch(n.right.content.constructor){case we:{const{key:c,value:l}=n.right.content,u=i[c];if(u!==void 0){if($r(u,l))a.delete(c);else{if(r===0)break t;a.set(c,l)}n.right.delete(e)}else n.currentAttributes.set(c,l);break}default:r<n.right.length&&Pr(e,At(n.right.id.client,n.right.id.clock+r)),r-=n.right.length;break}n.forward()}if(r>0){let c="";for(;r>0;r--)c+=`
`;n.right=new ve(At(o,Ae(s.store,o)),n.left,n.left&&n.left.lastId,n.right,n.right&&n.right.id,t,null,new Zn(c)),n.right.integrate(e,0),n.forward()}Ly(e,t,n,a)},Py=(e,t,n,r,i)=>{let s=t;const o=Sn();for(;s&&(!s.countable||s.deleted);){if(!s.deleted&&s.content.constructor===we){const l=s.content;o.set(l.key,l)}s=s.right}let a=0,c=!1;for(;t!==s;){if(n===t&&(c=!0),!t.deleted){const l=t.content;switch(l.constructor){case we:{const{key:u,value:f}=l,d=r.get(u)??null;(o.get(u)!==l||d===f)&&(t.delete(e),a++,!c&&(i.get(u)??null)===f&&d!==f&&(d===null?i.delete(u):i.set(u,d))),!c&&!t.deleted&&qi(i,l);break}}}t=t.right}return a},Hx=(e,t)=>{for(;t&&t.right&&(t.right.deleted||!t.right.countable);)t=t.right;const n=new Set;for(;t&&(t.deleted||!t.countable);){if(!t.deleted&&t.content.constructor===we){const r=t.content.key;n.has(r)?t.delete(e):n.add(r)}t=t.left}},Vx=e=>{let t=0;return Pt(e.doc,n=>{let r=e._start,i=e._start,s=Sn();const o=Ou(s);for(;i;){if(i.deleted===!1)switch(i.content.constructor){case we:qi(o,i.content);break;default:t+=Py(n,r,i,s,o),s=Ou(o),r=i;break}i=i.right}}),t},Yx=e=>{const t=new Set,n=e.doc;for(const[r,i]of e.afterState.entries()){const s=e.beforeState.get(r)||0;i!==s&&my(e,n.store.clients.get(r),s,i,o=>{!o.deleted&&o.content.constructor===we&&o.constructor!==Ze&&t.add(o.parent)})}Pt(n,r=>{Xg(e,e.deleteSet,i=>{if(i instanceof Ze||!i.parent._hasFormatting||t.has(i.parent))return;const s=i.parent;i.content.constructor===we?t.add(s):Hx(r,i)});for(const i of t)Vx(i)})},By=(e,t,n)=>{const r=n,i=Ou(t.currentAttributes),s=t.right;for(;n>0&&t.right!==null;){if(t.right.deleted===!1)switch(t.right.content.constructor){case br:case bi:case Zn:n<t.right.length&&Pr(e,At(t.right.id.client,t.right.id.clock+n)),n-=t.right.length,t.right.delete(e);break}t.forward()}s&&Py(e,s,t.right,i,t.currentAttributes);const o=(t.left||t.right).parent;return o._searchMarker&&Zs(o._searchMarker,t.index,-r+n),t};class qx extends Ja{constructor(t,n,r){super(t,n),this.childListChanged=!1,this.keysChanged=new Set,r.forEach(i=>{i===null?this.childListChanged=!0:this.keysChanged.add(i)})}get changes(){if(this._changes===null){const t={keys:this.keys,delta:this.delta,added:new Set,deleted:new Set};this._changes=t}return this._changes}get delta(){if(this._delta===null){const t=this.target.doc,n=[];Pt(t,r=>{const i=new Map,s=new Map;let o=this.target._start,a=null;const c={};let l="",u=0,f=0;const d=()=>{if(a!==null){let h=null;switch(a){case"delete":f>0&&(h={delete:f}),f=0;break;case"insert":(typeof l=="object"||l.length>0)&&(h={insert:l},i.size>0&&(h.attributes={},i.forEach((p,m)=>{p!==null&&(h.attributes[m]=p)}))),l="";break;case"retain":u>0&&(h={retain:u},DI(c)||(h.attributes=LI({},c))),u=0;break}h&&n.push(h),a=null}};for(;o!==null;){switch(o.content.constructor){case br:case bi:this.adds(o)?this.deletes(o)||(d(),a="insert",l=o.content.getContent()[0],d()):this.deletes(o)?(a!=="delete"&&(d(),a="delete"),f+=1):o.deleted||(a!=="retain"&&(d(),a="retain"),u+=1);break;case Zn:this.adds(o)?this.deletes(o)||(a!=="insert"&&(d(),a="insert"),l+=o.content.str):this.deletes(o)?(a!=="delete"&&(d(),a="delete"),f+=o.length):o.deleted||(a!=="retain"&&(d(),a="retain"),u+=o.length);break;case we:{const{key:h,value:p}=o.content;if(this.adds(o)){if(!this.deletes(o)){const m=i.get(h)??null;$r(m,p)?p!==null&&o.delete(r):(a==="retain"&&d(),$r(p,s.get(h)??null)?delete c[h]:c[h]=p)}}else if(this.deletes(o)){s.set(h,p);const m=i.get(h)??null;$r(m,p)||(a==="retain"&&d(),c[h]=m)}else if(!o.deleted){s.set(h,p);const m=c[h];m!==void 0&&($r(m,p)?m!==null&&o.delete(r):(a==="retain"&&d(),p===null?delete c[h]:c[h]=p))}o.deleted||(a==="insert"&&d(),qi(i,o.content));break}}o=o.right}for(d();n.length>0;){const h=n[n.length-1];if(h.retain!==void 0&&h.attributes===void 0)n.pop();else break}}),this._delta=n}return this._delta}}class On extends Xt{constructor(t){super(),this._pending=t!==void 0?[()=>this.insert(0,t)]:[],this._searchMarker=[],this._hasFormatting=!1}get length(){return this._length}_integrate(t,n){super._integrate(t,n);try{this._pending.forEach(r=>r())}catch(r){console.error(r)}this._pending=null}_copy(){return new On}clone(){const t=new On;return t.applyDelta(this.toDelta()),t}_callObserver(t,n){super._callObserver(t,n);const r=new qx(this,t,n);Za(this,t,r),!t.local&&this._hasFormatting&&(t._needFormattingCleanup=!0)}toString(){let t="",n=this._start;for(;n!==null;)!n.deleted&&n.countable&&n.content.constructor===Zn&&(t+=n.content.str),n=n.right;return t}toJSON(){return this.toString()}applyDelta(t,{sanitize:n=!0}={}){this.doc!==null?Pt(this.doc,r=>{const i=new ih(null,this._start,0,new Map);for(let s=0;s<t.length;s++){const o=t[s];if(o.insert!==void 0){const a=!n&&typeof o.insert=="string"&&s===t.length-1&&i.right===null&&o.insert.slice(-1)===`
`?o.insert.slice(0,-1):o.insert;(typeof a!="string"||a.length>0)&&sh(r,this,i,a,o.attributes||{})}else o.retain!==void 0?Dy(r,this,i,o.retain,o.attributes||{}):o.delete!==void 0&&By(r,i,o.delete)}}):this._pending.push(()=>this.applyDelta(t))}toDelta(t,n,r){const i=[],s=new Map,o=this.doc;let a="",c=this._start;function l(){if(a.length>0){const f={};let d=!1;s.forEach((p,m)=>{d=!0,f[m]=p});const h={insert:a};d&&(h.attributes=f),i.push(h),a=""}}const u=()=>{for(;c!==null;){if(Yi(c,t)||n!==void 0&&Yi(c,n))switch(c.content.constructor){case Zn:{const f=s.get("ychange");t!==void 0&&!Yi(c,t)?(f===void 0||f.user!==c.id.client||f.type!=="removed")&&(l(),s.set("ychange",r?r("removed",c.id):{type:"removed"})):n!==void 0&&!Yi(c,n)?(f===void 0||f.user!==c.id.client||f.type!=="added")&&(l(),s.set("ychange",r?r("added",c.id):{type:"added"})):f!==void 0&&(l(),s.delete("ychange")),a+=c.content.str;break}case br:case bi:{l();const f={insert:c.content.getContent()[0]};if(s.size>0){const d={};f.attributes=d,s.forEach((h,p)=>{d[p]=h})}i.push(f);break}case we:Yi(c,t)&&(l(),qi(s,c.content));break}c=c.right}l()};return t||n?Pt(o,f=>{t&&qu(f,t),n&&qu(f,n),u()},"cleanup"):u(),i}insert(t,n,r){if(n.length<=0)return;const i=this.doc;i!==null?Pt(i,s=>{const o=nc(s,this,t,!r);r||(r={},o.currentAttributes.forEach((a,c)=>{r[c]=a})),sh(s,this,o,n,r)}):this._pending.push(()=>this.insert(t,n,r))}insertEmbed(t,n,r){const i=this.doc;i!==null?Pt(i,s=>{const o=nc(s,this,t,!r);sh(s,this,o,n,r||{})}):this._pending.push(()=>this.insertEmbed(t,n,r||{}))}delete(t,n){if(n===0)return;const r=this.doc;r!==null?Pt(r,i=>{By(i,nc(i,this,t,!0),n)}):this._pending.push(()=>this.delete(t,n))}format(t,n,r){if(n===0)return;const i=this.doc;i!==null?Pt(i,s=>{const o=nc(s,this,t,!1);o.right!==null&&Dy(s,this,o,n,r)}):this._pending.push(()=>this.format(t,n,r))}removeAttribute(t){this.doc!==null?Pt(this.doc,n=>{tc(n,this,t)}):this._pending.push(()=>this.removeAttribute(t))}setAttribute(t,n){this.doc!==null?Pt(this.doc,r=>{nh(r,this,t,n)}):this._pending.push(()=>this.setAttribute(t,n))}getAttribute(t){return rh(this,t)}getAttributes(){return xy(this)}_write(t){t.writeTypeRef(pC)}}const Jx=e=>new On;class oh{constructor(t,n=()=>!0){this._filter=n,this._root=t,this._currentNode=t._start,this._firstCall=!0}[Symbol.iterator](){return this}next(){let t=this._currentNode,n=t&&t.content&&t.content.type;if(t!==null&&(!this._firstCall||t.deleted||!this._filter(n)))do if(n=t.content.type,!t.deleted&&(n.constructor===_r||n.constructor===Xn)&&n._start!==null)t=n._start;else for(;t!==null;)if(t.right!==null){t=t.right;break}else t.parent===this._root?t=null:t=t.parent._item;while(t!==null&&(t.deleted||!this._filter(t.content.type)));return this._firstCall=!1,t===null?{value:void 0,done:!0}:(this._currentNode=t,{value:t.content.type,done:!1})}}class Xn extends Xt{constructor(){super(),this._prelimContent=[]}get firstChild(){const t=this._first;return t?t.content.getContent()[0]:null}_integrate(t,n){super._integrate(t,n),this.insert(0,this._prelimContent),this._prelimContent=null}_copy(){return new Xn}clone(){const t=new Xn;return t.insert(0,this.toArray().map(n=>n instanceof Xt?n.clone():n)),t}get length(){return this._prelimContent===null?this._length:this._prelimContent.length}createTreeWalker(t){return new oh(this,t)}querySelector(t){t=t.toUpperCase();const r=new oh(this,i=>i.nodeName&&i.nodeName.toUpperCase()===t).next();return r.done?null:r.value}querySelectorAll(t){return t=t.toUpperCase(),Lr(new oh(this,n=>n.nodeName&&n.nodeName.toUpperCase()===t))}_callObserver(t,n){Za(this,t,new Qx(this,n,t))}toString(){return Sy(this,t=>t.toString()).join("")}toJSON(){return this.toString()}toDOM(t=document,n={},r){const i=t.createDocumentFragment();return r!==void 0&&r._createAssociation(i,this),Qs(this,s=>{i.insertBefore(s.toDOM(t,n,r),null)}),i}insert(t,n){this.doc!==null?Pt(this.doc,r=>{Oy(r,this,t,n)}):this._prelimContent.splice(t,0,...n)}insertAfter(t,n){if(this.doc!==null)Pt(this.doc,r=>{const i=t&&t instanceof Xt?t._item:t;Qa(r,this,i,n)});else{const r=this._prelimContent,i=t===null?0:r.findIndex(s=>s===t)+1;if(i===0&&t!==null)throw Dr("Reference item not found");r.splice(i,0,...n)}}delete(t,n=1){this.doc!==null?Pt(this.doc,r=>{Iy(r,this,t,n)}):this._prelimContent.splice(t,n)}toArray(){return Ay(this)}push(t){this.insert(this.length,t)}unshift(t){this.insert(0,t)}get(t){return Ty(this,t)}slice(t=0,n=this.length){return ky(this,t,n)}forEach(t){Qs(this,t)}_write(t){t.writeTypeRef(gC)}}const Xx=e=>new Xn;class _r extends Xn{constructor(t="UNDEFINED"){super(),this.nodeName=t,this._prelimAttrs=new Map}get nextSibling(){const t=this._item?this._item.next:null;return t?t.content.type:null}get prevSibling(){const t=this._item?this._item.prev:null;return t?t.content.type:null}_integrate(t,n){super._integrate(t,n),this._prelimAttrs.forEach((r,i)=>{this.setAttribute(i,r)}),this._prelimAttrs=null}_copy(){return new _r(this.nodeName)}clone(){const t=new _r(this.nodeName),n=this.getAttributes();return UI(n,(r,i)=>{typeof r=="string"&&t.setAttribute(i,r)}),t.insert(0,this.toArray().map(r=>r instanceof Xt?r.clone():r)),t}toString(){const t=this.getAttributes(),n=[],r=[];for(const a in t)r.push(a);r.sort();const i=r.length;for(let a=0;a<i;a++){const c=r[a];n.push(c+'="'+t[c]+'"')}const s=this.nodeName.toLocaleLowerCase(),o=n.length>0?" "+n.join(" "):"";return`<${s}${o}>${super.toString()}</${s}>`}removeAttribute(t){this.doc!==null?Pt(this.doc,n=>{tc(n,this,t)}):this._prelimAttrs.delete(t)}setAttribute(t,n){this.doc!==null?Pt(this.doc,r=>{nh(r,this,t,n)}):this._prelimAttrs.set(t,n)}getAttribute(t){return rh(this,t)}hasAttribute(t){return Cy(this,t)}getAttributes(t){return t?jx(this,t):xy(this)}toDOM(t=document,n={},r){const i=t.createElement(this.nodeName),s=this.getAttributes();for(const o in s){const a=s[o];typeof a=="string"&&i.setAttribute(o,a)}return Qs(this,o=>{i.appendChild(o.toDOM(t,n,r))}),r!==void 0&&r._createAssociation(i,this),i}_write(t){t.writeTypeRef(mC),t.writeKey(this.nodeName)}}const Zx=e=>new _r(e.readKey());class Qx extends Ja{constructor(t,n,r){super(t,r),this.childListChanged=!1,this.attributesChanged=new Set,n.forEach(i=>{i===null?this.childListChanged=!0:this.attributesChanged.add(i)})}}class Ji extends Jn{constructor(t){super(),this.hookName=t}_copy(){return new Ji(this.hookName)}clone(){const t=new Ji(this.hookName);return this.forEach((n,r)=>{t.set(r,n)}),t}toDOM(t=document,n={},r){const i=n[this.hookName];let s;return i!==void 0?s=i.createDom(this):s=document.createElement(this.hookName),s.setAttribute("data-yjs-hook",this.hookName),r!==void 0&&r._createAssociation(s,this),s}_write(t){t.writeTypeRef(yC),t.writeKey(this.hookName)}}const tC=e=>new Ji(e.readKey());class _i extends On{get nextSibling(){const t=this._item?this._item.next:null;return t?t.content.type:null}get prevSibling(){const t=this._item?this._item.prev:null;return t?t.content.type:null}_copy(){return new _i}clone(){const t=new _i;return t.applyDelta(this.toDelta()),t}toDOM(t=document,n,r){const i=t.createTextNode(this.toString());return r!==void 0&&r._createAssociation(i,this),i}toString(){return this.toDelta().map(t=>{const n=[];for(const i in t.attributes){const s=[];for(const o in t.attributes[i])s.push({key:o,value:t.attributes[i][o]});s.sort((o,a)=>o.key<a.key?-1:1),n.push({nodeName:i,attrs:s})}n.sort((i,s)=>i.nodeName<s.nodeName?-1:1);let r="";for(let i=0;i<n.length;i++){const s=n[i];r+=`<${s.nodeName}`;for(let o=0;o<s.attrs.length;o++){const a=s.attrs[o];r+=` ${a.key}="${a.value}"`}r+=">"}r+=t.insert;for(let i=n.length-1;i>=0;i--)r+=`</${n[i].nodeName}>`;return r}).join("")}toJSON(){return this.toString()}_write(t){t.writeTypeRef(_C)}}const eC=e=>new _i;class ah{constructor(t,n){this.id=t,this.length=n}get deleted(){throw Hn()}mergeWith(t){return!1}write(t,n,r){throw Hn()}integrate(t,n){throw Hn()}}const nC=0;class Ze extends ah{get deleted(){return!0}delete(){}mergeWith(t){return this.constructor!==t.constructor?!1:(this.length+=t.length,!0)}integrate(t,n){n>0&&(this.id.clock+=n,this.length-=n),dy(t.doc.store,this)}write(t,n){t.writeInfo(nC),t.writeLen(this.length-n)}getMissing(t,n){return null}}class to{constructor(t){this.content=t}getLength(){return 1}getContent(){return[this.content]}isCountable(){return!0}copy(){return new to(this.content)}splice(t){throw Hn()}mergeWith(t){return!1}integrate(t,n){}delete(t){}gc(t){}write(t,n){t.writeBuf(this.content)}getRef(){return 3}}const rC=e=>new to(e.readBuf());class eo{constructor(t){this.len=t}getLength(){return this.len}getContent(){return[]}isCountable(){return!1}copy(){return new eo(this.len)}splice(t){const n=new eo(this.len-t);return this.len=t,n}mergeWith(t){return this.len+=t.len,!0}integrate(t,n){Ka(t.deleteSet,n.id.client,n.id.clock,this.len),n.markDeleted()}delete(t){}gc(t){}write(t,n){t.writeLen(this.len-n)}getRef(){return 1}}const iC=e=>new eo(e.readLen()),$y=(e,t)=>new yr({guid:e,...t,shouldLoad:t.shouldLoad||t.autoLoad||!1});class no{constructor(t){t._item&&console.error("This document was already integrated as a sub-document. You should create a second instance instead with the same guid."),this.doc=t;const n={};this.opts=n,t.gc||(n.gc=!1),t.autoLoad&&(n.autoLoad=!0),t.meta!==null&&(n.meta=t.meta)}getLength(){return 1}getContent(){return[this.doc]}isCountable(){return!0}copy(){return new no($y(this.doc.guid,this.opts))}splice(t){throw Hn()}mergeWith(t){return!1}integrate(t,n){this.doc._item=n,t.subdocsAdded.add(this.doc),this.doc.shouldLoad&&t.subdocsLoaded.add(this.doc)}delete(t){t.subdocsAdded.has(this.doc)?t.subdocsAdded.delete(this.doc):t.subdocsRemoved.add(this.doc)}gc(t){}write(t,n){t.writeString(this.doc.guid),t.writeAny(this.opts)}getRef(){return 9}}const sC=e=>new no($y(e.readString(),e.readAny()));class bi{constructor(t){this.embed=t}getLength(){return 1}getContent(){return[this.embed]}isCountable(){return!0}copy(){return new bi(this.embed)}splice(t){throw Hn()}mergeWith(t){return!1}integrate(t,n){}delete(t){}gc(t){}write(t,n){t.writeJSON(this.embed)}getRef(){return 5}}const oC=e=>new bi(e.readJSON());class we{constructor(t,n){this.key=t,this.value=n}getLength(){return 1}getContent(){return[]}isCountable(){return!1}copy(){return new we(this.key,this.value)}splice(t){throw Hn()}mergeWith(t){return!1}integrate(t,n){const r=n.parent;r._searchMarker=null,r._hasFormatting=!0}delete(t){}gc(t){}write(t,n){t.writeKey(this.key),t.writeJSON(this.value)}getRef(){return 6}}const aC=e=>new we(e.readKey(),e.readJSON());class rc{constructor(t){this.arr=t}getLength(){return this.arr.length}getContent(){return this.arr}isCountable(){return!0}copy(){return new rc(this.arr)}splice(t){const n=new rc(this.arr.slice(t));return this.arr=this.arr.slice(0,t),n}mergeWith(t){return this.arr=this.arr.concat(t.arr),!0}integrate(t,n){}delete(t){}gc(t){}write(t,n){const r=this.arr.length;t.writeLen(r-n);for(let i=n;i<r;i++){const s=this.arr[i];t.writeString(s===void 0?"undefined":JSON.stringify(s))}}getRef(){return 2}}const cC=e=>{const t=e.readLen(),n=[];for(let r=0;r<t;r++){const i=e.readString();i==="undefined"?n.push(void 0):n.push(JSON.parse(i))}return new rc(n)};class wi{constructor(t){this.arr=t}getLength(){return this.arr.length}getContent(){return this.arr}isCountable(){return!0}copy(){return new wi(this.arr)}splice(t){const n=new wi(this.arr.slice(t));return this.arr=this.arr.slice(0,t),n}mergeWith(t){return this.arr=this.arr.concat(t.arr),!0}integrate(t,n){}delete(t){}gc(t){}write(t,n){const r=this.arr.length;t.writeLen(r-n);for(let i=n;i<r;i++){const s=this.arr[i];t.writeAny(s)}}getRef(){return 8}}const lC=e=>{const t=e.readLen(),n=[];for(let r=0;r<t;r++)n.push(e.readAny());return new wi(n)};class Zn{constructor(t){this.str=t}getLength(){return this.str.length}getContent(){return this.str.split("")}isCountable(){return!0}copy(){return new Zn(this.str)}splice(t){const n=new Zn(this.str.slice(t));this.str=this.str.slice(0,t);const r=this.str.charCodeAt(t-1);return r>=55296&&r<=56319&&(this.str=this.str.slice(0,t-1)+"�",n.str="�"+n.str.slice(1)),n}mergeWith(t){return this.str+=t.str,!0}integrate(t,n){}delete(t){}gc(t){}write(t,n){t.writeString(n===0?this.str:this.str.slice(n))}getRef(){return 4}}const uC=e=>new Zn(e.readString()),hC=[Gx,Kx,Jx,Zx,Xx,tC,eC],fC=0,dC=1,pC=2,mC=3,gC=4,yC=5,_C=6;class br{constructor(t){this.type=t}getLength(){return 1}getContent(){return[this.type]}isCountable(){return!0}copy(){return new br(this.type._copy())}splice(t){throw Hn()}mergeWith(t){return!1}integrate(t,n){this.type._integrate(t.doc,n)}delete(t){let n=this.type._start;for(;n!==null;)n.deleted?n.id.clock<(t.beforeState.get(n.id.client)||0)&&t._mergeStructs.push(n):n.delete(t),n=n.right;this.type._map.forEach(r=>{r.deleted?r.id.clock<(t.beforeState.get(r.id.client)||0)&&t._mergeStructs.push(r):r.delete(t)}),t.changed.delete(this.type)}gc(t){let n=this.type._start;for(;n!==null;)n.gc(t,!0),n=n.right;this.type._start=null,this.type._map.forEach(r=>{for(;r!==null;)r.gc(t,!0),r=r.left}),this.type._map=new Map}write(t,n){this.type._write(t)}getRef(){return 7}}const bC=e=>new br(hC[e.readTypeRef()](e)),ic=(e,t,n)=>{const{client:r,clock:i}=t.id,s=new ve(At(r,i+n),t,At(r,i+n-1),t.right,t.rightOrigin,t.parent,t.parentSub,t.content.splice(n));return t.deleted&&s.markDeleted(),t.keep&&(s.keep=!0),t.redone!==null&&(s.redone=At(t.redone.client,t.redone.clock+n)),t.right=s,s.right!==null&&(s.right.left=s),e._mergeStructs.push(s),s.parentSub!==null&&s.right===null&&s.parent._map.set(s.parentSub,s),t.length=n,s};class ve extends ah{constructor(t,n,r,i,s,o,a,c){super(t,c.getLength()),this.origin=r,this.left=n,this.right=i,this.rightOrigin=s,this.parent=o,this.parentSub=a,this.redone=null,this.content=c,this.info=this.content.isCountable()?Ig:0}set marker(t){(this.info&Cu)>0!==t&&(this.info^=Cu)}get marker(){return(this.info&Cu)>0}get keep(){return(this.info&Og)>0}set keep(t){this.keep!==t&&(this.info^=Og)}get countable(){return(this.info&Ig)>0}get deleted(){return(this.info&xu)>0}set deleted(t){this.deleted!==t&&(this.info^=xu)}markDeleted(){this.info|=xu}getMissing(t,n){if(this.origin&&this.origin.client!==this.id.client&&this.origin.clock>=Ae(n,this.origin.client))return this.origin.client;if(this.rightOrigin&&this.rightOrigin.client!==this.id.client&&this.rightOrigin.clock>=Ae(n,this.rightOrigin.client))return this.rightOrigin.client;if(this.parent&&this.parent.constructor===Vi&&this.id.client!==this.parent.client&&this.parent.clock>=Ae(n,this.parent.client))return this.parent.client;if(this.origin&&(this.left=py(t,n,this.origin),this.origin=this.left.lastId),this.rightOrigin&&(this.right=Pr(t,this.rightOrigin),this.rightOrigin=this.right.id),this.left&&this.left.constructor===Ze||this.right&&this.right.constructor===Ze)this.parent=null;else if(!this.parent)this.left&&this.left.constructor===ve&&(this.parent=this.left.parent,this.parentSub=this.left.parentSub),this.right&&this.right.constructor===ve&&(this.parent=this.right.parent,this.parentSub=this.right.parentSub);else if(this.parent.constructor===Vi){const r=Ju(n,this.parent);r.constructor===Ze?this.parent=null:this.parent=r.content.type}return null}integrate(t,n){if(n>0&&(this.id.clock+=n,this.left=py(t,t.doc.store,At(this.id.client,this.id.clock-1)),this.origin=this.left.lastId,this.content=this.content.splice(n),this.length-=n),this.parent){if(!this.left&&(!this.right||this.right.left!==null)||this.left&&this.left.right!==this.right){let r=this.left,i;if(r!==null)i=r.right;else if(this.parentSub!==null)for(i=this.parent._map.get(this.parentSub)||null;i!==null&&i.left!==null;)i=i.left;else i=this.parent._start;const s=new Set,o=new Set;for(;i!==null&&i!==this.right;){if(o.add(i),s.add(i),Ha(this.origin,i.origin)){if(i.id.client<this.id.client)r=i,s.clear();else if(Ha(this.rightOrigin,i.rightOrigin))break}else if(i.origin!==null&&o.has(Ju(t.doc.store,i.origin)))s.has(Ju(t.doc.store,i.origin))||(r=i,s.clear());else break;i=i.right}this.left=r}if(this.left!==null){const r=this.left.right;this.right=r,this.left.right=this}else{let r;if(this.parentSub!==null)for(r=this.parent._map.get(this.parentSub)||null;r!==null&&r.left!==null;)r=r.left;else r=this.parent._start,this.parent._start=this;this.right=r}this.right!==null?this.right.left=this:this.parentSub!==null&&(this.parent._map.set(this.parentSub,this),this.left!==null&&this.left.delete(t)),this.parentSub===null&&this.countable&&!this.deleted&&(this.parent._length+=this.length),dy(t.doc.store,this),this.content.integrate(t,this),yy(t,this.parent,this.parentSub),(this.parent._item!==null&&this.parent._item.deleted||this.parentSub!==null&&this.right!==null)&&this.delete(t)}else new Ze(this.id,this.length).integrate(t,0)}get next(){let t=this.right;for(;t!==null&&t.deleted;)t=t.right;return t}get prev(){let t=this.left;for(;t!==null&&t.deleted;)t=t.left;return t}get lastId(){return this.length===1?this.id:At(this.id.client,this.id.clock+this.length-1)}mergeWith(t){if(this.constructor===t.constructor&&Ha(t.origin,this.lastId)&&this.right===t&&Ha(this.rightOrigin,t.rightOrigin)&&this.id.client===t.id.client&&this.id.clock+this.length===t.id.clock&&this.deleted===t.deleted&&this.redone===null&&t.redone===null&&this.content.constructor===t.content.constructor&&this.content.mergeWith(t.content)){const n=this.parent._searchMarker;return n&&n.forEach(r=>{r.p===t&&(r.p=this,!this.deleted&&this.countable&&(r.index-=this.length))}),t.keep&&(this.keep=!0),this.right=t.right,this.right!==null&&(this.right.left=this),this.length+=t.length,!0}return!1}delete(t){if(!this.deleted){const n=this.parent;this.countable&&this.parentSub===null&&(n._length-=this.length),this.markDeleted(),Ka(t.deleteSet,this.id.client,this.id.clock,this.length),yy(t,n,this.parentSub),this.content.delete(t)}}gc(t,n){if(!this.deleted)throw Vn();this.content.gc(t),n?Sx(t,this,new Ze(this.id,this.length)):this.content=new eo(this.length)}write(t,n){const r=n>0?At(this.id.client,this.id.clock+n-1):this.origin,i=this.rightOrigin,s=this.parentSub,o=this.content.getRef()&Fa|(r===null?0:Xe)|(i===null?0:pr)|(s===null?0:Gs);if(t.writeInfo(o),r!==null&&t.writeLeftID(r),i!==null&&t.writeRightID(i),r===null&&i===null){const a=this.parent;if(a._item!==void 0){const c=a._item;if(c===null){const l=Ax(a);t.writeParentInfo(!0),t.writeString(l)}else t.writeParentInfo(!1),t.writeLeftID(c.id)}else a.constructor===String?(t.writeParentInfo(!0),t.writeString(a)):a.constructor===Vi?(t.writeParentInfo(!1),t.writeLeftID(a)):Vn();s!==null&&t.writeString(s)}this.content.write(t,n)}}const Fy=(e,t)=>wC[t&Fa](e),wC=[()=>{Vn()},iC,cC,rC,uC,oC,aC,bC,lC,sC,()=>{Vn()}],vC=10;class un extends ah{get deleted(){return!0}delete(){}mergeWith(t){return this.constructor!==t.constructor?!1:(this.length+=t.length,!0)}integrate(t,n){Vn()}write(t,n){t.writeInfo(vC),gt(t.restEncoder,this.length-n)}getMissing(t,n){return null}}const jy=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:{},zy="__ $YJS$ __";jy[zy]===!0&&console.error("Yjs was already imported. This breaks constructor checks and will lead to issues! - https://github.com/yjs/yjs/issues/438"),jy[zy]=!0;let ch,lh,EC=e=>e();function kC(e,t){if(lh)return lh(e,t);EC(e)}function vi(e,t,n){if(ch)return ch.apply(null,arguments);throw new Error("observable implementation not provided. Call enableReactiveBindings, enableVueBindings or enableMobxBindings.")}function AC(e){ch=function(t,n,r){const i=e.createAtom(t);return n&&n(),i},lh=(t,n)=>e.reaction(t,n,{fireImmediately:!1})}const Gy=new WeakSet;function SC(e){if(Gy.has(e))return e;Gy.add(e);let t;const n=new Map;function r(){if(!t){const f=d=>{(d.changes.added.size||d.changes.deleted.size||d.changes.keys.size||d.changes.delta.length)&&t.reportChanged()};t=vi("map",()=>{e.observe(f)},()=>{e.unobserve(f)})}t.reportObserved(e._implicitObserver)}function i(f){let d=n.get(f);if(!d){const h=p=>{d.reportChanged()};d=vi(f+"",()=>{e.observe(h)},()=>{e.unobserve(h)}),n.set(f,d)}d.reportObserved(e._implicitObserver)}const s=e.get;e.get=function(f){if(typeof f!="number")throw new Error("unexpected");return i(f),Reflect.apply(s,this,arguments)};function o(f){const d=e[f];e[f]=function(){return r(),Reflect.apply(d,this,arguments)}}function a(f){let d=e,h=Object.getOwnPropertyDescriptor(d,f);if(h||(d=Object.getPrototypeOf(d),h=Object.getOwnPropertyDescriptor(d,f)),h||(d=Object.getPrototypeOf(d),h=Object.getOwnPropertyDescriptor(d,f)),!h)throw new Error("property not found");const p=h.get;h.get=function(){return this._disableTracking||r(),Reflect.apply(p,this,arguments)},Object.defineProperty(e,f,h)}function c(f,d){let h=e,p=Object.getOwnPropertyDescriptor(h,f);if(p||(h=Object.getPrototypeOf(h),p=Object.getOwnPropertyDescriptor(h,f)),p||(h=Object.getPrototypeOf(h),p=Object.getOwnPropertyDescriptor(h,f)),!p)throw new Error("property not found");Object.defineProperty(e,d,p)}o("forEach"),o("toJSON"),o("toArray"),o("slice"),o("map"),c("length","lengthUntracked"),a("length");const l=e.push;e.push=function(f){this._disableTracking=!0;const d=l.call(this,f);return this._disableTracking=!1,d};const u=e.slice;return e.slice=function(f,d){this._disableTracking=!0;const h=u.call(this,f,d);return this._disableTracking=!1,h},e}const Wy=new WeakSet;function TC(e){if(Wy.has(e))return e;Wy.add(e);let t;function n(){if(!t){let s=Array.from(e.share.keys());const o=a=>{const c=Array.from(e.share.keys());JSON.stringify(s)!==JSON.stringify(c)&&(s=c,t.reportChanged())};t=vi("map",()=>{e.on("beforeObserverCalls",o)},()=>{e.off("beforeObserverCalls",o)})}t.reportObserved(e._implicitObserver)}const r=e.get;e.get=function(s){if(typeof s!="string")throw new Error("unexpected");const o=Reflect.apply(r,this,arguments);return sc(o),o};function i(s){const o=e[s];let a;e[s]=function(){let c,l=arguments;return n(),a&&a.removeObservers(),a=kC(()=>(c=Reflect.apply(o,e,l),c),()=>t.reportChanged()),c}}return i("toJSON"),Object.defineProperty(e,"keys",{get:()=>(n(),Object.keys(e.share))}),e}const Ky=new WeakSet;function RC(e){if(Ky.has(e))return e;Ky.add(e);let t;const n=new Map;function r(){if(!t){const a=c=>{(c.changes.added.size||c.changes.deleted.size||c.changes.keys.size||c.changes.delta.length)&&t.reportChanged()};t=vi("map",()=>{e.observe(a)},()=>{e.unobserve(a)})}t.reportObserved(e._implicitObserver)}function i(a){let c=n.get(a);if(!c){const l=u=>{u.keysChanged.has(a)&&(u.changes.added.size||u.changes.deleted.size||u.changes.keys.size||u.changes.delta.length)&&c.reportChanged()};c=vi(a,()=>{e.observe(l)},()=>{e.unobserve(l)}),n.set(a,c)}c.reportObserved(e._implicitObserver)}const s=e.get;e.get=function(a){if(typeof a!="string")throw new Error("unexpected");return i(a),Reflect.apply(s,this,arguments)};function o(a){const c=e[a];e[a]=function(){return r(),Reflect.apply(c,this,arguments)}}return o("values"),o("entries"),o("keys"),o("forEach"),o("toJSON"),e}const Hy=new WeakSet;function Vy(e){if(Hy.has(e))return e;Hy.add(e);let t;const n=i=>{t.reportChanged()};t=vi("text",()=>{e.observe(n)},()=>{e.unobserve(n)});function r(i){const s=e[i];e[i]=function(){return t.reportObserved(this._implicitObserver),Reflect.apply(s,this,arguments)}}return r("toString"),r("toJSON"),e}const Yy=new WeakSet;function qy(e){if(Yy.has(e))return e;Yy.add(e);let t;const n=s=>{(s.changes.added.size||s.changes.deleted.size||s.changes.keys.size||s.changes.delta.length)&&t.reportChanged()};t=vi("xml",()=>{e.observe(n)},()=>{e.unobserve(n)});function r(s){const o=e[s];e[s]=function(){return t.reportObserved(this._implicitObserver),Reflect.apply(o,this,arguments)}}function i(s){let o=e,a=Object.getOwnPropertyDescriptor(o,s);if(a||(o=Object.getPrototypeOf(o),a=Object.getOwnPropertyDescriptor(o,s)),a||(o=Object.getPrototypeOf(o),a=Object.getOwnPropertyDescriptor(o,s)),!a)throw new Error("property not found");const c=a.get;a.get=function(){return t.reportObserved(this._implicitObserver),Reflect.apply(c,this,arguments)},Object.defineProperty(e,s,a)}return r("toString"),r("toDOM"),r("toArray"),r("getAttribute"),i("firstChild"),e}function sc(e){return e instanceof _i||e instanceof On?Vy(e):e instanceof qn?SC(e):e instanceof Jn?RC(e):e instanceof yr||Object.prototype.hasOwnProperty.call(e,"autoLoad")?TC(e):e instanceof Xn||e instanceof _r?qy(e):e}function Jy(e){e.share.forEach(t=>{t.constructor!==Xt&&sc(t)})}function Xy(e,t){for(let r=e.length-1;r>=t;r--){let i=e[r];if(!i.deleted){var n;if(i instanceof Ze)continue;(n=i.content)==null||n.getContent().forEach(s=>{s instanceof Xt&&sc(s)})}}}const Zy=new WeakSet;function OC(e){Zy.has(e)||(Zy.add(e),sc(e),e.store.clients.forEach(t=>{t&&Xy(t,0)}),Jy(e),e.on("beforeObserverCalls",t=>{Jy(e),t.afterState.forEach((n,r)=>{const i=t.beforeState.get(r)||0;if(i!==n){const s=t.doc.store.clients.get(r);if(!s)return;const o=Rn(s,i);Xy(s,o)}})}))}class ro{constructor(t){this.value=void 0,this.value=t}}function IC(e){return ArrayBuffer.isView(e)?new ro(e):new ro(Object.freeze(e))}function xC(e){const t=function(){var a;let c=(a=this[ln])==null?void 0:a.implicitObserver;return e._implicitObserver=c,e.slice.bind(e).apply(e,arguments).map(u=>{const f=oc(u,c);return c&&typeof f=="object"?zs(f,c):f})},n=function(a){return a.map(c=>{const l=uh(c);let u=Ei(l)||l;if(u instanceof ro&&(u=u.value),u instanceof Xt&&u.parent)throw new Error("Not supported: reassigning object that already occurs in the tree.");return u})},r=function(){return[].findIndex.apply(t.apply(this),arguments)},i={slice:t,unshift:(...o)=>(e.unshift(n(o)),e.lengthUntracked),push:(...o)=>(e.push(n(o)),e.lengthUntracked),insert:e.insert.bind(e),toJSON:e.toJSON.bind(e),forEach:function(){return[].forEach.apply(t.apply(this),arguments)},every:function(){return[].every.apply(t.apply(this),arguments)},filter:function(){return[].filter.apply(t.apply(this),arguments)},find:function(){return[].find.apply(t.apply(this),arguments)},findIndex:r,some:function(){return[].some.apply(t.apply(this),arguments)},includes:function(){return[].includes.apply(t.apply(this),arguments)},map:function(){return[].map.apply(t.apply(this),arguments)},indexOf:function(){const o=arguments[0];return r.call(this,a=>UC(a,o))},splice:function(){let o=arguments[0]<0?e.length-Math.abs(arguments[0]):arguments[0],a=arguments[1],c=Array.from(Array.from(arguments).slice(2)),l=t.apply(this,[o,Number.isInteger(a)?o+a:void 0]);return e.doc?e.doc.transact(()=>{e.delete(o,a),e.insert(o,n(c))}):(e.delete(o,a),e.insert(o,n(c))),l}},s=[];for(let o in i)s[o]=i[o];return s}function io(e){if(typeof e=="string"&&e.trim().length){const t=Number(e);if(Number.isInteger(t))return t}return e}function Qy(e,t=new qn){if(t[be])throw new Error("unexpected");const n=xC(t),r=new Proxy(n,{set:(i,s,o)=>{throw typeof io(s)!="number"?new Error:new Error("array assignment is not implemented / supported")},get:(i,s,o)=>{const a=io(s);if(a===ac)return t;if(typeof a=="number"){let u;if(o&&o[ln]){var c;u=(c=o[ln])==null?void 0:c.implicitObserver,t._implicitObserver=u}let f=t.get(a);return f=oc(f,u),f}if(a===Symbol.toStringTag)return"Array";if(a===Symbol.iterator){const u=t.slice();return Reflect.get(u,a)}return a==="length"?t.length:Reflect.get(i,a,o)},deleteProperty:(i,s)=>{const o=io(s);if(typeof o!="number")throw new Error;return o<t.lengthUntracked&&o>=0?(t.delete(o),!0):!1},has:(i,s)=>{const o=io(s);return typeof o!="number"?Reflect.has(i,o):o<t.lengthUntracked&&o>=0},getOwnPropertyDescriptor(i,s){const o=io(s);if(o==="length")return{enumerable:!1,configurable:!1,writable:!0};if(typeof o=="number"&&o>=0&&o<t.lengthUntracked)return{enumerable:!0,configurable:!0,writable:!0}},ownKeys:i=>{const s=[];for(let o=0;o<t.length;o++)s.push(o+"");return s.push("length"),s}});return n.push.apply(r,e),r}function t_(e,t=new Jn){if(t[be])throw new Error("unexpected");const n=new Proxy({},{set:(r,i,s)=>{if(typeof i!="string")throw new Error;const o=uh(s);let a=Ei(o)||o;if(a instanceof ro&&(a=a.value),a instanceof Xt&&a.parent)throw new Error("Not supported: reassigning object that already occurs in the tree.");return t.set(i,a),!0},get:(r,i,s)=>{if(i===ac)return t;if(typeof i!="string")return Reflect.get(r,i);let o;if(s&&s[ln]){var a;o=(a=s[ln])==null?void 0:a.implicitObserver,t._implicitObserver=o}let c=t.get(i);return c=oc(c,o),c},deleteProperty:(r,i)=>{if(typeof i!="string")throw new Error;return t.has(i)?(t.delete(i),!0):!1},has:(r,i)=>!!(typeof i=="string"&&t.has(i)),getOwnPropertyDescriptor(r,i){if(typeof i=="string"&&t.has(i))return{enumerable:!0,configurable:!0}},ownKeys:r=>Array.from(t.keys())});so.set(t,n);for(let r in e)n[r]=e[r];return n}function CC(e){return e instanceof Xt}const so=new WeakMap;function oc(e,t){if(CC(e)){if(e._implicitObserver=t,e instanceof qn||e instanceof Jn){if(!so.has(e)){const n=uh(e);so.set(e,n)}e=so.get(e)}else if(e instanceof _r||e instanceof Xn||e instanceof _i||e instanceof Ji||e instanceof On)Tu(e),e.__v_skip=!0;else throw new Error("unknown YType");return e}else{if(e===null)return null;if(typeof e=="object")return IC(e)}return e}function uh(e){if(e==null)return e;if(e=Ei(e)||e,e instanceof qn)return Qy([],e);if(e instanceof Jn)return t_({},e);if(typeof e=="string")return e;if(Array.isArray(e))return Qy(e);if(e instanceof _r||e instanceof Xn||e instanceof _i||e instanceof Ji)return e;if(e instanceof On)return e;if(typeof e=="object")return e instanceof ro?e:t_(e);if(typeof e=="number"||typeof e=="boolean")return e;throw new Error("invalid")}function NC(e){for(let[t,n]of Object.entries(e))if(Array.isArray(n)){if(n.length!==0)throw new Error("Root Array initializer must always be empty array")}else if(n&&typeof n=="object"){if(Object.keys(n).length!==0||Object.getPrototypeOf(n)!==Object.prototype)throw new Error("Root Object initializer must always be {}")}else if(n!=="xml"&&n!=="text")throw new Error("unknown Root initializer")}function e_(e,t,n){let r=t[n];if(!r){n!=="__v_raw"&&n!=="__v_isRef"&&n!=="__v_isReadonly"&&console.warn("property not found on root doc",n);return}return r==="xml"?e.getXmlFragment(n):r==="text"?e.getText(n):Array.isArray(r)?e.getArray(n):e.getMap(n)}function LC(e,t){if(e[be])throw new Error("unexpected");NC(t);const n=new Proxy({},{set:(r,i,s)=>{throw typeof i!="string"?new Error:new Error("cannot set new elements on root doc")},get:(r,i,s)=>{if(i===ac)return e;if(typeof i!="string")return Reflect.get(r,i);let o;if(s&&s[ln]){var a;o=(a=s[ln])==null?void 0:a.implicitObserver,e._implicitObserver=o}if(i==="toJSON"){for(let u of Object.keys(t))e_(e,t,u);return Reflect.get(e,i)}let c=e_(e,t,i);return c=oc(c,o),c},deleteProperty:(r,i)=>{throw new Error("deleteProperty not available for doc")},has:(r,i)=>!!(typeof i=="string"&&e.share.has(i)),getOwnPropertyDescriptor(r,i){if(typeof i=="string"&&e.share.has(i)||i==="toJSON")return{enumerable:!0,configurable:!0}},ownKeys:r=>Array.from(e.share.keys())});return so.set(e,n),n}AC(QO);const ac=Symbol("INTERNAL_SYMBOL");function n_(e,t){const n=Ei(e)||e;if(!n)throw new Error("not a valid synced object");return n instanceof yr?(n.on("update",t),()=>{n.off("update",t)}):(n.observeDeep(t),()=>{n.unobserveDeep(t)})}function MC(e){const t=Ei(e);if(!(t instanceof yr))throw new Error("store is not a valid syncedStore that maps to a Y.Doc");return t}function Ei(e){if(typeof e!="object"||e===null)return;const t=e[ac];return t&&(Tu(t),t.__v_skip=!0),t}function UC(e,t){if(e===t)return!0;if(typeof e=="object"&&typeof t=="object"){const n=Ei(e),r=Ei(t);return!n||!r?!1:n===r}return!1}function DC(e,t=new yr){return OC(t),LC(t,e)}const hh=0,r_=1,i_=2,PC=(e,t)=>{gt(e,hh);const n=Ex(t);xe(e,n)},s_=(e,t,n)=>{gt(e,r_),xe(e,_x(t,n))},BC=(e,t,n)=>s_(t,n,Pe(e)),o_=(e,t,n)=>{try{mx(t,Pe(e),n)}catch(r){console.error("Caught error while handling a Yjs update",r)}},$C=(e,t)=>{gt(e,i_),xe(e,t)},FC=o_,jC=(e,t,n,r)=>{const i=yt(e);switch(i){case hh:BC(e,t,n);break;case r_:o_(e,n,r);break;case i_:FC(e,n,r);break;default:throw new Error("Unknown message type")}return i},wr=DC({shared:[]});function cc(e,t,n){return e.find(r=>r.key===t&&r.type===n)}function a_(e,t,n){const r=cc(wr.shared,e,t);T(r)||wr.shared.push({key:e,type:t,value:n})}function zC(e,t){a_(e,0,t)}function c_(e,t){const n=new On(t);a_(e,1,n)}function GC(e,t){const n=cc(wr.shared,e,0);if(T(n)){n.value=t;return}wr.shared.push({key:e,type:0,value:t})}function WC(e,t){const n=new On(t),r=cc(wr.shared,e,1);if(T(r)){r.value=n;return}wr.shared.push({key:e,type:1,value:n})}function l_(e,t,n){let r;function i(){const o=cc(wr.shared,e,t);T(o)&&(s(),r=n_(o,()=>n(o.value)))}const s=n_(wr.shared,i);return i(),()=>r==null?void 0:r()}function KC(e,t){return l_(e,0,t)}function u_(e,t){return l_(e,1,n=>t(n.toJSON()))}function lc(e){return Tn(e)}let h_=!1;const Fr=MC(wr),vr=So("modem",["second"],e=>{switch(e.target){case"second":!h_&&e.data%2===0&&vr.emit("modem:join");break;case"join":if(e.sender!==vr.id()){vr.reply(e,"joinack");const t=Ur();PC(t,Fr),vr.reply(e,"sync",lc(t));const n=Ur();s_(n,Fr),vr.reply(e,"sync",lc(n))}break;case"joinack":h_=!0;break;case"sync":{if(T(e.data)&&e.sender!==vr.id()){const t=gi(e.data),n=Ur();jC(t,n,Fr,vr)===hh&&vr.emit("modem:sync",lc(n))}break}}});function f_(e){const t=Ur();$C(t,e),vr.emit("modem:sync",lc(t))}Fr.on("update",f_),Fr.on("destroy",()=>{Fr==null||Fr.off("update",f_)});const HC=Math.round(1e3/40),VC=3;class jr extends Error{constructor(t){super(t),Object.setPrototypeOf(this,jr.prototype)}}class fh extends Error{constructor(t){super(t),Object.setPrototypeOf(this,fh.prototype)}}function YC(){return function(){const e=new Uint8Array(4);return!((new Uint32Array(e.buffer)[0]=1)&e[0])}()?"big":"little"}class d_{constructor(t,n){X(this,"uint8View");X(this,"helperInt32View");X(this,"helperUint32View");X(this,"helperFloatView");X(this,"helperByteView");X(this,"switchEndianness");X(this,"byteOffset",0);X(this,"endianness");const{byteOffset:r=0,endianness:i="system"}=n??{};this.byteOffset=r;const s=YC();this.endianness=i==="system"?s:i,this.switchEndianness=this.endianness!==s,typeof Buffer<"u"&&t instanceof Buffer&&(this.byteOffset+=t.byteOffset,t=t.buffer),this.uint8View=new Uint8Array(t,0);const o=new ArrayBuffer(4);this.helperInt32View=new Int32Array(o),this.helperUint32View=new Uint32Array(o),this.helperFloatView=new Float32Array(o),this.helperByteView=new Uint8Array(o)}get currentByteOffset(){return this.byteOffset}seekTo(t){this.byteOffset=t}skipBytes(t){this.byteOffset+=t}}class qC extends d_{constructor(t,n){super(t,n)}copyHelperToOutput(t){for(let n=0;n<t;++n)this.uint8View[this.byteOffset++]=this.helperByteView[this.switchEndianness?t-1-n:n]}writeBool(t){this.uint8View[this.byteOffset++]=t?1:0}writeByte(t){this.uint8View[this.byteOffset++]=Math.floor(t)%256}writeInt32(t){this.helperInt32View[0]=Math.floor(t),this.copyHelperToOutput(4)}writeUint32(t){this.helperUint32View[0]=Math.floor(t),this.copyHelperToOutput(4)}writeFloat32(t){this.helperFloatView[0]=t,this.copyHelperToOutput(4)}writeString(t){for(let n=0;n<t.length;++n)this.uint8View[this.byteOffset++]=t.charCodeAt(n);this.uint8View[this.byteOffset++]=0}}let JC=class extends d_{constructor(t,n){super(t,n)}copyInputToHelper(t){for(let n=0;n<t;++n)this.helperByteView[this.switchEndianness?t-1-n:n]=this.uint8View[this.byteOffset++]}readBool(){return this.uint8View[this.byteOffset++]!==0}readByte(){return this.uint8View[this.byteOffset++]}readFloat32(){return this.copyInputToHelper(4),this.helperFloatView[0]}readInt32(){return this.copyInputToHelper(4),this.helperInt32View[0]}readUint32(){return this.copyInputToHelper(4),this.helperUint32View[0]}readString(){let t="",n=String.fromCharCode(this.uint8View[this.byteOffset++]);for(;n!=="\0";)t+=n,n=String.fromCharCode(this.uint8View[this.byteOffset++]);return t}};const XC=new class{constructor(){X(this,"size",NaN);X(this,"unbounded",this);X(this,"isUnbounded",!0)}add(){return this}fork(){return this}};class Ve{constructor(){X(this,"size",0);X(this,"unbounded",XC);X(this,"isUnbounded",!1)}add(t){return this.size+=t,this}fork(){const t=new Ve;return t.size=this.size,t}}const hn=Symbol("The biggest (in amount of bytes needed) value a schema can represent");class Qn{constructor(){X(this,"__unwrapped")}resolveReferences(t){}seekProperty(t,n){return null}}class ZC{constructor(t){X(this,"key");this.key=t}}var Xi;(function(e){e.STRING="STRING",e.ENUM="ENUM"})(Xi||(Xi={}));class QC extends Qn{constructor(n,r){super();X(this,"_unstableElementSchema");X(this,"length");X(this,"elementSchema");this._unstableElementSchema=n,this.length=r,this.elementSchema=n}resolveReferences(n){this.elementSchema=n.resolve(this._unstableElementSchema)}write(n,r){if(r.length!==this.length)throw new fh(`Expected array of length ${this.length}, got ${r.length}`);for(const i of r)this.elementSchema.write(n,i)}read(n){const r=[];for(let i=0;i<this.length;++i)r.push(this.elementSchema.read(n));return r}measure(n,r=new Ve){for(let i=0;i<this.length;++i)this.elementSchema.measure(n===hn?hn:n[i],r);return r}}class tN extends Qn{read(t){return t.readBool()}write(t,n){t.writeBool(n)}measure(t,n=new Ve){return n.add(1)}}const p_=new tN;class eN extends Qn{read(t){return t.readString()}write(t,n){t.writeString(n)}measure(t,n=new Ve){return t===hn?n.unbounded:n.add(t.length+1)}}const Ce=new eN;class nN extends Qn{read(t){return t.readByte()}write(t,n){t.writeByte(n)}measure(t,n=new Ve){return n.add(1)}}const tr=new nN;class rN extends Qn{read(t){return t.readInt32()}write(t,n){t.writeInt32(n)}measure(t,n=new Ve){return n.add(4)}}const zr=new rN;class iN extends Qn{read(t){return t.readUint32()}write(t,n){t.writeUint32(n)}measure(t,n=new Ve){return n.add(4)}}const uc=new iN;class sN extends Qn{constructor(n){super();X(this,"_unstableElementType");X(this,"elementType");this._unstableElementType=n,this.elementType=n}resolveReferences(n){this.elementType=n.resolve(this._unstableElementType)}write(n,r){n.writeUint32(r.length);for(const i of r)this.elementType.write(n,i)}read(n){const r=[],i=n.readUint32();for(let s=0;s<i;++s)r.push(this.elementType.read(n));return r}measure(n,r=new Ve){if(n===hn)return r.unbounded;uc.measure(n.length,r);for(const i of n)this.elementType.measure(i,r);return r}seekProperty(n,r){if(typeof r=="symbol")return null;const i=Number.parseInt(String(r),10);if(Number.isNaN(i))return null;if(n===hn)return{bufferOffset:this.elementType.measure(hn).size*i,schema:this.elementType};if(i>=n.length)return null;const s=new Ve;for(let o=0;o<i;++o)this.elementType.measure(n[o],s);return{bufferOffset:s.size,schema:this.elementType}}}class m_{constructor(t){X(this,"__unwrapped");X(this,"ref");this.ref=new ZC(t)}resolveReferences(){throw new jr("Tried to resolve a reference directly. Do it through a RefResolver instead.")}read(){throw new jr("Tried to read a reference directly. Resolve it instead.")}write(){throw new jr("Tried to write a reference directly. Resolve it instead.")}measure(){throw new jr("Tried to measure size of a reference directly. Resolve it instead.")}seekProperty(){throw new jr("Tried to seek property of a reference directly. Resolve it instead.")}}class oN{constructor(){X(this,"registry",{})}hasKey(t){return this.registry[t]!==void 0}register(t,n){this.registry[t]=n}resolve(t){if(t instanceof m_){const n=t.ref.key;if(this.registry[n]!==void 0)return this.registry[n];throw new jr(`Couldn't resolve reference to ${n}. Unknown key.`)}return t.resolveReferences(this),t}}class aN{constructor(t,n){X(this,"key");X(this,"__unwrapped");X(this,"__keyDefinition");X(this,"innerType");this.key=t,this.innerType=n(new m_(t)),this.resolveReferences(new oN)}resolveReferences(t){t.hasKey(this.key)||(t.register(this.key,this.innerType),this.innerType.resolveReferences(t))}read(t){return this.innerType.read(t)}write(t,n){this.innerType.write(t,n)}measure(t,n=new Ve){return this.innerType.measure(t,n)}seekProperty(t,n){return this.innerType.seekProperty(t,n)}}function Gr(e){return Object.entries(e)}function g_(e,t){const n={};for(const[r,i]of Gr(t))n[r]=e.resolve(i);return n}class y_ extends Qn{constructor(n){super();X(this,"_properties");X(this,"properties");this._properties=n,this.properties=n}resolveReferences(n){this.properties=g_(n,this._properties)}write(n,r){for(const[i,s]of Gr(this.properties))s.write(n,r[i])}read(n){const r={};for(const[i,s]of Gr(this.properties))r[i]=s.read(n);return r}measure(n,r=new Ve){for(const[i,s]of Gr(this.properties))s.measure(n===hn?hn:n[i],r);return r}seekProperty(n,r){let i=0;for(const[s,o]of Gr(this.properties)){if(s===r)return{bufferOffset:i,schema:o};i+=o.measure(n).size}return null}}class cN extends Qn{constructor(n,r,i){super();X(this,"keyedBy");X(this,"_subTypeMap");X(this,"_baseObject");X(this,"subTypeMap");this.keyedBy=n,this._subTypeMap=i,this._baseObject=new y_(r),this.subTypeMap=i}resolveReferences(n){this._baseObject.resolveReferences(n),this.subTypeMap=g_(n,this._subTypeMap)}write(n,r){const i=r.type,s=this.subTypeMap[i]||null;if(s===null)throw new Error(`Unknown sub-type '${i.toString()}' in among '${JSON.stringify(Object.keys(this.subTypeMap))}'`);this.keyedBy===Xi.ENUM?n.writeByte(r.type):n.writeString(r.type),this._baseObject.write(n,r);for(const[o,a]of Gr(s.properties))a.write(n,r[o])}read(n){const r=this.keyedBy===Xi.ENUM?n.readByte():n.readString(),i=this.subTypeMap[r]||null;if(i===null)throw new Error(`Unknown sub-type '${r}' in among '${JSON.stringify(Object.keys(this.subTypeMap))}'`);const s=this._baseObject.read(n);if(s.type=r,i!==null)for(const[o,a]of Gr(i.properties))s[o]=a.read(n);return s}measure(n,r=new Ve){if(this._baseObject.measure(n,r),this.keyedBy===Xi.ENUM)tr.measure(0,r);else{if(n===hn)return r.unbounded;Ce.measure(n.type,r)}if(n===hn){const i=Object.values(this.subTypeMap).map(s=>{const o=r.fork();return Object.values(s.properties).forEach(a=>a.measure(hn,o)),[s,o.size]}).reduce((s,o)=>s[1]>o[1]?s:o)[0];Object.values(i.properties).forEach(s=>s.measure(hn,r))}else{const i=n.type,s=this.subTypeMap[i]||null;if(s===null)throw new Error(`Unknown sub-type '${i.toString()}', expected one of '${JSON.stringify(Object.keys(this.subTypeMap))}'`);Gr(s.properties).forEach(([o,a])=>a.measure(n[o],r))}return r}}class lN extends Qn{constructor(n){super();X(this,"_innerUnstableSchema");X(this,"innerSchema");this._innerUnstableSchema=n,this.innerSchema=n}resolveReferences(n){this.innerSchema=n.resolve(this._innerUnstableSchema)}write(n,r){r!=null?(n.writeBool(!0),this.innerSchema.write(n,r)):n.writeBool(!1)}read(n){if(n.readBool())return this.innerSchema.read(n)}measure(n,r=new Ve){return n!==void 0&&this.innerSchema.measure(n,r),r.add(1)}}const Ee=e=>new y_(e),dh=(e,t)=>new cN(Xi.STRING,e,t),Be=e=>new sN(e),__=(e,t)=>new QC(e,t),_t=e=>new lN(e),le=((e,t)=>new aN(e,t))("bin-word",e=>dh({},{wordnumber:Ee({value:zr}),wordstring:Ee({value:Ce}),wordarray:Ee({value:Be(e)})})),uN=dh({name:Ce},{wordnumber:Ee({value:zr}),wordstring:Ee({value:Ce}),wordarray:Ee({value:Be(le)})}),b_=dh({key:zr},{wordnumber:Ee({value:zr}),wordstring:Ee({value:Ce}),wordarray:Ee({value:Be(le)})}),hc=Ee({kind:_t(Ce),id:_t(Ce),x:_t(tr),y:_t(tr),lx:_t(tr),ly:_t(tr),code:_t(Ce),name:_t(Ce),char:_t(tr),color:_t(tr),bg:_t(tr),pushable:_t(p_),collision:_t(tr),destructible:_t(p_),p1:_t(le),p2:_t(le),p3:_t(le),cycle:_t(le),stepx:_t(le),stepy:_t(le),sender:_t(le),data:_t(le)}),hN=Ee({terrain:__(_t(hc),of),objects:Be(hc),isdark:_t(le),over:_t(le),under:_t(le),exitnorth:_t(le),exitsouth:_t(le),exitwest:_t(le),exiteast:_t(le),timelimit:_t(le),restartonzap:_t(le),maxplayershots:_t(le)}),w_=Ee({width:uc,height:uc,size:uc,bits:Be(tr)}),fN=Ee({fx:zr,settings:Be(b_)}),dN=Ee({synth:zr,effects:Be(fN),settings:Be(b_)}),pN=Ee({tempo:zr,synths:Be(dN),measures:Be(__(zr,8))}),mN=Ee({id:Ce,code:Ce,board:_t(hN),object:_t(hc),terrain:_t(hc),charset:_t(w_),palette:_t(w_),eighttrack:_t(pN)}),gN=Ee({id:Ce,name:Ce,flags:Be(Ee({player:Ce,values:Be(uN)})),players:Be(Ee({player:Ce,board:Ce})),pages:Be(mN)});function v_(e){if(T(e))return{...e,bits:Array.from((e==null?void 0:e.bits)??[])}}function E_(e){if(T(e))return{...e,bits:Uint8Array.from(e.bits)}}function yN(e){if(T(e))return e}function _N(e){if(T(e))return e}function k_(e,t){return{id:sr(),code:e,...t}}function bN(e){if(T(e))return{id:e.id,code:e.code,board:Bw(e.board),object:Co(e.object),terrain:Co(e.terrain),charset:v_(e.charset),palette:v_(e.palette),eighttrack:yN(e.eighttrack)}}function wN(e){if(T(e))return{id:e.id,code:e.code,board:$w(e.board),object:No(e.object),terrain:No(e.terrain),charset:E_(e.charset),palette:E_(e.palette),eighttrack:_N(e.eighttrack)}}function vN(e){return e.map(t=>t.image)}function EN(e,t){const[n,r,...i]=t;if(T(e.stats)&&T(n))switch(n.image.toLowerCase()){case"rn":case"range":case"sl":case"select":case"nm":case"number":case"tx":case"text":case"ln":case"link":if(T(r)){const s=r.image.toLowerCase();e.stats[s]=vN(i??[])}break;default:{const s=t.slice(1).map(o=>o.image);for(let o=0;o<s.length;++o)e.stats[s[o]]="";break}}}function A_(e){const t={...oo(e)};return Object.keys(t).forEach(n=>{switch(n){case"type":case"name":delete t[n];break}}),t}function kN(e){return T(e)?(e.stats=void 0,oo(e)):{}}function oo(e){var r;if(!T(e))return{};if(T((r=e.stats)==null?void 0:r.type))return e.stats;e.stats={};const t=mu(e.code);let n=!0;for(let i=0;i<t.tokens.length;++i){const s=t.tokens[i];if(s.tokenType===iu){const[o,...a]=s.image.slice(1).split(" "),c=o.toLowerCase(),l=a.join(" "),u=l.toLowerCase().trim();switch(c){case"stat":{const f=mu(`!${l}`);f.tokens.length&&EN(e,f.tokens);break}case Yt.BOARD:e.stats.type=at.BOARD,e.stats.name=u;break;case Yt.OBJECT:e.stats.type=at.OBJECT,e.stats.name=u;break;case Yt.TERRAIN:e.stats.type=at.TERRAIN,e.stats.name=u;break;case Yt.CHARSET:e.stats.type=at.CHARSET,e.stats.name=u;break;case Yt.PALETTE:e.stats.type=at.PALETTE,e.stats.name=u;break;case Yt.EIGHT_TRACK:e.stats.type=at.EIGHT_TRACK,e.stats.name=u;break;case Yt.LOADER:e.stats.type=at.LOADER,e.stats.name=u;break;default:n?e.stats.name=[c,...a].join(" ").trim():e.stats[c]=1;break}n=!1}}return T(e.stats.type)||(e.stats.type=at.OBJECT),e.stats}function S_(e){switch(e){default:case at.ERROR:return"error";case at.LOADER:return Yt.LOADER;case at.BOARD:return Yt.BOARD;case at.OBJECT:return Yt.OBJECT;case at.TERRAIN:return Yt.TERRAIN;case at.CHARSET:return Yt.CHARSET;case at.PALETTE:return Yt.PALETTE;case at.EIGHT_TRACK:return Yt.EIGHT_TRACK}}function ao(e){return oo(e).type??at.ERROR}function Zi(e){return S_(ao(e))}function fn(e){return(oo(e).name??"").toLowerCase()}function ph(e){var t;switch((t=e==null?void 0:e.stats)==null?void 0:t.type){default:return;case at.ERROR:return(e==null?void 0:e.code)??"";case at.LOADER:return(e==null?void 0:e.code)??"";case at.BOARD:return T(e.board)||(e.board=Pw()),e.board.codepage=e.id,e.board;case at.OBJECT:return T(e.object)||(e.object=cf()),e.object.name=fn(e),e.object;case at.TERRAIN:return T(e.terrain)||(e.terrain=cf()),e.terrain.name=fn(e),e.terrain;case at.CHARSET:return T(e.charset),e.charset;case at.PALETTE:return T(e.palette),e.palette;case at.EIGHT_TRACK:return T(e.eighttrack),e.eighttrack}}function AN(e){return{id:sr(),name:Pb(),pages:e,flags:{},players:{}}}function SN(e){if(!T(e))return;const t=Object.keys(e.flags).map(r=>{const i=e.flags[r];return{player:r,values:Object.keys(i).map(s=>Uw(s,i[s])).filter(T)}}),n=Object.keys(e.players).map(r=>{const i=e.players[r];return{player:r,board:i}});return{id:e.id,name:e.name,pages:e.pages.map(bN).filter(T),flags:t,players:n}}function TN(e){if(T(e))return{id:e.id,name:e.name,pages:e.pages.map(wN).filter(T),flags:{},players:{}}}function ki(e,t){if(!T(e))return;const n=t.toLowerCase();return e.pages.find(i=>i.id===t||n===fn(i))}function fc(e,t,n){if(!T(e))return;const r=n.toLowerCase();return e.pages.find(s=>ao(s)===t&&(s.id===n||r===fn(s)))}function RN(e,t){return T(e)?e.pages.filter(n=>ao(n)===t):[]}function T_(e,t){if(!T(e)||!T(t))return!1;const n=ki(e,t.id);return T(n)?!1:(e.pages.push(t),!0)}function ON(e,t){const n=ki(e,t);if(T(e)&&T(n)){const r=t.toLowerCase();return e.pages=e.pages.filter(i=>i.id!==t&&r!==fn(i)),n}}function In(e,t){if(T(t)&&T(t.kind))return T(t.kinddata)||(t.kinddata=T(t.id)?dc(e,t.kind):R_(e,t.kind)),t.kinddata}function dc(e,t){const n=t??"",r=fc(e,at.OBJECT,n);if(T(r)){const i=A_(r);return{...ph(r),...i,name:n,code:r.code}}else return}function R_(e,t){const n=t??"",r=fc(e,at.TERRAIN,n);if(T(r)){const i=A_(r);return{...ph(r),...i,name:n,code:r.code}}else return}function Qi(e,t){return ph(ki(e,t))}function O_(e,t){if(e)return e.flags[t]=e.flags[t]??{},e.flags[t]}function mh(e,t,n){const r=O_(e,t);return r==null?void 0:r[n]}function gh(e,t,n,r){const i=O_(e,t);return i&&(i[n]=r),r}function I_(e,t){return Qi(e,(e==null?void 0:e.players[t])??"")}function x_(e,t,n){T(e)&&T(Qi(e,n))&&(e.players[t]=n)}function C_(e){return Cw(Object.values((e==null?void 0:e.players)??{})).map(n=>Qi(e,n)).filter(T)}function IN(e,t,n,r){const i=Yc(t,(n==null?void 0:n.id)??"");if(!T(e)||!T(t)||!T(i)||!T(i.x)||!T(i.y)||!T(t.lookup)||r.x<0||r.x>=jt||r.y<0||r.y>=yn)return{kind:"edge",collision:Oe.ISSOLID,x:r.x,y:r.y};if(i.x-r.x===0&&i.y-r.y===0)return;const s=r.x+r.y*jt,o=In(e,i),a=i.collision??(o==null?void 0:o.collision),c=Yc(t,t.lookup[s]??"");if(T(c))return{...c};const l=t.terrain[s];if(T(l)){const u=In(e,l),f=l.collision??(u==null?void 0:u.collision);if(af(a,f))return{...l,x:r.x,y:r.y}}i.x=r.x,i.y=r.y,T(i.removed)||(t.lookup[s]=void 0,t.lookup[i.x+i.y*jt]=i.id??"")}function ts(e,t){const n=In(e,t);return T(t==null?void 0:t.id)&&T(t.x)&&T(t.y)?(t.name??(n==null?void 0:n.name)??"object").toLowerCase():((t==null?void 0:t.name)??(n==null?void 0:n.name)??"terrain").toLowerCase()}function yh(e,t,n,r){if(!T(e)||!T(t)||!T(t.named)||!T(n))return;const i=ts(e,n);t.named[i]||(t.named[i]=new Set),t.named[i].add((n==null?void 0:n.id)??r??"")}function xN(e,t,n){if(!(!T(e)||!T(t)||!T(t.lookup)||!T(n==null?void 0:n.id))&&!T(n.removed)){const r=n.x??0,i=n.y??0;t.lookup[r+i*jt]=n.id}}function co(e,t){if(!T(e)||!T(t)||T(t.lookup)&&T(t.named))return;const n=new Array(jt*yn).fill(void 0),r={},i=Object.values(t.objects);for(let a=0;a<i.length;++a){const c=i[a];if(T(c.x)&&T(c.y)&&T(c.id)&&!T(c.removed)){c.category=xo.ISOBJECT,n[c.x+c.y*jt]=c.id;const l=ts(e,c);r[l]||(r[l]=new Set),r[l].add(c.id)}}let s=0,o=0;for(let a=0;a<t.terrain.length;++a){const c=t.terrain[a];if(T(c)){c.x=s,c.y=o,c.category=xo.ISTERRAIN;const l=ts(e,c);r[l]||(r[l]=new Set),r[l].add(a)}++s,s>=jt&&(s=0,++o)}t.lookup=n,t.named=r}function _h(e,t,n){return ts(e,t)!=="player"&&T(t)?(t.removed=n,!0):!1}function pc(e,t,n){var r;if(T(e)&&T(t)&&T(n==null?void 0:n.id)){if(T(t.lookup)&&T(n.x)&&T(n.y)){const s=n.x+n.y*jt;t.lookup[s]===n.id&&delete t.lookup[s]}const i=ts(e,n);T((r=t.named)==null?void 0:r[i])&&T(n.id)&&t.named[i].delete(n.id)}}function CN(e,t,n){if(!T(e)||!T(t))return;const r=Object.values(t.objects);for(let i=0;i<r.length;++i){const s=r[i];T(s.id)&&T(s.removed)&&n-s.removed>HC*5&&df(t,s.id)}}function NN(e,t,n){const r=[];if(!T(e)||!T(t))return r;t.lookup=void 0,co(e,t);const i=Object.values(t.objects);for(let s=0;s<i.length;++s){const o=i[s];if(!T(o.id))continue;o.lx=o.x,o.ly=o.y;const a=In(e,o),c=o.code??(a==null?void 0:a.code)??"";c&&r.push({id:o.id,type:at.OBJECT,code:c,object:o,terrain:void 0})}return CN(e,t,n),r}function LN(e,t,n,r){if(T(e)&&T(t)&&T(n)){const[i,s]=n,o=dc(e,i);if(T(o)&&T(o.name)){const a=Vc(t,r,i);return T(a)&&(a.headless=!0,Lo(a,s),yh(e,t,a)),a}}}function mc(e,t,n,r){if(T(e)&&T(t)&&T(n)){const[i,s]=n,o=R_(e,i);if(T(o)){const c=ff(t,r,i);Lo(c,s);const l=r.x+r.y*jt;return yh(e,t,c,l),c}const a=dc(e,i);if(T(a)&&T(a.name)){const c=Vc(t,r,i);return Lo(c,s),xN(e,t,c),yh(e,t,c),c}}}const MN=navigator.userAgent.indexOf("Mac")!==-1?"cmd":"ctrl",Wr="$dkpurple",UN="$196",DN="$205";function xn(e,t){return`$${e}${t}$blue`}function N_(e,t){return`$${e}${t}$ondkblue`}function Gt(e){de("cli",e)}function PN(e){const t=UN.repeat(e);Gt(`${Wr}${t}`)}function bh(e){const t=DN.repeat(e);Gt(`${Wr}${t}`)}function lo(e){Gt(`${Wr} ${" ".repeat(e.length)} `),PN(e.length+2),Gt(`${Wr} $white${e} `),bh(e.length+2)}function Er(e){Gt(`${Wr} ${" ".repeat(e.length)} `),Gt(`${Wr} $gray${e} `),bh(e.length+2)}function Ot(e,t){Gt(`${Wr} $white${e} $blue${t}`)}function It(e){Gt(`${Wr}$blue${e}`)}function wh(){return go("main")}const BN=fi({get(e,t){const n=wt(e.id()),r=mh(n.book,n.player,t);return[T(r),r]},set(e,t,n){const r=wt(e.id());return gh(r.book,r.player,t,n),[!0,n]},shouldtick(){},tick(){},tock(){}}).command("stat",(e,t)=>{const[n]=t;if(!xt(n))return 0;const[r,i]=n.split(" "),s=T(i)?_e(r):"object",o=T(i)?_e(i):_e(r);return e.command("mod",s,o),e.command("pageopen",o),0}).command("text",(e,t)=>{const n=t.map(_e).join(" ");return de("$2",n),0}).command("hyperlink",(e,t)=>{const[n,...r]=t,i=_e(n),s=r.map(_e).join(" ");return de("$2",`!${s};${i}`),0}).command("bookcreate",(e,t)=>{const[n]=Z(rt(e,t),0,[Y.STRING]),r=go("main",n);return T(r)&&e.command("bookopen",r.id),0}).command("bookopen",(e,t)=>{const n=wt(e.id()),[r]=Z(rt(e,t),0,[Y.STRING]),i=mo(r);return T(i)?(It(`opened [book] ${i.name}`),Ah("main",i.id),e.command("pages")):re("cli","bookopen",`book ${r} not found`,n.player),0}).command("booktrash",(e,t)=>{const[n]=Z(rt(e,t),0,[Y.STRING]),r=Cn("main"),i=mo(n);return T(i)&&(r===i&&Ah("main",""),AL(n),It(`trashed [book] ${i.name}`),ds("cli"),e.command("pages")),0}).command("pageopen",(e,t)=>{const n=wt(e.id()),[r]=Z(rt(e,t),0,[Y.STRING]),i=wh();if(!T(i))return 0;const s=ki(i,r);if(T(s)){const o=fn(s),a=Zi(s);It(`opened [${a}] ${o}`),c_(tf(i.id,s.id),s.code);const c=Zi(s);Ew("cli",i.id,s.id,c,`@book ${i.name}:${o}`,n.player)}else re("cli","pageopen",`page ${r} not found`,n.player);return 0}).command("pagetrash",(e,t)=>{const[n]=Z(rt(e,t),0,[Y.STRING]),r=wh(),i=ON(r,n);if(T(n)){const s=fn(i),o=Zi(i);It(`trashed [${o}] ${s}`),ds("cli"),e.command("pages")}return 0}).command("nodetrash",()=>(_w("cli"),It("node id changed, refreshing page recommended"),0)).command("biosflash",()=>(bw("cli"),It("bios flashed"),0)).command("biostrash",()=>(ww("cli"),It("bios erased, refreshing page recommended"),0)).command("help",(e,t)=>{const n=t.map(_e).join(" ")||"menu";return e.command(`help${n}`),0}).command("books",()=>{Er("books");const e=Cn("main");Ot("main",`${(e==null?void 0:e.name)??"empty"} $GREEN${(e==null?void 0:e.id)??""}`);const t=Cn("content");Ot("content",`${(t==null?void 0:t.name)??"empty"} ${(t==null?void 0:t.id)??""}`),bh(7);const n=po();return n.length?n.forEach(r=>{Gt(`!bookopen ${r.id};${r.name}`)}):It("no books found"),Gt("!bookcreate;create a new book"),0}).command("pages",e=>{Er("pages");const t=wh();return T(t)?(Ot("main",`${t.name} $GREEN${t.id}`),t.pages.length?t.pages.forEach(n=>{const r=fn(n);Gt(`!pageopen ${n.id};${r}`)}):(Gt(""),It("no pages found"),It("use @ to create a page"),It("@board name of board"),It("@object name of object"),It("@terrain name of terrain"),It("You can omit the type and it will default to object"),It("@object name of object"),It("@name of object"))):e.command("bookopen","main"),0}).command("trash",()=>{Er("$REDTRASH"),It("books");const e=po();e.length&&(e.forEach(n=>{Gt(`!booktrash ${n.id};$REDTRASH ${n.name}`)}),Gt(""));const t=Cn("main");return T(t)&&(It(`pages in open ${t.name} book`),t.pages.forEach(n=>{const r=fn(n);Gt(`!pagetrash ${n.id};$REDTRASH ${r}`)}),Gt("")),0}).command("save",()=>(ds("cli"),0)).command("update",()=>{const e=po().map(t=>t.name).join(" ");return Gt(`!biosflash;$GREENWrite ${e} to bios`),0}).command("factoryreset",()=>(Gt("!bioserase;$REDReset bios"),0)).command("send",(e,t)=>{const[n,r]=Z(rt(e,t),0,[Y.STRING,Y.ANY]);switch(n){case"helpmenu":lo("H E L P"),Ot("#help controls","zss controls and inputs"),Gt("!helpcontrols;read help controls"),Gt(""),Ot("#help text","text formatting"),Gt("!helptext;read help text"),Gt(""),Ot("#help developer","developer commands"),Gt("!helpdeveloper;read help developer"),Gt(""),Ot("#help player","player settings"),Gt("!helpplayer;read help player"),Er("keyboard input"),Ot("?","open console"),Ot("esc","close console"),Ot("tab","move console"),Ot("up / down arrow keys","navigate console items"),Ot("left / right arrow keys","change console items"),Ot("enter","interact with console items"),Ot("alt + arrow keys","skip words and console lines"),Ot(`${MN} + up / down arrow keys`,"input history");break;case"helpcontrols":lo("zss controls and inputs"),Er("keyboard input"),Ot("arrow keys","move"),Ot("shift + arrow keys","shoot"),Ot("enter","ok / accept"),Ot("escape","cancel / close"),Ot("tab","menu / action"),Er("mouse input"),It("todo ???"),Er("controller input"),Ot("left stick","move"),Ot("right stick","aim"),Ot("a","ok / accept"),Ot("b","cancel / close"),Ot("y","menu / action"),Ot("x","shoot"),Ot("triggers","shoot");break;case"helptext":lo("text formatting"),Er("typography"),It("plain text"),It("$centering text"),It('"\\"@quoted strings for special chars\\""'),It("$$0-255 for ascii chars $159$176$240"),It(`use color names like ${xn("red","$$red")} to change foreground color`),It(`use color names like ${N_("ongreen","$$ongreen")} to change background color`),It(`use clear ${N_("clear","to change background to")} transparent`),Er("hyperlinks"),It(`${xn("white",'"!hotkey"')} message shortcut;${xn("gray","Label")}`),It(`${xn("white",'"!range"')} flag [labelmin] [labelmax];${xn("gray","Input Label")}`),It(`${xn("white",'"!select"')} flag ...list of values;${xn("gray","Input Label")}`),It(`${xn("white",'"!number"')} flag [minvalue] [maxvalue];${xn("gray","Input Label")}`),It(`${xn("white",'"!text"')} flag;${xn("gray","Input Label")}`);break;case"helpdeveloper":lo("developer commands"),Ot("#books","list books in memory"),Ot("#pages","list pages in opened book"),Ot("@[pagetype:]page name","create & edit a new codepage in the currently opened book"),Ot("#trash","list books and pages from open book you can delete"),Ot("#save","flush state to register");break;case"helpplayer":lo("player settings"),It("todo");break;default:de("$2",`${n} ${r??""}`);break}return 0}),L_=new Set(["p1","p2","p3","cycle","stepx","stepy","sender","data"]),$N=new Set(["inputmove","inputalt","inputctrl","inputshift","inputok","inputcancel","inputmenu"]),FN=["NORTH","SOUTH","WEST","EAST"];function jN(e){const t=wt(e.id??"");if(t.inputcurrent!==void 0)return;const[n=fe.NONE]=t.inputqueue;e.inputmove=[],e.inputok=0,e.inputcancel=0,e.inputmenu=0;const r=t.inputmods[n];switch(e.inputalt=r&fw?1:0,e.inputctrl=r&dw?1:0,e.inputshift=r&pw?1:0,n){case fe.MOVE_UP:case fe.MOVE_DOWN:case fe.MOVE_LEFT:case fe.MOVE_RIGHT:e.inputmove=[FN[n-fe.MOVE_UP]];break;case fe.OK_BUTTON:e.inputok=1;break;case fe.CANCEL_BUTTON:e.inputcancel=1;break;case fe.MENU_BUTTON:e.inputmenu=1;break}t.inputcurrent=n,t.inputqueue.delete(n)}function es(e,t,n,r){const i=xt(t)?t:t.id,s=xt(t)?void 0:{x:t.x??0,y:t.y??0},o=xt(n)?n:n.id,a=i??s;T(o)&&T(a)&&e.send(o,r,a)}function M_(e,t,n,r){T(n==null?void 0:n.id)?(n.headless=!0,pc(e,t,n)):ff(t,r,"empty")}function U_(e,t,n,r,i){const s=IN(t,n,r,i);if(T(s)){es(e,s,e.id(),"thud"),r.kind==="player"?es(e,e.id(),s,"touch"):r.collision===Oe.ISBULLET?es(e,e.id(),s,"shot"):es(e,e.id(),s,"bump");const o=In(t,s);return(s.destructible??(o==null?void 0:o.destructible))&&M_(t,n,s,i),!1}return!0}const zN=fi({get(e,t){const n=wt(e.id());if(n.object){$N.has(t)&&jN(n.object);const s=n.object[t];if(T(s)||L_.has(t))return[!0,s]}const r=n.board?qc(n.board,n.object):void 0,i=mh(n.book,(r==null?void 0:r.id)??"",t);return[T(i),i]},set(e,t,n){const r=wt(e.id());if(T(r.object)&&(T(r.object[t])||L_.has(t)))return r.object[t]=n,[!0,n];const i=r.board?qc(r.board,r.object):void 0;return gh(r.book,(i==null?void 0:i.id)??"",t,n),[!0,n]},shouldtick(e,t){var r,i,s,o;const n=wt(e.id());!t||!T((r=n.object)==null?void 0:r.x)||!T((i=n.object)==null?void 0:i.y)||!T((s=n.object)==null?void 0:s.stepx)||!T((o=n.object)==null?void 0:o.stepy)||U_(e,n.book,n.board,n.object,{x:n.object.x+n.object.stepx,y:n.object.y+n.object.stepy})||Hc(n.object,{stepx:0,stepy:0})},tick(){},tock(e){var n;(n=wt(e.id()).object)!=null&&n.headless&&e.command("die")}}).command("become",(e,t)=>{var s,o;const n=wt(e.id()),r={x:((s=n.object)==null?void 0:s.x)??0,y:((o=n.object)==null?void 0:o.y)??0},[i]=Z(rt(e,t),0,[Y.KIND]);return co(n.book,n.board),pc(n.book,n.board,n.object),_h(n.book,n.object,e.timestamp())&&mc(n.book,n.board,i,r),e.endofprogram(),0}).command("bind",()=>0).command("change",(e,t)=>{const n=wt(e.id());if(!T(n.book)||!T(n.board))return 0;const[r,i]=Z(rt(e,t),0,[Y.KIND,Y.KIND]);co(n.book,n.board);const s=Zc(r)??"",o=Wc(n.board,s),a=Lw(o,r),c=Zc(i),l=Tf(i),u=Rf(i);return a.forEach(f=>{if(ts(n.book,f)===c)T(l)&&(f.color=l),T(u)&&(f.bg=u);else{if(T(f.id)&&(pc(n.book,n.board,f),!_h(n.book,f,e.timestamp())))return;Ln(f)&&mc(n.book,n.board,i,f)}}),0}).command("char",(e,t)=>{const n=wt(e.id()),[r]=Z(rt(e,t),0,[Y.NUMBER]);return T(n.object)&&(n.object.char=r),0}).command("color",(e,t)=>{const n=wt(e.id()),[r]=Z(rt(e,t),0,[Y.COLOR]);return T(n.object)&&T(r)&&Lo(n.object,r),0}).command("cycle",(e,t)=>{const n=wt(e.id()),[r]=Z(rt(e,t),0,[Y.NUMBER]),i=Zr(Math.round(r),1,255);return uf(n.object,"cycle",i),0}).command("die",e=>{var n;const t=wt(e.id());return(n=t.object)!=null&&n.headless&&pc(t.book,t.board,t.object),_h(t.book,t.object,e.timestamp()),e.endofprogram(),0}).command("endgame",e=>(e.set("health",0),0)).command("go",(e,t)=>{const n=wt(e.id());if(!T(n.object))return 1;const[r]=Z(rt(e,t),0,[Y.DIR]);return U_(e,n.book,n.board,n.object,r),n.object.x!==r.x&&n.object.y!==r.y?1:0}).command("put",(e,t)=>{const n=wt(e.id());if(!T(n.book)||!T(n.board))return 0;const[r,i]=Z(rt(e,t),0,[Y.DIR,Y.KIND]);return co(n.book,n.board),mc(n.book,n.board,i,r),0}).command("send",(e,t)=>{var f,d;const n=wt(e.id()),[r,i]=Z(rt(e,t),0,[Y.STRING,Y.ANY]),[s,o]=r.split(":"),a=T(o)?s:"self",c=o??s;function l(h){h.forEach(p=>{T(p.id)&&e.send(p.id,c,i)})}const u=a.toLowerCase();switch(u){case"all":for(const h of Object.keys(((f=n.board)==null?void 0:f.objects)??{}))e.send(h,c,i);break;case"self":e.message({id:sr(),sender:e.id(),target:c,data:i});break;case"others":for(const h of Object.keys(((d=n.board)==null?void 0:d.objects)??{}))h!==e.id()&&e.send(h,c,i);break;case"player":break;default:{l(Kc(n.board,[a]));const h=e.get(u);ne(h)?l(Kc(n.board,h)):l(Kc(n.board,[h]));break}}return 0}).command("shoot",(e,t)=>{const n=wt(e.id());if(!T(n.book)||!T(n.board)||!Ln(n.object))return 0;const[r,i]=Z(rt(e,t),0,[Y.DIR,Y.MAYBE_KIND]),s=Tr(n.object,r),o=tn({x:0,y:0},s),a=tn({x:n.object.x,y:n.object.y},s);co(n.book,n.board);let c=jw(n.board,a);if(T(c)&&!T(c.id)){const l=In(n.book,n.object),u=In(n.book,c);af(c.collision??(l==null?void 0:l.collision),c.collision??(u==null?void 0:u.collision))||(c=void 0)}if(T(c)){T(c.id)&&es(e,e.id(),c,"shot");const l=In(n.book,c);(c.destructible??(l==null?void 0:l.destructible))&&M_(n.book,n.board,c,a);const u=LN(n.book,n.board,i??["bullet"],a);T(u)&&(u.collision=Oe.ISBULLET,es(e,c,e.id(),"thud"))}else{const l=mc(n.book,n.board,i??["bullet"],a);T(l)&&(l.collision=Oe.ISBULLET,Hc(l,{stepx:o.x,stepy:o.y}))}return e.yield(),0}).command("throwstar",(e,t)=>e.command("shoot",...t,"star")?1:0).command("try",(e,t)=>{const[,n]=Z(rt(e,t),0,[Y.DIR]);return e.command("go",...t)&&n<t.length&&e.command(...t.slice(n)),e.yield(),0}).command("walk",(e,t)=>{const n=wt(e.id());if(!Ln(n.object))return 0;const[r]=Z(rt(e,t),0,[Y.DIR]),i=Tr(n.object,r),s=tn({x:0,y:0},i);return Hc(n.object,{stepx:s.x,stepy:s.y}),0}).command("stat",(e,t)=>{const n=wt(e.id());return n.object&&(n.object.name=t.map(_e).join(" ")),0});var D_={exports:{}};/*! Case - v1.6.2 - 2020-03-24
* Copyright (c) 2020 Nathan Bubna; Licensed MIT, GPL */(function(e){(function(){var t=function(h,p){return p=p||"",h.replace(/(^|-)/g,"$1\\u"+p).replace(/,/g,"\\u"+p)},n=t("20-26,28-2F,3A-40,5B-60,7B-7E,A0-BF,D7,F7","00"),r="a-z"+t("DF-F6,F8-FF","00"),i="A-Z"+t("C0-D6,D8-DE","00"),s="A|An|And|As|At|But|By|En|For|If|In|Of|On|Or|The|To|Vs?\\.?|Via",o=function(h,p,m,v){return h=h||n,p=p||r,m=m||i,v=v||s,{capitalize:new RegExp("(^|["+h+"])(["+p+"])","g"),pascal:new RegExp("(^|["+h+"])+(["+p+m+"])","g"),fill:new RegExp("["+h+"]+(.|$)","g"),sentence:new RegExp('(^\\s*|[\\?\\!\\.]+"?\\s+"?|,\\s+")(['+p+"])","g"),improper:new RegExp("\\b("+v+")\\b","g"),relax:new RegExp("([^"+m+"])(["+m+"]*)(["+m+"])(?=[^"+m+"]|$)","g"),upper:new RegExp("^[^"+p+"]+$"),hole:/[^\s]\s[^\s]/,apostrophe:/'/g,room:new RegExp("["+h+"]")}},a=o(),c={re:a,unicodes:t,regexps:o,types:[],up:String.prototype.toUpperCase,low:String.prototype.toLowerCase,cap:function(h){return c.up.call(h.charAt(0))+h.slice(1)},decap:function(h){return c.low.call(h.charAt(0))+h.slice(1)},deapostrophe:function(h){return h.replace(a.apostrophe,"")},fill:function(h,p,m){return p!=null&&(h=h.replace(a.fill,function(v,b){return b?p+b:""})),m&&(h=c.deapostrophe(h)),h},prep:function(h,p,m,v){if(h=h==null?"":h+"",!v&&a.upper.test(h)&&(h=c.low.call(h)),!p&&!a.hole.test(h)){var b=c.fill(h," ");a.hole.test(b)&&(h=b)}return!m&&!a.room.test(h)&&(h=h.replace(a.relax,c.relax)),h},relax:function(h,p,m,v){return p+" "+(m?m+" ":"")+v}},l={_:c,of:function(h){for(var p=0,m=c.types.length;p<m;p++)if(l[c.types[p]].apply(l,arguments)===h)return c.types[p]},flip:function(h){return h.replace(/\w/g,function(p){return(p==c.up.call(p)?c.low:c.up).call(p)})},random:function(h){return h.replace(/\w/g,function(p){return(Math.round(Math.random())?c.up:c.low).call(p)})},type:function(h,p){l[h]=p,c.types.push(h)}},u={lower:function(h,p,m){return c.fill(c.low.call(c.prep(h,p)),p,m)},snake:function(h){return l.lower(h,"_",!0)},constant:function(h){return l.upper(h,"_",!0)},camel:function(h){return c.decap(l.pascal(h))},kebab:function(h){return l.lower(h,"-",!0)},upper:function(h,p,m){return c.fill(c.up.call(c.prep(h,p,!1,!0)),p,m)},capital:function(h,p,m){return c.fill(c.prep(h).replace(a.capitalize,function(v,b,y){return b+c.up.call(y)}),p,m)},header:function(h){return l.capital(h,"-",!0)},pascal:function(h){return c.fill(c.prep(h,!1,!0).replace(a.pascal,function(p,m,v){return c.up.call(v)}),"",!0)},title:function(h){return l.capital(h).replace(a.improper,function(p,m,v,b){return v>0&&v<b.lastIndexOf(" ")?c.low.call(p):p})},sentence:function(h,p,m){return h=l.lower(h).replace(a.sentence,function(v,b,y){return b+c.up.call(y)}),p&&p.forEach(function(v){h=h.replace(new RegExp("\\b"+l.lower(v)+"\\b","g"),c.cap)}),m&&m.forEach(function(v){h=h.replace(new RegExp("(\\b"+l.lower(v)+"\\. +)(\\w)"),function(b,y,A){return y+c.low.call(A)})}),h}};u.squish=u.pascal,l.default=l;for(var f in u)l.type(f,u[f]);var d=typeof d=="function"?d:function(){};d(e.exports?e.exports=l:this.Case=l)}).call(Re)})(D_);var GN=D_.exports,WN=hs(GN);const Kr={};function P_(e,t){return e.player=t,e.layers=[],e.layout=[],e.layoutreset=!0,e.layoutfocus="scroll",e}function B_(e){e.text=[],Object.values(Kr[e.id]??{}).forEach(t=>t==null?void 0:t()),Kr[e.id]={}}function $_(e){const t=e.layout.find(n=>n.name===e.layoutfocus);if(!t){const n={id:sr(),name:e.layoutfocus,edge:Qe.RIGHT,size:20,text:[]};return e.layout.push(n),e.layoutreset=!1,n}return t}const vh={},KN=new Set(["hk","hotkey","rn","range","sl","select","nm","number","tx","text"]),HN=new Set(["rn","range","sl","select","nm","number","tx","text"]),VN=new Set(["tx","text"]),YN={rn:1,range:1,sl:0,select:0,nm:0,number:0,tx:"",text:""};function Ai(e){let t=vh[e];return T(t)?t:vh[e]=t=P_({},e)}function qN(){return Object.keys(vh)}function JN(e){const t=Ai(e);t.layout=t.layout.filter(n=>n.edge!==Qe.SCROLL)}function XN(e,t,n){Object.values(Kr).forEach(r=>{if(r[t]!==void 0){const i=Xh(e.id(),t);Kt(n)&&GC(i,n),xt(n)&&WC(i,n)}})}function ZN(e){const t=Ai(e);t.layout=t.layout.filter(n=>n.edge!==Qe.SCROLL||n.text.length>0)}function Eh(e,t,n,r,i){const s=Ai(e),o=r,a=i??WN.capital(t),c=s.layout.find(l=>l.name===a);if(c)s.layoutreset=!0,s.layoutfocus=a,Kt(o)&&(c.size=o);else switch(n){case Qe.START:P_(s,e);break;case Qe.LEFT:case Qe.RIGHT:case Qe.TOP:case Qe.BOTTOM:case Qe.SCROLL:{const l={id:sr(),name:a,edge:n,size:o??hw[n],text:[]};s.layout.push(l),s.layoutfocus=a;break}}}function QN(e,t){const n=Ai(e),r=$_(n);n.layoutreset&&(n.layoutreset=!1,B_(r)),r.text.push(t)}function tL(e,t,n,r,i){const s=Ai(e),o=$_(s);s.layoutreset&&(s.layoutreset=!1,B_(o));const a=r.toLowerCase(),c=[t.id(),n,...KN.has(a)?[a]:["hyperlink",r],...i],l=c[2];if(HN.has(l)){const u=`${c[3]??""}`;Kr[o.id]=Kr[o.id]??{};const f=t.get(u)??YN[l];if(Kr[o.id][u]===void 0){const d=Xh(t.id(),u);Kt(f)&&zC(d,f),xt(f)&&c_(d,f),VN.has(l)?Kr[o.id][u]=u_(d,h=>{T(h)&&h!==t.get(u)&&(console.info("modemobservevaluestring??",u,h,t.get(u)),t.set(u,h))}):Kr[o.id][u]=KC(d,h=>{T(h)&&h!==t.get(u)&&(console.info("modemobservevaluenumber??",u,h,t.get(u)),t.set(u,h))})}}o.text.push(c)}const eL=fi({get(){return[!1,void 0]},set(e,t,n){return XN(e,t,n),[!1,void 0]},shouldtick(){},tick(e){var r;const t=wt(e.id());let n="scroll";T((r=t.object)==null?void 0:r.name)&&(n=t.object.name),Eh(t.player,"scroll",Qe.SCROLL,void 0,n)},tock(e){const t=wt(e.id());ZN(t.player)}}).command("gadget",(e,t)=>{const n=wt(e.id()),r=rt(e,t),[i]=Z(r,0,[Y.STRING]),s=uw[i.toLowerCase()];if(s===Qe.SCROLL){const[,o,a]=Z(r,0,[Y.STRING,Y.MAYBE_STRING,Y.MAYBE_NUMBER]);Eh(n.player,i,s,a,o)}else{const[,o,a]=Z(r,0,[Y.STRING,Y.MAYBE_NUMBER,Y.MAYBE_STRING]);Eh(n.player,i,s,o,a)}return 0}).command("text",(e,t)=>{const n=wt(e.id()),r=t.map(_e).join("");return QN(n.player,r),0}).command("hyperlink",(e,t)=>{const n=wt(e.id()),[r,i,...s]=t,o=_e(r),a=_e(i);return tL(n.player,e,o,a,s),0}),nL=(e,t)=>{const n=wt(e.id());if(!T(n.binaryfile))return 0;const[r]=Z(rt(e,t),0,[Y.STRING]),i=r.toLowerCase();let s="";switch(i){case"seek":case"text":break;default:{const[,a]=Z(rt(e,t),0,[Y.STRING,Y.STRING]);s=a;break}}const o=i.endsWith("le");switch(i){case"seek":{const[,a]=Z(rt(e,t),0,[Y.STRING,Y.NUMBER]);n.binaryfile.cursor=a;break}case"float32":case"float32le":{e.set(s,n.binaryfile.dataview.getFloat32(n.binaryfile.cursor,o)),n.binaryfile.cursor+=4;break}case"float64":case"float64le":{e.set(s,n.binaryfile.dataview.getFloat64(n.binaryfile.cursor,o)),n.binaryfile.cursor+=8;break}case"int8":case"int8le":{e.set(s,n.binaryfile.dataview.getInt8(n.binaryfile.cursor)),n.binaryfile.cursor+=1;break}case"int16":case"int16le":{const a=n.binaryfile.dataview.getInt16(n.binaryfile.cursor,o);e.set(s,a),n.binaryfile.cursor+=2;break}case"int32":case"int32le":{e.set(s,n.binaryfile.dataview.getInt32(n.binaryfile.cursor,o)),n.binaryfile.cursor+=4;break}case"int64":case"int64le":{e.set(s,n.binaryfile.dataview.getBigInt64(n.binaryfile.cursor,o)),n.binaryfile.cursor+=8;break}case"uint8":case"uint8le":{e.set(s,n.binaryfile.dataview.getUint8(n.binaryfile.cursor)),n.binaryfile.cursor+=1;break}case"uint16":case"uint16le":{e.set(s,n.binaryfile.dataview.getUint16(n.binaryfile.cursor,o)),n.binaryfile.cursor+=2;break}case"uint32":case"uint32le":{e.set(s,n.binaryfile.dataview.getUint32(n.binaryfile.cursor,o)),n.binaryfile.cursor+=4;break}case"uint64":case"uint64le":{e.set(s,n.binaryfile.dataview.getBigUint64(n.binaryfile.cursor,o)),n.binaryfile.cursor+=8;break}case"text":{const[,a,c]=Z(rt(e,t),0,[Y.STRING,Y.NUMBER,Y.STRING]);if(Kt(a)&&xt(c)){const l=new Uint8Array(n.binaryfile.bytes.buffer,n.binaryfile.cursor,a),f=new TextDecoder("utf-8").decode(l);e.set(c,f),n.binaryfile.cursor+=a}break}}return 0},rL=fi({get(e,t){var i,s;const n=wt(e.id());if(!T(n))return[!1,void 0];switch(t.toLowerCase()){case"filename":if(T((i=n.binaryfile)==null?void 0:i.filename))return[!0,n.binaryfile.filename];break;case"cursor":if(T((s=n.binaryfile)==null?void 0:s.cursor))return[!0,n.binaryfile.cursor];break}const r=mh(n.book,n.player,t);return[T(r),r]},set(e,t,n){const r=wt(e.id());return T(r)?(gh(r.book,r.player,t,n),[!0,n]):[!1,void 0]},shouldtick(){},tick(){},tock(){}}).command("stat",()=>0).command("text",(e,t)=>{const n=t.map(_e).join(" ");return de("$2",n),0}).command("hyperlink",(e,t)=>{const[n,...r]=t,i=_e(n),s=r.map(_e).join(" ");return de("$2",`!${s};${i}`),0}).command("bin",nL).command("send",(e,t)=>{const[n,r]=Z(rt(e,t),0,[Y.STRING,Y.ANY]);return de("$2",`${n} ${r??""}`),0});var Hr=(e=>(e[e.ANY=0]="ANY",e[e.SKIP=1]="SKIP",e[e.STRING=2]="STRING",e[e.NUMBER=3]="NUMBER",e[e.ARRAY=4]="ARRAY",e[e.OBJECT=5]="OBJECT",e[e.READ_ONLY=6]="READ_ONLY",e))(Hr||{});const ns={type:0},uo={type:1},Vr={type:2},ue={type:3},ho={type:6},gc={type:5,element:ns,props:{kind:ho,name:ho,code:uo,sender:uo,data:uo,id:ho,cycle:ue,x:ue,y:ue,lx:ue,ly:ue,char:ue,color:ue,bg:ue,pushable:ue,collision:ue,destructible:ue,p1:ns,p2:ns,p3:ns,stepx:ns,stepy:ns}},iL={type:5,props:{id:uo,terrain:{type:4,element:gc,fixed:of},objects:{type:5,element:gc},isdark:ue,over:Vr,under:Vr,exitnorth:Vr,exitsouth:Vr,exitwest:Vr,exiteast:Vr,timelimit:ue,restartonzap:ue,maxplayershots:ue}},F_={type:5,props:{width:ho,height:ho,size:uo,bits:{type:4,element:ue,fixed:-1}}},sL={type:5,props:{tempo:ue,synths:{type:4,element:{type:5,props:{synth:ue,effects:{type:4,element:{type:5,props:{fx:ue,settings:{type:5,numkey:!0,element:Vr}}}},settings:{type:5,numkey:!0,element:Vr}}},fixed:8},measures:{type:4,element:{type:4,element:ue,fixed:8}}}},oL="$dkpurple";function er(e){de("mods",`${oL}$blue${e}`)}const j_=new Map;function kh(e){let t=j_.get(e);return T(t)||(t={type:at.ERROR,target:"",value:void 0,schema:void 0},j_.set(e,t)),t}function z_(e,t){switch(e.target=t.id,ao(t)){case at.ERROR:case at.LOADER:break;case at.BOARD:e.type=at.BOARD,e.value=t.board,e.schema=iL;break;case at.OBJECT:e.type=at.OBJECT,e.value=t.object,e.schema=gc;break;case at.TERRAIN:e.type=at.TERRAIN,e.value=t.terrain,e.schema=gc;break;case at.CHARSET:e.type=at.CHARSET,e.value=t.charset,e.schema=F_;break;case at.PALETTE:e.type=at.PALETTE,e.value=t.palette,e.schema=F_;break;case at.EIGHT_TRACK:e.type=at.EIGHT_TRACK,e.value=t.eighttrack,e.schema=sL;break}const n=Zi(t);er(`modifying [${n}] ${fn(t)} ${e.target}`)}function Yr(e,t,n,r){let i=fc(t.book,n,r);if(T(i))return i;const s=S_(n);return i=k_(s==="object"?`@${r}
`:`@${s} ${r}
`,{}),T(i)&&(T_(t.book,i),z_(e,i),ds("mods")),i}const aL=fi({get(){return[!1,void 0]},set(){return[!1,void 0]},shouldtick(){},tick(){},tock(){}}).command("mod",(e,t)=>{const n=wt(e.id()),r=kh(e.id()),[i,s]=Z(rt(e,t),0,[Y.MAYBE_STRING,Y.MAYBE_STRING]);if(!T(i)){if(r.target==="")er("not currently modifying anything");else{const l=ki(n.book,r.target),u=Zi(l);er(`modifying [${u}] ${fn(l)} ${r.target}`)}return 0}const o=s??"",a=i.toLowerCase();if(a==="book")return go("main",o),r.type=at.ERROR,r.target="",r.value=void 0,0;const c=s??Kh();switch(a){default:{const l=ki(n.book,i);if(T(l))z_(r,l);else{const u=i||Kh();Yr(r,n,at.OBJECT,u)}break}case Yt.LOADER:Yr(r,n,at.LOADER,c);break;case Yt.BOARD:Yr(r,n,at.BOARD,c);break;case Yt.OBJECT:Yr(r,n,at.OBJECT,c);break;case Yt.TERRAIN:Yr(r,n,at.TERRAIN,c);break;case Yt.CHARSET:Yr(r,n,at.CHARSET,c);break;case Yt.PALETTE:Yr(r,n,at.PALETTE,c);break;case Yt.EIGHT_TRACK:Yr(r,n,at.EIGHT_TRACK,c);break}return 0}).command("read",(e,t)=>{var s,o,a,c;const n=kh(e.id());if(!T(n.value))return er("use #mod before #read"),0;const[r,i]=Z(rt(e,t),0,[Y.MAYBE_STRING,Y.MAYBE_STRING]);if(!T(r)){if(((s=n.schema)==null?void 0:s.type)===Hr.OBJECT&&T(n.schema.props)){const l=[],u=[],f=Object.keys(n.schema.props);for(let d=0;d<f.length;++d){const h=f[d];switch((o=n.schema.props)==null?void 0:o[h].type){case Hr.SKIP:break;case Hr.READ_ONLY:u.push(h);break;default:l.push(h);break}}er(`write stats [${l.join(", ")}]`),er(`read only stats [${u.join(", ")}]`)}return 0}if(!T(i)){if(((a=n.schema)==null?void 0:a.type)===Hr.OBJECT){const l=Object.keys(((c=n.schema)==null?void 0:c.props)??{}),u=r.toLowerCase();if(l.includes(u)){const f=n.value[u];(xt(f)||Kt(f)||rw(f))&&er(`stat ${u} is ${f}`),ne(f)&&er(`stat ${u} is an array`),f===void 0&&er(`stat ${u} is not set`)}}return 0}return 0}).command("write",(e,t)=>{var s,o;const n=kh(e.id());if(!T(n.value))return er("use #mod before #write"),0;const[r,i]=Z(rt(e,t),0,[Y.STRING,Y.ANY]);if(((s=n.schema)==null?void 0:s.type)===Hr.OBJECT){const a=(o=n.schema.props)==null?void 0:o[r];if(T(a))switch(a.type){case Hr.NUMBER:n.value[r]=parseFloat(i);break;case Hr.STRING:n.value[r]=`${i}`;break}}return 0});var yc=(e=>(e[e.ERROR=0]="ERROR",e[e.CLI=1]="CLI",e[e.LOADER=2]="LOADER",e[e.CODE_PAGE=3]="CODE_PAGE",e))(yc||{});const cL={all:zO,audio:GO,cli:BN,element:zN,gadget:eL,loader:rL,mods:aL},lL={0:[],1:["all","audio","mods","element","cli"],2:["all","audio","mods","element","loader"],3:["all","audio","mods","element","gadget"]};function uL(e,t){(lL[t]??[]).forEach(r=>e.install(cL[r]))}function _c(e){throw new Error('Could not dynamically require "'+e+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var G_={exports:{}};/*!

  JSZip v3.10.1 - A JavaScript class for generating and reading zip files
  <http://stuartk.com/jszip>

  (c) 2009-2016 Stuart Knightley <stuart [at] stuartk.com>
  Dual licenced under the MIT license or GPLv3. See https://raw.github.com/Stuk/jszip/main/LICENSE.markdown.

  JSZip uses the library pako released under the MIT license :
  https://github.com/nodeca/pako/blob/main/LICENSE
  */(function(e,t){(function(n){e.exports=n()})(function(){return function n(r,i,s){function o(l,u){if(!i[l]){if(!r[l]){var f=typeof _c=="function"&&_c;if(!u&&f)return f(l,!0);if(a)return a(l,!0);var d=new Error("Cannot find module '"+l+"'");throw d.code="MODULE_NOT_FOUND",d}var h=i[l]={exports:{}};r[l][0].call(h.exports,function(p){var m=r[l][1][p];return o(m||p)},h,h.exports,n,r,i,s)}return i[l].exports}for(var a=typeof _c=="function"&&_c,c=0;c<s.length;c++)o(s[c]);return o}({1:[function(n,r,i){var s=n("./utils"),o=n("./support"),a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";i.encode=function(c){for(var l,u,f,d,h,p,m,v=[],b=0,y=c.length,A=y,I=s.getTypeOf(c)!=="string";b<c.length;)A=y-b,f=I?(l=c[b++],u=b<y?c[b++]:0,b<y?c[b++]:0):(l=c.charCodeAt(b++),u=b<y?c.charCodeAt(b++):0,b<y?c.charCodeAt(b++):0),d=l>>2,h=(3&l)<<4|u>>4,p=1<A?(15&u)<<2|f>>6:64,m=2<A?63&f:64,v.push(a.charAt(d)+a.charAt(h)+a.charAt(p)+a.charAt(m));return v.join("")},i.decode=function(c){var l,u,f,d,h,p,m=0,v=0,b="data:";if(c.substr(0,b.length)===b)throw new Error("Invalid base64 input, it looks like a data url.");var y,A=3*(c=c.replace(/[^A-Za-z0-9+/=]/g,"")).length/4;if(c.charAt(c.length-1)===a.charAt(64)&&A--,c.charAt(c.length-2)===a.charAt(64)&&A--,A%1!=0)throw new Error("Invalid base64 input, bad content length.");for(y=o.uint8array?new Uint8Array(0|A):new Array(0|A);m<c.length;)l=a.indexOf(c.charAt(m++))<<2|(d=a.indexOf(c.charAt(m++)))>>4,u=(15&d)<<4|(h=a.indexOf(c.charAt(m++)))>>2,f=(3&h)<<6|(p=a.indexOf(c.charAt(m++))),y[v++]=l,h!==64&&(y[v++]=u),p!==64&&(y[v++]=f);return y}},{"./support":30,"./utils":32}],2:[function(n,r,i){var s=n("./external"),o=n("./stream/DataWorker"),a=n("./stream/Crc32Probe"),c=n("./stream/DataLengthProbe");function l(u,f,d,h,p){this.compressedSize=u,this.uncompressedSize=f,this.crc32=d,this.compression=h,this.compressedContent=p}l.prototype={getContentWorker:function(){var u=new o(s.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new c("data_length")),f=this;return u.on("end",function(){if(this.streamInfo.data_length!==f.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")}),u},getCompressedWorker:function(){return new o(s.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},l.createWorkerFrom=function(u,f,d){return u.pipe(new a).pipe(new c("uncompressedSize")).pipe(f.compressWorker(d)).pipe(new c("compressedSize")).withStreamInfo("compression",f)},r.exports=l},{"./external":6,"./stream/Crc32Probe":25,"./stream/DataLengthProbe":26,"./stream/DataWorker":27}],3:[function(n,r,i){var s=n("./stream/GenericWorker");i.STORE={magic:"\0\0",compressWorker:function(){return new s("STORE compression")},uncompressWorker:function(){return new s("STORE decompression")}},i.DEFLATE=n("./flate")},{"./flate":7,"./stream/GenericWorker":28}],4:[function(n,r,i){var s=n("./utils"),o=function(){for(var a,c=[],l=0;l<256;l++){a=l;for(var u=0;u<8;u++)a=1&a?3988292384^a>>>1:a>>>1;c[l]=a}return c}();r.exports=function(a,c){return a!==void 0&&a.length?s.getTypeOf(a)!=="string"?function(l,u,f,d){var h=o,p=d+f;l^=-1;for(var m=d;m<p;m++)l=l>>>8^h[255&(l^u[m])];return-1^l}(0|c,a,a.length,0):function(l,u,f,d){var h=o,p=d+f;l^=-1;for(var m=d;m<p;m++)l=l>>>8^h[255&(l^u.charCodeAt(m))];return-1^l}(0|c,a,a.length,0):0}},{"./utils":32}],5:[function(n,r,i){i.base64=!1,i.binary=!1,i.dir=!1,i.createFolders=!0,i.date=null,i.compression=null,i.compressionOptions=null,i.comment=null,i.unixPermissions=null,i.dosPermissions=null},{}],6:[function(n,r,i){var s=null;s=typeof Promise<"u"?Promise:n("lie"),r.exports={Promise:s}},{lie:37}],7:[function(n,r,i){var s=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Uint32Array<"u",o=n("pako"),a=n("./utils"),c=n("./stream/GenericWorker"),l=s?"uint8array":"array";function u(f,d){c.call(this,"FlateWorker/"+f),this._pako=null,this._pakoAction=f,this._pakoOptions=d,this.meta={}}i.magic="\b\0",a.inherits(u,c),u.prototype.processChunk=function(f){this.meta=f.meta,this._pako===null&&this._createPako(),this._pako.push(a.transformTo(l,f.data),!1)},u.prototype.flush=function(){c.prototype.flush.call(this),this._pako===null&&this._createPako(),this._pako.push([],!0)},u.prototype.cleanUp=function(){c.prototype.cleanUp.call(this),this._pako=null},u.prototype._createPako=function(){this._pako=new o[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var f=this;this._pako.onData=function(d){f.push({data:d,meta:f.meta})}},i.compressWorker=function(f){return new u("Deflate",f)},i.uncompressWorker=function(){return new u("Inflate",{})}},{"./stream/GenericWorker":28,"./utils":32,pako:38}],8:[function(n,r,i){function s(h,p){var m,v="";for(m=0;m<p;m++)v+=String.fromCharCode(255&h),h>>>=8;return v}function o(h,p,m,v,b,y){var A,I,k=h.file,E=h.compression,w=y!==l.utf8encode,S=a.transformTo("string",y(k.name)),O=a.transformTo("string",l.utf8encode(k.name)),B=k.comment,V=a.transformTo("string",y(B)),C=a.transformTo("string",l.utf8encode(B)),D=O.length!==k.name.length,_=C.length!==B.length,P="",Q="",F="",st=k.dir,z=k.date,ot={crc32:0,compressedSize:0,uncompressedSize:0};p&&!m||(ot.crc32=h.crc32,ot.compressedSize=h.compressedSize,ot.uncompressedSize=h.uncompressedSize);var M=0;p&&(M|=8),w||!D&&!_||(M|=2048);var L=0,tt=0;st&&(L|=16),b==="UNIX"?(tt=798,L|=function(W,ht){var vt=W;return W||(vt=ht?16893:33204),(65535&vt)<<16}(k.unixPermissions,st)):(tt=20,L|=function(W){return 63&(W||0)}(k.dosPermissions)),A=z.getUTCHours(),A<<=6,A|=z.getUTCMinutes(),A<<=5,A|=z.getUTCSeconds()/2,I=z.getUTCFullYear()-1980,I<<=4,I|=z.getUTCMonth()+1,I<<=5,I|=z.getUTCDate(),D&&(Q=s(1,1)+s(u(S),4)+O,P+="up"+s(Q.length,2)+Q),_&&(F=s(1,1)+s(u(V),4)+C,P+="uc"+s(F.length,2)+F);var H="";return H+=`
\0`,H+=s(M,2),H+=E.magic,H+=s(A,2),H+=s(I,2),H+=s(ot.crc32,4),H+=s(ot.compressedSize,4),H+=s(ot.uncompressedSize,4),H+=s(S.length,2),H+=s(P.length,2),{fileRecord:f.LOCAL_FILE_HEADER+H+S+P,dirRecord:f.CENTRAL_FILE_HEADER+s(tt,2)+H+s(V.length,2)+"\0\0\0\0"+s(L,4)+s(v,4)+S+P+V}}var a=n("../utils"),c=n("../stream/GenericWorker"),l=n("../utf8"),u=n("../crc32"),f=n("../signature");function d(h,p,m,v){c.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=p,this.zipPlatform=m,this.encodeFileName=v,this.streamFiles=h,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}a.inherits(d,c),d.prototype.push=function(h){var p=h.meta.percent||0,m=this.entriesCount,v=this._sources.length;this.accumulate?this.contentBuffer.push(h):(this.bytesWritten+=h.data.length,c.prototype.push.call(this,{data:h.data,meta:{currentFile:this.currentFile,percent:m?(p+100*(m-v-1))/m:100}}))},d.prototype.openedSource=function(h){this.currentSourceOffset=this.bytesWritten,this.currentFile=h.file.name;var p=this.streamFiles&&!h.file.dir;if(p){var m=o(h,p,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:m.fileRecord,meta:{percent:0}})}else this.accumulate=!0},d.prototype.closedSource=function(h){this.accumulate=!1;var p=this.streamFiles&&!h.file.dir,m=o(h,p,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(m.dirRecord),p)this.push({data:function(v){return f.DATA_DESCRIPTOR+s(v.crc32,4)+s(v.compressedSize,4)+s(v.uncompressedSize,4)}(h),meta:{percent:100}});else for(this.push({data:m.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},d.prototype.flush=function(){for(var h=this.bytesWritten,p=0;p<this.dirRecords.length;p++)this.push({data:this.dirRecords[p],meta:{percent:100}});var m=this.bytesWritten-h,v=function(b,y,A,I,k){var E=a.transformTo("string",k(I));return f.CENTRAL_DIRECTORY_END+"\0\0\0\0"+s(b,2)+s(b,2)+s(y,4)+s(A,4)+s(E.length,2)+E}(this.dirRecords.length,m,h,this.zipComment,this.encodeFileName);this.push({data:v,meta:{percent:100}})},d.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},d.prototype.registerPrevious=function(h){this._sources.push(h);var p=this;return h.on("data",function(m){p.processChunk(m)}),h.on("end",function(){p.closedSource(p.previous.streamInfo),p._sources.length?p.prepareNextSource():p.end()}),h.on("error",function(m){p.error(m)}),this},d.prototype.resume=function(){return!!c.prototype.resume.call(this)&&(!this.previous&&this._sources.length?(this.prepareNextSource(),!0):this.previous||this._sources.length||this.generatedError?void 0:(this.end(),!0))},d.prototype.error=function(h){var p=this._sources;if(!c.prototype.error.call(this,h))return!1;for(var m=0;m<p.length;m++)try{p[m].error(h)}catch{}return!0},d.prototype.lock=function(){c.prototype.lock.call(this);for(var h=this._sources,p=0;p<h.length;p++)h[p].lock()},r.exports=d},{"../crc32":4,"../signature":23,"../stream/GenericWorker":28,"../utf8":31,"../utils":32}],9:[function(n,r,i){var s=n("../compressions"),o=n("./ZipFileWorker");i.generateWorker=function(a,c,l){var u=new o(c.streamFiles,l,c.platform,c.encodeFileName),f=0;try{a.forEach(function(d,h){f++;var p=function(y,A){var I=y||A,k=s[I];if(!k)throw new Error(I+" is not a valid compression method !");return k}(h.options.compression,c.compression),m=h.options.compressionOptions||c.compressionOptions||{},v=h.dir,b=h.date;h._compressWorker(p,m).withStreamInfo("file",{name:d,dir:v,date:b,comment:h.comment||"",unixPermissions:h.unixPermissions,dosPermissions:h.dosPermissions}).pipe(u)}),u.entriesCount=f}catch(d){u.error(d)}return u}},{"../compressions":3,"./ZipFileWorker":8}],10:[function(n,r,i){function s(){if(!(this instanceof s))return new s;if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files=Object.create(null),this.comment=null,this.root="",this.clone=function(){var o=new s;for(var a in this)typeof this[a]!="function"&&(o[a]=this[a]);return o}}(s.prototype=n("./object")).loadAsync=n("./load"),s.support=n("./support"),s.defaults=n("./defaults"),s.version="3.10.1",s.loadAsync=function(o,a){return new s().loadAsync(o,a)},s.external=n("./external"),r.exports=s},{"./defaults":5,"./external":6,"./load":11,"./object":15,"./support":30}],11:[function(n,r,i){var s=n("./utils"),o=n("./external"),a=n("./utf8"),c=n("./zipEntries"),l=n("./stream/Crc32Probe"),u=n("./nodejsUtils");function f(d){return new o.Promise(function(h,p){var m=d.decompressed.getContentWorker().pipe(new l);m.on("error",function(v){p(v)}).on("end",function(){m.streamInfo.crc32!==d.decompressed.crc32?p(new Error("Corrupted zip : CRC32 mismatch")):h()}).resume()})}r.exports=function(d,h){var p=this;return h=s.extend(h||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:a.utf8decode}),u.isNode&&u.isStream(d)?o.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):s.prepareContent("the loaded zip file",d,!0,h.optimizedBinaryString,h.base64).then(function(m){var v=new c(h);return v.load(m),v}).then(function(m){var v=[o.Promise.resolve(m)],b=m.files;if(h.checkCRC32)for(var y=0;y<b.length;y++)v.push(f(b[y]));return o.Promise.all(v)}).then(function(m){for(var v=m.shift(),b=v.files,y=0;y<b.length;y++){var A=b[y],I=A.fileNameStr,k=s.resolve(A.fileNameStr);p.file(k,A.decompressed,{binary:!0,optimizedBinaryString:!0,date:A.date,dir:A.dir,comment:A.fileCommentStr.length?A.fileCommentStr:null,unixPermissions:A.unixPermissions,dosPermissions:A.dosPermissions,createFolders:h.createFolders}),A.dir||(p.file(k).unsafeOriginalName=I)}return v.zipComment.length&&(p.comment=v.zipComment),p})}},{"./external":6,"./nodejsUtils":14,"./stream/Crc32Probe":25,"./utf8":31,"./utils":32,"./zipEntries":33}],12:[function(n,r,i){var s=n("../utils"),o=n("../stream/GenericWorker");function a(c,l){o.call(this,"Nodejs stream input adapter for "+c),this._upstreamEnded=!1,this._bindStream(l)}s.inherits(a,o),a.prototype._bindStream=function(c){var l=this;(this._stream=c).pause(),c.on("data",function(u){l.push({data:u,meta:{percent:0}})}).on("error",function(u){l.isPaused?this.generatedError=u:l.error(u)}).on("end",function(){l.isPaused?l._upstreamEnded=!0:l.end()})},a.prototype.pause=function(){return!!o.prototype.pause.call(this)&&(this._stream.pause(),!0)},a.prototype.resume=function(){return!!o.prototype.resume.call(this)&&(this._upstreamEnded?this.end():this._stream.resume(),!0)},r.exports=a},{"../stream/GenericWorker":28,"../utils":32}],13:[function(n,r,i){var s=n("readable-stream").Readable;function o(a,c,l){s.call(this,c),this._helper=a;var u=this;a.on("data",function(f,d){u.push(f)||u._helper.pause(),l&&l(d)}).on("error",function(f){u.emit("error",f)}).on("end",function(){u.push(null)})}n("../utils").inherits(o,s),o.prototype._read=function(){this._helper.resume()},r.exports=o},{"../utils":32,"readable-stream":16}],14:[function(n,r,i){r.exports={isNode:typeof Buffer<"u",newBufferFrom:function(s,o){if(Buffer.from&&Buffer.from!==Uint8Array.from)return Buffer.from(s,o);if(typeof s=="number")throw new Error('The "data" argument must not be a number');return new Buffer(s,o)},allocBuffer:function(s){if(Buffer.alloc)return Buffer.alloc(s);var o=new Buffer(s);return o.fill(0),o},isBuffer:function(s){return Buffer.isBuffer(s)},isStream:function(s){return s&&typeof s.on=="function"&&typeof s.pause=="function"&&typeof s.resume=="function"}}},{}],15:[function(n,r,i){function s(k,E,w){var S,O=a.getTypeOf(E),B=a.extend(w||{},u);B.date=B.date||new Date,B.compression!==null&&(B.compression=B.compression.toUpperCase()),typeof B.unixPermissions=="string"&&(B.unixPermissions=parseInt(B.unixPermissions,8)),B.unixPermissions&&16384&B.unixPermissions&&(B.dir=!0),B.dosPermissions&&16&B.dosPermissions&&(B.dir=!0),B.dir&&(k=b(k)),B.createFolders&&(S=v(k))&&y.call(this,S,!0);var V=O==="string"&&B.binary===!1&&B.base64===!1;w&&w.binary!==void 0||(B.binary=!V),(E instanceof f&&E.uncompressedSize===0||B.dir||!E||E.length===0)&&(B.base64=!1,B.binary=!0,E="",B.compression="STORE",O="string");var C=null;C=E instanceof f||E instanceof c?E:p.isNode&&p.isStream(E)?new m(k,E):a.prepareContent(k,E,B.binary,B.optimizedBinaryString,B.base64);var D=new d(k,C,B);this.files[k]=D}var o=n("./utf8"),a=n("./utils"),c=n("./stream/GenericWorker"),l=n("./stream/StreamHelper"),u=n("./defaults"),f=n("./compressedObject"),d=n("./zipObject"),h=n("./generate"),p=n("./nodejsUtils"),m=n("./nodejs/NodejsStreamInputAdapter"),v=function(k){k.slice(-1)==="/"&&(k=k.substring(0,k.length-1));var E=k.lastIndexOf("/");return 0<E?k.substring(0,E):""},b=function(k){return k.slice(-1)!=="/"&&(k+="/"),k},y=function(k,E){return E=E!==void 0?E:u.createFolders,k=b(k),this.files[k]||s.call(this,k,null,{dir:!0,createFolders:E}),this.files[k]};function A(k){return Object.prototype.toString.call(k)==="[object RegExp]"}var I={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(k){var E,w,S;for(E in this.files)S=this.files[E],(w=E.slice(this.root.length,E.length))&&E.slice(0,this.root.length)===this.root&&k(w,S)},filter:function(k){var E=[];return this.forEach(function(w,S){k(w,S)&&E.push(S)}),E},file:function(k,E,w){if(arguments.length!==1)return k=this.root+k,s.call(this,k,E,w),this;if(A(k)){var S=k;return this.filter(function(B,V){return!V.dir&&S.test(B)})}var O=this.files[this.root+k];return O&&!O.dir?O:null},folder:function(k){if(!k)return this;if(A(k))return this.filter(function(O,B){return B.dir&&k.test(O)});var E=this.root+k,w=y.call(this,E),S=this.clone();return S.root=w.name,S},remove:function(k){k=this.root+k;var E=this.files[k];if(E||(k.slice(-1)!=="/"&&(k+="/"),E=this.files[k]),E&&!E.dir)delete this.files[k];else for(var w=this.filter(function(O,B){return B.name.slice(0,k.length)===k}),S=0;S<w.length;S++)delete this.files[w[S].name];return this},generate:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(k){var E,w={};try{if((w=a.extend(k||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:o.utf8encode})).type=w.type.toLowerCase(),w.compression=w.compression.toUpperCase(),w.type==="binarystring"&&(w.type="string"),!w.type)throw new Error("No output type specified.");a.checkSupport(w.type),w.platform!=="darwin"&&w.platform!=="freebsd"&&w.platform!=="linux"&&w.platform!=="sunos"||(w.platform="UNIX"),w.platform==="win32"&&(w.platform="DOS");var S=w.comment||this.comment||"";E=h.generateWorker(this,w,S)}catch(O){(E=new c("error")).error(O)}return new l(E,w.type||"string",w.mimeType)},generateAsync:function(k,E){return this.generateInternalStream(k).accumulate(E)},generateNodeStream:function(k,E){return(k=k||{}).type||(k.type="nodebuffer"),this.generateInternalStream(k).toNodejsStream(E)}};r.exports=I},{"./compressedObject":2,"./defaults":5,"./generate":9,"./nodejs/NodejsStreamInputAdapter":12,"./nodejsUtils":14,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31,"./utils":32,"./zipObject":35}],16:[function(n,r,i){r.exports=n("stream")},{stream:void 0}],17:[function(n,r,i){var s=n("./DataReader");function o(a){s.call(this,a);for(var c=0;c<this.data.length;c++)a[c]=255&a[c]}n("../utils").inherits(o,s),o.prototype.byteAt=function(a){return this.data[this.zero+a]},o.prototype.lastIndexOfSignature=function(a){for(var c=a.charCodeAt(0),l=a.charCodeAt(1),u=a.charCodeAt(2),f=a.charCodeAt(3),d=this.length-4;0<=d;--d)if(this.data[d]===c&&this.data[d+1]===l&&this.data[d+2]===u&&this.data[d+3]===f)return d-this.zero;return-1},o.prototype.readAndCheckSignature=function(a){var c=a.charCodeAt(0),l=a.charCodeAt(1),u=a.charCodeAt(2),f=a.charCodeAt(3),d=this.readData(4);return c===d[0]&&l===d[1]&&u===d[2]&&f===d[3]},o.prototype.readData=function(a){if(this.checkOffset(a),a===0)return[];var c=this.data.slice(this.zero+this.index,this.zero+this.index+a);return this.index+=a,c},r.exports=o},{"../utils":32,"./DataReader":18}],18:[function(n,r,i){var s=n("../utils");function o(a){this.data=a,this.length=a.length,this.index=0,this.zero=0}o.prototype={checkOffset:function(a){this.checkIndex(this.index+a)},checkIndex:function(a){if(this.length<this.zero+a||a<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+a+"). Corrupted zip ?")},setIndex:function(a){this.checkIndex(a),this.index=a},skip:function(a){this.setIndex(this.index+a)},byteAt:function(){},readInt:function(a){var c,l=0;for(this.checkOffset(a),c=this.index+a-1;c>=this.index;c--)l=(l<<8)+this.byteAt(c);return this.index+=a,l},readString:function(a){return s.transformTo("string",this.readData(a))},readData:function(){},lastIndexOfSignature:function(){},readAndCheckSignature:function(){},readDate:function(){var a=this.readInt(4);return new Date(Date.UTC(1980+(a>>25&127),(a>>21&15)-1,a>>16&31,a>>11&31,a>>5&63,(31&a)<<1))}},r.exports=o},{"../utils":32}],19:[function(n,r,i){var s=n("./Uint8ArrayReader");function o(a){s.call(this,a)}n("../utils").inherits(o,s),o.prototype.readData=function(a){this.checkOffset(a);var c=this.data.slice(this.zero+this.index,this.zero+this.index+a);return this.index+=a,c},r.exports=o},{"../utils":32,"./Uint8ArrayReader":21}],20:[function(n,r,i){var s=n("./DataReader");function o(a){s.call(this,a)}n("../utils").inherits(o,s),o.prototype.byteAt=function(a){return this.data.charCodeAt(this.zero+a)},o.prototype.lastIndexOfSignature=function(a){return this.data.lastIndexOf(a)-this.zero},o.prototype.readAndCheckSignature=function(a){return a===this.readData(4)},o.prototype.readData=function(a){this.checkOffset(a);var c=this.data.slice(this.zero+this.index,this.zero+this.index+a);return this.index+=a,c},r.exports=o},{"../utils":32,"./DataReader":18}],21:[function(n,r,i){var s=n("./ArrayReader");function o(a){s.call(this,a)}n("../utils").inherits(o,s),o.prototype.readData=function(a){if(this.checkOffset(a),a===0)return new Uint8Array(0);var c=this.data.subarray(this.zero+this.index,this.zero+this.index+a);return this.index+=a,c},r.exports=o},{"../utils":32,"./ArrayReader":17}],22:[function(n,r,i){var s=n("../utils"),o=n("../support"),a=n("./ArrayReader"),c=n("./StringReader"),l=n("./NodeBufferReader"),u=n("./Uint8ArrayReader");r.exports=function(f){var d=s.getTypeOf(f);return s.checkSupport(d),d!=="string"||o.uint8array?d==="nodebuffer"?new l(f):o.uint8array?new u(s.transformTo("uint8array",f)):new a(s.transformTo("array",f)):new c(f)}},{"../support":30,"../utils":32,"./ArrayReader":17,"./NodeBufferReader":19,"./StringReader":20,"./Uint8ArrayReader":21}],23:[function(n,r,i){i.LOCAL_FILE_HEADER="PK",i.CENTRAL_FILE_HEADER="PK",i.CENTRAL_DIRECTORY_END="PK",i.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK\x07",i.ZIP64_CENTRAL_DIRECTORY_END="PK",i.DATA_DESCRIPTOR="PK\x07\b"},{}],24:[function(n,r,i){var s=n("./GenericWorker"),o=n("../utils");function a(c){s.call(this,"ConvertWorker to "+c),this.destType=c}o.inherits(a,s),a.prototype.processChunk=function(c){this.push({data:o.transformTo(this.destType,c.data),meta:c.meta})},r.exports=a},{"../utils":32,"./GenericWorker":28}],25:[function(n,r,i){var s=n("./GenericWorker"),o=n("../crc32");function a(){s.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}n("../utils").inherits(a,s),a.prototype.processChunk=function(c){this.streamInfo.crc32=o(c.data,this.streamInfo.crc32||0),this.push(c)},r.exports=a},{"../crc32":4,"../utils":32,"./GenericWorker":28}],26:[function(n,r,i){var s=n("../utils"),o=n("./GenericWorker");function a(c){o.call(this,"DataLengthProbe for "+c),this.propName=c,this.withStreamInfo(c,0)}s.inherits(a,o),a.prototype.processChunk=function(c){if(c){var l=this.streamInfo[this.propName]||0;this.streamInfo[this.propName]=l+c.data.length}o.prototype.processChunk.call(this,c)},r.exports=a},{"../utils":32,"./GenericWorker":28}],27:[function(n,r,i){var s=n("../utils"),o=n("./GenericWorker");function a(c){o.call(this,"DataWorker");var l=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,c.then(function(u){l.dataIsReady=!0,l.data=u,l.max=u&&u.length||0,l.type=s.getTypeOf(u),l.isPaused||l._tickAndRepeat()},function(u){l.error(u)})}s.inherits(a,o),a.prototype.cleanUp=function(){o.prototype.cleanUp.call(this),this.data=null},a.prototype.resume=function(){return!!o.prototype.resume.call(this)&&(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,s.delay(this._tickAndRepeat,[],this)),!0)},a.prototype._tickAndRepeat=function(){this._tickScheduled=!1,this.isPaused||this.isFinished||(this._tick(),this.isFinished||(s.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},a.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var c=null,l=Math.min(this.max,this.index+16384);if(this.index>=this.max)return this.end();switch(this.type){case"string":c=this.data.substring(this.index,l);break;case"uint8array":c=this.data.subarray(this.index,l);break;case"array":case"nodebuffer":c=this.data.slice(this.index,l)}return this.index=l,this.push({data:c,meta:{percent:this.max?this.index/this.max*100:0}})},r.exports=a},{"../utils":32,"./GenericWorker":28}],28:[function(n,r,i){function s(o){this.name=o||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}s.prototype={push:function(o){this.emit("data",o)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(o){this.emit("error",o)}return!0},error:function(o){return!this.isFinished&&(this.isPaused?this.generatedError=o:(this.isFinished=!0,this.emit("error",o),this.previous&&this.previous.error(o),this.cleanUp()),!0)},on:function(o,a){return this._listeners[o].push(a),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(o,a){if(this._listeners[o])for(var c=0;c<this._listeners[o].length;c++)this._listeners[o][c].call(this,a)},pipe:function(o){return o.registerPrevious(this)},registerPrevious:function(o){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=o.streamInfo,this.mergeStreamInfo(),this.previous=o;var a=this;return o.on("data",function(c){a.processChunk(c)}),o.on("end",function(){a.end()}),o.on("error",function(c){a.error(c)}),this},pause:function(){return!this.isPaused&&!this.isFinished&&(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;var o=this.isPaused=!1;return this.generatedError&&(this.error(this.generatedError),o=!0),this.previous&&this.previous.resume(),!o},flush:function(){},processChunk:function(o){this.push(o)},withStreamInfo:function(o,a){return this.extraStreamInfo[o]=a,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var o in this.extraStreamInfo)Object.prototype.hasOwnProperty.call(this.extraStreamInfo,o)&&(this.streamInfo[o]=this.extraStreamInfo[o])},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var o="Worker "+this.name;return this.previous?this.previous+" -> "+o:o}},r.exports=s},{}],29:[function(n,r,i){var s=n("../utils"),o=n("./ConvertWorker"),a=n("./GenericWorker"),c=n("../base64"),l=n("../support"),u=n("../external"),f=null;if(l.nodestream)try{f=n("../nodejs/NodejsStreamOutputAdapter")}catch{}function d(p,m){return new u.Promise(function(v,b){var y=[],A=p._internalType,I=p._outputType,k=p._mimeType;p.on("data",function(E,w){y.push(E),m&&m(w)}).on("error",function(E){y=[],b(E)}).on("end",function(){try{var E=function(w,S,O){switch(w){case"blob":return s.newBlob(s.transformTo("arraybuffer",S),O);case"base64":return c.encode(S);default:return s.transformTo(w,S)}}(I,function(w,S){var O,B=0,V=null,C=0;for(O=0;O<S.length;O++)C+=S[O].length;switch(w){case"string":return S.join("");case"array":return Array.prototype.concat.apply([],S);case"uint8array":for(V=new Uint8Array(C),O=0;O<S.length;O++)V.set(S[O],B),B+=S[O].length;return V;case"nodebuffer":return Buffer.concat(S);default:throw new Error("concat : unsupported type '"+w+"'")}}(A,y),k);v(E)}catch(w){b(w)}y=[]}).resume()})}function h(p,m,v){var b=m;switch(m){case"blob":case"arraybuffer":b="uint8array";break;case"base64":b="string"}try{this._internalType=b,this._outputType=m,this._mimeType=v,s.checkSupport(b),this._worker=p.pipe(new o(b)),p.lock()}catch(y){this._worker=new a("error"),this._worker.error(y)}}h.prototype={accumulate:function(p){return d(this,p)},on:function(p,m){var v=this;return p==="data"?this._worker.on(p,function(b){m.call(v,b.data,b.meta)}):this._worker.on(p,function(){s.delay(m,arguments,v)}),this},resume:function(){return s.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(p){if(s.checkSupport("nodestream"),this._outputType!=="nodebuffer")throw new Error(this._outputType+" is not supported by this method");return new f(this,{objectMode:this._outputType!=="nodebuffer"},p)}},r.exports=h},{"../base64":1,"../external":6,"../nodejs/NodejsStreamOutputAdapter":13,"../support":30,"../utils":32,"./ConvertWorker":24,"./GenericWorker":28}],30:[function(n,r,i){if(i.base64=!0,i.array=!0,i.string=!0,i.arraybuffer=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u",i.nodebuffer=typeof Buffer<"u",i.uint8array=typeof Uint8Array<"u",typeof ArrayBuffer>"u")i.blob=!1;else{var s=new ArrayBuffer(0);try{i.blob=new Blob([s],{type:"application/zip"}).size===0}catch{try{var o=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);o.append(s),i.blob=o.getBlob("application/zip").size===0}catch{i.blob=!1}}}try{i.nodestream=!!n("readable-stream").Readable}catch{i.nodestream=!1}},{"readable-stream":16}],31:[function(n,r,i){for(var s=n("./utils"),o=n("./support"),a=n("./nodejsUtils"),c=n("./stream/GenericWorker"),l=new Array(256),u=0;u<256;u++)l[u]=252<=u?6:248<=u?5:240<=u?4:224<=u?3:192<=u?2:1;l[254]=l[254]=1;function f(){c.call(this,"utf-8 decode"),this.leftOver=null}function d(){c.call(this,"utf-8 encode")}i.utf8encode=function(h){return o.nodebuffer?a.newBufferFrom(h,"utf-8"):function(p){var m,v,b,y,A,I=p.length,k=0;for(y=0;y<I;y++)(64512&(v=p.charCodeAt(y)))==55296&&y+1<I&&(64512&(b=p.charCodeAt(y+1)))==56320&&(v=65536+(v-55296<<10)+(b-56320),y++),k+=v<128?1:v<2048?2:v<65536?3:4;for(m=o.uint8array?new Uint8Array(k):new Array(k),y=A=0;A<k;y++)(64512&(v=p.charCodeAt(y)))==55296&&y+1<I&&(64512&(b=p.charCodeAt(y+1)))==56320&&(v=65536+(v-55296<<10)+(b-56320),y++),v<128?m[A++]=v:(v<2048?m[A++]=192|v>>>6:(v<65536?m[A++]=224|v>>>12:(m[A++]=240|v>>>18,m[A++]=128|v>>>12&63),m[A++]=128|v>>>6&63),m[A++]=128|63&v);return m}(h)},i.utf8decode=function(h){return o.nodebuffer?s.transformTo("nodebuffer",h).toString("utf-8"):function(p){var m,v,b,y,A=p.length,I=new Array(2*A);for(m=v=0;m<A;)if((b=p[m++])<128)I[v++]=b;else if(4<(y=l[b]))I[v++]=65533,m+=y-1;else{for(b&=y===2?31:y===3?15:7;1<y&&m<A;)b=b<<6|63&p[m++],y--;1<y?I[v++]=65533:b<65536?I[v++]=b:(b-=65536,I[v++]=55296|b>>10&1023,I[v++]=56320|1023&b)}return I.length!==v&&(I.subarray?I=I.subarray(0,v):I.length=v),s.applyFromCharCode(I)}(h=s.transformTo(o.uint8array?"uint8array":"array",h))},s.inherits(f,c),f.prototype.processChunk=function(h){var p=s.transformTo(o.uint8array?"uint8array":"array",h.data);if(this.leftOver&&this.leftOver.length){if(o.uint8array){var m=p;(p=new Uint8Array(m.length+this.leftOver.length)).set(this.leftOver,0),p.set(m,this.leftOver.length)}else p=this.leftOver.concat(p);this.leftOver=null}var v=function(y,A){var I;for((A=A||y.length)>y.length&&(A=y.length),I=A-1;0<=I&&(192&y[I])==128;)I--;return I<0||I===0?A:I+l[y[I]]>A?I:A}(p),b=p;v!==p.length&&(o.uint8array?(b=p.subarray(0,v),this.leftOver=p.subarray(v,p.length)):(b=p.slice(0,v),this.leftOver=p.slice(v,p.length))),this.push({data:i.utf8decode(b),meta:h.meta})},f.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:i.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},i.Utf8DecodeWorker=f,s.inherits(d,c),d.prototype.processChunk=function(h){this.push({data:i.utf8encode(h.data),meta:h.meta})},i.Utf8EncodeWorker=d},{"./nodejsUtils":14,"./stream/GenericWorker":28,"./support":30,"./utils":32}],32:[function(n,r,i){var s=n("./support"),o=n("./base64"),a=n("./nodejsUtils"),c=n("./external");function l(m){return m}function u(m,v){for(var b=0;b<m.length;++b)v[b]=255&m.charCodeAt(b);return v}n("setimmediate"),i.newBlob=function(m,v){i.checkSupport("blob");try{return new Blob([m],{type:v})}catch{try{var b=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);return b.append(m),b.getBlob(v)}catch{throw new Error("Bug : can't construct the Blob.")}}};var f={stringifyByChunk:function(m,v,b){var y=[],A=0,I=m.length;if(I<=b)return String.fromCharCode.apply(null,m);for(;A<I;)v==="array"||v==="nodebuffer"?y.push(String.fromCharCode.apply(null,m.slice(A,Math.min(A+b,I)))):y.push(String.fromCharCode.apply(null,m.subarray(A,Math.min(A+b,I)))),A+=b;return y.join("")},stringifyByChar:function(m){for(var v="",b=0;b<m.length;b++)v+=String.fromCharCode(m[b]);return v},applyCanBeUsed:{uint8array:function(){try{return s.uint8array&&String.fromCharCode.apply(null,new Uint8Array(1)).length===1}catch{return!1}}(),nodebuffer:function(){try{return s.nodebuffer&&String.fromCharCode.apply(null,a.allocBuffer(1)).length===1}catch{return!1}}()}};function d(m){var v=65536,b=i.getTypeOf(m),y=!0;if(b==="uint8array"?y=f.applyCanBeUsed.uint8array:b==="nodebuffer"&&(y=f.applyCanBeUsed.nodebuffer),y)for(;1<v;)try{return f.stringifyByChunk(m,b,v)}catch{v=Math.floor(v/2)}return f.stringifyByChar(m)}function h(m,v){for(var b=0;b<m.length;b++)v[b]=m[b];return v}i.applyFromCharCode=d;var p={};p.string={string:l,array:function(m){return u(m,new Array(m.length))},arraybuffer:function(m){return p.string.uint8array(m).buffer},uint8array:function(m){return u(m,new Uint8Array(m.length))},nodebuffer:function(m){return u(m,a.allocBuffer(m.length))}},p.array={string:d,array:l,arraybuffer:function(m){return new Uint8Array(m).buffer},uint8array:function(m){return new Uint8Array(m)},nodebuffer:function(m){return a.newBufferFrom(m)}},p.arraybuffer={string:function(m){return d(new Uint8Array(m))},array:function(m){return h(new Uint8Array(m),new Array(m.byteLength))},arraybuffer:l,uint8array:function(m){return new Uint8Array(m)},nodebuffer:function(m){return a.newBufferFrom(new Uint8Array(m))}},p.uint8array={string:d,array:function(m){return h(m,new Array(m.length))},arraybuffer:function(m){return m.buffer},uint8array:l,nodebuffer:function(m){return a.newBufferFrom(m)}},p.nodebuffer={string:d,array:function(m){return h(m,new Array(m.length))},arraybuffer:function(m){return p.nodebuffer.uint8array(m).buffer},uint8array:function(m){return h(m,new Uint8Array(m.length))},nodebuffer:l},i.transformTo=function(m,v){if(v=v||"",!m)return v;i.checkSupport(m);var b=i.getTypeOf(v);return p[b][m](v)},i.resolve=function(m){for(var v=m.split("/"),b=[],y=0;y<v.length;y++){var A=v[y];A==="."||A===""&&y!==0&&y!==v.length-1||(A===".."?b.pop():b.push(A))}return b.join("/")},i.getTypeOf=function(m){return typeof m=="string"?"string":Object.prototype.toString.call(m)==="[object Array]"?"array":s.nodebuffer&&a.isBuffer(m)?"nodebuffer":s.uint8array&&m instanceof Uint8Array?"uint8array":s.arraybuffer&&m instanceof ArrayBuffer?"arraybuffer":void 0},i.checkSupport=function(m){if(!s[m.toLowerCase()])throw new Error(m+" is not supported by this platform")},i.MAX_VALUE_16BITS=65535,i.MAX_VALUE_32BITS=-1,i.pretty=function(m){var v,b,y="";for(b=0;b<(m||"").length;b++)y+="\\x"+((v=m.charCodeAt(b))<16?"0":"")+v.toString(16).toUpperCase();return y},i.delay=function(m,v,b){setImmediate(function(){m.apply(b||null,v||[])})},i.inherits=function(m,v){function b(){}b.prototype=v.prototype,m.prototype=new b},i.extend=function(){var m,v,b={};for(m=0;m<arguments.length;m++)for(v in arguments[m])Object.prototype.hasOwnProperty.call(arguments[m],v)&&b[v]===void 0&&(b[v]=arguments[m][v]);return b},i.prepareContent=function(m,v,b,y,A){return c.Promise.resolve(v).then(function(I){return s.blob&&(I instanceof Blob||["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(I))!==-1)&&typeof FileReader<"u"?new c.Promise(function(k,E){var w=new FileReader;w.onload=function(S){k(S.target.result)},w.onerror=function(S){E(S.target.error)},w.readAsArrayBuffer(I)}):I}).then(function(I){var k=i.getTypeOf(I);return k?(k==="arraybuffer"?I=i.transformTo("uint8array",I):k==="string"&&(A?I=o.decode(I):b&&y!==!0&&(I=function(E){return u(E,s.uint8array?new Uint8Array(E.length):new Array(E.length))}(I))),I):c.Promise.reject(new Error("Can't read the data of '"+m+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))})}},{"./base64":1,"./external":6,"./nodejsUtils":14,"./support":30,setimmediate:54}],33:[function(n,r,i){var s=n("./reader/readerFor"),o=n("./utils"),a=n("./signature"),c=n("./zipEntry"),l=n("./support");function u(f){this.files=[],this.loadOptions=f}u.prototype={checkSignature:function(f){if(!this.reader.readAndCheckSignature(f)){this.reader.index-=4;var d=this.reader.readString(4);throw new Error("Corrupted zip or bug: unexpected signature ("+o.pretty(d)+", expected "+o.pretty(f)+")")}},isSignature:function(f,d){var h=this.reader.index;this.reader.setIndex(f);var p=this.reader.readString(4)===d;return this.reader.setIndex(h),p},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var f=this.reader.readData(this.zipCommentLength),d=l.uint8array?"uint8array":"array",h=o.transformTo(d,f);this.zipComment=this.loadOptions.decodeFileName(h)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var f,d,h,p=this.zip64EndOfCentralSize-44;0<p;)f=this.reader.readInt(2),d=this.reader.readInt(4),h=this.reader.readData(d),this.zip64ExtensibleData[f]={id:f,length:d,value:h}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),1<this.disksCount)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var f,d;for(f=0;f<this.files.length;f++)d=this.files[f],this.reader.setIndex(d.localHeaderOffset),this.checkSignature(a.LOCAL_FILE_HEADER),d.readLocalPart(this.reader),d.handleUTF8(),d.processAttributes()},readCentralDir:function(){var f;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(a.CENTRAL_FILE_HEADER);)(f=new c({zip64:this.zip64},this.loadOptions)).readCentralPart(this.reader),this.files.push(f);if(this.centralDirRecords!==this.files.length&&this.centralDirRecords!==0&&this.files.length===0)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var f=this.reader.lastIndexOfSignature(a.CENTRAL_DIRECTORY_END);if(f<0)throw this.isSignature(0,a.LOCAL_FILE_HEADER)?new Error("Corrupted zip: can't find end of central directory"):new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html");this.reader.setIndex(f);var d=f;if(this.checkSignature(a.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===o.MAX_VALUE_16BITS||this.diskWithCentralDirStart===o.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===o.MAX_VALUE_16BITS||this.centralDirRecords===o.MAX_VALUE_16BITS||this.centralDirSize===o.MAX_VALUE_32BITS||this.centralDirOffset===o.MAX_VALUE_32BITS){if(this.zip64=!0,(f=this.reader.lastIndexOfSignature(a.ZIP64_CENTRAL_DIRECTORY_LOCATOR))<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(f),this.checkSignature(a.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,a.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(a.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(a.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var h=this.centralDirOffset+this.centralDirSize;this.zip64&&(h+=20,h+=12+this.zip64EndOfCentralSize);var p=d-h;if(0<p)this.isSignature(d,a.CENTRAL_FILE_HEADER)||(this.reader.zero=p);else if(p<0)throw new Error("Corrupted zip: missing "+Math.abs(p)+" bytes.")},prepareReader:function(f){this.reader=s(f)},load:function(f){this.prepareReader(f),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},r.exports=u},{"./reader/readerFor":22,"./signature":23,"./support":30,"./utils":32,"./zipEntry":34}],34:[function(n,r,i){var s=n("./reader/readerFor"),o=n("./utils"),a=n("./compressedObject"),c=n("./crc32"),l=n("./utf8"),u=n("./compressions"),f=n("./support");function d(h,p){this.options=h,this.loadOptions=p}d.prototype={isEncrypted:function(){return(1&this.bitFlag)==1},useUTF8:function(){return(2048&this.bitFlag)==2048},readLocalPart:function(h){var p,m;if(h.skip(22),this.fileNameLength=h.readInt(2),m=h.readInt(2),this.fileName=h.readData(this.fileNameLength),h.skip(m),this.compressedSize===-1||this.uncompressedSize===-1)throw new Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");if((p=function(v){for(var b in u)if(Object.prototype.hasOwnProperty.call(u,b)&&u[b].magic===v)return u[b];return null}(this.compressionMethod))===null)throw new Error("Corrupted zip : compression "+o.pretty(this.compressionMethod)+" unknown (inner file : "+o.transformTo("string",this.fileName)+")");this.decompressed=new a(this.compressedSize,this.uncompressedSize,this.crc32,p,h.readData(this.compressedSize))},readCentralPart:function(h){this.versionMadeBy=h.readInt(2),h.skip(2),this.bitFlag=h.readInt(2),this.compressionMethod=h.readString(2),this.date=h.readDate(),this.crc32=h.readInt(4),this.compressedSize=h.readInt(4),this.uncompressedSize=h.readInt(4);var p=h.readInt(2);if(this.extraFieldsLength=h.readInt(2),this.fileCommentLength=h.readInt(2),this.diskNumberStart=h.readInt(2),this.internalFileAttributes=h.readInt(2),this.externalFileAttributes=h.readInt(4),this.localHeaderOffset=h.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");h.skip(p),this.readExtraFields(h),this.parseZIP64ExtraField(h),this.fileComment=h.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var h=this.versionMadeBy>>8;this.dir=!!(16&this.externalFileAttributes),h==0&&(this.dosPermissions=63&this.externalFileAttributes),h==3&&(this.unixPermissions=this.externalFileAttributes>>16&65535),this.dir||this.fileNameStr.slice(-1)!=="/"||(this.dir=!0)},parseZIP64ExtraField:function(){if(this.extraFields[1]){var h=s(this.extraFields[1].value);this.uncompressedSize===o.MAX_VALUE_32BITS&&(this.uncompressedSize=h.readInt(8)),this.compressedSize===o.MAX_VALUE_32BITS&&(this.compressedSize=h.readInt(8)),this.localHeaderOffset===o.MAX_VALUE_32BITS&&(this.localHeaderOffset=h.readInt(8)),this.diskNumberStart===o.MAX_VALUE_32BITS&&(this.diskNumberStart=h.readInt(4))}},readExtraFields:function(h){var p,m,v,b=h.index+this.extraFieldsLength;for(this.extraFields||(this.extraFields={});h.index+4<b;)p=h.readInt(2),m=h.readInt(2),v=h.readData(m),this.extraFields[p]={id:p,length:m,value:v};h.setIndex(b)},handleUTF8:function(){var h=f.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=l.utf8decode(this.fileName),this.fileCommentStr=l.utf8decode(this.fileComment);else{var p=this.findExtraFieldUnicodePath();if(p!==null)this.fileNameStr=p;else{var m=o.transformTo(h,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(m)}var v=this.findExtraFieldUnicodeComment();if(v!==null)this.fileCommentStr=v;else{var b=o.transformTo(h,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(b)}}},findExtraFieldUnicodePath:function(){var h=this.extraFields[28789];if(h){var p=s(h.value);return p.readInt(1)!==1||c(this.fileName)!==p.readInt(4)?null:l.utf8decode(p.readData(h.length-5))}return null},findExtraFieldUnicodeComment:function(){var h=this.extraFields[25461];if(h){var p=s(h.value);return p.readInt(1)!==1||c(this.fileComment)!==p.readInt(4)?null:l.utf8decode(p.readData(h.length-5))}return null}},r.exports=d},{"./compressedObject":2,"./compressions":3,"./crc32":4,"./reader/readerFor":22,"./support":30,"./utf8":31,"./utils":32}],35:[function(n,r,i){function s(p,m,v){this.name=p,this.dir=v.dir,this.date=v.date,this.comment=v.comment,this.unixPermissions=v.unixPermissions,this.dosPermissions=v.dosPermissions,this._data=m,this._dataBinary=v.binary,this.options={compression:v.compression,compressionOptions:v.compressionOptions}}var o=n("./stream/StreamHelper"),a=n("./stream/DataWorker"),c=n("./utf8"),l=n("./compressedObject"),u=n("./stream/GenericWorker");s.prototype={internalStream:function(p){var m=null,v="string";try{if(!p)throw new Error("No output type specified.");var b=(v=p.toLowerCase())==="string"||v==="text";v!=="binarystring"&&v!=="text"||(v="string"),m=this._decompressWorker();var y=!this._dataBinary;y&&!b&&(m=m.pipe(new c.Utf8EncodeWorker)),!y&&b&&(m=m.pipe(new c.Utf8DecodeWorker))}catch(A){(m=new u("error")).error(A)}return new o(m,v,"")},async:function(p,m){return this.internalStream(p).accumulate(m)},nodeStream:function(p,m){return this.internalStream(p||"nodebuffer").toNodejsStream(m)},_compressWorker:function(p,m){if(this._data instanceof l&&this._data.compression.magic===p.magic)return this._data.getCompressedWorker();var v=this._decompressWorker();return this._dataBinary||(v=v.pipe(new c.Utf8EncodeWorker)),l.createWorkerFrom(v,p,m)},_decompressWorker:function(){return this._data instanceof l?this._data.getContentWorker():this._data instanceof u?this._data:new a(this._data)}};for(var f=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],d=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},h=0;h<f.length;h++)s.prototype[f[h]]=d;r.exports=s},{"./compressedObject":2,"./stream/DataWorker":27,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31}],36:[function(n,r,i){(function(s){var o,a,c=s.MutationObserver||s.WebKitMutationObserver;if(c){var l=0,u=new c(p),f=s.document.createTextNode("");u.observe(f,{characterData:!0}),o=function(){f.data=l=++l%2}}else if(s.setImmediate||s.MessageChannel===void 0)o="document"in s&&"onreadystatechange"in s.document.createElement("script")?function(){var m=s.document.createElement("script");m.onreadystatechange=function(){p(),m.onreadystatechange=null,m.parentNode.removeChild(m),m=null},s.document.documentElement.appendChild(m)}:function(){setTimeout(p,0)};else{var d=new s.MessageChannel;d.port1.onmessage=p,o=function(){d.port2.postMessage(0)}}var h=[];function p(){var m,v;a=!0;for(var b=h.length;b;){for(v=h,h=[],m=-1;++m<b;)v[m]();b=h.length}a=!1}r.exports=function(m){h.push(m)!==1||a||o()}}).call(this,typeof Re<"u"?Re:typeof self<"u"?self:typeof window<"u"?window:{})},{}],37:[function(n,r,i){var s=n("immediate");function o(){}var a={},c=["REJECTED"],l=["FULFILLED"],u=["PENDING"];function f(b){if(typeof b!="function")throw new TypeError("resolver must be a function");this.state=u,this.queue=[],this.outcome=void 0,b!==o&&m(this,b)}function d(b,y,A){this.promise=b,typeof y=="function"&&(this.onFulfilled=y,this.callFulfilled=this.otherCallFulfilled),typeof A=="function"&&(this.onRejected=A,this.callRejected=this.otherCallRejected)}function h(b,y,A){s(function(){var I;try{I=y(A)}catch(k){return a.reject(b,k)}I===b?a.reject(b,new TypeError("Cannot resolve promise with itself")):a.resolve(b,I)})}function p(b){var y=b&&b.then;if(b&&(typeof b=="object"||typeof b=="function")&&typeof y=="function")return function(){y.apply(b,arguments)}}function m(b,y){var A=!1;function I(w){A||(A=!0,a.reject(b,w))}function k(w){A||(A=!0,a.resolve(b,w))}var E=v(function(){y(k,I)});E.status==="error"&&I(E.value)}function v(b,y){var A={};try{A.value=b(y),A.status="success"}catch(I){A.status="error",A.value=I}return A}(r.exports=f).prototype.finally=function(b){if(typeof b!="function")return this;var y=this.constructor;return this.then(function(A){return y.resolve(b()).then(function(){return A})},function(A){return y.resolve(b()).then(function(){throw A})})},f.prototype.catch=function(b){return this.then(null,b)},f.prototype.then=function(b,y){if(typeof b!="function"&&this.state===l||typeof y!="function"&&this.state===c)return this;var A=new this.constructor(o);return this.state!==u?h(A,this.state===l?b:y,this.outcome):this.queue.push(new d(A,b,y)),A},d.prototype.callFulfilled=function(b){a.resolve(this.promise,b)},d.prototype.otherCallFulfilled=function(b){h(this.promise,this.onFulfilled,b)},d.prototype.callRejected=function(b){a.reject(this.promise,b)},d.prototype.otherCallRejected=function(b){h(this.promise,this.onRejected,b)},a.resolve=function(b,y){var A=v(p,y);if(A.status==="error")return a.reject(b,A.value);var I=A.value;if(I)m(b,I);else{b.state=l,b.outcome=y;for(var k=-1,E=b.queue.length;++k<E;)b.queue[k].callFulfilled(y)}return b},a.reject=function(b,y){b.state=c,b.outcome=y;for(var A=-1,I=b.queue.length;++A<I;)b.queue[A].callRejected(y);return b},f.resolve=function(b){return b instanceof this?b:a.resolve(new this(o),b)},f.reject=function(b){var y=new this(o);return a.reject(y,b)},f.all=function(b){var y=this;if(Object.prototype.toString.call(b)!=="[object Array]")return this.reject(new TypeError("must be an array"));var A=b.length,I=!1;if(!A)return this.resolve([]);for(var k=new Array(A),E=0,w=-1,S=new this(o);++w<A;)O(b[w],w);return S;function O(B,V){y.resolve(B).then(function(C){k[V]=C,++E!==A||I||(I=!0,a.resolve(S,k))},function(C){I||(I=!0,a.reject(S,C))})}},f.race=function(b){var y=this;if(Object.prototype.toString.call(b)!=="[object Array]")return this.reject(new TypeError("must be an array"));var A=b.length,I=!1;if(!A)return this.resolve([]);for(var k=-1,E=new this(o);++k<A;)w=b[k],y.resolve(w).then(function(S){I||(I=!0,a.resolve(E,S))},function(S){I||(I=!0,a.reject(E,S))});var w;return E}},{immediate:36}],38:[function(n,r,i){var s={};(0,n("./lib/utils/common").assign)(s,n("./lib/deflate"),n("./lib/inflate"),n("./lib/zlib/constants")),r.exports=s},{"./lib/deflate":39,"./lib/inflate":40,"./lib/utils/common":41,"./lib/zlib/constants":44}],39:[function(n,r,i){var s=n("./zlib/deflate"),o=n("./utils/common"),a=n("./utils/strings"),c=n("./zlib/messages"),l=n("./zlib/zstream"),u=Object.prototype.toString,f=0,d=-1,h=0,p=8;function m(b){if(!(this instanceof m))return new m(b);this.options=o.assign({level:d,method:p,chunkSize:16384,windowBits:15,memLevel:8,strategy:h,to:""},b||{});var y=this.options;y.raw&&0<y.windowBits?y.windowBits=-y.windowBits:y.gzip&&0<y.windowBits&&y.windowBits<16&&(y.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new l,this.strm.avail_out=0;var A=s.deflateInit2(this.strm,y.level,y.method,y.windowBits,y.memLevel,y.strategy);if(A!==f)throw new Error(c[A]);if(y.header&&s.deflateSetHeader(this.strm,y.header),y.dictionary){var I;if(I=typeof y.dictionary=="string"?a.string2buf(y.dictionary):u.call(y.dictionary)==="[object ArrayBuffer]"?new Uint8Array(y.dictionary):y.dictionary,(A=s.deflateSetDictionary(this.strm,I))!==f)throw new Error(c[A]);this._dict_set=!0}}function v(b,y){var A=new m(y);if(A.push(b,!0),A.err)throw A.msg||c[A.err];return A.result}m.prototype.push=function(b,y){var A,I,k=this.strm,E=this.options.chunkSize;if(this.ended)return!1;I=y===~~y?y:y===!0?4:0,typeof b=="string"?k.input=a.string2buf(b):u.call(b)==="[object ArrayBuffer]"?k.input=new Uint8Array(b):k.input=b,k.next_in=0,k.avail_in=k.input.length;do{if(k.avail_out===0&&(k.output=new o.Buf8(E),k.next_out=0,k.avail_out=E),(A=s.deflate(k,I))!==1&&A!==f)return this.onEnd(A),!(this.ended=!0);k.avail_out!==0&&(k.avail_in!==0||I!==4&&I!==2)||(this.options.to==="string"?this.onData(a.buf2binstring(o.shrinkBuf(k.output,k.next_out))):this.onData(o.shrinkBuf(k.output,k.next_out)))}while((0<k.avail_in||k.avail_out===0)&&A!==1);return I===4?(A=s.deflateEnd(this.strm),this.onEnd(A),this.ended=!0,A===f):I!==2||(this.onEnd(f),!(k.avail_out=0))},m.prototype.onData=function(b){this.chunks.push(b)},m.prototype.onEnd=function(b){b===f&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=o.flattenChunks(this.chunks)),this.chunks=[],this.err=b,this.msg=this.strm.msg},i.Deflate=m,i.deflate=v,i.deflateRaw=function(b,y){return(y=y||{}).raw=!0,v(b,y)},i.gzip=function(b,y){return(y=y||{}).gzip=!0,v(b,y)}},{"./utils/common":41,"./utils/strings":42,"./zlib/deflate":46,"./zlib/messages":51,"./zlib/zstream":53}],40:[function(n,r,i){var s=n("./zlib/inflate"),o=n("./utils/common"),a=n("./utils/strings"),c=n("./zlib/constants"),l=n("./zlib/messages"),u=n("./zlib/zstream"),f=n("./zlib/gzheader"),d=Object.prototype.toString;function h(m){if(!(this instanceof h))return new h(m);this.options=o.assign({chunkSize:16384,windowBits:0,to:""},m||{});var v=this.options;v.raw&&0<=v.windowBits&&v.windowBits<16&&(v.windowBits=-v.windowBits,v.windowBits===0&&(v.windowBits=-15)),!(0<=v.windowBits&&v.windowBits<16)||m&&m.windowBits||(v.windowBits+=32),15<v.windowBits&&v.windowBits<48&&!(15&v.windowBits)&&(v.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new u,this.strm.avail_out=0;var b=s.inflateInit2(this.strm,v.windowBits);if(b!==c.Z_OK)throw new Error(l[b]);this.header=new f,s.inflateGetHeader(this.strm,this.header)}function p(m,v){var b=new h(v);if(b.push(m,!0),b.err)throw b.msg||l[b.err];return b.result}h.prototype.push=function(m,v){var b,y,A,I,k,E,w=this.strm,S=this.options.chunkSize,O=this.options.dictionary,B=!1;if(this.ended)return!1;y=v===~~v?v:v===!0?c.Z_FINISH:c.Z_NO_FLUSH,typeof m=="string"?w.input=a.binstring2buf(m):d.call(m)==="[object ArrayBuffer]"?w.input=new Uint8Array(m):w.input=m,w.next_in=0,w.avail_in=w.input.length;do{if(w.avail_out===0&&(w.output=new o.Buf8(S),w.next_out=0,w.avail_out=S),(b=s.inflate(w,c.Z_NO_FLUSH))===c.Z_NEED_DICT&&O&&(E=typeof O=="string"?a.string2buf(O):d.call(O)==="[object ArrayBuffer]"?new Uint8Array(O):O,b=s.inflateSetDictionary(this.strm,E)),b===c.Z_BUF_ERROR&&B===!0&&(b=c.Z_OK,B=!1),b!==c.Z_STREAM_END&&b!==c.Z_OK)return this.onEnd(b),!(this.ended=!0);w.next_out&&(w.avail_out!==0&&b!==c.Z_STREAM_END&&(w.avail_in!==0||y!==c.Z_FINISH&&y!==c.Z_SYNC_FLUSH)||(this.options.to==="string"?(A=a.utf8border(w.output,w.next_out),I=w.next_out-A,k=a.buf2string(w.output,A),w.next_out=I,w.avail_out=S-I,I&&o.arraySet(w.output,w.output,A,I,0),this.onData(k)):this.onData(o.shrinkBuf(w.output,w.next_out)))),w.avail_in===0&&w.avail_out===0&&(B=!0)}while((0<w.avail_in||w.avail_out===0)&&b!==c.Z_STREAM_END);return b===c.Z_STREAM_END&&(y=c.Z_FINISH),y===c.Z_FINISH?(b=s.inflateEnd(this.strm),this.onEnd(b),this.ended=!0,b===c.Z_OK):y!==c.Z_SYNC_FLUSH||(this.onEnd(c.Z_OK),!(w.avail_out=0))},h.prototype.onData=function(m){this.chunks.push(m)},h.prototype.onEnd=function(m){m===c.Z_OK&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=o.flattenChunks(this.chunks)),this.chunks=[],this.err=m,this.msg=this.strm.msg},i.Inflate=h,i.inflate=p,i.inflateRaw=function(m,v){return(v=v||{}).raw=!0,p(m,v)},i.ungzip=p},{"./utils/common":41,"./utils/strings":42,"./zlib/constants":44,"./zlib/gzheader":47,"./zlib/inflate":49,"./zlib/messages":51,"./zlib/zstream":53}],41:[function(n,r,i){var s=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Int32Array<"u";i.assign=function(c){for(var l=Array.prototype.slice.call(arguments,1);l.length;){var u=l.shift();if(u){if(typeof u!="object")throw new TypeError(u+"must be non-object");for(var f in u)u.hasOwnProperty(f)&&(c[f]=u[f])}}return c},i.shrinkBuf=function(c,l){return c.length===l?c:c.subarray?c.subarray(0,l):(c.length=l,c)};var o={arraySet:function(c,l,u,f,d){if(l.subarray&&c.subarray)c.set(l.subarray(u,u+f),d);else for(var h=0;h<f;h++)c[d+h]=l[u+h]},flattenChunks:function(c){var l,u,f,d,h,p;for(l=f=0,u=c.length;l<u;l++)f+=c[l].length;for(p=new Uint8Array(f),l=d=0,u=c.length;l<u;l++)h=c[l],p.set(h,d),d+=h.length;return p}},a={arraySet:function(c,l,u,f,d){for(var h=0;h<f;h++)c[d+h]=l[u+h]},flattenChunks:function(c){return[].concat.apply([],c)}};i.setTyped=function(c){c?(i.Buf8=Uint8Array,i.Buf16=Uint16Array,i.Buf32=Int32Array,i.assign(i,o)):(i.Buf8=Array,i.Buf16=Array,i.Buf32=Array,i.assign(i,a))},i.setTyped(s)},{}],42:[function(n,r,i){var s=n("./common"),o=!0,a=!0;try{String.fromCharCode.apply(null,[0])}catch{o=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{a=!1}for(var c=new s.Buf8(256),l=0;l<256;l++)c[l]=252<=l?6:248<=l?5:240<=l?4:224<=l?3:192<=l?2:1;function u(f,d){if(d<65537&&(f.subarray&&a||!f.subarray&&o))return String.fromCharCode.apply(null,s.shrinkBuf(f,d));for(var h="",p=0;p<d;p++)h+=String.fromCharCode(f[p]);return h}c[254]=c[254]=1,i.string2buf=function(f){var d,h,p,m,v,b=f.length,y=0;for(m=0;m<b;m++)(64512&(h=f.charCodeAt(m)))==55296&&m+1<b&&(64512&(p=f.charCodeAt(m+1)))==56320&&(h=65536+(h-55296<<10)+(p-56320),m++),y+=h<128?1:h<2048?2:h<65536?3:4;for(d=new s.Buf8(y),m=v=0;v<y;m++)(64512&(h=f.charCodeAt(m)))==55296&&m+1<b&&(64512&(p=f.charCodeAt(m+1)))==56320&&(h=65536+(h-55296<<10)+(p-56320),m++),h<128?d[v++]=h:(h<2048?d[v++]=192|h>>>6:(h<65536?d[v++]=224|h>>>12:(d[v++]=240|h>>>18,d[v++]=128|h>>>12&63),d[v++]=128|h>>>6&63),d[v++]=128|63&h);return d},i.buf2binstring=function(f){return u(f,f.length)},i.binstring2buf=function(f){for(var d=new s.Buf8(f.length),h=0,p=d.length;h<p;h++)d[h]=f.charCodeAt(h);return d},i.buf2string=function(f,d){var h,p,m,v,b=d||f.length,y=new Array(2*b);for(h=p=0;h<b;)if((m=f[h++])<128)y[p++]=m;else if(4<(v=c[m]))y[p++]=65533,h+=v-1;else{for(m&=v===2?31:v===3?15:7;1<v&&h<b;)m=m<<6|63&f[h++],v--;1<v?y[p++]=65533:m<65536?y[p++]=m:(m-=65536,y[p++]=55296|m>>10&1023,y[p++]=56320|1023&m)}return u(y,p)},i.utf8border=function(f,d){var h;for((d=d||f.length)>f.length&&(d=f.length),h=d-1;0<=h&&(192&f[h])==128;)h--;return h<0||h===0?d:h+c[f[h]]>d?h:d}},{"./common":41}],43:[function(n,r,i){r.exports=function(s,o,a,c){for(var l=65535&s|0,u=s>>>16&65535|0,f=0;a!==0;){for(a-=f=2e3<a?2e3:a;u=u+(l=l+o[c++]|0)|0,--f;);l%=65521,u%=65521}return l|u<<16|0}},{}],44:[function(n,r,i){r.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],45:[function(n,r,i){var s=function(){for(var o,a=[],c=0;c<256;c++){o=c;for(var l=0;l<8;l++)o=1&o?3988292384^o>>>1:o>>>1;a[c]=o}return a}();r.exports=function(o,a,c,l){var u=s,f=l+c;o^=-1;for(var d=l;d<f;d++)o=o>>>8^u[255&(o^a[d])];return-1^o}},{}],46:[function(n,r,i){var s,o=n("../utils/common"),a=n("./trees"),c=n("./adler32"),l=n("./crc32"),u=n("./messages"),f=0,d=4,h=0,p=-2,m=-1,v=4,b=2,y=8,A=9,I=286,k=30,E=19,w=2*I+1,S=15,O=3,B=258,V=B+O+1,C=42,D=113,_=1,P=2,Q=3,F=4;function st(g,j){return g.msg=u[j],j}function z(g){return(g<<1)-(4<g?9:0)}function ot(g){for(var j=g.length;0<=--j;)g[j]=0}function M(g){var j=g.state,$=j.pending;$>g.avail_out&&($=g.avail_out),$!==0&&(o.arraySet(g.output,j.pending_buf,j.pending_out,$,g.next_out),g.next_out+=$,j.pending_out+=$,g.total_out+=$,g.avail_out-=$,j.pending-=$,j.pending===0&&(j.pending_out=0))}function L(g,j){a._tr_flush_block(g,0<=g.block_start?g.block_start:-1,g.strstart-g.block_start,j),g.block_start=g.strstart,M(g.strm)}function tt(g,j){g.pending_buf[g.pending++]=j}function H(g,j){g.pending_buf[g.pending++]=j>>>8&255,g.pending_buf[g.pending++]=255&j}function W(g,j){var $,x,R=g.max_chain_length,N=g.strstart,G=g.prev_length,K=g.nice_match,U=g.strstart>g.w_size-V?g.strstart-(g.w_size-V):0,q=g.window,nt=g.w_mask,J=g.prev,ct=g.strstart+B,Ft=q[N+G-1],Tt=q[N+G];g.prev_length>=g.good_match&&(R>>=2),K>g.lookahead&&(K=g.lookahead);do if(q[($=j)+G]===Tt&&q[$+G-1]===Ft&&q[$]===q[N]&&q[++$]===q[N+1]){N+=2,$++;do;while(q[++N]===q[++$]&&q[++N]===q[++$]&&q[++N]===q[++$]&&q[++N]===q[++$]&&q[++N]===q[++$]&&q[++N]===q[++$]&&q[++N]===q[++$]&&q[++N]===q[++$]&&N<ct);if(x=B-(ct-N),N=ct-B,G<x){if(g.match_start=j,K<=(G=x))break;Ft=q[N+G-1],Tt=q[N+G]}}while((j=J[j&nt])>U&&--R!=0);return G<=g.lookahead?G:g.lookahead}function ht(g){var j,$,x,R,N,G,K,U,q,nt,J=g.w_size;do{if(R=g.window_size-g.lookahead-g.strstart,g.strstart>=J+(J-V)){for(o.arraySet(g.window,g.window,J,J,0),g.match_start-=J,g.strstart-=J,g.block_start-=J,j=$=g.hash_size;x=g.head[--j],g.head[j]=J<=x?x-J:0,--$;);for(j=$=J;x=g.prev[--j],g.prev[j]=J<=x?x-J:0,--$;);R+=J}if(g.strm.avail_in===0)break;if(G=g.strm,K=g.window,U=g.strstart+g.lookahead,q=R,nt=void 0,nt=G.avail_in,q<nt&&(nt=q),$=nt===0?0:(G.avail_in-=nt,o.arraySet(K,G.input,G.next_in,nt,U),G.state.wrap===1?G.adler=c(G.adler,K,nt,U):G.state.wrap===2&&(G.adler=l(G.adler,K,nt,U)),G.next_in+=nt,G.total_in+=nt,nt),g.lookahead+=$,g.lookahead+g.insert>=O)for(N=g.strstart-g.insert,g.ins_h=g.window[N],g.ins_h=(g.ins_h<<g.hash_shift^g.window[N+1])&g.hash_mask;g.insert&&(g.ins_h=(g.ins_h<<g.hash_shift^g.window[N+O-1])&g.hash_mask,g.prev[N&g.w_mask]=g.head[g.ins_h],g.head[g.ins_h]=N,N++,g.insert--,!(g.lookahead+g.insert<O)););}while(g.lookahead<V&&g.strm.avail_in!==0)}function vt(g,j){for(var $,x;;){if(g.lookahead<V){if(ht(g),g.lookahead<V&&j===f)return _;if(g.lookahead===0)break}if($=0,g.lookahead>=O&&(g.ins_h=(g.ins_h<<g.hash_shift^g.window[g.strstart+O-1])&g.hash_mask,$=g.prev[g.strstart&g.w_mask]=g.head[g.ins_h],g.head[g.ins_h]=g.strstart),$!==0&&g.strstart-$<=g.w_size-V&&(g.match_length=W(g,$)),g.match_length>=O)if(x=a._tr_tally(g,g.strstart-g.match_start,g.match_length-O),g.lookahead-=g.match_length,g.match_length<=g.max_lazy_match&&g.lookahead>=O){for(g.match_length--;g.strstart++,g.ins_h=(g.ins_h<<g.hash_shift^g.window[g.strstart+O-1])&g.hash_mask,$=g.prev[g.strstart&g.w_mask]=g.head[g.ins_h],g.head[g.ins_h]=g.strstart,--g.match_length!=0;);g.strstart++}else g.strstart+=g.match_length,g.match_length=0,g.ins_h=g.window[g.strstart],g.ins_h=(g.ins_h<<g.hash_shift^g.window[g.strstart+1])&g.hash_mask;else x=a._tr_tally(g,0,g.window[g.strstart]),g.lookahead--,g.strstart++;if(x&&(L(g,!1),g.strm.avail_out===0))return _}return g.insert=g.strstart<O-1?g.strstart:O-1,j===d?(L(g,!0),g.strm.avail_out===0?Q:F):g.last_lit&&(L(g,!1),g.strm.avail_out===0)?_:P}function pt(g,j){for(var $,x,R;;){if(g.lookahead<V){if(ht(g),g.lookahead<V&&j===f)return _;if(g.lookahead===0)break}if($=0,g.lookahead>=O&&(g.ins_h=(g.ins_h<<g.hash_shift^g.window[g.strstart+O-1])&g.hash_mask,$=g.prev[g.strstart&g.w_mask]=g.head[g.ins_h],g.head[g.ins_h]=g.strstart),g.prev_length=g.match_length,g.prev_match=g.match_start,g.match_length=O-1,$!==0&&g.prev_length<g.max_lazy_match&&g.strstart-$<=g.w_size-V&&(g.match_length=W(g,$),g.match_length<=5&&(g.strategy===1||g.match_length===O&&4096<g.strstart-g.match_start)&&(g.match_length=O-1)),g.prev_length>=O&&g.match_length<=g.prev_length){for(R=g.strstart+g.lookahead-O,x=a._tr_tally(g,g.strstart-1-g.prev_match,g.prev_length-O),g.lookahead-=g.prev_length-1,g.prev_length-=2;++g.strstart<=R&&(g.ins_h=(g.ins_h<<g.hash_shift^g.window[g.strstart+O-1])&g.hash_mask,$=g.prev[g.strstart&g.w_mask]=g.head[g.ins_h],g.head[g.ins_h]=g.strstart),--g.prev_length!=0;);if(g.match_available=0,g.match_length=O-1,g.strstart++,x&&(L(g,!1),g.strm.avail_out===0))return _}else if(g.match_available){if((x=a._tr_tally(g,0,g.window[g.strstart-1]))&&L(g,!1),g.strstart++,g.lookahead--,g.strm.avail_out===0)return _}else g.match_available=1,g.strstart++,g.lookahead--}return g.match_available&&(x=a._tr_tally(g,0,g.window[g.strstart-1]),g.match_available=0),g.insert=g.strstart<O-1?g.strstart:O-1,j===d?(L(g,!0),g.strm.avail_out===0?Q:F):g.last_lit&&(L(g,!1),g.strm.avail_out===0)?_:P}function ft(g,j,$,x,R){this.good_length=g,this.max_lazy=j,this.nice_length=$,this.max_chain=x,this.func=R}function Rt(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=y,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new o.Buf16(2*w),this.dyn_dtree=new o.Buf16(2*(2*k+1)),this.bl_tree=new o.Buf16(2*(2*E+1)),ot(this.dyn_ltree),ot(this.dyn_dtree),ot(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new o.Buf16(S+1),this.heap=new o.Buf16(2*I+1),ot(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new o.Buf16(2*I+1),ot(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function Et(g){var j;return g&&g.state?(g.total_in=g.total_out=0,g.data_type=b,(j=g.state).pending=0,j.pending_out=0,j.wrap<0&&(j.wrap=-j.wrap),j.status=j.wrap?C:D,g.adler=j.wrap===2?0:1,j.last_flush=f,a._tr_init(j),h):st(g,p)}function Bt(g){var j=Et(g);return j===h&&function($){$.window_size=2*$.w_size,ot($.head),$.max_lazy_match=s[$.level].max_lazy,$.good_match=s[$.level].good_length,$.nice_match=s[$.level].nice_length,$.max_chain_length=s[$.level].max_chain,$.strstart=0,$.block_start=0,$.lookahead=0,$.insert=0,$.match_length=$.prev_length=O-1,$.match_available=0,$.ins_h=0}(g.state),j}function $t(g,j,$,x,R,N){if(!g)return p;var G=1;if(j===m&&(j=6),x<0?(G=0,x=-x):15<x&&(G=2,x-=16),R<1||A<R||$!==y||x<8||15<x||j<0||9<j||N<0||v<N)return st(g,p);x===8&&(x=9);var K=new Rt;return(g.state=K).strm=g,K.wrap=G,K.gzhead=null,K.w_bits=x,K.w_size=1<<K.w_bits,K.w_mask=K.w_size-1,K.hash_bits=R+7,K.hash_size=1<<K.hash_bits,K.hash_mask=K.hash_size-1,K.hash_shift=~~((K.hash_bits+O-1)/O),K.window=new o.Buf8(2*K.w_size),K.head=new o.Buf16(K.hash_size),K.prev=new o.Buf16(K.w_size),K.lit_bufsize=1<<R+6,K.pending_buf_size=4*K.lit_bufsize,K.pending_buf=new o.Buf8(K.pending_buf_size),K.d_buf=1*K.lit_bufsize,K.l_buf=3*K.lit_bufsize,K.level=j,K.strategy=N,K.method=$,Bt(g)}s=[new ft(0,0,0,0,function(g,j){var $=65535;for($>g.pending_buf_size-5&&($=g.pending_buf_size-5);;){if(g.lookahead<=1){if(ht(g),g.lookahead===0&&j===f)return _;if(g.lookahead===0)break}g.strstart+=g.lookahead,g.lookahead=0;var x=g.block_start+$;if((g.strstart===0||g.strstart>=x)&&(g.lookahead=g.strstart-x,g.strstart=x,L(g,!1),g.strm.avail_out===0)||g.strstart-g.block_start>=g.w_size-V&&(L(g,!1),g.strm.avail_out===0))return _}return g.insert=0,j===d?(L(g,!0),g.strm.avail_out===0?Q:F):(g.strstart>g.block_start&&(L(g,!1),g.strm.avail_out),_)}),new ft(4,4,8,4,vt),new ft(4,5,16,8,vt),new ft(4,6,32,32,vt),new ft(4,4,16,16,pt),new ft(8,16,32,32,pt),new ft(8,16,128,128,pt),new ft(8,32,128,256,pt),new ft(32,128,258,1024,pt),new ft(32,258,258,4096,pt)],i.deflateInit=function(g,j){return $t(g,j,y,15,8,0)},i.deflateInit2=$t,i.deflateReset=Bt,i.deflateResetKeep=Et,i.deflateSetHeader=function(g,j){return g&&g.state?g.state.wrap!==2?p:(g.state.gzhead=j,h):p},i.deflate=function(g,j){var $,x,R,N;if(!g||!g.state||5<j||j<0)return g?st(g,p):p;if(x=g.state,!g.output||!g.input&&g.avail_in!==0||x.status===666&&j!==d)return st(g,g.avail_out===0?-5:p);if(x.strm=g,$=x.last_flush,x.last_flush=j,x.status===C)if(x.wrap===2)g.adler=0,tt(x,31),tt(x,139),tt(x,8),x.gzhead?(tt(x,(x.gzhead.text?1:0)+(x.gzhead.hcrc?2:0)+(x.gzhead.extra?4:0)+(x.gzhead.name?8:0)+(x.gzhead.comment?16:0)),tt(x,255&x.gzhead.time),tt(x,x.gzhead.time>>8&255),tt(x,x.gzhead.time>>16&255),tt(x,x.gzhead.time>>24&255),tt(x,x.level===9?2:2<=x.strategy||x.level<2?4:0),tt(x,255&x.gzhead.os),x.gzhead.extra&&x.gzhead.extra.length&&(tt(x,255&x.gzhead.extra.length),tt(x,x.gzhead.extra.length>>8&255)),x.gzhead.hcrc&&(g.adler=l(g.adler,x.pending_buf,x.pending,0)),x.gzindex=0,x.status=69):(tt(x,0),tt(x,0),tt(x,0),tt(x,0),tt(x,0),tt(x,x.level===9?2:2<=x.strategy||x.level<2?4:0),tt(x,3),x.status=D);else{var G=y+(x.w_bits-8<<4)<<8;G|=(2<=x.strategy||x.level<2?0:x.level<6?1:x.level===6?2:3)<<6,x.strstart!==0&&(G|=32),G+=31-G%31,x.status=D,H(x,G),x.strstart!==0&&(H(x,g.adler>>>16),H(x,65535&g.adler)),g.adler=1}if(x.status===69)if(x.gzhead.extra){for(R=x.pending;x.gzindex<(65535&x.gzhead.extra.length)&&(x.pending!==x.pending_buf_size||(x.gzhead.hcrc&&x.pending>R&&(g.adler=l(g.adler,x.pending_buf,x.pending-R,R)),M(g),R=x.pending,x.pending!==x.pending_buf_size));)tt(x,255&x.gzhead.extra[x.gzindex]),x.gzindex++;x.gzhead.hcrc&&x.pending>R&&(g.adler=l(g.adler,x.pending_buf,x.pending-R,R)),x.gzindex===x.gzhead.extra.length&&(x.gzindex=0,x.status=73)}else x.status=73;if(x.status===73)if(x.gzhead.name){R=x.pending;do{if(x.pending===x.pending_buf_size&&(x.gzhead.hcrc&&x.pending>R&&(g.adler=l(g.adler,x.pending_buf,x.pending-R,R)),M(g),R=x.pending,x.pending===x.pending_buf_size)){N=1;break}N=x.gzindex<x.gzhead.name.length?255&x.gzhead.name.charCodeAt(x.gzindex++):0,tt(x,N)}while(N!==0);x.gzhead.hcrc&&x.pending>R&&(g.adler=l(g.adler,x.pending_buf,x.pending-R,R)),N===0&&(x.gzindex=0,x.status=91)}else x.status=91;if(x.status===91)if(x.gzhead.comment){R=x.pending;do{if(x.pending===x.pending_buf_size&&(x.gzhead.hcrc&&x.pending>R&&(g.adler=l(g.adler,x.pending_buf,x.pending-R,R)),M(g),R=x.pending,x.pending===x.pending_buf_size)){N=1;break}N=x.gzindex<x.gzhead.comment.length?255&x.gzhead.comment.charCodeAt(x.gzindex++):0,tt(x,N)}while(N!==0);x.gzhead.hcrc&&x.pending>R&&(g.adler=l(g.adler,x.pending_buf,x.pending-R,R)),N===0&&(x.status=103)}else x.status=103;if(x.status===103&&(x.gzhead.hcrc?(x.pending+2>x.pending_buf_size&&M(g),x.pending+2<=x.pending_buf_size&&(tt(x,255&g.adler),tt(x,g.adler>>8&255),g.adler=0,x.status=D)):x.status=D),x.pending!==0){if(M(g),g.avail_out===0)return x.last_flush=-1,h}else if(g.avail_in===0&&z(j)<=z($)&&j!==d)return st(g,-5);if(x.status===666&&g.avail_in!==0)return st(g,-5);if(g.avail_in!==0||x.lookahead!==0||j!==f&&x.status!==666){var K=x.strategy===2?function(U,q){for(var nt;;){if(U.lookahead===0&&(ht(U),U.lookahead===0)){if(q===f)return _;break}if(U.match_length=0,nt=a._tr_tally(U,0,U.window[U.strstart]),U.lookahead--,U.strstart++,nt&&(L(U,!1),U.strm.avail_out===0))return _}return U.insert=0,q===d?(L(U,!0),U.strm.avail_out===0?Q:F):U.last_lit&&(L(U,!1),U.strm.avail_out===0)?_:P}(x,j):x.strategy===3?function(U,q){for(var nt,J,ct,Ft,Tt=U.window;;){if(U.lookahead<=B){if(ht(U),U.lookahead<=B&&q===f)return _;if(U.lookahead===0)break}if(U.match_length=0,U.lookahead>=O&&0<U.strstart&&(J=Tt[ct=U.strstart-1])===Tt[++ct]&&J===Tt[++ct]&&J===Tt[++ct]){Ft=U.strstart+B;do;while(J===Tt[++ct]&&J===Tt[++ct]&&J===Tt[++ct]&&J===Tt[++ct]&&J===Tt[++ct]&&J===Tt[++ct]&&J===Tt[++ct]&&J===Tt[++ct]&&ct<Ft);U.match_length=B-(Ft-ct),U.match_length>U.lookahead&&(U.match_length=U.lookahead)}if(U.match_length>=O?(nt=a._tr_tally(U,1,U.match_length-O),U.lookahead-=U.match_length,U.strstart+=U.match_length,U.match_length=0):(nt=a._tr_tally(U,0,U.window[U.strstart]),U.lookahead--,U.strstart++),nt&&(L(U,!1),U.strm.avail_out===0))return _}return U.insert=0,q===d?(L(U,!0),U.strm.avail_out===0?Q:F):U.last_lit&&(L(U,!1),U.strm.avail_out===0)?_:P}(x,j):s[x.level].func(x,j);if(K!==Q&&K!==F||(x.status=666),K===_||K===Q)return g.avail_out===0&&(x.last_flush=-1),h;if(K===P&&(j===1?a._tr_align(x):j!==5&&(a._tr_stored_block(x,0,0,!1),j===3&&(ot(x.head),x.lookahead===0&&(x.strstart=0,x.block_start=0,x.insert=0))),M(g),g.avail_out===0))return x.last_flush=-1,h}return j!==d?h:x.wrap<=0?1:(x.wrap===2?(tt(x,255&g.adler),tt(x,g.adler>>8&255),tt(x,g.adler>>16&255),tt(x,g.adler>>24&255),tt(x,255&g.total_in),tt(x,g.total_in>>8&255),tt(x,g.total_in>>16&255),tt(x,g.total_in>>24&255)):(H(x,g.adler>>>16),H(x,65535&g.adler)),M(g),0<x.wrap&&(x.wrap=-x.wrap),x.pending!==0?h:1)},i.deflateEnd=function(g){var j;return g&&g.state?(j=g.state.status)!==C&&j!==69&&j!==73&&j!==91&&j!==103&&j!==D&&j!==666?st(g,p):(g.state=null,j===D?st(g,-3):h):p},i.deflateSetDictionary=function(g,j){var $,x,R,N,G,K,U,q,nt=j.length;if(!g||!g.state||(N=($=g.state).wrap)===2||N===1&&$.status!==C||$.lookahead)return p;for(N===1&&(g.adler=c(g.adler,j,nt,0)),$.wrap=0,nt>=$.w_size&&(N===0&&(ot($.head),$.strstart=0,$.block_start=0,$.insert=0),q=new o.Buf8($.w_size),o.arraySet(q,j,nt-$.w_size,$.w_size,0),j=q,nt=$.w_size),G=g.avail_in,K=g.next_in,U=g.input,g.avail_in=nt,g.next_in=0,g.input=j,ht($);$.lookahead>=O;){for(x=$.strstart,R=$.lookahead-(O-1);$.ins_h=($.ins_h<<$.hash_shift^$.window[x+O-1])&$.hash_mask,$.prev[x&$.w_mask]=$.head[$.ins_h],$.head[$.ins_h]=x,x++,--R;);$.strstart=x,$.lookahead=O-1,ht($)}return $.strstart+=$.lookahead,$.block_start=$.strstart,$.insert=$.lookahead,$.lookahead=0,$.match_length=$.prev_length=O-1,$.match_available=0,g.next_in=K,g.input=U,g.avail_in=G,$.wrap=N,h},i.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./messages":51,"./trees":52}],47:[function(n,r,i){r.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},{}],48:[function(n,r,i){r.exports=function(s,o){var a,c,l,u,f,d,h,p,m,v,b,y,A,I,k,E,w,S,O,B,V,C,D,_,P;a=s.state,c=s.next_in,_=s.input,l=c+(s.avail_in-5),u=s.next_out,P=s.output,f=u-(o-s.avail_out),d=u+(s.avail_out-257),h=a.dmax,p=a.wsize,m=a.whave,v=a.wnext,b=a.window,y=a.hold,A=a.bits,I=a.lencode,k=a.distcode,E=(1<<a.lenbits)-1,w=(1<<a.distbits)-1;t:do{A<15&&(y+=_[c++]<<A,A+=8,y+=_[c++]<<A,A+=8),S=I[y&E];e:for(;;){if(y>>>=O=S>>>24,A-=O,(O=S>>>16&255)===0)P[u++]=65535&S;else{if(!(16&O)){if(!(64&O)){S=I[(65535&S)+(y&(1<<O)-1)];continue e}if(32&O){a.mode=12;break t}s.msg="invalid literal/length code",a.mode=30;break t}B=65535&S,(O&=15)&&(A<O&&(y+=_[c++]<<A,A+=8),B+=y&(1<<O)-1,y>>>=O,A-=O),A<15&&(y+=_[c++]<<A,A+=8,y+=_[c++]<<A,A+=8),S=k[y&w];n:for(;;){if(y>>>=O=S>>>24,A-=O,!(16&(O=S>>>16&255))){if(!(64&O)){S=k[(65535&S)+(y&(1<<O)-1)];continue n}s.msg="invalid distance code",a.mode=30;break t}if(V=65535&S,A<(O&=15)&&(y+=_[c++]<<A,(A+=8)<O&&(y+=_[c++]<<A,A+=8)),h<(V+=y&(1<<O)-1)){s.msg="invalid distance too far back",a.mode=30;break t}if(y>>>=O,A-=O,(O=u-f)<V){if(m<(O=V-O)&&a.sane){s.msg="invalid distance too far back",a.mode=30;break t}if(D=b,(C=0)===v){if(C+=p-O,O<B){for(B-=O;P[u++]=b[C++],--O;);C=u-V,D=P}}else if(v<O){if(C+=p+v-O,(O-=v)<B){for(B-=O;P[u++]=b[C++],--O;);if(C=0,v<B){for(B-=O=v;P[u++]=b[C++],--O;);C=u-V,D=P}}}else if(C+=v-O,O<B){for(B-=O;P[u++]=b[C++],--O;);C=u-V,D=P}for(;2<B;)P[u++]=D[C++],P[u++]=D[C++],P[u++]=D[C++],B-=3;B&&(P[u++]=D[C++],1<B&&(P[u++]=D[C++]))}else{for(C=u-V;P[u++]=P[C++],P[u++]=P[C++],P[u++]=P[C++],2<(B-=3););B&&(P[u++]=P[C++],1<B&&(P[u++]=P[C++]))}break}}break}}while(c<l&&u<d);c-=B=A>>3,y&=(1<<(A-=B<<3))-1,s.next_in=c,s.next_out=u,s.avail_in=c<l?l-c+5:5-(c-l),s.avail_out=u<d?d-u+257:257-(u-d),a.hold=y,a.bits=A}},{}],49:[function(n,r,i){var s=n("../utils/common"),o=n("./adler32"),a=n("./crc32"),c=n("./inffast"),l=n("./inftrees"),u=1,f=2,d=0,h=-2,p=1,m=852,v=592;function b(C){return(C>>>24&255)+(C>>>8&65280)+((65280&C)<<8)+((255&C)<<24)}function y(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new s.Buf16(320),this.work=new s.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function A(C){var D;return C&&C.state?(D=C.state,C.total_in=C.total_out=D.total=0,C.msg="",D.wrap&&(C.adler=1&D.wrap),D.mode=p,D.last=0,D.havedict=0,D.dmax=32768,D.head=null,D.hold=0,D.bits=0,D.lencode=D.lendyn=new s.Buf32(m),D.distcode=D.distdyn=new s.Buf32(v),D.sane=1,D.back=-1,d):h}function I(C){var D;return C&&C.state?((D=C.state).wsize=0,D.whave=0,D.wnext=0,A(C)):h}function k(C,D){var _,P;return C&&C.state?(P=C.state,D<0?(_=0,D=-D):(_=1+(D>>4),D<48&&(D&=15)),D&&(D<8||15<D)?h:(P.window!==null&&P.wbits!==D&&(P.window=null),P.wrap=_,P.wbits=D,I(C))):h}function E(C,D){var _,P;return C?(P=new y,(C.state=P).window=null,(_=k(C,D))!==d&&(C.state=null),_):h}var w,S,O=!0;function B(C){if(O){var D;for(w=new s.Buf32(512),S=new s.Buf32(32),D=0;D<144;)C.lens[D++]=8;for(;D<256;)C.lens[D++]=9;for(;D<280;)C.lens[D++]=7;for(;D<288;)C.lens[D++]=8;for(l(u,C.lens,0,288,w,0,C.work,{bits:9}),D=0;D<32;)C.lens[D++]=5;l(f,C.lens,0,32,S,0,C.work,{bits:5}),O=!1}C.lencode=w,C.lenbits=9,C.distcode=S,C.distbits=5}function V(C,D,_,P){var Q,F=C.state;return F.window===null&&(F.wsize=1<<F.wbits,F.wnext=0,F.whave=0,F.window=new s.Buf8(F.wsize)),P>=F.wsize?(s.arraySet(F.window,D,_-F.wsize,F.wsize,0),F.wnext=0,F.whave=F.wsize):(P<(Q=F.wsize-F.wnext)&&(Q=P),s.arraySet(F.window,D,_-P,Q,F.wnext),(P-=Q)?(s.arraySet(F.window,D,_-P,P,0),F.wnext=P,F.whave=F.wsize):(F.wnext+=Q,F.wnext===F.wsize&&(F.wnext=0),F.whave<F.wsize&&(F.whave+=Q))),0}i.inflateReset=I,i.inflateReset2=k,i.inflateResetKeep=A,i.inflateInit=function(C){return E(C,15)},i.inflateInit2=E,i.inflate=function(C,D){var _,P,Q,F,st,z,ot,M,L,tt,H,W,ht,vt,pt,ft,Rt,Et,Bt,$t,g,j,$,x,R=0,N=new s.Buf8(4),G=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!C||!C.state||!C.output||!C.input&&C.avail_in!==0)return h;(_=C.state).mode===12&&(_.mode=13),st=C.next_out,Q=C.output,ot=C.avail_out,F=C.next_in,P=C.input,z=C.avail_in,M=_.hold,L=_.bits,tt=z,H=ot,j=d;t:for(;;)switch(_.mode){case p:if(_.wrap===0){_.mode=13;break}for(;L<16;){if(z===0)break t;z--,M+=P[F++]<<L,L+=8}if(2&_.wrap&&M===35615){N[_.check=0]=255&M,N[1]=M>>>8&255,_.check=a(_.check,N,2,0),L=M=0,_.mode=2;break}if(_.flags=0,_.head&&(_.head.done=!1),!(1&_.wrap)||(((255&M)<<8)+(M>>8))%31){C.msg="incorrect header check",_.mode=30;break}if((15&M)!=8){C.msg="unknown compression method",_.mode=30;break}if(L-=4,g=8+(15&(M>>>=4)),_.wbits===0)_.wbits=g;else if(g>_.wbits){C.msg="invalid window size",_.mode=30;break}_.dmax=1<<g,C.adler=_.check=1,_.mode=512&M?10:12,L=M=0;break;case 2:for(;L<16;){if(z===0)break t;z--,M+=P[F++]<<L,L+=8}if(_.flags=M,(255&_.flags)!=8){C.msg="unknown compression method",_.mode=30;break}if(57344&_.flags){C.msg="unknown header flags set",_.mode=30;break}_.head&&(_.head.text=M>>8&1),512&_.flags&&(N[0]=255&M,N[1]=M>>>8&255,_.check=a(_.check,N,2,0)),L=M=0,_.mode=3;case 3:for(;L<32;){if(z===0)break t;z--,M+=P[F++]<<L,L+=8}_.head&&(_.head.time=M),512&_.flags&&(N[0]=255&M,N[1]=M>>>8&255,N[2]=M>>>16&255,N[3]=M>>>24&255,_.check=a(_.check,N,4,0)),L=M=0,_.mode=4;case 4:for(;L<16;){if(z===0)break t;z--,M+=P[F++]<<L,L+=8}_.head&&(_.head.xflags=255&M,_.head.os=M>>8),512&_.flags&&(N[0]=255&M,N[1]=M>>>8&255,_.check=a(_.check,N,2,0)),L=M=0,_.mode=5;case 5:if(1024&_.flags){for(;L<16;){if(z===0)break t;z--,M+=P[F++]<<L,L+=8}_.length=M,_.head&&(_.head.extra_len=M),512&_.flags&&(N[0]=255&M,N[1]=M>>>8&255,_.check=a(_.check,N,2,0)),L=M=0}else _.head&&(_.head.extra=null);_.mode=6;case 6:if(1024&_.flags&&(z<(W=_.length)&&(W=z),W&&(_.head&&(g=_.head.extra_len-_.length,_.head.extra||(_.head.extra=new Array(_.head.extra_len)),s.arraySet(_.head.extra,P,F,W,g)),512&_.flags&&(_.check=a(_.check,P,W,F)),z-=W,F+=W,_.length-=W),_.length))break t;_.length=0,_.mode=7;case 7:if(2048&_.flags){if(z===0)break t;for(W=0;g=P[F+W++],_.head&&g&&_.length<65536&&(_.head.name+=String.fromCharCode(g)),g&&W<z;);if(512&_.flags&&(_.check=a(_.check,P,W,F)),z-=W,F+=W,g)break t}else _.head&&(_.head.name=null);_.length=0,_.mode=8;case 8:if(4096&_.flags){if(z===0)break t;for(W=0;g=P[F+W++],_.head&&g&&_.length<65536&&(_.head.comment+=String.fromCharCode(g)),g&&W<z;);if(512&_.flags&&(_.check=a(_.check,P,W,F)),z-=W,F+=W,g)break t}else _.head&&(_.head.comment=null);_.mode=9;case 9:if(512&_.flags){for(;L<16;){if(z===0)break t;z--,M+=P[F++]<<L,L+=8}if(M!==(65535&_.check)){C.msg="header crc mismatch",_.mode=30;break}L=M=0}_.head&&(_.head.hcrc=_.flags>>9&1,_.head.done=!0),C.adler=_.check=0,_.mode=12;break;case 10:for(;L<32;){if(z===0)break t;z--,M+=P[F++]<<L,L+=8}C.adler=_.check=b(M),L=M=0,_.mode=11;case 11:if(_.havedict===0)return C.next_out=st,C.avail_out=ot,C.next_in=F,C.avail_in=z,_.hold=M,_.bits=L,2;C.adler=_.check=1,_.mode=12;case 12:if(D===5||D===6)break t;case 13:if(_.last){M>>>=7&L,L-=7&L,_.mode=27;break}for(;L<3;){if(z===0)break t;z--,M+=P[F++]<<L,L+=8}switch(_.last=1&M,L-=1,3&(M>>>=1)){case 0:_.mode=14;break;case 1:if(B(_),_.mode=20,D!==6)break;M>>>=2,L-=2;break t;case 2:_.mode=17;break;case 3:C.msg="invalid block type",_.mode=30}M>>>=2,L-=2;break;case 14:for(M>>>=7&L,L-=7&L;L<32;){if(z===0)break t;z--,M+=P[F++]<<L,L+=8}if((65535&M)!=(M>>>16^65535)){C.msg="invalid stored block lengths",_.mode=30;break}if(_.length=65535&M,L=M=0,_.mode=15,D===6)break t;case 15:_.mode=16;case 16:if(W=_.length){if(z<W&&(W=z),ot<W&&(W=ot),W===0)break t;s.arraySet(Q,P,F,W,st),z-=W,F+=W,ot-=W,st+=W,_.length-=W;break}_.mode=12;break;case 17:for(;L<14;){if(z===0)break t;z--,M+=P[F++]<<L,L+=8}if(_.nlen=257+(31&M),M>>>=5,L-=5,_.ndist=1+(31&M),M>>>=5,L-=5,_.ncode=4+(15&M),M>>>=4,L-=4,286<_.nlen||30<_.ndist){C.msg="too many length or distance symbols",_.mode=30;break}_.have=0,_.mode=18;case 18:for(;_.have<_.ncode;){for(;L<3;){if(z===0)break t;z--,M+=P[F++]<<L,L+=8}_.lens[G[_.have++]]=7&M,M>>>=3,L-=3}for(;_.have<19;)_.lens[G[_.have++]]=0;if(_.lencode=_.lendyn,_.lenbits=7,$={bits:_.lenbits},j=l(0,_.lens,0,19,_.lencode,0,_.work,$),_.lenbits=$.bits,j){C.msg="invalid code lengths set",_.mode=30;break}_.have=0,_.mode=19;case 19:for(;_.have<_.nlen+_.ndist;){for(;ft=(R=_.lencode[M&(1<<_.lenbits)-1])>>>16&255,Rt=65535&R,!((pt=R>>>24)<=L);){if(z===0)break t;z--,M+=P[F++]<<L,L+=8}if(Rt<16)M>>>=pt,L-=pt,_.lens[_.have++]=Rt;else{if(Rt===16){for(x=pt+2;L<x;){if(z===0)break t;z--,M+=P[F++]<<L,L+=8}if(M>>>=pt,L-=pt,_.have===0){C.msg="invalid bit length repeat",_.mode=30;break}g=_.lens[_.have-1],W=3+(3&M),M>>>=2,L-=2}else if(Rt===17){for(x=pt+3;L<x;){if(z===0)break t;z--,M+=P[F++]<<L,L+=8}L-=pt,g=0,W=3+(7&(M>>>=pt)),M>>>=3,L-=3}else{for(x=pt+7;L<x;){if(z===0)break t;z--,M+=P[F++]<<L,L+=8}L-=pt,g=0,W=11+(127&(M>>>=pt)),M>>>=7,L-=7}if(_.have+W>_.nlen+_.ndist){C.msg="invalid bit length repeat",_.mode=30;break}for(;W--;)_.lens[_.have++]=g}}if(_.mode===30)break;if(_.lens[256]===0){C.msg="invalid code -- missing end-of-block",_.mode=30;break}if(_.lenbits=9,$={bits:_.lenbits},j=l(u,_.lens,0,_.nlen,_.lencode,0,_.work,$),_.lenbits=$.bits,j){C.msg="invalid literal/lengths set",_.mode=30;break}if(_.distbits=6,_.distcode=_.distdyn,$={bits:_.distbits},j=l(f,_.lens,_.nlen,_.ndist,_.distcode,0,_.work,$),_.distbits=$.bits,j){C.msg="invalid distances set",_.mode=30;break}if(_.mode=20,D===6)break t;case 20:_.mode=21;case 21:if(6<=z&&258<=ot){C.next_out=st,C.avail_out=ot,C.next_in=F,C.avail_in=z,_.hold=M,_.bits=L,c(C,H),st=C.next_out,Q=C.output,ot=C.avail_out,F=C.next_in,P=C.input,z=C.avail_in,M=_.hold,L=_.bits,_.mode===12&&(_.back=-1);break}for(_.back=0;ft=(R=_.lencode[M&(1<<_.lenbits)-1])>>>16&255,Rt=65535&R,!((pt=R>>>24)<=L);){if(z===0)break t;z--,M+=P[F++]<<L,L+=8}if(ft&&!(240&ft)){for(Et=pt,Bt=ft,$t=Rt;ft=(R=_.lencode[$t+((M&(1<<Et+Bt)-1)>>Et)])>>>16&255,Rt=65535&R,!(Et+(pt=R>>>24)<=L);){if(z===0)break t;z--,M+=P[F++]<<L,L+=8}M>>>=Et,L-=Et,_.back+=Et}if(M>>>=pt,L-=pt,_.back+=pt,_.length=Rt,ft===0){_.mode=26;break}if(32&ft){_.back=-1,_.mode=12;break}if(64&ft){C.msg="invalid literal/length code",_.mode=30;break}_.extra=15&ft,_.mode=22;case 22:if(_.extra){for(x=_.extra;L<x;){if(z===0)break t;z--,M+=P[F++]<<L,L+=8}_.length+=M&(1<<_.extra)-1,M>>>=_.extra,L-=_.extra,_.back+=_.extra}_.was=_.length,_.mode=23;case 23:for(;ft=(R=_.distcode[M&(1<<_.distbits)-1])>>>16&255,Rt=65535&R,!((pt=R>>>24)<=L);){if(z===0)break t;z--,M+=P[F++]<<L,L+=8}if(!(240&ft)){for(Et=pt,Bt=ft,$t=Rt;ft=(R=_.distcode[$t+((M&(1<<Et+Bt)-1)>>Et)])>>>16&255,Rt=65535&R,!(Et+(pt=R>>>24)<=L);){if(z===0)break t;z--,M+=P[F++]<<L,L+=8}M>>>=Et,L-=Et,_.back+=Et}if(M>>>=pt,L-=pt,_.back+=pt,64&ft){C.msg="invalid distance code",_.mode=30;break}_.offset=Rt,_.extra=15&ft,_.mode=24;case 24:if(_.extra){for(x=_.extra;L<x;){if(z===0)break t;z--,M+=P[F++]<<L,L+=8}_.offset+=M&(1<<_.extra)-1,M>>>=_.extra,L-=_.extra,_.back+=_.extra}if(_.offset>_.dmax){C.msg="invalid distance too far back",_.mode=30;break}_.mode=25;case 25:if(ot===0)break t;if(W=H-ot,_.offset>W){if((W=_.offset-W)>_.whave&&_.sane){C.msg="invalid distance too far back",_.mode=30;break}ht=W>_.wnext?(W-=_.wnext,_.wsize-W):_.wnext-W,W>_.length&&(W=_.length),vt=_.window}else vt=Q,ht=st-_.offset,W=_.length;for(ot<W&&(W=ot),ot-=W,_.length-=W;Q[st++]=vt[ht++],--W;);_.length===0&&(_.mode=21);break;case 26:if(ot===0)break t;Q[st++]=_.length,ot--,_.mode=21;break;case 27:if(_.wrap){for(;L<32;){if(z===0)break t;z--,M|=P[F++]<<L,L+=8}if(H-=ot,C.total_out+=H,_.total+=H,H&&(C.adler=_.check=_.flags?a(_.check,Q,H,st-H):o(_.check,Q,H,st-H)),H=ot,(_.flags?M:b(M))!==_.check){C.msg="incorrect data check",_.mode=30;break}L=M=0}_.mode=28;case 28:if(_.wrap&&_.flags){for(;L<32;){if(z===0)break t;z--,M+=P[F++]<<L,L+=8}if(M!==(4294967295&_.total)){C.msg="incorrect length check",_.mode=30;break}L=M=0}_.mode=29;case 29:j=1;break t;case 30:j=-3;break t;case 31:return-4;case 32:default:return h}return C.next_out=st,C.avail_out=ot,C.next_in=F,C.avail_in=z,_.hold=M,_.bits=L,(_.wsize||H!==C.avail_out&&_.mode<30&&(_.mode<27||D!==4))&&V(C,C.output,C.next_out,H-C.avail_out)?(_.mode=31,-4):(tt-=C.avail_in,H-=C.avail_out,C.total_in+=tt,C.total_out+=H,_.total+=H,_.wrap&&H&&(C.adler=_.check=_.flags?a(_.check,Q,H,C.next_out-H):o(_.check,Q,H,C.next_out-H)),C.data_type=_.bits+(_.last?64:0)+(_.mode===12?128:0)+(_.mode===20||_.mode===15?256:0),(tt==0&&H===0||D===4)&&j===d&&(j=-5),j)},i.inflateEnd=function(C){if(!C||!C.state)return h;var D=C.state;return D.window&&(D.window=null),C.state=null,d},i.inflateGetHeader=function(C,D){var _;return C&&C.state&&2&(_=C.state).wrap?((_.head=D).done=!1,d):h},i.inflateSetDictionary=function(C,D){var _,P=D.length;return C&&C.state?(_=C.state).wrap!==0&&_.mode!==11?h:_.mode===11&&o(1,D,P,0)!==_.check?-3:V(C,D,P,P)?(_.mode=31,-4):(_.havedict=1,d):h},i.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./inffast":48,"./inftrees":50}],50:[function(n,r,i){var s=n("../utils/common"),o=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],a=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],c=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],l=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];r.exports=function(u,f,d,h,p,m,v,b){var y,A,I,k,E,w,S,O,B,V=b.bits,C=0,D=0,_=0,P=0,Q=0,F=0,st=0,z=0,ot=0,M=0,L=null,tt=0,H=new s.Buf16(16),W=new s.Buf16(16),ht=null,vt=0;for(C=0;C<=15;C++)H[C]=0;for(D=0;D<h;D++)H[f[d+D]]++;for(Q=V,P=15;1<=P&&H[P]===0;P--);if(P<Q&&(Q=P),P===0)return p[m++]=20971520,p[m++]=20971520,b.bits=1,0;for(_=1;_<P&&H[_]===0;_++);for(Q<_&&(Q=_),C=z=1;C<=15;C++)if(z<<=1,(z-=H[C])<0)return-1;if(0<z&&(u===0||P!==1))return-1;for(W[1]=0,C=1;C<15;C++)W[C+1]=W[C]+H[C];for(D=0;D<h;D++)f[d+D]!==0&&(v[W[f[d+D]]++]=D);if(w=u===0?(L=ht=v,19):u===1?(L=o,tt-=257,ht=a,vt-=257,256):(L=c,ht=l,-1),C=_,E=m,st=D=M=0,I=-1,k=(ot=1<<(F=Q))-1,u===1&&852<ot||u===2&&592<ot)return 1;for(;;){for(S=C-st,B=v[D]<w?(O=0,v[D]):v[D]>w?(O=ht[vt+v[D]],L[tt+v[D]]):(O=96,0),y=1<<C-st,_=A=1<<F;p[E+(M>>st)+(A-=y)]=S<<24|O<<16|B|0,A!==0;);for(y=1<<C-1;M&y;)y>>=1;if(y!==0?(M&=y-1,M+=y):M=0,D++,--H[C]==0){if(C===P)break;C=f[d+v[D]]}if(Q<C&&(M&k)!==I){for(st===0&&(st=Q),E+=_,z=1<<(F=C-st);F+st<P&&!((z-=H[F+st])<=0);)F++,z<<=1;if(ot+=1<<F,u===1&&852<ot||u===2&&592<ot)return 1;p[I=M&k]=Q<<24|F<<16|E-m|0}}return M!==0&&(p[E+M]=C-st<<24|64<<16|0),b.bits=Q,0}},{"../utils/common":41}],51:[function(n,r,i){r.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],52:[function(n,r,i){var s=n("../utils/common"),o=0,a=1;function c(R){for(var N=R.length;0<=--N;)R[N]=0}var l=0,u=29,f=256,d=f+1+u,h=30,p=19,m=2*d+1,v=15,b=16,y=7,A=256,I=16,k=17,E=18,w=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],S=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],O=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],B=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],V=new Array(2*(d+2));c(V);var C=new Array(2*h);c(C);var D=new Array(512);c(D);var _=new Array(256);c(_);var P=new Array(u);c(P);var Q,F,st,z=new Array(h);function ot(R,N,G,K,U){this.static_tree=R,this.extra_bits=N,this.extra_base=G,this.elems=K,this.max_length=U,this.has_stree=R&&R.length}function M(R,N){this.dyn_tree=R,this.max_code=0,this.stat_desc=N}function L(R){return R<256?D[R]:D[256+(R>>>7)]}function tt(R,N){R.pending_buf[R.pending++]=255&N,R.pending_buf[R.pending++]=N>>>8&255}function H(R,N,G){R.bi_valid>b-G?(R.bi_buf|=N<<R.bi_valid&65535,tt(R,R.bi_buf),R.bi_buf=N>>b-R.bi_valid,R.bi_valid+=G-b):(R.bi_buf|=N<<R.bi_valid&65535,R.bi_valid+=G)}function W(R,N,G){H(R,G[2*N],G[2*N+1])}function ht(R,N){for(var G=0;G|=1&R,R>>>=1,G<<=1,0<--N;);return G>>>1}function vt(R,N,G){var K,U,q=new Array(v+1),nt=0;for(K=1;K<=v;K++)q[K]=nt=nt+G[K-1]<<1;for(U=0;U<=N;U++){var J=R[2*U+1];J!==0&&(R[2*U]=ht(q[J]++,J))}}function pt(R){var N;for(N=0;N<d;N++)R.dyn_ltree[2*N]=0;for(N=0;N<h;N++)R.dyn_dtree[2*N]=0;for(N=0;N<p;N++)R.bl_tree[2*N]=0;R.dyn_ltree[2*A]=1,R.opt_len=R.static_len=0,R.last_lit=R.matches=0}function ft(R){8<R.bi_valid?tt(R,R.bi_buf):0<R.bi_valid&&(R.pending_buf[R.pending++]=R.bi_buf),R.bi_buf=0,R.bi_valid=0}function Rt(R,N,G,K){var U=2*N,q=2*G;return R[U]<R[q]||R[U]===R[q]&&K[N]<=K[G]}function Et(R,N,G){for(var K=R.heap[G],U=G<<1;U<=R.heap_len&&(U<R.heap_len&&Rt(N,R.heap[U+1],R.heap[U],R.depth)&&U++,!Rt(N,K,R.heap[U],R.depth));)R.heap[G]=R.heap[U],G=U,U<<=1;R.heap[G]=K}function Bt(R,N,G){var K,U,q,nt,J=0;if(R.last_lit!==0)for(;K=R.pending_buf[R.d_buf+2*J]<<8|R.pending_buf[R.d_buf+2*J+1],U=R.pending_buf[R.l_buf+J],J++,K===0?W(R,U,N):(W(R,(q=_[U])+f+1,N),(nt=w[q])!==0&&H(R,U-=P[q],nt),W(R,q=L(--K),G),(nt=S[q])!==0&&H(R,K-=z[q],nt)),J<R.last_lit;);W(R,A,N)}function $t(R,N){var G,K,U,q=N.dyn_tree,nt=N.stat_desc.static_tree,J=N.stat_desc.has_stree,ct=N.stat_desc.elems,Ft=-1;for(R.heap_len=0,R.heap_max=m,G=0;G<ct;G++)q[2*G]!==0?(R.heap[++R.heap_len]=Ft=G,R.depth[G]=0):q[2*G+1]=0;for(;R.heap_len<2;)q[2*(U=R.heap[++R.heap_len]=Ft<2?++Ft:0)]=1,R.depth[U]=0,R.opt_len--,J&&(R.static_len-=nt[2*U+1]);for(N.max_code=Ft,G=R.heap_len>>1;1<=G;G--)Et(R,q,G);for(U=ct;G=R.heap[1],R.heap[1]=R.heap[R.heap_len--],Et(R,q,1),K=R.heap[1],R.heap[--R.heap_max]=G,R.heap[--R.heap_max]=K,q[2*U]=q[2*G]+q[2*K],R.depth[U]=(R.depth[G]>=R.depth[K]?R.depth[G]:R.depth[K])+1,q[2*G+1]=q[2*K+1]=U,R.heap[1]=U++,Et(R,q,1),2<=R.heap_len;);R.heap[--R.heap_max]=R.heap[1],function(Tt,gn){var Eo,rr,ko,ee,xc,Ph,Sr=gn.dyn_tree,_b=gn.max_code,hM=gn.stat_desc.static_tree,fM=gn.stat_desc.has_stree,dM=gn.stat_desc.extra_bits,bb=gn.stat_desc.extra_base,Ao=gn.stat_desc.max_length,Cc=0;for(ee=0;ee<=v;ee++)Tt.bl_count[ee]=0;for(Sr[2*Tt.heap[Tt.heap_max]+1]=0,Eo=Tt.heap_max+1;Eo<m;Eo++)Ao<(ee=Sr[2*Sr[2*(rr=Tt.heap[Eo])+1]+1]+1)&&(ee=Ao,Cc++),Sr[2*rr+1]=ee,_b<rr||(Tt.bl_count[ee]++,xc=0,bb<=rr&&(xc=dM[rr-bb]),Ph=Sr[2*rr],Tt.opt_len+=Ph*(ee+xc),fM&&(Tt.static_len+=Ph*(hM[2*rr+1]+xc)));if(Cc!==0){do{for(ee=Ao-1;Tt.bl_count[ee]===0;)ee--;Tt.bl_count[ee]--,Tt.bl_count[ee+1]+=2,Tt.bl_count[Ao]--,Cc-=2}while(0<Cc);for(ee=Ao;ee!==0;ee--)for(rr=Tt.bl_count[ee];rr!==0;)_b<(ko=Tt.heap[--Eo])||(Sr[2*ko+1]!==ee&&(Tt.opt_len+=(ee-Sr[2*ko+1])*Sr[2*ko],Sr[2*ko+1]=ee),rr--)}}(R,N),vt(q,Ft,R.bl_count)}function g(R,N,G){var K,U,q=-1,nt=N[1],J=0,ct=7,Ft=4;for(nt===0&&(ct=138,Ft=3),N[2*(G+1)+1]=65535,K=0;K<=G;K++)U=nt,nt=N[2*(K+1)+1],++J<ct&&U===nt||(J<Ft?R.bl_tree[2*U]+=J:U!==0?(U!==q&&R.bl_tree[2*U]++,R.bl_tree[2*I]++):J<=10?R.bl_tree[2*k]++:R.bl_tree[2*E]++,q=U,Ft=(J=0)===nt?(ct=138,3):U===nt?(ct=6,3):(ct=7,4))}function j(R,N,G){var K,U,q=-1,nt=N[1],J=0,ct=7,Ft=4;for(nt===0&&(ct=138,Ft=3),K=0;K<=G;K++)if(U=nt,nt=N[2*(K+1)+1],!(++J<ct&&U===nt)){if(J<Ft)for(;W(R,U,R.bl_tree),--J!=0;);else U!==0?(U!==q&&(W(R,U,R.bl_tree),J--),W(R,I,R.bl_tree),H(R,J-3,2)):J<=10?(W(R,k,R.bl_tree),H(R,J-3,3)):(W(R,E,R.bl_tree),H(R,J-11,7));q=U,Ft=(J=0)===nt?(ct=138,3):U===nt?(ct=6,3):(ct=7,4)}}c(z);var $=!1;function x(R,N,G,K){H(R,(l<<1)+(K?1:0),3),function(U,q,nt,J){ft(U),tt(U,nt),tt(U,~nt),s.arraySet(U.pending_buf,U.window,q,nt,U.pending),U.pending+=nt}(R,N,G)}i._tr_init=function(R){$||(function(){var N,G,K,U,q,nt=new Array(v+1);for(U=K=0;U<u-1;U++)for(P[U]=K,N=0;N<1<<w[U];N++)_[K++]=U;for(_[K-1]=U,U=q=0;U<16;U++)for(z[U]=q,N=0;N<1<<S[U];N++)D[q++]=U;for(q>>=7;U<h;U++)for(z[U]=q<<7,N=0;N<1<<S[U]-7;N++)D[256+q++]=U;for(G=0;G<=v;G++)nt[G]=0;for(N=0;N<=143;)V[2*N+1]=8,N++,nt[8]++;for(;N<=255;)V[2*N+1]=9,N++,nt[9]++;for(;N<=279;)V[2*N+1]=7,N++,nt[7]++;for(;N<=287;)V[2*N+1]=8,N++,nt[8]++;for(vt(V,d+1,nt),N=0;N<h;N++)C[2*N+1]=5,C[2*N]=ht(N,5);Q=new ot(V,w,f+1,d,v),F=new ot(C,S,0,h,v),st=new ot(new Array(0),O,0,p,y)}(),$=!0),R.l_desc=new M(R.dyn_ltree,Q),R.d_desc=new M(R.dyn_dtree,F),R.bl_desc=new M(R.bl_tree,st),R.bi_buf=0,R.bi_valid=0,pt(R)},i._tr_stored_block=x,i._tr_flush_block=function(R,N,G,K){var U,q,nt=0;0<R.level?(R.strm.data_type===2&&(R.strm.data_type=function(J){var ct,Ft=4093624447;for(ct=0;ct<=31;ct++,Ft>>>=1)if(1&Ft&&J.dyn_ltree[2*ct]!==0)return o;if(J.dyn_ltree[18]!==0||J.dyn_ltree[20]!==0||J.dyn_ltree[26]!==0)return a;for(ct=32;ct<f;ct++)if(J.dyn_ltree[2*ct]!==0)return a;return o}(R)),$t(R,R.l_desc),$t(R,R.d_desc),nt=function(J){var ct;for(g(J,J.dyn_ltree,J.l_desc.max_code),g(J,J.dyn_dtree,J.d_desc.max_code),$t(J,J.bl_desc),ct=p-1;3<=ct&&J.bl_tree[2*B[ct]+1]===0;ct--);return J.opt_len+=3*(ct+1)+5+5+4,ct}(R),U=R.opt_len+3+7>>>3,(q=R.static_len+3+7>>>3)<=U&&(U=q)):U=q=G+5,G+4<=U&&N!==-1?x(R,N,G,K):R.strategy===4||q===U?(H(R,2+(K?1:0),3),Bt(R,V,C)):(H(R,4+(K?1:0),3),function(J,ct,Ft,Tt){var gn;for(H(J,ct-257,5),H(J,Ft-1,5),H(J,Tt-4,4),gn=0;gn<Tt;gn++)H(J,J.bl_tree[2*B[gn]+1],3);j(J,J.dyn_ltree,ct-1),j(J,J.dyn_dtree,Ft-1)}(R,R.l_desc.max_code+1,R.d_desc.max_code+1,nt+1),Bt(R,R.dyn_ltree,R.dyn_dtree)),pt(R),K&&ft(R)},i._tr_tally=function(R,N,G){return R.pending_buf[R.d_buf+2*R.last_lit]=N>>>8&255,R.pending_buf[R.d_buf+2*R.last_lit+1]=255&N,R.pending_buf[R.l_buf+R.last_lit]=255&G,R.last_lit++,N===0?R.dyn_ltree[2*G]++:(R.matches++,N--,R.dyn_ltree[2*(_[G]+f+1)]++,R.dyn_dtree[2*L(N)]++),R.last_lit===R.lit_bufsize-1},i._tr_align=function(R){H(R,2,3),W(R,A,V),function(N){N.bi_valid===16?(tt(N,N.bi_buf),N.bi_buf=0,N.bi_valid=0):8<=N.bi_valid&&(N.pending_buf[N.pending++]=255&N.bi_buf,N.bi_buf>>=8,N.bi_valid-=8)}(R)}},{"../utils/common":41}],53:[function(n,r,i){r.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},{}],54:[function(n,r,i){(function(s){(function(o,a){if(!o.setImmediate){var c,l,u,f,d=1,h={},p=!1,m=o.document,v=Object.getPrototypeOf&&Object.getPrototypeOf(o);v=v&&v.setTimeout?v:o,c={}.toString.call(o.process)==="[object process]"?function(I){process.nextTick(function(){y(I)})}:function(){if(o.postMessage&&!o.importScripts){var I=!0,k=o.onmessage;return o.onmessage=function(){I=!1},o.postMessage("","*"),o.onmessage=k,I}}()?(f="setImmediate$"+Math.random()+"$",o.addEventListener?o.addEventListener("message",A,!1):o.attachEvent("onmessage",A),function(I){o.postMessage(f+I,"*")}):o.MessageChannel?((u=new MessageChannel).port1.onmessage=function(I){y(I.data)},function(I){u.port2.postMessage(I)}):m&&"onreadystatechange"in m.createElement("script")?(l=m.documentElement,function(I){var k=m.createElement("script");k.onreadystatechange=function(){y(I),k.onreadystatechange=null,l.removeChild(k),k=null},l.appendChild(k)}):function(I){setTimeout(y,0,I)},v.setImmediate=function(I){typeof I!="function"&&(I=new Function(""+I));for(var k=new Array(arguments.length-1),E=0;E<k.length;E++)k[E]=arguments[E+1];var w={callback:I,args:k};return h[d]=w,c(d),d++},v.clearImmediate=b}function b(I){delete h[I]}function y(I){if(p)setTimeout(y,0,I);else{var k=h[I];if(k){p=!0;try{(function(E){var w=E.callback,S=E.args;switch(S.length){case 0:w();break;case 1:w(S[0]);break;case 2:w(S[0],S[1]);break;case 3:w(S[0],S[1],S[2]);break;default:w.apply(a,S)}})(k)}finally{b(I),p=!1}}}}function A(I){I.source===o&&typeof I.data=="string"&&I.data.indexOf(f)===0&&y(+I.data.slice(f.length))}})(typeof self>"u"?s===void 0?this:s:self)}).call(this,typeof Re<"u"?Re:typeof self<"u"?self:typeof window<"u"?window:{})},{}]},{},[10])(10)})})(G_);var hL=G_.exports,fL=hs(hL);const W_={"application/andrew-inset":["ez"],"application/appinstaller":["appinstaller"],"application/applixware":["aw"],"application/appx":["appx"],"application/appxbundle":["appxbundle"],"application/atom+xml":["atom"],"application/atomcat+xml":["atomcat"],"application/atomdeleted+xml":["atomdeleted"],"application/atomsvc+xml":["atomsvc"],"application/atsc-dwd+xml":["dwd"],"application/atsc-held+xml":["held"],"application/atsc-rsat+xml":["rsat"],"application/automationml-aml+xml":["aml"],"application/automationml-amlx+zip":["amlx"],"application/bdoc":["bdoc"],"application/calendar+xml":["xcs"],"application/ccxml+xml":["ccxml"],"application/cdfx+xml":["cdfx"],"application/cdmi-capability":["cdmia"],"application/cdmi-container":["cdmic"],"application/cdmi-domain":["cdmid"],"application/cdmi-object":["cdmio"],"application/cdmi-queue":["cdmiq"],"application/cpl+xml":["cpl"],"application/cu-seeme":["cu"],"application/cwl":["cwl"],"application/dash+xml":["mpd"],"application/dash-patch+xml":["mpp"],"application/davmount+xml":["davmount"],"application/docbook+xml":["dbk"],"application/dssc+der":["dssc"],"application/dssc+xml":["xdssc"],"application/ecmascript":["ecma"],"application/emma+xml":["emma"],"application/emotionml+xml":["emotionml"],"application/epub+zip":["epub"],"application/exi":["exi"],"application/express":["exp"],"application/fdf":["fdf"],"application/fdt+xml":["fdt"],"application/font-tdpfr":["pfr"],"application/geo+json":["geojson"],"application/gml+xml":["gml"],"application/gpx+xml":["gpx"],"application/gxf":["gxf"],"application/gzip":["gz"],"application/hjson":["hjson"],"application/hyperstudio":["stk"],"application/inkml+xml":["ink","inkml"],"application/ipfix":["ipfix"],"application/its+xml":["its"],"application/java-archive":["jar","war","ear"],"application/java-serialized-object":["ser"],"application/java-vm":["class"],"application/javascript":["*js"],"application/json":["json","map"],"application/json5":["json5"],"application/jsonml+json":["jsonml"],"application/ld+json":["jsonld"],"application/lgr+xml":["lgr"],"application/lost+xml":["lostxml"],"application/mac-binhex40":["hqx"],"application/mac-compactpro":["cpt"],"application/mads+xml":["mads"],"application/manifest+json":["webmanifest"],"application/marc":["mrc"],"application/marcxml+xml":["mrcx"],"application/mathematica":["ma","nb","mb"],"application/mathml+xml":["mathml"],"application/mbox":["mbox"],"application/media-policy-dataset+xml":["mpf"],"application/mediaservercontrol+xml":["mscml"],"application/metalink+xml":["metalink"],"application/metalink4+xml":["meta4"],"application/mets+xml":["mets"],"application/mmt-aei+xml":["maei"],"application/mmt-usd+xml":["musd"],"application/mods+xml":["mods"],"application/mp21":["m21","mp21"],"application/mp4":["*mp4","*mpg4","mp4s","m4p"],"application/msix":["msix"],"application/msixbundle":["msixbundle"],"application/msword":["doc","dot"],"application/mxf":["mxf"],"application/n-quads":["nq"],"application/n-triples":["nt"],"application/node":["cjs"],"application/octet-stream":["bin","dms","lrf","mar","so","dist","distz","pkg","bpk","dump","elc","deploy","exe","dll","deb","dmg","iso","img","msi","msp","msm","buffer"],"application/oda":["oda"],"application/oebps-package+xml":["opf"],"application/ogg":["ogx"],"application/omdoc+xml":["omdoc"],"application/onenote":["onetoc","onetoc2","onetmp","onepkg"],"application/oxps":["oxps"],"application/p2p-overlay+xml":["relo"],"application/patch-ops-error+xml":["xer"],"application/pdf":["pdf"],"application/pgp-encrypted":["pgp"],"application/pgp-keys":["asc"],"application/pgp-signature":["sig","*asc"],"application/pics-rules":["prf"],"application/pkcs10":["p10"],"application/pkcs7-mime":["p7m","p7c"],"application/pkcs7-signature":["p7s"],"application/pkcs8":["p8"],"application/pkix-attr-cert":["ac"],"application/pkix-cert":["cer"],"application/pkix-crl":["crl"],"application/pkix-pkipath":["pkipath"],"application/pkixcmp":["pki"],"application/pls+xml":["pls"],"application/postscript":["ai","eps","ps"],"application/provenance+xml":["provx"],"application/pskc+xml":["pskcxml"],"application/raml+yaml":["raml"],"application/rdf+xml":["rdf","owl"],"application/reginfo+xml":["rif"],"application/relax-ng-compact-syntax":["rnc"],"application/resource-lists+xml":["rl"],"application/resource-lists-diff+xml":["rld"],"application/rls-services+xml":["rs"],"application/route-apd+xml":["rapd"],"application/route-s-tsid+xml":["sls"],"application/route-usd+xml":["rusd"],"application/rpki-ghostbusters":["gbr"],"application/rpki-manifest":["mft"],"application/rpki-roa":["roa"],"application/rsd+xml":["rsd"],"application/rss+xml":["rss"],"application/rtf":["rtf"],"application/sbml+xml":["sbml"],"application/scvp-cv-request":["scq"],"application/scvp-cv-response":["scs"],"application/scvp-vp-request":["spq"],"application/scvp-vp-response":["spp"],"application/sdp":["sdp"],"application/senml+xml":["senmlx"],"application/sensml+xml":["sensmlx"],"application/set-payment-initiation":["setpay"],"application/set-registration-initiation":["setreg"],"application/shf+xml":["shf"],"application/sieve":["siv","sieve"],"application/smil+xml":["smi","smil"],"application/sparql-query":["rq"],"application/sparql-results+xml":["srx"],"application/sql":["sql"],"application/srgs":["gram"],"application/srgs+xml":["grxml"],"application/sru+xml":["sru"],"application/ssdl+xml":["ssdl"],"application/ssml+xml":["ssml"],"application/swid+xml":["swidtag"],"application/tei+xml":["tei","teicorpus"],"application/thraud+xml":["tfi"],"application/timestamped-data":["tsd"],"application/toml":["toml"],"application/trig":["trig"],"application/ttml+xml":["ttml"],"application/ubjson":["ubj"],"application/urc-ressheet+xml":["rsheet"],"application/urc-targetdesc+xml":["td"],"application/voicexml+xml":["vxml"],"application/wasm":["wasm"],"application/watcherinfo+xml":["wif"],"application/widget":["wgt"],"application/winhlp":["hlp"],"application/wsdl+xml":["wsdl"],"application/wspolicy+xml":["wspolicy"],"application/xaml+xml":["xaml"],"application/xcap-att+xml":["xav"],"application/xcap-caps+xml":["xca"],"application/xcap-diff+xml":["xdf"],"application/xcap-el+xml":["xel"],"application/xcap-ns+xml":["xns"],"application/xenc+xml":["xenc"],"application/xfdf":["xfdf"],"application/xhtml+xml":["xhtml","xht"],"application/xliff+xml":["xlf"],"application/xml":["xml","xsl","xsd","rng"],"application/xml-dtd":["dtd"],"application/xop+xml":["xop"],"application/xproc+xml":["xpl"],"application/xslt+xml":["*xsl","xslt"],"application/xspf+xml":["xspf"],"application/xv+xml":["mxml","xhvml","xvml","xvm"],"application/yang":["yang"],"application/yin+xml":["yin"],"application/zip":["zip"],"audio/3gpp":["*3gpp"],"audio/aac":["adts","aac"],"audio/adpcm":["adp"],"audio/amr":["amr"],"audio/basic":["au","snd"],"audio/midi":["mid","midi","kar","rmi"],"audio/mobile-xmf":["mxmf"],"audio/mp3":["*mp3"],"audio/mp4":["m4a","mp4a"],"audio/mpeg":["mpga","mp2","mp2a","mp3","m2a","m3a"],"audio/ogg":["oga","ogg","spx","opus"],"audio/s3m":["s3m"],"audio/silk":["sil"],"audio/wav":["wav"],"audio/wave":["*wav"],"audio/webm":["weba"],"audio/xm":["xm"],"font/collection":["ttc"],"font/otf":["otf"],"font/ttf":["ttf"],"font/woff":["woff"],"font/woff2":["woff2"],"image/aces":["exr"],"image/apng":["apng"],"image/avci":["avci"],"image/avcs":["avcs"],"image/avif":["avif"],"image/bmp":["bmp","dib"],"image/cgm":["cgm"],"image/dicom-rle":["drle"],"image/dpx":["dpx"],"image/emf":["emf"],"image/fits":["fits"],"image/g3fax":["g3"],"image/gif":["gif"],"image/heic":["heic"],"image/heic-sequence":["heics"],"image/heif":["heif"],"image/heif-sequence":["heifs"],"image/hej2k":["hej2"],"image/hsj2":["hsj2"],"image/ief":["ief"],"image/jls":["jls"],"image/jp2":["jp2","jpg2"],"image/jpeg":["jpeg","jpg","jpe"],"image/jph":["jph"],"image/jphc":["jhc"],"image/jpm":["jpm","jpgm"],"image/jpx":["jpx","jpf"],"image/jxr":["jxr"],"image/jxra":["jxra"],"image/jxrs":["jxrs"],"image/jxs":["jxs"],"image/jxsc":["jxsc"],"image/jxsi":["jxsi"],"image/jxss":["jxss"],"image/ktx":["ktx"],"image/ktx2":["ktx2"],"image/png":["png"],"image/sgi":["sgi"],"image/svg+xml":["svg","svgz"],"image/t38":["t38"],"image/tiff":["tif","tiff"],"image/tiff-fx":["tfx"],"image/webp":["webp"],"image/wmf":["wmf"],"message/disposition-notification":["disposition-notification"],"message/global":["u8msg"],"message/global-delivery-status":["u8dsn"],"message/global-disposition-notification":["u8mdn"],"message/global-headers":["u8hdr"],"message/rfc822":["eml","mime"],"model/3mf":["3mf"],"model/gltf+json":["gltf"],"model/gltf-binary":["glb"],"model/iges":["igs","iges"],"model/jt":["jt"],"model/mesh":["msh","mesh","silo"],"model/mtl":["mtl"],"model/obj":["obj"],"model/prc":["prc"],"model/step+xml":["stpx"],"model/step+zip":["stpz"],"model/step-xml+zip":["stpxz"],"model/stl":["stl"],"model/u3d":["u3d"],"model/vrml":["wrl","vrml"],"model/x3d+binary":["*x3db","x3dbz"],"model/x3d+fastinfoset":["x3db"],"model/x3d+vrml":["*x3dv","x3dvz"],"model/x3d+xml":["x3d","x3dz"],"model/x3d-vrml":["x3dv"],"text/cache-manifest":["appcache","manifest"],"text/calendar":["ics","ifb"],"text/coffeescript":["coffee","litcoffee"],"text/css":["css"],"text/csv":["csv"],"text/html":["html","htm","shtml"],"text/jade":["jade"],"text/javascript":["js","mjs"],"text/jsx":["jsx"],"text/less":["less"],"text/markdown":["md","markdown"],"text/mathml":["mml"],"text/mdx":["mdx"],"text/n3":["n3"],"text/plain":["txt","text","conf","def","list","log","in","ini"],"text/richtext":["rtx"],"text/rtf":["*rtf"],"text/sgml":["sgml","sgm"],"text/shex":["shex"],"text/slim":["slim","slm"],"text/spdx":["spdx"],"text/stylus":["stylus","styl"],"text/tab-separated-values":["tsv"],"text/troff":["t","tr","roff","man","me","ms"],"text/turtle":["ttl"],"text/uri-list":["uri","uris","urls"],"text/vcard":["vcard"],"text/vtt":["vtt"],"text/wgsl":["wgsl"],"text/xml":["*xml"],"text/yaml":["yaml","yml"],"video/3gpp":["3gp","3gpp"],"video/3gpp2":["3g2"],"video/h261":["h261"],"video/h263":["h263"],"video/h264":["h264"],"video/iso.segment":["m4s"],"video/jpeg":["jpgv"],"video/jpm":["*jpm","*jpgm"],"video/mj2":["mj2","mjp2"],"video/mp2t":["ts"],"video/mp4":["mp4","mp4v","mpg4"],"video/mpeg":["mpeg","mpg","mpe","m1v","m2v"],"video/ogg":["ogv"],"video/quicktime":["qt","mov"],"video/webm":["webm"]};Object.freeze(W_);var dn=function(e,t,n,r){if(n==="a"&&!r)throw new TypeError("Private accessor was defined without a getter");if(typeof t=="function"?e!==t||!r:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return n==="m"?r:n==="a"?r.call(e):r?r.value:t.get(e)},rs,fo,Si;class dL{constructor(...t){rs.set(this,new Map),fo.set(this,new Map),Si.set(this,new Map);for(const n of t)this.define(n)}define(t,n=!1){for(let[r,i]of Object.entries(t)){r=r.toLowerCase(),i=i.map(a=>a.toLowerCase()),dn(this,Si,"f").has(r)||dn(this,Si,"f").set(r,new Set);const s=dn(this,Si,"f").get(r);let o=!0;for(let a of i){const c=a.startsWith("*");if(a=c?a.slice(1):a,s==null||s.add(a),o&&dn(this,fo,"f").set(r,a),o=!1,c)continue;const l=dn(this,rs,"f").get(a);if(l&&l!=r&&!n)throw new Error(`"${r} -> ${a}" conflicts with "${l} -> ${a}". Pass \`force=true\` to override this definition.`);dn(this,rs,"f").set(a,r)}}return this}getType(t){if(typeof t!="string")return null;const n=t.replace(/^.*[/\\]/,"").toLowerCase(),r=n.replace(/^.*\./,"").toLowerCase(),i=n.length<t.length;return!(r.length<n.length-1)&&i?null:dn(this,rs,"f").get(r)??null}getExtension(t){var n;return typeof t!="string"?null:(t=(n=t==null?void 0:t.split)==null?void 0:n.call(t,";")[0],(t&&dn(this,fo,"f").get(t.trim().toLowerCase()))??null)}getAllExtensions(t){return typeof t!="string"?null:dn(this,Si,"f").get(t.toLowerCase())??null}_freeze(){this.define=()=>{throw new Error("define() not allowed for built-in Mime objects. See https://github.com/broofa/mime/blob/main/README.md#custom-mime-instances")},Object.freeze(this);for(const t of dn(this,Si,"f").values())Object.freeze(t);return this}_getTestState(){return{types:dn(this,rs,"f"),extensions:dn(this,fo,"f")}}}rs=new WeakMap,fo=new WeakMap,Si=new WeakMap;var pL=new dL(W_)._freeze();function K_(e,t){switch([...t.slice(0,4)].map(i=>i.toString(16)).join("").toUpperCase()){case"89504E47":return"image/png";case"47494638":return"image/gif";case"25504446":return"application/pdf";case"FFD8FFDB":case"FFD8FFE0":case"FFD8FFE1":return"image/jpeg";case"504B0304":return"application/zip"}return pL.getType(e)??"application/octet-stream"}function mL(e){const t=k_(e,{}),n=fn(t),r=Zi(t),i=go("main");if(!T(i))return;const s=fc(i,ao(t),n);T(s)?de("memory",`${i.name} already has a [${r}] named ${n}`):(T_(i,t),de("memory",`created [${r}] ${n} in ${i.name}`))}async function gL(e){const t=await e.text();mL(t)}async function yL(e,t){try{de("parsezipfile",e.name);const n=await e.arrayBuffer();(await new fL().loadAsync(n)).forEach((s,o)=>{o.async("uint8array").then(a=>{const c=K_(s,a),l=new File([a],o.name,{type:c});t(l)}).catch(a=>{re("memory","crash",a.message)})})}catch(n){re("memory","crash",n.message)}}async function _L(e,t){try{de("parsebinaryfile",e.name);const n=await e.arrayBuffer(),r=e.name.split(".").slice(-1)[0];t((r??"").toLowerCase(),new Uint8Array(n))}catch(n){re("memory","crash",n.message)}}const Zt={defaultplayer:Ub(),software:{main:"",content:""},books:new Map,chips:new Map,loaders:new Map};function bL(e){Zt.defaultplayer=e}function wL(){return Zt.defaultplayer}function po(){return[...Zt.books.values()]}function vL(){const[e]=Zt.books.values();return e}function mo(e){const t=e.toLowerCase();return Zt.books.get(e)??po().find(n=>n.name.toLowerCase()===t)}function Ah(e,t){Zt.software[e]=t}function Cn(e){return mo(Zt.software[e])}function go(e,t){let n=Cn(e);if(T(n))return n;T(n)||(n=vL()),T(n)||(n=AN([]),xt(t)&&(n.name=t),kL(n),de("memory",`created [book] ${n.name}`)),T(n)&&(Ah("main",n.id),de("memory",`opened [book] ${n.name}`))}function EL(e){if(Zt.books.clear(),e.forEach(t=>{Zt.books.set(t.id,t),t.name.toLowerCase()==="main"&&(Zt.software.main=t.id)}),!Zt.software.main){const t=Zt.books.values().next();t.value&&(Zt.software.main=t.value.id)}}function kL(e){return Zt.books.set(e.id,e),e.id}function AL(e){const t=mo(e);t&&Zt.books.delete(t.id)}function wt(e){let t=Zt.chips.get(e);return T(t)||(t={book:void 0,board:void 0,object:void 0,terrain:void 0,charset:void 0,palette:void 0,eighttrack:void 0,binaryfile:void 0,player:Zt.defaultplayer,inputqueue:new Set,inputmods:{[fe.NONE]:0,[fe.MOVE_UP]:0,[fe.MOVE_DOWN]:0,[fe.MOVE_LEFT]:0,[fe.MOVE_RIGHT]:0,[fe.OK_BUTTON]:0,[fe.CANCEL_BUTTON]:0,[fe.MENU_BUTTON]:0},inputcurrent:void 0},Zt.chips.set(e,t)),t}function rt(e,t){const n=wt(e.id());return Hw(n,t,e.get)}function SL(e){if(!xt(e)||!e)return re("memory","login",`failed for playerid ==>${e}<==`,e);const t=Cn("main");if(!T(t))return re("memory","login:main","login failed to find book 'main'",e);const n=Qi(t,"title");if(!T(n))return re("memory","login:title","login failed to find board 'title'",e);const r=dc(t,"player");if(!T(r))return re("memory","login:player","login failed to find object type 'player'",e);const i={x:0,y:0},s=r.name??"player",o=Vc(n,i,s,e);return T(o==null?void 0:o.id)?(x_(t,e,n.codepage),!0):!1}function TL(e){Zt.books.forEach(t=>{const n=I_(t,e);df(n,e)})}function RL(e){const t=Cn("main"),n=C_(t);for(let r=0;r<n.length;++r){const i=n[r],s=Object.keys(i.objects);for(let o=0;o<s.length;++o){const c=i.objects[s[o]].id;Db(c)&&T(e[c])===!1&&(e[c]=0,x_(t,c,i.codepage))}}}function OL(e,t){const n=Ma.HALT_AT_COUNT;Ma.HALT_AT_COUNT=n*32,Zt.loaders.forEach((s,o)=>{e.tick(o,yc.LOADER,1,t,"loader",s),e.isended(o)&&(e.halt(o),Zt.loaders.delete(o))}),Ma.HALT_AT_COUNT=n;const r=Cn("main");C_(r).forEach(s=>{const o=NN(r,s,t);for(let a=0;a<o.length;++a){const c=o[a],l=wt(c.id);l.book=r,l.board=s,l.object=c.object,l.inputcurrent=void 0;const u=lf(In(r,c.object),"cycle",void 0),f=lf(c.object,"cycle",u),d=hf(c.object);e.tick(c.id,yc.CODE_PAGE,Kt(f)?f:VC,t,d,c.code)}})}function IL(e,t,n,r){go("main");const i=Cn("main"),s=`${n}_cli`,o=wt(s);o.player=n,o.book=i,o.board=void 0,o.inputcurrent=void 0,Qh("memory","running",t,s,r),e.once(s,yc.CLI,t,"cli",r)}function xL(e,t,n,r,i){const s=Cn("main");if(!T(s))return;const o=["binaryfile",r];de("memory","looking for stats",...o);const a=RN(s,at.LOADER).filter(c=>{const l=oo(c);return Object.keys(l).filter(d=>l[d]===""&&o.includes(d.toLowerCase())).length===o.length});for(let c=0;c<a.length;++c){const l=a[c],u=`${t}_load_${l.id}`,f=wt(u);f.player=t,f.book=s,f.board=void 0,f.binaryfile={filename:n.name,cursor:0,bytes:i,dataview:new DataView(i.buffer)},f.inputcurrent=void 0,de("memory","starting loader",e,u),Zt.loaders.set(u,l.code)}}function H_(e,t,n){function r(i){if(T(n))switch(i){case"text/plain":gL(n).catch(s=>re("memory","crash",s.message));break;case"application/zip":yL(n,s=>H_(e,t,s)).catch(s=>re("memory","crash",s.message));break;case"application/octet-stream":_L(n,(s,o)=>{xL(e,t,n,s,o)}).catch(s=>re("memory","crash",s.message));break;default:n.arrayBuffer().then(s=>{const o=K_(n.name,new Uint8Array(s));if(o)r(o);else return re("memory","loadfile",`unsupported file ${n.name}`)}).catch(s=>re("memory","crash",s.message));return}}r((n==null?void 0:n.type)??"")}function CL(e,t,n,r,i,s){const o=[];let a=t;const c=a===0,l=jt,u=yn,f=c?Qt.BLACK:Qt.CLEAR,d=sw(e,a++,l,u,f);o.push(d);const h=cw(e,a++,l,u);o.push(h);const p=a++,m=aw(e,p);o.push(m);const v=lw(e,a++);i&&o.push(v),r.terrain.forEach((k,E)=>{if(k){const w=In(n,k);d.char[E]=k.char??(w==null?void 0:w.char)??0,d.color[E]=k.color??(w==null?void 0:w.color)??f,d.bg[E]=k.bg??(w==null?void 0:w.bg)??f,d.color[E]!==Qt.CLEAR&&(s[E]=d.color[E])}});const b=r.objects??{};Object.values(b).forEach(k=>{if(T(k.removed)||T(k.headless))return;const E=k.id??"",w=In(n,k),S=ow(e,p,E),O=k.lx??k.x??0,B=k.ly??k.y??0,V=O+B*jt;S.x=k.x??0,S.y=k.y??0,S.char=k.char??(w==null?void 0:w.char)??1,S.color=k.color??(w==null?void 0:w.color)??Qt.WHITE,S.bg=k.bg??(w==null?void 0:w.bg)??Qt.BORROW,m.sprites.push(S),S.bg===Qt.SHADOW&&(S.bg=Qt.CLEAR,h.alphas[O+B*l]=.5),S.bg===Qt.BORROW&&(S.bg=s[V]??Qt.BLACK),S.color!==Qt.CLEAR&&(s[V]=S.color),E===e&&(v.focusx=S.x,v.focusy=S.y,v.focusid=E)});function y(k,E){if(!(k<0||k>=jt||E<0||E>=yn))return h.alphas[k+E*jt]}const A=[[1,1,1,1,1],[1,3,5,3,1],[1,5,12,5,1],[1,3,5,3,1],[1,1,1,1,1]].flat(),I=new Array(h.alphas.length);for(let k=0;k<h.alphas.length;++k){const E=k%jt,w=Math.floor(k/jt),S=[[y(E-2,w-2),y(E-1,w-2),y(E,w-2),y(E+1,w-2),y(E+2,w-2)],[y(E-2,w-1),y(E-1,w-1),y(E,w-1),y(E+1,w-1),y(E+2,w-1)],[y(E-2,w),y(E-1,w),y(E,w),y(E+1,w),y(E+2,w)],[y(E-2,w+1),y(E-1,w+1),y(E,w+1),y(E+1,w+1),y(E+2,w+1)],[y(E-2,w+2),y(E-1,w+2),y(E,w+2),y(E+1,w+2),y(E+2,w+2)]].flat().map((O,B)=>T(O)?O*A[B]:void 0).filter(T);I[k]=Zr(Nw(S),0,1)}return h.alphas=I,o}function NL(e){const t=Cn("main"),n=I_(t,e),r=[];if(!T(t)||!T(n))return r;const i=new Array(jt*yn).fill(0),s=Qi(t,n.over??""),o=Qi(t,n.under??""),a=[s,n,o].filter(T);let c=0;for(let l=0;l<a.length;++l){const u=a[l],f=CL(e,c,t,u,u===n,i);c+=f.length,r.push(...f)}return r}for(var is="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",yo=typeof Uint8Array>"u"?[]:new Uint8Array(256),bc=0;bc<is.length;bc++)yo[is.charCodeAt(bc)]=bc;var LL=function(e){var t=new Uint8Array(e),n,r=t.length,i="";for(n=0;n<r;n+=3)i+=is[t[n]>>2],i+=is[(t[n]&3)<<4|t[n+1]>>4],i+=is[(t[n+1]&15)<<2|t[n+2]>>6],i+=is[t[n+2]&63];return r%3===2?i=i.substring(0,i.length-1)+"=":r%3===1&&(i=i.substring(0,i.length-2)+"=="),i},ML=function(e){var t=e.length*.75,n=e.length,r,i=0,s,o,a,c;e[e.length-1]==="="&&(t--,e[e.length-2]==="="&&t--);var l=new ArrayBuffer(t),u=new Uint8Array(l);for(r=0;r<n;r+=4)s=yo[e.charCodeAt(r)],o=yo[e.charCodeAt(r+1)],a=yo[e.charCodeAt(r+2)],c=yo[e.charCodeAt(r+3)],u[i++]=s<<2|o>>4,u[i++]=(o&15)<<4|a>>2,u[i++]=(a&3)<<6|c&63;return l},V_={},UL=function(e,t,n,r,i){var s=new Worker(V_[t]||(V_[t]=URL.createObjectURL(new Blob([e+';addEventListener("error",function(e){e=e.error;postMessage({$e$:[e.message,e.code,e.stack]})})'],{type:"text/javascript"}))));return s.onmessage=function(o){var a=o.data,c=a.$e$;if(c){var l=new Error(c[0]);l.code=c[1],l.stack=c[2],i(l,null)}else i(null,a)},s.postMessage(n,r),s},he=Uint8Array,$e=Uint16Array,_o=Int32Array,ss=new he([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),os=new he([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),bo=new he([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),Y_=function(e,t){for(var n=new $e(31),r=0;r<31;++r)n[r]=t+=1<<e[r-1];for(var i=new _o(n[30]),r=1;r<30;++r)for(var s=n[r];s<n[r+1];++s)i[s]=s-n[r]<<5|r;return{b:n,r:i}},q_=Y_(ss,2),Sh=q_.b,wc=q_.r;Sh[28]=258,wc[258]=28;for(var J_=Y_(os,0),X_=J_.b,Th=J_.r,wo=new $e(32768),Wt=0;Wt<32768;++Wt){var qr=(Wt&43690)>>1|(Wt&21845)<<1;qr=(qr&52428)>>2|(qr&13107)<<2,qr=(qr&61680)>>4|(qr&3855)<<4,wo[Wt]=((qr&65280)>>8|(qr&255)<<8)>>1}for(var pn=function(e,t,n){for(var r=e.length,i=0,s=new $e(t);i<r;++i)e[i]&&++s[e[i]-1];var o=new $e(t);for(i=1;i<t;++i)o[i]=o[i-1]+s[i-1]<<1;var a;if(n){a=new $e(1<<t);var c=15-t;for(i=0;i<r;++i)if(e[i])for(var l=i<<4|e[i],u=t-e[i],f=o[e[i]-1]++<<u,d=f|(1<<u)-1;f<=d;++f)a[wo[f]>>c]=l}else for(a=new $e(r),i=0;i<r;++i)e[i]&&(a[i]=wo[o[e[i]-1]++]>>15-e[i]);return a},kr=new he(288),Wt=0;Wt<144;++Wt)kr[Wt]=8;for(var Wt=144;Wt<256;++Wt)kr[Wt]=9;for(var Wt=256;Wt<280;++Wt)kr[Wt]=7;for(var Wt=280;Wt<288;++Wt)kr[Wt]=8;for(var as=new he(32),Wt=0;Wt<32;++Wt)as[Wt]=5;var Z_=pn(kr,9,0),Q_=pn(kr,9,1),tb=pn(as,5,0),eb=pn(as,5,1),vc=function(e){for(var t=e[0],n=1;n<e.length;++n)e[n]>t&&(t=e[n]);return t},mn=function(e,t,n){var r=t/8|0;return(e[r]|e[r+1]<<8)>>(t&7)&n},Ec=function(e,t){var n=t/8|0;return(e[n]|e[n+1]<<8|e[n+2]<<16)>>(t&7)},vo=function(e){return(e+7)/8|0},kc=function(e,t,n){return(t==null||t<0)&&(t=0),(n==null||n>e.length)&&(n=e.length),new he(e.subarray(t,n))},nb=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],Ye=function(e,t,n){var r=new Error(t||nb[e]);if(r.code=e,Error.captureStackTrace&&Error.captureStackTrace(r,Ye),!n)throw r;return r},Rh=function(e,t,n,r){var i=e.length,s=r?r.length:0;if(!i||t.f&&!t.l)return n||new he(0);var o=!n,a=o||t.i!=2,c=t.i;o&&(n=new he(i*3));var l=function(Et){var Bt=n.length;if(Et>Bt){var $t=new he(Math.max(Bt*2,Et));$t.set(n),n=$t}},u=t.f||0,f=t.p||0,d=t.b||0,h=t.l,p=t.d,m=t.m,v=t.n,b=i*8;do{if(!h){u=mn(e,f,1);var y=mn(e,f+1,3);if(f+=3,y)if(y==1)h=Q_,p=eb,m=9,v=5;else if(y==2){var E=mn(e,f,31)+257,w=mn(e,f+10,15)+4,S=E+mn(e,f+5,31)+1;f+=14;for(var O=new he(S),B=new he(19),V=0;V<w;++V)B[bo[V]]=mn(e,f+V*3,7);f+=w*3;for(var C=vc(B),D=(1<<C)-1,_=pn(B,C,1),V=0;V<S;){var P=_[mn(e,f,D)];f+=P&15;var A=P>>4;if(A<16)O[V++]=A;else{var Q=0,F=0;for(A==16?(F=3+mn(e,f,3),f+=2,Q=O[V-1]):A==17?(F=3+mn(e,f,7),f+=3):A==18&&(F=11+mn(e,f,127),f+=7);F--;)O[V++]=Q}}var st=O.subarray(0,E),z=O.subarray(E);m=vc(st),v=vc(z),h=pn(st,m,1),p=pn(z,v,1)}else Ye(1);else{var A=vo(f)+4,I=e[A-4]|e[A-3]<<8,k=A+I;if(k>i){c&&Ye(0);break}a&&l(d+I),n.set(e.subarray(A,k),d),t.b=d+=I,t.p=f=k*8,t.f=u;continue}if(f>b){c&&Ye(0);break}}a&&l(d+131072);for(var ot=(1<<m)-1,M=(1<<v)-1,L=f;;L=f){var Q=h[Ec(e,f)&ot],tt=Q>>4;if(f+=Q&15,f>b){c&&Ye(0);break}if(Q||Ye(2),tt<256)n[d++]=tt;else if(tt==256){L=f,h=null;break}else{var H=tt-254;if(tt>264){var V=tt-257,W=ss[V];H=mn(e,f,(1<<W)-1)+Sh[V],f+=W}var ht=p[Ec(e,f)&M],vt=ht>>4;ht||Ye(3),f+=ht&15;var z=X_[vt];if(vt>3){var W=os[vt];z+=Ec(e,f)&(1<<W)-1,f+=W}if(f>b){c&&Ye(0);break}a&&l(d+131072);var pt=d+H;if(d<z){var ft=s-z,Rt=Math.min(z,pt);for(ft+d<0&&Ye(3);d<Rt;++d)n[d]=r[ft+d]}for(;d<pt;++d)n[d]=n[d-z]}}t.l=h,t.p=L,t.b=d,t.f=u,h&&(u=1,t.m=m,t.d=p,t.n=v)}while(!u);return d!=n.length&&o?kc(n,0,d):n.subarray(0,d)},nr=function(e,t,n){n<<=t&7;var r=t/8|0;e[r]|=n,e[r+1]|=n>>8},cs=function(e,t,n){n<<=t&7;var r=t/8|0;e[r]|=n,e[r+1]|=n>>8,e[r+2]|=n>>16},Ac=function(e,t){for(var n=[],r=0;r<e.length;++r)e[r]&&n.push({s:r,f:e[r]});var i=n.length,s=n.slice();if(!i)return{t:Ch,l:0};if(i==1){var o=new he(n[0].s+1);return o[n[0].s]=1,{t:o,l:1}}n.sort(function(k,E){return k.f-E.f}),n.push({s:-1,f:25001});var a=n[0],c=n[1],l=0,u=1,f=2;for(n[0]={s:-1,f:a.f+c.f,l:a,r:c};u!=i-1;)a=n[n[l].f<n[f].f?l++:f++],c=n[l!=u&&n[l].f<n[f].f?l++:f++],n[u++]={s:-1,f:a.f+c.f,l:a,r:c};for(var d=s[0].s,r=1;r<i;++r)s[r].s>d&&(d=s[r].s);var h=new $e(d+1),p=Sc(n[u-1],h,0);if(p>t){var r=0,m=0,v=p-t,b=1<<v;for(s.sort(function(E,w){return h[w.s]-h[E.s]||E.f-w.f});r<i;++r){var y=s[r].s;if(h[y]>t)m+=b-(1<<p-h[y]),h[y]=t;else break}for(m>>=v;m>0;){var A=s[r].s;h[A]<t?m-=1<<t-h[A]++-1:++r}for(;r>=0&&m;--r){var I=s[r].s;h[I]==t&&(--h[I],++m)}p=t}return{t:new he(h),l:p}},Sc=function(e,t,n){return e.s==-1?Math.max(Sc(e.l,t,n+1),Sc(e.r,t,n+1)):t[e.s]=n},Oh=function(e){for(var t=e.length;t&&!e[--t];);for(var n=new $e(++t),r=0,i=e[0],s=1,o=function(c){n[r++]=c},a=1;a<=t;++a)if(e[a]==i&&a!=t)++s;else{if(!i&&s>2){for(;s>138;s-=138)o(32754);s>2&&(o(s>10?s-11<<5|28690:s-3<<5|12305),s=0)}else if(s>3){for(o(i),--s;s>6;s-=6)o(8304);s>2&&(o(s-3<<5|8208),s=0)}for(;s--;)o(i);s=1,i=e[a]}return{c:n.subarray(0,r),n:t}},ls=function(e,t){for(var n=0,r=0;r<t.length;++r)n+=e[r]*t[r];return n},Ih=function(e,t,n){var r=n.length,i=vo(t+2);e[i]=r&255,e[i+1]=r>>8,e[i+2]=e[i]^255,e[i+3]=e[i+1]^255;for(var s=0;s<r;++s)e[i+s+4]=n[s];return(i+4+r)*8},xh=function(e,t,n,r,i,s,o,a,c,l,u){nr(t,u++,n),++i[256];for(var f=Ac(i,15),d=f.t,h=f.l,p=Ac(s,15),m=p.t,v=p.l,b=Oh(d),y=b.c,A=b.n,I=Oh(m),k=I.c,E=I.n,w=new $e(19),S=0;S<y.length;++S)++w[y[S]&31];for(var S=0;S<k.length;++S)++w[k[S]&31];for(var O=Ac(w,7),B=O.t,V=O.l,C=19;C>4&&!B[bo[C-1]];--C);var D=l+5<<3,_=ls(i,kr)+ls(s,as)+o,P=ls(i,d)+ls(s,m)+o+14+3*C+ls(w,B)+2*w[16]+3*w[17]+7*w[18];if(c>=0&&D<=_&&D<=P)return Ih(t,u,e.subarray(c,c+l));var Q,F,st,z;if(nr(t,u,1+(P<_)),u+=2,P<_){Q=pn(d,h,0),F=d,st=pn(m,v,0),z=m;var ot=pn(B,V,0);nr(t,u,A-257),nr(t,u+5,E-1),nr(t,u+10,C-4),u+=14;for(var S=0;S<C;++S)nr(t,u+3*S,B[bo[S]]);u+=3*C;for(var M=[y,k],L=0;L<2;++L)for(var tt=M[L],S=0;S<tt.length;++S){var H=tt[S]&31;nr(t,u,ot[H]),u+=B[H],H>15&&(nr(t,u,tt[S]>>5&127),u+=tt[S]>>12)}}else Q=Z_,F=kr,st=tb,z=as;for(var S=0;S<a;++S){var W=r[S];if(W>255){var H=W>>18&31;cs(t,u,Q[H+257]),u+=F[H+257],H>7&&(nr(t,u,W>>23&31),u+=ss[H]);var ht=W&31;cs(t,u,st[ht]),u+=z[ht],ht>3&&(cs(t,u,W>>5&8191),u+=os[ht])}else cs(t,u,Q[W]),u+=F[W]}return cs(t,u,Q[256]),u+F[256]},rb=new _o([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),Ch=new he(0),ib=function(e,t,n,r,i,s){var o=s.z||e.length,a=new he(r+o+5*(1+Math.ceil(o/7e3))+i),c=a.subarray(r,a.length-i),l=s.l,u=(s.r||0)&7;if(t){u&&(c[0]=s.r>>3);for(var f=rb[t-1],d=f>>13,h=f&8191,p=(1<<n)-1,m=s.p||new $e(32768),v=s.h||new $e(p+1),b=Math.ceil(n/3),y=2*b,A=function(g){return(e[g]^e[g+1]<<b^e[g+2]<<y)&p},I=new _o(25e3),k=new $e(288),E=new $e(32),w=0,S=0,O=s.i||0,B=0,V=s.w||0,C=0;O+2<o;++O){var D=A(O),_=O&32767,P=v[D];if(m[_]=P,v[D]=_,V<=O){var Q=o-O;if((w>7e3||B>24576)&&(Q>423||!l)){u=xh(e,c,0,I,k,E,S,B,C,O-C,u),B=w=S=0,C=O;for(var F=0;F<286;++F)k[F]=0;for(var F=0;F<30;++F)E[F]=0}var st=2,z=0,ot=h,M=_-P&32767;if(Q>2&&D==A(O-M))for(var L=Math.min(d,Q)-1,tt=Math.min(32767,O),H=Math.min(258,Q);M<=tt&&--ot&&_!=P;){if(e[O+st]==e[O+st-M]){for(var W=0;W<H&&e[O+W]==e[O+W-M];++W);if(W>st){if(st=W,z=M,W>L)break;for(var ht=Math.min(M,W-2),vt=0,F=0;F<ht;++F){var pt=O-M+F&32767,ft=m[pt],Rt=pt-ft&32767;Rt>vt&&(vt=Rt,P=pt)}}}_=P,P=m[_],M+=_-P&32767}if(z){I[B++]=268435456|wc[st]<<18|Th[z];var Et=wc[st]&31,Bt=Th[z]&31;S+=ss[Et]+os[Bt],++k[257+Et],++E[Bt],V=O+st,++w}else I[B++]=e[O],++k[e[O]]}}for(O=Math.max(O,V);O<o;++O)I[B++]=e[O],++k[e[O]];u=xh(e,c,l,I,k,E,S,B,C,O-C,u),l||(s.r=u&7|c[u/8|0]<<3,u-=7,s.h=v,s.p=m,s.i=O,s.w=V)}else{for(var O=s.w||0;O<o+l;O+=65535){var $t=O+65535;$t>=o&&(c[u/8|0]=l,$t=o),u=Ih(c,u+1,e.subarray(O,$t))}s.i=o}return kc(a,0,r+vo(u)+i)},sb=function(){for(var e=new Int32Array(256),t=0;t<256;++t){for(var n=t,r=9;--r;)n=(n&1&&-306674912)^n>>>1;e[t]=n}return e}(),ob=function(){var e=-1;return{p:function(t){for(var n=e,r=0;r<t.length;++r)n=sb[n&255^t[r]]^n>>>8;e=n},d:function(){return~e}}},Nh=function(e,t,n,r,i){if(!i&&(i={l:1},t.dictionary)){var s=t.dictionary.subarray(-32768),o=new he(s.length+e.length);o.set(s),o.set(e,s.length),e=o,i.w=s.length}return ib(e,t.level==null?6:t.level,t.mem==null?i.l?Math.ceil(Math.max(8,Math.min(13,Math.log(e.length)))*1.5):20:12+t.mem,n,r,i)},DL=function(e,t){var n={};for(var r in e)n[r]=e[r];for(var r in t)n[r]=t[r];return n},ab=function(e,t,n){for(var r=e(),i=e.toString(),s=i.slice(i.indexOf("[")+1,i.lastIndexOf("]")).replace(/\s+/g,"").split(","),o=0;o<r.length;++o){var a=r[o],c=s[o];if(typeof a=="function"){t+=";"+c+"=";var l=a.toString();if(a.prototype)if(l.indexOf("[native code]")!=-1){var u=l.indexOf(" ",8)+1;t+=l.slice(u,l.indexOf("(",u))}else{t+=l;for(var f in a.prototype)t+=";"+c+".prototype."+f+"="+a.prototype[f].toString()}else t+=l}else n[c]=a}return t},Tc=[],PL=function(e){var t=[];for(var n in e)e[n].buffer&&t.push((e[n]=new e[n].constructor(e[n])).buffer);return t},BL=function(e,t,n,r){if(!Tc[n]){for(var i="",s={},o=e.length-1,a=0;a<o;++a)i=ab(e[a],i,s);Tc[n]={c:ab(e[o],i,s),e:s}}var c=DL({},Tc[n].e);return UL(Tc[n].c+";onmessage=function(e){for(var k in e.data)self[k]=e.data[k];onmessage="+t.toString()+"}",n,c,PL(c),r)},$L=function(){return[he,$e,_o,ss,os,bo,Sh,X_,Q_,eb,wo,nb,pn,vc,mn,Ec,vo,kc,Ye,Rh,KL,Rc,GL]},FL=function(){return[he,$e,_o,ss,os,bo,wc,Th,Z_,kr,tb,as,wo,rb,Ch,pn,nr,cs,Ac,Sc,Oh,ls,Ih,xh,vo,kc,ib,Nh,WL,Rc]},jL=function(){return[lb,fb,Oc,ob,sb]},zL=function(){return[ub,hb]},Rc=function(e){return postMessage(e,[e.buffer])},GL=function(e){return e&&{out:e.size&&new he(e.size),dictionary:e.dictionary}},cb=function(e,t,n,r,i,s){var o=BL(n,r,i,function(a,c){o.terminate(),s(a,c)});return o.postMessage([e,t],t.consume?[e.buffer]:[]),function(){o.terminate()}},Oc=function(e,t,n){for(;n;++t)e[t]=n,n>>>=8},lb=function(e,t){var n=t.filename;if(e[0]=31,e[1]=139,e[2]=8,e[8]=t.level<2?4:t.level==9?2:0,e[9]=3,t.mtime!=0&&Oc(e,4,Math.floor(new Date(t.mtime||Date.now())/1e3)),n){e[3]=8;for(var r=0;r<=n.length;++r)e[r+10]=n.charCodeAt(r)}},ub=function(e){(e[0]!=31||e[1]!=139||e[2]!=8)&&Ye(6,"invalid gzip data");var t=e[3],n=10;t&4&&(n+=(e[10]|e[11]<<8)+2);for(var r=(t>>3&1)+(t>>4&1);r>0;r-=!e[n++]);return n+(t&2)},hb=function(e){var t=e.length;return(e[t-4]|e[t-3]<<8|e[t-2]<<16|e[t-1]<<24)>>>0},fb=function(e){return 10+(e.filename?e.filename.length+1:0)};function WL(e,t){return Nh(e,t||{},0,0)}function KL(e,t){return Rh(e,{i:2},t&&t.out,t&&t.dictionary)}function HL(e,t,n){return n||(n=t,t={}),typeof n!="function"&&Ye(7),cb(e,t,[FL,jL,function(){return[db]}],function(r){return Rc(db(r.data[0],r.data[1]))},2,n)}function db(e,t){t||(t={});var n=ob(),r=e.length;n.p(e);var i=Nh(e,t,fb(t),8),s=i.length;return lb(i,t),Oc(i,s-8,n.d()),Oc(i,s-4,r),i}function VL(e,t,n){return n||(n=t,t={}),typeof n!="function"&&Ye(7),cb(e,t,[$L,zL,function(){return[pb]}],function(r){return Rc(pb(r.data[0],r.data[1]))},3,n)}function pb(e,t){var n=ub(e);return n+8>e.length&&Ye(6,"invalid gzip data"),Rh(e.subarray(n,-8),{i:2},t&&t.out||new he(hb(e)),t&&t.dictionary)}var YL=typeof TextDecoder<"u"&&new TextDecoder,qL=0;try{YL.decode(Ch,{stream:!0}),qL=1}catch{}function JL(e){const t=e.replace(/-/g,"+").replace(/_/g,"/"),n="=".repeat((4-t.length%4)%4);return t+n}function XL(e){return e.replace(/\+/g,"-").replace(/\//g,"_")}function ZL(e){return new Uint8Array(ML(atob(e)))}function QL(e){return btoa(LL(e))}function tM(e){const t=JL(e);return ZL(t)}function eM(e){const t=QL(e);return XL(t)}const Lh=Be(gN);async function nM(e){return new Promise((t,n)=>{const r=e.map(SN).filter(T),i=new ArrayBuffer(Lh.measure(r).size),s=new qC(i);Lh.write(s,r),HL(new Uint8Array(i),{mtime:0,level:9,filename:""},(o,a)=>{o&&n(o),a&&t(eM(a))})})}async function rM(e){return new Promise((t,n)=>{const r=tM(e);VL(r,{},(i,s)=>{if(i&&n(i),s){const o=new JC(s.buffer),a=Lh.read(o).map(TN).filter(T);t(a)}})})}function Mh(e){if(!e||e.type===void 0)return;const t=[{start:e.startOffset,end:e.endOffset??0}];return Object.keys(e).forEach(n=>{if(n!=="parent"){const r=e[n];ne(r)?r.forEach(i=>{t.push(Mh(i))}):t.push(Mh(r))}}),e.range={start:Math.min(...t.filter(n=>n).map(n=>(n==null?void 0:n.start)??0)),end:Math.max(...t.filter(n=>n).map(n=>(n==null?void 0:n.end)??0))},e.range}function iM(e){const t=mu(`${e}
`);if(t.errors.length>0)return t;Fi.input=t.tokens;const n=Fi.program();if(Fi.errors.length>0)return{tokens:t.tokens,errors:Fi.errors.map(i=>({offset:i.token.startOffset,line:i.token.startLine,column:i.token.startColumn,length:i.token.image.length,message:i.message}))};const[r]=xO.go(n);return r?(Mh(r),{tokens:t.tokens,cst:n,ast:r}):{tokens:t.tokens,cst:n,errors:[{message:"no ast output",offset:0,line:0,column:0,length:0}]}}const Uh=Object.getPrototypeOf(function*(){}).constructor;function sM(e,t){LO(e);const n=iM(t);if(n.errors&&n.errors.length>0)return n;if(!n.ast)return{...n,errors:[{message:"no ast output",offset:0,line:0,column:0,length:0}]};const r=BO(n.ast);if(r.code){Ev&&console.info(r.code);try{return{...n,...r,source:r.code,code:new Uh("api",r.code)}}catch(i){return{errors:[{message:`unexpected error ${i.message}`,offset:0,line:0,column:0,length:0}],source:"",code:new Uh("api"," ")}}}return{...n,...r,source:"",code:new Uh("api"," ")}}function oM(){const e={},t={};function n(i,s){const o=e[s];if(o)return o;const a=sM(i,s);return e[s]=a,a}const r={ids(){return Object.keys(t)},has(i){return T(t[i])},isended(i){const s=t[i];return T(s)?s.isended():!0},halt(i){const s=t[i];return T(s)&&delete t[i],!!s},tick(i,s,o,a,c,l){var f;let u=t[i];if(!T(t[i])){const d=n(c,l);if(u=t[i]=FO(i,d),(f=d.errors)!=null&&f.length){const[h]=d.errors,p=((h==null?void 0:h.line)??2)-1,m=l.replaceAll(`\r
`,"").split(`
`).map((S,O)=>[S,O]);m.slice(p-5,p).forEach(([S,O])=>{re("os","build",`$grey${O+1} $grey${S}`)});const[v,b]=m[p],y=(h.column??1)-1,A=y+h.length,I=y<v.length?v:`${v}*`,k=I.substring(0,y),E=I.substring(y,A),w=I.substring(A);return re("os","build",`$red${b+1} $grey${k}$red${E}$grey${w}`),h.message.split(`
`).forEach(S=>{re("os","build",S)}),!1}uL(u,s)}return!!(u!=null&&u.tick(o,a))},once(i,s,o,a,c){return r.tick(i,s,1,o,a,c)&&r.halt(i)},message(i){const{target:s,path:o}=Hh(i.target),a=t[s];if(T(a)){const c={...i,target:o};a.message(c)}}};return r}const Dh=oM();let Ic=0;const aM=16,Ti={},cM=64;let mb=0;const Ar={},us={},Nn=So("vm",["tick","second"],e=>{var t;switch(e.target){case"init":T(e.player)&&(bL(e.player),Nn.reply(e,"ackinit",!0,e.player));break;case"books":ef("vm:books",async()=>{if(xt(e.data)){const n=await rM(e.data),r=n.map(i=>i.name);EL(n),de(Nn.name(),"reset by",e.sender,"with",...r,e.player),Nn.reply(e,"ackbooks",!0,e.player)}});break;case"login":e.player&&SL(e.player)&&(Ti[e.player]=0,de(Nn.name(),"player login",e.player),Nn.reply(e,"acklogin",!0,e.player));break;case"doot":e.player&&(Ti[e.player]=0,Qh(Nn.name(),"active",e.player));break;case"input":if(e.player){const n=wt(e.player),[r=fe.NONE,i=0]=e.data??{};n.inputqueue.add(r),n.inputmods[r]=i}break;case"codewatch":if(e.player&&ne(e.data)){const[n,r]=e.data;if(!T(us[r])){const i=tf(n,r);us[r]=u_(i,s=>{const o=mo(n),a=ki(o,r);T(a)&&(a.code=s,kN(a))})}Ar[n]=Ar[n]??{},Ar[n][r]=Ar[n][r]??new Set,Ar[n][r].add(e.player)}break;case"coderelease":if(e.player&&ne(e.data)){const[n,r]=e.data;T(Ar[n])&&T(Ar[n][r])&&(Ar[n][r].delete(e.player),Ar[n][r].size===0&&((t=us[r])==null||t.call(us),us[r]=void 0))}break;case"tick":Ic=e.data??0,OL(Dh,Ic);break;case"second":{RL(Ti);const n=Object.keys(Ti);for(let r=0;r<n.length;++r)++Ti[n[r]];for(let r=0;r<n.length;++r){const i=n[r];Ti[i]>=aM&&(delete Ti[i],TL(i),de(Nn.name(),"player logout",i),Nn.emit("logout",void 0,i))}++mb>=cM&&(mb=0,ds(Nn.name()));break}case"flush":ef("vm:flush",async()=>{const n=po();n.length&&yw(Nn.name(),await nM(n))});break;case"cli":T(e.player)&&IL(Dh,Ic,e.player,e.data??"");break;case"loadfile":T(e.player)&&H_(Ic,e.player,e.data);break;default:Dh.message(e);break}});function lM(){Nn.emit("ready",void 0,wL())}const gb={},yb=So("gadgetserver",["tock"],e=>{switch(e.target){case"tock":qN().forEach(t=>{const n=Ai(t);n.layers=NL(t);const r=jc(gb[t]??{},n);r.length&&(gb[t]=Ne(n),gw(yb.name(),r,t))});break;case"desync":if(e.player){const t=Ai(e.player);mw(yb.name(),t,e.player)}break;case"clearscroll":e.player&&JN(e.player);break}}),uM=$b(e=>postMessage(e));onmessage=function(t){uM(t.data)},queueMicrotask(lM)})();
